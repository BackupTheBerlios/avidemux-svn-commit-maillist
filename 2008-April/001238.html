<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Avidemux-svn-commit] r3976 - in	branches/avidemux_2.5_branch_gruntster/avidemux: . ADM_codecs	ADM_core/include ADM_coreUI/include ADM_coreUI/src	ADM_inputs/ADM_mp4 ADM_script ADM_userInterfaces/ADM_GTK/ADM_dialog	ADM_userInterfaces/ADM_GTK/ADM_dialogFactory	ADM_userInterfaces/ADM_GTK/ADM_toolkit_gtk	ADM_userInterfaces/ADM_NONE/ADM_dialog	ADM_userInterfaces/ADM_NONE/ADM_gui2	ADM_userInterfaces/ADM_QT4/ADM_dialog	ADM_userInterfaces/ADM_QT4/ADM_dialogFactory	ADM_userInterfaces/ADM_QT4/ADM_gui
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/avidemux-svn-commit/2008-April/index.html" >
   <LINK REL="made" HREF="mailto:avidemux-svn-commit%40lists.berlios.de?Subject=Re%3A%20%5BAvidemux-svn-commit%5D%20r3976%20-%20in%0A%09branches/avidemux_2.5_branch_gruntster/avidemux%3A%20.%20ADM_codecs%0A%09ADM_core/include%20ADM_coreUI/include%20ADM_coreUI/src%0A%09ADM_inputs/ADM_mp4%20ADM_script%20ADM_userInterfaces/ADM_GTK/ADM_dialog%0A%09ADM_userInterfaces/ADM_GTK/ADM_dialogFactory%0A%09ADM_userInterfaces/ADM_GTK/ADM_toolkit_gtk%0A%09ADM_userInterfaces/ADM_NONE/ADM_dialog%0A%09ADM_userInterfaces/ADM_NONE/ADM_gui2%0A%09ADM_userInterfaces/ADM_QT4/ADM_dialog%0A%09ADM_userInterfaces/ADM_QT4/ADM_dialogFactory%0A%09ADM_userInterfaces/ADM_QT4/ADM_gui&In-Reply-To=%3C200804111737.m3BHbVof030278%40sheep.berlios.de%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="001237.html">
   <LINK REL="Next"  HREF="001239.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Avidemux-svn-commit] r3976 - in	branches/avidemux_2.5_branch_gruntster/avidemux: . ADM_codecs	ADM_core/include ADM_coreUI/include ADM_coreUI/src	ADM_inputs/ADM_mp4 ADM_script ADM_userInterfaces/ADM_GTK/ADM_dialog	ADM_userInterfaces/ADM_GTK/ADM_dialogFactory	ADM_userInterfaces/ADM_GTK/ADM_toolkit_gtk	ADM_userInterfaces/ADM_NONE/ADM_dialog	ADM_userInterfaces/ADM_NONE/ADM_gui2	ADM_userInterfaces/ADM_QT4/ADM_dialog	ADM_userInterfaces/ADM_QT4/ADM_dialogFactory	ADM_userInterfaces/ADM_QT4/ADM_gui</H1>
    <B>mean at BerliOS</B> 
    <A HREF="mailto:avidemux-svn-commit%40lists.berlios.de?Subject=Re%3A%20%5BAvidemux-svn-commit%5D%20r3976%20-%20in%0A%09branches/avidemux_2.5_branch_gruntster/avidemux%3A%20.%20ADM_codecs%0A%09ADM_core/include%20ADM_coreUI/include%20ADM_coreUI/src%0A%09ADM_inputs/ADM_mp4%20ADM_script%20ADM_userInterfaces/ADM_GTK/ADM_dialog%0A%09ADM_userInterfaces/ADM_GTK/ADM_dialogFactory%0A%09ADM_userInterfaces/ADM_GTK/ADM_toolkit_gtk%0A%09ADM_userInterfaces/ADM_NONE/ADM_dialog%0A%09ADM_userInterfaces/ADM_NONE/ADM_gui2%0A%09ADM_userInterfaces/ADM_QT4/ADM_dialog%0A%09ADM_userInterfaces/ADM_QT4/ADM_dialogFactory%0A%09ADM_userInterfaces/ADM_QT4/ADM_gui&In-Reply-To=%3C200804111737.m3BHbVof030278%40sheep.berlios.de%3E"
       TITLE="[Avidemux-svn-commit] r3976 - in	branches/avidemux_2.5_branch_gruntster/avidemux: . ADM_codecs	ADM_core/include ADM_coreUI/include ADM_coreUI/src	ADM_inputs/ADM_mp4 ADM_script ADM_userInterfaces/ADM_GTK/ADM_dialog	ADM_userInterfaces/ADM_GTK/ADM_dialogFactory	ADM_userInterfaces/ADM_GTK/ADM_toolkit_gtk	ADM_userInterfaces/ADM_NONE/ADM_dialog	ADM_userInterfaces/ADM_NONE/ADM_gui2	ADM_userInterfaces/ADM_QT4/ADM_dialog	ADM_userInterfaces/ADM_QT4/ADM_dialogFactory	ADM_userInterfaces/ADM_QT4/ADM_gui">mean at mail.berlios.de
       </A><BR>
    <I>Fri Apr 11 19:37:31 CEST 2008</I>
    <P><UL>
        <LI>Previous message: <A HREF="001237.html">[Avidemux-svn-commit] r3975 - in	branches/avidemux_2.5_branch_gruntster:	avidemux/ADM_audiocodec avidemux/ADM_core/include	avidemux/ADM_core/src avidemux/ADM_encoder	avidemux/ADM_libraries cmake
</A></li>
        <LI>Next message: <A HREF="001239.html">[Avidemux-svn-commit] r3977 -	branches/avidemux_2.5_branch_gruntster/avidemux/ADM_coreUI/include
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1238">[ date ]</a>
              <a href="thread.html#1238">[ thread ]</a>
              <a href="subject.html#1238">[ subject ]</a>
              <a href="author.html#1238">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Author: mean
Date: 2008-04-11 19:37:22 +0200 (Fri, 11 Apr 2008)
New Revision: 3976

Added:
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_coreUI/src/DIA_coreToolkit.cpp
Modified:
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_codecs/ADM_ffmp43.cpp
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_codecs/ADM_ffmpeg.cpp
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_core/include/ADM_misc.h
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_coreUI/include/DIA_coreToolkit.h
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_coreUI/include/DIA_coreUI_internal.h
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_coreUI/src/CMakeLists.txt
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_coreUI/src/DIA_factory.cpp
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_coreUI/src/DIA_fileSel.cpp
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_inputs/ADM_mp4/ADM_mp4Analyzer.cpp
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_script/ADM_JSFunctions.cpp
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_jobs.cpp
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialogFactory/DIA_dialogFactory.cpp
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialogFactory/FAC_bitrate.cpp
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_GTK/ADM_toolkit_gtk/TLK_filesel.cpp
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_GTK/ADM_toolkit_gtk/choice.cpp
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_GTK/ADM_toolkit_gtk/toolkit_dialog.cpp
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_NONE/ADM_dialog/alert_none.cpp
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_NONE/ADM_gui2/file_none.cpp
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/alert_qt4.cpp
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialogFactory/FAC_bar.cpp
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialogFactory/FAC_float.cpp
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialogFactory/FAC_frame.cpp
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialogFactory/FAC_hex.cpp
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialogFactory/FAC_integer.cpp
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialogFactory/FAC_matrix.cpp
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialogFactory/FAC_notch.cpp
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialogFactory/FAC_readOnlyText.cpp
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialogFactory/T_bitrate.cpp
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialogFactory/T_button.cpp
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialogFactory/T_dialogFactory.cpp
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialogFactory/T_filesel.cpp
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialogFactory/T_menu.cpp
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialogFactory/T_slider.cpp
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialogFactory/T_threadCount.cpp
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialogFactory/T_toggle.cpp
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/file_qt4.cpp
   branches/avidemux_2.5_branch_gruntster/avidemux/main.cpp
Log:
[Merge] from mean branch


Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_codecs/ADM_ffmp43.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_codecs/ADM_ffmp43.cpp	2008-04-10 23:44:37 UTC (rev 3975)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_codecs/ADM_ffmp43.cpp	2008-04-11 17:37:22 UTC (rev 3976)
@@ -41,14 +41,14 @@
 #define WRAP_Open(x) \
 {\
 AVCodec *codec=avcodec_find_decoder(x);\
-if(!codec) {GUI_Alert(QT_TR_NOOP(&quot;Internal error finding codec&quot;#x));ADM_assert(0);} \
+if(!codec) {GUI_Error_HIG(&quot;Codec&quot;,QT_TR_NOOP(&quot;Internal error finding codec&quot;#x));ADM_assert(0);} \
   codecId=x; \
   _context-&gt;workaround_bugs=1*FF_BUG_AUTODETECT +1*FF_BUG_NO_PADDING;/**/ \
   _context-&gt;error_concealment=3; \
   if (avcodec_open(_context, codec) &lt; 0)  \
                       { \
                                         printf(&quot;[lavc] Decoder init: &quot;#x&quot; video decoder failed!\n&quot;); \
-                                        GUI_Alert(&quot;Internal error opening &quot;#x); \
+                                        GUI_Error_HIG(&quot;Codec&quot;,&quot;Internal error opening &quot;#x); \
                                         ADM_assert(0); \
                                 } \
                                 else \

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_codecs/ADM_ffmpeg.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_codecs/ADM_ffmpeg.cpp	2008-04-10 23:44:37 UTC (rev 3975)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_codecs/ADM_ffmpeg.cpp	2008-04-11 17:37:22 UTC (rev 3976)
@@ -47,9 +47,9 @@
 #define WRAP_Open(x) \
 {\
 AVCodec *codec=avcodec_find_encoder(x);\
-if(!codec) {GUI_Alert(QT_TR_NOOP(&quot;Internal error opening codec&quot;#x));ADM_assert(0);} \
+if(!codec) {GUI_Error_HIG(&quot;Codec&quot;,QT_TR_NOOP(&quot;Internal error opening codec&quot;#x));ADM_assert(0);} \
   res=avcodec_open(_context, codec); \
-  if(res&lt;0) {GUI_Alert(QT_TR_NOOP(&quot;Internal error with context for  codec&quot;#x&quot;.\n Did you use too low / too high target for 2 pass ?&quot;));return 0;} \
+  if(res&lt;0) {GUI_Error_HIG(&quot;Codec&quot;,QT_TR_NOOP(&quot;Internal error with context for  codec&quot;#x&quot;.\n Did you use too low / too high target for 2 pass ?&quot;));return 0;} \
 }
 /*****************************************/
 uint8_t ffmpegEncoder::stopEncoder(void)

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_core/include/ADM_misc.h
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_core/include/ADM_misc.h	2008-04-10 23:44:37 UTC (rev 3975)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_core/include/ADM_misc.h	2008-04-11 17:37:22 UTC (rev 3976)
@@ -11,14 +11,6 @@
 
 #include &quot;ADM_coreConfig.h&quot;
 
-typedef enum 
-{
-        ADM_LOG_NONE=0,
-        ADM_LOG_IMPORTANT=1,
-        ADM_LOG_INFO=2,
-        ADM_LOG_DEBUG=3
-  
-} ADM_LOG_LEVEL;
 
 typedef struct 
 {

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_coreUI/include/DIA_coreToolkit.h
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_coreUI/include/DIA_coreToolkit.h	2008-04-10 23:44:37 UTC (rev 3975)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_coreUI/include/DIA_coreToolkit.h	2008-04-11 17:37:22 UTC (rev 3976)
@@ -18,9 +18,23 @@
 
 #ifndef ADM_COREUI_TOOLKIT__
 #define ADM_COREUI_TOOLKIT__
+&lt;&lt;&lt;&lt;&lt;&lt;&lt; HEAD:avidemux/ADM_coreUI/include/DIA_coreToolkit.h
+
+
+typedef enum 
+{
+        ADM_LOG_NONE=0,
+        ADM_LOG_IMPORTANT=1,
+        ADM_LOG_INFO=2,
+        ADM_LOG_DEBUG=3
+  
+} ADM_LOG_LEVEL;
+
+=======
 // These two are obsoletes...
 void            GUI_Alert(const char *alertstring);
 void            GUI_Info(const char *alertstring);
+&gt;&gt;&gt;&gt;&gt;&gt;&gt; master:avidemux/ADM_coreUI/include/DIA_coreToolkit.h
 // Display a warning/info/debug message. The primary field is the &quot;title&quot; of the window, secondary format is printf like
 void            GUI_Info_HIG(const ADM_LOG_LEVEL level,const char *primary, const char *secondary_format, ...);
 // Display an error message. The primary field is the &quot;title&quot; of the window, secondary format is printf like

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_coreUI/include/DIA_coreUI_internal.h
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_coreUI/include/DIA_coreUI_internal.h	2008-04-10 23:44:37 UTC (rev 3975)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_coreUI/include/DIA_coreUI_internal.h	2008-04-11 17:37:22 UTC (rev 3976)
@@ -113,4 +113,29 @@
 }FactoryDescriptor;
 //
 uint8_t DIA_factoryInit(FactoryDescriptor *d);
+
+// This is for coreToolkit UI elements
+typedef void            CREATE_GUI_INFO_HIG(const ADM_LOG_LEVEL level,const char *primary, const char *secondary_format);
+typedef void            CREATE_GUI_ERROR_HIG(const char *primary, const char *secondary_format);
+typedef int             CREATE_GUI_CONFIRMATION_HIG(const char *button_confirm, const char *primary, const char *secondary_format);
+typedef int             CREATE_GUI_YESNO(const char *primary, const char *secondary_format);
+typedef int             CREATE_GUI_QUESTION(const char *alertstring);
+typedef int             CREATE_GUI_ALTERNATE(char *title,char *choice1,char *choice2);
+typedef void            CREATE_GUI_VERBOSE(void);
+typedef void            CREATE_GUI_QUIET(void);
+typedef uint8_t			CREATE_GUI_IS_GUIET(void);
+// GUI_Sleep is internal
+typedef struct
+{
+	CREATE_GUI_INFO_HIG 		*infoHig;
+	CREATE_GUI_ERROR_HIG		*errorHig;
+	CREATE_GUI_CONFIRMATION_HIG *confirmationHig;
+	CREATE_GUI_YESNO 			*yesno;
+	CREATE_GUI_QUESTION 		*question;
+	CREATE_GUI_ALTERNATE        *alternate;
+	CREATE_GUI_VERBOSE 			*verbose;
+	CREATE_GUI_QUIET 			*quiet;
+	CREATE_GUI_IS_GUIET 		*isQuiet;
+}CoreToolkitDescriptor;
+uint8_t  DIA_toolkitInit(CoreToolkitDescriptor *d);
 #endif

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_coreUI/src/CMakeLists.txt
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_coreUI/src/CMakeLists.txt	2008-04-10 23:44:37 UTC (rev 3975)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_coreUI/src/CMakeLists.txt	2008-04-11 17:37:22 UTC (rev 3976)
@@ -1,6 +1,7 @@
 SET(ADM_coreUI_SRCS 
 	DIA_factory.cpp
 	DIA_fileSel.cpp
+        DIA_coreToolkit.cpp
 )
 
 ADD_LIBRARY(ADM_coreUI SHARED ${ADM_coreUI_SRCS})

Added: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_coreUI/src/DIA_coreToolkit.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_coreUI/src/DIA_coreToolkit.cpp	2008-04-10 23:44:37 UTC (rev 3975)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_coreUI/src/DIA_coreToolkit.cpp	2008-04-11 17:37:22 UTC (rev 3976)
@@ -0,0 +1,172 @@
+/** *************************************************************************
+        \file                  DIA_coreToolkit.cpp
+ 
+		(c) 2008 Mean, <A HREF="https://lists.berlios.de/mailman/listinfo/avidemux-svn-commit">fixounet at free.fr</A>
+
+ ***************************************************************************/
+
+/***************************************************************************
+ *                                                                         *
+ *   This program is free software; you can redistribute it and/or modify  *
+ *   it under the terms of the GNU General Public License as published by  *
+ *   the Free Software Foundation; either version 2 of the License, or     *
+ *   (at your option) any later version.                                   *
+ *                                                                         *
+ ***************************************************************************/
+
+#include &quot;ADM_default.h&quot;
+#include &quot;DIA_coreToolkit.h&quot;
+#include &quot;DIA_coreUI_internal.h&quot;
+#include &quot;DIA_factoryStubs.h&quot;
+#include &lt;stdarg.h&gt;
+static CoreToolkitDescriptor *Toolkit=NULL;
+#define MAX_ALERT_SIZE 1024
+/**
+ * 	\fn DIA_toolkitInit
+ *  \brief Hook a set of coreUIToolkit into the dll (needed for win32)
+ */
+uint8_t  DIA_toolkitInit(CoreToolkitDescriptor *d)
+{
+	uint32_t major,minor,patch;
+	Toolkit=d;
+	return 1;
+}
+/**
+ * 	\fn GUI_Info_HIG
+ *  \brief Display a warning/info/debug message. The primary field is the &quot;title&quot; of the window, secondary format is printf like
+ */
+
+void            GUI_Info_HIG(const ADM_LOG_LEVEL level,const char *primary, const char *secondary_format, ...)
+{
+	char text[MAX_ALERT_SIZE+1];
+	ADM_assert(Toolkit);
+	va_list ap;
+	
+		va_start(ap, secondary_format);
+		if (secondary_format)
+		{
+			 vsnprintf(text,
+						MAX_ALERT_SIZE,
+						secondary_format, 
+						ap);
+		}		
+		va_end(ap);
+		
+	Toolkit-&gt;infoHig(level,primary,text);
+	
+}
+/**
+ * 	\fn GUI_Error_HIG
+ *  \brief Display an error message. The primary field is the &quot;title&quot; of the window, secondary format is printf like
+ */
+
+void            GUI_Error_HIG(const char *primary, const char *secondary_format, ...)
+{
+	char text[MAX_ALERT_SIZE+1];
+		ADM_assert(Toolkit);
+		va_list ap;
+		
+			va_start(ap, secondary_format);
+			if (secondary_format)
+			{
+				 vsnprintf(text,
+							MAX_ALERT_SIZE,
+							secondary_format, 
+							ap);
+			}		
+			va_end(ap);
+	Toolkit-&gt;errorHig(primary,text);	
+}
+/**
+ * 	\fn GUI_Confirmation_HIG
+ *  \brief ask for confirmation. The button_confirm will be the title of the button (accept, do it,...)
+ */
+
+int             GUI_Confirmation_HIG(const char *button_confirm, const char *primary, const char *secondary_format, ...)
+{
+	char text[MAX_ALERT_SIZE+1];
+			ADM_assert(Toolkit);
+			va_list ap;
+			
+				va_start(ap, secondary_format);
+				if (secondary_format)
+				{
+					 vsnprintf(text,
+								MAX_ALERT_SIZE,
+								secondary_format, 
+								ap);
+				}		
+				va_end(ap);
+	return Toolkit-&gt;confirmationHig(button_confirm,primary,text);	
+}
+/**
+ * 	\fn GUI_YesNo
+ *  \brief Ask for yes/no. Yes will return 1, No will return 0
+ */
+
+int             GUI_YesNo(const char *primary, const char *secondary_format, ...)
+{
+	char text[MAX_ALERT_SIZE+1];
+			ADM_assert(Toolkit);
+			va_list ap;
+			
+				va_start(ap, secondary_format);
+				if (secondary_format)
+				{
+					 vsnprintf(text,
+								MAX_ALERT_SIZE,
+								secondary_format, 
+								ap);
+				}		
+				va_end(ap);
+	return Toolkit-&gt;yesno(primary,text);	
+}
+/**
+ * 	\fn GUI_Question
+ *  \brief About the same as GUI_YesNo, the button will be ok/cancel
+ */
+int             GUI_Question(const char *alertstring)
+{
+	ADM_assert(Toolkit);
+	return Toolkit-&gt;question(alertstring);	
+}
+/**
+ * 	\fn GUI_Alternate
+ *  \brief Ask to choose between choice1 and choice2
+ * 
+ */
+int             GUI_Alternate(char *title,char *choice1,char *choice2)
+{
+	ADM_assert(Toolkit);
+	return Toolkit-&gt;alternate(title,choice1,choice2);	
+}
+
+/**
+ * 	\fn GUI_Verbose
+ *  \brief  Set ui in verbose mode (default). Show all popup &amp; questions
+ */
+void            GUI_Verbose(void)
+{
+	ADM_assert(Toolkit);
+	Toolkit-&gt;verbose();	
+}
+/**
+ * 	\fn GUI_Quiet
+ *  \brief Set the ui in silent mode. All popups &amp; questions will be answered with their default value
+ */
+void            GUI_Quiet(void)
+{
+	ADM_assert(Toolkit);
+	Toolkit-&gt;quiet();	
+}
+/**
+ * 	\fn GUI_isQuiet
+ *  \brief  Is the UI in quiet mode ?
+ */
+uint8_t			GUI_isQuiet(void)
+{
+	ADM_assert(Toolkit);
+	return Toolkit-&gt;isQuiet();	
+}
+
+

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_coreUI/src/DIA_factory.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_coreUI/src/DIA_factory.cpp	2008-04-10 23:44:37 UTC (rev 3975)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_coreUI/src/DIA_factory.cpp	2008-04-11 17:37:22 UTC (rev 3976)
@@ -20,6 +20,7 @@
  ***************************************************************************/
 
 #include &quot;ADM_default.h&quot;
+#include &quot;DIA_coreToolkit.h&quot;
 #include &quot;DIA_coreUI_internal.h&quot;
 #include &quot;DIA_factoryStubs.h&quot;
 
@@ -44,6 +45,7 @@
 		printf(&quot;[CoreUI] Maybe Incompatible COREUI Minor version, compiled with %d, using %d\n&quot;,ADM_COREUI_MINOR,minor);
 	}
 	printf(&quot;[CoreUI] Compiled with patch version %d, using %d\n&quot;,ADM_COREUI_PATCH,patch);
+	return 1;
 }
 // ****************** All ************************
 uint8_t diaFactoryRun(const char *title,uint32_t nb,diaElem **elems)

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_coreUI/src/DIA_fileSel.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_coreUI/src/DIA_fileSel.cpp	2008-04-10 23:44:37 UTC (rev 3975)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_coreUI/src/DIA_fileSel.cpp	2008-04-11 17:37:22 UTC (rev 3976)
@@ -15,6 +15,7 @@
  ***************************************************************************/
 
 #include &quot;ADM_default.h&quot;
+#include &quot;DIA_coreToolkit.h&quot;
 #include &quot;DIA_coreUI_internal.h&quot;
 
 static DIA_FILESEL_DESC_T *fileSelDescriptor=NULL;

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_inputs/ADM_mp4/ADM_mp4Analyzer.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_inputs/ADM_mp4/ADM_mp4Analyzer.cpp	2008-04-10 23:44:37 UTC (rev 3975)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_inputs/ADM_mp4/ADM_mp4Analyzer.cpp	2008-04-11 17:37:22 UTC (rev 3976)
@@ -619,8 +619,14 @@
                                           commonPart(H264);
                                           // There is a avcC atom just after
                                           // configuration data for h264
+nextAtom:                                          
                                           adm_atom avcc(&amp;son);
                                           printf(&quot;Reading avcC, got %s\n&quot;,fourCC::tostringBE(avcc.getFCC()));
+                                          if(avcc.getFCC()==MKFCCR('c','o','l','r')) // Color atom
+                                          {
+                                        	  avcc.skipAtom();
+                                        	  goto nextAtom;
+                                          }
                                           int len,offset;
                                           VDEO.extraDataSize=avcc.getRemainingSize();
                                           VDEO.extraData=new uint8_t [VDEO.extraDataSize];

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_script/ADM_JSFunctions.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_script/ADM_JSFunctions.cpp	2008-04-10 23:44:37 UTC (rev 3975)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_script/ADM_JSFunctions.cpp	2008-04-11 17:37:22 UTC (rev 3976)
@@ -185,7 +185,7 @@
 		return JS_FALSE;
 	char  *stringa = JS_GetStringBytes(JSVAL_TO_STRING(argv[0]));
 	GUI_Verbose();
-	GUI_Alert(stringa);
+	GUI_Error_HIG(&quot;Error&quot;,stringa);
 	GUI_Quiet();
 
 	return JS_TRUE;
@@ -200,7 +200,7 @@
 		return JS_FALSE;
 	char  *stringa = JS_GetStringBytes(JSVAL_TO_STRING(argv[0]));
 	GUI_Verbose();
-	GUI_Info(stringa);
+	GUI_Info_HIG(ADM_LOG_IMPORTANT,&quot;Info&quot;,stringa);
 	GUI_Quiet();
 	return JS_TRUE;
 }// end displayInfo

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_jobs.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_jobs.cpp	2008-04-10 23:44:37 UTC (rev 3975)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_jobs.cpp	2008-04-11 17:37:22 UTC (rev 3976)
@@ -161,7 +161,7 @@
                         
                         default:
                                 printf(&quot;Event:%d\n&quot;,event); 
-                                GUI_Alert(QT_TR_NOOP(&quot;Unknown event&quot;));break;
+                                GUI_Error_HIG(&quot;Jobs&quot;,QT_TR_NOOP(&quot;Unknown event&quot;));break;
                 }
                 
         }

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialogFactory/DIA_dialogFactory.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialogFactory/DIA_dialogFactory.cpp	2008-04-10 23:44:37 UTC (rev 3975)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialogFactory/DIA_dialogFactory.cpp	2008-04-11 17:37:22 UTC (rev 3976)
@@ -14,6 +14,7 @@
 
 #include &quot;../ADM_toolkit_gtk/toolkit_gtk.h&quot;
 #include &quot;DIA_factory.h&quot;
+#include &quot;DIA_coreToolkit.h&quot;
 #include &quot;DIA_coreUI_internal.h&quot;
 
 static uint8_t  buildOneTab(GtkWidget *nb,int index, diaElemTabs *tab);

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialogFactory/FAC_bitrate.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialogFactory/FAC_bitrate.cpp	2008-04-10 23:44:37 UTC (rev 3975)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialogFactory/FAC_bitrate.cpp	2008-04-11 17:37:22 UTC (rev 3976)
@@ -17,11 +17,9 @@
 #include &quot;DIA_factory.h&quot;
 namespace ADM_GtkFactory
 {
-class diaElemBitrate : public diaElem
+class diaElemBitrate : public diaElemBitrateBase
 {
-  protected:
-    COMPRES_PARAMS    copy;
-    uint32_t maxQ;
+protected:
 public:
   
   diaElemBitrate(COMPRES_PARAMS *p,const char *toggleTitle,const char *tip=NULL);
@@ -63,7 +61,7 @@
 }
 
  diaElemBitrate::diaElemBitrate(COMPRES_PARAMS *p,const char *toggleTitle,const char *tip)
-  : diaElem(ELEM_BITRATE)
+  : diaElemBitrateBase()
 {
   param=(void *)p;
   memcpy(&amp;copy,p,sizeof(copy));

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_GTK/ADM_toolkit_gtk/TLK_filesel.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_GTK/ADM_toolkit_gtk/TLK_filesel.cpp	2008-04-10 23:44:37 UTC (rev 3975)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_GTK/ADM_toolkit_gtk/TLK_filesel.cpp	2008-04-11 17:37:22 UTC (rev 3976)
@@ -18,7 +18,7 @@
 ***************************************************************************/
 
 #include &quot;toolkit_gtk.h&quot;
-
+#include &quot;DIA_coreToolkit.h&quot;
 #include &lt;errno.h&gt;
 #include &lt;sys/types.h&gt;
 #include &lt;sys/stat.h&gt;

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_GTK/ADM_toolkit_gtk/choice.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_GTK/ADM_toolkit_gtk/choice.cpp	2008-04-10 23:44:37 UTC (rev 3975)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_GTK/ADM_toolkit_gtk/choice.cpp	2008-04-11 17:37:22 UTC (rev 3976)
@@ -63,6 +63,8 @@
 
 //
 //_______________________________
+namespace ADM_GtkCoreUIToolkit
+{
 int GUI_Alternate(char *title,char *choice1,char *choice2)
 {
     GtkWidget *window1;
@@ -132,5 +134,5 @@
     return ret;
 }
 
-
+} // End of namespace
 //EOF

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_GTK/ADM_toolkit_gtk/toolkit_dialog.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_GTK/ADM_toolkit_gtk/toolkit_dialog.cpp	2008-04-10 23:44:37 UTC (rev 3975)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_GTK/ADM_toolkit_gtk/toolkit_dialog.cpp	2008-04-11 17:37:22 UTC (rev 3976)
@@ -20,7 +20,8 @@
  ***************************************************************************/
 #include &quot;toolkit_gtk.h&quot;
 #include &quot;prefs.h&quot;
-
+#include &quot;DIA_coreToolkit.h&quot;
+#include &quot;DIA_coreUI_internal.h&quot;
 #define GLADE_HOOKUP_OBJECT(component,widget,name) \
   g_object_set_data_full (G_OBJECT (component), name, \
     gtk_widget_ref (widget), (GDestroyNotify) gtk_widget_unref)
@@ -102,6 +103,8 @@
 	Answers always no to question
 
 */
+namespace ADM_GtkCoreUIToolkit
+{
 uint8_t GUI_isQuiet(void )
 {
 	return beQuiet;
@@ -192,7 +195,7 @@
 @secondary_format: printf()-style format string for secondary text, or NULL for no secondary text
 @...: arguments for secondary_format
 */
-void GUI_Info_HIG(const ADM_LOG_LEVEL level,const char *primary, const char *secondary_format, ...)
+void GUI_Info_HIG(const ADM_LOG_LEVEL level,const char *primary, const char *secondary_format)
 {
 	GtkWidget *dialog;
 	uint32_t msglvl=2;
@@ -205,22 +208,18 @@
                 return;
         }
 
-	va_list ap;
-	va_start(ap, secondary_format);
 
 	char *alertstring;
 	
 	if (secondary_format)
 	{
-		char *secondary = g_strdup_vprintf(secondary_format, ap);
+
 		if (beQuiet)
 		{
-			printf(&quot;Info: %s\n%s\n&quot;, primary, secondary);
-			g_free(secondary);
+			printf(&quot;Info: %s\n%s\n&quot;, primary, secondary_format);
 			return;
 		}
-		alertstring = g_strconcat(&quot;&lt;span size=\&quot;larger\&quot; weight=\&quot;bold\&quot;&gt;&quot;, primary, &quot;&lt;/span&gt;\n\n&quot;, secondary, NULL);
-		g_free(secondary);
+		alertstring = g_strconcat(&quot;&lt;span size=\&quot;larger\&quot; weight=\&quot;bold\&quot;&gt;&quot;, primary, &quot;&lt;/span&gt;\n\n&quot;, secondary_format, NULL);
 	}
 	else
 	{	
@@ -232,7 +231,6 @@
 		alertstring = g_strconcat(&quot;&lt;span size=\&quot;larger\&quot; weight=\&quot;bold\&quot;&gt;&quot;, primary, &quot;&lt;/span&gt;&quot;, NULL);
 	}
 	
-	va_end(ap);
 	
 	dialog=create_dialogInfo();
 	gtk_label_set_text(GTK_LABEL(WID(label1)), alertstring);
@@ -245,32 +243,7 @@
 	UI_purge();
 }
 
-/**
-	GUI_Alert : Just display an alert string in a dialog box
-	The string can contain \n for multi lines display
-	
-	Deprecated - for error alerts, use GUI_Error_HIG.
-*/
-void 		GUI_Alert(const char *alertstring)
-{
-	   GtkWidget *dialog;
 
-        if(beQuiet) 
-        {
-                printf(&quot;Info: %s\n&quot;,alertstring);
-                return  ;
-        }
-        dialog=create_dialogWarning();
-        gtk_label_set_text(GTK_LABEL(WID(label1)),alertstring);
-        gtk_label_set_use_markup(GTK_LABEL(WID(label1)), TRUE);
-        gtk_register_dialog(dialog);
-        gtk_dialog_run(GTK_DIALOG(dialog));
-        gtk_unregister_dialog(dialog);
-        gtk_widget_destroy(dialog);
-	UI_purge();
-
-}
-
 /**
 GUI_Error_HIG: display an error dialog.
 Takes primary and optional secondary string, as described in GNOME HIG 2.0.
@@ -279,7 +252,7 @@
 @secondary_format: printf()-style format string for secondary text, or NULL for no secondary text
 @...: arguments for secondary_format
 */
-void GUI_Error_HIG(const char *primary, const char *secondary_format, ...)
+void GUI_Error_HIG(const char *primary, const char *secondary_format)
 {
 	GtkWidget *dialog;
 	uint32_t msglvl=2;
@@ -291,22 +264,18 @@
                 return;
         }
 
-	va_list ap;
-	va_start(ap, secondary_format);
 
 	char *alertstring;
 	
 	if (secondary_format)
 	{
-		char *secondary = g_strdup_vprintf(secondary_format, ap);
+		
 		if (beQuiet)
 		{
-			printf(&quot;Info: %s\n%s\n&quot;, primary, secondary);
-			g_free(secondary);
+			printf(&quot;Info: %s\n%s\n&quot;, primary, secondary_format);
 			return;
 		}
-		alertstring = g_strconcat(&quot;&lt;span size=\&quot;larger\&quot; weight=\&quot;bold\&quot;&gt;&quot;, primary, &quot;&lt;/span&gt;\n\n&quot;, secondary, NULL);
-		g_free(secondary);
+		alertstring = g_strconcat(&quot;&lt;span size=\&quot;larger\&quot; weight=\&quot;bold\&quot;&gt;&quot;, primary, &quot;&lt;/span&gt;\n\n&quot;, secondary_format, NULL);
 	}
 	else
 	{	
@@ -318,7 +287,6 @@
 		alertstring = g_strconcat(&quot;&lt;span size=\&quot;larger\&quot; weight=\&quot;bold\&quot;&gt;&quot;, primary, &quot;&lt;/span&gt;&quot;, NULL);
 	}
 	
-	va_end(ap);
 	
 	dialog=create_dialogWarning();
 	gtk_label_set_text(GTK_LABEL(WID(label1)), alertstring);
@@ -345,27 +313,22 @@
 @secondary_format: printf()-style format string for secondary text, or NULL for no secondary text
 @...: arguments for secondary_format
 */
-int GUI_Confirmation_HIG(const char *button_confirm, const char *primary, const char *secondary_format, ...)
+int GUI_Confirmation_HIG(const char *button_confirm, const char *primary, const char *secondary_format)
 {
 	int ret=0;
 	GtkWidget *dialog;
 	
-	va_list ap;
-	va_start(ap, secondary_format);
-
 	char *alertstring;
 	
 	if (secondary_format)
 	{
-		char *secondary = g_strdup_vprintf(secondary_format, ap);
+		
 		if (beQuiet)
 		{
-			printf(&quot;Info: %s\n%s\n&quot;, primary, secondary);
-			g_free(secondary);
+			printf(&quot;Info: %s\n%s\n&quot;, primary, secondary_format);
 			return 0;
 		}
-		alertstring = g_strconcat(&quot;&lt;span size=\&quot;larger\&quot; weight=\&quot;bold\&quot;&gt;&quot;, primary, &quot;&lt;/span&gt;\n\n&quot;, secondary, NULL);
-		g_free(secondary);
+		alertstring = g_strconcat(&quot;&lt;span size=\&quot;larger\&quot; weight=\&quot;bold\&quot;&gt;&quot;, primary, &quot;&lt;/span&gt;\n\n&quot;, secondary_format, NULL);
 	}
 	else
 	{	
@@ -377,7 +340,6 @@
 		alertstring = g_strconcat(&quot;&lt;span size=\&quot;larger\&quot; weight=\&quot;bold\&quot;&gt;&quot;, primary, &quot;&lt;/span&gt;&quot;, NULL);
 	}
 	
-	va_end(ap);
 
 	dialog=create_dialogConfirmation(button_confirm);
 	gtk_label_set_text(GTK_LABEL(WID(label1)), alertstring);
@@ -408,27 +370,22 @@
 @secondary_format: printf()-style format string for secondary text, or NULL for no secondary text
 @...: arguments for secondary_format
 */
-int GUI_YesNo(const char *primary, const char *secondary_format, ...)
+int GUI_YesNo(const char *primary, const char *secondary_format)
 {
 	int ret=0;
 	GtkWidget *dialog;
 	
-	va_list ap;
-	va_start(ap, secondary_format);
-
 	char *alertstring;
 	
 	if (secondary_format)
 	{
-		char *secondary = g_strdup_vprintf(secondary_format, ap);
+		
 		if (beQuiet)
 		{
-			printf(&quot;Info: %s\n%s\n&quot;, primary, secondary);
-			g_free(secondary);
+			printf(&quot;Info: %s\n%s\n&quot;, primary, secondary_format);
 			return 0;
 		}
-		alertstring = g_strconcat(&quot;&lt;span size=\&quot;larger\&quot; weight=\&quot;bold\&quot;&gt;&quot;, primary, &quot;&lt;/span&gt;\n\n&quot;, secondary, NULL);
-		g_free(secondary);
+		alertstring = g_strconcat(&quot;&lt;span size=\&quot;larger\&quot; weight=\&quot;bold\&quot;&gt;&quot;, primary, &quot;&lt;/span&gt;\n\n&quot;, secondary_format, NULL);
 	}
 	else
 	{	
@@ -440,7 +397,6 @@
 		alertstring = g_strconcat(&quot;&lt;span size=\&quot;larger\&quot; weight=\&quot;bold\&quot;&gt;&quot;, primary, &quot;&lt;/span&gt;&quot;, NULL);
 	}
 	
-	va_end(ap);
 
 	dialog=create_dialogYN();
 	gtk_label_set_text(GTK_LABEL(WID(label1)), alertstring);
@@ -456,7 +412,27 @@
 	UI_purge();
 	return ret;
 }
+extern int GUI_Alternate(char *title,char *choice1,char *choice2);
+} // End of namespace
 
+static CoreToolkitDescriptor GtkCoreToolkitDescriptor=
+{
+		&amp;ADM_GtkCoreUIToolkit::GUI_Info_HIG,
+		&amp;ADM_GtkCoreUIToolkit::GUI_Error_HIG,
+		&amp;ADM_GtkCoreUIToolkit::GUI_Confirmation_HIG,
+		&amp;ADM_GtkCoreUIToolkit::GUI_YesNo,
+		&amp;ADM_GtkCoreUIToolkit::GUI_Question,
+		&amp;ADM_GtkCoreUIToolkit::GUI_Alternate,
+		&amp;ADM_GtkCoreUIToolkit::GUI_Verbose,
+		&amp;ADM_GtkCoreUIToolkit::GUI_Quiet,
+		&amp;ADM_GtkCoreUIToolkit::GUI_isQuiet
+};
+
+void InitCoreToolkit(void )
+{
+	DIA_toolkitInit(&amp;GtkCoreToolkitDescriptor);
+	
+}
 /**
 	Return the line number of a selection
 	0 if no selection of fails

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_NONE/ADM_dialog/alert_none.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_NONE/ADM_dialog/alert_none.cpp	2008-04-10 23:44:37 UTC (rev 3975)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_NONE/ADM_dialog/alert_none.cpp	2008-04-11 17:37:22 UTC (rev 3976)
@@ -12,8 +12,8 @@
 
 #include &quot;prefs.h&quot;
 
+#include &quot;DIA_coreToolkit.h&quot;
 
-
 #include &quot;ADM_assert.h&quot; 
 
 #define BOX_SIZE 80
@@ -41,20 +41,6 @@
 }
 
 
-void            GUI_Alert(const char *alertstring)
-{
-  boxStart();
-  boxAdd(&quot;Alert&quot;);
-  boxAdd(alertstring);
-  boxEnd();
-}
-void            GUI_Info(const char *alertstring)
-{
-  boxStart();
-  boxAdd(&quot;Alert&quot;);
-  boxAdd(alertstring);
-  boxEnd();
-}
 
 void            GUI_Info_HIG(const ADM_LOG_LEVEL level,const char *primary, const char *secondary_format, ...)
 {
@@ -260,3 +246,8 @@
 {
  return 0; 
 }
+void InitCoreToolkit(void)
+{
+	
+}
+//EOF

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_NONE/ADM_gui2/file_none.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_NONE/ADM_gui2/file_none.cpp	2008-04-10 23:44:37 UTC (rev 3975)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_NONE/ADM_gui2/file_none.cpp	2008-04-11 17:37:22 UTC (rev 3976)
@@ -13,6 +13,7 @@
 #include &quot;ADM_default.h&quot;
 
 #include &quot;DIA_fileSel.h&quot;
+#include &quot;DIA_coreToolkit.h&quot;
 #include &quot;DIA_coreUI_internal.h&quot;
 
 namespace  ADM_CLI_fileSel
@@ -78,4 +79,4 @@
 uint8_t UI_getPhysicalScreenSize(void *window, uint32_t *w,uint32_t *h)
 {
   *w=*h=10000; 
-}
\ No newline at end of file
+}

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/alert_qt4.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/alert_qt4.cpp	2008-04-10 23:44:37 UTC (rev 3975)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/alert_qt4.cpp	2008-04-11 17:37:22 UTC (rev 3976)
@@ -1,13 +1,5 @@
-
-
-
-
-
-
-
-
 /**
-    \fn alert_qt4
+    \file alert_qt4
    copyright            : (C) 2007 by mean
     email                : Mean/<A HREF="https://lists.berlios.de/mailman/listinfo/avidemux-svn-commit">fixounet at free.fr</A>
  ***************************************************************************/
@@ -23,16 +15,15 @@
 
 #include &lt;QDialog&gt;
 #include &lt;QMessageBox&gt;
-
+#include &quot;DIA_coreToolkit.h&quot;
+#include &quot;DIA_coreUI_internal.h&quot;
 #include &quot;ADM_default.h&quot;
 #include &quot;prefs.h&quot;
 
-
-
-
 static int beQuiet=0;
 extern QWidget *QuiMainWindows;
-
+namespace ADM_Qt4CoreUIToolkit
+{
 //****************************************************************************************************
 void            GUI_Alert(const char *alertstring)
 {
@@ -51,12 +42,11 @@
 }
 
 //****************************************************************************************************
-void            GUI_Info_HIG(const ADM_LOG_LEVEL level,const char *primary, const char *secondary_format, ...)
+void            GUI_Info_HIG(const ADM_LOG_LEVEL level,const char *primary, const char *secondary_format)
 {
   uint32_t msglvl=2;
   char *string;
   char alertstring[1024];
-  char alertstring2[1024];
 
         prefs-&gt;get(MESSAGE_LEVEL,&amp;msglvl);
 
@@ -71,11 +61,7 @@
             snprintf(alertstring,1024,&quot;&lt;big&gt;&lt;b&gt;%s&lt;/b&gt;&lt;/big&gt;&quot;,primary);
          }else
          {
-            va_list ap;
-            va_start(ap, secondary_format);
-            vsnprintf(alertstring2,1023,secondary_format, ap);
-            snprintf(alertstring,1024,&quot;&lt;big&gt;&lt;b&gt;%s&lt;/b&gt;&lt;/big&gt;&lt;br&gt;&lt;br&gt;%s&quot;,primary,alertstring2);
-            va_end(ap);
+        	 snprintf(alertstring,1024,&quot;&lt;big&gt;&lt;b&gt;%s&lt;/b&gt;&lt;/big&gt;&lt;br&gt;&lt;br&gt;%s&quot;,primary,secondary_format);
          }
         QMessageBox::StandardButton reply;
           reply = QMessageBox::information(QuiMainWindows, QString::fromUtf8(QT_TR_NOOP(&quot;Info&quot;)),
@@ -84,13 +70,13 @@
 
 }
 //****************************************************************************************************
-void            GUI_Error_HIG(const char *primary, const char *secondary_format, ...)
+void            GUI_Error_HIG(const char *primary, const char *secondary_format)
 {
   uint32_t msglvl=2;
   char *string;
   char alertstring[1024];
-  char alertstring2[1024];
   
+  
         prefs-&gt;get(MESSAGE_LEVEL,&amp;msglvl);
 
         if(msglvl==ADM_LOG_NONE) 
@@ -104,11 +90,7 @@
             snprintf(alertstring,1024,&quot;&lt;big&gt;&lt;b&gt;%s&lt;/b&gt;&lt;/big&gt;&quot;,primary);
          }else
          {
-            va_list ap;
-            va_start(ap, secondary_format);
-            vsnprintf(alertstring2,1023,secondary_format, ap);
-            snprintf(alertstring,1024,&quot;&lt;big&gt;&lt;b&gt;%s&lt;/b&gt;&lt;/big&gt;&lt;br&gt;&lt;br&gt;%s&quot;,primary,alertstring2);
-            va_end(ap);
+        	 snprintf(alertstring,1024,&quot;&lt;big&gt;&lt;b&gt;%s&lt;/b&gt;&lt;/big&gt;&lt;br&gt;&lt;br&gt;%s&quot;,primary,secondary_format);
          }
           QMessageBox::StandardButton reply;
           reply = QMessageBox::critical(QuiMainWindows, QString::fromUtf8(QT_TR_NOOP(&quot;Info&quot;)),
@@ -116,11 +98,11 @@
                                     QMessageBox::Ok );
 }
 //****************************************************************************************************
-int             GUI_Confirmation_HIG(const char *button_confirm, const char *primary, const char *secondary_format, ...)
+int             GUI_Confirmation_HIG(const char *button_confirm, const char *primary, const char *secondary_format)
 {
 uint32_t msglvl=2;
 char alertstring[1024];
-char alertstring2[1024];
+
         if (beQuiet)
               {
                       printf(&quot;Info: %s\n&quot;, primary);
@@ -133,11 +115,7 @@
         }
         else
         {	
-              va_list ap;
-              va_start(ap, secondary_format);
-              vsnprintf(alertstring2,1023,secondary_format, ap);
-              snprintf(alertstring,1024,&quot;&lt;big&gt;&lt;b&gt;%s&lt;/b&gt;&lt;/big&gt;&lt;br&gt;&lt;br&gt;%s&quot;,primary,alertstring2);
-              va_end(ap);
+        	snprintf(alertstring,1024,&quot;&lt;big&gt;&lt;b&gt;%s&lt;/b&gt;&lt;/big&gt;&lt;br&gt;&lt;br&gt;%s&quot;,primary,secondary_format);
         }
           QMessageBox::StandardButton reply;
           reply = QMessageBox::question(QuiMainWindows, QString::fromUtf8(QT_TR_NOOP(&quot;Confirmation&quot;)),
@@ -147,7 +125,7 @@
         return 0; 
 }
 //****************************************************************************************************
-int             GUI_YesNo(const char *primary, const char *secondary_format, ...)
+int             GUI_YesNo(const char *primary, const char *secondary_format)
 {
 uint32_t msglvl=2;
 char alertstring[1024];
@@ -164,11 +142,7 @@
         }
         else
         {	
-              va_list ap;
-              va_start(ap, secondary_format);
-              vsnprintf(alertstring2,1023,secondary_format, ap);
-              snprintf(alertstring,1024,&quot;&lt;big&gt;&lt;b&gt;%s&lt;/b&gt;&lt;/big&gt;&lt;br&gt;&lt;br&gt;%s&quot;,primary,alertstring2);
-              va_end(ap);
+        	snprintf(alertstring,1024,&quot;&lt;big&gt;&lt;b&gt;%s&lt;/b&gt;&lt;/big&gt;&lt;br&gt;&lt;br&gt;%s&quot;,primary,secondary_format);
         }
           QMessageBox::StandardButton reply;
           reply = QMessageBox::question(QuiMainWindows, QString::fromUtf8(QT_TR_NOOP(&quot;Confirmation&quot;)),
@@ -252,4 +226,24 @@
   beQuiet=1;
 }
 //****************************************************************************************************
+}
+
+static CoreToolkitDescriptor Qt4CoreToolkitDescriptor=
+{
+		&amp;ADM_Qt4CoreUIToolkit::GUI_Info_HIG,
+		&amp;ADM_Qt4CoreUIToolkit::GUI_Error_HIG,
+		&amp;ADM_Qt4CoreUIToolkit::GUI_Confirmation_HIG,
+		&amp;ADM_Qt4CoreUIToolkit::GUI_YesNo,
+		&amp;ADM_Qt4CoreUIToolkit::GUI_Question,
+		&amp;ADM_Qt4CoreUIToolkit::GUI_Alternate,
+		&amp;ADM_Qt4CoreUIToolkit::GUI_Verbose,
+		&amp;ADM_Qt4CoreUIToolkit::GUI_Quiet,
+		&amp;ADM_Qt4CoreUIToolkit::GUI_isQuiet
+};
+
+void InitCoreToolkit(void )
+{
+	DIA_toolkitInit(&amp;Qt4CoreToolkitDescriptor);
+	
+}
 //EOF

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialogFactory/FAC_bar.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialogFactory/FAC_bar.cpp	2008-04-10 23:44:37 UTC (rev 3975)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialogFactory/FAC_bar.cpp	2008-04-11 17:37:22 UTC (rev 3976)
@@ -34,8 +34,20 @@
 
 extern const char *shortkey(const char *);
 
+namespace ADM_Qt4Factory
+{
+class diaElemBar : public diaElem
+{
+  protected :
+        uint32_t per;
+public:
+  
+  diaElemBar(uint32_t percent,const char *toggleTitle);
+  virtual ~diaElemBar() ;
+  void setMe(void *dialog, void *opaque,uint32_t line);
+  void getMe(void);
+};
 
-
 //********************************************************************
 diaElemBar::diaElemBar(uint32_t percent,const char *toggleTitle)
   : diaElem(ELEM_BAR)
@@ -68,5 +80,16 @@
 void diaElemBar::getMe(void)
 {
 }
+} // nameapsce
 
+diaElem  *qt4CreateBar(uint32_t percent,const char *toggleTitle)
+{
+	return new  ADM_Qt4Factory::diaElemBar(percent,toggleTitle);
+}
+void qt4DestroyBar(diaElem *e)
+{
+	ADM_Qt4Factory::diaElemBar *a=(ADM_Qt4Factory::diaElemBar *)e;
+	delete a;
+}
+//
 //EOF

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialogFactory/FAC_float.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialogFactory/FAC_float.cpp	2008-04-10 23:44:37 UTC (rev 3975)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialogFactory/FAC_float.cpp	2008-04-11 17:37:22 UTC (rev 3976)
@@ -32,7 +32,24 @@
 
 extern const char *shortkey(const char *);
 
+namespace ADM_qt4Factory
+{
 
+
+class diaElemFloat : public diaElem
+{
+
+public:
+  ELEM_TYPE_FLOAT min,max;
+  diaElemFloat(ELEM_TYPE_FLOAT *intValue,const char *toggleTitle, ELEM_TYPE_FLOAT min, 
+               ELEM_TYPE_FLOAT max,const char *tip=NULL);
+  virtual ~diaElemFloat() ;
+  void setMe(void *dialog, void *opaque,uint32_t line);
+  void getMe(void);
+  void      enable(uint32_t onoff) ;
+};
+
+
 //********************************************************************
 diaElemFloat::diaElemFloat(ELEM_TYPE_FLOAT *intValue,const char *toggleTitle, ELEM_TYPE_FLOAT min, ELEM_TYPE_FLOAT max,const char *tip)
   : diaElem(ELEM_TOGGLE)
@@ -86,3 +103,16 @@
   else
     box-&gt;setDisabled(1);
 }
+} // End of namespace
+//****************************Hoook*****************
+
+diaElem  *qt4CreateFloat(ELEM_TYPE_FLOAT *intValue,const char *toggleTitle, ELEM_TYPE_FLOAT min,
+        ELEM_TYPE_FLOAT max,const char *tip)
+{
+	return new  ADM_qt4Factory::diaElemFloat(intValue,toggleTitle,min,max,tip);
+}
+void qt4DestroyFloat(diaElem *e)
+{
+	ADM_qt4Factory::diaElemFloat *a=(ADM_qt4Factory::diaElemFloat *)e;
+	delete a;
+}

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialogFactory/FAC_frame.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialogFactory/FAC_frame.cpp	2008-04-10 23:44:37 UTC (rev 3975)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialogFactory/FAC_frame.cpp	2008-04-11 17:37:22 UTC (rev 3976)
@@ -33,6 +33,23 @@
 
 extern const char *shortkey(const char *);
 
+
+namespace ADM_qt4Factory
+{
+class diaElemFrame : public diaElemFrameBase
+{
+  
+public:
+  
+  diaElemFrame(const char *toggleTitle, const char *tip=NULL);
+  virtual ~diaElemFrame() ;
+  void setMe(void *dialog, void *opaque,uint32_t line);
+  void getMe(void) ;
+  void swallow(diaElem *widget);
+  void enable(uint32_t onoff);
+  void finalize(void);
+};
+
 diaElemFrame::diaElemFrame(const char *toggleTitle, const char *tip)
   : diaElemFrameBase()
 {
@@ -99,7 +116,16 @@
 {
   
 }
+} // End of namespace
+//****************************Hoook*****************
 
-//******************************************************
-
+diaElem  *qt4CreateFrame(const char *toggleTitle, const char *tip)
+{
+	return new  ADM_qt4Factory::diaElemFrame(toggleTitle,tip);
+}
+void qt4DestroyFrame(diaElem *e)
+{
+	ADM_qt4Factory::diaElemFrame *a=(ADM_qt4Factory::diaElemFrame *)e;
+	delete a;
+}
 //EOF

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialogFactory/FAC_hex.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialogFactory/FAC_hex.cpp	2008-04-10 23:44:37 UTC (rev 3975)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialogFactory/FAC_hex.cpp	2008-04-11 17:37:22 UTC (rev 3976)
@@ -29,7 +29,21 @@
 #include &quot;ADM_default.h&quot;
 #include &quot;DIA_factory.h&quot;
 #include &quot;ADM_assert.h&quot;
-
+namespace ADM_qt4Factory
+{
+class diaElemHex : public diaElem
+{
+  uint32_t dataSize;
+  uint8_t  *data;
+  
+public:
+  
+  diaElemHex(const char *toggleTitle, uint32_t dataSize,uint8_t *data);
+  virtual ~diaElemHex() ;
+  void setMe(void *dialog, void *opaque,uint32_t line);
+  void getMe(void) ;
+  void finalize(void);
+};
 extern const char *shortkey(const char *);
   diaElemHex::diaElemHex(const char *toggleTitle, uint32_t dataSize,uint8_t *data) :diaElem(ELEM_HEXDUMP){};
   diaElemHex::~diaElemHex() {};
@@ -37,5 +51,19 @@
   void diaElemHex::getMe(void) {} ;
   void diaElemHex::finalize(void) {};
 //******************************************************
+} // End of namespace
+//****************************Hoook*****************
 
+diaElem  *qt4CreateHex(const char *toggleTitle, uint32_t dataSize,uint8_t *data)
+{
+	return new  ADM_qt4Factory::diaElemHex(toggleTitle,dataSize,data);
+}
+void qt4DestroyHex(diaElem *e)
+{
+	ADM_qt4Factory::diaElemHex *a=(ADM_qt4Factory::diaElemHex *)e;
+	delete a;
+}
 //EOF
+
+
+//EOF

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialogFactory/FAC_integer.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialogFactory/FAC_integer.cpp	2008-04-10 23:44:37 UTC (rev 3975)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialogFactory/FAC_integer.cpp	2008-04-11 17:37:22 UTC (rev 3976)
@@ -35,7 +35,33 @@
 extern const char *shortkey(const char *);
 
 
+namespace ADM_qt4Factory
+{
+class diaElemInteger : public diaElem
+{
 
+public:
+  int32_t min,max;
+  diaElemInteger(int32_t *intValue,const char *toggleTitle, int32_t min, int32_t max,const char *tip=NULL);
+  virtual ~diaElemInteger() ;
+  void setMe(void *dialog, void *opaque,uint32_t line);
+  void getMe(void);
+  void      enable(uint32_t onoff) ;
+};
+/* Same but unsigned */
+class diaElemUInteger : public diaElem
+{
+
+public:
+  uint32_t min,max;
+  diaElemUInteger(uint32_t *intValue,const char *toggleTitle, uint32_t min, uint32_t max,const char *tip=NULL);
+  virtual ~diaElemUInteger() ;
+  void setMe(void *dialog, void *opaque,uint32_t line);
+  void getMe(void);
+  void      enable(uint32_t onoff) ;
+  
+};
+
 //********************************************************************
 diaElemInteger::diaElemInteger(int32_t *intValue,const char *toggleTitle, int32_t min, int32_t max,const char *tip)
   : diaElem(ELEM_TOGGLE)
@@ -144,6 +170,27 @@
     box-&gt;setDisabled(1);
 }
 //********************************************
+//****************************************************
+} // End of namespace
+//****************************Hoook*****************
 
+diaElem  *qt4CreateInteger(int32_t *intValue,const char *toggleTitle,int32_t min, int32_t max,const char *tip)
+{
+	return new  ADM_qt4Factory::diaElemInteger(intValue,toggleTitle,min,max,tip);
+}
+void qt4DestroyInteger(diaElem *e)
+{
+	ADM_qt4Factory::diaElemInteger *a=(ADM_qt4Factory::diaElemInteger *)e;
+	delete a;
+}
+diaElem  *qt4CreateUInteger(uint32_t *intValue,const char *toggleTitle,uint32_t min, uint32_t max,const char *tip)
+{
+	return new  ADM_qt4Factory::diaElemUInteger(intValue,toggleTitle,min,max,tip);
+}
+void qt4DestroyUInteger(diaElem *e)
+{
+	ADM_qt4Factory::diaElemUInteger *a=(ADM_qt4Factory::diaElemUInteger *)e;
+	delete a;
+}
 //EOF
 

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialogFactory/FAC_matrix.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialogFactory/FAC_matrix.cpp	2008-04-10 23:44:37 UTC (rev 3975)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialogFactory/FAC_matrix.cpp	2008-04-11 17:37:22 UTC (rev 3976)
@@ -32,9 +32,22 @@
 
 extern const char *shortkey(const char *);
 
+namespace ADM_qt4Factory
+{
+class diaElemMatrix : public diaElem
+{
+  protected:
+  public:
+    uint8_t *_matrix;
+    uint32_t _matrixSize;
+    		diaElemMatrix(uint8_t *trix,const char *toggleTitle, uint32_t trixSize,const char *tip=NULL);
+  virtual   ~diaElemMatrix() ;
+  void      setMe(void *dialog, void *opaque,uint32_t line);
+  void      getMe(void);
+  void      enable(uint32_t onoff) ;
+};
 
 
-
 diaElemMatrix::diaElemMatrix(uint8_t *trix,const char *toggleTitle, uint32_t trixSize,const char *tip)
   : diaElem(ELEM_MATRIX)
 {
@@ -114,4 +127,15 @@
 				  
 			  }
 }
+}
+//****************************Hoook*****************
 
+diaElem  *qt4CreateMatrix(uint8_t *trix,const char *toggleTitle, uint32_t trixSize,const char *tip)
+{
+	return new  ADM_qt4Factory::diaElemMatrix(trix,toggleTitle,trixSize,tip);
+}
+void qt4DestroyMatrix(diaElem *e)
+{
+	ADM_qt4Factory::diaElemMatrix *a=(ADM_qt4Factory::diaElemMatrix *)e;
+	delete a;
+}

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialogFactory/FAC_notch.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialogFactory/FAC_notch.cpp	2008-04-10 23:44:37 UTC (rev 3975)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialogFactory/FAC_notch.cpp	2008-04-11 17:37:22 UTC (rev 3976)
@@ -32,6 +32,20 @@
 
 extern const char *shortkey(const char *);
 
+namespace ADM_qt4Factory
+{
+
+
+class diaElemNotch : public diaElem
+{
+  uint32_t yesno;
+public:
+  
+  diaElemNotch(uint32_t yes,const char *toggleTitle, const char *tip=NULL);
+  virtual ~diaElemNotch() ;
+  void setMe(void *dialog, void *opaque,uint32_t line);
+  void getMe(void) {};
+};
 diaElemNotch::diaElemNotch(uint32_t yes,const char *toggleTitle, const char *tip)
   : diaElem(ELEM_NOTCH)
 {
@@ -57,5 +71,19 @@
  layout-&gt;addWidget(box,line,0);
 }
 //******************************************************
+//****************************************************
+} // End of namespace
+//****************************Hoook*****************
 
+diaElem  *qt4CreateNotch(uint32_t yes,const char *toggleTitle, const char *tip)
+{
+	return new  ADM_qt4Factory::diaElemNotch(yes,toggleTitle, tip);
+}
+void qt4DestroyNotch(diaElem *e)
+{
+	ADM_qt4Factory::diaElemNotch *a=(ADM_qt4Factory::diaElemNotch *)e;
+	delete a;
+}
 //EOF
+
+//EOF

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialogFactory/FAC_readOnlyText.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialogFactory/FAC_readOnlyText.cpp	2008-04-10 23:44:37 UTC (rev 3975)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialogFactory/FAC_readOnlyText.cpp	2008-04-11 17:37:22 UTC (rev 3976)
@@ -34,8 +34,33 @@
 
 extern const char *shortkey(const char *);
 
+namespace ADM_qt4Factory
+{
 
+class diaElemReadOnlyText : public diaElem
+{
 
+public:
+  
+  diaElemReadOnlyText(const char *readyOnly,const char *toggleTitle,const char *tip=NULL);
+  virtual ~diaElemReadOnlyText() ;
+  void setMe(void *dialog, void *opaque,uint32_t line);
+  void getMe(void);
+  
+};
+
+class diaElemText : public diaElem
+{
+
+public:
+  
+  diaElemText(char **text,const char *toggleTitle,const char *tip=NULL);
+  virtual ~diaElemText() ;
+  void setMe(void *dialog, void *opaque,uint32_t line);
+  void getMe(void);
+  void enable(uint32_t onoff);
+};
+
 //********************************************************************
 diaElemReadOnlyText::diaElemReadOnlyText(const char *readyOnly,const char *toggleTitle,const char *tip)
   : diaElem(ELEM_TOGGLE)
@@ -119,5 +144,28 @@
   else
     lineEdit-&gt;setDisabled(TRUE);
 }
+} // End of namespace
+//****************************Hoook*****************
 
+diaElem  *qt4CreateRoText(const char *text,const char *toggleTitle, const char *tip)
+{
+	return new  ADM_qt4Factory::diaElemReadOnlyText(text,toggleTitle,tip);
+}
+void qt4DestroyRoText(diaElem *e)
+{
+	ADM_qt4Factory::diaElemReadOnlyText *a=(ADM_qt4Factory::diaElemReadOnlyText *)e;
+	delete a;
+}
+
+diaElem  *qt4CreateText(char **text,const char *toggleTitle, const char *tip)
+{
+	return new  ADM_qt4Factory::diaElemText(text,toggleTitle,tip);
+}
+void qt4DestroyText(diaElem *e)
+{
+	ADM_qt4Factory::diaElemText *a=(ADM_qt4Factory::diaElemText *)e;
+	delete a;
+}
 //EOF
+
+//EOF

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialogFactory/T_bitrate.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialogFactory/T_bitrate.cpp	2008-04-10 23:44:37 UTC (rev 3975)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialogFactory/T_bitrate.cpp	2008-04-11 17:37:22 UTC (rev 3976)
@@ -34,6 +34,22 @@
 
 extern const char *shortkey(const char *);
 
+namespace ADM_Qt4Factory
+{
+class diaElemBitrate : public diaElemBitrateBase
+{
+protected:
+public:
+  
+  diaElemBitrate(COMPRES_PARAMS *p,const char *toggleTitle,const char *tip=NULL);
+  virtual ~diaElemBitrate() ;
+  void setMe(void *dialog, void *opaque,uint32_t line);
+  void getMe(void);
+  void setMaxQz(uint32_t qz);
+  
+  void updateMe(void);
+};
+
 class  ADM_Qbitrate : public QWidget
 {
      Q_OBJECT
@@ -241,5 +257,17 @@
   memcpy(param,&amp;copy,sizeof(copy));
 }
 
+} // End of namespace
+//****************************Hoook*****************
+
+diaElem  *qt4CreateBitrate(COMPRES_PARAMS *p,const char *toggleTitle,const char *tip)
+{
+	return new  ADM_Qt4Factory::diaElemBitrate(p,toggleTitle,tip);
+}
+void qt4DestroyBitrate(diaElem *e)
+{
+	ADM_Qt4Factory::diaElemBitrate *a=(ADM_Qt4Factory::diaElemBitrate *)e;
+	delete a;
+}
 //EOF
 

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialogFactory/T_button.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialogFactory/T_button.cpp	2008-04-10 23:44:37 UTC (rev 3975)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialogFactory/T_button.cpp	2008-04-11 17:37:22 UTC (rev 3976)
@@ -33,7 +33,22 @@
 #include &quot;ADM_assert.h&quot;
 
 extern const char *shortkey(const char *);
+namespace ADM_Qt4Factory
+{
+class diaElemButton : public diaElem
+{
+  protected:
+  public:
+    void            *_cookie;
+    ADM_FAC_CALLBACK *_callBack;
+            diaElemButton(const char *toggleTitle, ADM_FAC_CALLBACK *cb,void *cookie,const char *tip=NULL);
+  virtual   ~diaElemButton() ;
+  void      setMe(void *dialog, void *opaque,uint32_t line);
+  void      getMe(void);
+  void      enable(uint32_t onoff) ;
+};
 
+
 class  ADM_Qbutton : public QWidget
 {
      Q_OBJECT
@@ -69,7 +84,7 @@
 ADM_Qbutton::~ADM_Qbutton()
 {
 }
-
+//*****************************
 diaElemButton:: diaElemButton(const char *toggleTitle, ADM_FAC_CALLBACK *cb,void *cookie,const char *tip)
   : diaElem(ELEM_BUTTON)
 {
@@ -105,5 +120,19 @@
 {
 
 }
+
+}; // End of namespace
+//****************************Hoook*****************
+
+diaElem  *qt4CreateButton(const char *toggleTitle, ADM_FAC_CALLBACK *cb,void *cookie,const char *tip)
+{
+	return new  ADM_Qt4Factory::diaElemButton(toggleTitle,cb,cookie,tip);
+}
+void qt4DestroyButton(diaElem *e)
+{
+	ADM_Qt4Factory::diaElemButton *a=(ADM_Qt4Factory::diaElemButton *)e;
+	delete a;
+}
+//
 //EOF
 

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialogFactory/T_dialogFactory.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialogFactory/T_dialogFactory.cpp	2008-04-10 23:44:37 UTC (rev 3975)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialogFactory/T_dialogFactory.cpp	2008-04-11 17:37:22 UTC (rev 3976)
@@ -30,6 +30,9 @@
 
 #include &quot;ADM_default.h&quot;
 #include &quot;DIA_factory.h&quot;
+#include &quot;DIA_coreToolkit.h&quot;
+#include &quot;DIA_coreUI_internal.h&quot;
+
 #include &quot;ADM_assert.h&quot;
 
 class factoryWindow : public QDialog
@@ -52,12 +55,12 @@
 
 
 /**
-    \fn diaFactoryRun(const char *title,uint32_t nb,diaElem **elems)
+    \fn qt4DiaFactoryRun(const char *title,uint32_t nb,diaElem **elems)
     \brief  Run a dialog made of nb elems, each elem being described in the **elems
     @return 0 on failure, 1 on success
 */
 
-uint8_t diaFactoryRun(const char *title,uint32_t nb,diaElem **elems)
+uint8_t qt4DiaFactoryRun(const char *title,uint32_t nb,diaElem **elems)
 {
   factoryWindow dialog;
   
@@ -125,7 +128,10 @@
  }
   return t;
 }
-uint8_t diaFactoryRunTabs(const char *title,uint32_t nb,diaElemTabs **tabs)
+/**
+ * 	\fn qt4DiaFactoryRunTabs
+ */
+uint8_t qt4DiaFactoryRunTabs(const char *title,uint32_t nb,diaElemTabs **tabs)
 {
     factoryWindow dialog;
   
@@ -208,12 +214,146 @@
 
   layout-&gt;addItem(spacerItem, v, 0);
 }
+
 /**
  * 
  */
+/**
+ *  \fn gtkFactoryGetVersion
+ * 	\brief returns the version this has been compiled with
+ */
+void      qt4FactoryGetVersion(uint32_t *maj,uint32_t *minor,uint32_t *patch)
+{
+	*maj=ADM_COREUI_MAJOR;
+	*minor=ADM_COREUI_MINOR;
+	*patch=ADM_COREUI_PATCH;
+	
+}
+extern CREATE_BITRATE_T     qt4CreateBitrate;
+extern DELETE_DIA_ELEM_T    qt4DestroyBitrate;
+extern CREATE_BAR_T         qt4CreateBar;
+extern DELETE_DIA_ELEM_T    qt4DestroyBar;
+extern CREATE_FLOAT_T       qt4CreateFloat;
+extern DELETE_DIA_ELEM_T    qt4DestroyFloat;
+extern CREATE_FRAME_T		qt4CreateFrame;
+extern DELETE_DIA_ELEM_T    qt4DestroyFrame;
+extern CREATE_HEX_T         qt4CreateHex;
+extern DELETE_DIA_ELEM_T    qt4DestroyHex;
+extern CREATE_INTEGER_T     qt4CreateInteger;
+extern CREATE_UINTEGER_T    qt4CreateUInteger;
+extern DELETE_DIA_ELEM_T    qt4DestroyInteger;
+extern DELETE_DIA_ELEM_T    qt4DestroyUInteger;
+extern CREATE_MATRIX_T      qt4CreateMatrix;
+extern DELETE_DIA_ELEM_T    qt4DestroyMatrix;
+extern CREATE_NOTCH_T       qt4CreateNotch;
+extern DELETE_DIA_ELEM_T    qt4DestroyNotch;
+extern CREATE_READONLYTEXT_T qt4CreateRoText;
+extern CREATE_TEXT_T 	   qt4CreateText;
+extern DELETE_DIA_ELEM_T   qt4DestroyRoText;
+extern DELETE_DIA_ELEM_T   qt4DestroyText;
+extern CREATE_BUTTON_T     qt4CreateButton;
+extern DELETE_DIA_ELEM_T   qt4DestroyButton;
+extern CREATE_FILE_T       qt4CreateFile;
+extern DELETE_DIA_ELEM_T   qt4DestroyFile;
+extern CREATE_DIR_T        qt4CreateDir;
+extern DELETE_DIA_ELEM_T   qt4DestroyDir;
+extern CREATE_MENUDYNAMIC_T     qt4CreateMenuDynamic;
+extern CREATE_MENU_T       qt4CreateMenu;
+extern DELETE_DIA_ELEM_T   qt4DestroyMenu;
+extern DELETE_DIA_ELEM_T   qt4DestroyMenuDynamic;
+extern CREATE_USLIDER_T     qt4CreateUSlider;
+extern DELETE_DIA_ELEM_T    qt4DestroyUSlider;
+extern 	CREATE_SLIDER_T     qt4CreateSlider;
+extern 	DELETE_DIA_ELEM_T   qt4DestroySlider;
+extern CREATE_THREADCOUNT_T qt4CreateThreadCount;
+extern DELETE_DIA_ELEM_T    qt4DestroyThreadCount;
+extern CREATE_TOGGLE_UINT   qt4CreateToggleUint;
+extern DELETE_DIA_ELEM_T    qt4DestroyToggleUint;
+extern CREATE_TOGGLE_INT    qt4CreateToggleInt;
+extern DELETE_DIA_ELEM_T    qt4DestroyToggleInt;
+extern CREATE_TOGGLE_T      qt4CreateToggle;
+extern DELETE_DIA_ELEM_T    qt4DestroyToggle;
+
+//************
+static FactoryDescriptor Qt4FactoryDescriptor=
+{
+	&amp;qt4FactoryGetVersion,
+	&amp;qt4DiaFactoryRun,
+	&amp;qt4DiaFactoryRunTabs,
+	// Buttons
+	&amp;qt4CreateButton,
+	&amp;qt4DestroyButton,
+	// Bar
+	&amp;qt4CreateBar,
+	&amp;qt4DestroyBar,
+	// Float
+	&amp;qt4CreateFloat,
+	&amp;qt4DestroyFloat,
+	// Integer
+	&amp;qt4CreateInteger,
+	&amp;qt4DestroyInteger,
+	// UInteger
+	&amp;qt4CreateUInteger,
+	&amp;qt4DestroyUInteger,
+	// Notch
+	&amp;qt4CreateNotch,
+	&amp;qt4DestroyNotch,
+	// RoText
+	&amp;qt4CreateRoText,
+	&amp;qt4DestroyRoText,
+	// Text
+	&amp;qt4CreateText,
+	&amp;qt4DestroyText,
+	// Hex
+	&amp;qt4CreateHex,
+	&amp;qt4DestroyHex,
+	// Matrix
+	&amp;qt4CreateMatrix,
+	&amp;qt4DestroyMatrix,
+	// Menu
+	&amp;qt4CreateMenu,
+	&amp;qt4DestroyMenu,
+	&amp;qt4CreateMenuDynamic,
+	&amp;qt4DestroyMenuDynamic,
+	// ThreadCount
+	&amp;qt4CreateThreadCount,
+	&amp;qt4DestroyThreadCount,
+	// Bitrate
+	&amp;qt4CreateBitrate,
+	&amp;qt4DestroyBitrate,
+	// File
+	&amp;qt4CreateFile,
+	&amp;qt4DestroyFile,
+	// Dir
+	&amp;qt4CreateDir,
+	&amp;qt4DestroyDir,
+	// Frame
+	&amp;qt4CreateFrame,
+	&amp;qt4DestroyFrame,
+    // Toggle uint/int
+	&amp;qt4CreateToggleUint,
+	&amp;qt4DestroyToggleUint,
+	&amp;qt4CreateToggleInt,
+	&amp;qt4DestroyToggleInt,
+	// Regular toggle
+	&amp;qt4CreateToggle,
+	&amp;qt4DestroyToggle,
+	// Slider
+	&amp;qt4CreateUSlider,
+	&amp;qt4DestroyUSlider,
+	&amp;qt4CreateSlider,
+	&amp;qt4DestroySlider
+};
+
+/**
+ * 	\fn InitFactory
+ *  \brief Install our factory hooks
+ */
 void InitFactory(void)
 {
+	DIA_factoryInit(&amp;Qt4FactoryDescriptor);
 	
+	
 }
 
 //EOF

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialogFactory/T_filesel.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialogFactory/T_filesel.cpp	2008-04-10 23:44:37 UTC (rev 3975)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialogFactory/T_filesel.cpp	2008-04-11 17:37:22 UTC (rev 3976)
@@ -44,6 +44,39 @@
     ADM_FILEMODE_WRITE
 }ADM_fileMode;
 
+namespace ADM_Qt4Factory
+{
+class diaElemFile : public diaElemFileBase
+{
+
+protected:
+    
+public:
+  
+  diaElemFile(uint32_t writeMode,char **filename,const char *toggleTitle,
+              const char *defaultSuffix = 0,const char *tip=NULL);
+  virtual ~diaElemFile() ;
+  void setMe(void *dialog, void *opaque,uint32_t line);
+  void getMe(void);
+  
+  void   changeFile(void);
+  void   enable(uint32_t onoff);
+};
+class diaElemDirSelect : public diaElemDirSelectBase
+{
+
+public:
+  
+  diaElemDirSelect(char **filename,const char *toggleTitle,const char *tip=NULL);
+  virtual ~diaElemDirSelect() ;
+  void setMe(void *dialog, void *opaque,uint32_t line);
+  void getMe(void);
+  
+  void changeFile(void);
+  void   enable(uint32_t onoff);
+};
+
+
 class  ADM_Qfilesel : public QWidget
 {
      Q_OBJECT
@@ -187,7 +220,7 @@
   ADM_Qfilesel *fs=(ADM_Qfilesel *)myWidget;
   fs-&gt;setEnabled(onoff);
 }
-
+void diaElemFile::changeFile(void) {}
 //****************************
 diaElemDirSelect::diaElemDirSelect(char **filename,const char *toggleTitle,const char *selectDirDesc) :
 	diaElemDirSelectBase()
@@ -228,5 +261,29 @@
 void diaElemDirSelect::enable(uint32_t onoff) {}
   
 void diaElemDirSelect::changeFile(void) {}
+} // End of namespace
+//****************************Hoook*****************
 
+diaElem  *qt4CreateFile(uint32_t writeMode,char **filename,const char *toggleTitle,
+        const char *defaultSuffix ,const char *tip)
+{
+	return new  ADM_Qt4Factory::diaElemFile(writeMode,filename,toggleTitle,defaultSuffix ,tip);
+}
+void qt4DestroyFile(diaElem *e)
+{
+	ADM_Qt4Factory::diaElemFile *a=(ADM_Qt4Factory::diaElemFile *)e;
+	delete a;
+}
+
+diaElem  *qt4CreateDir(char **filename,const char *toggleTitle,const char *tip)
+{
+	return new  ADM_Qt4Factory::diaElemDirSelect(filename,toggleTitle,tip);
+}
+void qt4DestroyDir(diaElem *e)
+{
+	ADM_Qt4Factory::diaElemDirSelect *a=(ADM_Qt4Factory::diaElemDirSelect *)e;
+	delete a;
+}
 //EOF
+
+//EOF

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialogFactory/T_menu.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialogFactory/T_menu.cpp	2008-04-10 23:44:37 UTC (rev 3975)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialogFactory/T_menu.cpp	2008-04-11 17:37:22 UTC (rev 3976)
@@ -34,6 +34,47 @@
 
 
 extern const char *shortkey(const char *);
+
+namespace ADM_qt4Factory
+{
+class diaElemMenuDynamic : public diaElemMenuDynamicBase
+{
+protected:
+	
+
+public:
+  diaElemMenuDynamic(uint32_t *intValue,const char *itle, uint32_t nb, 
+               diaMenuEntryDynamic **menu,const char *tip=NULL);
+  
+  virtual   ~diaElemMenuDynamic() ;
+  void      setMe(void *dialog, void *opaque,uint32_t line);
+  void      getMe(void);
+  virtual uint8_t   link(diaMenuEntryDynamic *entry,uint32_t onoff,diaElem *w);
+  virtual void      updateMe(void);
+  virtual void      enable(uint32_t onoff) ;
+  virtual void      finalize(void);
+};
+//**********************
+class diaElemMenu : public diaElemMenuBase
+{
+protected:
+	
+
+	diaElemMenuDynamic  *dyna;
+	diaMenuEntryDynamic  **menus;	
+public:
+  diaElemMenu(uint32_t *intValue,const char *itle, uint32_t nb, 
+               const diaMenuEntry *menu,const char *tip=NULL);
+  
+  virtual ~diaElemMenu() ;
+  void setMe(void *dialog, void *opaque,uint32_t line);
+  void getMe(void);
+  virtual uint8_t   link(diaMenuEntry *entry,uint32_t onoff,diaElem *w);
+  virtual void      updateMe(void);
+  void      enable(uint32_t onoff) ;
+  void      finalize(void);;
+};
+
 /**/
 
   class ADM_QComboBox : public QComboBox
@@ -241,4 +282,29 @@
 {
   finalize();
 }
+//********************
+}; // End of namespace
+
+diaElem  *qt4CreateMenu(uint32_t *intValue,const char *itle, uint32_t nb,         const diaMenuEntry *menu,const char *tip)
+{
+	return new  ADM_qt4Factory::diaElemMenu(intValue,itle,nb,menu,tip);
+}
+void qt4DestroyMenu(diaElem *e)
+{
+	ADM_qt4Factory::diaElemMenu *a=(ADM_qt4Factory::diaElemMenu *)e;
+	delete a;
+}
+diaElem  *qt4CreateMenuDynamic(uint32_t *intValue,const char *itle, uint32_t nb, 
+        diaMenuEntryDynamic **menu,const char *tipp)
+{
+	return new  ADM_qt4Factory::diaElemMenuDynamic(intValue,itle,nb,menu,tipp);
+}
+void qt4DestroyMenuDynamic(diaElem *e)
+{
+	ADM_qt4Factory::diaElemMenuDynamic *a=(ADM_qt4Factory::diaElemMenuDynamic *)e;
+	delete a;
+}
+
 //EOF
+
+//EOF

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialogFactory/T_slider.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialogFactory/T_slider.cpp	2008-04-10 23:44:37 UTC (rev 3975)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialogFactory/T_slider.cpp	2008-04-11 17:37:22 UTC (rev 3976)
@@ -36,6 +36,39 @@
 
 
 
+namespace ADM_qt4Factory
+{
+
+
+class diaElemUSlider : public diaElemSliderBase
+{
+  protected:
+	  uint32_t min,max,incr;
+public:
+	diaElemUSlider(uint32_t *value,const char *toggleTitle, uint32_t min,uint32_t max,uint32_t incr = 1, const char *tip=NULL);
+  virtual   ~diaElemUSlider() ;
+  void      setMe(void *dialog, void *opaque,uint32_t line);
+  void      getMe(void);
+  void      enable(uint32_t onoff) ;
+  
+};
+class diaElemSlider : public diaElemSliderBase
+{
+  protected:
+    
+	  int32_t min,max,incr;
+    
+public:
+	diaElemSlider(int32_t *value,const char *toggleTitle, int32_t min,int32_t max,int32_t incr = 1, const char *tip=NULL);
+  virtual   ~diaElemSlider() ;
+  void      setMe(void *dialog, void *opaque,uint32_t line);
+  void      getMe(void);
+  void      enable(uint32_t onoff) ;
+  
+  
+};
+
+
 //********************************************************************
 
 class SpinSlider : public QWidget
@@ -203,4 +236,31 @@
     box-&gt;setEnabled(1);
   else
     box-&gt;setDisabled(1);
-}
\ No newline at end of file
+}
+
+//****************************************************
+} // End of namespace
+//****************************Hoook*****************
+
+diaElem  *qt4CreateSlider(int32_t *value,const char *toggleTitle, int32_t min,int32_t max,int32_t incr , const char *tip)
+{
+	return new  ADM_qt4Factory::diaElemSlider(value,toggleTitle,min,max,incr,tip);
+}
+void qt4DestroySlider(diaElem *e)
+{
+	ADM_qt4Factory::diaElemSlider *a=(ADM_qt4Factory::diaElemSlider *)e;
+	delete a;
+}
+diaElem  *qt4CreateUSlider(uint32_t *value,const char *toggleTitle, uint32_t min,uint32_t max,uint32_t incr , const char *tip)
+{
+	return new  ADM_qt4Factory::diaElemUSlider(value,toggleTitle,min,max,incr,tip);
+}
+void qt4DestroyUSlider(diaElem *e)
+{
+	ADM_qt4Factory::diaElemUSlider *a=(ADM_qt4Factory::diaElemUSlider *)e;
+	delete a;
+}
+//****************************************************
+//EOF
+
+

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialogFactory/T_threadCount.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialogFactory/T_threadCount.cpp	2008-04-10 23:44:37 UTC (rev 3975)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialogFactory/T_threadCount.cpp	2008-04-11 17:37:22 UTC (rev 3976)
@@ -26,6 +26,21 @@
 
 extern const char* shortkey(const char*);
 
+
+namespace ADM_qt4Factory
+{
+
+class diaElemThreadCount : public diaElem
+{
+
+public:
+  
+  diaElemThreadCount(uint32_t *value, const char *title, const char *tip = NULL);
+  virtual ~diaElemThreadCount() ;
+  void setMe(void *dialog, void *opaque, uint32_t line);
+  void getMe(void);
+};
+
 class ADM_QthreadCount : public QWidget
 {
 	Q_OBJECT
@@ -141,3 +156,16 @@
 	else
 		*val = (threadCount-&gt;spinBox)-&gt;value();
 }
+//**********************
+} // End of namesapce
+//**********************
+diaElem  *qt4CreateThreadCount(uint32_t *value, const char *title, const char *tip)
+{
+	return new  ADM_qt4Factory::diaElemThreadCount(value,title,tip);
+}
+void qt4DestroyThreadCount(diaElem *e)
+{
+	ADM_qt4Factory::diaElemThreadCount *a=(ADM_qt4Factory::diaElemThreadCount *)e;
+	delete a;
+}
+//EOF

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialogFactory/T_toggle.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialogFactory/T_toggle.cpp	2008-04-10 23:44:37 UTC (rev 3975)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialogFactory/T_toggle.cpp	2008-04-11 17:37:22 UTC (rev 3976)
@@ -32,6 +32,61 @@
 #include &quot;ADM_assert.h&quot;
 
 extern const char *shortkey(const char *);
+
+
+namespace ADM_qt4Factory
+{
+class diaElemToggle : public diaElemToggleBase
+{
+  protected:
+public:
+            diaElemToggle(uint32_t *toggleValue,const char *toggleTitle, const char *tip=NULL);
+  virtual   ~diaElemToggle() ;
+  void      setMe(void *dialog, void *opaque,uint32_t line);
+  void      getMe(void);
+  void      enable(uint32_t onoff) ;
+  void      finalize(void);
+  void      updateMe();
+  uint8_t   link(uint32_t onoff,diaElem *w);
+};
+
+class diaElemToggleUint : public diaElem
+{
+  protected:
+        uint32_t *emb;
+        const char *embName;
+        void *widgetUint;
+        uint32_t _min,_max;
+public:
+            diaElemToggleUint(uint32_t *toggleValue,const char *toggleTitle, uint32_t *uintval,
+            					const char *name,uint32_t min,uint32_t max,const char *tip=NULL);
+  virtual   ~diaElemToggleUint() ;
+  void      setMe(void *dialog, void *opaque,uint32_t line);
+  void      getMe(void);
+  void      enable(uint32_t onoff) ;
+  void      finalize(void);
+  void      updateMe();
+};
+class diaElemToggleInt : public diaElem
+{
+  protected:
+	  		 int32_t *emb;
+	         const char *embName;
+	         void *widgetUint;
+	         int32_t _min,_max;
+public:
+            diaElemToggleInt(uint32_t *toggleValue,const char *toggleTitle, int32_t *uintval,
+            				const char *name,int32_t min,int32_t max,const char *tip=NULL);
+  virtual   ~diaElemToggleInt() ;
+  void      setMe(void *dialog, void *opaque,uint32_t line);
+  void      getMe(void);
+  void      finalize(void);
+  void      updateMe();
+  void      enable(uint32_t onoff) ;
+};
+
+
+
 typedef enum
 {
     TT_TOGGLE,TT_TOGGLE_UINT,TT_TOGGLE_INT
@@ -367,9 +422,42 @@
   }
 }
 
-//******************************************************
+} // End of namespace
+//****************************Hoook*****************
 
+diaElem  *qt4CreateToggleUint(uint32_t *toggleValue,const char *toggleTitle, uint32_t *uintval,
+		const char *name,uint32_t min,uint32_t max,const char *tip)
+{
+	return new  ADM_qt4Factory::diaElemToggleUint(toggleValue,toggleTitle, uintval,
+			name,min,max,tip);
+}
+void qt4DestroyToggleUint(diaElem *e)
+{
+	ADM_qt4Factory::diaElemToggleUint *a=(ADM_qt4Factory::diaElemToggleUint *)e;
+	delete a;
+}
 
+diaElem  *qt4CreateToggleInt(uint32_t *toggleValue,const char *toggleTitle, int32_t *uintval,
+		const char *name,int32_t min,int32_t max,const char *tip)
+{
+	return new  ADM_qt4Factory::diaElemToggleInt(toggleValue,toggleTitle, uintval,
+			name,min,max,tip);
+}
+void qt4DestroyToggleInt(diaElem *e)
+{
+	ADM_qt4Factory::diaElemToggleInt *a=(ADM_qt4Factory::diaElemToggleInt *)e;
+	delete a;
+}
+diaElem  *qt4CreateToggle(uint32_t *toggleValue,const char *toggleTitle, const char *tip)
+{
+	return new  ADM_qt4Factory::diaElemToggle(toggleValue,toggleTitle, tip);
+}
+void qt4DestroyToggle(diaElem *e)
+{
+	ADM_qt4Factory::diaElemToggle *a=(ADM_qt4Factory::diaElemToggle *)e;
+	delete a;
+}
 
 
+
 //EOF

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/file_qt4.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/file_qt4.cpp	2008-04-10 23:44:37 UTC (rev 3975)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/file_qt4.cpp	2008-04-11 17:37:22 UTC (rev 3976)
@@ -18,6 +18,7 @@
 
 
 #include &quot;DIA_fileSel.h&quot;
+#include &quot;DIA_coreToolkit.h&quot;
 #include &quot;DIA_coreUI_internal.h&quot;
 
 #include &quot;prefs.h&quot;

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/main.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/main.cpp	2008-04-10 23:44:37 UTC (rev 3975)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/main.cpp	2008-04-11 17:37:22 UTC (rev 3976)
@@ -75,6 +75,7 @@
 extern void getUIDescription(char*);
 extern uint8_t ADM_ad_loadPlugins(const char *path);
 extern void InitFactory(void);
+extern void InitCoreToolkit(void);
 #ifdef __MINGW32__
 extern EXCEPTION_DISPOSITION exceptionHandler(struct _EXCEPTION_RECORD* pExceptionRec, void* pEstablisherFrame, struct _CONTEXT* pContextRecord, void* pDispatcherContext);
 #else
@@ -203,8 +204,13 @@
 #ifdef USE_XVID_4
     xvid4_init();
 #endif
+    // Hook our UI...
     InitFactory();
+    InitCoreToolkit();
     initFileSelector();
+    //****************
+    
+    
     ADM_InitMemcpy();
 
 	// Load .avidemuxrc


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="001237.html">[Avidemux-svn-commit] r3975 - in	branches/avidemux_2.5_branch_gruntster:	avidemux/ADM_audiocodec avidemux/ADM_core/include	avidemux/ADM_core/src avidemux/ADM_encoder	avidemux/ADM_libraries cmake
</A></li>
	<LI>Next message: <A HREF="001239.html">[Avidemux-svn-commit] r3977 -	branches/avidemux_2.5_branch_gruntster/avidemux/ADM_coreUI/include
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1238">[ date ]</a>
              <a href="thread.html#1238">[ thread ]</a>
              <a href="subject.html#1238">[ subject ]</a>
              <a href="author.html#1238">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/avidemux-svn-commit">More information about the Avidemux-svn-commit
mailing list</a><br>
</body></html>
