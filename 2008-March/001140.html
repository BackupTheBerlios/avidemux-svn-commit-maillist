<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Avidemux-svn-commit] r3877 - in	branches/avidemux_2.5_branch_mean_merged: . avidemux	avidemux/ADM_core/src avidemux/ADM_libraries/ADM_lavcodec	avidemux/ADM_libraries/ADM_lavformat	avidemux/ADM_libraries/ADM_libMpeg2Dec	avidemux/ADM_libraries/ADM_libmpeg2enc	avidemux/plugins/ADM_audiodecoder/ADM_ad_ac3	avidemux/plugins/ADM_audiodecoder/ADM_ad_ac3/ADM_liba52 cmake
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/avidemux-svn-commit/2008-March/index.html" >
   <LINK REL="made" HREF="mailto:avidemux-svn-commit%40lists.berlios.de?Subject=Re%3A%20%5BAvidemux-svn-commit%5D%20r3877%20-%20in%0A%09branches/avidemux_2.5_branch_mean_merged%3A%20.%20avidemux%0A%09avidemux/ADM_core/src%20avidemux/ADM_libraries/ADM_lavcodec%0A%09avidemux/ADM_libraries/ADM_lavformat%0A%09avidemux/ADM_libraries/ADM_libMpeg2Dec%0A%09avidemux/ADM_libraries/ADM_libmpeg2enc%0A%09avidemux/plugins/ADM_audiodecoder/ADM_ad_ac3%0A%09avidemux/plugins/ADM_audiodecoder/ADM_ad_ac3/ADM_liba52%20cmake&In-Reply-To=%3C200803121855.m2CItMmk002938%40sheep.berlios.de%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="001139.html">
   <LINK REL="Next"  HREF="001141.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Avidemux-svn-commit] r3877 - in	branches/avidemux_2.5_branch_mean_merged: . avidemux	avidemux/ADM_core/src avidemux/ADM_libraries/ADM_lavcodec	avidemux/ADM_libraries/ADM_lavformat	avidemux/ADM_libraries/ADM_libMpeg2Dec	avidemux/ADM_libraries/ADM_libmpeg2enc	avidemux/plugins/ADM_audiodecoder/ADM_ad_ac3	avidemux/plugins/ADM_audiodecoder/ADM_ad_ac3/ADM_liba52 cmake</H1>
    <B>mean at BerliOS</B> 
    <A HREF="mailto:avidemux-svn-commit%40lists.berlios.de?Subject=Re%3A%20%5BAvidemux-svn-commit%5D%20r3877%20-%20in%0A%09branches/avidemux_2.5_branch_mean_merged%3A%20.%20avidemux%0A%09avidemux/ADM_core/src%20avidemux/ADM_libraries/ADM_lavcodec%0A%09avidemux/ADM_libraries/ADM_lavformat%0A%09avidemux/ADM_libraries/ADM_libMpeg2Dec%0A%09avidemux/ADM_libraries/ADM_libmpeg2enc%0A%09avidemux/plugins/ADM_audiodecoder/ADM_ad_ac3%0A%09avidemux/plugins/ADM_audiodecoder/ADM_ad_ac3/ADM_liba52%20cmake&In-Reply-To=%3C200803121855.m2CItMmk002938%40sheep.berlios.de%3E"
       TITLE="[Avidemux-svn-commit] r3877 - in	branches/avidemux_2.5_branch_mean_merged: . avidemux	avidemux/ADM_core/src avidemux/ADM_libraries/ADM_lavcodec	avidemux/ADM_libraries/ADM_lavformat	avidemux/ADM_libraries/ADM_libMpeg2Dec	avidemux/ADM_libraries/ADM_libmpeg2enc	avidemux/plugins/ADM_audiodecoder/ADM_ad_ac3	avidemux/plugins/ADM_audiodecoder/ADM_ad_ac3/ADM_liba52 cmake">mean at mail.berlios.de
       </A><BR>
    <I>Wed Mar 12 19:55:22 CET 2008</I>
    <P><UL>
        <LI>Previous message: <A HREF="001139.html">[Avidemux-svn-commit] r3876 - in	branches/avidemux_2.5_branch_mean_merged: . avidemux	avidemux/ADM_audiocodec avidemux/ADM_core/src	avidemux/plugins/ADM_audiodecoder/ADM_ad_ac3	avidemux/plugins/ADM_audiodecoder/ADM_ad_ac3/ADM_liba52	avidemux/plugins/ADM_audiodecoder/ADM_ad_faad	avidemux/plugins/ADM_audiodecoder/ADM_ad_mad	avidemux/plugins/ADM_audiodecoder/ADM_ad_mad/ADM_libMad cmake
</A></li>
        <LI>Next message: <A HREF="001141.html">[Avidemux-svn-commit] r3878 - in	branches/avidemux_2.5_branch_mean_merged/avidemux/ADM_libraries:	ADM_lavcodec ADM_libMpeg2Dec
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1140">[ date ]</a>
              <a href="thread.html#1140">[ thread ]</a>
              <a href="subject.html#1140">[ subject ]</a>
              <a href="author.html#1140">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Author: mean
Date: 2008-03-12 19:55:21 +0100 (Wed, 12 Mar 2008)
New Revision: 3877

Modified:
   branches/avidemux_2.5_branch_mean_merged/CMakeLists.txt
   branches/avidemux_2.5_branch_mean_merged/avidemux/ADM_core/src/ADM_cpuCap.cpp
   branches/avidemux_2.5_branch_mean_merged/avidemux/ADM_core/src/ADM_dynamicLoading.cpp
   branches/avidemux_2.5_branch_mean_merged/avidemux/ADM_core/src/ADM_misc.cpp
   branches/avidemux_2.5_branch_mean_merged/avidemux/ADM_core/src/CMakeLists.txt
   branches/avidemux_2.5_branch_mean_merged/avidemux/ADM_core/src/TLK_clock.cpp
   branches/avidemux_2.5_branch_mean_merged/avidemux/ADM_libraries/ADM_lavcodec/CMakeLists.txt
   branches/avidemux_2.5_branch_mean_merged/avidemux/ADM_libraries/ADM_lavformat/ADM_lavformat.cpp
   branches/avidemux_2.5_branch_mean_merged/avidemux/ADM_libraries/ADM_libMpeg2Dec/CMakeLists.txt
   branches/avidemux_2.5_branch_mean_merged/avidemux/ADM_libraries/ADM_libMpeg2Dec/cpu_accel.c
   branches/avidemux_2.5_branch_mean_merged/avidemux/ADM_libraries/ADM_libmpeg2enc/ADM_mpe2enc.cpp
   branches/avidemux_2.5_branch_mean_merged/avidemux/CMakeLists.txt
   branches/avidemux_2.5_branch_mean_merged/avidemux/plugins/ADM_audiodecoder/ADM_ad_ac3/ADM_ad_a52.cpp
   branches/avidemux_2.5_branch_mean_merged/avidemux/plugins/ADM_audiodecoder/ADM_ad_ac3/ADM_liba52/CMakeLists.txt
   branches/avidemux_2.5_branch_mean_merged/avidemux/plugins/ADM_audiodecoder/ADM_ad_ac3/CMakeLists.txt
   branches/avidemux_2.5_branch_mean_merged/cmake/Ts.cmake
   branches/avidemux_2.5_branch_mean_merged/cmake/ad_plugin.cmake
   branches/avidemux_2.5_branch_mean_merged/cmake/admCheckMiscLibs.cmake
Log:
[Merge r3869]+cpucap fix


Modified: branches/avidemux_2.5_branch_mean_merged/CMakeLists.txt
===================================================================
--- branches/avidemux_2.5_branch_mean_merged/CMakeLists.txt	2008-03-12 18:55:18 UTC (rev 3876)
+++ branches/avidemux_2.5_branch_mean_merged/CMakeLists.txt	2008-03-12 18:55:21 UTC (rev 3877)
@@ -49,6 +49,13 @@
 	SET(USE_JOG 1)
 ENDIF (UNIX AND NOT APPLE)
 
+IF (WIN32)
+	SET(BIN_DIR .)
+ELSE (WIN32)
+	SET(BIN_DIR bin)
+ENDIF (WIN32)
+
+
 ########################################
 # Standard Avidemux defines
 ########################################
@@ -62,11 +69,11 @@
 SET(ADM_UI_QT4 1)
 
 SET(HAVE_AUDIO 1)
-SET(USE_MP3 1)
-SET(USE_AC3 1)
 SET(USE_FFMPEG 1)
 SET(USE_MJPEG 1)
+SET(ADM_INSTALL_DIR &quot;${CMAKE_INSTALL_PREFIX}&quot;)
 
+
 IF (NOT CMAKE_BUILD_TYPE)
 	SET(CMAKE_BUILD_TYPE &quot;Release&quot;)
 ELSEIF (CMAKE_BUILD_TYPE STREQUAL &quot;Debug&quot;)

Modified: branches/avidemux_2.5_branch_mean_merged/avidemux/ADM_core/src/ADM_cpuCap.cpp
===================================================================
--- branches/avidemux_2.5_branch_mean_merged/avidemux/ADM_core/src/ADM_cpuCap.cpp	2008-03-12 18:55:18 UTC (rev 3876)
+++ branches/avidemux_2.5_branch_mean_merged/avidemux/ADM_core/src/ADM_cpuCap.cpp	2008-03-12 18:55:21 UTC (rev 3877)
@@ -142,56 +142,10 @@
 	return ;
 }
 
-/************************************************************************/
-#ifdef ADM_CPU_X86
-#include &quot;ADM_libraries/ADM_libMpeg2Dec/mpeg2_cpu.h&quot;
-#endif
 
-int ADM_mpeg2dec_mm_support(void)
-{
-int rval=0;
-
-#ifdef ADM_CPU_X86
-#undef MATCH
-#define MATCH(x,y) if(CpuCaps::myCpuCaps &amp; CpuCaps::myCpuMask &amp; ADM_CPUCAP_##x) rval|=MPEG2_ACCEL_X86_##x;
-	
-	MATCH(MMX,MMX);
-	MATCH(MMXEXT,MMXEXT);
-	MATCH(3DNOW,3DNOW);
-#endif
-
-	return rval;
-}
 //******************************************************
-#ifdef ADM_CPU_X86
-#include &quot;ADM_lavcodec.h&quot;
-#endif
-/**
- * 		\fn lavcodec_mm_support
- * 		\brief Give lavcodec CPU supported ( FF_MM_MMX)
- */
-int ADM_lavcodec_mm_support(void)
-{
-int rval=0;
 
-#ifdef ADM_CPU_X86
-#undef MATCH
-#define MATCH(x,y) if(CpuCaps::myCpuCaps &amp;  CpuCaps::myCpuMask &amp; ADM_CPUCAP_##x) rval|=MM_##x;
 
-	MATCH(MMX,MMX);
-	MATCH(MMXEXT,MMXEXT);
-	MATCH(SSE,SSE);
-	MATCH(SSE2,SSE2);
-	MATCH(SSE3,SSE3);
-	MATCH(SSSE3,SSSE3);
-	MATCH(3DNOW,3DNOW);
-	MATCH(3DNOWEXT,3DNOWEXT);
-#endif
-
-	return rval;
-}
-// EOF
-
 // Stolen from x264
 int ADM_cpu_num_processors(void)
 {

Modified: branches/avidemux_2.5_branch_mean_merged/avidemux/ADM_core/src/ADM_dynamicLoading.cpp
===================================================================
--- branches/avidemux_2.5_branch_mean_merged/avidemux/ADM_core/src/ADM_dynamicLoading.cpp	2008-03-12 18:55:18 UTC (rev 3876)
+++ branches/avidemux_2.5_branch_mean_merged/avidemux/ADM_core/src/ADM_dynamicLoading.cpp	2008-03-12 18:55:21 UTC (rev 3877)
@@ -14,7 +14,6 @@
  *   (at your option) any later version.                                   *
  ***************************************************************************/
 
-#include &quot;config.h&quot;
 
 #include &lt;stdlib.h&gt;
 #include &lt;stdio.h&gt;

Modified: branches/avidemux_2.5_branch_mean_merged/avidemux/ADM_core/src/ADM_misc.cpp
===================================================================
--- branches/avidemux_2.5_branch_mean_merged/avidemux/ADM_core/src/ADM_misc.cpp	2008-03-12 18:55:18 UTC (rev 3876)
+++ branches/avidemux_2.5_branch_mean_merged/avidemux/ADM_core/src/ADM_misc.cpp	2008-03-12 18:55:21 UTC (rev 3877)
@@ -17,7 +17,6 @@
  *   (at your option) any later version.                                   *
  *                                                                         *
  ***************************************************************************/
-#include &quot;config.h&quot;
 #include &lt;stdio.h&gt;
 #include &lt;stdlib.h&gt;
 #include &lt;time.h&gt;

Modified: branches/avidemux_2.5_branch_mean_merged/avidemux/ADM_core/src/CMakeLists.txt
===================================================================
--- branches/avidemux_2.5_branch_mean_merged/avidemux/ADM_core/src/CMakeLists.txt	2008-03-12 18:55:18 UTC (rev 3876)
+++ branches/avidemux_2.5_branch_mean_merged/avidemux/ADM_core/src/CMakeLists.txt	2008-03-12 18:55:21 UTC (rev 3877)
@@ -1,9 +1,17 @@
 SET(ADM_core_SRCS 
-	ADM_cpuCap.cpp  ADM_memcpy.cpp  ADM_memsupport.cpp  ADM_threads.cpp  ADM_win32.cpp
-	ADM_memory.cpp  ADM_misc.cpp  TLK_clock.cpp  ADM_crashdump.cpp  ADM_fileio.cpp ADM_dynamicLoading.cpp)
+        ADM_cpuCap.cpp  ADM_memcpy.cpp  ADM_memsupport.cpp  ADM_threads.cpp  ADM_win32.cpp
+        ADM_memory.cpp  ADM_misc.cpp  TLK_clock.cpp  ADM_crashdump.cpp  ADM_fileio.cpp ADM_dynamicLoading.cpp)
 
-ADD_ADM_LIB_ALL_TARGETS(ADM_core ${ADM_core_SRCS})
-ADD_SOURCE_CFLAGS(ADM_fileio.cpp ${GLIB_CFLAGS})
+ADD_LIBRARY(ADM_core SHARED ${ADM_core_SRCS})
+ADD_TARGET_DEFINITIONS(ADM_core ADM_DEBUG FIND_LEAKS)
 
+IF (MINGW)
+        ADD_SOURCE_CFLAGS(ADM_fileio.cpp ${GLIB_CFLAGS})
+
+        ADD_TARGET_LDFLAGS(ADM_core ${GLIB_LDFLAGS})
+        TARGET_LINK_LIBRARIES(ADM_core pthreadGC2 imagehlp wsock32)
+ENDIF (MINGW)
+
 REMOVE_DEFINITIONS(-DHAVE_CONFIG_H)
 
+INSTALL(TARGETS ADM_core RUNTIME DESTINATION ${BIN_DIR} LIBRARY DESTINATION lib)

Modified: branches/avidemux_2.5_branch_mean_merged/avidemux/ADM_core/src/TLK_clock.cpp
===================================================================
--- branches/avidemux_2.5_branch_mean_merged/avidemux/ADM_core/src/TLK_clock.cpp	2008-03-12 18:55:18 UTC (rev 3876)
+++ branches/avidemux_2.5_branch_mean_merged/avidemux/ADM_core/src/TLK_clock.cpp	2008-03-12 18:55:21 UTC (rev 3877)
@@ -33,13 +33,12 @@
 #include &lt;unistd.h&gt;
 #include &lt;sys/time.h&gt;
 
-#include &quot;config.h&quot;
+#include &quot;ADM_default.h&quot;
 
 #include &quot;ADM_osSupport/ADM_debugID.h&quot;
 #define MODULE_NAME MODULE_CLOCKnTIMELEFT
 #include &quot;ADM_osSupport/ADM_debug.h&quot;
 
-#include &quot;avi_vars.h&quot;
 
 static uint8_t inited=0;
 static struct timeval _itimev;

Modified: branches/avidemux_2.5_branch_mean_merged/avidemux/ADM_libraries/ADM_lavcodec/CMakeLists.txt
===================================================================
--- branches/avidemux_2.5_branch_mean_merged/avidemux/ADM_libraries/ADM_lavcodec/CMakeLists.txt	2008-03-12 18:55:18 UTC (rev 3876)
+++ branches/avidemux_2.5_branch_mean_merged/avidemux/ADM_libraries/ADM_lavcodec/CMakeLists.txt	2008-03-12 18:55:21 UTC (rev 3877)
@@ -27,7 +27,9 @@
 	dvbsub_parser.c
 	dvbsubdec.c
 	dvbsub.c xiph.c
-	sp5xdec.c nellymoserdec.c)
+	sp5xdec.c nellymoserdec.c
+        ADM_lavcodec.cpp
+)
 
 IF(ADM_CPU_X86)
 	SET(${ADM_LIB}_SRCS  ${${ADM_LIB}_SRCS}
@@ -60,4 +62,4 @@
 
 INCLUDE(admLibFfmpeg)
 GET_FFMPEG_CFLAGS(FFMPEG_CFLAGS)
-ADD_CFLAGS_ALL_TARGETS(${ADM_LIB} &quot;${FFMPEG_CFLAGS}&quot;)
\ No newline at end of file
+ADD_CFLAGS_ALL_TARGETS(${ADM_LIB} &quot;${FFMPEG_CFLAGS}&quot;)

Modified: branches/avidemux_2.5_branch_mean_merged/avidemux/ADM_libraries/ADM_lavformat/ADM_lavformat.cpp
===================================================================
--- branches/avidemux_2.5_branch_mean_merged/avidemux/ADM_libraries/ADM_lavformat/ADM_lavformat.cpp	2008-03-12 18:55:18 UTC (rev 3876)
+++ branches/avidemux_2.5_branch_mean_merged/avidemux/ADM_libraries/ADM_lavformat/ADM_lavformat.cpp	2008-03-12 18:55:21 UTC (rev 3877)
@@ -1,4 +1,4 @@
-//
+
 // C++ Implementation: ADM_lavformat
 //
 // Description: 
@@ -52,7 +52,7 @@
 #define MODULE_NAME MODULE_LAVFORMAT
 #include &quot;ADM_osSupport/ADM_debug.h&quot;
 
-
+#include &quot;ADM_cpuCap.h&quot;
 static    AVOutputFormat *fmt;
 static    AVFormatContext *oc;
 static    AVStream *audio_st, *video_st;
@@ -802,7 +802,35 @@
     return 0;
   
 }
+#ifdef ADM_CPU_X86
+#include &quot;ADM_lavcodec.h&quot;
+#include &quot;ADM_libraries/ADM_lavcodec/dsputil_cpu.h&quot;
+#endif
+/**
+ * 		\fn lavcodec_mm_support
+ * 		\brief Give lavcodec CPU supported ( FF_MM_MMX)
+ */
+int ADM_lavcodec_mm_support(void)
+{
+int rval=0;
 
+#ifdef ADM_CPU_X86
+#undef MATCH
+#define MATCH(x,y) if(CpuCaps::myCpuCaps &amp;  CpuCaps::myCpuMask &amp; ADM_CPUCAP_##x) rval|=MM_##x;
+
+	MATCH(MMX,MMX);
+	MATCH(MMXEXT,MMXEXT);
+	MATCH(SSE,SSE);
+	MATCH(SSE2,SSE2);
+	MATCH(SSE3,SSE3);
+	MATCH(SSSE3,SSSE3);
+	MATCH(3DNOW,3DNOW);
+	MATCH(3DNOWEXT,3DNOWEXT);
+#endif
+
+	return rval;
+}
+// EOF
 //___________________________________________________________________________
 //EOF
 

Modified: branches/avidemux_2.5_branch_mean_merged/avidemux/ADM_libraries/ADM_libMpeg2Dec/CMakeLists.txt
===================================================================
--- branches/avidemux_2.5_branch_mean_merged/avidemux/ADM_libraries/ADM_libMpeg2Dec/CMakeLists.txt	2008-03-12 18:55:18 UTC (rev 3876)
+++ branches/avidemux_2.5_branch_mean_merged/avidemux/ADM_libraries/ADM_libMpeg2Dec/CMakeLists.txt	2008-03-12 18:55:21 UTC (rev 3877)
@@ -2,7 +2,8 @@
 
 SET(${ADM_LIB}_SRCS 
 	alloc.c      cpu_state.c  header.c      idct_altivec.c  idct_mlib.c  motion_comp_alpha.c    motion_comp.c       motion_comp_mmx.c
-	cpu_accel.c  decode.c     idct_alpha.c  idct.c          idct_mmx.c   motion_comp_altivec.c  motion_comp_mlib.c  slice.c)
+	cpu_accel.c  decode.c     idct_alpha.c  idct.c          idct_mmx.c   motion_comp_altivec.c  motion_comp_mlib.c  slice.c
+        ADM_mpeg2dec.cpp)
 
 ADD_ADM_LIB_ALL_TARGETS(${ADM_LIB} ${${ADM_LIB}_SRCS})
 ADD_CFLAGS_ALL_TARGETS(${ADM_LIB} &quot;-DACCEL_DETECT&quot;)
@@ -15,4 +16,4 @@
 	IF (NOT APPLE)
 		ADD_CFLAGS_ALL_TARGETS(${ADM_LIB} &quot;-DHAVE_ALTIVEC_H&quot;)
 	ENDIF (NOT APPLE)
-ENDIF (ADM_CPU_X86)
\ No newline at end of file
+ENDIF (ADM_CPU_X86)

Modified: branches/avidemux_2.5_branch_mean_merged/avidemux/ADM_libraries/ADM_libMpeg2Dec/cpu_accel.c
===================================================================
--- branches/avidemux_2.5_branch_mean_merged/avidemux/ADM_libraries/ADM_libMpeg2Dec/cpu_accel.c	2008-03-12 18:55:18 UTC (rev 3876)
+++ branches/avidemux_2.5_branch_mean_merged/avidemux/ADM_libraries/ADM_libMpeg2Dec/cpu_accel.c	2008-03-12 18:55:21 UTC (rev 3877)
@@ -30,10 +30,11 @@
 #include &quot;mpeg2_internal.h&quot;
 
 typedef void (*sighandler_t)(int); // MEANX RETSIGTYPE
- 
+extern int ADM_mpeg2dec_mm_support(void);
 
-extern int ADM_mpeg2dec_mm_support(void); // MEANX
+/************************************************************************/
 
+
 #ifdef ACCEL_DETECT
 #ifdef ARCH_X86
 static inline uint32_t arch_accel (void)

Modified: branches/avidemux_2.5_branch_mean_merged/avidemux/ADM_libraries/ADM_libmpeg2enc/ADM_mpe2enc.cpp
===================================================================
--- branches/avidemux_2.5_branch_mean_merged/avidemux/ADM_libraries/ADM_libmpeg2enc/ADM_mpe2enc.cpp	2008-03-12 18:55:18 UTC (rev 3876)
+++ branches/avidemux_2.5_branch_mean_merged/avidemux/ADM_libraries/ADM_libmpeg2enc/ADM_mpe2enc.cpp	2008-03-12 18:55:21 UTC (rev 3877)
@@ -260,4 +260,3 @@
 		return commonMpeg2Init(qz,maxbr,fps1000,interlaced,bff,wide,fast);
 }
 
-

Modified: branches/avidemux_2.5_branch_mean_merged/avidemux/CMakeLists.txt
===================================================================
--- branches/avidemux_2.5_branch_mean_merged/avidemux/CMakeLists.txt	2008-03-12 18:55:18 UTC (rev 3876)
+++ branches/avidemux_2.5_branch_mean_merged/avidemux/CMakeLists.txt	2008-03-12 18:55:21 UTC (rev 3877)
@@ -216,7 +216,6 @@
 # Tails
 #########################################
 SET(ADM_TAILS
-	ADM_core
 	ADM_osSupport
 	ADM_encoder
 	ADM_toolkit
@@ -307,7 +306,7 @@
 		ADM_commonUI_qt4)
 ENDIF (ADM_UI_QT4)
 
-ADD_ADMLIB_ALL_TARGETS(ADM_utilities ADM_core)
+ADD_ADMLIB_ALL_TARGETS(ADM_utilities)
 
 ###########################################
 # External libs
@@ -512,6 +511,8 @@
 	ADD_LIB_ALL_TARGETS(&quot;-Wl,-dylib_file,/System/Library/Frameworks/OpenGL.framework/Versions/A/Libraries/libGL.dylib:/System/Library/Frameworks/OpenGL.framework/Versions/A/Libraries/libGL.dylib&quot;)
 ENDIF (APPLE)
 
+ADD_LIB_ALL_TARGETS(-L${CMAKE_CURRENT_BINARY_DIR}/ADM_core/src -lADM_core)
+
 ###########################################
 # Install
 ###########################################
@@ -525,6 +526,6 @@
 	SET(ADM_EXES ${ADM_EXES} avidemux2_qt4)
 ENDIF (ADM_UI_QT4)
 
-INSTALL(TARGETS ${ADM_EXES} RUNTIME DESTINATION bin LIBRARY DESTINATION lib)
+INSTALL(TARGETS ${ADM_EXES} RUNTIME DESTINATION ${BIN_DIR} LIBRARY DESTINATION lib)
 
 # EOF

Modified: branches/avidemux_2.5_branch_mean_merged/avidemux/plugins/ADM_audiodecoder/ADM_ad_ac3/ADM_ad_a52.cpp
===================================================================
--- branches/avidemux_2.5_branch_mean_merged/avidemux/plugins/ADM_audiodecoder/ADM_ad_ac3/ADM_ad_a52.cpp	2008-03-12 18:55:18 UTC (rev 3876)
+++ branches/avidemux_2.5_branch_mean_merged/avidemux/plugins/ADM_audiodecoder/ADM_ad_ac3/ADM_ad_a52.cpp	2008-03-12 18:55:21 UTC (rev 3877)
@@ -17,7 +17,6 @@
 #include &quot;ADM_default.h&quot;
 #include &quot;ADM_ad_plugin.h&quot;
 
-#ifdef USE_AC3
 extern &quot;C&quot; {
 #include &quot;ADM_liba52/a52.h&quot;
 #include &quot;ADM_liba52/mm_accel.h&quot;
@@ -217,4 +216,3 @@
 
 }
 
-#endif

Modified: branches/avidemux_2.5_branch_mean_merged/avidemux/plugins/ADM_audiodecoder/ADM_ad_ac3/ADM_liba52/CMakeLists.txt
===================================================================
--- branches/avidemux_2.5_branch_mean_merged/avidemux/plugins/ADM_audiodecoder/ADM_ad_ac3/ADM_liba52/CMakeLists.txt	2008-03-12 18:55:18 UTC (rev 3876)
+++ branches/avidemux_2.5_branch_mean_merged/avidemux/plugins/ADM_audiodecoder/ADM_ad_ac3/ADM_liba52/CMakeLists.txt	2008-03-12 18:55:21 UTC (rev 3877)
@@ -4,6 +4,7 @@
 	bit_allocate.c  bitstream.c  downmix.c  imdct.c  parse.c)
 
 ADD_LIBRARY(${ADM_LIB} STATIC ${${ADM_LIB}_SRCS})
+TARGET_LINK_LIBRARIES(${ADM_LIB} ADM_core)
 
 IF (UNIX)
 	ADD_TARGET_CFLAGS(${ADM_LIB} -fPIC)

Modified: branches/avidemux_2.5_branch_mean_merged/avidemux/plugins/ADM_audiodecoder/ADM_ad_ac3/CMakeLists.txt
===================================================================
--- branches/avidemux_2.5_branch_mean_merged/avidemux/plugins/ADM_audiodecoder/ADM_ad_ac3/CMakeLists.txt	2008-03-12 18:55:18 UTC (rev 3876)
+++ branches/avidemux_2.5_branch_mean_merged/avidemux/plugins/ADM_audiodecoder/ADM_ad_ac3/CMakeLists.txt	2008-03-12 18:55:21 UTC (rev 3877)
@@ -3,7 +3,7 @@
 SET(ADM_ad_a52_SRCS ADM_ad_a52.cpp)
 
 ADD_LIBRARY(ADM_ad_a52 SHARED ${ADM_ad_a52_SRCS})
-TARGET_LINK_LIBRARIES(ADM_ad_a52 ADM_liba52)
+TARGET_LINK_LIBRARIES(ADM_ad_a52 ADM_core ADM_liba52)
 
 # FIXME
 INCLUDE(ad_plugin)

Modified: branches/avidemux_2.5_branch_mean_merged/cmake/Ts.cmake
===================================================================
--- branches/avidemux_2.5_branch_mean_merged/cmake/Ts.cmake	2008-03-12 18:55:18 UTC (rev 3876)
+++ branches/avidemux_2.5_branch_mean_merged/cmake/Ts.cmake	2008-03-12 18:55:21 UTC (rev 3877)
@@ -64,7 +64,7 @@
                 
             SET(qm_files ${qm_files} ${_outXml} ${_out})
 
-			INSTALL(FILES ${_out} DESTINATION &quot;${CMAKE_INSTALL_PREFIX}/bin/i18n&quot;)
+                        INSTALL(FILES ${_out} DESTINATION &quot;${CMAKE_INSTALL_PREFIX}/${BIN_DIR}/i18n&quot;)
         ENDFOREACH(ts_input ${ts_files})
 
         SET(${_sources} ${${_sources}} ${qm_files})
@@ -95,7 +95,7 @@
                 
             SET(qm_files ${qm_files} ${_out})
 
-			INSTALL(FILES ${_out} DESTINATION &quot;${CMAKE_INSTALL_PREFIX}/bin/i18n&quot;)
+                        INSTALL(FILES ${_out} DESTINATION &quot;${CMAKE_INSTALL_PREFIX}/${BIN_DIR}/i18n&quot;)
         ENDFOREACH(ts_input ${ts_files})
 
         SET(${_sources} ${${_sources}} ${qm_files})

Modified: branches/avidemux_2.5_branch_mean_merged/cmake/ad_plugin.cmake
===================================================================
--- branches/avidemux_2.5_branch_mean_merged/cmake/ad_plugin.cmake	2008-03-12 18:55:18 UTC (rev 3876)
+++ branches/avidemux_2.5_branch_mean_merged/cmake/ad_plugin.cmake	2008-03-12 18:55:21 UTC (rev 3877)
@@ -2,6 +2,6 @@
         INCLUDE_DIRECTORIES(&quot;${CMAKE_BINARY_DIR}/config&quot;)
 	INCLUDE_DIRECTORIES(&quot;${CMAKE_SOURCE_DIR}/avidemux/ADM_core/include&quot;)
         INCLUDE_DIRECTORIES(&quot;${CMAKE_SOURCE_DIR}/avidemux/ADM_audiocodec&quot;)
-        INSTALL(TARGETS ${_lib} LIBRARY DESTINATION &quot;${CMAKE_INSTALL_PREFIX}/lib/ADM_plugins/audioDecoder/&quot;)
+        INSTALL(TARGETS ${_lib} DESTINATION &quot;${CMAKE_INSTALL_PREFIX}/lib/ADM_plugins/audioDecoder/&quot;)
 ENDMACRO(ADM_audio_plugin)
 

Modified: branches/avidemux_2.5_branch_mean_merged/cmake/admCheckMiscLibs.cmake
===================================================================
--- branches/avidemux_2.5_branch_mean_merged/cmake/admCheckMiscLibs.cmake	2008-03-12 18:55:18 UTC (rev 3876)
+++ branches/avidemux_2.5_branch_mean_merged/cmake/admCheckMiscLibs.cmake	2008-03-12 18:55:21 UTC (rev 3877)
@@ -89,7 +89,6 @@
 ENDIF (GETTEXT)
 
 SET(ADM_LOCALE &quot;${CMAKE_INSTALL_PREFIX}/share/locale&quot;)
-SET(ADM_INSTALL_DIR &quot;${CMAKE_INSTALL_PREFIX}&quot;)
 
 MESSAGE(&quot;&quot;)
 


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="001139.html">[Avidemux-svn-commit] r3876 - in	branches/avidemux_2.5_branch_mean_merged: . avidemux	avidemux/ADM_audiocodec avidemux/ADM_core/src	avidemux/plugins/ADM_audiodecoder/ADM_ad_ac3	avidemux/plugins/ADM_audiodecoder/ADM_ad_ac3/ADM_liba52	avidemux/plugins/ADM_audiodecoder/ADM_ad_faad	avidemux/plugins/ADM_audiodecoder/ADM_ad_mad	avidemux/plugins/ADM_audiodecoder/ADM_ad_mad/ADM_libMad cmake
</A></li>
	<LI>Next message: <A HREF="001141.html">[Avidemux-svn-commit] r3878 - in	branches/avidemux_2.5_branch_mean_merged/avidemux/ADM_libraries:	ADM_lavcodec ADM_libMpeg2Dec
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1140">[ date ]</a>
              <a href="thread.html#1140">[ thread ]</a>
              <a href="subject.html#1140">[ subject ]</a>
              <a href="author.html#1140">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/avidemux-svn-commit">More information about the Avidemux-svn-commit
mailing list</a><br>
</body></html>
