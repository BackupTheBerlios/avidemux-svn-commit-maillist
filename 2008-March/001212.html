<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Avidemux-svn-commit] r3950 - in	branches/avidemux_2.5_branch_gruntster:	autononreg/dialogFactory avidemux/ADM_coreUI/include	avidemux/ADM_coreUI/src avidemux/ADM_script	avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialogFactory
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/avidemux-svn-commit/2008-March/index.html" >
   <LINK REL="made" HREF="mailto:avidemux-svn-commit%40lists.berlios.de?Subject=Re%3A%20%5BAvidemux-svn-commit%5D%20r3950%20-%20in%0A%09branches/avidemux_2.5_branch_gruntster%3A%0A%09autononreg/dialogFactory%20avidemux/ADM_coreUI/include%0A%09avidemux/ADM_coreUI/src%20avidemux/ADM_script%0A%09avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialogFactory&In-Reply-To=%3C200803300800.m2U80oR1023521%40sheep.berlios.de%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="001211.html">
   <LINK REL="Next"  HREF="001213.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Avidemux-svn-commit] r3950 - in	branches/avidemux_2.5_branch_gruntster:	autononreg/dialogFactory avidemux/ADM_coreUI/include	avidemux/ADM_coreUI/src avidemux/ADM_script	avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialogFactory</H1>
    <B>mean at BerliOS</B> 
    <A HREF="mailto:avidemux-svn-commit%40lists.berlios.de?Subject=Re%3A%20%5BAvidemux-svn-commit%5D%20r3950%20-%20in%0A%09branches/avidemux_2.5_branch_gruntster%3A%0A%09autononreg/dialogFactory%20avidemux/ADM_coreUI/include%0A%09avidemux/ADM_coreUI/src%20avidemux/ADM_script%0A%09avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialogFactory&In-Reply-To=%3C200803300800.m2U80oR1023521%40sheep.berlios.de%3E"
       TITLE="[Avidemux-svn-commit] r3950 - in	branches/avidemux_2.5_branch_gruntster:	autononreg/dialogFactory avidemux/ADM_coreUI/include	avidemux/ADM_coreUI/src avidemux/ADM_script	avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialogFactory">mean at mail.berlios.de
       </A><BR>
    <I>Sun Mar 30 10:00:50 CEST 2008</I>
    <P><UL>
        <LI>Previous message: <A HREF="001211.html">[Avidemux-svn-commit] r3949 - in	branches/avidemux_2.5_branch_gruntster/avidemux:	ADM_coreUI/include ADM_coreUI/src ADM_script	ADM_userInterfaces/ADM_GTK/ADM_dialogFactory	ADM_userInterfaces/ADM_NONE/ADM_dialogFactory	ADM_userInterfaces/ADM_QT4/ADM_dialogFactory
</A></li>
        <LI>Next message: <A HREF="001213.html">[Avidemux-svn-commit] r3951 - in	branches/avidemux_2.5_branch_gruntster/avidemux:	ADM_coreUI/include ADM_coreUI/src	ADM_userInterfaces/ADM_GTK/ADM_dialogFactory
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1212">[ date ]</a>
              <a href="thread.html#1212">[ thread ]</a>
              <a href="subject.html#1212">[ subject ]</a>
              <a href="author.html#1212">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Author: mean
Date: 2008-03-30 10:00:50 +0200 (Sun, 30 Mar 2008)
New Revision: 3950

Added:
   branches/avidemux_2.5_branch_gruntster/autononreg/dialogFactory/threadcount.js
Modified:
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_coreUI/include/DIA_coreUI_internal.h
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_coreUI/include/DIA_factory.h
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_coreUI/src/DIA_factory.cpp
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_script/ADM_JSFunctions.cpp
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialogFactory/DIA_dialogFactory.cpp
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialogFactory/FAC_threadCount.cpp
Log:
[Factory] Threadcount + testcase


Added: branches/avidemux_2.5_branch_gruntster/autononreg/dialogFactory/threadcount.js
===================================================================
--- branches/avidemux_2.5_branch_gruntster/autononreg/dialogFactory/threadcount.js	2008-03-30 08:00:38 UTC (rev 3949)
+++ branches/avidemux_2.5_branch_gruntster/autononreg/dialogFactory/threadcount.js	2008-03-30 08:00:50 UTC (rev 3950)
@@ -0,0 +1,10 @@
+//AD  &lt;- These first 4 characters need to be the first 4 characters to identify the ECMAScript file to Avidemux
+var app = new Avidemux();
+var file=&quot;/work/samples/2mn.avi&quot;;
+var goodfcc=&quot;DIV3&quot;;
+var fps;
+
+	dialogFactoryThreadCount();
+
+/* End of test
+*/

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_coreUI/include/DIA_coreUI_internal.h
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_coreUI/include/DIA_coreUI_internal.h	2008-03-30 08:00:38 UTC (rev 3949)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_coreUI/include/DIA_coreUI_internal.h	2008-03-30 08:00:50 UTC (rev 3950)
@@ -59,16 +59,16 @@
 	CREATE_UINTEGER_T    *CreateUInteger;
 	DELETE_DIA_ELEM_T    *DestroyUInteger;
 // Notch	
-	DIA_CREATE_NOTCH_T   *CreateNotch;
+	CREATE_NOTCH_T   *CreateNotch;
 	DELETE_DIA_ELEM_T    *DestroyNotch;
 // ReadonlyText
-	DIA_CREATE_READONLYTEXT_T *CreateReadonlyText;
+	CREATE_READONLYTEXT_T *CreateReadonlyText;
 	DELETE_DIA_ELEM_T    *DestroyReadonlyText;
 // Text
-	DIA_CREATE_TEXT_T    *CreateText;
+	CREATE_TEXT_T    *CreateText;
 	DELETE_DIA_ELEM_T    *DestroyText;
 // Hex
-	DIA_CREATE_HEX_T     *CreateHex;
+	CREATE_HEX_T     *CreateHex;
 	DELETE_DIA_ELEM_T    *DestroyHex;
 // Matrix
 	CREATE_MATRIX_T      *CreateMatrix;
@@ -79,7 +79,9 @@
 // MenuDynamic
 	CREATE_MENUDYNAMIC_T *CreateMenuDynamic;
 	DELETE_DIA_ELEM_T    *DestroyMenuDynamic;
-	
+// ThreadCount
+	CREATE_THREADCOUNT_T *CreateThreadCount;
+	DELETE_DIA_ELEM_T    *DestroyThreadCount;
 }FactoryDescriptor;
 //
 uint8_t DIA_factoryInit(FactoryDescriptor *d);

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_coreUI/include/DIA_factory.h
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_coreUI/include/DIA_factory.h	2008-03-30 08:00:38 UTC (rev 3949)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_coreUI/include/DIA_factory.h	2008-03-30 08:00:50 UTC (rev 3950)
@@ -376,7 +376,7 @@
 };
 /*************************************************/
 /* The text MUST be copied internally ! */
-typedef diaElem *(DIA_CREATE_READONLYTEXT_T )(const char *readOnly,const char *toggleTitle, const char *tip);
+typedef diaElem *(CREATE_READONLYTEXT_T )(const char *readOnly,const char *toggleTitle, const char *tip);
 class diaElemReadOnlyText : public diaElem
 {
 
@@ -389,7 +389,7 @@
   
 };
 /*************************************************/
-typedef diaElem *(DIA_CREATE_TEXT_T )(char **readOnly,const char *toggleTitle, const char *tip);
+typedef diaElem *(CREATE_TEXT_T )(char **readOnly,const char *toggleTitle, const char *tip);
 /* The text MUST be copied internally ! */
 class diaElemText : public diaElem
 {
@@ -404,7 +404,7 @@
 };
 
 /*********************************************/
-typedef diaElem *(DIA_CREATE_NOTCH_T )(uint32_t yes,const char *toggleTitle, const char *tip);
+typedef diaElem *(CREATE_NOTCH_T )(uint32_t yes,const char *toggleTitle, const char *tip);
 class diaElemNotch : public diaElem
 {
   uint32_t yesno;
@@ -452,7 +452,7 @@
   void finalize(void);
 };
 /**********************************************/
-typedef diaElem *(DIA_CREATE_HEX_T )(const char *toggleTitle, uint32_t dataSize,uint8_t *data);
+typedef diaElem *(CREATE_HEX_T )(const char *toggleTitle, uint32_t dataSize,uint8_t *data);
 class diaElemHex : public diaElem
 {
   uint32_t dataSize;
@@ -467,6 +467,7 @@
   void finalize(void);
 };
 /**********************************************/
+typedef diaElem *(CREATE_THREADCOUNT_T)(uint32_t *value, const char *title, const char *tip = NULL);
 class diaElemThreadCount : public diaElem
 {
 

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_coreUI/src/DIA_factory.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_coreUI/src/DIA_factory.cpp	2008-03-30 08:00:38 UTC (rev 3949)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_coreUI/src/DIA_factory.cpp	2008-03-30 08:00:50 UTC (rev 3950)
@@ -286,4 +286,20 @@
 }
 
 DIA_MKSTUBS(diaElemMenuDynamic)
+// ****************** diaElemMatrix ********************
+diaElemThreadCount ::diaElemThreadCount(uint32_t *value, const char *title, const char *tip):
+	diaElem(ELEM_THREAD_COUNT)
+{
+	ADM_assert(Factory); 
+	internalPointer=Factory-&gt;CreateThreadCount(value,title,tip);
+}
+diaElemThreadCount ::~diaElemThreadCount()
+{
+	ADM_assert(Factory); 
+	Factory-&gt;DestroyThreadCount(internalPointer);
+	internalPointer=NULL;
+}
+DIA_MKSTUBS(diaElemThreadCount)
+
+
 // EOF

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_script/ADM_JSFunctions.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_script/ADM_JSFunctions.cpp	2008-03-30 08:00:38 UTC (rev 3949)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_script/ADM_JSFunctions.cpp	2008-03-30 08:00:50 UTC (rev 3950)
@@ -83,6 +83,7 @@
 JSBool facButton(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval);
 JSBool facMatrix(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval);
 JSBool facNotch(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval);
+JSBool facThreadCount(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval);
 JSBool facSlider(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval);
 JSBool crashTest(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval);
 JSBool assertTest(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval);
@@ -120,6 +121,7 @@
   {&quot;dialogFactorySlider&quot;,       facSlider,        0},
   {&quot;dialogFactoryMatrix&quot;,       facMatrix,        0},
   {&quot;dialogFactoryNotch&quot;,       facNotch,		  0},
+  {&quot;dialogFactoryThreadCount&quot;, facThreadCount,		  0},
   {&quot;crashTest&quot;,               crashTest,          0},
   {&quot;assertTest&quot;,               assertTest,        0},
   {0}
@@ -827,6 +829,22 @@
       
       
 }
+JSBool facThreadCount(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval)
+{
+	uint32_t val=1;
+	diaElemThreadCount threadcount(&amp;val,&quot;ThreadCount&quot;);
+      
+    diaElem *elems[]={&amp;threadcount   };
+    
+  if(diaFactoryRun(&quot;Test ThreadCount&quot;,1,elems))
+  {
+    *rval = BOOLEAN_TO_JSVAL(1);
+    
+  }else
+    *rval = BOOLEAN_TO_JSVAL(0);
+  return JS_TRUE;
+      
+}
 JSBool facNotch(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval)
 {
     

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialogFactory/DIA_dialogFactory.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialogFactory/DIA_dialogFactory.cpp	2008-03-30 08:00:38 UTC (rev 3949)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialogFactory/DIA_dialogFactory.cpp	2008-03-30 08:00:50 UTC (rev 3950)
@@ -299,24 +299,26 @@
 extern void     gtkDeleteBar(diaElem *e);
 extern diaElem  *gtkCreateFloat(ELEM_TYPE_FLOAT *intValue,const char *toggleTitle, ELEM_TYPE_FLOAT min, ELEM_TYPE_FLOAT max,const char *tip);
 extern void     gtkDeleteFloat(diaElem *e);
-extern CREATE_INTEGER_T gtkCreateInteger;
+extern CREATE_INTEGER_T  gtkCreateInteger;
 extern CREATE_UINTEGER_T gtkCreateUInteger;
 extern DELETE_DIA_ELEM_T gtkDestroyInteger;
 extern DELETE_DIA_ELEM_T gtkDestroyUInteger;
-extern DIA_CREATE_NOTCH_T  gtkCreateNotch;
+extern CREATE_NOTCH_T    gtkCreateNotch;
 extern DELETE_DIA_ELEM_T   gtkDestroyNotch;
-extern DIA_CREATE_READONLYTEXT_T gtkCreateRoText;
-extern DIA_CREATE_TEXT_T gtkCreateText;
+extern CREATE_READONLYTEXT_T gtkCreateRoText;
+extern CREATE_TEXT_T gtkCreateText;
 extern DELETE_DIA_ELEM_T   gtkDestroyRoText;
 extern DELETE_DIA_ELEM_T   gtkDestroyText;
-extern DIA_CREATE_HEX_T    gtkCreateHex;
+extern CREATE_HEX_T        gtkCreateHex;
 extern DELETE_DIA_ELEM_T   gtkDestroyHex;
 extern CREATE_MATRIX_T     gtkCreateMatrix;
 extern DELETE_DIA_ELEM_T   gtkDestroyMatrix;
 extern CREATE_MENUDYNAMIC_T     gtkCreateMenuDynamic;
-extern CREATE_MENU_T     gtkCreateMenu;
+extern CREATE_MENU_T       gtkCreateMenu;
 extern DELETE_DIA_ELEM_T   gtkDestroyMenu;
 extern DELETE_DIA_ELEM_T   gtkDestroyMenuDynamic;
+extern CREATE_THREADCOUNT_T gtkCreateThreadCount;
+extern DELETE_DIA_ELEM_T    gtkDestroyThreadCount;
 //************
 static FactoryDescriptor GtkFactoryDescriptor=
 {
@@ -357,6 +359,9 @@
 	&amp;gtkDestroyMenu,
 	&amp;gtkCreateMenuDynamic,
 	&amp;gtkDestroyMenuDynamic,
+	// ThreadCount
+	&amp;gtkCreateThreadCount,
+	&amp;gtkDestroyThreadCount
 		
 };
 

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialogFactory/FAC_threadCount.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialogFactory/FAC_threadCount.cpp	2008-03-30 08:00:38 UTC (rev 3949)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialogFactory/FAC_threadCount.cpp	2008-03-30 08:00:50 UTC (rev 3950)
@@ -16,6 +16,21 @@
 #include &quot;../ADM_toolkit_gtk/toolkit_gtk.h&quot;
 #include &quot;DIA_factory.h&quot;
 
+
+namespace ADM_GtkFactory
+{
+
+class diaElemThreadCount : public diaElem
+{
+
+public:
+  
+  diaElemThreadCount(uint32_t *value, const char *title, const char *tip = NULL);
+  virtual ~diaElemThreadCount() ;
+  void setMe(void *dialog, void *opaque, uint32_t line);
+  void getMe(void);
+};
+
 static void customToggled(void *widget, void *userData);
 
 diaElemThreadCount::diaElemThreadCount(uint32_t *value, const char *title, const char *tip) : diaElem(ELEM_THREAD_COUNT)
@@ -129,5 +144,14 @@
 
 	gtk_widget_set_sensitive(GTK_WIDGET(widgets[3]), gtk_toggle_button_get_active(GTK_TOGGLE_BUTTON(widgets[2])));
 }
-
+} // End of namesapce
+diaElem  *gtkCreateThreadCount(uint32_t *value, const char *title, const char *tip)
+{
+	return new  ADM_GtkFactory::diaElemThreadCount(value,title,tip);
+}
+void gtkDestroyThreadCount(diaElem *e)
+{
+	ADM_GtkFactory::diaElemThreadCount *a=(ADM_GtkFactory::diaElemThreadCount *)e;
+	delete a;
+}
 //EOF


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="001211.html">[Avidemux-svn-commit] r3949 - in	branches/avidemux_2.5_branch_gruntster/avidemux:	ADM_coreUI/include ADM_coreUI/src ADM_script	ADM_userInterfaces/ADM_GTK/ADM_dialogFactory	ADM_userInterfaces/ADM_NONE/ADM_dialogFactory	ADM_userInterfaces/ADM_QT4/ADM_dialogFactory
</A></li>
	<LI>Next message: <A HREF="001213.html">[Avidemux-svn-commit] r3951 - in	branches/avidemux_2.5_branch_gruntster/avidemux:	ADM_coreUI/include ADM_coreUI/src	ADM_userInterfaces/ADM_GTK/ADM_dialogFactory
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1212">[ date ]</a>
              <a href="thread.html#1212">[ thread ]</a>
              <a href="subject.html#1212">[ subject ]</a>
              <a href="author.html#1212">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/avidemux-svn-commit">More information about the Avidemux-svn-commit
mailing list</a><br>
</body></html>
