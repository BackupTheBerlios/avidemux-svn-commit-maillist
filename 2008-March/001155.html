<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Avidemux-svn-commit] r3892 - in	branches/avidemux_2.5_branch_gruntster: avidemux	avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2	avidemux/ADM_userInterfaces/ADM_GTK/ADM_toolkit_gtk cmake
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/avidemux-svn-commit/2008-March/index.html" >
   <LINK REL="made" HREF="mailto:avidemux-svn-commit%40lists.berlios.de?Subject=Re%3A%20%5BAvidemux-svn-commit%5D%20r3892%20-%20in%0A%09branches/avidemux_2.5_branch_gruntster%3A%20avidemux%0A%09avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2%0A%09avidemux/ADM_userInterfaces/ADM_GTK/ADM_toolkit_gtk%20cmake&In-Reply-To=%3C200803141320.m2EDKX4B005122%40sheep.berlios.de%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="001154.html">
   <LINK REL="Next"  HREF="001156.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Avidemux-svn-commit] r3892 - in	branches/avidemux_2.5_branch_gruntster: avidemux	avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2	avidemux/ADM_userInterfaces/ADM_GTK/ADM_toolkit_gtk cmake</H1>
    <B>gruntster at mail.berlios.de</B> 
    <A HREF="mailto:avidemux-svn-commit%40lists.berlios.de?Subject=Re%3A%20%5BAvidemux-svn-commit%5D%20r3892%20-%20in%0A%09branches/avidemux_2.5_branch_gruntster%3A%20avidemux%0A%09avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2%0A%09avidemux/ADM_userInterfaces/ADM_GTK/ADM_toolkit_gtk%20cmake&In-Reply-To=%3C200803141320.m2EDKX4B005122%40sheep.berlios.de%3E"
       TITLE="[Avidemux-svn-commit] r3892 - in	branches/avidemux_2.5_branch_gruntster: avidemux	avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2	avidemux/ADM_userInterfaces/ADM_GTK/ADM_toolkit_gtk cmake">gruntster at mail.berlios.de
       </A><BR>
    <I>Fri Mar 14 14:20:33 CET 2008</I>
    <P><UL>
        <LI>Previous message: <A HREF="001154.html">[Avidemux-svn-commit] r3891 - in	branches/avidemux_2.5_branch_gruntster/avidemux:	ADM_core/include ADM_core/src	ADM_userInterfaces/ADM_GTK/ADM_toolkit_gtk
</A></li>
        <LI>Next message: <A HREF="001156.html">[Avidemux-svn-commit] r3893 - in	branches/avidemux_2.5_branch_gruntster/avidemux/plugins/ADM_audiodecoder:	ADM_ad_ac3 ADM_ad_ac3/ADM_liba52 ADM_ad_faad ADM_ad_mad
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1155">[ date ]</a>
              <a href="thread.html#1155">[ thread ]</a>
              <a href="subject.html#1155">[ subject ]</a>
              <a href="author.html#1155">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Author: gruntster
Date: 2008-03-14 14:20:26 +0100 (Fri, 14 Mar 2008)
New Revision: 3892

Modified:
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_bindings.cpp
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_GTK/ADM_toolkit_gtk/toolkit_gtk.h
   branches/avidemux_2.5_branch_gruntster/avidemux/CMakeLists.txt
   branches/avidemux_2.5_branch_gruntster/avidemux/gtk_gui.cpp
   branches/avidemux_2.5_branch_gruntster/avidemux/main.cpp
   branches/avidemux_2.5_branch_gruntster/cmake/admCheckUserInterfaceLibs.cmake
Log:
[GLib] remove GLib dependency

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_bindings.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_bindings.cpp	2008-03-14 02:05:29 UTC (rev 3891)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_bindings.cpp	2008-03-14 13:20:26 UTC (rev 3892)
@@ -140,7 +140,7 @@
  void UI_BusyCursor( void );
  void UI_NormalCursor( void );
 // For checking if Slider shift key is pressed
-gboolean SliderIsShifted = FALSE;
+bool SliderIsShifted = FALSE;
 gboolean UI_SliderPressed(GtkWidget *widget, GdkEventButton *event, gpointer user_data);
 gboolean UI_SliderReleased(GtkWidget *widget, GdkEventButton *event, gpointer user_data);
 gboolean UI_returnFocus(GtkWidget *widget, GdkEventButton *event, gpointer user_data);

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_GTK/ADM_toolkit_gtk/toolkit_gtk.h
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_GTK/ADM_toolkit_gtk/toolkit_gtk.h	2008-03-14 02:05:29 UTC (rev 3891)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_GTK/ADM_toolkit_gtk/toolkit_gtk.h	2008-03-14 13:20:26 UTC (rev 3892)
@@ -1,22 +1,20 @@
 
 /***************************************************************************
-    copyright            : (C) 2001/2006 by mean
-    email                : <A HREF="https://lists.berlios.de/mailman/listinfo/avidemux-svn-commit">fixounet at free.fr</A>
- ***************************************************************************/
+copyright            : (C) 2001/2006 by mean
+email                : <A HREF="https://lists.berlios.de/mailman/listinfo/avidemux-svn-commit">fixounet at free.fr</A>
+***************************************************************************/
 
 /***************************************************************************
- *                                                                         *
- *   This program is free software; you can redistribute it and/or modify  *
- *   it under the terms of the GNU General Public License as published by  *
- *   the Free Software Foundation; either version 2 of the License, or     *
- *   (at your option) any later version.                                   *
- *                                                                         *
- ***************************************************************************/
+*                                                                         *
+*   This program is free software; you can redistribute it and/or modify  *
+*   it under the terms of the GNU General Public License as published by  *
+*   the Free Software Foundation; either version 2 of the License, or     *
+*   (at your option) any later version.                                   *
+*                                                                         *
+***************************************************************************/
 #ifndef ADM_TLK_GTK
 #define ADM_TLK_GTK
-#include &lt;stdlib.h&gt;
 
-#include &lt;glib.h&gt;
 #include &lt;gdk/gdkkeysyms.h&gt;
 #include &lt;gtk/gtk.h&gt;
 
@@ -24,31 +22,26 @@
 #include &quot;ADM_gladeSupport.h&quot;
 #include &quot;toolkit_gtk_include.h&quot;
 
+uint8_t getRangeInMenu(GtkWidget *Menu);
+void changeTextInMenu(GtkWidget *menu, int range, const char *text);
+void UI_purge(void);
+uint8_t getSelectionNumber(uint32_t nb, GtkWidget *tree, GtkListStore *store, uint32_t *number);
+uint8_t setSelectionNumber(uint32_t nb, GtkWidget *tree, GtkListStore *store, uint32_t number);
+int gtk_read_entry(GtkWidget *entry);
+void gtk_write_entry(GtkWidget *entry, int value);
+void gtk_write_entry_string(GtkWidget *entry, char *value);
+float gtk_read_entry_float(GtkWidget *entry);
+void gtk_write_entry_float(GtkWidget *entry, float value);
 
+/* Window handling: transient modal etc..*/
+void gtk_register_dialog(GtkWidget *newdialog);
+void gtk_unregister_dialog(GtkWidget *newdialog);
+void gtk_transient(GtkWidget *widget);
 
-uint8_t getRangeInMenu(GtkWidget * Menu);
-void    changeTextInMenu(GtkWidget *menu,int range,const char *text);
-void    UI_purge(void );
-uint8_t getSelectionNumber(uint32_t nb,GtkWidget *tree  , GtkListStore 	*store,uint32_t *number);
-uint8_t setSelectionNumber(uint32_t nb,GtkWidget *tree  , GtkListStore 	*store,uint32_t number);
-int     gtk_read_entry(GtkWidget *entry);
-void    gtk_write_entry(GtkWidget *entry, int value);
-void    gtk_write_entry_string(GtkWidget *entry, char *value);
-float   gtk_read_entry_float(GtkWidget *entry);
-
-void    gtk_write_entry_float(GtkWidget *entry, float value);
-
-/* Window handling : transient modal etc..*/
-
-void    gtk_register_dialog(GtkWidget *newdialog);
-void    gtk_unregister_dialog(GtkWidget *newdialog);
-void    gtk_transient(GtkWidget *widget);
-/*****/
 #define WID(x) lookup_widget(dialog,#x)
 #define RADIO_SET(widget_name,value) gtk_toggle_button_set_active \
-                                ( GTK_TOGGLE_BUTTON (WID(widget_name)), value)
-                                
-#define RADIO_GET(widget_name) gtk_toggle_button_get_active \
-                                ( GTK_TOGGLE_BUTTON (WID(widget_name)))
+	(GTK_TOGGLE_BUTTON (WID(widget_name)), value)
 
+#define RADIO_GET(widget_name) gtk_toggle_button_get_active \
+	(GTK_TOGGLE_BUTTON (WID(widget_name)))
 #endif

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/CMakeLists.txt
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/CMakeLists.txt	2008-03-14 02:05:29 UTC (rev 3891)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/CMakeLists.txt	2008-03-14 13:20:26 UTC (rev 3892)
@@ -143,7 +143,6 @@
 
 SDLify(main.cpp)
 ADD_SOURCE_CFLAGS(main.cpp &quot;-DADM_SUBVERSION=${ADM_SUBVERSION}&quot;)
-ADD_SOURCE_CFLAGS(gtk_gui.cpp ${GLIB_CFLAGS})
 
 IF (USE_AMR_NB)
 	ADD_SOURCE_CFLAGS(main.cpp -I${AMRNB_INCLUDE_DIR})
@@ -468,14 +467,11 @@
 ###########################################
 # UI Specific
 ###########################################
-ADD_TARGET_LDFLAGS(avidemux2_cli ${GLIB_LDFLAGS})
-
 IF (ADM_UI_GTK)
 	ADD_TARGET_LDFLAGS(avidemux2_gtk ${GTK_LDFLAGS} ${GTHREAD_LDFLAGS})
 ENDIF (ADM_UI_GTK)
 
 IF (ADM_UI_QT4)
-	ADD_TARGET_LDFLAGS(avidemux2_qt4 ${GLIB_LDFLAGS})
 	TARGET_LINK_LIBRARIES(avidemux2_qt4 ${QT_QTGUI_LIBRARY} ${QT_QTCORE_LIBRARY})
 ENDIF (ADM_UI_QT4)
 

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/gtk_gui.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/gtk_gui.cpp	2008-03-14 02:05:29 UTC (rev 3891)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/gtk_gui.cpp	2008-03-14 13:20:26 UTC (rev 3892)
@@ -24,7 +24,6 @@
 #include &lt;sys/time.h&gt;
 #include &lt;fcntl.h&gt;	/* O_RDONLY */
 #include &lt;errno.h&gt;
-#include &lt;glib.h&gt;
     
 #include &quot;ADM_lavcodec.h&quot;
 #include &quot;fourcc.h&quot;
@@ -40,7 +39,7 @@
 #include &quot;ADM_audiofilter/audioprocess.hxx&quot;
 #include &quot;gui_action.hxx&quot;
 #include &quot;gtkgui.h&quot;
-//#include &quot;ADM_gui/GUI_vars.h&quot;
+
 #include &quot;ADM_outputs/oplug_avi/GUI_mux.h&quot;
 #include &quot;ADM_outputs/oplug_mpegFF/oplug_vcdff.h&quot;
 #include &quot;ADM_audiofilter/audioeng_buildfilters.h&quot;
@@ -60,11 +59,9 @@
 #include &quot;ADM_filter/video_filters.h&quot;
 #include &quot;ADM_encoder/ADM_vidEncode.hxx&quot;
 #include &quot;ADM_codecs/ADM_ffmpeg.h&quot;
-
 #include &quot;ADM_libraries/ADM_libmpeg2enc/ADM_mpeg2enc.h&quot;
-
-#include &quot;ADM_userInterfaces/ADM_commonUI/DIA_factory.h&quot;
 #include &quot;ADM_video/ADM_vidMisc.h&quot;
+
 void A_handleSecondTrack (int tracktype);
 int A_delete(uint32_t start, uint32_t end);
 void A_saveImg (char *name);
@@ -155,7 +152,7 @@
 renderZoom currentZoom=ZOOM_1_1;
 uint8_t A_setSecondAudioTrack(const AudioSource nw,char *name);
 extern const char * GUI_getCustomScript(uint32_t nb);
-extern gboolean SliderIsShifted;
+extern bool SliderIsShifted;
 
 void GUI_showCurrentFrameHex(void);
 void GUI_avsProxy(void);
@@ -172,7 +169,6 @@
 
 void HandleAction (Action action)
 {
-  gchar *name_utf8;
   static int recursive = 0;
 
   uint32_t nf = 0;
@@ -210,13 +206,16 @@
         case ACT_RECENT2:
         case ACT_RECENT3:
                         const char **name;
+						char* fileName;
                         int rank;
                                 name=prefs-&gt;get_lastfiles();
                                 rank=(int)action-ACT_RECENT0;
                                 ADM_assert(name[rank]);
-				name_utf8 = g_filename_from_utf8(name[rank], -1, NULL, NULL, NULL);
-                                A_openAvi2 (name_utf8, 0);
-				g_free(name_utf8);
+
+								fileName = ADM_strdup(name[rank]);
+                                A_openAvi2(fileName, 0);
+								ADM_dealloc(fileName);
+
                 return;
         case ACT_ViewMain: UI_toogleMain();return;
         case ACT_ViewSide: UI_toogleSide();return;
@@ -882,7 +881,6 @@
 int A_openAvi2 (char *name, uint8_t mode)
 {
   uint8_t res;
-  gchar *name_utf8;
   char *longname;
   uint32_t magic[4];
   uint32_t id = 0;
@@ -965,8 +963,7 @@
 	}
 
 	/* remember any video or workbench file to &quot;recent&quot; */
-	name_utf8 = g_filename_to_utf8(longname, -1, NULL, NULL, NULL);
-	prefs-&gt;set_lastfile(name_utf8);
+	prefs-&gt;set_lastfile(longname);
         UI_updateRecentMenu();
 	updateLoaded ();
         if(currentaudiostream)
@@ -996,7 +993,7 @@
 		}
 	UI_setTitle(longname+i);
     }
-	g_free(name_utf8);
+
 	delete[] longname;
 	return 1;
 }

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/main.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/main.cpp	2008-03-14 02:05:29 UTC (rev 3891)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/main.cpp	2008-03-14 13:20:26 UTC (rev 3892)
@@ -239,9 +239,9 @@
 	//***************Plugins *********************
 	// Load system wide audio decoder plugin
 #ifdef __APPLE__
+	char *adPlugins = ADM_getInstallRelativePath(&quot;../Resources/lib&quot;,&quot;ADM_plugins&quot;,&quot;audioDecoder&quot;);
+#else
 	char *adPlugins = ADM_getInstallRelativePath(&quot;lib&quot;,&quot;ADM_plugins&quot;,&quot;audioDecoder&quot;);
-#else
-	char *adPlugins = ADM_getInstallRelativePath(&quot;../Resources/lib&quot;,&quot;ADM_plugins&quot;,&quot;audioDecoder&quot;);
 #endif
 
 	ADM_ad_loadPlugins(adPlugins);

Modified: branches/avidemux_2.5_branch_gruntster/cmake/admCheckUserInterfaceLibs.cmake
===================================================================
--- branches/avidemux_2.5_branch_gruntster/cmake/admCheckUserInterfaceLibs.cmake	2008-03-14 02:05:29 UTC (rev 3891)
+++ branches/avidemux_2.5_branch_gruntster/cmake/admCheckUserInterfaceLibs.cmake	2008-03-14 13:20:26 UTC (rev 3892)
@@ -1,15 +1,4 @@
 ########################################
-# GLib
-########################################
-MESSAGE(STATUS &quot;Checking for GLib&quot;)
-MESSAGE(STATUS &quot;*****************&quot;)
-
-PKG_CHECK_MODULES(GLIB glib-2.0)
-PRINT_LIBRARY_INFO(&quot;GLib&quot; GLIB_FOUND &quot;${GLIB_CFLAGS}&quot; &quot;${GLIB_LDFLAGS}&quot; FATAL_ERROR)
-
-MESSAGE(&quot;&quot;)
-
-########################################
 # GTK+
 ########################################
 OPTION(GTK &quot;&quot; ON)


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="001154.html">[Avidemux-svn-commit] r3891 - in	branches/avidemux_2.5_branch_gruntster/avidemux:	ADM_core/include ADM_core/src	ADM_userInterfaces/ADM_GTK/ADM_toolkit_gtk
</A></li>
	<LI>Next message: <A HREF="001156.html">[Avidemux-svn-commit] r3893 - in	branches/avidemux_2.5_branch_gruntster/avidemux/plugins/ADM_audiodecoder:	ADM_ad_ac3 ADM_ad_ac3/ADM_liba52 ADM_ad_faad ADM_ad_mad
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1155">[ date ]</a>
              <a href="thread.html#1155">[ thread ]</a>
              <a href="subject.html#1155">[ subject ]</a>
              <a href="author.html#1155">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/avidemux-svn-commit">More information about the Avidemux-svn-commit
mailing list</a><br>
</body></html>
