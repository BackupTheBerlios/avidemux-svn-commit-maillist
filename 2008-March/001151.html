<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Avidemux-svn-commit] r3888 - in	branches/avidemux_2.5_branch_gruntster: . avidemux	avidemux/ADM_audio avidemux/ADM_audiocodec	avidemux/plugins/ADM_audiodecoder/ADM_ad_ac3	avidemux/plugins/ADM_audiodecoder/ADM_ad_faad	avidemux/plugins/ADM_audiodecoder/ADM_ad_mad	avidemux/plugins/ADM_audiodecoder/ADM_ad_vorbis cmake
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/avidemux-svn-commit/2008-March/index.html" >
   <LINK REL="made" HREF="mailto:avidemux-svn-commit%40lists.berlios.de?Subject=Re%3A%20%5BAvidemux-svn-commit%5D%20r3888%20-%20in%0A%09branches/avidemux_2.5_branch_gruntster%3A%20.%20avidemux%0A%09avidemux/ADM_audio%20avidemux/ADM_audiocodec%0A%09avidemux/plugins/ADM_audiodecoder/ADM_ad_ac3%0A%09avidemux/plugins/ADM_audiodecoder/ADM_ad_faad%0A%09avidemux/plugins/ADM_audiodecoder/ADM_ad_mad%0A%09avidemux/plugins/ADM_audiodecoder/ADM_ad_vorbis%20cmake&In-Reply-To=%3C200803131402.m2DE2scQ029962%40sheep.berlios.de%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="001150.html">
   <LINK REL="Next"  HREF="001152.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Avidemux-svn-commit] r3888 - in	branches/avidemux_2.5_branch_gruntster: . avidemux	avidemux/ADM_audio avidemux/ADM_audiocodec	avidemux/plugins/ADM_audiodecoder/ADM_ad_ac3	avidemux/plugins/ADM_audiodecoder/ADM_ad_faad	avidemux/plugins/ADM_audiodecoder/ADM_ad_mad	avidemux/plugins/ADM_audiodecoder/ADM_ad_vorbis cmake</H1>
    <B>gruntster at mail.berlios.de</B> 
    <A HREF="mailto:avidemux-svn-commit%40lists.berlios.de?Subject=Re%3A%20%5BAvidemux-svn-commit%5D%20r3888%20-%20in%0A%09branches/avidemux_2.5_branch_gruntster%3A%20.%20avidemux%0A%09avidemux/ADM_audio%20avidemux/ADM_audiocodec%0A%09avidemux/plugins/ADM_audiodecoder/ADM_ad_ac3%0A%09avidemux/plugins/ADM_audiodecoder/ADM_ad_faad%0A%09avidemux/plugins/ADM_audiodecoder/ADM_ad_mad%0A%09avidemux/plugins/ADM_audiodecoder/ADM_ad_vorbis%20cmake&In-Reply-To=%3C200803131402.m2DE2scQ029962%40sheep.berlios.de%3E"
       TITLE="[Avidemux-svn-commit] r3888 - in	branches/avidemux_2.5_branch_gruntster: . avidemux	avidemux/ADM_audio avidemux/ADM_audiocodec	avidemux/plugins/ADM_audiodecoder/ADM_ad_ac3	avidemux/plugins/ADM_audiodecoder/ADM_ad_faad	avidemux/plugins/ADM_audiodecoder/ADM_ad_mad	avidemux/plugins/ADM_audiodecoder/ADM_ad_vorbis cmake">gruntster at mail.berlios.de
       </A><BR>
    <I>Thu Mar 13 15:02:54 CET 2008</I>
    <P><UL>
        <LI>Previous message: <A HREF="001150.html">[Avidemux-svn-commit] r3887 - in	branches/avidemux_2.5_branch_gruntster: .	avidemux/ADM_core/src avidemux/ADM_libraries/ADM_lavcodec	avidemux/ADM_libraries/ADM_lavformat	avidemux/ADM_libraries/ADM_libMpeg2Dec	avidemux/plugins/ADM_audiodecoder/ADM_ad_ac3	avidemux/plugins/ADM_audiodecoder/ADM_ad_ac3/ADM_liba52	avidemux/plugins/ADM_audiodecoder/ADM_ad_faad	avidemux/plugins/ADM_audiodecoder/ADM_ad_mad	avidemux/plugins/ADM_audiodecoder/ADM_ad_mad/ADM_libMad cmake
</A></li>
        <LI>Next message: <A HREF="001152.html">[Avidemux-svn-commit] r3889 - in	branches/avidemux_2.5_branch_gruntster: avidemux	avidemux/ADM_libraries/ADM_libass avidemux/ADM_toolkit	avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog	avidemux/ADM_userInterfaces/ADM_commonUI avidemux/ADM_video	avidemux/ADM_videoFilter cmake
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1151">[ date ]</a>
              <a href="thread.html#1151">[ thread ]</a>
              <a href="subject.html#1151">[ subject ]</a>
              <a href="author.html#1151">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Author: gruntster
Date: 2008-03-13 15:02:47 +0100 (Thu, 13 Mar 2008)
New Revision: 3888

Modified:
   branches/avidemux_2.5_branch_gruntster/CMakeLists.txt
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_audio/aviaudio.hxx
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_audiocodec/ADM_ad_plugin.h
   branches/avidemux_2.5_branch_gruntster/avidemux/CMakeLists.txt
   branches/avidemux_2.5_branch_gruntster/avidemux/plugins/ADM_audiodecoder/ADM_ad_ac3/CMakeLists.txt
   branches/avidemux_2.5_branch_gruntster/avidemux/plugins/ADM_audiodecoder/ADM_ad_faad/CMakeLists.txt
   branches/avidemux_2.5_branch_gruntster/avidemux/plugins/ADM_audiodecoder/ADM_ad_mad/CMakeLists.txt
   branches/avidemux_2.5_branch_gruntster/avidemux/plugins/ADM_audiodecoder/ADM_ad_vorbis/ADM_ad_vorbis.cpp
   branches/avidemux_2.5_branch_gruntster/avidemux/plugins/ADM_audiodecoder/ADM_ad_vorbis/CMakeLists.txt
   branches/avidemux_2.5_branch_gruntster/cmake/ad_plugin.cmake
Log:
[CMake] don't use the UI's include dirs and definitions for plugins

Modified: branches/avidemux_2.5_branch_gruntster/CMakeLists.txt
===================================================================
--- branches/avidemux_2.5_branch_gruntster/CMakeLists.txt	2008-03-13 12:21:32 UTC (rev 3887)
+++ branches/avidemux_2.5_branch_gruntster/CMakeLists.txt	2008-03-13 14:02:47 UTC (rev 3888)
@@ -173,6 +173,7 @@
 # Directories to build
 ########################################
 ADD_SUBDIRECTORY(avidemux)
+ADD_SUBDIRECTORY(avidemux/plugins)
 ADD_SUBDIRECTORY(po)
 
 ########################################

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_audio/aviaudio.hxx
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_audio/aviaudio.hxx	2008-03-13 12:21:32 UTC (rev 3887)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_audio/aviaudio.hxx	2008-03-13 14:02:47 UTC (rev 3888)
@@ -70,7 +70,7 @@
 #define WAV_NELLYMOSER   9901
 #define WAV_UNKNOWN     9999
 #include &quot;../ADM_audiocodec/ADM_audiocodec.h&quot;
-#include &quot;ADM_osSupport/ADM_fileio.h&quot;
+#include &quot;../ADM_osSupport/ADM_fileio.h&quot;
 
 
 

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_audiocodec/ADM_ad_plugin.h
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_audiocodec/ADM_ad_plugin.h	2008-03-13 12:21:32 UTC (rev 3887)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_audiocodec/ADM_ad_plugin.h	2008-03-13 14:02:47 UTC (rev 3888)
@@ -7,8 +7,7 @@
 #include &quot;ADM_default.h&quot;
 #include &quot;../ADM_audio/ADM_audiodef.h&quot;
 #include &quot;ADM_audiocodec.h&quot;
-#include &quot;ADM_audio/aviaudio.hxx&quot;
-#include &quot;ADM_audiocodec/ADM_audiocodec.h&quot;
+#include &quot;../ADM_audio/aviaudio.hxx&quot;
 
 #define AD_API_VERSION 1
 /* These are the 6 functions exported by each plugin ...*/

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/CMakeLists.txt
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/CMakeLists.txt	2008-03-13 12:21:32 UTC (rev 3887)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/CMakeLists.txt	2008-03-13 14:02:47 UTC (rev 3888)
@@ -466,11 +466,6 @@
 ENDIF (USE_X264)
 
 ###########################################
-# Plugins
-###########################################
-ADD_SUBDIRECTORY(plugins)
-
-###########################################
 # UI Specific
 ###########################################
 ADD_TARGET_LDFLAGS(avidemux2_cli ${GLIB_LDFLAGS})

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/plugins/ADM_audiodecoder/ADM_ad_ac3/CMakeLists.txt
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/plugins/ADM_audiodecoder/ADM_ad_ac3/CMakeLists.txt	2008-03-13 12:21:32 UTC (rev 3887)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/plugins/ADM_audiodecoder/ADM_ad_ac3/CMakeLists.txt	2008-03-13 14:02:47 UTC (rev 3888)
@@ -1,3 +1,6 @@
+INCLUDE(ad_plugin)
+INIT_AUDIO_PLUGIN()
+
 ADD_SUBDIRECTORY(ADM_liba52)
 
 SET(ADM_ad_a52_SRCS ADM_ad_a52.cpp)
@@ -9,7 +12,4 @@
 	TARGET_LINK_LIBRARIES(ADM_ad_a52 ADM_core)
 ENDIF (WIN32)
 
-INCLUDE(ad_plugin)
-ADM_audio_plugin(ADM_ad_a52)
-
-REMOVE_DEFINITIONS(-DHAVE_CONFIG_H)
\ No newline at end of file
+INSTALL_AUDIODECODER(ADM_ad_a52)
\ No newline at end of file

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/plugins/ADM_audiodecoder/ADM_ad_faad/CMakeLists.txt
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/plugins/ADM_audiodecoder/ADM_ad_faad/CMakeLists.txt	2008-03-13 12:21:32 UTC (rev 3887)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/plugins/ADM_audiodecoder/ADM_ad_faad/CMakeLists.txt	2008-03-13 14:02:47 UTC (rev 3888)
@@ -2,6 +2,9 @@
 checkFaad()
 
 IF (HAVE_FAAD)
+	INCLUDE(ad_plugin)
+	INIT_AUDIO_PLUGIN()
+	
 	SET(ADM_ad_faad_SRCS ADM_ad_faad.cpp)
 
 	ADD_LIBRARY(ADM_ad_faad SHARED ${ADM_ad_faad_SRCS})
@@ -11,9 +14,8 @@
 		TARGET_LINK_LIBRARIES(ADM_ad_faad ADM_core)
 	ENDIF (WIN32)
 
-	INCLUDE(ad_plugin)
-	ADM_audio_plugin(ADM_ad_faad)
-
 	ADD_TARGET_CFLAGS(ADM_ad_faad &quot;-I${FAAD_INCLUDE_DIR}&quot;)
 	ADD_TARGET_DEFINITIONS(ADM_ad_faad FAAD_OLD_PROTOTYPE)
+	
+	INSTALL_AUDIODECODER(ADM_ad_faad)
 ENDIF (HAVE_FAAD)
\ No newline at end of file

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/plugins/ADM_audiodecoder/ADM_ad_mad/CMakeLists.txt
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/plugins/ADM_audiodecoder/ADM_ad_mad/CMakeLists.txt	2008-03-13 12:21:32 UTC (rev 3887)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/plugins/ADM_audiodecoder/ADM_ad_mad/CMakeLists.txt	2008-03-13 14:02:47 UTC (rev 3888)
@@ -1,3 +1,6 @@
+INCLUDE(ad_plugin)
+INIT_AUDIO_PLUGIN()
+
 IF (ADM_CPU_X86_32)
 	ADD_DEFINITIONS(&quot;-DFPM_INTEL&quot;)
 ELSEIF (ADM_CPU_X86_64)
@@ -6,8 +9,6 @@
 	ADD_DEFINITIONS(&quot;-DFPM_PPC&quot;)
 ENDIF (ADM_CPU_X86_32)
 
-REMOVE_DEFINITIONS(-DHAVE_CONFIG_H)
-
 ADD_SUBDIRECTORY(ADM_libMad)
 
 SET(ADM_ad_Mad_SRCS ADM_ad_mad.cpp)
@@ -19,5 +20,4 @@
 	TARGET_LINK_LIBRARIES(ADM_ad_Mad ADM_core)
 ENDIF (WIN32)
 
-INCLUDE(ad_plugin)
-ADM_audio_plugin(ADM_ad_Mad)
\ No newline at end of file
+INSTALL_AUDIODECODER(ADM_ad_Mad)
\ No newline at end of file

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/plugins/ADM_audiodecoder/ADM_ad_vorbis/ADM_ad_vorbis.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/plugins/ADM_audiodecoder/ADM_ad_vorbis/ADM_ad_vorbis.cpp	2008-03-13 12:21:32 UTC (rev 3887)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/plugins/ADM_audiodecoder/ADM_ad_vorbis/ADM_ad_vorbis.cpp	2008-03-13 14:02:47 UTC (rev 3888)
@@ -25,20 +25,14 @@
  *   (at your option) any later version.                                   *
  *                                                                         *
  ***************************************************************************/
+#include &lt;vorbis/codec.h&gt;
+
 #include &quot;ADM_default.h&quot;
 #include &quot;ADM_ad_plugin.h&quot;
-
-
-#include &lt;vorbis/codec.h&gt;
 #include &quot;ADM_ad_vorbis.h&quot;
 
-#include &quot;ADM_osSupport/ADM_debugID.h&quot;
-#define MODULE_NAME MODULE_OGM_AUDIO
-#include &quot;ADM_osSupport/ADM_debug.h&quot;
+#define STRUCT ((oggVorbis *)_contextVoid)
 
-
- #define STRUCT ((oggVorbis *)_contextVoid)
- 
 class ADM_vorbis : public     ADM_Audiocodec
 {
 	protected:
@@ -199,7 +193,7 @@
 
 	// Puge them
 	 vorbis_synthesis_read(&amp;STRUCT-&gt;vdsp,nb_synth); 
-	 aprintf(&quot;This round : in %d bytes, out %d bytes synthetized:%d\n&quot;,nbIn,*nbOut,nb_synth);
+	 printf(&quot;This round : in %d bytes, out %d bytes synthetized:%d\n&quot;,nbIn,*nbOut,nb_synth);
 	return 1;
 	
 }	

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/plugins/ADM_audiodecoder/ADM_ad_vorbis/CMakeLists.txt
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/plugins/ADM_audiodecoder/ADM_ad_vorbis/CMakeLists.txt	2008-03-13 12:21:32 UTC (rev 3887)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/plugins/ADM_audiodecoder/ADM_ad_vorbis/CMakeLists.txt	2008-03-13 14:02:47 UTC (rev 3888)
@@ -1,13 +1,15 @@
-IF (USE_VORBIS)
-	SET(ADM_ad_vorbis_SRCS ADM_ad_vorbis.cpp)
-
-	ADD_LIBRARY(ADM_ad_vorbis SHARED ${ADM_ad_vorbis_SRCS})
-
-	TARGET_LINK_LIBRARIES(ADM_ad_vorbis ${VORBIS_LIBRARY_DIR})
-	TARGET_LINK_LIBRARIES(ADM_ad_vorbis ${VORBISENC_LIBRARY_DIR})
-
+IF (USE_VORBIS)
 	INCLUDE(ad_plugin)
-	ADM_audio_plugin(ADM_ad_vorbis)
+	INIT_AUDIO_PLUGIN()
 
+	SET(ADM_ad_vorbis_SRCS ADM_ad_vorbis.cpp)
+
+	ADD_LIBRARY(ADM_ad_vorbis SHARED ${ADM_ad_vorbis_SRCS})
+
+	TARGET_LINK_LIBRARIES(ADM_ad_vorbis ${VORBIS_LIBRARY_DIR})
+	TARGET_LINK_LIBRARIES(ADM_ad_vorbis ${VORBISENC_LIBRARY_DIR})
+
 	ADD_TARGET_CFLAGS(ADM_ad_vorbis &quot;-I${VORBIS_INCLUDE_DIR}&quot;)
+
+	INSTALL_AUDIODECODER(ADM_ad_vorbis)
 ENDIF (USE_VORBIS)
\ No newline at end of file

Modified: branches/avidemux_2.5_branch_gruntster/cmake/ad_plugin.cmake
===================================================================
--- branches/avidemux_2.5_branch_gruntster/cmake/ad_plugin.cmake	2008-03-13 12:21:32 UTC (rev 3887)
+++ branches/avidemux_2.5_branch_gruntster/cmake/ad_plugin.cmake	2008-03-13 14:02:47 UTC (rev 3888)
@@ -1,7 +1,9 @@
-MACRO(ADM_audio_plugin  _lib)
+MACRO(INIT_AUDIO_PLUGIN)
 	INCLUDE_DIRECTORIES(&quot;${CMAKE_BINARY_DIR}/config&quot;)
 	INCLUDE_DIRECTORIES(&quot;${CMAKE_SOURCE_DIR}/avidemux/ADM_core/include&quot;)
 	INCLUDE_DIRECTORIES(&quot;${CMAKE_SOURCE_DIR}/avidemux/ADM_audiocodec&quot;)
+ENDMACRO(INIT_AUDIO_PLUGIN)
 
+MACRO(INSTALL_AUDIODECODER _lib)
 	INSTALL(TARGETS ${_lib} DESTINATION &quot;${CMAKE_INSTALL_PREFIX}/lib/ADM_plugins/audioDecoder/&quot;)
-ENDMACRO(ADM_audio_plugin)
+ENDMACRO(INSTALL_AUDIODECODER)
\ No newline at end of file


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="001150.html">[Avidemux-svn-commit] r3887 - in	branches/avidemux_2.5_branch_gruntster: .	avidemux/ADM_core/src avidemux/ADM_libraries/ADM_lavcodec	avidemux/ADM_libraries/ADM_lavformat	avidemux/ADM_libraries/ADM_libMpeg2Dec	avidemux/plugins/ADM_audiodecoder/ADM_ad_ac3	avidemux/plugins/ADM_audiodecoder/ADM_ad_ac3/ADM_liba52	avidemux/plugins/ADM_audiodecoder/ADM_ad_faad	avidemux/plugins/ADM_audiodecoder/ADM_ad_mad	avidemux/plugins/ADM_audiodecoder/ADM_ad_mad/ADM_libMad cmake
</A></li>
	<LI>Next message: <A HREF="001152.html">[Avidemux-svn-commit] r3889 - in	branches/avidemux_2.5_branch_gruntster: avidemux	avidemux/ADM_libraries/ADM_libass avidemux/ADM_toolkit	avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog	avidemux/ADM_userInterfaces/ADM_commonUI avidemux/ADM_video	avidemux/ADM_videoFilter cmake
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1151">[ date ]</a>
              <a href="thread.html#1151">[ thread ]</a>
              <a href="subject.html#1151">[ subject ]</a>
              <a href="author.html#1151">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/avidemux-svn-commit">More information about the Avidemux-svn-commit
mailing list</a><br>
</body></html>
