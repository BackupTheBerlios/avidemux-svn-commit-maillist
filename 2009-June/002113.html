<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Avidemux-svn-commit] r4894 - in branches/avidemux_2.6_branch_mean:	avidemux avidemux/ADM_coreVideoEncoder/include	avidemux/ADM_coreVideoEncoder/src avidemux/ADM_muxerGate/src	plugins/ADM_videoEncoder/jpeg plugins/ADM_videoEncoder/png	plugins/ADM_videoEncoder/yv12
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/avidemux-svn-commit/2009-June/index.html" >
   <LINK REL="made" HREF="mailto:avidemux-svn-commit%40lists.berlios.de?Subject=Re%3A%20%5BAvidemux-svn-commit%5D%20r4894%20-%20in%20branches/avidemux_2.6_branch_mean%3A%0A%09avidemux%20avidemux/ADM_coreVideoEncoder/include%0A%09avidemux/ADM_coreVideoEncoder/src%20avidemux/ADM_muxerGate/src%0A%09plugins/ADM_videoEncoder/jpeg%20plugins/ADM_videoEncoder/png%0A%09plugins/ADM_videoEncoder/yv12&In-Reply-To=%3C200906041749.n54HnFpf030523%40sheep.berlios.de%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="002112.html">
   <LINK REL="Next"  HREF="002114.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Avidemux-svn-commit] r4894 - in branches/avidemux_2.6_branch_mean:	avidemux avidemux/ADM_coreVideoEncoder/include	avidemux/ADM_coreVideoEncoder/src avidemux/ADM_muxerGate/src	plugins/ADM_videoEncoder/jpeg plugins/ADM_videoEncoder/png	plugins/ADM_videoEncoder/yv12</H1>
    <B>mean at BerliOS</B> 
    <A HREF="mailto:avidemux-svn-commit%40lists.berlios.de?Subject=Re%3A%20%5BAvidemux-svn-commit%5D%20r4894%20-%20in%20branches/avidemux_2.6_branch_mean%3A%0A%09avidemux%20avidemux/ADM_coreVideoEncoder/include%0A%09avidemux/ADM_coreVideoEncoder/src%20avidemux/ADM_muxerGate/src%0A%09plugins/ADM_videoEncoder/jpeg%20plugins/ADM_videoEncoder/png%0A%09plugins/ADM_videoEncoder/yv12&In-Reply-To=%3C200906041749.n54HnFpf030523%40sheep.berlios.de%3E"
       TITLE="[Avidemux-svn-commit] r4894 - in branches/avidemux_2.6_branch_mean:	avidemux avidemux/ADM_coreVideoEncoder/include	avidemux/ADM_coreVideoEncoder/src avidemux/ADM_muxerGate/src	plugins/ADM_videoEncoder/jpeg plugins/ADM_videoEncoder/png	plugins/ADM_videoEncoder/yv12">mean at mail.berlios.de
       </A><BR>
    <I>Thu Jun  4 19:49:15 CEST 2009</I>
    <P><UL>
        <LI>Previous message: <A HREF="002112.html">[Avidemux-svn-commit] r4893 - in branches/avidemux_2.6_branch_mean:	cmake plugins/ADM_videoEncoder plugins/ADM_videoEncoder/x264	plugins/ADM_videoEncoder/x264/gtk
</A></li>
        <LI>Next message: <A HREF="002114.html">[Avidemux-svn-commit] r4895 -	branches/avidemux_2.6_branch_mean/plugins/ADM_videoEncoder/jpeg
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2113">[ date ]</a>
              <a href="thread.html#2113">[ thread ]</a>
              <a href="subject.html#2113">[ subject ]</a>
              <a href="author.html#2113">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Author: mean
Date: 2009-06-04 19:49:14 +0200 (Thu, 04 Jun 2009)
New Revision: 4894

Modified:
   branches/avidemux_2.6_branch_mean/avidemux/ADM_coreVideoEncoder/include/ADM_coreVideoEncoder.h
   branches/avidemux_2.6_branch_mean/avidemux/ADM_coreVideoEncoder/include/ADM_coreVideoEncoderInternal.h
   branches/avidemux_2.6_branch_mean/avidemux/ADM_coreVideoEncoder/src/ADM_dynVideoEncoder.cpp
   branches/avidemux_2.6_branch_mean/avidemux/ADM_lavcodec.h
   branches/avidemux_2.6_branch_mean/avidemux/ADM_muxerGate/src/ADM_videoProcess.cpp
   branches/avidemux_2.6_branch_mean/avidemux/gui_savenew.cpp
   branches/avidemux_2.6_branch_mean/plugins/ADM_videoEncoder/jpeg/ADM_jpegEncoder.cpp
   branches/avidemux_2.6_branch_mean/plugins/ADM_videoEncoder/jpeg/ADM_jpegEncoder.h
   branches/avidemux_2.6_branch_mean/plugins/ADM_videoEncoder/jpeg/CMakeLists.txt
   branches/avidemux_2.6_branch_mean/plugins/ADM_videoEncoder/jpeg/jpegPlugin.cpp
   branches/avidemux_2.6_branch_mean/plugins/ADM_videoEncoder/png/ADM_pngEncoder.cpp
   branches/avidemux_2.6_branch_mean/plugins/ADM_videoEncoder/png/ADM_pngEncoder.h
   branches/avidemux_2.6_branch_mean/plugins/ADM_videoEncoder/png/pngPlugin.cpp
   branches/avidemux_2.6_branch_mean/plugins/ADM_videoEncoder/yv12/ADM_yv12Encoder.cpp
   branches/avidemux_2.6_branch_mean/plugins/ADM_videoEncoder/yv12/ADM_yv12Encoder.h
   branches/avidemux_2.6_branch_mean/plugins/ADM_videoEncoder/yv12/yv12Plugin.cpp
Log:
[encoder] First lavcodec based encoder : mjpeg

Modified: branches/avidemux_2.6_branch_mean/avidemux/ADM_coreVideoEncoder/include/ADM_coreVideoEncoder.h
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/ADM_coreVideoEncoder/include/ADM_coreVideoEncoder.h	2009-06-04 17:49:11 UTC (rev 4893)
+++ branches/avidemux_2.6_branch_mean/avidemux/ADM_coreVideoEncoder/include/ADM_coreVideoEncoder.h	2009-06-04 17:49:14 UTC (rev 4894)
@@ -39,23 +39,13 @@
 public:
                             ADM_coreVideoEncoder(ADM_coreVideoFilter *src);
                             ~ADM_coreVideoEncoder();
+virtual        bool         setup(void) {return true;}    /// Call once before using            
 virtual        bool         encode (ADMBitstream * out)=0;
 
-virtual        bool         setOption(ADM_coreEncoderOption option, int32_t val) {return true;} /// Set external header mode (ESDS atom &amp; friends)
-virtual        bool         setFreeOption(const char *option, void *data) {return true;} /// Set external header mode (ESDS atom &amp; friends)
-
-
 virtual        bool         isDualPass(void) {return false;}
 virtual        bool         startPass2(void) {return true;}
 virtual        bool         getExtraData(uint32_t *l,uint8_t **d) {*l=0;*d=NULL;return true;}
-
-virtual        const char *getDisplayName(void)=0;       /// E.g. FFmpeg mpeg4      
-virtual        const char *getCodecName(void)=0;         /// aka fourcc
-virtual        const char *getFCCHandler(void)=0;        /// fourcc 2, needed to build AVI header
-
-virtual        bool        configure(void)=0;           /// Pop-up UI
-virtual        bool        getConfiguration(uint32_t *l,uint8_t **d)=0; /// Get current conf to save it
-virtual        bool        setConfiguration(uint32_t l,uint8_t *d)=0;   /// Set conf, call it just after creation
+virtual const  char         *getFourcc(void) =0;
                uint32_t    getWidth(void) {return source-&gt;getInfo()-&gt;width;}
                uint32_t    getHeight(void) {return source-&gt;getInfo()-&gt;height;}
                uint32_t    getFrameIncrement(void) {return source-&gt;getInfo()-&gt;frameIncrement;}

Modified: branches/avidemux_2.6_branch_mean/avidemux/ADM_coreVideoEncoder/include/ADM_coreVideoEncoderInternal.h
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/ADM_coreVideoEncoder/include/ADM_coreVideoEncoderInternal.h	2009-06-04 17:49:11 UTC (rev 4893)
+++ branches/avidemux_2.6_branch_mean/avidemux/ADM_coreVideoEncoder/include/ADM_coreVideoEncoderInternal.h	2009-06-04 17:49:14 UTC (rev 4894)
@@ -30,7 +30,6 @@
 {
     const char   *encoderName;        // Internal name (tag)
     const char   *menuName;         // Displayed name (in menu)
-    const char   *fourCC;
     const char   *description;      // Short description
 
     uint32_t     apiVersion;            // const
@@ -97,11 +96,10 @@
 }
 
 
-#define ADM_DECLARE_VIDEO_ENCODER_MAIN(name,menuName,fourcc,desc,configure,uiType,maj,minV,patch) \
+#define ADM_DECLARE_VIDEO_ENCODER_MAIN(name,menuName,desc,configure,uiType,maj,minV,patch) \
 static ADM_videoEncoderDesc encoderDesc={\
     name,\
     menuName,\
-    fourcc,\
     desc,\
     ADM_VIDEO_ENCODER_API_VERSION,\
     &amp;create,\

Modified: branches/avidemux_2.6_branch_mean/avidemux/ADM_coreVideoEncoder/src/ADM_dynVideoEncoder.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/ADM_coreVideoEncoder/src/ADM_dynVideoEncoder.cpp	2009-06-04 17:49:11 UTC (rev 4893)
+++ branches/avidemux_2.6_branch_mean/avidemux/ADM_coreVideoEncoder/src/ADM_dynVideoEncoder.cpp	2009-06-04 17:49:14 UTC (rev 4894)
@@ -60,7 +60,6 @@
 ADM_videoEncoderDesc copyDesc={
         &quot;Copy&quot;,
         &quot;Copy&quot;,
-        &quot;Copy&quot;,
         &quot;Copy encoder&quot;,
         ADM_VIDEO_ENCODER_API_VERSION, //uint32_t     apiVersion;            // const
 
@@ -200,6 +199,15 @@
     ADM_videoEncoder6 *plugin=ListOfEncoders[index];
 
     ADM_coreVideoEncoder *enc=plugin-&gt;desc-&gt;create(chain);
+    if(enc)
+    {
+        if(false==enc-&gt;setup())
+        {
+            printf(&quot;[createVideoEncoderFromIndex] Cannot setup encoder\n&quot;);
+            delete enc;
+            return NULL;
+        }
+    }
     return enc;
 }
 /**

Modified: branches/avidemux_2.6_branch_mean/avidemux/ADM_lavcodec.h
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/ADM_lavcodec.h	2009-06-04 17:49:11 UTC (rev 4893)
+++ branches/avidemux_2.6_branch_mean/avidemux/ADM_lavcodec.h	2009-06-04 17:49:14 UTC (rev 4894)
@@ -18,6 +18,7 @@
   #define  __ADM_LAVC
   extern &quot;C&quot;
   {  
+  #define __STDC_CONSTANT_MACROS // Lavcodec crap
   #include &quot;ADM_libraries/ADM_ffmpeg/libavcodec/avcodec.h&quot;
   };
 #endif

Modified: branches/avidemux_2.6_branch_mean/avidemux/ADM_muxerGate/src/ADM_videoProcess.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/ADM_muxerGate/src/ADM_videoProcess.cpp	2009-06-04 17:49:11 UTC (rev 4893)
+++ branches/avidemux_2.6_branch_mean/avidemux/ADM_muxerGate/src/ADM_videoProcess.cpp	2009-06-04 17:49:14 UTC (rev 4894)
@@ -27,7 +27,7 @@
 
     width=encoder-&gt;getWidth();
     height=encoder-&gt;getHeight();
-    fcc=encoder-&gt;getFCCHandler();
+    fcc=encoder-&gt;getFourcc();
     printf(&quot;[StreamProcess] Stream %&quot;LU&quot;x%&quot;LU&quot;, codec : %s\n&quot;,width,height,fcc);
     fourCC=fourCC::get((uint8_t *)fcc);
     float f=encoder-&gt;getFrameIncrement();

Modified: branches/avidemux_2.6_branch_mean/avidemux/gui_savenew.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/gui_savenew.cpp	2009-06-04 17:49:11 UTC (rev 4893)
+++ branches/avidemux_2.6_branch_mean/avidemux/gui_savenew.cpp	2009-06-04 17:49:14 UTC (rev 4894)
@@ -87,7 +87,7 @@
                 return 0;
         }
         // 2- Create Encoder
-        video=createVideoStream(chain,1);
+        video=createVideoStream(chain,UI_GetCurrentFormat());
         if(!video)
         {
                 GUI_Error_HIG(&quot;Video&quot;,&quot;Cannot create encoder&quot;);

Modified: branches/avidemux_2.6_branch_mean/plugins/ADM_videoEncoder/jpeg/ADM_jpegEncoder.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/plugins/ADM_videoEncoder/jpeg/ADM_jpegEncoder.cpp	2009-06-04 17:49:11 UTC (rev 4893)
+++ branches/avidemux_2.6_branch_mean/plugins/ADM_videoEncoder/jpeg/ADM_jpegEncoder.cpp	2009-06-04 17:49:14 UTC (rev 4894)
@@ -15,9 +15,13 @@
  *   (at your option) any later version.                                   *
  *                                                                         *
  ***************************************************************************/
+#include &quot;ADM_lavcodec.h&quot;
 #include &quot;ADM_default.h&quot;
 #include &quot;ADM_jpegEncoder.h&quot;
 
+
+static int Quantizer=2;
+static ADM_colorspace color=ADM_COLOR_RGB24; //ADM_COLOR_YUV422;
 /**
         \fn ADM_jpegEncoder
 */
@@ -30,64 +34,84 @@
     h=info-&gt;height;
     image=new ADMImage(w,h);
     plane=(w*h*3)/2;
-}
-/** 
-    \fn ~ADM_jpegEncoder
-*/
-ADM_jpegEncoder::~ADM_jpegEncoder()
-{
-    printf(&quot;[jpegEncoder] Destroying.\n&quot;);
-}
-/**
-    \fn getDisplayName
-*/
+    _context = avcodec_alloc_context ();
+    ADM_assert (_context);
+    memset (&amp;_frame, 0, sizeof (_frame));
+    _frame.pts = AV_NOPTS_VALUE;
+    _context-&gt;width = w;
+    _context-&gt;height = h;
+    _context-&gt;strict_std_compliance = -1;
+    // YV12
+    switch(color)
+    {
+        case ADM_COLOR_YUV422: _frame.linesize[0] = w*2; _context-&gt;pix_fmt =PIX_FMT_YUYV422;break;
+        case ADM_COLOR_RGB24 : _frame.linesize[0] = w*3; _context-&gt;pix_fmt =PIX_FMT_RGB24;break;
+        default: ADM_assert(0);
 
-const char *ADM_jpegEncoder::getDisplayName(void)
-{
-    return &quot;jpeg Encoder&quot;;
-
+    }
+    _frame.linesize[1] = 0;//w &gt;&gt; 1;
+    _frame.linesize[2] = 0;//w &gt;&gt; 1;
+    //   
+    _frame.quality = (int) floor (FF_QP2LAMBDA * Quantizer+ 0.5);
+    rgbBuffer=new uint8_t [(w+7)*(h+7)*4];
 }
 /**
-    \fn getCodecName
+    \fn setup
 */
-
-const char *ADM_jpegEncoder::getCodecName(void)
+bool ADM_jpegEncoder::setup(void)
 {
-    return &quot;jpeg&quot;;
-}
-/**
-    \fn getFCCHandler
-*/
-
-const char *ADM_jpegEncoder::getFCCHandler(void)
-{
-    return &quot;jpeg&quot;;
-
-}
-/**
-    \fn configure
-*/
-bool        ADM_jpegEncoder::configure(void)
-{
+int res;
+AVCodec *codec=avcodec_find_encoder(CODEC_ID_MJPEG);
+if(!codec) 
+    {
+        printf(&quot;[Jpeg] Cannot find codec\n&quot;);
+        return false;
+    }
+   // capabilities = codec-&gt;capabilities &amp; CODEC_CAP_DELAY ? ADM_ENC_REQ_NULL_FLUSH : 0; 
+   res=avcodec_open(_context, codec); 
+   if(res&lt;0) 
+    {   printf(&quot;[Jpeg] Cannot open codec\n&quot;);
+        return false;
+    }
+    _context-&gt;flags |= CODEC_FLAG_QSCALE;
+    // Now allocate colorspace
+    int w,h;
+    FilterInfo *info=source-&gt;getInfo();
+    w=info-&gt;width;
+    h=info-&gt;height;
+    
+    colorSpace=new ADMColorspace(w,h,ADM_COLOR_YV12,color);
+    if(!colorSpace)
+    {
+        printf(&quot;[ADM_jpegEncoder] Cannot allocate colorspace\n&quot;);
+        return false;
+    }
     return true;
 }
 
-/**
-    \fn getConfiguration
-*/
-bool        ADM_jpegEncoder::getConfiguration(uint32_t *l,uint8_t **d)
-{
-        *l=0;
-        *d=NULL;
-        return true;
-}
 
-/**
-    \fn setConfiguration
+/** 
+    \fn ~ADM_jpegEncoder
 */
-bool        ADM_jpegEncoder::setConfiguration(uint32_t l,uint8_t *d)
+ADM_jpegEncoder::~ADM_jpegEncoder()
 {
-        return true;
+    printf(&quot;[jpegEncoder] Destroying.\n&quot;);
+    if (_context)
+    {
+        avcodec_close (_context);
+        ADM_dealloc (_context);
+        _context = NULL;
+    }
+    if(colorSpace)
+    {
+        delete colorSpace;
+        colorSpace=NULL;
+    }   
+    if(rgbBuffer)
+    {
+        delete [] rgbBuffer;
+        rgbBuffer=NULL;
+    }
 }
 
 /**
@@ -100,9 +124,25 @@
         printf(&quot;[jpeg] Cannot get next image\n&quot;);
         return false;
     }
-    ADM_assert(out-&gt;bufferSize&gt;plane);
-    memcpy(out-&gt;data,image-&gt;data,plane);
-    out-&gt;len=plane;
+    // 1- Convert to RGB24
+     if(!colorSpace-&gt;convert(image-&gt;data,rgbBuffer))
+        {
+            printf(&quot;[ADM_jpegEncoder::encode] Colorconversion failed\n&quot;);
+            return false;
+        }
+           
+    _frame.data[0] = rgbBuffer;
+    _frame.data[2] = NULL;
+    _frame.data[1] = NULL;
+
+    int sz=0;
+    if ((sz = avcodec_encode_video (_context, out-&gt;data, out-&gt;bufferSize, &amp;_frame)) &lt; 0)
+    {
+        printf(&quot;[jpeg] Error %d encoding video\n&quot;,sz);
+        return false;
+    }
+    
+    out-&gt;len=sz;
     out-&gt;pts=out-&gt;dts=image-&gt;Pts;
     out-&gt;flags=AVI_KEY_FRAME;
     return true;

Modified: branches/avidemux_2.6_branch_mean/plugins/ADM_videoEncoder/jpeg/ADM_jpegEncoder.h
===================================================================
--- branches/avidemux_2.6_branch_mean/plugins/ADM_videoEncoder/jpeg/ADM_jpegEncoder.h	2009-06-04 17:49:11 UTC (rev 4893)
+++ branches/avidemux_2.6_branch_mean/plugins/ADM_videoEncoder/jpeg/ADM_jpegEncoder.h	2009-06-04 17:49:14 UTC (rev 4894)
@@ -18,8 +18,11 @@
 #ifndef ADM_jpeg_ENCODER_H
 #define ADM_jpeg_ENCODER_H
 #include &quot;ADM_coreVideoEncoder.h&quot;
-
-
+#include &quot;ADM_colorspace.h&quot;
+extern &quot;C&quot; 
+{
+#include &quot;ADM_lavcodec.h&quot;
+}
 /**
         \class ADM_jpegEncoder
         \brief Dummy encoder that does nothing
@@ -28,19 +31,18 @@
 class ADM_jpegEncoder : public ADM_coreVideoEncoder
 {
 protected:
-               int plane;
+               int              plane;
+               AVCodecContext   *_context;
+               AVFrame          _frame;
+               ADMColorspace    *colorSpace;
+               uint8_t          *rgbBuffer;
 public:
 
                             ADM_jpegEncoder(ADM_coreVideoFilter *src);
                             ~ADM_jpegEncoder();
-virtual        bool         encode (ADMBitstream * out);
-virtual        const char *getDisplayName(void);       /// E.g. FFmpeg mpeg4      
-virtual        const char *getCodecName(void);         /// aka fourcc
-virtual        const char *getFCCHandler(void);        /// fourcc 2, needed to build AVI header
-
-virtual        bool        configure(void);           /// Pop-up UI
-virtual        bool        getConfiguration(uint32_t *l,uint8_t **d); /// Get current conf to save it
-virtual        bool        setConfiguration(uint32_t l,uint8_t *d);   /// Set conf, call it just after creation
+virtual        bool        setup(void); 
+virtual        bool        encode (ADMBitstream * out);
+virtual const  char         *getFourcc(void) {return &quot;jpeg&quot;;}
 };
 
 

Modified: branches/avidemux_2.6_branch_mean/plugins/ADM_videoEncoder/jpeg/CMakeLists.txt
===================================================================
--- branches/avidemux_2.6_branch_mean/plugins/ADM_videoEncoder/jpeg/CMakeLists.txt	2009-06-04 17:49:11 UTC (rev 4893)
+++ branches/avidemux_2.6_branch_mean/plugins/ADM_videoEncoder/jpeg/CMakeLists.txt	2009-06-04 17:49:14 UTC (rev 4894)
@@ -9,4 +9,7 @@
 ADD_LIBRARY(ADM_ve_jpeg SHARED ${jpeg_SRCS})
 
 INIT_VIDEO_ENCODER(ADM_ve_jpeg)
-INSTALL_VIDEO_ENCODER(ADM_ve_jpeg)
+INSTALL_VIDEO_ENCODER(ADM_ve_jpeg)
+
+INCLUDE_DIRECTORIES(&quot;${AVIDEMUX_SOURCE_DIR}/avidemux/&quot;)
+INCLUDE_DIRECTORIES(&quot;${AVIDEMUX_SOURCE_DIR}/avidemux/ADM_libraries/ADM_ffmpeg&quot;)

Modified: branches/avidemux_2.6_branch_mean/plugins/ADM_videoEncoder/jpeg/jpegPlugin.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/plugins/ADM_videoEncoder/jpeg/jpegPlugin.cpp	2009-06-04 17:49:11 UTC (rev 4893)
+++ branches/avidemux_2.6_branch_mean/plugins/ADM_videoEncoder/jpeg/jpegPlugin.cpp	2009-06-04 17:49:14 UTC (rev 4894)
@@ -24,7 +24,6 @@
 ADM_DECLARE_VIDEO_ENCODER_NO_CONFIG();
 ADM_DECLARE_VIDEO_ENCODER_MAIN(&quot;Mjpeg&quot;,
                                &quot;Mjpeg Encoder&quot;,
-                               &quot;jpeg&quot;,
                                &quot;Simple jpeg Encoder (c) 2009 Mean&quot;,
                                 NULL, // No configuration
                                 ADM_UI_ALL,

Modified: branches/avidemux_2.6_branch_mean/plugins/ADM_videoEncoder/png/ADM_pngEncoder.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/plugins/ADM_videoEncoder/png/ADM_pngEncoder.cpp	2009-06-04 17:49:11 UTC (rev 4893)
+++ branches/avidemux_2.6_branch_mean/plugins/ADM_videoEncoder/png/ADM_pngEncoder.cpp	2009-06-04 17:49:14 UTC (rev 4894)
@@ -38,59 +38,9 @@
 {
     printf(&quot;[YV12Encoder] Destroying.\n&quot;);
 }
-/**
-    \fn getDisplayName
-*/
 
-const char *ADM_pngEncoder::getDisplayName(void)
-{
-    return &quot;YV12 Encoder&quot;;
 
-}
 /**
-    \fn getCodecName
-*/
-
-const char *ADM_pngEncoder::getCodecName(void)
-{
-    return &quot;yv12&quot;;
-}
-/**
-    \fn getFCCHandler
-*/
-
-const char *ADM_pngEncoder::getFCCHandler(void)
-{
-    return &quot;yv12&quot;;
-
-}
-/**
-    \fn configure
-*/
-bool        ADM_pngEncoder::configure(void)
-{
-    return true;
-}
-
-/**
-    \fn getConfiguration
-*/
-bool        ADM_pngEncoder::getConfiguration(uint32_t *l,uint8_t **d)
-{
-        *l=0;
-        *d=NULL;
-        return true;
-}
-
-/**
-    \fn setConfiguration
-*/
-bool        ADM_pngEncoder::setConfiguration(uint32_t l,uint8_t *d)
-{
-        return true;
-}
-
-/**
     \fn encode
 */
 bool         ADM_pngEncoder::encode (ADMBitstream * out)

Modified: branches/avidemux_2.6_branch_mean/plugins/ADM_videoEncoder/png/ADM_pngEncoder.h
===================================================================
--- branches/avidemux_2.6_branch_mean/plugins/ADM_videoEncoder/png/ADM_pngEncoder.h	2009-06-04 17:49:11 UTC (rev 4893)
+++ branches/avidemux_2.6_branch_mean/plugins/ADM_videoEncoder/png/ADM_pngEncoder.h	2009-06-04 17:49:14 UTC (rev 4894)
@@ -34,13 +34,7 @@
                             ADM_pngEncoder(ADM_coreVideoFilter *src);
                             ~ADM_pngEncoder();
 virtual        bool         encode (ADMBitstream * out);
-virtual        const char *getDisplayName(void);       /// E.g. FFmpeg mpeg4      
-virtual        const char *getCodecName(void);         /// aka fourcc
-virtual        const char *getFCCHandler(void);        /// fourcc 2, needed to build AVI header
-
-virtual        bool        configure(void);           /// Pop-up UI
-virtual        bool        getConfiguration(uint32_t *l,uint8_t **d); /// Get current conf to save it
-virtual        bool        setConfiguration(uint32_t l,uint8_t *d);   /// Set conf, call it just after creation
+virtual const  char         *getFourcc(void) {return &quot;png &quot;;}
 };
 
 

Modified: branches/avidemux_2.6_branch_mean/plugins/ADM_videoEncoder/png/pngPlugin.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/plugins/ADM_videoEncoder/png/pngPlugin.cpp	2009-06-04 17:49:11 UTC (rev 4893)
+++ branches/avidemux_2.6_branch_mean/plugins/ADM_videoEncoder/png/pngPlugin.cpp	2009-06-04 17:49:14 UTC (rev 4894)
@@ -24,7 +24,6 @@
 ADM_DECLARE_VIDEO_ENCODER_NO_CONFIG();
 ADM_DECLARE_VIDEO_ENCODER_MAIN(&quot;PNG&quot;,
                                &quot;PNG Encoder&quot;,
-                               &quot;PNG &quot;,
                                &quot;Simple PNG Encoder (c) 2009 Mean&quot;,
                                 NULL, // No configuration
                                 ADM_UI_ALL,

Modified: branches/avidemux_2.6_branch_mean/plugins/ADM_videoEncoder/yv12/ADM_yv12Encoder.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/plugins/ADM_videoEncoder/yv12/ADM_yv12Encoder.cpp	2009-06-04 17:49:11 UTC (rev 4893)
+++ branches/avidemux_2.6_branch_mean/plugins/ADM_videoEncoder/yv12/ADM_yv12Encoder.cpp	2009-06-04 17:49:14 UTC (rev 4894)
@@ -38,59 +38,9 @@
 {
     printf(&quot;[YV12Encoder] Destroying.\n&quot;);
 }
-/**
-    \fn getDisplayName
-*/
 
-const char *ADM_yv12Encoder::getDisplayName(void)
-{
-    return &quot;YV12 Encoder&quot;;
 
-}
 /**
-    \fn getCodecName
-*/
-
-const char *ADM_yv12Encoder::getCodecName(void)
-{
-    return &quot;yv12&quot;;
-}
-/**
-    \fn getFCCHandler
-*/
-
-const char *ADM_yv12Encoder::getFCCHandler(void)
-{
-    return &quot;yv12&quot;;
-
-}
-/**
-    \fn configure
-*/
-bool        ADM_yv12Encoder::configure(void)
-{
-    return true;
-}
-
-/**
-    \fn getConfiguration
-*/
-bool        ADM_yv12Encoder::getConfiguration(uint32_t *l,uint8_t **d)
-{
-        *l=0;
-        *d=NULL;
-        return true;
-}
-
-/**
-    \fn setConfiguration
-*/
-bool        ADM_yv12Encoder::setConfiguration(uint32_t l,uint8_t *d)
-{
-        return true;
-}
-
-/**
     \fn encode
 */
 bool         ADM_yv12Encoder::encode (ADMBitstream * out)

Modified: branches/avidemux_2.6_branch_mean/plugins/ADM_videoEncoder/yv12/ADM_yv12Encoder.h
===================================================================
--- branches/avidemux_2.6_branch_mean/plugins/ADM_videoEncoder/yv12/ADM_yv12Encoder.h	2009-06-04 17:49:11 UTC (rev 4893)
+++ branches/avidemux_2.6_branch_mean/plugins/ADM_videoEncoder/yv12/ADM_yv12Encoder.h	2009-06-04 17:49:14 UTC (rev 4894)
@@ -34,13 +34,7 @@
                             ADM_yv12Encoder(ADM_coreVideoFilter *src);
                             ~ADM_yv12Encoder();
 virtual        bool         encode (ADMBitstream * out);
-virtual        const char *getDisplayName(void);       /// E.g. FFmpeg mpeg4      
-virtual        const char *getCodecName(void);         /// aka fourcc
-virtual        const char *getFCCHandler(void);        /// fourcc 2, needed to build AVI header
-
-virtual        bool        configure(void);           /// Pop-up UI
-virtual        bool        getConfiguration(uint32_t *l,uint8_t **d); /// Get current conf to save it
-virtual        bool        setConfiguration(uint32_t l,uint8_t *d);   /// Set conf, call it just after creation
+virtual const  char         *getFourcc(void) {return &quot;YV12&quot;;}
 };
 
 

Modified: branches/avidemux_2.6_branch_mean/plugins/ADM_videoEncoder/yv12/yv12Plugin.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/plugins/ADM_videoEncoder/yv12/yv12Plugin.cpp	2009-06-04 17:49:11 UTC (rev 4893)
+++ branches/avidemux_2.6_branch_mean/plugins/ADM_videoEncoder/yv12/yv12Plugin.cpp	2009-06-04 17:49:14 UTC (rev 4894)
@@ -24,7 +24,6 @@
 ADM_DECLARE_VIDEO_ENCODER_NO_CONFIG();
 ADM_DECLARE_VIDEO_ENCODER_MAIN(&quot;YV12Encoder&quot;,
                                &quot;YV12 Encoder&quot;,
-                               &quot;YV12&quot;,
                                &quot;Simple YV12 Encoder (c) 2009 Mean&quot;,
                                 NULL, // No configuration
                                 ADM_UI_ALL,


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="002112.html">[Avidemux-svn-commit] r4893 - in branches/avidemux_2.6_branch_mean:	cmake plugins/ADM_videoEncoder plugins/ADM_videoEncoder/x264	plugins/ADM_videoEncoder/x264/gtk
</A></li>
	<LI>Next message: <A HREF="002114.html">[Avidemux-svn-commit] r4895 -	branches/avidemux_2.6_branch_mean/plugins/ADM_videoEncoder/jpeg
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2113">[ date ]</a>
              <a href="thread.html#2113">[ thread ]</a>
              <a href="subject.html#2113">[ subject ]</a>
              <a href="author.html#2113">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/avidemux-svn-commit">More information about the Avidemux-svn-commit
mailing list</a><br>
</body></html>
