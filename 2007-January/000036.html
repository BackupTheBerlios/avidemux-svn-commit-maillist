<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Avidemux-svn-commit] r2708 - in	branches/avidemux_2.4_branch/avidemux:	ADM_userInterfaces/ADM_GTK/ADM_dialog	ADM_userInterfaces/ADM_NONE/ADM_dialog	ADM_userInterfaces/ADM_QT4/ADM_dialog ADM_video ADM_videoFilter
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/avidemux-svn-commit/2007-January/index.html" >
   <LINK REL="made" HREF="mailto:avidemux-svn-commit%40lists.berlios.de?Subject=Re%3A%20%5BAvidemux-svn-commit%5D%20r2708%20-%20in%0A%09branches/avidemux_2.4_branch/avidemux%3A%0A%09ADM_userInterfaces/ADM_GTK/ADM_dialog%0A%09ADM_userInterfaces/ADM_NONE/ADM_dialog%0A%09ADM_userInterfaces/ADM_QT4/ADM_dialog%20ADM_video%20ADM_videoFilter&In-Reply-To=%3C200701120715.l0C7FFm6001034%40sheep.berlios.de%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000035.html">
   <LINK REL="Next"  HREF="000037.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Avidemux-svn-commit] r2708 - in	branches/avidemux_2.4_branch/avidemux:	ADM_userInterfaces/ADM_GTK/ADM_dialog	ADM_userInterfaces/ADM_NONE/ADM_dialog	ADM_userInterfaces/ADM_QT4/ADM_dialog ADM_video ADM_videoFilter</H1>
    <B>mean at BerliOS</B> 
    <A HREF="mailto:avidemux-svn-commit%40lists.berlios.de?Subject=Re%3A%20%5BAvidemux-svn-commit%5D%20r2708%20-%20in%0A%09branches/avidemux_2.4_branch/avidemux%3A%0A%09ADM_userInterfaces/ADM_GTK/ADM_dialog%0A%09ADM_userInterfaces/ADM_NONE/ADM_dialog%0A%09ADM_userInterfaces/ADM_QT4/ADM_dialog%20ADM_video%20ADM_videoFilter&In-Reply-To=%3C200701120715.l0C7FFm6001034%40sheep.berlios.de%3E"
       TITLE="[Avidemux-svn-commit] r2708 - in	branches/avidemux_2.4_branch/avidemux:	ADM_userInterfaces/ADM_GTK/ADM_dialog	ADM_userInterfaces/ADM_NONE/ADM_dialog	ADM_userInterfaces/ADM_QT4/ADM_dialog ADM_video ADM_videoFilter">mean at mail.berlios.de
       </A><BR>
    <I>Fri Jan 12 08:15:15 CET 2007</I>
    <P><UL>
        <LI>Previous message: <A HREF="000035.html">[Avidemux-svn-commit] r2707 -	branches/avidemux_2.3_branch/avidemux/ADM_codecs
</A></li>
        <LI>Next message: <A HREF="000037.html">[Avidemux-svn-commit] r2709 - in	branches/avidemux_2.4_branch/avidemux: . ADM_audiofilter	ADM_filter ADM_userInterfaces/ADM_GTK/ADM_dialog	ADM_userInterfaces/ADM_commonUI
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#36">[ date ]</a>
              <a href="thread.html#36">[ thread ]</a>
              <a href="subject.html#36">[ subject ]</a>
              <a href="author.html#36">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Author: mean
Date: 2007-01-12 08:15:14 +0100 (Fri, 12 Jan 2007)
New Revision: 2708

Added:
   branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/ADM_vidDGbob.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/ADM_vidDGbob_param.h
Removed:
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_dgbob.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_video/ADM_vidDGbob.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_video/ADM_vidDGbob_param.h
Modified:
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/Makefile.am
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_NONE/ADM_dialog/DIA_none.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_none.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_video/Makefile.am
   branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/Makefile.am
Log:
dgbob switched to dialogFactory

Deleted: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_dgbob.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_dgbob.cpp	2007-01-12 06:50:08 UTC (rev 2707)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_dgbob.cpp	2007-01-12 07:15:14 UTC (rev 2708)
@@ -1,244 +0,0 @@
-//
-// C++ Implementation: DIA_decimate
-//
-// Description: 
-//
-//
-// Author: mean &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/avidemux-svn-commit">fixounet at free.fr</A>&gt;, (C) 2004
-//
-// Copyright: See COPYING file that comes with this distribution
-//
-//
-//
-// C++ Implementation: DIA_dectel
-//
-// Description: 
-//
-//
-// Author: mean &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/avidemux-svn-commit">fixounet at free.fr</A>&gt;, (C) 2004
-//
-// Copyright: See COPYING file that comes with this distribution
-//
-//
-
-
-#include &lt;config.h&gt;
-
-#include &lt;sys/types.h&gt;
-#include &lt;sys/stat.h&gt;
-
-
-#include &lt;gdk/gdkkeysyms.h&gt;
-#include &lt;gtk/gtk.h&gt;
-
-
-#include &lt;gdk/gdkkeysyms.h&gt;
-#include &lt;gtk/gtk.h&gt;
-# include &lt;math.h&gt;
-
-#include &quot;default.h&quot;
-#include &quot;ADM_toolkit_gtk/ADM_gladeSupport.h&quot;
-#include &quot;ADM_toolkit_gtk/toolkit_gtk.h&quot;
-#include &quot;ADM_toolkit_gtk/toolkit_gtk_include.h&quot;
-#include &quot;ADM_toolkit/toolkit.hxx&quot;
-
-#include &quot;ADM_video/ADM_vidDGbob_param.h&quot;
-
-#define MENU_SET(x,y) { gtk_option_menu_set_history (GTK_OPTION_MENU(WID(x)),param-&gt;y);}
-#define MENU_GET(x,y) { param-&gt;y        = getRangeInMenu(WID(x));}
-
-#define CHECK_GET(x,y) {param-&gt;y=gtk_toggle_button_get_active( GTK_TOGGLE_BUTTON(WID(x)));}
-#define CHECK_SET(x,y) {gtk_toggle_button_set_active( GTK_TOGGLE_BUTTON(WID(x)),param-&gt;y);}
-
-
-static GtkWidget        *create_dialog1 (void);
-
-uint8_t DIA_getDGbob(DGBobparam *param)
-{
-GtkWidget *dialog;
-GtkAdjustment *adj;
-
-int ret=0;
-        dialog=create_dialog1();
-        
-        // Update
-        MENU_SET(optionmenu1,mode);
-        CHECK_SET(checkbutton1,ap);
-        if(param-&gt;order)  RADIO_SET(radiobutton2,1);
-                else     RADIO_SET(radiobutton1,1);
-         gtk_range_set_value (GTK_RANGE(WID(hscale1)),(gdouble)param-&gt;thresh);
-        // run
-        gtk_register_dialog(dialog);
-        if(gtk_dialog_run(GTK_DIALOG(dialog))==GTK_RESPONSE_OK)
-        {
-                MENU_GET(optionmenu1,mode);
-                CHECK_GET(checkbutton1,ap);       
-                param-&gt;order= RADIO_GET(radiobutton2);                
-                adj=gtk_range_get_adjustment (GTK_RANGE(WID(hscale1)));
-                param-&gt;thresh=GTK_ADJUSTMENT(adj)-&gt;value;
-                ret=1;
-        }
-        gtk_unregister_dialog(dialog);
-        gtk_widget_destroy(dialog);
-        return ret;
-}
-
-
-GtkWidget*
-create_dialog1 (void)
-{
-  GtkWidget *dialog1;
-  GtkWidget *dialog_vbox1;
-  GtkWidget *table1;
-  GtkWidget *label1;
-  GtkWidget *label2;
-  GtkWidget *label3;
-  GtkWidget *label4;
-  GtkWidget *hbox1;
-  GtkWidget *radiobutton1;
-  GSList *radiobutton1_group = NULL;
-  GtkWidget *radiobutton2;
-  GtkWidget *optionmenu1;
-  GtkWidget *menu1;
-  GtkWidget *mode_0;
-  GtkWidget *one;
-  GtkWidget *double1;
-  GtkWidget *hscale1;
-  GtkWidget *checkbutton1;
-  GtkWidget *dialog_action_area1;
-  GtkWidget *cancelbutton1;
-  GtkWidget *okbutton1;
-
-  dialog1 = gtk_dialog_new ();
-  gtk_window_set_title (GTK_WINDOW (dialog1), _(&quot;DGbob&quot;));
-
-  dialog_vbox1 = GTK_DIALOG (dialog1)-&gt;vbox;
-  gtk_widget_show (dialog_vbox1);
-
-  table1 = gtk_table_new (4, 2, FALSE);
-  gtk_widget_show (table1);
-  gtk_box_pack_start (GTK_BOX (dialog_vbox1), table1, TRUE, TRUE, 0);
-
-  label1 = gtk_label_new (_(&quot;Field Order&quot;));
-  gtk_widget_show (label1);
-  gtk_table_attach (GTK_TABLE (table1), label1, 0, 1, 0, 1,
-                    (GtkAttachOptions) (GTK_FILL),
-                    (GtkAttachOptions) (0), 0, 0);
-  gtk_label_set_justify (GTK_LABEL (label1), GTK_JUSTIFY_LEFT);
-  gtk_misc_set_alignment (GTK_MISC (label1), 0, 0.5);
-
-  label2 = gtk_label_new (_(&quot;Mode&quot;));
-  gtk_widget_show (label2);
-  gtk_table_attach (GTK_TABLE (table1), label2, 0, 1, 1, 2,
-                    (GtkAttachOptions) (GTK_FILL),
-                    (GtkAttachOptions) (0), 0, 0);
-  gtk_label_set_justify (GTK_LABEL (label2), GTK_JUSTIFY_LEFT);
-  gtk_misc_set_alignment (GTK_MISC (label2), 0, 0.5);
-
-  label3 = gtk_label_new (_(&quot;Threshold&quot;));
-  gtk_widget_show (label3);
-  gtk_table_attach (GTK_TABLE (table1), label3, 0, 1, 2, 3,
-                    (GtkAttachOptions) (GTK_FILL),
-                    (GtkAttachOptions) (0), 0, 0);
-  gtk_label_set_justify (GTK_LABEL (label3), GTK_JUSTIFY_LEFT);
-  gtk_misc_set_alignment (GTK_MISC (label3), 0, 0.5);
-
-  label4 = gtk_label_new (_(&quot;Extra check&quot;));
-  gtk_widget_show (label4);
-  gtk_table_attach (GTK_TABLE (table1), label4, 0, 1, 3, 4,
-                    (GtkAttachOptions) (GTK_EXPAND | GTK_FILL),
-                    (GtkAttachOptions) (0), 0, 0);
-  gtk_label_set_justify (GTK_LABEL (label4), GTK_JUSTIFY_LEFT);
-  gtk_misc_set_alignment (GTK_MISC (label4), 0, 0.5);
-
-  hbox1 = gtk_hbox_new (FALSE, 0);
-  gtk_widget_show (hbox1);
-  gtk_table_attach (GTK_TABLE (table1), hbox1, 1, 2, 0, 1,
-                    (GtkAttachOptions) (GTK_EXPAND | GTK_FILL),
-                    (GtkAttachOptions) (GTK_FILL), 0, 0);
-
-  radiobutton1 = gtk_radio_button_new_with_mnemonic (NULL, _(&quot;BFF&quot;));
-  gtk_widget_show (radiobutton1);
-  gtk_box_pack_start (GTK_BOX (hbox1), radiobutton1, FALSE, FALSE, 0);
-  gtk_radio_button_set_group (GTK_RADIO_BUTTON (radiobutton1), radiobutton1_group);
-  radiobutton1_group = gtk_radio_button_get_group (GTK_RADIO_BUTTON (radiobutton1));
-
-  radiobutton2 = gtk_radio_button_new_with_mnemonic (NULL, _(&quot;TFF&quot;));
-  gtk_widget_show (radiobutton2);
-  gtk_box_pack_start (GTK_BOX (hbox1), radiobutton2, FALSE, FALSE, 0);
-  gtk_radio_button_set_group (GTK_RADIO_BUTTON (radiobutton2), radiobutton1_group);
-  radiobutton1_group = gtk_radio_button_get_group (GTK_RADIO_BUTTON (radiobutton2));
-
-  optionmenu1 = gtk_option_menu_new ();
-  gtk_widget_show (optionmenu1);
-  gtk_table_attach (GTK_TABLE (table1), optionmenu1, 1, 2, 1, 2,
-                    (GtkAttachOptions) (GTK_FILL),
-                    (GtkAttachOptions) (0), 0, 0);
-
-  menu1 = gtk_menu_new ();
-
-  mode_0 = gtk_menu_item_new_with_mnemonic (_(&quot;Keep fps and frame #&quot;));
-  gtk_widget_show (mode_0);
-  gtk_container_add (GTK_CONTAINER (menu1), mode_0);
-
-  one = gtk_menu_item_new_with_mnemonic (_(&quot;Double fps and frame #&quot;));
-  gtk_widget_show (one);
-  gtk_container_add (GTK_CONTAINER (menu1), one);
-
-  double1 = gtk_menu_item_new_with_mnemonic (_(&quot;Double frame # (slow mo)&quot;));
-  gtk_widget_show (double1);
-  gtk_container_add (GTK_CONTAINER (menu1), double1);
-
-  gtk_option_menu_set_menu (GTK_OPTION_MENU (optionmenu1), menu1);
-
-  hscale1 = gtk_hscale_new (GTK_ADJUSTMENT (gtk_adjustment_new (12, 0, 255, 1, 1, 1)));
-  gtk_widget_show (hscale1);
-  gtk_table_attach (GTK_TABLE (table1), hscale1, 1, 2, 2, 3,
-                    (GtkAttachOptions) (GTK_FILL),
-                    (GtkAttachOptions) (GTK_FILL), 0, 0);
-
-  checkbutton1 = gtk_check_button_new_with_mnemonic (_(&quot;(avoid using it)&quot;));
-  gtk_widget_show (checkbutton1);
-  gtk_table_attach (GTK_TABLE (table1), checkbutton1, 1, 2, 3, 4,
-                    (GtkAttachOptions) (GTK_FILL),
-                    (GtkAttachOptions) (0), 0, 0);
-
-  dialog_action_area1 = GTK_DIALOG (dialog1)-&gt;action_area;
-  gtk_widget_show (dialog_action_area1);
-  gtk_button_box_set_layout (GTK_BUTTON_BOX (dialog_action_area1), GTK_BUTTONBOX_END);
-
-  cancelbutton1 = gtk_button_new_from_stock (&quot;gtk-cancel&quot;);
-  gtk_widget_show (cancelbutton1);
-  gtk_dialog_add_action_widget (GTK_DIALOG (dialog1), cancelbutton1, GTK_RESPONSE_CANCEL);
-  GTK_WIDGET_SET_FLAGS (cancelbutton1, GTK_CAN_DEFAULT);
-
-  okbutton1 = gtk_button_new_from_stock (&quot;gtk-ok&quot;);
-  gtk_widget_show (okbutton1);
-  gtk_dialog_add_action_widget (GTK_DIALOG (dialog1), okbutton1, GTK_RESPONSE_OK);
-  GTK_WIDGET_SET_FLAGS (okbutton1, GTK_CAN_DEFAULT);
-
-  /* Store pointers to all widgets, for use by lookup_widget(). */
-  GLADE_HOOKUP_OBJECT_NO_REF (dialog1, dialog1, &quot;dialog1&quot;);
-  GLADE_HOOKUP_OBJECT_NO_REF (dialog1, dialog_vbox1, &quot;dialog_vbox1&quot;);
-  GLADE_HOOKUP_OBJECT (dialog1, table1, &quot;table1&quot;);
-  GLADE_HOOKUP_OBJECT (dialog1, label1, &quot;label1&quot;);
-  GLADE_HOOKUP_OBJECT (dialog1, label2, &quot;label2&quot;);
-  GLADE_HOOKUP_OBJECT (dialog1, label3, &quot;label3&quot;);
-  GLADE_HOOKUP_OBJECT (dialog1, label4, &quot;label4&quot;);
-  GLADE_HOOKUP_OBJECT (dialog1, hbox1, &quot;hbox1&quot;);
-  GLADE_HOOKUP_OBJECT (dialog1, radiobutton1, &quot;radiobutton1&quot;);
-  GLADE_HOOKUP_OBJECT (dialog1, radiobutton2, &quot;radiobutton2&quot;);
-  GLADE_HOOKUP_OBJECT (dialog1, optionmenu1, &quot;optionmenu1&quot;);
-  GLADE_HOOKUP_OBJECT (dialog1, menu1, &quot;menu1&quot;);
-  GLADE_HOOKUP_OBJECT (dialog1, mode_0, &quot;mode_0&quot;);
-  GLADE_HOOKUP_OBJECT (dialog1, one, &quot;one&quot;);
-  GLADE_HOOKUP_OBJECT (dialog1, double1, &quot;double1&quot;);
-  GLADE_HOOKUP_OBJECT (dialog1, hscale1, &quot;hscale1&quot;);
-  GLADE_HOOKUP_OBJECT (dialog1, checkbutton1, &quot;checkbutton1&quot;);
-  GLADE_HOOKUP_OBJECT_NO_REF (dialog1, dialog_action_area1, &quot;dialog_action_area1&quot;);
-  GLADE_HOOKUP_OBJECT (dialog1, cancelbutton1, &quot;cancelbutton1&quot;);
-  GLADE_HOOKUP_OBJECT (dialog1, okbutton1, &quot;okbutton1&quot;);
-
-  return dialog1;
-}
-

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/Makefile.am
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/Makefile.am	2007-01-12 06:50:08 UTC (rev 2707)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/Makefile.am	2007-01-12 07:15:14 UTC (rev 2708)
@@ -18,7 +18,7 @@
 	DIA_dectel.cpp DIA_decimate.cpp DIA_pause.cpp \
 	DIA_DVDff.cpp DIA_lavdecoder.cpp DIA_lame.cpp DIA_calculator.cpp DIA_equalizer.cpp \
 	DIA_vobsub.cpp DIA_x264.cpp DIA_ocr.cpp  DIA_hue.cpp DIA_eq2.cpp \
-	DIA_dgbob.cpp DIA_asharp.cpp DIA_dmx.cpp DIA_idx_pg.cpp DIA_gototime.cpp \
+	DIA_asharp.cpp DIA_dmx.cpp DIA_idx_pg.cpp DIA_gototime.cpp \
 	DIA_audioTrack.cpp DIA_cnr2.cpp DIA_resizeWiz.cpp DIA_jobs.cpp DIA_jobs_save.cpp DIA_mosaic.cpp \
 	DIA_deblend.cpp DIA_v2v.cpp DIA_tdeint.cpp DIA_builtin.cpp DIA_mpdelogo.cpp DIA_vorbis.cpp \
         DIA_chromaShift.cpp \
@@ -52,7 +52,7 @@
 DIA_audioTrack.cpp   DIA_dectel.cpp        DIA_indexer.cpp      DIA_pipe.cpp        DIA_working.cpp \
 DIA_audiocodec.cpp   DIA_defaultAudio.cpp  DIA_jobs.cpp         DIA_postproc.cpp    DIA_working.h \
 DIA_jobs_save.cpp    DIA_prefs.cpp       DIA_x264.cpp \
-DIA_builtin.cpp      DIA_dgbob.cpp         DIA_preview.cpp     DIA_xvcd.cpp \
+DIA_builtin.cpp      DIA_preview.cpp     DIA_xvcd.cpp \
 DIA_busy.cpp         DIA_dmx.cpp           DIA_lame.cpp         DIA_properties.cpp  DIA_xvid.cpp \
 DIA_busy.h           DIA_lavcodec.cpp     DIA_quota.cpp       DIA_xvid4.cpp \
 DIA_calculator.cpp   DIA_encoding.cpp      DIA_lavdecoder.cpp   DIA_recent.cpp \

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_NONE/ADM_dialog/DIA_none.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_NONE/ADM_dialog/DIA_none.cpp	2007-01-12 06:50:08 UTC (rev 2707)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_NONE/ADM_dialog/DIA_none.cpp	2007-01-12 07:15:14 UTC (rev 2708)
@@ -42,7 +42,6 @@
 #include &quot;ADM_video/ADM_vidDecDec_param.h&quot;
 #include &quot;ADM_video/ADM_vidDecTel_param.h&quot;
 #include &quot;ADM_audiofilter/audioencoder_lame_param.h&quot;
-#include &quot;ADM_video/ADM_vidDGbob_param.h&quot;
 #include &quot;ADM_audiofilter/audioencoder_lame_param.h&quot;
 #include &quot;ADM_encoder/adm_encmjpeg_param.h&quot;
 #include &quot;ADM_video/ADM_vidMosaic_param.h&quot;
@@ -98,7 +97,6 @@
 uint8_t DIA_getASharp(ASHARP_PARAM *param, AVDMGenericVideoStream *in){return 0;}
 uint8_t DIA_getDecombDecimate(DECIMATE_PARAM *param){return 0;}
 uint8_t DIA_getDecombTelecide(TelecideParam *param){return 0;}
-uint8_t DIA_getDGbob(DGBobparam *param){return 0;}
 uint8_t DIA_getEQ2Param(Eq2_Param *param, AVDMGenericVideoStream *in){return 0;}
 uint8_t DIA_getEqualizer(EqualizerParam *param, ADMImage *image){return 0;}
 uint8_t DIA_getEqualizer(EqualizerParam *param, AVDMGenericVideoStream *in){return 0;}

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_none.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_none.cpp	2007-01-12 06:50:08 UTC (rev 2707)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_none.cpp	2007-01-12 07:15:14 UTC (rev 2708)
@@ -42,7 +42,6 @@
 #include &quot;ADM_video/ADM_vidDecDec_param.h&quot;
 #include &quot;ADM_video/ADM_vidDecTel_param.h&quot;
 #include &quot;ADM_audiofilter/audioencoder_lame_param.h&quot;
-#include &quot;ADM_video/ADM_vidDGbob_param.h&quot;
 #include &quot;ADM_audiofilter/audioencoder_lame_param.h&quot;
 #include &quot;ADM_encoder/adm_encmjpeg_param.h&quot;
 #include &quot;ADM_video/ADM_vidMosaic_param.h&quot;
@@ -98,7 +97,6 @@
 uint8_t DIA_getASharp(ASHARP_PARAM *param, AVDMGenericVideoStream *in){return 0;}
 uint8_t DIA_getDecombDecimate(DECIMATE_PARAM *param){return 0;}
 uint8_t DIA_getDecombTelecide(TelecideParam *param){return 0;}
-uint8_t DIA_getDGbob(DGBobparam *param){return 0;}
 uint8_t DIA_getEQ2Param(Eq2_Param *param, AVDMGenericVideoStream *in){return 0;}
 uint8_t DIA_getEqualizer(EqualizerParam *param, ADMImage *image){return 0;}
 uint8_t DIA_getEqualizer(EqualizerParam *param, AVDMGenericVideoStream *in){return 0;}

Deleted: branches/avidemux_2.4_branch/avidemux/ADM_video/ADM_vidDGbob.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_video/ADM_vidDGbob.cpp	2007-01-12 06:50:08 UTC (rev 2707)
+++ branches/avidemux_2.4_branch/avidemux/ADM_video/ADM_vidDGbob.cpp	2007-01-12 07:15:14 UTC (rev 2708)
@@ -1,538 +0,0 @@
-/*
-	DGBob() plugin for Avisynth -- Smart bob filter. This filter splits
-	each field of the source into its own frame and then adaptively
-	creates the missing lines either by interpolating the current field
-	or by using the previous field's data. The filter attempts with some
-	success to mitigate the flutter that bobbing produces.
-
-	Copyright (C) 2003 Donald A. Graft
-
-	This program is free software; you can redistribute it and/or modify
-	it under the terms of the GNU General Public License as published by
-	the Free Software Foundation.
-
-	This program is distributed in the hope that it will be useful,
-	but WITHOUT ANY WARRANTY; without even the implied warranty of
-	MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
-	GNU General Public License for more details.
-
-	You should have received a copy of the GNU General Public License
-	along with this program; if not, write to the Free Software
-	Foundation, Inc., 675 Mass Ave, Cambridge, MA 02139, USA.
-*/
-
-
-#include &quot;config.h&quot;
-#include &lt;stdio.h&gt;
-#include &lt;stdlib.h&gt;
-#include &lt;string.h&gt;
-#include &lt;ADM_assert.h&gt;
-
-#include &quot;config.h&quot;
-#include &quot;fourcc.h&quot;
-#include &quot;avio.hxx&quot;
-#include &quot;avi_vars.h&quot;
-
-#include &quot;ADM_toolkit/toolkit.hxx&quot;
-#include &quot;ADM_editor/ADM_edit.hxx&quot;
-#include &quot;ADM_video/ADM_genvideo.hxx&quot;
-#include&quot;ADM_video/ADM_vidField.h&quot;
-#include&quot;ADM_video/ADM_cache.h&quot;
-
-#include &quot;ADM_osSupport/ADM_debugID.h&quot;
-#define MODULE_NAME MODULE_FILTER
-#include &quot;ADM_osSupport/ADM_debug.h&quot;
-#include &quot;ADM_filter/video_filters.h&quot;
-
-#include &quot;ADM_vidDGbob_param.h&quot;
-class DGbob : public AVDMGenericVideoStream
-{
-       
-        DGBobparam      *_param;        
-        
-        VideoCache      *vidCache;
-       
-        void            update(void); 
-public:
-                                
-                        DGbob(AVDMGenericVideoStream *in,CONFcouple *couples);    
-                        ~DGbob(void);
-        uint8_t         getFrameNumberNoAlloc(uint32_t frame, uint32_t *len,
-                                ADMImage *data,uint32_t *flags);
-        
-        char            *printConf( void );
-        uint8_t         configure(AVDMGenericVideoStream *in);
-        uint8_t         getCoupledConf( CONFcouple **couples);
-};
-
-static FILTER_PARAM dgbobParam={4,{&quot;order&quot;,&quot;mode&quot;,&quot;thresh&quot;,&quot;ap&quot;}};
-
-BUILD_CREATE(dgbob_create,DGbob);
-SCRIPT_CREATE(dgbob_script,DGbob,dgbobParam);
-
-/*************************************/
-extern uint8_t DIA_getDGbob(DGBobparam *param);
-uint8_t DGbob::configure(AVDMGenericVideoStream *in)
-{
-        _in=in;
-        if(DIA_getDGbob(_param))
-        {        
-                update();
-                return 1;
-        }
-        return 0;
-        
-}
-
-char *DGbob::printConf( void )
-{
-        static char buf[50];
-
-        //ADM_assert(_param);
-        sprintf((char *)buf,&quot; DGBob mode:%d order:%d thresh:%d\n&quot;,_param-&gt;mode,_param-&gt;order,_param-&gt;thresh);
-        return buf;
-}
-
-
-DGbob::DGbob(AVDMGenericVideoStream *in,CONFcouple *couples)              
-
-{
-                
-                int count = 0;
-                char buf[80];
-                unsigned int *p;
-
-                _in=in;         
-                memcpy(&amp;_info,_in-&gt;getInfo(),sizeof(_info));    
-                _info.encoding=1;
-                _uncompressed=NULL;             
-                _info.encoding=1;
-                _info.fps1000*=2;
-                _info.nb_frames*=2;
-                
-                                
-                vidCache=new VideoCache(7,in);
-                _param= new DGBobparam;
-                if(couples)
-                {
-                        GET(order);
-                        GET(mode);
-                        GET(thresh);
-                        GET(ap);
-                }
-                else
-                {
-                        _param-&gt;order=1;
-                        _param-&gt;mode=0;
-                        _param-&gt;thresh=12;
-                        _param-&gt;ap=0;
-                }
-                update();
-}
-void DGbob::update(void)
-{
-                memcpy(&amp;_info,_in-&gt;getInfo(),sizeof(_info));    
-                _info.encoding=1;
-                switch(_param-&gt;mode)
-                {
-                        case 0:
-                                break;
-                        case 1:
-                                _info.fps1000*=2;
-                                _info.nb_frames*=2;
-                                break;
-                        case 2:
-                                _info.nb_frames*=2;
-                                break;
-                        default: ADM_assert(0);
-
-                }
-             
-}
-//________________________________________________________
-uint8_t DGbob::getCoupledConf( CONFcouple **couples)
-{
-        *couples=NULL;
-        *couples=new CONFcouple(4);
-#define CSET(x)  (*couples)-&gt;setCouple((char *)#x,(_param-&gt;x))
-        
-        CSET(order);
-        CSET(mode);
-        CSET(thresh);
-        CSET(ap);
-
-        return 1;
-}
-//________________________________________________________
-DGbob::~DGbob(void)
-{
-                
-                if(vidCache) delete vidCache;                
-                vidCache=NULL;   
-                if(_param) delete _param;
-                _param=NULL;                             
-}
-uint8_t DGbob::getFrameNumberNoAlloc(uint32_t frame, uint32_t *len,
-                                ADMImage *data,uint32_t *flags)
-{
-        ADMImage *src,*prv,*prvprv,*nxt,*nxtnxt,*dst;
-	uint32_t n,num_frames;
-
-        num_frames=_in-&gt;getInfo()-&gt;nb_frames;   // ??
-
-	if (_param-&gt;mode == 0) n = frame;
-	else n = frame/2;
-
-        src=vidCache-&gt;getImage(n);
-        prv=vidCache-&gt;getImage(n &gt; 0 ? n - 1 :0 );
-        prvprv=vidCache-&gt;getImage(n &gt; 1 ? n - 2 : 0);
-        nxt=vidCache-&gt;getImage(n &lt; num_frames - 1 ? n + 1 : num_frames - 1);
-        nxtnxt=vidCache-&gt;getImage(n &lt; num_frames - 2 ? n + 2 : num_frames - 1);
-
-
-/*
-	PVideoFrame src = child-&gt;GetFrame(n, env);
-	PVideoFrame prv = child-&gt;GetFrame(n &gt; 0 ? n - 1 : 0, env);
-	PVideoFrame prvprv = child-&gt;GetFrame(n &gt; 1 ? n - 2 : 0, env);
-	PVideoFrame nxt = child-&gt;GetFrame(n &lt; vi.num_frames - 1 ? n + 1 : vi.num_frames - 1, env);
-	PVideoFrame nxtnxt = child-&gt;GetFrame(n &lt; vi.num_frames - 2 ? n + 2 : vi.num_frames - 1, env);
-    PVideoFrame dst = env-&gt;NewVideoFrame(vi);
-*/
-    const unsigned char *srcp, *srcp_saved, *srcpp, *srcpn;
-	const unsigned char *prvp, *prvpp, *prvpn, *prvprvp, *prvprvpp, *prvprvpn;
-	const unsigned char *nxtp, *nxtpp, *nxtpn, *nxtnxtp, *nxtnxtpp, *nxtnxtpn;
-    unsigned char *dstp, *dstp_saved;
- 
-    int src_pitch, dst_pitch, w, h;
-	int x, y, z, v1, v2, D = _param-&gt;thresh, T = 6, AP = 30;
-	int plane;
-
-        uint32_t ww,hh;
-	// Try making D a function of the average value of the comparands in
-	// order to make the margin larger in darker areas, where we can't see as
-	// much combing.
-
-	// Force deinterlacing of the first and last frames.
-	if (n == 0 || n == num_frames - 1) D = 0;
-        dst=data;
-	for (z = 0; z &lt; 3; z++)
-	{
-/*
-		if (z == 0) plane = PLANAR_Y;
-		else if (z == 1) plane = PLANAR_U;
-		else plane = PLANAR_V;
-
-*/
-                switch(z)
-                {
-                        case 0:
-                                ww=_info.width;
-                                hh=_info.height;
-                                srcp_saved = srcp = YPLANE(src);                                
-                                dstp_saved = dstp = YPLANE(dst);
-                                src_pitch = ww;
-                                dst_pitch = ww;
-                                w = ww;
-                                h = hh;
-                                break;
-                        case 1:
-                        case 2:
-                                ww=_info.width&gt;&gt;1;
-                                hh=_info.height&gt;&gt;1;
-                                if(z==1)
-                                {
-                                        srcp_saved = srcp = UPLANE(src);
-                                        dstp_saved = dstp = UPLANE(dst);
-                                }
-                                else
-                                {
-                                        srcp_saved = srcp = VPLANE(src);
-                                        dstp_saved = dstp = VPLANE(dst);
-                                }
-                                src_pitch = ww;
-                                dst_pitch = ww;
-                                w = ww;
-                                h = hh;
-                                break;
-                }
-/*
-		srcp_saved = srcp = src-&gt;GetReadPtr(plane);
-		src_pitch = src-&gt;GetPitch(plane);
-		dstp_saved = dstp = dst-&gt;GetWritePtr(plane);
-		dst_pitch = dst-&gt;GetPitch(plane);
-		w = dst-&gt;GetRowSize(plane);
-		h = dst-&gt;GetHeight(plane);
-*/
-		if ((_param-&gt;mode &gt; 0) &amp;&amp; (frame &amp; 1))
-		{
-			// Process odd-numbered frames.
-			// Copy field from current frame.
-			srcp = srcp_saved +_param-&gt;order * src_pitch;
-			dstp = dstp_saved +_param-&gt;order * dst_pitch;
-			for (y = 0; y &lt; h; y+=2)
-			{
-				memcpy(dstp, srcp, w);
-				srcp += 2*src_pitch;
-				dstp += 2*dst_pitch;
-			}
-			// Copy through the line that will be missed below.
-			memcpy(dstp_saved + (1-_param-&gt;order)*(h-1)*dst_pitch, srcp_saved + (1-_param-&gt;order)*(h-1)*src_pitch, w);
-			/* For the other field choose adaptively between using the previous field
-			   or the interpolant from the current field. */
-                        
-			//prvp = prv-&gt;GetReadPtr(plane) + src_pitch + order*src_pitch;
-                        switch(z)
-                        {
-                                case 0:prvp = YPLANE(prv) + src_pitch + _param-&gt;order*src_pitch;break;
-                                case 1:prvp = UPLANE(prv) + src_pitch + _param-&gt;order*src_pitch;break;
-                                case 2:prvp = VPLANE(prv) + src_pitch + _param-&gt;order*src_pitch;break;
-                        }
-			prvpp = prvp - src_pitch;
-			prvpn = prvp + src_pitch;
-			//prvprvp = prvprv-&gt;GetReadPtr(plane) + src_pitch + order*src_pitch;
-                         switch(z)
-                        {
-                                case 0:prvprvp = YPLANE(prvprv) + src_pitch + _param-&gt;order*src_pitch;break;
-                                case 1:prvprvp = UPLANE(prvprv) + src_pitch + _param-&gt;order*src_pitch;break;
-                                case 2:prvprvp = VPLANE(prvprv) + src_pitch + _param-&gt;order*src_pitch;break;
-                        }
-
-			prvprvpp = prvprvp - src_pitch;
-			prvprvpn = prvprvp + src_pitch;
-
-			//nxtp = nxt-&gt;GetReadPtr(plane) + src_pitch + order*src_pitch;
-                        switch(z)
-                        {
-                                case 0:nxtp = YPLANE(nxt) + src_pitch + _param-&gt;order*src_pitch;break;
-                                case 1:nxtp = UPLANE(nxt) + src_pitch + _param-&gt;order*src_pitch;break;
-                                case 2:nxtp = VPLANE(nxt) + src_pitch + _param-&gt;order*src_pitch;break;
-                        }
-
-			nxtpp = nxtp - src_pitch;
-			nxtpn = nxtp + src_pitch;
-			//nxtnxtp = nxtnxt-&gt;GetReadPtr(plane) + src_pitch + order*src_pitch;
-                        switch(z)
-                        {
-                                case 0:nxtnxtp = YPLANE(nxtnxt) + src_pitch + _param-&gt;order*src_pitch;break;
-                                case 1:nxtnxtp = UPLANE(nxtnxt) + src_pitch + _param-&gt;order*src_pitch;break;
-                                case 2:nxtnxtp = VPLANE(nxtnxt) + src_pitch + _param-&gt;order*src_pitch;break;
-                        }
-			nxtnxtpp = nxtnxtp - src_pitch;
-			nxtnxtpn = nxtnxtp + src_pitch;
-			srcp =  srcp_saved + src_pitch + _param-&gt;order*src_pitch;
-			srcpp = srcp - src_pitch;
-			srcpn = srcp + src_pitch;
-			dstp =  dstp_saved + dst_pitch + _param-&gt;order*dst_pitch;
-			for (y = 0; y &lt; h - 2; y+=2)
-			{
-				for (x = 0; x &lt; w; x++)
-				{
-					if (
-						abs(srcp[x] - nxtp[x]) &lt; D
-//						&amp;&amp; abs(srcp[x] - nxtnxtp[x]) &lt; D
-//						&amp;&amp; abs(prvp[x] - nxtp[x]) &lt; D
-						&amp;&amp; abs(srcpn[x] - prvprvpn[x]) &lt; D
-						&amp;&amp; abs(srcpp[x] - prvprvpp[x]) &lt; D
-						&amp;&amp; abs(srcpn[x] - nxtnxtpn[x]) &lt; D
-						&amp;&amp; abs(srcpp[x] - nxtnxtpp[x]) &lt; D
-						&amp;&amp; abs(srcpn[x] - prvpn[x]) &lt; D
-						&amp;&amp; abs(srcpp[x] - prvpp[x]) &lt; D
-						&amp;&amp; abs(srcpn[x] - nxtpn[x]) &lt; D
-						&amp;&amp; abs(srcpp[x] - nxtpp[x]) &lt; D
-					   )
-					{
-						if (_param-&gt;ap == true)
-						{
-							v1 = (int) srcp[x] - AP;
-							if (v1 &lt; 0) v1 = 0; 
-							v2 = (int) srcp[x] + AP;
-							if (v2 &gt; 235) v2 = 235; 
-							if ((v1 &gt; srcpp[x] &amp;&amp; v1 &gt; srcpn[x]) || (v2 &lt; srcpp[x] &amp;&amp; v2 &lt; srcpn[x]))
-							{
-								dstp[x] = ((int)srcpp[x] + srcpn[x]) &gt;&gt; 1;
-//								if (x &amp; 1) dstp[x] = 100; else dstp[x] = 235;
-							}
-							else
-							{
-								dstp[x] = srcp[x];
-//								if (x &amp; 1) dstp[x] = 100; else dstp[x] = 235;
-							}
-						}
-						else
-						{
-							dstp[x] = srcp[x];
-//							if (x &amp; 1) dstp[x] = 100; else dstp[x] = 235;
-						}
-					}
-					else
-					{
-						v1 = (int) srcp[x] - T;
-						if (v1 &lt; 0) v1 = 0; 
-						v2 = (int) srcp[x] + T;
-						if (v2 &gt; 235) v2 = 235; 
-						if ((v1 &gt; srcpp[x] &amp;&amp; v1 &gt; srcpn[x]) || (v2 &lt; srcpp[x] &amp;&amp; v2 &lt; srcpn[x]))
-						{
-							dstp[x] = ((int)srcpp[x] + srcpn[x]) &gt;&gt; 1;
-						}
-						else
-						{
-							dstp[x] = srcp[x];
-//							if (x &amp; 1) dstp[x] = 128; else dstp[x] = 235;
-						}
-					}
-				}
-				prvp    += 2*src_pitch;
-				prvpp    += 2*src_pitch;
-				prvpn    += 2*src_pitch;
-				prvprvpp    += 2*src_pitch;
-				prvprvpn    += 2*src_pitch;
-				nxtp    += 2*src_pitch;
-				nxtpp    += 2*src_pitch;
-				nxtpn    += 2*src_pitch;
-				nxtnxtpp    += 2*src_pitch;
-				nxtnxtpn    += 2*src_pitch;
-				srcp    += 2*src_pitch;
-				srcpp   += 2*src_pitch;
-				srcpn   += 2*src_pitch;
-				dstp    += 2*dst_pitch;
-			}
-		}
-		else
-		{
-			// Process even-numbered frames.
-			// Copy field from current frame.
-			srcp = srcp_saved + (1-_param-&gt;order) * src_pitch;
-			dstp = dstp_saved + (1-_param-&gt;order) * dst_pitch;
-			for (y = 0; y &lt; h; y+=2)
-			{
-				memcpy(dstp, srcp, w);
-				srcp += 2*src_pitch;
-				dstp += 2*dst_pitch;
-			}
-			// Copy through the line that will be missed below.
-			memcpy(dstp_saved + _param-&gt;order*(h-1)*dst_pitch, srcp_saved + _param-&gt;order*(h-1)*src_pitch, w);
-			/* For the other field choose adaptively between using the previous field
-			   or the interpolant from the current field. */
-			//prvp = prv-&gt;GetReadPtr(plane) + src_pitch + (1-order)*src_pitch;
-                        switch(z)
-                        {
-                                case 0:prvp = YPLANE(prv) + src_pitch + (1-_param-&gt;order)*src_pitch;break;
-                                case 1:prvp = UPLANE(prv) + src_pitch + (1-_param-&gt;order)*src_pitch;break;
-                                case 2:prvp = VPLANE(prv) + src_pitch + (1-_param-&gt;order)*src_pitch;break;
-                        }
-			prvpp = prvp - src_pitch;
-			prvpn = prvp + src_pitch;
-			// prvprvp = prvprv-&gt;GetReadPtr(plane) + src_pitch + (1-order)*src_pitch;
-                        switch(z)
-                        {
-                                case 0:prvprvp = YPLANE(prvprv) + src_pitch + (1-_param-&gt;order)*src_pitch;break;
-                                case 1:prvprvp = UPLANE(prvprv) + src_pitch + (1-_param-&gt;order)*src_pitch;break;
-                                case 2:prvprvp = VPLANE(prvprv) + src_pitch + (1-_param-&gt;order)*src_pitch;break;
-                        }
-                        
-			prvprvpp = prvprvp - src_pitch;
-			prvprvpn = prvprvp + src_pitch;
-			//nxtp = nxt-&gt;GetReadPtr(plane) + src_pitch + (1-order)*src_pitch;
-                        switch(z)
-                        {
-                                case 0:nxtp = YPLANE(nxt) + src_pitch + (1-_param-&gt;order)*src_pitch;break;
-                                case 1:nxtp = UPLANE(nxt) + src_pitch + (1-_param-&gt;order)*src_pitch;break;
-                                case 2:nxtp = VPLANE(nxt) + src_pitch + (1-_param-&gt;order)*src_pitch;break;
-                        }
-			nxtpp = nxtp - src_pitch;
-			nxtpn = nxtp + src_pitch;
-			//nxtnxtp = nxtnxt-&gt;GetReadPtr(plane) + src_pitch + (1-order)*src_pitch;
-                         switch(z)
-                        {
-                                case 0:nxtnxtp = YPLANE(nxtnxt) + src_pitch + (1-_param-&gt;order)*src_pitch;break;
-                                case 1:nxtnxtp = UPLANE(nxtnxt) + src_pitch + (1-_param-&gt;order)*src_pitch;break;
-                                case 2:nxtnxtp = VPLANE(nxtnxt) + src_pitch + (1-_param-&gt;order)*src_pitch;break;
-                        }
-			nxtnxtpp = nxtnxtp - src_pitch;
-			nxtnxtpn = nxtnxtp + src_pitch;
-			srcp =  srcp_saved + src_pitch + (1-_param-&gt;order)*src_pitch;
-			srcpp = srcp - src_pitch;
-			srcpn = srcp + src_pitch;
-			dstp =  dstp_saved + dst_pitch + (1-_param-&gt;order)*dst_pitch;
-			for (y = 0; y &lt; h - 2; y+=2)
-			{
-				for (x = 0; x &lt; w; x++)
-				{
-					if (
-						abs(srcp[x] - prvp[x]) &lt; D
-//						&amp;&amp; abs(srcp[x] - prvprvp[x]) &lt; D
-//						&amp;&amp; abs(prvp[x] - nxtp[x]) &lt; D
-						&amp;&amp; abs(srcpn[x] - prvprvpn[x]) &lt; D
-						&amp;&amp; abs(srcpp[x] - prvprvpp[x]) &lt; D
-						&amp;&amp; abs(srcpn[x] - nxtnxtpn[x]) &lt; D
-						&amp;&amp; abs(srcpp[x] - nxtnxtpp[x]) &lt; D
-						&amp;&amp; abs(srcpn[x] - prvpn[x]) &lt; D
-						&amp;&amp; abs(srcpp[x] - prvpp[x]) &lt; D
-						&amp;&amp; abs(srcpn[x] - nxtpn[x]) &lt; D
-						&amp;&amp; abs(srcpp[x] - nxtpp[x]) &lt; D
-					   )
-					{
-						if (_param-&gt;ap == true)
-						{
-							v1 = (int) prvp[x] - AP;
-							if (v1 &lt; 0) v1 = 0; 
-							v2 = (int) prvp[x] + AP;
-							if (v2 &gt; 235) v2 = 235; 
-							if ((v1 &gt; srcpp[x] &amp;&amp; v1 &gt; srcpn[x]) ||	(v2 &lt; srcpp[x] &amp;&amp; v2 &lt; srcpn[x]))
-							{
-								dstp[x] = ((int)srcpp[x] + srcpn[x]) &gt;&gt; 1;
-//								if (x &amp; 1) dstp[x] = 100; else dstp[x] = 235;
-							}
-							else
-							{
-								dstp[x] = prvp[x];
-//								if (x &amp; 1) dstp[x] = 128; else dstp[x] = 235;
-							}
-						}
-						else
-						{
-							dstp[x] = prvp[x];
-//							if (x &amp; 1) dstp[x] = 128; else dstp[x] = 235;
-						}
-					}
-					else
-					{
-						v1 = (int) prvp[x] - T;
-						if (v1 &lt; 0) v1 = 0; 
-						v2 = (int) prvp[x] + T;
-						if (v2 &gt; 235) v2 = 235; 
-						if ((v1 &gt; srcpp[x] &amp;&amp; v1 &gt; srcpn[x]) ||	(v2 &lt; srcpp[x] &amp;&amp; v2 &lt; srcpn[x]))
-						{
-							dstp[x] = ((int)srcpp[x] + srcpn[x]) &gt;&gt; 1;
-						}
-						else
-						{
-							dstp[x] = prvp[x];
-//							if (x &amp; 1) pp[x] = 128; else dstp[x] = 235;
-						}
-					}
-				}
-				prvp    += 2*src_pitch;
-				prvpp    += 2*src_pitch;
-				prvpn    += 2*src_pitch;
-				prvprvpp    += 2*src_pitch;
-				prvprvpn    += 2*src_pitch;
-				nxtp    += 2*src_pitch;
-				nxtpp    += 2*src_pitch;
-				nxtpn    += 2*src_pitch;
-				nxtnxtpp    += 2*src_pitch;
-				nxtnxtpn    += 2*src_pitch;
-				srcp    += 2*src_pitch;
-				srcpp   += 2*src_pitch;
-				srcpn   += 2*src_pitch;
-				dstp    += 2*dst_pitch;
-			}
-		}
-	}
-        vidCache-&gt;unlockAll();
-	return 1;
-}
-//EOF
-
-
-

Deleted: branches/avidemux_2.4_branch/avidemux/ADM_video/ADM_vidDGbob_param.h
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_video/ADM_vidDGbob_param.h	2007-01-12 06:50:08 UTC (rev 2707)
+++ branches/avidemux_2.4_branch/avidemux/ADM_video/ADM_vidDGbob_param.h	2007-01-12 07:15:14 UTC (rev 2708)
@@ -1,12 +0,0 @@
-
-#ifndef DGBOB_PARAM
-#define DGBOB_PARAM
-typedef struct DGBobparam
-{
-        uint32_t  thresh;// low=more flickering, less jaggie
-        uint32_t  order; //0 : Bottom field first, 1 top field first        
-        uint32_t  mode;  // 0 keep # of frames, 1 *2 fps &amp; *2 frame, 2  #*2, fps*150% slow motion
-        uint32_t  ap;    // Extra artifact check, better not to use
-}DGBobparam;
-
-#endif

Modified: branches/avidemux_2.4_branch/avidemux/ADM_video/Makefile.am
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_video/Makefile.am	2007-01-12 06:50:08 UTC (rev 2707)
+++ branches/avidemux_2.4_branch/avidemux/ADM_video/Makefile.am	2007-01-12 07:15:14 UTC (rev 2708)
@@ -67,7 +67,6 @@
  ADM_vidVobSubRender.cpp \
  ADM_vidHue.cpp \
  ADM_vidEq2.cpp \
- ADM_vidDGbob.cpp \
  ADM_vidAsharp.cpp \
  ADM_vidCNR2.cpp \
   ADM_vidDelta.cpp \
@@ -140,8 +139,7 @@
 ADM_vidConvolution.cpp  ADM_vidlavdeint.h \
 ADM_vidConvolution.hxx  ADM_vobsubinfo.cpp \
 ADM_vidCrop.cpp  ADM_vidMSmooth_param.h  ADM_vobsubinfo.h \
-ADM_vidDGbob.cpp ASM_vidDenoise.cpp \
-ADM_vidDGbob_param.h   \
+ASM_vidDenoise.cpp \
 ADM_vidDecDec.cpp  ADM_vidMosaic.cpp swscale_internal.h \
 ADM_vidTdeint_util.txt ADM_vidASS.h ADM_vidASS.cpp \
 ADM_vidAss_Params.h mmx_macros.h

Copied: branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/ADM_vidDGbob.cpp (from rev 2489, branches/avidemux_2.4_branch/avidemux/ADM_video/ADM_vidDGbob.cpp)
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_video/ADM_vidDGbob.cpp	2006-10-31 15:59:58 UTC (rev 2489)
+++ branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/ADM_vidDGbob.cpp	2007-01-12 07:15:14 UTC (rev 2708)
@@ -0,0 +1,558 @@
+/*
+	DGBob() plugin for Avisynth -- Smart bob filter. This filter splits
+	each field of the source into its own frame and then adaptively
+	creates the missing lines either by interpolating the current field
+	or by using the previous field's data. The filter attempts with some
+	success to mitigate the flutter that bobbing produces.
+
+	Copyright (C) 2003 Donald A. Graft
+
+	This program is free software; you can redistribute it and/or modify
+	it under the terms of the GNU General Public License as published by
+	the Free Software Foundation.
+
+	This program is distributed in the hope that it will be useful,
+	but WITHOUT ANY WARRANTY; without even the implied warranty of
+	MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+	GNU General Public License for more details.
+
+	You should have received a copy of the GNU General Public License
+	along with this program; if not, write to the Free Software
+	Foundation, Inc., 675 Mass Ave, Cambridge, MA 02139, USA.
+*/
+
+
+#include &quot;config.h&quot;
+#include &lt;stdio.h&gt;
+#include &lt;stdlib.h&gt;
+#include &lt;string.h&gt;
+#include &lt;ADM_assert.h&gt;
+
+#include &quot;config.h&quot;
+#include &quot;fourcc.h&quot;
+#include &quot;avio.hxx&quot;
+#include &quot;avi_vars.h&quot;
+
+#include &quot;ADM_toolkit/toolkit.hxx&quot;
+#include &quot;ADM_editor/ADM_edit.hxx&quot;
+#include &quot;ADM_video/ADM_genvideo.hxx&quot;
+#include&quot;ADM_video/ADM_vidField.h&quot;
+#include&quot;ADM_video/ADM_cache.h&quot;
+
+#include &quot;ADM_osSupport/ADM_debugID.h&quot;
+#define MODULE_NAME MODULE_FILTER
+#include &quot;ADM_osSupport/ADM_debug.h&quot;
+#include &quot;ADM_filter/video_filters.h&quot;
+
+#include &quot;ADM_vidDGbob_param.h&quot;
+
+#include &quot;ADM_userInterfaces/ADM_commonUI/DIA_factory.h&quot;
+
+class DGbob : public AVDMGenericVideoStream
+{
+       
+        DGBobparam      *_param;        
+        
+        VideoCache      *vidCache;
+       
+        void            update(void); 
+public:
+                                
+                        DGbob(AVDMGenericVideoStream *in,CONFcouple *couples);    
+                        ~DGbob(void);
+        uint8_t         getFrameNumberNoAlloc(uint32_t frame, uint32_t *len,
+                                ADMImage *data,uint32_t *flags);
+        
+        char            *printConf( void );
+        uint8_t         configure(AVDMGenericVideoStream *in);
+        uint8_t         getCoupledConf( CONFcouple **couples);
+};
+
+static FILTER_PARAM dgbobParam={4,{&quot;order&quot;,&quot;mode&quot;,&quot;thresh&quot;,&quot;ap&quot;}};
+
+BUILD_CREATE(dgbob_create,DGbob);
+SCRIPT_CREATE(dgbob_script,DGbob,dgbobParam);
+
+/*************************************/
+extern uint8_t DIA_getDGbob(DGBobparam *param);
+uint8_t DGbob::configure(AVDMGenericVideoStream *in)
+{
+        _in=in;
+#define PX(x) &amp;(_param-&gt;x)
+  
+     diaMenuEntry menuField[2]={{0,_(&quot;Top&quot;),NULL},
+                             {1,_(&quot;Bottom&quot;),NULL}
+                          };
+  
+     diaMenuEntry menuMode[3]={{0,_(&quot;Keep nb of frames and FPS&quot;),NULL},
+                            {1,_(&quot;Double nb of frames and FPS&quot;),NULL},
+                            {2,_(&quot;Double nb of frames (slow motion)&quot;),NULL}
+                          };
+                          
+    diaElemMenu     menu1(PX(order),_(&quot;Field Order&quot;), 2,menuField);
+    diaElemMenu     menu2(PX(mode),_(&quot;Mode&quot;), 3,menuMode);
+    diaElemUInteger threshold(PX(thresh),_(&quot;Threshold&quot;),0,255);
+    diaElemToggle  extra(PX(ap),_(&quot;Extra&quot;),_(&quot;Extra check, avoid using it&quot;));
+    
+      diaElem *elems[4]={&amp;menu1,&amp;menu2,&amp;threshold ,&amp;extra};
+   if(diaFactoryRun(&quot;DGBob&quot;,4,elems))
+  {
+                update();
+                return 1;
+        }
+        return 0;
+        
+}
+
+char *DGbob::printConf( void )
+{
+        static char buf[50];
+
+        //ADM_assert(_param);
+        sprintf((char *)buf,&quot; DGBob mode:%d order:%d thresh:%d\n&quot;,_param-&gt;mode,_param-&gt;order,_param-&gt;thresh);
+        return buf;
+}
+
+
+DGbob::DGbob(AVDMGenericVideoStream *in,CONFcouple *couples)              
+
+{
+                
+                int count = 0;
+                char buf[80];
+                unsigned int *p;
+
+                _in=in;         
+                memcpy(&amp;_info,_in-&gt;getInfo(),sizeof(_info));    
+                _info.encoding=1;
+                _uncompressed=NULL;             
+                _info.encoding=1;
+                _info.fps1000*=2;
+                _info.nb_frames*=2;
+                
+                                
+                vidCache=new VideoCache(7,in);
+                _param= new DGBobparam;
+                if(couples)
+                {
+                        GET(order);
+                        GET(mode);
+                        GET(thresh);
+                        GET(ap);
+                }
+                else
+                {
+                        _param-&gt;order=1;
+                        _param-&gt;mode=0;
+                        _param-&gt;thresh=12;
+                        _param-&gt;ap=0;
+                }
+                update();
+}
+void DGbob::update(void)
+{
+                memcpy(&amp;_info,_in-&gt;getInfo(),sizeof(_info));    
+                _info.encoding=1;
+                switch(_param-&gt;mode)
+                {
+                        case 0:
+                                break;
+                        case 1:
+                                _info.fps1000*=2;
+                                _info.nb_frames*=2;
+                                break;
+                        case 2:
+                                _info.nb_frames*=2;
+                                break;
+                        default: ADM_assert(0);
+
+                }
+             
+}
+//________________________________________________________
+uint8_t DGbob::getCoupledConf( CONFcouple **couples)
+{
+        *couples=NULL;
+        *couples=new CONFcouple(4);
+#define CSET(x)  (*couples)-&gt;setCouple((char *)#x,(_param-&gt;x))
+        
+        CSET(order);
+        CSET(mode);
+        CSET(thresh);
+        CSET(ap);
+
+        return 1;
+}
+//________________________________________________________
+DGbob::~DGbob(void)
+{
+                
+                if(vidCache) delete vidCache;                
+                vidCache=NULL;   
+                if(_param) delete _param;
+                _param=NULL;                             
+}
+uint8_t DGbob::getFrameNumberNoAlloc(uint32_t frame, uint32_t *len,
+                                ADMImage *data,uint32_t *flags)
+{
+        ADMImage *src,*prv,*prvprv,*nxt,*nxtnxt,*dst;
+	uint32_t n,num_frames;
+
+        num_frames=_in-&gt;getInfo()-&gt;nb_frames;   // ??
+
+	if (_param-&gt;mode == 0) n = frame;
+	else n = frame/2;
+
+        src=vidCache-&gt;getImage(n);
+        prv=vidCache-&gt;getImage(n &gt; 0 ? n - 1 :0 );
+        prvprv=vidCache-&gt;getImage(n &gt; 1 ? n - 2 : 0);
+        nxt=vidCache-&gt;getImage(n &lt; num_frames - 1 ? n + 1 : num_frames - 1);
+        nxtnxt=vidCache-&gt;getImage(n &lt; num_frames - 2 ? n + 2 : num_frames - 1);
+
+
+/*
+	PVideoFrame src = child-&gt;GetFrame(n, env);
+	PVideoFrame prv = child-&gt;GetFrame(n &gt; 0 ? n - 1 : 0, env);
+	PVideoFrame prvprv = child-&gt;GetFrame(n &gt; 1 ? n - 2 : 0, env);
+	PVideoFrame nxt = child-&gt;GetFrame(n &lt; vi.num_frames - 1 ? n + 1 : vi.num_frames - 1, env);
+	PVideoFrame nxtnxt = child-&gt;GetFrame(n &lt; vi.num_frames - 2 ? n + 2 : vi.num_frames - 1, env);
+    PVideoFrame dst = env-&gt;NewVideoFrame(vi);
+*/
+    const unsigned char *srcp, *srcp_saved, *srcpp, *srcpn;
+	const unsigned char *prvp, *prvpp, *prvpn, *prvprvp, *prvprvpp, *prvprvpn;
+	const unsigned char *nxtp, *nxtpp, *nxtpn, *nxtnxtp, *nxtnxtpp, *nxtnxtpn;
+    unsigned char *dstp, *dstp_saved;
+ 
+    int src_pitch, dst_pitch, w, h;
+	int x, y, z, v1, v2, D = _param-&gt;thresh, T = 6, AP = 30;
+	int plane;
+
+        uint32_t ww,hh;
+	// Try making D a function of the average value of the comparands in
+	// order to make the margin larger in darker areas, where we can't see as
+	// much combing.
+
+	// Force deinterlacing of the first and last frames.
+	if (n == 0 || n == num_frames - 1) D = 0;
+        dst=data;
+	for (z = 0; z &lt; 3; z++)
+	{
+/*
+		if (z == 0) plane = PLANAR_Y;
+		else if (z == 1) plane = PLANAR_U;
+		else plane = PLANAR_V;
+
+*/
+                switch(z)
+                {
+                        case 0:
+                                ww=_info.width;
+                                hh=_info.height;
+                                srcp_saved = srcp = YPLANE(src);                                
+                                dstp_saved = dstp = YPLANE(dst);
+                                src_pitch = ww;
+                                dst_pitch = ww;
+                                w = ww;
+                                h = hh;
+                                break;
+                        case 1:
+                        case 2:
+                                ww=_info.width&gt;&gt;1;
+                                hh=_info.height&gt;&gt;1;
+                                if(z==1)
+                                {
+                                        srcp_saved = srcp = UPLANE(src);
+                                        dstp_saved = dstp = UPLANE(dst);
+                                }
+                                else
+                                {
+                                        srcp_saved = srcp = VPLANE(src);
+                                        dstp_saved = dstp = VPLANE(dst);
+                                }
+                                src_pitch = ww;
+                                dst_pitch = ww;
+                                w = ww;
+                                h = hh;
+                                break;
+                }
+/*
+		srcp_saved = srcp = src-&gt;GetReadPtr(plane);
+		src_pitch = src-&gt;GetPitch(plane);
+		dstp_saved = dstp = dst-&gt;GetWritePtr(plane);
+		dst_pitch = dst-&gt;GetPitch(plane);
+		w = dst-&gt;GetRowSize(plane);
+		h = dst-&gt;GetHeight(plane);
+*/
+		if ((_param-&gt;mode &gt; 0) &amp;&amp; (frame &amp; 1))
+		{
+			// Process odd-numbered frames.
+			// Copy field from current frame.
+			srcp = srcp_saved +_param-&gt;order * src_pitch;
+			dstp = dstp_saved +_param-&gt;order * dst_pitch;
+			for (y = 0; y &lt; h; y+=2)
+			{
+				memcpy(dstp, srcp, w);
+				srcp += 2*src_pitch;
+				dstp += 2*dst_pitch;
+			}
+			// Copy through the line that will be missed below.
+			memcpy(dstp_saved + (1-_param-&gt;order)*(h-1)*dst_pitch, srcp_saved + (1-_param-&gt;order)*(h-1)*src_pitch, w);
+			/* For the other field choose adaptively between using the previous field
+			   or the interpolant from the current field. */
+                        
+			//prvp = prv-&gt;GetReadPtr(plane) + src_pitch + order*src_pitch;
+                        switch(z)
+                        {
+                                case 0:prvp = YPLANE(prv) + src_pitch + _param-&gt;order*src_pitch;break;
+                                case 1:prvp = UPLANE(prv) + src_pitch + _param-&gt;order*src_pitch;break;
+                                case 2:prvp = VPLANE(prv) + src_pitch + _param-&gt;order*src_pitch;break;
+                        }
+			prvpp = prvp - src_pitch;
+			prvpn = prvp + src_pitch;
+			//prvprvp = prvprv-&gt;GetReadPtr(plane) + src_pitch + order*src_pitch;
+                         switch(z)
+                        {
+                                case 0:prvprvp = YPLANE(prvprv) + src_pitch + _param-&gt;order*src_pitch;break;
+                                case 1:prvprvp = UPLANE(prvprv) + src_pitch + _param-&gt;order*src_pitch;break;
+                                case 2:prvprvp = VPLANE(prvprv) + src_pitch + _param-&gt;order*src_pitch;break;
+                        }
+
+			prvprvpp = prvprvp - src_pitch;
+			prvprvpn = prvprvp + src_pitch;
+
+			//nxtp = nxt-&gt;GetReadPtr(plane) + src_pitch + order*src_pitch;
+                        switch(z)
+                        {
+                                case 0:nxtp = YPLANE(nxt) + src_pitch + _param-&gt;order*src_pitch;break;
+                                case 1:nxtp = UPLANE(nxt) + src_pitch + _param-&gt;order*src_pitch;break;
+                                case 2:nxtp = VPLANE(nxt) + src_pitch + _param-&gt;order*src_pitch;break;
+                        }
+
+			nxtpp = nxtp - src_pitch;
+			nxtpn = nxtp + src_pitch;
+			//nxtnxtp = nxtnxt-&gt;GetReadPtr(plane) + src_pitch + order*src_pitch;
+                        switch(z)
+                        {
+                                case 0:nxtnxtp = YPLANE(nxtnxt) + src_pitch + _param-&gt;order*src_pitch;break;
+                                case 1:nxtnxtp = UPLANE(nxtnxt) + src_pitch + _param-&gt;order*src_pitch;break;
+                                case 2:nxtnxtp = VPLANE(nxtnxt) + src_pitch + _param-&gt;order*src_pitch;break;
+                        }
+			nxtnxtpp = nxtnxtp - src_pitch;
+			nxtnxtpn = nxtnxtp + src_pitch;
+			srcp =  srcp_saved + src_pitch + _param-&gt;order*src_pitch;
+			srcpp = srcp - src_pitch;
+			srcpn = srcp + src_pitch;
+			dstp =  dstp_saved + dst_pitch + _param-&gt;order*dst_pitch;
+			for (y = 0; y &lt; h - 2; y+=2)
+			{
+				for (x = 0; x &lt; w; x++)
+				{
+					if (
+						abs(srcp[x] - nxtp[x]) &lt; D
+//						&amp;&amp; abs(srcp[x] - nxtnxtp[x]) &lt; D
+//						&amp;&amp; abs(prvp[x] - nxtp[x]) &lt; D
+						&amp;&amp; abs(srcpn[x] - prvprvpn[x]) &lt; D
+						&amp;&amp; abs(srcpp[x] - prvprvpp[x]) &lt; D
+						&amp;&amp; abs(srcpn[x] - nxtnxtpn[x]) &lt; D
+						&amp;&amp; abs(srcpp[x] - nxtnxtpp[x]) &lt; D
+						&amp;&amp; abs(srcpn[x] - prvpn[x]) &lt; D
+						&amp;&amp; abs(srcpp[x] - prvpp[x]) &lt; D
+						&amp;&amp; abs(srcpn[x] - nxtpn[x]) &lt; D
+						&amp;&amp; abs(srcpp[x] - nxtpp[x]) &lt; D
+					   )
+					{
+						if (_param-&gt;ap == true)
+						{
+							v1 = (int) srcp[x] - AP;
+							if (v1 &lt; 0) v1 = 0; 
+							v2 = (int) srcp[x] + AP;
+							if (v2 &gt; 235) v2 = 235; 
+							if ((v1 &gt; srcpp[x] &amp;&amp; v1 &gt; srcpn[x]) || (v2 &lt; srcpp[x] &amp;&amp; v2 &lt; srcpn[x]))
+							{
+								dstp[x] = ((int)srcpp[x] + srcpn[x]) &gt;&gt; 1;
+//								if (x &amp; 1) dstp[x] = 100; else dstp[x] = 235;
+							}
+							else
+							{
+								dstp[x] = srcp[x];
+//								if (x &amp; 1) dstp[x] = 100; else dstp[x] = 235;
+							}
+						}
+						else
+						{
+							dstp[x] = srcp[x];
+//							if (x &amp; 1) dstp[x] = 100; else dstp[x] = 235;
+						}
+					}
+					else
+					{
+						v1 = (int) srcp[x] - T;
+						if (v1 &lt; 0) v1 = 0; 
+						v2 = (int) srcp[x] + T;
+						if (v2 &gt; 235) v2 = 235; 
+						if ((v1 &gt; srcpp[x] &amp;&amp; v1 &gt; srcpn[x]) || (v2 &lt; srcpp[x] &amp;&amp; v2 &lt; srcpn[x]))
+						{
+							dstp[x] = ((int)srcpp[x] + srcpn[x]) &gt;&gt; 1;
+						}
+						else
+						{
+							dstp[x] = srcp[x];
+//							if (x &amp; 1) dstp[x] = 128; else dstp[x] = 235;
+						}
+					}
+				}
+				prvp    += 2*src_pitch;
+				prvpp    += 2*src_pitch;
+				prvpn    += 2*src_pitch;
+				prvprvpp    += 2*src_pitch;
+				prvprvpn    += 2*src_pitch;
+				nxtp    += 2*src_pitch;
+				nxtpp    += 2*src_pitch;
+				nxtpn    += 2*src_pitch;
+				nxtnxtpp    += 2*src_pitch;
+				nxtnxtpn    += 2*src_pitch;
+				srcp    += 2*src_pitch;
+				srcpp   += 2*src_pitch;
+				srcpn   += 2*src_pitch;
+				dstp    += 2*dst_pitch;
+			}
+		}
+		else
+		{
+			// Process even-numbered frames.
+			// Copy field from current frame.
+			srcp = srcp_saved + (1-_param-&gt;order) * src_pitch;
+			dstp = dstp_saved + (1-_param-&gt;order) * dst_pitch;
+			for (y = 0; y &lt; h; y+=2)
+			{
+				memcpy(dstp, srcp, w);
+				srcp += 2*src_pitch;
+				dstp += 2*dst_pitch;
+			}
+			// Copy through the line that will be missed below.
+			memcpy(dstp_saved + _param-&gt;order*(h-1)*dst_pitch, srcp_saved + _param-&gt;order*(h-1)*src_pitch, w);
+			/* For the other field choose adaptively between using the previous field
+			   or the interpolant from the current field. */
+			//prvp = prv-&gt;GetReadPtr(plane) + src_pitch + (1-order)*src_pitch;
+                        switch(z)
+                        {
+                                case 0:prvp = YPLANE(prv) + src_pitch + (1-_param-&gt;order)*src_pitch;break;
+                                case 1:prvp = UPLANE(prv) + src_pitch + (1-_param-&gt;order)*src_pitch;break;
+                                case 2:prvp = VPLANE(prv) + src_pitch + (1-_param-&gt;order)*src_pitch;break;
+                        }
+			prvpp = prvp - src_pitch;
+			prvpn = prvp + src_pitch;
+			// prvprvp = prvprv-&gt;GetReadPtr(plane) + src_pitch + (1-order)*src_pitch;
+                        switch(z)
+                        {
+                                case 0:prvprvp = YPLANE(prvprv) + src_pitch + (1-_param-&gt;order)*src_pitch;break;
+                                case 1:prvprvp = UPLANE(prvprv) + src_pitch + (1-_param-&gt;order)*src_pitch;break;
+                                case 2:prvprvp = VPLANE(prvprv) + src_pitch + (1-_param-&gt;order)*src_pitch;break;
+                        }
+                        
+			prvprvpp = prvprvp - src_pitch;
+			prvprvpn = prvprvp + src_pitch;
+			//nxtp = nxt-&gt;GetReadPtr(plane) + src_pitch + (1-order)*src_pitch;
+                        switch(z)
+                        {
+                                case 0:nxtp = YPLANE(nxt) + src_pitch + (1-_param-&gt;order)*src_pitch;break;
+                                case 1:nxtp = UPLANE(nxt) + src_pitch + (1-_param-&gt;order)*src_pitch;break;
+                                case 2:nxtp = VPLANE(nxt) + src_pitch + (1-_param-&gt;order)*src_pitch;break;
+                        }
+			nxtpp = nxtp - src_pitch;
+			nxtpn = nxtp + src_pitch;
+			//nxtnxtp = nxtnxt-&gt;GetReadPtr(plane) + src_pitch + (1-order)*src_pitch;
+                         switch(z)
+                        {
+                                case 0:nxtnxtp = YPLANE(nxtnxt) + src_pitch + (1-_param-&gt;order)*src_pitch;break;
+                                case 1:nxtnxtp = UPLANE(nxtnxt) + src_pitch + (1-_param-&gt;order)*src_pitch;break;
+                                case 2:nxtnxtp = VPLANE(nxtnxt) + src_pitch + (1-_param-&gt;order)*src_pitch;break;
+                        }
+			nxtnxtpp = nxtnxtp - src_pitch;
+			nxtnxtpn = nxtnxtp + src_pitch;
+			srcp =  srcp_saved + src_pitch + (1-_param-&gt;order)*src_pitch;
+			srcpp = srcp - src_pitch;
+			srcpn = srcp + src_pitch;
+			dstp =  dstp_saved + dst_pitch + (1-_param-&gt;order)*dst_pitch;
+			for (y = 0; y &lt; h - 2; y+=2)
+			{
+				for (x = 0; x &lt; w; x++)
+				{
+					if (
+						abs(srcp[x] - prvp[x]) &lt; D
+//						&amp;&amp; abs(srcp[x] - prvprvp[x]) &lt; D
+//						&amp;&amp; abs(prvp[x] - nxtp[x]) &lt; D
+						&amp;&amp; abs(srcpn[x] - prvprvpn[x]) &lt; D
+						&amp;&amp; abs(srcpp[x] - prvprvpp[x]) &lt; D
+						&amp;&amp; abs(srcpn[x] - nxtnxtpn[x]) &lt; D
+						&amp;&amp; abs(srcpp[x] - nxtnxtpp[x]) &lt; D
+						&amp;&amp; abs(srcpn[x] - prvpn[x]) &lt; D
+						&amp;&amp; abs(srcpp[x] - prvpp[x]) &lt; D
+						&amp;&amp; abs(srcpn[x] - nxtpn[x]) &lt; D
+						&amp;&amp; abs(srcpp[x] - nxtpp[x]) &lt; D
+					   )
+					{
+						if (_param-&gt;ap == true)
+						{
+							v1 = (int) prvp[x] - AP;
+							if (v1 &lt; 0) v1 = 0; 
+							v2 = (int) prvp[x] + AP;
+							if (v2 &gt; 235) v2 = 235; 
+							if ((v1 &gt; srcpp[x] &amp;&amp; v1 &gt; srcpn[x]) ||	(v2 &lt; srcpp[x] &amp;&amp; v2 &lt; srcpn[x]))
+							{
+								dstp[x] = ((int)srcpp[x] + srcpn[x]) &gt;&gt; 1;
+//								if (x &amp; 1) dstp[x] = 100; else dstp[x] = 235;
+							}
+							else
+							{
+								dstp[x] = prvp[x];
+//								if (x &amp; 1) dstp[x] = 128; else dstp[x] = 235;
+							}
+						}
+						else
+						{
+							dstp[x] = prvp[x];
+//							if (x &amp; 1) dstp[x] = 128; else dstp[x] = 235;
+						}
+					}
+					else
+					{
+						v1 = (int) prvp[x] - T;
+						if (v1 &lt; 0) v1 = 0; 
+						v2 = (int) prvp[x] + T;
+						if (v2 &gt; 235) v2 = 235; 
+						if ((v1 &gt; srcpp[x] &amp;&amp; v1 &gt; srcpn[x]) ||	(v2 &lt; srcpp[x] &amp;&amp; v2 &lt; srcpn[x]))
+						{
+							dstp[x] = ((int)srcpp[x] + srcpn[x]) &gt;&gt; 1;
+						}
+						else
+						{
+							dstp[x] = prvp[x];
+//							if (x &amp; 1) pp[x] = 128; else dstp[x] = 235;
+						}
+					}
+				}
+				prvp    += 2*src_pitch;
+				prvpp    += 2*src_pitch;
+				prvpn    += 2*src_pitch;
+				prvprvpp    += 2*src_pitch;
+				prvprvpn    += 2*src_pitch;
+				nxtp    += 2*src_pitch;
+				nxtpp    += 2*src_pitch;
+				nxtpn    += 2*src_pitch;
+				nxtnxtpp    += 2*src_pitch;
+				nxtnxtpn    += 2*src_pitch;
+				srcp    += 2*src_pitch;
+				srcpp   += 2*src_pitch;
+				srcpn   += 2*src_pitch;
+				dstp    += 2*dst_pitch;
+			}
+		}
+	}
+        vidCache-&gt;unlockAll();
+	return 1;
+}
+//EOF
+
+
+

Copied: branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/ADM_vidDGbob_param.h (from rev 2489, branches/avidemux_2.4_branch/avidemux/ADM_video/ADM_vidDGbob_param.h)

Modified: branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/Makefile.am
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/Makefile.am	2007-01-12 06:50:08 UTC (rev 2707)
+++ branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/Makefile.am	2007-01-12 07:15:14 UTC (rev 2708)
@@ -7,6 +7,7 @@
 #INCLUDES = $(all_includes) 
 
 libADM_videoFilter_a_SOURCES =  \
+ ADM_vidDGbob.cpp \
  ADM_vidForcedPP.cpp \
  ADM_vidMSharpen.cpp \
  ADM_vidDenoise.cpp \


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000035.html">[Avidemux-svn-commit] r2707 -	branches/avidemux_2.3_branch/avidemux/ADM_codecs
</A></li>
	<LI>Next message: <A HREF="000037.html">[Avidemux-svn-commit] r2709 - in	branches/avidemux_2.4_branch/avidemux: . ADM_audiofilter	ADM_filter ADM_userInterfaces/ADM_GTK/ADM_dialog	ADM_userInterfaces/ADM_commonUI
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#36">[ date ]</a>
              <a href="thread.html#36">[ thread ]</a>
              <a href="subject.html#36">[ subject ]</a>
              <a href="author.html#36">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/avidemux-svn-commit">More information about the Avidemux-svn-commit
mailing list</a><br>
</body></html>
