<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Avidemux-svn-commit] r3001 - in branches/avidemux_2.4_branch:	autononreg/dialogFactory avidemux avidemux/ADM_script	avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialogFactory	avidemux/ADM_userInterfaces/ADM_NONE/ADM_dialogFactory	avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialogFactory	avidemux/ADM_userInterfaces/ADM_commonUI
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/avidemux-svn-commit/2007-May/index.html" >
   <LINK REL="made" HREF="mailto:avidemux-svn-commit%40lists.berlios.de?Subject=Re%3A%20%5BAvidemux-svn-commit%5D%20r3001%20-%20in%20branches/avidemux_2.4_branch%3A%0A%09autononreg/dialogFactory%20avidemux%20avidemux/ADM_script%0A%09avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialogFactory%0A%09avidemux/ADM_userInterfaces/ADM_NONE/ADM_dialogFactory%0A%09avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialogFactory%0A%09avidemux/ADM_userInterfaces/ADM_commonUI&In-Reply-To=%3C200705011714.l41HEk9s026157%40sheep.berlios.de%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000312.html">
   <LINK REL="Next"  HREF="000314.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Avidemux-svn-commit] r3001 - in branches/avidemux_2.4_branch:	autononreg/dialogFactory avidemux avidemux/ADM_script	avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialogFactory	avidemux/ADM_userInterfaces/ADM_NONE/ADM_dialogFactory	avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialogFactory	avidemux/ADM_userInterfaces/ADM_commonUI</H1>
    <B>mean at BerliOS</B> 
    <A HREF="mailto:avidemux-svn-commit%40lists.berlios.de?Subject=Re%3A%20%5BAvidemux-svn-commit%5D%20r3001%20-%20in%20branches/avidemux_2.4_branch%3A%0A%09autononreg/dialogFactory%20avidemux%20avidemux/ADM_script%0A%09avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialogFactory%0A%09avidemux/ADM_userInterfaces/ADM_NONE/ADM_dialogFactory%0A%09avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialogFactory%0A%09avidemux/ADM_userInterfaces/ADM_commonUI&In-Reply-To=%3C200705011714.l41HEk9s026157%40sheep.berlios.de%3E"
       TITLE="[Avidemux-svn-commit] r3001 - in branches/avidemux_2.4_branch:	autononreg/dialogFactory avidemux avidemux/ADM_script	avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialogFactory	avidemux/ADM_userInterfaces/ADM_NONE/ADM_dialogFactory	avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialogFactory	avidemux/ADM_userInterfaces/ADM_commonUI">mean at mail.berlios.de
       </A><BR>
    <I>Tue May  1 19:14:46 CEST 2007</I>
    <P><UL>
        <LI>Previous message: <A HREF="000312.html">[Avidemux-svn-commit] r2999 -	branches/avidemux_2.4_branch/avidemux/ADM_inputs/ADM_matroska
</A></li>
        <LI>Next message: <A HREF="000314.html">[Avidemux-svn-commit] r3002 -	branches/avidemux_2.4_branch/addons/mkvscan
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#313">[ date ]</a>
              <a href="thread.html#313">[ thread ]</a>
              <a href="subject.html#313">[ subject ]</a>
              <a href="author.html#313">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Author: mean
Date: 2007-05-01 19:14:45 +0200 (Tue, 01 May 2007)
New Revision: 3001

Added:
   branches/avidemux_2.4_branch/autononreg/dialogFactory/binhex.js
   branches/avidemux_2.4_branch/autononreg/dialogFactory/frame.js
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialogFactory/FAC_hex.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialogFactory/FAC_hex.cpp
Modified:
   branches/avidemux_2.4_branch/avidemux/ADM_script/ADM_JSFunctions.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialogFactory/Makefile.am
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_NONE/ADM_dialogFactory/FAC_toggle.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialogFactory/Makefile.am
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_factory.h
   branches/avidemux_2.4_branch/avidemux/gtk_gui.cpp
Log:
added binHex to dialogFactory

Copied: branches/avidemux_2.4_branch/autononreg/dialogFactory/binhex.js (from rev 2972, branches/avidemux_2.4_branch/autononreg/dialogFactory/float.js)
===================================================================
--- branches/avidemux_2.4_branch/autononreg/dialogFactory/float.js	2007-04-26 14:21:27 UTC (rev 2972)
+++ branches/avidemux_2.4_branch/autononreg/dialogFactory/binhex.js	2007-05-01 17:14:45 UTC (rev 3001)
@@ -0,0 +1,10 @@
+//AD  &lt;- These first 4 characters need to be the first 4 characters to identify the ECMAScript file to Avidemux
+var app = new Avidemux();
+var file=&quot;/work/samples/2mn.avi&quot;;
+var goodfcc=&quot;DIV3&quot;;
+var fps;
+
+	dialogFactoryHex();
+
+/* End of test
+*/

Copied: branches/avidemux_2.4_branch/autononreg/dialogFactory/frame.js (from rev 2731, branches/avidemux_2.4_branch/autononreg/dialogFactory/toggle.js)
===================================================================
--- branches/avidemux_2.4_branch/autononreg/dialogFactory/toggle.js	2007-01-14 13:23:04 UTC (rev 2731)
+++ branches/avidemux_2.4_branch/autononreg/dialogFactory/frame.js	2007-05-01 17:14:45 UTC (rev 3001)
@@ -0,0 +1,10 @@
+//AD  &lt;- These first 4 characters need to be the first 4 characters to identify the ECMAScript file to Avidemux
+var app = new Avidemux();
+var file=&quot;/work/samples/2mn.avi&quot;;
+var goodfcc=&quot;DIV3&quot;;
+var fps;
+
+	dialogFactoryFrame();
+
+/* End of test
+*/

Modified: branches/avidemux_2.4_branch/avidemux/ADM_script/ADM_JSFunctions.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_script/ADM_JSFunctions.cpp	2007-05-01 14:53:39 UTC (rev 3000)
+++ branches/avidemux_2.4_branch/avidemux/ADM_script/ADM_JSFunctions.cpp	2007-05-01 17:14:45 UTC (rev 3001)
@@ -78,6 +78,7 @@
 JSBool facText(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval);
 JSBool facTab(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval);
 JSBool facFrame(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval);
+JSBool facHex(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval);
 JSBool facDirSel(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval);
 JSBool crashTest(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval);
 JSBool assertTest(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval);
@@ -110,6 +111,7 @@
   {&quot;dialogFactoryTabs&quot;,       facTab,        0},
   {&quot;dialogFactoryDirSel&quot;,       facDirSel,        0},
   {&quot;dialogFactoryFrame&quot;,       facFrame,        0},
+  {&quot;dialogFactoryHex&quot;,       facHex,        0},
   {&quot;crashTest&quot;,               crashTest,        0},
   {&quot;assertTest&quot;,               assertTest,        0},
   {0}
@@ -723,6 +725,30 @@
       
       
 }
+
+
+JSBool facHex(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval)
+{
+    
+      uint8_t data[100];
+      for(int i=0;i&lt;100;i++) data[i]=i;
+      
+      diaElemHex binhex(&quot;*****&quot;,100,data);
+      
+      
+         diaElem *elems[]={&amp;binhex   };
+  if(diaFactoryRun(&quot;Test binHex&quot;,1,elems))
+  {
+    *rval = BOOLEAN_TO_JSVAL(1);
+    
+  }else
+    *rval = BOOLEAN_TO_JSVAL(0);
+  
+  return JS_TRUE;
+      
+      
+}
+
 JSBool crashTest(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval)
 {
   

Copied: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialogFactory/FAC_hex.cpp (from rev 2972, branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialogFactory/FAC_toggle.cpp)
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialogFactory/FAC_toggle.cpp	2007-04-26 14:21:27 UTC (rev 2972)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialogFactory/FAC_hex.cpp	2007-05-01 17:14:45 UTC (rev 3001)
@@ -0,0 +1,167 @@
+/***************************************************************************
+  FAC_toggle.cpp
+  Handle dialog factory element : Toggle
+  (C) 2006 Mean <A HREF="https://lists.berlios.de/mailman/listinfo/avidemux-svn-commit">Fixounet at free.fr</A> 
+***************************************************************************/
+
+/***************************************************************************
+ *                                                                         *
+ *   This program is free software; you can redistribute it and/or modify  *
+ *   it under the terms of the GNU General Public License as published by  *
+ *   the Free Software Foundation; either version 2 of the License, or     *
+ *   (at your option) any later version.                                   *
+ *                                                                         *
+ ***************************************************************************/
+
+#include &lt;config.h&gt;
+
+
+#include &lt;string.h&gt;
+#include &lt;stdio.h&gt;
+#include &lt;math.h&gt;
+
+#include &quot;default.h&quot;
+#include &quot;ADM_toolkit_gtk/ADM_gladeSupport.h&quot;
+#include &quot;ADM_toolkit_gtk/toolkit_gtk.h&quot;
+#include &quot;ADM_toolkit_gtk/toolkit_gtk_include.h&quot;
+#include &quot;ADM_commonUI/DIA_factory.h&quot;
+#include &quot;ADM_assert.h&quot;
+
+#define HEX_NB_LINE   8
+#define HEX_NB_COLUMN 16
+
+
+
+typedef struct hexStruct
+{ 
+    GtkWidget *grid;
+    GtkWidget *entry[HEX_NB_LINE];
+    uint8_t   *data;
+    uint32_t  size;
+    uint32_t  curOffset;
+}hexStruct;
+
+static void updateMe(hexStruct *s);
+static void prev(void *z,hexStruct *s);
+static void next(void *z,hexStruct *s);
+
+diaElemHex::diaElemHex(const char *toggleTitle, uint32_t dataSize,uint8_t *data)
+  : diaElem(ELEM_HEXDUMP)
+{
+  param=NULL;
+  paramTitle=toggleTitle;
+  this-&gt;tip=NULL;
+  this-&gt;data=data;
+  this-&gt;dataSize=dataSize;
+   setSize(3);
+}
+
+diaElemHex::~diaElemHex()
+{
+  if(myWidget)
+  {
+     hexStruct *s=(hexStruct *)myWidget;
+     delete s;
+     myWidget=NULL;
+  }
+}
+void diaElemHex::setMe(void *dialog, void *opaque,uint32_t line)
+{
+  GtkWidget *hexTable,*buttonP,*buttonN;
+  uint8_t *tail=data+dataSize;
+  
+  hexTable=gtk_table_new(1,HEX_NB_LINE,0);
+  gtk_widget_show(hexTable);
+  
+  
+  gtk_table_attach (GTK_TABLE (opaque), hexTable, 0, 2, line, line+1,
+                    (GtkAttachOptions) (GTK_EXPAND | GTK_FILL),
+                    (GtkAttachOptions) (0), 0, 0);
+  
+  hexStruct *s=new hexStruct;
+  s-&gt;grid=hexTable;
+  s-&gt;data=data;
+  s-&gt;size=dataSize;
+  s-&gt;curOffset=0;
+  for(int i=0;i&lt;HEX_NB_LINE;i++)
+  {
+    s-&gt;entry[i]=gtk_label_new(&quot;&quot;);
+    gtk_widget_show(s-&gt;entry[i]);
+     gtk_table_attach (GTK_TABLE (hexTable), s-&gt;entry[i], 0, 1, i, i+1,
+                    (GtkAttachOptions) (GTK_EXPAND | GTK_FILL),
+                    (GtkAttachOptions) (0), 0, 0);
+  }
+  myWidget=(void *)s;
+  //*************************
+  buttonP = gtk_button_new_from_stock (&quot;gtk-previous&quot;);
+  gtk_widget_show (buttonP);
+  gtk_table_attach (GTK_TABLE (opaque), buttonP, 0, 1, line+1, line+2,
+                    (GtkAttachOptions) (GTK_EXPAND | GTK_FILL),
+                    (GtkAttachOptions) (0), 0, 0);
+  g_signal_connect(GTK_OBJECT(buttonP), &quot;clicked&quot;,
+                    GTK_SIGNAL_FUNC(prev),  s);
+  
+  buttonN = gtk_button_new_from_stock (&quot;gtk-next&quot;);
+  gtk_widget_show (buttonN);
+  gtk_table_attach (GTK_TABLE (opaque), buttonN, 0, 1, line+2, line+3,
+                    (GtkAttachOptions) (GTK_EXPAND | GTK_FILL),
+                    (GtkAttachOptions) (0), 0, 0);
+  g_signal_connect(GTK_OBJECT(buttonN), &quot;clicked&quot;,
+                    GTK_SIGNAL_FUNC(next),  s);
+  
+  
+  updateMe(s);
+}
+void prev(void *z,hexStruct *s)
+{
+  if(s-&gt;curOffset&gt;=HEX_NB_COLUMN*4)
+      s-&gt;curOffset-=HEX_NB_COLUMN*4;
+  updateMe(s);
+  
+}
+void next(void *z,hexStruct *s)
+{
+      s-&gt;curOffset+=HEX_NB_COLUMN*4;
+  updateMe(s);
+}
+void updateMe(hexStruct *s)
+{
+  uint8_t *tail=s-&gt;data+s-&gt;size;
+  uint8_t *cur;
+  char string[3000];
+  char *ptr;
+  for(int i=0;i&lt;HEX_NB_LINE;i++)
+  {
+     cur=s-&gt;data+HEX_NB_COLUMN*i+s-&gt;curOffset;
+     
+     sprintf(string,&quot;%06x:&quot;,HEX_NB_COLUMN*i+s-&gt;curOffset);
+     ptr=string+strlen(string);
+     *ptr=0;
+     for(int j=0;j&lt;HEX_NB_COLUMN;j++)
+     {
+       if(cur&lt;tail)
+       {
+          sprintf(ptr,&quot;%02X &quot;,*cur++);
+          ptr+=3;
+       }else 
+       {
+          *ptr++='X';
+          *ptr++='X';
+          *ptr++=' ';
+       }
+     }
+     ptr[2999]=0;
+     gtk_label_set_text(GTK_LABEL(s-&gt;entry[i]),string);
+     
+  }
+}
+void diaElemHex::getMe(void)
+{
+ 
+}
+void diaElemHex::finalize(void) 
+{
+
+};
+
+//EOF

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialogFactory/Makefile.am
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialogFactory/Makefile.am	2007-05-01 14:53:39 UTC (rev 3000)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialogFactory/Makefile.am	2007-05-01 17:14:45 UTC (rev 3001)
@@ -18,6 +18,7 @@
 FAC_bar.cpp \
 FAC_readOnlyText.cpp \
 FAC_notch.cpp \
-FAC_frame.cpp
+FAC_frame.cpp \
+FAC_hex.cpp
 
 

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_NONE/ADM_dialogFactory/FAC_toggle.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_NONE/ADM_dialogFactory/FAC_toggle.cpp	2007-05-01 14:53:39 UTC (rev 3000)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_NONE/ADM_dialogFactory/FAC_toggle.cpp	2007-05-01 17:14:45 UTC (rev 3001)
@@ -296,4 +296,13 @@
 void diaElemFrame::finalize(void)
 {
 }
+//**************************
+
+  
+  diaElemHex::diaElemHex(const char *toggleTitle, uint32_t dataSize,uint8_t *data) :diaElem(ELEM_HEXDUMP){};
+  diaElemHex::~diaElemHex() {};
+  void diaElemHex::setMe(void *dialog, void *opaque,uint32_t line) {};
+  void diaElemHex::getMe(void) {} ;
+  void diaElemHex::finalize(void) {};
+
 //EOF

Copied: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialogFactory/FAC_hex.cpp (from rev 2972, branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialogFactory/FAC_toggle.cpp)
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialogFactory/FAC_toggle.cpp	2007-04-26 14:21:27 UTC (rev 2972)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialogFactory/FAC_hex.cpp	2007-05-01 17:14:45 UTC (rev 3001)
@@ -0,0 +1,41 @@
+/***************************************************************************
+  FAC_toggle.cpp
+  Handle dialog factory element : Toggle
+  (C) 2006 Mean <A HREF="https://lists.berlios.de/mailman/listinfo/avidemux-svn-commit">Fixounet at free.fr</A> 
+***************************************************************************/
+
+/***************************************************************************
+ *                                                                         *
+ *   This program is free software; you can redistribute it and/or modify  *
+ *   it under the terms of the GNU General Public License as published by  *
+ *   the Free Software Foundation; either version 2 of the License, or     *
+ *   (at your option) any later version.                                   *
+ *                                                                         *
+ ***************************************************************************/
+
+#include &lt;config.h&gt;
+
+
+#include &lt;string.h&gt;
+#include &lt;stdio.h&gt;
+#include &lt;stdlib.h&gt;
+#include &lt;math.h&gt;
+
+#include &lt;QDialog&gt;
+#include &lt;QMessageBox&gt;
+#include &lt;QGridLayout&gt;
+#include &lt;QCheckBox&gt;
+
+#include &quot;default.h&quot;
+#include &quot;ADM_commonUI/DIA_factory.h&quot;
+#include &quot;ADM_assert.h&quot;
+
+extern const char *shortkey(const char *);
+  diaElemHex::diaElemHex(const char *toggleTitle, uint32_t dataSize,uint8_t *data) :diaElem(ELEM_HEXDUMP){};
+  diaElemHex::~diaElemHex() {};
+  void diaElemHex::setMe(void *dialog, void *opaque,uint32_t line) {};
+  void diaElemHex::getMe(void) {} ;
+  void diaElemHex::finalize(void) {};
+//******************************************************
+
+//EOF

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialogFactory/Makefile.am
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialogFactory/Makefile.am	2007-05-01 14:53:39 UTC (rev 3000)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialogFactory/Makefile.am	2007-05-01 17:14:45 UTC (rev 3001)
@@ -3,7 +3,7 @@
 
 libADM_dialogFactory_a_METASOURCES = AUTO
 
-libADM_dialogFactory_a_SOURCES = AT_dialogFactory.cpp FAC_toggle.cpp FAC_integer.cpp FAC_menu.cpp FAC_float.cpp AT_filesel.cpp AT_bitrate.cpp FAC_bar.cpp FAC_readOnlyText.cpp FAC_notch.cpp FAC_frame.cpp
+libADM_dialogFactory_a_SOURCES = AT_dialogFactory.cpp FAC_toggle.cpp FAC_integer.cpp FAC_menu.cpp FAC_float.cpp AT_filesel.cpp AT_bitrate.cpp FAC_bar.cpp FAC_readOnlyText.cpp FAC_notch.cpp FAC_frame.cpp FAC_hex.cpp
 
 
 INCLUDES = $(all_includes)  $(XML_CFLAGS)  $(FREETYPE_CFLAGS) -DADM_SUBVERSION=@ADM_SUBVERSION@ \

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_factory.h
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_factory.h	2007-05-01 14:53:39 UTC (rev 3000)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_factory.h	2007-05-01 17:14:45 UTC (rev 3001)
@@ -33,6 +33,7 @@
   ELEM_DIR_SELECT,
   ELEM_TEXT,
   ELEM_FRAME,
+  ELEM_HEXDUMP,
   ELEM_MAX=ELEM_TOGGLE
 };
 /*********************************************/
@@ -327,7 +328,20 @@
   void finalize(void);
 };
 /**********************************************/
-
+class diaElemHex : public diaElem
+{
+  uint32_t dataSize;
+  uint8_t  *data;
+  
+public:
+  
+  diaElemHex(const char *toggleTitle, uint32_t dataSize,uint8_t *data);
+  virtual ~diaElemHex() ;
+  void setMe(void *dialog, void *opaque,uint32_t line);
+  void getMe(void) ;
+  void finalize(void);
+};
+/**********************************************/
 /*********************************************/
 uint8_t diaFactoryRun(const char *title,uint32_t nb,diaElem **elems);
 uint8_t diaFactoryRunTabs(const char *title,uint32_t nb,diaElemTabs **tabs);

Modified: branches/avidemux_2.4_branch/avidemux/gtk_gui.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/gtk_gui.cpp	2007-05-01 14:53:39 UTC (rev 3000)
+++ branches/avidemux_2.4_branch/avidemux/gtk_gui.cpp	2007-05-01 17:14:45 UTC (rev 3001)
@@ -2441,40 +2441,27 @@
 #define DISPLAY_HEX 32*3
  uint8_t *buffer;
  uint32_t len,fullLen,flags;
- char     string[DISPLAY_HEX*3+6],*s;
- char     title[80];
+ char sType[5];
+ char sSize[15];
  
  if (!avifileinfo) return;
  
  buffer=new uint8_t [avifileinfo-&gt;width*avifileinfo-&gt;height*3];
  video_body-&gt;getRaw (curframe, buffer, &amp;fullLen);  
- 
- len=fullLen;
- if(len&gt;DISPLAY_HEX) len=DISPLAY_HEX;
- s=string;
- for(int i=0;i&lt;len;i++)
- {
-    sprintf(s,&quot;%02x &quot;,buffer[i]); 
-    s+=3;
-    if(i%8==7)
-    {
-      *s++='\n'; 
-    }
-    
- }
- *s=0;
  video_body-&gt;getFlags (curframe, &amp;flags);
- char Type='?';
- switch(flags)
- {
-   case 0: Type='P'; break;
-   case AVI_KEY_FRAME: Type='I'; break;
-   case AVI_B_FRAME: Type='B'; break;
-   default : Type='?'; break;
- }
- sprintf(title,&quot;Len: %u bytes %c\n&quot;,fullLen,Type);
  
- GUI_Info_HIG( ADM_LOG_IMPORTANT,title, string);
+ diaElemHex binhex(&quot;*****&quot;,fullLen,buffer);
+      
+ if(flags==AVI_KEY_FRAME) sprintf(sType,&quot;I&quot;);
+  else if(flags==AVI_B_FRAME) sprintf(sType,&quot;B&quot;);
+    else sprintf(sType,&quot;P&quot;);
+ sprintf(sSize,&quot;%d bytes&quot;,fullLen);
+ 
+ diaElemReadOnlyText Type(sType,_(&quot;Frame Type:&quot;));
+ diaElemReadOnlyText Size(sSize,_(&quot;Frame Size:&quot;));
+ diaElem *elems[]={&amp;Type,&amp;Size,&amp;binhex   };
+ if(diaFactoryRun(&quot;Frame HexDump&quot;,3,elems))
+ 
  delete [] buffer;
 }
 


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000312.html">[Avidemux-svn-commit] r2999 -	branches/avidemux_2.4_branch/avidemux/ADM_inputs/ADM_matroska
</A></li>
	<LI>Next message: <A HREF="000314.html">[Avidemux-svn-commit] r3002 -	branches/avidemux_2.4_branch/addons/mkvscan
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#313">[ date ]</a>
              <a href="thread.html#313">[ thread ]</a>
              <a href="subject.html#313">[ subject ]</a>
              <a href="author.html#313">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/avidemux-svn-commit">More information about the Avidemux-svn-commit
mailing list</a><br>
</body></html>
