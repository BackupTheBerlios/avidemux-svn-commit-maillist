<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Avidemux-svn-commit] r3084 - in	branches/avidemux_2.4_branch/avidemux: ADM_inputs/ADM_mp4	ADM_libraries/ADM_lavcodec/i386	ADM_userInterfaces/ADM_GTK/ADM_dialog	ADM_userInterfaces/ADM_GTK/glade	ADM_userInterfaces/ADM_commonUI ADM_video
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/avidemux-svn-commit/2007-May/index.html" >
   <LINK REL="made" HREF="mailto:avidemux-svn-commit%40lists.berlios.de?Subject=Re%3A%20%5BAvidemux-svn-commit%5D%20r3084%20-%20in%0A%09branches/avidemux_2.4_branch/avidemux%3A%20ADM_inputs/ADM_mp4%0A%09ADM_libraries/ADM_lavcodec/i386%0A%09ADM_userInterfaces/ADM_GTK/ADM_dialog%0A%09ADM_userInterfaces/ADM_GTK/glade%0A%09ADM_userInterfaces/ADM_commonUI%20ADM_video&In-Reply-To=%3C200705131650.l4DGoqiH029860%40sheep.berlios.de%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000384.html">
   <LINK REL="Next"  HREF="000386.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Avidemux-svn-commit] r3084 - in	branches/avidemux_2.4_branch/avidemux: ADM_inputs/ADM_mp4	ADM_libraries/ADM_lavcodec/i386	ADM_userInterfaces/ADM_GTK/ADM_dialog	ADM_userInterfaces/ADM_GTK/glade	ADM_userInterfaces/ADM_commonUI ADM_video</H1>
    <B>mean at BerliOS</B> 
    <A HREF="mailto:avidemux-svn-commit%40lists.berlios.de?Subject=Re%3A%20%5BAvidemux-svn-commit%5D%20r3084%20-%20in%0A%09branches/avidemux_2.4_branch/avidemux%3A%20ADM_inputs/ADM_mp4%0A%09ADM_libraries/ADM_lavcodec/i386%0A%09ADM_userInterfaces/ADM_GTK/ADM_dialog%0A%09ADM_userInterfaces/ADM_GTK/glade%0A%09ADM_userInterfaces/ADM_commonUI%20ADM_video&In-Reply-To=%3C200705131650.l4DGoqiH029860%40sheep.berlios.de%3E"
       TITLE="[Avidemux-svn-commit] r3084 - in	branches/avidemux_2.4_branch/avidemux: ADM_inputs/ADM_mp4	ADM_libraries/ADM_lavcodec/i386	ADM_userInterfaces/ADM_GTK/ADM_dialog	ADM_userInterfaces/ADM_GTK/glade	ADM_userInterfaces/ADM_commonUI ADM_video">mean at mail.berlios.de
       </A><BR>
    <I>Sun May 13 18:50:52 CEST 2007</I>
    <P><UL>
        <LI>Previous message: <A HREF="000384.html">[Avidemux-svn-commit] r3083 -	branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog
</A></li>
        <LI>Next message: <A HREF="000386.html">[Avidemux-svn-commit] r3085 -	branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec/i386
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#385">[ date ]</a>
              <a href="thread.html#385">[ thread ]</a>
              <a href="subject.html#385">[ subject ]</a>
              <a href="author.html#385">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Author: mean
Date: 2007-05-13 18:50:44 +0200 (Sun, 13 May 2007)
New Revision: 3084

Added:
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/glade/contrast2.glade
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_flyContrast.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_flyContrast.h
Modified:
   branches/avidemux_2.4_branch/avidemux/ADM_inputs/ADM_mp4/ADM_mp4Analyzer.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec/i386/cputest.c
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_contrast.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_flyAsharp.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/Makefile.am
   branches/avidemux_2.4_branch/avidemux/ADM_video/ADM_vidContrast.cpp
Log:
flyDialog for contrast (gtk)

Modified: branches/avidemux_2.4_branch/avidemux/ADM_inputs/ADM_mp4/ADM_mp4Analyzer.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_inputs/ADM_mp4/ADM_mp4Analyzer.cpp	2007-05-13 16:05:39 UTC (rev 3083)
+++ branches/avidemux_2.4_branch/avidemux/ADM_inputs/ADM_mp4/ADM_mp4Analyzer.cpp	2007-05-13 16:50:44 UTC (rev 3084)
@@ -173,11 +173,6 @@
             parseMdia(&amp;son,&amp;trackType,w,h);
             break;
         }
-        case ADM_MP4_STBL:
-        {
-            parseMdia(&amp;son,&amp;trackType,w,h);
-            break;
-        }
        default:
           adm_printf(ADM_PRINT_DEBUG,&quot;Unprocessed atom\n&quot;);
      }

Modified: branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec/i386/cputest.c
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec/i386/cputest.c	2007-05-13 16:05:39 UTC (rev 3083)
+++ branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec/i386/cputest.c	2007-05-13 16:50:44 UTC (rev 3084)
@@ -51,6 +51,8 @@
     int max_std_level, max_ext_level, std_caps=0, ext_caps=0;
     long a, c;
 
+    
+    
     __asm__ __volatile__ (
                           /* See if CPUID instruction is supported ... */
                           /* ... Get copies of EFLAGS into eax and ecx */
@@ -81,7 +83,7 @@
         cpuid(1, eax, ebx, ecx, std_caps);
         if (std_caps &amp; (1&lt;&lt;23))
             rval |= MM_MMX;
-#if 1	    
+#if 0	    
         if (std_caps &amp; (1&lt;&lt;25))
             rval |= MM_MMXEXT | MM_SSE;
         if (std_caps &amp; (1&lt;&lt;26))

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_contrast.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_contrast.cpp	2007-05-13 16:05:39 UTC (rev 3083)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_contrast.cpp	2007-05-13 16:50:44 UTC (rev 3084)
@@ -42,208 +42,160 @@
 #include &quot;ADM_toolkit_gtk/toolkit_gtk.h&quot;
 #include &quot;ADM_toolkit_gtk/toolkit_gtk_include.h&quot;
 #include &lt;ADM_assert.h&gt;
+#include &quot;DIA_flyDialog.h&quot;
+#include &quot;DIA_flyContrast.h&quot;
 
-
-#define CHECKBOX(x,y) if(TRUE==gtk_toggle_button_get_active(GTK_TOGGLE_BUTTON(lookup_widget(dialog,#x))))  \
-			y=1; else y=0;
-#define SCHECKBOX(x,y) gtk_toggle_button_set_active(GTK_TOGGLE_BUTTON(lookup_widget(dialog,#x)),y)
-void    GUI_RGBDisplay(uint8_t *dis,uint32_t w,uint32_t h,void *widg);
-
-static int getContrastParams (void);
-
+/********************************************************************/
 static GtkWidget *create_dialog1 (void);
 static GtkWidget *dialog = NULL;
-static GtkObject *adj_offset = NULL, *adj_coeff = NULL;
 
 static gboolean gui_draw (GtkWidget * widget,
 			  GdkEventExpose * event, gpointer user_data);
-
-//static int croplock;
-static ColYuvRgb    *rgbConv=NULL;
 static void gui_update (GtkButton * button, gpointer user_data);
-static void draw(void);
-static void calculate(void);
+static void frame_changed( void );
 
-// Ugly !
-static ADMImage *video_src,*video_shifted;
-static AVDMGenericVideoStream *sstream;
-static uint8_t *video_rgb;
-static uint32_t ww, hh;
-static CONTRAST_PARAM par;
+static int lock=0;
+static flyContrast *myCrop=NULL;
 
-static uint8_t tableluma[256], tablechroma[256];
-
-uint8_t DIA_contrast(AVDMGenericVideoStream *astream,CONTRAST_PARAM *param)
+/********************************************************************/
+uint8_t DIA_contrast(AVDMGenericVideoStream *in,CONTRAST_PARAM *param)
 {
-  uint8_t ret=0;
-        sstream=astream;
-        ww=astream-&gt;getInfo()-&gt;width;
-        hh=astream-&gt;getInfo()-&gt;height;
-        video_src=new ADMImage(ww,hh);
-        video_shifted=new ADMImage(ww,hh);
-        video_rgb=new uint8_t[ww*hh*4];
-        rgbConv=new ColYuvRgb(ww,hh);
-        rgbConv-&gt;reset(ww,hh);
-        
+  
+   uint32_t width,height;
+      uint8_t ret=0;
+        // Allocate space for green-ised video
+        width=in-&gt;getInfo()-&gt;width;
+        height=in-&gt;getInfo()-&gt;height;
+
         dialog=create_dialog1();
         gtk_register_dialog(dialog);
-        gtk_widget_set_usize (WID (drawingarea1), ww, hh);
         
-        memcpy(&amp;par,param,sizeof(par));
-        SCHECKBOX (checkLuma, par.doLuma);
-        SCHECKBOX (checkbuttonU, par.doChromaU);
-        SCHECKBOX (checkbuttonV, par.doChromaV);
-
-        GTK_ADJUSTMENT (adj_offset)-&gt;value = par.offset;
-        GTK_ADJUSTMENT (adj_coeff)-&gt;value = par.coef;
-
-  
-  // and value changed
+        gtk_widget_set_usize(WID(drawingarea1), width,height);
+        gtk_window_set_title (GTK_WINDOW (dialog), _(&quot;ASHARP&quot;));
+        gtk_widget_show(dialog);
+	
+        
+          // and value changed
 #define CNX(x,y) gtk_signal_connect(GTK_OBJECT(WID(x)), y, GTK_SIGNAL_FUNC(gui_update), (void *) (1));
 
+        CNX (checkLuma, &quot;toggled&quot;);
+        CNX (checkbuttonU, &quot;toggled&quot;);
+        CNX (checkbuttonV, &quot;toggled&quot;);
+        
+        
         CNX (hscaleContrast, &quot;value_changed&quot;);
         CNX (hscaleContrast, &quot;drag_data_received&quot;);
       
         CNX (hscaleBright, &quot;value_changed&quot;);
         CNX (hscaleBright, &quot;drag_data_received&quot;);
-        uint32_t curImage=0,len,flags;
-        if(!astream-&gt;getFrameNumberNoAlloc(curImage,&amp;len,video_src,&amp;flags))
-        {
-          GUI_Error_HIG(&quot;Frame error&quot;,&quot;Cannnot read frame to display&quot;);
+        gtk_signal_connect(GTK_OBJECT(WID(hscale1)), &quot;value_changed&quot;,GTK_SIGNAL_FUNC(frame_changed),   NULL);
+        gtk_signal_connect(GTK_OBJECT(WID(drawingarea1)), &quot;expose_event&quot;,
+            GTK_SIGNAL_FUNC(gui_draw),
+            NULL);
 
-        }
-        else
-        {
-          calculate();
-          // add display callback
-          rgbConv-&gt;scale(video_src-&gt;data,video_rgb);
-          //GUI_RGBDisplay (video_rgb, ww, hh, (void *) WID (drawingarea1));
-          gtk_signal_connect (GTK_OBJECT (WID (drawingarea1)), &quot;expose_event&quot;,
-                  GTK_SIGNAL_FUNC (gui_draw), NULL);
 
-          if (gtk_dialog_run (GTK_DIALOG (dialog)) == GTK_RESPONSE_OK)
-            {
-              CHECKBOX (checkLuma, par.doLuma);
-              CHECKBOX (checkbuttonU, par.doChromaU);
-              CHECKBOX (checkbuttonV, par.doChromaV);
+          
+        myCrop=new flyContrast( width, height,in,WID(drawingarea1),WID(hscale1));
+        memcpy(&amp;(myCrop-&gt;param),param,sizeof(CONTRAST_PARAM));
+        myCrop-&gt;upload();
+        myCrop-&gt;sliderChanged();
+        ret=0;
+        int response;
+        response=gtk_dialog_run(GTK_DIALOG(dialog));
 
-              par.coef = GTK_ADJUSTMENT (adj_coeff)-&gt;value;
-              par.offset = (int8_t) floor (GTK_ADJUSTMENT (adj_offset)-&gt;value);
-
-              memcpy(param,&amp;par,sizeof(par));
-              ret = 1;
-            }
+        if(response==GTK_RESPONSE_OK)
+        {
+            myCrop-&gt;download();
+            memcpy(param,&amp;(myCrop-&gt;param),sizeof(CONTRAST_PARAM));
+            ret=1;
         }
         gtk_unregister_dialog(dialog);
         gtk_widget_destroy(dialog);
-        dialog=NULL;
-        delete video_src;
-        delete video_shifted;
-        delete [] video_rgb;
-        delete rgbConv;
+        delete myCrop;
         return ret;
 }
-void calculate(void)
-{
-  buildContrastTable (par.coef, par.offset, tableluma, tablechroma);
 
-  memcpy (video_shifted-&gt;data, video_src-&gt;data, (hh * ww * 3)&gt;&gt;1);
-  if (par.doLuma)
-    {
-      doContrast (YPLANE(video_src), YPLANE(video_shifted), tableluma, ww, hh);
-    }
-  if (par.doChromaU)
-    {
-      doContrast (UPLANE(video_src), UPLANE(video_shifted), tablechroma, ww &gt;&gt; 1, hh &gt;&gt; 1);
-    }
 
-  if (par.doChromaV)
-    {
-     doContrast (VPLANE(video_src), VPLANE(video_shifted), tablechroma, ww &gt;&gt; 1, hh &gt;&gt; 1);
-    }
-}
-void draw(void)
-{
-  //COL_yv12rgb (sw, sh, video2, video3);
-  rgbConv-&gt;scale(video_shifted-&gt;data,video_rgb);
-  GUI_RGBDisplay (video_rgb, ww, hh, (void *) WID (drawingarea1));
-}
 //
 //        Check entered values and green-out the selected portion on the screen
 //        Each value must be even
 //
+void frame_changed( void )
+{
+  myCrop-&gt;sliderChanged();
+}
 void gui_update (GtkButton * button, gpointer user_data)
 {
-  UNUSED_ARG (button);
-  UNUSED_ARG (user_data);
-  uint32_t    sz;
-
-  sz = ww * hh;
-  CHECKBOX (checkLuma, par.doLuma);
-  CHECKBOX (checkbuttonU, par.doChromaU);
-  CHECKBOX (checkbuttonV, par.doChromaV);
-
-  par.coef = GTK_ADJUSTMENT (adj_coeff)-&gt;value;
-  par.offset = (int8_t) floor (GTK_ADJUSTMENT (adj_offset)-&gt;value);
-
-  // printf(&quot;\n Luma : %d,u %d, v:%d&quot;,par.doLuma,par.doChromaU,par.doChromaV);
-  // printf(&quot;\n off : %d, coeff %f\n&quot;,par.offset,par.coef);
-  calculate();
-  draw();
-  
+  if(lock) return;
+    myCrop-&gt;update();
 }
 
 gboolean gui_draw (GtkWidget * widget, GdkEventExpose * event, gpointer user_data)
 {
-  UNUSED_ARG (widget);
-  UNUSED_ARG (event);
-  UNUSED_ARG (user_data);
-
-  GUI_RGBDisplay (video_rgb, ww, hh, (void *) WID (drawingarea1));
+  myCrop-&gt;display();
   return TRUE;
 }
 
+/**************************************/
+#define CHECKBOX(x,y) if(TRUE==gtk_toggle_button_get_active(GTK_TOGGLE_BUTTON(lookup_widget(dialog,#x))))  \
+			y=1; else y=0;
+#define SCHECKBOX(x,y) gtk_toggle_button_set_active(GTK_TOGGLE_BUTTON(lookup_widget(dialog,#x)),y)
 
-GtkWidget *
+
+uint8_t flyContrast::upload(void)
+{
+    lock++;
+      SCHECKBOX (checkLuma, param.doLuma);
+      SCHECKBOX (checkbuttonU, param.doChromaU);
+      SCHECKBOX (checkbuttonV, param.doChromaV);
+
+      GtkAdjustment *adj=gtk_range_get_adjustment (GTK_RANGE(WID(hscaleBright)));
+      GTK_ADJUSTMENT(adj)-&gt;value=param.offset;
+  
+      adj=gtk_range_get_adjustment (GTK_RANGE(WID(hscaleContrast)));
+      GTK_ADJUSTMENT(adj)-&gt;value=param.coef;
+    lock--;
+    return 1;
+}
+uint8_t flyContrast::download (void)
+{
+  CHECKBOX (checkLuma, param.doLuma);
+  CHECKBOX (checkbuttonU, param.doChromaU);
+  CHECKBOX (checkbuttonV, param.doChromaV);
+  
+  GtkAdjustment *adj=gtk_range_get_adjustment (GTK_RANGE(WID(hscaleBright)));
+  param.offset= GTK_ADJUSTMENT(adj)-&gt;value;
+  
+  adj=gtk_range_get_adjustment (GTK_RANGE(WID(hscaleContrast)));
+  param.coef=GTK_ADJUSTMENT(adj)-&gt;value;
+   return 1;
+}
+
+GtkWidget*
 create_dialog1 (void)
 {
-  GtkWidget *
-    dialog1;
-  GtkWidget *
-    dialog_vbox1;
-  GtkWidget *
-    vbox1;
-  GtkWidget *
-    hbox1;
-  GtkWidget *
-    vbox3;
-  GtkWidget *
-    label1;
-  GtkWidget *
-    hscaleContrast;
-  GtkWidget *
-    label2;
-  GtkWidget *
-    hscaleBright;
-  GtkWidget *
-    vbox2;
-  GtkWidget *
-    checkLuma;
-  GtkWidget *
-    checkbuttonU;
-  GtkWidget *
-    checkbuttonV;
-  GtkWidget *
-    drawingarea1;
-  GtkWidget *
-    dialog_action_area1;
-  GtkWidget *
-    cancelbutton1;
-  GtkWidget *
-    okbutton1;
+  GtkWidget *dialog1;
+  GtkWidget *dialog_vbox1;
+  GtkWidget *vbox1;
+  GtkWidget *hbox1;
+  GtkWidget *vbox3;
+  GtkWidget *label1;
+  GtkWidget *hscaleContrast;
+  GtkWidget *label2;
+  GtkWidget *hscaleBright;
+  GtkWidget *vbox2;
+  GtkWidget *checkLuma;
+  GtkWidget *checkbuttonU;
+  GtkWidget *checkbuttonV;
+  GtkWidget *hscale1;
+  GtkWidget *drawingarea1;
+  GtkWidget *dialog_action_area1;
+  GtkWidget *cancelbutton1;
+  GtkWidget *okbutton1;
 
   dialog1 = gtk_dialog_new ();
   gtk_window_set_title (GTK_WINDOW (dialog1), _(&quot;Contrast&quot;));
+  gtk_window_set_type_hint (GTK_WINDOW (dialog1), GDK_WINDOW_TYPE_HINT_DIALOG);
 
   dialog_vbox1 = GTK_DIALOG (dialog1)-&gt;vbox;
   gtk_widget_show (dialog_vbox1);
@@ -263,12 +215,8 @@
   label1 = gtk_label_new (_(&quot;Contrast&quot;));
   gtk_widget_show (label1);
   gtk_box_pack_start (GTK_BOX (vbox3), label1, FALSE, FALSE, 0);
-  gtk_label_set_justify (GTK_LABEL (label1), GTK_JUSTIFY_LEFT);
 
-
-
-  adj_coeff = gtk_adjustment_new (1, 0.5, 1.5, 0.1, 0.1, 0);
-  hscaleContrast = gtk_hscale_new (GTK_ADJUSTMENT (adj_coeff));
+  hscaleContrast = gtk_hscale_new (GTK_ADJUSTMENT (gtk_adjustment_new (1, 0.5, 1.5, 0.1, 0.1, 0)));
   gtk_widget_show (hscaleContrast);
   gtk_box_pack_start (GTK_BOX (vbox3), hscaleContrast, FALSE, TRUE, 0);
   gtk_scale_set_value_pos (GTK_SCALE (hscaleContrast), GTK_POS_LEFT);
@@ -276,11 +224,8 @@
   label2 = gtk_label_new (_(&quot;Brightness&quot;));
   gtk_widget_show (label2);
   gtk_box_pack_start (GTK_BOX (vbox3), label2, FALSE, FALSE, 0);
-  gtk_label_set_justify (GTK_LABEL (label2), GTK_JUSTIFY_LEFT);
 
-
-  adj_offset = gtk_adjustment_new (0, -127, 127, 1, 1, 0);
-  hscaleBright = gtk_hscale_new (GTK_ADJUSTMENT (adj_offset));
+  hscaleBright = gtk_hscale_new (GTK_ADJUSTMENT (gtk_adjustment_new (0, -127, 127, 1, 1, 0)));
   gtk_widget_show (hscaleBright);
   gtk_box_pack_start (GTK_BOX (vbox3), hscaleBright, FALSE, TRUE, 0);
   gtk_scale_set_value_pos (GTK_SCALE (hscaleBright), GTK_POS_LEFT);
@@ -298,10 +243,14 @@
   gtk_widget_show (checkbuttonU);
   gtk_box_pack_start (GTK_BOX (vbox2), checkbuttonU, FALSE, FALSE, 0);
 
-  checkbuttonV = gtk_check_button_new_with_mnemonic (_(&quot;Chroma V&quot;));
+  checkbuttonV = gtk_check_button_new_with_mnemonic (_(&quot;Chroma v&quot;));
   gtk_widget_show (checkbuttonV);
   gtk_box_pack_start (GTK_BOX (vbox2), checkbuttonV, FALSE, FALSE, 0);
 
+  hscale1 = gtk_hscale_new (GTK_ADJUSTMENT (gtk_adjustment_new (0, 0, 99, 1, 1, 1)));
+  gtk_widget_show (hscale1);
+  gtk_box_pack_start (GTK_BOX (vbox1), hscale1, TRUE, TRUE, 0);
+
   drawingarea1 = gtk_drawing_area_new ();
   gtk_widget_show (drawingarea1);
   gtk_box_pack_start (GTK_BOX (vbox1), drawingarea1, TRUE, TRUE, 0);
@@ -309,19 +258,16 @@
 
   dialog_action_area1 = GTK_DIALOG (dialog1)-&gt;action_area;
   gtk_widget_show (dialog_action_area1);
-  gtk_button_box_set_layout (GTK_BUTTON_BOX (dialog_action_area1),
-			     GTK_BUTTONBOX_END);
+  gtk_button_box_set_layout (GTK_BUTTON_BOX (dialog_action_area1), GTK_BUTTONBOX_END);
 
   cancelbutton1 = gtk_button_new_from_stock (&quot;gtk-cancel&quot;);
   gtk_widget_show (cancelbutton1);
-  gtk_dialog_add_action_widget (GTK_DIALOG (dialog1), cancelbutton1,
-				GTK_RESPONSE_CANCEL);
+  gtk_dialog_add_action_widget (GTK_DIALOG (dialog1), cancelbutton1, GTK_RESPONSE_CANCEL);
   GTK_WIDGET_SET_FLAGS (cancelbutton1, GTK_CAN_DEFAULT);
 
   okbutton1 = gtk_button_new_from_stock (&quot;gtk-ok&quot;);
   gtk_widget_show (okbutton1);
-  gtk_dialog_add_action_widget (GTK_DIALOG (dialog1), okbutton1,
-				GTK_RESPONSE_OK);
+  gtk_dialog_add_action_widget (GTK_DIALOG (dialog1), okbutton1, GTK_RESPONSE_OK);
   GTK_WIDGET_SET_FLAGS (okbutton1, GTK_CAN_DEFAULT);
 
   /* Store pointers to all widgets, for use by lookup_widget(). */
@@ -338,9 +284,9 @@
   GLADE_HOOKUP_OBJECT (dialog1, checkLuma, &quot;checkLuma&quot;);
   GLADE_HOOKUP_OBJECT (dialog1, checkbuttonU, &quot;checkbuttonU&quot;);
   GLADE_HOOKUP_OBJECT (dialog1, checkbuttonV, &quot;checkbuttonV&quot;);
+  GLADE_HOOKUP_OBJECT (dialog1, hscale1, &quot;hscale1&quot;);
   GLADE_HOOKUP_OBJECT (dialog1, drawingarea1, &quot;drawingarea1&quot;);
-  GLADE_HOOKUP_OBJECT_NO_REF (dialog1, dialog_action_area1,
-			      &quot;dialog_action_area1&quot;);
+  GLADE_HOOKUP_OBJECT_NO_REF (dialog1, dialog_action_area1, &quot;dialog_action_area1&quot;);
   GLADE_HOOKUP_OBJECT (dialog1, cancelbutton1, &quot;cancelbutton1&quot;);
   GLADE_HOOKUP_OBJECT (dialog1, okbutton1, &quot;okbutton1&quot;);
 

Added: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/glade/contrast2.glade
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/glade/contrast2.glade	2007-05-13 16:05:39 UTC (rev 3083)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/glade/contrast2.glade	2007-05-13 16:50:44 UTC (rev 3084)
@@ -0,0 +1,296 @@
+&lt;?xml version=&quot;1.0&quot; standalone=&quot;no&quot;?&gt; &lt;!--*- mode: xml -*--&gt;
+&lt;!DOCTYPE glade-interface SYSTEM &quot;<A HREF="http://glade.gnome.org/glade-2.0.dtd">http://glade.gnome.org/glade-2.0.dtd</A>&quot;&gt;
+
+&lt;glade-interface&gt;
+
+&lt;widget class=&quot;GtkDialog&quot; id=&quot;dialog1&quot;&gt;
+  &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+  &lt;property name=&quot;title&quot; translatable=&quot;yes&quot;&gt;Contrast&lt;/property&gt;
+  &lt;property name=&quot;type&quot;&gt;GTK_WINDOW_TOPLEVEL&lt;/property&gt;
+  &lt;property name=&quot;window_position&quot;&gt;GTK_WIN_POS_NONE&lt;/property&gt;
+  &lt;property name=&quot;modal&quot;&gt;False&lt;/property&gt;
+  &lt;property name=&quot;resizable&quot;&gt;True&lt;/property&gt;
+  &lt;property name=&quot;destroy_with_parent&quot;&gt;False&lt;/property&gt;
+  &lt;property name=&quot;decorated&quot;&gt;True&lt;/property&gt;
+  &lt;property name=&quot;skip_taskbar_hint&quot;&gt;False&lt;/property&gt;
+  &lt;property name=&quot;skip_pager_hint&quot;&gt;False&lt;/property&gt;
+  &lt;property name=&quot;type_hint&quot;&gt;GDK_WINDOW_TYPE_HINT_DIALOG&lt;/property&gt;
+  &lt;property name=&quot;gravity&quot;&gt;GDK_GRAVITY_NORTH_WEST&lt;/property&gt;
+  &lt;property name=&quot;focus_on_map&quot;&gt;True&lt;/property&gt;
+  &lt;property name=&quot;urgency_hint&quot;&gt;False&lt;/property&gt;
+  &lt;property name=&quot;has_separator&quot;&gt;True&lt;/property&gt;
+
+  &lt;child internal-child=&quot;vbox&quot;&gt;
+    &lt;widget class=&quot;GtkVBox&quot; id=&quot;dialog-vbox1&quot;&gt;
+      &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+      &lt;property name=&quot;homogeneous&quot;&gt;False&lt;/property&gt;
+      &lt;property name=&quot;spacing&quot;&gt;0&lt;/property&gt;
+
+      &lt;child internal-child=&quot;action_area&quot;&gt;
+	&lt;widget class=&quot;GtkHButtonBox&quot; id=&quot;dialog-action_area1&quot;&gt;
+	  &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+	  &lt;property name=&quot;layout_style&quot;&gt;GTK_BUTTONBOX_END&lt;/property&gt;
+
+	  &lt;child&gt;
+	    &lt;widget class=&quot;GtkButton&quot; id=&quot;cancelbutton1&quot;&gt;
+	      &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+	      &lt;property name=&quot;can_default&quot;&gt;True&lt;/property&gt;
+	      &lt;property name=&quot;can_focus&quot;&gt;True&lt;/property&gt;
+	      &lt;property name=&quot;label&quot;&gt;gtk-cancel&lt;/property&gt;
+	      &lt;property name=&quot;use_stock&quot;&gt;True&lt;/property&gt;
+	      &lt;property name=&quot;relief&quot;&gt;GTK_RELIEF_NORMAL&lt;/property&gt;
+	      &lt;property name=&quot;focus_on_click&quot;&gt;True&lt;/property&gt;
+	      &lt;property name=&quot;response_id&quot;&gt;-6&lt;/property&gt;
+	    &lt;/widget&gt;
+	  &lt;/child&gt;
+
+	  &lt;child&gt;
+	    &lt;widget class=&quot;GtkButton&quot; id=&quot;okbutton1&quot;&gt;
+	      &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+	      &lt;property name=&quot;can_default&quot;&gt;True&lt;/property&gt;
+	      &lt;property name=&quot;can_focus&quot;&gt;True&lt;/property&gt;
+	      &lt;property name=&quot;label&quot;&gt;gtk-ok&lt;/property&gt;
+	      &lt;property name=&quot;use_stock&quot;&gt;True&lt;/property&gt;
+	      &lt;property name=&quot;relief&quot;&gt;GTK_RELIEF_NORMAL&lt;/property&gt;
+	      &lt;property name=&quot;focus_on_click&quot;&gt;True&lt;/property&gt;
+	      &lt;property name=&quot;response_id&quot;&gt;-5&lt;/property&gt;
+	    &lt;/widget&gt;
+	  &lt;/child&gt;
+	&lt;/widget&gt;
+	&lt;packing&gt;
+	  &lt;property name=&quot;padding&quot;&gt;0&lt;/property&gt;
+	  &lt;property name=&quot;expand&quot;&gt;False&lt;/property&gt;
+	  &lt;property name=&quot;fill&quot;&gt;True&lt;/property&gt;
+	  &lt;property name=&quot;pack_type&quot;&gt;GTK_PACK_END&lt;/property&gt;
+	&lt;/packing&gt;
+      &lt;/child&gt;
+
+      &lt;child&gt;
+	&lt;widget class=&quot;GtkVBox&quot; id=&quot;vbox1&quot;&gt;
+	  &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+	  &lt;property name=&quot;homogeneous&quot;&gt;False&lt;/property&gt;
+	  &lt;property name=&quot;spacing&quot;&gt;0&lt;/property&gt;
+
+	  &lt;child&gt;
+	    &lt;widget class=&quot;GtkHBox&quot; id=&quot;hbox1&quot;&gt;
+	      &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+	      &lt;property name=&quot;homogeneous&quot;&gt;False&lt;/property&gt;
+	      &lt;property name=&quot;spacing&quot;&gt;0&lt;/property&gt;
+
+	      &lt;child&gt;
+		&lt;widget class=&quot;GtkVBox&quot; id=&quot;vbox3&quot;&gt;
+		  &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+		  &lt;property name=&quot;homogeneous&quot;&gt;False&lt;/property&gt;
+		  &lt;property name=&quot;spacing&quot;&gt;0&lt;/property&gt;
+
+		  &lt;child&gt;
+		    &lt;widget class=&quot;GtkLabel&quot; id=&quot;label1&quot;&gt;
+		      &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+		      &lt;property name=&quot;label&quot; translatable=&quot;yes&quot;&gt;Contrast&lt;/property&gt;
+		      &lt;property name=&quot;use_underline&quot;&gt;False&lt;/property&gt;
+		      &lt;property name=&quot;use_markup&quot;&gt;False&lt;/property&gt;
+		      &lt;property name=&quot;justify&quot;&gt;GTK_JUSTIFY_LEFT&lt;/property&gt;
+		      &lt;property name=&quot;wrap&quot;&gt;False&lt;/property&gt;
+		      &lt;property name=&quot;selectable&quot;&gt;False&lt;/property&gt;
+		      &lt;property name=&quot;xalign&quot;&gt;0.5&lt;/property&gt;
+		      &lt;property name=&quot;yalign&quot;&gt;0.5&lt;/property&gt;
+		      &lt;property name=&quot;xpad&quot;&gt;0&lt;/property&gt;
+		      &lt;property name=&quot;ypad&quot;&gt;0&lt;/property&gt;
+		      &lt;property name=&quot;ellipsize&quot;&gt;PANGO_ELLIPSIZE_NONE&lt;/property&gt;
+		      &lt;property name=&quot;width_chars&quot;&gt;-1&lt;/property&gt;
+		      &lt;property name=&quot;single_line_mode&quot;&gt;False&lt;/property&gt;
+		      &lt;property name=&quot;angle&quot;&gt;0&lt;/property&gt;
+		    &lt;/widget&gt;
+		    &lt;packing&gt;
+		      &lt;property name=&quot;padding&quot;&gt;0&lt;/property&gt;
+		      &lt;property name=&quot;expand&quot;&gt;False&lt;/property&gt;
+		      &lt;property name=&quot;fill&quot;&gt;False&lt;/property&gt;
+		    &lt;/packing&gt;
+		  &lt;/child&gt;
+
+		  &lt;child&gt;
+		    &lt;widget class=&quot;GtkHScale&quot; id=&quot;hscaleContrast&quot;&gt;
+		      &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+		      &lt;property name=&quot;can_focus&quot;&gt;True&lt;/property&gt;
+		      &lt;property name=&quot;draw_value&quot;&gt;True&lt;/property&gt;
+		      &lt;property name=&quot;value_pos&quot;&gt;GTK_POS_LEFT&lt;/property&gt;
+		      &lt;property name=&quot;digits&quot;&gt;1&lt;/property&gt;
+		      &lt;property name=&quot;update_policy&quot;&gt;GTK_UPDATE_CONTINUOUS&lt;/property&gt;
+		      &lt;property name=&quot;inverted&quot;&gt;False&lt;/property&gt;
+		      &lt;property name=&quot;adjustment&quot;&gt;1 0.5 1.5 0.1 0.1 0&lt;/property&gt;
+		    &lt;/widget&gt;
+		    &lt;packing&gt;
+		      &lt;property name=&quot;padding&quot;&gt;0&lt;/property&gt;
+		      &lt;property name=&quot;expand&quot;&gt;False&lt;/property&gt;
+		      &lt;property name=&quot;fill&quot;&gt;True&lt;/property&gt;
+		    &lt;/packing&gt;
+		  &lt;/child&gt;
+
+		  &lt;child&gt;
+		    &lt;widget class=&quot;GtkLabel&quot; id=&quot;label2&quot;&gt;
+		      &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+		      &lt;property name=&quot;label&quot; translatable=&quot;yes&quot;&gt;Brightness&lt;/property&gt;
+		      &lt;property name=&quot;use_underline&quot;&gt;False&lt;/property&gt;
+		      &lt;property name=&quot;use_markup&quot;&gt;False&lt;/property&gt;
+		      &lt;property name=&quot;justify&quot;&gt;GTK_JUSTIFY_LEFT&lt;/property&gt;
+		      &lt;property name=&quot;wrap&quot;&gt;False&lt;/property&gt;
+		      &lt;property name=&quot;selectable&quot;&gt;False&lt;/property&gt;
+		      &lt;property name=&quot;xalign&quot;&gt;0.5&lt;/property&gt;
+		      &lt;property name=&quot;yalign&quot;&gt;0.5&lt;/property&gt;
+		      &lt;property name=&quot;xpad&quot;&gt;0&lt;/property&gt;
+		      &lt;property name=&quot;ypad&quot;&gt;0&lt;/property&gt;
+		      &lt;property name=&quot;ellipsize&quot;&gt;PANGO_ELLIPSIZE_NONE&lt;/property&gt;
+		      &lt;property name=&quot;width_chars&quot;&gt;-1&lt;/property&gt;
+		      &lt;property name=&quot;single_line_mode&quot;&gt;False&lt;/property&gt;
+		      &lt;property name=&quot;angle&quot;&gt;0&lt;/property&gt;
+		    &lt;/widget&gt;
+		    &lt;packing&gt;
+		      &lt;property name=&quot;padding&quot;&gt;0&lt;/property&gt;
+		      &lt;property name=&quot;expand&quot;&gt;False&lt;/property&gt;
+		      &lt;property name=&quot;fill&quot;&gt;False&lt;/property&gt;
+		    &lt;/packing&gt;
+		  &lt;/child&gt;
+
+		  &lt;child&gt;
+		    &lt;widget class=&quot;GtkHScale&quot; id=&quot;hscaleBright&quot;&gt;
+		      &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+		      &lt;property name=&quot;can_focus&quot;&gt;True&lt;/property&gt;
+		      &lt;property name=&quot;draw_value&quot;&gt;True&lt;/property&gt;
+		      &lt;property name=&quot;value_pos&quot;&gt;GTK_POS_LEFT&lt;/property&gt;
+		      &lt;property name=&quot;digits&quot;&gt;0&lt;/property&gt;
+		      &lt;property name=&quot;update_policy&quot;&gt;GTK_UPDATE_CONTINUOUS&lt;/property&gt;
+		      &lt;property name=&quot;inverted&quot;&gt;False&lt;/property&gt;
+		      &lt;property name=&quot;adjustment&quot;&gt;0 -127 127 1 1 0&lt;/property&gt;
+		    &lt;/widget&gt;
+		    &lt;packing&gt;
+		      &lt;property name=&quot;padding&quot;&gt;0&lt;/property&gt;
+		      &lt;property name=&quot;expand&quot;&gt;False&lt;/property&gt;
+		      &lt;property name=&quot;fill&quot;&gt;True&lt;/property&gt;
+		    &lt;/packing&gt;
+		  &lt;/child&gt;
+		&lt;/widget&gt;
+		&lt;packing&gt;
+		  &lt;property name=&quot;padding&quot;&gt;0&lt;/property&gt;
+		  &lt;property name=&quot;expand&quot;&gt;True&lt;/property&gt;
+		  &lt;property name=&quot;fill&quot;&gt;True&lt;/property&gt;
+		&lt;/packing&gt;
+	      &lt;/child&gt;
+
+	      &lt;child&gt;
+		&lt;widget class=&quot;GtkVBox&quot; id=&quot;vbox2&quot;&gt;
+		  &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+		  &lt;property name=&quot;homogeneous&quot;&gt;False&lt;/property&gt;
+		  &lt;property name=&quot;spacing&quot;&gt;0&lt;/property&gt;
+
+		  &lt;child&gt;
+		    &lt;widget class=&quot;GtkCheckButton&quot; id=&quot;checkLuma&quot;&gt;
+		      &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+		      &lt;property name=&quot;can_focus&quot;&gt;True&lt;/property&gt;
+		      &lt;property name=&quot;label&quot; translatable=&quot;yes&quot;&gt;Luma&lt;/property&gt;
+		      &lt;property name=&quot;use_underline&quot;&gt;True&lt;/property&gt;
+		      &lt;property name=&quot;relief&quot;&gt;GTK_RELIEF_NORMAL&lt;/property&gt;
+		      &lt;property name=&quot;focus_on_click&quot;&gt;True&lt;/property&gt;
+		      &lt;property name=&quot;active&quot;&gt;False&lt;/property&gt;
+		      &lt;property name=&quot;inconsistent&quot;&gt;False&lt;/property&gt;
+		      &lt;property name=&quot;draw_indicator&quot;&gt;True&lt;/property&gt;
+		    &lt;/widget&gt;
+		    &lt;packing&gt;
+		      &lt;property name=&quot;padding&quot;&gt;0&lt;/property&gt;
+		      &lt;property name=&quot;expand&quot;&gt;False&lt;/property&gt;
+		      &lt;property name=&quot;fill&quot;&gt;False&lt;/property&gt;
+		    &lt;/packing&gt;
+		  &lt;/child&gt;
+
+		  &lt;child&gt;
+		    &lt;widget class=&quot;GtkCheckButton&quot; id=&quot;checkbuttonU&quot;&gt;
+		      &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+		      &lt;property name=&quot;can_focus&quot;&gt;True&lt;/property&gt;
+		      &lt;property name=&quot;label&quot; translatable=&quot;yes&quot;&gt;Chroma U&lt;/property&gt;
+		      &lt;property name=&quot;use_underline&quot;&gt;True&lt;/property&gt;
+		      &lt;property name=&quot;relief&quot;&gt;GTK_RELIEF_NORMAL&lt;/property&gt;
+		      &lt;property name=&quot;focus_on_click&quot;&gt;True&lt;/property&gt;
+		      &lt;property name=&quot;active&quot;&gt;False&lt;/property&gt;
+		      &lt;property name=&quot;inconsistent&quot;&gt;False&lt;/property&gt;
+		      &lt;property name=&quot;draw_indicator&quot;&gt;True&lt;/property&gt;
+		    &lt;/widget&gt;
+		    &lt;packing&gt;
+		      &lt;property name=&quot;padding&quot;&gt;0&lt;/property&gt;
+		      &lt;property name=&quot;expand&quot;&gt;False&lt;/property&gt;
+		      &lt;property name=&quot;fill&quot;&gt;False&lt;/property&gt;
+		    &lt;/packing&gt;
+		  &lt;/child&gt;
+
+		  &lt;child&gt;
+		    &lt;widget class=&quot;GtkCheckButton&quot; id=&quot;checkbuttonV&quot;&gt;
+		      &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+		      &lt;property name=&quot;can_focus&quot;&gt;True&lt;/property&gt;
+		      &lt;property name=&quot;label&quot; translatable=&quot;yes&quot;&gt;Chroma v&lt;/property&gt;
+		      &lt;property name=&quot;use_underline&quot;&gt;True&lt;/property&gt;
+		      &lt;property name=&quot;relief&quot;&gt;GTK_RELIEF_NORMAL&lt;/property&gt;
+		      &lt;property name=&quot;focus_on_click&quot;&gt;True&lt;/property&gt;
+		      &lt;property name=&quot;active&quot;&gt;False&lt;/property&gt;
+		      &lt;property name=&quot;inconsistent&quot;&gt;False&lt;/property&gt;
+		      &lt;property name=&quot;draw_indicator&quot;&gt;True&lt;/property&gt;
+		    &lt;/widget&gt;
+		    &lt;packing&gt;
+		      &lt;property name=&quot;padding&quot;&gt;0&lt;/property&gt;
+		      &lt;property name=&quot;expand&quot;&gt;False&lt;/property&gt;
+		      &lt;property name=&quot;fill&quot;&gt;False&lt;/property&gt;
+		    &lt;/packing&gt;
+		  &lt;/child&gt;
+		&lt;/widget&gt;
+		&lt;packing&gt;
+		  &lt;property name=&quot;padding&quot;&gt;0&lt;/property&gt;
+		  &lt;property name=&quot;expand&quot;&gt;True&lt;/property&gt;
+		  &lt;property name=&quot;fill&quot;&gt;True&lt;/property&gt;
+		&lt;/packing&gt;
+	      &lt;/child&gt;
+	    &lt;/widget&gt;
+	    &lt;packing&gt;
+	      &lt;property name=&quot;padding&quot;&gt;0&lt;/property&gt;
+	      &lt;property name=&quot;expand&quot;&gt;True&lt;/property&gt;
+	      &lt;property name=&quot;fill&quot;&gt;True&lt;/property&gt;
+	    &lt;/packing&gt;
+	  &lt;/child&gt;
+
+	  &lt;child&gt;
+	    &lt;widget class=&quot;GtkHScale&quot; id=&quot;hscale1&quot;&gt;
+	      &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+	      &lt;property name=&quot;can_focus&quot;&gt;True&lt;/property&gt;
+	      &lt;property name=&quot;draw_value&quot;&gt;True&lt;/property&gt;
+	      &lt;property name=&quot;value_pos&quot;&gt;GTK_POS_TOP&lt;/property&gt;
+	      &lt;property name=&quot;digits&quot;&gt;1&lt;/property&gt;
+	      &lt;property name=&quot;update_policy&quot;&gt;GTK_UPDATE_CONTINUOUS&lt;/property&gt;
+	      &lt;property name=&quot;inverted&quot;&gt;False&lt;/property&gt;
+	      &lt;property name=&quot;adjustment&quot;&gt;0 0 99 1 1 1&lt;/property&gt;
+	    &lt;/widget&gt;
+	    &lt;packing&gt;
+	      &lt;property name=&quot;padding&quot;&gt;0&lt;/property&gt;
+	      &lt;property name=&quot;expand&quot;&gt;True&lt;/property&gt;
+	      &lt;property name=&quot;fill&quot;&gt;True&lt;/property&gt;
+	    &lt;/packing&gt;
+	  &lt;/child&gt;
+
+	  &lt;child&gt;
+	    &lt;widget class=&quot;GtkDrawingArea&quot; id=&quot;drawingarea1&quot;&gt;
+	      &lt;property name=&quot;height_request&quot;&gt;300&lt;/property&gt;
+	      &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+	    &lt;/widget&gt;
+	    &lt;packing&gt;
+	      &lt;property name=&quot;padding&quot;&gt;0&lt;/property&gt;
+	      &lt;property name=&quot;expand&quot;&gt;True&lt;/property&gt;
+	      &lt;property name=&quot;fill&quot;&gt;True&lt;/property&gt;
+	    &lt;/packing&gt;
+	  &lt;/child&gt;
+	&lt;/widget&gt;
+	&lt;packing&gt;
+	  &lt;property name=&quot;padding&quot;&gt;0&lt;/property&gt;
+	  &lt;property name=&quot;expand&quot;&gt;True&lt;/property&gt;
+	  &lt;property name=&quot;fill&quot;&gt;True&lt;/property&gt;
+	&lt;/packing&gt;
+      &lt;/child&gt;
+    &lt;/widget&gt;
+  &lt;/child&gt;
+&lt;/widget&gt;
+
+&lt;/glade-interface&gt;

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_flyAsharp.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_flyAsharp.cpp	2007-05-13 16:05:39 UTC (rev 3083)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_flyAsharp.cpp	2007-05-13 16:50:44 UTC (rev 3084)
@@ -44,6 +44,7 @@
     process();
     _rgb-&gt;scale(_yuvBufferOut-&gt;data,_rgbBufferOut);
     display();
+    return 1;
 }
 uint8_t flyASharp::process(void)
 {
@@ -97,5 +98,6 @@
         dst+=stride;
         src+=stride;
     }
+    return 1;
 }
 //EOF

Copied: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_flyContrast.cpp (from rev 3078, branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_flyCrop.cpp)
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_flyCrop.cpp	2007-05-13 13:00:20 UTC (rev 3078)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_flyContrast.cpp	2007-05-13 16:50:44 UTC (rev 3084)
@@ -0,0 +1,62 @@
+/***************************************************************************
+                          ADM_guiContrast.cpp  -  description
+                             -------------------
+    begin                : Mon Sep 23 2002
+    copyright            : (C) 2002 by mean
+    email                : <A HREF="https://lists.berlios.de/mailman/listinfo/avidemux-svn-commit">fixounet at free.fr</A>
+ ***************************************************************************/
+
+/***************************************************************************
+ *                                                                         *
+ *   This program is free software; you can redistribute it and/or modify  *
+ *   it under the terms of the GNU General Public License as published by  *
+ *   the Free Software Foundation; either version 2 of the License, or     *
+ *   (at your option) any later version.                                   *
+ *                                                                         *
+ ***************************************************************************/
+#include &quot;config.h&quot;
+#include &lt;string.h&gt;
+#include &lt;stdio.h&gt;
+#include &lt;math.h&gt;
+#include &quot;default.h&quot;
+#include &quot;ADM_colorspace/ADM_rgb.h&quot;
+
+#include &quot;ADM_image.h&quot;
+#include &quot;ADM_video/ADM_genvideo.hxx&quot;
+#include &quot;ADM_video/ADM_vidContrast.h&quot;
+#include &quot;DIA_flyDialog.h&quot;
+#include &quot;DIA_flyContrast.h&quot;
+/************* COMMON PART *********************/
+uint8_t  flyContrast::update(void)
+{
+    download();
+    process();
+    _rgb-&gt;scale(_yuvBufferOut-&gt;data,_rgbBufferOut);
+    display();
+    return 1;
+}
+// Ugly !
+static uint8_t tableluma[256], tablechroma[256];
+
+uint8_t flyContrast::process(void)
+
+{
+  buildContrastTable (param.coef, param.offset, tableluma, tablechroma);
+
+  memcpy (_yuvBufferOut-&gt;data, _yuvBuffer-&gt;data, (_h * _w * 3)&gt;&gt;1);
+  if (param.doLuma)
+    {
+      doContrast (YPLANE(_yuvBuffer), YPLANE(_yuvBufferOut), tableluma, _w, _h);
+    }
+  if (param.doChromaU)
+    {
+      doContrast (UPLANE(_yuvBuffer), UPLANE(_yuvBufferOut), tablechroma, _w &gt;&gt; 1, _h &gt;&gt; 1);
+    }
+
+  if (param.doChromaV)
+    {
+     doContrast (VPLANE(_yuvBuffer), VPLANE(_yuvBufferOut), tablechroma, _w &gt;&gt; 1, _h &gt;&gt; 1);
+    }
+    return 1;
+}
+/************* COMMON PART *********************/

Copied: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_flyContrast.h (from rev 3073, branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_flyCrop.h)
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_flyCrop.h	2007-05-12 18:15:37 UTC (rev 3073)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_flyContrast.h	2007-05-13 16:50:44 UTC (rev 3084)
@@ -0,0 +1,22 @@
+
+
+#ifndef FLY_CONTRAST_H
+#define FLY_CONTRAST_H
+class flyContrast : public ADM_flyDialog
+{
+  
+  public:
+   CONTRAST_PARAM  param;
+  public:
+   uint8_t    process(void);
+   uint8_t    download(void);
+   uint8_t    upload(void);
+   uint8_t    update(void);
+   flyContrast (uint32_t width,uint32_t height,AVDMGenericVideoStream *in,
+                                    void *canvas, void *slider) : ADM_flyDialog(width, height,in,canvas, slider,1) 
+                    {
+                      
+                    };
+};
+
+#endif

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/Makefile.am
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/Makefile.am	2007-05-13 16:05:39 UTC (rev 3083)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/Makefile.am	2007-05-13 16:50:44 UTC (rev 3084)
@@ -6,7 +6,7 @@
 DIA_bitrateHisto.cpp DIA_prefs.cpp DIA_gototime.cpp \
 DIA_lavcodec.cpp DIA_mjpeg.cpp DIA_requant.cpp \
 DIA_audioFilter.cpp DIA_flyDialog.cpp DIA_flyCrop.cpp \
-DIA_flyAsharp.cpp DIA_flyChromaShift.cpp
+DIA_flyAsharp.cpp DIA_flyChromaShift.cpp DIA_flyContrast.cpp
 
 
 INCLUDES = $(all_includes) $(GTK_CFLAGS) $(XML_CFLAGS)  $(FREETYPE_CFLAGS) -DADM_SUBVERSION=@ADM_SUBVERSION@ \

Modified: branches/avidemux_2.4_branch/avidemux/ADM_video/ADM_vidContrast.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_video/ADM_vidContrast.cpp	2007-05-13 16:05:39 UTC (rev 3083)
+++ branches/avidemux_2.4_branch/avidemux/ADM_video/ADM_vidContrast.cpp	2007-05-13 16:50:44 UTC (rev 3084)
@@ -49,7 +49,7 @@
   static char buf[50];
 
   ADM_assert (_param);
-  sprintf ((char *) buf, &quot; contrast : %1.2f %lu&quot;, _param-&gt;coef,
+  sprintf ((char *) buf, &quot; contrast : %1.2f %d&quot;, _param-&gt;coef,
 	   _param-&gt;offset);
   return buf;
 }


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000384.html">[Avidemux-svn-commit] r3083 -	branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog
</A></li>
	<LI>Next message: <A HREF="000386.html">[Avidemux-svn-commit] r3085 -	branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec/i386
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#385">[ date ]</a>
              <a href="thread.html#385">[ thread ]</a>
              <a href="subject.html#385">[ subject ]</a>
              <a href="author.html#385">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/avidemux-svn-commit">More information about the Avidemux-svn-commit
mailing list</a><br>
</body></html>
