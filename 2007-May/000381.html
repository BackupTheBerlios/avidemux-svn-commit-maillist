<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Avidemux-svn-commit] r3080 -	branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/avidemux-svn-commit/2007-May/index.html" >
   <LINK REL="made" HREF="mailto:avidemux-svn-commit%40lists.berlios.de?Subject=Re%3A%20%5BAvidemux-svn-commit%5D%20r3080%20-%0A%09branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog&In-Reply-To=%3C200705131412.l4DECfsY024463%40sheep.berlios.de%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000380.html">
   <LINK REL="Next"  HREF="000382.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Avidemux-svn-commit] r3080 -	branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog</H1>
    <B>mean at BerliOS</B> 
    <A HREF="mailto:avidemux-svn-commit%40lists.berlios.de?Subject=Re%3A%20%5BAvidemux-svn-commit%5D%20r3080%20-%0A%09branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog&In-Reply-To=%3C200705131412.l4DECfsY024463%40sheep.berlios.de%3E"
       TITLE="[Avidemux-svn-commit] r3080 -	branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog">mean at mail.berlios.de
       </A><BR>
    <I>Sun May 13 16:12:41 CEST 2007</I>
    <P><UL>
        <LI>Previous message: <A HREF="000380.html">[Avidemux-svn-commit] r3079 - in	branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces:	ADM_GTK/ADM_dialog ADM_commonUI
</A></li>
        <LI>Next message: <A HREF="000382.html">[Avidemux-svn-commit] r3081 - in	branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces:	ADM_GTK/ADM_dialog ADM_QT4/ADM_dialog ADM_commonUI
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#381">[ date ]</a>
              <a href="thread.html#381">[ thread ]</a>
              <a href="subject.html#381">[ subject ]</a>
              <a href="author.html#381">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Author: mean
Date: 2007-05-13 16:12:37 +0200 (Sun, 13 May 2007)
New Revision: 3080

Added:
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_asharp.cpp
Modified:
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_none.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Makefile.am
Log:
flyDialog for asharp, qt version

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_none.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_none.cpp	2007-05-13 13:42:17 UTC (rev 3079)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_none.cpp	2007-05-13 14:12:37 UTC (rev 3080)
@@ -77,7 +77,6 @@
 #endif
 uint8_t DIA_animated(ANIMATED_PARAM *param){return 0;}
 uint8_t DIA_cnr2(CNR2Param *param){return 0;}
-uint8_t DIA_getASharp(ASHARP_PARAM *param, AVDMGenericVideoStream *in){return 0;}
 uint8_t DIA_getEQ2Param(Eq2_Param *param, AVDMGenericVideoStream *in){return 0;}
 uint8_t DIA_getEqualizer(EqualizerParam *param, ADMImage *image){return 0;}
 uint8_t DIA_getEqualizer(EqualizerParam *param, AVDMGenericVideoStream *in){return 0;}
@@ -105,17 +104,17 @@
 
 uint8_t DIA_about( void ){return 0;}
 void DIA_Calculator(uint32_t *sizeInMeg, uint32_t *avgBitrate ){return ;}
-uint8_t DIA_gotoTime(uint16_t *hh, uint16_t *mm, uint16_t *ss){return 0;}
+//uint8_t DIA_gotoTime(uint16_t *hh, uint16_t *mm, uint16_t *ss){return 0;}
 //int GUI_handleVFilter (void){return 0;}
 uint8_t  initFileSelector(void){return 0;}
 uint8_t initGUI( void ){return 1;}
 
 uint8_t DIA_job(uint32_t nb,char **name){return 0;}
 uint8_t DIA_lavDecoder(uint32_t *swapUv, uint32_t *showU){return 0;}
-uint8_t DIA_d3d(double *luma,double *chroma,double *temporal){return 0;}
+//uint8_t DIA_d3d(double *luma,double *chroma,double *temporal){return 0;}
 uint8_t DIA_kerneldeint(uint32_t *order, uint32_t *threshold, uint32_t *sharp, 
                           uint32_t *twoway, uint32_t *map){return 0;}
-uint8_t DIA_4entries(char *title,uint32_t *left,uint32_t *right,uint32_t *top,uint32_t *bottom) {return 0;}
+//uint8_t DIA_4entries(char *title,uint32_t *left,uint32_t *right,uint32_t *top,uint32_t *bottom) {return 0;}
 uint8_t DIA_videoCodec (SelectCodecType * codec){return 0;}
 uint8_t DIA_getChromaShift( AVDMGenericVideoStream *instream,CHROMASHIFT_PARAM    *param ){ return 0;}
 uint8_t DIA_contrast(AVDMGenericVideoStream *astream,CONTRAST_PARAM *param)  { return 0;}

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Makefile.am
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Makefile.am	2007-05-13 13:42:17 UTC (rev 3079)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Makefile.am	2007-05-13 14:12:37 UTC (rev 3080)
@@ -2,7 +2,8 @@
 noinst_LIBRARIES = libADM_dialog.a 
 libADM_dialog_a_SOURCES = DIA_busy.cpp  alert_qt4.cpp DIA_none.cpp OCR_none.cpp DIA_indexing.cpp \
 AQ_props.cpp AQ_working.cpp AQ_encoding.cpp  DIA_xvid4.cpp AQ_resizing.cpp AT_flyDialog.cpp \
-AQ_crop.cpp AT_QCanvas.cpp
+AQ_crop.cpp AT_QCanvas.cpp \
+AQ_asharp.cpp
 
 INCLUDES = $(all_includes)  $(XML_CFLAGS)  $(FREETYPE_CFLAGS) -DADM_SUBVERSION=@ADM_SUBVERSION@ \
 		-I../../../ADM_libraries/ADM_utilities \

Copied: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_asharp.cpp (from rev 3078, branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_crop.cpp)
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_crop.cpp	2007-05-13 13:00:20 UTC (rev 3078)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_asharp.cpp	2007-05-13 14:12:37 UTC (rev 3080)
@@ -0,0 +1,163 @@
+/***************************************************************************
+                          DIA_crop.cpp  -  description
+                             -------------------
+
+			    GUI for cropping including autocrop
+			    +Revisted the Gtk2 way
+			     +Autocrop now in RGB space (more accurate)
+
+    begin                : Fri May 3 2002
+    copyright            : (C) 2002/2007 by mean
+    email                : <A HREF="https://lists.berlios.de/mailman/listinfo/avidemux-svn-commit">fixounet at free.fr</A>
+ ***************************************************************************/
+
+/***************************************************************************
+ *                                                                         *
+ *   This program is free software; you can redistribute it and/or modify  *
+ *   it under the terms of the GNU General Public License as published by  *
+ *   the Free Software Foundation; either version 2 of the License, or     *
+ *   (at your option) any later version.                                   *
+ *                                                                         *
+ ***************************************************************************/
+
+#include &lt;config.h&gt;
+#include &lt;string.h&gt;
+#include &lt;stdio.h&gt;
+#include &lt;math.h&gt;
+
+#define Ui_Dialog Ui_asharpDialog
+#include &quot;ui_asharp.h&quot;
+#undef Ui_Dialog
+
+#include &quot;default.h&quot;
+#include &quot;ADM_toolkit/toolkit.hxx&quot;
+#include &quot;ADM_image.h&quot;
+#include &quot;ADM_video/ADM_genvideo.hxx&quot;
+#include &quot;ADM_colorspace/ADM_rgb.h&quot;
+#include &quot;ADM_assert.h&quot;
+#include &quot;DIA_flyDialog.h&quot;
+#include &quot;DIA_flyDialogQt4.h&quot;
+#include &quot;ADM_video/ADM_vidASharp_param.h&quot;
+#include &quot;DIA_flyAsharp.h&quot;
+
+//
+//	Video is in YV12 Colorspace
+//
+//
+class Ui_asharpWindow : public QDialog
+ {
+     Q_OBJECT
+ protected : 
+    int lock;
+ public:
+     flyASharp *myCrop;
+     ADM_QCanvas *canvas;
+     Ui_asharpWindow(ASHARP_PARAM *param,AVDMGenericVideoStream *in);
+     ~Ui_asharpWindow();
+     Ui_asharpDialog ui;
+ public slots:
+      void gather(ASHARP_PARAM *param);
+      //void update(int i);
+ private slots:
+   void sliderUpdate(int foo);
+   void valueChanged(int foo);
+
+ private:
+     
+ };
+  Ui_asharpWindow::Ui_asharpWindow(ASHARP_PARAM *param,AVDMGenericVideoStream *in)
+  {
+    uint32_t width,height;
+        ui.setupUi(this);
+        lock=0;
+        // Allocate space for green-ised video
+        width=in-&gt;getInfo()-&gt;width;
+        height=in-&gt;getInfo()-&gt;height;
+        ui.graphicsView-&gt;resize(width,height);
+        canvas=new ADM_QCanvas(ui.graphicsView,width,height);
+        
+        myCrop=new flyASharp( width, height,in,canvas,ui.horizontalSlider);
+        memcpy(&amp;(myCrop-&gt;param),param,sizeof(ASHARP_PARAM));
+        myCrop-&gt;_cookie=&ui;
+        myCrop-&gt;upload();
+        myCrop-&gt;sliderChanged();
+
+
+        connect( ui.horizontalSlider,SIGNAL(valueChanged(int)),this,SLOT(sliderUpdate(int)));
+#define SPINNER(x) connect( ui.doubleSpinBox##x,SIGNAL(valueChanged(int)),this,SLOT(valueChanged(int))); 
+          SPINNER(Treshold);
+          SPINNER(Strength);
+          SPINNER(Block);
+          connect( ui.checkBox,SIGNAL(stateChanged(int)),this,SLOT(valueChanged(int))); 
+
+  }
+  void Ui_asharpWindow::sliderUpdate(int foo)
+  {
+    myCrop-&gt;sliderChanged();
+  }
+  void Ui_asharpWindow::gather(ASHARP_PARAM *param)
+  {
+    
+        myCrop-&gt;download();
+        memcpy(param,&amp;(myCrop-&gt;param),sizeof(ASHARP_PARAM));
+  }
+Ui_asharpWindow::~Ui_asharpWindow()
+{
+  if(myCrop) delete myCrop;
+  myCrop=NULL; 
+  if(canvas) delete canvas;
+  canvas=NULL;
+}
+void Ui_asharpWindow::valueChanged( int f )
+{
+  if(lock) return;
+  lock++;
+  myCrop-&gt;update();
+  lock--;
+}
+
+#define MYSPIN(x) w-&gt;doubleSpinBox##x
+//************************
+uint8_t flyASharp::upload(void)
+{
+      Ui_asharpDialog *w=(Ui_asharpDialog *)_cookie;
+        
+        MYSPIN(Treshold)-&gt;setValue(param.t);
+        MYSPIN(Strength)-&gt;setValue(param.d);
+        MYSPIN(Block)-&gt;setValue(param.b);
+        
+        //w-&gt;bf-&gt;w-&gt;checkBox-&gt;isChecked();
+        w-&gt;checkBox-&gt;setChecked(param.bf);
+        return 1;
+}
+uint8_t flyASharp::download(void)
+{
+       Ui_asharpDialog *w=(Ui_asharpDialog *)_cookie;
+       param.t= MYSPIN(Treshold)-&gt;value();
+       param.d= MYSPIN(Strength)-&gt;value();
+       param.b= MYSPIN(Block)-&gt;value();
+       
+       //w-&gt;spinBoxBottom-&gt;setValue(bottom);
+       param.bf=w-&gt;checkBox-&gt;isChecked();
+}
+
+/**
+      \fn     DIA_getCropParams
+      \brief  Handle crop dialog
+*/
+uint8_t DIA_getASharp(ASHARP_PARAM *param, AVDMGenericVideoStream *in)
+{
+        uint8_t ret=0;
+        
+        Ui_asharpWindow dialog(param,in);        
+        if(dialog.exec()==QDialog::Accepted)
+        {
+            dialog.gather(param); 
+            ret=1;
+        }
+        return ret;
+}
+//____________________________________
+// EOF
+
+


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000380.html">[Avidemux-svn-commit] r3079 - in	branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces:	ADM_GTK/ADM_dialog ADM_commonUI
</A></li>
	<LI>Next message: <A HREF="000382.html">[Avidemux-svn-commit] r3081 - in	branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces:	ADM_GTK/ADM_dialog ADM_QT4/ADM_dialog ADM_commonUI
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#381">[ date ]</a>
              <a href="thread.html#381">[ thread ]</a>
              <a href="subject.html#381">[ subject ]</a>
              <a href="author.html#381">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/avidemux-svn-commit">More information about the Avidemux-svn-commit
mailing list</a><br>
</body></html>
