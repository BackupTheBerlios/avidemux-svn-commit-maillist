<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Avidemux-svn-commit] r3077 - in	branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces:	ADM_GTK/ADM_dialog ADM_GTK/ADM_dialogFactory	ADM_QT4/ADM_dialog ADM_commonUI
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/avidemux-svn-commit/2007-May/index.html" >
   <LINK REL="made" HREF="mailto:avidemux-svn-commit%40lists.berlios.de?Subject=Re%3A%20%5BAvidemux-svn-commit%5D%20r3077%20-%20in%0A%09branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces%3A%0A%09ADM_GTK/ADM_dialog%20ADM_GTK/ADM_dialogFactory%0A%09ADM_QT4/ADM_dialog%20ADM_commonUI&In-Reply-To=%3C200705131114.l4DBEVv3021909%40sheep.berlios.de%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000377.html">
   <LINK REL="Next"  HREF="000379.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Avidemux-svn-commit] r3077 - in	branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces:	ADM_GTK/ADM_dialog ADM_GTK/ADM_dialogFactory	ADM_QT4/ADM_dialog ADM_commonUI</H1>
    <B>mean at BerliOS</B> 
    <A HREF="mailto:avidemux-svn-commit%40lists.berlios.de?Subject=Re%3A%20%5BAvidemux-svn-commit%5D%20r3077%20-%20in%0A%09branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces%3A%0A%09ADM_GTK/ADM_dialog%20ADM_GTK/ADM_dialogFactory%0A%09ADM_QT4/ADM_dialog%20ADM_commonUI&In-Reply-To=%3C200705131114.l4DBEVv3021909%40sheep.berlios.de%3E"
       TITLE="[Avidemux-svn-commit] r3077 - in	branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces:	ADM_GTK/ADM_dialog ADM_GTK/ADM_dialogFactory	ADM_QT4/ADM_dialog ADM_commonUI">mean at mail.berlios.de
       </A><BR>
    <I>Sun May 13 13:14:31 CEST 2007</I>
    <P><UL>
        <LI>Previous message: <A HREF="000377.html">[Avidemux-svn-commit] r3076 -	branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog
</A></li>
        <LI>Next message: <A HREF="000379.html">[Avidemux-svn-commit] r3078 - in	branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces:	ADM_GTK/ADM_dialog ADM_QT4/ADM_dialog ADM_commonUI
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#378">[ date ]</a>
              <a href="thread.html#378">[ thread ]</a>
              <a href="subject.html#378">[ subject ]</a>
              <a href="author.html#378">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Author: mean
Date: 2007-05-13 13:14:30 +0200 (Sun, 13 May 2007)
New Revision: 3077

Added:
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_flyDialogQt4.h
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_crop.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/T_QCanvas.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/T_flyDialog.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/crop.ui
Removed:
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_crop.cpp
Modified:
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_flyDialog.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialogFactory/FAC_float.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_none.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Makefile.am
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_audioFilter.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_flyDialog.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_flyDialog.h
Log:
flyDialog for crop/qt

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_flyDialog.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_flyDialog.cpp	2007-05-13 09:26:00 UTC (rev 3076)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_flyDialog.cpp	2007-05-13 11:14:30 UTC (rev 3077)
@@ -58,6 +58,9 @@
   ADM_assert(_slider);
   return 1; 
 }
+uint8_t  ADM_flyDialog::isRgbInverted(void)
+{
+  return 0; 
+}
 
-
 //EOF

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialogFactory/FAC_float.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialogFactory/FAC_float.cpp	2007-05-13 09:26:00 UTC (rev 3076)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialogFactory/FAC_float.cpp	2007-05-13 11:14:30 UTC (rev 3077)
@@ -62,7 +62,7 @@
   ELEM_TYPE_FLOAT val=*(ELEM_TYPE_FLOAT *)param;
   widget = gtk_spin_button_new_with_range(min,max,0.1);
   gtk_spin_button_set_numeric (GTK_SPIN_BUTTON(widget),TRUE);
-  gtk_spin_button_set_digits  (GTK_SPIN_BUTTON(widget),2);
+  gtk_spin_button_set_digits  (GTK_SPIN_BUTTON(widget),3);
   gtk_spin_button_set_value (GTK_SPIN_BUTTON(widget),*(ELEM_TYPE_FLOAT *)param);
   
   gtk_widget_show (widget);

Deleted: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_crop.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_crop.cpp	2007-05-13 09:26:00 UTC (rev 3076)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_crop.cpp	2007-05-13 11:14:30 UTC (rev 3077)
@@ -1,434 +0,0 @@
-/***************************************************************************
-                          DIA_crop.cpp  -  description
-                             -------------------
-
-			    GUI for cropping including autocrop
-			    +Revisted the Gtk2 way
-			     +Autocrop now in RGB space (more accurate)
-
-    begin                : Fri May 3 2002
-    copyright            : (C) 2002/2007 by mean
-    email                : <A HREF="https://lists.berlios.de/mailman/listinfo/avidemux-svn-commit">fixounet at free.fr</A>
- ***************************************************************************/
-
-/***************************************************************************
- *                                                                         *
- *   This program is free software; you can redistribute it and/or modify  *
- *   it under the terms of the GNU General Public License as published by  *
- *   the Free Software Foundation; either version 2 of the License, or     *
- *   (at your option) any later version.                                   *
- *                                                                         *
- ***************************************************************************/
-
-#include &lt;config.h&gt;
-#include &lt;string.h&gt;
-#include &lt;stdio.h&gt;
-#include &lt;gdk/gdkkeysyms.h&gt;
-#include &lt;gtk/gtk.h&gt;
-
-
-#include &lt;gdk/gdkkeysyms.h&gt;
-#include &lt;gtk/gtk.h&gt;
-# include &lt;math.h&gt;
-
-#include &quot;default.h&quot;
-#include &quot;ADM_toolkit_gtk/toolkit_gtk.h&quot;
-#include &quot;ADM_toolkit_gtk/toolkit_gtk_include.h&quot;
-#include &quot;ADM_toolkit/toolkit.hxx&quot;
-
-#include &quot;ADM_image.h&quot;
-#include &quot;ADM_video/ADM_genvideo.hxx&quot;
-#include &quot;ADM_colorspace/ADM_rgb.h&quot;
-#include &quot;ADM_assert.h&quot;
-#include &quot;DIA_flyDialog.h&quot;
-#include &quot;DIA_flyCrop.h&quot;
-
-static GtkWidget	*create_dialog1 (void);
-static void 		draw (GtkWidget *dialog,uint32_t w,uint32_t h );
-
-
-/* Link between UI and core */
-static gboolean 	ui_draw( void );
-static void 		ui_autocrop (void );
-static void 		ui_reset( void );
-static void 		ui_upload(void);
-static void  		ui_read ( void);
-static void  		ui_update ( void);
-static void 		ui_frame_changed( void );
-
-static GtkWidget *dialog=NULL;
-
-/* Prevent loop when updating value */
-
-static int lock=0;
-static flyCrop *myCrop=NULL;
-//
-//	Video is in YV12 Colorspace
-//
-//
-int DIA_getCropParams(	char *name,CROP_PARAMS *param,AVDMGenericVideoStream *in)
-{
-  uint32_t width,height;
-        // Allocate space for green-ised video
-        width=in-&gt;getInfo()-&gt;width;
-        height=in-&gt;getInfo()-&gt;height;
-        
-        
-  
-        uint8_t ret=0;
-  
-        dialog=create_dialog1();
-        gtk_register_dialog(dialog);
-        
-        gtk_widget_set_usize(WID(drawingarea1), width,height);
-        gtk_window_set_title (GTK_WINDOW (dialog), name);
-        gtk_widget_show(dialog);
-	
-#define CONNECT(x,y,z) 	gtk_signal_connect(GTK_OBJECT(WID(x)), #y,GTK_SIGNAL_FUNC(z),   NULL);
-
-        CONNECT(drawingarea1,expose_event,ui_draw);
-        CONNECT(buttonAutocrop,clicked,ui_autocrop);
-        CONNECT(buttonReset,clicked,ui_reset);
-        CONNECT(scale,value_changed,ui_frame_changed);
-                              
-          gtk_dialog_add_action_widget (GTK_DIALOG (dialog), WID(buttonCancel), GTK_RESPONSE_CANCEL);
-          gtk_dialog_add_action_widget (GTK_DIALOG (dialog), WID(buttonOk),      GTK_RESPONSE_OK);
-          gtk_dialog_add_action_widget (GTK_DIALOG (dialog), WID(buttonApply),  GTK_RESPONSE_APPLY);
-
-#define CONNECT_SPIN(x) CONNECT(spinbutton##x, value_changed,ui_update)
-          
-          CONNECT_SPIN(Top);
-          CONNECT_SPIN(Left);
-          CONNECT_SPIN(Right);
-          CONNECT_SPIN(Bottom);
-          
-        myCrop=new flyCrop( width, height,in,WID(drawingarea1),WID(scale));
-        myCrop-&gt;left=param-&gt;left;
-        myCrop-&gt;right=param-&gt;right;
-        myCrop-&gt;top=param-&gt;top;
-        myCrop-&gt;bottom=param-&gt;bottom;
-        myCrop-&gt;upload();
-        myCrop-&gt;sliderChanged();
-        ret=0;
-        int response;
-        while( (response=gtk_dialog_run(GTK_DIALOG(dialog)))==GTK_RESPONSE_APPLY)
-        {
-          ui_update();
-        }
-        if(response==GTK_RESPONSE_OK)
-        {
-                ui_read( );
-                param-&gt;left=myCrop-&gt;left;
-                param-&gt;right=myCrop-&gt;right;
-                param-&gt;top=myCrop-&gt;top;
-                param-&gt;bottom=myCrop-&gt;bottom;
-                ret=1;
-        }
-        gtk_unregister_dialog(dialog);
-        gtk_widget_destroy(dialog);
-        delete myCrop;
-        return ret;
-}
-/*
-      Link GTK dialog and core
-*/
-void ui_frame_changed( void )
-{
-  myCrop-&gt;sliderChanged();
-}
-void ui_update(void)
-{
-  if(lock) return;
-  myCrop-&gt;download();
-  myCrop-&gt;process();
-  myCrop-&gt;display();
-}
-/*---------------------------------------------------------------------------
-	Actually draw the working frame on screen
-*/
-gboolean ui_draw( void )
-{
-        myCrop-&gt;display();
-}
-void ui_read (void )
-{
-        myCrop-&gt;download();
-}
-void ui_upload(void)
-{
-    myCrop-&gt;upload();
-}
-void ui_autocrop( void )
-{
-  myCrop-&gt;autocrop();
-}
-void ui_reset( void )
-{
-        myCrop-&gt;left=0;
-        myCrop-&gt;right=0;
-        myCrop-&gt;bottom=0;
-        myCrop-&gt;top=0;
-        
-	myCrop-&gt;upload();
-        myCrop-&gt;process();
-        myCrop-&gt;display();
-}
-
-/*---------------------------------------------------------------------------
-	Read entried from dialog box
-*/
-
-#define SPIN_GET(x,y) {x= gtk_spin_button_get_value_as_int(GTK_SPIN_BUTTON(WID(spinbutton##y))) ;}
-#define SPIN_SET(x,y)  {gtk_spin_button_set_value(GTK_SPIN_BUTTON(WID(spinbutton##y)),(gfloat)x) ;}
-
-
-//____________________________________
-uint8_t flyCrop::upload(void)
-{
-        lock++;
-        SPIN_SET(left,Left);
-        SPIN_SET(right,Right);
-        SPIN_SET(top,Top);
-        SPIN_SET(bottom,Bottom);
-        lock--;
-        return 1;
-}
-uint8_t flyCrop::download(void)
-{
-        int reject=0;
-        
-                        SPIN_GET(left,Left);
-                        SPIN_GET(right,Right);
-                        SPIN_GET(top,Top);
-                        SPIN_GET(bottom,Bottom);
-                        
-                        printf(&quot;%d %d %d %d\n&quot;,left,right,top,bottom);
-                        
-                        left&amp;=0xffffe;
-                        right&amp;=0xffffe;
-                        top&amp;=0xffffe;
-                        bottom&amp;=0xffffe;
-                        
-                        if((top+bottom)&gt;_h)
-                                {
-                                        top=bottom=0;
-                                        reject=1;
-                                }
-                        if((left+right)&gt;_w)
-                                {
-                                        left=right=0;
-                                        reject=1;
-                                }
-                        if(reject)
-                                upload();
-}
-// End common part
-//--------------------------------------------
-GtkWidget*
-create_dialog1 (void)
-{
-  GtkWidget *dialog1;
-  GtkWidget *dialog_vbox1;
-  GtkWidget *vbox1;
-  GtkWidget *hbuttonbox1;
-  GtkWidget *buttonCancel;
-  GtkWidget *buttonApply;
-  GtkWidget *buttonOk;
-  GtkWidget *hbuttonbox2;
-  GtkWidget *buttonAutocrop;
-  GtkWidget *buttonReset;
-  GtkWidget *alignment1;
-  GtkWidget *hbox1;
-  GtkWidget *image1;
-  GtkWidget *label1;
-  GtkWidget *table1;
-  GtkWidget *label2;
-  GtkWidget *label3;
-  GtkWidget *label4;
-  GtkWidget *label5;
-  GtkObject *spinbuttonLeft_adj;
-  GtkWidget *spinbuttonLeft;
-  GtkObject *spinbuttonTop_adj;
-  GtkWidget *spinbuttonTop;
-  GtkObject *spinbuttonBottom_adj;
-  GtkWidget *spinbuttonBottom;
-  GtkObject *spinbuttonRight_adj;
-  GtkWidget *spinbuttonRight;
-  GtkWidget *scale;
-  GtkWidget *drawingarea1;
-  GtkWidget *dialog_action_area1;
-
-  dialog1 = gtk_dialog_new ();
-  gtk_window_set_title (GTK_WINDOW (dialog1), _(&quot;Crop Settings&quot;));
-
-  dialog_vbox1 = GTK_DIALOG (dialog1)-&gt;vbox;
-  gtk_widget_show (dialog_vbox1);
-
-  vbox1 = gtk_vbox_new (FALSE, 0);
-  gtk_widget_show (vbox1);
-  gtk_box_pack_start (GTK_BOX (dialog_vbox1), vbox1, TRUE, TRUE, 0);
-
-  hbuttonbox1 = gtk_hbutton_box_new ();
-  gtk_widget_show (hbuttonbox1);
-  gtk_box_pack_start (GTK_BOX (vbox1), hbuttonbox1, FALSE, TRUE, 0);
-  gtk_button_box_set_layout (GTK_BUTTON_BOX (hbuttonbox1), GTK_BUTTONBOX_END);
-
-  buttonCancel = gtk_button_new_from_stock (&quot;gtk-cancel&quot;);
-  gtk_widget_show (buttonCancel);
-  gtk_container_add (GTK_CONTAINER (hbuttonbox1), buttonCancel);
-  GTK_WIDGET_SET_FLAGS (buttonCancel, GTK_CAN_DEFAULT);
-
-  buttonApply = gtk_button_new_from_stock (&quot;gtk-apply&quot;);
-  gtk_widget_show (buttonApply);
-  gtk_container_add (GTK_CONTAINER (hbuttonbox1), buttonApply);
-  GTK_WIDGET_SET_FLAGS (buttonApply, GTK_CAN_DEFAULT);
-
-  buttonOk = gtk_button_new_from_stock (&quot;gtk-ok&quot;);
-  gtk_widget_show (buttonOk);
-  gtk_container_add (GTK_CONTAINER (hbuttonbox1), buttonOk);
-  GTK_WIDGET_SET_FLAGS (buttonOk, GTK_CAN_DEFAULT);
-
-  hbuttonbox2 = gtk_hbutton_box_new ();
-  gtk_widget_show (hbuttonbox2);
-  gtk_box_pack_start (GTK_BOX (vbox1), hbuttonbox2, FALSE, TRUE, 0);
-  gtk_button_box_set_layout (GTK_BUTTON_BOX (hbuttonbox2), GTK_BUTTONBOX_START);
-
-  buttonAutocrop = gtk_button_new_with_mnemonic (_(&quot;AutoCrop&quot;));
-  gtk_widget_show (buttonAutocrop);
-  gtk_container_add (GTK_CONTAINER (hbuttonbox2), buttonAutocrop);
-  GTK_WIDGET_SET_FLAGS (buttonAutocrop, GTK_CAN_DEFAULT);
-
-  buttonReset = gtk_button_new ();
-  gtk_widget_show (buttonReset);
-  gtk_container_add (GTK_CONTAINER (hbuttonbox2), buttonReset);
-  GTK_WIDGET_SET_FLAGS (buttonReset, GTK_CAN_DEFAULT);
-
-  alignment1 = gtk_alignment_new (0.5, 0.5, 0, 0);
-  gtk_widget_show (alignment1);
-  gtk_container_add (GTK_CONTAINER (buttonReset), alignment1);
-
-  hbox1 = gtk_hbox_new (FALSE, 2);
-  gtk_widget_show (hbox1);
-  gtk_container_add (GTK_CONTAINER (alignment1), hbox1);
-
-  image1 = gtk_image_new_from_stock (&quot;gtk-undo&quot;, GTK_ICON_SIZE_BUTTON);
-  gtk_widget_show (image1);
-  gtk_box_pack_start (GTK_BOX (hbox1), image1, FALSE, FALSE, 0);
-
-  label1 = gtk_label_new_with_mnemonic (_(&quot;Reset&quot;));
-  gtk_widget_show (label1);
-  gtk_box_pack_start (GTK_BOX (hbox1), label1, FALSE, FALSE, 0);
-  gtk_label_set_justify (GTK_LABEL (label1), GTK_JUSTIFY_LEFT);
-
-  table1 = gtk_table_new (2, 4, FALSE);
-  gtk_widget_show (table1);
-  gtk_box_pack_start (GTK_BOX (vbox1), table1, FALSE, TRUE, 0);
-
-  label2 = gtk_label_new (_(&quot;Crop Left :&quot;));
-  gtk_widget_show (label2);
-  gtk_table_attach (GTK_TABLE (table1), label2, 0, 1, 0, 1,
-                    (GtkAttachOptions) (GTK_FILL),
-                    (GtkAttachOptions) (0), 0, 0);
-  gtk_label_set_justify (GTK_LABEL (label2), GTK_JUSTIFY_FILL);
-  gtk_misc_set_alignment (GTK_MISC (label2), 0, 0.5);
-
-  label3 = gtk_label_new (_(&quot;Crop Top:&quot;));
-  gtk_widget_show (label3);
-  gtk_table_attach (GTK_TABLE (table1), label3, 0, 1, 1, 2,
-                    (GtkAttachOptions) (GTK_FILL),
-                    (GtkAttachOptions) (0), 0, 0);
-  gtk_label_set_justify (GTK_LABEL (label3), GTK_JUSTIFY_FILL);
-  gtk_misc_set_alignment (GTK_MISC (label3), 0, 0.5);
-
-  label4 = gtk_label_new (_(&quot;Crop Right:&quot;));
-  gtk_widget_show (label4);
-  gtk_table_attach (GTK_TABLE (table1), label4, 2, 3, 0, 1,
-                    (GtkAttachOptions) (GTK_FILL),
-                    (GtkAttachOptions) (0), 0, 0);
-  gtk_label_set_justify (GTK_LABEL (label4), GTK_JUSTIFY_FILL);
-  gtk_misc_set_alignment (GTK_MISC (label4), 0, 0.5);
-
-  label5 = gtk_label_new (_(&quot;Crop Bottom:&quot;));
-  gtk_widget_show (label5);
-  gtk_table_attach (GTK_TABLE (table1), label5, 2, 3, 1, 2,
-                    (GtkAttachOptions) (GTK_FILL),
-                    (GtkAttachOptions) (0), 0, 0);
-  gtk_label_set_justify (GTK_LABEL (label5), GTK_JUSTIFY_FILL);
-  gtk_misc_set_alignment (GTK_MISC (label5), 0, 0.5);
-
-  spinbuttonLeft_adj = gtk_adjustment_new (1, 0, 1000, 1, 10, 10);
-  spinbuttonLeft = gtk_spin_button_new (GTK_ADJUSTMENT (spinbuttonLeft_adj), 1, 0);
-  gtk_widget_show (spinbuttonLeft);
-  gtk_table_attach (GTK_TABLE (table1), spinbuttonLeft, 1, 2, 0, 1,
-                    (GtkAttachOptions) (GTK_EXPAND | GTK_FILL),
-                    (GtkAttachOptions) (0), 0, 0);
-  gtk_spin_button_set_numeric (GTK_SPIN_BUTTON (spinbuttonLeft), TRUE);
-
-  spinbuttonTop_adj = gtk_adjustment_new (1, 0, 1000, 1, 10, 10);
-  spinbuttonTop = gtk_spin_button_new (GTK_ADJUSTMENT (spinbuttonTop_adj), 1, 0);
-  gtk_widget_show (spinbuttonTop);
-  gtk_table_attach (GTK_TABLE (table1), spinbuttonTop, 1, 2, 1, 2,
-                    (GtkAttachOptions) (GTK_EXPAND | GTK_FILL),
-                    (GtkAttachOptions) (0), 0, 0);
-  gtk_spin_button_set_numeric (GTK_SPIN_BUTTON (spinbuttonTop), TRUE);
-
-  spinbuttonBottom_adj = gtk_adjustment_new (1, 0, 1000, 1, 10, 10);
-  spinbuttonBottom = gtk_spin_button_new (GTK_ADJUSTMENT (spinbuttonBottom_adj), 1, 0);
-  gtk_widget_show (spinbuttonBottom);
-  gtk_table_attach (GTK_TABLE (table1), spinbuttonBottom, 3, 4, 1, 2,
-                    (GtkAttachOptions) (GTK_EXPAND | GTK_FILL),
-                    (GtkAttachOptions) (0), 0, 0);
-  gtk_spin_button_set_numeric (GTK_SPIN_BUTTON (spinbuttonBottom), TRUE);
-
-  spinbuttonRight_adj = gtk_adjustment_new (1, 0, 1000, 1, 10, 10);
-  spinbuttonRight = gtk_spin_button_new (GTK_ADJUSTMENT (spinbuttonRight_adj), 1, 0);
-  gtk_widget_show (spinbuttonRight);
-  gtk_table_attach (GTK_TABLE (table1), spinbuttonRight, 3, 4, 0, 1,
-                    (GtkAttachOptions) (GTK_EXPAND | GTK_FILL),
-                    (GtkAttachOptions) (0), 0, 0);
-  gtk_spin_button_set_numeric (GTK_SPIN_BUTTON (spinbuttonRight), TRUE);
-
-  scale = gtk_hscale_new (GTK_ADJUSTMENT (gtk_adjustment_new (0, 0, 110, 1, 10, 10)));
-  gtk_widget_show (scale);
-  gtk_box_pack_start (GTK_BOX (vbox1), scale, FALSE, TRUE, 0);
-
-  drawingarea1 = gtk_drawing_area_new ();
-  gtk_widget_show (drawingarea1);
-  gtk_box_pack_start (GTK_BOX (vbox1), drawingarea1, FALSE, TRUE, 0);
-  gtk_widget_set_size_request (drawingarea1, 100, 100);
-
-  dialog_action_area1 = GTK_DIALOG (dialog1)-&gt;action_area;
-  gtk_widget_show (dialog_action_area1);
-  gtk_button_box_set_layout (GTK_BUTTON_BOX (dialog_action_area1), GTK_BUTTONBOX_END);
-
-  /* Store pointers to all widgets, for use by lookup_widget(). */
-  GLADE_HOOKUP_OBJECT_NO_REF (dialog1, dialog1, &quot;dialog1&quot;);
-  GLADE_HOOKUP_OBJECT_NO_REF (dialog1, dialog_vbox1, &quot;dialog_vbox1&quot;);
-  GLADE_HOOKUP_OBJECT (dialog1, vbox1, &quot;vbox1&quot;);
-  GLADE_HOOKUP_OBJECT (dialog1, hbuttonbox1, &quot;hbuttonbox1&quot;);
-  GLADE_HOOKUP_OBJECT (dialog1, buttonCancel, &quot;buttonCancel&quot;);
-  GLADE_HOOKUP_OBJECT (dialog1, buttonApply, &quot;buttonApply&quot;);
-  GLADE_HOOKUP_OBJECT (dialog1, buttonOk, &quot;buttonOk&quot;);
-  GLADE_HOOKUP_OBJECT (dialog1, hbuttonbox2, &quot;hbuttonbox2&quot;);
-  GLADE_HOOKUP_OBJECT (dialog1, buttonAutocrop, &quot;buttonAutocrop&quot;);
-  GLADE_HOOKUP_OBJECT (dialog1, buttonReset, &quot;buttonReset&quot;);
-  GLADE_HOOKUP_OBJECT (dialog1, alignment1, &quot;alignment1&quot;);
-  GLADE_HOOKUP_OBJECT (dialog1, hbox1, &quot;hbox1&quot;);
-  GLADE_HOOKUP_OBJECT (dialog1, image1, &quot;image1&quot;);
-  GLADE_HOOKUP_OBJECT (dialog1, label1, &quot;label1&quot;);
-  GLADE_HOOKUP_OBJECT (dialog1, table1, &quot;table1&quot;);
-  GLADE_HOOKUP_OBJECT (dialog1, label2, &quot;label2&quot;);
-  GLADE_HOOKUP_OBJECT (dialog1, label3, &quot;label3&quot;);
-  GLADE_HOOKUP_OBJECT (dialog1, label4, &quot;label4&quot;);
-  GLADE_HOOKUP_OBJECT (dialog1, label5, &quot;label5&quot;);
-  GLADE_HOOKUP_OBJECT (dialog1, spinbuttonLeft, &quot;spinbuttonLeft&quot;);
-  GLADE_HOOKUP_OBJECT (dialog1, spinbuttonTop, &quot;spinbuttonTop&quot;);
-  GLADE_HOOKUP_OBJECT (dialog1, spinbuttonBottom, &quot;spinbuttonBottom&quot;);
-  GLADE_HOOKUP_OBJECT (dialog1, spinbuttonRight, &quot;spinbuttonRight&quot;);
-  GLADE_HOOKUP_OBJECT (dialog1, scale, &quot;scale&quot;);
-  GLADE_HOOKUP_OBJECT (dialog1, drawingarea1, &quot;drawingarea1&quot;);
-  GLADE_HOOKUP_OBJECT_NO_REF (dialog1, dialog_action_area1, &quot;dialog_action_area1&quot;);
-
-  return dialog1;
-}
-

Added: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_flyDialogQt4.h
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_flyDialogQt4.h	2007-05-13 09:26:00 UTC (rev 3076)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_flyDialogQt4.h	2007-05-13 11:14:30 UTC (rev 3077)
@@ -0,0 +1,20 @@
+#ifndef ADM_QCANVAS_H
+#define ADM_QCANVAS_H
+class  ADM_QCanvas : public QWidget
+{
+     Q_OBJECT
+     signals:
+        
+        
+   public slots:
+   public :
+         uint8_t *dataBuffer;
+  protected:
+         uint32_t _w,_h;
+  public:
+        ADM_QCanvas(QWidget *z,uint32_t w,uint32_t h)  ;
+        ~ADM_QCanvas() ;
+        void paintEvent(QPaintEvent *ev);
+};
+#endif
+

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_none.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_none.cpp	2007-05-13 09:26:00 UTC (rev 3076)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_none.cpp	2007-05-13 11:14:30 UTC (rev 3077)
@@ -70,7 +70,6 @@
 //******************************
 int DIA_coloryuv(COLOR_YUV_PARAM *param){return 0;}
 
-int DIA_getCropParams(  char *name,CROP_PARAMS *param,AVDMGenericVideoStream *in){return 0;}
 #ifdef USE_XX_XVID 
 #include &quot;xvid.h&quot;
 int  DIA_getXvidCompressParams(COMPRESSION_MODE * mode, uint32_t * qz,

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Makefile.am
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Makefile.am	2007-05-13 09:26:00 UTC (rev 3076)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Makefile.am	2007-05-13 11:14:30 UTC (rev 3077)
@@ -1,8 +1,8 @@
 
 noinst_LIBRARIES = libADM_dialog.a 
 libADM_dialog_a_SOURCES = DIA_busy.cpp  alert_qt4.cpp DIA_none.cpp OCR_none.cpp DIA_indexing.cpp \
-AQ_props.cpp AQ_working.cpp AQ_encoding.cpp  DIA_xvid4.cpp AQ_resizing.cpp DIA_flyDialog.cpp \
-DIA_crop.cpp
+AQ_props.cpp AQ_working.cpp AQ_encoding.cpp  DIA_xvid4.cpp AQ_resizing.cpp AT_flyDialog.cpp \
+AQ_crop.cpp AT_QCanvas.cpp
 
 INCLUDES = $(all_includes)  $(XML_CFLAGS)  $(FREETYPE_CFLAGS) -DADM_SUBVERSION=@ADM_SUBVERSION@ \
 		-I../../../ADM_libraries/ADM_utilities \

Copied: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_crop.cpp (from rev 3076, branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_crop.cpp)
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_crop.cpp	2007-05-13 09:26:00 UTC (rev 3076)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_crop.cpp	2007-05-13 11:14:30 UTC (rev 3077)
@@ -0,0 +1,204 @@
+/***************************************************************************
+                          DIA_crop.cpp  -  description
+                             -------------------
+
+			    GUI for cropping including autocrop
+			    +Revisted the Gtk2 way
+			     +Autocrop now in RGB space (more accurate)
+
+    begin                : Fri May 3 2002
+    copyright            : (C) 2002/2007 by mean
+    email                : <A HREF="https://lists.berlios.de/mailman/listinfo/avidemux-svn-commit">fixounet at free.fr</A>
+ ***************************************************************************/
+
+/***************************************************************************
+ *                                                                         *
+ *   This program is free software; you can redistribute it and/or modify  *
+ *   it under the terms of the GNU General Public License as published by  *
+ *   the Free Software Foundation; either version 2 of the License, or     *
+ *   (at your option) any later version.                                   *
+ *                                                                         *
+ ***************************************************************************/
+
+#include &lt;config.h&gt;
+#include &lt;string.h&gt;
+#include &lt;stdio.h&gt;
+#include &lt;math.h&gt;
+
+#define Ui_Dialog Ui_cropDialog
+#include &quot;ui_crop.h&quot;
+#undef Ui_Dialog
+
+#include &quot;default.h&quot;
+#include &quot;ADM_toolkit/toolkit.hxx&quot;
+#include &quot;ADM_image.h&quot;
+#include &quot;ADM_video/ADM_genvideo.hxx&quot;
+#include &quot;ADM_colorspace/ADM_rgb.h&quot;
+#include &quot;ADM_assert.h&quot;
+#include &quot;DIA_flyDialog.h&quot;
+#include &quot;DIA_flyDialogQt4.h&quot;
+#include &quot;DIA_flyCrop.h&quot;
+
+
+//
+//	Video is in YV12 Colorspace
+//
+//
+class Ui_cropWindow : public QDialog
+ {
+     Q_OBJECT
+ protected : 
+      
+ public:
+     flyCrop *myCrop;
+     ADM_QCanvas *canvas;
+     Ui_cropWindow(CROP_PARAMS *param,AVDMGenericVideoStream *in);
+     ~Ui_cropWindow();
+     Ui_cropDialog ui;
+ public slots:
+      void gather(CROP_PARAMS *param);
+      //void update(int i);
+ private slots:
+   void sliderUpdate(int foo);
+   void valueChanged(int foo);
+   void autoCrop( bool f );
+   void reset( bool f );
+
+ private:
+     
+ };
+  Ui_cropWindow::Ui_cropWindow(CROP_PARAMS *param,AVDMGenericVideoStream *in)
+  {
+    uint32_t width,height;
+        ui.setupUi(this);
+        
+        // Allocate space for green-ised video
+        width=in-&gt;getInfo()-&gt;width;
+        height=in-&gt;getInfo()-&gt;height;
+        ui.graphicsView-&gt;resize(width,height);
+        canvas=new ADM_QCanvas(ui.graphicsView,width,height);
+        
+        myCrop=new flyCrop( width, height,in,canvas,ui.horizontalSlider);
+        myCrop-&gt;left=param-&gt;left;
+        myCrop-&gt;right=param-&gt;right;
+        myCrop-&gt;top=param-&gt;top;
+        myCrop-&gt;bottom=param-&gt;bottom;
+        myCrop-&gt;_cookie=&ui;
+        myCrop-&gt;upload();
+        myCrop-&gt;sliderChanged();
+
+
+        connect( ui.horizontalSlider,SIGNAL(valueChanged(int)),this,SLOT(sliderUpdate(int)));
+        connect( ui.pushButtonAutoCrop,SIGNAL(clicked(bool)),this,SLOT(autoCrop(bool)));
+        connect( ui.pushButtonReset,SIGNAL(clicked(bool)),this,SLOT(reset(bool)));
+#define SPINNER(x) connect( ui.spinBox##x,SIGNAL(valueChanged(int)),this,SLOT(valueChanged(int))); 
+          SPINNER(Left);
+          SPINNER(Right);
+          SPINNER(Top);
+          SPINNER(Bottom);
+
+  }
+  void Ui_cropWindow::sliderUpdate(int foo)
+  {
+    myCrop-&gt;sliderChanged();
+  }
+  void Ui_cropWindow::gather(CROP_PARAMS *param)
+  {
+    
+        myCrop-&gt;download();
+        param-&gt;left=myCrop-&gt;left;
+        param-&gt;right=myCrop-&gt;right;
+        param-&gt;top=myCrop-&gt;top;
+        param-&gt;bottom=myCrop-&gt;bottom;
+  }
+Ui_cropWindow::~Ui_cropWindow()
+{
+  if(myCrop) delete myCrop;
+  myCrop=NULL; 
+  if(canvas) delete canvas;
+  canvas=NULL;
+}
+void Ui_cropWindow::valueChanged( int f )
+{
+  myCrop-&gt;download();
+  myCrop-&gt;process();
+  myCrop-&gt;display();
+}
+
+void Ui_cropWindow::autoCrop( bool f )
+{
+  myCrop-&gt;autocrop();
+}
+void Ui_cropWindow::reset( bool f )
+{
+         myCrop-&gt;left=0;
+         myCrop-&gt;right=0;
+         myCrop-&gt;bottom=0;
+         myCrop-&gt;top=0;
+         myCrop-&gt;upload();
+         myCrop-&gt;process();
+         myCrop-&gt;display();
+}
+
+//************************
+uint8_t flyCrop::upload(void)
+{
+      Ui_cropDialog *w=(Ui_cropDialog *)_cookie;
+      
+        w-&gt;spinBoxLeft-&gt;setValue(left);
+        w-&gt;spinBoxRight-&gt;setValue(right);
+        w-&gt;spinBoxTop-&gt;setValue(top);
+        w-&gt;spinBoxBottom-&gt;setValue(bottom);
+        return 1;
+}
+uint8_t flyCrop::download(void)
+{
+        int reject=0;
+Ui_cropDialog *w=(Ui_cropDialog *)_cookie;
+#define SPIN_GET(x,y) x=w-&gt;spinBox##y-&gt;value();
+                        SPIN_GET(left,Left);
+                        SPIN_GET(right,Right);
+                        SPIN_GET(top,Top);
+                        SPIN_GET(bottom,Bottom);
+                        
+                        printf(&quot;%d %d %d %d\n&quot;,left,right,top,bottom);
+                        
+                        left&amp;=0xffffe;
+                        right&amp;=0xffffe;
+                        top&amp;=0xffffe;
+                        bottom&amp;=0xffffe;
+                        
+                        if((top+bottom)&gt;_h)
+                                {
+                                        top=bottom=0;
+                                        reject=1;
+                                }
+                        if((left+right)&gt;_w)
+                                {
+                                        left=right=0;
+                                        reject=1;
+                                }
+                        if(reject)
+                                upload();
+}
+
+/**
+      \fn     DIA_getCropParams
+      \brief  Handle crop dialog
+*/
+int DIA_getCropParams(	char *name,CROP_PARAMS *param,AVDMGenericVideoStream *in)
+{
+        uint8_t ret=0;
+        
+        Ui_cropWindow dialog(param,in);        
+        if(dialog.exec()==QDialog::Accepted)
+        {
+            dialog.gather(param); 
+            ret=1;
+        }
+        return ret;
+}
+//____________________________________
+// EOF
+
+

Added: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/T_QCanvas.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/T_QCanvas.cpp	2007-05-13 09:26:00 UTC (rev 3076)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/T_QCanvas.cpp	2007-05-13 11:14:30 UTC (rev 3077)
@@ -0,0 +1,72 @@
+/***************************************************************************
+    copyright            : (C) 2006 by mean
+    email                : <A HREF="https://lists.berlios.de/mailman/listinfo/avidemux-svn-commit">fixounet at free.fr</A>
+***************************************************************************/
+
+/***************************************************************************
+*                                                                         *
+*   This program is free software; you can redistribute it and/or modify  *
+*   it under the terms of the GNU General Public License as published by  *
+*   the Free Software Foundation; either version 2 of the License, or     *
+*   (at your option) any later version.                                   *
+*                                                                         *
+***************************************************************************///
+
+#include &quot;config.h&quot;
+
+#include &lt;string.h&gt;
+#include &lt;stdio.h&gt;
+#include &lt;stdlib.h&gt;
+
+
+
+#include &lt;QtGui/QGraphicsView&gt;
+#include &lt;QtGui/QSlider&gt;
+
+#include &quot;default.h&quot;
+class  ADM_QCanvas : public QWidget
+{
+     Q_OBJECT
+     signals:
+        
+        
+   public slots:
+   public :
+         uint8_t *dataBuffer;
+  protected:
+         uint32_t _w,_h;
+  public:
+        ADM_QCanvas(QWidget *z,uint32_t w,uint32_t h)  ;
+        ~ADM_QCanvas() ;
+        void paintEvent(QPaintEvent *ev);
+};
+
+
+
+ADM_QCanvas::ADM_QCanvas(QWidget *z,uint32_t w,uint32_t h) : QWidget(z) 
+{
+        _w=w;
+        _h=h;
+        dataBuffer=NULL;
+        resize(w,h);
+}
+ADM_QCanvas::~ADM_QCanvas() 
+{
+}
+/**
+    \fn paintEvent( QPaintEvent *ev))
+    \brief Repaint our &quot;video&quot; widget, ignore when accelRender is on
+*/
+void ADM_QCanvas::paintEvent(QPaintEvent *ev)
+{
+    if(!dataBuffer)
+    {
+      printf(&quot;Nothing to draw\n&quot;);
+      return ;
+    }
+    QImage image(dataBuffer,_w,_h,QImage::Format_RGB32);
+      QPainter painter(this);
+      painter.drawImage(QPoint(0,0),image);
+      painter.end();
+}
+//EOF

Added: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/T_flyDialog.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/T_flyDialog.cpp	2007-05-13 09:26:00 UTC (rev 3076)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/T_flyDialog.cpp	2007-05-13 11:14:30 UTC (rev 3077)
@@ -0,0 +1,69 @@
+/***************************************************************************
+    copyright            : (C) 2006 by mean
+    email                : <A HREF="https://lists.berlios.de/mailman/listinfo/avidemux-svn-commit">fixounet at free.fr</A>
+***************************************************************************/
+
+/***************************************************************************
+*                                                                         *
+*   This program is free software; you can redistribute it and/or modify  *
+*   it under the terms of the GNU General Public License as published by  *
+*   the Free Software Foundation; either version 2 of the License, or     *
+*   (at your option) any later version.                                   *
+*                                                                         *
+***************************************************************************///
+
+#include &quot;config.h&quot;
+
+#include &lt;string.h&gt;
+#include &lt;stdio.h&gt;
+#include &lt;stdlib.h&gt;
+
+
+
+#include &lt;QtGui/QGraphicsView&gt;
+#include &lt;QtGui/QSlider&gt;
+
+#include &quot;default.h&quot;
+#include &quot;ADM_toolkit/toolkit.hxx&quot;
+#include &quot;ADM_colorspace/ADM_rgb.h&quot;
+
+#include &quot;ADM_image.h&quot;
+#include &quot;ADM_video/ADM_genvideo.hxx&quot;
+#include &quot;DIA_flyDialog.h&quot;
+#include &quot;DIA_flyDialogQt4.h&quot;
+#include &quot;ADM_assert.h&quot;
+
+
+//***************************************
+uint8_t  ADM_flyDialog::display(void)
+{
+   ADM_QCanvas *view=(ADM_QCanvas *)_canvas;
+   ADM_assert(view);
+   view-&gt;dataBuffer=_rgbBufferOut;
+   if(!_rgbBufferOut)
+   {
+      printf(&quot;flyDialog: No rgbuffer ??\n&quot;); 
+   } 
+   view-&gt;repaint();
+  return 1; 
+}
+uint32_t ADM_flyDialog::sliderGet(void)
+{
+  QSlider  *slide=(QSlider *)_slider;
+  ADM_assert(slide);
+  return slide-&gt;value();
+  
+}
+uint8_t     ADM_flyDialog::sliderSet(uint32_t value)
+{
+  QSlider  *slide=(QSlider *)_slider;
+  ADM_assert(slide);
+  slide-&gt;setValue(value);
+  return 1; 
+}
+uint8_t  ADM_flyDialog::isRgbInverted(void)
+{
+  return 1; 
+}
+
+//EOF

Added: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/crop.ui
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/crop.ui	2007-05-13 09:26:00 UTC (rev 3076)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/crop.ui	2007-05-13 11:14:30 UTC (rev 3077)
@@ -0,0 +1,133 @@
+&lt;ui version=&quot;4.0&quot; &gt;
+ &lt;class&gt;Dialog&lt;/class&gt;
+ &lt;widget class=&quot;QDialog&quot; name=&quot;Dialog&quot; &gt;
+  &lt;property name=&quot;geometry&quot; &gt;
+   &lt;rect&gt;
+    &lt;x&gt;0&lt;/x&gt;
+    &lt;y&gt;0&lt;/y&gt;
+    &lt;width&gt;400&lt;/width&gt;
+    &lt;height&gt;300&lt;/height&gt;
+   &lt;/rect&gt;
+  &lt;/property&gt;
+  &lt;property name=&quot;windowTitle&quot; &gt;
+   &lt;string&gt;Dialog&lt;/string&gt;
+  &lt;/property&gt;
+  &lt;layout class=&quot;QGridLayout&quot; &gt;
+   &lt;property name=&quot;margin&quot; &gt;
+    &lt;number&gt;9&lt;/number&gt;
+   &lt;/property&gt;
+   &lt;property name=&quot;spacing&quot; &gt;
+    &lt;number&gt;6&lt;/number&gt;
+   &lt;/property&gt;
+   &lt;item row=&quot;2&quot; column=&quot;0&quot; colspan=&quot;5&quot; &gt;
+    &lt;widget class=&quot;QSlider&quot; name=&quot;horizontalSlider&quot; &gt;
+     &lt;property name=&quot;orientation&quot; &gt;
+      &lt;enum&gt;Qt::Horizontal&lt;/enum&gt;
+     &lt;/property&gt;
+    &lt;/widget&gt;
+   &lt;/item&gt;
+   &lt;item row=&quot;3&quot; column=&quot;0&quot; colspan=&quot;5&quot; &gt;
+    &lt;widget class=&quot;QGraphicsView&quot; name=&quot;graphicsView&quot; /&gt;
+   &lt;/item&gt;
+   &lt;item row=&quot;1&quot; column=&quot;4&quot; &gt;
+    &lt;widget class=&quot;QPushButton&quot; name=&quot;pushButtonReset&quot; &gt;
+     &lt;property name=&quot;text&quot; &gt;
+      &lt;string&gt;Reset&lt;/string&gt;
+     &lt;/property&gt;
+    &lt;/widget&gt;
+   &lt;/item&gt;
+   &lt;item row=&quot;0&quot; column=&quot;0&quot; &gt;
+    &lt;widget class=&quot;QLabel&quot; name=&quot;label&quot; &gt;
+     &lt;property name=&quot;text&quot; &gt;
+      &lt;string&gt;Left:&lt;/string&gt;
+     &lt;/property&gt;
+    &lt;/widget&gt;
+   &lt;/item&gt;
+   &lt;item row=&quot;1&quot; column=&quot;0&quot; &gt;
+    &lt;widget class=&quot;QLabel&quot; name=&quot;label_4&quot; &gt;
+     &lt;property name=&quot;text&quot; &gt;
+      &lt;string&gt;Top:&lt;/string&gt;
+     &lt;/property&gt;
+    &lt;/widget&gt;
+   &lt;/item&gt;
+   &lt;item row=&quot;1&quot; column=&quot;2&quot; &gt;
+    &lt;widget class=&quot;QLabel&quot; name=&quot;label_3&quot; &gt;
+     &lt;property name=&quot;text&quot; &gt;
+      &lt;string&gt;Bottom:&lt;/string&gt;
+     &lt;/property&gt;
+    &lt;/widget&gt;
+   &lt;/item&gt;
+   &lt;item row=&quot;1&quot; column=&quot;3&quot; &gt;
+    &lt;widget class=&quot;QSpinBox&quot; name=&quot;spinBoxBottom&quot; /&gt;
+   &lt;/item&gt;
+   &lt;item row=&quot;0&quot; column=&quot;2&quot; &gt;
+    &lt;widget class=&quot;QLabel&quot; name=&quot;label_2&quot; &gt;
+     &lt;property name=&quot;text&quot; &gt;
+      &lt;string&gt;Right:&lt;/string&gt;
+     &lt;/property&gt;
+    &lt;/widget&gt;
+   &lt;/item&gt;
+   &lt;item row=&quot;0&quot; column=&quot;3&quot; &gt;
+    &lt;widget class=&quot;QSpinBox&quot; name=&quot;spinBoxRight&quot; /&gt;
+   &lt;/item&gt;
+   &lt;item row=&quot;4&quot; column=&quot;0&quot; colspan=&quot;5&quot; &gt;
+    &lt;widget class=&quot;QDialogButtonBox&quot; name=&quot;buttonBox&quot; &gt;
+     &lt;property name=&quot;orientation&quot; &gt;
+      &lt;enum&gt;Qt::Horizontal&lt;/enum&gt;
+     &lt;/property&gt;
+     &lt;property name=&quot;standardButtons&quot; &gt;
+      &lt;set&gt;QDialogButtonBox::Cancel|QDialogButtonBox::NoButton|QDialogButtonBox::Ok&lt;/set&gt;
+     &lt;/property&gt;
+    &lt;/widget&gt;
+   &lt;/item&gt;
+   &lt;item row=&quot;0&quot; column=&quot;1&quot; &gt;
+    &lt;widget class=&quot;QSpinBox&quot; name=&quot;spinBoxLeft&quot; /&gt;
+   &lt;/item&gt;
+   &lt;item row=&quot;1&quot; column=&quot;1&quot; &gt;
+    &lt;widget class=&quot;QSpinBox&quot; name=&quot;spinBoxTop&quot; /&gt;
+   &lt;/item&gt;
+   &lt;item row=&quot;0&quot; column=&quot;4&quot; &gt;
+    &lt;widget class=&quot;QPushButton&quot; name=&quot;pushButtonAutoCrop&quot; &gt;
+     &lt;property name=&quot;text&quot; &gt;
+      &lt;string&gt;AutCrop&lt;/string&gt;
+     &lt;/property&gt;
+    &lt;/widget&gt;
+   &lt;/item&gt;
+  &lt;/layout&gt;
+ &lt;/widget&gt;
+ &lt;resources/&gt;
+ &lt;connections&gt;
+  &lt;connection&gt;
+   &lt;sender&gt;buttonBox&lt;/sender&gt;
+   &lt;signal&gt;accepted()&lt;/signal&gt;
+   &lt;receiver&gt;Dialog&lt;/receiver&gt;
+   &lt;slot&gt;accept()&lt;/slot&gt;
+   &lt;hints&gt;
+    &lt;hint type=&quot;sourcelabel&quot; &gt;
+     &lt;x&gt;248&lt;/x&gt;
+     &lt;y&gt;254&lt;/y&gt;
+    &lt;/hint&gt;
+    &lt;hint type=&quot;destinationlabel&quot; &gt;
+     &lt;x&gt;157&lt;/x&gt;
+     &lt;y&gt;274&lt;/y&gt;
+    &lt;/hint&gt;
+   &lt;/hints&gt;
+  &lt;/connection&gt;
+  &lt;connection&gt;
+   &lt;sender&gt;buttonBox&lt;/sender&gt;
+   &lt;signal&gt;rejected()&lt;/signal&gt;
+   &lt;receiver&gt;Dialog&lt;/receiver&gt;
+   &lt;slot&gt;reject()&lt;/slot&gt;
+   &lt;hints&gt;
+    &lt;hint type=&quot;sourcelabel&quot; &gt;
+     &lt;x&gt;316&lt;/x&gt;
+     &lt;y&gt;260&lt;/y&gt;
+    &lt;/hint&gt;
+    &lt;hint type=&quot;destinationlabel&quot; &gt;
+     &lt;x&gt;286&lt;/x&gt;
+     &lt;y&gt;274&lt;/y&gt;
+    &lt;/hint&gt;
+   &lt;/hints&gt;
+  &lt;/connection&gt;
+ &lt;/connections&gt;
+&lt;/ui&gt;

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_audioFilter.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_audioFilter.cpp	2007-05-13 09:26:00 UTC (rev 3076)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_audioFilter.cpp	2007-05-13 11:14:30 UTC (rev 3077)
@@ -58,75 +58,62 @@
   ELEM_TYPE_FLOAT vGainValue=gain-&gt;gain10;
   vGainValue/=10.;
   //**********************************
-  diaMenuEntry menuTimeShift[]={
-  {0,_(&quot;No Timeshift&quot;)},
-  {1,_(&quot;TimeShift activated&quot;)}};
        
-   diaElemToggle    eDRC(&amp;vDRC,_(&quot;_Dynamic Range Compression:&quot;));
-   diaElemToggle    eTimeShift(&amp;vTshift,_(&quot;_TimeShift:&quot;));
-   diaElemInteger  eShift(&amp;vTshiftValue,_(&quot;TimeShift _Value:&quot;),-10000,10000);
+   diaElemToggle    eDRC(&amp;vDRC,_(&quot;_Dynamic range compression&quot;));
+   diaElemToggle    eTimeShift(&amp;vTshift,_(&quot;Enable _time shift&quot;));
+   diaElemInteger  eShift(&amp;vTshiftValue,_(&quot;Time shift _value (ms):&quot;),-10000,10000);
    
    eTimeShift.link(1,&amp;eShift);
   
-    diaElemFrame frameMisc(_(&quot;Misc&quot;));
-    frameMisc.swallow(&amp;eDRC);
-    frameMisc.swallow(&amp;eTimeShift);
-    frameMisc.swallow(&amp;eShift);
     //**********************************
    
-    diaElemToggle      eResample(&amp;vDownsample,_(&quot;_Resampling:&quot;));
-    diaElemUInteger  eResampleValue(&amp;vFreq,_(&quot;New Frequency:&quot;),6000,64000);
+    diaElemToggle      eResample(&amp;vDownsample,_(&quot;_Enable resampling&quot;));
+    diaElemUInteger  eResampleValue(&amp;vFreq,_(&quot;_Resampling frequency (Hz):&quot;),6000,64000);
   
     eResample.link(1,&amp;eResampleValue);
     
-       diaElemFrame frameResampling(_(&quot;Resampling&quot;));
-    frameResampling.swallow(&amp;eResample);
-    frameResampling.swallow(&amp;eResampleValue);
     //**********************************
     diaMenuEntry menuFPS[]={
   {FILMCONV_NONE,     _(&quot;None&quot;)},
-  {FILMCONV_FILM2PAL, _(&quot;Film to Pal&quot;)},
-  {FILMCONV_PAL2FILM, _(&quot;Pal to Film&quot;)}
+  {FILMCONV_FILM2PAL, _(&quot;Film to PAL&quot;)},
+  {FILMCONV_PAL2FILM, _(&quot;PAL to Film&quot;)}
     };
   
-   diaElemMenu      eFPS(&amp;vFilm,_(&quot;_Fps convert:&quot;),3,menuFPS);
-      diaElemFrame frameFPS(_(&quot;Framerate Change&quot;));
-    frameFPS.swallow(&amp;eFPS);
+   diaElemMenu      eFPS(&amp;vFilm,_(&quot;_Frame rate change:&quot;),3,menuFPS);
+
    //**********************************
     diaMenuEntry menuGain[]={
   {ADM_NO_GAIN,       _(&quot;None&quot;)},
   {ADM_GAIN_AUTOMATIC,_(&quot;Automatic (max -3 dB)&quot;)},
   {ADM_GAIN_MANUAL,   _(&quot;Manual&quot;)}};
   
-   diaElemMenu      eGain(&amp;vGainMode,_(&quot;Gain Mode:&quot;),3,menuGain);
+   diaElemMenu      eGain(&amp;vGainMode,_(&quot;_Gain mode:&quot;),3,menuGain);
    
-    diaElemFloat  eGainValue(&amp;vGainValue,_(&quot;_Gain Value:&quot;),-10,10);
+    diaElemFloat  eGainValue(&amp;vGainValue,_(&quot;G_ain value:&quot;),-10,10);
      eGain.link(&amp;(menuGain[2]),1,&amp;eGainValue);
    diaElemFrame frameGain(_(&quot;Gain&quot;));   
     frameGain.swallow(&amp;eGain);
     frameGain.swallow(&amp;eGainValue);
   //********************************
     diaMenuEntry menuMixer[]={
-  {CHANNEL_INVALID,     _(&quot;No Change&quot;)},
+  {CHANNEL_INVALID,     _(&quot;No change&quot;)},
   {CHANNEL_MONO,        _(&quot;Mono&quot;)},
   {CHANNEL_STEREO,      _(&quot;Stereo&quot;)},
-  {CHANNEL_2F_1R,       _(&quot;Stereo+Surround&quot;)},
-  {CHANNEL_3F,          _(&quot;Stereo+Center&quot;)},
-  {CHANNEL_3F_1R,           _(&quot;Stereo+Center+Surround&quot;)},
-  {CHANNEL_2F_2R,           _(&quot;Stereo front+Stereo Rear&quot;)},
-  {CHANNEL_3F_2R,           _(&quot;5 Channels&quot;)},
-  {CHANNEL_3F_2R_LFE,       _(&quot;5.1 &quot;)},
-  {CHANNEL_DOLBY_PROLOGIC,  _(&quot;Dolby Prologic&quot;)},
-  {CHANNEL_DOLBY_PROLOGIC2, _(&quot;Dolby Prologic II&quot;)}
+  {CHANNEL_2F_1R,       _(&quot;Stereo+surround&quot;)},
+  {CHANNEL_3F,          _(&quot;Stereo+center&quot;)},
+  {CHANNEL_3F_1R,           _(&quot;Stereo+center+surround&quot;)},
+  {CHANNEL_2F_2R,           _(&quot;Stereo front+stereo rear&quot;)},
+  {CHANNEL_3F_2R,           _(&quot;5 channels&quot;)},
+  {CHANNEL_3F_2R_LFE,       _(&quot;5.1&quot;)},
+  {CHANNEL_DOLBY_PROLOGIC,  _(&quot;Dolby Pro Logic&quot;)},
+  {CHANNEL_DOLBY_PROLOGIC2, _(&quot;Dolby Pro Logic II&quot;)}
     };
 
- diaElemMenu      eMixer(&amp;vChan,_(&quot;Mixer:&quot;),11,menuMixer);
-diaElemFrame frameMixer(_(&quot;Mixer&quot;));   
-    frameMixer.swallow(&amp;eMixer);
+ diaElemMenu      eMixer(&amp;vChan,_(&quot;_Mixer:&quot;),11,menuMixer);
  
  /************************************/
-   diaElem *elems[]={&amp;frameMisc,&amp;frameResampling,&amp;frameFPS,&amp;frameGain,&amp;frameMixer};
-  if( diaFactoryRun(_(&quot;Audio Filter Configuration&quot;),5,elems))
+ diaElem *elems[]={&amp;eDRC, &amp;eFPS, &amp;eMixer, &amp;eTimeShift, &amp;eShift, &amp;eResample, &amp;eResampleValue, &amp;frameGain};
+  if( diaFactoryRun(_(&quot;Audio Filters&quot;),8,elems))
     {
         *drc=vDRC;
         *tshifted=vTshift;

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_flyDialog.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_flyDialog.cpp	2007-05-13 09:26:00 UTC (rev 3076)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_flyDialog.cpp	2007-05-13 11:14:30 UTC (rev 3077)
@@ -41,7 +41,12 @@
   _h=height;
   _isYuvProcessing=yuv;
   _in=in;
-  _rgb=new ColYuvRgb(_w,_h);
+    if(isRgbInverted())
+    {
+        _rgb=new ColYuvRgb(_w,_h,1);
+    }
+    else
+    _rgb=new ColYuvRgb(_w,_h);
   _rgb-&gt;reset(_w,_h);
   ADM_assert(in);
   _yuvBuffer=new ADMImage(_w,_h);

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_flyDialog.h
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_flyDialog.h	2007-05-13 09:26:00 UTC (rev 3076)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_flyDialog.h	2007-05-13 11:14:30 UTC (rev 3077)
@@ -36,6 +36,7 @@
           uint8_t  *_rgbBufferOut;
           uint8_t  _isYuvProcessing;
   public:
+          void    *_cookie; // whatever
           void    *_slider; // widget
           void    *_canvas; // Drawing zone
           ColYuvRgb *_rgb;
@@ -50,7 +51,8 @@
           
           uint8_t  display(void);
           uint32_t sliderGet(void);
-          uint8_t     sliderSet(uint32_t value);
+          uint8_t  sliderSet(uint32_t value);
+          uint8_t  isRgbInverted(void);
           
           uint8_t     cleanup(void);
          /*                               */


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000377.html">[Avidemux-svn-commit] r3076 -	branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog
</A></li>
	<LI>Next message: <A HREF="000379.html">[Avidemux-svn-commit] r3078 - in	branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces:	ADM_GTK/ADM_dialog ADM_QT4/ADM_dialog ADM_commonUI
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#378">[ date ]</a>
              <a href="thread.html#378">[ thread ]</a>
              <a href="subject.html#378">[ subject ]</a>
              <a href="author.html#378">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/avidemux-svn-commit">More information about the Avidemux-svn-commit
mailing list</a><br>
</body></html>
