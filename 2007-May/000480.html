<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Avidemux-svn-commit] r3185 - in	branches/avidemux_2.4_branch/avidemux: . ADM_infoExtractor	ADM_inputs ADM_inputs/ADM_mp4 ADM_outputs	ADM_outputs/oplug_avi ADM_outputs/oplug_mp4	ADM_outputs/oplug_mpeg ADM_outputs/oplug_mpegFF	ADM_outputs/oplug_ogm
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/avidemux-svn-commit/2007-May/index.html" >
   <LINK REL="made" HREF="mailto:avidemux-svn-commit%40lists.berlios.de?Subject=Re%3A%20%5BAvidemux-svn-commit%5D%20r3185%20-%20in%0A%09branches/avidemux_2.4_branch/avidemux%3A%20.%20ADM_infoExtractor%0A%09ADM_inputs%20ADM_inputs/ADM_mp4%20ADM_outputs%0A%09ADM_outputs/oplug_avi%20ADM_outputs/oplug_mp4%0A%09ADM_outputs/oplug_mpeg%20ADM_outputs/oplug_mpegFF%0A%09ADM_outputs/oplug_ogm&In-Reply-To=%3C200705291854.l4TIsowx032695%40sheep.berlios.de%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000479.html">
   <LINK REL="Next"  HREF="000481.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Avidemux-svn-commit] r3185 - in	branches/avidemux_2.4_branch/avidemux: . ADM_infoExtractor	ADM_inputs ADM_inputs/ADM_mp4 ADM_outputs	ADM_outputs/oplug_avi ADM_outputs/oplug_mp4	ADM_outputs/oplug_mpeg ADM_outputs/oplug_mpegFF	ADM_outputs/oplug_ogm</H1>
    <B>mean at BerliOS</B> 
    <A HREF="mailto:avidemux-svn-commit%40lists.berlios.de?Subject=Re%3A%20%5BAvidemux-svn-commit%5D%20r3185%20-%20in%0A%09branches/avidemux_2.4_branch/avidemux%3A%20.%20ADM_infoExtractor%0A%09ADM_inputs%20ADM_inputs/ADM_mp4%20ADM_outputs%0A%09ADM_outputs/oplug_avi%20ADM_outputs/oplug_mp4%0A%09ADM_outputs/oplug_mpeg%20ADM_outputs/oplug_mpegFF%0A%09ADM_outputs/oplug_ogm&In-Reply-To=%3C200705291854.l4TIsowx032695%40sheep.berlios.de%3E"
       TITLE="[Avidemux-svn-commit] r3185 - in	branches/avidemux_2.4_branch/avidemux: . ADM_infoExtractor	ADM_inputs ADM_inputs/ADM_mp4 ADM_outputs	ADM_outputs/oplug_avi ADM_outputs/oplug_mp4	ADM_outputs/oplug_mpeg ADM_outputs/oplug_mpegFF	ADM_outputs/oplug_ogm">mean at mail.berlios.de
       </A><BR>
    <I>Tue May 29 20:54:50 CEST 2007</I>
    <P><UL>
        <LI>Previous message: <A HREF="000479.html">[Avidemux-svn-commit] r3184 - branches/avidemux_2.4_branch/avidemux
</A></li>
        <LI>Next message: <A HREF="000481.html">[Avidemux-svn-commit] r3186 - branches/avidemux_2.4_branch/avidemux
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#480">[ date ]</a>
              <a href="thread.html#480">[ thread ]</a>
              <a href="subject.html#480">[ subject ]</a>
              <a href="author.html#480">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Author: mean
Date: 2007-05-29 20:54:50 +0200 (Tue, 29 May 2007)
New Revision: 3185

Added:
   branches/avidemux_2.4_branch/avidemux/ADM_infoExtractor/
   branches/avidemux_2.4_branch/avidemux/ADM_infoExtractor/ADM_infoextractor.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_infoExtractor/CMakeLists.txt
Removed:
   branches/avidemux_2.4_branch/avidemux/ADM_inputs/ADM_mp4/ADM_infoextractor.cpp
Modified:
   branches/avidemux_2.4_branch/avidemux/ADM_inputs/ADM_mp4/CMakeLists.txt
   branches/avidemux_2.4_branch/avidemux/ADM_inputs/CMakeLists.txt
   branches/avidemux_2.4_branch/avidemux/ADM_outputs/CMakeLists.txt
   branches/avidemux_2.4_branch/avidemux/ADM_outputs/oplug_avi/CMakeLists.txt
   branches/avidemux_2.4_branch/avidemux/ADM_outputs/oplug_mp4/CMakeLists.txt
   branches/avidemux_2.4_branch/avidemux/ADM_outputs/oplug_mpeg/CMakeLists.txt
   branches/avidemux_2.4_branch/avidemux/ADM_outputs/oplug_mpegFF/CMakeLists.txt
   branches/avidemux_2.4_branch/avidemux/ADM_outputs/oplug_ogm/CMakeLists.txt
   branches/avidemux_2.4_branch/avidemux/CMakeLists.txt
Log:
separate build for inputs &amp; outputs

Copied: branches/avidemux_2.4_branch/avidemux/ADM_infoExtractor/ADM_infoextractor.cpp (from rev 3184, branches/avidemux_2.4_branch/avidemux/ADM_infoextractor.cpp)

Added: branches/avidemux_2.4_branch/avidemux/ADM_infoExtractor/CMakeLists.txt
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_infoExtractor/CMakeLists.txt	2007-05-29 18:30:54 UTC (rev 3184)
+++ branches/avidemux_2.4_branch/avidemux/ADM_infoExtractor/CMakeLists.txt	2007-05-29 18:54:50 UTC (rev 3185)
@@ -0,0 +1,6 @@
+
+SET(ADM_infoExtractor_SRCS 
+ADM_infoextractor.cpp
+)
+ADD_LIBRARY(ADM_infoExtractor STATIC ${ADM_infoExtractor_SRCS})
+include_directories(../ADM_inputs)

Deleted: branches/avidemux_2.4_branch/avidemux/ADM_inputs/ADM_mp4/ADM_infoextractor.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_inputs/ADM_mp4/ADM_infoextractor.cpp	2007-05-29 18:30:54 UTC (rev 3184)
+++ branches/avidemux_2.4_branch/avidemux/ADM_inputs/ADM_mp4/ADM_infoextractor.cpp	2007-05-29 18:54:50 UTC (rev 3185)
@@ -1,476 +0,0 @@
-/***************************************************************************
-                          ADM_infoextractor
-                             -------------------
-           - extract additionnal info from header (mp4/h263)                  
-**************************************************************************/
-/***************************************************************************
- *                                                                         *
- *   This program is free software; you can redistribute it and/or modify  *
- *   it under the terms of the GNU General Public License as published by  *
- *   the Free Software Foundation; either version 2 of the License, or     *
- *   (at your option) any later version.                                   *
- *                                                                         *
- ***************************************************************************/
-#include &quot;config.h&quot;
-
-#include &lt;stdio.h&gt;
-#include &lt;stdlib.h&gt;
-
-#include &lt;string.h&gt;
-
-#include &quot;math.h&quot;
-
-#include &lt;ADM_assert.h&gt;
-#include &quot;default.h&quot;
-#include &quot;ADM_editor/ADM_Video.h&quot;
-
-
-#include &quot;fourcc.h&quot;
-#include &quot;ADM_mp4/ADM_mp4.h&quot;
-#include &quot;ADM_toolkit/toolkit.hxx&quot;
-
-#include &quot;ADM_osSupport/ADM_debugID.h&quot;
-#define MODULE_NAME MODULE_3GP
-#include &quot;ADM_osSupport/ADM_debug.h&quot;
-
-extern &quot;C&quot;
-{
-#include &quot;common.h&quot;
-#include &quot;bswap.h&quot;
-#define INT_MAX (0x7FFFFFFF)
-#include &quot;ADM_lavcodec/bitstream.h&quot;
-#include &quot;ADM_lavcodec/golomb.h&quot;
-}
-static void refineH264FrameType(uint8_t *head,uint8_t *tail,uint32_t *flags);
-/*
-    Extract width &amp; height from vol header passed as arg
-
-
-*/
-uint8_t extractMpeg4Info(uint8_t *data,uint32_t dataSize,uint32_t *w,uint32_t *h,uint32_t *time_inc)
-{
-    // Search startcode
-    uint8_t b;
-    uint32_t idx=0;
-    uint32_t mw,mh;
-    uint32_t timeVal;
-    
-    //mixDump(data,dataSize);
-    //printf(&quot;\n&quot;);
-    while(1)
-    {
-        uint32_t startcode=0xffffffff;
-        while(dataSize&gt;2)
-        {
-            startcode=(startcode&lt;&lt;8)+data[idx];
-            idx++;
-            dataSize--;
-            if((startcode&amp;0xffffff)==1) break;
-        }
-        if(dataSize&gt;2)
-        {
-            //printf(&quot;Startcodec:%x\n&quot;,data[idx]);
-            if((data[idx]&amp;0xF0)==0x20) //VOL start
-            {
-                dataSize--;
-                idx++;
-#if 0
-                printf(&quot;VOL Header:\n&quot;);
-
-                if(dataSize&lt;16)
-                {
-                  mixDump(data+idx,dataSize);printf(&quot;\n&quot;);
-                }
-                else
-                {
-                  mixDump(data+idx,16);printf(&quot;\n&quot;);
-                }
-#endif
-                // Here we go !
-                GetBitContext s;
-                init_get_bits( &amp;s,data+idx, dataSize*8);
-                //
-                skip_bits1(&amp;s); // Random access
-                skip_bits(&amp;s,8); // Obj type indication
-                if(get_bits(&amp;s,1)) // VO od 
-                {
-                      skip_bits(&amp;s,4); // Ver
-                      skip_bits(&amp;s,3);  // Priority
-                }
-                if(get_bits(&amp;s,4)==15) // custom A/R
-                {
-                      skip_bits(&amp;s,8);
-                      skip_bits(&amp;s,8);
-                }
-                if(get_bits(&amp;s,1)) // Vol control param
-                {
-                      skip_bits(&amp;s,2);   //Chroma
-                      skip_bits(&amp;s,1);   // Low delay
-                      if(get_bits(&amp;s,1)) // VBV Info
-                      {
-                        skip_bits(&amp;s,16);
-                        skip_bits(&amp;s,16);
-                        skip_bits(&amp;s,16);
-                        skip_bits(&amp;s,15);
-                        skip_bits(&amp;s,16);
-                      }
-                  }
-                 skip_bits(&amp;s,2); //  Shape
-                 skip_bits(&amp;s,1); //  Marker
-                 timeVal=get_bits(&amp;s,16); // Time increment
-                 *time_inc = av_log2(timeVal - 1) + 1;
-                 if (*time_inc &lt; 1)
-                    *time_inc = 1;
-                 skip_bits(&amp;s,1); //  Marker
-                 if(get_bits(&amp;s,1)) // Fixed vop rate, compute how much bits needed
-                 {
-                     get_bits(&amp;s, *time_inc);
-                 }
-                  skip_bits(&amp;s,1); //  Marker
-                  mw=get_bits(&amp;s,13);
-                  skip_bits(&amp;s,1); //  Marker
-                  mh=get_bits(&amp;s,13);
-                // /Here we go
-                //printf(&quot;%d x %d \n&quot;,mw,mh);
-                *h=mh;
-                *w=mw;
-                return 1;;
-                // Free get bits ?
-                // WTF ?
-            }
-            continue;
-        }
-        else
-        {
-            printf(&quot;No more startcode\n&quot;);
-            // Free get bits ?
-            return 0;
-            
-        }
-    }
-    
-    return 0;
-}
-/**
-    \fn extractVopInfo
-    \brief extract info from vop : Vop type, module time base, time inc
-    
-    Warning this function expects data to start AFTER startcode, contrarily to other functions here!
-*/
-
-uint8_t extractVopInfo(uint8_t *data, uint32_t len,uint32_t timeincbits,uint32_t *vopType,uint32_t *modulo, uint32_t *time_inc,uint32_t *vopcoded)
-{
-   GetBitContext s;
-   int vop;
-   uint32_t vp,tinc;
-           init_get_bits( &amp;s,data, len*8);
-           vop=get_bits(&amp;s,2);
-           switch(vop)
-           {
-             case 0: vp=AVI_KEY_FRAME;break;
-             case 1: vp=0;break;
-             case 2: vp=AVI_B_FRAME;break;
-             case 3: vp=0;break;  // D FRAME ????
-             default:
-                printf(&quot;Unknown vop type :%d\n&quot;,vop);
-                return 0;
-           }
-           /* Read modulo */
-           int imodulo=0;
-           while (get_bits1(&amp;s) != 0)
-                  imodulo++;
-           if(!get_bits1(&amp;s))
-           {
-              printf(&quot;Wrong marker1\n&quot;);
-              return 0; 
-           }
-           
-           /* Read time */
-           tinc=get_bits(&amp;s,timeincbits);
-           /* Marker */
-            if(!get_bits1(&amp;s))
-           {
-              printf(&quot;Wrong marker2\n&quot;);
-              return 0; 
-           }
-           /* Vop coded */
-           *modulo=imodulo;
-           *vopcoded=get_bits1(&amp;s);
-           *vopType=vp;
-           *time_inc=tinc;
-           return 1;
-}
-
-/*
-        Extract H263 width &amp; height from header
-
-*/
-uint8_t extractH263Info(uint8_t *data,uint32_t dataSize,uint32_t *w,uint32_t *h)
-{
-uint32_t val;
-                GetBitContext s;
-                init_get_bits( &amp;s,data, dataSize*8);
-                
-                 mixDump(data,10);
-                 val=get_bits(&amp;s,16);
-                 if(val)
-                 {
-                    printf(&quot;incorrect H263 header sync\n&quot;);
-                    return 0;
-                 }
-                 val=get_bits(&amp;s,6);
-                 if(val!=0x20)
-                 {
-                    printf(&quot;incorrect H263 header sync (2)\n&quot;);
-                    return 0;
-                 }
-                 //
-                 skip_bits(&amp;s,8); // timestamps in 30 fps tick
-                 skip_bits(&amp;s,1); // Marker
-                 skip_bits(&amp;s,1); // Id
-                 skip_bits(&amp;s,1); // Split
-                 skip_bits(&amp;s,1); // Document Camera indicator
-                 skip_bits(&amp;s,1); // Full Picture Freeze Release
-                 val=get_bits(&amp;s,3);
-                 switch(val)
-                 {
-                   
-                    case 1: *w=128;*h=96;return 1;break;
-                    case 2: *w=176;*h=144;return 1;break;
-                    case 6:
-                    case 7:
-                            printf(&quot;H263+:Todo\n&quot;);
-                    default:
-                        printf(&quot;Invalid format\n&quot;);return 0;break;
-                 }
-                 return 0;
-}
-/**
-    \fn unescapeH264
-    \brief Remove escape stuff
-
-*/
-static uint32_t unescapeH264(uint32_t len,uint8_t *in, uint8_t *out)
-{
-  uint32_t outlen=0;
-  uint8_t *tail=in+len;
-    if(len&lt;3) return 0;
-    while(in&lt;tail-3)
-    {
-      if(!in[0]  &amp;&amp; !in[1] &amp;&amp; in[2]==3)
-      {
-        out[0]=0;
-        out[1]=0;
-        out+=2;
-        outlen+=2;
-        in+=3; 
-      }
-      *out++=*in++;
-      outlen++;
-    }
-    // copy last bytes
-    uint32_t left=tail-in;
-    memcpy(out,in,left);
-    outlen+=left;
-    return outlen;
-    
-}
-/**
-    \fn extractSPSInfo
-    \brief Extract info from H264 SPS
-    See 7.3.2.1 of 14496-10
-*/
-uint8_t extractSPSInfo(uint8_t *data, uint32_t len,uint32_t *wwidth,uint32_t *hheight)
-{
-   GetBitContext s;
-   
-   uint32_t profile,constraint,level,pic_order_cnt_type,w,h,z;
-   uint8_t buf[len];
-   uint32_t outlen;
-   uint32_t id,dum;
-   
-           outlen=unescapeH264(len,data,buf);
-           init_get_bits( &amp;s,buf, outlen*8);
-            
-           profile=get_bits(&amp;s,8);
-           constraint=get_bits(&amp;s,8)&gt;&gt;5;
-           level=get_bits(&amp;s,8);
-           id=get_ue_golomb(&amp;s); // Seq parameter set id           
-           printf(&quot;[H264]Profile : %u, Level :%u, SPSid:%u\n&quot;,profile,level,id);
-           if(profile&gt;=100) // ?? Borrowed from H264.C/FFMPEG
-           {
-              printf(&quot;[H264]Warning : High profile\n&quot;);
-              if(get_ue_golomb(&amp;s) == 3) //chroma_format_idc
-                get_bits1(&amp;s);  //residual_color_transform_flag
-            get_ue_golomb(&amp;s);  //bit_depth_luma_minus8
-            get_ue_golomb(&amp;s);  //bit_depth_chroma_minus8
-            get_bits1(&amp;s);
-            get_bits1(&amp;s); //incomplete FIXME
-           }    // /??
-           
-
-           dum=get_ue_golomb(&amp;s); // log2_max_frame_num_minus4
-           printf(&quot;[H264]Log2maxFrame-4:%u\n&quot;,dum);
-           pic_order_cnt_type=get_ue_golomb(&amp;s);
-           printf(&quot;[H264]Pic Order Cnt Type:%u\n&quot;,pic_order_cnt_type);
-           if(!pic_order_cnt_type) // pic_order_cnt_type
-           {
-              dum=get_ue_golomb(&amp;s); //log2_max_pic_order_cnt_lsb_minus4
-              printf(&quot;[H264]Log2maxPix-4:%u\n&quot;,dum);
-           }else
-           {
-             if(pic_order_cnt_type==1)
-             {
-                 get_bits1(&amp;s);   //delta_pic_order_always_zero_flag
-                 get_se_golomb(&amp;s);   //offset_for_non_ref_pic
-                 get_se_golomb(&amp;s);  // offset_for_top_to_bottom_field
-                 int i=get_ue_golomb(&amp;s);  //num_ref_frames_in_pic_order_cnt_cycle
-
-                 for(int j=0;j&lt;i;j++)
-                 {
-                      get_se_golomb(&amp;s);
-                 }
-             }else 
-             {
-               printf(&quot;Error in SPS\n&quot;);
-               return 0;
-             }
-           }
-           dum=get_ue_golomb(&amp;s);     //num_ref_frames
-           printf(&quot;[H264] # of ref frames : %u\n&quot;,dum);
-           get_bits1(&amp;s);         // gaps_in_frame_num_value_allowed_flag
-           w=get_ue_golomb(&amp;s);   //pic_width_in_mbs_minus1
-           h=get_ue_golomb(&amp;s);   //pic_height_in_mbs_minus1
-           z=get_ue_golomb(&amp;s); 
-           printf(&quot;[H264] Width in mb -1  :%d\n&quot;,w); 
-           printf(&quot;[H264] Height in mb -1 :%d\n&quot;, h);
-           printf(&quot;[H264] z               :%d\n&quot;, z);  
-            *wwidth=(w+1)*16;
-            *hheight=(h+1)*16*2; /* Fixme : frame_mbs_only_flag in slice header!! */
-
-           
-           return 1;
-}
-/**
-      \fn extractH264FrameType
-      \brief return frametype in flags (KEY_FRAME or 0). To be used only with  mkv/mp4 nal type (i.e. no startcode)
-      
-*/
-uint8_t extractH264FrameType(uint32_t nalSize,uint8_t *buffer,uint32_t len,uint32_t *flags)
-{
-  uint8_t *head=buffer, *tail=buffer+len;
-  uint8_t stream;
-#define NAL_NON_IDR       1
-#define NAL_IDR           5
-  
-  uint32_t val,hnt;  
-  
-// FIXME :  no startcode only !
-  
-  while(head+4&lt;tail)
-  {
-    
-              uint32_t length=(head[0]&lt;&lt;24) + (head[1]&lt;&lt;16) +(head[2]&lt;&lt;8)+(head[3]);
-              if(length&gt;len||length&lt;6)
-              {
-                printf(&quot;Warning , incomplete nal (%u/%u),(%0x/%0x)\n&quot;,length,len,length,len);
-                *flags=0;
-                return 0;
-              }
-              head+=4; // Skip nal lenth
-              length-=4;
-              stream=*(head++)&amp;0x1F;
-                switch(stream)
-                {
-                  case NAL_IDR: 
-                                  *flags=AVI_KEY_FRAME;
-                                  
-                                  return 1;
-                                  break; 
-                  case NAL_NON_IDR: 
-                                  refineH264FrameType(head,tail,flags);
-                                  return 1;
-                                  break;
-                  default:
-                          printf(&quot;??0x%x\n&quot;,stream);
-                          head+=length-5;
-                          continue;
-                }
-  }
-  printf(&quot;No stream\n&quot;);
-  return 0;
-}
-
-/**
-      \fn extractH264FrameType_startCode
-      \brief return frametype in flags (KEY_FRAME or 0). To be used only with  avi / mpeg TS nal type (i.e. with startcode)
-      
-*/
-uint8_t extractH264FrameType_startCode(uint32_t nalSize,uint8_t *buffer,uint32_t len,uint32_t *flags)
-{
-  uint8_t *head=buffer, *tail=buffer+len;
-  uint8_t stream;
-#define NAL_NON_IDR       1
-#define NAL_IDR           5
-#define NAL_SEI           6
-
-  uint32_t val,hnt;  
-  
-// FIXME :  no startcode only !
-  
-  while(head+4&lt;tail)
-  {
-          // Search startcode
-      
-                hnt=(head[0]&lt;&lt;24) + (head[1]&lt;&lt;16) +(head[2]&lt;&lt;8)+(head[3]);
-                head+=4;
-                while((hnt!=1) &amp;&amp; head&lt;tail)
-                {
-
-                        hnt&lt;&lt;=8;
-                        val=*head++;
-                        hnt+=val;
-                }
-                if(head&gt;=tail) break;
-                stream=*(head++) &amp;0x1f;
-                switch(stream)
-                {
-                  case NAL_IDR: 
-                                  *flags=AVI_KEY_FRAME;
-                                 // printf(&quot;IDR\n&quot;);
-                                  return 1;
-                                  break; 
-                  case NAL_NON_IDR: 
-                                  refineH264FrameType(head,tail,flags);
-                                  return 1;
-                                  break;
-                  default:
-                          printf(&quot;??0x%x\n&quot;,stream);
-                          continue;
-                }
-  }
-  printf(&quot;No stream\n&quot;);
-  return 0;
-}
-/**
-    \fn refineH264FrameType
-    \brief Try to detect B slice, warning the stream is not escaped!
-*/
-void refineH264FrameType(uint8_t *head,uint8_t *tail,uint32_t *flags)
-{
-GetBitContext s;
-uint32_t sliceType;
-            *flags=0;
-            init_get_bits(&amp;s,head, (tail-head)*8);
-            get_ue_golomb(&amp;s);
-            sliceType= get_ue_golomb(&amp;s);
-            if(sliceType &gt; 9) 
-            {
-              printf(&quot;Weird Slice %d\n&quot;,sliceType);
-              return ;
-            }
-            if(sliceType &gt; 4)
-                sliceType -= 5;
-            if(sliceType==3) *flags=AVI_B_FRAME;  
-}
-//EOF

Modified: branches/avidemux_2.4_branch/avidemux/ADM_inputs/ADM_mp4/CMakeLists.txt
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_inputs/ADM_mp4/CMakeLists.txt	2007-05-29 18:30:54 UTC (rev 3184)
+++ branches/avidemux_2.4_branch/avidemux/ADM_inputs/ADM_mp4/CMakeLists.txt	2007-05-29 18:54:50 UTC (rev 3185)
@@ -1,4 +1,5 @@
 
 SET(ADM_mp4_SRCS 
-ADM_atom.cpp  ADM_infoextractor.cpp  ADM_mp4Analyzer.cpp  ADM_mp4audio.cpp  ADM_mp4.cpp  ADM_mp4Indexer.cpp  ADM_mp4Leaf.cpp)
+ADM_atom.cpp  ADM_mp4Analyzer.cpp  ADM_mp4audio.cpp  ADM_mp4.cpp  ADM_mp4Indexer.cpp  ADM_mp4Leaf.cpp)
 ADD_LIBRARY(ADM_mp4 STATIC ${ADM_mp4_SRCS})
+include_directories(..)

Modified: branches/avidemux_2.4_branch/avidemux/ADM_inputs/CMakeLists.txt
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_inputs/CMakeLists.txt	2007-05-29 18:30:54 UTC (rev 3184)
+++ branches/avidemux_2.4_branch/avidemux/ADM_inputs/CMakeLists.txt	2007-05-29 18:54:50 UTC (rev 3185)
@@ -1,61 +1,10 @@
-SET(ADM_inputs_SRCS 
-ADM_openDML/ADM_openDML.cpp
-ADM_openDML/ADM_opendml_reorder.cpp
-ADM_openDML/ADM_odml_odml.cpp
-ADM_openDML/ADM_openDMLDepack.cpp
-ADM_openDML/ADM_riff.cpp
-ADM_openDML/ADM_odml_audio.cpp
-ADM_openDML/ADM_odml_regular.cpp
-ADM_openDML/ADM_opendml_reindex.cpp
-ADM_mp4/ADM_mp4Indexer.cpp
-ADM_mp4/ADM_atom.cpp
-ADM_mp4/ADM_mp4.cpp
-ADM_mp4/ADM_mp4audio.cpp
-ADM_mp4/ADM_mp4Analyzer.cpp
-ADM_mp4/ADM_infoextractor.cpp
-ADM_mp4/ADM_mp4Leaf.cpp
-ADM_matroska/ADM_mkv.cpp
-ADM_matroska/ADM_mkv_audio.cpp
-ADM_matroska/ebml.cpp
-ADM_matroska/ADM_mkvTrackType.cpp
-ADM_matroska/ADM_mkvEntries.cpp
-ADM_matroska/mkv_tags.cpp
-ADM_matroska/ADM_mkvIndexer.cpp
-ADM_h263/ADM_mp4.cpp
-ADM_h263/ADM_h263.cpp
-ADM_h263/bitsRead.cpp
-ADM_mpegdemuxer/dmx_indexer_mpeg2.cpp
-ADM_mpegdemuxer/dmx_indexer.cpp
-ADM_mpegdemuxer/dmx_demuxerES.cpp
-ADM_mpegdemuxer/dmx_audio.cpp
-ADM_mpegdemuxer/dmx_indexer_h264.cpp
-ADM_mpegdemuxer/dmx_video.cpp
-ADM_mpegdemuxer/dmx_io.cpp
-ADM_mpegdemuxer/dmx_probe.cpp
-ADM_mpegdemuxer/dmx_demuxer.cpp
-ADM_mpegdemuxer/dmx_identify.cpp
-ADM_mpegdemuxer/dmx_demuxerPS.cpp
-ADM_mpegdemuxer/dmx_probeTS.cpp
-ADM_mpegdemuxer/dmx_demuxerTS.cpp
-ADM_mpegdemuxer/dmx_demuxerMSDVR.cpp
-ADM_ogm/ADM_ogm.cpp
-ADM_ogm/ADM_ogmpages.cpp
-ADM_ogm/ADM_ogmAudio.cpp
-ADM_ogm/ADM_ogmreorder.cpp
-ADM_inpics/ADM_pics.cpp
-ADM_nuv/minilzo.c
-ADM_nuv/RTjpeg.c
-ADM_nuv/RTjpegN.cpp
-ADM_nuv/ADM_nuvAudio.cpp
-ADM_nuv/ADM_nuv.cpp
-ADM_nuv/RToldformat.cpp
-ADM_asf/ADM_asfPacket.cpp
-ADM_asf/ADM_asfChunk.cpp
-ADM_asf/ADM_asf.cpp
-ADM_asf/ADM_asf_audio.cpp
-ADM_avsproxy/ADM_avsproxy_net.cpp
-ADM_avsproxy/ADM_avsproxy.cpp
-)
-ADD_LIBRARY(ADM_inputs STATIC ${ADM_inputs_SRCS})
-include_directories(./ )
-
+subdirs (PREORDER ADM_asf)
+subdirs (PREORDER ADM_avsproxy)
+subdirs (PREORDER ADM_h263)
+subdirs (PREORDER ADM_inpics)
+subdirs (PREORDER ADM_matroska)
+subdirs (PREORDER ADM_mp4)
+subdirs (PREORDER ADM_mpegdemuxer)
+subdirs (PREORDER ADM_nuv)
+subdirs (PREORDER ADM_ogm)
+subdirs (PREORDER ADM_openDML)

Modified: branches/avidemux_2.4_branch/avidemux/ADM_outputs/CMakeLists.txt
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_outputs/CMakeLists.txt	2007-05-29 18:30:54 UTC (rev 3184)
+++ branches/avidemux_2.4_branch/avidemux/ADM_outputs/CMakeLists.txt	2007-05-29 18:54:50 UTC (rev 3185)
@@ -1,22 +1,6 @@
-SET(ADM_outputs_SRCS 
-oplug_avi/op_avisavedual.cpp
-oplug_avi/op_savesmart.cpp
-oplug_avi/avilist.cpp
-oplug_avi/op_avisavecopy_pack.cpp
-oplug_avi/op_avisavecopy.cpp
-oplug_avi/op_aviwrite.cpp
-oplug_avi/op_avisavecopy_unpack.cpp
-oplug_avi/op_saveprocess.cpp
-oplug_avi/op_avisave.cpp
-oplug_mp4/oplug_mp4.cpp
-oplug_ogm/op_ogpage.cpp
-oplug_ogm/op_ogsaveprocess.cpp
-oplug_ogm/op_ogsave.cpp
-oplug_ogm/op_ogaudio.cpp
-oplug_ogm/op_ogsavecopy.cpp
-oplug_mpegFF/oplug_vcdff.cpp
-oplug_mpeg/op_mpegpass.cpp
-)
-ADD_LIBRARY(ADM_outputs STATIC ${ADM_outputs_SRCS})
-include_directories(./ ../ADM_inputs )
+subdirs (PREORDER oplug_avi)
+subdirs (PREORDER oplug_mp4)
+subdirs (PREORDER oplug_mpeg)
+subdirs (PREORDER oplug_mpegFF)
+subdirs (PREORDER oplug_ogm)
 

Modified: branches/avidemux_2.4_branch/avidemux/ADM_outputs/oplug_avi/CMakeLists.txt
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_outputs/oplug_avi/CMakeLists.txt	2007-05-29 18:30:54 UTC (rev 3184)
+++ branches/avidemux_2.4_branch/avidemux/ADM_outputs/oplug_avi/CMakeLists.txt	2007-05-29 18:54:50 UTC (rev 3185)
@@ -3,4 +3,4 @@
 avilist.cpp         op_avisavecopy_pack.cpp    op_avisave.cpp      op_aviwrite.cpp     op_savesmart.cpp
 op_avisavecopy.cpp  op_avisavecopy_unpack.cpp  op_avisavedual.cpp  op_saveprocess.cpp
 )
-ADD_LIBRARY(ADM_oplug_avi STATIC ${ADM_oplug_avi_SRCS})
+ADD_LIBRARY(oplug_avi STATIC ${ADM_oplug_avi_SRCS})

Modified: branches/avidemux_2.4_branch/avidemux/ADM_outputs/oplug_mp4/CMakeLists.txt
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_outputs/oplug_mp4/CMakeLists.txt	2007-05-29 18:30:54 UTC (rev 3184)
+++ branches/avidemux_2.4_branch/avidemux/ADM_outputs/oplug_mp4/CMakeLists.txt	2007-05-29 18:54:50 UTC (rev 3185)
@@ -1,3 +1,3 @@
 
 SET(ADM_oplug_mp4_SRCS oplug_mp4.cpp)
-ADD_LIBRARY(ADM_oplug_mp4 STATIC ${ADM_oplug_mp4_SRCS})
+ADD_LIBRARY(oplug_mp4 STATIC ${ADM_oplug_mp4_SRCS})

Modified: branches/avidemux_2.4_branch/avidemux/ADM_outputs/oplug_mpeg/CMakeLists.txt
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_outputs/oplug_mpeg/CMakeLists.txt	2007-05-29 18:30:54 UTC (rev 3184)
+++ branches/avidemux_2.4_branch/avidemux/ADM_outputs/oplug_mpeg/CMakeLists.txt	2007-05-29 18:54:50 UTC (rev 3185)
@@ -2,4 +2,5 @@
 SET(ADM_oplug_mpeg_SRCS 
 op_mpegpass.cpp
 )
-ADD_LIBRARY(ADM_oplug_mpeg STATIC ${ADM_oplug_mpeg_SRCS})
+ADD_LIBRARY(oplug_mpeg STATIC ${ADM_oplug_mpeg_SRCS})
+include_directories(../../ADM_inputs)

Modified: branches/avidemux_2.4_branch/avidemux/ADM_outputs/oplug_mpegFF/CMakeLists.txt
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_outputs/oplug_mpegFF/CMakeLists.txt	2007-05-29 18:30:54 UTC (rev 3184)
+++ branches/avidemux_2.4_branch/avidemux/ADM_outputs/oplug_mpegFF/CMakeLists.txt	2007-05-29 18:54:50 UTC (rev 3185)
@@ -2,4 +2,4 @@
 SET(ADM_oplug_mpegFF_SRCS 
 oplug_vcdff.cpp
 )
-ADD_LIBRARY(ADM_oplug_mpegFF STATIC ${ADM_oplug_mpegFF_SRCS})
+ADD_LIBRARY(oplug_mpegFF STATIC ${ADM_oplug_mpegFF_SRCS})

Modified: branches/avidemux_2.4_branch/avidemux/ADM_outputs/oplug_ogm/CMakeLists.txt
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_outputs/oplug_ogm/CMakeLists.txt	2007-05-29 18:30:54 UTC (rev 3184)
+++ branches/avidemux_2.4_branch/avidemux/ADM_outputs/oplug_ogm/CMakeLists.txt	2007-05-29 18:54:50 UTC (rev 3185)
@@ -2,4 +2,6 @@
 SET(ADM_oplug_ogm_SRCS 
 op_ogaudio.cpp  op_ogpage.cpp  op_ogsavecopy.cpp  op_ogsave.cpp  op_ogsaveprocess.cpp
 )
-ADD_LIBRARY(ADM_oplug_ogm STATIC ${ADM_oplug_ogm_SRCS})
+ADD_LIBRARY(oplug_ogm STATIC ${ADM_oplug_ogm_SRCS})
+include_directories(../../ADM_inputs)
+

Modified: branches/avidemux_2.4_branch/avidemux/CMakeLists.txt
===================================================================
--- branches/avidemux_2.4_branch/avidemux/CMakeLists.txt	2007-05-29 18:30:54 UTC (rev 3184)
+++ branches/avidemux_2.4_branch/avidemux/CMakeLists.txt	2007-05-29 18:54:50 UTC (rev 3185)
@@ -43,14 +43,6 @@
 ADM_colorspace 
 ADM_audiodevice
 ADM_ocr  
-
-ADM_outputs
-ADM_inputs
-ADM_encoder
-ADM_codecs
-ADM_requant 
-ADM_toolkit  
-ADM_osSupport  
 )
 
 
@@ -74,8 +66,64 @@
 subdirs (PREORDER ${_current})
 add_libs_all_targets(${_current})
 ENDFOREACH(_current ${ADM_SUBDIR})
+# build trail
+subdirs (PREORDER ADM_osSupport)
+subdirs (PREORDER ADM_encoder)
+subdirs (PREORDER ADM_toolkit)
+subdirs (PREORDER ADM_codecs)
+subdirs (PREORDER ADM_requant)
+subdirs (PREORDER ADM_infoExtractor)
+###########################################
+# Construct ADM_outputs
+###########################################
+subdirs (PREORDER ADM_outputs)
+LINK_DIRECTORIES(ADM_outputs)
+SET(ADM_outputs
+oplug_avi
+oplug_mp4
+oplug_mpeg
+oplug_mpegFF
+oplug_ogm
+)
 
+FOREACH(_current ${ADM_outputs})
+add_libs_all_targets(${_current})
+ENDFOREACH(_current ${ADM_outputs})
 ###########################################
+# Construct ADM_inputs
+###########################################
+subdirs (PREORDER ADM_inputs)
+LINK_DIRECTORIES(ADM_inputs)
+SET(ADM_inputs
+ADM_asf
+ADM_avsproxy
+ADM_h263
+ADM_inpics
+ADM_matroska
+ADM_mp4
+ADM_mpegdemuxer
+ADM_nuv
+ADM_ogm
+ADM_openDML
+)
+
+FOREACH(_current ${ADM_inputs})
+add_libs_all_targets(${_current})
+ENDFOREACH(_current ${ADM_inputs})
+
+#########################################
+# Trails
+#########################################
+
+
+add_libs_all_targets(ADM_toolkit)
+add_libs_all_targets(ADM_osSupport)
+add_libs_all_targets(ADM_encoder)
+add_libs_all_targets(ADM_codecs)
+add_libs_all_targets(ADM_requant)
+add_libs_all_targets(ADM_infoExtractor)
+
+###########################################
 # Construct ADM_libraries
 ###########################################
 subdirs (PREORDER ADM_libraries)


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000479.html">[Avidemux-svn-commit] r3184 - branches/avidemux_2.4_branch/avidemux
</A></li>
	<LI>Next message: <A HREF="000481.html">[Avidemux-svn-commit] r3186 - branches/avidemux_2.4_branch/avidemux
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#480">[ date ]</a>
              <a href="thread.html#480">[ thread ]</a>
              <a href="subject.html#480">[ subject ]</a>
              <a href="author.html#480">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/avidemux-svn-commit">More information about the Avidemux-svn-commit
mailing list</a><br>
</body></html>
