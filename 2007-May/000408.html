<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Avidemux-svn-commit] r3113 - in	branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces:	ADM_GTK/ADM_dialogFactory ADM_NONE/ADM_dialogFactory	ADM_QT4/ADM_dialogFactory ADM_QT4/ADM_filters ADM_QT4/ADM_gui	ADM_commonUI
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/avidemux-svn-commit/2007-May/index.html" >
   <LINK REL="made" HREF="mailto:avidemux-svn-commit%40lists.berlios.de?Subject=Re%3A%20%5BAvidemux-svn-commit%5D%20r3113%20-%20in%0A%09branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces%3A%0A%09ADM_GTK/ADM_dialogFactory%20ADM_NONE/ADM_dialogFactory%0A%09ADM_QT4/ADM_dialogFactory%20ADM_QT4/ADM_filters%20ADM_QT4/ADM_gui%0A%09ADM_commonUI&In-Reply-To=%3C200705181610.l4IGAXPd030762%40sheep.berlios.de%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000407.html">
   <LINK REL="Next"  HREF="000409.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Avidemux-svn-commit] r3113 - in	branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces:	ADM_GTK/ADM_dialogFactory ADM_NONE/ADM_dialogFactory	ADM_QT4/ADM_dialogFactory ADM_QT4/ADM_filters ADM_QT4/ADM_gui	ADM_commonUI</H1>
    <B>mean at BerliOS</B> 
    <A HREF="mailto:avidemux-svn-commit%40lists.berlios.de?Subject=Re%3A%20%5BAvidemux-svn-commit%5D%20r3113%20-%20in%0A%09branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces%3A%0A%09ADM_GTK/ADM_dialogFactory%20ADM_NONE/ADM_dialogFactory%0A%09ADM_QT4/ADM_dialogFactory%20ADM_QT4/ADM_filters%20ADM_QT4/ADM_gui%0A%09ADM_commonUI&In-Reply-To=%3C200705181610.l4IGAXPd030762%40sheep.berlios.de%3E"
       TITLE="[Avidemux-svn-commit] r3113 - in	branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces:	ADM_GTK/ADM_dialogFactory ADM_NONE/ADM_dialogFactory	ADM_QT4/ADM_dialogFactory ADM_QT4/ADM_filters ADM_QT4/ADM_gui	ADM_commonUI">mean at mail.berlios.de
       </A><BR>
    <I>Fri May 18 18:10:33 CEST 2007</I>
    <P><UL>
        <LI>Previous message: <A HREF="000407.html">[Avidemux-svn-commit] r3112 -	branches/avidemux_2.4_branch/autononreg/dialogFactory
</A></li>
        <LI>Next message: <A HREF="000409.html">[Avidemux-svn-commit] r3114 - in	branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4:	ADM_dialog ADM_filters
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#408">[ date ]</a>
              <a href="thread.html#408">[ thread ]</a>
              <a href="subject.html#408">[ subject ]</a>
              <a href="author.html#408">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Author: mean
Date: 2007-05-18 18:10:31 +0200 (Fri, 18 May 2007)
New Revision: 3113

Added:
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialogFactory/FAC_button.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialogFactory/T_button.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/ADM_qslider.h
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/T_qslider.cpp
Modified:
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialogFactory/Makefile.am
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_NONE/ADM_dialogFactory/FAC_toggle.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialogFactory/FAC_menu.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialogFactory/FAC_toggle.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialogFactory/Makefile.am
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialogFactory/T_dialogFactory.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_filters/Q_mainfilter.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/Makefile.am
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/Q_gui2.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_factory.h
Log:
misc improvement on QT4, added button to dialogFactory

Copied: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialogFactory/FAC_button.cpp (from rev 3103, branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialogFactory/FAC_toggle.cpp)
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialogFactory/FAC_toggle.cpp	2007-05-16 07:48:13 UTC (rev 3103)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialogFactory/FAC_button.cpp	2007-05-18 16:10:31 UTC (rev 3113)
@@ -0,0 +1,71 @@
+/***************************************************************************
+  FAC_toggle.cpp
+  Handle dialog factory element : Toggle
+  (C) 2006 Mean <A HREF="https://lists.berlios.de/mailman/listinfo/avidemux-svn-commit">Fixounet at free.fr</A> 
+***************************************************************************/
+
+/***************************************************************************
+ *                                                                         *
+ *   This program is free software; you can redistribute it and/or modify  *
+ *   it under the terms of the GNU General Public License as published by  *
+ *   the Free Software Foundation; either version 2 of the License, or     *
+ *   (at your option) any later version.                                   *
+ *                                                                         *
+ ***************************************************************************/
+
+#include &lt;config.h&gt;
+
+
+#include &lt;string.h&gt;
+#include &lt;stdio.h&gt;
+#include &lt;math.h&gt;
+
+#include &quot;default.h&quot;
+#include &quot;ADM_toolkit_gtk/ADM_gladeSupport.h&quot;
+#include &quot;ADM_toolkit_gtk/toolkit_gtk.h&quot;
+#include &quot;ADM_toolkit_gtk/toolkit_gtk_include.h&quot;
+#include &quot;ADM_commonUI/DIA_factory.h&quot;
+#include &quot;ADM_assert.h&quot;
+
+
+
+diaElemButton:: diaElemButton(const char *toggleTitle, ADM_FAC_CALLBACK *cb,void *cookie,const char *tip)
+  : diaElem(ELEM_BUTTON)
+{
+  param=NULL;
+  paramTitle=toggleTitle;
+  this-&gt;tip=tip;
+  _cookie=cookie;
+  _callBack=cb;
+}
+
+diaElemButton::~diaElemButton()
+{
+  
+}
+
+void diaElemButton::setMe(void *dialog, void *opaque,uint32_t line)
+{
+  GtkWidget *button;
+  button = gtk_button_new_from_stock (paramTitle);
+  gtk_widget_show (button);
+  /**/
+  gtk_table_attach (GTK_TABLE (opaque), button, 0, 2, line, line+1,
+                    (GtkAttachOptions) (GTK_EXPAND | GTK_FILL),
+                    (GtkAttachOptions) (0), 0, 0);
+  /* Add callback ...*/
+  g_signal_connect(GTK_OBJECT(button), &quot;clicked&quot;,
+                    GTK_SIGNAL_FUNC(_callBack),  _cookie);
+  myWidget=button;
+}
+void diaElemButton::getMe(void)
+{
+  
+}
+void   diaElemButton::enable(uint32_t onoff)
+{
+  gtk_widget_set_sensitive(GTK_WIDGET(myWidget),onoff);  
+}
+
+
+//EOF

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialogFactory/Makefile.am
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialogFactory/Makefile.am	2007-05-18 16:09:57 UTC (rev 3112)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialogFactory/Makefile.am	2007-05-18 16:10:31 UTC (rev 3113)
@@ -19,6 +19,7 @@
 FAC_readOnlyText.cpp \
 FAC_notch.cpp \
 FAC_frame.cpp \
-FAC_hex.cpp
+FAC_hex.cpp \
+FAC_button.cpp
 
 

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_NONE/ADM_dialogFactory/FAC_toggle.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_NONE/ADM_dialogFactory/FAC_toggle.cpp	2007-05-18 16:09:57 UTC (rev 3112)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_NONE/ADM_dialogFactory/FAC_toggle.cpp	2007-05-18 16:10:31 UTC (rev 3113)
@@ -368,5 +368,27 @@
 {
   
 }
+//*********************************************************
+diaElemButton:: diaElemButton(const char *toggleTitle, ADM_FAC_CALLBACK *cb,void *cookie,const char *tip)
+  : diaElem(ELEM_BUTTON)
+{
+}
 
+diaElemButton::~diaElemButton()
+{
+  
+}
+
+void diaElemButton::setMe(void *dialog, void *opaque,uint32_t line)
+{
+  
+}
+void diaElemButton::getMe(void)
+{
+  
+}
+void   diaElemButton::enable(uint32_t onoff)
+{
+
+}
 //EOF

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialogFactory/FAC_menu.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialogFactory/FAC_menu.cpp	2007-05-18 16:09:57 UTC (rev 3112)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialogFactory/FAC_menu.cpp	2007-05-18 16:10:31 UTC (rev 3113)
@@ -164,10 +164,10 @@
     dialElemLink *l=&amp;(links[i]);
     if(l-&gt;value==val)
     {
-      if(!l-&gt;onoff)  l-&gt;widget-&gt;enable(0);
+      if(!l-&gt;onoff)  l-&gt;widget-&gt;enable(FALSE);
     }else
     {
-       if(l-&gt;onoff)  l-&gt;widget-&gt;enable(0);
+       if(l-&gt;onoff)  l-&gt;widget-&gt;enable(FALSE);
     }
     
   }
@@ -177,10 +177,10 @@
     dialElemLink *l=&amp;(links[i]);
     if(l-&gt;value==val)
     {
-      if(l-&gt;onoff)  l-&gt;widget-&gt;enable(1);
+      if(l-&gt;onoff)  l-&gt;widget-&gt;enable(TRUE);
     }else
     {
-       if(!l-&gt;onoff)  l-&gt;widget-&gt;enable(1);
+       if(!l-&gt;onoff)  l-&gt;widget-&gt;enable(TRUE);
     }
     
   }
@@ -190,9 +190,9 @@
    QComboBox *combo=(QComboBox *)myWidget;
   ADM_assert(combo);
   if(onoff)
-    combo-&gt;setEnabled(1);
+    combo-&gt;setEnabled(true);
   else
-    combo-&gt;setDisabled(1);
+    combo-&gt;setDisabled(true);
 }
 
 uint8_t   diaElemMenuDynamic::link(diaMenuEntryDynamic *entry,uint32_t onoff,diaElem *w)

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialogFactory/FAC_toggle.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialogFactory/FAC_toggle.cpp	2007-05-18 16:09:57 UTC (rev 3112)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialogFactory/FAC_toggle.cpp	2007-05-18 16:10:31 UTC (rev 3113)
@@ -78,9 +78,9 @@
   QCheckBox *box=(QCheckBox *)myWidget;
   ADM_assert(box);
   if(onoff)
-    box-&gt;setEnabled(1);
+    box-&gt;setEnabled(TRUE);
   else
-    box-&gt;setDisabled(1);
+    box-&gt;setDisabled(TRUE);
 }
 
 void   diaElemToggle::finalize(void)
@@ -189,7 +189,7 @@
 void   diaElemToggleUint::updateMe(void)
 {
   uint32_t val;
-  uint32_t rank=0;
+  uint32_t rank=FALSE;
   ADM_assert(myWidget);
   
   QCheckBox *box=(QCheckBox *)myWidget;
@@ -197,7 +197,7 @@
   
   if(Qt::Checked==box-&gt;checkState())
   {
-    rank=1;
+    rank=TRUE;
   }
   spin-&gt;setEnabled(rank);
 }
@@ -208,13 +208,13 @@
   ADM_assert(box);
   if(onoff)
   {
-    box-&gt;setEnabled(1);
-    spin-&gt;setEnabled(1);
+    box-&gt;setEnabled(TRUE);
+    spin-&gt;setEnabled(TRUE);
   }
   else
   {
-    box-&gt;setDisabled(1);
-    spin-&gt;setDisabled(1);
+    box-&gt;setEnabled(FALSE);
+    spin-&gt;setEnabled(FALSE);
   }
 }
 
@@ -277,4 +277,7 @@
 }
 //******************************************************
 
+
+
+
 //EOF

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialogFactory/Makefile.am
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialogFactory/Makefile.am	2007-05-18 16:09:57 UTC (rev 3112)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialogFactory/Makefile.am	2007-05-18 16:10:31 UTC (rev 3113)
@@ -3,7 +3,10 @@
 
 libADM_dialogFactory_a_METASOURCES = AUTO
 
-libADM_dialogFactory_a_SOURCES = AT_dialogFactory.cpp FAC_toggle.cpp FAC_integer.cpp FAC_menu.cpp FAC_float.cpp AT_filesel.cpp AT_bitrate.cpp FAC_bar.cpp FAC_readOnlyText.cpp FAC_notch.cpp FAC_frame.cpp FAC_hex.cpp
+libADM_dialogFactory_a_SOURCES = AT_dialogFactory.cpp FAC_toggle.cpp FAC_integer.cpp FAC_menu.cpp FAC_float.cpp \
+AT_filesel.cpp AT_bitrate.cpp \
+AT_button.cpp \
+FAC_bar.cpp FAC_readOnlyText.cpp FAC_notch.cpp FAC_frame.cpp FAC_hex.cpp
 
 
 INCLUDES = $(all_includes)  $(XML_CFLAGS)  $(FREETYPE_CFLAGS) -DADM_SUBVERSION=@ADM_SUBVERSION@ \

Copied: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialogFactory/T_button.cpp (from rev 3098, branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialogFactory/T_bitrate.cpp)
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialogFactory/T_bitrate.cpp	2007-05-15 15:15:31 UTC (rev 3098)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialogFactory/T_button.cpp	2007-05-18 16:10:31 UTC (rev 3113)
@@ -0,0 +1,109 @@
+/***************************************************************************
+  FAC_toggle.cpp
+  Handle dialog factory element : Toggle
+  (C) 2006 Mean <A HREF="https://lists.berlios.de/mailman/listinfo/avidemux-svn-commit">Fixounet at free.fr</A> 
+***************************************************************************/
+
+/***************************************************************************
+ *                                                                         *
+ *   This program is free software; you can redistribute it and/or modify  *
+ *   it under the terms of the GNU General Public License as published by  *
+ *   the Free Software Foundation; either version 2 of the License, or     *
+ *   (at your option) any later version.                                   *
+ *                                                                         *
+ ***************************************************************************/
+
+#include &lt;config.h&gt;
+
+
+#include &lt;string.h&gt;
+#include &lt;stdio.h&gt;
+#include &lt;stdlib.h&gt;
+#include &lt;math.h&gt;
+
+#include &lt;QDialog&gt;
+#include &lt;QMessageBox&gt;
+#include &lt;QGridLayout&gt;
+#include &lt;QPushButton&gt;
+#include &lt;QComboBox&gt;
+#include &lt;QLabel&gt;
+
+#include &quot;default.h&quot;
+#include &quot;ADM_commonUI/DIA_factory.h&quot;
+#include &quot;ADM_assert.h&quot;
+
+extern const char *shortkey(const char *);
+
+class  ADM_Qbutton : public QWidget
+{
+     Q_OBJECT
+    
+  signals:
+        
+        
+   public slots:
+        void clicked(bool i);
+  protected :
+          ADM_FAC_CALLBACK *_cb;
+          void *_cookie;
+  public:
+         QPushButton *button;
+        
+        ADM_Qbutton(QWidget *z,QGridLayout *layout,const char *blah,int line,ADM_FAC_CALLBACK *cb, void *cookie) : QWidget(z) 
+        {
+          
+           _cb=cb;
+           _cookie=cookie;
+           button=new QPushButton(blah,z);
+           button-&gt;show();
+           layout-&gt;addWidget(button,line,0);
+           QObject::connect(button, SIGNAL(clicked(bool)), this, SLOT(clicked(bool )));
+        }
+        virtual ~ADM_Qbutton() ;
+        
+};
+void ADM_Qbutton::clicked(bool i)
+{
+    _cb(_cookie);
+}
+ADM_Qbutton::~ADM_Qbutton()
+{
+}
+
+diaElemButton:: diaElemButton(const char *toggleTitle, ADM_FAC_CALLBACK *cb,void *cookie,const char *tip)
+  : diaElem(ELEM_BUTTON)
+{
+  param=(void *)NULL;
+  paramTitle=shortkey(toggleTitle);
+  this-&gt;tip=tip;
+  _cookie=cookie;
+  _callBack=cb;
+  
+}
+
+diaElemButton::~diaElemButton()
+{
+  
+}
+
+void diaElemButton::setMe(void *dialog, void *opaque,uint32_t line)
+{
+  QGridLayout *layout=(QGridLayout*) opaque;
+  
+  ADM_Qbutton *b=new ADM_Qbutton( (QWidget *)dialog,layout,paramTitle,line,_callBack,_cookie);
+  myWidget=(void *)b;
+}
+void diaElemButton::getMe(void)
+{
+  if(paramTitle)
+  {
+    ADM_dealloc(paramTitle);
+    paramTitle=NULL; 
+  }
+}
+void   diaElemButton::enable(uint32_t onoff)
+{
+
+}
+//EOF
+

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialogFactory/T_dialogFactory.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialogFactory/T_dialogFactory.cpp	2007-05-18 16:09:57 UTC (rev 3112)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialogFactory/T_dialogFactory.cpp	2007-05-18 16:10:31 UTC (rev 3113)
@@ -85,6 +85,11 @@
      v+=elems[i]-&gt;getSize();
     
   }
+   for(int i=0;i&lt;nb;i++)
+  {
+    ADM_assert(elems[i]);
+     elems[i]-&gt;finalize(); 
+  }
   // Add buttons
    QDialogButtonBox buttonBox((QWidget *)&amp;dialog);
     buttonBox.setStandardButtons(QDialogButtonBox::Ok
@@ -193,6 +198,11 @@
      v+=tab-&gt;dias[i]-&gt;getSize();
     
   }
+  
   wtab-&gt;addTab(wid,tab-&gt;title);
+  for(int i=0;i&lt;tab-&gt;nbElems;i++)
+  {
+    tab-&gt;dias[i]-&gt;finalize(); 
+  }
 }
 //EOF

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_filters/Q_mainfilter.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_filters/Q_mainfilter.cpp	2007-05-18 16:09:57 UTC (rev 3112)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_filters/Q_mainfilter.cpp	2007-05-18 16:10:31 UTC (rev 3113)
@@ -50,6 +50,7 @@
 #include &quot;ADM_video/ADM_genvideo.hxx&quot;
 #include &quot;ADM_filter/video_filters.h&quot;
 #include &quot;ADM_video/ADM_vidPartial.h&quot;
+#include &quot;ADM_filter/vidVCD.h&quot;
 /*******************************************************/
 #define NB_TREE 8
 #define myFg 0xFF
@@ -86,6 +87,10 @@
      
      
  public slots:
+        void VCD(bool b);
+        void DVD(bool b);
+        void SVCD(bool b);
+        void halfD1(bool b);
         void add(bool b);
         void up(bool b);
         void down(bool b);
@@ -205,6 +210,17 @@
             }
   
 }
+#define MAKE_BUTTON(button,call) \
+void filtermainWindow::button( bool b) \
+{ \
+    call(); \
+    getFirstVideoFilter (); \
+    buildActiveFilterList ();  \
+}
+MAKE_BUTTON(DVD,setDVD)
+MAKE_BUTTON(VCD,setVCD)
+MAKE_BUTTON(SVCD,setSVCD)
+MAKE_BUTTON(halfD1,setHalfD1)
 /**
         \fn     configure( bool b)
         \brief  Configure the selected active filter
@@ -506,6 +522,10 @@
     connect((ui.toolButtonUp),SIGNAL(clicked(bool)),this,SLOT(up(bool)));
     connect((ui.toolButtonDown),SIGNAL(clicked(bool)),this,SLOT(down(bool)));
     connect(ui.buttonClose, SIGNAL(clicked(bool)), this, SLOT(accept()));
+    connect(ui.pushButtonDVD, SIGNAL(clicked(bool)), this, SLOT(DVD(bool)));
+    connect(ui.pushButtonVCD, SIGNAL(clicked(bool)), this, SLOT(VCD(bool)));
+    connect(ui.pushButtonSVCD, SIGNAL(clicked(bool)), this, SLOT(SVCD(bool)));
+    connect(ui.pushButtonHalfDVD, SIGNAL(clicked(bool)), this, SLOT(halfD1(bool)));
    
     displayFamily(0);
     buildActiveFilterList(); 

Added: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/ADM_qslider.h
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/ADM_qslider.h	2007-05-18 16:09:57 UTC (rev 3112)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/ADM_qslider.h	2007-05-18 16:10:31 UTC (rev 3113)
@@ -0,0 +1,36 @@
+#ifndef ADM_Q_SLIDER_H
+#define ADM_Q_SLIDER_H
+class ADM_QSlider : public QWidget
+{
+        Q_OBJECT
+signals:
+void valueChanged(int value);
+public slots:
+protected:
+        QSlider *_slider;
+        uint32_t _max,_A,_B;
+        void paintEvent(QPaintEvent *ev);
+        
+public:
+        ADM_QSlider(QWidget *father); 
+        ~ADM_QSlider(); 
+        
+        void setA(uint32_t a);
+        void setB(uint32_t a);
+        void setNbFrames(uint32_t a);
+        int  value() const;
+         Qt::Orientation orientation() const;
+
+    void setMinimum(int);
+    int minimum() const;
+
+    void setMaximum(int);
+    int maximum() const;
+
+public Q_SLOTS:
+    void setValue(int);
+    void setOrientation(Qt::Orientation);
+
+};
+#endif
+

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/Makefile.am
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/Makefile.am	2007-05-18 16:09:57 UTC (rev 3112)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/Makefile.am	2007-05-18 16:10:31 UTC (rev 3113)
@@ -10,7 +10,7 @@
 libADM_gui2_a_METASOURCES = AUTO
 
 libADM_gui2_a_SOURCES = gui_none.cpp file_qt4.cpp avidemux_rsc.cpp \
-			AQ_gui2.cpp   AT_preview.cpp 
+			AQ_gui2.cpp   AT_preview.cpp AT_qslider.cpp
 
 include ../Makefile.adm
 

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/Q_gui2.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/Q_gui2.cpp	2007-05-18 16:09:57 UTC (rev 3112)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/Q_gui2.cpp	2007-05-18 16:10:31 UTC (rev 3113)
@@ -12,7 +12,7 @@
  *                                                                         *
  ***************************************************************************/
 #include &quot;config.h&quot;
-
+//#define CUSTOM_SLIDER
 #include &lt;stdio.h&gt;
 #include &lt;stdlib.h&gt;
 #include &lt;math.h&gt;
@@ -33,6 +33,7 @@
 #include &lt;QtGui/QToolButton&gt;
 #include &lt;QtGui/QVBoxLayout&gt;
 #include &lt;QtGui/QWidget&gt;
+#include &lt;ADM_qslider.h&gt;
 
 #include &quot;default.h&quot;
 #include &quot;ADM_osSupport/ADM_misc.h&quot;
@@ -50,7 +51,11 @@
 extern void checkCrashFile(void);
 static void setupMenus(void);
 
+#ifdef CUSTOM_SLIDER
+static ADM_QSlider *slider=NULL;
+#else
 static QSlider *slider=NULL;
+#endif
 static int _upd_in_progres=0;
 /* Ugly game with macro so that buttons emit their name ...*/
 
@@ -193,7 +198,9 @@
             ADD(actionNext_blak_frame);
             ADD(actionFirst_Frame);
             ADD(actionLast_Frame);
-            
+            //** Add shortcuts **//
+            QKeySequence seqFilter(&quot;CTRL+Alt+F&quot;);
+            ui.actionFilters-&gt;setShortcut(seqFilter);
             // default state
             bool b=0;
           ui.pushButtonVideoConf-&gt;setEnabled(b);
@@ -276,12 +283,13 @@
    
     UI_QT4VideoWidget(mw-&gt;ui.frame_video);  // Add the widget that will handle video display
     UI_updateRecentMenu(  );
+    setupMenus();
+    checkCrashFile();
+    
    if (global_argc &gt;= 2)
     {
      automation();
     }
-    setupMenus();
-    checkCrashFile();
     return a.exec();
 }
 /**
@@ -488,6 +496,9 @@
       frame2time(total,fps, &amp;hh, &amp;mm, &amp;ss, &amp;ms);
       sprintf(text, &quot;/%02d:%02d:%02d.%03d&quot;, hh, mm, ss, ms);
       WIDGET(label_7)-&gt;setText(text);
+#ifdef CUSTOM_SLIDER
+      slider-&gt;setNbFrames(total);
+#endif
 }
 /**
     \fn     UI_setMarkers(uint32_t a, uint32_t b )
@@ -501,6 +512,11 @@
       WIDGET(label_9)-&gt;setText(text);
       snprintf(text,79,&quot;%lu&quot;,b);
       WIDGET(label_10)-&gt;setText(text);
+      //
+#ifdef CUSTOM_SLIDER
+      slider-&gt;setA(a);
+      slider-&gt;setB(b);
+#endif
 }
 /**
     \fn     UI_getCurrentVCodec(void)
@@ -520,7 +536,11 @@
 
 void UI_setVideoCodec( int i)
 {
+  int b=!!i;
     WIDGET(comboBoxVideo)-&gt;setCurrentIndex(i);
+    
+     WIDGET(pushButtonVideoConf)-&gt;setEnabled(b);
+     WIDGET(pushButtonVideoFilter)-&gt;setEnabled(b);
 }
 /**
     \fn     UI_getCurrentACodec(void)
@@ -539,8 +559,10 @@
 */
 
 void UI_setAudioCodec( int i)
-{
+{ int b=!!i;
    WIDGET(comboBoxAudio)-&gt;setCurrentIndex(i);
+    WIDGET(pushButtonAudioConf)-&gt;setEnabled(b);
+    WIDGET(pushButtonAudioFilter)-&gt;setEnabled(b);
 }
 /**
     \fn     UI_GetCurrentFormat(void)

Copied: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/T_qslider.cpp (from rev 3104, branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/T_preview.cpp)
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/T_preview.cpp	2007-05-17 07:39:26 UTC (rev 3104)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/T_qslider.cpp	2007-05-18 16:10:31 UTC (rev 3113)
@@ -0,0 +1,154 @@
+
+/***************************************************************************
+      Custom slider
+      It is definitively ugly
+      It should derive from QHorizontalSlider or something
+ ***************************************************************************/
+
+/***************************************************************************
+ *                                                                         *
+ *   This program is free software; you can redistribute it and/or modify  *
+ *   it under the terms of the GNU General Public License as published by  *
+ *   the Free Software Foundation; either version 2 of the License, or     *
+ *   (at your option) any later version.                                   *
+ *                                                                         *
+ ***************************************************************************/
+
+#include &quot;config.h&quot;
+ 
+#include &lt;stdio.h&gt;
+#include &lt;stdlib.h&gt;
+#include &lt;string.h&gt;
+
+#include &lt;time.h&gt;
+#include &lt;sys/time.h&gt;
+
+#include &lt;QtCore/QVariant&gt;
+#include &lt;QtGui/QAction&gt;
+#include &lt;QtGui/QApplication&gt;
+#include &lt;QtGui/QButtonGroup&gt;
+#include &lt;QtGui/QFrame&gt;
+#include &lt;QtGui/QGraphicsView&gt;
+#include &lt;QMessageBox&gt;
+#include &lt;QPainter&gt;
+#include &lt;QImage&gt;
+#include &lt;QSlider&gt;
+// moc does not like includes.... #include &lt;ADM_qslider.h&gt;
+class ADM_QSlider : public QWidget
+{
+        Q_OBJECT
+signals:
+  void valueChanged(int value);
+
+public slots:
+        void sliderMoved(int);
+protected:
+        QSlider *_slider;
+        uint32_t _max,_A,_B;
+        void paintEvent(QPaintEvent *ev);
+        
+public:
+        ADM_QSlider(QWidget *father); 
+        ~ADM_QSlider(); 
+        
+        void setA(uint32_t a);
+        void setB(uint32_t a);
+        void setNbFrames(uint32_t a);
+        int  value() const;
+         Qt::Orientation orientation() const;
+
+    void setMinimum(int);
+    int minimum() const;
+
+    void setMaximum(int);
+    int maximum() const;
+
+public Q_SLOTS:
+    void setValue(int);
+    void setOrientation(Qt::Orientation);
+
+};
+//****************************************************************************************************
+void ADM_QSlider::setOrientation(Qt::Orientation x)
+{
+  _slider-&gt;setOrientation(x); 
+}
+void ADM_QSlider::setValue(int x)
+{
+  _slider-&gt;setValue(x); 
+}
+
+void ADM_QSlider::setMinimum(int x)
+{
+  _slider-&gt;setMinimum(x); 
+}
+void ADM_QSlider::setMaximum(int x)
+{
+  _slider-&gt;setMaximum(x); 
+}
+ int ADM_QSlider::minimum(void) const
+{
+  return _slider-&gt;minimum(); 
+}
+int ADM_QSlider::maximum(void) const
+{
+  return _slider-&gt;maximum(); 
+}
+int ADM_QSlider::value(void) const
+{
+  return _slider-&gt;value(); 
+}
+
+ADM_QSlider::ADM_QSlider(QWidget *father) : QWidget(father)
+{
+  _max=_A=_B=0;
+  _slider=new QSlider(this);
+  _slider-&gt;show();
+  connect( _slider,SIGNAL(valueChanged(int)),this,SLOT(sliderMoved(int)));
+  
+}
+void ADM_QSlider::sliderMoved(int i)
+{
+  emit( valueChanged(i));
+}
+ADM_QSlider::~ADM_QSlider()
+{
+  if(_slider) delete _slider;
+  _slider=NULL;
+}
+void ADM_QSlider::paintEvent(QPaintEvent *ev)
+{
+    printf(&quot;[*********************************PAINT************************]\n&quot;);
+    _slider-&gt;repaint();
+    if(_A &amp;&amp; _B &amp;&amp; _max)
+    {
+      printf(&quot;[QSLIDER] %u %u %u\n&quot;,_A,_B,_max); 
+    }
+}
+void ADM_QSlider::setA(uint32_t a)
+{
+  _A=a;
+  printf(&quot;[QSLIDER] Set A (%u,%u)\n&quot;,_A,_max);  
+  if(_A&gt;_max)
+  {
+    printf(&quot;[QSLIDER] A out of bound(%u,%u)\n&quot;,_A,_max);  
+  }
+  repaint();
+}
+void ADM_QSlider::setB(uint32_t a)
+{
+    _B=a;
+    printf(&quot;[QSLIDER] Set B (%u,%u)\n&quot;,_B,_max);  
+  if(_B&gt;_max)
+  {
+    printf(&quot;[QSLIDER] B out of bound(%u,%u)\n&quot;,_B,_max);  
+  }
+  repaint();
+}
+void ADM_QSlider::setNbFrames(uint32_t a)
+{
+  _max=a; 
+  repaint();
+}
+
+//EOF 

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_factory.h
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_factory.h	2007-05-18 16:09:57 UTC (rev 3112)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_factory.h	2007-05-18 16:10:31 UTC (rev 3113)
@@ -36,9 +36,10 @@
   ELEM_HEXDUMP,
   ELEM_TOGGLE_UINT,
   ELEM_TOGGLE_INT,
+  ELEM_BUTTON,
   ELEM_MAX=ELEM_TOGGLE
 };
-
+typedef void ADM_FAC_CALLBACK(void *cookie);
 /*********************************************/
 class diaElem
 {
@@ -73,6 +74,21 @@
   diaElem  *widget;
 }dialElemLink;
 /*********************************************/
+
+class diaElemButton : public diaElem
+{
+  protected:
+    
+    void            *_cookie;
+    ADM_FAC_CALLBACK *_callBack;
+public:
+            diaElemButton(const char *toggleTitle, ADM_FAC_CALLBACK *cb,void *cookie,const char *tip=NULL);
+  virtual   ~diaElemButton() ;
+  void      setMe(void *dialog, void *opaque,uint32_t line);
+  void      getMe(void);
+  void      enable(uint32_t onoff) ;
+};
+/*********************************************/
 class diaElemToggle : public diaElem
 {
   protected:


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000407.html">[Avidemux-svn-commit] r3112 -	branches/avidemux_2.4_branch/autononreg/dialogFactory
</A></li>
	<LI>Next message: <A HREF="000409.html">[Avidemux-svn-commit] r3114 - in	branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4:	ADM_dialog ADM_filters
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#408">[ date ]</a>
              <a href="thread.html#408">[ thread ]</a>
              <a href="subject.html#408">[ subject ]</a>
              <a href="author.html#408">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/avidemux-svn-commit">More information about the Avidemux-svn-commit
mailing list</a><br>
</body></html>
