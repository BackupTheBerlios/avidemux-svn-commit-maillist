From mean at mail.berlios.de  Sun Jul  1 10:18:16 2007
From: mean at mail.berlios.de (mean at BerliOS)
Date: Sun, 1 Jul 2007 10:18:16 +0200
Subject: [Avidemux-svn-commit] r3324 - in
	branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4:
	ADM_dialog ADM_gui
Message-ID: <200707010818.l618IGIk031632@sheep.berlios.de>

Author: mean
Date: 2007-07-01 10:18:15 +0200 (Sun, 01 Jul 2007)
New Revision: 3324

Added:
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_jobs.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/jobs.ui
Modified:
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/CMakeLists.txt
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_none.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Makefile.am
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/translation_table.h
Log:
joblist for QT i/f

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/CMakeLists.txt
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/CMakeLists.txt	2007-06-30 09:42:02 UTC (rev 3323)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/CMakeLists.txt	2007-07-01 08:18:15 UTC (rev 3324)
@@ -13,7 +13,7 @@
 hue
 props
 resizing
-#srt
+jobs
 working
 )
 #

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_none.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_none.cpp	2007-06-30 09:42:02 UTC (rev 3323)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_none.cpp	2007-07-01 08:18:15 UTC (rev 3324)
@@ -85,7 +85,7 @@
 //uint8_t DIA_getPartial(PARTIAL_CONFIG *param,AVDMGenericVideoStream *son,AVDMGenericVideoStream *previous){return 0;}
 uint8_t DIA_vobsub(vobSubParam *param){return 0;}
 //uint8_t DIA_x264(COMPRES_PARAMS *config){return 0;}
-uint8_t DIA_job(uint32_t nb,char **name){return 0;}
+//uint8_t DIA_job(uint32_t nb,char **name){return 0;}
 uint8_t DIA_videoCodec (SelectCodecType * codec){return 0;}
 uint8_t DIA_audioCodec( AUDIOENCODER *codec ) {return 0;}
 //uint8_t DIA_srt(ADMImage *source, SUBCONF *param) {return 0;}			

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Makefile.am
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Makefile.am	2007-06-30 09:42:02 UTC (rev 3323)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Makefile.am	2007-07-01 08:18:15 UTC (rev 3324)
@@ -2,6 +2,7 @@
 noinst_LIBRARIES = libADM_dialog.a 
 libADM_dialog_a_SOURCES = DIA_busy.cpp  alert_qt4.cpp DIA_none.cpp OCR_none.cpp  \
 AQ_props.cpp AQ_working.cpp AQ_encoding.cpp  DIA_xvid4.cpp AQ_resizing.cpp AT_flyDialog.cpp \
+AQ_jobs.cpp \
 AQ_crop.cpp AT_QCanvas.cpp \
 AQ_asharp.cpp AQ_chromashift.cpp \
 AQ_contrast.cpp AQ_hue.cpp \

Copied: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_jobs.cpp (from rev 3318, branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_jobs.cpp)
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_jobs.cpp	2007-06-28 17:29:59 UTC (rev 3318)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_jobs.cpp	2007-07-01 08:18:15 UTC (rev 3324)
@@ -0,0 +1,274 @@
+/**
+    Jobs dialog
+    (c) Mean 2007
+*/
+#include "config.h"
+
+#include <stdio.h>
+#include <stdlib.h>
+#include <math.h>
+
+
+#include "ui_jobs.h"
+
+
+#include "default.h"
+#include "avidemutils.h"
+#include "avi_vars.h"
+#include "ADM_osSupport/ADM_misc.h"
+
+#include "ADM_toolkit/toolkit.hxx"
+#include "ADM_assert.h"
+
+static void             updateStatus(void);
+extern bool parseECMAScript(const char *name);
+static const char *StringStatus[]={_("Ready"),_("Succeeded"),_("Failed"),_("Deleted"),_("Running")};
+
+
+typedef enum 
+{
+        STATUS_READY=0,
+        STATUS_SUCCEED,
+        STATUS_FAILED,
+        STATUS_DELETED,
+        STATUS_RUNNING
+}JOB_STATUS;
+
+
+class ADM_Job_Descriptor
+{
+  public:
+  JOB_STATUS  status;
+  ADM_date    startDate;
+  ADM_date    endDate;
+  ADM_Job_Descriptor(void) 
+  {
+    status=STATUS_READY;
+    memset(&startDate,0,sizeof(startDate));
+    memset(&endDate,0,sizeof(startDate));
+  }
+  
+};
+
+typedef enum 
+{
+        COMMAND_DELETE_ALL=1,
+        COMMAND_DELETE=2,
+        COMMAND_RUN_ALL=3,
+        COMMAND_RUN=4
+};
+
+
+
+
+
+class jobsWindow : public QDialog
+ {
+     Q_OBJECT
+ protected : 
+        uint32_t        _nbJobs;
+        char            **_jobsName;
+        ADM_Job_Descriptor  *desc;
+        uint8_t             updateRows(void);
+ public:
+                    jobsWindow(uint32_t n,char **j);
+                    ~jobsWindow();
+     Ui_Jobs        ui;
+ public slots:
+      //void gather(void);
+      int RunOne(bool b);
+      int RunAll(bool b);
+      int DeleteOne(bool b);
+      int DeleteAll(bool b);
+ private slots:
+   
+
+ private:
+     
+ };
+ /**
+          \fn jobsWindow
+ */
+jobsWindow::jobsWindow(uint32_t n,char **j)     : QDialog()
+ {
+     ui.setupUi(this);
+     _nbJobs=n;
+     _jobsName=j;
+     desc=new ADM_Job_Descriptor[n];
+     // Setup display
+#define WIDGET(x) ui.x
+     WIDGET(tableWidget)->setRowCount(_nbJobs);
+     WIDGET(tableWidget)->setColumnCount(4);
+
+     // Set headers
+      QStringList headers;
+     headers << _("Job Name") << _("Status") << _("Start Time") << _("End Time"); 
+     
+     WIDGET(tableWidget)->setVerticalHeaderLabels(headers);
+     updateRows();
+    
+#define CNX(x) connect( ui.pushButton##x,SIGNAL(clicked(bool)),this,SLOT(x(bool)))
+           //connect( ui.pushButtonRunOne,SIGNAL(buttonPressed(const char *)),this,SLOT(runOne(const char *)));
+      CNX(RunOne);
+      CNX(RunAll);
+      CNX(DeleteAll);
+      CNX(DeleteOne);
+ }
+ /**
+    \fn ~jobsWindow
+ */
+ jobsWindow::~jobsWindow()
+ {
+   
+        // Now delete the "deleted" jobs
+        for(int i=0;i<_nbJobs;i++)
+        {
+                if(desc[i].status==STATUS_DELETED)
+                {
+                        unlink(_jobsName[i]);
+                }
+
+        }
+        delete [] desc;
+        desc=NULL;
+
+ }
+ /*
+    There is maybe a huge mem leak here
+ */
+static void ADM_setText(const char *txt,uint32_t col, uint32_t row,QTableWidget *w)
+{
+        QString str(txt);
+        QTableWidgetItem *newItem = new QTableWidgetItem(str);//GetFileName(_jobsName[i]));
+        w->setItem(row, col, newItem);
+  
+}
+ /**
+      \fn updateRaw
+      \brief update display for raw x
+ */
+uint8_t jobsWindow::updateRows(void)
+{
+   WIDGET(tableWidget)->clear();
+   ADM_Job_Descriptor *j;
+   char str[20];
+   for(int i=0;i<_nbJobs;i++)
+   {
+      j=&(desc[i]);
+      ADM_setText(GetFileName(_jobsName[i]),0,i,WIDGET(tableWidget));
+      ADM_setText(StringStatus[j->status],1,i,WIDGET(tableWidget));
+      
+      sprintf(str,"%02u:%02u:%02u",j->startDate.hours,j->startDate.minutes,j->startDate.seconds);
+      ADM_setText(str,2,i,WIDGET(tableWidget));
+      
+      sprintf(str,"%02u:%02u:%02u",j->endDate.hours,j->endDate.minutes,j->endDate.seconds);
+      ADM_setText(str,3,i,WIDGET(tableWidget));
+
+   }
+   
+      return 1;
+}
+
+                                                                 
+                                                                 
+/**
+      \fn deleteOne
+      \brief delete one job
+*/
+int jobsWindow::DeleteOne(bool b)
+{
+  int sel=WIDGET(tableWidget)->currentRow();
+        if(sel<=0 || sel>=_nbJobs) return 0;
+        if(GUI_Confirmation_HIG(_("Sure!"),_("Delete job"),_("Are you sure you want to delete %s job ?"),GetFileName(_jobsName[sel])))
+        {
+                desc[sel].status=STATUS_DELETED;
+        }
+        updateRows();
+        return 0;
+}         
+/**
+      \fn deleteAll
+      \brief delete all job
+*/
+int jobsWindow::DeleteAll(bool b)
+{
+  if(!GUI_Confirmation_HIG(_("Sure!"),_("Delete *all* job"),_("Are you sure you want to delete ALL jobs ?")))
+  {
+          return 0;
+  }
+  for(int sel=0;sel<_nbJobs;sel++)
+  {
+        desc[sel].status=STATUS_DELETED;
+   
+  }
+  updateRows();
+  return 0;
+}                                                                 
+                                                        
+/**
+      \fn runOne
+      \brief Run one job
+*/
+int jobsWindow::RunOne(bool b)
+{
+  int sel=WIDGET(tableWidget)->currentRow();
+  printf("Selected %d\n",sel);
+  if(sel<0) return 0;
+  if(sel>=_nbJobs) return 0;
+  
+  if(desc[sel].status==STATUS_SUCCEED) 
+  {
+    GUI_Info_HIG(ADM_LOG_INFO,_("Already done"),_("This script has already been successfully executed."));
+    return 0;
+  }
+
+  desc[sel].status=STATUS_RUNNING;
+  updateRows();
+  GUI_Quiet();
+  TLK_getDate(&(desc[sel].startDate));
+  if(parseECMAScript(_jobsName[sel])) desc[sel].status=STATUS_SUCCEED;
+  else desc[sel].status=STATUS_FAILED;
+  TLK_getDate(&(desc[sel].endDate));
+  updateRows();
+  GUI_Verbose();
+  return 0;
+}
+/**
+      \fn RunAll
+      \brief Run all jobs
+*/
+int jobsWindow::RunAll(bool b)
+{
+  for(int sel=0;sel<_nbJobs;sel++)
+  {
+    if(desc[sel].status==STATUS_SUCCEED) continue;
+    desc[sel].status=STATUS_RUNNING;
+    updateRows();
+    GUI_Quiet();
+    TLK_getDate(&(desc[sel].startDate));
+    if(parseECMAScript(_jobsName[sel])) desc[sel].status=STATUS_SUCCEED;
+    else desc[sel].status=STATUS_FAILED;
+    TLK_getDate(&(desc[sel].endDate));
+    updateRows();
+    GUI_Verbose();
+  }
+  return 0;
+}
+
+/**
+    \fn     DIA_job
+    \brief  
+*/
+uint8_t  DIA_job(uint32_t nb, char **name)
+{
+  uint8_t r=0;
+  jobsWindow jobswindow(nb,name) ;
+     
+     if(jobswindow.exec()==QDialog::Accepted)
+     {
+       r=1;
+     }
+     return r;
+}
+
+//EOF

Added: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/jobs.ui
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/jobs.ui	2007-06-30 09:42:02 UTC (rev 3323)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/jobs.ui	2007-07-01 08:18:15 UTC (rev 3324)
@@ -0,0 +1,152 @@
+<ui version="4.0" >
+ <class>Jobs</class>
+ <widget class="QDialog" name="Jobs" >
+  <property name="geometry" >
+   <rect>
+    <x>0</x>
+    <y>0</y>
+    <width>467</width>
+    <height>324</height>
+   </rect>
+  </property>
+  <property name="windowTitle" >
+   <string>Jobs</string>
+  </property>
+  <layout class="QGridLayout" >
+   <property name="margin" >
+    <number>9</number>
+   </property>
+   <property name="spacing" >
+    <number>6</number>
+   </property>
+   <item row="4" column="1" >
+    <spacer>
+     <property name="orientation" >
+      <enum>Qt::Vertical</enum>
+     </property>
+     <property name="sizeHint" >
+      <size>
+       <width>20</width>
+       <height>40</height>
+      </size>
+     </property>
+    </spacer>
+   </item>
+   <item row="3" column="1" >
+    <widget class="QPushButton" name="pushButtonDeleteOne" >
+     <property name="text" >
+      <string>Delete Sel. Job</string>
+     </property>
+    </widget>
+   </item>
+   <item row="2" column="1" >
+    <widget class="QPushButton" name="pushButtonDeleteAll" >
+     <property name="text" >
+      <string>Delete All Jobs</string>
+     </property>
+    </widget>
+   </item>
+   <item row="0" column="1" >
+    <widget class="QPushButton" name="pushButtonRunAll" >
+     <property name="text" >
+      <string>Run All Jobs</string>
+     </property>
+    </widget>
+   </item>
+   <item row="1" column="1" >
+    <widget class="QPushButton" name="pushButtonRunOne" >
+     <property name="text" >
+      <string>Run Selected Job</string>
+     </property>
+    </widget>
+   </item>
+   <item row="5" column="0" colspan="2" >
+    <widget class="QDialogButtonBox" name="buttonBox" >
+     <property name="orientation" >
+      <enum>Qt::Horizontal</enum>
+     </property>
+     <property name="standardButtons" >
+      <set>QDialogButtonBox::Cancel|QDialogButtonBox::NoButton|QDialogButtonBox::Ok</set>
+     </property>
+    </widget>
+   </item>
+   <item rowspan="5" row="0" column="0" >
+    <widget class="QTableWidget" name="tableWidget" >
+     <property name="frameShadow" >
+      <enum>QFrame::Sunken</enum>
+     </property>
+     <property name="lineWidth" >
+      <number>1</number>
+     </property>
+     <property name="tabKeyNavigation" >
+      <bool>true</bool>
+     </property>
+     <property name="alternatingRowColors" >
+      <bool>true</bool>
+     </property>
+     <property name="selectionMode" >
+      <enum>QAbstractItemView::SingleSelection</enum>
+     </property>
+     <property name="selectionBehavior" >
+      <enum>QAbstractItemView::SelectRows</enum>
+     </property>
+     <property name="textElideMode" >
+      <enum>Qt::ElideNone</enum>
+     </property>
+     <property name="showGrid" >
+      <bool>true</bool>
+     </property>
+     <property name="gridStyle" >
+      <enum>Qt::DashDotDotLine</enum>
+     </property>
+     <property name="rowCount" >
+      <number>2</number>
+     </property>
+     <property name="columnCount" >
+      <number>3</number>
+     </property>
+     <row/>
+     <row/>
+     <column/>
+     <column/>
+     <column/>
+    </widget>
+   </item>
+  </layout>
+ </widget>
+ <resources/>
+ <connections>
+  <connection>
+   <sender>buttonBox</sender>
+   <signal>accepted()</signal>
+   <receiver>Jobs</receiver>
+   <slot>accept()</slot>
+   <hints>
+    <hint type="sourcelabel" >
+     <x>248</x>
+     <y>254</y>
+    </hint>
+    <hint type="destinationlabel" >
+     <x>157</x>
+     <y>274</y>
+    </hint>
+   </hints>
+  </connection>
+  <connection>
+   <sender>buttonBox</sender>
+   <signal>rejected()</signal>
+   <receiver>Jobs</receiver>
+   <slot>reject()</slot>
+   <hints>
+    <hint type="sourcelabel" >
+     <x>316</x>
+     <y>260</y>
+    </hint>
+    <hint type="destinationlabel" >
+     <x>286</x>
+     <y>274</y>
+    </hint>
+   </hints>
+  </connection>
+ </connections>
+</ui>

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui	2007-06-30 09:42:02 UTC (rev 3323)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui	2007-07-01 08:18:15 UTC (rev 3324)
@@ -907,6 +907,37 @@
     <addaction name="actionShow_built_in_support" />
     <addaction name="actionAbout_avidemux" />
    </widget>
+   <widget class="QMenu" name="menuAuto" >
+    <property name="title" >
+     <string>Auto</string>
+    </property>
+    <addaction name="actionVCD" />
+    <addaction name="actionSVCD" />
+    <addaction name="actionDVD" />
+    <addaction name="actionPSP" />
+    <addaction name="actionPSP_H264" />
+   </widget>
+   <widget class="QMenu" name="menuAudio" >
+    <property name="title" >
+     <string>Audio</string>
+    </property>
+    <addaction name="actionMain_Track" />
+    <addaction name="actionSecondary_Track" />
+    <addaction name="actionBuild_VBR_time_map" />
+    <addaction name="actionSave_2" />
+    <addaction name="actionFilters_2" />
+   </widget>
+   <widget class="QMenu" name="menuVideo" >
+    <property name="title" >
+     <string>Video</string>
+    </property>
+    <addaction name="actionDecoder_options" />
+    <addaction name="actionPostprocessing" />
+    <addaction name="separator" />
+    <addaction name="separator" />
+    <addaction name="actionFilters" />
+    <addaction name="actionFrame_rate" />
+   </widget>
    <widget class="QMenu" name="menuFile" >
     <property name="title" >
      <string>File</string>
@@ -939,39 +970,11 @@
     <addaction name="actionSave_project" />
     <addaction name="actionSave_project_as" />
     <addaction name="separator" />
+    <addaction name="actionAdd_to_joblist" />
+    <addaction name="actionShow_Joblist" />
+    <addaction name="separator" />
     <addaction name="actionQuit" />
    </widget>
-   <widget class="QMenu" name="menuAuto" >
-    <property name="title" >
-     <string>Auto</string>
-    </property>
-    <addaction name="actionVCD" />
-    <addaction name="actionSVCD" />
-    <addaction name="actionDVD" />
-    <addaction name="actionPSP" />
-    <addaction name="actionPSP_H264" />
-   </widget>
-   <widget class="QMenu" name="menuAudio" >
-    <property name="title" >
-     <string>Audio</string>
-    </property>
-    <addaction name="actionMain_Track" />
-    <addaction name="actionSecondary_Track" />
-    <addaction name="actionBuild_VBR_time_map" />
-    <addaction name="actionSave_2" />
-    <addaction name="actionFilters_2" />
-   </widget>
-   <widget class="QMenu" name="menuVideo" >
-    <property name="title" >
-     <string>Video</string>
-    </property>
-    <addaction name="actionDecoder_options" />
-    <addaction name="actionPostprocessing" />
-    <addaction name="separator" />
-    <addaction name="separator" />
-    <addaction name="actionFilters" />
-    <addaction name="actionFrame_rate" />
-   </widget>
    <addaction name="menuFile" />
    <addaction name="menuEdit" />
    <addaction name="menuView" />
@@ -1411,6 +1414,16 @@
     <string>PSP (H264)</string>
    </property>
   </action>
+  <action name="actionAdd_to_joblist" >
+   <property name="text" >
+    <string>Add to joblist</string>
+   </property>
+  </action>
+  <action name="actionShow_Joblist" >
+   <property name="text" >
+    <string>Show Joblist</string>
+   </property>
+  </action>
  </widget>
  <customwidgets>
   <customwidget>

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/translation_table.h
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/translation_table.h	2007-06-30 09:42:02 UTC (rev 3323)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/translation_table.h	2007-07-01 08:18:15 UTC (rev 3324)
@@ -66,7 +66,9 @@
 PROCESS(actionSVCD,ACT_AUTO_SVCD) \
 PROCESS(actionDVD,ACT_AUTO_DVD) \
 PROCESS(actionPSP,ACT_AUTO_PSP) \
-PROCESS(actionPSP_H264,ACT_AUTO_PSP_H264) 
+PROCESS(actionPSP_H264,ACT_AUTO_PSP_H264)\
+PROCESS(actionAdd_to_joblist,ACT_ADD_JOB) \
+PROCESS(actionShow_Joblist,ACT_HANDLE_JOB)  
 
 
 



From mean at mail.berlios.de  Sun Jul  1 18:12:06 2007
From: mean at mail.berlios.de (mean at BerliOS)
Date: Sun, 1 Jul 2007 18:12:06 +0200
Subject: [Avidemux-svn-commit] r3325 - in
	branches/avidemux_2.4_branch/avidemux: ADM_audio
	ADM_userInterfaces/ADM_GTK/ADM_dialog
	ADM_userInterfaces/ADM_NONE/ADM_dialog
	ADM_userInterfaces/ADM_QT4/ADM_dialog
	ADM_userInterfaces/ADM_commonUI ADM_video ADM_videoFilter
Message-ID: <200707011612.l61GC6h2010171@sheep.berlios.de>

Author: mean
Date: 2007-07-01 18:12:05 +0200 (Sun, 01 Jul 2007)
New Revision: 3325

Added:
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_animated.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/ADM_vidAnimated.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/ADM_vidAnimated.h
   branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/ADM_vidAnimated_param.h
Removed:
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_animated.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_video/ADM_vidAnimated.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_video/ADM_vidAnimated.h
   branches/avidemux_2.4_branch/avidemux/ADM_video/ADM_vidAnimated_param.h
Modified:
   branches/avidemux_2.4_branch/avidemux/ADM_audio/ADM_aacinfo.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/CMakeLists.txt
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/Makefile.am
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_NONE/ADM_dialog/DIA_none.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_none.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/CMakeLists.txt
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/Makefile.am
   branches/avidemux_2.4_branch/avidemux/ADM_video/CMakeLists.txt
   branches/avidemux_2.4_branch/avidemux/ADM_video/Makefile.am
   branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/CMakeLists.txt
   branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/Makefile.am
Log:
move animated to videoFilter and redo dialog with dialogFactory

Modified: branches/avidemux_2.4_branch/avidemux/ADM_audio/ADM_aacinfo.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_audio/ADM_aacinfo.cpp	2007-07-01 08:18:15 UTC (rev 3324)
+++ branches/avidemux_2.4_branch/avidemux/ADM_audio/ADM_aacinfo.cpp	2007-07-01 16:12:05 UTC (rev 3325)
@@ -96,7 +96,7 @@
 				a[7]=stream[start+7];
 				if(start>=maxSearch-7) break;
 				start++;
-				if(a[0]==0xff && ((a[1]&0xF0)==0xF0))
+				if(a[0]==0xff && ((a[1]&0xF6)==0xF0))
 				{
 					// Layer
                                         part=a[1]&0xf;

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/CMakeLists.txt
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/CMakeLists.txt	2007-07-01 08:18:15 UTC (rev 3324)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/CMakeLists.txt	2007-07-01 16:12:05 UTC (rev 3325)
@@ -7,7 +7,7 @@
 SET(${ADM_LIB}_SRCS
 DIA_about.cpp     DIA_calculator.cpp   DIA_crop.cpp       DIA_flyDialog.cpp  DIA_mpdelogo.cpp  DIA_preview.cpp     DIA_srt.cpp      DIA_xvid4.cpp
 DIA_acodec.cpp    DIA_chromaShift.cpp  DIA_encoding.cpp   DIA_hue.cpp        DIA_ocr.cpp       DIA_properties.cpp  DIA_vcodec.cpp   DIA_xvid.cpp
-DIA_animated.cpp  DIA_cnr2.cpp         DIA_eq2.cpp        DIA_idx_pg.cpp     DIA_partial.cpp   DIA_quota.cpp       DIA_vobsub.cpp
+DIA_cnr2.cpp         DIA_eq2.cpp        DIA_idx_pg.cpp     DIA_partial.cpp   DIA_quota.cpp       DIA_vobsub.cpp
 DIA_asharp.cpp    DIA_coloryuv.cpp     DIA_equalizer.cpp  DIA_jobs.cpp       DIA_pause.cpp     DIA_recent.cpp      DIA_working.cpp
 DIA_busy.cpp      DIA_contrast.cpp     DIA_exLame.cpp     DIA_jobs_save.cpp  DIA_pipe.cpp      DIA_resize.cpp      DIA_x264.cpp
 )

Deleted: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_animated.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_animated.cpp	2007-07-01 08:18:15 UTC (rev 3324)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_animated.cpp	2007-07-01 16:12:05 UTC (rev 3325)
@@ -1,437 +0,0 @@
-/***************************************************************************
-                          DIA_animated
-    copyright            : (C) 2006 by mean
-    email                : fixounet at free.fr
- ***************************************************************************/
-
-/***************************************************************************
- *                                                                         *
- *   This program is free software; you can redistribute it and/or modify  *
- *   it under the terms of the GNU General Public License as published by  *
- *   the Free Software Foundation; either version 2 of the License, or     *
- *   (at your option) any later version.                                   *
- *                                                                         *
- ***************************************************************************/
-
-
-
-#include <config.h>
-
-
-#include <string.h>
-#include <stdio.h>
-#include "default.h"
-#include "ADM_toolkit_gtk/ADM_gladeSupport.h"
-#include "ADM_toolkit_gtk/toolkit_gtk.h"
-#include "ADM_toolkit_gtk/toolkit_gtk_include.h"
-
-# include <math.h>
-
-
-#include "ADM_image.h"
-#include "ADM_video/ADM_genvideo.hxx"
-#include "ADM_video/ADM_vidAnimated_param.h"
-#include "ADM_toolkit/filesel.h"
-#include "ADM_assert.h"
-
-
-uint8_t DIA_animated(ANIMATED_PARAM *param);
-
-static GtkWidget	*create_dialog1 (void);
-
-#define SPIN_GET(x,y) {param->y= gtk_spin_button_get_value_as_int(GTK_SPIN_BUTTON(WID(x))) ;}
-#define SPIN_SET(x,y)  {gtk_spin_button_set_value(GTK_SPIN_BUTTON(WID(x)),(gfloat)param->y) ;}
-#define CHECK_GET(x,y) {param->y=gtk_toggle_button_get_active( GTK_TOGGLE_BUTTON(WID(x)));}
-#define CHECK_SET(x,y) {gtk_toggle_button_set_active( GTK_TOGGLE_BUTTON(WID(x)),param->y);}	
-#define ENTRY_SET(x,y) {gtk_write_entry_string(WID(x),(char *)y);}
-#define ENTRY_GET(x,y) {y= (ADM_filename *) ADM_strdup(gtk_editable_get_chars(GTK_EDITABLE ((WID(x))), 0, -1));}
-#define ASSOCIATE(x,y)   gtk_dialog_add_action_widget (GTK_DIALOG (dialog), WID(x),y)
-
-#define LOAD_BGD 0x101
-
-uint8_t DIA_animated(ANIMATED_PARAM *param)
-{
-    uint8_t ret=0;
-    GtkWidget *dialog;
-    const char *entries[MAX_VIGNETTE]={"spinbuttonTC0","spinbuttonTC1","spinbuttonTC2",
-                            "spinbuttonTC3","spinbuttonTC4","spinbuttonTC5" };
-
-        dialog=create_dialog1();
-        gtk_register_dialog(dialog);
-
-        CHECK_SET(checkbuttonStd,isNTSC);
-        SPIN_SET(spinbuttonvignetteW,vignetteW);
-        SPIN_SET(spinbuttonvignetteH,vignetteH);
-        if(param->backgroundImg)
-            ENTRY_SET(entryBgd,param->backgroundImg);
-        for(int i=0;i<MAX_VIGNETTE;i++)
-        {
-                gtk_spin_button_set_value(GTK_SPIN_BUTTON(lookup_widget(dialog,entries[i])),
-                    (gfloat)param->timecode[i]) ;
-        }
-
-        ASSOCIATE(button1,LOAD_BGD);
-        //gtk_widget_show(dialog);
-        int action;
-
-        while(1)
-        {
-            action=gtk_dialog_run(GTK_DIALOG(dialog));
-            if(action==LOAD_BGD)
-            {
-                char *nw;
-                    GUI_FileSelRead(_("Select background picture"), &nw);
-                    if(nw)
-                    {
-                        ENTRY_SET(entryBgd,nw);
-                        ADM_dealloc(nw);
-                    }
-
-                continue;
-            }
-            break;
-        }
-        if(action==GTK_RESPONSE_OK)
-        {
-            CHECK_GET(checkbuttonStd,isNTSC);
-            SPIN_GET(spinbuttonvignetteW,vignetteW);
-            SPIN_GET(spinbuttonvignetteH,vignetteH);
-
-            if(param->backgroundImg) ADM_dealloc(param->backgroundImg);
-            param->backgroundImg=NULL;
-            ENTRY_GET(entryBgd,param->backgroundImg);
-
-            for(int i=0;i<MAX_VIGNETTE;i++)
-            {
-                
-                param->timecode[i]=(uint32_t)gtk_spin_button_get_value(GTK_SPIN_BUTTON(lookup_widget(dialog,entries[i]))) ;
-            }
-            ret=1;
-        }
-
-        gtk_unregister_dialog(dialog);
-        gtk_widget_destroy(dialog);
-        return ret;
-}
-GtkWidget*
-create_dialog1 (void)
-{
-  GtkWidget *dialog1;
-  GtkWidget *dialog_vbox1;
-  GtkWidget *vbox1;
-  GtkWidget *frame1;
-  GtkWidget *alignment1;
-  GtkWidget *table2;
-  GtkWidget *label9;
-  GtkWidget *label10;
-  GtkWidget *checkbuttonStd;
-  GtkWidget *hbox2;
-  GtkWidget *entryBgd;
-  GtkWidget *button1;
-  GtkWidget *label11;
-  GtkWidget *label12;
-  GtkObject *spinbuttonvignetteH_adj;
-  GtkWidget *spinbuttonvignetteH;
-  GtkObject *spinbuttonvignetteW_adj;
-  GtkWidget *spinbuttonvignetteW;
-  GtkWidget *General;
-  GtkWidget *frame2;
-  GtkWidget *alignment2;
-  GtkWidget *table1;
-  GtkWidget *label3;
-  GtkWidget *label4;
-  GtkWidget *label5;
-  GtkWidget *label6;
-  GtkWidget *label7;
-  GtkWidget *label8;
-  GtkObject *spinbuttonTC0_adj;
-  GtkWidget *spinbuttonTC0;
-  GtkObject *spinbuttonTC1_adj;
-  GtkWidget *spinbuttonTC1;
-  GtkObject *spinbuttonTC2_adj;
-  GtkWidget *spinbuttonTC2;
-  GtkObject *spinbuttonTC3_adj;
-  GtkWidget *spinbuttonTC3;
-  GtkObject *spinbuttonTC4_adj;
-  GtkWidget *spinbuttonTC4;
-  GtkObject *spinbuttonTC5_adj;
-  GtkWidget *spinbuttonTC5;
-  GtkWidget *label2;
-  GtkWidget *hseparator1;
-  GtkWidget *dialog_action_area1;
-  GtkWidget *cancelbutton1;
-  GtkWidget *okbutton1;
-  GtkTooltips *tooltips;
-
-  tooltips = gtk_tooltips_new ();
-
-  dialog1 = gtk_dialog_new ();
-  gtk_window_set_title (GTK_WINDOW (dialog1), _("Animated Menu"));
-  gtk_window_set_type_hint (GTK_WINDOW (dialog1), GDK_WINDOW_TYPE_HINT_DIALOG);
-
-  dialog_vbox1 = GTK_DIALOG (dialog1)->vbox;
-  gtk_widget_show (dialog_vbox1);
-
-  vbox1 = gtk_vbox_new (FALSE, 0);
-  gtk_widget_show (vbox1);
-  gtk_box_pack_start (GTK_BOX (dialog_vbox1), vbox1, TRUE, TRUE, 0);
-
-  frame1 = gtk_frame_new (NULL);
-  gtk_widget_show (frame1);
-  gtk_box_pack_start (GTK_BOX (vbox1), frame1, TRUE, TRUE, 0);
-  gtk_frame_set_shadow_type (GTK_FRAME (frame1), GTK_SHADOW_NONE);
-
-  alignment1 = gtk_alignment_new (0.5, 0.5, 1, 1);
-  gtk_widget_show (alignment1);
-  gtk_container_add (GTK_CONTAINER (frame1), alignment1);
-  gtk_alignment_set_padding (GTK_ALIGNMENT (alignment1), 0, 0, 12, 0);
-
-  table2 = gtk_table_new (4, 2, FALSE);
-  gtk_widget_show (table2);
-  gtk_container_add (GTK_CONTAINER (alignment1), table2);
-
-  label9 = gtk_label_new (_("BackGround Image :"));
-  gtk_widget_show (label9);
-  gtk_table_attach (GTK_TABLE (table2), label9, 0, 1, 0, 1,
-                    (GtkAttachOptions) (GTK_FILL),
-                    (GtkAttachOptions) (0), 0, 0);
-  gtk_misc_set_alignment (GTK_MISC (label9), 0, 0.5);
-
-  label10 = gtk_label_new (_("Standard"));
-  gtk_widget_show (label10);
-  gtk_table_attach (GTK_TABLE (table2), label10, 0, 1, 1, 2,
-                    (GtkAttachOptions) (GTK_FILL),
-                    (GtkAttachOptions) (0), 0, 0);
-  gtk_misc_set_alignment (GTK_MISC (label10), 0, 0.5);
-
-  checkbuttonStd = gtk_check_button_new_with_mnemonic (_("NTSC (default is PAL)"));
-  gtk_widget_show (checkbuttonStd);
-  gtk_table_attach (GTK_TABLE (table2), checkbuttonStd, 1, 2, 1, 2,
-                    (GtkAttachOptions) (GTK_FILL),
-                    (GtkAttachOptions) (0), 0, 0);
-
-  hbox2 = gtk_hbox_new (FALSE, 0);
-  gtk_widget_show (hbox2);
-  gtk_table_attach (GTK_TABLE (table2), hbox2, 1, 2, 0, 1,
-                    (GtkAttachOptions) (GTK_FILL),
-                    (GtkAttachOptions) (GTK_FILL), 0, 0);
-
-  entryBgd = gtk_entry_new ();
-  gtk_widget_show (entryBgd);
-  gtk_box_pack_start (GTK_BOX (hbox2), entryBgd, TRUE, FALSE, 0);
-
-  button1 = gtk_button_new_from_stock ("gtk-open");
-  gtk_widget_show (button1);
-  gtk_box_pack_start (GTK_BOX (hbox2), button1, FALSE, FALSE, 0);
-
-  label11 = gtk_label_new (_("Vignette Width"));
-  gtk_widget_show (label11);
-  gtk_table_attach (GTK_TABLE (table2), label11, 0, 1, 2, 3,
-                    (GtkAttachOptions) (GTK_FILL),
-                    (GtkAttachOptions) (0), 0, 0);
-  gtk_misc_set_alignment (GTK_MISC (label11), 0, 0.5);
-
-  label12 = gtk_label_new (_("Vignette Height"));
-  gtk_widget_show (label12);
-  gtk_table_attach (GTK_TABLE (table2), label12, 0, 1, 3, 4,
-                    (GtkAttachOptions) (GTK_FILL),
-                    (GtkAttachOptions) (0), 0, 0);
-  gtk_misc_set_alignment (GTK_MISC (label12), 0, 0.5);
-
-  spinbuttonvignetteH_adj = gtk_adjustment_new (1, 16, 240, 2, 10, 10);
-  spinbuttonvignetteH = gtk_spin_button_new (GTK_ADJUSTMENT (spinbuttonvignetteH_adj), 1, 0);
-  gtk_widget_show (spinbuttonvignetteH);
-  gtk_table_attach (GTK_TABLE (table2), spinbuttonvignetteH, 1, 2, 3, 4,
-                    (GtkAttachOptions) (GTK_FILL),
-                    (GtkAttachOptions) (0), 0, 0);
-  gtk_spin_button_set_numeric (GTK_SPIN_BUTTON (spinbuttonvignetteH), TRUE);
-
-  spinbuttonvignetteW_adj = gtk_adjustment_new (1, 16, 240, 2, 10, 10);
-  spinbuttonvignetteW = gtk_spin_button_new (GTK_ADJUSTMENT (spinbuttonvignetteW_adj), 1, 0);
-  gtk_widget_show (spinbuttonvignetteW);
-  gtk_table_attach (GTK_TABLE (table2), spinbuttonvignetteW, 1, 2, 2, 3,
-                    (GtkAttachOptions) (GTK_FILL),
-                    (GtkAttachOptions) (0), 0, 0);
-  gtk_spin_button_set_numeric (GTK_SPIN_BUTTON (spinbuttonvignetteW), TRUE);
-
-  General = gtk_label_new (_("<b>General</b>"));
-  gtk_widget_show (General);
-  gtk_frame_set_label_widget (GTK_FRAME (frame1), General);
-  gtk_label_set_use_markup (GTK_LABEL (General), TRUE);
-
-  frame2 = gtk_frame_new (NULL);
-  gtk_widget_show (frame2);
-  gtk_box_pack_start (GTK_BOX (vbox1), frame2, TRUE, TRUE, 0);
-  gtk_frame_set_shadow_type (GTK_FRAME (frame2), GTK_SHADOW_NONE);
-
-  alignment2 = gtk_alignment_new (0.5, 0.5, 1, 1);
-  gtk_widget_show (alignment2);
-  gtk_container_add (GTK_CONTAINER (frame2), alignment2);
-  gtk_alignment_set_padding (GTK_ALIGNMENT (alignment2), 0, 0, 12, 0);
-
-  table1 = gtk_table_new (6, 2, FALSE);
-  gtk_widget_show (table1);
-  gtk_container_add (GTK_CONTAINER (alignment2), table1);
-
-  label3 = gtk_label_new (_("Chapter 1"));
-  gtk_widget_show (label3);
-  gtk_table_attach (GTK_TABLE (table1), label3, 0, 1, 0, 1,
-                    (GtkAttachOptions) (GTK_FILL),
-                    (GtkAttachOptions) (0), 0, 0);
-  gtk_misc_set_alignment (GTK_MISC (label3), 0, 0.5);
-
-  label4 = gtk_label_new (_("Chapter 2"));
-  gtk_widget_show (label4);
-  gtk_table_attach (GTK_TABLE (table1), label4, 0, 1, 1, 2,
-                    (GtkAttachOptions) (GTK_FILL),
-                    (GtkAttachOptions) (0), 0, 0);
-  gtk_misc_set_alignment (GTK_MISC (label4), 0, 0.5);
-
-  label5 = gtk_label_new (_("Chapter 3"));
-  gtk_widget_show (label5);
-  gtk_table_attach (GTK_TABLE (table1), label5, 0, 1, 2, 3,
-                    (GtkAttachOptions) (GTK_FILL),
-                    (GtkAttachOptions) (0), 0, 0);
-  gtk_misc_set_alignment (GTK_MISC (label5), 0, 0.5);
-
-  label6 = gtk_label_new (_("Chapter 4"));
-  gtk_widget_show (label6);
-  gtk_table_attach (GTK_TABLE (table1), label6, 0, 1, 3, 4,
-                    (GtkAttachOptions) (GTK_FILL),
-                    (GtkAttachOptions) (0), 0, 0);
-  gtk_misc_set_alignment (GTK_MISC (label6), 0, 0.5);
-
-  label7 = gtk_label_new (_("Chapter 5"));
-  gtk_widget_show (label7);
-  gtk_table_attach (GTK_TABLE (table1), label7, 0, 1, 4, 5,
-                    (GtkAttachOptions) (GTK_FILL),
-                    (GtkAttachOptions) (0), 0, 0);
-  gtk_misc_set_alignment (GTK_MISC (label7), 0, 0.5);
-
-  label8 = gtk_label_new (_("Chapter 6"));
-  gtk_widget_show (label8);
-  gtk_table_attach (GTK_TABLE (table1), label8, 0, 1, 5, 6,
-                    (GtkAttachOptions) (GTK_FILL),
-                    (GtkAttachOptions) (0), 0, 0);
-  gtk_misc_set_alignment (GTK_MISC (label8), 0, 0.5);
-
-  spinbuttonTC0_adj = gtk_adjustment_new (160, 0, 900000, 2, 10, 10);
-  spinbuttonTC0 = gtk_spin_button_new (GTK_ADJUSTMENT (spinbuttonTC0_adj), 1, 0);
-  gtk_widget_show (spinbuttonTC0);
-  gtk_table_attach (GTK_TABLE (table1), spinbuttonTC0, 1, 2, 0, 1,
-                    (GtkAttachOptions) (GTK_FILL),
-                    (GtkAttachOptions) (0), 0, 0);
-  gtk_tooltips_set_tip (tooltips, spinbuttonTC0, _("Start frame for this vignette."), NULL);
-  gtk_spin_button_set_numeric (GTK_SPIN_BUTTON (spinbuttonTC0), TRUE);
-
-  spinbuttonTC1_adj = gtk_adjustment_new (160, 0, 900000, 2, 10, 10);
-  spinbuttonTC1 = gtk_spin_button_new (GTK_ADJUSTMENT (spinbuttonTC1_adj), 1, 0);
-  gtk_widget_show (spinbuttonTC1);
-  gtk_table_attach (GTK_TABLE (table1), spinbuttonTC1, 1, 2, 1, 2,
-                    (GtkAttachOptions) (GTK_EXPAND | GTK_FILL),
-                    (GtkAttachOptions) (0), 0, 0);
-  gtk_tooltips_set_tip (tooltips, spinbuttonTC1, _("Start frame for this vignette."), NULL);
-  gtk_spin_button_set_numeric (GTK_SPIN_BUTTON (spinbuttonTC1), TRUE);
-
-  spinbuttonTC2_adj = gtk_adjustment_new (160, 0, 900000, 2, 10, 10);
-  spinbuttonTC2 = gtk_spin_button_new (GTK_ADJUSTMENT (spinbuttonTC2_adj), 1, 0);
-  gtk_widget_show (spinbuttonTC2);
-  gtk_table_attach (GTK_TABLE (table1), spinbuttonTC2, 1, 2, 2, 3,
-                    (GtkAttachOptions) (GTK_EXPAND | GTK_FILL),
-                    (GtkAttachOptions) (0), 0, 0);
-  gtk_tooltips_set_tip (tooltips, spinbuttonTC2, _("Start frame for this vignette."), NULL);
-  gtk_spin_button_set_numeric (GTK_SPIN_BUTTON (spinbuttonTC2), TRUE);
-
-  spinbuttonTC3_adj = gtk_adjustment_new (160, 0, 900000, 2, 10, 10);
-  spinbuttonTC3 = gtk_spin_button_new (GTK_ADJUSTMENT (spinbuttonTC3_adj), 1, 0);
-  gtk_widget_show (spinbuttonTC3);
-  gtk_table_attach (GTK_TABLE (table1), spinbuttonTC3, 1, 2, 3, 4,
-                    (GtkAttachOptions) (GTK_EXPAND | GTK_FILL),
-                    (GtkAttachOptions) (0), 0, 0);
-  gtk_tooltips_set_tip (tooltips, spinbuttonTC3, _("Start frame for this vignette."), NULL);
-  gtk_spin_button_set_numeric (GTK_SPIN_BUTTON (spinbuttonTC3), TRUE);
-
-  spinbuttonTC4_adj = gtk_adjustment_new (160, 0, 900000, 2, 10, 10);
-  spinbuttonTC4 = gtk_spin_button_new (GTK_ADJUSTMENT (spinbuttonTC4_adj), 1, 0);
-  gtk_widget_show (spinbuttonTC4);
-  gtk_table_attach (GTK_TABLE (table1), spinbuttonTC4, 1, 2, 4, 5,
-                    (GtkAttachOptions) (GTK_EXPAND | GTK_FILL),
-                    (GtkAttachOptions) (0), 0, 0);
-  gtk_tooltips_set_tip (tooltips, spinbuttonTC4, _("Start frame for this vignette."), NULL);
-  gtk_spin_button_set_numeric (GTK_SPIN_BUTTON (spinbuttonTC4), TRUE);
-
-  spinbuttonTC5_adj = gtk_adjustment_new (160, 0, 900000, 2, 10, 10);
-  spinbuttonTC5 = gtk_spin_button_new (GTK_ADJUSTMENT (spinbuttonTC5_adj), 1, 0);
-  gtk_widget_show (spinbuttonTC5);
-  gtk_table_attach (GTK_TABLE (table1), spinbuttonTC5, 1, 2, 5, 6,
-                    (GtkAttachOptions) (GTK_EXPAND | GTK_FILL),
-                    (GtkAttachOptions) (0), 0, 0);
-  gtk_tooltips_set_tip (tooltips, spinbuttonTC5, _("Start frame for this vignette."), NULL);
-  gtk_spin_button_set_numeric (GTK_SPIN_BUTTON (spinbuttonTC5), TRUE);
-
-  label2 = gtk_label_new (_("<b>TimeCode</b>"));
-  gtk_widget_show (label2);
-  gtk_frame_set_label_widget (GTK_FRAME (frame2), label2);
-  gtk_label_set_use_markup (GTK_LABEL (label2), TRUE);
-
-  hseparator1 = gtk_hseparator_new ();
-  gtk_widget_show (hseparator1);
-  gtk_box_pack_start (GTK_BOX (vbox1), hseparator1, TRUE, TRUE, 0);
-
-  dialog_action_area1 = GTK_DIALOG (dialog1)->action_area;
-  gtk_widget_show (dialog_action_area1);
-  gtk_button_box_set_layout (GTK_BUTTON_BOX (dialog_action_area1), GTK_BUTTONBOX_END);
-
-  cancelbutton1 = gtk_button_new_from_stock ("gtk-cancel");
-  gtk_widget_show (cancelbutton1);
-  gtk_dialog_add_action_widget (GTK_DIALOG (dialog1), cancelbutton1, GTK_RESPONSE_CANCEL);
-  GTK_WIDGET_SET_FLAGS (cancelbutton1, GTK_CAN_DEFAULT);
-
-  okbutton1 = gtk_button_new_from_stock ("gtk-ok");
-  gtk_widget_show (okbutton1);
-  gtk_dialog_add_action_widget (GTK_DIALOG (dialog1), okbutton1, GTK_RESPONSE_OK);
-  GTK_WIDGET_SET_FLAGS (okbutton1, GTK_CAN_DEFAULT);
-
-  /* Store pointers to all widgets, for use by lookup_widget(). */
-  GLADE_HOOKUP_OBJECT_NO_REF (dialog1, dialog1, "dialog1");
-  GLADE_HOOKUP_OBJECT_NO_REF (dialog1, dialog_vbox1, "dialog_vbox1");
-  GLADE_HOOKUP_OBJECT (dialog1, vbox1, "vbox1");
-  GLADE_HOOKUP_OBJECT (dialog1, frame1, "frame1");
-  GLADE_HOOKUP_OBJECT (dialog1, alignment1, "alignment1");
-  GLADE_HOOKUP_OBJECT (dialog1, table2, "table2");
-  GLADE_HOOKUP_OBJECT (dialog1, label9, "label9");
-  GLADE_HOOKUP_OBJECT (dialog1, label10, "label10");
-  GLADE_HOOKUP_OBJECT (dialog1, checkbuttonStd, "checkbuttonStd");
-  GLADE_HOOKUP_OBJECT (dialog1, hbox2, "hbox2");
-  GLADE_HOOKUP_OBJECT (dialog1, entryBgd, "entryBgd");
-  GLADE_HOOKUP_OBJECT (dialog1, button1, "button1");
-  GLADE_HOOKUP_OBJECT (dialog1, label11, "label11");
-  GLADE_HOOKUP_OBJECT (dialog1, label12, "label12");
-  GLADE_HOOKUP_OBJECT (dialog1, spinbuttonvignetteH, "spinbuttonvignetteH");
-  GLADE_HOOKUP_OBJECT (dialog1, spinbuttonvignetteW, "spinbuttonvignetteW");
-  GLADE_HOOKUP_OBJECT (dialog1, General, "General");
-  GLADE_HOOKUP_OBJECT (dialog1, frame2, "frame2");
-  GLADE_HOOKUP_OBJECT (dialog1, alignment2, "alignment2");
-  GLADE_HOOKUP_OBJECT (dialog1, table1, "table1");
-  GLADE_HOOKUP_OBJECT (dialog1, label3, "label3");
-  GLADE_HOOKUP_OBJECT (dialog1, label4, "label4");
-  GLADE_HOOKUP_OBJECT (dialog1, label5, "label5");
-  GLADE_HOOKUP_OBJECT (dialog1, label6, "label6");
-  GLADE_HOOKUP_OBJECT (dialog1, label7, "label7");
-  GLADE_HOOKUP_OBJECT (dialog1, label8, "label8");
-  GLADE_HOOKUP_OBJECT (dialog1, spinbuttonTC0, "spinbuttonTC0");
-  GLADE_HOOKUP_OBJECT (dialog1, spinbuttonTC1, "spinbuttonTC1");
-  GLADE_HOOKUP_OBJECT (dialog1, spinbuttonTC2, "spinbuttonTC2");
-  GLADE_HOOKUP_OBJECT (dialog1, spinbuttonTC3, "spinbuttonTC3");
-  GLADE_HOOKUP_OBJECT (dialog1, spinbuttonTC4, "spinbuttonTC4");
-  GLADE_HOOKUP_OBJECT (dialog1, spinbuttonTC5, "spinbuttonTC5");
-  GLADE_HOOKUP_OBJECT (dialog1, label2, "label2");
-  GLADE_HOOKUP_OBJECT (dialog1, hseparator1, "hseparator1");
-  GLADE_HOOKUP_OBJECT_NO_REF (dialog1, dialog_action_area1, "dialog_action_area1");
-  GLADE_HOOKUP_OBJECT (dialog1, cancelbutton1, "cancelbutton1");
-  GLADE_HOOKUP_OBJECT (dialog1, okbutton1, "okbutton1");
-  GLADE_HOOKUP_OBJECT_NO_REF (dialog1, tooltips, "tooltips");
-
-  return dialog1;
-}
-

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/Makefile.am
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/Makefile.am	2007-07-01 08:18:15 UTC (rev 3324)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/Makefile.am	2007-07-01 16:12:05 UTC (rev 3325)
@@ -27,7 +27,6 @@
         DIA_srt.cpp \
 	DIA_coloryuv.cpp \
 	DIA_quota.cpp \
-	DIA_animated.cpp \
 	DIA_partial.cpp  \
 	DIA_flyDialog.cpp
 
@@ -42,7 +41,7 @@
 DIA_contrast.cpp      DIA_exLame.cpp       DIA_srt.cpp \
 DIA_about.cpp         \
 DIA_acodec.cpp       DIA_crop.cpp          \
-DIA_animated.cpp     DIA_hue.cpp          DIA_ocr.cpp         DIA_vcodec.cpp \
+DIA_hue.cpp          DIA_ocr.cpp         DIA_vcodec.cpp \
 DIA_asharp.cpp       DIA_idx_pg.cpp       DIA_partial.cpp     DIA_vobsub.cpp \
 DIA_idx_pg.h         DIA_pause.cpp       \
 DIA_pipe.cpp        DIA_working.cpp \

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_NONE/ADM_dialog/DIA_none.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_NONE/ADM_dialog/DIA_none.cpp	2007-07-01 08:18:15 UTC (rev 3324)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_NONE/ADM_dialog/DIA_none.cpp	2007-07-01 16:12:05 UTC (rev 3325)
@@ -33,7 +33,7 @@
 #include "ADM_toolkit/filesel.h"
 
 
-#include "ADM_video/ADM_vidAnimated_param.h"
+#include "ADM_videoFilter/ADM_vidAnimated_param.h"
 #include "ADM_video/ADM_vidASharp_param.h"
 #include "ADM_audiofilter/audiofilter_normalize_param.h"
 #include "ADM_video/ADM_vidCNR2_param.h"

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_none.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_none.cpp	2007-07-01 08:18:15 UTC (rev 3324)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_none.cpp	2007-07-01 16:12:05 UTC (rev 3325)
@@ -33,7 +33,7 @@
 #include "ADM_toolkit/filesel.h"
 
 
-#include "ADM_video/ADM_vidAnimated_param.h"
+#include "ADM_videoFilter/ADM_vidAnimated_param.h"
 #include "ADM_video/ADM_vidASharp_param.h"
 #include "ADM_audiofilter/audiofilter_normalize_param.h"
 #include "ADM_video/ADM_vidCNR2_param.h"
@@ -76,7 +76,6 @@
 		      uint32_t * br,uint32_t *fsize,xvidEncParam *param){return 0;}
 #endif
 int     DIA_coloryuv(COLOR_YUV_PARAM *param){return 0;}
-uint8_t DIA_animated(ANIMATED_PARAM *param){return 0;}
 uint8_t DIA_cnr2(CNR2Param *param){return 0;}
 uint8_t DIA_getEQ2Param(Eq2_Param *param, AVDMGenericVideoStream *in){return 0;}
 uint8_t DIA_getEqualizer(EqualizerParam *param, ADMImage *image){return 0;}

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/CMakeLists.txt
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/CMakeLists.txt	2007-07-01 08:18:15 UTC (rev 3324)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/CMakeLists.txt	2007-07-01 16:12:05 UTC (rev 3325)
@@ -9,6 +9,7 @@
 DIA_audioFilter.cpp   DIA_enter.cpp           DIA_flyCrop.cpp      DIA_gototime.cpp    DIA_postproc.cpp  DIA_srt.cpp        GUI_render.cpp
 DIA_bitrateHisto.cpp  DIA_flyAsharp.cpp       DIA_flyDialog.cpp    DIA_lavcodec.cpp    DIA_prefs.cpp     DIA_SVCD.cpp       GUI_sdlRender.cpp
 DIA_builtin.cpp       DIA_flyChromaShift.cpp  DIA_flyHue.cpp       DIA_lavDecoder.cpp  DIA_requant.cpp   DIA_tdeint.cpp     GUI_xvRender.cpp
+DIA_animated.cpp
 )
 ADD_LIBRARY(${ADM_LIB} STATIC ${${ADM_LIB}_SRCS})
 ADD_ADM_LIB(${ADM_LIB} ADM_userInterfaces)

Copied: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_animated.cpp (from rev 3318, branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_SVCD.cpp)
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_SVCD.cpp	2007-06-28 17:29:59 UTC (rev 3318)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_animated.cpp	2007-07-01 16:12:05 UTC (rev 3325)
@@ -0,0 +1,64 @@
+//
+//
+// C++ Implementation: DIA_SVCD
+//
+// Description: 
+//
+//
+// Author: mean <fixounet at free.fr>, (C) 2003
+//
+// Copyright: See COPYING file that comes with this distribution
+//
+//
+
+#include <config.h>
+//#include "ADM_lavcodec.h"
+
+
+#include <string.h>
+#include <stdio.h>
+
+# include <math.h>
+
+#include "default.h"
+#include "ADM_videoFilter/ADM_vidAnimated_param.h"
+#include "ADM_assert.h" 
+#include "DIA_factory.h"
+
+/**
+      \fn DIA_animated
+      \brief Dialog to set params for the animated filter
+*/
+uint8_t DIA_animated(ANIMATED_PARAM *param,uint32_t w, uint32_t h,uint32_t n)
+{	
+  uint8_t r=0;
+#define PX(x) &(param->x)
+   diaElemFile      jpeg(0,(char **)PX(backgroundImg),_("_Background Image:"));
+   diaElemToggle    isNtsc(PX(isNTSC),_("_NTSC(default is Pal):"));
+   diaElemUInteger   vignetteW(PX(vignetteW),_("Vignette _Width:"),16,w/3);
+   diaElemUInteger   vignetteH(PX(vignetteH),_("Vignette _Height:"),16,h/2);
+   
+   diaElemUInteger *timecode[MAX_VIGNETTE];
+   diaElemFrame timecodes(_("Vignette frame number"));
+
+   for(int i=0;i<MAX_VIGNETTE;i++)
+   {
+     timecode[i]=new diaElemUInteger(&(param->timecode[i]),_("Timecode:"),0,n);
+     timecodes.swallow(timecode[i]);
+   }
+
+ 
+      diaElem *elems[5]={&jpeg,&isNtsc,&vignetteW,&vignetteH,&timecodes};
+    
+  if( diaFactoryRun("MPEG-2 Configuration",5,elems))
+  {
+    r=1;
+  }
+  for(int i=0;i<MAX_VIGNETTE;i++)
+  {
+    delete timecode[i]; 
+  }
+  
+  return r;
+}	
+// EOF

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/Makefile.am
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/Makefile.am	2007-07-01 08:18:15 UTC (rev 3324)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/Makefile.am	2007-07-01 16:12:05 UTC (rev 3325)
@@ -10,7 +10,8 @@
 DIA_flyHue.cpp \
 DIA_flySrtPos.cpp \
 DIA_tdeint.cpp DIA_v2v.cpp \
-DIA_lavDecoder.cpp  DIA_srt.cpp
+DIA_lavDecoder.cpp  DIA_srt.cpp \
+DIA_animated.cpp
 
 
 INCLUDES = $(all_includes) $(GTK_CFLAGS) $(XML_CFLAGS)  $(FREETYPE_CFLAGS) -DADM_SUBVERSION=@ADM_SUBVERSION@ \

Deleted: branches/avidemux_2.4_branch/avidemux/ADM_video/ADM_vidAnimated.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_video/ADM_vidAnimated.cpp	2007-07-01 08:18:15 UTC (rev 3324)
+++ branches/avidemux_2.4_branch/avidemux/ADM_video/ADM_vidAnimated.cpp	2007-07-01 16:12:05 UTC (rev 3325)
@@ -1,351 +0,0 @@
-
-/***************************************************************************
-    (c)Mean 2006 fixounet at free.fr
- ***************************************************************************/
- 
- /***************************************************************************
- *                                                                         *
- *   This program is free software; you can redistribute it and/or modify  *
- *   it under the terms of the GNU General Public License as published by  *
- *   the Free Software Foundation; either version 2 of the License, or     *
- *   (at your option) any later version.                                   *
- *                                                                         *
- ***************************************************************************/
-#include "config.h"
-#include <stdio.h>
-#include <stdlib.h>
-#include <string.h>
-#include <ADM_assert.h>
-
-#include "config.h"
-#include "fourcc.h"
-#include "avio.hxx"
-#include "avi_vars.h"
-#include "math.h"
-
-#include "ADM_toolkit/toolkit.hxx"
-#include "ADM_editor/ADM_edit.hxx"
-#include "ADM_video/ADM_genvideo.hxx"
-
-
-#include "ADM_osSupport/ADM_debugID.h"
-#define MODULE_NAME MODULE_FILTER
-#include "ADM_osSupport/ADM_debug.h"
-#include "ADM_filter/video_filters.h"
-#include"ADM_video/ADM_vidAnimated.h"
-
-
-#include "ADM_inputs/ADM_inpics/ADM_pics.h"
-
-static FILTER_PARAM animated_template={10,
-    {"tc0","tc1","tc2",
-    "tc3","tc4","tc5",
-    "isNTSC","backgroundImg","vignetteW","vignetteH"
-    }};
-BUILD_CREATE(animated_create,ADMVideoAnimated);
-SCRIPT_CREATE(animated_script,ADMVideoAnimated,animated_template);
-
-#define LOOKUP 4
-#define CACHE_SIZE (LOOKUP*2+3)
-
-
-extern uint8_t DIA_animated(ANIMATED_PARAM *param);
-
-uint8_t ADMVideoAnimated::configure(AVDMGenericVideoStream *in)
-{
-   if(DIA_animated(_param))
-   {
-      setup();
-      return 1;
-   }
-   return 0;
-}
-
-char *ADMVideoAnimated::printConf( void )
-{
-   static char buf[50];
-   sprintf((char *)buf," Animated Menu ");
-   return buf;
-}
-uint8_t ADMVideoAnimated::setup( void)
-{
-    cleanup();
-    for(int i=0;i<MAX_VIGNETTE;i++) _caches[i]=new VideoCache(CACHE_SIZE,_in);  // 18 is good for mpeg2
-    _resizer=new ADMImageResizer(_in->getInfo()->width,_in->getInfo()->height,
-            _param->vignetteW,_param->vignetteH);
-    _image=new ADMImage(_param->vignetteW,_param->vignetteH);
-    loadImage();
-}
-uint8_t ADMVideoAnimated::cleanup( void)
-{
-   
-    for(int i=0;i<MAX_VIGNETTE;i++) 
-    {
-        if(_caches[i]) delete _caches[i];
-        _caches[i]=NULL;
-    }
-    if(_resizer) delete _resizer;
-    if(_image) delete _image;
-    if(_BkgGnd) delete _BkgGnd;
-    _resizer=NULL;
-    _image=NULL;
-    _BkgGnd=NULL;
-
-}
-ADMVideoAnimated::ADMVideoAnimated(AVDMGenericVideoStream *in,CONFcouple *couples) 
-{
-   _resizer=NULL;
-   _image=NULL;
-   _BkgGnd=NULL;
-   for(int i=0;i<MAX_VIGNETTE;i++) _caches[i]=NULL;
-
-   _in=in;
-   memcpy(&_info,_in->getInfo(),sizeof(_info));    
-   _info.encoding=1;
-   _uncompressed=NULL;
-   _param=NEW(ANIMATED_PARAM);
-   if(couples)
-   {
-        GET(isNTSC);
-        GET(backgroundImg);
-        GET(vignetteW);
-        GET(vignetteH);
-#undef GET
-#define GET(x)  couples->getCouple((char *)"tc"#x,&(_param->timecode[x]))
-        GET(0);
-        GET(1);
-        GET(2);
-        GET(3);
-        GET(4);
-        GET(5);
-   }
-   else // Default
-   {
-#define MKP(x,y) _param->x=y;
-            MKP(isNTSC,0);
-            MKP(vignetteW,160);
-            MKP(vignetteH,120);
-#ifdef ADM_WIN32
-       MKP(backgroundImg,(ADM_filename *)ADM_strdup("c:\\test.jpg"));
-#else
-            MKP(backgroundImg,(ADM_filename *)ADM_strdup("/tmp/taist.jpg"));
-#endif
-#undef MKP
-#define MKP(x,y) _param->timecode[x]=y
-        MKP(0,0);
-        MKP(1,100);
-        MKP(2,200);
-        MKP(3,300);
-        MKP(4,500);
-        MKP(5,600);
-   }
-   if(_param->isNTSC) _info.height=480;
-        else _info.height=576;
-    _info.width=720;
-    setup();
-}
-//____________________________________________________________________
-ADMVideoAnimated::~ADMVideoAnimated()
-{
-   if(_param->backgroundImg) ADM_dealloc(_param->backgroundImg);
-   delete _param;
-   _param=NULL;
-   _uncompressed=NULL;
-   cleanup();
-}
-#define BYTE uint8_t 
-#ifndef MAX
-#define MAX(x,y) ((x)>(y) ?(x):(y))
-#endif
-#ifndef MIN
-#define MIN(x,y) ((x)<(y) ?(x):(y))
-#endif
-//_____________________________________________________________
-// It is slow as we should do the resize in place (one 
-//   bunch of memcpy saved)
-// Since it is killing the editor cache anyway, speed it not an issue
-//______________________________________________________________
-uint8_t ADMVideoAnimated::getFrameNumberNoAlloc(uint32_t frame,
-  uint32_t *len,
-  ADMImage *data,
-  uint32_t *flags)
-  {
-    ADMImage *in;
-    uint32_t offset,pool;
-
-    if(frame>= _info.nb_frames) return 0;
-    
-    // Clean the image
-    if(_BkgGnd)
-        data ->duplicate(_BkgGnd);
-    else
-        {
-                data->blacken();
-                printf("No background image\n");
-        }
- const int x_coordinate[3]={LEFT_MARGIN,360-(_param->vignetteW)/2,720-(_param->vignetteW)-LEFT_MARGIN};
- const int y_coordinate[2]={TOP_MARGIN,TOP_MARGIN+(_param->vignetteH)+TOP_MARGIN};
-
-     // Do 3 top
-     for(int line=0;line<2;line++)
-        for(int i=0;i<3;i++)
-        {
-            pool=i+(3*line);
-            if(_param->timecode[pool]+frame<_in->getInfo()->nb_frames) 
-            {
-                // Load LOOKUP frames ...
-                if(!(frame%LOOKUP))
-                    for(int lookup=0;lookup<LOOKUP;lookup++)
-                    {
-                        _caches[pool]->getImage(_param->timecode[pool]+frame+lookup);
-                    }
-                // Unlock them
-                _caches[pool]->unlockAll();
-                in=_caches[pool]->getImage(_param->timecode[pool]+frame);
-                if(in) 
-                {
-                     _resizer->resize(in,_image);
-                    _caches[pool]->unlockAll();
-                }else
-                {   
-                    printf("[Animated] Failed to get image %u for pool %u\n",_param->timecode[pool]+frame,pool);
-                    _image->blacken();
-                }
-            }else
-            {   // Blacken 
-                printf("[Animated] out of bound : %u for pool %u\n",_param->timecode[pool]+frame,pool);
-                 _image->blacken();
-            }
-            // Blit
-
-            _image->copyTo(data,x_coordinate[i],y_coordinate[line]);
-        }
-
-	return 1;
-
-}
-
-
-uint8_t	ADMVideoAnimated::getCoupledConf( CONFcouple **couples)
-{
-   
-      ADM_assert(_param);
-      *couples=new CONFcouple(10);
-#define CSET(x)  (*couples)->setCouple((char *)#x,(_param->x))
-       CSET(isNTSC);
-       CSET(backgroundImg);
-        CSET(vignetteW);
-        CSET(vignetteH);
-#undef CSET
-#define CSET(x)  (*couples)->setCouple((char *)"tc"#x,(_param->timecode[x]))
-        CSET(0);
-        CSET(1);
-        CSET(2);
-        CSET(3);
-        CSET(4);
-        CSET(5);
-
-      return 1;
-}
-uint8_t	ADMVideoAnimated::loadImage(void)
-{
-picHeader *pic=NULL;
-decoders *decoder=NULL;
-ADMImage  *fullSize=NULL;
-ADMImageResizer *resizer=NULL;
-uint32_t len=0,flags_removed=0;
-uint32_t w,h;
-uint8_t *extraData=NULL;
-uint32_t extraDataSize=0;
-
-uint8_t *rdBuffer=NULL;
-
-    if(_BkgGnd) delete _BkgGnd;
-    _BkgGnd=NULL;
-
-    // open the jpg file and load it to binary
-    
-    pic=new picHeader;
-    if(!pic->open((char *)_param->backgroundImg))
-    {
-        printf("[Animated] Cannot load background image\n");
-        goto skipIt;
-    }
-  
-    // Ok, now we need its size
-    
-    w=pic->getWidth();
-    h=pic->getHeight();
-    printf("[Animated]Pic: %d x %d\n",w,h);
-    pic->getExtraHeaderData(&extraDataSize,&extraData);
-    //********
-    {
-        aviInfo info;
-        pic->getVideoInfo(&info);
-        decoder=getDecoder (info.fcc, w,h,extraDataSize,extraData);
-    }
-     if(!decoder) 
-    {
-        printf("[Animated]Cannot get decoder\n");
-        goto skipIt;
-    }
-    // Build new image
-    fullSize=new ADMImage(w,h);
-    fullSize->blacken();
-    rdBuffer=new uint8_t[w*h*3];     // Hardcoded!
-    ADMCompressedImage img;
-    img.data=rdBuffer;
-    if(!pic->getFrameNoAlloc(0,&img))
-    {
-        printf("[Animated]Get frame failed\n");
-        goto skipIt;
-    }
-    // Decode it
-    if(!decoder->uncompress (&img, fullSize))
-    {
-        printf("[Animated]Decoding failed\n");
-        goto skipIt;
-    }
-    if(fullSize->_colorspace!=ADM_COLOR_YV12)
-    {
-        printf("[Animated]Wrong colorspace, only yv12 supported\n");
-        goto skipIt;
-    }
-    // Need to packit ?
-    if(fullSize->_planeStride[0])
-        fullSize->pack(0);
-    // Resize it
-    _BkgGnd=new ADMImage(_info.width,_info.height);
-    resizer=new ADMImageResizer(w,h,_info.width,_info.height);
-    //Util_saveJpg ("/tmp/before.jpg",w,h,fullSize);
-    if(!resizer->resize(fullSize,_BkgGnd))
-    {
-        delete _BkgGnd;
-        _BkgGnd=NULL;
-        printf("[Animated]Resize failed\n");
-        
-    }else
-    {
-        printf("[Animated]Image ready\n");
-    }
-    
-skipIt:
-    {
-        if(decoder) delete decoder;
-        decoder=NULL;
-        if(pic)     delete pic;
-        pic=NULL;
-        if(fullSize)     delete fullSize;
-        fullSize=NULL;
-        if(resizer)     delete resizer;
-        resizer=NULL;
-        if(rdBuffer)     delete [] rdBuffer;
-        rdBuffer=NULL;
-    }
-    return 1;
-
-
-}
-
-
-// EOF

Deleted: branches/avidemux_2.4_branch/avidemux/ADM_video/ADM_vidAnimated.h
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_video/ADM_vidAnimated.h	2007-07-01 08:18:15 UTC (rev 3324)
+++ branches/avidemux_2.4_branch/avidemux/ADM_video/ADM_vidAnimated.h	2007-07-01 16:12:05 UTC (rev 3325)
@@ -1,50 +0,0 @@
-/***************************************************************************
-                          Port of avisynth ColorYuv Filter
-    copyright            : (C) 2006 by mean
- ***************************************************************************/
-
-/***************************************************************************
- *                                                                         *
- *   This program is free software; you can redistribute it and/or modify  *
- *   it under the terms of the GNU General Public License as published by  *
- *   the Free Software Foundation; either version 2 of the License, or     *
- *   (at your option) any later version.                                   *
- *                                                                         *
- ***************************************************************************/
-#ifndef ADM_VID_ANIMATED_H
-#define ADM_VID_ANIMATED_H
-
-
-
-#define LEFT_MARGIN 50
-#define TOP_MARGIN 50
-
-#include "ADM_vidAnimated_param.h"
-#include "ADM_video/ADM_cache.h"
-
-class  ADMVideoAnimated:public AVDMGenericVideoStream
-{
-
-    protected:
-
-        virtual     char            *printConf(void) ;
-                    ANIMATED_PARAM  *_param;
-                    ADMImageResizer *_resizer;
-                    ADMImage        *_image;
-                    ADMImage        *_BkgGnd;
-                    VideoCache      *_caches[MAX_VIGNETTE];
-                    uint8_t         setup( void);
-                    uint8_t         cleanup( void);
-                    uint8_t         loadImage(void);
-    public:
-                    ADMVideoAnimated(  AVDMGenericVideoStream *in,CONFcouple *setup);
-                    ~ADMVideoAnimated();
-        virtual uint8_t getFrameNumberNoAlloc(uint32_t frame, uint32_t *len,
-                ADMImage *data,uint32_t *flags);
-
-        virtual uint8_t configure( AVDMGenericVideoStream *instream) ;
-        virtual uint8_t getCoupledConf( CONFcouple **couples);
-
-}     ;
-
-#endif

Deleted: branches/avidemux_2.4_branch/avidemux/ADM_video/ADM_vidAnimated_param.h
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_video/ADM_vidAnimated_param.h	2007-07-01 08:18:15 UTC (rev 3324)
+++ branches/avidemux_2.4_branch/avidemux/ADM_video/ADM_vidAnimated_param.h	2007-07-01 16:12:05 UTC (rev 3325)
@@ -1,26 +0,0 @@
-/***************************************************************************
-    copyright            : (C) 2006 by mean
- ***************************************************************************/
-
-/***************************************************************************
- *                                                                         *
- *   This program is free software; you can redistribute it and/or modify  *
- *   it under the terms of the GNU General Public License as published by  *
- *   the Free Software Foundation; either version 2 of the License, or     *
- *   (at your option) any later version.                                   *
- *                                                                         *
- ***************************************************************************/
-
-#ifndef ADM_VID_ANIMATED_PARAM_H
-#define ADM_VID_ANIMATED_PARAM_H
-#define MAX_VIGNETTE 6
-typedef struct ANIMATED_PARAM
-{
-    uint32_t        vignetteW;
-    uint32_t        vignetteH;
-    uint32_t        isNTSC;
-    uint32_t        timecode[MAX_VIGNETTE];
-    ADM_filename    *backgroundImg;
-}ANIMATED_PARAM;
-
-#endif

Modified: branches/avidemux_2.4_branch/avidemux/ADM_video/CMakeLists.txt
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_video/CMakeLists.txt	2007-07-01 08:18:15 UTC (rev 3324)
+++ branches/avidemux_2.4_branch/avidemux/ADM_video/CMakeLists.txt	2007-07-01 16:12:05 UTC (rev 3325)
@@ -9,7 +9,6 @@
 ADM_vidRaw.cpp        
 ADM_vidUnblend.cpp
 ADM_genvideo.cpp         
-ADM_vidAnimated.cpp     
 ADM_vidContrast.cpp   
 ADM_vidFont.cpp
 ADM_vidVobsub.cpp

Modified: branches/avidemux_2.4_branch/avidemux/ADM_video/Makefile.am
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_video/Makefile.am	2007-07-01 08:18:15 UTC (rev 3324)
+++ branches/avidemux_2.4_branch/avidemux/ADM_video/Makefile.am	2007-07-01 16:12:05 UTC (rev 3325)
@@ -37,8 +37,7 @@
   ADM_vidDelta.cpp \
  ADM_vidUnblend.cpp \
  ADM_vidMPdelogo.cpp \
- ADM_vidColorYuv.cpp  \
- ADM_vidAnimated.cpp 
+ ADM_vidColorYuv.cpp  
 
 				
 

Copied: branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/ADM_vidAnimated.cpp (from rev 3318, branches/avidemux_2.4_branch/avidemux/ADM_video/ADM_vidAnimated.cpp)
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_video/ADM_vidAnimated.cpp	2007-06-28 17:29:59 UTC (rev 3318)
+++ branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/ADM_vidAnimated.cpp	2007-07-01 16:12:05 UTC (rev 3325)
@@ -0,0 +1,352 @@
+
+/***************************************************************************
+    (c)Mean 2006 fixounet at free.fr
+ ***************************************************************************/
+ 
+ /***************************************************************************
+ *                                                                         *
+ *   This program is free software; you can redistribute it and/or modify  *
+ *   it under the terms of the GNU General Public License as published by  *
+ *   the Free Software Foundation; either version 2 of the License, or     *
+ *   (at your option) any later version.                                   *
+ *                                                                         *
+ ***************************************************************************/
+#include "config.h"
+#include <stdio.h>
+#include <stdlib.h>
+#include <string.h>
+#include <ADM_assert.h>
+
+#include "config.h"
+#include "fourcc.h"
+#include "avio.hxx"
+#include "avi_vars.h"
+#include "math.h"
+
+#include "ADM_toolkit/toolkit.hxx"
+#include "ADM_editor/ADM_edit.hxx"
+#include "ADM_video/ADM_genvideo.hxx"
+
+
+#include "ADM_osSupport/ADM_debugID.h"
+#define MODULE_NAME MODULE_FILTER
+#include "ADM_osSupport/ADM_debug.h"
+#include "ADM_filter/video_filters.h"
+#include "ADM_vidAnimated.h"
+
+
+#include "ADM_inputs/ADM_inpics/ADM_pics.h"
+
+static FILTER_PARAM animated_template={10,
+    {"tc0","tc1","tc2",
+    "tc3","tc4","tc5",
+    "isNTSC","backgroundImg","vignetteW","vignetteH"
+    }};
+BUILD_CREATE(animated_create,ADMVideoAnimated);
+SCRIPT_CREATE(animated_script,ADMVideoAnimated,animated_template);
+
+#define LOOKUP 4
+#define CACHE_SIZE (LOOKUP*2+3)
+
+
+extern uint8_t DIA_animated(ANIMATED_PARAM *param,uint32_t w,uint32_t h, uint32_t n);
+
+uint8_t ADMVideoAnimated::configure(AVDMGenericVideoStream *in)
+{
+  ADV_Info *f=in->getInfo();
+   if(DIA_animated(_param,f->width,f->height,f->nb_frames))
+   {
+      setup();
+      return 1;
+   }
+   return 0;
+}
+
+char *ADMVideoAnimated::printConf( void )
+{
+   static char buf[50];
+   sprintf((char *)buf," Animated Menu ");
+   return buf;
+}
+uint8_t ADMVideoAnimated::setup( void)
+{
+    cleanup();
+    for(int i=0;i<MAX_VIGNETTE;i++) _caches[i]=new VideoCache(CACHE_SIZE,_in);  // 18 is good for mpeg2
+    _resizer=new ADMImageResizer(_in->getInfo()->width,_in->getInfo()->height,
+            _param->vignetteW,_param->vignetteH);
+    _image=new ADMImage(_param->vignetteW,_param->vignetteH);
+    loadImage();
+}
+uint8_t ADMVideoAnimated::cleanup( void)
+{
+   
+    for(int i=0;i<MAX_VIGNETTE;i++) 
+    {
+        if(_caches[i]) delete _caches[i];
+        _caches[i]=NULL;
+    }
+    if(_resizer) delete _resizer;
+    if(_image) delete _image;
+    if(_BkgGnd) delete _BkgGnd;
+    _resizer=NULL;
+    _image=NULL;
+    _BkgGnd=NULL;
+
+}
+ADMVideoAnimated::ADMVideoAnimated(AVDMGenericVideoStream *in,CONFcouple *couples) 
+{
+   _resizer=NULL;
+   _image=NULL;
+   _BkgGnd=NULL;
+   for(int i=0;i<MAX_VIGNETTE;i++) _caches[i]=NULL;
+
+   _in=in;
+   memcpy(&_info,_in->getInfo(),sizeof(_info));    
+   _info.encoding=1;
+   _uncompressed=NULL;
+   _param=NEW(ANIMATED_PARAM);
+   if(couples)
+   {
+        GET(isNTSC);
+        GET(backgroundImg);
+        GET(vignetteW);
+        GET(vignetteH);
+#undef GET
+#define GET(x)  couples->getCouple((char *)"tc"#x,&(_param->timecode[x]))
+        GET(0);
+        GET(1);
+        GET(2);
+        GET(3);
+        GET(4);
+        GET(5);
+   }
+   else // Default
+   {
+#define MKP(x,y) _param->x=y;
+            MKP(isNTSC,0);
+            MKP(vignetteW,160);
+            MKP(vignetteH,120);
+#ifdef ADM_WIN32
+       MKP(backgroundImg,(ADM_filename *)ADM_strdup("c:\\test.jpg"));
+#else
+            MKP(backgroundImg,(ADM_filename *)ADM_strdup("/tmp/taist.jpg"));
+#endif
+#undef MKP
+#define MKP(x,y) _param->timecode[x]=y
+        MKP(0,0);
+        MKP(1,100);
+        MKP(2,200);
+        MKP(3,300);
+        MKP(4,500);
+        MKP(5,600);
+   }
+   if(_param->isNTSC) _info.height=480;
+        else _info.height=576;
+    _info.width=720;
+    setup();
+}
+//____________________________________________________________________
+ADMVideoAnimated::~ADMVideoAnimated()
+{
+   if(_param->backgroundImg) ADM_dealloc(_param->backgroundImg);
+   delete _param;
+   _param=NULL;
+   _uncompressed=NULL;
+   cleanup();
+}
+#define BYTE uint8_t 
+#ifndef MAX
+#define MAX(x,y) ((x)>(y) ?(x):(y))
+#endif
+#ifndef MIN
+#define MIN(x,y) ((x)<(y) ?(x):(y))
+#endif
+//_____________________________________________________________
+// It is slow as we should do the resize in place (one 
+//   bunch of memcpy saved)
+// Since it is killing the editor cache anyway, speed it not an issue
+//______________________________________________________________
+uint8_t ADMVideoAnimated::getFrameNumberNoAlloc(uint32_t frame,
+  uint32_t *len,
+  ADMImage *data,
+  uint32_t *flags)
+  {
+    ADMImage *in;
+    uint32_t offset,pool;
+
+    if(frame>= _info.nb_frames) return 0;
+    
+    // Clean the image
+    if(_BkgGnd)
+        data ->duplicate(_BkgGnd);
+    else
+        {
+                data->blacken();
+                printf("No background image\n");
+        }
+ const int x_coordinate[3]={LEFT_MARGIN,360-(_param->vignetteW)/2,720-(_param->vignetteW)-LEFT_MARGIN};
+ const int y_coordinate[2]={TOP_MARGIN,TOP_MARGIN+(_param->vignetteH)+TOP_MARGIN};
+
+     // Do 3 top
+     for(int line=0;line<2;line++)
+        for(int i=0;i<3;i++)
+        {
+            pool=i+(3*line);
+            if(_param->timecode[pool]+frame<_in->getInfo()->nb_frames) 
+            {
+                // Load LOOKUP frames ...
+                if(!(frame%LOOKUP))
+                    for(int lookup=0;lookup<LOOKUP;lookup++)
+                    {
+                        _caches[pool]->getImage(_param->timecode[pool]+frame+lookup);
+                    }
+                // Unlock them
+                _caches[pool]->unlockAll();
+                in=_caches[pool]->getImage(_param->timecode[pool]+frame);
+                if(in) 
+                {
+                     _resizer->resize(in,_image);
+                    _caches[pool]->unlockAll();
+                }else
+                {   
+                    printf("[Animated] Failed to get image %u for pool %u\n",_param->timecode[pool]+frame,pool);
+                    _image->blacken();
+                }
+            }else
+            {   // Blacken 
+                printf("[Animated] out of bound : %u for pool %u\n",_param->timecode[pool]+frame,pool);
+                 _image->blacken();
+            }
+            // Blit
+
+            _image->copyTo(data,x_coordinate[i],y_coordinate[line]);
+        }
+
+	return 1;
+
+}
+
+
+uint8_t	ADMVideoAnimated::getCoupledConf( CONFcouple **couples)
+{
+   
+      ADM_assert(_param);
+      *couples=new CONFcouple(10);
+#define CSET(x)  (*couples)->setCouple((char *)#x,(_param->x))
+       CSET(isNTSC);
+       CSET(backgroundImg);
+        CSET(vignetteW);
+        CSET(vignetteH);
+#undef CSET
+#define CSET(x)  (*couples)->setCouple((char *)"tc"#x,(_param->timecode[x]))
+        CSET(0);
+        CSET(1);
+        CSET(2);
+        CSET(3);
+        CSET(4);
+        CSET(5);
+
+      return 1;
+}
+uint8_t	ADMVideoAnimated::loadImage(void)
+{
+picHeader *pic=NULL;
+decoders *decoder=NULL;
+ADMImage  *fullSize=NULL;
+ADMImageResizer *resizer=NULL;
+uint32_t len=0,flags_removed=0;
+uint32_t w,h;
+uint8_t *extraData=NULL;
+uint32_t extraDataSize=0;
+
+uint8_t *rdBuffer=NULL;
+
+    if(_BkgGnd) delete _BkgGnd;
+    _BkgGnd=NULL;
+
+    // open the jpg file and load it to binary
+    
+    pic=new picHeader;
+    if(!pic->open((char *)_param->backgroundImg))
+    {
+        printf("[Animated] Cannot load background image\n");
+        goto skipIt;
+    }
+  
+    // Ok, now we need its size
+    
+    w=pic->getWidth();
+    h=pic->getHeight();
+    printf("[Animated]Pic: %d x %d\n",w,h);
+    pic->getExtraHeaderData(&extraDataSize,&extraData);
+    //********
+    {
+        aviInfo info;
+        pic->getVideoInfo(&info);
+        decoder=getDecoder (info.fcc, w,h,extraDataSize,extraData);
+    }
+     if(!decoder) 
+    {
+        printf("[Animated]Cannot get decoder\n");
+        goto skipIt;
+    }
+    // Build new image
+    fullSize=new ADMImage(w,h);
+    fullSize->blacken();
+    rdBuffer=new uint8_t[w*h*3];     // Hardcoded!
+    ADMCompressedImage img;
+    img.data=rdBuffer;
+    if(!pic->getFrameNoAlloc(0,&img))
+    {
+        printf("[Animated]Get frame failed\n");
+        goto skipIt;
+    }
+    // Decode it
+    if(!decoder->uncompress (&img, fullSize))
+    {
+        printf("[Animated]Decoding failed\n");
+        goto skipIt;
+    }
+    if(fullSize->_colorspace!=ADM_COLOR_YV12)
+    {
+        printf("[Animated]Wrong colorspace, only yv12 supported\n");
+        goto skipIt;
+    }
+    // Need to packit ?
+    if(fullSize->_planeStride[0])
+        fullSize->pack(0);
+    // Resize it
+    _BkgGnd=new ADMImage(_info.width,_info.height);
+    resizer=new ADMImageResizer(w,h,_info.width,_info.height);
+    //Util_saveJpg ("/tmp/before.jpg",w,h,fullSize);
+    if(!resizer->resize(fullSize,_BkgGnd))
+    {
+        delete _BkgGnd;
+        _BkgGnd=NULL;
+        printf("[Animated]Resize failed\n");
+        
+    }else
+    {
+        printf("[Animated]Image ready\n");
+    }
+    
+skipIt:
+    {
+        if(decoder) delete decoder;
+        decoder=NULL;
+        if(pic)     delete pic;
+        pic=NULL;
+        if(fullSize)     delete fullSize;
+        fullSize=NULL;
+        if(resizer)     delete resizer;
+        resizer=NULL;
+        if(rdBuffer)     delete [] rdBuffer;
+        rdBuffer=NULL;
+    }
+    return 1;
+
+
+}
+
+
+// EOF

Copied: branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/ADM_vidAnimated.h (from rev 3318, branches/avidemux_2.4_branch/avidemux/ADM_video/ADM_vidAnimated.h)

Copied: branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/ADM_vidAnimated_param.h (from rev 3318, branches/avidemux_2.4_branch/avidemux/ADM_video/ADM_vidAnimated_param.h)

Modified: branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/CMakeLists.txt
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/CMakeLists.txt	2007-07-01 08:18:15 UTC (rev 3324)
+++ branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/CMakeLists.txt	2007-07-01 16:12:05 UTC (rev 3325)
@@ -22,5 +22,6 @@
 ADM_vidResize25.cpp
 ADM_vidTdeint.cpp
 ADM_vidChromaShift.cpp  
+ADM_vidAnimated.cpp
 )
 ADD_LIBRARY(ADM_videoFilter STATIC ${ADM_videoFilter_SRCS})

Modified: branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/Makefile.am
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/Makefile.am	2007-07-01 08:18:15 UTC (rev 3324)
+++ branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/Makefile.am	2007-07-01 16:12:05 UTC (rev 3325)
@@ -60,7 +60,8 @@
  ADM_vidFastConvolution.cpp  \
  ADM_vidRotate.cpp \
  ADM_vidYadif.cpp \
- ADM_vidYadif_asm.c
+ ADM_vidYadif_asm.c \
+ ADM_vidAnimated.cpp
 			
 
 



From gruntster at mail.berlios.de  Mon Jul  2 12:55:28 2007
From: gruntster at mail.berlios.de (gruntster at mail.berlios.de)
Date: Mon, 2 Jul 2007 12:55:28 +0200
Subject: [Avidemux-svn-commit] r3326 - in branches/avidemux_2.4_branch: .
	avidemux avidemux/ADM_libraries/ADM_smjs cmake
Message-ID: <200707021055.l62AtSTU028234@sheep.berlios.de>

Author: gruntster
Date: 2007-07-02 12:55:11 +0200 (Mon, 02 Jul 2007)
New Revision: 3326

Modified:
   branches/avidemux_2.4_branch/CMakeLists.txt
   branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_smjs/jsautocfg.h
   branches/avidemux_2.4_branch/avidemux/CMakeLists.txt
   branches/avidemux_2.4_branch/cmake/adm_qt4.cmake
Log:
support for out-of-place builds with CMake

Modified: branches/avidemux_2.4_branch/CMakeLists.txt
===================================================================
--- branches/avidemux_2.4_branch/CMakeLists.txt	2007-07-01 16:12:05 UTC (rev 3325)
+++ branches/avidemux_2.4_branch/CMakeLists.txt	2007-07-02 10:55:11 UTC (rev 3326)
@@ -192,9 +192,9 @@
 # create config.h
 CONFIGURE_FILE(config.h.cmake ${CMAKE_CURRENT_BINARY_DIR}/config.h)
 # #
- include_DIRECTORIES(${CMAKE_CURRENT_BINARY_DIR} ${CMAKE_CURRENT_BINARY_DIR}/avidemux ${CMAKE_CURRENT_BINARY_DIR}/avidemux/ADM_libraries)
- include_directories(${CMAKE_CURRENT_BINARY_DIR}/avidemux/ADM_libraries/ADM_utilities/ ${CMAKE_CURRENT_BINARY_DIR}/avidemux/ADM_libraries/ADM_lavutil)
- include_directories(${CMAKE_CURRENT_BINARY_DIR}/avidemux/ADM_libraries/ADM_lavcodec  )
+ include_DIRECTORIES(${CMAKE_CURRENT_BINARY_DIR} ${CMAKE_SOURCE_DIR}/avidemux ${CMAKE_SOURCE_DIR}/avidemux/ADM_libraries)
+ include_directories(${CMAKE_SOURCE_DIR}/avidemux/ADM_libraries/ADM_utilities/ ${CMAKE_SOURCE_DIR}/avidemux/ADM_libraries/ADM_lavutil)
+ include_directories(${CMAKE_SOURCE_DIR}/avidemux/ADM_libraries/ADM_lavcodec  )
 #**********************************************
 # Some CFLAGS
 #**********************************************

Modified: branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_smjs/jsautocfg.h
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_smjs/jsautocfg.h	2007-07-01 16:12:05 UTC (rev 3325)
+++ branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_smjs/jsautocfg.h	2007-07-02 10:55:11 UTC (rev 3326)
@@ -2,7 +2,7 @@
 #define js_autocfg___
 
 /* AUTOMATICALLY GENERATED - DO NOT EDIT */
-#include "../../../config.h"
+#include "config.h"
 
 
 #ifdef ADM_BIG_ENDIAN

Modified: branches/avidemux_2.4_branch/avidemux/CMakeLists.txt
===================================================================
--- branches/avidemux_2.4_branch/avidemux/CMakeLists.txt	2007-07-01 16:12:05 UTC (rev 3325)
+++ branches/avidemux_2.4_branch/avidemux/CMakeLists.txt	2007-07-02 10:55:11 UTC (rev 3326)
@@ -385,7 +385,7 @@
 add_libs_all_targets(wsock32)
 add_libs_all_targets(imagehlp)
 
-add_ldflags_all_targets( "-mms-bitfield -mno-cygwin -mwinmm -mwindows xpm/adm.o -Wl,--export-all-symbols")
+add_ldflags_all_targets( "-mms-bitfield -mno-cygwin -mwinmm -mwindows ${CMAKE_SOURCE_DIR}/avidemux/xpm/adm.o -Wl,--export-all-symbols")
 
 if(CMAKE_BUILD_TYPE STREQUAL "Release")
 add_ldflags_all_targets("-Wl,-s")

Modified: branches/avidemux_2.4_branch/cmake/adm_qt4.cmake
===================================================================
--- branches/avidemux_2.4_branch/cmake/adm_qt4.cmake	2007-07-01 16:12:05 UTC (rev 3325)
+++ branches/avidemux_2.4_branch/cmake/adm_qt4.cmake	2007-07-02 10:55:11 UTC (rev 3326)
@@ -1,65 +1,59 @@
-#AQ_%.cpp : Q_%.cpp %.ui
-##############################################################"
-# FOR AQ
-# Q_foo.cpp and foo.ui => AQ_foo.cpp, ui_foo.h and Q_foo.moc
-##############################################################"
-MACRO(Q_UIMOCIFY _source)                     
-  ADD_CUSTOM_COMMAND(OUTPUT AQ_${_source}.cpp
-                     COMMAND  ${QT_UIC_EXECUTABLE} ${_source}.ui -o ui_${_source}.h 
-                     COMMAND  ${QT_MOC_EXECUTABLE} Q_${_source}.cpp -o Q_${_source}.moc 
-                     COMMAND  echo "#include \"Q_${_source}.cpp\"" > AQ_${_source}.cpp
-                     COMMAND  echo "#include \"Q_${_source}.moc\"" >> AQ_${_source}.cpp
-                     DEPENDS  ${_source}.ui Q_${_source}.cpp
-                     VERBATIM
-                )
-   #FILE(WRITE ${CMAKE_CURRENT_SOURCE_DIR}/AQ_${_source}.cpp "#include \"Q_${_source}.cpp\" \n" )
-   #FILE(APPEND ${CMAKE_CURRENT_SOURCE_DIR}/AQ_${_source}.cpp "#include \"Q_${_source}.moc\" \n" )
-ENDMACRO(Q_UIMOCIFY _source)  
-##############################################################"
-# FOR 
-# foo.qrc->foo_rsc.cpp
-##############################################################"
-# $(RCC)  $< -o $@   -name filter
-MACRO(Q_RCC _source)                     
-  ADD_CUSTOM_COMMAND(OUTPUT   ${_source}_rsc.cpp
-                     COMMAND  ${QT_RCC_EXECUTABLE} ${_source}.qrc -o ${_source}_rsc.cpp -name ${_source}
-                     DEPENDS  ${_source}.qrc
-                     VERBATIM
-                )
-ENDMACRO(Q_RCC _source)        
-##############################################################"
-# FOR AT
-# T_foo.cpp i => AT_foo.cpp and T_foo.moc
-##############################################################"
-
-MACRO(Q_MOCIFY _source)                     
-  ADD_CUSTOM_COMMAND(OUTPUT AT_${_source}.cpp
-                     COMMAND   ${QT_MOC_EXECUTABLE} T_${_source}.cpp -o T_${_source}.moc 
-                     COMMAND  echo "#include \"T_${_source}.cpp\"" > AT_${_source}.cpp
-                     COMMAND  echo "#include \"T_${_source}.moc\"" >> AT_${_source}.cpp
-                     DEPENDS   T_${_source}.cpp
-                     VERBATIM
-                )
-   #FILE(WRITE AT_${_source}.cpp "#include \"T_${_source}.cpp\" \n" )
-   #FILE(APPEND AT_${_source}.cpp "#include \"T_${_source}.moc\" \n" )
-ENDMACRO(Q_MOCIFY _source)                     
-
-# Add to our Targets..
-FOREACH(_current ${${ADM_LIB}_Q})
- Q_UIMOCIFY(${_current})
- SET(${ADM_LIB}_SRCS ${${ADM_LIB}_SRCS} AQ_${_current}.cpp)
-ENDFOREACH(_current ${${ADM_LIB}_Q})
-FOREACH(_current ${${ADM_LIB}_T})
- Q_MOCIFY(${_current})
- SET(${ADM_LIB}_SRCS ${${ADM_LIB}_SRCS} AT_${_current}.cpp)
-ENDFOREACH(_current ${${ADM_LIB}_T})
-
-
-ADD_LIBRARY(${ADM_LIB} STATIC ${${ADM_LIB}_SRCS})
-ADD_ADM_LIB(${ADM_LIB} ADM_libraries)
-
-# EOF
-
-
-
-
+##############################################################"
+# FOR AQ
+# Q_foo.cpp and foo.ui => AQ_foo.cpp, ui_foo.h and Q_foo.moc
+##############################################################"
+MACRO(Q_UIMOCIFY _source)
+  ADD_CUSTOM_COMMAND(OUTPUT ${CMAKE_CURRENT_BINARY_DIR}/AQ_${_source}.cpp
+                     COMMAND  ${QT_UIC_EXECUTABLE} ${CMAKE_CURRENT_SOURCE_DIR}/${_source}.ui -o ui_${_source}.h
+                     COMMAND  ${QT_MOC_EXECUTABLE} ${CMAKE_CURRENT_SOURCE_DIR}/Q_${_source}.cpp -o Q_${_source}.moc
+                     COMMAND  echo "#include \"Q_${_source}.cpp\"" > AQ_${_source}.cpp
+                     COMMAND  echo "#include \"Q_${_source}.moc\"" >> AQ_${_source}.cpp
+                     DEPENDS  ${CMAKE_CURRENT_SOURCE_DIR}/${_source}.ui  ${CMAKE_CURRENT_SOURCE_DIR}/Q_${_source}.cpp
+                     VERBATIM
+                )
+ENDMACRO(Q_UIMOCIFY _source)
+
+##############################################################"
+# FOR 
+# foo.qrc->foo_rsc.cpp
+##############################################################"
+# $(RCC)  $< -o $@   -name filter
+MACRO(Q_RCC _source)
+  ADD_CUSTOM_COMMAND(OUTPUT   ${CMAKE_CURRENT_BINARY_DIR}/${_source}_rsc.cpp
+                     COMMAND  ${QT_RCC_EXECUTABLE} ${CMAKE_CURRENT_SOURCE_DIR}/${_source}.qrc -o ${_source}_rsc.cpp -name ${_source}
+                     DEPENDS  ${CMAKE_CURRENT_SOURCE_DIR}/${_source}.qrc
+                     VERBATIM
+                )
+ENDMACRO(Q_RCC _source)
+
+##############################################################"
+# FOR AT
+# T_foo.cpp i => AT_foo.cpp and T_foo.moc
+##############################################################"
+MACRO(Q_MOCIFY _source)
+  ADD_CUSTOM_COMMAND(OUTPUT ${CMAKE_CURRENT_BINARY_DIR}/AT_${_source}.cpp
+                     COMMAND  ${QT_MOC_EXECUTABLE} ${CMAKE_CURRENT_SOURCE_DIR}/T_${_source}.cpp -o T_${_source}.moc 
+                     COMMAND  echo "#include \"T_${_source}.cpp\"" > AT_${_source}.cpp
+                     COMMAND  echo "#include \"T_${_source}.moc\"" >> AT_${_source}.cpp
+                     DEPENDS  ${CMAKE_CURRENT_SOURCE_DIR}/T_${_source}.cpp
+                     VERBATIM
+                )
+ENDMACRO(Q_MOCIFY _source)
+
+# Add to our Targets..
+FOREACH(_current ${${ADM_LIB}_Q})
+ Q_UIMOCIFY(${_current})
+ SET(${ADM_LIB}_SRCS ${${ADM_LIB}_SRCS} ${CMAKE_CURRENT_BINARY_DIR}/AQ_${_current}.cpp)
+ENDFOREACH(_current ${${ADM_LIB}_Q})
+
+FOREACH(_current ${${ADM_LIB}_T})
+ Q_MOCIFY(${_current})
+ SET(${ADM_LIB}_SRCS ${${ADM_LIB}_SRCS} ${CMAKE_CURRENT_BINARY_DIR}/AT_${_current}.cpp)
+ENDFOREACH(_current ${${ADM_LIB}_T})
+
+include_directories(${CMAKE_CURRENT_SOURCE_DIR} ${CMAKE_CURRENT_BINARY_DIR})
+
+ADD_LIBRARY(${ADM_LIB} STATIC ${${ADM_LIB}_SRCS})
+ADD_ADM_LIB(${ADM_LIB} ADM_libraries)
+
+# EOF



From mean at mail.berlios.de  Mon Jul  2 20:20:48 2007
From: mean at mail.berlios.de (mean at BerliOS)
Date: Mon, 2 Jul 2007 20:20:48 +0200
Subject: [Avidemux-svn-commit] r3327 -
	branches/avidemux_2.4_branch/avidemux/ADM_audiocodec
Message-ID: <200707021820.l62IKmfW030827@sheep.berlios.de>

Author: mean
Date: 2007-07-02 20:20:47 +0200 (Mon, 02 Jul 2007)
New Revision: 3327

Modified:
   branches/avidemux_2.4_branch/avidemux/ADM_audiocodec/ADM_codecfaad.cpp
Log:
try to go on if errors happen on aac decoding

Modified: branches/avidemux_2.4_branch/avidemux/ADM_audiocodec/ADM_codecfaad.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_audiocodec/ADM_codecfaad.cpp	2007-07-02 10:55:11 UTC (rev 3326)
+++ branches/avidemux_2.4_branch/avidemux/ADM_audiocodec/ADM_codecfaad.cpp	2007-07-02 18:20:47 UTC (rev 3327)
@@ -172,13 +172,10 @@
 			{
 				printf("Faad: Error %d :%s\n",info.error,
 					faacDecGetErrorMessage(info.error));
-					/*
-				xin=info.bytesconsumed ;
-				if(!xin) xin=1;
-				memmove(_buffer,_buffer+xin,_inbuffer-xin);
-				_inbuffer-=xin;
-				return 1;*/
-				return 0;
+				printf("Bye consumed %u, bytes dropped %u \n",info.bytesconsumed,_inbuffer);
+
+                                _inbuffer=0; // Purge buffer
+				return 1;
 			}
 			if(first)
 			{



From mean at mail.berlios.de  Mon Jul  2 20:27:27 2007
From: mean at mail.berlios.de (mean at BerliOS)
Date: Mon, 2 Jul 2007 20:27:27 +0200
Subject: [Avidemux-svn-commit] r3328 - branches/avidemux_2.4_branch/po
Message-ID: <200707021827.l62IRRTZ031481@sheep.berlios.de>

Author: mean
Date: 2007-07-02 20:27:26 +0200 (Mon, 02 Jul 2007)
New Revision: 3328

Modified:
   branches/avidemux_2.4_branch/po/ja.po
Log:
ja translation update

Modified: branches/avidemux_2.4_branch/po/ja.po
===================================================================
--- branches/avidemux_2.4_branch/po/ja.po	2007-07-02 18:20:47 UTC (rev 3327)
+++ branches/avidemux_2.4_branch/po/ja.po	2007-07-02 18:27:26 UTC (rev 3328)
@@ -7,8 +7,8 @@
 msgstr ""
 "Project-Id-Version: ja\n"
 "Report-Msgid-Bugs-To: \n"
-"POT-Creation-Date: 2007-05-24 21:16+0100\n"
-"PO-Revision-Date: 2007-05-26 18:16+0900\n"
+"POT-Creation-Date: 2007-06-27 22:39+0100\n"
+"PO-Revision-Date: 2007-07-02 16:53+0900\n"
 "Last-Translator: tetsuro\n"
 "Language-Team: Japan\n"
 "MIME-Version: 1.0\n"
@@ -83,28 +83,31 @@
 msgstr "?????????(_R):"
 
 #: avidemux/ADM_audiofilter/audioencoder_lame.cpp:241
-#: avidemux/ADM_audiofilter/audioencoder_vorbis.cpp:287
+#: avidemux/ADM_audiofilter/audioencoder_vorbis.cpp:285
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_audioconfig.cpp:59
 msgid "_Bitrate:"
 msgstr "??????(_B):"
 
 #: avidemux/ADM_audiofilter/audioencoder_lame.cpp:246
-#: avidemux/ADM_audiofilter/audioencoder_vorbis.cpp:289
+#: avidemux/ADM_audiofilter/audioencoder_vorbis.cpp:287
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_mjpeg.cpp:40
+#: avidemux/ADM_videoFilter/ADM_vidDecDec.cpp:204
 msgid "_Quality:"
 msgstr "??(_Q):"
 
-#: avidemux/ADM_audiofilter/audioencoder_vorbis.cpp:270
+#: avidemux/ADM_audiofilter/audioencoder_vorbis.cpp:268
 msgid "VBR"
 msgstr "VBR"
 
-#: avidemux/ADM_audiofilter/audioencoder_vorbis.cpp:271
+#: avidemux/ADM_audiofilter/audioencoder_vorbis.cpp:269
 msgid "Quality based"
 msgstr "??????"
 
-#: avidemux/ADM_audiofilter/audioencoder_vorbis.cpp:273
+#: avidemux/ADM_audiofilter/audioencoder_vorbis.cpp:271
+#: avidemux/ADM_videoFilter/ADM_vidDecDec.cpp:203
 #: avidemux/ADM_videoFilter/ADM_vidDGbob.cpp:91
 #: avidemux/ADM_videoFilter/ADM_vidMcDeint.cpp:113
+#: avidemux/ADM_videoFilter/ADM_vidYadif.cpp:181
 msgid "_Mode:"
 msgstr "???(_M):"
 
@@ -162,20 +165,20 @@
 msgid "Aborted"
 msgstr "??????"
 
-#: avidemux/ADM_editor/ADM_edit.cpp:400
+#: avidemux/ADM_editor/ADM_edit.cpp:404
 msgid "File type identified but no loader support detected..."
 msgstr "???????????????????????????????..."
 
-#: avidemux/ADM_editor/ADM_edit.cpp:401
+#: avidemux/ADM_editor/ADM_edit.cpp:405
 msgid "May be related to an old index file."
 msgstr "????????????????????????."
 
-#: avidemux/ADM_editor/ADM_edit.cpp:408
+#: avidemux/ADM_editor/ADM_edit.cpp:412
 #, c-format
 msgid "Attempt to open %s failed!"
 msgstr "%s ????????????!"
 
-#: avidemux/ADM_editor/ADM_edit.cpp:432
+#: avidemux/ADM_editor/ADM_edit.cpp:436
 msgid ""
 "You cannot mix different video dimensions yet. Using the partial video filter later, will not work around this problem. The workaround is:\n"
 "1.) \"resize\" / \"add border\" / \"crop\" each stream to the same resolution\n"
@@ -185,23 +188,23 @@
 "1.) ??????? \"resize\" / \"add border\" / \"crop\" ????????????\n"
 "2.) ??????????"
 
-#: avidemux/ADM_editor/ADM_edit.cpp:544
+#: avidemux/ADM_editor/ADM_edit.cpp:548
 msgid "Build Time Map"
 msgstr "???????????"
 
-#: avidemux/ADM_editor/ADM_edit.cpp:544
+#: avidemux/ADM_editor/ADM_edit.cpp:548
 msgid "Build VBR time map?"
 msgstr "VBR ???????????????"
 
-#: avidemux/ADM_editor/ADM_edit.cpp:578
+#: avidemux/ADM_editor/ADM_edit.cpp:582
 msgid "Use that mode"
 msgstr "????????"
 
-#: avidemux/ADM_editor/ADM_edit.cpp:578
+#: avidemux/ADM_editor/ADM_edit.cpp:582
 msgid "H264 detected"
 msgstr "H264???????"
 
-#: avidemux/ADM_editor/ADM_edit.cpp:578
+#: avidemux/ADM_editor/ADM_edit.cpp:582
 msgid ""
 "If the file is using bframe as reference, it can lead to crash or stutteting.\n"
 "Avidemux can use another mode which is safed but <b>YOU WILL LOOSE FRAME ACCURACY</b>.\n"
@@ -211,47 +214,47 @@
 "Avidemux ?????????????????????<b>???????????????????</b>.\n"
 "??????????? ?"
 
-#: avidemux/ADM_editor/ADM_edit.cpp:705
+#: avidemux/ADM_editor/ADM_edit.cpp:709
 msgid "Packed Bitstream detected"
 msgstr "???????????????????"
 
-#: avidemux/ADM_editor/ADM_edit.cpp:706
+#: avidemux/ADM_editor/ADM_edit.cpp:710
 msgid "Do you want me to unpack it ?"
 msgstr "???????????? ?"
 
-#: avidemux/ADM_editor/ADM_edit.cpp:726
+#: avidemux/ADM_editor/ADM_edit.cpp:730
 msgid "Could not unpack the video"
 msgstr "?????????????"
 
-#: avidemux/ADM_editor/ADM_edit.cpp:726
+#: avidemux/ADM_editor/ADM_edit.cpp:730
 msgid "Using backup decoder - not frame accurate."
 msgstr "????????????? - ???????????."
 
-#: avidemux/ADM_editor/ADM_edit.cpp:731
+#: avidemux/ADM_editor/ADM_edit.cpp:735
 msgid "Weird"
 msgstr ""
 
-#: avidemux/ADM_editor/ADM_edit.cpp:731
+#: avidemux/ADM_editor/ADM_edit.cpp:735
 msgid "The unpacking succeedeed but the index is still not up to date."
 msgstr "???????????????????????????????."
 
-#: avidemux/ADM_editor/ADM_edit.cpp:737
+#: avidemux/ADM_editor/ADM_edit.cpp:741
 msgid "Troubles ahead"
 msgstr ""
 
-#: avidemux/ADM_editor/ADM_edit.cpp:737
+#: avidemux/ADM_editor/ADM_edit.cpp:741
 msgid "This a VOP packed AVI."
 msgstr "???VOP????AVI??."
 
-#: avidemux/ADM_editor/ADM_edit.cpp:748
+#: avidemux/ADM_editor/ADM_edit.cpp:752
 msgid "Index is not up to date"
 msgstr "????????????????"
 
-#: avidemux/ADM_editor/ADM_edit.cpp:748
+#: avidemux/ADM_editor/ADM_edit.cpp:752
 msgid "You should use Tool->Rebuild frame. Do it now ?"
 msgstr "???->???????? ???????. ??????? ?"
 
-#: avidemux/ADM_editor/ADM_edit.cpp:1503
+#: avidemux/ADM_editor/ADM_edit.cpp:1507
 msgid ""
 "This looks like mpeg\n"
 " Do you want to index it?"
@@ -259,7 +262,7 @@
 "??? mpeg ?????\n"
 " ???????????????? ?"
 
-#: avidemux/ADM_editor/ADM_edit.cpp:1555
+#: avidemux/ADM_editor/ADM_edit.cpp:1559
 msgid "Indexing failed"
 msgstr "???????????"
 
@@ -276,7 +279,7 @@
 msgstr "????????????"
 
 #: avidemux/ADM_editor/ADM_outputfmt.h:38
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp:501
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp:511
 msgid "AVI"
 msgstr "AVI"
 
@@ -289,7 +292,7 @@
 msgstr "AVI, ???VOP"
 
 #: avidemux/ADM_editor/ADM_outputfmt.h:41
-msgid "AVI, unp. VOP"
+msgid "AVI, unpack VOP"
 msgstr "AVI, ?????VOP"
 
 #: avidemux/ADM_editor/ADM_outputfmt.h:42
@@ -301,7 +304,7 @@
 msgstr "MPEG-TS (A+V)"
 
 #: avidemux/ADM_editor/ADM_outputfmt.h:44
-msgid "MPEG Video"
+msgid "MPEG video"
 msgstr "MPEG?? (ES)"
 
 #: avidemux/ADM_editor/ADM_outputfmt.h:45
@@ -309,7 +312,7 @@
 msgstr "MP4"
 
 #: avidemux/ADM_editor/ADM_outputfmt.h:46
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp:505
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp:515
 msgid "OGM"
 msgstr "OGM"
 
@@ -373,7 +376,7 @@
 msgid "Size is not (s)QCIF"
 msgstr "????(s)QCIF???"
 
-#: avidemux/ADM_inputs/ADM_mp4/ADM_mp4Analyzer.cpp:566
+#: avidemux/ADM_inputs/ADM_mp4/ADM_mp4Analyzer.cpp:570
 msgid "Problem reading SVQ3 headers"
 msgstr "SVQ3????????"
 
@@ -389,50 +392,50 @@
 msgid "Can't determine aspect ratio"
 msgstr "??????????????"
 
-#: avidemux/ADM_inputs/ADM_mpegdemuxer/dmx_video.cpp:363
+#: avidemux/ADM_inputs/ADM_mpegdemuxer/dmx_video.cpp:355
 msgid "Out of memory"
 msgstr "??????"
 
-#: avidemux/ADM_inputs/ADM_mpegdemuxer/dmx_video.cpp:378
+#: avidemux/ADM_inputs/ADM_mpegdemuxer/dmx_video.cpp:370
 msgid "Opening MPEG"
 msgstr "MPEG???????"
 
-#: avidemux/ADM_inputs/ADM_mpegdemuxer/dmx_video.cpp:547
+#: avidemux/ADM_inputs/ADM_mpegdemuxer/dmx_video.cpp:539
 msgid "MPEG renumbering error"
 msgstr "MPEG?????????"
 
-#: avidemux/ADM_inputs/ADM_nuv/ADM_nuv.cpp:555
-#: avidemux/ADM_inputs/ADM_nuv/ADM_nuv.cpp:584
+#: avidemux/ADM_inputs/ADM_nuv/ADM_nuv.cpp:542
+#: avidemux/ADM_inputs/ADM_nuv/ADM_nuv.cpp:571
 msgid "Opening Nuppel video"
 msgstr "Nupple?????????"
 
-#: avidemux/ADM_inputs/ADM_nuv/ADM_nuv.cpp:560
+#: avidemux/ADM_inputs/ADM_nuv/ADM_nuv.cpp:547
 msgid "Sure you want to abort ?"
 msgstr "????????? ?"
 
-#: avidemux/ADM_inputs/ADM_nuv/ADM_nuv.cpp:771
+#: avidemux/ADM_inputs/ADM_nuv/ADM_nuv.cpp:758
 msgid "Size mismatch"
 msgstr "?????????"
 
-#: avidemux/ADM_inputs/ADM_nuv/ADM_nuv.cpp:771
+#: avidemux/ADM_inputs/ADM_nuv/ADM_nuv.cpp:758
 msgid "Expect a crash."
 msgstr "?????????."
 
-#: avidemux/ADM_inputs/ADM_nuv/ADM_nuv.cpp:1063
+#: avidemux/ADM_inputs/ADM_nuv/ADM_nuv.cpp:1050
 msgid "Do you want to save an index ?"
 msgstr "????????????? ?"
 
-#: avidemux/ADM_inputs/ADM_ogm/ADM_ogm.cpp:355
+#: avidemux/ADM_inputs/ADM_ogm/ADM_ogm.cpp:346
 msgid "Take second track ?"
 msgstr "????????? ?"
 
-#: avidemux/ADM_inputs/ADM_ogm/ADM_ogm.cpp:435
+#: avidemux/ADM_inputs/ADM_ogm/ADM_ogm.cpp:426
 msgid "Scanning OGM"
 msgstr "OGM??????"
 
-#: avidemux/ADM_inputs/ADM_openDML/ADM_openDML.cpp:285
-#: avidemux/ADM_inputs/ADM_openDML/ADM_openDML.cpp:370
-#: avidemux/ADM_inputs/ADM_openDML/ADM_openDML.cpp:505
+#: avidemux/ADM_inputs/ADM_openDML/ADM_openDML.cpp:281
+#: avidemux/ADM_inputs/ADM_openDML/ADM_openDML.cpp:366
+#: avidemux/ADM_inputs/ADM_openDML/ADM_openDML.cpp:501
 msgid "Malformed header"
 msgstr "??????"
 
@@ -521,8 +524,8 @@
 msgstr "1:1"
 
 #: avidemux/ADM_libraries/ADM_utilities/avidemutils.cpp:331
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp:594
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp:791
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp:598
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp:795
 msgid "Unknown"
 msgstr "??"
 
@@ -543,39 +546,55 @@
 msgid "Could not read \"%s\"."
 msgstr "\"%s\" ??????."
 
-#: avidemux/ADM_ocr/ADM_vob2vobsub.cpp:244
+#: avidemux/ADM_ocr/ADM_vob2vobsub.cpp:254
 msgid "Ifo error"
 msgstr "IFO ???"
 
-#: avidemux/ADM_ocr/ADM_vob2vobsub.cpp:244
+#: avidemux/ADM_ocr/ADM_vob2vobsub.cpp:254
 msgid "Error reading ifo file, aborting."
 msgstr "IFO?????????, ?????."
 
-#: avidemux/ADM_ocr/ADM_vob2vobsub.cpp:252
+#: avidemux/ADM_ocr/ADM_vob2vobsub.cpp:262
 msgid "Cannot write .idx"
 msgstr ".idx???????"
 
-#: avidemux/ADM_ocr/ADM_vob2vobsub.cpp:265
+#: avidemux/ADM_ocr/ADM_vob2vobsub.cpp:275
 msgid "Cannot write .sub"
 msgstr ".sub???????"
 
-#: avidemux/ADM_ocr/ADM_vob2vobsub.cpp:277
+#: avidemux/ADM_ocr/ADM_vob2vobsub.cpp:287
 msgid "Problem opening the mpeg files"
 msgstr "MPEG???????????"
 
-#: avidemux/ADM_ocr/ADM_vob2vobsub.cpp:290
+#: avidemux/ADM_ocr/ADM_vob2vobsub.cpp:300
 msgid "Generating VobSub file"
 msgstr "VobSub????????"
 
-#: avidemux/ADM_osSupport/ADM_crashdump.cpp:239
+#: avidemux/ADM_osSupport/ADM_crashdump.cpp:200
+#: avidemux/ADM_osSupport/ADM_crashdump.cpp:224
+msgid "Fatal Error"
+msgstr "??????"
+
+#: avidemux/ADM_osSupport/ADM_crashdump.cpp:200
+#: avidemux/ADM_osSupport/ADM_crashdump.cpp:224
+msgid ""
+"A fatal error has occurred.\n"
+"\n"
+"Click OK to generate debug information. This may take a few minutes to complete."
+msgstr ""
+"????????????.\n"
+"\n"
+"OK????????????????????. ?????????????????????."
+
+#: avidemux/ADM_osSupport/ADM_crashdump.cpp:423
 msgid "Load it"
 msgstr "??????"
 
-#: avidemux/ADM_osSupport/ADM_crashdump.cpp:239
+#: avidemux/ADM_osSupport/ADM_crashdump.cpp:423
 msgid "Crash file"
 msgstr "????? ????"
 
-#: avidemux/ADM_osSupport/ADM_crashdump.cpp:240
+#: avidemux/ADM_osSupport/ADM_crashdump.cpp:424
 msgid ""
 "I have detected a crash file. \n"
 "Do you want to load it  ?\n"
@@ -638,7 +657,7 @@
 
 #: avidemux/ADM_outputs/oplug_avi/op_avisave.cpp:74
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:180
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp:841
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp:845
 msgid "Normal"
 msgstr "??"
 
@@ -818,17 +837,14 @@
 msgstr ""
 
 #: avidemux/ADM_script/ADM_JSFunctions.cpp:556
-#: avidemux/ADM_videoFilter/ADM_vidDecTelecide.cpp:83
 msgid "No Strategy"
 msgstr "???????"
 
 #: avidemux/ADM_script/ADM_JSFunctions.cpp:557
-#: avidemux/ADM_videoFilter/ADM_vidDecTelecide.cpp:84
 msgid "3:2 Pulldown"
 msgstr "3:2 ?????"
 
 #: avidemux/ADM_script/ADM_JSFunctions.cpp:558
-#: avidemux/ADM_videoFilter/ADM_vidDecTelecide.cpp:85
 msgid "Pal/Secam"
 msgstr "Pal/Secam"
 
@@ -846,20 +862,20 @@
 msgstr "?????(_D)"
 
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_audioFilter.cpp:64
-msgid "_Time Shift (ms) "
-msgstr "????(_T) (ms) "
+msgid "_Time shift (ms):"
+msgstr "????(_T) (ms):"
 
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_audioFilter.cpp:64
-msgid "Time shift _value (ms):"
-msgstr "??????(_V) (ms):"
+msgid "Time shift value (ms)"
+msgstr "?????? (ms)"
 
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_audioFilter.cpp:72
-msgid "R_esampling (Hz) "
-msgstr "?????????(_E) (Hz) "
+msgid "R_esampling (Hz):"
+msgstr "???????(_E) (Hz):"
 
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_audioFilter.cpp:72
-msgid "_Resampling frequency (Hz):"
-msgstr "?????(_R) (Hz):"
+msgid "Resampling frequency (Hz)"
+msgstr "????? (Hz)"
 
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_audioFilter.cpp:80
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_audioFilter.cpp:89
@@ -867,9 +883,9 @@
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_coloryuv.cpp:373
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_coloryuv.cpp:381
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_coloryuv.cpp:389
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp:549
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp:564
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp:579
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp:553
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp:568
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp:583
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_vobsub.cpp:219
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1124
 #: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_xvid4.cpp:57
@@ -967,120 +983,123 @@
 msgid "Bitrate Histogram"
 msgstr "?????? ??????"
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_builtin.cpp:122
-msgid "Video codecs:"
-msgstr "???????:"
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_builtin.cpp:128
+msgid "Video Codecs"
+msgstr "???????"
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_builtin.cpp:123
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_builtin.cpp:129
 msgid "Xvid"
 msgstr "XviD"
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_builtin.cpp:124
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_builtin.cpp:130
 msgid "x264"
 msgstr "x264"
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_builtin.cpp:129
-msgid "Audio codecs:"
-msgstr "???????:"
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_builtin.cpp:135
+msgid "Audio Codecs"
+msgstr "???????"
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_builtin.cpp:130
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_builtin.cpp:136
 msgid "Aften"
 msgstr "Aften"
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_builtin.cpp:131
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_builtin.cpp:137
 msgid "amrnb"
 msgstr "amrnb"
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_builtin.cpp:132
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_builtin.cpp:138
 msgid "FAAC"
 msgstr "FAAC"
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_builtin.cpp:133
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_builtin.cpp:139
 msgid "FAAD2"
 msgstr "FAAD2"
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_builtin.cpp:134
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_builtin.cpp:140
 msgid "LAME"
 msgstr "LAME"
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_builtin.cpp:135
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_builtin.cpp:141
 msgid "liba52"
 msgstr "liba52"
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_builtin.cpp:136
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_builtin.cpp:142
 msgid "libdca"
 msgstr "libdca"
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_builtin.cpp:137
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_builtin.cpp:143
 msgid "MAD"
 msgstr "MAD"
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_builtin.cpp:138
-msgid "Ogg Vorbis"
-msgstr "Ogg Vorbis"
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_builtin.cpp:144
+msgid "Vorbis"
+msgstr "Vorbis"
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_builtin.cpp:150
-msgid "Miscellaneous libraries:"
-msgstr "?????????:"
-
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_builtin.cpp:151
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_builtin.cpp:156
 msgid "aRts"
 msgstr "aRts"
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_builtin.cpp:152
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_builtin.cpp:157
 msgid "ESD"
 msgstr "ESD"
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_builtin.cpp:153
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_builtin.cpp:158
+msgid "Fontconfig"
+msgstr "Fontconfig"
+
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_builtin.cpp:159
 msgid "FreeType 2"
-msgstr ""
+msgstr "FreeType 2"
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_builtin.cpp:154
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_builtin.cpp:160
 msgid "gettext"
-msgstr ""
+msgstr "gettext"
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_builtin.cpp:155
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_builtin.cpp:161
+msgid "ALSA"
+msgstr "ALSA"
+
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_builtin.cpp:162
 msgid "OSS"
 msgstr "OSS"
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_builtin.cpp:156
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_builtin.cpp:163
 msgid "SDL"
 msgstr "SDL"
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_builtin.cpp:157
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_builtin.cpp:164
 msgid "XVideo"
 msgstr "XVideo"
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_builtin.cpp:167
-msgid "CPU:"
-msgstr "CPU:"
-
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_builtin.cpp:168
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_builtin.cpp:166
 msgid "AltiVec"
 msgstr "AltiVec"
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_builtin.cpp:169
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_builtin.cpp:167
 msgid "PowerPC"
 msgstr "PowerPC"
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_builtin.cpp:170
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_builtin.cpp:168
 msgid "x86"
 msgstr "x86"
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_builtin.cpp:171
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_builtin.cpp:169
 msgid "x86-64"
 msgstr "x86-64"
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_builtin.cpp:181
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_builtin.cpp:176
 msgid "Codecs"
 msgstr "?????"
 
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_builtin.cpp:177
+msgid "Libraries"
+msgstr "?????"
+
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_builtin.cpp:178
+msgid "CPU"
+msgstr "CPU"
+
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_builtin.cpp:182
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_filters/gui_filterlist.cpp:248
-msgid "Miscellaneous"
-msgstr "??"
-
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_builtin.cpp:186
 msgid "Built-in Support"
 msgstr "??????"
 
@@ -1111,7 +1130,7 @@
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_DVDff.cpp:57
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_SVCD.cpp:47
 msgid "Anime"
-msgstr ""
+msgstr "???"
 
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_DVDff.cpp:58
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_SVCD.cpp:48
@@ -1171,16 +1190,16 @@
 msgstr "??????(_I):"
 
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_gototime.cpp:27
-msgid "Hour"
-msgstr "??"
+msgid "_Hours:"
+msgstr "?(_H):"
 
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_gototime.cpp:28
-msgid "Minutes"
-msgstr "?"
+msgid "_Minutes:"
+msgstr "?(_M):"
 
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_gototime.cpp:29
-msgid "Seconds"
-msgstr "?"
+msgid "_Seconds:"
+msgstr "?(_S):"
 
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_lavcodec.cpp:52
 msgid "Full"
@@ -1207,7 +1226,7 @@
 msgstr "H.263"
 
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_lavcodec.cpp:61
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp:509
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp:519
 msgid "MPEG"
 msgstr "MPEG"
 
@@ -1233,7 +1252,7 @@
 
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_lavcodec.cpp:75
 msgid "Ma_x. quantizer:"
-msgstr "??????(_N):"
+msgstr "??????(_X):"
 
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_lavcodec.cpp:76
 msgid "Max. quantizer _difference:"
@@ -1292,6 +1311,7 @@
 msgstr "??????????"
 
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_lavcodec.cpp:108
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_srt.cpp:89
 #: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_x264.cpp:86
 msgid "Motion Estimation"
 msgstr "????"
@@ -1313,16 +1333,17 @@
 msgstr "libavcodec MPEG-4 ??"
 
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_lavDecoder.cpp:45
-msgid "Swap U & V:"
-msgstr "U?V???:"
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_postproc.cpp:41
+msgid "_Swap U and V"
+msgstr "U?V???(_S)"
 
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_lavDecoder.cpp:46
-msgid "Show _Vectors:"
-msgstr "???????(_V):"
+msgid "Show motion _vectors"
+msgstr "?????????(_V)"
 
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_lavDecoder.cpp:48
-msgid "Lavcodec Decoder Configuration"
-msgstr "Lavcodec ??????"
+msgid "Decoder Options"
+msgstr "??????????"
 
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_mjpeg.cpp:41
 msgid "_Swap U&V:"
@@ -1333,10 +1354,6 @@
 msgid "_Filter strength:"
 msgstr "???????(_F):"
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_postproc.cpp:41
-msgid "_Swap U & V"
-msgstr "U?V???(_S)"
-
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_postproc.cpp:51
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:269
 #: avidemux/ADM_videoFilter/ADM_vidForcedPP.cpp:72
@@ -1403,7 +1420,8 @@
 msgstr "?????(_N):"
 
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:178
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp:839
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp:843
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_srt.cpp:108
 #: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_x264.cpp:105
 #: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_xvid4.cpp:61
 msgid "High"
@@ -1418,7 +1436,8 @@
 msgstr "????"
 
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:182
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp:843
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp:847
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_srt.cpp:107
 #: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_x264.cpp:104
 #: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_xvid4.cpp:59
 msgid "Low"
@@ -1525,6 +1544,10 @@
 msgid "_Filter directory:"
 msgstr "?????????(_F):"
 
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:321
+msgid "External Filters"
+msgstr "??????"
+
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:325
 msgid "Preferences"
 msgstr "??"
@@ -1534,17 +1557,49 @@
 msgstr "???(_S):"
 
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_resizeWiz.cpp:59
-msgid "Target type"
-msgstr "?????"
+msgid "_Target type:"
+msgstr "?????(_T):"
 
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_resizeWiz.cpp:60
-msgid "Source aspect ratio"
-msgstr "??????????"
+msgid "_Source aspect ratio:"
+msgstr "??????????(_S):"
 
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_resizeWiz.cpp:61
-msgid "Dest. aspect ratio"
-msgstr "??????????"
+msgid "_Destination aspect ratio:"
+msgstr "??????????(_D):"
 
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_srt.cpp:88
+msgid "_Subtitle file:"
+msgstr "??????(_S):"
+
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_srt.cpp:89
+msgid "_Font (TTF):"
+msgstr "????(_F) (TFF):"
+
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_srt.cpp:104
+msgid "_Encoding:"
+msgstr "?????(_E):"
+
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_srt.cpp:106
+msgid "S_elect C_olor"
+msgstr "????(_E_O)"
+
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_srt.cpp:107
+msgid "Set Size and _Position"
+msgstr "?????????(_P)"
+
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_srt.cpp:108
+msgid "_Auto split"
+msgstr "????(_A)"
+
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_srt.cpp:109
+msgid "_Delay (ms):"
+msgstr "??(_D) (ms):"
+
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_srt.cpp:112
+msgid "Subtitler"
+msgstr ""
+
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_tdeint.cpp:45
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_tdeint.cpp:51
 msgid "Auto (might not work)"
@@ -1552,23 +1607,23 @@
 
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_tdeint.cpp:46
 #: avidemux/ADM_videoFilter/ADM_vidYadif.cpp:178
-msgid "Top Field First"
+msgid "Top field first"
 msgstr "??????????"
 
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_tdeint.cpp:47
-msgid "Bottom Field First"
+msgid "Bottom field first"
 msgstr "??????????"
 
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_tdeint.cpp:52
-msgid "Bottom Field (keep top)"
+msgid "Bottom field (keep top)"
 msgstr "????????(??????)"
 
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_tdeint.cpp:53
-msgid "Top Field (keep Bottom)"
+msgid "Top field (keep bottom)"
 msgstr "????????(??????)"
 
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_tdeint.cpp:58
-msgid "Cubic Interpolation"
+msgid "Cubic interpolation"
 msgstr "Cubic ??"
 
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_tdeint.cpp:59
@@ -1576,7 +1631,7 @@
 msgstr "?? ELA"
 
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_tdeint.cpp:60
-msgid "Kernel Interpolation"
+msgid "Kernel interpolation"
 msgstr "Kernel ??"
 
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_tdeint.cpp:61
@@ -1584,27 +1639,27 @@
 msgstr "?? ELA-2"
 
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_tdeint.cpp:66
-msgid "4 Fields Check"
+msgid "4 fields check"
 msgstr "4???????"
 
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_tdeint.cpp:67
-msgid "5 Fields Check"
+msgid "5 fields check"
 msgstr "5???????"
 
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_tdeint.cpp:68
-msgid "4 Fields Check (no avg)"
+msgid "4 fields check (no avg)"
 msgstr "4???????(????)"
 
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_tdeint.cpp:69
-msgid "5 Fields Check (no avg)"
+msgid "5 fields check (no avg)"
 msgstr "5???????(????)"
 
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_tdeint.cpp:75
-msgid "No Link"
+msgid "No link"
 msgstr "?????"
 
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_tdeint.cpp:76
-msgid "Full Link"
+msgid "Full link"
 msgstr "?????"
 
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_tdeint.cpp:77
@@ -1616,21 +1671,20 @@
 msgstr "UV?Y?"
 
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_tdeint.cpp:82
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp:633
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp:649
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp:665
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp:695
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp:657
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp:664
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp:671
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp:784
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp:632
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp:648
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp:664
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp:694
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp:661
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp:668
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp:675
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp:788
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_idx_pg.cpp:166
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_idx_pg.cpp:206
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_ocr.cpp:148
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_ocr.cpp:156
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_resize.cpp:419
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_resize.cpp:433
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_srt.cpp:622
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1403
 msgid "0"
 msgstr "0"
@@ -1646,6 +1700,7 @@
 msgstr "2"
 
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_tdeint.cpp:91
+#: avidemux/ADM_videoFilter/ADM_vidDecTelecide.cpp:111
 #: avidemux/ADM_videoFilter/ADM_vidDGbob.cpp:90
 #: avidemux/ADM_videoFilter/ADM_vidKernelDeint.cpp:92
 msgid "_Field order:"
@@ -1672,90 +1727,75 @@
 msgstr "AP???(_A):"
 
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_tdeint.cpp:100
-msgid "Use Chroma to evalute"
-msgstr "????????"
+msgid "Use ch_roma to evalute"
+msgstr "????????(_R)"
 
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_tdeint.cpp:101
-msgid "Try weave"
-msgstr "weave???"
+msgid "Try _weave"
+msgstr "weave???(_W)"
 
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_tdeint.cpp:102
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_filters/gui_filterlist.cpp:173
-msgid "Denoise"
-msgstr "?????"
+msgid "_Denoise"
+msgstr "?????(_D)"
 
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_tdeint.cpp:103
-msgid "Sharp"
-msgstr "????"
+#: avidemux/ADM_videoFilter/ADM_vidKernelDeint.cpp:94
+msgid "_Sharp"
+msgstr "????(_S)"
 
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_tdeint.cpp:104
-msgid "Evalute all frames"
-msgstr "??????????"
+msgid "_Evalute all frames"
+msgstr "??????????(_E)"
 
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_tdeint.cpp:107
-msgid "Motion threshold, Luma:"
-msgstr "????, ??:"
+msgid "Motion threshold, l_uma:"
+msgstr "????, ??(_U):"
 
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_tdeint.cpp:108
-msgid "Motion threshold, Chroma:"
-msgstr "????, ??:"
+msgid "Motion threshold, c_hroma:"
+msgstr "????, ??(_H):"
 
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_tdeint.cpp:109
-msgid "Area combing threshold:"
-msgstr "?????????:"
+msgid "Area com_bing threshold:"
+msgstr "?????????(_B):"
 
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_tdeint.cpp:110
-msgid "Combed threshold:"
-msgstr "??????:"
+msgid "Combe_d threshold:"
+msgstr "??????(_D):"
 
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_tdeint.cpp:111
-msgid "Artefact prot. threshold:"
-msgstr "??????:"
+msgid "Artefact _protection threshold:"
+msgstr "??????(_P):"
 
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_tdeint.cpp:120
-msgid "TDEint Configuration"
-msgstr "TDeint ??"
+msgid "TDeint"
+msgstr "TDeint"
 
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_v2v.cpp:41
-msgid "Vob file(s):"
-msgstr "VOB????:"
+msgid "_VOB file(s):"
+msgstr "VOB????(_V):"
 
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_v2v.cpp:42
-msgid "IFO file:"
-msgstr "IFO????:"
+msgid "_IFO file:"
+msgstr "IFO????(_I):"
 
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_v2v.cpp:43
-msgid "Vobsub file:"
-msgstr "VobSub????:"
+msgid "Vob_Sub file:"
+msgstr "VobSub????(_S):"
 
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_v2v.cpp:48
-msgid "Vob 2 Vobsub"
-msgstr ""
+msgid "VOB to VobSub"
+msgstr "VOB?VobSub?"
 
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_v2v.cpp:52
-msgid "VOB file"
-msgstr "VOB????"
-
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_v2v.cpp:52
-msgid "The selected vobfile does not exist."
-msgstr "????VOB???????????."
-
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_v2v.cpp:57
-msgid "IFO file"
-msgstr "IFO????"
+msgid "The selected vobfile does not exist"
+msgstr "????VOB???????????"
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_v2v.cpp:57
-msgid "The selected IFO file does not exist."
-msgstr "????IFO???????????."
-
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_v2v.cpp:62
-msgid "VobSub file"
-msgstr "VobSub????"
+msgid "Please select a correct VobSub path/dir"
+msgstr "???VobSub???/???????????"
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_v2v.cpp:62
-msgid "Select a correct vobsub path/dir."
-msgstr "???VobSub??/???????????."
-
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_about.cpp:54
 msgid "translator-credits"
 msgstr "tetsuro"
@@ -2240,119 +2280,120 @@
 msgid "Busy"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp:403
-msgid "Bitrate Calculator"
-msgstr "????????"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp:401
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:982
+msgid "Calculator"
+msgstr "??"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp:431
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp:414
+msgid "<b>Target</b>"
+msgstr "<b>??</b>"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp:441
 msgid "Duration:"
 msgstr "????:"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp:437
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp:798
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp:447
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp:802
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_idx_pg.cpp:198
 msgid "00:00:00"
 msgstr "00:00:00"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp:451
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp:461
 msgid "_Medium:"
 msgstr "????(_M):"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp:462
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp:472
 msgid "_Format:"
 msgstr "??(_F):"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp:473
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp:531
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp:483
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp:541
 msgid "Total size (custom)"
 msgstr "?????(????)"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp:483
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp:493
 msgid "_Custom size (MB):"
 msgstr "???????(_C) (MB):"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp:497
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp:507
 msgid "Output container format"
 msgstr "????????"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp:524
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp:534
 msgid "Total size"
 msgstr "?????"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp:528
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp:538
 msgid "1x 80 min. CD"
 msgstr "1x 80? CD"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp:533
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp:543
 msgid "2x 80 min. CD"
 msgstr "2x 80? CD"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp:537
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp:547
 msgid "1x 74 min. CD"
 msgstr "1x 74? CD"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp:541
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp:551
 msgid "2x 74 min. CD"
 msgstr "2x 74? CD"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp:545
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp:555
 msgid "DVD5"
 msgstr "DVD5"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp:549
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp:559
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:808
 msgid "Custom"
 msgstr "????"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp:555
-msgid "<b>Target</b>"
-msgstr "<b>??</b>"
-
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp:575
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp:571
 msgid "Track _1:"
 msgstr "???? _1:"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp:583
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp:579
 msgid "Audio bitrate in kb/s for track 1 (0 for no audio)"
 msgstr "?????????????? kb/s (0?????)"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp:591
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp:586
 msgid "Track _2: "
 msgstr "???? _2: "
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp:599
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp:594
 msgid "Audio bitrate in kb/s for track 2 (optional)"
 msgstr "?????????????? kb/s (??)"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp:603
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp:598
 msgid "<b>Audio Bitrate</b>"
 msgstr "<b>????????</b>"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp:625
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp:624
 msgid "Audio size (MB):"
 msgstr "????? (MB):"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp:641
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp:640
 msgid "Video size (MB):"
 msgstr "????? (MB):"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp:657
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp:656
 msgid "Total size (MB):"
 msgstr "????? (MB):"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp:679
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp:678
 msgid "Video bitrate:"
 msgstr "????????:"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp:687
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp:686
 msgid "Bits per pixel:"
 msgstr "???/????:"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp:703
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp:702
 msgid "0.0"
 msgstr "0.0"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp:711
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp:710
 msgid "<b>Result</b>"
 msgstr "<b>??</b>"
 
@@ -2416,10 +2457,6 @@
 msgid "<b>Mode</b>"
 msgstr "<b>???</b>"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_color.cpp:71
-msgid "Select Color"
-msgstr "????"
-
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_coloryuv.cpp:155
 msgid "ColorYuv (From avisynth)"
 msgstr "ColorYuv (Avisynth??)"
@@ -2548,126 +2585,126 @@
 msgid "Crop Bottom:"
 msgstr "?????:"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp:157
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp:179
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp:161
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp:183
 #: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_encoding.cpp:53
 #: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_encoding.cpp:71
 msgid "Privileges Required"
 msgstr "????????"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp:157
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp:179
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp:161
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp:183
 #: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_encoding.cpp:53
 #: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_encoding.cpp:71
 msgid "Root privileges are required to perform this operation."
 msgstr "???????????Root????????"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp:200
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp:204
 #: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_encoding.cpp:177
 msgid "Shutting down"
 msgstr "????????"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp:377
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp:381
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_working.cpp:150
 #, c-format
 msgid "%d%%"
 msgstr "%d%%"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp:400
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp:407
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp:414
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp:404
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp:411
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp:418
 #, c-format
 msgid "%lu MB"
 msgstr "%lu MB"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp:510
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp:514
 msgid "Encoding..."
 msgstr "??????..."
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp:541
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp:545
 msgid "<b>Phase:</b>"
 msgstr "<b>????:</b>"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp:556
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp:560
 msgid "<b>Video Codec:</b>"
 msgstr "<b>???????:</b>"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp:571
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp:575
 msgid "<b>Audio Codec:</b>"
 msgstr "<b>???????:</b>"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp:586
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp:590
 msgid "<b>Container:</b>"
 msgstr "<b>????:</b>"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp:618
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp:622
 msgid "<b>Processed Frames:</b>"
 msgstr "<b>???????:</b>"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp:626
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp:630
 msgid "<b>Total Frames:</b>"
 msgstr "<b>???????:</b>"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp:634
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp:638
 msgid "<b>Quantiser:</b>"
 msgstr "<b>????:</b>"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp:642
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp:646
 msgid "<b>Average Bitrate:</b>"
 msgstr "<b>????????:</b>"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp:650
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp:654
 msgid "0 kB/s"
 msgstr "0 kB/s"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp:695
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp:699
 msgid "<b>Video Size:</b>"
 msgstr "<b>?????:</b>"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp:703
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp:707
 msgid "<b>Audio Size:</b>"
 msgstr "<b>?????:</b>"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp:711
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp:715
 msgid "<b>Total Size:</b>"
 msgstr "<b>?????:</b>"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp:719
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp:727
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp:735
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp:723
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp:731
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp:739
 msgid "0 MB"
 msgstr "0 MB"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp:760
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp:764
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_working.cpp:244
 msgid "<b>Elapsed:</b>"
 msgstr "<b>????:</b>"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp:768
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_working.cpp:258
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp:772
 msgid "<b>Time Remaining:</b>"
 msgstr "<b>????:</b>"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp:776
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp:780
 msgid "<b>Frames/sec:</b>"
 msgstr "<b>????/?:</b>"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp:822
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp:826
 msgid "Shut down computer when finished"
 msgstr "?????????????????????"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp:830
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp:834
 msgid "Priority:"
 msgstr "???:"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp:840
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp:844
 msgid "Above Normal"
 msgstr "????"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp:842
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp:846
 msgid "Below Normal"
 msgstr "????"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp:880
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp:884
 msgid "Pause / Abort"
 msgstr "?? / ??"
 
@@ -2721,7 +2758,7 @@
 
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_exLame.cpp:89
 msgid "Enter parameters (i.e. -b 192 -m s ...)"
-msgstr "???????? (?: -b 192 -ms ...)"
+msgstr "???????? (?: -b 192 -m s ...)"
 
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_hue.cpp:84
 msgid "Hue"
@@ -2859,7 +2896,7 @@
 msgstr "??????"
 
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_jobs_save.cpp:49
-msgid "Select video to write"
+msgid "Select Video to Write"
 msgstr "????????"
 
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_jobs_save.cpp:63
@@ -2867,42 +2904,42 @@
 msgstr "????????"
 
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_jobs_save.cpp:63
-msgid "Please select or enter a valid filename"
-msgstr "?????????????????????"
+msgid "Please select or enter a valid filename."
+msgstr "?????????????????????."
 
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_jobs_save.cpp:69
 msgid "Invalid jobname"
 msgstr "???????"
 
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_jobs_save.cpp:69
-msgid "Please select or enter a valid jobname"
-msgstr "????????????????????"
+msgid "Please select or enter a valid jobname."
+msgstr "????????????????????."
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_jobs_save.cpp:111
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_jobs_save.cpp:110
 msgid "Save Job"
 msgstr "??????"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_jobs_save.cpp:130
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_jobs_save.cpp:131
 msgid "Select the output file"
 msgstr "?????????"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_jobs_save.cpp:144
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_jobs_save.cpp:145
 msgid "_Browse..."
 msgstr "??(_B)"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_jobs_save.cpp:153
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_jobs_save.cpp:154
 msgid "Job name displayed in the job list and used as the script filename"
 msgstr "???????????, ?????????????????????"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_jobs_save.cpp:162
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_jobs_save.cpp:163
 msgid "Filename of the audio/video output"
 msgstr "??/??????????"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_jobs_save.cpp:165
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_jobs_save.cpp:166
 msgid "_Job name:"
 msgstr "????(_J)"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_jobs_save.cpp:172
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_jobs_save.cpp:173
 msgid "Output _file:"
 msgstr "??????(_F):"
 
@@ -3261,66 +3298,15 @@
 msgid "Lanczos3"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_srt.cpp:348
-msgid "Subtitle to load"
-msgstr "?????"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_srt.cpp:92
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_srt.cpp:224
+msgid "Subtitle Size and Position"
+msgstr "????????"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_srt.cpp:358
-msgid "TTF font to use"
-msgstr "????TTF????"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_srt.cpp:238
+msgid "Font Size:"
+msgstr "???????:"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_srt.cpp:475
-msgid "Subtitle selector"
-msgstr "??????"
-
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_srt.cpp:488
-msgid "Subtitle file "
-msgstr "??????"
-
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_srt.cpp:495
-msgid "Font (TTF)"
-msgstr "????(TTF)"
-
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_srt.cpp:502
-msgid "Encoding "
-msgstr "?????"
-
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_srt.cpp:509
-msgid "Font Size"
-msgstr "???????"
-
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_srt.cpp:522
-msgid "sub"
-msgstr ""
-
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_srt.cpp:540
-msgid "font"
-msgstr "????"
-
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_srt.cpp:560
-msgid "Ascii"
-msgstr "ASCII"
-
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_srt.cpp:586
-msgid "Select color"
-msgstr "???"
-
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_srt.cpp:599
-msgid "Select"
-msgstr "??"
-
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_srt.cpp:603
-msgid "Auto split"
-msgstr "????"
-
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_srt.cpp:609
-msgid "Delay in ms"
-msgstr "?? (ms)"
-
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_srt.cpp:624
-msgid "Force background"
-msgstr "????"
-
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_vcodec.cpp:104
 msgid "Video encoder"
 msgstr "???????"
@@ -3367,9 +3353,9 @@
 msgid "Processing"
 msgstr "???"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_working.cpp:243
-msgid "<b>Elasped:</b>"
-msgstr "<b>????:</b>"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_working.cpp:259
+msgid "<b>Time remaining:</b>"
+msgstr "<b>????:</b>"
 
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:560
 msgid "X264 configuration"
@@ -3428,66 +3414,79 @@
 msgstr "??"
 
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:675
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_srt.cpp:61
 #: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_x264.cpp:58
 msgid "1  - Extremely Low (Fastest)"
 msgstr "1  - ????? (??)"
 
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:676
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_srt.cpp:62
 #: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_x264.cpp:59
 msgid "2  - Very Low"
 msgstr "2  - ?????"
 
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:677
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_srt.cpp:63
 #: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_x264.cpp:60
 msgid "3  - Low"
 msgstr "3  - ??"
 
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:678
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_srt.cpp:64
 #: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_x264.cpp:61
 msgid "4  - Medium"
 msgstr "4  - ????"
 
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:679
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_srt.cpp:65
 #: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_x264.cpp:62
 msgid "5  - High (Default)"
 msgstr "5  - ?? (?????)"
 
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:680
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_srt.cpp:66
 #: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_x264.cpp:63
 msgid "6  - Very High"
 msgstr "6  - ?????"
 
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:681
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_srt.cpp:67
 #: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_x264.cpp:64
 msgid "6B - Very High (RDO on Bframes)"
 msgstr "6B - ????? (RDO on Bframes)"
 
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:682
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_srt.cpp:68
 #: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_x264.cpp:65
 msgid "7 - Ultra High"
 msgstr "7 - ???"
 
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:683
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_srt.cpp:69
 #: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_x264.cpp:66
 msgid "7B - Ultra High (RDO on Bframes)"
 msgstr "7B - ??? (RDO on Bframes)"
 
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:690
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_srt.cpp:75
 #: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_x264.cpp:72
 msgid "Diamond search"
 msgstr "????????"
 
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:691
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_srt.cpp:76
 #: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_x264.cpp:73
 msgid "Hexagonal search"
 msgstr "?????"
 
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:692
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_srt.cpp:77
 #: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_x264.cpp:74
 msgid "Uneven multi hexagon"
 msgstr "????????"
 
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:693
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_srt.cpp:78
 #: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_x264.cpp:75
 msgid "Exhaustive search"
 msgstr "????"
@@ -3509,6 +3508,7 @@
 msgstr "?????????????. ?????????????????????????????"
 
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:731
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_srt.cpp:83
 #: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_x264.cpp:80
 #: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_xvid4.cpp:89
 msgid "Chroma ME"
@@ -3519,6 +3519,7 @@
 msgstr "?????(?)????????????????????"
 
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:739
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_srt.cpp:84
 #: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_x264.cpp:81
 msgid "Mixed Refs"
 msgstr "????"
@@ -3549,7 +3550,7 @@
 
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:765
 msgid "<b>Motion Estimation</b>"
-msgstr "<b>????</b>"
+msgstr "<b>???? (ME)</b>"
 
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:792
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:804
@@ -3588,6 +3589,7 @@
 msgstr "<b>?????????? (A/R)</b>"
 
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:878
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_srt.cpp:111
 #: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_x264.cpp:108
 msgid "CABAC"
 msgstr "CABAC"
@@ -3597,6 +3599,7 @@
 msgstr "???????????(??????????)?15%??????????. ????????????."
 
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:884
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_srt.cpp:110
 #: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_x264.cpp:107
 msgid "Trellis"
 msgstr ""
@@ -3606,6 +3609,7 @@
 msgstr "????????????????????????????. ???0????????1????????2?????????"
 
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:900
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_srt.cpp:112
 #: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_x264.cpp:109
 msgid "Noise Reduction"
 msgstr "?????"
@@ -3640,7 +3644,7 @@
 
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:960
 msgid "<b>Misc. Options</b>"
-msgstr "<b>??, ?????</b>"
+msgstr "<b>????????</b>"
 
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:965
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:1066
@@ -3648,6 +3652,7 @@
 msgstr "?????"
 
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:986
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_srt.cpp:132
 #: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_x264.cpp:129
 msgid "8x8 Transform"
 msgstr "8x8 ??"
@@ -4073,6 +4078,7 @@
 msgstr "????!"
 
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid.cpp:490
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_srt.cpp:147
 #: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_x264.cpp:144
 msgid "B Frames"
 msgstr "B-????"
@@ -4097,6 +4103,23 @@
 msgid "The custom matrix file has been successfully loaded."
 msgstr "????????????????????????."
 
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:179
+msgid "Size (MBytes):"
+msgstr "??? (MBytes):"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:185
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:369
+msgid "Average bitrate (kb/s):"
+msgstr "???????? (kb/s):"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:354
+msgid "Target bitrate (kb/s):"
+msgstr "???????? (kb/s):"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:362
+msgid "Target size (MBytes):"
+msgstr "????? (MBytes):"
+
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:479
 msgid "Select Custom Matrix File to write"
 msgstr "????????????????????"
@@ -4512,11 +4535,21 @@
 msgid "<b>Inter Matrix</b>"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialogFactory/FAC_hex.cpp:116
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialogFactory/DIA_color.cpp:71
+msgid "Select Color"
+msgstr "????"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialogFactory/FAC_bitrate.cpp:73
+msgid "_Encoding mode:"
+msgstr "????????(_E):"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialogFactory/FAC_hex.cpp:100
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialogFactory/FAC_hex.cpp:134
 msgid "_Previous"
 msgstr "??(_P)"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialogFactory/FAC_hex.cpp:143
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialogFactory/FAC_hex.cpp:108
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialogFactory/FAC_hex.cpp:164
 msgid "_Next"
 msgstr "??(_N)"
 
@@ -4563,6 +4596,10 @@
 msgid "Colors"
 msgstr "?"
 
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_filters/gui_filterlist.cpp:173
+msgid "Denoise"
+msgstr "?????"
+
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_filters/gui_filterlist.cpp:198
 msgid "Sharpen/Blur"
 msgstr "????/???"
@@ -4572,6 +4609,10 @@
 msgid "Subtitles"
 msgstr "??"
 
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_filters/gui_filterlist.cpp:248
+msgid "Miscellaneous"
+msgstr "??"
+
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_filters/gui_filtermanager_dialog.cpp:123
 msgid "Video Filter Manager"
 msgstr "?? ???? ?????"
@@ -4625,6 +4666,8 @@
 msgstr "VCD  ??? [Ctrl-4]"
 
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_filters/gui_filtermanager_dialog.cpp:260
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_srt.cpp:138
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_srt.cpp:151
 #: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_x264.cpp:135
 #: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_x264.cpp:148
 msgid "Transform"
@@ -4639,6 +4682,7 @@
 msgstr "?????"
 
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_filters/gui_filtermanager_dialog.cpp:405
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_srt.cpp:120
 #: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_x264.cpp:117
 msgid "Misc"
 msgstr "??"
@@ -5087,10 +5131,6 @@
 msgid "Audio/video file information"
 msgstr "??/????????"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:982
-msgid "Calculator"
-msgstr "??"
-
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:985
 msgid "Bitrate/size calculator"
 msgstr "??????/?????"
@@ -5219,8 +5259,8 @@
 msgstr "???????"
 
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1406
-msgid "/0000000"
-msgstr "/0000000"
+msgid "/ 0000000"
+msgstr "/ 0000000"
 
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1413
 msgid "Time: "
@@ -5235,42 +5275,50 @@
 msgstr "00:00:00.000"
 
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1424
-msgid "/00:00:00,000"
-msgstr "/00:00:00,000"
+msgid "/ 00:00:00,000"
+msgstr "/ 00:00:00,000"
 
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1431
 msgid "Frame: ?"
 msgstr "????: ?"
 
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_ocr/adm_ocr.cpp:209
 #: avidemux/ADM_userInterfaces/ADM_GTK/adm_ocr.cpp:209
 msgid "Incorrect output file"
-msgstr "???????????"
+msgstr "?????????"
 
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_ocr/adm_ocr.cpp:215
 #: avidemux/ADM_userInterfaces/ADM_GTK/adm_ocr.cpp:215
 msgid "Output file error"
 msgstr "?????????"
 
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_ocr/adm_ocr.cpp:215
 #: avidemux/ADM_userInterfaces/ADM_GTK/adm_ocr.cpp:215
 #, possible-c-format
 msgid "Could not open \"%s\" for writing."
 msgstr "????? \"%s\" ??????"
 
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_ocr/adm_ocr.cpp:224
 #: avidemux/ADM_userInterfaces/ADM_GTK/adm_ocr.cpp:224
 msgid "Problem loading sub"
 msgstr "????????"
 
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_ocr/adm_ocr.cpp:589
 #: avidemux/ADM_userInterfaces/ADM_GTK/adm_ocr.cpp:589
 msgid "Sure ?"
 msgstr "?? ?"
 
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_ocr/adm_ocr.cpp:752
 #: avidemux/ADM_userInterfaces/ADM_GTK/adm_ocr.cpp:752
 msgid "Select SRT to save"
 msgstr "????SRT???"
 
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_ocr/adm_ocr.cpp:764
 #: avidemux/ADM_userInterfaces/ADM_GTK/adm_ocr.cpp:764
 msgid "Select Glyoh to save"
 msgstr "??????????"
 
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_ocr/adm_ocr.cpp:778
 #: avidemux/ADM_userInterfaces/ADM_GTK/adm_ocr.cpp:778
 msgid "No glyphs to save"
 msgstr "?????????????"
@@ -5331,73 +5379,91 @@
 msgid "Alert"
 msgstr "??"
 
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_srt.cpp:72
 #: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_x264.cpp:69
 msgid "Partition Decision"
 msgstr "????"
 
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_srt.cpp:80
 #: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_x264.cpp:77
 #: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_xvid4.cpp:72
 msgid "VHQ Mode"
 msgstr "VHQ???"
 
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_srt.cpp:81
 #: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_x264.cpp:78
 msgid "Max Ref Frames"
 msgstr "?????????"
 
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_srt.cpp:82
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_srt.cpp:146
 #: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_x264.cpp:79
 #: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_x264.cpp:143
 #: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_xvid4.cpp:76
 msgid "Max B Frames"
 msgstr "??B-?????"
 
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_srt.cpp:85
 #: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_x264.cpp:82
 msgid "Fast P Skip"
 msgstr "??P????"
 
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_srt.cpp:86
 #: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_x264.cpp:83
 msgid "DCT Decimate"
 msgstr ""
 
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_srt.cpp:87
 #: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_x264.cpp:84
 msgid "Interlaced"
 msgstr "??????"
 
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_srt.cpp:106
 #: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_x264.cpp:103
 msgid "Disabled"
 msgstr "??"
 
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_srt.cpp:113
 #: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_x264.cpp:110
 msgid "Deblocking Filter"
 msgstr "????? ????"
 
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_srt.cpp:114
 #: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_x264.cpp:111
 msgid "Strength"
 msgstr "??"
 
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_srt.cpp:115
 #: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_x264.cpp:112
 msgid "Threshold"
 msgstr "??"
 
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_srt.cpp:133
 #: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_x264.cpp:130
 msgid "8x8P Transform"
 msgstr "8x8P ??"
 
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_srt.cpp:134
 #: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_x264.cpp:131
 msgid "8x8B Transform"
 msgstr "8x8B ??"
 
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_srt.cpp:135
 #: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_x264.cpp:132
 msgid "_4x4 Transform"
 msgstr "4x4 ??(_4)"
 
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_srt.cpp:136
 #: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_x264.cpp:133
 msgid "_8x8I Transform"
 msgstr "8x8I ??(_8)"
 
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_srt.cpp:137
 #: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_x264.cpp:134
 msgid "_4x4I Transform"
 msgstr "4x4I ??(_4)"
 
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_srt.cpp:155
 #: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_x264.cpp:152
 msgid "X264 Configuration"
 msgstr "X264 ??"
@@ -5545,32 +5611,32 @@
 msgid "Partial Video Filter"
 msgstr "????????"
 
-#: avidemux/ADM_video/ADM_guiResize.cpp:96
-#: avidemux/ADM_video/ADM_vidMPLResize.cpp:143
-msgid "Width and height cannot be 0"
-msgstr "????? 0 ???????"
-
-#: avidemux/ADM_video/ADM_guiResize.cpp:98
-#: avidemux/ADM_video/ADM_vidMPLResize.cpp:145
-msgid "Width and height cannot be odd"
-msgstr "????? ?????????"
-
 #: avidemux/ADM_video/ADM_vidFieldUnblend.cpp:81
 msgid "Metrics"
-msgstr "??????"
+msgstr "???"
 
 #: avidemux/ADM_video/ADM_vidFieldUnblend.cpp:81
 msgid "Do you want to print metrics on screen ?"
-msgstr "???????????????????"
+msgstr "????????????????"
 
 #: avidemux/ADM_video/ADM_vidSRT.cpp:215
 msgid "Could not open subtitle file"
 msgstr "????????????"
 
-#: avidemux/ADM_video/ADM_vidSRT.cpp:238
+#: avidemux/ADM_video/ADM_vidSRT.cpp:235
 msgid "Cannot identify subtitle format"
 msgstr "????????????"
 
+#: avidemux/ADM_video/ADM_guiResize.cpp:96
+#: avidemux/ADM_video/ADM_vidMPLResize.cpp:143
+msgid "Width and height cannot be 0"
+msgstr "????? 0 ???????"
+
+#: avidemux/ADM_video/ADM_guiResize.cpp:98
+#: avidemux/ADM_video/ADM_vidMPLResize.cpp:145
+msgid "Width and height cannot be odd"
+msgstr "????? ?????????"
+
 #: avidemux/ADM_videoFilter/ADM_lavpp_deint.cpp:106
 msgid "Linear blend"
 msgstr "??????"
@@ -5600,45 +5666,50 @@
 msgstr "?????(_A)"
 
 #: avidemux/ADM_videoFilter/ADM_vidASS.cpp:85
-msgid "_Subtitle file (ass/ssa)"
-msgstr "??????(_S) (ass/ssa)"
+msgid "_Subtitle file (ASS/SSA):"
+msgstr "??????(_S) (ASS/SSA):"
 
 #: avidemux/ADM_videoFilter/ADM_vidASS.cpp:86
-msgid "_Line spacing"
-msgstr "???????(_L)"
+msgid "_Line spacing:"
+msgstr "???????(_L):"
 
 #: avidemux/ADM_videoFilter/ADM_vidASS.cpp:87
-msgid "_Font scale"
-msgstr "????????(_F)"
+msgid "_Font scale:"
+msgstr "????????(_F):"
 
 #: avidemux/ADM_videoFilter/ADM_vidASS.cpp:88
-msgid "_Top margin"
-msgstr "???(_T)"
+msgid "_Top margin:"
+msgstr "???(_T):"
 
 #: avidemux/ADM_videoFilter/ADM_vidASS.cpp:89
-msgid "_Bottom margin"
-msgstr "???(_B)"
+msgid "Botto_m margin"
+msgstr "???(_M)"
 
 #: avidemux/ADM_videoFilter/ADM_vidBlendRemoval.cpp:82
-msgid "threshold"
-msgstr "??"
+#: avidemux/ADM_videoFilter/ADM_vidDGbob.cpp:92
+#: avidemux/ADM_videoFilter/ADM_vidHardIvtcRemoval.cpp:87
+#: avidemux/ADM_videoFilter/ADM_vidKernelDeint.cpp:93
+#: avidemux/ADM_videoFilter/ADM_vidMSharpen.cpp:166
+msgid "_Threshold:"
+msgstr "??(_T):"
 
 #: avidemux/ADM_videoFilter/ADM_vidBlendRemoval.cpp:83
-#: avidemux/ADM_videoFilter/ADM_vidHardIvtcRemoval.cpp:88
-msgid "If value is smaller than threshold it is considered valid. Smaller value might mean more false positive"
+msgid "If value is smaller than threshold it is considered valid.Smaller value might mean more false positive."
 msgstr "?????????????????. ???????????????????"
 
 #: avidemux/ADM_videoFilter/ADM_vidBlendRemoval.cpp:85
-msgid "noise"
-msgstr "???"
+#: avidemux/ADM_videoFilter/ADM_vidHardIvtcRemoval.cpp:90
+msgid "_Noise:"
+msgstr "???(_N):"
 
 #: avidemux/ADM_videoFilter/ADM_vidBlendRemoval.cpp:85
-msgid "If pixel are closer than noise, they are considered to be the same"
+#: avidemux/ADM_videoFilter/ADM_vidHardIvtcRemoval.cpp:90
+msgid "If pixels are closer than noise, they are considered to be the same"
 msgstr "??????????????, ??????"
 
 #: avidemux/ADM_videoFilter/ADM_vidBlendRemoval.cpp:86
-msgid "identical"
-msgstr "??"
+msgid "I_dentical:"
+msgstr "??(_D):"
 
 #: avidemux/ADM_videoFilter/ADM_vidBlendRemoval.cpp:86
 #: avidemux/ADM_videoFilter/ADM_vidHardIvtcRemoval.cpp:91
@@ -5646,8 +5717,9 @@
 msgstr "??????????????, ?????????"
 
 #: avidemux/ADM_videoFilter/ADM_vidBlendRemoval.cpp:87
-msgid "show"
-msgstr "??"
+#: avidemux/ADM_videoFilter/ADM_vidHardIvtcRemoval.cpp:92
+msgid "_Show metrics"
+msgstr "??????(_S)"
 
 #: avidemux/ADM_videoFilter/ADM_vidBlendRemoval.cpp:87
 #: avidemux/ADM_videoFilter/ADM_vidHardIvtcRemoval.cpp:92
@@ -5655,7 +5727,7 @@
 msgstr "????????????(?????)"
 
 #: avidemux/ADM_videoFilter/ADM_vidDecDec.cpp:190
-msgid "Discard Closer"
+msgid "Discard closer"
 msgstr "???????"
 
 #: avidemux/ADM_videoFilter/ADM_vidDecDec.cpp:191
@@ -5667,7 +5739,7 @@
 msgstr "??dupe???(???)"
 
 #: avidemux/ADM_videoFilter/ADM_vidDecDec.cpp:193
-msgid "PullDown dupe removal"
+msgid "Pulldown dupe removal"
 msgstr "?????dupe??"
 
 #: avidemux/ADM_videoFilter/ADM_vidDecDec.cpp:196
@@ -5675,34 +5747,37 @@
 msgstr "??(????, ????)"
 
 #: avidemux/ADM_videoFilter/ADM_vidDecDec.cpp:197
-msgid "Fast (parial luma and chroma)"
+msgid "Fast (partial luma and chroma)"
 msgstr "??(???????)"
 
 #: avidemux/ADM_videoFilter/ADM_vidDecDec.cpp:198
-msgid "Medium (full luma no chroma)"
+msgid "Medium (full luma, no chroma)"
 msgstr "????(????, ????)"
 
 #: avidemux/ADM_videoFilter/ADM_vidDecDec.cpp:199
 msgid "Slow (full luma and chroma)"
 msgstr "??(???????)"
 
-#: avidemux/ADM_videoFilter/ADM_vidDecDec.cpp:203
-#: avidemux/ADM_videoFilter/ADM_vidYadif.cpp:181
-msgid "Mode"
-msgstr "???"
-
-#: avidemux/ADM_videoFilter/ADM_vidDecDec.cpp:204
-msgid "Quality"
-msgstr "??"
-
 #: avidemux/ADM_videoFilter/ADM_vidDecDec.cpp:205
-msgid "Threshold 1"
-msgstr "?? 1"
+msgid "_Threshold 1:"
+msgstr "??? (_T):"
 
 #: avidemux/ADM_videoFilter/ADM_vidDecDec.cpp:206
-msgid "Threshold 2"
-msgstr "?? 2"
+msgid "T_hreshold 2:"
+msgstr "??? (_H):"
 
+#: avidemux/ADM_videoFilter/ADM_vidDecTelecide.cpp:83
+msgid "No strategy"
+msgstr "???????"
+
+#: avidemux/ADM_videoFilter/ADM_vidDecTelecide.cpp:84
+msgid "3:2 pulldown"
+msgstr "3:2?????"
+
+#: avidemux/ADM_videoFilter/ADM_vidDecTelecide.cpp:85
+msgid "PAL/SECAM"
+msgstr "PAL/SECAM"
+
 #: avidemux/ADM_videoFilter/ADM_vidDecTelecide.cpp:91
 #: avidemux/ADM_videoFilter/ADM_vidDGbob.cpp:82
 #: avidemux/ADM_videoFilter/ADM_vidKernelDeint.cpp:88
@@ -5731,64 +5806,60 @@
 msgstr "??????????"
 
 #: avidemux/ADM_videoFilter/ADM_vidDecTelecide.cpp:104
-msgid "Postproc and show zones(debug)"
-msgstr "???????????(????)"
+msgid "Postproc and show zones (debug)"
+msgstr "??????????? (????)"
 
 #: avidemux/ADM_videoFilter/ADM_vidDecTelecide.cpp:105
 msgid "Process image (not fields)"
 msgstr "?????(?????????)"
 
 #: avidemux/ADM_videoFilter/ADM_vidDecTelecide.cpp:106
-msgid "Process image (not fields),debug"
-msgstr "?????(?????????),????"
+msgid "Process image (not fields), debug"
+msgstr "?????(?????????), ????"
 
 #: avidemux/ADM_videoFilter/ADM_vidDecTelecide.cpp:110
-msgid "Strategy"
-msgstr "?????"
+msgid "_Strategy:"
+msgstr "?????(_S):"
 
-#: avidemux/ADM_videoFilter/ADM_vidDecTelecide.cpp:111
-msgid "Field Order"
-msgstr "?????????"
-
 #: avidemux/ADM_videoFilter/ADM_vidDecTelecide.cpp:112
-msgid "Post Processing"
-msgstr "???"
+msgid "_Postprocessing:"
+msgstr "???(_P):"
 
 #: avidemux/ADM_videoFilter/ADM_vidDecTelecide.cpp:113
-msgid "Try backward"
-msgstr "??????"
+msgid "_Try backward:"
+msgstr "??????(_T):"
 
 #: avidemux/ADM_videoFilter/ADM_vidDecTelecide.cpp:115
-msgid "Direct Threshold"
-msgstr "????"
+msgid "_Direct threshold:"
+msgstr "????(_D):"
 
 #: avidemux/ADM_videoFilter/ADM_vidDecTelecide.cpp:116
-msgid "Backward Threshold"
-msgstr "?????"
+msgid "_Backward threshold:"
+msgstr "?????(_B):"
 
 #: avidemux/ADM_videoFilter/ADM_vidDecTelecide.cpp:117
-msgid "Noise Threshold"
-msgstr "?????"
+msgid "_Noise threshold:"
+msgstr "?????(_N):"
 
 #: avidemux/ADM_videoFilter/ADM_vidDecTelecide.cpp:118
-msgid "Post Proc Threshold"
-msgstr "?????"
+msgid "Postp_rocessing threshold:"
+msgstr "?????(_R):"
 
 #: avidemux/ADM_videoFilter/ADM_vidDecTelecide.cpp:120
-msgid "Use Chroma to decide"
-msgstr "????????"
+msgid "_Use chroma to decide"
+msgstr "????????(_U)"
 
 #: avidemux/ADM_videoFilter/ADM_vidDecTelecide.cpp:121
-msgid "Show info"
-msgstr "?????"
+msgid "Sho_w info"
+msgstr "?????(_W)"
 
 #: avidemux/ADM_videoFilter/ADM_vidDecTelecide.cpp:122
-msgid "Debug"
-msgstr "????"
+msgid "Debu_g"
+msgstr "????(_G)"
 
 #: avidemux/ADM_videoFilter/ADM_vidDecTelecide.cpp:123
-msgid "Blend"
-msgstr "????"
+msgid "Bl_end"
+msgstr "????(_E)"
 
 #: avidemux/ADM_videoFilter/ADM_vidDenoise.cpp:386
 msgid "_Luma lock:"
@@ -5822,13 +5893,6 @@
 msgid "Double nb of frames (slow motion)"
 msgstr "???????????(????????)"
 
-#: avidemux/ADM_videoFilter/ADM_vidDGbob.cpp:92
-#: avidemux/ADM_videoFilter/ADM_vidHardIvtcRemoval.cpp:87
-#: avidemux/ADM_videoFilter/ADM_vidKernelDeint.cpp:93
-#: avidemux/ADM_videoFilter/ADM_vidMSharpen.cpp:166
-msgid "_Threshold:"
-msgstr "??(_T):"
-
 #: avidemux/ADM_videoFilter/ADM_vidDGbob.cpp:93
 msgid "_Extra"
 msgstr "??(_E)"
@@ -5885,31 +5949,19 @@
 msgid "_Quantizer:"
 msgstr "????(_Q):"
 
-#: avidemux/ADM_videoFilter/ADM_vidHardIvtcRemoval.cpp:90
-msgid "_Noise:"
-msgstr "???(_N):"
+#: avidemux/ADM_videoFilter/ADM_vidHardIvtcRemoval.cpp:88
+msgid "If value is smaller than threshold it is considered valid. Smaller value might mean more false positive"
+msgstr "?????????????????. ????????????????????"
 
-#: avidemux/ADM_videoFilter/ADM_vidHardIvtcRemoval.cpp:90
-msgid "If pixels are closer than noise, they are considered to be the same"
-msgstr "?????????????????????"
-
 #: avidemux/ADM_videoFilter/ADM_vidHardIvtcRemoval.cpp:91
 msgid "_Identical:"
 msgstr "??(_I):"
 
-#: avidemux/ADM_videoFilter/ADM_vidHardIvtcRemoval.cpp:92
-msgid "_Show metrics"
-msgstr "??????(_S)"
-
 #: avidemux/ADM_videoFilter/ADM_vidKernelDeint.cpp:93
 msgid "Smaller means more deinterlacing"
 msgstr "???????????????????????"
 
 #: avidemux/ADM_videoFilter/ADM_vidKernelDeint.cpp:94
-msgid "_Sharp"
-msgstr "????(_S)"
-
-#: avidemux/ADM_videoFilter/ADM_vidKernelDeint.cpp:94
 msgid "_Sharper engine:"
 msgstr "?????????????(_S)"
 
@@ -5986,11 +6038,11 @@
 
 #: avidemux/ADM_videoFilter/ADM_vidMSharpen.cpp:164
 msgid "_High Q"
-msgstr ""
+msgstr "?Q (_H)"
 
 #: avidemux/ADM_videoFilter/ADM_vidPalShift.cpp:76
-msgid "Try reverse"
-msgstr "????"
+msgid "_Try reverse"
+msgstr "????(_T)"
 
 #: avidemux/ADM_videoFilter/ADM_vidResampleFPS.cpp:85
 msgid "_New frame rate:"
@@ -6025,12 +6077,12 @@
 msgstr "270?"
 
 #: avidemux/ADM_videoFilter/ADM_vidRotate.cpp:269
-msgid "Angle"
-msgstr "??"
+msgid "_Angle:"
+msgstr "??(_A):"
 
 #: avidemux/ADM_videoFilter/ADM_vidRotate.cpp:271
-msgid "Rotate Params"
-msgstr "???????"
+msgid "Rotate"
+msgstr "??"
 
 #: avidemux/ADM_videoFilter/ADM_vidSoften.cpp:68
 msgid "_Luma threshold:"
@@ -6049,39 +6101,35 @@
 msgstr "?????"
 
 #: avidemux/ADM_videoFilter/ADM_vidVlad.cpp:101
-msgid "Luma Temporal Threshold"
-msgstr "???????"
+msgid "_Luma temporal threshold:"
+msgstr "???????(_L):"
 
 #: avidemux/ADM_videoFilter/ADM_vidVlad.cpp:102
-msgid "Chroma Temporal Threshold"
-msgstr "???????"
+msgid "Ch_roma temporal threshold:"
+msgstr "???????(_R):"
 
 #: avidemux/ADM_videoFilter/ADM_vidYadif.cpp:171
-msgid "Temporal & Spatial check"
+msgid "Temporal & spatial check"
 msgstr "?????????"
 
 #: avidemux/ADM_videoFilter/ADM_vidYadif.cpp:172
-msgid "Bob, T+S check"
-msgstr "Bob, T+S????"
+msgid "Bob, temporal & spatial check"
+msgstr "Bob, ?????????"
 
 #: avidemux/ADM_videoFilter/ADM_vidYadif.cpp:173
 msgid "Skip spatial temporal check"
 msgstr "??-???????????"
 
 #: avidemux/ADM_videoFilter/ADM_vidYadif.cpp:174
-msgid "Bob, Skip spatial temporal check"
+msgid "Bob, skip spatial temporal check"
 msgstr "Bob, ??-???????????"
 
-#: avidemux/ADM_videoFilter/ADM_vidYadif.cpp:177
-msgid "Bottom Field first"
-msgstr "??????????"
-
 #: avidemux/ADM_videoFilter/ADM_vidYadif.cpp:182
-msgid "Order"
-msgstr "????"
+msgid "_Order:"
+msgstr "????(_O):"
 
 #: avidemux/gtk_gui.cpp:246
-msgid "Select ECMAScript to run "
+msgid "Select ECMAScript to Run"
 msgstr "????ECMA????????"
 
 #: avidemux/gtk_gui.cpp:293
@@ -6097,7 +6145,7 @@
 #: avidemux/gtk_gui.cpp:378
 #: avidemux/gtk_gui.cpp:493
 #: avidemux/gtk_gui.cpp:496
-msgid "Select AVI file..."
+msgid "Select AVI File..."
 msgstr "AVI???????..."
 
 #: avidemux/gtk_gui.cpp:429
@@ -6109,57 +6157,57 @@
 "???????"
 
 #: avidemux/gtk_gui.cpp:431
-msgid "Select AVI file to write"
+msgid "Select AVI File to Write"
 msgstr "???AVI???????"
 
 #: avidemux/gtk_gui.cpp:437
-msgid "Select OGM file to write"
+msgid "Select OGM File to Write"
 msgstr "???OGM???????"
 
 #: avidemux/gtk_gui.cpp:448
 #: avidemux/gtk_gui.cpp:459
-msgid "Select workbench to save"
+msgid "Select Workbench to Save"
 msgstr "?????????????"
 
 #: avidemux/gtk_gui.cpp:483
-msgid "Select raw file to save"
+msgid "Select Raw File to Save"
 msgstr "????raw???????"
 
 #: avidemux/gtk_gui.cpp:499
-msgid "Select AVI file to append..."
+msgid "Select AVI File to Append..."
 msgstr "????AVI???????..."
 
 #: avidemux/gtk_gui.cpp:503
-msgid "Select file to save audio"
+msgid "Select File to Save Audio"
 msgstr "??????????????"
 
 #: avidemux/gtk_gui.cpp:537
-msgid "Select JPEG sequence to save"
+msgid "Select JPEG Sequence to Save"
 msgstr "????JPEG?????"
 
 #: avidemux/gtk_gui.cpp:540
-msgid "Select BMP to save"
+msgid "Select BMP to Save"
 msgstr "????BMP???"
 
 #: avidemux/gtk_gui.cpp:544
-msgid "Select JPEG to save"
+msgid "Select JPEG to Save"
 msgstr "????JPEG???"
 
 #: avidemux/gtk_gui.cpp:597
 #: avidemux/gtk_gui.cpp:709
-msgid "Select file to save"
+msgid "Select File to Save"
 msgstr "???????????"
 
 #: avidemux/gtk_gui.cpp:649
-msgid "Select MP3 to load"
+msgid "Select MP3 to Load"
 msgstr "???MP3???"
 
 #: avidemux/gtk_gui.cpp:652
-msgid "Select AC3 to load"
+msgid "Select AC3 to Load"
 msgstr "???AC3???"
 
 #: avidemux/gtk_gui.cpp:655
-msgid "Select WAV to load"
+msgid "Select WAV to Load"
 msgstr "???WAV???"
 
 #: avidemux/gtk_gui.cpp:703
@@ -6184,12 +6232,12 @@
 msgstr "???????"
 
 #: avidemux/gtk_gui.cpp:795
-msgid "Change Frames per Second"
-msgstr "????/? ???"
+msgid "Frame Rate"
+msgstr "???????"
 
 #: avidemux/gtk_gui.cpp:795
-msgid "New FPS?"
-msgstr "???FPS ?"
+msgid "_Frames per second:"
+msgstr "????/?(_F):"
 
 #: avidemux/gtk_gui.cpp:818
 msgid "Width is not a multiple of 8"
@@ -6534,7 +6582,7 @@
 msgid "Frame Hex Dump"
 msgstr "????16????"
 
-#: avidemux/guiplay.cpp:367
+#: avidemux/guiplay.cpp:365
 msgid "Trouble initializing audio device"
 msgstr "?????????????"
 
@@ -6563,13 +6611,9 @@
 msgstr "??????????????????????????"
 
 #: avidemux/GUI_jobs.cpp:42
-msgid "Nothing to do."
-msgstr "???????."
+msgid "There are no jobs stored"
+msgstr "?????????"
 
-#: avidemux/GUI_jobs.cpp:42
-msgid "There is no jobs stored, nothing to do"
-msgstr "????????, ???????"
-
 #: avidemux/gui_navigate.cpp:75
 #: avidemux/gui_navigate.cpp:113
 #: avidemux/gui_navigate.cpp:389
@@ -6651,9 +6695,6 @@
 msgid "Audio"
 msgstr "??"
 
-msgid "External Filters"
-msgstr "??????"
-
 ############ MPEG-2 Configuration
 msgid "_Bitrate (kb/s):"
 msgstr "??????(_B) (kb/s):"



From mihailzenkov at mail.berlios.de  Tue Jul  3 18:18:49 2007
From: mihailzenkov at mail.berlios.de (mihailzenkov at BerliOS)
Date: Tue, 3 Jul 2007 18:18:49 +0200
Subject: [Avidemux-svn-commit] r3329 -
	branches/avidemux_2.4_branch/avidemux/ADM_audiofilter
Message-ID: <200707031618.l63GInhq011213@sheep.berlios.de>

Author: mihailzenkov
Date: 2007-07-03 18:18:49 +0200 (Tue, 03 Jul 2007)
New Revision: 3329

Modified:
   branches/avidemux_2.4_branch/avidemux/ADM_audiofilter/audioencoder.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_audiofilter/audioencoder_faac.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_audiofilter/audioencoder_vorbis.cpp
Log:
fix reorderChannels

Modified: branches/avidemux_2.4_branch/avidemux/ADM_audiofilter/audioencoder.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_audiofilter/audioencoder.cpp	2007-07-02 18:27:26 UTC (rev 3328)
+++ branches/avidemux_2.4_branch/avidemux/ADM_audiofilter/audioencoder.cpp	2007-07-03 16:18:49 UTC (rev 3329)
@@ -140,7 +140,6 @@
 	float tmp [_wavheader->channels];
 	static uint8_t reorder[MAX_CHANNELS];
 	static bool reorder_on;
-	uint32_t len = nb / _wavheader->channels;
 	
 	if (ch_route.mode < 1) {
 		reorder_on = 0;
@@ -168,7 +167,7 @@
 	}
 
 	if (reorder_on)
-		for (int i = 0; i < len; i++) {
+		for (int i = 0; i < nb; i++) {
 			memcpy(tmp, data, sizeof(tmp));
 			for (int c = 0; c < _wavheader->channels; c++)
 				*data++ = tmp[reorder[c]];

Modified: branches/avidemux_2.4_branch/avidemux/ADM_audiofilter/audioencoder_faac.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_audiofilter/audioencoder_faac.cpp	2007-07-02 18:27:26 UTC (rev 3328)
+++ branches/avidemux_2.4_branch/avidemux/ADM_audiofilter/audioencoder_faac.cpp	2007-07-03 16:18:49 UTC (rev 3329)
@@ -208,8 +208,7 @@
           return 0; 
         }
         ADM_assert(tmptail>=tmphead);
-        if(_wavheader->channels > 2)
-            reorderChannels(&(tmpbuffer[tmphead]),_chunk);
+        reorderChannels(&(tmpbuffer[tmphead]),*samples);
         *len = faacEncEncode(_handle, (int32_t *)&(tmpbuffer[tmphead]), _chunk, dest, FA_BUFFER_SIZE);
         if(!*len) 
         {

Modified: branches/avidemux_2.4_branch/avidemux/ADM_audiofilter/audioencoder_vorbis.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_audiofilter/audioencoder_vorbis.cpp	2007-07-02 18:27:26 UTC (rev 3328)
+++ branches/avidemux_2.4_branch/avidemux/ADM_audiofilter/audioencoder_vorbis.cpp	2007-07-03 16:18:49 UTC (rev 3329)
@@ -226,13 +226,13 @@
     float_samples=vorbis_analysis_buffer(&VD, nbSample) ;
     int index=tmphead;
     // Put our samples in incoming buffer
+    reorderChannels(&(tmpbuffer[tmphead]), nbSample);
     for (int i = 0; i < nbSample; i++)
       for (int j = 0; j < _wavheader->channels; j++) {
       float_samples[j][i] = tmpbuffer[index++];
       if (float_samples[j][i] > 1) float_samples[j][i] = 1;
       if (float_samples[j][i] < -1) float_samples[j][i] = -1;
       }
-      reorderChannels(&(tmpbuffer[tmphead]),tmptail-tmphead);
       // Buffer full, go go go
       vorbis_analysis_wrote(&VD, nbSample) ;  
       tmphead+=nbSample*_wavheader->channels;	



From mean at mail.berlios.de  Tue Jul  3 19:52:37 2007
From: mean at mail.berlios.de (mean at BerliOS)
Date: Tue, 3 Jul 2007 19:52:37 +0200
Subject: [Avidemux-svn-commit] r3330 - in
	branches/avidemux_2.4_branch/avidemux: .
	ADM_userInterfaces/ADM_GTK/ADM_dialog
Message-ID: <200707031752.l63HqbT6032166@sheep.berlios.de>

Author: mean
Date: 2007-07-03 19:52:36 +0200 (Tue, 03 Jul 2007)
New Revision: 3330

Modified:
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_busy.cpp
   branches/avidemux_2.4_branch/avidemux/gtk_gui.cpp
   branches/avidemux_2.4_branch/avidemux/gtkgui.h
   branches/avidemux_2.4_branch/avidemux/gui_navigate.cpp
Log:
avoid race on cur_frame/nesting in gtk process event (bug 251)

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_busy.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_busy.cpp	2007-07-03 16:18:49 UTC (rev 3329)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_busy.cpp	2007-07-03 17:52:36 UTC (rev 3330)
@@ -59,7 +59,7 @@
 {
 
 	UI_BusyCursor();
-        UI_purge();
+        //UI_purge();
 
 	
 }

Modified: branches/avidemux_2.4_branch/avidemux/gtk_gui.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/gtk_gui.cpp	2007-07-03 16:18:49 UTC (rev 3329)
+++ branches/avidemux_2.4_branch/avidemux/gtk_gui.cpp	2007-07-03 17:52:36 UTC (rev 3330)
@@ -598,15 +598,7 @@
         break;                        
     
     case ACT_PreviousFrame:
-      if (curframe)
-	{
-	  DIA_StartBusy ();
-	  GUI_GoToFrame (curframe - 1);
-	  DIA_StopBusy ();
-	  
-
-	}
-
+        GUI_PrevFrame();
       break;
 
     case ACT_Forward50Frames:

Modified: branches/avidemux_2.4_branch/avidemux/gtkgui.h
===================================================================
--- branches/avidemux_2.4_branch/avidemux/gtkgui.h	2007-07-03 16:18:49 UTC (rev 3329)
+++ branches/avidemux_2.4_branch/avidemux/gtkgui.h	2007-07-03 17:52:36 UTC (rev 3330)
@@ -26,6 +26,7 @@
 
 
 void GUI_NextFrame( void );
+void GUI_PrevFrame( void );
 void GUI_NextKeyFrame( void ) ;
 void GUI_NextPrevBlackFrame( int ) ;
 void GUI_PreviousKeyFrame( void );

Modified: branches/avidemux_2.4_branch/avidemux/gui_navigate.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/gui_navigate.cpp	2007-07-03 16:18:49 UTC (rev 3329)
+++ branches/avidemux_2.4_branch/avidemux/gui_navigate.cpp	2007-07-03 17:52:36 UTC (rev 3330)
@@ -43,7 +43,7 @@
 #include "DIA_working.h"
 #include "ADM_video/ADM_genvideo.hxx"
 #include "ADM_filter/video_filters.h"
-    
+#include "DIA_busy.h"
 extern void    UI_purge(void );
 //____________________________________
 
@@ -439,3 +439,19 @@
 
         return video_body->rebuildFrameType();
 }
+/**
+    \fn GUI_PrevFrame
+    \brief Go to current frame -1
+*/
+void        GUI_PrevFrame(void )
+{
+      if (curframe)
+        {
+          
+          DIA_StartBusy ();
+          GUI_GoToFrame (curframe - 1);
+          DIA_StopBusy ();
+        }
+}
+//EOF
+        



From mean at mail.berlios.de  Wed Jul  4 20:20:01 2007
From: mean at mail.berlios.de (mean at BerliOS)
Date: Wed, 4 Jul 2007 20:20:01 +0200
Subject: [Avidemux-svn-commit] r3331 - branches/avidemux_2.4_branch
Message-ID: <200707041820.l64IK1RD026763@sheep.berlios.de>

Author: mean
Date: 2007-07-04 20:19:53 +0200 (Wed, 04 Jul 2007)
New Revision: 3331

Modified:
   branches/avidemux_2.4_branch/ConfigureChecks.cmake
Log:
typo (Mihail)

Modified: branches/avidemux_2.4_branch/ConfigureChecks.cmake
===================================================================
--- branches/avidemux_2.4_branch/ConfigureChecks.cmake	2007-07-03 17:52:36 UTC (rev 3330)
+++ branches/avidemux_2.4_branch/ConfigureChecks.cmake	2007-07-04 18:19:53 UTC (rev 3331)
@@ -402,10 +402,10 @@
 endif(NOT CMAKE_BUILD_TYPE)
 
 if(CMAKE_BUILD_TYPE STREQUAL "Debug")
-MESSAGE(STATUS "** DEBUG BUILD (${CMAKE_BUILD_TYPR})**")
+MESSAGE(STATUS "** DEBUG BUILD (${CMAKE_BUILD_TYPE})**")
 add_definitions(-DADM_DEBUG)
 else (CMAKE_BUILD_TYPE STREQUAL "Debug")
-MESSAGE(STATUS "** RELEASE BUILD (${CMAKE_BUILD_TYPR})**")
+MESSAGE(STATUS "** RELEASE BUILD (${CMAKE_BUILD_TYPE})**")
 endif(CMAKE_BUILD_TYPE STREQUAL "Debug")
 
 MESSAGE("LINK_FLAGS ${CMAKE_LD_FLAGS}")



From gruntster at mail.berlios.de  Thu Jul  5 02:03:14 2007
From: gruntster at mail.berlios.de (gruntster at mail.berlios.de)
Date: Thu, 5 Jul 2007 02:03:14 +0200
Subject: [Avidemux-svn-commit] r3332 - in
	branches/avidemux_2.4_branch/avidemux: . ADM_audiodevice
	ADM_userInterfaces/ADM_commonUI
Message-ID: <200707050003.l6503EEo004504@sheep.berlios.de>

Author: gruntster
Date: 2007-07-05 02:03:05 +0200 (Thu, 05 Jul 2007)
New Revision: 3332

Modified:
   branches/avidemux_2.4_branch/avidemux/ADM_audiodevice/ADM_deviceSDL.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/GUI_render.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/GUI_sdlRender.cpp
   branches/avidemux_2.4_branch/avidemux/main.cpp
Log:
extra SDL logging

Modified: branches/avidemux_2.4_branch/avidemux/ADM_audiodevice/ADM_deviceSDL.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_audiodevice/ADM_deviceSDL.cpp	2007-07-04 18:19:53 UTC (rev 3331)
+++ branches/avidemux_2.4_branch/avidemux/ADM_audiodevice/ADM_deviceSDL.cpp	2007-07-05 00:03:05 UTC (rev 3332)
@@ -146,16 +146,18 @@
 SDL_AudioSpec spec,result;
 _channels = channels;
 		
-		printf("Opening SDL Audio, fq=%d\n",fq);
+		printf("[SDL] Opening audio, fq=%d\n",fq);
+
 		if(_inUse) 
 		{
-			printf("Already running ?\n");
+			printf("[SDL] Already running ?\n");
 			return 1; // ???
 		}
 		
-		if (  SDL_InitSubSystem(SDL_INIT_AUDIO) < 0 ) 
+		if (SDL_InitSubSystem(SDL_INIT_AUDIO) < 0) 
 		{
-			printf("SDLAUDIOINIT failed\n");
+			printf("[SDL] FAILED initialising Audio subsystem\n");
+			printf("[SDL] ERROR: %s\n", SDL_GetError());
 			return 0;
 		}
 		memset(&spec,0,sizeof(spec));
@@ -170,7 +172,9 @@
 		int res=SDL_OpenAudio(&spec,&result);
 		if(res<0)
 		{
-			printf("Cannot init SDL audio %s\n", SDL_GetError());
+			printf("[SDL] Audio device FAILED to open\n");
+			printf("[SDL] ERROR: %s\n", SDL_GetError());
+
 			printf("fq   %d \n",spec.freq);
 			printf("chan %d \n", spec.channels);
 			printf("samples %d \n",spec.samples);
@@ -180,6 +184,7 @@
 			printf("chan %d \n", result.channels);
 			printf("samples %d \n",result.samples);
 			printf("format %d \n",result.format);
+
 			return 0;
 		}
 		

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/GUI_render.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/GUI_render.cpp	2007-07-04 18:19:53 UTC (rev 3331)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/GUI_render.cpp	2007-07-05 00:03:05 UTC (rev 3332)
@@ -236,26 +236,26 @@
 		}
                 break;
 #endif
+
 #if defined(USE_SDL)
-              case RENDER_SDL:
-		printf("Trying SDL\n");
-		accel_mode=new sdlAccelRender();
-		if(accel_mode->hasHwZoom()) r=accel_mode->init(&xinfo,phyW,phyH);
+			case RENDER_SDL:
+				accel_mode=new sdlAccelRender();
+
+				if(accel_mode->hasHwZoom()) r=accel_mode->init(&xinfo,phyW,phyH);
                 else r=accel_mode->init(&xinfo,renderW,renderH);
+
                 if(!r)
-		{
-			delete accel_mode;
-			accel_mode=NULL;
-			printf("sdl init failed\n");
-		}
-		else
-		{
-			printf("SDL init ok\n");
-		}
+				{
+					delete accel_mode;
+					accel_mode=NULL;
+				}
+
                 break;
 #endif
-                default:break;
+
+            default:break;
         }
+
         if(!accel_mode)
         {
                 rgbConverter.reset(renderW,renderH);

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/GUI_sdlRender.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/GUI_sdlRender.cpp	2007-07-04 18:19:53 UTC (rev 3331)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/GUI_sdlRender.cpp	2007-07-05 00:03:05 UTC (rev 3332)
@@ -81,94 +81,117 @@
         sdl_running=0;
         sdl_overlay=NULL;
         sdl_display=NULL;
-        printf("SDL killed\n");
+        printf("[SDL] System closed and destroyed\n");
         
         
 }
 uint8_t sdlAccelRender::init( GUI_WindowInfo * window, uint32_t w, uint32_t h)
-{
-int bpp;
-int flags;
+{
+	printf("[SDL] Initialising video subsystem\n");
 
-        // Ask for the position of the drawing window at start
-        //_______________________________________________________
-        
-        disp.w=w;
-        disp.h=h;
-        disp.x=0;
-        disp.y=0;
+	int bpp;
+	int flags;
 
-        if(!useYV12)
-        {
-            color=new ColBase(720,480);
-            decoded=new uint8_t[w*h*2];
-    }
-        /* Hack to get SDL to use GTK window, ugly but works */
+    // Ask for the position of the drawing window at start
+    disp.w=w;
+    disp.h=h;
+    disp.x=0;
+    disp.y=0;
+
+    if(!useYV12)
+    {
+		color=new ColBase(720,480);
+		decoded=new uint8_t[w*h*2];
+    }
+
+    // Hack to get SDL to use GTK window, ugly but works
 #if !defined(CONFIG_DARWIN) && !defined(ADM_WIN32)
-        { char SDL_windowhack[32];
-          int winid=(int)window->window;
-                sprintf(SDL_windowhack,"SDL_WINDOWID=%ld",winid);
-                putenv(SDL_windowhack);
-        }
-#endif
-        if (  SDL_InitSubSystem(SDL_INIT_VIDEO) < 0 ) 
-        {
-                fprintf(stderr, "Unable to init SDL: %s\n", SDL_GetError());
-                return 0;
-          }
-        sdl_running=1;
-        flags = SDL_ANYFORMAT | SDL_HWPALETTE | SDL_HWSURFACE | SDL_NOFRAME;
-        bpp= SDL_VideoModeOK( w, h,  16, flags );
-        sdl_display= SDL_SetVideoMode( w, h,  bpp, flags );	
-        if(!sdl_display)
-        {
-                end();
-                printf("Cannot create get surface\n");
-                return 0;
-        
-        }
-        SDL_LockSurface(sdl_display);
+	char SDL_windowhack[32];
+    int winid=(int)window->window;
+
+    sprintf(SDL_windowhack,"[SDL] SDL_WINDOWID=%ld",winid);
+    putenv(SDL_windowhack);
+#endif
+
+    if (SDL_InitSubSystem(SDL_INIT_VIDEO) < 0) 
+    {
+		printf("[SDL] FAILED initialising video subsystem\n");
+		printf("[SDL] ERROR: %s\n", SDL_GetError());
+
+        return 0;
+    }
+
+    sdl_running=1;
+    flags = SDL_ANYFORMAT | SDL_HWPALETTE | SDL_HWSURFACE | SDL_NOFRAME;
+    bpp= SDL_VideoModeOK( w, h,  16, flags );
+    sdl_display= SDL_SetVideoMode( w, h,  bpp, flags );
+
+    if (!sdl_display)
+    {
+        end();
+        printf("[SDL] Cannot create surface\n");
+		printf("[SDL] ERROR: %s\n", SDL_GetError());
+        return 0;
+    }
+
+    SDL_LockSurface(sdl_display);
+
 #ifdef ADM_WIN32
 	struct SDL_SysWMinfo wmInfo;
-	SDL_VERSION(&wmInfo.version);
-       if(-1 != SDL_GetWMInfo(&wmInfo))
-       {
-          sdlWin32 = wmInfo.window;
-          SetParent(sdlWin32,(HWND) window->display);
-	  MoveWindow(sdlWin32,0,0,w,h,0);
-       }
-       else
-       {
-		printf("[SDL] reparenting failed\n");
-       }
-#endif
+	SDL_VERSION(&wmInfo.version);
+
+	if (-1 != SDL_GetWMInfo(&wmInfo))
+	{
+		sdlWin32 = wmInfo.window;
+		SetParent(sdlWin32,(HWND) window->display);
+		MoveWindow(sdlWin32,0,0,w,h,0);
+	}
+	else
+	{
+		printf("[SDL] Reparenting failed\n");
+	}
+#endif
+
         int cspace;
         
         if(useYV12) cspace=SDL_YV12_OVERLAY;
             else    cspace=SDL_YUY2_OVERLAY;
         //_______________________________________________________
-        sdl_overlay=SDL_CreateYUVOverlay((w),(h),
-        cspace,		
-                sdl_display);
+        sdl_overlay=SDL_CreateYUVOverlay((w),(h), cspace, sdl_display);
+
+		// DirectX may fail but overlay still created.
+		// Not a showstopper but log failure.
+		if (strlen(SDL_GetError()))
+		{
+			printf("[SDL] ERROR: %s\n", SDL_GetError());
+		}
+
         if(!sdl_overlay)
         {
-                end();
-                printf("Cannot create SDL overlay\n");
-                return 0;
+			end();
+			printf("[SDL] Cannot create SDL overlay\n");
+			printf("[SDL] ERROR: %s\n", SDL_GetError());
+
+			return 0;
         }
         
-        int pitch=sdl_overlay->pitches[0];
-        printf("SDL_init ok, type is : %d,planes :%d pitch:%d\n",sdl_overlay->hw_overlay,sdl_overlay->planes,pitch);
+        printf("[SDL] Overlay created; type: %d, planes: %d, pitch: %d\n", sdl_overlay->hw_overlay, sdl_overlay->planes, sdl_overlay->pitches[0]);
+
         if(!sdl_overlay->hw_overlay)
         {
-                printf("** HW Acceleration disabled **\n");
+            printf("[SDL] Hardware acceleration disabled\n");
         #ifdef CONFIG_DARWIN
-                printf("** Darwin**\n");
+            printf("[SDL] ** Darwin**\n");
         #endif
-        }
-        if(!useYV12) color->reset(w,h);
+        }
+
+        if(!useYV12) color->reset(w,h);
+
+		printf("[SDL] Video subsystem initalised successfully\n");
+
         return 1;
-}
+}
+
 static void interleave(uint8_t *dst,uint8_t *src,int width, int stride, int lines)
 {
     for(int y=0;y<lines;y++)
@@ -226,7 +249,6 @@
         SDL_UnlockYUVOverlay(sdl_overlay);
         SDL_DisplayYUVOverlay(sdl_overlay,&disp);
         
-        //printf("*\n");
         return 1;
 }
 

Modified: branches/avidemux_2.4_branch/avidemux/main.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/main.cpp	2007-07-04 18:19:53 UTC (rev 3331)
+++ branches/avidemux_2.4_branch/avidemux/main.cpp	2007-07-05 00:03:05 UTC (rev 3332)
@@ -131,15 +131,28 @@
     printf(" MacOsX    : Kuisathaverat\n");
     printf(" Win32     : Gruntster\n\n");
 
+	printf("Compiled for ");
+
+#if defined(ADM_WIN32)
+	printf("Microsoft Windows");
+#elif defined(__APPLE__)
+	printf("Apple");
+#else
+	printf("Linux");
+#endif
+
 #if defined(ARCH_X86_32)
-	printf("Compiled for X86_32 Arch.\n");
+	printf(" (x86)");
+#elif defined(ARCH_X86_64)
+	printf(" (x86-64)");
+#elif defined(ARCH_POWERPC)
+	printf(" (PowerPC));
 #endif
-#if defined(ARCH_X86_64)
-	printf("Compiled for X86_64 Arch.\n");
-#endif
 
+printf("\n");
+
 #if defined(__USE_LARGEFILE) && defined(__USE_LARGEFILE64)
-	printf("\nLARGE FILE AVAILABLE: %d offset\n", __USE_FILE_OFFSET64);
+	printf("\nLarge file available: %d offset\n", __USE_FILE_OFFSET64);
 #endif
 
 #ifdef HAVE_GETTEXT
@@ -177,21 +190,39 @@
 	ADM_memStatInit();
 	ADM_intFloatInit();
 
-	printf("Initializing prefs\n");
+	printf("Initialising prefs\n");
 	initPrefs();
 
 	register_Encoders();
 	atexit(onexit);
-  
+
 #ifdef USE_SDL
     sdl_version=(SDL_Linked_Version()->major*1000)+(SDL_Linked_Version()->minor*100) + (SDL_Linked_Version()->patch);
-    printf("SDL support on Version %d\n",sdl_version);
+    printf("\n[SDL] Version: %u.%u.%u\n",SDL_Linked_Version()->major, SDL_Linked_Version()->minor, SDL_Linked_Version()->patch);
 
-	if(sdl_version>1209)
+	if(sdl_version > 1209)
 	{
-		printf("Global SDL init...\n");
-		SDL_Init(SDL_INIT_EVERYTHING); //SDL_INIT_AUDIO+SDL_INIT_VIDEO);
+		printf("[SDL] Initialisation ");
+
+		if (SDL_Init(SDL_INIT_EVERYTHING) == 0)
+		{
+			printf("succeeded\n");
+
+			char driverName[100];
+
+			if (SDL_VideoDriverName(driverName, 100) != NULL)
+			{
+				printf("[SDL] Video Driver: %s\n", driverName);
+			}
+		}
+		else
+		{
+			printf("FAILED\n");
+			printf("[SDL] ERROR: %s\n", SDL_GetError());
+		}
 	}
+
+	printf("\n");
 #endif
 
 #ifdef ADM_WIN32
@@ -257,7 +288,7 @@
 #ifdef USE_SDL
 	if(sdl_version<=1209)
 	{
-		printf("Global SDL init...\n");
+		printf("[SDL] Initalising...\n");
 		SDL_Init(0); //SDL_INIT_AUDIO+SDL_INIT_VIDEO);
 	}
 #endif



From gruntster at mail.berlios.de  Thu Jul  5 19:03:52 2007
From: gruntster at mail.berlios.de (gruntster at mail.berlios.de)
Date: Thu, 5 Jul 2007 19:03:52 +0200
Subject: [Avidemux-svn-commit] r3333 - in
	branches/avidemux_2.4_branch/avidemux: .
	ADM_userInterfaces/ADM_commonUI
Message-ID: <200707051703.l65H3q5v005261@sheep.berlios.de>

Author: gruntster
Date: 2007-07-05 19:03:26 +0200 (Thu, 05 Jul 2007)
New Revision: 3333

Modified:
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/GUI_render.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/GUI_render.h
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/GUI_sdlRender.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/GUI_sdlRender.h
   branches/avidemux_2.4_branch/avidemux/main.cpp
Log:
DirectX support for Win32 (using SDL)

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp	2007-07-05 00:03:05 UTC (rev 3332)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp	2007-07-05 17:03:26 UTC (rev 3333)
@@ -19,8 +19,6 @@
 #include <string.h>
 #include <stdio.h>
 
-
-
 # include <config.h>
 
 #include "default.h"
@@ -34,6 +32,9 @@
 #include "ADM_toolkit/toolkit.hxx"
 #include "ADM_commonUI/DIA_factory.h"
 
+#ifdef ADM_WIN32
+#include "ADM_userInterfaces/ADM_commonUI/GUI_sdlRender.h"
+#endif
 
 extern void 		AVDM_audioPref( void );
 
@@ -195,8 +196,13 @@
                              ,{RENDER_XV,   _("XVideo (best)"),NULL}
 #endif
 #ifdef USE_SDL
-                             ,{RENDER_SDL,      _("SDL (good)"),NULL}
+#ifdef ADM_WIN32
+                             ,{RENDER_SDL,      _("SDL (GDI)"),NULL}
+							 ,{RENDER_DIRECTX,      _("SDL (DirectX)"),NULL}
+#else
+							 ,{RENDER_SDL,      _("SDL (good)"),NULL}
 #endif
+#endif
         };        
         diaElemMenu menuVideoMode(&render,_("Video _display:"), sizeof(videoMode)/sizeof(diaMenuEntry),videoMode,"");
         
@@ -394,6 +400,11 @@
                   prefs->set(FILTERS_AUTOLOAD_PATH, filterPath);
                 // Alternate mp3 tag (haali)
                 prefs->set(FEATURE_ALTERNATE_MP3_TAG,alternate_mp3_tag);
+
+			#ifdef ADM_WIN32
+				// Initialise SDL again as driver may have changed
+				initSdl();
+			#endif
 	}
 	return 1;
 }

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/GUI_render.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/GUI_render.cpp	2007-07-05 00:03:05 UTC (rev 3332)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/GUI_render.cpp	2007-07-05 17:03:26 UTC (rev 3333)
@@ -239,6 +239,9 @@
 
 #if defined(USE_SDL)
 			case RENDER_SDL:
+#ifdef ADM_WIN32
+			case RENDER_DIRECTX:
+#endif
 				accel_mode=new sdlAccelRender();
 
 				if(accel_mode->hasHwZoom()) r=accel_mode->init(&xinfo,phyW,phyH);

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/GUI_render.h
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/GUI_render.h	2007-07-05 00:03:05 UTC (rev 3332)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/GUI_render.h	2007-07-05 17:03:26 UTC (rev 3333)
@@ -95,7 +95,11 @@
 #endif
 #ifdef USE_SDL
         RENDER_SDL=2,
+
+#ifdef ADM_WIN32
+		RENDER_DIRECTX=3,
 #endif
+#endif
         RENDER_LAST       
 
 

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/GUI_sdlRender.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/GUI_sdlRender.cpp	2007-07-05 00:03:05 UTC (rev 3332)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/GUI_sdlRender.cpp	2007-07-05 17:03:26 UTC (rev 3333)
@@ -1,162 +1,163 @@
-/***************************************************************************
-    copyright            : (C) 2006 by mean
-    email                : fixounet at free.fr
-***************************************************************************/
-
-/***************************************************************************
-*                                                                         *
-*   This program is free software; you can redistribute it and/or modify  *
-*   it under the terms of the GNU General Public License as published by  *
-*   the Free Software Foundation; either version 2 of the License, or     *
-*   (at your option) any later version.                                   *
-*                                                                         *
-***************************************************************************///
-//  The pitch stride has to be changed as there could be some padding depending on the OS
-//
-//
-#include "config.h"
-#if defined(USE_SDL)
-
-#include <stdio.h>
-#include <stdlib.h>
-#include <math.h>
-#include <string.h>
-#include <time.h>
-#include <sys/time.h>
-
-
-
-extern "C" {
-#include "SDL/SDL.h"
-#include "SDL/SDL_syswm.h"
-
-
-}
-
-#include "default.h"
-
-#include "ADM_colorspace/colorspace.h"
-#include "ADM_colorspace/ADM_rgb.h"
-#include "ADM_commonUI//GUI_render.h"
-
-#include "GUI_accelRender.h"
-#include "GUI_sdlRender.h"
-#include "ADM_assert.h"
-
-//******************************************
-static uint8_t sdl_running=0;
-static SDL_Overlay *sdl_overlay=NULL;
-static SDL_Surface *sdl_display=NULL;
-static SDL_Rect disp;
-#ifdef ADM_WIN32
-HWND sdlWin32;
-#endif
-static ColBase *color=NULL;
-
-sdlAccelRender::sdlAccelRender( void)
-{
-        useYV12=1;
-        decoded=NULL;
-}
-uint8_t sdlAccelRender::end( void)
-{
-        if(sdl_overlay)
-        {
-                SDL_FreeYUVOverlay(sdl_overlay);
-        }
-        if(sdl_display)
-        {
-        SDL_UnlockSurface(sdl_display);
-                SDL_FreeSurface(sdl_display);
-        }
-        if(sdl_running)
-        {
-                SDL_QuitSubSystem(SDL_INIT_VIDEO);
-        }
-        if(decoded)
-        {
-        delete [] decoded;
-        decoded=NULL;	
-        }
-        sdl_running=0;
-        sdl_overlay=NULL;
-        sdl_display=NULL;
-        printf("[SDL] System closed and destroyed\n");
-        
-        
-}
-uint8_t sdlAccelRender::init( GUI_WindowInfo * window, uint32_t w, uint32_t h)
+/***************************************************************************
+    copyright            : (C) 2006 by mean
+    email                : fixounet at free.fr
+***************************************************************************/
+
+/***************************************************************************
+*                                                                         *
+*   This program is free software; you can redistribute it and/or modify  *
+*   it under the terms of the GNU General Public License as published by  *
+*   the Free Software Foundation; either version 2 of the License, or     *
+*   (at your option) any later version.                                   *
+*                                                                         *
+***************************************************************************///
+//  The pitch stride has to be changed as there could be some padding depending on the OS
+//
+//
+#include "config.h"
+#if defined(USE_SDL)
+
+#include <stdio.h>
+#include <stdlib.h>
+#include <math.h>
+#include <string.h>
+#include <time.h>
+#include <sys/time.h>
+
+extern "C" {
+#include "SDL/SDL.h"
+#include "SDL/SDL_syswm.h"
+}
+
+#include "default.h"
+
+#include "ADM_colorspace/colorspace.h"
+#include "ADM_colorspace/ADM_rgb.h"
+#include "ADM_commonUI/GUI_render.h"
+
+#include "GUI_accelRender.h"
+#include "GUI_sdlRender.h"
+#include "ADM_assert.h"
+
+#ifdef ADM_WIN32
+#include "prefs.h"
+#include "ADM_userInterfaces/ADM_commonUI/GUI_render.h"
+#endif
+
+//******************************************
+static uint8_t sdl_running=0;
+static SDL_Overlay *sdl_overlay=NULL;
+static SDL_Surface *sdl_display=NULL;
+static SDL_Rect disp;
+#ifdef ADM_WIN32
+HWND sdlWin32;
+#endif
+static ColBase *color=NULL;
+
+sdlAccelRender::sdlAccelRender( void)
 {
+        useYV12=1;
+        decoded=NULL;
+}
+uint8_t sdlAccelRender::end( void)
+{
+        if(sdl_overlay)
+        {
+                SDL_FreeYUVOverlay(sdl_overlay);
+        }
+        if(sdl_display)
+        {
+        SDL_UnlockSurface(sdl_display);
+                SDL_FreeSurface(sdl_display);
+        }
+        if(sdl_running)
+        {
+                SDL_QuitSubSystem(SDL_INIT_VIDEO);
+        }
+        if(decoded)
+        {
+        delete [] decoded;
+        decoded=NULL;	
+        }
+        sdl_running=0;
+        sdl_overlay=NULL;
+        sdl_display=NULL;
+        printf("[SDL] System closed and destroyed\n");
+        
+        
+}
+uint8_t sdlAccelRender::init( GUI_WindowInfo * window, uint32_t w, uint32_t h)
+{
 	printf("[SDL] Initialising video subsystem\n");
-
-	int bpp;
-	int flags;
-
-    // Ask for the position of the drawing window at start
-    disp.w=w;
-    disp.h=h;
-    disp.x=0;
-    disp.y=0;
-
-    if(!useYV12)
-    {
-		color=new ColBase(720,480);
-		decoded=new uint8_t[w*h*2];
+
+	int bpp;
+	int flags;
+
+    // Ask for the position of the drawing window at start
+    disp.w=w;
+    disp.h=h;
+    disp.x=0;
+    disp.y=0;
+
+    if(!useYV12)
+    {
+		color=new ColBase(720,480);
+		decoded=new uint8_t[w*h*2];
     }
-
-    // Hack to get SDL to use GTK window, ugly but works
-#if !defined(CONFIG_DARWIN) && !defined(ADM_WIN32)
-	char SDL_windowhack[32];
+
+    // Hack to get SDL to use GTK window, ugly but works
+#if !defined(CONFIG_DARWIN) && !defined(ADM_WIN32)
+	char SDL_windowhack[32];
     int winid=(int)window->window;
-
-    sprintf(SDL_windowhack,"[SDL] SDL_WINDOWID=%ld",winid);
-    putenv(SDL_windowhack);
+
+    sprintf(SDL_windowhack,"[SDL] SDL_WINDOWID=%ld",winid);
+    putenv(SDL_windowhack);
 #endif
-
-    if (SDL_InitSubSystem(SDL_INIT_VIDEO) < 0) 
+
+    if (SDL_InitSubSystem(SDL_INIT_VIDEO) < 0) 
     {
 		printf("[SDL] FAILED initialising video subsystem\n");
 		printf("[SDL] ERROR: %s\n", SDL_GetError());
-
-        return 0;
+
+        return 0;
     }
-
-    sdl_running=1;
-    flags = SDL_ANYFORMAT | SDL_HWPALETTE | SDL_HWSURFACE | SDL_NOFRAME;
-    bpp= SDL_VideoModeOK( w, h,  16, flags );
+
+    sdl_running=1;
+    flags = SDL_ANYFORMAT | SDL_HWPALETTE | SDL_HWSURFACE | SDL_NOFRAME;
+    bpp= SDL_VideoModeOK( w, h,  16, flags );
     sdl_display= SDL_SetVideoMode( w, h,  bpp, flags );
-
-    if (!sdl_display)
-    {
-        end();
+
+    if (!sdl_display)
+    {
+        end();
         printf("[SDL] Cannot create surface\n");
-		printf("[SDL] ERROR: %s\n", SDL_GetError());
-        return 0;
+		printf("[SDL] ERROR: %s\n", SDL_GetError());
+        return 0;
     }
-
+
     SDL_LockSurface(sdl_display);
-
-#ifdef ADM_WIN32
-	struct SDL_SysWMinfo wmInfo;
+
+#ifdef ADM_WIN32
+	struct SDL_SysWMinfo wmInfo;
 	SDL_VERSION(&wmInfo.version);
-
-	if (-1 != SDL_GetWMInfo(&wmInfo))
-	{
-		sdlWin32 = wmInfo.window;
-		SetParent(sdlWin32,(HWND) window->display);
-		MoveWindow(sdlWin32,0,0,w,h,0);
-	}
-	else
-	{
-		printf("[SDL] Reparenting failed\n");
-	}
+
+	if (-1 != SDL_GetWMInfo(&wmInfo))
+	{
+		sdlWin32 = wmInfo.window;
+		SetParent(sdlWin32,(HWND) window->display);
+		MoveWindow(sdlWin32,0,0,w,h,0);
+	}
+	else
+	{
+		printf("[SDL] Reparenting failed\n");
+	}
 #endif
-
-        int cspace;
-        
-        if(useYV12) cspace=SDL_YV12_OVERLAY;
-            else    cspace=SDL_YUY2_OVERLAY;
-        //_______________________________________________________
+
+        int cspace;
+        
+        if(useYV12) cspace=SDL_YV12_OVERLAY;
+            else    cspace=SDL_YUY2_OVERLAY;
+        //_______________________________________________________
         sdl_overlay=SDL_CreateYUVOverlay((w),(h), cspace, sdl_display);
 
 		// DirectX may fail but overlay still created.
@@ -165,91 +166,152 @@
 		{
 			printf("[SDL] ERROR: %s\n", SDL_GetError());
 		}
-
-        if(!sdl_overlay)
-        {
-			end();
+
+        if(!sdl_overlay)
+        {
+			end();
 			printf("[SDL] Cannot create SDL overlay\n");
 			printf("[SDL] ERROR: %s\n", SDL_GetError());
-
-			return 0;
-        }
-        
+
+			return 0;
+        }
+        
         printf("[SDL] Overlay created; type: %d, planes: %d, pitch: %d\n", sdl_overlay->hw_overlay, sdl_overlay->planes, sdl_overlay->pitches[0]);
-
-        if(!sdl_overlay->hw_overlay)
-        {
-            printf("[SDL] Hardware acceleration disabled\n");
-        #ifdef CONFIG_DARWIN
-            printf("[SDL] ** Darwin**\n");
-        #endif
+
+        if(!sdl_overlay->hw_overlay)
+        {
+            printf("[SDL] Hardware acceleration disabled\n");
+        #ifdef CONFIG_DARWIN
+            printf("[SDL] ** Darwin**\n");
+        #endif
         }
-
+
         if(!useYV12) color->reset(w,h);
 
 		printf("[SDL] Video subsystem initalised successfully\n");
-
-        return 1;
+
+        return 1;
 }
-
-static void interleave(uint8_t *dst,uint8_t *src,int width, int stride, int lines)
-{
-    for(int y=0;y<lines;y++)
-    {
-        memcpy(dst,src,width);
-        src+=width;
-        dst+=stride;          
-    }   
-}
-uint8_t sdlAccelRender::display(uint8_t *ptr, uint32_t w, uint32_t h,renderZoom zoom)
-{
-int pitch;
-int page=w*h;
-        ADM_assert(sdl_overlay);
-        SDL_LockYUVOverlay(sdl_overlay);	
-        pitch=sdl_overlay->pitches[0];
-//	printf("SDL: new pitch :%d\n",pitch);
-        if(useYV12)
-        {
-        if(pitch==w)
-            memcpy(sdl_overlay->pixels[0],ptr,w*h);
-        else
-            interleave(sdl_overlay->pixels[0],ptr,w,pitch,h);
-            
-        pitch=sdl_overlay->pitches[1];
-        if(pitch==(w>>1))
-            memcpy(sdl_overlay->pixels[1],ptr+page,(w*h)>>2);
-        else
-            interleave(sdl_overlay->pixels[1],ptr+page,w>>1,pitch,h>>1);
-      
-        pitch=sdl_overlay->pitches[2];
-        if(pitch==(w>>1))
-            memcpy(sdl_overlay->pixels[2],ptr+(page*5)/4,(w*h)>>2);
-        else
-            interleave(sdl_overlay->pixels[2],ptr+(page*5)/4,w>>1,pitch,h>>1);  	
-        }else
-        {
-        color->reset(w,h);
-        if(pitch==2*w)
-        {
-            color->scale(ptr,sdl_overlay->pixels[0]);
-        }
-        else
-        {
-            color->scale(ptr,decoded);
-            interleave(sdl_overlay->pixels[0],decoded,2*w,pitch,h);
-        }
-    }	
-        
-        disp.w=w;
-        disp.h=h;
-        disp.x=0;
-        disp.y=0;
-        
-        SDL_UnlockYUVOverlay(sdl_overlay);
-        SDL_DisplayYUVOverlay(sdl_overlay,&disp);
-        
-        return 1;
-}
-
-#endif
+
+static void interleave(uint8_t *dst,uint8_t *src,int width, int stride, int lines)
+{
+    for(int y=0;y<lines;y++)
+    {
+        memcpy(dst,src,width);
+        src+=width;
+        dst+=stride;          
+    }   
+}
+uint8_t sdlAccelRender::display(uint8_t *ptr, uint32_t w, uint32_t h,renderZoom zoom)
+{
+int pitch;
+int page=w*h;
+        ADM_assert(sdl_overlay);
+        SDL_LockYUVOverlay(sdl_overlay);	
+        pitch=sdl_overlay->pitches[0];
+//	printf("SDL: new pitch :%d\n",pitch);
+        if(useYV12)
+        {
+        if(pitch==w)
+            memcpy(sdl_overlay->pixels[0],ptr,w*h);
+        else
+            interleave(sdl_overlay->pixels[0],ptr,w,pitch,h);
+            
+        pitch=sdl_overlay->pitches[1];
+        if(pitch==(w>>1))
+            memcpy(sdl_overlay->pixels[1],ptr+page,(w*h)>>2);
+        else
+            interleave(sdl_overlay->pixels[1],ptr+page,w>>1,pitch,h>>1);
+      
+        pitch=sdl_overlay->pitches[2];
+        if(pitch==(w>>1))
+            memcpy(sdl_overlay->pixels[2],ptr+(page*5)/4,(w*h)>>2);
+        else
+            interleave(sdl_overlay->pixels[2],ptr+(page*5)/4,w>>1,pitch,h>>1);  	
+        }else
+        {
+        color->reset(w,h);
+        if(pitch==2*w)
+        {
+            color->scale(ptr,sdl_overlay->pixels[0]);
+        }
+        else
+        {
+            color->scale(ptr,decoded);
+            interleave(sdl_overlay->pixels[0],decoded,2*w,pitch,h);
+        }
+    }	
+        
+        disp.w=w;
+        disp.h=h;
+        disp.x=0;
+        disp.y=0;
+        
+        SDL_UnlockYUVOverlay(sdl_overlay);
+        SDL_DisplayYUVOverlay(sdl_overlay,&disp);
+        
+        return 1;
+}
+
+void initSdl(void)
+{
+	printf("\n");
+	quitSdl();
+
+    int sdl_version = (SDL_Linked_Version()->major*1000)+(SDL_Linked_Version()->minor*100) + (SDL_Linked_Version()->patch);
+
+    printf("[SDL] Version: %u.%u.%u\n",SDL_Linked_Version()->major, SDL_Linked_Version()->minor, SDL_Linked_Version()->patch);
+
+#ifdef ADM_WIN32
+	uint32_t videoDevice = RENDER_LAST;
+
+	if(!prefs->get(DEVICE_VIDEODEVICE, &videoDevice) || videoDevice != RENDER_DIRECTX)
+	{
+		printf("[SDL] Setting video driver to Microsoft Windows GDI\n");
+		putenv("SDL_VIDEODRIVER=windib");
+	}
+	else
+	{
+		printf("[SDL] Setting video driver to Microsoft DirectX\n");
+		putenv("SDL_VIDEODRIVER=directx");
+	}
+#endif
+
+	uint32_t sdlInitFlags;
+
+	if (sdl_version > 1209)
+		sdlInitFlags = SDL_INIT_EVERYTHING;
+	else
+		sdlInitFlags = 0;
+
+	printf("[SDL] Initialisation ");
+
+	if (SDL_Init(sdlInitFlags) == 0)
+	{
+		printf("succeeded\n");
+
+		char driverName[100];
+
+		if (SDL_VideoDriverName(driverName, 100) != NULL)
+		{
+			printf("[SDL] Video Driver: %s\n", driverName);
+		}
+	}
+	else
+	{
+		printf("FAILED\n");
+		printf("[SDL] ERROR: %s\n", SDL_GetError());
+	}
+
+	printf("\n");
+}
+
+void quitSdl(void)
+{
+	if (SDL_WasInit(SDL_INIT_EVERYTHING))
+	{
+		printf("[SDL] Quitting...\n");
+		SDL_Quit();
+	}
+}
+#endif

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/GUI_sdlRender.h
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/GUI_sdlRender.h	2007-07-05 00:03:05 UTC (rev 3332)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/GUI_sdlRender.h	2007-07-05 17:03:26 UTC (rev 3333)
@@ -12,8 +12,12 @@
  *   (at your option) any later version.                                   *
  *                                                                         *
  ***************************************************************************/
+#include "GUI_render.h"
+#include "GUI_accelRender.h"
+
 #ifndef TSDLRENDER_H
 #define TSDLRENDER_H
+
 class sdlAccelRender: public AccelRender
 {
   protected:
@@ -26,4 +30,6 @@
               virtual   uint8_t display(uint8_t *ptr, uint32_t w, uint32_t h,renderZoom zoom);
 };
 
+void initSdl(void);
+void quitSdl(void);
 #endif

Modified: branches/avidemux_2.4_branch/avidemux/main.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/main.cpp	2007-07-05 00:03:05 UTC (rev 3332)
+++ branches/avidemux_2.4_branch/avidemux/main.cpp	2007-07-05 17:03:26 UTC (rev 3333)
@@ -61,12 +61,16 @@
 #endif                       
 
 #ifdef USE_SDL
-	extern "C" {
+extern "C" {
 	#include "SDL/SDL.h"
-	}
+}
+
+#include "ADM_userInterfaces/ADM_commonUI/GUI_sdlRender.h"
 #endif
+
 #include "ADM_osSupport/ADM_cpuCap.h"
 #include "ADM_osSupport/ADM_threads.h"
+
 void onexit( void );
 //extern void automation(int argc, char **argv);
 
@@ -106,8 +110,6 @@
 
 int main(int argc, char *argv[])
 {
-	int sdl_version=0;
-
 #ifndef ADM_WIN32
 	// thx smurf uk :)
     installSigHandler();
@@ -146,7 +148,7 @@
 #elif defined(ARCH_X86_64)
 	printf(" (x86-64)");
 #elif defined(ARCH_POWERPC)
-	printf(" (PowerPC));
+	printf(" (PowerPC)");
 #endif
 
 printf("\n");
@@ -192,39 +194,16 @@
 
 	printf("Initialising prefs\n");
 	initPrefs();
+	prefs->load();
 
 	register_Encoders();
-	atexit(onexit);
 
 #ifdef USE_SDL
-    sdl_version=(SDL_Linked_Version()->major*1000)+(SDL_Linked_Version()->minor*100) + (SDL_Linked_Version()->patch);
-    printf("\n[SDL] Version: %u.%u.%u\n",SDL_Linked_Version()->major, SDL_Linked_Version()->minor, SDL_Linked_Version()->patch);
-
-	if(sdl_version > 1209)
-	{
-		printf("[SDL] Initialisation ");
-
-		if (SDL_Init(SDL_INIT_EVERYTHING) == 0)
-		{
-			printf("succeeded\n");
-
-			char driverName[100];
-
-			if (SDL_VideoDriverName(driverName, 100) != NULL)
-			{
-				printf("[SDL] Video Driver: %s\n", driverName);
-			}
-		}
-		else
-		{
-			printf("FAILED\n");
-			printf("[SDL] ERROR: %s\n", SDL_GetError());
-		}
-	}
-
-	printf("\n");
+	initSdl();
 #endif
 
+	atexit(onexit);
+
 #ifdef ADM_WIN32
     win32_netInit();
 #endif
@@ -242,7 +221,6 @@
 
 	// Load .avidemuxrc
     quotaInit();
-    prefs->load();
 
 	if(!initGUI())
 	{
@@ -284,15 +262,7 @@
 
     COL_init();
 	initLibWrappers();
-
-#ifdef USE_SDL
-	if(sdl_version<=1209)
-	{
-		printf("[SDL] Initalising...\n");
-		SDL_Init(0); //SDL_INIT_AUDIO+SDL_INIT_VIDEO);
-	}
-#endif
-
+	
     if(SpidermonkeyInit() == true)
         printf("Spidermonkey initialized.\n");
     else
@@ -321,6 +291,11 @@
     destroyPrefs();
     filterCleanUp();
 	destroyLibWrappers();
+
+#ifdef USE_SDL
+	quitSdl();
+#endif
+
     printf("End of cleanup\n");
     ADMImage_stat();
     ADM_memStat();



From mean at mail.berlios.de  Thu Jul  5 19:37:24 2007
From: mean at mail.berlios.de (mean at BerliOS)
Date: Thu, 5 Jul 2007 19:37:24 +0200
Subject: [Avidemux-svn-commit] r3334 -
	branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_toolkit_gtk
Message-ID: <200707051737.l65HbOnL014121@sheep.berlios.de>

Author: mean
Date: 2007-07-05 19:37:24 +0200 (Thu, 05 Jul 2007)
New Revision: 3334

Added:
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_toolkit_gtk/jogshuttle.c
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_toolkit_gtk/jogshuttle.h
Log:
initial jogshuttle

Added: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_toolkit_gtk/jogshuttle.c
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_toolkit_gtk/jogshuttle.c	2007-07-05 17:03:26 UTC (rev 3333)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_toolkit_gtk/jogshuttle.c	2007-07-05 17:37:24 UTC (rev 3334)
@@ -0,0 +1,351 @@
+#include <gtk/gtk.h>
+#include "jogshuttle.h"
+
+#define JOG_SHUTTLE_GET_PRIVATE(obj) (G_TYPE_INSTANCE_GET_PRIVATE ((obj), JOG_TYPE_SHUTTLE, JogShuttlePrivate))
+
+G_DEFINE_TYPE (JogShuttle, jog_shuttle, GTK_TYPE_DRAWING_AREA);
+
+static gboolean jog_shuttle_expose (GtkWidget *wheel, GdkEventExpose *event);
+static gboolean jog_shuttle_button_press (GtkWidget *wheel, GdkEventButton *event);
+static gboolean jog_shuttle_button_release (GtkWidget *wheel, GdkEventButton *event);
+static gboolean jog_shuttle_motion_notify (GtkWidget *wheel, GdkEventMotion *event);
+
+typedef struct _JogShuttlePrivate JogShuttlePrivate;
+
+struct _JogShuttlePrivate
+{
+	gfloat pos[6];
+	gboolean pressed;
+	gfloat start;
+	gfloat offset;
+	gfloat value;
+};
+
+enum
+{
+	VALUE_CHANGED,
+	LAST_SIGNAL
+};
+
+static guint jog_shuttle_signals[LAST_SIGNAL] = { 0 };
+
+static void
+jog_shuttle_class_init (JogShuttleClass *class)
+{
+	GObjectClass *obj_class;
+	GtkWidgetClass *widget_class;
+
+ 	obj_class = G_OBJECT_CLASS (class);
+	widget_class = GTK_WIDGET_CLASS (class);
+
+	widget_class->button_press_event = jog_shuttle_button_press;
+	widget_class->button_release_event = jog_shuttle_button_release;
+	widget_class->motion_notify_event = jog_shuttle_motion_notify;
+	widget_class->expose_event = jog_shuttle_expose;
+	
+	jog_shuttle_signals[VALUE_CHANGED] = g_signal_new (
+		"value-changed",
+		G_OBJECT_CLASS_TYPE (obj_class),
+		G_SIGNAL_RUN_FIRST,
+		G_STRUCT_OFFSET (JogShuttleClass, value_changed),
+		NULL, NULL,
+		gtk_marshal_NONE__NONE,
+		G_TYPE_NONE, 0);
+
+	g_type_class_add_private (obj_class, sizeof (JogShuttlePrivate));
+}
+
+static void
+jog_shuttle_init (JogShuttle *wheel)
+{
+	JogShuttlePrivate *priv;
+	priv = JOG_SHUTTLE_GET_PRIVATE (wheel);
+	
+	priv->pressed = FALSE;
+	priv->offset = 0;
+	priv->value = 0;
+	gtk_widget_add_events (GTK_WIDGET (wheel), GDK_BUTTON_PRESS_MASK | GDK_BUTTON_RELEASE_MASK | GDK_POINTER_MOTION_MASK);
+}
+
+static void reset(GtkWidget *wheel)
+{
+	JogShuttlePrivate *priv;
+	priv = JOG_SHUTTLE_GET_PRIVATE (wheel);
+	gfloat width = wheel->allocation.width;
+	
+	int i;
+	for (i=0; i<6; i++)
+	{
+		priv->pos[i] = width / 6 * i;
+	}
+}
+
+static gboolean
+jog_shuttle_button_press (GtkWidget *wheel, GdkEventButton *event)
+{
+	JogShuttlePrivate *priv;
+	priv = JOG_SHUTTLE_GET_PRIVATE (wheel);
+	
+	priv->start = event->x;
+	priv->pressed = TRUE;
+	return FALSE;
+}
+
+static gboolean
+jog_shuttle_button_release (GtkWidget *wheel, GdkEventButton *event)
+{
+	JogShuttlePrivate *priv;
+	priv = JOG_SHUTTLE_GET_PRIVATE (wheel);
+	
+	priv->pressed = FALSE;
+	priv->offset = 0;
+	GtkWidget *widget;
+	GdkRegion *region;
+	
+	widget = GTK_WIDGET (wheel);
+	
+	if (!widget->window) return;
+
+	region = gdk_drawable_get_clip_region (widget->window);
+	gdk_window_invalidate_region (widget->window, region, TRUE);
+	gdk_window_process_updates (widget->window, TRUE);
+
+	gdk_region_destroy (region);
+
+	return FALSE;
+}
+
+static emit_value_changed_signal (JogShuttle *wheel)
+{
+	g_signal_emit (wheel, jog_shuttle_signals[VALUE_CHANGED], 0);
+}
+
+static gboolean
+jog_shuttle_motion_notify (GtkWidget *wheel, GdkEventMotion *event)
+{
+	JogShuttlePrivate *priv;
+	priv = JOG_SHUTTLE_GET_PRIVATE (wheel);
+	
+	gfloat width = wheel->allocation.width;
+	gfloat height = wheel->allocation.height;
+	
+	if (!priv->pressed) return TRUE;
+	GtkWidget *widget;
+	GdkRegion *region;
+	
+	widget = GTK_WIDGET (wheel);
+	
+	priv->offset = event->x - priv->start;
+	priv->start = event->x;
+
+	if (!widget->window) return;
+	
+	if ((priv->offset+priv->pos[3]) > width || (priv->offset+priv->pos[3]) < 0) return;
+	
+	region = gdk_drawable_get_clip_region (widget->window);
+	gdk_window_invalidate_region (widget->window, region, TRUE);
+	gdk_window_process_updates (widget->window, TRUE);
+
+	gdk_region_destroy (region);
+}
+
+static void
+draw_borders (GtkWidget *wheel, cairo_t *cr)
+{
+	gfloat width = wheel->allocation.width;
+	gfloat height = wheel->allocation.height;
+	gfloat middle = width/2.0;
+	
+	cairo_set_line_width (cr, 1);
+	cairo_set_source_rgb (cr, 0.53, 0.53, 0.53);
+	cairo_line_to (cr, 1, 0);
+	cairo_line_to (cr, width-1, 0);
+	cairo_stroke (cr);
+	cairo_line_to (cr, 1, height-1);
+	cairo_line_to (cr, width-1, height-1);
+	cairo_stroke (cr);
+	cairo_line_to (cr, 1, 1);
+	cairo_line_to (cr, 1, height-1);
+	cairo_stroke (cr);
+	cairo_line_to (cr, width, 1);
+	cairo_line_to (cr, width, height-1);
+	cairo_stroke (cr);
+	
+	cairo_pattern_t *cp1 = cairo_pattern_create_linear (1, 1, middle-6, 1);
+	cairo_pattern_add_color_stop_rgb (cp1, 0, 0.00, 0.00, 0.00);
+	cairo_pattern_add_color_stop_rgb (cp1, 1, 0.98, 0.98, 0.98);
+	cairo_pattern_t *cp2 = cairo_pattern_create_linear (width-1, 1, middle+6, 1);
+	cairo_pattern_add_color_stop_rgb (cp2, 0, 0.00, 0.00, 0.00);
+	cairo_pattern_add_color_stop_rgb (cp2, 1, 0.98, 0.98, 0.98);
+	cairo_pattern_t *cp3 = cairo_pattern_create_linear (1, height-2, middle-6, height-2);
+	cairo_pattern_add_color_stop_rgb (cp3, 1, 0.98, 0.98, 0.98);
+	cairo_pattern_add_color_stop_rgb (cp3, 0, 0.00, 0.00, 0.00);
+	cairo_pattern_t *cp4 = cairo_pattern_create_linear (width-1, height-2, middle+6, height-2);
+	cairo_pattern_add_color_stop_rgb (cp4, 1, 0.98, 0.98, 0.98);
+	cairo_pattern_add_color_stop_rgb (cp4, 0, 0.00, 0.00, 0.00);
+
+	cairo_set_line_width (cr, 1);
+	cairo_set_source (cr, cp1);
+	cairo_line_to (cr, 1, 1);
+	cairo_line_to (cr, middle, 1);
+	cairo_stroke (cr);
+	cairo_set_source (cr, cp3);
+	cairo_line_to (cr, 1, height-2);
+	cairo_line_to (cr, middle, height-2);
+	cairo_stroke (cr);
+	cairo_set_source (cr, cp2);
+	cairo_line_to (cr, middle, 1);
+	cairo_line_to (cr, width-1, 1);
+	cairo_stroke (cr);
+	cairo_set_source (cr, cp4);
+	cairo_line_to (cr, middle, height-2);
+	cairo_line_to (cr, width-1, height-2);
+	cairo_stroke (cr);
+	cairo_pattern_destroy(cp1);
+	cairo_pattern_destroy(cp2);
+	cairo_pattern_destroy(cp3);
+	cairo_pattern_destroy(cp4);
+}
+
+static void
+draw_background (GtkWidget *wheel, cairo_t *cr)
+{
+	gfloat width = wheel->allocation.width;
+	gfloat height = wheel->allocation.height;
+	gfloat middle = width/2.0;
+
+	cairo_set_line_width (cr, 0);
+	cairo_pattern_t *base1 = cairo_pattern_create_linear (1, 1, middle-5, 1);
+	cairo_pattern_add_color_stop_rgb (base1, 0, 0.33, 0.33, 0.33);
+	cairo_pattern_add_color_stop_rgb (base1, 1, 0.88, 0.88, 0.88);
+	cairo_set_source (cr, base1);
+	cairo_rectangle (cr, 1, 0, middle-1, height-1);
+	cairo_fill_preserve (cr);
+	cairo_stroke (cr);
+	cairo_pattern_t *base2 = cairo_pattern_create_linear (width-1, 1, middle+5, 1);
+	cairo_pattern_add_color_stop_rgb (base2, 0, 0.33, 0.33, 0.33);
+	cairo_pattern_add_color_stop_rgb (base2, 1, 0.88, 0.88, 0.88);
+	cairo_set_source (cr, base2);
+	cairo_rectangle (cr, middle, 0, middle-1, height-1);
+	cairo_fill_preserve (cr);
+	cairo_stroke (cr);
+	cairo_pattern_destroy(base1);
+	cairo_pattern_destroy(base2);
+}
+
+static void
+draw_edges (GtkWidget *wheel, cairo_t *cr)
+{
+	gfloat width = wheel->allocation.width;
+	gfloat height = wheel->allocation.height;
+
+	cairo_set_line_width (cr, 0);
+	cairo_pattern_t *cp5 = cairo_pattern_create_linear (1, 2, 6, 2);
+	cairo_pattern_add_color_stop_rgb (cp5, 0, 0.00, 0.00, 0.00);
+	cairo_pattern_add_color_stop_rgb (cp5, 1, 0.23, 0.23, 0.23);
+	cairo_set_source (cr, cp5);
+	cairo_rectangle (cr, 1, 2, 6, height-4);
+	cairo_fill_preserve (cr);
+	cairo_stroke (cr);
+	cairo_set_line_width (cr, 0);
+	cairo_pattern_t *cp6 = cairo_pattern_create_linear (width-1, 2, width-6, 2);
+	cairo_pattern_add_color_stop_rgb (cp6, 0, 0.00, 0.00, 0.00);
+	cairo_pattern_add_color_stop_rgb (cp6, 1, 0.23, 0.23, 0.23);
+	cairo_set_source (cr, cp6);
+	cairo_rectangle (cr, width-7, 2, 6, height-4);
+	cairo_fill_preserve (cr);
+	cairo_stroke (cr);
+	cairo_pattern_destroy(cp5);
+	cairo_pattern_destroy(cp6);
+}	
+
+static void
+draw_lines (GtkWidget *wheel, cairo_t *cr)
+{
+	JogShuttlePrivate *priv;
+	priv = JOG_SHUTTLE_GET_PRIVATE (wheel);
+	
+	gfloat width = wheel->allocation.width;
+	gfloat height = wheel->allocation.height;
+	gfloat middle = width/2.0;
+
+	int i;
+	for (i=0; i<6; i++)
+	{
+		priv->pos[i] += priv->offset;
+		if (priv->pos[i] > width)
+		{
+			priv->pos[i] -= width;
+		}
+		else if (priv->pos[i] < 0)
+		{
+			priv->pos[i] = width + priv->pos[i];
+		}
+		
+		gfloat color;
+		if (priv->pos[i] <= middle)
+		{
+			color = priv->pos[i] / middle * 0.85;
+		}
+		else
+		{
+			color = (width-priv->pos[i]) / middle * 0.85;
+		}
+		if (i==3)
+		{
+ 			cairo_set_source_rgb (cr, color, 0, 0);
+ 			cairo_set_line_width (cr, 2);
+		}
+		else
+		{
+			cairo_set_source_rgb (cr, color, color, color);
+			cairo_set_line_width (cr, 1);
+		}
+		cairo_line_to (cr, priv->pos[i], 2);
+		cairo_line_to (cr, priv->pos[i], height-2);
+		cairo_stroke (cr);
+	}
+	
+	priv->value = (priv->pos[3]-middle) / middle;
+ 	emit_value_changed_signal (JOG_SHUTTLE(wheel));
+}
+
+static gboolean
+jog_shuttle_expose (GtkWidget *wheel, GdkEventExpose *event)
+{
+	JogShuttlePrivate *priv;
+	priv = JOG_SHUTTLE_GET_PRIVATE (wheel);
+	
+	if (!priv->pressed)
+	{
+		reset(wheel);
+	}
+	
+	cairo_t *cr;
+	cr = gdk_cairo_create (wheel->window);
+
+	cairo_rectangle (cr, event->area.x, event->area.y, event->area.width, event->area.height);
+	cairo_clip (cr);
+	cairo_set_antialias (cr, CAIRO_ANTIALIAS_NONE);
+	draw_background (wheel, cr);
+	draw_lines (wheel, cr);
+	draw_borders (wheel, cr);
+	draw_edges (wheel, cr);
+
+	cairo_destroy (cr);
+	return FALSE;
+}
+
+gfloat 
+jog_shuttle_get_value (GtkWidget *wheel)
+{
+	JogShuttlePrivate *priv;
+	priv = JOG_SHUTTLE_GET_PRIVATE (wheel);
+	return (priv->value);
+}
+
+GtkWidget *
+jog_shuttle_new (void)
+{
+	return g_object_new (JOG_TYPE_SHUTTLE, NULL);
+}

Added: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_toolkit_gtk/jogshuttle.h
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_toolkit_gtk/jogshuttle.h	2007-07-05 17:03:26 UTC (rev 3333)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_toolkit_gtk/jogshuttle.h	2007-07-05 17:37:24 UTC (rev 3334)
@@ -0,0 +1,34 @@
+#ifndef __JOG_SHUTTLE_H__
+#define __JOG_SHUTTLE_H__
+
+#include <gtk/gtk.h>
+
+G_BEGIN_DECLS
+
+#define JOG_TYPE_SHUTTLE		(jog_shuttle_get_type ())
+#define JOG_SHUTTLE(obj)		(G_TYPE_CHECK_INSTANCE_CAST ((obj), JOG_TYPE_SHUTTLE, JogShuttle))
+#define JOG_SHUTTLE_CLASS(obj)	(G_TYPE_CHECK_CLASS_CAST ((obj), JOG_SHUTTLE, JogShuttleClass))
+#define JOG_IS_SHUTTLE(obj)		(G_TYPE_CHECK_INSTANCE_TYPE ((obj), JOG_TYPE_SHUTTLE))
+#define JOG_IS_SHUTTLE_CLASS(obj)	(G_TYPE_CHECK_CLASS_TYPE ((obj), JOG_TYPE_SHUTTLE))
+#define JOG_SHUTTLE_GET_CLASS	(G_TYPE_INSTANCE_GET_CLASS ((obj), JOG_TYPE_SHUTTLE, JogShuttleClass))
+
+typedef struct _JogShuttle        JogShuttle;
+typedef struct _JogShuttleClass   JogShuttleClass;
+
+struct _JogShuttle
+{
+	GtkDrawingArea parent;
+};
+
+struct _JogShuttleClass
+{
+	GtkDrawingAreaClass parent_class;
+	void (* value_changed) (JogShuttle *wheel);
+};
+
+GtkWidget *jog_shuttle_new (void);
+gfloat jog_shuttle_get_value (GtkWidget *wheel);
+
+G_END_DECLS
+
+#endif



From mean at mail.berlios.de  Thu Jul  5 19:44:52 2007
From: mean at mail.berlios.de (mean at BerliOS)
Date: Thu, 5 Jul 2007 19:44:52 +0200
Subject: [Avidemux-svn-commit] r3335 - in
	branches/avidemux_2.4_branch/avidemux: . ADM_audio
	ADM_userInterfaces/ADM_GTK/ADM_gui2
	ADM_userInterfaces/ADM_GTK/ADM_toolkit_gtk
	ADM_userInterfaces/ADM_NONE/ADM_dialog
	ADM_userInterfaces/ADM_QT4/ADM_dialog
	ADM_userInterfaces/ADM_commonUI
Message-ID: <200707051744.l65Hiq6r014756@sheep.berlios.de>

Author: mean
Date: 2007-07-05 19:44:51 +0200 (Thu, 05 Jul 2007)
New Revision: 3335

Modified:
   branches/avidemux_2.4_branch/avidemux/ADM_audio/ADM_mp3info.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_bindings.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/patch.bash
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_toolkit_gtk/CMakeLists.txt
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_toolkit_gtk/Makefile.am
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_toolkit_gtk/jogshuttle.c
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_NONE/ADM_dialog/alert_none.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_none.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/GUI_ui.h
   branches/avidemux_2.4_branch/avidemux/gtk_gui.cpp
   branches/avidemux_2.4_branch/avidemux/gui_action.hxx
   branches/avidemux_2.4_branch/avidemux/gui_navigate.cpp
Log:
JM jog shuttle, not completly working

Modified: branches/avidemux_2.4_branch/avidemux/ADM_audio/ADM_mp3info.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_audio/ADM_mp3info.cpp	2007-07-05 17:37:24 UTC (rev 3334)
+++ branches/avidemux_2.4_branch/avidemux/ADM_audio/ADM_mp3info.cpp	2007-07-05 17:44:51 UTC (rev 3335)
@@ -124,7 +124,11 @@
 					// Check consistency
 					if(templ)
 					{
-						if(templ->samplerate!=mpegInfo->samplerate) continue;
+						if(templ->samplerate!=mpegInfo->samplerate)
+                                                {
+                                                  printf("[MP3]samplerate does not match\n");
+                                                  continue;
+                                                }
 					
 					}
 					found=1;

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_bindings.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_bindings.cpp	2007-07-05 17:37:24 UTC (rev 3334)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_bindings.cpp	2007-07-05 17:44:51 UTC (rev 3335)
@@ -48,6 +48,7 @@
 #include "../ADM_editor/ADM_outputfmt.h"
 #include "../prefs.h"
 #include "../ADM_toolkit_gtk/gtkmarkscale.h"
+#include "../ADM_toolkit_gtk/jogshuttle.h"
 
 uint8_t UI_getPhysicalScreenSize(uint32_t *w,uint32_t *h,void *r);
 
@@ -329,8 +330,8 @@
                       GTK_SIGNAL_FUNC(UI_looseFocus),                   (void *) NULL);	 
 
         
-        // navKey
-        gtk_signal_connect(GTK_OBJECT(lookup_widget(guiRootWindow,"hscaleSensitive")), "value_changed",   
+        // Jog
+        gtk_signal_connect(GTK_OBJECT(lookup_widget(guiRootWindow,"jogg")), "value_changed",   
                       GTK_SIGNAL_FUNC(volumeChange),                   (void *) NULL);  
 
 
@@ -562,25 +563,26 @@
 
 void volumeChange( void )
 {
-#ifdef HAVE_AUDIO
-GtkWidget *wid;
-GtkAdjustment *adj;
-int vol;
+    HandleAction(ACT_JOG);    
 
+}
+/**
+    \fn UI_readJog
+    \brief Returns value of jog
+*/
+int32_t UI_readJog(void)
+{
+  GtkWidget *wid;
+  float val;
 
-if(_upd_in_progres) return;
- _upd_in_progres++;
-
-        wid=lookup_widget(guiRootWindow,"hscaleSensitive");
-        adj=gtk_range_get_adjustment (GTK_RANGE(wid));
-        vol=(int)floor(adj->value+0.5);
-        AVDM_setVolume( vol);
- _upd_in_progres--;
-#endif
+        wid=lookup_widget(guiRootWindow,"jogg");
+        val=jog_shuttle_get_value(wid);
+        printf("Jog : %f\n",val);
+        val=val*100;
+        return (int32_t )val;
+        
 }
 
-
-
 void UI_setTitle(char *name)
 {
         char title[1024];

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp	2007-07-05 17:37:24 UTC (rev 3334)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp	2007-07-05 17:44:51 UTC (rev 3335)
@@ -14,6 +14,7 @@
 
 #include <gdk/gdkkeysyms.h>
 #include <gtk/gtk.h>
+#include "../ADM_toolkit_gtk/jogshuttle.h"
 
 #include "../ADM_toolkit_gtk/ADM_gladeSupport.h"
 
@@ -246,7 +247,6 @@
   GtkWidget *buttonEnd;
   GtkWidget *image2245;
   GtkWidget *sliderNavigate;
-  GtkWidget *hscaleSensitive;
   GtkWidget *hbox16;
   GtkWidget *label1;
   GtkWidget *boxCurFrame;
@@ -255,6 +255,7 @@
   GtkWidget *boxCurTime;
   GtkWidget *labelTotalTime;
   GtkWidget *labelFrameType;
+  GtkWidget *jogg;
   extern GtkAccelGroup *accel_group;
   GtkTooltips *tooltips;
 
@@ -900,7 +901,7 @@
   gtk_container_add (GTK_CONTAINER (go1_menu), separator15);
   gtk_widget_set_sensitive (separator15, FALSE);
 
-  jum_to_frame1 = gtk_image_menu_item_new_with_mnemonic (_("Go to Fra_me..."));
+  jum_to_frame1 = gtk_image_menu_item_new_with_mnemonic (_("_Jump to Frame..."));
   gtk_widget_show (jum_to_frame1);
   gtk_container_add (GTK_CONTAINER (go1_menu), jum_to_frame1);
   gtk_widget_add_accelerator (jum_to_frame1, "activate", accel_group,
@@ -911,7 +912,7 @@
   gtk_widget_show (image8219);
   gtk_image_menu_item_set_image (GTK_IMAGE_MENU_ITEM (jum_to_frame1), image8219);
 
-  jump_to_time1 = gtk_image_menu_item_new_with_mnemonic (_("Go to _Time..."));
+  jump_to_time1 = gtk_image_menu_item_new_with_mnemonic (_("Jump to _Time..."));
   gtk_widget_show (jump_to_time1);
   gtk_container_add (GTK_CONTAINER (go1_menu), jump_to_time1);
   gtk_widget_add_accelerator (jump_to_time1, "activate", accel_group,
@@ -1376,15 +1377,6 @@
   GTK_WIDGET_UNSET_FLAGS (sliderNavigate, GTK_CAN_FOCUS);
   gtk_scale_set_value_pos (GTK_SCALE (sliderNavigate), GTK_POS_LEFT);
 
-  hscaleSensitive = gtk_hscale_new (GTK_ADJUSTMENT (gtk_adjustment_new (62.2951, 0, 100, 5, 5, 5)));
-  gtk_widget_show (hscaleSensitive);
-  gtk_table_attach (GTK_TABLE (table2), hscaleSensitive, 1, 2, 0, 1,
-                    (GtkAttachOptions) (GTK_FILL),
-                    (GtkAttachOptions) (GTK_EXPAND | GTK_FILL), 0, 0);
-  gtk_scale_set_draw_value (GTK_SCALE (hscaleSensitive), FALSE);
-  gtk_scale_set_value_pos (GTK_SCALE (hscaleSensitive), GTK_POS_RIGHT);
-  gtk_scale_set_digits (GTK_SCALE (hscaleSensitive), 0);
-
   hbox16 = gtk_hbox_new (FALSE, 6);
   gtk_widget_show (hbox16);
   gtk_table_attach (GTK_TABLE (table2), hbox16, 0, 1, 2, 3,
@@ -1403,7 +1395,7 @@
   gtk_entry_set_text (GTK_ENTRY (boxCurFrame), _("0"));
   gtk_entry_set_width_chars (GTK_ENTRY (boxCurFrame), 8);
 
-  labelTotalFrame = gtk_label_new (_("/ 0000000"));
+  labelTotalFrame = gtk_label_new (_("/0000000"));
   gtk_widget_show (labelTotalFrame);
   gtk_box_pack_start (GTK_BOX (hbox16), labelTotalFrame, FALSE, FALSE, 0);
   GTK_WIDGET_SET_FLAGS (labelTotalFrame, GTK_CAN_FOCUS);
@@ -1421,7 +1413,7 @@
   gtk_entry_set_text (GTK_ENTRY (boxCurTime), _("00:00:00.000"));
   gtk_entry_set_width_chars (GTK_ENTRY (boxCurTime), 13);
 
-  labelTotalTime = gtk_label_new (_("/ 00:00:00,000"));
+  labelTotalTime = gtk_label_new (_("/00:00:00,000"));
   gtk_widget_show (labelTotalTime);
   gtk_box_pack_start (GTK_BOX (hbox16), labelTotalTime, FALSE, FALSE, 0);
   GTK_WIDGET_SET_FLAGS (labelTotalTime, GTK_CAN_FOCUS);
@@ -1434,6 +1426,14 @@
   GTK_WIDGET_SET_FLAGS (labelFrameType, GTK_CAN_FOCUS);
   gtk_label_set_selectable (GTK_LABEL (labelFrameType), TRUE);
 
+  jogg = jog_shuttle_new ();
+  gtk_widget_show (jogg);
+  gtk_table_attach (GTK_TABLE (table2), jogg, 1, 2, 0, 1,
+                    (GtkAttachOptions) (GTK_FILL),
+                    (GtkAttachOptions) (GTK_FILL), 0, 0);
+  GTK_WIDGET_UNSET_FLAGS (jogg, GTK_CAN_FOCUS);
+  GTK_WIDGET_UNSET_FLAGS (jogg, GTK_CAN_DEFAULT);
+
   /* Store pointers to all widgets, for use by lookup_widget(). */
   GLADE_HOOKUP_OBJECT_NO_REF (mainWindow, mainWindow, "mainWindow");
   GLADE_HOOKUP_OBJECT (mainWindow, vbox1, "vbox1");
@@ -1648,7 +1648,6 @@
   GLADE_HOOKUP_OBJECT (mainWindow, buttonEnd, "buttonEnd");
   GLADE_HOOKUP_OBJECT (mainWindow, image2245, "image2245");
   GLADE_HOOKUP_OBJECT (mainWindow, sliderNavigate, "sliderNavigate");
-  GLADE_HOOKUP_OBJECT (mainWindow, hscaleSensitive, "hscaleSensitive");
   GLADE_HOOKUP_OBJECT (mainWindow, hbox16, "hbox16");
   GLADE_HOOKUP_OBJECT (mainWindow, label1, "label1");
   GLADE_HOOKUP_OBJECT (mainWindow, boxCurFrame, "boxCurFrame");
@@ -1657,6 +1656,7 @@
   GLADE_HOOKUP_OBJECT (mainWindow, boxCurTime, "boxCurTime");
   GLADE_HOOKUP_OBJECT (mainWindow, labelTotalTime, "labelTotalTime");
   GLADE_HOOKUP_OBJECT (mainWindow, labelFrameType, "labelFrameType");
+  GLADE_HOOKUP_OBJECT (mainWindow, jogg, "jogg");
   GLADE_HOOKUP_OBJECT_NO_REF (mainWindow, tooltips, "tooltips");
 
   gtk_window_add_accel_group (GTK_WINDOW (mainWindow), accel_group);

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/patch.bash
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/patch.bash	2007-07-05 17:37:24 UTC (rev 3334)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/patch.bash	2007-07-05 17:44:51 UTC (rev 3335)
@@ -1,5 +1,6 @@
 cat GUI_main2.cpp | sed 's/, 0,$/, (GdkModifierType) 0,/g' | sed 's/-2/-1/g' | sed 's/GtkAccelGroup \*/extern GtkAccelGroup */' | sed 's/(GdkModifierType)/(GdkModifierType)(/g' | sed 's/MASK,$/MASK\),/g' |sed 's/( 0,$/( 0 ),/g' | \
 sed 's/sliderNavigate = gtk_hscale_new/sliderNavigate = gtk_markscale_new/' | \
+sed 's/jog_shuttle_new ("jogg", "", "", 0, 0);/jog_shuttle_new ();/' | \
 sed 's/gtk_widget_show (sliderNavigate);/gtk_widget_show (sliderNavigate);gtk_scale_set_draw_value (GTK_SCALE (sliderNavigate), FALSE);/' |\
 sed 's/#include "interface.h"//' |\
 sed 's/#include "support.h"/#include "..\/ADM_toolkit_gtk\/gtkmarkscale.h"/' |\

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_toolkit_gtk/CMakeLists.txt
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_toolkit_gtk/CMakeLists.txt	2007-07-05 17:37:24 UTC (rev 3334)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_toolkit_gtk/CMakeLists.txt	2007-07-05 17:44:51 UTC (rev 3335)
@@ -6,7 +6,7 @@
 #
 SET(${ADM_LIB}_SRCS
 ADM_gladeSupport.cpp  ADM_tray_gtk.cpp  choice.cpp  TLK_filesel.cpp  toolkit.cpp  toolkit_dialog.cpp 
-                                        eggtrayicon.c eggtray_win32.c gtkmarkscale.c
+                                        eggtrayicon.c eggtray_win32.c gtkmarkscale.c jogshuttle.c
 )
 ADD_LIBRARY(${ADM_LIB} STATIC ${${ADM_LIB}_SRCS})
 ADD_ADM_LIB(${ADM_LIB} ADM_libraries)

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_toolkit_gtk/Makefile.am
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_toolkit_gtk/Makefile.am	2007-07-05 17:37:24 UTC (rev 3334)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_toolkit_gtk/Makefile.am	2007-07-05 17:44:51 UTC (rev 3335)
@@ -9,7 +9,7 @@
 libADM_toolkit_gtk_a_METASOURCES = AUTO
 
 libADM_toolkit_gtk_a_SOURCES = ADM_gladeSupport.cpp  ADM_tray_gtk.cpp  choice.cpp  TLK_filesel.cpp  toolkit.cpp  toolkit_dialog.cpp \
-					eggtrayicon.c eggtray_win32.c gtkmarkscale.c
+					eggtrayicon.c eggtray_win32.c gtkmarkscale.c jogshuttle.c
 
 
 EXTRA_DIST = 

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_toolkit_gtk/jogshuttle.c
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_toolkit_gtk/jogshuttle.c	2007-07-05 17:37:24 UTC (rev 3334)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_toolkit_gtk/jogshuttle.c	2007-07-05 17:44:51 UTC (rev 3335)
@@ -341,6 +341,7 @@
 {
 	JogShuttlePrivate *priv;
 	priv = JOG_SHUTTLE_GET_PRIVATE (wheel);
+        if(priv->pressed==FALSE) return 0;
 	return (priv->value);
 }
 

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_NONE/ADM_dialog/alert_none.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_NONE/ADM_dialog/alert_none.cpp	2007-07-05 17:37:24 UTC (rev 3334)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_NONE/ADM_dialog/alert_none.cpp	2007-07-05 17:44:51 UTC (rev 3335)
@@ -255,3 +255,7 @@
 {
   beQuiet=1;
 }
+int32_t UI_readJog(void)
+{
+ return 0; 
+}
\ No newline at end of file

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_none.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_none.cpp	2007-07-05 17:37:24 UTC (rev 3334)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_none.cpp	2007-07-05 17:44:51 UTC (rev 3335)
@@ -99,6 +99,9 @@
 int DIA_colorSel(uint8_t *r, uint8_t *g, uint8_t *b) {return 0;}
 
 
-
+int32_t UI_readJog(void)
+{
+  return 0; 
+}
 //EOF
 

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/GUI_ui.h
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/GUI_ui.h	2007-07-05 17:37:24 UTC (rev 3334)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/GUI_ui.h	2007-07-05 17:44:51 UTC (rev 3335)
@@ -14,8 +14,8 @@
 void 	UI_setFrameType( uint32_t frametype,uint32_t qp);
 void 	UI_setMarkers(uint32_t a, uint32_t b );
 void 	UI_setTitle(char *name);
+int32_t UI_readJog(void);
 
-
 void UI_setAProcessToggleStatus( uint8_t status );
 void UI_setVProcessToggleStatus( uint8_t status );
 

Modified: branches/avidemux_2.4_branch/avidemux/gtk_gui.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/gtk_gui.cpp	2007-07-05 17:37:24 UTC (rev 3334)
+++ branches/avidemux_2.4_branch/avidemux/gtk_gui.cpp	2007-07-05 17:44:51 UTC (rev 3335)
@@ -169,6 +169,7 @@
 void GUI_showCurrentFrameHex(void);
 void GUI_avsProxy(void);
 uint8_t GUI_close(void);
+extern void A_jog(void);
 //___________________________________________
 // serialization of user event throught gui
 //
@@ -366,6 +367,8 @@
     {
       switch (action)
 	{
+          case ACT_JOG:
+                break;
         case ACT_TimeShift:
                 A_TimeShift();
                 break;
@@ -389,6 +392,10 @@
   // we have an AVI loaded
   switch (action)
     {
+       case ACT_JOG:
+                A_jog();
+                break;
+
        case ACT_CLOSE:
               GUI_close();
               break;

Modified: branches/avidemux_2.4_branch/avidemux/gui_action.hxx
===================================================================
--- branches/avidemux_2.4_branch/avidemux/gui_action.hxx	2007-07-05 17:37:24 UTC (rev 3334)
+++ branches/avidemux_2.4_branch/avidemux/gui_action.hxx	2007-07-05 17:44:51 UTC (rev 3335)
@@ -191,6 +191,7 @@
 ACT_BUILT_IN,
 ACT_HEX_DUMP,
 ACT_AVS_PROXY,
+ACT_JOG,
 ACT_CUSTOM_BASE,
 ACT_CUSTOM_END=ACT_CUSTOM_BASE+ADM_MAC_CUSTOM_SCRIPT,
 ACT_DUMMY

Modified: branches/avidemux_2.4_branch/avidemux/gui_navigate.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/gui_navigate.cpp	2007-07-05 17:37:24 UTC (rev 3334)
+++ branches/avidemux_2.4_branch/avidemux/gui_navigate.cpp	2007-07-05 17:44:51 UTC (rev 3335)
@@ -44,6 +44,7 @@
 #include "ADM_video/ADM_genvideo.hxx"
 #include "ADM_filter/video_filters.h"
 #include "DIA_busy.h"
+#include "GUI_ui.h"
 extern void    UI_purge(void );
 //____________________________________
 
@@ -453,5 +454,65 @@
           DIA_StopBusy ();
         }
 }
+/**
+      \fn A_jogRead
+      \brief read an average value of jog
+*/
+#define NB_JOG_READ           3
+#define JOG_READ_PERIOD_US    5*1000 // 5ms
+#define JOG_THRESH1           40
+#define JOG_THRESH2           80
+#define JOG_THRESH1_PERIOD    100*1000 //us
+#define JOG_THRESH2_PERIOD    40*1000
+#define JOG_THRESH3_PERIOD    500
+/**
+    \fn A_jogRead
+    \brief Read an average value of jog
+*/
+uint32_t A_jogRead(void)
+{
+  int32_t sum=0,v;
+    for(int i=0;i<NB_JOG_READ;i++)
+    {
+        v=UI_readJog();
+        if(abs(v)<10) v=0;
+        sum+=v;
+        ADM_usleep(JOG_READ_PERIOD_US);
+    } 
+    return sum/NB_JOG_READ;
+}
+#define REFRESH 10000
+/**
+      \fn     A_jog
+      \brief  Handle jogshuttle widget
+*/
+void A_jog(void)
+{
+  int32_t r;
+  uint32_t a;
+  uint32_t slip;
+  static int jog=0;
+  if(jog) return;
+  jog++;
+  while(r=A_jogRead())
+  {
+      a=abs(r);
+      printf("%d \n",r);
+      if(a<JOG_THRESH1) slip=JOG_THRESH1_PERIOD;
+        else if(a<JOG_THRESH2) slip=JOG_THRESH2_PERIOD;
+          else slip=JOG_THRESH3_PERIOD;
+    
+      if(r>0) GUI_NextKeyFrame();
+      else GUI_PreviousKeyFrame();       
+      UI_purge();
+      for(int i=0;i<slip/REFRESH;i++)
+      {
+        UI_purge();
+        ADM_usleep(REFRESH);
+        UI_purge();
+      }
+  }
+  jog--;
+}
 //EOF
         



From gruntster at mail.berlios.de  Fri Jul  6 03:03:31 2007
From: gruntster at mail.berlios.de (gruntster at mail.berlios.de)
Date: Fri, 6 Jul 2007 03:03:31 +0200
Subject: [Avidemux-svn-commit] r3336 - in
	branches/avidemux_2.4_branch/avidemux: .
	ADM_userInterfaces/ADM_commonUI
Message-ID: <200707060103.l6613VO3031482@sheep.berlios.de>

Author: gruntster
Date: 2007-07-06 03:03:19 +0200 (Fri, 06 Jul 2007)
New Revision: 3336

Modified:
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/GUI_sdlRender.cpp
   branches/avidemux_2.4_branch/avidemux/guiplay.cpp
Log:
eliminate flicker upon first use of SDL

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/GUI_sdlRender.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/GUI_sdlRender.cpp	2007-07-05 17:44:51 UTC (rev 3335)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/GUI_sdlRender.cpp	2007-07-06 01:03:19 UTC (rev 3336)
@@ -41,7 +41,6 @@
 
 #ifdef ADM_WIN32
 #include "prefs.h"
-#include "ADM_userInterfaces/ADM_commonUI/GUI_render.h"
 #endif
 
 //******************************************
@@ -82,9 +81,7 @@
         sdl_running=0;
         sdl_overlay=NULL;
         sdl_display=NULL;
-        printf("[SDL] System closed and destroyed\n");
-        
-        
+        printf("[SDL] Video subsystem closed and destroyed\n");        
 }
 uint8_t sdlAccelRender::init( GUI_WindowInfo * window, uint32_t w, uint32_t h)
 {
@@ -125,6 +122,18 @@
     sdl_running=1;
     flags = SDL_ANYFORMAT | SDL_HWPALETTE | SDL_HWSURFACE | SDL_NOFRAME;
     bpp= SDL_VideoModeOK( w, h,  16, flags );
+
+#ifdef ADM_WIN32
+	// SDL window is created and displayed before we get a chance to set the parent.
+	// Therefore, align the SDL overlay with the client area before it is displayed.
+	POINT screenPoint = {};
+	char origin[43];
+
+	ClientToScreen((HWND)window->display, &screenPoint);
+	snprintf(origin, 43, "SDL_VIDEO_WINDOW_POS=%i,%i", screenPoint.x, screenPoint.y);
+	putenv(origin);
+#endif
+
     sdl_display= SDL_SetVideoMode( w, h,  bpp, flags );
 
     if (!sdl_display)

Modified: branches/avidemux_2.4_branch/avidemux/guiplay.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/guiplay.cpp	2007-07-05 17:44:51 UTC (rev 3335)
+++ branches/avidemux_2.4_branch/avidemux/guiplay.cpp	2007-07-06 01:03:19 UTC (rev 3336)
@@ -132,7 +132,7 @@
     one_frame /= 10; // Duration of a frame in ms, err =leftover in 1/10 ms
     
     // go to RealTime...    
-    printf(" One frame : %lu, err=%lu ms\n", one_frame, err);
+    printf("One frame : %lu, err=%lu ms\n", one_frame, err);
     
     // prepare 1st frame
 
@@ -162,7 +162,7 @@
 
         if((played_frame)>=(max-1))
         {
-            printf("\n End met (%lu  / %lu )\n",played_frame,max);
+            printf("\nEnd met (%lu  / %lu )\n",played_frame,max);
             goto abort_play;
          }
         



From mihailzenkov at mail.berlios.de  Fri Jul  6 12:08:24 2007
From: mihailzenkov at mail.berlios.de (mihailzenkov at BerliOS)
Date: Fri, 6 Jul 2007 12:08:24 +0200
Subject: [Avidemux-svn-commit] r3337 - in branches/avidemux_2.4_branch: .
	avidemux avidemux/ADM_audiodevice cmake
Message-ID: <200707061008.l66A8OHr018844@sheep.berlios.de>

Author: mihailzenkov
Date: 2007-07-06 12:08:22 +0200 (Fri, 06 Jul 2007)
New Revision: 3337

Modified:
   branches/avidemux_2.4_branch/ConfigureChecks.cmake
   branches/avidemux_2.4_branch/avidemux/ADM_audiodevice/ADM_deviceJack.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_audiodevice/ADM_deviceJack.h
   branches/avidemux_2.4_branch/avidemux/CMakeLists.txt
   branches/avidemux_2.4_branch/cmake/conf_summary.cmake
   branches/avidemux_2.4_branch/config.h.cmake
Log:
jack: add libsamplerate

Modified: branches/avidemux_2.4_branch/ConfigureChecks.cmake
===================================================================
--- branches/avidemux_2.4_branch/ConfigureChecks.cmake	2007-07-06 01:03:19 UTC (rev 3336)
+++ branches/avidemux_2.4_branch/ConfigureChecks.cmake	2007-07-06 10:08:22 UTC (rev 3337)
@@ -205,6 +205,10 @@
 endif(USE_AFTEN)
 SET(CMAKE_REQUIRED_FLAGS "")
 ########################################
+# SRC
+########################################
+ADM_CHECK_HL(libsamplerate samplerate.h samplerate src_get_version USE_SRC)
+########################################
 # ICONV
 ########################################
 # search ICON.h

Modified: branches/avidemux_2.4_branch/avidemux/ADM_audiodevice/ADM_deviceJack.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_audiodevice/ADM_deviceJack.cpp	2007-07-06 01:03:19 UTC (rev 3336)
+++ branches/avidemux_2.4_branch/avidemux/ADM_audiodevice/ADM_deviceJack.cpp	2007-07-06 10:08:22 UTC (rev 3337)
@@ -13,6 +13,7 @@
 #include <stdio.h>
 #include <stdint.h>
 
+
 #include "default.h"
 #include "ADM_audiodevice.h"
 #include <ADM_assert.h>
@@ -20,9 +21,17 @@
 #include "ADM_audiodevice/ADM_deviceALSA.h"
 #include "ADM_audiodevice/ADM_deviceJack.h"
 
+
+#define BUFSIZE 16385
+
 jackAudioDevice::jackAudioDevice()
 {
 	client = NULL;
+	ringbuffer = NULL;
+	#ifdef USE_SRC
+	src_out_buf = NULL;
+	src_state = NULL;
+	#endif
 }
 
 void jackAudioDevice::jack_shutdown(void *arg)
@@ -33,9 +42,18 @@
 uint8_t jackAudioDevice::stop()
 {
 	if (client) {
+		printf("[JACK] Stop\n");
 		jack_client_close(client);
 		client = NULL;
-		jack_ringbuffer_free(ringbuffer);
+		if (ringbuffer)
+			jack_ringbuffer_free(ringbuffer);
+		ringbuffer = NULL;
+		#ifdef USE_SRC
+		delete src_out_buf;
+		src_out_buf = NULL;
+		src_delete(src_state);
+		src_state = NULL;
+		#endif
 	}
 
 	return 1;
@@ -63,11 +81,36 @@
 	if (status & JackServerStarted)
 		printf("[JACK] Server started\n");
 
+	if (jack_get_sample_rate(client) == fq) {
+		jack_set_process_callback(client, process_callback, this);
+	} else {
+		printf("[JACK] audio stream sample rate: %i\n", fq);
+		printf("[JACK] jack server sample rate: %i\n", (int)jack_get_sample_rate(client));
+		#ifdef USE_SRC
+			src_out_buf = new float[BUFSIZE * channels];
+			src_state = src_new(SRC_SINC_FASTEST, channels, NULL);
+			if (!src_state) {
+				printf("[JACK] Can't init libsamplerate\n");
+				stop();
+				return 0;
+			}
+			src_data.data_out = src_out_buf;
+			src_data.output_frames = BUFSIZE;
+			src_data.src_ratio = jack_get_sample_rate(client) / (double)fq;
+			src_data.end_of_input = 0;
+//			printf("[JACK] ratio: %f\n", src_data.src_ratio);
+		#else
+			printf("[JACK] For play this, you need avidemux compiled with libsamplerate support\n");
+			stop();
+			return 0;
+		#endif
+	}
+
+	ringbuffer = jack_ringbuffer_create(BUFSIZE * channels * sizeof(jack_default_audio_sample_t));
+
 	jack_set_process_callback(client, process_callback, this);
 	jack_on_shutdown(client, jack_shutdown, this);
 
-	ringbuffer = jack_ringbuffer_create(65536 * channels);
-
 	char name[10];
 	for (int i = 0; i < channels; i++) {
 		snprintf(name, 10, "output-%d", i);
@@ -75,7 +118,7 @@
 		if (!ports[i]) {
 			printf("[JACK] Can't create new port\n");
 			stop();
-			return 0; 
+			return 0;
 		}
 	}
 
@@ -126,8 +169,6 @@
 	if (read != nframes)
 		printf("[JACK] UNDERRUN!\n");
 
-
-
 	return 0;
 }
 
@@ -139,18 +180,52 @@
 
 uint8_t jackAudioDevice::play(uint32_t len, float *data)
 {
+//	static int min = 5000;
+	static int sleep = (int)((float)BUFSIZE / jack_get_sample_rate(client) / 2. * 1000000.);
 	size_t write;
+	float writef;
+	len /= _channels;
 
+	#ifdef USE_SRC
+	if (src_out_buf) {
+		while (len) {
+			writef = jack_ringbuffer_write_space(ringbuffer);
+			writef /= src_data.src_ratio * sizeof(jack_default_audio_sample_t) * _channels;
+			write = (size_t)writef;
+			if (write >= len) {
+				src_data.data_in = data;
+				src_data.input_frames = len;
+				src_process(src_state, &src_data);
+				jack_ringbuffer_write(ringbuffer,
+					(char *)src_out_buf,
+					src_data.output_frames_gen * sizeof(jack_default_audio_sample_t) * _channels);
+/*
+				if (len != src_data.input_frames_used)
+					printf("[JACK] len %i != %i input_frames_used\n", len, src_data.input_frames_used);
+				if (len < min)
+					min = len;
+				printf("[JACK] %i %i %i %f %i\n",min, src_data.input_frames_used, src_data.output_frames_gen, writef, len);
+				data += src_data.input_frames_used * _channels;
+				len -= src_data.input_frames_used;
+*/
+				return 1;
+			} else {
+				printf("[JACK] OVERRUN!\n");
+				usleep(sleep);
+			}
+		}
+	} else
+	#endif
 	while (len) {
-		if ((write = jack_ringbuffer_write_space(ringbuffer) / sizeof(jack_default_audio_sample_t)) > _channels) {
-			if (write > len)
-				write = len;
-			jack_ringbuffer_write(ringbuffer, (char *)data, write * sizeof(jack_default_audio_sample_t));
-			data += write;
-			len -= write;
+		writef = jack_ringbuffer_write_space(ringbuffer);
+		writef /= sizeof(jack_default_audio_sample_t) * _channels;
+		write = (size_t)writef;
+		if (write >= len) {
+			jack_ringbuffer_write(ringbuffer, (char *)data, len * sizeof(jack_default_audio_sample_t) * _channels);
+			return 1;
 		} else {
 			printf("[JACK] OVERRUN!\n");
-			usleep(10000);
+			usleep(sleep);
 		}
 	}
 

Modified: branches/avidemux_2.4_branch/avidemux/ADM_audiodevice/ADM_deviceJack.h
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_audiodevice/ADM_deviceJack.h	2007-07-06 01:03:19 UTC (rev 3336)
+++ branches/avidemux_2.4_branch/avidemux/ADM_audiodevice/ADM_deviceJack.h	2007-07-06 10:08:22 UTC (rev 3337)
@@ -11,6 +11,10 @@
 #include <jack/jack.h>
 #include <jack/ringbuffer.h>
 
+#ifdef USE_SRC
+#include <samplerate.h>
+#endif
+
 #define MAX_CHANNELS 9
 
 class jackAudioDevice : public audioDevice
@@ -30,5 +34,10 @@
 	jack_port_t *ports[MAX_CHANNELS];
 	jack_client_t *client;
 	jack_ringbuffer_t *ringbuffer;
+	#ifdef USE_SRC
+	float *src_out_buf;
+	SRC_STATE *src_state;
+	SRC_DATA src_data;
+	#endif
 };
 #endif

Modified: branches/avidemux_2.4_branch/avidemux/CMakeLists.txt
===================================================================
--- branches/avidemux_2.4_branch/avidemux/CMakeLists.txt	2007-07-06 01:03:19 UTC (rev 3336)
+++ branches/avidemux_2.4_branch/avidemux/CMakeLists.txt	2007-07-06 10:08:22 UTC (rev 3337)
@@ -354,6 +354,11 @@
 add_libs_all_targets(iconv)
 endif(NEEED_LIBICONV)
 
+#libsamplerate
+if(USE_SRC)
+add_libs_all_targets(samplerate)
+endif(USE_SRC)
+
 # Xml2
 add_libs_all_targets(xml2 )
 ###########################################

Modified: branches/avidemux_2.4_branch/cmake/conf_summary.cmake
===================================================================
--- branches/avidemux_2.4_branch/cmake/conf_summary.cmake	2007-07-06 01:03:19 UTC (rev 3336)
+++ branches/avidemux_2.4_branch/cmake/conf_summary.cmake	2007-07-06 10:08:22 UTC (rev 3337)
@@ -39,5 +39,6 @@
 ADM_DISPLAY("FontConfig" USE_FONTCONFIG)
 ADM_DISPLAY("Gettext   " HAVE_GETTEXT)
 ADM_DISPLAY("Xvideo    " USE_XV)
+ADM_DISPLAY("samplerate" USE_SRC)
 MESSAGE("*******************")
 MESSAGE("*******************")

Modified: branches/avidemux_2.4_branch/config.h.cmake
===================================================================
--- branches/avidemux_2.4_branch/config.h.cmake	2007-07-06 01:03:19 UTC (rev 3336)
+++ branches/avidemux_2.4_branch/config.h.cmake	2007-07-06 10:08:22 UTC (rev 3337)
@@ -489,6 +489,9 @@
 /* libpng is available */
 #cmakedefine USE_PNG
 
+/* use libsamplerate */
+#cmakedefine USE_SRC
+
 /* SDL detected */
 #cmakedefine USE_SDL
 



From gruntster at mail.berlios.de  Fri Jul  6 16:54:58 2007
From: gruntster at mail.berlios.de (gruntster at mail.berlios.de)
Date: Fri, 6 Jul 2007 16:54:58 +0200
Subject: [Avidemux-svn-commit] r3338 -
	branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui
Message-ID: <200707061454.l66EswJj024646@sheep.berlios.de>

Author: gruntster
Date: 2007-07-06 16:54:51 +0200 (Fri, 06 Jul 2007)
New Revision: 3338

Modified:
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/T_preview.cpp
Log:
position the SDL playback window correctly for Qt4 (Win32)

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/T_preview.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/T_preview.cpp	2007-07-06 10:08:22 UTC (rev 3337)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/T_preview.cpp	2007-07-06 14:54:51 UTC (rev 3338)
@@ -201,13 +201,13 @@
 */
 void UI_getWindowInfo(void *draw, GUI_WindowInfo *xinfo)
 {
-#if !defined(ADM_WIN32) && !defined(__APPLE__)
-        const QX11Info &info=videoWindow->x11Info();
-        xinfo->display=info.display();
-        xinfo->window=videoWindow->winId();
-         
+#if defined(ADM_WIN32)
+	xinfo->display=videoWindow->winId();
+#elif !defined(__APPLE__)
+    const QX11Info &info=videoWindow->x11Info();
+    xinfo->display=info.display();
+    xinfo->window=videoWindow->winId();
 #endif 
-
 }
 
 



From mean at mail.berlios.de  Fri Jul  6 21:59:15 2007
From: mean at mail.berlios.de (mean at BerliOS)
Date: Fri, 6 Jul 2007 21:59:15 +0200
Subject: [Avidemux-svn-commit] r3339 -
	branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2
Message-ID: <200707061959.l66JxFv9026517@sheep.berlios.de>

Author: mean
Date: 2007-07-06 21:59:14 +0200 (Fri, 06 Jul 2007)
New Revision: 3339

Modified:
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_bindings.cpp
Log:
JM jogshuttle, now working :)

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_bindings.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_bindings.cpp	2007-07-06 14:54:51 UTC (rev 3338)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_bindings.cpp	2007-07-06 19:59:14 UTC (rev 3339)
@@ -75,7 +75,7 @@
 static GdkCursor *guiCursorBusy=NULL;
 static GdkCursor *guiCursorNormal=NULL;
 static gint	  guiCursorEvtMask=0;
-static void     volumeChange( void );
+static gint       jogChange( void );
 
 static char     *customNames[ADM_MAC_CUSTOM_SCRIPT];
 static uint32_t ADM_nbCustom=0;
@@ -332,7 +332,7 @@
         
         // Jog
         gtk_signal_connect(GTK_OBJECT(lookup_widget(guiRootWindow,"jogg")), "value_changed",   
-                      GTK_SIGNAL_FUNC(volumeChange),                   (void *) NULL);  
+                      GTK_SIGNAL_FUNC(jogChange),                   (void *) NULL);  
 
 
 		       
@@ -561,11 +561,6 @@
    
 }
 
-void volumeChange( void )
-{
-    HandleAction(ACT_JOG);    
-
-}
 /**
     \fn UI_readJog
     \brief Returns value of jog
@@ -577,7 +572,7 @@
 
         wid=lookup_widget(guiRootWindow,"jogg");
         val=jog_shuttle_get_value(wid);
-        printf("Jog : %f\n",val);
+        //printf("Jog : %f\n",val);
         val=val*100;
         return (int32_t )val;
         
@@ -1145,5 +1140,109 @@
     automation();
     gdk_threads_leave();
 }
+/*****************************/
+/*
+ * This is the wheel position <->time array
+ * */
+static uint32_t jogScale[10]={
+50,
+50,
+40,
+40,
+20,
+20,  // 5
+10,
+5,
+3,
+2
+};
+static int nbTimer=0;
+static int jogLock=0;
+static int count=0;
+/**
+        \fn tickToTime
+        \brief  convert tick (i.e. wheel value) between 0 and 9  to a number of tick to wait in 10 ms units. Should be exp/log TODO
+  */
+static uint32_t tickToTime(uint32_t tick)
+{
+        if(tick>9) tick=9;
+        return jogScale[tick];
+}
+/**
+                \fn jogTimer
+                \brief Function that is called every 10 ms and handle the fwd/bwd depending on wheel position
+ */
+static int jogTimer(void)
+{
+   int32_t v;
+   uint32_t r;
+    v=UI_readJog();
+    r=abs(v);
+    r=r/10;
+    if(!r)
+    {
+      return FALSE;
+    }
+    //printf("Arm %u\n",count);
+    if(count)     count--;
+    if(count)     return TRUE;
+    count=tickToTime(r);
+    if(jogLock) return FALSE;
+    
+    jogLock++;
+ //   printf("Arm Call\n");
+    gdk_threads_enter();
+    if(v>0) 
+         g_signal_emit_by_name (GTK_OBJECT (lookup_widget(guiRootWindow,"next_intra_frame1")), "activate",G_TYPE_NONE );
+      else  
+        g_signal_emit_by_name (GTK_OBJECT (lookup_widget(guiRootWindow,"previous_intra_frame1")), "activate",G_TYPE_NONE );
+      gdk_threads_leave();
+    jogLock--;
+      return TRUE;
+}
+/**
+ *      \fn jogDel
+ *      \brief Called when timer is deleted
+*/
+void jogDel(void *)
+{
+      nbTimer=0;
+      count=0;
+//      printf("Arm off\n");
+}
+/**
+ *      \fn jogChange
+ *      \brief Handler for wheel value changed event
+ * */
+gint jogChange(void)
+{
+  int32_t v;
+   uint32_t r;
+   if(nbTimer) return FALSE; // Already armed
+   
+   // Process First move
+      v=UI_readJog()/10;
+      r=abs(v);
+      if(!r)
+      {
+        return FALSE;
+      }
+      if(!jogLock)
+      {
+        jogLock++;
+        if(v>0) 
+          gtk_signal_emit_by_name (GTK_OBJECT (lookup_widget(guiRootWindow,"next_intra_frame1")), "activate" );
+          
+        else  
+          gtk_signal_emit_by_name (GTK_OBJECT (lookup_widget(guiRootWindow,"previous_intra_frame1")), "activate" );
+        jogLock--;
+        nbTimer=1;
+        count=0;//tickToTime(r);
+        g_timeout_add_full(G_PRIORITY_DEFAULT,10,(GCALL *)jogTimer,NULL,jogDel);
 
+      }      
+   // Armed!
+   return FALSE;
+}
+
 // EOF



From mean at mail.berlios.de  Sat Jul  7 08:40:30 2007
From: mean at mail.berlios.de (mean at BerliOS)
Date: Sat, 7 Jul 2007 08:40:30 +0200
Subject: [Avidemux-svn-commit] r3340 - in
	branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK:
	ADM_gui2 glade
Message-ID: <200707070640.l676eUi6004338@sheep.berlios.de>

Author: mean
Date: 2007-07-07 08:40:29 +0200 (Sat, 07 Jul 2007)
New Revision: 3340

Modified:
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/patch.bash
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/glade/gtk2_build.glade
Log:
glade file + JM patch

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp	2007-07-06 19:59:14 UTC (rev 3339)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp	2007-07-07 06:40:29 UTC (rev 3340)
@@ -14,10 +14,9 @@
 
 #include <gdk/gdkkeysyms.h>
 #include <gtk/gtk.h>
-#include "../ADM_toolkit_gtk/jogshuttle.h"
 
 #include "../ADM_toolkit_gtk/ADM_gladeSupport.h"
-
+#include "../ADM_toolkit_gtk/jogshuttle.h"
 #include "../ADM_toolkit_gtk/gtkmarkscale.h"
 
 #define GLADE_HOOKUP_OBJECT(component,widget,name) \
@@ -1426,11 +1425,11 @@
   GTK_WIDGET_SET_FLAGS (labelFrameType, GTK_CAN_FOCUS);
   gtk_label_set_selectable (GTK_LABEL (labelFrameType), TRUE);
 
-  jogg = jog_shuttle_new ();
+  jogg = jog_shuttle_new ();gtk_widget_set_size_request (jogg, -1, 16); 
   gtk_widget_show (jogg);
   gtk_table_attach (GTK_TABLE (table2), jogg, 1, 2, 0, 1,
                     (GtkAttachOptions) (GTK_FILL),
-                    (GtkAttachOptions) (GTK_FILL), 0, 0);
+                    (GtkAttachOptions) (GTK_EXPAND | GTK_FILL), 0, 0);
   GTK_WIDGET_UNSET_FLAGS (jogg, GTK_CAN_FOCUS);
   GTK_WIDGET_UNSET_FLAGS (jogg, GTK_CAN_DEFAULT);
 

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/patch.bash
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/patch.bash	2007-07-06 19:59:14 UTC (rev 3339)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/patch.bash	2007-07-07 06:40:29 UTC (rev 3340)
@@ -1,8 +1,8 @@
 cat GUI_main2.cpp | sed 's/, 0,$/, (GdkModifierType) 0,/g' | sed 's/-2/-1/g' | sed 's/GtkAccelGroup \*/extern GtkAccelGroup */' | sed 's/(GdkModifierType)/(GdkModifierType)(/g' | sed 's/MASK,$/MASK\),/g' |sed 's/( 0,$/( 0 ),/g' | \
 sed 's/sliderNavigate = gtk_hscale_new/sliderNavigate = gtk_markscale_new/' | \
-sed 's/jog_shuttle_new ("jogg", "", "", 0, 0);/jog_shuttle_new ();/' | \
+sed 's/jog_shuttle_new ("jogg", "", "", 0, 0);/jog_shuttle_new ();gtk_widget_set_size_request (jogg, -1, 16); /' | \
 sed 's/gtk_widget_show (sliderNavigate);/gtk_widget_show (sliderNavigate);gtk_scale_set_draw_value (GTK_SCALE (sliderNavigate), FALSE);/' |\
-sed 's/#include "interface.h"//' |\
+sed 's/#include "interface.h"/#include "..\/ADM_toolkit_gtk\/jogshuttle.h"/' |\
 sed 's/#include "support.h"/#include "..\/ADM_toolkit_gtk\/gtkmarkscale.h"/' |\
 sed 's/#include "callbacks.h"/#include "..\/ADM_toolkit_gtk\/ADM_gladeSupport.h"/' \
 > GUI_main2.p

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/glade/gtk2_build.glade
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/glade/gtk2_build.glade	2007-07-06 19:59:14 UTC (rev 3339)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/glade/gtk2_build.glade	2007-07-07 06:40:29 UTC (rev 3340)
@@ -50,7 +50,7 @@
 		      <accelerator key="O" modifiers="GDK_CONTROL_MASK" signal="activate"/>
 
 		      <child internal-child="image">
-			<widget class="GtkImage" id="image8221">
+			<widget class="GtkImage" id="image8196">
 			  <property name="visible">True</property>
 			  <property name="stock">gtk-open</property>
 			  <property name="icon_size">1</property>
@@ -71,7 +71,7 @@
 		      <accelerator key="A" modifiers="GDK_CONTROL_MASK | GDK_MOD1_MASK" signal="activate"/>
 
 		      <child internal-child="image">
-			<widget class="GtkImage" id="image8222">
+			<widget class="GtkImage" id="image8197">
 			  <property name="visible">True</property>
 			  <property name="stock">gtk-add</property>
 			  <property name="icon_size">1</property>
@@ -91,7 +91,7 @@
 		      <property name="use_underline">True</property>
 
 		      <child internal-child="image">
-			<widget class="GtkImage" id="image8223">
+			<widget class="GtkImage" id="image8198">
 			  <property name="visible">True</property>
 			  <property name="stock">gtk-save</property>
 			  <property name="icon_size">1</property>
@@ -169,7 +169,7 @@
 		      <property name="use_underline">True</property>
 
 		      <child internal-child="image">
-			<widget class="GtkImage" id="image8224">
+			<widget class="GtkImage" id="image8199">
 			  <property name="visible">True</property>
 			  <property name="stock">gtk-save</property>
 			  <property name="icon_size">1</property>
@@ -189,7 +189,7 @@
 		      <property name="use_underline">True</property>
 
 		      <child internal-child="image">
-			<widget class="GtkImage" id="image8225">
+			<widget class="GtkImage" id="image8200">
 			  <property name="visible">True</property>
 			  <property name="stock">gtk-save-as</property>
 			  <property name="icon_size">1</property>
@@ -209,7 +209,7 @@
 		      <property name="use_underline">True</property>
 
 		      <child internal-child="image">
-			<widget class="GtkImage" id="image8226">
+			<widget class="GtkImage" id="image8201">
 			  <property name="visible">True</property>
 			  <property name="stock">gtk-execute</property>
 			  <property name="icon_size">1</property>
@@ -267,7 +267,7 @@
 		      <accelerator key="Return" modifiers="GDK_MOD1_MASK" signal="activate"/>
 
 		      <child internal-child="image">
-			<widget class="GtkImage" id="image8227">
+			<widget class="GtkImage" id="image8202">
 			  <property name="visible">True</property>
 			  <property name="stock">gtk-properties</property>
 			  <property name="icon_size">1</property>
@@ -302,7 +302,7 @@
 		      <accelerator key="Q" modifiers="GDK_CONTROL_MASK" signal="activate"/>
 
 		      <child internal-child="image">
-			<widget class="GtkImage" id="image8228">
+			<widget class="GtkImage" id="image8203">
 			  <property name="visible">True</property>
 			  <property name="stock">gtk-quit</property>
 			  <property name="icon_size">1</property>
@@ -335,7 +335,7 @@
 		      <property name="use_underline">True</property>
 
 		      <child internal-child="image">
-			<widget class="GtkImage" id="image8229">
+			<widget class="GtkImage" id="image8204">
 			  <property name="visible">True</property>
 			  <property name="stock">gtk-undo</property>
 			  <property name="icon_size">1</property>
@@ -362,7 +362,7 @@
 		      <accelerator key="X" modifiers="GDK_CONTROL_MASK" signal="activate"/>
 
 		      <child internal-child="image">
-			<widget class="GtkImage" id="image8230">
+			<widget class="GtkImage" id="image8205">
 			  <property name="visible">True</property>
 			  <property name="stock">gtk-cut</property>
 			  <property name="icon_size">1</property>
@@ -383,7 +383,7 @@
 		      <accelerator key="C" modifiers="GDK_CONTROL_MASK" signal="activate"/>
 
 		      <child internal-child="image">
-			<widget class="GtkImage" id="image8231">
+			<widget class="GtkImage" id="image8206">
 			  <property name="visible">True</property>
 			  <property name="stock">gtk-copy</property>
 			  <property name="icon_size">1</property>
@@ -404,7 +404,7 @@
 		      <accelerator key="V" modifiers="GDK_CONTROL_MASK" signal="activate"/>
 
 		      <child internal-child="image">
-			<widget class="GtkImage" id="image8232">
+			<widget class="GtkImage" id="image8207">
 			  <property name="visible">True</property>
 			  <property name="stock">gtk-paste</property>
 			  <property name="icon_size">1</property>
@@ -425,7 +425,7 @@
 		      <accelerator key="Delete" modifiers="0" signal="activate"/>
 
 		      <child internal-child="image">
-			<widget class="GtkImage" id="image8233">
+			<widget class="GtkImage" id="image8208">
 			  <property name="visible">True</property>
 			  <property name="stock">gtk-remove</property>
 			  <property name="icon_size">1</property>
@@ -475,7 +475,7 @@
 		      <property name="use_underline">True</property>
 
 		      <child internal-child="image">
-			<widget class="GtkImage" id="image8234">
+			<widget class="GtkImage" id="image8209">
 			  <property name="visible">True</property>
 			  <property name="stock">gtk-preferences</property>
 			  <property name="icon_size">1</property>
@@ -711,7 +711,7 @@
 		      <accelerator key="S" modifiers="GDK_CONTROL_MASK | GDK_MOD1_MASK" signal="activate"/>
 
 		      <child internal-child="image">
-			<widget class="GtkImage" id="image8235">
+			<widget class="GtkImage" id="image8210">
 			  <property name="visible">True</property>
 			  <property name="stock">gtk-save-as</property>
 			  <property name="icon_size">1</property>
@@ -762,7 +762,7 @@
 		      <accelerator key="F7" modifiers="0" signal="activate"/>
 
 		      <child internal-child="image">
-			<widget class="GtkImage" id="image8236">
+			<widget class="GtkImage" id="image8211">
 			  <property name="visible">True</property>
 			  <property name="pixbuf">gnome-calculator_small.xpm</property>
 			  <property name="xalign">0.5</property>
@@ -922,7 +922,7 @@
 		      <accelerator key="P" modifiers="0" signal="activate"/>
 
 		      <child internal-child="image">
-			<widget class="GtkImage" id="image8237">
+			<widget class="GtkImage" id="image8212">
 			  <property name="visible">True</property>
 			  <property name="stock">gtk-media-play</property>
 			  <property name="icon_size">1</property>
@@ -943,7 +943,7 @@
 		      <accelerator key="KP_4" modifiers="0" signal="activate"/>
 
 		      <child internal-child="image">
-			<widget class="GtkImage" id="image8238">
+			<widget class="GtkImage" id="image8213">
 			  <property name="visible">True</property>
 			  <property name="stock">gtk-media-previous</property>
 			  <property name="icon_size">1</property>
@@ -964,7 +964,7 @@
 		      <accelerator key="KP_6" modifiers="0" signal="activate"/>
 
 		      <child internal-child="image">
-			<widget class="GtkImage" id="image8239">
+			<widget class="GtkImage" id="image8214">
 			  <property name="visible">True</property>
 			  <property name="stock">gtk-media-next</property>
 			  <property name="icon_size">1</property>
@@ -985,7 +985,7 @@
 		      <accelerator key="KP_2" modifiers="0" signal="activate"/>
 
 		      <child internal-child="image">
-			<widget class="GtkImage" id="image8240">
+			<widget class="GtkImage" id="image8215">
 			  <property name="visible">True</property>
 			  <property name="stock">gtk-media-rewind</property>
 			  <property name="icon_size">1</property>
@@ -1006,7 +1006,7 @@
 		      <accelerator key="KP_8" modifiers="0" signal="activate"/>
 
 		      <child internal-child="image">
-			<widget class="GtkImage" id="image8241">
+			<widget class="GtkImage" id="image8216">
 			  <property name="visible">True</property>
 			  <property name="stock">gtk-media-forward</property>
 			  <property name="icon_size">1</property>
@@ -1043,7 +1043,7 @@
 		      <accelerator key="Home" modifiers="0" signal="activate"/>
 
 		      <child internal-child="image">
-			<widget class="GtkImage" id="image8242">
+			<widget class="GtkImage" id="image8217">
 			  <property name="visible">True</property>
 			  <property name="stock">gtk-goto-first</property>
 			  <property name="icon_size">1</property>
@@ -1064,7 +1064,7 @@
 		      <accelerator key="End" modifiers="0" signal="activate"/>
 
 		      <child internal-child="image">
-			<widget class="GtkImage" id="image8243">
+			<widget class="GtkImage" id="image8218">
 			  <property name="visible">True</property>
 			  <property name="stock">gtk-goto-last</property>
 			  <property name="icon_size">1</property>
@@ -1110,12 +1110,12 @@
 		  <child>
 		    <widget class="GtkImageMenuItem" id="jum_to_frame1">
 		      <property name="visible">True</property>
-		      <property name="label" translatable="yes">Go to Fra_me...</property>
+		      <property name="label" translatable="yes">_Jump to Frame...</property>
 		      <property name="use_underline">True</property>
 		      <accelerator key="F" modifiers="GDK_CONTROL_MASK" signal="activate"/>
 
 		      <child internal-child="image">
-			<widget class="GtkImage" id="image8244">
+			<widget class="GtkImage" id="image8219">
 			  <property name="visible">True</property>
 			  <property name="stock">gtk-jump-to</property>
 			  <property name="icon_size">1</property>
@@ -1131,12 +1131,12 @@
 		  <child>
 		    <widget class="GtkImageMenuItem" id="jump_to_time1">
 		      <property name="visible">True</property>
-		      <property name="label" translatable="yes">Go to _Time...</property>
+		      <property name="label" translatable="yes">Jump to _Time...</property>
 		      <property name="use_underline">True</property>
 		      <accelerator key="T" modifiers="GDK_CONTROL_MASK" signal="activate"/>
 
 		      <child internal-child="image">
-			<widget class="GtkImage" id="image8245">
+			<widget class="GtkImage" id="image8220">
 			  <property name="visible">True</property>
 			  <property name="stock">gtk-jump-to</property>
 			  <property name="icon_size">1</property>
@@ -1185,7 +1185,7 @@
 		      <property name="use_underline">True</property>
 
 		      <child internal-child="image">
-			<widget class="GtkImage" id="image8246">
+			<widget class="GtkImage" id="image8221">
 			  <property name="visible">True</property>
 			  <property name="stock">gtk-about</property>
 			  <property name="icon_size">1</property>
@@ -2324,26 +2324,6 @@
 	      </child>
 
 	      <child>
-		<widget class="GtkHScale" id="hscaleSensitive">
-		  <property name="visible">True</property>
-		  <property name="can_focus">True</property>
-		  <property name="draw_value">False</property>
-		  <property name="value_pos">GTK_POS_RIGHT</property>
-		  <property name="digits">0</property>
-		  <property name="update_policy">GTK_UPDATE_CONTINUOUS</property>
-		  <property name="inverted">False</property>
-		  <property name="adjustment">62.2950819672 0 100 5 5 5</property>
-		</widget>
-		<packing>
-		  <property name="left_attach">1</property>
-		  <property name="right_attach">2</property>
-		  <property name="top_attach">0</property>
-		  <property name="bottom_attach">1</property>
-		  <property name="x_options">fill</property>
-		</packing>
-	      </child>
-
-	      <child>
 		<widget class="GtkHBox" id="hbox16">
 		  <property name="visible">True</property>
 		  <property name="homogeneous">False</property>
@@ -2399,7 +2379,7 @@
 		    <widget class="GtkLabel" id="labelTotalFrame">
 		      <property name="visible">True</property>
 		      <property name="can_focus">True</property>
-		      <property name="label" translatable="yes">/ 0000000</property>
+		      <property name="label" translatable="yes">/0000000</property>
 		      <property name="use_underline">False</property>
 		      <property name="use_markup">False</property>
 		      <property name="justify">GTK_JUSTIFY_LEFT</property>
@@ -2471,7 +2451,7 @@
 		    <widget class="GtkLabel" id="labelTotalTime">
 		      <property name="visible">True</property>
 		      <property name="can_focus">True</property>
-		      <property name="label" translatable="yes">/ 00:00:00,000</property>
+		      <property name="label" translatable="yes">/00:00:00,000</property>
 		      <property name="use_underline">False</property>
 		      <property name="use_markup">False</property>
 		      <property name="justify">GTK_JUSTIFY_LEFT</property>
@@ -2527,6 +2507,23 @@
 		  <property name="y_options"></property>
 		</packing>
 	      </child>
+
+	      <child>
+		<widget class="Custom" id="jogg">
+		  <property name="visible">True</property>
+		  <property name="creation_function">jog_shuttle_new</property>
+		  <property name="int1">0</property>
+		  <property name="int2">0</property>
+		  <property name="last_modification_time">Wed, 04 Jul 2007 18:33:02 GMT</property>
+		</widget>
+		<packing>
+		  <property name="left_attach">1</property>
+		  <property name="right_attach">2</property>
+		  <property name="top_attach">0</property>
+		  <property name="bottom_attach">1</property>
+		  <property name="x_options">fill</property>
+		</packing>
+	      </child>
 	    </widget>
 	    <packing>
 	      <property name="padding">0</property>



From gruntster at mail.berlios.de  Sat Jul  7 18:05:59 2007
From: gruntster at mail.berlios.de (gruntster at mail.berlios.de)
Date: Sat, 7 Jul 2007 18:05:59 +0200
Subject: [Avidemux-svn-commit] r3341 -
	branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI
Message-ID: <200707071605.l67G5xrZ015412@sheep.berlios.de>

Author: gruntster
Date: 2007-07-07 18:05:52 +0200 (Sat, 07 Jul 2007)
New Revision: 3341

Modified:
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/GUI_sdlRender.cpp
Log:
attempt 32 bit colour depth rather than just 16 bit for SDL playback

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/GUI_sdlRender.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/GUI_sdlRender.cpp	2007-07-07 06:40:29 UTC (rev 3340)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/GUI_sdlRender.cpp	2007-07-07 16:05:52 UTC (rev 3341)
@@ -121,7 +121,7 @@
 
     sdl_running=1;
     flags = SDL_ANYFORMAT | SDL_HWPALETTE | SDL_HWSURFACE | SDL_NOFRAME;
-    bpp= SDL_VideoModeOK( w, h,  16, flags );
+    bpp= SDL_VideoModeOK( w, h,  32, flags );
 
 #ifdef ADM_WIN32
 	// SDL window is created and displayed before we get a chance to set the parent.



From gruntster at mail.berlios.de  Sat Jul  7 19:08:05 2007
From: gruntster at mail.berlios.de (gruntster at mail.berlios.de)
Date: Sat, 7 Jul 2007 19:08:05 +0200
Subject: [Avidemux-svn-commit] r3342 -
	branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI
Message-ID: <200707071708.l67H85GI031416@sheep.berlios.de>

Author: gruntster
Date: 2007-07-07 19:07:57 +0200 (Sat, 07 Jul 2007)
New Revision: 3342

Modified:
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/GUI_sdlRender.cpp
Log:
prevent SDL window from stealing focus on playback or if clicked on (Win32)

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/GUI_sdlRender.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/GUI_sdlRender.cpp	2007-07-07 16:05:52 UTC (rev 3341)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/GUI_sdlRender.cpp	2007-07-07 17:07:57 UTC (rev 3342)
@@ -153,8 +153,18 @@
 	if (-1 != SDL_GetWMInfo(&wmInfo))
 	{
 		sdlWin32 = wmInfo.window;
-		SetParent(sdlWin32,(HWND) window->display);
-		MoveWindow(sdlWin32,0,0,w,h,0);
+
+		// Make SDL window a child to prevent it from gaining focus
+		int windowFlags = GetWindowLongPtr(sdlWin32, GWL_STYLE);
+
+		SetWindowLongPtr(sdlWin32, GWL_STYLE, (windowFlags & ~WS_POPUP) | WS_CHILD);
+
+		// Set the SDL window's parent to the main window and reposition
+		SetParent(sdlWin32, (HWND)window->display);
+		SetWindowPos(sdlWin32, NULL, 0, 0, 0, 0, SWP_NOSIZE | SWP_NOZORDER);
+
+		// The SDL window stole focus before it was made a child, so set focus back to the main window
+		SetFocus((HWND)window->display);
 	}
 	else
 	{



From mean at mail.berlios.de  Sat Jul  7 20:38:04 2007
From: mean at mail.berlios.de (mean at BerliOS)
Date: Sat, 7 Jul 2007 20:38:04 +0200
Subject: [Avidemux-svn-commit] r3343 -
	branches/avidemux_2.4_branch/avidemux/ADM_inputs/ADM_matroska
Message-ID: <200707071838.l67Ic4SB003322@sheep.berlios.de>

Author: mean
Date: 2007-07-07 20:38:03 +0200 (Sat, 07 Jul 2007)
New Revision: 3343

Modified:
   branches/avidemux_2.4_branch/avidemux/ADM_inputs/ADM_matroska/ADM_ebml.h
   branches/avidemux_2.4_branch/avidemux/ADM_inputs/ADM_matroska/ADM_mkvIndexer.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_inputs/ADM_matroska/ADM_mkv_audio.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_inputs/ADM_matroska/ebml.cpp
Log:
[MKV] some cosmetics : progress bar when indexing clusters, use DIA_working + dont trust header in case of AC3 and extract infos from the actual stream

Modified: branches/avidemux_2.4_branch/avidemux/ADM_inputs/ADM_matroska/ADM_ebml.h
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_inputs/ADM_matroska/ADM_ebml.h	2007-07-07 17:07:57 UTC (rev 3342)
+++ branches/avidemux_2.4_branch/avidemux/ADM_inputs/ADM_matroska/ADM_ebml.h	2007-07-07 18:38:03 UTC (rev 3343)
@@ -62,6 +62,7 @@
                     uint64_t  tell(void);
                     uint8_t   seek(uint64_t pos);
                     uint8_t   finished(void);
+                    uint64_t  getFileSize(void) {return _size;};
                     uint8_t   find(ADM_MKV_SEARCHTYPE search,
                                         MKV_ELEM_ID  prim,MKV_ELEM_ID second,uint32_t *len,uint32_t rewind=1);
                     uint8_t   simplefind(MKV_ELEM_ID  prim,uint32_t *len,uint32_t rewind=1);

Modified: branches/avidemux_2.4_branch/avidemux/ADM_inputs/ADM_matroska/ADM_mkvIndexer.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_inputs/ADM_matroska/ADM_mkvIndexer.cpp	2007-07-07 17:07:57 UTC (rev 3342)
+++ branches/avidemux_2.4_branch/avidemux/ADM_inputs/ADM_matroska/ADM_mkvIndexer.cpp	2007-07-07 18:38:03 UTC (rev 3343)
@@ -31,6 +31,7 @@
 
 #include "mkv_tags.h"
 #include "ADM_userInterfaces/ADM_commonUI/DIA_idx_pg.h"
+#include "ADM_userInterfaces/ADM_commonUI/DIA_working.h"
 #define VIDEO _tracks[0]
 /**
     \fn videoIndexer
@@ -45,7 +46,7 @@
   const char *ss;
   
    parser->seek(0);
-   DIA_progressIndexing *work=new DIA_progressIndexing("Matroska Images");
+   DIA_working *work=new DIA_working("Matroska Images");
    // Start with a small index, it will grow automatically afterward
    for(int i=0;i<_nbAudioTrack+1;i++)
    {
@@ -53,7 +54,7 @@
     _tracks[i]._index=new mkvIndex[_tracks[i]._indexMax];
    }
     //************
-   work->update(0,_nbClusters,0,0,0,0);
+   work->update(0);
    for(int clusters=0;clusters<_nbClusters;clusters++)
    {
    parser->seek(_clusters[clusters].pos);
@@ -61,7 +62,7 @@
    int thiscluster=0;
    while(!cluster.finished())
    {
-      work->update(clusters,_nbClusters,VIDEO._nbIndex,0,0,0);
+      work->update(clusters,_nbClusters);
       cluster.readElemId(&id,&len);
       if(!ADM_searchMkvTag( (MKV_ELEM_ID)id,&ss,&type))
       {
@@ -403,22 +404,19 @@
   _nbClusters=0;
   
   // Search segment
-   
-   parser->seek(0x7000000000LL); //Hackish, fixme
-   fileSize=parser->tell();
-   parser->seek(0);
-   
+   fileSize=parser->getFileSize();
    if(!parser->simplefind(MKV_SEGMENT,&vlen,1))
    {
      printf("[MKV] cluster indexer, cannot find CLUSTER atom\n");
      return 0;
    }
    ADM_ebml_file segment(parser,vlen);
-   DIA_progressIndexing *work=new DIA_progressIndexing("Matroska clusters");
+   DIA_working *work=new DIA_working("Matroska clusters");
    while(segment.simplefind(MKV_CLUSTER,&alen,0)) 
    {
+     
      // UI update
-     work->update(segment.tell()>>10,fileSize>>10,_nbClusters,0,0,0);
+     work->update(segment.tell()>>10,fileSize>>10);
      // Grow clusters index if needed
      if(_nbClusters==_clustersCeil-1)
      {

Modified: branches/avidemux_2.4_branch/avidemux/ADM_inputs/ADM_matroska/ADM_mkv_audio.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_inputs/ADM_matroska/ADM_mkv_audio.cpp	2007-07-07 17:07:57 UTC (rev 3342)
+++ branches/avidemux_2.4_branch/avidemux/ADM_inputs/ADM_matroska/ADM_mkv_audio.cpp	2007-07-07 18:38:03 UTC (rev 3343)
@@ -28,7 +28,7 @@
 #include "ADM_toolkit/toolkit.hxx"
 
 #include "ADM_mkv.h"
-
+#include "ADM_audio/ADM_a52info.h"
 #define vprintf(...) {}
 
 /**
@@ -303,6 +303,23 @@
   _currentLace=_maxLace=0;
   _clusterParser=NULL;
   goToCluster(0);
+  /* In case of AC3, do not trust the header...*/
+  if(_wavheader->encoding==WAV_AC3)
+  {
+    uint8_t ac3Buffer[20000];
+    uint32_t len,sample,timecode;
+     if( getPacket(ac3Buffer, &len, &sample,&timecode))
+     {
+       uint32_t fq,br,chan,syncoff;
+        if( ADM_AC3GetInfo(ac3Buffer, len, &fq, &br, &chan,&syncoff) )
+        {
+            _wavheader->channels=chan;
+            _wavheader->frequency=fq;
+            _wavheader->byterate=br;
+        }
+     }
+     goToCluster(0);
+  }
 }
 /**
     \fn goToCluster

Modified: branches/avidemux_2.4_branch/avidemux/ADM_inputs/ADM_matroska/ebml.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_inputs/ADM_matroska/ebml.cpp	2007-07-07 17:07:57 UTC (rev 3342)
+++ branches/avidemux_2.4_branch/avidemux/ADM_inputs/ADM_matroska/ebml.cpp	2007-07-07 18:38:03 UTC (rev 3343)
@@ -361,7 +361,7 @@
   const char *ss;
   
 
-    printf("[MKV] Simple Searching for tag %llx\n",prim);
+    vprintf("[MKV] Simple Searching for tag %llx\n",prim);
     if(rewind) seek(_begin);
    
       while(!finished())



From mean at mail.berlios.de  Sat Jul  7 22:54:56 2007
From: mean at mail.berlios.de (mean at BerliOS)
Date: Sat, 7 Jul 2007 22:54:56 +0200
Subject: [Avidemux-svn-commit] r3344 - in
	branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK:
	ADM_gui2 glade
Message-ID: <200707072054.l67KsuIb009869@sheep.berlios.de>

Author: mean
Date: 2007-07-07 22:54:55 +0200 (Sat, 07 Jul 2007)
New Revision: 3344

Modified:
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/glade/gtk2_build.glade
Log:
fix EXPAND/FILL

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp	2007-07-07 18:38:03 UTC (rev 3343)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp	2007-07-07 20:54:55 UTC (rev 3344)
@@ -1429,7 +1429,7 @@
   gtk_widget_show (jogg);
   gtk_table_attach (GTK_TABLE (table2), jogg, 1, 2, 0, 1,
                     (GtkAttachOptions) (GTK_FILL),
-                    (GtkAttachOptions) (GTK_EXPAND | GTK_FILL), 0, 0);
+                    (GtkAttachOptions) (GTK_EXPAND), 0, 0);
   GTK_WIDGET_UNSET_FLAGS (jogg, GTK_CAN_FOCUS);
   GTK_WIDGET_UNSET_FLAGS (jogg, GTK_CAN_DEFAULT);
 

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/glade/gtk2_build.glade
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/glade/gtk2_build.glade	2007-07-07 18:38:03 UTC (rev 3343)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/glade/gtk2_build.glade	2007-07-07 20:54:55 UTC (rev 3344)
@@ -2522,6 +2522,7 @@
 		  <property name="top_attach">0</property>
 		  <property name="bottom_attach">1</property>
 		  <property name="x_options">fill</property>
+		  <property name="y_options">expand</property>
 		</packing>
 	      </child>
 	    </widget>



From mean at mail.berlios.de  Sun Jul  8 15:40:14 2007
From: mean at mail.berlios.de (mean at BerliOS)
Date: Sun, 8 Jul 2007 15:40:14 +0200
Subject: [Avidemux-svn-commit] r3345 -
	branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_ocr
Message-ID: <200707081340.l68DeEvN006492@sheep.berlios.de>

Author: mean
Date: 2007-07-08 15:40:14 +0200 (Sun, 08 Jul 2007)
New Revision: 3345

Added:
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_ocr/adm_sup.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_ocr/adm_sup.h
Log:
some stuff for projectX subs

Added: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_ocr/adm_sup.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_ocr/adm_sup.cpp	2007-07-07 20:54:55 UTC (rev 3344)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_ocr/adm_sup.cpp	2007-07-08 13:40:14 UTC (rev 3345)
@@ -0,0 +1,455 @@
+#include "config.h"
+#include <stdio.h>
+#include <stdlib.h>
+#include <string.h>
+#include "gtk/gtk.h"
+#include <ADM_assert.h>
+
+
+#include "fourcc.h"
+#include "avio.hxx"
+#include "config.h"
+#include "avi_vars.h"
+
+//#include "unistd.h"
+
+#include "ADM_toolkit/toolkit.hxx"
+#include "../ADM_GTK/ADM_toolkit_gtk/toolkit_gtk.h"
+#include "../ADM_GTK/ADM_toolkit_gtk/toolkit_gtk_include.h"
+#include "ADM_editor/ADM_edit.hxx"
+#include "ADM_video/ADM_genvideo.hxx"
+#include "ADM_filter/video_filters.h"
+
+#include "ADM_toolkit/toolkit.hxx"
+#include "ADM_editor/ADM_edit.hxx"
+#include "ADM_video/ADM_genvideo.hxx"
+#include "ADM_filter/video_filters.h"
+
+
+#include "ADM_toolkit/filesel.h"
+
+#include "ADM_colorspace/colorspace.h"
+
+#include "ADM_video/ADM_vobsubinfo.h"
+
+#include "ADM_video/ADM_vidVobSub.h"
+#include "ADM_leftturn.h"
+#include "DIA_enter.h"
+#include "adm_sup.h"
+
+static uint32_t pal[16]={ 0x00000, 0xFFFFFF, 0xFFFFFF, 0xFFFFFF, 
+                          0xFFFFFF, 0xFFFFFF, 0xFFFFFF, 0xFFFFFF, 
+                          0xFFFFFF, 0xFFFFFF, 0xFFFFFF, 0xFFFFFF, 
+                          0xFFFFFF, 0x303030, 0xFFFFFF, 0xFFFFFF
+};
+
+SUPIndexArray::SUPIndexArray(uint32_t nb)
+{
+    indexCeil=nb;
+    nbIndex=0;
+    index=new SUPIndex[nb];
+}
+SUPIndexArray::~SUPIndexArray()
+{
+  if(index) delete [] index;
+  index=NULL; 
+}
+
+uint32_t SUPIndexArray::insert(uint32_t pos, uint32_t size, uint32_t pts)
+{
+  if(nbIndex==indexCeil-1) // grow
+  {
+      SUPIndex *sup=new SUPIndex[indexCeil*2];
+      memcpy(sup,index,sizeof(SUPIndex)*indexCeil);
+      delete [] index;
+      index=sup;
+      indexCeil*=2;
+  }
+  SUPIndex *idx=&(index[nbIndex]);
+  idx->pos=pos;
+  idx->size=size;
+  idx->pts=pts;
+  nbIndex++;
+  return 1;
+}
+
+//**************************************************************
+
+ADMVideoSupSub::ADMVideoSupSub(char *supfile,uint32_t ix)
+{
+  _fd=fopen(supfile,"r");
+  ADM_assert(_fd);
+  index=new  SUPIndexArray(50);
+  bitmap=NULL;
+  parse();
+  setPalette(pal);
+  currentImage=0;
+}
+ADMVideoSupSub::~ADMVideoSupSub()
+{
+  if(_fd) fclose(_fd);
+  _fd=NULL;
+  if(index) delete index;
+  index=NULL; 
+  if(bitmap) delete bitmap;
+  bitmap=NULL;
+}
+
+uint8_t ADMVideoSupSub::parse(void)
+{
+  uint32_t fileSize;
+  uint32_t blockSize,pos;
+  uint8_t PTS[8];
+  
+  fseeko(_fd,0,SEEK_END);
+  fileSize=ftello(_fd); 
+  fseeko(_fd,0,SEEK_SET);
+  
+  while(ftello(_fd)<fileSize-12)
+  {
+    if(fgetc(_fd)!='S') goto fail;
+    if(fgetc(_fd)!='P') goto fail;
+    // Read timestamp
+      fread(PTS,8,1,_fd);
+        uint64_t pts;
+        uint32_t pts1=(PTS[0])+(PTS[1]<<8)+(PTS[2]<<16)+(PTS[3]<<24);
+        uint32_t pts2=(PTS[4])+(PTS[5]<<8)+(PTS[6]<<16)+(PTS[7]<<24);
+        pts=pts1+(((uint64_t)pts2)<<32);
+        pos=ftello(_fd);
+        fread(PTS,2,1,_fd);
+        blockSize=(PTS[0]<<8)+PTS[1];
+        index->insert(pos,blockSize,pts);
+        fseeko(_fd,blockSize-2,SEEK_CUR);
+  }
+fail:
+  fseeko(_fd,0,SEEK_SET);
+  printf("[SUP] Found %u images\n",index->nbIndex);
+  return 1;
+
+      
+}
+
+uint32_t ADMVideoSupSub::getNbImage(void)
+{
+  return index->nbIndex; 
+}
+
+vobSubBitmap *ADMVideoSupSub::getBitmap(
+          uint32_t nb,uint32_t *start, uint32_t *end,uint32_t *first,uint32_t *last)
+{
+  uint32_t size,pos;
+  if(currentImage>index->nbIndex) 
+  {
+      printf("[SUP] Exceeding # images\n");
+      return NULL;
+  }
+  /* Read incoming data */
+  SUPIndex *idx=&(index->index[currentImage]);
+      
+  uint8_t *data=new uint8_t[idx->size];
+  fseeko(_fd,idx->pos,SEEK_SET);
+  fread(data,idx->size,1,_fd);
+  
+  
+  if(decode(idx->size,data))
+  {
+    // Do some stats
+    if(bitmap)
+    {
+      int col[16];
+      uint32_t sum=0;
+      memset(col,0,sizeof(int)*16);
+      uint8_t *ptr=bitmap->_bitmap;
+      for(int y=0;y<bitmap->_height*bitmap->_width;y++)
+      {
+         col[*ptr++]++;
+         sum++;
+      }
+      printf("<< STATS >>\n");
+      for(int i=0;i<16;i++)
+      {
+        printf("Col %u %u Percent %u\n",i,col[i],(100*col[i])/sum);
+        
+      }
+    }
+    
+    
+    bitmap->buildYUV(_YUVPalette); 
+  }
+  
+  delete [] data;
+  if(bitmap)
+  {
+    *first=0;
+    *last=bitmap->_height-1; 
+  }
+  currentImage++;
+  return bitmap; 
+}
+#define aprintf printf
+#define READ16() (data[_curOffset]<<8)+data[_curOffset+1]; _curOffset+=2;
+uint8_t ADMVideoSupSub::decode(uint32_t size, uint8_t *data)
+{
+  uint32_t odd,even,_subSize,_dataSize,next=0,date,command,dum;
+  
+  uint32_t _curOffset=0,doneA=0,doneB=0;
+        odd=even=0;
+        
+        _subSize=(data[0]<<8)+data[1];
+        if(!_subSize)
+        {
+            printf("Vobsub: error reading\n");
+            return 0;
+        }
+        
+        aprintf("Vobsub: data len =%d\n",_subSize);
+        _curOffset=2;
+        if(_subSize<4)
+        {
+          printf("[handleSub] Packet too short!\n");
+          return 1; 
+        }
+        _dataSize=(data[2]<<8)+data[3];
+        aprintf("data block=%lu\n",_dataSize);
+        if(_dataSize<=4)
+        {
+            printf("Vobsub: data block too small\n");
+            return 0;       
+        }
+        if(_dataSize-4>=_subSize)
+        {
+          printf("DataSize too large\n");
+          return 0; 
+        }
+        _curOffset=_dataSize;
+        while(2)
+        {
+                if(_curOffset>_subSize-5) break;
+                date=READ16();
+                next=READ16();
+                if(next==_curOffset-4) break;            // end of command
+                
+                while(_curOffset<next)
+                {
+                      
+                      
+                        command=data[_curOffset++];
+                        aprintf("vobsub:Command : %d date:%d next:%d cur:%lu\n",command,date,next,_curOffset);
+                        int left=next-_curOffset;
+                        switch(command)
+                        {
+                                case 00:
+                                        break;
+                                case 01: // start date
+                                        break;
+                                case 02: // stop date
+
+                                        break;
+                                case 03: // Pallette 4 nibble= 16 bits
+                                         if(left<2)
+                                         {
+                                            printf("Command 3: Palette: Not enough bytes left\n");
+                                            return 1; 
+                                         }
+                                         dum=READ16();
+                                        _colors[0]=dum>>12;
+                                        _colors[1]=0xf & (dum>>8);
+                                        _colors[2]=0xf & (dum>>4);
+                                        _colors[3]=0xf & (dum);
+                                        printf("[SUP] Palette %x %x %x %x\n",_colors[0],_colors[1],_colors[2],_colors[3]);
+                                        break;          
+                                case 0xff:
+                                        break;
+                                case 04: // alpha channel
+                                         //4 nibble= 16 bits
+                                        if(left<2)
+                                         {
+                                            printf("Command 4: Alpha: Not enough bytes left\n");
+                                            return 1; 
+                                         }
+
+                                        dum=READ16();
+                                        _alpha[0]=dum>>12;
+                                        _alpha[1]=0xf & (dum>>8);
+                                        _alpha[2]=0xf & (dum>>4);
+                                        _alpha[3]=0xf & (dum);
+                                        printf("[SUP] Alpha %x %x %x %x\n",_alpha[0],_alpha[1],_alpha[2],_alpha[3]);
+                                        break;
+                                case 05:
+                                        // Coordinates 12 bits per entry X1/X2/Y1/Y2
+                                        // 48 bits total / 6 bytes
+                                        {
+                                                uint16_t a,b,c;
+                                                uint32_t nx1,nx2,ny1,ny2;
+                                                if(left<6)
+                                                {
+                                                    printf("Command 5: Coord: Not enough bytes left\n");
+                                                    return 1; 
+                                                }
+                                                if(doneA) return 1;
+                                                doneA++;
+                                                a=READ16();
+                                                b=READ16();
+                                                c=READ16();
+                                                nx1=a>>4;
+                                                nx2=((a&0xf)<<8)+(b>>8);
+                                                ny1=((b&0xf)<<4)+(c>>12);
+                                                ny2=c&0xfff;
+                                                
+                                                aprintf("vobsuv: x1:%d x2:%d y1:%d y2:%d\n",nx1,nx2,ny1,ny2);
+                                                
+                                                if(bitmap && ((nx2+1-nx1)==bitmap->_width) && ((ny2+1-ny1)==bitmap->_height))
+                                                {       // Reuse old bitmap
+                                                        bitmap->clear();
+                                                }
+                                                else
+                                                {
+                                                  if(bitmap)
+                                                        delete bitmap;
+                                                  bitmap=NULL;
+                                                  _subW=nx2+1-nx1;
+                                                  _subH=ny2+1-ny1;
+                                                  bitmap=new vobSubBitmap(_subW,_subH);
+                                                }
+                                                                        
+                                        }
+                                        break;
+                                case 06: // RLE offset 
+                                        // 2*16 bits : odd offset, even offset
+                                        {
+                                                if(doneB) return 1;
+                                                doneB++;
+                                                if(left<4)
+                                                {
+                                                    printf("Command 6: RLE: Not enough bytes left\n");
+                                                    return 1; 
+                                                }
+                                                odd=READ16();
+                                                even=READ16();
+ 
+                                        }
+                                        break;   
+                                default:                                                     
+                                        printf("Unknown command:%d\n",command);
+                                        return 0;
+                                  
+                        } //End switch command     
+                }// end while
+        }
+        /*****/
+        if(bitmap && odd && even) 
+        {
+                bitmap->clear();
+                decodeRLE(odd,0,even,data,_dataSize);
+                decodeRLE(even,1,0,data,_dataSize);
+        }
+    return 1;
+}
+uint8_t ADMVideoSupSub::decodeRLE(uint32_t off,uint32_t start,uint32_t end,uint8_t *data,uint32_t _dataSize)
+{
+   if(!bitmap) return 0;
+        uint32_t _curOffset=0;
+        uint32_t oldoffset=_curOffset;
+        uint32_t stride=_subW;
+        uint32_t x,y;
+        uint8_t *ptr=bitmap->_bitmap;
+        uint8_t *alpha=bitmap->_alphaMask;
+        uint32_t a,b;
+        int     nibbleparity=0;
+        int     nibble=0;
+        
+        int run,color;
+        
+#define SKIPNIBBLE        {nibbleparity=0;}
+#define readbyte() data[_curOffset++]
+#define NEXTNIBBLE(x) if(nibbleparity){ x=nibble&0xf;nibbleparity=0;}else {nibble=readbyte();nibbleparity=1;x=nibble>>4;}
+       
+        _curOffset=off;
+        aprintf("Vobsub: Rle at offset :%d datasize:%d (stride:%d)\n",off,_dataSize,stride);
+        if(!ptr)
+        {
+                printf("Vobsub:No infos yet RLE data...\n");
+                 return 1;
+        }
+        x=0;
+        y=0;
+        while(
+               (_curOffset<_dataSize)
+            && (y<(_subH>>1)) 
+            && ((!end) || (_curOffset<end))
+        )
+        {
+               NEXTNIBBLE(a);
+               if(a<4)
+               {
+                 a<<=4;
+                 NEXTNIBBLE(b);
+                 a|=b;
+                 if(a<0x10)
+                 {
+                        a<<=4;
+                        NEXTNIBBLE(b);
+                        a|=b;
+                        if(a<0x40)
+                        {
+                                a<<=4;
+                                NEXTNIBBLE(b);
+                                a|=b;
+                                if(a<0x100)
+                                {
+                                        a|=(stride-x)<<2;
+                                }
+                        }
+                 }
+              }
+              run=a>>2;
+              color=3-(a&0x3);
+             // aprintf("Vobsub: Run:%d color:%d\n",run,color);
+              if((run>stride-x) || !run)
+                run=stride-x;
+              
+              //memset(ptr,color,run);
+              memset(ptr,_colors[color],run);
+              memset(alpha,_alpha[color],run);
+              if(run!=stride) bitmap->setDirty(y*2+start);
+              x+=run;
+              ptr+=run;
+              alpha+=run;
+              //  aprintf("x:%d y:%d\n",x,y);
+              if(x>=stride)
+              {
+                        
+                     y++;
+                     x=0;
+                     ptr=bitmap->_bitmap+(y*2+start)*stride;
+                     alpha=bitmap->_alphaMask+(y*2+start)*stride;
+                     SKIPNIBBLE;
+              }
+        }
+        aprintf("vobsub End :%d y:%d\n",_curOffset,y); 
+        _curOffset=oldoffset;
+  
+  return 1;
+}
+uint8_t ADMVideoSupSub::setPalette( uint32_t *palette )
+{
+uint8_t r,g,b,a;
+uint8_t y;
+int8_t u,v;
+uint32_t value;
+        for(int i=0;i<16;i++)
+        {
+               value=palette[i];
+               r=(value>>16)&0xff;
+               g=(value>>8)&0xff; 
+               b=(value)&0xff;
+               
+               COL_RgbToYuv(b,  g,  r, &y, &u,&v);
+               
+                _YUVPalette[i]=y;
+        }
+        return 1;
+
+}
+//EOF
+

Added: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_ocr/adm_sup.h
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_ocr/adm_sup.h	2007-07-07 20:54:55 UTC (rev 3344)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_ocr/adm_sup.h	2007-07-08 13:40:14 UTC (rev 3345)
@@ -0,0 +1,64 @@
+//
+// C++ Implementation: Interface to decode .SUP (projectX) subtitles
+// Author: Mean, fixounet at free.fr
+// (C) 2007 MEAN
+/***************************************************************************
+ *                                                                         *
+ *   This program is free software; you can redistribute it and/or modify  *
+ *   it under the terms of the GNU General Public License as published by  *
+ *   the Free Software Foundation; either version 2 of the License, or     *
+ *   (at your option) any later version.                                   *
+ *                                                                         *
+ ***************************************************************************/
+
+#ifndef ADMVideoSupSub_H
+#define ADMVideoSupSub_H
+
+typedef struct
+{
+  uint32_t pos;
+  uint32_t size;
+  uint32_t pts;
+}SUPIndex;
+
+class SUPIndexArray
+{
+public:
+  SUPIndexArray(uint32_t nb);
+  ~SUPIndexArray();
+  
+  SUPIndex *index;
+  uint32_t nbIndex;
+  uint32_t indexCeil;
+  
+  uint32_t insert(uint32_t pos, uint32_t size, uint32_t pts);
+};
+
+class ADMVideoSupSub
+{
+  protected:
+      FILE      *_fd;
+      uint8_t   parse(void);
+      uint8_t   decode(uint32_t size, uint8_t *data);
+      uint8_t   decodeRLE(uint32_t off,uint32_t start,uint32_t end,uint8_t *data,uint32_t _dataSize);
+      uint8_t   setPalette( uint32_t *palette );
+      uint8_t   buildYUV( int16_t *palette ); 
+      
+      
+      vobSubBitmap *bitmap;
+      uint32_t currentImage;
+      
+      uint32_t _colors[4];
+      uint32_t _subW,_subH,_alpha[4];
+      int16_t  _YUVPalette[16];
+  public:
+      ADMVideoSupSub(char *supfile,uint32_t ix);
+      ~ADMVideoSupSub();
+      SUPIndexArray *index;
+      uint32_t getNbImage(void);
+      vobSubBitmap *getBitmap(
+          uint32_t nb,uint32_t *start, uint32_t *end,uint32_t *first,uint32_t *last);
+  
+};
+
+#endif
\ No newline at end of file



From gruntster at mail.berlios.de  Sun Jul  8 17:25:13 2007
From: gruntster at mail.berlios.de (gruntster at mail.berlios.de)
Date: Sun, 8 Jul 2007 17:25:13 +0200
Subject: [Avidemux-svn-commit] r3346 -
	branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI
Message-ID: <200707081525.l68FPDPl012632@sheep.berlios.de>

Author: gruntster
Date: 2007-07-08 17:25:04 +0200 (Sun, 08 Jul 2007)
New Revision: 3346

Modified:
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/GUI_sdlRender.cpp
Log:
manually move SDL window with parent when using DirectX (Win32)

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/GUI_sdlRender.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/GUI_sdlRender.cpp	2007-07-08 13:40:14 UTC (rev 3345)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/GUI_sdlRender.cpp	2007-07-08 15:25:04 UTC (rev 3346)
@@ -223,6 +223,26 @@
 }
 uint8_t sdlAccelRender::display(uint8_t *ptr, uint32_t w, uint32_t h,renderZoom zoom)
 {
+#ifdef ADM_WIN32
+	// DirectX playback doesn't refresh correctly if the parent window is moved.
+	// Detect when the parent window has moved and force a coordinate update.
+	if (strcmp(getenv("SDL_VIDEODRIVER"), "directx") == 0)
+	{
+		static RECT lastPos;
+
+		RECT currentPos;
+		GetWindowRect(sdlWin32, &currentPos);
+
+		if (currentPos.left != lastPos.left || currentPos.top != lastPos.top)
+		{
+			// By default SetWindowPos doesn't work if the new coordinates are the same as the 
+			// current so use SWP_FRAMECHANGED to force an update.
+			SetWindowPos(sdlWin32, NULL, 0, 0, 0, 0, SWP_NOSIZE | SWP_NOZORDER | SWP_FRAMECHANGED);
+			lastPos = currentPos;
+		}
+	}
+#endif
+
 int pitch;
 int page=w*h;
         ADM_assert(sdl_overlay);



From mean at mail.berlios.de  Sun Jul  8 19:19:32 2007
From: mean at mail.berlios.de (mean at BerliOS)
Date: Sun, 8 Jul 2007 19:19:32 +0200
Subject: [Avidemux-svn-commit] r3347 -
	branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_ocr
Message-ID: <200707081719.l68HJW9V030557@sheep.berlios.de>

Author: mean
Date: 2007-07-08 19:19:30 +0200 (Sun, 08 Jul 2007)
New Revision: 3347

Added:
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_ocr/adm_editglyph.cpp
Log:
new file

Added: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_ocr/adm_editglyph.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_ocr/adm_editglyph.cpp	2007-07-08 15:25:04 UTC (rev 3346)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_ocr/adm_editglyph.cpp	2007-07-08 17:19:30 UTC (rev 3347)
@@ -0,0 +1,289 @@
+/***************************************************************************
+    copyright            : (C) 2007 by mean
+    email                : fixounet at free.fr
+ ***************************************************************************/
+
+/***************************************************************************
+ *                                                                         *
+ *   This program is free software; you can redistribute it and/or modify  *
+ *   it under the terms of the GNU General Public License as published by  *
+ *   the Free Software Foundation; either version 2 of the License, or     *
+ *   (at your option) any later version.                                   *
+ *                                                                         *
+ ***************************************************************************/
+#include "config.h"
+#include <stdio.h>
+#include <stdlib.h>
+#include <string.h>
+#include "default.h"
+#include "gtk/gtk.h"
+#include <ADM_assert.h>
+
+
+
+#include "ADM_toolkit/toolkit.hxx"
+#include "ADM_toolkit/filesel.h"
+
+#include "../ADM_GTK/ADM_toolkit_gtk/toolkit_gtk.h"
+#include "../ADM_GTK/ADM_toolkit_gtk/toolkit_gtk_include.h"
+
+#include "ADM_ocr/adm_glyph.h"
+
+static GtkWidget *create_dialog1 (void);
+static admGlyph *currentGlyph=NULL;
+static GtkWidget *dialog;
+
+static uint8_t loadGlyph(char *name,admGlyph *head,uint32_t *outNb);
+static gboolean glyphDraw( void );
+static void glyphUpdate(void );
+/**
+    \fn DIA_glyphEdit
+    \brief Dialog to edit glyph
+*/
+uint8_t DIA_glyphEdit(void)
+{
+  char *glyphName;
+  admGlyph head(1,1);
+  
+  
+  uint32_t nbGlyph=0;
+  uint8_t ret=0;
+  // First select a file
+  
+   GUI_FileSelRead(_("Select GlyphFile to edit"), &glyphName);
+  if(!glyphName) return 0;
+  
+  // Try to load it
+  if(!loadGlyph(glyphName,&head,&nbGlyph) || !nbGlyph)
+  {
+    destroyGlyphTree(&head);
+    return 0;
+  }
+  // Convert the linear glyph to glyph array
+  admGlyph *glyphArray[nbGlyph];
+  admGlyph *cur=head.next;
+  uint32_t idx=0;
+  while(cur)
+  {
+     glyphArray[idx++]=cur;
+     cur=cur->next;
+  }
+  ADM_assert(idx<=nbGlyph);
+  nbGlyph=idx;
+  // Glyph loaded, here we go
+  currentGlyph=head.next;
+  dialog=create_dialog1 ();
+  gtk_register_dialog(dialog);
+  
+  // Register callbacks
+  #define ASSOCIATE(x,y)   gtk_dialog_add_action_widget (GTK_DIALOG (dialog), WID(x),y)
+  #define CONNECT(x,y,z) 	gtk_signal_connect(GTK_OBJECT(WID(x)), #y,GTK_SIGNAL_FUNC(z),   NULL);
+#define ACTION_PREV 10
+#define ACTION_NEXT 20
+  ASSOCIATE(buttonPrev,ACTION_PREV);
+  ASSOCIATE(buttonNext,ACTION_NEXT);
+  
+  CONNECT(drawingarea1,expose_event,glyphDraw);
+  gtk_widget_show(dialog);
+  glyphUpdate();
+  while(1)
+  {
+   gint b=gtk_dialog_run(GTK_DIALOG(dialog));
+    switch(b)
+    {
+      case ACTION_PREV: 
+                        printf("PREV\n");
+                        if(currentGlyph!=head.next)
+                        {
+                           admGlyph *father;
+                           father=glyphSearchFather(currentGlyph,&head);
+                           if(father)
+                           {
+                               currentGlyph=father;
+                               glyphUpdate();
+                           }
+                          
+                        }
+                        continue;break;
+      case ACTION_NEXT: 
+                        printf("NEXT\n");
+                        if(currentGlyph->next)
+                        {
+                          currentGlyph=currentGlyph->next; 
+                          glyphUpdate();
+                        }
+                        continue;break; 
+    }
+    break; // exit while(1)
+  }
+  
+  gtk_unregister_dialog(dialog);
+  gtk_widget_destroy(dialog);
+  
+  destroyGlyphTree(&head);
+  return ret;
+
+}
+/**
+    \fn glyphUpdate
+    \brief Update all fields in the dialog wrt currentGlyph
+*/
+void glyphUpdate(void )
+{
+  if(!currentGlyph) return;
+  gtk_widget_set_usize(WID(drawingarea1), currentGlyph->width+4, currentGlyph->height+4);
+  glyphDraw();
+  if(currentGlyph->code)
+  {
+    gtk_editable_delete_text(GTK_EDITABLE(WID(entry1)), 0,-1); 
+    // Set our text
+    gtk_entry_set_text (GTK_ENTRY (WID(entry1)), currentGlyph->code);
+  }
+}
+/**
+    \fn     glyphDraw
+    \brief  display glyph
+*/
+gboolean glyphDraw( void )
+{
+    if(!currentGlyph) return true;
+    gdk_draw_gray_image(WID(drawingarea1)->window, WID(drawingarea1)->style->fg_gc[GTK_STATE_SELECTED /*GTK_STATE_NORMAL*/],
+                        2,                          // X
+                        2,                          // y
+                        currentGlyph->width,                          //width
+                        currentGlyph->height,                          //h*2, // heigth
+                        GDK_RGB_DITHER_NONE,
+                        currentGlyph->data, // buffer
+                        currentGlyph->width );
+    return true;
+}
+
+/**
+    \fn loadGlyph
+    \brief Load a glyph set
+*/
+uint8_t loadGlyph(char *name,admGlyph *head,uint32_t *outNb)
+{
+  FILE *out;
+  admGlyph *glyph,*nw;
+  uint32_t N,w,h,slen;
+  uint32_t nbGlyphs;
+ 
+  glyph=head;
+  out=fopen(name,"rb");
+  if(!out)
+  {
+    GUI_Error_HIG(_("File error"), _("Could not read \"%s\"."), name);
+    return 0;
+  }
+#define READ(x) fread(&(x),sizeof(x),1,out);
+    nbGlyphs=0;
+    READ(N);
+    while(N--)
+    {
+        
+      READ(w);
+      READ(h);
+      nw=new admGlyph(w,h);
+      fread(nw->data,w*h,1,out);
+      READ(slen);
+      if(slen)
+      {
+        nw->code=new char[slen+1];
+        fread(nw->code,slen,1,out);
+        nw->code[slen]=0;
+      }
+      glyph->next=nw;
+      glyph=nw;
+      nbGlyphs++;
+    }
+    
+    fclose(out);
+    *outNb=nbGlyphs;
+    return 1;
+
+}
+
+
+//**********************************
+GtkWidget *create_dialog1 (void)
+{
+  GtkWidget *dialog1;
+  GtkWidget *dialog_vbox1;
+  GtkWidget *vbox2;
+  GtkWidget *drawingarea1;
+  GtkWidget *entry1;
+  GtkWidget *hbox1;
+  GtkWidget *buttonPrev;
+  GtkWidget *buttonNext;
+  GtkWidget *hseparator1;
+  GtkWidget *button3;
+  GtkWidget *dialog_action_area1;
+  GtkWidget *closebutton1;
+
+  dialog1 = gtk_dialog_new ();
+  gtk_window_set_title (GTK_WINDOW (dialog1), _("dialog1"));
+  gtk_window_set_type_hint (GTK_WINDOW (dialog1), GDK_WINDOW_TYPE_HINT_DIALOG);
+
+  dialog_vbox1 = GTK_DIALOG (dialog1)->vbox;
+  gtk_widget_show (dialog_vbox1);
+
+  vbox2 = gtk_vbox_new (FALSE, 0);
+  gtk_widget_show (vbox2);
+  gtk_box_pack_start (GTK_BOX (dialog_vbox1), vbox2, TRUE, TRUE, 0);
+
+  drawingarea1 = gtk_drawing_area_new ();
+  gtk_widget_show (drawingarea1);
+  gtk_box_pack_start (GTK_BOX (vbox2), drawingarea1, TRUE, TRUE, 0);
+
+  entry1 = gtk_entry_new ();
+  gtk_widget_show (entry1);
+  gtk_box_pack_start (GTK_BOX (vbox2), entry1, FALSE, FALSE, 0);
+
+  hbox1 = gtk_hbox_new (FALSE, 0);
+  gtk_widget_show (hbox1);
+  gtk_box_pack_start (GTK_BOX (vbox2), hbox1, TRUE, TRUE, 0);
+
+  buttonPrev = gtk_button_new_from_stock ("gtk-media-previous");
+  gtk_widget_show (buttonPrev);
+  gtk_box_pack_start (GTK_BOX (hbox1), buttonPrev, TRUE, TRUE, 0);
+
+  buttonNext = gtk_button_new_from_stock ("gtk-media-next");
+  gtk_widget_show (buttonNext);
+  gtk_box_pack_start (GTK_BOX (hbox1), buttonNext, TRUE, TRUE, 0);
+
+  hseparator1 = gtk_hseparator_new ();
+  gtk_widget_show (hseparator1);
+  gtk_box_pack_start (GTK_BOX (hbox1), hseparator1, TRUE, TRUE, 0);
+
+  button3 = gtk_button_new_from_stock ("gtk-save-as");
+  gtk_widget_show (button3);
+  gtk_box_pack_start (GTK_BOX (hbox1), button3, FALSE, FALSE, 0);
+
+  dialog_action_area1 = GTK_DIALOG (dialog1)->action_area;
+  gtk_widget_show (dialog_action_area1);
+  gtk_button_box_set_layout (GTK_BUTTON_BOX (dialog_action_area1), GTK_BUTTONBOX_END);
+
+  closebutton1 = gtk_button_new_from_stock ("gtk-close");
+  gtk_widget_show (closebutton1);
+  gtk_dialog_add_action_widget (GTK_DIALOG (dialog1), closebutton1, GTK_RESPONSE_CLOSE);
+  GTK_WIDGET_SET_FLAGS (closebutton1, GTK_CAN_DEFAULT);
+
+  /* Store pointers to all widgets, for use by lookup_widget(). */
+  GLADE_HOOKUP_OBJECT_NO_REF (dialog1, dialog1, "dialog1");
+  GLADE_HOOKUP_OBJECT_NO_REF (dialog1, dialog_vbox1, "dialog_vbox1");
+  GLADE_HOOKUP_OBJECT (dialog1, vbox2, "vbox2");
+  GLADE_HOOKUP_OBJECT (dialog1, drawingarea1, "drawingarea1");
+  GLADE_HOOKUP_OBJECT (dialog1, entry1, "entry1");
+  GLADE_HOOKUP_OBJECT (dialog1, hbox1, "hbox1");
+  GLADE_HOOKUP_OBJECT (dialog1, buttonPrev, "buttonPrev");
+  GLADE_HOOKUP_OBJECT (dialog1, buttonNext, "buttonNext");
+  GLADE_HOOKUP_OBJECT (dialog1, hseparator1, "hseparator1");
+  GLADE_HOOKUP_OBJECT (dialog1, button3, "button3");
+  GLADE_HOOKUP_OBJECT_NO_REF (dialog1, dialog_action_area1, "dialog_action_area1");
+  GLADE_HOOKUP_OBJECT (dialog1, closebutton1, "closebutton1");
+
+  return dialog1;
+}
+
+



From mean at mail.berlios.de  Sun Jul  8 19:52:06 2007
From: mean at mail.berlios.de (mean at BerliOS)
Date: Sun, 8 Jul 2007 19:52:06 +0200
Subject: [Avidemux-svn-commit] r3348 - in
	branches/avidemux_2.4_branch/avidemux: . ADM_ocr
	ADM_userInterfaces/ADM_GTK/ADM_gui2
	ADM_userInterfaces/ADM_GTK/ADM_ocr
	ADM_userInterfaces/ADM_NONE/ADM_dialog
	ADM_userInterfaces/ADM_QT4/ADM_dialog
Message-ID: <200707081752.l68Hq6Ni001666@sheep.berlios.de>

Author: mean
Date: 2007-07-08 19:52:05 +0200 (Sun, 08 Jul 2007)
New Revision: 3348

Modified:
   branches/avidemux_2.4_branch/avidemux/ADM_ocr/adm_glyph.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_ocr/adm_glyph.h
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_menumap.h
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_ocr/CMakeLists.txt
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_ocr/adm_editglyph.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_NONE/ADM_dialog/DIA_none.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_none.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_jobs.cpp
   branches/avidemux_2.4_branch/avidemux/gtk_gui.cpp
   branches/avidemux_2.4_branch/avidemux/gui_action.hxx
Log:
very basic glyphset editor

Modified: branches/avidemux_2.4_branch/avidemux/ADM_ocr/adm_glyph.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_ocr/adm_glyph.cpp	2007-07-08 17:19:30 UTC (rev 3347)
+++ branches/avidemux_2.4_branch/avidemux/ADM_ocr/adm_glyph.cpp	2007-07-08 17:52:05 UTC (rev 3348)
@@ -135,5 +135,23 @@
             return nw;
 
 }
+/**
+    \fn glyphSearchFather
+    \brief Returns the father of the "in" glyph.
+    @param in : Glyph to search the father of
+    @param head : head of glyph list
+    @returns father or NULL if not found
+*/
+admGlyph *glyphSearchFather(admGlyph *in,admGlyph *head )
+{
+  admGlyph *cur=head;
+  while(cur)
+  {
+    if(!cur->next) return NULL;
+    if(cur->next==in) return cur; 
+    cur=cur->next;
+  }
+  return NULL;
+}
 /*************************************************/
 

Modified: branches/avidemux_2.4_branch/avidemux/ADM_ocr/adm_glyph.h
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_ocr/adm_glyph.h	2007-07-08 17:19:30 UTC (rev 3347)
+++ branches/avidemux_2.4_branch/avidemux/ADM_ocr/adm_glyph.h	2007-07-08 17:52:05 UTC (rev 3348)
@@ -59,4 +59,5 @@
 uint8_t  destroyGlyphTree(admGlyph *startGlyph);
 uint8_t  insertInGlyphTree(admGlyph *startGlyph, admGlyph *candidate);
 admGlyph *clippedGlyph(admGlyph *in);
+admGlyph *glyphSearchFather(admGlyph *in,admGlyph *head );
 #endif

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp	2007-07-08 17:19:30 UTC (rev 3347)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp	2007-07-08 17:52:05 UTC (rev 3348)
@@ -36,11 +36,11 @@
   GtkWidget *menuitem1;
   GtkWidget *menuitem1_menu;
   GtkWidget *open_video1;
-  GtkWidget *image8196;
+  GtkWidget *image8246;
   GtkWidget *append_video1;
-  GtkWidget *image8197;
+  GtkWidget *image8247;
   GtkWidget *save_stuff;
-  GtkWidget *image8198;
+  GtkWidget *image8248;
   GtkWidget *save_stuff_menu;
   GtkWidget *save_as_avi1;
   GtkWidget *separator1;
@@ -50,41 +50,41 @@
   GtkWidget *close1;
   GtkWidget *separator3;
   GtkWidget *save_project1;
-  GtkWidget *image8199;
+  GtkWidget *image8249;
   GtkWidget *save_project_as1;
-  GtkWidget *image8200;
+  GtkWidget *image8250;
   GtkWidget *run_script1;
-  GtkWidget *image8201;
+  GtkWidget *image8251;
   GtkWidget *add_to_joblist1;
   GtkWidget *joblist1;
   GtkWidget *separator16;
   GtkWidget *connect_to_avsproxy1;
   GtkWidget *separator18;
   GtkWidget *video_informations1;
-  GtkWidget *image8202;
+  GtkWidget *image8252;
   GtkWidget *avi_muxer_options1;
   GtkWidget *separator4;
   GtkWidget *quit1;
-  GtkWidget *image8203;
+  GtkWidget *image8253;
   GtkWidget *menuitem2;
   GtkWidget *menuitem2_menu;
   GtkWidget *reset_edits1;
-  GtkWidget *image8204;
+  GtkWidget *image8254;
   GtkWidget *separator5;
   GtkWidget *cut1;
-  GtkWidget *image8205;
+  GtkWidget *image8255;
   GtkWidget *copy1;
-  GtkWidget *image8206;
+  GtkWidget *image8256;
   GtkWidget *paste1;
-  GtkWidget *image8207;
+  GtkWidget *image8257;
   GtkWidget *delete1;
-  GtkWidget *image8208;
+  GtkWidget *image8258;
   GtkWidget *separator6;
   GtkWidget *set_marker_a1;
   GtkWidget *set_marker_b1;
   GtkWidget *separator7;
   GtkWidget *preferences1;
-  GtkWidget *image8209;
+  GtkWidget *image8259;
   GtkWidget *view1;
   GtkWidget *view1_menu;
   GtkWidget *toolbar1;
@@ -113,13 +113,13 @@
   GtkWidget *build_vbr_time_map1;
   GtkWidget *separator11;
   GtkWidget *save_audio1;
-  GtkWidget *image8210;
+  GtkWidget *image8260;
   GtkWidget *audio_encoder1;
   GtkWidget *filters2;
   GtkWidget *tools1;
   GtkWidget *tools1_menu;
   GtkWidget *calculator1;
-  GtkWidget *image8211;
+  GtkWidget *image8261;
   GtkWidget *separator12;
   GtkWidget *rebuild_frames;
   GtkWidget *check_frames;
@@ -128,6 +128,7 @@
   GtkWidget *separator13;
   GtkWidget *v2v;
   GtkWidget *ocr_vobsub_2_srt;
+  GtkWidget *edit_glyph1;
   GtkWidget *separator17;
   GtkWidget *see_hex1;
   GtkWidget *help1;
@@ -140,35 +141,35 @@
   GtkWidget *go1;
   GtkWidget *go1_menu;
   GtkWidget *play_video1;
-  GtkWidget *image8212;
+  GtkWidget *image8262;
   GtkWidget *previous_frame1;
-  GtkWidget *image8213;
+  GtkWidget *image8263;
   GtkWidget *next_frame1;
-  GtkWidget *image8214;
+  GtkWidget *image8264;
   GtkWidget *previous_intra_frame1;
-  GtkWidget *image8215;
+  GtkWidget *image8265;
   GtkWidget *next_intra_frame1;
-  GtkWidget *image8216;
+  GtkWidget *image8266;
   GtkWidget *search_previous_black_frame1;
   GtkWidget *search_next_black_frame1;
   GtkWidget *first_frame1;
-  GtkWidget *image8217;
+  GtkWidget *image8267;
   GtkWidget *last_frame1;
-  GtkWidget *image8218;
+  GtkWidget *image8268;
   GtkWidget *separator14;
   GtkWidget *go_to_marker_a1;
   GtkWidget *go_to_marker_b1;
   GtkWidget *separator15;
   GtkWidget *jum_to_frame1;
-  GtkWidget *image8219;
+  GtkWidget *image8269;
   GtkWidget *jump_to_time1;
-  GtkWidget *image8220;
+  GtkWidget *image8270;
   GtkWidget *custom1;
   GtkWidget *help2;
   GtkWidget *help2_menu;
   GtkWidget *show_builtin_support1;
   GtkWidget *about1;
-  GtkWidget *image8221;
+  GtkWidget *image8271;
   GtkWidget *toolbar2;
   GtkIconSize tmp_toolbar_icon_size;
   GtkWidget *menutoolbuttonOpen;
@@ -294,9 +295,9 @@
                               GDK_O, (GdkModifierType)( GDK_CONTROL_MASK),
                               GTK_ACCEL_VISIBLE);
 
-  image8196 = gtk_image_new_from_stock ("gtk-open", GTK_ICON_SIZE_MENU);
-  gtk_widget_show (image8196);
-  gtk_image_menu_item_set_image (GTK_IMAGE_MENU_ITEM (open_video1), image8196);
+  image8246 = gtk_image_new_from_stock ("gtk-open", GTK_ICON_SIZE_MENU);
+  gtk_widget_show (image8246);
+  gtk_image_menu_item_set_image (GTK_IMAGE_MENU_ITEM (open_video1), image8246);
 
   append_video1 = gtk_image_menu_item_new_with_mnemonic (_("_Append..."));
   gtk_widget_show (append_video1);
@@ -305,17 +306,17 @@
                               GDK_A, (GdkModifierType)( GDK_CONTROL_MASK | GDK_MOD1_MASK),
                               GTK_ACCEL_VISIBLE);
 
-  image8197 = gtk_image_new_from_stock ("gtk-add", GTK_ICON_SIZE_MENU);
-  gtk_widget_show (image8197);
-  gtk_image_menu_item_set_image (GTK_IMAGE_MENU_ITEM (append_video1), image8197);
+  image8247 = gtk_image_new_from_stock ("gtk-add", GTK_ICON_SIZE_MENU);
+  gtk_widget_show (image8247);
+  gtk_image_menu_item_set_image (GTK_IMAGE_MENU_ITEM (append_video1), image8247);
 
   save_stuff = gtk_image_menu_item_new_with_mnemonic (_("_Save"));
   gtk_widget_show (save_stuff);
   gtk_container_add (GTK_CONTAINER (menuitem1_menu), save_stuff);
 
-  image8198 = gtk_image_new_from_stock ("gtk-save", GTK_ICON_SIZE_MENU);
-  gtk_widget_show (image8198);
-  gtk_image_menu_item_set_image (GTK_IMAGE_MENU_ITEM (save_stuff), image8198);
+  image8248 = gtk_image_new_from_stock ("gtk-save", GTK_ICON_SIZE_MENU);
+  gtk_widget_show (image8248);
+  gtk_image_menu_item_set_image (GTK_IMAGE_MENU_ITEM (save_stuff), image8248);
 
   save_stuff_menu = gtk_menu_new ();
   gtk_menu_item_set_submenu (GTK_MENU_ITEM (save_stuff), save_stuff_menu);
@@ -357,25 +358,25 @@
   gtk_widget_show (save_project1);
   gtk_container_add (GTK_CONTAINER (menuitem1_menu), save_project1);
 
-  image8199 = gtk_image_new_from_stock ("gtk-save", GTK_ICON_SIZE_MENU);
-  gtk_widget_show (image8199);
-  gtk_image_menu_item_set_image (GTK_IMAGE_MENU_ITEM (save_project1), image8199);
+  image8249 = gtk_image_new_from_stock ("gtk-save", GTK_ICON_SIZE_MENU);
+  gtk_widget_show (image8249);
+  gtk_image_menu_item_set_image (GTK_IMAGE_MENU_ITEM (save_project1), image8249);
 
   save_project_as1 = gtk_image_menu_item_new_with_mnemonic (_("Save P_roject As..."));
   gtk_widget_show (save_project_as1);
   gtk_container_add (GTK_CONTAINER (menuitem1_menu), save_project_as1);
 
-  image8200 = gtk_image_new_from_stock ("gtk-save-as", GTK_ICON_SIZE_MENU);
-  gtk_widget_show (image8200);
-  gtk_image_menu_item_set_image (GTK_IMAGE_MENU_ITEM (save_project_as1), image8200);
+  image8250 = gtk_image_new_from_stock ("gtk-save-as", GTK_ICON_SIZE_MENU);
+  gtk_widget_show (image8250);
+  gtk_image_menu_item_set_image (GTK_IMAGE_MENU_ITEM (save_project_as1), image8250);
 
   run_script1 = gtk_image_menu_item_new_with_mnemonic (_("_Load/Run Project..."));
   gtk_widget_show (run_script1);
   gtk_container_add (GTK_CONTAINER (menuitem1_menu), run_script1);
 
-  image8201 = gtk_image_new_from_stock ("gtk-execute", GTK_ICON_SIZE_MENU);
-  gtk_widget_show (image8201);
-  gtk_image_menu_item_set_image (GTK_IMAGE_MENU_ITEM (run_script1), image8201);
+  image8251 = gtk_image_new_from_stock ("gtk-execute", GTK_ICON_SIZE_MENU);
+  gtk_widget_show (image8251);
+  gtk_image_menu_item_set_image (GTK_IMAGE_MENU_ITEM (run_script1), image8251);
 
   add_to_joblist1 = gtk_menu_item_new_with_mnemonic (_("A_dd to Joblist..."));
   gtk_widget_show (add_to_joblist1);
@@ -409,9 +410,9 @@
                               GDK_Return, (GdkModifierType)( GDK_MOD1_MASK),
                               GTK_ACCEL_VISIBLE);
 
-  image8202 = gtk_image_new_from_stock ("gtk-properties", GTK_ICON_SIZE_MENU);
-  gtk_widget_show (image8202);
-  gtk_image_menu_item_set_image (GTK_IMAGE_MENU_ITEM (video_informations1), image8202);
+  image8252 = gtk_image_new_from_stock ("gtk-properties", GTK_ICON_SIZE_MENU);
+  gtk_widget_show (image8252);
+  gtk_image_menu_item_set_image (GTK_IMAGE_MENU_ITEM (video_informations1), image8252);
 
   avi_muxer_options1 = gtk_menu_item_new_with_mnemonic (_("AVI _Muxer Options"));
   gtk_widget_show (avi_muxer_options1);
@@ -429,9 +430,9 @@
                               GDK_Q, (GdkModifierType)( GDK_CONTROL_MASK),
                               GTK_ACCEL_VISIBLE);
 
-  image8203 = gtk_image_new_from_stock ("gtk-quit", GTK_ICON_SIZE_MENU);
-  gtk_widget_show (image8203);
-  gtk_image_menu_item_set_image (GTK_IMAGE_MENU_ITEM (quit1), image8203);
+  image8253 = gtk_image_new_from_stock ("gtk-quit", GTK_ICON_SIZE_MENU);
+  gtk_widget_show (image8253);
+  gtk_image_menu_item_set_image (GTK_IMAGE_MENU_ITEM (quit1), image8253);
 
   menuitem2 = gtk_menu_item_new_with_mnemonic (_("_Edit"));
   gtk_widget_show (menuitem2);
@@ -444,9 +445,9 @@
   gtk_widget_show (reset_edits1);
   gtk_container_add (GTK_CONTAINER (menuitem2_menu), reset_edits1);
 
-  image8204 = gtk_image_new_from_stock ("gtk-undo", GTK_ICON_SIZE_MENU);
-  gtk_widget_show (image8204);
-  gtk_image_menu_item_set_image (GTK_IMAGE_MENU_ITEM (reset_edits1), image8204);
+  image8254 = gtk_image_new_from_stock ("gtk-undo", GTK_ICON_SIZE_MENU);
+  gtk_widget_show (image8254);
+  gtk_image_menu_item_set_image (GTK_IMAGE_MENU_ITEM (reset_edits1), image8254);
 
   separator5 = gtk_separator_menu_item_new ();
   gtk_widget_show (separator5);
@@ -460,9 +461,9 @@
                               GDK_X, (GdkModifierType)( GDK_CONTROL_MASK),
                               GTK_ACCEL_VISIBLE);
 
-  image8205 = gtk_image_new_from_stock ("gtk-cut", GTK_ICON_SIZE_MENU);
-  gtk_widget_show (image8205);
-  gtk_image_menu_item_set_image (GTK_IMAGE_MENU_ITEM (cut1), image8205);
+  image8255 = gtk_image_new_from_stock ("gtk-cut", GTK_ICON_SIZE_MENU);
+  gtk_widget_show (image8255);
+  gtk_image_menu_item_set_image (GTK_IMAGE_MENU_ITEM (cut1), image8255);
 
   copy1 = gtk_image_menu_item_new_with_mnemonic (_("_Copy"));
   gtk_widget_show (copy1);
@@ -471,9 +472,9 @@
                               GDK_C, (GdkModifierType)( GDK_CONTROL_MASK),
                               GTK_ACCEL_VISIBLE);
 
-  image8206 = gtk_image_new_from_stock ("gtk-copy", GTK_ICON_SIZE_MENU);
-  gtk_widget_show (image8206);
-  gtk_image_menu_item_set_image (GTK_IMAGE_MENU_ITEM (copy1), image8206);
+  image8256 = gtk_image_new_from_stock ("gtk-copy", GTK_ICON_SIZE_MENU);
+  gtk_widget_show (image8256);
+  gtk_image_menu_item_set_image (GTK_IMAGE_MENU_ITEM (copy1), image8256);
 
   paste1 = gtk_image_menu_item_new_with_mnemonic (_("_Paste"));
   gtk_widget_show (paste1);
@@ -482,9 +483,9 @@
                               GDK_V, (GdkModifierType)( GDK_CONTROL_MASK),
                               GTK_ACCEL_VISIBLE);
 
-  image8207 = gtk_image_new_from_stock ("gtk-paste", GTK_ICON_SIZE_MENU);
-  gtk_widget_show (image8207);
-  gtk_image_menu_item_set_image (GTK_IMAGE_MENU_ITEM (paste1), image8207);
+  image8257 = gtk_image_new_from_stock ("gtk-paste", GTK_ICON_SIZE_MENU);
+  gtk_widget_show (image8257);
+  gtk_image_menu_item_set_image (GTK_IMAGE_MENU_ITEM (paste1), image8257);
 
   delete1 = gtk_image_menu_item_new_with_mnemonic (_("_Delete"));
   gtk_widget_show (delete1);
@@ -493,9 +494,9 @@
                               GDK_Delete, (GdkModifierType)( 0 ),
                               GTK_ACCEL_VISIBLE);
 
-  image8208 = gtk_image_new_from_stock ("gtk-remove", GTK_ICON_SIZE_MENU);
-  gtk_widget_show (image8208);
-  gtk_image_menu_item_set_image (GTK_IMAGE_MENU_ITEM (delete1), image8208);
+  image8258 = gtk_image_new_from_stock ("gtk-remove", GTK_ICON_SIZE_MENU);
+  gtk_widget_show (image8258);
+  gtk_image_menu_item_set_image (GTK_IMAGE_MENU_ITEM (delete1), image8258);
 
   separator6 = gtk_separator_menu_item_new ();
   gtk_widget_show (separator6);
@@ -525,9 +526,9 @@
   gtk_widget_show (preferences1);
   gtk_container_add (GTK_CONTAINER (menuitem2_menu), preferences1);
 
-  image8209 = gtk_image_new_from_stock ("gtk-preferences", GTK_ICON_SIZE_MENU);
-  gtk_widget_show (image8209);
-  gtk_image_menu_item_set_image (GTK_IMAGE_MENU_ITEM (preferences1), image8209);
+  image8259 = gtk_image_new_from_stock ("gtk-preferences", GTK_ICON_SIZE_MENU);
+  gtk_widget_show (image8259);
+  gtk_image_menu_item_set_image (GTK_IMAGE_MENU_ITEM (preferences1), image8259);
 
   view1 = gtk_menu_item_new_with_mnemonic (_("_View"));
   gtk_widget_show (view1);
@@ -681,9 +682,9 @@
                               GDK_S, (GdkModifierType)( GDK_CONTROL_MASK | GDK_MOD1_MASK),
                               GTK_ACCEL_VISIBLE);
 
-  image8210 = gtk_image_new_from_stock ("gtk-save-as", GTK_ICON_SIZE_MENU);
-  gtk_widget_show (image8210);
-  gtk_image_menu_item_set_image (GTK_IMAGE_MENU_ITEM (save_audio1), image8210);
+  image8260 = gtk_image_new_from_stock ("gtk-save-as", GTK_ICON_SIZE_MENU);
+  gtk_widget_show (image8260);
+  gtk_image_menu_item_set_image (GTK_IMAGE_MENU_ITEM (save_audio1), image8260);
 
   audio_encoder1 = gtk_menu_item_new_with_mnemonic (_("_Encoder"));
   gtk_widget_show (audio_encoder1);
@@ -710,9 +711,9 @@
                               GDK_F7, (GdkModifierType)( 0 ),
                               GTK_ACCEL_VISIBLE);
 
-  image8211 = create_pixmap (mainWindow, "gnome-calculator_small.xpm");
-  gtk_widget_show (image8211);
-  gtk_image_menu_item_set_image (GTK_IMAGE_MENU_ITEM (calculator1), image8211);
+  image8261 = create_pixmap (mainWindow, "gnome-calculator_small.xpm");
+  gtk_widget_show (image8261);
+  gtk_image_menu_item_set_image (GTK_IMAGE_MENU_ITEM (calculator1), image8261);
 
   separator12 = gtk_separator_menu_item_new ();
   gtk_widget_show (separator12);
@@ -748,6 +749,10 @@
   gtk_widget_show (ocr_vobsub_2_srt);
   gtk_container_add (GTK_CONTAINER (tools1_menu), ocr_vobsub_2_srt);
 
+  edit_glyph1 = gtk_menu_item_new_with_mnemonic (_("Edit glyph"));
+  gtk_widget_show (edit_glyph1);
+  gtk_container_add (GTK_CONTAINER (tools1_menu), edit_glyph1);
+
   separator17 = gtk_separator_menu_item_new ();
   gtk_widget_show (separator17);
   gtk_container_add (GTK_CONTAINER (tools1_menu), separator17);
@@ -798,9 +803,9 @@
                               GDK_P, (GdkModifierType)( 0 ),
                               GTK_ACCEL_VISIBLE);
 
-  image8212 = gtk_image_new_from_stock ("gtk-media-play", GTK_ICON_SIZE_MENU);
-  gtk_widget_show (image8212);
-  gtk_image_menu_item_set_image (GTK_IMAGE_MENU_ITEM (play_video1), image8212);
+  image8262 = gtk_image_new_from_stock ("gtk-media-play", GTK_ICON_SIZE_MENU);
+  gtk_widget_show (image8262);
+  gtk_image_menu_item_set_image (GTK_IMAGE_MENU_ITEM (play_video1), image8262);
 
   previous_frame1 = gtk_image_menu_item_new_with_mnemonic (_("P_revious Frame"));
   gtk_widget_show (previous_frame1);
@@ -809,9 +814,9 @@
                               GDK_KP_4, (GdkModifierType)( 0 ),
                               GTK_ACCEL_VISIBLE);
 
-  image8213 = gtk_image_new_from_stock ("gtk-media-previous", GTK_ICON_SIZE_MENU);
-  gtk_widget_show (image8213);
-  gtk_image_menu_item_set_image (GTK_IMAGE_MENU_ITEM (previous_frame1), image8213);
+  image8263 = gtk_image_new_from_stock ("gtk-media-previous", GTK_ICON_SIZE_MENU);
+  gtk_widget_show (image8263);
+  gtk_image_menu_item_set_image (GTK_IMAGE_MENU_ITEM (previous_frame1), image8263);
 
   next_frame1 = gtk_image_menu_item_new_with_mnemonic (_("_Next Frame"));
   gtk_widget_show (next_frame1);
@@ -820,9 +825,9 @@
                               GDK_KP_6, (GdkModifierType)( 0 ),
                               GTK_ACCEL_VISIBLE);
 
-  image8214 = gtk_image_new_from_stock ("gtk-media-next", GTK_ICON_SIZE_MENU);
-  gtk_widget_show (image8214);
-  gtk_image_menu_item_set_image (GTK_IMAGE_MENU_ITEM (next_frame1), image8214);
+  image8264 = gtk_image_new_from_stock ("gtk-media-next", GTK_ICON_SIZE_MENU);
+  gtk_widget_show (image8264);
+  gtk_image_menu_item_set_image (GTK_IMAGE_MENU_ITEM (next_frame1), image8264);
 
   previous_intra_frame1 = gtk_image_menu_item_new_with_mnemonic (_("Pr_evious Intra Frame"));
   gtk_widget_show (previous_intra_frame1);
@@ -831,9 +836,9 @@
                               GDK_KP_2, (GdkModifierType)( 0 ),
                               GTK_ACCEL_VISIBLE);
 
-  image8215 = gtk_image_new_from_stock ("gtk-media-rewind", GTK_ICON_SIZE_MENU);
-  gtk_widget_show (image8215);
-  gtk_image_menu_item_set_image (GTK_IMAGE_MENU_ITEM (previous_intra_frame1), image8215);
+  image8265 = gtk_image_new_from_stock ("gtk-media-rewind", GTK_ICON_SIZE_MENU);
+  gtk_widget_show (image8265);
+  gtk_image_menu_item_set_image (GTK_IMAGE_MENU_ITEM (previous_intra_frame1), image8265);
 
   next_intra_frame1 = gtk_image_menu_item_new_with_mnemonic (_("Next _Intra Frame"));
   gtk_widget_show (next_intra_frame1);
@@ -842,9 +847,9 @@
                               GDK_KP_8, (GdkModifierType)( 0 ),
                               GTK_ACCEL_VISIBLE);
 
-  image8216 = gtk_image_new_from_stock ("gtk-media-forward", GTK_ICON_SIZE_MENU);
-  gtk_widget_show (image8216);
-  gtk_image_menu_item_set_image (GTK_IMAGE_MENU_ITEM (next_intra_frame1), image8216);
+  image8266 = gtk_image_new_from_stock ("gtk-media-forward", GTK_ICON_SIZE_MENU);
+  gtk_widget_show (image8266);
+  gtk_image_menu_item_set_image (GTK_IMAGE_MENU_ITEM (next_intra_frame1), image8266);
 
   search_previous_black_frame1 = gtk_menu_item_new_with_mnemonic (_("Previou_s Black Frame"));
   gtk_widget_show (search_previous_black_frame1);
@@ -861,9 +866,9 @@
                               GDK_Home, (GdkModifierType)( 0 ),
                               GTK_ACCEL_VISIBLE);
 
-  image8217 = gtk_image_new_from_stock ("gtk-goto-first", GTK_ICON_SIZE_MENU);
-  gtk_widget_show (image8217);
-  gtk_image_menu_item_set_image (GTK_IMAGE_MENU_ITEM (first_frame1), image8217);
+  image8267 = gtk_image_new_from_stock ("gtk-goto-first", GTK_ICON_SIZE_MENU);
+  gtk_widget_show (image8267);
+  gtk_image_menu_item_set_image (GTK_IMAGE_MENU_ITEM (first_frame1), image8267);
 
   last_frame1 = gtk_image_menu_item_new_with_mnemonic (_("_Last Frame"));
   gtk_widget_show (last_frame1);
@@ -872,9 +877,9 @@
                               GDK_End, (GdkModifierType)( 0 ),
                               GTK_ACCEL_VISIBLE);
 
-  image8218 = gtk_image_new_from_stock ("gtk-goto-last", GTK_ICON_SIZE_MENU);
-  gtk_widget_show (image8218);
-  gtk_image_menu_item_set_image (GTK_IMAGE_MENU_ITEM (last_frame1), image8218);
+  image8268 = gtk_image_new_from_stock ("gtk-goto-last", GTK_ICON_SIZE_MENU);
+  gtk_widget_show (image8268);
+  gtk_image_menu_item_set_image (GTK_IMAGE_MENU_ITEM (last_frame1), image8268);
 
   separator14 = gtk_separator_menu_item_new ();
   gtk_widget_show (separator14);
@@ -907,9 +912,9 @@
                               GDK_F, (GdkModifierType)( GDK_CONTROL_MASK),
                               GTK_ACCEL_VISIBLE);
 
-  image8219 = gtk_image_new_from_stock ("gtk-jump-to", GTK_ICON_SIZE_MENU);
-  gtk_widget_show (image8219);
-  gtk_image_menu_item_set_image (GTK_IMAGE_MENU_ITEM (jum_to_frame1), image8219);
+  image8269 = gtk_image_new_from_stock ("gtk-jump-to", GTK_ICON_SIZE_MENU);
+  gtk_widget_show (image8269);
+  gtk_image_menu_item_set_image (GTK_IMAGE_MENU_ITEM (jum_to_frame1), image8269);
 
   jump_to_time1 = gtk_image_menu_item_new_with_mnemonic (_("Jump to _Time..."));
   gtk_widget_show (jump_to_time1);
@@ -918,9 +923,9 @@
                               GDK_T, (GdkModifierType)( GDK_CONTROL_MASK),
                               GTK_ACCEL_VISIBLE);
 
-  image8220 = gtk_image_new_from_stock ("gtk-jump-to", GTK_ICON_SIZE_MENU);
-  gtk_widget_show (image8220);
-  gtk_image_menu_item_set_image (GTK_IMAGE_MENU_ITEM (jump_to_time1), image8220);
+  image8270 = gtk_image_new_from_stock ("gtk-jump-to", GTK_ICON_SIZE_MENU);
+  gtk_widget_show (image8270);
+  gtk_image_menu_item_set_image (GTK_IMAGE_MENU_ITEM (jump_to_time1), image8270);
 
   custom1 = gtk_menu_item_new_with_mnemonic (_("_Custom"));
   gtk_widget_show (custom1);
@@ -941,9 +946,9 @@
   gtk_widget_show (about1);
   gtk_container_add (GTK_CONTAINER (help2_menu), about1);
 
-  image8221 = gtk_image_new_from_stock ("gtk-about", GTK_ICON_SIZE_MENU);
-  gtk_widget_show (image8221);
-  gtk_image_menu_item_set_image (GTK_IMAGE_MENU_ITEM (about1), image8221);
+  image8271 = gtk_image_new_from_stock ("gtk-about", GTK_ICON_SIZE_MENU);
+  gtk_widget_show (image8271);
+  gtk_image_menu_item_set_image (GTK_IMAGE_MENU_ITEM (about1), image8271);
 
   toolbar2 = gtk_toolbar_new ();
   gtk_widget_show (toolbar2);
@@ -1440,11 +1445,11 @@
   GLADE_HOOKUP_OBJECT (mainWindow, menuitem1, "menuitem1");
   GLADE_HOOKUP_OBJECT (mainWindow, menuitem1_menu, "menuitem1_menu");
   GLADE_HOOKUP_OBJECT (mainWindow, open_video1, "open_video1");
-  GLADE_HOOKUP_OBJECT (mainWindow, image8196, "image8196");
+  GLADE_HOOKUP_OBJECT (mainWindow, image8246, "image8246");
   GLADE_HOOKUP_OBJECT (mainWindow, append_video1, "append_video1");
-  GLADE_HOOKUP_OBJECT (mainWindow, image8197, "image8197");
+  GLADE_HOOKUP_OBJECT (mainWindow, image8247, "image8247");
   GLADE_HOOKUP_OBJECT (mainWindow, save_stuff, "save_stuff");
-  GLADE_HOOKUP_OBJECT (mainWindow, image8198, "image8198");
+  GLADE_HOOKUP_OBJECT (mainWindow, image8248, "image8248");
   GLADE_HOOKUP_OBJECT (mainWindow, save_stuff_menu, "save_stuff_menu");
   GLADE_HOOKUP_OBJECT (mainWindow, save_as_avi1, "save_as_avi1");
   GLADE_HOOKUP_OBJECT (mainWindow, separator1, "separator1");
@@ -1454,41 +1459,41 @@
   GLADE_HOOKUP_OBJECT (mainWindow, close1, "close1");
   GLADE_HOOKUP_OBJECT (mainWindow, separator3, "separator3");
   GLADE_HOOKUP_OBJECT (mainWindow, save_project1, "save_project1");
-  GLADE_HOOKUP_OBJECT (mainWindow, image8199, "image8199");
+  GLADE_HOOKUP_OBJECT (mainWindow, image8249, "image8249");
   GLADE_HOOKUP_OBJECT (mainWindow, save_project_as1, "save_project_as1");
-  GLADE_HOOKUP_OBJECT (mainWindow, image8200, "image8200");
+  GLADE_HOOKUP_OBJECT (mainWindow, image8250, "image8250");
   GLADE_HOOKUP_OBJECT (mainWindow, run_script1, "run_script1");
-  GLADE_HOOKUP_OBJECT (mainWindow, image8201, "image8201");
+  GLADE_HOOKUP_OBJECT (mainWindow, image8251, "image8251");
   GLADE_HOOKUP_OBJECT (mainWindow, add_to_joblist1, "add_to_joblist1");
   GLADE_HOOKUP_OBJECT (mainWindow, joblist1, "joblist1");
   GLADE_HOOKUP_OBJECT (mainWindow, separator16, "separator16");
   GLADE_HOOKUP_OBJECT (mainWindow, connect_to_avsproxy1, "connect_to_avsproxy1");
   GLADE_HOOKUP_OBJECT (mainWindow, separator18, "separator18");
   GLADE_HOOKUP_OBJECT (mainWindow, video_informations1, "video_informations1");
-  GLADE_HOOKUP_OBJECT (mainWindow, image8202, "image8202");
+  GLADE_HOOKUP_OBJECT (mainWindow, image8252, "image8252");
   GLADE_HOOKUP_OBJECT (mainWindow, avi_muxer_options1, "avi_muxer_options1");
   GLADE_HOOKUP_OBJECT (mainWindow, separator4, "separator4");
   GLADE_HOOKUP_OBJECT (mainWindow, quit1, "quit1");
-  GLADE_HOOKUP_OBJECT (mainWindow, image8203, "image8203");
+  GLADE_HOOKUP_OBJECT (mainWindow, image8253, "image8253");
   GLADE_HOOKUP_OBJECT (mainWindow, menuitem2, "menuitem2");
   GLADE_HOOKUP_OBJECT (mainWindow, menuitem2_menu, "menuitem2_menu");
   GLADE_HOOKUP_OBJECT (mainWindow, reset_edits1, "reset_edits1");
-  GLADE_HOOKUP_OBJECT (mainWindow, image8204, "image8204");
+  GLADE_HOOKUP_OBJECT (mainWindow, image8254, "image8254");
   GLADE_HOOKUP_OBJECT (mainWindow, separator5, "separator5");
   GLADE_HOOKUP_OBJECT (mainWindow, cut1, "cut1");
-  GLADE_HOOKUP_OBJECT (mainWindow, image8205, "image8205");
+  GLADE_HOOKUP_OBJECT (mainWindow, image8255, "image8255");
   GLADE_HOOKUP_OBJECT (mainWindow, copy1, "copy1");
-  GLADE_HOOKUP_OBJECT (mainWindow, image8206, "image8206");
+  GLADE_HOOKUP_OBJECT (mainWindow, image8256, "image8256");
   GLADE_HOOKUP_OBJECT (mainWindow, paste1, "paste1");
-  GLADE_HOOKUP_OBJECT (mainWindow, image8207, "image8207");
+  GLADE_HOOKUP_OBJECT (mainWindow, image8257, "image8257");
   GLADE_HOOKUP_OBJECT (mainWindow, delete1, "delete1");
-  GLADE_HOOKUP_OBJECT (mainWindow, image8208, "image8208");
+  GLADE_HOOKUP_OBJECT (mainWindow, image8258, "image8258");
   GLADE_HOOKUP_OBJECT (mainWindow, separator6, "separator6");
   GLADE_HOOKUP_OBJECT (mainWindow, set_marker_a1, "set_marker_a1");
   GLADE_HOOKUP_OBJECT (mainWindow, set_marker_b1, "set_marker_b1");
   GLADE_HOOKUP_OBJECT (mainWindow, separator7, "separator7");
   GLADE_HOOKUP_OBJECT (mainWindow, preferences1, "preferences1");
-  GLADE_HOOKUP_OBJECT (mainWindow, image8209, "image8209");
+  GLADE_HOOKUP_OBJECT (mainWindow, image8259, "image8259");
   GLADE_HOOKUP_OBJECT (mainWindow, view1, "view1");
   GLADE_HOOKUP_OBJECT (mainWindow, view1_menu, "view1_menu");
   GLADE_HOOKUP_OBJECT (mainWindow, toolbar1, "toolbar1");
@@ -1517,13 +1522,13 @@
   GLADE_HOOKUP_OBJECT (mainWindow, build_vbr_time_map1, "build_vbr_time_map1");
   GLADE_HOOKUP_OBJECT (mainWindow, separator11, "separator11");
   GLADE_HOOKUP_OBJECT (mainWindow, save_audio1, "save_audio1");
-  GLADE_HOOKUP_OBJECT (mainWindow, image8210, "image8210");
+  GLADE_HOOKUP_OBJECT (mainWindow, image8260, "image8260");
   GLADE_HOOKUP_OBJECT (mainWindow, audio_encoder1, "audio_encoder1");
   GLADE_HOOKUP_OBJECT (mainWindow, filters2, "filters2");
   GLADE_HOOKUP_OBJECT (mainWindow, tools1, "tools1");
   GLADE_HOOKUP_OBJECT (mainWindow, tools1_menu, "tools1_menu");
   GLADE_HOOKUP_OBJECT (mainWindow, calculator1, "calculator1");
-  GLADE_HOOKUP_OBJECT (mainWindow, image8211, "image8211");
+  GLADE_HOOKUP_OBJECT (mainWindow, image8261, "image8261");
   GLADE_HOOKUP_OBJECT (mainWindow, separator12, "separator12");
   GLADE_HOOKUP_OBJECT (mainWindow, rebuild_frames, "rebuild_frames");
   GLADE_HOOKUP_OBJECT (mainWindow, check_frames, "check_frames");
@@ -1532,6 +1537,7 @@
   GLADE_HOOKUP_OBJECT (mainWindow, separator13, "separator13");
   GLADE_HOOKUP_OBJECT (mainWindow, v2v, "v2v");
   GLADE_HOOKUP_OBJECT (mainWindow, ocr_vobsub_2_srt, "ocr_vobsub_2_srt");
+  GLADE_HOOKUP_OBJECT (mainWindow, edit_glyph1, "edit_glyph1");
   GLADE_HOOKUP_OBJECT (mainWindow, separator17, "separator17");
   GLADE_HOOKUP_OBJECT (mainWindow, see_hex1, "see_hex1");
   GLADE_HOOKUP_OBJECT (mainWindow, help1, "help1");
@@ -1544,35 +1550,35 @@
   GLADE_HOOKUP_OBJECT (mainWindow, go1, "go1");
   GLADE_HOOKUP_OBJECT (mainWindow, go1_menu, "go1_menu");
   GLADE_HOOKUP_OBJECT (mainWindow, play_video1, "play_video1");
-  GLADE_HOOKUP_OBJECT (mainWindow, image8212, "image8212");
+  GLADE_HOOKUP_OBJECT (mainWindow, image8262, "image8262");
   GLADE_HOOKUP_OBJECT (mainWindow, previous_frame1, "previous_frame1");
-  GLADE_HOOKUP_OBJECT (mainWindow, image8213, "image8213");
+  GLADE_HOOKUP_OBJECT (mainWindow, image8263, "image8263");
   GLADE_HOOKUP_OBJECT (mainWindow, next_frame1, "next_frame1");
-  GLADE_HOOKUP_OBJECT (mainWindow, image8214, "image8214");
+  GLADE_HOOKUP_OBJECT (mainWindow, image8264, "image8264");
   GLADE_HOOKUP_OBJECT (mainWindow, previous_intra_frame1, "previous_intra_frame1");
-  GLADE_HOOKUP_OBJECT (mainWindow, image8215, "image8215");
+  GLADE_HOOKUP_OBJECT (mainWindow, image8265, "image8265");
   GLADE_HOOKUP_OBJECT (mainWindow, next_intra_frame1, "next_intra_frame1");
-  GLADE_HOOKUP_OBJECT (mainWindow, image8216, "image8216");
+  GLADE_HOOKUP_OBJECT (mainWindow, image8266, "image8266");
   GLADE_HOOKUP_OBJECT (mainWindow, search_previous_black_frame1, "search_previous_black_frame1");
   GLADE_HOOKUP_OBJECT (mainWindow, search_next_black_frame1, "search_next_black_frame1");
   GLADE_HOOKUP_OBJECT (mainWindow, first_frame1, "first_frame1");
-  GLADE_HOOKUP_OBJECT (mainWindow, image8217, "image8217");
+  GLADE_HOOKUP_OBJECT (mainWindow, image8267, "image8267");
   GLADE_HOOKUP_OBJECT (mainWindow, last_frame1, "last_frame1");
-  GLADE_HOOKUP_OBJECT (mainWindow, image8218, "image8218");
+  GLADE_HOOKUP_OBJECT (mainWindow, image8268, "image8268");
   GLADE_HOOKUP_OBJECT (mainWindow, separator14, "separator14");
   GLADE_HOOKUP_OBJECT (mainWindow, go_to_marker_a1, "go_to_marker_a1");
   GLADE_HOOKUP_OBJECT (mainWindow, go_to_marker_b1, "go_to_marker_b1");
   GLADE_HOOKUP_OBJECT (mainWindow, separator15, "separator15");
   GLADE_HOOKUP_OBJECT (mainWindow, jum_to_frame1, "jum_to_frame1");
-  GLADE_HOOKUP_OBJECT (mainWindow, image8219, "image8219");
+  GLADE_HOOKUP_OBJECT (mainWindow, image8269, "image8269");
   GLADE_HOOKUP_OBJECT (mainWindow, jump_to_time1, "jump_to_time1");
-  GLADE_HOOKUP_OBJECT (mainWindow, image8220, "image8220");
+  GLADE_HOOKUP_OBJECT (mainWindow, image8270, "image8270");
   GLADE_HOOKUP_OBJECT (mainWindow, custom1, "custom1");
   GLADE_HOOKUP_OBJECT (mainWindow, help2, "help2");
   GLADE_HOOKUP_OBJECT (mainWindow, help2_menu, "help2_menu");
   GLADE_HOOKUP_OBJECT (mainWindow, show_builtin_support1, "show_builtin_support1");
   GLADE_HOOKUP_OBJECT (mainWindow, about1, "about1");
-  GLADE_HOOKUP_OBJECT (mainWindow, image8221, "image8221");
+  GLADE_HOOKUP_OBJECT (mainWindow, image8271, "image8271");
   GLADE_HOOKUP_OBJECT (mainWindow, toolbar2, "toolbar2");
   GLADE_HOOKUP_OBJECT (mainWindow, menutoolbuttonOpen, "menutoolbuttonOpen");
   GLADE_HOOKUP_OBJECT (mainWindow, toolitem11, "toolitem11");

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_menumap.h
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_menumap.h	2007-07-08 17:19:30 UTC (rev 3347)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_menumap.h	2007-07-08 17:52:05 UTC (rev 3348)
@@ -101,5 +101,6 @@
 CALLBACK(zoom_1_1                                   ,ACT_ZOOM_1_1);
 CALLBACK(zoom_2_1                                   ,ACT_ZOOM_2_1);
 CALLBACK(zoom_4_1                                   ,ACT_ZOOM_4_1);
+CALLBACK(edit_glyph1                                ,ACT_GLYPHEDIT);
 
 

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_ocr/CMakeLists.txt
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_ocr/CMakeLists.txt	2007-07-08 17:19:30 UTC (rev 3347)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_ocr/CMakeLists.txt	2007-07-08 17:52:05 UTC (rev 3348)
@@ -6,6 +6,7 @@
 #
 SET(${ADM_LIB}_SRCS
 adm_ocr.cpp
+adm_editglyph.cpp
 )
 ADD_LIBRARY(${ADM_LIB} STATIC ${${ADM_LIB}_SRCS})
 ADD_ADM_LIB(${ADM_LIB} ADM_libraries)

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_ocr/adm_editglyph.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_ocr/adm_editglyph.cpp	2007-07-08 17:19:30 UTC (rev 3347)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_ocr/adm_editglyph.cpp	2007-07-08 17:52:05 UTC (rev 3348)
@@ -34,6 +34,7 @@
 static GtkWidget *dialog;
 
 static uint8_t loadGlyph(char *name,admGlyph *head,uint32_t *outNb);
+static uint8_t saveGlyph(char *name,admGlyph *head,uint32_t nb);
 static gboolean glyphDraw( void );
 static void glyphUpdate(void );
 /**
@@ -76,12 +77,21 @@
   gtk_register_dialog(dialog);
   
   // Register callbacks
-  #define ASSOCIATE(x,y)   gtk_dialog_add_action_widget (GTK_DIALOG (dialog), WID(x),y)
-  #define CONNECT(x,y,z) 	gtk_signal_connect(GTK_OBJECT(WID(x)), #y,GTK_SIGNAL_FUNC(z),   NULL);
+#define ASSOCIATE(x,y)   gtk_dialog_add_action_widget (GTK_DIALOG (dialog), WID(x),y)
+#define CONNECT(x,y,z) 	gtk_signal_connect(GTK_OBJECT(WID(x)), #y,GTK_SIGNAL_FUNC(z),   NULL);
 #define ACTION_PREV 10
 #define ACTION_NEXT 20
+#define ACTION_PREV_EMPTY 30
+#define ACTION_NEXT_EMPTY 40
+#define ACTION_SAVE 50
+#define ACTION_DELETE 60
+  
   ASSOCIATE(buttonPrev,ACTION_PREV);
   ASSOCIATE(buttonNext,ACTION_NEXT);
+  ASSOCIATE(buttonEmptyPrev,ACTION_PREV_EMPTY);
+  ASSOCIATE(buttonNextEmpty,ACTION_NEXT_EMPTY);
+  ASSOCIATE(buttonSave,ACTION_SAVE);
+  ASSOCIATE(buttonDelete,ACTION_DELETE);
   
   CONNECT(drawingarea1,expose_event,glyphDraw);
   gtk_widget_show(dialog);
@@ -113,6 +123,67 @@
                           glyphUpdate();
                         }
                         continue;break; 
+      case ACTION_NEXT_EMPTY: 
+                        printf("NEXT EMPTY\n");
+                        while(1)
+                        {
+                            if(currentGlyph->next)
+                            {
+                              currentGlyph=currentGlyph->next; 
+                              glyphUpdate();
+                              if(!currentGlyph->code || !*(currentGlyph->code))
+                              {
+                                break;
+                              }
+                            }
+                            else 
+                            {
+                              GUI_Error_HIG(_("End reached"),_("No more glyphs"));
+                              break;
+                            }
+                        }
+                        continue;break; 
+        case ACTION_PREV_EMPTY: 
+                        printf("PREV EMPTY\n");
+                        while(1)
+                        {
+                            if(currentGlyph!=head.next)
+                            {
+                              admGlyph *father;
+                              father=glyphSearchFather(currentGlyph,&head);
+                              if(father)
+                              {
+                                  currentGlyph=father;
+                                  glyphUpdate();
+                                   if(!currentGlyph->code || !*(currentGlyph->code))
+                                    {
+                                      break;
+                                    }
+                                  continue;
+                              } 
+                            } 
+                            GUI_Error_HIG(_("Head reached"),_("No more glyphs"));
+                            break;
+                        }
+                        continue;break;
+      case ACTION_SAVE:
+                    saveGlyph(glyphName,&head,nbGlyph);
+                    continue;break;
+      case ACTION_DELETE:
+                  {
+                      admGlyph *father;
+                      father=glyphSearchFather(currentGlyph,&head);
+                      ADM_assert(father);
+                      father->next=currentGlyph->next;
+                      delete currentGlyph;
+                      
+                      currentGlyph=father;
+                        if(father==&head && head.next)
+                          currentGlyph=head.next;
+                      nbGlyph--;
+                      glyphUpdate();
+                      continue;break; 
+                  }
     }
     break; // exit while(1)
   }
@@ -125,6 +196,43 @@
 
 }
 /**
+    \fn       glyphSave
+    \brief    Save the glypset
+*/
+uint8_t saveGlyph(char *name,admGlyph *head,uint32_t nb)
+{
+  FILE *out;
+  uint32_t slen;
+    
+  admGlyph *glyph=head->next;
+    
+    
+  out=fopen(name,"wb");
+  if(!out)
+  {
+    GUI_Error_HIG(_("Could not write the file"), NULL);
+    return 0;
+  }
+#define WRITE(x) fwrite(&(x),sizeof(x),1,out);
+    WRITE(nb);
+    
+    while(glyph)
+    {
+      WRITE(glyph->width);
+      WRITE(glyph->height);
+      fwrite(glyph->data,glyph->width*glyph->height,1,out);
+      if(glyph->code) slen=strlen(glyph->code);
+      else slen=0;
+      WRITE(slen);
+      fwrite(glyph->code,slen,1,out);
+      glyph=glyph->next;
+    }
+    
+    fclose(out);
+    return 1;
+  
+}
+/**
     \fn glyphUpdate
     \brief Update all fields in the dialog wrt currentGlyph
 */
@@ -133,9 +241,9 @@
   if(!currentGlyph) return;
   gtk_widget_set_usize(WID(drawingarea1), currentGlyph->width+4, currentGlyph->height+4);
   glyphDraw();
+  gtk_editable_delete_text(GTK_EDITABLE(WID(entry1)), 0,-1); 
   if(currentGlyph->code)
   {
-    gtk_editable_delete_text(GTK_EDITABLE(WID(entry1)), 0,-1); 
     // Set our text
     gtk_entry_set_text (GTK_ENTRY (WID(entry1)), currentGlyph->code);
   }
@@ -206,18 +314,30 @@
 
 
 //**********************************
-GtkWidget *create_dialog1 (void)
+
+GtkWidget*
+create_dialog1 (void)
 {
   GtkWidget *dialog1;
   GtkWidget *dialog_vbox1;
   GtkWidget *vbox2;
   GtkWidget *drawingarea1;
   GtkWidget *entry1;
-  GtkWidget *hbox1;
+  GtkWidget *table1;
+  GtkWidget *buttonNext;
   GtkWidget *buttonPrev;
-  GtkWidget *buttonNext;
-  GtkWidget *hseparator1;
-  GtkWidget *button3;
+  GtkWidget *buttonEmptyPrev;
+  GtkWidget *alignment2;
+  GtkWidget *hbox4;
+  GtkWidget *image2;
+  GtkWidget *label2;
+  GtkWidget *buttonNextEmpty;
+  GtkWidget *alignment3;
+  GtkWidget *hbox5;
+  GtkWidget *image3;
+  GtkWidget *label3;
+  GtkWidget *buttonDelete;
+  GtkWidget *buttonSave;
   GtkWidget *dialog_action_area1;
   GtkWidget *closebutton1;
 
@@ -240,26 +360,78 @@
   gtk_widget_show (entry1);
   gtk_box_pack_start (GTK_BOX (vbox2), entry1, FALSE, FALSE, 0);
 
-  hbox1 = gtk_hbox_new (FALSE, 0);
-  gtk_widget_show (hbox1);
-  gtk_box_pack_start (GTK_BOX (vbox2), hbox1, TRUE, TRUE, 0);
+  table1 = gtk_table_new (3, 2, FALSE);
+  gtk_widget_show (table1);
+  gtk_box_pack_start (GTK_BOX (vbox2), table1, TRUE, TRUE, 0);
 
+  buttonNext = gtk_button_new_from_stock ("gtk-media-next");
+  gtk_widget_show (buttonNext);
+  gtk_table_attach (GTK_TABLE (table1), buttonNext, 1, 2, 0, 1,
+                    (GtkAttachOptions) (GTK_EXPAND | GTK_SHRINK | GTK_FILL),
+                    (GtkAttachOptions) (GTK_EXPAND | GTK_SHRINK), 0, 0);
+
   buttonPrev = gtk_button_new_from_stock ("gtk-media-previous");
   gtk_widget_show (buttonPrev);
-  gtk_box_pack_start (GTK_BOX (hbox1), buttonPrev, TRUE, TRUE, 0);
+  gtk_table_attach (GTK_TABLE (table1), buttonPrev, 0, 1, 0, 1,
+                    (GtkAttachOptions) (GTK_EXPAND | GTK_SHRINK | GTK_FILL),
+                    (GtkAttachOptions) (GTK_EXPAND | GTK_SHRINK | GTK_FILL), 0, 0);
 
-  buttonNext = gtk_button_new_from_stock ("gtk-media-next");
-  gtk_widget_show (buttonNext);
-  gtk_box_pack_start (GTK_BOX (hbox1), buttonNext, TRUE, TRUE, 0);
+  buttonEmptyPrev = gtk_button_new ();
+  gtk_widget_show (buttonEmptyPrev);
+  gtk_table_attach (GTK_TABLE (table1), buttonEmptyPrev, 0, 1, 1, 2,
+                    (GtkAttachOptions) (GTK_EXPAND | GTK_SHRINK | GTK_FILL),
+                    (GtkAttachOptions) (GTK_EXPAND | GTK_SHRINK), 0, 0);
 
-  hseparator1 = gtk_hseparator_new ();
-  gtk_widget_show (hseparator1);
-  gtk_box_pack_start (GTK_BOX (hbox1), hseparator1, TRUE, TRUE, 0);
+  alignment2 = gtk_alignment_new (0.5, 0.5, 0, 0);
+  gtk_widget_show (alignment2);
+  gtk_container_add (GTK_CONTAINER (buttonEmptyPrev), alignment2);
 
-  button3 = gtk_button_new_from_stock ("gtk-save-as");
-  gtk_widget_show (button3);
-  gtk_box_pack_start (GTK_BOX (hbox1), button3, FALSE, FALSE, 0);
+  hbox4 = gtk_hbox_new (FALSE, 2);
+  gtk_widget_show (hbox4);
+  gtk_container_add (GTK_CONTAINER (alignment2), hbox4);
 
+  image2 = gtk_image_new_from_stock ("gtk-media-previous", GTK_ICON_SIZE_BUTTON);
+  gtk_widget_show (image2);
+  gtk_box_pack_start (GTK_BOX (hbox4), image2, FALSE, FALSE, 0);
+
+  label2 = gtk_label_new_with_mnemonic (_("Prev. Empty"));
+  gtk_widget_show (label2);
+  gtk_box_pack_start (GTK_BOX (hbox4), label2, FALSE, FALSE, 0);
+
+  buttonNextEmpty = gtk_button_new ();
+  gtk_widget_show (buttonNextEmpty);
+  gtk_table_attach (GTK_TABLE (table1), buttonNextEmpty, 1, 2, 1, 2,
+                    (GtkAttachOptions) (GTK_EXPAND | GTK_SHRINK | GTK_FILL),
+                    (GtkAttachOptions) (GTK_EXPAND | GTK_SHRINK), 0, 0);
+
+  alignment3 = gtk_alignment_new (0.5, 0.5, 0, 0);
+  gtk_widget_show (alignment3);
+  gtk_container_add (GTK_CONTAINER (buttonNextEmpty), alignment3);
+
+  hbox5 = gtk_hbox_new (FALSE, 2);
+  gtk_widget_show (hbox5);
+  gtk_container_add (GTK_CONTAINER (alignment3), hbox5);
+
+  image3 = gtk_image_new_from_stock ("gtk-media-next", GTK_ICON_SIZE_BUTTON);
+  gtk_widget_show (image3);
+  gtk_box_pack_start (GTK_BOX (hbox5), image3, FALSE, FALSE, 0);
+
+  label3 = gtk_label_new_with_mnemonic (_("Next Empty"));
+  gtk_widget_show (label3);
+  gtk_box_pack_start (GTK_BOX (hbox5), label3, FALSE, FALSE, 0);
+
+  buttonDelete = gtk_button_new_from_stock ("gtk-delete");
+  gtk_widget_show (buttonDelete);
+  gtk_table_attach (GTK_TABLE (table1), buttonDelete, 0, 1, 2, 3,
+                    (GtkAttachOptions) (GTK_FILL),
+                    (GtkAttachOptions) (0), 0, 0);
+
+  buttonSave = gtk_button_new_from_stock ("gtk-save");
+  gtk_widget_show (buttonSave);
+  gtk_table_attach (GTK_TABLE (table1), buttonSave, 1, 2, 2, 3,
+                    (GtkAttachOptions) (GTK_FILL),
+                    (GtkAttachOptions) (0), 0, 0);
+
   dialog_action_area1 = GTK_DIALOG (dialog1)->action_area;
   gtk_widget_show (dialog_action_area1);
   gtk_button_box_set_layout (GTK_BUTTON_BOX (dialog_action_area1), GTK_BUTTONBOX_END);
@@ -275,15 +447,24 @@
   GLADE_HOOKUP_OBJECT (dialog1, vbox2, "vbox2");
   GLADE_HOOKUP_OBJECT (dialog1, drawingarea1, "drawingarea1");
   GLADE_HOOKUP_OBJECT (dialog1, entry1, "entry1");
-  GLADE_HOOKUP_OBJECT (dialog1, hbox1, "hbox1");
+  GLADE_HOOKUP_OBJECT (dialog1, table1, "table1");
+  GLADE_HOOKUP_OBJECT (dialog1, buttonNext, "buttonNext");
   GLADE_HOOKUP_OBJECT (dialog1, buttonPrev, "buttonPrev");
-  GLADE_HOOKUP_OBJECT (dialog1, buttonNext, "buttonNext");
-  GLADE_HOOKUP_OBJECT (dialog1, hseparator1, "hseparator1");
-  GLADE_HOOKUP_OBJECT (dialog1, button3, "button3");
+  GLADE_HOOKUP_OBJECT (dialog1, buttonEmptyPrev, "buttonEmptyPrev");
+  GLADE_HOOKUP_OBJECT (dialog1, alignment2, "alignment2");
+  GLADE_HOOKUP_OBJECT (dialog1, hbox4, "hbox4");
+  GLADE_HOOKUP_OBJECT (dialog1, image2, "image2");
+  GLADE_HOOKUP_OBJECT (dialog1, label2, "label2");
+  GLADE_HOOKUP_OBJECT (dialog1, buttonNextEmpty, "buttonNextEmpty");
+  GLADE_HOOKUP_OBJECT (dialog1, alignment3, "alignment3");
+  GLADE_HOOKUP_OBJECT (dialog1, hbox5, "hbox5");
+  GLADE_HOOKUP_OBJECT (dialog1, image3, "image3");
+  GLADE_HOOKUP_OBJECT (dialog1, label3, "label3");
+  GLADE_HOOKUP_OBJECT (dialog1, buttonDelete, "buttonDelete");
+  GLADE_HOOKUP_OBJECT (dialog1, buttonSave, "buttonSave");
   GLADE_HOOKUP_OBJECT_NO_REF (dialog1, dialog_action_area1, "dialog_action_area1");
   GLADE_HOOKUP_OBJECT (dialog1, closebutton1, "closebutton1");
 
   return dialog1;
 }
 
-

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_NONE/ADM_dialog/DIA_none.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_NONE/ADM_dialog/DIA_none.cpp	2007-07-08 17:19:30 UTC (rev 3347)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_NONE/ADM_dialog/DIA_none.cpp	2007-07-08 17:52:05 UTC (rev 3348)
@@ -158,5 +158,5 @@
     printf("*********************************\n");
     printf("*********************************\n");
 }
-
+uint8_t DIA_glyphEdit(void) {return 0;};
 //EOF

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_none.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_none.cpp	2007-07-08 17:19:30 UTC (rev 3347)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_none.cpp	2007-07-08 17:52:05 UTC (rev 3348)
@@ -97,8 +97,8 @@
 uint8_t initFileSelector(void){return 0;}
 uint8_t initGUI( void ){return 1;}
 int DIA_colorSel(uint8_t *r, uint8_t *g, uint8_t *b) {return 0;}
+uint8_t DIA_glyphEdit(void){ return 0;};
 
-
 int32_t UI_readJog(void)
 {
   return 0; 

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_jobs.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_jobs.cpp	2007-07-08 17:19:30 UTC (rev 3347)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_jobs.cpp	2007-07-08 17:52:05 UTC (rev 3348)
@@ -6,6 +6,7 @@
 
 #include <stdio.h>
 #include <stdlib.h>
+#include <unistd.h>
 #include <math.h>
 
 

Modified: branches/avidemux_2.4_branch/avidemux/gtk_gui.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/gtk_gui.cpp	2007-07-08 17:19:30 UTC (rev 3347)
+++ branches/avidemux_2.4_branch/avidemux/gtk_gui.cpp	2007-07-08 17:52:05 UTC (rev 3348)
@@ -170,6 +170,7 @@
 void GUI_avsProxy(void);
 uint8_t GUI_close(void);
 extern void A_jog(void);
+extern void DIA_glyphEdit(void);
 //___________________________________________
 // serialization of user event throught gui
 //
@@ -197,6 +198,9 @@
   }
   switch (action)
     {
+        case ACT_GLYPHEDIT: 
+                                DIA_glyphEdit();
+                                return;
         case ACT_AVS_PROXY:
                                 GUI_avsProxy();
                                 return;

Modified: branches/avidemux_2.4_branch/avidemux/gui_action.hxx
===================================================================
--- branches/avidemux_2.4_branch/avidemux/gui_action.hxx	2007-07-08 17:19:30 UTC (rev 3347)
+++ branches/avidemux_2.4_branch/avidemux/gui_action.hxx	2007-07-08 17:52:05 UTC (rev 3348)
@@ -192,6 +192,7 @@
 ACT_HEX_DUMP,
 ACT_AVS_PROXY,
 ACT_JOG,
+ACT_GLYPHEDIT,
 ACT_CUSTOM_BASE,
 ACT_CUSTOM_END=ACT_CUSTOM_BASE+ADM_MAC_CUSTOM_SCRIPT,
 ACT_DUMMY



From gruntster at mail.berlios.de  Mon Jul  9 14:13:37 2007
From: gruntster at mail.berlios.de (gruntster at mail.berlios.de)
Date: Mon, 9 Jul 2007 14:13:37 +0200
Subject: [Avidemux-svn-commit] r3349 -
	branches/avidemux_2.4_branch/avidemux/ADM_inputs/ADM_openDML
Message-ID: <200707091213.l69CDb6O000425@sheep.berlios.de>

Author: gruntster
Date: 2007-07-09 14:13:24 +0200 (Mon, 09 Jul 2007)
New Revision: 3349

Modified:
   branches/avidemux_2.4_branch/avidemux/ADM_inputs/ADM_openDML/ADM_odml_odml.cpp
Log:
fix OpenDML indexer to work with GCC 4.2

Modified: branches/avidemux_2.4_branch/avidemux/ADM_inputs/ADM_openDML/ADM_odml_odml.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_inputs/ADM_openDML/ADM_odml_odml.cpp	2007-07-08 17:52:05 UTC (rev 3348)
+++ branches/avidemux_2.4_branch/avidemux/ADM_inputs/ADM_openDML/ADM_odml_odml.cpp	2007-07-09 12:13:24 UTC (rev 3349)
@@ -40,7 +40,7 @@
 //#define OPENDML_VERBOSE
 
 #if defined( ADM_WIN32) || defined(ARCH_X86_64)
-	#define PPACKED __attribute__ ((packed))
+	#define PPACKED __attribute__ ((packed, gcc_struct))
 #else
 	#define PPACKED 
 #endif



From gruntster at mail.berlios.de  Mon Jul  9 14:34:00 2007
From: gruntster at mail.berlios.de (gruntster at mail.berlios.de)
Date: Mon, 9 Jul 2007 14:34:00 +0200
Subject: [Avidemux-svn-commit] r3350 - branches/avidemux_2.4_branch/avidemux
Message-ID: <200707091234.l69CY0Vj001585@sheep.berlios.de>

Author: gruntster
Date: 2007-07-09 14:33:51 +0200 (Mon, 09 Jul 2007)
New Revision: 3350

Modified:
   branches/avidemux_2.4_branch/avidemux/main.cpp
Log:
log GCC version

Modified: branches/avidemux_2.4_branch/avidemux/main.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/main.cpp	2007-07-09 12:13:24 UTC (rev 3349)
+++ branches/avidemux_2.4_branch/avidemux/main.cpp	2007-07-09 12:33:51 UTC (rev 3350)
@@ -133,8 +133,12 @@
     printf(" MacOsX    : Kuisathaverat\n");
     printf(" Win32     : Gruntster\n\n");
 
-	printf("Compiled for ");
+#ifdef __GNUC__
+	printf("Compiler: GCC %s\n", __VERSION__);
+#endif
 
+	printf("Build Target: ");
+
 #if defined(ADM_WIN32)
 	printf("Microsoft Windows");
 #elif defined(__APPLE__)



From gruntster at mail.berlios.de  Mon Jul  9 15:58:44 2007
From: gruntster at mail.berlios.de (gruntster at mail.berlios.de)
Date: Mon, 9 Jul 2007 15:58:44 +0200
Subject: [Avidemux-svn-commit] r3351 -
	branches/avidemux_2.4_branch/avidemux/winInstaller
Message-ID: <200707091358.l69DwiMg009444@sheep.berlios.de>

Author: gruntster
Date: 2007-07-09 15:57:47 +0200 (Mon, 09 Jul 2007)
New Revision: 3351

Modified:
   branches/avidemux_2.4_branch/avidemux/winInstaller/avidemux.nsi
Log:
add gtk2_prefs to installer (Win32)

Modified: branches/avidemux_2.4_branch/avidemux/winInstaller/avidemux.nsi
===================================================================
--- branches/avidemux_2.4_branch/avidemux/winInstaller/avidemux.nsi	2007-07-09 12:33:51 UTC (rev 3350)
+++ branches/avidemux_2.4_branch/avidemux/winInstaller/avidemux.nsi	2007-07-09 13:57:47 UTC (rev 3351)
@@ -140,6 +140,7 @@
         File /r ..\..\..\avidemux_2.4_build\share\themes\*
         SetOutPath $INSTDIR
         File ..\..\..\avidemux_2.4_build\avidemux2_gtk.exe
+        File ..\..\..\avidemux_2.4_build\gtk2_prefs.exe
         File ..\..\..\avidemux_2.4_build\libatk-1.0-0.dll
         File ..\..\..\avidemux_2.4_build\libcairo-2.dll
         File ..\..\..\avidemux_2.4_build\libgdk_pixbuf-2.0-0.dll
@@ -545,6 +546,7 @@
     Delete /REBOOTOK $INSTDIR\libgdk_pixbuf-2.0-0.dll
     Delete /REBOOTOK $INSTDIR\libcairo-2.dll
     Delete /REBOOTOK $INSTDIR\libatk-1.0-0.dll
+    Delete /REBOOTOK $INSTDIR\gtk2_prefs.exe
     Delete /REBOOTOK $INSTDIR\avidemux2_gtk.exe
     RmDir /r /REBOOTOK $INSTDIR\share\themes
     RmDir /r /REBOOTOK $INSTDIR\lib\gtk-2.0



From gruntster at mail.berlios.de  Mon Jul  9 16:04:32 2007
From: gruntster at mail.berlios.de (gruntster at mail.berlios.de)
Date: Mon, 9 Jul 2007 16:04:32 +0200
Subject: [Avidemux-svn-commit] r3352 - in
	branches/avidemux_2.4_branch/avidemux: . ADM_osSupport
Message-ID: <200707091404.l69E4WI3009938@sheep.berlios.de>

Author: gruntster
Date: 2007-07-09 16:04:04 +0200 (Mon, 09 Jul 2007)
New Revision: 3352

Modified:
   branches/avidemux_2.4_branch/avidemux/ADM_osSupport/win32.cpp
   branches/avidemux_2.4_branch/avidemux/main.cpp
Log:
log OS version (Win32)

Modified: branches/avidemux_2.4_branch/avidemux/ADM_osSupport/win32.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_osSupport/win32.cpp	2007-07-09 13:57:47 UTC (rev 3351)
+++ branches/avidemux_2.4_branch/avidemux/ADM_osSupport/win32.cpp	2007-07-09 14:04:04 UTC (rev 3352)
@@ -191,5 +191,238 @@
 
 	return 0;
 }
+
+#ifndef PRODUCT_BUSINESS
+#define PRODUCT_BUSINESS 0x00000006
 #endif
 
+#ifndef PRODUCT_BUSINESS_N
+#define PRODUCT_BUSINESS_N 0x00000010
+#endif
+
+#ifndef PRODUCT_HOME_BASIC
+#define PRODUCT_HOME_BASIC 0x00000002
+#endif
+
+#ifndef PRODUCT_HOME_BASIC_N
+#define PRODUCT_HOME_BASIC_N 0x00000005
+#endif
+
+#ifndef PRODUCT_HOME_PREMIUM
+#define PRODUCT_HOME_PREMIUM 0x00000003
+#endif 
+
+#ifndef PRODUCT_STARTER
+#define PRODUCT_STARTER 0x0000000B
+#endif
+
+#ifndef PRODUCT_ENTERPRISE
+#define PRODUCT_ENTERPRISE 0x00000004
+#endif 
+
+#ifndef PRODUCT_ULTIMATE
+#define PRODUCT_ULTIMATE 0x00000001
+#endif
+
+bool getWindowsVersion(char* version)
+{
+	int index = 0;
+	OSVERSIONINFOEX osvi = {};
+
+	osvi.dwOSVersionInfoSize = sizeof(OSVERSIONINFOEX);
+
+	if (!GetVersionEx((OSVERSIONINFO*)&osvi))
+		return false;
+
+	if (osvi.dwPlatformId != VER_PLATFORM_WIN32_NT)
+		return false;
+// Vista
+	if (osvi.dwMajorVersion == 6 && osvi.dwMinorVersion == 0)
+	{
+		if (osvi.wProductType == VER_NT_WORKSTATION)
+		{
+			index += sprintf(version + index, "Microsoft Windows Vista");
+
+			uint32_t productType = 0;
+
+			HMODULE hKernel = GetModuleHandle("KERNEL32.DLL");
+
+			if (hKernel)
+			{
+				typedef bool (*funcGetProductInfo)(uint32_t, uint32_t, uint32_t, uint32_t, uint32_t*);
+				funcGetProductInfo pGetProductInfo = (funcGetProductInfo)GetProcAddress(hKernel, "GetProductInfo"); 
+
+				if (pGetProductInfo)
+					pGetProductInfo(6, 0, 0, 0, &productType);
+	  
+				switch (productType)
+				{
+				case PRODUCT_STARTER:
+				{
+					index += sprintf(version + index, " Starter");
+					break;
+				}
+				case PRODUCT_HOME_BASIC_N:
+				{
+					index += sprintf(version + index, " Home Basic N");
+					break;
+				}
+				case PRODUCT_HOME_BASIC:
+				{
+					index += sprintf(version + index, " Home Basic");
+					break;
+				}
+				case PRODUCT_HOME_PREMIUM:
+				{
+					index += sprintf(version + index, " Home Premium");
+					break;
+				}
+				case PRODUCT_BUSINESS_N:
+				{
+					index += sprintf(version + index, " Business N");
+					break;
+				}
+				case PRODUCT_BUSINESS:
+				{
+					index += sprintf(version + index, " Business");
+					break;
+				}
+				case PRODUCT_ENTERPRISE:
+				{
+					index += sprintf(version + index, " Enterprise");
+					break;
+				}
+				case PRODUCT_ULTIMATE:
+				{
+					index += sprintf(version + index, " Ultimate");
+					break;
+				}
+				default:
+					break;
+				}
+			}
+		}
+		else if (osvi.wProductType == VER_NT_SERVER)
+		{
+			index += sprintf(version + index, "Microsoft Windows Server 2008");
+
+			if (osvi.wSuiteMask & VER_SUITE_DATACENTER)
+				index += sprintf(version + index, " Datacenter Edition");
+			else if (osvi.wSuiteMask & VER_SUITE_ENTERPRISE)
+				index += sprintf(version + index, " Enterprise Edition");
+			else if (osvi.wSuiteMask == VER_SUITE_BLADE)
+				index += sprintf(version + index, " Web Edition");
+			else
+				index += sprintf(version + index, " Standard Edition");
+		}
+	}
+// Windows Server 2003
+	else if (osvi.dwMajorVersion == 5 && osvi.dwMinorVersion == 2)
+	{
+		index += sprintf(version + index, "Microsoft Windows Server 2003");
+
+		if (GetSystemMetrics(SM_SERVERR2))
+			index += sprintf(version + index, " R2");
+
+		if (osvi.wSuiteMask & VER_SUITE_DATACENTER)
+			index += sprintf(version + index, " Datacenter Edition");
+		else if (osvi.wSuiteMask & VER_SUITE_ENTERPRISE)
+			index += sprintf(version + index, " Enterprise Edition");
+		else if (osvi.wSuiteMask == VER_SUITE_BLADE)
+			index += sprintf(version + index, " Web Edition");
+		else
+			index += sprintf(version + index, " Standard Edition");
+	}
+// Windows XP
+	else if (osvi.dwMajorVersion == 5 && osvi.dwMinorVersion == 1)
+	{
+		index += sprintf(version + index, "Microsoft Windows XP");
+
+		if (GetSystemMetrics(SM_MEDIACENTER))
+			index += sprintf(version + index, " Media Center Edition");
+		else if (GetSystemMetrics(SM_STARTER))
+			index += sprintf(version + index, " Starter Edition");
+		else if (GetSystemMetrics(SM_TABLETPC))
+			index += sprintf(version + index, " Tablet PC Edition");
+		else if (osvi.wSuiteMask & VER_SUITE_PERSONAL)
+			index += sprintf(version + index, " Home Edition");
+		else
+			index += sprintf(version + index, " Professional");
+	}
+// Windows 2000
+	else if (osvi.dwMajorVersion == 5 && osvi.dwMinorVersion == 0)
+	{
+		index += sprintf(version + index, "Microsoft Windows 2000");
+
+		if (osvi.wProductType == VER_NT_WORKSTATION)
+		{
+			index += sprintf(version + index, " Professional");
+		}
+		else if (osvi.wProductType == VER_NT_SERVER)
+		{
+			if (osvi.wSuiteMask & VER_SUITE_DATACENTER)
+				index += sprintf(version + index, " Datacenter Server");
+			else if (osvi.wSuiteMask & VER_SUITE_ENTERPRISE)
+				index += sprintf(version + index, " Advanced Server");
+			else
+				index += sprintf(version + index, " Server");
+		}
+	}
+// Windows NT 4
+	else if (osvi.dwMajorVersion == 4)
+	{
+		index += sprintf(version + index, "Microsoft Windows NT 4");
+
+		if (osvi.wProductType == VER_NT_WORKSTATION)
+		{
+			index += sprintf(version + index, " Workstation");
+		}
+		else if (osvi.wProductType == VER_NT_SERVER)
+		{
+			if (osvi.wSuiteMask & VER_SUITE_ENTERPRISE)
+				index += sprintf(version + index, " Server, Enterprise Edition");
+			else
+				index += sprintf(version + index, " Server");
+		}
+	}
+	else
+	{
+		index += sprintf(version + index, "Microsoft Windows");
+	}
+
+// Service pack and full version info
+	if (strlen(osvi.szCSDVersion) > 0)
+	{
+		index += sprintf(version + index, " %s", osvi.szCSDVersion);
+	}
+
+	index += sprintf(version + index, " (%d.%d.%d", osvi.dwMajorVersion, osvi.dwMinorVersion, osvi.dwBuildNumber & 0xFFFF);
+
+// 64-bit Windows
+	bool isWow64 = false;
+	HMODULE hKernel = GetModuleHandle("kernel32.dll");
+
+	if (hKernel)
+	{
+		typedef bool (*funcIsWow64Process)(void*, bool*);  
+
+	    funcIsWow64Process pIsWow64Process = (funcIsWow64Process)GetProcAddress(hKernel, "IsWow64Process"); 
+
+	    if (pIsWow64Process)
+	    {
+			pIsWow64Process(GetCurrentProcess(), &isWow64);
+		}
+	}
+
+	if (isWow64)
+		index += sprintf(version + index, "; 64-bit");
+	else
+		index += sprintf(version + index, "; 32-bit");
+
+	index += sprintf(version + index, ")");
+	
+	return true;
+}
+
+#endif
+

Modified: branches/avidemux_2.4_branch/avidemux/main.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/main.cpp	2007-07-09 13:57:47 UTC (rev 3351)
+++ branches/avidemux_2.4_branch/avidemux/main.cpp	2007-07-09 14:04:04 UTC (rev 3352)
@@ -90,6 +90,7 @@
 
 #ifdef ADM_WIN32
 extern EXCEPTION_DISPOSITION exceptionHandler(struct _EXCEPTION_RECORD* pExceptionRec, void* pEstablisherFrame, struct _CONTEXT* pContextRecord, void* pDispatcherContext);
+extern bool getWindowsVersion(char* version);
 #else
 extern void installSigHandler(void);
 #endif
@@ -157,6 +158,15 @@
 
 printf("\n");
 
+#ifdef ADM_WIN32
+	char version[250];
+
+	if (getWindowsVersion(version))
+	{
+		printf("Operating System: %s\n", version);
+	}
+#endif
+
 #if defined(__USE_LARGEFILE) && defined(__USE_LARGEFILE64)
 	printf("\nLarge file available: %d offset\n", __USE_FILE_OFFSET64);
 #endif



From mean at mail.berlios.de  Mon Jul  9 18:15:14 2007
From: mean at mail.berlios.de (mean at BerliOS)
Date: Mon, 9 Jul 2007 18:15:14 +0200
Subject: [Avidemux-svn-commit] r3353 - in
	branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK:
	ADM_ocr glade
Message-ID: <200707091615.l69GFEwQ024254@sheep.berlios.de>

Author: mean
Date: 2007-07-09 18:15:14 +0200 (Mon, 09 Jul 2007)
New Revision: 3353

Added:
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/glade/glyphedit.glade
Modified:
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_ocr/adm_editglyph.cpp
Log:
very basic glyph editor, end

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_ocr/adm_editglyph.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_ocr/adm_editglyph.cpp	2007-07-09 14:04:04 UTC (rev 3352)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_ocr/adm_editglyph.cpp	2007-07-09 16:15:14 UTC (rev 3353)
@@ -28,7 +28,7 @@
 #include "../ADM_GTK/ADM_toolkit_gtk/toolkit_gtk_include.h"
 
 #include "ADM_ocr/adm_glyph.h"
-
+#include "ADM_userInterfaces/ADM_commonUI/DIA_factory.h"
 static GtkWidget *create_dialog1 (void);
 static admGlyph *currentGlyph=NULL;
 static GtkWidget *dialog;
@@ -36,6 +36,7 @@
 static uint8_t loadGlyph(char *name,admGlyph *head,uint32_t *outNb);
 static uint8_t saveGlyph(char *name,admGlyph *head,uint32_t nb);
 static gboolean glyphDraw( void );
+static gboolean glyphActivate(void);
 static void glyphUpdate(void );
 /**
     \fn DIA_glyphEdit
@@ -85,6 +86,9 @@
 #define ACTION_NEXT_EMPTY 40
 #define ACTION_SAVE 50
 #define ACTION_DELETE 60
+#define ACTION_ACTIVATE 70
+#define ACTION_SEARCH 80
+#define ACTION_REWIND 90
   
   ASSOCIATE(buttonPrev,ACTION_PREV);
   ASSOCIATE(buttonNext,ACTION_NEXT);
@@ -92,8 +96,13 @@
   ASSOCIATE(buttonNextEmpty,ACTION_NEXT_EMPTY);
   ASSOCIATE(buttonSave,ACTION_SAVE);
   ASSOCIATE(buttonDelete,ACTION_DELETE);
+  ASSOCIATE(buttonSearch,ACTION_SEARCH);
+  ASSOCIATE(buttonRewind,ACTION_REWIND);
   
+  
   CONNECT(drawingarea1,expose_event,glyphDraw);
+  CONNECT(entry1,activate,glyphActivate);
+  
   gtk_widget_show(dialog);
   glyphUpdate();
   while(1)
@@ -101,6 +110,50 @@
    gint b=gtk_dialog_run(GTK_DIALOG(dialog));
     switch(b)
     {
+      case ACTION_REWIND:
+                            currentGlyph=head.next;
+                            glyphUpdate();
+                            continue;
+      case ACTION_SEARCH:
+                          {
+                          char *tomatch=NULL;
+                          {
+                            // Dialog Factory to the rescue ! 
+                              
+                              diaElemText txt(&tomatch,_("String"),NULL);
+                              diaElem *elems[]={&txt};
+                              if(!diaFactoryRun(_("Search string"),1,elems))
+                              {
+                                  continue;
+                                  break;
+                              }
+                          }
+                          printf("Searched string <%s>\n",tomatch);
+                          
+                          while(currentGlyph->next)
+                          {
+                             currentGlyph=currentGlyph->next;
+                             glyphUpdate();
+                             
+                             if(currentGlyph->code)
+                             {
+                                printf("%s vs %s\n",currentGlyph->code,tomatch);
+                                if(!strcmp(currentGlyph->code,tomatch))
+                                {
+                                  
+                                  glyphUpdate();
+                                  break;  
+                                }
+                             }
+                          }
+                          ADM_dezalloc(tomatch);
+                          if(!currentGlyph->next)
+                                GUI_Error_HIG(_("End reached"),_("No more glyphs"));
+                          }
+                          
+                          continue;
+                          break;
+                        ;
       case ACTION_PREV: 
                         printf("PREV\n");
                         if(currentGlyph!=head.next)
@@ -184,6 +237,22 @@
                       glyphUpdate();
                       continue;break; 
                   }
+      case ACTION_ACTIVATE:
+                  {
+                      const gchar  *old;
+                      if(currentGlyph->code) delete [] currentGlyph->code;
+                      currentGlyph->code=NULL;
+                      // Retrieve new one
+                      old=gtk_entry_get_text (GTK_ENTRY (WID(entry1)));
+                      
+                      if(old && strlen(old))
+                      {
+                        currentGlyph->code=new char[strlen(old)+1];
+                        strcpy(currentGlyph->code,old);
+                      }
+                    
+                  }
+                        continue;break; 
     }
     break; // exit while(1)
   }
@@ -249,6 +318,17 @@
   }
 }
 /**
+    \fn glyphActivate
+    \brief Transforms the enter keystroke into a dialog signal
+*/
+gboolean glyphActivate(void)
+{
+  printf("Activate\n");
+  gtk_dialog_response                 (GTK_DIALOG(dialog),    ACTION_ACTIVATE);
+  return true; 
+}
+
+/**
     \fn     glyphDraw
     \brief  display glyph
 */
@@ -338,6 +418,8 @@
   GtkWidget *label3;
   GtkWidget *buttonDelete;
   GtkWidget *buttonSave;
+  GtkWidget *buttonSearch;
+  GtkWidget *buttonRewind;
   GtkWidget *dialog_action_area1;
   GtkWidget *closebutton1;
 
@@ -360,7 +442,7 @@
   gtk_widget_show (entry1);
   gtk_box_pack_start (GTK_BOX (vbox2), entry1, FALSE, FALSE, 0);
 
-  table1 = gtk_table_new (3, 2, FALSE);
+  table1 = gtk_table_new (4, 2, FALSE);
   gtk_widget_show (table1);
   gtk_box_pack_start (GTK_BOX (vbox2), table1, TRUE, TRUE, 0);
 
@@ -422,16 +504,28 @@
 
   buttonDelete = gtk_button_new_from_stock ("gtk-delete");
   gtk_widget_show (buttonDelete);
-  gtk_table_attach (GTK_TABLE (table1), buttonDelete, 0, 1, 2, 3,
+  gtk_table_attach (GTK_TABLE (table1), buttonDelete, 0, 1, 3, 4,
                     (GtkAttachOptions) (GTK_FILL),
                     (GtkAttachOptions) (0), 0, 0);
 
   buttonSave = gtk_button_new_from_stock ("gtk-save");
   gtk_widget_show (buttonSave);
-  gtk_table_attach (GTK_TABLE (table1), buttonSave, 1, 2, 2, 3,
+  gtk_table_attach (GTK_TABLE (table1), buttonSave, 1, 2, 3, 4,
                     (GtkAttachOptions) (GTK_FILL),
                     (GtkAttachOptions) (0), 0, 0);
 
+  buttonSearch = gtk_button_new_from_stock ("gtk-find");
+  gtk_widget_show (buttonSearch);
+  gtk_table_attach (GTK_TABLE (table1), buttonSearch, 0, 1, 2, 3,
+                    (GtkAttachOptions) (GTK_FILL),
+                    (GtkAttachOptions) (0), 0, 0);
+
+  buttonRewind = gtk_button_new_from_stock ("gtk-home");
+  gtk_widget_show (buttonRewind);
+  gtk_table_attach (GTK_TABLE (table1), buttonRewind, 1, 2, 2, 3,
+                    (GtkAttachOptions) (GTK_FILL),
+                    (GtkAttachOptions) (0), 0, 0);
+
   dialog_action_area1 = GTK_DIALOG (dialog1)->action_area;
   gtk_widget_show (dialog_action_area1);
   gtk_button_box_set_layout (GTK_BUTTON_BOX (dialog_action_area1), GTK_BUTTONBOX_END);
@@ -462,6 +556,8 @@
   GLADE_HOOKUP_OBJECT (dialog1, label3, "label3");
   GLADE_HOOKUP_OBJECT (dialog1, buttonDelete, "buttonDelete");
   GLADE_HOOKUP_OBJECT (dialog1, buttonSave, "buttonSave");
+  GLADE_HOOKUP_OBJECT (dialog1, buttonSearch, "buttonSearch");
+  GLADE_HOOKUP_OBJECT (dialog1, buttonRewind, "buttonRewind");
   GLADE_HOOKUP_OBJECT_NO_REF (dialog1, dialog_action_area1, "dialog_action_area1");
   GLADE_HOOKUP_OBJECT (dialog1, closebutton1, "closebutton1");
 

Added: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/glade/glyphedit.glade
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/glade/glyphedit.glade	2007-07-09 14:04:04 UTC (rev 3352)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/glade/glyphedit.glade	2007-07-09 16:15:14 UTC (rev 3353)
@@ -0,0 +1,397 @@
+<?xml version="1.0" standalone="no"?> <!--*- mode: xml -*-->
+<!DOCTYPE glade-interface SYSTEM "http://glade.gnome.org/glade-2.0.dtd">
+
+<glade-interface>
+
+<widget class="GtkDialog" id="dialog1">
+  <property name="visible">True</property>
+  <property name="title" translatable="yes">dialog1</property>
+  <property name="type">GTK_WINDOW_TOPLEVEL</property>
+  <property name="window_position">GTK_WIN_POS_NONE</property>
+  <property name="modal">False</property>
+  <property name="resizable">True</property>
+  <property name="destroy_with_parent">False</property>
+  <property name="decorated">True</property>
+  <property name="skip_taskbar_hint">False</property>
+  <property name="skip_pager_hint">False</property>
+  <property name="type_hint">GDK_WINDOW_TYPE_HINT_DIALOG</property>
+  <property name="gravity">GDK_GRAVITY_NORTH_WEST</property>
+  <property name="focus_on_map">True</property>
+  <property name="urgency_hint">False</property>
+  <property name="has_separator">True</property>
+
+  <child internal-child="vbox">
+    <widget class="GtkVBox" id="dialog-vbox1">
+      <property name="visible">True</property>
+      <property name="homogeneous">False</property>
+      <property name="spacing">0</property>
+
+      <child internal-child="action_area">
+	<widget class="GtkHButtonBox" id="dialog-action_area1">
+	  <property name="visible">True</property>
+	  <property name="layout_style">GTK_BUTTONBOX_END</property>
+
+	  <child>
+	    <widget class="GtkButton" id="closebutton1">
+	      <property name="visible">True</property>
+	      <property name="can_default">True</property>
+	      <property name="can_focus">True</property>
+	      <property name="label">gtk-close</property>
+	      <property name="use_stock">True</property>
+	      <property name="relief">GTK_RELIEF_NORMAL</property>
+	      <property name="focus_on_click">True</property>
+	      <property name="response_id">-7</property>
+	    </widget>
+	  </child>
+	</widget>
+	<packing>
+	  <property name="padding">0</property>
+	  <property name="expand">False</property>
+	  <property name="fill">True</property>
+	  <property name="pack_type">GTK_PACK_END</property>
+	</packing>
+      </child>
+
+      <child>
+	<widget class="GtkVBox" id="vbox2">
+	  <property name="visible">True</property>
+	  <property name="homogeneous">False</property>
+	  <property name="spacing">0</property>
+
+	  <child>
+	    <widget class="GtkDrawingArea" id="drawingarea1">
+	      <property name="visible">True</property>
+	    </widget>
+	    <packing>
+	      <property name="padding">0</property>
+	      <property name="expand">True</property>
+	      <property name="fill">True</property>
+	    </packing>
+	  </child>
+
+	  <child>
+	    <widget class="GtkEntry" id="entry1">
+	      <property name="visible">True</property>
+	      <property name="can_focus">True</property>
+	      <property name="editable">True</property>
+	      <property name="visibility">True</property>
+	      <property name="max_length">0</property>
+	      <property name="text" translatable="yes"></property>
+	      <property name="has_frame">True</property>
+	      <property name="invisible_char">*</property>
+	      <property name="activates_default">False</property>
+	    </widget>
+	    <packing>
+	      <property name="padding">0</property>
+	      <property name="expand">False</property>
+	      <property name="fill">False</property>
+	    </packing>
+	  </child>
+
+	  <child>
+	    <widget class="GtkTable" id="table1">
+	      <property name="visible">True</property>
+	      <property name="n_rows">4</property>
+	      <property name="n_columns">2</property>
+	      <property name="homogeneous">False</property>
+	      <property name="row_spacing">0</property>
+	      <property name="column_spacing">0</property>
+
+	      <child>
+		<widget class="GtkButton" id="buttonNext">
+		  <property name="visible">True</property>
+		  <property name="can_focus">True</property>
+		  <property name="label">gtk-media-next</property>
+		  <property name="use_stock">True</property>
+		  <property name="relief">GTK_RELIEF_NORMAL</property>
+		  <property name="focus_on_click">True</property>
+		</widget>
+		<packing>
+		  <property name="left_attach">1</property>
+		  <property name="right_attach">2</property>
+		  <property name="top_attach">0</property>
+		  <property name="bottom_attach">1</property>
+		  <property name="x_options">expand|shrink|fill</property>
+		  <property name="y_options">expand|shrink</property>
+		</packing>
+	      </child>
+
+	      <child>
+		<widget class="GtkButton" id="buttonPrev">
+		  <property name="visible">True</property>
+		  <property name="can_focus">True</property>
+		  <property name="label">gtk-media-previous</property>
+		  <property name="use_stock">True</property>
+		  <property name="relief">GTK_RELIEF_NORMAL</property>
+		  <property name="focus_on_click">True</property>
+		</widget>
+		<packing>
+		  <property name="left_attach">0</property>
+		  <property name="right_attach">1</property>
+		  <property name="top_attach">0</property>
+		  <property name="bottom_attach">1</property>
+		  <property name="x_options">expand|shrink|fill</property>
+		  <property name="y_options">expand|shrink|fill</property>
+		</packing>
+	      </child>
+
+	      <child>
+		<widget class="GtkButton" id="buttonEmptyPrev">
+		  <property name="visible">True</property>
+		  <property name="can_focus">True</property>
+		  <property name="relief">GTK_RELIEF_NORMAL</property>
+		  <property name="focus_on_click">True</property>
+
+		  <child>
+		    <widget class="GtkAlignment" id="alignment2">
+		      <property name="visible">True</property>
+		      <property name="xalign">0.5</property>
+		      <property name="yalign">0.5</property>
+		      <property name="xscale">0</property>
+		      <property name="yscale">0</property>
+		      <property name="top_padding">0</property>
+		      <property name="bottom_padding">0</property>
+		      <property name="left_padding">0</property>
+		      <property name="right_padding">0</property>
+
+		      <child>
+			<widget class="GtkHBox" id="hbox4">
+			  <property name="visible">True</property>
+			  <property name="homogeneous">False</property>
+			  <property name="spacing">2</property>
+
+			  <child>
+			    <widget class="GtkImage" id="image2">
+			      <property name="visible">True</property>
+			      <property name="stock">gtk-media-previous</property>
+			      <property name="icon_size">4</property>
+			      <property name="xalign">0.5</property>
+			      <property name="yalign">0.5</property>
+			      <property name="xpad">0</property>
+			      <property name="ypad">0</property>
+			    </widget>
+			    <packing>
+			      <property name="padding">0</property>
+			      <property name="expand">False</property>
+			      <property name="fill">False</property>
+			    </packing>
+			  </child>
+
+			  <child>
+			    <widget class="GtkLabel" id="label2">
+			      <property name="visible">True</property>
+			      <property name="label" translatable="yes">Prev. Empty</property>
+			      <property name="use_underline">True</property>
+			      <property name="use_markup">False</property>
+			      <property name="justify">GTK_JUSTIFY_LEFT</property>
+			      <property name="wrap">False</property>
+			      <property name="selectable">False</property>
+			      <property name="xalign">0.5</property>
+			      <property name="yalign">0.5</property>
+			      <property name="xpad">0</property>
+			      <property name="ypad">0</property>
+			      <property name="ellipsize">PANGO_ELLIPSIZE_NONE</property>
+			      <property name="width_chars">-1</property>
+			      <property name="single_line_mode">False</property>
+			      <property name="angle">0</property>
+			    </widget>
+			    <packing>
+			      <property name="padding">0</property>
+			      <property name="expand">False</property>
+			      <property name="fill">False</property>
+			    </packing>
+			  </child>
+			</widget>
+		      </child>
+		    </widget>
+		  </child>
+		</widget>
+		<packing>
+		  <property name="left_attach">0</property>
+		  <property name="right_attach">1</property>
+		  <property name="top_attach">1</property>
+		  <property name="bottom_attach">2</property>
+		  <property name="x_options">expand|shrink|fill</property>
+		  <property name="y_options">expand|shrink</property>
+		</packing>
+	      </child>
+
+	      <child>
+		<widget class="GtkButton" id="buttonNextEmpty">
+		  <property name="visible">True</property>
+		  <property name="can_focus">True</property>
+		  <property name="relief">GTK_RELIEF_NORMAL</property>
+		  <property name="focus_on_click">True</property>
+
+		  <child>
+		    <widget class="GtkAlignment" id="alignment3">
+		      <property name="visible">True</property>
+		      <property name="xalign">0.5</property>
+		      <property name="yalign">0.5</property>
+		      <property name="xscale">0</property>
+		      <property name="yscale">0</property>
+		      <property name="top_padding">0</property>
+		      <property name="bottom_padding">0</property>
+		      <property name="left_padding">0</property>
+		      <property name="right_padding">0</property>
+
+		      <child>
+			<widget class="GtkHBox" id="hbox5">
+			  <property name="visible">True</property>
+			  <property name="homogeneous">False</property>
+			  <property name="spacing">2</property>
+
+			  <child>
+			    <widget class="GtkImage" id="image3">
+			      <property name="visible">True</property>
+			      <property name="stock">gtk-media-next</property>
+			      <property name="icon_size">4</property>
+			      <property name="xalign">0.5</property>
+			      <property name="yalign">0.5</property>
+			      <property name="xpad">0</property>
+			      <property name="ypad">0</property>
+			    </widget>
+			    <packing>
+			      <property name="padding">0</property>
+			      <property name="expand">False</property>
+			      <property name="fill">False</property>
+			    </packing>
+			  </child>
+
+			  <child>
+			    <widget class="GtkLabel" id="label3">
+			      <property name="visible">True</property>
+			      <property name="label" translatable="yes">Next Empty</property>
+			      <property name="use_underline">True</property>
+			      <property name="use_markup">False</property>
+			      <property name="justify">GTK_JUSTIFY_LEFT</property>
+			      <property name="wrap">False</property>
+			      <property name="selectable">False</property>
+			      <property name="xalign">0.5</property>
+			      <property name="yalign">0.5</property>
+			      <property name="xpad">0</property>
+			      <property name="ypad">0</property>
+			      <property name="ellipsize">PANGO_ELLIPSIZE_NONE</property>
+			      <property name="width_chars">-1</property>
+			      <property name="single_line_mode">False</property>
+			      <property name="angle">0</property>
+			    </widget>
+			    <packing>
+			      <property name="padding">0</property>
+			      <property name="expand">False</property>
+			      <property name="fill">False</property>
+			    </packing>
+			  </child>
+			</widget>
+		      </child>
+		    </widget>
+		  </child>
+		</widget>
+		<packing>
+		  <property name="left_attach">1</property>
+		  <property name="right_attach">2</property>
+		  <property name="top_attach">1</property>
+		  <property name="bottom_attach">2</property>
+		  <property name="x_options">expand|shrink|fill</property>
+		  <property name="y_options">expand|shrink</property>
+		</packing>
+	      </child>
+
+	      <child>
+		<widget class="GtkButton" id="buttonDelete">
+		  <property name="visible">True</property>
+		  <property name="can_focus">True</property>
+		  <property name="label">gtk-delete</property>
+		  <property name="use_stock">True</property>
+		  <property name="relief">GTK_RELIEF_NORMAL</property>
+		  <property name="focus_on_click">True</property>
+		</widget>
+		<packing>
+		  <property name="left_attach">0</property>
+		  <property name="right_attach">1</property>
+		  <property name="top_attach">3</property>
+		  <property name="bottom_attach">4</property>
+		  <property name="x_options">fill</property>
+		  <property name="y_options"></property>
+		</packing>
+	      </child>
+
+	      <child>
+		<widget class="GtkButton" id="buttonSave">
+		  <property name="visible">True</property>
+		  <property name="can_focus">True</property>
+		  <property name="label">gtk-save</property>
+		  <property name="use_stock">True</property>
+		  <property name="relief">GTK_RELIEF_NORMAL</property>
+		  <property name="focus_on_click">True</property>
+		</widget>
+		<packing>
+		  <property name="left_attach">1</property>
+		  <property name="right_attach">2</property>
+		  <property name="top_attach">3</property>
+		  <property name="bottom_attach">4</property>
+		  <property name="x_options">fill</property>
+		  <property name="y_options"></property>
+		</packing>
+	      </child>
+
+	      <child>
+		<widget class="GtkButton" id="buttonSearch">
+		  <property name="visible">True</property>
+		  <property name="can_focus">True</property>
+		  <property name="label">gtk-find</property>
+		  <property name="use_stock">True</property>
+		  <property name="relief">GTK_RELIEF_NORMAL</property>
+		  <property name="focus_on_click">True</property>
+		</widget>
+		<packing>
+		  <property name="left_attach">0</property>
+		  <property name="right_attach">1</property>
+		  <property name="top_attach">2</property>
+		  <property name="bottom_attach">3</property>
+		  <property name="x_options">fill</property>
+		  <property name="y_options"></property>
+		</packing>
+	      </child>
+
+	      <child>
+		<widget class="GtkButton" id="buttonRewind">
+		  <property name="visible">True</property>
+		  <property name="can_focus">True</property>
+		  <property name="label">gtk-home</property>
+		  <property name="use_stock">True</property>
+		  <property name="relief">GTK_RELIEF_NORMAL</property>
+		  <property name="focus_on_click">True</property>
+		</widget>
+		<packing>
+		  <property name="left_attach">1</property>
+		  <property name="right_attach">2</property>
+		  <property name="top_attach">2</property>
+		  <property name="bottom_attach">3</property>
+		  <property name="x_options">fill</property>
+		  <property name="y_options"></property>
+		</packing>
+	      </child>
+	    </widget>
+	    <packing>
+	      <property name="padding">0</property>
+	      <property name="expand">True</property>
+	      <property name="fill">True</property>
+	    </packing>
+	  </child>
+
+	  <child>
+	    <placeholder/>
+	  </child>
+	</widget>
+	<packing>
+	  <property name="padding">0</property>
+	  <property name="expand">True</property>
+	  <property name="fill">True</property>
+	</packing>
+      </child>
+    </widget>
+  </child>
+</widget>
+
+</glade-interface>



From mean at mail.berlios.de  Mon Jul  9 20:45:37 2007
From: mean at mail.berlios.de (mean at BerliOS)
Date: Mon, 9 Jul 2007 20:45:37 +0200
Subject: [Avidemux-svn-commit] r3354 - in
	branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK:
	ADM_gui2 glade
Message-ID: <200707091845.l69IjbKX024016@sheep.berlios.de>

Author: mean
Date: 2007-07-09 20:45:36 +0200 (Mon, 09 Jul 2007)
New Revision: 3354

Modified:
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_bindings.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/glade/gtk2_build.glade
Log:
put back volume slider (incomplete)

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_bindings.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_bindings.cpp	2007-07-09 16:15:14 UTC (rev 3353)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_bindings.cpp	2007-07-09 18:45:36 UTC (rev 3354)
@@ -196,9 +196,9 @@
 	{"buttonGotoB"			,"clicked"		,ACT_GotoMarkB},	
 	{"toolbuttonCalc"		,"clicked"		,ACT_Bitrate},	
 
-	{"boxCurFrame"			,"editing_done"		,ACT_JumpToFrame},
+	//{"boxCurFrame"			,"editing_done"		,ACT_JumpToFrame},
 	{"boxCurFrame"			,"activate"		,ACT_JumpToFrame},
-	{"boxCurTime"			,"editing_done"		,ACT_TimeChanged},
+	//{"boxCurTime"			,"editing_done"		,ACT_TimeChanged},
 
         {"CheckButtonTimeshift"         ,"toggled"             ,ACT_TimeShift},
         {"spinbuttonTimeShift"          ,"value_changed"       ,ACT_TimeShift}

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp	2007-07-09 16:15:14 UTC (rev 3353)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp	2007-07-09 18:45:36 UTC (rev 3354)
@@ -170,6 +170,7 @@
   GtkWidget *show_builtin_support1;
   GtkWidget *about1;
   GtkWidget *image8271;
+  GtkWidget *hbox20;
   GtkWidget *toolbar2;
   GtkIconSize tmp_toolbar_icon_size;
   GtkWidget *menutoolbuttonOpen;
@@ -182,6 +183,10 @@
   GtkWidget *separatortoolitem2;
   GtkWidget *toolitem12;
   GtkWidget *comboboxPreview;
+  GtkWidget *hbox21;
+  GtkWidget *togglebutton1;
+  GtkWidget *image8272;
+  GtkWidget *hscalVolume;
   GtkWidget *vbox10;
   GtkWidget *hbox14;
   GtkWidget *alignment19;
@@ -950,9 +955,13 @@
   gtk_widget_show (image8271);
   gtk_image_menu_item_set_image (GTK_IMAGE_MENU_ITEM (about1), image8271);
 
+  hbox20 = gtk_hbox_new (FALSE, 0);
+  gtk_widget_show (hbox20);
+  gtk_box_pack_start (GTK_BOX (vbox1), hbox20, TRUE, TRUE, 0);
+
   toolbar2 = gtk_toolbar_new ();
   gtk_widget_show (toolbar2);
-  gtk_box_pack_start (GTK_BOX (vbox1), toolbar2, FALSE, FALSE, 0);
+  gtk_box_pack_start (GTK_BOX (hbox20), toolbar2, TRUE, TRUE, 0);
   gtk_toolbar_set_style (GTK_TOOLBAR (toolbar2), GTK_TOOLBAR_BOTH_HORIZ);
   tmp_toolbar_icon_size = gtk_toolbar_get_icon_size (GTK_TOOLBAR (toolbar2));
 
@@ -1002,6 +1011,24 @@
   gtk_widget_show (comboboxPreview);
   gtk_container_add (GTK_CONTAINER (toolitem12), comboboxPreview);
 
+  hbox21 = gtk_hbox_new (FALSE, 0);
+  gtk_widget_show (hbox21);
+  gtk_box_pack_start (GTK_BOX (hbox20), hbox21, TRUE, TRUE, 0);
+
+  togglebutton1 = gtk_toggle_button_new ();
+  gtk_widget_show (togglebutton1);
+  gtk_box_pack_start (GTK_BOX (hbox21), togglebutton1, FALSE, FALSE, 0);
+
+  image8272 = gtk_image_new_from_stock ("gtk-connect", GTK_ICON_SIZE_MENU);
+  gtk_widget_show (image8272);
+  gtk_container_add (GTK_CONTAINER (togglebutton1), image8272);
+
+  hscalVolume = gtk_hscale_new (GTK_ADJUSTMENT (gtk_adjustment_new (99, 0, 100, 1, 1, 1)));
+  gtk_widget_show (hscalVolume);
+  gtk_box_pack_start (GTK_BOX (hbox21), hscalVolume, TRUE, TRUE, 0);
+  gtk_scale_set_draw_value (GTK_SCALE (hscalVolume), FALSE);
+  gtk_scale_set_digits (GTK_SCALE (hscalVolume), 0);
+
   vbox10 = gtk_vbox_new (FALSE, 3);
   gtk_widget_show (vbox10);
   gtk_box_pack_start (GTK_BOX (vbox1), vbox10, TRUE, TRUE, 0);
@@ -1579,6 +1606,7 @@
   GLADE_HOOKUP_OBJECT (mainWindow, show_builtin_support1, "show_builtin_support1");
   GLADE_HOOKUP_OBJECT (mainWindow, about1, "about1");
   GLADE_HOOKUP_OBJECT (mainWindow, image8271, "image8271");
+  GLADE_HOOKUP_OBJECT (mainWindow, hbox20, "hbox20");
   GLADE_HOOKUP_OBJECT (mainWindow, toolbar2, "toolbar2");
   GLADE_HOOKUP_OBJECT (mainWindow, menutoolbuttonOpen, "menutoolbuttonOpen");
   GLADE_HOOKUP_OBJECT (mainWindow, toolitem11, "toolitem11");
@@ -1589,6 +1617,10 @@
   GLADE_HOOKUP_OBJECT (mainWindow, separatortoolitem2, "separatortoolitem2");
   GLADE_HOOKUP_OBJECT (mainWindow, toolitem12, "toolitem12");
   GLADE_HOOKUP_OBJECT (mainWindow, comboboxPreview, "comboboxPreview");
+  GLADE_HOOKUP_OBJECT (mainWindow, hbox21, "hbox21");
+  GLADE_HOOKUP_OBJECT (mainWindow, togglebutton1, "togglebutton1");
+  GLADE_HOOKUP_OBJECT (mainWindow, image8272, "image8272");
+  GLADE_HOOKUP_OBJECT (mainWindow, hscalVolume, "hscalVolume");
   GLADE_HOOKUP_OBJECT (mainWindow, vbox10, "vbox10");
   GLADE_HOOKUP_OBJECT (mainWindow, hbox14, "hbox14");
   GLADE_HOOKUP_OBJECT (mainWindow, alignment19, "alignment19");

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/glade/gtk2_build.glade
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/glade/gtk2_build.glade	2007-07-09 16:15:14 UTC (rev 3353)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/glade/gtk2_build.glade	2007-07-09 18:45:36 UTC (rev 3354)
@@ -50,7 +50,7 @@
 		      <accelerator key="O" modifiers="GDK_CONTROL_MASK" signal="activate"/>
 
 		      <child internal-child="image">
-			<widget class="GtkImage" id="image8196">
+			<widget class="GtkImage" id="image8246">
 			  <property name="visible">True</property>
 			  <property name="stock">gtk-open</property>
 			  <property name="icon_size">1</property>
@@ -71,7 +71,7 @@
 		      <accelerator key="A" modifiers="GDK_CONTROL_MASK | GDK_MOD1_MASK" signal="activate"/>
 
 		      <child internal-child="image">
-			<widget class="GtkImage" id="image8197">
+			<widget class="GtkImage" id="image8247">
 			  <property name="visible">True</property>
 			  <property name="stock">gtk-add</property>
 			  <property name="icon_size">1</property>
@@ -91,7 +91,7 @@
 		      <property name="use_underline">True</property>
 
 		      <child internal-child="image">
-			<widget class="GtkImage" id="image8198">
+			<widget class="GtkImage" id="image8248">
 			  <property name="visible">True</property>
 			  <property name="stock">gtk-save</property>
 			  <property name="icon_size">1</property>
@@ -169,7 +169,7 @@
 		      <property name="use_underline">True</property>
 
 		      <child internal-child="image">
-			<widget class="GtkImage" id="image8199">
+			<widget class="GtkImage" id="image8249">
 			  <property name="visible">True</property>
 			  <property name="stock">gtk-save</property>
 			  <property name="icon_size">1</property>
@@ -189,7 +189,7 @@
 		      <property name="use_underline">True</property>
 
 		      <child internal-child="image">
-			<widget class="GtkImage" id="image8200">
+			<widget class="GtkImage" id="image8250">
 			  <property name="visible">True</property>
 			  <property name="stock">gtk-save-as</property>
 			  <property name="icon_size">1</property>
@@ -209,7 +209,7 @@
 		      <property name="use_underline">True</property>
 
 		      <child internal-child="image">
-			<widget class="GtkImage" id="image8201">
+			<widget class="GtkImage" id="image8251">
 			  <property name="visible">True</property>
 			  <property name="stock">gtk-execute</property>
 			  <property name="icon_size">1</property>
@@ -267,7 +267,7 @@
 		      <accelerator key="Return" modifiers="GDK_MOD1_MASK" signal="activate"/>
 
 		      <child internal-child="image">
-			<widget class="GtkImage" id="image8202">
+			<widget class="GtkImage" id="image8252">
 			  <property name="visible">True</property>
 			  <property name="stock">gtk-properties</property>
 			  <property name="icon_size">1</property>
@@ -302,7 +302,7 @@
 		      <accelerator key="Q" modifiers="GDK_CONTROL_MASK" signal="activate"/>
 
 		      <child internal-child="image">
-			<widget class="GtkImage" id="image8203">
+			<widget class="GtkImage" id="image8253">
 			  <property name="visible">True</property>
 			  <property name="stock">gtk-quit</property>
 			  <property name="icon_size">1</property>
@@ -335,7 +335,7 @@
 		      <property name="use_underline">True</property>
 
 		      <child internal-child="image">
-			<widget class="GtkImage" id="image8204">
+			<widget class="GtkImage" id="image8254">
 			  <property name="visible">True</property>
 			  <property name="stock">gtk-undo</property>
 			  <property name="icon_size">1</property>
@@ -362,7 +362,7 @@
 		      <accelerator key="X" modifiers="GDK_CONTROL_MASK" signal="activate"/>
 
 		      <child internal-child="image">
-			<widget class="GtkImage" id="image8205">
+			<widget class="GtkImage" id="image8255">
 			  <property name="visible">True</property>
 			  <property name="stock">gtk-cut</property>
 			  <property name="icon_size">1</property>
@@ -383,7 +383,7 @@
 		      <accelerator key="C" modifiers="GDK_CONTROL_MASK" signal="activate"/>
 
 		      <child internal-child="image">
-			<widget class="GtkImage" id="image8206">
+			<widget class="GtkImage" id="image8256">
 			  <property name="visible">True</property>
 			  <property name="stock">gtk-copy</property>
 			  <property name="icon_size">1</property>
@@ -404,7 +404,7 @@
 		      <accelerator key="V" modifiers="GDK_CONTROL_MASK" signal="activate"/>
 
 		      <child internal-child="image">
-			<widget class="GtkImage" id="image8207">
+			<widget class="GtkImage" id="image8257">
 			  <property name="visible">True</property>
 			  <property name="stock">gtk-paste</property>
 			  <property name="icon_size">1</property>
@@ -425,7 +425,7 @@
 		      <accelerator key="Delete" modifiers="0" signal="activate"/>
 
 		      <child internal-child="image">
-			<widget class="GtkImage" id="image8208">
+			<widget class="GtkImage" id="image8258">
 			  <property name="visible">True</property>
 			  <property name="stock">gtk-remove</property>
 			  <property name="icon_size">1</property>
@@ -475,7 +475,7 @@
 		      <property name="use_underline">True</property>
 
 		      <child internal-child="image">
-			<widget class="GtkImage" id="image8209">
+			<widget class="GtkImage" id="image8259">
 			  <property name="visible">True</property>
 			  <property name="stock">gtk-preferences</property>
 			  <property name="icon_size">1</property>
@@ -711,7 +711,7 @@
 		      <accelerator key="S" modifiers="GDK_CONTROL_MASK | GDK_MOD1_MASK" signal="activate"/>
 
 		      <child internal-child="image">
-			<widget class="GtkImage" id="image8210">
+			<widget class="GtkImage" id="image8260">
 			  <property name="visible">True</property>
 			  <property name="stock">gtk-save-as</property>
 			  <property name="icon_size">1</property>
@@ -762,7 +762,7 @@
 		      <accelerator key="F7" modifiers="0" signal="activate"/>
 
 		      <child internal-child="image">
-			<widget class="GtkImage" id="image8211">
+			<widget class="GtkImage" id="image8261">
 			  <property name="visible">True</property>
 			  <property name="pixbuf">gnome-calculator_small.xpm</property>
 			  <property name="xalign">0.5</property>
@@ -835,6 +835,14 @@
 		  </child>
 
 		  <child>
+		    <widget class="GtkMenuItem" id="edit_glyph1">
+		      <property name="visible">True</property>
+		      <property name="label" translatable="yes">Edit glyph</property>
+		      <property name="use_underline">True</property>
+		    </widget>
+		  </child>
+
+		  <child>
 		    <widget class="GtkSeparatorMenuItem" id="separator17">
 		      <property name="visible">True</property>
 		    </widget>
@@ -922,7 +930,7 @@
 		      <accelerator key="P" modifiers="0" signal="activate"/>
 
 		      <child internal-child="image">
-			<widget class="GtkImage" id="image8212">
+			<widget class="GtkImage" id="image8262">
 			  <property name="visible">True</property>
 			  <property name="stock">gtk-media-play</property>
 			  <property name="icon_size">1</property>
@@ -943,7 +951,7 @@
 		      <accelerator key="KP_4" modifiers="0" signal="activate"/>
 
 		      <child internal-child="image">
-			<widget class="GtkImage" id="image8213">
+			<widget class="GtkImage" id="image8263">
 			  <property name="visible">True</property>
 			  <property name="stock">gtk-media-previous</property>
 			  <property name="icon_size">1</property>
@@ -964,7 +972,7 @@
 		      <accelerator key="KP_6" modifiers="0" signal="activate"/>
 
 		      <child internal-child="image">
-			<widget class="GtkImage" id="image8214">
+			<widget class="GtkImage" id="image8264">
 			  <property name="visible">True</property>
 			  <property name="stock">gtk-media-next</property>
 			  <property name="icon_size">1</property>
@@ -985,7 +993,7 @@
 		      <accelerator key="KP_2" modifiers="0" signal="activate"/>
 
 		      <child internal-child="image">
-			<widget class="GtkImage" id="image8215">
+			<widget class="GtkImage" id="image8265">
 			  <property name="visible">True</property>
 			  <property name="stock">gtk-media-rewind</property>
 			  <property name="icon_size">1</property>
@@ -1006,7 +1014,7 @@
 		      <accelerator key="KP_8" modifiers="0" signal="activate"/>
 
 		      <child internal-child="image">
-			<widget class="GtkImage" id="image8216">
+			<widget class="GtkImage" id="image8266">
 			  <property name="visible">True</property>
 			  <property name="stock">gtk-media-forward</property>
 			  <property name="icon_size">1</property>
@@ -1043,7 +1051,7 @@
 		      <accelerator key="Home" modifiers="0" signal="activate"/>
 
 		      <child internal-child="image">
-			<widget class="GtkImage" id="image8217">
+			<widget class="GtkImage" id="image8267">
 			  <property name="visible">True</property>
 			  <property name="stock">gtk-goto-first</property>
 			  <property name="icon_size">1</property>
@@ -1064,7 +1072,7 @@
 		      <accelerator key="End" modifiers="0" signal="activate"/>
 
 		      <child internal-child="image">
-			<widget class="GtkImage" id="image8218">
+			<widget class="GtkImage" id="image8268">
 			  <property name="visible">True</property>
 			  <property name="stock">gtk-goto-last</property>
 			  <property name="icon_size">1</property>
@@ -1115,7 +1123,7 @@
 		      <accelerator key="F" modifiers="GDK_CONTROL_MASK" signal="activate"/>
 
 		      <child internal-child="image">
-			<widget class="GtkImage" id="image8219">
+			<widget class="GtkImage" id="image8269">
 			  <property name="visible">True</property>
 			  <property name="stock">gtk-jump-to</property>
 			  <property name="icon_size">1</property>
@@ -1136,7 +1144,7 @@
 		      <accelerator key="T" modifiers="GDK_CONTROL_MASK" signal="activate"/>
 
 		      <child internal-child="image">
-			<widget class="GtkImage" id="image8220">
+			<widget class="GtkImage" id="image8270">
 			  <property name="visible">True</property>
 			  <property name="stock">gtk-jump-to</property>
 			  <property name="icon_size">1</property>
@@ -1185,7 +1193,7 @@
 		      <property name="use_underline">True</property>
 
 		      <child internal-child="image">
-			<widget class="GtkImage" id="image8221">
+			<widget class="GtkImage" id="image8271">
 			  <property name="visible">True</property>
 			  <property name="stock">gtk-about</property>
 			  <property name="icon_size">1</property>
@@ -1210,140 +1218,212 @@
       </child>
 
       <child>
-	<widget class="GtkToolbar" id="toolbar2">
+	<widget class="GtkHBox" id="hbox20">
 	  <property name="visible">True</property>
-	  <property name="orientation">GTK_ORIENTATION_HORIZONTAL</property>
-	  <property name="toolbar_style">GTK_TOOLBAR_BOTH_HORIZ</property>
-	  <property name="tooltips">True</property>
-	  <property name="show_arrow">True</property>
+	  <property name="homogeneous">False</property>
+	  <property name="spacing">0</property>
 
 	  <child>
-	    <widget class="GtkMenuToolButton" id="menutoolbuttonOpen">
+	    <widget class="GtkToolbar" id="toolbar2">
 	      <property name="visible">True</property>
-	      <property name="tooltip" translatable="yes">Open a file</property>
-	      <property name="stock_id">gtk-open</property>
-	      <property name="visible_horizontal">True</property>
-	      <property name="visible_vertical">True</property>
-	      <property name="is_important">True</property>
-	    </widget>
-	    <packing>
-	      <property name="expand">False</property>
-	      <property name="homogeneous">False</property>
-	    </packing>
-	  </child>
+	      <property name="orientation">GTK_ORIENTATION_HORIZONTAL</property>
+	      <property name="toolbar_style">GTK_TOOLBAR_BOTH_HORIZ</property>
+	      <property name="tooltips">True</property>
+	      <property name="show_arrow">True</property>
 
-	  <child>
-	    <widget class="GtkToolItem" id="toolitem11">
-	      <property name="visible">True</property>
-	      <property name="visible_horizontal">True</property>
-	      <property name="visible_vertical">True</property>
-	      <property name="is_important">False</property>
-	    </widget>
-	    <packing>
-	      <property name="expand">False</property>
-	      <property name="homogeneous">False</property>
-	    </packing>
-	  </child>
+	      <child>
+		<widget class="GtkMenuToolButton" id="menutoolbuttonOpen">
+		  <property name="visible">True</property>
+		  <property name="tooltip" translatable="yes">Open a file</property>
+		  <property name="stock_id">gtk-open</property>
+		  <property name="visible_horizontal">True</property>
+		  <property name="visible_vertical">True</property>
+		  <property name="is_important">True</property>
+		</widget>
+		<packing>
+		  <property name="expand">False</property>
+		  <property name="homogeneous">False</property>
+		</packing>
+	      </child>
 
-	  <child>
-	    <widget class="GtkToolButton" id="toolbuttonSave">
-	      <property name="visible">True</property>
-	      <property name="tooltip" translatable="yes">Save the file</property>
-	      <property name="stock_id">gtk-save</property>
-	      <property name="visible_horizontal">True</property>
-	      <property name="visible_vertical">True</property>
-	      <property name="is_important">True</property>
-	    </widget>
-	    <packing>
-	      <property name="expand">False</property>
-	      <property name="homogeneous">True</property>
-	    </packing>
-	  </child>
+	      <child>
+		<widget class="GtkToolItem" id="toolitem11">
+		  <property name="visible">True</property>
+		  <property name="visible_horizontal">True</property>
+		  <property name="visible_vertical">True</property>
+		  <property name="is_important">False</property>
+		</widget>
+		<packing>
+		  <property name="expand">False</property>
+		  <property name="homogeneous">False</property>
+		</packing>
+	      </child>
 
-	  <child>
-	    <widget class="GtkToolButton" id="toolbuttonInfo">
-	      <property name="visible">True</property>
-	      <property name="tooltip" translatable="yes">Audio/video file information</property>
-	      <property name="stock_id">gtk-properties</property>
-	      <property name="visible_horizontal">True</property>
-	      <property name="visible_vertical">True</property>
-	      <property name="is_important">False</property>
-	    </widget>
-	    <packing>
-	      <property name="expand">False</property>
-	      <property name="homogeneous">True</property>
-	    </packing>
-	  </child>
+	      <child>
+		<widget class="GtkToolButton" id="toolbuttonSave">
+		  <property name="visible">True</property>
+		  <property name="tooltip" translatable="yes">Save the file</property>
+		  <property name="stock_id">gtk-save</property>
+		  <property name="visible_horizontal">True</property>
+		  <property name="visible_vertical">True</property>
+		  <property name="is_important">True</property>
+		</widget>
+		<packing>
+		  <property name="expand">False</property>
+		  <property name="homogeneous">True</property>
+		</packing>
+	      </child>
 
-	  <child>
-	    <widget class="GtkSeparatorToolItem" id="separatortoolitem1">
-	      <property name="visible">True</property>
-	      <property name="draw">True</property>
-	      <property name="visible_horizontal">True</property>
-	      <property name="visible_vertical">True</property>
-	    </widget>
-	    <packing>
-	      <property name="expand">False</property>
-	      <property name="homogeneous">False</property>
-	    </packing>
-	  </child>
+	      <child>
+		<widget class="GtkToolButton" id="toolbuttonInfo">
+		  <property name="visible">True</property>
+		  <property name="tooltip" translatable="yes">Audio/video file information</property>
+		  <property name="stock_id">gtk-properties</property>
+		  <property name="visible_horizontal">True</property>
+		  <property name="visible_vertical">True</property>
+		  <property name="is_important">False</property>
+		</widget>
+		<packing>
+		  <property name="expand">False</property>
+		  <property name="homogeneous">True</property>
+		</packing>
+	      </child>
 
-	  <child>
-	    <widget class="GtkToolButton" id="toolbuttonCalc">
-	      <property name="visible">True</property>
-	      <property name="tooltip" translatable="yes">Bitrate/size calculator</property>
-	      <property name="label" translatable="yes">Calculator</property>
-	      <property name="use_underline">True</property>
-	      <property name="icon">gnome-calculator.xpm</property>
-	      <property name="visible_horizontal">True</property>
-	      <property name="visible_vertical">True</property>
-	      <property name="is_important">True</property>
+	      <child>
+		<widget class="GtkSeparatorToolItem" id="separatortoolitem1">
+		  <property name="visible">True</property>
+		  <property name="draw">True</property>
+		  <property name="visible_horizontal">True</property>
+		  <property name="visible_vertical">True</property>
+		</widget>
+		<packing>
+		  <property name="expand">False</property>
+		  <property name="homogeneous">False</property>
+		</packing>
+	      </child>
+
+	      <child>
+		<widget class="GtkToolButton" id="toolbuttonCalc">
+		  <property name="visible">True</property>
+		  <property name="tooltip" translatable="yes">Bitrate/size calculator</property>
+		  <property name="label" translatable="yes">Calculator</property>
+		  <property name="use_underline">True</property>
+		  <property name="icon">gnome-calculator.xpm</property>
+		  <property name="visible_horizontal">True</property>
+		  <property name="visible_vertical">True</property>
+		  <property name="is_important">True</property>
+		</widget>
+		<packing>
+		  <property name="expand">False</property>
+		  <property name="homogeneous">True</property>
+		</packing>
+	      </child>
+
+	      <child>
+		<widget class="GtkSeparatorToolItem" id="separatortoolitem2">
+		  <property name="visible">True</property>
+		  <property name="draw">True</property>
+		  <property name="visible_horizontal">True</property>
+		  <property name="visible_vertical">True</property>
+		</widget>
+		<packing>
+		  <property name="expand">False</property>
+		  <property name="homogeneous">False</property>
+		</packing>
+	      </child>
+
+	      <child>
+		<widget class="GtkToolItem" id="toolitem12">
+		  <property name="visible">True</property>
+		  <property name="visible_horizontal">True</property>
+		  <property name="visible_vertical">True</property>
+		  <property name="is_important">False</property>
+
+		  <child>
+		    <widget class="GtkComboBox" id="comboboxPreview">
+		      <property name="visible">True</property>
+		      <property name="items" translatable="yes"></property>
+		      <property name="add_tearoffs">False</property>
+		      <property name="focus_on_click">True</property>
+		    </widget>
+		  </child>
+		</widget>
+		<packing>
+		  <property name="expand">False</property>
+		  <property name="homogeneous">False</property>
+		</packing>
+	      </child>
 	    </widget>
 	    <packing>
-	      <property name="expand">False</property>
-	      <property name="homogeneous">True</property>
+	      <property name="padding">0</property>
+	      <property name="expand">True</property>
+	      <property name="fill">True</property>
 	    </packing>
 	  </child>
 
 	  <child>
-	    <widget class="GtkSeparatorToolItem" id="separatortoolitem2">
+	    <widget class="GtkHBox" id="hbox21">
 	      <property name="visible">True</property>
-	      <property name="draw">True</property>
-	      <property name="visible_horizontal">True</property>
-	      <property name="visible_vertical">True</property>
-	    </widget>
-	    <packing>
-	      <property name="expand">False</property>
 	      <property name="homogeneous">False</property>
-	    </packing>
-	  </child>
+	      <property name="spacing">0</property>
 
-	  <child>
-	    <widget class="GtkToolItem" id="toolitem12">
-	      <property name="visible">True</property>
-	      <property name="visible_horizontal">True</property>
-	      <property name="visible_vertical">True</property>
-	      <property name="is_important">False</property>
-
 	      <child>
-		<widget class="GtkComboBox" id="comboboxPreview">
+		<widget class="GtkToggleButton" id="togglebutton1">
 		  <property name="visible">True</property>
-		  <property name="items" translatable="yes"></property>
-		  <property name="add_tearoffs">False</property>
+		  <property name="can_focus">True</property>
+		  <property name="relief">GTK_RELIEF_NORMAL</property>
 		  <property name="focus_on_click">True</property>
+		  <property name="active">False</property>
+		  <property name="inconsistent">False</property>
+
+		  <child>
+		    <widget class="GtkImage" id="image8272">
+		      <property name="visible">True</property>
+		      <property name="stock">gtk-connect</property>
+		      <property name="icon_size">1</property>
+		      <property name="xalign">0.5</property>
+		      <property name="yalign">0.5</property>
+		      <property name="xpad">0</property>
+		      <property name="ypad">0</property>
+		    </widget>
+		  </child>
 		</widget>
+		<packing>
+		  <property name="padding">0</property>
+		  <property name="expand">False</property>
+		  <property name="fill">False</property>
+		</packing>
 	      </child>
+
+	      <child>
+		<widget class="GtkHScale" id="hscalVolume">
+		  <property name="visible">True</property>
+		  <property name="can_focus">True</property>
+		  <property name="draw_value">False</property>
+		  <property name="value_pos">GTK_POS_TOP</property>
+		  <property name="digits">0</property>
+		  <property name="update_policy">GTK_UPDATE_CONTINUOUS</property>
+		  <property name="inverted">False</property>
+		  <property name="adjustment">99 0 100 1 1 1</property>
+		</widget>
+		<packing>
+		  <property name="padding">0</property>
+		  <property name="expand">True</property>
+		  <property name="fill">True</property>
+		</packing>
+	      </child>
 	    </widget>
 	    <packing>
-	      <property name="expand">False</property>
-	      <property name="homogeneous">False</property>
+	      <property name="padding">0</property>
+	      <property name="expand">True</property>
+	      <property name="fill">True</property>
 	    </packing>
 	  </child>
 	</widget>
 	<packing>
 	  <property name="padding">0</property>
-	  <property name="expand">False</property>
-	  <property name="fill">False</property>
+	  <property name="expand">True</property>
+	  <property name="fill">True</property>
 	</packing>
       </child>
 



From mean at mail.berlios.de  Tue Jul 10 20:34:23 2007
From: mean at mail.berlios.de (mean at BerliOS)
Date: Tue, 10 Jul 2007 20:34:23 +0200
Subject: [Avidemux-svn-commit] r3355 - in
	branches/avidemux_2.4_branch/avidemux:
	ADM_inputs/ADM_matroska ADM_userInterfaces/ADM_GTK/ADM_gui2
	ADM_userInterfaces/ADM_GTK/ADM_toolkit_gtk xpm xpm/build
Message-ID: <200707101834.l6AIYNOM015353@sheep.berlios.de>

Author: mean
Date: 2007-07-10 20:34:21 +0200 (Tue, 10 Jul 2007)
New Revision: 3355

Added:
   branches/avidemux_2.4_branch/avidemux/xpm/audio-volume-medium.inc
   branches/avidemux_2.4_branch/avidemux/xpm/build/audio-volume-medium.png
Modified:
   branches/avidemux_2.4_branch/avidemux/ADM_inputs/ADM_matroska/ADM_mkvIndexer.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_inputs/ADM_matroska/mkv_tagenum.h
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_bindings.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_menumap.h
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_toolkit_gtk/ADM_gladeSupport.cpp
   branches/avidemux_2.4_branch/avidemux/xpm/build/Makefile
Log:
JM: volume slider is back, Me: some cosmetic on MKV

Modified: branches/avidemux_2.4_branch/avidemux/ADM_inputs/ADM_matroska/ADM_mkvIndexer.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_inputs/ADM_matroska/ADM_mkvIndexer.cpp	2007-07-09 18:45:36 UTC (rev 3354)
+++ branches/avidemux_2.4_branch/avidemux/ADM_inputs/ADM_matroska/ADM_mkvIndexer.cpp	2007-07-10 18:34:21 UTC (rev 3355)
@@ -267,9 +267,9 @@
   f/=1000. ;; // in seconds
   delta=(uint32_t)floor(f+0.49);
   //printf("Frame :%u rawTimeCode:%u convertedtoframe:%u \n",Track->_nbIndex,timecodeMS,delta);
-  if(delta+1<Track->_nbIndex)
+  if(delta+2<Track->_nbIndex)
   {
-    printf("[MKV] WARNING DELTA PTS/DTS is negative for frame %u (delta:%u)\n",Track->_nbIndex,delta); 
+    printf("[MKV] WARNING DELTA PTS/DTS is negative for frame %u (delta:%u, raw value %u,dwrate=%u)\n",Track->_nbIndex,delta,timecodeMS,_videostream.dwRate); 
     index[x].timeCode=0;
   }else
   {

Modified: branches/avidemux_2.4_branch/avidemux/ADM_inputs/ADM_matroska/mkv_tagenum.h
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_inputs/ADM_matroska/mkv_tagenum.h	2007-07-09 18:45:36 UTC (rev 3354)
+++ branches/avidemux_2.4_branch/avidemux/ADM_inputs/ADM_matroska/mkv_tagenum.h	2007-07-10 18:34:21 UTC (rev 3355)
@@ -113,7 +113,16 @@
    MKTAG(MKV_TAG,0x7373,ADM_MKV_TYPE_CONTAINER),
    MKTAG(MKV_TARGETS,0x63C0,ADM_MKV_TYPE_CONTAINER),
    MKTAG(MKV_SIMPLE_TAG,0x67C8,ADM_MKV_TYPE_CONTAINER),
+   //
+   MKTAG(MKV_MIN_CACHE,0x6DE7,ADM_MKV_TYPE_UINTEGER),
+   MKTAG(MKV_MAX_BLOCK_ADD_ID,0x55EE,ADM_MKV_TYPE_UINTEGER),
+   MKTAG(MKV_CODEC_DECODE_ALL,0xAA,ADM_MKV_TYPE_UINTEGER),
+   MKTAG(MKV_LANGUAGE,0x22B59C,ADM_MKV_TYPE_STRING),
    
+   MKTAG(MKV_DISPLAY_WIDTH,0x55B0,ADM_MKV_TYPE_UINTEGER),
+   MKTAG(MKV_DISPLAY_HEIGHT,0x55BA,ADM_MKV_TYPE_UINTEGER),
+   MKTAG(MKV_FLAG_INTERLACED,0x9A,ADM_MKV_TYPE_UINTEGER),
+   
          //*************************
    MKTAG(MKV_MAX,0xFFFF,ADM_MKV_TYPE_UNKNOWN)    
        

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_bindings.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_bindings.cpp	2007-07-09 18:45:36 UTC (rev 3354)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_bindings.cpp	2007-07-10 18:34:21 UTC (rev 3355)
@@ -76,7 +76,7 @@
 static GdkCursor *guiCursorNormal=NULL;
 static gint	  guiCursorEvtMask=0;
 static gint       jogChange( void );
-
+static void volumeChange( void );
 static char     *customNames[ADM_MAC_CUSTOM_SCRIPT];
 static uint32_t ADM_nbCustom=0;
 // heek !
@@ -329,7 +329,10 @@
 	gtk_signal_connect(GTK_OBJECT(lookup_widget(guiRootWindow,"boxCurFrame")), "focus_out_event", 	
                       GTK_SIGNAL_FUNC(UI_looseFocus),                   (void *) NULL);	 
 
-        
+        // Volume
+         gtk_signal_connect(GTK_OBJECT(lookup_widget(guiRootWindow,"hscalVolume")), "value_changed",   
+                      GTK_SIGNAL_FUNC(volumeChange),                   (void *) NULL);  
+
         // Jog
         gtk_signal_connect(GTK_OBJECT(lookup_widget(guiRootWindow,"jogg")), "value_changed",   
                       GTK_SIGNAL_FUNC(jogChange),                   (void *) NULL);  
@@ -1244,5 +1247,27 @@
    // Armed!
    return FALSE;
 }
+/**
+  \fn volumeChange
+  \brief Called when the volume slider is moved
+*/
+void volumeChange( void )
+{
+#ifdef HAVE_AUDIO
+GtkWidget *wid;
+GtkAdjustment *adj;
+int vol;
 
+
+if(_upd_in_progres) return;
+ _upd_in_progres++;
+
+        wid=lookup_widget(guiRootWindow,"hscalVolume");
+        adj=gtk_range_get_adjustment (GTK_RANGE(wid));
+        vol=(int)floor(adj->value+0.5);
+        AVDM_setVolume( vol);
+ _upd_in_progres--;
+#endif
+}
+
 // EOF

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp	2007-07-09 18:45:36 UTC (rev 3354)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp	2007-07-10 18:34:21 UTC (rev 3355)
@@ -36,11 +36,11 @@
   GtkWidget *menuitem1;
   GtkWidget *menuitem1_menu;
   GtkWidget *open_video1;
-  GtkWidget *image8246;
+  GtkWidget *image8323;
   GtkWidget *append_video1;
-  GtkWidget *image8247;
+  GtkWidget *image8324;
   GtkWidget *save_stuff;
-  GtkWidget *image8248;
+  GtkWidget *image8325;
   GtkWidget *save_stuff_menu;
   GtkWidget *save_as_avi1;
   GtkWidget *separator1;
@@ -50,41 +50,41 @@
   GtkWidget *close1;
   GtkWidget *separator3;
   GtkWidget *save_project1;
-  GtkWidget *image8249;
+  GtkWidget *image8326;
   GtkWidget *save_project_as1;
-  GtkWidget *image8250;
+  GtkWidget *image8327;
   GtkWidget *run_script1;
-  GtkWidget *image8251;
+  GtkWidget *image8328;
   GtkWidget *add_to_joblist1;
   GtkWidget *joblist1;
   GtkWidget *separator16;
   GtkWidget *connect_to_avsproxy1;
   GtkWidget *separator18;
   GtkWidget *video_informations1;
-  GtkWidget *image8252;
+  GtkWidget *image8329;
   GtkWidget *avi_muxer_options1;
   GtkWidget *separator4;
   GtkWidget *quit1;
-  GtkWidget *image8253;
+  GtkWidget *image8330;
   GtkWidget *menuitem2;
   GtkWidget *menuitem2_menu;
   GtkWidget *reset_edits1;
-  GtkWidget *image8254;
+  GtkWidget *image8331;
   GtkWidget *separator5;
   GtkWidget *cut1;
-  GtkWidget *image8255;
+  GtkWidget *image8332;
   GtkWidget *copy1;
-  GtkWidget *image8256;
+  GtkWidget *image8333;
   GtkWidget *paste1;
-  GtkWidget *image8257;
+  GtkWidget *image8334;
   GtkWidget *delete1;
-  GtkWidget *image8258;
+  GtkWidget *image8335;
   GtkWidget *separator6;
   GtkWidget *set_marker_a1;
   GtkWidget *set_marker_b1;
   GtkWidget *separator7;
   GtkWidget *preferences1;
-  GtkWidget *image8259;
+  GtkWidget *image8336;
   GtkWidget *view1;
   GtkWidget *view1_menu;
   GtkWidget *toolbar1;
@@ -113,13 +113,13 @@
   GtkWidget *build_vbr_time_map1;
   GtkWidget *separator11;
   GtkWidget *save_audio1;
-  GtkWidget *image8260;
+  GtkWidget *image8337;
   GtkWidget *audio_encoder1;
   GtkWidget *filters2;
   GtkWidget *tools1;
   GtkWidget *tools1_menu;
   GtkWidget *calculator1;
-  GtkWidget *image8261;
+  GtkWidget *image8338;
   GtkWidget *separator12;
   GtkWidget *rebuild_frames;
   GtkWidget *check_frames;
@@ -141,36 +141,35 @@
   GtkWidget *go1;
   GtkWidget *go1_menu;
   GtkWidget *play_video1;
-  GtkWidget *image8262;
+  GtkWidget *image8339;
   GtkWidget *previous_frame1;
-  GtkWidget *image8263;
+  GtkWidget *image8340;
   GtkWidget *next_frame1;
-  GtkWidget *image8264;
+  GtkWidget *image8341;
   GtkWidget *previous_intra_frame1;
-  GtkWidget *image8265;
+  GtkWidget *image8342;
   GtkWidget *next_intra_frame1;
-  GtkWidget *image8266;
+  GtkWidget *image8343;
   GtkWidget *search_previous_black_frame1;
   GtkWidget *search_next_black_frame1;
   GtkWidget *first_frame1;
-  GtkWidget *image8267;
+  GtkWidget *image8344;
   GtkWidget *last_frame1;
-  GtkWidget *image8268;
+  GtkWidget *image8345;
   GtkWidget *separator14;
   GtkWidget *go_to_marker_a1;
   GtkWidget *go_to_marker_b1;
   GtkWidget *separator15;
   GtkWidget *jum_to_frame1;
-  GtkWidget *image8269;
+  GtkWidget *image8346;
   GtkWidget *jump_to_time1;
-  GtkWidget *image8270;
+  GtkWidget *image8347;
   GtkWidget *custom1;
   GtkWidget *help2;
   GtkWidget *help2_menu;
   GtkWidget *show_builtin_support1;
   GtkWidget *about1;
-  GtkWidget *image8271;
-  GtkWidget *hbox20;
+  GtkWidget *image8348;
   GtkWidget *toolbar2;
   GtkIconSize tmp_toolbar_icon_size;
   GtkWidget *menutoolbuttonOpen;
@@ -183,9 +182,10 @@
   GtkWidget *separatortoolitem2;
   GtkWidget *toolitem12;
   GtkWidget *comboboxPreview;
-  GtkWidget *hbox21;
+  GtkWidget *toolitem13;
   GtkWidget *togglebutton1;
   GtkWidget *image8272;
+  GtkWidget *toolitem14;
   GtkWidget *hscalVolume;
   GtkWidget *vbox10;
   GtkWidget *hbox14;
@@ -300,9 +300,9 @@
                               GDK_O, (GdkModifierType)( GDK_CONTROL_MASK),
                               GTK_ACCEL_VISIBLE);
 
-  image8246 = gtk_image_new_from_stock ("gtk-open", GTK_ICON_SIZE_MENU);
-  gtk_widget_show (image8246);
-  gtk_image_menu_item_set_image (GTK_IMAGE_MENU_ITEM (open_video1), image8246);
+  image8323 = gtk_image_new_from_stock ("gtk-open", GTK_ICON_SIZE_MENU);
+  gtk_widget_show (image8323);
+  gtk_image_menu_item_set_image (GTK_IMAGE_MENU_ITEM (open_video1), image8323);
 
   append_video1 = gtk_image_menu_item_new_with_mnemonic (_("_Append..."));
   gtk_widget_show (append_video1);
@@ -311,17 +311,17 @@
                               GDK_A, (GdkModifierType)( GDK_CONTROL_MASK | GDK_MOD1_MASK),
                               GTK_ACCEL_VISIBLE);
 
-  image8247 = gtk_image_new_from_stock ("gtk-add", GTK_ICON_SIZE_MENU);
-  gtk_widget_show (image8247);
-  gtk_image_menu_item_set_image (GTK_IMAGE_MENU_ITEM (append_video1), image8247);
+  image8324 = gtk_image_new_from_stock ("gtk-add", GTK_ICON_SIZE_MENU);
+  gtk_widget_show (image8324);
+  gtk_image_menu_item_set_image (GTK_IMAGE_MENU_ITEM (append_video1), image8324);
 
   save_stuff = gtk_image_menu_item_new_with_mnemonic (_("_Save"));
   gtk_widget_show (save_stuff);
   gtk_container_add (GTK_CONTAINER (menuitem1_menu), save_stuff);
 
-  image8248 = gtk_image_new_from_stock ("gtk-save", GTK_ICON_SIZE_MENU);
-  gtk_widget_show (image8248);
-  gtk_image_menu_item_set_image (GTK_IMAGE_MENU_ITEM (save_stuff), image8248);
+  image8325 = gtk_image_new_from_stock ("gtk-save", GTK_ICON_SIZE_MENU);
+  gtk_widget_show (image8325);
+  gtk_image_menu_item_set_image (GTK_IMAGE_MENU_ITEM (save_stuff), image8325);
 
   save_stuff_menu = gtk_menu_new ();
   gtk_menu_item_set_submenu (GTK_MENU_ITEM (save_stuff), save_stuff_menu);
@@ -363,25 +363,25 @@
   gtk_widget_show (save_project1);
   gtk_container_add (GTK_CONTAINER (menuitem1_menu), save_project1);
 
-  image8249 = gtk_image_new_from_stock ("gtk-save", GTK_ICON_SIZE_MENU);
-  gtk_widget_show (image8249);
-  gtk_image_menu_item_set_image (GTK_IMAGE_MENU_ITEM (save_project1), image8249);
+  image8326 = gtk_image_new_from_stock ("gtk-save", GTK_ICON_SIZE_MENU);
+  gtk_widget_show (image8326);
+  gtk_image_menu_item_set_image (GTK_IMAGE_MENU_ITEM (save_project1), image8326);
 
   save_project_as1 = gtk_image_menu_item_new_with_mnemonic (_("Save P_roject As..."));
   gtk_widget_show (save_project_as1);
   gtk_container_add (GTK_CONTAINER (menuitem1_menu), save_project_as1);
 
-  image8250 = gtk_image_new_from_stock ("gtk-save-as", GTK_ICON_SIZE_MENU);
-  gtk_widget_show (image8250);
-  gtk_image_menu_item_set_image (GTK_IMAGE_MENU_ITEM (save_project_as1), image8250);
+  image8327 = gtk_image_new_from_stock ("gtk-save-as", GTK_ICON_SIZE_MENU);
+  gtk_widget_show (image8327);
+  gtk_image_menu_item_set_image (GTK_IMAGE_MENU_ITEM (save_project_as1), image8327);
 
   run_script1 = gtk_image_menu_item_new_with_mnemonic (_("_Load/Run Project..."));
   gtk_widget_show (run_script1);
   gtk_container_add (GTK_CONTAINER (menuitem1_menu), run_script1);
 
-  image8251 = gtk_image_new_from_stock ("gtk-execute", GTK_ICON_SIZE_MENU);
-  gtk_widget_show (image8251);
-  gtk_image_menu_item_set_image (GTK_IMAGE_MENU_ITEM (run_script1), image8251);
+  image8328 = gtk_image_new_from_stock ("gtk-execute", GTK_ICON_SIZE_MENU);
+  gtk_widget_show (image8328);
+  gtk_image_menu_item_set_image (GTK_IMAGE_MENU_ITEM (run_script1), image8328);
 
   add_to_joblist1 = gtk_menu_item_new_with_mnemonic (_("A_dd to Joblist..."));
   gtk_widget_show (add_to_joblist1);
@@ -415,9 +415,9 @@
                               GDK_Return, (GdkModifierType)( GDK_MOD1_MASK),
                               GTK_ACCEL_VISIBLE);
 
-  image8252 = gtk_image_new_from_stock ("gtk-properties", GTK_ICON_SIZE_MENU);
-  gtk_widget_show (image8252);
-  gtk_image_menu_item_set_image (GTK_IMAGE_MENU_ITEM (video_informations1), image8252);
+  image8329 = gtk_image_new_from_stock ("gtk-properties", GTK_ICON_SIZE_MENU);
+  gtk_widget_show (image8329);
+  gtk_image_menu_item_set_image (GTK_IMAGE_MENU_ITEM (video_informations1), image8329);
 
   avi_muxer_options1 = gtk_menu_item_new_with_mnemonic (_("AVI _Muxer Options"));
   gtk_widget_show (avi_muxer_options1);
@@ -435,9 +435,9 @@
                               GDK_Q, (GdkModifierType)( GDK_CONTROL_MASK),
                               GTK_ACCEL_VISIBLE);
 
-  image8253 = gtk_image_new_from_stock ("gtk-quit", GTK_ICON_SIZE_MENU);
-  gtk_widget_show (image8253);
-  gtk_image_menu_item_set_image (GTK_IMAGE_MENU_ITEM (quit1), image8253);
+  image8330 = gtk_image_new_from_stock ("gtk-quit", GTK_ICON_SIZE_MENU);
+  gtk_widget_show (image8330);
+  gtk_image_menu_item_set_image (GTK_IMAGE_MENU_ITEM (quit1), image8330);
 
   menuitem2 = gtk_menu_item_new_with_mnemonic (_("_Edit"));
   gtk_widget_show (menuitem2);
@@ -450,9 +450,9 @@
   gtk_widget_show (reset_edits1);
   gtk_container_add (GTK_CONTAINER (menuitem2_menu), reset_edits1);
 
-  image8254 = gtk_image_new_from_stock ("gtk-undo", GTK_ICON_SIZE_MENU);
-  gtk_widget_show (image8254);
-  gtk_image_menu_item_set_image (GTK_IMAGE_MENU_ITEM (reset_edits1), image8254);
+  image8331 = gtk_image_new_from_stock ("gtk-undo", GTK_ICON_SIZE_MENU);
+  gtk_widget_show (image8331);
+  gtk_image_menu_item_set_image (GTK_IMAGE_MENU_ITEM (reset_edits1), image8331);
 
   separator5 = gtk_separator_menu_item_new ();
   gtk_widget_show (separator5);
@@ -466,9 +466,9 @@
                               GDK_X, (GdkModifierType)( GDK_CONTROL_MASK),
                               GTK_ACCEL_VISIBLE);
 
-  image8255 = gtk_image_new_from_stock ("gtk-cut", GTK_ICON_SIZE_MENU);
-  gtk_widget_show (image8255);
-  gtk_image_menu_item_set_image (GTK_IMAGE_MENU_ITEM (cut1), image8255);
+  image8332 = gtk_image_new_from_stock ("gtk-cut", GTK_ICON_SIZE_MENU);
+  gtk_widget_show (image8332);
+  gtk_image_menu_item_set_image (GTK_IMAGE_MENU_ITEM (cut1), image8332);
 
   copy1 = gtk_image_menu_item_new_with_mnemonic (_("_Copy"));
   gtk_widget_show (copy1);
@@ -477,9 +477,9 @@
                               GDK_C, (GdkModifierType)( GDK_CONTROL_MASK),
                               GTK_ACCEL_VISIBLE);
 
-  image8256 = gtk_image_new_from_stock ("gtk-copy", GTK_ICON_SIZE_MENU);
-  gtk_widget_show (image8256);
-  gtk_image_menu_item_set_image (GTK_IMAGE_MENU_ITEM (copy1), image8256);
+  image8333 = gtk_image_new_from_stock ("gtk-copy", GTK_ICON_SIZE_MENU);
+  gtk_widget_show (image8333);
+  gtk_image_menu_item_set_image (GTK_IMAGE_MENU_ITEM (copy1), image8333);
 
   paste1 = gtk_image_menu_item_new_with_mnemonic (_("_Paste"));
   gtk_widget_show (paste1);
@@ -488,9 +488,9 @@
                               GDK_V, (GdkModifierType)( GDK_CONTROL_MASK),
                               GTK_ACCEL_VISIBLE);
 
-  image8257 = gtk_image_new_from_stock ("gtk-paste", GTK_ICON_SIZE_MENU);
-  gtk_widget_show (image8257);
-  gtk_image_menu_item_set_image (GTK_IMAGE_MENU_ITEM (paste1), image8257);
+  image8334 = gtk_image_new_from_stock ("gtk-paste", GTK_ICON_SIZE_MENU);
+  gtk_widget_show (image8334);
+  gtk_image_menu_item_set_image (GTK_IMAGE_MENU_ITEM (paste1), image8334);
 
   delete1 = gtk_image_menu_item_new_with_mnemonic (_("_Delete"));
   gtk_widget_show (delete1);
@@ -499,9 +499,9 @@
                               GDK_Delete, (GdkModifierType)( 0 ),
                               GTK_ACCEL_VISIBLE);
 
-  image8258 = gtk_image_new_from_stock ("gtk-remove", GTK_ICON_SIZE_MENU);
-  gtk_widget_show (image8258);
-  gtk_image_menu_item_set_image (GTK_IMAGE_MENU_ITEM (delete1), image8258);
+  image8335 = gtk_image_new_from_stock ("gtk-remove", GTK_ICON_SIZE_MENU);
+  gtk_widget_show (image8335);
+  gtk_image_menu_item_set_image (GTK_IMAGE_MENU_ITEM (delete1), image8335);
 
   separator6 = gtk_separator_menu_item_new ();
   gtk_widget_show (separator6);
@@ -531,9 +531,9 @@
   gtk_widget_show (preferences1);
   gtk_container_add (GTK_CONTAINER (menuitem2_menu), preferences1);
 
-  image8259 = gtk_image_new_from_stock ("gtk-preferences", GTK_ICON_SIZE_MENU);
-  gtk_widget_show (image8259);
-  gtk_image_menu_item_set_image (GTK_IMAGE_MENU_ITEM (preferences1), image8259);
+  image8336 = gtk_image_new_from_stock ("gtk-preferences", GTK_ICON_SIZE_MENU);
+  gtk_widget_show (image8336);
+  gtk_image_menu_item_set_image (GTK_IMAGE_MENU_ITEM (preferences1), image8336);
 
   view1 = gtk_menu_item_new_with_mnemonic (_("_View"));
   gtk_widget_show (view1);
@@ -687,9 +687,9 @@
                               GDK_S, (GdkModifierType)( GDK_CONTROL_MASK | GDK_MOD1_MASK),
                               GTK_ACCEL_VISIBLE);
 
-  image8260 = gtk_image_new_from_stock ("gtk-save-as", GTK_ICON_SIZE_MENU);
-  gtk_widget_show (image8260);
-  gtk_image_menu_item_set_image (GTK_IMAGE_MENU_ITEM (save_audio1), image8260);
+  image8337 = gtk_image_new_from_stock ("gtk-save-as", GTK_ICON_SIZE_MENU);
+  gtk_widget_show (image8337);
+  gtk_image_menu_item_set_image (GTK_IMAGE_MENU_ITEM (save_audio1), image8337);
 
   audio_encoder1 = gtk_menu_item_new_with_mnemonic (_("_Encoder"));
   gtk_widget_show (audio_encoder1);
@@ -716,9 +716,9 @@
                               GDK_F7, (GdkModifierType)( 0 ),
                               GTK_ACCEL_VISIBLE);
 
-  image8261 = create_pixmap (mainWindow, "gnome-calculator_small.xpm");
-  gtk_widget_show (image8261);
-  gtk_image_menu_item_set_image (GTK_IMAGE_MENU_ITEM (calculator1), image8261);
+  image8338 = create_pixmap (mainWindow, "gnome-calculator_small.xpm");
+  gtk_widget_show (image8338);
+  gtk_image_menu_item_set_image (GTK_IMAGE_MENU_ITEM (calculator1), image8338);
 
   separator12 = gtk_separator_menu_item_new ();
   gtk_widget_show (separator12);
@@ -754,7 +754,7 @@
   gtk_widget_show (ocr_vobsub_2_srt);
   gtk_container_add (GTK_CONTAINER (tools1_menu), ocr_vobsub_2_srt);
 
-  edit_glyph1 = gtk_menu_item_new_with_mnemonic (_("Edit glyph"));
+  edit_glyph1 = gtk_menu_item_new_with_mnemonic (_("_Edit Glyph"));
   gtk_widget_show (edit_glyph1);
   gtk_container_add (GTK_CONTAINER (tools1_menu), edit_glyph1);
 
@@ -808,9 +808,9 @@
                               GDK_P, (GdkModifierType)( 0 ),
                               GTK_ACCEL_VISIBLE);
 
-  image8262 = gtk_image_new_from_stock ("gtk-media-play", GTK_ICON_SIZE_MENU);
-  gtk_widget_show (image8262);
-  gtk_image_menu_item_set_image (GTK_IMAGE_MENU_ITEM (play_video1), image8262);
+  image8339 = gtk_image_new_from_stock ("gtk-media-play", GTK_ICON_SIZE_MENU);
+  gtk_widget_show (image8339);
+  gtk_image_menu_item_set_image (GTK_IMAGE_MENU_ITEM (play_video1), image8339);
 
   previous_frame1 = gtk_image_menu_item_new_with_mnemonic (_("P_revious Frame"));
   gtk_widget_show (previous_frame1);
@@ -819,9 +819,9 @@
                               GDK_KP_4, (GdkModifierType)( 0 ),
                               GTK_ACCEL_VISIBLE);
 
-  image8263 = gtk_image_new_from_stock ("gtk-media-previous", GTK_ICON_SIZE_MENU);
-  gtk_widget_show (image8263);
-  gtk_image_menu_item_set_image (GTK_IMAGE_MENU_ITEM (previous_frame1), image8263);
+  image8340 = gtk_image_new_from_stock ("gtk-media-previous", GTK_ICON_SIZE_MENU);
+  gtk_widget_show (image8340);
+  gtk_image_menu_item_set_image (GTK_IMAGE_MENU_ITEM (previous_frame1), image8340);
 
   next_frame1 = gtk_image_menu_item_new_with_mnemonic (_("_Next Frame"));
   gtk_widget_show (next_frame1);
@@ -830,9 +830,9 @@
                               GDK_KP_6, (GdkModifierType)( 0 ),
                               GTK_ACCEL_VISIBLE);
 
-  image8264 = gtk_image_new_from_stock ("gtk-media-next", GTK_ICON_SIZE_MENU);
-  gtk_widget_show (image8264);
-  gtk_image_menu_item_set_image (GTK_IMAGE_MENU_ITEM (next_frame1), image8264);
+  image8341 = gtk_image_new_from_stock ("gtk-media-next", GTK_ICON_SIZE_MENU);
+  gtk_widget_show (image8341);
+  gtk_image_menu_item_set_image (GTK_IMAGE_MENU_ITEM (next_frame1), image8341);
 
   previous_intra_frame1 = gtk_image_menu_item_new_with_mnemonic (_("Pr_evious Intra Frame"));
   gtk_widget_show (previous_intra_frame1);
@@ -841,9 +841,9 @@
                               GDK_KP_2, (GdkModifierType)( 0 ),
                               GTK_ACCEL_VISIBLE);
 
-  image8265 = gtk_image_new_from_stock ("gtk-media-rewind", GTK_ICON_SIZE_MENU);
-  gtk_widget_show (image8265);
-  gtk_image_menu_item_set_image (GTK_IMAGE_MENU_ITEM (previous_intra_frame1), image8265);
+  image8342 = gtk_image_new_from_stock ("gtk-media-rewind", GTK_ICON_SIZE_MENU);
+  gtk_widget_show (image8342);
+  gtk_image_menu_item_set_image (GTK_IMAGE_MENU_ITEM (previous_intra_frame1), image8342);
 
   next_intra_frame1 = gtk_image_menu_item_new_with_mnemonic (_("Next _Intra Frame"));
   gtk_widget_show (next_intra_frame1);
@@ -852,9 +852,9 @@
                               GDK_KP_8, (GdkModifierType)( 0 ),
                               GTK_ACCEL_VISIBLE);
 
-  image8266 = gtk_image_new_from_stock ("gtk-media-forward", GTK_ICON_SIZE_MENU);
-  gtk_widget_show (image8266);
-  gtk_image_menu_item_set_image (GTK_IMAGE_MENU_ITEM (next_intra_frame1), image8266);
+  image8343 = gtk_image_new_from_stock ("gtk-media-forward", GTK_ICON_SIZE_MENU);
+  gtk_widget_show (image8343);
+  gtk_image_menu_item_set_image (GTK_IMAGE_MENU_ITEM (next_intra_frame1), image8343);
 
   search_previous_black_frame1 = gtk_menu_item_new_with_mnemonic (_("Previou_s Black Frame"));
   gtk_widget_show (search_previous_black_frame1);
@@ -871,9 +871,9 @@
                               GDK_Home, (GdkModifierType)( 0 ),
                               GTK_ACCEL_VISIBLE);
 
-  image8267 = gtk_image_new_from_stock ("gtk-goto-first", GTK_ICON_SIZE_MENU);
-  gtk_widget_show (image8267);
-  gtk_image_menu_item_set_image (GTK_IMAGE_MENU_ITEM (first_frame1), image8267);
+  image8344 = gtk_image_new_from_stock ("gtk-goto-first", GTK_ICON_SIZE_MENU);
+  gtk_widget_show (image8344);
+  gtk_image_menu_item_set_image (GTK_IMAGE_MENU_ITEM (first_frame1), image8344);
 
   last_frame1 = gtk_image_menu_item_new_with_mnemonic (_("_Last Frame"));
   gtk_widget_show (last_frame1);
@@ -882,9 +882,9 @@
                               GDK_End, (GdkModifierType)( 0 ),
                               GTK_ACCEL_VISIBLE);
 
-  image8268 = gtk_image_new_from_stock ("gtk-goto-last", GTK_ICON_SIZE_MENU);
-  gtk_widget_show (image8268);
-  gtk_image_menu_item_set_image (GTK_IMAGE_MENU_ITEM (last_frame1), image8268);
+  image8345 = gtk_image_new_from_stock ("gtk-goto-last", GTK_ICON_SIZE_MENU);
+  gtk_widget_show (image8345);
+  gtk_image_menu_item_set_image (GTK_IMAGE_MENU_ITEM (last_frame1), image8345);
 
   separator14 = gtk_separator_menu_item_new ();
   gtk_widget_show (separator14);
@@ -910,27 +910,27 @@
   gtk_container_add (GTK_CONTAINER (go1_menu), separator15);
   gtk_widget_set_sensitive (separator15, FALSE);
 
-  jum_to_frame1 = gtk_image_menu_item_new_with_mnemonic (_("_Jump to Frame..."));
+  jum_to_frame1 = gtk_image_menu_item_new_with_mnemonic (_("Go to Fra_me..."));
   gtk_widget_show (jum_to_frame1);
   gtk_container_add (GTK_CONTAINER (go1_menu), jum_to_frame1);
   gtk_widget_add_accelerator (jum_to_frame1, "activate", accel_group,
                               GDK_F, (GdkModifierType)( GDK_CONTROL_MASK),
                               GTK_ACCEL_VISIBLE);
 
-  image8269 = gtk_image_new_from_stock ("gtk-jump-to", GTK_ICON_SIZE_MENU);
-  gtk_widget_show (image8269);
-  gtk_image_menu_item_set_image (GTK_IMAGE_MENU_ITEM (jum_to_frame1), image8269);
+  image8346 = gtk_image_new_from_stock ("gtk-jump-to", GTK_ICON_SIZE_MENU);
+  gtk_widget_show (image8346);
+  gtk_image_menu_item_set_image (GTK_IMAGE_MENU_ITEM (jum_to_frame1), image8346);
 
-  jump_to_time1 = gtk_image_menu_item_new_with_mnemonic (_("Jump to _Time..."));
+  jump_to_time1 = gtk_image_menu_item_new_with_mnemonic (_("Go to _Time..."));
   gtk_widget_show (jump_to_time1);
   gtk_container_add (GTK_CONTAINER (go1_menu), jump_to_time1);
   gtk_widget_add_accelerator (jump_to_time1, "activate", accel_group,
                               GDK_T, (GdkModifierType)( GDK_CONTROL_MASK),
                               GTK_ACCEL_VISIBLE);
 
-  image8270 = gtk_image_new_from_stock ("gtk-jump-to", GTK_ICON_SIZE_MENU);
-  gtk_widget_show (image8270);
-  gtk_image_menu_item_set_image (GTK_IMAGE_MENU_ITEM (jump_to_time1), image8270);
+  image8347 = gtk_image_new_from_stock ("gtk-jump-to", GTK_ICON_SIZE_MENU);
+  gtk_widget_show (image8347);
+  gtk_image_menu_item_set_image (GTK_IMAGE_MENU_ITEM (jump_to_time1), image8347);
 
   custom1 = gtk_menu_item_new_with_mnemonic (_("_Custom"));
   gtk_widget_show (custom1);
@@ -951,17 +951,13 @@
   gtk_widget_show (about1);
   gtk_container_add (GTK_CONTAINER (help2_menu), about1);
 
-  image8271 = gtk_image_new_from_stock ("gtk-about", GTK_ICON_SIZE_MENU);
-  gtk_widget_show (image8271);
-  gtk_image_menu_item_set_image (GTK_IMAGE_MENU_ITEM (about1), image8271);
+  image8348 = gtk_image_new_from_stock ("gtk-about", GTK_ICON_SIZE_MENU);
+  gtk_widget_show (image8348);
+  gtk_image_menu_item_set_image (GTK_IMAGE_MENU_ITEM (about1), image8348);
 
-  hbox20 = gtk_hbox_new (FALSE, 0);
-  gtk_widget_show (hbox20);
-  gtk_box_pack_start (GTK_BOX (vbox1), hbox20, TRUE, TRUE, 0);
-
   toolbar2 = gtk_toolbar_new ();
   gtk_widget_show (toolbar2);
-  gtk_box_pack_start (GTK_BOX (hbox20), toolbar2, TRUE, TRUE, 0);
+  gtk_box_pack_start (GTK_BOX (vbox1), toolbar2, FALSE, FALSE, 0);
   gtk_toolbar_set_style (GTK_TOOLBAR (toolbar2), GTK_TOOLBAR_BOTH_HORIZ);
   tmp_toolbar_icon_size = gtk_toolbar_get_icon_size (GTK_TOOLBAR (toolbar2));
 
@@ -1011,21 +1007,28 @@
   gtk_widget_show (comboboxPreview);
   gtk_container_add (GTK_CONTAINER (toolitem12), comboboxPreview);
 
-  hbox21 = gtk_hbox_new (FALSE, 0);
-  gtk_widget_show (hbox21);
-  gtk_box_pack_start (GTK_BOX (hbox20), hbox21, TRUE, TRUE, 0);
+  toolitem13 = (GtkWidget*) gtk_tool_item_new ();
+  gtk_widget_show (toolitem13);
+  gtk_container_add (GTK_CONTAINER (toolbar2), toolitem13);
 
   togglebutton1 = gtk_toggle_button_new ();
   gtk_widget_show (togglebutton1);
-  gtk_box_pack_start (GTK_BOX (hbox21), togglebutton1, FALSE, FALSE, 0);
+  gtk_container_add (GTK_CONTAINER (toolitem13), togglebutton1);
+  gtk_button_set_relief (GTK_BUTTON (togglebutton1), GTK_RELIEF_NONE);
 
-  image8272 = gtk_image_new_from_stock ("gtk-connect", GTK_ICON_SIZE_MENU);
+  image8272 = create_pixmap (mainWindow, "audio-volume-medium.png");
   gtk_widget_show (image8272);
   gtk_container_add (GTK_CONTAINER (togglebutton1), image8272);
+  gtk_widget_set_size_request (image8272, 17, 16);
 
+  toolitem14 = (GtkWidget*) gtk_tool_item_new ();
+  gtk_widget_show (toolitem14);
+  gtk_container_add (GTK_CONTAINER (toolbar2), toolitem14);
+
   hscalVolume = gtk_hscale_new (GTK_ADJUSTMENT (gtk_adjustment_new (99, 0, 100, 1, 1, 1)));
   gtk_widget_show (hscalVolume);
-  gtk_box_pack_start (GTK_BOX (hbox21), hscalVolume, TRUE, TRUE, 0);
+  gtk_container_add (GTK_CONTAINER (toolitem14), hscalVolume);
+  gtk_widget_set_size_request (hscalVolume, 100, -1);
   gtk_scale_set_draw_value (GTK_SCALE (hscalVolume), FALSE);
   gtk_scale_set_digits (GTK_SCALE (hscalVolume), 0);
 
@@ -1426,7 +1429,7 @@
   gtk_entry_set_text (GTK_ENTRY (boxCurFrame), _("0"));
   gtk_entry_set_width_chars (GTK_ENTRY (boxCurFrame), 8);
 
-  labelTotalFrame = gtk_label_new (_("/0000000"));
+  labelTotalFrame = gtk_label_new (_("/ 0000000"));
   gtk_widget_show (labelTotalFrame);
   gtk_box_pack_start (GTK_BOX (hbox16), labelTotalFrame, FALSE, FALSE, 0);
   GTK_WIDGET_SET_FLAGS (labelTotalFrame, GTK_CAN_FOCUS);
@@ -1444,7 +1447,7 @@
   gtk_entry_set_text (GTK_ENTRY (boxCurTime), _("00:00:00.000"));
   gtk_entry_set_width_chars (GTK_ENTRY (boxCurTime), 13);
 
-  labelTotalTime = gtk_label_new (_("/00:00:00,000"));
+  labelTotalTime = gtk_label_new (_("/ 00:00:00,000"));
   gtk_widget_show (labelTotalTime);
   gtk_box_pack_start (GTK_BOX (hbox16), labelTotalTime, FALSE, FALSE, 0);
   GTK_WIDGET_SET_FLAGS (labelTotalTime, GTK_CAN_FOCUS);
@@ -1472,11 +1475,11 @@
   GLADE_HOOKUP_OBJECT (mainWindow, menuitem1, "menuitem1");
   GLADE_HOOKUP_OBJECT (mainWindow, menuitem1_menu, "menuitem1_menu");
   GLADE_HOOKUP_OBJECT (mainWindow, open_video1, "open_video1");
-  GLADE_HOOKUP_OBJECT (mainWindow, image8246, "image8246");
+  GLADE_HOOKUP_OBJECT (mainWindow, image8323, "image8323");
   GLADE_HOOKUP_OBJECT (mainWindow, append_video1, "append_video1");
-  GLADE_HOOKUP_OBJECT (mainWindow, image8247, "image8247");
+  GLADE_HOOKUP_OBJECT (mainWindow, image8324, "image8324");
   GLADE_HOOKUP_OBJECT (mainWindow, save_stuff, "save_stuff");
-  GLADE_HOOKUP_OBJECT (mainWindow, image8248, "image8248");
+  GLADE_HOOKUP_OBJECT (mainWindow, image8325, "image8325");
   GLADE_HOOKUP_OBJECT (mainWindow, save_stuff_menu, "save_stuff_menu");
   GLADE_HOOKUP_OBJECT (mainWindow, save_as_avi1, "save_as_avi1");
   GLADE_HOOKUP_OBJECT (mainWindow, separator1, "separator1");
@@ -1486,41 +1489,41 @@
   GLADE_HOOKUP_OBJECT (mainWindow, close1, "close1");
   GLADE_HOOKUP_OBJECT (mainWindow, separator3, "separator3");
   GLADE_HOOKUP_OBJECT (mainWindow, save_project1, "save_project1");
-  GLADE_HOOKUP_OBJECT (mainWindow, image8249, "image8249");
+  GLADE_HOOKUP_OBJECT (mainWindow, image8326, "image8326");
   GLADE_HOOKUP_OBJECT (mainWindow, save_project_as1, "save_project_as1");
-  GLADE_HOOKUP_OBJECT (mainWindow, image8250, "image8250");
+  GLADE_HOOKUP_OBJECT (mainWindow, image8327, "image8327");
   GLADE_HOOKUP_OBJECT (mainWindow, run_script1, "run_script1");
-  GLADE_HOOKUP_OBJECT (mainWindow, image8251, "image8251");
+  GLADE_HOOKUP_OBJECT (mainWindow, image8328, "image8328");
   GLADE_HOOKUP_OBJECT (mainWindow, add_to_joblist1, "add_to_joblist1");
   GLADE_HOOKUP_OBJECT (mainWindow, joblist1, "joblist1");
   GLADE_HOOKUP_OBJECT (mainWindow, separator16, "separator16");
   GLADE_HOOKUP_OBJECT (mainWindow, connect_to_avsproxy1, "connect_to_avsproxy1");
   GLADE_HOOKUP_OBJECT (mainWindow, separator18, "separator18");
   GLADE_HOOKUP_OBJECT (mainWindow, video_informations1, "video_informations1");
-  GLADE_HOOKUP_OBJECT (mainWindow, image8252, "image8252");
+  GLADE_HOOKUP_OBJECT (mainWindow, image8329, "image8329");
   GLADE_HOOKUP_OBJECT (mainWindow, avi_muxer_options1, "avi_muxer_options1");
   GLADE_HOOKUP_OBJECT (mainWindow, separator4, "separator4");
   GLADE_HOOKUP_OBJECT (mainWindow, quit1, "quit1");
-  GLADE_HOOKUP_OBJECT (mainWindow, image8253, "image8253");
+  GLADE_HOOKUP_OBJECT (mainWindow, image8330, "image8330");
   GLADE_HOOKUP_OBJECT (mainWindow, menuitem2, "menuitem2");
   GLADE_HOOKUP_OBJECT (mainWindow, menuitem2_menu, "menuitem2_menu");
   GLADE_HOOKUP_OBJECT (mainWindow, reset_edits1, "reset_edits1");
-  GLADE_HOOKUP_OBJECT (mainWindow, image8254, "image8254");
+  GLADE_HOOKUP_OBJECT (mainWindow, image8331, "image8331");
   GLADE_HOOKUP_OBJECT (mainWindow, separator5, "separator5");
   GLADE_HOOKUP_OBJECT (mainWindow, cut1, "cut1");
-  GLADE_HOOKUP_OBJECT (mainWindow, image8255, "image8255");
+  GLADE_HOOKUP_OBJECT (mainWindow, image8332, "image8332");
   GLADE_HOOKUP_OBJECT (mainWindow, copy1, "copy1");
-  GLADE_HOOKUP_OBJECT (mainWindow, image8256, "image8256");
+  GLADE_HOOKUP_OBJECT (mainWindow, image8333, "image8333");
   GLADE_HOOKUP_OBJECT (mainWindow, paste1, "paste1");
-  GLADE_HOOKUP_OBJECT (mainWindow, image8257, "image8257");
+  GLADE_HOOKUP_OBJECT (mainWindow, image8334, "image8334");
   GLADE_HOOKUP_OBJECT (mainWindow, delete1, "delete1");
-  GLADE_HOOKUP_OBJECT (mainWindow, image8258, "image8258");
+  GLADE_HOOKUP_OBJECT (mainWindow, image8335, "image8335");
   GLADE_HOOKUP_OBJECT (mainWindow, separator6, "separator6");
   GLADE_HOOKUP_OBJECT (mainWindow, set_marker_a1, "set_marker_a1");
   GLADE_HOOKUP_OBJECT (mainWindow, set_marker_b1, "set_marker_b1");
   GLADE_HOOKUP_OBJECT (mainWindow, separator7, "separator7");
   GLADE_HOOKUP_OBJECT (mainWindow, preferences1, "preferences1");
-  GLADE_HOOKUP_OBJECT (mainWindow, image8259, "image8259");
+  GLADE_HOOKUP_OBJECT (mainWindow, image8336, "image8336");
   GLADE_HOOKUP_OBJECT (mainWindow, view1, "view1");
   GLADE_HOOKUP_OBJECT (mainWindow, view1_menu, "view1_menu");
   GLADE_HOOKUP_OBJECT (mainWindow, toolbar1, "toolbar1");
@@ -1549,13 +1552,13 @@
   GLADE_HOOKUP_OBJECT (mainWindow, build_vbr_time_map1, "build_vbr_time_map1");
   GLADE_HOOKUP_OBJECT (mainWindow, separator11, "separator11");
   GLADE_HOOKUP_OBJECT (mainWindow, save_audio1, "save_audio1");
-  GLADE_HOOKUP_OBJECT (mainWindow, image8260, "image8260");
+  GLADE_HOOKUP_OBJECT (mainWindow, image8337, "image8337");
   GLADE_HOOKUP_OBJECT (mainWindow, audio_encoder1, "audio_encoder1");
   GLADE_HOOKUP_OBJECT (mainWindow, filters2, "filters2");
   GLADE_HOOKUP_OBJECT (mainWindow, tools1, "tools1");
   GLADE_HOOKUP_OBJECT (mainWindow, tools1_menu, "tools1_menu");
   GLADE_HOOKUP_OBJECT (mainWindow, calculator1, "calculator1");
-  GLADE_HOOKUP_OBJECT (mainWindow, image8261, "image8261");
+  GLADE_HOOKUP_OBJECT (mainWindow, image8338, "image8338");
   GLADE_HOOKUP_OBJECT (mainWindow, separator12, "separator12");
   GLADE_HOOKUP_OBJECT (mainWindow, rebuild_frames, "rebuild_frames");
   GLADE_HOOKUP_OBJECT (mainWindow, check_frames, "check_frames");
@@ -1577,36 +1580,35 @@
   GLADE_HOOKUP_OBJECT (mainWindow, go1, "go1");
   GLADE_HOOKUP_OBJECT (mainWindow, go1_menu, "go1_menu");
   GLADE_HOOKUP_OBJECT (mainWindow, play_video1, "play_video1");
-  GLADE_HOOKUP_OBJECT (mainWindow, image8262, "image8262");
+  GLADE_HOOKUP_OBJECT (mainWindow, image8339, "image8339");
   GLADE_HOOKUP_OBJECT (mainWindow, previous_frame1, "previous_frame1");
-  GLADE_HOOKUP_OBJECT (mainWindow, image8263, "image8263");
+  GLADE_HOOKUP_OBJECT (mainWindow, image8340, "image8340");
   GLADE_HOOKUP_OBJECT (mainWindow, next_frame1, "next_frame1");
-  GLADE_HOOKUP_OBJECT (mainWindow, image8264, "image8264");
+  GLADE_HOOKUP_OBJECT (mainWindow, image8341, "image8341");
   GLADE_HOOKUP_OBJECT (mainWindow, previous_intra_frame1, "previous_intra_frame1");
-  GLADE_HOOKUP_OBJECT (mainWindow, image8265, "image8265");
+  GLADE_HOOKUP_OBJECT (mainWindow, image8342, "image8342");
   GLADE_HOOKUP_OBJECT (mainWindow, next_intra_frame1, "next_intra_frame1");
-  GLADE_HOOKUP_OBJECT (mainWindow, image8266, "image8266");
+  GLADE_HOOKUP_OBJECT (mainWindow, image8343, "image8343");
   GLADE_HOOKUP_OBJECT (mainWindow, search_previous_black_frame1, "search_previous_black_frame1");
   GLADE_HOOKUP_OBJECT (mainWindow, search_next_black_frame1, "search_next_black_frame1");
   GLADE_HOOKUP_OBJECT (mainWindow, first_frame1, "first_frame1");
-  GLADE_HOOKUP_OBJECT (mainWindow, image8267, "image8267");
+  GLADE_HOOKUP_OBJECT (mainWindow, image8344, "image8344");
   GLADE_HOOKUP_OBJECT (mainWindow, last_frame1, "last_frame1");
-  GLADE_HOOKUP_OBJECT (mainWindow, image8268, "image8268");
+  GLADE_HOOKUP_OBJECT (mainWindow, image8345, "image8345");
   GLADE_HOOKUP_OBJECT (mainWindow, separator14, "separator14");
   GLADE_HOOKUP_OBJECT (mainWindow, go_to_marker_a1, "go_to_marker_a1");
   GLADE_HOOKUP_OBJECT (mainWindow, go_to_marker_b1, "go_to_marker_b1");
   GLADE_HOOKUP_OBJECT (mainWindow, separator15, "separator15");
   GLADE_HOOKUP_OBJECT (mainWindow, jum_to_frame1, "jum_to_frame1");
-  GLADE_HOOKUP_OBJECT (mainWindow, image8269, "image8269");
+  GLADE_HOOKUP_OBJECT (mainWindow, image8346, "image8346");
   GLADE_HOOKUP_OBJECT (mainWindow, jump_to_time1, "jump_to_time1");
-  GLADE_HOOKUP_OBJECT (mainWindow, image8270, "image8270");
+  GLADE_HOOKUP_OBJECT (mainWindow, image8347, "image8347");
   GLADE_HOOKUP_OBJECT (mainWindow, custom1, "custom1");
   GLADE_HOOKUP_OBJECT (mainWindow, help2, "help2");
   GLADE_HOOKUP_OBJECT (mainWindow, help2_menu, "help2_menu");
   GLADE_HOOKUP_OBJECT (mainWindow, show_builtin_support1, "show_builtin_support1");
   GLADE_HOOKUP_OBJECT (mainWindow, about1, "about1");
-  GLADE_HOOKUP_OBJECT (mainWindow, image8271, "image8271");
-  GLADE_HOOKUP_OBJECT (mainWindow, hbox20, "hbox20");
+  GLADE_HOOKUP_OBJECT (mainWindow, image8348, "image8348");
   GLADE_HOOKUP_OBJECT (mainWindow, toolbar2, "toolbar2");
   GLADE_HOOKUP_OBJECT (mainWindow, menutoolbuttonOpen, "menutoolbuttonOpen");
   GLADE_HOOKUP_OBJECT (mainWindow, toolitem11, "toolitem11");
@@ -1617,9 +1619,10 @@
   GLADE_HOOKUP_OBJECT (mainWindow, separatortoolitem2, "separatortoolitem2");
   GLADE_HOOKUP_OBJECT (mainWindow, toolitem12, "toolitem12");
   GLADE_HOOKUP_OBJECT (mainWindow, comboboxPreview, "comboboxPreview");
-  GLADE_HOOKUP_OBJECT (mainWindow, hbox21, "hbox21");
+  GLADE_HOOKUP_OBJECT (mainWindow, toolitem13, "toolitem13");
   GLADE_HOOKUP_OBJECT (mainWindow, togglebutton1, "togglebutton1");
   GLADE_HOOKUP_OBJECT (mainWindow, image8272, "image8272");
+  GLADE_HOOKUP_OBJECT (mainWindow, toolitem14, "toolitem14");
   GLADE_HOOKUP_OBJECT (mainWindow, hscalVolume, "hscalVolume");
   GLADE_HOOKUP_OBJECT (mainWindow, vbox10, "vbox10");
   GLADE_HOOKUP_OBJECT (mainWindow, hbox14, "hbox14");

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_menumap.h
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_menumap.h	2007-07-09 18:45:36 UTC (rev 3354)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_menumap.h	2007-07-10 18:34:21 UTC (rev 3355)
@@ -102,5 +102,7 @@
 CALLBACK(zoom_2_1                                   ,ACT_ZOOM_2_1);
 CALLBACK(zoom_4_1                                   ,ACT_ZOOM_4_1);
 CALLBACK(edit_glyph1                                ,ACT_GLYPHEDIT);
+//CALLBACK(hscalVolume                                ,ACT_VOLUME);
 
 
+

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_toolkit_gtk/ADM_gladeSupport.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_toolkit_gtk/ADM_gladeSupport.cpp	2007-07-09 18:45:36 UTC (rev 3354)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_toolkit_gtk/ADM_gladeSupport.cpp	2007-07-10 18:34:21 UTC (rev 3355)
@@ -59,6 +59,7 @@
 #include "xpm/film19.inc"
 #include "xpm/film21.inc"
 #include "xpm/film23.inc"
+#include "xpm/audio-volume-medium.inc"
 #include "xpm/preview-button.inc"
 
 typedef enum 
@@ -108,7 +109,7 @@
         {A_ICON_PNG,"7.png",(void *) x7},
         {A_ICON_PNG,"avidemux_icon_small.png",         (void *) avidemux_icon_small},
         {A_ICON_PNG,"systray.png",                 (void *)systray},
-        {A_ICON_PNG,"systray2.png",                 (void *)systray2},
+        {A_ICON_PNG,"audio-volume-medium.png",                 (void *)audio_volume_medium},
         {A_ICON_PNG,"preview-button.png",                 (void *)preview_button},
 	// Jakub nice animation
 #define MKFILM(x) 	{A_ICON_PNG,"film"#x".png",                 (void *)film##x},

Added: branches/avidemux_2.4_branch/avidemux/xpm/audio-volume-medium.inc
===================================================================
--- branches/avidemux_2.4_branch/avidemux/xpm/audio-volume-medium.inc	2007-07-09 18:45:36 UTC (rev 3354)
+++ branches/avidemux_2.4_branch/avidemux/xpm/audio-volume-medium.inc	2007-07-10 18:34:21 UTC (rev 3355)
@@ -0,0 +1,61 @@
+/* GdkPixbuf RGBA C-Source image dump */
+
+#ifdef __SUNPRO_C
+#pragma align 4 (audio-volume-medium)
+#endif
+#ifdef __GNUC__
+static const guint8 audio_volume_medium[] __attribute__ ((__aligned__ (4))) = 
+#else
+static const guint8 audio_volume_medium[] = 
+#endif
+{ ""
+  /* Pixbuf magic (0x47646b50) */
+  "GdkP"
+  /* length: header (24) + pixel_data (1024) */
+  "\0\0\4\30"
+  /* pixdata_type (0x1010002) */
+  "\1\1\0\2"
+  /* rowstride (64) */
+  "\0\0\0@"
+  /* width (16) */
+  "\0\0\0\20"
+  /* height (16) */
+  "\0\0\0\20"
+  /* pixel_data: */
+  "\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0"
+  "\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0"
+  "\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\210\212\205L\0\0\0\0"
+  "\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0"
+  "\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\210\212\205LUWS\377\0\0\0\1\0\0"
+  "\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0"
+  "\0\0\0\0\0\0\0\0\0\0\0\0\210\212\205LUWS\377UWS\377\0\0\0\6\0\0\0\0\0"
+  "\0\0\0\0\0\0\0\40J\207\225\40J\207\31\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0"
+  "\0\0\0\0\0\0\0\0\210\212\205LUWS\377\247\251\245\377UWS\377\0\0\0\0\0"
+  "\0\0\0\0\0\0\0\0\0\0\0\40J\207\31\40J\207\225\40J\207\31\0\0\0\0UWS\377"
+  "UWS\377UWS\377\210\212\205LUWS\377\247\251\245\377\330\331\327\377UW"
+  "S\377\0\0\0\0\0\0\0\0\40J\207\377\40J\207+\0\0\0\0\40J\207c\40J\207."
+  "\0\0\0\0UWS\377\265\267\264\377\233\234\232\377UWS\377\247\251\245\377"
+  "\337\340\336\377\365\365\365\377UWS\377UWSL\0\0\0\0\40J\207+\40J\207"
+  "\377\0\0\0\0\40J\207.\40J\207c\0\0\0\0UWS\377\351\351\350\377\331\332"
+  "\331\377\253\254\252\377\354\354\354\377\356\356\356\377\276\277\275"
+  "\377UWS\377UWS\247\0\0\0\0\0\0\0\0\40J\207\377\0\0\0\0\40J\207\31\40"
+  "J\207z\0\0\0\0UWS\377\246\250\244\377\212\214\210\377\341\341\340\377"
+  "\307\310\306\377\257\261\255\377\267\270\266\377UWS\377UWS\340\0\0\0"
+  "\0\0\0\0\0\40J\207\377\0\0\0\0\0\0\0\0\40J\207\225\0\0\0\0UWS\377\223"
+  "\225\221\377y{w\377\263\264\261\377\225\227\223\377\246\250\244\377\246"
+  "\250\244\377UWS\377UWS\247\0\0\0\0\0\0\0\0\40J\207\377\0\0\0\0\40J\207"
+  "\31\40J\207z\0\0\0\0UWS\377\262\264\260\377\256\260\255\377UWS\377\312"
+  "\313\311\377\225\227\223\377\225\227\223\377UWS\377UWSL\0\0\0\0\40J\207"
+  "+\40J\207\377\0\0\0\0\40J\207.\40J\207c\0\0\0\0UWS\377UWS\377UWS\377"
+  "\210\212\205LUWS\377\302\303\301\377\264\265\263\377UWS\377\0\0\0\0\0"
+  "\0\0\0\40J\207\377\40J\207+\0\0\0\0\40J\207c\40J\207.\0\0\0\0\0\0\0\0"
+  "\0\0\0\0\0\0\0\0\0\0\0\0\210\212\205LUWS\377\335\335\334\377UWS\377\0"
+  "\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\40J\207\31\40J\207z\40J\207\31\0\0\0\0"
+  "\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\210\212\205LUWS\377UWS\377\0"
+  "\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\40J\207\225\40J\207\31\0\0\0\0\0\0\0\0"
+  "\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\210\212\205LUWS\377"
+  "\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0"
+  "\0\0\0\0\0\0\0\0\0\3\0\0\0\2\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0"
+  "\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0"};
+
+

Modified: branches/avidemux_2.4_branch/avidemux/xpm/build/Makefile
===================================================================
--- branches/avidemux_2.4_branch/avidemux/xpm/build/Makefile	2007-07-09 18:45:36 UTC (rev 3354)
+++ branches/avidemux_2.4_branch/avidemux/xpm/build/Makefile	2007-07-10 18:34:21 UTC (rev 3355)
@@ -26,6 +26,7 @@
 ../film19.inc \
 ../film21.inc \
 ../film23.inc \
+../audio-volume-medium.inc \
 ../preview-button.inc
 
 ../%.inc : %.png	

Added: branches/avidemux_2.4_branch/avidemux/xpm/build/audio-volume-medium.png
===================================================================
(Binary files differ)


Property changes on: branches/avidemux_2.4_branch/avidemux/xpm/build/audio-volume-medium.png
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream



From mean at mail.berlios.de  Wed Jul 11 20:31:20 2007
From: mean at mail.berlios.de (mean at BerliOS)
Date: Wed, 11 Jul 2007 20:31:20 +0200
Subject: [Avidemux-svn-commit] r3356 - in
	branches/avidemux_2.4_branch/avidemux: .
	ADM_userInterfaces/ADM_GTK ADM_userInterfaces/ADM_GTK/ADM_ocr
Message-ID: <200707111831.l6BIVKwp007893@sheep.berlios.de>

Author: mean
Date: 2007-07-11 20:31:20 +0200 (Wed, 11 Jul 2007)
New Revision: 3356

Added:
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_ocr/Makefile.am
Removed:
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/adm_ocr.cpp
Modified:
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/Makefile.am
   branches/avidemux_2.4_branch/avidemux/Makefile.am
Log:
[Automake] cleanup ocr + add glyph editor

Added: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_ocr/Makefile.am
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_ocr/Makefile.am	2007-07-10 18:34:21 UTC (rev 3355)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_ocr/Makefile.am	2007-07-11 18:31:20 UTC (rev 3356)
@@ -0,0 +1,16 @@
+
+noinst_LIBRARIES = libADM_ocr.a 
+
+INCLUDES = $(all_includes) $(GTK_CFLAGS) $(XML_CFLAGS)  $(FREETYPE_CFLAGS) \
+		-I../../../ADM_libraries/ADM_utilities \
+		-I../../ADM_commonUI -I../../.. -I../../../ADM_libraries/ADM_lavutil \
+		-I../../../ADM_inputs -I../../../ADM_outputs \
+		-I../../../ADM_ocr 
+
+libADM_ocr_a_METASOURCES = AUTO
+
+libADM_ocr_a_SOURCES =  adm_editglyph.cpp  adm_ocr.cpp
+
+EXTRA_DIST =  
+
+

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/Makefile.am
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/Makefile.am	2007-07-10 18:34:21 UTC (rev 3355)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/Makefile.am	2007-07-11 18:31:20 UTC (rev 3356)
@@ -1,8 +1,8 @@
-SUBDIRS= ADM_dialog  ADM_gui2 ADM_toolkit_gtk ADM_filters ADM_dialogFactory
+SUBDIRS= ADM_dialog  ADM_gui2 ADM_toolkit_gtk ADM_filters ADM_dialogFactory ADM_ocr
 
 noinst_LIBRARIES = libADM_GTK.a 
 libADM_GTK_a_METASOURCES = AUTO
-libADM_GTK_a_SOURCES = adm_ocr.cpp
+libADM_GTK_a_SOURCES = 
 
 INCLUDES = $(all_includes) $(GTK_CFLAGS) $(XML_CFLAGS)  $(FREETYPE_CFLAGS) -DADM_SUBVERSION=@ADM_SUBVERSION@ \
 		-I./../../ADM_libraries/ADM_utilities \

Deleted: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/adm_ocr.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/adm_ocr.cpp	2007-07-10 18:34:21 UTC (rev 3355)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/adm_ocr.cpp	2007-07-11 18:31:20 UTC (rev 3356)
@@ -1,807 +0,0 @@
-/***************************************************************************
-                         
-        Very simple OCR engine
-
-        We do it in 3 passes
-        
-                Ask the vobsub decoder for a bitmap
-                Try to split the bitmap in lines
-                For each lines try to split in glyph (i.e. horizontal line)
-                Detour the glyph
-                If the detoured glyph has a width much less inferiror to its width
-                it probably means we have a italic or kerning.
-                In that case use the detouring to isolate the glyphs
-
-
-         A bit of warning. 
-                        The UI code is ugly.
-                        Bottom is the last actual line so to get height you have to to last-first +1 !
-
-    begin                : Jan 2005
-    copyright            : (C) 2002 by mean
-    email                : fixounet at free.fr
- ***************************************************************************/
-
-/***************************************************************************
- *                                                                         *
- *   This program is free software; you can redistribute it and/or modify  *
- *   it under the terms of the GNU General Public License as published by  *
- *   the Free Software Foundation; either version 2 of the License, or     *
- *   (at your option) any later version.                                   *
- *                                                                         *
- ***************************************************************************/
-#include "config.h"
-#include <stdio.h>
-#include <stdlib.h>
-#include <string.h>
-#include "gtk/gtk.h"
-#include <ADM_assert.h>
-
-
-#include "fourcc.h"
-#include "avio.hxx"
-#include "config.h"
-#include "avi_vars.h"
-
-//#include "unistd.h"
-
-#include "ADM_toolkit/toolkit.hxx"
-#include "../ADM_GTK/ADM_toolkit_gtk/toolkit_gtk.h"
-#include "../ADM_GTK/ADM_toolkit_gtk/toolkit_gtk_include.h"
-#include "ADM_editor/ADM_edit.hxx"
-#include "ADM_video/ADM_genvideo.hxx"
-#include "ADM_filter/video_filters.h"
-
-#include "ADM_toolkit/toolkit.hxx"
-#include "ADM_editor/ADM_edit.hxx"
-#include "ADM_video/ADM_genvideo.hxx"
-#include "ADM_filter/video_filters.h"
-
-
-#include "ADM_toolkit/filesel.h"
-
-#include "ADM_colorspace/colorspace.h"
-
-#include "ADM_video/ADM_vobsubinfo.h"
-
-#include "ADM_video/ADM_vidVobSub.h"
-#include "ADM_leftturn.h"
-#include "DIA_enter.h"
-/******************************/
-#define GTK_PURGE {while (gtk_events_pending())                gtk_main_iteration(); }    
-#define TESTSUB "/home/fx/usbstick/subs/vts_01_0.idx"
-#define CONNECT(x,y,z) 	gtk_signal_connect(GTK_OBJECT(WID(x)), #y,GTK_SIGNAL_FUNC(z),   NULL);
-#define SUB_THRESH minThreshold
-
-typedef enum 
-{
-        ReplyOk=1,
-        ReplyClose=0,
-        ReplyCalibrate=2,
-        ReplySkip=3,
-        ReplySkipAll=4
-}ReplyType;
-
-static uint8_t mergeBitmap(uint8_t *bitin, uint8_t *bitout, uint8_t *maskin,uint32_t w, uint32_t h);
-static ReplyType ocrBitmap(uint8_t *data,uint32_t w,uint32_t h);
-static ReplyType handleGlyph(uint32_t start, uint32_t end,uint32_t w,uint32_t h,uint32_t base);
-static uint8_t lineEmpty(uint8_t *base, uint32_t stride, uint32_t width, uint32_t line);
-static uint8_t columnEmpty(uint8_t *base, uint32_t stride, uint32_t height);
-static ReplyType glyphToText(admGlyph *glyph);
-static uint8_t saveGlyph(void);
-static uint8_t loadGlyph(char *name);
-static void displaySmall( admGlyph *glyph );
-static int cb_accept(GtkObject * object, gpointer user_data);
-static ReplyType setup(void);
-static  vobSubParam subparam={NULL,0,0};
-static uint32_t minAlpha=7;
-static uint32_t minThreshold=0x80;
-
-
-/*++++++++++++++++++++++++++++++++++++++++*/
-extern  GtkWidget	*DIA_ocr(void);
-extern  uint8_t DIA_vobsub(vobSubParam *param);
-static gboolean gui_draw( void );
-static gboolean gui_draw_small( void );
-static char decodedString[1024];
-/*-------------------------*/
-static GtkWidget *dialog;
-static GtkWidget *mainDisplay;
-static GtkWidget *smallDisplay;
-static vobSubBitmap *bitmap;
-
-static uint8_t *workArea;
-static admGlyph head(250,4);
-static uint32_t lang_index=0;
-
-
-static uint32_t redraw_x,redraw_y;
-
-static uint32_t nbGlyphs;
-
-
-typedef enum
-{
-    actionLoadVob=10,
-    actionSaveSub,
-    actionGo,
-    actionLoadGlyph,
-    actionSaveGlyph,
-    actionSkip,
-    actionSkipAll,
-    actionAccept,
-    actionIgnore,
-    actionCalibrate
-}ocrAction;
-/* +++++++++++++++++++++++++++++++++++++++++++++++++++++++
-        Main
-   +++++++++++++++++++++++++++++++++++++++++++++++++++++++ */
-uint8_t ADM_ocr_engine( void)
-{
-// 
-    uint32_t nbSub=0;
-    FILE *out=NULL;
-    head.next=NULL;
-    ADMVideoVobSub *vobsub=NULL;
-    uint32_t startTime,endTime;
-    uint32_t w,h,oldw=0,oldh=0;
-    uint32_t oldbitmapw=0;
-    uint32_t oldbitmaph=0;
-    uint32_t first,last;
-    uint32_t seqNum;
-    char     text[1024];
-    lang_index=0;
-    nbGlyphs=0;
-    ReplyType reply;
-    
-// Create UI && prepare callback
-    
-    dialog=DIA_ocr();
-    gtk_register_dialog(dialog);
-#define ASSOCIATE(x,y)   gtk_dialog_add_action_widget (GTK_DIALOG (dialog), WID(x),y)
-    ASSOCIATE(buttonStart,actionGo);
-    ASSOCIATE(buttonOk,   actionAccept);
-    ASSOCIATE(buttonSkip,     actionSkip);
-    ASSOCIATE(buttonSkipAll,     actionSkipAll);
-    ASSOCIATE(buttonIgnore,   actionIgnore);
-    ASSOCIATE(buttonCalibrate,   actionCalibrate);
-    
-    ASSOCIATE(buttonGlyphLoad,   actionLoadGlyph);
-    ASSOCIATE(buttonGlyphSave,   actionSaveGlyph);
-    
-    ASSOCIATE(buttonVobsub,   actionLoadVob);
-    ASSOCIATE(buttonSrt,   actionSaveSub);
-   
-    gtk_widget_show(dialog);
-//  disable
-    
-    mainDisplay=WID(drawingareaBitmap);
-    smallDisplay=WID(drawingareaSmall);
-    
-    CONNECT(drawingareaBitmap,expose_event,gui_draw);
-    CONNECT(drawingareaSmall,expose_event,gui_draw_small);
-
-    CONNECT(entry,activate,cb_accept);
-_again:    
-    reply=setup();
-    if(reply==ReplyClose) goto endIt;
-    
-    printf("Go go go\n");
-    
-    // Everything ready go go go 
-         
-    redraw_x=redraw_y=0;
-    GTK_PURGE;
-//  Time to go
-    // Inactivate frame1=glyph    frame2=in/out  buttonStart
-    gtk_widget_set_sensitive(WID(buttonStart),0);
-    gtk_widget_set_sensitive(WID(frameGlyph),0);
-    gtk_widget_set_sensitive(WID(frameLoad),0);
-    gtk_widget_set_sensitive(WID(frameBitmap),1);
-
-    gtk_widget_set_sensitive(WID(buttonStart),0);
-   
-  
-   char *fileout;
-   fileout=(char *)gtk_label_get_text(GTK_LABEL(WID(labelSrt)));
-   if(!fileout)
-    {
-      GUI_Error_HIG(_("Incorrect output file"), NULL);
-        goto _again;
-    }
-    out=fopen(fileout,"wb");
-    if(!out)
-    {
-      GUI_Error_HIG(_("Output file error"), _("Could not open \"%s\" for writing."), fileout);
-        goto _again;
-    }
-     
-    vobsub=new ADMVideoVobSub(subparam.subname,subparam.index);
-    nbSub=vobsub->getNbImage();
-   
-    if(!nbSub)
-    {
-      GUI_Error_HIG(_("Problem loading sub"), NULL);
-        delete vobsub;
-        vobsub=NULL;
-        goto _again;
-     }
-    seqNum=1;   // Sub number in srt file
-    oldw=oldh=0;
-
-    //******************    
-    // Load all bitmaps
-    //******************
-    for(uint32_t i=0;i<nbSub;i++)
-    {
-            first=last=0;
-            bitmap=vobsub->getBitmap(i,&startTime, &endTime,&first,&last);
-            ADM_assert(last>=first);
-            
-            // something ?
-            if(!bitmap) continue;
-            if(first==last) continue;
-
-            // If the bitmap size changed or does not exist yet...
-            if(!workArea || oldbitmapw!=bitmap->_width || oldbitmaph!=bitmap->_height)
-            {
-              if(workArea) 
-              {
-                delete [] workArea;
-                workArea=NULL; 
-              }
-              // Workarea is actually bigger than what we use
-              workArea=new uint8_t[bitmap->_width*(bitmap->_height)];
-              memset(workArea,0,bitmap->_width*(bitmap->_height));
-            }
-            oldbitmaph=bitmap->_height;
-            oldbitmapw=bitmap->_width;
-           // 
-           w=bitmap->_width;
-           h=last-first+1;
-           redraw_x=w;
-           redraw_y=h;
-           //**
-           
-           // Build
-againPlease:
-           mergeBitmap(bitmap->_bitmap+first*w, workArea, bitmap->_alphaMask+first*w,  w,   h);
-           if(oldw!=w || oldh !=h)
-           {                
-                GTK_PURGE;  // Force redaw
-           }
-           // Merge
-             GTK_PURGE;
-             gui_draw();
-             GTK_PURGE; 
-             // OCR
-              reply=ocrBitmap(workArea,w,h);
-              if(reply==ReplyClose) goto endIt;
-              if(reply==ReplyCalibrate)
-                {
-                        //
-                        //printf("TADA!!!!\n");
-                        int val;
-#if 0
-                         val=minAlpha;
-                        if(DIA_GetIntegerValue(&val, 3, 7, "Minimum alpha value", "Enter new minimum alpha"))
-                        {
-                                minAlpha=val;
-
-                        }
-#endif
-                        val=minThreshold;
-                        if(DIA_GetIntegerValue(&val, 0x30, 0x80, "Minimum pixel value", "Enter new minimum pixel"))
-                        {
-                                minThreshold=val;
-
-                        }
-                        goto againPlease;
-                }
-             
-             //
-             gtk_label_set_text(GTK_LABEL(WID(labelText)),decodedString);
-             fprintf(out,"%d\n",seqNum++);
-             uint16_t hh,mm,ss,ms;
-             ms2time(startTime, &hh, &mm, &ss, &ms);
-             fprintf(out,"%02d:%02d:%02d,%03d --> ",hh,mm,ss,ms);
-             ms2time(endTime, &hh, &mm, &ss, &ms);
-             fprintf(out,"%02d:%02d:%02d,%03d\n",hh,mm,ss,ms);
-             fprintf(out,"%s\n\n",decodedString);
-             //             
-             oldw=w;
-             oldh=h;
-             // Update infos
-             sprintf(text,"%03d/%03d",i+1,nbSub);
-             gtk_label_set_text(GTK_LABEL(WID(labelNbLines)),text);
-             sprintf(text,"%03d",nbGlyphs);
-             gtk_label_set_text(GTK_LABEL(WID(labelNbGlyphs)),text);
-    }
-
-endIt:
-    // Final round
-    gtk_widget_set_sensitive(WID(frameGlyph),1);
-    gtk_widget_set_sensitive(WID(frameLoad),0);
-    gtk_widget_set_sensitive(WID(buttonStart),0);  
-    gtk_widget_set_sensitive(WID(frameBitmap),0);
-   // gtk_widget_set_sensitive(WID(Current_Glyph),0); 
-    
-    if(nbGlyphs && actionSaveGlyph==gtk_dialog_run(GTK_DIALOG(dialog)))
-        saveGlyph();
-    if(vobsub)
-        delete vobsub;
-    vobsub=NULL;
-    if(out) 
-        fclose(out);
-    out=NULL;
-    gtk_unregister_dialog(dialog);
-    gtk_widget_destroy(dialog);
-    if(head.next)
-        destroyGlyphTree(&head);
-    head.next=NULL;
-    return 1;
-
-}
-
-//*****************************************************************************************
-//  Separate the bitmap into glyph and handle each glyph on itw own
-//
-//*****************************************************************************************
-
-ReplyType ocrBitmap(uint8_t *data,uint32_t w,uint32_t h)
-{
-uint8_t found;
-uint32_t colstart=0,colend=0,oldcol;
-uint32_t line=0,nbLine=1;
-uint32_t base=0,bottom,top;    
-ReplyType reply;
-    // Search First non nul colum
-    decodedString[0]=0;
-    // Search how much lines there is in the file
-    //
-    top=bottom=0;
-    while(top<h)
-    {
-        // Search non empty line as top
-        while(top<h && lineEmpty(workArea,w,w,top)) top++;
-        // Nothing found
-        if(top>=h-1) break;
-
-        // 
-       
-
-        bottom=top+1;
-        // Search empty line if any, bottom is the 1st line full of zero
-        while(bottom<h && (!lineEmpty(workArea,w,w,bottom) || bottom-top<7))
-        {
-            bottom++;
-        }
-        if(line) strcat(decodedString,"\n"); 
-        //printf("\n Top:%lu bottom:%lu\n",top,bottom);
-       
-        // Scan a full line
-        colstart=0;
-        oldcol=0;
-       
-        // Split a line into glyphs
-        while(colstart<w)
-        {
-            GTK_PURGE;
-            oldcol=colstart;
-            while( columnEmpty(workArea+colstart+top*w, w, bottom-top) && colstart<w) colstart++;
-            if(colstart>=w) break;
-            // if too far apart, it means probably a blank space
-            if(colstart-oldcol>6)
-            {
-                strcat(decodedString," ");
-            }
-       
-            // We have found a non null column
-            // Seek the end now
-            colend=colstart+1;
-            while( !columnEmpty(workArea+colend+top*w, w, bottom-top) && colend<w) colend++;
-         
-         
-            // printf("Found glyph: %lu %lu\n",colstart,colend);  
-            reply=handleGlyph(colstart,colend,w,bottom,top);
-            switch(reply)
-                {
-                        case ReplySkip:break;
-                        case ReplyOk:break;
-                        case ReplyClose:
-                        case ReplyCalibrate: return reply;break;
-            
-                        case ReplySkipAll: return ReplyOk;break;
-                        default: ADM_assert(0);
-                }
-            
-            
-            colstart=colend;
-      }
-      line++;      
-      top=bottom;
-      
-    }
-   
-    return ReplyOk;
-}
-//*****************************************************************************************
-/*
-    We now have a good candidate for the glyph.
-    We will do the following processing :
-        - Clip the glyph to have it in its bounding box
-        - extract its container. If the container is smaller than the glyph, it means
-                that we have in fact several glyphs that overlaps slightly. In
-                that case we use another method to extract the glyph.
-                We split it using leftturn method and do it again.
-*/
-ReplyType handleGlyph(uint32_t start, uint32_t end,uint32_t w,uint32_t h,uint32_t base)
-{
-uint8_t found=0;
-static int inc=1;
-ReplyType reply;
-          
-    
-    // Ok now we have the cropped glyp
-    
-    admGlyph *glyph,*cand;
-    uint32_t minx,maxx,miny,maxy;
-    int     *raw=NULL;
-            glyph=new admGlyph(end-start,h-base);
-            glyph->create(workArea+start+base*w,w);
-            glyph=clippedGlyph(glyph);
-            if(!glyph->width) // Empty glyph
-            {
-                delete glyph;
-                return ReplyOk;
-            }
-            // now we have our full glyph, try harder to split it
-_nextglyph:
-            raw=new int[glyph->height];            
-            if(adm_estimate_glyphSize(glyph,&minx, &maxx,&miny,&maxy,raw))
-            {
-            //printf("Glyph width :%lu min:%lu max:%lu estimate width:%lu\n",glyph->width,minx,maxx,maxx-minx+1);
-            if((maxx-minx+2)<glyph->width && (maxx-minx>2) && (maxy-miny>2))
-            {
-                // Suspicously too small
-                // We have to split the glyph
-                // recursively to extract each glyph
-                uint32_t width=maxx-minx+1;
-                uint32_t defStride=width+1;
-                
-                if(defStride>glyph->width) defStride=glyph->width;
-                
-                admGlyph *lefty=new admGlyph(defStride,glyph->height);
-                for(int32_t i=miny;i<=maxy;i++)
-                {
-                    if(raw[i]!=-1) memcpy(&(lefty->data[0+i*defStride]),&(glyph->data[minx+i*glyph->width]),raw[i]+1-minx);
-                    else
-                            memcpy(&(lefty->data[0+i*defStride]),&(glyph->data[minx+i*glyph->width]),defStride);
-                }
-                lefty=clippedGlyph(lefty);
-              
-                {
-                    // Remove that from the original
-                    for(uint32_t i=0;i<glyph->height;i++)
-                    {
-                        //printf("%d:%d(%d)\n",i,raw[i],glyph->width);
-                        if(raw[i]!=-1) memset(&(glyph->data[i*glyph->width]),0,raw[i]+1);
-                        else           memset(&(glyph->data[i*glyph->width]),0,defStride); 
-                    }
-                    // Clip
-                    glyph=clippedGlyph(glyph);
-                
-                    if(lefty->width)
-                    {
-                        reply=glyphToText(lefty);
-                        if(reply!=ReplyOk)
-                        {
-                            printf("Glyph2text failed(1)\n");
-                            return reply;
-                        }
-                    }
-                    else
-                        delete lefty;
-                    if(glyph->width)
-                    {
-                        if(raw) delete [] raw;
-                        goto _nextglyph;                    
-                    } 
-                 }           
-            }
-            }//If
-            if(raw) delete [] raw;
-            if(glyph->width)
-            {
-                reply=glyphToText(glyph);
-                if(reply!=ReplyOk)                 
-                {
-                    printf("Glyph2text failed(2)\n");
-                    return reply;
-                }
-            }
-            else 
-            {
-                delete glyph;
-            }
-            
-    return ReplyOk;
-
-}
-/**
-        Search throught the existing glyphs , if not present create it
-        and append the text to decodedString
-*/
-ReplyType glyphToText(admGlyph *glyph)
-{
- admGlyph *cand;
-            //printf("2t: %d x %d\n",glyph->width,glyph->height);
-            if(glyph->width<2 && glyph->height<2)
-            {
-                delete glyph;
-                return ReplyOk;
-            }
-            cand=searchGlyph(&head,glyph);
-            if(!cand) // New glyph
-            {
-                char *string;
-                // Draw it
-                displaySmall(glyph); 
-                gtk_label_set_text(GTK_LABEL(WID(labelText)),decodedString);
-                gtk_editable_delete_text(GTK_EDITABLE(WID(entry)), 0,-1);
-                
-                //gtk_widget_set_sensitive(WID(buttonAccept),1);
-                //gtk_widget_set_sensitive(WID(buttonSkip),1);
-                //gtk_widget_set_sensitive(WID(entryEntry),1);
-                
-                gtk_widget_grab_focus (WID(entry));
-                gtk_widget_grab_default (WID(buttonOk));
-                
-                //printf("i\n");
-                switch(gtk_dialog_run(GTK_DIALOG(dialog)))
-                {
-                case actionIgnore:
-                        glyph->code=NULL;
-                        insertInGlyphTree(&head,glyph);
-                        nbGlyphs++;
-                        break;
-                case actionCalibrate: return ReplyCalibrate;
-                case actionAccept:
-                    string =gtk_editable_get_chars(GTK_EDITABLE (WID(entry)), 0, -1);
-                    if(string&& strlen(string))
-                    {
-                        glyph->code=ADM_strdup(string);
-                        insertInGlyphTree(&head,glyph);
-                        //printf("New glyph:%s\n",glyph->code);
-                        strcat(decodedString,glyph->code);
-                        nbGlyphs++;
-                       
-                    }
-                    else delete glyph;
-                    break;
-                case actionSkip: //SKIP
-                    return ReplySkip;
-                    break;
-                case actionSkipAll:
-                    return ReplySkipAll;
-                    break;
-                case GTK_RESPONSE_CLOSE:
-                  if(GUI_Question(_("Sure ?"))) return ReplyClose;
-                    break; // Abort
-                    
-                }
-                gtk_editable_delete_text(GTK_EDITABLE(WID(entry)), 0,-1);
-                //gtk_widget_set_sensitive(WID(buttonAccept),0);
-                //gtk_widget_set_sensitive(WID(buttonSkip),0);
-                //gtk_widget_set_sensitive(WID(entryEntry),0);
-            }
-            else
-            {
-                //printf("Glyph known :%s \n",cand->code);
-                if(cand->code)
-                    strcat(decodedString,cand->code);
-                delete glyph;
-            }
-           return ReplyOk;  
-
-}
-/**************************************************************************************
-    returns 1 if the line is empty
-    0 if not
-*/
-
-//*****************************************************************************************
-uint8_t mergeBitmap(uint8_t *bitin, uint8_t *bitout, uint8_t *maskin,uint32_t w, uint32_t h)
-{
-// Merge with alpha channel
-           uint8_t *in,*mask,*out;
-           uint32_t alp,nw;
-           in=bitin;
-           out=bitout;
-           mask=maskin;
-           for(uint32_t y=0;y<h;y++)
-           {
-            for(uint32_t x=0;x<w;x++)
-            {
-                   
-                    nw=in[x];
-                    alp=mask[x];
-
-                    if(alp>minAlpha&& nw >SUB_THRESH)  nw=0xff;
-                         else       nw=0;
-                        
-                    out[x]=nw;
-            }
-            out+=w;
-            in+=w;
-            mask+=w;
-           }    
-    return 1;
-}
-//*****************************************************************************************
-gboolean gui_draw( void )
-{
-static int lastx=0,lasty=0;
-    if(lastx!=redraw_x || lasty!=redraw_y)
-        gtk_widget_set_usize(mainDisplay, redraw_x, redraw_y);
-    lastx=redraw_x;
-    lasty=redraw_y;
-    
-    gdk_draw_gray_image(mainDisplay->window, mainDisplay->style->fg_gc[GTK_STATE_NORMAL],
-                        0,                          // X
-                        0,                          // y
-                        redraw_x,                          //width
-                        redraw_y,                          //h*2, // heigth
-                        GDK_RGB_DITHER_NONE,
-                        workArea, // buffer
-                        redraw_x );
-    return true;
-}
-//*****************************************************************************************
- static int sx=0,sy=0,sw=0,sh=0;
- uint8_t *sdata=NULL;
-void displaySmall( admGlyph *glyph)
-{
-    if(sw!=glyph->width || sh!=glyph->height)
-    {
-        if(sdata) delete [] sdata;
-        sdata=NULL;
-        sw=glyph->width;
-        sh=glyph->height;
-        sdata=new uint8_t[(sw*2+2)*(sh*2+2)];
-        gtk_widget_set_usize(smallDisplay, sw*2+2, sh*2+2);
-    }
-    uint32_t stride=sw*2+2;
-    uint8_t *in=glyph->data;
-    uint8_t *out=sdata;
-    
-    memset(out,0,stride);
-    out+=stride;
-    for(uint32_t y=0;y<sh;y++)
-    {
-      *(out++)=0;
-      for(uint32_t x=0;x<sw;x++)
-      {
-        out[1]=out[0]=out[stride]=out[stride+1]=*in;
-        out+=2; 
-        in++;
-        
-      } 
-      *(out++)=0;
-      out+=stride;      
-    }
-    memset(out,0,stride);
-    //memcpy(sdata,glyph->data,sw*sh);
-    gui_draw_small();
-} 
-
-gboolean gui_draw_small(void)
-{ 
- if(sw && sh && sdata)
-    gdk_draw_gray_image(smallDisplay->window, smallDisplay->style->fg_gc[GTK_STATE_NORMAL],
-                        0,                          // X
-                        0,                          // y
-                        sw*2+2,                          //width
-                        sh*2+2,                          //h*2, // heigth
-                        GDK_RGB_DITHER_NONE,
-                        sdata, // buffer
-                        sw*2+2 );
-    return true;
-}
-
-/******************************************************************************************
- Setup (input/output files etc..)
-*****************************************************************************************/
-ReplyType setup(void)
-{
-int sel;
-char text[1024];
-    while(1)
-    {
-    //gtk_widget_set_sensitive(WID(buttonAccept),0);
-    //gtk_widget_set_sensitive(WID(buttonSkip),0);
-    //gtk_widget_set_sensitive(WID(entryEntry),0);
-    GTK_PURGE;   
-    // Main loop : Only accept glyph load/save
-    // Sub & srt select & start ocr
-    gtk_widget_set_sensitive(WID(frameGlyph),1);
-    gtk_widget_set_sensitive(WID(frameLoad),1);
-    gtk_widget_set_sensitive(WID(buttonStart),1);
-    
-    gtk_widget_set_sensitive(WID(frameBitmap),0);
-    //gtk_widget_set_sensitive(WID(Current_Glyph),0); 
-     switch(sel=gtk_dialog_run(GTK_DIALOG(dialog)))
-     {
-        case actionLoadVob:
-                {
-                   
-                        subparam.index=lang_index;
-                        subparam.subname=NULL;
-                        if(DIA_vobsub(&subparam))
-                        {
-                            lang_index=subparam.index;
-                            gtk_label_set_text(GTK_LABEL(WID(labelVobsub)),subparam.subname);
-                        }
-                        
-                    
-                }
-                break;
-        case actionSaveSub:
-                {
-                    char *srt=NULL;
-                    GUI_FileSelWrite(_("Select SRT to save"), &srt);
-                    if(srt)
-                    {
-                        gtk_label_set_text(GTK_LABEL(WID(labelSrt)),srt);
-                    }
-                }
-                break;
-        
-        case actionLoadGlyph:
-            {
-                 char *gly=NULL;
-                    
-                    GUI_FileSelRead(_("Select Glyoh to save"), &gly);
-                    if(gly)
-                    {
-                            loadGlyph(gly);
-                            sprintf(text,"%03d",nbGlyphs);
-                            gtk_label_set_text(GTK_LABEL(WID(labelNbGlyphs)),text);
-                    }
-            }
-                break;
-        
-        case actionSaveGlyph:
-            
-                    if(!nbGlyphs)
-                    {
-                      GUI_Error_HIG(_("No glyphs to save"), NULL);
-                        break;
-                    }                  
-                    saveGlyph();                                      
-                    break;
-        
-        case GTK_RESPONSE_CLOSE: 
-            printf("Close req\n");
-            return ReplyClose;
-        default:
-            printf("Other input:%d\n",sel);
-     }
-    // Everything selected, check
-    if(sel==actionGo) return ReplyOk;
-    }
-}
-/**
-*/
-int cb_accept(GtkObject * object, gpointer user_data)
-{
-        //printf("Hopla\n");
-        gtk_signal_emit_by_name(GTK_OBJECT(WID(buttonOk)),"clicked",(gpointer)1);
-        return 0;
-
-}
-
-/**
- */
-#include "ADM_ocrLoadSave.h"
-//;

Modified: branches/avidemux_2.4_branch/avidemux/Makefile.am
===================================================================
--- branches/avidemux_2.4_branch/avidemux/Makefile.am	2007-07-10 18:34:21 UTC (rev 3355)
+++ branches/avidemux_2.4_branch/avidemux/Makefile.am	2007-07-11 18:31:20 UTC (rev 3356)
@@ -23,7 +23,7 @@
 
 user_interface_gtk = \
 		./ADM_userInterfaces/ADM_GTK/ADM_gui2/libADM_gui2.a	\
-		./ADM_userInterfaces/ADM_GTK/libADM_GTK.a \
+		./ADM_userInterfaces/ADM_GTK/ADM_ocr/libADM_ocr.a	\
 		./ADM_userInterfaces/ADM_GTK/ADM_dialog/libADM_dialog.a	\
 		./ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_srt.o	\
 		./ADM_userInterfaces/ADM_GTK/ADM_dialogFactory/libADM_dialogFactory.a	\



From mean at mail.berlios.de  Wed Jul 11 20:41:00 2007
From: mean at mail.berlios.de (mean at BerliOS)
Date: Wed, 11 Jul 2007 20:41:00 +0200
Subject: [Avidemux-svn-commit] r3357 - in
	branches/avidemux_2.4_branch/avidemux: . ADM_libraries
	ADM_libraries/ADM_lavcodec ADM_libraries/ADM_libpostproc
	ADM_libraries/ADM_utilities
Message-ID: <200707111841.l6BIf0j1008467@sheep.berlios.de>

Author: mean
Date: 2007-07-11 20:40:59 +0200 (Wed, 11 Jul 2007)
New Revision: 3357

Added:
   branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_libpostproc/Makefile.am
Removed:
   branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec/libpostproc/
Modified:
   branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec/Makefile.am
   branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_utilities/ADM_pp.h
   branches/avidemux_2.4_branch/avidemux/ADM_libraries/Makefile.am
   branches/avidemux_2.4_branch/avidemux/Makefile.am
Log:
[automake] cleanup postproc

Modified: branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec/Makefile.am
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec/Makefile.am	2007-07-11 18:31:20 UTC (rev 3356)
+++ branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec/Makefile.am	2007-07-11 18:40:59 UTC (rev 3357)
@@ -1,6 +1,6 @@
 libavcodec_a_METASOURCES = AUTO
 noinst_LIBRARIES = libavcodec.a
-SUBDIRS=libpostproc i386 ppc 
+SUBDIRS=i386 ppc 
 LAVUTIL=../ADM_lavutil 
 if BUILD_MMX_COMPATIBLE
 EXTEND_MMX = i386/cputest.c     \

Copied: branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_libpostproc/Makefile.am (from rev 3352, branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec/libpostproc/Makefile.am)

Modified: branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_utilities/ADM_pp.h
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_utilities/ADM_pp.h	2007-07-11 18:31:20 UTC (rev 3356)
+++ branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_utilities/ADM_pp.h	2007-07-11 18:40:59 UTC (rev 3357)
@@ -11,7 +11,7 @@
 //
 #ifndef ADMPP
 #define ADMPP
-#include "../ADM_lavcodec/libpostproc/postprocess.h"
+#include "../ADM_libpostproc/postprocess.h"
 typedef struct ADM_PP
 {
 	pp_context_t			*ppContext;

Modified: branches/avidemux_2.4_branch/avidemux/ADM_libraries/Makefile.am
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_libraries/Makefile.am	2007-07-11 18:31:20 UTC (rev 3356)
+++ branches/avidemux_2.4_branch/avidemux/ADM_libraries/Makefile.am	2007-07-11 18:40:59 UTC (rev 3357)
@@ -1,3 +1,3 @@
 SUBDIRS= ADM_lavcodec   ADM_lavutil  ADM_libass  ADM_libMpeg2Dec  ADM_libswscale  ADM_lvemux  ADM_utilities   \
 	 ADM_lavformat  ADM_liba52   ADM_libMad  ADM_libmpeg2enc  ADM_libtwolame  ADM_mplex   ADM_xvidratectl \
-	 ADM_smjs	ADM_libwrapper
+	 ADM_smjs	ADM_libwrapper ADM_libpostproc

Modified: branches/avidemux_2.4_branch/avidemux/Makefile.am
===================================================================
--- branches/avidemux_2.4_branch/avidemux/Makefile.am	2007-07-11 18:31:20 UTC (rev 3356)
+++ branches/avidemux_2.4_branch/avidemux/Makefile.am	2007-07-11 18:40:59 UTC (rev 3357)
@@ -124,7 +124,7 @@
 ./ADM_inputs/ADM_avsproxy/libADM_avsproxy.a		\
 ./ADM_inputs/ADM_matroska/libADM_matroska.a		\
 ./ADM_infoExtractor/libADM_infoExtractor.a 		\
-./ADM_libraries/ADM_lavcodec/libpostproc/libpostproc.a	\
+./ADM_libraries/ADM_libpostproc/libpostproc.a	\
 ./ADM_libraries/ADM_mplex/libADM_mplex.a		\
 ./ADM_libraries/ADM_lvemux/libADM_lvemux.a		\
 ./ADM_libraries/ADM_lavformat/libADM_lavformat.a	\



From gruntster at mail.berlios.de  Thu Jul 12 20:07:30 2007
From: gruntster at mail.berlios.de (gruntster at mail.berlios.de)
Date: Thu, 12 Jul 2007 20:07:30 +0200
Subject: [Avidemux-svn-commit] r3358 - branches/avidemux_2.4_branch/po
Message-ID: <200707121807.l6CI7UbW000832@sheep.berlios.de>

Author: gruntster
Date: 2007-07-12 20:07:18 +0200 (Thu, 12 Jul 2007)
New Revision: 3358

Added:
   branches/avidemux_2.4_branch/po/it.po
Modified:
   branches/avidemux_2.4_branch/po/LINGUAS
   branches/avidemux_2.4_branch/po/Makefile.am
Log:
Italian translation by zoppo

Modified: branches/avidemux_2.4_branch/po/LINGUAS
===================================================================
--- branches/avidemux_2.4_branch/po/LINGUAS	2007-07-11 18:40:59 UTC (rev 3357)
+++ branches/avidemux_2.4_branch/po/LINGUAS	2007-07-12 18:07:18 UTC (rev 3358)
@@ -8,3 +8,4 @@
 ca
 sr at Latn
 tr
+it

Modified: branches/avidemux_2.4_branch/po/Makefile.am
===================================================================
--- branches/avidemux_2.4_branch/po/Makefile.am	2007-07-11 18:40:59 UTC (rev 3357)
+++ branches/avidemux_2.4_branch/po/Makefile.am	2007-07-12 18:07:18 UTC (rev 3358)
@@ -1,3 +1,3 @@
-POFILES= es.po fr.po klingon.po ru.po de.po pt_BR.po ja.po sr.po sr at Latn.po ca.po tr.po
-EXTRA_DIST = es.po fr.po klingon.po ru.po de.po pt_BR.po ja.po sr.po sr at Latn.po ca.po tr.po
+POFILES= es.po fr.po klingon.po ru.po de.po pt_BR.po ja.po sr.po sr at Latn.po ca.po tr.po it.po
+EXTRA_DIST = es.po fr.po klingon.po ru.po de.po pt_BR.po ja.po sr.po sr at Latn.po ca.po tr.po it.po
 

Added: branches/avidemux_2.4_branch/po/it.po
===================================================================
--- branches/avidemux_2.4_branch/po/it.po	2007-07-11 18:40:59 UTC (rev 3357)
+++ branches/avidemux_2.4_branch/po/it.po	2007-07-12 18:07:18 UTC (rev 3358)
@@ -0,0 +1,7087 @@
+# translation of klingon.po to 
+# This file is distributed under the same license as the PACKAGE package.
+# Copyright (C) YEAR THE PACKAGE'S COPYRIGHT HOLDER, 2003
+#
+msgid ""
+msgstr ""
+"Project-Id-Version: avidemux\n"
+"Report-Msgid-Bugs-To: \n"
+"POT-Creation-Date: 2006-10-04 22:09+0300\n"
+"PO-Revision-Date: 2007-07-11 19:31+0100\n"
+"Last-Translator: \n"
+"Language-Team: it\n"
+"MIME-Version: 1.0\n"
+"Content-Type: text/plain; charset=UTF-8\n"
+"Content-Transfer-Encoding: 8bit\n"
+"X-Generator: KBabel 1.0.1\n"
+
+#: avidemux/ADM_audio/audiotimeline.cpp:83
+#: avidemux/ADM_audio/audiotimeline.cpp:94
+msgid "Building VBR map"
+msgstr "Creazione mappa VBR"
+
+#: avidemux/ADM_audiocodec/ADM_codecwma.cpp:75
+#: avidemux/ADM_audiocodec/ADM_codecwma.cpp:183
+msgid "Internal error"
+msgstr "Errore interno"
+
+#: avidemux/ADM_audiocodec/ADM_codecwma.cpp:75
+msgid "Cannot open WMA2 codec."
+msgstr "Impossibile aprire i codec WMA2"
+
+#: avidemux/ADM_audiocodec/ADM_codecwma.cpp:183
+msgid "Cannot open AMR codec."
+msgstr "Impossibile aprire i codec AMR"
+
+#: avidemux/ADM_audiodevice/ADM_deviceoss.cpp:118
+msgid "Could not open OSS audio device"
+msgstr "Impossibile aprire il dispositivo audio OSS"
+
+#: avidemux/ADM_audiodevice/ADM_deviceoss.cpp:118
+msgid "Check the permissions for /dev/dsp."
+msgstr "Verifica i permessi per /dev/dsp."
+
+#: avidemux/ADM_audiofilter/audioencoder_lame.cpp:215
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_audioFilter.cpp:104
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:229
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_properties.cpp:110
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_props.cpp:101
+#, c-format
+msgid "Stereo"
+msgstr "Stereo"
+
+#: avidemux/ADM_audiofilter/audioencoder_lame.cpp:216
+msgid "Joint stereo"
+msgstr "Joint stereo"
+
+#: avidemux/ADM_audiofilter/audioencoder_lame.cpp:217
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_audioFilter.cpp:103
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_properties.cpp:107
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_props.cpp:98
+#, c-format
+msgid "Mono"
+msgstr "Mono"
+
+#: avidemux/ADM_audiofilter/audioencoder_lame.cpp:219
+msgid "C_hannel mode:"
+msgstr "Modalit? _canali:"
+
+#: avidemux/ADM_audiofilter/audioencoder_lame.cpp:222
+msgid "CBR"
+msgstr "CBR"
+
+#: avidemux/ADM_audiofilter/audioencoder_lame.cpp:223
+msgid "ABR"
+msgstr "ABR"
+
+#: avidemux/ADM_audiofilter/audioencoder_lame.cpp:225
+msgid "Extreme"
+msgstr "Estremo"
+
+#: avidemux/ADM_audiofilter/audioencoder_lame.cpp:228
+msgid "Bit_rate mode:"
+msgstr "Modalit? bit_rate:"
+
+#: avidemux/ADM_audiofilter/audioencoder_lame.cpp:241
+#: avidemux/ADM_audiofilter/audioencoder_vorbis.cpp:285
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_audioconfig.cpp:59
+msgid "_Bitrate:"
+msgstr "_Bitrate:"
+
+#: avidemux/ADM_audiofilter/audioencoder_lame.cpp:246
+#: avidemux/ADM_audiofilter/audioencoder_vorbis.cpp:287
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_mjpeg.cpp:40
+#: avidemux/ADM_videoFilter/ADM_vidDecDec.cpp:204
+msgid "_Quality:"
+msgstr "_Qualit?:"
+
+#: avidemux/ADM_audiofilter/audioencoder_vorbis.cpp:268
+msgid "VBR"
+msgstr "VBR"
+
+#: avidemux/ADM_audiofilter/audioencoder_vorbis.cpp:269
+msgid "Quality based"
+msgstr "Basato sulla qualit?"
+
+#: avidemux/ADM_audiofilter/audioencoder_vorbis.cpp:271
+#: avidemux/ADM_videoFilter/ADM_vidDecDec.cpp:203
+#: avidemux/ADM_videoFilter/ADM_vidDGbob.cpp:91
+#: avidemux/ADM_videoFilter/ADM_vidMcDeint.cpp:113
+#: avidemux/ADM_videoFilter/ADM_vidYadif.cpp:181
+msgid "_Mode:"
+msgstr "_Modalit?:"
+
+#: avidemux/ADM_audiofilter/audiofilter_buildchain.cpp:322
+#: avidemux/gui_autodrive.cpp:82
+#: avidemux/gui_autodrive.cpp:116
+msgid "Codec Error"
+msgstr "Errore codec"
+
+#: avidemux/ADM_audiofilter/audiofilter_buildchain.cpp:322
+msgid ""
+"The number of channels is greater than what the selected audio codec can do.\n"
+"Either change codec or use the mixer filter to have less channels."
+msgstr ""
+"Il numero di canali ? maggiore di quello supportato dal codec audio selezionato. \n"
+" Cambia il codec o usa il filtro mixer per ridurre i canali."
+
+#: avidemux/ADM_codecs/ADM_ffmp43.cpp:52
+msgid "Internal error finding codec"
+msgstr "Errore interno nel cercare i codec"
+
+#: avidemux/ADM_codecs/ADM_ffmpeg.cpp:51
+msgid "Internal error opening codec"
+msgstr "Errore interno nell'aprire i codec"
+
+#: avidemux/ADM_codecs/ADM_ffmpeg.cpp:53
+msgid "Internal error with context for  codec"
+msgstr "Errore interno con il contesto per codec"
+
+#: avidemux/ADM_codecs/ADM_ffmpeg.cpp:53
+msgid ""
+".\n"
+" Did you use too low / too high target for 2 pass ?"
+msgstr ""
+".\n"
+" Hai usato un obiettivo troppo basso/alto per 2 passate?"
+
+#: avidemux/ADM_editor/ADM_edFrameType.cpp:58
+msgid "No video loaded"
+msgstr "Nessun video caricato"
+
+#: avidemux/ADM_editor/ADM_edFrameType.cpp:63
+msgid "Not indexable"
+msgstr "Non indicizzabile"
+
+#: avidemux/ADM_editor/ADM_edFrameType.cpp:63
+msgid "DivX 5 + packed?"
+msgstr "DivX 5 + compresso?"
+
+#: avidemux/ADM_editor/ADM_edFrameType.cpp:93
+msgid "Rebuilding Frames"
+msgstr "Ricostruzione fotogrammi"
+
+#: avidemux/ADM_editor/ADM_edFrameType.cpp:129
+msgid "Aborted"
+msgstr "Annullato"
+
+#: avidemux/ADM_editor/ADM_edit.cpp:404
+msgid "File type identified but no loader support detected..."
+msgstr "Formato file identificato ma non supportato..."
+
+#: avidemux/ADM_editor/ADM_edit.cpp:405
+msgid "May be related to an old index file."
+msgstr "Potrebbe essere relativo a un vecchio file di indice."
+
+#: avidemux/ADM_editor/ADM_edit.cpp:412
+#, c-format
+msgid "Attempt to open %s failed!"
+msgstr "Tentativo di aprire %s fallito!"
+
+#: avidemux/ADM_editor/ADM_edit.cpp:436
+msgid ""
+"You cannot mix different video dimensions yet. Using the partial video filter later, will not work around this problem. The workaround is:\n"
+"1.) \"resize\" / \"add border\" / \"crop\" each stream to the same resolution\n"
+"2.) concatinate them together"
+msgstr ""
+"Non puoi ancora mescolare dimensioni video differenti. Usare il filtro video parziale, non risolver? il problema. La soluzione ?:\n"
+"1.) \"ridimensiona\" / \"aggiungi bordi\" / \"ritaglia\" ogni flusso alla stessa risoluzione\n"
+"2.) concatenali insieme"
+
+#: avidemux/ADM_editor/ADM_edit.cpp:548
+msgid "Build Time Map"
+msgstr "Crea time map"
+
+#: avidemux/ADM_editor/ADM_edit.cpp:548
+msgid "Build VBR time map?"
+msgstr "Creare la time map VBR?"
+
+#: avidemux/ADM_editor/ADM_edit.cpp:582
+msgid "Use that mode"
+msgstr "Utilizza questa modalit?"
+
+#: avidemux/ADM_editor/ADM_edit.cpp:582
+msgid "H264 detected"
+msgstr "H264 rilevato"
+
+#: avidemux/ADM_editor/ADM_edit.cpp:582
+msgid ""
+"If the file is using bframe as reference, it can lead to crash or stutteting.\n"
+"Avidemux can use another mode which is safed but <b>YOU WILL LOOSE FRAME ACCURACY</b>.\n"
+"Do you want to use that mode ?"
+msgstr ""
+"Se il file sta utilizzando un fotogramma-B come riferimento, pu? causare un crash.\n"
+"Avidemux pu? utilizzare un'altra modalit? pi? sicura ma <b>PERDERAI LA PRECISIONE DEI FOTOGRAMMI</b>.\n"
+"Vuoi usare quella modalit??"
+
+#: avidemux/ADM_editor/ADM_edit.cpp:709
+msgid "Packed Bitstream detected"
+msgstr "Flusso di bit compresso rilevato"
+
+#: avidemux/ADM_editor/ADM_edit.cpp:710
+msgid "Do you want me to unpack it ?"
+msgstr "Vuoi decomprimerlo?"
+
+#: avidemux/ADM_editor/ADM_edit.cpp:730
+msgid "Could not unpack the video"
+msgstr "Impossibile decomprimere il video"
+
+#: avidemux/ADM_editor/ADM_edit.cpp:730
+msgid "Using backup decoder - not frame accurate."
+msgstr "Utilizzo decodificatore backup - non preciso sui fotogrammi."
+
+#: avidemux/ADM_editor/ADM_edit.cpp:735
+msgid "Weird"
+msgstr "Strano"
+
+#: avidemux/ADM_editor/ADM_edit.cpp:735
+msgid "The unpacking succeedeed but the index is still not up to date."
+msgstr "La decompressione ? riuscita ma l'indice non ? ancora aggiornato."
+
+#: avidemux/ADM_editor/ADM_edit.cpp:741
+msgid "Troubles ahead"
+msgstr "Problemi avanti"
+
+#: avidemux/ADM_editor/ADM_edit.cpp:741
+msgid "This a VOP packed AVI."
+msgstr "Questo ? un AVI compresso con VOP."
+
+#: avidemux/ADM_editor/ADM_edit.cpp:752
+msgid "Index is not up to date"
+msgstr "L'indice non ? aggiornato"
+
+#: avidemux/ADM_editor/ADM_edit.cpp:752
+msgid "You should use Tool->Rebuild frame. Do it now ?"
+msgstr "Dovresti usare Strumenti -> Ricostruisci fotogrammi. Vuoi farlo ora?"
+
+#: avidemux/ADM_editor/ADM_edit.cpp:1507
+msgid ""
+"This looks like mpeg\n"
+" Do you want to index it?"
+msgstr ""
+"Questo sembra un file mpeg\n"
+"Vuoi indicizzarlo?"
+
+#: avidemux/ADM_editor/ADM_edit.cpp:1559
+msgid "Indexing failed"
+msgstr "Indicizzazione fallita"
+
+#: avidemux/ADM_editor/ADM_edLoadSave.cpp:75
+msgid "Unsupported"
+msgstr "Non supportato"
+
+#: avidemux/ADM_editor/ADM_edLoadSave.cpp:301
+msgid "Old format project file"
+msgstr "File di progetto vecchio formato"
+
+#: avidemux/ADM_editor/ADM_edLoadSave.cpp:301
+msgid "No more supported."
+msgstr "Non pi? supportato."
+
+#: avidemux/ADM_editor/ADM_outputfmt.h:38
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp:511
+msgid "AVI"
+msgstr "AVI"
+
+#: avidemux/ADM_editor/ADM_outputfmt.h:39
+msgid "AVI, dual audio"
+msgstr "AVI, doppio audio"
+
+#: avidemux/ADM_editor/ADM_outputfmt.h:40
+msgid "AVI, pack VOP"
+msgstr "AVI, compr. VOP"
+
+#: avidemux/ADM_editor/ADM_outputfmt.h:41
+msgid "AVI, unpack VOP"
+msgstr "AVI, decompr. VOP"
+
+#: avidemux/ADM_editor/ADM_outputfmt.h:42
+msgid "MPEG-PS (A+V)"
+msgstr "MPEG-PS (A+V)"
+
+#: avidemux/ADM_editor/ADM_outputfmt.h:43
+msgid "MPEG-TS (A+V)"
+msgstr "MPEG-TS (A+V)"
+
+#: avidemux/ADM_editor/ADM_outputfmt.h:44
+msgid "MPEG video"
+msgstr "MPEG video"
+
+#: avidemux/ADM_editor/ADM_outputfmt.h:45
+msgid "MP4"
+msgstr "MP4"
+
+#: avidemux/ADM_editor/ADM_outputfmt.h:46
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp:515
+msgid "OGM"
+msgstr "OGM"
+
+#: avidemux/ADM_editor/ADM_outputfmt.h:47
+msgid "PSP"
+msgstr "PSP"
+
+#: avidemux/ADM_encoder/adm_encConfig.cpp:192
+msgid "Wrong output format"
+msgstr "Formato in uscita errato"
+
+#: avidemux/ADM_encoder/adm_encConfig.cpp:192
+msgid "Select MPEG as the output."
+msgstr "Seleziona MPEG come output."
+
+#: avidemux/ADM_encoder/adm_encConfig.cpp:197
+msgid "Wrong video codec"
+msgstr "Codec video errato"
+
+#: avidemux/ADM_encoder/adm_encConfig.cpp:198
+msgid "Select DVD as the video codec for MPEG TS output."
+msgstr "Seleziona DVD come codec video per l'output MPEG TS."
+
+#: avidemux/ADM_encoder/adm_encConfig.cpp:715
+msgid "Only QCIF and subQCIF are allowed for H.263"
+msgstr "Solo QCIF e subQCIF sono consentiti per H.263"
+
+#: avidemux/ADM_encoder/adm_encConfig.cpp:907
+msgid "Fatal error"
+msgstr "Errore fatale"
+
+#: avidemux/ADM_encoder/adm_encffmpeg.cpp:261
+msgid "Incompatible settings"
+msgstr "Impostazioni incompatibili"
+
+#: avidemux/ADM_encoder/adm_encffmpeg.cpp:261
+msgid "At the moment, the DV codec only accepts 720*576 at 25"
+msgstr "Al momento, il codec DV accetta solo 720*576 at 25"
+
+#: avidemux/ADM_filter/filter_saveload.cpp:157
+msgid "Problem reading XML filters"
+msgstr "Problema di lettura dei filtri XML"
+
+#: avidemux/ADM_filter/filter_saveload.cpp:165
+msgid "No filter found"
+msgstr "Nessun filtro trovato"
+
+#: avidemux/ADM_filter/filter_saveload.cpp:201
+msgid "Could not find a filter"
+msgstr "Impossibile trovare un filtro"
+
+#: avidemux/ADM_filter/filter_saveload.cpp:209
+msgid "No tag found"
+msgstr "Nessuna etichetta trovata"
+
+#: avidemux/ADM_filter/filter_saveload.cpp:289
+msgid "Node not found"
+msgstr "Nodo non trovato"
+
+#: avidemux/ADM_inputs/ADM_h263/ADM_h263.cpp:258
+msgid "Size is not (s)QCIF"
+msgstr "La dimensione non ? (s)QCIF"
+
+#: avidemux/ADM_inputs/ADM_mp4/ADM_mp4Analyzer.cpp:570
+msgid "Problem reading SVQ3 headers"
+msgstr "Problema di lettura delle intestazioni SVQ3"
+
+#: avidemux/ADM_inputs/ADM_mp4/ADM_mp4Indexer.cpp:346
+msgid "No stts table"
+msgstr "Nessun table stts"
+
+#: avidemux/ADM_inputs/ADM_mpegdemuxer/dmx_indexer.cpp:149
+msgid "There is several mpeg file, append them ?"
+msgstr "Ci sono diversi file mpeg, vuoi unirli?"
+
+#: avidemux/ADM_inputs/ADM_mpegdemuxer/dmx_indexer.cpp:250
+msgid "Can't determine aspect ratio"
+msgstr "Impossibile determinare le proporzioni"
+
+#: avidemux/ADM_inputs/ADM_mpegdemuxer/dmx_video.cpp:355
+msgid "Out of memory"
+msgstr "Memoria piena"
+
+#: avidemux/ADM_inputs/ADM_mpegdemuxer/dmx_video.cpp:370
+msgid "Opening MPEG"
+msgstr "Apertura MPEG"
+
+#: avidemux/ADM_inputs/ADM_mpegdemuxer/dmx_video.cpp:539
+msgid "MPEG renumbering error"
+msgstr "Errore rinumerazione MPEG"
+
+#: avidemux/ADM_inputs/ADM_nuv/ADM_nuv.cpp:542
+#: avidemux/ADM_inputs/ADM_nuv/ADM_nuv.cpp:571
+msgid "Opening Nuppel video"
+msgstr "Apertura Nuppel video"
+
+#: avidemux/ADM_inputs/ADM_nuv/ADM_nuv.cpp:547
+msgid "Sure you want to abort ?"
+msgstr "Sei sicuro di voler annullare?"
+
+#: avidemux/ADM_inputs/ADM_nuv/ADM_nuv.cpp:758
+msgid "Size mismatch"
+msgstr "Dimensione incoerente"
+
+#: avidemux/ADM_inputs/ADM_nuv/ADM_nuv.cpp:758
+msgid "Expect a crash."
+msgstr "Crash previsto."
+
+#: avidemux/ADM_inputs/ADM_nuv/ADM_nuv.cpp:1050
+msgid "Do you want to save an index ?"
+msgstr "Vuoi salvare un index?"
+
+#: avidemux/ADM_inputs/ADM_ogm/ADM_ogm.cpp:346
+msgid "Take second track ?"
+msgstr "Aggiungere seconda traccia?"
+
+#: avidemux/ADM_inputs/ADM_ogm/ADM_ogm.cpp:426
+msgid "Scanning OGM"
+msgstr "Analisi OGM"
+
+#: avidemux/ADM_inputs/ADM_openDML/ADM_openDML.cpp:281
+#: avidemux/ADM_inputs/ADM_openDML/ADM_openDML.cpp:366
+#: avidemux/ADM_inputs/ADM_openDML/ADM_openDML.cpp:501
+msgid "Malformed header"
+msgstr "Intestazione errata"
+
+#: avidemux/ADM_inputs/ADM_openDML/ADM_openDMLDepack.cpp:93
+msgid "Unpacking bitstream"
+msgstr "Decompressione flusso di bit"
+
+#: avidemux/ADM_inputs/ADM_openDML/ADM_opendml_reindex.cpp:68
+msgid "Indexing"
+msgstr "Indicizzazione"
+
+#: avidemux/ADM_libraries/ADM_lavformat/ADM_lavformat.cpp:308
+msgid "Incompatible frame rate"
+msgstr "Frame rate incompatibile"
+
+#: avidemux/ADM_libraries/ADM_lvemux/ADM_muxer.cpp:85
+#: avidemux/ADM_outputs/oplug_mpeg/op_mpegpass.cpp:153
+#: avidemux/ADM_outputs/oplug_mpegFF/oplug_vcdff.cpp:196
+msgid "Incompatible audio"
+msgstr "Audio incompatibile"
+
+#: avidemux/ADM_libraries/ADM_lvemux/ADM_muxer.cpp:85
+msgid "For DVD, audio must be MP2 or AC3."
+msgstr "Per DVD, l'audio deve essere MP2 o AC3."
+
+#: avidemux/ADM_libraries/ADM_lvemux/ADM_muxer.cpp:92
+msgid "lvemux init failed"
+msgstr "Avvio Ivemux fallito"
+
+#: avidemux/ADM_libraries/ADM_utilities/ADM_imageUtils.cpp:403
+msgid "Memory error"
+msgstr "Errore memoria"
+
+#: avidemux/ADM_libraries/ADM_utilities/ADM_imageUtils.cpp:410
+msgid "Error converting to BMP"
+msgstr "Errore conversione in BMP"
+
+#: avidemux/ADM_libraries/ADM_utilities/ADM_imageUtils.cpp:417
+#: avidemux/gtk_gui.cpp:1920
+msgid "Something bad happened"
+msgstr "C'? stato qualche errore"
+
+#: avidemux/ADM_libraries/ADM_utilities/ADM_imageUtils.cpp:472
+msgid "Cannot encode the frame"
+msgstr "Impossibile codificare il fotogramma"
+
+#: avidemux/ADM_libraries/ADM_utilities/ADM_imageUtils.cpp:481
+#: avidemux/ADM_ocr/ADM_ocrLoadSave.h:71
+#: avidemux/ADM_outputs/oplug_mpegFF/oplug_vcdff.cpp:380
+#: avidemux/ADM_outputs/oplug_ogm/op_ogsave.cpp:112
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_ocr/adm_editglyph.cpp:364
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_toolkit_gtk/TLK_filesel.cpp:335
+#: avidemux/gtk_gui.cpp:893
+#: avidemux/gtk_gui.cpp:1525
+msgid "File error"
+msgstr "Errore file"
+
+#: avidemux/ADM_libraries/ADM_utilities/ADM_imageUtils.cpp:481
+#: avidemux/ADM_outputs/oplug_mpegFF/oplug_vcdff.cpp:380
+#: avidemux/ADM_outputs/oplug_ogm/op_ogsave.cpp:112
+#: avidemux/gtk_gui.cpp:1525
+#, c-format
+msgid "Cannot open \"%s\" for writing."
+msgstr "Impossibile aprire \"%s\" per la scrittura."
+
+#: avidemux/ADM_libraries/ADM_utilities/avidemutils.cpp:324
+msgid "NTSC 4:3"
+msgstr "NTSC 4:3"
+
+#: avidemux/ADM_libraries/ADM_utilities/avidemutils.cpp:325
+#: avidemux/ADM_libraries/ADM_utilities/avidemutils.cpp:326
+msgid "NTSC 16:9"
+msgstr "NTSC 16:9"
+
+#: avidemux/ADM_libraries/ADM_utilities/avidemutils.cpp:327
+msgid "PAL 4:3"
+msgstr "PAL 4:3"
+
+#: avidemux/ADM_libraries/ADM_utilities/avidemutils.cpp:328
+msgid "PAL 16:9"
+msgstr "PAL 16:9"
+
+#: avidemux/ADM_libraries/ADM_utilities/avidemutils.cpp:329
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_resize.cpp:376
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_resize.cpp:398
+msgid "1:1"
+msgstr "1:1"
+
+#: avidemux/ADM_libraries/ADM_utilities/avidemutils.cpp:331
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp:598
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp:795
+msgid "Unknown"
+msgstr "Sconosciuto"
+
+#: avidemux/ADM_ocr/ADM_ocrLoadSave.h:22
+msgid "Select Glyphfile to save to"
+msgstr "Seleziona il file Glyph in cui salvare"
+
+#: avidemux/ADM_ocr/ADM_ocrLoadSave.h:30
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_ocr/adm_editglyph.cpp:282
+msgid "Could not write the file"
+msgstr "Impossibile scrivere il file"
+
+#: avidemux/ADM_ocr/ADM_ocrLoadSave.h:62
+msgid "Erase current glyphs ?"
+msgstr "Eliminare i glyph correnti?"
+
+#: avidemux/ADM_ocr/ADM_ocrLoadSave.h:71
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_ocr/adm_editglyph.cpp:364
+#, c-format
+msgid "Could not read \"%s\"."
+msgstr "Impossibile leggere \"%s\"."
+
+#: avidemux/ADM_ocr/ADM_vob2vobsub.cpp:254
+msgid "Ifo error"
+msgstr "Errore file ifo"
+
+#: avidemux/ADM_ocr/ADM_vob2vobsub.cpp:254
+msgid "Error reading ifo file, aborting."
+msgstr "Errore di lettura del file ifo, annullamento in corso."
+
+#: avidemux/ADM_ocr/ADM_vob2vobsub.cpp:262
+msgid "Cannot write .idx"
+msgstr "Impossibile scrivere il file .idx"
+
+#: avidemux/ADM_ocr/ADM_vob2vobsub.cpp:275
+msgid "Cannot write .sub"
+msgstr "Impossibile scrivere il file .sub"
+
+#: avidemux/ADM_ocr/ADM_vob2vobsub.cpp:287
+msgid "Problem opening the mpeg files"
+msgstr "Problema apertura file mpeg"
+
+#: avidemux/ADM_ocr/ADM_vob2vobsub.cpp:300
+msgid "Generating VobSub file"
+msgstr "Creazione file VobSub"
+
+#: avidemux/ADM_osSupport/ADM_crashdump.cpp:200
+#: avidemux/ADM_osSupport/ADM_crashdump.cpp:224
+msgid "Fatal Error"
+msgstr "Errore fatale"
+
+#: avidemux/ADM_osSupport/ADM_crashdump.cpp:200
+#: avidemux/ADM_osSupport/ADM_crashdump.cpp:224
+msgid ""
+"A fatal error has occurred.\n"
+"\n"
+"Click OK to generate debug information. This may take a few minutes to complete."
+msgstr ""
+"? avvenuto un errore fatale.\n"
+"\n"
+"Clicca OK per visualizzare le informazioni di debug. Potrebbe richiedere alcuni minuti."
+
+#: avidemux/ADM_osSupport/ADM_crashdump.cpp:423
+msgid "Load it"
+msgstr "Carica"
+
+#: avidemux/ADM_osSupport/ADM_crashdump.cpp:423
+msgid "Crash file"
+msgstr "Crash file"
+
+#: avidemux/ADM_osSupport/ADM_crashdump.cpp:424
+msgid ""
+"I have detected a crash file. \n"
+"Do you want to load it  ?\n"
+"(It will be deleted in all cases, you should save it if you want to keep it)"
+msgstr ""
+"Rilevato un crash file.\n"
+"Vuoi caricarlo?\n"
+"(Sar? eliminato in ogni caso se non lo salvi)"
+
+#: avidemux/ADM_osSupport/ADM_fileio.cpp:102
+#: avidemux/ADM_osSupport/ADM_fileio.cpp:126
+#: avidemux/ADM_osSupport/ADM_fileio.cpp:146
+#: avidemux/ADM_osSupport/ADM_fileio.cpp:153
+#: avidemux/ADM_osSupport/ADM_fileio.cpp:164
+#: avidemux/GUI_jobs.cpp:37
+msgid "Oops"
+msgstr "Oops"
+
+#: avidemux/ADM_osSupport/ADM_fileio.cpp:102
+#, c-format
+msgid "can't create custom directory (%s)."
+msgstr "impossibile creare la cartella preferiti (%s)."
+
+#: avidemux/ADM_osSupport/ADM_fileio.cpp:126
+#, c-format
+msgid "can't create job directory (%s)."
+msgstr "impossibile creare la cartella attivit? (%s)."
+
+#: avidemux/ADM_osSupport/ADM_fileio.cpp:146
+msgid "can't determine $USERPROFILE."
+msgstr "impossibile determinare $USERPROFILE."
+
+#: avidemux/ADM_osSupport/ADM_fileio.cpp:153
+msgid "can't determine $HOME."
+msgstr "impossibile determinare $HOME."
+
+#: avidemux/ADM_osSupport/ADM_fileio.cpp:164
+msgid "Cannot create the .avidemux directory"
+msgstr "Impossibile creare la cartella .avidemux"
+
+#: avidemux/ADM_osSupport/ADM_misc.cpp:215
+#, c-format
+msgid "%lu minutes"
+msgstr "%lu minuti"
+
+#: avidemux/ADM_osSupport/ADM_misc.cpp:219
+#, c-format
+msgid "%lu minute"
+msgstr "%lu minuto"
+
+#: avidemux/ADM_osSupport/ADM_misc.cpp:227
+#, c-format
+msgid "%lu second"
+msgstr "%lu secondo"
+
+#: avidemux/ADM_osSupport/ADM_misc.cpp:231
+#, c-format
+msgid "%lu seconds"
+msgstr "%lu secondi"
+
+#: avidemux/ADM_outputs/oplug_avi/op_avisave.cpp:74
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:181
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp:845
+msgid "Normal"
+msgstr "Normale"
+
+#: avidemux/ADM_outputs/oplug_avi/op_avisave.cpp:75
+msgid "Mux every N video frames"
+msgstr "Esegui mux per tutti i fotogrammi N"
+
+#: avidemux/ADM_outputs/oplug_avi/op_avisave.cpp:76
+msgid "Mux by packet size"
+msgstr "Esegui mux per dimensione pacchetto"
+
+#: avidemux/ADM_outputs/oplug_avi/op_avisave.cpp:79
+msgid "Muxing _type:"
+msgstr "_Tipo di muxing:"
+
+#: avidemux/ADM_outputs/oplug_avi/op_avisave.cpp:80
+msgid "_Split every MB:"
+msgstr "_Dividi ogni MB:"
+
+#: avidemux/ADM_outputs/oplug_avi/op_avisave.cpp:82
+msgid "Mux _every x video frames:"
+msgstr "Esegui mux per _ogni fotogramma x:"
+
+#: avidemux/ADM_outputs/oplug_avi/op_avisave.cpp:83
+msgid "Mux in _blocks of x bytes:"
+msgstr "Esegui mux in _blocchi di x byte:"
+
+#: avidemux/ADM_outputs/oplug_avi/op_avisave.cpp:90
+msgid "AVI Muxer Options"
+msgstr "Opzioni Muxer AVI"
+
+#: avidemux/ADM_outputs/oplug_avi/op_avisave.cpp:188
+msgid "Error initalizing audio filters"
+msgstr "Errore di inizializzazione filtri audio"
+
+#: avidemux/ADM_outputs/oplug_avi/op_avisave.cpp:197
+msgid "Error initalizing video filters"
+msgstr "Errore di inizializzazione filtri video"
+
+#: avidemux/ADM_outputs/oplug_avi/op_avisave.cpp:446
+#: avidemux/ADM_outputs/oplug_avi/op_avisavecopy.cpp:96
+#: avidemux/ADM_outputs/oplug_avi/op_avisavecopy_pack.cpp:121
+#: avidemux/ADM_outputs/oplug_avi/op_avisavecopy_unpack.cpp:98
+msgid "Cannot initiate save"
+msgstr "Impossibile iniziare il salvataggio"
+
+#: avidemux/ADM_outputs/oplug_avi/op_saveprocess.cpp:73
+msgid ""
+"Width is not a multiple of 8\n"
+" continue anyway ?"
+msgstr ""
+"La larghezza non ? un multiplo di 8\n"
+" continuare comunque?"
+
+#: avidemux/ADM_outputs/oplug_avi/op_saveprocess.cpp:93
+#: avidemux/ADM_outputs/oplug_mp4/oplug_mp4.cpp:170
+#: avidemux/ADM_outputs/oplug_ogm/op_ogsaveprocess.cpp:76
+msgid "Filter init failed"
+msgstr "Inizializzazione filtro fallita"
+
+#: avidemux/ADM_outputs/oplug_avi/op_saveprocess.cpp:127
+#: avidemux/ADM_outputs/oplug_mp4/oplug_mp4.cpp:395
+#: avidemux/ADM_outputs/oplug_ogm/op_ogsaveprocess.cpp:100
+msgid ""
+"\n"
+" Reuse the existing log-file ?"
+msgstr ""
+"\n"
+" Riutilizzare il file log esistente?"
+
+#: avidemux/ADM_outputs/oplug_avi/op_saveprocess.cpp:152
+#: avidemux/ADM_outputs/oplug_mp4/oplug_mp4.cpp:431
+msgid "Aborting"
+msgstr "Annullamento in corso"
+
+#: avidemux/ADM_outputs/oplug_mp4/oplug_mp4.cpp:152
+msgid "Cannot initialize the video stream"
+msgstr "Impossibile inizializzare il flusso video"
+
+#: avidemux/ADM_outputs/oplug_mp4/oplug_mp4.cpp:208
+#: avidemux/ADM_outputs/oplug_mp4/oplug_mp4.cpp:331
+#: avidemux/ADM_outputs/oplug_mp4/oplug_mp4.cpp:415
+#: avidemux/ADM_outputs/oplug_mpeg/op_mpegpass.cpp:352
+msgid "Error while encoding"
+msgstr "Errore durante la codifica"
+
+#: avidemux/ADM_outputs/oplug_mp4/oplug_mp4.cpp:220
+msgid "KeyFrame error"
+msgstr "Errore fotogramma chiave"
+
+#: avidemux/ADM_outputs/oplug_mp4/oplug_mp4.cpp:220
+msgid ""
+"The beginning frame is not a key frame.\n"
+"Please move the A marker."
+msgstr ""
+"Il fotogramma iniziale non ? un fotogramma chiave.\n"
+"Spostare il segnalibro A."
+
+#: avidemux/ADM_outputs/oplug_mp4/oplug_mp4.cpp:247
+msgid "Cannot initialize the audio stream"
+msgstr "Impossibile inizializzare il flusso audio"
+
+#: avidemux/ADM_outputs/oplug_mpeg/op_mpegpass.cpp:89
+msgid "This is not MPEG compatible"
+msgstr "Non ? compatibile con MPEG"
+
+#: avidemux/ADM_outputs/oplug_mpeg/op_mpegpass.cpp:89
+msgid "You can't use the Copy codec."
+msgstr "Non puoi usare il codec Copia."
+
+#: avidemux/ADM_outputs/oplug_mpeg/op_mpegpass.cpp:94
+#: avidemux/ADM_outputs/oplug_mpegFF/oplug_vcdff.cpp:143
+#: avidemux/ADM_outputs/oplug_mpegFF/oplug_vcdff.cpp:154
+msgid "There is no audio track"
+msgstr "Non ci sono tracce audio"
+
+#: avidemux/ADM_outputs/oplug_mpeg/op_mpegpass.cpp:101
+msgid "The first frame is not intra frame"
+msgstr "Il primo fotogramma non ? un fotogramma chiave"
+
+#: avidemux/ADM_outputs/oplug_mpeg/op_mpegpass.cpp:101
+msgid "Use the &lt;&lt; and the &gt;&gt; buttons to move using Intra frames."
+msgstr "Usa i pulsanti &lt;&lt; e &gt;&gt; per spostare usando fotogrammi chiave."
+
+#: avidemux/ADM_outputs/oplug_mpeg/op_mpegpass.cpp:113
+#: avidemux/ADM_outputs/oplug_mpegFF/oplug_vcdff.cpp:164
+msgid "Audio track is not suitable"
+msgstr "La traccia audio non ? adatta"
+
+#: avidemux/ADM_outputs/oplug_mpeg/op_mpegpass.cpp:153
+#: avidemux/ADM_outputs/oplug_mpegFF/oplug_vcdff.cpp:174
+msgid "For VCD, audio must be 44.1 kHz MP2."
+msgstr "Per VCD, l'audio deve essere 44.1 kHz MP2."
+
+#: avidemux/ADM_outputs/oplug_mpeg/op_mpegpass.cpp:182
+msgid "For DVD, audio must be 48 kHz MP2(stereo), AC3, DTS or LPCM (stereo)."
+msgstr "Per DVD, l'audio deve essere 48 kHz MP2 (stereo), AC3, DTS o LPCM (stereo)."
+
+#: avidemux/ADM_outputs/oplug_mpegFF/oplug_vcdff.cpp:196
+msgid "For DVD, audio must be 48 kHz MP2, AC3 or LPCM."
+msgstr "Per DVD, l'audio deve essere 48 kHz MP2, AC3 o LPCM."
+
+#: avidemux/ADM_outputs/oplug_mpegFF/oplug_vcdff.cpp:313
+msgid "Reuse log file ?"
+msgstr "Riutilizzare il file log?"
+
+#: avidemux/ADM_outputs/oplug_mpegFF/oplug_vcdff.cpp:328
+msgid "Error in pass 1"
+msgstr "Errore nella passata 1"
+
+#: avidemux/ADM_outputs/oplug_mpegFF/oplug_vcdff.cpp:478
+msgid "Error in pass 2"
+msgstr "Errore nella passata 2"
+
+#: avidemux/ADM_outputs/oplug_ogm/op_ogsave.cpp:126
+msgid "Could not initialize video"
+msgstr "Impossibile avviare il video"
+
+#: avidemux/ADM_outputs/oplug_ogm/op_ogsave.cpp:134
+msgid "Could not initialize audio"
+msgstr "Impossibile avviare l'audio"
+
+#: avidemux/ADM_script/ADM_JSFunctions.cpp:236
+msgid "Select a directory"
+msgstr "Seleziona una cartella"
+
+#: avidemux/ADM_script/ADM_JSFunctions.cpp:502
+msgid "Uinteger"
+msgstr "Uinteger"
+
+#: avidemux/ADM_script/ADM_JSFunctions.cpp:517
+msgid "Float"
+msgstr "Float"
+
+#: avidemux/ADM_script/ADM_JSFunctions.cpp:535
+msgid "Toggle"
+msgstr "Toggle"
+
+#: avidemux/ADM_script/ADM_JSFunctions.cpp:556
+msgid "No Strategy"
+msgstr "Nessuna strategia"
+
+#: avidemux/ADM_script/ADM_JSFunctions.cpp:557
+msgid "3:2 Pulldown"
+msgstr "3:2 Pulldown"
+
+#: avidemux/ADM_script/ADM_JSFunctions.cpp:558
+msgid "Pal/Secam"
+msgstr "Pal/Secam"
+
+#: avidemux/ADM_script/ADM_JSFunctions.cpp:559
+#: avidemux/ADM_videoFilter/ADM_vidDecTelecide.cpp:86
+msgid "NTSC converted from PAL"
+msgstr "NTSC convertito da PAL"
+
+#: avidemux/ADM_script/ADM_JSFunctions.cpp:561
+msgid "menu"
+msgstr "Menu"
+
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_animated.cpp:36
+msgid "_Background Image:"
+msgstr "Immagine di _sfonfo:"
+
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_animated.cpp:37
+msgid "_NTSC(default is Pal):"
+msgstr "_NTSC (predefinito ? Pal):"
+
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_animated.cpp:38
+msgid "Vignette _Width:"
+msgstr "_Larghezza vignetta:"
+
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_animated.cpp:39
+msgid "Vignette _Height:"
+msgstr "_Altezza vignetta:"
+
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_animated.cpp:42
+msgid "Vignette frame number"
+msgstr "Numero di fotogrammi vignetta"
+
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_animated.cpp:46
+msgid "Timecode:"
+msgstr "Timecode:"
+
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_audioFilter.cpp:62
+msgid "_Dynamic range compression"
+msgstr "Compressione campo dinamico"
+
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_audioFilter.cpp:64
+msgid "_Time shift (ms):"
+msgstr "_Ritardo (ms):"
+
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_audioFilter.cpp:64
+msgid "Time shift value (ms)"
+msgstr "Ritardo (ms)"
+
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_audioFilter.cpp:72
+msgid "R_esampling (Hz):"
+msgstr "Ricampionam_ento (Hz):"
+
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_audioFilter.cpp:72
+msgid "Resampling frequency (Hz)"
+msgstr "Frequenza di ricampionamento (Hz)"
+
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_audioFilter.cpp:80
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_audioFilter.cpp:89
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_lavcodec.cpp:51
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_coloryuv.cpp:373
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_coloryuv.cpp:381
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_coloryuv.cpp:389
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp:553
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp:568
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp:583
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_vobsub.cpp:219
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1124
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_xvid4.cpp:57
+#: avidemux/ADM_videoFilter/ADM_lavpp_deint.cpp:105
+#: avidemux/ADM_videoFilter/ADM_vidDecTelecide.cpp:101
+#: avidemux/ADM_videoFilter/ADM_vidRotate.cpp:264
+#: avidemux/gtk_gui.cpp:1998
+#: avidemux/gtk_gui.cpp:2097
+msgid "None"
+msgstr "Nessuno"
+
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_audioFilter.cpp:81
+msgid "Film to PAL"
+msgstr "Da film a PAL"
+
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_audioFilter.cpp:82
+msgid "PAL to Film"
+msgstr "Da PAL a film"
+
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_audioFilter.cpp:85
+msgid "_Frame rate change:"
+msgstr "Variazione _frame rate:"
+
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_audioFilter.cpp:90
+msgid "Automatic (max -3 dB)"
+msgstr "Automatico (massimo -3 dB)"
+
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_audioFilter.cpp:91
+msgid "Manual"
+msgstr "Manuale"
+
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_audioFilter.cpp:93
+msgid "_Gain mode:"
+msgstr "Modalit? _Gain:"
+
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_audioFilter.cpp:95
+msgid "G_ain value:"
+msgstr "Valore G_ain:"
+
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_audioFilter.cpp:97
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_coloryuv.cpp:200
+msgid "Gain"
+msgstr "Gain"
+
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_audioFilter.cpp:102
+msgid "No change"
+msgstr "Nessun cambiamento"
+
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_audioFilter.cpp:105
+msgid "Stereo+surround"
+msgstr "Stereo + surround"
+
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_audioFilter.cpp:106
+msgid "Stereo+center"
+msgstr "Stereo + centro"
+
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_audioFilter.cpp:107
+msgid "Stereo+center+surround"
+msgstr "Stereo + centro + surround"
+
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_audioFilter.cpp:108
+msgid "Stereo front+stereo rear"
+msgstr "Stereo frontale + stereo posteriore"
+
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_audioFilter.cpp:109
+msgid "5 channels"
+msgstr "5 canali"
+
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_audioFilter.cpp:110
+msgid "5.1"
+msgstr "5.1"
+
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_audioFilter.cpp:111
+msgid "Dolby Pro Logic"
+msgstr "Dolby Pro Logic"
+
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_audioFilter.cpp:112
+msgid "Dolby Pro Logic II"
+msgstr "Dolby Pro Logic II"
+
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_audioFilter.cpp:115
+msgid "_Mixer:"
+msgstr "_Mixer:"
+
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_audioFilter.cpp:119
+msgid "Audio Filters"
+msgstr "Filtri Audio"
+
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_bitrateHisto.cpp:59
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_bitrateHisto.cpp:128
+msgid "No data"
+msgstr "Nessun dato"
+
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_bitrateHisto.cpp:232
+msgid "Bitrate Histogram"
+msgstr "Istogramma bitrate"
+
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_builtin.cpp:128
+msgid "Video Codecs"
+msgstr "Codec video"
+
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_builtin.cpp:129
+msgid "Xvid"
+msgstr "Xvid"
+
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_builtin.cpp:130
+msgid "x264"
+msgstr "x264"
+
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_builtin.cpp:135
+msgid "Audio Codecs"
+msgstr "Codec audio"
+
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_builtin.cpp:136
+msgid "Aften"
+msgstr "Aften"
+
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_builtin.cpp:137
+msgid "amrnb"
+msgstr "amrnb"
+
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_builtin.cpp:138
+msgid "FAAC"
+msgstr "FAAC"
+
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_builtin.cpp:139
+msgid "FAAD2"
+msgstr "FAAD2"
+
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_builtin.cpp:140
+msgid "LAME"
+msgstr "LAME"
+
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_builtin.cpp:141
+msgid "liba52"
+msgstr "liba52"
+
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_builtin.cpp:142
+msgid "libdca"
+msgstr "libdca"
+
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_builtin.cpp:143
+msgid "MAD"
+msgstr "MAD"
+
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_builtin.cpp:144
+msgid "Vorbis"
+msgstr "Vorbis"
+
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_builtin.cpp:156
+msgid "aRts"
+msgstr "aRts"
+
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_builtin.cpp:157
+msgid "ESD"
+msgstr "ESD"
+
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_builtin.cpp:158
+msgid "Fontconfig"
+msgstr "Fontconfig"
+
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_builtin.cpp:159
+msgid "FreeType 2"
+msgstr "FreeType 2"
+
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_builtin.cpp:160
+msgid "gettext"
+msgstr "gettext"
+
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_builtin.cpp:161
+msgid "ALSA"
+msgstr "ALSA"
+
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_builtin.cpp:162
+msgid "OSS"
+msgstr "OSS"
+
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_builtin.cpp:163
+msgid "SDL"
+msgstr "SDL"
+
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_builtin.cpp:164
+msgid "XVideo"
+msgstr "XVideo"
+
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_builtin.cpp:166
+msgid "AltiVec"
+msgstr "AltiVec"
+
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_builtin.cpp:167
+msgid "PowerPC"
+msgstr "PowerPC"
+
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_builtin.cpp:168
+msgid "x86"
+msgstr "x86"
+
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_builtin.cpp:169
+msgid "x86-64"
+msgstr "x86-64"
+
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_builtin.cpp:176
+msgid "Codecs"
+msgstr "Codec"
+
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_builtin.cpp:177
+msgid "Libraries"
+msgstr "Librerie"
+
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_builtin.cpp:178
+msgid "CPU"
+msgstr "CPU"
+
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_builtin.cpp:182
+msgid "Built-in Support"
+msgstr "Supporto incorporato"
+
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_DVDff.cpp:52
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_SVCD.cpp:42
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_resize.cpp:380
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_resize.cpp:402
+msgid "4:3"
+msgstr "4:3"
+
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_DVDff.cpp:53
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_SVCD.cpp:43
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_resize.cpp:384
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_resize.cpp:406
+msgid "16:9"
+msgstr "16:9"
+
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_DVDff.cpp:55
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_SVCD.cpp:45
+msgid "Default"
+msgstr "Predefinito"
+
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_DVDff.cpp:56
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_SVCD.cpp:46
+msgid "TMPGEnc"
+msgstr "TMPGEnc"
+
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_DVDff.cpp:57
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_SVCD.cpp:47
+msgid "Anime"
+msgstr "Anime"
+
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_DVDff.cpp:58
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_SVCD.cpp:48
+msgid "KVCD"
+msgstr "KVCD"
+
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_DVDff.cpp:61
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_SVCD.cpp:51
+msgid "Progressive"
+msgstr "Progressivo"
+
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_DVDff.cpp:62
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_SVCD.cpp:52
+msgid "Interlaced TFF"
+msgstr "TFF interlacciato"
+
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_DVDff.cpp:63
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_SVCD.cpp:53
+msgid "Interlaced BFF"
+msgstr "BFF interlacciato"
+
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_DVDff.cpp:74
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_SVCD.cpp:60
+msgid "Ma_x. bitrate:"
+msgstr "Bitrate ma_ssimo:"
+
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_DVDff.cpp:75
+msgid "Mi_n. bitrate:"
+msgstr "Bitrate mi_nimo:"
+
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_DVDff.cpp:76
+msgid "_Use Xvid rate control"
+msgstr "_Usa controllo bitrate di Xvid"
+
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_DVDff.cpp:78
+msgid "_Buffer size:"
+msgstr "Dimensione _buffer:"
+
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_DVDff.cpp:80
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_SVCD.cpp:57
+msgid "Aspect _ratio:"
+msgstr "_Proporzioni:"
+
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_DVDff.cpp:81
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_SVCD.cpp:58
+msgid "_Matrices:"
+msgstr "_Matrici:"
+
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_DVDff.cpp:82
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_SVCD.cpp:59
+msgid "_GOP size:"
+msgstr "Dimensione _GOP:"
+
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_DVDff.cpp:88
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_SVCD.cpp:66
+msgid "_Interlacing:"
+msgstr "_Interlacciamento:"
+
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_gototime.cpp:27
+msgid "_Hours:"
+msgstr "_Ore:"
+
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_gototime.cpp:28
+msgid "_Minutes:"
+msgstr "_Minuti:"
+
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_gototime.cpp:29
+msgid "_Seconds:"
+msgstr "_Secondi:"
+
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_lavcodec.cpp:52
+msgid "Full"
+msgstr "Completo"
+
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_lavcodec.cpp:53
+msgid "Log"
+msgstr "Log"
+
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_lavcodec.cpp:54
+msgid "Phods"
+msgstr "Phods"
+
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_lavcodec.cpp:55
+msgid "EPZS"
+msgstr "EPZS"
+
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_lavcodec.cpp:56
+msgid "X1"
+msgstr "X1"
+
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_lavcodec.cpp:60
+msgid "H.263"
+msgstr "H.263"
+
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_lavcodec.cpp:61
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp:519
+msgid "MPEG"
+msgstr "MPEG"
+
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_lavcodec.cpp:65
+msgid "MB comparison"
+msgstr "Confronto MB"
+
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_lavcodec.cpp:66
+msgid "Fewest bits (vhq)"
+msgstr "Bit meno numerosi (vhq)"
+
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_lavcodec.cpp:67
+msgid "Rate distortion"
+msgstr "Distorsione proporzioni"
+
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_lavcodec.cpp:73
+msgid "Matrices"
+msgstr "Matrici"
+
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_lavcodec.cpp:74
+msgid "Mi_n. quantizer:"
+msgstr "Quantizzatore mi_nimo:"
+
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_lavcodec.cpp:75
+msgid "Ma_x. quantizer:"
+msgstr "Quantizzatore ma_ssimo:"
+
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_lavcodec.cpp:76
+msgid "Max. quantizer _difference:"
+msgstr "_Differenza quantizzatore massima:"
+
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_lavcodec.cpp:78
+msgid "4_MV"
+msgstr "4_MV"
+
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_lavcodec.cpp:79
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:1235
+msgid "_Trellis quantization"
+msgstr "Quantizzazione _Trellis"
+
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_lavcodec.cpp:81
+msgid "_Quarter pixel"
+msgstr "_Quarter pixel"
+
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_lavcodec.cpp:82
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:1018
+msgid "_GMC"
+msgstr "_GMC"
+
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_lavcodec.cpp:85
+msgid "_Number of B frames:"
+msgstr "_Numero di fotogrammi-B:"
+
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_lavcodec.cpp:86
+msgid "_Quantization type:"
+msgstr "Tipo di _quantizzazione:"
+
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_lavcodec.cpp:88
+msgid "_Macroblock decision:"
+msgstr "Decisione _Macroblock:"
+
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_lavcodec.cpp:90
+msgid "_Filesize tolerance (kb):"
+msgstr "Tolleranza dimensione _file (kb):"
+
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_lavcodec.cpp:92
+msgid "_Quantizer compression:"
+msgstr "Compressione _quantizzatore:"
+
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_lavcodec.cpp:93
+msgid "Quantizer _blur:"
+msgstr "_Sfuocatura quantizzatore:"
+
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_lavcodec.cpp:98
+msgid "User Interface"
+msgstr "Interfaccia utente"
+
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_lavcodec.cpp:101
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:1028
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_xvid4.cpp:80
+msgid "Advanced Simple Profile"
+msgstr "Profilo semplice avanzato"
+
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_lavcodec.cpp:108
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_srt.cpp:89
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_x264.cpp:86
+msgid "Motion Estimation"
+msgstr "Stima movimento"
+
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_lavcodec.cpp:112
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid.cpp:309
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:1240
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_xvid4.cpp:113
+msgid "Quantization"
+msgstr "Quantizzazione"
+
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_lavcodec.cpp:117
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1403
+msgid "Rate Control"
+msgstr "Controllo bitrate"
+
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_lavcodec.cpp:120
+msgid "libavcodec MPEG-4 configuration"
+msgstr "Configurazione libavcodec MPEG-4"
+
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_lavDecoder.cpp:45
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_postproc.cpp:41
+msgid "_Swap U and V"
+msgstr "_Inverti U e V"
+
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_lavDecoder.cpp:46
+msgid "Show motion _vectors"
+msgstr "Mostra _vettori movimento"
+
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_lavDecoder.cpp:48
+msgid "Decoder Options"
+msgstr "Opzioni decodificatore"
+
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_mjpeg.cpp:41
+msgid "_Swap U&V:"
+msgstr "_Inverti U e V"
+
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_postproc.cpp:40
+#: avidemux/ADM_videoFilter/ADM_vidForcedPP.cpp:60
+msgid "_Filter strength:"
+msgstr "Intensit? _filtro:"
+
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_postproc.cpp:51
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:278
+#: avidemux/ADM_videoFilter/ADM_vidForcedPP.cpp:72
+msgid "_Horizontal deblocking"
+msgstr "Deblocking _orizzontale"
+
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_postproc.cpp:52
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:279
+#: avidemux/ADM_videoFilter/ADM_vidForcedPP.cpp:73
+msgid "_Vertical deblocking"
+msgstr "Deblocking _verticale"
+
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_postproc.cpp:53
+#: avidemux/ADM_videoFilter/ADM_vidForcedPP.cpp:74
+msgid "_Deringing"
+msgstr "_Deringing"
+
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:163
+msgid "_Use systray while encoding"
+msgstr "_Usa systray durante la codifica"
+
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:164
+msgid "_Accept non-standard audio frequency for DVD"
+msgstr "_Accetta frequenze audio non standard per DVD"
+
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:165
+msgid "_Use libavcodec MPEG-2 decoder"
+msgstr "_Usa decodificatore libavcodec MPEG-2"
+
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:166
+msgid "Create _OpenDML files"
+msgstr "Crea file _OpenDML"
+
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:167
+msgid "Automatically _index MPEG files"
+msgstr "Indicizza automaticamente i file MPEG"
+
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:168
+msgid "Automatically _swap A and B if A>B"
+msgstr "Inverti automaticamente A e B se A>B"
+
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:169
+msgid "_Disable NUV audio sync"
+msgstr "_Disattiva sincronizzazione audio NUV"
+
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:170
+msgid "_Load external filters"
+msgstr "_Carica filtri esterni"
+
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:172
+msgid "Automatically _build VBR map"
+msgstr "_Crea automaticamente la mappa VBR"
+
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:173
+msgid "Automatically _rebuild index"
+msgstr "_Ricostrusci automaticamente l'indice"
+
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:174
+msgid "Automatically remove _packed bitstream"
+msgstr "Rimuovi automaticamente il _flusso di bit compresso"
+
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:176
+msgid "_Number of threads:"
+msgstr "_Numero di thread:"
+
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:179
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp:843
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_srt.cpp:108
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_x264.cpp:105
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_xvid4.cpp:61
+msgid "High"
+msgstr "Alta"
+
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:180
+msgid "Above normal"
+msgstr "Al di sopra del normale"
+
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:182
+msgid "Below normal"
+msgstr "Al di sotto del normale"
+
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:183
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp:847
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_srt.cpp:107
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_x264.cpp:104
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_xvid4.cpp:59
+msgid "Low"
+msgstr "Bassa"
+
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:185
+msgid "_Encoding priority:"
+msgstr "_Priorit? di codifica:"
+
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:186
+msgid "_Indexing/unpacking priority:"
+msgstr "Priorit? di _indicizzazione/decompressione:"
+
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:187
+msgid "_Playback priority:"
+msgstr "Priorit? playback:"
+
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:189
+msgid "_Split MPEG files every (MB):"
+msgstr "_Dividi i file MPEG ogni (MB):"
+
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:191
+msgid "_Use alternative tag for MP3 in .mp4"
+msgstr "_Usa etichette alternative per gli MP3 in file .mp4"
+
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:194
+msgid "GTK+ (slow)"
+msgstr "GTK+ (lento)"
+
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:196
+msgid "XVideo (best)"
+msgstr "XVideo (migliore)"
+
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:200
+msgid "SDL (GDI)"
+msgstr "SDL (GDI)"
+
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:201
+msgid "SDL (DirectX)"
+msgstr "SDL (DirectX)"
+
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:203
+msgid "SDL (good)"
+msgstr "SDL (buono)"
+
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:207
+msgid "Video _display:"
+msgstr "_Visualizzazione video:"
+
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:212
+msgid "No alerts"
+msgstr "Nessun avviso"
+
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:213
+msgid "Display only error alerts"
+msgstr "Visualizza solo gli avvisi di errore"
+
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:214
+msgid "Display all alerts"
+msgstr "Visualizza tutti gli avvisi"
+
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:216
+msgid "_Message level:"
+msgstr "Livello _messaggio:"
+
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:221
+msgid "PCM"
+msgstr "PCM"
+
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:222
+msgid "Master"
+msgstr "Master"
+
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:223
+msgid "_Volume control:"
+msgstr "Controllo _volume:"
+
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:228
+msgid "No downmixing"
+msgstr "No downmixing"
+
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:230
+msgid "Pro Logic"
+msgstr "Pro Logic"
+
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:231
+msgid "Pro Logic II"
+msgstr "Pro Logic II"
+
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:233
+msgid "_Local playback downmixing:"
+msgstr "_Local playback downmixing:"
+
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:265
+msgid "_Audio output:"
+msgstr "Output _audio"
+
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:267
+msgid "ALSA _device:"
+msgstr "_Dispositivo ALSA:"
+
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:280
+msgid "De_ringing"
+msgstr "De_ringing"
+
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:281
+#: avidemux/ADM_videoFilter/ADM_vidMSharpen.cpp:167
+msgid "_Strength:"
+msgstr "_Forza:"
+
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:282
+msgid "Default Postprocessing"
+msgstr "Postprocessing predefinito"
+
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:296
+msgid "_Filter directory:"
+msgstr "Cartella _filtri:"
+
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:330
+msgid "External Filters"
+msgstr "Filtri esterni"
+
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:334
+msgid "Preferences"
+msgstr "Preferenze"
+
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_requant.cpp:48
+msgid "_Shrink Factor:"
+msgstr "Fattore di _compressione:"
+
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_resizeWiz.cpp:59
+msgid "_Target type:"
+msgstr "_Tipo:"
+
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_resizeWiz.cpp:60
+msgid "_Source aspect ratio:"
+msgstr "Proporzioni _sorgente:"
+
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_resizeWiz.cpp:61
+msgid "_Destination aspect ratio:"
+msgstr "Proporzioni _destinazione:"
+
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_srt.cpp:88
+msgid "_Subtitle file:"
+msgstr "File _sottotitolo:"
+
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_srt.cpp:89
+msgid "_Font (TTF):"
+msgstr "_Carattere (TTF):"
+
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_srt.cpp:104
+msgid "_Encoding:"
+msgstr "_Codifica:"
+
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_srt.cpp:106
+msgid "S_elect C_olor"
+msgstr "Seleziona c_olore"
+
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_srt.cpp:107
+msgid "Set Size and _Position"
+msgstr "Imposta dimensione e _posizione"
+
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_srt.cpp:108
+msgid "_Auto split"
+msgstr "Dividi _automaticamente"
+
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_srt.cpp:109
+msgid "_Delay (ms):"
+msgstr "_Ritardo (ms):"
+
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_srt.cpp:112
+msgid "Subtitler"
+msgstr "Sottotitolatore"
+
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_tdeint.cpp:45
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_tdeint.cpp:51
+msgid "Auto (might not work)"
+msgstr "Automatico (potrebbe non funzionare)"
+
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_tdeint.cpp:46
+#: avidemux/ADM_videoFilter/ADM_vidYadif.cpp:178
+msgid "Top field first"
+msgstr "Prima il campo superiore"
+
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_tdeint.cpp:47
+#: avidemux/ADM_videoFilter/ADM_vidYadif.cpp:177
+msgid "Bottom field first"
+msgstr "Prima il campo inferiore"
+
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_tdeint.cpp:52
+msgid "Bottom field (keep top)"
+msgstr "Campo inferiore (mantieni superiore)"
+
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_tdeint.cpp:53
+msgid "Top field (keep bottom)"
+msgstr "Campo superiore (mantieni inferiore)"
+
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_tdeint.cpp:58
+msgid "Cubic interpolation"
+msgstr "Interpolazione cubica"
+
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_tdeint.cpp:59
+msgid "Modified ELA"
+msgstr "ELA modificato"
+
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_tdeint.cpp:60
+msgid "Kernel interpolation"
+msgstr "Interpolazione Kernel"
+
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_tdeint.cpp:61
+msgid "Modified ELA-2"
+msgstr "ELA-2 modificato"
+
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_tdeint.cpp:66
+msgid "4 fields check"
+msgstr "Controllo 4 campi"
+
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_tdeint.cpp:67
+msgid "5 fields check"
+msgstr "Controllo 5 campi"
+
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_tdeint.cpp:68
+msgid "4 fields check (no avg)"
+msgstr "Controllo 4 campi (no media)"
+
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_tdeint.cpp:69
+msgid "5 fields check (no avg)"
+msgstr "Controllo 5 campi (no media)"
+
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_tdeint.cpp:75
+msgid "No link"
+msgstr "Nessun collegamento"
+
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_tdeint.cpp:76
+msgid "Full link"
+msgstr "Collegamento completo"
+
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_tdeint.cpp:77
+msgid "Y to UV"
+msgstr "Da Y a UV"
+
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_tdeint.cpp:78
+msgid "UV to Y"
+msgstr "Da UV a Y"
+
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_tdeint.cpp:82
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp:632
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp:648
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp:664
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp:694
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp:661
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp:668
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp:675
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp:788
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_idx_pg.cpp:166
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_idx_pg.cpp:206
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_ocr.cpp:148
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_ocr.cpp:156
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_resize.cpp:419
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_resize.cpp:433
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1399
+msgid "0"
+msgstr "0"
+
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_tdeint.cpp:83
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:793
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:805
+msgid "1"
+msgstr "1"
+
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_tdeint.cpp:84
+msgid "2"
+msgstr "2"
+
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_tdeint.cpp:91
+#: avidemux/ADM_videoFilter/ADM_vidDecTelecide.cpp:111
+#: avidemux/ADM_videoFilter/ADM_vidDGbob.cpp:90
+#: avidemux/ADM_videoFilter/ADM_vidKernelDeint.cpp:92
+msgid "_Field order:"
+msgstr "Ordine _campi:"
+
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_tdeint.cpp:92
+msgid "_Interpolate:"
+msgstr "_Interpola:"
+
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_tdeint.cpp:94
+msgid "_Type:"
+msgstr "_Tipo:"
+
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_tdeint.cpp:95
+msgid "_MntMode:"
+msgstr "_MntMode:"
+
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_tdeint.cpp:96
+msgid "_Link:"
+msgstr "_Collegamento:"
+
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_tdeint.cpp:97
+msgid "_AP type:"
+msgstr "Tipo _AP:"
+
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_tdeint.cpp:100
+msgid "Use ch_roma to evalute"
+msgstr "Usa ch_roma per valutare"
+
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_tdeint.cpp:101
+msgid "Try _weave"
+msgstr "_Armatura di prova"
+
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_tdeint.cpp:102
+msgid "_Denoise"
+msgstr "_Rimuovi interferenza"
+
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_tdeint.cpp:103
+#: avidemux/ADM_videoFilter/ADM_vidKernelDeint.cpp:94
+msgid "_Sharp"
+msgstr "_Nitido"
+
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_tdeint.cpp:104
+msgid "_Evalute all frames"
+msgstr "_Valuta tutti i fotogrammi"
+
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_tdeint.cpp:107
+msgid "Motion threshold, l_uma:"
+msgstr "Soglia movimento, l_uma:"
+
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_tdeint.cpp:108
+msgid "Motion threshold, c_hroma:"
+msgstr "Soglia movimento, c_hroma:"
+
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_tdeint.cpp:109
+msgid "Area com_bing threshold:"
+msgstr "Soglia area com_bing:"
+
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_tdeint.cpp:110
+msgid "Combe_d threshold:"
+msgstr "Soglia _interlacciati:"
+
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_tdeint.cpp:111
+msgid "Artefact _protection threshold:"
+msgstr "Soglia di protezione artefatto:"
+
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_tdeint.cpp:120
+msgid "TDeint"
+msgstr "TDeint"
+
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_v2v.cpp:41
+msgid "_VOB file(s):"
+msgstr "File _VOB:"
+
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_v2v.cpp:42
+msgid "_IFO file:"
+msgstr "File _IFO:"
+
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_v2v.cpp:43
+msgid "Vob_Sub file:"
+msgstr "File Vob_Sub:"
+
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_v2v.cpp:48
+msgid "VOB to VobSub"
+msgstr "Da VOB a VobSub"
+
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_v2v.cpp:52
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_v2v.cpp:57
+msgid "The selected vobfile does not exist"
+msgstr "Il file vob selezionato non esiste"
+
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_v2v.cpp:62
+msgid "Please select a correct VobSub path/dir"
+msgstr "Seleziona un percorso VobSub corretto"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_about.cpp:54
+msgid "translator-credits"
+msgstr "Matteo 'Maff' Angelino"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_about.cpp:69
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:267
+msgid "Avidemux"
+msgstr "Avidemux"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_about.cpp:70
+msgid "? 2001-2006 Mean"
+msgstr "? 2001-2006 Mean"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_about.cpp:71
+msgid "Multiplatform video editor"
+msgstr "Video editor multi-piattaforma"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_about.cpp:72
+msgid ""
+"Avidemux is free software; you can redistribute it and/or modify it \n"
+"under the terms of the GNU General Public License version 2 \n"
+"as published by the Free Software Foundation.\n"
+"\n"
+"\t\t    GNU GENERAL PUBLIC LICENSE\n"
+"\t\t       Version 2, June 1991\n"
+"\n"
+" Copyright (C) 1989, 1991 Free Software Foundation, Inc.\n"
+"                       51 Franklin St, Fifth Floor, Boston, MA  02110-1301  USA\n"
+" Everyone is permitted to copy and distribute verbatim copies\n"
+" of this license document, but changing it is not allowed.\n"
+"\n"
+"\t\t\t    Preamble\n"
+"\n"
+"  The licenses for most software are designed to take away your\n"
+"freedom to share and change it.  By contrast, the GNU General Public\n"
+"License is intended to guarantee your freedom to share and change free\n"
+"software--to make sure the software is free for all its users.  This\n"
+"General Public License applies to most of the Free Software\n"
+"Foundation's software and to any other program whose authors commit to\n"
+"using it.  (Some other Free Software Foundation software is covered by\n"
+"the GNU Library General Public License instead.)  You can apply it to\n"
+"your programs, too.\n"
+"\n"
+"  When we speak of free software, we are referring to freedom, not\n"
+"price.  Our General Public Licenses are designed to make sure that you\n"
+"have the freedom to distribute copies of free software (and charge for\n"
+"this service if you wish), that you receive source code or can get it\n"
+"if you want it, that you can change the software or use pieces of it\n"
+"in new free programs; and that you know you can do these things.\n"
+"\n"
+"  To protect your rights, we need to make restrictions that forbid\n"
+"anyone to deny you these rights or to ask you to surrender the rights.\n"
+"These restrictions translate to certain responsibilities for you if you\n"
+"distribute copies of the software, or if you modify it.\n"
+"\n"
+"  For example, if you distribute copies of such a program, whether\n"
+"gratis or for a fee, you must give the recipients all the rights that\n"
+"you have.  You must make sure that they, too, receive or can get the\n"
+"source code.  And you must show them these terms so they know their\n"
+"rights.\n"
+"\n"
+"  We protect your rights with two steps: (1) copyright the software, and\n"
+"(2) offer you this license which gives you legal permission to copy,\n"
+"distribute and/or modify the software.\n"
+"\n"
+"  Also, for each author's protection and ours, we want to make certain\n"
+"that everyone understands that there is no warranty for this free\n"
+"software.  If the software is modified by someone else and passed on, we\n"
+"want its recipients to know that what they have is not the original, so\n"
+"that any problems introduced by others will not reflect on the original\n"
+"authors' reputations.\n"
+"\n"
+"  Finally, any free program is threatened constantly by software\n"
+"patents.  We wish to avoid the danger that redistributors of a free\n"
+"program will individually obtain patent licenses, in effect making the\n"
+"program proprietary.  To prevent this, we have made it clear that any\n"
+"patent must be licensed for everyone's free use or not licensed at all.\n"
+"\n"
+"  The precise terms and conditions for copying, distribution and\n"
+"modification follow.\n"
+"\n"
+"\t\t    GNU GENERAL PUBLIC LICENSE\n"
+"   TERMS AND CONDITIONS FOR COPYING, DISTRIBUTION AND MODIFICATION\n"
+"\n"
+"  0. This License applies to any program or other work which contains\n"
+"a notice placed by the copyright holder saying it may be distributed\n"
+"under the terms of this General Public License.  The \"Program\", below,\n"
+"refers to any such program or work, and a \"work based on the Program\"\n"
+"means either the Program or any derivative work under copyright law:\n"
+"that is to say, a work containing the Program or a portion of it,\n"
+"either verbatim or with modifications and/or translated into another\n"
+"language.  (Hereinafter, translation is included without limitation in\n"
+"the term \"modification\".)  Each licensee is addressed as \"you\".\n"
+"\n"
+"Activities other than copying, distribution and modification are not\n"
+"covered by this License; they are outside its scope.  The act of\n"
+"running the Program is not restricted, and the output from the Program\n"
+"is covered only if its contents constitute a work based on the\n"
+"Program (independent of having been made by running the Program).\n"
+"Whether that is true depends on what the Program does.\n"
+"\n"
+"  1. You may copy and distribute verbatim copies of the Program's\n"
+"source code as you receive it, in any medium, provided that you\n"
+"conspicuously and appropriately publish on each copy an appropriate\n"
+"copyright notice and disclaimer of warranty; keep intact all the\n"
+"notices that refer to this License and to the absence of any warranty;\n"
+"and give any other recipients of the Program a copy of this License\n"
+"along with the Program.\n"
+"\n"
+"You may charge a fee for the physical act of transferring a copy, and\n"
+"you may at your option offer warranty protection in exchange for a fee.\n"
+"\n"
+"  2. You may modify your copy or copies of the Program or any portion\n"
+"of it, thus forming a work based on the Program, and copy and\n"
+"distribute such modifications or work under the terms of Section 1\n"
+"above, provided that you also meet all of these conditions:\n"
+"\n"
+"    a) You must cause the modified files to carry prominent notices\n"
+"    stating that you changed the files and the date of any change.\n"
+"\n"
+"    b) You must cause any work that you distribute or publish, that in\n"
+"    whole or in part contains or is derived from the Program or any\n"
+"    part thereof, to be licensed as a whole at no charge to all third\n"
+"    parties under the terms of this License.\n"
+"\n"
+"    c) If the modified program normally reads commands interactively\n"
+"    when run, you must cause it, when started running for such\n"
+"    interactive use in the most ordinary way, to print or display an\n"
+"    announcement including an appropriate copyright notice and a\n"
+"    notice that there is no warranty (or else, saying that you provide\n"
+"    a warranty) and that users may redistribute the program under\n"
+"    these conditions, and telling the user how to view a copy of this\n"
+"    License.  (Exception: if the Program itself is interactive but\n"
+"    does not normally print such an announcement, your work based on\n"
+"    the Program is not required to print an announcement.)\n"
+"\n"
+"These requirements apply to the modified work as a whole.  If\n"
+"identifiable sections of that work are not derived from the Program,\n"
+"and can be reasonably considered independent and separate works in\n"
+"themselves, then this License, and its terms, do not apply to those\n"
+"sections when you distribute them as separate works.  But when you\n"
+"distribute the same sections as part of a whole which is a work based\n"
+"on the Program, the distribution of the whole must be on the terms of\n"
+"this License, whose permissions for other licensees extend to the\n"
+"entire whole, and thus to each and every part regardless of who wrote it.\n"
+"\n"
+"Thus, it is not the intent of this section to claim rights or contest\n"
+"your rights to work written entirely by you; rather, the intent is to\n"
+"exercise the right to control the distribution of derivative or\n"
+"collective works based on the Program.\n"
+"\n"
+"In addition, mere aggregation of another work not based on the Program\n"
+"with the Program (or with a work based on the Program) on a volume of\n"
+"a storage or distribution medium does not bring the other work under\n"
+"the scope of this License.\n"
+"\n"
+"  3. You may copy and distribute the Program (or a work based on it,\n"
+"under Section 2) in object code or executable form under the terms of\n"
+"Sections 1 and 2 above provided that you also do one of the following:\n"
+"\n"
+"    a) Accompany it with the complete corresponding machine-readable\n"
+"    source code, which must be distributed under the terms of Sections\n"
+"    1 and 2 above on a medium customarily used for software interchange; or,\n"
+"\n"
+"    b) Accompany it with a written offer, valid for at least three\n"
+"    years, to give any third party, for a charge no more than your\n"
+"    cost of physically performing source distribution, a complete\n"
+"    machine-readable copy of the corresponding source code, to be\n"
+"    distributed under the terms of Sections 1 and 2 above on a medium\n"
+"    customarily used for software interchange; or,\n"
+"\n"
+"    c) Accompany it with the information you received as to the offer\n"
+"    to distribute corresponding source code.  (This alternative is\n"
+"    allowed only for noncommercial distribution and only if you\n"
+"    received the program in object code or executable form with such\n"
+"    an offer, in accord with Subsection b above.)\n"
+"\n"
+"The source code for a work means the preferred form of the work for\n"
+"making modifications to it.  For an executable work, complete source\n"
+"code means all the source code for all modules it contains, plus any\n"
+"associated interface definition files, plus the scripts used to\n"
+"control compilation and installation of the executable.  However, as a\n"
+"special exception, the source code distributed need not include\n"
+"anything that is normally distributed (in either source or binary\n"
+"form) with the major components (compiler, kernel, and so on) of the\n"
+"operating system on which the executable runs, unless that component\n"
+"itself accompanies the executable.\n"
+"\n"
+"If distribution of executable or object code is made by offering\n"
+"access to copy from a designated place, then offering equivalent\n"
+"access to copy the source code from the same place counts as\n"
+"distribution of the source code, even though third parties are not\n"
+"compelled to copy the source along with the object code.\n"
+"\n"
+"  4. You may not copy, modify, sublicense, or distribute the Program\n"
+"except as expressly provided under this License.  Any attempt\n"
+"otherwise to copy, modify, sublicense or distribute the Program is\n"
+"void, and will automatically terminate your rights under this License.\n"
+"However, parties who have received copies, or rights, from you under\n"
+"this License will not have their licenses terminated so long as such\n"
+"parties remain in full compliance.\n"
+"\n"
+"  5. You are not required to accept this License, since you have not\n"
+"signed it.  However, nothing else grants you permission to modify or\n"
+"distribute the Program or its derivative works.  These actions are\n"
+"prohibited by law if you do not accept this License.  Therefore, by\n"
+"modifying or distributing the Program (or any work based on the\n"
+"Program), you indicate your acceptance of this License to do so, and\n"
+"all its terms and conditions for copying, distributing or modifying\n"
+"the Program or works based on it.\n"
+"\n"
+"  6. Each time you redistribute the Program (or any work based on the\n"
+"Program), the recipient automatically receives a license from the\n"
+"original licensor to copy, distribute or modify the Program subject to\n"
+"these terms and conditions.  You may not impose any further\n"
+"restrictions on the recipients' exercise of the rights granted herein.\n"
+"You are not responsible for enforcing compliance by third parties to\n"
+"this License.\n"
+"\n"
+"  7. If, as a consequence of a court judgment or allegation of patent\n"
+"infringement or for any other reason (not limited to patent issues),\n"
+"conditions are imposed on you (whether by court order, agreement or\n"
+"otherwise) that contradict the conditions of this License, they do not\n"
+"excuse you from the conditions of this License.  If you cannot\n"
+"distribute so as to satisfy simultaneously your obligations under this\n"
+"License and any other pertinent obligations, then as a consequence you\n"
+"may not distribute the Program at all.  For example, if a patent\n"
+"license would not permit royalty-free redistribution of the Program by\n"
+"all those who receive copies directly or indirectly through you, then\n"
+"the only way you could satisfy both it and this License would be to\n"
+"refrain entirely from distribution of the Program.\n"
+"\n"
+"If any portion of this section is held invalid or unenforceable under\n"
+"any particular circumstance, the balance of the section is intended to\n"
+"apply and the section as a whole is intended to apply in other\n"
+"circumstances.\n"
+"\n"
+"It is not the purpose of this section to induce you to infringe any\n"
+"patents or other property right claims or to contest validity of any\n"
+"such claims; this section has the sole purpose of protecting the\n"
+"integrity of the free software distribution system, which is\n"
+"implemented by public license practices.  Many people have made\n"
+"generous contributions to the wide range of software distributed\n"
+"through that system in reliance on consistent application of that\n"
+"system; it is up to the author/donor to decide if he or she is willing\n"
+"to distribute software through any other system and a licensee cannot\n"
+"impose that choice.\n"
+"\n"
+"This section is intended to make thoroughly clear what is believed to\n"
+"be a consequence of the rest of this License.\n"
+"\n"
+"  8. If the distribution and/or use of the Program is restricted in\n"
+"certain countries either by patents or by copyrighted interfaces, the\n"
+"original copyright holder who places the Program under this License\n"
+"may add an explicit geographical distribution limitation excluding\n"
+"those countries, so that distribution is permitted only in or among\n"
+"countries not thus excluded.  In such case, this License incorporates\n"
+"the limitation as if written in the body of this License.\n"
+"\n"
+"  9. The Free Software Foundation may publish revised and/or new versions\n"
+"of the General Public License from time to time.  Such new versions will\n"
+"be similar in spirit to the present version, but may differ in detail to\n"
+"address new problems or concerns.\n"
+"\n"
+"Each version is given a distinguishing version number.  If the Program\n"
+"specifies a version number of this License which applies to it and \"any\n"
+"later version\", you have the option of following the terms and conditions\n"
+"either of that version or of any later version published by the Free\n"
+"Software Foundation.  If the Program does not specify a version number of\n"
+"this License, you may choose any version ever published by the Free Software\n"
+"Foundation.\n"
+"\n"
+"  10. If you wish to incorporate parts of the Program into other free\n"
+"programs whose distribution conditions are different, write to the author\n"
+"to ask for permission.  For software which is copyrighted by the Free\n"
+"Software Foundation, write to the Free Software Foundation; we sometimes\n"
+"make exceptions for this.  Our decision will be guided by the two goals\n"
+"of preserving the free status of all derivatives of our free software and\n"
+"of promoting the sharing and reuse of software generally.\n"
+"\n"
+"\t\t\t    NO WARRANTY\n"
+"\n"
+"  11. BECAUSE THE PROGRAM IS LICENSED FREE OF CHARGE, THERE IS NO WARRANTY\n"
+"FOR THE PROGRAM, TO THE EXTENT PERMITTED BY APPLICABLE LAW.  EXCEPT WHEN\n"
+"OTHERWISE STATED IN WRITING THE COPYRIGHT HOLDERS AND/OR OTHER PARTIES\n"
+"PROVIDE THE PROGRAM \"AS IS\" WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESSED\n"
+"OR IMPLIED, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF\n"
+"MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  THE ENTIRE RISK AS\n"
+"TO THE QUALITY AND PERFORMANCE OF THE PROGRAM IS WITH YOU.  SHOULD THE\n"
+"PROGRAM PROVE DEFECTIVE, YOU ASSUME THE COST OF ALL NECESSARY SERVICING,\n"
+"REPAIR OR CORRECTION.\n"
+"\n"
+"  12. IN NO EVENT UNLESS REQUIRED BY APPLICABLE LAW OR AGREED TO IN WRITING\n"
+"WILL ANY COPYRIGHT HOLDER, OR ANY OTHER PARTY WHO MAY MODIFY AND/OR\n"
+"REDISTRIBUTE THE PROGRAM AS PERMITTED ABOVE, BE LIABLE TO YOU FOR DAMAGES,\n"
+"INCLUDING ANY GENERAL, SPECIAL, INCIDENTAL OR CONSEQUENTIAL DAMAGES ARISING\n"
+"OUT OF THE USE OR INABILITY TO USE THE PROGRAM (INCLUDING BUT NOT LIMITED\n"
+"TO LOSS OF DATA OR DATA BEING RENDERED INACCURATE OR LOSSES SUSTAINED BY\n"
+"YOU OR THIRD PARTIES OR A FAILURE OF THE PROGRAM TO OPERATE WITH ANY OTHER\n"
+"PROGRAMS), EVEN IF SUCH HOLDER OR OTHER PARTY HAS BEEN ADVISED OF THE\n"
+"POSSIBILITY OF SUCH DAMAGES.\n"
+"\n"
+"\t\t     END OF TERMS AND CONDITIONS\n"
+"\n"
+"\t    How to Apply These Terms to Your New Programs\n"
+"\n"
+"  If you develop a new program, and you want it to be of the greatest\n"
+"possible use to the public, the best way to achieve this is to make it\n"
+"free software which everyone can redistribute and change under these terms.\n"
+"\n"
+"  To do so, attach the following notices to the program.  It is safest\n"
+"to attach them to the start of each source file to most effectively\n"
+"convey the exclusion of warranty; and each file should have at least\n"
+"the \"copyright\" line and a pointer to where the full notice is found.\n"
+"\n"
+"    <one line to give the program's name and a brief idea of what it does.>\n"
+"    Copyright (C) <year>  <name of author>\n"
+"\n"
+"    This program is free software; you can redistribute it and/or modify\n"
+"    it under the terms of the GNU General Public License as published by\n"
+"    the Free Software Foundation; either version 2 of the License, or\n"
+"    (at your option) any later version.\n"
+"\n"
+"    This program is distributed in the hope that it will be useful,\n"
+"    but WITHOUT ANY WARRANTY; without even the implied warranty of\n"
+"    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n"
+"    GNU General Public License for more details.\n"
+"\n"
+"    You should have received a copy of the GNU General Public License\n"
+"    along with this program; if not, write to the Free Software\n"
+"    Foundation, Inc., 51 Franklin St, Fifth Floor, Boston, MA  02110-1301  USA\n"
+"\n"
+"\n"
+"Also add information on how to contact you by electronic and paper mail.\n"
+"\n"
+"If the program is interactive, make it output a short notice like this\n"
+"when it starts in an interactive mode:\n"
+"\n"
+"    Gnomovision version 69, Copyright (C) year name of author\n"
+"    Gnomovision comes with ABSOLUTELY NO WARRANTY; for details type `show w'.\n"
+"    This is free software, and you are welcome to redistribute it\n"
+"    under certain conditions; type `show c' for details.\n"
+"\n"
+"The hypothetical commands `show w' and `show c' should show the appropriate\n"
+"parts of the General Public License.  Of course, the commands you use may\n"
+"be called something other than `show w' and `show c'; they could even be\n"
+"mouse-clicks or menu items--whatever suits your program.\n"
+"\n"
+"You should also get your employer (if you work as a programmer) or your\n"
+"school, if any, to sign a \"copyright disclaimer\" for the program, if\n"
+"necessary.  Here is a sample; alter the names:\n"
+"\n"
+"  Yoyodyne, Inc., hereby disclaims all copyright interest in the program\n"
+"  `Gnomovision' (which makes passes at compilers) written by James Hacker.\n"
+"\n"
+"  <signature of Ty Coon>, 1 April 1989\n"
+"  Ty Coon, President of Vice\n"
+"\n"
+"This General Public License does not permit incorporating your program into\n"
+"proprietary programs.  If your program is a subroutine library, you may\n"
+"consider it more useful to permit linking proprietary applications with the\n"
+"library.  If this is what you want to do, use the GNU Library General\n"
+"Public License instead of this License."
+msgstr ""
+"Avidemux ? un programma libero e gratuito; puoi ridistribuirlo e/o modificarlo\n"
+"secondo i termini della Licenza Pubblica Generica GNU versione 2\n"
+"come pubblicato dalla Free Software Foundation.\n"
+"\n"
+"\t\t    GNU GENERAL PUBLIC LICENSE\n"
+"\t\t       Version 2, June 1991\n"
+"\n"
+" Copyright (C) 1989, 1991 Free Software Foundation, Inc.\n"
+"                       51 Franklin St, Fifth Floor, Boston, MA  02110-1301  USA\n"
+" Everyone is permitted to copy and distribute verbatim copies\n"
+" of this license document, but changing it is not allowed.\n"
+"\n"
+"\t\t\t    Preamble\n"
+"\n"
+"  The licenses for most software are designed to take away your\n"
+"freedom to share and change it.  By contrast, the GNU General Public\n"
+"License is intended to guarantee your freedom to share and change free\n"
+"software--to make sure the software is free for all its users.  This\n"
+"General Public License applies to most of the Free Software\n"
+"Foundation's software and to any other program whose authors commit to\n"
+"using it.  (Some other Free Software Foundation software is covered by\n"
+"the GNU Library General Public License instead.)  You can apply it to\n"
+"your programs, too.\n"
+"\n"
+"  When we speak of free software, we are referring to freedom, not\n"
+"price.  Our General Public Licenses are designed to make sure that you\n"
+"have the freedom to distribute copies of free software (and charge for\n"
+"this service if you wish), that you receive source code or can get it\n"
+"if you want it, that you can change the software or use pieces of it\n"
+"in new free programs; and that you know you can do these things.\n"
+"\n"
+"  To protect your rights, we need to make restrictions that forbid\n"
+"anyone to deny you these rights or to ask you to surrender the rights.\n"
+"These restrictions translate to certain responsibilities for you if you\n"
+"distribute copies of the software, or if you modify it.\n"
+"\n"
+"  For example, if you distribute copies of such a program, whether\n"
+"gratis or for a fee, you must give the recipients all the rights that\n"
+"you have.  You must make sure that they, too, receive or can get the\n"
+"source code.  And you must show them these terms so they know their\n"
+"rights.\n"
+"\n"
+"  We protect your rights with two steps: (1) copyright the software, and\n"
+"(2) offer you this license which gives you legal permission to copy,\n"
+"distribute and/or modify the software.\n"
+"\n"
+"  Also, for each author's protection and ours, we want to make certain\n"
+"that everyone understands that there is no warranty for this free\n"
+"software.  If the software is modified by someone else and passed on, we\n"
+"want its recipients to know that what they have is not the original, so\n"
+"that any problems introduced by others will not reflect on the original\n"
+"authors' reputations.\n"
+"\n"
+"  Finally, any free program is threatened constantly by software\n"
+"patents.  We wish to avoid the danger that redistributors of a free\n"
+"program will individually obtain patent licenses, in effect making the\n"
+"program proprietary.  To prevent this, we have made it clear that any\n"
+"patent must be licensed for everyone's free use or not licensed at all.\n"
+"\n"
+"  The precise terms and conditions for copying, distribution and\n"
+"modification follow.\n"
+"\n"
+"\t\t    GNU GENERAL PUBLIC LICENSE\n"
+"   TERMS AND CONDITIONS FOR COPYING, DISTRIBUTION AND MODIFICATION\n"
+"\n"
+"  0. This License applies to any program or other work which contains\n"
+"a notice placed by the copyright holder saying it may be distributed\n"
+"under the terms of this General Public License.  The \"Program\", below,\n"
+"refers to any such program or work, and a \"work based on the Program\"\n"
+"means either the Program or any derivative work under copyright law:\n"
+"that is to say, a work containing the Program or a portion of it,\n"
+"either verbatim or with modifications and/or translated into another\n"
+"language.  (Hereinafter, translation is included without limitation in\n"
+"the term \"modification\".)  Each licensee is addressed as \"you\".\n"
+"\n"
+"Activities other than copying, distribution and modification are not\n"
+"covered by this License; they are outside its scope.  The act of\n"
+"running the Program is not restricted, and the output from the Program\n"
+"is covered only if its contents constitute a work based on the\n"
+"Program (independent of having been made by running the Program).\n"
+"Whether that is true depends on what the Program does.\n"
+"\n"
+"  1. You may copy and distribute verbatim copies of the Program's\n"
+"source code as you receive it, in any medium, provided that you\n"
+"conspicuously and appropriately publish on each copy an appropriate\n"
+"copyright notice and disclaimer of warranty; keep intact all the\n"
+"notices that refer to this License and to the absence of any warranty;\n"
+"and give any other recipients of the Program a copy of this License\n"
+"along with the Program.\n"
+"\n"
+"You may charge a fee for the physical act of transferring a copy, and\n"
+"you may at your option offer warranty protection in exchange for a fee.\n"
+"\n"
+"  2. You may modify your copy or copies of the Program or any portion\n"
+"of it, thus forming a work based on the Program, and copy and\n"
+"distribute such modifications or work under the terms of Section 1\n"
+"above, provided that you also meet all of these conditions:\n"
+"\n"
+"    a) You must cause the modified files to carry prominent notices\n"
+"    stating that you changed the files and the date of any change.\n"
+"\n"
+"    b) You must cause any work that you distribute or publish, that in\n"
+"    whole or in part contains or is derived from the Program or any\n"
+"    part thereof, to be licensed as a whole at no charge to all third\n"
+"    parties under the terms of this License.\n"
+"\n"
+"    c) If the modified program normally reads commands interactively\n"
+"    when run, you must cause it, when started running for such\n"
+"    interactive use in the most ordinary way, to print or display an\n"
+"    announcement including an appropriate copyright notice and a\n"
+"    notice that there is no warranty (or else, saying that you provide\n"
+"    a warranty) and that users may redistribute the program under\n"
+"    these conditions, and telling the user how to view a copy of this\n"
+"    License.  (Exception: if the Program itself is interactive but\n"
+"    does not normally print such an announcement, your work based on\n"
+"    the Program is not required to print an announcement.)\n"
+"\n"
+"These requirements apply to the modified work as a whole.  If\n"
+"identifiable sections of that work are not derived from the Program,\n"
+"and can be reasonably considered independent and separate works in\n"
+"themselves, then this License, and its terms, do not apply to those\n"
+"sections when you distribute them as separate works.  But when you\n"
+"distribute the same sections as part of a whole which is a work based\n"
+"on the Program, the distribution of the whole must be on the terms of\n"
+"this License, whose permissions for other licensees extend to the\n"
+"entire whole, and thus to each and every part regardless of who wrote it.\n"
+"\n"
+"Thus, it is not the intent of this section to claim rights or contest\n"
+"your rights to work written entirely by you; rather, the intent is to\n"
+"exercise the right to control the distribution of derivative or\n"
+"collective works based on the Program.\n"
+"\n"
+"In addition, mere aggregation of another work not based on the Program\n"
+"with the Program (or with a work based on the Program) on a volume of\n"
+"a storage or distribution medium does not bring the other work under\n"
+"the scope of this License.\n"
+"\n"
+"  3. You may copy and distribute the Program (or a work based on it,\n"
+"under Section 2) in object code or executable form under the terms of\n"
+"Sections 1 and 2 above provided that you also do one of the following:\n"
+"\n"
+"    a) Accompany it with the complete corresponding machine-readable\n"
+"    source code, which must be distributed under the terms of Sections\n"
+"    1 and 2 above on a medium customarily used for software interchange; or,\n"
+"\n"
+"    b) Accompany it with a written offer, valid for at least three\n"
+"    years, to give any third party, for a charge no more than your\n"
+"    cost of physically performing source distribution, a complete\n"
+"    machine-readable copy of the corresponding source code, to be\n"
+"    distributed under the terms of Sections 1 and 2 above on a medium\n"
+"    customarily used for software interchange; or,\n"
+"\n"
+"    c) Accompany it with the information you received as to the offer\n"
+"    to distribute corresponding source code.  (This alternative is\n"
+"    allowed only for noncommercial distribution and only if you\n"
+"    received the program in object code or executable form with such\n"
+"    an offer, in accord with Subsection b above.)\n"
+"\n"
+"The source code for a work means the preferred form of the work for\n"
+"making modifications to it.  For an executable work, complete source\n"
+"code means all the source code for all modules it contains, plus any\n"
+"associated interface definition files, plus the scripts used to\n"
+"control compilation and installation of the executable.  However, as a\n"
+"special exception, the source code distributed need not include\n"
+"anything that is normally distributed (in either source or binary\n"
+"form) with the major components (compiler, kernel, and so on) of the\n"
+"operating system on which the executable runs, unless that component\n"
+"itself accompanies the executable.\n"
+"\n"
+"If distribution of executable or object code is made by offering\n"
+"access to copy from a designated place, then offering equivalent\n"
+"access to copy the source code from the same place counts as\n"
+"distribution of the source code, even though third parties are not\n"
+"compelled to copy the source along with the object code.\n"
+"\n"
+"  4. You may not copy, modify, sublicense, or distribute the Program\n"
+"except as expressly provided under this License.  Any attempt\n"
+"otherwise to copy, modify, sublicense or distribute the Program is\n"
+"void, and will automatically terminate your rights under this License.\n"
+"However, parties who have received copies, or rights, from you under\n"
+"this License will not have their licenses terminated so long as such\n"
+"parties remain in full compliance.\n"
+"\n"
+"  5. You are not required to accept this License, since you have not\n"
+"signed it.  However, nothing else grants you permission to modify or\n"
+"distribute the Program or its derivative works.  These actions are\n"
+"prohibited by law if you do not accept this License.  Therefore, by\n"
+"modifying or distributing the Program (or any work based on the\n"
+"Program), you indicate your acceptance of this License to do so, and\n"
+"all its terms and conditions for copying, distributing or modifying\n"
+"the Program or works based on it.\n"
+"\n"
+"  6. Each time you redistribute the Program (or any work based on the\n"
+"Program), the recipient automatically receives a license from the\n"
+"original licensor to copy, distribute or modify the Program subject to\n"
+"these terms and conditions.  You may not impose any further\n"
+"restrictions on the recipients' exercise of the rights granted herein.\n"
+"You are not responsible for enforcing compliance by third parties to\n"
+"this License.\n"
+"\n"
+"  7. If, as a consequence of a court judgment or allegation of patent\n"
+"infringement or for any other reason (not limited to patent issues),\n"
+"conditions are imposed on you (whether by court order, agreement or\n"
+"otherwise) that contradict the conditions of this License, they do not\n"
+"excuse you from the conditions of this License.  If you cannot\n"
+"distribute so as to satisfy simultaneously your obligations under this\n"
+"License and any other pertinent obligations, then as a consequence you\n"
+"may not distribute the Program at all.  For example, if a patent\n"
+"license would not permit royalty-free redistribution of the Program by\n"
+"all those who receive copies directly or indirectly through you, then\n"
+"the only way you could satisfy both it and this License would be to\n"
+"refrain entirely from distribution of the Program.\n"
+"\n"
+"If any portion of this section is held invalid or unenforceable under\n"
+"any particular circumstance, the balance of the section is intended to\n"
+"apply and the section as a whole is intended to apply in other\n"
+"circumstances.\n"
+"\n"
+"It is not the purpose of this section to induce you to infringe any\n"
+"patents or other property right claims or to contest validity of any\n"
+"such claims; this section has the sole purpose of protecting the\n"
+"integrity of the free software distribution system, which is\n"
+"implemented by public license practices.  Many people have made\n"
+"generous contributions to the wide range of software distributed\n"
+"through that system in reliance on consistent application of that\n"
+"system; it is up to the author/donor to decide if he or she is willing\n"
+"to distribute software through any other system and a licensee cannot\n"
+"impose that choice.\n"
+"\n"
+"This section is intended to make thoroughly clear what is believed to\n"
+"be a consequence of the rest of this License.\n"
+"\n"
+"  8. If the distribution and/or use of the Program is restricted in\n"
+"certain countries either by patents or by copyrighted interfaces, the\n"
+"original copyright holder who places the Program under this License\n"
+"may add an explicit geographical distribution limitation excluding\n"
+"those countries, so that distribution is permitted only in or among\n"
+"countries not thus excluded.  In such case, this License incorporates\n"
+"the limitation as if written in the body of this License.\n"
+"\n"
+"  9. The Free Software Foundation may publish revised and/or new versions\n"
+"of the General Public License from time to time.  Such new versions will\n"
+"be similar in spirit to the present version, but may differ in detail to\n"
+"address new problems or concerns.\n"
+"\n"
+"Each version is given a distinguishing version number.  If the Program\n"
+"specifies a version number of this License which applies to it and \"any\n"
+"later version\", you have the option of following the terms and conditions\n"
+"either of that version or of any later version published by the Free\n"
+"Software Foundation.  If the Program does not specify a version number of\n"
+"this License, you may choose any version ever published by the Free Software\n"
+"Foundation.\n"
+"\n"
+"  10. If you wish to incorporate parts of the Program into other free\n"
+"programs whose distribution conditions are different, write to the author\n"
+"to ask for permission.  For software which is copyrighted by the Free\n"
+"Software Foundation, write to the Free Software Foundation; we sometimes\n"
+"make exceptions for this.  Our decision will be guided by the two goals\n"
+"of preserving the free status of all derivatives of our free software and\n"
+"of promoting the sharing and reuse of software generally.\n"
+"\n"
+"\t\t\t    NO WARRANTY\n"
+"\n"
+"  11. BECAUSE THE PROGRAM IS LICENSED FREE OF CHARGE, THERE IS NO WARRANTY\n"
+"FOR THE PROGRAM, TO THE EXTENT PERMITTED BY APPLICABLE LAW.  EXCEPT WHEN\n"
+"OTHERWISE STATED IN WRITING THE COPYRIGHT HOLDERS AND/OR OTHER PARTIES\n"
+"PROVIDE THE PROGRAM \"AS IS\" WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESSED\n"
+"OR IMPLIED, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF\n"
+"MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  THE ENTIRE RISK AS\n"
+"TO THE QUALITY AND PERFORMANCE OF THE PROGRAM IS WITH YOU.  SHOULD THE\n"
+"PROGRAM PROVE DEFECTIVE, YOU ASSUME THE COST OF ALL NECESSARY SERVICING,\n"
+"REPAIR OR CORRECTION.\n"
+"\n"
+"  12. IN NO EVENT UNLESS REQUIRED BY APPLICABLE LAW OR AGREED TO IN WRITING\n"
+"WILL ANY COPYRIGHT HOLDER, OR ANY OTHER PARTY WHO MAY MODIFY AND/OR\n"
+"REDISTRIBUTE THE PROGRAM AS PERMITTED ABOVE, BE LIABLE TO YOU FOR DAMAGES,\n"
+"INCLUDING ANY GENERAL, SPECIAL, INCIDENTAL OR CONSEQUENTIAL DAMAGES ARISING\n"
+"OUT OF THE USE OR INABILITY TO USE THE PROGRAM (INCLUDING BUT NOT LIMITED\n"
+"TO LOSS OF DATA OR DATA BEING RENDERED INACCURATE OR LOSSES SUSTAINED BY\n"
+"YOU OR THIRD PARTIES OR A FAILURE OF THE PROGRAM TO OPERATE WITH ANY OTHER\n"
+"PROGRAMS), EVEN IF SUCH HOLDER OR OTHER PARTY HAS BEEN ADVISED OF THE\n"
+"POSSIBILITY OF SUCH DAMAGES.\n"
+"\n"
+"\t\t     END OF TERMS AND CONDITIONS\n"
+"\n"
+"\t    How to Apply These Terms to Your New Programs\n"
+"\n"
+"  If you develop a new program, and you want it to be of the greatest\n"
+"possible use to the public, the best way to achieve this is to make it\n"
+"free software which everyone can redistribute and change under these terms.\n"
+"\n"
+"  To do so, attach the following notices to the program.  It is safest\n"
+"to attach them to the start of each source file to most effectively\n"
+"convey the exclusion of warranty; and each file should have at least\n"
+"the \"copyright\" line and a pointer to where the full notice is found.\n"
+"\n"
+"    <one line to give the program's name and a brief idea of what it does.>\n"
+"    Copyright (C) <year>  <name of author>\n"
+"\n"
+"    This program is free software; you can redistribute it and/or modify\n"
+"    it under the terms of the GNU General Public License as published by\n"
+"    the Free Software Foundation; either version 2 of the License, or\n"
+"    (at your option) any later version.\n"
+"\n"
+"    This program is distributed in the hope that it will be useful,\n"
+"    but WITHOUT ANY WARRANTY; without even the implied warranty of\n"
+"    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n"
+"    GNU General Public License for more details.\n"
+"\n"
+"    You should have received a copy of the GNU General Public License\n"
+"    along with this program; if not, write to the Free Software\n"
+"    Foundation, Inc., 51 Franklin St, Fifth Floor, Boston, MA  02110-1301  USA\n"
+"\n"
+"\n"
+"Also add information on how to contact you by electronic and paper mail.\n"
+"\n"
+"If the program is interactive, make it output a short notice like this\n"
+"when it starts in an interactive mode:\n"
+"\n"
+"    Gnomovision version 69, Copyright (C) year name of author\n"
+"    Gnomovision comes with ABSOLUTELY NO WARRANTY; for details type `show w'.\n"
+"    This is free software, and you are welcome to redistribute it\n"
+"    under certain conditions; type `show c' for details.\n"
+"\n"
+"The hypothetical commands `show w' and `show c' should show the appropriate\n"
+"parts of the General Public License.  Of course, the commands you use may\n"
+"be called something other than `show w' and `show c'; they could even be\n"
+"mouse-clicks or menu items--whatever suits your program.\n"
+"\n"
+"You should also get your employer (if you work as a programmer) or your\n"
+"school, if any, to sign a \"copyright disclaimer\" for the program, if\n"
+"necessary.  Here is a sample; alter the names:\n"
+"\n"
+"  Yoyodyne, Inc., hereby disclaims all copyright interest in the program\n"
+"  `Gnomovision' (which makes passes at compilers) written by James Hacker.\n"
+"\n"
+"  <signature of Ty Coon>, 1 April 1989\n"
+"  Ty Coon, President of Vice\n"
+"\n"
+"This General Public License does not permit incorporating your program into\n"
+"proprietary programs.  If your program is a subroutine library, you may\n"
+"consider it more useful to permit linking proprietary applications with the\n"
+"library.  If this is what you want to do, use the GNU Library General\n"
+"Public License instead of this License."
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_about.cpp:74
+msgid "http://www.avidemux.org"
+msgstr "http://www.avidemux.org"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_acodec.cpp:138
+msgid "AudioCodec"
+msgstr "Codec audio"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_acodec.cpp:163
+msgid "Configure codec"
+msgstr "Configura codec"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_asharp.cpp:72
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_chromaShift.cpp:72
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_contrast.cpp:74
+msgid "ASHARP"
+msgstr "ASHARP"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_asharp.cpp:185
+msgid "ASharp by MarcFD"
+msgstr "ASharp di MarcFD"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_asharp.cpp:198
+msgid "Threshold :"
+msgstr "Soglia:"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_asharp.cpp:206
+msgid "Strength :"
+msgstr "Forza:"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_asharp.cpp:214
+msgid "Block Adaptative :"
+msgstr "Blocco adattativo:"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_asharp.cpp:222
+msgid "Unknown flag :"
+msgstr "Flag sconosciuta:"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_asharp.cpp:254
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_ocr.cpp:208
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_ocr.cpp:271
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_properties.cpp:262
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_properties.cpp:283
+msgid " "
+msgstr " "
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_busy.cpp:120
+msgid "Busy"
+msgstr "Occupato"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp:401
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:987
+msgid "Calculator"
+msgstr "Calcola bitrate"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp:414
+msgid "<b>Target</b>"
+msgstr "<b>Obiettivo</b>"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp:441
+msgid "Duration:"
+msgstr "Durata:"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp:447
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp:802
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_idx_pg.cpp:198
+msgid "00:00:00"
+msgstr "00:00:00"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp:461
+msgid "_Medium:"
+msgstr "_Supporto:"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp:472
+msgid "_Format:"
+msgstr "_Formato:"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp:483
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp:541
+msgid "Total size (custom)"
+msgstr "Dimensione totale (personalizzata)"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp:493
+msgid "_Custom size (MB):"
+msgstr "Dimensione _Personalizzata (MB):"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp:507
+msgid "Output container format"
+msgstr "Formato contenitore"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp:534
+msgid "Total size"
+msgstr "Dimensione totale"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp:538
+msgid "1x 80 min. CD"
+msgstr "1 CD x 80 min."
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp:543
+msgid "2x 80 min. CD"
+msgstr "2 CD x 80 min."
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp:547
+msgid "1x 74 min. CD"
+msgstr "1 CD x 74 min."
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp:551
+msgid "2x 74 min. CD"
+msgstr "2 CD x 74 min."
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp:555
+msgid "DVD5"
+msgstr "DVD5"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp:559
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:808
+msgid "Custom"
+msgstr "Personalizzata"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp:571
+msgid "Track _1:"
+msgstr "Traccia _1:"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp:579
+msgid "Audio bitrate in kb/s for track 1 (0 for no audio)"
+msgstr "Bitrate audio in kb/s per la traccia 1 (0 = nessun audio)"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp:586
+msgid "Track _2: "
+msgstr "Traccia _2:"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp:594
+msgid "Audio bitrate in kb/s for track 2 (optional)"
+msgstr "Bitrate audio in kb/s per la traccia 2 (opzionale)"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp:598
+msgid "<b>Audio Bitrate</b>"
+msgstr "<b>Bitrate audio</b>"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp:624
+msgid "Audio size (MB):"
+msgstr "Dimensione audio (MB):"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp:640
+msgid "Video size (MB):"
+msgstr "Dimensione video (MB):"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp:656
+msgid "Total size (MB):"
+msgstr "Dimensione totale (MB):"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp:678
+msgid "Video bitrate:"
+msgstr "Bitrate video:"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp:686
+msgid "Bits per pixel:"
+msgstr "Numero di bit per pixel:"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp:702
+msgid "0.0"
+msgstr "0.0"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp:710
+msgid "<b>Result</b>"
+msgstr "<b>Risultato</b>"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_chromaShift.cpp:189
+msgid "ChromaShift"
+msgstr "ChromaShift"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_chromaShift.cpp:203
+msgid "U Shift :"
+msgstr "U Shift :"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_chromaShift.cpp:210
+msgid "V Shift :"
+msgstr "V Shift :"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_chromaShift.cpp:252
+msgid "<b>Preview</b>"
+msgstr "<b>Anteprima</b>"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_cnr2.cpp:137
+msgid "Chroma Noise Reduction 2"
+msgstr "Riduzione interferenza croma 2"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_cnr2.cpp:162
+msgid "<b>Scene change Treshold</b>"
+msgstr "<b>Soglia cambiamento di scena</b>"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_cnr2.cpp:181
+msgid "Sensibility"
+msgstr "Sensibilit?"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_cnr2.cpp:189
+msgid "Max"
+msgstr "Max"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_cnr2.cpp:204
+msgid "Luma :"
+msgstr "Luma :"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_cnr2.cpp:211
+msgid "Chroma U :"
+msgstr "Croma U :"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_cnr2.cpp:218
+msgid "Chroma V :"
+msgstr "Croma V :"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_cnr2.cpp:261
+msgid "Narrow"
+msgstr "Stretta"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_cnr2.cpp:286
+msgid "<b>Settings</b>"
+msgstr "<b>Impostazioni</b>"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_cnr2.cpp:305
+msgid "Use also chroma to detect scene change"
+msgstr "Usa croma per rilevare cambiamenti di scena"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_cnr2.cpp:309
+msgid "<b>Mode</b>"
+msgstr "<b>Modalit?</b>"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_coloryuv.cpp:155
+msgid "ColorYuv (From avisynth)"
+msgstr "ColorYuv (da Avisynth)"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_coloryuv.cpp:179
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_contrast.cpp:197
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_contrast.cpp:215
+msgid "Contrast"
+msgstr "Contrasto"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_coloryuv.cpp:186
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_contrast.cpp:224
+msgid "Brightness"
+msgstr "Luminosit?"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_coloryuv.cpp:193
+msgid "Gamma"
+msgstr "Gamma"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_coloryuv.cpp:207
+msgid "Luma Y"
+msgstr "Luma Y"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_coloryuv.cpp:214
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_contrast.cpp:242
+msgid "Chroma U"
+msgstr "Croma U"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_coloryuv.cpp:221
+msgid "Chroma V"
+msgstr "Croma V"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_coloryuv.cpp:324
+msgid "<b>Color Correction Matrix</b>"
+msgstr "<b>Matrice correzione colore</b>"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_coloryuv.cpp:347
+msgid "Matrix"
+msgstr "Matrice"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_coloryuv.cpp:354
+msgid "Opt"
+msgstr "Opt"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_coloryuv.cpp:361
+msgid "Level"
+msgstr "Livello"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_coloryuv.cpp:374
+msgid "Rec.709"
+msgstr "Rec.709"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_coloryuv.cpp:382
+msgid "Coring"
+msgstr "Coring"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_coloryuv.cpp:390
+msgid "TV->PC"
+msgstr "TV->PC"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_coloryuv.cpp:391
+msgid "PC->TV"
+msgstr "PC->TV"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_coloryuv.cpp:392
+msgid "PC->TV.Y"
+msgstr "PC->TV.Y"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_coloryuv.cpp:398
+msgid ""
+"<b>Matrix Warning :</b>\n"
+"all above values are normalized to 256!"
+msgstr ""
+"<b>Problema matrice:</b>\n"
+"tutti i valori precedenti sono normalizzati a 256!"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_coloryuv.cpp:404
+msgid "AutoGain"
+msgstr "AutoGain"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_coloryuv.cpp:408
+msgid "Display Stats"
+msgstr "Mostra statistiche"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_coloryuv.cpp:412
+msgid "AutoWhite"
+msgstr "AutoWhite"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_coloryuv.cpp:416
+msgid "<b>frame2</b>"
+msgstr "<b>fotogramma2</b>"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_contrast.cpp:238
+msgid "Luma"
+msgstr "Luma"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_contrast.cpp:246
+msgid "Chroma v"
+msgstr "Croma V"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_crop.cpp:263
+msgid "Crop Settings"
+msgstr "Impostazioni ritaglio"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_crop.cpp:297
+msgid "AutoCrop"
+msgstr "AutoCrop"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_crop.cpp:319
+msgid "Reset"
+msgstr "Ripristina"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_crop.cpp:328
+msgid "Crop Left :"
+msgstr "Taglia a sinistra:"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_crop.cpp:336
+msgid "Crop Top:"
+msgstr "Taglia in alto:"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_crop.cpp:344
+msgid "Crop Right:"
+msgstr "Taglia a destra:"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_crop.cpp:352
+msgid "Crop Bottom:"
+msgstr "Taglia in basso:"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp:161
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp:183
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_encoding.cpp:53
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_encoding.cpp:71
+msgid "Privileges Required"
+msgstr "Privilegi richiesti"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp:161
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp:183
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_encoding.cpp:53
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_encoding.cpp:71
+msgid "Root privileges are required to perform this operation."
+msgstr "Sono richesti i privilegi di amministratore per eseguire questa operazione."
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp:204
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_encoding.cpp:177
+msgid "Shutting down"
+msgstr "Arresto in corso"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp:381
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_working.cpp:150
+#, c-format
+msgid "%d%%"
+msgstr "%d%%"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp:404
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp:411
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp:418
+#, c-format
+msgid "%lu MB"
+msgstr "%lu MB"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp:514
+msgid "Encoding..."
+msgstr "Codifica in corso..."
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp:545
+msgid "<b>Phase:</b>"
+msgstr "<b>Fase:</b>"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp:560
+msgid "<b>Video Codec:</b>"
+msgstr "<b>Codec video:</b>"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp:575
+msgid "<b>Audio Codec:</b>"
+msgstr "<b>Codec audio:</b>"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp:590
+msgid "<b>Container:</b>"
+msgstr "<b>Contenitore:</b>"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp:622
+msgid "<b>Processed Frames:</b>"
+msgstr "<b>Fotogrammi elaborati:</b>"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp:630
+msgid "<b>Total Frames:</b>"
+msgstr "<b>Totale fotogrammi:</b>"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp:638
+msgid "<b>Quantiser:</b>"
+msgstr "<b>Quantizzatore:</b>"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp:646
+msgid "<b>Average Bitrate:</b>"
+msgstr "<b>Bitrate medio:</b>"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp:654
+msgid "0 kB/s"
+msgstr "0 kB/s"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp:699
+msgid "<b>Video Size:</b>"
+msgstr "<b>Dimensione video:</b>"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp:707
+msgid "<b>Audio Size:</b>"
+msgstr "<b>Dimensione audio:</b>"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp:715
+msgid "<b>Total Size:</b>"
+msgstr "<b>Dimensione totale:</b>"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp:723
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp:731
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp:739
+msgid "0 MB"
+msgstr "0 MB"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp:764
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_working.cpp:244
+msgid "<b>Elapsed:</b>"
+msgstr "<b>Tempo trascorso:</b>"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp:772
+msgid "<b>Time Remaining:</b>"
+msgstr "<b>Tempo rimanente:</b>"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp:780
+msgid "<b>Frames/sec:</b>"
+msgstr "<b>Fotogrammi/sec:</b>"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp:826
+msgid "Shut down computer when finished"
+msgstr "Arresta il sistema al termine"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp:834
+msgid "Priority:"
+msgstr "Priorit?:"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp:844
+msgid "Above Normal"
+msgstr "Al di sopra del normale"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp:846
+msgid "Below Normal"
+msgstr "Al di sotto del normale"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp:884
+msgid "Pause / Abort"
+msgstr "Pausa / Annulla"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_eq2.cpp:330
+msgid "MPlayer eq2"
+msgstr "MPlayer eq2"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_eq2.cpp:356
+msgid "Brigh_tness:"
+msgstr "Luminosi_t?:"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_eq2.cpp:364
+msgid "_Saturation:"
+msgstr "_Saturazione:"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_eq2.cpp:399
+msgid "_Contrast:"
+msgstr "_Contrasto:"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_eq2.cpp:425
+msgid "_Initial:"
+msgstr "_Iniziale:"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_eq2.cpp:451
+msgid "_Red:"
+msgstr "_Rosso:"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_eq2.cpp:468
+msgid "_Green:"
+msgstr "_Verde:"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_eq2.cpp:476
+msgid "_Blue:"
+msgstr "_Blu:"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_eq2.cpp:484
+msgid "_Weight:"
+msgstr "_Peso:"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_eq2.cpp:510
+msgid "<b>Gamma</b>"
+msgstr "<b>Gamma</b>"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_equalizer.cpp:433
+msgid "Equalizer"
+msgstr "Equalizzatore"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_exLame.cpp:80
+msgid "Lame command"
+msgstr "Comando Lame"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_exLame.cpp:89
+msgid "Enter parameters (i.e. -b 192 -m s ...)"
+msgstr "Immetti parametri (es. -b 192 -ms ...)"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_hue.cpp:84
+msgid "Hue"
+msgstr "Tonalit?"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_hue.cpp:184
+msgid "Hue/Saturation"
+msgstr "Tonalit?/Saturazione"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_hue.cpp:198
+msgid "<b>Hue:</b>"
+msgstr "<b>Tonalit?:</b>"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_hue.cpp:206
+msgid "<b>Saturation:</b>"
+msgstr "<b>Saturazione:</b>"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_idx_pg.cpp:51
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/T_index_pg.cpp:142
+msgid "Continue indexing"
+msgstr "Continua indicizzazione"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_idx_pg.cpp:51
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/T_index_pg.cpp:142
+msgid "Abort Requested"
+msgstr "Annulla richesti"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_idx_pg.cpp:51
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/T_index_pg.cpp:142
+msgid "Do you want to abort indexing ?"
+msgstr "Vuoi annullare l'indicizzazione?"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_idx_pg.cpp:153
+msgid "Indexing..."
+msgstr "Indicizzazione in corso..."
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_idx_pg.cpp:174
+msgid "Time left :"
+msgstr "Tempo rimanente:"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_idx_pg.cpp:182
+msgid "Timecode :"
+msgstr "Timecode :"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_idx_pg.cpp:190
+msgid "Nb pictures seen :"
+msgstr "Numero di immagini trovate:"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_idx_pg.cpp:214
+msgid "Indexing :"
+msgstr "Indicizzazione:"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_idx_pg.cpp:222
+msgid "/dev/null"
+msgstr "/dev/null"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_jobs.cpp:25
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_jobs.cpp:26
+msgid "Ready"
+msgstr "Pronto"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_jobs.cpp:25
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_jobs.cpp:26
+msgid "Succeeded"
+msgstr "Riuscito"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_jobs.cpp:25
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_jobs.cpp:26
+#: avidemux/gtk_gui.cpp:2275
+msgid "Failed"
+msgstr "Fallito"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_jobs.cpp:25
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_jobs.cpp:26
+msgid "Deleted"
+msgstr "Eliminato"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_jobs.cpp:25
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_jobs.cpp:26
+msgid "Running"
+msgstr "In corso"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_jobs.cpp:98
+msgid "  Job Name  "
+msgstr "  Nome attivit?"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_jobs.cpp:103
+msgid "Started at"
+msgstr "Iniziato"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_jobs.cpp:107
+msgid "Finished at"
+msgstr "Finito"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_jobs.cpp:134
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_jobs.cpp:172
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_jobs.cpp:183
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_jobs.cpp:196
+msgid "Sure!"
+msgstr "Sicuro!"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_jobs.cpp:134
+msgid "Delete ALL jobs"
+msgstr "Elimina TUTTE le attivit?"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_jobs.cpp:134
+msgid "Are you sure you want to delete all jobs ?"
+msgstr "Sei sicuro di voler eliminare tutte le attivit??"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_jobs.cpp:172
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_jobs.cpp:183
+msgid "Delete job"
+msgstr "Elimina attivit?"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_jobs.cpp:172
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_jobs.cpp:183
+#, c-format
+msgid "Are you sure you want to delete %s job ?"
+msgstr "Sei sicuro di voler eliminare l'attivit? %s?"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_jobs.cpp:181
+msgid "Unknown event"
+msgstr "Evento sconosciuto"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_jobs.cpp:261
+msgid "Jobs"
+msgstr "Attivit?"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_jobs.cpp:287
+msgid "Delete All Jobs"
+msgstr "Elimina tutte le attivit?"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_jobs.cpp:292
+msgid "Delete Job"
+msgstr "Elimina attivit?"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_jobs.cpp:297
+msgid "Run all jobs"
+msgstr "Esegui tutte le attivit?"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_jobs.cpp:302
+msgid "Run Job"
+msgstr "Esegui attivit?"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_jobs_save.cpp:49
+msgid "Select Video to Write"
+msgstr "Seleziona il video da scrivere"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_jobs_save.cpp:63
+msgid "Invalid filename"
+msgstr "Nome file non valido"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_jobs_save.cpp:63
+msgid "Please select or enter a valid filename."
+msgstr "Seleziona o inserisci un nome file valido."
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_jobs_save.cpp:69
+msgid "Invalid jobname"
+msgstr "Nome attivit? non valido"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_jobs_save.cpp:69
+msgid "Please select or enter a valid jobname."
+msgstr "Seleziona o inserisci un nome attivit? valido."
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_jobs_save.cpp:110
+msgid "Save Job"
+msgstr "Salva attivit?"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_jobs_save.cpp:131
+msgid "Select the output file"
+msgstr "Seleziona il file di uscita"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_jobs_save.cpp:145
+msgid "_Browse..."
+msgstr "_Cerca..."
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_jobs_save.cpp:154
+msgid "Job name displayed in the job list and used as the script filename"
+msgstr "Nome attivit? visualizzato nella lista attivit? e usato come nome del file script"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_jobs_save.cpp:163
+msgid "Filename of the audio/video output"
+msgstr "Nome del file audio/video in uscita"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_jobs_save.cpp:166
+msgid "_Job name:"
+msgstr "_Nome attivit?:"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_jobs_save.cpp:173
+msgid "Output _file:"
+msgstr "_File in uscita:"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_mpdelogo.cpp:356
+msgid "Mplayer Delogo"
+msgstr "Mplayer Delogo"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_mpdelogo.cpp:374
+msgid "X"
+msgstr "X"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_mpdelogo.cpp:381
+msgid "Y"
+msgstr "Y"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_mpdelogo.cpp:388
+msgid "W"
+msgstr "W"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_mpdelogo.cpp:395
+msgid "H"
+msgstr "H"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_mpdelogo.cpp:402
+msgid "Band"
+msgstr "Band"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_ocr.cpp:85
+msgid "Mini OCR"
+msgstr "Mini OCR"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_ocr.cpp:118
+msgid "<b>Glyphs</b>"
+msgstr "<b>Glyphs</b>"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_ocr.cpp:132
+msgid "# of Glyphs :"
+msgstr "Numero di Glyphs :"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_ocr.cpp:140
+msgid "# of lines"
+msgstr "Numero di linee"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_ocr.cpp:164
+msgid "<b>Stats</b>"
+msgstr "<b>Statistiche</b>"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_ocr.cpp:186
+msgid "  "
+msgstr "  "
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_ocr.cpp:195
+msgid "VobSub"
+msgstr "VobSub"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_ocr.cpp:217
+msgid "Output Srt"
+msgstr "Output Srt"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_ocr.cpp:222
+msgid "<b>Files</b>"
+msgstr "<b>File</b>"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_ocr.cpp:228
+msgid "StartOcr"
+msgstr "StartOcr"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_ocr.cpp:249
+msgid "Current Glyph"
+msgstr "Glyph corrente"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_ocr.cpp:263
+msgid " Text:"
+msgstr "Testo:"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_ocr.cpp:287
+msgid "Calibrate"
+msgstr "Calibra"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_ocr.cpp:292
+msgid "Skip all"
+msgstr "Salta tutti"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_ocr.cpp:297
+msgid "Skip Glyph"
+msgstr "Salta Glyph"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_ocr.cpp:302
+msgid "Ignore glyph"
+msgstr "Ignora glyph"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_ocr.cpp:307
+msgid "Ok"
+msgstr "Ok"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_ocr.cpp:316
+msgid "<b>Bitmap</b>"
+msgstr "<b>Bitmap</b>"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_partial.cpp:123
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_filters/gui_filtersub.cpp:144
+msgid "Partial"
+msgstr "Parziale"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_partial.cpp:137
+msgid "Start frame for partial :"
+msgstr "Fotogramma di inizio per parziale:"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_partial.cpp:144
+msgid "End frame for partial :"
+msgstr "Fotogramma di fine per parziale:"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_partial.cpp:167
+msgid "Configure partialized filter"
+msgstr "Configura filtro parzializzato"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_pause.cpp:93
+msgid "Paused"
+msgstr "In pausa"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_pause.cpp:109
+msgid ""
+"<b>Encoding is paused.</b>\n"
+"\n"
+"You can either resume or Abort it."
+msgstr ""
+"<b>La codifica ? in pausa.</b>\n"
+"\n"
+"Puoi ripristinarla o annullarla."
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_pause.cpp:136
+msgid "Abort"
+msgstr "Annulla"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_pause.cpp:158
+msgid "Resume"
+msgstr "Ripristina"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_pipe.cpp:95
+msgid "Pipe to"
+msgstr "Invia a"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_pipe.cpp:104
+msgid "Application path/name (/usr/bin/sox...)"
+msgstr "Percorso/nome applicazione (/usr/bin/sox...)"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_pipe.cpp:113
+msgid "Full parameter line"
+msgstr "Linea parametri completa"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_preview.cpp:280
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_filters/gui_filtersub.cpp:150
+msgid "Preview"
+msgstr "Anteprima"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_preview.cpp:316
+msgid "Stack Field"
+msgstr "Impila campi"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_properties.cpp:47
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_props.cpp:26
+msgid "No"
+msgstr "No"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_properties.cpp:47
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_props.cpp:26
+msgid "Yes"
+msgstr "S?"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_properties.cpp:67
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_props.cpp:69
+#, c-format
+msgid "%lu x %lu"
+msgstr "%lu x %lu"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_properties.cpp:70
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_props.cpp:70
+#, c-format
+msgid "%2.3f fps"
+msgstr "%2.3f fps"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_properties.cpp:73
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_props.cpp:71
+#, c-format
+msgid "%ld frames"
+msgstr "%ld fotogrammi"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_properties.cpp:83
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_properties.cpp:133
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_props.cpp:77
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_props.cpp:125
+#, c-format
+msgid "%02d:%02d:%02d.%03d"
+msgstr "%02d:%02d:%02d.%03d"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_properties.cpp:96
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_props.cpp:83
+#, c-format
+msgid "%s (%u:%u)"
+msgstr "%s (%u:%u)"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_properties.cpp:118
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_props.cpp:109
+#, c-format
+msgid "%lu Hz"
+msgstr "%lu Hz"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_properties.cpp:120
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_props.cpp:110
+#, c-format
+msgid "%lu Bps / %lu kbps"
+msgstr "%lu Bps / %lu kbps"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_properties.cpp:136
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_props.cpp:128
+#, c-format
+msgid "%.2f MB"
+msgstr "%.2f MB"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_properties.cpp:205
+msgid "Properties"
+msgstr "Propriet?"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_properties.cpp:234
+msgid "Frame Rate:"
+msgstr "Frame rate:"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_properties.cpp:241
+msgid "Frame Count:"
+msgstr "Conteggio fotogrammi:"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_properties.cpp:248
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_properties.cpp:426
+msgid "Total Duration:"
+msgstr "Durata totale:"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_properties.cpp:269
+msgid "Image Size:"
+msgstr "Dimensioni immagine:"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_properties.cpp:290
+msgid "Codec 4CC:"
+msgstr "Codec 4CC:"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_properties.cpp:304
+msgid "Aspect Ratio:"
+msgstr "Proporzioni:"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_properties.cpp:318
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1026
+msgid "<b>Video</b>"
+msgstr "<b>Video</b>"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_properties.cpp:337
+msgid "Global Motion Compensation:"
+msgstr "Compensazione movimento globale:"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_properties.cpp:351
+msgid "Packed Bitstream:"
+msgstr "Flusso di bit compresso:"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_properties.cpp:365
+msgid "Quarter Pixel:"
+msgstr "Quarter pixel:"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_properties.cpp:379
+msgid "<b>Extra Video Properties</b>"
+msgstr "<b>Propriet? video supplementari</b>"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_properties.cpp:398
+msgid "Codec:"
+msgstr "Codec:"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_properties.cpp:405
+msgid "Channels:"
+msgstr "Canali:"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_properties.cpp:412
+msgid "Bitrate:"
+msgstr "Bitrate:"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_properties.cpp:419
+msgid "Frequency:"
+msgstr "Frequenza:"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_properties.cpp:468
+msgid "File Size:"
+msgstr "Dimensione file:"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_properties.cpp:482
+msgid "Variable Bitrate:"
+msgstr "Bitrate variabile:"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_properties.cpp:496
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1066
+msgid "<b>Audio</b>"
+msgstr "<b>Audio</b>"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_quota.cpp:90
+msgid "Filesystem full / quota exceeded"
+msgstr "File system pieno / quota oltrepassata"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_quota.cpp:133
+msgid "Ignore"
+msgstr "Ignora"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_quota.cpp:155
+msgid "Retry"
+msgstr "Riprova"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_recent.cpp:96
+msgid "Recent files"
+msgstr "File recenti"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_resize.cpp:312
+msgid "Resize"
+msgstr "Ridimensiona"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_resize.cpp:326
+msgid " Width "
+msgstr " Larghezza"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_resize.cpp:333
+msgid " Height "
+msgstr " Altezza"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_resize.cpp:356
+msgid "Source :"
+msgstr "Sorgente:"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_resize.cpp:362
+msgid "Destination"
+msgstr "Destinazione"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_resize.cpp:412
+msgid " Error X:"
+msgstr " Errore X:"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_resize.cpp:426
+msgid " Error Y:"
+msgstr " Errore Y:"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_resize.cpp:440
+msgid "16 round up"
+msgstr "Arrotonda a 16"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_resize.cpp:454
+msgid "Bilinear"
+msgstr "Bilineare"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_resize.cpp:458
+msgid "Bicubic"
+msgstr "Bicubica"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_resize.cpp:462
+msgid "Lanczos3"
+msgstr "Lanczos3"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_srt.cpp:92
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_srt.cpp:224
+msgid "Subtitle Size and Position"
+msgstr "Dimensione e posizione sottotitoli"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_srt.cpp:238
+msgid "Font Size:"
+msgstr "Dimensione carattere:"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_vcodec.cpp:104
+msgid "Video encoder"
+msgstr "Codificatore video"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_vcodec.cpp:118
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1046
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1086
+msgid "Configure"
+msgstr "Configura"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_vobsub.cpp:98
+msgid "Select .idx file"
+msgstr "Seleziona un file .idx"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_vobsub.cpp:196
+msgid "VobSub Settings"
+msgstr "Impostazioni VobSub"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_vobsub.cpp:213
+msgid "Select .idx"
+msgstr "Seleziona .idx"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_vobsub.cpp:227
+msgid "Select Language :"
+msgstr "Seleziona Lingua:"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_vobsub.cpp:241
+msgid "Select Sub"
+msgstr "Seleziona sottotitolo"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_vobsub.cpp:254
+msgid "Extra Shrink Factor :"
+msgstr "Fattore di compressione supplementare:"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_vobsub.cpp:269
+msgid "Shift (ms) :"
+msgstr "Ritarda (ms):"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_vobsub.cpp:283
+msgid "Extra Settings"
+msgstr "Impostazioni supplementari"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_working.cpp:223
+msgid "Processing"
+msgstr "Elaborazione in corso"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_working.cpp:259
+msgid "<b>Time remaining:</b>"
+msgstr "<b>Tempo rimanente:</b>"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:560
+msgid "X264 configuration"
+msgstr "Configurazione X264"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:575
+msgid "Encoding Mode:"
+msgstr "Modalit? di codifica:"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:587
+msgid "Entry input for target file size or bitrate"
+msgstr "Input per la dimensione o il bitrate del file"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:589
+msgid "Quantizer (0-51):"
+msgstr "Quantizzatore (0-51):"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:602
+msgid "Constant Quantizer - Each frame will the same compression. Low numbers equal higher quality while high numbers equal lower quality"
+msgstr "Quantizzatore costante - Ogni fotogramma avr? la stessa compressione. A valori minori corrisponde una maggiore qualit?, a valori maggiori una qualit? minore"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:612
+msgid "Target Size:"
+msgstr "Dimensione finale:"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:624
+msgid "Single Pass - Quality Quantizer (Average)"
+msgstr "Passata singola - Quantizzatore qualit? (media)"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:625
+msgid "Single Pass - Quality Quantizer (Constant)"
+msgstr "Passata singola - Quantizzatore qualit? (costante)"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:626
+msgid "Single Pass - Bitrate (Average)"
+msgstr "Passata singola - Bitrate (medio)"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:627
+msgid "Two Pass - File Size"
+msgstr "Due passate - Dimensione file"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:628
+msgid "Two Pass - Average bitrate"
+msgstr "Due passate - Bitrate medio"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:630
+msgid "Bitrate"
+msgstr "Bitrate"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:656
+msgid "Partition decision"
+msgstr "Decisione partizione"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:663
+msgid "Method"
+msgstr "Metodo"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:675
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_srt.cpp:61
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_x264.cpp:58
+msgid "1  - Extremely Low (Fastest)"
+msgstr "1  - Estremamente bassa (pi? veloce)"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:676
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_srt.cpp:62
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_x264.cpp:59
+msgid "2  - Very Low"
+msgstr "2  - Molto bassa"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:677
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_srt.cpp:63
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_x264.cpp:60
+msgid "3  - Low"
+msgstr "3  - Bassa"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:678
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_srt.cpp:64
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_x264.cpp:61
+msgid "4  - Medium"
+msgstr "4  - Media"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:679
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_srt.cpp:65
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_x264.cpp:62
+msgid "5  - High (Default)"
+msgstr "5  - Alta (predefinito)"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:680
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_srt.cpp:66
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_x264.cpp:63
+msgid "6  - Very High"
+msgstr "6  - Molto alta"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:681
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_srt.cpp:67
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_x264.cpp:64
+msgid "6B - Very High (RDO on Bframes)"
+msgstr "6B - Molto alta (RDO sui fotogrammi-B)"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:682
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_srt.cpp:68
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_x264.cpp:65
+msgid "7 - Ultra High"
+msgstr "7  - Ultra"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:683
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_srt.cpp:69
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_x264.cpp:66
+msgid "7B - Ultra High (RDO on Bframes)"
+msgstr "7B - Ultra (RDO sui fotogrammi-B)"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:690
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_srt.cpp:75
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_x264.cpp:72
+msgid "Diamond search"
+msgstr "Ricerca romboidale"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:691
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_srt.cpp:76
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_x264.cpp:73
+msgid "Hexagonal search"
+msgstr "Ricerca esagonale"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:692
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_srt.cpp:77
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_x264.cpp:74
+msgid "Uneven multi hexagon"
+msgstr "Multi esagono irregolare"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:693
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_srt.cpp:78
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_x264.cpp:75
+msgid "Exhaustive search"
+msgstr "Ricerca esaustiva"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:705
+msgid "Set how many previous frames can be referenced by a P/B-frame. Numbers above 5 do not seem to improve quality greatly. Numbers are 3 to 5 are recommended"
+msgstr "Imposta a quanti fotorammi precedenti pu? riferirsi un fotogramma-P/B. Valori superiori a 5 non sembrano migliorare molto la qualit?. Sono consigliati i valori da 3 a 5"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:708
+msgid "Max. Ref. frames"
+msgstr "Numero massimo di fotogrammi di riferimento"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:715
+msgid "Range"
+msgstr "Intervallo"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:728
+msgid "Define how many pixels are analysised. The higher the range the more accurate the analysis but the slower the encoding time"
+msgstr "Definisci il numero di pixel da analizzare. Maggiore ? l'intervallo, pi? accurata ? l'analisi, ma pi? lenta ? la codifica"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:731
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_srt.cpp:83
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_x264.cpp:80
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_xvid4.cpp:89
+msgid "Chroma ME"
+msgstr "Croma ME"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:736
+msgid "Uses chroma (color) components for motion for compression and helps the quality"
+msgstr "Usa i componenti croma (colore) per la compressione del movimento e migliora laqualit?"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:739
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_srt.cpp:84
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_x264.cpp:81
+msgid "Mixed Refs"
+msgstr "Mixed Refs"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:744
+msgid "Calculate referencing individually based on each partition"
+msgstr "Calcola i riferimenti basati individualmente su ogni partizione"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:750
+msgid "Fast P-Skip"
+msgstr "P-Skip veloce"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:753
+msgid "Uncheck to enable fast p-skip"
+msgstr "Seleziona per attivare il p-skip veloce"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:756
+msgid "DCT decimate"
+msgstr "DCT decimate"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:760
+msgid "Interlace"
+msgstr "Interlaccia"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:763
+msgid "Encode interlaced"
+msgstr "Codifica interlacciata"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:765
+msgid "<b>Motion Estimation</b>"
+msgstr "<b>Valutazione movimento</b>"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:792
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:804
+msgid "Enforce the size of a decoded pixel decoded to a certain value. Leave this at 1:1 for non-anamorphic video"
+msgstr "Forza le dimensioni di un pixel decodificato a un certo valore. Lasciare su 1:1 per un video non anamorfico"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:796
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:1051
+msgid ":"
+msgstr ":"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:813
+msgid "Set a custom aspect ratio. Default 1:1 is recommended for most video."
+msgstr "Imposta proporzioni personalizzate. 1:1 (predefinito) ? raccomandato per la maggior parte dei video."
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:818
+msgid "Predefined Aspect Ratios"
+msgstr "Proporzioni predefinite"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:823
+msgid "Set a common predefined aspect ratio"
+msgstr "Imposta proporzioni comuni predefinite"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:827
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:1040
+msgid "As input"
+msgstr "Come in ingresso"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:832
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:1043
+msgid "Get PAR from input video file"
+msgstr "Recupera proporzioni dal video in ingresso"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:856
+msgid "<b>Sample Aspect Ratio (A/R)</b>"
+msgstr "<b>Campionamento proporzioni (A/R)</b>"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:878
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_srt.cpp:111
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_x264.cpp:108
+msgid "CABAC"
+msgstr "CABAC"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:881
+msgid "Lossless compression method which usually improves the bitrate usage by 15% (especially on high bitrate). Helps the quality a lot but is slower. "
+msgstr "Metodo di copressione senza perdita di qualit? che migliora l'uso del bitrate del 15% (specialmente ad alti bitrate). Migliora molto la qualit? ma ? pi? lento."
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:884
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_srt.cpp:110
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_x264.cpp:107
+msgid "Trellis"
+msgstr "Trellis"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:893
+msgid "Use rate distortion quantization to find optimal encoding for each block. Level 0 equals disabled, level 1 equals normal and level 2 equals high"
+msgstr "Usa quantizzazione di distorsione bitrate per trovare la codifica ottimale per ogni blocco. 0 significa disattivata, 1 normale e 2 alta"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:900
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_srt.cpp:112
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_x264.cpp:109
+msgid "Noise Reduction"
+msgstr "Riduzione interferenza"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:909
+msgid "Set the amount of noise reduction"
+msgstr "Imposta il livello di riduzione interferenza"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:916
+msgid "Deblocking Filter :"
+msgstr "Filtro deblocking:"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:919
+msgid "Enable in-loop deblocking to filter the video"
+msgstr "Attiva filtro deblocking in-loop"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:932
+msgid "Set the amount of blurring to use for block edges when they are found"
+msgstr "Imposta il valore della sfuocatura da usare per i bordi dei blocchi trovati"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:941
+msgid "Define the level for when deblocking is applied"
+msgstr "Definisci il livello di deblocking quando applicato"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:944
+msgid "<i>Threshold</i>"
+msgstr "<i>Soglia</i>"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:952
+msgid "<i>Strength</i>"
+msgstr "<i>Forza</i>"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:960
+msgid "<b>Misc. Options</b>"
+msgstr "<b>Opzioni varie</b>"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:965
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:1066
+msgid "Motion & Misc"
+msgstr "Movimento e varie"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:986
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_srt.cpp:132
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_x264.cpp:129
+msgid "8x8 Transform"
+msgstr "Trasforma 8x8"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:989
+msgid "General block breakdown transformation"
+msgstr "Trasformazione per la ripartizione generale dei blocchi"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:992
+msgid "8x8, 8x16 and 16x8 P-frame search"
+msgstr "Ricerca fotogrammi-P 8x8, 8x16 e 16x8"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:995
+msgid "Improve the P-frame quality"
+msgstr "Migliora la qualit? dei fotogrammi-P"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:998
+msgid "8x8, 8x16 and 16x8 B-frame search"
+msgstr "Ricerca fotogrammi-B 8x8, 8x16 e 16x8"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1001
+msgid "Improve the B-frame quality"
+msgstr "Migliora la qualit? dei fotogrammi-B"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1004
+msgid "4x4, 4x8 and 8x4 P-frame search"
+msgstr "Ricerca fotogrammi-P 4x4, 4x8 e 8x4"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1007
+msgid "Further improve the P-frame quality"
+msgstr "Migliora ulteriormente la qualit? dei fotogrammi-P"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1009
+msgid "8x8 Intra search"
+msgstr "Ricerca Intra 8x8"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1012
+msgid "Enable DCT Intra block search to improve quality"
+msgstr "Attiva ricerca blocchi DCT Intra per migliorare la qualit?"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1015
+msgid "4x4 Intra search"
+msgstr "Ricerca Intra 4x4"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1018
+msgid "Further enable DCT Intra block search to improve quality"
+msgstr "Attiva ricerca blocchi DCT Intra per migliorare ulteriormente la qualit?"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1021
+msgid "<b>Partition Macroblocks</b>"
+msgstr "<b>Partizione Macroblock</b>"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1043
+msgid "Bias"
+msgstr "Polarizzazione"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1056
+msgid "Increase / decrease probability for how often B-frames are used. Will not violate the maximum consecutive frame limit"
+msgstr "Aumenta / diminuisce la probabilit? di utilizzo dei fotogrammi-B. Non superer? il limite massimo di fotogrammi consecutivi"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1065
+msgid "Set the maximum number of consecutive B-frames. This defines how many duplicate frames can be droped. Numbers 2 to 5 are recommended. This greatly improves the use of bitrate and quality"
+msgstr "Imposta il massimo numero di fotogrammi-B consecutivi. Questa opzione definisce quanti fotogrammi duplicati possono essere eliminati. Sono consigliati i valori da 2 a 5. Migliora molto l'uso del bitrate e la qualit?"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1068
+msgid "Max Consecutive"
+msgstr "Max consecutivi"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1079
+msgid "Bidirectional ME"
+msgstr "Stima movimento bidirezionale"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1084
+msgid "Jointly optimize both Motion Vector's in B-frames. This will improve quality but take more time for encoding"
+msgstr "Ottimizza entrambi i vettori movimento nei fotogrammi-B. Questo migliorer? la qualit? ma richieder? un maggior tempo di codifica"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1086
+msgid "Weighted biprediction"
+msgstr "Previsione ponderata"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1091
+msgid "Enables weighting of B-frames to help fades"
+msgstr "Attiva ponderazione dei fotogrammi-B per migliorare le dissolvenze"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1094
+msgid "Adaptative DCT"
+msgstr "DCT adattativo"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1099
+msgid "Use fewer B-frame if needed. This is always recommended. If not enabled, the codec will always use the maximum number of consecutive B-frames"
+msgstr "Usa meno fotogrammiB se necessario. Sempre consigliato. Se disattivo, il codec user? sempre il numero massimo di fotogrammi-B consecutivi"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1102
+msgid "Use as reference"
+msgstr "Usa come riferimento"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1107
+msgid "Allow B-frames to make references non-linearly to another B-frame (instead of creating a duplicate copy)"
+msgstr "Consenti ai fotogrammi-B di fare riferimento a un altro fotogramma-B in modo non lineare"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1113
+msgid "B-Frame Direct Mode:  "
+msgstr "Modalit? diretta fotorammi-B:"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1121
+msgid "Auto"
+msgstr "Auto"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1122
+msgid "Temporal"
+msgstr "Temporale"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1123
+msgid "Spatial"
+msgstr "Spaziale"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1126
+msgid "<b>B-Frames</b>"
+msgstr "<b>Fotogrammi-B</b>"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1131
+msgid "Partitions & Frames"
+msgstr "Partizioni & Fotogrammi"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1159
+msgid "Set how much \"bitrate bonus\" a keyframe can get"
+msgstr "Imposta quanti \"bonus di bitrate\" pu? avere un fotogramma chiave"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1162
+msgid "Keyframe boost (%)"
+msgstr "Amplifica fotogrammi chiave (%)"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1169
+msgid "B-frame reduction (%)"
+msgstr "Riduzione fotogrammi-B (%)"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1176
+msgid "Bitrate variability (%)"
+msgstr "Variabilit? bitrate (%)"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1189
+msgid "Set how much bitrate is deducted from a B-frame as compared to the previous P-frame"
+msgstr "Imposta quanto bitrate ? dedotto dal fotogramma-B risetto al precedente fotogramma-P"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1198
+msgid "Define how much the bitrate can fluctuate over the entire video. 0% results in a constant bitrate stream, while 100% results in a pure quality based bitrate stream"
+msgstr "Definisci quanto pu? fluttuare il bitrate sull'intero video. 0% significa un flusso a bitrate costante, mentre 100% significa un flusso a bitrate basato sulla qualit?"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1201
+msgid "<b>Bitrate</b>"
+msgstr "<b>Bitrate</b>"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1219
+msgid "Min Qp"
+msgstr "Min Qp"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1226
+msgid "Max Qp"
+msgstr "Max Qp"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1233
+msgid "Max QP Step"
+msgstr "Max QP Step"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1247
+msgid "Enforce a minimum quantizer level"
+msgstr "Imponi un livelo di quantizzatore minimo"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1256
+msgid "Enforce a maximum quantizer level"
+msgstr "Imponi un livelo di quantizzatore massimo"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1265
+msgid "Define how much the quantizer rate can change between two consecutive frames"
+msgstr "Definisci quanto pu? cambiare la quantizzazione tra due fotogrammi consecutivi"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1268
+msgid "<b>Quantization Limits</b>"
+msgstr "<b>Limiti di quantizzazione</b>"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1286
+msgid "Scene Cut Threshold"
+msgstr "Soglia di taglio scene"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1300
+msgid "Increase / decrease sensitivity for detecting Scene Changes to compensate for. Improves I-frame usage and helps quality"
+msgstr "Aumenta / diminuisci la sensibilita per rilevare cambiamenti di scena. Migliora l'uso dei fotogrammi-I e la qualit?"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1303
+msgid "Min IDR frame interval"
+msgstr "Inervallo minimo fotogrammi IDR"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1316
+msgid "Set minimum frame interval between IDR frames. Defines the minimum amount a frame can be reused and referenced by other frames before a new clean one is established"
+msgstr "Imposta l'intervallo minimo tra fotogrammi IDR. Definisce il minimo numero di volte che un fotogramma pu? essere riusato prima che ne sia stabilito uno nuovo"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1325
+msgid "Set maximum frame interval between IDR frames. Defines the maximum amount a frame can be reused and referenced by other frames before a new clean one is established"
+msgstr "Imposta l'intervallo massimo tra fotogrammi IDR. Definisce il massimo numero di volte che un fotogramma pu? essere riusato prima che ne sia stabilito uno nuovo"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1328
+msgid "Max IDR frame interval"
+msgstr "Inervallo massimo fotogrammi IDR"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1335
+msgid "<b>More Rate Settings</b>"
+msgstr "<b>Altre opzioni</b>"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1353
+msgid "VBV buffer size"
+msgstr "Dimensione buffer VBV"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1360
+msgid "Initial VBV buffer (%)"
+msgstr "Buffer VBV iniziale (%)"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1367
+msgid "Maximum local bitrate"
+msgstr "Bitrate locale massimo"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1398
+msgid "<b>Video Buffer Verifier</b>"
+msgstr "<b>Verificatore buffer video</b>"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1430
+msgid "Allowed variance of average bitrate. Lower values mean less variance. Higher values mean more variance."
+msgstr "Varianza consentita del bitrate medio. Valori pi? alti significano maggiore varianza."
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1433
+msgid "Bitrate Variance"
+msgstr "Varianza bitrate"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1446
+msgid "Allowed variance of average quantizer or quality. Lower values mean less variance. Higher values mean more variance. Note that 0 means constant quality while 1 means constant fluctuation. Recommended 0.6."
+msgstr "Varianza consentita della qualit? media. Valori pi? alti significano maggiore varianza. Nota che 0 significa qualit? costante mentre 1 fluttuazione costante. 0,6 consigliato."
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1455
+msgid "Reduced fluctuations in Quantizer (before curve compression)"
+msgstr "Fluttuazioni ridotte nel quantizzatore (prima di compressione curva)"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1464
+msgid "Reduce fluctuations in QP (after curve compression)"
+msgstr "Ridule le fluttuazioni nel QP (dopo compressione curva)"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1467
+msgid "Quantizer Compression"
+msgstr "Compressione quantizzatore"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1474
+msgid "Temp. Blur of est Frame Complexity"
+msgstr "Sfuocatura temp. complessit? fotogramma est"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1481
+msgid "Temp. Blur of Quant after CC"
+msgstr "Sfuocatura temp. quantizzatore dopo CC"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1488
+msgid "<b>Misc</b>"
+msgstr "<b>Varie</b>"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1512
+msgid "Quantization factors used between I- and P- frames"
+msgstr "Fattori di quantizzazione usati tra fotogrammi I e P"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1521
+msgid "Quantization used between P- and B- frames"
+msgstr "Quantizzazione usata tra fotogrammi P e B"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1530
+msgid "Quantization difference between chroma (color) and luma (brightness)"
+msgstr "Differenza di quantizzazione tra croma (colore) e luma (luminost?)"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1533
+msgid "Factor between I and P frame Quants"
+msgstr "Fattori tra quantizzazione fotogrammi I e P"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1540
+msgid "Factor between P and B frame Quants"
+msgstr "Fattori tra quantizzazione fotogrammi P e B"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1547
+msgid "Chroma QP Offset"
+msgstr "Offset Chroma QP"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1554
+msgid "<b>Quantizers</b>"
+msgstr "<b>Quantizzatori</b>"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1572
+msgid "Custom matrix"
+msgstr "Matrice personalizzata"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1581
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:1128
+msgid "Open CQM file"
+msgstr "Apri file CQM"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1587
+msgid "JVT matrix"
+msgstr "Matrice JVT"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1595
+msgid "Flat matrix"
+msgstr "Matrice piana"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1604
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:1136
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:1568
+msgid "Edit Custom Matrix"
+msgstr "Modifica matrice personalizzata"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1609
+msgid "Edit a loaded custom quantization matrix file"
+msgstr "Modifica una matrice di quantizzazione personalizzata"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1617
+msgid "<b>Quantization Matrices</b>"
+msgstr "<b>Quantizzazione matrici</b>"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1622
+msgid "More"
+msgstr "Pi?"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1630
+msgid "Defaults"
+msgstr "Predefiniti"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid.cpp:237
+msgid "Xvid Encoder"
+msgstr "Codificatore Xvid"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid.cpp:250
+msgid "Constant Quantizer"
+msgstr "Quantizzatore costante"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid.cpp:258
+msgid "Constant Bitrate (kbps)"
+msgstr "Bitrate costante (kbps)"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid.cpp:266
+msgid "Dual pass (MBytes)"
+msgstr "Doppia passata (MB)"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid.cpp:292
+msgid "Basic"
+msgstr "Basica"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid.cpp:301
+msgid "Motion Search"
+msgstr "Ricerca movimento"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid.cpp:317
+msgid "Max I frame interval "
+msgstr "Massimo intervallo fotogrammi I"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid.cpp:333
+msgid "Min I frame interval"
+msgstr "Minimo intervallo fotogrammi I"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid.cpp:357
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:884
+msgid "0 - None"
+msgstr "0 - Nessuna"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid.cpp:361
+msgid "1- Very low"
+msgstr "1- Molto bassa"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid.cpp:365
+msgid "2- Low"
+msgstr "2- Bassa"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid.cpp:369
+msgid "3- Medium"
+msgstr "3- Media"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid.cpp:373
+msgid "4- High"
+msgstr "4- Alta"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid.cpp:377
+msgid "5- Very High"
+msgstr "5- Molto alta"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid.cpp:381
+msgid "6- Ultra High"
+msgstr "6- Ultra"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid.cpp:395
+msgid "H263 Quantizer"
+msgstr "Quantizzatore H263"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid.cpp:400
+msgid "MPEG Quantizer"
+msgstr "Quantizzatore MPEG"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid.cpp:407
+msgid "Advanced"
+msgstr "Avanzato"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid.cpp:416
+msgid "Min I Frame Qzer"
+msgstr "Min. quantiz. fotogrammi I"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid.cpp:424
+msgid "Max I Frame Qzer"
+msgstr "Max. quantiz. fotogramma I"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid.cpp:432
+msgid "Min P Frame Qzer"
+msgstr "Min. quantiz. fotogramma P"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid.cpp:440
+msgid "Max P Frame Qzer"
+msgstr "Max. quantiz. fotogramma P"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid.cpp:480
+msgid "Quantizer"
+msgstr "Quantizzatore"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid.cpp:485
+msgid "Not Yet!"
+msgstr "Non ancora!"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid.cpp:490
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_srt.cpp:147
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_x264.cpp:144
+msgid "B Frames"
+msgstr "Fotogrammi B"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:109
+msgid "Select Xvid matrix file to load"
+msgstr "Seleziona la matrice Xvid da caricare"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:121
+msgid "Error Loading"
+msgstr "Errore nel caricamento"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:121
+msgid "Error loadind the custom matrix file."
+msgstr "Errore nel caricamento della matrice personale."
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:139
+msgid "Matrix Loaded"
+msgstr "Matrice caricata"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:139
+msgid "The custom matrix file has been successfully loaded."
+msgstr "La matrice personale ? stata caricata con successo."
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:179
+msgid "Size (MBytes):"
+msgstr "Dimensione (MB):"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:185
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:369
+msgid "Average bitrate (kb/s):"
+msgstr "Bitrate medio (kb/s):"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:354
+msgid "Target bitrate (kb/s):"
+msgstr "Bitrate finale (kb/s):"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:362
+msgid "Target size (MBytes):"
+msgstr "Dimensione finale (MB):"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:479
+msgid "Select Custom Matrix File to write"
+msgstr "Seleziona il file matrice personale da scrivere"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:484
+msgid "Error Writing"
+msgstr "Errore di scrittura"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:484
+msgid "Error writing the custom matrix file."
+msgstr "Errore di scrittura nel file matrice personale."
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:700
+msgid "XviD encoding options"
+msgstr "Opzioni codifica XviD"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:734
+msgid "Encoding type:"
+msgstr "Tipo di codifica:"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:739
+msgid "Bitrate (kb/s):"
+msgstr "Bitrate (kb/s):"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:744
+msgid "Quantizer:"
+msgstr "Quantizzatore:"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:756
+msgid "Select 1-pass or 2-pass encoding"
+msgstr "Seleziona codifica a 1 o a 2 passate"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:760
+msgid "Single pass - bitrate"
+msgstr "Passata singola - bitrate"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:764
+msgid "Single pass - quantizer"
+msgstr "Passata singola - quantizzatore"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:768
+msgid "Two pass, final size"
+msgstr "Due passate, dimensione finale"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:772
+msgid "Two pass, average bitrate"
+msgstr "Due passate, bitrate variabile"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:776
+msgid "Same Qz as input"
+msgstr "Stesso Qz dell'imput"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:785
+msgid "Target video bitrate"
+msgstr "Bitrate video"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:792
+msgid "Constant quantizer - each frame will get the same compression"
+msgstr "Quantizzatore costante - ogni fotogramma avr? la stessa compressione"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:794
+msgid "Variable bitrate mode"
+msgstr "Modalit? bitrate variabile"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:806
+msgid "_Interlaced"
+msgstr "_Interlacciato"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:809
+msgid "Enables interlaced frame support - use only if your source contains interlacing artifacts (i.e. fields instead of progressive frames)"
+msgstr "Attiva supporto fotogrammi interlacciati - solo se la fonte contiene artefatti interlacciati"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:811
+msgid "_Greyscale"
+msgstr "_Scala di grigi"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:814
+msgid "Encode in black & white"
+msgstr "Codifica in bianco e nero"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:820
+msgid "Ca_rtoon mode"
+msgstr "Modalit? Ca_rtoon"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:823
+msgid "Enables special motion estimation features for cartoons/anime"
+msgstr "Attiva valutazione movimento speciale per cartoni animati"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:825
+msgid "C_hroma optimizer"
+msgstr "Ottimizzatore C_hroma"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:828
+msgid "Enables a chroma optimizer prefilter"
+msgstr "Attiva prefiltro ottimizzatore C_roma"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:834
+msgid "Turbo Mode"
+msgstr "Modalit? turbo"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:837
+msgid "Enables fast 1st pass encoding"
+msgstr "Attiva codifica veloce alla prima passata"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:839
+msgid "Packed bitstream"
+msgstr "Flusso di bit compresso"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:842
+msgid "Enables Divx like packed vop, DO NOT SET, it is ugly"
+msgstr "Attiva DivX come vop compressi"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:844
+msgid "Main"
+msgstr "Generale"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:863
+msgid "Motion search precision:"
+msgstr "Precisione ricerca movimento:"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:867
+msgid "VHQ mode:"
+msgstr "Modalit? VHQ:"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:880
+msgid "Higher settings give higher quality results, at the cost of slower encoding"
+msgstr "Impostazioni pi? alte danno migliori risultati, ma richiedono una codifica pi? lenta"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:888
+msgid "1 - Very low"
+msgstr "1 - Molto bassa"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:892
+msgid "2 - Low"
+msgstr "2 - Bassa"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:896
+msgid "3 - Medium"
+msgstr "3 - Media"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:900
+msgid "4 - High"
+msgstr "4 - Alta"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:904
+msgid "5 - Very high"
+msgstr "5 - Molto alta"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:908
+msgid "6 - Ultra high"
+msgstr "6 - Ultra"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:917
+msgid "VHQ enables an additional search process to increase quality"
+msgstr "VHQ attiva un processo di ricerca addizionale per aumentare la qualit?"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:921
+msgid "0 - Off"
+msgstr "0 - Off"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:925
+msgid "1 - Mode decision"
+msgstr "1 - Decisione modalit?"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:929
+msgid "2 - Limited search"
+msgstr "2 - Ricerca limitata"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:933
+msgid "3 - Medium search"
+msgstr "3 - Ricerca media"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:937
+msgid "4 - Wide search"
+msgstr "4 - Ricerca estesa"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:947
+msgid "C_hroma motion"
+msgstr "Movimento C_hroma"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:950
+msgid "Use chroma information to estimate motion"
+msgstr "Usa informazioni cromatiche per calcolare il movimento"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:952
+msgid "_4MV"
+msgstr "_4MV"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:955
+msgid "Use 4 motion vectors per macroblock, might give better compression"
+msgstr "Usa 4 vettori di movimento per macroblock per migliorare la compressione"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:957
+msgid "HQ _AC"
+msgstr "HQ _AC"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:960
+msgid "Enable a better prediction of AC component. Turns on Lumi masking - applies more compression to dark/light areas that the eye cannot notice easily"
+msgstr "Migliora la previsione di componenti AC. Attiva il lumi-masking - applica una maggiore compressione alle zone chiare/scure che l'occhio non nota facilmente"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:966
+msgid "I-frame interval - Min:"
+msgstr "Intervallo I-frame - Min:"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:974
+msgid "Minimum space between I-frames, 1 will disable forced I-frame spacing"
+msgstr "Intervallo minimo tra due fotogrammi chiave, 1 disattiva lo spaziamento forzato tra fotogrammi"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:976
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:1194
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:1199
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:1204
+msgid "Max:"
+msgstr "Max:"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:984
+msgid "Maximum number of frames allowed between I-frames"
+msgstr "Massimo numero di fotogrammi tra due fotogrammi chiave"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:999
+msgid "Number of B-frames:"
+msgstr "Numero di fotogrammi-B:"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:1007
+msgid "Maximum number of sequential B-frames (when set to 0, the original I/P encoder is used)"
+msgstr "Massimo numero di fotogrammi-B sequenziali (se impostato a 0, viene usato  il codificatore I/P originale)"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:1013
+msgid "_Qpel"
+msgstr "_Qpel"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:1016
+msgid "Use Quarter pixel resolution for a more precise motion estimation"
+msgstr "Usa la risoluzione Quarter pixel per una valutazione del movimento pi? precisa"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:1021
+msgid "Global Motion Compensation can save bits on camera pans, zooming and rotation"
+msgstr "La Compensazione del Movimento Globale pu? ridurre i bit su panoramiche, zoom e rotazioni"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:1023
+msgid "_BVHQ"
+msgstr "_BVHQ"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:1026
+msgid "Produces nicer-looking B-frames"
+msgstr "Produce fotogrammi-B migliori"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:1049
+msgid "Pixel Width"
+msgstr "Larghezza pixel"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:1060
+msgid "Pixel Height"
+msgstr "Altezza pixel"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:1061
+msgid "Pixel Aspect Ratio"
+msgstr "Proporzioni pixel"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:1079
+msgid "Quantization type:"
+msgstr "Tipo di quantizzazione:"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:1083
+msgid "_H.263"
+msgstr "_H.263"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:1086
+msgid "H.263 quantizers smooth the picture (useful at lower bitrates)"
+msgstr "I quantizzatori H.263 producono immagini meno precise (utile a bassi bitrate)"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:1090
+msgid "_MPEG"
+msgstr "_MPEG"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:1093
+msgid "MPEG quantizers (slightly slower) produce sharper picture (useful at higher bitrates)"
+msgstr "I quantizzatori MPEG (leggermente pi? lenti) producono immagini pi? nitide (utile a bitrate pi? alti)"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:1097
+msgid "_Custom Matrix"
+msgstr "Matrice _personalizzata"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:1107
+msgid "Load Custom Matrix:  "
+msgstr "Carica matrice personalizzata"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:1153
+msgid "I-frame quantizer - Min:"
+msgstr "Quantizzatore fotogrammi-I - Min:"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:1158
+msgid "P-frame quantizer - Min:"
+msgstr "Quantizzatore fotogrammi-P - Min:"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:1163
+msgid "B-frame quantizer - Min:"
+msgstr "Quantizzatore fotogrammi-B - Min:"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:1176
+msgid "Minimum quantizer allowed for I-frames"
+msgstr "Minimo quantizzatore consentito per fotogrammi-I"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:1182
+msgid "Minimum quantizer allowed for P-frames"
+msgstr "Minimo quantizzatore consentito per fotogrammi-P"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:1188
+msgid "Minimum quantizer allowed for B-frames"
+msgstr "Minimo quantizzatore consentito per fotogrammi-B"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:1217
+msgid "Maximum quantizer allowed for I-frames"
+msgstr "Massimo quantizzatore consentito per fotogrammi-I"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:1223
+msgid "Maximum quantizer allowed for P-frames"
+msgstr "Massimo quantizzatore consentito per fotogrammi-P"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:1229
+msgid "Maximum quantizer allowed for B-frames"
+msgstr "Massimo quantizzatore consentito per fotogrammi-B"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:1231
+msgid "Quantizer restrictions"
+msgstr "Restrizioni quantizzatore"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:1238
+msgid "Rate distortion quantization, will find optimal encoding for each block"
+msgstr "Quantizzatore tasso di distorsione, trova codifica ottimale per ogni blocco"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:1268
+msgid "I-frame boost (%):"
+msgstr "Amplifica fotogrammi-I (%):"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:1273
+msgid "I-frames closer than ... frames..."
+msgstr "Fotogrammi-I pi? vicini di ... fotogrammi..."
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:1278
+msgid "...are reduced by (%):"
+msgstr "...sono ridotti di (%):"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:1283
+msgid "Max overflow improvement (%):"
+msgstr "Aumento massima sovrabbondanza (%):"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:1288
+msgid "Max overflow degradation (%):"
+msgstr "Diminuzione massima sovrabbondanza (%):"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:1300
+#, c-format
+msgid "A value of 20 will give 20% more bits to every I-frame"
+msgstr "Un valore di 20 dar? il 20 percento di bit in pi? a ogni fotogramma I"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:1306
+msgid "I-frames appearing in the range below this value will be treated as consecutive keyframes"
+msgstr "Fotogrammi-I nell'intervallo al di sotto di questo valore saranno considerati fotogrammi chiave consecutivi"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:1311
+msgid "Reduction of bitrate for the first consecutive I-frames. The last I-frame will get treated normally"
+msgstr "Riduzione del bitrate per i primi fotogrammi-I consecutivi. L'ultimo fotogramma-I verr? trattato normalmente"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:1316
+msgid "How much of the overflow the codec can eat into during undersized sections - larger values will bridge the gap faster"
+msgstr "Valore di sovrabbondanza che il codec pu? trattare per le sezioni sotto-dimensionate - valori pi? alti colmeranno l'intervallo pi? velocemente"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:1321
+msgid "How much of the overflow the codec can eat into during oversized sections - larger values will bridge the gap faster"
+msgstr "Valore di sovrabbondanza che il codec pu? trattare per le sezioni sovra-dimensionate - valori pi? alti colmeranno l'intervallo pi? velocemente"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:1323
+msgid "Two pass tuning"
+msgstr "Regolazione seconda passata"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:1340
+msgid "High bitrate scenes (%):"
+msgstr "Scene ad alto bitrate (%):"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:1345
+msgid "Low bitrate scenes (%):"
+msgstr "Scene a basso bitrate (%):"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:1350
+msgid "Overflow control strength (%):"
+msgstr "Potenza di controllo sovrabbondanza (%):"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:1362
+msgid "The higher this value, the more bits get taken from frames larger than the average size, and redistributed to others"
+msgstr "Maggiore ? questo valore, pi? numerosi sono i bit presi dai fotogrammi di dimensioni maggiori di quelle medie, e ridistribuiti agli altri"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:1367
+msgid "The higher this value, the more bits get assigned to frames below the average frame size"
+msgstr "Maggiore ? questo valore, pi? numerosi sono i bit assegnati ai fotogrammi al di sotto della dimensione media"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:1372
+msgid "0 = default from core (let XviD decide), else overflow payback percent per frame"
+msgstr "0 = predefinito (lascia decidere XviD), altrimenti percentuale di sovrabbondanza per fotogramma"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:1374
+msgid "Curve compression"
+msgstr "Compressione curva"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:1378
+msgid "Second Pass"
+msgstr "Seconda passata"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:1591
+msgid "<b>Intra Matrix</b>"
+msgstr "<b>Matrice Intra</b>"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:1609
+msgid "<b>Inter Matrix</b>"
+msgstr "<b>Matrice Inter</b>"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialogFactory/DIA_color.cpp:71
+msgid "Select Color"
+msgstr "Seleziona colore"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialogFactory/FAC_bitrate.cpp:73
+msgid "_Encoding mode:"
+msgstr "Modalit? di _codifica:"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialogFactory/FAC_hex.cpp:100
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialogFactory/FAC_hex.cpp:134
+msgid "_Previous"
+msgstr "_Precedente"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialogFactory/FAC_hex.cpp:108
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialogFactory/FAC_hex.cpp:164
+msgid "_Next"
+msgstr "_Successivo"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_filters/gui_filter.cpp:327
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_filters/gui_filtermanager.cpp:242
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_filters/Q_mainfilter.cpp:413
+msgid "The filter is already partial"
+msgstr "Il filtro ? gi? parziale"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_filters/gui_filter.cpp:455
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_filters/gui_filter.cpp:457
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_filters/gui_filtermanager.cpp:348
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_filters/gui_filtermanager.cpp:350
+msgid "Load set of filters"
+msgstr "Carica gruppo di filtri"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_filters/gui_filter.cpp:464
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_filters/gui_filtermanager.cpp:363
+msgid "Nothing to save"
+msgstr "Niente da salvare"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_filters/gui_filter.cpp:468
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_filters/gui_filter.cpp:470
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_filters/gui_filtermanager.cpp:367
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_filters/gui_filtermanager.cpp:369
+msgid "Save set of filters"
+msgstr "Salva gruppo di filtri"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_filters/gui_filterlist.cpp:64
+msgid "Add Video Filter"
+msgstr "Aggiungi filtro video"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_filters/gui_filterlist.cpp:98
+msgid "Transformation"
+msgstr "Trasformazione"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_filters/gui_filterlist.cpp:123
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_filters/gui_filtermanager_dialog.cpp:285
+msgid "Interlacing"
+msgstr "Interlacciamento"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_filters/gui_filterlist.cpp:148
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_filters/gui_filtermanager_dialog.cpp:309
+msgid "Colors"
+msgstr "Colori"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_filters/gui_filterlist.cpp:173
+msgid "Denoise"
+msgstr "Rimuovi interferenza"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_filters/gui_filterlist.cpp:198
+msgid "Sharpen/Blur"
+msgstr "Nitidezza/Sfuocatura"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_filters/gui_filterlist.cpp:223
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_filters/gui_filtermanager_dialog.cpp:381
+msgid "Subtitles"
+msgstr "Sottotitoli"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_filters/gui_filterlist.cpp:248
+msgid "Miscellaneous"
+msgstr "Varie"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_filters/gui_filtermanager_dialog.cpp:123
+msgid "Video Filter Manager"
+msgstr "Gestore filtri video"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_filters/gui_filtermanager_dialog.cpp:145
+msgid "Open filter list [Ctrl-O]"
+msgstr "Apri lista filtri [Ctrl-O]"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_filters/gui_filtermanager_dialog.cpp:154
+msgid "Save filter list [Ctrl-S]"
+msgstr "Salva lista filtri [Ctrl-S]"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_filters/gui_filtermanager_dialog.cpp:162
+msgid "Save Script"
+msgstr "Salva script"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_filters/gui_filtermanager_dialog.cpp:165
+msgid "Save as script [Ctrl-J]"
+msgstr "Salva come script [Ctrl-J]"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_filters/gui_filtermanager_dialog.cpp:173
+msgid "DVD Res"
+msgstr "Ris. DVD"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_filters/gui_filtermanager_dialog.cpp:176
+msgid "DVD resolution [Ctrl-1]"
+msgstr "Risoluzione DVD [Ctrl-1]"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_filters/gui_filtermanager_dialog.cpp:184
+msgid "Half D1 Res"
+msgstr "Ris. Half D1"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_filters/gui_filtermanager_dialog.cpp:187
+msgid "Half D1 resolution [Ctrl-2]"
+msgstr "Risoluzione Half D1 [Ctrl-2]"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_filters/gui_filtermanager_dialog.cpp:195
+msgid "SVCD Res"
+msgstr "Ris. SVCD"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_filters/gui_filtermanager_dialog.cpp:198
+msgid "SVCD resolution [Ctrl-3]"
+msgstr "Risoluzione SVCD [Ctrl-3]"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_filters/gui_filtermanager_dialog.cpp:206
+msgid "VCD Res"
+msgstr "Ris. VCD"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_filters/gui_filtermanager_dialog.cpp:209
+msgid "VCD resolution [Ctrl-4]"
+msgstr "Risoluzione VCD [Ctrl-4]"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_filters/gui_filtermanager_dialog.cpp:260
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_srt.cpp:138
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_srt.cpp:151
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_x264.cpp:135
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_x264.cpp:148
+msgid "Transform"
+msgstr "Trasforma"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_filters/gui_filtermanager_dialog.cpp:333
+msgid "Noise"
+msgstr "Interferenza"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_filters/gui_filtermanager_dialog.cpp:357
+msgid "Sharpness"
+msgstr "Nitidezza"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_filters/gui_filtermanager_dialog.cpp:405
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_srt.cpp:120
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_x264.cpp:117
+msgid "Misc"
+msgstr "Varie"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_filters/gui_filtermanager_dialog.cpp:416
+msgid "External"
+msgstr "Esterne"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_filters/gui_filtermanager_dialog.cpp:427
+msgid "Add selected filter to the Active Filters list"
+msgstr "Aggiungi il filtro selezionato alla lista Filtri attivi"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_filters/gui_filtermanager_dialog.cpp:433
+msgid "<b>Available Filters</b>"
+msgstr "<b>Filtri disponibili</b>"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_filters/gui_filtermanager_dialog.cpp:478
+msgid "Remove filter"
+msgstr "Rimuovi filtro"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_filters/gui_filtermanager_dialog.cpp:487
+msgid "Move filter down"
+msgstr "Sposta il filtro verso il basso"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_filters/gui_filtermanager_dialog.cpp:496
+msgid "Move filter up"
+msgstr "Sposta il filtro verso l'alto"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_filters/gui_filtermanager_dialog.cpp:502
+msgid "P_artial"
+msgstr "P_arziale"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_filters/gui_filtermanager_dialog.cpp:505
+msgid "Apply the current filter only to a part of the file"
+msgstr "Applica il filtro corrente solo ad una parte del file"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_filters/gui_filtermanager_dialog.cpp:510
+msgid "Configure filter"
+msgstr "Configura filtro"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_filters/gui_filtermanager_dialog.cpp:520
+msgid "C_onfigure"
+msgstr "C_onfigura"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_filters/gui_filtermanager_dialog.cpp:524
+msgid "<b >Active Filters</b>"
+msgstr "<b >Filtri attivi</b>"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_filters/gui_filtermanager_dialog.cpp:551
+msgid "_Preview"
+msgstr "_Anteprima"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_filters/gui_filtersub.cpp:52
+msgid "Video Filters"
+msgstr "Filtri video"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_filters/gui_filtersub.cpp:112
+msgid "VCD res"
+msgstr "Ris. VCD"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_filters/gui_filtersub.cpp:118
+msgid "SVCD res"
+msgstr "Ris. SVCD"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_filters/gui_filtersub.cpp:124
+msgid "DVD res"
+msgstr "Ris. DVD"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_filters/gui_filtersub.cpp:130
+msgid "Half D1 res"
+msgstr "Ris. Half D1"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_filters/gui_filtersub.cpp:156
+msgid "Save as script"
+msgstr "Salva come script"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_bindings.cpp:428
+msgid "Input"
+msgstr "Input"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_bindings.cpp:429
+msgid "Output"
+msgstr "Output"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_bindings.cpp:430
+msgid "Side"
+msgstr "Laterale"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_bindings.cpp:431
+#: avidemux/ADM_videoFilter/ADM_vidDecTelecide.cpp:90
+#: avidemux/ADM_videoFilter/ADM_vidDGbob.cpp:81
+#: avidemux/ADM_videoFilter/ADM_vidKernelDeint.cpp:87
+#: avidemux/ADM_videoFilter/ADM_vidMcDeint.cpp:109
+msgid "Top"
+msgstr "Alto"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_bindings.cpp:432
+msgid "Separate"
+msgstr "Separati"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_bindings.cpp:606
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/Q_gui2.cpp:499
+#, c-format
+msgid "Frame:%c(%02d)"
+msgstr "Fotogramma: %c(%02d)"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:284
+#: avidemux/main.cpp:202
+msgid "_File"
+msgstr "_File"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:291
+msgid "_Open..."
+msgstr "_Apri..."
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:302
+msgid "_Append..."
+msgstr "A_ggiungi"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:313
+msgid "_Save"
+msgstr "_Salva"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:324
+msgid "Save _Video..."
+msgstr "Salva _video..."
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:336
+msgid "Save _BMP Image..."
+msgstr "Salva immagine _BMP..."
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:340
+msgid "Save _JPEG Image..."
+msgstr "Salva immagine _JPEG..."
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:344
+msgid "Save _Selection as JPEG Images..."
+msgstr "Salva _selezione in immagini JPEG..."
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:357
+msgid "Save _Project"
+msgstr "Salva _progetto"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:365
+msgid "Save P_roject As..."
+msgstr "Salva p_rogetto come..."
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:373
+msgid "_Load/Run Project..."
+msgstr "Car_ica/esegui progetto..."
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:381
+msgid "A_dd to Joblist..."
+msgstr "Aggi_ungi alla lista attivit?"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:385
+msgid "Show _Joblist"
+msgstr "Mostra _lista attivit?"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:397
+msgid "Co_nnect to avsproxy"
+msgstr "Co_nnetti a avsproxy"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:406
+msgid "Proper_ties"
+msgstr "Proprie_t?"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:417
+msgid "AVI _Muxer Options"
+msgstr "Opzioni _Muxer AVI"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:426
+msgid "_Quit"
+msgstr "_Esci"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:437
+msgid "_Edit"
+msgstr "_Modifica"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:444
+msgid "_Reset Edits"
+msgstr "A_nnulla"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:457
+msgid "Cu_t"
+msgstr "_Taglia"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:468
+msgid "_Copy"
+msgstr "_Copia"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:479
+msgid "_Paste"
+msgstr "_Incolla"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:490
+msgid "_Delete"
+msgstr "_Elimina"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:506
+msgid "Set Marker _A"
+msgstr "Imposta segnalibro _A"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:513
+msgid "Set Marker _B"
+msgstr "Imposta segnalibro _B"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:525
+msgid "Pre_ferences"
+msgstr "_Preferenze"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:533
+msgid "_View"
+msgstr "_Visualizza"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:540
+msgid "_Main Toolbar"
+msgstr "_Barra degli strumenti"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:545
+msgid "_A/V Sidebar"
+msgstr "Barra laterale _A/V"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:555
+msgid "_Zoom 1:4"
+msgstr "_Zoom 1:4"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:562
+msgid "Z_oom 1:2"
+msgstr "Z_oom 1:2"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:569
+msgid "Zoom _1:1"
+msgstr "Zoom _1:1"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:576
+msgid "Zoom _2:1"
+msgstr "Zoom _2:1"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:583
+msgid "Zoom _4:1"
+msgstr "Zoom _4:1"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:590
+msgid "Vi_deo"
+msgstr "Vi_deo"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:597
+msgid "_Decoder Options"
+msgstr "_Opzioni codifica"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:604
+msgid "_Postprocessing"
+msgstr "_Postprocessing"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:607
+msgid "Select postprocessing level"
+msgstr "Seleziona livello di postprocessing"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:617
+msgid "P_review"
+msgstr "_Anteprima"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:624
+msgid "Display _Output"
+msgstr "_Esegui video in uscita"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:636
+msgid "_Frame Rate"
+msgstr "_Frame rate"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:640
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:689
+msgid "_Encoder"
+msgstr "_Decodificatore"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:647
+msgid "Fil_ters"
+msgstr "Fil_tri"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:654
+msgid "_Audio"
+msgstr "_Audio"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:661
+msgid "_Main Track"
+msgstr "_Traccia principale"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:665
+msgid "_Second Track"
+msgstr "Traccia _secondaria"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:669
+msgid "_Build VBR Time Map"
+msgstr "_Crea VBR Time Map"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:678
+msgid "S_ave..."
+msgstr "_Salva..."
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:696
+msgid "_Filters"
+msgstr "_Filtri"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:700
+msgid "_Tools"
+msgstr "_Strumenti"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:707
+msgid "_Calculator"
+msgstr "_Calcola bitrate"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:723
+msgid "_Rebuild Frames (I & B)"
+msgstr "_Ricostruisci fotogrammi (I & B)"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:727
+msgid "C_heck Frames (slow)"
+msgstr "V_erifica fotogrammi (lento)"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:731
+msgid "_Bitrate Histogram"
+msgstr "Istogramma _bitrate"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:735
+msgid "_Scan for Black Frames..."
+msgstr "_Cerca fotogrammi neri..."
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:744
+msgid "_VOB -> VobSub"
+msgstr "_VOB -> VobSub"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:748
+msgid "_OCR (VobSub -> srt)"
+msgstr "_OCR (VobSub -> srt)"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:752
+msgid "Edit glyph"
+msgstr "Modifica glyph"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:761
+msgid "_Frame Hex Dump"
+msgstr "Hex Dump _fotogramma"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:765
+msgid "A_uto"
+msgstr "A_uto"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:772
+msgid "_VCD"
+msgstr "_VCD"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:776
+msgid "_SVCD"
+msgstr "_SVCD"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:780
+msgid "_DVD"
+msgstr "_DVD"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:784
+msgid "_PSP"
+msgstr "_PSP"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:788
+msgid "PSP (_H.264)"
+msgstr "PSP (_H.264)"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:792
+msgid "_Go"
+msgstr "_Vai"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:799
+msgid "_Play/Stop"
+msgstr "_Play/Stop"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:810
+msgid "P_revious Frame"
+msgstr "Fotogramma p_recedente"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:821
+msgid "_Next Frame"
+msgstr "Fotogramma _successivo"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:832
+msgid "Pr_evious Intra Frame"
+msgstr "Fotogramma chiave pr_ecedente"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:843
+msgid "Next _Intra Frame"
+msgstr "Fotogramma ch_iave successivo"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:854
+msgid "Previou_s Black Frame"
+msgstr "Fotogramma nero pre_cedente"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:858
+msgid "Ne_xt Black Frame"
+msgstr "Fotogramma nero s_uccessivo"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:862
+msgid "_First Frame"
+msgstr "Primo _fotogramma"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:873
+msgid "_Last Frame"
+msgstr "_Ultimo fotogramma"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:889
+msgid "Go to Marker _A"
+msgstr "Vai al segnalibro _A"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:896
+msgid "Go to Marker _B"
+msgstr "Vai al segnalibro _B"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:908
+msgid "_Jump to Frame..."
+msgstr "_Vai al fotogramma..."
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:919
+msgid "Jump to _Time..."
+msgstr "Vai al _tempo..."
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:930
+msgid "_Custom"
+msgstr "_Preferiti"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:934
+msgid "_Help"
+msgstr "_Aiuto"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:941
+msgid "_Built-in Support"
+msgstr "Supporto _incorporato"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:945
+msgid "_About"
+msgstr "_Informazioni"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:963
+msgid "Open a file"
+msgstr "Apri un file"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:973
+msgid "Save the file"
+msgstr "Salva il file"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:979
+msgid "Audio/video file information"
+msgstr "Informazioni audio/video del file"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:990
+msgid "Bitrate/size calculator"
+msgstr "Calcola bitrate/dimensione"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1044
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1084
+msgid "Copy"
+msgstr "Copia"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1049
+msgid "Configure video encoder"
+msgstr "Configura codificatore video"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1054
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1110
+msgid "Filters"
+msgstr "Filtri"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1057
+msgid "Video filters"
+msgstr "Filtri video"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1089
+msgid "Configure audio encoder"
+msgstr "Configura codificatore audio"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1097
+msgid "Audio filters"
+msgstr "Filtri audio"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1118
+msgid "Shift:"
+msgstr "Ritardo:"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1121
+msgid "Enable time shift"
+msgstr "Attiva ritardo audio"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1127
+msgid "Audio/video time shift (ms)"
+msgstr "Ritardo audio/video (ms)"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1134
+msgid "<b>Format</b>"
+msgstr "<b>Formato</b>"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1167
+msgid "<b>Selection</b>"
+msgstr "<b>Seleziona</b>"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1184
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1192
+msgid " 0000000"
+msgstr " 0000000"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1200
+msgid "A:"
+msgstr "A:"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1207
+msgid "Go to marker A"
+msgstr "Vai al segnalibro A"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1209
+msgid "B:"
+msgstr "B:"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1216
+msgid "Go to marker B"
+msgstr "Vai al segnalibro B"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1228
+msgid "Play"
+msgstr "Play"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1242
+msgid "Stop"
+msgstr "Stop"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1254
+msgid "Previous frame"
+msgstr "Fotogramma precedente"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1269
+msgid "Next frame"
+msgstr "Fotogramma successivo"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1284
+msgid "Previous keyframe"
+msgstr "Fotogramma chiave precedente"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1299
+msgid "Next keyframe"
+msgstr "Fotogramma chiave successivo"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1313
+msgid "Selection: start"
+msgstr "Selezione: inizio"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1324
+msgid "Selection: end"
+msgstr "Selezione: fine"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1335
+msgid "Previous black frame"
+msgstr "Fotogramma nero precedente"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1346
+msgid "Next black frame"
+msgstr "Fotogramma nero successivo"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1357
+msgid "First frame"
+msgstr "Primo fotogramm"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1368
+msgid "Last frame"
+msgstr "Ultimo fotogramm"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1390
+msgid "Frame: "
+msgstr "Fotogramma:"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1397
+msgid "Current frame"
+msgstr "Fotogramma attuale:"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1402
+msgid "/0000000"
+msgstr "/0000000"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1409
+msgid "Time: "
+msgstr "Tempo:"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1416
+msgid "Current time"
+msgstr "Tempo attuale"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1417
+msgid "00:00:00.000"
+msgstr "00:00:00.000"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1420
+msgid "/00:00:00,000"
+msgstr "/00:00:00,000"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1427
+msgid "Frame: ?"
+msgstr "Fotogramm: ?"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_ocr/adm_editglyph.cpp:55
+msgid "Select GlyphFile to edit"
+msgstr "Seleziona il file Glyph da modificare"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_ocr/adm_editglyph.cpp:123
+msgid "String"
+msgstr "String"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_ocr/adm_editglyph.cpp:125
+msgid "Search string"
+msgstr "Ricerca stringa"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_ocr/adm_editglyph.cpp:151
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_ocr/adm_editglyph.cpp:194
+msgid "End reached"
+msgstr "Fine raggiunta"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_ocr/adm_editglyph.cpp:151
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_ocr/adm_editglyph.cpp:194
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_ocr/adm_editglyph.cpp:218
+msgid "No more glyphs"
+msgstr "Nessun altro glyph"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_ocr/adm_editglyph.cpp:218
+msgid "Head reached"
+msgstr "Testa raggiunta"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_ocr/adm_editglyph.cpp:427
+msgid "dialog1"
+msgstr "dialog1"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_ocr/adm_editglyph.cpp:479
+msgid "Prev. Empty"
+msgstr "Vuoto precedente"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_ocr/adm_editglyph.cpp:501
+msgid "Next Empty"
+msgstr "Vuoto successivo"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_ocr/adm_ocr.cpp:209
+#: avidemux/ADM_userInterfaces/ADM_GTK/adm_ocr.cpp:209
+msgid "Incorrect output file"
+msgstr "File di usceita non corretto"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_ocr/adm_ocr.cpp:215
+#: avidemux/ADM_userInterfaces/ADM_GTK/adm_ocr.cpp:215
+msgid "Output file error"
+msgstr "Errore file di uscita"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_ocr/adm_ocr.cpp:215
+#: avidemux/ADM_userInterfaces/ADM_GTK/adm_ocr.cpp:215
+#, c-format
+msgid "Could not open \"%s\" for writing."
+msgstr "Impossibile aprire \"%s\" per la scrittura."
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_ocr/adm_ocr.cpp:224
+#: avidemux/ADM_userInterfaces/ADM_GTK/adm_ocr.cpp:224
+msgid "Problem loading sub"
+msgstr "Problema di caricamento sottotitoli"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_ocr/adm_ocr.cpp:589
+#: avidemux/ADM_userInterfaces/ADM_GTK/adm_ocr.cpp:589
+msgid "Sure ?"
+msgstr "Sicuro?"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_ocr/adm_ocr.cpp:752
+#: avidemux/ADM_userInterfaces/ADM_GTK/adm_ocr.cpp:752
+msgid "Select SRT to save"
+msgstr "Seleziona SRT da salvare"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_ocr/adm_ocr.cpp:764
+#: avidemux/ADM_userInterfaces/ADM_GTK/adm_ocr.cpp:764
+msgid "Select Glyoh to save"
+msgstr "Seleziona Glyph da salvare"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_ocr/adm_ocr.cpp:778
+#: avidemux/ADM_userInterfaces/ADM_GTK/adm_ocr.cpp:778
+msgid "No glyphs to save"
+msgstr "Nessun glyph da salvare"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_toolkit_gtk/ADM_gladeSupport.cpp:251
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_toolkit_gtk/ADM_gladeSupport.cpp:275
+#, c-format
+msgid "Couldn't find pixmap file: %s"
+msgstr "Impossibile trovare il file pixmap: %s"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_toolkit_gtk/TLK_filesel.cpp:121
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_toolkit_gtk/TLK_filesel.cpp:211
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_toolkit_gtk/TLK_filesel.cpp:474
+msgid "Cannot open directory as a file"
+msgstr "Impossibile aprire la cartella come un file"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_toolkit_gtk/TLK_filesel.cpp:335
+#: avidemux/gtk_gui.cpp:890
+#, c-format
+msgid "Cannot open \"%s\"."
+msgstr "Impossibile aprire \"%s\"."
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_toolkit_gtk/TLK_filesel.cpp:345
+msgid "Overwrite file ?"
+msgstr "Sovrascivere il file?"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_toolkit_gtk/TLK_filesel.cpp:370
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_toolkit_gtk/TLK_filesel.cpp:384
+msgid "It could be possible that you try to overwrite an input file!"
+msgstr "? possibile che tu stia provando a sovrascrivere un file di ingresso!"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_toolkit_gtk/TLK_filesel.cpp:395
+msgid "Cannot write the file"
+msgstr "Impossibile scrivere il file"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_toolkit_gtk/TLK_filesel.cpp:395
+#, c-format
+msgid "No write access to \"%s\"."
+msgstr "Nessun accesso di scrittura per \"%s\"."
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_toolkit_gtk/TLK_filesel.cpp:528
+msgid "Images"
+msgstr "Immagini"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_toolkit_gtk/TLK_filesel.cpp:540
+msgid "All"
+msgstr "Tutti i file"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_toolkit_gtk/toolkit_dialog.cpp:585
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_toolkit_gtk/toolkit_dialog.cpp:657
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_toolkit_gtk/toolkit_dialog.cpp:719
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_toolkit_gtk/toolkit_dialog.cpp:779
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_toolkit_gtk/toolkit_dialog.cpp:842
+msgid "label1"
+msgstr "label1"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_toolkit_gtk/toolkit_dialog.cpp:706
+msgid "Alert"
+msgstr "Avviso"
+
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_srt.cpp:72
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_x264.cpp:69
+msgid "Partition Decision"
+msgstr "Decisione partizione"
+
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_srt.cpp:80
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_x264.cpp:77
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_xvid4.cpp:72
+msgid "VHQ Mode"
+msgstr "Modalit? VHQ"
+
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_srt.cpp:81
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_x264.cpp:78
+msgid "Max Ref Frames"
+msgstr "Numero massimo di fotogrammi di riferimento"
+
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_srt.cpp:82
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_srt.cpp:146
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_x264.cpp:79
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_x264.cpp:143
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_xvid4.cpp:76
+msgid "Max B Frames"
+msgstr "Numero massimo di fotogrammi-B"
+
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_srt.cpp:85
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_x264.cpp:82
+msgid "Fast P Skip"
+msgstr "Salto P veloce"
+
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_srt.cpp:86
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_x264.cpp:83
+msgid "DCT Decimate"
+msgstr "DCT Decimate"
+
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_srt.cpp:87
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_x264.cpp:84
+msgid "Interlaced"
+msgstr "Interlacciato"
+
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_srt.cpp:106
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_x264.cpp:103
+msgid "Disabled"
+msgstr "Disattivato"
+
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_srt.cpp:113
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_x264.cpp:110
+msgid "Deblocking Filter"
+msgstr "Filtro deblocking"
+
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_srt.cpp:114
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_x264.cpp:111
+msgid "Strength"
+msgstr "Forza"
+
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_srt.cpp:115
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_x264.cpp:112
+msgid "Threshold"
+msgstr "Soglia"
+
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_srt.cpp:133
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_x264.cpp:130
+msgid "8x8P Transform"
+msgstr "Trasforma 8x8P"
+
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_srt.cpp:134
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_x264.cpp:131
+msgid "8x8B Transform"
+msgstr "Trasforma 8x8B"
+
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_srt.cpp:135
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_x264.cpp:132
+msgid "_4x4 Transform"
+msgstr "Trasforma _4x4"
+
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_srt.cpp:136
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_x264.cpp:133
+msgid "_8x8I Transform"
+msgstr "Trasforma _8x8I"
+
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_srt.cpp:137
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_x264.cpp:134
+msgid "_4x4I Transform"
+msgstr "Trasforma _4x4I"
+
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_srt.cpp:155
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_x264.cpp:152
+msgid "X264 Configuration"
+msgstr "Configurazione X264"
+
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_xvid4.cpp:58
+msgid "Very Low"
+msgstr "Molto bassa"
+
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_xvid4.cpp:60
+#: avidemux/ADM_videoFilter/ADM_vidMcDeint.cpp:105
+msgid "Medium"
+msgstr "Media"
+
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_xvid4.cpp:62
+msgid "Very High"
+msgstr "Molto alta"
+
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_xvid4.cpp:63
+msgid "Ultra High"
+msgstr "Ultra"
+
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_xvid4.cpp:64
+msgid "Motion Search Precision"
+msgstr "Precisione ricerca movimento"
+
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_xvid4.cpp:67
+msgid "Off"
+msgstr "Off"
+
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_xvid4.cpp:68
+msgid "Mode Decision"
+msgstr "Decisione modalit?"
+
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_xvid4.cpp:69
+msgid "Limited Search"
+msgstr "Ricerca limitata"
+
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_xvid4.cpp:70
+msgid "Medium Search"
+msgstr "Ricerca media"
+
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_xvid4.cpp:71
+msgid "Wide Search"
+msgstr "Ricerca estesa"
+
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_xvid4.cpp:77
+msgid "Quarter Pixel"
+msgstr "Quarter pixel"
+
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_xvid4.cpp:78
+msgid "GMC"
+msgstr "GMC"
+
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_xvid4.cpp:79
+msgid "BVHQ"
+msgstr "BVHQ"
+
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_xvid4.cpp:88
+msgid "4MV"
+msgstr "4MV"
+
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_xvid4.cpp:90
+msgid "HQ AC"
+msgstr "HQ AC"
+
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_xvid4.cpp:91
+msgid "More Search"
+msgstr "Ricerca ancora"
+
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_xvid4.cpp:96
+msgid "Min Gop Size"
+msgstr "Dimensione Gop minima"
+
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_xvid4.cpp:97
+msgid "Max Gop Size"
+msgstr "Dimensione Gop massima"
+
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_xvid4.cpp:98
+msgid "GOP Size"
+msgstr "Dimensione GOP"
+
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_xvid4.cpp:106
+msgid "H263"
+msgstr "H263"
+
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_xvid4.cpp:107
+msgid "Mpeg"
+msgstr "Mpeg"
+
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_xvid4.cpp:108
+msgid "Quantization Matrix"
+msgstr "Matrice quantizzazione"
+
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_xvid4.cpp:109
+msgid "Trellis Quantization"
+msgstr "Quantizzazione Trellis"
+
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_xvid4.cpp:117
+msgid "Two Pass Tuning"
+msgstr "Regolazione due passate"
+
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_xvid4.cpp:128
+msgid "Curve Compression"
+msgstr "Compressione curva"
+
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_xvid4.cpp:142
+msgid "Xvid4 Configuration"
+msgstr "Configurazione Xvid4"
+
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_jobs.cpp:106
+msgid "Job Name"
+msgstr "Nome attivit?"
+
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_jobs.cpp:106
+msgid "Status"
+msgstr "Stato"
+
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_jobs.cpp:106
+msgid "Start Time"
+msgstr "Tempo di inizio"
+
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_jobs.cpp:106
+msgid "End Time"
+msgstr "Tempo di fine"
+
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_jobs.cpp:196
+msgid "Delete *all* job"
+msgstr "Elimina *tutte* le attivit?"
+
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_jobs.cpp:196
+msgid "Are you sure you want to delete ALL jobs ?"
+msgstr "Sei sicuro di volere eliminare TUTTE le attivit??"
+
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_jobs.cpp:222
+msgid "Already done"
+msgstr "Gi? eseguito"
+
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_jobs.cpp:222
+msgid "This script has already been successfully executed."
+msgstr "Lo script ? gi? stato eseguito con successo."
+
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/T_index_pg.cpp:198
+#, c-format
+msgid "# Images :%0lu"
+msgstr "Numero di immagini: %0lu"
+
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/T_index_pg.cpp:216
+#, c-format
+msgid "Time Left :%02d:%02d:%02d"
+msgstr "Tempo rimanente: %02d:%02d:%02d"
+
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialogFactory/T_filesel.cpp:62
+msgid "Select File to Read"
+msgstr "Seleziona il file da leggere"
+
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialogFactory/T_filesel.cpp:65
+msgid "Select File to Write"
+msgstr "Seleziona il file da scrivere"
+
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialogFactory/T_filesel.cpp:69
+msgid "Select Directory"
+msgstr "Seleziona cartella"
+
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_filters/Q_mainfilter.cpp:580
+msgid "Partial Start Frame:"
+msgstr "Fotogramma iniziale parziale:"
+
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_filters/Q_mainfilter.cpp:581
+msgid "Partial End Frame:"
+msgstr "Fotogramma finale parziale:"
+
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_filters/Q_mainfilter.cpp:582
+msgid "Configure child"
+msgstr ""
+
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_filters/Q_mainfilter.cpp:585
+msgid "Partial Video Filter"
+msgstr "Filtro video parziale"
+
+#: avidemux/ADM_video/ADM_vidFieldUnblend.cpp:81
+msgid "Metrics"
+msgstr "Misure"
+
+#: avidemux/ADM_video/ADM_vidFieldUnblend.cpp:81
+msgid "Do you want to print metrics on screen ?"
+msgstr "Vuoi mostrare le misure sullo schermo?"
+
+#: avidemux/ADM_video/ADM_vidSRT.cpp:215
+msgid "Could not open subtitle file"
+msgstr "Impossibile aprire il file sottotitoli"
+
+#: avidemux/ADM_video/ADM_vidSRT.cpp:235
+msgid "Cannot identify subtitle format"
+msgstr "Impossibile identificare il formato sottotitoli"
+
+#: avidemux/ADM_videoFilter/ADM_guiResize.cpp:96
+#: avidemux/ADM_videoFilter/ADM_vidMPLResize.cpp:143
+msgid "Width and height cannot be 0"
+msgstr "Larghezza e altezza non possono essere 0"
+
+#: avidemux/ADM_videoFilter/ADM_guiResize.cpp:98
+#: avidemux/ADM_videoFilter/ADM_vidMPLResize.cpp:145
+msgid "Width and height cannot be odd"
+msgstr "Larghezza e altezza non possono essere dispari"
+
+#: avidemux/ADM_videoFilter/ADM_lavpp_deint.cpp:106
+msgid "Linear blend"
+msgstr "Miscela lineare"
+
+#: avidemux/ADM_videoFilter/ADM_lavpp_deint.cpp:107
+msgid "Linear interpolate"
+msgstr "Interpolazione lineare"
+
+#: avidemux/ADM_videoFilter/ADM_lavpp_deint.cpp:108
+msgid "Cubic interpolate"
+msgstr "Interpolazione cubica"
+
+#: avidemux/ADM_videoFilter/ADM_lavpp_deint.cpp:109
+msgid "Median interpolate"
+msgstr "Interpolazione mediana"
+
+#: avidemux/ADM_videoFilter/ADM_lavpp_deint.cpp:110
+msgid "FFmpeg deint"
+msgstr "Deint. FFmpeg"
+
+#: avidemux/ADM_videoFilter/ADM_lavpp_deint.cpp:114
+msgid "_Deinterlacing:"
+msgstr "_Deinterlacciamento:"
+
+#: avidemux/ADM_videoFilter/ADM_lavpp_deint.cpp:115
+msgid "_Autolevel"
+msgstr "Livello _automatico"
+
+#: avidemux/ADM_videoFilter/ADM_vidASS.cpp:85
+msgid "_Subtitle file (ASS/SSA):"
+msgstr "File _sottotitoli (ASS/SSA):"
+
+#: avidemux/ADM_videoFilter/ADM_vidASS.cpp:86
+msgid "_Line spacing:"
+msgstr "Inter_linea:"
+
+#: avidemux/ADM_videoFilter/ADM_vidASS.cpp:87
+msgid "_Font scale:"
+msgstr "Dimensione _carattere:"
+
+#: avidemux/ADM_videoFilter/ADM_vidASS.cpp:88
+msgid "_Top margin:"
+msgstr "Margine _superiore:"
+
+#: avidemux/ADM_videoFilter/ADM_vidASS.cpp:89
+msgid "Botto_m margin"
+msgstr "_Margine inferiore"
+
+#: avidemux/ADM_videoFilter/ADM_vidBlendRemoval.cpp:82
+#: avidemux/ADM_videoFilter/ADM_vidDGbob.cpp:92
+#: avidemux/ADM_videoFilter/ADM_vidHardIvtcRemoval.cpp:87
+#: avidemux/ADM_videoFilter/ADM_vidKernelDeint.cpp:93
+#: avidemux/ADM_videoFilter/ADM_vidMSharpen.cpp:166
+msgid "_Threshold:"
+msgstr "_Soglia:"
+
+#: avidemux/ADM_videoFilter/ADM_vidBlendRemoval.cpp:83
+msgid "If value is smaller than threshold it is considered valid.Smaller value might mean more false positive."
+msgstr "Se il valore ? pi? piccolo della soglia ? considerato valido. Valori pi? piccoli potrebbero produrre pi? falsi positivi."
+
+#: avidemux/ADM_videoFilter/ADM_vidBlendRemoval.cpp:85
+#: avidemux/ADM_videoFilter/ADM_vidHardIvtcRemoval.cpp:90
+msgid "_Noise:"
+msgstr "_Interferenza:"
+
+#: avidemux/ADM_videoFilter/ADM_vidBlendRemoval.cpp:85
+#: avidemux/ADM_videoFilter/ADM_vidHardIvtcRemoval.cpp:90
+msgid "If pixels are closer than noise, they are considered to be the same"
+msgstr "Se i pixel sono pi? vicini dell'interferenza, sono considerat identici"
+
+#: avidemux/ADM_videoFilter/ADM_vidBlendRemoval.cpp:86
+msgid "I_dentical:"
+msgstr "I_dentit?:"
+
+#: avidemux/ADM_videoFilter/ADM_vidBlendRemoval.cpp:86
+#: avidemux/ADM_videoFilter/ADM_vidHardIvtcRemoval.cpp:91
+msgid "If metric is less than identical, images are considered identical"
+msgstr "Se le misure non sono esattamente identiche, le immagini sono considerate identiche"
+
+#: avidemux/ADM_videoFilter/ADM_vidBlendRemoval.cpp:87
+#: avidemux/ADM_videoFilter/ADM_vidHardIvtcRemoval.cpp:92
+msgid "_Show metrics"
+msgstr "_Mostra misure"
+
+#: avidemux/ADM_videoFilter/ADM_vidBlendRemoval.cpp:87
+#: avidemux/ADM_videoFilter/ADM_vidHardIvtcRemoval.cpp:92
+msgid "Show metric in image (debug)"
+msgstr "Mostra misure nell'immagine (debug)"
+
+#: avidemux/ADM_videoFilter/ADM_vidDecDec.cpp:190
+msgid "Discard closer"
+msgstr "Scarta il pi? vicino"
+
+#: avidemux/ADM_videoFilter/ADM_vidDecDec.cpp:191
+msgid "Replace (interpolate)"
+msgstr "Sostituisci (interpola)"
+
+#: avidemux/ADM_videoFilter/ADM_vidDecDec.cpp:192
+msgid "Discard longer dupe (anim?s)"
+msgstr "Scarta duplicati pi? lunghi"
+
+#: avidemux/ADM_videoFilter/ADM_vidDecDec.cpp:193
+msgid "Pulldown dupe removal"
+msgstr "Rimozione duplicati pulldown"
+
+#: avidemux/ADM_videoFilter/ADM_vidDecDec.cpp:196
+msgid "Fastest (no chroma, partial luma)"
+msgstr "Pi? veloce (senza croma, luma parziale)"
+
+#: avidemux/ADM_videoFilter/ADM_vidDecDec.cpp:197
+msgid "Fast (partial luma and chroma)"
+msgstr "Veloce (luma e croma parziali)"
+
+#: avidemux/ADM_videoFilter/ADM_vidDecDec.cpp:198
+msgid "Medium (full luma, no chroma)"
+msgstr "Media (luma completa, senza croma)"
+
+#: avidemux/ADM_videoFilter/ADM_vidDecDec.cpp:199
+msgid "Slow (full luma and chroma)"
+msgstr "Lenta (luma e croma completi)"
+
+#: avidemux/ADM_videoFilter/ADM_vidDecDec.cpp:205
+msgid "_Threshold 1:"
+msgstr "_Soglia 1:"
+
+#: avidemux/ADM_videoFilter/ADM_vidDecDec.cpp:206
+msgid "T_hreshold 2:"
+msgstr "S_oglia 2:"
+
+#: avidemux/ADM_videoFilter/ADM_vidDecTelecide.cpp:83
+msgid "No strategy"
+msgstr "Nessuna strategia"
+
+#: avidemux/ADM_videoFilter/ADM_vidDecTelecide.cpp:84
+msgid "3:2 pulldown"
+msgstr "3:2 pulldown"
+
+#: avidemux/ADM_videoFilter/ADM_vidDecTelecide.cpp:85
+msgid "PAL/SECAM"
+msgstr "PAL/SECAM"
+
+#: avidemux/ADM_videoFilter/ADM_vidDecTelecide.cpp:91
+#: avidemux/ADM_videoFilter/ADM_vidDGbob.cpp:82
+#: avidemux/ADM_videoFilter/ADM_vidKernelDeint.cpp:88
+#: avidemux/ADM_videoFilter/ADM_vidMcDeint.cpp:110
+msgid "Bottom"
+msgstr "Basso"
+
+#: avidemux/ADM_videoFilter/ADM_vidDecTelecide.cpp:95
+msgid "Never"
+msgstr "Mai"
+
+#: avidemux/ADM_videoFilter/ADM_vidDecTelecide.cpp:96
+msgid "If still combed"
+msgstr "Se ancora inerlacciati"
+
+#: avidemux/ADM_videoFilter/ADM_vidDecTelecide.cpp:97
+msgid "Always"
+msgstr "Sempre"
+
+#: avidemux/ADM_videoFilter/ADM_vidDecTelecide.cpp:102
+msgid "None but compute"
+msgstr ""
+
+#: avidemux/ADM_videoFilter/ADM_vidDecTelecide.cpp:103
+msgid "Postproc on best match"
+msgstr "Postproc. sulla migliore corrispondenza"
+
+#: avidemux/ADM_videoFilter/ADM_vidDecTelecide.cpp:104
+msgid "Postproc and show zones (debug)"
+msgstr "Postproc. e mostra zone (debug)"
+
+#: avidemux/ADM_videoFilter/ADM_vidDecTelecide.cpp:105
+msgid "Process image (not fields)"
+msgstr "Elabora immagine (no campi)"
+
+#: avidemux/ADM_videoFilter/ADM_vidDecTelecide.cpp:106
+msgid "Process image (not fields), debug"
+msgstr "Elabora immagine (no campi), debug"
+
+#: avidemux/ADM_videoFilter/ADM_vidDecTelecide.cpp:110
+msgid "_Strategy:"
+msgstr "_Strategia:"
+
+#: avidemux/ADM_videoFilter/ADM_vidDecTelecide.cpp:112
+msgid "_Postprocessing:"
+msgstr "_Postprocessing:"
+
+#: avidemux/ADM_videoFilter/ADM_vidDecTelecide.cpp:113
+msgid "_Try backward:"
+msgstr "_Prova all'indietro:"
+
+#: avidemux/ADM_videoFilter/ADM_vidDecTelecide.cpp:115
+msgid "_Direct threshold:"
+msgstr "Soglia _diretta:"
+
+#: avidemux/ADM_videoFilter/ADM_vidDecTelecide.cpp:116
+msgid "_Backward threshold:"
+msgstr "Soglia all'indietro:"
+
+#: avidemux/ADM_videoFilter/ADM_vidDecTelecide.cpp:117
+msgid "_Noise threshold:"
+msgstr "Soglia _interferenza:"
+
+#: avidemux/ADM_videoFilter/ADM_vidDecTelecide.cpp:118
+msgid "Postp_rocessing threshold:"
+msgstr "Soglia postp_rocessing:"
+
+#: avidemux/ADM_videoFilter/ADM_vidDecTelecide.cpp:120
+msgid "_Use chroma to decide"
+msgstr "_Usa croma per decidere"
+
+#: avidemux/ADM_videoFilter/ADM_vidDecTelecide.cpp:121
+msgid "Sho_w info"
+msgstr "Mostra _informazioni"
+
+#: avidemux/ADM_videoFilter/ADM_vidDecTelecide.cpp:122
+msgid "Debu_g"
+msgstr "Debu_g"
+
+#: avidemux/ADM_videoFilter/ADM_vidDecTelecide.cpp:123
+msgid "Bl_end"
+msgstr "Misc_ela"
+
+#: avidemux/ADM_videoFilter/ADM_vidDenoise.cpp:386
+msgid "_Luma lock:"
+msgstr "Blocco _luma:"
+
+#: avidemux/ADM_videoFilter/ADM_vidDenoise.cpp:387
+msgid "C_hroma lock:"
+msgstr "Blocco _croma:"
+
+#: avidemux/ADM_videoFilter/ADM_vidDenoise.cpp:388
+msgid "L_uma threshold:"
+msgstr "Soglia l_uma:"
+
+#: avidemux/ADM_videoFilter/ADM_vidDenoise.cpp:389
+msgid "Ch_roma threshold:"
+msgstr "Soglia ch_roma:"
+
+#: avidemux/ADM_videoFilter/ADM_vidDenoise.cpp:391
+msgid "_Scene change:"
+msgstr "Cambiamento _scena"
+
+#: avidemux/ADM_videoFilter/ADM_vidDGbob.cpp:85
+msgid "Keep nb of frames and fps"
+msgstr "Mantieni numero di fotogrammi e fps"
+
+#: avidemux/ADM_videoFilter/ADM_vidDGbob.cpp:86
+msgid "Double nb of frames and fps"
+msgstr "Raddoppia fotogrammi e fps"
+
+#: avidemux/ADM_videoFilter/ADM_vidDGbob.cpp:87
+msgid "Double nb of frames (slow motion)"
+msgstr "Raddoppia fotogrammi (rallentatore)"
+
+#: avidemux/ADM_videoFilter/ADM_vidDGbob.cpp:93
+msgid "_Extra"
+msgstr "_Extra"
+
+#: avidemux/ADM_videoFilter/ADM_vidDGbob.cpp:93
+msgid "Extra check, avoid using it"
+msgstr "Controllo supplementare, evitare l'utilizzo"
+
+#: avidemux/ADM_videoFilter/ADM_vidDropOut.cpp:63
+msgid "DropOut Threshold"
+msgstr "Soglia DropOut"
+
+#: avidemux/ADM_videoFilter/ADM_vidFade.cpp:65
+msgid "Out"
+msgstr "Out"
+
+#: avidemux/ADM_videoFilter/ADM_vidFade.cpp:65
+msgid "Fade out"
+msgstr "Dissolvenza in uscita"
+
+#: avidemux/ADM_videoFilter/ADM_vidFade.cpp:65
+msgid "In"
+msgstr "In"
+
+#: avidemux/ADM_videoFilter/ADM_vidFade.cpp:65
+msgid "Fade in"
+msgstr "Dissolvenza in ingresso"
+
+#: avidemux/ADM_videoFilter/ADM_vidFade.cpp:71
+msgid "_Fade type:"
+msgstr "Tipo di _dissolvenza:"
+
+#: avidemux/ADM_videoFilter/ADM_vidFade.cpp:72
+msgid "_Start frame:"
+msgstr "Fotogramma di _inizio:"
+
+#: avidemux/ADM_videoFilter/ADM_vidFade.cpp:73
+msgid "_End frame:"
+msgstr "Fotogramma di _fine:"
+
+#: avidemux/ADM_videoFilter/ADM_vidFade.cpp:74
+msgid "Fade to _black"
+msgstr "Dissolvenza verso il _nero"
+
+#: avidemux/ADM_videoFilter/ADM_vidFade.cpp:83
+msgid "Parameter Error"
+msgstr "Errore parametro"
+
+#: avidemux/ADM_videoFilter/ADM_vidFade.cpp:83
+msgid "Start must be before end, and both within video # of frames."
+msgstr "L'inizio deve essere prima della fine, e entrami nel numero di fotogrammi."
+
+#: avidemux/ADM_videoFilter/ADM_vidForcedPP.cpp:61
+msgid "_Quantizer:"
+msgstr "_Quantizzatore:"
+
+#: avidemux/ADM_videoFilter/ADM_vidHardIvtcRemoval.cpp:88
+msgid "If value is smaller than threshold it is considered valid. Smaller value might mean more false positive"
+msgstr "Se il valore ? pi? piccolo della soglia ? considerato valido. Valori pi? piccoli potrebbero produrre pi? falsi positivi."
+
+#: avidemux/ADM_videoFilter/ADM_vidHardIvtcRemoval.cpp:91
+msgid "_Identical:"
+msgstr "_Identit?:"
+
+#: avidemux/ADM_videoFilter/ADM_vidKernelDeint.cpp:93
+msgid "Smaller means more deinterlacing"
+msgstr "Minore significa maggiore deiterlaccio"
+
+#: avidemux/ADM_videoFilter/ADM_vidKernelDeint.cpp:94
+msgid "_Sharper engine:"
+msgstr "_Nitidizzatore:"
+
+#: avidemux/ADM_videoFilter/ADM_vidKernelDeint.cpp:95
+msgid "T_woway"
+msgstr "Due _vie"
+
+#: avidemux/ADM_videoFilter/ADM_vidKernelDeint.cpp:95
+msgid "Extrapolate better (better not to use it)"
+msgstr "Estrapola meglio (meglio non usarlo)"
+
+#: avidemux/ADM_videoFilter/ADM_vidKernelDeint.cpp:96
+msgid "_Map"
+msgstr "_Mappa"
+
+#: avidemux/ADM_videoFilter/ADM_vidKernelDeint.cpp:96
+msgid "Show interlaced areas (for test!)"
+msgstr "Mostra aree interlacciate (per test!)"
+
+#: avidemux/ADM_videoFilter/ADM_vidMcDeint.cpp:104
+msgid "Fast"
+msgstr "Veloce"
+
+#: avidemux/ADM_videoFilter/ADM_vidMcDeint.cpp:106
+msgid "Slow iterative motion search"
+msgstr "Lenta, ricerca movimento iterativa"
+
+#: avidemux/ADM_videoFilter/ADM_vidMcDeint.cpp:107
+msgid "Extra slow (same as 3+multiple reference frames)"
+msgstr "Extra lenta (come fotogrammi di riferimento moltiplicati per 3)"
+
+#: avidemux/ADM_videoFilter/ADM_vidMcDeint.cpp:114
+msgid "_Field dominance:"
+msgstr "Dominanza _campo:"
+
+#: avidemux/ADM_videoFilter/ADM_vidMcDeint.cpp:115
+msgid "_Qp:"
+msgstr "_Qp:"
+
+#: avidemux/ADM_videoFilter/ADM_vidMosaic.cpp:90
+msgid "_Horizontal stacking:"
+msgstr "Impilamento _orizzontale:"
+
+#: avidemux/ADM_videoFilter/ADM_vidMosaic.cpp:91
+msgid "_Vertical stacking:"
+msgstr "Impilamento _verticale:"
+
+#: avidemux/ADM_videoFilter/ADM_vidMosaic.cpp:92
+msgid "_Shrink factor:"
+msgstr "Fattore di _compressione:"
+
+#: avidemux/ADM_videoFilter/ADM_vidMosaic.cpp:93
+msgid "Show _frame"
+msgstr "Mostra _fotogrammi"
+
+#: avidemux/ADM_videoFilter/ADM_vidMPLD3D.cpp:74
+#: avidemux/ADM_videoFilter/ADM_vidMPLD3Dlow.cpp:74
+msgid "_Spatial luma strength:"
+msgstr "Forza luma _spaziale:"
+
+#: avidemux/ADM_videoFilter/ADM_vidMPLD3D.cpp:75
+#: avidemux/ADM_videoFilter/ADM_vidMPLD3Dlow.cpp:75
+msgid "S_patial chroma strength:"
+msgstr "Forza croma s_paziale:"
+
+#: avidemux/ADM_videoFilter/ADM_vidMPLD3D.cpp:76
+#: avidemux/ADM_videoFilter/ADM_vidMPLD3Dlow.cpp:76
+msgid "_Temporal strength:"
+msgstr "Forza _temporale"
+
+#: avidemux/ADM_videoFilter/ADM_vidMSharpen.cpp:163
+msgid "_Mask"
+msgstr "_Maschera"
+
+#: avidemux/ADM_videoFilter/ADM_vidMSharpen.cpp:164
+msgid "_High Q"
+msgstr "_High Q"
+
+#: avidemux/ADM_videoFilter/ADM_vidPalShift.cpp:76
+msgid "_Try reverse"
+msgstr "_Prova contrario"
+
+#: avidemux/ADM_videoFilter/ADM_vidResampleFPS.cpp:85
+msgid "_New frame rate:"
+msgstr "_Nuovo frame rate:"
+
+#: avidemux/ADM_videoFilter/ADM_vidResampleFPS.cpp:86
+msgid "_Blend"
+msgstr "_Miscela"
+
+#: avidemux/ADM_videoFilter/ADM_vidRotate.cpp:265
+msgid "90 degrees"
+msgstr "90 gradi"
+
+#: avidemux/ADM_videoFilter/ADM_vidRotate.cpp:265
+msgid "90?"
+msgstr "90?"
+
+#: avidemux/ADM_videoFilter/ADM_vidRotate.cpp:266
+msgid "180 degrees"
+msgstr "180 gradi"
+
+#: avidemux/ADM_videoFilter/ADM_vidRotate.cpp:266
+msgid "180?"
+msgstr "180?"
+
+#: avidemux/ADM_videoFilter/ADM_vidRotate.cpp:267
+msgid "270 degrees"
+msgstr "270 gradi"
+
+#: avidemux/ADM_videoFilter/ADM_vidRotate.cpp:267
+msgid "270?"
+msgstr "270?"
+
+#: avidemux/ADM_videoFilter/ADM_vidRotate.cpp:269
+msgid "_Angle:"
+msgstr "_Angolo:"
+
+#: avidemux/ADM_videoFilter/ADM_vidRotate.cpp:271
+msgid "Rotate"
+msgstr "Rotazione"
+
+#: avidemux/ADM_videoFilter/ADM_vidSoften.cpp:68
+msgid "_Luma threshold:"
+msgstr "Soglia _luma:"
+
+#: avidemux/ADM_videoFilter/ADM_vidSoften.cpp:69
+msgid "C_hroma threshold:"
+msgstr "Soglia c_hroma:"
+
+#: avidemux/ADM_videoFilter/ADM_vidSoften.cpp:70
+msgid "_Radius:"
+msgstr "_Raggio:"
+
+#: avidemux/ADM_videoFilter/ADM_vidStabilize.cpp:63
+msgid "Stabilize Threshold"
+msgstr "Stabilizza soglia"
+
+#: avidemux/ADM_videoFilter/ADM_vidVlad.cpp:101
+msgid "_Luma temporal threshold:"
+msgstr "Soglia temporale _luma:"
+
+#: avidemux/ADM_videoFilter/ADM_vidVlad.cpp:102
+msgid "Ch_roma temporal threshold:"
+msgstr "Soglia temporale c_roma"
+
+#: avidemux/ADM_videoFilter/ADM_vidYadif.cpp:171
+msgid "Temporal & spatial check"
+msgstr "Verifica temporale & spaziale"
+
+#: avidemux/ADM_videoFilter/ADM_vidYadif.cpp:172
+msgid "Bob, temporal & spatial check"
+msgstr "Bob, verifica temporale & spaziale"
+
+#: avidemux/ADM_videoFilter/ADM_vidYadif.cpp:173
+msgid "Skip spatial temporal check"
+msgstr "Salta verifica temporale spaziale"
+
+#: avidemux/ADM_videoFilter/ADM_vidYadif.cpp:174
+msgid "Bob, skip spatial temporal check"
+msgstr "Bob, salta verifica temporale spaziale"
+
+#: avidemux/ADM_videoFilter/ADM_vidYadif.cpp:182
+msgid "_Order:"
+msgstr "_Ordine:"
+
+#: avidemux/gtk_gui.cpp:251
+msgid "Select ECMAScript to Run"
+msgstr "Seleziona un ECMAScript da eseguire"
+
+#: avidemux/gtk_gui.cpp:298
+#: avidemux/gtk_gui.cpp:337
+msgid "Obsolete"
+msgstr "Obsoleto"
+
+#: avidemux/gtk_gui.cpp:365
+msgid "Not coded in this version"
+msgstr "Non codificato in questa versione"
+
+#: avidemux/gtk_gui.cpp:380
+#: avidemux/gtk_gui.cpp:385
+#: avidemux/gtk_gui.cpp:504
+#: avidemux/gtk_gui.cpp:507
+msgid "Select AVI File..."
+msgstr "Seleziona un file AVI..."
+
+#: avidemux/gtk_gui.cpp:440
+msgid ""
+"This is to be used to undo packed VOP on MPEG-4.\n"
+"Continue ?"
+msgstr ""
+"Questo deve essere usato per decomprimere il VOP su MPEG-4.\n"
+"Continuare?"
+
+#: avidemux/gtk_gui.cpp:442
+msgid "Select AVI File to Write"
+msgstr "Seleziona il file AVI da scrivere"
+
+#: avidemux/gtk_gui.cpp:448
+msgid "Select OGM File to Write"
+msgstr "Seleziona il file OGM da scrivere"
+
+#: avidemux/gtk_gui.cpp:459
+#: avidemux/gtk_gui.cpp:470
+msgid "Select Workbench to Save"
+msgstr "Seleziona il Tavolo da lavoro da salvare"
+
+#: avidemux/gtk_gui.cpp:494
+msgid "Select Raw File to Save"
+msgstr "Seleziona il file grezzo da salvare"
+
+#: avidemux/gtk_gui.cpp:510
+msgid "Select AVI File to Append..."
+msgstr "Seleziona il file AVI da aggiungere..."
+
+#: avidemux/gtk_gui.cpp:514
+msgid "Select File to Save Audio"
+msgstr "Seleziona il file audio da salvare"
+
+#: avidemux/gtk_gui.cpp:548
+msgid "Select JPEG Sequence to Save"
+msgstr "Seleziona la sequenza JPEG da salvare"
+
+#: avidemux/gtk_gui.cpp:551
+msgid "Select BMP to Save"
+msgstr "Seleziona il file BMP da salvare"
+
+#: avidemux/gtk_gui.cpp:555
+msgid "Select JPEG to Save"
+msgstr "Seleziona il file JPEG da salvare"
+
+#: avidemux/gtk_gui.cpp:608
+#: avidemux/gtk_gui.cpp:712
+msgid "Select File to Save"
+msgstr "Seleziona il file da salvare"
+
+#: avidemux/gtk_gui.cpp:652
+msgid "Select MP3 to Load"
+msgstr "Seleziona il file MP3 da caricare"
+
+#: avidemux/gtk_gui.cpp:655
+msgid "Select AC3 to Load"
+msgstr "Seleziona il file AC3 da caricare"
+
+#: avidemux/gtk_gui.cpp:658
+msgid "Select WAV to Load"
+msgstr "Seleziona il file WAV da caricare"
+
+#: avidemux/gtk_gui.cpp:706
+msgid "Out of bounds"
+msgstr "Oltre i limiti"
+
+#: avidemux/gtk_gui.cpp:717
+#: avidemux/gtk_gui.cpp:1908
+msgid "Marker A > B"
+msgstr "Segnalibro A > B"
+
+#: avidemux/gtk_gui.cpp:717
+msgid "Cannot copy."
+msgstr "Impossibile copiare."
+
+#: avidemux/gtk_gui.cpp:729
+msgid "Something bad happened (II))"
+msgstr "C'? stato qualche errore (II)"
+
+#: avidemux/gtk_gui.cpp:743
+msgid "Are you sure?"
+msgstr "Sei sicuro?"
+
+#: avidemux/gtk_gui.cpp:798
+msgid "Frame Rate"
+msgstr "Frame rate"
+
+#: avidemux/gtk_gui.cpp:798
+msgid "_Frames per second:"
+msgstr "_Fotogrammi al secondo:"
+
+#: avidemux/gtk_gui.cpp:821
+msgid "Width is not a multiple of 8"
+msgstr "La larghezza non ? un multiplo di 8"
+
+#: avidemux/gtk_gui.cpp:822
+msgid "This will make trouble for AVI files."
+msgstr "Questo causer? un problema per i file AVI."
+
+#: avidemux/gtk_gui.cpp:832
+msgid "Rebuild all Keyframes?"
+msgstr "Ricostruire tutti i fotogrammi chiave?"
+
+#: avidemux/gtk_gui.cpp:890
+msgid "Permission error"
+msgstr "Errore di permesso"
+
+#: avidemux/gtk_gui.cpp:893
+#, c-format
+msgid "\"%s\" does not exist."
+msgstr "\"%s\" non esiste."
+
+#: avidemux/gtk_gui.cpp:935
+msgid "Cannot open project using the video loader."
+msgstr "Impossibile aprire il progetto usando il caricatore video."
+
+#: avidemux/gtk_gui.cpp:936
+msgid "Try 'File' -> 'Load/Run Project...'"
+msgstr "Prova 'File' -> 'Carica/esegui progetto...'"
+
+#: avidemux/gtk_gui.cpp:938
+msgid "Could not open the file"
+msgstr "Impossibile aprire il file"
+
+#: avidemux/gtk_gui.cpp:973
+msgid "Multiple Audio Tracks"
+msgstr "Tracce audio multiple"
+
+#: avidemux/gtk_gui.cpp:973
+msgid ""
+"The file you just loaded contains several audio tracks.\n"
+"Go to Audio->MainTrack to select the active one."
+msgstr ""
+"Il file appena caricato contiene diverse tracce audio.\n"
+"Vai a 'Audio' -> 'Traccia principale' per selezionare la traccia attiva."
+
+#: avidemux/gtk_gui.cpp:1063
+msgid "No audio decoder found for this file"
+msgstr "Nessun decodificatore trovato per questo file"
+
+#: avidemux/gtk_gui.cpp:1064
+msgid "Save (A+V) will generate bad AVI. Save audio will work."
+msgstr "Salvare (A+V) generer? un file AVI difettoso. Salvare l'audio funzioner?."
+
+#: avidemux/gtk_gui.cpp:1120
+msgid "Something failed when appending"
+msgstr "Qualcosa ? fallito nell'esecuzione"
+
+#: avidemux/gtk_gui.cpp:1129
+#: avidemux/gtk_gui.cpp:1927
+msgid "Something bad happened (II)"
+msgstr "C'? stato qualche errore (II)"
+
+#: avidemux/gtk_gui.cpp:1193
+msgid "Cannot save the audio in copy mode"
+msgstr "Impossibile salvare l'audio in modalit? copia"
+
+#: avidemux/gtk_gui.cpp:1193
+msgid "Select WAV PCM as the audio codec, otherwise the audio file would be raw PCM."
+msgstr "Seleziona il codec audio WAV PCM, altrimenti il file audio sar? PCM grezzo."
+
+#: avidemux/gtk_gui.cpp:1201
+#: avidemux/gtk_gui.cpp:1557
+msgid "Saving audio"
+msgstr "Salvataggio audio in corso"
+
+#: avidemux/gtk_gui.cpp:1278
+msgid "Get Frame"
+msgstr "Prendi fotogramma"
+
+#: avidemux/gtk_gui.cpp:1278
+msgid "Cannot get this frame to save"
+msgstr "Impossibile salvare questo fotogramma"
+
+#: avidemux/gtk_gui.cpp:1315
+msgid "Mark A > B"
+msgstr "Segnalibro A > B"
+
+#: avidemux/gtk_gui.cpp:1315
+msgid "Set your markers correctly."
+msgstr "Imposta i tuoi segnalibri correttamente."
+
+#: avidemux/gtk_gui.cpp:1324
+msgid "Saving as set of jpegs"
+msgstr "Salvataggio come gruppo di jpeg in corso"
+
+#: avidemux/gtk_gui.cpp:1330
+msgid "Cannot decode frame"
+msgstr "Impossibile decodificare il fotogramma"
+
+#: avidemux/gtk_gui.cpp:1330
+msgid "Aborting."
+msgstr "Annullamento in corso."
+
+#: avidemux/gtk_gui.cpp:1341
+#: avidemux/gtk_gui.cpp:1360
+#: avidemux/gtk_gui.cpp:2271
+msgid "Done"
+msgstr "Fatto"
+
+#: avidemux/gtk_gui.cpp:1341
+#, c-format
+msgid "Saved %d images."
+msgstr "%d immagini salvate."
+
+#: avidemux/gtk_gui.cpp:1343
+msgid "Error"
+msgstr "Errore"
+
+#: avidemux/gtk_gui.cpp:1343
+msgid "Could not save all images."
+msgstr "Impossibile salvare tutte le immagini."
+
+#: avidemux/gtk_gui.cpp:1360
+#, c-format
+msgid "Saved \"%s\"."
+msgstr "\"%s\" salvato."
+
+#: avidemux/gtk_gui.cpp:1362
+msgid "BMP op failed"
+msgstr "Op. BMP fallita"
+
+#: avidemux/gtk_gui.cpp:1362
+#, c-format
+msgid "Saving %s as a BMP file failed."
+msgstr "Salvataggio di %s come file BMP fallito."
+
+#: avidemux/gtk_gui.cpp:1382
+#: avidemux/gtk_gui.cpp:1448
+msgid "Failed to open the file"
+msgstr "L'apertura del file ? fallita"
+
+#: avidemux/gtk_gui.cpp:1382
+#: avidemux/gtk_gui.cpp:1448
+msgid "Not a WAV file?"
+msgstr "Non ? un file WAV?"
+
+#: avidemux/gtk_gui.cpp:1383
+#, c-format
+msgid "WAV open file failed..."
+msgstr "L'apertura del file WAV ? fallita"
+
+#: avidemux/gtk_gui.cpp:1518
+msgid "Cannot decompress audio frame"
+msgstr "Impossibile decomprimere il segmento audio"
+
+#: avidemux/gtk_gui.cpp:1532
+msgid "Memory Error"
+msgstr "Errore di memoria"
+
+#: avidemux/gtk_gui.cpp:1578
+msgid "No frames to encode"
+msgstr "Nessun fotogramma da codificare"
+
+#: avidemux/gtk_gui.cpp:1578
+msgid "Please check markers. Is \"A>\" == \">B\"?"
+msgstr "Controlla i segnalibri. ? \"A>\" == \">B\"?"
+
+#: avidemux/gtk_gui.cpp:1697
+msgid "Saving raw video stream"
+msgstr "Salvataggio flusso video grezzo in corso"
+
+#: avidemux/gtk_gui.cpp:1843
+msgid "Checking video"
+msgstr "Verifica video in corso"
+
+#: avidemux/gtk_gui.cpp:1859
+msgid "No error found"
+msgstr "Nessun errore trovato"
+
+#: avidemux/gtk_gui.cpp:1863
+#, c-format
+msgid "Errors found in %u frames"
+msgstr "Errore trovato nel fotogramma %u"
+
+#: avidemux/gtk_gui.cpp:1881
+msgid "Cannot decompress the audio stream"
+msgstr "Impossibile decomprimere il flusso audio"
+
+#: avidemux/gtk_gui.cpp:1881
+msgid "Switch audio codec to Copy."
+msgstr "Sposta la codifica audio su Copia."
+
+#: avidemux/gtk_gui.cpp:1908
+msgid "Cannot delete the selection."
+msgstr "Impossibile eliminare la selezione."
+
+#: avidemux/gtk_gui.cpp:1913
+msgid "You can't remove all frames"
+msgstr "Non puoi rimuovere tutti i fotogrammi."
+
+#: avidemux/gtk_gui.cpp:1989
+msgid "Could not get tracks info"
+msgstr "Impossibile ottenere informazioni sulla traccia"
+
+#: avidemux/gtk_gui.cpp:1997
+msgid "Video"
+msgstr "Video"
+
+#: avidemux/gtk_gui.cpp:1997
+msgid "Take audio from video file"
+msgstr "Recupera audio dal file video"
+
+#: avidemux/gtk_gui.cpp:1998
+#: avidemux/gtk_gui.cpp:2097
+msgid "No audio"
+msgstr "Nessuna traccia audio"
+
+#: avidemux/gtk_gui.cpp:1999
+#: avidemux/gtk_gui.cpp:2098
+msgid "External AC3"
+msgstr "AC3 esterno"
+
+#: avidemux/gtk_gui.cpp:1999
+#: avidemux/gtk_gui.cpp:2098
+msgid "Take audio from external AC3 file"
+msgstr "Prendi l'audio da un file AC3 esterno"
+
+#: avidemux/gtk_gui.cpp:2000
+#: avidemux/gtk_gui.cpp:2099
+msgid "External MP3"
+msgstr "MP3 esterno"
+
+#: avidemux/gtk_gui.cpp:2000
+#: avidemux/gtk_gui.cpp:2099
+msgid "Take audio from external MP3 file"
+msgstr "Prendi l'audio da un file MP3 esterno"
+
+#: avidemux/gtk_gui.cpp:2001
+#: avidemux/gtk_gui.cpp:2100
+msgid "External WAV"
+msgstr "WAV esterno"
+
+#: avidemux/gtk_gui.cpp:2001
+#: avidemux/gtk_gui.cpp:2100
+msgid "Take audio from external WAV file"
+msgstr "Prendi l'audio da un file WAV esterno"
+
+#: avidemux/gtk_gui.cpp:2005
+#: avidemux/gtk_gui.cpp:2105
+msgid "_Audio source:"
+msgstr "Sorgente _audio:"
+
+#: avidemux/gtk_gui.cpp:2009
+#: avidemux/gtk_gui.cpp:2106
+msgid "_External file:"
+msgstr "File _esterno:"
+
+#: avidemux/gtk_gui.cpp:2024
+msgid "_Track from video:"
+msgstr "_Traccia dal video:"
+
+#: avidemux/gtk_gui.cpp:2034
+msgid "Main Audio Track"
+msgstr "Traccia audio principale"
+
+#: avidemux/gtk_gui.cpp:2040
+#: avidemux/gtk_gui.cpp:2118
+msgid "Cannot load"
+msgstr "Impossibile caricare"
+
+#: avidemux/gtk_gui.cpp:2040
+#: avidemux/gtk_gui.cpp:2118
+msgid "The selected audio file does not exist."
+msgstr "Il file audio selezionato non esiste."
+
+#: avidemux/gtk_gui.cpp:2115
+msgid "Second Audio Track"
+msgstr "Traccia audio secondaria"
+
+#: avidemux/gtk_gui.cpp:2147
+msgid "Error loading the MP3 file"
+msgstr "Errore nel caricamento del file MP3"
+
+#: avidemux/gtk_gui.cpp:2156
+#: avidemux/gtk_gui.cpp:2178
+#: avidemux/gtk_gui.cpp:2200
+msgid "Second track loaded"
+msgstr "Seconda traccia caricata"
+
+#: avidemux/gtk_gui.cpp:2170
+msgid "Error loading the AC3 file"
+msgstr "Errore nel caricamento del file AC3"
+
+#: avidemux/gtk_gui.cpp:2192
+msgid "Error loading the WAV file"
+msgstr "Errore nel caricamento del file WAV"
+
+#: avidemux/gtk_gui.cpp:2259
+msgid "Saving failed"
+msgstr "Salvataggio fallito"
+
+#: avidemux/gtk_gui.cpp:2259
+msgid "Saving the job failed. Maybe you have permission issue with ~/.avidemux"
+msgstr "Il salvataggio dell'attivit? ? fallito. Forse c'? un problema di permesso con ~/.avidemux"
+
+#: avidemux/gtk_gui.cpp:2271
+#, c-format
+msgid "File %s has been successfully saved."
+msgstr "Il file %s ? stato salvato con successo."
+
+#: avidemux/gtk_gui.cpp:2275
+#, c-format
+msgid "File %s was NOT saved correctly."
+msgstr "Il file %s non ? stato salvato correttamente."
+
+#: avidemux/gtk_gui.cpp:2429
+msgid "AvsProxy"
+msgstr "AvsProxy"
+
+#: avidemux/gtk_gui.cpp:2429
+msgid ""
+"Failed to connect to avsproxy.\n"
+"Is it running ?"
+msgstr ""
+"Connessione a avsproxy fallita.\n"
+"? in esecuzione?"
+
+#: avidemux/gtk_gui.cpp:2434
+msgid "avsproxy"
+msgstr "avsproxy"
+
+#: avidemux/gtk_gui.cpp:2462
+msgid "Frame type:"
+msgstr "Tipo di fotogramma:"
+
+#: avidemux/gtk_gui.cpp:2463
+msgid "Frame size:"
+msgstr "Dimensione fotogramma:"
+
+#: avidemux/gtk_gui.cpp:2465
+msgid "Frame Hex Dump"
+msgstr "Hex Dump _fotogramma"
+
+#: avidemux/guiplay.cpp:365
+msgid "Trouble initializing audio device"
+msgstr "Problema nell'inizializzare il dispositivo audio"
+
+#: avidemux/gui_autodrive.cpp:52
+msgid "No audio track"
+msgstr "Nessuna traccia audio"
+
+#: avidemux/gui_autodrive.cpp:52
+msgid "An audio track is necessary to create such file"
+msgstr "? necessaria una traccia audio per creare questo tipo di file"
+
+#: avidemux/gui_autodrive.cpp:82
+msgid "Cannot select mpeg4 sp codec."
+msgstr "Impossibile selezionare il codec mpeg4 sp."
+
+#: avidemux/gui_autodrive.cpp:117
+msgid ""
+"You don't have FAAC!.\n"
+"It is needed to create PSP compatible video."
+msgstr ""
+"Non disponi di FAAC.\n"
+"? necessario per creare video compatibili con PSP."
+
+#: avidemux/GUI_jobs.cpp:37
+msgid "Something very wrong happened when building joblist."
+msgstr "Errore grave durante la costruzione della lista attivit?."
+
+#: avidemux/GUI_jobs.cpp:42
+msgid "There are no jobs stored"
+msgstr "Non ci sono attivit? immagazzinate"
+
+#: avidemux/gui_navigate.cpp:76
+#: avidemux/gui_navigate.cpp:114
+#: avidemux/gui_navigate.cpp:390
+#: avidemux/gui_navigate.cpp:426
+msgid "Decompressing error"
+msgstr "Errore decompressione"
+
+#: avidemux/gui_navigate.cpp:76
+msgid "Cannot decode next frame."
+msgstr "Impossibile decodificare il prossimo fotogramma."
+
+#: avidemux/gui_navigate.cpp:114
+#: avidemux/gui_navigate.cpp:426
+msgid "Cannot decode keyframe."
+msgstr "Impossibile decodificare il fotogramma chiave."
+
+#: avidemux/gui_navigate.cpp:237
+msgid "Seeking"
+msgstr "Ricerca in corso"
+
+#: avidemux/gui_navigate.cpp:315
+msgid "Finding black frames"
+msgstr "Ricerca fotogrammi neri"
+
+#: avidemux/gui_navigate.cpp:390
+msgid "Cannot decode the frame."
+msgstr "Impossibile decodificare il fotogramma."
+
+#: avidemux/gui_savenew.cpp:87
+msgid "Dual audio can only be used in copy mode"
+msgstr "Il doppio audio pu? essere usato solo in modalit? copia"
+
+#: avidemux/gui_savenew.cpp:87
+msgid "Select Copy as the video codec."
+msgstr "Seleziona Copia come codec video."
+
+#: avidemux/gui_savenew.cpp:197
+#: avidemux/gui_savenew.cpp:213
+#: avidemux/gui_savenew.cpp:226
+msgid "Incompatible output format"
+msgstr "Formato in uscita incompatibile"
+
+#: avidemux/gui_savenew.cpp:244
+msgid "There is no second track"
+msgstr "Non c'? una seconda traccia"
+
+#: avidemux/gui_savenew.cpp:244
+msgid "Select a second audio track in the Audio menu."
+msgstr "Seleziona una seconda traccia nel menu Audio."
+
+#: avidemux/gui_savenew.cpp:248
+msgid "Select dual audio AVI to write"
+msgstr "Seleziona il file AVI con doppio audio da scrivere"
+
+#: avidemux/gui_savenew.cpp:270
+#: avidemux/gui_savenew.cpp:288
+msgid "This cannot have packed VOP"
+msgstr "Non pu? avere VOP compressi"
+
+#: avidemux/gui_savenew.cpp:270
+#: avidemux/gui_savenew.cpp:288
+msgid "It is not MPEG-4 video. File will not be saved."
+msgstr "Non ? un video MPEG-4. Il file non verr? salvato."
+
+#: avidemux/gui_savenew.cpp:334
+msgid ""
+"You may need smart copy.\n"
+" Enable it ?"
+msgstr ""
+"Potresti avere bisogno di una copia intelligente.\n"
+"Attivarla?"
+



From mean at mail.berlios.de  Fri Jul 13 07:45:39 2007
From: mean at mail.berlios.de (mean at BerliOS)
Date: Fri, 13 Jul 2007 07:45:39 +0200
Subject: [Avidemux-svn-commit] r3359 -
	branches/avidemux_2.4_branch/avidemux/ADM_inputs/ADM_asf
Message-ID: <200707130545.l6D5jdeH001200@sheep.berlios.de>

Author: mean
Date: 2007-07-13 07:45:39 +0200 (Fri, 13 Jul 2007)
New Revision: 3359

Modified:
   branches/avidemux_2.4_branch/avidemux/ADM_inputs/ADM_asf/ADM_asf.cpp
Log:
[ASF]dont assert

Modified: branches/avidemux_2.4_branch/avidemux/ADM_inputs/ADM_asf/ADM_asf.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_inputs/ADM_asf/ADM_asf.cpp	2007-07-12 18:07:18 UTC (rev 3358)
+++ branches/avidemux_2.4_branch/avidemux/ADM_inputs/ADM_asf/ADM_asf.cpp	2007-07-13 05:45:39 UTC (rev 3359)
@@ -185,7 +185,7 @@
 
 uint32_t asfHeader::getFlags(uint32_t frame,uint32_t *flags)
 {
-  ADM_assert(frame<nbImage);
+  if(frame>=nbImage) return 0;
   if(!frame) *flags=AVI_KEY_FRAME;
   else 
       *flags=_index[frame].flags;



From gruntster at mail.berlios.de  Fri Jul 13 17:22:34 2007
From: gruntster at mail.berlios.de (gruntster at mail.berlios.de)
Date: Fri, 13 Jul 2007 17:22:34 +0200
Subject: [Avidemux-svn-commit] r3360 -
	branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_utilities
Message-ID: <200707131522.l6DFMYUB019967@sheep.berlios.de>

Author: gruntster
Date: 2007-07-13 17:22:27 +0200 (Fri, 13 Jul 2007)
New Revision: 3360

Modified:
   branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_utilities/ADM_image.h
   branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_utilities/ADM_imageResizer.cpp
Log:
add RGB support to ADMImageResizer

Modified: branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_utilities/ADM_image.h
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_utilities/ADM_image.h	2007-07-13 05:45:39 UTC (rev 3359)
+++ branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_utilities/ADM_image.h	2007-07-13 15:22:27 UTC (rev 3360)
@@ -149,25 +149,26 @@
 //
 //  Simple image resizer
 //
-
-
 class ADMImageResizer
 {
-private:
-        void    *_context;
-        uint32_t orgWidth,orgHeight;
-        uint32_t destWidth,destHeight;
-public:
-                ADMImageResizer(uint32_t ow,uint32_t oh, uint32_t dw, uint32_t dh);
-                ~ADMImageResizer();
-       uint8_t  resize(ADMImage *src,ADMImage *dest);
+	private:
+		void    *_context;
+		uint32_t orgFormat, destFormat;
+		uint32_t orgWidth, orgHeight;
+		uint32_t destWidth, destHeight;
+
+		void init(uint32_t ow, uint32_t oh, uint32_t dw, uint32_t dh, int srcFormat, int dstFormat);
+		void getYuvPlanes(uint8_t *source, uint32_t width, uint32_t height, uint8_t*& yPlane, uint8_t*& uPlane, uint8_t*& vPlane);
+	public:
+		ADMImageResizer(uint32_t ow,uint32_t oh, uint32_t dw, uint32_t dh);
+		ADMImageResizer(uint32_t ow, uint32_t oh, uint32_t dw, uint32_t dh, int srcFormat, int dstFormat);
+		~ADMImageResizer();
+		
+		uint8_t resize(ADMImage *src, ADMImage *dest);
+		uint8_t resize(uint8_t *src, uint8_t *dest);
 };
 
-
-
-
 // Misc utilities
-
 uint8_t BitBlit(uint8_t *dst, uint32_t pitchDest,uint8_t *src,uint32_t pitchSrc,uint32_t width, uint32_t height);
 
 #endif

Modified: branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_utilities/ADM_imageResizer.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_utilities/ADM_imageResizer.cpp	2007-07-13 05:45:39 UTC (rev 3359)
+++ branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_utilities/ADM_imageResizer.cpp	2007-07-13 15:22:27 UTC (rev 3360)
@@ -27,75 +27,120 @@
 #include "ADM_lavcodec/avcodec.h"
 }
 #endif
-#include "ADM_lavutil/avutil.h"
 #include "ADM_libswscale/swscale.h"
 
+ADMImageResizer::ADMImageResizer(uint32_t ow, uint32_t oh, uint32_t dw, uint32_t dh)
+{
+	init(ow, oh, dw, dh, PIX_FMT_YUV420P, PIX_FMT_YUV420P);
+}
 
-ADMImageResizer::ADMImageResizer(uint32_t ow,uint32_t oh, uint32_t dw, uint32_t dh)
+ADMImageResizer::ADMImageResizer(uint32_t ow, uint32_t oh, uint32_t dw, uint32_t dh, int srcFormat, int destFormat)
 {
-int flags=0;
+	init(ow, oh, dw, dh, srcFormat, destFormat);
+}
 
-    orgWidth=ow;
-    orgHeight=oh;
-    destWidth=dw;
-    destHeight=dh;
+ADMImageResizer::~ADMImageResizer()
+{
+   if (_context)
+   {
+		sws_freeContext((SwsContext*)_context);
+		_context = NULL;
+   }
+}
 
-    flags=SWS_SPLINE;
+void ADMImageResizer::init(uint32_t ow, uint32_t oh, uint32_t dw, uint32_t dh, int srcFormat, int dstFormat)
+{
+    orgWidth = ow;
+    orgHeight = oh;
+    destWidth = dw;
+    destHeight = dh;
+
+	orgFormat = srcFormat;
+	destFormat = dstFormat;
+
+	int flags = SWS_SPLINE;
+
 #if (defined( ARCH_X86)  || defined(ARCH_X86_64))
-        #define ADD(x,y) if( CpuCaps::has##x()) flags|=SWS_CPU_CAPS_##y;
-        ADD(MMX,MMX);		
-        ADD(3DNOW,3DNOW);
-        ADD(MMXEXT,MMX2);
-#endif	
+	#define ADD(x, y) if (CpuCaps::has##x()) flags |= SWS_CPU_CAPS_##y;
+
+	ADD(MMX,MMX);
+	ADD(3DNOW,3DNOW);
+	ADD(MMXEXT,MMX2);
+#endif
+
 #ifdef USE_ALTIVEC
-        flags|=SWS_CPU_CAPS_ALTIVEC;
+    flags |= SWS_CPU_CAPS_ALTIVEC;
 #endif
-            _context=(void *)sws_getContext(
-                        orgWidth,orgHeight,
-                        PIX_FMT_YUV420P,
-                        destWidth,destHeight,
-                        PIX_FMT_YUV420P,
-                        flags, NULL, NULL,NULL);
-            
+
+	_context = (void *)sws_getContext(orgWidth, orgHeight,
+									  srcFormat,
+									  destWidth, destHeight,
+									  destFormat,
+									  flags, NULL, NULL,NULL);
 }
 
-ADMImageResizer::~ADMImageResizer()
+uint8_t ADMImageResizer::resize(ADMImage *source, ADMImage *dest)
 {
-   if(_context)
-    {
-        sws_freeContext((SwsContext*)_context);
-    }
-    _context=NULL;
+    ADM_assert(source->_width == orgWidth);
+    ADM_assert(source->_height == orgHeight);
+    ADM_assert(dest->_width == destWidth);
+    ADM_assert(dest->_height == destHeight);
+
+	return resize(source->data, dest->data);
 }
 
-uint8_t ADMImageResizer::resize(ADMImage *source,ADMImage *dest)
+uint8_t ADMImageResizer::resize(uint8_t *source, uint8_t *dest)
 {
-    ADM_assert(source->_width==orgWidth);
-    ADM_assert(source->_height==orgHeight);
-    ADM_assert(dest->_width==destWidth);
-    ADM_assert(dest->_height==destHeight);
+	uint8_t *src[3];
+	uint8_t *dst[3];
+	int ssrc[3];
+	int ddst[3];
 
+	if (orgFormat == PIX_FMT_YUV420P)
+	{
+		getYuvPlanes(source, orgWidth, orgHeight, *&src[0], *&src[1], *&src[2]);
 
-uint8_t *src[3];
-uint8_t *dst[3];
-int ssrc[3];
-int ddst[3];
+		ssrc[0] = orgWidth;
+		ssrc[1] = ssrc[2] = orgWidth >> 1;
+	}
+	else	// RGB
+	{
+		src[0] = source;
+		src[1] = NULL;
+		src[2] = NULL;
 
-                src[0]=YPLANE(source);
-                src[1]=UPLANE(source);
-                src[2]=VPLANE(source);
+		ssrc[0]=orgWidth * 4;
+		ssrc[1] = 0;
+		ssrc[2] = 0;
+	}
 
-                ssrc[0]=orgWidth;
-                ssrc[1]=ssrc[2]=orgWidth>>1;
+	if (destFormat == PIX_FMT_YUV420P)
+	{
+		getYuvPlanes(dest, destWidth, destHeight, *&dst[0], *&dst[1], *&dst[2]);
 
-         
-                dst[0]=YPLANE(dest);
-                dst[1]=UPLANE(dest);
-                dst[2]=VPLANE(dest);
-                ddst[0]=destWidth;
-                ddst[1]=ddst[2]=destWidth>>1;
+		ddst[0] = destWidth;
+		ddst[1] = ddst[2] = destWidth >> 1;
+	}
+	else	// RGB
+	{
+		dst[0] = dest;
+		dst[1] = NULL;
+		dst[2] = NULL;
 
-                sws_scale((SwsContext*)_context,src,ssrc,0,orgHeight,dst,ddst);
-                return 1;
+		ddst[0] = destWidth * 4;
+		ddst[1] = 0;
+		ddst[2] = 0;
+	}
 
+    sws_scale((SwsContext*)_context, src, ssrc, 0, orgHeight, dst, ddst);
+
+    return 1;
 }
+
+void ADMImageResizer::getYuvPlanes(uint8_t *source, uint32_t width, uint32_t height, uint8_t*& yPlane, uint8_t*& uPlane, uint8_t*& vPlane)
+{
+	// Unfortunately xPLANE macros expect an ADMImage object so doubling up on logic.
+	yPlane = source;
+	uPlane = source + (width * height);
+	vPlane = source + (5 * (width * height) >> 2);
+}



From mean at mail.berlios.de  Fri Jul 13 19:01:25 2007
From: mean at mail.berlios.de (mean at BerliOS)
Date: Fri, 13 Jul 2007 19:01:25 +0200
Subject: [Avidemux-svn-commit] r3361 - in
	branches/avidemux_2.4_branch/avidemux: ADM_ocr ADM_osSupport
	ADM_userInterfaces/ADM_GTK/ADM_ocr
Message-ID: <200707131701.l6DH1PNx030914@sheep.berlios.de>

Author: mean
Date: 2007-07-13 19:01:23 +0200 (Fri, 13 Jul 2007)
New Revision: 3361

Added:
   branches/avidemux_2.4_branch/avidemux/ADM_ocr/ADM_ocr.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_ocr/ADM_ocr.h
Removed:
   branches/avidemux_2.4_branch/avidemux/ADM_ocr/ADM_ocrLoadSave.h
Modified:
   branches/avidemux_2.4_branch/avidemux/ADM_ocr/CMakeLists.txt
   branches/avidemux_2.4_branch/avidemux/ADM_ocr/Makefile.am
   branches/avidemux_2.4_branch/avidemux/ADM_ocr/adm_glyph.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_ocr/adm_glyph.h
   branches/avidemux_2.4_branch/avidemux/ADM_osSupport/ADM_crashdump.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_ocr/adm_editglyph.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_ocr/adm_ocr.cpp
Log:
[OCR] cleanup

Copied: branches/avidemux_2.4_branch/avidemux/ADM_ocr/ADM_ocr.cpp (from rev 3352, branches/avidemux_2.4_branch/avidemux/ADM_ocr/adm_glyph.cpp)
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_ocr/adm_glyph.cpp	2007-07-09 14:04:04 UTC (rev 3352)
+++ branches/avidemux_2.4_branch/avidemux/ADM_ocr/ADM_ocr.cpp	2007-07-13 17:01:23 UTC (rev 3361)
@@ -0,0 +1,280 @@
+/***************************************************************************
+      UI independant part of the OCR engine
+      (C) 2007 Mean
+ ***************************************************************************/
+/***************************************************************************
+ *                                                                         *
+ *   This program is free software; you can redistribute it and/or modify  *
+ *   it under the terms of the GNU General Public License as published by  *
+ *   the Free Software Foundation; either version 2 of the License, or     *
+ *   (at your option) any later version.                                   *
+ *                                                                         *
+ ***************************************************************************/
+ #include "config.h"
+ #include <stdio.h>
+ #include <stdlib.h>
+ #include <string.h>
+ #include "ADM_assert.h"
+ #include "default.h"
+ #include "ADM_ocr.h"
+ #include "ADM_toolkit/toolkit.hxx"
+ #include "ADM_userInterfaces/ADM_commonUI/DIA_enter.h"
+
+static uint32_t minThreshold=0x80;
+
+/* In the UI related code */
+extern ReplyType glyphToText(admGlyph *glyph);
+extern void UI_purge(void);
+
+extern uint8_t adm_estimate_glyphSize(admGlyph *glyph,uint32_t *minx, uint32_t *maxx,uint32_t *miny,uint32_t *maxy,int *raw);
+
+static uint32_t minAlpha=7; /* Below minAlpha is is considered black */
+
+/**
+      \fn mergeBitmap
+      \brief Merge bitmap with alpha mask so that we go a black & white output
+      @param bitin bitmap (input)
+      @param bitout B&W bitmap (output)
+      @param maskin alpha mask (input)
+      @param w width of bitmap
+      @param h height of bitmap
+
+*/
+uint8_t mergeBitmap(uint8_t *bitin, uint8_t *bitout, uint8_t *maskin,uint32_t w, uint32_t h)
+{
+// Merge with alpha channel
+           uint8_t *in,*mask,*out;
+           uint32_t alp,nw;
+           in=bitin;
+           out=bitout;
+           mask=maskin;
+           for(uint32_t y=0;y<h;y++)
+           {
+            for(uint32_t x=0;x<w;x++)
+            {
+                   
+                    nw=in[x];
+                    alp=mask[x];
+
+                    if(alp>minAlpha&& nw >minThreshold)  nw=0xff;
+                         else       nw=0;
+                        
+                    out[x]=nw;
+            }
+            out+=w;
+            in+=w;
+            mask+=w;
+           }    
+    return 1;
+}
+/**
+      \fn ocrBitmap
+      \brief Split the bitmap into glyphes, ocr glyphes and output text
+      @param workArea, Bitmap to work with
+      @param w width of bitmap
+      @param h height of bitmap
+      @param decodedString Will contain ocr'ed text
+*/
+ReplyType ocrBitmap(uint8_t *workArea,uint32_t w,uint32_t h,char *decodedString)
+{
+uint8_t found;
+uint32_t colstart=0,colend=0,oldcol;
+uint32_t line=0,nbLine=1;
+uint32_t base=0,bottom,top;    
+ReplyType reply;
+    // Search First non nul colum
+    decodedString[0]=0;
+    // Search how much lines there is in the file
+    //
+    top=bottom=0;
+    while(top<h)
+    {
+        // Search non empty line as top
+        while(top<h && lineEmpty(workArea,w,w,top)) top++;
+        // Nothing found
+        if(top>=h-1) break;
+
+        // 
+       
+
+        bottom=top+1;
+        // Search empty line if any, bottom is the 1st line full of zero
+        while(bottom<h && (!lineEmpty(workArea,w,w,bottom) || bottom-top<7))
+        {
+            bottom++;
+        }
+        if(line) strcat(decodedString,"\n"); 
+        //printf("\n Top:%lu bottom:%lu\n",top,bottom);
+       
+        // Scan a full line
+        colstart=0;
+        oldcol=0;
+       
+        // Split a line into glyphs
+        while(colstart<w)
+        {
+            UI_purge();
+            oldcol=colstart;
+            while( columnEmpty(workArea+colstart+top*w, w, bottom-top) && colstart<w) colstart++;
+            if(colstart>=w) break;
+            // if too far apart, it means probably a blank space
+            if(colstart-oldcol>6)
+            {
+                strcat(decodedString," ");
+            }
+       
+            // We have found a non null column
+            // Seek the end now
+            colend=colstart+1;
+            while( !columnEmpty(workArea+colend+top*w, w, bottom-top) && colend<w) colend++;
+         
+         
+            // printf("Found glyph: %lu %lu\n",colstart,colend);  
+            reply=handleGlyph(workArea,colstart,colend,w,bottom,top);
+            switch(reply)
+                {
+                        case ReplySkip:break;
+                        case ReplyOk:break;
+                        case ReplyClose:
+                        case ReplyCalibrate: return reply;break;
+            
+                        case ReplySkipAll: return ReplyOk;break;
+                        default: ADM_assert(0);
+                }
+            
+            
+            colstart=colend;
+      }
+      line++;      
+      top=bottom;
+      
+    }
+   
+    return ReplyOk;
+}
+
+/**
+      \fn handleGlyph
+      \brief Handle ONE glyph
+      @param workArea full bitmap to OCR 
+      @param start Start column of glyph
+      @param end end column of glyph
+      @param w Width of bitmap
+      @param h Height of bitmap
+      @param base Baseline of glyph
+    We now have a good candidate for the glyph.
+    We will do the following processing :
+        - Clip the glyph to have it in its bounding box
+        - extract its container. If the container is smaller than the glyph, it means
+                that we have in fact several glyphs that overlaps slightly. In
+                that case we use another method to extract the glyph.
+                We split it using leftturn method and do it again.
+*/
+ReplyType handleGlyph(uint8_t *workArea,uint32_t start, uint32_t end,uint32_t w,uint32_t h,uint32_t base)
+{
+uint8_t found=0;
+static int inc=1;
+ReplyType reply;
+          
+    
+    // Ok now we have the cropped glyp
+    
+    admGlyph *glyph,*cand;
+    uint32_t minx,maxx,miny,maxy;
+    int     *raw=NULL;
+            glyph=new admGlyph(end-start,h-base);
+            glyph->create(workArea+start+base*w,w);
+            glyph=clippedGlyph(glyph);
+            if(!glyph->width) // Empty glyph
+            {
+                delete glyph;
+                return ReplyOk;
+            }
+            // now we have our full glyph, try harder to split it
+_nextglyph:
+            raw=new int[glyph->height];            
+            if(adm_estimate_glyphSize(glyph,&minx, &maxx,&miny,&maxy,raw))
+            {
+            //printf("Glyph width :%lu min:%lu max:%lu estimate width:%lu\n",glyph->width,minx,maxx,maxx-minx+1);
+            if((maxx-minx+2)<glyph->width && (maxx-minx>2) && (maxy-miny>2))
+            {
+                // Suspicously too small
+                // We have to split the glyph
+                // recursively to extract each glyph
+                uint32_t width=maxx-minx+1;
+                uint32_t defStride=width+1;
+                
+                if(defStride>glyph->width) defStride=glyph->width;
+                
+                admGlyph *lefty=new admGlyph(defStride,glyph->height);
+                for(int32_t i=miny;i<=maxy;i++)
+                {
+                    if(raw[i]!=-1) memcpy(&(lefty->data[0+i*defStride]),&(glyph->data[minx+i*glyph->width]),raw[i]+1-minx);
+                    else
+                            memcpy(&(lefty->data[0+i*defStride]),&(glyph->data[minx+i*glyph->width]),defStride);
+                }
+                lefty=clippedGlyph(lefty);
+              
+                {
+                    // Remove that from the original
+                    for(uint32_t i=0;i<glyph->height;i++)
+                    {
+                        //printf("%d:%d(%d)\n",i,raw[i],glyph->width);
+                        if(raw[i]!=-1) memset(&(glyph->data[i*glyph->width]),0,raw[i]+1);
+                        else           memset(&(glyph->data[i*glyph->width]),0,defStride); 
+                    }
+                    // Clip
+                    glyph=clippedGlyph(glyph);
+                
+                    if(lefty->width)
+                    {
+                        reply=glyphToText(lefty);
+                        if(reply!=ReplyOk)
+                        {
+                            printf("Glyph2text failed(1)\n");
+                            return reply;
+                        }
+                    }
+                    else
+                        delete lefty;
+                    if(glyph->width)
+                    {
+                        if(raw) delete [] raw;
+                        goto _nextglyph;                    
+                    } 
+                 }           
+            }
+            }//If
+            if(raw) delete [] raw;
+            if(glyph->width)
+            {
+                reply=glyphToText(glyph);
+                if(reply!=ReplyOk)                 
+                {
+                    printf("Glyph2text failed(2)\n");
+                    return reply;
+                }
+            }
+            else 
+            {
+                delete glyph;
+            }
+            
+    return ReplyOk;
+
+}
+/**
+      \fn ocrUpdateMinThreshold
+      \brief update the threshold to say black or white when we merge bitmap and alpha mask
+*/
+void ocrUpdateMinThreshold(void)
+{
+        int val;
+        val=minThreshold;
+        if(DIA_GetIntegerValue(&val, 0x30, 0x80, "Minimum pixel value", "Enter new minimum pixel"))
+        {
+                minThreshold=val;
+
+        }
+}
+//EOF

Copied: branches/avidemux_2.4_branch/avidemux/ADM_ocr/ADM_ocr.h (from rev 3352, branches/avidemux_2.4_branch/avidemux/ADM_ocr/ADM_leftturn.h)
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_ocr/ADM_leftturn.h	2007-07-09 14:04:04 UTC (rev 3352)
+++ branches/avidemux_2.4_branch/avidemux/ADM_ocr/ADM_ocr.h	2007-07-13 17:01:23 UTC (rev 3361)
@@ -0,0 +1,30 @@
+//
+// C++ Interface: %{MODULE}
+//
+// Description: 
+//
+//
+// Author: %{AUTHOR} <%{EMAIL}>, (C) %{YEAR}
+//
+// Copyright: See COPYING file that comes with this distribution
+//
+//
+#ifndef ADM_OCR_H
+#define ADM_OCR_H
+#include "adm_glyph.h"
+
+
+typedef enum 
+{
+        ReplyOk=1,
+        ReplyClose=0,
+        ReplyCalibrate=2,
+        ReplySkip=3,
+        ReplySkipAll=4
+}ReplyType;
+
+ReplyType handleGlyph(uint8_t *workArea,uint32_t start, uint32_t end,uint32_t w,uint32_t h,uint32_t base);
+ReplyType ocrBitmap(uint8_t *data,uint32_t w,uint32_t h,char *decodedString);
+uint8_t   mergeBitmap(uint8_t *bitin, uint8_t *bitout, uint8_t *maskin,uint32_t w, uint32_t h);
+void ocrUpdateMinThreshold(void);
+#endif 

Deleted: branches/avidemux_2.4_branch/avidemux/ADM_ocr/ADM_ocrLoadSave.h
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_ocr/ADM_ocrLoadSave.h	2007-07-13 15:22:27 UTC (rev 3360)
+++ branches/avidemux_2.4_branch/avidemux/ADM_ocr/ADM_ocrLoadSave.h	2007-07-13 17:01:23 UTC (rev 3361)
@@ -1,99 +0,0 @@
-//
-// C++ Interface: %{MODULE}
-//
-// Description: 
-//
-//
-// Author: %{AUTHOR} <%{EMAIL}>, (C) %{YEAR}
-//
-// Copyright: See COPYING file that comes with this distribution
-//
-//
-/**
- */
-uint8_t saveGlyph(void)
-{
-  FILE *out;
-  char *name=NULL;
-  uint32_t slen;
-    
-  admGlyph *glyph=head.next;
-    
-  GUI_FileSelWrite(_("Select Glyphfile to save to"), &name);
-  if(!name)
-    return 0;
-    
-  out=fopen(name,"wb");
-  ADM_dealloc(name);
-  if(!out)
-  {
-    GUI_Error_HIG(_("Could not write the file"), NULL);
-    return 0;
-  }
-#define WRITE(x) fwrite(&(x),sizeof(x),1,out);
-    WRITE(nbGlyphs);
-    
-    while(glyph)
-    {
-      WRITE(glyph->width);
-      WRITE(glyph->height);
-      fwrite(glyph->data,glyph->width*glyph->height,1,out);
-      if(glyph->code) slen=strlen(glyph->code);
-      else slen=0;
-      WRITE(slen);
-      fwrite(glyph->code,slen,1,out);
-      glyph=glyph->next;
-    }
-    
-    fclose(out);
-    return 1;
-
-}
-/**
- */
-uint8_t loadGlyph(char *name)
-{
-  FILE *out;
-  admGlyph *glyph,*nw;
-  uint32_t N,w,h,slen;
-    
-  if(head.next)
-  {
-    if(!GUI_Question(_("Erase current glyphs ?")))
-      return 0;
-    destroyGlyphTree(&head);
-    nbGlyphs=0;
-  }
-  glyph=&head;
-  out=fopen(name,"rb");
-  if(!out)
-  {
-    GUI_Error_HIG(_("File error"), _("Could not read \"%s\"."), name);
-    return 0;
-  }
-#define READ(x) fread(&(x),sizeof(x),1,out);
-    nbGlyphs=0;
-    READ(N);
-    while(N--)
-    {
-        
-      READ(w);
-      READ(h);
-      nw=new admGlyph(w,h);
-      fread(nw->data,w*h,1,out);
-      READ(slen);
-      if(slen)
-      {
-        nw->code=new char[slen+1];
-        fread(nw->code,slen,1,out);
-        nw->code[slen]=0;
-      }
-      glyph->next=nw;
-      glyph=nw;
-      nbGlyphs++;
-    }
-    
-    fclose(out);
-    return 1;
-
-}

Modified: branches/avidemux_2.4_branch/avidemux/ADM_ocr/CMakeLists.txt
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_ocr/CMakeLists.txt	2007-07-13 15:22:27 UTC (rev 3360)
+++ branches/avidemux_2.4_branch/avidemux/ADM_ocr/CMakeLists.txt	2007-07-13 17:01:23 UTC (rev 3361)
@@ -1,5 +1,7 @@
 
 SET(ADM_ocr_SRCS 
-adm_glyph.cpp  adm_leftturn.cpp  ADM_vob2vobsub.cpp)
+adm_glyph.cpp  adm_leftturn.cpp  ADM_vob2vobsub.cpp
+ADM_ocr.cpp
+)
 ADD_LIBRARY(ADM_ocr STATIC ${ADM_ocr_SRCS})
-include_directories(../ADM_inputs)
\ No newline at end of file
+include_directories(../ADM_inputs)

Modified: branches/avidemux_2.4_branch/avidemux/ADM_ocr/Makefile.am
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_ocr/Makefile.am	2007-07-13 15:22:27 UTC (rev 3360)
+++ branches/avidemux_2.4_branch/avidemux/ADM_ocr/Makefile.am	2007-07-13 17:01:23 UTC (rev 3361)
@@ -7,7 +7,7 @@
 
 libADM_ocr_a_METASOURCES = AUTO
 
-libADM_ocr_a_SOURCES =   adm_glyph.cpp adm_leftturn.cpp ADM_vob2vobsub.cpp
+libADM_ocr_a_SOURCES =   adm_glyph.cpp adm_leftturn.cpp ADM_vob2vobsub.cpp ADM_ocr.cpp
 
 
 EXTRA_DIST =  ADM_leftturn.h     ADM_vob2vobsub.cpp  adm_glyph.h  \

Modified: branches/avidemux_2.4_branch/avidemux/ADM_ocr/adm_glyph.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_ocr/adm_glyph.cpp	2007-07-13 15:22:27 UTC (rev 3360)
+++ branches/avidemux_2.4_branch/avidemux/ADM_ocr/adm_glyph.cpp	2007-07-13 17:01:23 UTC (rev 3361)
@@ -13,6 +13,7 @@
  #include "ADM_assert.h"
  #include "default.h"
  #include "adm_glyph.h"
+#include "ADM_toolkit/toolkit.hxx"
  //*************************************************
 admGlyph::admGlyph(uint32_t w,uint32_t h)
 {
@@ -154,4 +155,89 @@
   return NULL;
 }
 /*************************************************/
+/**
+    \fn       glyphSave
+    \brief    Save the glypset
+*/
+uint8_t saveGlyph(char *name,admGlyph *head,uint32_t nb)
+{
+  FILE *out;
+  uint32_t slen;
+    
+  admGlyph *glyph=head->next;
+    
+    
+  out=fopen(name,"wb");
+  if(!out)
+  {
+    GUI_Error_HIG(_("Could not write the file"), NULL);
+    return 0;
+  }
+#define WRITE(x) fwrite(&(x),sizeof(x),1,out);
+    WRITE(nb);
+    
+    while(glyph)
+    {
+      WRITE(glyph->width);
+      WRITE(glyph->height);
+      fwrite(glyph->data,glyph->width*glyph->height,1,out);
+      if(glyph->code) slen=strlen(glyph->code);
+      else slen=0;
+      WRITE(slen);
+      fwrite(glyph->code,slen,1,out);
+      glyph=glyph->next;
+    }
+    
+    fclose(out);
+    return 1;
+  
+}
+/**
+    \fn loadGlyph
+    \brief Load a glyph set
+*/
+uint8_t loadGlyph(char *name,admGlyph *head,uint32_t *outNb)
+{
+  FILE *out;
+  admGlyph *glyph,*nw;
+  uint32_t N,w,h,slen;
+  uint32_t nbGlyphs;
+ 
+  *outNb=0;
+  
+  glyph=head;
+  out=fopen(name,"rb");
+  if(!out)
+  {
+    GUI_Error_HIG(_("File error"), _("Could not read \"%s\"."), name);
+    return 0;
+  }
+#define READ(x) fread(&(x),sizeof(x),1,out);
+    nbGlyphs=0;
+    READ(N);
+    while(N--)
+    {
+        
+      READ(w);
+      READ(h);
+      nw=new admGlyph(w,h);
+      fread(nw->data,w*h,1,out);
+      READ(slen);
+      if(slen)
+      {
+        nw->code=new char[slen+1];
+        fread(nw->code,slen,1,out);
+        nw->code[slen]=0;
+      }
+      glyph->next=nw;
+      glyph=nw;
+      nbGlyphs++;
+    }
+    
+    fclose(out);
+    *outNb=nbGlyphs;
+    return 1;
 
+}
+/*************************************************/
+

Modified: branches/avidemux_2.4_branch/avidemux/ADM_ocr/adm_glyph.h
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_ocr/adm_glyph.h	2007-07-13 15:22:27 UTC (rev 3360)
+++ branches/avidemux_2.4_branch/avidemux/ADM_ocr/adm_glyph.h	2007-07-13 17:01:23 UTC (rev 3361)
@@ -60,4 +60,9 @@
 uint8_t  insertInGlyphTree(admGlyph *startGlyph, admGlyph *candidate);
 admGlyph *clippedGlyph(admGlyph *in);
 admGlyph *glyphSearchFather(admGlyph *in,admGlyph *head );
+
+uint8_t loadGlyph(char *name,admGlyph *head,uint32_t *outNb);
+uint8_t saveGlyph(char *name,admGlyph *head,uint32_t nb);
+
+
 #endif

Modified: branches/avidemux_2.4_branch/avidemux/ADM_osSupport/ADM_crashdump.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_osSupport/ADM_crashdump.cpp	2007-07-13 15:22:27 UTC (rev 3360)
+++ branches/avidemux_2.4_branch/avidemux/ADM_osSupport/ADM_crashdump.cpp	2007-07-13 17:01:23 UTC (rev 3361)
@@ -1,7 +1,7 @@
 /***************************************************************************
   Try to display interesting crash dump
 
-    copyright            : (C) 2007 by mean
+    copyright            : (C) 2007 by mean, (C) 2007 Grunster
     email                : fixounet at free.fr
  ***************************************************************************/
 

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_ocr/adm_editglyph.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_ocr/adm_editglyph.cpp	2007-07-13 15:22:27 UTC (rev 3360)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_ocr/adm_editglyph.cpp	2007-07-13 17:01:23 UTC (rev 3361)
@@ -33,8 +33,6 @@
 static admGlyph *currentGlyph=NULL;
 static GtkWidget *dialog;
 
-static uint8_t loadGlyph(char *name,admGlyph *head,uint32_t *outNb);
-static uint8_t saveGlyph(char *name,admGlyph *head,uint32_t nb);
 static gboolean glyphDraw( void );
 static gboolean glyphActivate(void);
 static void glyphUpdate(void );
@@ -265,43 +263,6 @@
 
 }
 /**
-    \fn       glyphSave
-    \brief    Save the glypset
-*/
-uint8_t saveGlyph(char *name,admGlyph *head,uint32_t nb)
-{
-  FILE *out;
-  uint32_t slen;
-    
-  admGlyph *glyph=head->next;
-    
-    
-  out=fopen(name,"wb");
-  if(!out)
-  {
-    GUI_Error_HIG(_("Could not write the file"), NULL);
-    return 0;
-  }
-#define WRITE(x) fwrite(&(x),sizeof(x),1,out);
-    WRITE(nb);
-    
-    while(glyph)
-    {
-      WRITE(glyph->width);
-      WRITE(glyph->height);
-      fwrite(glyph->data,glyph->width*glyph->height,1,out);
-      if(glyph->code) slen=strlen(glyph->code);
-      else slen=0;
-      WRITE(slen);
-      fwrite(glyph->code,slen,1,out);
-      glyph=glyph->next;
-    }
-    
-    fclose(out);
-    return 1;
-  
-}
-/**
     \fn glyphUpdate
     \brief Update all fields in the dialog wrt currentGlyph
 */
@@ -346,51 +307,7 @@
     return true;
 }
 
-/**
-    \fn loadGlyph
-    \brief Load a glyph set
-*/
-uint8_t loadGlyph(char *name,admGlyph *head,uint32_t *outNb)
-{
-  FILE *out;
-  admGlyph *glyph,*nw;
-  uint32_t N,w,h,slen;
-  uint32_t nbGlyphs;
- 
-  glyph=head;
-  out=fopen(name,"rb");
-  if(!out)
-  {
-    GUI_Error_HIG(_("File error"), _("Could not read \"%s\"."), name);
-    return 0;
-  }
-#define READ(x) fread(&(x),sizeof(x),1,out);
-    nbGlyphs=0;
-    READ(N);
-    while(N--)
-    {
-        
-      READ(w);
-      READ(h);
-      nw=new admGlyph(w,h);
-      fread(nw->data,w*h,1,out);
-      READ(slen);
-      if(slen)
-      {
-        nw->code=new char[slen+1];
-        fread(nw->code,slen,1,out);
-        nw->code[slen]=0;
-      }
-      glyph->next=nw;
-      glyph=nw;
-      nbGlyphs++;
-    }
-    
-    fclose(out);
-    *outNb=nbGlyphs;
-    return 1;
 
-}
 
 
 //**********************************

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_ocr/adm_ocr.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_ocr/adm_ocr.cpp	2007-07-13 15:22:27 UTC (rev 3360)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_ocr/adm_ocr.cpp	2007-07-13 17:01:23 UTC (rev 3361)
@@ -67,59 +67,43 @@
 #include "ADM_video/ADM_vidVobSub.h"
 #include "ADM_leftturn.h"
 #include "DIA_enter.h"
+#include "ADM_ocr.h"
 /******************************/
-#define GTK_PURGE {while (gtk_events_pending())                gtk_main_iteration(); }    
+
 #define TESTSUB "/home/fx/usbstick/subs/vts_01_0.idx"
 #define CONNECT(x,y,z) 	gtk_signal_connect(GTK_OBJECT(WID(x)), #y,GTK_SIGNAL_FUNC(z),   NULL);
-#define SUB_THRESH minThreshold
 
-typedef enum 
-{
-        ReplyOk=1,
-        ReplyClose=0,
-        ReplyCalibrate=2,
-        ReplySkip=3,
-        ReplySkipAll=4
-}ReplyType;
 
-static uint8_t mergeBitmap(uint8_t *bitin, uint8_t *bitout, uint8_t *maskin,uint32_t w, uint32_t h);
-static ReplyType ocrBitmap(uint8_t *data,uint32_t w,uint32_t h);
-static ReplyType handleGlyph(uint32_t start, uint32_t end,uint32_t w,uint32_t h,uint32_t base);
-static uint8_t lineEmpty(uint8_t *base, uint32_t stride, uint32_t width, uint32_t line);
-static uint8_t columnEmpty(uint8_t *base, uint32_t stride, uint32_t height);
-static ReplyType glyphToText(admGlyph *glyph);
-static uint8_t saveGlyph(void);
-static uint8_t loadGlyph(char *name);
-static void displaySmall( admGlyph *glyph );
-static int cb_accept(GtkObject * object, gpointer user_data);
-static ReplyType setup(void);
-static  vobSubParam subparam={NULL,0,0};
-static uint32_t minAlpha=7;
-static uint32_t minThreshold=0x80;
 
 
-/*++++++++++++++++++++++++++++++++++++++++*/
-extern  GtkWidget	*DIA_ocr(void);
+
+
+
 extern  uint8_t DIA_vobsub(vobSubParam *param);
-static gboolean gui_draw( void );
-static gboolean gui_draw_small( void );
-static char decodedString[1024];
-/*-------------------------*/
+//********************************************
+extern  GtkWidget *DIA_ocr(void);
+static gboolean   gui_draw( void );
+static gboolean   gui_draw_small( void );
+static void       displaySmall( admGlyph *glyph );
+static int        cb_accept(GtkObject * object, gpointer user_data);
+
 static GtkWidget *dialog;
 static GtkWidget *mainDisplay;
 static GtkWidget *smallDisplay;
-static vobSubBitmap *bitmap;
-
+static uint32_t redraw_x,redraw_y;
+//********************************************
+ReplyType glyphToText(admGlyph *glyph);
+static ReplyType setup(void);
+//********************************************
+static uint8_t ocrSaveGlyph(void);
+static  vobSubParam subparam={NULL,0,0};
 static uint8_t *workArea;
+static vobSubBitmap *bitmap;
 static admGlyph head(250,4);
 static uint32_t lang_index=0;
-
-
-static uint32_t redraw_x,redraw_y;
-
 static uint32_t nbGlyphs;
+static char decodedString[1024];
 
-
 typedef enum
 {
     actionLoadVob=10,
@@ -191,7 +175,7 @@
     // Everything ready go go go 
          
     redraw_x=redraw_y=0;
-    GTK_PURGE;
+    UI_purge();
 //  Time to go
     // Inactivate frame1=glyph    frame2=in/out  buttonStart
     gtk_widget_set_sensitive(WID(buttonStart),0);
@@ -268,34 +252,20 @@
            mergeBitmap(bitmap->_bitmap+first*w, workArea, bitmap->_alphaMask+first*w,  w,   h);
            if(oldw!=w || oldh !=h)
            {                
-                GTK_PURGE;  // Force redaw
+                UI_purge();  // Force redaw
            }
            // Merge
-             GTK_PURGE;
+             UI_purge();
              gui_draw();
-             GTK_PURGE; 
+             UI_purge();
              // OCR
-              reply=ocrBitmap(workArea,w,h);
+              reply=ocrBitmap(workArea,w,h,decodedString);
               if(reply==ReplyClose) goto endIt;
               if(reply==ReplyCalibrate)
                 {
                         //
                         //printf("TADA!!!!\n");
-                        int val;
-#if 0
-                         val=minAlpha;
-                        if(DIA_GetIntegerValue(&val, 3, 7, "Minimum alpha value", "Enter new minimum alpha"))
-                        {
-                                minAlpha=val;
-
-                        }
-#endif
-                        val=minThreshold;
-                        if(DIA_GetIntegerValue(&val, 0x30, 0x80, "Minimum pixel value", "Enter new minimum pixel"))
-                        {
-                                minThreshold=val;
-
-                        }
+                        ocrUpdateMinThreshold();
                         goto againPlease;
                 }
              
@@ -327,7 +297,9 @@
    // gtk_widget_set_sensitive(WID(Current_Glyph),0); 
     
     if(nbGlyphs && actionSaveGlyph==gtk_dialog_run(GTK_DIALOG(dialog)))
-        saveGlyph();
+    {
+      ocrSaveGlyph();
+    }
     if(vobsub)
         delete vobsub;
     vobsub=NULL;
@@ -342,192 +314,22 @@
     return 1;
 
 }
-
-//*****************************************************************************************
-//  Separate the bitmap into glyph and handle each glyph on itw own
-//
-//*****************************************************************************************
-
-ReplyType ocrBitmap(uint8_t *data,uint32_t w,uint32_t h)
-{
-uint8_t found;
-uint32_t colstart=0,colend=0,oldcol;
-uint32_t line=0,nbLine=1;
-uint32_t base=0,bottom,top;    
-ReplyType reply;
-    // Search First non nul colum
-    decodedString[0]=0;
-    // Search how much lines there is in the file
-    //
-    top=bottom=0;
-    while(top<h)
-    {
-        // Search non empty line as top
-        while(top<h && lineEmpty(workArea,w,w,top)) top++;
-        // Nothing found
-        if(top>=h-1) break;
-
-        // 
-       
-
-        bottom=top+1;
-        // Search empty line if any, bottom is the 1st line full of zero
-        while(bottom<h && (!lineEmpty(workArea,w,w,bottom) || bottom-top<7))
-        {
-            bottom++;
-        }
-        if(line) strcat(decodedString,"\n"); 
-        //printf("\n Top:%lu bottom:%lu\n",top,bottom);
-       
-        // Scan a full line
-        colstart=0;
-        oldcol=0;
-       
-        // Split a line into glyphs
-        while(colstart<w)
-        {
-            GTK_PURGE;
-            oldcol=colstart;
-            while( columnEmpty(workArea+colstart+top*w, w, bottom-top) && colstart<w) colstart++;
-            if(colstart>=w) break;
-            // if too far apart, it means probably a blank space
-            if(colstart-oldcol>6)
-            {
-                strcat(decodedString," ");
-            }
-       
-            // We have found a non null column
-            // Seek the end now
-            colend=colstart+1;
-            while( !columnEmpty(workArea+colend+top*w, w, bottom-top) && colend<w) colend++;
-         
-         
-            // printf("Found glyph: %lu %lu\n",colstart,colend);  
-            reply=handleGlyph(colstart,colend,w,bottom,top);
-            switch(reply)
-                {
-                        case ReplySkip:break;
-                        case ReplyOk:break;
-                        case ReplyClose:
-                        case ReplyCalibrate: return reply;break;
-            
-                        case ReplySkipAll: return ReplyOk;break;
-                        default: ADM_assert(0);
-                }
-            
-            
-            colstart=colend;
-      }
-      line++;      
-      top=bottom;
-      
-    }
-   
-    return ReplyOk;
-}
-//*****************************************************************************************
-/*
-    We now have a good candidate for the glyph.
-    We will do the following processing :
-        - Clip the glyph to have it in its bounding box
-        - extract its container. If the container is smaller than the glyph, it means
-                that we have in fact several glyphs that overlaps slightly. In
-                that case we use another method to extract the glyph.
-                We split it using leftturn method and do it again.
+/**
+    \fn ocrSaveGlyph
+    \brief bridge to saveGlyph
 */
-ReplyType handleGlyph(uint32_t start, uint32_t end,uint32_t w,uint32_t h,uint32_t base)
+uint8_t ocrSaveGlyph(void)
 {
-uint8_t found=0;
-static int inc=1;
-ReplyType reply;
-          
-    
-    // Ok now we have the cropped glyp
-    
-    admGlyph *glyph,*cand;
-    uint32_t minx,maxx,miny,maxy;
-    int     *raw=NULL;
-            glyph=new admGlyph(end-start,h-base);
-            glyph->create(workArea+start+base*w,w);
-            glyph=clippedGlyph(glyph);
-            if(!glyph->width) // Empty glyph
-            {
-                delete glyph;
-                return ReplyOk;
-            }
-            // now we have our full glyph, try harder to split it
-_nextglyph:
-            raw=new int[glyph->height];            
-            if(adm_estimate_glyphSize(glyph,&minx, &maxx,&miny,&maxy,raw))
-            {
-            //printf("Glyph width :%lu min:%lu max:%lu estimate width:%lu\n",glyph->width,minx,maxx,maxx-minx+1);
-            if((maxx-minx+2)<glyph->width && (maxx-minx>2) && (maxy-miny>2))
-            {
-                // Suspicously too small
-                // We have to split the glyph
-                // recursively to extract each glyph
-                uint32_t width=maxx-minx+1;
-                uint32_t defStride=width+1;
-                
-                if(defStride>glyph->width) defStride=glyph->width;
-                
-                admGlyph *lefty=new admGlyph(defStride,glyph->height);
-                for(int32_t i=miny;i<=maxy;i++)
-                {
-                    if(raw[i]!=-1) memcpy(&(lefty->data[0+i*defStride]),&(glyph->data[minx+i*glyph->width]),raw[i]+1-minx);
-                    else
-                            memcpy(&(lefty->data[0+i*defStride]),&(glyph->data[minx+i*glyph->width]),defStride);
-                }
-                lefty=clippedGlyph(lefty);
-              
-                {
-                    // Remove that from the original
-                    for(uint32_t i=0;i<glyph->height;i++)
-                    {
-                        //printf("%d:%d(%d)\n",i,raw[i],glyph->width);
-                        if(raw[i]!=-1) memset(&(glyph->data[i*glyph->width]),0,raw[i]+1);
-                        else           memset(&(glyph->data[i*glyph->width]),0,defStride); 
-                    }
-                    // Clip
-                    glyph=clippedGlyph(glyph);
-                
-                    if(lefty->width)
-                    {
-                        reply=glyphToText(lefty);
-                        if(reply!=ReplyOk)
-                        {
-                            printf("Glyph2text failed(1)\n");
-                            return reply;
-                        }
-                    }
-                    else
-                        delete lefty;
-                    if(glyph->width)
-                    {
-                        if(raw) delete [] raw;
-                        goto _nextglyph;                    
-                    } 
-                 }           
-            }
-            }//If
-            if(raw) delete [] raw;
-            if(glyph->width)
-            {
-                reply=glyphToText(glyph);
-                if(reply!=ReplyOk)                 
-                {
-                    printf("Glyph2text failed(2)\n");
-                    return reply;
-                }
-            }
-            else 
-            {
-                delete glyph;
-            }
-            
-    return ReplyOk;
+  char *name=NULL;
+          GUI_FileSelWrite(_("Select Glyphfile to save to"), &name);
+        if(!name)
+            return 0;
+        saveGlyph(name,&head,nbGlyphs);
+        ADM_dealloc(name);
+        return 1;
 
 }
+
 /**
         Search throught the existing glyphs , if not present create it
         and append the text to decodedString
@@ -605,40 +407,8 @@
            return ReplyOk;  
 
 }
-/**************************************************************************************
-    returns 1 if the line is empty
-    0 if not
-*/
 
 //*****************************************************************************************
-uint8_t mergeBitmap(uint8_t *bitin, uint8_t *bitout, uint8_t *maskin,uint32_t w, uint32_t h)
-{
-// Merge with alpha channel
-           uint8_t *in,*mask,*out;
-           uint32_t alp,nw;
-           in=bitin;
-           out=bitout;
-           mask=maskin;
-           for(uint32_t y=0;y<h;y++)
-           {
-            for(uint32_t x=0;x<w;x++)
-            {
-                   
-                    nw=in[x];
-                    alp=mask[x];
-
-                    if(alp>minAlpha&& nw >SUB_THRESH)  nw=0xff;
-                         else       nw=0;
-                        
-                    out[x]=nw;
-            }
-            out+=w;
-            in+=w;
-            mask+=w;
-           }    
-    return 1;
-}
-//*****************************************************************************************
 gboolean gui_draw( void )
 {
 static int lastx=0,lasty=0;
@@ -721,7 +491,7 @@
     //gtk_widget_set_sensitive(WID(buttonAccept),0);
     //gtk_widget_set_sensitive(WID(buttonSkip),0);
     //gtk_widget_set_sensitive(WID(entryEntry),0);
-    GTK_PURGE;   
+    UI_purge();
     // Main loop : Only accept glyph load/save
     // Sub & srt select & start ocr
     gtk_widget_set_sensitive(WID(frameGlyph),1);
@@ -764,7 +534,7 @@
                     GUI_FileSelRead(_("Select Glyoh to save"), &gly);
                     if(gly)
                     {
-                            loadGlyph(gly);
+                            loadGlyph(gly,&head,&nbGlyphs);
                             sprintf(text,"%03d",nbGlyphs);
                             gtk_label_set_text(GTK_LABEL(WID(labelNbGlyphs)),text);
                     }
@@ -778,8 +548,8 @@
                       GUI_Error_HIG(_("No glyphs to save"), NULL);
                         break;
                     }                  
-                    saveGlyph();                                      
-                    break;
+                    ocrSaveGlyph();
+                        break;
         
         case GTK_RESPONSE_CLOSE: 
             printf("Close req\n");
@@ -792,16 +562,14 @@
     }
 }
 /**
+    \fn cb_accept
+    \brief Bridge between dialog/Accept and gtk signals
 */
 int cb_accept(GtkObject * object, gpointer user_data)
 {
         //printf("Hopla\n");
         gtk_signal_emit_by_name(GTK_OBJECT(WID(buttonOk)),"clicked",(gpointer)1);
         return 0;
-
 }
 
-/**
- */
-#include "ADM_ocrLoadSave.h"
 //;



From mean at mail.berlios.de  Sat Jul 14 10:27:39 2007
From: mean at mail.berlios.de (mean at BerliOS)
Date: Sat, 14 Jul 2007 10:27:39 +0200
Subject: [Avidemux-svn-commit] r3362 - in
	branches/avidemux_2.4_branch/avidemux:
	ADM_libraries/ADM_libass ADM_videoFilter
Message-ID: <200707140827.l6E8Rd5H007901@sheep.berlios.de>

Author: mean
Date: 2007-07-14 10:27:37 +0200 (Sat, 14 Jul 2007)
New Revision: 3362

Added:
   branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_libass/ass_font.c
   branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_libass/ass_font.h
   branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_libass/help_mp.h
Modified:
   branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_libass/CMakeLists.txt
   branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_libass/ass.c
   branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_libass/ass.h
   branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_libass/ass_bitmap.c
   branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_libass/ass_bitmap.h
   branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_libass/ass_cache.c
   branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_libass/ass_cache.h
   branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_libass/ass_fontconfig.c
   branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_libass/ass_fontconfig.h
   branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_libass/ass_library.c
   branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_libass/ass_library.h
   branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_libass/ass_render.c
   branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_libass/ass_types.h
   branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_libass/ass_utils.c
   branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_libass/ass_utils.h
   branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_libass/mputils.c
   branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_libass/mputils.h
   branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/ADM_vidASS.cpp
Log:
[libASS] update to 0.9.4

Modified: branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_libass/CMakeLists.txt
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_libass/CMakeLists.txt	2007-07-13 17:01:23 UTC (rev 3361)
+++ branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_libass/CMakeLists.txt	2007-07-14 08:27:37 UTC (rev 3362)
@@ -7,6 +7,7 @@
 if(FT_FOUND)
 SET(${ADM_LIB}_SRCS 
 ass_bitmap.c  ass.c  ass_cache.c  ass_fontconfig.c  ass_library.c  ass_mp.c  ass_render.c  ass_utils.c  mputils.c
+ass_font.c
 )
 ADD_LIBRARY(${ADM_LIB} STATIC ${${ADM_LIB}_SRCS})
 ADD_ADM_LIB(${ADM_LIB} ADM_libraries)

Modified: branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_libass/ass.c
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_libass/ass.c	2007-07-13 17:01:23 UTC (rev 3361)
+++ branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_libass/ass.c	2007-07-14 08:27:37 UTC (rev 3362)
@@ -37,7 +37,6 @@
 #include "ass.h"
 #include "ass_utils.h"
 #include "ass_library.h"
-#include "ass_types.h" /* MEANX */
 #include "mputils.h"
 
 typedef enum {PST_UNKNOWN = 0, PST_INFO, PST_STYLES, PST_EVENTS, PST_FONTS} parser_state_t;
@@ -53,9 +52,6 @@
 #define ASS_STYLES_ALLOC 20
 #define ASS_EVENTS_ALLOC 200
 
-#define ADM_LEGACY_PROGGY
-#include "ADM_assert.h"
-
 void ass_free_track(ass_track_t* track) {
 	int i;
 	
@@ -171,7 +167,7 @@
 			return i;
 	}
 	i = track->default_style;
-	mp_msg(MSGT_ASS, MSGL_WARN, "[%p] Warning: no style named '%s' found, using '%s'\n", track, name, track->styles[i].Name);
+	mp_msg(MSGT_ASS, MSGL_WARN, MSGTR_LIBASS_NoStyleNamedXFoundUsingY, track, name, track->styles[i].Name);
 	return i; // use the first style
 }
 
@@ -186,7 +182,7 @@
 	long long tm;
 	int res = sscanf(p, "%1d:%2d:%2d.%2d", &h, &m, &s, &ms);
 	if (res < 4) {
-		mp_msg(MSGT_ASS, MSGL_WARN, "bad timestamp\n");
+		mp_msg(MSGT_ASS, MSGL_WARN, MSGTR_LIBASS_BadTimestamp);
 		return 0;
 	}
 	tm = ((h * 60 + m) * 60 + s) * 1000 + ms * 10;
@@ -351,12 +347,12 @@
 					COLORVAL(SecondaryColour)
 					COLORVAL(OutlineColour)
 					COLORVAL(BackColour)
-					INTVAL(FontSize)
+					FPVAL(FontSize)
 					INTVAL(Bold)
 					INTVAL(Italic)
 					INTVAL(Underline)
 					INTVAL(StrikeOut)
-					INTVAL(Spacing)
+					FPVAL(Spacing)
 					INTVAL(Angle)
 					INTVAL(BorderStyle)
 					INTVAL(Alignment)
@@ -439,12 +435,12 @@
 				// this will destroy SSA's TertiaryColour, but i'm not going to use it anyway
 				if (track->track_type == TRACK_TYPE_SSA)
 					target->OutlineColour = target->BackColour;
-			INTVAL(FontSize)
+			FPVAL(FontSize)
 			INTVAL(Bold)
 			INTVAL(Italic)
 			INTVAL(Underline)
 			INTVAL(StrikeOut)
-			INTVAL(Spacing)
+			FPVAL(Spacing)
 			INTVAL(Angle)
 			INTVAL(BorderStyle)
 			INTVAL(Alignment)
@@ -462,6 +458,9 @@
 	}
 	style->ScaleX /= 100.;
 	style->ScaleY /= 100.;
+	style->Bold = !!style->Bold;
+	style->Italic = !!style->Italic;
+	style->Underline = !!style->Underline;
 	if (!style->Name)
 		style->Name = strdup("Default");
 	if (!style->FontName)
@@ -557,10 +556,10 @@
 	mp_msg(MSGT_ASS, MSGL_V, "font: %d bytes encoded data \n", track->parser_priv->fontdata_used);
 	size = track->parser_priv->fontdata_used;
 	if (size % 4 == 1) {
-		mp_msg(MSGT_ASS, MSGL_ERR, "bad encoded data size\n");
+		mp_msg(MSGT_ASS, MSGL_ERR, MSGTR_LIBASS_BadEncodedDataSize);
 		goto error_decode_font;
 	}
-	buf = (unsigned char*)malloc(size / 4 * 3 + 2);
+	buf = malloc(size / 4 * 3 + 2);
 	q = buf;
 	for (i = 0, p = (unsigned char*)track->parser_priv->fontdata; i < size / 4; i++, p+=4) {
 		q = decode_chars(p[0], p[1], p[2], p[3], q, 3);
@@ -573,8 +572,10 @@
 	dsize = q - buf;
 	assert(dsize <= size / 4 * 3 + 2);
 	
-	if (track->library->extract_fonts)
-		ass_process_font(track->library, track->parser_priv->fontname, (char*)buf, dsize);
+	if (track->library->extract_fonts) {
+		ass_add_font(track->library, track->parser_priv->fontname, (char*)buf, dsize);
+		buf = 0;
+	}
 
 error_decode_font:
 	if (buf) free(buf);
@@ -587,8 +588,6 @@
 	return 0;
 }
 
-static char* validate_fname(char* name);
-
 static int process_fonts_line(ass_track_t* track, char *str)
 {
 	int len;
@@ -599,7 +598,7 @@
 		if (track->parser_priv->fontname) {
 			decode_font(track);
 		}
-		track->parser_priv->fontname = validate_fname(p);
+		track->parser_priv->fontname = strdup(p);
 		mp_msg(MSGT_ASS, MSGL_V, "fontname: %s\n", track->parser_priv->fontname);
 		return 0;
 	}
@@ -611,12 +610,12 @@
 
 	len = strlen(str);
 	if (len > 80) {
-		mp_msg(MSGT_ASS, MSGL_WARN, "Font line too long: %d, %s\n", len, str);
+		mp_msg(MSGT_ASS, MSGL_WARN, MSGTR_LIBASS_FontLineTooLong, len, str);
 		return 0;
 	}
 	if (track->parser_priv->fontdata_used + len > track->parser_priv->fontdata_size) {
 		track->parser_priv->fontdata_size += 100 * 1024;
-		track->parser_priv->fontdata =(char *) realloc(track->parser_priv->fontdata, track->parser_priv->fontdata_size);
+		track->parser_priv->fontdata = realloc(track->parser_priv->fontdata, track->parser_priv->fontdata_size);
 	}
 	memcpy(track->parser_priv->fontdata + track->parser_priv->fontdata_used, str, len);
 	track->parser_priv->fontdata_used += len;
@@ -697,7 +696,7 @@
 */ 
 void ass_process_codec_private(ass_track_t* track, char *data, int size)
 {
-	char* str = (char *)malloc(size + 1);
+	char* str = malloc(size + 1);
 	int sid;
 
 	memcpy(str, data, size);
@@ -751,14 +750,14 @@
 	ass_event_t* event;
 
 	if (!track->event_format) {
-		mp_msg(MSGT_ASS, MSGL_WARN, "Event format header missing\n");
+		mp_msg(MSGT_ASS, MSGL_WARN, MSGTR_LIBASS_EventFormatHeaderMissing);
 		return;
 	}
 	
-	str = (char *)malloc(size + 1);
+	str = malloc(size + 1);
 	memcpy(str, data, size);
 	str[size] = '\0';
-	//mp_msg(MSGT_ASS, MSGL_V, "event at %" PRId64 ", +%" PRId64 ": %s  \n", (int64_t)timecode, (int64_t)duration, str);
+	mp_msg(MSGT_ASS, MSGL_V, "event at %" PRId64 ", +%" PRId64 ": %s  \n", (int64_t)timecode, (int64_t)duration, str);
 
 	eid = ass_alloc_event(track);
 	event = track->events + eid;
@@ -815,7 +814,7 @@
 		if ((icdsc = iconv_open (tocp, cp_tmp)) != (iconv_t)(-1)){
 			mp_msg(MSGT_ASS,MSGL_V,"LIBSUB: opened iconv descriptor.\n");
 		} else
-			mp_msg(MSGT_ASS,MSGL_ERR,"LIBSUB: error opening iconv descriptor.\n");
+			mp_msg(MSGT_ASS,MSGL_ERR,MSGTR_LIBASS_ErrorOpeningIconvDescriptor);
 #ifdef HAVE_ENCA
 		if (cp_tmp) free(cp_tmp);
 #endif
@@ -829,7 +828,7 @@
 		char* op;
 		size_t rc;
 		
-		outbuf = (char *)malloc(size);
+		outbuf = malloc(size);
 		ip = data;
 		op = outbuf;
 		
@@ -843,7 +842,7 @@
 					osize += size;
 					oleft += size;
 				} else {
-					mp_msg(MSGT_ASS, MSGL_WARN, "LIBSUB: error recoding file.\n");
+					mp_msg(MSGT_ASS, MSGL_WARN, MSGTR_LIBASS_ErrorRecodingFile);
 					return NULL;
 				}
 			}
@@ -876,12 +875,12 @@
 
 	FILE* fp = fopen(fname, "rb");
 	if (!fp) {
-		mp_msg(MSGT_ASS, MSGL_WARN, "ass_read_file(%s): fopen failed\n", fname);
+		mp_msg(MSGT_ASS, MSGL_WARN, MSGTR_LIBASS_FopenFailed, fname);
 		return 0;
 	}
 	res = fseek(fp, 0, SEEK_END);
 	if (res == -1) {
-		mp_msg(MSGT_ASS, MSGL_WARN, "ass_read_file(%s): fseek failed\n", fname);
+		mp_msg(MSGT_ASS, MSGL_WARN, MSGTR_LIBASS_FseekFailed, fname);
 		fclose(fp);
 		return 0;
 	}
@@ -890,20 +889,20 @@
 	rewind(fp);
 
 	if (sz > 10*1024*1024) {
-		mp_msg(MSGT_ASS, MSGL_INFO, "ass_read_file(%s): Refusing to load subtitles larger than 10M\n", fname);
+		mp_msg(MSGT_ASS, MSGL_INFO, MSGTR_LIBASS_RefusingToLoadSubtitlesLargerThan10M, fname);
 		fclose(fp);
 		return 0;
 	}
 	
 	mp_msg(MSGT_ASS, MSGL_V, "file size: %ld\n", sz);
 	
-	buf = (char *)malloc(sz + 1);
+	buf = malloc(sz + 1);
 	assert(buf);
 	bytes_read = 0;
 	do {
 		res = fread(buf + bytes_read, 1, sz - bytes_read, fp);
 		if (res <= 0) {
-			mp_msg(MSGT_ASS, MSGL_INFO, "Read failed, %d: %s\n", errno, strerror(errno));
+			mp_msg(MSGT_ASS, MSGL_INFO, MSGTR_LIBASS_ReadFailed, errno, strerror(errno));
 			fclose(fp);
 			free(buf);
 			return 0;
@@ -979,7 +978,7 @@
 	if (!track)
 		return 0;
 
-	mp_msg(MSGT_ASS, MSGL_INFO, "LIBASS: added subtitle file: <memory> (%d styles, %d events)\n", track->n_styles, track->n_events);
+	mp_msg(MSGT_ASS, MSGL_INFO, MSGTR_LIBASS_AddedSubtitleFileMemory, track->n_styles, track->n_events);
 	return track;
 }
 
@@ -1015,7 +1014,7 @@
 	
 	track->name = strdup(fname);
 
-	mp_msg(MSGT_ASS, MSGL_INFO, "LIBASS: added subtitle file: %s (%d styles, %d events)\n", fname, track->n_styles, track->n_events);
+	mp_msg(MSGT_ASS, MSGL_INFO, MSGTR_LIBASS_AddedSubtitleFileFname, fname, track->n_styles, track->n_events);
 	
 //	dump_events(forced_tid);
 	return track;
@@ -1052,86 +1051,6 @@
 	return 0;
 }
 
-static char* validate_fname(char* name)
-{
-	char* fname;
-	char* p;
-	char* q;
-	unsigned code;
-	int sz = strlen(name);
-
-	q = fname = (char *)malloc(sz + 1);
-	p = name;
-	while (*p) {
-		code = utf8_get_char(&p);
-		if (code == 0)
-			break;
-		if (	(code > 0x7F) ||
-			(code == '\\') ||
-			(code == '/') ||
-			(code == ':') ||
-			(code == '*') ||
-			(code == '?') ||
-			(code == '<') ||
-			(code == '>') ||
-			(code == '|') ||
-			(code == 0))
-		{
-			*q++ = '_';
-		} else {
-			*q++ = code;
-		}
-		if (p - name > sz)
-			break;
-	}
-	*q = 0;
-	return fname;
-}
-
-/**
- * \brief Process embedded matroska font. Saves it to ~/.mplayer/fonts.
- * \param name attachment name
- * \param data binary font data
- * \param data_size data size
-*/ 
-void ass_process_font(ass_library_t* library, const char* name, char* data, int data_size)
-{
-	char buf[1000];
-	FILE* fp = 0;
-	int rc;
-	struct stat st;
-	char* fname;
-	const char* fonts_dir = library->fonts_dir;
-
-	if (!fonts_dir)
-		return;
-	rc = stat(fonts_dir, &st);
-	if (rc) {
-		int res;
-#ifndef __MINGW32__
-		res = mkdir(fonts_dir, 0700);
-#else
-		res = mkdir(fonts_dir);
-#endif
-		if (res) {
-			mp_msg(MSGT_ASS, MSGL_WARN, "Failed to create: %s\n", fonts_dir);
-		}
-	} else if (!S_ISDIR(st.st_mode)) {
-		mp_msg(MSGT_ASS, MSGL_WARN, "Not a directory: %s\n", fonts_dir);
-	}
-	
-	fname = validate_fname((char*)name);
-
-	snprintf(buf, 1000, "%s/%s", fonts_dir, fname);
-	free(fname);
-
-	fp = fopen(buf, "wb");
-	if (!fp) return;
-
-	fwrite(data, data_size, 1, fp);
-	fclose(fp);
-}
-
 long long ass_step_sub(ass_track_t* track, long long now, int movement) {
 	int i;
 
@@ -1152,9 +1071,9 @@
 }
 
 ass_track_t* ass_new_track(ass_library_t* library) {
-	ass_track_t* track = (ass_track_t *)calloc(1, sizeof(ass_track_t));
+	ass_track_t* track = calloc(1, sizeof(ass_track_t));
 	track->library = library;
-	track->parser_priv = (parser_priv_t *)calloc(1, sizeof(parser_priv_t));
+	track->parser_priv = calloc(1, sizeof(parser_priv_t));
 	return track;
 }
 

Modified: branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_libass/ass.h
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_libass/ass.h	2007-07-13 17:01:23 UTC (rev 3361)
+++ branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_libass/ass.h	2007-07-14 08:27:37 UTC (rev 3362)
@@ -37,6 +37,13 @@
 	struct ass_image_s* next; // linked list
 } ass_image_t;
 
+/// Hinting type
+typedef enum {ASS_HINTING_NONE = 0,
+	      ASS_HINTING_LIGHT,
+	      ASS_HINTING_NORMAL,
+	      ASS_HINTING_NATIVE
+} ass_hinting_t;
+
 /**
  * \brief initialize the library
  * \return library handle or NULL if failed
@@ -77,6 +84,7 @@
 void ass_set_use_margins(ass_renderer_t* priv, int use);
 void ass_set_aspect_ratio(ass_renderer_t* priv, double ar);
 void ass_set_font_scale(ass_renderer_t* priv, double font_scale);
+void ass_set_hinting(ass_renderer_t* priv, ass_hinting_t ht);
 
 /**
  * \brief set font lookup defaults
@@ -89,7 +97,7 @@
  * \param track subtitle track
  * \param now video timestamp in milliseconds
  */
-ass_image_t* ass_render_frame(ass_renderer_t *priv, ass_track_t* track, long long now);
+ass_image_t* ass_render_frame(ass_renderer_t *priv, ass_track_t* track, long long now, int* detect_change);
 
 
 // The following functions operate on track objects and do not need an ass_renderer //
@@ -177,12 +185,12 @@
 int ass_read_styles(ass_track_t* track, char* fname, char* codepage);
 
 /**
- * \brief Process embedded matroska font. Saves it to ~/.mplayer/fonts.
+ * \brief Add a memory font.
  * \param name attachment name
  * \param data binary font data
  * \param data_size data size
 */
-void ass_process_font(ass_library_t* library, const char* name, char* data, int data_size);
+void ass_add_font(ass_library_t* library, char* name, char* data, int data_size);
 
 /**
  * \brief Calculates timeshift from now to the start of some other subtitle event, depending on movement parameter

Modified: branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_libass/ass_bitmap.c
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_libass/ass_bitmap.c	2007-07-13 17:01:23 UTC (rev 3361)
+++ branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_libass/ass_bitmap.c	2007-07-14 08:27:37 UTC (rev 3362)
@@ -28,10 +28,6 @@
 #include "mputils.h"
 #include "ass_bitmap.h"
 
-#define ADM_LEGACY_PROGGY
-#include "ADM_assert.h"
-
-
 struct ass_synth_priv_s {
 	int tmp_w, tmp_h;
 	unsigned short* tmp;
@@ -58,8 +54,8 @@
 	priv->g_w = 2*priv->g_r+1;
 
 	if (priv->g_r) {
-		priv->g = (unsigned*)malloc(priv->g_w * sizeof(unsigned));
-		priv->gt2 = (unsigned*)malloc(256 * priv->g_w * sizeof(unsigned));
+		priv->g = malloc(priv->g_w * sizeof(unsigned));
+		priv->gt2 = malloc(256 * priv->g_w * sizeof(unsigned));
 		if (priv->g==NULL || priv->gt2==NULL) {
 			return -1;
 		}
@@ -105,12 +101,12 @@
 	while (priv->tmp_h < h) priv->tmp_h *= 2;
 	if (priv->tmp)
 		free(priv->tmp);
-	priv->tmp = (short unsigned int*)malloc((priv->tmp_w + 1) * priv->tmp_h * sizeof(short));
+	priv->tmp = malloc((priv->tmp_w + 1) * priv->tmp_h * sizeof(short));
 }
 
-ass_synth_priv_t* ass_synth_init()
+ass_synth_priv_t* ass_synth_init(void)
 {
-	ass_synth_priv_t* priv = (ass_synth_priv_t *)calloc(1, sizeof(ass_synth_priv_t));
+	ass_synth_priv_t* priv = calloc(1, sizeof(ass_synth_priv_t));
 	generate_tables(priv, blur_radius);
 	return priv;
 }
@@ -129,8 +125,8 @@
 static bitmap_t* alloc_bitmap(int w, int h)
 {
 	bitmap_t* bm;
-	bm = (bitmap_t *)calloc(1, sizeof(bitmap_t));
-	bm->buffer = (unsigned char *)malloc(w*h);
+	bm = calloc(1, sizeof(bitmap_t));
+	bm->buffer = malloc(w*h);
 	bm->w = w;
 	bm->h = h;
 	bm->left = bm->top = 0;
@@ -167,14 +163,14 @@
 
 	error = FT_Glyph_To_Bitmap(&glyph, FT_RENDER_MODE_NORMAL, 0, 0);
 	if (error) {
-		mp_msg(MSGT_ASS, MSGL_WARN, "FT_Glyph_To_Bitmap error %d \n", error);
+		mp_msg(MSGT_ASS, MSGL_WARN, MSGTR_LIBASS_FT_Glyph_To_BitmapError, error);
 		return 0;
 	}
 
 	bg = (FT_BitmapGlyph)glyph;
 	bit = &(bg->bitmap);
 	if (bit->pixel_mode != FT_PIXEL_MODE_GRAY) {
-		mp_msg(MSGT_ASS, MSGL_WARN, "Unsupported pixel mode: %d\n", (int)(bit->pixel_mode));
+		mp_msg(MSGT_ASS, MSGL_WARN, MSGTR_LIBASS_UnsupportedPixelMode, (int)(bit->pixel_mode));
 		FT_Done_Glyph(glyph);
 		return 0;
 	}

Modified: branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_libass/ass_bitmap.h
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_libass/ass_bitmap.h	2007-07-13 17:01:23 UTC (rev 3361)
+++ branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_libass/ass_bitmap.h	2007-07-14 08:27:37 UTC (rev 3362)
@@ -23,7 +23,7 @@
 
 typedef struct ass_synth_priv_s ass_synth_priv_t;
 
-ass_synth_priv_t* ass_synth_init();
+ass_synth_priv_t* ass_synth_init(void);
 void ass_synth_done(ass_synth_priv_t* priv);
 
 typedef struct bitmap_s {

Modified: branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_libass/ass_cache.c
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_libass/ass_cache.c	2007-07-13 17:01:23 UTC (rev 3361)
+++ branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_libass/ass_cache.c	2007-07-14 08:27:37 UTC (rev 3362)
@@ -20,6 +20,7 @@
 
 #include "config.h"
 
+#include <inttypes.h>
 #include <ft2build.h>
 #include FT_FREETYPE_H
 #include FT_GLYPH_H
@@ -27,197 +28,272 @@
 #include <assert.h>
 
 #include "mputils.h"
+#include "ass.h"
 #include "ass_fontconfig.h"
+#include "ass_font.h"
 #include "ass_bitmap.h"
 #include "ass_cache.h"
 
-#define ADM_LEGACY_PROGGY
-#include "ADM_assert.h"
 
+typedef struct hashmap_item_s {
+	void* key;
+	void* value;
+	struct hashmap_item_s* next;
+} hashmap_item_t;
+typedef hashmap_item_t* hashmap_item_p;
 
-typedef struct face_cache_item_s {
-	face_desc_t desc;
-	char* path;
-	int index;
-	FT_Face face;
-} face_cache_item_t;
+struct hashmap_s {
+	int nbuckets;
+	size_t key_size, value_size;
+	hashmap_item_p* root;
+	hashmap_item_dtor_t item_dtor; // a destructor for hashmap key/value pairs
+	hashmap_key_compare_t key_compare;
+	hashmap_hash_t hash;
+	// stats
+	int hit_count;
+	int miss_count;
+	int count;
+};
 
-#define MAX_FACE_CACHE_SIZE 100
+#define FNV1_32A_INIT (unsigned)0x811c9dc5
 
-static face_cache_item_t* face_cache;
-static int face_cache_size;
+static inline unsigned fnv_32a_buf(void* buf, size_t len, unsigned hval)
+{
+	unsigned char *bp = buf;
+	unsigned char *be = bp + len;
+	while (bp < be) {
+		hval ^= (unsigned)*bp++;
+		hval += (hval<<1) + (hval<<4) + (hval<<7) + (hval<<8) + (hval<<24);
+	}
+	return hval;
+}
+static inline unsigned fnv_32a_str(char* str, unsigned hval)
+{
+	unsigned char* s = (unsigned char*)str;
+	while (*s) {
+		hval ^= (unsigned)*s++;
+		hval += (hval<<1) + (hval<<4) + (hval<<7) + (hval<<8) + (hval<<24);
+	}
+	return hval;
+}
 
-extern int no_more_font_messages;
+static unsigned hashmap_hash(void* buf, size_t len)
+{
+	return fnv_32a_buf(buf, len, FNV1_32A_INIT);
+}
 
-static int font_compare(face_desc_t* a, face_desc_t* b) {
-	if (strcmp(a->family, b->family) != 0)
-		return 0;
-	if (a->bold != b->bold)
-		return 0;
-	if (a->italic != b->italic)
-		return 0;
-	return 1;
+static int hashmap_key_compare(void* a, void* b, size_t size)
+{
+	return (memcmp(a, b, size) == 0);
 }
 
-/**
- * Select Microfost Unicode CharMap, if the font has one.
- * Otherwise, let FreeType decide.
- */
-static void charmap_magic(FT_Face face)
+static void hashmap_item_dtor(void* key, size_t key_size, void* value, size_t value_size)
 {
-	int i;
-	for (i = 0; i < face->num_charmaps; ++i) {
-		FT_CharMap cmap = face->charmaps[i];
-		unsigned pid = cmap->platform_id;
-		unsigned eid = cmap->encoding_id;
-		if (pid == 3 /*microsoft*/ && (eid == 1 /*unicode bmp*/ || eid == 10 /*full unicode*/)) {
-			FT_Set_Charmap(face, cmap);
-			break;
-		}
-	}
+	free(key);
+	free(value);
 }
 
-/**
- * \brief Get a face object, either from cache or created through FreeType+FontConfig.
- * \param library FreeType library object
- * \param fontconfig_priv fontconfig private data
- * \param desc required face description
- * \param face out: the face object
-*/ 
-int ass_new_face(FT_Library library, void* fontconfig_priv, face_desc_t* desc, /*out*/ FT_Face* face)
+hashmap_t* hashmap_init(size_t key_size, size_t value_size, int nbuckets,
+			hashmap_item_dtor_t item_dtor, hashmap_key_compare_t key_compare,
+			hashmap_hash_t hash)
 {
-	FT_Error error;
+	hashmap_t* map = calloc(1, sizeof(hashmap_t));
+	map->nbuckets = nbuckets;
+	map->key_size = key_size;
+	map->value_size = value_size;
+	map->root = calloc(nbuckets, sizeof(hashmap_item_p));
+	map->item_dtor = item_dtor ? item_dtor : hashmap_item_dtor;
+	map->key_compare = key_compare ? key_compare : hashmap_key_compare;
+	map->hash = hash ? hash : hashmap_hash;
+	return map;
+}
+
+void hashmap_done(hashmap_t* map)
+{
 	int i;
-	char* path;
-	int index;
-	face_cache_item_t* item;
+	// print stats
+	if (map->count > 0 || map->hit_count + map->miss_count > 0)
+		mp_msg(MSGT_ASS, MSGL_V, "cache statistics: \n  total accesses: %d\n  hits: %d\n  misses: %d\n  object count: %d\n",
+		       map->hit_count + map->miss_count, map->hit_count, map->miss_count, map->count);
 	
-	for (i=0; i<face_cache_size; ++i)
-		if (font_compare(desc, &(face_cache[i].desc))) {
-			*face = face_cache[i].face;
-			return 0;
+	for (i = 0; i < map->nbuckets; ++i) {
+		hashmap_item_t* item = map->root[i];
+		while (item) {
+			hashmap_item_t* next = item->next;
+			map->item_dtor(item->key, map->key_size, item->value, map->value_size);
+			free(item);
+			item = next;
 		}
+	}
+	free(map->root);
+	free(map);
+}
 
-	if (face_cache_size == MAX_FACE_CACHE_SIZE) {
-		mp_msg(MSGT_ASS, MSGL_FATAL, "Too many fonts\n");
-		return 1;
+// does nothing if key already exists
+void* hashmap_insert(hashmap_t* map, void* key, void* value)
+{
+	unsigned hash = map->hash(key, map->key_size);
+	hashmap_item_t** next = map->root + (hash % map->nbuckets);
+	while (*next) {
+		if (map->key_compare(key, (*next)->key, map->key_size))
+			return (*next)->value;
+		next = &((*next)->next);
+		assert(next);
 	}
+	(*next) = malloc(sizeof(hashmap_item_t));
+	(*next)->key = malloc(map->key_size);
+	(*next)->value = malloc(map->value_size);
+	memcpy((*next)->key, key, map->key_size);
+	memcpy((*next)->value, value, map->value_size);
+	(*next)->next = 0;
 
-	path = fontconfig_select((fc_instance_t *)fontconfig_priv, desc->family, desc->bold, desc->italic, &index);
-	
-	error = FT_New_Face(library, path, index, face);
-	if (error) {
-		if (!no_more_font_messages)
-			mp_msg(MSGT_ASS, MSGL_WARN, "Error opening font: %s, %d\n", path, index);
-		no_more_font_messages = 1;
-		return 1;
+	map->count ++;
+	return (*next)->value;
+}
+
+void* hashmap_find(hashmap_t* map, void* key)
+{
+	unsigned hash = map->hash(key, map->key_size);
+	hashmap_item_t* item = map->root[hash % map->nbuckets];
+	while (item) {
+		if (map->key_compare(key, item->key, map->key_size)) {
+			map->hit_count++;
+			return item->value;
+		}
+		item = item->next;
 	}
-
-	charmap_magic(*face);
-	
-	item = face_cache + face_cache_size;
-	item->path = strdup(path);
-	item->index = index;
-	item->face = *face;
-	memcpy(&(item->desc), desc, sizeof(face_desc_t));
-	face_cache_size++;
+	map->miss_count++;
 	return 0;
 }
 
-void ass_face_cache_init(void)
+//---------------------------------
+// font cache
+
+hashmap_t* font_cache;
+
+static unsigned font_desc_hash(void* buf, size_t len)
 {
-        
-        
-        face_cache = (face_cache_item_t *)calloc(MAX_FACE_CACHE_SIZE, sizeof(face_cache_item_t));
-	face_cache_size = 0;
-        
+	ass_font_desc_t* desc = buf;
+	unsigned hval;
+	hval = fnv_32a_str(desc->family, FNV1_32A_INIT);
+	hval = fnv_32a_buf(&desc->bold, sizeof(desc->bold), hval);
+	hval = fnv_32a_buf(&desc->italic, sizeof(desc->italic), hval);
+	return hval;
 }
 
-void ass_face_cache_done(void)
+static int font_compare(void* key1, void* key2, size_t key_size) {
+	ass_font_desc_t* a = key1;
+	ass_font_desc_t* b = key2;
+	if (strcmp(a->family, b->family) != 0)
+		return 0;
+	if (a->bold != b->bold)
+		return 0;
+	if (a->italic != b->italic)
+		return 0;
+	return 1;
+}
+
+static void font_hash_dtor(void* key, size_t key_size, void* value, size_t value_size)
 {
-	
-        int i;
-	for (i = 0; i < face_cache_size; ++i) {
-		face_cache_item_t* item = face_cache + i;
-		if (item->face) FT_Done_Face(item->face);
-		if (item->path) free(item->path);
-		// FIXME: free desc ?
-	}
-	free(face_cache);
-	face_cache_size = 0;
-        face_cache=NULL; // MEANX
+	ass_font_free(value);
+	free(key);
+}
 
+ass_font_t* ass_font_cache_find(ass_font_desc_t* desc)
+{
+	return hashmap_find(font_cache, desc);
 }
 
-//---------------------------------
-// glyph cache
+/**
+ * \brief Add a face struct to cache.
+ * \param font font struct
+*/
+void* ass_font_cache_add(ass_font_t* font)
+{
+	return hashmap_insert(font_cache, &(font->desc), font);
+}
 
-#define GLYPH_HASH_SIZE (0xFFFF + 13)
+void ass_font_cache_init(void)
+{
+	font_cache = hashmap_init(sizeof(ass_font_desc_t),
+				  sizeof(ass_font_t),
+				  1000,
+				  font_hash_dtor, font_compare, font_desc_hash);
+}
 
-typedef struct glyph_hash_item_s {
-	glyph_hash_key_t key;
-	glyph_hash_val_t val;
-	struct glyph_hash_item_s* next;
-} glyph_hash_item_t;
+void ass_font_cache_done(void)
+{
+	hashmap_done(font_cache);
+}
 
-typedef glyph_hash_item_t* glyph_hash_item_p;
+//---------------------------------
+// bitmap cache
 
-static glyph_hash_item_p* glyph_hash_root;
-static int glyph_hash_size;
+hashmap_t* bitmap_cache;
 
-static int glyph_compare(glyph_hash_key_t* a, glyph_hash_key_t* b) {
-	if (memcmp(a, b, sizeof(glyph_hash_key_t)) == 0)
-		return 1;
-	else
-		return 0;
+static void bitmap_hash_dtor(void* key, size_t key_size, void* value, size_t value_size)
+{
+	bitmap_hash_val_t* v = value;
+	if (v->bm) ass_free_bitmap(v->bm);
+	if (v->bm_o) ass_free_bitmap(v->bm_o);
+	if (v->bm_s) ass_free_bitmap(v->bm_s);
+	free(key);
+	free(value);
 }
 
-static unsigned glyph_hash(glyph_hash_key_t* key) {
-	unsigned val = 0;
-	unsigned i;
-	for (i = 0; i < sizeof(key->face); ++i)
-		val += *(unsigned char *)(&(key->face) + i);
-	val <<= 21;
-	
-	if (key->bitmap)   val &= 0x80000000;
-	if (key->be) val &= 0x40000000;
-	val += key->index;
-	val += key->size << 8;
-	val += key->outline << 3;
-	val += key->advance.x << 10;
-	val += key->advance.y << 16;
-	val += key->bold << 1;
-	val += key->italic << 20;
-	return val;
+void* cache_add_bitmap(bitmap_hash_key_t* key, bitmap_hash_val_t* val)
+{
+	return hashmap_insert(bitmap_cache, key, val);
 }
 
 /**
- * \brief Add a glyph to glyph cache.
+ * \brief Get a bitmap from bitmap cache.
  * \param key hash key
- * \param val hash val: 2 bitmap glyphs + some additional info
+ * \return requested hash val or 0 if not found
 */ 
-void cache_add_glyph(glyph_hash_key_t* key, glyph_hash_val_t* val)
+bitmap_hash_val_t* cache_find_bitmap(bitmap_hash_key_t* key)
 {
-	unsigned hash = glyph_hash(key);
-	glyph_hash_item_t** next = glyph_hash_root + (hash % GLYPH_HASH_SIZE);
-	while (*next) {
-		if (glyph_compare(key, &((*next)->key)))
-			return;
-		next = &((*next)->next);
-		assert(next);
-	}
-	(*next) = (glyph_hash_item_t *)malloc(sizeof(glyph_hash_item_t));
-//	(*next)->desc = glyph_key_copy(key, &((*next)->key));
-	memcpy(&((*next)->key), key, sizeof(glyph_hash_key_t));
-	memcpy(&((*next)->val), val, sizeof(glyph_hash_val_t));
-	(*next)->next = 0;
+	return hashmap_find(bitmap_cache, key);
+}
 
-	glyph_hash_size ++;
-/*	if (glyph_hash_size  && (glyph_hash_size % 25 == 0)) {
-		printf("\nGlyph cache: %d entries, %d bytes\n", glyph_hash_size, glyph_hash_size * sizeof(glyph_hash_item_t));
-	} */
+void ass_bitmap_cache_init(void)
+{
+	bitmap_cache = hashmap_init(sizeof(bitmap_hash_key_t),
+				   sizeof(bitmap_hash_val_t),
+				   0xFFFF + 13,
+				   bitmap_hash_dtor, NULL, NULL);
 }
 
+void ass_bitmap_cache_done(void)
+{
+	hashmap_done(bitmap_cache);
+}
+
+void ass_bitmap_cache_reset(void)
+{
+	ass_bitmap_cache_done();
+	ass_bitmap_cache_init();
+}
+
+//---------------------------------
+// glyph cache
+
+hashmap_t* glyph_cache;
+
+static void glyph_hash_dtor(void* key, size_t key_size, void* value, size_t value_size)
+{
+	glyph_hash_val_t* v = value;
+	if (v->glyph) FT_Done_Glyph(v->glyph);
+	if (v->outline_glyph) FT_Done_Glyph(v->outline_glyph);
+	free(key);
+	free(value);
+}
+
+void* cache_add_glyph(glyph_hash_key_t* key, glyph_hash_val_t* val)
+{
+	return hashmap_insert(glyph_cache, key, val);
+}
+
 /**
  * \brief Get a glyph from glyph cache.
  * \param key hash key
@@ -225,42 +301,20 @@
 */ 
 glyph_hash_val_t* cache_find_glyph(glyph_hash_key_t* key)
 {
-	unsigned hash = glyph_hash(key);
-	glyph_hash_item_t* item = glyph_hash_root[hash % GLYPH_HASH_SIZE];
-	while (item) {
-		if (glyph_compare(key, &(item->key))) {
-			return &(item->val);
-		}
-		item = item->next;
-	}
-	return 0;
+	return hashmap_find(glyph_cache, key);
 }
 
 void ass_glyph_cache_init(void)
 {
-	glyph_hash_root = (glyph_hash_item_p *)calloc(GLYPH_HASH_SIZE, sizeof(glyph_hash_item_p));
-	glyph_hash_size = 0;
-
+	glyph_cache = hashmap_init(sizeof(glyph_hash_key_t),
+				   sizeof(glyph_hash_val_t),
+				   0xFFFF + 13,
+				   glyph_hash_dtor, NULL, NULL);
 }
 
 void ass_glyph_cache_done(void)
 {
-	int i;
-	for (i = 0; i < GLYPH_HASH_SIZE; ++i) {
-		glyph_hash_item_t* item = glyph_hash_root[i];
-		while (item) {
-			glyph_hash_item_t* next = item->next;
-			if (item->val.bm) ass_free_bitmap(item->val.bm);
-			if (item->val.bm_o) ass_free_bitmap(item->val.bm_o);
-			if (item->val.bm_s) ass_free_bitmap(item->val.bm_s);
-			free(item);
-			item = next;
-		}
-	}
-	free(glyph_hash_root);
-        glyph_hash_root=NULL;
-	glyph_hash_size = 0;
-
+	hashmap_done(glyph_cache);
 }
 
 void ass_glyph_cache_reset(void)
@@ -268,4 +322,3 @@
 	ass_glyph_cache_done();
 	ass_glyph_cache_init();
 }
-

Modified: branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_libass/ass_cache.h
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_libass/ass_cache.h	2007-07-13 17:01:23 UTC (rev 3361)
+++ branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_libass/ass_cache.h	2007-07-14 08:27:37 UTC (rev 3362)
@@ -21,53 +21,78 @@
 #ifndef __ASS_CACHE_H__
 #define __ASS_CACHE_H__
 
-#include <ft2build.h>
-#include FT_FREETYPE_H
-#include FT_STROKER_H
-#include FT_GLYPH_H
+void ass_font_cache_init(void);
+ass_font_t* ass_font_cache_find(ass_font_desc_t* desc);
+void* ass_font_cache_add(ass_font_t* font);
+void ass_font_cache_done(void);
 
-// font cache
-typedef struct face_desc_s {
-	char* family;
-	unsigned bold;
-	unsigned italic;
-} face_desc_t;
 
-void ass_face_cache_init(void);
-int ass_new_face(FT_Library library, void* fontconfig_priv, face_desc_t* desc, /*out*/ FT_Face* face);
-void ass_face_cache_done(void);
-
-
-// describes a glyph; glyphs with equivalents structs are considered identical
-typedef struct glyph_hash_key_s {
+// describes a bitmap; bitmaps with equivalents structs are considered identical
+typedef struct bitmap_hash_key_s {
 	char bitmap; // bool : true = bitmap, false = outline
-	FT_Face face;
-	int size; // font size
-	int index; // glyph index in the face
+	ass_font_t* font;
+	double size; // font size
+	uint32_t ch; // character code
 	unsigned outline; // border width, 16.16 fixed point value
 	int bold, italic;
 	char be; // blur edges
 
-	// the following affects bitmap glyphs only
 	unsigned scale_x, scale_y; // 16.16
-	int angle; // signed 16.16
+	int frx, fry, frz; // signed 16.16
+	int shift_x, shift_y; // shift vector that was added to glyph before applying rotation
+	                      // = 0, if frx = fry = frx = 0
+	                      // = (glyph base point) - (rotation origin), otherwise
 	
 	FT_Vector advance; // subpixel shift vector
+} bitmap_hash_key_t;
+
+typedef struct bitmap_hash_val_s {
+	bitmap_t* bm; // the actual bitmaps
+	bitmap_t* bm_o;
+	bitmap_t* bm_s;
+} bitmap_hash_val_t;
+
+void ass_bitmap_cache_init(void);
+void* cache_add_bitmap(bitmap_hash_key_t* key, bitmap_hash_val_t* val);
+bitmap_hash_val_t* cache_find_bitmap(bitmap_hash_key_t* key);
+void ass_bitmap_cache_reset(void);
+void ass_bitmap_cache_done(void);
+
+// describes an outline glyph
+typedef struct glyph_hash_key_s {
+	ass_font_t* font;
+	double size; // font size
+	uint32_t ch; // character code
+	int bold, italic;
+	unsigned scale_x, scale_y; // 16.16
+	FT_Vector advance; // subpixel shift vector
+	unsigned outline; // border width, 16.16
 } glyph_hash_key_t;
 
 typedef struct glyph_hash_val_s {
-	bitmap_t* bm; // the actual glyph bitmaps
-	bitmap_t* bm_o;
-	bitmap_t* bm_s;
+	FT_Glyph glyph;
+	FT_Glyph outline_glyph;
 	FT_BBox bbox_scaled; // bbox after scaling, but before rotation
-	FT_Vector advance; // 26.6, advance distance to the next glyph in line
+	FT_Vector advance; // 26.6, advance distance to the next bitmap in line
 } glyph_hash_val_t;
 
 void ass_glyph_cache_init(void);
-void cache_add_glyph(glyph_hash_key_t* key, glyph_hash_val_t* val);
+void* cache_add_glyph(glyph_hash_key_t* key, glyph_hash_val_t* val);
 glyph_hash_val_t* cache_find_glyph(glyph_hash_key_t* key);
 void ass_glyph_cache_reset(void);
 void ass_glyph_cache_done(void);
 
+typedef struct hashmap_s hashmap_t; 
+typedef void (*hashmap_item_dtor_t)(void* key, size_t key_size, void* value, size_t value_size);
+typedef int (*hashmap_key_compare_t)(void* key1, void* key2, size_t key_size);
+typedef unsigned (*hashmap_hash_t)(void* key, size_t key_size);
+
+hashmap_t* hashmap_init(size_t key_size, size_t value_size, int nbuckets,
+			hashmap_item_dtor_t item_dtor, hashmap_key_compare_t key_compare,
+			hashmap_hash_t hash);
+void hashmap_done(hashmap_t* map);
+void* hashmap_insert(hashmap_t* map, void* key, void* value);
+void* hashmap_find(hashmap_t* map, void* key);
+
 #endif
 

Added: branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_libass/ass_font.c
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_libass/ass_font.c	2007-07-13 17:01:23 UTC (rev 3361)
+++ branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_libass/ass_font.c	2007-07-14 08:27:37 UTC (rev 3362)
@@ -0,0 +1,366 @@
+// -*- c-basic-offset: 8; indent-tabs-mode: t -*-
+// vim:ts=8:sw=8:noet:ai:
+/*
+  Copyright (C) 2006 Evgeniy Stepanov <eugeni.stepanov at gmail.com>
+
+  This program is free software; you can redistribute it and/or modify
+  it under the terms of the GNU General Public License as published by
+  the Free Software Foundation; either version 2 of the License, or
+  (at your option) any later version.
+
+  This program is distributed in the hope that it will be useful,
+  but WITHOUT ANY WARRANTY; without even the implied warranty of
+  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+  GNU General Public License for more details.
+
+  You should have received a copy of the GNU General Public License
+  along with this program; if not, write to the Free Software
+  Foundation, Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA
+*/
+
+#include "config.h"
+
+#include <inttypes.h>
+#include <ft2build.h>
+#include FT_FREETYPE_H
+#include FT_SYNTHESIS_H
+#include FT_GLYPH_H
+#include FT_TRUETYPE_TABLES_H
+
+#include "ass.h"
+#include "ass_library.h"
+#include "ass_font.h"
+#include "ass_bitmap.h"
+#include "ass_cache.h"
+#include "ass_fontconfig.h"
+#include "ass_utils.h"
+#include "mputils.h"
+
+/**
+ * Select Microfost Unicode CharMap, if the font has one.
+ * Otherwise, let FreeType decide.
+ */
+static void charmap_magic(FT_Face face)
+{
+	int i;
+	for (i = 0; i < face->num_charmaps; ++i) {
+		FT_CharMap cmap = face->charmaps[i];
+		unsigned pid = cmap->platform_id;
+		unsigned eid = cmap->encoding_id;
+		if (pid == 3 /*microsoft*/ && (eid == 1 /*unicode bmp*/ || eid == 10 /*full unicode*/)) {
+			FT_Set_Charmap(face, cmap);
+			return;
+		}
+	}
+
+	if (!face->charmap) {
+		if (face->num_charmaps == 0) {
+			mp_msg(MSGT_ASS, MSGL_WARN, MSGTR_LIBASS_NoCharmaps);
+			return;
+		}
+		mp_msg(MSGT_ASS, MSGL_WARN, MSGTR_LIBASS_NoCharmapAutodetected);
+		FT_Set_Charmap(face, face->charmaps[0]);
+		return;
+	}
+}
+
+static void update_transform(ass_font_t* font)
+{
+	int i;
+	FT_Matrix m;
+	m.xx = double_to_d16(font->scale_x);
+	m.yy = double_to_d16(font->scale_y);
+	m.xy = m.yx = 0;
+	for (i = 0; i < font->n_faces; ++i)
+		FT_Set_Transform(font->faces[i], &m, &font->v);
+}
+
+/**
+ * \brief find a memory font by name
+ */
+static int find_font(ass_library_t* library, char* name)
+{
+	int i;
+	for (i = 0; i < library->num_fontdata; ++i)
+		if (strcasecmp(name, library->fontdata[i].name) == 0)
+			return i;
+	return -1;
+}
+
+/**
+ * \brief Create a new ass_font_t according to "desc" argument
+ */
+ass_font_t* ass_font_new(ass_library_t* library, FT_Library ftlibrary, void* fc_priv, ass_font_desc_t* desc)
+{
+	char* path;
+	int index;
+	FT_Face face;
+	int error;
+	ass_font_t* fontp;
+	ass_font_t font;
+	int mem_idx;
+
+	fontp = ass_font_cache_find(desc);
+	if (fontp)
+		return fontp;
+	
+	path = fontconfig_select(fc_priv, desc->family, desc->bold, desc->italic, &index);
+	
+	mem_idx = find_font(library, path);
+	if (mem_idx >= 0) {
+		error = FT_New_Memory_Face(ftlibrary, (unsigned char*)library->fontdata[mem_idx].data,
+					   library->fontdata[mem_idx].size, 0, &face);
+		if (error) {
+			mp_msg(MSGT_ASS, MSGL_WARN, MSGTR_LIBASS_ErrorOpeningMemoryFont, path);
+			return 0;
+		}
+	} else {
+		error = FT_New_Face(ftlibrary, path, index, &face);
+		if (error) {
+			mp_msg(MSGT_ASS, MSGL_WARN, MSGTR_LIBASS_ErrorOpeningFont, path, index);
+			return 0;
+		}
+	}
+
+	charmap_magic(face);
+	
+	font.ftlibrary = ftlibrary;
+	font.faces[0] = face;
+	font.n_faces = 1;
+	font.desc.family = strdup(desc->family);
+	font.desc.bold = desc->bold;
+	font.desc.italic = desc->italic;
+
+	font.scale_x = font.scale_y = 1.;
+	font.v.x = font.v.y = 0;
+	font.size = 0.;
+
+#ifdef HAVE_FONTCONFIG
+	font.charset = FcCharSetCreate();
+#endif
+
+	return ass_font_cache_add(&font);
+}
+
+/**
+ * \brief Set font transformation matrix and shift vector
+ **/
+void ass_font_set_transform(ass_font_t* font, double scale_x, double scale_y, FT_Vector* v)
+{
+	font->scale_x = scale_x;
+	font->scale_y = scale_y;
+	font->v.x = v->x;
+	font->v.y = v->y;
+	update_transform(font);
+}
+
+static void face_set_size(FT_Face face, double size)
+{
+#if (FREETYPE_MAJOR > 2) || ((FREETYPE_MAJOR == 2) && (FREETYPE_MINOR > 1))
+	TT_HoriHeader *hori = FT_Get_Sfnt_Table(face, ft_sfnt_hhea);
+	TT_OS2 *os2 = FT_Get_Sfnt_Table(face, ft_sfnt_os2);
+	double mscale = 1.;
+	FT_Size_RequestRec rq;
+	FT_Size_Metrics *m = &face->size->metrics;
+	// VSFilter uses metrics from TrueType OS/2 table
+	// The idea was borrowed from asa (http://asa.diac24.net)
+	if (hori && os2)
+		mscale = ((double)(hori->Ascender - hori->Descender)) / (os2->usWinAscent + os2->usWinDescent);
+	memset(&rq, 0, sizeof(rq));
+	rq.type = FT_SIZE_REQUEST_TYPE_REAL_DIM;
+	rq.width = 0;
+	rq.height = double_to_d6(size * mscale);
+	rq.horiResolution = rq.vertResolution = 0;
+	FT_Request_Size(face, &rq);
+	m->ascender /= mscale;
+	m->descender /= mscale;
+	m->height /= mscale;
+#else
+	FT_Set_Char_Size(face, 0, double_to_d6(size), 0, 0);
+#endif
+}
+
+/**
+ * \brief Set font size
+ **/
+void ass_font_set_size(ass_font_t* font, double size)
+{
+	int i;
+	if (font->size != size) {
+		font->size = size;
+		for (i = 0; i < font->n_faces; ++i)
+			face_set_size(font->faces[i], size);
+	}
+}
+
+#ifdef HAVE_FONTCONFIG
+/**
+ * \brief Select a new FT_Face with the given character
+ * The new face is added to the end of font->faces.
+ **/
+static void ass_font_reselect(void* fontconfig_priv, ass_font_t* font, uint32_t ch)
+{
+	char* path;
+	int index;
+	FT_Face face;
+	int error;
+
+	if (font->n_faces == ASS_FONT_MAX_FACES)
+		return;
+	
+	path = fontconfig_select_with_charset(fontconfig_priv, font->desc.family, font->desc.bold,
+					      font->desc.italic, &index, font->charset);
+
+	error = FT_New_Face(font->ftlibrary, path, index, &face);
+	if (error) {
+		mp_msg(MSGT_ASS, MSGL_WARN, MSGTR_LIBASS_ErrorOpeningFont, path, index);
+		return;
+	}
+	charmap_magic(face);
+
+	error = FT_Get_Char_Index(face, ch);
+	if (error == 0) { // the new font face is not better then the old one
+		FT_Done_Face(face);
+		return;
+	}
+
+	font->faces[font->n_faces++] = face;
+	update_transform(font);
+	FT_Set_Pixel_Sizes(face, 0, (int)font->size);
+}
+#endif
+
+/**
+ * \brief Get maximal font ascender and descender.
+ * \param ch character code
+ * The values are extracted from the font face that provides glyphs for the given character
+ **/
+void ass_font_get_asc_desc(ass_font_t* font, uint32_t ch, int* asc, int* desc)
+{
+	int i;
+	for (i = 0; i < font->n_faces; ++i) {
+		FT_Face face = font->faces[i];
+		if (FT_Get_Char_Index(face, ch)) {
+			int v, v2;
+			v = face->size->metrics.ascender;
+			v2 = FT_MulFix(face->bbox.yMax, face->size->metrics.y_scale);
+			*asc = (v > v2 * 0.9) ? v : v2;
+				
+			v = - face->size->metrics.descender;
+			v2 = - FT_MulFix(face->bbox.yMin, face->size->metrics.y_scale);
+			*desc = (v > v2 * 0.9) ? v : v2;
+			return;
+		}
+	}
+	
+	*asc = *desc = 0;
+}
+
+/**
+ * \brief Get a glyph
+ * \param ch character code
+ **/
+FT_Glyph ass_font_get_glyph(void* fontconfig_priv, ass_font_t* font, uint32_t ch, ass_hinting_t hinting)
+{
+	int error;
+	int index = 0;
+	int i;
+	FT_Glyph glyph;
+	FT_Face face = 0;
+	int flags = 0;
+
+	if (ch < 0x20)
+		return 0;
+	if (font->n_faces == 0)
+		return 0;
+
+	for (i = 0; i < font->n_faces; ++i) {
+		face = font->faces[i];
+		index = FT_Get_Char_Index(face, ch);
+		if (index)
+			break;
+	}
+
+#ifdef HAVE_FONTCONFIG
+	FcCharSetAddChar(font->charset, ch);
+	if (index == 0) {
+		mp_msg(MSGT_ASS, MSGL_INFO, MSGTR_LIBASS_GlyphNotFoundReselectingFont,
+		       ch, font->desc.family, font->desc.bold, font->desc.italic);
+		ass_font_reselect(fontconfig_priv, font, ch);
+		face = font->faces[font->n_faces - 1];
+		index = FT_Get_Char_Index(face, ch);
+		if (index == 0) {
+			mp_msg(MSGT_ASS, MSGL_ERR, MSGTR_LIBASS_GlyphNotFound,
+			       ch, font->desc.family, font->desc.bold, font->desc.italic);
+		}
+	}
+#endif
+
+	switch (hinting) {
+	case ASS_HINTING_NONE: flags = FT_LOAD_NO_HINTING; break;
+	case ASS_HINTING_LIGHT: flags = FT_LOAD_FORCE_AUTOHINT | FT_LOAD_TARGET_LIGHT; break;
+	case ASS_HINTING_NORMAL: flags = FT_LOAD_FORCE_AUTOHINT; break;
+	case ASS_HINTING_NATIVE: flags = 0; break;
+	}
+	
+	error = FT_Load_Glyph(face, index, FT_LOAD_NO_BITMAP | flags);
+	if (error) {
+		mp_msg(MSGT_ASS, MSGL_WARN, MSGTR_LIBASS_ErrorLoadingGlyph);
+		return 0;
+	}
+	
+#if (FREETYPE_MAJOR > 2) || \
+    ((FREETYPE_MAJOR == 2) && (FREETYPE_MINOR >= 2)) || \
+    ((FREETYPE_MAJOR == 2) && (FREETYPE_MINOR == 1) && (FREETYPE_PATCH >= 10))
+// FreeType >= 2.1.10 required
+	if (!(face->style_flags & FT_STYLE_FLAG_ITALIC) && 
+			(font->desc.italic > 55)) {
+		FT_GlyphSlot_Oblique(face->glyph);
+	}
+#endif
+	error = FT_Get_Glyph(face->glyph, &glyph);
+	if (error) {
+		mp_msg(MSGT_ASS, MSGL_WARN, MSGTR_LIBASS_ErrorLoadingGlyph);
+		return 0;
+	}
+	
+	return glyph;
+}
+
+/**
+ * \brief Get kerning for the pair of glyphs.
+ **/
+FT_Vector ass_font_get_kerning(ass_font_t* font, uint32_t c1, uint32_t c2)
+{
+	FT_Vector v = {0, 0};
+	int i;
+
+	for (i = 0; i < font->n_faces; ++i) {
+		FT_Face face = font->faces[i];
+		int i1 = FT_Get_Char_Index(face, c1);
+		int i2 = FT_Get_Char_Index(face, c2);
+		if (i1 && i2) {
+			if (FT_HAS_KERNING(face))
+				FT_Get_Kerning(face, i1, i2, FT_KERNING_DEFAULT, &v);
+			return v;
+		}
+		if (i1 || i2) // these glyphs are from different font faces, no kerning information
+			return v;
+	}
+	return v;
+}
+
+/**
+ * \brief Deallocate ass_font_t
+ **/
+void ass_font_free(ass_font_t* font)
+{
+	int i;
+	for (i = 0; i < font->n_faces; ++i)
+		if (font->faces[i]) FT_Done_Face(font->faces[i]);
+	if (font->desc.family) free(font->desc.family);
+#ifdef HAVE_FONTCONFIG
+	if (font->charset) FcCharSetDestroy(font->charset);
+#endif
+	free(font);
+}

Added: branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_libass/ass_font.h
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_libass/ass_font.h	2007-07-13 17:01:23 UTC (rev 3361)
+++ branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_libass/ass_font.h	2007-07-14 08:27:37 UTC (rev 3362)
@@ -0,0 +1,57 @@
+// -*- c-basic-offset: 8; indent-tabs-mode: t -*-
+// vim:ts=8:sw=8:noet:ai:
+/*
+  Copyright (C) 2006 Evgeniy Stepanov <eugeni.stepanov at gmail.com>
+
+  This program is free software; you can redistribute it and/or modify
+  it under the terms of the GNU General Public License as published by
+  the Free Software Foundation; either version 2 of the License, or
+  (at your option) any later version.
+
+  This program is distributed in the hope that it will be useful,
+  but WITHOUT ANY WARRANTY; without even the implied warranty of
+  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+  GNU General Public License for more details.
+
+  You should have received a copy of the GNU General Public License
+  along with this program; if not, write to the Free Software
+  Foundation, Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA
+*/
+
+#ifndef __ASS_FONT_H__
+#define __ASS_FONT_H__
+
+#ifdef HAVE_FONTCONFIG
+#include <fontconfig/fontconfig.h>
+#endif
+
+typedef struct ass_font_desc_s {
+	char* family;
+	unsigned bold;
+	unsigned italic;
+} ass_font_desc_t;
+
+#define ASS_FONT_MAX_FACES 10
+
+typedef struct ass_font_s {
+	ass_font_desc_t desc;
+	FT_Library ftlibrary;
+	FT_Face faces[ASS_FONT_MAX_FACES];
+	int n_faces;
+	double scale_x, scale_y; // current transform
+	FT_Vector v; // current shift
+	double size;
+#ifdef HAVE_FONTCONFIG
+	FcCharSet* charset;
+#endif
+} ass_font_t;
+
+ass_font_t* ass_font_new(ass_library_t* library, FT_Library ftlibrary, void* fc_priv, ass_font_desc_t* desc);
+void ass_font_set_transform(ass_font_t* font, double scale_x, double scale_y, FT_Vector* v);
+void ass_font_set_size(ass_font_t* font, double size);
+void ass_font_get_asc_desc(ass_font_t* font, uint32_t ch, int* asc, int* desc);
+FT_Glyph ass_font_get_glyph(void* fontconfig_priv, ass_font_t* font, uint32_t ch, ass_hinting_t hinting);
+FT_Vector ass_font_get_kerning(ass_font_t* font, uint32_t c1, uint32_t c2);
+void ass_font_free(ass_font_t* font);
+
+#endif

Modified: branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_libass/ass_fontconfig.c
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_libass/ass_fontconfig.c	2007-07-13 17:01:23 UTC (rev 3361)
+++ branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_libass/ass_fontconfig.c	2007-07-14 08:27:37 UTC (rev 3362)
@@ -26,18 +26,20 @@
 #include <string.h>
 #include <sys/types.h>
 #include <sys/stat.h>
+#include <inttypes.h>
+#include <ft2build.h>
+#include FT_FREETYPE_H
 
 #include "mputils.h"
+#include "ass.h"
+#include "ass_library.h"
 #include "ass_fontconfig.h"
 
 #ifdef HAVE_FONTCONFIG
 #include <fontconfig/fontconfig.h>
+#include <fontconfig/fcfreetype.h>
 #endif
 
-#define ADM_LEGACY_PROGGY
-#include "ADM_assert.h"
-
-
 struct fc_instance_s {
 #ifdef HAVE_FONTCONFIG
 	FcConfig* config;
@@ -47,8 +49,6 @@
 	int index_default;
 };
 
-extern int no_more_font_messages;
-
 #ifdef HAVE_FONTCONFIG
 /**
  * \brief Low-level font selection.
@@ -57,22 +57,28 @@
  * \param bold font weight value
  * \param italic font slant value
  * \param index out: font index inside a file
+ * \param charset: contains the characters that should be present in the font, can be NULL
  * \return font file path
 */ 
-static char* _select_font(fc_instance_t* priv, const char* family, unsigned bold, unsigned italic, int* index)
+static char* _select_font(fc_instance_t* priv, const char* family, unsigned bold, unsigned italic, int* index,
+			  FcCharSet* charset)
 {
 	FcBool rc;
 	FcResult result;
-	FcPattern *pat, *rpat;
+	FcPattern *pat = 0, *rpat;
 	int val_i;
 	FcChar8* val_s;
 	FcBool val_b;
+	FcCharSet* val_cs;
+	FcFontSet* fset = 0;
+	int curf, bestf, bestdiff = 0;
+	char* retval = 0;
 	
 	*index = 0;
 
 	pat = FcPatternCreate();
 	if (!pat)
-		return 0;
+		goto error;
 	
 	FcPatternAddString(pat, FC_FAMILY, (const FcChar8*)family);
 	FcPatternAddBool(pat, FC_OUTLINE, FcTrue);
@@ -83,36 +89,67 @@
 	
 	rc = FcConfigSubstitute(priv->config, pat, FcMatchPattern);
 	if (!rc)
-		return 0;
+		goto error;
+
+	fset = FcFontSort(priv->config, pat, FcTrue, NULL, &result);
+
+	bestf = -1;
+	if (charset)
+		bestdiff = FcCharSetCount(charset) + 1;
+	for (curf = 0; curf < fset->nfont; ++curf) {
+		rpat = fset->fonts[curf];
+		
+		result = FcPatternGetBool(rpat, FC_OUTLINE, 0, &val_b);
+		if (result != FcResultMatch)
+			continue;
+		if (val_b != FcTrue)
+			continue;
+
+		if (charset) {
+			int diff;
+			result = FcPatternGetCharSet(rpat, FC_CHARSET, 0, &val_cs);
+			if (result != FcResultMatch)
+				continue;
+			diff = FcCharSetSubtractCount(charset, val_cs);
+			if (diff < bestdiff) {
+				bestdiff = diff;
+				bestf = curf;
+			}
+ 			if (diff == 0)
+				break;
+		} else {
+			bestf = curf;
+			break;
+		}
+	}
+
+	if (bestf < 0)
+		goto error;
+
+	rpat = fset->fonts[bestf];
 	
-	rpat = FcFontMatch(priv->config, pat, &result);
-	if (!rpat)
-		return 0;
-	
-	result = FcPatternGetBool(rpat, FC_OUTLINE, 0, &val_b);
-	if (result != FcResultMatch)
-		return 0;
-	if (val_b != FcTrue)
-		return 0;
-	
 	result = FcPatternGetInteger(rpat, FC_INDEX, 0, &val_i);
 	if (result != FcResultMatch)
-		return 0;
+		goto error;
 	*index = val_i;
 
 	result = FcPatternGetString(rpat, FC_FAMILY, 0, &val_s);
 	if (result != FcResultMatch)
-		return 0;
+		goto error;
 
 	if (strcasecmp((const char*)val_s, family) != 0)
-		mp_msg(MSGT_ASS, MSGL_WARN, "fontconfig: selected font family is not the requested one: '%s' != '%s'\n",
+		mp_msg(MSGT_ASS, MSGL_WARN, MSGTR_LIBASS_SelectedFontFamilyIsNotTheRequestedOne,
 				(const char*)val_s, family);
 
 	result = FcPatternGetString(rpat, FC_FILE, 0, &val_s);
 	if (result != FcResultMatch)
-		return 0;
+		goto error;
 	
-	return strdup((const char*)val_s);
+	retval = strdup((const char*)val_s);
+ error:
+	if (pat) FcPatternDestroy(pat);
+	if (fset) FcFontSetDestroy(fset);
+	return retval;
 }
 
 /**
@@ -122,30 +159,31 @@
  * \param bold font weight value
  * \param italic font slant value
  * \param index out: font index inside a file
+ * \param charset: contains the characters that should be present in the font, can be NULL
  * \return font file path
 */ 
-char* fontconfig_select(fc_instance_t* priv, const char* family, unsigned bold, unsigned italic, int* index)
+char* fontconfig_select_with_charset(fc_instance_t* priv, const char* family, unsigned bold, unsigned italic, int* index,
+			FcCharSet* charset)
 {
 	char* res = 0;
 	if (family && *family)
-		res = _select_font(priv, family, bold, italic, index);
+		res = _select_font(priv, family, bold, italic, index, charset);
 	if (!res && priv->family_default) {
-		res = _select_font(priv, priv->family_default, bold, italic, index);
-		if (res && !no_more_font_messages)
-			mp_msg(MSGT_ASS, MSGL_WARN, "fontconfig_select: using default font family: (%s, %d, %d) -> %s, %d\n", 
+		res = _select_font(priv, priv->family_default, bold, italic, index, charset);
+		if (res)
+			mp_msg(MSGT_ASS, MSGL_WARN, MSGTR_LIBASS_UsingDefaultFontFamily, 
 					family, bold, italic, res, *index);
 	}
 	if (!res && priv->path_default) {
 		res = priv->path_default;
 		*index = priv->index_default;
-		if (!no_more_font_messages)
-			mp_msg(MSGT_ASS, MSGL_WARN, "fontconfig_select: using default font: (%s, %d, %d) -> %s, %d\n",
-					family, bold, italic, res, *index);
+		mp_msg(MSGT_ASS, MSGL_WARN, MSGTR_LIBASS_UsingDefaultFont, 
+		       family, bold, italic, res, *index);
 	}
 	if (!res) {
-		res = _select_font(priv, "Arial", bold, italic, index);
-		if (res && !no_more_font_messages)
-			mp_msg(MSGT_ASS, MSGL_WARN, "fontconfig_select: using 'Arial' font family: (%s, %d, %d) -> %s, %d\n",
+		res = _select_font(priv, "Arial", bold, italic, index, charset);
+		if (res)
+			mp_msg(MSGT_ASS, MSGL_WARN, MSGTR_LIBASS_UsingArialFontFamily, 
 					family, bold, italic, res, *index);
 	}
 	if (res)
@@ -154,35 +192,170 @@
 	return res;
 }
 
+char* fontconfig_select(fc_instance_t* priv, const char* family, unsigned bold, unsigned italic, int* index)
+{
+	return fontconfig_select_with_charset(priv, family, bold, italic, index, 0);
+}
+
+#if (FC_VERSION < 20402)
+static char* validate_fname(char* name)
+{
+	char* fname;
+	char* p;
+	char* q;
+	unsigned code;
+	int sz = strlen(name);
+
+	q = fname = malloc(sz + 1);
+	p = name;
+	while (*p) {
+		code = utf8_get_char(&p);
+		if (code == 0)
+			break;
+		if (	(code > 0x7F) ||
+			(code == '\\') ||
+			(code == '/') ||
+			(code == ':') ||
+			(code == '*') ||
+			(code == '?') ||
+			(code == '<') ||
+			(code == '>') ||
+			(code == '|') ||
+			(code == 0))
+		{
+			*q++ = '_';
+		} else {
+			*q++ = code;
+		}
+		if (p - name > sz)
+			break;
+	}
+	*q = 0;
+	return fname;
+}
+#endif
+
 /**
+ * \brief Process memory font.
+ * \param priv private data
+ * \param library library object
+ * \param ftlibrary freetype library object
+ * \param idx index of the processed font in library->fontdata
+ * With FontConfig >= 2.4.2, builds a font pattern in memory via FT_New_Memory_Face/FcFreeTypeQueryFace.
+ * With older FontConfig versions, save the font to ~/.mplayer/fonts.
+*/ 
+static void process_fontdata(fc_instance_t* priv, ass_library_t* library, FT_Library ftlibrary, int idx)
+{
+	int rc;
+	const char* name = library->fontdata[idx].name;
+	const char* data = library->fontdata[idx].data;
+	int data_size = library->fontdata[idx].size;
+
+#if (FC_VERSION < 20402)
+	struct stat st;
+	char* fname;
+	const char* fonts_dir = library->fonts_dir;
+	char buf[1000];
+	FILE* fp = 0;
+
+	if (!fonts_dir)
+		return;
+	rc = stat(fonts_dir, &st);
+	if (rc) {
+		int res;
+#ifndef __MINGW32__
+		res = mkdir(fonts_dir, 0700);
+#else
+		res = mkdir(fonts_dir);
+#endif
+		if (res) {
+			mp_msg(MSGT_ASS, MSGL_WARN, MSGTR_LIBASS_FailedToCreateDirectory, fonts_dir);
+		}
+	} else if (!S_ISDIR(st.st_mode)) {
+		mp_msg(MSGT_ASS, MSGL_WARN, MSGTR_LIBASS_NotADirectory, fonts_dir);
+	}
+	
+	fname = validate_fname((char*)name);
+
+	snprintf(buf, 1000, "%s/%s", fonts_dir, fname);
+	free(fname);
+
+	fp = fopen(buf, "wb");
+	if (!fp) return;
+
+	fwrite(data, data_size, 1, fp);
+	fclose(fp);
+
+#else // (FC_VERSION >= 20402)
+	FT_Face face;
+	FcPattern* pattern;
+	FcFontSet* fset;
+	FcBool res;
+
+	rc = FT_New_Memory_Face(ftlibrary, (unsigned char*)data, data_size, 0, &face);
+	if (rc) {
+		mp_msg(MSGT_ASS, MSGL_WARN, MSGTR_LIBASS_ErrorOpeningMemoryFont, name);
+		return;
+	}
+
+	pattern = FcFreeTypeQueryFace(face, (unsigned char*)name, 0, FcConfigGetBlanks(priv->config));
+	if (!pattern) {
+		mp_msg(MSGT_ASS, MSGL_WARN, MSGTR_LIBASS_FunctionCallFailed, "FcFreeTypeQueryFace");
+		FT_Done_Face(face);
+		return;
+	}
+
+	fset = FcConfigGetFonts(priv->config, FcSetSystem); // somehow it failes when asked for FcSetApplication
+	if (!fset) {
+		mp_msg(MSGT_ASS, MSGL_WARN, MSGTR_LIBASS_FunctionCallFailed, "FcConfigGetFonts");
+		FT_Done_Face(face);
+		return;
+	}
+
+	res = FcFontSetAdd(fset, pattern);
+	if (!res) {
+		mp_msg(MSGT_ASS, MSGL_WARN, MSGTR_LIBASS_FunctionCallFailed, "FcFontSetAdd");
+		FT_Done_Face(face);
+		return;
+	}
+
+	FT_Done_Face(face);
+#endif
+}
+
+/**
  * \brief Init fontconfig.
- * \param dir additional directoryu for fonts
+ * \param library libass library object
+ * \param ftlibrary freetype library object
  * \param family default font family
  * \param path default font path
  * \return pointer to fontconfig private data
 */ 
-fc_instance_t* fontconfig_init(const char* dir, const char* family, const char* path)
+fc_instance_t* fontconfig_init(ass_library_t* library, FT_Library ftlibrary, const char* family, const char* path)
 {
 	int rc;
-	struct stat st;
-	fc_instance_t* priv = (fc_instance_t *)calloc(1, sizeof(fc_instance_t));
+	fc_instance_t* priv = calloc(1, sizeof(fc_instance_t));
+	const char* dir = library->fonts_dir;
+	int i;
 	
 	rc = FcInit();
 	assert(rc);
 
 	priv->config = FcConfigGetCurrent();
 	if (!priv->config) {
-		mp_msg(MSGT_ASS, MSGL_FATAL, "FcInitLoadConfigAndFonts failed\n");
+		mp_msg(MSGT_ASS, MSGL_FATAL, MSGTR_LIBASS_FcInitLoadConfigAndFontsFailed);
 		return 0;
 	}
 
+	for (i = 0; i < library->num_fontdata; ++i)
+		process_fontdata(priv, library, ftlibrary, i);
+
 	if (FcDirCacheValid((const FcChar8 *)dir) == FcFalse)
 	{
-		mp_msg(MSGT_ASS, MSGL_INFO, "[ass] Updating font cache\n");
+		mp_msg(MSGT_ASS, MSGL_INFO, MSGTR_LIBASS_UpdatingFontCache);
 		if (FcGetVersion() >= 20390 && FcGetVersion() < 20400)
 			mp_msg(MSGT_ASS, MSGL_WARN,
-			       "[ass] beta versions of fontconfig are not supported\n"
-			       "      update before reporting any bugs\n");
+			       MSGTR_LIBASS_BetaVersionsOfFontconfigAreNotSupported);
 		// FontConfig >= 2.4.0 updates cache automatically in FcConfigAppFontAddDir()
 		if (FcGetVersion() < 20390) {
 			FcFontSet* fcs;
@@ -191,19 +364,19 @@
 			fss = FcStrSetCreate();
 			rc = FcStrSetAdd(fss, (const FcChar8*)dir);
 			if (!rc) {
-				mp_msg(MSGT_ASS, MSGL_WARN, "FcStrSetAdd failed\n");
+				mp_msg(MSGT_ASS, MSGL_WARN, MSGTR_LIBASS_FcStrSetAddFailed);
 				goto ErrorFontCache;
 			}
 
 			rc = FcDirScan(fcs, fss, NULL, FcConfigGetBlanks(priv->config), (const FcChar8 *)dir, FcFalse);
 			if (!rc) {
-				mp_msg(MSGT_ASS, MSGL_WARN, "FcDirScan failed\n");
+				mp_msg(MSGT_ASS, MSGL_WARN, MSGTR_LIBASS_FcDirScanFailed);
 				goto ErrorFontCache;
 			}
 
 			rc = FcDirSave(fcs, fss, (const FcChar8 *)dir);
 			if (!rc) {
-				mp_msg(MSGT_ASS, MSGL_WARN, "FcDirSave failed\n");
+				mp_msg(MSGT_ASS, MSGL_WARN, MSGTR_LIBASS_FcDirSave);
 				goto ErrorFontCache;
 			}
 		ErrorFontCache:
@@ -213,22 +386,17 @@
 
 	rc = FcConfigAppFontAddDir(priv->config, (const FcChar8*)dir);
 	if (!rc) {
-		mp_msg(MSGT_ASS, MSGL_WARN, "FcConfigAppFontAddDir failed\n");
+		mp_msg(MSGT_ASS, MSGL_WARN, MSGTR_LIBASS_FcConfigAppFontAddDirFailed);
 	}
 
 	priv->family_default = family ? strdup(family) : 0;
+	priv->path_default = path ? strdup(path) : 0;
 	priv->index_default = 0;
-	
-	rc = stat(path, &st);
-	if (!rc && S_ISREG(st.st_mode))
-		priv->path_default = path ? strdup(path) : 0;
-	else
-		priv->path_default = 0;
 
 	return priv;
 }
 
-#else
+#else // HAVE_FONTCONFIG
 
 char* fontconfig_select(fc_instance_t* priv, const char* family, unsigned bold, unsigned italic, int* index)
 {
@@ -236,11 +404,11 @@
 	return priv->path_default;
 }
 
-fc_instance_t* fontconfig_init(const char* dir, const char* family, const char* path)
+fc_instance_t* fontconfig_init(ass_library_t* library, FT_Library ftlibrary, const char* family, const char* path)
 {
 	fc_instance_t* priv;
 
-	mp_msg(MSGT_ASS, MSGL_WARN, "Fontconfig disabled, only default font will be used\n");
+	mp_msg(MSGT_ASS, MSGL_WARN, MSGTR_LIBASS_FontconfigDisabledDefaultFontWillBeUsed);
 	
 	priv = calloc(1, sizeof(fc_instance_t));
 	

Modified: branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_libass/ass_fontconfig.h
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_libass/ass_fontconfig.h	2007-07-13 17:01:23 UTC (rev 3361)
+++ branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_libass/ass_fontconfig.h	2007-07-14 08:27:37 UTC (rev 3362)
@@ -21,11 +21,19 @@
 #ifndef __ASS_FONTCONFIG_H__
 #define __ASS_FONTCONFIG_H__
 
+#ifdef HAVE_FONTCONFIG
+#include <fontconfig/fontconfig.h>
+#endif
+
 typedef struct fc_instance_s fc_instance_t;
 
-fc_instance_t* fontconfig_init(const char* dir, const char* family, const char* path);
+fc_instance_t* fontconfig_init(ass_library_t* library, FT_Library ftlibrary, const char* family, const char* path);
 char* fontconfig_select(fc_instance_t* priv, const char* family, unsigned bold, unsigned italic, int* index);
 void fontconfig_done(fc_instance_t* priv);
 
+#ifdef HAVE_FONTCONFIG
+char* fontconfig_select_with_charset(fc_instance_t* priv, const char* family, unsigned bold, unsigned italic, int* index, FcCharSet* charset);
 #endif
 
+#endif
+

Modified: branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_libass/ass_library.c
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_libass/ass_library.c	2007-07-13 17:01:23 UTC (rev 3361)
+++ branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_libass/ass_library.c	2007-07-14 08:27:37 UTC (rev 3362)
@@ -26,17 +26,19 @@
 #include "ass.h"
 #include "ass_library.h"
 
-#define ADM_LEGACY_PROGGY
-#include "ADM_assert.h"
 
 ass_library_t* ass_library_init(void)
 {
-	return (ass_library_t *) calloc(1, sizeof(ass_library_t));
+	return calloc(1, sizeof(ass_library_t));
 }
 
 void ass_library_done(ass_library_t* priv)
 {
-	if (priv) free(priv);
+	if (priv) {
+		ass_set_fonts_dir(priv, NULL);
+		ass_set_style_overrides(priv, NULL);
+		free(priv);
+	}
 }
 
 void ass_set_fonts_dir(ass_library_t* priv, const char* fonts_dir)
@@ -68,8 +70,24 @@
 
 	for (p = list, cnt = 0; *p; ++p, ++cnt) {}
 
-	priv->style_overrides = (char **)malloc((cnt + 1) * sizeof(char*));
+	priv->style_overrides = malloc((cnt + 1) * sizeof(char*));
 	for (p = list, q = priv->style_overrides; *p; ++p, ++q)
 		*q = strdup(*p);
 	priv->style_overrides[cnt] = NULL;
 }
+
+static void grow_array(void **array, int nelem, size_t elsize)
+{
+	if (!(nelem & 31))
+		*array = realloc(*array, (nelem + 32) * elsize);
+}
+
+void ass_add_font(ass_library_t* priv, char* name, char* data, int size)
+{
+	grow_array((void**)&priv->fontdata, priv->num_fontdata, sizeof(*priv->fontdata));
+	priv->fontdata[priv->num_fontdata].name = name;
+	priv->fontdata[priv->num_fontdata].data = data;
+	priv->fontdata[priv->num_fontdata].size = size;
+	priv->num_fontdata ++;
+}
+

Modified: branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_libass/ass_library.h
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_libass/ass_library.h	2007-07-13 17:01:23 UTC (rev 3361)
+++ branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_libass/ass_library.h	2007-07-14 08:27:37 UTC (rev 3362)
@@ -21,10 +21,19 @@
 #ifndef __ASS_LIBRARY_H__
 #define __ASS_LIBRARY_H__
 
+typedef struct ass_fontdata_s {
+	char* name;
+	char* data;
+	int size;
+} ass_fontdata_t;
+
 struct ass_library_s {
 	char* fonts_dir;
 	int extract_fonts;
 	char** style_overrides;
+
+	ass_fontdata_t* fontdata;
+	int num_fontdata;
 };
 
 #endif

Modified: branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_libass/ass_render.c
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_libass/ass_render.c	2007-07-13 17:01:23 UTC (rev 3361)
+++ branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_libass/ass_render.c	2007-07-14 08:27:37 UTC (rev 3362)
@@ -32,16 +32,13 @@
 #include "mputils.h"
 
 #include "ass.h"
+#include "ass_font.h"
 #include "ass_bitmap.h"
 #include "ass_cache.h"
 #include "ass_utils.h"
 #include "ass_fontconfig.h"
 #include "ass_library.h"
 
-#define ADM_LEGACY_PROGGY
-#include "ADM_assert.h"
-
-
 #define MAX_GLYPHS 1000
 #define MAX_LINES 100
 
@@ -59,11 +56,21 @@
 	int use_margins; // 0 - place all subtitles inside original frame
 	                 // 1 - use margins for placing toptitles and subtitles
 	double aspect; // frame aspect ratio, d_width / d_height.
+	ass_hinting_t hinting;
 
 	char* default_font;
 	char* default_family;
 } ass_settings_t;
 
+// a rendered event
+typedef struct event_images_s {
+	ass_image_t* imgs;
+	int top, height;
+	int detect_collisions;
+	int shift_direction;
+	ass_event_t* event;
+} event_images_t;
+
 struct ass_renderer_s {
 	ass_library_t* library;
 	FT_Library ftlibrary;
@@ -73,10 +80,12 @@
 	ass_synth_priv_t* synth_priv;
 
 	ass_image_t* images_root; // rendering result is stored here
+	ass_image_t* prev_images_root;
+
+	event_images_t* eimg; // temporary buffer for sorting rendered events
+	int eimg_size; // allocated buffer size
 };
 
-int no_more_font_messages = 0;  // don't print font warnings
-
 typedef enum {EF_NONE = 0, EF_KARAOKE, EF_KARAOKE_KF, EF_KARAOKE_KO} effect_t;
 
 // describes a glyph
@@ -102,9 +111,9 @@
 //	int height;
 	int be; // blur edges
 	int shadow;
-	double frz; // z-axis rotation
+	double frx, fry, frz; // rotation
 	
-	glyph_hash_key_t hash_key;
+	bitmap_hash_key_t hash_key;
 } glyph_info_t;
 
 typedef struct line_info_s {
@@ -122,34 +131,27 @@
 
 // Renderer state.
 // Values like current font face, color, screen position, clipping and so on are stored here.
-typedef enum 
-{	EVENT_NORMAL, // "normal" top-, sub- or mid- title
-		EVENT_POSITIONED, // happens after pos(,), margins are ignored
-		EVENT_HSCROLL, // "Banner" transition effect, text_width is unlimited
-		EVENT_VSCROLL // "Scroll up", "Scroll down" transition effects
-		}EVENT_X;
-typedef enum 
-{ SCROLL_LR, // left-to-right
-	       SCROLL_RL,
-	       SCROLL_TB, // top-to-bottom
-	       SCROLL_BT
-	       }SCROLL_TYPE;                    
 typedef struct render_context_s {
 	ass_event_t* event;
 	ass_style_t* style;
 	
-	FT_Face face;
+	ass_font_t* font;
 	char* font_path;
-	int font_size;
+	double font_size;
 	
 	FT_Stroker stroker;
 	int alignment; // alignment overrides go here; if zero, style value will be used
-	double rotation;
-	EVENT_X  evt_type;
+	double frx, fry, frz;
+	enum {	EVENT_NORMAL, // "normal" top-, sub- or mid- title
+		EVENT_POSITIONED, // happens after pos(,), margins are ignored
+		EVENT_HSCROLL, // "Banner" transition effect, text_width is unlimited
+		EVENT_VSCROLL // "Scroll up", "Scroll down" transition effects
+		} evt_type;
 	int pos_x, pos_y; // position
 	int org_x, org_y; // origin
+	char have_origin; // origin is explicitly defined; if 0, get_base_point() is used
 	double scale_x, scale_y;
-	int hspacing; // distance between letters, in pixels
+	double hspacing; // distance between letters, in pixels
 	double border; // outline width
 	uint32_t c[4]; // colors(Primary, Secondary, so on) in RGBA
 	int clip_x0, clip_y0, clip_x1, clip_y1;
@@ -162,7 +164,11 @@
 	int effect_timing;
 	int effect_skip_timing;
 
-	SCROLL_TYPE scroll_direction; // for EVENT_HSCROLL, EVENT_VSCROLL
+	enum { SCROLL_LR, // left-to-right
+	       SCROLL_RL,
+	       SCROLL_TB, // top-to-bottom
+	       SCROLL_BT
+	       } scroll_direction; // for EVENT_HSCROLL, EVENT_VSCROLL
 	int scroll_shift;
 
 	// face properties
@@ -191,15 +197,6 @@
 static render_context_t render_context;
 static frame_context_t frame_context;
 
-// a rendered event
-typedef struct event_images_s {
-	ass_image_t* imgs;
-	int top, height;
-	int detect_collisions;
-	int shift_direction;
-	ass_event_t* event;
-} event_images_t;
-
 struct render_priv_s {
 	int top, height;
 	int render_id;
@@ -211,7 +208,7 @@
 	if (track->PlayResX && track->PlayResY)
 		return;
 	if (!track->PlayResX && !track->PlayResY) {
-		mp_msg(MSGT_ASS, MSGL_WARN, "Neither PlayResX nor PlayResY defined. Assuming 384x288.  \n");
+		mp_msg(MSGT_ASS, MSGL_WARN, MSGTR_LIBASS_NeitherPlayResXNorPlayResYDefined);
 		track->PlayResX = 384;
 		track->PlayResY = 288;
 	} else {
@@ -219,10 +216,10 @@
 			frame_context.orig_height / frame_context.width;
 		if (!track->PlayResY) {
 			track->PlayResY = track->PlayResX / orig_aspect + .5;
-			mp_msg(MSGT_ASS, MSGL_WARN, "PlayResY undefined, setting %d  \n", track->PlayResY);
+			mp_msg(MSGT_ASS, MSGL_WARN, MSGTR_LIBASS_PlayResYUndefinedSettingY, track->PlayResY);
 		} else if (!track->PlayResX) {
 			track->PlayResX = track->PlayResY * orig_aspect + .5;
-			mp_msg(MSGT_ASS, MSGL_WARN, "PlayResX undefined, setting %d  \n", track->PlayResX);
+			mp_msg(MSGT_ASS, MSGL_WARN, MSGTR_LIBASS_PlayResXUndefinedSettingX, track->PlayResX);
 		}
 	}
 }
@@ -233,20 +230,17 @@
 	FT_Library ft;
 	ass_renderer_t* priv = 0;
 	
-        
-        {
-          memset(&render_context, 0, sizeof(render_context));
-          memset(&frame_context, 0, sizeof(frame_context));
-          memset(&text_info, 0, sizeof(text_info));
-        }
-        
+	memset(&render_context, 0, sizeof(render_context));
+	memset(&frame_context, 0, sizeof(frame_context));
+	memset(&text_info, 0, sizeof(text_info));
+
 	error = FT_Init_FreeType( &ft );
 	if ( error ) { 
-		mp_msg(MSGT_ASS, MSGL_FATAL, "FT_Init_FreeType failed\n");
+		mp_msg(MSGT_ASS, MSGL_FATAL, MSGTR_LIBASS_FT_Init_FreeTypeFailed);
 		goto ass_init_exit;
 	}
 
-	priv = (ass_renderer_t *)calloc(1, sizeof(ass_renderer_t));
+	priv = calloc(1, sizeof(ass_renderer_t));
 	if (!priv) {
 		FT_Done_FreeType(ft);
 		goto ass_init_exit;
@@ -258,21 +252,23 @@
 	priv->ftlibrary = ft;
 	// images_root and related stuff is zero-filled in calloc
 	
-	ass_face_cache_init();
+	ass_font_cache_init();
+	ass_bitmap_cache_init();
 	ass_glyph_cache_init();
 
-	text_info.glyphs = (glyph_info_t *)calloc(MAX_GLYPHS, sizeof(glyph_info_t));
+	text_info.glyphs = calloc(MAX_GLYPHS, sizeof(glyph_info_t));
 	
 ass_init_exit:
-	if (priv) mp_msg(MSGT_ASS, MSGL_INFO, "[ass] Init\n");
-	else mp_msg(MSGT_ASS, MSGL_ERR, "[ass] Init failed\n");
+	if (priv) mp_msg(MSGT_ASS, MSGL_INFO, MSGTR_LIBASS_Init);
+	else mp_msg(MSGT_ASS, MSGL_ERR, MSGTR_LIBASS_InitFailed);
 
 	return priv;
 }
 
 void ass_renderer_done(ass_renderer_t* priv)
 {
-	ass_face_cache_done();
+	ass_font_cache_done();
+	ass_bitmap_cache_done();
 	ass_glyph_cache_done();
 	if (render_context.stroker) {
 		FT_Stroker_Done(render_context.stroker);
@@ -281,23 +277,18 @@
 	if (priv && priv->ftlibrary) FT_Done_FreeType(priv->ftlibrary);
 	if (priv && priv->fontconfig_priv) fontconfig_done(priv->fontconfig_priv);
 	if (priv && priv->synth_priv) ass_synth_done(priv->synth_priv);
+	if (priv && priv->eimg) free(priv->eimg);
 	if (priv) free(priv);
-        priv=NULL;
-        
-        {
-	 if (text_info.glyphs) free(text_info.glyphs);
-          text_info.glyphs=NULL;
-        }
-        
+	if (text_info.glyphs) free(text_info.glyphs);
 }
 
 /**
  * \brief Create a new ass_image_t
  * Parameters are the same as ass_image_t fields.
  */
-ass_image_t* my_draw_bitmap(unsigned char* bitmap, int bitmap_w, int bitmap_h, int stride, int dst_x, int dst_y, uint32_t color)
+static ass_image_t* my_draw_bitmap(unsigned char* bitmap, int bitmap_w, int bitmap_h, int stride, int dst_x, int dst_y, uint32_t color)
 {
-	ass_image_t* img = (ass_image_t *)calloc(1, sizeof(ass_image_t));
+	ass_image_t* img = calloc(1, sizeof(ass_image_t));
 	
 	img->w = bitmap_w;
 	img->h = bitmap_h;
@@ -322,7 +313,7 @@
  * \return pointer to the new list tail
  * Performs clipping. Uses my_draw_bitmap for actual bitmap convertion.
  */
-ass_image_t** render_glyph(bitmap_t* bm, int dst_x, int dst_y, uint32_t color, uint32_t color2, int brk, ass_image_t** tail)
+static ass_image_t** render_glyph(bitmap_t* bm, int dst_x, int dst_y, uint32_t color, uint32_t color2, int brk, ass_image_t** tail)
 {
 	// brk is relative to dst_x
 	// color = color left of brk
@@ -390,45 +381,18 @@
 }
 
 /**
- * \brief Render text_info_t struct into ass_images_t list
- * Rasterize glyphs and put them in glyph cache.
+ * \brief Convert text_info_t struct to ass_image_t list
+ * Splits glyphs in halves when needed (for \kf karaoke).
  */
-ass_image_t* render_text(text_info_t* text_info, int dst_x, int dst_y)
+static ass_image_t* render_text(text_info_t* text_info, int dst_x, int dst_y)
 {
 	int pen_x, pen_y;
-	int i, error;
+	int i;
 	bitmap_t* bm;
-	glyph_hash_val_t hash_val;
 	ass_image_t* head;
 	ass_image_t** tail = &head;
 
 	for (i = 0; i < text_info->length; ++i) {
-		if (text_info->glyphs[i].glyph) {
-			if ((text_info->glyphs[i].symbol == '\n') || (text_info->glyphs[i].symbol == 0))
-				continue;
-			error = glyph_to_bitmap(ass_renderer->synth_priv,
-					text_info->glyphs[i].glyph, text_info->glyphs[i].outline_glyph,
-					&text_info->glyphs[i].bm, &text_info->glyphs[i].bm_o,
-					&text_info->glyphs[i].bm_s, text_info->glyphs[i].be);
-			if (error)
-				text_info->glyphs[i].symbol = 0;
-			FT_Done_Glyph(text_info->glyphs[i].glyph);
-			if (text_info->glyphs[i].outline_glyph)
-				FT_Done_Glyph(text_info->glyphs[i].outline_glyph);
-
-			// cache
-			hash_val.bbox_scaled = text_info->glyphs[i].bbox;
-			hash_val.bm_o = text_info->glyphs[i].bm_o;
-			hash_val.bm = text_info->glyphs[i].bm;
-			hash_val.bm_s = text_info->glyphs[i].bm_s;
-			hash_val.advance.x = text_info->glyphs[i].advance.x;
-			hash_val.advance.y = text_info->glyphs[i].advance.y;
-			cache_add_glyph(&(text_info->glyphs[i].hash_key), &hash_val);
-
-		}
-	}
-
-	for (i = 0; i < text_info->length; ++i) {
 		glyph_info_t* info = text_info->glyphs + i;
 		if ((info->symbol == 0) || (info->symbol == '\n') || !info->bm_s || (info->shadow == 0))
 			continue;
@@ -513,12 +477,12 @@
 	if (text_info.length > 0) {
 		bbox.xMin = 32000;
 		bbox.xMax = -32000;
-		bbox.yMin = - (text_info.lines[0].asc >> 6) + text_info.glyphs[0].pos.y;
-		bbox.yMax = ((text_info.height - text_info.lines[0].asc) >> 6) + text_info.glyphs[0].pos.y;
+		bbox.yMin = - d6_to_int(text_info.lines[0].asc) + text_info.glyphs[0].pos.y;
+		bbox.yMax = d6_to_int(text_info.height - text_info.lines[0].asc) + text_info.glyphs[0].pos.y;
 
 		for (i = 0; i < text_info.length; ++i) {
 			int s = text_info.glyphs[i].pos.x;
-			int e = s + (text_info.glyphs[i].advance.x >> 6);
+			int e = s + d6_to_int(text_info.glyphs[i].advance.x);
 			bbox.xMin = FFMIN(bbox.xMin, s);
 			bbox.xMax = FFMAX(bbox.xMax, e);
 		}
@@ -542,9 +506,7 @@
 		return 0;
 }
 
-double ass_internal_font_size_coeff = 0.8;
-
-static void change_font_size(int sz)
+static void change_font_size(double sz)
 {
 	double size = sz * frame_context.font_scale;
 
@@ -552,9 +514,9 @@
 		size = 1;
 	else if (size > frame_context.height * 2)
 		size = frame_context.height * 2;
-	
-	FT_Set_Pixel_Sizes(render_context.face, 0, size);
 
+	ass_font_set_size(render_context.font, size);
+
 	render_context.font_size = sz;
 }
 
@@ -563,10 +525,9 @@
  */
 static void update_font(void)
 {
-	int error;
 	unsigned val;
 	ass_renderer_t* priv = frame_context.ass_priv;
-	face_desc_t desc;
+	ass_font_desc_t desc;
 	desc.family = strdup(render_context.family);
 
 	val = render_context.bold;
@@ -580,12 +541,10 @@
 	else if (val == 1) val = 110; //italic
 	desc.italic = val;
 
-	error = ass_new_face(priv->ftlibrary, priv->fontconfig_priv, &desc, &(render_context.face));
-	if (error) {
-		render_context.face = 0;
-	}
+	render_context.font = ass_font_new(priv->library, priv->ftlibrary, priv->fontconfig_priv, &desc);
+	free(desc.family);
 	
-	if (render_context.face)
+	if (render_context.font)
 		change_font_size(render_context.font_size);
 }
 
@@ -596,7 +555,7 @@
 static void change_border(double border)
 {
 	int b;
-	if (!render_context.face) return;
+	if (!render_context.font) return;
 
 	if (border < 0) {
 		if (render_context.style->BorderStyle == 1) {
@@ -616,7 +575,7 @@
 #if (FREETYPE_MAJOR > 2) || ((FREETYPE_MAJOR == 2) && (FREETYPE_MINOR > 1))
 			error = FT_Stroker_New( ass_renderer->ftlibrary, &render_context.stroker );
 #else // < 2.2
-			error = FT_Stroker_New( render_context.face->memory, &render_context.stroker );
+			error = FT_Stroker_New( render_context.font->faces[0]->memory, &render_context.stroker );
 #endif
 			if (error) {
 				mp_msg(MSGT_ASS, MSGL_V, "failed to get stroker\n");
@@ -643,18 +602,18 @@
  * \brief Calculate a weighted average of two colors
  * calculates c1*(1-a) + c2*a, but separately for each component except alpha
  */
-static void change_color(uint32_t* var, uint32_t nzew, double pwr)
+static void change_color(uint32_t* var, uint32_t new, double pwr)
 {
-	(*var)= ((uint32_t)(_r(*var) * (1 - pwr) + _r(nzew) * pwr) << 24) +
-		((uint32_t)(_g(*var) * (1 - pwr) + _g(nzew) * pwr) << 16) +
-		((uint32_t)(_b(*var) * (1 - pwr) + _b(nzew) * pwr) << 8) +
+	(*var)= ((uint32_t)(_r(*var) * (1 - pwr) + _r(new) * pwr) << 24) +
+		((uint32_t)(_g(*var) * (1 - pwr) + _g(new) * pwr) << 16) +
+		((uint32_t)(_b(*var) * (1 - pwr) + _b(new) * pwr) << 8) +
 		_a(*var);
 }
 
 // like change_color, but for alpha component only
-static void change_alpha(uint32_t* var, uint32_t nzew, double pwr)
+static void change_alpha(uint32_t* var, uint32_t new, double pwr)
 {
-	*var = (_r(*var) << 24) + (_g(*var) << 16) + (_b(*var) << 8) + (_a(*var) * (1 - pwr) + _a(nzew) * pwr);
+	*var = (_r(*var) << 24) + (_g(*var) << 16) + (_b(*var) << 8) + (_a(*var) * (1 - pwr) + _a(new) * pwr);
 }
 
 /**
@@ -696,7 +655,7 @@
 	return a;
 }
 
-static void reset_render_context();
+static void reset_render_context(void);
 
 /**
  * \brief Parse style override tag.
@@ -718,29 +677,29 @@
 		if (tp == 'x') {
 			if (mystrtod(&p, &val)) {
 				val /= 100;
-				render_context.scale_x = (val - 1.) * pwr + 1.;
+				render_context.scale_x = render_context.scale_x * ( 1 - pwr) + val * pwr;
 			} else
 				render_context.scale_x = render_context.style->ScaleX;
 		} else if (tp == 'y') {
 			if (mystrtod(&p, &val)) {
 				val /= 100;
-				render_context.scale_y = (val - 1.) * pwr + 1.;
+				render_context.scale_y = render_context.scale_y * ( 1 - pwr) + val * pwr;
 			} else
 				render_context.scale_y = render_context.style->ScaleY;
 		}
 	} else if (mystrcmp(&p, "fsp")) {
-		int val;
-		if (mystrtoi(&p, 10, &val))
-			render_context.hspacing = val * pwr;
+		double val;
+		if (mystrtod(&p, &val))
+			render_context.hspacing = render_context.hspacing * ( 1 - pwr ) + val * pwr;
 		else
-			render_context.hspacing = 0;
+			render_context.hspacing = render_context.style->Spacing;
 	} else if (mystrcmp(&p, "fs")) {
-		int val;
-		if (mystrtoi(&p, 10, &val))
+		double val;
+		if (mystrtod(&p, &val))
 			val = render_context.font_size * ( 1 - pwr ) + val * pwr;
 		else
 			val = render_context.style->FontSize;
-		if (render_context.face)
+		if (render_context.font)
 			change_font_size(val);
 	} else if (mystrcmp(&p, "bord")) {
 		double val;
@@ -767,8 +726,8 @@
 			t1 = strtoll(p, &p, 10);
 			skip(',');
 			t2 = strtoll(p, &p, 10);
-//			mp_msg(MSGT_ASS, MSGL_DBG2, "movement6: (%d, %d) -> (%d, %d), (%" PRId64 " .. %" PRId64 ")\n", 
-//				x1, y1, x2, y2, (int64_t)t1, (int64_t)t2);
+			mp_msg(MSGT_ASS, MSGL_DBG2, "movement6: (%d, %d) -> (%d, %d), (%" PRId64 " .. %" PRId64 ")\n", 
+				x1, y1, x2, y2, (int64_t)t1, (int64_t)t2);
 		} else {
 			t1 = 0;
 			t2 = render_context.event->Duration;
@@ -788,24 +747,37 @@
 		render_context.pos_y = y;
 		render_context.detect_collisions = 0;
 		render_context.evt_type = EVENT_POSITIONED;
-	} else if (mystrcmp(&p, "frx") || mystrcmp(&p, "fry")) {
+	} else if (mystrcmp(&p, "frx")) {
 		double val;
-		mystrtod(&p, &val);
-		mp_msg(MSGT_ASS, MSGL_V, "frx/fry unimplemented \n");
+		if (mystrtod(&p, &val)) {
+			val *= M_PI / 180;
+			render_context.frx = val * pwr + render_context.frx * (1-pwr);
+		} else
+			render_context.frx = 0.;
+	} else if (mystrcmp(&p, "fry")) {
+		double val;
+		if (mystrtod(&p, &val)) {
+			val *= M_PI / 180;
+			render_context.fry = val * pwr + render_context.fry * (1-pwr);
+		} else
+			render_context.fry = 0.;
 	} else if (mystrcmp(&p, "frz") || mystrcmp(&p, "fr")) {
-		double angle;
 		double val;
-		mystrtod(&p, &val);
-		mp_msg(MSGT_ASS, MSGL_DBG2, "setting rotation to %.2f\n", val * pwr);
-		angle = M_PI * val / 180;
-		render_context.rotation = angle * pwr;
+		if (mystrtod(&p, &val)) {
+			val *= M_PI / 180;
+			render_context.frz = val * pwr + render_context.frz * (1-pwr);
+		} else
+			render_context.frz = M_PI * render_context.style->Angle / 180.;
 	} else if (mystrcmp(&p, "fn")) {
 		char* start = p;
 		char* family;
 		skip_all('\\');
-		family = (char *)malloc(p - start + 1);
-		strncpy(family, start, p - start);
-		family[p - start] = '\0';
+		if (p > start) {
+			family = malloc(p - start + 1);
+			strncpy(family, start, p - start);
+			family[p - start] = '\0';
+		} else
+			family = strdup(render_context.style->FontName);
 		if (render_context.family)
 			free(render_context.family);
 		render_context.family = family;
@@ -825,17 +797,23 @@
 		}
 		// FIXME: simplify
 	} else if (mystrcmp(&p, "an")) {
-		int val = strtol(p, &p, 10);
-		int v = (val - 1) / 3; // 0, 1 or 2 for vertical alignment
-		mp_msg(MSGT_ASS, MSGL_DBG2, "an %d\n", val);
-		if (v != 0) v = 3 - v;
-		val = ((val - 1) % 3) + 1; // horizontal alignment
-		val += v*4;
-		mp_msg(MSGT_ASS, MSGL_DBG2, "align %d\n", val);
-		render_context.alignment = val;
+		int val;
+		if (mystrtoi(&p, 10, &val) && val) {
+			int v = (val - 1) / 3; // 0, 1 or 2 for vertical alignment
+			mp_msg(MSGT_ASS, MSGL_DBG2, "an %d\n", val);
+			if (v != 0) v = 3 - v;
+			val = ((val - 1) % 3) + 1; // horizontal alignment
+			val += v*4;
+			mp_msg(MSGT_ASS, MSGL_DBG2, "align %d\n", val);
+			render_context.alignment = val;
+		} else
+			render_context.alignment = render_context.style->Alignment;
 	} else if (mystrcmp(&p, "a")) {
-		int val = strtol(p, &p, 10);
-		render_context.alignment = val;
+		int val;
+		if (mystrtoi(&p, 10, &val) && val)
+			render_context.alignment = val;
+		else
+			render_context.alignment = render_context.style->Alignment;
 	} else if (mystrcmp(&p, "pos")) {
 		int v1, v2;
 		skip('(');
@@ -893,6 +871,7 @@
 		//				render_context.evt_type = EVENT_POSITIONED;
 		render_context.org_x = v1;
 		render_context.org_y = v2;
+		render_context.have_origin = 1;
 	} else if (mystrcmp(&p, "t")) {
 		double v[3];
 		int v1, v2;
@@ -923,11 +902,14 @@
 		if (v3 < 0.)
 			v3 = 0.;
 		t = frame_context.time - render_context.event->Start; // FIXME: move to render_context
-		if (t < t1)
+		if (t <= t1)
 			k = 0.;
-		else if (t > t2)
+		else if (t >= t2)
 			k = 1.;
-		else k = pow(((double)(t - t1)) / delta_t, v3);
+		else {
+			assert(delta_t != 0.);
+			k = pow(((double)(t - t1)) / delta_t, v3);
+		}
 		while (*p == '\\')
 			p = parse_tag(p, k); // maybe k*pwr ? no, specs forbid nested \t's 
 		skip_all(')'); // FIXME: better skip(')'), but much more tags support required
@@ -977,7 +959,7 @@
 		switch (cmd) {
 			case 'c': change_color(render_context.c + cidx, val, pwr); break;
 			case 'a': change_alpha(render_context.c + cidx, val >> 24, pwr); break;
-			default: mp_msg(MSGT_ASS, MSGL_WARN, "Bad command: %c%c\n", n, cmd); break;
+			default: mp_msg(MSGT_ASS, MSGL_WARN, MSGTR_LIBASS_BadCommand, n, cmd); break;
 		}
 		mp_msg(MSGT_ASS, MSGL_DBG2, "single c/a at %f: %c%c = %X   \n", pwr, n, cmd, render_context.c[cidx]);
 	} else if (mystrcmp(&p, "r")) {
@@ -990,17 +972,19 @@
 			render_context.be = 0;
 	} else if (mystrcmp(&p, "b")) {
 		int b;
-		if (mystrtoi(&p, 10, &b))
-			render_context.bold = b;
-		else
-			render_context.bold = - render_context.style->Bold;
+		if (mystrtoi(&p, 10, &b)) {
+			if (pwr >= .5)
+				render_context.bold = b;
+		} else
+			render_context.bold = render_context.style->Bold;
 		update_font();
 	} else if (mystrcmp(&p, "i")) {
 		int i;
-		if (mystrtoi(&p, 10, &i))
-			render_context.italic = i;
-		else
-			render_context.italic = - render_context.style->Italic;
+		if (mystrtoi(&p, 10, &i)) {
+			if (pwr >= .5)
+				render_context.italic = i;
+		} else
+			render_context.italic = render_context.style->Italic;
 		update_font();
 	} else if (mystrcmp(&p, "kf") || mystrcmp(&p, "K")) {
 		int val = strtol(p, &p, 10);
@@ -1161,19 +1145,19 @@
 
 	if (render_context.family)
 		free(render_context.family);
-        render_context.family=NULL;
-        
 	render_context.family = strdup(render_context.style->FontName);
-	render_context.bold = - render_context.style->Bold;
-	render_context.italic = - render_context.style->Italic;
+	render_context.bold = render_context.style->Bold;
+	render_context.italic = render_context.style->Italic;
 	update_font();
 
 	change_border(-1.);
 	render_context.scale_x = render_context.style->ScaleX;
 	render_context.scale_y = render_context.style->ScaleY;
-	render_context.hspacing = 0; // FIXME
+	render_context.hspacing = render_context.style->Spacing;
 	render_context.be = 0;
 	render_context.shadow = render_context.style->Shadow;
+	render_context.frx = render_context.fry = 0.;
+	render_context.frz = M_PI * render_context.style->Angle / 180.;
 
 	// FIXME: does not reset unsupported attributes.
 }
@@ -1189,12 +1173,12 @@
 	reset_render_context();
 
 	render_context.evt_type = EVENT_NORMAL;
-	render_context.alignment = 0;
-	render_context.rotation = M_PI * render_context.style->Angle / 180.;
+	render_context.alignment = render_context.style->Alignment;
 	render_context.pos_x = 0;
 	render_context.pos_y = 0;
 	render_context.org_x = 0;
 	render_context.org_y = 0;
+	render_context.have_origin = 0;
 	render_context.clip_x0 = 0;
 	render_context.clip_y0 = 0;
 	render_context.clip_x1 = frame_context.track->PlayResX;
@@ -1213,86 +1197,121 @@
 }
 
 /**
- * \brief Get normal and outline glyphs from cache (if possible) or font face
- * \param index face glyph index
+ * \brief Get normal and outline (border) glyphs
  * \param symbol ucs4 char
  * \param info out: struct filled with extracted data
- * \param advance advance vector of the extracted glyph
- * \return 0 on success
+ * \param advance subpixel shift vector used for cache lookup
+ * Tries to get both glyphs from cache.
+ * If they can't be found, gets a glyph from font face, generates outline with FT_Stroker,
+ * and add them to cache.
+ * The glyphs are returned in info->glyph and info->outline_glyph
  */
-int get_glyph(int index, int symbol, glyph_info_t* info, FT_Vector* advance)
+static void get_outline_glyph(int symbol, glyph_info_t* info, FT_Vector* advance)
 {
 	int error;
 	glyph_hash_val_t* val;
-	glyph_hash_key_t* key = &(info->hash_key);
-	
-	key->face = render_context.face;
-	key->size = render_context.font_size;
-	key->index = index;
-	key->outline = (render_context.border * 0xFFFF); // convert to 16.16
-	key->scale_x = (render_context.scale_x * 0xFFFF);
-	key->scale_y = (render_context.scale_y * 0xFFFF);
-	key->angle = (render_context.rotation * 0xFFFF);
-	key->advance = *advance;
-	key->bold = render_context.bold;
-	key->italic = render_context.italic;
-	key->be = render_context.be;
+	glyph_hash_key_t key;
+	key.font = render_context.font;
+	key.size = render_context.font_size;
+	key.ch = symbol;
+	key.scale_x = (render_context.scale_x * 0xFFFF);
+	key.scale_y = (render_context.scale_y * 0xFFFF);
+	key.advance = *advance;
+	key.bold = render_context.bold;
+	key.italic = render_context.italic;
+	key.outline = render_context.border * 0xFFFF;
 
-	val = cache_find_glyph(key);
-//	val = 0;
-	
+	info->glyph = info->outline_glyph = 0;
+
+	val = cache_find_glyph(&key);
 	if (val) {
-		info->glyph = info->outline_glyph = 0;
-		info->bm = val->bm;
-		info->bm_o = val->bm_o;
-		info->bm_s = val->bm_s;
+		FT_Glyph_Copy(val->glyph, &info->glyph);
+		if (val->outline_glyph)
+			FT_Glyph_Copy(val->outline_glyph, &info->outline_glyph);
 		info->bbox = val->bbox_scaled;
 		info->advance.x = val->advance.x;
 		info->advance.y = val->advance.y;
+	} else {
+		glyph_hash_val_t v;
+		info->glyph = ass_font_get_glyph(frame_context.ass_priv->fontconfig_priv, render_context.font, symbol, global_settings->hinting);
+		if (!info->glyph)
+			return;
+		info->advance.x = d16_to_d6(info->glyph->advance.x);
+		info->advance.y = d16_to_d6(info->glyph->advance.y);
+		FT_Glyph_Get_CBox( info->glyph, FT_GLYPH_BBOX_PIXELS, &info->bbox);
 
-		return 0;
+		if (render_context.stroker) {
+			info->outline_glyph = info->glyph;
+			error = FT_Glyph_StrokeBorder( &(info->outline_glyph), render_context.stroker, 0 , 0 ); // don't destroy original
+			if (error) {
+				mp_msg(MSGT_ASS, MSGL_WARN, MSGTR_LIBASS_FT_Glyph_Stroke_Error, error);
+			}
+		}
+
+		memset(&v, 0, sizeof(v));
+		FT_Glyph_Copy(info->glyph, &v.glyph);
+		if (info->outline_glyph)
+			FT_Glyph_Copy(info->outline_glyph, &v.outline_glyph);
+		v.advance = info->advance;
+		v.bbox_scaled = info->bbox;
+		cache_add_glyph(&key, &v);
 	}
+}
 
-	// not found, get a new outline glyph from face
-//	mp_msg(MSGT_ASS, MSGL_INFO, "miss, index = %d, symbol = %c, adv = (%d, %d)\n", index, symbol, advance->x, advance->y);
+static void transform_3d(FT_Vector shift, FT_Glyph* glyph, FT_Glyph* glyph2, double frx, double fry, double frz);
+
+/**
+ * \brief Get bitmaps for a glyph
+ * \param info glyph info
+ * Tries to get glyph bitmaps from bitmap cache.
+ * If they can't be found, they are generated by rotating and rendering the glyph.
+ * After that, bitmaps are added to the cache.
+ * They are returned in info->bm (glyph), info->bm_o (outline) and info->bm_s (shadow).
+ */
+static void get_bitmap_glyph(glyph_info_t* info)
+{
+	bitmap_hash_val_t* val;
+	bitmap_hash_key_t* key = &info->hash_key;
 	
-	error = FT_Load_Glyph(render_context.face, index, FT_LOAD_NO_BITMAP );
-	if (error) {
-		mp_msg(MSGT_ASS, MSGL_WARN, "Error loading glyph\n");
-		return error;
-	}
+	val = cache_find_bitmap(key);
+/* 	val = 0; */
 	
-#if (FREETYPE_MAJOR > 2) || \
-    ((FREETYPE_MAJOR == 2) && (FREETYPE_MINOR >= 2)) || \
-    ((FREETYPE_MAJOR == 2) && (FREETYPE_MINOR == 1) && (FREETYPE_PATCH >= 10))
-// FreeType >= 2.1.10 required
-	if (!(render_context.face->style_flags & FT_STYLE_FLAG_ITALIC) && 
-			((render_context.italic == 1) || (render_context.italic > 55))) {
-		FT_GlyphSlot_Oblique(render_context.face->glyph);
-	}
-#endif
-	error = FT_Get_Glyph(render_context.face->glyph, &(info->glyph));
-	if (error) {
-		mp_msg(MSGT_ASS, MSGL_WARN, "Error getting glyph\n");
-		return error;
-	}
+	if (val) {
+		info->bm = val->bm;
+		info->bm_o = val->bm_o;
+		info->bm_s = val->bm_s;
+	} else {
+		FT_Vector shift;
+		bitmap_hash_val_t hash_val;
+		int error;
+		info->bm = info->bm_o = info->bm_s = 0;
+		if (info->glyph && info->symbol != '\n' && info->symbol != 0) {
+			// calculating rotation shift vector (from rotation origin to the glyph basepoint)
+			shift.x = int_to_d6(info->hash_key.shift_x);
+			shift.y = int_to_d6(info->hash_key.shift_y);
+			// apply rotation
+			transform_3d(shift, &info->glyph, &info->outline_glyph, info->frx, info->fry, info->frz);
 
-	info->advance.x = info->glyph->advance.x >> 10;
-	info->advance.y = info->glyph->advance.y >> 10;
+			// render glyph
+			error = glyph_to_bitmap(ass_renderer->synth_priv,
+					info->glyph, info->outline_glyph,
+					&info->bm, &info->bm_o,
+					&info->bm_s, info->be);
+			if (error)
+				info->symbol = 0;
 
-	if (render_context.stroker) {
-		info->outline_glyph = info->glyph;
-		error = FT_Glyph_Stroke( &(info->outline_glyph), render_context.stroker, 0 ); // don't destroy original
-		if (error) {
-			mp_msg(MSGT_ASS, MSGL_WARN, "FT_Glyph_Stroke error %d \n", error);
+			// add bitmaps to cache
+			hash_val.bm_o = info->bm_o;
+			hash_val.bm = info->bm;
+			hash_val.bm_s = info->bm_s;
+			cache_add_bitmap(&(info->hash_key), &hash_val);
 		}
-	} else {
-		info->outline_glyph = 0;
 	}
-
-	info->bm = info->bm_o = info->bm_s = 0;
-
-	return 0;
+	// deallocate glyphs
+	if (info->glyph)
+		FT_Done_Glyph(info->glyph);
+	if (info->outline_glyph)
+		FT_Done_Glyph(info->outline_glyph);
 }
 
 /**
@@ -1304,7 +1323,7 @@
  *   lines[].asc
  *   lines[].desc
  */
-static void measure_text()
+static void measure_text(void)
 {
 	int cur_line = 0, max_asc = 0, max_desc = 0;
 	int i;
@@ -1320,9 +1339,9 @@
 		if (i < text_info.length) {
 			glyph_info_t* cur = text_info.glyphs + i;
 			if (cur->asc > max_asc)
-				max_asc = cur->asc * render_context.scale_y;
+				max_asc = cur->asc;
 			if (cur->desc > max_desc)
-				max_desc = cur->desc * render_context.scale_y;
+				max_desc = cur->desc;
 		}
 	}
 }
@@ -1396,6 +1415,11 @@
 		
 		if (cur->symbol == ' ')
 			last_space = i;
+
+		// make sure the hard linebreak is not forgotten when
+		// there was a new soft linebreak just inserted
+		if (cur->symbol == '\n' && break_type == 1)
+			i--;
 	}
 #define DIFF(x,y) (((x) < (y)) ? (y - x) : (x - y))
 	exit = 0;
@@ -1450,7 +1474,7 @@
 			int height = text_info.lines[cur_line - 1].desc + text_info.lines[cur_line].asc;
 			cur_line ++;
 			pen_shift_x = - cur->pos.x;
-			pen_shift_y += (height >> 6) + global_settings->line_spacing;
+			pen_shift_y += d6_to_int(height) + global_settings->line_spacing;
 			mp_msg(MSGT_ASS, MSGL_DBG2, "shifting from %d to %d by (%d, %d)\n", i, text_info.length - 1, pen_shift_x, pen_shift_y);
 		}
 		cur->pos.x += pen_shift_x;
@@ -1512,7 +1536,7 @@
 					dt /= (tm_end - tm_start);
 					x = x_start + (x_end - x_start) * dt;
 				} else {
-					mp_msg(MSGT_ASS, MSGL_ERR, "Unknown effect type (internal error)  \n");
+					mp_msg(MSGT_ASS, MSGL_ERR, MSGTR_LIBASS_UnknownEffectType_InternalError);
 					continue;
 				}
 
@@ -1525,26 +1549,6 @@
 	}
 }
 
-static int get_face_ascender(FT_Face face)
-{
-	int v = face->size->metrics.ascender;
-	int v2 = FT_MulFix(face->bbox.yMax, face->size->metrics.y_scale);
-	if (v > v2 * 0.9)
-		return v;
-	else
-		return v2;
-}
-
-static int get_face_descender(FT_Face face)
-{
-	int v = - face->size->metrics.descender;
-	int v2 = - FT_MulFix(face->bbox.yMin, face->size->metrics.y_scale);
-	if (v > v2 * 0.9)
-		return v;
-	else
-		return v2;
-}
-
 /**
  * \brief Calculate base point for positioning and rotation
  * \param bbox text bbox
@@ -1582,19 +1586,121 @@
 }
 
 /**
+ * \brief Multiply 4-vector by 4-matrix
+ * \param a 4-vector
+ * \param m 4-matrix]
+ * \param b out: 4-vector
+ * Calculates a * m and stores result in b
+ */
+static inline void transform_point_3d(double *a, double *m, double *b)
+{
+	b[0] = a[0] * m[0] + a[1] * m[4] + a[2] * m[8] +  a[3] * m[12];
+	b[1] = a[0] * m[1] + a[1] * m[5] + a[2] * m[9] +  a[3] * m[13];
+	b[2] = a[0] * m[2] + a[1] * m[6] + a[2] * m[10] + a[3] * m[14];
+	b[3] = a[0] * m[3] + a[1] * m[7] + a[2] * m[11] + a[3] * m[15];
+}
+
+/**
+ * \brief Apply 3d transformation to a vector
+ * \param v FreeType vector (2d)
+ * \param m 4-matrix
+ * Transforms v by m, projects the result back to the screen plane
+ * Result is returned in v.
+ */
+static inline void transform_vector_3d(FT_Vector* v, double *m) {
+	const double camera = 2500 * frame_context.border_scale; // camera distance
+	double a[4], b[4];
+	a[0] = d6_to_double(v->x);
+	a[1] = d6_to_double(v->y);
+	a[2] = 0.;
+	a[3] = 1.;
+	transform_point_3d(a, m, b);
+	/* Apply perspective projection with the following matrix:
+	   2500     0     0     0
+	      0  2500     0     0
+	      0     0     0     0
+	      0     0     8     2500
+	   where 2500 is camera distance, 8 - z-axis scale.
+	   Camera is always located in (org_x, org_y, -2500). This means
+	   that different subtitle events can be displayed at the same time
+	   using different cameras. */
+	b[0] *= camera;
+	b[1] *= camera;
+	b[3] = 8 * b[2] + camera;
+	if (b[3] < 0.001 && b[3] > -0.001)
+		b[3] = b[3] < 0. ? -0.001 : 0.001;
+	v->x = double_to_d6(b[0] / b[3]);
+	v->y = double_to_d6(b[1] / b[3]);
+}
+
+/**
+ * \brief Apply 3d transformation to a glyph
+ * \param glyph FreeType glyph
+ * \param m 4-matrix
+ * Transforms glyph by m, projects the result back to the screen plane
+ * Result is returned in glyph.
+ */
+static inline void transform_glyph_3d(FT_Glyph glyph, double *m, FT_Vector shift) {
+	int i;
+	FT_Outline* outline = &((FT_OutlineGlyph)glyph)->outline;
+	FT_Vector* p = outline->points;
+
+	for (i=0; i<outline->n_points; i++) {
+		p[i].x += shift.x;
+		p[i].y += shift.y;
+		transform_vector_3d(p + i, m);
+		p[i].x -= shift.x;
+		p[i].y -= shift.y;
+	}
+
+	//transform_vector_3d(&glyph->advance, m);
+}
+
+/**
+ * \brief Apply 3d transformation to several objects
+ * \param shift FreeType vector
+ * \param glyph FreeType glyph
+ * \param glyph2 FreeType glyph
+ * \param frx x-axis rotation angle
+ * \param fry y-axis rotation angle
+ * \param frz z-axis rotation angle
+ * Rotates both glyphs by frx, fry and frz. Shift vector is added before rotation and subtracted after it.
+ */
+static void transform_3d(FT_Vector shift, FT_Glyph* glyph, FT_Glyph* glyph2, double frx, double fry, double frz)
+{
+	fry = - fry; // FreeType's y axis goes in the opposite direction
+	if (frx != 0. || fry != 0. || frz != 0.) {
+		double m[16];
+		double sx = sin(frx);
+		double sy = sin(fry);
+ 		double sz = sin(frz);
+		double cx = cos(frx);
+		double cy = cos(fry);
+		double cz = cos(frz);
+		m[0] = cy * cz;            m[1] = cy*sz;              m[2]  = -sy;    m[3] = 0.0;
+		m[4] = -cx*sz + sx*sy*cz;  m[5] = cx*cz + sx*sy*sz;   m[6]  = sx*cy;  m[7] = 0.0;
+		m[8] = sx*sz + cx*sy*cz;   m[9] = -sx*cz + cx*sy*sz;  m[10] = cx*cy;  m[11] = 0.0;
+		m[12] = 0.0;               m[13] = 0.0;               m[14] = 0.0;    m[15] = 1.0;
+
+		if (glyph && *glyph)
+			transform_glyph_3d(*glyph, m, shift);
+
+		if (glyph2 && *glyph2)
+			transform_glyph_3d(*glyph2, m, shift);
+	}
+}
+
+/**
  * \brief Main ass rendering function, glues everything together
  * \param event event to render
  * Process event, appending resulting ass_image_t's to images_root.
  */
-int ass_render_event(ass_event_t* event, event_images_t* event_images)
+static int ass_render_event(ass_event_t* event, event_images_t* event_images)
 {
 	char* p;
-	FT_UInt glyph_index; 
-	FT_Bool use_kerning; 
 	FT_UInt previous; 
 	FT_UInt num_glyphs;
 	FT_Vector pen;
-	int error;
 	unsigned code;
 	FT_BBox bbox;
 	int i, j;
@@ -1605,11 +1711,11 @@
 	int device_x = 0, device_y = 0;
 
 	if (event->Style >= frame_context.track->n_styles) {
-		mp_msg(MSGT_ASS, MSGL_WARN, "No style found!\n");
+		mp_msg(MSGT_ASS, MSGL_WARN, MSGTR_LIBASS_NoStyleFound);
 		return 1;
 	}
 	if (!event->Text) {
-		mp_msg(MSGT_ASS, MSGL_WARN, "Empty event!\n");
+		mp_msg(MSGT_ASS, MSGL_WARN, MSGTR_LIBASS_EmptyEvent);
 		return 1;
 	}
 
@@ -1628,7 +1734,7 @@
 		code = get_next_char(&p);
 		
 		// face could have been changed in get_next_char
-		if (!render_context.face) {
+		if (!render_context.font) {
 			free_render_context();
 			return 1;
 		}
@@ -1636,19 +1742,15 @@
 		if (code == 0)
 			break;
 
-		use_kerning = FT_HAS_KERNING(render_context.face);
-
 		if (text_info.length >= MAX_GLYPHS) {
-			mp_msg(MSGT_ASS, MSGL_WARN, "\nMAX_GLYPHS reached: event %d, start = %llu, duration = %llu\n Text = %s\n", 
+			mp_msg(MSGT_ASS, MSGL_WARN, MSGTR_LIBASS_MAX_GLYPHS_Reached, 
 					(int)(event - frame_context.track->events), event->Start, event->Duration, event->Text);
 			break;
 		}
 
-		glyph_index = FT_Get_Char_Index( render_context.face, code);
-
-		if ( use_kerning && previous && glyph_index ) {
+		if ( previous && code ) {
 			FT_Vector delta;
-			FT_Get_Kerning( render_context.face, previous, glyph_index, FT_KERNING_DEFAULT, &delta );
+			delta = ass_font_get_kerning(render_context.font, previous, code);
 			pen.x += delta.x * render_context.scale_x;
 			pen.y += delta.y * render_context.scale_y;
 		}
@@ -1656,40 +1758,22 @@
 		shift.x = pen.x & 63;
 		shift.y = pen.y & 63;
 
-		if ((render_context.scale_x != 1.) || (render_context.scale_y != 1.) ||
-				(frame_context.font_scale_x != 1.)) {
-			FT_Matrix matrix;
-			matrix.xx = (FT_Fixed)( render_context.scale_x * frame_context.font_scale_x * 0x10000L );
-			matrix.xy = (FT_Fixed)( 0 * 0x10000L );
-			matrix.yx = (FT_Fixed)( 0 * 0x10000L );
-			matrix.yy = (FT_Fixed)( render_context.scale_y * 0x10000L );
+		ass_font_set_transform(render_context.font,
+				       render_context.scale_x * frame_context.font_scale_x,
+				       render_context.scale_y,
+				       &shift );
 
-			FT_Set_Transform( render_context.face, &matrix, &shift );
-		} else {
-			FT_Set_Transform(render_context.face, 0, &shift);
-		}
+		get_outline_glyph(code, text_info.glyphs + text_info.length, &shift);
 		
-		error = get_glyph(glyph_index, code, text_info.glyphs + text_info.length, &shift);
-
-		if (error) {
-			continue;
-		}
-		
 		text_info.glyphs[text_info.length].pos.x = pen.x >> 6;
 		text_info.glyphs[text_info.length].pos.y = pen.y >> 6;
 		
 		pen.x += text_info.glyphs[text_info.length].advance.x;
-		pen.x += render_context.hspacing;
+		pen.x += double_to_d6(render_context.hspacing);
 		pen.y += text_info.glyphs[text_info.length].advance.y;
 		
-		// if it's an outline glyph, we still need to fill the bbox
-		if (text_info.glyphs[text_info.length].glyph) {
-			FT_Glyph_Get_CBox( text_info.glyphs[text_info.length].glyph, FT_GLYPH_BBOX_PIXELS, &(text_info.glyphs[text_info.length].bbox) );
-		}
+		previous = code;
 
-		
-		previous = glyph_index;
-		
 		text_info.glyphs[text_info.length].symbol = code;
 		text_info.glyphs[text_info.length].linebreak = 0;
 		for (i = 0; i < 4; ++i) {
@@ -1700,12 +1784,32 @@
 		text_info.glyphs[text_info.length].effect_type = render_context.effect_type;
 		text_info.glyphs[text_info.length].effect_timing = render_context.effect_timing;
 		text_info.glyphs[text_info.length].effect_skip_timing = render_context.effect_skip_timing;
-		text_info.glyphs[text_info.length].asc = get_face_ascender(render_context.face);
-		text_info.glyphs[text_info.length].desc = get_face_descender(render_context.face);
 		text_info.glyphs[text_info.length].be = render_context.be;
 		text_info.glyphs[text_info.length].shadow = render_context.shadow;
-		text_info.glyphs[text_info.length].frz = render_context.rotation;
+		text_info.glyphs[text_info.length].frx = render_context.frx;
+		text_info.glyphs[text_info.length].fry = render_context.fry;
+		text_info.glyphs[text_info.length].frz = render_context.frz;
+		ass_font_get_asc_desc(render_context.font, code,
+				      &text_info.glyphs[text_info.length].asc,
+				      &text_info.glyphs[text_info.length].desc);
+		text_info.glyphs[text_info.length].asc *= render_context.scale_y;
+		text_info.glyphs[text_info.length].desc *= render_context.scale_y;
 
+		// fill bitmap_hash_key
+		text_info.glyphs[text_info.length].hash_key.font = render_context.font;
+		text_info.glyphs[text_info.length].hash_key.size = render_context.font_size;
+		text_info.glyphs[text_info.length].hash_key.outline = render_context.border * 0xFFFF;
+		text_info.glyphs[text_info.length].hash_key.scale_x = render_context.scale_x * 0xFFFF;
+		text_info.glyphs[text_info.length].hash_key.scale_y = render_context.scale_y * 0xFFFF;
+		text_info.glyphs[text_info.length].hash_key.frx = render_context.frx * 0xFFFF;
+		text_info.glyphs[text_info.length].hash_key.fry = render_context.fry * 0xFFFF;
+		text_info.glyphs[text_info.length].hash_key.frz = render_context.frz * 0xFFFF;
+		text_info.glyphs[text_info.length].hash_key.bold = render_context.bold;
+		text_info.glyphs[text_info.length].hash_key.italic = render_context.italic;
+		text_info.glyphs[text_info.length].hash_key.ch = code;
+		text_info.glyphs[text_info.length].hash_key.advance = shift;
+		text_info.glyphs[text_info.length].hash_key.be = render_context.be;
+
 		text_info.length++;
 
 		render_context.effect_type = EF_NONE;
@@ -1724,8 +1828,6 @@
 	
 	// alignments
 	alignment = render_context.alignment;
-	if (!alignment)
-		alignment = render_context.style->Alignment;
 	halign = alignment & 3;
 	valign = alignment & 12;
 
@@ -1746,16 +1848,16 @@
 		last_break = -1;
 		for (i = 1; i < text_info.length + 1; ++i) { // (text_info.length + 1) is the end of the last line
 			if ((i == text_info.length) || text_info.glyphs[i].linebreak) {
-				int width, shift;
+				int width, shift = 0;
 				glyph_info_t* first_glyph = text_info.glyphs + last_break + 1;
 				glyph_info_t* last_glyph = text_info.glyphs + i - 1;
 
 				while ((last_glyph > first_glyph) && ((last_glyph->symbol == '\n') || (last_glyph->symbol == 0)))
 					last_glyph --;
 
-				width = last_glyph->pos.x + last_glyph->bbox.xMax - first_glyph->pos.x - first_glyph->bbox.xMin;
-				shift = - first_glyph->bbox.xMin; // now text line starts exactly at 0 (left margin)
+				width = last_glyph->pos.x + d6_to_int(last_glyph->advance.x) - first_glyph->pos.x;
 				if (halign == HALIGN_LEFT) { // left aligned, no action
+					shift = 0;
 				} else if (halign == HALIGN_RIGHT) { // right aligned
 					shift = max_text_width - width;
 				} else if (halign == HALIGN_CENTER) { // centered
@@ -1791,7 +1893,7 @@
 	if (render_context.evt_type == EVENT_NORMAL ||
 	    render_context.evt_type == EVENT_HSCROLL) {
 		if (valign == VALIGN_TOP) { // toptitle
-			device_y = y2scr_top(MarginV) + (text_info.lines[0].asc >> 6);
+			device_y = y2scr_top(MarginV) + d6_to_int(text_info.lines[0].asc);
 		} else if (valign == VALIGN_CENTER) { // midtitle
 			int scr_y = y2scr(frame_context.track->PlayResY / 2);
 			device_y = scr_y - (bbox.yMax - bbox.yMin) / 2;
@@ -1801,8 +1903,8 @@
 				mp_msg(MSGT_ASS, MSGL_V, "Invalid valign, supposing 0 (subtitle)\n");
 			scr_y = y2scr_sub(frame_context.track->PlayResY - MarginV);
 			device_y = scr_y;
-			device_y -= (text_info.height >> 6);
-			device_y += (text_info.lines[0].asc >> 6);
+			device_y -= d6_to_int(text_info.height);
+			device_y += d6_to_int(text_info.lines[0].asc);
 		}
 	} else if (render_context.evt_type == EVENT_VSCROLL) {
 		if (render_context.scroll_direction == SCROLL_TB)
@@ -1842,15 +1944,13 @@
 		render_context.clip_y1 = y2scr(render_context.clip_y1);
 	}
 
-	// rotate glyphs if needed
+	// calculate rotation parameters
 	{
-		double angle = 0.;
 		FT_Vector center;
-		FT_Matrix matrix_rotate;
 		
-		if (((render_context.org_x != 0) || (render_context.org_y != 0)) && (render_context.evt_type == EVENT_POSITIONED)) {
-			center.x = render_context.org_x;
-			center.y = render_context.org_y;
+		if (render_context.have_origin) {
+			center.x = x2scr(render_context.org_x);
+			center.y = y2scr(render_context.org_y);
 		} else {
 			int bx, by;
 			get_base_point(bbox, alignment, &bx, &by);
@@ -1859,45 +1959,24 @@
 		}
 
 		for (i = 0; i < text_info.length; ++i) {
-			FT_Vector start;
-			FT_Vector start_old;
 			glyph_info_t* info = text_info.glyphs + i;
 
-			if (info->frz < 0.00001 && info->frz > -0.00001)
-				continue;
-			
-			if (info->frz != angle) {
-				angle = info->frz;
-				matrix_rotate.xx = (FT_Fixed)( cos( angle ) * 0x10000L );
-				matrix_rotate.xy = (FT_Fixed)( -sin( angle ) * 0x10000L );
-				matrix_rotate.yx = (FT_Fixed)( sin( angle ) * 0x10000L );
-				matrix_rotate.yy = (FT_Fixed)( cos( angle ) * 0x10000L );
+			if (info->hash_key.frx || info->hash_key.fry || info->hash_key.frz) {
+				info->hash_key.shift_x = info->pos.x + device_x - center.x;
+				info->hash_key.shift_y = - (info->pos.y + device_y - center.y);
+			} else {
+				info->hash_key.shift_x = 0;
+				info->hash_key.shift_y = 0;
 			}
-
-			// calculating shift vector
-			// shift = (position - center)*M - (position - center)
-			start.x = (info->pos.x + device_x - center.x) << 6;
-			start.y = - (info->pos.y + device_y - center.y) << 6;
-			start_old.x = start.x;
-			start_old.y = start.y;
-
-			FT_Vector_Transform(&start, &matrix_rotate);
-			
-			start.x -= start_old.x;
-			start.y -= start_old.y;
-
-			info->pos.x += start.x >> 6;
-			info->pos.y -= start.y >> 6;
-
-			if (info->glyph)
-				FT_Glyph_Transform( info->glyph, &matrix_rotate, 0 );
-			if (info->outline_glyph)
-				FT_Glyph_Transform( info->outline_glyph, &matrix_rotate, 0 );
 		}
 	}
 
-	event_images->top = device_y - (text_info.lines[0].asc >> 6);
-	event_images->height = text_info.height >> 6;
+	// convert glyphs to bitmaps
+	for (i = 0; i < text_info.length; ++i)
+		get_bitmap_glyph(text_info.glyphs + i);
+
+	event_images->top = device_y - d6_to_int(text_info.lines[0].asc);
+	event_images->height = d6_to_int(text_info.height);
 	event_images->detect_collisions = render_context.detect_collisions;
 	event_images->shift_direction = (valign == VALIGN_TOP) ? 1 : -1;
 	event_images->event = event;
@@ -1908,10 +1987,26 @@
 	return 0;
 }
 
+/**
+ * \brief deallocate image list
+ * \param img list pointer
+ */
+void ass_free_images(ass_image_t* img)
+{
+	while (img) {
+		ass_image_t* next = img->next;
+		free(img);
+		img = next;
+	}
+}
+
 static void ass_reconfigure(ass_renderer_t* priv)
 {
 	priv->render_id = ++last_render_id;
 	ass_glyph_cache_reset();
+	ass_bitmap_cache_reset();
+	ass_free_images(priv->prev_images_root);
+	priv->prev_images_root = 0;
 }
 
 void ass_set_frame_size(ass_renderer_t* priv, int w, int h)
@@ -1960,6 +2055,14 @@
 	}
 }
 
+void ass_set_hinting(ass_renderer_t* priv, ass_hinting_t ht)
+{
+	if (priv->settings.hinting != ht) {
+		priv->settings.hinting = ht;
+		ass_reconfigure(priv);
+	}
+}
+
 int ass_set_fonts(ass_renderer_t* priv, const char* default_font, const char* default_family)
 {
 	if (priv->settings.default_font)
@@ -1972,7 +2075,7 @@
 
 	if (priv->fontconfig_priv)
 		fontconfig_done(priv->fontconfig_priv);
-	priv->fontconfig_priv = fontconfig_init(priv->library->fonts_dir, default_family, default_font);
+	priv->fontconfig_priv = fontconfig_init(priv->library, priv->ftlibrary, default_family, default_font);
 
 	return !!priv->fontconfig_priv;
 }
@@ -1982,8 +2085,6 @@
  */
 static int ass_start_frame(ass_renderer_t *priv, ass_track_t* track, long long now)
 {
-	ass_image_t* img;
-
 	ass_renderer = priv;
 	global_settings = &priv->settings;
 
@@ -2000,7 +2101,7 @@
 
 	ass_lazy_track_init();
 	
-	frame_context.font_scale = global_settings->font_size_coeff * ass_internal_font_size_coeff *
+	frame_context.font_scale = global_settings->font_size_coeff *
 	                           frame_context.orig_height / frame_context.track->PlayResY;
 	frame_context.border_scale = ((double)frame_context.orig_height) / frame_context.track->PlayResY;
 
@@ -2009,12 +2110,7 @@
 	else
 		frame_context.font_scale_x = ((double)(frame_context.orig_width * track->PlayResY)) / (frame_context.orig_height * track->PlayResX);
 
-	img = priv->images_root;
-	while (img) {
-		ass_image_t* next = img->next;
-		free(img);
-		img = next;
-	}
+	priv->prev_images_root = priv->images_root;
 	priv->images_root = 0;
 
 	return 0;
@@ -2028,10 +2124,6 @@
 		return -1;
 	if (e1->Layer > e2->Layer)
 		return 1;
-	if (e1->Start < e2->Start)
-		return -1;
-	if (e1->Start > e2->Start)
-		return 1;
 	if (e1->ReadOrder < e2->ReadOrder)
 		return -1;
 	if (e1->ReadOrder > e2->ReadOrder)
@@ -2044,7 +2136,7 @@
 static render_priv_t* get_render_priv(ass_event_t* event)
 {
 	if (!event->render_priv)
-		event->render_priv = (render_priv_t*)calloc(1, sizeof(render_priv_t));
+		event->render_priv = calloc(1, sizeof(render_priv_t));
 	// FIXME: check render_id
 	if (ass_renderer->render_id != event->render_priv->render_id) {
 		memset(event->render_priv, 0, sizeof(render_priv_t));
@@ -2099,37 +2191,27 @@
 static int fit_segment(segment_t* s, segment_t* fixed, int* cnt, int dir)
 {
 	int i;
-	int shift;
+	int shift = 0;
 
-	if (*cnt == 0) {
-		*cnt = 1;
-		fixed[0].a = s->a;
-		fixed[0].b = s->b;
-		return 0;
-	}
-
-	if (dir == 1) { // move down
-		if (s->b <= fixed[0].a) // all ok
-			return 0;
+	if (dir == 1) // move down
 		for (i = 0; i < *cnt; ++i) {
+			if (s->b + shift <= fixed[i].a || s->a + shift >= fixed[i].b)
+				continue;
 			shift = fixed[i].b - s->a;
-			if (i == *cnt - 1 || fixed[i+1].a >= shift + s->b) { // here is a good place
-				fixed[i].b += s->b - s->a;
-				return shift;
-			}
 		}
-	} else { // dir == -1, move up
-		if (s->a >= fixed[*cnt-1].b) // all ok
-			return 0;
+	else // dir == -1, move up
 		for (i = *cnt-1; i >= 0; --i) {
+			if (s->b + shift <= fixed[i].a || s->a + shift >= fixed[i].b)
+				continue;
 			shift = fixed[i].a - s->b;
-			if (i == 0 || fixed[i-1].b <= shift + s->a) { // here is a good place
-				fixed[i].a -= s->b - s->a;
-				return shift;
-			}
 		}
-	}
-	assert(0); // unreachable
+
+	fixed[*cnt].a = s->a + shift;
+	fixed[*cnt].b = s->b + shift;
+	(*cnt)++;
+	qsort(fixed, *cnt, sizeof(segment_t), cmp_segment);
+	
+	return shift;
 }
 
 static void fix_collisions(event_images_t* imgs, int cnt)
@@ -2148,7 +2230,7 @@
 			s.a = priv->top;
 			s.b = priv->top + priv->height;
 			if (priv->height != imgs[i].height) { // no, it's not
-				mp_msg(MSGT_ASS, MSGL_WARN, "Achtung! Event height has changed!  \n");
+				mp_msg(MSGT_ASS, MSGL_WARN, MSGTR_LIBASS_EventHeightHasChanged);
 				priv->top = 0;
 				priv->height = 0;
 			}
@@ -2188,15 +2270,72 @@
 }
 
 /**
+ * \brief compare two images
+ * \param i1 first image
+ * \param i2 second image
+ * \return 0 if identical, 1 if different positions, 2 if different content
+ */
+int ass_image_compare(ass_image_t *i1, ass_image_t *i2)
+{
+	if (i1->w != i2->w) return 2;
+	if (i1->h != i2->h) return 2;
+	if (i1->stride != i2->stride) return 2;
+	if (i1->color != i2->color) return 2;
+	if (i1->bitmap != i2->bitmap)
+		return 2;
+	if (i1->dst_x != i2->dst_x) return 1;
+	if (i1->dst_y != i2->dst_y) return 1;
+	return 0;
+}
+
+/**
+ * \brief compare current and previous image list
+ * \param priv library handle
+ * \return 0 if identical, 1 if different positions, 2 if different content
+ */
+int ass_detect_change(ass_renderer_t *priv)
+{
+	ass_image_t* img, *img2;
+	int diff;
+
+	img = priv->prev_images_root;
+	img2 = priv->images_root;
+	diff = 0;
+	while (img && diff < 2) {
+		ass_image_t* next, *next2;
+		next = img->next;
+		if (img2) {
+			int d = ass_image_compare(img, img2);
+			if (d > diff) diff = d;
+			next2 = img2->next;
+		} else {
+			// previous list is shorter
+			diff = 2;
+			break;
+		}
+		img = next;
+		img2 = next2;
+	}
+
+	// is the previous list longer?
+	if (img2)
+		diff = 2;
+
+	return diff;
+}
+
+/**
  * \brief render a frame
  * \param priv library handle
  * \param track track
  * \param now current video timestamp (ms)
+ * \param detect_change a value describing how the new images differ from the previous ones will be written here:
+ *        0 if identical, 1 if different positions, 2 if different content.
+ *        Can be NULL, in that case no detection is performed.
  */
-ass_image_t* ass_render_frame(ass_renderer_t *priv, ass_track_t* track, long long now)
+ass_image_t* ass_render_frame(ass_renderer_t *priv, ass_track_t* track, long long now, int* detect_change)
 {
 	int i, cnt, rc;
-	event_images_t eimg[MAX_EVENTS];
 	event_images_t* last;
 	ass_image_t** tail;
 	
@@ -2210,40 +2349,46 @@
 	for (i = 0; i < track->n_events; ++i) {
 		ass_event_t* event = track->events + i;
 		if ( (event->Start <= now) && (now < (event->Start + event->Duration)) ) {
-			if (cnt < MAX_EVENTS) {
-				rc = ass_render_event(event, eimg + cnt);
-				if (!rc) ++cnt;
-			} else {
-				mp_msg(MSGT_ASS, MSGL_WARN, "Too many simultaneous events  \n");
-				break;
+			if (cnt >= priv->eimg_size) {
+				priv->eimg_size += 100;
+				priv->eimg = realloc(priv->eimg, priv->eimg_size * sizeof(event_images_t));
 			}
+			rc = ass_render_event(event, priv->eimg + cnt);
+			if (!rc) ++cnt;
 		}
 	}
 
 	// sort by layer
-	qsort(eimg, cnt, sizeof(event_images_t), cmp_event_layer);
+	qsort(priv->eimg, cnt, sizeof(event_images_t), cmp_event_layer);
 
 	// call fix_collisions for each group of events with the same layer
-	last = eimg;
+	last = priv->eimg;
 	for (i = 1; i < cnt; ++i)
-		if (last->event->Layer != eimg[i].event->Layer) {
-			fix_collisions(last, eimg + i - last);
-			last = eimg + i;
+		if (last->event->Layer != priv->eimg[i].event->Layer) {
+			fix_collisions(last, priv->eimg + i - last);
+			last = priv->eimg + i;
 		}
 	if (cnt > 0)
-		fix_collisions(last, eimg + cnt - last);
+		fix_collisions(last, priv->eimg + cnt - last);
 
 	// concat lists
 	tail = &ass_renderer->images_root;
 	for (i = 0; i < cnt; ++i) {
-		ass_image_t* cur = eimg[i].imgs;
+		ass_image_t* cur = priv->eimg[i].imgs;
 		while (cur) {
 			*tail = cur;
 			tail = &cur->next;
 			cur = cur->next;
 		}
 	}
+
+	if (detect_change)
+		*detect_change = ass_detect_change(priv);
 	
+	// free the previous image list
+	ass_free_images(priv->prev_images_root);
+	priv->prev_images_root = 0;
+
 	return ass_renderer->images_root;
 }
 

Modified: branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_libass/ass_types.h
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_libass/ass_types.h	2007-07-13 17:01:23 UTC (rev 3361)
+++ branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_libass/ass_types.h	2007-07-14 08:27:37 UTC (rev 3362)
@@ -32,7 +32,7 @@
 typedef struct ass_style_s {
 	char* Name;
 	char* FontName;
-	int FontSize;
+	double FontSize;
 	uint32_t PrimaryColour;
 	uint32_t SecondaryColour;
 	uint32_t OutlineColour;
@@ -43,7 +43,7 @@
 	int StrikeOut;
 	double ScaleX;
 	double ScaleY;
-	int Spacing;
+	double Spacing;
 	int Angle;
 	int BorderStyle;
 	double Outline;
@@ -80,14 +80,7 @@
 typedef struct parser_priv_s parser_priv_t;
 
 typedef struct ass_library_s ass_library_t;
-/* MEANX */
-typedef enum 
-{
-    TRACK_TYPE_UNKNOWN = 0, 
-    TRACK_TYPE_ASS, 
-    TRACK_TYPE_SSA
-    }TRACK_TYPE;
-    /* MEANX */
+
 /// ass track represent either an external script or a matroska subtitle stream (no real difference between them)
 /// it can be used in rendering after the headers are parsed (i.e. events format line read)
 typedef struct ass_track_s {
@@ -100,8 +93,8 @@
 
 	char* style_format; // style format line (everything after "Format: ")
 	char* event_format; // event format line
- 
-	TRACK_TYPE track_type; /* MEANX */
+
+	enum {TRACK_TYPE_UNKNOWN = 0, TRACK_TYPE_ASS, TRACK_TYPE_SSA} track_type;
 	
 	// script header fields
 	int PlayResX;

Modified: branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_libass/ass_utils.c
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_libass/ass_utils.c	2007-07-13 17:01:23 UTC (rev 3361)
+++ branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_libass/ass_utils.c	2007-07-14 08:27:37 UTC (rev 3362)
@@ -19,19 +19,13 @@
 */
 
 #include "config.h"
-#include <stdio.h>
+
 #include <stdlib.h>
 #include <inttypes.h>
-#include <sys/time.h>
-#include <time.h>
 
 #include "mputils.h"
 #include "ass_utils.h"
 
-#define ADM_LEGACY_PROGGY
-#include "ADM_assert.h"
-
-
 int mystrtoi(char** p, int base, int* res)
 {
 	char* start = *p;

Modified: branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_libass/ass_utils.h
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_libass/ass_utils.h	2007-07-13 17:01:23 UTC (rev 3361)
+++ branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_libass/ass_utils.h	2007-07-14 08:27:37 UTC (rev 3362)
@@ -25,5 +25,37 @@
 int mystrtou32(char** p, int base, uint32_t* res);
 int mystrtod(char** p, double* res);
 int strtocolor(char** q, uint32_t* res);
+
+static inline int d6_to_int(int x) {
+	return (x + 32) >> 6;
+}
+static inline int d16_to_int(int x) {
+	return (x + 32768) >> 16;
+}
+static inline int int_to_d6(int x) {
+	return x << 6;
+}
+static inline int int_to_d16(int x) {
+	return x << 16;
+}
+static inline int d16_to_d6(int x) {
+	return (x + 512) >> 10;
+}
+static inline int d6_to_d16(int x) {
+	return x << 10;
+}
+static inline double d6_to_double(int x) {
+	return x / 64.;
+}
+static inline int double_to_d6(double x) {
+	return (int)(x * 64);
+}
+static inline double d16_to_double(int x) {
+	return ((double)x) / 0x10000;
+}
+static inline int double_to_d16(double x) {
+	return (int)(x * 0x10000);
+}
+
 #endif
 

Added: branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_libass/help_mp.h
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_libass/help_mp.h	2007-07-13 17:01:23 UTC (rev 3361)
+++ branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_libass/help_mp.h	2007-07-14 08:27:37 UTC (rev 3362)
@@ -0,0 +1,55 @@
+#ifndef __LIBASS_HELP_MP_H__
+#define __LIBASS_HELP_MP_H__
+#define MSGTR_LIBASS_FT_Glyph_To_BitmapError "[ass] FT_Glyph_To_Bitmap error %d \n"
+#define MSGTR_LIBASS_UnsupportedPixelMode "[ass] Unsupported pixel mode: %d\n"
+#define MSGTR_LIBASS_NoStyleNamedXFoundUsingY "[ass] [%p] Warning: no style named '%s' found, using '%s'\n"
+#define MSGTR_LIBASS_BadTimestamp "[ass] bad timestamp\n"
+#define MSGTR_LIBASS_BadEncodedDataSize "[ass] bad encoded data size\n"
+#define MSGTR_LIBASS_FontLineTooLong "[ass] Font line too long: %d, %s\n"
+#define MSGTR_LIBASS_EventFormatHeaderMissing "[ass] Event format header missing\n"
+#define MSGTR_LIBASS_ErrorOpeningIconvDescriptor "[ass] error opening iconv descriptor.\n"
+#define MSGTR_LIBASS_ErrorRecodingFile "[ass] error recoding file.\n"
+#define MSGTR_LIBASS_FopenFailed "[ass] ass_read_file(%s): fopen failed\n"
+#define MSGTR_LIBASS_FseekFailed "[ass] ass_read_file(%s): fseek failed\n"
+#define MSGTR_LIBASS_RefusingToLoadSubtitlesLargerThan10M "[ass] ass_read_file(%s): Refusing to load subtitles larger than 10M\n"
+#define MSGTR_LIBASS_ReadFailed "Read failed, %d: %s\n"
+#define MSGTR_LIBASS_AddedSubtitleFileMemory "[ass] Added subtitle file: <memory> (%d styles, %d events)\n"
+#define MSGTR_LIBASS_AddedSubtitleFileFname "[ass] Added subtitle file: %s (%d styles, %d events)\n"
+#define MSGTR_LIBASS_FailedToCreateDirectory "[ass] Failed to create directory %s\n"
+#define MSGTR_LIBASS_NotADirectory "[ass] Not a directory: %s\n"
+#define MSGTR_LIBASS_TooManyFonts "[ass] Too many fonts\n"
+#define MSGTR_LIBASS_ErrorOpeningFont "[ass] Error opening font: %s, %d\n"
+#define MSGTR_LIBASS_SelectedFontFamilyIsNotTheRequestedOne "[ass] fontconfig: Selected font family is not the requested one: '%s' != '%s'\n"
+#define MSGTR_LIBASS_UsingDefaultFontFamily "[ass] fontconfig_select: Using default font family: (%s, %d, %d) -> %s, %d\n"
+#define MSGTR_LIBASS_UsingDefaultFont "[ass] fontconfig_select: Using default font: (%s, %d, %d) -> %s, %d\n"
+#define MSGTR_LIBASS_UsingArialFontFamily "[ass] fontconfig_select: Using 'Arial' font family: (%s, %d, %d) -> %s, %d\n"
+#define MSGTR_LIBASS_FcInitLoadConfigAndFontsFailed "[ass] FcInitLoadConfigAndFonts failed.\n"
+#define MSGTR_LIBASS_UpdatingFontCache "[ass] Updating font cache.\n"
+#define MSGTR_LIBASS_BetaVersionsOfFontconfigAreNotSupported "[ass] Beta versions of fontconfig are not supported.\n[ass] Update before reporting any bugs.\n"
+#define MSGTR_LIBASS_FcStrSetAddFailed "[ass] FcStrSetAdd failed.\n"
+#define MSGTR_LIBASS_FcDirScanFailed "[ass] FcDirScan failed.\n"
+#define MSGTR_LIBASS_FcDirSave "[ass] FcDirSave failed.\n"
+#define MSGTR_LIBASS_FcConfigAppFontAddDirFailed "[ass] FcConfigAppFontAddDir failed\n"
+#define MSGTR_LIBASS_FontconfigDisabledDefaultFontWillBeUsed "[ass] Fontconfig disabled, only default font will be used.\n"
+#define MSGTR_LIBASS_FunctionCallFailed "[ass] %s failed\n"
+#define MSGTR_LIBASS_NeitherPlayResXNorPlayResYDefined "[ass] Neither PlayResX nor PlayResY defined. Assuming 384x288.\n"
+#define MSGTR_LIBASS_PlayResYUndefinedSettingY "[ass] PlayResY undefined, setting %d.\n"
+#define MSGTR_LIBASS_PlayResXUndefinedSettingX "[ass] PlayResX undefined, setting %d.\n"
+#define MSGTR_LIBASS_FT_Init_FreeTypeFailed "[ass] FT_Init_FreeType failed.\n"
+#define MSGTR_LIBASS_Init "[ass] Init\n"
+#define MSGTR_LIBASS_InitFailed "[ass] Init failed.\n"
+#define MSGTR_LIBASS_BadCommand "[ass] Bad command: %c%c\n"
+#define MSGTR_LIBASS_ErrorLoadingGlyph  "[ass] Error loading glyph.\n"
+#define MSGTR_LIBASS_FT_Glyph_Stroke_Error "[ass] FT_Glyph_Stroke error %d \n"
+#define MSGTR_LIBASS_UnknownEffectType_InternalError "[ass] Unknown effect type (internal error)\n"
+#define MSGTR_LIBASS_NoStyleFound "[ass] No style found!\n"
+#define MSGTR_LIBASS_EmptyEvent "[ass] Empty event!\n"
+#define MSGTR_LIBASS_MAX_GLYPHS_Reached "[ass] MAX_GLYPHS reached: event %d, start = %llu, duration = %llu\n Text = %s\n"
+#define MSGTR_LIBASS_EventHeightHasChanged "[ass] Warning! Event height has changed!  \n"
+#define MSGTR_LIBASS_GlyphNotFoundReselectingFont "[ass] Glyph 0x%X not found, reselecting font for (%s, %d, %d)\n"
+#define MSGTR_LIBASS_GlyphNotFound "[ass] Glyph 0x%X not found in font for (%s, %d, %d)\n"
+#define MSGTR_LIBASS_ErrorOpeningMemoryFont "[ass] Error opening memory font: %s\n"
+#define MSGTR_LIBASS_NoCharmaps "[ass] font face with no charmaps\n"
+#define MSGTR_LIBASS_NoCharmapAutodetected "[ass] no charmap autodetected, trying the first one\n"
+#endif
+

Modified: branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_libass/mputils.c
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_libass/mputils.c	2007-07-13 17:01:23 UTC (rev 3361)
+++ branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_libass/mputils.c	2007-07-14 08:27:37 UTC (rev 3362)
@@ -13,15 +13,10 @@
 #include <enca.h>
 #endif
 
-
-#define ADM_LEGACY_PROGGY
-#include "ADM_assert.h"
-
-
 void my_mp_msg(int lvl, char *lvl_str, char *fmt, ...) {
+	va_list va;
 	if(lvl > MSGL_V) return;
 	printf("[ass] **%s**: ", lvl_str);
-	va_list va;
 	va_start(va, fmt);
 	vprintf(fmt, va);
 	va_end(va);
@@ -79,7 +74,7 @@
 	    if(src){
 		register unsigned short *dstp= t + x-r;
 		int mx;
-		unsigned *m3= (unsigned *)(m2 + src*mwidth);
+		unsigned *m3= m2 + src*mwidth;
 		for(mx=r-x; mx<mwidth; mx++){
 		    dstp[mx]+= m3[mx];
 		}
@@ -91,7 +86,7 @@
 	    if(src){
 		register unsigned short *dstp= t + x-r;
 		int mx;
-		unsigned *m3= (unsigned *)(m2 + src*mwidth);
+		unsigned *m3= m2 + src*mwidth;
 		for(mx=0; mx<mwidth; mx++){
 		    dstp[mx]+= m3[mx];
 		}
@@ -104,7 +99,7 @@
 		register unsigned short *dstp= t + x-r;
 		int mx;
 		const int x2= r+width -x;
-		unsigned *m3= (unsigned *)(m2 + src*mwidth);
+		unsigned *m3= m2 + src*mwidth;
 		for(mx=0; mx<x2; mx++){
 		    dstp[mx]+= m3[mx];
 		}
@@ -123,7 +118,7 @@
 	    if(src){
 		register unsigned short *dstp= srcp - 1 + width+1;
 		const int src2= (src + 128)>>8;
-		unsigned *m3= (unsigned *)(m2 + src2*mwidth);
+		unsigned *m3= m2 + src2*mwidth;
 
 		int mx;
 		*srcp= 128;
@@ -139,7 +134,7 @@
 	    if(src){
 		register unsigned short *dstp= srcp - 1 - r*(width+1);
 		const int src2= (src + 128)>>8;
-		unsigned *m3= (unsigned *)(m2 + src2*mwidth);
+		unsigned *m3= m2 + src2*mwidth;
 
 		int mx;
 		*srcp= 128;
@@ -156,7 +151,7 @@
 		const int y2=r+height-y;
 		register unsigned short *dstp= srcp - 1 - r*(width+1);
 		const int src2= (src + 128)>>8;
-		unsigned *m3= (unsigned *)(m2 + src2*mwidth);
+		unsigned *m3= m2 + src2*mwidth;
 
 		int mx;
 		*srcp= 128;

Modified: branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_libass/mputils.h
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_libass/mputils.h	2007-07-13 17:01:23 UTC (rev 3361)
+++ branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_libass/mputils.h	2007-07-14 08:27:37 UTC (rev 3362)
@@ -1,11 +1,19 @@
 #ifndef __MPUTILS_H__
 #define __MPUTILS_H__
 
+#include "help_mp.h"
+
 unsigned utf8_get_char(char **str);
 
 void my_mp_msg(int lvl, char *lvl_str, char *fmt, ...);
 
+#ifdef __VISUALC__
+static void mp_msg(int mod, int level, const char *fmt, ...) {
+	// MSVC doesn't like the # used all around for mp_msg, so it breaks va_arg
+}
+#else
 #define mp_msg(mod, level, args...) my_mp_msg(level, #level, args)
+#endif
 
 #define MSGT_ASS 43
 

Modified: branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/ADM_vidASS.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/ADM_vidASS.cpp	2007-07-13 17:01:23 UTC (rev 3361)
+++ branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/ADM_vidASS.cpp	2007-07-14 08:27:37 UTC (rev 3362)
@@ -10,12 +10,14 @@
   Initial port from MPlayer by Moonz
 
 */
+#include "config.h"
+
 #include <stdio.h>
 #include <stdlib.h>
 #include <string.h>
 #include "ADM_assert.h"
 
-#include "config.h"
+
 #include "fourcc.h"
 #include "avio.hxx"
 #include "avi_vars.h"
@@ -187,7 +189,8 @@
        _ass_track = ass_read_file(_ass_lib, (char*)_params->subfile, NULL);
 
 //        ADM_assert(_ass_track);
-        GUI_Error_HIG("SSA Error","Cannot read_file for *%s*",(char*)_params->subfile);
+        if(!_ass_track)
+          GUI_Error_HIG("SSA Error","Cannot read_file for *%s*",(char*)_params->subfile);
         return 1;
 } 
 
@@ -283,8 +286,8 @@
           printf("[Ass] No sub to render\n");
           return 1; 
         }
-
-        ass_image_t *img = ass_render_frame(_ass_rend, _ass_track, where);
+        int changed=0;
+        ass_image_t *img = ass_render_frame(_ass_rend, _ass_track, where,&changed);
         
 
         while(img) {



From mean at mail.berlios.de  Sat Jul 14 10:36:16 2007
From: mean at mail.berlios.de (mean at BerliOS)
Date: Sat, 14 Jul 2007 10:36:16 +0200
Subject: [Avidemux-svn-commit] r3363 -
	branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_libass
Message-ID: <200707140836.l6E8aG16008421@sheep.berlios.de>

Author: mean
Date: 2007-07-14 10:36:15 +0200 (Sat, 14 Jul 2007)
New Revision: 3363

Modified:
   branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_libass/Makefile.am
Log:
[libass] update automake build too

Modified: branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_libass/Makefile.am
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_libass/Makefile.am	2007-07-14 08:27:37 UTC (rev 3362)
+++ branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_libass/Makefile.am	2007-07-14 08:36:15 UTC (rev 3363)
@@ -1,6 +1,6 @@
 noinst_LIBRARIES = libass.a
 libass_a_METASOURCES = AUTO
-libass_a_SOURCES = ass.c  ass_cache.c  ass_fontconfig.c  ass_mp.c  ass_render.c  ass_utils.c  mputils.c ass_bitmap.c ass_library.c
+libass_a_SOURCES = ass.c  ass_cache.c  ass_fontconfig.c  ass_mp.c  ass_render.c  ass_utils.c  mputils.c ass_bitmap.c ass_library.c ass_font.c
 
 EXTRA_DIST = 
 



From mean at mail.berlios.de  Sat Jul 14 10:41:21 2007
From: mean at mail.berlios.de (mean at BerliOS)
Date: Sat, 14 Jul 2007 10:41:21 +0200
Subject: [Avidemux-svn-commit] r3364 - in
	branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces:
	ADM_GTK/ADM_dialog ADM_NONE/ADM_dialog ADM_QT4/ADM_dialog
	ADM_QT4/ADM_dialogFactory ADM_commonUI
Message-ID: <200707140841.l6E8fKw5008586@sheep.berlios.de>

Author: mean
Date: 2007-07-14 10:41:20 +0200 (Sat, 14 Jul 2007)
New Revision: 3364

Modified:
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_contrast.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_NONE/ADM_dialog/alert_none.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_hue.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialogFactory/FAC_float.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_bitrateHisto.cpp
Log:
kill some warnings

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_contrast.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_contrast.cpp	2007-07-14 08:36:15 UTC (rev 3363)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_contrast.cpp	2007-07-14 08:41:20 UTC (rev 3364)
@@ -164,7 +164,7 @@
   CHECKBOX (checkbuttonV, param.doChromaV);
   
   GtkAdjustment *adj=gtk_range_get_adjustment (GTK_RANGE(WID(hscaleBright)));
-  param.offset= GTK_ADJUSTMENT(adj)->value;
+  param.offset= (int32_t)GTK_ADJUSTMENT(adj)->value;
   
   adj=gtk_range_get_adjustment (GTK_RANGE(WID(hscaleContrast)));
   param.coef=GTK_ADJUSTMENT(adj)->value;

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_NONE/ADM_dialog/alert_none.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_NONE/ADM_dialog/alert_none.cpp	2007-07-14 08:36:15 UTC (rev 3363)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_NONE/ADM_dialog/alert_none.cpp	2007-07-14 08:41:20 UTC (rev 3364)
@@ -258,4 +258,4 @@
 int32_t UI_readJog(void)
 {
  return 0; 
-}
\ No newline at end of file
+}

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_hue.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_hue.cpp	2007-07-14 08:36:15 UTC (rev 3363)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_hue.cpp	2007-07-14 08:41:20 UTC (rev 3364)
@@ -121,8 +121,8 @@
 {
       Ui_hueDialog *w=(Ui_hueDialog *)_cookie;
 
-        MYSPIN(Saturation)->setValue(param.saturation);
-        MYSPIN(Hue)->setValue(param.hue);
+        MYSPIN(Saturation)->setValue((int)param.saturation);
+        MYSPIN(Hue)->setValue((int)param.hue);
         return 1;
 }
 uint8_t flyHue::download(void)

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialogFactory/FAC_float.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialogFactory/FAC_float.cpp	2007-07-14 08:36:15 UTC (rev 3363)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialogFactory/FAC_float.cpp	2007-07-14 08:41:20 UTC (rev 3364)
@@ -85,4 +85,4 @@
     box->setEnabled(1);
   else
     box->setDisabled(1);
-}
\ No newline at end of file
+}

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_bitrateHisto.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_bitrateHisto.cpp	2007-07-14 08:36:15 UTC (rev 3363)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_bitrateHisto.cpp	2007-07-14 08:41:20 UTC (rev 3364)
@@ -177,7 +177,7 @@
         uint32_t mxx=0;
         for(k=0;k<20;k++)
         {
-           if(display[k]>mxx) mxx=display[k];
+           if(display[k]>mxx) mxx=(uint32_t)display[k];
         }   
         for(k=0;k<20;k++)
         {



From mean at mail.berlios.de  Sat Jul 14 16:00:47 2007
From: mean at mail.berlios.de (mean at BerliOS)
Date: Sat, 14 Jul 2007 16:00:47 +0200
Subject: [Avidemux-svn-commit] r3365 -
	branches/avidemux_2.4_branch/avidemux/ADM_ocr
Message-ID: <200707141400.l6EE0l5b006887@sheep.berlios.de>

Author: mean
Date: 2007-07-14 16:00:46 +0200 (Sat, 14 Jul 2007)
New Revision: 3365

Modified:
   branches/avidemux_2.4_branch/avidemux/ADM_ocr/Makefile.am
Log:
[OCR] dont break automake

Modified: branches/avidemux_2.4_branch/avidemux/ADM_ocr/Makefile.am
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_ocr/Makefile.am	2007-07-14 08:41:20 UTC (rev 3364)
+++ branches/avidemux_2.4_branch/avidemux/ADM_ocr/Makefile.am	2007-07-14 14:00:46 UTC (rev 3365)
@@ -11,7 +11,7 @@
 
 
 EXTRA_DIST =  ADM_leftturn.h     ADM_vob2vobsub.cpp  adm_glyph.h  \
-ADM_ocrLoadSave.h  adm_glyph.cpp       adm_leftturn.cpp
+  adm_glyph.cpp       adm_leftturn.cpp
 
 
-noinst_HEADERS = ADM_ocrLoadSave.h
+noinst_HEADERS = 



From gruntster at mail.berlios.de  Sat Jul 14 17:07:04 2007
From: gruntster at mail.berlios.de (gruntster at mail.berlios.de)
Date: Sat, 14 Jul 2007 17:07:04 +0200
Subject: [Avidemux-svn-commit] r3366 -
	branches/avidemux_2.4_branch/avidemux/winInstaller
Message-ID: <200707141507.l6EF74bU009345@sheep.berlios.de>

Author: gruntster
Date: 2007-07-14 17:06:58 +0200 (Sat, 14 Jul 2007)
New Revision: 3366

Modified:
   branches/avidemux_2.4_branch/avidemux/winInstaller/avidemux.nsi
Log:
add italian to win32 installer

Modified: branches/avidemux_2.4_branch/avidemux/winInstaller/avidemux.nsi
===================================================================
--- branches/avidemux_2.4_branch/avidemux/winInstaller/avidemux.nsi	2007-07-14 14:00:46 UTC (rev 3365)
+++ branches/avidemux_2.4_branch/avidemux/winInstaller/avidemux.nsi	2007-07-14 15:06:58 UTC (rev 3366)
@@ -200,6 +200,14 @@
         WriteRegStr HKLM "${REGKEY}\Components" German 1
     SectionEnd
     
+    Section Italian SecLangItalian
+        SectionIn 2
+        SetOutPath $INSTDIR\share\locale\it\LC_MESSAGES
+        SetOverwrite on
+        File ..\..\..\avidemux_2.4_build\share\locale\it\LC_MESSAGES\avidemux.mo        
+        WriteRegStr HKLM "${REGKEY}\Components" Italian 1
+    SectionEnd
+    
     Section Japanese SecLangJapanese
         SectionIn 2
         SetOutPath $INSTDIR\share\locale\ja\LC_MESSAGES
@@ -277,6 +285,13 @@
     WriteRegStr HKLM "${REGKEY}\Components" GermanGtk 1
 SectionEnd
 
+Section "-Italian GTK" SecLangItalianGtk
+    SetOutPath $INSTDIR\lib\locale\it\LC_MESSAGES
+    SetOverwrite on
+    File ..\..\..\avidemux_2.4_build\lib\locale\it\LC_MESSAGES\gtk20.mo
+    WriteRegStr HKLM "${REGKEY}\Components" ItalianGtk 1
+SectionEnd
+
 Section "-Japanese GTK" SecLangJapaneseGtk
     SetOutPath $INSTDIR\lib\locale\ja\LC_MESSAGES
     SetOverwrite on
@@ -464,6 +479,11 @@
     DeleteRegValue HKLM "${REGKEY}\Components" JapaneseGtk
 SectionEnd
 
+Section /o un.ItalianGtk UnSecLangItalianGtk
+    RmDir /r /REBOOTOK $INSTDIR\lib\locale\it
+    DeleteRegValue HKLM "${REGKEY}\Components" ItalianGtk
+SectionEnd
+
 Section /o un.GermanGtk UnSecLangGermanGtk
     RmDir /r /REBOOTOK $INSTDIR\lib\locale\de
     DeleteRegValue HKLM "${REGKEY}\Components" GermanGtk
@@ -514,6 +534,11 @@
     DeleteRegValue HKLM "${REGKEY}\Components" Japanese
 SectionEnd
 
+Section /o un.Italian UnSecLangItalian
+    RmDir /r /REBOOTOK $INSTDIR\share\locale\it
+    DeleteRegValue HKLM "${REGKEY}\Components" Italian
+SectionEnd
+
 Section /o un.German UnSecLangGerman
     RmDir /r /REBOOTOK $INSTDIR\share\locale\de
     DeleteRegValue HKLM "${REGKEY}\Components" German
@@ -675,6 +700,7 @@
     !insertmacro SELECT_SECTION Czech ${SecLangCzech}
     !insertmacro SELECT_SECTION French ${SecLangFrench}
     !insertmacro SELECT_SECTION German ${SecLangGerman}
+    !insertmacro SELECT_SECTION Italian ${SecLangItalian}
     !insertmacro SELECT_SECTION Japanese ${SecLangJapanese}
     !insertmacro SELECT_SECTION Russian ${SecLangRussian}
     !insertmacro SELECT_SECTION Serbian ${SecLangSerbian}
@@ -794,6 +820,11 @@
     IntOp $1 $0 & $1
     SectionSetFlags ${SecLangGermanGtk} $1
     
+    SectionGetFlags ${SecLangItalian} $1
+    IntOp $1 $1 & ${SF_SELECTED}
+    IntOp $1 $0 & $1
+    SectionSetFlags ${SecLangItalianGtk} $1
+    
     SectionGetFlags ${SecLangJapanese} $1
     IntOp $1 $1 & ${SF_SELECTED}
     IntOp $1 $0 & $1
@@ -893,6 +924,7 @@
     !insertmacro SELECT_SECTION Czech ${UnSecLangCzech}
     !insertmacro SELECT_SECTION French ${UnSecLangFrench}
     !insertmacro SELECT_SECTION German ${UnSecLangGerman}
+    !insertmacro SELECT_SECTION Italian ${UnSecLangItalian}
     !insertmacro SELECT_SECTION Japanese ${UnSecLangJapanese}
     !insertmacro SELECT_SECTION Russian ${UnSecLangRussian}
     !insertmacro SELECT_SECTION Serbian ${UnSecLangSerbian}
@@ -903,6 +935,7 @@
     !insertmacro SELECT_SECTION CzechGtk ${UnSecLangCzechGtk}
     !insertmacro SELECT_SECTION FrenchGtk ${UnSecLangFrenchGtk}
     !insertmacro SELECT_SECTION GermanGtk ${UnSecLangGermanGtk}
+    !insertmacro SELECT_SECTION ItalianGtk ${UnSecLangItalianGtk}
     !insertmacro SELECT_SECTION JapaneseGtk ${UnSecLangJapaneseGtk}
     !insertmacro SELECT_SECTION RussianGtk ${UnSecLangRussianGtk}
     !insertmacro SELECT_SECTION SerbianGtk ${UnSecLangSerbianGtk}



From gruntster at mail.berlios.de  Sat Jul 14 19:15:56 2007
From: gruntster at mail.berlios.de (gruntster at mail.berlios.de)
Date: Sat, 14 Jul 2007 19:15:56 +0200
Subject: [Avidemux-svn-commit] r3367 - in
	branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces:
	ADM_GTK/ADM_dialog ADM_commonUI
Message-ID: <200707141715.l6EHFuWM009234@sheep.berlios.de>

Author: gruntster
Date: 2007-07-14 19:15:30 +0200 (Sat, 14 Jul 2007)
New Revision: 3367

Modified:
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_flyDialog.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_flyDialog.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_flyDialog.h
Log:
resize for flyDialog

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_flyDialog.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_flyDialog.cpp	2007-07-14 15:06:58 UTC (rev 3366)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_flyDialog.cpp	2007-07-14 17:15:30 UTC (rev 3367)
@@ -16,36 +16,40 @@
 
 #include <string.h>
 #include <stdio.h>
+# include <math.h>
 
 #include <gdk/gdkkeysyms.h>
 #include <gtk/gtk.h>
 
-
-#include <gdk/gdkkeysyms.h>
-#include <gtk/gtk.h>
-# include <math.h>
-
 #include "default.h"
 
 #include "ADM_toolkit_gtk/ADM_gladeSupport.h"
 #include "ADM_toolkit_gtk/toolkit_gtk.h"
 #include "ADM_toolkit_gtk/toolkit_gtk_include.h"
 #include "ADM_toolkit/toolkit.hxx"
-#include "default.h"
 
 #include "ADM_colorspace/ADM_rgb.h"
-
 #include "ADM_image.h"
 #include "ADM_video/ADM_genvideo.hxx"
 #include "DIA_flyDialog.h"
 #include "ADM_assert.h"
+
 extern void GUI_RGBDisplay(uint8_t * dis, uint32_t w, uint32_t h, void *widg);
+
 uint8_t  ADM_flyDialog::display(void)
 {
-  ADM_assert(_canvas);
-  ADM_assert(_rgbBufferOut);
-  GUI_RGBDisplay(_rgbBufferOut,_w,_h,_canvas);
-  return 1; 
+	ADM_assert(_canvas);
+	ADM_assert(_rgbBufferOut);
+
+	if (_resizer)
+	{
+		_resizer->resize(_rgbBufferOut, _rgbBufferDisplay);
+		GUI_RGBDisplay(_rgbBufferDisplay, _zoomW, _zoomH, _canvas);
+	}
+	else
+		GUI_RGBDisplay(_rgbBufferOut, _w, _h, _canvas);
+
+	return 1; 
 }
 uint32_t ADM_flyDialog::sliderGet(void)
 {

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_flyDialog.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_flyDialog.cpp	2007-07-14 15:06:58 UTC (rev 3366)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_flyDialog.cpp	2007-07-14 17:15:30 UTC (rev 3367)
@@ -25,20 +25,24 @@
 
 #include "ADM_colorspace/colorspace.h"
 #include "ADM_colorspace/ADM_rgb.h"
-#include "ADM_commonUI//GUI_render.h"
+#include "ADM_commonUI/GUI_render.h"
 #include "ADM_video/ADM_genvideo.hxx"
 #include "DIA_flyDialog.h"
 
 #include "ADM_assert.h"
 
+extern "C" {
+#include "ADM_libraries/ADM_lavcodec/avcodec.h"
+}
+
 /**
     \fn ADM_flyDialog
 */
  ADM_flyDialog::ADM_flyDialog(uint32_t width,uint32_t height,AVDMGenericVideoStream *in,
                                 void *canvas, void *slider,int yuv)
 {
-  _w=width;
-  _h=height;
+  _w=_zoomW=width;
+  _h=_zoomH=height;
   _isYuvProcessing=yuv;
   _in=in;
     if(isRgbInverted())
@@ -63,10 +67,12 @@
     _rgbBufferOut =new uint8_t [_w*_h*4];
   _slider=slider;
   _canvas=canvas;
-  
+
   ADM_assert(_slider);
   ADM_assert(_canvas);
   _cookie=NULL;
+  _rgbBufferDisplay=NULL;
+  _resizer=NULL;
 }
 /**
     \fn cleanup
@@ -77,11 +83,13 @@
 #define DEL1(x)    if(x) {delete [] x;x=NULL;}
 #define DEL2(x)    if(x) {delete  x;x=NULL;}
   
-        DEL2(_yuvBufferOut);
-        DEL2(_yuvBuffer);
-        DEL1(_rgbBuffer);
-        DEL1(_rgbBufferOut);
-        DEL2(_rgb);
+	DEL2(_yuvBufferOut);
+	DEL2(_yuvBuffer);
+	DEL1(_rgbBuffer);
+	DEL1(_rgbBufferOut);
+	DEL1(_rgbBufferDisplay);
+	DEL2(_rgb);
+	DEL2(_resizer);
 }
 /**
     \fn ~ADM_flyDialog
@@ -132,6 +140,25 @@
     display();
 }
 
+void ADM_flyDialog::resizeImage(uint32_t width, uint32_t height)
+{
+	_zoomW = width;
+	_zoomH = height;
 
+	if (_resizer)
+	{
+		delete _resizer;
+		delete[] _rgbBufferDisplay;
+	}
+
+	if (width == _w && height == _h)
+		_resizer = NULL;
+	else
+	{
+		_resizer = new ADMImageResizer(_w, _h, _zoomW, _zoomH, PIX_FMT_RGB32, PIX_FMT_RGB32);
+		_rgbBufferDisplay = new uint8_t[_zoomW * _zoomH * 4];
+	}
+}
+
 //EOF
 

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_flyDialog.h
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_flyDialog.h	2007-07-14 15:06:58 UTC (rev 3366)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_flyDialog.h	2007-07-14 17:15:30 UTC (rev 3367)
@@ -27,14 +27,17 @@
 class ADM_flyDialog
 {
   protected:
-          uint32_t _w,_h;
+          uint32_t _w,_h, _zoomW, _zoomH;
           AVDMGenericVideoStream *_in;
   
           ADMImage *_yuvBuffer;
           ADMImage *_yuvBufferOut;
           uint8_t  *_rgbBuffer;
           uint8_t  *_rgbBufferOut;
+		  uint8_t  *_rgbBufferDisplay;
           uint8_t  _isYuvProcessing;
+
+		  ADMImageResizer *_resizer;
   public:
           void    *_cookie; // whatever
           void    *_slider; // widget
@@ -55,6 +58,7 @@
           uint8_t  isRgbInverted(void);
   virtual uint8_t  update(void) {};
           uint8_t  cleanup(void);
+		  void resizeImage(uint32_t width, uint32_t height);
          /*                               */
                   ADM_flyDialog(uint32_t width,uint32_t height,AVDMGenericVideoStream *in,
                                     void *canvas, void *slider,int yuv);



From gruntster at mail.berlios.de  Sat Jul 14 19:34:01 2007
From: gruntster at mail.berlios.de (gruntster at mail.berlios.de)
Date: Sat, 14 Jul 2007 19:34:01 +0200
Subject: [Avidemux-svn-commit] r3368 - in
	branches/avidemux_2.4_branch/avidemux: .
	ADM_userInterfaces/ADM_GTK/ADM_dialog
	ADM_userInterfaces/ADM_GTK/ADM_gui2
	ADM_userInterfaces/ADM_GTK/ADM_toolkit_gtk
	ADM_userInterfaces/ADM_NONE/ADM_gui2
	ADM_userInterfaces/ADM_QT4/ADM_gui ADM_userInterfaces/ADM_commonUI
Message-ID: <200707141734.l6EHY1R0029171@sheep.berlios.de>

Author: gruntster
Date: 2007-07-14 19:33:40 +0200 (Sat, 14 Jul 2007)
New Revision: 3368

Modified:
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_asharp.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_chromaShift.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_contrast.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_crop.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_hue.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_srt.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_bindings.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_gtkRender.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_toolkit_gtk/toolkit.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_NONE/ADM_gui2/file_none.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui_none.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/GUI_render.cpp
   branches/avidemux_2.4_branch/avidemux/gtk_gui.cpp
Log:
resize GTK flyDialog filters when image is greater than screen resolution

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_asharp.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_asharp.cpp	2007-07-14 17:15:30 UTC (rev 3367)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_asharp.cpp	2007-07-14 17:33:40 UTC (rev 3368)
@@ -53,6 +53,9 @@
 static int lock=0;
 static GtkWidget *dialog=NULL;
 static flyASharp *myCrop=NULL;
+
+extern float UI_calcZoomToFitScreen(GtkWindow* window, GtkWidget* drawingArea, uint32_t imageWidth, uint32_t imageHeight);
+
 //
 //      Video is in YV12 Colorspace
 //
@@ -67,12 +70,22 @@
 
         dialog=create_dialog1();
         gtk_register_dialog(dialog);
-        
-        gtk_widget_set_usize(WID(drawingarea1), width,height);
         gtk_window_set_title (GTK_WINDOW (dialog), _("ASHARP"));
+
+		float zoom = UI_calcZoomToFitScreen(GTK_WINDOW(dialog), WID(drawingarea1), width, height);
+
+		uint32_t zoomW = width * zoom;
+		uint32_t zoomH = height * zoom;
+
+		gtk_widget_set_usize(WID(drawingarea1), zoomW, zoomH);
+
+		if (zoom < 1)
+		{
+			gtk_window_set_position(GTK_WINDOW(dialog), GTK_WIN_POS_CENTER);
+		}
+
         gtk_widget_show(dialog);
-	
-        
+
         gtk_signal_connect(GTK_OBJECT(WID(drawingarea1)), "expose_event",
             GTK_SIGNAL_FUNC(draw),
             NULL);
@@ -86,6 +99,7 @@
           
         myCrop=new flyASharp( width, height,in,WID(drawingarea1),WID(hscale1));
         memcpy(&(myCrop->param),param,sizeof(ASHARP_PARAM));
+		myCrop->resizeImage(zoomW, zoomH);
         myCrop->upload();
         myCrop->sliderChanged();
         ret=0;

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_chromaShift.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_chromaShift.cpp	2007-07-14 17:15:30 UTC (rev 3367)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_chromaShift.cpp	2007-07-14 17:33:40 UTC (rev 3368)
@@ -19,10 +19,6 @@
 #include <stdio.h>
 #include <gdk/gdkkeysyms.h>
 #include <gtk/gtk.h>
-
-
-#include <gdk/gdkkeysyms.h>
-#include <gtk/gtk.h>
 # include <math.h>
 
 #include "default.h"
@@ -52,6 +48,8 @@
 static void update(void);
 
 static flyChromaShift *myCrop=NULL;
+
+extern float UI_calcZoomToFitScreen(GtkWindow* window, GtkWidget* drawingArea, uint32_t imageWidth, uint32_t imageHeight);
 //**************************************
 
 uint8_t DIA_getChromaShift( AVDMGenericVideoStream *instream,CHROMASHIFT_PARAM    *param );
@@ -67,13 +65,25 @@
 
         dialog=create_ChromaShift();
         gtk_register_dialog(dialog);
-        
-        gtk_widget_set_usize(WID(drawingarea1), width,height);
         gtk_window_set_title (GTK_WINDOW (dialog), _("ASHARP"));
+
+		float zoom = UI_calcZoomToFitScreen(GTK_WINDOW(dialog), WID(drawingarea1), width, height);
+
+		uint32_t zoomW = width * zoom;
+		uint32_t zoomH = height * zoom;
+
+		gtk_widget_set_usize(WID(drawingarea1), zoomW, zoomH);
+
+		if (zoom < 1)
+		{
+			gtk_window_set_position(GTK_WINDOW(dialog), GTK_WIN_POS_CENTER);
+		}
+
         gtk_widget_show(dialog);
 	
         myCrop=new flyChromaShift( width, height,in,WID(drawingarea1),WID(hscale));
         memcpy(&(myCrop->param),param,sizeof(CHROMASHIFT_PARAM));
+		myCrop->resizeImage(zoomW, zoomH);
         myCrop->upload();
         myCrop->sliderChanged();
         

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_contrast.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_contrast.cpp	2007-07-14 17:15:30 UTC (rev 3367)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_contrast.cpp	2007-07-14 17:33:40 UTC (rev 3368)
@@ -57,6 +57,8 @@
 static int lock=0;
 static flyContrast *myCrop=NULL;
 
+extern float UI_calcZoomToFitScreen(GtkWindow* window, GtkWidget* drawingArea, uint32_t imageWidth, uint32_t imageHeight);
+
 /********************************************************************/
 uint8_t DIA_contrast(AVDMGenericVideoStream *in,CONTRAST_PARAM *param)
 {
@@ -69,11 +71,21 @@
 
         dialog=create_dialog1();
         gtk_register_dialog(dialog);
-        
-        gtk_widget_set_usize(WID(drawingarea1), width,height);
         gtk_window_set_title (GTK_WINDOW (dialog), _("ASHARP"));
-        gtk_widget_show(dialog);
-	
+
+		float zoom = UI_calcZoomToFitScreen(GTK_WINDOW(dialog), WID(drawingarea1), width, height);
+
+		uint32_t zoomW = width * zoom;
+		uint32_t zoomH = height * zoom;
+
+		gtk_widget_set_usize(WID(drawingarea1), zoomW, zoomH);
+
+		if (zoom < 1)
+		{
+			gtk_window_set_position(GTK_WINDOW(dialog), GTK_WIN_POS_CENTER);
+		}
+
+        gtk_widget_show(dialog);	
         
           // and value changed
 #define CNX(x,y) gtk_signal_connect(GTK_OBJECT(WID(x)), y, GTK_SIGNAL_FUNC(gui_update), (void *) (1));
@@ -97,6 +109,7 @@
           
         myCrop=new flyContrast( width, height,in,WID(drawingarea1),WID(hscale1));
         memcpy(&(myCrop->param),param,sizeof(CONTRAST_PARAM));
+		myCrop->resizeImage(zoomW, zoomH);
         myCrop->upload();
         myCrop->sliderChanged();
         ret=0;

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_crop.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_crop.cpp	2007-07-14 17:15:30 UTC (rev 3367)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_crop.cpp	2007-07-14 17:33:40 UTC (rev 3368)
@@ -25,12 +25,8 @@
 #include <stdio.h>
 #include <gdk/gdkkeysyms.h>
 #include <gtk/gtk.h>
+#include <math.h>
 
-
-#include <gdk/gdkkeysyms.h>
-#include <gtk/gtk.h>
-# include <math.h>
-
 #include "default.h"
 #include "ADM_toolkit_gtk/toolkit_gtk.h"
 #include "ADM_toolkit_gtk/toolkit_gtk_include.h"
@@ -44,9 +40,8 @@
 #include "DIA_flyCrop.h"
 
 static GtkWidget	*create_dialog1 (void);
-static void 		draw (GtkWidget *dialog,uint32_t w,uint32_t h );
+extern float UI_calcZoomToFitScreen(GtkWindow* window, GtkWidget* drawingArea, uint32_t imageWidth, uint32_t imageHeight);
 
-
 /* Link between UI and core */
 static gboolean 	ui_draw( void );
 static void 		ui_autocrop (void );
@@ -66,69 +61,84 @@
 //	Video is in YV12 Colorspace
 //
 //
-int DIA_getCropParams(	char *name,CROP_PARAMS *param,AVDMGenericVideoStream *in)
+int DIA_getCropParams(char *name, CROP_PARAMS *param, AVDMGenericVideoStream *in)
 {
-  uint32_t width,height;
-        // Allocate space for green-ised video
-        width=in->getInfo()->width;
-        height=in->getInfo()->height;
-        
-        
-  
-        uint8_t ret=0;
-  
-        dialog=create_dialog1();
-        gtk_register_dialog(dialog);
-        
-        gtk_widget_set_usize(WID(drawingarea1), width,height);
-        gtk_window_set_title (GTK_WINDOW (dialog), name);
-        gtk_widget_show(dialog);
+	uint32_t width, height;
+
+	// Allocate space for green-ised video
+	width = in->getInfo()->width;
+	height = in->getInfo()->height;
+
+	uint8_t ret=0;
+
+	dialog=create_dialog1();
+	gtk_register_dialog(dialog);
+	gtk_window_set_title(GTK_WINDOW(dialog), name);
+
+	float zoom = UI_calcZoomToFitScreen(GTK_WINDOW(dialog), WID(drawingarea1), width, height);
+
+	uint32_t zoomW = width * zoom;
+	uint32_t zoomH = height * zoom;
+
+	gtk_widget_set_usize(WID(drawingarea1), zoomW, zoomH);
+
+	if (zoom < 1)
+	{
+		gtk_window_set_position(GTK_WINDOW(dialog), GTK_WIN_POS_CENTER);
+	}
+
+	gtk_widget_show(dialog);
 	
-#define CONNECT(x,y,z) 	gtk_signal_connect(GTK_OBJECT(WID(x)), #y,GTK_SIGNAL_FUNC(z),   NULL);
+#define CONNECT(x,y,z) 	gtk_signal_connect(GTK_OBJECT(WID(x)), #y, GTK_SIGNAL_FUNC(z), NULL);
 
-        CONNECT(drawingarea1,expose_event,ui_draw);
-        CONNECT(buttonAutocrop,clicked,ui_autocrop);
-        CONNECT(buttonReset,clicked,ui_reset);
-        CONNECT(scale,value_changed,ui_frame_changed);
-                              
-          gtk_dialog_add_action_widget (GTK_DIALOG (dialog), WID(buttonCancel), GTK_RESPONSE_CANCEL);
-          gtk_dialog_add_action_widget (GTK_DIALOG (dialog), WID(buttonOk),      GTK_RESPONSE_OK);
-          gtk_dialog_add_action_widget (GTK_DIALOG (dialog), WID(buttonApply),  GTK_RESPONSE_APPLY);
+	CONNECT(drawingarea1,expose_event,ui_draw);
+	CONNECT(buttonAutocrop,clicked,ui_autocrop);
+	CONNECT(buttonReset,clicked,ui_reset);
+	CONNECT(scale,value_changed,ui_frame_changed);
+	                  
+	gtk_dialog_add_action_widget (GTK_DIALOG (dialog), WID(buttonCancel), GTK_RESPONSE_CANCEL);
+	gtk_dialog_add_action_widget (GTK_DIALOG (dialog), WID(buttonOk), GTK_RESPONSE_OK);
+	gtk_dialog_add_action_widget (GTK_DIALOG (dialog), WID(buttonApply), GTK_RESPONSE_APPLY);
 
 #define CONNECT_SPIN(x) CONNECT(spinbutton##x, value_changed,ui_update)
           
-          CONNECT_SPIN(Top);
-          CONNECT_SPIN(Left);
-          CONNECT_SPIN(Right);
-          CONNECT_SPIN(Bottom);
-          
-        myCrop=new flyCrop( width, height,in,WID(drawingarea1),WID(scale));
-        myCrop->left=param->left;
-        myCrop->right=param->right;
-        myCrop->top=param->top;
-        myCrop->bottom=param->bottom;
-        myCrop->upload();
-        myCrop->sliderChanged();
-        ret=0;
-        int response;
-        while( (response=gtk_dialog_run(GTK_DIALOG(dialog)))==GTK_RESPONSE_APPLY)
-        {
-          ui_update();
-        }
-        if(response==GTK_RESPONSE_OK)
-        {
-                ui_read( );
-                param->left=myCrop->left;
-                param->right=myCrop->right;
-                param->top=myCrop->top;
-                param->bottom=myCrop->bottom;
-                ret=1;
-        }
-        gtk_unregister_dialog(dialog);
-        gtk_widget_destroy(dialog);
-        delete myCrop;
-        return ret;
+	CONNECT_SPIN(Top);
+	CONNECT_SPIN(Left);
+	CONNECT_SPIN(Right);
+	CONNECT_SPIN(Bottom);
+
+	myCrop=new flyCrop(width, height,in,WID(drawingarea1),WID(scale));
+	myCrop->resizeImage(zoomW, zoomH);
+	myCrop->left=param->left;
+	myCrop->right=param->right;
+	myCrop->top=param->top;
+	myCrop->bottom=param->bottom;
+	myCrop->upload();	
+	myCrop->sliderChanged();	
+
+	int response;
+
+	while((response = gtk_dialog_run(GTK_DIALOG(dialog))) == GTK_RESPONSE_APPLY)
+	{
+	  ui_update();
+	}
+
+	if(response==GTK_RESPONSE_OK)
+	{
+		ui_read( );
+		param->left=myCrop->left;
+		param->right=myCrop->right;
+		param->top=myCrop->top;
+		param->bottom=myCrop->bottom;
+		ret=1;
+	}
+
+	gtk_unregister_dialog(dialog);
+	gtk_widget_destroy(dialog);
+	delete myCrop;
+	return ret;
 }
+
 /*
       Link GTK dialog and core
 */

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_hue.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_hue.cpp	2007-07-14 17:15:30 UTC (rev 3367)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_hue.cpp	2007-07-14 17:33:40 UTC (rev 3368)
@@ -18,23 +18,15 @@
  *   (at your option) any later version.                                   *
  *                                                                         *
  ***************************************************************************/
-
-
-
 #include <config.h>
 
-
 #include <string.h>
 #include <stdio.h>
 
 #include <gdk/gdkkeysyms.h>
 #include <gtk/gtk.h>
+#include <math.h>
 
-
-#include <gdk/gdkkeysyms.h>
-#include <gtk/gtk.h>
-# include <math.h>
-
 #include "default.h"
 #include "ADM_toolkit_gtk/ADM_gladeSupport.h"
 #include "ADM_toolkit_gtk/toolkit_gtk.h"
@@ -64,6 +56,7 @@
 static GtkWidget *dialog=NULL;
 static flyHue *myCrop=NULL;
 
+extern float UI_calcZoomToFitScreen(GtkWindow* window, GtkWidget* drawingArea, uint32_t imageWidth, uint32_t imageHeight);
 
 /**
       \fn DIA_getHue
@@ -80,11 +73,20 @@
         dialog=create_dialog1();
         gtk_register_dialog(dialog);
         
-        gtk_widget_set_usize(WID(drawingarea1), width,height);
         gtk_window_set_title (GTK_WINDOW (dialog), _("Hue"));
-        gtk_widget_show(dialog);
-	
-        
+
+		float zoom = UI_calcZoomToFitScreen(GTK_WINDOW(dialog), WID(drawingarea1), width, height);
+
+		uint32_t zoomW = width * zoom;
+		uint32_t zoomH = height * zoom;
+
+		gtk_widget_set_usize(WID(drawingarea1), zoomW, zoomH);
+
+		if (zoom < 1)
+		{
+			gtk_window_set_position(GTK_WINDOW(dialog), GTK_WIN_POS_CENTER);
+		}
+
         gtk_signal_connect(GTK_OBJECT(WID(drawingarea1)), "expose_event",
             GTK_SIGNAL_FUNC(draw),
             NULL);
@@ -93,10 +95,10 @@
         gtk_signal_connect(GTK_OBJECT(WID(hscaleHue)), "value_changed",GTK_SIGNAL_FUNC(hue_changed),   NULL);
         gtk_signal_connect(GTK_OBJECT(WID(hscaleSaturation)), "value_changed",GTK_SIGNAL_FUNC(hue_changed),   NULL);
         gtk_widget_show(dialog);
-
           
         myCrop=new flyHue( width, height,in,WID(drawingarea1),WID(hscale1));
         memcpy(&(myCrop->param),param,sizeof(Hue_Param));
+		myCrop->resizeImage(zoomW, zoomH);
         myCrop->upload();
         myCrop->sliderChanged();
         ret=0;

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_srt.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_srt.cpp	2007-07-14 17:15:30 UTC (rev 3367)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_srt.cpp	2007-07-14 17:33:40 UTC (rev 3368)
@@ -71,6 +71,8 @@
 static GtkWidget *dialog=NULL;
 static flySrtPos *myCrop=NULL;
 static int lock=0;
+
+extern float UI_calcZoomToFitScreen(GtkWindow* window, GtkWidget* drawingArea, uint32_t imageWidth, uint32_t imageHeight);
 /**
       \fn DIA_srtPos
       \brief Dialog that handles subtitle size and position
@@ -87,18 +89,29 @@
 
         dialog=create_dialog1();
         gtk_register_dialog(dialog);
-        
-        gtk_widget_set_usize(WID(drawingarea1), width,height);
         gtk_window_set_title (GTK_WINDOW (dialog), _("Subtitle Size and Position"));
+
+		float zoom = UI_calcZoomToFitScreen(GTK_WINDOW(dialog), WID(drawingarea1), width, height);
+
+		uint32_t zoomW = width * zoom;
+		uint32_t zoomH = height * zoom;
+
+		gtk_widget_set_usize(WID(drawingarea1), zoomW, zoomH);
+
+		if (zoom < 1)
+		{
+			gtk_window_set_position(GTK_WINDOW(dialog), GTK_WIN_POS_CENTER);
+		}
+
         gtk_widget_show(dialog);
 	
         myCrop=new flySrtPos( width, height,in,WID(drawingarea1),WID(hscale1));
         myCrop->param.fontSize=*size;
         myCrop->param.position=*position;
-        
-           gtk_range_set_range(GTK_RANGE(WID(vscale1)),0,height-1);
-        
-        
+
+        gtk_range_set_range(GTK_RANGE(WID(vscale1)),0,height-1);
+
+		myCrop->resizeImage(zoomW, zoomH);
         myCrop->upload();
         myCrop->sliderChanged();
         

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_bindings.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_bindings.cpp	2007-07-14 17:15:30 UTC (rev 3367)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_bindings.cpp	2007-07-14 17:33:40 UTC (rev 3368)
@@ -50,7 +50,7 @@
 #include "../ADM_toolkit_gtk/gtkmarkscale.h"
 #include "../ADM_toolkit_gtk/jogshuttle.h"
 
-uint8_t UI_getPhysicalScreenSize(uint32_t *w,uint32_t *h,void *r);
+uint8_t UI_getPhysicalScreenSize(uint32_t *w,uint32_t *h);
 
 
 #define WOD(x) lookup_widget (guiRootWindow,#x)
@@ -229,7 +229,7 @@
 		GUI_initCursor(  );
     
                 
-                UI_getPhysicalScreenSize(&w,&h,NULL); //gtk_widget_get_parent_window (guiRootWindow));
+                UI_getPhysicalScreenSize(&w,&h); //gtk_widget_get_parent_window (guiRootWindow));
                 printf("The screen seems to be %u x %u px\n",w,h);
  
                  GUI_gtk_grow_off(1);
@@ -1107,7 +1107,7 @@
 extern char **global_argv;
 typedef gboolean GCALL       (void *);
 extern int automation(void );
-extern uint8_t UI_getPhysicalScreenSize(uint32_t *w,uint32_t *h,void *root=NULL);
+extern uint8_t UI_getPhysicalScreenSize(uint32_t *w,uint32_t *h);
 int UI_Init(int argc, char **argv)
 {
   uint32_t w,h;

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_gtkRender.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_gtkRender.cpp	2007-07-14 17:15:30 UTC (rev 3367)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_gtkRender.cpp	2007-07-14 17:33:40 UTC (rev 3368)
@@ -22,23 +22,21 @@
 #include <unistd.h>
 
 #include <gtk/gtk.h>
-#ifndef ADM_WIN32
+#ifdef ADM_WIN32
+#include <gdk/gdkwin32.h>
+#else
 #include <gdk/gdkx.h>
-#else
-#include <gdk/gdkwin32.h>
 #endif
+
 #include <time.h>
 #include <sys/time.h>
 
-
-//#include "../avi_vars.h"
 #include <../ADM_assert.h>
 #define WIN32_CLASH
 #include "default.h"
 #include "../ADM_osSupport/ADM_misc.h"
 
 #include "ADM_commonUI/GUI_render.h"
-
 #include "ADM_commonUI/GUI_accelRender.h"
 
 #include "ADM_toolkit_gtk/toolkit_gtk.h"
@@ -50,8 +48,10 @@
 
 void GUI_gtk_grow_off(int onff);
 
-extern GtkWidget *getDrawWidget( void );
- ColYuvRgb rgbConverter(640,480);
+extern GtkWidget *getDrawWidget(void);
+extern uint8_t UI_getPhysicalScreenSize(uint32_t *w, uint32_t *h);
+
+ColYuvRgb rgbConverter(640,480);
 uint32_t lastW,lastH;
 /**
     \brief return pointer to the drawing widget that displays video
@@ -70,7 +70,7 @@
 
     if(lastW>w || lastH>h)
     {
-      printf("[Gtk] Warning window bigger than display %u x %u vs %u x %u\n",w,h,lastW,lastH);
+      printf("[GTK] Warning window bigger than display %u x %u vs %u x %u\n",w,h,lastW,lastH);
     }
 
     gdk_draw_rgb_32_image(widget->window, widget->style->fg_gc[GTK_STATE_NORMAL], 0,    // X
@@ -112,6 +112,40 @@
         xinfo->display=	(void*)GDK_WINDOW_HWND(widget->window);
 #endif
 }
-#if 0
-#endif
+
+// Calculate the zoom ratio required to fit the whole image on the screen.
+float UI_calcZoomToFitScreen(GtkWindow* window, GtkWidget* drawingArea, uint32_t imageWidth, uint32_t imageHeight)
+{
+	int windowWidth, windowHeight;
+	int drawingWidth, drawingHeight;
+	uint32_t screenWidth, screenHeight;
+	
+	gtk_window_get_size(window, &windowWidth, &windowHeight);
+	gtk_widget_get_size_request(drawingArea, &drawingWidth, &drawingHeight);
+
+	UI_getPhysicalScreenSize(&screenWidth, &screenHeight);
+
+	// Take drawing area out of the equation, how much extra do we need for additional controls?
+	windowWidth -= drawingWidth;
+	windowHeight -= drawingHeight;
+
+	// Take borders and captions into consideration (GTK doesn't seem to support this so we'll have to guess)
+	windowWidth += 10;
+	windowHeight += 40;
+
+	// This is the true amount of screen real estate we can work with
+	screenWidth -= windowWidth;
+	screenHeight -= windowHeight;
+
+	// Calculate zoom ratio
+	if (imageWidth > screenWidth || imageHeight > screenHeight)
+	{
+		if ((imageWidth - screenWidth) > (imageHeight - screenHeight))
+			return (float)screenWidth / (float)imageWidth;
+		else
+			return (float)screenHeight / (float)imageHeight;
+	}
+	else
+		return 1;
+}
 // EOF

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_toolkit_gtk/toolkit.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_toolkit_gtk/toolkit.cpp	2007-07-14 17:15:30 UTC (rev 3367)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_toolkit_gtk/toolkit.cpp	2007-07-14 17:33:40 UTC (rev 3368)
@@ -193,21 +193,22 @@
     \fn UI_getPhysicalScreenSize
     \brief return the physical size of display in pixels
 */
-uint8_t UI_getPhysicalScreenSize(uint32_t *w,uint32_t *h,void *r)
+uint8_t UI_getPhysicalScreenSize(uint32_t *w, uint32_t *h)
 {
-  static int inited=0;
-  static int ww,hh;
-    if(!inited)
-    {
-      
-      GdkScreen *sc= gdk_screen_get_default  ();
-      ww=  gdk_screen_get_width(sc);
-      hh=  gdk_screen_get_height(sc);
-      inited=1;
+	static int inited = 0;
+	static int ww,hh;
+
+    if (!inited)
+    {      
+      GdkScreen* sc = gdk_screen_get_default();
+      ww = gdk_screen_get_width(sc);
+      hh = gdk_screen_get_height(sc);
+      inited = 1;
     }
+
     *w=ww;
     *h=hh;
+
     return 1;
 }
-
 //EOF

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_NONE/ADM_gui2/file_none.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_NONE/ADM_gui2/file_none.cpp	2007-07-14 17:15:30 UTC (rev 3367)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_NONE/ADM_gui2/file_none.cpp	2007-07-14 17:33:40 UTC (rev 3368)
@@ -29,7 +29,7 @@
 void GUI_FileSelWrite(const char *label, char * * name)
 {}
 
-uint8_t UI_getPhysicalScreenSize(uint32_t *w,uint32_t *h,void *r)
+uint8_t UI_getPhysicalScreenSize(uint32_t *w,uint32_t *h)
 {
   *w=*h=10000; 
 }
\ No newline at end of file

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui_none.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui_none.cpp	2007-07-14 17:15:30 UTC (rev 3367)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui_none.cpp	2007-07-14 17:33:40 UTC (rev 3368)
@@ -63,7 +63,7 @@
 {
   return 1;
 }
-uint8_t UI_getPhysicalScreenSize(uint32_t *w,uint32_t *h,void *r)
+uint8_t UI_getPhysicalScreenSize(uint32_t *w,uint32_t *h)
 {
   *w=*h=10000; 
 }

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/GUI_render.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/GUI_render.cpp	2007-07-14 17:15:30 UTC (rev 3367)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/GUI_render.cpp	2007-07-14 17:33:40 UTC (rev 3368)
@@ -101,7 +101,6 @@
 //----------------------------------------
 uint8_t renderResize(uint32_t w, uint32_t h,uint32_t pw, uint32_t ph)
 {
-int mul,xx,yy;
 	if(screenBuffer) 
         {
                 delete  [] screenBuffer;

Modified: branches/avidemux_2.4_branch/avidemux/gtk_gui.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/gtk_gui.cpp	2007-07-14 17:15:30 UTC (rev 3367)
+++ branches/avidemux_2.4_branch/avidemux/gtk_gui.cpp	2007-07-14 17:33:40 UTC (rev 3368)
@@ -155,7 +155,7 @@
 PARAM_MUX muxMode = MUX_REGULAR;
 int muxParam = 0;
 
-extern uint8_t UI_getPhysicalScreenSize(uint32_t *w,uint32_t *h,void *r=NULL);
+extern uint8_t UI_getPhysicalScreenSize(uint32_t *w,uint32_t *h);
 extern uint8_t GUI_jobs(void);
 extern bool parseECMAScript(const char *name);
 void A_parseECMAScript(const char *name);



From mean at mail.berlios.de  Sat Jul 14 20:28:28 2007
From: mean at mail.berlios.de (mean at BerliOS)
Date: Sat, 14 Jul 2007 20:28:28 +0200
Subject: [Avidemux-svn-commit] r3369 - in
	branches/avidemux_2.4_branch/avidemux: .
	ADM_libraries/ADM_utilities ADM_ocr
	ADM_userInterfaces/ADM_GTK/ADM_dialog
	ADM_userInterfaces/ADM_GTK/ADM_ocr
	ADM_userInterfaces/ADM_NONE/ADM_dialog
	ADM_userInterfaces/ADM_QT4/ADM_dialog
	ADM_userInterfaces/ADM_commonUI
Message-ID: <200707141828.l6EISST6031126@sheep.berlios.de>

Author: mean
Date: 2007-07-14 20:28:27 +0200 (Sat, 14 Jul 2007)
New Revision: 3369

Added:
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp
Modified:
   branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_utilities/prefs.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_ocr/ADM_ocr.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_ocr/ADM_ocr.h
   branches/avidemux_2.4_branch/avidemux/ADM_ocr/adm_glyph.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_ocr.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_ocr/adm_ocr.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_NONE/ADM_dialog/DIA_none.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_none.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/CMakeLists.txt
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp
   branches/avidemux_2.4_branch/avidemux/CMakeLists.txt
   branches/avidemux_2.4_branch/avidemux/gtk_gui.cpp
   branches/avidemux_2.4_branch/avidemux/prefs.h
   branches/avidemux_2.4_branch/avidemux/prefs.in
Log:
[OCR] Global glyphset file, part 1

Modified: branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_utilities/prefs.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_utilities/prefs.cpp	2007-07-14 17:33:40 UTC (rev 3368)
+++ branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_utilities/prefs.cpp	2007-07-14 18:28:27 UTC (rev 3369)
@@ -135,12 +135,14 @@
 	{"filters.autoload.path",		STRING,"/tmp/",NULL, NULL, NULL },
 	{"filters.autoload.active",		UINT,	"0",	NULL,	"0",	"1"	},
 	{"feature.alternate_mp3_tag",		UINT,	"1",	NULL,	"0",	"1"	},
+	{"feature.global_glyph",		UINT,	"1",	NULL,	"0",	"1"	},
+	{"feature.global_glyph.name",		STRING,"",	NULL, NULL, NULL },
 	{"priority.encoding",		UINT,	"3",	NULL,	"0",	"4"	},
 	{"priority.indexing",		UINT,	"3",	NULL,	"0",	"4"	},
 	{"priority.playback",		UINT,	"0",	NULL,	"0",	"4"	}
 };
 
-int num_opts = 76;
+int num_opts = 78;
 // </prefs_gen>
 
 #ifdef USE_LIBXML2

Modified: branches/avidemux_2.4_branch/avidemux/ADM_ocr/ADM_ocr.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_ocr/ADM_ocr.cpp	2007-07-14 17:33:40 UTC (rev 3368)
+++ branches/avidemux_2.4_branch/avidemux/ADM_ocr/ADM_ocr.cpp	2007-07-14 18:28:27 UTC (rev 3369)
@@ -23,7 +23,7 @@
 static uint32_t minThreshold=0x80;
 
 /* In the UI related code */
-extern ReplyType glyphToText(admGlyph *glyph);
+//extern ReplyType glyphToText(admGlyph *glyph);
 extern void UI_purge(void);
 
 extern uint8_t adm_estimate_glyphSize(admGlyph *glyph,uint32_t *minx, uint32_t *maxx,uint32_t *miny,uint32_t *maxy,int *raw);
@@ -75,7 +75,7 @@
       @param h height of bitmap
       @param decodedString Will contain ocr'ed text
 */
-ReplyType ocrBitmap(uint8_t *workArea,uint32_t w,uint32_t h,char *decodedString)
+ReplyType ocrBitmap(uint8_t *workArea,uint32_t w,uint32_t h,char *decodedString,admGlyph *head)
 {
 uint8_t found;
 uint32_t colstart=0,colend=0,oldcol;
@@ -130,7 +130,7 @@
          
          
             // printf("Found glyph: %lu %lu\n",colstart,colend);  
-            reply=handleGlyph(workArea,colstart,colend,w,bottom,top);
+            reply=handleGlyph(workArea,colstart,colend,w,bottom,top,head);
             switch(reply)
                 {
                         case ReplySkip:break;
@@ -170,7 +170,7 @@
                 that case we use another method to extract the glyph.
                 We split it using leftturn method and do it again.
 */
-ReplyType handleGlyph(uint8_t *workArea,uint32_t start, uint32_t end,uint32_t w,uint32_t h,uint32_t base)
+ReplyType handleGlyph(uint8_t *workArea,uint32_t start, uint32_t end,uint32_t w,uint32_t h,uint32_t base,admGlyph *head)
 {
 uint8_t found=0;
 static int inc=1;
@@ -228,7 +228,7 @@
                 
                     if(lefty->width)
                     {
-                        reply=glyphToText(lefty);
+                        reply=glyphToText(lefty,head);
                         if(reply!=ReplyOk)
                         {
                             printf("Glyph2text failed(1)\n");
@@ -248,7 +248,7 @@
             if(raw) delete [] raw;
             if(glyph->width)
             {
-                reply=glyphToText(glyph);
+                reply=glyphToText(glyph,head);
                 if(reply!=ReplyOk)                 
                 {
                     printf("Glyph2text failed(2)\n");

Modified: branches/avidemux_2.4_branch/avidemux/ADM_ocr/ADM_ocr.h
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_ocr/ADM_ocr.h	2007-07-14 17:33:40 UTC (rev 3368)
+++ branches/avidemux_2.4_branch/avidemux/ADM_ocr/ADM_ocr.h	2007-07-14 18:28:27 UTC (rev 3369)
@@ -22,9 +22,13 @@
         ReplySkip=3,
         ReplySkipAll=4
 }ReplyType;
-
-ReplyType handleGlyph(uint8_t *workArea,uint32_t start, uint32_t end,uint32_t w,uint32_t h,uint32_t base);
-ReplyType ocrBitmap(uint8_t *data,uint32_t w,uint32_t h,char *decodedString);
+// GUI independant part
+ReplyType handleGlyph(uint8_t *workArea,uint32_t start, uint32_t end,uint32_t w,uint32_t h,uint32_t base,admGlyph *head);
+ReplyType ocrBitmap(uint8_t *workArea,uint32_t w,uint32_t h,char *decodedString,admGlyph *head);
 uint8_t   mergeBitmap(uint8_t *bitin, uint8_t *bitout, uint8_t *maskin,uint32_t w, uint32_t h);
 void ocrUpdateMinThreshold(void);
+
+// In GUI dependant part
+ReplyType glyphToText(admGlyph *glyph,admGlyph *head);
+
 #endif 

Modified: branches/avidemux_2.4_branch/avidemux/ADM_ocr/adm_glyph.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_ocr/adm_glyph.cpp	2007-07-14 17:33:40 UTC (rev 3368)
+++ branches/avidemux_2.4_branch/avidemux/ADM_ocr/adm_glyph.cpp	2007-07-14 18:28:27 UTC (rev 3369)
@@ -163,7 +163,7 @@
 {
   FILE *out;
   uint32_t slen;
-    
+  nb=0;
   admGlyph *glyph=head->next;
     
     
@@ -173,9 +173,18 @@
     GUI_Error_HIG(_("Could not write the file"), NULL);
     return 0;
   }
+    
+    /* First count how many glyphs */
+     while(glyph)
+    {
+      glyph=glyph->next;
+      nb++;
+    }
+    
 #define WRITE(x) fwrite(&(x),sizeof(x),1,out);
     WRITE(nb);
     
+    glyph=head->next;
     while(glyph)
     {
       WRITE(glyph->width);
@@ -187,7 +196,7 @@
       fwrite(glyph->code,slen,1,out);
       glyph=glyph->next;
     }
-    
+    printf("[Glyph] Saved %u glyphs\n",nb);
     fclose(out);
     return 1;
   
@@ -236,6 +245,7 @@
     
     fclose(out);
     *outNb=nbGlyphs;
+    printf("[Glyph] Loaded %u glyphs\n",nbGlyphs);
     return 1;
 
 }

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_ocr.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_ocr.cpp	2007-07-14 17:33:40 UTC (rev 3368)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_ocr.cpp	2007-07-14 18:28:27 UTC (rev 3369)
@@ -1,45 +1,31 @@
-//
-// C++ Implementation: %{MODULE}
-//
-// Description:
-//
-//
-// Author: %{AUTHOR} <%{EMAIL}>, (C) %{YEAR}
-//
-// Copyright: See COPYING file that comes with this distribution
-//
-//
+/*
+ * DO NOT EDIT THIS FILE - it is generated by Glade.
+ */
 
-#include <config.h>
+#ifdef HAVE_CONFIG_H
+#  include <config.h>
+#endif
 
+#include <sys/types.h>
+#include <sys/stat.h>
+#include <unistd.h>
+#include <string.h>
 #include <stdio.h>
-#include <math.h>
 
 #include <gdk/gdkkeysyms.h>
 #include <gtk/gtk.h>
 
-#include <gtk/gtk.h>
-
-#include "default.h"
 #include "ADM_toolkit_gtk/ADM_gladeSupport.h"
-#include "ADM_toolkit/toolkit.hxx"
 #include "ADM_toolkit_gtk/toolkit_gtk.h"
 #include "ADM_toolkit_gtk/toolkit_gtk_include.h"
-#include "ADM_assert.h" 
- GtkWidget	*DIA_ocr(void);
 
-GtkWidget *DIA_ocr (void)
+
+GtkWidget*
+DIA_ocr (void)
 {
   GtkWidget *dialog1;
   GtkWidget *dialog_vbox1;
   GtkWidget *vbox1;
-  GtkWidget *hbox1;
-  GtkWidget *vbox5;
-  GtkWidget *frameGlyph;
-  GtkWidget *vbox6;
-  GtkWidget *buttonGlyphLoad;
-  GtkWidget *buttonGlyphSave;
-  GtkWidget *label6;
   GtkWidget *frame5;
   GtkWidget *table1;
   GtkWidget *label8;
@@ -47,20 +33,6 @@
   GtkWidget *labelNbGlyphs;
   GtkWidget *labelNbLines;
   GtkWidget *label7;
-  GtkWidget *frameLoad;
-  GtkWidget *vbox2;
-  GtkWidget *frame2;
-  GtkWidget *vbox3;
-  GtkWidget *labelVobsub;
-  GtkWidget *buttonVobsub;
-  GtkWidget *label2;
-  GtkWidget *frame3;
-  GtkWidget *vbox4;
-  GtkWidget *labelSrt;
-  GtkWidget *buttonSrt;
-  GtkWidget *label4;
-  GtkWidget *label1;
-  GtkWidget *buttonStart;
   GtkWidget *frameBitmap;
   GtkWidget *vbox7;
   GtkWidget *drawingareaBitmap;
@@ -83,6 +55,7 @@
 
   dialog1 = gtk_dialog_new ();
   gtk_window_set_title (GTK_WINDOW (dialog1), _("Mini OCR"));
+  gtk_window_set_type_hint (GTK_WINDOW (dialog1), GDK_WINDOW_TYPE_HINT_DIALOG);
 
   dialog_vbox1 = GTK_DIALOG (dialog1)->vbox;
   gtk_widget_show (dialog_vbox1);
@@ -91,39 +64,9 @@
   gtk_widget_show (vbox1);
   gtk_box_pack_start (GTK_BOX (dialog_vbox1), vbox1, TRUE, TRUE, 0);
 
-  hbox1 = gtk_hbox_new (FALSE, 0);
-  gtk_widget_show (hbox1);
-  gtk_box_pack_start (GTK_BOX (vbox1), hbox1, TRUE, TRUE, 0);
-
-  vbox5 = gtk_vbox_new (FALSE, 0);
-  gtk_widget_show (vbox5);
-  gtk_box_pack_start (GTK_BOX (hbox1), vbox5, TRUE, TRUE, 0);
-
-  frameGlyph = gtk_frame_new (NULL);
-  gtk_widget_show (frameGlyph);
-  gtk_box_pack_start (GTK_BOX (vbox5), frameGlyph, FALSE, FALSE, 0);
-
-  vbox6 = gtk_vbox_new (FALSE, 0);
-  gtk_widget_show (vbox6);
-  gtk_container_add (GTK_CONTAINER (frameGlyph), vbox6);
-
-  buttonGlyphLoad = gtk_button_new_from_stock ("gtk-open");
-  gtk_widget_show (buttonGlyphLoad);
-  gtk_box_pack_start (GTK_BOX (vbox6), buttonGlyphLoad, FALSE, FALSE, 0);
-
-  buttonGlyphSave = gtk_button_new_from_stock ("gtk-save");
-  gtk_widget_show (buttonGlyphSave);
-  gtk_box_pack_start (GTK_BOX (vbox6), buttonGlyphSave, FALSE, FALSE, 0);
-
-  label6 = gtk_label_new (_("<b>Glyphs</b>"));
-  gtk_widget_show (label6);
-  gtk_frame_set_label_widget (GTK_FRAME (frameGlyph), label6);
-  gtk_label_set_use_markup (GTK_LABEL (label6), TRUE);
-  gtk_label_set_justify (GTK_LABEL (label6), GTK_JUSTIFY_LEFT);
-
   frame5 = gtk_frame_new (NULL);
   gtk_widget_show (frame5);
-  gtk_box_pack_start (GTK_BOX (vbox5), frame5, FALSE, FALSE, 0);
+  gtk_box_pack_start (GTK_BOX (vbox1), frame5, FALSE, FALSE, 0);
 
   table1 = gtk_table_new (2, 2, FALSE);
   gtk_widget_show (table1);
@@ -134,7 +77,6 @@
   gtk_table_attach (GTK_TABLE (table1), label8, 0, 1, 0, 1,
                     (GtkAttachOptions) (0),
                     (GtkAttachOptions) (0), 0, 0);
-  gtk_label_set_justify (GTK_LABEL (label8), GTK_JUSTIFY_LEFT);
   gtk_misc_set_alignment (GTK_MISC (label8), 0, 0.5);
 
   label9 = gtk_label_new (_("# of lines"));
@@ -142,7 +84,6 @@
   gtk_table_attach (GTK_TABLE (table1), label9, 0, 1, 1, 2,
                     (GtkAttachOptions) (0),
                     (GtkAttachOptions) (0), 0, 0);
-  gtk_label_set_justify (GTK_LABEL (label9), GTK_JUSTIFY_LEFT);
   gtk_misc_set_alignment (GTK_MISC (label9), 0, 0.5);
 
   labelNbGlyphs = gtk_label_new (_("0"));
@@ -150,7 +91,6 @@
   gtk_table_attach (GTK_TABLE (table1), labelNbGlyphs, 1, 2, 0, 1,
                     (GtkAttachOptions) (0),
                     (GtkAttachOptions) (0), 0, 0);
-  gtk_label_set_justify (GTK_LABEL (labelNbGlyphs), GTK_JUSTIFY_LEFT);
   gtk_misc_set_alignment (GTK_MISC (labelNbGlyphs), 0, 0.5);
 
   labelNbLines = gtk_label_new (_("0"));
@@ -158,77 +98,13 @@
   gtk_table_attach (GTK_TABLE (table1), labelNbLines, 1, 2, 1, 2,
                     (GtkAttachOptions) (0),
                     (GtkAttachOptions) (0), 0, 0);
-  gtk_label_set_justify (GTK_LABEL (labelNbLines), GTK_JUSTIFY_LEFT);
   gtk_misc_set_alignment (GTK_MISC (labelNbLines), 0, 0.5);
 
   label7 = gtk_label_new (_("<b>Stats</b>"));
   gtk_widget_show (label7);
   gtk_frame_set_label_widget (GTK_FRAME (frame5), label7);
   gtk_label_set_use_markup (GTK_LABEL (label7), TRUE);
-  gtk_label_set_justify (GTK_LABEL (label7), GTK_JUSTIFY_LEFT);
 
-  frameLoad = gtk_frame_new (NULL);
-  gtk_widget_show (frameLoad);
-  gtk_box_pack_start (GTK_BOX (hbox1), frameLoad, TRUE, TRUE, 0);
-
-  vbox2 = gtk_vbox_new (FALSE, 0);
-  gtk_widget_show (vbox2);
-  gtk_container_add (GTK_CONTAINER (frameLoad), vbox2);
-
-  frame2 = gtk_frame_new (NULL);
-  gtk_widget_show (frame2);
-  gtk_box_pack_start (GTK_BOX (vbox2), frame2, FALSE, FALSE, 0);
-
-  vbox3 = gtk_vbox_new (FALSE, 0);
-  gtk_widget_show (vbox3);
-  gtk_container_add (GTK_CONTAINER (frame2), vbox3);
-
-  labelVobsub = gtk_label_new (_("  "));
-  gtk_widget_show (labelVobsub);
-  gtk_box_pack_start (GTK_BOX (vbox3), labelVobsub, FALSE, FALSE, 0);
-  gtk_label_set_justify (GTK_LABEL (labelVobsub), GTK_JUSTIFY_LEFT);
-
-  buttonVobsub = gtk_button_new_from_stock ("gtk-open");
-  gtk_widget_show (buttonVobsub);
-  gtk_box_pack_start (GTK_BOX (vbox3), buttonVobsub, FALSE, FALSE, 0);
-
-  label2 = gtk_label_new (_("VobSub"));
-  gtk_widget_show (label2);
-  gtk_frame_set_label_widget (GTK_FRAME (frame2), label2);
-  gtk_label_set_justify (GTK_LABEL (label2), GTK_JUSTIFY_LEFT);
-
-  frame3 = gtk_frame_new (NULL);
-  gtk_widget_show (frame3);
-  gtk_box_pack_start (GTK_BOX (vbox2), frame3, FALSE, FALSE, 0);
-
-  vbox4 = gtk_vbox_new (FALSE, 0);
-  gtk_widget_show (vbox4);
-  gtk_container_add (GTK_CONTAINER (frame3), vbox4);
-
-  labelSrt = gtk_label_new (_(" "));
-  gtk_widget_show (labelSrt);
-  gtk_box_pack_start (GTK_BOX (vbox4), labelSrt, FALSE, FALSE, 0);
-  gtk_label_set_justify (GTK_LABEL (labelSrt), GTK_JUSTIFY_LEFT);
-
-  buttonSrt = gtk_button_new_from_stock ("gtk-save");
-  gtk_widget_show (buttonSrt);
-  gtk_box_pack_start (GTK_BOX (vbox4), buttonSrt, FALSE, FALSE, 0);
-
-  label4 = gtk_label_new (_("Output Srt"));
-  gtk_widget_show (label4);
-  gtk_frame_set_label_widget (GTK_FRAME (frame3), label4);
-  gtk_label_set_justify (GTK_LABEL (label4), GTK_JUSTIFY_LEFT);
-
-  label1 = gtk_label_new (_("<b>Files</b>"));
-  gtk_widget_show (label1);
-  gtk_frame_set_label_widget (GTK_FRAME (frameLoad), label1);
-  gtk_label_set_use_markup (GTK_LABEL (label1), TRUE);
-  gtk_label_set_justify (GTK_LABEL (label1), GTK_JUSTIFY_LEFT);
-
-  buttonStart = gtk_button_new_with_mnemonic (_("StartOcr"));
-  gtk_widget_show (buttonStart);
-  gtk_box_pack_start (GTK_BOX (vbox1), buttonStart, FALSE, FALSE, 0);
-
   frameBitmap = gtk_frame_new (NULL);
   gtk_widget_show (frameBitmap);
   gtk_box_pack_start (GTK_BOX (vbox1), frameBitmap, FALSE, FALSE, 0);
@@ -251,7 +127,6 @@
   gtk_table_attach (GTK_TABLE (table2), label13, 0, 1, 0, 1,
                     (GtkAttachOptions) (GTK_FILL),
                     (GtkAttachOptions) (0), 0, 0);
-  gtk_label_set_justify (GTK_LABEL (label13), GTK_JUSTIFY_LEFT);
   gtk_misc_set_alignment (GTK_MISC (label13), 0, 0.5);
 
   drawingareaSmall = gtk_drawing_area_new ();
@@ -265,7 +140,6 @@
   gtk_table_attach (GTK_TABLE (table2), label14, 1, 2, 0, 1,
                     (GtkAttachOptions) (GTK_FILL),
                     (GtkAttachOptions) (0), 0, 0);
-  gtk_label_set_justify (GTK_LABEL (label14), GTK_JUSTIFY_LEFT);
   gtk_misc_set_alignment (GTK_MISC (label14), 0, 0.5);
 
   labelText = gtk_label_new (_(" "));
@@ -273,7 +147,6 @@
   gtk_table_attach (GTK_TABLE (table2), labelText, 1, 2, 1, 2,
                     (GtkAttachOptions) (GTK_FILL),
                     (GtkAttachOptions) (0), 0, 0);
-  gtk_label_set_justify (GTK_LABEL (labelText), GTK_JUSTIFY_LEFT);
   gtk_misc_set_alignment (GTK_MISC (labelText), 0, 0.5);
 
   entry = gtk_entry_new ();
@@ -317,7 +190,6 @@
   gtk_widget_show (label12);
   gtk_frame_set_label_widget (GTK_FRAME (frameBitmap), label12);
   gtk_label_set_use_markup (GTK_LABEL (label12), TRUE);
-  gtk_label_set_justify (GTK_LABEL (label12), GTK_JUSTIFY_LEFT);
 
   dialog_action_area1 = GTK_DIALOG (dialog1)->action_area;
   gtk_widget_show (dialog_action_area1);
@@ -332,13 +204,6 @@
   GLADE_HOOKUP_OBJECT_NO_REF (dialog1, dialog1, "dialog1");
   GLADE_HOOKUP_OBJECT_NO_REF (dialog1, dialog_vbox1, "dialog_vbox1");
   GLADE_HOOKUP_OBJECT (dialog1, vbox1, "vbox1");
-  GLADE_HOOKUP_OBJECT (dialog1, hbox1, "hbox1");
-  GLADE_HOOKUP_OBJECT (dialog1, vbox5, "vbox5");
-  GLADE_HOOKUP_OBJECT (dialog1, frameGlyph, "frameGlyph");
-  GLADE_HOOKUP_OBJECT (dialog1, vbox6, "vbox6");
-  GLADE_HOOKUP_OBJECT (dialog1, buttonGlyphLoad, "buttonGlyphLoad");
-  GLADE_HOOKUP_OBJECT (dialog1, buttonGlyphSave, "buttonGlyphSave");
-  GLADE_HOOKUP_OBJECT (dialog1, label6, "label6");
   GLADE_HOOKUP_OBJECT (dialog1, frame5, "frame5");
   GLADE_HOOKUP_OBJECT (dialog1, table1, "table1");
   GLADE_HOOKUP_OBJECT (dialog1, label8, "label8");
@@ -346,20 +211,6 @@
   GLADE_HOOKUP_OBJECT (dialog1, labelNbGlyphs, "labelNbGlyphs");
   GLADE_HOOKUP_OBJECT (dialog1, labelNbLines, "labelNbLines");
   GLADE_HOOKUP_OBJECT (dialog1, label7, "label7");
-  GLADE_HOOKUP_OBJECT (dialog1, frameLoad, "frameLoad");
-  GLADE_HOOKUP_OBJECT (dialog1, vbox2, "vbox2");
-  GLADE_HOOKUP_OBJECT (dialog1, frame2, "frame2");
-  GLADE_HOOKUP_OBJECT (dialog1, vbox3, "vbox3");
-  GLADE_HOOKUP_OBJECT (dialog1, labelVobsub, "labelVobsub");
-  GLADE_HOOKUP_OBJECT (dialog1, buttonVobsub, "buttonVobsub");
-  GLADE_HOOKUP_OBJECT (dialog1, label2, "label2");
-  GLADE_HOOKUP_OBJECT (dialog1, frame3, "frame3");
-  GLADE_HOOKUP_OBJECT (dialog1, vbox4, "vbox4");
-  GLADE_HOOKUP_OBJECT (dialog1, labelSrt, "labelSrt");
-  GLADE_HOOKUP_OBJECT (dialog1, buttonSrt, "buttonSrt");
-  GLADE_HOOKUP_OBJECT (dialog1, label4, "label4");
-  GLADE_HOOKUP_OBJECT (dialog1, label1, "label1");
-  GLADE_HOOKUP_OBJECT (dialog1, buttonStart, "buttonStart");
   GLADE_HOOKUP_OBJECT (dialog1, frameBitmap, "frameBitmap");
   GLADE_HOOKUP_OBJECT (dialog1, vbox7, "vbox7");
   GLADE_HOOKUP_OBJECT (dialog1, drawingareaBitmap, "drawingareaBitmap");

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_ocr/adm_ocr.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_ocr/adm_ocr.cpp	2007-07-14 17:33:40 UTC (rev 3368)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_ocr/adm_ocr.cpp	2007-07-14 18:28:27 UTC (rev 3369)
@@ -73,12 +73,6 @@
 #define TESTSUB "/home/fx/usbstick/subs/vts_01_0.idx"
 #define CONNECT(x,y,z) 	gtk_signal_connect(GTK_OBJECT(WID(x)), #y,GTK_SIGNAL_FUNC(z),   NULL);
 
-
-
-
-
-
-
 extern  uint8_t DIA_vobsub(vobSubParam *param);
 //********************************************
 extern  GtkWidget *DIA_ocr(void);
@@ -87,20 +81,19 @@
 static void       displaySmall( admGlyph *glyph );
 static int        cb_accept(GtkObject * object, gpointer user_data);
 
-static GtkWidget *dialog;
-static GtkWidget *mainDisplay;
-static GtkWidget *smallDisplay;
+static GtkWidget *dialog=NULL;
+static GtkWidget *mainDisplay=NULL;
+static GtkWidget *smallDisplay=NULL;
 static uint32_t redraw_x,redraw_y;
 //********************************************
-ReplyType glyphToText(admGlyph *glyph);
+//ReplyType glyphToText(admGlyph *glyph,admGlyph *head);
 static ReplyType setup(void);
 //********************************************
-static uint8_t ocrSaveGlyph(void);
-static  vobSubParam subparam={NULL,0,0};
+static uint8_t ocrSaveGlyph(admGlyph *head);
+
 static uint8_t *workArea;
 static vobSubBitmap *bitmap;
-static admGlyph head(250,4);
-static uint32_t lang_index=0;
+static uint8_t *sdata=NULL;
 static uint32_t nbGlyphs;
 static char decodedString[1024];
 
@@ -120,12 +113,12 @@
 /* +++++++++++++++++++++++++++++++++++++++++++++++++++++++
         Main
    +++++++++++++++++++++++++++++++++++++++++++++++++++++++ */
-uint8_t ADM_ocr_engine( void)
+   
+uint8_t ADM_ocr_engine(  vobSubParam *subparam,const char *labelSrt,admGlyph *head)
 {
 // 
     uint32_t nbSub=0;
     FILE *out=NULL;
-    head.next=NULL;
     ADMVideoVobSub *vobsub=NULL;
     uint32_t startTime,endTime;
     uint32_t w,h,oldw=0,oldh=0;
@@ -134,27 +127,30 @@
     uint32_t first,last;
     uint32_t seqNum;
     char     text[1024];
-    lang_index=0;
     nbGlyphs=0;
     ReplyType reply;
     
+    dialog=NULL;
+    mainDisplay=NULL;
+    smallDisplay=NULL;
+    workArea=NULL;
+    bitmap=NULL;
+    sdata=NULL;
+    
+
+    
 // Create UI && prepare callback
     
     dialog=DIA_ocr();
     gtk_register_dialog(dialog);
 #define ASSOCIATE(x,y)   gtk_dialog_add_action_widget (GTK_DIALOG (dialog), WID(x),y)
-    ASSOCIATE(buttonStart,actionGo);
+    
     ASSOCIATE(buttonOk,   actionAccept);
     ASSOCIATE(buttonSkip,     actionSkip);
     ASSOCIATE(buttonSkipAll,     actionSkipAll);
     ASSOCIATE(buttonIgnore,   actionIgnore);
     ASSOCIATE(buttonCalibrate,   actionCalibrate);
     
-    ASSOCIATE(buttonGlyphLoad,   actionLoadGlyph);
-    ASSOCIATE(buttonGlyphSave,   actionSaveGlyph);
-    
-    ASSOCIATE(buttonVobsub,   actionLoadVob);
-    ASSOCIATE(buttonSrt,   actionSaveSub);
    
     gtk_widget_show(dialog);
 //  disable
@@ -167,8 +163,6 @@
 
     CONNECT(entry,activate,cb_accept);
 _again:    
-    reply=setup();
-    if(reply==ReplyClose) goto endIt;
     
     printf("Go go go\n");
     
@@ -177,30 +171,17 @@
     redraw_x=redraw_y=0;
     UI_purge();
 //  Time to go
-    // Inactivate frame1=glyph    frame2=in/out  buttonStart
-    gtk_widget_set_sensitive(WID(buttonStart),0);
-    gtk_widget_set_sensitive(WID(frameGlyph),0);
-    gtk_widget_set_sensitive(WID(frameLoad),0);
+    
     gtk_widget_set_sensitive(WID(frameBitmap),1);
-
-    gtk_widget_set_sensitive(WID(buttonStart),0);
-   
-  
-   char *fileout;
-   fileout=(char *)gtk_label_get_text(GTK_LABEL(WID(labelSrt)));
-   if(!fileout)
-    {
-      GUI_Error_HIG(_("Incorrect output file"), NULL);
-        goto _again;
-    }
-    out=fopen(fileout,"wb");
+ 
+    out=fopen(labelSrt,"wb");
     if(!out)
     {
-      GUI_Error_HIG(_("Output file error"), _("Could not open \"%s\" for writing."), fileout);
-        goto _again;
+       GUI_Error_HIG(_("Output file error"), _("Could not open \"%s\" for writing."), labelSrt);
+       goto endIt;
     }
      
-    vobsub=new ADMVideoVobSub(subparam.subname,subparam.index);
+    vobsub=new ADMVideoVobSub(subparam->subname,subparam->index);
     nbSub=vobsub->getNbImage();
    
     if(!nbSub)
@@ -259,7 +240,7 @@
              gui_draw();
              UI_purge();
              // OCR
-              reply=ocrBitmap(workArea,w,h,decodedString);
+              reply=ocrBitmap(workArea,w,h,decodedString,head);
               if(reply==ReplyClose) goto endIt;
               if(reply==ReplyCalibrate)
                 {
@@ -290,16 +271,8 @@
 
 endIt:
     // Final round
-    gtk_widget_set_sensitive(WID(frameGlyph),1);
-    gtk_widget_set_sensitive(WID(frameLoad),0);
-    gtk_widget_set_sensitive(WID(buttonStart),0);  
     gtk_widget_set_sensitive(WID(frameBitmap),0);
-   // gtk_widget_set_sensitive(WID(Current_Glyph),0); 
-    
-    if(nbGlyphs && actionSaveGlyph==gtk_dialog_run(GTK_DIALOG(dialog)))
-    {
-      ocrSaveGlyph();
-    }
+   // gtk_widget_set_sensitive(WID(Current_Glyph),0);     
     if(vobsub)
         delete vobsub;
     vobsub=NULL;
@@ -308,9 +281,7 @@
     out=NULL;
     gtk_unregister_dialog(dialog);
     gtk_widget_destroy(dialog);
-    if(head.next)
-        destroyGlyphTree(&head);
-    head.next=NULL;
+
     return 1;
 
 }
@@ -318,13 +289,13 @@
     \fn ocrSaveGlyph
     \brief bridge to saveGlyph
 */
-uint8_t ocrSaveGlyph(void)
+uint8_t ocrSaveGlyph(admGlyph *head)
 {
   char *name=NULL;
           GUI_FileSelWrite(_("Select Glyphfile to save to"), &name);
         if(!name)
             return 0;
-        saveGlyph(name,&head,nbGlyphs);
+        saveGlyph(name,head,nbGlyphs);
         ADM_dealloc(name);
         return 1;
 
@@ -334,7 +305,7 @@
         Search throught the existing glyphs , if not present create it
         and append the text to decodedString
 */
-ReplyType glyphToText(admGlyph *glyph)
+ReplyType glyphToText(admGlyph *glyph,admGlyph *head)
 {
  admGlyph *cand;
             //printf("2t: %d x %d\n",glyph->width,glyph->height);
@@ -343,7 +314,7 @@
                 delete glyph;
                 return ReplyOk;
             }
-            cand=searchGlyph(&head,glyph);
+            cand=searchGlyph(head,glyph);
             if(!cand) // New glyph
             {
                 char *string;
@@ -364,7 +335,7 @@
                 {
                 case actionIgnore:
                         glyph->code=NULL;
-                        insertInGlyphTree(&head,glyph);
+                        insertInGlyphTree(head,glyph);
                         nbGlyphs++;
                         break;
                 case actionCalibrate: return ReplyCalibrate;
@@ -373,7 +344,7 @@
                     if(string&& strlen(string))
                     {
                         glyph->code=ADM_strdup(string);
-                        insertInGlyphTree(&head,glyph);
+                        insertInGlyphTree(head,glyph);
                         //printf("New glyph:%s\n",glyph->code);
                         strcat(decodedString,glyph->code);
                         nbGlyphs++;
@@ -429,7 +400,7 @@
 }
 //*****************************************************************************************
  static int sx=0,sy=0,sw=0,sh=0;
- uint8_t *sdata=NULL;
+
 void displaySmall( admGlyph *glyph)
 {
     if(sw!=glyph->width || sh!=glyph->height)
@@ -479,88 +450,7 @@
     return true;
 }
 
-/******************************************************************************************
- Setup (input/output files etc..)
-*****************************************************************************************/
-ReplyType setup(void)
-{
-int sel;
-char text[1024];
-    while(1)
-    {
-    //gtk_widget_set_sensitive(WID(buttonAccept),0);
-    //gtk_widget_set_sensitive(WID(buttonSkip),0);
-    //gtk_widget_set_sensitive(WID(entryEntry),0);
-    UI_purge();
-    // Main loop : Only accept glyph load/save
-    // Sub & srt select & start ocr
-    gtk_widget_set_sensitive(WID(frameGlyph),1);
-    gtk_widget_set_sensitive(WID(frameLoad),1);
-    gtk_widget_set_sensitive(WID(buttonStart),1);
-    
-    gtk_widget_set_sensitive(WID(frameBitmap),0);
-    //gtk_widget_set_sensitive(WID(Current_Glyph),0); 
-     switch(sel=gtk_dialog_run(GTK_DIALOG(dialog)))
-     {
-        case actionLoadVob:
-                {
-                   
-                        subparam.index=lang_index;
-                        subparam.subname=NULL;
-                        if(DIA_vobsub(&subparam))
-                        {
-                            lang_index=subparam.index;
-                            gtk_label_set_text(GTK_LABEL(WID(labelVobsub)),subparam.subname);
-                        }
-                        
-                    
-                }
-                break;
-        case actionSaveSub:
-                {
-                    char *srt=NULL;
-                    GUI_FileSelWrite(_("Select SRT to save"), &srt);
-                    if(srt)
-                    {
-                        gtk_label_set_text(GTK_LABEL(WID(labelSrt)),srt);
-                    }
-                }
-                break;
-        
-        case actionLoadGlyph:
-            {
-                 char *gly=NULL;
-                    
-                    GUI_FileSelRead(_("Select Glyoh to save"), &gly);
-                    if(gly)
-                    {
-                            loadGlyph(gly,&head,&nbGlyphs);
-                            sprintf(text,"%03d",nbGlyphs);
-                            gtk_label_set_text(GTK_LABEL(WID(labelNbGlyphs)),text);
-                    }
-            }
-                break;
-        
-        case actionSaveGlyph:
-            
-                    if(!nbGlyphs)
-                    {
-                      GUI_Error_HIG(_("No glyphs to save"), NULL);
-                        break;
-                    }                  
-                    ocrSaveGlyph();
-                        break;
-        
-        case GTK_RESPONSE_CLOSE: 
-            printf("Close req\n");
-            return ReplyClose;
-        default:
-            printf("Other input:%d\n",sel);
-     }
-    // Everything selected, check
-    if(sel==actionGo) return ReplyOk;
-    }
-}
+
 /**
     \fn cb_accept
     \brief Bridge between dialog/Accept and gtk signals

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_NONE/ADM_dialog/DIA_none.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_NONE/ADM_dialog/DIA_none.cpp	2007-07-14 17:33:40 UTC (rev 3368)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_NONE/ADM_dialog/DIA_none.cpp	2007-07-14 18:28:27 UTC (rev 3369)
@@ -159,4 +159,9 @@
     printf("*********************************\n");
 }
 uint8_t DIA_glyphEdit(void) {return 0;};
+#include "ADM_ocr/adm_glyph.h"
+uint8_t ADM_ocr_engine(  vobSubParam *subparam,const char *labelSrt,admGlyph *head)
+{
+  return 0; 
+}
 //EOF

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_none.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_none.cpp	2007-07-14 17:33:40 UTC (rev 3368)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_none.cpp	2007-07-14 18:28:27 UTC (rev 3369)
@@ -103,5 +103,11 @@
 {
   return 0; 
 }
+#include "ADM_ocr/adm_glyph.h"
+uint8_t ADM_ocr_engine(  vobSubParam *subparam,const char *labelSrt,admGlyph *head)
+{
+  return 0; 
+}
+
 //EOF
 

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/CMakeLists.txt
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/CMakeLists.txt	2007-07-14 17:33:40 UTC (rev 3368)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/CMakeLists.txt	2007-07-14 18:28:27 UTC (rev 3369)
@@ -9,11 +9,11 @@
 DIA_audioFilter.cpp   DIA_enter.cpp           DIA_flyCrop.cpp      DIA_gototime.cpp    DIA_postproc.cpp  DIA_srt.cpp        GUI_render.cpp
 DIA_bitrateHisto.cpp  DIA_flyAsharp.cpp       DIA_flyDialog.cpp    DIA_lavcodec.cpp    DIA_prefs.cpp     DIA_SVCD.cpp       GUI_sdlRender.cpp
 DIA_builtin.cpp       DIA_flyChromaShift.cpp  DIA_flyHue.cpp       DIA_lavDecoder.cpp  DIA_requant.cpp   DIA_tdeint.cpp     GUI_xvRender.cpp
-DIA_animated.cpp
+DIA_animated.cpp      DIA_ocr.cpp
 )
 ADD_LIBRARY(${ADM_LIB} STATIC ${${ADM_LIB}_SRCS})
 ADD_ADM_LIB(${ADM_LIB} ADM_userInterfaces)
 
 ####################################"
-include_directories(./..)
+include_directories(./.. ./../../ADM_inputs)
 SDLify(GUI_sdlRender.cpp)

Copied: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp (from rev 3352, branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_flyAsharp.cpp)
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_flyAsharp.cpp	2007-07-09 14:04:04 UTC (rev 3352)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp	2007-07-14 18:28:27 UTC (rev 3369)
@@ -0,0 +1,178 @@
+/**/
+/***************************************************************************
+                          DIA_hue
+                             -------------------
+
+                           Ui for hue & sat
+
+    begin                : 08 Apr 2005
+    copyright            : (C) 2004/5 by mean
+    email                : fixounet at free.fr
+ ***************************************************************************/
+
+/***************************************************************************
+ *                                                                         *
+ *   This program is free software; you can redistribute it and/or modify  *
+ *   it under the terms of the GNU General Public License as published by  *
+ *   the Free Software Foundation; either version 2 of the License, or     *
+ *   (at your option) any later version.                                   *
+ *                                                                         *
+ ***************************************************************************/
+
+
+
+#include <config.h>
+
+
+#include <string.h>
+#include <stdio.h>
+#include <stdlib.h>
+#include <math.h>
+
+#include "default.h"
+
+
+#include "ADM_userInterfaces/ADM_commonUI/DIA_factory.h"
+#include "ADM_editor/ADM_edit.hxx"
+#include "ADM_video/ADM_genvideo.hxx"
+#include "ADM_filter/video_filters.h"
+
+#include "ADM_video/ADM_vobsubinfo.h"
+#include "ADM_video/ADM_vidVobSub.h"
+#include "ADM_ocr/ADM_ocr.h"
+#include "ADM_osSupport/ADM_misc.h"
+#include "ADM_toolkit/toolkit.hxx"
+#include "prefs.h"
+#include "ADM_assert.h"
+
+extern uint8_t DIA_vobsub(vobSubParam *param);
+extern uint8_t ADM_ocr_engine(  vobSubParam *subparam,const char *labelSrt,admGlyph *head);
+static void cb_idx(void *foo);
+static void cleanupSub(vobSubParam *p);
+/**
+    \fn DIA_ocrGen
+    \brief Dialog to select input & output files before calling the actual ocr engine
+*/
+uint8_t DIA_ocrGen(void)
+{
+
+  vobSubParam subparam={NULL,0,0};
+  char *srtFileName=NULL;
+  char *glyphFileName=NULL;
+  admGlyph head(16,16);
+  char *globalGlyph=NULL;
+  uint32_t globalGlyphOn=0;
+  prefs->get(FEATURE_GLOBAL_GLYPH,&globalGlyphOn);
+  if(globalGlyphOn)
+  {
+     prefs->get(FEATURE_GLOBAL_GLYPH_NAME,&globalGlyph);
+     if(!*globalGlyph)
+     {
+        ADM_dezalloc(globalGlyph);
+        globalGlyph=NULL; 
+     }
+  }
+
+  if(globalGlyph)
+  {
+    glyphFileName=globalGlyph;
+  }
+_again:  
+  // Fist build a dialogFactory to get input and output files
+  diaElemButton   selectIdx(_("Select idx file:"), cb_idx,&subparam,NULL);
+  diaElemFile     selectGlyph(1,&glyphFileName,_("Use glyphset (optional):"),NULL);  
+  diaElemFile     selectSrt(1,&srtFileName,_("Output SRT file"),NULL);
+  
+  diaElem *elems[]={&selectIdx,&selectSrt,&selectGlyph};
+  
+  
+   uint32_t n=3;
+   if(globalGlyph)
+   {
+     n--; // Remove glyph from dialog
+   }
+  
+        if( !diaFactoryRun(_("Select input and ouput files"),n,elems))
+        {
+          cleanupSub(&subparam);
+          if(srtFileName )ADM_dezalloc(srtFileName);
+          srtFileName=NULL;
+          destroyGlyphTree(&head);
+          return 0;
+        }
+        if(!ADM_fileExist(subparam.subname))
+        {
+          GUI_Error_HIG(_("File error"),_("The idx/sub file does not exist."));
+          goto _again; 
+        }
+        if(!srtFileName || !*srtFileName)
+        {
+          GUI_Error_HIG(_("File error"),_("Please Select a valid output SRT file."));
+          goto _again; 
+        }
+         if(glyphFileName && *glyphFileName)
+         {
+           if(!ADM_fileExist(glyphFileName))
+            {
+              GUI_Error_HIG(_("File error"),_("The idx/sub file does not exist."));
+              goto _again; 
+            }
+            // Purge previous glyph set if any
+            destroyGlyphTree(&head);
+            uint32_t nb;
+            printf("[OCR] Loading glyphset :<%s>\n",glyphFileName);
+            if(!loadGlyph(glyphFileName,&head,&nb))
+            {
+              GUI_Error_HIG(_("File error"),_("Cannot load the glyphset file."));
+              goto _again;               
+            }
+            printf("[GLYPH] Found %u glyph\n");
+         }
+        // We have our SRT and our idx/sub files : Go go go
+        ADM_ocr_engine(&subparam,srtFileName,&head);
+        
+        // Save glyph set 
+_save:
+        if(globalGlyph)
+        {
+          uint32_t nb=1;
+           saveGlyph(globalGlyph,&head,nb);
+        }else
+        {
+            char *save=NULL;
+            uint32_t nb=1;
+              diaElemFile     selectSave(1,&save,_("Glyphset filename"),NULL);
+              diaElem *elems2[]={&selectSave};
+            if( diaFactoryRun(_("Save Glyph"),1,elems2))
+            {
+              saveGlyph(save,&head,nb);
+            }
+            if(save) ADM_dezalloc(save);
+        }
+cleanup:
+  cleanupSub(&subparam);
+  if(srtFileName )ADM_dezalloc(srtFileName);
+  srtFileName=NULL;
+  destroyGlyphTree(&head);
+  return 1;  
+}
+/**
+
+*/
+void cleanupSub(vobSubParam *p)
+{
+  if(p->subname) ADM_dezalloc(p->subname);
+  p->subname=NULL; 
+  
+}
+/**
+
+*/
+void cb_idx(void *foo)
+{
+   vobSubParam *bar=(vobSubParam *)foo;
+   
+    cleanupSub(bar);
+    DIA_vobsub(bar);
+}
+//EOF

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp	2007-07-14 17:33:40 UTC (rev 3368)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp	2007-07-14 18:28:27 UTC (rev 3369)
@@ -79,6 +79,10 @@
 uint32_t pp_type=3;
 uint32_t pp_value=5;
 uint32_t hzd,vzd,dring;
+
+uint32_t useGlobalGlyph=0;
+char     *globalGlyphName=NULL;
+
 	olddevice=newdevice=AVDM_getCurrentDevice();
 
         // Default pp
@@ -97,6 +101,9 @@
         prefs->get(FEATURE_AUTO_BUILDMAP,&autovbr);
         // autoindex
         prefs->get(FEATURE_AUTO_REBUILDINDEX,&autoindex);
+        // Global glyph
+        prefs->get(FEATURE_GLOBAL_GLYPH,&useGlobalGlyph);
+        prefs->get(FEATURE_GLOBAL_GLYPH_NAME,&globalGlyphName);
          // autoindex
         prefs->get(FEATURE_AUTO_UNPACK,&autounpack);
         // Alternate mp3 tag (haali)
@@ -294,7 +301,13 @@
                filterPath = ADM_strdup("c:\\");
 #endif
         diaElemDirSelect  entryFilterPath(&filterPath,_("_Filter directory:"),"");
-        
+        /*********************************/
+        diaMenuEntry globalGlyhEntries[]={
+                             {0,       _("No"),NULL}
+                             ,{1,      _("Yes"),NULL}};
+        diaElemMenu  menuGlobaGlyh(&useGlobalGlyph,_("Use _Global GlyphSet:"), sizeof(globalGlyhEntries)/sizeof(diaMenuEntry),globalGlyhEntries,"");
+        diaElemFile  entryGLyphPath(0,&globalGlyphName,_("Gl_yphSet:"),"");
+        menuGlobaGlyh.link(&(globalGlyhEntries[1]),1,&entryGLyphPath);
         /**********************************************************************/
         /* First Tab : user interface */
         diaElem *diaUser[]={&useSysTray,&menuMessage};
@@ -325,14 +338,23 @@
         diaElem *diaCpu[]={&multiThread, &menuEncodePriority, &menuIndexPriority, &menuPlaybackPriority};
         diaElemTabs tabCpu("CPU",4,(diaElem **)diaCpu);
         
-        /* seventh Tab : Xfilter */
+        /* 7th Tab : Global Glyph */
+        diaElem *diaGlyph[]={&menuGlobaGlyh,&entryGLyphPath};
+        diaElemTabs tabGlyph(_("Global Glyphset"),2,(diaElem **)diaGlyph);
+        
+        
+        /* 8th Tab : Xfilter */
         diaElem *diaXFilter[]={&loadEx,&entryFilterPath};
         diaElemTabs tabXfilter(_("External Filters"),2,(diaElem **)diaXFilter);
                                     
 // SET
-        diaElemTabs *tabs[]={&tabUser,&tabAuto,&tabInput,&tabOutput,&tabAudio,&tabVideo,&tabCpu,&tabXfilter};
-        if( diaFactoryRunTabs(_("Preferences"),8,tabs))
+        diaElemTabs *tabs[]={&tabUser,&tabAuto,&tabInput,&tabOutput,&tabAudio,&tabVideo,&tabCpu,&tabGlyph,&tabXfilter};
+        if( diaFactoryRunTabs(_("Preferences"),9,tabs))
 	{
+               prefs->set(FEATURE_GLOBAL_GLYPH,useGlobalGlyph);
+                prefs->set(FEATURE_GLOBAL_GLYPH_NAME,globalGlyphName);
+
+          
 		ret=1;
                 // Postproc
                 #undef DOME

Modified: branches/avidemux_2.4_branch/avidemux/CMakeLists.txt
===================================================================
--- branches/avidemux_2.4_branch/avidemux/CMakeLists.txt	2007-07-14 17:33:40 UTC (rev 3368)
+++ branches/avidemux_2.4_branch/avidemux/CMakeLists.txt	2007-07-14 18:28:27 UTC (rev 3369)
@@ -202,15 +202,16 @@
 
 
 TARGET_LINK_LIBRARIES(avidemux2_cli ADM_commonUI )
+TARGET_LINK_LIBRARIES(avidemux2_cli ADM_ocr )
 TARGET_LINK_LIBRARIES(avidemux2_cli ADM_dialogNone )
 TARGET_LINK_LIBRARIES(avidemux2_cli ADM_dialogFactoryNone )
 TARGET_LINK_LIBRARIES(avidemux2_cli ADM_dialogFiltersNone )
 TARGET_LINK_LIBRARIES(avidemux2_cli ADM_dialogGuiNone )
 
 if(GTK_FOUND)
+TARGET_LINK_LIBRARIES(avidemux2_gtk ADM_commonUI )
 TARGET_LINK_LIBRARIES(avidemux2_gtk ADM_ocrGtk )
 TARGET_LINK_LIBRARIES(avidemux2_gtk ADM_ocr )
-TARGET_LINK_LIBRARIES(avidemux2_gtk ADM_commonUI )
 TARGET_LINK_LIBRARIES(avidemux2_gtk ADM_dialogGtk )
 TARGET_LINK_LIBRARIES(avidemux2_gtk ADM_filtersGtk )
 TARGET_LINK_LIBRARIES(avidemux2_gtk ADM_dialogFactoryGtk )
@@ -220,8 +221,8 @@
 endif(GTK_FOUND)
 
 if(QT4_FOUND)
+TARGET_LINK_LIBRARIES(avidemux2_qt4 ADM_commonUI )
 TARGET_LINK_LIBRARIES(avidemux2_qt4 ADM_ocr )
-TARGET_LINK_LIBRARIES(avidemux2_qt4 ADM_commonUI )
 TARGET_LINK_LIBRARIES(avidemux2_qt4 ADM_dialogQt4 )
 
 TARGET_LINK_LIBRARIES(avidemux2_qt4 ADM_dialogFactoryQt4 )

Modified: branches/avidemux_2.4_branch/avidemux/gtk_gui.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/gtk_gui.cpp	2007-07-14 17:33:40 UTC (rev 3368)
+++ branches/avidemux_2.4_branch/avidemux/gtk_gui.cpp	2007-07-14 18:28:27 UTC (rev 3369)
@@ -151,6 +151,7 @@
 int ignore_change;
 
 extern uint8_t ADM_ocr_engine( void);
+extern uint8_t DIA_ocrGen(void);
 uint8_t A_TimeShift(void);
 PARAM_MUX muxMode = MUX_REGULAR;
 int muxParam = 0;
@@ -229,7 +230,8 @@
         case ACT_ViewMain: UI_toogleMain();return;
         case ACT_ViewSide: UI_toogleSide();return;
       case ACT_Ocr:
-                ADM_ocr_engine( );
+                DIA_ocrGen(); //
+                //ADM_ocr_engine( );
                 return;
       case ACT_AudioConfigure:
     		audioCodecSelect();

Modified: branches/avidemux_2.4_branch/avidemux/prefs.h
===================================================================
--- branches/avidemux_2.4_branch/avidemux/prefs.h	2007-07-14 17:33:40 UTC (rev 3368)
+++ branches/avidemux_2.4_branch/avidemux/prefs.h	2007-07-14 18:28:27 UTC (rev 3369)
@@ -81,6 +81,8 @@
 	FILTERS_AUTOLOAD_PATH,
 	FILTERS_AUTOLOAD_ACTIVE,
 	FEATURE_ALTERNATE_MP3_TAG,
+	FEATURE_GLOBAL_GLYPH,
+	FEATURE_GLOBAL_GLYPH_NAME,
 	PRIORITY_ENCODING,
 	PRIORITY_INDEXING,
 	PRIORITY_PLAYBACK

Modified: branches/avidemux_2.4_branch/avidemux/prefs.in
===================================================================
--- branches/avidemux_2.4_branch/avidemux/prefs.in	2007-07-14 17:33:40 UTC (rev 3368)
+++ branches/avidemux_2.4_branch/avidemux/prefs.in	2007-07-14 18:28:27 UTC (rev 3369)
@@ -91,6 +91,9 @@
 filters.autoload.path,                  STRING, "/tmp/"
 filters.autoload.active,                UINT,   0,      0,      1
 feature.alternate_mp3_tag,              UINT,   1,      0,      1
+# Global glyphset file
+feature.global_glyph,                   UINT,   1,      0,      1
+feature.global_glyph.name,              STRING, ""
 # priority
 priority.encoding,          UINT,   3,      0,      4
 priority.indexing,          UINT,   3,      0,      4



From gruntster at mail.berlios.de  Sun Jul 15 00:27:40 2007
From: gruntster at mail.berlios.de (gruntster at mail.berlios.de)
Date: Sun, 15 Jul 2007 00:27:40 +0200
Subject: [Avidemux-svn-commit] r3370 -
	branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2
Message-ID: <200707142227.l6EMReJO010487@sheep.berlios.de>

Author: gruntster
Date: 2007-07-15 00:27:34 +0200 (Sun, 15 Jul 2007)
New Revision: 3370

Modified:
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_gtkRender.cpp
Log:
resize fix for Linux

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_gtkRender.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_gtkRender.cpp	2007-07-14 18:28:27 UTC (rev 3369)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_gtkRender.cpp	2007-07-14 22:27:34 UTC (rev 3370)
@@ -140,7 +140,7 @@
 	// Calculate zoom ratio
 	if (imageWidth > screenWidth || imageHeight > screenHeight)
 	{
-		if ((imageWidth - screenWidth) > (imageHeight - screenHeight))
+		if ((int)(imageWidth - screenWidth) > (int)(imageHeight - screenHeight))
 			return (float)screenWidth / (float)imageWidth;
 		else
 			return (float)screenHeight / (float)imageHeight;



From gruntster at mail.berlios.de  Sun Jul 15 01:44:38 2007
From: gruntster at mail.berlios.de (gruntster at mail.berlios.de)
Date: Sun, 15 Jul 2007 01:44:38 +0200
Subject: [Avidemux-svn-commit] r3371 - in
	branches/avidemux_2.4_branch/avidemux: ADM_libraries/ADM_utilities
	ADM_userInterfaces/ADM_GTK/ADM_dialog
Message-ID: <200707142344.l6ENichn028769@sheep.berlios.de>

Author: gruntster
Date: 2007-07-15 01:44:28 +0200 (Sun, 15 Jul 2007)
New Revision: 3371

Modified:
   branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_utilities/ADM_image.h
   branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_utilities/ADM_imageResizer.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_eq2.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_equalizer.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_mpdelogo.cpp
Log:
resize non-flyDialog filters for GTK

Modified: branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_utilities/ADM_image.h
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_utilities/ADM_image.h	2007-07-14 22:27:34 UTC (rev 3370)
+++ branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_utilities/ADM_image.h	2007-07-14 23:44:28 UTC (rev 3371)
@@ -165,6 +165,8 @@
 		~ADMImageResizer();
 		
 		uint8_t resize(ADMImage *src, ADMImage *dest);
+		uint8_t resize(uint8_t *src, ADMImage *dest);
+		uint8_t resize(ADMImage *src, uint8_t *dest);
 		uint8_t resize(uint8_t *src, uint8_t *dest);
 };
 

Modified: branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_utilities/ADM_imageResizer.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_utilities/ADM_imageResizer.cpp	2007-07-14 22:27:34 UTC (rev 3370)
+++ branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_utilities/ADM_imageResizer.cpp	2007-07-14 23:44:28 UTC (rev 3371)
@@ -89,6 +89,22 @@
 	return resize(source->data, dest->data);
 }
 
+uint8_t ADMImageResizer::resize(ADMImage *source, uint8_t *dest)
+{
+    ADM_assert(source->_width == orgWidth);
+    ADM_assert(source->_height == orgHeight);
+
+	return resize(source->data, dest);
+}
+
+uint8_t ADMImageResizer::resize(uint8_t *source, ADMImage *dest)
+{
+    ADM_assert(dest->_width == destWidth);
+    ADM_assert(dest->_height == destHeight);
+
+	return resize(source, dest->data);
+}
+
 uint8_t ADMImageResizer::resize(uint8_t *source, uint8_t *dest)
 {
 	uint8_t *src[3];

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_eq2.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_eq2.cpp	2007-07-14 22:27:34 UTC (rev 3370)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_eq2.cpp	2007-07-14 23:44:28 UTC (rev 3371)
@@ -21,31 +21,20 @@
 
 
 
-#include <config.h>
-
-
+#include "config.h"
 #include <string.h>
 #include <stdio.h>
-
 #include <gdk/gdkkeysyms.h>
 #include <gtk/gtk.h>
+#include <math.h>
 
-
-#include <gdk/gdkkeysyms.h>
-#include <gtk/gtk.h>
-# include <math.h>
 #include "default.h"
-
 #include "ADM_colorspace/ADM_rgb.h"
 #include "ADM_toolkit_gtk/ADM_gladeSupport.h"
 
-
-
-
 #include "ADM_toolkit_gtk/toolkit_gtk.h"
 #include "ADM_toolkit_gtk/toolkit_gtk_include.h"
 #include "ADM_toolkit/toolkit.hxx"
-#include "default.h"
 #include "ADM_image.h"
 #include "ADM_video/ADM_genvideo.hxx"
 
@@ -55,18 +44,21 @@
 
 #include "ADM_osSupport/ADM_cpuCap.h"
 
+extern "C" {
+#include "ADM_libraries/ADM_lavcodec/avcodec.h"
+}
 
-
 static GtkWidget*create_dialog1 (void);
 static float getAdj(GtkWidget *widget);
 static void setAdj(GtkWidget *widget,float val);
 
 static ADMImage *imgsrc,*imgdst,*imgdisplay;
 static GtkWidget *dialog=NULL;
-static uint32_t w,h;
+static uint32_t w,h,zoomW,zoomH;
 static uint32_t *rgbbuffer=NULL;
 static AVDMGenericVideoStream *incoming;
 static Eq2_Param myEq2;
+static ADMImageResizer *resizer=NULL;
 
 static void             update ( void);
 static gboolean         draw (void );
@@ -75,6 +67,9 @@
 static void frame_changed( void );
 static Eq2Settings mySettings;
 static ColYuvRgb    *rgbConv=NULL;
+
+extern float UI_calcZoomToFitScreen(GtkWindow* window, GtkWidget* drawingArea, uint32_t imageWidth, uint32_t imageHeight);
+
 /************************************************************************/
 uint8_t DIA_getEQ2Param(Eq2_Param *param, AVDMGenericVideoStream *in)
 {
@@ -88,8 +83,6 @@
         w=in->getInfo()->width;
         h=in->getInfo()->height;
 
-        rgbbuffer=new uint32_t[w*h];
-
         imgdst=new ADMImage(w,h);
         imgsrc=new ADMImage(w,h);
         imgdisplay=new ADMImage(w,h);
@@ -139,7 +132,20 @@
         HCONECT(GammaG);
         HCONECT(GammaB);
         
-        gtk_widget_set_usize(WID(drawingarea1), w,h);
+		float zoom = UI_calcZoomToFitScreen(GTK_WINDOW(dialog), WID(drawingarea1), w, h);
+
+		zoomW = w * zoom;
+		zoomH = h * zoom;
+		rgbbuffer=new uint32_t[zoomW*zoomH];
+
+		gtk_widget_set_usize(WID(drawingarea1), zoomW, zoomH);
+
+		if (zoom < 1)
+		{
+			gtk_window_set_position(GTK_WINDOW(dialog), GTK_WIN_POS_CENTER);
+			resizer = new ADMImageResizer(w, h, zoomW, zoomH, PIX_FMT_YUV420P, PIX_FMT_RGB32);
+		}
+
         gtk_signal_connect(GTK_OBJECT(WID(drawingarea1)), "expose_event", GTK_SIGNAL_FUNC(draw),   NULL);
         update();
         // run
@@ -159,6 +165,12 @@
         delete [] rgbbuffer;
         delete rgbConv;
 
+		if (resizer)
+		{
+			delete resizer;
+			resizer=NULL;
+		}
+
         rgbbuffer=NULL;
         imgdst=NULL;
         imgsrc=NULL;
@@ -215,10 +227,9 @@
 }
 gboolean draw (void)
 {
-    GtkWidget *draw;
-        draw=WID(drawingarea1);
-        GUI_RGBDisplay((uint8_t *)rgbbuffer, w,h, (void *)draw);
-        return true;
+	GUI_RGBDisplay((uint8_t *)rgbbuffer, zoomW, zoomH, WID(drawingarea1));
+
+	return true;
 }
 void update(void )
 {
@@ -271,9 +282,11 @@
         dst+=stride;
         src+=stride;
     }
-    //
-    //COL_yv12rgb(  w,   h,imgdisplay->data,(uint8_t *)rgbbuffer );
-     rgbConv->scale(imgdisplay->data,(uint8_t *)rgbbuffer );
+
+	if (resizer)
+		resizer->resize(imgdisplay->data, (uint8_t*)rgbbuffer);
+	else
+		rgbConv->scale(imgdisplay->data, (uint8_t*)rgbbuffer);
 }
 
 //**

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_equalizer.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_equalizer.cpp	2007-07-14 22:27:34 UTC (rev 3370)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_equalizer.cpp	2007-07-14 23:44:28 UTC (rev 3371)
@@ -20,24 +20,14 @@
  *                                                                         *
  ***************************************************************************/
 
+#include "config.h"
 
-
-#include <config.h>
-
-
 #include <string.h>
 #include <stdio.h>
-
 #include <gdk/gdkkeysyms.h>
 #include <gtk/gtk.h>
+#include <math.h>
 
-
-#include <gdk/gdkkeysyms.h>
-#include <gtk/gtk.h>
-# include <math.h>
-
-#include "default.h"
-
 #include "ADM_toolkit_gtk/ADM_gladeSupport.h"
 #include "ADM_toolkit_gtk/toolkit_gtk.h"
 #include "ADM_toolkit_gtk/toolkit_gtk_include.h"
@@ -50,6 +40,11 @@
 #include "ADM_video/ADM_genvideo.hxx"
 #include "ADM_video/ADM_vidEqualizer.h"
 #include "ADM_assert.h"
+
+extern "C" {
+#include "ADM_libraries/ADM_lavcodec/avcodec.h"
+}
+
 static ColYuvRgb    *rgbConv=NULL;
 uint8_t DIA_getEqualizer(EqualizerParam *param, ADMImage *image);
 
@@ -66,12 +61,14 @@
 static void 		frame_changed( void );
 
 extern void GUI_RGBDisplay(uint8_t * dis, uint32_t w, uint32_t h, void *widg);
+extern float UI_calcZoomToFitScreen(GtkWindow* window, GtkWidget* drawingArea, uint32_t imageWidth, uint32_t imageHeight);
 
 static ADMImage *imgsrc,*imgdst,*imgdisplay;
 static GtkWidget *dialog=NULL;
 static uint32_t scaler[256];
-static uint32_t w,h;
+static uint32_t w,h,zoomW,zoomH;
 static uint32_t *rgbbuffer=NULL;
+static ADMImageResizer *resizer=NULL;
 
 static uint32_t *histogram=NULL;
 static uint32_t *histogramout=NULL;
@@ -101,7 +98,6 @@
 	h=in->getInfo()->height;
 	rgbConv=new ColYuvRgb(w,h);
         rgbConv->reset(w,h);
-	rgbbuffer=new uint32_t[w*h];
 	
 	histogram=new uint32_t [256*128];
         histogramout=new uint32_t [256*128];
@@ -120,12 +116,23 @@
 
 	dialog=create_dialog1();
 	gtk_register_dialog(dialog);
+	gtk_widget_set_usize(WID(drawingarea_histin), 256,128);
+    gtk_widget_set_usize(WID(drawingarea_histout), 256,128);
 
-	gtk_widget_set_usize(WID(drawingarea1), w,h);
+	float zoom = UI_calcZoomToFitScreen(GTK_WINDOW(dialog), WID(drawingarea1), w, h);
 
-	gtk_widget_set_usize(WID(drawingarea_histin), 256,128);
-        gtk_widget_set_usize(WID(drawingarea_histout), 256,128);
-	
+	zoomW = w * zoom;
+	zoomH = h * zoom;
+	rgbbuffer=new uint32_t[zoomW*zoomH];
+
+	gtk_widget_set_usize(WID(drawingarea1), zoomW, zoomH);
+
+	if (zoom < 1)
+	{
+		gtk_window_set_position(GTK_WINDOW(dialog), GTK_WIN_POS_CENTER);
+		resizer = new ADMImageResizer(w, h, zoomW, zoomH, PIX_FMT_YUV420P, PIX_FMT_RGB32);
+	}
+
 	  gtk_dialog_add_action_widget (GTK_DIALOG (dialog), WID(buttonCancel), GTK_RESPONSE_CANCEL);
 	  gtk_dialog_add_action_widget (GTK_DIALOG (dialog), WID(button3),      GTK_RESPONSE_OK);
 	  gtk_dialog_add_action_widget (GTK_DIALOG (dialog), WID(buttonApply),  GTK_RESPONSE_APPLY);
@@ -183,6 +190,13 @@
 	delete [] histogram;
         delete [] histogramout;
     delete rgbConv;
+
+	if (resizer)
+	{
+		delete resizer;
+		resizer=NULL;
+	}
+
     rgbConv=NULL;    
 	histogram=NULL;
         histogramout=NULL;
@@ -287,7 +301,11 @@
 	// udate u & v
 	// now convert to rgb
 	//COL_yv12rgb(  w,   h,imgdisplay->data,(uint8_t *)rgbbuffer );
-	rgbConv->scale(imgdisplay->data,(uint8_t *)rgbbuffer );
+	if (resizer)
+		resizer->resize(imgdisplay->data, (uint8_t*)rgbbuffer);
+	else
+		rgbConv->scale(imgdisplay->data, (uint8_t*)rgbbuffer);
+
 	draw();
 }
 // Compute histogram
@@ -358,11 +376,9 @@
 */
 gboolean draw (void)
 {
-	GtkWidget *draw;
+	GtkWidget *draw=WID(drawingarea1);
 
-	draw=WID(drawingarea1);
-
-	GUI_RGBDisplay((uint8_t *)rgbbuffer, w,h, (void *)draw);
+	GUI_RGBDisplay((uint8_t *)rgbbuffer, zoomW, zoomH, (void *)draw);
 /*	
 	draw=WID(histogram);
 	GUI_RGBDisplay((uint8_t *)bargraph, 256,256, (void *)draw);

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_mpdelogo.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_mpdelogo.cpp	2007-07-14 22:27:34 UTC (rev 3370)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_mpdelogo.cpp	2007-07-14 23:44:28 UTC (rev 3371)
@@ -20,22 +20,15 @@
  *                                                                         *
  ***************************************************************************/
 
+#include "config.h"
 
-
-#include <config.h>
-
-
 #include <string.h>
 #include <stdio.h>
 
 #include <gdk/gdkkeysyms.h>
 #include <gtk/gtk.h>
+#include <math.h>
 
-
-#include <gdk/gdkkeysyms.h>
-#include <gtk/gtk.h>
-# include <math.h>
-
 #include "default.h"
 #include "ADM_toolkit_gtk/toolkit_gtk.h"
 #include "ADM_toolkit_gtk/toolkit_gtk_include.h"
@@ -46,6 +39,11 @@
 #include "ADM_colorspace/ADM_rgb.h"
 #include "ADM_assert.h"
 #include "ADM_video/ADM_vidMPdelogo.h"
+
+extern "C" {
+#include "ADM_libraries/ADM_lavcodec/avcodec.h"
+}
+
 static GtkWidget	*create_dialog1 (void);
 static void  		ui_read ( void);
 static void  		ui_update ( void);
@@ -61,15 +59,18 @@
 static void 		frame_changed( void );
 
 extern void GUI_RGBDisplay(uint8_t * dis, uint32_t w, uint32_t h, void *widg);
+extern float UI_calcZoomToFitScreen(GtkWindow* window, GtkWidget* drawingArea, uint32_t imageWidth, uint32_t imageHeight);
 
 static ColYuvRgb    *rgbConv=NULL;
 static uint8_t *working=NULL;
+static uint8_t *rgbBufferDisplay=NULL;
 static uint8_t *original=NULL;
 static GtkWidget *dialog=NULL;
-static uint32_t x,y,w,h,band;
+static uint32_t x,y,w,h,zoomW,zoomH,band;
 
 static AVDMGenericVideoStream *incoming=NULL;
 static ADMImage *imgsrc=NULL;
+static ADMImageResizer *resizer=NULL;
 
 static int lock=0,width,height;
 
@@ -84,8 +85,7 @@
 	// Allocate space for green-ised video
 	width=in->getInfo()->width;
 	height=in->getInfo()->height;
-	
-	
+		
 	working=new uint8_t [width*height*4];	
 	original=NULL;
 
@@ -105,23 +105,31 @@
 	
 	rgbConv=new ColYuvRgb(width,height);
         rgbConv->reset(width,height);
-	
-	gtk_widget_set_usize(WID(drawingarea1), width,height);
 
+	float zoom = UI_calcZoomToFitScreen(GTK_WINDOW(dialog), WID(drawingarea1), width, height);
+
+	zoomW = width * zoom;
+	zoomH = height * zoom;
+	rgbBufferDisplay=new uint8_t[zoomW*zoomH*4];
+
+	gtk_widget_set_usize(WID(drawingarea1), zoomW, zoomH);
+
+	if (zoom < 1)
+	{
+		gtk_window_set_position(GTK_WINDOW(dialog), GTK_WIN_POS_CENTER);
+		resizer = new ADMImageResizer(width, height, zoomW, zoomH, PIX_FMT_RGB32, PIX_FMT_RGB32);
+	}
+
 	prepare(0);
 	gtk_widget_show(dialog);
 	
-
 	ui_upload();
-
 	ui_update();
 	
 #define CONNECT(x,y,z) 	gtk_signal_connect(GTK_OBJECT(WID(x)), #y,GTK_SIGNAL_FUNC(z),   NULL);
 
         CONNECT(drawingarea1,expose_event,gui_draw);
-        CONNECT(hscale1,value_changed,frame_changed);
-
-	  
+        CONNECT(hscale1,value_changed,frame_changed);	  
 		      
 #define CONNECT_SPIN(x) CONNECT(spinbutton##x, value_changed,ui_changed)
       	  
@@ -130,7 +138,6 @@
         CONNECT_SPIN(W);
         CONNECT_SPIN(H);
         CONNECT_SPIN(Band);
-
 	  
 	draw(dialog,width,height);
 
@@ -156,6 +163,16 @@
 	delete working;	
 	delete imgsrc;
 	delete rgbConv;
+
+	if (resizer)
+	{
+		delete resizer;
+		delete[] rgbBufferDisplay;
+
+		resizer=NULL;
+		rgbBufferDisplay=NULL;
+	}
+
 	working=NULL;
 	dialog=NULL;
 	original=NULL;
@@ -219,10 +236,15 @@
 }
 void draw (GtkWidget *dialog,uint32_t w,uint32_t h )
 {
-	GtkWidget *draw;
-	draw=WID(drawingarea1);
+	GtkWidget *draw=WID(drawingarea1);
 
-	GUI_RGBDisplay(working, w,h, (void *)draw);
+	if (resizer)
+	{
+		resizer->resize(working, rgbBufferDisplay);
+		GUI_RGBDisplay(rgbBufferDisplay, zoomW, zoomH, (void*)draw);
+	}
+	else
+		GUI_RGBDisplay(working, w, h, (void*)draw);
 }
 /*---------------------------------------------------------------------------
 	Read entried from dialog box



From gruntster at mail.berlios.de  Sun Jul 15 02:25:40 2007
From: gruntster at mail.berlios.de (gruntster at mail.berlios.de)
Date: Sun, 15 Jul 2007 02:25:40 +0200
Subject: [Avidemux-svn-commit] r3372 -
	branches/avidemux_2.4_branch/avidemux/ADM_audiodevice
Message-ID: <200707150025.l6F0Pers001749@sheep.berlios.de>

Author: gruntster
Date: 2007-07-15 02:25:29 +0200 (Sun, 15 Jul 2007)
New Revision: 3372

Modified:
   branches/avidemux_2.4_branch/avidemux/ADM_audiodevice/ADM_deviceWin32.cpp
Log:
fix volume control on Win32

Modified: branches/avidemux_2.4_branch/avidemux/ADM_audiodevice/ADM_deviceWin32.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_audiodevice/ADM_deviceWin32.cpp	2007-07-14 23:44:28 UTC (rev 3371)
+++ branches/avidemux_2.4_branch/avidemux/ADM_audiodevice/ADM_deviceWin32.cpp	2007-07-15 00:25:29 UTC (rev 3372)
@@ -179,11 +179,12 @@
 uint8_t  win32AudioDevice::setVolume(int volume) 
 {
     DWORD value;
-    value=0xffff;
-    value*=volume;
-    value/=10;
-    value=value+(value<<16);
-    waveOutSetVolume(myDevice,value);
+
+    value = (0xffff * volume) / 100;
+    value = value + (value << 16);
+
+    waveOutSetVolume(myDevice, value);
+
 	return 1;
 }
 //_______________________________________________



From mean at mail.berlios.de  Sun Jul 15 21:33:58 2007
From: mean at mail.berlios.de (mean at BerliOS)
Date: Sun, 15 Jul 2007 21:33:58 +0200
Subject: [Avidemux-svn-commit] r3373 -
	branches/avidemux_2.4_branch/avidemux/ADM_audiodevice
Message-ID: <200707151933.l6FJXwKG029518@sheep.berlios.de>

Author: mean
Date: 2007-07-15 21:33:57 +0200 (Sun, 15 Jul 2007)
New Revision: 3373

Modified:
   branches/avidemux_2.4_branch/avidemux/ADM_audiodevice/ADM_deviceALSA.cpp
Log:
[ALSA] correctly increment buffer when data is sent in several chunks

Modified: branches/avidemux_2.4_branch/avidemux/ADM_audiodevice/ADM_deviceALSA.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_audiodevice/ADM_deviceALSA.cpp	2007-07-15 00:25:29 UTC (rev 3372)
+++ branches/avidemux_2.4_branch/avidemux/ADM_audiodevice/ADM_deviceALSA.cpp	2007-07-15 19:33:57 UTC (rev 3373)
@@ -214,6 +214,7 @@
 uint8_t alsaAudioDevice::play( uint32_t len, float *data )
 {
 	int ret;
+        int16_t *pcm;
 	/* Write num_frames frames from buffer data to    */
 	/* the PCM device pointed to by pcm_handle.       */
 	/* Returns the number of frames actually written. */
@@ -222,10 +223,10 @@
 
 	if(2!=_init) return 0;
         len=len/_channels;
-
+        pcm=(int16_t *)data;
     	while(1)
 	{
-        	ret=snd_pcm_writei(pcm_handle, data, len);
+        	ret=snd_pcm_writei(pcm_handle, pcm, len);
 		if(ret==(int)len)
 		{
 			return 1;
@@ -252,8 +253,9 @@
 		}
 		else
 		{
-			if(len<2) return 1;
+			//if(len<2) return 1;
 			len-=ret;
+                        pcm+=(ret*_channels);
 		}
 	}
 	return 1;



From gruntster at mail.berlios.de  Mon Jul 16 01:11:50 2007
From: gruntster at mail.berlios.de (gruntster at mail.berlios.de)
Date: Mon, 16 Jul 2007 01:11:50 +0200
Subject: [Avidemux-svn-commit] r3374 - in
	branches/avidemux_2.4_branch/avidemux: ADM_encoder ADM_filter
	ADM_userInterfaces/ADM_GTK/ADM_dialog
Message-ID: <200707152311.l6FNBoTH030047@sheep.berlios.de>

Author: gruntster
Date: 2007-07-16 01:11:24 +0200 (Mon, 16 Jul 2007)
New Revision: 3374

Modified:
   branches/avidemux_2.4_branch/avidemux/ADM_encoder/adm_encoder.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_filter/filter.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_preview.cpp
Log:
resize GTK filter preview window

Modified: branches/avidemux_2.4_branch/avidemux/ADM_encoder/adm_encoder.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_encoder/adm_encoder.cpp	2007-07-15 19:33:57 UTC (rev 3373)
+++ branches/avidemux_2.4_branch/avidemux/ADM_encoder/adm_encoder.cpp	2007-07-15 23:11:24 UTC (rev 3374)
@@ -94,35 +94,31 @@
 {
   printf ("\n Registering Encoders\n");
   printf ("*********************\n");
+
 #ifdef USE_DIVX
   nb_encoder++;
-  printf ("Divx  encoder registred\n");
+  printf ("DivX encoder registered\n");
 #endif
+
 #ifdef USE_FFMPEG
   nb_encoder++;
-  printf ("Mjpeg encoder registred\n");
-
+  printf ("MJPEG encoder registered\n");
 #endif
-#ifdef USE_XX_XVID
 
-  {
+#ifdef USE_XX_XVID
     nb_encoder++;
-    printf ("Xvid  encoder registred\n");
-  }
-
+    printf ("Xvid encoder registered\n");
 #endif
-#ifdef USE_XVID_4
 
-  {
+#ifdef USE_XVID_4
     nb_encoder++;
-    printf ("Xvid-4  encoder registred\n");
-  }
-
+    printf ("Xvid-4 encoder registered\n");
 #endif
+
 #ifdef USE_FFMPEG
   nb_encoder++;
-  printf ("FFMPEG  encoder registred\n");
+  printf ("FFmpeg encoder registered\n");
 #endif
-  printf ("\n %d encoder registered\n", nb_encoder);
 
+  printf ("\n%d encoder(s) registered\n", nb_encoder);
 }

Modified: branches/avidemux_2.4_branch/avidemux/ADM_filter/filter.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_filter/filter.cpp	2007-07-15 19:33:57 UTC (rev 3373)
+++ branches/avidemux_2.4_branch/avidemux/ADM_filter/filter.cpp	2007-07-15 23:11:24 UTC (rev 3374)
@@ -81,7 +81,7 @@
 void filterListAll( void )
 {
 char *name;
-	printf("\n Video filters\n");
+	printf("\nVideo filters\n");
 	for(uint32_t i=0;i<nb_video_filter;i++)
 	{
 		name=allfilters[ i].filtername;
@@ -128,7 +128,7 @@
 
         if(viewable==1)
 	{
-        	aprintf("\n Registred filter %lu: %s",nb_video_filter,name);
+        	aprintf("\nRegistered filter %lu: %s",nb_video_filter,name);
 	}
 }
 void registerFilterEx(const char *name,VF_FILTERS tag,uint8_t viewable
@@ -147,7 +147,7 @@
 
         if(viewable==1)
 	{
-        	aprintf("\n Registred filter %lu: %s",nb_video_filter,name);
+        	aprintf("\nRegistered filter %lu: %s",nb_video_filter,name);
 	}
 
 

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_preview.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_preview.cpp	2007-07-15 19:33:57 UTC (rev 3373)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_preview.cpp	2007-07-15 23:11:24 UTC (rev 3374)
@@ -1,346 +1,385 @@
-/***************************************************************************
-                          ADM_vidpreview.cpp  -  description
-                             -------------------
-
-       Previewer, we switch to RGB (only one Xv at a time)   and display the incoming
-       YV12 buffer in a nice windowd
-
-    begin                : Mon Mar 25 2002
-    copyright            : (C) 2002 by mean
-    email                : fixounet at free.fr
- ***************************************************************************/
-
-/***************************************************************************
- *                                                                         *
- *   This program is free software; you can redistribute it and/or modify  *
- *   it under the terms of the GNU General Public License as published by  *
- *   the Free Software Foundation; either version 2 of the License, or     *
- *   (at your option) any later version.                                   *
- *                                                                         *
- ***************************************************************************/
-
-#include "config.h"
- 
-#include <stdio.h>
-#include <stdlib.h>
-#include <string.h>
-
-#include <gtk/gtk.h>
-#include <time.h>
-#include <sys/time.h>
-
-#include "config.h"
-#include "fourcc.h"
-#include "avio.hxx"
-
-#include "avi_vars.h"
-#include "ADM_toolkit_gtk/ADM_gladeSupport.h"
-#include "ADM_toolkit_gtk/toolkit_gtk.h"
-#include "ADM_toolkit_gtk/toolkit_gtk_include.h"
-#include "ADM_colorspace/ADM_rgb.h"
-#include "prototype.h"
-#include <ADM_assert.h>
-#include "gui_action.hxx"
-
-extern void HandleAction (Action action);
-void GUI_detransient(void );
-void GUI_retransient(void );
-
-static GtkWidget	*create_dialog1 (void);
-static uint8_t      stacked=0;
-static void 			previewRender(void);
-static gboolean		preview_exit(GtkButton * button, gpointer user_data);
-static gboolean         cb_prev(GtkButton * button, gpointer user_data);
-static gboolean         cb_stack(GtkButton * button, gpointer user_data);
-static gboolean         cb_next(GtkButton * button, gpointer user_data);
-static gboolean 		preview_exit_short (GtkWidget * widget,GdkEvent * event, gpointer user_data);
-
-static uint8_t *rgb_render=NULL,*rgb_alternate=NULL;
-static GtkWidget *dialog=NULL;
-static uint32_t 	uw, uh;
-int 			lock;
-uint8_t		needDestroy=0;
-static int      needResponse=0;
-static ColYuvRgb    rgbConv(100,100);
-
-
-//*************************************************************
-// Short cut for filter preview
-// It is a modal blocking display of the datas given as arg
-//*************************************************************
-void GUI_PreviewShow(uint32_t w, uint32_t h, uint8_t *data)
-{
-                if(rgb_render)
-                {
-                        printf("\n Warning rgb render not null...\n");
-                        delete [] rgb_render;
-                        delete [] rgb_alternate;
-                        rgb_alternate=NULL;
-                        rgb_render=NULL;
-                }
-                ADM_assert(rgb_render=new uint8_t [w*h*4]);
-                ADM_assert(rgb_alternate=new uint8_t [w*h*4]);
-                uw=w;
-                uh=h;
-                rgbConv.reset(w,h); 
-                dialog=create_dialog1();
-                gtk_register_dialog(dialog);
-                gtk_widget_set_usize (lookup_widget(dialog,"drawingarea1"),w,h);
-                rgbConv.scale(data,rgb_render);
-                gtk_signal_connect(GTK_OBJECT(WID(drawingarea1)), "expose_event",
-                       GTK_SIGNAL_FUNC(previewRender),    NULL);
-                gtk_dialog_run(GTK_DIALOG(dialog));
-                gtk_unregister_dialog(dialog);
-                gtk_widget_destroy(dialog);
-                delete [] rgb_render;
-                delete [] rgb_alternate;
-                rgb_alternate=NULL;
-                rgb_render=NULL;
-}
-//*************************************************************
-// Init previewer
-// It is a independant window, so we cannot use gtk_dialog_run
-//
-//*************************************************************
-uint8_t GUI_PreviewStillAlive( void )
-{
- 	if(dialog==NULL) return 0;
-  	return 1;
-
-}
-void GUI_PreviewInit(uint32_t w , uint32_t h,uint32_t modal)
-{
-        if(rgb_render)
-        {
-                printf("\n Warning rgb render not null...\n");
-                delete [] rgb_render;
-                delete [] rgb_alternate;
-                rgb_alternate=NULL;
-                rgb_render=NULL;
-        }
-        stacked=0;
-       ADM_assert(rgb_render=new uint8_t [w*h*4]);
-       ADM_assert(rgb_alternate=new uint8_t [w*h*4]);
-       uw=w;
-       uh=h;
-       rgbConv.reset(w,h); 
-
-       // add callback for destroy
-        lock=0;
-        needDestroy=1;
-
-#define CNX(x,y,z)  gtk_signal_connect(GTK_OBJECT(x), #y, \
-                       GTK_SIGNAL_FUNC(z),                   (void *) NULL);
-
-        dialog=create_dialog1();
-/*
-        CNX(WID(buttonNext),clicked     ,cb_next);
-        CNX(WID(buttonPrev),clicked     ,cb_prev);
-*/
-        CNX(WID(drawingarea1),expose_event,previewRender);
-
- //       CNX(dialog    ,delete_event,preview_exit_short);
-
-        gtk_widget_set_usize (lookup_widget(dialog,"drawingarea1"),w,h);
-        gtk_widget_show(  dialog);
-}
-
-static uint8_t stack(uint8_t *out, uint8_t *in, int width,int height)
-{
- uint8_t *o1,*o2,*i;
- int x,y;
-        o1=out;
-        o2=out+((width*height)>>1);
-        i=in;
-        for(y=0;y<height>>1;y++)
-        {
-            memcpy(o1,i,width); 
-            memcpy(o2,i+width,width);  
-            o1+=width;
-            o2+=width;
-            i+=2*width;        
-        }   
-    return 1;
-}
-// return 1 if preview is still running
-uint8_t  GUI_PreviewUpdate(uint8_t *data)
-{
-        if(  dialog)
-        {
-
-                // First convert YV12 to RGB
-                // COL_yv12rgb( uw, uh,data, rgb_render);
-                if(!stacked)
-                {
-                        rgbConv.scale(data,rgb_render);
-                }else
-                {
-                        stack(rgb_alternate,data, uw,uh);
-                        stack(rgb_alternate+uw*uh,data+uw*uh, uw>>1,uh>>1);
-                        stack(rgb_alternate+((5*uw*uh)>>2),data+((5*uw*uh)>>2), uw>>1,uh>>1);
-                        rgbConv.scale(rgb_alternate,rgb_render);
-                }
-                previewRender();
-                if(lock==1)
-                {
-                        dialog=NULL;
-                        return 0;
-                }
-                else
-                        return 1;
-        }
-        return 0;
-}
-uint8_t  GUI_PreviewRun(uint8_t *data)
-{
-    ADM_assert(0);
-}
-
-void GUI_PreviewEnd(void)
-{
-        if(dialog && needDestroy)
-        {
-                gtk_widget_destroy(dialog);
-        }
-        if(rgb_render)
-        {
-                delete [] rgb_render;
-                rgb_render=NULL;
-                delete [] rgb_alternate;
-                rgb_alternate=NULL;
-        }
-        dialog=NULL;
-        needDestroy=0;
-}
-void previewRender(void)
-{
-
-if(!dialog) return;
-GUI_RGBDisplay(rgb_render, uw, uh ,lookup_widget(dialog,"drawingarea1"));
-
-
-}
-gboolean         cb_stack(GtkButton * button, gpointer user_data)
-{
-
-        stacked^=1;
-        return FALSE;
-
-}
-// Called when window is destroyed
-gboolean preview_exit_short (GtkWidget * widget, GdkEvent * event, gpointer user_data)
-{
-    UNUSED_ARG(widget);
-    UNUSED_ARG(event);
-    UNUSED_ARG(user_data);
-//	printf("destroyed\n");
-        printf("Destroy call\n");
-    if(lock==0 )
-    {
-    		lock=-1;
-		//printf(">\n");
-		needDestroy=0;
-    		GUI_PreviewEnd();
-                printf("Destroyed\n");
-                
-    }
-	return FALSE;
-}
-static gboolean         cb_prev(GtkButton * button, gpointer user_data)
-{
-        HandleAction(ACT_PreviousFrame);
-        return TRUE;
-}
-static gboolean         cb_next(GtkButton * button, gpointer user_data)
-{
-        HandleAction(ACT_NextFrame);
-        return FALSE;
-}
-/**********************************************************
-***********************************************************
-***********************************************************/
-GtkWidget*
-create_dialog1 (void)
-{
-  GtkWidget *dialog1;
-  GtkWidget *dialog_vbox1;
-  GtkWidget *vbox1;
-  GtkWidget *toolbar1;
-  GtkIconSize tmp_toolbar_icon_size;
-  GtkWidget *toolitem1;
-  GtkWidget *buttonPrev;
-  GtkWidget *toolitem2;
-  GtkWidget *buttonNext;
-  GtkWidget *toolitem3;
-  GtkWidget *buttonStack;
-  GtkWidget *drawingarea1;
-  GtkWidget *dialog_action_area1;
-
-  dialog1 = gtk_dialog_new ();
-  gtk_window_set_title (GTK_WINDOW (dialog1), _("Preview"));
-  gtk_window_set_type_hint (GTK_WINDOW (dialog1), GDK_WINDOW_TYPE_HINT_DIALOG);
-
-  dialog_vbox1 = GTK_DIALOG (dialog1)->vbox;
-  gtk_widget_show (dialog_vbox1);
-
-  vbox1 = gtk_vbox_new (FALSE, 0);
-  gtk_widget_show (vbox1);
-  gtk_box_pack_start (GTK_BOX (dialog_vbox1), vbox1, TRUE, TRUE, 0);
-
-  toolbar1 = gtk_toolbar_new ();
-  gtk_widget_show (toolbar1);
-  gtk_box_pack_start (GTK_BOX (vbox1), toolbar1, FALSE, FALSE, 0);
-  gtk_toolbar_set_style (GTK_TOOLBAR (toolbar1), GTK_TOOLBAR_BOTH);
-  tmp_toolbar_icon_size = gtk_toolbar_get_icon_size (GTK_TOOLBAR (toolbar1));
-
-  toolitem1 = (GtkWidget*) gtk_tool_item_new ();
-  gtk_widget_show (toolitem1);
-  gtk_container_add (GTK_CONTAINER (toolbar1), toolitem1);
-
-  buttonPrev = gtk_button_new_from_stock ("gtk-media-previous");
-  gtk_widget_show (buttonPrev);
-  gtk_container_add (GTK_CONTAINER (toolitem1), buttonPrev);
-
-  toolitem2 = (GtkWidget*) gtk_tool_item_new ();
-  gtk_widget_show (toolitem2);
-  gtk_container_add (GTK_CONTAINER (toolbar1), toolitem2);
-
-  buttonNext = gtk_button_new_from_stock ("gtk-media-next");
-  gtk_widget_show (buttonNext);
-  gtk_container_add (GTK_CONTAINER (toolitem2), buttonNext);
-
-  toolitem3 = (GtkWidget*) gtk_tool_item_new ();
-  gtk_widget_show (toolitem3);
-  gtk_container_add (GTK_CONTAINER (toolbar1), toolitem3);
-
-  buttonStack = gtk_button_new_with_mnemonic (_("Stack Field"));
-  gtk_widget_show (buttonStack);
-  gtk_container_add (GTK_CONTAINER (toolitem3), buttonStack);
-
-  drawingarea1 = gtk_drawing_area_new ();
-  gtk_widget_show (drawingarea1);
-  gtk_box_pack_start (GTK_BOX (vbox1), drawingarea1, TRUE, TRUE, 0);
-
-  dialog_action_area1 = GTK_DIALOG (dialog1)->action_area;
-  gtk_widget_show (dialog_action_area1);
-  gtk_button_box_set_layout (GTK_BUTTON_BOX (dialog_action_area1), GTK_BUTTONBOX_END);
-
-  /* Store pointers to all widgets, for use by lookup_widget(). */
-  GLADE_HOOKUP_OBJECT_NO_REF (dialog1, dialog1, "dialog1");
-  GLADE_HOOKUP_OBJECT_NO_REF (dialog1, dialog_vbox1, "dialog_vbox1");
-  GLADE_HOOKUP_OBJECT (dialog1, vbox1, "vbox1");
-  GLADE_HOOKUP_OBJECT (dialog1, toolbar1, "toolbar1");
-  GLADE_HOOKUP_OBJECT (dialog1, toolitem1, "toolitem1");
-  GLADE_HOOKUP_OBJECT (dialog1, buttonPrev, "buttonPrev");
-  GLADE_HOOKUP_OBJECT (dialog1, toolitem2, "toolitem2");
-  GLADE_HOOKUP_OBJECT (dialog1, buttonNext, "buttonNext");
-  GLADE_HOOKUP_OBJECT (dialog1, toolitem3, "toolitem3");
-  GLADE_HOOKUP_OBJECT (dialog1, buttonStack, "buttonStack");
-  GLADE_HOOKUP_OBJECT (dialog1, drawingarea1, "drawingarea1");
-  GLADE_HOOKUP_OBJECT_NO_REF (dialog1, dialog_action_area1, "dialog_action_area1");
-
-  return dialog1;
-}
-
-
-
+/***************************************************************************
+                          ADM_vidpreview.cpp  -  description
+                             -------------------
+
+       Previewer, we switch to RGB (only one Xv at a time)   and display the incoming
+       YV12 buffer in a nice windowd
+
+    begin                : Mon Mar 25 2002
+    copyright            : (C) 2002 by mean
+    email                : fixounet at free.fr
+ ***************************************************************************/
+
+/***************************************************************************
+ *                                                                         *
+ *   This program is free software; you can redistribute it and/or modify  *
+ *   it under the terms of the GNU General Public License as published by  *
+ *   the Free Software Foundation; either version 2 of the License, or     *
+ *   (at your option) any later version.                                   *
+ *                                                                         *
+ ***************************************************************************/
+
+#include "config.h"
+ 
+#include <stdio.h>
+#include <stdlib.h>
+#include <string.h>
+
+#include <gtk/gtk.h>
+#include <time.h>
+#include <sys/time.h>
+
+#include "config.h"
+#include "fourcc.h"
+#include "avio.hxx"
+
+#include "avi_vars.h"
+#include "ADM_toolkit_gtk/ADM_gladeSupport.h"
+#include "ADM_toolkit_gtk/toolkit_gtk.h"
+#include "ADM_toolkit_gtk/toolkit_gtk_include.h"
+#include "ADM_colorspace/ADM_rgb.h"
+#include "prototype.h"
+#include <ADM_assert.h>
+#include "gui_action.hxx"
+
+extern "C" {
+#include "ADM_libraries/ADM_lavcodec/avcodec.h"
+}
+
+extern void HandleAction (Action action);
+void GUI_detransient(void );
+void GUI_retransient(void );
+
+static GtkWidget	*create_dialog1 (void);
+static uint8_t      stacked=0;
+static void 			previewRender(void);
+static gboolean		preview_exit(GtkButton * button, gpointer user_data);
+static gboolean         cb_prev(GtkButton * button, gpointer user_data);
+static gboolean         cb_stack(GtkButton * button, gpointer user_data);
+static gboolean         cb_next(GtkButton * button, gpointer user_data);
+static gboolean 		preview_exit_short (GtkWidget * widget,GdkEvent * event, gpointer user_data);
+
+static uint8_t *rgb_render=NULL,*rgb_alternate=NULL,*rgbDisplay=NULL;
+static GtkWidget *dialog=NULL;
+static uint32_t 	uw, uh,zoomW,zoomH;
+int 			lock;
+uint8_t		needDestroy=0;
+static int      needResponse=0;
+static ColYuvRgb    rgbConv(100,100);
+static ADMImageResizer *resizer=NULL;
+
+extern float UI_calcZoomToFitScreen(GtkWindow* window, GtkWidget* drawingArea, uint32_t imageWidth, uint32_t imageHeight);
+
+//*************************************************************
+// Short cut for filter preview
+// It is a modal blocking display of the datas given as arg
+//*************************************************************
+void GUI_PreviewShow(uint32_t w, uint32_t h, uint8_t *data)
+{
+	if(rgb_render)
+	{
+		printf("\nWarning rgb render not null...\n");
+		delete[] rgb_render;
+		delete[] rgb_alternate;
+		rgb_alternate=NULL;
+		rgb_render=NULL;
+	}
+
+	rgb_render=new uint8_t [w*h*4];
+	rgb_alternate=new uint8_t [w*h*4];
+
+	uw=w;
+	uh=h;
+	rgbConv.reset(w,h);
+	rgbConv.scale(data,rgb_render);
+
+	dialog=create_dialog1();
+	gtk_register_dialog(dialog);
+
+	float zoom = UI_calcZoomToFitScreen(GTK_WINDOW(dialog), WID(drawingarea1), w, h);
+
+	zoomW = w * zoom;
+	zoomH = h * zoom;
+
+	gtk_widget_set_usize(WID(drawingarea1), zoomW, zoomH);
+
+	if (zoom < 1)
+	{
+		gtk_window_set_position(GTK_WINDOW(dialog), GTK_WIN_POS_CENTER);
+		resizer = new ADMImageResizer(w, h, zoomW, zoomH, PIX_FMT_RGB32, PIX_FMT_RGB32);
+		rgbDisplay = new uint8_t[zoomW*zoomH*4];
+	}
+	
+	gtk_signal_connect(GTK_OBJECT(WID(drawingarea1)), "expose_event",
+		   GTK_SIGNAL_FUNC(previewRender), NULL);
+
+	gtk_dialog_run(GTK_DIALOG(dialog));
+	gtk_unregister_dialog(dialog);
+	gtk_widget_destroy(dialog);
+
+	delete[] rgb_render;
+	delete[] rgb_alternate;
+
+	if (resizer)
+	{
+		delete resizer;
+		delete rgbDisplay;
+		resizer=NULL;
+		rgbDisplay=NULL;
+	}
+
+	rgb_alternate=NULL;
+	rgb_render=NULL;
+}
+//*************************************************************
+// Init previewer
+// It is a independant window, so we cannot use gtk_dialog_run
+//
+//*************************************************************
+uint8_t GUI_PreviewStillAlive( void )
+{
+ 	if(dialog==NULL) return 0;
+  	return 1;
+
+}
+void GUI_PreviewInit(uint32_t w , uint32_t h,uint32_t modal)
+{
+        if(rgb_render)
+        {
+                printf("\n Warning rgb render not null...\n");
+                delete [] rgb_render;
+                delete [] rgb_alternate;
+                rgb_alternate=NULL;
+                rgb_render=NULL;
+        }
+        stacked=0;
+       ADM_assert(rgb_render=new uint8_t [w*h*4]);
+       ADM_assert(rgb_alternate=new uint8_t [w*h*4]);
+       uw=w;
+       uh=h;
+       rgbConv.reset(w,h); 
+
+       // add callback for destroy
+        lock=0;
+        needDestroy=1;
+
+#define CNX(x,y,z)  gtk_signal_connect(GTK_OBJECT(x), #y, \
+                       GTK_SIGNAL_FUNC(z),                   (void *) NULL);
+
+        dialog=create_dialog1();
+/*
+        CNX(WID(buttonNext),clicked     ,cb_next);
+        CNX(WID(buttonPrev),clicked     ,cb_prev);
+*/
+        CNX(WID(drawingarea1),expose_event,previewRender);
+
+ //       CNX(dialog    ,delete_event,preview_exit_short);
+
+        gtk_widget_set_usize (lookup_widget(dialog,"drawingarea1"),w,h);
+        gtk_widget_show(  dialog);
+}
+
+static uint8_t stack(uint8_t *out, uint8_t *in, int width,int height)
+{
+ uint8_t *o1,*o2,*i;
+ int x,y;
+        o1=out;
+        o2=out+((width*height)>>1);
+        i=in;
+        for(y=0;y<height>>1;y++)
+        {
+            memcpy(o1,i,width); 
+            memcpy(o2,i+width,width);  
+            o1+=width;
+            o2+=width;
+            i+=2*width;        
+        }   
+    return 1;
+}
+// return 1 if preview is still running
+uint8_t  GUI_PreviewUpdate(uint8_t *data)
+{
+        if(  dialog)
+        {
+
+                // First convert YV12 to RGB
+                // COL_yv12rgb( uw, uh,data, rgb_render);
+                if(!stacked)
+                {
+                        rgbConv.scale(data,rgb_render);
+                }else
+                {
+                        stack(rgb_alternate,data, uw,uh);
+                        stack(rgb_alternate+uw*uh,data+uw*uh, uw>>1,uh>>1);
+                        stack(rgb_alternate+((5*uw*uh)>>2),data+((5*uw*uh)>>2), uw>>1,uh>>1);
+                        rgbConv.scale(rgb_alternate,rgb_render);
+                }
+                previewRender();
+                if(lock==1)
+                {
+                        dialog=NULL;
+                        return 0;
+                }
+                else
+                        return 1;
+        }
+        return 0;
+}
+uint8_t  GUI_PreviewRun(uint8_t *data)
+{
+    ADM_assert(0);
+}
+
+void GUI_PreviewEnd(void)
+{
+        if(dialog && needDestroy)
+        {
+                gtk_widget_destroy(dialog);
+        }
+        if(rgb_render)
+        {
+                delete [] rgb_render;
+                rgb_render=NULL;
+                delete [] rgb_alternate;
+                rgb_alternate=NULL;
+        }
+        dialog=NULL;
+        needDestroy=0;
+}
+
+void previewRender(void)
+{
+	if(!dialog) return;
+
+	if (resizer)
+	{
+		resizer->resize(rgb_render, rgbDisplay);
+		GUI_RGBDisplay(rgbDisplay, zoomW, zoomH, WID(drawingarea1));
+	}
+	else
+		GUI_RGBDisplay(rgb_render, uw, uh, WID(drawingarea1));
+}
+
+gboolean         cb_stack(GtkButton * button, gpointer user_data)
+{
+	stacked^=1;
+	return FALSE;
+}
+
+// Called when window is destroyed
+gboolean preview_exit_short (GtkWidget * widget, GdkEvent * event, gpointer user_data)
+{
+    UNUSED_ARG(widget);
+    UNUSED_ARG(event);
+    UNUSED_ARG(user_data);
+//	printf("destroyed\n");
+        printf("Destroy call\n");
+    if(lock==0 )
+    {
+    		lock=-1;
+		//printf(">\n");
+		needDestroy=0;
+    		GUI_PreviewEnd();
+                printf("Destroyed\n");
+                
+    }
+	return FALSE;
+}
+static gboolean         cb_prev(GtkButton * button, gpointer user_data)
+{
+        HandleAction(ACT_PreviousFrame);
+        return TRUE;
+}
+static gboolean         cb_next(GtkButton * button, gpointer user_data)
+{
+        HandleAction(ACT_NextFrame);
+        return FALSE;
+}
+/**********************************************************
+***********************************************************
+***********************************************************/
+GtkWidget*
+create_dialog1 (void)
+{
+  GtkWidget *dialog1;
+  GtkWidget *dialog_vbox1;
+  GtkWidget *vbox1;
+  GtkWidget *toolbar1;
+  GtkIconSize tmp_toolbar_icon_size;
+  GtkWidget *toolitem1;
+  GtkWidget *buttonPrev;
+  GtkWidget *toolitem2;
+  GtkWidget *buttonNext;
+  GtkWidget *toolitem3;
+  GtkWidget *buttonStack;
+  GtkWidget *drawingarea1;
+  GtkWidget *dialog_action_area1;
+
+  dialog1 = gtk_dialog_new ();
+  gtk_window_set_title (GTK_WINDOW (dialog1), _("Preview"));
+  gtk_window_set_type_hint (GTK_WINDOW (dialog1), GDK_WINDOW_TYPE_HINT_DIALOG);
+
+  dialog_vbox1 = GTK_DIALOG (dialog1)->vbox;
+  gtk_widget_show (dialog_vbox1);
+
+  vbox1 = gtk_vbox_new (FALSE, 0);
+  gtk_widget_show (vbox1);
+  gtk_box_pack_start (GTK_BOX (dialog_vbox1), vbox1, TRUE, TRUE, 0);
+
+  toolbar1 = gtk_toolbar_new ();
+  gtk_widget_show (toolbar1);
+  gtk_box_pack_start (GTK_BOX (vbox1), toolbar1, FALSE, FALSE, 0);
+  gtk_toolbar_set_style (GTK_TOOLBAR (toolbar1), GTK_TOOLBAR_BOTH);
+  tmp_toolbar_icon_size = gtk_toolbar_get_icon_size (GTK_TOOLBAR (toolbar1));
+
+  toolitem1 = (GtkWidget*) gtk_tool_item_new ();
+  gtk_widget_show (toolitem1);
+  gtk_container_add (GTK_CONTAINER (toolbar1), toolitem1);
+
+  buttonPrev = gtk_button_new_from_stock ("gtk-media-previous");
+  gtk_widget_show (buttonPrev);
+  gtk_container_add (GTK_CONTAINER (toolitem1), buttonPrev);
+
+  toolitem2 = (GtkWidget*) gtk_tool_item_new ();
+  gtk_widget_show (toolitem2);
+  gtk_container_add (GTK_CONTAINER (toolbar1), toolitem2);
+
+  buttonNext = gtk_button_new_from_stock ("gtk-media-next");
+  gtk_widget_show (buttonNext);
+  gtk_container_add (GTK_CONTAINER (toolitem2), buttonNext);
+
+  toolitem3 = (GtkWidget*) gtk_tool_item_new ();
+  gtk_widget_show (toolitem3);
+  gtk_container_add (GTK_CONTAINER (toolbar1), toolitem3);
+
+  buttonStack = gtk_button_new_with_mnemonic (_("Stack Field"));
+  gtk_widget_show (buttonStack);
+  gtk_container_add (GTK_CONTAINER (toolitem3), buttonStack);
+
+  drawingarea1 = gtk_drawing_area_new ();
+  gtk_widget_show (drawingarea1);
+  gtk_box_pack_start (GTK_BOX (vbox1), drawingarea1, TRUE, TRUE, 0);
+
+  dialog_action_area1 = GTK_DIALOG (dialog1)->action_area;
+  gtk_widget_show (dialog_action_area1);
+  gtk_button_box_set_layout (GTK_BUTTON_BOX (dialog_action_area1), GTK_BUTTONBOX_END);
+
+  /* Store pointers to all widgets, for use by lookup_widget(). */
+  GLADE_HOOKUP_OBJECT_NO_REF (dialog1, dialog1, "dialog1");
+  GLADE_HOOKUP_OBJECT_NO_REF (dialog1, dialog_vbox1, "dialog_vbox1");
+  GLADE_HOOKUP_OBJECT (dialog1, vbox1, "vbox1");
+  GLADE_HOOKUP_OBJECT (dialog1, toolbar1, "toolbar1");
+  GLADE_HOOKUP_OBJECT (dialog1, toolitem1, "toolitem1");
+  GLADE_HOOKUP_OBJECT (dialog1, buttonPrev, "buttonPrev");
+  GLADE_HOOKUP_OBJECT (dialog1, toolitem2, "toolitem2");
+  GLADE_HOOKUP_OBJECT (dialog1, buttonNext, "buttonNext");
+  GLADE_HOOKUP_OBJECT (dialog1, toolitem3, "toolitem3");
+  GLADE_HOOKUP_OBJECT (dialog1, buttonStack, "buttonStack");
+  GLADE_HOOKUP_OBJECT (dialog1, drawingarea1, "drawingarea1");
+  GLADE_HOOKUP_OBJECT_NO_REF (dialog1, dialog_action_area1, "dialog_action_area1");
+
+  return dialog1;
+}
+
+
+



From gruntster at mail.berlios.de  Mon Jul 16 03:03:06 2007
From: gruntster at mail.berlios.de (gruntster at mail.berlios.de)
Date: Mon, 16 Jul 2007 03:03:06 +0200
Subject: [Avidemux-svn-commit] r3375 -
	branches/avidemux_2.4_branch/avidemux/ADM_editor
Message-ID: <200707160103.l6G136I9002121@sheep.berlios.de>

Author: gruntster
Date: 2007-07-16 03:02:58 +0200 (Mon, 16 Jul 2007)
New Revision: 3375

Modified:
   branches/avidemux_2.4_branch/avidemux/ADM_editor/ADM_edit.cpp
Log:
fix mem leak

Modified: branches/avidemux_2.4_branch/avidemux/ADM_editor/ADM_edit.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_editor/ADM_edit.cpp	2007-07-15 23:11:24 UTC (rev 3374)
+++ branches/avidemux_2.4_branch/avidemux/ADM_editor/ADM_edit.cpp	2007-07-16 01:02:58 UTC (rev 3375)
@@ -228,18 +228,21 @@
 
 ADM_Composer::~ADM_Composer ()
 {
-  deleteAllSegments ();
-  deleteAllVideos ();
-  deletePostProc(&_pp);
-  if(_imageBuffer)
-  	delete _imageBuffer;
-  _imageBuffer=NULL;
-  if(_scratch)
-    {
-      delete _scratch;
-      _scratch=NULL;
-    }
+	deleteAllSegments();
+	deleteAllVideos();
+	deletePostProc(&_pp);
 
+	if(_segments)
+	{
+		delete _segments;
+		_segments=NULL;
+	}
+
+	if(_scratch)
+	{
+		delete _scratch;
+		_scratch=NULL;
+	}
 }
 
 /*



From gruntster at mail.berlios.de  Mon Jul 16 03:22:48 2007
From: gruntster at mail.berlios.de (gruntster at mail.berlios.de)
Date: Mon, 16 Jul 2007 03:22:48 +0200
Subject: [Avidemux-svn-commit] r3376 - in
	branches/avidemux_2.4_branch/avidemux: . ADM_audiodevice
Message-ID: <200707160122.l6G1MmEt002962@sheep.berlios.de>

Author: gruntster
Date: 2007-07-16 03:22:39 +0200 (Mon, 16 Jul 2007)
New Revision: 3376

Modified:
   branches/avidemux_2.4_branch/avidemux/ADM_audiodevice/ADM_audiodevice.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_audiodevice/audio_out.h
   branches/avidemux_2.4_branch/avidemux/main.cpp
Log:
fix mem leak

Modified: branches/avidemux_2.4_branch/avidemux/ADM_audiodevice/ADM_audiodevice.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_audiodevice/ADM_audiodevice.cpp	2007-07-16 01:02:58 UTC (rev 3375)
+++ branches/avidemux_2.4_branch/avidemux/ADM_audiodevice/ADM_audiodevice.cpp	2007-07-16 01:22:39 UTC (rev 3376)
@@ -179,15 +179,25 @@
 		#endif
 		}
 }
+
+void AVDM_cleanup(void)
+{
+	if(device)
+	{
+		delete device;
+		device=NULL;
+	}
+}
 // Switch the audio device class we are using
 //
 void AVDM_switch(AUDIO_DEVICE action)
 {
 	if(device)
-	       {
-				delete device;
-			}
-	device=NULL;
+	{
+		delete device;
+		device=NULL;
+	}
+
 	 currentDevice=DEVICE_DUMMY;
 	switch(action)
 	{

Modified: branches/avidemux_2.4_branch/avidemux/ADM_audiodevice/audio_out.h
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_audiodevice/audio_out.h	2007-07-16 01:02:58 UTC (rev 3375)
+++ branches/avidemux_2.4_branch/avidemux/ADM_audiodevice/audio_out.h	2007-07-16 01:22:39 UTC (rev 3376)
@@ -72,6 +72,7 @@
 
 void 		AVDM_audioSave( void );
 void 		AVDM_audioInit( void );
+void		AVDM_cleanup(void);
 void 		AVDM_switch( AUDIO_DEVICE action );
 
 uint8_t 	AVDM_AudioPlay(float *ptr, uint32_t nb);

Modified: branches/avidemux_2.4_branch/avidemux/main.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/main.cpp	2007-07-16 01:02:58 UTC (rev 3375)
+++ branches/avidemux_2.4_branch/avidemux/main.cpp	2007-07-16 01:22:39 UTC (rev 3376)
@@ -310,6 +310,10 @@
 	quitSdl();
 #endif
 
+#ifdef HAVE_AUDIO
+	AVDM_cleanup();
+#endif
+
     printf("End of cleanup\n");
     ADMImage_stat();
     ADM_memStat();



From gruntster at mail.berlios.de  Mon Jul 16 04:32:12 2007
From: gruntster at mail.berlios.de (gruntster at mail.berlios.de)
Date: Mon, 16 Jul 2007 04:32:12 +0200
Subject: [Avidemux-svn-commit] r3377 - branches/avidemux_2.4_branch/avidemux
Message-ID: <200707160232.l6G2WCiX006929@sheep.berlios.de>

Author: gruntster
Date: 2007-07-16 04:31:51 +0200 (Mon, 16 Jul 2007)
New Revision: 3377

Modified:
   branches/avidemux_2.4_branch/avidemux/main.cpp
Log:
fix mem leak (pref)

Modified: branches/avidemux_2.4_branch/avidemux/main.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/main.cpp	2007-07-16 01:22:39 UTC (rev 3376)
+++ branches/avidemux_2.4_branch/avidemux/main.cpp	2007-07-16 02:31:51 UTC (rev 3377)
@@ -259,6 +259,7 @@
 	{
 		filterDynLoad(dynloadPath);
 	}
+	ADM_dealloc(dynloadPath);
 
 // external filter
 #ifdef USE_FFMPEG



From gruntster at mail.berlios.de  Mon Jul 16 04:53:48 2007
From: gruntster at mail.berlios.de (gruntster at mail.berlios.de)
Date: Mon, 16 Jul 2007 04:53:48 +0200
Subject: [Avidemux-svn-commit] r3378 -
	branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_utilities
Message-ID: <200707160253.l6G2rmIc007705@sheep.berlios.de>

Author: gruntster
Date: 2007-07-16 04:53:39 +0200 (Mon, 16 Jul 2007)
New Revision: 3378

Modified:
   branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_utilities/prefs.cpp
Log:
fix mem leak (prefs)

Modified: branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_utilities/prefs.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_utilities/prefs.cpp	2007-07-16 02:31:51 UTC (rev 3377)
+++ branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_utilities/prefs.cpp	2007-07-16 02:53:39 UTC (rev 3378)
@@ -974,11 +974,21 @@
   prefs = new preferences();
   return 1;
 }
-int destroyPrefs(  void )
+
+int destroyPrefs(void)
 {
-  delete prefs;
-  prefs=NULL;
-  return 1;
+	for (int i = 0; i < num_opts; i++)
+	{
+		if (opt_defs[i].current_val)
+		{
+			ADM_dealloc(opt_defs[i].current_val);
+			opt_defs[i].current_val=NULL;
+		}
+	}
+
+	delete prefs;
+	prefs = NULL;
+	return 1;
 }
 
 // EOF



From gruntster at mail.berlios.de  Mon Jul 16 14:04:05 2007
From: gruntster at mail.berlios.de (gruntster at mail.berlios.de)
Date: Mon, 16 Jul 2007 14:04:05 +0200
Subject: [Avidemux-svn-commit] r3379 - in
	branches/avidemux_2.4_branch/avidemux: .
	ADM_userInterfaces/ADM_GTK/ADM_gui2
	ADM_userInterfaces/ADM_NONE/ADM_dialog
	ADM_userInterfaces/ADM_QT4/ADM_dialog
	ADM_userInterfaces/ADM_commonUI
Message-ID: <200707161204.l6GC45rA003664@sheep.berlios.de>

Author: gruntster
Date: 2007-07-16 14:03:45 +0200 (Mon, 16 Jul 2007)
New Revision: 3379

Modified:
   branches/avidemux_2.4_branch/avidemux/ADM_preview.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_bindings.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_NONE/ADM_dialog/DIA_none.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_none.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/GUI_render.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/GUI_render.h
   branches/avidemux_2.4_branch/avidemux/gtk_gui.cpp
   branches/avidemux_2.4_branch/avidemux/main.cpp
Log:
fix mem leak (playback)

Modified: branches/avidemux_2.4_branch/avidemux/ADM_preview.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_preview.cpp	2007-07-16 02:53:39 UTC (rev 3378)
+++ branches/avidemux_2.4_branch/avidemux/ADM_preview.cpp	2007-07-16 12:03:45 UTC (rev 3379)
@@ -527,4 +527,36 @@
     }
 }
 
+void admPreview::cleanUp(void)
+{
+	if(rdrImage)
+	{
+		delete rdrImage;
+		rdrImage = NULL;
+	}
+
+	if(original)
+    {
+		delete original;
+		original=NULL;
+	}
+
+	if(previewImage)
+	{
+		delete previewImage; 
+		previewImage=NULL;
+	}
+
+	if(resized)
+	{
+		delete resized;
+		resized=NULL;
+	}
+
+	if(resizer)
+	{
+		delete resizer;
+		resizer=NULL;
+	}
+}
 // EOF

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_bindings.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_bindings.cpp	2007-07-16 02:53:39 UTC (rev 3378)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_bindings.cpp	2007-07-16 12:03:45 UTC (rev 3379)
@@ -237,6 +237,12 @@
                
 	return ret;
 }
+
+void destroyGUI(void)
+{
+	renderDestroy();
+}
+
 /**
     \fn GUI_gtk_grow_off
     \brief allow main window to grow or not

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_NONE/ADM_dialog/DIA_none.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_NONE/ADM_dialog/DIA_none.cpp	2007-07-16 02:53:39 UTC (rev 3378)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_NONE/ADM_dialog/DIA_none.cpp	2007-07-16 12:03:45 UTC (rev 3379)
@@ -114,6 +114,7 @@
 int GUI_handleVFilter (void){return 0;}
 uint8_t  initFileSelector(void){return 0;}
 uint8_t initGUI( void ){return 1;}
+void destroyGUI(void) {}
 
 uint8_t DIA_job(uint32_t nb,char **name){return 0;}
 //uint8_t DIA_lavDecoder(uint32_t *swapUv, uint32_t *showU){return 0;}

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_none.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_none.cpp	2007-07-16 02:53:39 UTC (rev 3378)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_none.cpp	2007-07-16 12:03:45 UTC (rev 3379)
@@ -96,6 +96,7 @@
 void    DIA_Calculator(uint32_t *sizeInMeg, uint32_t *avgBitrate ){return ;}
 uint8_t initFileSelector(void){return 0;}
 uint8_t initGUI( void ){return 1;}
+void destroyGUI(void) {}
 int DIA_colorSel(uint8_t *r, uint8_t *g, uint8_t *b) {return 0;}
 uint8_t DIA_glyphEdit(void){ return 0;};
 

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/GUI_render.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/GUI_render.cpp	2007-07-16 02:53:39 UTC (rev 3378)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/GUI_render.cpp	2007-07-16 12:03:45 UTC (rev 3379)
@@ -79,6 +79,16 @@
 	draw=UI_getDrawWidget(  );
 	return 1;
 }
+
+void renderDestroy(void)
+{
+	if(screenBuffer) 
+	{
+		delete[] screenBuffer;
+		screenBuffer = NULL;
+	}
+}
+
 /**
     \fn renderLock
     \brief Take the weak lock (i.e. not threadsafe)

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/GUI_render.h
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/GUI_render.h	2007-07-16 02:53:39 UTC (rev 3378)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/GUI_render.h	2007-07-16 12:03:45 UTC (rev 3379)
@@ -61,14 +61,11 @@
       static void updateFilters(AVDMGenericVideoStream *first,AVDMGenericVideoStream *last);
       static void deferDisplay(uint32_t onoff,uint32_t startat);
       static void displayNow(uint32_t framenum);
-  
+	  static void cleanUp(void);  
 };
 
-
-
-
-
 uint8_t renderInit( void );
+void renderDestroy(void);
 uint8_t renderResize(uint32_t w, uint32_t h,uint32_t phyW,uint32_t phyH);
 uint8_t renderRefresh(void);
 uint8_t renderExpose(void);

Modified: branches/avidemux_2.4_branch/avidemux/gtk_gui.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/gtk_gui.cpp	2007-07-16 02:53:39 UTC (rev 3378)
+++ branches/avidemux_2.4_branch/avidemux/gtk_gui.cpp	2007-07-16 12:03:45 UTC (rev 3379)
@@ -1626,30 +1626,31 @@
 //      Clean up
 //      free all pending stuff, make leakchecker happy
 //
-void
-cleanUp (void)
+void cleanUp (void)
 {
-  if (avifileinfo)
-  {
-    delete avifileinfo;
-    avifileinfo=NULL;
-   }
-  if (currentaudiostream)
-    {
-      // always destroyable on exit           if(currentaudiostream->isDestroyable())
-      delete currentaudiostream;
-      currentaudiostream=NULL;
-    }
-  if (video_body)
-  {
-    delete video_body;
-    video_body=NULL;
-   }
-  //
-  filterCleanUp ();
+	if (avifileinfo)
+	{
+		delete avifileinfo;
+		avifileinfo=NULL;
+	}
 
+	if (currentaudiostream)
+	{
+	// always destroyable on exit           if(currentaudiostream->isDestroyable())
+		delete currentaudiostream;
+		currentaudiostream=NULL;
+	}
 
+	if (video_body)
+	{
+		delete video_body;
+		video_body=NULL;
+	}
+
+	filterCleanUp();
+	admPreview::cleanUp();
 }
+
 extern uint8_t selecEncoder (uint8_t * codec);
 
 

Modified: branches/avidemux_2.4_branch/avidemux/main.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/main.cpp	2007-07-16 02:53:39 UTC (rev 3378)
+++ branches/avidemux_2.4_branch/avidemux/main.cpp	2007-07-16 12:03:45 UTC (rev 3379)
@@ -81,6 +81,7 @@
 extern void  buildDistMatrix( void );
 extern void initScaleTab( void );
 extern uint8_t initGUI( void );
+extern void destroyGUI(void);
 extern void COL_init(void);
 extern uint8_t initFileSelector(void);
 extern void AUDMEncoder_initDither(void);
@@ -315,6 +316,8 @@
 	AVDM_cleanup();
 #endif
 
+	destroyGUI();
+
     printf("End of cleanup\n");
     ADMImage_stat();
     ADM_memStat();



From gruntster at mail.berlios.de  Mon Jul 16 14:54:58 2007
From: gruntster at mail.berlios.de (gruntster at mail.berlios.de)
Date: Mon, 16 Jul 2007 14:54:58 +0200
Subject: [Avidemux-svn-commit] r3380 -
	branches/avidemux_2.4_branch/avidemux/ADM_codecs
Message-ID: <200707161254.l6GCsw2I007442@sheep.berlios.de>

Author: gruntster
Date: 2007-07-16 14:54:51 +0200 (Mon, 16 Jul 2007)
New Revision: 3380

Modified:
   branches/avidemux_2.4_branch/avidemux/ADM_codecs/ADM_mpeg.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_codecs/ADM_mpeg.h
Log:
fix mem leaks (mpeg decoder)

Modified: branches/avidemux_2.4_branch/avidemux/ADM_codecs/ADM_mpeg.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_codecs/ADM_mpeg.cpp	2007-07-16 12:03:45 UTC (rev 3379)
+++ branches/avidemux_2.4_branch/avidemux/ADM_codecs/ADM_mpeg.cpp	2007-07-16 12:54:51 UTC (rev 3380)
@@ -83,15 +83,16 @@
   uint8_t *buffer;
 } yv12_instance_t;
 
-static uint8_t *iBuff[3];
-static uint8_t *oBuff[3];
-static int strideTab[3], strideTab2[3];
-
-decoderMpeg::~decoderMpeg ()
+decoderMpeg::~decoderMpeg()
 {
-#warning clean up libmpeg2 here
-  kill_codec ();
-  delete[]unpackBuffer;
+	kill_codec();
+	delete[] unpackBuffer;
+
+	if (_seqHeader)
+	{
+		delete[] _seqHeader;
+		_seqHeader = NULL;
+	}
 }
 //____________________________________
 uint8_t decoderMpeg::isMpeg1 (void)
@@ -116,6 +117,7 @@
   mpeg2_close (MPEG2DEC);
   _decoder = NULL;
   yv12_close (output);
+  output = NULL;
 
   return 1;
 }
@@ -132,52 +134,48 @@
 		Constructor for mpeg decoder
 ______________________________________________________________________________________
 */
-decoderMpeg::decoderMpeg (uint32_t w, uint32_t h, uint32_t extraLen, uint8_t * extraData):decoders (w,
-	  h)
+decoderMpeg::decoderMpeg (uint32_t w, uint32_t h, uint32_t extraLen, uint8_t * extraData) : decoders (w,h)
 {
-  mpeg2_decoder_t *
-    dec;
-  uint32_t wmb, hmb;
-  yv12_instance_t *
-    inst;
-  _seqLen = extraLen;
-  if (extraLen)
-    {
-      _seqHeader = new uint8_t[extraLen];
-      memcpy (_seqHeader, extraData, extraLen);
-    }
-  else
-    {
-      _seqHeader = NULL;
-    }
-  // store for future use
-  _seqFound = 0;
-  par_width=par_height=1;
-  postprocessed = NULL;
-  // now init libmpeg2
-  printf ("\n initializing mpeg2 decoder %lu x %lu\n", _w, _h);
-  output = yv12_open ();
-  inst = (yv12_instance_t *) output;
-  unpackBuffer = new uint8_t[(w * h * 9) >> 1];
-  inst->buffer = unpackBuffer;
-  _decoder = mpeg2_init ();
-  dec = &((MPEG2DEC)->decoder);
-  wmb = (_w + 15) >> 4;;
-  hmb = (_h + 15) >> 4;;
-  dec->quant_stride = wmb;
-  dec->quant = (int8_t *) ADM_alloc ((wmb * hmb) * sizeof (int8_t));
-  //
-  feedData (extraLen, _seqHeader);
-  feedData (extraLen, _seqHeader);
+	mpeg2_decoder_t *dec;
+	uint32_t wmb, hmb;
+	yv12_instance_t *inst;
 
-  // Post processing settings
-  //___________________________
+	_seqLen = extraLen;
 
-  _swapUV = 0;
-  // Post Proc is disabled by default
+	if (extraLen)
+	{
+		_seqHeader = new uint8_t[extraLen];
+		memcpy (_seqHeader, extraData, extraLen);
+	}
+	else
+		_seqHeader = NULL;
 
-  printf ("\n done\n");
+	// store for future use
+	_seqFound = 0;
+	par_width=par_height=1;
 
+	printf ("\nInitializing MPEG2 decoder %lu x %lu\n", _w, _h);
+	output = yv12_open ();
+	inst = (yv12_instance_t *) output;
+	unpackBuffer = new uint8_t[(w * h * 9) >> 1];
+	inst->buffer = unpackBuffer;
+	_decoder = mpeg2_init();
+	dec = &((MPEG2DEC)->decoder);
+
+	wmb = (_w + 15) >> 4;;
+	hmb = (_h + 15) >> 4;;
+
+	dec->quant_stride = wmb;
+	dec->quant = (int8_t *)ADM_alloc ((wmb * hmb) * sizeof (int8_t));
+
+	feedData (extraLen, _seqHeader);
+	feedData (extraLen, _seqHeader);
+
+	// Post processing settings
+	_swapUV = 0;
+	// Post Proc is disabled by default
+
+	printf ("\nDone\n");
 }
 /*------------------------------------------------------------------*/
 uint8_t
@@ -411,8 +409,8 @@
 void
 yv12_close (vo_instance_t * _instance)
 {
-  UNUSED_ARG (_instance);
-  printf (" yv12close called\n");
+	delete _instance;
+	printf ("yv12close called\n");
 }
 
 /**

Modified: branches/avidemux_2.4_branch/avidemux/ADM_codecs/ADM_mpeg.h
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_codecs/ADM_mpeg.h	2007-07-16 12:03:45 UTC (rev 3379)
+++ branches/avidemux_2.4_branch/avidemux/ADM_codecs/ADM_mpeg.h	2007-07-16 12:54:51 UTC (rev 3380)
@@ -26,7 +26,6 @@
   uint8_t *_seqHeader;
   uint32_t _seqLen;
   uint8_t _seqFound;
-  uint8_t *postprocessed;
   uint8_t par_height;
   uint8_t par_width;
 



From gruntster at mail.berlios.de  Mon Jul 16 15:41:54 2007
From: gruntster at mail.berlios.de (gruntster at mail.berlios.de)
Date: Mon, 16 Jul 2007 15:41:54 +0200
Subject: [Avidemux-svn-commit] r3381 -
	branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_toolkit_gtk
Message-ID: <200707161341.l6GDfsJB010520@sheep.berlios.de>

Author: gruntster
Date: 2007-07-16 15:41:41 +0200 (Mon, 16 Jul 2007)
New Revision: 3381

Modified:
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_toolkit_gtk/TLK_filesel.cpp
Log:
fix mem leak (GTK file chooser)

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_toolkit_gtk/TLK_filesel.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_toolkit_gtk/TLK_filesel.cpp	2007-07-16 12:54:51 UTC (rev 3380)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_toolkit_gtk/TLK_filesel.cpp	2007-07-16 13:41:41 UTC (rev 3381)
@@ -462,6 +462,7 @@
                 }
                 delete [] str;
         }
+		ADM_dealloc(tmpname);
         if(gtk_dialog_run(GTK_DIALOG(dialog))==GTK_RESPONSE_ACCEPT)
 	{
 



From gruntster at mail.berlios.de  Mon Jul 16 18:40:01 2007
From: gruntster at mail.berlios.de (gruntster at mail.berlios.de)
Date: Mon, 16 Jul 2007 18:40:01 +0200
Subject: [Avidemux-svn-commit] r3382 -
	branches/avidemux_2.4_branch/avidemux/ADM_inputs/ADM_asf
Message-ID: <200707161640.l6GGe1Ig006130@sheep.berlios.de>

Author: gruntster
Date: 2007-07-16 18:39:52 +0200 (Mon, 16 Jul 2007)
New Revision: 3382

Modified:
   branches/avidemux_2.4_branch/avidemux/ADM_inputs/ADM_asf/ADM_asf.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_inputs/ADM_asf/ADM_asfPacket.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_inputs/ADM_asf/ADM_asf_audio.cpp
Log:
fix mem leaks (asf)

Modified: branches/avidemux_2.4_branch/avidemux/ADM_inputs/ADM_asf/ADM_asf.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_inputs/ADM_asf/ADM_asf.cpp	2007-07-16 13:41:41 UTC (rev 3381)
+++ branches/avidemux_2.4_branch/avidemux/ADM_inputs/ADM_asf/ADM_asf.cpp	2007-07-16 16:39:52 UTC (rev 3382)
@@ -68,6 +68,11 @@
 
 uint8_t asfHeader::close(void)
 {
+	if (_fd) 
+		fclose(_fd);
+
+	_fd=NULL;
+
   if(_videoExtraData)
   {
     delete [] _videoExtraData;
@@ -255,7 +260,7 @@
           {
             aprintf("Dropping seq=%u too old for %u delta %d\n",
                   bit->sequence,_index[framenum].segNb,delta);
-            delete bit->data;
+            delete[] bit->data;
             delete bit;
             if(delta<230)
             {
@@ -271,7 +276,7 @@
           curSeq=bit->sequence;
           memcpy(img->data,bit->data,bit->len);
           len=bit->len;
-          delete bit->data;
+          delete[] bit->data;
           delete bit;
           continue;
       }
@@ -288,6 +293,7 @@
       // still same sequence ...add
       memcpy(img->data+len,bit->data,bit->len);
       len+=bit->len;
+	  delete[] bit->data;
       delete bit;
     }
     if(!_packet->nextPacket(_videoStreamId))
@@ -722,7 +728,7 @@
           printf("Unmapped stream %u\n",bit->stream); 
         }
       }
-     delete bit->data;
+     delete[] bit->data;
      delete bit;
     }
     //working->update(packet,_nbPackets);
@@ -739,7 +745,7 @@
   delete [] tmpIndex;
   
   fseeko(_fd,_dataStartOffset,SEEK_SET);
-  printf("[ASF]%u images found\n",nbImage);
+  printf("[ASF] %u images found\n",nbImage);
   printf("[ASF] ******** End of buildindex *******\n");
   _videostream.dwLength=_mainaviheader.dwTotalFrames=nbImage;
   if(!nbImage) return 0;

Modified: branches/avidemux_2.4_branch/avidemux/ADM_inputs/ADM_asf/ADM_asfPacket.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_inputs/ADM_asf/ADM_asfPacket.cpp	2007-07-16 13:41:41 UTC (rev 3381)
+++ branches/avidemux_2.4_branch/avidemux/ADM_inputs/ADM_asf/ADM_asfPacket.cpp	2007-07-16 16:39:52 UTC (rev 3382)
@@ -50,6 +50,7 @@
  }
  asfPacket::~asfPacket()
  {
+	 purge();
  }
  uint8_t   asfPacket::readChunkPayload(uint8_t *data, uint32_t *dataLen)
  {
@@ -304,11 +305,14 @@
    bit->stream=stream;
    bit->packet=packetnb;
    bit->flags=keyframe;
+
    if(!read(bit->data,bit->len))
    {
-     delete bit;
-     return 0; 
+		delete[] bit->data;
+		delete bit;
+		return 0; 
    }
+
    queue->push((void *)bit);
    return 1;
  }

Modified: branches/avidemux_2.4_branch/avidemux/ADM_inputs/ADM_asf/ADM_asf_audio.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_inputs/ADM_asf/ADM_asf_audio.cpp	2007-07-16 13:41:41 UTC (rev 3381)
+++ branches/avidemux_2.4_branch/avidemux/ADM_inputs/ADM_asf/ADM_asf_audio.cpp	2007-07-16 16:39:52 UTC (rev 3382)
@@ -36,7 +36,16 @@
 
 asfAudio::~asfAudio()
 {
-  printf("[asfAudio] Destroying track\n");
+	printf("[asfAudio] Destroying track\n");
+
+	fclose(_fd);
+	_fd = NULL;
+
+	delete _wavheader;
+	delete _packet;
+
+	_wavheader = NULL;
+	_packet = NULL;
 }
 /*
     __________________________________________________________



From mean at mail.berlios.de  Mon Jul 16 19:44:25 2007
From: mean at mail.berlios.de (mean at BerliOS)
Date: Mon, 16 Jul 2007 19:44:25 +0200
Subject: [Avidemux-svn-commit] r3383 -
	branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavformat
Message-ID: <200707161744.l6GHiP55008123@sheep.berlios.de>

Author: mean
Date: 2007-07-16 19:44:22 +0200 (Mon, 16 Jul 2007)
New Revision: 3383

Modified:
   branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavformat/ADM_lavformat.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavformat/allformats.c
   branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavformat/allformats.h
   branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavformat/avformat.h
   branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavformat/avienc.c
   branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavformat/avio.c
   branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavformat/avio.h
   branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavformat/aviobuf.c
   branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavformat/cutils.c
   branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavformat/dv.h
   branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavformat/file.c
   branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavformat/flv.h
   branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavformat/img2.c
   branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavformat/isom.c
   branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavformat/isom.h
   branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavformat/matroska.c
   branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavformat/mov.c
   branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavformat/movenc.c
   branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavformat/mpeg.c
   branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavformat/mpegts.h
   branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavformat/mpegtsenc.c
   branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavformat/qtpalette.h
   branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavformat/riff.c
   branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavformat/riff.h
   branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavformat/rtp.h
   branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavformat/rtsp.h
   branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavformat/rtspcodes.h
   branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavformat/utils.c
   branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavformat/wav.c
Log:
[LAV] update to RR9685 

Modified: branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavformat/ADM_lavformat.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavformat/ADM_lavformat.cpp	2007-07-16 16:39:52 UTC (rev 3382)
+++ branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavformat/ADM_lavformat.cpp	2007-07-16 17:44:22 UTC (rev 3383)
@@ -611,12 +611,9 @@
      extern  int        movenc_init(void );
 };
 extern URLProtocol file_protocol ;
-extern AVInputFormat matroska_demuxer;
 uint8_t lavformat_init(void)
 {
-//                mpegps_init();
                 movenc_init();
-                av_register_input_format(&matroska_demuxer);
                 register_protocol(&file_protocol);
 }
 extern "C"

Modified: branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavformat/allformats.c
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavformat/allformats.c	2007-07-16 16:39:52 UTC (rev 3382)
+++ branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavformat/allformats.c	2007-07-16 17:44:22 UTC (rev 3383)
@@ -26,12 +26,14 @@
 #define REGISTER_DEMUXER(X,x) \
           if(ENABLE_##X##_DEMUXER) av_register_input_format(&x##_demuxer)
 #define REGISTER_MUXDEMUX(X,x)  REGISTER_MUXER(X,x); REGISTER_DEMUXER(X,x)
+#define REGISTER_PROTOCOL(X,x) \
+          if(ENABLE_##X##_PROTOCOL) register_protocol(&x##_protocol)
 
 /* If you do not call this function, then you can select exactly which
    formats you want to support */
 
 /**
- * Initialize libavcodec and register all the codecs and formats.
+ * Initialize libavformat and register all the (de)muxers and protocols.
  */
 void av_register_all(void)
 {
@@ -49,28 +51,26 @@
     REGISTER_MUXER   (ADTS, adts);
     REGISTER_MUXDEMUX(AIFF, aiff);
     REGISTER_MUXDEMUX(AMR, amr);
+    REGISTER_DEMUXER (APC, apc);
     REGISTER_MUXDEMUX(ASF, asf);
     REGISTER_MUXER   (ASF_STREAM, asf_stream);
     REGISTER_MUXDEMUX(AU, au);
-#if defined(CONFIG_AUDIO_OSS) || defined(CONFIG_AUDIO_BEOS)
     REGISTER_MUXDEMUX(AUDIO, audio);
-#endif
     REGISTER_MUXDEMUX(AVI, avi);
 #ifdef CONFIG_AVISYNTH
     av_register_input_format(&avisynth_demuxer);
 #endif
     REGISTER_DEMUXER (AVS, avs);
+    REGISTER_DEMUXER (BETHSOFTVID, bethsoftvid);
+    REGISTER_DEMUXER (C93, c93);
     REGISTER_MUXER   (CRC, crc);
     REGISTER_DEMUXER (DAUD, daud);
-#ifdef CONFIG_DC1394
     REGISTER_DEMUXER (DC1394, dc1394);
-#endif
     REGISTER_DEMUXER (DSICIN, dsicin);
     REGISTER_DEMUXER (DTS, dts);
     REGISTER_MUXDEMUX(DV, dv);
-#ifdef CONFIG_DV1394
     REGISTER_DEMUXER (DV1394, dv1394);
-#endif
+    REGISTER_DEMUXER (DXA, dxa);
     REGISTER_DEMUXER (EA, ea);
     REGISTER_MUXDEMUX(FFM, ffm);
     REGISTER_MUXDEMUX(FLAC, flac);
@@ -80,9 +80,7 @@
     REGISTER_MUXER   (FRAMECRC, framecrc);
     REGISTER_MUXDEMUX(GIF, gif);
     REGISTER_DEMUXER (GXF, gxf);
-#ifdef CONFIG_GPL
     REGISTER_MUXER   (GXF, gxf);
-#endif
     REGISTER_MUXDEMUX(H261, h261);
     REGISTER_MUXDEMUX(H263, h263);
     REGISTER_MUXDEMUX(H264, h264);
@@ -91,6 +89,8 @@
     REGISTER_MUXDEMUX(IMAGE2PIPE, image2pipe);
     REGISTER_DEMUXER (INGENIENT, ingenient);
     REGISTER_DEMUXER (IPMOVIE, ipmovie);
+    if (!ENABLE_NUT_DEMUXER) REGISTER_DEMUXER (LIBNUT, libnut);
+    REGISTER_MUXER   (LIBNUT, libnut);
     REGISTER_MUXDEMUX(M4V, m4v);
     REGISTER_DEMUXER (MATROSKA, matroska);
     REGISTER_MUXDEMUX(MJPEG, mjpeg);
@@ -110,6 +110,7 @@
     REGISTER_MUXER   (MPEG2VOB, mpeg2vob);
     REGISTER_DEMUXER (MPEGPS, mpegps);
     REGISTER_MUXDEMUX(MPEGTS, mpegts);
+    REGISTER_DEMUXER (MPEGTSRAW, mpegtsraw);
     REGISTER_DEMUXER (MPEGVIDEO, mpegvideo);
     REGISTER_MUXER   (MPJPEG, mpjpeg);
     REGISTER_DEMUXER (MTV, mtv);
@@ -117,14 +118,9 @@
     REGISTER_DEMUXER (NSV, nsv);
     REGISTER_MUXER   (NULL, null);
     REGISTER_DEMUXER (NUT, nut);
-#ifdef CONFIG_LIBNUT
-    REGISTER_MUXER   (NUT, nut);
-#endif
     REGISTER_DEMUXER (NUV, nuv);
     REGISTER_DEMUXER (OGG, ogg);
-#ifdef CONFIG_LIBOGG
     REGISTER_MUXER   (OGG, ogg);
-#endif
     REGISTER_MUXDEMUX(PCM_ALAW,  pcm_alaw);
     REGISTER_MUXDEMUX(PCM_MULAW, pcm_mulaw);
     REGISTER_MUXDEMUX(PCM_S16BE, pcm_s16be);
@@ -136,12 +132,12 @@
     REGISTER_MUXER   (PSP, psp);
     REGISTER_MUXDEMUX(RAWVIDEO, rawvideo);
     REGISTER_MUXDEMUX(RM, rm);
-    REGISTER_DEMUXER (ROQ, roq);
-#ifdef CONFIG_NETWORK
+    REGISTER_MUXDEMUX(ROQ, roq);
     REGISTER_DEMUXER (REDIR, redir);
     REGISTER_MUXER   (RTP, rtp);
     REGISTER_DEMUXER (RTSP, rtsp);
     REGISTER_DEMUXER (SDP, sdp);
+#ifdef CONFIG_RTP_MUXER
     av_register_rtp_dynamic_payload_handlers();
 #endif
     REGISTER_DEMUXER (SEGAFILM, segafilm);
@@ -152,14 +148,14 @@
     REGISTER_MUXDEMUX(SWF, swf);
     REGISTER_MUXER   (TG2, tg2);
     REGISTER_MUXER   (TGP, tgp);
+    REGISTER_DEMUXER (THP, thp);
     REGISTER_DEMUXER (TIERTEXSEQ, tiertexseq);
     REGISTER_DEMUXER (TTA, tta);
-#ifdef CONFIG_VIDEO4LINUX2
+    REGISTER_DEMUXER (TXD, txd);
     REGISTER_DEMUXER (V4L2, v4l2);
-#endif
-#if defined(CONFIG_VIDEO4LINUX) || defined(CONFIG_BKTR)
-    REGISTER_DEMUXER (VIDEO_GRAB_DEVICE, video_grab_device);
-#endif
+    REGISTER_DEMUXER (VC1, vc1);
+    REGISTER_DEMUXER (VIDEO_GRAB_BKTR, video_grab_bktr);
+    REGISTER_DEMUXER (VIDEO_GRAB_V4L, video_grab_v4l);
     REGISTER_DEMUXER (VMD, vmd);
     REGISTER_MUXDEMUX(VOC, voc);
     REGISTER_MUXDEMUX(WAV, wav);
@@ -167,20 +163,13 @@
     REGISTER_DEMUXER (WSAUD, wsaud);
     REGISTER_DEMUXER (WSVQA, wsvqa);
     REGISTER_DEMUXER (WV, wv);
-#ifdef CONFIG_X11GRAB
     REGISTER_DEMUXER (X11_GRAB_DEVICE, x11_grab_device);
-#endif
     REGISTER_MUXDEMUX(YUV4MPEGPIPE, yuv4mpegpipe);
 
-#ifdef CONFIG_PROTOCOLS
-    /* file protocols */
-    register_protocol(&file_protocol);
-    register_protocol(&pipe_protocol);
-#ifdef CONFIG_NETWORK
-    register_protocol(&udp_protocol);
-    register_protocol(&rtp_protocol);
-    register_protocol(&tcp_protocol);
-    register_protocol(&http_protocol);
-#endif
-#endif
+    REGISTER_PROTOCOL(FILE, file);
+    REGISTER_PROTOCOL(HTTP, http);
+    REGISTER_PROTOCOL(PIPE, pipe);
+    REGISTER_PROTOCOL(RTP, rtp);
+    REGISTER_PROTOCOL(TCP, tcp);
+    REGISTER_PROTOCOL(UDP, udp);
 }

Modified: branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavformat/allformats.h
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavformat/allformats.h	2007-07-16 16:39:52 UTC (rev 3382)
+++ branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavformat/allformats.h	2007-07-16 17:44:22 UTC (rev 3383)
@@ -22,150 +22,164 @@
 #ifndef ALLFORMATS_H
 #define ALLFORMATS_H
 
-extern AVInputFormat fourxm_demuxer;
-extern AVOutputFormat adts_muxer;
+#include "avformat.h"
+
+extern AVInputFormat aac_demuxer;
+extern AVInputFormat ac3_demuxer;
 extern AVInputFormat aiff_demuxer;
-extern AVOutputFormat aiff_muxer;
 extern AVInputFormat amr_demuxer;
-extern AVOutputFormat amr_muxer;
+extern AVInputFormat apc_demuxer;
 extern AVInputFormat asf_demuxer;
-extern AVOutputFormat asf_muxer;
-extern AVOutputFormat asf_stream_muxer;
 extern AVInputFormat au_demuxer;
-extern AVOutputFormat au_muxer;
 extern AVInputFormat audio_demuxer;
-extern AVOutputFormat audio_muxer;
 extern AVInputFormat avi_demuxer;
-extern AVOutputFormat avi_muxer;
 extern AVInputFormat avisynth_demuxer;
 extern AVInputFormat avs_demuxer;
-extern AVOutputFormat crc_muxer;
-extern AVOutputFormat framecrc_muxer;
+extern AVInputFormat bethsoftvid_demuxer;
+extern AVInputFormat c93_demuxer;
 extern AVInputFormat daud_demuxer;
 extern AVInputFormat dc1394_demuxer;
 extern AVInputFormat dsicin_demuxer;
+extern AVInputFormat dts_demuxer;
 extern AVInputFormat dv1394_demuxer;
 extern AVInputFormat dv_demuxer;
-extern AVOutputFormat dv_muxer;
+extern AVInputFormat dxa_demuxer;
 extern AVInputFormat ea_demuxer;
 extern AVInputFormat ffm_demuxer;
-extern AVOutputFormat ffm_muxer;
+extern AVInputFormat flac_demuxer;
 extern AVInputFormat flic_demuxer;
 extern AVInputFormat flv_demuxer;
-extern AVOutputFormat flv_muxer;
-extern AVOutputFormat gif_muxer;
+extern AVInputFormat fourxm_demuxer;
 extern AVInputFormat gif_demuxer;
-extern AVInputFormat video_grab_device_demuxer;
 extern AVInputFormat gxf_demuxer;
-extern AVOutputFormat gxf_muxer;
+extern AVInputFormat h261_demuxer;
+extern AVInputFormat h263_demuxer;
+extern AVInputFormat h264_demuxer;
 extern AVInputFormat idcin_demuxer;
-extern AVInputFormat roq_demuxer;
 extern AVInputFormat image2_demuxer;
 extern AVInputFormat image2pipe_demuxer;
-extern AVOutputFormat image2_muxer;
-extern AVOutputFormat image2pipe_muxer;
 extern AVInputFormat image_demuxer;
 extern AVInputFormat imagepipe_demuxer;
-extern AVOutputFormat image_muxer;
-extern AVOutputFormat imagepipe_muxer;
+extern AVInputFormat ingenient_demuxer;
 extern AVInputFormat ipmovie_demuxer;
+extern AVInputFormat libnut_demuxer;
+extern AVInputFormat m4v_demuxer;
 extern AVInputFormat matroska_demuxer;
+extern AVInputFormat mjpeg_demuxer;
 extern AVInputFormat mm_demuxer;
 extern AVInputFormat mmf_demuxer;
-extern AVOutputFormat mmf_muxer;
 extern AVInputFormat mov_demuxer;
-extern AVOutputFormat mov_muxer;
-extern AVOutputFormat tgp_muxer;
-extern AVOutputFormat mp4_muxer;
-extern AVOutputFormat psp_muxer;
-extern AVOutputFormat tg2_muxer;
 extern AVInputFormat mp3_demuxer;
-extern AVOutputFormat mp2_muxer;
-extern AVOutputFormat mp3_muxer;
 extern AVInputFormat mpc_demuxer;
-extern AVOutputFormat mpeg1system_muxer;
-extern AVOutputFormat mpeg1vcd_muxer;
-extern AVOutputFormat mpeg2vob_muxer;
-extern AVOutputFormat mpeg2svcd_muxer;
-extern AVOutputFormat mpeg2dvd_muxer;
 extern AVInputFormat mpegps_demuxer;
 extern AVInputFormat mpegts_demuxer;
-extern AVOutputFormat mpegts_muxer;
-extern AVOutputFormat mpjpeg_muxer;
+extern AVInputFormat mpegtsraw_demuxer;
+extern AVInputFormat mpegvideo_demuxer;
 extern AVInputFormat mtv_demuxer;
 extern AVInputFormat mxf_demuxer;
 extern AVInputFormat nsv_demuxer;
 extern AVInputFormat nut_demuxer;
-extern AVOutputFormat nut_muxer;
 extern AVInputFormat nuv_demuxer;
 extern AVInputFormat ogg_demuxer;
-extern AVOutputFormat ogg_muxer;
-extern AVInputFormat str_demuxer;
-extern AVInputFormat shorten_demuxer;
-extern AVInputFormat flac_demuxer;
-extern AVOutputFormat flac_muxer;
-extern AVInputFormat ac3_demuxer;
-extern AVOutputFormat ac3_muxer;
-extern AVInputFormat dts_demuxer;
-extern AVInputFormat aac_demuxer;
-extern AVInputFormat h261_demuxer;
-extern AVOutputFormat h261_muxer;
-extern AVInputFormat h263_demuxer;
-extern AVOutputFormat h263_muxer;
-extern AVInputFormat m4v_demuxer;
-extern AVOutputFormat m4v_muxer;
-extern AVInputFormat h264_demuxer;
-extern AVOutputFormat h264_muxer;
-extern AVInputFormat mpegvideo_demuxer;
-extern AVOutputFormat mpeg1video_muxer;
-extern AVOutputFormat mpeg2video_muxer;
-extern AVInputFormat mjpeg_demuxer;
-extern AVInputFormat ingenient_demuxer;
-extern AVOutputFormat mjpeg_muxer;
+extern AVInputFormat pcm_alaw_demuxer;
+extern AVInputFormat pcm_mulaw_demuxer;
+extern AVInputFormat pcm_s16be_demuxer;
 extern AVInputFormat pcm_s16le_demuxer;
-extern AVOutputFormat pcm_s16le_muxer;
-extern AVInputFormat pcm_s16be_demuxer;
-extern AVOutputFormat pcm_s16be_muxer;
+extern AVInputFormat pcm_s8_demuxer;
+extern AVInputFormat pcm_u16be_demuxer;
 extern AVInputFormat pcm_u16le_demuxer;
-extern AVOutputFormat pcm_u16le_muxer;
-extern AVInputFormat pcm_u16be_demuxer;
-extern AVOutputFormat pcm_u16be_muxer;
-extern AVInputFormat pcm_s8_demuxer;
-extern AVOutputFormat pcm_s8_muxer;
 extern AVInputFormat pcm_u8_demuxer;
-extern AVOutputFormat pcm_u8_muxer;
-extern AVInputFormat pcm_mulaw_demuxer;
-extern AVOutputFormat pcm_mulaw_muxer;
-extern AVInputFormat pcm_alaw_demuxer;
-extern AVOutputFormat pcm_alaw_muxer;
 extern AVInputFormat rawvideo_demuxer;
-extern AVOutputFormat rawvideo_muxer;
-extern AVOutputFormat null_muxer;
+extern AVInputFormat redir_demuxer;
 extern AVInputFormat rm_demuxer;
-extern AVOutputFormat rm_muxer;
+extern AVInputFormat roq_demuxer;
 extern AVInputFormat sdp_demuxer;
-extern AVInputFormat redir_demuxer;
 extern AVInputFormat segafilm_demuxer;
-extern AVInputFormat vmd_demuxer;
+extern AVInputFormat shorten_demuxer;
 extern AVInputFormat smacker_demuxer;
 extern AVInputFormat sol_demuxer;
+extern AVInputFormat str_demuxer;
 extern AVInputFormat swf_demuxer;
-extern AVOutputFormat swf_muxer;
+extern AVInputFormat thp_demuxer;
+extern AVInputFormat tiertexseq_demuxer;
 extern AVInputFormat tta_demuxer;
+extern AVInputFormat txd_demuxer;
 extern AVInputFormat v4l2_demuxer;
+extern AVInputFormat vc1_demuxer;
+extern AVInputFormat video_grab_bktr_demuxer;
+extern AVInputFormat video_grab_v4l_demuxer;
+extern AVInputFormat vmd_demuxer;
 extern AVInputFormat voc_demuxer;
-extern AVOutputFormat voc_muxer;
 extern AVInputFormat wav_demuxer;
-extern AVOutputFormat wav_muxer;
 extern AVInputFormat wc3_demuxer;
 extern AVInputFormat wsaud_demuxer;
 extern AVInputFormat wsvqa_demuxer;
 extern AVInputFormat wv_demuxer;
-extern AVOutputFormat yuv4mpegpipe_muxer;
+extern AVInputFormat x11_grab_device_demuxer;
 extern AVInputFormat yuv4mpegpipe_demuxer;
-extern AVInputFormat tiertexseq_demuxer;
-extern AVInputFormat x11_grab_device_demuxer;
 
+extern AVOutputFormat ac3_muxer;
+extern AVOutputFormat adts_muxer;
+extern AVOutputFormat aiff_muxer;
+extern AVOutputFormat amr_muxer;
+extern AVOutputFormat asf_muxer;
+extern AVOutputFormat asf_stream_muxer;
+extern AVOutputFormat au_muxer;
+extern AVOutputFormat audio_muxer;
+extern AVOutputFormat avi_muxer;
+extern AVOutputFormat crc_muxer;
+extern AVOutputFormat dv_muxer;
+extern AVOutputFormat ffm_muxer;
+extern AVOutputFormat flac_muxer;
+extern AVOutputFormat flv_muxer;
+extern AVOutputFormat framecrc_muxer;
+extern AVOutputFormat gif_muxer;
+extern AVOutputFormat gxf_muxer;
+extern AVOutputFormat h261_muxer;
+extern AVOutputFormat h263_muxer;
+extern AVOutputFormat h264_muxer;
+extern AVOutputFormat image2_muxer;
+extern AVOutputFormat image2pipe_muxer;
+extern AVOutputFormat image_muxer;
+extern AVOutputFormat imagepipe_muxer;
+extern AVOutputFormat libnut_muxer;
+extern AVOutputFormat m4v_muxer;
+extern AVOutputFormat mjpeg_muxer;
+extern AVOutputFormat mmf_muxer;
+extern AVOutputFormat mov_muxer;
+extern AVOutputFormat mp2_muxer;
+extern AVOutputFormat mp3_muxer;
+extern AVOutputFormat mp4_muxer;
+extern AVOutputFormat mpeg1system_muxer;
+extern AVOutputFormat mpeg1vcd_muxer;
+extern AVOutputFormat mpeg1video_muxer;
+extern AVOutputFormat mpeg2dvd_muxer;
+extern AVOutputFormat mpeg2svcd_muxer;
+extern AVOutputFormat mpeg2video_muxer;
+extern AVOutputFormat mpeg2vob_muxer;
+extern AVOutputFormat mpegts_muxer;
+extern AVOutputFormat mpjpeg_muxer;
+extern AVOutputFormat null_muxer;
+extern AVOutputFormat ogg_muxer;
+extern AVOutputFormat pcm_alaw_muxer;
+extern AVOutputFormat pcm_mulaw_muxer;
+extern AVOutputFormat pcm_s16be_muxer;
+extern AVOutputFormat pcm_s16le_muxer;
+extern AVOutputFormat pcm_s8_muxer;
+extern AVOutputFormat pcm_u16be_muxer;
+extern AVOutputFormat pcm_u16le_muxer;
+extern AVOutputFormat pcm_u8_muxer;
+extern AVOutputFormat psp_muxer;
+extern AVOutputFormat rawvideo_muxer;
+extern AVOutputFormat rm_muxer;
+extern AVOutputFormat roq_muxer;
+extern AVOutputFormat swf_muxer;
+extern AVOutputFormat tg2_muxer;
+extern AVOutputFormat tgp_muxer;
+extern AVOutputFormat voc_muxer;
+extern AVOutputFormat wav_muxer;
+extern AVOutputFormat yuv4mpegpipe_muxer;
+
 /* raw.c */
 int pcm_read_seek(AVFormatContext *s,
                   int stream_index, int64_t timestamp, int flags);
@@ -173,6 +187,6 @@
 /* rtsp.c */
 int redir_open(AVFormatContext **ic_ptr, ByteIOContext *f);
 /* rtp.c */
-void av_register_rtp_dynamic_payload_handlers();
+void av_register_rtp_dynamic_payload_handlers(void);
 
 #endif

Modified: branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavformat/avformat.h
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavformat/avformat.h	2007-07-16 16:39:52 UTC (rev 3382)
+++ branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavformat/avformat.h	2007-07-16 17:44:22 UTC (rev 3383)
@@ -21,12 +21,8 @@
 #ifndef AVFORMAT_H
 #define AVFORMAT_H
 
-#ifdef __cplusplus
-extern "C" {
-#endif
-
-#define LIBAVFORMAT_VERSION_INT ((51<<16)+(8<<8)+0)
-#define LIBAVFORMAT_VERSION     51.8.0
+#define LIBAVFORMAT_VERSION_INT ((51<<16)+(12<<8)+1)
+#define LIBAVFORMAT_VERSION     51.12.1
 #define LIBAVFORMAT_BUILD       LIBAVFORMAT_VERSION_INT
 
 #define LIBAVFORMAT_IDENT       "Lavf" AV_STRINGIFY(LIBAVFORMAT_VERSION)
@@ -54,22 +50,41 @@
 #define PKT_FLAG_KEY   0x0001
 
 void av_destruct_packet_nofree(AVPacket *pkt);
+
+/**
+ * Default packet destructor.
+ */
 void av_destruct_packet(AVPacket *pkt);
 
-/* initialize optional fields of a packet */
-static inline void av_init_packet(AVPacket *pkt)
-{
-    pkt->pts   = AV_NOPTS_VALUE;
-    pkt->dts   = AV_NOPTS_VALUE;
-    pkt->pos   = -1;
-    pkt->duration = 0;
-    pkt->flags = 0;
-    pkt->stream_index = 0;
-    pkt->destruct= av_destruct_packet_nofree;
-}
+/**
+ * Initialize optional fields of a packet to default values.
+ *
+ * @param pkt packet
+ */
+void av_init_packet(AVPacket *pkt);
 
+/**
+ * Allocate the payload of a packet and initialize its fields to default values.
+ *
+ * @param pkt packet
+ * @param size wanted payload size
+ * @return 0 if OK. AVERROR_xxx otherwise.
+ */
 int av_new_packet(AVPacket *pkt, int size);
+
+/**
+ * Allocate and read the payload of a packet and initialize its fields to default values.
+ *
+ * @param pkt packet
+ * @param size wanted payload size
+ * @return >0 (read size) if OK. AVERROR_xxx otherwise.
+ */
 int av_get_packet(ByteIOContext *s, AVPacket *pkt, int size);
+
+/**
+ * @warning This is a hack - the packet memory allocation stuff is broken. The
+ * packet is allocated if it was not really allocated
+ */
 int av_dup_packet(AVPacket *pkt);
 
 /**
@@ -87,8 +102,11 @@
 /*************************************************/
 /* fractional numbers for exact pts handling */
 
-/* the exact value of the fractional number is: 'val + num / den'. num
-   is assumed to be such as 0 <= num < den */
+/**
+ * the exact value of the fractional number is: 'val + num / den'.
+ * num is assumed to be such as 0 <= num < den
+ * @deprecated Use AVRational instead
+*/
 typedef struct AVFrac {
     int64_t val, num, den;
 } AVFrac attribute_deprecated;
@@ -100,7 +118,7 @@
 
 struct AVFormatContext;
 
-/* this structure contains the data a format has to probe a file */
+/** this structure contains the data a format has to probe a file */
 typedef struct AVProbeData {
     const char *filename;
     unsigned char *buf;
@@ -108,6 +126,7 @@
 } AVProbeData;
 
 #define AVPROBE_SCORE_MAX 100               ///< max score, half of that is used for file extension based detection
+#define AVPROBE_PADDING_SIZE 32             ///< extra allocated bytes at the end of the probe buffer
 
 typedef struct AVFormatParameters {
     AVRational time_base;
@@ -116,14 +135,16 @@
     int width;
     int height;
     enum PixelFormat pix_fmt;
-    int channel; /* used to select dv channel */
-    const char *device; /* video, audio or DV device */
-    const char *standard; /* tv standard, NTSC, PAL, SECAM */
-    int mpeg2ts_raw:1;  /* force raw MPEG2 transport stream output, if possible */
-    int mpeg2ts_compute_pcr:1; /* compute exact PCR for each transport
+    int channel; /**< used to select dv channel */
+#if LIBAVFORMAT_VERSION_INT < (52<<16)
+    const char *device; /**< video, audio or DV device */
+#endif
+    const char *standard; /**< tv standard, NTSC, PAL, SECAM */
+    int mpeg2ts_raw:1;  /**< force raw MPEG2 transport stream output, if possible */
+    int mpeg2ts_compute_pcr:1; /**< compute exact PCR for each transport
                                   stream packet (only meaningful if
-                                  mpeg2ts_raw is TRUE */
-    int initial_pause:1;       /* do not begin to play the stream
+                                  mpeg2ts_raw is TRUE) */
+    int initial_pause:1;       /**< do not begin to play the stream
                                   immediately (RTSP only) */
     int prealloced_context:1;
     enum CodecID video_codec_id;
@@ -132,29 +153,30 @@
 
 //! demuxer will use url_fopen, no opened file should be provided by the caller
 #define AVFMT_NOFILE        0x0001
-#define AVFMT_NEEDNUMBER    0x0002 /* needs '%d' in filename */
-#define AVFMT_SHOW_IDS      0x0008 /* show format stream IDs numbers */
-#define AVFMT_RAWPICTURE    0x0020 /* format wants AVPicture structure for
+#define AVFMT_NEEDNUMBER    0x0002 /**< needs '%d' in filename */
+#define AVFMT_SHOW_IDS      0x0008 /**< show format stream IDs numbers */
+#define AVFMT_RAWPICTURE    0x0020 /**< format wants AVPicture structure for
                                       raw picture data */
-#define AVFMT_GLOBALHEADER  0x0040 /* format wants global header */
-#define AVFMT_NOTIMESTAMPS  0x0080 /* format doesnt need / has any timestamps */
+#define AVFMT_GLOBALHEADER  0x0040 /**< format wants global header */
+#define AVFMT_NOTIMESTAMPS  0x0080 /**< format does not need / have any timestamps */
+#define AVFMT_GENERIC_INDEX 0x0100 /**< use generic index building code */
 
 typedef struct AVOutputFormat {
     const char *name;
     const char *long_name;
     const char *mime_type;
-    const char *extensions; /* comma separated extensions */
-    /* size of private data so that it can be allocated in the wrapper */
+    const char *extensions; /**< comma separated filename extensions */
+    /** size of private data so that it can be allocated in the wrapper */
     int priv_data_size;
     /* output support */
-    enum CodecID audio_codec; /* default audio codec */
-    enum CodecID video_codec; /* default video codec */
+    enum CodecID audio_codec; /**< default audio codec */
+    enum CodecID video_codec; /**< default video codec */
     int (*write_header)(struct AVFormatContext *);
     int (*write_packet)(struct AVFormatContext *, AVPacket *pkt);
     int (*write_trailer)(struct AVFormatContext *);
-    /* can use flags: AVFMT_NOFILE, AVFMT_NEEDNUMBER, AVFMT_GLOBALHEADER */
+    /** can use flags: AVFMT_NOFILE, AVFMT_NEEDNUMBER, AVFMT_GLOBALHEADER */
     int flags;
-    /* currently only used to set pixel format if not YUV420P */
+    /** currently only used to set pixel format if not YUV420P */
     int (*set_parameters)(struct AVFormatContext *, AVFormatParameters *);
     int (*interleave_packet)(struct AVFormatContext *, AVPacket *out, AVPacket *in, int flush);
 
@@ -162,7 +184,7 @@
      * list of supported codec_id-codec_tag pairs, ordered by "better choice first"
      * the arrays are all CODEC_ID_NONE terminated
      */
-    const struct AVCodecTag *codec_tag[4];
+    const struct AVCodecTag **codec_tag;
 
     /* private fields */
     struct AVOutputFormat *next;
@@ -171,21 +193,21 @@
 typedef struct AVInputFormat {
     const char *name;
     const char *long_name;
-    /* size of private data so that it can be allocated in the wrapper */
+    /** size of private data so that it can be allocated in the wrapper */
     int priv_data_size;
-    /* tell if a given file has a chance of being parsing by this format */
+    /** tell if a given file has a chance of being parsed by this format */
     int (*read_probe)(AVProbeData *);
-    /* read the format header and initialize the AVFormatContext
+    /** read the format header and initialize the AVFormatContext
        structure. Return 0 if OK. 'ap' if non NULL contains
-       additionnal paramters. Only used in raw format right
+       additional paramters. Only used in raw format right
        now. 'av_new_stream' should be called to create new streams.  */
     int (*read_header)(struct AVFormatContext *,
                        AVFormatParameters *ap);
-    /* read one packet and put it in 'pkt'. pts and flags are also
+    /** read one packet and put it in 'pkt'. pts and flags are also
        set. 'av_new_stream' can be called only if the flag
        AVFMTCTX_NOHEADER is used. */
     int (*read_packet)(struct AVFormatContext *, AVPacket *pkt);
-    /* close the stream. The AVFormatContext and AVStreams are not
+    /** close the stream. The AVFormatContext and AVStreams are not
        freed by this function */
     int (*read_close)(struct AVFormatContext *);
     /**
@@ -194,6 +216,7 @@
      * @param stream_index must not be -1
      * @param flags selects which direction should be preferred if no exact
      *              match is available
+     * @return >= 0 on success (but not necessarily the new offset)
      */
     int (*read_seek)(struct AVFormatContext *,
                      int stream_index, int64_t timestamp, int flags);
@@ -202,57 +225,66 @@
      */
     int64_t (*read_timestamp)(struct AVFormatContext *s, int stream_index,
                               int64_t *pos, int64_t pos_limit);
-    /* can use flags: AVFMT_NOFILE, AVFMT_NEEDNUMBER */
+    /** can use flags: AVFMT_NOFILE, AVFMT_NEEDNUMBER */
     int flags;
-    /* if extensions are defined, then no probe is done. You should
+    /** if extensions are defined, then no probe is done. You should
        usually not use extension format guessing because it is not
        reliable enough */
     const char *extensions;
-    /* general purpose read only value that the format can use */
+    /** general purpose read only value that the format can use */
     int value;
 
-    /* start/resume playing - only meaningful if using a network based format
+    /** start/resume playing - only meaningful if using a network based format
        (RTSP) */
     int (*read_play)(struct AVFormatContext *);
 
-    /* pause playing - only meaningful if using a network based format
+    /** pause playing - only meaningful if using a network based format
        (RTSP) */
     int (*read_pause)(struct AVFormatContext *);
 
-    const struct AVCodecTag *codec_tag[4];
+    const struct AVCodecTag **codec_tag;
 
     /* private fields */
     struct AVInputFormat *next;
 } AVInputFormat;
 
+enum AVStreamParseType {
+    AVSTREAM_PARSE_NONE,
+    AVSTREAM_PARSE_FULL,       /**< full parsing and repack */
+    AVSTREAM_PARSE_HEADERS,    /**< only parse headers, don't repack */
+    AVSTREAM_PARSE_TIMESTAMPS, /**< full parsing and interpolation of timestamps for frames not starting on packet boundary */
+};
+
 typedef struct AVIndexEntry {
     int64_t pos;
     int64_t timestamp;
 #define AVINDEX_KEYFRAME 0x0001
     int flags:2;
-    int size:30; //yeah trying to keep the size of this small to reduce memory requirements (its 24 vs 32 byte due to possible 8byte align)
-    int min_distance;         /* min distance between this and the previous keyframe, used to avoid unneeded searching */
+    int size:30; //Yeah, trying to keep the size of this small to reduce memory requirements (it is 24 vs 32 byte due to possible 8byte align).
+    int min_distance;         /**< min distance between this and the previous keyframe, used to avoid unneeded searching */
 } AVIndexEntry;
 
 typedef struct AVStream {
-    int index;    /* stream index in AVFormatContext */
-    int id;       /* format specific stream id */
-    AVCodecContext *codec; /* codec context */
+    int index;    /**< stream index in AVFormatContext */
+    int id;       /**< format specific stream id */
+    AVCodecContext *codec; /**< codec context */
     /**
      * real base frame rate of the stream.
      * this is the lowest framerate with which all timestamps can be
-     * represented accurately (its the least common multiple of all
+     * represented accurately (it is the least common multiple of all
      * framerates in the stream), Note, this value is just a guess!
      * for example if the timebase is 1/90000 and all frames have either
      * approximately 3600 or 1800 timer ticks then r_frame_rate will be 50/1
      */
     AVRational r_frame_rate;
     void *priv_data;
+#if LIBAVFORMAT_VERSION_INT < (52<<16)
     /* internal data used in av_find_stream_info() */
     int64_t codec_info_duration;
     int codec_info_nb_frames;
-    /* encoding: PTS generation when outputing stream */
-    AVFrac pts;
+#endif
+    /** encoding: PTS generation when outputing stream */
+    struct AVFrac pts;
 
     /**
      * this is the fundamental unit of time (in seconds) in terms
@@ -261,32 +293,30 @@
      * identically 1.
      */
     AVRational time_base;
-    int pts_wrap_bits; /* number of bits in pts (used for wrapping control) */
+    int pts_wrap_bits; /**< number of bits in pts (used for wrapping control) */
     /* ffmpeg.c private use */
-    int stream_copy; /* if TRUE, just copy stream */
-    enum AVDiscard discard; ///< selects which packets can be discarded at will and dont need to be demuxed
+    int stream_copy; /**< if set, just copy stream */
+    enum AVDiscard discard; ///< selects which packets can be discarded at will and do not need to be demuxed
     //FIXME move stuff to a flags field?
-    /* quality, as it has been removed from AVCodecContext and put in AVVideoFrame
-     * MN:dunno if thats the right place, for it */
+    /** quality, as it has been removed from AVCodecContext and put in AVVideoFrame
+     * MN: dunno if that is the right place for it */
     float quality;
-    /* decoding: position of the first frame of the component, in
-       AV_TIME_BASE fractional seconds. */
+    /** decoding: pts of the first frame of the stream, in stream time base. */
     int64_t start_time;
-    /* decoding: duration of the stream, in AV_TIME_BASE fractional
-       seconds. */
+    /** decoding: duration of the stream, in stream time base. */
     int64_t duration;
 
-    char language[4]; /* ISO 639 3-letter language code (empty string if undefined) */
+    char language[4]; /** ISO 639 3-letter language code (empty string if undefined) */
 
     /* av_read_frame() support */
-    int need_parsing;                  ///< 1->full parsing needed, 2->only parse headers dont repack
+    enum AVStreamParseType need_parsing;
     struct AVCodecParserContext *parser;
 
     int64_t cur_dts;
     int last_IP_duration;
     int64_t last_IP_pts;
     /* av_seek_frame() support */
-    AVIndexEntry *index_entries; /* only used if the format does not
+    AVIndexEntry *index_entries; /**< only used if the format does not
                                     support seeking natively */
     int nb_index_entries;
     unsigned int index_entries_allocated_size;
@@ -297,14 +327,14 @@
     int64_t pts_buffer[MAX_REORDER_DELAY+1];
 } AVStream;
 
-#define AVFMTCTX_NOHEADER      0x0001 /* signal that no header is present
+#define AVFMTCTX_NOHEADER      0x0001 /**< signal that no header is present
                                          (streams are added dynamically) */
 
 #define MAX_STREAMS 20
 
 /* format I/O context */
 typedef struct AVFormatContext {
-    const AVClass *av_class; /* set by av_alloc_format_context */
+    const AVClass *av_class; /**< set by av_alloc_format_context */
     /* can only be iformat or oformat, not both at the same time */
     struct AVInputFormat *iformat;
     struct AVOutputFormat *oformat;
@@ -312,7 +342,7 @@
     ByteIOContext pb;
     unsigned int nb_streams;
     AVStream *streams[MAX_STREAMS];
-    char filename[1024]; /* input or output filename */
+    char filename[1024]; /**< input or output filename */
     /* stream info */
     int64_t timestamp;
     char title[512];
@@ -320,28 +350,28 @@
     char copyright[512];
     char comment[512];
     char album[512];
-    int year;  /* ID3 year, 0 if none */
-    int track; /* track number, 0 if none */
-    char genre[32]; /* ID3 genre */
+    int year;  /**< ID3 year, 0 if none */
+    int track; /**< track number, 0 if none */
+    char genre[32]; /**< ID3 genre */
 
-    int ctx_flags; /* format specific flags, see AVFMTCTX_xx */
+    int ctx_flags; /**< format specific flags, see AVFMTCTX_xx */
     /* private data for pts handling (do not modify directly) */
-    /* This buffer is only needed when packets were already buffered but
+    /** This buffer is only needed when packets were already buffered but
        not decoded, for example to get the codec parameters in mpeg
        streams */
     struct AVPacketList *packet_buffer;
 
-    /* decoding: position of the first frame of the component, in
+    /** decoding: position of the first frame of the component, in
        AV_TIME_BASE fractional seconds. NEVER set this value directly:
        it is deduced from the AVStream values.  */
     int64_t start_time;
-    /* decoding: duration of the stream, in AV_TIME_BASE fractional
+    /** decoding: duration of the stream, in AV_TIME_BASE fractional
        seconds. NEVER set this value directly: it is deduced from the
        AVStream values.  */
     int64_t duration;
-    /* decoding: total file size. 0 if unknown */
+    /** decoding: total file size. 0 if unknown */
     int64_t file_size;
-    /* decoding: total stream bitrate in bit/s, 0 if not
+    /** decoding: total stream bitrate in bit/s, 0 if not
        available. Never set it directly if the file_size and the
        duration are known as ffmpeg can compute it automatically. */
     int bit_rate;
@@ -353,7 +383,7 @@
     AVPacket cur_pkt;
 
     /* av_seek_frame() support */
-    int64_t data_offset; /* offset of the first packet */
+    int64_t data_offset; /** offset of the first packet */
     int index_built;
 
     int mux_rate;
@@ -363,16 +393,25 @@
 
 #define AVFMT_NOOUTPUTLOOP -1
 #define AVFMT_INFINITEOUTPUTLOOP 0
-    /* number of times to loop output in formats that support it */
+    /** number of times to loop output in formats that support it */
     int loop_output;
 
     int flags;
 #define AVFMT_FLAG_GENPTS       0x0001 ///< generate pts if missing even if it requires parsing future frames
 #define AVFMT_FLAG_IGNIDX       0x0002 ///< ignore index
+#define AVFMT_FLAG_NONBLOCK     0x0004 ///< do not block when reading packets from input
 
     int loop_input;
-    /* decoding: size of data to probe; encoding unused */
+    /** decoding: size of data to probe; encoding unused */
     unsigned int probesize;
+
+    /**
+     * maximum duration in AV_TIME_BASE units over which the input should be analyzed in av_find_stream_info()
+     */
+    int max_analyze_duration;
+
+    const uint8_t *key;
+    int keylen;
 } AVFormatContext;
 
 typedef struct AVPacketList {
@@ -399,47 +438,207 @@
                                     const char *filename, const char *mime_type);
 AVOutputFormat *guess_format(const char *short_name,
                              const char *filename, const char *mime_type);
+
+/**
+ * Guesses the codec id based upon muxer and filename.
+ */
 enum CodecID av_guess_codec(AVOutputFormat *fmt, const char *short_name,
                             const char *filename, const char *mime_type, enum CodecType type);
 
+/**
+ * Send a nice hexadecimal dump of a buffer to the specified file stream.
+ *
+ * @param f The file stream pointer where the dump should be sent to.
+ * @param buf buffer
+ * @param size buffer size
+ *
+ * @see av_hex_dump_log, av_pkt_dump, av_pkt_dump_log
+ */
 void av_hex_dump(FILE *f, uint8_t *buf, int size);
+
+/**
+ * Send a nice hexadecimal dump of a buffer to the log.
+ *
+ * @param avcl A pointer to an arbitrary struct of which the first field is a
+ * pointer to an AVClass struct.
+ * @param level The importance level of the message, lower values signifying
+ * higher importance.
+ * @param buf buffer
+ * @param size buffer size
+ *
+ * @see av_hex_dump, av_pkt_dump, av_pkt_dump_log
+ */
+void av_hex_dump_log(void *avcl, int level, uint8_t *buf, int size);
+
+/**
+ * Send a nice dump of a packet to the specified file stream.
+ *
+ * @param f The file stream pointer where the dump should be sent to.
+ * @param pkt packet to dump
+ * @param dump_payload true if the payload must be displayed too
+ */
 void av_pkt_dump(FILE *f, AVPacket *pkt, int dump_payload);
 
+/**
+ * Send a nice dump of a packet to the log.
+ *
+ * @param avcl A pointer to an arbitrary struct of which the first field is a
+ * pointer to an AVClass struct.
+ * @param level The importance level of the message, lower values signifying
+ * higher importance.
+ * @param pkt packet to dump
+ * @param dump_payload true if the payload must be displayed too
+ */
+void av_pkt_dump_log(void *avcl, int level, AVPacket *pkt, int dump_payload);
+
 void av_register_all(void);
 
-/* codec tag <-> codec id */
-enum CodecID av_codec_get_id(const struct AVCodecTag *tags[4], unsigned int tag);
-unsigned int av_codec_get_tag(const struct AVCodecTag *tags[4], enum CodecID id);
+/** codec tag <-> codec id */
+enum CodecID av_codec_get_id(const struct AVCodecTag **tags, unsigned int tag);
+unsigned int av_codec_get_tag(const struct AVCodecTag **tags, enum CodecID id);
 
 /* media file input */
+
+/**
+ * finds AVInputFormat based on input format's short name.
+ */
 AVInputFormat *av_find_input_format(const char *short_name);
+
+/**
+ * Guess file format.
+ *
+ * @param is_opened whether the file is already opened, determines whether
+ *                  demuxers with or without AVFMT_NOFILE are probed
+ */
 AVInputFormat *av_probe_input_format(AVProbeData *pd, int is_opened);
+
+/**
+ * Allocates all the structures needed to read an input stream.
+ *        This does not open the needed codecs for decoding the stream[s].
+ */
 int av_open_input_stream(AVFormatContext **ic_ptr,
                          ByteIOContext *pb, const char *filename,
                          AVInputFormat *fmt, AVFormatParameters *ap);
+
+/**
+ * Open a media file as input. The codecs are not opened. Only the file
+ * header (if present) is read.
+ *
+ * @param ic_ptr the opened media file handle is put here
+ * @param filename filename to open.
+ * @param fmt if non NULL, force the file format to use
+ * @param buf_size optional buffer size (zero if default is OK)
+ * @param ap additional parameters needed when opening the file (NULL if default)
+ * @return 0 if OK. AVERROR_xxx otherwise.
+ */
 int av_open_input_file(AVFormatContext **ic_ptr, const char *filename,
                        AVInputFormat *fmt,
                        int buf_size,
                        AVFormatParameters *ap);
-/* no av_open for output, so applications will need this: */
+/** no av_open for output, so applications will need this: */
 AVFormatContext *av_alloc_format_context(void);
 
-#define AVERROR_UNKNOWN     (-1)  /* unknown error */
-#define AVERROR_IO          (-2)  /* i/o error */
-#define AVERROR_NUMEXPECTED (-3)  /* number syntax expected in filename */
-#define AVERROR_INVALIDDATA (-4)  /* invalid data found */
-#define AVERROR_NOMEM       (-5)  /* not enough memory */
-#define AVERROR_NOFMT       (-6)  /* unknown format */
-#define AVERROR_NOTSUPP     (-7)  /* operation not supported */
+/**
+ * Read packets of a media file to get stream information. This
+ * is useful for file formats with no headers such as MPEG. This
+ * function also computes the real frame rate in case of mpeg2 repeat
+ * frame mode.
+ * The logical file position is not changed by this function;
+ * examined packets may be buffered for later processing.
+ *
+ * @param ic media file handle
+ * @return >=0 if OK. AVERROR_xxx if error.
+ * @todo Let user decide somehow what information is needed so we do not waste time geting stuff the user does not need.
+ */
+int av_find_stream_info(AVFormatContext *ic);
 
-int av_find_stream_info(AVFormatContext *ic);
+/**
+ * Read a transport packet from a media file.
+ *
+ * This function is obsolete and should never be used.
+ * Use av_read_frame() instead.
+ *
+ * @param s media file handle
+ * @param pkt is filled
+ * @return 0 if OK. AVERROR_xxx if error.
+ */
 int av_read_packet(AVFormatContext *s, AVPacket *pkt);
+
+/**
+ * Return the next frame of a stream.
+ *
+ * The returned packet is valid
+ * until the next av_read_frame() or until av_close_input_file() and
+ * must be freed with av_free_packet. For video, the packet contains
+ * exactly one frame. For audio, it contains an integer number of
+ * frames if each frame has a known fixed size (e.g. PCM or ADPCM
+ * data). If the audio frames have a variable size (e.g. MPEG audio),
+ * then it contains one frame.
+ *
+ * pkt->pts, pkt->dts and pkt->duration are always set to correct
+ * values in AVStream.timebase units (and guessed if the format cannot
+ * provided them). pkt->pts can be AV_NOPTS_VALUE if the video format
+ * has B frames, so it is better to rely on pkt->dts if you do not
+ * decompress the payload.
+ *
+ * @return 0 if OK, < 0 if error or end of file.
+ */
 int av_read_frame(AVFormatContext *s, AVPacket *pkt);
+
+/**
+ * Seek to the key frame at timestamp.
+ * 'timestamp' in 'stream_index'.
+ * @param stream_index If stream_index is (-1), a default
+ * stream is selected, and timestamp is automatically converted
+ * from AV_TIME_BASE units to the stream specific time_base.
+ * @param timestamp timestamp in AVStream.time_base units
+ *        or if there is no stream specified then in AV_TIME_BASE units
+ * @param flags flags which select direction and seeking mode
+ * @return >= 0 on success
+ */
 int av_seek_frame(AVFormatContext *s, int stream_index, int64_t timestamp, int flags);
+
+/**
+ * start playing a network based stream (e.g. RTSP stream) at the
+ * current position
+ */
 int av_read_play(AVFormatContext *s);
+
+/**
+ * Pause a network based stream (e.g. RTSP stream).
+ *
+ * Use av_read_play() to resume it.
+ */
 int av_read_pause(AVFormatContext *s);
+
+/**
+ * Close a media file (but not its codecs).
+ *
+ * @param s media file handle
+ */
 void av_close_input_file(AVFormatContext *s);
+
+/**
+ * Add a new stream to a media file.
+ *
+ * Can only be called in the read_header() function. If the flag
+ * AVFMTCTX_NOHEADER is in the format context, then new streams
+ * can be added in read_packet too.
+ *
+ * @param s media file handle
+ * @param id file format dependent stream id
+ */
 AVStream *av_new_stream(AVFormatContext *s, int id);
+
+/**
+ * Set the pts for a given stream.
+ *
+ * @param s stream
+ * @param pts_wrap_bits number of bits effectively used by the pts
+ *        (used for wrap control, 33 is the value for MPEG)
+ * @param pts_num numerator to convert to seconds (MPEG: 1)
+ * @param pts_den denominator to convert to seconds (MPEG: 90000)
+ */
 void av_set_pts_info(AVStream *s, int pts_wrap_bits,
                      int pts_num, int pts_den);
 
@@ -448,28 +647,149 @@
 #define AVSEEK_FLAG_ANY      4 ///< seek to any frame, even non keyframes
 
 int av_find_default_stream_index(AVFormatContext *s);
+
+/**
+ * Gets the index for a specific timestamp.
+ * @param flags if AVSEEK_FLAG_BACKWARD then the returned index will correspond to
+ *                 the timestamp which is <= the requested one, if backward is 0
+ *                 then it will be >=
+ *              if AVSEEK_FLAG_ANY seek to any frame, only keyframes otherwise
+ * @return < 0 if no such timestamp could be found
+ */
 int av_index_search_timestamp(AVStream *st, int64_t timestamp, int flags);
+
+/**
+ * Add a index entry into a sorted list updateing if it is already there.
+ *
+ * @param timestamp timestamp in the timebase of the given stream
+ */
 int av_add_index_entry(AVStream *st,
                        int64_t pos, int64_t timestamp, int size, int distance, int flags);
+
+/**
+ * Does a binary search using av_index_search_timestamp() and AVCodec.read_timestamp().
+ * This is not supposed to be called directly by a user application, but by demuxers.
+ * @param target_ts target timestamp in the time base of the given stream
+ * @param stream_index stream number
+ */
 int av_seek_frame_binary(AVFormatContext *s, int stream_index, int64_t target_ts, int flags);
+
+/**
+ * Updates cur_dts of all streams based on given timestamp and AVStream.
+ *
+ * Stream ref_st unchanged, others set cur_dts in their native timebase
+ * only needed for timestamp wrapping or if (dts not set and pts!=dts).
+ * @param timestamp new dts expressed in time_base of param ref_st
+ * @param ref_st reference stream giving time_base of param timestamp
+ */
 void av_update_cur_dts(AVFormatContext *s, AVStream *ref_st, int64_t timestamp);
+
+/**
+ * Does a binary search using read_timestamp().
+ * This is not supposed to be called directly by a user application, but by demuxers.
+ * @param target_ts target timestamp in the time base of the given stream
+ * @param stream_index stream number
+ */
 int64_t av_gen_search(AVFormatContext *s, int stream_index, int64_t target_ts, int64_t pos_min, int64_t pos_max, int64_t pos_limit, int64_t ts_min, int64_t ts_max, int flags, int64_t *ts_ret, int64_t (*read_timestamp)(struct AVFormatContext *, int , int64_t *, int64_t ));
 
-/* media file output */
+/** media file output */
 int av_set_parameters(AVFormatContext *s, AVFormatParameters *ap);
+
+/**
+ * Allocate the stream private data and write the stream header to an
+ * output media file.
+ *
+ * @param s media file handle
+ * @return 0 if OK. AVERROR_xxx if error.
+ */
 int av_write_header(AVFormatContext *s);
+
+/**
+ * Write a packet to an output media file.
+ *
+ * The packet shall contain one audio or video frame.
+ * The packet must be correctly interleaved according to the container specification,
+ * if not then av_interleaved_write_frame must be used
+ *
+ * @param s media file handle
+ * @param pkt the packet, which contains the stream_index, buf/buf_size, dts/pts, ...
+ * @return < 0 if error, = 0 if OK, 1 if end of stream wanted.
+ */
 int av_write_frame(AVFormatContext *s, AVPacket *pkt);
+
+/**
+ * Writes a packet to an output media file ensuring correct interleaving.
+ *
+ * The packet must contain one audio or video frame.
+ * If the packets are already correctly interleaved the application should
+ * call av_write_frame() instead as it is slightly faster. It is also important
+ * to keep in mind that completely non-interleaved input will need huge amounts
+ * of memory to interleave with this, so it is preferable to interleave at the
+ * demuxer level.
+ *
+ * @param s media file handle
+ * @param pkt the packet, which contains the stream_index, buf/buf_size, dts/pts, ...
+ * @return < 0 if error, = 0 if OK, 1 if end of stream wanted.
+ */
 int av_interleaved_write_frame(AVFormatContext *s, AVPacket *pkt);
+
+/**
+ * Interleave a packet per DTS in an output media file.
+ *
+ * Packets with pkt->destruct == av_destruct_packet will be freed inside this function,
+ * so they cannot be used after it, note calling av_free_packet() on them is still safe.
+ *
+ * @param s media file handle
+ * @param out the interleaved packet will be output here
+ * @param in the input packet
+ * @param flush 1 if no further packets are available as input and all
+ *              remaining packets should be output
+ * @return 1 if a packet was output, 0 if no packet could be output,
+ *         < 0 if an error occured
+ */
 int av_interleave_packet_per_dts(AVFormatContext *s, AVPacket *out, AVPacket *pkt, int flush);
 
+/**
+ * @brief Write the stream trailer to an output media file and
+ *        free the file private data.
+ *
+ * @param s media file handle
+ * @return 0 if OK. AVERROR_xxx if error.
+ */
 int av_write_trailer(AVFormatContext *s);
 
 void dump_format(AVFormatContext *ic,
                  int index,
                  const char *url,
                  int is_output);
-int parse_image_size(int *width_ptr, int *height_ptr, const char *str);
-int parse_frame_rate(int *frame_rate, int *frame_rate_base, const char *arg);
+
+/**
+ * parses width and height out of string str.
+ * @deprecated Use av_parse_video_frame_size instead.
+ */
+attribute_deprecated int parse_image_size(int *width_ptr, int *height_ptr, const char *str);
+
+/**
+ * Converts frame rate from string to a fraction.
+ * @deprecated Use av_parse_video_frame_rate instead.
+ */
+attribute_deprecated int parse_frame_rate(int *frame_rate, int *frame_rate_base, const char *arg);
+
+/**
+ * Converts date string to number of seconds since Jan 1st, 1970.
+ *
+ * @code
+ * Syntax:
+ * - If not a duration:
+ *  [{YYYY-MM-DD|YYYYMMDD}]{T| }{HH[:MM[:SS[.m...]]][Z]|HH[MM[SS[.m...]]][Z]}
+ * Time is localtime unless Z is suffixed to the end. In this case GMT
+ * Return the date in micro seconds since 1970
+ *
+ * - If a duration:
+ *  HH[:MM[:SS[.m...]]]
+ *  S+[.m...]
+ * @endcode
+ */
 int64_t parse_date(const char *datestr, int duration);
 
 int64_t av_gettime(void);
@@ -480,29 +800,41 @@
 void ffm_write_write_index(int fd, offset_t pos);
 void ffm_set_write_index(AVFormatContext *s, offset_t pos, offset_t file_size);
 
+/**
+ * Attempts to find a specific tag in a URL.
+ *
+ * syntax: '?tag1=val1&tag2=val2...'. Little URL decoding is done.
+ * Return 1 if found.
+ */
 int find_info_tag(char *arg, int arg_size, const char *tag1, const char *info);
 
+/**
+ * Returns in 'buf' the path with '%d' replaced by number.
+
+ * Also handles the '%0nd' format where 'n' is the total number
+ * of digits and '%%'.
+ *
+ * @param buf destination buffer
+ * @param buf_size destination buffer size
+ * @param path numbered sequence string
+ * @number frame number
+ * @return 0 if OK, -1 if format error.
+ */
 int av_get_frame_filename(char *buf, int buf_size,
                           const char *path, int number);
+
+/**
+ * Check whether filename actually is a numbered sequence generator.
+ *
+ * @param filename possible numbered sequence string
+ * @return 1 if a valid numbered sequence string, 0 otherwise.
+ */
 int av_filename_number_test(const char *filename);
 
-/* grab specific */
-int video_grab_init(void);
-int audio_init(void);
-
-/* DV1394 */
-int dv1394_init(void);
-int dc1394_init(void);
-
 #ifdef HAVE_AV_CONFIG_H
 
 #include "os_support.h"
 
-int strstart(const char *str, const char *val, const char **ptr);
-int stristart(const char *str, const char *val, const char **ptr);
-void pstrcpy(char *buf, int buf_size, const char *str);
-char *pstrcat(char *buf, int buf_size, const char *s);
-
 void __dynarray_add(unsigned long **tab_ptr, int *nb_ptr, unsigned long elem);
 
 #ifdef __GNUC__
@@ -539,9 +871,5 @@
 
 #endif /* HAVE_AV_CONFIG_H */
 
-#ifdef __cplusplus
-}
-#endif
-
 #endif /* AVFORMAT_H */
 

Modified: branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavformat/avienc.c
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavformat/avienc.c	2007-07-16 16:39:52 UTC (rev 3382)
+++ branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavformat/avienc.c	2007-07-16 17:44:22 UTC (rev 3383)
@@ -197,11 +197,6 @@
 
         stream = s->streams[i]->codec;
 
-        /* FourCC should really be set by the codec itself */
-        if (! stream->codec_tag) {
-            stream->codec_tag = codec_get_bmp_tag(stream->codec_id);
-        }
-
         /* stream generic header */
         strh = start_tag(pb, "strh");
         switch(stream->codec_type) {
@@ -575,6 +570,6 @@
     avi_write_header,
     avi_write_packet,
     avi_write_trailer,
-    .codec_tag= {codec_bmp_tags, codec_wav_tags},
+    .codec_tag= (const AVCodecTag*[]){codec_bmp_tags, codec_wav_tags, 0},
 };
 #endif //CONFIG_AVI_MUXER

Modified: branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavformat/avio.c
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavformat/avio.c	2007-07-16 16:39:52 UTC (rev 3382)
+++ branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavformat/avio.c	2007-07-16 17:44:22 UTC (rev 3383)
@@ -19,6 +19,7 @@
  * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA
  */
 #include "avformat.h"
+#include "avstring.h"
 
 static int default_interrupt_cb(void);
 
@@ -67,12 +68,12 @@
             goto found;
         up = up->next;
     }
-    err = -ENOENT;
+    err = AVERROR(ENOENT);
     goto fail;
  found:
     uc = av_malloc(sizeof(URLContext) + strlen(filename) + 1);
     if (!uc) {
-        err = -ENOMEM;
+        err = AVERROR(ENOMEM);
         goto fail;
     }
 #if LIBAVFORMAT_VERSION_INT >= (52<<16)
@@ -124,7 +125,7 @@
     offset_t ret;
 
     if (!h->prot->url_seek)
-        return -EPIPE;
+        return AVERROR(EPIPE);
     ret = h->prot->url_seek(h, pos, whence);
     return ret;
 }
@@ -154,20 +155,14 @@
     size= url_seek(h, 0, AVSEEK_SIZE);
     if(size<0){
         pos = url_seek(h, 0, SEEK_CUR);
-        size = url_seek(h, -1, SEEK_END)+1;
+        if ((size = url_seek(h, -1, SEEK_END)) < 0)
+            return size;
+        size++;
         url_seek(h, pos, SEEK_SET);
     }
     return size;
 }
 
-/*
- * Return the maximum packet size associated to packetized file
- * handle. If the file is not packetized (stream like http or file on
- * disk), then 0 is returned.
- *
- * @param h file handle
- * @return maximum packet size in bytes
- */
 int url_get_max_packet_size(URLContext *h)
 {
     return h->max_packet_size;
@@ -175,7 +170,7 @@
 
 void url_get_filename(URLContext *h, char *buf, int buf_size)
 {
-    pstrcpy(buf, buf_size, h->filename);
+    av_strlcpy(buf, h->filename, buf_size);
 }
 
 
@@ -184,12 +179,6 @@
     return 0;
 }
 
-/**
- * The callback is called in blocking functions to test regulary if
- * asynchronous interruption is needed. -EINTR is returned in this
- * case by the interrupted function. 'NULL' means no interrupt
- * callback is given.
- */
 void url_set_interrupt_cb(URLInterruptCB *interrupt_cb)
 {
     if (!interrupt_cb)

Modified: branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavformat/avio.h
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavformat/avio.h	2007-07-16 16:39:52 UTC (rev 3382)
+++ branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavformat/avio.h	2007-07-16 17:44:22 UTC (rev 3383)
@@ -21,6 +21,8 @@
 #ifndef AVIO_H
 #define AVIO_H
 
+#include <stdint.h>
+
 /* output byte stream handling */
 
 typedef int64_t offset_t;
@@ -30,13 +32,13 @@
 struct URLContext {
     struct URLProtocol *prot;
     int flags;
-    int is_streamed;  /* true if streamed (no seek possible), default = false */
-    int max_packet_size;  /* if non zero, the stream is packetized with this max packet size */
+    int is_streamed;  /**< true if streamed (no seek possible), default = false */
+    int max_packet_size;  /**< if non zero, the stream is packetized with this max packet size */
     void *priv_data;
 #if LIBAVFORMAT_VERSION_INT >= (52<<16)
-    char *filename; /* specified filename */
+    char *filename; /**< specified filename */
 #else
-    char filename[1]; /* specified filename */
+    char filename[1]; /**< specified filename */
 #endif
 };
 
@@ -61,22 +63,33 @@
 int url_close(URLContext *h);
 int url_exist(const char *filename);
 offset_t url_filesize(URLContext *h);
+
+/**
+ * Return the maximum packet size associated to packetized file
+ * handle. If the file is not packetized (stream like http or file on
+ * disk), then 0 is returned.
+ *
+ * @param h file handle
+ * @return maximum packet size in bytes
+ */
 int url_get_max_packet_size(URLContext *h);
 void url_get_filename(URLContext *h, char *buf, int buf_size);
 
-/* the callback is called in blocking functions to test regulary if
-   asynchronous interruption is needed. -EINTR is returned in this
-   case by the interrupted function. 'NULL' means no interrupt
-   callback is given. */
+/**
+ * the callback is called in blocking functions to test regulary if
+ * asynchronous interruption is needed. AVERROR(EINTR) is returned
+ * in this case by the interrupted function. 'NULL' means no interrupt
+ * callback is given. i
+ */
 void url_set_interrupt_cb(URLInterruptCB *interrupt_cb);
 
 /* not implemented */
 int url_poll(URLPollEntry *poll_table, int n, int timeout);
 
 /**
- * passing this as the "whence" parameter to a seek function causes it to
- * return the filesize without seeking anywhere, supporting this is optional
- * if its not supprted then the seek function will return <0
+ * Passing this as the "whence" parameter to a seek function causes it to
+ * return the filesize without seeking anywhere. Supporting this is optional.
+ * If it is not supported then the seek function will return <0.
  */
 #define AVSEEK_SIZE 0x10000
 
@@ -103,10 +116,10 @@
     int (*read_packet)(void *opaque, uint8_t *buf, int buf_size);
     int (*write_packet)(void *opaque, uint8_t *buf, int buf_size);
     offset_t (*seek)(void *opaque, offset_t offset, int whence);
-    offset_t pos; /* position in the file of the current buffer */
-    int must_flush; /* true if the next seek should flush */
-    int eof_reached; /* true if eof reached */
-    int write_flag;  /* true if open for writing */
+    offset_t pos; /**< position in the file of the current buffer */
+    int must_flush; /**< true if the next seek should flush */
+    int eof_reached; /**< true if eof reached */
+    int write_flag;  /**< true if open for writing */
     int is_streamed;
     int max_packet_size;
     unsigned long checksum;
@@ -146,18 +159,27 @@
 int url_ferror(ByteIOContext *s);
 
 #define URL_EOF (-1)
+/** @note return URL_EOF (-1) if EOF */
 int url_fgetc(ByteIOContext *s);
+
+/** @warning currently size is limited */
 #ifdef __GNUC__
 int url_fprintf(ByteIOContext *s, const char *fmt, ...) __attribute__ ((__format__ (__printf__, 2, 3)));
 #else
 int url_fprintf(ByteIOContext *s, const char *fmt, ...);
 #endif
+
+/** @note unlike fgets, the EOL character is not returned and a whole
+   line is parsed. return NULL if first char read was EOF */
 char *url_fgets(ByteIOContext *s, char *buf, int buf_size);
 
 void put_flush_packet(ByteIOContext *s);
 
 int get_buffer(ByteIOContext *s, unsigned char *buf, int size);
 int get_partial_buffer(ByteIOContext *s, unsigned char *buf, int size);
+
+/** @note return 0 if EOF, so you cannot use it if EOF handling is
+   necessary */
 int get_byte(ByteIOContext *s);
 unsigned int get_le24(ByteIOContext *s);
 unsigned int get_le32(ByteIOContext *s);
@@ -176,17 +198,57 @@
 }
 
 int url_fdopen(ByteIOContext *s, URLContext *h);
+
+/** @warning must be called before any I/O */
 int url_setbufsize(ByteIOContext *s, int buf_size);
+
+/** @note when opened as read/write, the buffers are only used for
+   reading */
 int url_fopen(ByteIOContext *s, const char *filename, int flags);
 int url_fclose(ByteIOContext *s);
 URLContext *url_fileno(ByteIOContext *s);
+
+/**
+ * Return the maximum packet size associated to packetized buffered file
+ * handle. If the file is not packetized (stream like http or file on
+ * disk), then 0 is returned.
+ *
+ * @param h buffered file handle
+ * @return maximum packet size in bytes
+ */
 int url_fget_max_packet_size(ByteIOContext *s);
 
 int url_open_buf(ByteIOContext *s, uint8_t *buf, int buf_size, int flags);
+
+/** return the written or read size */
 int url_close_buf(ByteIOContext *s);
 
+/**
+ * Open a write only memory stream.
+ *
+ * @param s new IO context
+ * @return zero if no error.
+ */
 int url_open_dyn_buf(ByteIOContext *s);
+
+/**
+ * Open a write only packetized memory stream with a maximum packet
+ * size of 'max_packet_size'.  The stream is stored in a memory buffer
+ * with a big endian 4 byte header giving the packet size in bytes.
+ *
+ * @param s new IO context
+ * @param max_packet_size maximum packet size (must be > 0)
+ * @return zero if no error.
+ */
 int url_open_dyn_packet_buf(ByteIOContext *s, int max_packet_size);
+
+/**
+ * Return the written size and a pointer to the buffer. The buffer
+ *  must be freed with av_free().
+ * @param s IO context
+ * @param pointer to a byte buffer
+ * @return the length of the byte buffer
+ */
 int url_close_dyn_buf(ByteIOContext *s, uint8_t **pbuffer);
 
 unsigned long get_checksum(ByteIOContext *s);

Modified: branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavformat/aviobuf.c
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavformat/aviobuf.c	2007-07-16 16:39:52 UTC (rev 3382)
+++ branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavformat/aviobuf.c	2007-07-16 17:44:22 UTC (rev 3383)
@@ -117,7 +117,7 @@
     offset_t pos= s->pos - (s->write_flag ? 0 : (s->buf_end - s->buffer));
 
     if (whence != SEEK_CUR && whence != SEEK_SET)
-        return -EINVAL;
+        return AVERROR(EINVAL);
 
     if (whence == SEEK_CUR) {
         offset1 = pos + (s->buf_ptr - s->buffer);
@@ -136,6 +136,8 @@
             fill_buffer(s);
         s->buf_ptr = s->buf_end + offset - s->pos;
     } else {
+        offset_t res = AVERROR(EPIPE);
+
 #if defined(CONFIG_MUXERS) || defined(CONFIG_NETWORK)
         if (s->write_flag) {
             flush_buffer(s);
@@ -146,8 +148,8 @@
             s->buf_end = s->buffer;
         }
         s->buf_ptr = s->buffer;
-        if (!s->seek || s->seek(s->opaque, offset, SEEK_SET) == (offset_t)-EPIPE)
-            return -EPIPE;
+        if (!s->seek || (res = s->seek(s->opaque, offset, SEEK_SET)) < 0)
+            return res;
         s->pos = offset;
     }
     s->eof_reached = 0;
@@ -169,10 +171,12 @@
     offset_t size;
 
     if (!s->seek)
-        return -EPIPE;
+        return AVERROR(EPIPE);
     size = s->seek(s->opaque, 0, AVSEEK_SIZE);
     if(size<0){
-        size = s->seek(s->opaque, -1, SEEK_END) + 1;
+        if ((size = s->seek(s->opaque, -1, SEEK_END)) < 0)
+            return size;
+        size++;
         s->seek(s->opaque, s->pos, SEEK_SET);
     }
     return size;
@@ -276,8 +280,8 @@
         /* do not modify buffer if EOF reached so that a seek back can
            be done without rereading data */
         s->eof_reached = 1;
-    if(len<0)
-        s->error= len;
+        if(len<0)
+            s->error= len;
     } else {
         s->pos += len;
         s->buf_ptr = s->buffer;
@@ -299,8 +303,6 @@
     }
 }
 
-/* NOTE: return 0 if EOF, so you cannot use it if EOF handling is
-   necessary */
 /* XXX: put an inline version */
 int get_byte(ByteIOContext *s)
 {
@@ -315,7 +317,6 @@
     }
 }
 
-/* NOTE: return URL_EOF (-1) if EOF */
 int url_fgetc(ByteIOContext *s)
 {
     if (s->buf_ptr < s->buf_end) {
@@ -507,7 +508,7 @@
     }
     buffer = av_malloc(buffer_size);
     if (!buffer)
-        return -ENOMEM;
+        return AVERROR(ENOMEM);
 
     if (init_put_byte(s, buffer, buffer_size,
                       (h->flags & URL_WRONLY || h->flags & URL_RDWR), h,
@@ -520,13 +521,12 @@
     return 0;
 }
 
-/* XXX: must be called before any I/O */
 int url_setbufsize(ByteIOContext *s, int buf_size)
 {
     uint8_t *buffer;
     buffer = av_malloc(buf_size);
     if (!buffer)
-        return -ENOMEM;
+        return AVERROR(ENOMEM);
 
     av_free(s->buffer);
     s->buffer = buffer;
@@ -539,8 +539,6 @@
     return 0;
 }
 
-/* NOTE: when opened as read/write, the buffers are only used for
-   reading */
 int url_fopen(ByteIOContext *s, const char *filename, int flags)
 {
     URLContext *h;
@@ -572,7 +570,6 @@
 }
 
 #ifdef CONFIG_MUXERS
-/* XXX: currently size is limited */
 int url_fprintf(ByteIOContext *s, const char *fmt, ...)
 {
     va_list ap;
@@ -587,8 +584,6 @@
 }
 #endif //CONFIG_MUXERS
 
-/* note: unlike fgets, the EOL character is not returned and a whole
-   line is parsed. return NULL if first char read was EOF */
 char *url_fgets(ByteIOContext *s, char *buf, int buf_size)
 {
     int c;
@@ -610,14 +605,6 @@
     return buf;
 }
 
-/*
- * Return the maximum packet size associated to packetized buffered file
- * handle. If the file is not packetized (stream like http or file on
- * disk), then 0 is returned.
- *
- * @param h buffered file handle
- * @return maximum packet size in bytes
- */
 int url_fget_max_packet_size(ByteIOContext *s)
 {
     return s->max_packet_size;
@@ -634,7 +621,6 @@
                          NULL, NULL, NULL, NULL);
 }
 
-/* return the written or read size */
 int url_close_buf(ByteIOContext *s)
 {
     put_flush_packet(s);
@@ -742,26 +728,11 @@
     return ret;
 }
 
-/*
- * Open a write only memory stream.
- *
- * @param s new IO context
- * @return zero if no error.
- */
 int url_open_dyn_buf(ByteIOContext *s)
 {
     return url_open_dyn_buf_internal(s, 0);
 }
 
-/*
- * Open a write only packetized memory stream with a maximum packet
- * size of 'max_packet_size'.  The stream is stored in a memory buffer
- * with a big endian 4 byte header giving the packet size in bytes.
- *
- * @param s new IO context
- * @param max_packet_size maximum packet size (must be > 0)
- * @return zero if no error.
- */
 int url_open_dyn_packet_buf(ByteIOContext *s, int max_packet_size)
 {
     if (max_packet_size <= 0)
@@ -769,13 +740,6 @@
     return url_open_dyn_buf_internal(s, max_packet_size);
 }
 
-/*
- * Return the written size and a pointer to the buffer. The buffer
- *  must be freed with av_free().
- * @param s IO context
- * @param pointer to a byte buffer
- * @return the length of the byte buffer
- */
 int url_close_dyn_buf(ByteIOContext *s, uint8_t **pbuffer)
 {
     DynBuffer *d = s->opaque;

Modified: branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavformat/cutils.c
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavformat/cutils.c	2007-07-16 16:39:52 UTC (rev 3382)
+++ branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavformat/cutils.c	2007-07-16 17:44:22 UTC (rev 3383)
@@ -20,96 +20,6 @@
  */
 #include "avformat.h"
 
-#if !defined(CONFIG_NOCUTILS)
-/**
- * Return TRUE if val is a prefix of str. If it returns TRUE, ptr is
- * set to the next character in 'str' after the prefix.
- *
- * @param str input string
- * @param val prefix to test
- * @param ptr updated after the prefix in str in there is a match
- * @return TRUE if there is a match
- */
-int strstart(const char *str, const char *val, const char **ptr)
-{
-    const char *p, *q;
-    p = str;
-    q = val;
-    while (*q != '\0') {
-        if (*p != *q)
-            return 0;
-        p++;
-        q++;
-    }
-    if (ptr)
-        *ptr = p;
-    return 1;
-}
-
-/**
- * Return TRUE if val is a prefix of str (case independent). If it
- * returns TRUE, ptr is set to the next character in 'str' after the
- * prefix.
- *
- * @param str input string
- * @param val prefix to test
- * @param ptr updated after the prefix in str in there is a match
- * @return TRUE if there is a match */
-int stristart(const char *str, const char *val, const char **ptr)
-{
-    const char *p, *q;
-    p = str;
-    q = val;
-    while (*q != '\0') {
-        if (toupper(*(const unsigned char *)p) != toupper(*(const unsigned char *)q))
-            return 0;
-        p++;
-        q++;
-    }
-    if (ptr)
-        *ptr = p;
-    return 1;
-}
-
-/**
- * Copy the string str to buf. If str length is bigger than buf_size -
- * 1 then it is clamped to buf_size - 1.
- * NOTE: this function does what strncpy should have done to be
- * useful. NEVER use strncpy.
- *
- * @param buf destination buffer
- * @param buf_size size of destination buffer
- * @param str source string
- */
-void pstrcpy(char *buf, int buf_size, const char *str)
-{
-    int c;
-    char *q = buf;
-
-    if (buf_size <= 0)
-        return;
-
-    for(;;) {
-        c = *str++;
-        if (c == 0 || q >= buf + buf_size - 1)
-            break;
-        *q++ = c;
-    }
-    *q = '\0';
-}
-
-/* strcat and truncate. */
-char *pstrcat(char *buf, int buf_size, const char *s)
-{
-    int len;
-    len = strlen(buf);
-    if (len < buf_size)
-        pstrcpy(buf + len, buf_size - len, s);
-    return buf;
-}
-
-#endif
-
 /* add one element to a dynamic array */
 void __dynarray_add(unsigned long **tab_ptr, int *nb_ptr, unsigned long elem)
 {
@@ -152,7 +62,7 @@
 #define ISLEAP(y) (((y) % 4 == 0) && (((y) % 100) != 0 || ((y) % 400) == 0))
 #define LEAPS_COUNT(y) ((y)/4 - (y)/100 + (y)/400)
 
-/* this is our own gmtime_r. it differs from its POSIX counterpart in a
+/* This is our own gmtime_r. It differs from its POSIX counterpart in a
    couple of places, though. */
 struct tm *brktimegm(time_t secs, struct tm *tm)
 {

Modified: branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavformat/dv.h
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavformat/dv.h	2007-07-16 16:39:52 UTC (rev 3382)
+++ branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavformat/dv.h	2007-07-16 17:44:22 UTC (rev 3383)
@@ -25,6 +25,11 @@
  * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA
  */
 
+#ifndef AVFORMAT_DV_H
+#define AVFORMAT_DV_H
+
+#include "avformat.h"
+
 typedef struct DVDemuxContext DVDemuxContext;
 DVDemuxContext* dv_init_demux(AVFormatContext* s);
 int dv_get_packet(DVDemuxContext*, AVPacket *);
@@ -35,3 +40,5 @@
 DVMuxContext* dv_init_mux(AVFormatContext* s);
 int dv_assemble_frame(DVMuxContext *c, AVStream*, const uint8_t*, int, uint8_t**);
 void dv_delete_mux(DVMuxContext*);
+
+#endif // AVFORMAT_DV_H

Modified: branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavformat/file.c
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavformat/file.c	2007-07-16 16:39:52 UTC (rev 3382)
+++ branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavformat/file.c	2007-07-16 17:44:22 UTC (rev 3383)
@@ -19,6 +19,7 @@
  * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA
  */
 #include "avformat.h"
+#include "avstring.h"
 #include <fcntl.h>
 #include <unistd.h>
 #include <sys/time.h>
@@ -31,7 +32,7 @@
     int access;
     int fd;
 
-    strstart(filename, "file:", &filename);
+    av_strstart(filename, "file:", &filename);
 
     if (flags & URL_RDWR) {
         access = O_CREAT | O_TRUNC | O_RDWR;
@@ -40,12 +41,12 @@
     } else {
         access = O_RDONLY;
     }
-#if defined(__MINGW32__) || defined(CONFIG_OS2) || defined(__CYGWIN__)
+#ifdef O_BINARY
     access |= O_BINARY;
 #endif
     fd = open(filename, access, 0666);
     if (fd < 0)
-        return -ENOENT;
+        return AVERROR(ENOENT);
     h->priv_data = (void *)(size_t)fd;
     return 0;
 }
@@ -95,7 +96,7 @@
     } else {
         fd = 0;
     }
-#if defined(__MINGW32__) || defined(CONFIG_OS2) || defined(__CYGWIN__)
+#ifdef O_BINARY
     setmode(fd, O_BINARY);
 #endif
     h->priv_data = (void *)(size_t)fd;

Modified: branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavformat/flv.h
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavformat/flv.h	2007-07-16 16:39:52 UTC (rev 3382)
+++ branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavformat/flv.h	2007-07-16 17:44:22 UTC (rev 3383)
@@ -80,9 +80,11 @@
 };
 
 enum {
-    FLV_CODECID_H263   = 2,
-    FLV_CODECID_SCREEN = 3,
-    FLV_CODECID_VP6    = 4,
+    FLV_CODECID_H263    = 2,
+    FLV_CODECID_SCREEN  = 3,
+    FLV_CODECID_VP6     = 4,
+    FLV_CODECID_VP6A    = 5,
+    FLV_CODECID_SCREEN2 = 6,
 };
 
 enum {

Modified: branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavformat/img2.c
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavformat/img2.c	2007-07-16 16:39:52 UTC (rev 3382)
+++ branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavformat/img2.c	2007-07-16 17:44:22 UTC (rev 3383)
@@ -20,6 +20,7 @@
  * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA
  */
 #include "avformat.h"
+#include "avstring.h"
 
 typedef struct {
     int img_first;
@@ -54,6 +55,8 @@
     { CODEC_ID_GIF       , "gif"},
     { CODEC_ID_TARGA     , "tga"},
     { CODEC_ID_TIFF      , "tiff"},
+    { CODEC_ID_SGI       , "sgi"},
+    { CODEC_ID_PTX       , "ptx"},
     {0, NULL}
 };
 
@@ -177,10 +180,10 @@
 
     st = av_new_stream(s1, 0);
     if (!st) {
-        return -ENOMEM;
+        return AVERROR(ENOMEM);
     }
 
-    pstrcpy(s->path, sizeof(s->path), s1->filename);
+    av_strlcpy(s->path, s1->filename, sizeof(s->path));
     s->img_number = 0;
     s->img_count = 0;
 
@@ -189,7 +192,7 @@
         s->is_pipe = 0;
     else{
         s->is_pipe = 1;
-        st->need_parsing= 1;
+        st->need_parsing = AVSTREAM_PARSE_FULL;
     }
 
     if (!ap->time_base.num) {
@@ -305,7 +308,7 @@
     VideoData *img = s->priv_data;
 
     img->img_number = 1;
-    pstrcpy(img->path, sizeof(img->path), s->filename);
+    av_strlcpy(img->path, s->filename, sizeof(img->path));
 
     /* find format */
     if (s->oformat->flags & AVFMT_NOFILE)

Modified: branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavformat/isom.c
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavformat/isom.c	2007-07-16 16:39:52 UTC (rev 3382)
+++ branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavformat/isom.c	2007-07-16 17:44:22 UTC (rev 3383)
@@ -25,8 +25,8 @@
 #include "riff.h"
 #include "isom.h"
 
-/* http://gpac.sourceforge.net/tutorial/mediatypes.htm */
-const AVCodecTag ff_mov_obj_type[] = {
+/* http://www.mp4ra.org */
+const AVCodecTag ff_mp4_obj_type[] = {
     { CODEC_ID_MPEG4     ,  32 },
     { CODEC_ID_H264      ,  33 },
     { CODEC_ID_AAC       ,  64 },
@@ -39,12 +39,15 @@
     { CODEC_ID_AAC       , 102 }, /* MPEG2 AAC Main */
     { CODEC_ID_AAC       , 103 }, /* MPEG2 AAC Low */
     { CODEC_ID_AAC       , 104 }, /* MPEG2 AAC SSR */
-    { CODEC_ID_MP3       , 105 },
-    { CODEC_ID_MPEG1VIDEO, 106 },
-    { CODEC_ID_MP2       , 107 },
-    { CODEC_ID_MJPEG     , 108 },
+    { CODEC_ID_MP3       , 105 }, /* 13818-3 */
+    { CODEC_ID_MPEG1VIDEO, 106 }, /* 11172-2 */
+    { CODEC_ID_MP2       , 107 }, /* 11172-3 */ /* MEANX WAS MP3 */
+    { CODEC_ID_MJPEG     , 108 }, /* 10918-1 */
+    { CODEC_ID_PNG       , 109 },
+    { CODEC_ID_JPEG2000  , 110 }, /* 15444-1 */
+    { CODEC_ID_VC1       , 163 },
+    { CODEC_ID_VORBIS    , 221 },
     { CODEC_ID_PCM_S16LE , 224 },
-    { CODEC_ID_VORBIS    , 221 },
     { CODEC_ID_QCELP     , 225 },
     { CODEC_ID_AC3       , 226 },
     { CODEC_ID_PCM_ALAW  , 227 },
@@ -55,6 +58,125 @@
     { 0, 0 },
 };
 
+const AVCodecTag codec_movvideo_tags[] = {
+/*  { CODEC_ID_, MKTAG('I', 'V', '5', '0') }, *//* Indeo 5.0 */
+
+    { CODEC_ID_RAWVIDEO, MKTAG('r', 'a', 'w', ' ') }, /* Uncompressed RGB */
+/*  { CODEC_ID_RAWVIDEO, MKTAG('Y', 'u', 'v', '2') }, *//* Uncompressed YUV422 */
+    { CODEC_ID_RAWVIDEO, MKTAG('A', 'V', 'U', 'I') }, /* YUV with alpha-channel (AVID Uncompressed) */
+    { CODEC_ID_RAWVIDEO, MKTAG('2', 'v', 'u', 'y') }, /* UNCOMPRESSED 8BIT 4:2:2 */
+
+    { CODEC_ID_MJPEG,  MKTAG('j', 'p', 'e', 'g') }, /* PhotoJPEG */
+    { CODEC_ID_MJPEG,  MKTAG('m', 'j', 'p', 'a') }, /* Motion-JPEG (format A) */
+    { CODEC_ID_MJPEG,  MKTAG('A', 'V', 'D', 'J') }, /* MJPEG with alpha-channel (AVID JFIF meridien compressed) */
+/*  { CODEC_ID_MJPEG,  MKTAG('A', 'V', 'R', 'n') }, *//* MJPEG with alpha-channel (AVID ABVB/Truevision NuVista) */
+    { CODEC_ID_MJPEG,  MKTAG('d', 'm', 'b', '1') }, /* Motion JPEG OpenDML */
+    { CODEC_ID_MJPEGB, MKTAG('m', 'j', 'p', 'b') }, /* Motion-JPEG (format B) */
+
+    { CODEC_ID_SVQ1, MKTAG('S', 'V', 'Q', '1') }, /* Sorenson Video v1 */
+    { CODEC_ID_SVQ1, MKTAG('s', 'v', 'q', '1') }, /* Sorenson Video v1 */
+    { CODEC_ID_SVQ1, MKTAG('s', 'v', 'q', 'i') }, /* Sorenson Video v1 (from QT specs)*/
+    { CODEC_ID_SVQ3, MKTAG('S', 'V', 'Q', '3') }, /* Sorenson Video v3 */
+
+    { CODEC_ID_MPEG4, MKTAG('m', 'p', '4', 'v') },
+    { CODEC_ID_MPEG4, MKTAG('D', 'I', 'V', 'X') }, /* OpenDiVX *//* sample files at http://heroinewarrior.com/xmovie.php3 use this tag */
+    { CODEC_ID_MPEG4, MKTAG('X', 'V', 'I', 'D') },
+    { CODEC_ID_MPEG4, MKTAG('3', 'I', 'V', '2') }, /* experimental: 3IVX files before ivx D4 4.5.1 */
+
+    { CODEC_ID_H263, MKTAG('h', '2', '6', '3') }, /* H263 */
+    { CODEC_ID_H263, MKTAG('s', '2', '6', '3') }, /* H263 ?? works */
+
+    { CODEC_ID_DVVIDEO, MKTAG('d', 'v', 'c', 'p') }, /* DV PAL */
+    { CODEC_ID_DVVIDEO, MKTAG('d', 'v', 'c', ' ') }, /* DV NTSC */
+    { CODEC_ID_DVVIDEO, MKTAG('d', 'v', 'p', 'p') }, /* DVCPRO PAL produced by FCP */
+    { CODEC_ID_DVVIDEO, MKTAG('d', 'v', '5', 'p') }, /* DVCPRO50 PAL produced by FCP */
+    { CODEC_ID_DVVIDEO, MKTAG('d', 'v', '5', 'n') }, /* DVCPRO50 NTSC produced by FCP */
+    { CODEC_ID_DVVIDEO, MKTAG('A', 'V', 'd', 'v') }, /* AVID DV */
+  //{ CODEC_ID_DVVIDEO, MKTAG('d', 'v', 'h', '5') }, /* DVCPRO HD 50i produced by FCP */
+  //{ CODEC_ID_DVVIDEO, MKTAG('d', 'v', 'h', '6') }, /* DVCPRO HD 60i produced by FCP */
+
+    { CODEC_ID_VP3,     MKTAG('V', 'P', '3', '1') }, /* On2 VP3 */
+    { CODEC_ID_RPZA,    MKTAG('r', 'p', 'z', 'a') }, /* Apple Video (RPZA) */
+    { CODEC_ID_CINEPAK, MKTAG('c', 'v', 'i', 'd') }, /* Cinepak */
+    { CODEC_ID_8BPS,    MKTAG('8', 'B', 'P', 'S') }, /* Planar RGB (8BPS) */
+    { CODEC_ID_SMC,     MKTAG('s', 'm', 'c', ' ') }, /* Apple Graphics (SMC) */
+    { CODEC_ID_QTRLE,   MKTAG('r', 'l', 'e', ' ') }, /* Apple Animation (RLE) */
+    { CODEC_ID_MSRLE,   MKTAG('W', 'R', 'L', 'E') },
+    { CODEC_ID_QDRAW,   MKTAG('q', 'd', 'r', 'w') }, /* QuickDraw */
+
+    { CODEC_ID_H264, MKTAG('a', 'v', 'c', '1') }, /* AVC-1/H.264 */
+
+    { CODEC_ID_MPEG1VIDEO, MKTAG('m', 'p', 'e', 'g') }, /* MPEG */
+    { CODEC_ID_MPEG2VIDEO, MKTAG('h', 'd', 'v', '1') }, /* HDV 720p30 */
+    { CODEC_ID_MPEG2VIDEO, MKTAG('h', 'd', 'v', '2') }, /* MPEG2 produced by Sony HD camera */
+    { CODEC_ID_MPEG2VIDEO, MKTAG('h', 'd', 'v', '3') }, /* HDV produced by FCP */
+    { CODEC_ID_MPEG2VIDEO, MKTAG('m', 'x', '5', 'n') }, /* MPEG2 IMX NTSC 525/60 50mb/s produced by FCP */
+    { CODEC_ID_MPEG2VIDEO, MKTAG('m', 'x', '5', 'p') }, /* MPEG2 IMX PAL 625/50 50mb/s produced by FCP */
+    { CODEC_ID_MPEG2VIDEO, MKTAG('m', 'x', '3', 'n') }, /* MPEG2 IMX NTSC 525/60 30mb/s produced by FCP */
+    { CODEC_ID_MPEG2VIDEO, MKTAG('m', 'x', '3', 'p') }, /* MPEG2 IMX PAL 625/50 30mb/s produced by FCP */
+    { CODEC_ID_MPEG2VIDEO, MKTAG('x', 'd', 'v', '2') }, /* XDCAM HD 1080i60 */
+    { CODEC_ID_MPEG2VIDEO, MKTAG('A', 'V', 'm', 'p') }, /* AVID IMX PAL */
+
+  //{ CODEC_ID_JPEG2000, MKTAG('m', 'j', 'p', '2') }, /* JPEG 2000 produced by FCP */
+
+    { CODEC_ID_TARGA, MKTAG('t', 'g', 'a', ' ') }, /* Truevision Targa */
+    { CODEC_ID_TIFF,  MKTAG('t', 'i', 'f', 'f') }, /* TIFF embedded in MOV */
+    { CODEC_ID_GIF,   MKTAG('g', 'i', 'f', ' ') }, /* embedded gif files as frames (usually one "click to play movie" frame) */
+    { CODEC_ID_PNG,   MKTAG('p', 'n', 'g', ' ') },
+
+    { CODEC_ID_VC1, MKTAG('v', 'c', '-', '1') }, /* SMPTE RP 2025 */
+
+    { CODEC_ID_DNXHD, MKTAG('A', 'V', 'd', 'n') }, /* AVID DNxHD */
+    { CODEC_ID_SGI,   MKTAG('s', 'g', 'i', ' ') }, /* SGI  */
+
+    { CODEC_ID_NONE, 0 },
+};
+
+const AVCodecTag codec_movaudio_tags[] = {
+    { CODEC_ID_PCM_S32BE, MKTAG('i', 'n', '3', '2') },
+    { CODEC_ID_PCM_S32LE, MKTAG('i', 'n', '3', '2') },
+    { CODEC_ID_PCM_S24BE, MKTAG('i', 'n', '2', '4') },
+    { CODEC_ID_PCM_S24LE, MKTAG('i', 'n', '2', '4') },
+    { CODEC_ID_PCM_S16BE, MKTAG('t', 'w', 'o', 's') }, /* 16 bits */
+    { CODEC_ID_PCM_S16BE, MKTAG('N', 'O', 'N', 'E') }, /* uncompressed */
+    { CODEC_ID_PCM_S16LE, MKTAG('s', 'o', 'w', 't') }, /*  */
+    { CODEC_ID_PCM_S16LE, MKTAG('l', 'p', 'c', 'm') },
+    { CODEC_ID_PCM_S8,    MKTAG('s', 'o', 'w', 't') },
+    { CODEC_ID_PCM_U8,    MKTAG('r', 'a', 'w', ' ') }, /* 8 bits unsigned */
+    { CODEC_ID_PCM_MULAW, MKTAG('u', 'l', 'a', 'w') }, /*  */
+    { CODEC_ID_PCM_ALAW,  MKTAG('a', 'l', 'a', 'w') }, /*  */
+
+    { CODEC_ID_ADPCM_IMA_QT, MKTAG('i', 'm', 'a', '4') }, /* IMA-4 ADPCM */
+    { CODEC_ID_ADPCM_MS,     MKTAG('m', 's', 0x00, 0x02) }, /* MS ADPCM */
+
+    { CODEC_ID_MACE3, MKTAG('M', 'A', 'C', '3') }, /* Macintosh Audio Compression and Expansion 3:1 */
+    { CODEC_ID_MACE6, MKTAG('M', 'A', 'C', '6') }, /* Macintosh Audio Compression and Expansion 6:1 */
+
+    // MEANX{ CODEC_ID_MP3, MKTAG('.', 'm', 'p', '3') }, /* MPEG layer 3 */ /* sample files at http://www.3ivx.com/showcase.html use this tag */
+     { CODEC_ID_MP3, MKTAG( 'm', 'p', '4','a') },
+
+    // /MEANX
+    { CODEC_ID_MP3, 0x6D730055 }, /* MPEG layer 3 */
+    { CODEC_ID_MP3, MKTAG('m', 's', 0x00, 0x55) }, /* MPEG layer 3 *//* XXX: check endianness */
+
+/*  { CODEC_ID_OGG_VORBIS, MKTAG('O', 'g', 'g', 'S') }, *//* sample files at http://heroinewarrior.com/xmovie.php3 use this tag */
+
+    { CODEC_ID_AAC, MKTAG('m', 'p', '4', 'a') }, /* MPEG-4 AAC */
+
+    { CODEC_ID_AMR_NB, MKTAG('s', 'a', 'm', 'r') }, /* AMR-NB 3gp */
+    { CODEC_ID_AMR_WB, MKTAG('s', 'a', 'w', 'b') }, /* AMR-WB 3gp */
+
+    { CODEC_ID_AC3,  MKTAG('m', 's', 0x20, 0x00) }, /* Dolby AC-3 */
+
+    { CODEC_ID_ALAC, MKTAG('a', 'l', 'a', 'c') }, /* Apple Lossless */
+    { CODEC_ID_QDM2, MKTAG('Q', 'D', 'M', '2') }, /* QDM2 */
+
+    { CODEC_ID_DVAUDIO, MKTAG('v', 'd', 'v', 'a') },
+    { CODEC_ID_DVAUDIO, MKTAG('d', 'v', 'c', 'a') },
+
+    { CODEC_ID_NONE, 0 },
+};
+
 /* map numeric codes from mdhd atom to ISO 639 */
 /* cf. QTFileFormat.pdf p253, qtff.pdf p205 */
 /* http://developer.apple.com/documentation/mac/Text/Text-368.html */

Modified: branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavformat/isom.h
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavformat/isom.h	2007-07-16 16:39:52 UTC (rev 3382)
+++ branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavformat/isom.h	2007-07-16 17:44:22 UTC (rev 3383)
@@ -24,15 +24,19 @@
 #ifndef FFMPEG_ISOM_H
 #define FFMPEG_ISOM_H
 
+#include "riff.h"
+
 /* isom.c */
-extern const AVCodecTag ff_mov_obj_type[];
+extern const AVCodecTag ff_mp4_obj_type[];
+extern const AVCodecTag codec_movvideo_tags[];
+extern const AVCodecTag codec_movaudio_tags[];
 
 int ff_mov_iso639_to_lang(const char *lang, int mp4);
 int ff_mov_lang_to_iso639(int code, char *to);
 
-typedef struct Time2Sample{
+typedef struct {
     int count;
     int duration;
-}Time2Sample;
+} MOV_stts_t;
 
 #endif /* FFMPEG_ISOM_H */

Modified: branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavformat/matroska.c
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavformat/matroska.c	2007-07-16 16:39:52 UTC (rev 3382)
+++ branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavformat/matroska.c	2007-07-16 17:44:22 UTC (rev 3383)
@@ -1,5 +1,5 @@
 /*
- * Matroska file demuxer (no muxer yet)
+ * Matroska common data
  * Copyright (c) 2003-2004 The ffmpeg Project
  *
  * This file is part of FFmpeg.
@@ -19,184 +19,9 @@
  * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA
  */
 
-/**
- * @file matroska.c
- * Matroska file demuxer
- * by Ronald Bultje <rbultje at ronald.bitfreak.net>
- * with a little help from Moritz Bunkus <moritz at bunkus.org>
- * Specs available on the matroska project page:
- * http://www.matroska.org/.
- */
+#include "matroska.h"
 
-#include "avformat.h"
-/* For codec_get_bmp_id and codec_get_wav_id. */
-#include "riff.h"
-#include "intfloat_readwrite.h"
-
-/* EBML version supported */
-#define EBML_VERSION 1
-
-/* top-level master-IDs */
-#define EBML_ID_HEADER             0x1A45DFA3
-
-/* IDs in the HEADER master */
-#define EBML_ID_EBMLVERSION        0x4286
-#define EBML_ID_EBMLREADVERSION    0x42F7
-#define EBML_ID_EBMLMAXIDLENGTH    0x42F2
-#define EBML_ID_EBMLMAXSIZELENGTH  0x42F3
-#define EBML_ID_DOCTYPE            0x4282
-#define EBML_ID_DOCTYPEVERSION     0x4287
-#define EBML_ID_DOCTYPEREADVERSION 0x4285
-
-/* general EBML types */
-#define EBML_ID_VOID               0xEC
-
-/*
- * Matroska element IDs. max. 32-bit.
- */
-
-/* toplevel segment */
-#define MATROSKA_ID_SEGMENT    0x18538067
-
-/* matroska top-level master IDs */
-#define MATROSKA_ID_INFO       0x1549A966
-#define MATROSKA_ID_TRACKS     0x1654AE6B
-#define MATROSKA_ID_CUES       0x1C53BB6B
-#define MATROSKA_ID_TAGS       0x1254C367
-#define MATROSKA_ID_SEEKHEAD   0x114D9B74
-#define MATROSKA_ID_CLUSTER    0x1F43B675
-
-/* IDs in the info master */
-#define MATROSKA_ID_TIMECODESCALE 0x2AD7B1
-#define MATROSKA_ID_DURATION   0x4489
-#define MATROSKA_ID_TITLE      0x7BA9
-#define MATROSKA_ID_WRITINGAPP 0x5741
-#define MATROSKA_ID_MUXINGAPP  0x4D80
-#define MATROSKA_ID_DATEUTC    0x4461
-
-/* ID in the tracks master */
-#define MATROSKA_ID_TRACKENTRY 0xAE
-
-/* IDs in the trackentry master */
-#define MATROSKA_ID_TRACKNUMBER 0xD7
-#define MATROSKA_ID_TRACKUID   0x73C5
-#define MATROSKA_ID_TRACKTYPE  0x83
-#define MATROSKA_ID_TRACKAUDIO 0xE1
-#define MATROSKA_ID_TRACKVIDEO 0xE0
-#define MATROSKA_ID_CODECID    0x86
-#define MATROSKA_ID_CODECPRIVATE 0x63A2
-#define MATROSKA_ID_CODECNAME  0x258688
-#define MATROSKA_ID_CODECINFOURL 0x3B4040
-#define MATROSKA_ID_CODECDOWNLOADURL 0x26B240
-#define MATROSKA_ID_TRACKNAME  0x536E
-#define MATROSKA_ID_TRACKLANGUAGE 0x22B59C
-#define MATROSKA_ID_TRACKFLAGENABLED 0xB9
-#define MATROSKA_ID_TRACKFLAGDEFAULT 0x88
-#define MATROSKA_ID_TRACKFLAGLACING 0x9C
-#define MATROSKA_ID_TRACKMINCACHE 0x6DE7
-#define MATROSKA_ID_TRACKMAXCACHE 0x6DF8
-#define MATROSKA_ID_TRACKDEFAULTDURATION 0x23E383
-
-/* IDs in the trackvideo master */
-#define MATROSKA_ID_VIDEOFRAMERATE 0x2383E3
-#define MATROSKA_ID_VIDEODISPLAYWIDTH 0x54B0
-#define MATROSKA_ID_VIDEODISPLAYHEIGHT 0x54BA
-#define MATROSKA_ID_VIDEOPIXELWIDTH 0xB0
-#define MATROSKA_ID_VIDEOPIXELHEIGHT 0xBA
-#define MATROSKA_ID_VIDEOFLAGINTERLACED 0x9A
-#define MATROSKA_ID_VIDEOSTEREOMODE 0x53B9
-#define MATROSKA_ID_VIDEOASPECTRATIO 0x54B3
-#define MATROSKA_ID_VIDEOCOLOURSPACE 0x2EB524
-
-/* IDs in the trackaudio master */
-#define MATROSKA_ID_AUDIOSAMPLINGFREQ 0xB5
-#define MATROSKA_ID_AUDIOOUTSAMPLINGFREQ 0x78B5
-
-#define MATROSKA_ID_AUDIOBITDEPTH 0x6264
-#define MATROSKA_ID_AUDIOCHANNELS 0x9F
-
-/* ID in the cues master */
-#define MATROSKA_ID_POINTENTRY 0xBB
-
-/* IDs in the pointentry master */
-#define MATROSKA_ID_CUETIME    0xB3
-#define MATROSKA_ID_CUETRACKPOSITION 0xB7
-
-/* IDs in the cuetrackposition master */
-#define MATROSKA_ID_CUETRACK   0xF7
-#define MATROSKA_ID_CUECLUSTERPOSITION 0xF1
-
-/* IDs in the tags master */
-/* TODO */
-
-/* IDs in the seekhead master */
-#define MATROSKA_ID_SEEKENTRY  0x4DBB
-
-/* IDs in the seekpoint master */
-#define MATROSKA_ID_SEEKID     0x53AB
-#define MATROSKA_ID_SEEKPOSITION 0x53AC
-
-/* IDs in the cluster master */
-#define MATROSKA_ID_CLUSTERTIMECODE 0xE7
-#define MATROSKA_ID_BLOCKGROUP 0xA0
-
-/* IDs in the blockgroup master */
-#define MATROSKA_ID_BLOCK      0xA1
-#define MATROSKA_ID_BLOCKDURATION 0x9B
-#define MATROSKA_ID_BLOCKREFERENCE 0xFB
-
-typedef enum {
-  MATROSKA_TRACK_TYPE_VIDEO    = 0x1,
-  MATROSKA_TRACK_TYPE_AUDIO    = 0x2,
-  MATROSKA_TRACK_TYPE_COMPLEX  = 0x3,
-  MATROSKA_TRACK_TYPE_LOGO     = 0x10,
-  MATROSKA_TRACK_TYPE_SUBTITLE = 0x11,
-  MATROSKA_TRACK_TYPE_CONTROL  = 0x20,
-} MatroskaTrackType;
-
-typedef enum {
-  MATROSKA_EYE_MODE_MONO  = 0x0,
-  MATROSKA_EYE_MODE_RIGHT = 0x1,
-  MATROSKA_EYE_MODE_LEFT  = 0x2,
-  MATROSKA_EYE_MODE_BOTH  = 0x3,
-} MatroskaEyeMode;
-
-typedef enum {
-  MATROSKA_ASPECT_RATIO_MODE_FREE  = 0x0,
-  MATROSKA_ASPECT_RATIO_MODE_KEEP  = 0x1,
-  MATROSKA_ASPECT_RATIO_MODE_FIXED = 0x2,
-} MatroskaAspectRatioMode;
-
-/*
- * These aren't in any way "matroska-form" things,
- * it's just something I use in the muxer/demuxer.
- */
-
-typedef enum {
-  MATROSKA_TRACK_ENABLED = (1<<0),
-  MATROSKA_TRACK_DEFAULT = (1<<1),
-  MATROSKA_TRACK_LACING  = (1<<2),
-  MATROSKA_TRACK_REAL_V  = (1<<4),
-  MATROSKA_TRACK_SHIFT   = (1<<16)
-} MatroskaTrackFlags;
-
-typedef enum {
-  MATROSKA_VIDEOTRACK_INTERLACED = (MATROSKA_TRACK_SHIFT<<0)
-} MatroskaVideoTrackFlags;
-
-/*
- * Matroska Codec IDs. Strings.
- */
-
-typedef struct CodecTags{
-    const char *str;
-    enum CodecID id;
-}CodecTags;
-
-#define MATROSKA_CODEC_ID_VIDEO_VFW_FOURCC   "V_MS/VFW/FOURCC"
-#define MATROSKA_CODEC_ID_AUDIO_ACM          "A_MS/ACM"
-
-static CodecTags codec_tags[]={
+CodecTags ff_mkv_codec_tags[]={
 //    {"V_MS/VFW/FOURCC"  , CODEC_ID_NONE},
     {"V_UNCOMPRESSED"   , CODEC_ID_RAWVIDEO},
     {"V_MPEG4/ISO/SP"   , CODEC_ID_MPEG4},
@@ -211,6 +36,7 @@
     {"V_REAL/RV20"      , CODEC_ID_RV20},
     {"V_REAL/RV30"      , CODEC_ID_RV30},
     {"V_REAL/RV40"      , CODEC_ID_RV40},
+    {"V_THEORA"         , CODEC_ID_THEORA},
 /* TODO: Real/Quicktime */
 
 //    {"A_MS/ACM"         , CODEC_ID_NONE},
@@ -227,2541 +53,18 @@
     {"A_FLAC"           , CODEC_ID_FLAC},
     {"A_WAVPACK4"       , CODEC_ID_WAVPACK},
     {"A_TTA1"           , CODEC_ID_TTA},
+    {"A_REAL/14_4"      , CODEC_ID_RA_144},
+    {"A_REAL/28_8"      , CODEC_ID_RA_288},
+    {"A_REAL/ATRC"      , CODEC_ID_ATRAC3},
+    {"A_REAL/COOK"      , CODEC_ID_COOK},
+//    {"A_REAL/SIPR"      , CODEC_ID_SIPRO},
+
+    {"S_TEXT/ASCII"     , CODEC_ID_TEXT},
+    {"S_TEXT/UTF8"      , CODEC_ID_TEXT},
+    {"S_TEXT/ASS"       , CODEC_ID_TEXT},
+    {"S_TEXT/SSA"       , CODEC_ID_TEXT},
+    {"S_VOBSUB"         , CODEC_ID_DVD_SUBTITLE},
+
     {NULL               , CODEC_ID_NONE}
 /* TODO: AC3-9/10 (?), Real, Musepack, Quicktime */
 };
-
-/* max. depth in the EBML tree structure */
-#define EBML_MAX_DEPTH 16
-
-typedef struct Track {
-    MatroskaTrackType type;
-
-    /* Unique track number and track ID. stream_index is the index that
-     * the calling app uses for this track. */
-    uint32_t num,
-        uid,
-        stream_index;
-
-    char *name,
-        *language;
-
-    char *codec_id,
-        *codec_name;
-
-    unsigned char *codec_priv;
-    int codec_priv_size;
-
-    int64_t default_duration;
-    MatroskaTrackFlags flags;
-} MatroskaTrack;
-
-typedef struct MatroskaVideoTrack {
-    MatroskaTrack track;
-
-    int pixel_width,
-        pixel_height,
-        display_width,
-        display_height;
-
-    uint32_t fourcc;
-
-    MatroskaAspectRatioMode ar_mode;
-    MatroskaEyeMode eye_mode;
-
-    //..
-} MatroskaVideoTrack;
-
-typedef struct MatroskaAudioTrack {
-    MatroskaTrack track;
-
-    int channels,
-        bitdepth,
-        internal_samplerate,
-        samplerate;
-    //..
-} MatroskaAudioTrack;
-
-typedef struct MatroskaSubtitleTrack {
-    MatroskaTrack track;
-
-    //..
-} MatroskaSubtitleTrack;
-
-typedef struct MatroskaLevel {
-    uint64_t start, length;
-} MatroskaLevel;
-
-typedef struct MatroskaDemuxIndex {
-  uint64_t        pos;   /* of the corresponding *cluster*! */
-  uint16_t        track; /* reference to 'num' */
-  uint64_t        time;  /* in nanoseconds */
-} MatroskaDemuxIndex;
-
-typedef struct MatroskaDemuxContext {
-    AVFormatContext *ctx;
-
-    /* ebml stuff */
-    int num_levels;
-    MatroskaLevel levels[EBML_MAX_DEPTH];
-    int level_up;
-
-    /* matroska stuff */
-    char *writing_app,
-        *muxing_app;
-    int64_t created;
-
-    /* timescale in the file */
-    int64_t time_scale;
-
-    /* position (time, ns) */
-    int64_t pos;
-
-    /* num_streams is the number of streams that av_new_stream() was called
-     * for ( = that are available to the calling program). */
-    int num_tracks, num_streams;
-    MatroskaTrack *tracks[MAX_STREAMS];
-
-    /* cache for ID peeking */
-    uint32_t peek_id;
-
-    /* byte position of the segment inside the stream */
-    offset_t segment_start;
-
-    /* The packet queue. */
-    AVPacket **packets;
-    int num_packets;
-
-    /* have we already parse metadata/cues/clusters? */
-    int metadata_parsed,
-        index_parsed,
-        done;
-
-    /* The index for seeking. */
-    int num_indexes;
-    MatroskaDemuxIndex *index;
-} MatroskaDemuxContext;
-
-/*
- * The first few functions handle EBML file parsing. The rest
- * is the document interpretation. Matroska really just is a
- * EBML file.
- */
-
-/*
- * Return: the amount of levels in the hierarchy that the
- * current element lies higher than the previous one.
- * The opposite isn't done - that's auto-done using master
- * element reading.
- */
-
-static int
-ebml_read_element_level_up (MatroskaDemuxContext *matroska)
-{
-    ByteIOContext *pb = &matroska->ctx->pb;
-    offset_t pos = url_ftell(pb);
-    int num = 0;
-
-    while (matroska->num_levels > 0) {
-        MatroskaLevel *level = &matroska->levels[matroska->num_levels - 1];
-
-        if (pos >= level->start + level->length) {
-            matroska->num_levels--;
-            num++;
-        } else {
-            break;
-        }
-    }
-
-    return num;
-}
-
-/*
- * Read: an "EBML number", which is defined as a variable-length
- * array of bytes. The first byte indicates the length by giving a
- * number of 0-bits followed by a one. The position of the first
- * "one" bit inside the first byte indicates the length of this
- * number.
- * Returns: num. of bytes read. < 0 on error.
- */
-
-static int
-ebml_read_num (MatroskaDemuxContext *matroska,
-               int                   max_size,
-               uint64_t             *number)
-{
-    ByteIOContext *pb = &matroska->ctx->pb;
-    int len_mask = 0x80, read = 1, n = 1;
-    int64_t total = 0;
-
-    /* the first byte tells us the length in bytes - get_byte() can normally
-     * return 0, but since that's not a valid first ebmlID byte, we can
-     * use it safely here to catch EOS. */
-    if (!(total = get_byte(pb))) {
-        /* we might encounter EOS here */
-        if (!url_feof(pb)) {
-            offset_t pos = url_ftell(pb);
-            av_log(matroska->ctx, AV_LOG_ERROR,
-                   "Read error at pos. %"PRIu64" (0x%"PRIx64")\n",
-                   pos, pos);
-        }
-        return AVERROR_IO; /* EOS or actual I/O error */
-    }
-
-    /* get the length of the EBML number */
-    while (read <= max_size && !(total & len_mask)) {
-        read++;
-        len_mask >>= 1;
-    }
-    if (read > max_size) {
-        offset_t pos = url_ftell(pb) - 1;
-        av_log(matroska->ctx, AV_LOG_ERROR,
-               "Invalid EBML number size tag 0x%02x at pos %"PRIu64" (0x%"PRIx64")\n",
-               (uint8_t) total, pos, pos);
-        return AVERROR_INVALIDDATA;
-    }
-
-    /* read out length */
-    total &= ~len_mask;
-    while (n++ < read)
-        total = (total << 8) | get_byte(pb);
-
-    *number = total;
-
-    return read;
-}
-
-/*
- * Read: the element content data ID.
- * Return: the number of bytes read or < 0 on error.
- */
-
-static int
-ebml_read_element_id (MatroskaDemuxContext *matroska,
-                      uint32_t             *id,
-                      int                  *level_up)
-{
-    int read;
-    uint64_t total;
-
-    /* if we re-call this, use our cached ID */
-    if (matroska->peek_id != 0) {
-        if (level_up)
-            *level_up = 0;
-        *id = matroska->peek_id;
-        return 0;
-    }
-
-    /* read out the "EBML number", include tag in ID */
-    if ((read = ebml_read_num(matroska, 4, &total)) < 0)
-        return read;
-    *id = matroska->peek_id  = total | (1 << (read * 7));
-
-    /* level tracking */
-    if (level_up)
-        *level_up = ebml_read_element_level_up(matroska);
-
-    return read;
-}
-
-/*
- * Read: element content length.
- * Return: the number of bytes read or < 0 on error.
- */
-
-static int
-ebml_read_element_length (MatroskaDemuxContext *matroska,
-                          uint64_t             *length)
-{
-    /* clear cache since we're now beyond that data point */
-    matroska->peek_id = 0;
-
-    /* read out the "EBML number", include tag in ID */
-    return ebml_read_num(matroska, 8, length);
-}
-
-/*
- * Return: the ID of the next element, or 0 on error.
- * Level_up contains the amount of levels that this
- * next element lies higher than the previous one.
- */
-
-static uint32_t
-ebml_peek_id (MatroskaDemuxContext *matroska,
-              int                  *level_up)
-{
-    uint32_t id;
-
-    assert(level_up != NULL);
-
-    if (ebml_read_element_id(matroska, &id, level_up) < 0)
-        return 0;
-
-    return id;
-}
-
-/*
- * Seek to a given offset.
- * 0 is success, -1 is failure.
- */
-
-static int
-ebml_read_seek (MatroskaDemuxContext *matroska,
-                offset_t              offset)
-{
-    ByteIOContext *pb = &matroska->ctx->pb;
-
-    /* clear ID cache, if any */
-    matroska->peek_id = 0;
-
-    return (url_fseek(pb, offset, SEEK_SET) == offset) ? 0 : -1;
-}
-
-/*
- * Skip the next element.
- * 0 is success, -1 is failure.
- */
-
-static int
-ebml_read_skip (MatroskaDemuxContext *matroska)
-{
-    ByteIOContext *pb = &matroska->ctx->pb;
-    uint32_t id;
-    uint64_t length;
-    int res;
-
-    if ((res = ebml_read_element_id(matroska, &id, NULL)) < 0 ||
-        (res = ebml_read_element_length(matroska, &length)) < 0)
-        return res;
-
-    url_fskip(pb, length);
-
-    return 0;
-}
-
-/*
- * Read the next element as an unsigned int.
- * 0 is success, < 0 is failure.
- */
-
-static int
-ebml_read_uint (MatroskaDemuxContext *matroska,
-                uint32_t             *id,
-                uint64_t             *num)
-{
-    ByteIOContext *pb = &matroska->ctx->pb;
-    int n = 0, size, res;
-    uint64_t rlength;
-
-    if ((res = ebml_read_element_id(matroska, id, NULL)) < 0 ||
-        (res = ebml_read_element_length(matroska, &rlength)) < 0)
-        return res;
-    size = rlength;
-    if (size < 1 || size > 8) {
-        offset_t pos = url_ftell(pb);
-        av_log(matroska->ctx, AV_LOG_ERROR,
-               "Invalid uint element size %d at position %"PRId64" (0x%"PRIx64")\n",
-                size, pos, pos);
-        return AVERROR_INVALIDDATA;
-    }
-
-    /* big-endian ordening; build up number */
-    *num = 0;
-    while (n++ < size)
-        *num = (*num << 8) | get_byte(pb);
-
-    return 0;
-}
-
-/*
- * Read the next element as a signed int.
- * 0 is success, < 0 is failure.
- */
-
-static int
-ebml_read_sint (MatroskaDemuxContext *matroska,
-                uint32_t             *id,
-                int64_t              *num)
-{
-    ByteIOContext *pb = &matroska->ctx->pb;
-    int size, n = 1, negative = 0, res;
-    uint64_t rlength;
-
-    if ((res = ebml_read_element_id(matroska, id, NULL)) < 0 ||
-        (res = ebml_read_element_length(matroska, &rlength)) < 0)
-        return res;
-    size = rlength;
-    if (size < 1 || size > 8) {
-        offset_t pos = url_ftell(pb);
-        av_log(matroska->ctx, AV_LOG_ERROR,
-               "Invalid sint element size %d at position %"PRId64" (0x%"PRIx64")\n",
-                size, pos, pos);
-        return AVERROR_INVALIDDATA;
-    }
-    if ((*num = get_byte(pb)) & 0x80) {
-        negative = 1;
-        *num &= ~0x80;
-    }
-    *num = 0;
-    while (n++ < size)
-        *num = (*num << 8) | get_byte(pb);
-
-    /* make signed */
-    if (negative)
-        *num = *num - (1LL << ((8 * size) - 1));
-
-    return 0;
-}
-
-/*
- * Read the next element as a float.
- * 0 is success, < 0 is failure.
- */
-
-static int
-ebml_read_float (MatroskaDemuxContext *matroska,
-                 uint32_t             *id,
-                 double               *num)
-{
-    ByteIOContext *pb = &matroska->ctx->pb;
-    int size, res;
-    uint64_t rlength;
-
-    if ((res = ebml_read_element_id(matroska, id, NULL)) < 0 ||
-        (res = ebml_read_element_length(matroska, &rlength)) < 0)
-        return res;
-    size = rlength;
-
-    if (size == 4) {
-        *num= av_int2flt(get_be32(pb));
-    } else if(size==8){
-        *num= av_int2dbl(get_be64(pb));
-    } else{
-        offset_t pos = url_ftell(pb);
-        av_log(matroska->ctx, AV_LOG_ERROR,
-               "Invalid float element size %d at position %"PRIu64" (0x%"PRIx64")\n",
-               size, pos, pos);
-        return AVERROR_INVALIDDATA;
-    }
-
-    return 0;
-}
-
-/*
- * Read the next element as an ASCII string.
- * 0 is success, < 0 is failure.
- */
-
-static int
-ebml_read_ascii (MatroskaDemuxContext *matroska,
-                 uint32_t             *id,
-                 char                **str)
-{
-    ByteIOContext *pb = &matroska->ctx->pb;
-    int size, res;
-    uint64_t rlength;
-
-    if ((res = ebml_read_element_id(matroska, id, NULL)) < 0 ||
-        (res = ebml_read_element_length(matroska, &rlength)) < 0)
-        return res;
-    size = rlength;
-
-    /* ebml strings are usually not 0-terminated, so we allocate one
-     * byte more, read the string and NULL-terminate it ourselves. */
-    if (size < 0 || !(*str = av_malloc(size + 1))) {
-        av_log(matroska->ctx, AV_LOG_ERROR, "Memory allocation failed\n");
-        return AVERROR_NOMEM;
-    }
-    if (get_buffer(pb, (uint8_t *) *str, size) != size) {
-        offset_t pos = url_ftell(pb);
-        av_log(matroska->ctx, AV_LOG_ERROR,
-               "Read error at pos. %"PRIu64" (0x%"PRIx64")\n", pos, pos);
-        return AVERROR_IO;
-    }
-    (*str)[size] = '\0';
-
-    return 0;
-}
-
-/*
- * Read the next element as a UTF-8 string.
- * 0 is success, < 0 is failure.
- */
-
-static int
-ebml_read_utf8 (MatroskaDemuxContext *matroska,
-                uint32_t             *id,
-                char                **str)
-{
-  return ebml_read_ascii(matroska, id, str);
-}
-
-/*
- * Read the next element as a date (nanoseconds since 1/1/2000).
- * 0 is success, < 0 is failure.
- */
-
-static int
-ebml_read_date (MatroskaDemuxContext *matroska,
-                uint32_t             *id,
-                int64_t              *date)
-{
-  return ebml_read_sint(matroska, id, date);
-}
-
-/*
- * Read the next element, but only the header. The contents
- * are supposed to be sub-elements which can be read separately.
- * 0 is success, < 0 is failure.
- */
-
-static int
-ebml_read_master (MatroskaDemuxContext *matroska,
-                  uint32_t             *id)
-{
-    ByteIOContext *pb = &matroska->ctx->pb;
-    uint64_t length;
-    MatroskaLevel *level;
-    int res;
-
-    if ((res = ebml_read_element_id(matroska, id, NULL)) < 0 ||
-        (res = ebml_read_element_length(matroska, &length)) < 0)
-        return res;
-
-    /* protect... (Heaven forbids that the '>' is true) */
-    if (matroska->num_levels >= EBML_MAX_DEPTH) {
-        av_log(matroska->ctx, AV_LOG_ERROR,
-               "File moves beyond max. allowed depth (%d)\n", EBML_MAX_DEPTH);
-        return AVERROR_NOTSUPP;
-    }
-
-    /* remember level */
-    level = &matroska->levels[matroska->num_levels++];
-    level->start = url_ftell(pb);
-    level->length = length;
-
-    return 0;
-}
-
-/*
- * Read the next element as binary data.
- * 0 is success, < 0 is failure.
- */
-
-static int
-ebml_read_binary (MatroskaDemuxContext *matroska,
-                  uint32_t             *id,
-                  uint8_t             **binary,
-                  int                  *size)
-{
-    ByteIOContext *pb = &matroska->ctx->pb;
-    uint64_t rlength;
-    int res;
-
-    if ((res = ebml_read_element_id(matroska, id, NULL)) < 0 ||
-        (res = ebml_read_element_length(matroska, &rlength)) < 0)
-        return res;
-    *size = rlength;
-
-    if (!(*binary = av_malloc(*size))) {
-        av_log(matroska->ctx, AV_LOG_ERROR,
-               "Memory allocation error\n");
-        return AVERROR_NOMEM;
-    }
-
-    if (get_buffer(pb, *binary, *size) != *size) {
-        offset_t pos = url_ftell(pb);
-        av_log(matroska->ctx, AV_LOG_ERROR,
-               "Read error at pos. %"PRIu64" (0x%"PRIx64")\n", pos, pos);
-        return AVERROR_IO;
-    }
-
-    return 0;
-}
-
-/*
- * Read signed/unsigned "EBML" numbers.
- * Return: number of bytes processed, < 0 on error.
- * XXX: use ebml_read_num().
- */
-
-static int
-matroska_ebmlnum_uint (uint8_t  *data,
-                       uint32_t  size,
-                       uint64_t *num)
-{
-    int len_mask = 0x80, read = 1, n = 1, num_ffs = 0;
-    uint64_t total;
-
-    if (size <= 0)
-        return AVERROR_INVALIDDATA;
-
-    total = data[0];
-    while (read <= 8 && !(total & len_mask)) {
-        read++;
-        len_mask >>= 1;
-    }
-    if (read > 8)
-        return AVERROR_INVALIDDATA;
-
-    if ((total &= (len_mask - 1)) == len_mask - 1)
-        num_ffs++;
-    if (size < read)
-        return AVERROR_INVALIDDATA;
-    while (n < read) {
-        if (data[n] == 0xff)
-            num_ffs++;
-        total = (total << 8) | data[n];
-        n++;
-    }
-
-    if (read == num_ffs)
-        *num = (uint64_t)-1;
-    else
-        *num = total;
-
-    return read;
-}
-
-/*
- * Same as above, but signed.
- */
-
-static int
-matroska_ebmlnum_sint (uint8_t  *data,
-                       uint32_t  size,
-                       int64_t  *num)
-{
-    uint64_t unum;
-    int res;
-
-    /* read as unsigned number first */
-    if ((res = matroska_ebmlnum_uint(data, size, &unum)) < 0)
-        return res;
-
-    /* make signed (weird way) */
-    if (unum == (uint64_t)-1)
-        *num = INT64_MAX;
-    else
-        *num = unum - ((1LL << ((7 * res) - 1)) - 1);
-
-    return res;
-}
-
-/*
- * Read an EBML header.
- * 0 is success, < 0 is failure.
- */
-
-static int
-ebml_read_header (MatroskaDemuxContext *matroska,
-                  char                **doctype,
-                  int                  *version)
-{
-    uint32_t id;
-    int level_up, res = 0;
-
-    /* default init */
-    if (doctype)
-        *doctype = NULL;
-    if (version)
-        *version = 1;
-
-    if (!(id = ebml_peek_id(matroska, &level_up)) ||
-        level_up != 0 || id != EBML_ID_HEADER) {
-        av_log(matroska->ctx, AV_LOG_ERROR,
-               "This is not an EBML file (id=0x%x/0x%x)\n", id, EBML_ID_HEADER);
-        return AVERROR_INVALIDDATA;
-    }
-    if ((res = ebml_read_master(matroska, &id)) < 0)
-        return res;
-
-    while (res == 0) {
-        if (!(id = ebml_peek_id(matroska, &level_up)))
-            return AVERROR_IO;
-
-        /* end-of-header */
-        if (level_up)
-            break;
-
-        switch (id) {
-            /* is our read version uptodate? */
-            case EBML_ID_EBMLREADVERSION: {
-                uint64_t num;
-
-                if ((res = ebml_read_uint(matroska, &id, &num)) < 0)
-                    return res;
-                if (num > EBML_VERSION) {
-                    av_log(matroska->ctx, AV_LOG_ERROR,
-                           "EBML version %"PRIu64" (> %d) is not supported\n",
-                           num, EBML_VERSION);
-                    return AVERROR_INVALIDDATA;
-                }
-                break;
-            }
-
-            /* we only handle 8 byte lengths at max */
-            case EBML_ID_EBMLMAXSIZELENGTH: {
-                uint64_t num;
-
-                if ((res = ebml_read_uint(matroska, &id, &num)) < 0)
-                    return res;
-                if (num > sizeof(uint64_t)) {
-                    av_log(matroska->ctx, AV_LOG_ERROR,
-                           "Integers of size %"PRIu64" (> %zd) not supported\n",
-                           num, sizeof(uint64_t));
-                    return AVERROR_INVALIDDATA;
-                }
-                break;
-            }
-
-            /* we handle 4 byte IDs at max */
-            case EBML_ID_EBMLMAXIDLENGTH: {
-                uint64_t num;
-
-                if ((res = ebml_read_uint(matroska, &id, &num)) < 0)
-                    return res;
-                if (num > sizeof(uint32_t)) {
-                    av_log(matroska->ctx, AV_LOG_ERROR,
-                           "IDs of size %"PRIu64" (> %zu) not supported\n",
-                            num, sizeof(uint32_t));
-                    return AVERROR_INVALIDDATA;
-                }
-                break;
-            }
-
-            case EBML_ID_DOCTYPE: {
-                char *text;
-
-                if ((res = ebml_read_ascii(matroska, &id, &text)) < 0)
-                    return res;
-                if (doctype) {
-                    if (*doctype)
-                        av_free(*doctype);
-                    *doctype = text;
-                } else
-                    av_free(text);
-                break;
-            }
-
-            case EBML_ID_DOCTYPEREADVERSION: {
-                uint64_t num;
-
-                if ((res = ebml_read_uint(matroska, &id, &num)) < 0)
-                    return res;
-                if (version)
-                    *version = num;
-                break;
-            }
-
-            default:
-                av_log(matroska->ctx, AV_LOG_INFO,
-                       "Unknown data type 0x%x in EBML header", id);
-                /* pass-through */
-
-            case EBML_ID_VOID:
-            /* we ignore these two, as they don't tell us anything we
-             * care about */
-            case EBML_ID_EBMLVERSION:
-            case EBML_ID_DOCTYPEVERSION:
-                res = ebml_read_skip (matroska);
-                break;
-        }
-    }
-
-    return 0;
-}
-
-/*
- * Put one packet in an application-supplied AVPacket struct.
- * Returns 0 on success or -1 on failure.
- */
-
-static int
-matroska_deliver_packet (MatroskaDemuxContext *matroska,
-                         AVPacket             *pkt)
-{
-    if (matroska->num_packets > 0) {
-        memcpy(pkt, matroska->packets[0], sizeof(AVPacket));
-        av_free(matroska->packets[0]);
-        if (matroska->num_packets > 1) {
-            memmove(&matroska->packets[0], &matroska->packets[1],
-                    (matroska->num_packets - 1) * sizeof(AVPacket *));
-            matroska->packets =
-                av_realloc(matroska->packets, (matroska->num_packets - 1) *
-                           sizeof(AVPacket *));
-        } else {
-            av_freep(&matroska->packets);
-        }
-        matroska->num_packets--;
-        return 0;
-    }
-
-    return -1;
-}
-
-/*
- * Put a packet into our internal queue. Will be delivered to the
- * user/application during the next get_packet() call.
- */
-
-static void
-matroska_queue_packet (MatroskaDemuxContext *matroska,
-                       AVPacket             *pkt)
-{
-    matroska->packets =
-        av_realloc(matroska->packets, (matroska->num_packets + 1) *
-                   sizeof(AVPacket *));
-    matroska->packets[matroska->num_packets] = pkt;
-    matroska->num_packets++;
-}
-
-/*
- * Autodetecting...
- */
-
-static int
-matroska_probe (AVProbeData *p)
-{
-    uint64_t total = 0;
-    int len_mask = 0x80, size = 1, n = 1;
-    uint8_t probe_data[] = { 'm', 'a', 't', 'r', 'o', 's', 'k', 'a' };
-
-    if (p->buf_size < 5)
-        return 0;
-
-    /* ebml header? */
-    if ((p->buf[0] << 24 | p->buf[1] << 16 |
-         p->buf[2] << 8 | p->buf[3]) != EBML_ID_HEADER)
-        return 0;
-
-    /* length of header */
-    total = p->buf[4];
-    while (size <= 8 && !(total & len_mask)) {
-        size++;
-        len_mask >>= 1;
-    }
-    if (size > 8)
-      return 0;
-    total &= (len_mask - 1);
-    while (n < size)
-        total = (total << 8) | p->buf[4 + n++];
-
-    /* does the probe data contain the whole header? */
-    if (p->buf_size < 4 + size + total)
-      return 0;
-
-    /* the header must contain the document type 'matroska'. For now,
-     * we don't parse the whole header but simply check for the
-     * availability of that array of characters inside the header.
-     * Not fully fool-proof, but good enough. */
-    for (n = 4 + size; n < 4 + size + total - sizeof(probe_data); n++)
-        if (!memcmp (&p->buf[n], probe_data, sizeof(probe_data)))
-            return AVPROBE_SCORE_MAX;
-
-    return 0;
-}
-
-/*
- * From here on, it's all XML-style DTD stuff... Needs no comments.
- */
-
-static int
-matroska_parse_info (MatroskaDemuxContext *matroska)
-{
-    int res = 0;
-    uint32_t id;
-
-    av_log(matroska->ctx, AV_LOG_DEBUG, "Parsing info...\n");
-
-    while (res == 0) {
-        if (!(id = ebml_peek_id(matroska, &matroska->level_up))) {
-            res = AVERROR_IO;
-            break;
-        } else if (matroska->level_up) {
-            matroska->level_up--;
-            break;
-        }
-
-        switch (id) {
-            /* cluster timecode */
-            case MATROSKA_ID_TIMECODESCALE: {
-                uint64_t num;
-                if ((res = ebml_read_uint(matroska, &id, &num)) < 0)
-                    break;
-                matroska->time_scale = num;
-                break;
-            }
-
-            case MATROSKA_ID_DURATION: {
-                double num;
-                if ((res = ebml_read_float(matroska, &id, &num)) < 0)
-                    break;
-                matroska->ctx->duration = num * matroska->time_scale * 1000 / AV_TIME_BASE;
-                break;
-            }
-
-            case MATROSKA_ID_TITLE: {
-                char *text;
-                if ((res = ebml_read_utf8(matroska, &id, &text)) < 0)
-                    break;
-                strncpy(matroska->ctx->title, text,
-                        sizeof(matroska->ctx->title)-1);
-                av_free(text);
-                break;
-            }
-
-            case MATROSKA_ID_WRITINGAPP: {
-                char *text;
-                if ((res = ebml_read_utf8(matroska, &id, &text)) < 0)
-                    break;
-                matroska->writing_app = text;
-                break;
-            }
-
-            case MATROSKA_ID_MUXINGAPP: {
-                char *text;
-                if ((res = ebml_read_utf8(matroska, &id, &text)) < 0)
-                    break;
-                matroska->muxing_app = text;
-                break;
-            }
-
-            case MATROSKA_ID_DATEUTC: {
-                int64_t time;
-                if ((res = ebml_read_date(matroska, &id, &time)) < 0)
-                    break;
-                matroska->created = time;
-                break;
-            }
-
-            default:
-                av_log(matroska->ctx, AV_LOG_INFO,
-                       "Unknown entry 0x%x in info header\n", id);
-                /* fall-through */
-
-            case EBML_ID_VOID:
-                res = ebml_read_skip(matroska);
-                break;
-        }
-
-        if (matroska->level_up) {
-            matroska->level_up--;
-            break;
-        }
-    }
-
-    return res;
-}
-
-static int
-matroska_add_stream (MatroskaDemuxContext *matroska)
-{
-    int res = 0;
-    uint32_t id;
-    MatroskaTrack *track;
-
-    av_log(matroska->ctx, AV_LOG_DEBUG, "parsing track, adding stream..,\n");
-
-    /* Allocate a generic track. As soon as we know its type we'll realloc. */
-    track = av_mallocz(sizeof(MatroskaTrack));
-    matroska->num_tracks++;
-
-    /* start with the master */
-    if ((res = ebml_read_master(matroska, &id)) < 0)
-        return res;
-
-    /* try reading the trackentry headers */
-    while (res == 0) {
-        if (!(id = ebml_peek_id(matroska, &matroska->level_up))) {
-            res = AVERROR_IO;
-            break;
-        } else if (matroska->level_up > 0) {
-            matroska->level_up--;
-            break;
-        }
-
-        switch (id) {
-            /* track number (unique stream ID) */
-            case MATROSKA_ID_TRACKNUMBER: {
-                uint64_t num;
-                if ((res = ebml_read_uint(matroska, &id, &num)) < 0)
-                    break;
-                track->num = num;
-                break;
-            }
-
-            /* track UID (unique identifier) */
-            case MATROSKA_ID_TRACKUID: {
-                uint64_t num;
-                if ((res = ebml_read_uint(matroska, &id, &num)) < 0)
-                    break;
-                track->uid = num;
-                break;
-            }
-
-            /* track type (video, audio, combined, subtitle, etc.) */
-            case MATROSKA_ID_TRACKTYPE: {
-                uint64_t num;
-                if (track->type != 0) {
-                    av_log(matroska->ctx, AV_LOG_INFO,
-                           "More than one tracktype in an entry - skip\n");
-                    break;
-                }
-                if ((res = ebml_read_uint(matroska, &id, &num)) < 0)
-                    break;
-                track->type = num;
-
-                /* ok, so we're actually going to reallocate this thing */
-                switch (track->type) {
-                    case MATROSKA_TRACK_TYPE_VIDEO:
-                        track = (MatroskaTrack *)
-                            av_realloc(track, sizeof(MatroskaVideoTrack));
-                        break;
-                    case MATROSKA_TRACK_TYPE_AUDIO:
-                        track = (MatroskaTrack *)
-                            av_realloc(track, sizeof(MatroskaAudioTrack));
-                        ((MatroskaAudioTrack *)track)->channels = 1;
-                        ((MatroskaAudioTrack *)track)->samplerate = 8000;
-                        break;
-                    case MATROSKA_TRACK_TYPE_SUBTITLE:
-                        track = (MatroskaTrack *)
-                            av_realloc(track, sizeof(MatroskaSubtitleTrack));
-                        break;
-                    case MATROSKA_TRACK_TYPE_COMPLEX:
-                    case MATROSKA_TRACK_TYPE_LOGO:
-                    case MATROSKA_TRACK_TYPE_CONTROL:
-                    default:
-                        av_log(matroska->ctx, AV_LOG_INFO,
-                               "Unknown or unsupported track type 0x%x\n",
-                               track->type);
-                        track->type = 0;
-                        break;
-                }
-                matroska->tracks[matroska->num_tracks - 1] = track;
-                break;
-            }
-
-            /* tracktype specific stuff for video */
-            case MATROSKA_ID_TRACKVIDEO: {
-                MatroskaVideoTrack *videotrack;
-                if (track->type != MATROSKA_TRACK_TYPE_VIDEO) {
-                    av_log(matroska->ctx, AV_LOG_INFO,
-                           "video data in non-video track - ignoring\n");
-                    res = AVERROR_INVALIDDATA;
-                    break;
-                } else if ((res = ebml_read_master(matroska, &id)) < 0)
-                    break;
-                videotrack = (MatroskaVideoTrack *)track;
-
-                while (res == 0) {
-                    if (!(id = ebml_peek_id(matroska, &matroska->level_up))) {
-                        res = AVERROR_IO;
-                        break;
-                    } else if (matroska->level_up > 0) {
-                        matroska->level_up--;
-                        break;
-                    }
-
-                    switch (id) {
-                        /* fixme, this should be one-up, but I get it here */
-                        case MATROSKA_ID_TRACKDEFAULTDURATION: {
-                            uint64_t num;
-                            if ((res = ebml_read_uint (matroska, &id,
-                                                       &num)) < 0)
-                                break;
-                            track->default_duration = num;
-                            break;
-                        }
-
-                        /* video framerate */
-                        case MATROSKA_ID_VIDEOFRAMERATE: {
-                            double num;
-                            if ((res = ebml_read_float(matroska, &id,
-                                                       &num)) < 0)
-                                break;
-                            track->default_duration = 1000000000 * (1. / num);
-                            break;
-                        }
-
-                        /* width of the size to display the video at */
-                        case MATROSKA_ID_VIDEODISPLAYWIDTH: {
-                            uint64_t num;
-                            if ((res = ebml_read_uint(matroska, &id,
-                                                      &num)) < 0)
-                                break;
-                            videotrack->display_width = num;
-                            break;
-                        }
-
-                        /* height of the size to display the video at */
-                        case MATROSKA_ID_VIDEODISPLAYHEIGHT: {
-                            uint64_t num;
-                            if ((res = ebml_read_uint(matroska, &id,
-                                                      &num)) < 0)
-                                break;
-                            videotrack->display_height = num;
-                            break;
-                        }
-
-                        /* width of the video in the file */
-                        case MATROSKA_ID_VIDEOPIXELWIDTH: {
-                            uint64_t num;
-                            if ((res = ebml_read_uint(matroska, &id,
-                                                      &num)) < 0)
-                                break;
-                            videotrack->pixel_width = num;
-                            break;
-                        }
-
-                        /* height of the video in the file */
-                        case MATROSKA_ID_VIDEOPIXELHEIGHT: {
-                            uint64_t num;
-                            if ((res = ebml_read_uint(matroska, &id,
-                                                      &num)) < 0)
-                                break;
-                            videotrack->pixel_height = num;
-                            break;
-                        }
-
-                        /* whether the video is interlaced */
-                        case MATROSKA_ID_VIDEOFLAGINTERLACED: {
-                            uint64_t num;
-                            if ((res = ebml_read_uint(matroska, &id,
-                                                      &num)) < 0)
-                                break;
-                            if (num)
-                                track->flags |=
-                                    MATROSKA_VIDEOTRACK_INTERLACED;
-                            else
-                                track->flags &=
-                                    ~MATROSKA_VIDEOTRACK_INTERLACED;
-                            break;
-                        }
-
-                        /* stereo mode (whether the video has two streams,
-                         * where one is for the left eye and the other for
-                         * the right eye, which creates a 3D-like
-                         * effect) */
-                        case MATROSKA_ID_VIDEOSTEREOMODE: {
-                            uint64_t num;
-                            if ((res = ebml_read_uint(matroska, &id,
-                                                      &num)) < 0)
-                                break;
-                            if (num != MATROSKA_EYE_MODE_MONO &&
-                                num != MATROSKA_EYE_MODE_LEFT &&
-                                num != MATROSKA_EYE_MODE_RIGHT &&
-                                num != MATROSKA_EYE_MODE_BOTH) {
-                                av_log(matroska->ctx, AV_LOG_INFO,
-                                       "Ignoring unknown eye mode 0x%x\n",
-                                       (uint32_t) num);
-                                break;
-                            }
-                            videotrack->eye_mode = num;
-                            break;
-                        }
-
-                        /* aspect ratio behaviour */
-                        case MATROSKA_ID_VIDEOASPECTRATIO: {
-                            uint64_t num;
-                            if ((res = ebml_read_uint(matroska, &id,
-                                                      &num)) < 0)
-                                break;
-                            if (num != MATROSKA_ASPECT_RATIO_MODE_FREE &&
-                                num != MATROSKA_ASPECT_RATIO_MODE_KEEP &&
-                                num != MATROSKA_ASPECT_RATIO_MODE_FIXED) {
-                                av_log(matroska->ctx, AV_LOG_INFO,
-                                       "Ignoring unknown aspect ratio 0x%x\n",
-                                       (uint32_t) num);
-                                break;
-                            }
-                            videotrack->ar_mode = num;
-                            break;
-                        }
-
-                        /* colourspace (only matters for raw video)
-                         * fourcc */
-                        case MATROSKA_ID_VIDEOCOLOURSPACE: {
-                            uint64_t num;
-                            if ((res = ebml_read_uint(matroska, &id,
-                                                      &num)) < 0)
-                                break;
-                            videotrack->fourcc = num;
-                            break;
-                        }
-
-                        default:
-                            av_log(matroska->ctx, AV_LOG_INFO,
-                                   "Unknown video track header entry "
-                                   "0x%x - ignoring\n", id);
-                            /* pass-through */
-
-                        case EBML_ID_VOID:
-                            res = ebml_read_skip(matroska);
-                            break;
-                    }
-
-                    if (matroska->level_up) {
-                        matroska->level_up--;
-                        break;
-                    }
-                }
-                break;
-            }
-
-            /* tracktype specific stuff for audio */
-            case MATROSKA_ID_TRACKAUDIO: {
-                MatroskaAudioTrack *audiotrack;
-                if (track->type != MATROSKA_TRACK_TYPE_AUDIO) {
-                    av_log(matroska->ctx, AV_LOG_INFO,
-                           "audio data in non-audio track - ignoring\n");
-                    res = AVERROR_INVALIDDATA;
-                    break;
-                } else if ((res = ebml_read_master(matroska, &id)) < 0)
-                    break;
-                audiotrack = (MatroskaAudioTrack *)track;
-
-                while (res == 0) {
-                    if (!(id = ebml_peek_id(matroska, &matroska->level_up))) {
-                        res = AVERROR_IO;
-                        break;
-                    } else if (matroska->level_up > 0) {
-                        matroska->level_up--;
-                        break;
-                    }
-
-                    switch (id) {
-                        /* samplerate */
-                        case MATROSKA_ID_AUDIOSAMPLINGFREQ: {
-                            double num;
-                            if ((res = ebml_read_float(matroska, &id,
-                                                       &num)) < 0)
-                                break;
-                            audiotrack->internal_samplerate =
-                            audiotrack->samplerate = num;
-                            break;
-                        }
-
-                        case MATROSKA_ID_AUDIOOUTSAMPLINGFREQ: {
-                            double num;
-                            if ((res = ebml_read_float(matroska, &id,
-                                                       &num)) < 0)
-                                break;
-                            audiotrack->samplerate = num;
-                            break;
-                        }
-
-                            /* bitdepth */
-                        case MATROSKA_ID_AUDIOBITDEPTH: {
-                            uint64_t num;
-                            if ((res = ebml_read_uint(matroska, &id,
-                                                      &num)) < 0)
-                                break;
-                            audiotrack->bitdepth = num;
-                            break;
-                        }
-
-                            /* channels */
-                        case MATROSKA_ID_AUDIOCHANNELS: {
-                            uint64_t num;
-                            if ((res = ebml_read_uint(matroska, &id,
-                                                      &num)) < 0)
-                                break;
-                            audiotrack->channels = num;
-                            break;
-                        }
-
-                        default:
-                            av_log(matroska->ctx, AV_LOG_INFO,
-                                   "Unknown audio track header entry "
-                                   "0x%x - ignoring\n", id);
-                            /* pass-through */
-
-                        case EBML_ID_VOID:
-                            res = ebml_read_skip(matroska);
-                            break;
-                    }
-
-                    if (matroska->level_up) {
-                        matroska->level_up--;
-                        break;
-                    }
-                }
-                break;
-            }
-
-                /* codec identifier */
-            case MATROSKA_ID_CODECID: {
-                char *text;
-                if ((res = ebml_read_ascii(matroska, &id, &text)) < 0)
-                    break;
-                track->codec_id = text;
-                break;
-            }
-
-                /* codec private data */
-            case MATROSKA_ID_CODECPRIVATE: {
-                uint8_t *data;
-                int size;
-                if ((res = ebml_read_binary(matroska, &id, &data, &size) < 0))
-                    break;
-                track->codec_priv = data;
-                track->codec_priv_size = size;
-                break;
-            }
-
-                /* name of the codec */
-            case MATROSKA_ID_CODECNAME: {
-                char *text;
-                if ((res = ebml_read_utf8(matroska, &id, &text)) < 0)
-                    break;
-                track->codec_name = text;
-                break;
-            }
-
-                /* name of this track */
-            case MATROSKA_ID_TRACKNAME: {
-                char *text;
-                if ((res = ebml_read_utf8(matroska, &id, &text)) < 0)
-                    break;
-                track->name = text;
-                break;
-            }
-
-                /* language (matters for audio/subtitles, mostly) */
-            case MATROSKA_ID_TRACKLANGUAGE: {
-                char *text;
-                if ((res = ebml_read_utf8(matroska, &id, &text)) < 0)
-                    break;
-                track->language = text;
-                break;
-            }
-
-                /* whether this is actually used */
-            case MATROSKA_ID_TRACKFLAGENABLED: {
-                uint64_t num;
-                if ((res = ebml_read_uint(matroska, &id, &num)) < 0)
-                    break;
-                if (num)
-                    track->flags |= MATROSKA_TRACK_ENABLED;
-                else
-                    track->flags &= ~MATROSKA_TRACK_ENABLED;
-                break;
-            }
-
-                /* whether it's the default for this track type */
-            case MATROSKA_ID_TRACKFLAGDEFAULT: {
-                uint64_t num;
-                if ((res = ebml_read_uint(matroska, &id, &num)) < 0)
-                    break;
-                if (num)
-                    track->flags |= MATROSKA_TRACK_DEFAULT;
-                else
-                    track->flags &= ~MATROSKA_TRACK_DEFAULT;
-                break;
-            }
-
-                /* lacing (like MPEG, where blocks don't end/start on frame
-                 * boundaries) */
-            case MATROSKA_ID_TRACKFLAGLACING: {
-                uint64_t num;
-                if ((res = ebml_read_uint(matroska, &id, &num)) < 0)
-                    break;
-                if (num)
-                    track->flags |= MATROSKA_TRACK_LACING;
-                else
-                    track->flags &= ~MATROSKA_TRACK_LACING;
-                break;
-            }
-
-                /* default length (in time) of one data block in this track */
-            case MATROSKA_ID_TRACKDEFAULTDURATION: {
-                uint64_t num;
-                if ((res = ebml_read_uint(matroska, &id, &num)) < 0)
-                    break;
-                track->default_duration = num;
-                break;
-            }
-
-            default:
-                av_log(matroska->ctx, AV_LOG_INFO,
-                       "Unknown track header entry 0x%x - ignoring\n", id);
-                /* pass-through */
-
-            case EBML_ID_VOID:
-            /* we ignore these because they're nothing useful. */
-            case MATROSKA_ID_CODECINFOURL:
-            case MATROSKA_ID_CODECDOWNLOADURL:
-            case MATROSKA_ID_TRACKMINCACHE:
-            case MATROSKA_ID_TRACKMAXCACHE:
-                res = ebml_read_skip(matroska);
-                break;
-        }
-
-        if (matroska->level_up) {
-            matroska->level_up--;
-            break;
-        }
-    }
-
-    return res;
-}
-
-static int
-matroska_parse_tracks (MatroskaDemuxContext *matroska)
-{
-    int res = 0;
-    uint32_t id;
-
-    av_log(matroska->ctx, AV_LOG_DEBUG, "parsing tracks...\n");
-
-    while (res == 0) {
-        if (!(id = ebml_peek_id(matroska, &matroska->level_up))) {
-            res = AVERROR_IO;
-            break;
-        } else if (matroska->level_up) {
-            matroska->level_up--;
-            break;
-        }
-
-        switch (id) {
-            /* one track within the "all-tracks" header */
-            case MATROSKA_ID_TRACKENTRY:
-                res = matroska_add_stream(matroska);
-                break;
-
-            default:
-                av_log(matroska->ctx, AV_LOG_INFO,
-                       "Unknown entry 0x%x in track header\n", id);
-                /* fall-through */
-
-            case EBML_ID_VOID:
-                res = ebml_read_skip(matroska);
-                break;
-        }
-
-        if (matroska->level_up) {
-            matroska->level_up--;
-            break;
-        }
-    }
-
-    return res;
-}
-
-static int
-matroska_parse_index (MatroskaDemuxContext *matroska)
-{
-    int res = 0;
-    uint32_t id;
-    MatroskaDemuxIndex idx;
-
-    av_log(matroska->ctx, AV_LOG_DEBUG, "parsing index...\n");
-
-    while (res == 0) {
-        if (!(id = ebml_peek_id(matroska, &matroska->level_up))) {
-            res = AVERROR_IO;
-            break;
-        } else if (matroska->level_up) {
-            matroska->level_up--;
-            break;
-        }
-
-        switch (id) {
-            /* one single index entry ('point') */
-            case MATROSKA_ID_POINTENTRY:
-                if ((res = ebml_read_master(matroska, &id)) < 0)
-                    break;
-
-                /* in the end, we hope to fill one entry with a
-                 * timestamp, a file position and a tracknum */
-                idx.pos   = (uint64_t) -1;
-                idx.time  = (uint64_t) -1;
-                idx.track = (uint16_t) -1;
-
-                while (res == 0) {
-                    if (!(id = ebml_peek_id(matroska, &matroska->level_up))) {
-                        res = AVERROR_IO;
-                        break;
-                    } else if (matroska->level_up) {
-                        matroska->level_up--;
-                        break;
-                    }
-
-                    switch (id) {
-                        /* one single index entry ('point') */
-                        case MATROSKA_ID_CUETIME: {
-                            uint64_t time;
-                            if ((res = ebml_read_uint(matroska, &id,
-                                                      &time)) < 0)
-                                break;
-                            idx.time = time * matroska->time_scale;
-                            break;
-                        }
-
-                        /* position in the file + track to which it
-                         * belongs */
-                        case MATROSKA_ID_CUETRACKPOSITION:
-                            if ((res = ebml_read_master(matroska, &id)) < 0)
-                                break;
-
-                            while (res == 0) {
-                                if (!(id = ebml_peek_id (matroska,
-                                                    &matroska->level_up))) {
-                                    res = AVERROR_IO;
-                                    break;
-                                } else if (matroska->level_up) {
-                                    matroska->level_up--;
-                                    break;
-                                }
-
-                                switch (id) {
-                                    /* track number */
-                                    case MATROSKA_ID_CUETRACK: {
-                                        uint64_t num;
-                                        if ((res = ebml_read_uint(matroska,
-                                                          &id, &num)) < 0)
-                                            break;
-                                        idx.track = num;
-                                        break;
-                                    }
-
-                                        /* position in file */
-                                    case MATROSKA_ID_CUECLUSTERPOSITION: {
-                                        uint64_t num;
-                                        if ((res = ebml_read_uint(matroska,
-                                                          &id, &num)) < 0)
-                                            break;
-                                        idx.pos = num;
-                                        break;
-                                    }
-
-                                    default:
-                                        av_log(matroska->ctx, AV_LOG_INFO,
-                                               "Unknown entry 0x%x in "
-                                               "CuesTrackPositions\n", id);
-                                        /* fall-through */
-
-                                    case EBML_ID_VOID:
-                                        res = ebml_read_skip(matroska);
-                                        break;
-                                }
-
-                                if (matroska->level_up) {
-                                    matroska->level_up--;
-                                    break;
-                                }
-                            }
-
-                            break;
-
-                        default:
-                            av_log(matroska->ctx, AV_LOG_INFO,
-                                   "Unknown entry 0x%x in cuespoint "
-                                   "index\n", id);
-                            /* fall-through */
-
-                        case EBML_ID_VOID:
-                            res = ebml_read_skip(matroska);
-                            break;
-                    }
-
-                    if (matroska->level_up) {
-                        matroska->level_up--;
-                        break;
-                    }
-                }
-
-                /* so let's see if we got what we wanted */
-                if (idx.pos   != (uint64_t) -1 &&
-                    idx.time  != (uint64_t) -1 &&
-                    idx.track != (uint16_t) -1) {
-                    if (matroska->num_indexes % 32 == 0) {
-                        /* re-allocate bigger index */
-                        matroska->index =
-                            av_realloc(matroska->index,
-                                       (matroska->num_indexes + 32) *
-                                       sizeof(MatroskaDemuxIndex));
-                    }
-                    matroska->index[matroska->num_indexes] = idx;
-                    matroska->num_indexes++;
-                }
-                break;
-
-            default:
-                av_log(matroska->ctx, AV_LOG_INFO,
-                       "Unknown entry 0x%x in cues header\n", id);
-                /* fall-through */
-
-            case EBML_ID_VOID:
-                res = ebml_read_skip(matroska);
-                break;
-        }
-
-        if (matroska->level_up) {
-            matroska->level_up--;
-            break;
-        }
-    }
-
-    return res;
-}
-
-static int
-matroska_parse_metadata (MatroskaDemuxContext *matroska)
-{
-    int res = 0;
-    uint32_t id;
-
-    while (res == 0) {
-        if (!(id = ebml_peek_id(matroska, &matroska->level_up))) {
-            res = AVERROR_IO;
-            break;
-        } else if (matroska->level_up) {
-            matroska->level_up--;
-            break;
-        }
-
-        switch (id) {
-            /* Hm, this is unsupported... */
-            default:
-                av_log(matroska->ctx, AV_LOG_INFO,
-                       "Unknown entry 0x%x in metadata header\n", id);
-                /* fall-through */
-
-            case EBML_ID_VOID:
-                res = ebml_read_skip(matroska);
-                break;
-        }
-
-        if (matroska->level_up) {
-            matroska->level_up--;
-            break;
-        }
-    }
-
-    return res;
-}
-
-static int
-matroska_parse_seekhead (MatroskaDemuxContext *matroska)
-{
-    int res = 0;
-    uint32_t id;
-
-    av_log(matroska->ctx, AV_LOG_DEBUG, "parsing seekhead...\n");
-
-    while (res == 0) {
-        if (!(id = ebml_peek_id(matroska, &matroska->level_up))) {
-            res = AVERROR_IO;
-            break;
-        } else if (matroska->level_up) {
-            matroska->level_up--;
-            break;
-        }
-
-        switch (id) {
-            case MATROSKA_ID_SEEKENTRY: {
-                uint32_t seek_id = 0, peek_id_cache = 0;
-                uint64_t seek_pos = (uint64_t) -1, t;
-
-                if ((res = ebml_read_master(matroska, &id)) < 0)
-                    break;
-
-                while (res == 0) {
-                    if (!(id = ebml_peek_id(matroska, &matroska->level_up))) {
-                        res = AVERROR_IO;
-                        break;
-                    } else if (matroska->level_up) {
-                        matroska->level_up--;
-                        break;
-                    }
-
-                    switch (id) {
-                        case MATROSKA_ID_SEEKID:
-                            res = ebml_read_uint(matroska, &id, &t);
-                            seek_id = t;
-                            break;
-
-                        case MATROSKA_ID_SEEKPOSITION:
-                            res = ebml_read_uint(matroska, &id, &seek_pos);
-                            break;
-
-                        default:
-                            av_log(matroska->ctx, AV_LOG_INFO,
-                                   "Unknown seekhead ID 0x%x\n", id);
-                            /* fall-through */
-
-                        case EBML_ID_VOID:
-                            res = ebml_read_skip(matroska);
-                            break;
-                    }
-
-                    if (matroska->level_up) {
-                        matroska->level_up--;
-                        break;
-                    }
-                }
-
-                if (!seek_id || seek_pos == (uint64_t) -1) {
-                    av_log(matroska->ctx, AV_LOG_INFO,
-                           "Incomplete seekhead entry (0x%x/%"PRIu64")\n",
-                           seek_id, seek_pos);
-                    break;
-                }
-
-                switch (seek_id) {
-                    case MATROSKA_ID_CUES:
-                    case MATROSKA_ID_TAGS: {
-                        uint32_t level_up = matroska->level_up;
-                        offset_t before_pos;
-                        uint64_t length;
-                        MatroskaLevel level;
-
-                        /* remember the peeked ID and the current position */
-                        peek_id_cache = matroska->peek_id;
-                        before_pos = url_ftell(&matroska->ctx->pb);
-
-                        /* seek */
-                        if ((res = ebml_read_seek(matroska, seek_pos +
-                                               matroska->segment_start)) < 0)
-                            return res;
-
-                        /* we don't want to lose our seekhead level, so we add
-                         * a dummy. This is a crude hack. */
-                        if (matroska->num_levels == EBML_MAX_DEPTH) {
-                            av_log(matroska->ctx, AV_LOG_INFO,
-                                   "Max EBML element depth (%d) reached, "
-                                   "cannot parse further.\n", EBML_MAX_DEPTH);
-                            return AVERROR_UNKNOWN;
-                        }
-
-                        level.start = 0;
-                        level.length = (uint64_t)-1;
-                        matroska->levels[matroska->num_levels] = level;
-                        matroska->num_levels++;
-
-                        /* check ID */
-                        if (!(id = ebml_peek_id (matroska,
-                                                 &matroska->level_up)))
-                            goto finish;
-                        if (id != seek_id) {
-                            av_log(matroska->ctx, AV_LOG_INFO,
-                                   "We looked for ID=0x%x but got "
-                                   "ID=0x%x (pos=%"PRIu64")",
-                                   seek_id, id, seek_pos +
-                                   matroska->segment_start);
-                            goto finish;
-                        }
-
-                        /* read master + parse */
-                        if ((res = ebml_read_master(matroska, &id)) < 0)
-                            goto finish;
-                        switch (id) {
-                            case MATROSKA_ID_CUES:
-                                if (!(res = matroska_parse_index(matroska)) ||
-                                    url_feof(&matroska->ctx->pb)) {
-                                    matroska->index_parsed = 1;
-                                    res = 0;
-                                }
-                                break;
-                            case MATROSKA_ID_TAGS:
-                                if (!(res = matroska_parse_metadata(matroska)) ||
-                                   url_feof(&matroska->ctx->pb)) {
-                                    matroska->metadata_parsed = 1;
-                                    res = 0;
-                                }
-                                break;
-                        }
-
-                    finish:
-                        /* remove dummy level */
-                        while (matroska->num_levels) {
-                            matroska->num_levels--;
-                            length =
-                                matroska->levels[matroska->num_levels].length;
-                            if (length == (uint64_t)-1)
-                                break;
-                        }
-
-                        /* seek back */
-                        if ((res = ebml_read_seek(matroska, before_pos)) < 0)
-                            return res;
-                        matroska->peek_id = peek_id_cache;
-                        matroska->level_up = level_up;
-                        break;
-                    }
-
-                    default:
-                        av_log(matroska->ctx, AV_LOG_INFO,
-                               "Ignoring seekhead entry for ID=0x%x\n",
-                               seek_id);
-                        break;
-                }
-
-                break;
-            }
-
-            default:
-                av_log(matroska->ctx, AV_LOG_INFO,
-                       "Unknown seekhead ID 0x%x\n", id);
-                /* fall-through */
-
-            case EBML_ID_VOID:
-                res = ebml_read_skip(matroska);
-                break;
-        }
-
-        if (matroska->level_up) {
-            matroska->level_up--;
-            break;
-        }
-    }
-
-    return res;
-}
-
-#define ARRAY_SIZE(x)  (sizeof(x)/sizeof(*x))
-
-static int
-matroska_aac_profile (char *codec_id)
-{
-    static const char *aac_profiles[] = {
-        "MAIN", "LC", "SSR"
-    };
-    int profile;
-
-    for (profile=0; profile<ARRAY_SIZE(aac_profiles); profile++)
-        if (strstr(codec_id, aac_profiles[profile]))
-            break;
-    return profile + 1;
-}
-
-static int
-matroska_aac_sri (int samplerate)
-{
-    static const int aac_sample_rates[] = {
-        96000, 88200, 64000, 48000, 44100, 32000,
-        24000, 22050, 16000, 12000, 11025,  8000,
-    };
-    int sri;
-
-    for (sri=0; sri<ARRAY_SIZE(aac_sample_rates); sri++)
-        if (aac_sample_rates[sri] == samplerate)
-            break;
-    return sri;
-}
-
-static int
-matroska_read_header (AVFormatContext    *s,
-                      AVFormatParameters *ap)
-{
-    MatroskaDemuxContext *matroska = s->priv_data;
-    char *doctype;
-    int version, last_level, res = 0;
-    uint32_t id;
-
-    matroska->ctx = s;
-
-    /* First read the EBML header. */
-    doctype = NULL;
-    if ((res = ebml_read_header(matroska, &doctype, &version)) < 0)
-        return res;
-    if ((doctype == NULL) || strcmp(doctype, "matroska")) {
-        av_log(matroska->ctx, AV_LOG_ERROR,
-               "Wrong EBML doctype ('%s' != 'matroska').\n",
-               doctype ? doctype : "(none)");
-        if (doctype)
-            av_free(doctype);
-        return AVERROR_NOFMT;
-    }
-    av_free(doctype);
-    if (version != 1) {
-        av_log(matroska->ctx, AV_LOG_ERROR,
-               "Matroska demuxer version 1 too old for file version %d\n",
-               version);
-        return AVERROR_NOFMT;
-    }
-
-    /* The next thing is a segment. */
-    while (1) {
-        if (!(id = ebml_peek_id(matroska, &last_level)))
-            return AVERROR_IO;
-        if (id == MATROSKA_ID_SEGMENT)
-            break;
-
-        /* oi! */
-        av_log(matroska->ctx, AV_LOG_INFO,
-               "Expected a Segment ID (0x%x), but received 0x%x!\n",
-               MATROSKA_ID_SEGMENT, id);
-        if ((res = ebml_read_skip(matroska)) < 0)
-            return res;
-    }
-
-    /* We now have a Matroska segment.
-     * Seeks are from the beginning of the segment,
-     * after the segment ID/length. */
-    if ((res = ebml_read_master(matroska, &id)) < 0)
-        return res;
-    matroska->segment_start = url_ftell(&s->pb);
-
-    matroska->time_scale = 1000000;
-    /* we've found our segment, start reading the different contents in here */
-    while (res == 0) {
-        if (!(id = ebml_peek_id(matroska, &matroska->level_up))) {
-            res = AVERROR_IO;
-            break;
-        } else if (matroska->level_up) {
-            matroska->level_up--;
-            break;
-        }
-
-        switch (id) {
-            /* stream info */
-            case MATROSKA_ID_INFO: {
-                if ((res = ebml_read_master(matroska, &id)) < 0)
-                    break;
-                res = matroska_parse_info(matroska);
-                break;
-            }
-
-            /* track info headers */
-            case MATROSKA_ID_TRACKS: {
-                if ((res = ebml_read_master(matroska, &id)) < 0)
-                    break;
-                res = matroska_parse_tracks(matroska);
-                break;
-            }
-
-            /* stream index */
-            case MATROSKA_ID_CUES: {
-                if (!matroska->index_parsed) {
-                    if ((res = ebml_read_master(matroska, &id)) < 0)
-                        break;
-                    res = matroska_parse_index(matroska);
-                } else
-                    res = ebml_read_skip(matroska);
-                break;
-            }
-
-            /* metadata */
-            case MATROSKA_ID_TAGS: {
-                if (!matroska->metadata_parsed) {
-                    if ((res = ebml_read_master(matroska, &id)) < 0)
-                        break;
-                    res = matroska_parse_metadata(matroska);
-                } else
-                    res = ebml_read_skip(matroska);
-                break;
-            }
-
-            /* file index (if seekable, seek to Cues/Tags to parse it) */
-            case MATROSKA_ID_SEEKHEAD: {
-                if ((res = ebml_read_master(matroska, &id)) < 0)
-                    break;
-                res = matroska_parse_seekhead(matroska);
-                break;
-            }
-
-            case MATROSKA_ID_CLUSTER: {
-                /* Do not read the master - this will be done in the next
-                 * call to matroska_read_packet. */
-                res = 1;
-                break;
-            }
-
-            default:
-                av_log(matroska->ctx, AV_LOG_INFO,
-                       "Unknown matroska file header ID 0x%x\n", id);
-            /* fall-through */
-
-            case EBML_ID_VOID:
-                res = ebml_read_skip(matroska);
-                break;
-        }
-
-        if (matroska->level_up) {
-            matroska->level_up--;
-            break;
-        }
-    }
-
-    /* Have we found a cluster? */
-    if (ebml_peek_id(matroska, NULL) == MATROSKA_ID_CLUSTER) {
-        int i, j;
-        MatroskaTrack *track;
-        AVStream *st;
-
-        for (i = 0; i < matroska->num_tracks; i++) {
-            enum CodecID codec_id = CODEC_ID_NONE;
-            uint8_t *extradata = NULL;
-            int extradata_size = 0;
-            int extradata_offset = 0;
-            track = matroska->tracks[i];
-
-            /* libavformat does not really support subtitles.
-             * Also apply some sanity checks. */
-            if ((track->type == MATROSKA_TRACK_TYPE_SUBTITLE) ||
-                (track->codec_id == NULL))
-                continue;
-
-            for(j=0; codec_tags[j].str; j++){
-                if(!strncmp(codec_tags[j].str, track->codec_id,
-                            strlen(codec_tags[j].str))){
-                    codec_id= codec_tags[j].id;
-                    break;
-                }
-            }
-
-            /* Set the FourCC from the CodecID. */
-            /* This is the MS compatibility mode which stores a
-             * BITMAPINFOHEADER in the CodecPrivate. */
-            if (!strcmp(track->codec_id,
-                        MATROSKA_CODEC_ID_VIDEO_VFW_FOURCC) &&
-                (track->codec_priv_size >= 40) &&
-                (track->codec_priv != NULL)) {
-                unsigned char *p;
-
-                /* Offset of biCompression. Stored in LE. */
-                p = (unsigned char *)track->codec_priv + 16;
-                ((MatroskaVideoTrack *)track)->fourcc = (p[3] << 24) |
-                                 (p[2] << 16) | (p[1] << 8) | p[0];
-                codec_id = codec_get_bmp_id(((MatroskaVideoTrack *)track)->fourcc);
-
-            }
-
-            /* This is the MS compatibility mode which stores a
-             * WAVEFORMATEX in the CodecPrivate. */
-            else if (!strcmp(track->codec_id,
-                             MATROSKA_CODEC_ID_AUDIO_ACM) &&
-                (track->codec_priv_size >= 18) &&
-                (track->codec_priv != NULL)) {
-                unsigned char *p;
-                uint16_t tag;
-
-                /* Offset of wFormatTag. Stored in LE. */
-                p = (unsigned char *)track->codec_priv;
-                tag = (p[1] << 8) | p[0];
-                codec_id = codec_get_wav_id(tag);
-
-            }
-
-            else if (codec_id == CODEC_ID_AAC && !track->codec_priv_size) {
-                MatroskaAudioTrack *audiotrack = (MatroskaAudioTrack *) track;
-                int profile = matroska_aac_profile(track->codec_id);
-                int sri = matroska_aac_sri(audiotrack->internal_samplerate);
-                extradata = av_malloc(5);
-                if (extradata == NULL)
-                    return AVERROR_NOMEM;
-                extradata[0] = (profile << 3) | ((sri&0x0E) >> 1);
-                extradata[1] = ((sri&0x01) << 7) | (audiotrack->channels<<3);
-                if (strstr(track->codec_id, "SBR")) {
-                    sri = matroska_aac_sri(audiotrack->samplerate);
-                    extradata[2] = 0x56;
-                    extradata[3] = 0xE5;
-                    extradata[4] = 0x80 | (sri<<3);
-                    extradata_size = 5;
-                } else {
-                    extradata_size = 2;
-                }
-            }
-
-            else if (codec_id == CODEC_ID_TTA) {
-                MatroskaAudioTrack *audiotrack = (MatroskaAudioTrack *) track;
-                ByteIOContext b;
-                extradata_size = 30;
-                extradata = av_mallocz(extradata_size);
-                if (extradata == NULL)
-                    return AVERROR_NOMEM;
-                init_put_byte(&b, extradata, extradata_size, 1,
-                              NULL, NULL, NULL, NULL);
-                put_buffer(&b, (uint8_t *) "TTA1", 4);
-                put_le16(&b, 1);
-                put_le16(&b, audiotrack->channels);
-                put_le16(&b, audiotrack->bitdepth);
-                put_le32(&b, audiotrack->samplerate);
-                put_le32(&b, matroska->ctx->duration * audiotrack->samplerate);
-            }
-
-            else if (codec_id == CODEC_ID_RV10 || codec_id == CODEC_ID_RV20 ||
-                     codec_id == CODEC_ID_RV30 || codec_id == CODEC_ID_RV40) {
-                extradata_offset = 26;
-                track->codec_priv_size -= extradata_offset;
-                track->flags |= MATROSKA_TRACK_REAL_V;
-            }
-
-            if (codec_id == CODEC_ID_NONE) {
-                av_log(matroska->ctx, AV_LOG_INFO,
-                       "Unknown/unsupported CodecID %s.\n",
-                       track->codec_id);
-            }
-
-            track->stream_index = matroska->num_streams;
-
-            matroska->num_streams++;
-            st = av_new_stream(s, track->stream_index);
-            if (st == NULL)
-                return AVERROR_NOMEM;
-            av_set_pts_info(st, 64, matroska->time_scale, 1000*1000*1000); /* 64 bit pts in ns */
-
-            st->codec->codec_id = codec_id;
-
-            if (track->default_duration)
-                av_reduce(&st->codec->time_base.num, &st->codec->time_base.den,
-                          track->default_duration, 1000000000, 30000);
-
-            if(extradata){
-                st->codec->extradata = extradata;
-                st->codec->extradata_size = extradata_size;
-            } else if(track->codec_priv && track->codec_priv_size > 0){
-                st->codec->extradata = av_malloc(track->codec_priv_size);
-                if(st->codec->extradata == NULL)
-                    return AVERROR_NOMEM;
-                st->codec->extradata_size = track->codec_priv_size;
-                memcpy(st->codec->extradata,track->codec_priv+extradata_offset,
-                       track->codec_priv_size);
-            }
-
-            if (track->type == MATROSKA_TRACK_TYPE_VIDEO) {
-                MatroskaVideoTrack *videotrack = (MatroskaVideoTrack *)track;
-
-                st->codec->codec_type = CODEC_TYPE_VIDEO;
-                st->codec->codec_tag = videotrack->fourcc;
-                st->codec->width = videotrack->pixel_width;
-                st->codec->height = videotrack->pixel_height;
-                if (videotrack->display_width == 0)
-                    videotrack->display_width= videotrack->pixel_width;
-                if (videotrack->display_height == 0)
-                    videotrack->display_height= videotrack->pixel_height;
-                av_reduce(&st->codec->sample_aspect_ratio.num,
-                          &st->codec->sample_aspect_ratio.den,
-                          st->codec->height * videotrack->display_width,
-                          st->codec-> width * videotrack->display_height,
-                          255);
-            } else if (track->type == MATROSKA_TRACK_TYPE_AUDIO) {
-                MatroskaAudioTrack *audiotrack = (MatroskaAudioTrack *)track;
-
-                st->codec->codec_type = CODEC_TYPE_AUDIO;
-                st->codec->sample_rate = audiotrack->samplerate;
-                st->codec->channels = audiotrack->channels;
-            } else if (track->type == MATROSKA_TRACK_TYPE_SUBTITLE) {
-                st->codec->codec_type = CODEC_TYPE_SUBTITLE;
-            }
-
-            /* What do we do with private data? E.g. for Vorbis. */
-        }
-        res = 0;
-    }
-
-    return res;
-}
-
-static int
-matroska_find_track_by_num (MatroskaDemuxContext *matroska,
-                            int                   num)
-{
-    int i;
-
-    for (i = 0; i < matroska->num_tracks; i++)
-        if (matroska->tracks[i]->num == num)
-            return i;
-
-    return -1;
-}
-
-static inline int
-rv_offset(uint8_t *data, int slice, int slices)
-{
-    return AV_RL32(data+8*slice+4) + 8*slices;
-}
-
-static int
-matroska_parse_blockgroup (MatroskaDemuxContext *matroska,
-                           uint64_t              cluster_time)
-{
-    int res = 0;
-    uint32_t id;
-    AVPacket *pkt = NULL;
-    int is_keyframe = PKT_FLAG_KEY, last_num_packets = matroska->num_packets;
-    uint64_t duration = AV_NOPTS_VALUE;
-    int track = -1;
-
-    av_log(matroska->ctx, AV_LOG_DEBUG, "parsing blockgroup...\n");
-
-    while (res == 0) {
-        if (!(id = ebml_peek_id(matroska, &matroska->level_up))) {
-            res = AVERROR_IO;
-            break;
-        } else if (matroska->level_up) {
-            matroska->level_up--;
-            break;
-        }
-
-        switch (id) {
-            /* one block inside the group. Note, block parsing is one
-             * of the harder things, so this code is a bit complicated.
-             * See http://www.matroska.org/ for documentation. */
-            case MATROSKA_ID_BLOCK: {
-                uint8_t *data, *origdata;
-                int size;
-                int16_t block_time;
-                uint32_t *lace_size = NULL;
-                int n, flags, laces = 0;
-                uint64_t num;
-                int64_t pos= url_ftell(&matroska->ctx->pb);
-
-                if ((res = ebml_read_binary(matroska, &id, &data, &size)) < 0)
-                    break;
-                origdata = data;
-
-                /* first byte(s): tracknum */
-                if ((n = matroska_ebmlnum_uint(data, size, &num)) < 0) {
-                    av_log(matroska->ctx, AV_LOG_ERROR,
-                           "EBML block data error\n");
-                    av_free(origdata);
-                    break;
-                }
-                data += n;
-                size -= n;
-
-                /* fetch track from num */
-                track = matroska_find_track_by_num(matroska, num);
-                if (size <= 3 || track < 0 || track >= matroska->num_tracks) {
-                    av_log(matroska->ctx, AV_LOG_INFO,
-                           "Invalid stream %d or size %u\n", track, size);
-                    av_free(origdata);
-                    break;
-                }
-                if(matroska->ctx->streams[ matroska->tracks[track]->stream_index ]->discard >= AVDISCARD_ALL){
-                    av_free(origdata);
-                    break;
-                }
-
-                /* block_time (relative to cluster time) */
-                block_time = (data[0] << 8) | data[1];
-                data += 2;
-                size -= 2;
-                flags = *data;
-                data += 1;
-                size -= 1;
-                switch ((flags & 0x06) >> 1) {
-                    case 0x0: /* no lacing */
-                        laces = 1;
-                        lace_size = av_mallocz(sizeof(int));
-                        lace_size[0] = size;
-                        break;
-
-                    case 0x1: /* xiph lacing */
-                    case 0x2: /* fixed-size lacing */
-                    case 0x3: /* EBML lacing */
-                        if (size == 0) {
-                            res = -1;
-                            break;
-                        }
-                        laces = (*data) + 1;
-                        data += 1;
-                        size -= 1;
-                        lace_size = av_mallocz(laces * sizeof(int));
-
-                        switch ((flags & 0x06) >> 1) {
-                            case 0x1: /* xiph lacing */ {
-                                uint8_t temp;
-                                uint32_t total = 0;
-                                for (n = 0; res == 0 && n < laces - 1; n++) {
-                                    while (1) {
-                                        if (size == 0) {
-                                            res = -1;
-                                            break;
-                                        }
-                                        temp = *data;
-                                        lace_size[n] += temp;
-                                        data += 1;
-                                        size -= 1;
-                                        if (temp != 0xff)
-                                            break;
-                                    }
-                                    total += lace_size[n];
-                                }
-                                lace_size[n] = size - total;
-                                break;
-                            }
-
-                            case 0x2: /* fixed-size lacing */
-                                for (n = 0; n < laces; n++)
-                                    lace_size[n] = size / laces;
-                                break;
-
-                            case 0x3: /* EBML lacing */ {
-                                uint32_t total;
-                                n = matroska_ebmlnum_uint(data, size, &num);
-                                if (n < 0) {
-                                    av_log(matroska->ctx, AV_LOG_INFO,
-                                           "EBML block data error\n");
-                                    break;
-                                }
-                                data += n;
-                                size -= n;
-                                total = lace_size[0] = num;
-                                for (n = 1; res == 0 && n < laces - 1; n++) {
-                                    int64_t snum;
-                                    int r;
-                                    r = matroska_ebmlnum_sint (data, size,
-                                                               &snum);
-                                    if (r < 0) {
-                                        av_log(matroska->ctx, AV_LOG_INFO,
-                                               "EBML block data error\n");
-                                        break;
-                                    }
-                                    data += r;
-                                    size -= r;
-                                    lace_size[n] = lace_size[n - 1] + snum;
-                                    total += lace_size[n];
-                                }
-                                lace_size[n] = size - total;
-                                break;
-                            }
-                        }
-                        break;
-                }
-
-                if (res == 0) {
-                    int real_v = matroska->tracks[track]->flags & MATROSKA_TRACK_REAL_V;
-                    for (n = 0; n < laces; n++) {
-                        uint64_t timecode = AV_NOPTS_VALUE;
-                        int slice, slices = 1;
-
-                        if (real_v) {
-                            slices = *data++ + 1;
-                            lace_size[n]--;
-                        }
-                        if (cluster_time != (uint64_t)-1 && n == 0) {
-                            if (cluster_time + block_time >= 0)
-                                timecode = (cluster_time + block_time) * matroska->time_scale;
-                        }
-                        /* FIXME: duration */
-
-                        for (slice=0; slice<slices; slice++) {
-                            int slice_size, slice_offset = 0;
-                            if (real_v)
-                                slice_offset = rv_offset(data, slice, slices);
-                            if (slice+1 == slices)
-                                slice_size = lace_size[n] - slice_offset;
-                            else
-                                slice_size = rv_offset(data, slice+1, slices) - slice_offset;
-                            pkt = av_mallocz(sizeof(AVPacket));
-                            /* XXX: prevent data copy... */
-                            if (av_new_packet(pkt, slice_size) < 0) {
-                                res = AVERROR_NOMEM;
-                                n = laces-1;
-                                break;
-                            }
-                            memcpy (pkt->data, data+slice_offset, slice_size);
-
-                            if (n == 0)
-                                pkt->flags = is_keyframe;
-                            pkt->stream_index =
-                                matroska->tracks[track]->stream_index;
-
-                            pkt->pts = timecode;
-                            pkt->pos = pos;
-
-                            matroska_queue_packet(matroska, pkt);
-                        }
-                        data += lace_size[n];
-                    }
-                }
-
-                av_free(lace_size);
-                av_free(origdata);
-                break;
-            }
-
-            case MATROSKA_ID_BLOCKDURATION: {
-                if ((res = ebml_read_uint(matroska, &id, &duration)) < 0)
-                    break;
-                break;
-            }
-
-            case MATROSKA_ID_BLOCKREFERENCE:
-                /* We've found a reference, so not even the first frame in
-                 * the lace is a key frame. */
-                is_keyframe = 0;
-                if (last_num_packets != matroska->num_packets)
-                    matroska->packets[last_num_packets]->flags = 0;
-                res = ebml_read_skip(matroska);
-                break;
-
-            default:
-                av_log(matroska->ctx, AV_LOG_INFO,
-                       "Unknown entry 0x%x in blockgroup data\n", id);
-                /* fall-through */
-
-            case EBML_ID_VOID:
-                res = ebml_read_skip(matroska);
-                break;
-        }
-
-        if (matroska->level_up) {
-            matroska->level_up--;
-            break;
-        }
-    }
-
-    if (pkt)
-    {
-        if (duration != AV_NOPTS_VALUE)
-            pkt->duration = duration;
-        else if (track >= 0 && track < matroska->num_tracks)
-            pkt->duration = matroska->tracks[track]->default_duration / matroska->time_scale;
-    }
-
-    return res;
-}
-
-static int
-matroska_parse_cluster (MatroskaDemuxContext *matroska)
-{
-    int res = 0;
-    uint32_t id;
-    uint64_t cluster_time = 0;
-
-    av_log(matroska->ctx, AV_LOG_DEBUG,
-           "parsing cluster at %"PRId64"\n", url_ftell(&matroska->ctx->pb));
-
-    while (res == 0) {
-        if (!(id = ebml_peek_id(matroska, &matroska->level_up))) {
-            res = AVERROR_IO;
-            break;
-        } else if (matroska->level_up) {
-            matroska->level_up--;
-            break;
-        }
-
-        switch (id) {
-            /* cluster timecode */
-            case MATROSKA_ID_CLUSTERTIMECODE: {
-                uint64_t num;
-                if ((res = ebml_read_uint(matroska, &id, &num)) < 0)
-                    break;
-                cluster_time = num;
-                break;
-            }
-
-                /* a group of blocks inside a cluster */
-            case MATROSKA_ID_BLOCKGROUP:
-                if ((res = ebml_read_master(matroska, &id)) < 0)
-                    break;
-                res = matroska_parse_blockgroup(matroska, cluster_time);
-                break;
-
-            default:
-                av_log(matroska->ctx, AV_LOG_INFO,
-                       "Unknown entry 0x%x in cluster data\n", id);
-                /* fall-through */
-
-            case EBML_ID_VOID:
-                res = ebml_read_skip(matroska);
-                break;
-        }
-
-        if (matroska->level_up) {
-            matroska->level_up--;
-            break;
-        }
-    }
-
-    return res;
-}
-
-static int
-matroska_read_packet (AVFormatContext *s,
-                      AVPacket        *pkt)
-{
-    MatroskaDemuxContext *matroska = s->priv_data;
-    int res = 0;
-    uint32_t id;
-
-    /* Do we still have a packet queued? */
-    if (matroska_deliver_packet(matroska, pkt) == 0)
-        return 0;
-
-    /* Have we already reached the end? */
-    if (matroska->done)
-        return AVERROR_IO;
-
-    while (res == 0) {
-        if (!(id = ebml_peek_id(matroska, &matroska->level_up))) {
-            res = AVERROR_IO;
-            break;
-        } else if (matroska->level_up) {
-            matroska->level_up--;
-            break;
-        }
-
-        switch (id) {
-            case MATROSKA_ID_CLUSTER:
-                if ((res = ebml_read_master(matroska, &id)) < 0)
-                    break;
-                if ((res = matroska_parse_cluster(matroska)) == 0)
-                    res = 1; /* Parsed one cluster, let's get out. */
-                break;
-
-            default:
-            case EBML_ID_VOID:
-                res = ebml_read_skip(matroska);
-                break;
-        }
-
-        if (matroska->level_up) {
-            matroska->level_up--;
-            break;
-        }
-    }
-
-    if (res == -1)
-        matroska->done = 1;
-
-    return matroska_deliver_packet(matroska, pkt);
-}
-
-static int
-matroska_read_close (AVFormatContext *s)
-{
-    MatroskaDemuxContext *matroska = s->priv_data;
-    int n = 0;
-
-    av_free(matroska->writing_app);
-    av_free(matroska->muxing_app);
-    av_free(matroska->index);
-
-    if (matroska->packets != NULL) {
-        for (n = 0; n < matroska->num_packets; n++) {
-            av_free_packet(matroska->packets[n]);
-            av_free(matroska->packets[n]);
-        }
-        av_free(matroska->packets);
-    }
-
-    for (n = 0; n < matroska->num_tracks; n++) {
-        MatroskaTrack *track = matroska->tracks[n];
-        av_free(track->codec_id);
-        av_free(track->codec_name);
-        av_free(track->codec_priv);
-        av_free(track->name);
-        av_free(track->language);
-
-        av_free(track);
-    }
-
-    return 0;
-}
-
-AVInputFormat matroska_demuxer = {
-    "matroska",
-    "Matroska file format",
-    sizeof(MatroskaDemuxContext),
-    matroska_probe,
-    matroska_read_header,
-    matroska_read_packet,
-    matroska_read_close,
-};

Modified: branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavformat/mov.c
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavformat/mov.c	2007-07-16 16:39:52 UTC (rev 3382)
+++ branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavformat/mov.c	2007-07-16 17:44:22 UTC (rev 3383)
@@ -38,16 +38,8 @@
  *
  * Features and limitations:
  * - reads most of the QT files I have (at least the structure),
- *   the exceptions are .mov with zlib compressed headers ('cmov' section). It shouldn't be hard to implement.
- *   FIXED, Francois Revol, 07/17/2002
- * - ffmpeg has nearly none of the usual QuickTime codecs,
- *   although I succesfully dumped raw and mp3 audio tracks off .mov files.
  *   Sample QuickTime files with mp3 audio can be found at: http://www.3ivx.com/showcase.html
- * - .mp4 parsing is still hazardous, although the format really is QuickTime with some minor changes
- *   (to make .mov parser crash maybe ?), despite what they say in the MPEG FAQ at
- *   http://mpeg.telecomitalialab.com/faq.htm
  * - the code is quite ugly... maybe I won't do it recursive next time :-)
- * - seek is not supported with files that contain edit list
  *
  * Funny I didn't know about http://sourceforge.net/projects/qt-ffmpeg/
  * when coding this :) (it's a writer anyway)
@@ -66,109 +58,16 @@
 #undef NDEBUG
 #include <assert.h>
 
-static const AVCodecTag mov_video_tags[] = {
-/*  { CODEC_ID_, MKTAG('c', 'v', 'i', 'd') }, *//* Cinepak */
-/*  { CODEC_ID_H263, MKTAG('r', 'a', 'w', ' ') }, *//* Uncompressed RGB */
-/*  { CODEC_ID_H263, MKTAG('Y', 'u', 'v', '2') }, *//* Uncompressed YUV422 */
-/*    { CODEC_ID_RAWVIDEO, MKTAG('A', 'V', 'U', 'I') }, *//* YUV with alpha-channel (AVID Uncompressed) */
-/* Graphics */
-/* Animation */
-/* Apple video */
-/* Kodak Photo CD */
-    { CODEC_ID_MJPEG, MKTAG('j', 'p', 'e', 'g') }, /* PhotoJPEG */
-    { CODEC_ID_MPEG1VIDEO, MKTAG('m', 'p', 'e', 'g') }, /* MPEG */
-    { CODEC_ID_MJPEG, MKTAG('m', 'j', 'p', 'a') }, /* Motion-JPEG (format A) */
-    { CODEC_ID_MJPEGB, MKTAG('m', 'j', 'p', 'b') }, /* Motion-JPEG (format B) */
-    { CODEC_ID_MJPEG, MKTAG('A', 'V', 'D', 'J') }, /* MJPEG with alpha-channel (AVID JFIF meridien compressed) */
-/*    { CODEC_ID_MJPEG, MKTAG('A', 'V', 'R', 'n') }, *//* MJPEG with alpha-channel (AVID ABVB/Truevision NuVista) */
-    { CODEC_ID_GIF, MKTAG('g', 'i', 'f', ' ') }, /* embedded gif files as frames (usually one "click to play movie" frame) */
-/* Sorenson video */
-    { CODEC_ID_SVQ1, MKTAG('S', 'V', 'Q', '1') }, /* Sorenson Video v1 */
-    { CODEC_ID_SVQ1, MKTAG('s', 'v', 'q', '1') }, /* Sorenson Video v1 */
-    { CODEC_ID_SVQ1, MKTAG('s', 'v', 'q', 'i') }, /* Sorenson Video v1 (from QT specs)*/
-    { CODEC_ID_SVQ3, MKTAG('S', 'V', 'Q', '3') }, /* Sorenson Video v3 */
-    { CODEC_ID_MPEG4, MKTAG('m', 'p', '4', 'v') },
-    { CODEC_ID_MPEG4, MKTAG('D', 'I', 'V', 'X') }, /* OpenDiVX *//* sample files at http://heroinewarrior.com/xmovie.php3 use this tag */
-    { CODEC_ID_MPEG4, MKTAG('X', 'V', 'I', 'D') },
-    { CODEC_ID_MPEG4, MKTAG('3', 'I', 'V', '2') }, /* experimental: 3IVX files before ivx D4 4.5.1 */
-/*    { CODEC_ID_, MKTAG('I', 'V', '5', '0') }, *//* Indeo 5.0 */
-    { CODEC_ID_H263, MKTAG('h', '2', '6', '3') }, /* H263 */
-    { CODEC_ID_H263, MKTAG('s', '2', '6', '3') }, /* H263 ?? works */
-    { CODEC_ID_DVVIDEO, MKTAG('d', 'v', 'c', ' ') }, /* DV NTSC */
-    { CODEC_ID_DVVIDEO, MKTAG('d', 'v', 'c', 'p') }, /* DV PAL */
-    { CODEC_ID_VP3, MKTAG('V', 'P', '3', '1') }, /* On2 VP3 */
-    { CODEC_ID_RPZA, MKTAG('r', 'p', 'z', 'a') }, /* Apple Video (RPZA) */
-    { CODEC_ID_CINEPAK, MKTAG('c', 'v', 'i', 'd') }, /* Cinepak */
-    { CODEC_ID_8BPS, MKTAG('8', 'B', 'P', 'S') }, /* Planar RGB (8BPS) */
-    { CODEC_ID_SMC, MKTAG('s', 'm', 'c', ' ') }, /* Apple Graphics (SMC) */
-    { CODEC_ID_QTRLE, MKTAG('r', 'l', 'e', ' ') }, /* Apple Animation (RLE) */
-    { CODEC_ID_MSRLE, MKTAG('W', 'R', 'L', 'E') },
-    { CODEC_ID_QDRAW, MKTAG('q', 'd', 'r', 'w') }, /* QuickDraw */
-    { CODEC_ID_H264, MKTAG('a', 'v', 'c', '1') }, /* AVC-1/H.264 */
-    { CODEC_ID_MPEG2VIDEO, MKTAG('h', 'd', 'v', '2') }, /* MPEG2 produced by Sony HD camera */
-    { CODEC_ID_MPEG2VIDEO, MKTAG('h', 'd', 'v', '3') }, /* HDV produced by FCP */
-    { CODEC_ID_MPEG2VIDEO, MKTAG('m', 'x', '5', 'n') }, /* MPEG2 IMX NTSC 525/60 50mb/s produced by FCP */
-    { CODEC_ID_MPEG2VIDEO, MKTAG('m', 'x', '5', 'p') }, /* MPEG2 IMX PAL 625/50 50mb/s produced by FCP */
-    { CODEC_ID_MPEG2VIDEO, MKTAG('m', 'x', '3', 'n') }, /* MPEG2 IMX NTSC 525/60 30mb/s produced by FCP */
-    { CODEC_ID_MPEG2VIDEO, MKTAG('m', 'x', '3', 'p') }, /* MPEG2 IMX PAL 625/50 30mb/s produced by FCP */
-    { CODEC_ID_DVVIDEO, MKTAG('d', 'v', 'p', 'p') }, /* DVCPRO PAL produced by FCP */
-    //{ CODEC_ID_DVVIDEO, MKTAG('d', 'v', 'h', '5') }, /* DVCPRO HD 50i produced by FCP */
-    //{ CODEC_ID_DVVIDEO, MKTAG('d', 'v', 'h', '6') }, /* DVCPRO HD 60i produced by FCP */
-    { CODEC_ID_DVVIDEO, MKTAG('d', 'v', '5', 'p') }, /* DVCPRO50 PAL produced by FCP */
-    { CODEC_ID_DVVIDEO, MKTAG('d', 'v', '5', 'n') }, /* DVCPRO50 NTSC produced by FCP */
-    { CODEC_ID_DVVIDEO, MKTAG('A', 'V', 'd', 'v') }, /* AVID DV */
-    //{ CODEC_ID_JPEG2000, MKTAG('m', 'j', 'p', '2') }, /* JPEG 2000 produced by FCP */
-    { CODEC_ID_TARGA, MKTAG('t', 'g', 'a', ' ') }, /* Truevision Targa */
-    { CODEC_ID_TIFF, MKTAG('t', 'i', 'f', 'f') }, /* TIFF embedded in MOV */
-    { CODEC_ID_RAWVIDEO, MKTAG('2', 'v', 'u', 'y') }, /* UNCOMPRESSED 8BIT 4:2:2 */
-    { CODEC_ID_VC1,  MKTAG('v', 'c', '-', '1') }, /* SMPTE RP 2025 */
-    { CODEC_ID_WMV3, MKTAG('v', 'c', '-', '1') }, /* SMPTE RP 2025 */
-    { CODEC_ID_PNG,  MKTAG('p', 'n', 'g', ' ') },
-    { CODEC_ID_NONE, 0 },
-};
-
-static const AVCodecTag mov_audio_tags[] = {
-    { CODEC_ID_PCM_S32BE, MKTAG('i', 'n', '3', '2') },
-    { CODEC_ID_PCM_S24BE, MKTAG('i', 'n', '2', '4') },
-    { CODEC_ID_PCM_S16BE, MKTAG('N', 'O', 'N', 'E') }, /* uncompressed */
-    { CODEC_ID_PCM_S16BE, MKTAG('t', 'w', 'o', 's') }, /* 16 bits */
-    { CODEC_ID_PCM_U8, MKTAG('r', 'a', 'w', ' ') }, /* 8 bits unsigned */
-    { CODEC_ID_PCM_S16LE, MKTAG('s', 'o', 'w', 't') }, /*  */
-    { CODEC_ID_PCM_MULAW, MKTAG('u', 'l', 'a', 'w') }, /*  */
-    { CODEC_ID_PCM_ALAW, MKTAG('a', 'l', 'a', 'w') }, /*  */
-    { CODEC_ID_ADPCM_IMA_QT, MKTAG('i', 'm', 'a', '4') }, /* IMA-4 ADPCM */
-    { CODEC_ID_ADPCM_MS, MKTAG('m', 's', 0x00, 0x02) }, /* MS ADPCM */
-    { CODEC_ID_MACE3, MKTAG('M', 'A', 'C', '3') }, /* Macintosh Audio Compression and Expansion 3:1 */
-    { CODEC_ID_MACE6, MKTAG('M', 'A', 'C', '6') }, /* Macintosh Audio Compression and Expansion 6:1 */
-
-    { CODEC_ID_MP3, MKTAG('.', 'm', 'p', '3') }, /* MPEG layer 3 */ /* sample files at http://www.3ivx.com/showcase.html use this tag */
-    { CODEC_ID_MP2, 0x6D730055 }, /* MPEG layer 3 */
-    { CODEC_ID_MP2, 0x5500736D }, /* MPEG layer 3 *//* XXX: check endianness */
-/*    { CODEC_ID_OGG_VORBIS, MKTAG('O', 'g', 'g', 'S') }, *//* sample files at http://heroinewarrior.com/xmovie.php3 use this tag */
-/* MP4 tags */
-    { CODEC_ID_AAC, MKTAG('m', 'p', '4', 'a') }, /* MPEG-4 AAC */
-    /* The standard for mpeg4 audio is still not normalised AFAIK anyway */
-    { CODEC_ID_AMR_NB, MKTAG('s', 'a', 'm', 'r') }, /* AMR-NB 3gp */
-    { CODEC_ID_AMR_WB, MKTAG('s', 'a', 'w', 'b') }, /* AMR-WB 3gp */
-    { CODEC_ID_AC3, MKTAG('m', 's', 0x20, 0x00) }, /* Dolby AC-3 */
-    { CODEC_ID_ALAC,MKTAG('a', 'l', 'a', 'c') }, /* Apple Lossless */
-    { CODEC_ID_QDM2,MKTAG('Q', 'D', 'M', '2') }, /* QDM2 */
-    { CODEC_ID_DVAUDIO, MKTAG('v', 'd', 'v', 'a') },
-    { CODEC_ID_DVAUDIO, MKTAG('d', 'v', 'c', 'a') },
-    { CODEC_ID_PCM_S16LE, MKTAG('l', 'p', 'c', 'm') },
-    { CODEC_ID_NONE, 0 },
-};
-
 /* the QuickTime file format is quite convoluted...
  * it has lots of index tables, each indexing something in another one...
  * Here we just use what is needed to read the chunks
  */
 
-typedef struct MOV_sample_to_chunk_tbl {
-    long first;
-    long count;
-    long id;
-} MOV_sample_to_chunk_tbl;
+typedef struct {
+    int first;
+    int count;
+    int id;
+} MOV_stsc_t;
 
 typedef struct {
     uint32_t type;
@@ -177,91 +76,36 @@
 } MOV_atom_t;
 
 typedef struct {
-    int seed;
-    int flags;
-    int size;
-    void* clrs;
-} MOV_ctab_t;
-
-typedef struct MOV_mdat_atom_s {
     offset_t offset;
     int64_t size;
-} MOV_mdat_atom_t;
+} MOV_mdat_t;
 
-typedef struct {
-    uint8_t  version;
-    uint32_t flags; // 24bit
-
-    /* 0x03 ESDescrTag */
-    uint16_t es_id;
-#define MP4ODescrTag                    0x01
-#define MP4IODescrTag                   0x02
-#define MP4ESDescrTag                   0x03
-#define MP4DecConfigDescrTag            0x04
-#define MP4DecSpecificDescrTag          0x05
-#define MP4SLConfigDescrTag             0x06
-#define MP4ContentIdDescrTag            0x07
-#define MP4SupplContentIdDescrTag       0x08
-#define MP4IPIPtrDescrTag               0x09
-#define MP4IPMPPtrDescrTag              0x0A
-#define MP4IPMPDescrTag                 0x0B
-#define MP4RegistrationDescrTag         0x0D
-#define MP4ESIDIncDescrTag              0x0E
-#define MP4ESIDRefDescrTag              0x0F
-#define MP4FileIODescrTag               0x10
-#define MP4FileODescrTag                0x11
-#define MP4ExtProfileLevelDescrTag      0x13
-#define MP4ExtDescrTagsStart            0x80
-#define MP4ExtDescrTagsEnd              0xFE
-    uint8_t  stream_priority;
-
-    /* 0x04 DecConfigDescrTag */
-    uint8_t  object_type_id;
-    uint8_t  stream_type;
-    /* XXX: really streamType is
-     * only 6bit, followed by:
-     * 1bit  upStream
-     * 1bit  reserved
-     */
-    uint32_t buffer_size_db; // 24
-    uint32_t max_bitrate;
-    uint32_t avg_bitrate;
-
-    /* 0x05 DecSpecificDescrTag */
-    uint8_t  decoder_cfg_len;
-    uint8_t *decoder_cfg;
-
-    /* 0x06 SLConfigDescrTag */
-    uint8_t  sl_config_len;
-    uint8_t *sl_config;
-} MOV_esds_t;
-
 struct MOVParseTableEntry;
 
 typedef struct MOVStreamContext {
     int ffindex; /* the ffmpeg stream id */
-    long next_chunk;
-    long chunk_count;
+    int next_chunk;
+    unsigned int chunk_count;
     int64_t *chunk_offsets;
-    int stts_count;
-    Time2Sample *stts_data;
-    int ctts_count;
-    Time2Sample *ctts_data;
-    int edit_count;             /* number of 'edit' (elst atom) */
-    long sample_to_chunk_sz;
-    MOV_sample_to_chunk_tbl *sample_to_chunk;
+    unsigned int stts_count;
+    MOV_stts_t *stts_data;
+    unsigned int ctts_count;
+    MOV_stts_t *ctts_data;
+    unsigned int edit_count; /* number of 'edit' (elst atom) */
+    unsigned int sample_to_chunk_sz;
+    MOV_stsc_t *sample_to_chunk;
     int sample_to_ctime_index;
     int sample_to_ctime_sample;
-    long sample_size;
-    long sample_count;
-    long *sample_sizes;
-    long keyframe_count;
-    long *keyframes;
+    unsigned int sample_size;
+    unsigned int sample_count;
+    int *sample_sizes;
+    unsigned int keyframe_count;
+    int *keyframes;
     int time_scale;
     int time_rate;
-    long current_sample;
-    MOV_esds_t esds;
-    AVRational sample_size_v1;
+    int current_sample;
+    unsigned int bytes_per_frame;
+    unsigned int samples_per_frame;
     int dv_audio_container;
 } MOVStreamContext;
 
@@ -271,21 +115,15 @@
     int64_t duration; /* duration of the longest track */
     int found_moov; /* when both 'moov' and 'mdat' sections has been found */
     int found_mdat; /* we suppose we have enough data to read the file */
-    int64_t mdat_size;
     int64_t mdat_offset;
     int total_streams;
-    /* some streams listed here aren't presented to the ffmpeg API, since they aren't either video nor audio
-     * but we need the info to be able to skip data from those streams in the 'mdat' section
-     */
     MOVStreamContext *streams[MAX_STREAMS];
 
-    int ctab_size;
-    MOV_ctab_t **ctab;           /* color tables */
     const struct MOVParseTableEntry *parse_table; /* could be eventually used to change the table */
     /* NOTE: for recursion save to/ restore from local variable! */
 
     AVPaletteControl palette_control;
-    MOV_mdat_atom_t *mdat_list;
+    MOV_mdat_t *mdat_list;
     int mdat_count;
     DVDemuxContext *dv_demux;
     AVFormatContext *dv_fctx;
@@ -319,7 +157,7 @@
     a.offset = atom.offset;
 
     if (atom.size < 0)
-        atom.size = 0x7fffffffffffffffLL;
+        atom.size = INT64_MAX;
     while(((total_size + 8) < atom.size) && !url_feof(pb) && !err) {
         a.size = atom.size;
         a.type=0L;
@@ -329,7 +167,7 @@
         }
         total_size += 8;
         a.offset += 8;
-        dprintf("type: %08x  %.4s  sz: %"PRIx64"  %"PRIx64"   %"PRIx64"\n", a.type, (char*)&a.type, a.size, atom.size, total_size);
+        dprintf(c->fc, "type: %08x  %.4s  sz: %"PRIx64"  %"PRIx64"   %"PRIx64"\n", a.type, (char*)&a.type, a.size, atom.size, total_size);
         if (a.size == 1) { /* 64 bit extended size */
             a.size = get_be64(pb) - 8;
             a.offset += 8;
@@ -340,15 +178,14 @@
             if (a.size <= 8)
                 break;
         }
+        a.size -= 8;
+        if(a.size < 0 || a.size > atom.size - total_size)
+            break;
+
         for (i = 0; c->parse_table[i].type != 0L
              && c->parse_table[i].type != a.type; i++)
             /* empty */;
 
-        a.size -= 8;
-
-        if(a.size < 0)
-            break;
-
         if (c->parse_table[i].type == 0) { /* skip leaf atoms data */
             url_fskip(pb, a.size);
         } else {
@@ -371,30 +208,6 @@
     return err;
 }
 
-static int mov_read_ctab(MOVContext *c, ByteIOContext *pb, MOV_atom_t atom)
-{
-#if 1
-    url_fskip(pb, atom.size); // for now
-#else
-    VERY VERY BROKEN, NEVER execute this, needs rewrite
-    unsigned int len;
-    MOV_ctab_t *t;
-    c->ctab = av_realloc(c->ctab, ++c->ctab_size);
-    t = c->ctab[c->ctab_size];
-    t->seed = get_be32(pb);
-    t->flags = get_be16(pb);
-    t->size = get_be16(pb) + 1;
-    len = 2 * t->size * 4;
-    if (len > 0) {
-        t->clrs = av_malloc(len); // 16bit A R G B
-        if (t->clrs)
-            get_buffer(pb, t->clrs, len);
-    }
-#endif
-
-    return 0;
-}
-
 static int mov_read_hdlr(MOVContext *c, ByteIOContext *pb, MOV_atom_t atom)
 {
     AVStream *st = c->fc->streams[c->fc->nb_streams-1];
@@ -408,8 +221,8 @@
     ctype = get_le32(pb);
     type = get_le32(pb); /* component subtype */
 
-    dprintf("ctype= %c%c%c%c (0x%08lx)\n", *((char *)&ctype), ((char *)&ctype)[1], ((char *)&ctype)[2], ((char *)&ctype)[3], (long) ctype);
-    dprintf("stype= %c%c%c%c\n", *((char *)&type), ((char *)&type)[1], ((char *)&type)[2], ((char *)&type)[3]);
+    dprintf(c->fc, "ctype= %c%c%c%c (0x%08x)\n", *((char *)&ctype), ((char *)&ctype)[1], ((char *)&ctype)[2], ((char *)&ctype)[3], (int) ctype);
+    dprintf(c->fc, "stype= %c%c%c%c\n", *((char *)&type), ((char *)&type)[1], ((char *)&type)[2], ((char *)&type)[3]);
     if(!ctype)
         c->isom = 1;
     if(type == MKTAG('v', 'i', 'd', 'e'))
@@ -433,7 +246,7 @@
     return 0;
 }
 
-static int mov_mp4_read_descr_len(ByteIOContext *pb)
+static int mp4_read_descr_len(ByteIOContext *pb)
 {
     int len = 0;
     int count = 4;
@@ -446,43 +259,45 @@
     return len;
 }
 
-static int mov_mp4_read_descr(ByteIOContext *pb, int *tag)
+static int mp4_read_descr(MOVContext *c, ByteIOContext *pb, int *tag)
 {
     int len;
     *tag = get_byte(pb);
-    len = mov_mp4_read_descr_len(pb);
-    dprintf("MPEG4 description: tag=0x%02x len=%d\n", *tag, len);
+    len = mp4_read_descr_len(pb);
+    dprintf(c->fc, "MPEG4 description: tag=0x%02x len=%d\n", *tag, len);
     return len;
 }
 
+#define MP4ESDescrTag                   0x03
+#define MP4DecConfigDescrTag            0x04
+#define MP4DecSpecificDescrTag          0x05
+
 static int mov_read_esds(MOVContext *c, ByteIOContext *pb, MOV_atom_t atom)
 {
     AVStream *st = c->fc->streams[c->fc->nb_streams-1];
-    MOVStreamContext *sc = (MOVStreamContext *)st->priv_data;
     int tag, len;
 
-    /* Well, broken but suffisant for some MP4 streams */
     get_be32(pb); /* version + flags */
-    len = mov_mp4_read_descr(pb, &tag);
+    len = mp4_read_descr(c, pb, &tag);
     if (tag == MP4ESDescrTag) {
         get_be16(pb); /* ID */
         get_byte(pb); /* priority */
     } else
         get_be16(pb); /* ID */
 
-    len = mov_mp4_read_descr(pb, &tag);
+    len = mp4_read_descr(c, pb, &tag);
     if (tag == MP4DecConfigDescrTag) {
-        sc->esds.object_type_id = get_byte(pb);
-        sc->esds.stream_type = get_byte(pb);
-        sc->esds.buffer_size_db = get_be24(pb);
-        sc->esds.max_bitrate = get_be32(pb);
-        sc->esds.avg_bitrate = get_be32(pb);
+        int object_type_id = get_byte(pb);
+        get_byte(pb); /* stream type */
+        get_be24(pb); /* buffer size db */
+        get_be32(pb); /* max bitrate */
+        get_be32(pb); /* avg bitrate */
 
-        st->codec->codec_id= codec_get_id(ff_mov_obj_type, sc->esds.object_type_id);
-        dprintf("esds object type id %d\n", sc->esds.object_type_id);
-        len = mov_mp4_read_descr(pb, &tag);
+        st->codec->codec_id= codec_get_id(ff_mp4_obj_type, object_type_id);
+        dprintf(c->fc, "esds object type id %d\n", object_type_id);
+        len = mp4_read_descr(c, pb, &tag);
         if (tag == MP4DecSpecificDescrTag) {
-            dprintf("Specific MPEG4 header len=%d\n", len);
+            dprintf(c->fc, "Specific MPEG4 header len=%d\n", len);
             st->codec->extradata = av_mallocz(len + FF_INPUT_BUFFER_PADDING_SIZE);
             if (st->codec->extradata) {
                 get_buffer(pb, st->codec->extradata, len);
@@ -508,7 +323,6 @@
     c->mdat_count++;
     c->found_mdat=1;
     c->mdat_offset = atom.offset;
-    c->mdat_size = atom.size;
     if(c->found_moov)
         return 1; /* found both, just go */
     url_fskip(pb, atom.size);
@@ -545,7 +359,7 @@
 static int mov_read_mdhd(MOVContext *c, ByteIOContext *pb, MOV_atom_t atom)
 {
     AVStream *st = c->fc->streams[c->fc->nb_streams-1];
-    MOVStreamContext *sc = (MOVStreamContext *)st->priv_data;
+    MOVStreamContext *sc = st->priv_data;
     int version = get_byte(pb);
     int lang;
 
@@ -586,9 +400,9 @@
         get_be32(pb); /* modification time */
     }
     c->time_scale = get_be32(pb); /* time scale */
-#ifdef DEBUG
-    av_log(NULL, AV_LOG_DEBUG, "time scale = %i\n", c->time_scale);
-#endif
+
+    dprintf(c->fc, "time scale = %i\n", c->time_scale);
+
     c->duration = (version == 1) ? get_be64(pb) : get_be32(pb); /* duration */
     get_be32(pb); /* preferred scale */
 
@@ -623,9 +437,9 @@
     st->codec->extradata = av_mallocz(st->codec->extradata_size + FF_INPUT_BUFFER_PADDING_SIZE);
 
     if (st->codec->extradata) {
-        strcpy(st->codec->extradata, "SVQ3"); // fake
+        memcpy(st->codec->extradata, "SVQ3", 4); // fake
         get_buffer(pb, st->codec->extradata + 0x5a, atom.size);
-        dprintf("Reading SMI %"PRId64"  %s\n", atom.size, st->codec->extradata + 0x5a);
+        dprintf(c->fc, "Reading SMI %"PRId64"  %s\n", atom.size, st->codec->extradata + 0x5a);
     } else
         url_fskip(pb, atom.size);
 
@@ -652,21 +466,18 @@
     return 0;
 }
 
-static int mov_read_alac(MOVContext *c, ByteIOContext *pb, MOV_atom_t atom)
+/* FIXME modify qdm2/svq3/h264 decoders to take full atom as extradata */
+static int mov_read_extradata(MOVContext *c, ByteIOContext *pb, MOV_atom_t atom)
 {
     AVStream *st = c->fc->streams[c->fc->nb_streams-1];
-
-    // currently ALAC decoder expect full atom header - so let's fake it
-    // this should be fixed and just ALAC header should be passed
-
+    if((uint64_t)atom.size > (1<<30))
+        return -1;
     av_free(st->codec->extradata);
-    st->codec->extradata_size = 36;
+    st->codec->extradata_size = atom.size + 8;
     st->codec->extradata = av_mallocz(st->codec->extradata_size + FF_INPUT_BUFFER_PADDING_SIZE);
-
     if (st->codec->extradata) {
-        strcpy(st->codec->extradata + 4, "alac"); // fake
-        get_buffer(pb, st->codec->extradata + 8, 36 - 8);
-        dprintf("Reading alac %d  %s\n", st->codec->extradata_size, st->codec->extradata);
+        AV_WL32(st->codec->extradata + 4, atom.type);
+        get_buffer(pb, st->codec->extradata + 8, atom.size);
     } else
         url_fskip(pb, atom.size);
     return 0;
@@ -696,27 +507,6 @@
     return 0;
 }
 
-static int mov_read_jp2h(MOVContext *c, ByteIOContext *pb, MOV_atom_t atom)
-{
-    AVStream *st = c->fc->streams[c->fc->nb_streams-1];
-
-    if((uint64_t)atom.size > (1<<30))
-        return -1;
-
-    av_free(st->codec->extradata);
-
-    st->codec->extradata_size = atom.size + 8;
-    st->codec->extradata = av_mallocz(st->codec->extradata_size + FF_INPUT_BUFFER_PADDING_SIZE);
-
-    /* pass all jp2h atom to codec */
-    if (st->codec->extradata) {
-        strcpy(st->codec->extradata + 4, "jp2h");
-        get_buffer(pb, st->codec->extradata + 8, atom.size);
-    } else
-        url_fskip(pb, atom.size);
-    return 0;
-}
-
 static int mov_read_avcC(MOVContext *c, ByteIOContext *pb, MOV_atom_t atom)
 {
     AVStream *st = c->fc->streams[c->fc->nb_streams-1];
@@ -740,7 +530,7 @@
 static int mov_read_stco(MOVContext *c, ByteIOContext *pb, MOV_atom_t atom)
 {
     AVStream *st = c->fc->streams[c->fc->nb_streams-1];
-    MOVStreamContext *sc = (MOVStreamContext *)st->priv_data;
+    MOVStreamContext *sc = st->priv_data;
     unsigned int i, entries;
 
     get_byte(pb); /* version */
@@ -772,7 +562,7 @@
 static int mov_read_stsd(MOVContext *c, ByteIOContext *pb, MOV_atom_t atom)
 {
     AVStream *st = c->fc->streams[c->fc->nb_streams-1];
-    MOVStreamContext *sc = (MOVStreamContext *)st->priv_data;
+    MOVStreamContext *sc = st->priv_data;
     int entries, frames_per_sample;
     uint32_t format;
     uint8_t codec_name[32];
@@ -812,19 +602,19 @@
         }
 
         st->codec->codec_tag = format;
-        id = codec_get_id(mov_audio_tags, format);
+        id = codec_get_id(codec_movaudio_tags, format);
         if (st->codec->codec_type != CODEC_TYPE_VIDEO && id > 0) {
             st->codec->codec_type = CODEC_TYPE_AUDIO;
         } else if (st->codec->codec_type != CODEC_TYPE_AUDIO && /* do not overwrite codec type */
                    format && format != MKTAG('m', 'p', '4', 's')) { /* skip old asf mpeg4 tag */
-            id = codec_get_id(mov_video_tags, format);
+            id = codec_get_id(codec_movvideo_tags, format);
             if (id <= 0)
                 id = codec_get_id(codec_bmp_tags, format);
             if (id > 0)
                 st->codec->codec_type = CODEC_TYPE_VIDEO;
         }
 
-        dprintf("size=%d 4CC= %c%c%c%c codec_type=%d\n",
+        dprintf(c->fc, "size=%d 4CC= %c%c%c%c codec_type=%d\n",
                 size,
                 (format >> 0) & 0xff, (format >> 8) & 0xff, (format >> 16) & 0xff, (format >> 24) & 0xff,
                 st->codec->codec_type);
@@ -844,9 +634,9 @@
             get_be32(pb); /* vert resolution */
             get_be32(pb); /* data size, always 0 */
             frames_per_sample = get_be16(pb); /* frames per samples */
-#ifdef DEBUG
-            av_log(NULL, AV_LOG_DEBUG, "frames/samples = %d\n", frames_per_sample);
-#endif
+
+            dprintf(c->fc, "frames/samples = %d\n", frames_per_sample);
+
             get_buffer(pb, codec_name, 32); /* codec name, pascal string (FIXME: true for mp4?) */
             if (codec_name[0] <= 31) {
                 memcpy(st->codec->codec_name, &codec_name[1],codec_name[0]);
@@ -934,7 +724,7 @@
             get_be32(pb); /* vendor */
 
             st->codec->channels = get_be16(pb);             /* channel count */
-            dprintf("audio channels %d\n", st->codec->channels);
+            dprintf(c->fc, "audio channels %d\n", st->codec->channels);
             st->codec->bits_per_sample = get_be16(pb);      /* sample size */
             /* do we need to force to 16 for AMR ? */
 
@@ -961,13 +751,13 @@
                 break;
             }
 
-            //Read QT version 1 fields. In version 0 theese dont exist
-            dprintf("version =%d, isom =%d\n",version,c->isom);
+            //Read QT version 1 fields. In version 0 these do not exist.
+            dprintf(c->fc, "version =%d, isom =%d\n",version,c->isom);
             if(!c->isom) {
                 if(version==1) {
-                    sc->sample_size_v1.den = get_be32(pb); /* samples per packet */
+                    sc->samples_per_frame = get_be32(pb);
                     get_be32(pb); /* bytes per packet */
-                    sc->sample_size_v1.num = get_be32(pb); /* bytes per frame */
+                    sc->bytes_per_frame = get_be32(pb);
                     get_be32(pb); /* bytes per sample */
                 } else if(version==2) {
                     get_be32(pb); /* sizeof struct only */
@@ -1047,8 +837,9 @@
         st->codec->channels= 1; /* really needed */
         break;
     case CODEC_ID_MP2:
+    case CODEC_ID_MP3:
         st->codec->codec_type = CODEC_TYPE_AUDIO; /* force type after stsd for m1a hdlr */
-        st->need_parsing = 1;
+        st->need_parsing = AVSTREAM_PARSE_FULL;
         break;
     default:
         break;
@@ -1060,7 +851,7 @@
 static int mov_read_stsc(MOVContext *c, ByteIOContext *pb, MOV_atom_t atom)
 {
     AVStream *st = c->fc->streams[c->fc->nb_streams-1];
-    MOVStreamContext *sc = (MOVStreamContext *)st->priv_data;
+    MOVStreamContext *sc = st->priv_data;
     unsigned int i, entries;
 
     get_byte(pb); /* version */
@@ -1068,14 +859,13 @@
 
     entries = get_be32(pb);
 
-    if(entries >= UINT_MAX / sizeof(MOV_sample_to_chunk_tbl))
+    if(entries >= UINT_MAX / sizeof(MOV_stsc_t))
         return -1;
 
-#ifdef DEBUG
-av_log(NULL, AV_LOG_DEBUG, "track[%i].stsc.entries = %i\n", c->fc->nb_streams-1, entries);
-#endif
+    dprintf(c->fc, "track[%i].stsc.entries = %i\n", c->fc->nb_streams-1, entries);
+
     sc->sample_to_chunk_sz = entries;
-    sc->sample_to_chunk = av_malloc(entries * sizeof(MOV_sample_to_chunk_tbl));
+    sc->sample_to_chunk = av_malloc(entries * sizeof(MOV_stsc_t));
     if (!sc->sample_to_chunk)
         return -1;
     for(i=0; i<entries; i++) {
@@ -1089,7 +879,7 @@
 static int mov_read_stss(MOVContext *c, ByteIOContext *pb, MOV_atom_t atom)
 {
     AVStream *st = c->fc->streams[c->fc->nb_streams-1];
-    MOVStreamContext *sc = (MOVStreamContext *)st->priv_data;
+    MOVStreamContext *sc = st->priv_data;
     unsigned int i, entries;
 
     get_byte(pb); /* version */
@@ -1097,21 +887,19 @@
 
     entries = get_be32(pb);
 
-    if(entries >= UINT_MAX / sizeof(long))
+    if(entries >= UINT_MAX / sizeof(int))
         return -1;
 
     sc->keyframe_count = entries;
-#ifdef DEBUG
-    av_log(NULL, AV_LOG_DEBUG, "keyframe_count = %ld\n", sc->keyframe_count);
-#endif
-    sc->keyframes = av_malloc(entries * sizeof(long));
+
+    dprintf(c->fc, "keyframe_count = %d\n", sc->keyframe_count);
+
+    sc->keyframes = av_malloc(entries * sizeof(int));
     if (!sc->keyframes)
         return -1;
     for(i=0; i<entries; i++) {
         sc->keyframes[i] = get_be32(pb);
-#ifdef DEBUG
-/*        av_log(NULL, AV_LOG_DEBUG, "keyframes[]=%ld\n", sc->keyframes[i]); */
-#endif
+        //dprintf(c->fc, "keyframes[]=%d\n", sc->keyframes[i]);
     }
     return 0;
 }
@@ -1119,7 +907,7 @@
 static int mov_read_stsz(MOVContext *c, ByteIOContext *pb, MOV_atom_t atom)
 {
     AVStream *st = c->fc->streams[c->fc->nb_streams-1];
-    MOVStreamContext *sc = (MOVStreamContext *)st->priv_data;
+    MOVStreamContext *sc = st->priv_data;
     unsigned int i, entries, sample_size;
 
     get_byte(pb); /* version */
@@ -1129,24 +917,21 @@
     if (!sc->sample_size) /* do not overwrite value computed in stsd */
         sc->sample_size = sample_size;
     entries = get_be32(pb);
-    if(entries >= UINT_MAX / sizeof(long))
+    if(entries >= UINT_MAX / sizeof(int))
         return -1;
 
     sc->sample_count = entries;
     if (sample_size)
         return 0;
 
-#ifdef DEBUG
-    av_log(NULL, AV_LOG_DEBUG, "sample_size = %ld sample_count = %ld\n", sc->sample_size, sc->sample_count);
-#endif
-    sc->sample_sizes = av_malloc(entries * sizeof(long));
+    dprintf(c->fc, "sample_size = %d sample_count = %d\n", sc->sample_size, sc->sample_count);
+
+    sc->sample_sizes = av_malloc(entries * sizeof(int));
     if (!sc->sample_sizes)
         return -1;
     for(i=0; i<entries; i++) {
         sc->sample_sizes[i] = get_be32(pb);
-#ifdef DEBUG
-        av_log(NULL, AV_LOG_DEBUG, "sample_sizes[]=%ld\n", sc->sample_sizes[i]);
-#endif
+        dprintf(c->fc, "sample_sizes[]=%d\n", sc->sample_sizes[i]);
     }
     return 0;
 }
@@ -1154,7 +939,7 @@
 static int mov_read_stts(MOVContext *c, ByteIOContext *pb, MOV_atom_t atom)
 {
     AVStream *st = c->fc->streams[c->fc->nb_streams-1];
-    MOVStreamContext *sc = (MOVStreamContext *)st->priv_data;
+    MOVStreamContext *sc = st->priv_data;
     unsigned int i, entries;
     int64_t duration=0;
     int64_t total_sample_count=0;
@@ -1162,15 +947,13 @@
     get_byte(pb); /* version */
     get_byte(pb); get_byte(pb); get_byte(pb); /* flags */
     entries = get_be32(pb);
-    if(entries >= UINT_MAX / sizeof(Time2Sample))
+    if(entries >= UINT_MAX / sizeof(MOV_stts_t))
         return -1;
 
     sc->stts_count = entries;
-    sc->stts_data = av_malloc(entries * sizeof(Time2Sample));
+    sc->stts_data = av_malloc(entries * sizeof(MOV_stts_t));
 
-#ifdef DEBUG
-av_log(NULL, AV_LOG_DEBUG, "track[%i].stts.entries = %i\n", c->fc->nb_streams-1, entries);
-#endif
+    dprintf(c->fc, "track[%i].stts.entries = %i\n", c->fc->nb_streams-1, entries);
 
     sc->time_rate=0;
 
@@ -1185,7 +968,7 @@
 
         sc->time_rate= ff_gcd(sc->time_rate, sample_duration);
 
-        dprintf("sample_count=%d, sample_duration=%d\n",sample_count,sample_duration);
+        dprintf(c->fc, "sample_count=%d, sample_duration=%d\n",sample_count,sample_duration);
 
         duration+=(int64_t)sample_duration*sample_count;
         total_sample_count+=sample_count;
@@ -1200,19 +983,19 @@
 static int mov_read_ctts(MOVContext *c, ByteIOContext *pb, MOV_atom_t atom)
 {
     AVStream *st = c->fc->streams[c->fc->nb_streams-1];
-    MOVStreamContext *sc = (MOVStreamContext *)st->priv_data;
+    MOVStreamContext *sc = st->priv_data;
     unsigned int i, entries;
 
     get_byte(pb); /* version */
     get_byte(pb); get_byte(pb); get_byte(pb); /* flags */
     entries = get_be32(pb);
-    if(entries >= UINT_MAX / sizeof(Time2Sample))
+    if(entries >= UINT_MAX / sizeof(MOV_stts_t))
         return -1;
 
     sc->ctts_count = entries;
-    sc->ctts_data = av_malloc(entries * sizeof(Time2Sample));
+    sc->ctts_data = av_malloc(entries * sizeof(MOV_stts_t));
 
-    dprintf("track[%i].ctts.entries = %i\n", c->fc->nb_streams-1, entries);
+    dprintf(c->fc, "track[%i].ctts.entries = %i\n", c->fc->nb_streams-1, entries);
 
     for(i=0; i<entries; i++) {
         int count    =get_be32(pb);
@@ -1384,7 +1167,7 @@
         get_be32(pb); /* Media time */
         get_be32(pb); /* Media rate */
     }
-    dprintf("track[%i].edit_count = %i\n", c->fc->nb_streams-1, c->streams[c->fc->nb_streams-1]->edit_count);
+    dprintf(c->fc, "track[%i].edit_count = %i\n", c->fc->nb_streams-1, c->streams[c->fc->nb_streams-1]->edit_count);
     return 0;
 }
 
@@ -1395,9 +1178,10 @@
 { MKTAG( 'e', 'd', 't', 's' ), mov_read_default },
 { MKTAG( 'e', 'l', 's', 't' ), mov_read_elst },
 { MKTAG( 'e', 'n', 'd', 'a' ), mov_read_enda },
+{ MKTAG( 'f', 'i', 'e', 'l' ), mov_read_extradata },
 { MKTAG( 'f', 't', 'y', 'p' ), mov_read_ftyp },
 { MKTAG( 'h', 'd', 'l', 'r' ), mov_read_hdlr },
-{ MKTAG( 'j', 'p', '2', 'h' ), mov_read_jp2h },
+{ MKTAG( 'j', 'p', '2', 'h' ), mov_read_extradata },
 { MKTAG( 'm', 'd', 'a', 't' ), mov_read_mdat },
 { MKTAG( 'm', 'd', 'h', 'd' ), mov_read_mdhd },
 { MKTAG( 'm', 'd', 'i', 'a' ), mov_read_default },
@@ -1405,7 +1189,7 @@
 { MKTAG( 'm', 'o', 'o', 'v' ), mov_read_moov },
 { MKTAG( 'm', 'v', 'h', 'd' ), mov_read_mvhd },
 { MKTAG( 'S', 'M', 'I', ' ' ), mov_read_smi }, /* Sorenson extension ??? */
-{ MKTAG( 'a', 'l', 'a', 'c' ), mov_read_alac }, /* alac specific atom */
+{ MKTAG( 'a', 'l', 'a', 'c' ), mov_read_extradata }, /* alac specific atom */
 { MKTAG( 'a', 'v', 'c', 'C' ), mov_read_avcC },
 { MKTAG( 's', 't', 'b', 'l' ), mov_read_default },
 { MKTAG( 's', 't', 'c', 'o' ), mov_read_stco },
@@ -1417,21 +1201,12 @@
 { MKTAG( 't', 'k', 'h', 'd' ), mov_read_tkhd }, /* track header */
 { MKTAG( 't', 'r', 'a', 'k' ), mov_read_trak },
 { MKTAG( 'w', 'a', 'v', 'e' ), mov_read_wave },
-{ MKTAG( 'c', 't', 'a', 'b' ), mov_read_ctab },
 { MKTAG( 'e', 's', 'd', 's' ), mov_read_esds },
 { MKTAG( 'w', 'i', 'd', 'e' ), mov_read_wide }, /* place holder */
 { MKTAG( 'c', 'm', 'o', 'v' ), mov_read_cmov },
 { 0L, NULL }
 };
 
-static void mov_free_stream_context(MOVStreamContext *sc)
-{
-    if(sc) {
-        av_freep(&sc->ctts_data);
-        av_freep(&sc);
-    }
-}
-
 /* XXX: is it sufficient ? */
 static int mov_probe(AVProbeData *p)
 {
@@ -1440,8 +1215,6 @@
     int score = 0;
 
     /* check file header */
-    if (p->buf_size <= 12)
-        return 0;
     offset = 0;
     for(;;) {
         /* ignore invalid offset */
@@ -1457,6 +1230,7 @@
         case MKTAG( 'u', 'd', 't', 'a' ): /* Packet Video PVAuthor adds this and a lot of more junk */
             return AVPROBE_SCORE_MAX;
         /* those are more common words, so rate then a bit less */
+        case MKTAG( 'e', 'd', 'i', 'w' ): /* xdcam files have reverted first tags */
         case MKTAG( 'w', 'i', 'd', 'e' ):
         case MKTAG( 'f', 'r', 'e', 'e' ):
         case MKTAG( 'j', 'u', 'n', 'k' ):
@@ -1482,16 +1256,16 @@
     MOVStreamContext *sc = st->priv_data;
     offset_t current_offset;
     int64_t current_dts = 0;
-    int stts_index = 0;
-    int stsc_index = 0;
-    int stss_index = 0;
-    int i, j, k;
+    unsigned int stts_index = 0;
+    unsigned int stsc_index = 0;
+    unsigned int stss_index = 0;
+    unsigned int i, j, k;
 
     if (sc->sample_sizes || st->codec->codec_type == CODEC_TYPE_VIDEO || sc->dv_audio_container) {
-        int keyframe, sample_size;
-        int current_sample = 0;
-        int stts_sample = 0;
-        int distance = 0;
+        unsigned int current_sample = 0;
+        unsigned int stts_sample = 0;
+        unsigned int keyframe, sample_size;
+        unsigned int distance = 0;
 
         st->nb_frames = sc->sample_count;
         for (i = 0; i < sc->chunk_count; i++) {
@@ -1499,6 +1273,10 @@
             if (stsc_index + 1 < sc->sample_to_chunk_sz && i + 1 == sc->sample_to_chunk[stsc_index + 1].first)
                 stsc_index++;
             for (j = 0; j < sc->sample_to_chunk[stsc_index].count; j++) {
+                if (current_sample >= sc->sample_count) {
+                    av_log(mov->fc, AV_LOG_ERROR, "wrong sample count\n");
+                    goto out;
+                }
                 keyframe = !sc->keyframe_count || current_sample + 1 == sc->keyframes[stss_index];
                 if (keyframe) {
                     distance = 0;
@@ -1506,7 +1284,7 @@
                         stss_index++;
                 }
                 sample_size = sc->sample_size > 0 ? sc->sample_size : sc->sample_sizes[current_sample];
-                dprintf("AVIndex stream %d, sample %d, offset %"PRIx64", dts %"PRId64", size %d, distance %d, keyframe %d\n",
+                dprintf(mov->fc, "AVIndex stream %d, sample %d, offset %"PRIx64", dts %"PRId64", size %d, distance %d, keyframe %d\n",
                         st->index, current_sample, current_offset, current_dts, sample_size, distance, keyframe);
                 av_add_index_entry(st, current_offset, current_dts, sample_size, distance, keyframe ? AVINDEX_KEYFRAME : 0);
                 current_offset += sample_size;
@@ -1514,8 +1292,7 @@
                 current_dts += sc->stts_data[stts_index].duration / sc->time_rate;
                 distance++;
                 stts_sample++;
-                if (current_sample + 1 < sc->sample_count)
-                    current_sample++;
+                current_sample++;
                 if (stts_index + 1 < sc->stts_count && stts_sample == sc->stts_data[stts_index].count) {
                     stts_sample = 0;
                     stts_index++;
@@ -1523,7 +1300,7 @@
             }
         }
     } else { /* read whole chunk */
-        int chunk_samples, chunk_size, chunk_duration;
+        unsigned int chunk_samples, chunk_size, chunk_duration;
 
         for (i = 0; i < sc->chunk_count; i++) {
             current_offset = sc->chunk_offsets[i];
@@ -1533,8 +1310,8 @@
             /* get chunk size */
             if (sc->sample_size > 1 || st->codec->codec_id == CODEC_ID_PCM_U8 || st->codec->codec_id == CODEC_ID_PCM_S8)
                 chunk_size = chunk_samples * sc->sample_size;
-            else if (sc->sample_size_v1.den > 0 && (chunk_samples * sc->sample_size_v1.num % sc->sample_size_v1.den == 0))
-                chunk_size = chunk_samples * sc->sample_size_v1.num / sc->sample_size_v1.den;
+            else if (sc->samples_per_frame > 0 && (chunk_samples * sc->bytes_per_frame % sc->samples_per_frame == 0))
+                chunk_size = chunk_samples * sc->bytes_per_frame / sc->samples_per_frame;
             else { /* workaround to find nearest next chunk offset */
                 chunk_size = INT_MAX;
                 for (j = 0; j < mov->total_streams; j++) {
@@ -1551,7 +1328,7 @@
                 /* check for last chunk */
                 if (chunk_size == INT_MAX)
                     for (j = 0; j < mov->mdat_count; j++) {
-                        dprintf("mdat %d, offset %"PRIx64", size %"PRId64", current offset %"PRIx64"\n",
+                        dprintf(mov->fc, "mdat %d, offset %"PRIx64", size %"PRId64", current offset %"PRIx64"\n",
                                 j, mov->mdat_list[j].offset, mov->mdat_list[j].size, current_offset);
                         if (mov->mdat_list[j].offset <= current_offset && mov->mdat_list[j].offset + mov->mdat_list[j].size > current_offset)
                             chunk_size = mov->mdat_list[j].offset + mov->mdat_list[j].size - current_offset;
@@ -1577,19 +1354,20 @@
                     }
                 }
             }
-            dprintf("AVIndex stream %d, chunk %d, offset %"PRIx64", dts %"PRId64", size %d, duration %d\n",
+            dprintf(mov->fc, "AVIndex stream %d, chunk %d, offset %"PRIx64", dts %"PRId64", size %d, duration %d\n",
                     st->index, i, current_offset, current_dts, chunk_size, chunk_duration);
             assert(chunk_duration % sc->time_rate == 0);
             current_dts += chunk_duration / sc->time_rate;
         }
     }
+ out:
     /* adjust sample count to avindex entries */
     sc->sample_count = st->nb_index_entries;
 }
 
 static int mov_read_header(AVFormatContext *s, AVFormatParameters *ap)
 {
-    MOVContext *mov = (MOVContext *) s->priv_data;
+    MOVContext *mov = s->priv_data;
     ByteIOContext *pb = &s->pb;
     int i, err;
     MOV_atom_t atom = { 0, 0, 0 };
@@ -1600,7 +1378,7 @@
     if(!url_is_streamed(pb)) /* .mov and .mp4 aren't streamable anyway (only progressive download if moov is before mdat) */
         atom.size = url_fsize(pb);
     else
-        atom.size = 0x7FFFFFFFFFFFFFFFLL;
+        atom.size = INT64_MAX;
 
     /* check MOV header */
     err = mov_read_default(mov, pb, atom);
@@ -1609,7 +1387,7 @@
                 err, mov->found_moov, mov->found_mdat, url_ftell(pb));
         return -1;
     }
-    dprintf("on_parse_exit_offset=%d\n", (int) url_ftell(pb));
+    dprintf(mov->fc, "on_parse_exit_offset=%d\n", (int) url_ftell(pb));
 
     /* some cleanup : make sure we are on the mdat atom */
     if(!url_is_streamed(pb) && (url_ftell(pb) != mov->mdat_offset))
@@ -1619,23 +1397,33 @@
 
     for(i=0; i<mov->total_streams; i++) {
         MOVStreamContext *sc = mov->streams[i];
-
+        AVStream *st = s->streams[i];
+        /* sanity checks */
+        if(!sc->stts_count || !sc->chunk_count || !sc->sample_to_chunk_sz ||
+           (!sc->sample_size && !sc->sample_count)){
+            av_log(s, AV_LOG_ERROR, "missing mandatory atoms, broken header\n");
+            sc->sample_count = 0; //ignore track
+            continue;
+        }
         if(!sc->time_rate)
             sc->time_rate=1;
         if(!sc->time_scale)
             sc->time_scale= mov->time_scale;
-        av_set_pts_info(s->streams[i], 64, sc->time_rate, sc->time_scale);
+        av_set_pts_info(st, 64, sc->time_rate, sc->time_scale);
 
-        if(s->streams[i]->duration != AV_NOPTS_VALUE){
-            assert(s->streams[i]->duration % sc->time_rate == 0);
-            s->streams[i]->duration /= sc->time_rate;
+        if (st->codec->codec_type == CODEC_TYPE_AUDIO && sc->stts_count == 1)
+            st->codec->frame_size = sc->stts_data[0].duration;
+
+        if(st->duration != AV_NOPTS_VALUE){
+            assert(st->duration % sc->time_rate == 0);
+            st->duration /= sc->time_rate;
         }
         sc->ffindex = i;
-        mov_build_index(mov, s->streams[i]);
+        mov_build_index(mov, st);
     }
 
     for(i=0; i<mov->total_streams; i++) {
-        /* dont need those anymore */
+        /* Do not need those anymore. */
         av_freep(&mov->streams[i]->chunk_offsets);
         av_freep(&mov->streams[i]->sample_to_chunk);
         av_freep(&mov->streams[i]->sample_sizes);
@@ -1661,7 +1449,7 @@
             AVIndexEntry *current_sample = &s->streams[i]->index_entries[msc->current_sample];
             int64_t dts = av_rescale(current_sample->timestamp * (int64_t)msc->time_rate, AV_TIME_BASE, msc->time_scale);
 
-            dprintf("stream %d, sample %ld, dts %"PRId64"\n", i, msc->current_sample, dts);
+            dprintf(s, "stream %d, sample %d, dts %"PRId64"\n", i, msc->current_sample, dts);
             if (dts < best_dts) {
                 sample = current_sample;
                 best_dts = dts;
@@ -1680,7 +1468,7 @@
 #ifdef CONFIG_DV_DEMUXER
     if (sc->dv_audio_container) {
         dv_get_packet(mov->dv_demux, pkt);
-        dprintf("dv audio pkt size %d\n", pkt->size);
+        dprintf(s, "dv audio pkt size %d\n", pkt->size);
     } else {
 #endif
         url_fseek(&s->pb, sample->pos, SEEK_SET);
@@ -1709,7 +1497,7 @@
     }
     pkt->flags |= sample->flags & AVINDEX_KEYFRAME ? PKT_FLAG_KEY : 0;
     pkt->pos = sample->pos;
-    dprintf("stream %d, pts %"PRId64", dts %"PRId64", pos 0x%"PRIx64", duration %d\n", pkt->stream_index, pkt->pts, pkt->dts, pkt->pos, pkt->duration);
+    dprintf(s, "stream %d, pts %"PRId64", dts %"PRId64", pos 0x%"PRIx64", duration %d\n", pkt->stream_index, pkt->pts, pkt->dts, pkt->pos, pkt->duration);
     return 0;
 }
 
@@ -1720,21 +1508,22 @@
     int i;
 
     sample = av_index_search_timestamp(st, timestamp, flags);
-    dprintf("stream %d, timestamp %"PRId64", sample %d\n", st->index, timestamp, sample);
+    dprintf(st->codec, "stream %d, timestamp %"PRId64", sample %d\n", st->index, timestamp, sample);
     if (sample < 0) /* not sure what to do */
         return -1;
     sc->current_sample = sample;
-    dprintf("stream %d, found sample %ld\n", st->index, sc->current_sample);
+    dprintf(st->codec, "stream %d, found sample %d\n", st->index, sc->current_sample);
     /* adjust ctts index */
     if (sc->ctts_data) {
         time_sample = 0;
         for (i = 0; i < sc->ctts_count; i++) {
-            time_sample += sc->ctts_data[i].count;
-            if (time_sample >= sc->current_sample) {
+            int next = time_sample + sc->ctts_data[i].count;
+            if (next > sc->current_sample) {
                 sc->sample_to_ctime_index = i;
-                sc->sample_to_ctime_sample = time_sample - sc->current_sample;
+                sc->sample_to_ctime_sample = sc->current_sample - time_sample;
                 break;
             }
+            time_sample = next;
         }
     }
     return sample;
@@ -1772,12 +1561,11 @@
 static int mov_read_close(AVFormatContext *s)
 {
     int i;
-    MOVContext *mov = (MOVContext *) s->priv_data;
-    for(i=0; i<mov->total_streams; i++)
-        mov_free_stream_context(mov->streams[i]);
-    /* free color tabs */
-    for(i=0; i<mov->ctab_size; i++)
-        av_freep(&mov->ctab[i]);
+    MOVContext *mov = s->priv_data;
+    for(i=0; i<mov->total_streams; i++) {
+        av_freep(&mov->streams[i]->ctts_data);
+        av_freep(&mov->streams[i]);
+    }
     if(mov->dv_demux){
         for(i=0; i<mov->dv_fctx->nb_streams; i++){
             av_freep(&mov->dv_fctx->streams[i]->codec);
@@ -1786,7 +1574,6 @@
         av_freep(&mov->dv_fctx);
         av_freep(&mov->dv_demux);
     }
-    av_freep(&mov->ctab);
     return 0;
 }
 

Modified: branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavformat/movenc.c
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavformat/movenc.c	2007-07-16 16:39:52 UTC (rev 3382)
+++ branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavformat/movenc.c	2007-07-16 17:44:22 UTC (rev 3383)
@@ -19,8 +19,6 @@
  * License along with FFmpeg; if not, write to the Free Software
  * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA
  */
-#include "config.h" 
-#define MEANX_PUT_MP3_IN_MP4A //MEANX
 #include "avformat.h"
 #include "riff.h"
 #include "avio.h"
@@ -43,6 +41,8 @@
 extern int ADM_useAlternateTagging(void);
 // MEANX
 
+
+
 typedef struct MOVIentry {
     unsigned int flags, size;
     uint64_t     pos;
@@ -84,7 +84,7 @@
     MOVTrack tracks[MAX_STREAMS];
 } MOVContext;
 
-//FIXME supprt 64bit varaint with wide placeholders
+//FIXME support 64 bit variant with wide placeholders
 static offset_t updateSize (ByteIOContext *pb, offset_t pos)
 {
     offset_t curpos = url_ftell(pb);
@@ -249,7 +249,7 @@
 
 static int mov_write_esds_tag(ByteIOContext *pb, MOVTrack* track) // Basic
 {
-  int codec_id;
+int codec_id; // MEANX
     offset_t pos = url_ftell(pb);
     int decoderSpecificInfoLen = track->vosLen ? descrLength(track->vosLen):0;
 
@@ -267,11 +267,13 @@
     putDescr(pb, 0x04, 13 + decoderSpecificInfoLen);
 
     // Object type indication
-    // MEANX
+  //MEANX  put_byte(pb, codec_get_tag(ff_mp4_obj_type, track->enc->codec_id));
+ // MEANX
     codec_id=track->enc->codec_id;
     if(ADM_useAlternateTagging() && codec_id==CODEC_ID_MP3) codec_id=CODEC_ID_MP2;
-    put_byte(pb, codec_get_tag(ff_mov_obj_type, codec_id));
+    put_byte(pb, codec_get_tag(ff_mp4_obj_type, codec_id));
     // /MEANX
+
     // the following fields is made of 6 bits to identify the streamtype (4 for video, 5 for audio)
     // plus 1 bit to indicate upstream and 1 bit set to 1 (reserved)
     if(track->enc->codec_type == CODEC_TYPE_AUDIO)
@@ -332,33 +334,6 @@
     return updateSize (pb, pos);
 }
 
-static const AVCodecTag codec_movaudio_tags[] = {
-    { CODEC_ID_PCM_MULAW, MKTAG('u', 'l', 'a', 'w') },
-    { CODEC_ID_PCM_ALAW, MKTAG('a', 'l', 'a', 'w') },
-    { CODEC_ID_ADPCM_IMA_QT, MKTAG('i', 'm', 'a', '4') },
-    { CODEC_ID_MACE3, MKTAG('M', 'A', 'C', '3') },
-    { CODEC_ID_MACE6, MKTAG('M', 'A', 'C', '6') },
-    { CODEC_ID_AAC, MKTAG('m', 'p', '4', 'a') },
-    { CODEC_ID_AMR_NB, MKTAG('s', 'a', 'm', 'r') },
-    { CODEC_ID_AMR_WB, MKTAG('s', 'a', 'w', 'b') },
-    { CODEC_ID_PCM_S16BE, MKTAG('t', 'w', 'o', 's') },
-    { CODEC_ID_PCM_S16LE, MKTAG('s', 'o', 'w', 't') },
-    { CODEC_ID_PCM_S24BE, MKTAG('i', 'n', '2', '4') },
-    { CODEC_ID_PCM_S24LE, MKTAG('i', 'n', '2', '4') },
-    { CODEC_ID_PCM_S32BE, MKTAG('i', 'n', '3', '2') },
-    { CODEC_ID_PCM_S32LE, MKTAG('i', 'n', '3', '2') },
-    //{ CODEC_ID_MP3, MKTAG('.', 'm', 'p', '3') },
-   // MEANX
-#ifdef MEANX_PUT_MP3_IN_MP4A
-    { CODEC_ID_MP3, MKTAG( 'm', 'p', '4','a') },
-#else
-    { CODEC_ID_MP3, MKTAG('.', 'm', 'p', '3') },
-#endif
-//MEANX
-
-    { CODEC_ID_NONE, 0 },
-};
-
 static int mov_write_audio_tag(ByteIOContext *pb, MOVTrack* track)
 {
     offset_t pos = url_ftell(pb);
@@ -378,11 +353,20 @@
     put_be16(pb, 0); /* Revision level */
     put_be32(pb, 0); /* Reserved */
 
-    put_be16(pb, track->mode == MODE_MOV ? track->enc->channels : 2); /* Number of channels */
-    /* FIXME 8 bit for 'raw ' in mov */
-    put_be16(pb, 16); /* Reserved */
+    if (track->mode == MODE_MOV) {
+        put_be16(pb, track->enc->channels);
+        if (track->enc->codec_id == CODEC_ID_PCM_U8 ||
+            track->enc->codec_id == CODEC_ID_PCM_S8)
+            put_be16(pb, 8); /* bits per sample */
+        else
+            put_be16(pb, 16);
+        put_be16(pb, track->audio_vbr ? -2 : 0); /* compression ID */
+    } else { /* reserved for mp4/3gp */
+        put_be16(pb, 2);
+        put_be16(pb, 16);
+        put_be16(pb, 0);
+    }
 
-    put_be16(pb, track->mode == MODE_MOV && track->audio_vbr ? -2 : 0); /* compression ID */
     put_be16(pb, 0); /* packet size (= 0) */
     put_be16(pb, track->timescale); /* Time scale */
     put_be16(pb, 0); /* Reserved */
@@ -400,15 +384,8 @@
         track->enc->codec_id == CODEC_ID_PCM_S24LE ||
         track->enc->codec_id == CODEC_ID_PCM_S32LE))
         mov_write_wave_tag(pb, track);
-    else if(track->enc->codec_id == CODEC_ID_AAC
- //MEANX
-#ifdef MEANX_PUT_MP3_IN_MP4A
-   || track->enc->codec_id == CODEC_ID_MP3
-#endif
-//MEANX
- 
-    
-    )
+    else if(track->enc->codec_id == CODEC_ID_AAC // MEANX)
+       || track->enc->codec_id == CODEC_ID_MP3) // MEANX
         mov_write_esds_tag(pb, track);
     else if(track->enc->codec_id == CODEC_ID_AMR_NB)
         mov_write_amr_tag(pb, track);
@@ -443,7 +420,7 @@
 
 static uint8_t *avc_find_startcode( uint8_t *p, uint8_t *end )
 {
-    uint8_t *a = p + 4 - ((int)p & 3);
+    uint8_t *a = p + 4 - ((long)p & 3);
 
     for( end -= 3; p < a && p < end; p++ ) {
         if( p[0] == 0 && p[1] == 0 && p[2] == 1 )
@@ -552,22 +529,6 @@
     return updateSize(pb, pos);
 }
 
-static const AVCodecTag codec_movvideo_tags[] = {
-    { CODEC_ID_SVQ1, MKTAG('S', 'V', 'Q', '1') },
-    { CODEC_ID_SVQ3, MKTAG('S', 'V', 'Q', '3') },
-    { CODEC_ID_MPEG4, MKTAG('m', 'p', '4', 'v') },
-    { CODEC_ID_H263, MKTAG('h', '2', '6', '3') },
-    { CODEC_ID_H263, MKTAG('s', '2', '6', '3') },
-    { CODEC_ID_H264, MKTAG('a', 'v', 'c', '1') },
-    /* special handling in mov_find_video_codec_tag */
-    { CODEC_ID_DVVIDEO, MKTAG('d', 'v', 'c', ' ') }, /* DV NTSC */
-    { CODEC_ID_DVVIDEO, MKTAG('d', 'v', 'c', 'p') }, /* DV PAL */
-    { CODEC_ID_DVVIDEO, MKTAG('d', 'v', 'p', 'p') }, /* DVCPRO PAL */
-    { CODEC_ID_DVVIDEO, MKTAG('d', 'v', '5', 'n') }, /* DVCPRO50 NTSC */
-    { CODEC_ID_DVVIDEO, MKTAG('d', 'v', '5', 'p') }, /* DVCPRO50 PAL */
-    { CODEC_ID_NONE, 0 },
-};
-
 static int mov_find_video_codec_tag(AVFormatContext *s, MOVTrack *track)
 {
     int tag = track->enc->codec_tag;
@@ -695,7 +656,7 @@
 
 static int mov_write_ctts_tag(ByteIOContext *pb, MOVTrack* track)
 {
-    Time2Sample *ctts_entries;
+    MOV_stts_t *ctts_entries;
     uint32_t entries = 0;
     uint32_t atom_size;
     int i;
@@ -729,7 +690,7 @@
 /* Time to sample atom */
 static int mov_write_stts_tag(ByteIOContext *pb, MOVTrack* track)
 {
-    Time2Sample *stts_entries;
+    MOV_stts_t *stts_entries;
     uint32_t entries = -1;
     uint32_t atom_size;
     int i;
@@ -897,6 +858,14 @@
     (version == 1) ? put_be64(pb, track->trackDuration) : put_be32(pb, track->trackDuration); /* duration */
     put_be16(pb, track->language); /* language */
     put_be16(pb, 0); /* reserved (quality) */
+
+    if(version!=0 && track->mode == MODE_MOV){
+        av_log(NULL, AV_LOG_ERROR,
+            "FATAL error, file duration too long for timebase, this file will not be\n"
+            "playable with quicktime. Choose a different timebase or a different\n"
+            "container format\n");
+    }
+
     return 32;
 }
 
@@ -978,11 +947,12 @@
 
     put_be32(pb, av_rescale_rnd(track->trackDuration, globalTimescale, track->timescale, AV_ROUND_UP)); /* duration   ... doesn't seem to effect psp */
 
-    //MEANX NO put_be32(pb, track->cluster[0].cts); /* first pts is cts since dts is 0 */
-    put_be32(pb, 0x00000000);
+    // MEANX : NO put_be32(pb, track->cluster[0].cts); /* first pts is cts since dts is 0 */
+      put_be32(pb, 0x00000000);
     // /MEANX
 
-    put_be32(pb, 0x1); // MEANXput_be32(pb, 0x00010000);
+
+    put_be32(pb, 0x0001); // MEANX put_be32(pb, 0x00010000);
     return 0x24;
 }
 
@@ -1229,7 +1199,7 @@
     /* iTunes meta data */
     mov_write_meta_tag(pb, mov, s);
 
-  if(mov->mode == MODE_MOV){ // the title field breaks gtkpod with mp4 and my suspicion is that stuff isnt valid in mp4
+  if(mov->mode == MODE_MOV){ // the title field breaks gtkpod with mp4 and my suspicion is that stuff is not valid in mp4
     /* Requirements */
     for (i=0; i<mov->nb_streams; i++) {
         if(mov->tracks[i].entry <= 0) continue;
@@ -1500,6 +1470,11 @@
     MOVContext *mov = s->priv_data;
     int i;
 
+    if (url_is_streamed(&s->pb)) {
+        av_log(s, AV_LOG_ERROR, "muxer does not support non seekable output\n");
+        return -1;
+    }
+
     /* Default mode == MP4 */
     mov->mode = MODE_MP4;
 
@@ -1530,24 +1505,23 @@
             track->tag = mov_find_video_codec_tag(s, track);
             track->timescale = st->codec->time_base.den;
             av_set_pts_info(st, 64, 1, st->codec->time_base.den);
+            if (track->timescale > 100000)
+                av_log(NULL, AV_LOG_WARNING,
+                       "WARNING codec timebase is very high. If duration is too long,\n"
+                       "file may not be playable by quicktime. Specify a shorter timebase\n"
+                       "or choose different container.\n");
         }else if(st->codec->codec_type == CODEC_TYPE_AUDIO){
             track->tag = mov_find_audio_codec_tag(s, track);
             track->timescale = st->codec->sample_rate;
             av_set_pts_info(st, 64, 1, st->codec->sample_rate);
-            switch(track->enc->codec_id){
-            case CODEC_ID_MP3:
-            case CODEC_ID_AAC:
-            case CODEC_ID_AMR_NB:
-            case CODEC_ID_AMR_WB:
+            if(!st->codec->frame_size){
+                av_log(s, AV_LOG_ERROR, "track %d: codec frame size is not set\n", i);
+                return -1;
+            }else if(st->codec->frame_size > 1){ /* assume compressed audio */
                 track->audio_vbr = 1;
-                break;
-            default:
+            }else{
                 track->sampleSize = (av_get_bits_per_sample(st->codec->codec_id) >> 3) * st->codec->channels;
             }
-            if (!st->codec->frame_size) {
-                av_log(s, AV_LOG_ERROR, "track %d: codec frame size is not set\n", i);
-                return -1;
-            }
         }
     }
 

Modified: branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavformat/mpeg.c
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavformat/mpeg.c	2007-07-16 16:39:52 UTC (rev 3382)
+++ branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavformat/mpeg.c	2007-07-16 17:44:22 UTC (rev 3383)
@@ -1,5 +1,5 @@
 /*
- * MPEG1/2 muxer and demuxer
+ * MPEG1/2 demuxer
  * Copyright (c) 2000, 2001, 2002 Fabrice Bellard.
  *
  * This file is part of FFmpeg.
@@ -18,1240 +18,15 @@
  * License along with FFmpeg; if not, write to the Free Software
  * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA
  */
+
 #include "avformat.h"
-#include "bitstream.h"
-#include "fifo.h"
+#include "mpeg.h"
 
-#define MAX_PAYLOAD_SIZE 4096
 //#define DEBUG_SEEK
 
 #undef NDEBUG
 #include <assert.h>
 
-typedef struct PacketDesc {
-    int64_t pts;
-    int64_t dts;
-    int size;
-    int unwritten_size;
-    int flags;
-    struct PacketDesc *next;
-} PacketDesc;
-
-typedef struct {
-    AVFifoBuffer fifo;
-    uint8_t id;
-    int max_buffer_size; /* in bytes */
-    int buffer_index;
-    PacketDesc *predecode_packet;
-    PacketDesc *premux_packet;
-    PacketDesc **next_packet;
-    int packet_number;
-    uint8_t lpcm_header[3];
-    int lpcm_align;
-    int bytes_to_iframe;
-    int align_iframe;
-    int64_t vobu_start_pts;
-} StreamInfo;
-
-typedef struct {
-    int packet_size; /* required packet size */
-    int packet_number;
-    int pack_header_freq;     /* frequency (in packets^-1) at which we send pack headers */
-    int system_header_freq;
-    int system_header_size;
-    int mux_rate; /* bitrate in units of 50 bytes/s */
-    /* stream info */
-    int audio_bound;
-    int video_bound;
-    int is_mpeg2;
-    int is_vcd;
-    int is_svcd;
-    int is_dvd;
-    int64_t last_scr; /* current system clock */
-
-    double vcd_padding_bitrate; //FIXME floats
-    int64_t vcd_padding_bytes_written;
-
-} MpegMuxContext;
-
-#define PACK_START_CODE             ((unsigned int)0x000001ba)
-#define SYSTEM_HEADER_START_CODE    ((unsigned int)0x000001bb)
-#define SEQUENCE_END_CODE           ((unsigned int)0x000001b7)
-#define PACKET_START_CODE_MASK      ((unsigned int)0xffffff00)
-#define PACKET_START_CODE_PREFIX    ((unsigned int)0x00000100)
-#define ISO_11172_END_CODE          ((unsigned int)0x000001b9)
-
-/* mpeg2 */
-#define PROGRAM_STREAM_MAP 0x1bc
-#define PRIVATE_STREAM_1   0x1bd
-#define PADDING_STREAM     0x1be
-#define PRIVATE_STREAM_2   0x1bf
-
-
-#define AUDIO_ID 0xc0
-#define VIDEO_ID 0xe0
-#define AC3_ID   0x80
-#define DTS_ID   0x8a
-#define LPCM_ID  0xa0
-#define SUB_ID   0x20
-
-#define STREAM_TYPE_VIDEO_MPEG1     0x01
-#define STREAM_TYPE_VIDEO_MPEG2     0x02
-#define STREAM_TYPE_AUDIO_MPEG1     0x03
-#define STREAM_TYPE_AUDIO_MPEG2     0x04
-#define STREAM_TYPE_PRIVATE_SECTION 0x05
-#define STREAM_TYPE_PRIVATE_DATA    0x06
-#define STREAM_TYPE_AUDIO_AAC       0x0f
-#define STREAM_TYPE_VIDEO_MPEG4     0x10
-#define STREAM_TYPE_VIDEO_H264      0x1b
-
-#define STREAM_TYPE_AUDIO_AC3       0x81
-#define STREAM_TYPE_AUDIO_DTS       0x8a
-
-static const int lpcm_freq_tab[4] = { 48000, 96000, 44100, 32000 };
-
-#ifdef CONFIG_MUXERS
-AVOutputFormat mpeg1system_muxer;
-AVOutputFormat mpeg1vcd_muxer;
-AVOutputFormat mpeg2vob_muxer;
-AVOutputFormat mpeg2svcd_muxer;
-AVOutputFormat mpeg2dvd_muxer;
-
-static int put_pack_header(AVFormatContext *ctx,
-                           uint8_t *buf, int64_t timestamp)
-{
-    MpegMuxContext *s = ctx->priv_data;
-    PutBitContext pb;
-
-    init_put_bits(&pb, buf, 128);
-
-    put_bits(&pb, 32, PACK_START_CODE);
-    if (s->is_mpeg2) {
-        put_bits(&pb, 2, 0x1);
-    } else {
-        put_bits(&pb, 4, 0x2);
-    }
-    put_bits(&pb, 3, (uint32_t)((timestamp >> 30) & 0x07));
-    put_bits(&pb, 1, 1);
-    put_bits(&pb, 15, (uint32_t)((timestamp >> 15) & 0x7fff));
-    put_bits(&pb, 1, 1);
-    put_bits(&pb, 15, (uint32_t)((timestamp) & 0x7fff));
-    put_bits(&pb, 1, 1);
-    if (s->is_mpeg2) {
-        /* clock extension */
-        put_bits(&pb, 9, 0);
-    }
-    put_bits(&pb, 1, 1);
-    put_bits(&pb, 22, s->mux_rate);
-    put_bits(&pb, 1, 1);
-    if (s->is_mpeg2) {
-        put_bits(&pb, 1, 1);
-        put_bits(&pb, 5, 0x1f); /* reserved */
-        put_bits(&pb, 3, 0); /* stuffing length */
-    }
-    flush_put_bits(&pb);
-    return pbBufPtr(&pb) - pb.buf;
-}
-
-static int put_system_header(AVFormatContext *ctx, uint8_t *buf,int only_for_stream_id)
-{
-    MpegMuxContext *s = ctx->priv_data;
-    int size, i, private_stream_coded, id;
-    PutBitContext pb;
-
-    init_put_bits(&pb, buf, 128);
-
-    put_bits(&pb, 32, SYSTEM_HEADER_START_CODE);
-    put_bits(&pb, 16, 0);
-    put_bits(&pb, 1, 1);
-
-    put_bits(&pb, 22, s->mux_rate); /* maximum bit rate of the multiplexed stream */
-    put_bits(&pb, 1, 1); /* marker */
-    if (s->is_vcd && only_for_stream_id==VIDEO_ID) {
-        /* This header applies only to the video stream (see VCD standard p. IV-7)*/
-        put_bits(&pb, 6, 0);
-    } else
-        put_bits(&pb, 6, s->audio_bound);
-
-    if (s->is_vcd) {
-        /* see VCD standard, p. IV-7*/
-        put_bits(&pb, 1, 0);
-        put_bits(&pb, 1, 1);
-    } else {
-        put_bits(&pb, 1, 0); /* variable bitrate*/
-        put_bits(&pb, 1, 0); /* non constrainted bit stream */
-    }
-
-    if (s->is_vcd || s->is_dvd) {
-        /* see VCD standard p IV-7 */
-        put_bits(&pb, 1, 1); /* audio locked */
-        put_bits(&pb, 1, 1); /* video locked */
-    } else {
-        put_bits(&pb, 1, 0); /* audio locked */
-        put_bits(&pb, 1, 0); /* video locked */
-    }
-
-    put_bits(&pb, 1, 1); /* marker */
-
-    if (s->is_vcd && only_for_stream_id==AUDIO_ID) {
-        /* This header applies only to the audio stream (see VCD standard p. IV-7)*/
-        put_bits(&pb, 5, 0);
-    } else
-        put_bits(&pb, 5, s->video_bound);
-
-    if (s->is_dvd) {
-        put_bits(&pb, 1, 0);    /* packet_rate_restriction_flag */
-        put_bits(&pb, 7, 0x7f); /* reserved byte */
-    } else
-        put_bits(&pb, 8, 0xff); /* reserved byte */
-
-    /* DVD-Video Stream_bound entries
-    id (0xB9) video, maximum P-STD for stream 0xE0. (P-STD_buffer_bound_scale = 1)
-    id (0xB8) audio, maximum P-STD for any MPEG audio (0xC0 to 0xC7) streams. If there are none set to 4096 (32x128). (P-STD_buffer_bound_scale = 0)
-    id (0xBD) private stream 1 (audio other than MPEG and subpictures). (P-STD_buffer_bound_scale = 1)
-    id (0xBF) private stream 2, NAV packs, set to 2x1024. */
-    if (s->is_dvd) {
-
-        int P_STD_max_video = 0;
-        int P_STD_max_mpeg_audio = 0;
-        int P_STD_max_mpeg_PS1 = 0;
-
-        for(i=0;i<ctx->nb_streams;i++) {
-            StreamInfo *stream = ctx->streams[i]->priv_data;
-
-            id = stream->id;
-            if (id == 0xbd && stream->max_buffer_size > P_STD_max_mpeg_PS1) {
-                P_STD_max_mpeg_PS1 = stream->max_buffer_size;
-            } else if (id >= 0xc0 && id <= 0xc7 && stream->max_buffer_size > P_STD_max_mpeg_audio) {
-                P_STD_max_mpeg_audio = stream->max_buffer_size;
-            } else if (id == 0xe0 && stream->max_buffer_size > P_STD_max_video) {
-                P_STD_max_video = stream->max_buffer_size;
-            }
-        }
-
-        /* video */
-        put_bits(&pb, 8, 0xb9); /* stream ID */
-        put_bits(&pb, 2, 3);
-        put_bits(&pb, 1, 1);
-        put_bits(&pb, 13, P_STD_max_video / 1024);
-
-        /* audio */
-        if (P_STD_max_mpeg_audio == 0)
-            P_STD_max_mpeg_audio = 4096;
-        put_bits(&pb, 8, 0xb8); /* stream ID */
-        put_bits(&pb, 2, 3);
-        put_bits(&pb, 1, 0);
-        put_bits(&pb, 13, P_STD_max_mpeg_audio / 128);
-
-        /* private stream 1 */
-        put_bits(&pb, 8, 0xbd); /* stream ID */
-        put_bits(&pb, 2, 3);
-        put_bits(&pb, 1, 0);
-        put_bits(&pb, 13, P_STD_max_mpeg_PS1 / 128);
-
-        /* private stream 2 */
-        put_bits(&pb, 8, 0xbf); /* stream ID */
-        put_bits(&pb, 2, 3);
-        put_bits(&pb, 1, 1);
-        put_bits(&pb, 13, 2);
-    }
-    else {
-        /* audio stream info */
-        private_stream_coded = 0;
-        for(i=0;i<ctx->nb_streams;i++) {
-            StreamInfo *stream = ctx->streams[i]->priv_data;
-
-
-            /* For VCDs, only include the stream info for the stream
-            that the pack which contains this system belongs to.
-            (see VCD standard p. IV-7) */
-            if ( !s->is_vcd || stream->id==only_for_stream_id
-                || only_for_stream_id==0) {
-
-                id = stream->id;
-                if (id < 0xc0) {
-                    /* special case for private streams (AC3 use that) */
-                    if (private_stream_coded)
-                        continue;
-                    private_stream_coded = 1;
-                    id = 0xbd;
-                }
-                put_bits(&pb, 8, id); /* stream ID */
-                put_bits(&pb, 2, 3);
-                if (id < 0xe0) {
-                    /* audio */
-                    put_bits(&pb, 1, 0);
-                    put_bits(&pb, 13, stream->max_buffer_size / 128);
-                } else {
-                    /* video */
-                    put_bits(&pb, 1, 1);
-                    put_bits(&pb, 13, stream->max_buffer_size / 1024);
-                }
-            }
-        }
-    }
-
-    flush_put_bits(&pb);
-    size = pbBufPtr(&pb) - pb.buf;
-    /* patch packet size */
-    buf[4] = (size - 6) >> 8;
-    buf[5] = (size - 6) & 0xff;
-
-    return size;
-}
-
-static int get_system_header_size(AVFormatContext *ctx)
-{
-    int buf_index, i, private_stream_coded;
-    StreamInfo *stream;
-    MpegMuxContext *s = ctx->priv_data;
-
-    if (s->is_dvd)
-       return 18; // DVD-Video system headers are 18 bytes fixed length.
-
-    buf_index = 12;
-    private_stream_coded = 0;
-    for(i=0;i<ctx->nb_streams;i++) {
-        stream = ctx->streams[i]->priv_data;
-        if (stream->id < 0xc0) {
-            if (private_stream_coded)
-                continue;
-            private_stream_coded = 1;
-        }
-        buf_index += 3;
-    }
-    return buf_index;
-}
-
-static int mpeg_mux_init(AVFormatContext *ctx)
-{
-    MpegMuxContext *s = ctx->priv_data;
-    int bitrate, i, mpa_id, mpv_id, mps_id, ac3_id, dts_id, lpcm_id, j;
-    AVStream *st;
-    StreamInfo *stream;
-    int audio_bitrate;
-    int video_bitrate;
-
-    s->packet_number = 0;
-    s->is_vcd = (ctx->oformat == &mpeg1vcd_muxer);
-    s->is_svcd = (ctx->oformat == &mpeg2svcd_muxer);
-    s->is_mpeg2 = (ctx->oformat == &mpeg2vob_muxer || ctx->oformat == &mpeg2svcd_muxer || ctx->oformat == &mpeg2dvd_muxer);
-    s->is_dvd = (ctx->oformat == &mpeg2dvd_muxer);
-
-    if(ctx->packet_size)
-        s->packet_size = ctx->packet_size;
-    else
-        s->packet_size = 2048;
-
-    s->vcd_padding_bytes_written = 0;
-    s->vcd_padding_bitrate=0;
-
-    s->audio_bound = 0;
-    s->video_bound = 0;
-    mpa_id = AUDIO_ID;
-    ac3_id = AC3_ID;
-    dts_id = DTS_ID;
-    mpv_id = VIDEO_ID;
-    mps_id = SUB_ID;
-    lpcm_id = LPCM_ID;
-    for(i=0;i<ctx->nb_streams;i++) {
-        st = ctx->streams[i];
-        stream = av_mallocz(sizeof(StreamInfo));
-        if (!stream)
-            goto fail;
-        st->priv_data = stream;
-
-        av_set_pts_info(st, 64, 1, 90000);
-
-        switch(st->codec->codec_type) {
-        case CODEC_TYPE_AUDIO:
-            if (st->codec->codec_id == CODEC_ID_AC3) {
-                stream->id = ac3_id++;
-            } else if (st->codec->codec_id == CODEC_ID_DTS) {
-                stream->id = dts_id++;
-            } else if (st->codec->codec_id == CODEC_ID_PCM_S16BE) {
-                stream->id = lpcm_id++;
-                for(j = 0; j < 4; j++) {
-                    if (lpcm_freq_tab[j] == st->codec->sample_rate)
-                        break;
-                }
-                if (j == 4)
-                    goto fail;
-                if (st->codec->channels > 8)
-                    return -1;
-                stream->lpcm_header[0] = 0x0c;
-                stream->lpcm_header[1] = (st->codec->channels - 1) | (j << 4);
-                stream->lpcm_header[2] = 0x80;
-                stream->lpcm_align = st->codec->channels * 2;
-            } else {
-                stream->id = mpa_id++;
-            }
-
-            /* This value HAS to be used for VCD (see VCD standard, p. IV-7).
-               Right now it is also used for everything else.*/
-            stream->max_buffer_size = 4 * 1024;
-            s->audio_bound++;
-            break;
-        case CODEC_TYPE_VIDEO:
-            stream->id = mpv_id++;
-            if (st->codec->rc_buffer_size)
-                stream->max_buffer_size = 6*1024 + st->codec->rc_buffer_size/8;
-            else
-                stream->max_buffer_size = 230*1024; //FIXME this is probably too small as default
-#if 0
-                /* see VCD standard, p. IV-7*/
-                stream->max_buffer_size = 46 * 1024;
-            else
-                /* This value HAS to be used for SVCD (see SVCD standard, p. 26 V.2.3.2).
-                   Right now it is also used for everything else.*/
-                stream->max_buffer_size = 230 * 1024;
-#endif
-            s->video_bound++;
-            break;
-        case CODEC_TYPE_SUBTITLE:
-            stream->id = mps_id++;
-            stream->max_buffer_size = 16 * 1024;
-            break;
-        default:
-            return -1;
-        }
-        av_fifo_init(&stream->fifo, 16);
-    }
-    bitrate = 0;
-    audio_bitrate = 0;
-    video_bitrate = 0;
-    for(i=0;i<ctx->nb_streams;i++) {
-        int codec_rate;
-        st = ctx->streams[i];
-        stream = (StreamInfo*) st->priv_data;
-
-        if(st->codec->rc_max_rate || stream->id==VIDEO_ID)
-            codec_rate= st->codec->rc_max_rate;
-        else
-            codec_rate= st->codec->bit_rate;
-
-        if(!codec_rate)
-            codec_rate= (1<<21)*8*50/ctx->nb_streams;
-
-        bitrate += codec_rate;
-
-        if (stream->id==AUDIO_ID)
-            audio_bitrate += codec_rate;
-        else if (stream->id==VIDEO_ID)
-            video_bitrate += codec_rate;
-    }
-
-    if(ctx->mux_rate){
-        s->mux_rate= (ctx->mux_rate + (8 * 50) - 1) / (8 * 50);
-    } else {
-        /* we increase slightly the bitrate to take into account the
-           headers. XXX: compute it exactly */
-        bitrate += bitrate*5/100;
-        bitrate += 10000;
-        s->mux_rate = (bitrate + (8 * 50) - 1) / (8 * 50);
-    }
-
-    if (s->is_vcd) {
-        double overhead_rate;
-
-        /* The VCD standard mandates that the mux_rate field is 3528
-           (see standard p. IV-6).
-           The value is actually "wrong", i.e. if you calculate
-           it using the normal formula and the 75 sectors per second transfer
-           rate you get a different value because the real pack size is 2324,
-           not 2352. But the standard explicitly specifies that the mux_rate
-           field in the header must have this value.*/
-//        s->mux_rate=2352 * 75 / 50;    /* = 3528*/
-
-        /* The VCD standard states that the muxed stream must be
-           exactly 75 packs / second (the data rate of a single speed cdrom).
-           Since the video bitrate (probably 1150000 bits/sec) will be below
-           the theoretical maximum we have to add some padding packets
-           to make up for the lower data rate.
-           (cf. VCD standard p. IV-6 )*/
-
-        /* Add the header overhead to the data rate.
-           2279 data bytes per audio pack, 2294 data bytes per video pack*/
-        overhead_rate = ((audio_bitrate / 8.0) / 2279) * (2324 - 2279);
-        overhead_rate += ((video_bitrate / 8.0) / 2294) * (2324 - 2294);
-        overhead_rate *= 8;
-
-        /* Add padding so that the full bitrate is 2324*75 bytes/sec */
-        s->vcd_padding_bitrate = 2324 * 75 * 8 - (bitrate + overhead_rate);
-    }
-
-    if (s->is_vcd || s->is_mpeg2)
-        /* every packet */
-        s->pack_header_freq = 1;
-    else
-        /* every 2 seconds */
-        s->pack_header_freq = 2 * bitrate / s->packet_size / 8;
-
-    /* the above seems to make pack_header_freq zero sometimes */
-    if (s->pack_header_freq == 0)
-       s->pack_header_freq = 1;
-
-    if (s->is_mpeg2)
-        /* every 200 packets. Need to look at the spec.  */
-        s->system_header_freq = s->pack_header_freq * 40;
-    else if (s->is_vcd)
-        /* the standard mandates that there are only two system headers
-           in the whole file: one in the first packet of each stream.
-           (see standard p. IV-7 and IV-8) */
-        s->system_header_freq = 0x7fffffff;
-    else
-        s->system_header_freq = s->pack_header_freq * 5;
-
-    for(i=0;i<ctx->nb_streams;i++) {
-        stream = ctx->streams[i]->priv_data;
-        stream->packet_number = 0;
-    }
-    s->system_header_size = get_system_header_size(ctx);
-    s->last_scr = 0;
-    return 0;
- fail:
-    for(i=0;i<ctx->nb_streams;i++) {
-        av_free(ctx->streams[i]->priv_data);
-    }
-    return -ENOMEM;
-}
-
-static inline void put_timestamp(ByteIOContext *pb, int id, int64_t timestamp)
-{
-    put_byte(pb,
-             (id << 4) |
-             (((timestamp >> 30) & 0x07) << 1) |
-             1);
-    put_be16(pb, (uint16_t)((((timestamp >> 15) & 0x7fff) << 1) | 1));
-    put_be16(pb, (uint16_t)((((timestamp) & 0x7fff) << 1) | 1));
-}
-
-
-/* return the number of padding bytes that should be inserted into
-   the multiplexed stream.*/
-static int get_vcd_padding_size(AVFormatContext *ctx, int64_t pts)
-{
-    MpegMuxContext *s = ctx->priv_data;
-    int pad_bytes = 0;
-
-    if (s->vcd_padding_bitrate > 0 && pts!=AV_NOPTS_VALUE)
-    {
-        int64_t full_pad_bytes;
-
-        full_pad_bytes = (int64_t)((s->vcd_padding_bitrate * (pts / 90000.0)) / 8.0); //FIXME this is wrong
-        pad_bytes = (int) (full_pad_bytes - s->vcd_padding_bytes_written);
-
-        if (pad_bytes<0)
-            /* might happen if we have already padded to a later timestamp. This
-               can occur if another stream has already advanced further.*/
-            pad_bytes=0;
-    }
-
-    return pad_bytes;
-}
-
-
-#if 0 /* unused, remove? */
-/* return the exact available payload size for the next packet for
-   stream 'stream_index'. 'pts' and 'dts' are only used to know if
-   timestamps are needed in the packet header. */
-static int get_packet_payload_size(AVFormatContext *ctx, int stream_index,
-                                   int64_t pts, int64_t dts)
-{
-    MpegMuxContext *s = ctx->priv_data;
-    int buf_index;
-    StreamInfo *stream;
-
-    stream = ctx->streams[stream_index]->priv_data;
-
-    buf_index = 0;
-    if (((s->packet_number % s->pack_header_freq) == 0)) {
-        /* pack header size */
-        if (s->is_mpeg2)
-            buf_index += 14;
-        else
-            buf_index += 12;
-
-        if (s->is_vcd) {
-            /* there is exactly one system header for each stream in a VCD MPEG,
-               One in the very first video packet and one in the very first
-               audio packet (see VCD standard p. IV-7 and IV-8).*/
-
-            if (stream->packet_number==0)
-                /* The system headers refer only to the stream they occur in,
-                   so they have a constant size.*/
-                buf_index += 15;
-
-        } else {
-            if ((s->packet_number % s->system_header_freq) == 0)
-                buf_index += s->system_header_size;
-        }
-    }
-
-    if ((s->is_vcd && stream->packet_number==0)
-        || (s->is_svcd && s->packet_number==0))
-        /* the first pack of each stream contains only the pack header,
-           the system header and some padding (see VCD standard p. IV-6)
-           Add the padding size, so that the actual payload becomes 0.*/
-        buf_index += s->packet_size - buf_index;
-    else {
-        /* packet header size */
-        buf_index += 6;
-        if (s->is_mpeg2) {
-            buf_index += 3;
-            if (stream->packet_number==0)
-                buf_index += 3; /* PES extension */
-            buf_index += 1;    /* obligatory stuffing byte */
-        }
-        if (pts != AV_NOPTS_VALUE) {
-            if (dts != pts)
-                buf_index += 5 + 5;
-            else
-                buf_index += 5;
-
-        } else {
-            if (!s->is_mpeg2)
-                buf_index++;
-        }
-
-        if (stream->id < 0xc0) {
-            /* AC3/LPCM private data header */
-            buf_index += 4;
-            if (stream->id >= 0xa0) {
-                int n;
-                buf_index += 3;
-                /* NOTE: we round the payload size to an integer number of
-                   LPCM samples */
-                n = (s->packet_size - buf_index) % stream->lpcm_align;
-                if (n)
-                    buf_index += (stream->lpcm_align - n);
-            }
-        }
-
-        if (s->is_vcd && stream->id == AUDIO_ID)
-            /* The VCD standard demands that 20 zero bytes follow
-               each audio packet (see standard p. IV-8).*/
-            buf_index+=20;
-    }
-    return s->packet_size - buf_index;
-}
-#endif
-
-/* Write an MPEG padding packet header. */
-static void put_padding_packet(AVFormatContext *ctx, ByteIOContext *pb,int packet_bytes)
-{
-    MpegMuxContext *s = ctx->priv_data;
-    int i;
-
-    put_be32(pb, PADDING_STREAM);
-    put_be16(pb, packet_bytes - 6);
-    if (!s->is_mpeg2) {
-        put_byte(pb, 0x0f);
-        packet_bytes -= 7;
-    } else
-        packet_bytes -= 6;
-
-    for(i=0;i<packet_bytes;i++)
-        put_byte(pb, 0xff);
-}
-
-static int get_nb_frames(AVFormatContext *ctx, StreamInfo *stream, int len){
-    int nb_frames=0;
-    PacketDesc *pkt_desc= stream->premux_packet;
-
-    while(len>0){
-        if(pkt_desc->size == pkt_desc->unwritten_size)
-            nb_frames++;
-        len -= pkt_desc->unwritten_size;
-        pkt_desc= pkt_desc->next;
-    }
-
-    return nb_frames;
-}
-
-/* flush the packet on stream stream_index */
-static int flush_packet(AVFormatContext *ctx, int stream_index,
-                         int64_t pts, int64_t dts, int64_t scr, int trailer_size)
-{
-    MpegMuxContext *s = ctx->priv_data;
-    StreamInfo *stream = ctx->streams[stream_index]->priv_data;
-    uint8_t *buf_ptr;
-    int size, payload_size, startcode, id, stuffing_size, i, header_len;
-    int packet_size;
-    uint8_t buffer[128];
-    int zero_trail_bytes = 0;
-    int pad_packet_bytes = 0;
-    int pes_flags;
-    int general_pack = 0;  /*"general" pack without data specific to one stream?*/
-    int nb_frames;
-
-    id = stream->id;
-
-#if 0
-    printf("packet ID=%2x PTS=%0.3f\n",
-           id, pts / 90000.0);
-#endif
-
-    buf_ptr = buffer;
-
-    if ((s->packet_number % s->pack_header_freq) == 0 || s->last_scr != scr) {
-        /* output pack and systems header if needed */
-        size = put_pack_header(ctx, buf_ptr, scr);
-        buf_ptr += size;
-        s->last_scr= scr;
-
-        if (s->is_vcd) {
-            /* there is exactly one system header for each stream in a VCD MPEG,
-               One in the very first video packet and one in the very first
-               audio packet (see VCD standard p. IV-7 and IV-8).*/
-
-            if (stream->packet_number==0) {
-                size = put_system_header(ctx, buf_ptr, id);
-                buf_ptr += size;
-            }
-        } else if (s->is_dvd) {
-            if (stream->align_iframe || s->packet_number == 0){
-                int PES_bytes_to_fill = s->packet_size - size - 10;
-
-                if (pts != AV_NOPTS_VALUE) {
-                    if (dts != pts)
-                        PES_bytes_to_fill -= 5 + 5;
-                    else
-                        PES_bytes_to_fill -= 5;
-                }
-
-                if (stream->bytes_to_iframe == 0 || s->packet_number == 0) {
-                    size = put_system_header(ctx, buf_ptr, 0);
-                    buf_ptr += size;
-                    size = buf_ptr - buffer;
-                    put_buffer(&ctx->pb, buffer, size);
-
-                    put_be32(&ctx->pb, PRIVATE_STREAM_2);
-                    put_be16(&ctx->pb, 0x03d4);         // length
-                    put_byte(&ctx->pb, 0x00);           // substream ID, 00=PCI
-                    for (i = 0; i < 979; i++)
-                        put_byte(&ctx->pb, 0x00);
-
-                    put_be32(&ctx->pb, PRIVATE_STREAM_2);
-                    put_be16(&ctx->pb, 0x03fa);         // length
-                    put_byte(&ctx->pb, 0x01);           // substream ID, 01=DSI
-                    for (i = 0; i < 1017; i++)
-                        put_byte(&ctx->pb, 0x00);
-
-                    memset(buffer, 0, 128);
-                    buf_ptr = buffer;
-                    s->packet_number++;
-                    stream->align_iframe = 0;
-                    scr += s->packet_size*90000LL / (s->mux_rate*50LL); //FIXME rounding and first few bytes of each packet
-                    size = put_pack_header(ctx, buf_ptr, scr);
-                    s->last_scr= scr;
-                    buf_ptr += size;
-                    /* GOP Start */
-                } else if (stream->bytes_to_iframe < PES_bytes_to_fill) {
-                    pad_packet_bytes = PES_bytes_to_fill - stream->bytes_to_iframe;
-                }
-            }
-        } else {
-            if ((s->packet_number % s->system_header_freq) == 0) {
-                size = put_system_header(ctx, buf_ptr, 0);
-                buf_ptr += size;
-            }
-        }
-    }
-    size = buf_ptr - buffer;
-    put_buffer(&ctx->pb, buffer, size);
-
-    packet_size = s->packet_size - size;
-
-    if (s->is_vcd && id == AUDIO_ID)
-        /* The VCD standard demands that 20 zero bytes follow
-           each audio pack (see standard p. IV-8).*/
-        zero_trail_bytes += 20;
-
-    if ((s->is_vcd && stream->packet_number==0)
-        || (s->is_svcd && s->packet_number==0)) {
-        /* for VCD the first pack of each stream contains only the pack header,
-           the system header and lots of padding (see VCD standard p. IV-6).
-           In the case of an audio pack, 20 zero bytes are also added at
-           the end.*/
-        /* For SVCD we fill the very first pack to increase compatibility with
-           some DVD players. Not mandated by the standard.*/
-        if (s->is_svcd)
-            general_pack = 1;    /* the system header refers to both streams and no stream data*/
-        pad_packet_bytes = packet_size - zero_trail_bytes;
-    }
-
-    packet_size -= pad_packet_bytes + zero_trail_bytes;
-
-    if (packet_size > 0) {
-
-        /* packet header size */
-        packet_size -= 6;
-
-        /* packet header */
-        if (s->is_mpeg2) {
-            header_len = 3;
-            if (stream->packet_number==0)
-                header_len += 3; /* PES extension */
-            header_len += 1; /* obligatory stuffing byte */
-        } else {
-            header_len = 0;
-        }
-        if (pts != AV_NOPTS_VALUE) {
-            if (dts != pts)
-                header_len += 5 + 5;
-            else
-                header_len += 5;
-        } else {
-            if (!s->is_mpeg2)
-                header_len++;
-        }
-
-        payload_size = packet_size - header_len;
-        if (id < 0xc0) {
-            startcode = PRIVATE_STREAM_1;
-            payload_size -= 1;
-            if (id >= 0x40) {
-                payload_size -= 3;
-                if (id >= 0xa0)
-                    payload_size -= 3;
-            }
-        } else {
-            startcode = 0x100 + id;
-        }
-
-        stuffing_size = payload_size - av_fifo_size(&stream->fifo);
-
-        // first byte doesnt fit -> reset pts/dts + stuffing
-        if(payload_size <= trailer_size && pts != AV_NOPTS_VALUE){
-            int timestamp_len=0;
-            if(dts != pts)
-                timestamp_len += 5;
-            if(pts != AV_NOPTS_VALUE)
-                timestamp_len += s->is_mpeg2 ? 5 : 4;
-            pts=dts= AV_NOPTS_VALUE;
-            header_len -= timestamp_len;
-            if (s->is_dvd && stream->align_iframe) {
-                pad_packet_bytes += timestamp_len;
-                packet_size -= timestamp_len;
-            } else {
-                payload_size += timestamp_len;
-            }
-            stuffing_size += timestamp_len;
-            if(payload_size > trailer_size)
-                stuffing_size += payload_size - trailer_size;
-        }
-
-        if (pad_packet_bytes > 0 && pad_packet_bytes <= 7) { // can't use padding, so use stuffing
-            packet_size += pad_packet_bytes;
-            payload_size += pad_packet_bytes; // undo the previous adjustment
-            if (stuffing_size < 0) {
-                stuffing_size = pad_packet_bytes;
-            } else {
-                stuffing_size += pad_packet_bytes;
-            }
-            pad_packet_bytes = 0;
-        }
-
-        if (stuffing_size < 0)
-            stuffing_size = 0;
-        if (stuffing_size > 16) {    /*<=16 for MPEG-1, <=32 for MPEG-2*/
-            pad_packet_bytes += stuffing_size;
-            packet_size -= stuffing_size;
-            payload_size -= stuffing_size;
-            stuffing_size = 0;
-        }
-
-        nb_frames= get_nb_frames(ctx, stream, payload_size - stuffing_size);
-
-        put_be32(&ctx->pb, startcode);
-
-        put_be16(&ctx->pb, packet_size);
-
-        if (!s->is_mpeg2)
-            for(i=0;i<stuffing_size;i++)
-                put_byte(&ctx->pb, 0xff);
-
-        if (s->is_mpeg2) {
-            put_byte(&ctx->pb, 0x80); /* mpeg2 id */
-
-            pes_flags=0;
-
-            if (pts != AV_NOPTS_VALUE) {
-                pes_flags |= 0x80;
-                if (dts != pts)
-                    pes_flags |= 0x40;
-            }
-
-            /* Both the MPEG-2 and the SVCD standards demand that the
-               P-STD_buffer_size field be included in the first packet of
-               every stream. (see SVCD standard p. 26 V.2.3.1 and V.2.3.2
-               and MPEG-2 standard 2.7.7) */
-            if (stream->packet_number == 0)
-                pes_flags |= 0x01;
-
-            put_byte(&ctx->pb, pes_flags); /* flags */
-            put_byte(&ctx->pb, header_len - 3 + stuffing_size);
-
-            if (pes_flags & 0x80)  /*write pts*/
-                put_timestamp(&ctx->pb, (pes_flags & 0x40) ? 0x03 : 0x02, pts);
-            if (pes_flags & 0x40)  /*write dts*/
-                put_timestamp(&ctx->pb, 0x01, dts);
-
-            if (pes_flags & 0x01) {  /*write pes extension*/
-                put_byte(&ctx->pb, 0x10); /* flags */
-
-                /* P-STD buffer info */
-                if (id == AUDIO_ID)
-                    put_be16(&ctx->pb, 0x4000 | stream->max_buffer_size/128);
-                else
-                    put_be16(&ctx->pb, 0x6000 | stream->max_buffer_size/1024);
-            }
-
-        } else {
-            if (pts != AV_NOPTS_VALUE) {
-                if (dts != pts) {
-                    put_timestamp(&ctx->pb, 0x03, pts);
-                    put_timestamp(&ctx->pb, 0x01, dts);
-                } else {
-                    put_timestamp(&ctx->pb, 0x02, pts);
-                }
-            } else {
-                put_byte(&ctx->pb, 0x0f);
-            }
-        }
-
-        if (s->is_mpeg2) {
-            /* special stuffing byte that is always written
-               to prevent accidental generation of start codes. */
-            put_byte(&ctx->pb, 0xff);
-
-            for(i=0;i<stuffing_size;i++)
-                put_byte(&ctx->pb, 0xff);
-        }
-
-        if (startcode == PRIVATE_STREAM_1) {
-            put_byte(&ctx->pb, id);
-            if (id >= 0xa0) {
-                /* LPCM (XXX: check nb_frames) */
-                put_byte(&ctx->pb, 7);
-                put_be16(&ctx->pb, 4); /* skip 3 header bytes */
-                put_byte(&ctx->pb, stream->lpcm_header[0]);
-                put_byte(&ctx->pb, stream->lpcm_header[1]);
-                put_byte(&ctx->pb, stream->lpcm_header[2]);
-            } else if (id >= 0x40) {
-                /* AC3 */
-                put_byte(&ctx->pb, nb_frames);
-                put_be16(&ctx->pb, trailer_size+1);
-            }
-        }
-
-        /* output data */
-        if(av_fifo_generic_read(&stream->fifo, payload_size - stuffing_size, &put_buffer, &ctx->pb) < 0)
-            return -1;
-        stream->bytes_to_iframe -= payload_size - stuffing_size;
-    }else{
-        payload_size=
-        stuffing_size= 0;
-    }
-
-    if (pad_packet_bytes > 0)
-        put_padding_packet(ctx,&ctx->pb, pad_packet_bytes);
-
-    for(i=0;i<zero_trail_bytes;i++)
-        put_byte(&ctx->pb, 0x00);
-
-    put_flush_packet(&ctx->pb);
-
-    s->packet_number++;
-
-    /* only increase the stream packet number if this pack actually contains
-       something that is specific to this stream! I.e. a dedicated header
-       or some data.*/
-    if (!general_pack)
-        stream->packet_number++;
-
-    return payload_size - stuffing_size;
-}
-
-static void put_vcd_padding_sector(AVFormatContext *ctx)
-{
-    /* There are two ways to do this padding: writing a sector/pack
-       of 0 values, or writing an MPEG padding pack. Both seem to
-       work with most decoders, BUT the VCD standard only allows a 0-sector
-       (see standard p. IV-4, IV-5).
-       So a 0-sector it is...*/
-
-    MpegMuxContext *s = ctx->priv_data;
-    int i;
-
-    for(i=0;i<s->packet_size;i++)
-        put_byte(&ctx->pb, 0);
-
-    s->vcd_padding_bytes_written += s->packet_size;
-
-    put_flush_packet(&ctx->pb);
-
-    /* increasing the packet number is correct. The SCR of the following packs
-       is calculated from the packet_number and it has to include the padding
-       sector (it represents the sector index, not the MPEG pack index)
-       (see VCD standard p. IV-6)*/
-    s->packet_number++;
-}
-
-#if 0 /* unused, remove? */
-static int64_t get_vcd_scr(AVFormatContext *ctx,int stream_index,int64_t pts)
-{
-    MpegMuxContext *s = ctx->priv_data;
-    int64_t scr;
-
-        /* Since the data delivery rate is constant, SCR is computed
-           using the formula C + i * 1200 where C is the start constant
-           and i is the pack index.
-           It is recommended that SCR 0 is at the beginning of the VCD front
-           margin (a sequence of empty Form 2 sectors on the CD).
-           It is recommended that the front margin is 30 sectors long, so
-           we use C = 30*1200 = 36000
-           (Note that even if the front margin is not 30 sectors the file
-           will still be correct according to the standard. It just won't have
-           the "recommended" value).*/
-        scr = 36000 + s->packet_number * 1200;
-
-    return scr;
-}
-#endif
-
-static int remove_decoded_packets(AVFormatContext *ctx, int64_t scr){
-//    MpegMuxContext *s = ctx->priv_data;
-    int i;
-
-    for(i=0; i<ctx->nb_streams; i++){
-        AVStream *st = ctx->streams[i];
-        StreamInfo *stream = st->priv_data;
-        PacketDesc *pkt_desc= stream->predecode_packet;
-
-        while(pkt_desc && scr > pkt_desc->dts){ //FIXME > vs >=
-            if(stream->buffer_index < pkt_desc->size ||
-               stream->predecode_packet == stream->premux_packet){
-                av_log(ctx, AV_LOG_ERROR, "buffer underflow\n");
-                break;
-            }
-            stream->buffer_index -= pkt_desc->size;
-
-            stream->predecode_packet= pkt_desc->next;
-            av_freep(&pkt_desc);
-        }
-    }
-
-    return 0;
-}
-
-static int output_packet(AVFormatContext *ctx, int flush){
-    MpegMuxContext *s = ctx->priv_data;
-    AVStream *st;
-    StreamInfo *stream;
-    int i, avail_space, es_size, trailer_size;
-    int best_i= -1;
-    int best_score= INT_MIN;
-    int ignore_constraints=0;
-    int64_t scr= s->last_scr;
-    PacketDesc *timestamp_packet;
-    const int64_t max_delay= av_rescale(ctx->max_delay, 90000, AV_TIME_BASE);
-
-retry:
-    for(i=0; i<ctx->nb_streams; i++){
-        AVStream *st = ctx->streams[i];
-        StreamInfo *stream = st->priv_data;
-        const int avail_data=  av_fifo_size(&stream->fifo);
-        const int space= stream->max_buffer_size - stream->buffer_index;
-        int rel_space= 1024*space / stream->max_buffer_size;
-        PacketDesc *next_pkt= stream->premux_packet;
-
-        /* for subtitle, a single PES packet must be generated,
-           so we flush after every single subtitle packet */
-        if(s->packet_size > avail_data && !flush
-           && st->codec->codec_type != CODEC_TYPE_SUBTITLE)
-            return 0;
-        if(avail_data==0)
-            continue;
-        assert(avail_data>0);
-
-        if(space < s->packet_size && !ignore_constraints)
-            continue;
-
-        if(next_pkt && next_pkt->dts - scr > max_delay)
-            continue;
-
-        if(rel_space > best_score){
-            best_score= rel_space;
-            best_i = i;
-            avail_space= space;
-        }
-    }
-
-    if(best_i < 0){
-        int64_t best_dts= INT64_MAX;
-
-        for(i=0; i<ctx->nb_streams; i++){
-            AVStream *st = ctx->streams[i];
-            StreamInfo *stream = st->priv_data;
-            PacketDesc *pkt_desc= stream->predecode_packet;
-            if(pkt_desc && pkt_desc->dts < best_dts)
-                best_dts= pkt_desc->dts;
-        }
-
-#if 0
-        av_log(ctx, AV_LOG_DEBUG, "bumping scr, scr:%f, dts:%f\n",
-               scr/90000.0, best_dts/90000.0);
-#endif
-        if(best_dts == INT64_MAX)
-            return 0;
-
-        if(scr >= best_dts+1 && !ignore_constraints){
-            av_log(ctx, AV_LOG_ERROR, "packet too large, ignoring buffer limits to mux it\n");
-            ignore_constraints= 1;
-        }
-        scr= FFMAX(best_dts+1, scr);
-        if(remove_decoded_packets(ctx, scr) < 0)
-            return -1;
-        goto retry;
-    }
-
-    assert(best_i >= 0);
-
-    st = ctx->streams[best_i];
-    stream = st->priv_data;
-
-    assert(av_fifo_size(&stream->fifo) > 0);
-
-    assert(avail_space >= s->packet_size || ignore_constraints);
-
-    timestamp_packet= stream->premux_packet;
-    if(timestamp_packet->unwritten_size == timestamp_packet->size){
-        trailer_size= 0;
-    }else{
-        trailer_size= timestamp_packet->unwritten_size;
-        timestamp_packet= timestamp_packet->next;
-    }
-
-    if(timestamp_packet){
-//av_log(ctx, AV_LOG_DEBUG, "dts:%f pts:%f scr:%f stream:%d\n", timestamp_packet->dts/90000.0, timestamp_packet->pts/90000.0, scr/90000.0, best_i);
-        es_size= flush_packet(ctx, best_i, timestamp_packet->pts, timestamp_packet->dts, scr, trailer_size);
-    }else{
-        assert(av_fifo_size(&stream->fifo) == trailer_size);
-        es_size= flush_packet(ctx, best_i, AV_NOPTS_VALUE, AV_NOPTS_VALUE, scr, trailer_size);
-    }
-
-    if (s->is_vcd) {
-        /* Write one or more padding sectors, if necessary, to reach
-           the constant overall bitrate.*/
-        int vcd_pad_bytes;
-
-        while((vcd_pad_bytes = get_vcd_padding_size(ctx,stream->premux_packet->pts) ) >= s->packet_size){ //FIXME pts cannot be correct here
-            put_vcd_padding_sector(ctx);
-            s->last_scr += s->packet_size*90000LL / (s->mux_rate*50LL); //FIXME rounding and first few bytes of each packet
-        }
-    }
-
-    stream->buffer_index += es_size;
-    s->last_scr += s->packet_size*90000LL / (s->mux_rate*50LL); //FIXME rounding and first few bytes of each packet
-
-    while(stream->premux_packet && stream->premux_packet->unwritten_size <= es_size){
-        es_size -= stream->premux_packet->unwritten_size;
-        stream->premux_packet= stream->premux_packet->next;
-    }
-    if(es_size)
-        stream->premux_packet->unwritten_size -= es_size;
-
-    if(remove_decoded_packets(ctx, s->last_scr) < 0)
-        return -1;
-
-    return 1;
-}
-
-static int mpeg_mux_write_packet(AVFormatContext *ctx, AVPacket *pkt)
-{
-    MpegMuxContext *s = ctx->priv_data;
-    int stream_index= pkt->stream_index;
-    int size= pkt->size;
-    uint8_t *buf= pkt->data;
-    AVStream *st = ctx->streams[stream_index];
-    StreamInfo *stream = st->priv_data;
-    int64_t pts, dts;
-    PacketDesc *pkt_desc;
-    const int preload= av_rescale(ctx->preload, 90000, AV_TIME_BASE);
-    const int is_iframe = st->codec->codec_type == CODEC_TYPE_VIDEO && (pkt->flags & PKT_FLAG_KEY);
-
-    pts= pkt->pts;
-    dts= pkt->dts;
-
-    if(pts != AV_NOPTS_VALUE) pts += preload;
-    if(dts != AV_NOPTS_VALUE) dts += preload;
-
-//av_log(ctx, AV_LOG_DEBUG, "dts:%f pts:%f flags:%d stream:%d nopts:%d\n", dts/90000.0, pts/90000.0, pkt->flags, pkt->stream_index, pts != AV_NOPTS_VALUE);
-    if (!stream->premux_packet)
-        stream->next_packet = &stream->premux_packet;
-    *stream->next_packet=
-    pkt_desc= av_mallocz(sizeof(PacketDesc));
-    pkt_desc->pts= pts;
-    pkt_desc->dts= dts;
-    pkt_desc->unwritten_size=
-    pkt_desc->size= size;
-    if(!stream->predecode_packet)
-        stream->predecode_packet= pkt_desc;
-    stream->next_packet= &pkt_desc->next;
-
-    av_fifo_realloc(&stream->fifo, av_fifo_size(&stream->fifo) + size + 1);
-
-    if (s->is_dvd){
-        if (is_iframe && (s->packet_number == 0 || (pts - stream->vobu_start_pts >= 36000))) { // min VOBU length 0.4 seconds (mpucoder)
-            stream->bytes_to_iframe = av_fifo_size(&stream->fifo);
-            stream->align_iframe = 1;
-            stream->vobu_start_pts = pts;
-        } else {
-            stream->align_iframe = 0;
-        }
-    }
-
-    av_fifo_write(&stream->fifo, buf, size);
-
-    for(;;){
-        int ret= output_packet(ctx, 0);
-        if(ret<=0)
-            return ret;
-    }
-}
-
-static int mpeg_mux_end(AVFormatContext *ctx)
-{
-//    MpegMuxContext *s = ctx->priv_data;
-    StreamInfo *stream;
-    int i;
-
-    for(;;){
-        int ret= output_packet(ctx, 1);
-        if(ret<0)
-            return ret;
-        else if(ret==0)
-            break;
-    }
-
-    /* End header according to MPEG1 systems standard. We do not write
-       it as it is usually not needed by decoders and because it
-       complicates MPEG stream concatenation. */
-    //put_be32(&ctx->pb, ISO_11172_END_CODE);
-    //put_flush_packet(&ctx->pb);
-
-    for(i=0;i<ctx->nb_streams;i++) {
-        stream = ctx->streams[i]->priv_data;
-
-        assert(av_fifo_size(&stream->fifo) == 0);
-        av_fifo_free(&stream->fifo);
-    }
-    return 0;
-}
-#endif //CONFIG_MUXERS
-
 /*********************************************/
 /* demux code */
 
@@ -1260,8 +35,6 @@
 static int cdxa_probe(AVProbeData *p)
 {
     /* check file header */
-    if (p->buf_size <= 32)
-        return 0;
     if (p->buf[0] == 'R' && p->buf[1] == 'I' &&
         p->buf[2] == 'F' && p->buf[3] == 'F' &&
         p->buf[8] == 'C' && p->buf[9] == 'D' &&
@@ -1445,6 +218,7 @@
 {
     MpegDemuxContext *m = s->priv_data;
     int len, size, startcode, c, flags, header_len;
+    int pes_ext, ext2_len, id_ext, skip;
     int64_t pts, dts;
     int64_t last_sync= url_ftell(&s->pb);
 
@@ -1478,7 +252,7 @@
     /* find matching stream */
     if (!((startcode >= 0x1c0 && startcode <= 0x1df) ||
           (startcode >= 0x1e0 && startcode <= 0x1ef) ||
-          (startcode == 0x1bd)))
+          (startcode == 0x1bd) || (startcode == 0x1fd)))
         goto redo;
     if (ppos) {
         *ppos = url_ftell(&s->pb) - 4;
@@ -1531,6 +305,29 @@
                 header_len -= 5;
             }
         }
+        if (flags & 0x01) { /* PES extension */
+            pes_ext = get_byte(&s->pb);
+            header_len--;
+            if (pes_ext & 0x40) { /* pack header - should be zero in PS */
+                goto error_redo;
+            }
+            /* Skip PES private data, program packet sequence counter and P-STD buffer */
+            skip = (pes_ext >> 4) & 0xb;
+            skip += skip & 0x9;
+            url_fskip(&s->pb, skip);
+            header_len -= skip;
+
+            if (pes_ext & 0x01) { /* PES extension 2 */
+                ext2_len = get_byte(&s->pb);
+                header_len--;
+                if ((ext2_len & 0x7f) > 0) {
+                    id_ext = get_byte(&s->pb);
+                    if ((id_ext & 0x80) == 0)
+                        startcode = ((startcode & 0xff) << 8) | id_ext;
+                    header_len--;
+                }
+            }
+        }
         if(header_len < 0)
             goto error_redo;
         url_fskip(&s->pb, header_len);
@@ -1541,12 +338,17 @@
     if (startcode == PRIVATE_STREAM_1 && !m->psm_es_type[startcode & 0xff]) {
         startcode = get_byte(&s->pb);
         len--;
-        if (startcode >= 0x80 && startcode <= 0xbf) {
+        if (startcode >= 0x80 && startcode <= 0xcf) {
             /* audio: skip header */
             get_byte(&s->pb);
             get_byte(&s->pb);
             get_byte(&s->pb);
             len -= 3;
+            if (startcode >= 0xb0 && startcode <= 0xbf) {
+                /* MLP/TrueHD audio has a 4-byte header */
+                get_byte(&s->pb);
+                len--;
+            }
         }
     }
     if(len<0)
@@ -1629,15 +431,27 @@
     } else if (startcode >= 0x80 && startcode <= 0x87) {
         type = CODEC_TYPE_AUDIO;
         codec_id = CODEC_ID_AC3;
-    } else if (startcode >= 0x88 && startcode <= 0x9f) {
+    } else if ((startcode >= 0x88 && startcode <= 0x8f)
+               ||( startcode >= 0x98 && startcode <= 0x9f)) {
+        /* 0x90 - 0x97 is reserved for SDDS in DVD specs */
         type = CODEC_TYPE_AUDIO;
         codec_id = CODEC_ID_DTS;
-    } else if (startcode >= 0xa0 && startcode <= 0xbf) {
+    } else if (startcode >= 0xa0 && startcode <= 0xaf) {
         type = CODEC_TYPE_AUDIO;
         codec_id = CODEC_ID_PCM_S16BE;
+    } else if (startcode >= 0xb0 && startcode <= 0xbf) {
+        type = CODEC_TYPE_AUDIO;
+        codec_id = CODEC_ID_MLP;
+    } else if (startcode >= 0xc0 && startcode <= 0xcf) {
+        /* Used for both AC-3 and E-AC-3 in EVOB files */
+        type = CODEC_TYPE_AUDIO;
+        codec_id = CODEC_ID_AC3;
     } else if (startcode >= 0x20 && startcode <= 0x3f) {
         type = CODEC_TYPE_SUBTITLE;
         codec_id = CODEC_ID_DVD_SUBTITLE;
+    } else if (startcode >= 0xfd55 && startcode <= 0xfd5f) {
+        type = CODEC_TYPE_VIDEO;
+        codec_id = CODEC_ID_VC1;
     } else {
     skip:
         /* skip packet */
@@ -1651,11 +465,11 @@
     st->codec->codec_type = type;
     st->codec->codec_id = codec_id;
     if (codec_id != CODEC_ID_PCM_S16BE)
-        st->need_parsing = 1;
+        st->need_parsing = AVSTREAM_PARSE_FULL;
  found:
     if(st->discard >= AVDISCARD_ALL)
         goto skip;
-    if (startcode >= 0xa0 && startcode <= 0xbf) {
+    if (startcode >= 0xa0 && startcode <= 0xaf) {
         int b1, freq;
 
         /* for LPCM, we just skip the header and consider it is raw
@@ -1721,82 +535,6 @@
     return dts;
 }
 
-#ifdef CONFIG_MPEG1SYSTEM_MUXER
-AVOutputFormat mpeg1system_muxer = {
-    "mpeg",
-    "MPEG1 System format",
-    "video/mpeg",
-    "mpg,mpeg",
-    sizeof(MpegMuxContext),
-    CODEC_ID_MP2,
-    CODEC_ID_MPEG1VIDEO,
-    mpeg_mux_init,
-    mpeg_mux_write_packet,
-    mpeg_mux_end,
-};
-#endif
-#ifdef CONFIG_MPEG1VCD_MUXER
-AVOutputFormat mpeg1vcd_muxer = {
-    "vcd",
-    "MPEG1 System format (VCD)",
-    "video/mpeg",
-    NULL,
-    sizeof(MpegMuxContext),
-    CODEC_ID_MP2,
-    CODEC_ID_MPEG1VIDEO,
-    mpeg_mux_init,
-    mpeg_mux_write_packet,
-    mpeg_mux_end,
-};
-#endif
-#ifdef CONFIG_MPEG2VOB_MUXER
-AVOutputFormat mpeg2vob_muxer = {
-    "vob",
-    "MPEG2 PS format (VOB)",
-    "video/mpeg",
-    "vob",
-    sizeof(MpegMuxContext),
-    CODEC_ID_MP2,
-    CODEC_ID_MPEG2VIDEO,
-    mpeg_mux_init,
-    mpeg_mux_write_packet,
-    mpeg_mux_end,
-};
-#endif
-
-/* Same as mpeg2vob_mux except that the pack size is 2324 */
-#ifdef CONFIG_MPEG2SVCD_MUXER
-AVOutputFormat mpeg2svcd_muxer = {
-    "svcd",
-    "MPEG2 PS format (VOB)",
-    "video/mpeg",
-    "vob",
-    sizeof(MpegMuxContext),
-    CODEC_ID_MP2,
-    CODEC_ID_MPEG2VIDEO,
-    mpeg_mux_init,
-    mpeg_mux_write_packet,
-    mpeg_mux_end,
-};
-#endif
-
-/*  Same as mpeg2vob_mux except the 'is_dvd' flag is set to produce NAV pkts */
-#ifdef CONFIG_MPEG2DVD_MUXER
-AVOutputFormat mpeg2dvd_muxer = {
-    "dvd",
-    "MPEG2 PS format (DVD VOB)",
-    "video/mpeg",
-    "dvd",
-    sizeof(MpegMuxContext),
-    CODEC_ID_MP2,
-    CODEC_ID_MPEG2VIDEO,
-    mpeg_mux_init,
-    mpeg_mux_write_packet,
-    mpeg_mux_end,
-};
-#endif
-
-#ifdef CONFIG_MPEGPS_DEMUXER
 AVInputFormat mpegps_demuxer = {
     "mpeg",
     "MPEG PS format",
@@ -1809,4 +547,3 @@
     mpegps_read_dts,
     .flags = AVFMT_SHOW_IDS,
 };
-#endif

Modified: branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavformat/mpegts.h
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavformat/mpegts.h	2007-07-16 16:39:52 UTC (rev 3382)
+++ branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavformat/mpegts.h	2007-07-16 17:44:22 UTC (rev 3383)
@@ -19,6 +19,11 @@
  * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA
  */
 
+#ifndef AVFORMAT_MPEGTS_H
+#define AVFORMAT_MPEGTS_H
+
+#include "avformat.h"
+
 #define TS_FEC_PACKET_SIZE 204
 #define TS_DVHS_PACKET_SIZE 192
 #define TS_PACKET_SIZE 188
@@ -46,18 +51,18 @@
 #define STREAM_TYPE_AUDIO_AAC       0x0f
 #define STREAM_TYPE_VIDEO_MPEG4     0x10
 #define STREAM_TYPE_VIDEO_H264      0x1b
+#define STREAM_TYPE_VIDEO_VC1       0xea
 
 #define STREAM_TYPE_AUDIO_AC3       0x81
 #define STREAM_TYPE_AUDIO_DTS       0x8a
 
 #define STREAM_TYPE_SUBTITLE_DVB    0x100
 
-unsigned int mpegts_crc32(const uint8_t *data, int len);
-extern AVOutputFormat mpegts_muxer;
-
 typedef struct MpegTSContext MpegTSContext;
 
 MpegTSContext *mpegts_parse_open(AVFormatContext *s);
 int mpegts_parse_packet(MpegTSContext *ts, AVPacket *pkt,
                         const uint8_t *buf, int len);
 void mpegts_parse_close(MpegTSContext *ts);
+
+#endif /* AVFORMAT_MPEGTS_H */

Modified: branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavformat/mpegtsenc.c
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavformat/mpegtsenc.c	2007-07-16 16:39:52 UTC (rev 3382)
+++ branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavformat/mpegtsenc.c	2007-07-16 17:44:22 UTC (rev 3383)
@@ -143,6 +143,7 @@
     int cc;
     int payload_index;
     int64_t payload_pts;
+    int64_t payload_dts;
     uint8_t payload[DEFAULT_PES_PAYLOAD_SIZE];
 } MpegTSWriteStream;
 
@@ -396,6 +397,7 @@
         ts_st->service = service;
         ts_st->pid = DEFAULT_START_PID + i;
         ts_st->payload_pts = AV_NOPTS_VALUE;
+        ts_st->payload_dts = AV_NOPTS_VALUE;
         /* update PCR pid by using the first video stream */
         if (st->codec->codec_type == CODEC_TYPE_VIDEO &&
             service->pcr_pid == 0x1fff)
@@ -460,15 +462,29 @@
     }
 }
 
+static void write_pts(uint8_t *q, int fourbits, int64_t pts)
+{
+    int val;
+
+    val = fourbits << 4 | (((pts >> 30) & 0x07) << 1) | 1;
+    *q++ = val;
+    val = (((pts >> 15) & 0x7fff) << 1) | 1;
+    *q++ = val >> 8;
+    *q++ = val;
+    val = (((pts) & 0x7fff) << 1) | 1;
+    *q++ = val >> 8;
+    *q++ = val;
+}
+
 /* NOTE: pes_data contains all the PES packet */
 static void mpegts_write_pes(AVFormatContext *s, AVStream *st,
                              const uint8_t *payload, int payload_size,
-                             int64_t pts)
+                             int64_t pts, int64_t dts)
 {
     MpegTSWriteStream *ts_st = st->priv_data;
     uint8_t buf[TS_PACKET_SIZE];
     uint8_t *q;
-    int val, is_start, len, header_len, write_pcr, private_code;
+    int val, is_start, len, header_len, write_pcr, private_code, flags;
     int afc_len, stuffing_len;
     int64_t pcr = -1; /* avoid warning */
 
@@ -527,13 +543,19 @@
                     private_code = 0x20;
                 }
             }
-            if (pts != AV_NOPTS_VALUE)
-                header_len = 8;
-            else
-                header_len = 3;
+            header_len = 0;
+            flags = 0;
+            if (pts != AV_NOPTS_VALUE) {
+                header_len += 5;
+                flags |= 0x80;
+            }
+            if (dts != AV_NOPTS_VALUE) {
+                header_len += 5;
+                flags |= 0x40;
+            }
+            len = payload_size + header_len + 3;
             if (private_code != 0)
-                header_len++;
-            len = payload_size + header_len;
+                len++;
             *q++ = len >> 8;
             *q++ = len;
             val = 0x80;
@@ -541,22 +563,16 @@
             if (st->codec->codec_type == CODEC_TYPE_SUBTITLE)
                 val |= 0x04;
             *q++ = val;
+            *q++ = flags;
+            *q++ = header_len;
             if (pts != AV_NOPTS_VALUE) {
-                *q++ = 0x80; /* PTS only */
-                *q++ = 0x05; /* header len */
-                val = (0x02 << 4) |
-                    (((pts >> 30) & 0x07) << 1) | 1;
-                *q++ = val;
-                val = (((pts >> 15) & 0x7fff) << 1) | 1;
-                *q++ = val >> 8;
-                *q++ = val;
-                val = (((pts) & 0x7fff) << 1) | 1;
-                *q++ = val >> 8;
-                *q++ = val;
-            } else {
-                *q++ = 0x00;
-                *q++ = 0x00;
+                write_pts(q, flags >> 6, pts);
+                q += 5;
             }
+            if (dts != AV_NOPTS_VALUE) {
+                write_pts(q, 1, dts);
+                q += 5;
+            }
             if (private_code != 0)
                 *q++ = private_code;
             is_start = 0;
@@ -607,7 +623,7 @@
 
     if (st->codec->codec_type == CODEC_TYPE_SUBTITLE) {
         /* for subtitle, a single PES packet must be generated */
-        mpegts_write_pes(s, st, buf, size, pkt->pts);
+        mpegts_write_pes(s, st, buf, size, pkt->pts, AV_NOPTS_VALUE);
         return 0;
     }
 
@@ -622,10 +638,13 @@
         ts_st->payload_index += len;
         if (ts_st->payload_pts == AV_NOPTS_VALUE)
             ts_st->payload_pts = pkt->pts;
+        if (ts_st->payload_dts == AV_NOPTS_VALUE)
+            ts_st->payload_dts = pkt->dts;
         if (ts_st->payload_index >= max_payload_size) {
             mpegts_write_pes(s, st, ts_st->payload, ts_st->payload_index,
-                             ts_st->payload_pts);
+                             ts_st->payload_pts, ts_st->payload_dts);
             ts_st->payload_pts = AV_NOPTS_VALUE;
+            ts_st->payload_dts = AV_NOPTS_VALUE;
             ts_st->payload_index = 0;
         }
     }
@@ -646,7 +665,7 @@
         ts_st = st->priv_data;
         if (ts_st->payload_index > 0) {
             mpegts_write_pes(s, st, ts_st->payload, ts_st->payload_index,
-                             ts_st->payload_pts);
+                             ts_st->payload_pts, ts_st->payload_dts);
         }
     }
     put_flush_packet(&s->pb);

Modified: branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavformat/qtpalette.h
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavformat/qtpalette.h	2007-07-16 16:39:52 UTC (rev 3382)
+++ branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavformat/qtpalette.h	2007-07-16 17:44:22 UTC (rev 3383)
@@ -2,6 +2,22 @@
  * Default Palettes for Quicktime Files
  *  Automatically generated from a utility derived from XAnim:
  *  http://xanim.va.pubnix.com/home.html
+ *
+ * This file is part of FFmpeg.
+ *
+ * FFmpeg is free software; you can redistribute it and/or
+ * modify it under the terms of the GNU Lesser General Public
+ * License as published by the Free Software Foundation; either
+ * version 2.1 of the License, or (at your option) any later version.
+ *
+ * FFmpeg is distributed in the hope that it will be useful,
+ * but WITHOUT ANY WARRANTY; without even the implied warranty of
+ * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ * Lesser General Public License for more details.
+ *
+ * You should have received a copy of the GNU Lesser General Public
+ * License along with FFmpeg; if not, write to the Free Software
+ * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA
  */
 
 #ifndef QTPALETTE_H

Modified: branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavformat/riff.c
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavformat/riff.c	2007-07-16 16:39:52 UTC (rev 3382)
+++ branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavformat/riff.c	2007-07-16 17:44:22 UTC (rev 3383)
@@ -97,12 +97,16 @@
     { CODEC_ID_MPEG1VIDEO, 0x10000001 },
     { CODEC_ID_MPEG2VIDEO, 0x10000002 },
     { CODEC_ID_MPEG2VIDEO, MKTAG('D', 'V', 'R', ' ') },
+    { CODEC_ID_MPEG2VIDEO, MKTAG('M', 'M', 'E', 'S') },
     { CODEC_ID_MJPEG, MKTAG('M', 'J', 'P', 'G') },
     { CODEC_ID_MJPEG, MKTAG('L', 'J', 'P', 'G') },
     { CODEC_ID_LJPEG, MKTAG('L', 'J', 'P', 'G') },
     { CODEC_ID_MJPEG, MKTAG('J', 'P', 'G', 'L') }, /* Pegasus lossless JPEG */
+    { CODEC_ID_JPEGLS,MKTAG('M', 'J', 'L', 'S') }, /* JPEG-LS custom FOURCC for avi - encoder */
     { CODEC_ID_MJPEG, MKTAG('M', 'J', 'L', 'S') }, /* JPEG-LS custom FOURCC for avi - decoder */
-    { CODEC_ID_JPEGLS, MKTAG('M', 'J', 'L', 'S') }, /* JPEG-LS custom FOURCC for avi - encoder */
+    { CODEC_ID_MJPEG, MKTAG('j', 'p', 'e', 'g') },
+    { CODEC_ID_MJPEG, MKTAG('I', 'J', 'P', 'G') },
+    { CODEC_ID_MJPEG, MKTAG('A', 'V', 'R', 'n') },
     { CODEC_ID_HUFFYUV, MKTAG('H', 'F', 'Y', 'U') },
     { CODEC_ID_FFVHUFF, MKTAG('F', 'F', 'V', 'H') },
     { CODEC_ID_CYUV, MKTAG('C', 'Y', 'U', 'V') },
@@ -153,6 +157,7 @@
     { CODEC_ID_QPEG, MKTAG('Q', '1', '.', '1') },
     { CODEC_ID_WMV3, MKTAG('W', 'M', 'V', '3') },
     { CODEC_ID_VC1, MKTAG('W', 'V', 'C', '1') },
+    { CODEC_ID_VC1, MKTAG('W', 'M', 'V', 'A') },
     { CODEC_ID_LOCO, MKTAG('L', 'O', 'C', 'O') },
     { CODEC_ID_WNV1, MKTAG('W', 'N', 'V', '1') },
     { CODEC_ID_AASC, MKTAG('A', 'A', 'S', 'C') },
@@ -166,6 +171,7 @@
     { CODEC_ID_CAVS, MKTAG('C', 'A', 'V', 'S') },
     { CODEC_ID_JPEG2000, MKTAG('M', 'J', '2', 'C') },
     { CODEC_ID_VMNC, MKTAG('V', 'M', 'n', 'c') },
+    { CODEC_ID_TARGA, MKTAG('t', 'g', 'a', ' ') },
     { CODEC_ID_NONE, 0 },
 };
 
@@ -198,6 +204,8 @@
     { CODEC_ID_TRUESPEECH, 0x22 },
     { CODEC_ID_FLAC, 0xF1AC },
     { CODEC_ID_IMC, 0x401 },
+    { CODEC_ID_GSM_MS, 0x31 },
+    { CODEC_ID_ATRAC3, 0x270 },
 
     /* FIXME: All of the IDs below are not 16 bit and thus illegal. */
     // for NuppelVideo (nuv.c)
@@ -207,69 +215,6 @@
     { 0, 0 },
 };
 
-unsigned int codec_get_tag(const AVCodecTag *tags, int id)
-{
-    while (tags->id != CODEC_ID_NONE) {
-        if (tags->id == id)
-            return tags->tag;
-        tags++;
-    }
-    return 0;
-}
-
-enum CodecID codec_get_id(const AVCodecTag *tags, unsigned int tag)
-{
-    while (tags->id != CODEC_ID_NONE) {
-        if(   toupper((tag >> 0)&0xFF) == toupper((tags->tag >> 0)&0xFF)
-           && toupper((tag >> 8)&0xFF) == toupper((tags->tag >> 8)&0xFF)
-           && toupper((tag >>16)&0xFF) == toupper((tags->tag >>16)&0xFF)
-           && toupper((tag >>24)&0xFF) == toupper((tags->tag >>24)&0xFF))
-            return tags->id;
-        tags++;
-    }
-    return CODEC_ID_NONE;
-}
-
-unsigned int av_codec_get_tag(const AVCodecTag *tags[4], enum CodecID id)
-{
-    int i;
-    for(i=0; i<4 && tags[i]; i++){
-        int tag= codec_get_tag(tags[i], id);
-        if(tag) return tag;
-    }
-    return 0;
-}
-
-enum CodecID av_codec_get_id(const AVCodecTag *tags[4], unsigned int tag)
-{
-    int i;
-    for(i=0; i<4 && tags[i]; i++){
-        enum CodecID id= codec_get_id(tags[i], tag);
-        if(id!=CODEC_ID_NONE) return id;
-    }
-    return CODEC_ID_NONE;
-}
-
-unsigned int codec_get_bmp_tag(int id)
-{
-    return codec_get_tag(codec_bmp_tags, id);
-}
-
-unsigned int codec_get_wav_tag(int id)
-{
-    return codec_get_tag(codec_wav_tags, id);
-}
-
-enum CodecID codec_get_bmp_id(unsigned int tag)
-{
-    return codec_get_id(codec_bmp_tags, tag);
-}
-
-enum CodecID codec_get_wav_id(unsigned int tag)
-{
-    return codec_get_id(codec_wav_tags, tag);
-}
-
 #ifdef CONFIG_MUXERS
 offset_t start_tag(ByteIOContext *pb, const char *tag)
 {
@@ -296,8 +241,6 @@
     int hdrsize = 18;
 
     if(!enc->codec_tag || enc->codec_tag > 0xffff)
-       enc->codec_tag = codec_get_tag(codec_wav_tags, enc->codec_id);
-    if(!enc->codec_tag || enc->codec_tag > 0xffff)
         return -1;
 
     put_le16(pb, enc->codec_tag);
@@ -307,7 +250,7 @@
         enc->codec_id == CODEC_ID_PCM_ALAW ||
         enc->codec_id == CODEC_ID_PCM_MULAW) {
         bps = 8;
-    } else if (enc->codec_id == CODEC_ID_MP2 || enc->codec_id == CODEC_ID_MP3) {
+    } else if (enc->codec_id == CODEC_ID_MP2 || enc->codec_id == CODEC_ID_MP3 || enc->codec_id == CODEC_ID_GSM_MS) {
         bps = 0;
     } else if (enc->codec_id == CODEC_ID_ADPCM_IMA_WAV || enc->codec_id == CODEC_ID_ADPCM_MS || enc->codec_id == CODEC_ID_ADPCM_G726 || enc->codec_id == CODEC_ID_ADPCM_YAMAHA) { //
         bps = 4;
@@ -318,9 +261,12 @@
     } else {
         bps = 16;
     }
+    if(bps != enc->bits_per_sample && enc->bits_per_sample){
+        av_log(enc, AV_LOG_WARNING, "requested bits_per_sample (%d) and actually stored (%d) differ\n", enc->bits_per_sample, bps);
+    }
 
-    if (enc->codec_id == CODEC_ID_MP2 || enc->codec_id == CODEC_ID_MP3) {
-        blkalign = enc->frame_size; //this is wrong, but seems many demuxers dont work if this is set correctly
+    if (enc->codec_id == CODEC_ID_MP2 || enc->codec_id == CODEC_ID_MP3 || enc->codec_id == CODEC_ID_GSM_MS) {
+        blkalign = enc->frame_size; //this is wrong, but it seems many demuxers do not work if this is set correctly
         //blkalign = 144 * enc->bit_rate/enc->sample_rate;
     } else if (enc->codec_id == CODEC_ID_ADPCM_G726) { //
         blkalign = 1;
@@ -358,10 +304,14 @@
         put_le16(pb, 16); /* fwHeadFlags */
         put_le32(pb, 0);  /* dwPTSLow */
         put_le32(pb, 0);  /* dwPTSHigh */
+    } else if (enc->codec_id == CODEC_ID_GSM_MS) {
+        put_le16(pb, 2); /* wav_extra_size */
+        hdrsize += 2;
+        put_le16(pb, enc->frame_size); /* wSamplesPerBlock */
     } else if (enc->codec_id == CODEC_ID_ADPCM_IMA_WAV) {
         put_le16(pb, 2); /* wav_extra_size */
         hdrsize += 2;
-        put_le16(pb, ((enc->block_align - 4 * enc->channels) / (4 * enc->channels)) * 8 + 1); /* wSamplesPerBlock */
+        put_le16(pb, enc->frame_size); /* wSamplesPerBlock */
     } else if(enc->extradata_size){
         put_le16(pb, enc->extradata_size);
         put_buffer(pb, enc->extradata, enc->extradata_size);
@@ -387,10 +337,7 @@
 
     put_le16(pb, enc->bits_per_sample ? enc->bits_per_sample : 24); /* depth */
     /* compression type */
-
-    // MEANX we dont need that
-        assert(0);
-/*    put_le32(pb, for_asf ? (enc->codec_tag ? enc->codec_tag : av_codec_get_tag(asf_muxer.codec_tag, enc->codec_id)) : enc->codec_tag); //*/
+    put_le32(pb, enc->codec_tag);
     put_le32(pb, enc->width * enc->height * 3);
     put_le32(pb, 0);
     put_le32(pb, 0);
@@ -427,22 +374,30 @@
         codec->bits_per_sample = 8;
     }else
         codec->bits_per_sample = get_le16(pb);
-    codec->codec_id = wav_codec_get_id(id, codec->bits_per_sample);
-
-    if (size > 16) {  /* We're obviously dealing with WAVEFORMATEX */
-        codec->extradata_size = get_le16(pb);
-        if (codec->extradata_size > 0) {
-            if (codec->extradata_size > size - 18)
-                codec->extradata_size = size - 18;
+    if (size >= 18) {  /* We're obviously dealing with WAVEFORMATEX */
+        int cbSize = get_le16(pb); /* cbSize */
+        size -= 18;
+        cbSize = FFMIN(size, cbSize);
+        if (cbSize >= 22 && id == 0xfffe) { /* WAVEFORMATEXTENSIBLE */
+            codec->bits_per_sample = get_le16(pb);
+            get_le32(pb); /* dwChannelMask */
+            id = get_le32(pb); /* 4 first bytes of GUID */
+            url_fskip(pb, 12); /* skip end of GUID */
+            cbSize -= 22;
+            size -= 22;
+        }
+        codec->extradata_size = cbSize;
+        if (cbSize > 0) {
             codec->extradata = av_mallocz(codec->extradata_size + FF_INPUT_BUFFER_PADDING_SIZE);
             get_buffer(pb, codec->extradata, codec->extradata_size);
-        } else
-            codec->extradata_size = 0;
+            size -= cbSize;
+        }
 
         /* It is possible for the chunk to contain garbage at the end */
-        if (size - codec->extradata_size - 18 > 0)
-            url_fskip(pb, size - codec->extradata_size - 18);
+        if (size > 0)
+            url_fskip(pb, size);
     }
+    codec->codec_id = wav_codec_get_id(id, codec->bits_per_sample);
 }
 
 

Modified: branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavformat/riff.h
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavformat/riff.h	2007-07-16 16:39:52 UTC (rev 3382)
+++ branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavformat/riff.h	2007-07-16 17:44:22 UTC (rev 3383)
@@ -28,6 +28,9 @@
 #ifndef FF_RIFF_H
 #define FF_RIFF_H
 
+#include "avcodec.h"
+#include "avio.h"
+
 offset_t start_tag(ByteIOContext *pb, const char *tag);
 void end_tag(ByteIOContext *pb, offset_t start);
 
@@ -46,10 +49,6 @@
 
 unsigned int codec_get_tag(const AVCodecTag *tags, int id);
 enum CodecID codec_get_id(const AVCodecTag *tags, unsigned int tag);
-unsigned int codec_get_bmp_tag(int id) attribute_deprecated; //use av_codec_get_tag
-unsigned int codec_get_wav_tag(int id) attribute_deprecated; //use av_codec_get_tag
-enum CodecID codec_get_bmp_id(unsigned int tag) attribute_deprecated; //use av_codec_get_id
-enum CodecID codec_get_wav_id(unsigned int tag) attribute_deprecated; //use av_codec_get_id
 void ff_parse_specific_params(AVCodecContext *stream, int *au_rate, int *au_ssize, int *au_scale);
 
 #endif

Modified: branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavformat/rtp.h
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavformat/rtp.h	2007-07-16 16:39:52 UTC (rev 3382)
+++ branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavformat/rtp.h	2007-07-16 17:44:22 UTC (rev 3383)
@@ -21,11 +21,16 @@
 #ifndef RTP_H
 #define RTP_H
 
+#include "avcodec.h"
+#include "avformat.h"
+
 #define RTP_MIN_PACKET_LENGTH 12
 #define RTP_MAX_PACKET_LENGTH 1500 /* XXX: suppress this define */
 
 int rtp_init(void);
 int rtp_get_codec_info(AVCodecContext *codec, int payload_type);
+
+/** return < 0 if unknown payload type */
 int rtp_get_payload_type(AVCodecContext *codec);
 
 typedef struct RTPDemuxContext RTPDemuxContext;
@@ -42,17 +47,24 @@
 int rtp_set_remote_url(URLContext *h, const char *uri);
 void rtp_get_file_handles(URLContext *h, int *prtp_fd, int *prtcp_fd);
 
+/**
+ * some rtp servers assume client is dead if they don't hear from them...
+ * so we send a Receiver Report to the provided ByteIO context
+ * (we don't have access to the rtcp handle from here)
+ */
+int rtp_check_and_send_back_rr(RTPDemuxContext *s, int count);
+
 extern URLProtocol rtp_protocol;
 
 #define RTP_PT_PRIVATE 96
 #define RTP_VERSION 2
-#define RTP_MAX_SDES 256   /* maximum text length for SDES */
+#define RTP_MAX_SDES 256   /**< maximum text length for SDES */
 
 /* RTCP paquets use 0.5 % of the bandwidth */
 #define RTCP_TX_RATIO_NUM 5
 #define RTCP_TX_RATIO_DEN 1000
 
-/* Structure listing usefull vars to parse RTP packet payload*/
+/** Structure listing useful vars to parse RTP packet payload*/
 typedef struct rtp_payload_data_s
 {
     int sizelength;
@@ -63,7 +75,7 @@
     int objecttype;
     char *mode;
 
-    /* mpeg 4 AU headers */
+    /** mpeg 4 AU headers */
     struct AUHeaders {
         int size;
         int index;

Modified: branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavformat/rtsp.h
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavformat/rtsp.h	2007-07-16 16:39:52 UTC (rev 3382)
+++ branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavformat/rtsp.h	2007-07-16 17:44:22 UTC (rev 3383)
@@ -21,12 +21,9 @@
 #ifndef RTSP_H
 #define RTSP_H
 
-/* RTSP handling */
-enum RTSPStatusCode {
-#define DEF(n, c, s) c = n,
+#include <stdint.h>
+#include "avformat.h"
 #include "rtspcodes.h"
-#undef DEF
-};
 
 enum RTSPProtocol {
     RTSP_PROTOCOL_RTP_UDP = 0,
@@ -43,27 +40,27 @@
 #define RTSP_RTP_PORT_MAX 10000
 
 typedef struct RTSPTransportField {
-    int interleaved_min, interleaved_max;  /* interleave ids, if TCP transport */
-    int port_min, port_max; /* RTP ports */
-    int client_port_min, client_port_max; /* RTP ports */
-    int server_port_min, server_port_max; /* RTP ports */
-    int ttl; /* ttl value */
-    uint32_t destination; /* destination IP address */
+    int interleaved_min, interleaved_max;  /**< interleave ids, if TCP transport */
+    int port_min, port_max; /**< RTP ports */
+    int client_port_min, client_port_max; /**< RTP ports */
+    int server_port_min, server_port_max; /**< RTP ports */
+    int ttl; /**< ttl value */
+    uint32_t destination; /**< destination IP address */
     enum RTSPProtocol protocol;
 } RTSPTransportField;
 
 typedef struct RTSPHeader {
     int content_length;
-    enum RTSPStatusCode status_code; /* response code from server */
+    enum RTSPStatusCode status_code; /**< response code from server */
     int nb_transports;
-    /* in AV_TIME_BASE unit, AV_NOPTS_VALUE if not used */
+    /** in AV_TIME_BASE unit, AV_NOPTS_VALUE if not used */
     int64_t range_start, range_end;
     RTSPTransportField transports[RTSP_MAX_TRANSPORTS];
-    int seq; /* sequence number */
+    int seq; /**< sequence number */
     char session_id[512];
 } RTSPHeader;
 
-/* the callback can be used to extend the connection setup/teardown step */
+/** the callback can be used to extend the connection setup/teardown step */
 enum RTSPCallbackAction {
     RTSP_ACTION_SERVER_SETUP,
     RTSP_ACTION_SERVER_TEARDOWN,
@@ -81,15 +78,12 @@
                            char *buf, int buf_size,
                            void *arg);
 
-void rtsp_set_callback(FFRTSPCallback *rtsp_cb);
-
 int rtsp_init(void);
 void rtsp_parse_line(RTSPHeader *reply, const char *buf);
 
 extern int rtsp_default_protocols;
 extern int rtsp_rtp_port_min;
 extern int rtsp_rtp_port_max;
-extern FFRTSPCallback *ff_rtsp_callback;
 extern AVInputFormat rtsp_demuxer;
 
 int rtsp_pause(AVFormatContext *s);

Modified: branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavformat/rtspcodes.h
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavformat/rtspcodes.h	2007-07-16 16:39:52 UTC (rev 3382)
+++ branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavformat/rtspcodes.h	2007-07-16 17:44:22 UTC (rev 3383)
@@ -18,14 +18,23 @@
  * License along with FFmpeg; if not, write to the Free Software
  * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA
  */
-DEF(200, RTSP_STATUS_OK, "OK")
-DEF(405, RTSP_STATUS_METHOD, "Method Not Allowed")
-DEF(453, RTSP_STATUS_BANDWIDTH, "Not Enough Bandwidth")
-DEF(454, RTSP_STATUS_SESSION, "Session Not Found")
-DEF(455, RTSP_STATUS_STATE, "Method Not Valid in This State")
-DEF(459, RTSP_STATUS_AGGREGATE, "Aggregate operation not allowed")
-DEF(460, RTSP_STATUS_ONLY_AGGREGATE, "Only aggregate operation allowed")
-DEF(461, RTSP_STATUS_TRANSPORT, "Unsupported transport")
-DEF(500, RTSP_STATUS_INTERNAL, "Internal Server Error")
-DEF(503, RTSP_STATUS_SERVICE, "Service Unavailable")
-DEF(505, RTSP_STATUS_VERSION, "RTSP Version not supported")
+
+#ifndef AVFORMAT_RTSPCODES_H
+#define AVFORMAT_RTSPCODES_H
+
+/** RTSP handling */
+enum RTSPStatusCode {
+RTSP_STATUS_OK              =200, /**< OK */
+RTSP_STATUS_METHOD          =405, /**< Method Not Allowed */
+RTSP_STATUS_BANDWIDTH       =453, /**< Not Enough Bandwidth */
+RTSP_STATUS_SESSION         =454, /**< Session Not Found */
+RTSP_STATUS_STATE           =455, /**< Method Not Valid in This State */
+RTSP_STATUS_AGGREGATE       =459, /**< Aggregate operation not allowed */
+RTSP_STATUS_ONLY_AGGREGATE  =460, /**< Only aggregate operation allowed */
+RTSP_STATUS_TRANSPORT       =461, /**< Unsupported transport */
+RTSP_STATUS_INTERNAL        =500, /**< Internal Server Error */
+RTSP_STATUS_SERVICE         =503, /**< Service Unavailable */
+RTSP_STATUS_VERSION         =505, /**< RTSP Version not supported */
+};
+
+#endif // AVFORMAT_RTSPCODES_H

Modified: branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavformat/utils.c
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavformat/utils.c	2007-07-16 16:39:52 UTC (rev 3382)
+++ branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavformat/utils.c	2007-07-16 17:44:22 UTC (rev 3383)
@@ -21,6 +21,8 @@
 #include "avformat.h"
 #include "allformats.h"
 #include "opt.h"
+#include "avstring.h"
+#include "riff.h"
 
 #undef NDEBUG
 #include <assert.h>
@@ -139,9 +141,6 @@
     return fmt;
 }
 
-/**
- * Guesses the codec id based upon muxer and filename.
- */
 enum CodecID av_guess_codec(AVOutputFormat *fmt, const char *short_name,
                             const char *filename, const char *mime_type, enum CodecType type){
     if(type == CODEC_TYPE_VIDEO){
@@ -161,9 +160,6 @@
         return CODEC_ID_NONE;
 }
 
-/**
- * finds AVInputFormat based on input format's short name.
- */
 AVInputFormat *av_find_input_format(const char *short_name)
 {
     AVInputFormat *fmt;
@@ -176,22 +172,23 @@
 
 /* memory handling */
 
-/**
- * Default packet destructor.
- */
 void av_destruct_packet(AVPacket *pkt)
 {
     av_free(pkt->data);
     pkt->data = NULL; pkt->size = 0;
 }
 
-/**
- * Allocate the payload of a packet and intialized its fields to default values.
- *
- * @param pkt packet
- * @param size wanted payload size
- * @return 0 if OK. AVERROR_xxx otherwise.
- */
+void av_init_packet(AVPacket *pkt)
+{
+    pkt->pts   = AV_NOPTS_VALUE;
+    pkt->dts   = AV_NOPTS_VALUE;
+    pkt->pos   = -1;
+    pkt->duration = 0;
+    pkt->flags = 0;
+    pkt->stream_index = 0;
+    pkt->destruct= av_destruct_packet_nofree;
+}
+
 int av_new_packet(AVPacket *pkt, int size)
 {
     uint8_t *data;
@@ -209,13 +206,6 @@
     return 0;
 }
 
-/**
- * Allocate and read the payload of a packet and intialized its fields to default values.
- *
- * @param pkt packet
- * @param size wanted payload size
- * @return >0 (read size) if OK. AVERROR_xxx otherwise.
- */
 int av_get_packet(ByteIOContext *s, AVPacket *pkt, int size)
 {
     int ret= av_new_packet(pkt, size);
@@ -234,8 +224,6 @@
     return ret;
 }
 
-/* This is a hack - the packet memory allocation stuff is broken. The
-   packet is allocated if it was not really allocated */
 int av_dup_packet(AVPacket *pkt)
 {
     if (pkt->destruct != av_destruct_packet) {
@@ -256,31 +244,18 @@
     return 0;
 }
 
-/**
- * Allocate the payload of a packet and intialized its fields to default values.
- *
- * @param filename possible numbered sequence string
- * @return 1 if a valid numbered sequence string, 0 otherwise.
- */
 int av_filename_number_test(const char *filename)
 {
     char buf[1024];
     return filename && (av_get_frame_filename(buf, sizeof(buf), filename, 1)>=0);
 }
 
-/**
- * Guess file format.
- *
- * @param is_opened whether the file is already opened, determines whether
- *                  demuxers with or without AVFMT_NOFILE are probed
- */
-AVInputFormat *av_probe_input_format(AVProbeData *pd, int is_opened)
+static AVInputFormat *av_probe_input_format2(AVProbeData *pd, int is_opened, int *score_max)
 {
     AVInputFormat *fmt1, *fmt;
-    int score, score_max;
+    int score;
 
     fmt = NULL;
-    score_max = 0;
     for(fmt1 = first_iformat; fmt1 != NULL; fmt1 = fmt1->next) {
         if (!is_opened == !(fmt1->flags & AVFMT_NOFILE))
             continue;
@@ -292,14 +267,19 @@
                 score = 50;
             }
         }
-        if (score > score_max) {
-            score_max = score;
+        if (score > *score_max) {
+            *score_max = score;
             fmt = fmt1;
         }
     }
     return fmt;
 }
 
+AVInputFormat *av_probe_input_format(AVProbeData *pd, int is_opened){
+    int score=0;
+    return av_probe_input_format2(pd, is_opened, &score);
+}
+
 /************************************************************/
 /* input media file */
 
@@ -315,7 +295,7 @@
 }
 
 #define OFFSET(x) offsetof(AVFormatContext,x)
-#define DEFAULT 0 //should be NAN but it doesnt work as its not a constant in glibc as required by ANSI/ISO C
+#define DEFAULT 0 //should be NAN but it does not work as it is not a constant in glibc as required by ANSI/ISO C
 //these names are too long to be readable
 #define E AV_OPT_FLAG_ENCODING_PARAM
 #define D AV_OPT_FLAG_DECODING_PARAM
@@ -329,6 +309,7 @@
 {"genpts", "generate pts", 0, FF_OPT_TYPE_CONST, AVFMT_FLAG_GENPTS, INT_MIN, INT_MAX, D, "fflags"},
 {"track", " set the track number", OFFSET(track), FF_OPT_TYPE_INT, DEFAULT, 0, INT_MAX, E},
 {"year", "set the year", OFFSET(year), FF_OPT_TYPE_INT, DEFAULT, INT_MIN, INT_MAX, E},
+{"analyzeduration", "how many microseconds are analyzed to estimate duration", OFFSET(max_analyze_duration), FF_OPT_TYPE_INT, 3*AV_TIME_BASE, 0, INT_MAX, D},
 {NULL},
 };
 
@@ -357,10 +338,6 @@
     return ic;
 }
 
-/**
- * Allocates all the structures needed to read an input stream.
- *        This does not open the needed codecs for decoding the stream[s].
- */
 int av_open_input_stream(AVFormatContext **ic_ptr,
                          ByteIOContext *pb, const char *filename,
                          AVInputFormat *fmt, AVFormatParameters *ap)
@@ -387,7 +364,7 @@
         ic->pb = *pb;
     ic->duration = AV_NOPTS_VALUE;
     ic->start_time = AV_NOPTS_VALUE;
-    pstrcpy(ic->filename, sizeof(ic->filename), filename);
+    av_strlcpy(ic->filename, filename, sizeof(ic->filename));
 
     /* allocate private data */
     if (fmt->priv_data_size > 0) {
@@ -422,17 +399,6 @@
 #define PROBE_BUF_MIN 2048
 #define PROBE_BUF_MAX (1<<20)
 
-/**
- * Open a media file as input. The codec are not opened. Only the file
- * header (if present) is read.
- *
- * @param ic_ptr the opened media file handle is put here
- * @param filename filename to open.
- * @param fmt if non NULL, force the file format to use
- * @param buf_size optional buffer size (zero if default is OK)
- * @param ap additionnal parameters needed when opening the file (NULL if default)
- * @return 0 if OK. AVERROR_xxx otherwise.
- */
 int av_open_input_file(AVFormatContext **ic_ptr, const char *filename,
                        AVInputFormat *fmt,
                        int buf_size,
@@ -459,13 +425,12 @@
     must_open_file = 1;
     if (fmt && (fmt->flags & AVFMT_NOFILE)) {
         must_open_file = 0;
-        pb= NULL; //FIXME this or memset(pb, 0, sizeof(ByteIOContext)); otherwise its uninitalized
+        pb= NULL; //FIXME this or memset(pb, 0, sizeof(ByteIOContext)); otherwise it is uninitialized
     }
 
     if (!fmt || must_open_file) {
         /* if no file needed do not try to open one */
-        if (url_fopen(pb, filename, URL_RDONLY) < 0) {
-            err = AVERROR_IO;
+        if ((err=url_fopen(pb, filename, URL_RDONLY)) < 0) {
             goto fail;
         }
         file_opened = 1;
@@ -474,10 +439,11 @@
         }
 
         for(probe_size= PROBE_BUF_MIN; probe_size<=PROBE_BUF_MAX && !fmt; probe_size<<=1){
+            int score= probe_size < PROBE_BUF_MAX ? AVPROBE_SCORE_MAX/4 : 0;
             /* read probe data */
-            pd->buf= av_realloc(pd->buf, probe_size);
+            pd->buf= av_realloc(pd->buf, probe_size + AVPROBE_PADDING_SIZE);
             pd->buf_size = get_buffer(pb, pd->buf, probe_size);
-            if (url_fseek(pb, 0, SEEK_SET) == (offset_t)-EPIPE) {
+            if (url_fseek(pb, 0, SEEK_SET) < 0) {
                 url_fclose(pb);
                 if (url_fopen(pb, filename, URL_RDONLY) < 0) {
                     file_opened = 0;
@@ -486,7 +452,7 @@
                 }
             }
             /* guess file format */
-            fmt = av_probe_input_format(pd, 1);
+            fmt = av_probe_input_format2(pd, 1, &score);
         }
         av_freep(&pd->buf);
     }
@@ -498,7 +464,7 @@
     }
 
     /* XXX: suppress this hack for redirectors */
-#ifdef CONFIG_NETWORK
+#ifdef CONFIG_REDIR_DEMUXER
     if (fmt == &redir_demuxer) {
         err = redir_open(ic_ptr, pb);
         url_fclose(pb);
@@ -528,18 +494,9 @@
 
 /*******************************************************/
 
-/**
- * Read a transport packet from a media file.
- *
- * This function is absolete and should never be used.
- * Use av_read_frame() instead.
- *
- * @param s media file handle
- * @param pkt is filled
- * @return 0 if OK. AVERROR_xxx if error.
- */
 int av_read_packet(AVFormatContext *s, AVPacket *pkt)
 {
+    av_init_packet(pkt);
     return s->iformat->read_packet(s, pkt);
 }
 
@@ -639,7 +596,8 @@
 static void compute_pkt_fields(AVFormatContext *s, AVStream *st,
                                AVCodecParserContext *pc, AVPacket *pkt)
 {
-    int num, den, presentation_delayed;
+    int num, den, presentation_delayed, delay, i;
+    int64_t offset;
     /* handle wrapping */
     if(st->cur_dts != AV_NOPTS_VALUE){
         if(pkt->pts != AV_NOPTS_VALUE)
@@ -655,95 +613,95 @@
         }
     }
 
+    /* correct timestamps with byte offset if demuxers only have timestamps on packet boundaries */
+    if(pc && st->need_parsing == AVSTREAM_PARSE_TIMESTAMPS && pkt->size){
+        /* this will estimate bitrate based on this frame's duration and size */
+        offset = av_rescale(pc->offset, pkt->duration, pkt->size);
+        if(pkt->pts != AV_NOPTS_VALUE)
+            pkt->pts += offset;
+        if(pkt->dts != AV_NOPTS_VALUE)
+            pkt->dts += offset;
+    }
+
     if(is_intra_only(st->codec))
         pkt->flags |= PKT_FLAG_KEY;
 
     /* do we have a video B frame ? */
+    delay= st->codec->has_b_frames;
     presentation_delayed = 0;
-    if (st->codec->codec_type == CODEC_TYPE_VIDEO) {
-        /* XXX: need has_b_frame, but cannot get it if the codec is
-           not initialized */
-        if ((   st->codec->codec_id == CODEC_ID_H264
-             || st->codec->has_b_frames) &&
-            pc && pc->pict_type != FF_B_TYPE)
-            presentation_delayed = 1;
-        /* this may be redundant, but it shouldnt hurt */
-        if(pkt->dts != AV_NOPTS_VALUE && pkt->pts != AV_NOPTS_VALUE && pkt->pts > pkt->dts)
-            presentation_delayed = 1;
-    }
+    /* XXX: need has_b_frame, but cannot get it if the codec is
+        not initialized */
+    if (delay &&
+        pc && pc->pict_type != FF_B_TYPE)
+        presentation_delayed = 1;
+    /* This may be redundant, but it should not hurt. */
+    if(pkt->dts != AV_NOPTS_VALUE && pkt->pts != AV_NOPTS_VALUE && pkt->pts > pkt->dts)
+        presentation_delayed = 1;
 
     if(st->cur_dts == AV_NOPTS_VALUE){
-        if(presentation_delayed) st->cur_dts = -pkt->duration;
-        else                     st->cur_dts = 0;
+        st->cur_dts = -delay * pkt->duration;
     }
 
 //    av_log(NULL, AV_LOG_DEBUG, "IN delayed:%d pts:%"PRId64", dts:%"PRId64" cur_dts:%"PRId64" st:%d pc:%p\n", presentation_delayed, pkt->pts, pkt->dts, st->cur_dts, pkt->stream_index, pc);
     /* interpolate PTS and DTS if they are not present */
-    if (presentation_delayed) {
-        /* DTS = decompression time stamp */
-        /* PTS = presentation time stamp */
-        if (pkt->dts == AV_NOPTS_VALUE) {
-            /* if we know the last pts, use it */
-            if(st->last_IP_pts != AV_NOPTS_VALUE)
-                st->cur_dts = pkt->dts = st->last_IP_pts;
-            else
+    if(delay <=1){
+        if (presentation_delayed) {
+            /* DTS = decompression time stamp */
+            /* PTS = presentation time stamp */
+            if (pkt->dts == AV_NOPTS_VALUE)
+                pkt->dts = st->last_IP_pts;
+            if (pkt->dts == AV_NOPTS_VALUE)
                 pkt->dts = st->cur_dts;
-        } else {
-            st->cur_dts = pkt->dts;
-        }
-        /* this is tricky: the dts must be incremented by the duration
-           of the frame we are displaying, i.e. the last I or P frame */
-        if (st->last_IP_duration == 0)
-            st->cur_dts += pkt->duration;
-        else
-            st->cur_dts += st->last_IP_duration;
-        st->last_IP_duration  = pkt->duration;
-        st->last_IP_pts= pkt->pts;
-        /* cannot compute PTS if not present (we can compute it only
-           by knowing the futur */
-    } else if(pkt->pts != AV_NOPTS_VALUE || pkt->dts != AV_NOPTS_VALUE || pkt->duration){
-        if(pkt->pts != AV_NOPTS_VALUE && pkt->duration){
-            int64_t old_diff= FFABS(st->cur_dts - pkt->duration - pkt->pts);
-            int64_t new_diff= FFABS(st->cur_dts - pkt->pts);
-            if(old_diff < new_diff && old_diff < (pkt->duration>>3)){
-                pkt->pts += pkt->duration;
-//                av_log(NULL, AV_LOG_DEBUG, "id:%d old:%"PRId64" new:%"PRId64" dur:%d cur:%"PRId64" size:%d\n", pkt->stream_index, old_diff, new_diff, pkt->duration, st->cur_dts, pkt->size);
-            }
-        }
 
-        /* presentation is not delayed : PTS and DTS are the same */
-        if (pkt->pts == AV_NOPTS_VALUE) {
-            if (pkt->dts == AV_NOPTS_VALUE) {
-                pkt->pts = st->cur_dts;
-                pkt->dts = st->cur_dts;
+            /* this is tricky: the dts must be incremented by the duration
+            of the frame we are displaying, i.e. the last I or P frame */
+            if (st->last_IP_duration == 0)
+                st->last_IP_duration = pkt->duration;
+            st->cur_dts = pkt->dts + st->last_IP_duration;
+            st->last_IP_duration  = pkt->duration;
+            st->last_IP_pts= pkt->pts;
+            /* cannot compute PTS if not present (we can compute it only
+            by knowing the futur */
+        } else if(pkt->pts != AV_NOPTS_VALUE || pkt->dts != AV_NOPTS_VALUE || pkt->duration){
+            if(pkt->pts != AV_NOPTS_VALUE && pkt->duration){
+                int64_t old_diff= FFABS(st->cur_dts - pkt->duration - pkt->pts);
+                int64_t new_diff= FFABS(st->cur_dts - pkt->pts);
+                if(old_diff < new_diff && old_diff < (pkt->duration>>3)){
+                    pkt->pts += pkt->duration;
+    //                av_log(NULL, AV_LOG_DEBUG, "id:%d old:%"PRId64" new:%"PRId64" dur:%d cur:%"PRId64" size:%d\n", pkt->stream_index, old_diff, new_diff, pkt->duration, st->cur_dts, pkt->size);
+                }
             }
-            else {
-                st->cur_dts = pkt->dts;
+
+            /* presentation is not delayed : PTS and DTS are the same */
+            if(pkt->pts == AV_NOPTS_VALUE)
                 pkt->pts = pkt->dts;
-            }
-        } else {
-            st->cur_dts = pkt->pts;
+            if(pkt->pts == AV_NOPTS_VALUE)
+                pkt->pts = st->cur_dts;
             pkt->dts = pkt->pts;
+            st->cur_dts = pkt->pts + pkt->duration;
         }
-        st->cur_dts += pkt->duration;
     }
-//    av_log(NULL, AV_LOG_DEBUG, "OUTdelayed:%d pts:%"PRId64", dts:%"PRId64" cur_dts:%"PRId64"\n", presentation_delayed, pkt->pts, pkt->dts, st->cur_dts);
 
+    if(pkt->pts != AV_NOPTS_VALUE){
+        st->pts_buffer[0]= pkt->pts;
+        for(i=1; i<delay+1 && st->pts_buffer[i] == AV_NOPTS_VALUE; i++)
+            st->pts_buffer[i]= (i-delay-1) * pkt->duration;
+        for(i=0; i<delay && st->pts_buffer[i] > st->pts_buffer[i+1]; i++)
+            FFSWAP(int64_t, st->pts_buffer[i], st->pts_buffer[i+1]);
+        if(pkt->dts == AV_NOPTS_VALUE)
+            pkt->dts= st->pts_buffer[0];
+        if(pkt->dts > st->cur_dts)
+            st->cur_dts = pkt->dts;
+    }
+
+//    av_log(NULL, AV_LOG_ERROR, "OUTdelayed:%d/%d pts:%"PRId64", dts:%"PRId64" cur_dts:%"PRId64"\n", presentation_delayed, delay, pkt->pts, pkt->dts, st->cur_dts);
+
     /* update flags */
     if (pc) {
         pkt->flags = 0;
         /* key frame computation */
-        switch(st->codec->codec_type) {
-        case CODEC_TYPE_VIDEO:
             if (pc->pict_type == FF_I_TYPE)
                 pkt->flags |= PKT_FLAG_KEY;
-            break;
-        case CODEC_TYPE_AUDIO:
-            pkt->flags |= PKT_FLAG_KEY;
-            break;
-        default:
-            break;
-        }
     }
 }
 
@@ -757,6 +715,8 @@
     AVStream *st;
     int len, ret, i;
 
+    av_init_packet(pkt);
+
     for(;;) {
         /* select current input stream component */
         st = s->cur_st;
@@ -781,12 +741,19 @@
                 /* return packet if any */
                 if (pkt->size) {
                 got_packet:
+                    pkt->pos = s->cur_pkt.pos;              // Isn't quite accurate but close.
                     pkt->duration = 0;
                     pkt->stream_index = st->index;
                     pkt->pts = st->parser->pts;
                     pkt->dts = st->parser->dts;
                     pkt->destruct = av_destruct_packet_nofree;
                     compute_pkt_fields(s, st, st->parser, pkt);
+
+                    if((s->iformat->flags & AVFMT_GENERIC_INDEX) && pkt->flags & PKT_FLAG_KEY){
+                        av_add_index_entry(st, st->parser->frame_offset, pkt->dts,
+                                           0, 0, AVINDEX_KEYFRAME);
+                    }
+
                     break;
                 }
             } else {
@@ -798,7 +765,7 @@
             /* read next packet */
             ret = av_read_packet(s, &s->cur_pkt);
             if (ret < 0) {
-                if (ret == -EAGAIN)
+                if (ret == AVERROR(EAGAIN))
                     return ret;
                 /* return the last frames, if any */
                 for(i = 0; i < s->nb_streams; i++) {
@@ -831,10 +798,14 @@
                 st->parser = av_parser_init(st->codec->codec_id);
                 if (!st->parser) {
                     /* no parser available : just output the raw packets */
-                    st->need_parsing = 0;
-                }else if(st->need_parsing == 2){
+                    st->need_parsing = AVSTREAM_PARSE_NONE;
+                }else if(st->need_parsing == AVSTREAM_PARSE_HEADERS){
                     st->parser->flags |= PARSER_FLAG_COMPLETE_FRAMES;
                 }
+                if(st->parser && (s->iformat->flags & AVFMT_GENERIC_INDEX)){
+                    st->parser->last_frame_offset=
+                    st->parser->cur_offset= s->cur_pkt.pos;
+                }
             }
         }
     }
@@ -848,25 +819,6 @@
     return 0;
 }
 
-/**
- * Return the next frame of a stream.
- *
- * The returned packet is valid
- * until the next av_read_frame() or until av_close_input_file() and
- * must be freed with av_free_packet. For video, the packet contains
- * exactly one frame. For audio, it contains an integer number of
- * frames if each frame has a known fixed size (e.g. PCM or ADPCM
- * data). If the audio frames have a variable size (e.g. MPEG audio),
- * then it contains one frame.
- *
- * pkt->pts, pkt->dts and pkt->duration are always set to correct
- * values in AV_TIME_BASE unit (and guessed if the format cannot
- * provided them). pkt->pts can be AV_NOPTS_VALUE if the video format
- * has B frames, so it is better to rely on pkt->dts if you do not
- * decompress the payload.
- *
- * @return 0 if OK, < 0 if error or end of file.
- */
 int av_read_frame(AVFormatContext *s, AVPacket *pkt)
 {
     AVPacketList *pktl;
@@ -905,7 +857,7 @@
             AVPacketList **plast_pktl= &s->packet_buffer;
             int ret= av_read_frame_internal(s, pkt);
             if(ret<0){
-                if(pktl && ret != -EAGAIN){
+                if(pktl && ret != AVERROR(EAGAIN)){
                     eof=1;
                     continue;
                 }else
@@ -995,18 +947,10 @@
             st->parser = NULL;
         }
         st->last_IP_pts = AV_NOPTS_VALUE;
-        st->cur_dts = 0; /* we set the current DTS to an unspecified origin */
+        st->cur_dts = AV_NOPTS_VALUE; /* we set the current DTS to an unspecified origin */
     }
 }
 
-/**
- * Updates cur_dts of all streams based on given timestamp and AVStream.
- *
- * Stream ref_st unchanged, others set cur_dts in their native timebase
- * only needed for timestamp wrapping or if (dts not set and pts!=dts)
- * @param timestamp new dts expressed in time_base of param ref_st
- * @param ref_st reference stream giving time_base of param timestamp
- */
 void av_update_cur_dts(AVFormatContext *s, AVStream *ref_st, int64_t timestamp){
     int i;
 
@@ -1019,11 +963,6 @@
     }
 }
 
-/**
- * Add a index entry into a sorted list updateing if it is already there.
- *
- * @param timestamp timestamp in the timebase of the given stream
- */
 int av_add_index_entry(AVStream *st,
                             int64_t pos, int64_t timestamp, int size, int distance, int flags)
 {
@@ -1055,7 +994,7 @@
                 return -1;
             memmove(entries + index + 1, entries + index, sizeof(AVIndexEntry)*(st->nb_index_entries - index));
             st->nb_index_entries++;
-        }else if(ie->pos == pos && distance < ie->min_distance) //dont reduce the distance
+        }else if(ie->pos == pos && distance < ie->min_distance) //do not reduce the distance
             distance= ie->min_distance;
     }
 
@@ -1068,57 +1007,6 @@
     return index;
 }
 
-/**
- * build an index for raw streams using a parser.
- */
-static void av_build_index_raw(AVFormatContext *s)
-{
-    AVPacket pkt1, *pkt = &pkt1;
-    int ret;
-    AVStream *st;
-
-    st = s->streams[0];
-    av_read_frame_flush(s);
-    url_fseek(&s->pb, s->data_offset, SEEK_SET);
-
-    for(;;) {
-        ret = av_read_frame(s, pkt);
-        if (ret < 0)
-            break;
-        if (pkt->stream_index == 0 && st->parser &&
-            (pkt->flags & PKT_FLAG_KEY)) {
-            av_add_index_entry(st, st->parser->frame_offset, pkt->dts,
-                            0, 0, AVINDEX_KEYFRAME);
-        }
-        av_free_packet(pkt);
-    }
-}
-
-/**
- * Returns TRUE if we deal with a raw stream.
- *
- * Raw codec data and parsing needed.
- */
-static int is_raw_stream(AVFormatContext *s)
-{
-    AVStream *st;
-
-    if (s->nb_streams != 1)
-        return 0;
-    st = s->streams[0];
-    if (!st->need_parsing)
-        return 0;
-    return 1;
-}
-
-/**
- * Gets the index for a specific timestamp.
- * @param flags if AVSEEK_FLAG_BACKWARD then the returned index will correspond to
- *                 the timestamp which is <= the requested one, if backward is 0
- *                 then it will be >=
- *              if AVSEEK_FLAG_ANY seek to any frame, only keyframes otherwise
- * @return < 0 if no such timestamp could be found
- */
 int av_index_search_timestamp(AVStream *st, int64_t wanted_timestamp,
                               int flags)
 {
@@ -1153,12 +1041,6 @@
 
 #define DEBUG_SEEK
 
-/**
- * Does a binary search using av_index_search_timestamp() and AVCodec.read_timestamp().
- * this isnt supposed to be called directly by a user application, but by demuxers
- * @param target_ts target timestamp in the time base of the given stream
- * @param stream_index stream number
- */
 int av_seek_frame_binary(AVFormatContext *s, int stream_index, int64_t target_ts, int flags){
     AVInputFormat *avif= s->iformat;
     int64_t pos_min, pos_max, pos, pos_limit;
@@ -1175,7 +1057,7 @@
 
     ts_max=
     ts_min= AV_NOPTS_VALUE;
-    pos_limit= -1; //gcc falsely says it may be uninitalized
+    pos_limit= -1; //gcc falsely says it may be uninitialized
 
     st= s->streams[stream_index];
     if(st->index_entries){
@@ -1223,12 +1105,6 @@
     return 0;
 }
 
-/**
- * Does a binary search using read_timestamp().
- * this isnt supposed to be called directly by a user application, but by demuxers
- * @param target_ts target timestamp in the time base of the given stream
- * @param stream_index stream number
- */
 int64_t av_gen_search(AVFormatContext *s, int stream_index, int64_t target_ts, int64_t pos_min, int64_t pos_max, int64_t pos_limit, int64_t ts_min, int64_t ts_max, int flags, int64_t *ts_ret, int64_t (*read_timestamp)(struct AVFormatContext *, int , int64_t *, int64_t )){
     int64_t pos, ts;
     int64_t start_pos, filesize;
@@ -1311,6 +1187,10 @@
 #ifdef DEBUG_SEEK
 av_log(s, AV_LOG_DEBUG, "%"PRId64" %"PRId64" %"PRId64" / %"PRId64" %"PRId64" %"PRId64" target:%"PRId64" limit:%"PRId64" start:%"PRId64" noc:%d\n", pos_min, pos, pos_max, ts_min, ts, ts_max, target_ts, pos_limit, start_pos, no_change);
 #endif
+        if(ts == AV_NOPTS_VALUE){
+            av_log(s, AV_LOG_ERROR, "read_timestamp() failed in the middle\n");
+            return -1;
+        }
         assert(ts != AV_NOPTS_VALUE);
         if (target_ts <= ts) {
             pos_limit = start_pos - 1;
@@ -1369,23 +1249,42 @@
     AVStream *st;
     AVIndexEntry *ie;
 
-    if (!s->index_built) {
-        if (is_raw_stream(s)) {
-            av_build_index_raw(s);
-        } else {
-            return -1;
-        }
-        s->index_built = 1;
-    }
-
     st = s->streams[stream_index];
+
     index = av_index_search_timestamp(st, timestamp, flags);
+
+    if(index < 0 || index==st->nb_index_entries-1){
+        int i;
+        AVPacket pkt;
+
+        if(st->index_entries && st->nb_index_entries){
+            ie= &st->index_entries[st->nb_index_entries-1];
+            url_fseek(&s->pb, ie->pos, SEEK_SET);
+            av_update_cur_dts(s, st, ie->timestamp);
+        }else
+            url_fseek(&s->pb, 0, SEEK_SET);
+
+        for(i=0;; i++) {
+            int ret = av_read_frame(s, &pkt);
+            if(ret<0)
+                break;
+            av_free_packet(&pkt);
+            if(stream_index == pkt.stream_index){
+                if((pkt.flags & PKT_FLAG_KEY) && pkt.dts > timestamp)
+                    break;
+            }
+        }
+        index = av_index_search_timestamp(st, timestamp, flags);
+    }
     if (index < 0)
         return -1;
 
-    /* now we have found the index, we can seek */
-    ie = &st->index_entries[index];
     av_read_frame_flush(s);
+    if (s->iformat->read_seek){
+        if(s->iformat->read_seek(s, stream_index, timestamp, flags) >= 0)
+            return 0;
+    }
+    ie = &st->index_entries[index];
     url_fseek(&s->pb, ie->pos, SEEK_SET);
 
     av_update_cur_dts(s, st, ie->timestamp);
@@ -1393,17 +1292,6 @@
     return 0;
 }
 
-/**
- * Seek to the key frame at timestamp.
- * 'timestamp' in 'stream_index'.
- * @param stream_index If stream_index is (-1), a default
- * stream is selected, and timestamp is automatically converted
- * from AV_TIME_BASE units to the stream specific time_base.
- * @param timestamp timestamp in AVStream.time_base units
- *        or if there is no stream specified then in AV_TIME_BASE units
- * @param flags flags which select direction and seeking mode
- * @return >= 0 on success
- */
 int av_seek_frame(AVFormatContext *s, int stream_index, int64_t timestamp, int flags)
 {
     int ret;
@@ -1557,7 +1445,7 @@
 #define DURATION_MAX_READ_SIZE 250000
 
 /* only usable for MPEG-PS streams */
-static void av_estimate_timings_from_pts(AVFormatContext *ic)
+static void av_estimate_timings_from_pts(AVFormatContext *ic, offset_t old_offset)
 {
     AVPacket pkt1, *pkt = &pkt1;
     AVStream *st;
@@ -1649,10 +1537,10 @@
 
     fill_all_stream_timings(ic);
 
-    url_fseek(&ic->pb, 0, SEEK_SET);
+    url_fseek(&ic->pb, old_offset, SEEK_SET);
 }
 
-static void av_estimate_timings(AVFormatContext *ic)
+static void av_estimate_timings(AVFormatContext *ic, offset_t old_offset)
 {
     int64_t file_size;
 
@@ -1670,7 +1558,7 @@
          !strcmp(ic->iformat->name, "mpegts")) &&
         file_size && !ic->pb.is_streamed) {
         /* get accurate estimate from the PTSes */
-        av_estimate_timings_from_pts(ic);
+        av_estimate_timings_from_pts(ic, old_offset);
     } else if (av_has_timings(ic)) {
         /* at least one components has timings - we use them for all
            the components */
@@ -1720,7 +1608,7 @@
 {
     int16_t *samples;
     AVCodec *codec;
-    int got_picture, ret=0;
+    int got_picture, data_size, ret=0;
     AVFrame picture;
 
   if(!st->codec->codec){
@@ -1739,11 +1627,12 @@
                                    &got_picture, (uint8_t *)data, size);
         break;
     case CODEC_TYPE_AUDIO:
-        samples = av_malloc(AVCODEC_MAX_AUDIO_FRAME_SIZE);
+        data_size = FFMAX(size, AVCODEC_MAX_AUDIO_FRAME_SIZE);
+        samples = av_malloc(data_size);
         if (!samples)
             goto fail;
-        ret = avcodec_decode_audio(st->codec, samples,
-                                   &got_picture, (uint8_t *)data, size);
+        ret = avcodec_decode_audio2(st->codec, samples,
+                                    &data_size, (uint8_t *)data, size);
         av_free(samples);
         break;
     default:
@@ -1754,28 +1643,72 @@
     return ret;
 }
 
+static int set_codec_from_probe_data(AVStream *st, AVProbeData *pd, int score)
+{
+    AVInputFormat *fmt;
+    fmt = av_probe_input_format2(pd, 1, &score);
+
+    if (fmt) {
+        if (strncmp(fmt->name, "mp3", 3) == 0)
+            st->codec->codec_id = CODEC_ID_MP3;
+        else if (strncmp(fmt->name, "ac3", 3) == 0)
+            st->codec->codec_id = CODEC_ID_AC3;
+    }
+    return !!fmt;
+}
+
+unsigned int codec_get_tag(const AVCodecTag *tags, int id)
+{
+    while (tags->id != CODEC_ID_NONE) {
+        if (tags->id == id)
+            return tags->tag;
+        tags++;
+    }
+    return 0;
+}
+
+enum CodecID codec_get_id(const AVCodecTag *tags, unsigned int tag)
+{
+    while (tags->id != CODEC_ID_NONE) {
+        if(   toupper((tag >> 0)&0xFF) == toupper((tags->tag >> 0)&0xFF)
+           && toupper((tag >> 8)&0xFF) == toupper((tags->tag >> 8)&0xFF)
+           && toupper((tag >>16)&0xFF) == toupper((tags->tag >>16)&0xFF)
+           && toupper((tag >>24)&0xFF) == toupper((tags->tag >>24)&0xFF))
+            return tags->id;
+        tags++;
+    }
+    return CODEC_ID_NONE;
+}
+
+unsigned int av_codec_get_tag(const AVCodecTag *tags[4], enum CodecID id)
+{
+    int i;
+    for(i=0; tags && tags[i]; i++){
+        int tag= codec_get_tag(tags[i], id);
+        if(tag) return tag;
+    }
+    return 0;
+}
+
+enum CodecID av_codec_get_id(const AVCodecTag *tags[4], unsigned int tag)
+{
+    int i;
+    for(i=0; tags && tags[i]; i++){
+        enum CodecID id= codec_get_id(tags[i], tag);
+        if(id!=CODEC_ID_NONE) return id;
+    }
+    return CODEC_ID_NONE;
+}
+
 /* absolute maximum size we read until we abort */
 #define MAX_READ_SIZE        5000000
 
-/* maximum duration until we stop analysing the stream */
-#define MAX_STREAM_DURATION  ((int)(AV_TIME_BASE * 3.0))
-
 #define MAX_STD_TIMEBASES (60*12+5)
 static int get_std_framerate(int i){
     if(i<60*12) return i*1001;
     else        return ((int[]){24,30,60,12,15})[i-60*12]*1000*12;
 }
 
-/**
- * Read the beginning of a media file to get stream information. This
- * is useful for file formats with no headers such as MPEG. This
- * function also compute the real frame rate in case of mpeg2 repeat
- * frame mode.
- *
- * @param ic media file handle
- * @return >=0 if OK. AVERROR_xxx if error.
- * @todo let user decide somehow what information is needed so we dont waste time geting stuff the user doesnt need
- */
 int av_find_stream_info(AVFormatContext *ic)
 {
     int i, count, ret, read_size, j;
@@ -1784,8 +1717,16 @@
     AVPacketList *pktl=NULL, **ppktl;
     int64_t last_dts[MAX_STREAMS];
     int duration_count[MAX_STREAMS]={0};
-    double duration_error[MAX_STREAMS][MAX_STD_TIMEBASES]={{0}}; //FIXME malloc()?
+    double (*duration_error)[MAX_STD_TIMEBASES];
+    offset_t old_offset = url_ftell(&ic->pb);
+    int64_t codec_info_duration[MAX_STREAMS]={0};
+    int codec_info_nb_frames[MAX_STREAMS]={0};
+    AVProbeData probe_data[MAX_STREAMS];
+    int codec_identified[MAX_STREAMS]={0};
 
+    duration_error = av_mallocz(MAX_STREAMS * sizeof(*duration_error));
+    if (!duration_error) return AVERROR_NOMEM;
+
     for(i=0;i<ic->nb_streams;i++) {
         st = ic->streams[i];
         if(st->codec->codec_type == CODEC_TYPE_VIDEO){
@@ -1797,7 +1738,7 @@
         //only for the split stuff
         if (!st->parser) {
             st->parser = av_parser_init(st->codec->codec_id);
-            if(st->need_parsing == 2 && st->parser){
+            if(st->need_parsing == AVSTREAM_PARSE_HEADERS && st->parser){
                 st->parser->flags |= PARSER_FLAG_COMPLETE_FRAMES;
             }
         }
@@ -1807,6 +1748,7 @@
         last_dts[i]= AV_NOPTS_VALUE;
     }
 
+    memset(probe_data, 0, sizeof(probe_data));
     count = 0;
     read_size = 0;
     ppktl = &ic->packet_buffer;
@@ -1817,11 +1759,14 @@
             if (!has_codec_parameters(st->codec))
                 break;
             /* variable fps and no guess at the real fps */
-            if(   st->codec->time_base.den >= 101LL*st->codec->time_base.num
+            if(   (st->codec->time_base.den >= 101LL*st->codec->time_base.num || st->codec->codec_id == CODEC_ID_MPEG2VIDEO)
                && duration_count[i]<20 && st->codec->codec_type == CODEC_TYPE_VIDEO)
                 break;
             if(st->parser && st->parser->parser->split && !st->codec->extradata)
                 break;
+            if (st->codec->codec_type == CODEC_TYPE_AUDIO &&
+                st->codec->codec_id == CODEC_ID_NONE)
+                break;
         }
         if (i == ic->nb_streams) {
             /* NOTE: if the format has no header, then we need to read
@@ -1880,10 +1825,10 @@
         read_size += pkt->size;
 
         st = ic->streams[pkt->stream_index];
-        if(st->codec_info_nb_frames>1) //FIXME move codec_info_nb_frames and codec_info_duration from AVStream into this func
-            st->codec_info_duration += pkt->duration;
+        if(codec_info_nb_frames[st->index]>1)
+            codec_info_duration[st->index] += pkt->duration;
         if (pkt->duration != 0)
-            st->codec_info_nb_frames++;
+            codec_info_nb_frames[st->index]++;
 
         {
             int index= pkt->stream_index;
@@ -1896,7 +1841,7 @@
 //                if(st->codec->codec_type == CODEC_TYPE_VIDEO)
 //                    av_log(NULL, AV_LOG_ERROR, "%f\n", dur);
                 if(duration_count[index] < 2)
-                    memset(duration_error, 0, sizeof(duration_error));
+                    memset(duration_error, 0, MAX_STREAMS * sizeof(*duration_error));
                 for(i=1; i<MAX_STD_TIMEBASES; i++){
                     int framerate= get_std_framerate(i);
                     int ticks= lrintf(dur*framerate/(1001*12));
@@ -1904,12 +1849,16 @@
                     duration_error[index][i] += error*error;
                 }
                 duration_count[index]++;
-
-                if(st->codec_info_nb_frames == 0 && 0)
-                    st->codec_info_duration += duration;
             }
             if(last == AV_NOPTS_VALUE || duration_count[index]<=1)
                 last_dts[pkt->stream_index]= pkt->dts;
+
+            if (st->codec->codec_id == CODEC_ID_NONE) {
+                AVProbeData *pd = &(probe_data[st->index]);
+                pd->buf = av_realloc(pd->buf, pd->buf_size+pkt->size);
+                memcpy(pd->buf+pd->buf_size, pkt->data, pkt->size);
+                pd->buf_size += pkt->size;
+            }
         }
         if(st->parser && st->parser->parser->split && !st->codec->extradata){
             int i= st->parser->parser->split(st->codec, pkt->data, pkt->size);
@@ -1942,7 +1891,7 @@
              (st->codec->codec_id == CODEC_ID_MPEG4 && !st->need_parsing))*/)
             try_decode_frame(st, pkt->data, pkt->size);
 
-        if (av_rescale_q(st->codec_info_duration, st->time_base, AV_TIME_BASE_Q) >= MAX_STREAM_DURATION) {
+        if (st->time_base.den > 0 && av_rescale_q(codec_info_duration[st->index], st->time_base, AV_TIME_BASE_Q) >= ic->max_analyze_duration) {
             break;
         }
         count++;
@@ -1988,10 +1937,29 @@
                     st->r_frame_rate.den = st->time_base.num;
                 }
             }
+        }else if(st->codec->codec_type == CODEC_TYPE_AUDIO) {
+            if (st->codec->codec_id == CODEC_ID_NONE && probe_data[st->index].buf_size > 0) {
+                codec_identified[st->index] = set_codec_from_probe_data(st, &(probe_data[st->index]), 0);
+                if (codec_identified[st->index]) {
+                    st->need_parsing = AVSTREAM_PARSE_FULL;
+                }
+            }
+            if(!st->codec->bits_per_sample)
+                st->codec->bits_per_sample= av_get_bits_per_sample(st->codec->codec_id);
         }
     }
 
-    av_estimate_timings(ic);
+    av_estimate_timings(ic, old_offset);
+
+    for(i=0;i<ic->nb_streams;i++) {
+        st = ic->streams[i];
+        if (codec_identified[st->index]) {
+            av_read_frame_flush(ic);
+            av_seek_frame(ic, st->index, 0.0, 0);
+            url_fseek(&ic->pb, ic->data_offset, SEEK_SET);
+        }
+    }
+
 #if 0
     /* correct DTS for b frame streams with no timestamps */
     for(i=0;i<ic->nb_streams;i++) {
@@ -2016,15 +1984,17 @@
         }
     }
 #endif
+
+    av_free(duration_error);
+    for(i=0;i<MAX_STREAMS;i++){
+        av_freep(&(probe_data[i].buf));
+    }
+
     return ret;
 }
 
 /*******************************************************/
 
-/**
- * start playing a network based stream (e.g. RTSP stream) at the
- * current position
- */
 int av_read_play(AVFormatContext *s)
 {
     if (!s->iformat->read_play)
@@ -2032,11 +2002,6 @@
     return s->iformat->read_play(s);
 }
 
-/**
- * Pause a network based stream (e.g. RTSP stream).
- *
- * Use av_read_play() to resume it.
- */
 int av_read_pause(AVFormatContext *s)
 {
     if (!s->iformat->read_pause)
@@ -2044,11 +2009,6 @@
     return s->iformat->read_pause(s);
 }
 
-/**
- * Close a media file (but not its codecs).
- *
- * @param s media file handle
- */
 void av_close_input_file(AVFormatContext *s)
 {
     int i, must_open_file;
@@ -2083,16 +2043,6 @@
     av_free(s);
 }
 
-/**
- * Add a new stream to a media file.
- *
- * Can only be called in the read_header() function. If the flag
- * AVFMTCTX_NOHEADER is in the format context, then new streams
- * can be added in read_packet too.
- *
- * @param s media file handle
- * @param id file format dependent stream id
- */
 AVStream *av_new_stream(AVFormatContext *s, int id)
 {
     AVStream *st;
@@ -2148,13 +2098,6 @@
     return 0;
 }
 
-/**
- * allocate the stream private data and write the stream header to an
- * output media file
- *
- * @param s media file handle
- * @return 0 if OK. AVERROR_xxx if error.
- */
 int av_write_header(AVFormatContext *s)
 {
     int ret, i;
@@ -2182,6 +2125,17 @@
             }
             break;
         }
+
+        if(s->oformat->codec_tag){
+            if(st->codec->codec_tag){
+                //FIXME
+                //check that tag + id is in the table
+                //if neither is in the table -> ok
+                //if tag is in the table with another id -> FAIL
+                //if id is in the table with another tag -> FAIL unless strict < ?
+            }else
+                st->codec->codec_tag= av_codec_get_tag(s->oformat->codec_tag, st->codec->codec_id);
+        }
     }
 
     if (!s->priv_data && s->oformat->priv_data_size > 0) {
@@ -2301,15 +2255,6 @@
         pkt->dts &= pts_mask;
 }
 
-/**
- * Write a packet to an output media file.
- *
- * The packet shall contain one audio or video frame.
- *
- * @param s media file handle
- * @param pkt the packet, which contains the stream_index, buf/buf_size, dts/pts, ...
- * @return < 0 if error, = 0 if OK, 1 if end of stream wanted.
- */
 int av_write_frame(AVFormatContext *s, AVPacket *pkt)
 {
     int ret;
@@ -2326,20 +2271,6 @@
     return ret;
 }
 
-/**
- * Interleave a packet per DTS in an output media file.
- *
- * Packets with pkt->destruct == av_destruct_packet will be freed inside this function,
- * so they cannot be used after it, note calling av_free_packet() on them is still safe.
- *
- * @param s media file handle
- * @param out the interleaved packet will be output here
- * @param in the input packet
- * @param flush 1 if no further packets are available as input and all
- *              remaining packets should be output
- * @return 1 if a packet was output, 0 if no packet could be output,
- *         < 0 if an error occured
- */
 int av_interleave_packet_per_dts(AVFormatContext *s, AVPacket *out, AVPacket *pkt, int flush){
     AVPacketList *pktl, **next_point, *this_pktl;
     int stream_count=0;
@@ -2409,20 +2340,6 @@
         return av_interleave_packet_per_dts(s, out, in, flush);
 }
 
-/**
- * Writes a packet to an output media file ensuring correct interleaving.
- *
- * The packet must contain one audio or video frame.
- * If the packets are already correctly interleaved the application should
- * call av_write_frame() instead as its slightly faster, its also important
- * to keep in mind that completly non interleaved input will need huge amounts
- * of memory to interleave with this, so its prefereable to interleave at the
- * demuxer level
- *
- * @param s media file handle
- * @param pkt the packet, which contains the stream_index, buf/buf_size, dts/pts, ...
- * @return < 0 if error, = 0 if OK, 1 if end of stream wanted.
- */
 int av_interleaved_write_frame(AVFormatContext *s, AVPacket *pkt){
     AVStream *st= s->streams[ pkt->stream_index];
 
@@ -2456,13 +2373,6 @@
     }
 }
 
-/**
- * @brief Write the stream trailer to an output media file and
- *        free the file private data.
- *
- * @param s media file handle
- * @return 0 if OK. AVERROR_xxx if error.
- */
 int av_write_trailer(AVFormatContext *s)
 {
     int ret, i;
@@ -2574,118 +2484,20 @@
     }
 }
 
-typedef struct {
-    const char *abv;
-    int width, height;
-    int frame_rate, frame_rate_base;
-} AbvEntry;
-
-static AbvEntry frame_abvs[] = {
-    { "ntsc",      720, 480, 30000, 1001 },
-    { "pal",       720, 576,    25,    1 },
-    { "qntsc",     352, 240, 30000, 1001 }, /* VCD compliant ntsc */
-    { "qpal",      352, 288,    25,    1 }, /* VCD compliant pal */
-    { "sntsc",     640, 480, 30000, 1001 }, /* square pixel ntsc */
-    { "spal",      768, 576,    25,    1 }, /* square pixel pal */
-    { "film",      352, 240,    24,    1 },
-    { "ntsc-film", 352, 240, 24000, 1001 },
-    { "sqcif",     128,  96,     0,    0 },
-    { "qcif",      176, 144,     0,    0 },
-    { "cif",       352, 288,     0,    0 },
-    { "4cif",      704, 576,     0,    0 },
-};
-
-/**
- * parses width and height out of string str.
- */
 int parse_image_size(int *width_ptr, int *height_ptr, const char *str)
 {
-    int i;
-    int n = sizeof(frame_abvs) / sizeof(AbvEntry);
-    const char *p;
-    int frame_width = 0, frame_height = 0;
-
-    for(i=0;i<n;i++) {
-        if (!strcmp(frame_abvs[i].abv, str)) {
-            frame_width = frame_abvs[i].width;
-            frame_height = frame_abvs[i].height;
-            break;
-        }
-    }
-    if (i == n) {
-        p = str;
-        frame_width = strtol(p, (char **)&p, 10);
-        if (*p)
-            p++;
-        frame_height = strtol(p, (char **)&p, 10);
-    }
-    if (frame_width <= 0 || frame_height <= 0)
-        return -1;
-    *width_ptr = frame_width;
-    *height_ptr = frame_height;
-    return 0;
+    return av_parse_video_frame_size(width_ptr, height_ptr, str);
 }
 
-/**
- * Converts frame rate from string to a fraction.
- *
- * First we try to get an exact integer or fractional frame rate.
- * If this fails we convert the frame rate to a double and return
- * an approximate fraction using the DEFAULT_FRAME_RATE_BASE.
- */
-int parse_frame_rate(int *frame_rate, int *frame_rate_base, const char *arg)
+int parse_frame_rate(int *frame_rate_num, int *frame_rate_den, const char *arg)
 {
-    int i;
-    char* cp;
-
-    /* First, we check our abbreviation table */
-    for (i = 0; i < sizeof(frame_abvs)/sizeof(*frame_abvs); ++i)
-         if (!strcmp(frame_abvs[i].abv, arg)) {
-             *frame_rate = frame_abvs[i].frame_rate;
-             *frame_rate_base = frame_abvs[i].frame_rate_base;
-             return 0;
-         }
-
-    /* Then, we try to parse it as fraction */
-    cp = strchr(arg, '/');
-    if (!cp)
-        cp = strchr(arg, ':');
-    if (cp) {
-        char* cpp;
-        *frame_rate = strtol(arg, &cpp, 10);
-        if (cpp != arg || cpp == cp)
-            *frame_rate_base = strtol(cp+1, &cpp, 10);
-        else
-           *frame_rate = 0;
-    }
-    else {
-        /* Finally we give up and parse it as double */
-        AVRational time_base = av_d2q(strtod(arg, 0), DEFAULT_FRAME_RATE_BASE);
-        *frame_rate_base = time_base.den;
-        *frame_rate = time_base.num;
-    }
-    if (!*frame_rate || !*frame_rate_base)
-        return -1;
-    else
-        return 0;
+    AVRational frame_rate;
+    int ret = av_parse_video_frame_rate(&frame_rate, arg);
+    *frame_rate_num= frame_rate.num;
+    *frame_rate_den= frame_rate.den;
+    return ret;
 }
 
-/**
- * Converts date string to number of seconds since Jan 1st, 1970.
- *
- * @code
- * Syntax:
- * - If not a duration:
- *  [{YYYY-MM-DD|YYYYMMDD}]{T| }{HH[:MM[:SS[.m...]]][Z]|HH[MM[SS[.m...]]][Z]}
- * Time is localtime unless Z is suffixed to the end. In this case GMT
- * Return the date in micro seconds since 1970
- *
- * - If a duration:
- *  HH[:MM[:SS[.m...]]]
- *  S+[.m...]
- * @endcode
- */
-#ifndef CONFIG_WINCE
 int64_t parse_date(const char *datestr, int duration)
 {
     const char *p;
@@ -2793,14 +2605,7 @@
     }
     return negative ? -t : t;
 }
-#endif /* CONFIG_WINCE */
 
-/**
- * Attempts to find a specific tag in a URL.
- *
- * syntax: '?tag1=val1&tag2=val2...'. Little URL decoding is done.
- * Return 1 if found.
- */
 int find_info_tag(char *arg, int arg_size, const char *tag1, const char *info)
 {
     const char *p;
@@ -2840,18 +2645,6 @@
     return 0;
 }
 
-/**
- * Returns in 'buf' the path with '%d' replaced by number.
-
- * Also handles the '%0nd' format where 'n' is the total number
- * of digits and '%%'.
- *
- * @param buf destination buffer
- * @param buf_size destination buffer size
- * @param path numbered sequence string
- * @number frame number
- * @return 0 if OK, -1 if format error.
- */
 int av_get_frame_filename(char *buf, int buf_size,
                           const char *path, int number)
 {
@@ -2907,68 +2700,80 @@
     return -1;
 }
 
-/**
- * Print  nice hexa dump of a buffer
- * @param f stream for output
- * @param buf buffer
- * @param size buffer size
- */
-void av_hex_dump(FILE *f, uint8_t *buf, int size)
+static void hex_dump_internal(void *avcl, FILE *f, int level, uint8_t *buf, int size)
 {
     int len, i, j, c;
+#define PRINT(...) do { if (!f) av_log(avcl, level, __VA_ARGS__); else fprintf(f, __VA_ARGS__); } while(0)
 
     for(i=0;i<size;i+=16) {
         len = size - i;
         if (len > 16)
             len = 16;
-        fprintf(f, "%08x ", i);
+        PRINT("%08x ", i);
         for(j=0;j<16;j++) {
             if (j < len)
-                fprintf(f, " %02x", buf[i+j]);
+                PRINT(" %02x", buf[i+j]);
             else
-                fprintf(f, "   ");
+                PRINT("   ");
         }
-        fprintf(f, " ");
+        PRINT(" ");
         for(j=0;j<len;j++) {
             c = buf[i+j];
             if (c < ' ' || c > '~')
                 c = '.';
-            fprintf(f, "%c", c);
+            PRINT("%c", c);
         }
-        fprintf(f, "\n");
+        PRINT("\n");
     }
+#undef PRINT
 }
 
-/**
- * Print on 'f' a nice dump of a packet
- * @param f stream for output
- * @param pkt packet to dump
- * @param dump_payload true if the payload must be displayed too
- */
+void av_hex_dump(FILE *f, uint8_t *buf, int size)
+{
+    hex_dump_internal(NULL, f, 0, buf, size);
+}
+
+void av_hex_dump_log(void *avcl, int level, uint8_t *buf, int size)
+{
+    hex_dump_internal(avcl, NULL, level, buf, size);
+}
+
  //FIXME needs to know the time_base
-void av_pkt_dump(FILE *f, AVPacket *pkt, int dump_payload)
+static void pkt_dump_internal(void *avcl, FILE *f, int level, AVPacket *pkt, int dump_payload)
 {
-    fprintf(f, "stream #%d:\n", pkt->stream_index);
-    fprintf(f, "  keyframe=%d\n", ((pkt->flags & PKT_FLAG_KEY) != 0));
-    fprintf(f, "  duration=%0.3f\n", (double)pkt->duration / AV_TIME_BASE);
+#define PRINT(...) do { if (!f) av_log(avcl, level, __VA_ARGS__); else fprintf(f, __VA_ARGS__); } while(0)
+    PRINT("stream #%d:\n", pkt->stream_index);
+    PRINT("  keyframe=%d\n", ((pkt->flags & PKT_FLAG_KEY) != 0));
+    PRINT("  duration=%0.3f\n", (double)pkt->duration / AV_TIME_BASE);
     /* DTS is _always_ valid after av_read_frame() */
-    fprintf(f, "  dts=");
+    PRINT("  dts=");
     if (pkt->dts == AV_NOPTS_VALUE)
-        fprintf(f, "N/A");
+        PRINT("N/A");
     else
-        fprintf(f, "%0.3f", (double)pkt->dts / AV_TIME_BASE);
+        PRINT("%0.3f", (double)pkt->dts / AV_TIME_BASE);
     /* PTS may be not known if B frames are present */
-    fprintf(f, "  pts=");
+    PRINT("  pts=");
     if (pkt->pts == AV_NOPTS_VALUE)
-        fprintf(f, "N/A");
+        PRINT("N/A");
     else
-        fprintf(f, "%0.3f", (double)pkt->pts / AV_TIME_BASE);
-    fprintf(f, "\n");
-    fprintf(f, "  size=%d\n", pkt->size);
+        PRINT("%0.3f", (double)pkt->pts / AV_TIME_BASE);
+    PRINT("\n");
+    PRINT("  size=%d\n", pkt->size);
+#undef PRINT
     if (dump_payload)
         av_hex_dump(f, pkt->data, pkt->size);
 }
 
+void av_pkt_dump(FILE *f, AVPacket *pkt, int dump_payload)
+{
+    pkt_dump_internal(NULL, f, 0, pkt, dump_payload);
+}
+
+void av_pkt_dump_log(void *avcl, int level, AVPacket *pkt, int dump_payload)
+{
+    pkt_dump_internal(avcl, NULL, level, pkt, dump_payload);
+}
+
 void url_split(char *proto, int proto_size,
                char *authorization, int authorization_size,
                char *hostname, int hostname_size,
@@ -3037,18 +2842,9 @@
     }
     if (port_ptr)
         *port_ptr = port;
-    pstrcpy(path, path_size, p);
+    av_strlcpy(path, p, path_size);
 }
 
-/**
- * Set the pts for a given stream.
- *
- * @param s stream
- * @param pts_wrap_bits number of bits effectively used by the pts
- *        (used for wrap control, 33 is the value for MPEG)
- * @param pts_num numerator to convert to seconds (MPEG: 1)
- * @param pts_den denominator to convert to seconds (MPEG: 90000)
- */
 void av_set_pts_info(AVStream *s, int pts_wrap_bits,
                      int pts_num, int pts_den)
 {

Modified: branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavformat/wav.c
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavformat/wav.c	2007-07-16 16:39:52 UTC (rev 3382)
+++ branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavformat/wav.c	2007-07-16 17:44:22 UTC (rev 3383)
@@ -25,6 +25,9 @@
 typedef struct {
     offset_t data;
     offset_t data_end;
+    int64_t minpts;
+    int64_t maxpts;
+    int last_duration;
 } WAVContext;
 
 #ifdef CONFIG_MUXERS
@@ -32,7 +35,7 @@
 {
     WAVContext *wav = s->priv_data;
     ByteIOContext *pb = &s->pb;
-    offset_t fmt;
+    offset_t fmt, fact;
 
     put_tag(pb, "RIFF");
     put_le32(pb, 0); /* file length */
@@ -46,7 +49,16 @@
     }
     end_tag(pb, fmt);
 
+    if(s->streams[0]->codec->codec_tag != 0x01 /* hence for all other than PCM */
+       && !url_is_streamed(&s->pb)) {
+        fact = start_tag(pb, "fact");
+        put_le32(pb, 0);
+        end_tag(pb, fact);
+    }
+
     av_set_pts_info(s->streams[0], 64, 1, s->streams[0]->codec->sample_rate);
+    wav->maxpts = wav->last_duration = 0;
+    wav->minpts = INT64_MAX;
 
     /* data header */
     wav->data = start_tag(pb, "data");
@@ -59,7 +71,14 @@
 static int wav_write_packet(AVFormatContext *s, AVPacket *pkt)
 {
     ByteIOContext *pb = &s->pb;
+    WAVContext *wav = s->priv_data;
     put_buffer(pb, pkt->data, pkt->size);
+    if(pkt->pts != AV_NOPTS_VALUE) {
+        wav->minpts = FFMIN(wav->minpts, pkt->pts);
+        wav->maxpts = FFMAX(wav->maxpts, pkt->pts);
+        wav->last_duration = pkt->duration;
+    } else
+        av_log(s, AV_LOG_ERROR, "wav_write_packet: NOPTS\n");
     return 0;
 }
 
@@ -79,6 +98,18 @@
         url_fseek(pb, file_size, SEEK_SET);
 
         put_flush_packet(pb);
+
+        if(s->streams[0]->codec->codec_tag != 0x01) {
+            /* Update num_samps in fact chunk */
+            int number_of_samples;
+            number_of_samples = av_rescale(wav->maxpts - wav->minpts + wav->last_duration,
+                                           s->streams[0]->codec->sample_rate * (int64_t)s->streams[0]->time_base.num,
+                                           s->streams[0]->time_base.den);
+            url_fseek(pb, wav->data-12, SEEK_SET);
+            put_le32(pb, number_of_samples);
+            url_fseek(pb, file_size, SEEK_SET);
+            put_flush_packet(pb);
+        }
     }
     return 0;
 }
@@ -148,7 +179,7 @@
         return AVERROR_NOMEM;
 
     get_wav_header(pb, st->codec, size);
-    st->need_parsing = 1;
+    st->need_parsing = AVSTREAM_PARSE_FULL;
 
     av_set_pts_info(st, 64, 1, st->codec->sample_rate);
 
@@ -188,13 +219,11 @@
         size = (size / st->codec->block_align) * st->codec->block_align;
     }
     size= FFMIN(size, left);
-    if (av_new_packet(pkt, size))
+    ret= av_get_packet(&s->pb, pkt, size);
+    if (ret <= 0)
         return AVERROR_IO;
     pkt->stream_index = 0;
 
-    ret = get_buffer(&s->pb, pkt->data, pkt->size);
-    if (ret < 0)
-        av_free_packet(pkt);
     /* note: we need to modify the packet size here to handle the last
        packet */
     pkt->size = ret;
@@ -235,7 +264,8 @@
     wav_read_packet,
     wav_read_close,
     wav_read_seek,
-    .codec_tag= {codec_wav_tags},
+    .flags= AVFMT_GENERIC_INDEX,
+    .codec_tag= (const AVCodecTag*[]){codec_wav_tags, 0},
 };
 #endif
 #ifdef CONFIG_WAV_MUXER
@@ -250,6 +280,6 @@
     wav_write_header,
     wav_write_packet,
     wav_write_trailer,
-    .codec_tag= {codec_wav_tags},
+    .codec_tag= (const AVCodecTag*[]){codec_wav_tags, 0},
 };
 #endif



From mean at mail.berlios.de  Mon Jul 16 19:45:08 2007
From: mean at mail.berlios.de (mean at BerliOS)
Date: Mon, 16 Jul 2007 19:45:08 +0200
Subject: [Avidemux-svn-commit] r3384 -
	branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavutil
Message-ID: <200707161745.l6GHj86M008187@sheep.berlios.de>

Author: mean
Date: 2007-07-16 19:45:07 +0200 (Mon, 16 Jul 2007)
New Revision: 3384

Modified:
   branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavutil/CMakeLists.txt
   branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavutil/adler32.c
   branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavutil/adler32.h
   branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavutil/avutil.h
   branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavutil/bswap.h
   branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavutil/common.h
   branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavutil/crc.c
   branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavutil/crc.h
   branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavutil/fifo.h
   branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavutil/integer.c
   branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavutil/integer.h
   branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavutil/internal.h
   branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavutil/intreadwrite.h
   branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavutil/lls.c
   branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavutil/lls.h
   branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavutil/log.h
   branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavutil/md5.c
   branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavutil/md5.h
   branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavutil/mem.c
   branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavutil/rational.c
   branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavutil/rational.h
   branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavutil/x86_cpu.h
Log:
[LAV] update to RR9685 

Modified: branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavutil/CMakeLists.txt
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavutil/CMakeLists.txt	2007-07-16 17:44:22 UTC (rev 3383)
+++ branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavutil/CMakeLists.txt	2007-07-16 17:45:07 UTC (rev 3384)
@@ -6,6 +6,7 @@
 #
 SET(${ADM_LIB}_SRCS 
 integer.c  intfloat_readwrite.c  mathematics.c  rational.c md5.c crc.c log.c  adler32.c lls.c
+string.c
 
 )
 ADD_LIBRARY(${ADM_LIB} STATIC ${${ADM_LIB}_SRCS})

Modified: branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavutil/adler32.c
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavutil/adler32.c	2007-07-16 17:44:22 UTC (rev 3383)
+++ branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavutil/adler32.c	2007-07-16 17:45:07 UTC (rev 3384)
@@ -18,7 +18,6 @@
  * 2. Altered source versions must be plainly marked as such, and must not be
  *    misrepresented as being the original software.
  * 3. This notice may not be removed or altered from any source distribution.
- *
  */
 
 #include "common.h"

Modified: branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavutil/adler32.h
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavutil/adler32.h	2007-07-16 17:44:22 UTC (rev 3383)
+++ branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavutil/adler32.h	2007-07-16 17:45:07 UTC (rev 3384)
@@ -21,6 +21,8 @@
 #ifndef ADLER32_H
 #define ADLER32_H
 
+#include <stdint.h>
+
 unsigned long av_adler32_update(unsigned long adler, const uint8_t *buf,
                                 unsigned int len);
 

Modified: branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavutil/avutil.h
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavutil/avutil.h	2007-07-16 17:44:22 UTC (rev 3383)
+++ branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavutil/avutil.h	2007-07-16 17:45:07 UTC (rev 3384)
@@ -27,23 +27,19 @@
  */
 
 
-#ifdef __cplusplus
-extern "C" {
-#endif
-/* MEANX
- */
-	#define ASMALIGN(ZEROBITS) ".p2align " #ZEROBITS "\n\t" 
-/* /MEANX
- */
-
 #define AV_STRINGIFY(s)         AV_TOSTRING(s)
 #define AV_TOSTRING(s) #s
 
-#define LIBAVUTIL_VERSION_INT   ((49<<16)+(2<<8)+0)
-#define LIBAVUTIL_VERSION       49.2.0
+#define LIBAVUTIL_VERSION_INT   ((49<<16)+(4<<8)+1)
+#define LIBAVUTIL_VERSION       49.4.1
 #define LIBAVUTIL_BUILD         LIBAVUTIL_VERSION_INT
 
 #define LIBAVUTIL_IDENT         "Lavu" AV_STRINGIFY(LIBAVUTIL_VERSION)
+/* MEANX
+ */
+	#define ASMALIGN(ZEROBITS) ".p2align " #ZEROBITS "\n\t" 
+/* /MEANX
+ */
 
 
 #include "common.h"
@@ -85,8 +81,8 @@
     PIX_FMT_RGB565,    ///< Packed RGB 5:6:5, 16bpp, (msb)   5R 6G 5B(lsb), in cpu endianness
     PIX_FMT_RGB555,    ///< Packed RGB 5:5:5, 16bpp, (msb)1A 5R 5G 5B(lsb), in cpu endianness most significant bit to 0
     PIX_FMT_GRAY8,     ///<        Y        ,  8bpp
-    PIX_FMT_MONOWHITE, ///<        Y        ,  1bpp, 1 is white
-    PIX_FMT_MONOBLACK, ///<        Y        ,  1bpp, 0 is black
+    PIX_FMT_MONOWHITE, ///<        Y        ,  1bpp, 0 is white, 1 is black
+    PIX_FMT_MONOBLACK, ///<        Y        ,  1bpp, 0 is black, 1 is white
     PIX_FMT_PAL8,      ///< 8 bit with PIX_FMT_RGB32 palette
     PIX_FMT_YUVJ420P,  ///< Planar YUV 4:2:0, 12bpp, full scale (jpeg)
     PIX_FMT_YUVJ422P,  ///< Planar YUV 4:2:2, 16bpp, full scale (jpeg)
@@ -135,8 +131,4 @@
 #define PIX_FMT_YUV422  PIX_FMT_YUYV422
 #endif
 
-#ifdef __cplusplus
-}
-#endif
-
 #endif /* AVUTIL_H */

Modified: branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavutil/bswap.h
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavutil/bswap.h	2007-07-16 17:44:22 UTC (rev 3383)
+++ branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavutil/bswap.h	2007-07-16 17:45:07 UTC (rev 3384)
@@ -23,9 +23,12 @@
  * byte swap.
  */
 
-#ifndef __BSWAP_H__
-#define __BSWAP_H__
+#ifndef BSWAP_H
+#define BSWAP_H
 
+#include <stdint.h>
+#include "common.h"
+
 #ifdef HAVE_BYTESWAP_H
 #include <byteswap.h>
 #else
@@ -36,17 +39,23 @@
 #  define LEGACY_REGS "=q"
 #endif
 
-#if defined(ARCH_X86)
 static av_always_inline uint16_t bswap_16(uint16_t x)
 {
+#if defined(ARCH_X86)
   __asm("rorw $8, %0"   :
         LEGACY_REGS (x) :
         "0" (x));
+#elif defined(ARCH_SH4)
+        __asm__("swap.b %0,%0":"=r"(x):"0"(x));
+#else
+    x= (x>>8) | (x<<8);
+#endif
     return x;
 }
 
 static av_always_inline uint32_t bswap_32(uint32_t x)
 {
+#if defined(ARCH_X86)
 #if __CPU__ != 386
  __asm("bswap   %0":
       "=r" (x)     :
@@ -57,65 +66,13 @@
       LEGACY_REGS (x)                :
 #endif
       "0" (x));
-  return x;
-}
-
-static inline uint64_t bswap_64(uint64_t x)
-{
-#ifdef ARCH_X86_64
-  __asm("bswap  %0":
-        "=r" (x)   :
-        "0" (x));
-  return x;
-#else
-    union {
-        uint64_t ll;
-        struct {
-           uint32_t l,h;
-        } l;
-    } r;
-    r.l.l = bswap_32 (x);
-    r.l.h = bswap_32 (x>>32);
-    return r.ll;
-#endif
-}
-
 #elif defined(ARCH_SH4)
-
-static av_always_inline uint16_t bswap_16(uint16_t x) {
-        __asm__("swap.b %0,%0":"=r"(x):"0"(x));
-        return x;
-}
-
-static av_always_inline uint32_t bswap_32(uint32_t x) {
         __asm__(
         "swap.b %0,%0\n"
         "swap.w %0,%0\n"
         "swap.b %0,%0\n"
         :"=r"(x):"0"(x));
-        return x;
-}
-
-static inline uint64_t bswap_64(uint64_t x)
-{
-    union {
-        uint64_t ll;
-        struct {
-           uint32_t l,h;
-        } l;
-    } r;
-    r.l.l = bswap_32 (x);
-    r.l.h = bswap_32 (x>>32);
-    return r.ll;
-}
-#else
-
-static av_always_inline uint16_t bswap_16(uint16_t x){
-    return (x>>8) | (x<<8);
-}
-
-#ifdef ARCH_ARM
-static av_always_inline uint32_t bswap_32(uint32_t x){
+#elif defined(ARCH_ARM)
     uint32_t t;
     __asm__ (
       "eor %1, %0, %0, ror #16 \n\t"
@@ -123,14 +80,19 @@
       "mov %0, %0, ror #8      \n\t"
       "eor %0, %0, %1, lsr #8  \n\t"
       : "+r"(x), "+r"(t));
-    return x;
-}
+#elif defined(ARCH_BFIN)
+    unsigned tmp;
+    asm("%1 = %0 >> 8 (V);\n\t"
+        "%0 = %0 << 8 (V);\n\t"
+        "%0 = %0 | %1;\n\t"
+        "%0 = PACK(%0.L, %0.H);\n\t"
+        : "+d"(x), "=&d"(tmp));
 #else
-static av_always_inline uint32_t bswap_32(uint32_t x){
     x= ((x<<8)&0xFF00FF00) | ((x>>8)&0x00FF00FF);
-    return (x>>16) | (x<<16);
-}
+    x= (x>>16) | (x<<16);
 #endif
+    return x;
+}
 
 static inline uint64_t bswap_64(uint64_t x)
 {
@@ -138,6 +100,11 @@
     x= ((x<< 8)&0xFF00FF00FF00FF00ULL) | ((x>> 8)&0x00FF00FF00FF00FFULL);
     x= ((x<<16)&0xFFFF0000FFFF0000ULL) | ((x>>16)&0x0000FFFF0000FFFFULL);
     return (x>>32) | (x<<32);
+#elif defined(ARCH_X86_64)
+  __asm("bswap  %0":
+        "=r" (x)   :
+        "0" (x));
+  return x;
 #else
     union {
         uint64_t ll;
@@ -149,7 +116,6 @@
     return r.ll;
 #endif
 }
-#endif  /* defined(ARCH_X86) */
 
 #endif  /* !HAVE_BYTESWAP_H */
 
@@ -172,4 +138,4 @@
 #define le2me_64(x) (x)
 #endif
 
-#endif /* __BSWAP_H__ */
+#endif /* BSWAP_H */

Modified: branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavutil/common.h
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavutil/common.h	2007-07-16 17:44:22 UTC (rev 3383)
+++ branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavutil/common.h	2007-07-16 17:45:07 UTC (rev 3384)
@@ -37,19 +37,17 @@
 #    include <string.h>
 #    include <ctype.h>
 #    include <limits.h>
-#    ifndef __BEOS__
-#        include <errno.h>
-#    else
-#        include "berrno.h"
-#    endif
+#    include <errno.h>
 #    include <math.h>
 #endif /* HAVE_AV_CONFIG_H */
 
 #ifndef av_always_inline
 #if defined(__GNUC__) && (__GNUC__ > 3 || __GNUC__ == 3 && __GNUC_MINOR__ > 0)
 #    define av_always_inline __attribute__((always_inline)) inline
+#    define av_noinline __attribute__((noinline))
 #else
 #    define av_always_inline inline
+#    define av_noinline
 #endif
 #endif
 
@@ -65,11 +63,16 @@
 #endif
 #endif
 
-#ifndef INT64_C
-#define INT64_C(c)     (c ## LL)
-#define UINT64_C(c)    (c ## ULL)
+#ifndef av_unused
+#if defined(__GNUC__)
+#    define av_unused __attribute__((unused))
+#else
+#    define av_unused
 #endif
+#endif
 
+#include "mem.h"
+
 //rounded divison & shift
 #define RSHIFT(a,b) ((a) > 0 ? ((a) + ((1<<(b))>>1))>>(b) : ((a) + ((1<<(b))>>1)-1)>>(b))
 /* assume b>0 */
@@ -165,7 +168,7 @@
  * @param amax maximum value of the clip range
  * @return clipped value
  */
-static inline int clip(int a, int amin, int amax)
+static inline int av_clip(int a, int amin, int amax)
 {
     if (a < amin)      return amin;
     else if (a > amax) return amax;
@@ -177,7 +180,7 @@
  * @param a value to clip
  * @return clipped value
  */
-static inline uint8_t clip_uint8(int a)
+static inline uint8_t av_clip_uint8(int a)
 {
     if (a&(~255)) return (-a)>>31;
     else          return a;
@@ -202,14 +205,14 @@
 
 /*!
  * \def GET_UTF8(val, GET_BYTE, ERROR)
- * converts a utf-8 character (up to 4 bytes long) to its 32-bit ucs-4 encoded form
+ * converts a UTF-8 character (up to 4 bytes long) to its 32-bit UCS-4 encoded form
  * \param val is the output and should be of type uint32_t. It holds the converted
- * ucs-4 character and should be a left value.
- * \param GET_BYTE gets utf-8 encoded bytes from any proper source. It can be
+ * UCS-4 character and should be a left value.
+ * \param GET_BYTE gets UTF-8 encoded bytes from any proper source. It can be
  * a function or a statement whose return value or evaluated value is of type
- * uint8_t. It will be executed up to 4 times for values in the valid utf-8 range,
+ * uint8_t. It will be executed up to 4 times for values in the valid UTF-8 range,
  * and up to 7 times in the general case.
- * \param ERROR action that should be taken when an invalid utf-8 byte is returned
+ * \param ERROR action that should be taken when an invalid UTF-8 byte is returned
  * from GET_BYTE. It should be a statement that jumps out of the macro,
  * like exit(), goto, return, break, or continue.
  */
@@ -230,17 +233,17 @@
 
 /*!
  * \def PUT_UTF8(val, tmp, PUT_BYTE)
- * converts a 32-bit unicode character to its utf-8 encoded form (up to 4 bytes long).
+ * converts a 32-bit unicode character to its UTF-8 encoded form (up to 4 bytes long).
  * \param val is an input only argument and should be of type uint32_t. It holds
- * a ucs4 encoded unicode character that is to be converted to utf-8. If
+ * a ucs4 encoded unicode character that is to be converted to UTF-8. If
  * val is given as a function it's executed only once.
  * \param tmp is a temporary variable and should be of type uint8_t. It
  * represents an intermediate value during conversion that is to be
  * outputted by PUT_BYTE.
- * \param PUT_BYTE writes the converted utf-8 bytes to any proper destination.
+ * \param PUT_BYTE writes the converted UTF-8 bytes to any proper destination.
  * It could be a function or a statement, and uses tmp as the input byte.
  * For example, PUT_BYTE could be "*output++ = tmp;" PUT_BYTE will be
- * executed up to 4 times for values in the valid utf-8 range and up to
+ * executed up to 4 times for values in the valid UTF-8 range and up to
  * 7 times in the general case, depending on the length of the converted
  * unicode character.
  */
@@ -264,7 +267,7 @@
         }\
     }
 
-#if defined(ARCH_X86) || defined(ARCH_POWERPC)
+#if defined(ARCH_X86) || defined(ARCH_POWERPC) || defined(ARCH_BFIN)
 #if defined(ARCH_X86_64)
 static inline uint64_t read_time(void)
 {
@@ -283,6 +286,19 @@
         );
         return l;
 }
+#elif ARCH_BFIN
+static inline uint64_t read_time(void)
+{
+    union {
+        struct {
+            unsigned lo;
+            unsigned hi;
+        } p;
+        unsigned long long c;
+    } t;
+    asm volatile ("%0=cycles; %1=cycles2;" : "=d" (t.p.lo), "=d" (t.p.hi));
+    return t.c;
+}
 #else //FIXME check ppc64
 static inline uint64_t read_time(void)
 {
@@ -314,7 +330,7 @@
   static uint64_t tsum=0;\
   static int tcount=0;\
   static int tskip_count=0;\
-  if(tcount<2 || tend - tstart < 8*tsum/tcount){\
+  if(tcount<2 || tend - tstart < FFMAX(8*tsum/tcount, 2000)){\
       tsum+= tend - tstart;\
       tcount++;\
   }else\
@@ -328,21 +344,4 @@
 #define STOP_TIMER(id) {}
 #endif
 
-/* memory */
-
-#ifdef __GNUC__
-  #define DECLARE_ALIGNED(n,t,v)       t v __attribute__ ((aligned (n)))
-#else
-  #define DECLARE_ALIGNED(n,t,v)      __declspec(align(n)) t v
-#endif
-
-/* memory */
-void *av_malloc(unsigned int size);
-void *av_realloc(void *ptr, unsigned int size);
-void av_free(void *ptr);
-
-void *av_mallocz(unsigned int size);
-char *av_strdup(const char *s);
-void av_freep(void *ptr);
-
 #endif /* COMMON_H */

Modified: branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavutil/crc.c
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavutil/crc.c	2007-07-16 17:44:22 UTC (rev 3383)
+++ branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavutil/crc.c	2007-07-16 17:45:07 UTC (rev 3384)
@@ -21,10 +21,17 @@
 #include "common.h"
 #include "crc.h"
 
+#if LIBAVUTIL_VERSION_INT  < (50<<16)
 AVCRC *av_crcEDB88320;
 AVCRC *av_crc04C11DB7;
 AVCRC *av_crc8005    ;
 AVCRC *av_crc07      ;
+#else
+AVCRC av_crcEDB88320[257];
+AVCRC av_crc04C11DB7[257];
+AVCRC av_crc8005    [257];
+AVCRC av_crc07      [257];
+#endif
 
 /**
  * Inits a crc table.

Modified: branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavutil/crc.h
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavutil/crc.h	2007-07-16 17:44:22 UTC (rev 3383)
+++ branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavutil/crc.h	2007-07-16 17:45:07 UTC (rev 3384)
@@ -21,12 +21,22 @@
 #ifndef CRC_H
 #define CRC_H
 
+#include <stdint.h>
+#include <sys/types.h>
+
 typedef uint32_t AVCRC;
 
+#if LIBAVUTIL_VERSION_INT  < (50<<16)
 extern AVCRC *av_crcEDB88320;
 extern AVCRC *av_crc04C11DB7;
 extern AVCRC *av_crc8005    ;
 extern AVCRC *av_crc07      ;
+#else
+extern AVCRC av_crcEDB88320[];
+extern AVCRC av_crc04C11DB7[];
+extern AVCRC av_crc8005    [];
+extern AVCRC av_crc07      [];
+#endif
 
 int av_crc_init(AVCRC *ctx, int le, int bits, uint32_t poly, int ctx_size);
 uint32_t av_crc(const AVCRC *ctx, uint32_t start_crc, const uint8_t *buffer, size_t length);

Modified: branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavutil/fifo.h
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavutil/fifo.h	2007-07-16 17:44:22 UTC (rev 3383)
+++ branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavutil/fifo.h	2007-07-16 17:45:07 UTC (rev 3384)
@@ -1,18 +1,95 @@
+/*
+ * This file is part of FFmpeg.
+ *
+ * FFmpeg is free software; you can redistribute it and/or
+ * modify it under the terms of the GNU Lesser General Public
+ * License as published by the Free Software Foundation; either
+ * version 2.1 of the License, or (at your option) any later version.
+ *
+ * FFmpeg is distributed in the hope that it will be useful,
+ * but WITHOUT ANY WARRANTY; without even the implied warranty of
+ * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ * Lesser General Public License for more details.
+ *
+ * You should have received a copy of the GNU Lesser General Public
+ * License along with FFmpeg; if not, write to the Free Software
+ * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA
+ */
+
+/**
+ * @file fifo.h
+ * A very simple circular buffer FIFO implementation.
+ */
+
 #ifndef FIFO_H
 #define FIFO_H
 
+#include <stdint.h>
+
 typedef struct AVFifoBuffer {
     uint8_t *buffer;
     uint8_t *rptr, *wptr, *end;
 } AVFifoBuffer;
 
+/**
+ * Initializes an AVFifoBuffer.
+ * @param *f AVFifoBuffer to initialize
+ * @param size of FIFO
+ * @return <0 for failure >=0 otherwise
+ */
 int av_fifo_init(AVFifoBuffer *f, int size);
+
+/**
+ * Frees an AVFifoBuffer.
+ * @param *f AVFifoBuffer to free
+ */
 void av_fifo_free(AVFifoBuffer *f);
+
+/**
+ * Returns the amount of data in bytes in the AVFifoBuffer, that is the
+ * amount of data you can read from it.
+ * @param *f AVFifoBuffer to read from
+ * @return size
+ */
 int av_fifo_size(AVFifoBuffer *f);
+
+/**
+ * Reads data from an AVFifoBuffer.
+ * @param *f AVFifoBuffer to read from
+ * @param *buf data destination
+ * @param buf_size number of bytes to read
+ */
 int av_fifo_read(AVFifoBuffer *f, uint8_t *buf, int buf_size);
+
+/**
+ * Feeds data from an AVFifoBuffer to a user supplied callback.
+ * @param *f AVFifoBuffer to read from
+ * @param buf_size number of bytes to read
+ * @param *func generic read function
+ * @param *dest data destination
+ */
 int av_fifo_generic_read(AVFifoBuffer *f, int buf_size, void (*func)(void*, void*, int), void* dest);
+
+/**
+ * Writes data into an AVFifoBuffer.
+ * @param *f AVFifoBuffer to write to
+ * @param *buf data source
+ * @param size data size
+ */
 void av_fifo_write(AVFifoBuffer *f, const uint8_t *buf, int size);
+
+/**
+ * Resizes an AVFifoBuffer.
+ * @param *f AVFifoBuffer to resize
+ * @param size new AVFifoBuffer size in bytes
+ */
 void av_fifo_realloc(AVFifoBuffer *f, unsigned int size);
+
+/**
+ * Reads and discards the specified amount of data from an AVFifoBuffer.
+ * @param *f AVFifoBuffer to read from
+ * @param size amount of data to read in bytes
+ */
 void av_fifo_drain(AVFifoBuffer *f, int size);
 
 static inline uint8_t av_fifo_peek(AVFifoBuffer *f, int offs)

Modified: branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavutil/integer.c
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavutil/integer.c	2007-07-16 17:44:22 UTC (rev 3383)
+++ branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavutil/integer.c	2007-07-16 17:45:07 UTC (rev 3384)
@@ -17,7 +17,6 @@
  * You should have received a copy of the GNU Lesser General Public
  * License along with FFmpeg; if not, write to the Free Software
  * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA
- *
  */
 
 /**
@@ -49,10 +48,6 @@
     return a;
 }
 
-/**
- * returns the rounded down value of the logarithm of base 2 of the given AVInteger.
- * this is simply the index of the most significant bit which is 1. Or 0 of all bits are 0
- */
 int av_log2_i(AVInteger a){
     int i;
 
@@ -84,9 +79,6 @@
     return out;
 }
 
-/**
- * returns 0 if a==b, 1 if a>b and -1 if a<b.
- */
 int av_cmp_i(AVInteger a, AVInteger b){
     int i;
     int v= (int16_t)a.v[AV_INTEGER_SIZE-1] - (int16_t)b.v[AV_INTEGER_SIZE-1];
@@ -99,10 +91,6 @@
     return 0;
 }
 
-/**
- * bitwise shift.
- * @param s the number of bits by which the value should be shifted right, may be negative for shifting left
- */
 AVInteger av_shr_i(AVInteger a, int s){
     AVInteger out;
     int i;
@@ -117,10 +105,6 @@
     return out;
 }
 
-/**
- * returns a % b.
- * @param quot a/b will be stored here
- */
 AVInteger av_mod_i(AVInteger *quot, AVInteger a, AVInteger b){
     int i= av_log2_i(a) - av_log2_i(b);
     AVInteger quot_temp;
@@ -145,18 +129,12 @@
     return a;
 }
 
-/**
- * returns a/b.
- */
 AVInteger av_div_i(AVInteger a, AVInteger b){
     AVInteger quot;
     av_mod_i(&quot, a, b);
     return quot;
 }
 
-/**
- * converts the given int64_t to an AVInteger.
- */
 AVInteger av_int2i(int64_t a){
     AVInteger out;
     int i;
@@ -168,11 +146,6 @@
     return out;
 }
 
-/**
- * converts the given AVInteger to an int64_t.
- * if the AVInteger is too large to fit into an int64_t,
- * then only the least significant 64bit will be used
- */
 int64_t av_i2int(AVInteger a){
     int i;
     int64_t out=(int8_t)a.v[AV_INTEGER_SIZE-1];

Modified: branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavutil/integer.h
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavutil/integer.h	2007-07-16 17:44:22 UTC (rev 3383)
+++ branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavutil/integer.h	2007-07-16 17:45:07 UTC (rev 3384)
@@ -17,7 +17,6 @@
  * You should have received a copy of the GNU Lesser General Public
  * License along with FFmpeg; if not, write to the Free Software
  * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA
- *
  */
 
 /**
@@ -29,6 +28,8 @@
 #ifndef INTEGER_H
 #define INTEGER_H
 
+#include <stdint.h>
+
 #define AV_INTEGER_SIZE 8
 
 typedef struct AVInteger{
@@ -37,13 +38,46 @@
 
 AVInteger av_add_i(AVInteger a, AVInteger b);
 AVInteger av_sub_i(AVInteger a, AVInteger b);
+
+/**
+ * returns the rounded down value of the logarithm of base 2 of the given AVInteger.
+ * this is simply the index of the most significant bit which is 1. Or 0 of all bits are 0
+ */
 int av_log2_i(AVInteger a);
 AVInteger av_mul_i(AVInteger a, AVInteger b);
+
+/**
+ * returns 0 if a==b, 1 if a>b and -1 if a<b.
+ */
 int av_cmp_i(AVInteger a, AVInteger b);
+
+/**
+ * bitwise shift.
+ * @param s the number of bits by which the value should be shifted right, may be negative for shifting left
+ */
 AVInteger av_shr_i(AVInteger a, int s);
+
+/**
+ * returns a % b.
+ * @param quot a/b will be stored here
+ */
 AVInteger av_mod_i(AVInteger *quot, AVInteger a, AVInteger b);
+
+/**
+ * returns a/b.
+ */
 AVInteger av_div_i(AVInteger a, AVInteger b);
+
+/**
+ * converts the given int64_t to an AVInteger.
+ */
 AVInteger av_int2i(int64_t a);
+
+/**
+ * converts the given AVInteger to an int64_t.
+ * if the AVInteger is too large to fit into an int64_t,
+ * then only the least significant 64bit will be used
+ */
 int64_t av_i2int(AVInteger a);
 
 #endif // INTEGER_H

Modified: branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavutil/internal.h
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavutil/internal.h	2007-07-16 17:44:22 UTC (rev 3383)
+++ branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavutil/internal.h	2007-07-16 17:45:07 UTC (rev 3384)
@@ -26,14 +26,14 @@
 #ifndef INTERNAL_H
 #define INTERNAL_H
 
-#ifndef attribute_align_arg
-#if defined(__GNUC__) && (__GNUC__ > 4 || __GNUC__ == 4 && __GNUC_MINOR__ > 1)
-#    define attribute_align_arg __attribute__((force_align_arg_pointer))
-#else
-#    define attribute_align_arg
-#endif
-#endif
+#if !defined(DEBUG) && !defined(NDEBUG)
+#    define NDEBUG
+#endif
 
+#include <stdint.h>
+#include <stddef.h>
+#include <assert.h>
+
 #ifndef attribute_used
 #if defined(__GNUC__) && (__GNUC__ > 3 || __GNUC__ == 3 && __GNUC_MINOR__ > 0)
 #    define attribute_used __attribute__((used))
@@ -42,46 +42,10 @@
 #endif
 #endif
 
-#ifndef attribute_unused
-#if defined(__GNUC__)
-#    define attribute_unused __attribute__((unused))
-#else
-#    define attribute_unused
-#endif
-#endif
-
 #ifndef M_PI
 #define M_PI    3.14159265358979323846
 #endif
 
-#ifndef PRId64
-#define PRId64 "lld"
-#endif
-
-#ifndef PRIu64
-#define PRIu64 "llu"
-#endif
-
-#ifndef PRIx64
-#define PRIx64 "llx"
-#endif
-
-#ifndef PRIX64
-#define PRIX64 "llX"
-#endif
-
-#ifndef PRId32
-#define PRId32 "d"
-#endif
-
-#ifndef PRIdFAST16
-#define PRIdFAST16 PRId32
-#endif
-
-#ifndef PRIdFAST32
-#define PRIdFAST32 PRId32
-#endif
-
 #ifndef INT16_MIN
 #define INT16_MIN       (-0x7fff-1)
 #endif
@@ -126,45 +90,20 @@
 #    define PIC
 #endif
 
-#ifndef ENODATA
-#    define ENODATA  61
-#endif
-
 #include "intreadwrite.h"
 #include "bswap.h"
 
-#include <stddef.h>
 #ifndef offsetof
 #    define offsetof(T,F) ((unsigned int)((char *)&((T *)0)->F))
 #endif
 
-#ifdef __MINGW32__
-#    ifdef _DEBUG
-#        define DEBUG
-#    endif
-
-#    define snprintf _snprintf
-#    define vsnprintf _vsnprintf
-
-#    ifdef CONFIG_WINCE
-#        define perror(a)
-#        define abort()
-#    endif
-
-/* __MINGW32__ end */
-#elif defined (CONFIG_OS2)
-/* OS/2 EMX */
-
-#    include <float.h>
-
-#endif /* !__MINGW32__ && CONFIG_OS2 */
-
 #ifdef USE_FASTMEMCPY
 #    include "libvo/fastmemcpy.h"
+#    define memcpy(a,b,c) fast_memcpy(a,b,c)
 #endif
 
 // Use rip-relative addressing if compiling PIC code on x86-64.
-#if defined(__MINGW32__) || defined(__APPLE__)|| defined(__CYGWIN__) || \
+#if defined(__MINGW32__) || defined(__CYGWIN__) || \
     defined(__OS2__) || (defined (__OpenBSD__) && !defined(__ELF__))
 #    if defined(ARCH_X86_64) && defined(PIC)
 #        define MANGLE(a) "_" #a"(%%rip)"
@@ -183,16 +122,11 @@
 
 /* debug stuff */
 
-#if !defined(DEBUG) && !defined(NDEBUG)
-#    define NDEBUG
-#endif
-#include <assert.h>
-
 /* dprintf macros */
 #ifdef DEBUG
-#    define dprintf(fmt,...) av_log(NULL, AV_LOG_DEBUG, fmt, __VA_ARGS__)
+#    define dprintf(pctx, ...) av_log(pctx, AV_LOG_DEBUG, __VA_ARGS__)
 #else
-#    define dprintf(fmt,...)
+#    define dprintf(pctx, ...)
 #endif
 
 #define av_abort()      do { av_log(NULL, AV_LOG_ERROR, "Abort at %s:%d\n", __FILE__, __LINE__); abort(); } while (0)
@@ -234,16 +168,16 @@
 static inline int ff_sqrt(int a)
 {
     int ret=0;
-    int s;
-    int ret_sq=0;
+    int s, b;
 
     if(a<128) return ff_sqrt_tab[a];
 
-    for(s=15; s>=0; s--){
-        int b= ret_sq + (1<<(s*2)) + (ret<<s)*2;
+    for(s=30; s>=0; s-=2){
+        ret+=ret;
+        b= (1+2*ret)<<s;
         if(b<=a){
-            ret_sq=b;
-            ret+= 1<<s;
+            a-=b;
+            ret++;
         }
     }
     return ret;
@@ -270,7 +204,7 @@
     "cmovl %3, %0       \n\t"\
     "cmovl %4, %1       \n\t"\
     "cmovl %5, %2       \n\t"\
-    : "+r" (x), "+r" (a), "+r" (c)\
+    : "+&r" (x), "+&r" (a), "+r" (c)\
     : "r" (y), "r" (b), "r" (d)\
 );
 #else
@@ -283,16 +217,30 @@
 #endif
 
 /* avoid usage of various functions */
+#undef  malloc
 #define malloc please_use_av_malloc
+#undef  free
 #define free please_use_av_free
+#undef  realloc
 #define realloc please_use_av_realloc
+#undef  time
 #define time time_is_forbidden_due_to_security_issues
-#define rand rand_is_forbidden_due_to_state_trashing
-#define srand srand_is_forbidden_due_to_state_trashing
+#undef  rand
+#define rand rand_is_forbidden_due_to_state_trashing_use_av_random
+#undef  srand
+#define srand srand_is_forbidden_due_to_state_trashing_use_av_init_random
+#undef  random
+#define random random_is_forbidden_due_to_state_trashing_use_av_random
+#undef  sprintf
 #define sprintf sprintf_is_forbidden_due_to_security_issues_use_snprintf
-#define strcat strcat_is_forbidden_due_to_security_issues_use_pstrcat
-#if !(defined(LIBAVFORMAT_BUILD) || defined(_FRAMEHOOK_H))
+#undef  strcat
+#define strcat strcat_is_forbidden_due_to_security_issues_use_av_strlcat
+#undef  exit
+#define exit exit_is_forbidden
+#if !(defined(LIBAVFORMAT_BUILD) || defined(FRAMEHOOK_H))
+#undef  printf
 #define printf please_use_av_log
+#undef  fprintf
 #define fprintf please_use_av_log
 #endif
 
@@ -311,21 +259,7 @@
 /* btw, rintf() is existing on fbsd too -- alex */
 static av_always_inline long int lrintf(float x)
 {
-#ifdef __MINGW32__
-#  ifdef ARCH_X86_32
-    int32_t i;
-    asm volatile(
-        "fistpl %0\n\t"
-        : "=m" (i) : "t" (x) : "st"
-    );
-    return i;
-#  else
-    /* XXX: incorrect, but make it compile */
-    return (int)(x + (x < 0 ? -0.5 : 0.5));
-#  endif /* ARCH_X86_32 */
-#else
     return (int)(rint(x));
-#endif /* __MINGW32__ */
 }
 #endif /* HAVE_LRINTF */
 

Modified: branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavutil/intreadwrite.h
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavutil/intreadwrite.h	2007-07-16 17:44:22 UTC (rev 3383)
+++ branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavutil/intreadwrite.h	2007-07-16 17:45:07 UTC (rev 3384)
@@ -1,6 +1,27 @@
+/*
+ * This file is part of FFmpeg.
+ *
+ * FFmpeg is free software; you can redistribute it and/or
+ * modify it under the terms of the GNU Lesser General Public
+ * License as published by the Free Software Foundation; either
+ * version 2.1 of the License, or (at your option) any later version.
+ *
+ * FFmpeg is distributed in the hope that it will be useful,
+ * but WITHOUT ANY WARRANTY; without even the implied warranty of
+ * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ * Lesser General Public License for more details.
+ *
+ * You should have received a copy of the GNU Lesser General Public
+ * License along with FFmpeg; if not, write to the Free Software
+ * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA
+ */
+
 #ifndef INTREADWRITE_H
 #define INTREADWRITE_H
 
+#include <stdint.h>
+#include "bswap.h"
+
 #ifdef __GNUC__
 
 struct unaligned_64 { uint64_t l; } __attribute__((packed));
@@ -13,6 +34,7 @@
 
 #define ST16(a, b) (((struct unaligned_16 *) (a))->l) = (b)
 #define ST32(a, b) (((struct unaligned_32 *) (a))->l) = (b)
+#define ST64(a, b) (((struct unaligned_64 *) (a))->l) = (b)
 
 #else /* __GNUC__ */
 
@@ -22,44 +44,146 @@
 
 #define ST16(a, b) *((uint16_t*)(a)) = (b)
 #define ST32(a, b) *((uint32_t*)(a)) = (b)
+#define ST64(a, b) *((uint64_t*)(a)) = (b)
 
 #endif /* !__GNUC__ */
 
 /* endian macros */
-#define AV_RB8(x)  (((uint8_t*)(x))[0])
-#define AV_WB8(p, i, d)  { ((uint8_t*)(p))[(i)] = (d); }
+#define AV_RB8(x)     (((uint8_t*)(x))[0])
+#define AV_WB8(p, d)  do { ((uint8_t*)(p))[0] = (d); } while(0)
 
-#define AV_RB16(x) ((((uint8_t*)(x))[0] << 8) | ((uint8_t*)(x))[1])
-#define AV_WB16(p, i, d) { \
-                    ((uint8_t*)(p))[(i)+1] = (d); \
-                    ((uint8_t*)(p))[(i)] = (d)>>8; }
+#define AV_RL8(x)     AV_RB8(x)
+#define AV_WL8(p, d)  AV_WB8(p, d)
 
-#define AV_RB32(x) ((((uint8_t*)(x))[0] << 24) | \
-                   (((uint8_t*)(x))[1] << 16) | \
-                   (((uint8_t*)(x))[2] << 8) | \
-                    ((uint8_t*)(x))[3])
-#define AV_WB32(p, i, d) { \
-                    ((uint8_t*)(p))[(i)+3] = (d); \
-                    ((uint8_t*)(p))[(i)+2] = (d)>>8; \
-                    ((uint8_t*)(p))[(i)+1] = (d)>>16; \
-                    ((uint8_t*)(p))[(i)] = (d)>>24; }
+#ifdef HAVE_FAST_UNALIGNED
+# ifdef WORDS_BIGENDIAN
+#  define AV_RB16(x)    LD16(x)
+#  define AV_WB16(p, d) ST16(p, d)
 
-#define AV_RL8(x)  AV_RB8(x)
-#define AV_WL8(p, i, d)  AV_WB8(p, i, d)
+#  define AV_RL16(x)    bswap_16(LD16(x))
+#  define AV_WL16(p, d) ST16(p, bswap_16(d))
+# else /* WORDS_BIGENDIAN */
+#  define AV_RB16(x)    bswap_16(LD16(x))
+#  define AV_WB16(p, d) ST16(p, bswap_16(d))
 
-#define AV_RL16(x) ((((uint8_t*)(x))[1] << 8) | ((uint8_t*)(x))[0])
-#define AV_WL16(p, i, d) { \
-                    ((uint8_t*)(p))[(i)] = (d); \
-                    ((uint8_t*)(p))[(i)+1] = (d)>>8; }
+#  define AV_RL16(x)    LD16(x)
+#  define AV_WL16(p, d) ST16(p, d)
+# endif
+#else /* HAVE_FAST_UNALIGNED */
+#define AV_RB16(x)  ((((uint8_t*)(x))[0] << 8) | ((uint8_t*)(x))[1])
+#define AV_WB16(p, d) do { \
+                    ((uint8_t*)(p))[1] = (d); \
+                    ((uint8_t*)(p))[0] = (d)>>8; } while(0)
 
+#define AV_RL16(x)  ((((uint8_t*)(x))[1] << 8) | \
+                      ((uint8_t*)(x))[0])
+#define AV_WL16(p, d) do { \
+                    ((uint8_t*)(p))[0] = (d); \
+                    ((uint8_t*)(p))[1] = (d)>>8; } while(0)
+#endif
+
+#define AV_RB24(x)  ((((uint8_t*)(x))[0] << 16) | \
+                     (((uint8_t*)(x))[1] <<  8) | \
+                      ((uint8_t*)(x))[2])
+#define AV_WB24(p, d) do { \
+                    ((uint8_t*)(p))[2] = (d); \
+                    ((uint8_t*)(p))[1] = (d)>>8; \
+                    ((uint8_t*)(p))[0] = (d)>>16; } while(0)
+
+#define AV_RL24(x)  ((((uint8_t*)(x))[2] << 16) | \
+                     (((uint8_t*)(x))[1] <<  8) | \
+                      ((uint8_t*)(x))[0])
+#define AV_WL24(p, d) do { \
+                    ((uint8_t*)(p))[0] = (d); \
+                    ((uint8_t*)(p))[1] = (d)>>8; \
+                    ((uint8_t*)(p))[2] = (d)>>16; } while(0)
+
+#ifdef HAVE_FAST_UNALIGNED
+# ifdef WORDS_BIGENDIAN
+#  define AV_RB32(x)    LD32(x)
+#  define AV_WB32(p, d) ST32(p, d)
+
+#  define AV_RL32(x)    bswap_32(LD32(x))
+#  define AV_WL32(p, d) ST32(p, bswap_32(d))
+# else /* WORDS_BIGENDIAN */
+#  define AV_RB32(x)    bswap_32(LD32(x))
+#  define AV_WB32(p, d) ST32(p, bswap_32(d))
+
+#  define AV_RL32(x)    LD32(x)
+#  define AV_WL32(p, d) ST32(p, d)
+# endif
+#else /* HAVE_FAST_UNALIGNED */
+#define AV_RB32(x)  ((((uint8_t*)(x))[0] << 24) | \
+                     (((uint8_t*)(x))[1] << 16) | \
+                     (((uint8_t*)(x))[2] <<  8) | \
+                      ((uint8_t*)(x))[3])
+#define AV_WB32(p, d) do { \
+                    ((uint8_t*)(p))[3] = (d); \
+                    ((uint8_t*)(p))[2] = (d)>>8; \
+                    ((uint8_t*)(p))[1] = (d)>>16; \
+                    ((uint8_t*)(p))[0] = (d)>>24; } while(0)
+
 #define AV_RL32(x) ((((uint8_t*)(x))[3] << 24) | \
-                   (((uint8_t*)(x))[2] << 16) | \
-                   (((uint8_t*)(x))[1] << 8) | \
-                    ((uint8_t*)(x))[0])
-#define AV_WL32(p, i, d) { \
-                    ((uint8_t*)(p))[(i)] = (d); \
-                    ((uint8_t*)(p))[(i)+1] = (d)>>8; \
-                    ((uint8_t*)(p))[(i)+2] = (d)>>16; \
-                    ((uint8_t*)(p))[(i)+3] = (d)>>24; }
+                    (((uint8_t*)(x))[2] << 16) | \
+                    (((uint8_t*)(x))[1] <<  8) | \
+                     ((uint8_t*)(x))[0])
+#define AV_WL32(p, d) do { \
+                    ((uint8_t*)(p))[0] = (d); \
+                    ((uint8_t*)(p))[1] = (d)>>8; \
+                    ((uint8_t*)(p))[2] = (d)>>16; \
+                    ((uint8_t*)(p))[3] = (d)>>24; } while(0)
+#endif
 
+#ifdef HAVE_FAST_UNALIGNED
+# ifdef WORDS_BIGENDIAN
+#  define AV_RB64(x)    LD64(x)
+#  define AV_WB64(p, d) ST64(p, d)
+
+#  define AV_RL64(x)    bswap_64(LD64(x))
+#  define AV_WL64(p, d) ST64(p, bswap_64(d))
+# else /* WORDS_BIGENDIAN */
+#  define AV_RB64(x)    bswap_64(LD64(x))
+#  define AV_WB64(p, d) ST64(p, bswap_64(d))
+
+#  define AV_RL64(x)    LD64(x)
+#  define AV_WL64(p, d) ST64(p, d)
+# endif
+#else /* HAVE_FAST_UNALIGNED */
+#define AV_RB64(x)  (((uint64_t)((uint8_t*)(x))[0] << 56) | \
+                     ((uint64_t)((uint8_t*)(x))[1] << 48) | \
+                     ((uint64_t)((uint8_t*)(x))[2] << 40) | \
+                     ((uint64_t)((uint8_t*)(x))[3] << 32) | \
+                     ((uint64_t)((uint8_t*)(x))[4] << 24) | \
+                     ((uint64_t)((uint8_t*)(x))[5] << 16) | \
+                     ((uint64_t)((uint8_t*)(x))[6] <<  8) | \
+                      (uint64_t)((uint8_t*)(x))[7])
+#define AV_WB64(p, d) do { \
+                    ((uint8_t*)(p))[7] = (d);     \
+                    ((uint8_t*)(p))[6] = (d)>>8;  \
+                    ((uint8_t*)(p))[5] = (d)>>16; \
+                    ((uint8_t*)(p))[4] = (d)>>24; \
+                    ((uint8_t*)(p))[3] = (d)>>32; \
+                    ((uint8_t*)(p))[2] = (d)>>40; \
+                    ((uint8_t*)(p))[1] = (d)>>48; \
+                    ((uint8_t*)(p))[0] = (d)>>56; } while(0)
+
+#define AV_RL64(x)  (((uint64_t)((uint8_t*)(x))[7] << 56) | \
+                     ((uint64_t)((uint8_t*)(x))[6] << 48) | \
+                     ((uint64_t)((uint8_t*)(x))[5] << 40) | \
+                     ((uint64_t)((uint8_t*)(x))[4] << 32) | \
+                     ((uint64_t)((uint8_t*)(x))[3] << 24) | \
+                     ((uint64_t)((uint8_t*)(x))[2] << 16) | \
+                     ((uint64_t)((uint8_t*)(x))[1] <<  8) | \
+                      (uint64_t)((uint8_t*)(x))[0])
+#define AV_WL64(p, d) do { \
+                    ((uint8_t*)(p))[0] = (d);     \
+                    ((uint8_t*)(p))[1] = (d)>>8;  \
+                    ((uint8_t*)(p))[2] = (d)>>16; \
+                    ((uint8_t*)(p))[3] = (d)>>24; \
+                    ((uint8_t*)(p))[4] = (d)>>32; \
+                    ((uint8_t*)(p))[5] = (d)>>40; \
+                    ((uint8_t*)(p))[6] = (d)>>48; \
+                    ((uint8_t*)(p))[7] = (d)>>56; } while(0)
+#endif
+
 #endif /* INTREADWRITE_H */

Modified: branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavutil/lls.c
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavutil/lls.c	2007-07-16 17:44:22 UTC (rev 3383)
+++ branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavutil/lls.c	2007-07-16 17:45:07 UTC (rev 3384)
@@ -17,7 +17,7 @@
  *
  * You should have received a copy of the GNU Lesser General Public
  * License along with FFmpeg; if not, write to the Free Software
- * Foundation, Inc., 51 Franklin St, Fifth Floor, Boston, MA  02110-1301  USA
+ * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA
  */
 
 /**

Modified: branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavutil/lls.h
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavutil/lls.h	2007-07-16 17:44:22 UTC (rev 3383)
+++ branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavutil/lls.h	2007-07-16 17:45:07 UTC (rev 3384)
@@ -17,7 +17,7 @@
  *
  * You should have received a copy of the GNU Lesser General Public
  * License along with FFmpeg; if not, write to the Free Software
- * Foundation, Inc., 51 Franklin St, Fifth Floor, Boston, MA  02110-1301  USA
+ * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA
  */
 
 #ifndef LLS_H

Modified: branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavutil/log.h
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavutil/log.h	2007-07-16 17:44:22 UTC (rev 3383)
+++ branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavutil/log.h	2007-07-16 17:45:07 UTC (rev 3384)
@@ -38,14 +38,65 @@
 
 /* av_log API */
 
+#if LIBAVUTIL_VERSION_INT < (50<<16)
 #define AV_LOG_QUIET -1
+#define AV_LOG_FATAL 0
 #define AV_LOG_ERROR 0
+#define AV_LOG_WARNING 1
 #define AV_LOG_INFO 1
+#define AV_LOG_VERBOSE 1
 #define AV_LOG_DEBUG 2
-#define AV_LOG_VERBOSE 2
+#else
+#define AV_LOG_QUIET    -8
 
+/**
+ * something went really wrong and we will crash now
+ */
+#define AV_LOG_PANIC     0
+
+/**
+ * something went wrong and recovery is not possible
+ * like no header in a format which depends on it or a combination
+ * of parameters which are not allowed
+ */
+#define AV_LOG_FATAL     8
+
+/**
+ * something went wrong and cannot losslessly be recovered
+ * but not all future data is affected
+ */
+#define AV_LOG_ERROR    16
+
+/**
+ * something somehow does not look correct / something which may or may not
+ * lead to some problems like use of -vstrict -2
+ */
+#define AV_LOG_WARNING  24
+
+#define AV_LOG_INFO     32
+#define AV_LOG_VERBOSE  40
+
+/**
+ * stuff which is only useful for libav* developers
+ */
+#define AV_LOG_DEBUG    48
+#endif
 extern int av_log_level;
 
+/**
+ * Send the specified message to the log if the level is less than or equal to
+ * the current av_log_level. By default, all logging messages are sent to
+ * stderr. This behavior can be altered by setting a different av_vlog callback
+ * function.
+ *
+ * @param avcl A pointer to an arbitrary struct of which the first field is a
+ * pointer to an AVClass struct.
+ * @param level The importance level of the message, lower values signifying
+ * higher importance.
+ * @param fmt The format string (printf-compatible) that specifies how
+ * subsequent arguments are converted to output.
+ * @see av_vlog
+ */
 #ifdef __GNUC__
 extern void av_log(void*, int level, const char *fmt, ...) __attribute__ ((__format__ (__printf__, 3, 4)));
 #else

Modified: branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavutil/md5.c
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavutil/md5.c	2007-07-16 17:44:22 UTC (rev 3383)
+++ branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavutil/md5.c	2007-07-16 17:45:07 UTC (rev 3384)
@@ -2,6 +2,17 @@
  * Copyright (C) 2006 Michael Niedermayer (michaelni at gmx.at)
  * Copyright (C) 2003-2005 by Christopher R. Hertel (crh at ubiqx.mn.org)
  *
+ * References:
+ *  IETF RFC 1321: The MD5 Message-Digest Algorithm
+ *       Ron Rivest. IETF, April, 1992
+ *
+ * based on http://ubiqx.org/libcifs/source/Auth/MD5.c
+ *          from Christopher R. Hertel (crh at ubiqx.mn.org)
+ * Simplified, cleaned and IMO redundant comments removed by michael.
+ *
+ * If you use gcc, then version 4.1 or later and -fomit-frame-pointer is
+ * strongly recommended.
+ *
  * This file is part of FFmpeg.
  *
  * FFmpeg is free software; you can redistribute it and/or
@@ -17,17 +28,6 @@
  * You should have received a copy of the GNU Lesser General Public
  * License along with FFmpeg; if not, write to the Free Software
  * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA
- *
- * References:
- *  IETF RFC 1321: The MD5 Message-Digest Algorithm
- *       Ron Rivest. IETF, April, 1992
- *
- * based on http://ubiqx.org/libcifs/source/Auth/MD5.c
- *          from Christopher R. Hertel (crh at ubiqx.mn.org)
- * simplified, cleaned and IMO redundant comments removed by michael
- *
- * if you use gcc, then version 4.1 or later and -fomit-frame-pointer is
- * strongly recommended
  */
 
 #include "common.h"
@@ -35,10 +35,9 @@
 #include "md5.h"
 
 typedef struct AVMD5{
+    uint64_t len;
     uint8_t  block[64];
     uint32_t ABCD[4];
-    uint64_t len;
-    int      b_used;
 } AVMD5;
 
 const int av_md5_size= sizeof(AVMD5);
@@ -50,7 +49,7 @@
     { 6, 10, 15, 21 }   /* Round 4 */
 };
 
-static const uint32_t T[64] = {
+static const uint32_t T[64] = { // T[i]= fabs(sin(i+1)<<32)
     0xd76aa478, 0xe8c7b756, 0x242070db, 0xc1bdceee,   /* Round 1 */
     0xf57c0faf, 0x4787c62a, 0xa8304613, 0xfd469501,
     0x698098d8, 0x8b44f7af, 0xffff5bb1, 0x895cd7be,
@@ -76,18 +75,19 @@
         t = S[i>>4][i&3];\
         a += T[i];\
 \
-        switch(i>>4){\
-        case 0: a += (d ^ (b&(c^d))) + X[      i &15 ]; break;\
-        case 1: a += (c ^ (d&(c^b))) + X[ (1+5*i)&15 ]; break;\
-        case 2: a += (b^c^d)         + X[ (5+3*i)&15 ]; break;\
-        case 3: a += (c^(b|~d))      + X[ (  7*i)&15 ]; break;\
+        if(i<32){\
+            if(i<16) a += (d ^ (b&(c^d))) + X[      i &15 ];\
+            else     a += (c ^ (d&(c^b))) + X[ (1+5*i)&15 ];\
+        }else{\
+            if(i<48) a += (b^c^d)         + X[ (5+3*i)&15 ];\
+            else     a += (c^(b|~d))      + X[ (  7*i)&15 ];\
         }\
         a = b + (( a << t ) | ( a >> (32 - t) ));
 
 static void body(uint32_t ABCD[4], uint32_t X[16]){
 
     int t;
-    int i attribute_unused;
+    int i av_unused;
     unsigned int a= ABCD[3];
     unsigned int b= ABCD[2];
     unsigned int c= ABCD[1];
@@ -117,7 +117,6 @@
 
 void av_md5_init(AVMD5 *ctx){
     ctx->len    = 0;
-    ctx->b_used = 0;
 
     ctx->ABCD[0] = 0x10325476;
     ctx->ABCD[1] = 0x98badcfe;
@@ -126,36 +125,30 @@
 }
 
 void av_md5_update(AVMD5 *ctx, const uint8_t *src, const int len){
-    int i;
+    int i, j;
 
+    j= ctx->len & 63;
     ctx->len += len;
 
     for( i = 0; i < len; i++ ){
-        ctx->block[ ctx->b_used++ ] = src[i];
-        if( 64 == ctx->b_used ){
+        ctx->block[j++] = src[i];
+        if( 64 == j ){
             body(ctx->ABCD, (uint32_t*) ctx->block);
-            ctx->b_used = 0;
+            j = 0;
         }
     }
 }
 
 void av_md5_final(AVMD5 *ctx, uint8_t *dst){
     int i;
+    uint64_t finalcount= le2me_64(ctx->len<<3);
 
-    ctx->block[ctx->b_used++] = 0x80;
+    av_md5_update(ctx, "\200", 1);
+    while((ctx->len & 63)<56)
+        av_md5_update(ctx, "", 1);
 
-    memset(&ctx->block[ctx->b_used], 0, 64 - ctx->b_used);
+    av_md5_update(ctx, &finalcount, 8);
 
-    if( 56 < ctx->b_used ){
-        body( ctx->ABCD, (uint32_t*) ctx->block );
-        memset(ctx->block, 0, 64);
-    }
-
-    for(i=0; i<8; i++)
-        ctx->block[56+i] = (ctx->len << 3) >> (i<<3);
-
-    body(ctx->ABCD, (uint32_t*) ctx->block);
-
     for(i=0; i<4; i++)
         ((uint32_t*)dst)[i]= le2me_32(ctx->ABCD[3-i]);
 }
@@ -170,6 +163,7 @@
 
 #ifdef TEST
 #include <stdio.h>
+#undef printf
 main(){
     uint64_t md5val;
     int i;

Modified: branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavutil/md5.h
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavutil/md5.h	2007-07-16 17:44:22 UTC (rev 3383)
+++ branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavutil/md5.h	2007-07-16 17:45:07 UTC (rev 3384)
@@ -21,6 +21,8 @@
 #ifndef MD5_H
 #define MD5_H
 
+#include <stdint.h>
+
 extern const int av_md5_size;
 
 struct AVMD5;

Modified: branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavutil/mem.c
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavutil/mem.c	2007-07-16 17:44:22 UTC (rev 3383)
+++ branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavutil/mem.c	2007-07-16 17:45:07 UTC (rev 3384)
@@ -26,7 +26,7 @@
 
 #include "common.h"
 
-/* here we can use OS dependant allocation functions */
+/* here we can use OS dependent allocation functions */
 #undef malloc
 #undef free
 #undef realloc
@@ -39,11 +39,6 @@
    memory allocator. You do not need to suppress this file because the
    linker will do it automatically */
 
-/**
- * Memory allocation of size byte with alignment suitable for all
- * memory accesses (including vectors if available on the
- * CPU). av_malloc(0) must return a non NULL pointer.
- */
 void *av_malloc(unsigned int size)
 {
     void *ptr;
@@ -96,11 +91,6 @@
     return ptr;
 }
 
-/**
- * av_realloc semantics (same as glibc): if ptr is NULL and size > 0,
- * identical to malloc(size). If size is zero, it is identical to
- * free(ptr) and NULL is returned.
- */
 void *av_realloc(void *ptr, unsigned int size)
 {
 #ifdef CONFIG_MEMALIGN_HACK
@@ -121,11 +111,6 @@
 #endif
 }
 
-/**
- * Free memory which has been allocated with av_malloc(z)() or av_realloc().
- * NOTE: ptr = NULL is explicetly allowed
- * Note2: it is recommended that you use av_freep() instead
- */
 void av_free(void *ptr)
 {
     /* XXX: this test should not be needed on most libcs */
@@ -137,10 +122,6 @@
 #endif
 }
 
-/**
- * Frees memory and sets the pointer to NULL.
- * @param arg pointer to the pointer which should be freed
- */
 void av_freep(void *arg)
 {
     void **ptr= (void**)arg;

Modified: branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavutil/rational.c
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavutil/rational.c	2007-07-16 17:44:22 UTC (rev 3383)
+++ branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavutil/rational.c	2007-07-16 17:45:07 UTC (rev 3384)
@@ -17,7 +17,6 @@
  * You should have received a copy of the GNU Lesser General Public
  * License along with FFmpeg; if not, write to the Free Software
  * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA
- *
  */
 
 /**
@@ -75,40 +74,24 @@
     return den==0;
 }
 
-/**
- * returns b*c.
- */
 AVRational av_mul_q(AVRational b, AVRational c){
     av_reduce(&b.num, &b.den, b.num * (int64_t)c.num, b.den * (int64_t)c.den, INT_MAX);
     return b;
 }
 
-/**
- * returns b/c.
- */
 AVRational av_div_q(AVRational b, AVRational c){
     return av_mul_q(b, (AVRational){c.den, c.num});
 }
 
-/**
- * returns b+c.
- */
 AVRational av_add_q(AVRational b, AVRational c){
     av_reduce(&b.num, &b.den, b.num * (int64_t)c.den + c.num * (int64_t)b.den, b.den * (int64_t)c.den, INT_MAX);
     return b;
 }
 
-/**
- * returns b-c.
- */
 AVRational av_sub_q(AVRational b, AVRational c){
     return av_add_q(b, (AVRational){-c.num, c.den});
 }
 
-/**
- * Converts a double precission floating point number to a AVRational.
- * @param max the maximum allowed numerator and denominator
- */
 AVRational av_d2q(double d, int max){
     AVRational a;
 #define LOG2  0.69314718055994530941723212145817656807550013436025

Modified: branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavutil/rational.h
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavutil/rational.h	2007-07-16 17:44:22 UTC (rev 3383)
+++ branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavutil/rational.h	2007-07-16 17:45:07 UTC (rev 3384)
@@ -17,7 +17,6 @@
  * You should have received a copy of the GNU Lesser General Public
  * License along with FFmpeg; if not, write to the Free Software
  * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA
- *
  */
 
 /**
@@ -29,6 +28,8 @@
 #ifndef RATIONAL_H
 #define RATIONAL_H
 
+#include <stdint.h>
+
 /**
  * Rational number num/den.
  */
@@ -38,7 +39,10 @@
 } AVRational;
 
 /**
- * returns 0 if a==b, 1 if a>b and -1 if a<b.
+ * Compare two rationals.
+ * @param a first rational
+ * @param b second rational
+ * @return 0 if a==b, 1 if a>b and -1 if a<b.
  */
 static inline int av_cmp_q(AVRational a, AVRational b){
     const int64_t tmp= a.num * (int64_t)b.den - b.num * (int64_t)a.den;
@@ -48,24 +52,64 @@
 }
 
 /**
- * converts the given AVRational to a double.
+ * Rational to double conversion.
+ * @param a rational to convert
+ * @return (double) a
  */
 static inline double av_q2d(AVRational a){
     return a.num / (double) a.den;
 }
 
 /**
- * reduce a fraction.
- * this is usefull for framerate calculations
+ * Reduce a fraction.
+ * This is useful for framerate calculations.
+ * @param dst_nom destination numerator
+ * @param dst_den destination denominator
+ * @param nom source numerator
+ * @param den source denominator
  * @param max the maximum allowed for dst_nom & dst_den
  * @return 1 if exact, 0 otherwise
  */
 int av_reduce(int *dst_nom, int *dst_den, int64_t nom, int64_t den, int64_t max);
 
+/**
+ * Multiplies two rationals.
+ * @param b first rational.
+ * @param c second rational.
+ * @return b*c.
+ */
 AVRational av_mul_q(AVRational b, AVRational c);
+
+/**
+ * Divides one rational by another.
+ * @param b first rational.
+ * @param c second rational.
+ * @return b/c.
+ */
 AVRational av_div_q(AVRational b, AVRational c);
+
+/**
+ * Adds two rationals.
+ * @param b first rational.
+ * @param c second rational.
+ * @return b+c.
+ */
 AVRational av_add_q(AVRational b, AVRational c);
+
+/**
+ * Subtracts one rational from another.
+ * @param b first rational.
+ * @param c second rational.
+ * @return b-c.
+ */
 AVRational av_sub_q(AVRational b, AVRational c);
+
+/**
+ * Converts a double precision floating point number to a rational.
+ * @param d double to convert
+ * @param max the maximum allowed numerator and denominator
+ * @return (AVRational) d.
+ */
 AVRational av_d2q(double d, int max);
 
 #endif // RATIONAL_H

Modified: branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavutil/x86_cpu.h
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavutil/x86_cpu.h	2007-07-16 17:44:22 UTC (rev 3383)
+++ branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavutil/x86_cpu.h	2007-07-16 17:45:07 UTC (rev 3384)
@@ -57,4 +57,12 @@
 #  define REGSP   esp
 #endif
 
+#if defined(ARCH_X86_64) || (defined(ARCH_X86_32) && defined(HAVE_EBX_AVAILABLE) && defined(HAVE_EBP_AVAILABLE))
+#  define CONFIG_7REGS 1
+#endif
+
+#if defined(ARCH_X86_64) && defined(PIC)
+#  define BROKEN_RELOCATIONS 1
+#endif
+
 #endif /* AVUTIL_X86CPU_H */



From mean at mail.berlios.de  Mon Jul 16 19:53:05 2007
From: mean at mail.berlios.de (mean at BerliOS)
Date: Mon, 16 Jul 2007 19:53:05 +0200
Subject: [Avidemux-svn-commit] r3386 - in
	branches/avidemux_2.4_branch/avidemux/ADM_libraries:
	ADM_lavcodec ADM_lavutil
Message-ID: <200707161753.l6GHr50f008669@sheep.berlios.de>

Author: mean
Date: 2007-07-16 19:53:04 +0200 (Mon, 16 Jul 2007)
New Revision: 3386

Added:
   branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec/dnxhddata.h
   branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec/dnxhddec.c
   branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec/fraps.c
   branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavutil/string.c
Log:
[LAV] Missing files

Added: branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec/dnxhddata.h
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec/dnxhddata.h	2007-07-16 17:46:57 UTC (rev 3385)
+++ branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec/dnxhddata.h	2007-07-16 17:53:04 UTC (rev 3386)
@@ -0,0 +1,113 @@
+/*
+ * VC3/DNxHD decoder.
+ * Copyright (c) 2007 SmartJog S.A., Baptiste Coudurier <baptiste dot coudurier at smartjog dot com>.
+ *
+ * This file is part of FFmpeg.
+ *
+ * FFmpeg is free software; you can redistribute it and/or
+ * modify it under the terms of the GNU Lesser General Public
+ * License as published by the Free Software Foundation; either
+ * version 2.1 of the License, or (at your option) any later version.
+ *
+ * FFmpeg is distributed in the hope that it will be useful,
+ * but WITHOUT ANY WARRANTY; without even the implied warranty of
+ * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ * Lesser General Public License for more details.
+ *
+ * You should have received a copy of the GNU Lesser General Public
+ * License along with FFmpeg; if not, write to the Free Software
+ * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA
+ */
+
+#ifndef AVCODEC_DNXHDDATA_H
+#define AVCODEC_DNXHDDATA_H
+
+#include <stdint.h>
+
+static const uint8_t dnxhd_1238_luma_weigth[] = {
+     0, 32, 32, 33, 34, 33, 33, 33,
+    33, 33, 33, 33, 33, 35, 37, 37,
+    36, 36, 35, 36, 38, 38, 36, 35,
+    36, 37, 38, 41, 42, 41, 39, 38,
+    38, 38, 39, 41, 42, 41, 39, 39,
+    40, 41, 43, 44, 44, 44, 44, 44,
+    45, 47, 47, 47, 49, 50, 51, 51,
+    51, 53, 55, 57, 58, 59, 57, 57,
+};
+
+static const uint8_t dnxhd_1238_chroma_weigth[] = {
+     0, 32, 35, 35, 35, 34, 34, 35,
+    39, 43, 45, 45, 41, 39, 40, 41,
+    42, 44, 48, 55, 59, 63, 65, 59,
+    53, 52, 52, 55, 61, 62, 58, 58,
+    63, 66, 66, 65, 70, 74, 70, 66,
+    65, 68, 75, 77, 74, 74, 77, 76,
+    73, 73, 73, 73, 76, 80, 89, 90,
+    82, 77, 80, 86, 84, 82, 82, 82,
+};
+
+/* FIXME permute */
+static const uint8_t dnxhd_1243_luma_weigth[] = {
+     0,32,35,35,38,40,44,45,
+    32,33,35,35,39,42,44,45,
+    33,35,34,37,41,42,45,45,
+    35,35,37,40,41,44,45,48,
+    35,37,38,40,43,45,47,48,
+    36,36,38,40,45,47,48,47,
+    35,36,38,41,45,46,47,48,
+    36,37,39,41,44,45,47,47,
+};
+
+/* FIXME permute */
+static const uint8_t dnxhd_1243_chroma_weigth[] = {
+     0,32,37,39,41,42,45,45,
+    36,36,39,41,43,45,46,45,
+    37,41,41,43,45,44,45,46,
+    43,42,43,46,44,45,46,48,
+    43,44,47,45,44,46,47,49,
+    44,46,44,45,45,47,48,47,
+    44,42,46,44,45,46,47,48,
+    41,43,45,44,45,46,47,47,
+};
+
+static const uint8_t dnxhd_1238_dc_codes[12] = {
+    0, 12, 13, 1, 2, 3, 4, 5, 14, 30, 62, 63,
+};
+
+static const uint8_t dnxhd_1238_dc_bits[12] = {
+    3, 4, 4, 3, 3, 3, 3, 3, 4, 5, 6, 6,
+};
+
+static const uint16_t dnxhd_1238_ac_codes[257] = {
+    0, 1, 4, 10, 11, 24, 25, 26, 54, 55, 56, 57, 116, 117, 118, 119, 240, 241, 242, 243, 244, 245, 492, 493, 494, 495, 496, 497, 498, 499, 1000, 1001, 1002, 1003, 1004, 1005, 1006, 1007, 1008, 2018, 2019, 2020, 2021, 2022, 2023, 2024, 2025, 2026, 2027, 4056, 4057, 4058, 4059, 4060, 4061, 4062, 4063, 4064, 4065, 4066, 4067, 4068, 4069, 8140, 8141, 8142, 8143, 8144, 8145, 8146, 8147, 8148, 8149, 8150, 8151, 8152, 8153, 8154, 8155, 8156, 16314, 16315, 16316, 16317, 16318, 16319, 16320, 16321, 16322, 16323, 16324, 16325, 16326, 16327, 16328, 16329, 16330, 16331, 16332, 16333, 16334, 16335, 16336, 16337, 16338, 32678, 32679, 32680, 32681, 32682, 32683, 32684, 32685, 32686, 32687, 32688, 32689, 32690, 32691, 32692, 32693, 32694, 32695, 32696, 32697, 32698, 32699, 32700, 32701, 32702, 32703, 32704, 32705, 65412, 65413, 65414, 65415, 65416, 65417, 65418, 65419, 65420, 65421, 65422, 65423, 65424, 65425, 65426, 65427, 65428, 65429, 65430, 65431, 65432, 65433, 65434, 65435, 65436, 654!
 37, 65438, 65439, 65440, 65441, 65442, 65443, 65444, 65445, 65446, 65447, 65448, 65449, 65450, 65451, 65452, 65453, 65454, 65455, 65456, 65457, 65458, 65459, 65460, 65461, 65462, 65463, 65464, 65465, 65466, 65467, 65468, 65469, 65470, 65471, 65472, 65473, 65474, 65475, 65476, 65477, 65478, 65479, 65480, 65481, 65482, 65483, 65484, 65485, 65486, 65487, 65488, 65489, 65490, 65491, 65492, 65493, 65494, 65495, 65496, 65497, 65498, 65499, 65500, 65501, 65502, 65503, 65504, 65505, 65506, 65507, 65508, 65509, 65510, 65511, 65512, 65513, 65514, 65515, 65516, 65517, 65518, 65519, 65520, 65521, 65522, 65523, 65524, 65525, 65526, 65527, 65528, 65529, 65530, 65531, 65532, 65533, 65534, 65535,
+};
+
+static const uint8_t dnxhd_1238_ac_bits[257] = {
+    2, 2, 3, 4, 4, 5, 5, 5, 6, 6, 6, 6, 7, 7, 7, 7, 8, 8, 8, 8, 8, 8, 9, 9, 9, 9, 9, 9, 9, 9, 10, 10, 10, 10, 10, 10, 10, 10, 10, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16!
 , 16, 16, 16,
+};
+
+static const uint8_t dnxhd_1238_ac_level[257] = {
+    1, 1, 2, 3, 0, 4, 5, 2, 6, 7, 8, 3, 9, 10, 11, 4, 12, 13, 14, 15, 16, 5, 17, 18, 19, 20, 21, 22, 6, 7, 23, 24, 25, 26, 27, 28, 29, 8, 9, 30, 31, 32, 33, 34, 35, 36, 37, 10, 11, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 12, 13, 14, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 15, 16, 17, 18, 62, 63, 64, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 19, 20, 21, 22, 23, 24, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 40, 25, 26, 27, 28, 29, 30, 38, 39, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 6!
 3, 64,
+}; /* 0 is EOB */
+
+static const uint8_t dnxhd_1238_ac_run_flag[257] = {
+    0, 1, 0, 0, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 1, 1, 0, 0, 0, 0, 0, 0, 0, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
+};
+
+static const uint8_t dnxhd_1238_ac_index_flag[257] = {
+    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
+};
+
+static const uint16_t dnxhd_1238_run_codes[62] = {
+    0, 4, 10, 11, 24, 25, 26, 27, 56, 57, 58, 59, 120, 242, 486, 487, 488, 489, 980, 981, 982, 983, 984, 985, 986, 987, 988, 989, 990, 991, 992, 993, 994, 995, 996, 997, 998, 999, 1000, 1001, 1002, 1003, 1004, 1005, 1006, 1007, 1008, 1009, 1010, 1011, 1012, 1013, 1014, 1015, 1016, 1017, 1018, 1019, 1020, 1021, 1022, 1023,
+};
+
+static const uint8_t dnxhd_1238_run_bits[62] = {
+    1, 3, 4, 4, 5, 5, 5, 5, 6, 6, 6, 6, 7, 8, 9, 9, 9, 9, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10,
+};
+
+static const uint8_t dnxhd_1238_run[62] = {
+    1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 20, 21, 17, 18, 19, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62,
+};
+
+#endif  // AVCODEC_DNXHDDATA_H

Added: branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec/dnxhddec.c
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec/dnxhddec.c	2007-07-16 17:46:57 UTC (rev 3385)
+++ branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec/dnxhddec.c	2007-07-16 17:53:04 UTC (rev 3386)
@@ -0,0 +1,368 @@
+/*
+ * VC3/DNxHD decoder.
+ * Copyright (c) 2007 SmartJog S.A., Baptiste Coudurier <baptiste dot coudurier at smartjog dot com>.
+ *
+ * This file is part of FFmpeg.
+ *
+ * FFmpeg is free software; you can redistribute it and/or
+ * modify it under the terms of the GNU Lesser General Public
+ * License as published by the Free Software Foundation; either
+ * version 2.1 of the License, or (at your option) any later version.
+ *
+ * FFmpeg is distributed in the hope that it will be useful,
+ * but WITHOUT ANY WARRANTY; without even the implied warranty of
+ * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ * Lesser General Public License for more details.
+ *
+ * You should have received a copy of the GNU Lesser General Public
+ * License along with FFmpeg; if not, write to the Free Software
+ * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA
+ */
+
+//#define TRACE
+//#define DEBUG
+
+#include "avcodec.h"
+#include "bitstream.h"
+#include "dnxhddata.h"
+#include "dsputil.h"
+#include "mpegvideo.h"
+
+typedef struct {
+    int cid;
+    unsigned int width, height;
+    int interlaced;
+    unsigned int frame_size;
+    int index_bits;
+    int bit_depth;
+    const uint8_t *luma_weigth, *chroma_weigth;
+    const uint8_t *dc_codes, *dc_bits;
+    const uint16_t *ac_codes;
+    const uint8_t *ac_bits, *ac_level;
+    const uint8_t *ac_run_flag, *ac_index_flag;
+    const uint16_t *run_codes;
+    const uint8_t *run_bits, *run;
+} CIDEntry;
+
+typedef struct {
+    AVCodecContext *avctx;
+    AVFrame picture;
+    GetBitContext gb;
+    int cid;                            ///< compression id
+    unsigned int width, height;
+    unsigned int mb_width, mb_height;
+    uint32_t mb_scan_index[68];         /* max for 1080p */
+    int cur_field;                      ///< current interlaced field
+    int index_bits;                     ///< length of index value
+    VLC ac_vlc, dc_vlc, run_vlc;
+    const uint8_t *ac_level, *run;
+    const uint8_t *ac_run_flag, *ac_index_flag;
+    const uint8_t *luma_weigth, *chroma_weigth;
+    int last_dc[3];
+    DSPContext dsp;
+    DECLARE_ALIGNED_16(DCTELEM, blocks[8][64]);
+    DECLARE_ALIGNED_8(ScanTable, scantable);
+    const CIDEntry *cid_table;
+} DNXHDContext;
+
+static const CIDEntry cid_table[] = {
+    { 1238, 1920, 1080, 0, 917504, 4, 8,
+      dnxhd_1238_luma_weigth, dnxhd_1238_chroma_weigth,
+      dnxhd_1238_dc_codes, dnxhd_1238_dc_bits,
+      dnxhd_1238_ac_codes, dnxhd_1238_ac_bits, dnxhd_1238_ac_level,
+      dnxhd_1238_ac_run_flag, dnxhd_1238_ac_index_flag,
+      dnxhd_1238_run_codes, dnxhd_1238_run_bits, dnxhd_1238_run },
+/*     { 1243, 1920, 1080, 1, 917504, 4, 8, */
+/*       dnxhd_1243_luma_weigth, dnxhd_1243_chroma_weigth, */
+/*       dnxhd_1238_dc_codes, dnxhd_1238_dc_bits, */
+/*       dnxhd_1238_ac_codes, dnxhd_1238_ac_bits, dnxhd_1238_ac_level, */
+/*       dnxhd_1238_ac_run_flag, dnxhd_1238_ac_index_flag, */
+/*       dnxhd_1238_run_codes, dnxhd_1238_run_bits, dnxhd_1238_run }, */
+};
+
+static int dnxhd_get_cid_table(int cid)
+{
+    int i;
+    for (i = 0; i < sizeof(cid_table)/sizeof(CIDEntry); i++)
+        if (cid_table[i].cid == cid)
+            return i;
+    return -1;
+}
+
+#define DNXHD_VLC_BITS 9
+#define DNXHD_DC_VLC_BITS 6
+
+static int dnxhd_decode_init(AVCodecContext *avctx)
+{
+    DNXHDContext *ctx = avctx->priv_data;
+
+    ctx->avctx = avctx;
+    dsputil_init(&ctx->dsp, avctx);
+    avctx->coded_frame = &ctx->picture;
+    ctx->picture.type = FF_I_TYPE;
+    return 0;
+}
+
+static int dnxhd_init_vlc(DNXHDContext *ctx, int cid)
+{
+    if (!ctx->cid_table) {
+        int index;
+
+        if ((index = dnxhd_get_cid_table(cid)) < 0) {
+            av_log(ctx->avctx, AV_LOG_ERROR, "unsupported cid %d\n", cid);
+            return -1;
+        }
+        ctx->cid_table = &cid_table[index];
+        init_vlc(&ctx->ac_vlc, DNXHD_VLC_BITS, 257,
+                 cid_table->ac_bits, 1, 1,
+                 cid_table->ac_codes, 2, 2, 0);
+        init_vlc(&ctx->dc_vlc, DNXHD_DC_VLC_BITS, 12,
+                 cid_table->dc_bits, 1, 1,
+                 cid_table->dc_codes, 1, 1, 0);
+        init_vlc(&ctx->run_vlc, DNXHD_VLC_BITS, 62,
+                 cid_table->run_bits, 1, 1,
+                 cid_table->run_codes, 2, 2, 0);
+
+        ctx->run           = cid_table->run;
+        ctx->ac_level      = cid_table->ac_level;
+        ctx->ac_run_flag   = cid_table->ac_run_flag;
+        ctx->ac_index_flag = cid_table->ac_index_flag;
+        ctx->luma_weigth   = cid_table->luma_weigth;
+        ctx->chroma_weigth = cid_table->chroma_weigth;
+
+        ctx->index_bits = cid_table->index_bits;
+
+        ff_init_scantable(ctx->dsp.idct_permutation, &ctx->scantable, ff_zigzag_direct);
+    }
+    return 0;
+}
+
+static int dnxhd_decode_header(DNXHDContext *ctx, uint8_t *buf, int buf_size)
+{
+    static const uint8_t header_prefix[] = { 0x00, 0x00, 0x02, 0x80, 0x01 };
+    int i;
+
+    if (buf_size < 0x280)
+        return -1;
+
+    if (memcmp(buf, header_prefix, 5)) {
+        av_log(ctx->avctx, AV_LOG_ERROR, "error in header\n");
+        return -1;
+    }
+    if (buf[5] & 2) {/* interlaced FIXME top or bottom */
+        ctx->picture.interlaced_frame = 1;
+        av_log(ctx->avctx, AV_LOG_DEBUG, "interlaced %d\n", buf[5] & 3);
+    }
+
+    ctx->height = AV_RB16(buf + 0x18);
+    ctx->width  = AV_RB16(buf + 0x1a);
+
+    dprintf(ctx->avctx, "width %d, heigth %d\n", ctx->width, ctx->height);
+
+    if (buf[0x21] & 0x80) {
+        av_log(ctx->avctx, AV_LOG_ERROR, "10 bit per component\n");
+        return -1;
+    }
+
+    ctx->cid = AV_RB32(buf + 0x28);
+    dprintf(ctx->avctx, "compression id %d\n", ctx->cid);
+
+    if (dnxhd_init_vlc(ctx, ctx->cid) < 0)
+        return -1;
+
+    if (buf_size < ctx->cid_table->frame_size) {
+        av_log(ctx->avctx, AV_LOG_ERROR, "incorrect frame size\n");
+        return -1;
+    }
+
+    ctx->mb_width = ctx->width>>4;
+    ctx->mb_height = buf[0x16d];
+
+    if (ctx->mb_height > 68) {
+        av_log(ctx->avctx, AV_LOG_ERROR, "mb height too big\n");
+        return -1;
+    }
+
+    dprintf(ctx->avctx, "mb width %d, mb height %d\n", ctx->mb_width, ctx->mb_height);
+    for (i = 0; i < ctx->mb_height; i++) {
+        ctx->mb_scan_index[i] = AV_RB32(buf + 0x170 + (i<<2));
+        dprintf(ctx->avctx, "mb scan index %d\n", ctx->mb_scan_index[i]);
+        if (buf_size < ctx->mb_scan_index[i] + 0x280) {
+            av_log(ctx->avctx, AV_LOG_ERROR, "invalid mb scan index\n");
+            return -1;
+        }
+    }
+
+    return 0;
+}
+
+static int dnxhd_decode_dc(DNXHDContext *ctx)
+{
+    int len;
+
+    len = get_vlc2(&ctx->gb, ctx->dc_vlc.table, DNXHD_DC_VLC_BITS, 1);
+    return len ? get_xbits(&ctx->gb, len) : 0;
+}
+
+static void dnxhd_decode_dct_block(DNXHDContext *ctx, DCTELEM *block, int n, int qscale)
+{
+    int i, j, index, index2;
+    int level, component, sign;
+    const uint8_t *weigth_matrix;
+
+    if (n&2) {
+        component = 1 + (n&1);
+        weigth_matrix = ctx->chroma_weigth;
+    } else {
+        component = 0;
+        weigth_matrix = ctx->luma_weigth;
+    }
+
+    ctx->last_dc[component] += dnxhd_decode_dc(ctx);
+    block[0] = ctx->last_dc[component];
+    //av_log(ctx->avctx, AV_LOG_DEBUG, "dc %d\n", block[0]);
+    for (i = 1; ; i++) {
+        index = get_vlc2(&ctx->gb, ctx->ac_vlc.table, DNXHD_VLC_BITS, 2);
+        //av_log(ctx->avctx, AV_LOG_DEBUG, "index %d\n", index);
+        level = ctx->ac_level[index];
+        if (!level) { /* EOB */
+            //av_log(ctx->avctx, AV_LOG_DEBUG, "EOB\n");
+            return;
+        }
+        sign = get_sbits(&ctx->gb, 1);
+
+        if (ctx->ac_index_flag[index]) {
+            level += get_bits(&ctx->gb, ctx->index_bits)<<6;
+        }
+
+        if (ctx->ac_run_flag[index]) {
+            index2 = get_vlc2(&ctx->gb, ctx->run_vlc.table, DNXHD_VLC_BITS, 2);
+            i += ctx->run[index2];
+        }
+
+        j = ctx->scantable.permutated[i];
+        //av_log(ctx->avctx, AV_LOG_DEBUG, "j %d\n", j);
+        //av_log(ctx->avctx, AV_LOG_DEBUG, "level %d, weigth %d\n", level, weigth_matrix[i]);
+        level = (2*level+1) * qscale * weigth_matrix[i];
+        if (weigth_matrix[i] != 32) // FIXME 10bit
+            level += 32;
+        level >>= 6;
+        level = (level^sign) - sign;
+
+        if (i > 63) {
+            av_log(ctx->avctx, AV_LOG_ERROR, "ac tex damaged %d, %d\n", n, i);
+            return;
+        }
+
+        //av_log(NULL, AV_LOG_DEBUG, "i %d, j %d, end level %d\n", i, j, level);
+        block[j] = level;
+    }
+}
+
+static int dnxhd_decode_macroblock(DNXHDContext *ctx, int x, int y)
+{
+    int dct_linesize_luma   = ctx->picture.linesize[0];
+    int dct_linesize_chroma = ctx->picture.linesize[1];
+    uint8_t *dest_y, *dest_u, *dest_v;
+    int dct_offset;
+    int qscale, i;
+
+    ctx->dsp.clear_blocks(ctx->blocks[0]);
+    ctx->dsp.clear_blocks(ctx->blocks[2]); // FIXME change clear blocks to take block amount
+
+    qscale = get_bits(&ctx->gb, 11);
+    skip_bits1(&ctx->gb);
+    //av_log(ctx->avctx, AV_LOG_DEBUG, "qscale %d\n", qscale);
+
+    for (i = 0; i < 8; i++) {
+        dnxhd_decode_dct_block(ctx, ctx->blocks[i], i, qscale);
+    }
+    dest_y = ctx->picture.data[0] + ((y * dct_linesize_luma)   << 4) + (x << 4);
+    dest_u = ctx->picture.data[1] + ((y * dct_linesize_chroma) << 4) + (x << 3);
+    dest_v = ctx->picture.data[2] + ((y * dct_linesize_chroma) << 4) + (x << 3);
+
+    dct_offset = dct_linesize_luma << 3;
+    ctx->dsp.idct_put(dest_y,                  dct_linesize_luma, ctx->blocks[0]);
+    ctx->dsp.idct_put(dest_y + 8,              dct_linesize_luma, ctx->blocks[1]);
+    ctx->dsp.idct_put(dest_y + dct_offset,     dct_linesize_luma, ctx->blocks[4]);
+    ctx->dsp.idct_put(dest_y + dct_offset + 8, dct_linesize_luma, ctx->blocks[5]);
+
+    if (!(ctx->avctx->flags & CODEC_FLAG_GRAY)) {
+        dct_offset = dct_linesize_chroma << 3;
+        ctx->dsp.idct_put(dest_u,              dct_linesize_chroma, ctx->blocks[2]);
+        ctx->dsp.idct_put(dest_v,              dct_linesize_chroma, ctx->blocks[3]);
+        ctx->dsp.idct_put(dest_u + dct_offset, dct_linesize_chroma, ctx->blocks[6]);
+        ctx->dsp.idct_put(dest_v + dct_offset, dct_linesize_chroma, ctx->blocks[7]);
+    }
+
+    return 0;
+}
+
+static int dnxhd_decode_macroblocks(DNXHDContext *ctx, uint8_t *buf, int buf_size)
+{
+    int x, y;
+    for (y = 0; y < ctx->mb_height; y++) {
+        memset(ctx->last_dc, 4, sizeof(ctx->last_dc)); // 4 for levels +128
+        init_get_bits(&ctx->gb, buf + ctx->mb_scan_index[y], (buf_size - ctx->mb_scan_index[y]) << 3);
+        for (x = 0; x < ctx->mb_width; x++) {
+            //START_TIMER;
+            dnxhd_decode_macroblock(ctx, x, y);
+            //STOP_TIMER("decode macroblock");
+        }
+    }
+    return 0;
+}
+
+static int dnxhd_decode_frame(AVCodecContext *avctx, void *data, int *data_size,
+                              uint8_t *buf, int buf_size)
+{
+    DNXHDContext *ctx = avctx->priv_data;
+    AVFrame *picture = data;
+
+    dprintf(avctx, "frame size %d\n", buf_size);
+
+    if (dnxhd_decode_header(ctx, buf, buf_size) < 0)
+        return -1;
+
+    avctx->pix_fmt = PIX_FMT_YUV422P;
+    if (avcodec_check_dimensions(avctx, ctx->width, ctx->height))
+        return -1;
+    avcodec_set_dimensions(avctx, ctx->width, ctx->height);
+
+    if (ctx->picture.data[0])
+        avctx->release_buffer(avctx, &ctx->picture);
+    if (avctx->get_buffer(avctx, &ctx->picture) < 0) {
+        av_log(avctx, AV_LOG_ERROR, "get_buffer() failed\n");
+        return -1;
+    }
+
+    dnxhd_decode_macroblocks(ctx, buf + 0x280, buf_size - 0x280);
+
+    *picture = ctx->picture;
+    *data_size = sizeof(AVPicture);
+    return buf_size;
+}
+
+static int dnxhd_decode_close(AVCodecContext *avctx)
+{
+    DNXHDContext *ctx = avctx->priv_data;
+
+    if(ctx->picture.data[0])
+        avctx->release_buffer(avctx, &ctx->picture);
+    free_vlc(&ctx->ac_vlc);
+    free_vlc(&ctx->dc_vlc);
+    free_vlc(&ctx->run_vlc);
+    return 0;
+}
+
+AVCodec dnxhd_decoder = {
+    "dnxhd",
+    CODEC_TYPE_VIDEO,
+    CODEC_ID_DNXHD,
+    sizeof(DNXHDContext),
+    dnxhd_decode_init,
+    NULL,
+    dnxhd_decode_close,
+    dnxhd_decode_frame,
+    CODEC_CAP_DR1,
+};

Added: branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec/fraps.c
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec/fraps.c	2007-07-16 17:46:57 UTC (rev 3385)
+++ branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec/fraps.c	2007-07-16 17:53:04 UTC (rev 3386)
@@ -0,0 +1,397 @@
+/*
+ * Fraps FPS1 decoder
+ * Copyright (c) 2005 Roine Gustafsson
+ * Copyright (c) 2006 Konstantin Shishkov
+ *
+ * This file is part of FFmpeg.
+ *
+ * FFmpeg is free software; you can redistribute it and/or
+ * modify it under the terms of the GNU Lesser General Public
+ * License as published by the Free Software Foundation; either
+ * version 2.1 of the License, or (at your option) any later version.
+ *
+ * FFmpeg is distributed in the hope that it will be useful,
+ * but WITHOUT ANY WARRANTY; without even the implied warranty of
+ * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ * Lesser General Public License for more details.
+ *
+ * You should have received a copy of the GNU Lesser General Public
+ * License along with FFmpeg; if not, write to the Free Software
+ * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA
+ */
+
+/**
+ * @file fraps.c
+ * Lossless Fraps 'FPS1' decoder
+ * @author Roine Gustafsson <roine at users sf net>
+ * @author Konstantin Shishkov
+ *
+ * Codec algorithm for version 0 is taken from Transcode <www.transcoding.org>
+ *
+ * Version 2 files support by Konstantin Shishkov
+ */
+
+#include "avcodec.h"
+#include "bitstream.h"
+#include "dsputil.h"
+
+#define FPS_TAG MKTAG('F', 'P', 'S', 'x')
+
+/* symbol for Huffman tree node */
+#define HNODE -1
+
+/**
+ * Huffman node
+ * FIXME one day this should belong to one general framework
+ */
+typedef struct Node{
+    int16_t sym;
+    int16_t n0;
+    int count;
+}Node;
+
+/**
+ * local variable storage
+ */
+typedef struct FrapsContext{
+    AVCodecContext *avctx;
+    AVFrame frame;
+    Node nodes[512];
+    uint8_t *tmpbuf;
+    DSPContext dsp;
+} FrapsContext;
+
+
+/**
+ * initializes decoder
+ * @param avctx codec context
+ * @return 0 on success or negative if fails
+ */
+static int decode_init(AVCodecContext *avctx)
+{
+    FrapsContext * const s = avctx->priv_data;
+
+    avctx->coded_frame = (AVFrame*)&s->frame;
+    avctx->pix_fmt= PIX_FMT_NONE; /* set in decode_frame */
+
+    s->avctx = avctx;
+    s->frame.data[0] = NULL;
+    s->tmpbuf = NULL;
+
+    dsputil_init(&s->dsp, avctx);
+
+    return 0;
+}
+
+/**
+ * Comparator - our nodes should ascend by count
+ * but with preserved symbol order
+ */
+static int huff_cmp(const void *va, const void *vb){
+    const Node *a = va, *b = vb;
+    return (a->count - b->count)*256 + a->sym - b->sym;
+}
+
+static void get_tree_codes(uint32_t *bits, int16_t *lens, uint8_t *xlat, Node *nodes, int node, uint32_t pfx, int pl, int *pos)
+{
+    int s;
+
+    s = nodes[node].sym;
+    if(s != HNODE || !nodes[node].count){
+        bits[*pos] = pfx;
+        lens[*pos] = pl;
+        xlat[*pos] = s;
+        (*pos)++;
+    }else{
+        pfx <<= 1;
+        pl++;
+        get_tree_codes(bits, lens, xlat, nodes, nodes[node].n0, pfx, pl, pos);
+        pfx |= 1;
+        get_tree_codes(bits, lens, xlat, nodes, nodes[node].n0+1, pfx, pl, pos);
+    }
+}
+
+static int build_huff_tree(VLC *vlc, Node *nodes, uint8_t *xlat)
+{
+    uint32_t bits[256];
+    int16_t lens[256];
+    int pos = 0;
+
+    get_tree_codes(bits, lens, xlat, nodes, 510, 0, 0, &pos);
+    return init_vlc(vlc, 9, pos, lens, 2, 2, bits, 4, 4, 0);
+}
+
+
+/**
+ * decode Fraps v2 packed plane
+ */
+static int fraps2_decode_plane(FrapsContext *s, uint8_t *dst, int stride, int w,
+                               int h, uint8_t *src, int size, int Uoff)
+{
+    int i, j;
+    int cur_node;
+    GetBitContext gb;
+    VLC vlc;
+    int64_t sum = 0;
+    uint8_t recode[256];
+
+    for(i = 0; i < 256; i++){
+        s->nodes[i].sym = i;
+        s->nodes[i].count = AV_RL32(src);
+        s->nodes[i].n0 = -2;
+        if(s->nodes[i].count < 0) {
+            av_log(s->avctx, AV_LOG_ERROR, "Symbol count < 0\n");
+            return -1;
+        }
+        src += 4;
+        sum += s->nodes[i].count;
+    }
+    size -= 1024;
+
+    if(sum >> 31) {
+        av_log(s->avctx, AV_LOG_ERROR, "Too high symbol frequencies. Tree construction is not possible\n");
+        return -1;
+    }
+    qsort(s->nodes, 256, sizeof(Node), huff_cmp);
+    cur_node = 256;
+    for(i = 0; i < 511; i += 2){
+        s->nodes[cur_node].sym = HNODE;
+        s->nodes[cur_node].count = s->nodes[i].count + s->nodes[i+1].count;
+        s->nodes[cur_node].n0 = i;
+        for(j = cur_node; j > 0; j--){
+            if(s->nodes[j].count >= s->nodes[j - 1].count) break;
+            FFSWAP(Node, s->nodes[j], s->nodes[j - 1]);
+        }
+        cur_node++;
+    }
+    if(build_huff_tree(&vlc, s->nodes, recode) < 0){
+        av_log(s->avctx, AV_LOG_ERROR, "Error building tree\n");
+        return -1;
+    }
+    /* we have built Huffman table and are ready to decode plane */
+
+    /* convert bits so they may be used by standard bitreader */
+    s->dsp.bswap_buf(s->tmpbuf, src, size >> 2);
+
+    init_get_bits(&gb, s->tmpbuf, size * 8);
+    for(j = 0; j < h; j++){
+        for(i = 0; i < w; i++){
+            dst[i] = recode[get_vlc2(&gb, vlc.table, 9, 3)];
+            /* lines are stored as deltas between previous lines
+             * and we need to add 0x80 to the first lines of chroma planes
+             */
+            if(j) dst[i] += dst[i - stride];
+            else if(Uoff) dst[i] += 0x80;
+        }
+        dst += stride;
+    }
+    free_vlc(&vlc);
+    return 0;
+}
+
+/**
+ * decode a frame
+ * @param avctx codec context
+ * @param data output AVFrame
+ * @param data_size size of output data or 0 if no picture is returned
+ * @param buf input data frame
+ * @param buf_size size of input data frame
+ * @return number of consumed bytes on success or negative if decode fails
+ */
+static int decode_frame(AVCodecContext *avctx,
+                        void *data, int *data_size,
+                        uint8_t *buf, int buf_size)
+{
+    FrapsContext * const s = avctx->priv_data;
+    AVFrame *frame = data;
+    AVFrame * const f = (AVFrame*)&s->frame;
+    uint32_t header;
+    unsigned int version,header_size;
+    unsigned int x, y;
+    uint32_t *buf32;
+    uint32_t *luma1,*luma2,*cb,*cr;
+    uint32_t offs[4];
+    int i, is_chroma, planes;
+
+
+    header = AV_RL32(buf);
+    version = header & 0xff;
+    header_size = (header & (1<<30))? 8 : 4; /* bit 30 means pad to 8 bytes */
+
+    if (version > 2 && version != 4) {
+        av_log(avctx, AV_LOG_ERROR,
+               "This file is encoded with Fraps version %d. " \
+               "This codec can only decode version 0, 1, 2 and 4.\n", version);
+        return -1;
+    }
+
+    buf+=4;
+    if (header_size == 8)
+        buf+=4;
+
+    switch(version) {
+    case 0:
+    default:
+        /* Fraps v0 is a reordered YUV420 */
+        avctx->pix_fmt = PIX_FMT_YUV420P;
+
+        if ( (buf_size != avctx->width*avctx->height*3/2+header_size) &&
+             (buf_size != header_size) ) {
+            av_log(avctx, AV_LOG_ERROR,
+                   "Invalid frame length %d (should be %d)\n",
+                   buf_size, avctx->width*avctx->height*3/2+header_size);
+            return -1;
+        }
+
+        if (( (avctx->width % 8) != 0) || ( (avctx->height % 2) != 0 )) {
+            av_log(avctx, AV_LOG_ERROR, "Invalid frame size %dx%d\n",
+                   avctx->width, avctx->height);
+            return -1;
+        }
+
+        f->reference = 1;
+        f->buffer_hints = FF_BUFFER_HINTS_VALID |
+                          FF_BUFFER_HINTS_PRESERVE |
+                          FF_BUFFER_HINTS_REUSABLE;
+        if (avctx->reget_buffer(avctx, f)) {
+            av_log(avctx, AV_LOG_ERROR, "reget_buffer() failed\n");
+            return -1;
+        }
+        /* bit 31 means same as previous pic */
+        f->pict_type = (header & (1<<31))? FF_P_TYPE : FF_I_TYPE;
+        f->key_frame = f->pict_type == FF_I_TYPE;
+
+        if (f->pict_type == FF_I_TYPE) {
+            buf32=(uint32_t*)buf;
+            for(y=0; y<avctx->height/2; y++){
+                luma1=(uint32_t*)&f->data[0][ y*2*f->linesize[0] ];
+                luma2=(uint32_t*)&f->data[0][ (y*2+1)*f->linesize[0] ];
+                cr=(uint32_t*)&f->data[1][ y*f->linesize[1] ];
+                cb=(uint32_t*)&f->data[2][ y*f->linesize[2] ];
+                for(x=0; x<avctx->width; x+=8){
+                    *(luma1++) = *(buf32++);
+                    *(luma1++) = *(buf32++);
+                    *(luma2++) = *(buf32++);
+                    *(luma2++) = *(buf32++);
+                    *(cr++) = *(buf32++);
+                    *(cb++) = *(buf32++);
+                }
+            }
+        }
+        break;
+
+    case 1:
+        /* Fraps v1 is an upside-down BGR24 */
+        avctx->pix_fmt = PIX_FMT_BGR24;
+
+        if ( (buf_size != avctx->width*avctx->height*3+header_size) &&
+             (buf_size != header_size) ) {
+            av_log(avctx, AV_LOG_ERROR,
+                   "Invalid frame length %d (should be %d)\n",
+                   buf_size, avctx->width*avctx->height*3+header_size);
+            return -1;
+        }
+
+        f->reference = 1;
+        f->buffer_hints = FF_BUFFER_HINTS_VALID |
+                          FF_BUFFER_HINTS_PRESERVE |
+                          FF_BUFFER_HINTS_REUSABLE;
+        if (avctx->reget_buffer(avctx, f)) {
+            av_log(avctx, AV_LOG_ERROR, "reget_buffer() failed\n");
+            return -1;
+        }
+        /* bit 31 means same as previous pic */
+        f->pict_type = (header & (1<<31))? FF_P_TYPE : FF_I_TYPE;
+        f->key_frame = f->pict_type == FF_I_TYPE;
+
+        if (f->pict_type == FF_I_TYPE) {
+            for(y=0; y<avctx->height; y++)
+                memcpy(&f->data[0][ (avctx->height-y)*f->linesize[0] ],
+                       &buf[y*avctx->width*3],
+                       f->linesize[0]);
+        }
+        break;
+
+    case 2:
+    case 4:
+        /**
+         * Fraps v2 is Huffman-coded YUV420 planes
+         * Fraps v4 is virtually the same
+         */
+        avctx->pix_fmt = PIX_FMT_YUV420P;
+        planes = 3;
+        f->reference = 1;
+        f->buffer_hints = FF_BUFFER_HINTS_VALID |
+                          FF_BUFFER_HINTS_PRESERVE |
+                          FF_BUFFER_HINTS_REUSABLE;
+        if (avctx->reget_buffer(avctx, f)) {
+            av_log(avctx, AV_LOG_ERROR, "reget_buffer() failed\n");
+            return -1;
+        }
+        /* skip frame */
+        if(buf_size == 8) {
+            f->pict_type = FF_P_TYPE;
+            f->key_frame = 0;
+            break;
+        }
+        f->pict_type = FF_I_TYPE;
+        f->key_frame = 1;
+        if ((AV_RL32(buf) != FPS_TAG)||(buf_size < (planes*1024 + 24))) {
+            av_log(avctx, AV_LOG_ERROR, "Fraps: error in data stream\n");
+            return -1;
+        }
+        for(i = 0; i < planes; i++) {
+            offs[i] = AV_RL32(buf + 4 + i * 4);
+            if(offs[i] >= buf_size || (i && offs[i] <= offs[i - 1] + 1024)) {
+                av_log(avctx, AV_LOG_ERROR, "Fraps: plane %i offset is out of bounds\n", i);
+                return -1;
+            }
+        }
+        offs[planes] = buf_size;
+        for(i = 0; i < planes; i++){
+            is_chroma = !!i;
+            s->tmpbuf = av_realloc(s->tmpbuf, offs[i + 1] - offs[i] - 1024 + FF_INPUT_BUFFER_PADDING_SIZE);
+            if(fraps2_decode_plane(s, f->data[i], f->linesize[i], avctx->width >> is_chroma,
+                    avctx->height >> is_chroma, buf + offs[i], offs[i + 1] - offs[i], is_chroma) < 0) {
+                av_log(avctx, AV_LOG_ERROR, "Error decoding plane %i\n", i);
+                return -1;
+            }
+        }
+        break;
+    }
+
+    *frame = *f;
+    *data_size = sizeof(AVFrame);
+
+    return buf_size;
+}
+
+
+/**
+ * closes decoder
+ * @param avctx codec context
+ * @return 0 on success or negative if fails
+ */
+static int decode_end(AVCodecContext *avctx)
+{
+    FrapsContext *s = (FrapsContext*)avctx->priv_data;
+
+    if (s->frame.data[0])
+        avctx->release_buffer(avctx, &s->frame);
+
+    av_freep(&s->tmpbuf);
+    return 0;
+}
+
+
+AVCodec fraps_decoder = {
+    "fraps",
+    CODEC_TYPE_VIDEO,
+    CODEC_ID_FRAPS,
+    sizeof(FrapsContext),
+    decode_init,
+    NULL,
+    decode_end,
+    decode_frame,
+    CODEC_CAP_DR1,
+};

Added: branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavutil/string.c
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavutil/string.c	2007-07-16 17:46:57 UTC (rev 3385)
+++ branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavutil/string.c	2007-07-16 17:53:04 UTC (rev 3386)
@@ -0,0 +1,64 @@
+/*
+ * Copyright (c) 2000, 2001, 2002 Fabrice Bellard
+ * Copyright (c) 2007 Mans Rullgard
+ *
+ * This file is part of FFmpeg.
+ *
+ * FFmpeg is free software; you can redistribute it and/or
+ * modify it under the terms of the GNU Lesser General Public
+ * License as published by the Free Software Foundation; either
+ * version 2.1 of the License, or (at your option) any later version.
+ *
+ * FFmpeg is distributed in the hope that it will be useful,
+ * but WITHOUT ANY WARRANTY; without even the implied warranty of
+ * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ * Lesser General Public License for more details.
+ *
+ * You should have received a copy of the GNU Lesser General Public
+ * License along with FFmpeg; if not, write to the Free Software
+ * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA
+ */
+
+#include <string.h>
+#include <ctype.h>
+#include "avstring.h"
+
+int av_strstart(const char *str, const char *pfx, const char **ptr)
+{
+    while (*pfx && *pfx == *str) {
+        pfx++;
+        str++;
+    }
+    if (!*pfx && ptr)
+        *ptr = str;
+    return !*pfx;
+}
+
+int av_stristart(const char *str, const char *pfx, const char **ptr)
+{
+    while (*pfx && toupper((unsigned)*pfx) == toupper((unsigned)*str)) {
+        pfx++;
+        str++;
+    }
+    if (!*pfx && ptr)
+        *ptr = str;
+    return !*pfx;
+}
+
+size_t av_strlcpy(char *dst, const char *src, size_t size)
+{
+    size_t len = 0;
+    while (++len < size && *src)
+        *dst++ = *src++;
+    if (len <= size)
+        *dst = 0;
+    return len + strlen(src) - 1;
+}
+
+size_t av_strlcat(char *dst, const char *src, size_t size)
+{
+    size_t len = strlen(dst);
+    if (size <= len + 1)
+        return len + strlen(src);
+    return len + av_strlcpy(dst + len, src, size - len);
+}



From mean at mail.berlios.de  Mon Jul 16 19:59:25 2007
From: mean at mail.berlios.de (mean at BerliOS)
Date: Mon, 16 Jul 2007 19:59:25 +0200
Subject: [Avidemux-svn-commit] r3387 -
	branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavutil
Message-ID: <200707161759.l6GHxPPM009370@sheep.berlios.de>

Author: mean
Date: 2007-07-16 19:59:25 +0200 (Mon, 16 Jul 2007)
New Revision: 3387

Added:
   branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavutil/mem.h
Log:
missing files

Added: branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavutil/mem.h
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavutil/mem.h	2007-07-16 17:53:04 UTC (rev 3386)
+++ branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavutil/mem.h	2007-07-16 17:59:25 UTC (rev 3387)
@@ -0,0 +1,65 @@
+/*
+ * copyright (c) 2006 Michael Niedermayer <michaelni at gmx.at>
+ *
+ * This file is part of FFmpeg.
+ *
+ * FFmpeg is free software; you can redistribute it and/or
+ * modify it under the terms of the GNU Lesser General Public
+ * License as published by the Free Software Foundation; either
+ * version 2.1 of the License, or (at your option) any later version.
+ *
+ * FFmpeg is distributed in the hope that it will be useful,
+ * but WITHOUT ANY WARRANTY; without even the implied warranty of
+ * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ * Lesser General Public License for more details.
+ *
+ * You should have received a copy of the GNU Lesser General Public
+ * License along with FFmpeg; if not, write to the Free Software
+ * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA
+ */
+
+/**
+ * @file mem.h
+ * Memory handling functions.
+ */
+
+#ifndef AV_MEM_H
+#define AV_MEM_H
+
+#ifdef __GNUC__
+  #define DECLARE_ALIGNED(n,t,v)       t v __attribute__ ((aligned (n)))
+#else
+  #define DECLARE_ALIGNED(n,t,v)      __declspec(align(n)) t v
+#endif
+
+/**
+ * Memory allocation of size byte with alignment suitable for all
+ * memory accesses (including vectors if available on the
+ * CPU). av_malloc(0) must return a non NULL pointer.
+ */
+void *av_malloc(unsigned int size);
+
+/**
+ * av_realloc semantics (same as glibc): if ptr is NULL and size > 0,
+ * identical to malloc(size). If size is zero, it is identical to
+ * free(ptr) and NULL is returned.
+ */
+void *av_realloc(void *ptr, unsigned int size);
+
+/**
+ * Free memory which has been allocated with av_malloc(z)() or av_realloc().
+ * NOTE: ptr = NULL is explicetly allowed
+ * Note2: it is recommended that you use av_freep() instead
+ */
+void av_free(void *ptr);
+
+void *av_mallocz(unsigned int size);
+char *av_strdup(const char *s);
+
+/**
+ * Frees memory and sets the pointer to NULL.
+ * @param ptr pointer to the pointer which should be freed
+ */
+void av_freep(void *ptr);
+
+#endif /* AV_MEM_H */



From mean at mail.berlios.de  Mon Jul 16 20:00:26 2007
From: mean at mail.berlios.de (mean at BerliOS)
Date: Mon, 16 Jul 2007 20:00:26 +0200
Subject: [Avidemux-svn-commit] r3388 - in
	branches/avidemux_2.4_branch/avidemux: ADM_audio ADM_codecs
	ADM_osSupport ADM_userInterfaces/ADM_GTK/ADM_gui2
	ADM_userInterfaces/ADM_commonUI
Message-ID: <200707161800.l6GI0Qgl009527@sheep.berlios.de>

Author: mean
Date: 2007-07-16 20:00:25 +0200 (Mon, 16 Jul 2007)
New Revision: 3388

Modified:
   branches/avidemux_2.4_branch/avidemux/ADM_audio/ADM_dcainfo.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_codecs/ADM_ffmpeg.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_osSupport/ADM_cpuCap.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_osSupport/ADM_memcpy.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_audioFilter.cpp
Log:
compatible with lav new revision

Modified: branches/avidemux_2.4_branch/avidemux/ADM_audio/ADM_dcainfo.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_audio/ADM_dcainfo.cpp	2007-07-16 17:59:25 UTC (rev 3387)
+++ branches/avidemux_2.4_branch/avidemux/ADM_audio/ADM_dcainfo.cpp	2007-07-16 18:00:25 UTC (rev 3388)
@@ -14,7 +14,6 @@
 #include <stdio.h>
 #include "default.h"
 #include "ADM_audio/ADM_dcainfo.h"
-#include "ADM_assert.h"
 extern "C"
 {
 #include "ADM_lavutil/common.h"
@@ -22,6 +21,7 @@
 #include "ADM_lavcodec/bitstream.h"
 
 }
+#include "ADM_assert.h"
 
 /*
         Borrowed from libdca

Modified: branches/avidemux_2.4_branch/avidemux/ADM_codecs/ADM_ffmpeg.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_codecs/ADM_ffmpeg.cpp	2007-07-16 17:59:25 UTC (rev 3387)
+++ branches/avidemux_2.4_branch/avidemux/ADM_codecs/ADM_ffmpeg.cpp	2007-07-16 18:00:25 UTC (rev 3388)
@@ -22,6 +22,8 @@
 #include "config.h"
 #include <stdio.h>
 #include <stdlib.h>
+#define __STDC_CONSTANT_MACROS // Lavcodec crap
+#include <stdint.h>
 
 #include <string.h>
 #include <math.h>

Modified: branches/avidemux_2.4_branch/avidemux/ADM_osSupport/ADM_cpuCap.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_osSupport/ADM_cpuCap.cpp	2007-07-16 17:59:25 UTC (rev 3387)
+++ branches/avidemux_2.4_branch/avidemux/ADM_osSupport/ADM_cpuCap.cpp	2007-07-16 18:00:25 UTC (rev 3388)
@@ -17,7 +17,7 @@
 #if defined( ARCH_X86)  || defined(ARCH_X86_64)
 extern "C" 
 {
-#include "ADM_lavcodec/dsputil.h"
+#include "ADM_lavcodec/dsputil_cpu.h"
 }
 #endif
 
@@ -48,4 +48,5 @@
                 return  0;
         if(multi<2) multi=0; // On thread means no threading...
         return multi;
-}
\ No newline at end of file
+}
+

Modified: branches/avidemux_2.4_branch/avidemux/ADM_osSupport/ADM_memcpy.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_osSupport/ADM_memcpy.cpp	2007-07-16 17:59:25 UTC (rev 3387)
+++ branches/avidemux_2.4_branch/avidemux/ADM_osSupport/ADM_memcpy.cpp	2007-07-16 18:00:25 UTC (rev 3388)
@@ -45,7 +45,7 @@
 #include "ADM_osSupport/ADM_cpuCap.h"
 extern "C"
 {
-        #include "ADM_lavcodec/dsputil.h"
+        #include "ADM_lavcodec/dsputil_cpu.h"
 
 
 

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp	2007-07-16 17:59:25 UTC (rev 3387)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp	2007-07-16 18:00:25 UTC (rev 3388)
@@ -1150,7 +1150,7 @@
   gtk_box_pack_start (GTK_BOX (hbox19), CheckButtonTimeshift, FALSE, FALSE, 0);
   gtk_tooltips_set_tip (tooltips, CheckButtonTimeshift, _("Enable time shift"), NULL);
 
-  spinbuttonTimeShift_adj = gtk_adjustment_new (0, -9999, 9999, 1, 10, 10);
+  spinbuttonTimeShift_adj = gtk_adjustment_new (0, -99999, 99999, 1, 10, 10);
   spinbuttonTimeShift = gtk_spin_button_new (GTK_ADJUSTMENT (spinbuttonTimeShift_adj), 1, 0);
   gtk_widget_show (spinbuttonTimeShift);
   gtk_box_pack_start (GTK_BOX (hbox19), spinbuttonTimeShift, TRUE, TRUE, 0);

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_audioFilter.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_audioFilter.cpp	2007-07-16 17:59:25 UTC (rev 3387)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_audioFilter.cpp	2007-07-16 18:00:25 UTC (rev 3388)
@@ -61,7 +61,7 @@
        
    diaElemToggle    eDRC(&vDRC,_("_Dynamic range compression"));
    
-   diaElemToggleInt eTimeShift(&vTshift,_("_Time shift (ms):"),&vTshiftValue,_("Time shift value (ms)"),-10000,10000);
+   diaElemToggleInt eTimeShift(&vTshift,_("_Time shift (ms):"),&vTshiftValue,_("Time shift value (ms)"),-1000*100,1000*100);
    
 //    diaElemToggle    eTimeShift(&vTshift,_("Enable _time shift"));
 //    diaElemInteger  eShift(&vTshiftValue,_("Time shift _value (ms):"),-10000,10000);



From mean at mail.berlios.de  Mon Jul 16 20:08:15 2007
From: mean at mail.berlios.de (mean at BerliOS)
Date: Mon, 16 Jul 2007 20:08:15 +0200
Subject: [Avidemux-svn-commit] r3389 - in
	branches/avidemux_2.4_branch/avidemux/ADM_libraries:
	ADM_lavcodec ADM_lavutil
Message-ID: <200707161808.l6GI8FxJ010073@sheep.berlios.de>

Author: mean
Date: 2007-07-16 20:08:14 +0200 (Mon, 16 Jul 2007)
New Revision: 3389

Added:
   branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec/dsputil_cpu.h
   branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec/rl.h
   branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavutil/avstring.h
Log:
missing files

Added: branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec/dsputil_cpu.h
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec/dsputil_cpu.h	2007-07-16 18:00:25 UTC (rev 3388)
+++ branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec/dsputil_cpu.h	2007-07-16 18:08:14 UTC (rev 3389)
@@ -0,0 +1,46 @@
+/*
+ * DSP utils
+ * Copyright (c) 2000, 2001, 2002 Fabrice Bellard.
+ * Copyright (c) 2002-2004 Michael Niedermayer <michaelni at gmx.at>
+ *
+ * This file is part of FFmpeg.
+ *
+ * FFmpeg is free software; you can redistribute it and/or
+ * modify it under the terms of the GNU Lesser General Public
+ * License as published by the Free Software Foundation; either
+ * version 2.1 of the License, or (at your option) any later version.
+ *
+ * FFmpeg is distributed in the hope that it will be useful,
+ * but WITHOUT ANY WARRANTY; without even the implied warranty of
+ * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ * Lesser General Public License for more details.
+ *
+ * You should have received a copy of the GNU Lesser General Public
+ * License along with FFmpeg; if not, write to the Free Software
+ * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA
+ */
+
+/**
+ * @file dsputil.h
+ * DSP utils.
+ * note, many functions in here may use MMX which trashes the FPU state, it is
+ * absolutely necessary to call emms_c() between dsp & float/double code
+ */
+
+#ifndef DSPUTIL_CPU_H
+#define DSPUTIL_CPU_H
+
+int mm_support(void);
+
+#define MM_MMX    0x0001 /* standard MMX */
+#define MM_3DNOW  0x0004 /* AMD 3DNOW */
+#define MM_MMXEXT 0x0002 /* SSE integer functions or AMD MMX ext */
+#define MM_SSE    0x0008 /* SSE functions */
+#define MM_SSE2   0x0010 /* PIV SSE2 functions */
+#define MM_3DNOWEXT  0x0020 /* AMD 3DNowExt */
+#define MM_SSE3   0x0040 /* Prescott SSE3 functions */
+#define MM_SSSE3  0x0080 /* Conroe SSSE3 functions */
+
+extern int mm_flags;
+
+#endif

Added: branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec/rl.h
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec/rl.h	2007-07-16 18:00:25 UTC (rev 3388)
+++ branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec/rl.h	2007-07-16 18:08:14 UTC (rev 3389)
@@ -0,0 +1,67 @@
+/*
+ * Copyright (c) 2000-2002 Fabrice Bellard
+ * Copyright (c) 2002-2004 Michael Niedermayer
+ *
+ * This file is part of FFmpeg.
+ *
+ * FFmpeg is free software; you can redistribute it and/or
+ * modify it under the terms of the GNU Lesser General Public
+ * License as published by the Free Software Foundation; either
+ * version 2.1 of the License, or (at your option) any later version.
+ *
+ * FFmpeg is distributed in the hope that it will be useful,
+ * but WITHOUT ANY WARRANTY; without even the implied warranty of
+ * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ * Lesser General Public License for more details.
+ *
+ * You should have received a copy of the GNU Lesser General Public
+ * License along with FFmpeg; if not, write to the Free Software
+ * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA
+ */
+
+/**
+ * @file rl.h
+ * rl header.
+ */
+
+#ifndef AVCODEC_RL_H
+#define AVCODEC_RL_H
+
+#include <stdint.h>
+#include "bitstream.h"
+#include "mpegvideo.h"
+
+/** RLTable. */
+typedef struct RLTable {
+    int n;                         ///< number of entries of table_vlc minus 1
+    int last;                      ///< number of values for last = 0
+    const uint16_t (*table_vlc)[2];
+    const int8_t *table_run;
+    const int8_t *table_level;
+    uint8_t *index_run[2];         ///< encoding only
+    int8_t *max_level[2];          ///< encoding & decoding
+    int8_t *max_run[2];            ///< encoding & decoding
+    VLC vlc;                       ///< decoding only deprecated FIXME remove
+    RL_VLC_ELEM *rl_vlc[32];       ///< decoding only
+} RLTable;
+
+/**
+ *
+ * @param static_store static uint8_t array[2][2*MAX_RUN + MAX_LEVEL + 3] which will hold
+ *                     the level and run tables, if this is NULL av_malloc() will be used
+ */
+void init_rl(RLTable *rl, uint8_t static_store[2][2*MAX_RUN + MAX_LEVEL + 3]);
+void init_vlc_rl(RLTable *rl, int use_static);
+
+static inline int get_rl_index(const RLTable *rl, int last, int run, int level)
+{
+    int index;
+    index = rl->index_run[last][run];
+    if (index >= rl->n)
+        return rl->n;
+    if (level > rl->max_level[last][run])
+        return rl->n;
+    return index + level - 1;
+}
+
+#endif

Added: branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavutil/avstring.h
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavutil/avstring.h	2007-07-16 18:00:25 UTC (rev 3388)
+++ branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavutil/avstring.h	2007-07-16 18:08:14 UTC (rev 3389)
@@ -0,0 +1,76 @@
+/*
+ * Copyright (c) 2007 Mans Rullgard
+ *
+ * This file is part of FFmpeg.
+ *
+ * FFmpeg is free software; you can redistribute it and/or
+ * modify it under the terms of the GNU Lesser General Public
+ * License as published by the Free Software Foundation; either
+ * version 2.1 of the License, or (at your option) any later version.
+ *
+ * FFmpeg is distributed in the hope that it will be useful,
+ * but WITHOUT ANY WARRANTY; without even the implied warranty of
+ * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ * Lesser General Public License for more details.
+ *
+ * You should have received a copy of the GNU Lesser General Public
+ * License along with FFmpeg; if not, write to the Free Software
+ * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA
+ */
+
+#ifndef AVUTIL_STRING_H
+#define AVUTIL_STRING_H
+
+#include <stddef.h>
+
+/**
+ * Return non-zero if pfx is a prefix of str. If it is, *ptr is set to
+ * the address of the first character in str after the prefix.
+ *
+ * @param str input string
+ * @param pfx prefix to test
+ * @param ptr updated after the prefix in str in there is a match
+ * @return non-zero if the prefix matches, zero otherwise
+ */
+int av_strstart(const char *str, const char *pfx, const char **ptr);
+
+/**
+ * Return non-zero if pfx is a prefix of str independent of case. If
+ * it is, *ptr is set to the address of the first character in str
+ * after the prefix.
+ *
+ * @param str input string
+ * @param pfx prefix to test
+ * @param ptr updated after the prefix in str in there is a match
+ * @return non-zero if the prefix matches, zero otherwise
+ */
+int av_stristart(const char *str, const char *pfx, const char **ptr);
+
+/**
+ * Copy the string src to dst, but no more than size - 1 bytes, and
+ * null terminate dst.
+ *
+ * This function is the same as BSD strlcpy().
+ *
+ * @param dst destination buffer
+ * @param src source string
+ * @param size size of destination buffer
+ * @return the length of src
+ */
+size_t av_strlcpy(char *dst, const char *src, size_t size);
+
+/**
+ * Append the string src to the string dst, but to a total length of
+ * no more than size - 1 bytes, and null terminate dst.
+ *
+ * This function is similar to BSD strlcat(), but differs when
+ * size <= strlen(dst).
+ *
+ * @param dst destination buffer
+ * @param src source string
+ * @param size size of destination buffer
+ * @return the total length of src and dst
+ */
+size_t av_strlcat(char *dst, const char *src, size_t size);
+
+#endif /* AVUTIL_STRING_H */



From mean at mail.berlios.de  Mon Jul 16 20:11:39 2007
From: mean at mail.berlios.de (mean at BerliOS)
Date: Mon, 16 Jul 2007 20:11:39 +0200
Subject: [Avidemux-svn-commit] r3390 -
	branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec
Message-ID: <200707161811.l6GIBdvJ010366@sheep.berlios.de>

Author: mean
Date: 2007-07-16 20:11:38 +0200 (Mon, 16 Jul 2007)
New Revision: 3390

Added:
   branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec/allcodecs.h
   branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec/h261.h
   branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec/h263.h
   branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec/h263_parser.h
   branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec/h264.h
   branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec/h264_parser.h
   branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec/mjpeg.h
   branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec/mjpegdec.h
   branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec/mpeg4video_parser.h
   branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec/mpegvideo_common.h
   branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec/msmpeg4.h
   branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec/roqvideo.h
   branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec/vc1.h
   branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec/wma.h
Log:
missing files

Added: branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec/allcodecs.h
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec/allcodecs.h	2007-07-16 18:08:14 UTC (rev 3389)
+++ branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec/allcodecs.h	2007-07-16 18:11:38 UTC (rev 3390)
@@ -0,0 +1,288 @@
+/*
+ * copyright (c) 2001 Fabrice Bellard
+ *
+ * This file is part of FFmpeg.
+ *
+ * FFmpeg is free software; you can redistribute it and/or
+ * modify it under the terms of the GNU Lesser General Public
+ * License as published by the Free Software Foundation; either
+ * version 2.1 of the License, or (at your option) any later version.
+ *
+ * FFmpeg is distributed in the hope that it will be useful,
+ * but WITHOUT ANY WARRANTY; without even the implied warranty of
+ * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ * Lesser General Public License for more details.
+ *
+ * You should have received a copy of the GNU Lesser General Public
+ * License along with FFmpeg; if not, write to the Free Software
+ * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA
+ */
+
+#ifndef ALLCODECS_H
+#define ALLCODECS_H
+
+#include "avcodec.h"
+
+extern AVCodec ac3_encoder;
+extern AVCodec asv1_encoder;
+extern AVCodec asv2_encoder;
+extern AVCodec bmp_encoder;
+extern AVCodec dvvideo_encoder;
+extern AVCodec ffv1_encoder;
+extern AVCodec ffvhuff_encoder;
+extern AVCodec flac_encoder;
+extern AVCodec flashsv_encoder;
+extern AVCodec flv_encoder;
+extern AVCodec gif_encoder;
+extern AVCodec h261_encoder;
+extern AVCodec h263_encoder;
+extern AVCodec h263p_encoder;
+extern AVCodec h264_encoder;
+extern AVCodec huffyuv_encoder;
+extern AVCodec jpegls_encoder;
+extern AVCodec ljpeg_encoder;
+extern AVCodec mdec_encoder;
+extern AVCodec mjpeg_encoder;
+extern AVCodec mp2_encoder;
+extern AVCodec mpeg1video_encoder;
+extern AVCodec mpeg2video_encoder;
+extern AVCodec mpeg4_encoder;
+extern AVCodec msmpeg4v1_encoder;
+extern AVCodec msmpeg4v2_encoder;
+extern AVCodec msmpeg4v3_encoder;
+extern AVCodec pam_encoder;
+extern AVCodec pbm_encoder;
+extern AVCodec pgm_encoder;
+extern AVCodec pgmyuv_encoder;
+extern AVCodec png_encoder;
+extern AVCodec ppm_encoder;
+extern AVCodec qtrle_encoder;
+extern AVCodec roq_dpcm_encoder;
+extern AVCodec roq_encoder;
+extern AVCodec rv10_encoder;
+extern AVCodec rv20_encoder;
+extern AVCodec sgi_encoder;
+extern AVCodec snow_encoder;
+extern AVCodec sonic_encoder;
+extern AVCodec sonic_ls_encoder;
+extern AVCodec svq1_encoder;
+extern AVCodec targa_encoder;
+extern AVCodec tiff_encoder;
+extern AVCodec vcr1_encoder;
+extern AVCodec vorbis_encoder;
+extern AVCodec wmav1_encoder;
+extern AVCodec wmav2_encoder;
+extern AVCodec wmv1_encoder;
+extern AVCodec wmv2_encoder;
+extern AVCodec zmbv_encoder;
+
+extern AVCodec aasc_decoder;
+extern AVCodec alac_decoder;
+extern AVCodec asv1_decoder;
+extern AVCodec asv2_decoder;
+extern AVCodec atrac3_decoder;
+extern AVCodec avs_decoder;
+extern AVCodec bethsoftvid_decoder;
+extern AVCodec bmp_decoder;
+extern AVCodec c93_decoder;
+extern AVCodec cavs_decoder;
+extern AVCodec cinepak_decoder;
+extern AVCodec cljr_decoder;
+extern AVCodec cook_decoder;
+extern AVCodec cscd_decoder;
+extern AVCodec cyuv_decoder;
+extern AVCodec dca_decoder;
+extern AVCodec dnxhd_decoder;
+extern AVCodec dsicinaudio_decoder;
+extern AVCodec dsicinvideo_decoder;
+extern AVCodec dvvideo_decoder;
+extern AVCodec dxa_decoder;
+extern AVCodec eightbps_decoder;
+extern AVCodec ffv1_decoder;
+extern AVCodec ffvhuff_decoder;
+extern AVCodec flac_decoder;
+extern AVCodec flashsv_decoder;
+extern AVCodec flic_decoder;
+extern AVCodec flv_decoder;
+extern AVCodec fourxm_decoder;
+extern AVCodec fraps_decoder;
+extern AVCodec gif_decoder;
+extern AVCodec h261_decoder;
+extern AVCodec h263_decoder;
+extern AVCodec h263i_decoder;
+extern AVCodec h264_decoder;
+extern AVCodec huffyuv_decoder;
+extern AVCodec idcin_decoder;
+extern AVCodec imc_decoder;
+extern AVCodec indeo2_decoder;
+extern AVCodec indeo3_decoder;
+extern AVCodec interplay_dpcm_decoder;
+extern AVCodec interplay_video_decoder;
+extern AVCodec jpegls_decoder;
+extern AVCodec kmvc_decoder;
+extern AVCodec loco_decoder;
+extern AVCodec mace3_decoder;
+extern AVCodec mace6_decoder;
+extern AVCodec mdec_decoder;
+extern AVCodec mjpeg_decoder;
+extern AVCodec mjpegb_decoder;
+extern AVCodec mmvideo_decoder;
+extern AVCodec mp2_decoder;
+extern AVCodec mp3_decoder;
+extern AVCodec mp3adu_decoder;
+extern AVCodec mp3on4_decoder;
+extern AVCodec mpc7_decoder;
+extern AVCodec mpeg1video_decoder;
+extern AVCodec mpeg2video_decoder;
+extern AVCodec mpeg4_decoder;
+extern AVCodec mpeg_xvmc_decoder;
+extern AVCodec mpegvideo_decoder;
+extern AVCodec msmpeg4v1_decoder;
+extern AVCodec msmpeg4v2_decoder;
+extern AVCodec msmpeg4v3_decoder;
+extern AVCodec msrle_decoder;
+extern AVCodec msvideo1_decoder;
+extern AVCodec mszh_decoder;
+extern AVCodec nuv_decoder;
+extern AVCodec png_decoder;
+extern AVCodec ptx_decoder;
+extern AVCodec qdm2_decoder;
+extern AVCodec qdraw_decoder;
+extern AVCodec qpeg_decoder;
+extern AVCodec qtrle_decoder;
+extern AVCodec ra_144_decoder;
+extern AVCodec ra_288_decoder;
+extern AVCodec roq_decoder;
+extern AVCodec roq_dpcm_decoder;
+extern AVCodec rpza_decoder;
+extern AVCodec rv10_decoder;
+extern AVCodec rv20_decoder;
+extern AVCodec rv30_decoder;
+extern AVCodec rv40_decoder;
+extern AVCodec sgi_decoder;
+extern AVCodec shorten_decoder;
+extern AVCodec smackaud_decoder;
+extern AVCodec smacker_decoder;
+extern AVCodec smc_decoder;
+extern AVCodec snow_decoder;
+extern AVCodec sol_dpcm_decoder;
+extern AVCodec sonic_decoder;
+extern AVCodec sp5x_decoder;
+extern AVCodec svq1_decoder;
+extern AVCodec svq3_decoder;
+extern AVCodec targa_decoder;
+extern AVCodec theora_decoder;
+extern AVCodec thp_decoder;
+extern AVCodec tiertexseqvideo_decoder;
+extern AVCodec tiff_decoder;
+extern AVCodec truemotion1_decoder;
+extern AVCodec truemotion2_decoder;
+extern AVCodec truespeech_decoder;
+extern AVCodec tscc_decoder;
+extern AVCodec tta_decoder;
+extern AVCodec txd_decoder;
+extern AVCodec ulti_decoder;
+extern AVCodec vc1_decoder;
+extern AVCodec vcr1_decoder;
+extern AVCodec vmdaudio_decoder;
+extern AVCodec vmdvideo_decoder;
+extern AVCodec vmnc_decoder;
+extern AVCodec vorbis_decoder;
+extern AVCodec vp3_decoder;
+extern AVCodec vp5_decoder;
+extern AVCodec vp6_decoder;
+extern AVCodec vp6f_decoder;
+extern AVCodec vqa_decoder;
+extern AVCodec wavpack_decoder;
+extern AVCodec wmav1_decoder;
+extern AVCodec wmav2_decoder;
+extern AVCodec wmv1_decoder;
+extern AVCodec wmv2_decoder;
+extern AVCodec wmv3_decoder;
+extern AVCodec wnv1_decoder;
+extern AVCodec ws_snd1_decoder;
+extern AVCodec xan_dpcm_decoder;
+extern AVCodec xan_wc3_decoder;
+extern AVCodec xl_decoder;
+extern AVCodec zmbv_decoder;
+
+/* PCM codecs */
+#define PCM_CODEC(id, name) \
+extern AVCodec name ## _decoder; \
+extern AVCodec name ## _encoder
+
+PCM_CODEC(CODEC_ID_PCM_ALAW,    pcm_alaw);
+PCM_CODEC(CODEC_ID_PCM_MULAW,   pcm_mulaw);
+PCM_CODEC(CODEC_ID_PCM_S8,      pcm_s8);
+PCM_CODEC(CODEC_ID_PCM_S16BE,   pcm_s16be);
+PCM_CODEC(CODEC_ID_PCM_S16LE,   pcm_s16le);
+PCM_CODEC(CODEC_ID_PCM_S24BE,   pcm_s24be);
+PCM_CODEC(CODEC_ID_PCM_S24DAUD, pcm_s24daud);
+PCM_CODEC(CODEC_ID_PCM_S24LE,   pcm_s24le);
+PCM_CODEC(CODEC_ID_PCM_S32BE,   pcm_s32be);
+PCM_CODEC(CODEC_ID_PCM_S32LE,   pcm_s32le);
+PCM_CODEC(CODEC_ID_PCM_U8,      pcm_u8);
+PCM_CODEC(CODEC_ID_PCM_U16BE,   pcm_u16be);
+PCM_CODEC(CODEC_ID_PCM_U16LE,   pcm_u16le);
+PCM_CODEC(CODEC_ID_PCM_U24BE,   pcm_u24be);
+PCM_CODEC(CODEC_ID_PCM_U24LE,   pcm_u24le);
+PCM_CODEC(CODEC_ID_PCM_U32BE,   pcm_u32be);
+PCM_CODEC(CODEC_ID_PCM_U32LE,   pcm_u32le);
+
+/* ADPCM codecs */
+
+PCM_CODEC(CODEC_ID_ADPCM_4XM,     adpcm_4xm);
+PCM_CODEC(CODEC_ID_ADPCM_ADX,     adpcm_adx);
+PCM_CODEC(CODEC_ID_ADPCM_CT,      adpcm_ct);
+PCM_CODEC(CODEC_ID_ADPCM_EA,      adpcm_ea);
+PCM_CODEC(CODEC_ID_ADPCM_G726,    adpcm_g726);
+PCM_CODEC(CODEC_ID_ADPCM_IMA_DK3, adpcm_ima_dk3);
+PCM_CODEC(CODEC_ID_ADPCM_IMA_DK4, adpcm_ima_dk4);
+PCM_CODEC(CODEC_ID_ADPCM_IMA_QT,  adpcm_ima_qt);
+PCM_CODEC(CODEC_ID_ADPCM_IMA_WAV, adpcm_ima_wav);
+PCM_CODEC(CODEC_ID_ADPCM_IMA_WS,  adpcm_ima_ws);
+PCM_CODEC(CODEC_ID_ADPCM_MS,      adpcm_ms);
+PCM_CODEC(CODEC_ID_ADPCM_SBPRO_2, adpcm_sbpro_2);
+PCM_CODEC(CODEC_ID_ADPCM_SBPRO_3, adpcm_sbpro_3);
+PCM_CODEC(CODEC_ID_ADPCM_SBPRO_4, adpcm_sbpro_4);
+PCM_CODEC(CODEC_ID_ADPCM_SMJPEG,  adpcm_ima_smjpeg);
+PCM_CODEC(CODEC_ID_ADPCM_SWF,     adpcm_swf);
+PCM_CODEC(CODEC_ID_ADPCM_THP,     adpcm_thp);
+PCM_CODEC(CODEC_ID_ADPCM_XA,      adpcm_xa);
+PCM_CODEC(CODEC_ID_ADPCM_YAMAHA,  adpcm_yamaha);
+
+#undef PCM_CODEC
+
+/* dummy raw video codec */
+extern AVCodec rawvideo_decoder;
+extern AVCodec rawvideo_encoder;
+
+/* the following codecs use external libs */
+extern AVCodec liba52_decoder;
+extern AVCodec libamr_nb_decoder;
+extern AVCodec libamr_nb_encoder;
+extern AVCodec libamr_wb_decoder;
+extern AVCodec libamr_wb_encoder;
+extern AVCodec libfaac_encoder;
+extern AVCodec libfaad_decoder;
+extern AVCodec libgsm_decoder;
+extern AVCodec libgsm_encoder;
+extern AVCodec libgsm_ms_decoder;
+extern AVCodec libgsm_ms_encoder;
+extern AVCodec libmp3lame_encoder;
+extern AVCodec libtheora_encoder;
+extern AVCodec libvorbis_decoder;
+extern AVCodec libvorbis_encoder;
+extern AVCodec libx264_encoder;
+extern AVCodec libxvid_encoder;
+extern AVCodec mpeg4aac_decoder;
+extern AVCodec zlib_decoder;
+extern AVCodec zlib_encoder;
+
+/* subtitles */
+extern AVCodec dvbsub_decoder;
+extern AVCodec dvbsub_encoder;
+extern AVCodec dvdsub_decoder;
+extern AVCodec dvdsub_encoder;
+
+#endif /* ALLCODECS_H */

Added: branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec/h261.h
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec/h261.h	2007-07-16 18:08:14 UTC (rev 3389)
+++ branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec/h261.h	2007-07-16 18:11:38 UTC (rev 3390)
@@ -0,0 +1,51 @@
+/*
+ * H261 decoder
+ * Copyright (c) 2002-2004 Michael Niedermayer <michaelni at gmx.at>
+ * Copyright (c) 2004 Maarten Daniels
+ *
+ * This file is part of FFmpeg.
+ *
+ * FFmpeg is free software; you can redistribute it and/or
+ * modify it under the terms of the GNU Lesser General Public
+ * License as published by the Free Software Foundation; either
+ * version 2.1 of the License, or (at your option) any later version.
+ *
+ * FFmpeg is distributed in the hope that it will be useful,
+ * but WITHOUT ANY WARRANTY; without even the implied warranty of
+ * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ * Lesser General Public License for more details.
+ *
+ * You should have received a copy of the GNU Lesser General Public
+ * License along with FFmpeg; if not, write to the Free Software
+ * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA
+ */
+
+/**
+ * @file h261.c
+ * h261codec.
+ */
+
+#ifndef AVCODEC_H261_H
+#define AVCODEC_H261_H
+
+#include "mpegvideo.h"
+
+/**
+ * H261Context
+ */
+typedef struct H261Context{
+    MpegEncContext s;
+
+    int current_mba;
+    int previous_mba;
+    int mba_diff;
+    int mtype;
+    int current_mv_x;
+    int current_mv_y;
+    int gob_number;
+    int gob_start_code_skipped; // 1 if gob start code is already read before gob header is read
+}H261Context;
+
+#define MB_TYPE_H261_FIL 0x800000
+
+#endif /* AVCODEC_H261_H */

Added: branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec/h263.h
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec/h263.h	2007-07-16 18:08:14 UTC (rev 3389)
+++ branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec/h263.h	2007-07-16 18:11:38 UTC (rev 3390)
@@ -0,0 +1,46 @@
+/*
+ * H263/MPEG4 backend for ffmpeg encoder and decoder
+ * copyright (c) 2007 Aurelien Jacobs <aurel at gnuage.org>
+ *
+ * This file is part of FFmpeg.
+ *
+ * FFmpeg is free software; you can redistribute it and/or
+ * modify it under the terms of the GNU Lesser General Public
+ * License as published by the Free Software Foundation; either
+ * version 2.1 of the License, or (at your option) any later version.
+ *
+ * FFmpeg is distributed in the hope that it will be useful,
+ * but WITHOUT ANY WARRANTY; without even the implied warranty of
+ * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ * Lesser General Public License for more details.
+ *
+ * You should have received a copy of the GNU Lesser General Public
+ * License along with FFmpeg; if not, write to the Free Software
+ * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA
+ */
+
+#ifndef AVCODEC_H263_H
+#define AVCODEC_H263_H
+
+#include "config.h"
+#include "msmpeg4.h"
+
+#define ENABLE_ANY_H263_DECODER (ENABLE_H263_DECODER    || \
+                                 ENABLE_H263I_DECODER   || \
+                                 ENABLE_FLV_DECODER     || \
+                                 ENABLE_RV10_DECODER    || \
+                                 ENABLE_RV20_DECODER    || \
+                                 ENABLE_MPEG4_DECODER   || \
+                                 ENABLE_MSMPEG4_DECODER || \
+                                 ENABLE_WMV_DECODER)
+#define ENABLE_ANY_H263_ENCODER (ENABLE_H263_ENCODER    || \
+                                 ENABLE_H263P_ENCODER   || \
+                                 ENABLE_FLV_ENCODER     || \
+                                 ENABLE_RV10_ENCODER    || \
+                                 ENABLE_RV20_ENCODER    || \
+                                 ENABLE_MPEG4_ENCODER   || \
+                                 ENABLE_MSMPEG4_ENCODER || \
+                                 ENABLE_WMV_ENCODER)
+#define ENABLE_ANY_H263 (ENABLE_ANY_H263_DECODER || ENABLE_ANY_H263_ENCODER)
+
+#endif /* AVCODEC_H263_H */

Added: branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec/h263_parser.h
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec/h263_parser.h	2007-07-16 18:08:14 UTC (rev 3389)
+++ branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec/h263_parser.h	2007-07-16 18:11:38 UTC (rev 3390)
@@ -0,0 +1,29 @@
+/*
+ * H.263 parser
+ * Copyright (c) 2002-2004 Michael Niedermayer <michaelni at gmx.at>
+ *
+ * This file is part of FFmpeg.
+ *
+ * FFmpeg is free software; you can redistribute it and/or
+ * modify it under the terms of the GNU Lesser General Public
+ * License as published by the Free Software Foundation; either
+ * version 2.1 of the License, or (at your option) any later version.
+ *
+ * FFmpeg is distributed in the hope that it will be useful,
+ * but WITHOUT ANY WARRANTY; without even the implied warranty of
+ * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ * Lesser General Public License for more details.
+ *
+ * You should have received a copy of the GNU Lesser General Public
+ * License along with FFmpeg; if not, write to the Free Software
+ * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA
+ */
+
+#ifndef AVCODEC_H263_PARSER_H
+#define AVCODEC_H263_PARSER_H
+
+#include "parser.h"
+
+int ff_h263_find_frame_end(ParseContext *pc, const uint8_t *buf, int buf_size);
+
+#endif // AVCODEC_H263_PARSER_H

Added: branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec/h264.h
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec/h264.h	2007-07-16 18:08:14 UTC (rev 3389)
+++ branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec/h264.h	2007-07-16 18:11:38 UTC (rev 3390)
@@ -0,0 +1,387 @@
+/*
+ * H.26L/H.264/AVC/JVT/14496-10/... encoder/decoder
+ * Copyright (c) 2003 Michael Niedermayer <michaelni at gmx.at>
+ *
+ * This file is part of FFmpeg.
+ *
+ * FFmpeg is free software; you can redistribute it and/or
+ * modify it under the terms of the GNU Lesser General Public
+ * License as published by the Free Software Foundation; either
+ * version 2.1 of the License, or (at your option) any later version.
+ *
+ * FFmpeg is distributed in the hope that it will be useful,
+ * but WITHOUT ANY WARRANTY; without even the implied warranty of
+ * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ * Lesser General Public License for more details.
+ *
+ * You should have received a copy of the GNU Lesser General Public
+ * License along with FFmpeg; if not, write to the Free Software
+ * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA
+ */
+
+/**
+ * @file h264.h
+ * H.264 / AVC / MPEG4 part10 codec.
+ * @author Michael Niedermayer <michaelni at gmx.at>
+ */
+
+#ifndef H264_H
+#define H264_H
+
+#include "dsputil.h"
+#include "cabac.h"
+#include "mpegvideo.h"
+
+#define interlaced_dct interlaced_dct_is_a_bad_name
+#define mb_intra mb_intra_is_not_initialized_see_mb_type
+
+#define LUMA_DC_BLOCK_INDEX   25
+#define CHROMA_DC_BLOCK_INDEX 26
+
+#define CHROMA_DC_COEFF_TOKEN_VLC_BITS 8
+#define COEFF_TOKEN_VLC_BITS           8
+#define TOTAL_ZEROS_VLC_BITS           9
+#define CHROMA_DC_TOTAL_ZEROS_VLC_BITS 3
+#define RUN_VLC_BITS                   3
+#define RUN7_VLC_BITS                  6
+
+#define MAX_SPS_COUNT 32
+#define MAX_PPS_COUNT 256
+
+#define MAX_MMCO_COUNT 66
+
+/* Compiling in interlaced support reduces the speed
+ * of progressive decoding by about 2%. */
+#define ALLOW_INTERLACE
+
+#ifdef ALLOW_INTERLACE
+#define MB_MBAFF h->mb_mbaff
+#define MB_FIELD h->mb_field_decoding_flag
+#define FRAME_MBAFF h->mb_aff_frame
+#else
+#define MB_MBAFF 0
+#define MB_FIELD 0
+#define FRAME_MBAFF 0
+#undef  IS_INTERLACED
+#define IS_INTERLACED(mb_type) 0
+#endif
+
+/**
+ * Sequence parameter set
+ */
+typedef struct SPS{
+
+    int profile_idc;
+    int level_idc;
+    int transform_bypass;              ///< qpprime_y_zero_transform_bypass_flag
+    int log2_max_frame_num;            ///< log2_max_frame_num_minus4 + 4
+    int poc_type;                      ///< pic_order_cnt_type
+    int log2_max_poc_lsb;              ///< log2_max_pic_order_cnt_lsb_minus4
+    int delta_pic_order_always_zero_flag;
+    int offset_for_non_ref_pic;
+    int offset_for_top_to_bottom_field;
+    int poc_cycle_length;              ///< num_ref_frames_in_pic_order_cnt_cycle
+    int ref_frame_count;               ///< num_ref_frames
+    int gaps_in_frame_num_allowed_flag;
+    int mb_width;                      ///< frame_width_in_mbs_minus1 + 1
+    int mb_height;                     ///< frame_height_in_mbs_minus1 + 1
+    int frame_mbs_only_flag;
+    int mb_aff;                        ///<mb_adaptive_frame_field_flag
+    int direct_8x8_inference_flag;
+    int crop;                   ///< frame_cropping_flag
+    int crop_left;              ///< frame_cropping_rect_left_offset
+    int crop_right;             ///< frame_cropping_rect_right_offset
+    int crop_top;               ///< frame_cropping_rect_top_offset
+    int crop_bottom;            ///< frame_cropping_rect_bottom_offset
+    int vui_parameters_present_flag;
+    AVRational sar;
+    int timing_info_present_flag;
+    uint32_t num_units_in_tick;
+    uint32_t time_scale;
+    int fixed_frame_rate_flag;
+    short offset_for_ref_frame[256]; //FIXME dyn aloc?
+    int bitstream_restriction_flag;
+    int num_reorder_frames;
+    int scaling_matrix_present;
+    uint8_t scaling_matrix4[6][16];
+    uint8_t scaling_matrix8[2][64];
+}SPS;
+
+/**
+ * Picture parameter set
+ */
+typedef struct PPS{
+    unsigned int sps_id;
+    int cabac;                  ///< entropy_coding_mode_flag
+    int pic_order_present;      ///< pic_order_present_flag
+    int slice_group_count;      ///< num_slice_groups_minus1 + 1
+    int mb_slice_group_map_type;
+    unsigned int ref_count[2];  ///< num_ref_idx_l0/1_active_minus1 + 1
+    int weighted_pred;          ///< weighted_pred_flag
+    int weighted_bipred_idc;
+    int init_qp;                ///< pic_init_qp_minus26 + 26
+    int init_qs;                ///< pic_init_qs_minus26 + 26
+    int chroma_qp_index_offset[2];
+    int deblocking_filter_parameters_present; ///< deblocking_filter_parameters_present_flag
+    int constrained_intra_pred; ///< constrained_intra_pred_flag
+    int redundant_pic_cnt_present; ///< redundant_pic_cnt_present_flag
+    int transform_8x8_mode;     ///< transform_8x8_mode_flag
+    uint8_t scaling_matrix4[6][16];
+    uint8_t scaling_matrix8[2][64];
+    uint8_t chroma_qp_table[2][256];  ///< pre-scaled (with chroma_qp_index_offset) version of qp_table
+    int chroma_qp_diff;
+}PPS;
+
+/**
+ * Memory management control operation opcode.
+ */
+typedef enum MMCOOpcode{
+    MMCO_END=0,
+    MMCO_SHORT2UNUSED,
+    MMCO_LONG2UNUSED,
+    MMCO_SHORT2LONG,
+    MMCO_SET_MAX_LONG,
+    MMCO_RESET,
+    MMCO_LONG,
+} MMCOOpcode;
+
+/**
+ * Memory management control operation.
+ */
+typedef struct MMCO{
+    MMCOOpcode opcode;
+    int short_frame_num;
+    int long_index;
+} MMCO;
+
+/**
+ * H264Context
+ */
+typedef struct H264Context{
+    MpegEncContext s;
+    int nal_ref_idc;
+    int nal_unit_type;
+    uint8_t *rbsp_buffer[2];
+    unsigned int rbsp_buffer_size[2];
+
+    /**
+      * Used to parse AVC variant of h264
+      */
+    int is_avc; ///< this flag is != 0 if codec is avc1
+    int got_avcC; ///< flag used to parse avcC data only once
+    int nal_length_size; ///< Number of bytes used for nal length (1, 2 or 4)
+
+    int chroma_qp[2]; //QPc
+
+    int prev_mb_skipped;
+    int next_mb_skipped;
+
+    //prediction stuff
+    int chroma_pred_mode;
+    int intra16x16_pred_mode;
+
+    int top_mb_xy;
+    int left_mb_xy[2];
+
+    int8_t intra4x4_pred_mode_cache[5*8];
+    int8_t (*intra4x4_pred_mode)[8];
+    void (*pred4x4  [9+3])(uint8_t *src, uint8_t *topright, int stride);//FIXME move to dsp?
+    void (*pred8x8l [9+3])(uint8_t *src, int topleft, int topright, int stride);
+    void (*pred8x8  [4+3])(uint8_t *src, int stride);
+    void (*pred16x16[4+3])(uint8_t *src, int stride);
+    unsigned int topleft_samples_available;
+    unsigned int top_samples_available;
+    unsigned int topright_samples_available;
+    unsigned int left_samples_available;
+    uint8_t (*top_borders[2])[16+2*8];
+    uint8_t left_border[2*(17+2*9)];
+
+    /**
+     * non zero coeff count cache.
+     * is 64 if not available.
+     */
+    DECLARE_ALIGNED_8(uint8_t, non_zero_count_cache[6*8]);
+    uint8_t (*non_zero_count)[16];
+
+    /**
+     * Motion vector cache.
+     */
+    DECLARE_ALIGNED_8(int16_t, mv_cache[2][5*8][2]);
+    DECLARE_ALIGNED_8(int8_t, ref_cache[2][5*8]);
+#define LIST_NOT_USED -1 //FIXME rename?
+#define PART_NOT_AVAILABLE -2
+
+    /**
+     * is 1 if the specific list MV&references are set to 0,0,-2.
+     */
+    int mv_cache_clean[2];
+
+    /**
+     * number of neighbors (top and/or left) that used 8x8 dct
+     */
+    int neighbor_transform_size;
+
+    /**
+     * block_offset[ 0..23] for frame macroblocks
+     * block_offset[24..47] for field macroblocks
+     */
+    int block_offset[2*(16+8)];
+
+    uint32_t *mb2b_xy; //FIXME are these 4 a good idea?
+    uint32_t *mb2b8_xy;
+    int b_stride; //FIXME use s->b4_stride
+    int b8_stride;
+
+    int mb_linesize;   ///< may be equal to s->linesize or s->linesize*2, for mbaff
+    int mb_uvlinesize;
+
+    int emu_edge_width;
+    int emu_edge_height;
+
+    int halfpel_flag;
+    int thirdpel_flag;
+
+    int unknown_svq3_flag;
+    int next_slice_index;
+
+    SPS *sps_buffers[MAX_SPS_COUNT];
+    SPS sps; ///< current sps
+
+    PPS *pps_buffers[MAX_PPS_COUNT];
+    /**
+     * current pps
+     */
+    PPS pps; //FIXME move to Picture perhaps? (->no) do we need that?
+
+    uint32_t dequant4_buffer[6][52][16];
+    uint32_t dequant8_buffer[2][52][64];
+    uint32_t (*dequant4_coeff[6])[16];
+    uint32_t (*dequant8_coeff[2])[64];
+    int dequant_coeff_pps;     ///< reinit tables when pps changes
+
+    int slice_num;
+    uint8_t *slice_table_base;
+    uint8_t *slice_table;      ///< slice_table_base + 2*mb_stride + 1
+    int slice_type;
+    int slice_type_fixed;
+
+    //interlacing specific flags
+    int mb_aff_frame;
+    int mb_field_decoding_flag;
+    int mb_mbaff;              ///< mb_aff_frame && mb_field_decoding_flag
+
+    unsigned int sub_mb_type[4];
+
+    //POC stuff
+    int poc_lsb;
+    int poc_msb;
+    int delta_poc_bottom;
+    int delta_poc[2];
+    int frame_num;
+    int prev_poc_msb;             ///< poc_msb of the last reference pic for POC type 0
+    int prev_poc_lsb;             ///< poc_lsb of the last reference pic for POC type 0
+    int frame_num_offset;         ///< for POC type 2
+    int prev_frame_num_offset;    ///< for POC type 2
+    int prev_frame_num;           ///< frame_num of the last pic for POC type 1/2
+
+    /**
+     * frame_num for frames or 2*frame_num for field pics.
+     */
+    int curr_pic_num;
+
+    /**
+     * max_frame_num or 2*max_frame_num for field pics.
+     */
+    int max_pic_num;
+
+    //Weighted pred stuff
+    int use_weight;
+    int use_weight_chroma;
+    int luma_log2_weight_denom;
+    int chroma_log2_weight_denom;
+    int luma_weight[2][48];
+    int luma_offset[2][48];
+    int chroma_weight[2][48][2];
+    int chroma_offset[2][48][2];
+    int implicit_weight[48][48];
+
+    //deblock
+    int deblocking_filter;         ///< disable_deblocking_filter_idc with 1<->0
+    int slice_alpha_c0_offset;
+    int slice_beta_offset;
+
+    int redundant_pic_count;
+
+    int direct_spatial_mv_pred;
+    int dist_scale_factor[16];
+    int dist_scale_factor_field[32];
+    int map_col_to_list0[2][16];
+    int map_col_to_list0_field[2][32];
+
+    /**
+     * num_ref_idx_l0/1_active_minus1 + 1
+     */
+    unsigned int ref_count[2];   ///< counts frames or fields, depending on current mb mode
+    unsigned int list_count;
+    Picture *short_ref[32];
+    Picture *long_ref[32];
+    Picture default_ref_list[2][32];
+    Picture ref_list[2][48];     ///< 0..15: frame refs, 16..47: mbaff field refs
+    Picture *delayed_pic[18]; //FIXME size?
+    Picture *delayed_output_pic;
+
+    /**
+     * memory management control operations buffer.
+     */
+    MMCO mmco[MAX_MMCO_COUNT];
+    int mmco_index;
+
+    int long_ref_count;  ///< number of actual long term references
+    int short_ref_count; ///< number of actual short term references
+
+    //data partitioning
+    GetBitContext intra_gb;
+    GetBitContext inter_gb;
+    GetBitContext *intra_gb_ptr;
+    GetBitContext *inter_gb_ptr;
+
+    DECLARE_ALIGNED_8(DCTELEM, mb[16*24]);
+    DCTELEM mb_padding[256];        ///< as mb is addressed by scantable[i] and scantable is uint8_t we can either check that i is not to large or ensure that there is some unused stuff after mb
+
+    /**
+     * Cabac
+     */
+    CABACContext cabac;
+    uint8_t      cabac_state[460];
+    int          cabac_init_idc;
+
+    /* 0x100 -> non null luma_dc, 0x80/0x40 -> non null chroma_dc (cb/cr), 0x?0 -> chroma_cbp(0,1,2), 0x0? luma_cbp */
+    uint16_t     *cbp_table;
+    int cbp;
+    int top_cbp;
+    int left_cbp;
+    /* chroma_pred_mode for i4x4 or i16x16, else 0 */
+    uint8_t     *chroma_pred_mode_table;
+    int         last_qscale_diff;
+    int16_t     (*mvd_table[2])[2];
+    DECLARE_ALIGNED_8(int16_t, mvd_cache[2][5*8][2]);
+    uint8_t     *direct_table;
+    uint8_t     direct_cache[5*8];
+
+    uint8_t zigzag_scan[16];
+    uint8_t zigzag_scan8x8[64];
+    uint8_t zigzag_scan8x8_cavlc[64];
+    uint8_t field_scan[16];
+    uint8_t field_scan8x8[64];
+    uint8_t field_scan8x8_cavlc[64];
+    const uint8_t *zigzag_scan_q0;
+    const uint8_t *zigzag_scan8x8_q0;
+    const uint8_t *zigzag_scan8x8_cavlc_q0;
+    const uint8_t *field_scan_q0;
+    const uint8_t *field_scan8x8_q0;
+    const uint8_t *field_scan8x8_cavlc_q0;
+
+    int x264_build;
+}H264Context;
+
+#endif /* H264_H */

Added: branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec/h264_parser.h
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec/h264_parser.h	2007-07-16 18:08:14 UTC (rev 3389)
+++ branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec/h264_parser.h	2007-07-16 18:11:38 UTC (rev 3390)
@@ -0,0 +1,39 @@
+/*
+ * H.26L/H.264/AVC/JVT/14496-10/... parser
+ * Copyright (c) 2003 Michael Niedermayer <michaelni at gmx.at>
+ *
+ * This file is part of FFmpeg.
+ *
+ * FFmpeg is free software; you can redistribute it and/or
+ * modify it under the terms of the GNU Lesser General Public
+ * License as published by the Free Software Foundation; either
+ * version 2.1 of the License, or (at your option) any later version.
+ *
+ * FFmpeg is distributed in the hope that it will be useful,
+ * but WITHOUT ANY WARRANTY; without even the implied warranty of
+ * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ * Lesser General Public License for more details.
+ *
+ * You should have received a copy of the GNU Lesser General Public
+ * License along with FFmpeg; if not, write to the Free Software
+ * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA
+ */
+
+/**
+ * @file h264_parser.h
+ * H.264 / AVC / MPEG4 part10 parser.
+ * @author Michael Niedermayer <michaelni at gmx.at>
+ */
+
+#ifndef H264_PARSER_H
+#define H264_PARSER_H
+
+#include "h264.h"
+
+/**
+ * finds the end of the current frame in the bitstream.
+ * @return the position of the first byte of the next frame, or -1
+ */
+int ff_h264_find_frame_end(H264Context *h, const uint8_t *buf, int buf_size);
+
+#endif /* H264_PARSER_H */

Added: branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec/mjpeg.h
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec/mjpeg.h	2007-07-16 18:08:14 UTC (rev 3389)
+++ branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec/mjpeg.h	2007-07-16 18:11:38 UTC (rev 3390)
@@ -0,0 +1,156 @@
+/*
+ * MJPEG encoder and decoder
+ * Copyright (c) 2000, 2001 Fabrice Bellard.
+ * Copyright (c) 2003 Alex Beregszaszi
+ * Copyright (c) 2003-2004 Michael Niedermayer
+ *
+ * Support for external huffman table, various fixes (AVID workaround),
+ * aspecting, new decode_frame mechanism and apple mjpeg-b support
+ *                                  by Alex Beregszaszi
+ *
+ * This file is part of FFmpeg.
+ *
+ * FFmpeg is free software; you can redistribute it and/or
+ * modify it under the terms of the GNU Lesser General Public
+ * License as published by the Free Software Foundation; either
+ * version 2.1 of the License, or (at your option) any later version.
+ *
+ * FFmpeg is distributed in the hope that it will be useful,
+ * but WITHOUT ANY WARRANTY; without even the implied warranty of
+ * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ * Lesser General Public License for more details.
+ *
+ * You should have received a copy of the GNU Lesser General Public
+ * License along with FFmpeg; if not, write to the Free Software
+ * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA
+ */
+
+/**
+ * @file mjpeg.h
+ * MJPEG encoder and decoder.
+ */
+
+#ifndef MJPEG_H
+#define MJPEG_H
+
+#include "avcodec.h"
+#include "bitstream.h"
+
+
+/* JPEG marker codes */
+typedef enum {
+    /* start of frame */
+    SOF0  = 0xc0,       /* baseline */
+    SOF1  = 0xc1,       /* extended sequential, huffman */
+    SOF2  = 0xc2,       /* progressive, huffman */
+    SOF3  = 0xc3,       /* lossless, huffman */
+
+    SOF5  = 0xc5,       /* differential sequential, huffman */
+    SOF6  = 0xc6,       /* differential progressive, huffman */
+    SOF7  = 0xc7,       /* differential lossless, huffman */
+    JPG   = 0xc8,       /* reserved for JPEG extension */
+    SOF9  = 0xc9,       /* extended sequential, arithmetic */
+    SOF10 = 0xca,       /* progressive, arithmetic */
+    SOF11 = 0xcb,       /* lossless, arithmetic */
+
+    SOF13 = 0xcd,       /* differential sequential, arithmetic */
+    SOF14 = 0xce,       /* differential progressive, arithmetic */
+    SOF15 = 0xcf,       /* differential lossless, arithmetic */
+
+    DHT   = 0xc4,       /* define huffman tables */
+
+    DAC   = 0xcc,       /* define arithmetic-coding conditioning */
+
+    /* restart with modulo 8 count "m" */
+    RST0  = 0xd0,
+    RST1  = 0xd1,
+    RST2  = 0xd2,
+    RST3  = 0xd3,
+    RST4  = 0xd4,
+    RST5  = 0xd5,
+    RST6  = 0xd6,
+    RST7  = 0xd7,
+
+    SOI   = 0xd8,       /* start of image */
+    EOI   = 0xd9,       /* end of image */
+    SOS   = 0xda,       /* start of scan */
+    DQT   = 0xdb,       /* define quantization tables */
+    DNL   = 0xdc,       /* define number of lines */
+    DRI   = 0xdd,       /* define restart interval */
+    DHP   = 0xde,       /* define hierarchical progression */
+    EXP   = 0xdf,       /* expand reference components */
+
+    APP0  = 0xe0,
+    APP1  = 0xe1,
+    APP2  = 0xe2,
+    APP3  = 0xe3,
+    APP4  = 0xe4,
+    APP5  = 0xe5,
+    APP6  = 0xe6,
+    APP7  = 0xe7,
+    APP8  = 0xe8,
+    APP9  = 0xe9,
+    APP10 = 0xea,
+    APP11 = 0xeb,
+    APP12 = 0xec,
+    APP13 = 0xed,
+    APP14 = 0xee,
+    APP15 = 0xef,
+
+    JPG0  = 0xf0,
+    JPG1  = 0xf1,
+    JPG2  = 0xf2,
+    JPG3  = 0xf3,
+    JPG4  = 0xf4,
+    JPG5  = 0xf5,
+    JPG6  = 0xf6,
+    SOF48 = 0xf7,       ///< JPEG-LS
+    LSE   = 0xf8,       ///< JPEG-LS extension parameters
+    JPG9  = 0xf9,
+    JPG10 = 0xfa,
+    JPG11 = 0xfb,
+    JPG12 = 0xfc,
+    JPG13 = 0xfd,
+
+    COM   = 0xfe,       /* comment */
+
+    TEM   = 0x01,       /* temporary private use for arithmetic coding */
+
+    /* 0x02 -> 0xbf reserved */
+} JPEG_MARKER;
+
+static inline void put_marker(PutBitContext *p, int code)
+{
+    put_bits(p, 8, 0xff);
+    put_bits(p, 8, code);
+}
+
+#define PREDICT(ret, topleft, top, left, predictor)\
+    switch(predictor){\
+        case 1: ret= left; break;\
+        case 2: ret= top; break;\
+        case 3: ret= topleft; break;\
+        case 4: ret= left   +   top - topleft; break;\
+        case 5: ret= left   + ((top - topleft)>>1); break;\
+        case 6: ret= top + ((left   - topleft)>>1); break;\
+        default:\
+        case 7: ret= (left + top)>>1; break;\
+    }
+
+extern const uint8_t ff_mjpeg_bits_dc_luminance[];
+extern const uint8_t ff_mjpeg_val_dc_luminance[];
+
+extern const uint8_t ff_mjpeg_bits_dc_chrominance[];
+extern const uint8_t ff_mjpeg_val_dc_chrominance[];
+
+extern const uint8_t ff_mjpeg_bits_ac_luminance[];
+extern const uint8_t ff_mjpeg_val_ac_luminance[];
+
+extern const uint8_t ff_mjpeg_bits_ac_chrominance[];
+extern const uint8_t ff_mjpeg_val_ac_chrominance[];
+
+void ff_mjpeg_build_huffman_codes(uint8_t *huff_size, uint16_t *huff_code,
+                                  const uint8_t *bits_table,
+                                  const uint8_t *val_table);
+
+#endif /* MJPEG_H */

Added: branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec/mjpegdec.h
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec/mjpegdec.h	2007-07-16 18:08:14 UTC (rev 3389)
+++ branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec/mjpegdec.h	2007-07-16 18:11:38 UTC (rev 3390)
@@ -0,0 +1,112 @@
+/*
+ * MJPEG decoder
+ * Copyright (c) 2000, 2001 Fabrice Bellard.
+ * Copyright (c) 2003 Alex Beregszaszi
+ * Copyright (c) 2003-2004 Michael Niedermayer
+ *
+ * This file is part of FFmpeg.
+ *
+ * FFmpeg is free software; you can redistribute it and/or
+ * modify it under the terms of the GNU Lesser General Public
+ * License as published by the Free Software Foundation; either
+ * version 2.1 of the License, or (at your option) any later version.
+ *
+ * FFmpeg is distributed in the hope that it will be useful,
+ * but WITHOUT ANY WARRANTY; without even the implied warranty of
+ * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ * Lesser General Public License for more details.
+ *
+ * You should have received a copy of the GNU Lesser General Public
+ * License along with FFmpeg; if not, write to the Free Software
+ * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA
+ */
+
+/**
+ * @file mjpegdec.h
+ * MJPEG decoder.
+ */
+
+#ifndef MJPEGDEC_H
+#define MJPEGDEC_H
+
+#include "avcodec.h"
+#include "bitstream.h"
+#include "dsputil.h"
+#include "mpegvideo.h"
+
+#define MAX_COMPONENTS 4
+
+typedef struct MJpegDecodeContext {
+    AVCodecContext *avctx;
+    GetBitContext gb;
+
+    int start_code; /* current start code */
+    int buffer_size;
+    uint8_t *buffer;
+
+    int16_t quant_matrixes[4][64];
+    VLC vlcs[2][4];
+    int qscale[4];      ///< quantizer scale calculated from quant_matrixes
+
+    int org_height;  /* size given at codec init */
+    int first_picture;    /* true if decoding first picture */
+    int interlaced;     /* true if interlaced */
+    int bottom_field;   /* true if bottom field */
+    int lossless;
+    int ls;
+    int progressive;
+    int rgb;
+    int rct;            /* standard rct */
+    int pegasus_rct;    /* pegasus reversible colorspace transform */
+    int bits;           /* bits per component */
+
+    int maxval;
+    int near;         ///< near lossless bound (si 0 for lossless)
+    int t1,t2,t3;
+    int reset;        ///< context halfing intervall ?rename
+
+    int width, height;
+    int mb_width, mb_height;
+    int nb_components;
+    int component_id[MAX_COMPONENTS];
+    int h_count[MAX_COMPONENTS]; /* horizontal and vertical count for each component */
+    int v_count[MAX_COMPONENTS];
+    int comp_index[MAX_COMPONENTS];
+    int dc_index[MAX_COMPONENTS];
+    int ac_index[MAX_COMPONENTS];
+    int nb_blocks[MAX_COMPONENTS];
+    int h_scount[MAX_COMPONENTS];
+    int v_scount[MAX_COMPONENTS];
+    int h_max, v_max; /* maximum h and v counts */
+    int quant_index[4];   /* quant table index for each component */
+    int last_dc[MAX_COMPONENTS]; /* last DEQUANTIZED dc (XXX: am I right to do that ?) */
+    AVFrame picture; /* picture structure */
+    int linesize[MAX_COMPONENTS];                   ///< linesize << interlaced
+    int8_t *qscale_table;
+    DECLARE_ALIGNED_8(DCTELEM, block[64]);
+    ScanTable scantable;
+    DSPContext dsp;
+
+    int restart_interval;
+    int restart_count;
+
+    int buggy_avid;
+    int cs_itu601;
+    int interlace_polarity;
+
+    int mjpb_skiptosod;
+
+    int cur_scan; /* current scan, used by JPEG-LS */
+} MJpegDecodeContext;
+
+int ff_mjpeg_decode_init(AVCodecContext *avctx);
+int ff_mjpeg_decode_end(AVCodecContext *avctx);
+int ff_mjpeg_decode_frame(AVCodecContext *avctx,
+                          void *data, int *data_size,
+                          uint8_t *buf, int buf_size);
+int ff_mjpeg_decode_dqt(MJpegDecodeContext *s);
+int ff_mjpeg_decode_dht(MJpegDecodeContext *s);
+int ff_mjpeg_decode_sof(MJpegDecodeContext *s);
+int ff_mjpeg_decode_sos(MJpegDecodeContext *s);
+
+#endif /* MJPEGDEC_H */

Added: branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec/mpeg4video_parser.h
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec/mpeg4video_parser.h	2007-07-16 18:08:14 UTC (rev 3389)
+++ branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec/mpeg4video_parser.h	2007-07-16 18:11:38 UTC (rev 3390)
@@ -0,0 +1,34 @@
+/*
+ * MPEG4 video parser prototypes
+ * Copyright (c) 2003 Fabrice Bellard.
+ * Copyright (c) 2003 Michael Niedermayer.
+ *
+ * This file is part of FFmpeg.
+ *
+ * FFmpeg is free software; you can redistribute it and/or
+ * modify it under the terms of the GNU Lesser General Public
+ * License as published by the Free Software Foundation; either
+ * version 2.1 of the License, or (at your option) any later version.
+ *
+ * FFmpeg is distributed in the hope that it will be useful,
+ * but WITHOUT ANY WARRANTY; without even the implied warranty of
+ * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ * Lesser General Public License for more details.
+ *
+ * You should have received a copy of the GNU Lesser General Public
+ * License along with FFmpeg; if not, write to the Free Software
+ * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA
+ */
+
+#ifndef MPEG4VIDEO_PARSER_H
+#define MPEG4VIDEO_PARSER_H
+
+#include "parser.h"
+
+/**
+ * finds the end of the current frame in the bitstream.
+ * @return the position of the first byte of the next frame, or -1
+ */
+int ff_mpeg4_find_frame_end(ParseContext *pc, const uint8_t *buf, int buf_size);
+
+#endif /* MPEG4VIDEO_PARSER_H */

Added: branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec/mpegvideo_common.h
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec/mpegvideo_common.h	2007-07-16 18:08:14 UTC (rev 3389)
+++ branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec/mpegvideo_common.h	2007-07-16 18:11:38 UTC (rev 3390)
@@ -0,0 +1,836 @@
+/*
+ * The simplest mpeg encoder (well, it was the simplest!)
+ * Copyright (c) 2000,2001 Fabrice Bellard.
+ * Copyright (c) 2002-2004 Michael Niedermayer <michaelni at gmx.at>
+ *
+ * 4MV & hq & B-frame encoding stuff by Michael Niedermayer <michaelni at gmx.at>
+ *
+ * This file is part of FFmpeg.
+ *
+ * FFmpeg is free software; you can redistribute it and/or
+ * modify it under the terms of the GNU Lesser General Public
+ * License as published by the Free Software Foundation; either
+ * version 2.1 of the License, or (at your option) any later version.
+ *
+ * FFmpeg is distributed in the hope that it will be useful,
+ * but WITHOUT ANY WARRANTY; without even the implied warranty of
+ * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ * Lesser General Public License for more details.
+ *
+ * You should have received a copy of the GNU Lesser General Public
+ * License along with FFmpeg; if not, write to the Free Software
+ * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA
+ */
+
+/**
+ * @file mpegvideo_common.h
+ * The simplest mpeg encoder (well, it was the simplest!).
+ */
+
+#ifndef MPEGVIDEO_COMMON_H
+#define MPEGVIDEO_COMMON_H
+
+#include "avcodec.h"
+#include "dsputil.h"
+#include "mpegvideo.h"
+#include "mjpegenc.h"
+#include "msmpeg4.h"
+#include "faandct.h"
+#include <limits.h>
+
+int dct_quantize_c(MpegEncContext *s, DCTELEM *block, int n, int qscale, int *overflow);
+int dct_quantize_trellis_c(MpegEncContext *s, DCTELEM *block, int n, int qscale, int *overflow);
+void  denoise_dct_c(MpegEncContext *s, DCTELEM *block);
+void copy_picture(Picture *dst, Picture *src);
+
+/**
+ * allocates a Picture
+ * The pixels are allocated/set by calling get_buffer() if shared=0
+ */
+int alloc_picture(MpegEncContext *s, Picture *pic, int shared);
+
+/**
+ * sets the given MpegEncContext to common defaults (same for encoding and decoding).
+ * the changed fields will not depend upon the prior state of the MpegEncContext.
+ */
+void MPV_common_defaults(MpegEncContext *s);
+
+static inline void gmc1_motion(MpegEncContext *s,
+                               uint8_t *dest_y, uint8_t *dest_cb, uint8_t *dest_cr,
+                               uint8_t **ref_picture)
+{
+    uint8_t *ptr;
+    int offset, src_x, src_y, linesize, uvlinesize;
+    int motion_x, motion_y;
+    int emu=0;
+
+    motion_x= s->sprite_offset[0][0];
+    motion_y= s->sprite_offset[0][1];
+    src_x = s->mb_x * 16 + (motion_x >> (s->sprite_warping_accuracy+1));
+    src_y = s->mb_y * 16 + (motion_y >> (s->sprite_warping_accuracy+1));
+    motion_x<<=(3-s->sprite_warping_accuracy);
+    motion_y<<=(3-s->sprite_warping_accuracy);
+    src_x = av_clip(src_x, -16, s->width);
+    if (src_x == s->width)
+        motion_x =0;
+    src_y = av_clip(src_y, -16, s->height);
+    if (src_y == s->height)
+        motion_y =0;
+
+    linesize = s->linesize;
+    uvlinesize = s->uvlinesize;
+
+    ptr = ref_picture[0] + (src_y * linesize) + src_x;
+
+    if(s->flags&CODEC_FLAG_EMU_EDGE){
+        if(   (unsigned)src_x >= s->h_edge_pos - 17
+           || (unsigned)src_y >= s->v_edge_pos - 17){
+            ff_emulated_edge_mc(s->edge_emu_buffer, ptr, linesize, 17, 17, src_x, src_y, s->h_edge_pos, s->v_edge_pos);
+            ptr= s->edge_emu_buffer;
+        }
+    }
+
+    if((motion_x|motion_y)&7){
+        s->dsp.gmc1(dest_y  , ptr  , linesize, 16, motion_x&15, motion_y&15, 128 - s->no_rounding);
+        s->dsp.gmc1(dest_y+8, ptr+8, linesize, 16, motion_x&15, motion_y&15, 128 - s->no_rounding);
+    }else{
+        int dxy;
+
+        dxy= ((motion_x>>3)&1) | ((motion_y>>2)&2);
+        if (s->no_rounding){
+            s->dsp.put_no_rnd_pixels_tab[0][dxy](dest_y, ptr, linesize, 16);
+        }else{
+            s->dsp.put_pixels_tab       [0][dxy](dest_y, ptr, linesize, 16);
+        }
+    }
+
+    if(s->flags&CODEC_FLAG_GRAY) return;
+
+    motion_x= s->sprite_offset[1][0];
+    motion_y= s->sprite_offset[1][1];
+    src_x = s->mb_x * 8 + (motion_x >> (s->sprite_warping_accuracy+1));
+    src_y = s->mb_y * 8 + (motion_y >> (s->sprite_warping_accuracy+1));
+    motion_x<<=(3-s->sprite_warping_accuracy);
+    motion_y<<=(3-s->sprite_warping_accuracy);
+    src_x = av_clip(src_x, -8, s->width>>1);
+    if (src_x == s->width>>1)
+        motion_x =0;
+    src_y = av_clip(src_y, -8, s->height>>1);
+    if (src_y == s->height>>1)
+        motion_y =0;
+
+    offset = (src_y * uvlinesize) + src_x;
+    ptr = ref_picture[1] + offset;
+    if(s->flags&CODEC_FLAG_EMU_EDGE){
+        if(   (unsigned)src_x >= (s->h_edge_pos>>1) - 9
+           || (unsigned)src_y >= (s->v_edge_pos>>1) - 9){
+            ff_emulated_edge_mc(s->edge_emu_buffer, ptr, uvlinesize, 9, 9, src_x, src_y, s->h_edge_pos>>1, s->v_edge_pos>>1);
+            ptr= s->edge_emu_buffer;
+            emu=1;
+        }
+    }
+    s->dsp.gmc1(dest_cb, ptr, uvlinesize, 8, motion_x&15, motion_y&15, 128 - s->no_rounding);
+
+    ptr = ref_picture[2] + offset;
+    if(emu){
+        ff_emulated_edge_mc(s->edge_emu_buffer, ptr, uvlinesize, 9, 9, src_x, src_y, s->h_edge_pos>>1, s->v_edge_pos>>1);
+        ptr= s->edge_emu_buffer;
+    }
+    s->dsp.gmc1(dest_cr, ptr, uvlinesize, 8, motion_x&15, motion_y&15, 128 - s->no_rounding);
+
+    return;
+}
+
+static inline void gmc_motion(MpegEncContext *s,
+                               uint8_t *dest_y, uint8_t *dest_cb, uint8_t *dest_cr,
+                               uint8_t **ref_picture)
+{
+    uint8_t *ptr;
+    int linesize, uvlinesize;
+    const int a= s->sprite_warping_accuracy;
+    int ox, oy;
+
+    linesize = s->linesize;
+    uvlinesize = s->uvlinesize;
+
+    ptr = ref_picture[0];
+
+    ox= s->sprite_offset[0][0] + s->sprite_delta[0][0]*s->mb_x*16 + s->sprite_delta[0][1]*s->mb_y*16;
+    oy= s->sprite_offset[0][1] + s->sprite_delta[1][0]*s->mb_x*16 + s->sprite_delta[1][1]*s->mb_y*16;
+
+    s->dsp.gmc(dest_y, ptr, linesize, 16,
+           ox,
+           oy,
+           s->sprite_delta[0][0], s->sprite_delta[0][1],
+           s->sprite_delta[1][0], s->sprite_delta[1][1],
+           a+1, (1<<(2*a+1)) - s->no_rounding,
+           s->h_edge_pos, s->v_edge_pos);
+    s->dsp.gmc(dest_y+8, ptr, linesize, 16,
+           ox + s->sprite_delta[0][0]*8,
+           oy + s->sprite_delta[1][0]*8,
+           s->sprite_delta[0][0], s->sprite_delta[0][1],
+           s->sprite_delta[1][0], s->sprite_delta[1][1],
+           a+1, (1<<(2*a+1)) - s->no_rounding,
+           s->h_edge_pos, s->v_edge_pos);
+
+    if(s->flags&CODEC_FLAG_GRAY) return;
+
+    ox= s->sprite_offset[1][0] + s->sprite_delta[0][0]*s->mb_x*8 + s->sprite_delta[0][1]*s->mb_y*8;
+    oy= s->sprite_offset[1][1] + s->sprite_delta[1][0]*s->mb_x*8 + s->sprite_delta[1][1]*s->mb_y*8;
+
+    ptr = ref_picture[1];
+    s->dsp.gmc(dest_cb, ptr, uvlinesize, 8,
+           ox,
+           oy,
+           s->sprite_delta[0][0], s->sprite_delta[0][1],
+           s->sprite_delta[1][0], s->sprite_delta[1][1],
+           a+1, (1<<(2*a+1)) - s->no_rounding,
+           s->h_edge_pos>>1, s->v_edge_pos>>1);
+
+    ptr = ref_picture[2];
+    s->dsp.gmc(dest_cr, ptr, uvlinesize, 8,
+           ox,
+           oy,
+           s->sprite_delta[0][0], s->sprite_delta[0][1],
+           s->sprite_delta[1][0], s->sprite_delta[1][1],
+           a+1, (1<<(2*a+1)) - s->no_rounding,
+           s->h_edge_pos>>1, s->v_edge_pos>>1);
+}
+
+static inline int hpel_motion(MpegEncContext *s,
+                                  uint8_t *dest, uint8_t *src,
+                                  int field_based, int field_select,
+                                  int src_x, int src_y,
+                                  int width, int height, int stride,
+                                  int h_edge_pos, int v_edge_pos,
+                                  int w, int h, op_pixels_func *pix_op,
+                                  int motion_x, int motion_y)
+{
+    int dxy;
+    int emu=0;
+
+    dxy = ((motion_y & 1) << 1) | (motion_x & 1);
+    src_x += motion_x >> 1;
+    src_y += motion_y >> 1;
+
+    /* WARNING: do no forget half pels */
+    src_x = av_clip(src_x, -16, width); //FIXME unneeded for emu?
+    if (src_x == width)
+        dxy &= ~1;
+    src_y = av_clip(src_y, -16, height);
+    if (src_y == height)
+        dxy &= ~2;
+    src += src_y * stride + src_x;
+
+    if(s->unrestricted_mv && (s->flags&CODEC_FLAG_EMU_EDGE)){
+        if(   (unsigned)src_x > h_edge_pos - (motion_x&1) - w
+           || (unsigned)src_y > v_edge_pos - (motion_y&1) - h){
+            ff_emulated_edge_mc(s->edge_emu_buffer, src, s->linesize, w+1, (h+1)<<field_based,
+                             src_x, src_y<<field_based, h_edge_pos, s->v_edge_pos);
+            src= s->edge_emu_buffer;
+            emu=1;
+        }
+    }
+    if(field_select)
+        src += s->linesize;
+    pix_op[dxy](dest, src, stride, h);
+    return emu;
+}
+
+/* apply one mpeg motion vector to the three components */
+static av_always_inline void mpeg_motion(MpegEncContext *s,
+                               uint8_t *dest_y, uint8_t *dest_cb, uint8_t *dest_cr,
+                               int field_based, int bottom_field, int field_select,
+                               uint8_t **ref_picture, op_pixels_func (*pix_op)[4],
+                               int motion_x, int motion_y, int h)
+{
+    uint8_t *ptr_y, *ptr_cb, *ptr_cr;
+    int dxy, uvdxy, mx, my, src_x, src_y, uvsrc_x, uvsrc_y, v_edge_pos, uvlinesize, linesize;
+
+#if 0
+if(s->quarter_sample)
+{
+    motion_x>>=1;
+    motion_y>>=1;
+}
+#endif
+
+    v_edge_pos = s->v_edge_pos >> field_based;
+    linesize   = s->current_picture.linesize[0] << field_based;
+    uvlinesize = s->current_picture.linesize[1] << field_based;
+
+    dxy = ((motion_y & 1) << 1) | (motion_x & 1);
+    src_x = s->mb_x* 16               + (motion_x >> 1);
+    src_y =(s->mb_y<<(4-field_based)) + (motion_y >> 1);
+
+    if (s->out_format == FMT_H263) {
+        if((s->workaround_bugs & FF_BUG_HPEL_CHROMA) && field_based){
+            mx = (motion_x>>1)|(motion_x&1);
+            my = motion_y >>1;
+            uvdxy = ((my & 1) << 1) | (mx & 1);
+            uvsrc_x = s->mb_x* 8               + (mx >> 1);
+            uvsrc_y = (s->mb_y<<(3-field_based)) + (my >> 1);
+        }else{
+            uvdxy = dxy | (motion_y & 2) | ((motion_x & 2) >> 1);
+            uvsrc_x = src_x>>1;
+            uvsrc_y = src_y>>1;
+        }
+    }else if(s->out_format == FMT_H261){//even chroma mv's are full pel in H261
+        mx = motion_x / 4;
+        my = motion_y / 4;
+        uvdxy = 0;
+        uvsrc_x = s->mb_x*8 + mx;
+        uvsrc_y = s->mb_y*8 + my;
+    } else {
+        if(s->chroma_y_shift){
+            mx = motion_x / 2;
+            my = motion_y / 2;
+            uvdxy = ((my & 1) << 1) | (mx & 1);
+            uvsrc_x = s->mb_x* 8               + (mx >> 1);
+            uvsrc_y = (s->mb_y<<(3-field_based)) + (my >> 1);
+        } else {
+            if(s->chroma_x_shift){
+            //Chroma422
+                mx = motion_x / 2;
+                uvdxy = ((motion_y & 1) << 1) | (mx & 1);
+                uvsrc_x = s->mb_x* 8           + (mx >> 1);
+                uvsrc_y = src_y;
+            } else {
+            //Chroma444
+                uvdxy = dxy;
+                uvsrc_x = src_x;
+                uvsrc_y = src_y;
+            }
+        }
+    }
+
+    ptr_y  = ref_picture[0] + src_y * linesize + src_x;
+    ptr_cb = ref_picture[1] + uvsrc_y * uvlinesize + uvsrc_x;
+    ptr_cr = ref_picture[2] + uvsrc_y * uvlinesize + uvsrc_x;
+
+    if(   (unsigned)src_x > s->h_edge_pos - (motion_x&1) - 16
+       || (unsigned)src_y >    v_edge_pos - (motion_y&1) - h){
+            if(s->codec_id == CODEC_ID_MPEG2VIDEO ||
+               s->codec_id == CODEC_ID_MPEG1VIDEO){
+                av_log(s->avctx,AV_LOG_DEBUG,"MPEG motion vector out of boundary\n");
+                return ;
+            }
+            ff_emulated_edge_mc(s->edge_emu_buffer, ptr_y, s->linesize, 17, 17+field_based,
+                             src_x, src_y<<field_based, s->h_edge_pos, s->v_edge_pos);
+            ptr_y = s->edge_emu_buffer;
+            if(!(s->flags&CODEC_FLAG_GRAY)){
+                uint8_t *uvbuf= s->edge_emu_buffer+18*s->linesize;
+                ff_emulated_edge_mc(uvbuf  , ptr_cb, s->uvlinesize, 9, 9+field_based,
+                                 uvsrc_x, uvsrc_y<<field_based, s->h_edge_pos>>1, s->v_edge_pos>>1);
+                ff_emulated_edge_mc(uvbuf+16, ptr_cr, s->uvlinesize, 9, 9+field_based,
+                                 uvsrc_x, uvsrc_y<<field_based, s->h_edge_pos>>1, s->v_edge_pos>>1);
+                ptr_cb= uvbuf;
+                ptr_cr= uvbuf+16;
+            }
+    }
+
+    if(bottom_field){ //FIXME use this for field pix too instead of the obnoxious hack which changes picture.data
+        dest_y += s->linesize;
+        dest_cb+= s->uvlinesize;
+        dest_cr+= s->uvlinesize;
+    }
+
+    if(field_select){
+        ptr_y += s->linesize;
+        ptr_cb+= s->uvlinesize;
+        ptr_cr+= s->uvlinesize;
+    }
+
+    pix_op[0][dxy](dest_y, ptr_y, linesize, h);
+
+    if(!(s->flags&CODEC_FLAG_GRAY)){
+        pix_op[s->chroma_x_shift][uvdxy](dest_cb, ptr_cb, uvlinesize, h >> s->chroma_y_shift);
+        pix_op[s->chroma_x_shift][uvdxy](dest_cr, ptr_cr, uvlinesize, h >> s->chroma_y_shift);
+    }
+    if((ENABLE_H261_ENCODER || ENABLE_H261_DECODER) && s->out_format == FMT_H261){
+        ff_h261_loop_filter(s);
+    }
+}
+
+//FIXME move to dsputil, avg variant, 16x16 version
+static inline void put_obmc(uint8_t *dst, uint8_t *src[5], int stride){
+    int x;
+    uint8_t * const top   = src[1];
+    uint8_t * const left  = src[2];
+    uint8_t * const mid   = src[0];
+    uint8_t * const right = src[3];
+    uint8_t * const bottom= src[4];
+#define OBMC_FILTER(x, t, l, m, r, b)\
+    dst[x]= (t*top[x] + l*left[x] + m*mid[x] + r*right[x] + b*bottom[x] + 4)>>3
+#define OBMC_FILTER4(x, t, l, m, r, b)\
+    OBMC_FILTER(x         , t, l, m, r, b);\
+    OBMC_FILTER(x+1       , t, l, m, r, b);\
+    OBMC_FILTER(x  +stride, t, l, m, r, b);\
+    OBMC_FILTER(x+1+stride, t, l, m, r, b);
+
+    x=0;
+    OBMC_FILTER (x  , 2, 2, 4, 0, 0);
+    OBMC_FILTER (x+1, 2, 1, 5, 0, 0);
+    OBMC_FILTER4(x+2, 2, 1, 5, 0, 0);
+    OBMC_FILTER4(x+4, 2, 0, 5, 1, 0);
+    OBMC_FILTER (x+6, 2, 0, 5, 1, 0);
+    OBMC_FILTER (x+7, 2, 0, 4, 2, 0);
+    x+= stride;
+    OBMC_FILTER (x  , 1, 2, 5, 0, 0);
+    OBMC_FILTER (x+1, 1, 2, 5, 0, 0);
+    OBMC_FILTER (x+6, 1, 0, 5, 2, 0);
+    OBMC_FILTER (x+7, 1, 0, 5, 2, 0);
+    x+= stride;
+    OBMC_FILTER4(x  , 1, 2, 5, 0, 0);
+    OBMC_FILTER4(x+2, 1, 1, 6, 0, 0);
+    OBMC_FILTER4(x+4, 1, 0, 6, 1, 0);
+    OBMC_FILTER4(x+6, 1, 0, 5, 2, 0);
+    x+= 2*stride;
+    OBMC_FILTER4(x  , 0, 2, 5, 0, 1);
+    OBMC_FILTER4(x+2, 0, 1, 6, 0, 1);
+    OBMC_FILTER4(x+4, 0, 0, 6, 1, 1);
+    OBMC_FILTER4(x+6, 0, 0, 5, 2, 1);
+    x+= 2*stride;
+    OBMC_FILTER (x  , 0, 2, 5, 0, 1);
+    OBMC_FILTER (x+1, 0, 2, 5, 0, 1);
+    OBMC_FILTER4(x+2, 0, 1, 5, 0, 2);
+    OBMC_FILTER4(x+4, 0, 0, 5, 1, 2);
+    OBMC_FILTER (x+6, 0, 0, 5, 2, 1);
+    OBMC_FILTER (x+7, 0, 0, 5, 2, 1);
+    x+= stride;
+    OBMC_FILTER (x  , 0, 2, 4, 0, 2);
+    OBMC_FILTER (x+1, 0, 1, 5, 0, 2);
+    OBMC_FILTER (x+6, 0, 0, 5, 1, 2);
+    OBMC_FILTER (x+7, 0, 0, 4, 2, 2);
+}
+
+/* obmc for 1 8x8 luma block */
+static inline void obmc_motion(MpegEncContext *s,
+                               uint8_t *dest, uint8_t *src,
+                               int src_x, int src_y,
+                               op_pixels_func *pix_op,
+                               int16_t mv[5][2]/* mid top left right bottom*/)
+#define MID    0
+{
+    int i;
+    uint8_t *ptr[5];
+
+    assert(s->quarter_sample==0);
+
+    for(i=0; i<5; i++){
+        if(i && mv[i][0]==mv[MID][0] && mv[i][1]==mv[MID][1]){
+            ptr[i]= ptr[MID];
+        }else{
+            ptr[i]= s->obmc_scratchpad + 8*(i&1) + s->linesize*8*(i>>1);
+            hpel_motion(s, ptr[i], src, 0, 0,
+                        src_x, src_y,
+                        s->width, s->height, s->linesize,
+                        s->h_edge_pos, s->v_edge_pos,
+                        8, 8, pix_op,
+                        mv[i][0], mv[i][1]);
+        }
+    }
+
+    put_obmc(dest, ptr, s->linesize);
+}
+
+static inline void qpel_motion(MpegEncContext *s,
+                               uint8_t *dest_y, uint8_t *dest_cb, uint8_t *dest_cr,
+                               int field_based, int bottom_field, int field_select,
+                               uint8_t **ref_picture, op_pixels_func (*pix_op)[4],
+                               qpel_mc_func (*qpix_op)[16],
+                               int motion_x, int motion_y, int h)
+{
+    uint8_t *ptr_y, *ptr_cb, *ptr_cr;
+    int dxy, uvdxy, mx, my, src_x, src_y, uvsrc_x, uvsrc_y, v_edge_pos, linesize, uvlinesize;
+
+    dxy = ((motion_y & 3) << 2) | (motion_x & 3);
+    src_x = s->mb_x *  16                 + (motion_x >> 2);
+    src_y = s->mb_y * (16 >> field_based) + (motion_y >> 2);
+
+    v_edge_pos = s->v_edge_pos >> field_based;
+    linesize = s->linesize << field_based;
+    uvlinesize = s->uvlinesize << field_based;
+
+    if(field_based){
+        mx= motion_x/2;
+        my= motion_y>>1;
+    }else if(s->workaround_bugs&FF_BUG_QPEL_CHROMA2){
+        static const int rtab[8]= {0,0,1,1,0,0,0,1};
+        mx= (motion_x>>1) + rtab[motion_x&7];
+        my= (motion_y>>1) + rtab[motion_y&7];
+    }else if(s->workaround_bugs&FF_BUG_QPEL_CHROMA){
+        mx= (motion_x>>1)|(motion_x&1);
+        my= (motion_y>>1)|(motion_y&1);
+    }else{
+        mx= motion_x/2;
+        my= motion_y/2;
+    }
+    mx= (mx>>1)|(mx&1);
+    my= (my>>1)|(my&1);
+
+    uvdxy= (mx&1) | ((my&1)<<1);
+    mx>>=1;
+    my>>=1;
+
+    uvsrc_x = s->mb_x *  8                 + mx;
+    uvsrc_y = s->mb_y * (8 >> field_based) + my;
+
+    ptr_y  = ref_picture[0] +   src_y *   linesize +   src_x;
+    ptr_cb = ref_picture[1] + uvsrc_y * uvlinesize + uvsrc_x;
+    ptr_cr = ref_picture[2] + uvsrc_y * uvlinesize + uvsrc_x;
+
+    if(   (unsigned)src_x > s->h_edge_pos - (motion_x&3) - 16
+       || (unsigned)src_y >    v_edge_pos - (motion_y&3) - h  ){
+        ff_emulated_edge_mc(s->edge_emu_buffer, ptr_y, s->linesize, 17, 17+field_based,
+                         src_x, src_y<<field_based, s->h_edge_pos, s->v_edge_pos);
+        ptr_y= s->edge_emu_buffer;
+        if(!(s->flags&CODEC_FLAG_GRAY)){
+            uint8_t *uvbuf= s->edge_emu_buffer + 18*s->linesize;
+            ff_emulated_edge_mc(uvbuf, ptr_cb, s->uvlinesize, 9, 9 + field_based,
+                             uvsrc_x, uvsrc_y<<field_based, s->h_edge_pos>>1, s->v_edge_pos>>1);
+            ff_emulated_edge_mc(uvbuf + 16, ptr_cr, s->uvlinesize, 9, 9 + field_based,
+                             uvsrc_x, uvsrc_y<<field_based, s->h_edge_pos>>1, s->v_edge_pos>>1);
+            ptr_cb= uvbuf;
+            ptr_cr= uvbuf + 16;
+        }
+    }
+
+    if(!field_based)
+        qpix_op[0][dxy](dest_y, ptr_y, linesize);
+    else{
+        if(bottom_field){
+            dest_y += s->linesize;
+            dest_cb+= s->uvlinesize;
+            dest_cr+= s->uvlinesize;
+        }
+
+        if(field_select){
+            ptr_y  += s->linesize;
+            ptr_cb += s->uvlinesize;
+            ptr_cr += s->uvlinesize;
+        }
+        //damn interlaced mode
+        //FIXME boundary mirroring is not exactly correct here
+        qpix_op[1][dxy](dest_y  , ptr_y  , linesize);
+        qpix_op[1][dxy](dest_y+8, ptr_y+8, linesize);
+    }
+    if(!(s->flags&CODEC_FLAG_GRAY)){
+        pix_op[1][uvdxy](dest_cr, ptr_cr, uvlinesize, h >> 1);
+        pix_op[1][uvdxy](dest_cb, ptr_cb, uvlinesize, h >> 1);
+    }
+}
+
+/**
+ * h263 chorma 4mv motion compensation.
+ */
+static inline void chroma_4mv_motion(MpegEncContext *s,
+                                     uint8_t *dest_cb, uint8_t *dest_cr,
+                                     uint8_t **ref_picture,
+                                     op_pixels_func *pix_op,
+                                     int mx, int my){
+    int dxy, emu=0, src_x, src_y, offset;
+    uint8_t *ptr;
+
+    /* In case of 8X8, we construct a single chroma motion vector
+       with a special rounding */
+    mx= ff_h263_round_chroma(mx);
+    my= ff_h263_round_chroma(my);
+
+    dxy = ((my & 1) << 1) | (mx & 1);
+    mx >>= 1;
+    my >>= 1;
+
+    src_x = s->mb_x * 8 + mx;
+    src_y = s->mb_y * 8 + my;
+    src_x = av_clip(src_x, -8, s->width/2);
+    if (src_x == s->width/2)
+        dxy &= ~1;
+    src_y = av_clip(src_y, -8, s->height/2);
+    if (src_y == s->height/2)
+        dxy &= ~2;
+
+    offset = (src_y * (s->uvlinesize)) + src_x;
+    ptr = ref_picture[1] + offset;
+    if(s->flags&CODEC_FLAG_EMU_EDGE){
+        if(   (unsigned)src_x > (s->h_edge_pos>>1) - (dxy &1) - 8
+           || (unsigned)src_y > (s->v_edge_pos>>1) - (dxy>>1) - 8){
+            ff_emulated_edge_mc(s->edge_emu_buffer, ptr, s->uvlinesize, 9, 9, src_x, src_y, s->h_edge_pos>>1, s->v_edge_pos>>1);
+            ptr= s->edge_emu_buffer;
+            emu=1;
+        }
+    }
+    pix_op[dxy](dest_cb, ptr, s->uvlinesize, 8);
+
+    ptr = ref_picture[2] + offset;
+    if(emu){
+        ff_emulated_edge_mc(s->edge_emu_buffer, ptr, s->uvlinesize, 9, 9, src_x, src_y, s->h_edge_pos>>1, s->v_edge_pos>>1);
+        ptr= s->edge_emu_buffer;
+    }
+    pix_op[dxy](dest_cr, ptr, s->uvlinesize, 8);
+}
+
+static inline void prefetch_motion(MpegEncContext *s, uint8_t **pix, int dir){
+    /* fetch pixels for estimated mv 4 macroblocks ahead
+     * optimized for 64byte cache lines */
+    const int shift = s->quarter_sample ? 2 : 1;
+    const int mx= (s->mv[dir][0][0]>>shift) + 16*s->mb_x + 8;
+    const int my= (s->mv[dir][0][1]>>shift) + 16*s->mb_y;
+    int off= mx + (my + (s->mb_x&3)*4)*s->linesize + 64;
+    s->dsp.prefetch(pix[0]+off, s->linesize, 4);
+    off= (mx>>1) + ((my>>1) + (s->mb_x&7))*s->uvlinesize + 64;
+    s->dsp.prefetch(pix[1]+off, pix[2]-pix[1], 2);
+}
+
+/**
+ * motion compensation of a single macroblock
+ * @param s context
+ * @param dest_y luma destination pointer
+ * @param dest_cb chroma cb/u destination pointer
+ * @param dest_cr chroma cr/v destination pointer
+ * @param dir direction (0->forward, 1->backward)
+ * @param ref_picture array[3] of pointers to the 3 planes of the reference picture
+ * @param pic_op halfpel motion compensation function (average or put normally)
+ * @param pic_op qpel motion compensation function (average or put normally)
+ * the motion vectors are taken from s->mv and the MV type from s->mv_type
+ */
+static inline void MPV_motion(MpegEncContext *s,
+                              uint8_t *dest_y, uint8_t *dest_cb, uint8_t *dest_cr,
+                              int dir, uint8_t **ref_picture,
+                              op_pixels_func (*pix_op)[4], qpel_mc_func (*qpix_op)[16])
+{
+    int dxy, mx, my, src_x, src_y, motion_x, motion_y;
+    int mb_x, mb_y, i;
+    uint8_t *ptr, *dest;
+
+    mb_x = s->mb_x;
+    mb_y = s->mb_y;
+
+    prefetch_motion(s, ref_picture, dir);
+
+    if(s->obmc && s->pict_type != B_TYPE){
+        int16_t mv_cache[4][4][2];
+        const int xy= s->mb_x + s->mb_y*s->mb_stride;
+        const int mot_stride= s->b8_stride;
+        const int mot_xy= mb_x*2 + mb_y*2*mot_stride;
+
+        assert(!s->mb_skipped);
+
+        memcpy(mv_cache[1][1], s->current_picture.motion_val[0][mot_xy           ], sizeof(int16_t)*4);
+        memcpy(mv_cache[2][1], s->current_picture.motion_val[0][mot_xy+mot_stride], sizeof(int16_t)*4);
+        memcpy(mv_cache[3][1], s->current_picture.motion_val[0][mot_xy+mot_stride], sizeof(int16_t)*4);
+
+        if(mb_y==0 || IS_INTRA(s->current_picture.mb_type[xy-s->mb_stride])){
+            memcpy(mv_cache[0][1], mv_cache[1][1], sizeof(int16_t)*4);
+        }else{
+            memcpy(mv_cache[0][1], s->current_picture.motion_val[0][mot_xy-mot_stride], sizeof(int16_t)*4);
+        }
+
+        if(mb_x==0 || IS_INTRA(s->current_picture.mb_type[xy-1])){
+            *(int32_t*)mv_cache[1][0]= *(int32_t*)mv_cache[1][1];
+            *(int32_t*)mv_cache[2][0]= *(int32_t*)mv_cache[2][1];
+        }else{
+            *(int32_t*)mv_cache[1][0]= *(int32_t*)s->current_picture.motion_val[0][mot_xy-1];
+            *(int32_t*)mv_cache[2][0]= *(int32_t*)s->current_picture.motion_val[0][mot_xy-1+mot_stride];
+        }
+
+        if(mb_x+1>=s->mb_width || IS_INTRA(s->current_picture.mb_type[xy+1])){
+            *(int32_t*)mv_cache[1][3]= *(int32_t*)mv_cache[1][2];
+            *(int32_t*)mv_cache[2][3]= *(int32_t*)mv_cache[2][2];
+        }else{
+            *(int32_t*)mv_cache[1][3]= *(int32_t*)s->current_picture.motion_val[0][mot_xy+2];
+            *(int32_t*)mv_cache[2][3]= *(int32_t*)s->current_picture.motion_val[0][mot_xy+2+mot_stride];
+        }
+
+        mx = 0;
+        my = 0;
+        for(i=0;i<4;i++) {
+            const int x= (i&1)+1;
+            const int y= (i>>1)+1;
+            int16_t mv[5][2]= {
+                {mv_cache[y][x  ][0], mv_cache[y][x  ][1]},
+                {mv_cache[y-1][x][0], mv_cache[y-1][x][1]},
+                {mv_cache[y][x-1][0], mv_cache[y][x-1][1]},
+                {mv_cache[y][x+1][0], mv_cache[y][x+1][1]},
+                {mv_cache[y+1][x][0], mv_cache[y+1][x][1]}};
+            //FIXME cleanup
+            obmc_motion(s, dest_y + ((i & 1) * 8) + (i >> 1) * 8 * s->linesize,
+                        ref_picture[0],
+                        mb_x * 16 + (i & 1) * 8, mb_y * 16 + (i >>1) * 8,
+                        pix_op[1],
+                        mv);
+
+            mx += mv[0][0];
+            my += mv[0][1];
+        }
+        if(!(s->flags&CODEC_FLAG_GRAY))
+            chroma_4mv_motion(s, dest_cb, dest_cr, ref_picture, pix_op[1], mx, my);
+
+        return;
+    }
+
+    switch(s->mv_type) {
+    case MV_TYPE_16X16:
+        if(s->mcsel){
+            if(s->real_sprite_warping_points==1){
+                gmc1_motion(s, dest_y, dest_cb, dest_cr,
+                            ref_picture);
+            }else{
+                gmc_motion(s, dest_y, dest_cb, dest_cr,
+                            ref_picture);
+            }
+        }else if(s->quarter_sample){
+            qpel_motion(s, dest_y, dest_cb, dest_cr,
+                        0, 0, 0,
+                        ref_picture, pix_op, qpix_op,
+                        s->mv[dir][0][0], s->mv[dir][0][1], 16);
+        }else if(ENABLE_WMV2 && s->mspel){
+            ff_mspel_motion(s, dest_y, dest_cb, dest_cr,
+                        ref_picture, pix_op,
+                        s->mv[dir][0][0], s->mv[dir][0][1], 16);
+        }else
+        {
+            mpeg_motion(s, dest_y, dest_cb, dest_cr,
+                        0, 0, 0,
+                        ref_picture, pix_op,
+                        s->mv[dir][0][0], s->mv[dir][0][1], 16);
+        }
+        break;
+    case MV_TYPE_8X8:
+        mx = 0;
+        my = 0;
+        if(s->quarter_sample){
+            for(i=0;i<4;i++) {
+                motion_x = s->mv[dir][i][0];
+                motion_y = s->mv[dir][i][1];
+
+                dxy = ((motion_y & 3) << 2) | (motion_x & 3);
+                src_x = mb_x * 16 + (motion_x >> 2) + (i & 1) * 8;
+                src_y = mb_y * 16 + (motion_y >> 2) + (i >>1) * 8;
+
+                /* WARNING: do no forget half pels */
+                src_x = av_clip(src_x, -16, s->width);
+                if (src_x == s->width)
+                    dxy &= ~3;
+                src_y = av_clip(src_y, -16, s->height);
+                if (src_y == s->height)
+                    dxy &= ~12;
+
+                ptr = ref_picture[0] + (src_y * s->linesize) + (src_x);
+                if(s->flags&CODEC_FLAG_EMU_EDGE){
+                    if(   (unsigned)src_x > s->h_edge_pos - (motion_x&3) - 8
+                       || (unsigned)src_y > s->v_edge_pos - (motion_y&3) - 8 ){
+                        ff_emulated_edge_mc(s->edge_emu_buffer, ptr, s->linesize, 9, 9, src_x, src_y, s->h_edge_pos, s->v_edge_pos);
+                        ptr= s->edge_emu_buffer;
+                    }
+                }
+                dest = dest_y + ((i & 1) * 8) + (i >> 1) * 8 * s->linesize;
+                qpix_op[1][dxy](dest, ptr, s->linesize);
+
+                mx += s->mv[dir][i][0]/2;
+                my += s->mv[dir][i][1]/2;
+            }
+        }else{
+            for(i=0;i<4;i++) {
+                hpel_motion(s, dest_y + ((i & 1) * 8) + (i >> 1) * 8 * s->linesize,
+                            ref_picture[0], 0, 0,
+                            mb_x * 16 + (i & 1) * 8, mb_y * 16 + (i >>1) * 8,
+                            s->width, s->height, s->linesize,
+                            s->h_edge_pos, s->v_edge_pos,
+                            8, 8, pix_op[1],
+                            s->mv[dir][i][0], s->mv[dir][i][1]);
+
+                mx += s->mv[dir][i][0];
+                my += s->mv[dir][i][1];
+            }
+        }
+
+        if(!(s->flags&CODEC_FLAG_GRAY))
+            chroma_4mv_motion(s, dest_cb, dest_cr, ref_picture, pix_op[1], mx, my);
+        break;
+    case MV_TYPE_FIELD:
+        if (s->picture_structure == PICT_FRAME) {
+            if(s->quarter_sample){
+                for(i=0; i<2; i++){
+                    qpel_motion(s, dest_y, dest_cb, dest_cr,
+                                1, i, s->field_select[dir][i],
+                                ref_picture, pix_op, qpix_op,
+                                s->mv[dir][i][0], s->mv[dir][i][1], 8);
+                }
+            }else{
+                /* top field */
+                mpeg_motion(s, dest_y, dest_cb, dest_cr,
+                            1, 0, s->field_select[dir][0],
+                            ref_picture, pix_op,
+                            s->mv[dir][0][0], s->mv[dir][0][1], 8);
+                /* bottom field */
+                mpeg_motion(s, dest_y, dest_cb, dest_cr,
+                            1, 1, s->field_select[dir][1],
+                            ref_picture, pix_op,
+                            s->mv[dir][1][0], s->mv[dir][1][1], 8);
+            }
+        } else {
+            if(s->picture_structure != s->field_select[dir][0] + 1 && s->pict_type != B_TYPE && !s->first_field){
+                ref_picture= s->current_picture_ptr->data;
+            }
+
+            mpeg_motion(s, dest_y, dest_cb, dest_cr,
+                        0, 0, s->field_select[dir][0],
+                        ref_picture, pix_op,
+                        s->mv[dir][0][0], s->mv[dir][0][1], 16);
+        }
+        break;
+    case MV_TYPE_16X8:
+        for(i=0; i<2; i++){
+            uint8_t ** ref2picture;
+
+            if(s->picture_structure == s->field_select[dir][i] + 1 || s->pict_type == B_TYPE || s->first_field){
+                ref2picture= ref_picture;
+            }else{
+                ref2picture= s->current_picture_ptr->data;
+            }
+
+            mpeg_motion(s, dest_y, dest_cb, dest_cr,
+                        0, 0, s->field_select[dir][i],
+                        ref2picture, pix_op,
+                        s->mv[dir][i][0], s->mv[dir][i][1] + 16*i, 8);
+
+            dest_y += 16*s->linesize;
+            dest_cb+= (16>>s->chroma_y_shift)*s->uvlinesize;
+            dest_cr+= (16>>s->chroma_y_shift)*s->uvlinesize;
+        }
+        break;
+    case MV_TYPE_DMV:
+        if(s->picture_structure == PICT_FRAME){
+            for(i=0; i<2; i++){
+                int j;
+                for(j=0; j<2; j++){
+                    mpeg_motion(s, dest_y, dest_cb, dest_cr,
+                                1, j, j^i,
+                                ref_picture, pix_op,
+                                s->mv[dir][2*i + j][0], s->mv[dir][2*i + j][1], 8);
+                }
+                pix_op = s->dsp.avg_pixels_tab;
+            }
+        }else{
+            for(i=0; i<2; i++){
+                mpeg_motion(s, dest_y, dest_cb, dest_cr,
+                            0, 0, s->picture_structure != i+1,
+                            ref_picture, pix_op,
+                            s->mv[dir][2*i][0],s->mv[dir][2*i][1],16);
+
+                // after put we make avg of the same block
+                pix_op=s->dsp.avg_pixels_tab;
+
+                //opposite parity is always in the same frame if this is second field
+                if(!s->first_field){
+                    ref_picture = s->current_picture_ptr->data;
+                }
+            }
+        }
+    break;
+    default: assert(0);
+    }
+}
+
+#endif /* MPEGVIDEO_COMMON_H */

Added: branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec/msmpeg4.h
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec/msmpeg4.h	2007-07-16 18:08:14 UTC (rev 3389)
+++ branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec/msmpeg4.h	2007-07-16 18:11:38 UTC (rev 3390)
@@ -0,0 +1,44 @@
+/*
+ * MSMPEG4 backend for ffmpeg encoder and decoder
+ * copyright (c) 2007 Aurelien Jacobs <aurel at gnuage.org>
+ *
+ * This file is part of FFmpeg.
+ *
+ * FFmpeg is free software; you can redistribute it and/or
+ * modify it under the terms of the GNU Lesser General Public
+ * License as published by the Free Software Foundation; either
+ * version 2.1 of the License, or (at your option) any later version.
+ *
+ * FFmpeg is distributed in the hope that it will be useful,
+ * but WITHOUT ANY WARRANTY; without even the implied warranty of
+ * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ * Lesser General Public License for more details.
+ *
+ * You should have received a copy of the GNU Lesser General Public
+ * License along with FFmpeg; if not, write to the Free Software
+ * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA
+ */
+
+/**
+ * @file msmpeg4.h
+ */
+
+#ifndef MSMPEG4_H
+#define MSMPEG4_H
+
+#include "config.h"
+
+#define ENABLE_MSMPEG4_DECODER (ENABLE_MSMPEG4V1_DECODER || \
+                                ENABLE_MSMPEG4V2_DECODER || \
+                                ENABLE_MSMPEG4V3_DECODER || \
+                                ENABLE_WMV2_DECODER)
+#define ENABLE_MSMPEG4_ENCODER (ENABLE_MSMPEG4V1_ENCODER || \
+                                ENABLE_MSMPEG4V2_ENCODER || \
+                                ENABLE_MSMPEG4V3_ENCODER || \
+                                ENABLE_WMV2_ENCODER)
+#define ENABLE_MSMPEG4 (ENABLE_MSMPEG4_DECODER || ENABLE_MSMPEG4_ENCODER)
+#define ENABLE_WMV2 (ENABLE_WMV2_DECODER || ENABLE_WMV2_ENCODER)
+#define ENABLE_WMV_DECODER (ENABLE_WMV1_DECODER || ENABLE_WMV2_DECODER)
+#define ENABLE_WMV_ENCODER (ENABLE_WMV1_ENCODER || ENABLE_WMV2_ENCODER)
+
+#endif /* MSMPEG4_H */

Added: branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec/roqvideo.h
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec/roqvideo.h	2007-07-16 18:08:14 UTC (rev 3389)
+++ branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec/roqvideo.h	2007-07-16 18:11:38 UTC (rev 3390)
@@ -0,0 +1,92 @@
+/*
+ * Copyright (C) 2003 Mike Melanson
+ * Copyright (C) 2003 Dr. Tim Ferguson
+ *
+ * This file is part of FFmpeg.
+ *
+ * FFmpeg is free software; you can redistribute it and/or
+ * modify it under the terms of the GNU Lesser General Public
+ * License as published by the Free Software Foundation; either
+ * version 2.1 of the License, or (at your option) any later version.
+ *
+ * FFmpeg is distributed in the hope that it will be useful,
+ * but WITHOUT ANY WARRANTY; without even the implied warranty of
+ * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ * Lesser General Public License for more details.
+ *
+ * You should have received a copy of the GNU Lesser General Public
+ * License along with FFmpeg; if not, write to the Free Software
+ * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA
+ */
+
+#ifndef AVCODEC_ROQVIDEO_H
+#define AVCODEC_ROQVIDEO_H
+
+#include "avcodec.h"
+#include "dsputil.h"
+#include "random.h"
+
+typedef struct {
+    unsigned char y[4];
+    unsigned char u, v;
+} roq_cell;
+
+typedef struct {
+    int idx[4];
+} roq_qcell;
+
+typedef struct {
+    int d[2];
+} motion_vect;
+
+typedef struct RoqContext {
+
+    AVCodecContext *avctx;
+    DSPContext dsp;
+    AVFrame frames[2];
+    AVFrame *last_frame;
+    AVFrame *current_frame;
+    int first_frame;
+
+    roq_cell cb2x2[256];
+    roq_qcell cb4x4[256];
+
+    unsigned char *buf;
+    int size;
+    int width, height;
+
+    /* Encoder only data */
+    AVRandomState randctx;
+    uint64_t lambda;
+
+    motion_vect *this_motion4;
+    motion_vect *last_motion4;
+
+    motion_vect *this_motion8;
+    motion_vect *last_motion8;
+
+    unsigned int framesSinceKeyframe;
+
+    AVFrame *frame_to_enc;
+    uint8_t *out_buf;
+} RoqContext;
+
+#define RoQ_INFO              0x1001
+#define RoQ_QUAD_CODEBOOK     0x1002
+#define RoQ_QUAD_VQ           0x1011
+#define RoQ_SOUND_MONO        0x1020
+#define RoQ_SOUND_STEREO      0x1021
+
+#define RoQ_ID_MOT              0x00
+#define RoQ_ID_FCC              0x01
+#define RoQ_ID_SLD              0x02
+#define RoQ_ID_CCC              0x03
+
+void ff_apply_vector_2x2(RoqContext *ri, int x, int y, roq_cell *cell);
+void ff_apply_vector_4x4(RoqContext *ri, int x, int y, roq_cell *cell);
+
+void ff_apply_motion_4x4(RoqContext *ri, int x, int y, int deltax, int deltay);
+
+void ff_apply_motion_8x8(RoqContext *ri, int x, int y, int deltax, int deltay);
+
+#endif // AVCODEC_ROQVIDEO_H

Added: branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec/vc1.h
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec/vc1.h	2007-07-16 18:08:14 UTC (rev 3389)
+++ branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec/vc1.h	2007-07-16 18:11:38 UTC (rev 3390)
@@ -0,0 +1,307 @@
+/*
+ * VC-1 and WMV3 decoder
+ * Copyright (c) 2006-2007 Konstantin Shishkov
+ * Partly based on vc9.c (c) 2005 Anonymous, Alex Beregszaszi, Michael Niedermayer
+ *
+ * This file is part of FFmpeg.
+ *
+ * FFmpeg is free software; you can redistribute it and/or
+ * modify it under the terms of the GNU Lesser General Public
+ * License as published by the Free Software Foundation; either
+ * version 2.1 of the License, or (at your option) any later version.
+ *
+ * FFmpeg is distributed in the hope that it will be useful,
+ * but WITHOUT ANY WARRANTY; without even the implied warranty of
+ * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ * Lesser General Public License for more details.
+ *
+ * You should have received a copy of the GNU Lesser General Public
+ * License along with FFmpeg; if not, write to the Free Software
+ * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA
+ */
+
+#ifndef AVCODEC_VC1_H
+#define AVCODEC_VC1_H
+
+#include "avcodec.h"
+#include "mpegvideo.h"
+
+/** Markers used in VC-1 AP frame data */
+//@{
+enum VC1Code{
+    VC1_CODE_RES0       = 0x00000100,
+    VC1_CODE_ENDOFSEQ   = 0x0000010A,
+    VC1_CODE_SLICE,
+    VC1_CODE_FIELD,
+    VC1_CODE_FRAME,
+    VC1_CODE_ENTRYPOINT,
+    VC1_CODE_SEQHDR,
+};
+//@}
+
+#define IS_MARKER(x) (((x) & ~0xFF) == VC1_CODE_RES0)
+
+/** Available Profiles */
+//@{
+enum Profile {
+    PROFILE_SIMPLE,
+    PROFILE_MAIN,
+    PROFILE_COMPLEX, ///< TODO: WMV9 specific
+    PROFILE_ADVANCED
+};
+//@}
+
+/** Sequence quantizer mode */
+//@{
+enum QuantMode {
+    QUANT_FRAME_IMPLICIT,    ///< Implicitly specified at frame level
+    QUANT_FRAME_EXPLICIT,    ///< Explicitly specified at frame level
+    QUANT_NON_UNIFORM,       ///< Non-uniform quant used for all frames
+    QUANT_UNIFORM            ///< Uniform quant used for all frames
+};
+//@}
+
+/** Where quant can be changed */
+//@{
+enum DQProfile {
+    DQPROFILE_FOUR_EDGES,
+    DQPROFILE_DOUBLE_EDGES,
+    DQPROFILE_SINGLE_EDGE,
+    DQPROFILE_ALL_MBS
+};
+//@}
+
+/** @name Where quant can be changed
+ */
+//@{
+enum DQSingleEdge {
+    DQSINGLE_BEDGE_LEFT,
+    DQSINGLE_BEDGE_TOP,
+    DQSINGLE_BEDGE_RIGHT,
+    DQSINGLE_BEDGE_BOTTOM
+};
+//@}
+
+/** Which pair of edges is quantized with ALTPQUANT */
+//@{
+enum DQDoubleEdge {
+    DQDOUBLE_BEDGE_TOPLEFT,
+    DQDOUBLE_BEDGE_TOPRIGHT,
+    DQDOUBLE_BEDGE_BOTTOMRIGHT,
+    DQDOUBLE_BEDGE_BOTTOMLEFT
+};
+//@}
+
+/** MV modes for P frames */
+//@{
+enum MVModes {
+    MV_PMODE_1MV_HPEL_BILIN,
+    MV_PMODE_1MV,
+    MV_PMODE_1MV_HPEL,
+    MV_PMODE_MIXED_MV,
+    MV_PMODE_INTENSITY_COMP
+};
+//@}
+
+/** @name MV types for B frames */
+//@{
+enum BMVTypes {
+    BMV_TYPE_BACKWARD,
+    BMV_TYPE_FORWARD,
+    BMV_TYPE_INTERPOLATED
+};
+//@}
+
+/** @name Block types for P/B frames */
+//@{
+enum TransformTypes {
+    TT_8X8,
+    TT_8X4_BOTTOM,
+    TT_8X4_TOP,
+    TT_8X4, //Both halves
+    TT_4X8_RIGHT,
+    TT_4X8_LEFT,
+    TT_4X8, //Both halves
+    TT_4X4
+};
+//@}
+
+/** One more frame type */
+#define BI_TYPE 7
+
+enum CodingSet {
+    CS_HIGH_MOT_INTRA = 0,
+    CS_HIGH_MOT_INTER,
+    CS_LOW_MOT_INTRA,
+    CS_LOW_MOT_INTER,
+    CS_MID_RATE_INTRA,
+    CS_MID_RATE_INTER,
+    CS_HIGH_RATE_INTRA,
+    CS_HIGH_RATE_INTER
+};
+
+/** @name Overlap conditions for Advanced Profile */
+//@{
+enum COTypes {
+    CONDOVER_NONE = 0,
+    CONDOVER_ALL,
+    CONDOVER_SELECT
+};
+//@}
+
+
+/** The VC1 Context
+ * @todo Change size wherever another size is more efficient
+ * Many members are only used for Advanced Profile
+ */
+typedef struct VC1Context{
+    MpegEncContext s;
+
+    int bits;
+
+    /** Simple/Main Profile sequence header */
+    //@{
+    int res_sm;           ///< reserved, 2b
+    int res_x8;           ///< reserved
+    int multires;         ///< frame-level RESPIC syntax element present
+    int res_fasttx;       ///< reserved, always 1
+    int res_transtab;     ///< reserved, always 0
+    int rangered;         ///< RANGEREDFRM (range reduction) syntax element present
+                          ///< at frame level
+    int res_rtm_flag;     ///< reserved, set to 1
+    int reserved;         ///< reserved
+    //@}
+
+    /** Advanced Profile */
+    //@{
+    int level;            ///< 3bits, for Advanced/Simple Profile, provided by TS layer
+    int chromaformat;     ///< 2bits, 2=4:2:0, only defined
+    int postprocflag;     ///< Per-frame processing suggestion flag present
+    int broadcast;        ///< TFF/RFF present
+    int interlace;        ///< Progressive/interlaced (RPTFTM syntax element)
+    int tfcntrflag;       ///< TFCNTR present
+    int panscanflag;      ///< NUMPANSCANWIN, TOPLEFT{X,Y}, BOTRIGHT{X,Y} present
+    int extended_dmv;     ///< Additional extended dmv range at P/B frame-level
+    int color_prim;       ///< 8bits, chroma coordinates of the color primaries
+    int transfer_char;    ///< 8bits, Opto-electronic transfer characteristics
+    int matrix_coef;      ///< 8bits, Color primaries->YCbCr transform matrix
+    int hrd_param_flag;   ///< Presence of Hypothetical Reference
+                          ///< Decoder parameters
+    int psf;              ///< Progressive Segmented Frame
+    //@}
+
+    /** Sequence header data for all Profiles
+     * TODO: choose between ints, uint8_ts and monobit flags
+     */
+    //@{
+    int profile;          ///< 2bits, Profile
+    int frmrtq_postproc;  ///< 3bits,
+    int bitrtq_postproc;  ///< 5bits, quantized framerate-based postprocessing strength
+    int fastuvmc;         ///< Rounding of qpel vector to hpel ? (not in Simple)
+    int extended_mv;      ///< Ext MV in P/B (not in Simple)
+    int dquant;           ///< How qscale varies with MBs, 2bits (not in Simple)
+    int vstransform;      ///< variable-size [48]x[48] transform type + info
+    int overlap;          ///< overlapped transforms in use
+    int quantizer_mode;   ///< 2bits, quantizer mode used for sequence, see QUANT_*
+    int finterpflag;      ///< INTERPFRM present
+    //@}
+
+    /** Frame decoding info for all profiles */
+    //@{
+    uint8_t mv_mode;      ///< MV coding monde
+    uint8_t mv_mode2;     ///< Secondary MV coding mode (B frames)
+    int k_x;              ///< Number of bits for MVs (depends on MV range)
+    int k_y;              ///< Number of bits for MVs (depends on MV range)
+    int range_x, range_y; ///< MV range
+    uint8_t pq, altpq;    ///< Current/alternate frame quantizer scale
+    /** pquant parameters */
+    //@{
+    uint8_t dquantfrm;
+    uint8_t dqprofile;
+    uint8_t dqsbedge;
+    uint8_t dqbilevel;
+    //@}
+    /** AC coding set indexes
+     * @see 8.1.1.10, p(1)10
+     */
+    //@{
+    int c_ac_table_index; ///< Chroma index from ACFRM element
+    int y_ac_table_index; ///< Luma index from AC2FRM element
+    //@}
+    int ttfrm;            ///< Transform type info present at frame level
+    uint8_t ttmbf;        ///< Transform type flag
+    uint8_t ttblk4x4;     ///< Value of ttblk which indicates a 4x4 transform
+    int codingset;        ///< index of current table set from 11.8 to use for luma block decoding
+    int codingset2;       ///< index of current table set from 11.8 to use for chroma block decoding
+    int pqindex;          ///< raw pqindex used in coding set selection
+    int a_avail, c_avail;
+    uint8_t *mb_type_base, *mb_type[3];
+
+
+    /** Luma compensation parameters */
+    //@{
+    uint8_t lumscale;
+    uint8_t lumshift;
+    //@}
+    int16_t bfraction;    ///< Relative position % anchors=> how to scale MVs
+    uint8_t halfpq;       ///< Uniform quant over image and qp+.5
+    uint8_t respic;       ///< Frame-level flag for resized images
+    int buffer_fullness;  ///< HRD info
+    /** Ranges:
+     * -# 0 -> [-64n 63.f] x [-32, 31.f]
+     * -# 1 -> [-128, 127.f] x [-64, 63.f]
+     * -# 2 -> [-512, 511.f] x [-128, 127.f]
+     * -# 3 -> [-1024, 1023.f] x [-256, 255.f]
+     */
+    uint8_t mvrange;
+    uint8_t pquantizer;           ///< Uniform (over sequence) quantizer in use
+    VLC *cbpcy_vlc;               ///< CBPCY VLC table
+    int tt_index;                 ///< Index for Transform Type tables
+    uint8_t* mv_type_mb_plane;    ///< bitplane for mv_type == (4MV)
+    uint8_t* direct_mb_plane;     ///< bitplane for "direct" MBs
+    int mv_type_is_raw;           ///< mv type mb plane is not coded
+    int dmb_is_raw;               ///< direct mb plane is raw
+    int skip_is_raw;              ///< skip mb plane is not coded
+    uint8_t luty[256], lutuv[256]; // lookup tables used for intensity compensation
+    int use_ic;                   ///< use intensity compensation in B-frames
+    int rnd;                      ///< rounding control
+
+    /** Frame decoding info for S/M profiles only */
+    //@{
+    uint8_t rangeredfrm; ///< out_sample = CLIP((in_sample-128)*2+128)
+    uint8_t interpfrm;
+    //@}
+
+    /** Frame decoding info for Advanced profile */
+    //@{
+    uint8_t fcm; ///< 0->Progressive, 2->Frame-Interlace, 3->Field-Interlace
+    uint8_t numpanscanwin;
+    uint8_t tfcntr;
+    uint8_t rptfrm, tff, rff;
+    uint16_t topleftx;
+    uint16_t toplefty;
+    uint16_t bottomrightx;
+    uint16_t bottomrighty;
+    uint8_t uvsamp;
+    uint8_t postproc;
+    int hrd_num_leaky_buckets;
+    uint8_t bit_rate_exponent;
+    uint8_t buffer_size_exponent;
+    uint8_t* acpred_plane;       ///< AC prediction flags bitplane
+    int acpred_is_raw;
+    uint8_t* over_flags_plane;   ///< Overflags bitplane
+    int overflg_is_raw;
+    uint8_t condover;
+    uint16_t *hrd_rate, *hrd_buffer;
+    uint8_t *hrd_fullness;
+    uint8_t range_mapy_flag;
+    uint8_t range_mapuv_flag;
+    uint8_t range_mapy;
+    uint8_t range_mapuv;
+    //@}
+
+    int p_frame_skipped;
+    int bi_type;
+} VC1Context;
+
+#endif // AVCODEC_VC1_H

Added: branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec/wma.h
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec/wma.h	2007-07-16 18:08:14 UTC (rev 3389)
+++ branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec/wma.h	2007-07-16 18:11:38 UTC (rev 3390)
@@ -0,0 +1,150 @@
+/*
+ * WMA compatible codec
+ * Copyright (c) 2002-2007 The FFmpeg Project.
+ *
+ * This file is part of FFmpeg.
+ *
+ * FFmpeg is free software; you can redistribute it and/or
+ * modify it under the terms of the GNU Lesser General Public
+ * License as published by the Free Software Foundation; either
+ * version 2.1 of the License, or (at your option) any later version.
+ *
+ * FFmpeg is distributed in the hope that it will be useful,
+ * but WITHOUT ANY WARRANTY; without even the implied warranty of
+ * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ * Lesser General Public License for more details.
+ *
+ * You should have received a copy of the GNU Lesser General Public
+ * License along with FFmpeg; if not, write to the Free Software
+ * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA
+ */
+
+#ifndef WMA_H
+#define WMA_H
+
+#include "bitstream.h"
+#include "dsputil.h"
+
+/* size of blocks */
+#define BLOCK_MIN_BITS 7
+#define BLOCK_MAX_BITS 11
+#define BLOCK_MAX_SIZE (1 << BLOCK_MAX_BITS)
+
+#define BLOCK_NB_SIZES (BLOCK_MAX_BITS - BLOCK_MIN_BITS + 1)
+
+/* XXX: find exact max size */
+#define HIGH_BAND_MAX_SIZE 16
+
+#define NB_LSP_COEFS 10
+
+/* XXX: is it a suitable value ? */
+#define MAX_CODED_SUPERFRAME_SIZE 16384
+
+#define MAX_CHANNELS 2
+
+#define NOISE_TAB_SIZE 8192
+
+#define LSP_POW_BITS 7
+
+//FIXME should be in wmadec
+#define VLCBITS 9
+#define VLCMAX ((22+VLCBITS-1)/VLCBITS)
+
+typedef struct CoefVLCTable {
+    int n;                      ///< total number of codes
+    int max_level;
+    const uint32_t *huffcodes;  ///< VLC bit values
+    const uint8_t *huffbits;    ///< VLC bit size
+    const uint16_t *levels;     ///< table to build run/level tables
+} CoefVLCTable;
+
+typedef struct WMACodecContext {
+    AVCodecContext* avctx;
+    GetBitContext gb;
+    PutBitContext pb;
+    int sample_rate;
+    int nb_channels;
+    int bit_rate;
+    int version;                            ///< 1 = 0x160 (WMAV1), 2 = 0x161 (WMAV2)
+    int block_align;
+    int use_bit_reservoir;
+    int use_variable_block_len;
+    int use_exp_vlc;                        ///< exponent coding: 0 = lsp, 1 = vlc + delta
+    int use_noise_coding;                   ///< true if perceptual noise is added
+    int byte_offset_bits;
+    VLC exp_vlc;
+    int exponent_sizes[BLOCK_NB_SIZES];
+    uint16_t exponent_bands[BLOCK_NB_SIZES][25];
+    int high_band_start[BLOCK_NB_SIZES];    ///< index of first coef in high band
+    int coefs_start;                        ///< first coded coef
+    int coefs_end[BLOCK_NB_SIZES];          ///< max number of coded coefficients
+    int exponent_high_sizes[BLOCK_NB_SIZES];
+    int exponent_high_bands[BLOCK_NB_SIZES][HIGH_BAND_MAX_SIZE];
+    VLC hgain_vlc;
+
+    /* coded values in high bands */
+    int high_band_coded[MAX_CHANNELS][HIGH_BAND_MAX_SIZE];
+    int high_band_values[MAX_CHANNELS][HIGH_BAND_MAX_SIZE];
+
+    /* there are two possible tables for spectral coefficients */
+//FIXME the following 3 tables should be shared between decoders
+    VLC coef_vlc[2];
+    uint16_t *run_table[2];
+    uint16_t *level_table[2];
+    uint16_t *int_table[2];
+    const CoefVLCTable *coef_vlcs[2];
+    /* frame info */
+    int frame_len;                          ///< frame length in samples
+    int frame_len_bits;                     ///< frame_len = 1 << frame_len_bits
+    int nb_block_sizes;                     ///< number of block sizes
+    /* block info */
+    int reset_block_lengths;
+    int block_len_bits;                     ///< log2 of current block length
+    int next_block_len_bits;                ///< log2 of next block length
+    int prev_block_len_bits;                ///< log2 of prev block length
+    int block_len;                          ///< block length in samples
+    int block_num;                          ///< block number in current frame
+    int block_pos;                          ///< current position in frame
+    uint8_t ms_stereo;                      ///< true if mid/side stereo mode
+    uint8_t channel_coded[MAX_CHANNELS];    ///< true if channel is coded
+    int exponents_bsize[MAX_CHANNELS];      ///< log2 ratio frame/exp. length
+    DECLARE_ALIGNED_16(float, exponents[MAX_CHANNELS][BLOCK_MAX_SIZE]);
+    float max_exponent[MAX_CHANNELS];
+    int16_t coefs1[MAX_CHANNELS][BLOCK_MAX_SIZE];
+    DECLARE_ALIGNED_16(float, coefs[MAX_CHANNELS][BLOCK_MAX_SIZE]);
+    DECLARE_ALIGNED_16(FFTSample, output[BLOCK_MAX_SIZE * 2]);
+    MDCTContext mdct_ctx[BLOCK_NB_SIZES];
+    float *windows[BLOCK_NB_SIZES];
+    DECLARE_ALIGNED_16(FFTSample, mdct_tmp[BLOCK_MAX_SIZE]); ///< temporary storage for imdct
+    /* output buffer for one frame and the last for IMDCT windowing */
+    DECLARE_ALIGNED_16(float, frame_out[MAX_CHANNELS][BLOCK_MAX_SIZE * 2]);
+    /* last frame info */
+    uint8_t last_superframe[MAX_CODED_SUPERFRAME_SIZE + 4]; /* padding added */
+    int last_bitoffset;
+    int last_superframe_len;
+    float noise_table[NOISE_TAB_SIZE];
+    int noise_index;
+    float noise_mult; /* XXX: suppress that and integrate it in the noise array */
+    /* lsp_to_curve tables */
+    float lsp_cos_table[BLOCK_MAX_SIZE];
+    float lsp_pow_e_table[256];
+    float lsp_pow_m_table1[(1 << LSP_POW_BITS)];
+    float lsp_pow_m_table2[(1 << LSP_POW_BITS)];
+    DSPContext dsp;
+
+#ifdef TRACE
+    int frame_count;
+#endif
+} WMACodecContext;
+
+extern const uint16_t ff_wma_hgain_huffcodes[37];
+extern const uint8_t ff_wma_hgain_huffbits[37];
+extern const float ff_wma_lsp_codebook[NB_LSP_COEFS][16];
+extern const uint32_t ff_wma_scale_huffcodes[121];
+extern const uint8_t ff_wma_scale_huffbits[121];
+
+int ff_wma_init(AVCodecContext * avctx, int flags2);
+int ff_wma_total_gain_to_bits(int total_gain);
+int ff_wma_end(AVCodecContext *avctx);
+
+#endif



From mean at mail.berlios.de  Mon Jul 16 20:13:25 2007
From: mean at mail.berlios.de (mean at BerliOS)
Date: Mon, 16 Jul 2007 20:13:25 +0200
Subject: [Avidemux-svn-commit] r3391 -
	branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec
Message-ID: <200707161813.l6GIDPAA010543@sheep.berlios.de>

Author: mean
Date: 2007-07-16 20:13:25 +0200 (Mon, 16 Jul 2007)
New Revision: 3391

Added:
   branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec/mjpegenc.h
   branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec/mpeg12.h
   branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec/mpegaudiodata.h
   branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec/xiph.h
Log:
missing files

Added: branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec/mjpegenc.h
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec/mjpegenc.h	2007-07-16 18:11:38 UTC (rev 3390)
+++ branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec/mjpegenc.h	2007-07-16 18:13:25 UTC (rev 3391)
@@ -0,0 +1,60 @@
+/*
+ * MJPEG encoder
+ * Copyright (c) 2000, 2001 Fabrice Bellard.
+ * Copyright (c) 2003 Alex Beregszaszi
+ * Copyright (c) 2003-2004 Michael Niedermayer
+ *
+ * Support for external huffman table, various fixes (AVID workaround),
+ * aspecting, new decode_frame mechanism and apple mjpeg-b support
+ *                                  by Alex Beregszaszi
+ *
+ * This file is part of FFmpeg.
+ *
+ * FFmpeg is free software; you can redistribute it and/or
+ * modify it under the terms of the GNU Lesser General Public
+ * License as published by the Free Software Foundation; either
+ * version 2.1 of the License, or (at your option) any later version.
+ *
+ * FFmpeg is distributed in the hope that it will be useful,
+ * but WITHOUT ANY WARRANTY; without even the implied warranty of
+ * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ * Lesser General Public License for more details.
+ *
+ * You should have received a copy of the GNU Lesser General Public
+ * License along with FFmpeg; if not, write to the Free Software
+ * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA
+ */
+
+/**
+ * @file mjpegenc.h
+ * MJPEG encoder.
+ */
+
+#ifndef MJPEGENC_H
+#define MJPEGENC_H
+
+#include "dsputil.h"
+#include "mpegvideo.h"
+
+typedef struct MJpegContext {
+    uint8_t huff_size_dc_luminance[12]; //FIXME use array [3] instead of lumi / chrom, for easier addressing
+    uint16_t huff_code_dc_luminance[12];
+    uint8_t huff_size_dc_chrominance[12];
+    uint16_t huff_code_dc_chrominance[12];
+
+    uint8_t huff_size_ac_luminance[256];
+    uint16_t huff_code_ac_luminance[256];
+    uint8_t huff_size_ac_chrominance[256];
+    uint16_t huff_code_ac_chrominance[256];
+} MJpegContext;
+
+int  ff_mjpeg_encode_init(MpegEncContext *s);
+void ff_mjpeg_encode_close(MpegEncContext *s);
+void ff_mjpeg_encode_picture_header(MpegEncContext *s);
+void ff_mjpeg_encode_picture_trailer(MpegEncContext *s);
+void ff_mjpeg_encode_stuffing(PutBitContext *pbc);
+void ff_mjpeg_encode_dc(MpegEncContext *s, int val,
+                        uint8_t *huff_size, uint16_t *huff_code);
+void ff_mjpeg_encode_mb(MpegEncContext *s, DCTELEM block[6][64]);
+
+#endif /* MJPEGENC_H */

Added: branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec/mpeg12.h
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec/mpeg12.h	2007-07-16 18:11:38 UTC (rev 3390)
+++ branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec/mpeg12.h	2007-07-16 18:13:25 UTC (rev 3391)
@@ -0,0 +1,31 @@
+/*
+ * MPEG1/2 common code
+ * Copyright (c) 2007 Aurelien Jacobs <aurel at gnuage.org>
+ *
+ * This file is part of FFmpeg.
+ *
+ * FFmpeg is free software; you can redistribute it and/or
+ * modify it under the terms of the GNU Lesser General Public
+ * License as published by the Free Software Foundation; either
+ * version 2.1 of the License, or (at your option) any later version.
+ *
+ * FFmpeg is distributed in the hope that it will be useful,
+ * but WITHOUT ANY WARRANTY; without even the implied warranty of
+ * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ * Lesser General Public License for more details.
+ *
+ * You should have received a copy of the GNU Lesser General Public
+ * License along with FFmpeg; if not, write to the Free Software
+ * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA
+ */
+
+#ifndef AVCODEC_MPEG12_H
+#define AVCODEC_MPEG12_H
+
+#include "mpegvideo.h"
+
+extern uint8_t ff_mpeg12_static_rl_table_store[2][2][2*MAX_RUN + MAX_LEVEL + 3];
+
+void ff_mpeg12_common_init(MpegEncContext *s);
+
+#endif /* AVCODEC_MPEG12_H */

Added: branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec/mpegaudiodata.h
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec/mpegaudiodata.h	2007-07-16 18:11:38 UTC (rev 3390)
+++ branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec/mpegaudiodata.h	2007-07-16 18:13:25 UTC (rev 3391)
@@ -0,0 +1,40 @@
+/*
+ * MPEG Audio common tables
+ * copyright (c) 2002 Fabrice Bellard
+ *
+ * This file is part of FFmpeg.
+ *
+ * FFmpeg is free software; you can redistribute it and/or
+ * modify it under the terms of the GNU Lesser General Public
+ * License as published by the Free Software Foundation; either
+ * version 2.1 of the License, or (at your option) any later version.
+ *
+ * FFmpeg is distributed in the hope that it will be useful,
+ * but WITHOUT ANY WARRANTY; without even the implied warranty of
+ * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ * Lesser General Public License for more details.
+ *
+ * You should have received a copy of the GNU Lesser General Public
+ * License along with FFmpeg; if not, write to the Free Software
+ * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA
+ */
+
+/**
+ * @file mpegaudiodata.h
+ * mpeg audio layer common tables.
+ */
+
+#ifndef MPEGAUDIODATA_H
+#define MPEGAUDIODATA_H
+
+#include "common.h"
+
+extern const uint16_t ff_mpa_bitrate_tab[2][3][15];
+extern const uint16_t ff_mpa_freq_tab[3];
+extern const int32_t ff_mpa_enwindow[257];
+extern const int ff_mpa_sblimit_table[5];
+extern const int ff_mpa_quant_steps[17];
+extern const int ff_mpa_quant_bits[17];
+extern const unsigned char *ff_mpa_alloc_tables[5];
+
+#endif /* MPEGAUDIODATA_H */

Added: branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec/xiph.h
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec/xiph.h	2007-07-16 18:11:38 UTC (rev 3390)
+++ branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec/xiph.h	2007-07-16 18:13:25 UTC (rev 3391)
@@ -0,0 +1,43 @@
+/*
+ * Copyright (C) 2007  FFmpeg Project
+ *
+ * This file is part of FFmpeg.
+ *
+ * FFmpeg is free software; you can redistribute it and/or
+ * modify it under the terms of the GNU Lesser General Public
+ * License as published by the Free Software Foundation; either
+ * version 2.1 of the License, or (at your option) any later version.
+ *
+ * FFmpeg is distributed in the hope that it will be useful,
+ * but WITHOUT ANY WARRANTY; without even the implied warranty of
+ * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ * Lesser General Public License for more details.
+ *
+ * You should have received a copy of the GNU Lesser General Public
+ * License along with FFmpeg; if not, write to the Free Software
+ * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA
+ */
+
+#ifndef AVCODEC_XIPH_H
+#define AVCODEC_XIPH_H
+
+#include "common.h"
+
+/**
+ * Splits a single extradata buffer into the three headers that most
+ * Xiph codecs use. (e.g. Theora and Vorbis)
+ * Works both with Matroska's packing and lavc's packing.
+ *
+ * @param[in] extradata The single chunk that combines all three headers
+ * @param[in] extradata_size The size of the extradata buffer
+ * @param[in] first_header_size The size of the first header, used to
+ * differentiate between the Matroska packing and lavc packing.
+ * @param[out] header_start Pointers to the start of the three separate headers.
+ * @param[out] header_len The sizes of each of the three headers.
+ * @return On error a negative value is returned, on success zero.
+ */
+int ff_split_xiph_headers(uint8_t *extradata, int extradata_size,
+                          int first_header_size, uint8_t *header_start[3],
+                          int header_len[3]);
+
+#endif // AVCODEC_XIPH_H



From mean at mail.berlios.de  Mon Jul 16 20:14:47 2007
From: mean at mail.berlios.de (mean at BerliOS)
Date: Mon, 16 Jul 2007 20:14:47 +0200
Subject: [Avidemux-svn-commit] r3392 -
	branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec
Message-ID: <200707161814.l6GIEla9010670@sheep.berlios.de>

Author: mean
Date: 2007-07-16 20:14:46 +0200 (Mon, 16 Jul 2007)
New Revision: 3392

Added:
   branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec/mpeg12decdata.h
   branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec/mpegaudiodecheader.h
   branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec/msmpeg4tab.h
   branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec/raw.h
Log:
missing files

Added: branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec/mpeg12decdata.h
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec/mpeg12decdata.h	2007-07-16 18:13:25 UTC (rev 3391)
+++ branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec/mpeg12decdata.h	2007-07-16 18:14:46 UTC (rev 3392)
@@ -0,0 +1,124 @@
+/*
+ * MPEG1/2 decoder tables
+ * copyright (c) 2000,2001 Fabrice Bellard
+ * copyright (c) 2002-2004 Michael Niedermayer <michaelni at gmx.at>
+ *
+ * This file is part of FFmpeg.
+ *
+ * FFmpeg is free software; you can redistribute it and/or
+ * modify it under the terms of the GNU Lesser General Public
+ * License as published by the Free Software Foundation; either
+ * version 2.1 of the License, or (at your option) any later version.
+ *
+ * FFmpeg is distributed in the hope that it will be useful,
+ * but WITHOUT ANY WARRANTY; without even the implied warranty of
+ * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ * Lesser General Public License for more details.
+ *
+ * You should have received a copy of the GNU Lesser General Public
+ * License along with FFmpeg; if not, write to the Free Software
+ * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA
+ */
+
+/**
+ * @file mpeg12decdata.h
+ * MPEG1/2 decoder tables.
+ */
+
+#ifndef AVCODEC_MPEG12DECDATA_H
+#define AVCODEC_MPEG12DECDATA_H
+
+#include <stdint.h>
+#include "mpegvideo.h"
+
+
+#define MB_TYPE_ZERO_MV   0x20000000
+#define IS_ZERO_MV(a)   ((a)&MB_TYPE_ZERO_MV)
+
+static const uint8_t table_mb_ptype[7][2] = {
+    { 3, 5 }, // 0x01 MB_INTRA
+    { 1, 2 }, // 0x02 MB_PAT
+    { 1, 3 }, // 0x08 MB_FOR
+    { 1, 1 }, // 0x0A MB_FOR|MB_PAT
+    { 1, 6 }, // 0x11 MB_QUANT|MB_INTRA
+    { 1, 5 }, // 0x12 MB_QUANT|MB_PAT
+    { 2, 5 }, // 0x1A MB_QUANT|MB_FOR|MB_PAT
+};
+
+static const uint32_t ptype2mb_type[7] = {
+                    MB_TYPE_INTRA,
+                    MB_TYPE_L0 | MB_TYPE_CBP | MB_TYPE_ZERO_MV | MB_TYPE_16x16,
+                    MB_TYPE_L0,
+                    MB_TYPE_L0 | MB_TYPE_CBP,
+    MB_TYPE_QUANT | MB_TYPE_INTRA,
+    MB_TYPE_QUANT | MB_TYPE_L0 | MB_TYPE_CBP | MB_TYPE_ZERO_MV | MB_TYPE_16x16,
+    MB_TYPE_QUANT | MB_TYPE_L0 | MB_TYPE_CBP,
+};
+
+static const uint8_t table_mb_btype[11][2] = {
+    { 3, 5 }, // 0x01 MB_INTRA
+    { 2, 3 }, // 0x04 MB_BACK
+    { 3, 3 }, // 0x06 MB_BACK|MB_PAT
+    { 2, 4 }, // 0x08 MB_FOR
+    { 3, 4 }, // 0x0A MB_FOR|MB_PAT
+    { 2, 2 }, // 0x0C MB_FOR|MB_BACK
+    { 3, 2 }, // 0x0E MB_FOR|MB_BACK|MB_PAT
+    { 1, 6 }, // 0x11 MB_QUANT|MB_INTRA
+    { 2, 6 }, // 0x16 MB_QUANT|MB_BACK|MB_PAT
+    { 3, 6 }, // 0x1A MB_QUANT|MB_FOR|MB_PAT
+    { 2, 5 }, // 0x1E MB_QUANT|MB_FOR|MB_BACK|MB_PAT
+};
+
+static const uint32_t btype2mb_type[11] = {
+                    MB_TYPE_INTRA,
+                    MB_TYPE_L1,
+                    MB_TYPE_L1   | MB_TYPE_CBP,
+                    MB_TYPE_L0,
+                    MB_TYPE_L0   | MB_TYPE_CBP,
+                    MB_TYPE_L0L1,
+                    MB_TYPE_L0L1 | MB_TYPE_CBP,
+    MB_TYPE_QUANT | MB_TYPE_INTRA,
+    MB_TYPE_QUANT | MB_TYPE_L1   | MB_TYPE_CBP,
+    MB_TYPE_QUANT | MB_TYPE_L0   | MB_TYPE_CBP,
+    MB_TYPE_QUANT | MB_TYPE_L0L1 | MB_TYPE_CBP,
+};
+
+static const uint8_t non_linear_qscale[32] = {
+    0, 1, 2, 3, 4, 5, 6, 7,
+    8,10,12,14,16,18,20,22,
+    24,28,32,36,40,44,48,52,
+    56,64,72,80,88,96,104,112,
+};
+
+static const uint8_t mpeg2_dc_scale_table1[128]={
+//  0  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31
+    4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4,
+    4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4,
+    4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4,
+    4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4,
+};
+
+static const uint8_t mpeg2_dc_scale_table2[128]={
+//  0  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31
+    2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,
+    2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,
+    2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,
+    2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,
+};
+
+static const uint8_t mpeg2_dc_scale_table3[128]={
+//  0  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31
+    1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
+    1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
+    1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
+    1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
+};
+
+static const uint8_t *mpeg2_dc_scale_table[4]={
+    ff_mpeg1_dc_scale_table,
+    mpeg2_dc_scale_table1,
+    mpeg2_dc_scale_table2,
+    mpeg2_dc_scale_table3,
+};
+
+#endif // AVCODEC_MPEG12DECDATA_H

Added: branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec/mpegaudiodecheader.h
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec/mpegaudiodecheader.h	2007-07-16 18:13:25 UTC (rev 3391)
+++ branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec/mpegaudiodecheader.h	2007-07-16 18:14:46 UTC (rev 3392)
@@ -0,0 +1,39 @@
+/*
+ * MPEG Audio header decoder
+ * Copyright (c) 2001, 2002 Fabrice Bellard.
+ *
+ * This file is part of FFmpeg.
+ *
+ * FFmpeg is free software; you can redistribute it and/or
+ * modify it under the terms of the GNU Lesser General Public
+ * License as published by the Free Software Foundation; either
+ * version 2.1 of the License, or (at your option) any later version.
+ *
+ * FFmpeg is distributed in the hope that it will be useful,
+ * but WITHOUT ANY WARRANTY; without even the implied warranty of
+ * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ * Lesser General Public License for more details.
+ *
+ * You should have received a copy of the GNU Lesser General Public
+ * License along with FFmpeg; if not, write to the Free Software
+ * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA
+ */
+
+/**
+ * @file mpegaudiodecheader.c
+ * MPEG Audio header decoder.
+ */
+
+#ifndef MPEGAUDIODECHEADER_H
+#define MPEGAUDIODECHEADER_H
+
+#include "common.h"
+#include "mpegaudio.h"
+
+
+/* header decoding. MUST check the header before because no
+   consistency check is done there. Return 1 if free format found and
+   that the frame size must be computed externally */
+int ff_mpegaudio_decode_header(MPADecodeContext *s, uint32_t header);
+
+#endif /* MPEGAUDIODECHEADER_H */

Added: branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec/msmpeg4tab.h
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec/msmpeg4tab.h	2007-07-16 18:13:25 UTC (rev 3391)
+++ branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec/msmpeg4tab.h	2007-07-16 18:14:46 UTC (rev 3392)
@@ -0,0 +1,2023 @@
+/*
+ * MSMPEG4 backend for ffmpeg encoder and decoder
+ * copyright (c) 2001 Fabrice Bellard
+ * copyright (c) 2002-2004 Michael Niedermayer <michaelni at gmx.at>
+ *
+ * msmpeg4v1 & v2 stuff by Michael Niedermayer <michaelni at gmx.at>
+ *
+ * This file is part of FFmpeg.
+ *
+ * FFmpeg is free software; you can redistribute it and/or
+ * modify it under the terms of the GNU Lesser General Public
+ * License as published by the Free Software Foundation; either
+ * version 2.1 of the License, or (at your option) any later version.
+ *
+ * FFmpeg is distributed in the hope that it will be useful,
+ * but WITHOUT ANY WARRANTY; without even the implied warranty of
+ * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ * Lesser General Public License for more details.
+ *
+ * You should have received a copy of the GNU Lesser General Public
+ * License along with FFmpeg; if not, write to the Free Software
+ * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA
+ */
+
+/**
+ * @file msmpeg4tab.h
+ * MSMPEG4 data tables.
+ */
+
+#ifndef AVCODEC_MSMPEG4TAB_H
+#define AVCODEC_MSMPEG4TAB_H
+
+#include <stdint.h>
+#include "bitstream.h"
+#include "rl.h"
+
+/* non intra picture macro block coded block pattern + mb type */
+static const uint32_t table_mb_non_intra[128][2] = {
+{ 0x40, 7 },{ 0x13c9, 13 },{ 0x9fd, 12 },{ 0x1fc, 15 },
+{ 0x9fc, 12 },{ 0xa83, 18 },{ 0x12d34, 17 },{ 0x83bc, 16 },
+{ 0x83a, 12 },{ 0x7f8, 17 },{ 0x3fd, 16 },{ 0x3ff, 16 },
+{ 0x79, 13 },{ 0xa82, 18 },{ 0x969d, 16 },{ 0x2a4, 16 },
+{ 0x978, 12 },{ 0x543, 17 },{ 0x41df, 15 },{ 0x7f9, 17 },
+{ 0x12f3, 13 },{ 0x25a6b, 18 },{ 0x25ef9, 18 },{ 0x3fa, 16 },
+{ 0x20ee, 14 },{ 0x969ab, 20 },{ 0x969c, 16 },{ 0x25ef8, 18 },
+{ 0x12d2, 13 },{ 0xa85, 18 },{ 0x969e, 16 },{ 0x4bc8, 15 },
+{ 0x3d, 12 },{ 0x12f7f, 17 },{ 0x2a2, 16 },{ 0x969f, 16 },
+{ 0x25ee, 14 },{ 0x12d355, 21 },{ 0x12f7d, 17 },{ 0x12f7e, 17 },
+{ 0x9e5, 12 },{ 0xa81, 18 },{ 0x4b4d4, 19 },{ 0x83bd, 16 },
+{ 0x78, 13 },{ 0x969b, 16 },{ 0x3fe, 16 },{ 0x2a5, 16 },
+{ 0x7e, 13 },{ 0xa80, 18 },{ 0x2a3, 16 },{ 0x3fb, 16 },
+{ 0x1076, 13 },{ 0xa84, 18 },{ 0x153, 15 },{ 0x4bc9, 15 },
+{ 0x55, 13 },{ 0x12d354, 21 },{ 0x4bde, 15 },{ 0x25e5, 14 },
+{ 0x25b, 10 },{ 0x4b4c, 15 },{ 0x96b, 12 },{ 0x96a, 12 },
+{ 0x1, 2 },{ 0x0, 7 },{ 0x26, 6 },{ 0x12b, 9 },
+{ 0x7, 3 },{ 0x20f, 10 },{ 0x4, 9 },{ 0x28, 12 },
+{ 0x6, 3 },{ 0x20a, 10 },{ 0x128, 9 },{ 0x2b, 12 },
+{ 0x11, 5 },{ 0x1b, 11 },{ 0x13a, 9 },{ 0x4ff, 11 },
+{ 0x3, 4 },{ 0x277, 10 },{ 0x106, 9 },{ 0x839, 12 },
+{ 0xb, 4 },{ 0x27b, 10 },{ 0x12c, 9 },{ 0x4bf, 11 },
+{ 0x9, 6 },{ 0x35, 12 },{ 0x27e, 10 },{ 0x13c8, 13 },
+{ 0x1, 6 },{ 0x4aa, 11 },{ 0x208, 10 },{ 0x29, 12 },
+{ 0x1, 4 },{ 0x254, 10 },{ 0x12e, 9 },{ 0x838, 12 },
+{ 0x24, 6 },{ 0x4f3, 11 },{ 0x276, 10 },{ 0x12f6, 13 },
+{ 0x1, 5 },{ 0x27a, 10 },{ 0x13e, 9 },{ 0x3e, 12 },
+{ 0x8, 6 },{ 0x413, 11 },{ 0xc, 10 },{ 0x4be, 11 },
+{ 0x14, 5 },{ 0x412, 11 },{ 0x253, 10 },{ 0x97a, 12 },
+{ 0x21, 6 },{ 0x4ab, 11 },{ 0x20b, 10 },{ 0x34, 12 },
+{ 0x15, 5 },{ 0x278, 10 },{ 0x252, 10 },{ 0x968, 12 },
+{ 0x5, 5 },{ 0xb, 10 },{ 0x9c, 8 },{ 0xe, 10 },
+};
+
+/* dc table 0 */
+
+static const uint32_t ff_table0_dc_lum[120][2] = {
+{ 0x1, 1 },{ 0x1, 2 },{ 0x1, 4 },{ 0x1, 5 },
+{ 0x5, 5 },{ 0x7, 5 },{ 0x8, 6 },{ 0xc, 6 },
+{ 0x0, 7 },{ 0x2, 7 },{ 0x12, 7 },{ 0x1a, 7 },
+{ 0x3, 8 },{ 0x7, 8 },{ 0x27, 8 },{ 0x37, 8 },
+{ 0x5, 9 },{ 0x4c, 9 },{ 0x6c, 9 },{ 0x6d, 9 },
+{ 0x8, 10 },{ 0x19, 10 },{ 0x9b, 10 },{ 0x1b, 10 },
+{ 0x9a, 10 },{ 0x13, 11 },{ 0x34, 11 },{ 0x35, 11 },
+{ 0x61, 12 },{ 0x48, 13 },{ 0xc4, 13 },{ 0x4a, 13 },
+{ 0xc6, 13 },{ 0xc7, 13 },{ 0x92, 14 },{ 0x18b, 14 },
+{ 0x93, 14 },{ 0x183, 14 },{ 0x182, 14 },{ 0x96, 14 },
+{ 0x97, 14 },{ 0x180, 14 },{ 0x314, 15 },{ 0x315, 15 },
+{ 0x605, 16 },{ 0x604, 16 },{ 0x606, 16 },{ 0xc0e, 17 },
+{ 0x303cd, 23 },{ 0x303c9, 23 },{ 0x303c8, 23 },{ 0x303ca, 23 },
+{ 0x303cb, 23 },{ 0x303cc, 23 },{ 0x303ce, 23 },{ 0x303cf, 23 },
+{ 0x303d0, 23 },{ 0x303d1, 23 },{ 0x303d2, 23 },{ 0x303d3, 23 },
+{ 0x303d4, 23 },{ 0x303d5, 23 },{ 0x303d6, 23 },{ 0x303d7, 23 },
+{ 0x303d8, 23 },{ 0x303d9, 23 },{ 0x303da, 23 },{ 0x303db, 23 },
+{ 0x303dc, 23 },{ 0x303dd, 23 },{ 0x303de, 23 },{ 0x303df, 23 },
+{ 0x303e0, 23 },{ 0x303e1, 23 },{ 0x303e2, 23 },{ 0x303e3, 23 },
+{ 0x303e4, 23 },{ 0x303e5, 23 },{ 0x303e6, 23 },{ 0x303e7, 23 },
+{ 0x303e8, 23 },{ 0x303e9, 23 },{ 0x303ea, 23 },{ 0x303eb, 23 },
+{ 0x303ec, 23 },{ 0x303ed, 23 },{ 0x303ee, 23 },{ 0x303ef, 23 },
+{ 0x303f0, 23 },{ 0x303f1, 23 },{ 0x303f2, 23 },{ 0x303f3, 23 },
+{ 0x303f4, 23 },{ 0x303f5, 23 },{ 0x303f6, 23 },{ 0x303f7, 23 },
+{ 0x303f8, 23 },{ 0x303f9, 23 },{ 0x303fa, 23 },{ 0x303fb, 23 },
+{ 0x303fc, 23 },{ 0x303fd, 23 },{ 0x303fe, 23 },{ 0x303ff, 23 },
+{ 0x60780, 24 },{ 0x60781, 24 },{ 0x60782, 24 },{ 0x60783, 24 },
+{ 0x60784, 24 },{ 0x60785, 24 },{ 0x60786, 24 },{ 0x60787, 24 },
+{ 0x60788, 24 },{ 0x60789, 24 },{ 0x6078a, 24 },{ 0x6078b, 24 },
+{ 0x6078c, 24 },{ 0x6078d, 24 },{ 0x6078e, 24 },{ 0x6078f, 24 },
+};
+
+static const uint32_t ff_table0_dc_chroma[120][2] = {
+{ 0x0, 2 },{ 0x1, 2 },{ 0x5, 3 },{ 0x9, 4 },
+{ 0xd, 4 },{ 0x11, 5 },{ 0x1d, 5 },{ 0x1f, 5 },
+{ 0x21, 6 },{ 0x31, 6 },{ 0x38, 6 },{ 0x33, 6 },
+{ 0x39, 6 },{ 0x3d, 6 },{ 0x61, 7 },{ 0x79, 7 },
+{ 0x80, 8 },{ 0xc8, 8 },{ 0xca, 8 },{ 0xf0, 8 },
+{ 0x81, 8 },{ 0xc0, 8 },{ 0xc9, 8 },{ 0x107, 9 },
+{ 0x106, 9 },{ 0x196, 9 },{ 0x183, 9 },{ 0x1e3, 9 },
+{ 0x1e2, 9 },{ 0x20a, 10 },{ 0x20b, 10 },{ 0x609, 11 },
+{ 0x412, 11 },{ 0x413, 11 },{ 0x60b, 11 },{ 0x411, 11 },
+{ 0x60a, 11 },{ 0x65f, 11 },{ 0x410, 11 },{ 0x65d, 11 },
+{ 0x65e, 11 },{ 0xcb8, 12 },{ 0xc10, 12 },{ 0xcb9, 12 },
+{ 0x1823, 13 },{ 0x3045, 14 },{ 0x6089, 15 },{ 0xc110, 16 },
+{ 0x304448, 22 },{ 0x304449, 22 },{ 0x30444a, 22 },{ 0x30444b, 22 },
+{ 0x30444c, 22 },{ 0x30444d, 22 },{ 0x30444e, 22 },{ 0x30444f, 22 },
+{ 0x304450, 22 },{ 0x304451, 22 },{ 0x304452, 22 },{ 0x304453, 22 },
+{ 0x304454, 22 },{ 0x304455, 22 },{ 0x304456, 22 },{ 0x304457, 22 },
+{ 0x304458, 22 },{ 0x304459, 22 },{ 0x30445a, 22 },{ 0x30445b, 22 },
+{ 0x30445c, 22 },{ 0x30445d, 22 },{ 0x30445e, 22 },{ 0x30445f, 22 },
+{ 0x304460, 22 },{ 0x304461, 22 },{ 0x304462, 22 },{ 0x304463, 22 },
+{ 0x304464, 22 },{ 0x304465, 22 },{ 0x304466, 22 },{ 0x304467, 22 },
+{ 0x304468, 22 },{ 0x304469, 22 },{ 0x30446a, 22 },{ 0x30446b, 22 },
+{ 0x30446c, 22 },{ 0x30446d, 22 },{ 0x30446e, 22 },{ 0x30446f, 22 },
+{ 0x304470, 22 },{ 0x304471, 22 },{ 0x304472, 22 },{ 0x304473, 22 },
+{ 0x304474, 22 },{ 0x304475, 22 },{ 0x304476, 22 },{ 0x304477, 22 },
+{ 0x304478, 22 },{ 0x304479, 22 },{ 0x30447a, 22 },{ 0x30447b, 22 },
+{ 0x30447c, 22 },{ 0x30447d, 22 },{ 0x30447e, 22 },{ 0x30447f, 22 },
+{ 0x608880, 23 },{ 0x608881, 23 },{ 0x608882, 23 },{ 0x608883, 23 },
+{ 0x608884, 23 },{ 0x608885, 23 },{ 0x608886, 23 },{ 0x608887, 23 },
+{ 0x608888, 23 },{ 0x608889, 23 },{ 0x60888a, 23 },{ 0x60888b, 23 },
+{ 0x60888c, 23 },{ 0x60888d, 23 },{ 0x60888e, 23 },{ 0x60888f, 23 },
+};
+
+/* dc table 1 */
+
+static const uint32_t ff_table1_dc_lum[120][2] = {
+{ 0x2, 2 },{ 0x3, 2 },{ 0x3, 3 },{ 0x2, 4 },
+{ 0x5, 4 },{ 0x1, 5 },{ 0x3, 5 },{ 0x8, 5 },
+{ 0x0, 6 },{ 0x5, 6 },{ 0xd, 6 },{ 0xf, 6 },
+{ 0x13, 6 },{ 0x8, 7 },{ 0x18, 7 },{ 0x1c, 7 },
+{ 0x24, 7 },{ 0x4, 8 },{ 0x6, 8 },{ 0x12, 8 },
+{ 0x32, 8 },{ 0x3b, 8 },{ 0x4a, 8 },{ 0x4b, 8 },
+{ 0xb, 9 },{ 0x26, 9 },{ 0x27, 9 },{ 0x66, 9 },
+{ 0x74, 9 },{ 0x75, 9 },{ 0x14, 10 },{ 0x1c, 10 },
+{ 0x1f, 10 },{ 0x1d, 10 },{ 0x2b, 11 },{ 0x3d, 11 },
+{ 0x19d, 11 },{ 0x19f, 11 },{ 0x54, 12 },{ 0x339, 12 },
+{ 0x338, 12 },{ 0x33d, 12 },{ 0xab, 13 },{ 0xf1, 13 },
+{ 0x678, 13 },{ 0xf2, 13 },{ 0x1e0, 14 },{ 0x1e1, 14 },
+{ 0x154, 14 },{ 0xcf2, 14 },{ 0x3cc, 15 },{ 0x2ab, 15 },
+{ 0x19e7, 15 },{ 0x3ce, 15 },{ 0x19e6, 15 },{ 0x554, 16 },
+{ 0x79f, 16 },{ 0x555, 16 },{ 0xf3d, 17 },{ 0xf37, 17 },
+{ 0xf3c, 17 },{ 0xf35, 17 },{ 0x1e6d, 18 },{ 0x1e68, 18 },
+{ 0x3cd8, 19 },{ 0x3cd3, 19 },{ 0x3cd9, 19 },{ 0x79a4, 20 },
+{ 0xf34ba, 25 },{ 0xf34b4, 25 },{ 0xf34b5, 25 },{ 0xf34b6, 25 },
+{ 0xf34b7, 25 },{ 0xf34b8, 25 },{ 0xf34b9, 25 },{ 0xf34bb, 25 },
+{ 0xf34bc, 25 },{ 0xf34bd, 25 },{ 0xf34be, 25 },{ 0xf34bf, 25 },
+{ 0x1e6940, 26 },{ 0x1e6941, 26 },{ 0x1e6942, 26 },{ 0x1e6943, 26 },
+{ 0x1e6944, 26 },{ 0x1e6945, 26 },{ 0x1e6946, 26 },{ 0x1e6947, 26 },
+{ 0x1e6948, 26 },{ 0x1e6949, 26 },{ 0x1e694a, 26 },{ 0x1e694b, 26 },
+{ 0x1e694c, 26 },{ 0x1e694d, 26 },{ 0x1e694e, 26 },{ 0x1e694f, 26 },
+{ 0x1e6950, 26 },{ 0x1e6951, 26 },{ 0x1e6952, 26 },{ 0x1e6953, 26 },
+{ 0x1e6954, 26 },{ 0x1e6955, 26 },{ 0x1e6956, 26 },{ 0x1e6957, 26 },
+{ 0x1e6958, 26 },{ 0x1e6959, 26 },{ 0x1e695a, 26 },{ 0x1e695b, 26 },
+{ 0x1e695c, 26 },{ 0x1e695d, 26 },{ 0x1e695e, 26 },{ 0x1e695f, 26 },
+{ 0x1e6960, 26 },{ 0x1e6961, 26 },{ 0x1e6962, 26 },{ 0x1e6963, 26 },
+{ 0x1e6964, 26 },{ 0x1e6965, 26 },{ 0x1e6966, 26 },{ 0x1e6967, 26 },
+};
+
+static const uint32_t ff_table1_dc_chroma[120][2] = {
+{ 0x0, 2 },{ 0x1, 2 },{ 0x4, 3 },{ 0x7, 3 },
+{ 0xb, 4 },{ 0xd, 4 },{ 0x15, 5 },{ 0x28, 6 },
+{ 0x30, 6 },{ 0x32, 6 },{ 0x52, 7 },{ 0x62, 7 },
+{ 0x66, 7 },{ 0xa6, 8 },{ 0xc6, 8 },{ 0xcf, 8 },
+{ 0x14f, 9 },{ 0x18e, 9 },{ 0x19c, 9 },{ 0x29d, 10 },
+{ 0x33a, 10 },{ 0x538, 11 },{ 0x63c, 11 },{ 0x63e, 11 },
+{ 0x63f, 11 },{ 0x676, 11 },{ 0xa73, 12 },{ 0xc7a, 12 },
+{ 0xcef, 12 },{ 0x14e5, 13 },{ 0x19dd, 13 },{ 0x29c8, 14 },
+{ 0x29c9, 14 },{ 0x63dd, 15 },{ 0x33b8, 14 },{ 0x33b9, 14 },
+{ 0xc7b6, 16 },{ 0x63d8, 15 },{ 0x63df, 15 },{ 0xc7b3, 16 },
+{ 0xc7b4, 16 },{ 0xc7b5, 16 },{ 0x63de, 15 },{ 0xc7b7, 16 },
+{ 0xc7b8, 16 },{ 0xc7b9, 16 },{ 0x18f65, 17 },{ 0x31ec8, 18 },
+{ 0xc7b248, 24 },{ 0xc7b249, 24 },{ 0xc7b24a, 24 },{ 0xc7b24b, 24 },
+{ 0xc7b24c, 24 },{ 0xc7b24d, 24 },{ 0xc7b24e, 24 },{ 0xc7b24f, 24 },
+{ 0xc7b250, 24 },{ 0xc7b251, 24 },{ 0xc7b252, 24 },{ 0xc7b253, 24 },
+{ 0xc7b254, 24 },{ 0xc7b255, 24 },{ 0xc7b256, 24 },{ 0xc7b257, 24 },
+{ 0xc7b258, 24 },{ 0xc7b259, 24 },{ 0xc7b25a, 24 },{ 0xc7b25b, 24 },
+{ 0xc7b25c, 24 },{ 0xc7b25d, 24 },{ 0xc7b25e, 24 },{ 0xc7b25f, 24 },
+{ 0xc7b260, 24 },{ 0xc7b261, 24 },{ 0xc7b262, 24 },{ 0xc7b263, 24 },
+{ 0xc7b264, 24 },{ 0xc7b265, 24 },{ 0xc7b266, 24 },{ 0xc7b267, 24 },
+{ 0xc7b268, 24 },{ 0xc7b269, 24 },{ 0xc7b26a, 24 },{ 0xc7b26b, 24 },
+{ 0xc7b26c, 24 },{ 0xc7b26d, 24 },{ 0xc7b26e, 24 },{ 0xc7b26f, 24 },
+{ 0xc7b270, 24 },{ 0xc7b271, 24 },{ 0xc7b272, 24 },{ 0xc7b273, 24 },
+{ 0xc7b274, 24 },{ 0xc7b275, 24 },{ 0xc7b276, 24 },{ 0xc7b277, 24 },
+{ 0xc7b278, 24 },{ 0xc7b279, 24 },{ 0xc7b27a, 24 },{ 0xc7b27b, 24 },
+{ 0xc7b27c, 24 },{ 0xc7b27d, 24 },{ 0xc7b27e, 24 },{ 0xc7b27f, 24 },
+{ 0x18f6480, 25 },{ 0x18f6481, 25 },{ 0x18f6482, 25 },{ 0x18f6483, 25 },
+{ 0x18f6484, 25 },{ 0x18f6485, 25 },{ 0x18f6486, 25 },{ 0x18f6487, 25 },
+{ 0x18f6488, 25 },{ 0x18f6489, 25 },{ 0x18f648a, 25 },{ 0x18f648b, 25 },
+{ 0x18f648c, 25 },{ 0x18f648d, 25 },{ 0x18f648e, 25 },{ 0x18f648f, 25 },
+};
+
+/* vlc table 0, for intra luma */
+
+static const uint16_t table0_vlc[133][2] = {
+{ 0x1, 2 },{ 0x6, 3 },{ 0xf, 4 },{ 0x16, 5 },
+{ 0x20, 6 },{ 0x18, 7 },{ 0x8, 8 },{ 0x9a, 8 },
+{ 0x56, 9 },{ 0x13e, 9 },{ 0xf0, 10 },{ 0x3a5, 10 },
+{ 0x77, 11 },{ 0x1ef, 11 },{ 0x9a, 12 },{ 0x5d, 13 },
+{ 0x1, 4 },{ 0x11, 5 },{ 0x2, 7 },{ 0xb, 8 },
+{ 0x12, 9 },{ 0x1d6, 9 },{ 0x27e, 10 },{ 0x191, 11 },
+{ 0xea, 12 },{ 0x3dc, 12 },{ 0x13b, 13 },{ 0x4, 5 },
+{ 0x14, 7 },{ 0x9e, 8 },{ 0x9, 10 },{ 0x1ac, 11 },
+{ 0x1e2, 11 },{ 0x3ca, 12 },{ 0x5f, 13 },{ 0x17, 5 },
+{ 0x4e, 7 },{ 0x5e, 9 },{ 0xf3, 10 },{ 0x1ad, 11 },
+{ 0xec, 12 },{ 0x5f0, 13 },{ 0xe, 6 },{ 0xe1, 8 },
+{ 0x3a4, 10 },{ 0x9c, 12 },{ 0x13d, 13 },{ 0x3b, 6 },
+{ 0x1c, 9 },{ 0x14, 11 },{ 0x9be, 12 },{ 0x6, 7 },
+{ 0x7a, 9 },{ 0x190, 11 },{ 0x137, 13 },{ 0x1b, 7 },
+{ 0x8, 10 },{ 0x75c, 11 },{ 0x71, 7 },{ 0xd7, 10 },
+{ 0x9bf, 12 },{ 0x7, 8 },{ 0xaf, 10 },{ 0x4cc, 11 },
+{ 0x34, 8 },{ 0x265, 10 },{ 0x9f, 12 },{ 0xe0, 8 },
+{ 0x16, 11 },{ 0x327, 12 },{ 0x15, 9 },{ 0x17d, 11 },
+{ 0xebb, 12 },{ 0x14, 9 },{ 0xf6, 10 },{ 0x1e4, 11 },
+{ 0xcb, 10 },{ 0x99d, 12 },{ 0xca, 10 },{ 0x2fc, 12 },
+{ 0x17f, 11 },{ 0x4cd, 11 },{ 0x2fd, 12 },{ 0x4fe, 11 },
+{ 0x13a, 13 },{ 0xa, 4 },{ 0x42, 7 },{ 0x1d3, 9 },
+{ 0x4dd, 11 },{ 0x12, 5 },{ 0xe8, 8 },{ 0x4c, 11 },
+{ 0x136, 13 },{ 0x39, 6 },{ 0x264, 10 },{ 0xeba, 12 },
+{ 0x0, 7 },{ 0xae, 10 },{ 0x99c, 12 },{ 0x1f, 7 },
+{ 0x4de, 11 },{ 0x43, 7 },{ 0x4dc, 11 },{ 0x3, 8 },
+{ 0x3cb, 12 },{ 0x6, 8 },{ 0x99e, 12 },{ 0x2a, 8 },
+{ 0x5f1, 13 },{ 0xf, 8 },{ 0x9fe, 12 },{ 0x33, 8 },
+{ 0x9ff, 12 },{ 0x98, 8 },{ 0x99f, 12 },{ 0xea, 8 },
+{ 0x13c, 13 },{ 0x2e, 8 },{ 0x192, 11 },{ 0x136, 9 },
+{ 0x6a, 9 },{ 0x15, 11 },{ 0x3af, 10 },{ 0x1e3, 11 },
+{ 0x74, 11 },{ 0xeb, 12 },{ 0x2f9, 12 },{ 0x5c, 13 },
+{ 0xed, 12 },{ 0x3dd, 12 },{ 0x326, 12 },{ 0x5e, 13 },
+{ 0x16, 7 },
+};
+
+static const int8_t table0_level[132] = {
+  1,  2,  3,  4,  5,  6,  7,  8,
+  9, 10, 11, 12, 13, 14, 15, 16,
+  1,  2,  3,  4,  5,  6,  7,  8,
+  9, 10, 11,  1,  2,  3,  4,  5,
+  6,  7,  8,  1,  2,  3,  4,  5,
+  6,  7,  1,  2,  3,  4,  5,  1,
+  2,  3,  4,  1,  2,  3,  4,  1,
+  2,  3,  1,  2,  3,  1,  2,  3,
+  1,  2,  3,  1,  2,  3,  1,  2,
+  3,  1,  2,  3,  1,  2,  1,  2,
+  1,  1,  1,  1,  1,  1,  2,  3,
+  4,  1,  2,  3,  4,  1,  2,  3,
+  1,  2,  3,  1,  2,  1,  2,  1,
+  2,  1,  2,  1,  2,  1,  2,  1,
+  2,  1,  2,  1,  2,  1,  2,  1,
+  1,  1,  1,  1,  1,  1,  1,  1,
+  1,  1,  1,  1,
+};
+
+static const int8_t table0_run[132] = {
+  0,  0,  0,  0,  0,  0,  0,  0,
+  0,  0,  0,  0,  0,  0,  0,  0,
+  1,  1,  1,  1,  1,  1,  1,  1,
+  1,  1,  1,  2,  2,  2,  2,  2,
+  2,  2,  2,  3,  3,  3,  3,  3,
+  3,  3,  4,  4,  4,  4,  4,  5,
+  5,  5,  5,  6,  6,  6,  6,  7,
+  7,  7,  8,  8,  8,  9,  9,  9,
+ 10, 10, 10, 11, 11, 11, 12, 12,
+ 12, 13, 13, 13, 14, 14, 15, 15,
+ 16, 17, 18, 19, 20,  0,  0,  0,
+  0,  1,  1,  1,  1,  2,  2,  2,
+  3,  3,  3,  4,  4,  5,  5,  6,
+  6,  7,  7,  8,  8,  9,  9, 10,
+ 10, 11, 11, 12, 12, 13, 13, 14,
+ 15, 16, 17, 18, 19, 20, 21, 22,
+ 23, 24, 25, 26,
+};
+
+/* vlc table 1, for intra chroma and P macro blocks */
+
+static const uint16_t table1_vlc[149][2] = {
+{ 0x4, 3 },{ 0x14, 5 },{ 0x17, 7 },{ 0x7f, 8 },
+{ 0x154, 9 },{ 0x1f2, 10 },{ 0xbf, 11 },{ 0x65, 12 },
+{ 0xaaa, 12 },{ 0x630, 13 },{ 0x1597, 13 },{ 0x3b7, 14 },
+{ 0x2b22, 14 },{ 0xbe6, 15 },{ 0xb, 4 },{ 0x37, 7 },
+{ 0x62, 9 },{ 0x7, 11 },{ 0x166, 12 },{ 0xce, 13 },
+{ 0x1590, 13 },{ 0x5f6, 14 },{ 0xbe7, 15 },{ 0x7, 5 },
+{ 0x6d, 8 },{ 0x3, 11 },{ 0x31f, 12 },{ 0x5f2, 14 },
+{ 0x2, 6 },{ 0x61, 9 },{ 0x55, 12 },{ 0x1df, 14 },
+{ 0x1a, 6 },{ 0x1e, 10 },{ 0xac9, 12 },{ 0x2b23, 14 },
+{ 0x1e, 6 },{ 0x1f, 10 },{ 0xac3, 12 },{ 0x2b2b, 14 },
+{ 0x6, 7 },{ 0x4, 11 },{ 0x2f8, 13 },{ 0x19, 7 },
+{ 0x6, 11 },{ 0x63d, 13 },{ 0x57, 7 },{ 0x182, 11 },
+{ 0x2aa2, 14 },{ 0x4, 8 },{ 0x180, 11 },{ 0x59c, 14 },
+{ 0x7d, 8 },{ 0x164, 12 },{ 0x76d, 15 },{ 0x2, 9 },
+{ 0x18d, 11 },{ 0x1581, 13 },{ 0xad, 8 },{ 0x60, 12 },
+{ 0xc67, 14 },{ 0x1c, 9 },{ 0xee, 13 },{ 0x3, 9 },
+{ 0x2cf, 13 },{ 0xd9, 9 },{ 0x1580, 13 },{ 0x2, 11 },
+{ 0x183, 11 },{ 0x57, 12 },{ 0x61, 12 },{ 0x31, 11 },
+{ 0x66, 12 },{ 0x631, 13 },{ 0x632, 13 },{ 0xac, 13 },
+{ 0x31d, 12 },{ 0x76, 12 },{ 0x3a, 11 },{ 0x165, 12 },
+{ 0xc66, 14 },{ 0x3, 2 },{ 0x54, 7 },{ 0x2ab, 10 },
+{ 0x16, 13 },{ 0x5f7, 14 },{ 0x5, 4 },{ 0xf8, 9 },
+{ 0xaa9, 12 },{ 0x5f, 15 },{ 0x4, 4 },{ 0x1c, 10 },
+{ 0x1550, 13 },{ 0x4, 5 },{ 0x77, 11 },{ 0x76c, 15 },
+{ 0xe, 5 },{ 0xa, 12 },{ 0xc, 5 },{ 0x562, 11 },
+{ 0x4, 6 },{ 0x31c, 12 },{ 0x6, 6 },{ 0xc8, 13 },
+{ 0xd, 6 },{ 0x1da, 13 },{ 0x7, 6 },{ 0xc9, 13 },
+{ 0x1, 7 },{ 0x2e, 14 },{ 0x14, 7 },{ 0x1596, 13 },
+{ 0xa, 7 },{ 0xac2, 12 },{ 0x16, 7 },{ 0x15b, 14 },
+{ 0x15, 7 },{ 0x15a, 14 },{ 0xf, 8 },{ 0x5e, 15 },
+{ 0x7e, 8 },{ 0xab, 8 },{ 0x2d, 9 },{ 0xd8, 9 },
+{ 0xb, 9 },{ 0x14, 10 },{ 0x2b3, 10 },{ 0x1f3, 10 },
+{ 0x3a, 10 },{ 0x0, 10 },{ 0x58, 10 },{ 0x2e, 9 },
+{ 0x5e, 10 },{ 0x563, 11 },{ 0xec, 12 },{ 0x54, 12 },
+{ 0xac1, 12 },{ 0x1556, 13 },{ 0x2fa, 13 },{ 0x181, 11 },
+{ 0x1557, 13 },{ 0x59d, 14 },{ 0x2aa3, 14 },{ 0x2b2a, 14 },
+{ 0x1de, 14 },{ 0x63c, 13 },{ 0xcf, 13 },{ 0x1594, 13 },
+{ 0xd, 9 },
+};
+
+static const int8_t table1_level[148] = {
+  1,  2,  3,  4,  5,  6,  7,  8,
+  9, 10, 11, 12, 13, 14,  1,  2,
+  3,  4,  5,  6,  7,  8,  9,  1,
+  2,  3,  4,  5,  1,  2,  3,  4,
+  1,  2,  3,  4,  1,  2,  3,  4,
+  1,  2,  3,  1,  2,  3,  1,  2,
+  3,  1,  2,  3,  1,  2,  3,  1,
+  2,  3,  1,  2,  3,  1,  2,  1,
+  2,  1,  2,  1,  1,  1,  1,  1,
+  1,  1,  1,  1,  1,  1,  1,  1,
+  1,  1,  2,  3,  4,  5,  1,  2,
+  3,  4,  1,  2,  3,  1,  2,  3,
+  1,  2,  1,  2,  1,  2,  1,  2,
+  1,  2,  1,  2,  1,  2,  1,  2,
+  1,  2,  1,  2,  1,  2,  1,  2,
+  1,  1,  1,  1,  1,  1,  1,  1,
+  1,  1,  1,  1,  1,  1,  1,  1,
+  1,  1,  1,  1,  1,  1,  1,  1,
+  1,  1,  1,  1,
+};
+
+static const int8_t table1_run[148] = {
+  0,  0,  0,  0,  0,  0,  0,  0,
+  0,  0,  0,  0,  0,  0,  1,  1,
+  1,  1,  1,  1,  1,  1,  1,  2,
+  2,  2,  2,  2,  3,  3,  3,  3,
+  4,  4,  4,  4,  5,  5,  5,  5,
+  6,  6,  6,  7,  7,  7,  8,  8,
+  8,  9,  9,  9, 10, 10, 10, 11,
+ 11, 11, 12, 12, 12, 13, 13, 14,
+ 14, 15, 15, 16, 17, 18, 19, 20,
+ 21, 22, 23, 24, 25, 26, 27, 28,
+ 29,  0,  0,  0,  0,  0,  1,  1,
+  1,  1,  2,  2,  2,  3,  3,  3,
+  4,  4,  5,  5,  6,  6,  7,  7,
+  8,  8,  9,  9, 10, 10, 11, 11,
+ 12, 12, 13, 13, 14, 14, 15, 15,
+ 16, 17, 18, 19, 20, 21, 22, 23,
+ 24, 25, 26, 27, 28, 29, 30, 31,
+ 32, 33, 34, 35, 36, 37, 38, 39,
+ 40, 41, 42, 43,
+};
+
+/* third vlc table */
+
+static const uint16_t table2_vlc[186][2] = {
+{ 0x1, 2 },{ 0x5, 3 },{ 0xd, 4 },{ 0x12, 5 },
+{ 0xe, 6 },{ 0x15, 7 },{ 0x13, 8 },{ 0x3f, 8 },
+{ 0x4b, 9 },{ 0x11f, 9 },{ 0xb8, 10 },{ 0x3e3, 10 },
+{ 0x172, 11 },{ 0x24d, 12 },{ 0x3da, 12 },{ 0x2dd, 13 },
+{ 0x1f55, 13 },{ 0x5b9, 14 },{ 0x3eae, 14 },{ 0x0, 4 },
+{ 0x10, 5 },{ 0x8, 7 },{ 0x20, 8 },{ 0x29, 9 },
+{ 0x1f4, 9 },{ 0x233, 10 },{ 0x1e0, 11 },{ 0x12a, 12 },
+{ 0x3dd, 12 },{ 0x50a, 13 },{ 0x1f29, 13 },{ 0xa42, 14 },
+{ 0x1272, 15 },{ 0x1737, 15 },{ 0x3, 5 },{ 0x11, 7 },
+{ 0xc4, 8 },{ 0x4b, 10 },{ 0xb4, 11 },{ 0x7d4, 11 },
+{ 0x345, 12 },{ 0x2d7, 13 },{ 0x7bf, 13 },{ 0x938, 14 },
+{ 0xbbb, 14 },{ 0x95e, 15 },{ 0x13, 5 },{ 0x78, 7 },
+{ 0x69, 9 },{ 0x232, 10 },{ 0x461, 11 },{ 0x3ec, 12 },
+{ 0x520, 13 },{ 0x1f2a, 13 },{ 0x3e50, 14 },{ 0x3e51, 14 },
+{ 0x1486, 15 },{ 0xc, 6 },{ 0x24, 9 },{ 0x94, 11 },
+{ 0x8c0, 12 },{ 0xf09, 14 },{ 0x1ef0, 15 },{ 0x3d, 6 },
+{ 0x53, 9 },{ 0x1a0, 11 },{ 0x2d6, 13 },{ 0xf08, 14 },
+{ 0x13, 7 },{ 0x7c, 9 },{ 0x7c1, 11 },{ 0x4ac, 14 },
+{ 0x1b, 7 },{ 0xa0, 10 },{ 0x344, 12 },{ 0xf79, 14 },
+{ 0x79, 7 },{ 0x3e1, 10 },{ 0x2d4, 13 },{ 0x2306, 14 },
+{ 0x21, 8 },{ 0x23c, 10 },{ 0xfae, 12 },{ 0x23de, 14 },
+{ 0x35, 8 },{ 0x175, 11 },{ 0x7b3, 13 },{ 0xc5, 8 },
+{ 0x174, 11 },{ 0x785, 13 },{ 0x48, 9 },{ 0x1a3, 11 },
+{ 0x49e, 13 },{ 0x2c, 9 },{ 0xfa, 10 },{ 0x7d6, 11 },
+{ 0x92, 10 },{ 0x5cc, 13 },{ 0x1ef1, 15 },{ 0xa3, 10 },
+{ 0x3ed, 12 },{ 0x93e, 14 },{ 0x1e2, 11 },{ 0x1273, 15 },
+{ 0x7c4, 11 },{ 0x1487, 15 },{ 0x291, 12 },{ 0x293, 12 },
+{ 0xf8a, 12 },{ 0x509, 13 },{ 0x508, 13 },{ 0x78d, 13 },
+{ 0x7be, 13 },{ 0x78c, 13 },{ 0x4ae, 14 },{ 0xbba, 14 },
+{ 0x2307, 14 },{ 0xb9a, 14 },{ 0x1736, 15 },{ 0xe, 4 },
+{ 0x45, 7 },{ 0x1f3, 9 },{ 0x47a, 11 },{ 0x5dc, 13 },
+{ 0x23df, 14 },{ 0x19, 5 },{ 0x28, 9 },{ 0x176, 11 },
+{ 0x49d, 13 },{ 0x23dd, 14 },{ 0x30, 6 },{ 0xa2, 10 },
+{ 0x2ef, 12 },{ 0x5b8, 14 },{ 0x3f, 6 },{ 0xa5, 10 },
+{ 0x3db, 12 },{ 0x93f, 14 },{ 0x44, 7 },{ 0x7cb, 11 },
+{ 0x95f, 15 },{ 0x63, 7 },{ 0x3c3, 12 },{ 0x15, 8 },
+{ 0x8f6, 12 },{ 0x17, 8 },{ 0x498, 13 },{ 0x2c, 8 },
+{ 0x7b2, 13 },{ 0x2f, 8 },{ 0x1f54, 13 },{ 0x8d, 8 },
+{ 0x7bd, 13 },{ 0x8e, 8 },{ 0x1182, 13 },{ 0xfb, 8 },
+{ 0x50b, 13 },{ 0x2d, 8 },{ 0x7c0, 11 },{ 0x79, 9 },
+{ 0x1f5f, 13 },{ 0x7a, 9 },{ 0x1f56, 13 },{ 0x231, 10 },
+{ 0x3e4, 10 },{ 0x1a1, 11 },{ 0x143, 11 },{ 0x1f7, 11 },
+{ 0x16f, 12 },{ 0x292, 12 },{ 0x2e7, 12 },{ 0x16c, 12 },
+{ 0x16d, 12 },{ 0x3dc, 12 },{ 0xf8b, 12 },{ 0x499, 13 },
+{ 0x3d8, 12 },{ 0x78e, 13 },{ 0x2d5, 13 },{ 0x1f5e, 13 },
+{ 0x1f2b, 13 },{ 0x78f, 13 },{ 0x4ad, 14 },{ 0x3eaf, 14 },
+{ 0x23dc, 14 },{ 0x4a, 9 },
+};
+
+static const int8_t table2_level[185] = {
+  1,  2,  3,  4,  5,  6,  7,  8,
+  9, 10, 11, 12, 13, 14, 15, 16,
+ 17, 18, 19,  1,  2,  3,  4,  5,
+  6,  7,  8,  9, 10, 11, 12, 13,
+ 14, 15,  1,  2,  3,  4,  5,  6,
+  7,  8,  9, 10, 11, 12,  1,  2,
+  3,  4,  5,  6,  7,  8,  9, 10,
+ 11,  1,  2,  3,  4,  5,  6,  1,
+  2,  3,  4,  5,  1,  2,  3,  4,
+  1,  2,  3,  4,  1,  2,  3,  4,
+  1,  2,  3,  4,  1,  2,  3,  1,
+  2,  3,  1,  2,  3,  1,  2,  3,
+  1,  2,  3,  1,  2,  3,  1,  2,
+  1,  2,  1,  1,  1,  1,  1,  1,
+  1,  1,  1,  1,  1,  1,  1,  1,
+  2,  3,  4,  5,  6,  1,  2,  3,
+  4,  5,  1,  2,  3,  4,  1,  2,
+  3,  4,  1,  2,  3,  1,  2,  1,
+  2,  1,  2,  1,  2,  1,  2,  1,
+  2,  1,  2,  1,  2,  1,  2,  1,
+  2,  1,  2,  1,  1,  1,  1,  1,
+  1,  1,  1,  1,  1,  1,  1,  1,
+  1,  1,  1,  1,  1,  1,  1,  1,
+  1,
+};
+
+static const int8_t table2_run[185] = {
+  0,  0,  0,  0,  0,  0,  0,  0,
+  0,  0,  0,  0,  0,  0,  0,  0,
+  0,  0,  0,  1,  1,  1,  1,  1,
+  1,  1,  1,  1,  1,  1,  1,  1,
+  1,  1,  2,  2,  2,  2,  2,  2,
+  2,  2,  2,  2,  2,  2,  3,  3,
+  3,  3,  3,  3,  3,  3,  3,  3,
+  3,  4,  4,  4,  4,  4,  4,  5,
+  5,  5,  5,  5,  6,  6,  6,  6,
+  7,  7,  7,  7,  8,  8,  8,  8,
+  9,  9,  9,  9, 10, 10, 10, 11,
+ 11, 11, 12, 12, 12, 13, 13, 13,
+ 14, 14, 14, 15, 15, 15, 16, 16,
+ 17, 17, 18, 19, 20, 21, 22, 23,
+ 24, 25, 26, 27, 28, 29, 30,  0,
+  0,  0,  0,  0,  0,  1,  1,  1,
+  1,  1,  2,  2,  2,  2,  3,  3,
+  3,  3,  4,  4,  4,  5,  5,  6,
+  6,  7,  7,  8,  8,  9,  9, 10,
+ 10, 11, 11, 12, 12, 13, 13, 14,
+ 14, 15, 15, 16, 17, 18, 19, 20,
+ 21, 22, 23, 24, 25, 26, 27, 28,
+ 29, 30, 31, 32, 33, 34, 35, 36,
+ 37,
+};
+
+/* second non intra vlc table */
+static const uint16_t table4_vlc[169][2] = {
+{ 0x0, 3 },{ 0x3, 4 },{ 0xb, 5 },{ 0x14, 6 },
+{ 0x3f, 6 },{ 0x5d, 7 },{ 0xa2, 8 },{ 0xac, 9 },
+{ 0x16e, 9 },{ 0x20a, 10 },{ 0x2e2, 10 },{ 0x432, 11 },
+{ 0x5c9, 11 },{ 0x827, 12 },{ 0xb54, 12 },{ 0x4e6, 13 },
+{ 0x105f, 13 },{ 0x172a, 13 },{ 0x20b2, 14 },{ 0x2d4e, 14 },
+{ 0x39f0, 14 },{ 0x4175, 15 },{ 0x5a9e, 15 },{ 0x4, 4 },
+{ 0x1e, 5 },{ 0x42, 7 },{ 0xb6, 8 },{ 0x173, 9 },
+{ 0x395, 10 },{ 0x72e, 11 },{ 0xb94, 12 },{ 0x16a4, 13 },
+{ 0x20b3, 14 },{ 0x2e45, 14 },{ 0x5, 5 },{ 0x40, 7 },
+{ 0x49, 9 },{ 0x28f, 10 },{ 0x5cb, 11 },{ 0x48a, 13 },
+{ 0x9dd, 14 },{ 0x73e2, 15 },{ 0x18, 5 },{ 0x25, 8 },
+{ 0x8a, 10 },{ 0x51b, 11 },{ 0xe5f, 12 },{ 0x9c9, 14 },
+{ 0x139c, 15 },{ 0x29, 6 },{ 0x4f, 9 },{ 0x412, 11 },
+{ 0x48d, 13 },{ 0x2e41, 14 },{ 0x38, 6 },{ 0x10e, 9 },
+{ 0x5a8, 11 },{ 0x105c, 13 },{ 0x39f2, 14 },{ 0x58, 7 },
+{ 0x21f, 10 },{ 0xe7e, 12 },{ 0x39ff, 14 },{ 0x23, 8 },
+{ 0x2e3, 10 },{ 0x4e5, 13 },{ 0x2e40, 14 },{ 0xa1, 8 },
+{ 0x5be, 11 },{ 0x9c8, 14 },{ 0x83, 8 },{ 0x13a, 11 },
+{ 0x1721, 13 },{ 0x44, 9 },{ 0x276, 12 },{ 0x39f6, 14 },
+{ 0x8b, 10 },{ 0x4ef, 13 },{ 0x5a9b, 15 },{ 0x208, 10 },
+{ 0x1cfe, 13 },{ 0x399, 10 },{ 0x1cb4, 13 },{ 0x39e, 10 },
+{ 0x39f3, 14 },{ 0x5ab, 11 },{ 0x73e3, 15 },{ 0x737, 11 },
+{ 0x5a9f, 15 },{ 0x82d, 12 },{ 0xe69, 12 },{ 0xe68, 12 },
+{ 0x433, 11 },{ 0xb7b, 12 },{ 0x2df8, 14 },{ 0x2e56, 14 },
+{ 0x2e57, 14 },{ 0x39f7, 14 },{ 0x51a5, 15 },{ 0x3, 3 },
+{ 0x2a, 6 },{ 0xe4, 8 },{ 0x28e, 10 },{ 0x735, 11 },
+{ 0x1058, 13 },{ 0x1cfa, 13 },{ 0x2df9, 14 },{ 0x4174, 15 },
+{ 0x9, 4 },{ 0x54, 8 },{ 0x398, 10 },{ 0x48b, 13 },
+{ 0x139d, 15 },{ 0xd, 4 },{ 0xad, 9 },{ 0x826, 12 },
+{ 0x2d4c, 14 },{ 0x11, 5 },{ 0x16b, 9 },{ 0xb7f, 12 },
+{ 0x51a4, 15 },{ 0x19, 5 },{ 0x21b, 10 },{ 0x16fd, 13 },
+{ 0x1d, 5 },{ 0x394, 10 },{ 0x28d3, 14 },{ 0x2b, 6 },
+{ 0x5bc, 11 },{ 0x5a9a, 15 },{ 0x2f, 6 },{ 0x247, 12 },
+{ 0x10, 7 },{ 0xa35, 12 },{ 0x3e, 6 },{ 0xb7a, 12 },
+{ 0x59, 7 },{ 0x105e, 13 },{ 0x26, 8 },{ 0x9cf, 14 },
+{ 0x55, 8 },{ 0x1cb5, 13 },{ 0x57, 8 },{ 0xe5b, 12 },
+{ 0xa0, 8 },{ 0x1468, 13 },{ 0x170, 9 },{ 0x90, 10 },
+{ 0x1ce, 9 },{ 0x21a, 10 },{ 0x218, 10 },{ 0x168, 9 },
+{ 0x21e, 10 },{ 0x244, 12 },{ 0x736, 11 },{ 0x138, 11 },
+{ 0x519, 11 },{ 0xe5e, 12 },{ 0x72c, 11 },{ 0xb55, 12 },
+{ 0x9dc, 14 },{ 0x20bb, 14 },{ 0x48c, 13 },{ 0x1723, 13 },
+{ 0x2e44, 14 },{ 0x16a5, 13 },{ 0x518, 11 },{ 0x39fe, 14 },
+{ 0x169, 9 },
+};
+
+static const int8_t table4_level[168] = {
+  1,  2,  3,  4,  5,  6,  7,  8,
+  9, 10, 11, 12, 13, 14, 15, 16,
+ 17, 18, 19, 20, 21, 22, 23,  1,
+  2,  3,  4,  5,  6,  7,  8,  9,
+ 10, 11,  1,  2,  3,  4,  5,  6,
+  7,  8,  1,  2,  3,  4,  5,  6,
+  7,  1,  2,  3,  4,  5,  1,  2,
+  3,  4,  5,  1,  2,  3,  4,  1,
+  2,  3,  4,  1,  2,  3,  1,  2,
+  3,  1,  2,  3,  1,  2,  3,  1,
+  2,  1,  2,  1,  2,  1,  2,  1,
+  2,  1,  1,  1,  1,  1,  1,  1,
+  1,  1,  1,  1,  2,  3,  4,  5,
+  6,  7,  8,  9,  1,  2,  3,  4,
+  5,  1,  2,  3,  4,  1,  2,  3,
+  4,  1,  2,  3,  1,  2,  3,  1,
+  2,  3,  1,  2,  1,  2,  1,  2,
+  1,  2,  1,  2,  1,  2,  1,  2,
+  1,  2,  1,  1,  1,  1,  1,  1,
+  1,  1,  1,  1,  1,  1,  1,  1,
+  1,  1,  1,  1,  1,  1,  1,  1,
+};
+
+static const int8_t table4_run[168] = {
+  0,  0,  0,  0,  0,  0,  0,  0,
+  0,  0,  0,  0,  0,  0,  0,  0,
+  0,  0,  0,  0,  0,  0,  0,  1,
+  1,  1,  1,  1,  1,  1,  1,  1,
+  1,  1,  2,  2,  2,  2,  2,  2,
+  2,  2,  3,  3,  3,  3,  3,  3,
+  3,  4,  4,  4,  4,  4,  5,  5,
+  5,  5,  5,  6,  6,  6,  6,  7,
+  7,  7,  7,  8,  8,  8,  9,  9,
+  9, 10, 10, 10, 11, 11, 11, 12,
+ 12, 13, 13, 14, 14, 15, 15, 16,
+ 16, 17, 18, 19, 20, 21, 22, 23,
+ 24, 25, 26,  0,  0,  0,  0,  0,
+  0,  0,  0,  0,  1,  1,  1,  1,
+  1,  2,  2,  2,  2,  3,  3,  3,
+  3,  4,  4,  4,  5,  5,  5,  6,
+  6,  6,  7,  7,  8,  8,  9,  9,
+ 10, 10, 11, 11, 12, 12, 13, 13,
+ 14, 14, 15, 16, 17, 18, 19, 20,
+ 21, 22, 23, 24, 25, 26, 27, 28,
+ 29, 30, 31, 32, 33, 34, 35, 36,
+};
+
+extern const uint16_t inter_vlc[103][2];
+extern const int8_t inter_level[102];
+extern const int8_t inter_run[102];
+
+extern const uint16_t intra_vlc[103][2];
+extern const int8_t intra_level[102];
+extern const int8_t intra_run[102];
+
+extern const uint8_t DCtab_lum[13][2];
+extern const uint8_t DCtab_chrom[13][2];
+
+extern const uint8_t cbpy_tab[16][2];
+extern const uint8_t mvtab[33][2];
+
+extern const uint8_t intra_MCBPC_code[9];
+extern const uint8_t intra_MCBPC_bits[9];
+
+extern const uint8_t inter_MCBPC_code[28];
+extern const uint8_t inter_MCBPC_bits[28];
+
+#define NB_RL_TABLES  6
+
+static RLTable rl_table[NB_RL_TABLES] = {
+    /* intra luminance tables */
+    /* low motion  */
+    {
+        132,
+        85,
+        table0_vlc,
+        table0_run,
+        table0_level,
+    },
+    /* high motion */
+    {
+        185,
+        119,
+        table2_vlc,
+        table2_run,
+        table2_level,
+    },
+    /* mid-rate */
+    {
+        102,
+        67,
+        intra_vlc,
+        intra_run,
+        intra_level,
+    },
+    /* intra chrominance / non intra tables */
+    /* low motion inter */
+    {
+        148,
+        81,
+        table1_vlc,
+        table1_run,
+        table1_level,
+    },
+    /* high motion inter */
+    {
+        168,
+        99,
+        table4_vlc,
+        table4_run,
+        table4_level,
+    },
+    /* mid rate inter */
+    {
+        102,
+        58,
+        inter_vlc,
+        inter_run,
+        inter_level,
+    },
+};
+
+/* motion vector table 0 */
+
+static const uint16_t table0_mv_code[1100] = {
+ 0x0001, 0x0003, 0x0005, 0x0007, 0x0003, 0x0008, 0x000c, 0x0001,
+ 0x0002, 0x001b, 0x0006, 0x000b, 0x0015, 0x0002, 0x000e, 0x000f,
+ 0x0014, 0x0020, 0x0022, 0x0025, 0x0027, 0x0029, 0x002d, 0x004b,
+ 0x004d, 0x0003, 0x0022, 0x0023, 0x0025, 0x0027, 0x0042, 0x0048,
+ 0x0049, 0x0050, 0x005c, 0x0091, 0x009f, 0x000e, 0x0043, 0x004c,
+ 0x0054, 0x0056, 0x008c, 0x0098, 0x009a, 0x009b, 0x00b1, 0x00b2,
+ 0x0120, 0x0121, 0x0126, 0x0133, 0x0139, 0x01a1, 0x01a4, 0x01a5,
+ 0x01a6, 0x01a7, 0x01ae, 0x01af, 0x000b, 0x0019, 0x0085, 0x0090,
+ 0x009b, 0x00aa, 0x00af, 0x010c, 0x010e, 0x011c, 0x011e, 0x0133,
+ 0x0144, 0x0160, 0x0174, 0x0175, 0x0177, 0x0178, 0x0249, 0x024b,
+ 0x0252, 0x0261, 0x0265, 0x0270, 0x0352, 0x0353, 0x0355, 0x0359,
+ 0x0010, 0x0011, 0x0013, 0x0034, 0x0035, 0x0036, 0x0037, 0x003d,
+ 0x003e, 0x0109, 0x0126, 0x0156, 0x021a, 0x021e, 0x023a, 0x023e,
+ 0x028e, 0x028f, 0x02cf, 0x0491, 0x0494, 0x049f, 0x04a0, 0x04a3,
+ 0x04a6, 0x04a7, 0x04ad, 0x04ae, 0x04c0, 0x04c4, 0x04c6, 0x04c8,
+ 0x04c9, 0x04f5, 0x04f6, 0x04f7, 0x0680, 0x0682, 0x0683, 0x0688,
+ 0x0689, 0x068d, 0x068e, 0x068f, 0x06a2, 0x06a3, 0x06a9, 0x06b0,
+ 0x06b1, 0x06b4, 0x06b5, 0x0024, 0x0060, 0x0063, 0x0078, 0x0079,
+ 0x0211, 0x0244, 0x0245, 0x0247, 0x0248, 0x0249, 0x024a, 0x024b,
+ 0x026b, 0x02af, 0x02b8, 0x02bb, 0x0436, 0x0476, 0x0477, 0x047e,
+ 0x04c8, 0x04c9, 0x04ca, 0x0514, 0x0586, 0x0587, 0x0598, 0x059d,
+ 0x05d9, 0x05da, 0x0920, 0x0921, 0x093b, 0x093c, 0x093d, 0x0942,
+ 0x0943, 0x0944, 0x0945, 0x0959, 0x095e, 0x095f, 0x0982, 0x0983,
+ 0x098e, 0x098f, 0x09c4, 0x09e7, 0x09e8, 0x09e9, 0x0d02, 0x0d17,
+ 0x0d18, 0x0d19, 0x0d41, 0x0d42, 0x0d43, 0x0d50, 0x0d5f, 0x0d6d,
+ 0x0d6e, 0x0d6f, 0x0052, 0x0053, 0x0054, 0x0055, 0x0056, 0x0057,
+ 0x00c2, 0x00c3, 0x00c4, 0x00c5, 0x041e, 0x041f, 0x0420, 0x0421,
+ 0x048c, 0x048d, 0x04d3, 0x04d4, 0x04d5, 0x055c, 0x055d, 0x0572,
+ 0x0573, 0x0574, 0x0575, 0x08de, 0x08df, 0x08fe, 0x08ff, 0x0996,
+ 0x0a36, 0x0a37, 0x0b08, 0x0b09, 0x0b0a, 0x0b0b, 0x0b32, 0x0b33,
+ 0x0b34, 0x0b35, 0x0b36, 0x0b37, 0x0b38, 0x0b39, 0x0bb0, 0x0bf7,
+ 0x0bf8, 0x0bf9, 0x0bfa, 0x0bfb, 0x0bfc, 0x0bfd, 0x0bfe, 0x0bff,
+ 0x1254, 0x1255, 0x1256, 0x1257, 0x1270, 0x1271, 0x1272, 0x1273,
+ 0x1274, 0x1275, 0x12ab, 0x12ac, 0x12ad, 0x12ae, 0x12af, 0x12b0,
+ 0x12b1, 0x1315, 0x1316, 0x1317, 0x13bf, 0x13c0, 0x13c1, 0x13c2,
+ 0x13c3, 0x13c4, 0x13c5, 0x13c6, 0x13c7, 0x13c8, 0x13c9, 0x13ca,
+ 0x13cb, 0x13cc, 0x13cd, 0x1a06, 0x1a07, 0x1a28, 0x1a29, 0x1a2a,
+ 0x1a2b, 0x1a2c, 0x1a2d, 0x1a80, 0x1abb, 0x1abc, 0x1abd, 0x1ad8,
+ 0x1ad9, 0x0094, 0x0095, 0x0096, 0x0097, 0x00a0, 0x00a1, 0x00a2,
+ 0x00a3, 0x0831, 0x0832, 0x0833, 0x0834, 0x0835, 0x0836, 0x0837,
+ 0x0838, 0x0839, 0x083a, 0x083b, 0x0939, 0x093a, 0x093b, 0x093c,
+ 0x093d, 0x093e, 0x093f, 0x09a0, 0x09a1, 0x09a2, 0x09a3, 0x09a4,
+ 0x09a5, 0x11ac, 0x11ad, 0x11ae, 0x11af, 0x11b0, 0x11b1, 0x11b2,
+ 0x11b3, 0x11b4, 0x11b5, 0x11b6, 0x11b7, 0x11b8, 0x11b9, 0x11ba,
+ 0x11bb, 0x132f, 0x1454, 0x1455, 0x1456, 0x1457, 0x1458, 0x1459,
+ 0x145a, 0x145b, 0x145c, 0x145d, 0x145e, 0x145f, 0x1460, 0x1461,
+ 0x1462, 0x1463, 0x1464, 0x1465, 0x1466, 0x1467, 0x1468, 0x1469,
+ 0x146a, 0x146b, 0x17de, 0x17df, 0x17e0, 0x17e1, 0x17e2, 0x17e3,
+ 0x17e4, 0x17e5, 0x17e6, 0x17e7, 0x17e8, 0x17e9, 0x17ea, 0x17eb,
+ 0x17ec, 0x17ed, 0x2540, 0x2541, 0x2542, 0x2543, 0x2544, 0x2545,
+ 0x2546, 0x2547, 0x2548, 0x2549, 0x254a, 0x254b, 0x254c, 0x254d,
+ 0x254e, 0x254f, 0x2550, 0x2551, 0x2552, 0x2553, 0x2554, 0x2555,
+ 0x2628, 0x2766, 0x2767, 0x2768, 0x2769, 0x276a, 0x276b, 0x276c,
+ 0x276d, 0x276e, 0x276f, 0x2770, 0x2771, 0x2772, 0x2773, 0x2774,
+ 0x2775, 0x2776, 0x2777, 0x2778, 0x2779, 0x277a, 0x277b, 0x277c,
+ 0x277d, 0x3503, 0x3544, 0x3545, 0x3546, 0x3547, 0x3560, 0x3561,
+ 0x3562, 0x3563, 0x3564, 0x3565, 0x3566, 0x3567, 0x3568, 0x3569,
+ 0x356a, 0x356b, 0x356c, 0x356d, 0x356e, 0x356f, 0x3570, 0x3571,
+ 0x3572, 0x3573, 0x3574, 0x3575, 0x03f0, 0x103d, 0x103e, 0x103f,
+ 0x1040, 0x1041, 0x1042, 0x1043, 0x1044, 0x1045, 0x1046, 0x1047,
+ 0x1048, 0x1049, 0x104a, 0x104b, 0x104c, 0x104d, 0x104e, 0x104f,
+ 0x1050, 0x1051, 0x1052, 0x1053, 0x1054, 0x1055, 0x1056, 0x1057,
+ 0x1058, 0x1059, 0x105a, 0x105b, 0x105c, 0x105d, 0x105e, 0x105f,
+ 0x1060, 0x1061, 0x1270, 0x1271, 0x21b8, 0x21b9, 0x21ba, 0x21bb,
+ 0x21bc, 0x21bd, 0x21be, 0x21bf, 0x21f0, 0x21f1, 0x21f2, 0x21f3,
+ 0x21f4, 0x21f5, 0x21f6, 0x21f7, 0x21f8, 0x21f9, 0x21fa, 0x21fb,
+ 0x21fc, 0x21fd, 0x21fe, 0x21ff, 0x2340, 0x2341, 0x2342, 0x2343,
+ 0x2344, 0x2345, 0x2346, 0x2347, 0x2348, 0x2349, 0x234a, 0x234b,
+ 0x234c, 0x234d, 0x234e, 0x234f, 0x2350, 0x2351, 0x2352, 0x2353,
+ 0x2354, 0x2355, 0x2356, 0x2357, 0x265c, 0x2f88, 0x2f89, 0x2f8a,
+ 0x2f8b, 0x2f8c, 0x2f8d, 0x2f8e, 0x2f8f, 0x2f90, 0x2f91, 0x2f92,
+ 0x2f93, 0x2f94, 0x2f95, 0x2f96, 0x2f97, 0x2f98, 0x2f99, 0x2f9a,
+ 0x2f9b, 0x2f9c, 0x2f9d, 0x2f9e, 0x2f9f, 0x2fa0, 0x2fa1, 0x2fa2,
+ 0x2fa3, 0x2fa4, 0x2fa5, 0x2fa6, 0x2fa7, 0x2fa8, 0x2fa9, 0x2faa,
+ 0x2fab, 0x2fac, 0x2fad, 0x2fae, 0x2faf, 0x2fb0, 0x2fb1, 0x2fb2,
+ 0x2fb3, 0x2fb4, 0x2fb5, 0x2fb6, 0x2fb7, 0x2fb8, 0x2fb9, 0x2fba,
+ 0x2fbb, 0x4c52, 0x4c53, 0x4e28, 0x4e29, 0x4e2a, 0x4e2b, 0x4e2c,
+ 0x4e2d, 0x4e2e, 0x4e2f, 0x4e30, 0x4e31, 0x4e32, 0x4e33, 0x4e34,
+ 0x4e35, 0x4e36, 0x4e37, 0x4e38, 0x4e39, 0x4e3a, 0x4e3b, 0x4e3c,
+ 0x4e3d, 0x4e3e, 0x4e3f, 0x4e80, 0x4e81, 0x4e82, 0x4e83, 0x4e84,
+ 0x4e85, 0x4e86, 0x4e87, 0x4e88, 0x4e89, 0x4e8a, 0x4e8b, 0x4e8c,
+ 0x4e8d, 0x4e8e, 0x4e8f, 0x4e90, 0x4e91, 0x4e92, 0x4e93, 0x4e94,
+ 0x4e95, 0x4e96, 0x4e97, 0x4e98, 0x4e99, 0x4e9a, 0x4e9b, 0x4e9c,
+ 0x4e9d, 0x4e9e, 0x4e9f, 0x4ea0, 0x4ea1, 0x4ea2, 0x4ea3, 0x4ea4,
+ 0x4ea5, 0x4ea6, 0x4ea7, 0x4ea8, 0x4ea9, 0x4eaa, 0x4eab, 0x4eac,
+ 0x4ead, 0x4eae, 0x4eaf, 0x4eb0, 0x4eb1, 0x4eb2, 0x4eb3, 0x4eb4,
+ 0x4eb5, 0x4eb6, 0x4eb7, 0x4eb8, 0x4eb9, 0x4eba, 0x4ebb, 0x4ebc,
+ 0x4ebd, 0x4ebe, 0x4ebf, 0x4ec0, 0x4ec1, 0x4ec2, 0x4ec3, 0x4ec4,
+ 0x4ec5, 0x4ec6, 0x4ec7, 0x4ec8, 0x4ec9, 0x4eca, 0x4ecb, 0x6a04,
+ 0x6a05, 0x07e2, 0x07e3, 0x07e4, 0x07e5, 0x07e6, 0x07e7, 0x07e8,
+ 0x07e9, 0x07ea, 0x07eb, 0x07ec, 0x07ed, 0x07ee, 0x07ef, 0x07f0,
+ 0x07f1, 0x07f2, 0x07f3, 0x07f4, 0x07f5, 0x07f6, 0x07f7, 0x07f8,
+ 0x07f9, 0x07fa, 0x07fb, 0x07fc, 0x07fd, 0x07fe, 0x07ff, 0x2000,
+ 0x2001, 0x2002, 0x2003, 0x2004, 0x2005, 0x2006, 0x2007, 0x2008,
+ 0x2009, 0x200a, 0x200b, 0x200c, 0x200d, 0x200e, 0x200f, 0x2010,
+ 0x2011, 0x2012, 0x2013, 0x2014, 0x2015, 0x2016, 0x2017, 0x2018,
+ 0x2019, 0x201a, 0x201b, 0x201c, 0x201d, 0x201e, 0x201f, 0x2020,
+ 0x2021, 0x2022, 0x2023, 0x2024, 0x2025, 0x2026, 0x2027, 0x2028,
+ 0x2029, 0x202a, 0x202b, 0x202c, 0x202d, 0x202e, 0x202f, 0x2030,
+ 0x2031, 0x2032, 0x2033, 0x2034, 0x2035, 0x2036, 0x2037, 0x2038,
+ 0x2039, 0x203a, 0x203b, 0x203c, 0x203d, 0x203e, 0x203f, 0x2040,
+ 0x2041, 0x2042, 0x2043, 0x2044, 0x2045, 0x2046, 0x2047, 0x2048,
+ 0x2049, 0x204a, 0x204b, 0x204c, 0x204d, 0x204e, 0x204f, 0x2050,
+ 0x2051, 0x2052, 0x2053, 0x2054, 0x2055, 0x2056, 0x2057, 0x2058,
+ 0x2059, 0x205a, 0x205b, 0x205c, 0x205d, 0x205e, 0x205f, 0x2060,
+ 0x2061, 0x2062, 0x2063, 0x2064, 0x2065, 0x2066, 0x2067, 0x2068,
+ 0x2069, 0x206a, 0x206b, 0x206c, 0x206d, 0x206e, 0x206f, 0x2070,
+ 0x2071, 0x2072, 0x2073, 0x2074, 0x2075, 0x2076, 0x2077, 0x2078,
+ 0x2079, 0x4cba, 0x4cbb, 0x5d88, 0x5d89, 0x5d8a, 0x5d8b, 0x5d8c,
+ 0x5d8d, 0x5d8e, 0x5d8f, 0x5db0, 0x5db1, 0x5db2, 0x5db3, 0x5db4,
+ 0x5db5, 0x5db6, 0x5db7, 0x5db8, 0x5db9, 0x5dba, 0x5dbb, 0x5dbc,
+ 0x5dbd, 0x5dbe, 0x5dbf, 0x5e40, 0x5e41, 0x5e42, 0x5e43, 0x5e44,
+ 0x5e45, 0x5e46, 0x5e47, 0x5e48, 0x5e49, 0x5e4a, 0x5e4b, 0x5e4c,
+ 0x5e4d, 0x5e4e, 0x5e4f, 0x5e50, 0x5e51, 0x5e52, 0x5e53, 0x5e54,
+ 0x5e55, 0x5e56, 0x5e57, 0x5e58, 0x5e59, 0x5e5a, 0x5e5b, 0x5e5c,
+ 0x5e5d, 0x5e5e, 0x5e5f, 0x5e60, 0x5e61, 0x5e62, 0x5e63, 0x5e64,
+ 0x5e65, 0x5e66, 0x5e67, 0x5e68, 0x5e69, 0x5e6a, 0x5e6b, 0x5e6c,
+ 0x5e6d, 0x5e6e, 0x5e6f, 0x5e70, 0x5e71, 0x5e72, 0x5e73, 0x5e74,
+ 0x5e75, 0x5e76, 0x5e77, 0x5e78, 0x5e79, 0x5e7a, 0x5e7b, 0x5e7c,
+ 0x5e7d, 0x5e7e, 0x5e7f, 0x5e80, 0x5e81, 0x5e82, 0x5e83, 0x5e84,
+ 0x5e85, 0x5e86, 0x5e87, 0x5e88, 0x5e89, 0x5e8a, 0x5e8b, 0x5e8c,
+ 0x5e8d, 0x5e8e, 0x5e8f, 0x5e90, 0x5e91, 0x5e92, 0x5e93, 0x5e94,
+ 0x5e95, 0x5e96, 0x5e97, 0x5e98, 0x5e99, 0x5e9a, 0x5e9b, 0x5e9c,
+ 0x5e9d, 0x5e9e, 0x5e9f, 0x5ea0, 0x5ea1, 0x5ea2, 0x5ea3, 0x5ea4,
+ 0x5ea5, 0x5ea6, 0x5ea7, 0x5ea8, 0x5ea9, 0x5eaa, 0x5eab, 0x5eac,
+ 0x5ead, 0x5eae, 0x5eaf, 0x5eb0, 0x5eb1, 0x5eb2, 0x5eb3, 0x5eb4,
+ 0x5eb5, 0x5eb6, 0x5eb7, 0x5eb8, 0x5eb9, 0x5eba, 0x5ebb, 0x5ebc,
+ 0x5ebd, 0x5ebe, 0x5ebf, 0x5ec0, 0x5ec1, 0x5ec2, 0x5ec3, 0x5ec4,
+ 0x5ec5, 0x5ec6, 0x5ec7, 0x5ec8, 0x5ec9, 0x5eca, 0x5ecb, 0x5ecc,
+ 0x5ecd, 0x5ece, 0x5ecf, 0x5ed0, 0x5ed1, 0x5ed2, 0x5ed3, 0x5ed4,
+ 0x5ed5, 0x5ed6, 0x5ed7, 0x5ed8, 0x5ed9, 0x5eda, 0x5edb, 0x5edc,
+ 0x5edd, 0x5ede, 0x5edf, 0x5ee0, 0x5ee1, 0x5ee2, 0x5ee3, 0x5ee4,
+ 0x5ee5, 0x5ee6, 0x5ee7, 0x5ee8, 0x5ee9, 0x5eea, 0x5eeb, 0x5eec,
+ 0x5eed, 0x5eee, 0x5eef, 0x5ef0, 0x5ef1, 0x5ef2, 0x5ef3, 0x5ef4,
+ 0x5ef5, 0x5ef6, 0x5ef7, 0x5ef8, 0x5ef9, 0x5efa, 0x5efb, 0x5efc,
+ 0x5efd, 0x5efe, 0x5eff, 0x5f00, 0x5f01, 0x5f02, 0x5f03, 0x5f04,
+ 0x5f05, 0x5f06, 0x5f07, 0x5f08, 0x5f09, 0x5f0a, 0x5f0b, 0x5f0c,
+ 0x5f0d, 0x5f0e, 0x5f0f, 0x0000,
+};
+
+static const uint8_t table0_mv_bits[1100] = {
+  1,  4,  4,  4,  5,  5,  5,  6,
+  6,  6,  7,  7,  7,  8,  8,  8,
+  8,  8,  8,  8,  8,  8,  8,  8,
+  8,  9,  9,  9,  9,  9,  9,  9,
+  9,  9,  9,  9,  9, 10, 10, 10,
+ 10, 10, 10, 10, 10, 10, 10, 10,
+ 10, 10, 10, 10, 10, 10, 10, 10,
+ 10, 10, 10, 10, 11, 11, 11, 11,
+ 11, 11, 11, 11, 11, 11, 11, 11,
+ 11, 11, 11, 11, 11, 11, 11, 11,
+ 11, 11, 11, 11, 11, 11, 11, 11,
+ 12, 12, 12, 12, 12, 12, 12, 12,
+ 12, 12, 12, 12, 12, 12, 12, 12,
+ 12, 12, 12, 12, 12, 12, 12, 12,
+ 12, 12, 12, 12, 12, 12, 12, 12,
+ 12, 12, 12, 12, 12, 12, 12, 12,
+ 12, 12, 12, 12, 12, 12, 12, 12,
+ 12, 12, 12, 13, 13, 13, 13, 13,
+ 13, 13, 13, 13, 13, 13, 13, 13,
+ 13, 13, 13, 13, 13, 13, 13, 13,
+ 13, 13, 13, 13, 13, 13, 13, 13,
+ 13, 13, 13, 13, 13, 13, 13, 13,
+ 13, 13, 13, 13, 13, 13, 13, 13,
+ 13, 13, 13, 13, 13, 13, 13, 13,
+ 13, 13, 13, 13, 13, 13, 13, 13,
+ 13, 13, 14, 14, 14, 14, 14, 14,
+ 14, 14, 14, 14, 14, 14, 14, 14,
+ 14, 14, 14, 14, 14, 14, 14, 14,
+ 14, 14, 14, 14, 14, 14, 14, 14,
+ 14, 14, 14, 14, 14, 14, 14, 14,
+ 14, 14, 14, 14, 14, 14, 14, 14,
+ 14, 14, 14, 14, 14, 14, 14, 14,
+ 14, 14, 14, 14, 14, 14, 14, 14,
+ 14, 14, 14, 14, 14, 14, 14, 14,
+ 14, 14, 14, 14, 14, 14, 14, 14,
+ 14, 14, 14, 14, 14, 14, 14, 14,
+ 14, 14, 14, 14, 14, 14, 14, 14,
+ 14, 14, 14, 14, 14, 14, 14, 14,
+ 14, 15, 15, 15, 15, 15, 15, 15,
+ 15, 15, 15, 15, 15, 15, 15, 15,
+ 15, 15, 15, 15, 15, 15, 15, 15,
+ 15, 15, 15, 15, 15, 15, 15, 15,
+ 15, 15, 15, 15, 15, 15, 15, 15,
+ 15, 15, 15, 15, 15, 15, 15, 15,
+ 15, 15, 15, 15, 15, 15, 15, 15,
+ 15, 15, 15, 15, 15, 15, 15, 15,
+ 15, 15, 15, 15, 15, 15, 15, 15,
+ 15, 15, 15, 15, 15, 15, 15, 15,
+ 15, 15, 15, 15, 15, 15, 15, 15,
+ 15, 15, 15, 15, 15, 15, 15, 15,
+ 15, 15, 15, 15, 15, 15, 15, 15,
+ 15, 15, 15, 15, 15, 15, 15, 15,
+ 15, 15, 15, 15, 15, 15, 15, 15,
+ 15, 15, 15, 15, 15, 15, 15, 15,
+ 15, 15, 15, 15, 15, 15, 15, 15,
+ 15, 15, 15, 15, 15, 15, 15, 15,
+ 15, 15, 15, 15, 15, 15, 15, 15,
+ 15, 15, 15, 15, 15, 15, 15, 15,
+ 15, 15, 15, 15, 16, 16, 16, 16,
+ 16, 16, 16, 16, 16, 16, 16, 16,
+ 16, 16, 16, 16, 16, 16, 16, 16,
+ 16, 16, 16, 16, 16, 16, 16, 16,
+ 16, 16, 16, 16, 16, 16, 16, 16,
+ 16, 16, 16, 16, 16, 16, 16, 16,
+ 16, 16, 16, 16, 16, 16, 16, 16,
+ 16, 16, 16, 16, 16, 16, 16, 16,
+ 16, 16, 16, 16, 16, 16, 16, 16,
+ 16, 16, 16, 16, 16, 16, 16, 16,
+ 16, 16, 16, 16, 16, 16, 16, 16,
+ 16, 16, 16, 16, 16, 16, 16, 16,
+ 16, 16, 16, 16, 16, 16, 16, 16,
+ 16, 16, 16, 16, 16, 16, 16, 16,
+ 16, 16, 16, 16, 16, 16, 16, 16,
+ 16, 16, 16, 16, 16, 16, 16, 16,
+ 16, 16, 16, 16, 16, 16, 16, 16,
+ 16, 16, 16, 16, 16, 16, 16, 16,
+ 16, 16, 16, 16, 16, 16, 16, 16,
+ 16, 16, 16, 16, 16, 16, 16, 16,
+ 16, 16, 16, 16, 16, 16, 16, 16,
+ 16, 16, 16, 16, 16, 16, 16, 16,
+ 16, 16, 16, 16, 16, 16, 16, 16,
+ 16, 16, 16, 16, 16, 16, 16, 16,
+ 16, 16, 16, 16, 16, 16, 16, 16,
+ 16, 16, 16, 16, 16, 16, 16, 16,
+ 16, 16, 16, 16, 16, 16, 16, 16,
+ 16, 16, 16, 16, 16, 16, 16, 16,
+ 16, 16, 16, 16, 16, 16, 16, 16,
+ 16, 16, 16, 16, 16, 16, 16, 16,
+ 16, 16, 16, 16, 16, 16, 16, 16,
+ 16, 17, 17, 17, 17, 17, 17, 17,
+ 17, 17, 17, 17, 17, 17, 17, 17,
+ 17, 17, 17, 17, 17, 17, 17, 17,
+ 17, 17, 17, 17, 17, 17, 17, 17,
+ 17, 17, 17, 17, 17, 17, 17, 17,
+ 17, 17, 17, 17, 17, 17, 17, 17,
+ 17, 17, 17, 17, 17, 17, 17, 17,
+ 17, 17, 17, 17, 17, 17, 17, 17,
+ 17, 17, 17, 17, 17, 17, 17, 17,
+ 17, 17, 17, 17, 17, 17, 17, 17,
+ 17, 17, 17, 17, 17, 17, 17, 17,
+ 17, 17, 17, 17, 17, 17, 17, 17,
+ 17, 17, 17, 17, 17, 17, 17, 17,
+ 17, 17, 17, 17, 17, 17, 17, 17,
+ 17, 17, 17, 17, 17, 17, 17, 17,
+ 17, 17, 17, 17, 17, 17, 17, 17,
+ 17, 17, 17, 17, 17, 17, 17, 17,
+ 17, 17, 17, 17, 17, 17, 17, 17,
+ 17, 17, 17, 17, 17, 17, 17, 17,
+ 17, 17, 17, 17, 17, 17, 17, 17,
+ 17, 17, 17, 17, 17, 17, 17, 17,
+ 17, 17, 17, 17, 17, 17, 17, 17,
+ 17, 17, 17, 17, 17, 17, 17, 17,
+ 17, 17, 17, 17, 17, 17, 17, 17,
+ 17, 17, 17, 17, 17, 17, 17, 17,
+ 17, 17, 17, 17, 17, 17, 17, 17,
+ 17, 17, 17, 17, 17, 17, 17, 17,
+ 17, 17, 17, 17, 17, 17, 17, 17,
+ 17, 17, 17, 17, 17, 17, 17, 17,
+ 17, 17, 17, 17, 17, 17, 17, 17,
+ 17, 17, 17, 17, 17, 17, 17, 17,
+ 17, 17, 17, 17, 17, 17, 17, 17,
+ 17, 17, 17, 17, 17, 17, 17, 17,
+ 17, 17, 17, 17, 17, 17, 17, 17,
+ 17, 17, 17, 17, 17, 17, 17, 17,
+ 17, 17, 17, 17, 17, 17, 17, 17,
+ 17, 17, 17, 17, 17, 17, 17, 17,
+ 17, 17, 17, 17, 17, 17, 17, 17,
+ 17, 17, 17, 17, 17, 17, 17, 17,
+ 17, 17, 17, 17, 17, 17, 17, 17,
+ 17, 17, 17, 17, 17, 17, 17, 17,
+ 17, 17, 17, 17, 17, 17, 17, 17,
+ 17, 17, 17, 17, 17, 17, 17, 17,
+ 17, 17, 17, 17, 17, 17, 17, 17,
+ 17, 17, 17, 17, 17, 17, 17, 17,
+ 17, 17, 17, 17, 17, 17, 17, 17,
+ 17, 17, 17, 17, 17, 17, 17, 17,
+ 17, 17, 17, 17, 17, 17, 17, 17,
+ 17, 17, 17,  8,
+};
+
+static const uint8_t table0_mvx[1099] = {
+ 32, 32, 31, 32, 33, 31, 33, 31,
+ 33, 32, 34, 32, 30, 32, 31, 34,
+ 35, 32, 34, 33, 29, 33, 30, 30,
+ 31, 31, 35, 29, 33, 35, 33, 34,
+ 31, 29, 30, 34, 30, 36, 28, 32,
+ 34, 37, 30, 27, 32, 25, 39, 32,
+ 34, 32, 35, 35, 35, 31, 35, 29,
+ 32, 29, 30, 29, 37, 27, 36, 38,
+ 37, 33, 32, 31, 29, 31, 28, 36,
+ 33, 30, 34, 33, 33, 28, 27, 25,
+ 31, 26, 39, 32, 32, 31, 33, 39,
+ 31, 38, 28, 36, 21, 23, 43, 36,
+ 34, 41, 30, 25, 28, 31, 30, 34,
+ 38, 35, 61, 34, 28, 30, 37, 37,
+ 35, 27, 36,  3, 59, 38, 37, 32,
+ 31, 29, 26, 33, 37, 33, 27, 27,
+ 35, 34, 34, 40, 42, 33, 32, 29,
+  4,  5, 28, 24, 25, 35, 39, 38,
+ 32, 23, 27, 32, 30, 35, 26, 34,
+ 60, 36, 29, 22, 26, 41,  7, 30,
+ 38, 30, 36, 29, 30, 41, 26, 25,
+ 32, 34, 24, 39,  1, 25, 39, 32,
+ 28, 29, 32, 38, 26, 36, 28, 63,
+ 28, 39, 23, 21, 26, 35, 31, 35,
+ 57, 31, 29, 29, 28, 30, 27, 35,
+  2, 38, 40, 34, 37, 29, 38, 43,
+ 26, 32, 33, 42, 24, 40, 28, 32,
+ 32, 32, 36, 32, 43, 25, 21, 31,
+ 30, 31, 41, 29, 33, 37, 26, 37,
+ 27, 59, 23, 33, 35, 31, 31, 37,
+ 38, 39, 32, 23, 32, 27, 37, 36,
+ 31, 40, 25, 27, 38, 31, 36, 28,
+ 31, 36, 25, 45,  3, 34, 38, 39,
+ 40, 38, 30, 32, 19, 24, 25, 26,
+ 45, 20, 24, 33, 33, 31, 41, 34,
+ 39, 47, 40, 58, 59, 41, 33,  3,
+ 17, 61, 42, 30, 26, 29, 36, 61,
+ 33, 37, 62, 28, 25, 38, 25, 38,
+ 17, 23, 34, 33, 21, 33, 49, 27,
+ 32, 23, 27, 22, 24, 22, 39, 43,
+ 27, 37,  6, 42, 47, 26, 30, 31,
+ 41, 39, 33, 22, 45, 36, 32, 45,
+ 19, 22, 30,  5,  5, 17, 29, 22,
+ 31, 31, 43, 37, 27, 32, 32, 32,
+ 33, 34, 43, 35, 29, 26, 22, 32,
+ 19, 32, 25, 31, 41, 49, 28, 34,
+ 28, 39, 34, 19, 37, 38, 29, 21,
+ 36, 42, 24, 48, 16, 28, 49, 22,
+ 34, 31, 38, 39, 44, 11, 35, 30,
+ 33, 33, 23, 28, 33, 46, 15, 13,
+ 24, 41, 24, 34, 34, 30, 26, 24,
+ 14, 60, 21, 29, 39, 23, 35, 37,
+ 63, 45, 33, 34, 47, 41, 22, 42,
+ 35, 35, 23, 32, 35, 43, 32,  7,
+ 31, 41, 20, 31, 16, 13, 63, 25,
+ 30, 32, 35, 30, 30, 31, 42, 47,
+ 39, 38, 40, 40, 51, 55, 56, 18,
+ 21, 39, 39, 33, 17, 41, 23, 24,
+ 43, 25, 31, 20, 19, 45,  1, 34,
+ 31, 22, 35, 15, 46, 46, 35, 31,
+ 28, 29, 29, 23, 41, 27, 14, 53,
+ 53, 27, 24, 32, 57, 32, 17, 42,
+ 37, 29, 33,  1, 25, 32, 32, 63,
+ 26, 40, 44, 36, 31, 39, 20, 20,
+ 44, 23, 33, 34, 35, 33, 33, 28,
+ 41, 23, 41, 41, 29, 25, 26, 49,
+ 29, 24, 37, 49, 50, 51, 51, 26,
+ 39, 25, 26, 15, 39, 18, 42, 17,
+  4, 31, 32, 32, 60,  1, 42, 32,
+  0, 12, 19, 35, 21, 41, 17, 26,
+ 20, 45, 46, 32, 37, 22, 47, 29,
+ 31, 27, 29, 30, 21, 33, 35, 18,
+ 25, 33, 50, 51, 42,  2, 15, 51,
+ 53, 33, 25, 29, 55, 37, 38, 33,
+ 38, 59, 38, 33, 39, 13, 32, 40,
+ 61, 61, 32,  9, 44,  3, 31, 29,
+ 25, 31, 27, 23,  9, 25,  9, 29,
+ 20, 30, 30, 42, 18, 28, 25, 28,
+ 28, 21, 29, 43, 29, 43, 26, 44,
+ 44, 21, 38, 21, 24, 45, 45, 35,
+ 39, 22, 35, 36, 34, 34, 45, 34,
+ 29, 31, 46, 25, 46, 16, 17, 31,
+ 20, 32, 47, 47, 47, 32, 49, 49,
+ 49, 31,  1, 27, 28, 39, 39, 21,
+ 36, 23, 51,  2, 40, 51, 32, 53,
+ 24, 30, 24, 30, 21, 40, 57, 57,
+ 31, 41, 58, 32, 12,  4, 32, 34,
+ 59, 31, 32, 13,  9, 35, 26, 35,
+ 37, 61, 37, 63, 26, 29, 41, 38,
+ 23, 20, 41, 26, 41, 42, 42, 42,
+ 26, 26, 26, 26,  1, 26, 37, 37,
+ 37, 23, 34, 42, 27, 43, 34, 27,
+ 31, 24, 33, 16,  3, 31, 24, 33,
+ 24,  4, 44, 44, 11, 44, 31, 13,
+ 13, 44, 45, 13, 25, 22, 38, 26,
+ 38, 38, 39, 32, 30, 39, 30, 22,
+ 32, 26, 30, 47, 47, 47, 19, 47,
+ 30, 31, 35,  8, 23, 47, 47, 27,
+ 35, 47, 31, 48, 35, 19, 36, 49,
+ 49, 33, 31, 39, 27, 39, 49, 49,
+ 50, 50, 50, 39, 31, 51, 51, 39,
+ 28, 33, 33, 21, 40, 31, 52, 53,
+ 40, 53,  9, 33, 31, 53, 54, 54,
+ 54, 55, 55, 34, 15, 56, 25, 56,
+ 21, 21, 40, 40, 25, 40, 58, 36,
+  5, 41, 41, 12, 60, 41, 41, 37,
+ 22, 61, 18, 29, 29, 30, 61, 30,
+ 61, 62, 62, 30, 30, 63, 18, 13,
+ 30, 23, 19, 20, 20, 41, 13,  2,
+  5,  5,  1,  5, 32,  6, 32, 35,
+ 20, 35, 27, 35, 35, 36, 36, 13,
+ 36, 41, 41, 41,  3, 30, 42, 27,
+ 20, 30, 27, 28, 30, 21, 33, 33,
+ 14, 24, 30, 42, 24, 33, 25, 42,
+ 43, 14, 43, 43, 14, 43,  7, 36,
+ 37, 37, 37, 37,  7, 14, 25, 43,
+ 43, 44, 15, 37,  7,  7,  3,  1,
+  8, 15, 15,  8, 44, 44, 44, 45,
+ 45, 45, 45,  8,  8, 45, 21, 45,
+ 28, 28, 28, 21, 28, 28, 22, 37,
+ 46, 46, 37,  8, 29, 37, 29, 22,
+ 46, 37, 22, 29, 47, 47, 38, 38,
+ 16, 38, 38, 33, 38, 22, 47, 47,
+ 29, 25, 16,  0, 48,  1, 34, 48,
+ 48, 34, 25, 26, 26, 49, 49, 26,
+  1, 49,  4, 26,  4, 49,  1,  9,
+ 49, 49, 49, 10, 49, 17, 38, 17,
+ 17, 50, 38, 50, 50, 22, 38, 51,
+ 38, 38, 51, 39, 39, 18, 22, 39,
+ 51, 22, 52, 52, 52, 39, 53, 53,
+ 10, 23, 18, 29, 10, 53, 29, 54,
+ 11, 54, 11, 11, 55,  1, 18, 55,
+ 55, 55, 55, 55, 55, 29, 34, 18,
+ 29, 56, 56, 34, 57, 34, 34, 29,
+ 29, 57, 57, 35, 35, 35, 35, 35,
+ 39, 35, 59, 59, 18, 59, 39, 30,
+ 18, 40, 60, 60, 61, 30, 18, 61,
+ 61, 19, 19,
+};
+
+static const uint8_t table0_mvy[1099] = {
+ 32, 31, 32, 33, 32, 31, 31, 33,
+ 33, 34, 32, 30, 32, 35, 34, 31,
+ 32, 29, 33, 30, 32, 34, 33, 31,
+ 30, 35, 31, 31, 29, 33, 35, 30,
+ 29, 33, 34, 34, 30, 32, 32, 36,
+ 29, 32, 35, 32, 28, 32, 32, 27,
+ 35, 37, 34, 29, 30, 36, 35, 34,
+ 25, 30, 29, 35, 33, 31, 31, 32,
+ 31, 28, 39, 28, 29, 37, 31, 33,
+ 27, 36, 28, 36, 37, 33, 33, 31,
+ 27, 32, 31, 38, 26, 25, 25, 33,
+ 39, 31, 34, 30, 32, 32, 32, 34,
+ 36, 32, 28, 33, 30, 38, 37, 27,
+ 33, 28, 32, 37, 35, 38, 29, 34,
+ 27, 29, 29, 32, 32, 34, 35,  3,
+ 26, 36, 31, 38, 30, 26, 35, 34,
+ 37, 26, 25, 32, 32, 39, 23, 37,
+ 32, 32, 29, 32, 29, 36, 29, 30,
+ 41, 31, 30, 21, 39, 25, 34, 38,
+ 32, 35, 39, 32, 33, 33, 32, 27,
+ 29, 25, 28, 27, 26, 31, 30, 35,
+ 24, 24, 31, 34, 32, 30, 35, 40,
+ 28, 38,  5, 35, 29, 36, 36, 32,
+ 38, 30, 33, 31, 35, 26, 23, 38,
+ 32, 41, 28, 25, 37, 40, 37, 39,
+ 32, 36, 33, 39, 25, 26, 28, 31,
+ 28, 42, 23, 31, 33, 31, 39,  1,
+ 59, 22, 27,  4, 33, 34, 33, 24,
+ 41,  3, 35, 41, 41, 28, 36, 36,
+ 28, 33, 35, 21, 23, 21, 22, 37,
+ 27, 27, 43, 29, 60, 39, 27, 25,
+ 59, 34, 27, 27, 26, 40, 37, 27,
+ 61, 26, 39, 33, 31, 22, 37, 25,
+ 30, 25, 24, 61, 31, 34, 25, 38,
+ 32, 32, 30,  3, 61, 43, 29, 23,
+ 28, 32, 28, 32, 31, 34,  5, 33,
+ 32, 33, 33, 42, 37, 23, 38, 31,
+ 40, 26, 32, 26, 37, 38, 36, 24,
+ 29, 30, 20, 22, 29, 24, 32, 41,
+  2, 34, 25, 33, 29, 31, 39, 35,
+ 36, 24, 32, 30, 33, 27, 44, 60,
+ 30, 36, 19, 34, 31, 24, 16, 35,
+ 32, 38, 21, 33, 31, 31, 21, 35,
+  5, 17, 29, 38, 38, 18, 58, 19,
+ 43, 41, 30, 41, 43, 39, 29,  7,
+ 29, 17, 28, 19, 28, 31, 25, 19,
+ 40, 26, 21, 33, 39, 23, 40, 30,
+ 39, 34, 35, 32, 32, 24, 33, 30,
+ 40, 47, 39, 37, 32, 33, 24, 23,
+ 45, 47, 27, 23, 42, 32, 32, 33,
+ 36, 37, 37, 17, 18, 22, 40, 38,
+ 32, 31, 35, 24, 17, 25, 17, 23,
+ 33, 34, 51, 42, 31, 36, 36, 29,
+ 21, 22, 37, 44, 43, 25, 47, 33,
+ 45, 27, 31, 58, 31, 32, 31, 38,
+ 43, 20, 47, 45, 54,  1, 26, 34,
+ 38, 14, 22, 24, 33, 34, 32, 32,
+ 37, 21, 23, 49, 35, 23, 28, 39,
+ 39, 23, 55, 33, 30, 30, 63, 16,
+ 42, 28, 13, 33, 33, 35, 19, 46,
+ 43, 17, 19, 36, 39, 24, 31, 32,
+ 33, 26, 28, 62, 33, 63, 33, 39,
+ 19, 49, 17, 31, 43, 13, 15, 29,
+ 25, 35, 33, 23, 49, 41, 28, 29,
+ 34, 38,  7, 61, 11, 50, 13, 41,
+ 19, 47, 25, 26, 15, 42, 41, 29,
+ 45, 27, 17, 35, 32, 29, 32, 24,
+ 13, 26, 26, 31, 24, 33, 28, 30,
+ 31, 11, 45, 46, 33, 33, 35, 57,
+ 32, 32, 35, 45, 34, 11, 37, 42,
+ 39, 37, 31, 49, 21, 27, 29, 47,
+ 53, 40, 51, 16, 26,  1, 40, 30,
+ 41, 44, 34, 25, 27, 31, 35, 35,
+ 31, 15, 49,  1, 35, 40,  5, 58,
+ 21, 29, 22, 59, 45, 31,  9, 26,
+  9, 29, 11, 32, 30,  3, 13, 20,
+ 18, 20, 11,  3, 29, 40, 31, 53,
+ 30, 17, 20, 37, 31, 42, 47, 47,
+ 54, 38,  9, 34, 13, 37, 21, 25,
+ 27, 43, 42, 45, 40, 25, 27, 46,
+ 22, 25, 53, 20,  2, 14, 39, 15,
+ 22, 44, 34, 21, 38, 33, 27, 48,
+ 34, 52, 35, 47, 49, 54,  2, 13,
+ 23, 52, 29, 45, 22, 49, 54, 21,
+ 40, 42, 31, 30, 29, 34,  0, 25,
+ 23, 51, 24, 59, 28, 38, 29, 31,
+  2, 13, 31,  8, 31, 33, 12, 45,
+ 41,  7, 14, 30, 25, 18, 43, 20,
+ 43, 35, 44,  1, 49, 42, 42, 18,
+ 41, 38, 41, 44, 53, 11, 20, 25,
+ 45, 46, 47, 48, 39, 52, 46, 49,
+ 63, 55, 44, 38, 13, 13, 57, 22,
+ 51, 16, 12, 28, 35, 57, 25, 20,
+ 26, 28, 28, 29, 32, 31, 62, 34,
+ 35, 35, 19, 49, 48, 39, 40, 18,
+ 43, 46, 11,  6, 48, 19, 49, 41,
+ 10, 23, 58, 17, 21, 23, 34, 30,
+ 60,  0, 44, 34, 26, 37, 46, 43,
+ 49, 59,  4, 34, 59, 37, 22, 25,
+ 28, 46,  6, 40, 59, 42, 36, 61,
+ 28, 30, 31, 43, 10, 22, 23, 47,
+ 20, 52, 55, 36, 25, 16,  1, 11,
+ 27, 29,  5, 63, 18, 41, 31, 34,
+ 38,  1,  5, 13, 28, 31, 17, 38,
+ 39, 41, 36, 37, 22, 39, 33, 43,
+ 43, 15, 17, 49, 30, 21, 22, 20,
+ 10, 17, 25, 54, 57,  3, 34,  8,
+ 36, 25, 31, 14, 15, 19, 29, 25,
+ 18, 39, 53, 22, 27, 20, 29, 33,
+ 41, 42, 35, 62, 50, 29, 53, 50,
+ 35, 55, 42, 61, 63,  4,  7, 42,
+ 21, 46, 47, 49, 27, 46, 17, 55,
+ 41, 50, 63,  4, 56, 18,  8, 10,
+ 18, 51, 63, 36, 55, 18,  5, 55,
+  9, 29, 17, 21, 30, 27,  1, 59,
+  7, 11, 12, 15,  5, 42, 24, 41,
+ 43,  7, 27, 22, 25, 31, 30, 37,
+ 22, 39, 53, 29, 36, 37, 48,  0,
+  5, 13, 17, 31, 32, 26, 46, 28,
+ 44, 45, 46, 53, 49, 51,  3, 41,
+  3, 22, 42, 33,  5, 45,  7, 22,
+ 40, 53, 24, 14, 25, 27, 10, 12,
+ 34, 16, 17, 53, 20, 26, 39, 45,
+ 18, 45, 35, 33, 31, 49,  4, 39,
+ 42, 11, 51,  5, 13, 26, 27, 17,
+ 52, 30,  0, 22, 12, 34, 62, 36,
+ 38, 41, 47, 30, 63, 38, 41, 43,
+ 59, 33, 45, 37, 38, 40, 47, 24,
+ 48, 49, 30,  1, 10, 22, 49, 15,
+ 39, 59, 31, 32, 33, 18, 13, 15,
+ 31, 21, 27, 44, 42, 39, 46, 17,
+ 26, 32, 30, 31,  0, 30, 34,  9,
+ 12, 13, 25, 31, 32, 55, 43, 35,
+ 61, 33, 35, 46, 25, 47, 48, 62,
+ 63, 38, 61,  1,  2,  5,  7,  9,
+ 46, 10, 34, 35, 36, 55, 51,  7,
+ 40, 23, 34, 37,  5, 13, 42, 18,
+ 25, 27, 28,
+};
+
+/* motion vector table 1 */
+static const uint16_t table1_mv_code[1100] = {
+ 0x0000, 0x0007, 0x0009, 0x000f, 0x000a, 0x0011, 0x001a, 0x001c,
+ 0x0011, 0x0031, 0x0025, 0x002d, 0x002f, 0x006f, 0x0075, 0x0041,
+ 0x004c, 0x004e, 0x005c, 0x0060, 0x0062, 0x0066, 0x0068, 0x0069,
+ 0x006b, 0x00a6, 0x00c1, 0x00cb, 0x00cc, 0x00ce, 0x00da, 0x00e8,
+ 0x00ee, 0x0087, 0x0090, 0x009e, 0x009f, 0x00ba, 0x00ca, 0x00d8,
+ 0x00db, 0x00df, 0x0104, 0x0109, 0x010c, 0x0143, 0x0145, 0x014a,
+ 0x0156, 0x015c, 0x01b3, 0x01d3, 0x01da, 0x0103, 0x0109, 0x010b,
+ 0x0122, 0x0127, 0x0134, 0x0161, 0x0164, 0x0176, 0x0184, 0x018d,
+ 0x018e, 0x018f, 0x0190, 0x0193, 0x0196, 0x019d, 0x019e, 0x019f,
+ 0x01a9, 0x01b2, 0x01b4, 0x01ba, 0x01bb, 0x01bc, 0x0201, 0x0202,
+ 0x0205, 0x0207, 0x020d, 0x0210, 0x0211, 0x0215, 0x021b, 0x021f,
+ 0x0281, 0x0285, 0x0290, 0x029c, 0x029d, 0x02a2, 0x02a7, 0x02a8,
+ 0x02aa, 0x02b0, 0x02b1, 0x02b4, 0x02bc, 0x02bf, 0x0320, 0x0326,
+ 0x0327, 0x0329, 0x032a, 0x0336, 0x0360, 0x0362, 0x0363, 0x0372,
+ 0x03b2, 0x03bc, 0x03bd, 0x0203, 0x0205, 0x021a, 0x0249, 0x024a,
+ 0x024c, 0x02c7, 0x02ca, 0x02ce, 0x02ef, 0x030d, 0x0322, 0x0325,
+ 0x0338, 0x0373, 0x037a, 0x0409, 0x0415, 0x0416, 0x0418, 0x0428,
+ 0x042d, 0x042f, 0x0434, 0x0508, 0x0509, 0x0510, 0x0511, 0x051c,
+ 0x051e, 0x0524, 0x0541, 0x0543, 0x0546, 0x0547, 0x054d, 0x0557,
+ 0x055f, 0x056a, 0x056c, 0x056d, 0x056f, 0x0576, 0x0577, 0x057a,
+ 0x057b, 0x057c, 0x057d, 0x0600, 0x0601, 0x0603, 0x0614, 0x0616,
+ 0x0617, 0x061c, 0x061f, 0x0642, 0x0648, 0x0649, 0x064a, 0x064b,
+ 0x0657, 0x0668, 0x0669, 0x066b, 0x066e, 0x067f, 0x06c2, 0x06c8,
+ 0x06cb, 0x06de, 0x06df, 0x06e2, 0x06e3, 0x06ef, 0x0748, 0x074b,
+ 0x076e, 0x076f, 0x077c, 0x0409, 0x0423, 0x0428, 0x0429, 0x042a,
+ 0x042b, 0x0432, 0x0433, 0x0496, 0x049a, 0x04d5, 0x04db, 0x0581,
+ 0x0582, 0x058b, 0x058c, 0x058d, 0x0598, 0x0599, 0x059a, 0x059e,
+ 0x05dd, 0x0619, 0x0632, 0x0633, 0x0648, 0x0672, 0x06a1, 0x06a2,
+ 0x06a3, 0x06af, 0x06e2, 0x06e3, 0x06e4, 0x0800, 0x0801, 0x0802,
+ 0x0803, 0x081a, 0x081b, 0x0829, 0x082f, 0x0832, 0x083e, 0x083f,
+ 0x0852, 0x0853, 0x0858, 0x086b, 0x0877, 0x0878, 0x0879, 0x087a,
+ 0x087b, 0x0a00, 0x0a01, 0x0a0d, 0x0a0e, 0x0a0f, 0x0a24, 0x0a37,
+ 0x0a3a, 0x0a3b, 0x0a3e, 0x0a46, 0x0a47, 0x0a4a, 0x0a4b, 0x0a5f,
+ 0x0a79, 0x0a7a, 0x0a7b, 0x0a80, 0x0a81, 0x0a84, 0x0a85, 0x0a99,
+ 0x0aa5, 0x0aa6, 0x0ab8, 0x0aba, 0x0abb, 0x0abc, 0x0abd, 0x0ac8,
+ 0x0ace, 0x0acf, 0x0ad7, 0x0adc, 0x0aeb, 0x0c04, 0x0c25, 0x0c26,
+ 0x0c27, 0x0c2a, 0x0c2b, 0x0c3a, 0x0c3b, 0x0c3c, 0x0c3d, 0x0ca0,
+ 0x0cad, 0x0cd4, 0x0cd5, 0x0cfc, 0x0cfd, 0x0d86, 0x0d92, 0x0d93,
+ 0x0d94, 0x0d95, 0x0db0, 0x0db8, 0x0db9, 0x0dba, 0x0dbb, 0x0dc0,
+ 0x0dc2, 0x0dc3, 0x0dda, 0x0ddb, 0x0ddc, 0x0ddd, 0x0e92, 0x0e93,
+ 0x0e94, 0x0e95, 0x0ec7, 0x0ecc, 0x0ece, 0x0ecf, 0x0ed8, 0x0ed9,
+ 0x0eda, 0x0edb, 0x0808, 0x0809, 0x080a, 0x0810, 0x0811, 0x0844,
+ 0x0845, 0x0861, 0x0862, 0x0863, 0x086c, 0x0922, 0x0923, 0x092e,
+ 0x092f, 0x0936, 0x0937, 0x09b1, 0x09b2, 0x09b3, 0x09b4, 0x09b5,
+ 0x09b8, 0x09b9, 0x09ba, 0x09bb, 0x09bc, 0x09bd, 0x09be, 0x09bf,
+ 0x0b00, 0x0b15, 0x0b2c, 0x0b2d, 0x0b2e, 0x0b2f, 0x0b36, 0x0bb9,
+ 0x0c28, 0x0c2a, 0x0c2b, 0x0c2c, 0x0c2d, 0x0c2e, 0x0c2f, 0x0c30,
+ 0x0c31, 0x0c38, 0x0c60, 0x0c61, 0x0c62, 0x0c63, 0x0c8d, 0x0c8e,
+ 0x0c8f, 0x0c92, 0x0cbe, 0x0cbf, 0x0ce6, 0x0ce7, 0x0d40, 0x0d41,
+ 0x0d57, 0x0d58, 0x0d59, 0x0d5a, 0x0d5b, 0x0d5c, 0x0d5d, 0x0d98,
+ 0x0d99, 0x0d9a, 0x0d9b, 0x0d9c, 0x0d9d, 0x0dad, 0x0dae, 0x0daf,
+ 0x0dc0, 0x0dc1, 0x0dc2, 0x0dc3, 0x0dca, 0x0dcb, 0x0dec, 0x0ded,
+ 0x0dee, 0x0def, 0x1018, 0x1022, 0x1023, 0x1030, 0x1031, 0x1032,
+ 0x1033, 0x1050, 0x1051, 0x105c, 0x1074, 0x1075, 0x1076, 0x1077,
+ 0x1078, 0x1079, 0x107a, 0x107b, 0x10b2, 0x10b3, 0x10b8, 0x10b9,
+ 0x10ba, 0x10bb, 0x10d4, 0x10ea, 0x10eb, 0x10ec, 0x10ed, 0x1404,
+ 0x1405, 0x1406, 0x1407, 0x1410, 0x1411, 0x1412, 0x1413, 0x1414,
+ 0x1415, 0x1416, 0x1417, 0x1418, 0x1419, 0x1466, 0x1467, 0x1468,
+ 0x1469, 0x146a, 0x146b, 0x146c, 0x146d, 0x147e, 0x147f, 0x1488,
+ 0x1489, 0x148a, 0x148b, 0x14b6, 0x14b7, 0x14b8, 0x14b9, 0x14ba,
+ 0x14bb, 0x14bc, 0x14bd, 0x14f0, 0x14f1, 0x14f8, 0x14f9, 0x14fa,
+ 0x14fb, 0x14fc, 0x14fd, 0x14fe, 0x14ff, 0x152a, 0x152b, 0x152c,
+ 0x152d, 0x152e, 0x152f, 0x1530, 0x1531, 0x1548, 0x1549, 0x154e,
+ 0x154f, 0x1558, 0x1559, 0x155a, 0x155b, 0x1572, 0x159a, 0x159b,
+ 0x15ac, 0x15ba, 0x15bb, 0x15d0, 0x15d1, 0x15d2, 0x15d3, 0x15d4,
+ 0x15d5, 0x181d, 0x181e, 0x181f, 0x1840, 0x1841, 0x1842, 0x1843,
+ 0x1844, 0x1845, 0x1846, 0x1847, 0x1848, 0x1849, 0x1861, 0x1862,
+ 0x1863, 0x1864, 0x1865, 0x1866, 0x1867, 0x1868, 0x1869, 0x186a,
+ 0x186b, 0x186c, 0x186d, 0x186e, 0x191b, 0x191c, 0x191d, 0x191e,
+ 0x191f, 0x1942, 0x1943, 0x1944, 0x1945, 0x1946, 0x1947, 0x1958,
+ 0x1959, 0x19ed, 0x19ee, 0x19ef, 0x19f0, 0x19f1, 0x19f2, 0x19f3,
+ 0x19f4, 0x19f5, 0x19f6, 0x19f7, 0x1b0e, 0x1b0f, 0x1b62, 0x1b63,
+ 0x1b64, 0x1b65, 0x1b66, 0x1b67, 0x1b68, 0x1b69, 0x1b6a, 0x1b6b,
+ 0x1b6c, 0x1b6d, 0x1b6e, 0x1b6f, 0x1b82, 0x1ba8, 0x1ba9, 0x1baa,
+ 0x1bab, 0x1bac, 0x1bad, 0x1bae, 0x1baf, 0x1bb0, 0x1bb1, 0x1bb2,
+ 0x1bb3, 0x1d80, 0x1d81, 0x1d82, 0x1d83, 0x1d84, 0x1d85, 0x1d86,
+ 0x1d87, 0x1d88, 0x1d89, 0x1d8a, 0x1d8b, 0x1d8c, 0x1d8d, 0x1007,
+ 0x1008, 0x1009, 0x100a, 0x100b, 0x100c, 0x100d, 0x100e, 0x100f,
+ 0x1016, 0x1080, 0x1081, 0x1082, 0x1083, 0x1084, 0x1085, 0x1086,
+ 0x1087, 0x10c0, 0x123a, 0x123b, 0x123c, 0x123d, 0x123e, 0x123f,
+ 0x1240, 0x1241, 0x1242, 0x1243, 0x1350, 0x1352, 0x1353, 0x1358,
+ 0x1359, 0x135a, 0x135b, 0x135c, 0x135d, 0x135e, 0x135f, 0x1360,
+ 0x1361, 0x1602, 0x1603, 0x160c, 0x160d, 0x160e, 0x160f, 0x1620,
+ 0x1621, 0x1622, 0x1623, 0x1624, 0x1625, 0x1626, 0x1627, 0x1628,
+ 0x1629, 0x166e, 0x166f, 0x167c, 0x167d, 0x167e, 0x167f, 0x1770,
+ 0x1771, 0x1852, 0x1853, 0x1872, 0x1873, 0x1874, 0x1875, 0x1876,
+ 0x1877, 0x1878, 0x1879, 0x187a, 0x187b, 0x187c, 0x187d, 0x187e,
+ 0x187f, 0x1918, 0x1919, 0x1926, 0x1927, 0x1970, 0x1971, 0x1972,
+ 0x1973, 0x1974, 0x1975, 0x1976, 0x1977, 0x1978, 0x1979, 0x197a,
+ 0x197b, 0x1aa0, 0x1aa1, 0x1aa2, 0x1aa3, 0x1aa4, 0x1aa5, 0x1aa6,
+ 0x1aa7, 0x1aa8, 0x1aa9, 0x1aaa, 0x1aab, 0x1aac, 0x1aad, 0x1b3c,
+ 0x1b3d, 0x1b3e, 0x1b3f, 0x1b50, 0x1b51, 0x1b52, 0x1b53, 0x1b54,
+ 0x1b55, 0x1b56, 0x1b57, 0x1b58, 0x1b59, 0x2032, 0x2033, 0x2034,
+ 0x2035, 0x2036, 0x2037, 0x2038, 0x2039, 0x203a, 0x203b, 0x203c,
+ 0x203d, 0x203e, 0x203f, 0x2040, 0x2041, 0x2042, 0x2043, 0x20ba,
+ 0x20bb, 0x20cc, 0x20cd, 0x20ce, 0x20cf, 0x20e0, 0x20e1, 0x20e2,
+ 0x20e3, 0x20e4, 0x20e5, 0x20e6, 0x20e7, 0x21aa, 0x21ab, 0x21c0,
+ 0x21c1, 0x21c2, 0x21c3, 0x21c4, 0x21c5, 0x21c6, 0x21c7, 0x21c8,
+ 0x21c9, 0x21ca, 0x21cb, 0x21cc, 0x21cd, 0x21ce, 0x21cf, 0x21d0,
+ 0x21d1, 0x21d2, 0x21d3, 0x2894, 0x2895, 0x2896, 0x2897, 0x2898,
+ 0x2899, 0x289a, 0x289b, 0x289c, 0x289d, 0x289e, 0x289f, 0x28c0,
+ 0x28c1, 0x28c2, 0x28c3, 0x28c4, 0x28c5, 0x28c6, 0x28c7, 0x28c8,
+ 0x28c9, 0x28ca, 0x28cb, 0x2930, 0x2931, 0x2932, 0x2933, 0x2934,
+ 0x2935, 0x2936, 0x2937, 0x2938, 0x2939, 0x293a, 0x293b, 0x293c,
+ 0x293d, 0x293e, 0x293f, 0x2960, 0x2961, 0x2962, 0x2963, 0x2964,
+ 0x2965, 0x2966, 0x2967, 0x2968, 0x2969, 0x296a, 0x296b, 0x2a40,
+ 0x2a41, 0x2a42, 0x2a43, 0x2a44, 0x2a45, 0x2a46, 0x2a47, 0x2a48,
+ 0x2a49, 0x2a4a, 0x2a4b, 0x2a4c, 0x2a4d, 0x2a4e, 0x2a4f, 0x2a50,
+ 0x2a51, 0x2a52, 0x2a53, 0x2ae6, 0x2ae7, 0x2b24, 0x2b25, 0x2b26,
+ 0x2b27, 0x2b28, 0x2b29, 0x2b2a, 0x2b2b, 0x2b2c, 0x2b2d, 0x2b2e,
+ 0x2b2f, 0x2b30, 0x2b31, 0x2b32, 0x2b33, 0x2b5a, 0x2b5b, 0x3014,
+ 0x3015, 0x3016, 0x3017, 0x3020, 0x3021, 0x3022, 0x3023, 0x3024,
+ 0x3025, 0x3026, 0x3027, 0x3028, 0x3029, 0x302a, 0x302b, 0x302c,
+ 0x302d, 0x302e, 0x302f, 0x3030, 0x3031, 0x3032, 0x3033, 0x3034,
+ 0x3035, 0x3036, 0x3037, 0x3038, 0x3039, 0x30c0, 0x30c1, 0x30de,
+ 0x30df, 0x3218, 0x3219, 0x321a, 0x321b, 0x321c, 0x321d, 0x321e,
+ 0x321f, 0x3220, 0x3221, 0x3222, 0x3223, 0x3224, 0x3225, 0x3226,
+ 0x3227, 0x3228, 0x3229, 0x322a, 0x322b, 0x322c, 0x322d, 0x322e,
+ 0x322f, 0x3230, 0x3231, 0x3232, 0x3233, 0x3234, 0x3235, 0x3378,
+ 0x3379, 0x337a, 0x337b, 0x337c, 0x337d, 0x337e, 0x337f, 0x33c0,
+ 0x33c1, 0x33c2, 0x33c3, 0x33c4, 0x33c5, 0x33c6, 0x33c7, 0x33c8,
+ 0x33c9, 0x33ca, 0x33cb, 0x33cc, 0x33cd, 0x33ce, 0x33cf, 0x33d0,
+ 0x33d1, 0x33d2, 0x33d3, 0x33d4, 0x33d5, 0x33d6, 0x33d7, 0x33d8,
+ 0x33d9, 0x3706, 0x3707, 0x3730, 0x3731, 0x3732, 0x3733, 0x3734,
+ 0x3735, 0x3736, 0x3737, 0x3738, 0x3739, 0x373a, 0x373b, 0x373c,
+ 0x373d, 0x373e, 0x373f, 0x3740, 0x3741, 0x3742, 0x3743, 0x3744,
+ 0x3745, 0x3746, 0x3747, 0x3748, 0x3749, 0x374a, 0x374b, 0x374c,
+ 0x374d, 0x374e, 0x374f, 0x3b34, 0x3b35, 0x3b36, 0x3b37, 0x3be8,
+ 0x3be9, 0x3bea, 0x3beb, 0x3bec, 0x3bed, 0x3bee, 0x3bef, 0x3bf0,
+ 0x3bf1, 0x3bf2, 0x3bf3, 0x3bf4, 0x3bf5, 0x3bf6, 0x3bf7, 0x3bf8,
+ 0x3bf9, 0x3bfa, 0x3bfb, 0x3bfc, 0x3bfd, 0x3bfe, 0x3bff, 0x2000,
+ 0x2001, 0x2002, 0x2003, 0x2004, 0x2005, 0x2006, 0x2007, 0x2008,
+ 0x2009, 0x200a, 0x200b, 0x200c, 0x200d, 0x202e, 0x202f, 0x2182,
+ 0x2183, 0x21b4, 0x21b5, 0x21b6, 0x21b7, 0x21b8, 0x21b9, 0x21ba,
+ 0x21bb, 0x21bc, 0x21bd, 0x21be, 0x21bf, 0x2460, 0x2461, 0x2462,
+ 0x2463, 0x2464, 0x2465, 0x2466, 0x2467, 0x2468, 0x2469, 0x246a,
+ 0x246b, 0x246c, 0x246d, 0x246e, 0x246f, 0x2470, 0x2471, 0x2472,
+ 0x2473, 0x26a2, 0x26a3, 0x000b,
+};
+
+static const uint8_t table1_mv_bits[1100] = {
+  2,  4,  4,  4,  5,  5,  5,  5,
+  6,  6,  7,  7,  7,  7,  7,  8,
+  8,  8,  8,  8,  8,  8,  8,  8,
+  8,  8,  8,  8,  8,  8,  8,  8,
+  8,  9,  9,  9,  9,  9,  9,  9,
+  9,  9,  9,  9,  9,  9,  9,  9,
+  9,  9,  9,  9,  9, 10, 10, 10,
+ 10, 10, 10, 10, 10, 10, 10, 10,
+ 10, 10, 10, 10, 10, 10, 10, 10,
+ 10, 10, 10, 10, 10, 10, 10, 10,
+ 10, 10, 10, 10, 10, 10, 10, 10,
+ 10, 10, 10, 10, 10, 10, 10, 10,
+ 10, 10, 10, 10, 10, 10, 10, 10,
+ 10, 10, 10, 10, 10, 10, 10, 10,
+ 10, 10, 10, 11, 11, 11, 11, 11,
+ 11, 11, 11, 11, 11, 11, 11, 11,
+ 11, 11, 11, 11, 11, 11, 11, 11,
+ 11, 11, 11, 11, 11, 11, 11, 11,
+ 11, 11, 11, 11, 11, 11, 11, 11,
+ 11, 11, 11, 11, 11, 11, 11, 11,
+ 11, 11, 11, 11, 11, 11, 11, 11,
+ 11, 11, 11, 11, 11, 11, 11, 11,
+ 11, 11, 11, 11, 11, 11, 11, 11,
+ 11, 11, 11, 11, 11, 11, 11, 11,
+ 11, 11, 11, 12, 12, 12, 12, 12,
+ 12, 12, 12, 12, 12, 12, 12, 12,
+ 12, 12, 12, 12, 12, 12, 12, 12,
+ 12, 12, 12, 12, 12, 12, 12, 12,
+ 12, 12, 12, 12, 12, 12, 12, 12,
+ 12, 12, 12, 12, 12, 12, 12, 12,
+ 12, 12, 12, 12, 12, 12, 12, 12,
+ 12, 12, 12, 12, 12, 12, 12, 12,
+ 12, 12, 12, 12, 12, 12, 12, 12,
+ 12, 12, 12, 12, 12, 12, 12, 12,
+ 12, 12, 12, 12, 12, 12, 12, 12,
+ 12, 12, 12, 12, 12, 12, 12, 12,
+ 12, 12, 12, 12, 12, 12, 12, 12,
+ 12, 12, 12, 12, 12, 12, 12, 12,
+ 12, 12, 12, 12, 12, 12, 12, 12,
+ 12, 12, 12, 12, 12, 12, 12, 12,
+ 12, 12, 12, 12, 12, 12, 12, 12,
+ 12, 12, 13, 13, 13, 13, 13, 13,
+ 13, 13, 13, 13, 13, 13, 13, 13,
+ 13, 13, 13, 13, 13, 13, 13, 13,
+ 13, 13, 13, 13, 13, 13, 13, 13,
+ 13, 13, 13, 13, 13, 13, 13, 13,
+ 13, 13, 13, 13, 13, 13, 13, 13,
+ 13, 13, 13, 13, 13, 13, 13, 13,
+ 13, 13, 13, 13, 13, 13, 13, 13,
+ 13, 13, 13, 13, 13, 13, 13, 13,
+ 13, 13, 13, 13, 13, 13, 13, 13,
+ 13, 13, 13, 13, 13, 13, 13, 13,
+ 13, 13, 13, 13, 13, 13, 13, 13,
+ 13, 13, 13, 13, 13, 13, 13, 13,
+ 13, 13, 13, 13, 13, 13, 13, 13,
+ 13, 13, 13, 13, 13, 13, 13, 13,
+ 13, 13, 13, 13, 13, 13, 13, 13,
+ 13, 13, 13, 13, 13, 13, 13, 13,
+ 13, 13, 13, 13, 13, 13, 13, 13,
+ 13, 13, 13, 13, 13, 13, 13, 13,
+ 13, 13, 13, 13, 13, 13, 13, 13,
+ 13, 13, 13, 13, 13, 13, 13, 13,
+ 13, 13, 13, 13, 13, 13, 13, 13,
+ 13, 13, 13, 13, 13, 13, 13, 13,
+ 13, 13, 13, 13, 13, 13, 13, 13,
+ 13, 13, 13, 13, 13, 13, 13, 13,
+ 13, 13, 13, 13, 13, 13, 13, 13,
+ 13, 13, 13, 13, 13, 13, 13, 13,
+ 13, 13, 13, 13, 13, 13, 13, 13,
+ 13, 13, 13, 13, 13, 13, 13, 13,
+ 13, 13, 13, 13, 13, 13, 13, 13,
+ 13, 13, 13, 13, 13, 13, 13, 13,
+ 13, 13, 13, 13, 13, 13, 13, 13,
+ 13, 13, 13, 13, 13, 13, 13, 13,
+ 13, 13, 13, 13, 13, 13, 13, 13,
+ 13, 13, 13, 13, 13, 13, 13, 13,
+ 13, 13, 13, 13, 13, 13, 13, 14,
+ 14, 14, 14, 14, 14, 14, 14, 14,
+ 14, 14, 14, 14, 14, 14, 14, 14,
+ 14, 14, 14, 14, 14, 14, 14, 14,
+ 14, 14, 14, 14, 14, 14, 14, 14,
+ 14, 14, 14, 14, 14, 14, 14, 14,
+ 14, 14, 14, 14, 14, 14, 14, 14,
+ 14, 14, 14, 14, 14, 14, 14, 14,
+ 14, 14, 14, 14, 14, 14, 14, 14,
+ 14, 14, 14, 14, 14, 14, 14, 14,
+ 14, 14, 14, 14, 14, 14, 14, 14,
+ 14, 14, 14, 14, 14, 14, 14, 14,
+ 14, 14, 14, 14, 14, 14, 14, 14,
+ 14, 14, 14, 14, 14, 14, 14, 14,
+ 14, 14, 14, 14, 14, 14, 14, 14,
+ 14, 14, 14, 14, 14, 14, 14, 14,
+ 14, 14, 14, 14, 14, 14, 14, 14,
+ 14, 14, 14, 14, 14, 14, 14, 14,
+ 14, 14, 14, 14, 14, 14, 14, 14,
+ 14, 14, 14, 14, 14, 14, 14, 14,
+ 14, 14, 14, 14, 14, 14, 14, 14,
+ 14, 14, 14, 14, 14, 14, 14, 14,
+ 14, 14, 14, 14, 14, 14, 14, 14,
+ 14, 14, 14, 14, 14, 14, 14, 14,
+ 14, 14, 14, 14, 14, 14, 14, 14,
+ 14, 14, 14, 14, 14, 14, 14, 14,
+ 14, 14, 14, 14, 14, 14, 14, 14,
+ 14, 14, 14, 14, 14, 14, 14, 14,
+ 14, 14, 14, 14, 14, 14, 14, 14,
+ 14, 14, 14, 14, 14, 14, 14, 14,
+ 14, 14, 14, 14, 14, 14, 14, 14,
+ 14, 14, 14, 14, 14, 14, 14, 14,
+ 14, 14, 14, 14, 14, 14, 14, 14,
+ 14, 14, 14, 14, 14, 14, 14, 14,
+ 14, 14, 14, 14, 14, 14, 14, 14,
+ 14, 14, 14, 14, 14, 14, 14, 14,
+ 14, 14, 14, 14, 14, 14, 14, 14,
+ 14, 14, 14, 14, 14, 14, 14, 14,
+ 14, 14, 14, 14, 14, 14, 14, 14,
+ 14, 14, 14, 14, 14, 14, 14, 14,
+ 14, 14, 14, 14, 14, 14, 14, 14,
+ 14, 14, 14, 14, 14, 14, 14, 14,
+ 14, 14, 14, 14, 14, 14, 14, 14,
+ 14, 14, 14, 14, 14, 14, 14, 14,
+ 14, 14, 14, 14, 14, 14, 14, 14,
+ 14, 14, 14, 14, 14, 14, 14, 14,
+ 14, 14, 14, 14, 14, 14, 14, 14,
+ 14, 14, 14, 14, 14, 14, 14, 14,
+ 14, 14, 14, 14, 14, 14, 14, 14,
+ 14, 14, 14, 14, 14, 14, 14, 14,
+ 14, 14, 14, 14, 14, 14, 14, 14,
+ 14, 14, 14, 14, 14, 14, 14, 14,
+ 14, 14, 14, 14, 14, 14, 14, 14,
+ 14, 14, 14, 14, 14, 14, 14, 14,
+ 14, 14, 14, 14, 14, 14, 14, 15,
+ 15, 15, 15, 15, 15, 15, 15, 15,
+ 15, 15, 15, 15, 15, 15, 15, 15,
+ 15, 15, 15, 15, 15, 15, 15, 15,
+ 15, 15, 15, 15, 15, 15, 15, 15,
+ 15, 15, 15, 15, 15, 15, 15, 15,
+ 15, 15, 15, 15, 15, 15, 15, 15,
+ 15, 15, 15,  4,
+};
+
+static const uint8_t table1_mvx[1099] = {
+ 32, 31, 32, 31, 33, 32, 33, 33,
+ 31, 34, 30, 32, 32, 34, 35, 32,
+ 34, 33, 29, 30, 30, 32, 31, 31,
+ 33, 35, 35, 33, 31, 29, 29, 33,
+ 34, 30, 31, 28, 36, 30, 34, 32,
+ 32, 37, 32, 32, 25, 27, 39, 32,
+ 32, 32, 38, 35, 36, 32, 37, 61,
+ 26, 32, 34, 35,  3, 35, 27, 28,
+ 29, 34, 28, 37, 31, 36, 32, 27,
+ 31, 30, 29, 39, 33, 29, 33, 35,
+ 25, 25, 29, 33, 31, 31, 31, 33,
+ 32, 30, 32, 32, 41, 39, 33, 36,
+ 32, 28, 34, 36, 38, 24, 60, 31,
+ 23, 28, 32, 33, 59, 32, 40, 30,
+  5, 34, 32, 38, 32, 30, 43,  4,
+ 32, 32, 42, 31, 31, 32, 26, 38,
+ 26, 22, 21, 37, 61, 63, 37, 31,
+ 32, 33,  2,  1, 23, 33, 41, 27,
+ 35, 30, 38, 23, 33,  3, 28, 34,
+ 34, 27, 41, 29, 39, 35, 36, 29,
+ 32, 27, 30, 32, 24, 61, 37, 26,
+ 59, 25, 35, 27, 36, 37, 30, 31,
+ 34, 40,  3, 28, 34, 39, 32, 31,
+ 32, 30, 24, 28, 35, 36, 26, 32,
+ 31, 33, 29, 33, 39, 25, 30, 24,
+ 35, 59, 29, 34, 25, 30, 21, 35,
+ 43, 40, 32, 29,  5, 28, 31, 62,
+ 33, 33, 25, 31, 21, 31, 43, 31,
+ 34, 33, 20, 40, 39, 31, 31, 57,
+ 38, 32, 42, 33, 32, 31, 32, 29,
+ 30, 44,  5, 31, 22, 34, 36, 17,
+ 38, 58, 38, 35, 32, 60, 35, 24,
+ 32, 38, 16, 45, 42, 32, 31, 29,
+  4, 30, 17, 40, 46, 48, 63, 32,
+ 42, 19, 41, 22, 28, 36, 45, 33,
+ 33, 32, 29,  7, 41, 42, 18, 33,
+ 33, 32, 22, 37,  1, 26, 22, 23,
+ 49, 28, 26, 27, 32, 33, 27, 23,
+ 28, 36, 15,  6, 34, 27, 31, 26,
+ 23,  2, 33, 32, 34, 41, 28, 32,
+ 41,  0, 36, 38, 34, 31, 47, 32,
+ 17, 31, 39, 33, 37, 51, 30, 47,
+ 32, 50, 32, 19, 63, 30, 25, 27,
+ 33, 62, 24, 31, 27, 30, 37, 31,
+ 45, 32, 39, 20, 46, 47, 35, 19,
+ 34,  1, 49, 21, 21, 14, 51, 26,
+ 23, 31, 36, 35, 58, 29, 29, 21,
+ 20, 42, 13, 28, 12, 40, 31, 33,
+ 39, 60, 32, 44, 33, 31, 28, 37,
+ 29, 32, 30, 49, 43, 28, 39, 25,
+ 32, 48,  2, 15, 20, 25, 31, 28,
+ 21, 24, 25, 15, 31, 17, 37, 43,
+ 18, 32, 33, 24, 33, 36, 13, 33,
+ 31, 39, 11, 31, 33, 32, 39, 37,
+ 32, 32, 29, 17, 44, 46, 36, 35,
+ 26, 37, 58, 32, 34, 38,  8, 38,
+ 38, 22, 29, 25, 16, 35, 32, 35,
+ 33, 43, 18, 46, 38, 50, 33, 18,
+ 53, 60, 13, 32, 36, 33, 51, 36,
+ 43, 45, 27, 42, 29, 24, 30, 25,
+ 31, 52, 31, 35, 38,  9, 22, 34,
+  4, 17, 28, 55, 42, 25, 17, 20,
+ 47, 34, 33, 16, 40, 25, 16, 30,
+ 53, 29, 10, 11, 14, 26, 33,  4,
+ 35, 44, 26, 16, 31, 26, 34, 38,
+ 29, 31, 30, 24, 22, 61, 32,  9,
+ 45, 34, 31, 19,  9, 31, 46, 31,
+ 35, 54, 29, 57, 30, 50,  3, 31,
+ 63, 34, 47, 41, 51, 18, 31, 14,
+ 37, 38, 31, 24, 32, 31, 50, 33,
+ 31, 54, 27,  9, 33, 23, 19, 32,
+ 29, 29, 33, 28, 47, 49, 30, 47,
+ 33, 27, 25, 54, 44, 45, 50, 58,
+ 51, 48, 33, 59, 33, 34, 57, 13,
+ 26, 33, 13, 48, 30, 11,  7, 56,
+ 34, 55, 26,  0, 26, 35,  1, 51,
+ 33, 53, 31, 45, 12, 29, 29, 51,
+ 31, 48,  2,  6, 34, 30, 28, 33,
+ 60, 40, 27, 46, 31,  9, 35, 29,
+ 31, 39, 55, 46, 19, 37, 62, 34,
+ 30, 16, 19, 49, 41, 41, 39, 37,
+ 14,  5, 13, 35, 55, 30, 40, 40,
+ 42,  8, 20, 25, 45, 35, 33, 36,
+ 54, 38, 27, 37, 62, 40, 15, 59,
+ 49, 31, 29, 34, 34, 39, 24, 29,
+ 25, 29, 21, 29, 10, 61, 33, 49,
+ 35, 34,  3, 38, 39, 29,  7, 41,
+  1, 35,  4, 23, 15, 23, 11, 37,
+ 28, 35, 30, 30, 24,  1, 43, 56,
+  8, 34, 42, 24, 45, 30, 20, 23,
+  8, 38, 22, 33, 17, 52, 34, 22,
+ 53, 43, 44,  1, 27, 31, 41, 43,
+ 41, 30, 31, 36, 30,  5, 55, 31,
+ 33, 30, 40, 23, 15, 29, 34, 34,
+ 59, 34, 30, 11, 13, 38,  5,  0,
+ 30, 42,  5, 30, 29, 34, 10, 44,
+ 30, 63, 35, 12,  3, 26, 15, 17,
+ 25, 34, 43, 39, 34, 56, 29, 23,
+ 30, 12, 30, 10, 35,  9, 24, 58,
+ 10, 12, 54, 33, 37, 20, 41, 35,
+ 29, 18, 61, 30, 40, 24, 39, 53,
+ 62, 26, 29, 33, 34, 53, 49, 21,
+ 27, 11, 63, 20, 26, 23,  7, 13,
+  6, 47, 29, 30,  9, 51, 22, 34,
+ 21, 25, 33, 56, 57, 30, 38, 51,
+ 51, 38, 63, 28, 40, 35, 33, 18,
+ 33, 33, 24, 58, 58, 34, 49, 29,
+ 43,  4,  1,  4, 42, 35, 35, 30,
+ 17,  5, 56, 61, 25, 37, 36, 55,
+ 28, 35, 29, 50, 48, 52,  2, 42,
+ 34, 40, 46, 46, 43, 35, 29, 48,
+ 20, 29, 31, 41,  7, 30, 35, 19,
+ 14, 21,  8, 39, 39, 40, 46, 55,
+ 34,  6, 30, 34, 37, 25, 37, 33,
+ 22, 44, 52, 17, 35, 29, 36, 35,
+ 40, 37, 28, 30, 50, 14, 28, 55,
+  6, 23, 19, 14, 30,  3, 30, 28,
+ 28, 61, 61, 47, 45, 48, 40, 40,
+ 34, 34, 25, 30, 29, 35,  4, 26,
+ 53, 50, 26, 41, 27, 59, 27, 38,
+ 39,  3, 50, 43, 47, 23, 33, 55,
+ 35, 21, 23, 35, 61, 33, 46, 52,
+ 35, 34, 24, 30, 43, 16, 37, 21,
+  2, 24, 45, 34, 30, 55, 55,  1,
+ 29, 29, 26, 28, 25, 31, 36, 22,
+ 17, 30, 52,  2, 44, 44, 57, 26,
+ 62, 41, 39, 57, 26, 46, 49, 11,
+ 16, 19,  5, 59, 38, 39, 58, 38,
+ 25, 49, 50, 22, 28, 59,  9, 59,
+  7, 28, 55, 17,  4, 35, 50, 21,
+ 29, 44, 47, 18, 24, 19, 25, 42,
+ 35,  3, 51, 35, 16, 35, 30, 63,
+ 57, 39, 39, 25, 35, 38,  9, 16,
+ 36, 45, 31, 60, 14, 34, 42, 24,
+  0, 37, 18, 61, 57, 37, 28, 53,
+ 20, 46, 14, 47, 38, 38, 38,  9,
+ 34, 39, 43, 17, 39, 59,  5, 27,
+  0, 12, 27,
+};
+
+static const uint8_t table1_mvy[1099] = {
+ 32, 32, 31, 31, 32, 33, 31, 33,
+ 33, 32, 32, 30, 34, 31, 32, 29,
+ 33, 30, 32, 33, 31, 35, 34, 30,
+ 34, 31, 33, 29, 29, 31, 33, 35,
+ 30, 30, 35, 32, 32, 34, 34, 28,
+ 25, 32, 36, 27, 32, 32, 32, 37,
+ 39,  3, 32, 30, 31, 26, 31, 32,
+ 32, 38, 29, 29, 32, 34, 31, 31,
+ 34, 35, 33, 33, 28, 33,  1, 33,
+ 27, 29, 30, 31, 28, 29, 37, 35,
+ 31, 33, 35, 27, 36, 37, 25, 25,
+ 61, 35,  4,  5, 32, 33, 36, 30,
+ 23, 30, 28, 34, 31, 32, 32, 39,
+ 32, 34, 21, 39, 32, 59, 32, 28,
+ 32, 36, 60, 33, 24, 36, 32, 32,
+ 41,  2, 32, 38, 26, 22, 33, 30,
+ 31, 32, 32, 30, 31, 32, 29,  3,
+ 40, 38, 32, 32, 33, 26, 31, 34,
+ 28, 38, 34, 31,  3, 31, 35, 38,
+ 27, 35, 33, 28, 29, 27, 29, 27,
+ 43, 29, 37, 63, 31, 33, 34, 30,
+ 31, 30, 37, 30, 35, 35, 26, 41,
+ 37, 31, 33, 28, 26, 30, 42, 24,
+  7, 27, 33, 29, 36, 28, 34, 57,
+ 23, 41, 36, 23, 35, 34, 25, 30,
+ 25, 33, 25, 25, 29, 24, 33, 39,
+ 33, 33,  0, 37, 31, 36, 21, 32,
+ 61, 24, 35, 61, 31,  5, 31, 59,
+ 39, 21, 32, 30, 34, 22, 40, 32,
+ 29, 16, 31,  5, 62,  2, 20, 39,
+ 39, 32, 33,  1, 31, 24, 36, 32,
+ 36, 32, 28, 26,  6, 31, 38, 34,
+ 58, 35, 32, 33, 33, 17, 43, 26,
+ 31, 40, 31, 34, 32, 32, 31, 19,
+ 30, 32, 29, 33, 38, 38, 32, 59,
+ 40, 18, 38, 32, 35, 34, 32, 17,
+  1, 15, 30, 28, 31, 28, 34, 29,
+ 32, 27, 35, 27, 49, 22, 37, 34,
+ 37, 26, 32, 32, 22, 28, 45, 29,
+ 30, 31, 43, 46, 41, 30, 26, 13,
+ 34, 32, 27, 38, 42, 42, 33, 47,
+ 33, 60, 27, 42, 25, 32, 22, 32,
+ 48, 32, 45, 33, 33, 41, 27, 25,
+ 19, 31, 35, 19, 36, 42, 27, 17,
+ 31, 44, 28, 33, 33, 31, 23, 31,
+ 40, 33, 31, 34, 30, 32, 33, 36,
+ 35, 47, 37, 41, 31, 23, 41, 29,
+ 30, 35, 32, 25, 32, 28, 58,  2,
+ 37, 33, 14, 33, 49, 20, 39, 36,
+ 21,  9, 23, 33, 35, 24, 39, 37,
+ 11, 33, 30, 31, 31, 28, 51, 40,
+ 35, 29, 25, 33, 46, 35, 37, 30,
+ 30,  8, 63, 28, 15, 40, 33, 45,
+ 49, 25, 32,  4, 47, 51, 36, 39,
+ 53, 10, 24, 29, 30, 31, 25, 40,
+ 38, 38, 33, 56, 23, 27, 32, 37,
+ 26, 29, 43, 36, 33, 24, 55, 43,
+  9, 29, 34, 34, 24, 33, 18, 33,
+ 33, 30, 31, 50, 24, 60, 30, 39,
+ 34, 30, 39, 28, 22, 38,  2, 26,
+ 63, 32, 57, 21, 39, 33, 28, 18,
+ 30, 34, 22, 33, 29, 41, 30, 34,
+ 35, 21, 13, 34, 35, 39, 30, 46,
+ 32, 42, 32, 31, 33, 26, 11, 33,
+ 22, 31, 25, 31, 53, 27, 43, 25,
+ 40, 50, 21, 36, 38, 30, 12, 31,
+ 34, 20, 15, 29, 32, 62, 30, 13,
+ 17, 32, 19, 31, 20, 31, 30,  7,
+  1, 17, 34, 37, 31, 31, 44, 34,
+ 26, 40, 16, 37, 52, 48, 30, 20,
+ 18, 33, 38, 29,  7, 25, 30, 54,
+ 45, 47, 46, 41, 29, 29, 16, 30,
+ 14, 26, 38, 34, 34, 29, 34, 30,
+ 29, 30, 57, 30,  4, 46, 33, 29,
+ 39, 44, 30, 31, 50, 33, 31, 32,
+ 19, 32, 40, 31, 37, 47,  1, 35,
+ 16, 31,  0, 35, 33,  1, 17, 34,
+  9, 34, 33, 31, 49, 43, 42, 51,
+ 34, 29, 23, 29, 14, 30, 45, 49,
+ 11, 24, 31, 28, 35, 41, 30, 44,
+ 18, 29, 34, 35, 36, 25, 26, 21,
+ 31, 30, 34, 19, 34, 44, 36, 38,
+ 25, 31, 28, 23, 37,  3, 55, 41,
+ 30, 22, 41, 24, 33, 26, 35, 35,
+ 30, 55, 51, 47, 48, 38, 24, 15,
+ 21, 50, 25, 46, 30, 29, 10, 34,
+ 42, 45, 29, 42, 22,  3, 33, 27,
+ 34,  1, 34, 28, 34, 36, 35, 23,
+ 23, 13, 58,  3, 26, 63, 25, 31,
+ 34, 61, 38, 39, 25, 61, 29, 37,
+ 30, 41, 26, 48, 28, 33, 50, 35,
+ 30, 37, 29, 29, 40,  6, 39, 28,
+ 28, 19,  8, 22, 45, 34, 35, 10,
+ 58, 17, 37, 39, 30, 18, 54, 14,
+ 29, 16, 59, 30, 35, 23, 35, 30,
+ 47, 36, 29, 55, 20, 12, 31, 35,
+ 14, 29, 18, 34, 34, 24, 29, 26,
+ 22,  2, 27, 23,  8, 30, 55, 38,
+ 60, 31,  4, 34, 49, 34, 27, 34,
+ 33, 30, 31, 54, 42, 35, 38, 46,
+ 44, 26, 27,  9, 39, 25, 21, 29,
+ 28, 42, 13,  0,  5, 34, 37, 28,
+ 24, 29, 63, 26, 22, 27, 29, 25,
+ 33, 25, 61,  0, 35, 25, 36, 15,
+ 27, 40, 53, 33,  3, 10, 16, 37,
+ 38, 18, 30, 46, 27,  9,  6, 29,
+ 62,  8, 42, 28, 29,  3, 25, 16,
+ 26, 29, 35, 28, 27, 51, 61, 48,
+ 37,  9, 34,  7, 49, 45, 20, 29,
+ 21,  5,  5, 29, 28, 34, 29, 24,
+ 10, 24, 35, 36, 38, 55, 11, 36,
+ 38, 53, 54, 26, 30, 49, 20, 27,
+ 30, 39, 33, 41, 49, 22, 38, 38,
+  4, 30,  8,  9,  3, 24, 22, 50,
+ 37, 36, 31, 27,  2,  9, 42, 63,
+ 25, 19, 44,  1, 28, 28, 48, 30,
+ 34, 41, 41, 38, 12, 27, 15,  0,
+ 16, 34, 35, 38, 28, 29, 40, 42,
+ 51, 52, 45, 54, 59, 59, 42, 44,
+ 37, 26, 46, 24, 15, 39, 22, 46,
+ 19, 35, 38, 17, 37, 23, 52, 55,
+ 50, 37, 26, 11, 37, 12, 24, 30,
+ 16, 13, 22, 13, 36, 35, 40, 41,
+ 34, 41, 26, 53, 51,  5, 21, 30,
+  2, 63, 41, 20,  1, 56, 21, 24,
+ 25,  5, 28, 35, 26, 28, 30, 18,
+ 29, 23, 40, 34, 20, 42, 39, 34,
+ 28, 61, 38, 27, 62,  9, 36, 17,
+  9, 49, 24, 25, 54, 34, 39, 37,
+  3,  1, 25, 38, 38, 44, 35, 36,
+ 12, 60, 36, 38, 40, 25, 43, 39,
+ 53, 28, 39, 57, 46, 10, 52, 27,
+ 35, 42, 45, 59, 15, 60, 38, 24,
+ 23, 39, 12, 29, 24,  0, 20, 16,
+ 28, 43, 35, 28,  1, 49,  4, 21,
+ 42, 39, 29,  3, 44, 21, 53, 55,
+ 11,  5,  3, 39, 53, 28, 25, 19,
+ 34, 28, 21,
+};
+
+/* motion vector table */
+typedef struct MVTable {
+    int n;
+    const uint16_t *table_mv_code;
+    const uint8_t *table_mv_bits;
+    const uint8_t *table_mvx;
+    const uint8_t *table_mvy;
+    uint16_t *table_mv_index; /* encoding: convert mv to index in table_mv */
+    VLC vlc;                /* decoding: vlc */
+} MVTable;
+
+static MVTable mv_tables[2] = {
+    {
+        1099,
+        table0_mv_code,
+        table0_mv_bits,
+        table0_mvx,
+        table0_mvy,
+    },
+    {
+        1099,
+        table1_mv_code,
+        table1_mv_bits,
+        table1_mvx,
+        table1_mvy,
+    }
+};
+
+static const uint8_t v2_mb_type[8][2] = {
+ {1, 1}, {0   , 2}, {3   , 3}, {9   , 5},
+ {5, 4}, {0x21, 7}, {0x20, 7}, {0x11, 6},
+};
+
+static const uint8_t v2_intra_cbpc[4][2] = {
+ {1, 1}, {0, 3}, {1, 3}, {1, 2},
+};
+
+static const uint8_t wmv1_y_dc_scale_table[32]={
+//  0, 1, 2, 3, 4, 5, 6, 7, 8, 9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31
+    0, 8, 8, 8, 8, 8, 9, 9,10,10,11,11,12,12,13,13,14,14,15,15,16,16,17,17,18,18,19,19,20,20,21,21
+};
+static const uint8_t wmv1_c_dc_scale_table[32]={
+//  0, 1, 2, 3, 4, 5, 6, 7, 8, 9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31
+    0, 8, 8, 8, 8, 9, 9,10,10,11,11,12,12,13,13,14,14,15,15,16,16,17,17,18,18,19,19,20,20,21,21,22
+};
+
+static const uint8_t old_ff_y_dc_scale_table[32]={
+//  0  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31
+    0, 8, 8, 8, 8,10,12,14,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39
+};
+static const uint8_t old_ff_c_dc_scale_table[32]={
+//  0  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31
+    0, 8, 8, 8, 8, 9, 9,10,10,11,11,12,12,13,13,14,14,15,15,16,16,17,17,18,18,19,19,20,20,21,21,22
+};
+
+
+#define WMV1_SCANTABLE_COUNT 4
+
+static const uint8_t wmv1_scantable00[64]= {
+0x00, 0x08, 0x01, 0x02, 0x09, 0x10, 0x18, 0x11,
+0x0A, 0x03, 0x04, 0x0B, 0x12, 0x19, 0x20, 0x28,
+0x30, 0x38, 0x29, 0x21, 0x1A, 0x13, 0x0C, 0x05,
+0x06, 0x0D, 0x14, 0x1B, 0x22, 0x31, 0x39, 0x3A,
+0x32, 0x2A, 0x23, 0x1C, 0x15, 0x0E, 0x07, 0x0F,
+0x16, 0x1D, 0x24, 0x2B, 0x33, 0x3B, 0x3C, 0x34,
+0x2C, 0x25, 0x1E, 0x17, 0x1F, 0x26, 0x2D, 0x35,
+0x3D, 0x3E, 0x36, 0x2E, 0x27, 0x2F, 0x37, 0x3F,
+};
+static const uint8_t wmv1_scantable01[64]= {
+0x00, 0x08, 0x01, 0x02, 0x09, 0x10, 0x18, 0x11,
+0x0A, 0x03, 0x04, 0x0B, 0x12, 0x19, 0x20, 0x28,
+0x21, 0x30, 0x1A, 0x13, 0x0C, 0x05, 0x06, 0x0D,
+0x14, 0x1B, 0x22, 0x29, 0x38, 0x31, 0x39, 0x2A,
+0x23, 0x1C, 0x15, 0x0E, 0x07, 0x0F, 0x16, 0x1D,
+0x24, 0x2B, 0x32, 0x3A, 0x33, 0x3B, 0x2C, 0x25,
+0x1E, 0x17, 0x1F, 0x26, 0x2D, 0x34, 0x3C, 0x35,
+0x3D, 0x2E, 0x27, 0x2F, 0x36, 0x3E, 0x37, 0x3F,
+};
+static const uint8_t wmv1_scantable02[64]= {
+0x00, 0x01, 0x08, 0x02, 0x03, 0x09, 0x10, 0x18,
+0x11, 0x0A, 0x04, 0x05, 0x0B, 0x12, 0x19, 0x20,
+0x28, 0x30, 0x21, 0x1A, 0x13, 0x0C, 0x06, 0x07,
+0x0D, 0x14, 0x1B, 0x22, 0x29, 0x38, 0x31, 0x39,
+0x2A, 0x23, 0x1C, 0x15, 0x0E, 0x0F, 0x16, 0x1D,
+0x24, 0x2B, 0x32, 0x3A, 0x33, 0x2C, 0x25, 0x1E,
+0x17, 0x1F, 0x26, 0x2D, 0x34, 0x3B, 0x3C, 0x35,
+0x2E, 0x27, 0x2F, 0x36, 0x3D, 0x3E, 0x37, 0x3F,
+};
+static const uint8_t wmv1_scantable03[64]= {
+0x00, 0x08, 0x10, 0x01, 0x18, 0x20, 0x28, 0x09,
+0x02, 0x03, 0x0A, 0x11, 0x19, 0x30, 0x38, 0x29,
+0x21, 0x1A, 0x12, 0x0B, 0x04, 0x05, 0x0C, 0x13,
+0x1B, 0x22, 0x31, 0x39, 0x32, 0x2A, 0x23, 0x1C,
+0x14, 0x0D, 0x06, 0x07, 0x0E, 0x15, 0x1D, 0x24,
+0x2B, 0x33, 0x3A, 0x3B, 0x34, 0x2C, 0x25, 0x1E,
+0x16, 0x0F, 0x17, 0x1F, 0x26, 0x2D, 0x3C, 0x35,
+0x2E, 0x27, 0x2F, 0x36, 0x3D, 0x3E, 0x37, 0x3F,
+};
+
+static const uint8_t *wmv1_scantable[WMV1_SCANTABLE_COUNT+1]={
+    wmv1_scantable00,
+    wmv1_scantable01,
+    wmv1_scantable02,
+    wmv1_scantable03,
+};
+
+static const uint8_t table_inter_intra[4][2]={
+    {0,1} /*Luma-Left Chroma-Left*/,
+    {2,2} /*Luma-Top  Chroma-Left*/,
+    {6,3} /*luma-Left Chroma-Top */,
+    {7,3} /*luma-Top  Chroma-Top */
+};
+
+#define WMV2_INTER_CBP_TABLE_COUNT 4
+
+static const uint32_t table_mb_non_intra2[128][2] = {
+{0x0000A7, 14}, {0x01B2B8, 18}, {0x01B28E, 18}, {0x036575, 19},
+{0x006CAC, 16}, {0x000A69, 18}, {0x002934, 20}, {0x00526B, 21},
+{0x006CA1, 16}, {0x01B2B9, 18}, {0x0029AD, 20}, {0x029353, 24},
+{0x006CA7, 16}, {0x006CAB, 16}, {0x01B2BB, 18}, {0x00029B, 16},
+{0x00D944, 17}, {0x000A6A, 18}, {0x0149A8, 23}, {0x03651F, 19},
+{0x006CAF, 16}, {0x000A4C, 18}, {0x03651E, 19}, {0x000A48, 18},
+{0x00299C, 20}, {0x00299F, 20}, {0x029352, 24}, {0x0029AC, 20},
+{0x000296, 16}, {0x00D946, 17}, {0x000A68, 18}, {0x000298, 16},
+{0x000527, 17}, {0x00D94D, 17}, {0x0014D7, 19}, {0x036574, 19},
+{0x000A5C, 18}, {0x01B299, 18}, {0x00299D, 20}, {0x00299E, 20},
+{0x000525, 17}, {0x000A66, 18}, {0x00A4D5, 22}, {0x00149B, 19},
+{0x000295, 16}, {0x006CAD, 16}, {0x000A49, 18}, {0x000521, 17},
+{0x006CAA, 16}, {0x00D945, 17}, {0x01B298, 18}, {0x00052F, 17},
+{0x003654, 15}, {0x006CA0, 16}, {0x000532, 17}, {0x000291, 16},
+{0x003652, 15}, {0x000520, 17}, {0x000A5D, 18}, {0x000294, 16},
+{0x00009B, 11}, {0x0006E2, 12}, {0x000028, 12}, {0x0001B0, 10},
+{0x000001,  3}, {0x000010,  8}, {0x00002F,  6}, {0x00004C, 10},
+{0x00000D,  4}, {0x000000, 10}, {0x000006,  9}, {0x000134, 12},
+{0x00000C,  4}, {0x000007, 10}, {0x000007,  9}, {0x0006E1, 12},
+{0x00000E,  5}, {0x0000DA,  9}, {0x000022,  9}, {0x000364, 11},
+{0x00000F,  4}, {0x000006, 10}, {0x00000F,  9}, {0x000135, 12},
+{0x000014,  5}, {0x0000DD,  9}, {0x000004,  9}, {0x000015, 11},
+{0x00001A,  6}, {0x0001B3, 10}, {0x000005, 10}, {0x0006E3, 12},
+{0x00000C,  5}, {0x0000B9,  8}, {0x000004,  8}, {0x0000DB,  9},
+{0x00000E,  4}, {0x00000B, 10}, {0x000023,  9}, {0x0006CB, 12},
+{0x000005,  6}, {0x0001B1, 10}, {0x000001, 10}, {0x0006E0, 12},
+{0x000011,  5}, {0x0000DF,  9}, {0x00000E,  9}, {0x000373, 11},
+{0x000003,  5}, {0x0000B8,  8}, {0x000006,  8}, {0x000175,  9},
+{0x000015,  5}, {0x000174,  9}, {0x000027,  9}, {0x000372, 11},
+{0x000010,  5}, {0x0000BB,  8}, {0x000005,  8}, {0x0000DE,  9},
+{0x00000F,  5}, {0x000001,  9}, {0x000012,  8}, {0x000004, 10},
+{0x000002,  3}, {0x000016,  5}, {0x000009,  4}, {0x000001,  5},
+};
+
+static const uint32_t table_mb_non_intra3[128][2] = {
+{0x0002A1, 10}, {0x005740, 15}, {0x01A0BF, 18}, {0x015D19, 17},
+{0x001514, 13}, {0x00461E, 15}, {0x015176, 17}, {0x015177, 17},
+{0x0011AD, 13}, {0x00682E, 16}, {0x0682F9, 20}, {0x03417D, 19},
+{0x001A36, 14}, {0x002A2D, 14}, {0x00D05E, 17}, {0x006824, 16},
+{0x001515, 13}, {0x00545C, 15}, {0x0230E9, 18}, {0x011AFA, 17},
+{0x0015D7, 13}, {0x005747, 15}, {0x008D79, 16}, {0x006825, 16},
+{0x002BA2, 14}, {0x00A8BA, 16}, {0x0235F6, 18}, {0x015D18, 17},
+{0x0011AE, 13}, {0x00346F, 15}, {0x008C3B, 16}, {0x00346E, 15},
+{0x000D1A, 13}, {0x00461F, 15}, {0x0682F8, 20}, {0x011875, 17},
+{0x002BA1, 14}, {0x008D61, 16}, {0x0235F7, 18}, {0x0230E8, 18},
+{0x001513, 13}, {0x008D7B, 16}, {0x011AF4, 17}, {0x011AF5, 17},
+{0x001185, 13}, {0x0046BF, 15}, {0x008D60, 16}, {0x008D7C, 16},
+{0x001512, 13}, {0x00461C, 15}, {0x00AE8D, 16}, {0x008D78, 16},
+{0x000D0E, 13}, {0x003413, 15}, {0x0046B1, 15}, {0x003416, 15},
+{0x000AEA, 12}, {0x002A2C, 14}, {0x005741, 15}, {0x002A2F, 14},
+{0x000158,  9}, {0x0008D2, 12}, {0x00054C, 11}, {0x000686, 12},
+{0x000000,  2}, {0x000069,  8}, {0x00006B,  8}, {0x00068C, 12},
+{0x000007,  3}, {0x00015E,  9}, {0x0002A3, 10}, {0x000AE9, 12},
+{0x000006,  3}, {0x000231, 10}, {0x0002B8, 10}, {0x001A08, 14},
+{0x000010,  5}, {0x0001A9, 10}, {0x000342, 11}, {0x000A88, 12},
+{0x000004,  4}, {0x0001A2, 10}, {0x0002A4, 10}, {0x001184, 13},
+{0x000012,  5}, {0x000232, 10}, {0x0002B2, 10}, {0x000680, 12},
+{0x00001B,  6}, {0x00046A, 11}, {0x00068E, 12}, {0x002359, 14},
+{0x000016,  5}, {0x00015F,  9}, {0x0002A0, 10}, {0x00054D, 11},
+{0x000005,  4}, {0x000233, 10}, {0x0002B9, 10}, {0x0015D6, 13},
+{0x000022,  6}, {0x000468, 11}, {0x000683, 12}, {0x001A0A, 14},
+{0x000013,  5}, {0x000236, 10}, {0x0002BB, 10}, {0x001186, 13},
+{0x000017,  5}, {0x0001AB, 10}, {0x0002A7, 10}, {0x0008D3, 12},
+{0x000014,  5}, {0x000237, 10}, {0x000460, 11}, {0x000D0F, 13},
+{0x000019,  6}, {0x0001AA, 10}, {0x0002B3, 10}, {0x000681, 12},
+{0x000018,  6}, {0x0001A8, 10}, {0x0002A5, 10}, {0x00068F, 12},
+{0x000007,  4}, {0x000055,  7}, {0x000047,  7}, {0x0000AD,  8},
+};
+
+static const uint32_t table_mb_non_intra4[128][2] = {
+{0x0000D4,  8}, {0x0021C5, 14}, {0x00F18A, 16}, {0x00D5BC, 16},
+{0x000879, 12}, {0x00354D, 14}, {0x010E3F, 17}, {0x010F54, 17},
+{0x000866, 12}, {0x00356E, 14}, {0x010F55, 17}, {0x010E3E, 17},
+{0x0010CE, 13}, {0x003C84, 14}, {0x00D5BD, 16}, {0x00F18B, 16},
+{0x000868, 12}, {0x00438C, 15}, {0x0087AB, 16}, {0x00790B, 15},
+{0x000F10, 12}, {0x00433D, 15}, {0x006AD3, 15}, {0x00790A, 15},
+{0x001AA7, 13}, {0x0043D4, 15}, {0x00871E, 16}, {0x006ADF, 15},
+{0x000D7C, 12}, {0x003C94, 14}, {0x00438D, 15}, {0x006AD2, 15},
+{0x0006BC, 11}, {0x0021E9, 14}, {0x006ADA, 15}, {0x006A99, 15},
+{0x0010F7, 13}, {0x004389, 15}, {0x006ADB, 15}, {0x0078C4, 15},
+{0x000D56, 12}, {0x0035F7, 14}, {0x00438E, 15}, {0x006A98, 15},
+{0x000D52, 12}, {0x003C95, 14}, {0x004388, 15}, {0x00433C, 15},
+{0x000D54, 12}, {0x001E4B, 13}, {0x003C63, 14}, {0x003C83, 14},
+{0x000861, 12}, {0x0021EB, 14}, {0x00356C, 14}, {0x0035F6, 14},
+{0x000863, 12}, {0x00219F, 14}, {0x003568, 14}, {0x003C82, 14},
+{0x0001AE,  9}, {0x0010C0, 13}, {0x000F11, 12}, {0x001AFA, 13},
+{0x000000,  1}, {0x0000F0,  8}, {0x0001AD,  9}, {0x0010C1, 13},
+{0x00000A,  4}, {0x0003C5, 10}, {0x000789, 11}, {0x001AB5, 13},
+{0x000009,  4}, {0x000435, 11}, {0x000793, 11}, {0x001E40, 13},
+{0x00001D,  5}, {0x0003CB, 10}, {0x000878, 12}, {0x001AAF, 13},
+{0x00000B,  4}, {0x0003C7, 10}, {0x000791, 11}, {0x001AAB, 13},
+{0x00001F,  5}, {0x000436, 11}, {0x0006BF, 11}, {0x000F19, 12},
+{0x00003D,  6}, {0x000D51, 12}, {0x0010C4, 13}, {0x0021E8, 14},
+{0x000036,  6}, {0x000437, 11}, {0x0006AF, 11}, {0x0010C5, 13},
+{0x00000C,  4}, {0x000432, 11}, {0x000794, 11}, {0x001E30, 13},
+{0x000042,  7}, {0x000870, 12}, {0x000F24, 12}, {0x001E43, 13},
+{0x000020,  6}, {0x00043E, 11}, {0x000795, 11}, {0x001AAA, 13},
+{0x000037,  6}, {0x0006AC, 11}, {0x0006AE, 11}, {0x0010F6, 13},
+{0x000034,  6}, {0x00043A, 11}, {0x000D50, 12}, {0x001AAE, 13},
+{0x000039,  6}, {0x00043F, 11}, {0x00078D, 11}, {0x0010D2, 13},
+{0x000038,  6}, {0x00043B, 11}, {0x0006BD, 11}, {0x0010D3, 13},
+{0x000011,  5}, {0x0001AC,  9}, {0x0000F3,  8}, {0x000439, 11},
+};
+
+static const uint32_t (*wmv2_inter_table[WMV2_INTER_CBP_TABLE_COUNT])[2]={
+    table_mb_non_intra2,
+    table_mb_non_intra3,
+    table_mb_non_intra4,
+    table_mb_non_intra,
+};
+
+static const uint8_t wmv2_scantableA[64]={
+0x00, 0x01, 0x02, 0x08, 0x03, 0x09, 0x0A, 0x10,
+0x04, 0x0B, 0x11, 0x18, 0x12, 0x0C, 0x05, 0x13,
+0x19, 0x0D, 0x14, 0x1A, 0x1B, 0x06, 0x15, 0x1C,
+0x0E, 0x16, 0x1D, 0x07, 0x1E, 0x0F, 0x17, 0x1F,
+};
+
+static const uint8_t wmv2_scantableB[64]={
+0x00, 0x08, 0x01, 0x10, 0x09, 0x18, 0x11, 0x02,
+0x20, 0x0A, 0x19, 0x28, 0x12, 0x30, 0x21, 0x1A,
+0x38, 0x29, 0x22, 0x03, 0x31, 0x39, 0x0B, 0x2A,
+0x13, 0x32, 0x1B, 0x3A, 0x23, 0x2B, 0x33, 0x3B,
+};
+
+#endif // AVCODEC_MSMPEG4TAB_H

Added: branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec/raw.h
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec/raw.h	2007-07-16 18:13:25 UTC (rev 3391)
+++ branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec/raw.h	2007-07-16 18:14:46 UTC (rev 3392)
@@ -0,0 +1,39 @@
+/*
+ * Raw Video Codec
+ * Copyright (c) 2001 Fabrice Bellard.
+ *
+ * This file is part of FFmpeg.
+ *
+ * FFmpeg is free software; you can redistribute it and/or
+ * modify it under the terms of the GNU Lesser General Public
+ * License as published by the Free Software Foundation; either
+ * version 2.1 of the License, or (at your option) any later version.
+ *
+ * FFmpeg is distributed in the hope that it will be useful,
+ * but WITHOUT ANY WARRANTY; without even the implied warranty of
+ * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ * Lesser General Public License for more details.
+ *
+ * You should have received a copy of the GNU Lesser General Public
+ * License along with FFmpeg; if not, write to the Free Software
+ * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA
+ */
+
+/**
+ * @file raw.h
+ * Raw Video Codec
+ */
+
+#ifndef AVCODEC_RAW_H
+#define AVCODEC_RAW_H
+
+#include "avcodec.h"
+
+typedef struct PixelFormatTag {
+    int pix_fmt;
+    unsigned int fourcc;
+} PixelFormatTag;
+
+extern const PixelFormatTag ff_raw_pixelFormatTags[];
+
+#endif /* AVCODEC_RAW_H */



From mean at mail.berlios.de  Mon Jul 16 20:17:13 2007
From: mean at mail.berlios.de (mean at BerliOS)
Date: Mon, 16 Jul 2007 20:17:13 +0200
Subject: [Avidemux-svn-commit] r3393 - in
	branches/avidemux_2.4_branch/avidemux/ADM_libraries:
	ADM_lavcodec ADM_lavcodec/i386 ADM_lavformat
Message-ID: <200707161817.l6GIHD0I010838@sheep.berlios.de>

Author: mean
Date: 2007-07-16 20:17:13 +0200 (Mon, 16 Jul 2007)
New Revision: 3393

Added:
   branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec/i386/cavsdsp_mmx.c
   branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec/i386/dsputil_mmx_qns.h
   branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec/i386/vp3dsp_mmx.h
   branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec/i386/vp3dsp_sse2.h
   branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec/jpeglsdec.h
   branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavformat/matroska.h
   branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavformat/mpeg.h
Log:
lost files

Added: branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec/i386/cavsdsp_mmx.c
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec/i386/cavsdsp_mmx.c	2007-07-16 18:14:46 UTC (rev 3392)
+++ branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec/i386/cavsdsp_mmx.c	2007-07-16 18:17:13 UTC (rev 3393)
@@ -0,0 +1,518 @@
+/*
+ * Chinese AVS video (AVS1-P2, JiZhun profile) decoder.
+ * Copyright (c) 2006  Stefan Gehrer <stefan.gehrer at gmx.de>
+ *
+ * MMX optimised DSP functions, based on H.264 optimisations by
+ * Michael Niedermayer and Loren Merritt
+ *
+ * This file is part of FFmpeg.
+ *
+ * FFmpeg is free software; you can redistribute it and/or
+ * modify it under the terms of the GNU Lesser General Public
+ * License as published by the Free Software Foundation; either
+ * version 2.1 of the License, or (at your option) any later version.
+ *
+ * FFmpeg is distributed in the hope that it will be useful,
+ * but WITHOUT ANY WARRANTY; without even the implied warranty of
+ * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ * Lesser General Public License for more details.
+ *
+ * You should have received a copy of the GNU Lesser General Public
+ * License along with FFmpeg; if not, write to the Free Software
+ * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA
+ */
+
+#include "dsputil.h"
+#include "common.h"
+
+DECLARE_ALIGNED_8(static const uint64_t,ff_pw_4 ) = 0x0004000400040004ULL;
+DECLARE_ALIGNED_8(static const uint64_t,ff_pw_5 ) = 0x0005000500050005ULL;
+DECLARE_ALIGNED_8(static const uint64_t,ff_pw_7 ) = 0x0007000700070007ULL;
+DECLARE_ALIGNED_8(static const uint64_t,ff_pw_42) = 0x002A002A002A002AULL;
+DECLARE_ALIGNED_8(static const uint64_t,ff_pw_64) = 0x0040004000400040ULL;
+DECLARE_ALIGNED_8(static const uint64_t,ff_pw_96) = 0x0060006000600060ULL;
+
+/*****************************************************************************
+ *
+ * inverse transform
+ *
+ ****************************************************************************/
+
+#define SUMSUB_BA( a, b ) \
+    "paddw "#b", "#a" \n\t"\
+    "paddw "#b", "#b" \n\t"\
+    "psubw "#a", "#b" \n\t"
+
+#define SBUTTERFLY(a,b,t,n)\
+    "movq " #a ", " #t "              \n\t" /* abcd */\
+    "punpckl" #n " " #b ", " #a "     \n\t" /* aebf */\
+    "punpckh" #n " " #b ", " #t "     \n\t" /* cgdh */
+
+#define TRANSPOSE4(a,b,c,d,t)\
+    SBUTTERFLY(a,b,t,wd) /* a=aebf t=cgdh */\
+    SBUTTERFLY(c,d,b,wd) /* c=imjn b=kolp */\
+    SBUTTERFLY(a,c,d,dq) /* a=aeim d=bfjn */\
+    SBUTTERFLY(t,b,c,dq) /* t=cgko c=dhlp */
+
+static inline void cavs_idct8_1d(int16_t *block, uint64_t bias)
+{
+    asm volatile(
+        "movq 112(%0), %%mm4  \n\t" /* mm4 = src7 */
+        "movq  16(%0), %%mm5  \n\t" /* mm5 = src1 */
+        "movq  80(%0), %%mm2  \n\t" /* mm2 = src5 */
+        "movq  48(%0), %%mm7  \n\t" /* mm7 = src3 */
+        "movq   %%mm4, %%mm0  \n\t"
+        "movq   %%mm5, %%mm3  \n\t"
+        "movq   %%mm2, %%mm6  \n\t"
+        "movq   %%mm7, %%mm1  \n\t"
+
+        "paddw  %%mm4, %%mm4  \n\t" /* mm4 = 2*src7 */
+        "paddw  %%mm3, %%mm3  \n\t" /* mm3 = 2*src1 */
+        "paddw  %%mm6, %%mm6  \n\t" /* mm6 = 2*src5 */
+        "paddw  %%mm1, %%mm1  \n\t" /* mm1 = 2*src3 */
+        "paddw  %%mm4, %%mm0  \n\t" /* mm0 = 3*src7 */
+        "paddw  %%mm3, %%mm5  \n\t" /* mm5 = 3*src1 */
+        "paddw  %%mm6, %%mm2  \n\t" /* mm2 = 3*src5 */
+        "paddw  %%mm1, %%mm7  \n\t" /* mm7 = 3*src3 */
+        "psubw  %%mm4, %%mm5  \n\t" /* mm5 = 3*src1 - 2*src7 = a0 */
+        "paddw  %%mm6, %%mm7  \n\t" /* mm7 = 3*src3 + 2*src5 = a1 */
+        "psubw  %%mm2, %%mm1  \n\t" /* mm1 = 2*src3 - 3*src5 = a2 */
+        "paddw  %%mm0, %%mm3  \n\t" /* mm3 = 2*src1 + 3*src7 = a3 */
+
+        "movq   %%mm5, %%mm4  \n\t"
+        "movq   %%mm7, %%mm6  \n\t"
+        "movq   %%mm3, %%mm0  \n\t"
+        "movq   %%mm1, %%mm2  \n\t"
+        SUMSUB_BA( %%mm7, %%mm5 )   /* mm7 = a0 + a1  mm5 = a0 - a1 */
+        "paddw  %%mm3, %%mm7  \n\t" /* mm7 = a0 + a1 + a3 */
+        "paddw  %%mm1, %%mm5  \n\t" /* mm5 = a0 - a1 + a2 */
+        "paddw  %%mm7, %%mm7  \n\t"
+        "paddw  %%mm5, %%mm5  \n\t"
+        "paddw  %%mm6, %%mm7  \n\t" /* mm7 = b4 */
+        "paddw  %%mm4, %%mm5  \n\t" /* mm5 = b5 */
+
+        SUMSUB_BA( %%mm1, %%mm3 )   /* mm1 = a3 + a2  mm3 = a3 - a2 */
+        "psubw  %%mm1, %%mm4  \n\t" /* mm4 = a0 - a2 - a3 */
+        "movq   %%mm4, %%mm1  \n\t" /* mm1 = a0 - a2 - a3 */
+        "psubw  %%mm6, %%mm3  \n\t" /* mm3 = a3 - a2 - a1 */
+        "paddw  %%mm1, %%mm1  \n\t"
+        "paddw  %%mm3, %%mm3  \n\t"
+        "psubw  %%mm2, %%mm1  \n\t" /* mm1 = b7 */
+        "paddw  %%mm0, %%mm3  \n\t" /* mm3 = b6 */
+
+        "movq  32(%0), %%mm2  \n\t" /* mm2 = src2 */
+        "movq  96(%0), %%mm6  \n\t" /* mm6 = src6 */
+        "movq   %%mm2, %%mm4  \n\t"
+        "movq   %%mm6, %%mm0  \n\t"
+        "psllw  $2,    %%mm4  \n\t" /* mm4 = 4*src2 */
+        "psllw  $2,    %%mm6  \n\t" /* mm6 = 4*src6 */
+        "paddw  %%mm4, %%mm2  \n\t" /* mm2 = 5*src2 */
+        "paddw  %%mm6, %%mm0  \n\t" /* mm0 = 5*src6 */
+        "paddw  %%mm2, %%mm2  \n\t"
+        "paddw  %%mm0, %%mm0  \n\t"
+        "psubw  %%mm0, %%mm4  \n\t" /* mm4 = 4*src2 - 10*src6 = a7 */
+        "paddw  %%mm2, %%mm6  \n\t" /* mm6 = 4*src6 + 10*src2 = a6 */
+
+        "movq    (%0), %%mm2  \n\t" /* mm2 = src0 */
+        "movq  64(%0), %%mm0  \n\t" /* mm0 = src4 */
+        SUMSUB_BA( %%mm0, %%mm2 )   /* mm0 = src0+src4  mm2 = src0-src4 */
+        "psllw  $3,    %%mm0  \n\t"
+        "psllw  $3,    %%mm2  \n\t"
+        "paddw  %1,    %%mm0  \n\t" /* add rounding bias */
+        "paddw  %1,    %%mm2  \n\t" /* add rounding bias */
+
+        SUMSUB_BA( %%mm6, %%mm0 )   /* mm6 = a4 + a6  mm0 = a4 - a6 */
+        SUMSUB_BA( %%mm4, %%mm2 )   /* mm4 = a5 + a7  mm2 = a5 - a7 */
+        SUMSUB_BA( %%mm7, %%mm6 )   /* mm7 = dst0  mm6 = dst7 */
+        SUMSUB_BA( %%mm5, %%mm4 )   /* mm5 = dst1  mm4 = dst6 */
+        SUMSUB_BA( %%mm3, %%mm2 )   /* mm3 = dst2  mm2 = dst5 */
+        SUMSUB_BA( %%mm1, %%mm0 )   /* mm1 = dst3  mm0 = dst4 */
+        :: "r"(block), "m"(bias)
+    );
+}
+
+static void cavs_idct8_add_mmx(uint8_t *dst, int16_t *block, int stride)
+{
+    int i;
+    DECLARE_ALIGNED_8(int16_t, b2[64]);
+
+    for(i=0; i<2; i++){
+        DECLARE_ALIGNED_8(uint64_t, tmp);
+
+        cavs_idct8_1d(block+4*i, ff_pw_4);
+
+        asm volatile(
+            "psraw     $3, %%mm7  \n\t"
+            "psraw     $3, %%mm6  \n\t"
+            "psraw     $3, %%mm5  \n\t"
+            "psraw     $3, %%mm4  \n\t"
+            "psraw     $3, %%mm3  \n\t"
+            "psraw     $3, %%mm2  \n\t"
+            "psraw     $3, %%mm1  \n\t"
+            "psraw     $3, %%mm0  \n\t"
+            "movq   %%mm7,    %0   \n\t"
+            TRANSPOSE4( %%mm0, %%mm2, %%mm4, %%mm6, %%mm7 )
+            "movq   %%mm0,  8(%1)  \n\t"
+            "movq   %%mm6, 24(%1)  \n\t"
+            "movq   %%mm7, 40(%1)  \n\t"
+            "movq   %%mm4, 56(%1)  \n\t"
+            "movq    %0,    %%mm7  \n\t"
+            TRANSPOSE4( %%mm7, %%mm5, %%mm3, %%mm1, %%mm0 )
+            "movq   %%mm7,   (%1)  \n\t"
+            "movq   %%mm1, 16(%1)  \n\t"
+            "movq   %%mm0, 32(%1)  \n\t"
+            "movq   %%mm3, 48(%1)  \n\t"
+            : "=m"(tmp)
+            : "r"(b2+32*i)
+            : "memory"
+        );
+    }
+
+    for(i=0; i<2; i++){
+        cavs_idct8_1d(b2+4*i, ff_pw_64);
+
+        asm volatile(
+            "psraw     $7, %%mm7  \n\t"
+            "psraw     $7, %%mm6  \n\t"
+            "psraw     $7, %%mm5  \n\t"
+            "psraw     $7, %%mm4  \n\t"
+            "psraw     $7, %%mm3  \n\t"
+            "psraw     $7, %%mm2  \n\t"
+            "psraw     $7, %%mm1  \n\t"
+            "psraw     $7, %%mm0  \n\t"
+            "movq   %%mm7,    (%0)  \n\t"
+            "movq   %%mm5,  16(%0)  \n\t"
+            "movq   %%mm3,  32(%0)  \n\t"
+            "movq   %%mm1,  48(%0)  \n\t"
+            "movq   %%mm0,  64(%0)  \n\t"
+            "movq   %%mm2,  80(%0)  \n\t"
+            "movq   %%mm4,  96(%0)  \n\t"
+            "movq   %%mm6, 112(%0)  \n\t"
+            :: "r"(b2+4*i)
+            : "memory"
+        );
+    }
+
+    add_pixels_clamped_mmx(b2, dst, stride);
+
+    /* clear block */
+    asm volatile(
+            "pxor %%mm7, %%mm7   \n\t"
+            "movq %%mm7, (%0)    \n\t"
+            "movq %%mm7, 8(%0)   \n\t"
+            "movq %%mm7, 16(%0)  \n\t"
+            "movq %%mm7, 24(%0)  \n\t"
+            "movq %%mm7, 32(%0)  \n\t"
+            "movq %%mm7, 40(%0)  \n\t"
+            "movq %%mm7, 48(%0)  \n\t"
+            "movq %%mm7, 56(%0)  \n\t"
+            "movq %%mm7, 64(%0)  \n\t"
+            "movq %%mm7, 72(%0)  \n\t"
+            "movq %%mm7, 80(%0)  \n\t"
+            "movq %%mm7, 88(%0)  \n\t"
+            "movq %%mm7, 96(%0)  \n\t"
+            "movq %%mm7, 104(%0) \n\t"
+            "movq %%mm7, 112(%0) \n\t"
+            "movq %%mm7, 120(%0) \n\t"
+            :: "r" (block)
+    );
+}
+
+/*****************************************************************************
+ *
+ * motion compensation
+ *
+ ****************************************************************************/
+
+/* vertical filter [-1 -2 96 42 -7  0]  */
+#define QPEL_CAVSV1(A,B,C,D,E,F,OP)      \
+        "movd (%0), "#F"            \n\t"\
+        "movq "#C", %%mm6           \n\t"\
+        "pmullw %5, %%mm6           \n\t"\
+        "movq "#D", %%mm7           \n\t"\
+        "pmullw %6, %%mm7           \n\t"\
+        "psllw $3, "#E"             \n\t"\
+        "psubw "#E", %%mm6          \n\t"\
+        "psraw $3, "#E"             \n\t"\
+        "paddw %%mm7, %%mm6         \n\t"\
+        "paddw "#E", %%mm6          \n\t"\
+        "paddw "#B", "#B"           \n\t"\
+        "pxor %%mm7, %%mm7          \n\t"\
+        "add %2, %0                 \n\t"\
+        "punpcklbw %%mm7, "#F"      \n\t"\
+        "psubw "#B", %%mm6          \n\t"\
+        "psraw $1, "#B"             \n\t"\
+        "psubw "#A", %%mm6          \n\t"\
+        "paddw %4, %%mm6            \n\t"\
+        "psraw $7, %%mm6            \n\t"\
+        "packuswb %%mm6, %%mm6      \n\t"\
+        OP(%%mm6, (%1), A, d)            \
+        "add %3, %1                 \n\t"
+
+/* vertical filter [ 0 -1  5  5 -1  0]  */
+#define QPEL_CAVSV2(A,B,C,D,E,F,OP)      \
+        "movd (%0), "#F"            \n\t"\
+        "movq "#C", %%mm6           \n\t"\
+        "paddw "#D", %%mm6          \n\t"\
+        "pmullw %5, %%mm6           \n\t"\
+        "add %2, %0                 \n\t"\
+        "punpcklbw %%mm7, "#F"      \n\t"\
+        "psubw "#B", %%mm6          \n\t"\
+        "psubw "#E", %%mm6          \n\t"\
+        "paddw %4, %%mm6            \n\t"\
+        "psraw $3, %%mm6            \n\t"\
+        "packuswb %%mm6, %%mm6      \n\t"\
+        OP(%%mm6, (%1), A, d)            \
+        "add %3, %1                 \n\t"
+
+/* vertical filter [ 0 -7 42 96 -2 -1]  */
+#define QPEL_CAVSV3(A,B,C,D,E,F,OP)      \
+        "movd (%0), "#F"            \n\t"\
+        "movq "#C", %%mm6           \n\t"\
+        "pmullw %6, %%mm6           \n\t"\
+        "movq "#D", %%mm7           \n\t"\
+        "pmullw %5, %%mm7           \n\t"\
+        "psllw $3, "#B"             \n\t"\
+        "psubw "#B", %%mm6          \n\t"\
+        "psraw $3, "#B"             \n\t"\
+        "paddw %%mm7, %%mm6         \n\t"\
+        "paddw "#B", %%mm6          \n\t"\
+        "paddw "#E", "#E"           \n\t"\
+        "pxor %%mm7, %%mm7          \n\t"\
+        "add %2, %0                 \n\t"\
+        "punpcklbw %%mm7, "#F"      \n\t"\
+        "psubw "#E", %%mm6          \n\t"\
+        "psraw $1, "#E"             \n\t"\
+        "psubw "#F", %%mm6          \n\t"\
+        "paddw %4, %%mm6            \n\t"\
+        "psraw $7, %%mm6            \n\t"\
+        "packuswb %%mm6, %%mm6      \n\t"\
+        OP(%%mm6, (%1), A, d)            \
+        "add %3, %1                 \n\t"
+
+
+#define QPEL_CAVSVNUM(VOP,OP,ADD,MUL1,MUL2)\
+    int w= 2;\
+    src -= 2*srcStride;\
+    \
+    while(w--){\
+      asm volatile(\
+        "pxor %%mm7, %%mm7          \n\t"\
+        "movd (%0), %%mm0           \n\t"\
+        "add %2, %0                 \n\t"\
+        "movd (%0), %%mm1           \n\t"\
+        "add %2, %0                 \n\t"\
+        "movd (%0), %%mm2           \n\t"\
+        "add %2, %0                 \n\t"\
+        "movd (%0), %%mm3           \n\t"\
+        "add %2, %0                 \n\t"\
+        "movd (%0), %%mm4           \n\t"\
+        "add %2, %0                 \n\t"\
+        "punpcklbw %%mm7, %%mm0     \n\t"\
+        "punpcklbw %%mm7, %%mm1     \n\t"\
+        "punpcklbw %%mm7, %%mm2     \n\t"\
+        "punpcklbw %%mm7, %%mm3     \n\t"\
+        "punpcklbw %%mm7, %%mm4     \n\t"\
+        VOP(%%mm0, %%mm1, %%mm2, %%mm3, %%mm4, %%mm5, OP)\
+        VOP(%%mm1, %%mm2, %%mm3, %%mm4, %%mm5, %%mm0, OP)\
+        VOP(%%mm2, %%mm3, %%mm4, %%mm5, %%mm0, %%mm1, OP)\
+        VOP(%%mm3, %%mm4, %%mm5, %%mm0, %%mm1, %%mm2, OP)\
+        VOP(%%mm4, %%mm5, %%mm0, %%mm1, %%mm2, %%mm3, OP)\
+        VOP(%%mm5, %%mm0, %%mm1, %%mm2, %%mm3, %%mm4, OP)\
+        VOP(%%mm0, %%mm1, %%mm2, %%mm3, %%mm4, %%mm5, OP)\
+        VOP(%%mm1, %%mm2, %%mm3, %%mm4, %%mm5, %%mm0, OP)\
+        \
+        : "+a"(src), "+c"(dst)\
+        : "S"((long)srcStride), "D"((long)dstStride), "m"(ADD), "m"(MUL1), "m"(MUL2)\
+        : "memory"\
+     );\
+     if(h==16){\
+        asm volatile(\
+            VOP(%%mm2, %%mm3, %%mm4, %%mm5, %%mm0, %%mm1, OP)\
+            VOP(%%mm3, %%mm4, %%mm5, %%mm0, %%mm1, %%mm2, OP)\
+            VOP(%%mm4, %%mm5, %%mm0, %%mm1, %%mm2, %%mm3, OP)\
+            VOP(%%mm5, %%mm0, %%mm1, %%mm2, %%mm3, %%mm4, OP)\
+            VOP(%%mm0, %%mm1, %%mm2, %%mm3, %%mm4, %%mm5, OP)\
+            VOP(%%mm1, %%mm2, %%mm3, %%mm4, %%mm5, %%mm0, OP)\
+            VOP(%%mm2, %%mm3, %%mm4, %%mm5, %%mm0, %%mm1, OP)\
+            VOP(%%mm3, %%mm4, %%mm5, %%mm0, %%mm1, %%mm2, OP)\
+            \
+           : "+a"(src), "+c"(dst)\
+           : "S"((long)srcStride), "D"((long)dstStride), "m"(ADD),  "m"(MUL1), "m"(MUL2)\
+           : "memory"\
+        );\
+     }\
+     src += 4-(h+5)*srcStride;\
+     dst += 4-h*dstStride;\
+   }
+
+#define QPEL_CAVS(OPNAME, OP, MMX)\
+static void OPNAME ## cavs_qpel8_h_ ## MMX(uint8_t *dst, uint8_t *src, int dstStride, int srcStride){\
+    int h=8;\
+    asm volatile(\
+        "pxor %%mm7, %%mm7          \n\t"\
+        "movq %5, %%mm6             \n\t"\
+        "1:                         \n\t"\
+        "movq    (%0), %%mm0        \n\t"\
+        "movq   1(%0), %%mm2        \n\t"\
+        "movq %%mm0, %%mm1          \n\t"\
+        "movq %%mm2, %%mm3          \n\t"\
+        "punpcklbw %%mm7, %%mm0     \n\t"\
+        "punpckhbw %%mm7, %%mm1     \n\t"\
+        "punpcklbw %%mm7, %%mm2     \n\t"\
+        "punpckhbw %%mm7, %%mm3     \n\t"\
+        "paddw %%mm2, %%mm0         \n\t"\
+        "paddw %%mm3, %%mm1         \n\t"\
+        "pmullw %%mm6, %%mm0        \n\t"\
+        "pmullw %%mm6, %%mm1        \n\t"\
+        "movq   -1(%0), %%mm2       \n\t"\
+        "movq    2(%0), %%mm4       \n\t"\
+        "movq %%mm2, %%mm3          \n\t"\
+        "movq %%mm4, %%mm5          \n\t"\
+        "punpcklbw %%mm7, %%mm2     \n\t"\
+        "punpckhbw %%mm7, %%mm3     \n\t"\
+        "punpcklbw %%mm7, %%mm4     \n\t"\
+        "punpckhbw %%mm7, %%mm5     \n\t"\
+        "paddw %%mm4, %%mm2         \n\t"\
+        "paddw %%mm3, %%mm5         \n\t"\
+        "psubw %%mm2, %%mm0         \n\t"\
+        "psubw %%mm5, %%mm1         \n\t"\
+        "movq %6, %%mm5             \n\t"\
+        "paddw %%mm5, %%mm0         \n\t"\
+        "paddw %%mm5, %%mm1         \n\t"\
+        "psraw $3, %%mm0            \n\t"\
+        "psraw $3, %%mm1            \n\t"\
+        "packuswb %%mm1, %%mm0      \n\t"\
+        OP(%%mm0, (%1),%%mm5, q)         \
+        "add %3, %0                 \n\t"\
+        "add %4, %1                 \n\t"\
+        "decl %2                    \n\t"\
+        " jnz 1b                    \n\t"\
+        : "+a"(src), "+c"(dst), "+m"(h)\
+        : "d"((long)srcStride), "S"((long)dstStride), "m"(ff_pw_5), "m"(ff_pw_4)\
+        : "memory"\
+    );\
+}\
+\
+static inline void OPNAME ## cavs_qpel8or16_v1_ ## MMX(uint8_t *dst, uint8_t *src, int dstStride, int srcStride, int h){\
+  QPEL_CAVSVNUM(QPEL_CAVSV1,OP,ff_pw_64,ff_pw_96,ff_pw_42)      \
+}\
+\
+static inline void OPNAME ## cavs_qpel8or16_v2_ ## MMX(uint8_t *dst, uint8_t *src, int dstStride, int srcStride, int h){\
+  QPEL_CAVSVNUM(QPEL_CAVSV2,OP,ff_pw_4,ff_pw_5,ff_pw_5)         \
+}\
+\
+static inline void OPNAME ## cavs_qpel8or16_v3_ ## MMX(uint8_t *dst, uint8_t *src, int dstStride, int srcStride, int h){\
+  QPEL_CAVSVNUM(QPEL_CAVSV3,OP,ff_pw_64,ff_pw_96,ff_pw_42)      \
+}\
+\
+static void OPNAME ## cavs_qpel8_v1_ ## MMX(uint8_t *dst, uint8_t *src, int dstStride, int srcStride){\
+    OPNAME ## cavs_qpel8or16_v1_ ## MMX(dst  , src  , dstStride, srcStride, 8);\
+}\
+static void OPNAME ## cavs_qpel16_v1_ ## MMX(uint8_t *dst, uint8_t *src, int dstStride, int srcStride){\
+    OPNAME ## cavs_qpel8or16_v1_ ## MMX(dst  , src  , dstStride, srcStride, 16);\
+    OPNAME ## cavs_qpel8or16_v1_ ## MMX(dst+8, src+8, dstStride, srcStride, 16);\
+}\
+\
+static void OPNAME ## cavs_qpel8_v2_ ## MMX(uint8_t *dst, uint8_t *src, int dstStride, int srcStride){\
+    OPNAME ## cavs_qpel8or16_v2_ ## MMX(dst  , src  , dstStride, srcStride, 8);\
+}\
+static void OPNAME ## cavs_qpel16_v2_ ## MMX(uint8_t *dst, uint8_t *src, int dstStride, int srcStride){\
+    OPNAME ## cavs_qpel8or16_v2_ ## MMX(dst  , src  , dstStride, srcStride, 16);\
+    OPNAME ## cavs_qpel8or16_v2_ ## MMX(dst+8, src+8, dstStride, srcStride, 16);\
+}\
+\
+static void OPNAME ## cavs_qpel8_v3_ ## MMX(uint8_t *dst, uint8_t *src, int dstStride, int srcStride){\
+    OPNAME ## cavs_qpel8or16_v3_ ## MMX(dst  , src  , dstStride, srcStride, 8);\
+}\
+static void OPNAME ## cavs_qpel16_v3_ ## MMX(uint8_t *dst, uint8_t *src, int dstStride, int srcStride){\
+    OPNAME ## cavs_qpel8or16_v3_ ## MMX(dst  , src  , dstStride, srcStride, 16);\
+    OPNAME ## cavs_qpel8or16_v3_ ## MMX(dst+8, src+8, dstStride, srcStride, 16);\
+}\
+\
+static void OPNAME ## cavs_qpel16_h_ ## MMX(uint8_t *dst, uint8_t *src, int dstStride, int srcStride){\
+    OPNAME ## cavs_qpel8_h_ ## MMX(dst  , src  , dstStride, srcStride);\
+    OPNAME ## cavs_qpel8_h_ ## MMX(dst+8, src+8, dstStride, srcStride);\
+    src += 8*srcStride;\
+    dst += 8*dstStride;\
+    OPNAME ## cavs_qpel8_h_ ## MMX(dst  , src  , dstStride, srcStride);\
+    OPNAME ## cavs_qpel8_h_ ## MMX(dst+8, src+8, dstStride, srcStride);\
+}\
+
+#define CAVS_MC(OPNAME, SIZE, MMX) \
+static void ff_ ## OPNAME ## cavs_qpel ## SIZE ## _mc20_ ## MMX(uint8_t *dst, uint8_t *src, int stride){\
+    OPNAME ## cavs_qpel ## SIZE ## _h_ ## MMX(dst, src, stride, stride);\
+}\
+\
+static void ff_ ## OPNAME ## cavs_qpel ## SIZE ## _mc01_ ## MMX(uint8_t *dst, uint8_t *src, int stride){\
+    OPNAME ## cavs_qpel ## SIZE ## _v1_ ## MMX(dst, src, stride, stride);\
+}\
+\
+static void ff_ ## OPNAME ## cavs_qpel ## SIZE ## _mc02_ ## MMX(uint8_t *dst, uint8_t *src, int stride){\
+    OPNAME ## cavs_qpel ## SIZE ## _v2_ ## MMX(dst, src, stride, stride);\
+}\
+\
+static void ff_ ## OPNAME ## cavs_qpel ## SIZE ## _mc03_ ## MMX(uint8_t *dst, uint8_t *src, int stride){\
+    OPNAME ## cavs_qpel ## SIZE ## _v3_ ## MMX(dst, src, stride, stride);\
+}\
+
+#define PUT_OP(a,b,temp, size) "mov" #size " " #a ", " #b "    \n\t"
+#define AVG_3DNOW_OP(a,b,temp, size) \
+"mov" #size " " #b ", " #temp "   \n\t"\
+"pavgusb " #temp ", " #a "        \n\t"\
+"mov" #size " " #a ", " #b "      \n\t"
+#define AVG_MMX2_OP(a,b,temp, size) \
+"mov" #size " " #b ", " #temp "   \n\t"\
+"pavgb " #temp ", " #a "          \n\t"\
+"mov" #size " " #a ", " #b "      \n\t"
+
+QPEL_CAVS(put_,       PUT_OP, 3dnow)
+QPEL_CAVS(avg_, AVG_3DNOW_OP, 3dnow)
+QPEL_CAVS(put_,       PUT_OP, mmx2)
+QPEL_CAVS(avg_,  AVG_MMX2_OP, mmx2)
+
+CAVS_MC(put_, 8, 3dnow)
+CAVS_MC(put_, 16,3dnow)
+CAVS_MC(avg_, 8, 3dnow)
+CAVS_MC(avg_, 16,3dnow)
+CAVS_MC(put_, 8, mmx2)
+CAVS_MC(put_, 16,mmx2)
+CAVS_MC(avg_, 8, mmx2)
+CAVS_MC(avg_, 16,mmx2)
+
+void ff_put_cavs_qpel8_mc00_mmx2(uint8_t *dst, uint8_t *src, int stride);
+void ff_avg_cavs_qpel8_mc00_mmx2(uint8_t *dst, uint8_t *src, int stride);
+void ff_put_cavs_qpel16_mc00_mmx2(uint8_t *dst, uint8_t *src, int stride);
+void ff_avg_cavs_qpel16_mc00_mmx2(uint8_t *dst, uint8_t *src, int stride);
+
+void ff_cavsdsp_init_mmx2(DSPContext* c, AVCodecContext *avctx) {
+#define dspfunc(PFX, IDX, NUM) \
+    c->PFX ## _pixels_tab[IDX][ 0] = ff_ ## PFX ## NUM ## _mc00_mmx2; \
+    c->PFX ## _pixels_tab[IDX][ 2] = ff_ ## PFX ## NUM ## _mc20_mmx2; \
+    c->PFX ## _pixels_tab[IDX][ 4] = ff_ ## PFX ## NUM ## _mc01_mmx2; \
+    c->PFX ## _pixels_tab[IDX][ 8] = ff_ ## PFX ## NUM ## _mc02_mmx2; \
+    c->PFX ## _pixels_tab[IDX][12] = ff_ ## PFX ## NUM ## _mc03_mmx2; \
+
+    dspfunc(put_cavs_qpel, 0, 16);
+    dspfunc(put_cavs_qpel, 1, 8);
+    dspfunc(avg_cavs_qpel, 0, 16);
+    dspfunc(avg_cavs_qpel, 1, 8);
+#undef dspfunc
+    c->cavs_idct8_add = cavs_idct8_add_mmx;
+}
+
+void ff_cavsdsp_init_3dnow(DSPContext* c, AVCodecContext *avctx) {
+#define dspfunc(PFX, IDX, NUM) \
+    c->PFX ## _pixels_tab[IDX][ 0] = ff_ ## PFX ## NUM ## _mc00_mmx2; \
+    c->PFX ## _pixels_tab[IDX][ 2] = ff_ ## PFX ## NUM ## _mc20_3dnow; \
+    c->PFX ## _pixels_tab[IDX][ 4] = ff_ ## PFX ## NUM ## _mc01_3dnow; \
+    c->PFX ## _pixels_tab[IDX][ 8] = ff_ ## PFX ## NUM ## _mc02_3dnow; \
+    c->PFX ## _pixels_tab[IDX][12] = ff_ ## PFX ## NUM ## _mc03_3dnow; \
+
+    dspfunc(put_cavs_qpel, 0, 16);
+    dspfunc(put_cavs_qpel, 1, 8);
+    dspfunc(avg_cavs_qpel, 0, 16);
+    dspfunc(avg_cavs_qpel, 1, 8);
+#undef dspfunc
+    c->cavs_idct8_add = cavs_idct8_add_mmx;
+}

Added: branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec/i386/dsputil_mmx_qns.h
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec/i386/dsputil_mmx_qns.h	2007-07-16 18:14:46 UTC (rev 3392)
+++ branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec/i386/dsputil_mmx_qns.h	2007-07-16 18:17:13 UTC (rev 3393)
@@ -0,0 +1,102 @@
+/*
+ * DSP utils : QNS functions are compiled 3 times for mmx/3dnow/ssse3
+ * Copyright (c) 2004 Michael Niedermayer
+ *
+ * MMX optimization by Michael Niedermayer <michaelni at gmx.at>
+ * 3DNow! and SSSE3 optimization by Zuxy Meng <zuxy.meng at gmail.com>
+ *
+ * This file is part of FFmpeg.
+ *
+ * FFmpeg is free software; you can redistribute it and/or
+ * modify it under the terms of the GNU Lesser General Public
+ * License as published by the Free Software Foundation; either
+ * version 2.1 of the License, or (at your option) any later version.
+ *
+ * FFmpeg is distributed in the hope that it will be useful,
+ * but WITHOUT ANY WARRANTY; without even the implied warranty of
+ * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ * Lesser General Public License for more details.
+ *
+ * You should have received a copy of the GNU Lesser General Public
+ * License along with FFmpeg; if not, write to the Free Software
+ * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA
+ */
+
+#define MAX_ABS (512 >> (SCALE_OFFSET>0 ? SCALE_OFFSET : 0))
+
+static int DEF(try_8x8basis)(int16_t rem[64], int16_t weight[64], int16_t basis[64], int scale)
+{
+    long i=0;
+
+    assert(FFABS(scale) < MAX_ABS);
+    scale<<= 16 + SCALE_OFFSET - BASIS_SHIFT + RECON_SHIFT;
+
+    SET_RND(mm6);
+    asm volatile(
+        "pxor %%mm7, %%mm7              \n\t"
+        "movd  %4, %%mm5                \n\t"
+        "punpcklwd %%mm5, %%mm5         \n\t"
+        "punpcklwd %%mm5, %%mm5         \n\t"
+        ASMALIGN(4)
+        "1:                             \n\t"
+        "movq  (%1, %0), %%mm0          \n\t"
+        "movq  8(%1, %0), %%mm1         \n\t"
+        PMULHRW(%%mm0, %%mm1, %%mm5, %%mm6)
+        "paddw (%2, %0), %%mm0          \n\t"
+        "paddw 8(%2, %0), %%mm1         \n\t"
+        "psraw $6, %%mm0                \n\t"
+        "psraw $6, %%mm1                \n\t"
+        "pmullw (%3, %0), %%mm0         \n\t"
+        "pmullw 8(%3, %0), %%mm1        \n\t"
+        "pmaddwd %%mm0, %%mm0           \n\t"
+        "pmaddwd %%mm1, %%mm1           \n\t"
+        "paddd %%mm1, %%mm0             \n\t"
+        "psrld $4, %%mm0                \n\t"
+        "paddd %%mm0, %%mm7             \n\t"
+        "add $16, %0                    \n\t"
+        "cmp $128, %0                   \n\t" //FIXME optimize & bench
+        " jb 1b                         \n\t"
+        PHADDD(%%mm7, %%mm6)
+        "psrld $2, %%mm7                \n\t"
+        "movd %%mm7, %0                 \n\t"
+
+        : "+r" (i)
+        : "r"(basis), "r"(rem), "r"(weight), "g"(scale)
+    );
+    return i;
+}
+
+static void DEF(add_8x8basis)(int16_t rem[64], int16_t basis[64], int scale)
+{
+    long i=0;
+
+    if(FFABS(scale) < MAX_ABS){
+        scale<<= 16 + SCALE_OFFSET - BASIS_SHIFT + RECON_SHIFT;
+        SET_RND(mm6);
+        asm volatile(
+                "movd  %3, %%mm5        \n\t"
+                "punpcklwd %%mm5, %%mm5 \n\t"
+                "punpcklwd %%mm5, %%mm5 \n\t"
+                ASMALIGN(4)
+                "1:                     \n\t"
+                "movq  (%1, %0), %%mm0  \n\t"
+                "movq  8(%1, %0), %%mm1 \n\t"
+                PMULHRW(%%mm0, %%mm1, %%mm5, %%mm6)
+                "paddw (%2, %0), %%mm0  \n\t"
+                "paddw 8(%2, %0), %%mm1 \n\t"
+                "movq %%mm0, (%2, %0)   \n\t"
+                "movq %%mm1, 8(%2, %0)  \n\t"
+                "add $16, %0            \n\t"
+                "cmp $128, %0           \n\t" // FIXME optimize & bench
+                " jb 1b                 \n\t"
+
+                : "+r" (i)
+                : "r"(basis), "r"(rem), "g"(scale)
+        );
+    }else{
+        for(i=0; i<8*8; i++){
+            rem[i] += (basis[i]*scale + (1<<(BASIS_SHIFT - RECON_SHIFT-1)))>>(BASIS_SHIFT - RECON_SHIFT);
+        }
+    }
+}
+

Added: branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec/i386/vp3dsp_mmx.h
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec/i386/vp3dsp_mmx.h	2007-07-16 18:14:46 UTC (rev 3392)
+++ branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec/i386/vp3dsp_mmx.h	2007-07-16 18:17:13 UTC (rev 3393)
@@ -0,0 +1,32 @@
+/*
+ * vp3dsp MMX function declarations
+ * Copyright (c) 2007 Aurelien Jacobs <aurel at gnuage.org>
+ *
+ * This file is part of FFmpeg.
+ *
+ * FFmpeg is free software; you can redistribute it and/or
+ * modify it under the terms of the GNU Lesser General Public
+ * License as published by the Free Software Foundation; either
+ * version 2.1 of the License, or (at your option) any later version.
+ *
+ * FFmpeg is distributed in the hope that it will be useful,
+ * but WITHOUT ANY WARRANTY; without even the implied warranty of
+ * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ * Lesser General Public License for more details.
+ *
+ * You should have received a copy of the GNU Lesser General Public
+ * License along with FFmpeg; if not, write to the Free Software
+ * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA
+ */
+
+#ifndef VP3DSP_MMX_H
+#define VP3DSP_MMX_H
+
+#include "dsputil.h"
+
+void ff_vp3_idct_mmx(int16_t *data);
+void ff_vp3_idct_put_mmx(uint8_t *dest, int line_size, DCTELEM *block);
+void ff_vp3_idct_add_mmx(uint8_t *dest, int line_size, DCTELEM *block);
+void ff_vp3_dsp_init_mmx(void);
+
+#endif /* VP3DSP_MMX_H */

Added: branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec/i386/vp3dsp_sse2.h
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec/i386/vp3dsp_sse2.h	2007-07-16 18:14:46 UTC (rev 3392)
+++ branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec/i386/vp3dsp_sse2.h	2007-07-16 18:17:13 UTC (rev 3393)
@@ -0,0 +1,31 @@
+/*
+ * vp3dsp SSE2 function declarations
+ * Copyright (c) 2007 Aurelien Jacobs <aurel at gnuage.org>
+ *
+ * This file is part of FFmpeg.
+ *
+ * FFmpeg is free software; you can redistribute it and/or
+ * modify it under the terms of the GNU Lesser General Public
+ * License as published by the Free Software Foundation; either
+ * version 2.1 of the License, or (at your option) any later version.
+ *
+ * FFmpeg is distributed in the hope that it will be useful,
+ * but WITHOUT ANY WARRANTY; without even the implied warranty of
+ * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ * Lesser General Public License for more details.
+ *
+ * You should have received a copy of the GNU Lesser General Public
+ * License along with FFmpeg; if not, write to the Free Software
+ * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA
+ */
+
+#ifndef VP3DSP_SSE2_H
+#define VP3DSP_SSE2_H
+
+#include "dsputil.h"
+
+void ff_vp3_idct_sse2(int16_t *input_data);
+void ff_vp3_idct_put_sse2(uint8_t *dest, int line_size, DCTELEM *block);
+void ff_vp3_idct_add_sse2(uint8_t *dest, int line_size, DCTELEM *block);
+
+#endif /* VP3DSP_SSE2_H */

Added: branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec/jpeglsdec.h
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec/jpeglsdec.h	2007-07-16 18:14:46 UTC (rev 3392)
+++ branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec/jpeglsdec.h	2007-07-16 18:17:13 UTC (rev 3393)
@@ -0,0 +1,41 @@
+/*
+ * JPEG-LS decoder
+ * Copyright (c) 2003 Michael Niedermayer
+ * Copyright (c) 2006 Konstantin Shishkov
+ *
+ * This file is part of FFmpeg.
+ *
+ * FFmpeg is free software; you can redistribute it and/or
+ * modify it under the terms of the GNU Lesser General Public
+ * License as published by the Free Software Foundation; either
+ * version 2.1 of the License, or (at your option) any later version.
+ *
+ * FFmpeg is distributed in the hope that it will be useful,
+ * but WITHOUT ANY WARRANTY; without even the implied warranty of
+ * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ * Lesser General Public License for more details.
+ *
+ * You should have received a copy of the GNU Lesser General Public
+ * License along with FFmpeg; if not, write to the Free Software
+ * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA
+ */
+
+/**
+ * @file jpeglsdec.h
+ * JPEG-LS decoder.
+ */
+
+#ifndef JPEGLSDEC_H
+#define JPEGLSDEC_H
+
+#include "mjpeg.h"
+#include "mjpegdec.h"
+
+/**
+ * Decode LSE block with initialization parameters
+ */
+int ff_jpegls_decode_lse(MJpegDecodeContext *s);
+
+int ff_jpegls_decode_picture(MJpegDecodeContext *s, int near, int point_transform, int ilv);
+
+#endif /* JPEGLSDEC_H */

Added: branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavformat/matroska.h
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavformat/matroska.h	2007-07-16 18:14:46 UTC (rev 3392)
+++ branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavformat/matroska.h	2007-07-16 18:17:13 UTC (rev 3393)
@@ -0,0 +1,196 @@
+/*
+ * Matroska constants
+ * Copyright (c) 2003-2004 The ffmpeg Project
+ *
+ * This file is part of FFmpeg.
+ *
+ * FFmpeg is free software; you can redistribute it and/or
+ * modify it under the terms of the GNU Lesser General Public
+ * License as published by the Free Software Foundation; either
+ * version 2.1 of the License, or (at your option) any later version.
+ *
+ * FFmpeg is distributed in the hope that it will be useful,
+ * but WITHOUT ANY WARRANTY; without even the implied warranty of
+ * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ * Lesser General Public License for more details.
+ *
+ * You should have received a copy of the GNU Lesser General Public
+ * License along with FFmpeg; if not, write to the Free Software
+ * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA
+ */
+
+#ifndef MATROSKA_H
+#define MATROSKA_H
+
+#include "avcodec.h"
+
+/* EBML version supported */
+#define EBML_VERSION 1
+
+/* top-level master-IDs */
+#define EBML_ID_HEADER             0x1A45DFA3
+
+/* IDs in the HEADER master */
+#define EBML_ID_EBMLVERSION        0x4286
+#define EBML_ID_EBMLREADVERSION    0x42F7
+#define EBML_ID_EBMLMAXIDLENGTH    0x42F2
+#define EBML_ID_EBMLMAXSIZELENGTH  0x42F3
+#define EBML_ID_DOCTYPE            0x4282
+#define EBML_ID_DOCTYPEVERSION     0x4287
+#define EBML_ID_DOCTYPEREADVERSION 0x4285
+
+/* general EBML types */
+#define EBML_ID_VOID               0xEC
+
+/*
+ * Matroska element IDs. max. 32-bit.
+ */
+
+/* toplevel segment */
+#define MATROSKA_ID_SEGMENT    0x18538067
+
+/* matroska top-level master IDs */
+#define MATROSKA_ID_INFO       0x1549A966
+#define MATROSKA_ID_TRACKS     0x1654AE6B
+#define MATROSKA_ID_CUES       0x1C53BB6B
+#define MATROSKA_ID_TAGS       0x1254C367
+#define MATROSKA_ID_SEEKHEAD   0x114D9B74
+#define MATROSKA_ID_CLUSTER    0x1F43B675
+
+/* IDs in the info master */
+#define MATROSKA_ID_TIMECODESCALE 0x2AD7B1
+#define MATROSKA_ID_DURATION   0x4489
+#define MATROSKA_ID_TITLE      0x7BA9
+#define MATROSKA_ID_WRITINGAPP 0x5741
+#define MATROSKA_ID_MUXINGAPP  0x4D80
+#define MATROSKA_ID_DATEUTC    0x4461
+
+/* ID in the tracks master */
+#define MATROSKA_ID_TRACKENTRY 0xAE
+
+/* IDs in the trackentry master */
+#define MATROSKA_ID_TRACKNUMBER 0xD7
+#define MATROSKA_ID_TRACKUID   0x73C5
+#define MATROSKA_ID_TRACKTYPE  0x83
+#define MATROSKA_ID_TRACKAUDIO 0xE1
+#define MATROSKA_ID_TRACKVIDEO 0xE0
+#define MATROSKA_ID_CODECID    0x86
+#define MATROSKA_ID_CODECPRIVATE 0x63A2
+#define MATROSKA_ID_CODECNAME  0x258688
+#define MATROSKA_ID_CODECINFOURL 0x3B4040
+#define MATROSKA_ID_CODECDOWNLOADURL 0x26B240
+#define MATROSKA_ID_TRACKNAME  0x536E
+#define MATROSKA_ID_TRACKLANGUAGE 0x22B59C
+#define MATROSKA_ID_TRACKFLAGENABLED 0xB9
+#define MATROSKA_ID_TRACKFLAGDEFAULT 0x88
+#define MATROSKA_ID_TRACKFLAGLACING 0x9C
+#define MATROSKA_ID_TRACKMINCACHE 0x6DE7
+#define MATROSKA_ID_TRACKMAXCACHE 0x6DF8
+#define MATROSKA_ID_TRACKDEFAULTDURATION 0x23E383
+
+/* IDs in the trackvideo master */
+#define MATROSKA_ID_VIDEOFRAMERATE 0x2383E3
+#define MATROSKA_ID_VIDEODISPLAYWIDTH 0x54B0
+#define MATROSKA_ID_VIDEODISPLAYHEIGHT 0x54BA
+#define MATROSKA_ID_VIDEOPIXELWIDTH 0xB0
+#define MATROSKA_ID_VIDEOPIXELHEIGHT 0xBA
+#define MATROSKA_ID_VIDEOFLAGINTERLACED 0x9A
+#define MATROSKA_ID_VIDEOSTEREOMODE 0x53B9
+#define MATROSKA_ID_VIDEOASPECTRATIO 0x54B3
+#define MATROSKA_ID_VIDEOCOLOURSPACE 0x2EB524
+
+/* IDs in the trackaudio master */
+#define MATROSKA_ID_AUDIOSAMPLINGFREQ 0xB5
+#define MATROSKA_ID_AUDIOOUTSAMPLINGFREQ 0x78B5
+
+#define MATROSKA_ID_AUDIOBITDEPTH 0x6264
+#define MATROSKA_ID_AUDIOCHANNELS 0x9F
+
+/* ID in the cues master */
+#define MATROSKA_ID_POINTENTRY 0xBB
+
+/* IDs in the pointentry master */
+#define MATROSKA_ID_CUETIME    0xB3
+#define MATROSKA_ID_CUETRACKPOSITION 0xB7
+
+/* IDs in the cuetrackposition master */
+#define MATROSKA_ID_CUETRACK   0xF7
+#define MATROSKA_ID_CUECLUSTERPOSITION 0xF1
+
+/* IDs in the tags master */
+/* TODO */
+
+/* IDs in the seekhead master */
+#define MATROSKA_ID_SEEKENTRY  0x4DBB
+
+/* IDs in the seekpoint master */
+#define MATROSKA_ID_SEEKID     0x53AB
+#define MATROSKA_ID_SEEKPOSITION 0x53AC
+
+/* IDs in the cluster master */
+#define MATROSKA_ID_CLUSTERTIMECODE 0xE7
+#define MATROSKA_ID_BLOCKGROUP 0xA0
+#define MATROSKA_ID_SIMPLEBLOCK 0xA3
+
+/* IDs in the blockgroup master */
+#define MATROSKA_ID_BLOCK      0xA1
+#define MATROSKA_ID_BLOCKDURATION 0x9B
+#define MATROSKA_ID_BLOCKREFERENCE 0xFB
+
+typedef enum {
+  MATROSKA_TRACK_TYPE_VIDEO    = 0x1,
+  MATROSKA_TRACK_TYPE_AUDIO    = 0x2,
+  MATROSKA_TRACK_TYPE_COMPLEX  = 0x3,
+  MATROSKA_TRACK_TYPE_LOGO     = 0x10,
+  MATROSKA_TRACK_TYPE_SUBTITLE = 0x11,
+  MATROSKA_TRACK_TYPE_CONTROL  = 0x20,
+} MatroskaTrackType;
+
+typedef enum {
+  MATROSKA_EYE_MODE_MONO  = 0x0,
+  MATROSKA_EYE_MODE_RIGHT = 0x1,
+  MATROSKA_EYE_MODE_LEFT  = 0x2,
+  MATROSKA_EYE_MODE_BOTH  = 0x3,
+} MatroskaEyeMode;
+
+typedef enum {
+  MATROSKA_ASPECT_RATIO_MODE_FREE  = 0x0,
+  MATROSKA_ASPECT_RATIO_MODE_KEEP  = 0x1,
+  MATROSKA_ASPECT_RATIO_MODE_FIXED = 0x2,
+} MatroskaAspectRatioMode;
+
+/*
+ * These aren't in any way "matroska-form" things,
+ * it's just something I use in the muxer/demuxer.
+ */
+
+typedef enum {
+  MATROSKA_TRACK_ENABLED = (1<<0),
+  MATROSKA_TRACK_DEFAULT = (1<<1),
+  MATROSKA_TRACK_LACING  = (1<<2),
+  MATROSKA_TRACK_REAL_V  = (1<<4),
+  MATROSKA_TRACK_SHIFT   = (1<<16)
+} MatroskaTrackFlags;
+
+typedef enum {
+  MATROSKA_VIDEOTRACK_INTERLACED = (MATROSKA_TRACK_SHIFT<<0)
+} MatroskaVideoTrackFlags;
+
+/*
+ * Matroska Codec IDs. Strings.
+ */
+
+typedef struct CodecTags{
+    const char *str;
+    enum CodecID id;
+}CodecTags;
+
+#define MATROSKA_CODEC_ID_VIDEO_VFW_FOURCC   "V_MS/VFW/FOURCC"
+#define MATROSKA_CODEC_ID_AUDIO_ACM          "A_MS/ACM"
+
+/* max. depth in the EBML tree structure */
+#define EBML_MAX_DEPTH 16
+
+extern CodecTags ff_mkv_codec_tags[];
+
+#endif /* MATROSKA_H */

Added: branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavformat/mpeg.h
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavformat/mpeg.h	2007-07-16 18:14:46 UTC (rev 3392)
+++ branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavformat/mpeg.h	2007-07-16 18:17:13 UTC (rev 3393)
@@ -0,0 +1,60 @@
+/*
+ * MPEG1/2 muxer and demuxer common defines
+ * Copyright (c) 2000, 2001, 2002 Fabrice Bellard.
+ *
+ * This file is part of FFmpeg.
+ *
+ * FFmpeg is free software; you can redistribute it and/or
+ * modify it under the terms of the GNU Lesser General Public
+ * License as published by the Free Software Foundation; either
+ * version 2.1 of the License, or (at your option) any later version.
+ *
+ * FFmpeg is distributed in the hope that it will be useful,
+ * but WITHOUT ANY WARRANTY; without even the implied warranty of
+ * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ * Lesser General Public License for more details.
+ *
+ * You should have received a copy of the GNU Lesser General Public
+ * License along with FFmpeg; if not, write to the Free Software
+ * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA
+ */
+
+#ifndef AVFORMAT_MPEG_H
+#define AVFORMAT_MPEG_H
+
+#define PACK_START_CODE             ((unsigned int)0x000001ba)
+#define SYSTEM_HEADER_START_CODE    ((unsigned int)0x000001bb)
+#define SEQUENCE_END_CODE           ((unsigned int)0x000001b7)
+#define PACKET_START_CODE_MASK      ((unsigned int)0xffffff00)
+#define PACKET_START_CODE_PREFIX    ((unsigned int)0x00000100)
+#define ISO_11172_END_CODE          ((unsigned int)0x000001b9)
+
+/* mpeg2 */
+#define PROGRAM_STREAM_MAP 0x1bc
+#define PRIVATE_STREAM_1   0x1bd
+#define PADDING_STREAM     0x1be
+#define PRIVATE_STREAM_2   0x1bf
+
+#define AUDIO_ID 0xc0
+#define VIDEO_ID 0xe0
+#define AC3_ID   0x80
+#define DTS_ID   0x8a
+#define LPCM_ID  0xa0
+#define SUB_ID   0x20
+
+#define STREAM_TYPE_VIDEO_MPEG1     0x01
+#define STREAM_TYPE_VIDEO_MPEG2     0x02
+#define STREAM_TYPE_AUDIO_MPEG1     0x03
+#define STREAM_TYPE_AUDIO_MPEG2     0x04
+#define STREAM_TYPE_PRIVATE_SECTION 0x05
+#define STREAM_TYPE_PRIVATE_DATA    0x06
+#define STREAM_TYPE_AUDIO_AAC       0x0f
+#define STREAM_TYPE_VIDEO_MPEG4     0x10
+#define STREAM_TYPE_VIDEO_H264      0x1b
+
+#define STREAM_TYPE_AUDIO_AC3       0x81
+#define STREAM_TYPE_AUDIO_DTS       0x8a
+
+static const int lpcm_freq_tab[4] = { 48000, 96000, 44100, 32000 };
+
+#endif /* AVFORMAT_MPEG_H */



From mean at mail.berlios.de  Mon Jul 16 20:18:57 2007
From: mean at mail.berlios.de (mean at BerliOS)
Date: Mon, 16 Jul 2007 20:18:57 +0200
Subject: [Avidemux-svn-commit] r3394 - in
	branches/avidemux_2.4_branch/avidemux/ADM_libraries:
	ADM_lavcodec ADM_lavutil
Message-ID: <200707161818.l6GIIvI4010945@sheep.berlios.de>

Author: mean
Date: 2007-07-16 20:18:57 +0200 (Mon, 16 Jul 2007)
New Revision: 3394

Added:
   branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec/svq1.h
   branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavutil/random.h
Log:
lost files

Added: branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec/svq1.h
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec/svq1.h	2007-07-16 18:17:13 UTC (rev 3393)
+++ branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec/svq1.h	2007-07-16 18:18:57 UTC (rev 3394)
@@ -0,0 +1,61 @@
+/*
+ * SVQ1 decoder
+ * ported to MPlayer by Arpi <arpi at thot.banki.hu>
+ * ported to libavcodec by Nick Kurshev <nickols_k at mail.ru>
+ *
+ * Copyright (C) 2002 the xine project
+ * Copyright (C) 2002 the ffmpeg project
+ *
+ * SVQ1 Encoder (c) 2004 Mike Melanson <melanson at pcisys.net>
+ *
+ * This file is part of FFmpeg.
+ *
+ * FFmpeg is free software; you can redistribute it and/or
+ * modify it under the terms of the GNU Lesser General Public
+ * License as published by the Free Software Foundation; either
+ * version 2.1 of the License, or (at your option) any later version.
+ *
+ * FFmpeg is distributed in the hope that it will be useful,
+ * but WITHOUT ANY WARRANTY; without even the implied warranty of
+ * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ * Lesser General Public License for more details.
+ *
+ * You should have received a copy of the GNU Lesser General Public
+ * License along with FFmpeg; if not, write to the Free Software
+ * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA
+ */
+
+/**
+ * @file svq1.h
+ * Sorenson Vector Quantizer #1 (SVQ1) video codec.
+ * For more information of the SVQ1 algorithm, visit:
+ *   http://www.pcisys.net/~melanson/codecs/
+ */
+
+#ifndef AVCODEC_SVQ1_H
+#define AVCODEC_SVQ1_H
+
+#include <stdint.h>
+
+#define SVQ1_BLOCK_SKIP         0
+#define SVQ1_BLOCK_INTER        1
+#define SVQ1_BLOCK_INTER_4V     2
+#define SVQ1_BLOCK_INTRA        3
+
+typedef struct {
+    int width;
+    int height;
+} svq1_frame_size_t;
+
+extern const int8_t* const ff_svq1_inter_codebooks[6];
+extern const int8_t* const ff_svq1_intra_codebooks[6];
+
+extern const uint8_t ff_svq1_block_type_vlc[4][2];
+extern const uint8_t ff_svq1_intra_multistage_vlc[6][8][2];
+extern const uint8_t ff_svq1_inter_multistage_vlc[6][8][2];
+extern const uint16_t ff_svq1_intra_mean_vlc[256][2];
+extern const uint16_t ff_svq1_inter_mean_vlc[512][2];
+
+extern svq1_frame_size_t ff_svq1_frame_size_table[8];
+
+#endif /* AVCODEC_SVQ1_H */

Added: branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavutil/random.h
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavutil/random.h	2007-07-16 18:17:13 UTC (rev 3393)
+++ branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavutil/random.h	2007-07-16 18:18:57 UTC (rev 3394)
@@ -0,0 +1,69 @@
+/*
+ * Mersenne Twister Random Algorithm
+ * Copyright (c) 2006 Ryan Martell.
+ * Based on A C-program for MT19937, with initialization improved 2002/1/26. Coded by
+ * Takuji Nishimura and Makoto Matsumoto.
+ *
+ * This file is part of FFmpeg.
+ *
+ * FFmpeg is free software; you can redistribute it and/or
+ * modify it under the terms of the GNU Lesser General Public
+ * License as published by the Free Software Foundation; either
+ * version 2.1 of the License, or (at your option) any later version.
+ *
+ * FFmpeg is distributed in the hope that it will be useful,
+ * but WITHOUT ANY WARRANTY; without even the implied warranty of
+ * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ * Lesser General Public License for more details.
+ *
+ * You should have received a copy of the GNU Lesser General Public
+ * License along with FFmpeg; if not, write to the Free Software
+ * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA
+ */
+
+#ifndef AV_RANDOM_H
+#define AV_RANDOM_H
+
+#define AV_RANDOM_N 624
+
+typedef struct {
+    unsigned int mt[AV_RANDOM_N]; ///< the array for the state vector
+    int index; ///< current untempered value we use as the base.
+} AVRandomState;
+
+
+void av_init_random(unsigned int seed, AVRandomState *state); ///< to be inlined, the struct must be visible, so it doesn't make sense to try and keep it opaque with malloc/free like calls
+void av_random_generate_untempered_numbers(AVRandomState *state); ///< Regenerate the untempered numbers (must be done every 624 iterations, or it will loop)
+
+/** generates a random number on [0,0xffffffff]-interval */
+static inline unsigned int av_random(AVRandomState *state)
+{
+    unsigned int y;
+
+    // regenerate the untempered numbers if we should...
+    if (state->index >= AV_RANDOM_N)
+        av_random_generate_untempered_numbers(state);
+
+    // grab one...
+    y = state->mt[state->index++];
+
+    /* Now temper (Mersenne Twister coefficients) The coefficients for MT19937 are.. */
+    y ^= (y >> 11);
+    y ^= (y << 7) & 0x9d2c5680;
+    y ^= (y << 15) & 0xefc60000;
+    y ^= (y >> 18);
+
+    return y;
+}
+
+/** return random in range [0-1] as double */
+static inline double av_random_real1(AVRandomState *state)
+{
+    /* divided by 2^32-1 */
+    return av_random(state) * (1.0 / 4294967296.0);
+}
+
+// only available if DEBUG is defined in the .c file
+void av_benchmark_random(void);
+#endif // AV_RANDOM_H
+



From mean at mail.berlios.de  Mon Jul 16 20:19:55 2007
From: mean at mail.berlios.de (mean at BerliOS)
Date: Mon, 16 Jul 2007 20:19:55 +0200
Subject: [Avidemux-svn-commit] r3395 - branches/avidemux_2.4_branch
Message-ID: <200707161819.l6GIJtCS011000@sheep.berlios.de>

Author: mean
Date: 2007-07-16 20:19:55 +0200 (Mon, 16 Jul 2007)
New Revision: 3395

Modified:
   branches/avidemux_2.4_branch/ConfigureChecks.cmake
   branches/avidemux_2.4_branch/config.h.cmake
Log:
lav update

Modified: branches/avidemux_2.4_branch/ConfigureChecks.cmake
===================================================================
--- branches/avidemux_2.4_branch/ConfigureChecks.cmake	2007-07-16 18:18:57 UTC (rev 3394)
+++ branches/avidemux_2.4_branch/ConfigureChecks.cmake	2007-07-16 18:19:55 UTC (rev 3395)
@@ -38,6 +38,7 @@
 SET(PACKAGE_VERSION 2.4)
 
 # We use FFMPEG
+SET(ENABLE_THREADS    1)
 SET(USE_MP3    1)
 SET(USE_AC3    1)
 SET(USE_FFMPEG    1)
@@ -364,6 +365,7 @@
    SET(CYG_MANGLING 1)
    SET(ARCH_X86    1)
    SET(HAVE_MMX    1)
+   SET(ENABLE_MMX    1)
    SET(ARCH_X86    1)
    SET(HAVE_MMX    1)
    SET(ARCH_X86_32    1)
@@ -376,6 +378,7 @@
         MESSAGE(STATUS "x86 CPU, MACINTEL")
         SET(ARCH_X86    1)
         SET(HAVE_MMX    1)
+        SET(ENABLE_MMX    1)
         SET(ARCH_X86_32    1)
         SET(FPM_INTEL    1)
       endif(CMAKE_OSX_SYSROOT AND  ${CMAKE_SYSTEM_PROCESSOR} STREQUAL "i386")
@@ -384,6 +387,7 @@
           MESSAGE(STATUS "x86 CPU")
           SET(ARCH_X86    1)
           SET(HAVE_MMX    1)
+          SET(ENABLE_MMX    1)
           SET(ARCH_X86_32    1)
           SET(FPM_INTEL    1)
      endif(${CMAKE_SYSTEM_PROCESSOR} STREQUAL "i586" OR ${CMAKE_SYSTEM_PROCESSOR} STREQUAL "i686")
@@ -394,6 +398,7 @@
          SET(FPM_DEFAULT    1)
          SET(ARCH_64_BITS    1)
          SET(HAVE_MMX    1)
+         SET(ENABLE_MMX    1)
      endif( ${CMAKE_SYSTEM_PROCESSOR} STREQUAL "x86_64" OR ${CMAKE_SYSTEM_PROCESSOR} STREQUAL "amd64")
  endif(WIN32)
 MESSAGE(STATUS "<End of CPU and OS Check>")

Modified: branches/avidemux_2.4_branch/config.h.cmake
===================================================================
--- branches/avidemux_2.4_branch/config.h.cmake	2007-07-16 18:18:57 UTC (rev 3394)
+++ branches/avidemux_2.4_branch/config.h.cmake	2007-07-16 18:19:55 UTC (rev 3395)
@@ -357,6 +357,8 @@
 
 /* post proc */
 #cmakedefine HAVE_MMX
+#cmakedefine ENABLE_MMX ${ENABLE_MMX}
+#cmakedefine ENABLE_THREADS ${ENABLE_THREADS}
 
 /* Define to 1 if you have the <stdint.h> header file. */
 #cmakedefine HAVE_STDINT_H



From mean at mail.berlios.de  Mon Jul 16 20:46:18 2007
From: mean at mail.berlios.de (mean at BerliOS)
Date: Mon, 16 Jul 2007 20:46:18 +0200
Subject: [Avidemux-svn-commit] r3396 -
	branches/avidemux_2.4_branch/avidemux/ADM_inputs/ADM_mp4
Message-ID: <200707161846.l6GIkIMP013203@sheep.berlios.de>

Author: mean
Date: 2007-07-16 20:46:18 +0200 (Mon, 16 Jul 2007)
New Revision: 3396

Modified:
   branches/avidemux_2.4_branch/avidemux/ADM_inputs/ADM_mp4/ADM_mp4Analyzer.cpp
Log:
[MP4input] Correctly compute how much ctts entry there is

Modified: branches/avidemux_2.4_branch/avidemux/ADM_inputs/ADM_mp4/ADM_mp4Analyzer.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_inputs/ADM_mp4/ADM_mp4Analyzer.cpp	2007-07-16 18:19:55 UTC (rev 3395)
+++ branches/avidemux_2.4_branch/avidemux/ADM_inputs/ADM_mp4/ADM_mp4Analyzer.cpp	2007-07-16 18:46:18 UTC (rev 3396)
@@ -403,34 +403,47 @@
            case ADM_MP4_CTTS: // Composition time to sample             
             {
                 uint32_t n,i,j,k,v;
+                
                   printf("ctts:%lu\n",son.read32()); // version & flags
                   n=son.read32();
                   if(n==1) // all the same , ignore
                   {
                     break;
                   }
-                info.Ctts=new uint32_t[n*4]; // keep a safe margin
-            
+                uint32_t *values=new uint32_t [n];
+                uint32_t *count=new uint32_t [n];
                 for(i=0;i<n;i++)
                 {
-                    j=son.read32();
-                    v=son.read32();
+                    count[i]=son.read32();
+                    values[i]=son.read32();
+                }
+                uint32_t sum=0;
+                for(i=0;i<n;i++)
+                {
+                    sum+=count[i];
+                }
+                info.Ctts=new uint32_t[sum+1]; // keep a safe margin
+                
+                for(i=0;i<n;i++)
+                {
                     if(i<20)
                     {
-                        adm_printf(ADM_PRINT_VERY_VERBOSE,"Ctts: nb: %u (%x) val:%u (%x)\n",j,j,v,v);   
+                        adm_printf(ADM_PRINT_VERY_VERBOSE,"Ctts: nb: %u (%x) val:%u (%x)\n",count[i],count[i],values[i],values[i]);   
                     }
-                    for(k=0;k<j;k++)
+                    for(k=0;k<count[i];k++)
                     {
-                        info.Ctts[info.nbCtts++]=v;
+                        info.Ctts[info.nbCtts++]=values[i];
                     }
                 }
+                delete [] values;
+                delete [] count;
                 if(!info.nbCtts)
                 {
                     delete [] info.Ctts;
                     info.Ctts=NULL;
                     printf("Destroying Ctts, seems invalid\n");
                 }
-                ADM_assert(info.nbCtts<n*4);
+                ADM_assert(info.nbCtts<sum+1);
                 printf("Found %u elements\n",info.nbCtts);
             }
             break;  



From gruntster at mail.berlios.de  Mon Jul 16 21:14:56 2007
From: gruntster at mail.berlios.de (gruntster at mail.berlios.de)
Date: Mon, 16 Jul 2007 21:14:56 +0200
Subject: [Avidemux-svn-commit] r3397 -
	branches/avidemux_2.4_branch/avidemux/ADM_codecs
Message-ID: <200707161914.l6GJEuaW014802@sheep.berlios.de>

Author: gruntster
Date: 2007-07-16 21:14:46 +0200 (Mon, 16 Jul 2007)
New Revision: 3397

Modified:
   branches/avidemux_2.4_branch/avidemux/ADM_codecs/ADM_ffmpeg.cpp
Log:
[LAV] MinGW tweak

Modified: branches/avidemux_2.4_branch/avidemux/ADM_codecs/ADM_ffmpeg.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_codecs/ADM_ffmpeg.cpp	2007-07-16 18:46:18 UTC (rev 3396)
+++ branches/avidemux_2.4_branch/avidemux/ADM_codecs/ADM_ffmpeg.cpp	2007-07-16 19:14:46 UTC (rev 3397)
@@ -20,10 +20,10 @@
  *                                                                         *
  ***************************************************************************/
 #include "config.h"
+#define __STDC_CONSTANT_MACROS // Lavcodec crap
+#include <stdint.h>
 #include <stdio.h>
 #include <stdlib.h>
-#define __STDC_CONSTANT_MACROS // Lavcodec crap
-#include <stdint.h>
 
 #include <string.h>
 #include <math.h>



From mean at mail.berlios.de  Mon Jul 16 22:27:50 2007
From: mean at mail.berlios.de (mean at BerliOS)
Date: Mon, 16 Jul 2007 22:27:50 +0200
Subject: [Avidemux-svn-commit] r3398 -
	branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec
Message-ID: <200707162027.l6GKRoKh018748@sheep.berlios.de>

Author: mean
Date: 2007-07-16 22:27:49 +0200 (Mon, 16 Jul 2007)
New Revision: 3398

Modified:
   branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec/CMakeLists.txt
   branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec/ffconf.c
   branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec/ffconf.h
Log:
[LAV]re-add WMA & DV

Modified: branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec/CMakeLists.txt
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec/CMakeLists.txt	2007-07-16 19:14:46 UTC (rev 3397)
+++ branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec/CMakeLists.txt	2007-07-16 20:27:49 UTC (rev 3398)
@@ -27,7 +27,9 @@
                 mpeg12enc.c mpegaudioenc.c
                 ac3enc.c ac3.c ac3tab.c
                 mjpegenc.c mjpegdec.c
+                wma.c
 
+
 )
 # ADD x86 ones
 

Modified: branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec/ffconf.c
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec/ffconf.c	2007-07-16 19:14:46 UTC (rev 3397)
+++ branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec/ffconf.c	2007-07-16 20:27:49 UTC (rev 3398)
@@ -31,6 +31,8 @@
     DECLARE_DECODER (MSMPEG4V3, msmpeg4v3);
     DECLARE_DECODER(MJPEGB, mjpegb);
     DECLARE_DECODER (MJPEG, mjpeg);
+    DECLARE_DECODER(WMAV2, wmav2);
+    DECLARE_DECODER (DVVIDEO, dvvideo);
 
 #undef DECLARE_DECODER
 #define DECLARE_DECODER(a,b); printf("#define ENABLE_"#a"_DECODER 0\n"); 
@@ -111,7 +113,6 @@
     DECLARE_DECODER (ASV1, asv1);
     DECLARE_DECODER (ASV2, asv2);
     DECLARE_DECODER (BMP, bmp);
-    DECLARE_DECODER (DVVIDEO, dvvideo);
     DECLARE_DECODER (FFV1, ffv1);
     DECLARE_DECODER (FFVHUFF, ffvhuff);
     DECLARE_DECODER (FLASHSV, flashsv);
@@ -147,7 +148,6 @@
     DECLARE_DECODER (SONIC, sonic);
     DECLARE_DECODER (VORBIS, vorbis);
     DECLARE_DECODER(WMAV1, wmav1);
-    DECLARE_DECODER(WMAV2, wmav2);
     DECLARE_DECODER (PCM_ALAW, pcm_alaw);
     DECLARE_DECODER (PCM_MULAW, pcm_mulaw);
     DECLARE_DECODER (PCM_S8, pcm_s8);
@@ -220,6 +220,7 @@
     DECLARE_ENCODER (MPEG4, mpeg4);
     DECLARE_ENCODER (SNOW, snow);
     DECLARE_ENCODER (MP2, mp2);
+    DECLARE_ENCODER (DVVIDEO, dvvideo);
 
 #undef DECLARE_ENCODER
 #define DECLARE_ENCODER(a,b); printf("#define ENABLE_"#a"_ENCODER 0\n"); 
@@ -240,7 +241,6 @@
  DECLARE_ENCODER (ASV1, asv1);
     DECLARE_ENCODER (ASV2, asv2);
     DECLARE_ENCODER (BMP, bmp);
-    DECLARE_ENCODER (DVVIDEO, dvvideo);
     DECLARE_ENCODER (FLASHSV, flashsv);
     DECLARE_ENCODER (FLV, flv);
     DECLARE_ENCODER (GIF, gif);

Modified: branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec/ffconf.h
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec/ffconf.h	2007-07-16 19:14:46 UTC (rev 3397)
+++ branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec/ffconf.h	2007-07-16 20:27:49 UTC (rev 3398)
@@ -22,6 +22,8 @@
 #define ENABLE_MSMPEG4V3_DECODER 1
 #define ENABLE_MJPEGB_DECODER 1
 #define ENABLE_MJPEG_DECODER 1
+#define ENABLE_WMAV2_DECODER 1
+#define ENABLE_DVVIDEO_DECODER 1
 #define ENABLE_AASC_DECODER 0
 #define ENABLE_AVS_DECODER 0
 #define ENABLE_BETHSOFTVID_DECODER 0
@@ -97,7 +99,6 @@
 #define ENABLE_ASV1_DECODER 0
 #define ENABLE_ASV2_DECODER 0
 #define ENABLE_BMP_DECODER 0
-#define ENABLE_DVVIDEO_DECODER 0
 #define ENABLE_FFV1_DECODER 0
 #define ENABLE_FFVHUFF_DECODER 0
 #define ENABLE_FLASHSV_DECODER 0
@@ -133,7 +134,6 @@
 #define ENABLE_SONIC_DECODER 0
 #define ENABLE_VORBIS_DECODER 0
 #define ENABLE_WMAV1_DECODER 0
-#define ENABLE_WMAV2_DECODER 0
 #define ENABLE_PCM_ALAW_DECODER 0
 #define ENABLE_PCM_MULAW_DECODER 0
 #define ENABLE_PCM_S8_DECODER 0
@@ -199,6 +199,7 @@
 #define ENABLE_MPEG4_ENCODER 1
 #define ENABLE_SNOW_ENCODER 1
 #define ENABLE_MP2_ENCODER 1
+#define ENABLE_DVVIDEO_ENCODER 1
 #define ENABLE_LIBX264_ENCODER 0
 #define ENABLE_LIBXVID_ENCODER 0
 #define ENABLE_LJPEG_ENCODER 0
@@ -214,7 +215,6 @@
 #define ENABLE_ASV1_ENCODER 0
 #define ENABLE_ASV2_ENCODER 0
 #define ENABLE_BMP_ENCODER 0
-#define ENABLE_DVVIDEO_ENCODER 0
 #define ENABLE_FLASHSV_ENCODER 0
 #define ENABLE_FLV_ENCODER 0
 #define ENABLE_GIF_ENCODER 0



From gruntster at mail.berlios.de  Mon Jul 16 23:09:45 2007
From: gruntster at mail.berlios.de (gruntster at mail.berlios.de)
Date: Mon, 16 Jul 2007 23:09:45 +0200
Subject: [Avidemux-svn-commit] r3399 -
	branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec
Message-ID: <200707162109.l6GL9j7S021347@sheep.berlios.de>

Author: gruntster
Date: 2007-07-16 23:09:05 +0200 (Mon, 16 Jul 2007)
New Revision: 3399

Added:
   branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec/wma.c
Log:
[LAV] missing file

Added: branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec/wma.c
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec/wma.c	2007-07-16 20:27:49 UTC (rev 3398)
+++ branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec/wma.c	2007-07-16 21:09:05 UTC (rev 3399)
@@ -0,0 +1,391 @@
+/*
+ * WMA compatible codec
+ * Copyright (c) 2002-2007 The FFmpeg Project.
+ *
+ * This file is part of FFmpeg.
+ *
+ * FFmpeg is free software; you can redistribute it and/or
+ * modify it under the terms of the GNU Lesser General Public
+ * License as published by the Free Software Foundation; either
+ * version 2.1 of the License, or (at your option) any later version.
+ *
+ * FFmpeg is distributed in the hope that it will be useful,
+ * but WITHOUT ANY WARRANTY; without even the implied warranty of
+ * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ * Lesser General Public License for more details.
+ *
+ * You should have received a copy of the GNU Lesser General Public
+ * License along with FFmpeg; if not, write to the Free Software
+ * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA
+ */
+
+#include "avcodec.h"
+#include "wma.h"
+#include "wmadata.h"
+
+#undef NDEBUG
+#include <assert.h>
+
+/* XXX: use same run/length optimization as mpeg decoders */
+//FIXME maybe split decode / encode or pass flag
+static void init_coef_vlc(VLC *vlc,
+                          uint16_t **prun_table, uint16_t **plevel_table, uint16_t **pint_table,
+                          const CoefVLCTable *vlc_table)
+{
+    int n = vlc_table->n;
+    const uint8_t *table_bits = vlc_table->huffbits;
+    const uint32_t *table_codes = vlc_table->huffcodes;
+    const uint16_t *levels_table = vlc_table->levels;
+    uint16_t *run_table, *level_table, *int_table;
+    int i, l, j, k, level;
+
+    init_vlc(vlc, VLCBITS, n, table_bits, 1, 1, table_codes, 4, 4, 0);
+
+    run_table = av_malloc(n * sizeof(uint16_t));
+    level_table = av_malloc(n * sizeof(uint16_t));
+    int_table = av_malloc(n * sizeof(uint16_t));
+    i = 2;
+    level = 1;
+    k = 0;
+    while (i < n) {
+        int_table[k]= i;
+        l = levels_table[k++];
+        for(j=0;j<l;j++) {
+            run_table[i] = j;
+            level_table[i] = level;
+            i++;
+        }
+        level++;
+    }
+    *prun_table = run_table;
+    *plevel_table = level_table;
+    *pint_table= int_table;
+}
+
+int ff_wma_init(AVCodecContext * avctx, int flags2)
+{
+    WMACodecContext *s = avctx->priv_data;
+    int i;
+    float *window;
+    float bps1, high_freq;
+    volatile float bps;
+    int sample_rate1;
+    int coef_vlc_table;
+
+    if(   avctx->sample_rate<=0 || avctx->sample_rate>50000
+       || avctx->channels<=0 || avctx->channels>8
+       || avctx->bit_rate<=0)
+        return -1;
+
+    s->sample_rate = avctx->sample_rate;
+    s->nb_channels = avctx->channels;
+    s->bit_rate = avctx->bit_rate;
+    s->block_align = avctx->block_align;
+
+    dsputil_init(&s->dsp, avctx);
+
+    if (avctx->codec->id == CODEC_ID_WMAV1) {
+        s->version = 1;
+    } else {
+        s->version = 2;
+    }
+
+    /* compute MDCT block size */
+    if (s->sample_rate <= 16000) {
+        s->frame_len_bits = 9;
+    } else if (s->sample_rate <= 22050 ||
+               (s->sample_rate <= 32000 && s->version == 1)) {
+        s->frame_len_bits = 10;
+    } else {
+        s->frame_len_bits = 11;
+    }
+    s->frame_len = 1 << s->frame_len_bits;
+    if (s->use_variable_block_len) {
+        int nb_max, nb;
+        nb = ((flags2 >> 3) & 3) + 1;
+        if ((s->bit_rate / s->nb_channels) >= 32000)
+            nb += 2;
+        nb_max = s->frame_len_bits - BLOCK_MIN_BITS;
+        if (nb > nb_max)
+            nb = nb_max;
+        s->nb_block_sizes = nb + 1;
+    } else {
+        s->nb_block_sizes = 1;
+    }
+
+    /* init rate dependent parameters */
+    s->use_noise_coding = 1;
+    high_freq = s->sample_rate * 0.5;
+
+    /* if version 2, then the rates are normalized */
+    sample_rate1 = s->sample_rate;
+    if (s->version == 2) {
+        if (sample_rate1 >= 44100)
+            sample_rate1 = 44100;
+        else if (sample_rate1 >= 22050)
+            sample_rate1 = 22050;
+        else if (sample_rate1 >= 16000)
+            sample_rate1 = 16000;
+        else if (sample_rate1 >= 11025)
+            sample_rate1 = 11025;
+        else if (sample_rate1 >= 8000)
+            sample_rate1 = 8000;
+    }
+
+    bps = (float)s->bit_rate / (float)(s->nb_channels * s->sample_rate);
+    s->byte_offset_bits = av_log2((int)(bps * s->frame_len / 8.0 + 0.5)) + 2;
+
+    /* compute high frequency value and choose if noise coding should
+       be activated */
+    bps1 = bps;
+    if (s->nb_channels == 2)
+        bps1 = bps * 1.6;
+    if (sample_rate1 == 44100) {
+        if (bps1 >= 0.61)
+            s->use_noise_coding = 0;
+        else
+            high_freq = high_freq * 0.4;
+    } else if (sample_rate1 == 22050) {
+        if (bps1 >= 1.16)
+            s->use_noise_coding = 0;
+        else if (bps1 >= 0.72)
+            high_freq = high_freq * 0.7;
+        else
+            high_freq = high_freq * 0.6;
+    } else if (sample_rate1 == 16000) {
+        if (bps > 0.5)
+            high_freq = high_freq * 0.5;
+        else
+            high_freq = high_freq * 0.3;
+    } else if (sample_rate1 == 11025) {
+        high_freq = high_freq * 0.7;
+    } else if (sample_rate1 == 8000) {
+        if (bps <= 0.625) {
+            high_freq = high_freq * 0.5;
+        } else if (bps > 0.75) {
+            s->use_noise_coding = 0;
+        } else {
+            high_freq = high_freq * 0.65;
+        }
+    } else {
+        if (bps >= 0.8) {
+            high_freq = high_freq * 0.75;
+        } else if (bps >= 0.6) {
+            high_freq = high_freq * 0.6;
+        } else {
+            high_freq = high_freq * 0.5;
+        }
+    }
+    dprintf(s->avctx, "flags2=0x%x\n", flags2);
+    dprintf(s->avctx, "version=%d channels=%d sample_rate=%d bitrate=%d block_align=%d\n",
+           s->version, s->nb_channels, s->sample_rate, s->bit_rate,
+           s->block_align);
+    dprintf(s->avctx, "bps=%f bps1=%f high_freq=%f bitoffset=%d\n",
+           bps, bps1, high_freq, s->byte_offset_bits);
+    dprintf(s->avctx, "use_noise_coding=%d use_exp_vlc=%d nb_block_sizes=%d\n",
+           s->use_noise_coding, s->use_exp_vlc, s->nb_block_sizes);
+
+    /* compute the scale factor band sizes for each MDCT block size */
+    {
+        int a, b, pos, lpos, k, block_len, i, j, n;
+        const uint8_t *table;
+
+        if (s->version == 1) {
+            s->coefs_start = 3;
+        } else {
+            s->coefs_start = 0;
+        }
+        for(k = 0; k < s->nb_block_sizes; k++) {
+            block_len = s->frame_len >> k;
+
+            if (s->version == 1) {
+                lpos = 0;
+                for(i=0;i<25;i++) {
+                    a = wma_critical_freqs[i];
+                    b = s->sample_rate;
+                    pos = ((block_len * 2 * a)  + (b >> 1)) / b;
+                    if (pos > block_len)
+                        pos = block_len;
+                    s->exponent_bands[0][i] = pos - lpos;
+                    if (pos >= block_len) {
+                        i++;
+                        break;
+                    }
+                    lpos = pos;
+                }
+                s->exponent_sizes[0] = i;
+            } else {
+                /* hardcoded tables */
+                table = NULL;
+                a = s->frame_len_bits - BLOCK_MIN_BITS - k;
+                if (a < 3) {
+                    if (s->sample_rate >= 44100)
+                        table = exponent_band_44100[a];
+                    else if (s->sample_rate >= 32000)
+                        table = exponent_band_32000[a];
+                    else if (s->sample_rate >= 22050)
+                        table = exponent_band_22050[a];
+                }
+                if (table) {
+                    n = *table++;
+                    for(i=0;i<n;i++)
+                        s->exponent_bands[k][i] = table[i];
+                    s->exponent_sizes[k] = n;
+                } else {
+                    j = 0;
+                    lpos = 0;
+                    for(i=0;i<25;i++) {
+                        a = wma_critical_freqs[i];
+                        b = s->sample_rate;
+                        pos = ((block_len * 2 * a)  + (b << 1)) / (4 * b);
+                        pos <<= 2;
+                        if (pos > block_len)
+                            pos = block_len;
+                        if (pos > lpos)
+                            s->exponent_bands[k][j++] = pos - lpos;
+                        if (pos >= block_len)
+                            break;
+                        lpos = pos;
+                    }
+                    s->exponent_sizes[k] = j;
+                }
+            }
+
+            /* max number of coefs */
+            s->coefs_end[k] = (s->frame_len - ((s->frame_len * 9) / 100)) >> k;
+            /* high freq computation */
+            s->high_band_start[k] = (int)((block_len * 2 * high_freq) /
+                                          s->sample_rate + 0.5);
+            n = s->exponent_sizes[k];
+            j = 0;
+            pos = 0;
+            for(i=0;i<n;i++) {
+                int start, end;
+                start = pos;
+                pos += s->exponent_bands[k][i];
+                end = pos;
+                if (start < s->high_band_start[k])
+                    start = s->high_band_start[k];
+                if (end > s->coefs_end[k])
+                    end = s->coefs_end[k];
+                if (end > start)
+                    s->exponent_high_bands[k][j++] = end - start;
+            }
+            s->exponent_high_sizes[k] = j;
+#if 0
+            tprintf(s->avctx, "%5d: coefs_end=%d high_band_start=%d nb_high_bands=%d: ",
+                  s->frame_len >> k,
+                  s->coefs_end[k],
+                  s->high_band_start[k],
+                  s->exponent_high_sizes[k]);
+            for(j=0;j<s->exponent_high_sizes[k];j++)
+                tprintf(s->avctx, " %d", s->exponent_high_bands[k][j]);
+            tprintf(s->avctx, "\n");
+#endif
+        }
+    }
+
+#ifdef TRACE
+    {
+        int i, j;
+        for(i = 0; i < s->nb_block_sizes; i++) {
+            tprintf(s->avctx, "%5d: n=%2d:",
+                   s->frame_len >> i,
+                   s->exponent_sizes[i]);
+            for(j=0;j<s->exponent_sizes[i];j++)
+                tprintf(s->avctx, " %d", s->exponent_bands[i][j]);
+            tprintf(s->avctx, "\n");
+        }
+    }
+#endif
+
+    /* init MDCT windows : simple sinus window */
+    for(i = 0; i < s->nb_block_sizes; i++) {
+        int n, j;
+        float alpha;
+        n = 1 << (s->frame_len_bits - i);
+        window = av_malloc(sizeof(float) * n);
+        alpha = M_PI / (2.0 * n);
+        for(j=0;j<n;j++) {
+            window[j] = sin((j + 0.5) * alpha);
+        }
+        s->windows[i] = window;
+    }
+
+    s->reset_block_lengths = 1;
+
+    if (s->use_noise_coding) {
+
+        /* init the noise generator */
+        if (s->use_exp_vlc)
+            s->noise_mult = 0.02;
+        else
+            s->noise_mult = 0.04;
+
+#ifdef TRACE
+        for(i=0;i<NOISE_TAB_SIZE;i++)
+            s->noise_table[i] = 1.0 * s->noise_mult;
+#else
+        {
+            unsigned int seed;
+            float norm;
+            seed = 1;
+            norm = (1.0 / (float)(1LL << 31)) * sqrt(3) * s->noise_mult;
+            for(i=0;i<NOISE_TAB_SIZE;i++) {
+                seed = seed * 314159 + 1;
+                s->noise_table[i] = (float)((int)seed) * norm;
+            }
+        }
+#endif
+    }
+
+    /* choose the VLC tables for the coefficients */
+    coef_vlc_table = 2;
+    if (s->sample_rate >= 32000) {
+        if (bps1 < 0.72)
+            coef_vlc_table = 0;
+        else if (bps1 < 1.16)
+            coef_vlc_table = 1;
+    }
+    s->coef_vlcs[0]= &coef_vlcs[coef_vlc_table * 2    ];
+    s->coef_vlcs[1]= &coef_vlcs[coef_vlc_table * 2 + 1];
+    init_coef_vlc(&s->coef_vlc[0], &s->run_table[0], &s->level_table[0], &s->int_table[0],
+                  s->coef_vlcs[0]);
+    init_coef_vlc(&s->coef_vlc[1], &s->run_table[1], &s->level_table[1], &s->int_table[1],
+                  s->coef_vlcs[1]);
+
+    return 0;
+}
+
+int ff_wma_total_gain_to_bits(int total_gain){
+         if (total_gain < 15) return 13;
+    else if (total_gain < 32) return 12;
+    else if (total_gain < 40) return 11;
+    else if (total_gain < 45) return 10;
+    else                      return  9;
+}
+
+int ff_wma_end(AVCodecContext *avctx)
+{
+    WMACodecContext *s = avctx->priv_data;
+    int i;
+
+    for(i = 0; i < s->nb_block_sizes; i++)
+        ff_mdct_end(&s->mdct_ctx[i]);
+    for(i = 0; i < s->nb_block_sizes; i++)
+        av_free(s->windows[i]);
+
+    if (s->use_exp_vlc) {
+        free_vlc(&s->exp_vlc);
+    }
+    if (s->use_noise_coding) {
+        free_vlc(&s->hgain_vlc);
+    }
+    for(i = 0;i < 2; i++) {
+        free_vlc(&s->coef_vlc[i]);
+        av_free(s->run_table[i]);
+        av_free(s->level_table[i]);
+    }
+
+    return 0;
+}



From gruntster at mail.berlios.de  Mon Jul 16 23:44:30 2007
From: gruntster at mail.berlios.de (gruntster at mail.berlios.de)
Date: Mon, 16 Jul 2007 23:44:30 +0200
Subject: [Avidemux-svn-commit] r3400 - in
	branches/avidemux_2.4_branch/avidemux/ADM_libraries:
	ADM_lavcodec ADM_lavutil
Message-ID: <200707162144.l6GLiUxI023345@sheep.berlios.de>

Author: gruntster
Date: 2007-07-16 23:44:22 +0200 (Mon, 16 Jul 2007)
New Revision: 3400

Modified:
   branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec/dsputil.c
   branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec/mpegvideo_enc.c
   branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavutil/internal.h
Log:
[LAV] align stack variables when using GCC > 4.1

Modified: branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec/dsputil.c
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec/dsputil.c	2007-07-16 21:09:05 UTC (rev 3399)
+++ branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec/dsputil.c	2007-07-16 21:44:22 UTC (rev 3400)
@@ -3838,7 +3838,7 @@
     return 0;
 }
 
-void dsputil_init(DSPContext* c, AVCodecContext *avctx)
+void attribute_align_arg dsputil_init(DSPContext* c, AVCodecContext *avctx)
 {
     int i;
 

Modified: branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec/mpegvideo_enc.c
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec/mpegvideo_enc.c	2007-07-16 21:09:05 UTC (rev 3399)
+++ branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec/mpegvideo_enc.c	2007-07-16 21:44:22 UTC (rev 3400)
@@ -1899,7 +1899,7 @@
                +sse(s, s->new_picture.data[2] + s->mb_x*8  + s->mb_y*s->uvlinesize*8,s->dest[2], w>>1, h>>1, s->uvlinesize);
 }
 
-static int pre_estimate_motion_thread(AVCodecContext *c, void *arg){
+static int attribute_align_arg pre_estimate_motion_thread(AVCodecContext *c, void *arg){
     MpegEncContext *s= arg;
 
 
@@ -1945,7 +1945,7 @@
     return 0;
 }
 
-static int mb_var_thread(AVCodecContext *c, void *arg){
+static int attribute_align_arg mb_var_thread(AVCodecContext *c, void *arg){
     MpegEncContext *s= arg;
     int mb_x, mb_y;
 
@@ -1987,7 +1987,7 @@
         s->misc_bits+= get_bits_diff(s);
 }
 
-static int encode_thread(AVCodecContext *c, void *arg){
+static int attribute_align_arg encode_thread(AVCodecContext *c, void *arg){
     MpegEncContext *s= arg;
     int mb_x, mb_y, pdif = 0;
     int i, j;

Modified: branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavutil/internal.h
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavutil/internal.h	2007-07-16 21:09:05 UTC (rev 3399)
+++ branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavutil/internal.h	2007-07-16 21:44:22 UTC (rev 3400)
@@ -34,6 +34,14 @@
 #include <stddef.h>
 #include <assert.h>
 
+#ifndef attribute_align_arg
+#if defined(__GNUC__) && (__GNUC__ > 4 || __GNUC__ == 4 && __GNUC_MINOR__ > 1)
+#    define attribute_align_arg __attribute__((force_align_arg_pointer))
+#else
+#    define attribute_align_arg
+#endif
+#endif
+
 #ifndef attribute_used
 #if defined(__GNUC__) && (__GNUC__ > 3 || __GNUC__ == 3 && __GNUC_MINOR__ > 0)
 #    define attribute_used __attribute__((used))



From gruntster at mail.berlios.de  Tue Jul 17 04:24:52 2007
From: gruntster at mail.berlios.de (gruntster at mail.berlios.de)
Date: Tue, 17 Jul 2007 04:24:52 +0200
Subject: [Avidemux-svn-commit] r3401 - in
	branches/avidemux_2.4_branch/avidemux: . ADM_audiodevice
Message-ID: <200707170224.l6H2OqbF024593@sheep.berlios.de>

Author: gruntster
Date: 2007-07-17 04:24:45 +0200 (Tue, 17 Jul 2007)
New Revision: 3401

Modified:
   branches/avidemux_2.4_branch/avidemux/ADM_audiodevice/ADM_deviceWin32.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_audiodevice/ADM_deviceWin32.h
   branches/avidemux_2.4_branch/avidemux/guiplay.cpp
Log:
re-engineer Win32 audio device to fix memory leak (large leak every time audio was played)

Modified: branches/avidemux_2.4_branch/avidemux/ADM_audiodevice/ADM_deviceWin32.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_audiodevice/ADM_deviceWin32.cpp	2007-07-16 21:44:22 UTC (rev 3400)
+++ branches/avidemux_2.4_branch/avidemux/ADM_audiodevice/ADM_deviceWin32.cpp	2007-07-17 02:24:45 UTC (rev 3401)
@@ -2,283 +2,180 @@
 // C++ Implementation: ADM_deviceWin32
 //
 // Description: 
-//
-//
-// Author: mean <fixounet at free.fr>, (C) 2004
-//
-// Copyright: See COPYING file that comes with this distribution
-//
-//
-//
 // C++ Implementation: ADM_deviceWin32
 // Use MM layer to output sound
 //
-// Description: 
-//
-//
 // Author: mean <fixounet at free.fr>, (C) 2004
 //
 // Copyright: See COPYING file that comes with this distribution
 //
-//
 
 #include "config.h"
-#ifdef ADM_WIN32
 
+#ifdef ADM_WIN32
 #include <stdio.h>
 #include <stdlib.h>
-#include <string.h>
-
 #include <errno.h>
+#include <windows.h>
 
-
-
-  
 #include "fourcc.h" 
- 
-
-#include "windows.h"
-#include "winbase.h"
-
-
-#include "ADM_toolkit/toolkit.hxx"
-#include <ADM_assert.h>
+#include "ADM_assert.h"
 #include "ADM_audiodevice.h"
 #include "ADM_audiodevice/ADM_deviceWin32.h"
-#include "ADM_osSupport/ADM_debugID.h"
+
 #define MODULE_NAME  MODULE_ADEVICE
+#include "ADM_osSupport/ADM_debugID.h"
 #include "ADM_osSupport/ADM_debug.h"
 
-#define BUCKET_SIZE 25000*4   // 1 sec
-#define NB_BUCKET 30
+#define BUCKET_SIZE 16384
+#define NB_BUCKET 8
 
-typedef struct audioBucket
-{
-    int         fre;
-    WAVEHDR     hdr;
-}audioBucket;
-static void CALLBACK waveOutProc(
-  HWAVEOUT hwo,      
-  UINT uMsg,         
-  DWORD_PTR dwInstance,  
-  DWORD dwParam1,    
-  DWORD dwParam2     
-);
-static HWAVEOUT  myDevice;
-static MMRESULT    myError;
-static void 	handleMM(MMRESULT  err);
-static int      first=0;
+static HWAVEOUT myDevice;
+static MMRESULT myError;
 
-audioBucket buckets[NB_BUCKET];	
-//_______________________________________________
-//
-//_______________________________________________
+static void handleMM(MMRESULT err);
 
+WAVEHDR waveHdr[NB_BUCKET];	
 
-//_______________________________________________
-//
-//_______________________________________________
-
 win32AudioDevice::win32AudioDevice(void) 
 {
-	printf("Creating SDL Audio device\n");
+	printf("[Win32] Creating audio device\n");
 	_inUse=0;
-	first=0;
-	memset(buckets,0,sizeof(buckets));
-	
 }
-//_______________________________________________
-//
-//_______________________________________________
-uint8_t  win32AudioDevice::stop(void) 
+
+uint8_t win32AudioDevice::stop(void) 
 {
-    if(!_inUse) return 0;  	
-	printf("Closing win32 audio\n");
-	 waveOutPause(  myDevice);
-	 myError=waveOutClose(myDevice);
-	 first=0;
-	 if(MMSYSERR_NOERROR!= myError)
-	 {
-	 	printf("Close failed\n");
-	 	handleMM(myError);
+	if (!_inUse)
 		return 0;
-	 }
-	
-	_inUse=0;    	
-	for(uint32_t i=0;i<NB_BUCKET;i++)
+
+	printf("[Win32] Closing audio\n");
+
+	waveOutReset(myDevice);		
+
+	for (uint32_t i = 0; i < NB_BUCKET; i++)
+		waveOutUnprepareHeader(myDevice, &waveHdr[i], sizeof(WAVEHDR));
+
+	myError = waveOutClose(myDevice);
+
+	if (myError != MMSYSERR_NOERROR)
 	{
-		 delete []    buckets[i].hdr.lpData;
+		printf("[Win32] Close failed %d\n", myError);
+		handleMM(myError);
+		return 0;
 	}
+
+	for (uint32_t i = 0; i < NB_BUCKET; i++)
+		delete[] waveHdr[i].lpData;
+
+	_inUse=0;
+	myDevice = NULL;
+
 	return 1;
 }
 
-//_______________________________________________
-//
-//
-//_______________________________________________
 uint8_t win32AudioDevice::init(uint8_t channels, uint32_t fq) 
 {
-WAVEFORMATEX wav;
-		
+	printf("[Win32] Opening Audio, fq=%d\n",fq);
+
+	if (_inUse) 
+	{
+		printf("[Win32] Already running?\n");
+		return 0;
+	}
+
+	_inUse = 1;
 	_channels = channels;
 
-		printf("Opening Win32 Audio, fq=%d\n",fq);
+	WAVEFORMATEX wav;
 
-		if(_inUse) 
-		{
-			printf("Already running ?\n");
-			return 1; // ???
-		}
-		first=0;
-/*
-	WORD wFormatTag;
-	WORD nChannels;
-	DWORD nSamplesPerSec;
-	DWORD nAvgBytesPerSec;
-	WORD nBlockAlign;
-	WORD wBitsPerSample;
-	WORD cbSize;
-*/		
-		memset(&wav,0,sizeof(wav));
-		
-		wav.wFormatTag=WAVE_FORMAT_PCM;
-		wav.nSamplesPerSec=fq;
-		wav.nChannels=channels;
-		wav.nBlockAlign=2*channels;
-		wav.nAvgBytesPerSec=2*channels*fq;		
-		wav.wBitsPerSample=16;
-		
-		myError=waveOutOpen(&myDevice,WAVE_MAPPER,
-  
-  				&wav,	//L pwfx,      
-  				(DWORD_PTR)waveOutProc , //0, //DWORD_PTR      dwCallback,
-  				0,	//DWORD_PTR      dwCallbackInstance,
-  				CALLBACK_FUNCTION //CALLBACK_NULL //WAVE_MAPPED //DWORD          fdwOpen    
-			);
-		if(MMSYSERR_NOERROR!=myError )
-			{
-				printf("WavoutOpen failed\n");
-			 	handleMM(myError);
-				return 0;
-			}
-    WAVEHDR *hdr;
-			
-	for(uint32_t i=0;i<NB_BUCKET;i++)
+	memset(&wav, 0, sizeof(WAVEFORMATEX));
+
+	wav.wFormatTag = WAVE_FORMAT_PCM;
+	wav.nSamplesPerSec = fq;
+	wav.nChannels = channels;
+	wav.nBlockAlign = 2 * channels;
+	wav.nAvgBytesPerSec = 2 * channels * fq;
+	wav.wBitsPerSample = 16;
+
+	myError = waveOutOpen(&myDevice, WAVE_MAPPER, &wav, NULL, NULL, CALLBACK_NULL);
+
+	if (MMSYSERR_NOERROR != myError)
 	{
-		 buckets[i].fre=1;
-		 hdr=&(buckets[i].hdr);
-		 waveOutPrepareHeader(myDevice,hdr,sizeof(*hdr));	
-         hdr->lpData=(CHAR *)new uint8_t [BUCKET_SIZE];
-         hdr->dwBufferLength=0;
+		printf("[Win32] waveOutOpen failed\n");
+		handleMM(myError);
+		return 0;
 	}
 
-	
-    return 1;
+	for (uint32_t i = 0; i < NB_BUCKET; i++)
+	{
+		memset(&waveHdr[i], 0, sizeof(WAVEHDR));
+
+		waveHdr[i].lpData = (char*)new uint8_t[BUCKET_SIZE];
+
+		if (waveOutPrepareHeader(myDevice, &waveHdr[i], sizeof(WAVEHDR)) != MMSYSERR_NOERROR)
+			printf("[Win32] waveOutPrepareHeader error\n");
+
+		if (waveOutWrite(myDevice, &waveHdr[i], sizeof(WAVEHDR)) != MMSYSERR_NOERROR)
+			printf("[Win32] waveOutWrite error\n");
+	}
+
+	return 1;
 }
 
 uint8_t  win32AudioDevice::setVolume(int volume) 
 {
-    DWORD value;
+	uint32_t value;
 
-    value = (0xffff * volume) / 100;
-    value = value + (value << 16);
+	value = (0xffff * volume) / 100;
+	value = value + (value << 16);
 
-    waveOutSetVolume(myDevice, value);
+	waveOutSetVolume(myDevice, value);
 
 	return 1;
 }
-//_______________________________________________
-//
-//
-//_______________________________________________
-uint8_t win32AudioDevice::play(uint32_t len, float *data)
- {
- uint32_t av=0;
-	WAVEHDR *hdr;
 
-	dither16(data, len, _channels);
-	len = len * 2;
-   ADM_assert(len<BUCKET_SIZE);
-   // First do clean up
-#if 0   
-      for(uint32_t i=0;i<NB_BUCKET;i++)
-      {
-            if(!buckets[i].fre)
-            {
-                        if(buckets[i].hdr.dwFlags & WHDR_DONE)
-                        {
-                                                buckets[i].fre=1;
-                                                buckets[i].hdr.dwFlags=0; 
-                                                printf("Freeing buffer %d  \n",i);   
-                                                av++;                                            
-                        }            
-            }
-            else
-                        av++;
-      }
-      printf("Free buffer:%d %d\n",av,NB_BUCKET);
-#endif      
-      // look up a free buffer
-      
-   for(uint32_t i=0;i<NB_BUCKET;i++)
-   {
-      if(buckets[i].fre)
-      {
-            memcpy(buckets[i].hdr.lpData,data,len);
-            buckets[i].hdr.dwBufferLength=len;
-            buckets[i].fre=0;
-            hdr=&(buckets[i].hdr);
-            myError=waveOutWrite(
-  					myDevice, //HWAVEOUT hwo,  
-  					hdr, //LPWAVEHDR pwh, 
-  					sizeof(*hdr) //UINT cbwh      
-			  					);
-			if( MMSYSERR_NOERROR!=myError)
-			{
-			    handleMM(myError);
-			    return 0;
-			}
-			return 1;
-      }
-      
-   
-   }
-    printf("All buckets full !\n");
-	return 0;
-}
-void CALLBACK waveOutProc(
-  HWAVEOUT hwo,      
-  UINT uMsg,         
-  DWORD_PTR dwInstance,  
-  DWORD dwParam1,    
-  DWORD dwParam2     
-)
+uint8_t win32AudioDevice::play(uint32_t len, float *data)
 {
-    if(uMsg==WOM_DONE)
-    {
+	dither16(data, len, _channels);
+	len *= 2;
+	uint8_t success = 0;
 
-        audioBucket *bucket;
-                        bucket=(audioBucket *)(dwParam1-sizeof(int));
-                        bucket->fre=1;
-    }
+	for (uint32_t i = 0; i < NB_BUCKET; i++)
+	{
+		if (waveHdr[i].dwFlags & WHDR_DONE)
+		{
+			waveHdr[i].dwFlags &= ~WHDR_DONE;
 
+			if (len > BUCKET_SIZE)
+				waveHdr[i].dwBufferLength = BUCKET_SIZE;
+			else
+				waveHdr[i].dwBufferLength = len;
+
+			memcpy(waveHdr[i].lpData, data, waveHdr[i].dwBufferLength);
+			data += waveHdr[i].dwBufferLength;
+			len -= waveHdr[i].dwBufferLength;
+
+			if (waveOutWrite(myDevice, &waveHdr[i], sizeof(WAVEHDR)) == MMSYSERR_NOERROR)
+				success = 1;
+			else
+				break;
+		}
+
+		if (len == 0)
+			break;
+	}
+
+	return success;
 }
-void 	handleMM(MMRESULT  err)
+
+void handleMM(MMRESULT err)
 {
- #define ERMM(x) if(err==x) printf(#x"\n");
-    ERMM(MMSYSERR_ALLOCATED);
-    ERMM(MMSYSERR_BADDEVICEID);
-    ERMM(MMSYSERR_NODRIVER);
-    ERMM(WAVERR_BADFORMAT);
-    ERMM(WAVERR_SYNC);
-    
+#define ERMM(x) if(err==x) printf("[Win32] "#x"\n");
 
+	ERMM(MMSYSERR_ALLOCATED);
+	ERMM(MMSYSERR_BADDEVICEID);
+	ERMM(MMSYSERR_NODRIVER);
+	ERMM(WAVERR_BADFORMAT);
+	ERMM(WAVERR_SYNC);
 }
-#else
-void dummy_as_funcZ( void);
-void dummy_as_funcY( void)
- {
-}
-
 #endif
-

Modified: branches/avidemux_2.4_branch/avidemux/ADM_audiodevice/ADM_deviceWin32.h
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_audiodevice/ADM_deviceWin32.h	2007-07-16 21:44:22 UTC (rev 3400)
+++ branches/avidemux_2.4_branch/avidemux/ADM_audiodevice/ADM_deviceWin32.h	2007-07-17 02:24:45 UTC (rev 3401)
@@ -10,16 +10,17 @@
 //
 //
 #ifdef ADM_WIN32
-	        class win32AudioDevice : public audioDevice
-	 {
-		 protected :
-					uint8_t				_inUse;
-		  public:
-		  				win32AudioDevice(void);
-		     		virtual uint8_t init(uint8_t channels, uint32_t fq);
-	    			virtual uint8_t play(uint32_t len, float *data);
-		      		virtual uint8_t stop(void);
-		      		virtual uint8_t setVolume(int volume);
-		 }     ;
 
+class win32AudioDevice : public audioDevice
+{
+protected:
+	uint8_t	_inUse;
+public:
+	win32AudioDevice(void);
+	virtual uint8_t init(uint8_t channels, uint32_t fq);
+	virtual uint8_t play(uint32_t len, float *data);
+	virtual uint8_t stop(void);
+	virtual uint8_t setVolume(int volume);
+};
+
 #endif

Modified: branches/avidemux_2.4_branch/avidemux/guiplay.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/guiplay.cpp	2007-07-16 21:44:22 UTC (rev 3400)
+++ branches/avidemux_2.4_branch/avidemux/guiplay.cpp	2007-07-17 02:24:45 UTC (rev 3401)
@@ -60,9 +60,6 @@
 extern void UI_purge(void);
 #define EVEN(x) (x&0xffffffe)
 
- 
-
- extern uint8_t GUI_getFrame(uint32_t frameno,  uint32_t *flags);
 //___________________________________
 uint8_t stop_req;
 static int called = 0;
@@ -217,10 +214,9 @@
     // go back to normal display mode
     //____________________________________
     playing = 0;
-    uint32_t f;
           
 	   getFirstVideoFilter( );
-	   //GUI_getFrame(curframe,&f);
+
            admPreview::deferDisplay(0,0);
            UI_purge();
            // Updated by expose ? 
@@ -351,7 +347,7 @@
     channels= playback->getInfo()->channels;
     one_audio_frame = (one_frame * wavinfo->frequency * channels);	// 1000 *nb audio bytes per ms
     one_audio_frame /= 1000; // In elemtary info (float)
-    printf("\n 1 audio frame = %lu bytes (1)", one_audio_frame);
+    printf("1 audio frame = %lu bytes\n", one_audio_frame);
     // 3 sec buffer..               
     wavbuf =  (float *)  ADM_alloc((3 *  channels * wavinfo->frequency*wavinfo->channels));
     ADM_assert(wavbuf);



From mean at mail.berlios.de  Tue Jul 17 08:06:23 2007
From: mean at mail.berlios.de (mean at BerliOS)
Date: Tue, 17 Jul 2007 08:06:23 +0200
Subject: [Avidemux-svn-commit] r3402 -
	branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec
Message-ID: <200707170606.l6H66Nh7016860@sheep.berlios.de>

Author: mean
Date: 2007-07-17 08:06:22 +0200 (Tue, 17 Jul 2007)
New Revision: 3402

Added:
   branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec/dvbsub.c
   branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec/dvbsub_parser.c
   branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec/dvbsubdec.c
Modified:
   branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec/CMakeLists.txt
   branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec/ffconf.c
   branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec/ffconf.h
Log:
[LAV] More codecs

Modified: branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec/CMakeLists.txt
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec/CMakeLists.txt	2007-07-17 02:24:45 UTC (rev 3401)
+++ branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec/CMakeLists.txt	2007-07-17 06:06:22 UTC (rev 3402)
@@ -28,8 +28,9 @@
                 ac3enc.c ac3.c ac3tab.c
                 mjpegenc.c mjpegdec.c
                 wma.c
-
-
+                dvbsub_parser.c
+                dvbsubdec.c
+                dvbsub.c
 )
 # ADD x86 ones
 

Added: branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec/dvbsub.c
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec/dvbsub.c	2007-07-17 02:24:45 UTC (rev 3401)
+++ branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec/dvbsub.c	2007-07-17 06:06:22 UTC (rev 3402)
@@ -0,0 +1,437 @@
+/*
+ * DVB subtitle encoding for ffmpeg
+ * Copyright (c) 2005 Fabrice Bellard.
+ *
+ * This file is part of FFmpeg.
+ *
+ * FFmpeg is free software; you can redistribute it and/or
+ * modify it under the terms of the GNU Lesser General Public
+ * License as published by the Free Software Foundation; either
+ * version 2.1 of the License, or (at your option) any later version.
+ *
+ * FFmpeg is distributed in the hope that it will be useful,
+ * but WITHOUT ANY WARRANTY; without even the implied warranty of
+ * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ * Lesser General Public License for more details.
+ *
+ * You should have received a copy of the GNU Lesser General Public
+ * License along with FFmpeg; if not, write to the Free Software
+ * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA
+ */
+#include "avcodec.h"
+#include "bytestream.h"
+
+typedef struct DVBSubtitleContext {
+    int hide_state;
+    int object_version;
+} DVBSubtitleContext;
+
+#define PUTBITS2(val)\
+{\
+    bitbuf |= (val) << bitcnt;\
+    bitcnt -= 2;\
+    if (bitcnt < 0) {\
+        bitcnt = 6;\
+        *q++ = bitbuf;\
+        bitbuf = 0;\
+    }\
+}
+
+static void dvb_encode_rle2(uint8_t **pq,
+                            const uint8_t *bitmap, int linesize,
+                            int w, int h)
+{
+    uint8_t *q;
+    unsigned int bitbuf;
+    int bitcnt;
+    int x, y, len, x1, v, color;
+
+    q = *pq;
+
+    for(y = 0; y < h; y++) {
+        *q++ = 0x10;
+        bitbuf = 0;
+        bitcnt = 6;
+
+        x = 0;
+        while (x < w) {
+            x1 = x;
+            color = bitmap[x1++];
+            while (x1 < w && bitmap[x1] == color)
+                x1++;
+            len = x1 - x;
+            if (color == 0 && len == 2) {
+                PUTBITS2(0);
+                PUTBITS2(0);
+                PUTBITS2(1);
+            } else if (len >= 3 && len <= 10) {
+                v = len - 3;
+                PUTBITS2(0);
+                PUTBITS2((v >> 2) | 2);
+                PUTBITS2(v & 3);
+                PUTBITS2(color);
+            } else if (len >= 12 && len <= 27) {
+                v = len - 12;
+                PUTBITS2(0);
+                PUTBITS2(0);
+                PUTBITS2(2);
+                PUTBITS2(v >> 2);
+                PUTBITS2(v & 3);
+                PUTBITS2(color);
+            } else if (len >= 29) {
+                /* length = 29 ... 284 */
+                if (len > 284)
+                    len = 284;
+                v = len - 29;
+                PUTBITS2(0);
+                PUTBITS2(0);
+                PUTBITS2(3);
+                PUTBITS2((v >> 6));
+                PUTBITS2((v >> 4) & 3);
+                PUTBITS2((v >> 2) & 3);
+                PUTBITS2(v & 3);
+                PUTBITS2(color);
+            } else {
+                PUTBITS2(color);
+                if (color == 0) {
+                    PUTBITS2(1);
+                }
+                len = 1;
+            }
+            x += len;
+        }
+        /* end of line */
+        PUTBITS2(0);
+        PUTBITS2(0);
+        PUTBITS2(0);
+        if (bitcnt != 6) {
+            *q++ = bitbuf;
+        }
+        *q++ = 0xf0;
+        bitmap += linesize;
+    }
+    *pq = q;
+}
+
+#define PUTBITS4(val)\
+{\
+    bitbuf |= (val) << bitcnt;\
+    bitcnt -= 4;\
+    if (bitcnt < 0) {\
+        bitcnt = 4;\
+        *q++ = bitbuf;\
+        bitbuf = 0;\
+    }\
+}
+
+/* some DVB decoders only implement 4 bits/pixel */
+static void dvb_encode_rle4(uint8_t **pq,
+                            const uint8_t *bitmap, int linesize,
+                            int w, int h)
+{
+    uint8_t *q;
+    unsigned int bitbuf;
+    int bitcnt;
+    int x, y, len, x1, v, color;
+
+    q = *pq;
+
+    for(y = 0; y < h; y++) {
+        *q++ = 0x11;
+        bitbuf = 0;
+        bitcnt = 4;
+
+        x = 0;
+        while (x < w) {
+            x1 = x;
+            color = bitmap[x1++];
+            while (x1 < w && bitmap[x1] == color)
+                x1++;
+            len = x1 - x;
+            if (color == 0 && len == 2) {
+                PUTBITS4(0);
+                PUTBITS4(0xd);
+            } else if (color == 0 && (len >= 3 && len <= 9)) {
+                PUTBITS4(0);
+                PUTBITS4(len - 2);
+            } else if (len >= 4 && len <= 7) {
+                PUTBITS4(0);
+                PUTBITS4(8 + len - 4);
+                PUTBITS4(color);
+            } else if (len >= 9 && len <= 24) {
+                PUTBITS4(0);
+                PUTBITS4(0xe);
+                PUTBITS4(len - 9);
+                PUTBITS4(color);
+            } else if (len >= 25) {
+                if (len > 280)
+                    len = 280;
+                v = len - 25;
+                PUTBITS4(0);
+                PUTBITS4(0xf);
+                PUTBITS4(v >> 4);
+                PUTBITS4(v & 0xf);
+                PUTBITS4(color);
+            } else {
+                PUTBITS4(color);
+                if (color == 0) {
+                    PUTBITS4(0xc);
+                }
+                len = 1;
+            }
+            x += len;
+        }
+        /* end of line */
+        PUTBITS4(0);
+        PUTBITS4(0);
+        if (bitcnt != 4) {
+            *q++ = bitbuf;
+        }
+        *q++ = 0xf0;
+        bitmap += linesize;
+    }
+    *pq = q;
+}
+
+#define SCALEBITS 10
+#define ONE_HALF  (1 << (SCALEBITS - 1))
+#define FIX(x)    ((int) ((x) * (1<<SCALEBITS) + 0.5))
+
+#define RGB_TO_Y_CCIR(r, g, b) \
+((FIX(0.29900*219.0/255.0) * (r) + FIX(0.58700*219.0/255.0) * (g) + \
+  FIX(0.11400*219.0/255.0) * (b) + (ONE_HALF + (16 << SCALEBITS))) >> SCALEBITS)
+
+#define RGB_TO_U_CCIR(r1, g1, b1, shift)\
+(((- FIX(0.16874*224.0/255.0) * r1 - FIX(0.33126*224.0/255.0) * g1 +         \
+     FIX(0.50000*224.0/255.0) * b1 + (ONE_HALF << shift) - 1) >> (SCALEBITS + shift)) + 128)
+
+#define RGB_TO_V_CCIR(r1, g1, b1, shift)\
+(((FIX(0.50000*224.0/255.0) * r1 - FIX(0.41869*224.0/255.0) * g1 -           \
+   FIX(0.08131*224.0/255.0) * b1 + (ONE_HALF << shift) - 1) >> (SCALEBITS + shift)) + 128)
+
+static int encode_dvb_subtitles(DVBSubtitleContext *s,
+                                uint8_t *outbuf, AVSubtitle *h)
+{
+    uint8_t *q, *pseg_len;
+    int page_id, region_id, clut_id, object_id, i, bpp_index, page_state;
+
+
+    q = outbuf;
+
+    page_id = 1;
+
+    if (h->num_rects == 0 || h->rects == NULL)
+        return -1;
+
+    *q++ = 0x00; /* subtitle_stream_id */
+
+    /* page composition segment */
+
+    *q++ = 0x0f; /* sync_byte */
+    *q++ = 0x10; /* segment_type */
+    bytestream_put_be16(&q, page_id);
+    pseg_len = q;
+    q += 2; /* segment length */
+    *q++ = 30; /* page_timeout (seconds) */
+    if (s->hide_state)
+        page_state = 0; /* normal case */
+    else
+        page_state = 2; /* mode change */
+    /* page_version = 0 + page_state */
+    *q++ = s->object_version | (page_state << 2) | 3;
+
+    for (region_id = 0; region_id < h->num_rects; region_id++) {
+        *q++ = region_id;
+        *q++ = 0xff; /* reserved */
+        bytestream_put_be16(&q, h->rects[region_id].x); /* left pos */
+        bytestream_put_be16(&q, h->rects[region_id].y); /* top pos */
+    }
+
+    bytestream_put_be16(&pseg_len, q - pseg_len - 2);
+
+    if (!s->hide_state) {
+        for (clut_id = 0; clut_id < h->num_rects; clut_id++) {
+
+            /* CLUT segment */
+
+            if (h->rects[clut_id].nb_colors <= 4) {
+                /* 2 bpp, some decoders do not support it correctly */
+                bpp_index = 0;
+            } else if (h->rects[clut_id].nb_colors <= 16) {
+                /* 4 bpp, standard encoding */
+                bpp_index = 1;
+            } else {
+                return -1;
+            }
+
+            *q++ = 0x0f; /* sync byte */
+            *q++ = 0x12; /* CLUT definition segment */
+            bytestream_put_be16(&q, page_id);
+            pseg_len = q;
+            q += 2; /* segment length */
+            *q++ = clut_id;
+            *q++ = (0 << 4) | 0xf; /* version = 0 */
+
+            for(i = 0; i < h->rects[clut_id].nb_colors; i++) {
+                *q++ = i; /* clut_entry_id */
+                *q++ = (1 << (7 - bpp_index)) | (0xf << 1) | 1; /* 2 bits/pixel full range */
+                {
+                    int a, r, g, b;
+                    a = (h->rects[clut_id].rgba_palette[i] >> 24) & 0xff;
+                    r = (h->rects[clut_id].rgba_palette[i] >> 16) & 0xff;
+                    g = (h->rects[clut_id].rgba_palette[i] >> 8) & 0xff;
+                    b = (h->rects[clut_id].rgba_palette[i] >> 0) & 0xff;
+
+                    *q++ = RGB_TO_Y_CCIR(r, g, b);
+                    *q++ = RGB_TO_V_CCIR(r, g, b, 0);
+                    *q++ = RGB_TO_U_CCIR(r, g, b, 0);
+                    *q++ = 255 - a;
+                }
+            }
+
+            bytestream_put_be16(&pseg_len, q - pseg_len - 2);
+        }
+    }
+
+    for (region_id = 0; region_id < h->num_rects; region_id++) {
+
+        /* region composition segment */
+
+        if (h->rects[region_id].nb_colors <= 4) {
+            /* 2 bpp, some decoders do not support it correctly */
+            bpp_index = 0;
+        } else if (h->rects[region_id].nb_colors <= 16) {
+            /* 4 bpp, standard encoding */
+            bpp_index = 1;
+        } else {
+            return -1;
+        }
+
+        *q++ = 0x0f; /* sync_byte */
+        *q++ = 0x11; /* segment_type */
+        bytestream_put_be16(&q, page_id);
+        pseg_len = q;
+        q += 2; /* segment length */
+        *q++ = region_id;
+        *q++ = (s->object_version << 4) | (0 << 3) | 0x07; /* version , no fill */
+        bytestream_put_be16(&q, h->rects[region_id].w); /* region width */
+        bytestream_put_be16(&q, h->rects[region_id].h); /* region height */
+        *q++ = ((1 + bpp_index) << 5) | ((1 + bpp_index) << 2) | 0x03;
+        *q++ = region_id; /* clut_id == region_id */
+        *q++ = 0; /* 8 bit fill colors */
+        *q++ = 0x03; /* 4 bit and 2 bit fill colors */
+
+        if (!s->hide_state) {
+            bytestream_put_be16(&q, region_id); /* object_id == region_id */
+            *q++ = (0 << 6) | (0 << 4);
+            *q++ = 0;
+            *q++ = 0xf0;
+            *q++ = 0;
+        }
+
+        bytestream_put_be16(&pseg_len, q - pseg_len - 2);
+    }
+
+    if (!s->hide_state) {
+
+        for (object_id = 0; object_id < h->num_rects; object_id++) {
+            /* Object Data segment */
+
+            if (h->rects[object_id].nb_colors <= 4) {
+                /* 2 bpp, some decoders do not support it correctly */
+                bpp_index = 0;
+            } else if (h->rects[object_id].nb_colors <= 16) {
+                /* 4 bpp, standard encoding */
+                bpp_index = 1;
+            } else {
+                return -1;
+            }
+
+            *q++ = 0x0f; /* sync byte */
+            *q++ = 0x13;
+            bytestream_put_be16(&q, page_id);
+            pseg_len = q;
+            q += 2; /* segment length */
+
+            bytestream_put_be16(&q, object_id);
+            *q++ = (s->object_version << 4) | (0 << 2) | (0 << 1) | 1; /* version = 0,
+                                                                       onject_coding_method,
+                                                                       non_modifying_color_flag */
+            {
+                uint8_t *ptop_field_len, *pbottom_field_len, *top_ptr, *bottom_ptr;
+                void (*dvb_encode_rle)(uint8_t **pq,
+                                        const uint8_t *bitmap, int linesize,
+                                        int w, int h);
+                ptop_field_len = q;
+                q += 2;
+                pbottom_field_len = q;
+                q += 2;
+
+                if (bpp_index == 0)
+                    dvb_encode_rle = dvb_encode_rle2;
+                else
+                    dvb_encode_rle = dvb_encode_rle4;
+
+                top_ptr = q;
+                dvb_encode_rle(&q, h->rects[object_id].bitmap, h->rects[object_id].w * 2,
+                                    h->rects[object_id].w, h->rects[object_id].h >> 1);
+                bottom_ptr = q;
+                dvb_encode_rle(&q, h->rects[object_id].bitmap + h->rects[object_id].w,
+                                    h->rects[object_id].w * 2, h->rects[object_id].w,
+                                    h->rects[object_id].h >> 1);
+
+                bytestream_put_be16(&ptop_field_len, bottom_ptr - top_ptr);
+                bytestream_put_be16(&pbottom_field_len, q - bottom_ptr);
+            }
+
+            bytestream_put_be16(&pseg_len, q - pseg_len - 2);
+        }
+    }
+
+    /* end of display set segment */
+
+    *q++ = 0x0f; /* sync_byte */
+    *q++ = 0x80; /* segment_type */
+    bytestream_put_be16(&q, page_id);
+    pseg_len = q;
+    q += 2; /* segment length */
+
+    bytestream_put_be16(&pseg_len, q - pseg_len - 2);
+
+    *q++ = 0xff; /* end of PES data */
+
+    s->object_version = (s->object_version + 1) & 0xf;
+    s->hide_state = !s->hide_state;
+    return q - outbuf;
+}
+
+static int dvbsub_init_decoder(AVCodecContext *avctx)
+{
+    return 0;
+}
+
+static int dvbsub_close_decoder(AVCodecContext *avctx)
+{
+    return 0;
+}
+
+static int dvbsub_encode(AVCodecContext *avctx,
+                       unsigned char *buf, int buf_size, void *data)
+{
+    DVBSubtitleContext *s = avctx->priv_data;
+    AVSubtitle *sub = data;
+    int ret;
+
+    ret = encode_dvb_subtitles(s, buf, sub);
+    return ret;
+}
+
+AVCodec dvbsub_encoder = {
+    "dvbsub",
+    CODEC_TYPE_SUBTITLE,
+    CODEC_ID_DVB_SUBTITLE,
+    sizeof(DVBSubtitleContext),
+    dvbsub_init_decoder,
+    dvbsub_encode,
+    dvbsub_close_decoder,
+};

Added: branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec/dvbsub_parser.c
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec/dvbsub_parser.c	2007-07-17 02:24:45 UTC (rev 3401)
+++ branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec/dvbsub_parser.c	2007-07-17 06:06:22 UTC (rev 3402)
@@ -0,0 +1,196 @@
+/*
+ * DVB subtitle parser for FFmpeg
+ * Copyright (c) 2005 Ian Caulfield.
+ *
+ * This file is part of FFmpeg.
+ *
+ * FFmpeg is free software; you can redistribute it and/or
+ * modify it under the terms of the GNU Lesser General Public
+ * License as published by the Free Software Foundation; either
+ * version 2.1 of the License, or (at your option) any later version.
+ *
+ * FFmpeg is distributed in the hope that it will be useful,
+ * but WITHOUT ANY WARRANTY; without even the implied warranty of
+ * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ * Lesser General Public License for more details.
+ *
+ * You should have received a copy of the GNU Lesser General Public
+ * License along with FFmpeg; if not, write to the Free Software
+ * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA
+ */
+#include "avcodec.h"
+#include "dsputil.h"
+#include "bitstream.h"
+
+//#define DEBUG
+//#define DEBUG_PACKET_CONTENTS
+
+/* Parser (mostly) copied from dvdsub.c */
+
+#define PARSE_BUF_SIZE  (65536)
+
+
+/* parser definition */
+typedef struct DVBSubParseContext {
+    uint8_t *packet_buf;
+    int packet_start;
+    int packet_index;
+    int in_packet;
+} DVBSubParseContext;
+
+static int dvbsub_parse_init(AVCodecParserContext *s)
+{
+    DVBSubParseContext *pc = s->priv_data;
+    pc->packet_buf = av_malloc(PARSE_BUF_SIZE);
+
+    return 0;
+}
+
+static int dvbsub_parse(AVCodecParserContext *s,
+                        AVCodecContext *avctx,
+                        const uint8_t **poutbuf, int *poutbuf_size,
+                        const uint8_t *buf, int buf_size)
+{
+    DVBSubParseContext *pc = s->priv_data;
+    uint8_t *p, *p_end;
+    int len, buf_pos = 0;
+
+#ifdef DEBUG
+    av_log(avctx, AV_LOG_INFO, "DVB parse packet pts=%"PRIx64", lpts=%"PRIx64", cpts=%"PRIx64":\n",
+            s->pts, s->last_pts, s->cur_frame_pts[s->cur_frame_start_index]);
+#endif
+
+#ifdef DEBUG_PACKET_CONTENTS
+    int i;
+
+    for (i=0; i < buf_size; i++)
+    {
+        av_log(avctx, AV_LOG_INFO, "%02x ", buf[i]);
+        if (i % 16 == 15)
+            av_log(avctx, AV_LOG_INFO, "\n");
+    }
+
+    if (i % 16 != 0)
+        av_log(avctx, AV_LOG_INFO, "\n");
+
+#endif
+
+    *poutbuf = NULL;
+    *poutbuf_size = 0;
+
+    s->fetch_timestamp = 1;
+
+    if (s->last_pts != s->pts && s->last_pts != AV_NOPTS_VALUE) /* Start of a new packet */
+    {
+        if (pc->packet_index != pc->packet_start)
+        {
+#ifdef DEBUG
+            av_log(avctx, AV_LOG_INFO, "Discarding %d bytes\n",
+                pc->packet_index - pc->packet_start);
+#endif
+        }
+
+        pc->packet_start = 0;
+        pc->packet_index = 0;
+
+        if (buf_size < 2 || buf[0] != 0x20 || buf[1] != 0x00) {
+#ifdef DEBUG
+            av_log(avctx, AV_LOG_INFO, "Bad packet header\n");
+#endif
+            return -1;
+        }
+
+        buf_pos = 2;
+
+        pc->in_packet = 1;
+    } else {
+        if (pc->packet_start != 0)
+        {
+            if (pc->packet_index != pc->packet_start)
+            {
+                memmove(pc->packet_buf, pc->packet_buf + pc->packet_start,
+                            pc->packet_index - pc->packet_start);
+
+                pc->packet_index -= pc->packet_start;
+                pc->packet_start = 0;
+            } else {
+                pc->packet_start = 0;
+                pc->packet_index = 0;
+            }
+        }
+    }
+
+    if (buf_size - buf_pos + pc->packet_index > PARSE_BUF_SIZE)
+        return -1;
+
+/* if not currently in a packet, discard data */
+    if (pc->in_packet == 0)
+        return buf_size;
+
+    memcpy(pc->packet_buf + pc->packet_index, buf + buf_pos, buf_size - buf_pos);
+    pc->packet_index += buf_size - buf_pos;
+
+    p = pc->packet_buf;
+    p_end = pc->packet_buf + pc->packet_index;
+
+    while (p < p_end)
+    {
+        if (*p == 0x0f)
+        {
+            if (p + 6 <= p_end)
+            {
+                len = AV_RB16(p + 4);
+
+                if (p + len + 6 <= p_end)
+                {
+                    *poutbuf_size += len + 6;
+
+                    p += len + 6;
+                } else
+                    break;
+            } else
+                break;
+        } else if (*p == 0xff) {
+            if (p + 1 < p_end)
+            {
+#ifdef DEBUG
+                av_log(avctx, AV_LOG_INFO, "Junk at end of packet\n");
+#endif
+            }
+            pc->packet_index = p - pc->packet_buf;
+            pc->in_packet = 0;
+            break;
+        } else {
+            av_log(avctx, AV_LOG_ERROR, "Junk in packet\n");
+
+            pc->packet_index = p - pc->packet_buf;
+            pc->in_packet = 0;
+            break;
+        }
+    }
+
+    if (*poutbuf_size > 0)
+    {
+        *poutbuf = pc->packet_buf;
+        pc->packet_start = *poutbuf_size;
+    }
+
+    if (s->last_pts == AV_NOPTS_VALUE)
+        s->last_pts = s->pts;
+
+    return buf_size;
+}
+
+static void dvbsub_parse_close(AVCodecParserContext *s)
+{
+    DVBSubParseContext *pc = s->priv_data;
+    av_freep(&pc->packet_buf);
+}
+
+AVCodecParser dvbsub_parser = {
+    { CODEC_ID_DVB_SUBTITLE },
+    sizeof(DVBSubParseContext),
+    dvbsub_parse_init,
+    dvbsub_parse,
+    dvbsub_parse_close,
+};

Added: branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec/dvbsubdec.c
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec/dvbsubdec.c	2007-07-17 02:24:45 UTC (rev 3401)
+++ branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec/dvbsubdec.c	2007-07-17 06:06:22 UTC (rev 3402)
@@ -0,0 +1,1461 @@
+/*
+ * DVB subtitle decoding for ffmpeg
+ * Copyright (c) 2005 Ian Caulfield.
+ *
+ * This file is part of FFmpeg.
+ *
+ * FFmpeg is free software; you can redistribute it and/or
+ * modify it under the terms of the GNU Lesser General Public
+ * License as published by the Free Software Foundation; either
+ * version 2.1 of the License, or (at your option) any later version.
+ *
+ * FFmpeg is distributed in the hope that it will be useful,
+ * but WITHOUT ANY WARRANTY; without even the implied warranty of
+ * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ * Lesser General Public License for more details.
+ *
+ * You should have received a copy of the GNU Lesser General Public
+ * License along with FFmpeg; if not, write to the Free Software
+ * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA
+ */
+#include "avcodec.h"
+#include "dsputil.h"
+#include "bitstream.h"
+
+//#define DEBUG
+//#define DEBUG_PACKET_CONTENTS
+//#define DEBUG_SAVE_IMAGES
+
+#define DVBSUB_PAGE_SEGMENT     0x10
+#define DVBSUB_REGION_SEGMENT   0x11
+#define DVBSUB_CLUT_SEGMENT     0x12
+#define DVBSUB_OBJECT_SEGMENT   0x13
+#define DVBSUB_DISPLAY_SEGMENT  0x80
+
+#define cm (ff_cropTbl + MAX_NEG_CROP)
+
+#ifdef DEBUG_SAVE_IMAGES
+#undef fprintf
+#if 0
+static void png_save(const char *filename, uint8_t *bitmap, int w, int h,
+                     uint32_t *rgba_palette)
+{
+    int x, y, v;
+    FILE *f;
+    char fname[40], fname2[40];
+    char command[1024];
+
+    snprintf(fname, 40, "%s.ppm", filename);
+
+    f = fopen(fname, "w");
+    if (!f) {
+        perror(fname);
+        exit(1);
+    }
+    fprintf(f, "P6\n"
+            "%d %d\n"
+            "%d\n",
+            w, h, 255);
+    for(y = 0; y < h; y++) {
+        for(x = 0; x < w; x++) {
+            v = rgba_palette[bitmap[y * w + x]];
+            putc((v >> 16) & 0xff, f);
+            putc((v >> 8) & 0xff, f);
+            putc((v >> 0) & 0xff, f);
+        }
+    }
+    fclose(f);
+
+
+    snprintf(fname2, 40, "%s-a.pgm", filename);
+
+    f = fopen(fname2, "w");
+    if (!f) {
+        perror(fname2);
+        exit(1);
+    }
+    fprintf(f, "P5\n"
+            "%d %d\n"
+            "%d\n",
+            w, h, 255);
+    for(y = 0; y < h; y++) {
+        for(x = 0; x < w; x++) {
+            v = rgba_palette[bitmap[y * w + x]];
+            putc((v >> 24) & 0xff, f);
+        }
+    }
+    fclose(f);
+
+    snprintf(command, 1024, "pnmtopng -alpha %s %s > %s.png 2> /dev/null", fname2, fname, filename);
+    system(command);
+
+    snprintf(command, 1024, "rm %s %s", fname, fname2);
+    system(command);
+}
+#endif
+
+static void png_save2(const char *filename, uint32_t *bitmap, int w, int h)
+{
+    int x, y, v;
+    FILE *f;
+    char fname[40], fname2[40];
+    char command[1024];
+
+    snprintf(fname, 40, "%s.ppm", filename);
+
+    f = fopen(fname, "w");
+    if (!f) {
+        perror(fname);
+        exit(1);
+    }
+    fprintf(f, "P6\n"
+            "%d %d\n"
+            "%d\n",
+            w, h, 255);
+    for(y = 0; y < h; y++) {
+        for(x = 0; x < w; x++) {
+            v = bitmap[y * w + x];
+            putc((v >> 16) & 0xff, f);
+            putc((v >> 8) & 0xff, f);
+            putc((v >> 0) & 0xff, f);
+        }
+    }
+    fclose(f);
+
+
+    snprintf(fname2, 40, "%s-a.pgm", filename);
+
+    f = fopen(fname2, "w");
+    if (!f) {
+        perror(fname2);
+        exit(1);
+    }
+    fprintf(f, "P5\n"
+            "%d %d\n"
+            "%d\n",
+            w, h, 255);
+    for(y = 0; y < h; y++) {
+        for(x = 0; x < w; x++) {
+            v = bitmap[y * w + x];
+            putc((v >> 24) & 0xff, f);
+        }
+    }
+    fclose(f);
+
+    snprintf(command, 1024, "pnmtopng -alpha %s %s > %s.png 2> /dev/null", fname2, fname, filename);
+    system(command);
+
+    snprintf(command, 1024, "rm %s %s", fname, fname2);
+    system(command);
+}
+#endif
+
+#define RGBA(r,g,b,a) (((a) << 24) | ((r) << 16) | ((g) << 8) | (b))
+
+typedef struct DVBSubCLUT {
+    int id;
+
+    uint32_t clut4[4];
+    uint32_t clut16[16];
+    uint32_t clut256[256];
+
+    struct DVBSubCLUT *next;
+} DVBSubCLUT;
+
+static DVBSubCLUT default_clut;
+
+typedef struct DVBSubObjectDisplay {
+    int object_id;
+    int region_id;
+
+    int x_pos;
+    int y_pos;
+
+    int fgcolour;
+    int bgcolour;
+
+    struct DVBSubObjectDisplay *region_list_next;
+    struct DVBSubObjectDisplay *object_list_next;
+} DVBSubObjectDisplay;
+
+typedef struct DVBSubObject {
+    int id;
+
+    int type;
+
+    DVBSubObjectDisplay *display_list;
+
+    struct DVBSubObject *next;
+} DVBSubObject;
+
+typedef struct DVBSubRegionDisplay {
+    int region_id;
+
+    int x_pos;
+    int y_pos;
+
+    struct DVBSubRegionDisplay *next;
+} DVBSubRegionDisplay;
+
+typedef struct DVBSubRegion {
+    int id;
+
+    int width;
+    int height;
+    int depth;
+
+    int clut;
+    int bgcolour;
+
+    uint8_t *pbuf;
+    int buf_size;
+
+    DVBSubObjectDisplay *display_list;
+
+    struct DVBSubRegion *next;
+} DVBSubRegion;
+
+typedef struct DVBSubContext {
+    int composition_id;
+    int ancillary_id;
+
+    int time_out;
+    DVBSubRegion *region_list;
+    DVBSubCLUT   *clut_list;
+    DVBSubObject *object_list;
+
+    int display_list_size;
+    DVBSubRegionDisplay *display_list;
+} DVBSubContext;
+
+
+static DVBSubObject* get_object(DVBSubContext *ctx, int object_id)
+{
+    DVBSubObject *ptr = ctx->object_list;
+
+    while (ptr != NULL && ptr->id != object_id) {
+        ptr = ptr->next;
+    }
+
+    return ptr;
+}
+
+static DVBSubCLUT* get_clut(DVBSubContext *ctx, int clut_id)
+{
+    DVBSubCLUT *ptr = ctx->clut_list;
+
+    while (ptr != NULL && ptr->id != clut_id) {
+        ptr = ptr->next;
+    }
+
+    return ptr;
+}
+
+static DVBSubRegion* get_region(DVBSubContext *ctx, int region_id)
+{
+    DVBSubRegion *ptr = ctx->region_list;
+
+    while (ptr != NULL && ptr->id != region_id) {
+        ptr = ptr->next;
+    }
+
+    return ptr;
+}
+
+static void delete_region_display_list(DVBSubContext *ctx, DVBSubRegion *region)
+{
+    DVBSubObject *object, *obj2, **obj2_ptr;
+    DVBSubObjectDisplay *display, *obj_disp, **obj_disp_ptr;
+
+    while (region->display_list != NULL) {
+        display = region->display_list;
+
+        object = get_object(ctx, display->object_id);
+
+        if (object != NULL) {
+            obj_disp = object->display_list;
+            obj_disp_ptr = &object->display_list;
+
+            while (obj_disp != NULL && obj_disp != display) {
+                obj_disp_ptr = &obj_disp->object_list_next;
+                obj_disp = obj_disp->object_list_next;
+            }
+
+            if (obj_disp) {
+                *obj_disp_ptr = obj_disp->object_list_next;
+
+                if (object->display_list == NULL) {
+                    obj2 = ctx->object_list;
+                    obj2_ptr = &ctx->object_list;
+
+                    while (obj2 != NULL && obj2 != object) {
+                        obj2_ptr = &obj2->next;
+                        obj2 = obj2->next;
+                    }
+
+                    *obj2_ptr = obj2->next;
+
+                    av_free(obj2);
+                }
+            }
+        }
+
+        region->display_list = display->region_list_next;
+
+        av_free(display);
+    }
+
+}
+
+static void delete_state(DVBSubContext *ctx)
+{
+    DVBSubRegion *region;
+    DVBSubCLUT *clut;
+
+    while (ctx->region_list != NULL)
+    {
+        region = ctx->region_list;
+
+        ctx->region_list = region->next;
+
+        delete_region_display_list(ctx, region);
+        if (region->pbuf != NULL)
+            av_free(region->pbuf);
+
+        av_free(region);
+    }
+
+    while (ctx->clut_list != NULL)
+    {
+        clut = ctx->clut_list;
+
+        ctx->clut_list = clut->next;
+
+        av_free(clut);
+    }
+
+    /* Should already be null */
+    if (ctx->object_list != NULL)
+        av_log(0, AV_LOG_ERROR, "Memory deallocation error!\n");
+}
+
+static int dvbsub_init_decoder(AVCodecContext *avctx)
+{
+    int i, r, g, b, a = 0;
+    DVBSubContext *ctx = (DVBSubContext*) avctx->priv_data;
+
+    memset(avctx->priv_data, 0, sizeof(DVBSubContext));
+
+    ctx->composition_id = avctx->sub_id & 0xffff;
+    ctx->ancillary_id = avctx->sub_id >> 16;
+
+    default_clut.id = -1;
+    default_clut.next = NULL;
+
+    default_clut.clut4[0] = RGBA(  0,   0,   0,   0);
+    default_clut.clut4[1] = RGBA(255, 255, 255, 255);
+    default_clut.clut4[2] = RGBA(  0,   0,   0, 255);
+    default_clut.clut4[3] = RGBA(127, 127, 127, 255);
+
+    default_clut.clut16[0] = RGBA(  0,   0,   0,   0);
+    for (i = 1; i < 16; i++) {
+        if (i < 8) {
+            r = (i & 1) ? 255 : 0;
+            g = (i & 2) ? 255 : 0;
+            b = (i & 4) ? 255 : 0;
+        } else {
+            r = (i & 1) ? 127 : 0;
+            g = (i & 2) ? 127 : 0;
+            b = (i & 4) ? 127 : 0;
+        }
+        default_clut.clut16[i] = RGBA(r, g, b, 255);
+    }
+
+    default_clut.clut256[0] = RGBA(  0,   0,   0,   0);
+    for (i = 1; i < 256; i++) {
+        if (i < 8) {
+            r = (i & 1) ? 255 : 0;
+            g = (i & 2) ? 255 : 0;
+            b = (i & 4) ? 255 : 0;
+            a = 63;
+        } else {
+            switch (i & 0x88) {
+            case 0x00:
+                r = ((i & 1) ? 85 : 0) + ((i & 0x10) ? 170 : 0);
+                g = ((i & 2) ? 85 : 0) + ((i & 0x20) ? 170 : 0);
+                b = ((i & 4) ? 85 : 0) + ((i & 0x40) ? 170 : 0);
+                a = 255;
+                break;
+            case 0x08:
+                r = ((i & 1) ? 85 : 0) + ((i & 0x10) ? 170 : 0);
+                g = ((i & 2) ? 85 : 0) + ((i & 0x20) ? 170 : 0);
+                b = ((i & 4) ? 85 : 0) + ((i & 0x40) ? 170 : 0);
+                a = 127;
+                break;
+            case 0x80:
+                r = 127 + ((i & 1) ? 43 : 0) + ((i & 0x10) ? 85 : 0);
+                g = 127 + ((i & 2) ? 43 : 0) + ((i & 0x20) ? 85 : 0);
+                b = 127 + ((i & 4) ? 43 : 0) + ((i & 0x40) ? 85 : 0);
+                a = 255;
+                break;
+            case 0x88:
+                r = ((i & 1) ? 43 : 0) + ((i & 0x10) ? 85 : 0);
+                g = ((i & 2) ? 43 : 0) + ((i & 0x20) ? 85 : 0);
+                b = ((i & 4) ? 43 : 0) + ((i & 0x40) ? 85 : 0);
+                a = 255;
+                break;
+            }
+        }
+        default_clut.clut256[i] = RGBA(r, g, b, a);
+    }
+
+    return 0;
+}
+
+static int dvbsub_close_decoder(AVCodecContext *avctx)
+{
+    DVBSubContext *ctx = (DVBSubContext*) avctx->priv_data;
+    DVBSubRegionDisplay *display;
+
+    delete_state(ctx);
+
+    while (ctx->display_list != NULL)
+    {
+        display = ctx->display_list;
+        ctx->display_list = display->next;
+
+        av_free(display);
+    }
+
+    return 0;
+}
+
+static int dvbsub_read_2bit_string(uint8_t *destbuf, int dbuf_len,
+                                   uint8_t **srcbuf, int buf_size,
+                                   int non_mod, uint8_t *map_table)
+{
+    GetBitContext gb;
+
+    int bits;
+    int run_length;
+    int pixels_read = 0;
+
+    init_get_bits(&gb, *srcbuf, buf_size << 8);
+
+    while (get_bits_count(&gb) < (buf_size << 8) && pixels_read < dbuf_len) {
+        bits = get_bits(&gb, 2);
+
+        if (bits != 0) {
+            if (non_mod != 1 || bits != 1) {
+                if (map_table != NULL)
+                    *destbuf++ = map_table[bits];
+                else
+                    *destbuf++ = bits;
+            }
+            pixels_read++;
+        } else {
+            bits = get_bits(&gb, 1);
+            if (bits == 1) {
+                run_length = get_bits(&gb, 3) + 3;
+                bits = get_bits(&gb, 2);
+
+                if (non_mod == 1 && bits == 1)
+                    pixels_read += run_length;
+                else {
+                    if (map_table != NULL)
+                        bits = map_table[bits];
+                    while (run_length-- > 0 && pixels_read < dbuf_len) {
+                        *destbuf++ = bits;
+                        pixels_read++;
+                    }
+                }
+            } else {
+                bits = get_bits(&gb, 1);
+                if (bits == 0) {
+                    bits = get_bits(&gb, 2);
+                    if (bits == 2) {
+                        run_length = get_bits(&gb, 4) + 12;
+                        bits = get_bits(&gb, 2);
+
+                        if (non_mod == 1 && bits == 1)
+                            pixels_read += run_length;
+                        else {
+                            if (map_table != NULL)
+                                bits = map_table[bits];
+                            while (run_length-- > 0 && pixels_read < dbuf_len) {
+                                *destbuf++ = bits;
+                                pixels_read++;
+                            }
+                        }
+                    } else if (bits == 3) {
+                        run_length = get_bits(&gb, 8) + 29;
+                        bits = get_bits(&gb, 2);
+
+                        if (non_mod == 1 && bits == 1)
+                            pixels_read += run_length;
+                        else {
+                            if (map_table != NULL)
+                                bits = map_table[bits];
+                            while (run_length-- > 0 && pixels_read < dbuf_len) {
+                                *destbuf++ = bits;
+                                pixels_read++;
+                            }
+                        }
+                    } else if (bits == 1) {
+                        pixels_read += 2;
+                        if (map_table != NULL)
+                            bits = map_table[0];
+                        else
+                            bits = 0;
+                        if (pixels_read <= dbuf_len) {
+                            *destbuf++ = bits;
+                            *destbuf++ = bits;
+                        }
+                    } else {
+                        (*srcbuf) += (get_bits_count(&gb) + 7) >> 3;
+                        return pixels_read;
+                    }
+                } else {
+                    if (map_table != NULL)
+                        bits = map_table[0];
+                    else
+                        bits = 0;
+                    *destbuf++ = bits;
+                    pixels_read++;
+                }
+            }
+        }
+    }
+
+    if (get_bits(&gb, 6) != 0)
+        av_log(0, AV_LOG_ERROR, "DVBSub error: line overflow\n");
+
+    (*srcbuf) += (get_bits_count(&gb) + 7) >> 3;
+
+    return pixels_read;
+}
+
+static int dvbsub_read_4bit_string(uint8_t *destbuf, int dbuf_len,
+                                   uint8_t **srcbuf, int buf_size,
+                                   int non_mod, uint8_t *map_table)
+{
+    GetBitContext gb;
+
+    int bits;
+    int run_length;
+    int pixels_read = 0;
+
+    init_get_bits(&gb, *srcbuf, buf_size << 8);
+
+    while (get_bits_count(&gb) < (buf_size << 8) && pixels_read < dbuf_len) {
+        bits = get_bits(&gb, 4);
+
+        if (bits != 0) {
+            if (non_mod != 1 || bits != 1) {
+                if (map_table != NULL)
+                    *destbuf++ = map_table[bits];
+                else
+                    *destbuf++ = bits;
+            }
+            pixels_read++;
+        } else {
+            bits = get_bits(&gb, 1);
+            if (bits == 0) {
+                run_length = get_bits(&gb, 3);
+
+                if (run_length == 0) {
+                    (*srcbuf) += (get_bits_count(&gb) + 7) >> 3;
+                    return pixels_read;
+                }
+
+                run_length += 2;
+
+                if (map_table != NULL)
+                    bits = map_table[0];
+                else
+                    bits = 0;
+
+                while (run_length-- > 0 && pixels_read < dbuf_len) {
+                    *destbuf++ = bits;
+                    pixels_read++;
+                }
+            } else {
+                bits = get_bits(&gb, 1);
+                if (bits == 0) {
+                    run_length = get_bits(&gb, 2) + 4;
+                    bits = get_bits(&gb, 4);
+
+                    if (non_mod == 1 && bits == 1)
+                        pixels_read += run_length;
+                    else {
+                        if (map_table != NULL)
+                            bits = map_table[bits];
+                        while (run_length-- > 0 && pixels_read < dbuf_len) {
+                            *destbuf++ = bits;
+                            pixels_read++;
+                        }
+                    }
+                } else {
+                    bits = get_bits(&gb, 2);
+                    if (bits == 2) {
+                        run_length = get_bits(&gb, 4) + 9;
+                        bits = get_bits(&gb, 4);
+
+                        if (non_mod == 1 && bits == 1)
+                            pixels_read += run_length;
+                        else {
+                            if (map_table != NULL)
+                                bits = map_table[bits];
+                            while (run_length-- > 0 && pixels_read < dbuf_len) {
+                                *destbuf++ = bits;
+                                pixels_read++;
+                            }
+                        }
+                    } else if (bits == 3) {
+                        run_length = get_bits(&gb, 8) + 25;
+                        bits = get_bits(&gb, 4);
+
+                        if (non_mod == 1 && bits == 1)
+                            pixels_read += run_length;
+                        else {
+                            if (map_table != NULL)
+                                bits = map_table[bits];
+                            while (run_length-- > 0 && pixels_read < dbuf_len) {
+                                *destbuf++ = bits;
+                                pixels_read++;
+                            }
+                        }
+                    } else if (bits == 1) {
+                        pixels_read += 2;
+                        if (map_table != NULL)
+                            bits = map_table[0];
+                        else
+                            bits = 0;
+                        if (pixels_read <= dbuf_len) {
+                            *destbuf++ = bits;
+                            *destbuf++ = bits;
+                        }
+                    } else {
+                        if (map_table != NULL)
+                            bits = map_table[0];
+                        else
+                            bits = 0;
+                        *destbuf++ = bits;
+                        pixels_read ++;
+                    }
+                }
+            }
+        }
+    }
+
+    if (get_bits(&gb, 8) != 0)
+        av_log(0, AV_LOG_ERROR, "DVBSub error: line overflow\n");
+
+    (*srcbuf) += (get_bits_count(&gb) + 7) >> 3;
+
+    return pixels_read;
+}
+
+static int dvbsub_read_8bit_string(uint8_t *destbuf, int dbuf_len,
+                                    uint8_t **srcbuf, int buf_size,
+                                    int non_mod, uint8_t *map_table)
+{
+    uint8_t *sbuf_end = (*srcbuf) + buf_size;
+    int bits;
+    int run_length;
+    int pixels_read = 0;
+
+    while (*srcbuf < sbuf_end && pixels_read < dbuf_len) {
+        bits = *(*srcbuf)++;
+
+        if (bits != 0) {
+            if (non_mod != 1 || bits != 1) {
+                if (map_table != NULL)
+                    *destbuf++ = map_table[bits];
+                else
+                    *destbuf++ = bits;
+            }
+            pixels_read++;
+        } else {
+            bits = *(*srcbuf)++;
+            run_length = bits & 0x7f;
+            if ((bits & 0x80) == 0) {
+                if (run_length == 0) {
+                    return pixels_read;
+                }
+
+                if (map_table != NULL)
+                    bits = map_table[0];
+                else
+                    bits = 0;
+                while (run_length-- > 0 && pixels_read < dbuf_len) {
+                    *destbuf++ = bits;
+                    pixels_read++;
+                }
+            } else {
+                bits = *(*srcbuf)++;
+
+                if (non_mod == 1 && bits == 1)
+                    pixels_read += run_length;
+                if (map_table != NULL)
+                    bits = map_table[bits];
+                else while (run_length-- > 0 && pixels_read < dbuf_len) {
+                    *destbuf++ = bits;
+                    pixels_read++;
+                }
+            }
+        }
+    }
+
+    if (*(*srcbuf)++ != 0)
+        av_log(0, AV_LOG_ERROR, "DVBSub error: line overflow\n");
+
+    return pixels_read;
+}
+
+
+
+static void dvbsub_parse_pixel_data_block(AVCodecContext *avctx, DVBSubObjectDisplay *display,
+                                          uint8_t *buf, int buf_size, int top_bottom, int non_mod)
+{
+    DVBSubContext *ctx = (DVBSubContext*) avctx->priv_data;
+
+    DVBSubRegion *region = get_region(ctx, display->region_id);
+    uint8_t *buf_end = buf + buf_size;
+    uint8_t *pbuf;
+    int x_pos, y_pos;
+    int i;
+
+    uint8_t map2to4[] = { 0x0,  0x7,  0x8,  0xf};
+    uint8_t map2to8[] = {0x00, 0x77, 0x88, 0xff};
+    uint8_t map4to8[] = {0x00, 0x11, 0x22, 0x33, 0x44, 0x55, 0x66, 0x77,
+                         0x88, 0x99, 0xaa, 0xbb, 0xcc, 0xdd, 0xee, 0xff};
+    uint8_t *map_table;
+
+#ifdef DEBUG
+    av_log(avctx, AV_LOG_INFO, "DVB pixel block size %d, %s field:\n", buf_size,
+                top_bottom ? "bottom" : "top");
+#endif
+
+#ifdef DEBUG_PACKET_CONTENTS
+    for (i = 0; i < buf_size; i++)
+    {
+        if (i % 16 == 0)
+            av_log(avctx, AV_LOG_INFO, "0x%08p: ", buf+i);
+
+        av_log(avctx, AV_LOG_INFO, "%02x ", buf[i]);
+        if (i % 16 == 15)
+            av_log(avctx, AV_LOG_INFO, "\n");
+    }
+
+    if (i % 16 != 0)
+        av_log(avctx, AV_LOG_INFO, "\n");
+
+#endif
+
+    if (region == 0)
+        return;
+
+    pbuf = region->pbuf;
+
+    x_pos = display->x_pos;
+    y_pos = display->y_pos;
+
+    if ((y_pos & 1) != top_bottom)
+        y_pos++;
+
+    while (buf < buf_end) {
+        if (x_pos > region->width || y_pos > region->height) {
+            av_log(avctx, AV_LOG_ERROR, "Invalid object location!\n");
+            return;
+        }
+
+        switch (*buf++) {
+        case 0x10:
+            if (region->depth == 8)
+                map_table = map2to8;
+            else if (region->depth == 4)
+                map_table = map2to4;
+            else
+                map_table = NULL;
+
+            x_pos += dvbsub_read_2bit_string(pbuf + (y_pos * region->width) + x_pos,
+                                                region->width - x_pos, &buf, buf_size,
+                                                non_mod, map_table);
+            break;
+        case 0x11:
+            if (region->depth < 4) {
+                av_log(avctx, AV_LOG_ERROR, "4-bit pixel string in %d-bit region!\n", region->depth);
+                return;
+            }
+
+            if (region->depth == 8)
+                map_table = map4to8;
+            else
+                map_table = NULL;
+
+            x_pos += dvbsub_read_4bit_string(pbuf + (y_pos * region->width) + x_pos,
+                                                region->width - x_pos, &buf, buf_size,
+                                                non_mod, map_table);
+            break;
+        case 0x12:
+            if (region->depth < 8) {
+                av_log(avctx, AV_LOG_ERROR, "8-bit pixel string in %d-bit region!\n", region->depth);
+                return;
+            }
+
+            x_pos += dvbsub_read_8bit_string(pbuf + (y_pos * region->width) + x_pos,
+                                                region->width - x_pos, &buf, buf_size,
+                                                non_mod, NULL);
+            break;
+
+        case 0x20:
+            map2to4[0] = (*buf) >> 4;
+            map2to4[1] = (*buf++) & 0xf;
+            map2to4[2] = (*buf) >> 4;
+            map2to4[3] = (*buf++) & 0xf;
+            break;
+        case 0x21:
+            for (i = 0; i < 4; i++)
+                map2to8[i] = *buf++;
+            break;
+        case 0x22:
+            for (i = 0; i < 16; i++)
+                map4to8[i] = *buf++;
+            break;
+
+        case 0xf0:
+            x_pos = display->x_pos;
+            y_pos += 2;
+            break;
+        default:
+            av_log(avctx, AV_LOG_INFO, "Unknown/unsupported pixel block 0x%x\n", *(buf-1));
+        }
+    }
+
+}
+
+static void dvbsub_parse_object_segment(AVCodecContext *avctx,
+                                        uint8_t *buf, int buf_size)
+{
+    DVBSubContext *ctx = (DVBSubContext*) avctx->priv_data;
+
+    uint8_t *buf_end = buf + buf_size;
+    uint8_t *block;
+    int object_id;
+    DVBSubObject *object;
+    DVBSubObjectDisplay *display;
+    int top_field_len, bottom_field_len;
+
+    int coding_method, non_modifying_colour;
+
+    object_id = AV_RB16(buf);
+    buf += 2;
+
+    object = get_object(ctx, object_id);
+
+    if (!object)
+        return;
+
+    coding_method = ((*buf) >> 2) & 3;
+    non_modifying_colour = ((*buf++) >> 1) & 1;
+
+    if (coding_method == 0) {
+        top_field_len = AV_RB16(buf);
+        buf += 2;
+        bottom_field_len = AV_RB16(buf);
+        buf += 2;
+
+        if (buf + top_field_len + bottom_field_len > buf_end) {
+            av_log(avctx, AV_LOG_ERROR, "Field data size too large\n");
+            return;
+        }
+
+        for (display = object->display_list; display != 0; display = display->object_list_next) {
+            block = buf;
+
+            dvbsub_parse_pixel_data_block(avctx, display, block, top_field_len, 0,
+                                            non_modifying_colour);
+
+            if (bottom_field_len > 0)
+                block = buf + top_field_len;
+            else
+                bottom_field_len = top_field_len;
+
+            dvbsub_parse_pixel_data_block(avctx, display, block, bottom_field_len, 1,
+                                            non_modifying_colour);
+        }
+
+/*  } else if (coding_method == 1) {*/
+
+    } else {
+        av_log(avctx, AV_LOG_ERROR, "Unknown object coding %d\n", coding_method);
+    }
+
+}
+
+#define SCALEBITS 10
+#define ONE_HALF  (1 << (SCALEBITS - 1))
+#define FIX(x)    ((int) ((x) * (1<<SCALEBITS) + 0.5))
+
+#define YUV_TO_RGB1_CCIR(cb1, cr1)\
+{\
+    cb = (cb1) - 128;\
+    cr = (cr1) - 128;\
+    r_add = FIX(1.40200*255.0/224.0) * cr + ONE_HALF;\
+    g_add = - FIX(0.34414*255.0/224.0) * cb - FIX(0.71414*255.0/224.0) * cr + \
+            ONE_HALF;\
+    b_add = FIX(1.77200*255.0/224.0) * cb + ONE_HALF;\
+}
+
+#define YUV_TO_RGB2_CCIR(r, g, b, y1)\
+{\
+    y = ((y1) - 16) * FIX(255.0/219.0);\
+    r = cm[(y + r_add) >> SCALEBITS];\
+    g = cm[(y + g_add) >> SCALEBITS];\
+    b = cm[(y + b_add) >> SCALEBITS];\
+}
+
+
+static void dvbsub_parse_clut_segment(AVCodecContext *avctx,
+                                        uint8_t *buf, int buf_size)
+{
+    DVBSubContext *ctx = (DVBSubContext*) avctx->priv_data;
+
+    uint8_t *buf_end = buf + buf_size;
+    int clut_id;
+    DVBSubCLUT *clut;
+    int entry_id, depth , full_range;
+    int y, cr, cb, alpha;
+    int r, g, b, r_add, g_add, b_add;
+
+#ifdef DEBUG_PACKET_CONTENTS
+    int i;
+
+    av_log(avctx, AV_LOG_INFO, "DVB clut packet:\n");
+
+    for (i=0; i < buf_size; i++)
+    {
+        av_log(avctx, AV_LOG_INFO, "%02x ", buf[i]);
+        if (i % 16 == 15)
+            av_log(avctx, AV_LOG_INFO, "\n");
+    }
+
+    if (i % 16 != 0)
+        av_log(avctx, AV_LOG_INFO, "\n");
+
+#endif
+
+    clut_id = *buf++;
+    buf += 1;
+
+    clut = get_clut(ctx, clut_id);
+
+    if (clut == NULL) {
+        clut = av_malloc(sizeof(DVBSubCLUT));
+
+        memcpy(clut, &default_clut, sizeof(DVBSubCLUT));
+
+        clut->id = clut_id;
+
+        clut->next = ctx->clut_list;
+        ctx->clut_list = clut;
+    }
+
+    while (buf + 4 < buf_end)
+    {
+        entry_id = *buf++;
+
+        depth = (*buf) & 0xe0;
+
+        if (depth == 0) {
+            av_log(avctx, AV_LOG_ERROR, "Invalid clut depth 0x%x!\n", *buf);
+            return;
+        }
+
+        full_range = (*buf++) & 1;
+
+        if (full_range) {
+            y = *buf++;
+            cr = *buf++;
+            cb = *buf++;
+            alpha = *buf++;
+        } else {
+            y = buf[0] & 0xfc;
+            cr = (((buf[0] & 3) << 2) | ((buf[1] >> 6) & 3)) << 4;
+            cb = (buf[1] << 2) & 0xf0;
+            alpha = (buf[1] << 6) & 0xc0;
+
+            buf += 2;
+        }
+
+        if (y == 0)
+            alpha = 0xff;
+
+        YUV_TO_RGB1_CCIR(cb, cr);
+        YUV_TO_RGB2_CCIR(r, g, b, y);
+
+#ifdef DEBUG
+        av_log(avctx, AV_LOG_INFO, "clut %d := (%d,%d,%d,%d)\n", entry_id, r, g, b, alpha);
+#endif
+
+        if (depth & 0x80)
+            clut->clut4[entry_id] = RGBA(r,g,b,255 - alpha);
+        if (depth & 0x40)
+            clut->clut16[entry_id] = RGBA(r,g,b,255 - alpha);
+        if (depth & 0x20)
+            clut->clut256[entry_id] = RGBA(r,g,b,255 - alpha);
+    }
+}
+
+
+static void dvbsub_parse_region_segment(AVCodecContext *avctx,
+                                        uint8_t *buf, int buf_size)
+{
+    DVBSubContext *ctx = (DVBSubContext*) avctx->priv_data;
+
+    uint8_t *buf_end = buf + buf_size;
+    int region_id, object_id;
+    DVBSubRegion *region;
+    DVBSubObject *object;
+    DVBSubObjectDisplay *display;
+    int fill;
+
+    if (buf_size < 10)
+        return;
+
+    region_id = *buf++;
+
+    region = get_region(ctx, region_id);
+
+    if (region == NULL)
+    {
+        region = av_mallocz(sizeof(DVBSubRegion));
+
+        region->id = region_id;
+
+        region->next = ctx->region_list;
+        ctx->region_list = region;
+    }
+
+    fill = ((*buf++) >> 3) & 1;
+
+    region->width = AV_RB16(buf);
+    buf += 2;
+    region->height = AV_RB16(buf);
+    buf += 2;
+
+    if (region->width * region->height != region->buf_size) {
+        if (region->pbuf != 0)
+            av_free(region->pbuf);
+
+        region->buf_size = region->width * region->height;
+
+        region->pbuf = av_malloc(region->buf_size);
+
+        fill = 1;
+    }
+
+    region->depth = 1 << (((*buf++) >> 2) & 7);
+    region->clut = *buf++;
+
+    if (region->depth == 8)
+        region->bgcolour = *buf++;
+    else {
+        buf += 1;
+
+        if (region->depth == 4)
+            region->bgcolour = (((*buf++) >> 4) & 15);
+        else
+            region->bgcolour = (((*buf++) >> 2) & 3);
+    }
+
+#ifdef DEBUG
+    av_log(avctx, AV_LOG_INFO, "Region %d, (%dx%d)\n", region_id, region->width, region->height);
+#endif
+
+    if (fill) {
+        memset(region->pbuf, region->bgcolour, region->buf_size);
+#ifdef DEBUG
+        av_log(avctx, AV_LOG_INFO, "Fill region (%d)\n", region->bgcolour);
+#endif
+    }
+
+    delete_region_display_list(ctx, region);
+
+    while (buf + 5 < buf_end) {
+        object_id = AV_RB16(buf);
+        buf += 2;
+
+        object = get_object(ctx, object_id);
+
+        if (object == NULL) {
+            object = av_mallocz(sizeof(DVBSubObject));
+
+            object->id = object_id;
+            object->next = ctx->object_list;
+            ctx->object_list = object;
+        }
+
+        object->type = (*buf) >> 6;
+
+        display = av_mallocz(sizeof(DVBSubObjectDisplay));
+
+        display->object_id = object_id;
+        display->region_id = region_id;
+
+        display->x_pos = AV_RB16(buf) & 0xfff;
+        buf += 2;
+        display->y_pos = AV_RB16(buf) & 0xfff;
+        buf += 2;
+
+        if ((object->type == 1 || object->type == 2) && buf+1 < buf_end) {
+            display->fgcolour = *buf++;
+            display->bgcolour = *buf++;
+        }
+
+        display->region_list_next = region->display_list;
+        region->display_list = display;
+
+        display->object_list_next = object->display_list;
+        object->display_list = display;
+    }
+}
+
+static void dvbsub_parse_page_segment(AVCodecContext *avctx,
+                                        uint8_t *buf, int buf_size)
+{
+    DVBSubContext *ctx = (DVBSubContext*) avctx->priv_data;
+    DVBSubRegionDisplay *display;
+    DVBSubRegionDisplay *tmp_display_list, **tmp_ptr;
+
+    uint8_t *buf_end = buf + buf_size;
+    int region_id;
+    int page_state;
+
+    if (buf_size < 1)
+        return;
+
+    ctx->time_out = *buf++;
+    page_state = ((*buf++) >> 2) & 3;
+
+#ifdef DEBUG
+    av_log(avctx, AV_LOG_INFO, "Page time out %ds, state %d\n", ctx->time_out, page_state);
+#endif
+
+    if (page_state == 2)
+    {
+        delete_state(ctx);
+    }
+
+    tmp_display_list = ctx->display_list;
+    ctx->display_list = NULL;
+    ctx->display_list_size = 0;
+
+    while (buf + 5 < buf_end) {
+        region_id = *buf++;
+        buf += 1;
+
+        display = tmp_display_list;
+        tmp_ptr = &tmp_display_list;
+
+        while (display != NULL && display->region_id != region_id) {
+            tmp_ptr = &display->next;
+            display = display->next;
+        }
+
+        if (display == NULL)
+            display = av_mallocz(sizeof(DVBSubRegionDisplay));
+
+        display->region_id = region_id;
+
+        display->x_pos = AV_RB16(buf);
+        buf += 2;
+        display->y_pos = AV_RB16(buf);
+        buf += 2;
+
+        *tmp_ptr = display->next;
+
+        display->next = ctx->display_list;
+        ctx->display_list = display;
+        ctx->display_list_size++;
+
+#ifdef DEBUG
+        av_log(avctx, AV_LOG_INFO, "Region %d, (%d,%d)\n", region_id, display->x_pos, display->y_pos);
+#endif
+    }
+
+    while (tmp_display_list != 0) {
+        display = tmp_display_list;
+
+        tmp_display_list = display->next;
+
+        av_free(display);
+    }
+
+}
+
+
+#ifdef DEBUG_SAVE_IMAGES
+static void save_display_set(DVBSubContext *ctx)
+{
+    DVBSubRegion *region;
+    DVBSubRegionDisplay *display;
+    DVBSubCLUT *clut;
+    uint32_t *clut_table;
+    int x_pos, y_pos, width, height;
+    int x, y, y_off, x_off;
+    uint32_t *pbuf;
+    char filename[32];
+    static int fileno_index = 0;
+
+    x_pos = -1;
+    y_pos = -1;
+    width = 0;
+    height = 0;
+
+    for (display = ctx->display_list; display != NULL; display = display->next) {
+        region = get_region(ctx, display->region_id);
+
+        if (x_pos == -1) {
+            x_pos = display->x_pos;
+            y_pos = display->y_pos;
+            width = region->width;
+            height = region->height;
+        } else {
+            if (display->x_pos < x_pos) {
+                width += (x_pos - display->x_pos);
+                x_pos = display->x_pos;
+            }
+
+            if (display->y_pos < y_pos) {
+                height += (y_pos - display->y_pos);
+                y_pos = display->y_pos;
+            }
+
+            if (display->x_pos + region->width > x_pos + width) {
+                width = display->x_pos + region->width - x_pos;
+            }
+
+            if (display->y_pos + region->height > y_pos + height) {
+                height = display->y_pos + region->height - y_pos;
+            }
+        }
+    }
+
+    if (x_pos >= 0) {
+
+        pbuf = av_malloc(width * height * 4);
+
+        for (display = ctx->display_list; display != NULL; display = display->next) {
+            region = get_region(ctx, display->region_id);
+
+            x_off = display->x_pos - x_pos;
+            y_off = display->y_pos - y_pos;
+
+            clut = get_clut(ctx, region->clut);
+
+            if (clut == 0)
+                clut = &default_clut;
+
+            switch (region->depth) {
+            case 2:
+                clut_table = clut->clut4;
+                break;
+            case 8:
+                clut_table = clut->clut256;
+                break;
+            case 4:
+            default:
+                clut_table = clut->clut16;
+                break;
+            }
+
+            for (y = 0; y < region->height; y++) {
+                for (x = 0; x < region->width; x++) {
+                    pbuf[((y + y_off) * width) + x_off + x] =
+                        clut_table[region->pbuf[y * region->width + x]];
+                }
+            }
+
+        }
+
+        snprintf(filename, 32, "dvbs.%d", fileno_index);
+
+        png_save2(filename, pbuf, width, height);
+
+        av_free(pbuf);
+    }
+
+    fileno_index++;
+}
+#endif
+
+static int dvbsub_display_end_segment(AVCodecContext *avctx, uint8_t *buf,
+                                        int buf_size, AVSubtitle *sub)
+{
+    DVBSubContext *ctx = (DVBSubContext*) avctx->priv_data;
+
+    DVBSubRegion *region;
+    DVBSubRegionDisplay *display;
+    AVSubtitleRect *rect;
+    DVBSubCLUT *clut;
+    uint32_t *clut_table;
+    int i;
+
+    sub->rects = NULL;
+    sub->start_display_time = 0;
+    sub->end_display_time = ctx->time_out * 1000;
+    sub->format = 0;
+
+    sub->num_rects = ctx->display_list_size;
+
+    if (sub->num_rects > 0)
+        sub->rects = av_mallocz(sizeof(AVSubtitleRect) * sub->num_rects);
+
+    i = 0;
+
+    for (display = ctx->display_list; display != NULL; display = display->next) {
+        region = get_region(ctx, display->region_id);
+        rect = &sub->rects[i];
+
+        if (region == NULL)
+            continue;
+
+        rect->x = display->x_pos;
+        rect->y = display->y_pos;
+        rect->w = region->width;
+        rect->h = region->height;
+        rect->nb_colors = 16;
+        rect->linesize = region->width;
+
+        clut = get_clut(ctx, region->clut);
+
+        if (clut == NULL)
+            clut = &default_clut;
+
+        switch (region->depth) {
+        case 2:
+            clut_table = clut->clut4;
+            break;
+        case 8:
+            clut_table = clut->clut256;
+            break;
+        case 4:
+        default:
+            clut_table = clut->clut16;
+            break;
+        }
+
+        rect->rgba_palette = av_malloc((1 << region->depth) * sizeof(uint32_t));
+        memcpy(rect->rgba_palette, clut_table, (1 << region->depth) * sizeof(uint32_t));
+
+        rect->bitmap = av_malloc(region->buf_size);
+        memcpy(rect->bitmap, region->pbuf, region->buf_size);
+
+        i++;
+    }
+
+    sub->num_rects = i;
+
+#ifdef DEBUG_SAVE_IMAGES
+    save_display_set(ctx);
+#endif
+
+    return 1;
+}
+
+static int dvbsub_decode(AVCodecContext *avctx,
+                         void *data, int *data_size,
+                         uint8_t *buf, int buf_size)
+{
+    DVBSubContext *ctx = (DVBSubContext*) avctx->priv_data;
+    AVSubtitle *sub = (AVSubtitle*) data;
+    uint8_t *p, *p_end;
+    int segment_type;
+    int page_id;
+    int segment_length;
+
+#ifdef DEBUG_PACKET_CONTENTS
+    int i;
+
+    av_log(avctx, AV_LOG_INFO, "DVB sub packet:\n");
+
+    for (i=0; i < buf_size; i++)
+    {
+        av_log(avctx, AV_LOG_INFO, "%02x ", buf[i]);
+        if (i % 16 == 15)
+            av_log(avctx, AV_LOG_INFO, "\n");
+    }
+
+    if (i % 16 != 0)
+        av_log(avctx, AV_LOG_INFO, "\n");
+
+#endif
+
+    if (buf_size <= 2)
+        return -1;
+
+    p = buf;
+    p_end = buf + buf_size;
+
+    while (p < p_end && *p == 0x0f)
+    {
+        p += 1;
+        segment_type = *p++;
+        page_id = AV_RB16(p);
+        p += 2;
+        segment_length = AV_RB16(p);
+        p += 2;
+
+        if (page_id == ctx->composition_id || page_id == ctx->ancillary_id) {
+            switch (segment_type) {
+            case DVBSUB_PAGE_SEGMENT:
+                dvbsub_parse_page_segment(avctx, p, segment_length);
+                break;
+            case DVBSUB_REGION_SEGMENT:
+                dvbsub_parse_region_segment(avctx, p, segment_length);
+                break;
+            case DVBSUB_CLUT_SEGMENT:
+                dvbsub_parse_clut_segment(avctx, p, segment_length);
+                break;
+            case DVBSUB_OBJECT_SEGMENT:
+                dvbsub_parse_object_segment(avctx, p, segment_length);
+                break;
+            case DVBSUB_DISPLAY_SEGMENT:
+                *data_size = dvbsub_display_end_segment(avctx, p, segment_length, sub);
+                break;
+            default:
+#ifdef DEBUG
+                av_log(avctx, AV_LOG_INFO, "Subtitling segment type 0x%x, page id %d, length %d\n",
+                        segment_type, page_id, segment_length);
+#endif
+                break;
+            }
+        }
+
+        p += segment_length;
+    }
+
+    if (p != p_end)
+    {
+#ifdef DEBUG
+        av_log(avctx, AV_LOG_INFO, "Junk at end of packet\n");
+#endif
+        return -1;
+    }
+
+    return buf_size;
+}
+
+
+AVCodec dvbsub_decoder = {
+    "dvbsub",
+    CODEC_TYPE_SUBTITLE,
+    CODEC_ID_DVB_SUBTITLE,
+    sizeof(DVBSubContext),
+    dvbsub_init_decoder,
+    NULL,
+    dvbsub_close_decoder,
+    dvbsub_decode,
+};

Modified: branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec/ffconf.c
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec/ffconf.c	2007-07-17 02:24:45 UTC (rev 3401)
+++ branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec/ffconf.c	2007-07-17 06:06:22 UTC (rev 3402)
@@ -33,6 +33,17 @@
     DECLARE_DECODER (MJPEG, mjpeg);
     DECLARE_DECODER(WMAV2, wmav2);
     DECLARE_DECODER (DVVIDEO, dvvideo);
+    DECLARE_DECODER (HUFFYUV, huffyuv);
+    DECLARE_DECODER (FFVHUFF, ffvhuff);
+    DECLARE_DECODER(SVQ3, svq3);
+    DECLARE_DECODER(TSCC, tscc);
+    DECLARE_DECODER(QDM2, qdm2);
+    DECLARE_DECODER (FFV1, ffv1);
+    DECLARE_DECODER (MPEG1VIDEO, mpeg1video);
+    DECLARE_DECODER (MPEG2VIDEO, mpeg2video);
+    DECLARE_DECODER (RV10, rv10);
+    DECLARE_DECODER (RV20, rv20);
+    DECLARE_DECODER (DVBSUB, dvbsub);
 
 #undef DECLARE_DECODER
 #define DECLARE_DECODER(a,b); printf("#define ENABLE_"#a"_DECODER 0\n"); 
@@ -65,13 +76,11 @@
     DECLARE_DECODER(SMACKER, smacker);
     DECLARE_DECODER(SMC, smc);
     DECLARE_DECODER(SP5X, sp5x);
-    DECLARE_DECODER(SVQ3, svq3);
     DECLARE_DECODER(THEORA, theora);
     DECLARE_DECODER(THP, thp);
     DECLARE_DECODER(TIERTEXSEQVIDEO, tiertexseqvideo);
     DECLARE_DECODER(TRUEMOTION1, truemotion1);
     DECLARE_DECODER(TRUEMOTION2, truemotion2);
-    DECLARE_DECODER(TSCC, tscc);
     DECLARE_DECODER(TXD, txd);
     DECLARE_DECODER(ULTI, ulti);
     DECLARE_DECODER(VMDVIDEO, vmdvideo);
@@ -95,7 +104,6 @@
     DECLARE_DECODER(MP3ADU, mp3adu);
     DECLARE_DECODER(MP3ON4, mp3on4);
     DECLARE_DECODER(MPC7, mpc7);
-    DECLARE_DECODER(QDM2, qdm2);
     DECLARE_DECODER(RA_144, ra_144);
     DECLARE_DECODER(RA_288, ra_288);
     DECLARE_DECODER(SHORTEN, shorten);
@@ -113,23 +121,16 @@
     DECLARE_DECODER (ASV1, asv1);
     DECLARE_DECODER (ASV2, asv2);
     DECLARE_DECODER (BMP, bmp);
-    DECLARE_DECODER (FFV1, ffv1);
-    DECLARE_DECODER (FFVHUFF, ffvhuff);
     DECLARE_DECODER (FLASHSV, flashsv);
     DECLARE_DECODER (FLV, flv);
     DECLARE_DECODER (GIF, gif);
     DECLARE_DECODER (H261, h261);
     DECLARE_DECODER (H263, h263);
-    DECLARE_DECODER (HUFFYUV, huffyuv);
     DECLARE_DECODER (JPEGLS, jpegls);
-    DECLARE_DECODER (MPEG1VIDEO, mpeg1video);
-    DECLARE_DECODER (MPEG2VIDEO, mpeg2video);
     DECLARE_DECODER (PNG, png);
     DECLARE_DECODER (QTRLE, qtrle);
     DECLARE_DECODER (RAWVIDEO, rawvideo);
     DECLARE_DECODER (ROQ, roq);
-    DECLARE_DECODER (RV10, rv10);
-    DECLARE_DECODER (RV20, rv20);
     DECLARE_DECODER (SGI, sgi);
     DECLARE_DECODER (SNOW, snow);
     DECLARE_DECODER (SVQ1, svq1);
@@ -184,7 +185,6 @@
     DECLARE_DECODER (ADPCM_SWF, adpcm_swf);
     DECLARE_DECODER (ADPCM_XA, adpcm_xa);
     DECLARE_DECODER (ADPCM_YAMAHA, adpcm_yamaha);
-    DECLARE_DECODER (DVBSUB, dvbsub);
     DECLARE_DECODER (DVDSUB, dvdsub);
 
 #define DECLARE_PARSER(a,b); printf("#define ENABLE_"#a"_PARSER 1\n"); 
@@ -221,6 +221,8 @@
     DECLARE_ENCODER (SNOW, snow);
     DECLARE_ENCODER (MP2, mp2);
     DECLARE_ENCODER (DVVIDEO, dvvideo);
+    DECLARE_ENCODER (HUFFYUV, huffyuv);
+    DECLARE_ENCODER (DVBSUB, dvbsub);
 
 #undef DECLARE_ENCODER
 #define DECLARE_ENCODER(a,b); printf("#define ENABLE_"#a"_ENCODER 0\n"); 
@@ -245,7 +247,6 @@
     DECLARE_ENCODER (FLV, flv);
     DECLARE_ENCODER (GIF, gif);
     DECLARE_ENCODER (H261, h261);
-    DECLARE_ENCODER (HUFFYUV, huffyuv);
     DECLARE_ENCODER (JPEGLS, jpegls);
     DECLARE_ENCODER (MSMPEG4V1, msmpeg4v1);
     DECLARE_ENCODER (MSMPEG4V2, msmpeg4v2);
@@ -308,7 +309,6 @@
     DECLARE_ENCODER (ADPCM_SWF, adpcm_swf);
     DECLARE_ENCODER (ADPCM_XA, adpcm_xa);
     DECLARE_ENCODER (ADPCM_YAMAHA, adpcm_yamaha);
-    DECLARE_ENCODER (DVBSUB, dvbsub);
     DECLARE_ENCODER (DVDSUB, dvdsub);
 
 printf("#define ENABLE_LIBVORBIS_ENCODER        0\n");

Modified: branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec/ffconf.h
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec/ffconf.h	2007-07-17 02:24:45 UTC (rev 3401)
+++ branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec/ffconf.h	2007-07-17 06:06:22 UTC (rev 3402)
@@ -24,6 +24,17 @@
 #define ENABLE_MJPEG_DECODER 1
 #define ENABLE_WMAV2_DECODER 1
 #define ENABLE_DVVIDEO_DECODER 1
+#define ENABLE_HUFFYUV_DECODER 1
+#define ENABLE_FFVHUFF_DECODER 1
+#define ENABLE_SVQ3_DECODER 1
+#define ENABLE_TSCC_DECODER 1
+#define ENABLE_QDM2_DECODER 1
+#define ENABLE_FFV1_DECODER 1
+#define ENABLE_MPEG1VIDEO_DECODER 1
+#define ENABLE_MPEG2VIDEO_DECODER 1
+#define ENABLE_RV10_DECODER 1
+#define ENABLE_RV20_DECODER 1
+#define ENABLE_DVBSUB_DECODER 1
 #define ENABLE_AASC_DECODER 0
 #define ENABLE_AVS_DECODER 0
 #define ENABLE_BETHSOFTVID_DECODER 0
@@ -52,13 +63,11 @@
 #define ENABLE_SMACKER_DECODER 0
 #define ENABLE_SMC_DECODER 0
 #define ENABLE_SP5X_DECODER 0
-#define ENABLE_SVQ3_DECODER 0
 #define ENABLE_THEORA_DECODER 0
 #define ENABLE_THP_DECODER 0
 #define ENABLE_TIERTEXSEQVIDEO_DECODER 0
 #define ENABLE_TRUEMOTION1_DECODER 0
 #define ENABLE_TRUEMOTION2_DECODER 0
-#define ENABLE_TSCC_DECODER 0
 #define ENABLE_TXD_DECODER 0
 #define ENABLE_ULTI_DECODER 0
 #define ENABLE_VMDVIDEO_DECODER 0
@@ -82,7 +91,6 @@
 #define ENABLE_MP3ADU_DECODER 0
 #define ENABLE_MP3ON4_DECODER 0
 #define ENABLE_MPC7_DECODER 0
-#define ENABLE_QDM2_DECODER 0
 #define ENABLE_RA_144_DECODER 0
 #define ENABLE_RA_288_DECODER 0
 #define ENABLE_SHORTEN_DECODER 0
@@ -99,23 +107,16 @@
 #define ENABLE_ASV1_DECODER 0
 #define ENABLE_ASV2_DECODER 0
 #define ENABLE_BMP_DECODER 0
-#define ENABLE_FFV1_DECODER 0
-#define ENABLE_FFVHUFF_DECODER 0
 #define ENABLE_FLASHSV_DECODER 0
 #define ENABLE_FLV_DECODER 0
 #define ENABLE_GIF_DECODER 0
 #define ENABLE_H261_DECODER 0
 #define ENABLE_H263_DECODER 0
-#define ENABLE_HUFFYUV_DECODER 0
 #define ENABLE_JPEGLS_DECODER 0
-#define ENABLE_MPEG1VIDEO_DECODER 0
-#define ENABLE_MPEG2VIDEO_DECODER 0
 #define ENABLE_PNG_DECODER 0
 #define ENABLE_QTRLE_DECODER 0
 #define ENABLE_RAWVIDEO_DECODER 0
 #define ENABLE_ROQ_DECODER 0
-#define ENABLE_RV10_DECODER 0
-#define ENABLE_RV20_DECODER 0
 #define ENABLE_SGI_DECODER 0
 #define ENABLE_SNOW_DECODER 0
 #define ENABLE_SVQ1_DECODER 0
@@ -170,7 +171,6 @@
 #define ENABLE_ADPCM_SWF_DECODER 0
 #define ENABLE_ADPCM_XA_DECODER 0
 #define ENABLE_ADPCM_YAMAHA_DECODER 0
-#define ENABLE_DVBSUB_DECODER 0
 #define ENABLE_DVDSUB_DECODER 0
 #define ENABLE_H263_PARSER 1
 #define ENABLE_H264_PARSER 1
@@ -200,6 +200,8 @@
 #define ENABLE_SNOW_ENCODER 1
 #define ENABLE_MP2_ENCODER 1
 #define ENABLE_DVVIDEO_ENCODER 1
+#define ENABLE_HUFFYUV_ENCODER 1
+#define ENABLE_DVBSUB_ENCODER 1
 #define ENABLE_LIBX264_ENCODER 0
 #define ENABLE_LIBXVID_ENCODER 0
 #define ENABLE_LJPEG_ENCODER 0
@@ -219,7 +221,6 @@
 #define ENABLE_FLV_ENCODER 0
 #define ENABLE_GIF_ENCODER 0
 #define ENABLE_H261_ENCODER 0
-#define ENABLE_HUFFYUV_ENCODER 0
 #define ENABLE_JPEGLS_ENCODER 0
 #define ENABLE_MSMPEG4V1_ENCODER 0
 #define ENABLE_MSMPEG4V2_ENCODER 0
@@ -282,7 +283,6 @@
 #define ENABLE_ADPCM_SWF_ENCODER 0
 #define ENABLE_ADPCM_XA_ENCODER 0
 #define ENABLE_ADPCM_YAMAHA_ENCODER 0
-#define ENABLE_DVBSUB_ENCODER 0
 #define ENABLE_DVDSUB_ENCODER 0
 #define ENABLE_LIBVORBIS_ENCODER        0
 #define ENABLE_LIBVORBIS_DECODER        0



From gruntster at mail.berlios.de  Tue Jul 17 12:32:23 2007
From: gruntster at mail.berlios.de (gruntster at mail.berlios.de)
Date: Tue, 17 Jul 2007 12:32:23 +0200
Subject: [Avidemux-svn-commit] r3403 - in
	branches/avidemux_2.4_branch/avidemux: ADM_outputs/oplug_avi
	ADM_userInterfaces/ADM_GTK/ADM_toolkit_gtk
Message-ID: <200707171032.l6HAWNtS005978@sheep.berlios.de>

Author: gruntster
Date: 2007-07-17 12:32:08 +0200 (Tue, 17 Jul 2007)
New Revision: 3403

Modified:
   branches/avidemux_2.4_branch/avidemux/ADM_outputs/oplug_avi/op_aviwrite.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_toolkit_gtk/TLK_filesel.cpp
Log:
fix mem leak (avi writer)

Modified: branches/avidemux_2.4_branch/avidemux/ADM_outputs/oplug_avi/op_aviwrite.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_outputs/oplug_avi/op_aviwrite.cpp	2007-07-17 06:06:22 UTC (rev 3402)
+++ branches/avidemux_2.4_branch/avidemux/ADM_outputs/oplug_avi/op_aviwrite.cpp	2007-07-17 10:32:08 UTC (rev 3403)
@@ -81,6 +81,23 @@
 
 // MOD Feb 2005 by GMV: remove ODML index
 aviWrite::~aviWrite(){
+	if (myindex)
+		delete myindex;
+
+	if (LAll)
+		delete LAll;
+
+	if (LMovie)
+		delete LMovie;
+
+	if (LMain)
+		delete LMain;
+
+	myindex = NULL;
+	LAll = NULL;
+	LMovie = NULL;
+	LMain = NULL;
+
 	odml_destroy_index();
 }
 // END MOD Feb 2005 by GMV

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_toolkit_gtk/TLK_filesel.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_toolkit_gtk/TLK_filesel.cpp	2007-07-17 06:06:22 UTC (rev 3402)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_toolkit_gtk/TLK_filesel.cpp	2007-07-17 10:32:08 UTC (rev 3403)
@@ -398,7 +398,6 @@
 			}
 			fclose(fd);
 			cb(name);
-			ADM_dealloc(name);
 		} // no callback -> return value
 	}
 }
@@ -495,6 +494,7 @@
         if(cb)
         {
                 fileReadWrite(cb, rw, name);
+				ADM_dealloc(name);
         }
         else
         {



From gruntster at mail.berlios.de  Tue Jul 17 17:35:02 2007
From: gruntster at mail.berlios.de (gruntster at mail.berlios.de)
Date: Tue, 17 Jul 2007 17:35:02 +0200
Subject: [Avidemux-svn-commit] r3404 -
	branches/avidemux_2.4_branch/avidemux/ADM_audiodevice
Message-ID: <200707171535.l6HFZ279005803@sheep.berlios.de>

Author: gruntster
Date: 2007-07-17 17:34:53 +0200 (Tue, 17 Jul 2007)
New Revision: 3404

Modified:
   branches/avidemux_2.4_branch/avidemux/ADM_audiodevice/ADM_deviceWin32.cpp
Log:
[Win32] use a dynamically sized buffer for audio device

Modified: branches/avidemux_2.4_branch/avidemux/ADM_audiodevice/ADM_deviceWin32.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_audiodevice/ADM_deviceWin32.cpp	2007-07-17 10:32:08 UTC (rev 3403)
+++ branches/avidemux_2.4_branch/avidemux/ADM_audiodevice/ADM_deviceWin32.cpp	2007-07-17 15:34:53 UTC (rev 3404)
@@ -27,9 +27,9 @@
 #include "ADM_osSupport/ADM_debugID.h"
 #include "ADM_osSupport/ADM_debug.h"
 
-#define BUCKET_SIZE 16384
 #define NB_BUCKET 8
 
+static uint32_t bucketSize;
 static HWAVEOUT myDevice;
 static MMRESULT myError;
 
@@ -75,7 +75,7 @@
 
 uint8_t win32AudioDevice::init(uint8_t channels, uint32_t fq) 
 {
-	printf("[Win32] Opening Audio, fq=%d\n",fq);
+	printf("[Win32] Opening Audio, channels=%u freq=%u\n",channels, fq);
 
 	if (_inUse) 
 	{
@@ -85,6 +85,7 @@
 
 	_inUse = 1;
 	_channels = channels;
+	bucketSize = channels * fq;
 
 	WAVEFORMATEX wav;
 
@@ -110,13 +111,14 @@
 	{
 		memset(&waveHdr[i], 0, sizeof(WAVEHDR));
 
-		waveHdr[i].lpData = (char*)new uint8_t[BUCKET_SIZE];
+		waveHdr[i].dwBufferLength = bucketSize;
+		waveHdr[i].lpData = (char*)new uint8_t[bucketSize];
 
 		if (waveOutPrepareHeader(myDevice, &waveHdr[i], sizeof(WAVEHDR)) != MMSYSERR_NOERROR)
 			printf("[Win32] waveOutPrepareHeader error\n");
 
-		if (waveOutWrite(myDevice, &waveHdr[i], sizeof(WAVEHDR)) != MMSYSERR_NOERROR)
-			printf("[Win32] waveOutWrite error\n");
+		waveHdr[i].dwBufferLength = 0;
+		waveHdr[i].dwFlags |= WHDR_DONE;
 	}
 
 	return 1;
@@ -136,6 +138,9 @@
 
 uint8_t win32AudioDevice::play(uint32_t len, float *data)
 {
+	if (len == 0)
+		return 1;
+
 	dither16(data, len, _channels);
 	len *= 2;
 	uint8_t success = 0;
@@ -146,8 +151,8 @@
 		{
 			waveHdr[i].dwFlags &= ~WHDR_DONE;
 
-			if (len > BUCKET_SIZE)
-				waveHdr[i].dwBufferLength = BUCKET_SIZE;
+			if (len > bucketSize)
+				waveHdr[i].dwBufferLength = bucketSize;
 			else
 				waveHdr[i].dwBufferLength = len;
 
@@ -165,6 +170,12 @@
 			break;
 	}
 
+	if (len != 0)
+	{
+		printf("[Win32] No audio buffer available, %u bytes discarded\n", len);
+		return 0;
+	}
+
 	return success;
 }
 



From gruntster at mail.berlios.de  Tue Jul 17 18:31:23 2007
From: gruntster at mail.berlios.de (gruntster at mail.berlios.de)
Date: Tue, 17 Jul 2007 18:31:23 +0200
Subject: [Avidemux-svn-commit] r3405 - in
	branches/avidemux_2.4_branch/avidemux: .
	ADM_userInterfaces/ADM_GTK/ADM_dialogFactory
Message-ID: <200707171631.l6HGVNB3010854@sheep.berlios.de>

Author: gruntster
Date: 2007-07-17 18:31:11 +0200 (Tue, 17 Jul 2007)
New Revision: 3405

Modified:
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialogFactory/FAC_menu.cpp
   branches/avidemux_2.4_branch/avidemux/gtk_gui.cpp
Log:
fix mem leaks (gtk)

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialogFactory/FAC_menu.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialogFactory/FAC_menu.cpp	2007-07-17 15:34:53 UTC (rev 3404)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialogFactory/FAC_menu.cpp	2007-07-17 16:31:11 UTC (rev 3405)
@@ -55,6 +55,7 @@
   for(int i=0;i<nbMenu;i++)
       delete menus[i];
   delete [] menus;
+  delete dyna;
   
 }
 void diaElemMenu::setMe(void *dialog, void *opaque,uint32_t line)

Modified: branches/avidemux_2.4_branch/avidemux/gtk_gui.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/gtk_gui.cpp	2007-07-17 15:34:53 UTC (rev 3404)
+++ branches/avidemux_2.4_branch/avidemux/gtk_gui.cpp	2007-07-17 16:31:11 UTC (rev 3405)
@@ -1641,6 +1641,18 @@
 		currentaudiostream=NULL;
 	}
 
+	if (currentAudioName)
+	{
+		ADM_dealloc(currentAudioName);
+		currentAudioName = NULL;
+	}
+
+	if (actual_workbench_file)
+	{
+		ADM_dealloc(actual_workbench_file);
+		actual_workbench_file = NULL;
+	}
+
 	if (video_body)
 	{
 		delete video_body;
@@ -1651,11 +1663,6 @@
 	admPreview::cleanUp();
 }
 
-extern uint8_t selecEncoder (uint8_t * codec);
-
-
-
-
 #warning fixme
 
 



From mean at mail.berlios.de  Tue Jul 17 20:05:58 2007
From: mean at mail.berlios.de (mean at BerliOS)
Date: Tue, 17 Jul 2007 20:05:58 +0200
Subject: [Avidemux-svn-commit] r3406 -
	branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec
Message-ID: <200707171805.l6HI5wJL032087@sheep.berlios.de>

Author: mean
Date: 2007-07-17 20:05:57 +0200 (Tue, 17 Jul 2007)
New Revision: 3406

Modified:
   branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec/ffconf.c
   branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec/ffconf.h
Log:
[LAV] re-enable wmv1 wmv2

Modified: branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec/ffconf.c
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec/ffconf.c	2007-07-17 16:31:11 UTC (rev 3405)
+++ branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec/ffconf.c	2007-07-17 18:05:57 UTC (rev 3406)
@@ -24,6 +24,8 @@
     DECLARE_DECODER(VP6, vp6);
     DECLARE_DECODER(VP6F, vp6f);
     DECLARE_DECODER(WMV3, wmv3);
+    DECLARE_DECODER (WMV1, wmv1);
+    DECLARE_DECODER (WMV2, wmv2);
     DECLARE_DECODER(VP3, vp3);
     DECLARE_DECODER (MPEG4, mpeg4);
     DECLARE_DECODER (MSMPEG4V1, msmpeg4v1);
@@ -136,8 +138,6 @@
     DECLARE_DECODER (SVQ1, svq1);
     DECLARE_DECODER (TARGA, targa);
     DECLARE_DECODER (TIFF, tiff);
-    DECLARE_DECODER (WMV1, wmv1);
-    DECLARE_DECODER (WMV2, wmv2);
     DECLARE_DECODER (ZLIB, zlib);
     DECLARE_DECODER (ZMBV, zmbv);
     DECLARE_DECODER (FLAC, flac);

Modified: branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec/ffconf.h
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec/ffconf.h	2007-07-17 16:31:11 UTC (rev 3405)
+++ branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec/ffconf.h	2007-07-17 18:05:57 UTC (rev 3406)
@@ -15,6 +15,8 @@
 #define ENABLE_VP6_DECODER 1
 #define ENABLE_VP6F_DECODER 1
 #define ENABLE_WMV3_DECODER 1
+#define ENABLE_WMV1_DECODER 1
+#define ENABLE_WMV2_DECODER 1
 #define ENABLE_VP3_DECODER 1
 #define ENABLE_MPEG4_DECODER 1
 #define ENABLE_MSMPEG4V1_DECODER 1
@@ -122,8 +124,6 @@
 #define ENABLE_SVQ1_DECODER 0
 #define ENABLE_TARGA_DECODER 0
 #define ENABLE_TIFF_DECODER 0
-#define ENABLE_WMV1_DECODER 0
-#define ENABLE_WMV2_DECODER 0
 #define ENABLE_ZLIB_DECODER 0
 #define ENABLE_ZMBV_DECODER 0
 #define ENABLE_FLAC_DECODER 0



From gruntster at mail.berlios.de  Tue Jul 17 20:35:17 2007
From: gruntster at mail.berlios.de (gruntster at mail.berlios.de)
Date: Tue, 17 Jul 2007 20:35:17 +0200
Subject: [Avidemux-svn-commit] r3407 -
	branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI
Message-ID: <200707171835.l6HIZHxd001614@sheep.berlios.de>

Author: gruntster
Date: 2007-07-17 20:35:10 +0200 (Tue, 17 Jul 2007)
New Revision: 3407

Modified:
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp
Log:
fix mem leak (prefs dialog)

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp	2007-07-17 18:05:57 UTC (rev 3406)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp	2007-07-17 18:35:10 UTC (rev 3407)
@@ -428,6 +428,11 @@
 				initSdl();
 			#endif
 	}
+
+	ADM_dealloc(alsaDevice);
+	ADM_dealloc(filterPath);
+	ADM_dealloc(globalGlyphName);
+
 	return 1;
 }
 extern int DIA_getMPParams( uint32_t *pplevel, uint32_t *ppstrength,uint32_t *swap);



From mean at mail.berlios.de  Tue Jul 17 21:12:52 2007
From: mean at mail.berlios.de (mean at BerliOS)
Date: Tue, 17 Jul 2007 21:12:52 +0200
Subject: [Avidemux-svn-commit] r3409 -
	branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_libswscale
Message-ID: <200707171912.l6HJCqDI003477@sheep.berlios.de>

Author: mean
Date: 2007-07-17 21:12:51 +0200 (Tue, 17 Jul 2007)
New Revision: 3409

Modified:
   branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_libswscale/swscale.h
Log:
[LAV] Put back extern cplusplus

Modified: branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_libswscale/swscale.h
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_libswscale/swscale.h	2007-07-17 18:49:16 UTC (rev 3408)
+++ branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_libswscale/swscale.h	2007-07-17 19:12:51 UTC (rev 3409)
@@ -20,6 +20,9 @@
 
 #ifndef SWSCALE_H
 #define SWSCALE_H
+#ifdef __cplusplus
+extern "C" {
+#endif
 
 /**
  * @file swscale.h
@@ -137,5 +140,8 @@
                                         int srcW, int srcH, int srcFormat,
                                         int dstW, int dstH, int dstFormat, int flags,
                                         SwsFilter *srcFilter, SwsFilter *dstFilter, double *param);
+#ifdef __cplusplus
+}
+#endif
 
 #endif



From gruntster at mail.berlios.de  Wed Jul 18 04:12:11 2007
From: gruntster at mail.berlios.de (gruntster at mail.berlios.de)
Date: Wed, 18 Jul 2007 04:12:11 +0200
Subject: [Avidemux-svn-commit] r3410 - branches/avidemux_2.4_branch/avidemux
Message-ID: <200707180212.l6I2CBOo013039@sheep.berlios.de>

Author: gruntster
Date: 2007-07-18 04:12:00 +0200 (Wed, 18 Jul 2007)
New Revision: 3410

Modified:
   branches/avidemux_2.4_branch/avidemux/gtk_gui.cpp
Log:
fix mem leak (large leak when opening a file with audio and then one without)

Modified: branches/avidemux_2.4_branch/avidemux/gtk_gui.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/gtk_gui.cpp	2007-07-17 19:12:51 UTC (rev 3409)
+++ branches/avidemux_2.4_branch/avidemux/gtk_gui.cpp	2007-07-18 02:12:00 UTC (rev 3410)
@@ -1469,12 +1469,9 @@
 {
   if (currentaudiostream)
     {
-      if (currentaudiostream->isDestroyable ())
-        
-      {
 	delete currentaudiostream;
         currentaudiostream=NULL;
-      }
+
       currentAudioSource=AudioNone;
       if(currentAudioName) ADM_dealloc(currentAudioName);
       currentAudioName=NULL;
@@ -2407,7 +2404,7 @@
       avifileinfo = (aviInfo *) NULL;
       video_body->cleanup ();
       curframe = 0;
-      currentaudiostream = NULL;
+	  aviaudiostream=NULL;
       A_changeAudioStream (NULL, AudioNone,NULL);
       filterCleanUp ();
       return 1;



From gruntster at mail.berlios.de  Wed Jul 18 13:33:39 2007
From: gruntster at mail.berlios.de (gruntster at mail.berlios.de)
Date: Wed, 18 Jul 2007 13:33:39 +0200
Subject: [Avidemux-svn-commit] r3411 -
	branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_libpostproc
Message-ID: <200707181133.l6IBXd4s010866@sheep.berlios.de>

Author: gruntster
Date: 2007-07-18 13:33:31 +0200 (Wed, 18 Jul 2007)
New Revision: 3411

Modified:
   branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_libpostproc/CMakeLists.txt
Log:
[LAV] stop CMake using SSE instructions with 32-bit compiler for libpostproc (matches automake)

Modified: branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_libpostproc/CMakeLists.txt
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_libpostproc/CMakeLists.txt	2007-07-18 02:12:00 UTC (rev 3410)
+++ branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_libpostproc/CMakeLists.txt	2007-07-18 11:33:31 UTC (rev 3411)
@@ -13,5 +13,8 @@
 
 
 ################################
-add_definitions(-I.. -DHAVE_AV_CONFIG_H  -O3 -I../.. -I../ADM_lavutil -Drestrict=__restrict__ -fomit-frame-pointer -msse )
+add_definitions(-I.. -DHAVE_AV_CONFIG_H  -O3 -I../.. -I../ADM_lavutil -Drestrict=__restrict__ -fomit-frame-pointer)
 
+IF(ARCH_X86_64)
+add_definitions(-msse)
+ENDIF(ARCH_X86_64)
\ No newline at end of file



From gruntster at mail.berlios.de  Wed Jul 18 14:17:57 2007
From: gruntster at mail.berlios.de (gruntster at mail.berlios.de)
Date: Wed, 18 Jul 2007 14:17:57 +0200
Subject: [Avidemux-svn-commit] r3412 -
	branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec/i386
Message-ID: <200707181217.l6ICHvHS015068@sheep.berlios.de>

Author: gruntster
Date: 2007-07-18 14:17:49 +0200 (Wed, 18 Jul 2007)
New Revision: 3412

Modified:
   branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec/i386/cputest.c
Log:
[LAV] disable SSE instructions on Win32 due to GCC stack issues

Modified: branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec/i386/cputest.c
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec/i386/cputest.c	2007-07-18 11:33:31 UTC (rev 3411)
+++ branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec/i386/cputest.c	2007-07-18 12:17:49 UTC (rev 3412)
@@ -81,6 +81,7 @@
         cpuid(1, eax, ebx, ecx, std_caps);
         if (std_caps & (1<<23))
             rval |= FF_MM_MMX;
+#ifndef ADM_WIN32
         if (std_caps & (1<<25))
             rval |= FF_MM_MMXEXT | FF_MM_SSE;
         if (std_caps & (1<<26))
@@ -89,6 +90,7 @@
             rval |= FF_MM_SSE3;
         if (ecx & 0x00000200 )
             rval |= FF_MM_SSSE3;
+#endif
     }
 
     cpuid(0x80000000, max_ext_level, ebx, ecx, edx);



From gruntster at mail.berlios.de  Wed Jul 18 18:20:41 2007
From: gruntster at mail.berlios.de (gruntster at mail.berlios.de)
Date: Wed, 18 Jul 2007 18:20:41 +0200
Subject: [Avidemux-svn-commit] r3413 - in
	branches/avidemux_2.4_branch/avidemux: .
	ADM_libraries/ADM_utilities ADM_userInterfaces/ADM_commonUI
Message-ID: <200707181620.l6IGKfXs002260@sheep.berlios.de>

Author: gruntster
Date: 2007-07-18 18:20:32 +0200 (Wed, 18 Jul 2007)
New Revision: 3413

Modified:
   branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_utilities/prefs.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp
   branches/avidemux_2.4_branch/avidemux/prefs.h
   branches/avidemux_2.4_branch/avidemux/prefs.in
Log:
[OCR] prefs fix

Modified: branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_utilities/prefs.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_utilities/prefs.cpp	2007-07-18 12:17:49 UTC (rev 3412)
+++ branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_utilities/prefs.cpp	2007-07-18 16:20:32 UTC (rev 3413)
@@ -135,7 +135,7 @@
 	{"filters.autoload.path",		STRING,"/tmp/",NULL, NULL, NULL },
 	{"filters.autoload.active",		UINT,	"0",	NULL,	"0",	"1"	},
 	{"feature.alternate_mp3_tag",		UINT,	"1",	NULL,	"0",	"1"	},
-	{"feature.global_glyph",		UINT,	"1",	NULL,	"0",	"1"	},
+	{"feature.global_glyph.active",		UINT,	"1",	NULL,	"0",	"1"	},
 	{"feature.global_glyph.name",		STRING,"",	NULL, NULL, NULL },
 	{"priority.encoding",		UINT,	"3",	NULL,	"0",	"4"	},
 	{"priority.indexing",		UINT,	"3",	NULL,	"0",	"4"	},

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp	2007-07-18 12:17:49 UTC (rev 3412)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp	2007-07-18 16:20:32 UTC (rev 3413)
@@ -62,7 +62,7 @@
   admGlyph head(16,16);
   char *globalGlyph=NULL;
   uint32_t globalGlyphOn=0;
-  prefs->get(FEATURE_GLOBAL_GLYPH,&globalGlyphOn);
+  prefs->get(FEATURE_GLOBAL_GLYPH_ACTIVE,&globalGlyphOn);
   if(globalGlyphOn)
   {
      prefs->get(FEATURE_GLOBAL_GLYPH_NAME,&globalGlyph);

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp	2007-07-18 12:17:49 UTC (rev 3412)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp	2007-07-18 16:20:32 UTC (rev 3413)
@@ -102,7 +102,7 @@
         // autoindex
         prefs->get(FEATURE_AUTO_REBUILDINDEX,&autoindex);
         // Global glyph
-        prefs->get(FEATURE_GLOBAL_GLYPH,&useGlobalGlyph);
+        prefs->get(FEATURE_GLOBAL_GLYPH_ACTIVE,&useGlobalGlyph);
         prefs->get(FEATURE_GLOBAL_GLYPH_NAME,&globalGlyphName);
          // autoindex
         prefs->get(FEATURE_AUTO_UNPACK,&autounpack);
@@ -351,7 +351,7 @@
         diaElemTabs *tabs[]={&tabUser,&tabAuto,&tabInput,&tabOutput,&tabAudio,&tabVideo,&tabCpu,&tabGlyph,&tabXfilter};
         if( diaFactoryRunTabs(_("Preferences"),9,tabs))
 	{
-               prefs->set(FEATURE_GLOBAL_GLYPH,useGlobalGlyph);
+               prefs->set(FEATURE_GLOBAL_GLYPH_ACTIVE,useGlobalGlyph);
                 prefs->set(FEATURE_GLOBAL_GLYPH_NAME,globalGlyphName);
 
           

Modified: branches/avidemux_2.4_branch/avidemux/prefs.h
===================================================================
--- branches/avidemux_2.4_branch/avidemux/prefs.h	2007-07-18 12:17:49 UTC (rev 3412)
+++ branches/avidemux_2.4_branch/avidemux/prefs.h	2007-07-18 16:20:32 UTC (rev 3413)
@@ -81,7 +81,7 @@
 	FILTERS_AUTOLOAD_PATH,
 	FILTERS_AUTOLOAD_ACTIVE,
 	FEATURE_ALTERNATE_MP3_TAG,
-	FEATURE_GLOBAL_GLYPH,
+	FEATURE_GLOBAL_GLYPH_ACTIVE,
 	FEATURE_GLOBAL_GLYPH_NAME,
 	PRIORITY_ENCODING,
 	PRIORITY_INDEXING,

Modified: branches/avidemux_2.4_branch/avidemux/prefs.in
===================================================================
--- branches/avidemux_2.4_branch/avidemux/prefs.in	2007-07-18 12:17:49 UTC (rev 3412)
+++ branches/avidemux_2.4_branch/avidemux/prefs.in	2007-07-18 16:20:32 UTC (rev 3413)
@@ -92,7 +92,7 @@
 filters.autoload.active,                UINT,   0,      0,      1
 feature.alternate_mp3_tag,              UINT,   1,      0,      1
 # Global glyphset file
-feature.global_glyph,                   UINT,   1,      0,      1
+feature.global_glyph.active,            UINT,   1,      0,      1
 feature.global_glyph.name,              STRING, ""
 # priority
 priority.encoding,          UINT,   3,      0,      4



From mean at mail.berlios.de  Wed Jul 18 21:10:38 2007
From: mean at mail.berlios.de (mean at BerliOS)
Date: Wed, 18 Jul 2007 21:10:38 +0200
Subject: [Avidemux-svn-commit] r3414 - in branches/avidemux_2.4_branch: .
	addons/mkvscan avidemux avidemux/ADM_libraries/ADM_lavcodec
	avidemux/ADM_libraries/ADM_lavutil
	avidemux/ADM_userInterfaces/ADM_commonUI
Message-ID: <200707181910.l6IJAcO1026237@sheep.berlios.de>

Author: mean
Date: 2007-07-18 21:10:37 +0200 (Wed, 18 Jul 2007)
New Revision: 3414

Modified:
   branches/avidemux_2.4_branch/addons/mkvscan/mkv_c.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec/Makefile.am
   branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavutil/Makefile.am
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/Makefile.am
   branches/avidemux_2.4_branch/avidemux/Makefile.am
   branches/avidemux_2.4_branch/configure.in.in
Log:
[Auto*] Resync with latest lav*, incomplete

Modified: branches/avidemux_2.4_branch/addons/mkvscan/mkv_c.cpp
===================================================================
--- branches/avidemux_2.4_branch/addons/mkvscan/mkv_c.cpp	2007-07-18 16:20:32 UTC (rev 3413)
+++ branches/avidemux_2.4_branch/addons/mkvscan/mkv_c.cpp	2007-07-18 19:10:37 UTC (rev 3414)
@@ -104,6 +104,15 @@
                   val=son.readUnsignedInt(len);
                   recTab();printf("\tval uint: %llu (0x%llx) \n",val,val);
                   break;
+        case ADM_MKV_TYPE_UTF8:
+        {
+                  char string[len+1];
+                  string[0]=0;
+                  son.readString(string,len);
+                  recTab();printf("\tval utf8 as string: <%s> \n",string);
+        }
+                  break;
+                  
         case ADM_MKV_TYPE_FLOAT:
                   recTab();printf("\tval float: %f \n",son.readFloat(len));
                   break;

Modified: branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec/Makefile.am
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec/Makefile.am	2007-07-18 16:20:32 UTC (rev 3413)
+++ branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec/Makefile.am	2007-07-18 19:10:37 UTC (rev 3414)
@@ -36,7 +36,7 @@
 EXTEND_PPC=
 
 endif
-MYCFLAGS= -I.. -DHAVE_AV_CONFIG_H $(X_MMX_FLAGS) -O3 -I../.. -I$(LAVUTIL) -Drestrict=__restrict__ -fomit-frame-pointer
+MYCFLAGS= -I. -I.. -DHAVE_AV_CONFIG_H $(X_MMX_FLAGS) -O3 -I../.. -I$(LAVUTIL) -Drestrict=__restrict__ -fomit-frame-pointer -include ffconf.h
 # for SSE we need special compil flags
 fft_sse.o:i386/fft_sse.c
 	$(CC) -o $@ $< -c $(MYCFLAGS) $(CFLAGS) $(all_includes) -I..   -msse -I$(LAVUTIL) -I../../..
@@ -56,7 +56,21 @@
 		truemotion1.c flac.c g726.c 	qtrle.c lcl.c 	snow.c  \
 		rangecoder.c bitstream.c h264idct.c h261.c amr.c tscc.c \
 		resample2.c pthread.c qdm2.c bitstream_filter.c eval.c \
-		vc1.c vc1dsp.c vp56.c vp56data.c vp6.c vp5.c indeo2.c indeo3.c  smacker.c  opt.c
+		vc1.c vc1dsp.c vp56.c vp56data.c vp6.c vp5.c indeo2.c indeo3.c  smacker.c  opt.c \
+		 fraps.c dnxhddata.h  dnxhddec.c	\
+                mpeg12data.c  mpegaudiodata.c  msmpeg4data.c   vc1data.c   vp56data.c mjpegbdec.c \
+                h263_parser.c \
+                h264_parser.c \
+                mpeg4video_parser.c \
+                mpegvideo_enc.c \
+                mpeg12enc.c mpegaudioenc.c \
+                ac3enc.c ac3.c ac3tab.c \
+                mjpegenc.c mjpegdec.c \
+                wma.c \
+                dvbsub_parser.c \
+                dvbsubdec.c \
+                dvbsub.c
+
 	
 
 EXTRA_DIST = ac3.h    faandct.h      internal.h   \

Modified: branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavutil/Makefile.am
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavutil/Makefile.am	2007-07-18 16:20:32 UTC (rev 3413)
+++ branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavutil/Makefile.am	2007-07-18 19:10:37 UTC (rev 3414)
@@ -4,7 +4,7 @@
 
 libADM_lavutil_a_METASOURCES = AUTO
 
-libADM_lavutil_a_SOURCES =  integer.c  intfloat_readwrite.c  mathematics.c  rational.c md5.c crc.c log.c  adler32.c lls.c
+libADM_lavutil_a_SOURCES =  integer.c  intfloat_readwrite.c  mathematics.c  rational.c md5.c crc.c log.c  adler32.c lls.c string.c
 
 
 EXTRA_DIST = avutil.h  common.h  integer.h   \

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/Makefile.am
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/Makefile.am	2007-07-18 16:20:32 UTC (rev 3413)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/Makefile.am	2007-07-18 19:10:37 UTC (rev 3414)
@@ -11,7 +11,8 @@
 DIA_flySrtPos.cpp \
 DIA_tdeint.cpp DIA_v2v.cpp \
 DIA_lavDecoder.cpp  DIA_srt.cpp \
-DIA_animated.cpp
+DIA_animated.cpp \
+DIA_ocr.cpp
 
 
 INCLUDES = $(all_includes) $(GTK_CFLAGS) $(XML_CFLAGS)  $(FREETYPE_CFLAGS) -DADM_SUBVERSION=@ADM_SUBVERSION@ \

Modified: branches/avidemux_2.4_branch/avidemux/Makefile.am
===================================================================
--- branches/avidemux_2.4_branch/avidemux/Makefile.am	2007-07-18 16:20:32 UTC (rev 3413)
+++ branches/avidemux_2.4_branch/avidemux/Makefile.am	2007-07-18 19:10:37 UTC (rev 3414)
@@ -22,16 +22,15 @@
 endif
 
 user_interface_gtk = \
-		./ADM_userInterfaces/ADM_GTK/ADM_gui2/libADM_gui2.a	\
-		./ADM_userInterfaces/ADM_GTK/ADM_ocr/libADM_ocr.a	\
+		./ADM_ocr/libADM_ocr.a					\
+		./ADM_userInterfaces/ADM_GTK/ADM_filters/libADM_filters.a \
+		./ADM_userInterfaces/ADM_commonUI/libADM_CommonUI.a	\
 		./ADM_userInterfaces/ADM_GTK/ADM_dialog/libADM_dialog.a	\
-		./ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_srt.o	\
-		./ADM_userInterfaces/ADM_GTK/ADM_dialogFactory/libADM_dialogFactory.a	\
 		./ADM_userInterfaces/ADM_commonUI/libADM_CommonUI.a	\
+		./ADM_userInterfaces/ADM_GTK/ADM_ocr/libADM_ocr.a	\
 		./ADM_userInterfaces/ADM_GTK/ADM_dialogFactory/libADM_dialogFactory.a	\
 		./ADM_userInterfaces/ADM_GTK/ADM_gui2/libADM_gui2.a	\
-		./ADM_userInterfaces/ADM_GTK/ADM_filters/libADM_filters.a \
-		./ADM_userInterfaces/ADM_GTK/ADM_toolkit_gtk/libADM_toolkit_gtk.a	
+		./ADM_userInterfaces/ADM_GTK/ADM_toolkit_gtk/libADM_toolkit_gtk.a	 
 		
 user_interface_cli = \
 		./ADM_userInterfaces/ADM_NONE/ADM_gui2/libADM_gui2.a	\

Modified: branches/avidemux_2.4_branch/configure.in.in
===================================================================
--- branches/avidemux_2.4_branch/configure.in.in	2007-07-18 16:20:32 UTC (rev 3413)
+++ branches/avidemux_2.4_branch/configure.in.in	2007-07-18 19:10:37 UTC (rev 3414)
@@ -1141,6 +1141,7 @@
 		have_little_endian=yes;		
 		AC_DEFINE(ARCH_X86,1,[post proc])		
 		AC_DEFINE(HAVE_MMX,1,[post proc])       
+		AC_DEFINE(ENABLE_MMX,1,[post proc])       
 		AC_DEFINE(FPM_INTEL,1,[Mad ])       
 		AC_DEFINE(RUNTIME_CPUDETECT,1,"Let FFmpeg decide which is faster")		
 		AC_DEFINE(ARCH_X86_32,1,"X86_32 assembly")
@@ -1152,6 +1153,7 @@
 		AC_DEFINE(ARCH_X86_64,1,"X86_64 AMD64 assembly")
 		AC_DEFINE(ARCH_64_BITS,1,"X86_64 AMD64 assembly")
 		AC_DEFINE(HAVE_MMX,1,[post proc])
+		AC_DEFINE(ENABLE_MMX,1,[post proc])       
 		AC_DEFINE(FPM_DEFAULT,1,[Mad ])
 		AC_DEFINE(RUNTIME_CPUDETECT,1,"Let FFmpeg decide which is faster")
 		use_mmx=yes
@@ -1163,6 +1165,7 @@
 		AC_DEFINE(ARCH_64_BITS,1,"X86_64 AMD64 assembly")
 		AC_DEFINE(FPM_DEFAULT,1,[Mad ])
 		AC_DEFINE(RUNTIME_CPUDETECT,1,"Let FFmpeg decide which is faster")
+		AC_DEFINE(ENABLE_MMX,0,[post proc])       
 		echo "IA64"
 		;;
 	sparc|sparc64)
@@ -1171,6 +1174,7 @@
 		AC_DEFINE(ADM_BIG_ENDIAN,1,[Big endian CPU - SPARC or PowerPC])
 		AC_DEFINE(FPM_SPARC,1,[Mad ])
 		AC_DEFINE(WORDS_BIGENDIAN,1,[Big endian CPU - SPARC or PowerPC])
+		AC_DEFINE(ENABLE_MMX,0,[post proc])       
 		;;		
 	sun4u)
 		LDFLAGS="$LDFLAGS -lposix4";
@@ -1180,6 +1184,7 @@
 		AC_DEFINE(ADM_SPARC,1,[Sparc workstations])
 		AC_DEFINE(ADM_BIG_ENDIAN,1,[Big endian CPU - SPARC or PowerPC])
 		AC_DEFINE(WORDS_BIGENDIAN,1,[Big endian CPU - SPARC or PowerPC])
+		AC_DEFINE(ENABLE_MMX,0,[post proc])       
 		;;
 	ppc)
 		have_little_endian=no;
@@ -1194,6 +1199,7 @@
 			AC_HELP_STRING([--enable-altivec], [enable AltiVec acceleration (PowerPC)]),
 			have_altivec=yes)
 		AC_DEFINE(WORDS_BIGENDIAN,1,[Big endian CPU - SPARC or PowerPC])
+		AC_DEFINE(ENABLE_MMX,0,[post proc])       
 		;;
 	*)
 		adm_cpu=`uname -p`;
@@ -1214,6 +1220,7 @@
 				AC_DEFINE(ADM_BIG_ENDIAN,1,[Big endian CPU - SPARC or PowerPC])
 				AC_DEFINE(CONFIG_DARWIN,0,[Inform FFmpeg we are using Darwin Mac OS X])
 				AC_DEFINE(WORDS_BIGENDIAN,1,[Big endian CPU - SPARC or PowerPC])
+		                AC_DEFINE(ENABLE_MMX,0,[post proc])       
 				AC_ARG_ENABLE(altivec, 
 					AC_HELP_STRING([--enable-altivec], [enable AltiVec acceleration (PowerPC)]),
 					have_altivec=yes)
@@ -1227,6 +1234,7 @@
 				AC_DEFINE(FPM_DEFAULT,1,[Mad ])       
 				AC_DEFINE(ADM_BIG_ENDIAN,1,[Big endian CPU - SPARC or PowerPC])
 				AC_DEFINE(WORDS_BIGENDIAN,1,[Big endian CPU - SPARC or PowerPC])
+		                AC_DEFINE(ENABLE_MMX,0,[post proc])       
 				;;
 		esac
 esac
@@ -1402,6 +1410,7 @@
 AC_DEFINE(CONFIG_MP4_MUXER,1,[CONFIG_MUXERS])
 AC_DEFINE(CONFIG_MOV_MUXER,1,[CONFIG_MUXERS])
 AC_DEFINE(HAVE_THREADS,1,[HAVE_THREADS])
+AC_DEFINE(ENABLE_THREADS,1,[ENABLE_THREADS])
 
 dnl ________________ libmpeg2 _________________
 AC_DEFINE(ACCEL_DETECT,1,[MPEG2DEC])



From gruntster at mail.berlios.de  Thu Jul 19 02:14:36 2007
From: gruntster at mail.berlios.de (gruntster at mail.berlios.de)
Date: Thu, 19 Jul 2007 02:14:36 +0200
Subject: [Avidemux-svn-commit] r3415 - in
	branches/avidemux_2.4_branch/avidemux: . ADM_audiofilter
Message-ID: <200707190014.l6J0EaNU027070@sheep.berlios.de>

Author: gruntster
Date: 2007-07-19 02:14:26 +0200 (Thu, 19 Jul 2007)
New Revision: 3415

Modified:
   branches/avidemux_2.4_branch/avidemux/ADM_audiofilter/audioencoder_vorbis.cpp
   branches/avidemux_2.4_branch/avidemux/gtk_gui.cpp
Log:
[Vorbis] prevent crash if codec fails to initialise

Modified: branches/avidemux_2.4_branch/avidemux/ADM_audiofilter/audioencoder_vorbis.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_audiofilter/audioencoder_vorbis.cpp	2007-07-18 19:10:37 UTC (rev 3414)
+++ branches/avidemux_2.4_branch/avidemux/ADM_audiofilter/audioencoder_vorbis.cpp	2007-07-19 00:14:26 UTC (rev 3415)
@@ -127,6 +127,9 @@
   }
   if (err!=0) 
   {
+	  delete (vorbisStruct*)_handle;
+	  _handle = NULL;
+
     printf("[vorbis] init error %d\n",err);
     return 0;
   }

Modified: branches/avidemux_2.4_branch/avidemux/gtk_gui.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/gtk_gui.cpp	2007-07-18 19:10:37 UTC (rev 3414)
+++ branches/avidemux_2.4_branch/avidemux/gtk_gui.cpp	2007-07-19 00:14:26 UTC (rev 3415)
@@ -1552,6 +1552,13 @@
 
 
         saveFilter =  buildAudioFilter (currentaudiostream,video_body->getTime (frameStart));
+
+		if (saveFilter == NULL)
+		{
+			fclose(out);
+			ADM_dealloc(outbuffer);
+			return;
+		}
    
     	DIA_working *work=new DIA_working(_("Saving audio"));
 



From gruntster at mail.berlios.de  Thu Jul 19 02:24:49 2007
From: gruntster at mail.berlios.de (gruntster at mail.berlios.de)
Date: Thu, 19 Jul 2007 02:24:49 +0200
Subject: [Avidemux-svn-commit] r3416 - branches/avidemux_2.4_branch/avidemux
Message-ID: <200707190024.l6J0On1n028198@sheep.berlios.de>

Author: gruntster
Date: 2007-07-19 02:24:40 +0200 (Thu, 19 Jul 2007)
New Revision: 3416

Modified:
   branches/avidemux_2.4_branch/avidemux/gtk_gui.cpp
Log:
display filename in window caption when loaded via script (Win32)

Modified: branches/avidemux_2.4_branch/avidemux/gtk_gui.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/gtk_gui.cpp	2007-07-19 00:14:26 UTC (rev 3415)
+++ branches/avidemux_2.4_branch/avidemux/gtk_gui.cpp	2007-07-19 00:24:40 UTC (rev 3416)
@@ -982,7 +982,7 @@
         }
 	for(i=strlen(longname);i>=0;i--)
 #ifdef ADM_WIN32
-		if( longname[i] == '\\' ){
+		if( longname[i] == '\\' || longname[i] == '/' ){
 #else
 		if( longname[i] == '/' ){
 #endif



From mean at mail.berlios.de  Thu Jul 19 07:58:22 2007
From: mean at mail.berlios.de (mean at BerliOS)
Date: Thu, 19 Jul 2007 07:58:22 +0200
Subject: [Avidemux-svn-commit] r3417 -
	branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec
Message-ID: <200707190558.l6J5wMaD027345@sheep.berlios.de>

Author: mean
Date: 2007-07-19 07:58:22 +0200 (Thu, 19 Jul 2007)
New Revision: 3417

Modified:
   branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec/ffconf.c
   branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec/ffconf.h
Log:
[LAV] renable FLV related codecs

Modified: branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec/ffconf.c
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec/ffconf.c	2007-07-19 00:24:40 UTC (rev 3416)
+++ branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec/ffconf.c	2007-07-19 05:58:22 UTC (rev 3417)
@@ -46,6 +46,7 @@
     DECLARE_DECODER (RV10, rv10);
     DECLARE_DECODER (RV20, rv20);
     DECLARE_DECODER (DVBSUB, dvbsub);
+    DECLARE_DECODER (FLV, flv);
 
 #undef DECLARE_DECODER
 #define DECLARE_DECODER(a,b); printf("#define ENABLE_"#a"_DECODER 0\n"); 
@@ -124,7 +125,6 @@
     DECLARE_DECODER (ASV2, asv2);
     DECLARE_DECODER (BMP, bmp);
     DECLARE_DECODER (FLASHSV, flashsv);
-    DECLARE_DECODER (FLV, flv);
     DECLARE_DECODER (GIF, gif);
     DECLARE_DECODER (H261, h261);
     DECLARE_DECODER (H263, h263);
@@ -218,6 +218,7 @@
     DECLARE_ENCODER (MPEG1VIDEO, mpeg1video);
     DECLARE_ENCODER (MPEG2VIDEO, mpeg2video);
     DECLARE_ENCODER (MPEG4, mpeg4);
+    DECLARE_ENCODER (FLV, flv);
     DECLARE_ENCODER (SNOW, snow);
     DECLARE_ENCODER (MP2, mp2);
     DECLARE_ENCODER (DVVIDEO, dvvideo);
@@ -244,7 +245,6 @@
     DECLARE_ENCODER (ASV2, asv2);
     DECLARE_ENCODER (BMP, bmp);
     DECLARE_ENCODER (FLASHSV, flashsv);
-    DECLARE_ENCODER (FLV, flv);
     DECLARE_ENCODER (GIF, gif);
     DECLARE_ENCODER (H261, h261);
     DECLARE_ENCODER (JPEGLS, jpegls);

Modified: branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec/ffconf.h
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec/ffconf.h	2007-07-19 00:24:40 UTC (rev 3416)
+++ branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec/ffconf.h	2007-07-19 05:58:22 UTC (rev 3417)
@@ -37,6 +37,7 @@
 #define ENABLE_RV10_DECODER 1
 #define ENABLE_RV20_DECODER 1
 #define ENABLE_DVBSUB_DECODER 1
+#define ENABLE_FLV_DECODER 1
 #define ENABLE_AASC_DECODER 0
 #define ENABLE_AVS_DECODER 0
 #define ENABLE_BETHSOFTVID_DECODER 0
@@ -110,7 +111,6 @@
 #define ENABLE_ASV2_DECODER 0
 #define ENABLE_BMP_DECODER 0
 #define ENABLE_FLASHSV_DECODER 0
-#define ENABLE_FLV_DECODER 0
 #define ENABLE_GIF_DECODER 0
 #define ENABLE_H261_DECODER 0
 #define ENABLE_H263_DECODER 0
@@ -197,6 +197,7 @@
 #define ENABLE_MPEG1VIDEO_ENCODER 1
 #define ENABLE_MPEG2VIDEO_ENCODER 1
 #define ENABLE_MPEG4_ENCODER 1
+#define ENABLE_FLV_ENCODER 1
 #define ENABLE_SNOW_ENCODER 1
 #define ENABLE_MP2_ENCODER 1
 #define ENABLE_DVVIDEO_ENCODER 1
@@ -218,7 +219,6 @@
 #define ENABLE_ASV2_ENCODER 0
 #define ENABLE_BMP_ENCODER 0
 #define ENABLE_FLASHSV_ENCODER 0
-#define ENABLE_FLV_ENCODER 0
 #define ENABLE_GIF_ENCODER 0
 #define ENABLE_H261_ENCODER 0
 #define ENABLE_JPEGLS_ENCODER 0



From mean at mail.berlios.de  Thu Jul 19 21:39:27 2007
From: mean at mail.berlios.de (mean at BerliOS)
Date: Thu, 19 Jul 2007 21:39:27 +0200
Subject: [Avidemux-svn-commit] r3418 - in
	branches/avidemux_2.4_branch/avidemux: ADM_codecs ADM_encoder
	ADM_filter ADM_userInterfaces/ADM_commonUI
Message-ID: <200707191939.l6JJdRtD026155@sheep.berlios.de>

Author: mean
Date: 2007-07-19 21:39:25 +0200 (Thu, 19 Jul 2007)
New Revision: 3418

Modified:
   branches/avidemux_2.4_branch/avidemux/ADM_codecs/ADM_x264.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_encoder/ADM_encCodecDesc.h
   branches/avidemux_2.4_branch/avidemux/ADM_filter/vidVCD.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_resizeWiz.cpp
Log:
[PSP] Some change so that it works with fwm >= 3.3, A/R is still incorrect by default.

Modified: branches/avidemux_2.4_branch/avidemux/ADM_codecs/ADM_x264.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_codecs/ADM_x264.cpp	2007-07-19 05:58:22 UTC (rev 3417)
+++ branches/avidemux_2.4_branch/avidemux/ADM_codecs/ADM_x264.cpp	2007-07-19 19:39:25 UTC (rev 3418)
@@ -87,7 +87,11 @@
 
   param.i_fps_num = fps1000;
   param.i_fps_den = 1000;
-  
+  if(zparam->idc)
+  {
+    MKPARAM(i_level_idc,idc);
+    printf("***Forcing level =%d\n",param.i_level_idc);
+  }
   // KeyframeBoost ?
   // BframeReduction ?
   // PartitionDecision ?

Modified: branches/avidemux_2.4_branch/avidemux/ADM_encoder/ADM_encCodecDesc.h
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_encoder/ADM_encCodecDesc.h	2007-07-19 05:58:22 UTC (rev 3417)
+++ branches/avidemux_2.4_branch/avidemux/ADM_encoder/ADM_encCodecDesc.h	2007-07-19 19:39:25 UTC (rev 3418)
@@ -633,7 +633,7 @@
 1, //        ChromaME
 0, // Mixed Ref
 0, //NoiseReduction
-51, // level IDC for psp  
+0, // level IDC for psp  
 0, // fastPSkip;
 1,  //DCTDecimate;
 0,   //interlaced;
@@ -656,7 +656,7 @@
 51,//     uint32_t  MaxQp;
 4,//     uint32_t  QpStep;
 //     //
-1, //     uint32_t maxRefScene
+2, //     uint32_t maxRefScene
 0,//     uint32_t  SceneCut;
 25,//     uint32_t  MinIdr;
 250,//     uint32_t  MaxIdr;
@@ -668,7 +668,7 @@
 0,//     uint32_t   _8X8I;
 0,//     uint32_t   _4x4I;
 //     //
-0,//     uint32_t  MaxBFrame;
+3,//     uint32_t  MaxBFrame;
 0,//     int32_t   Bias;
 //     //
 0,//     uint32_t BasReference;
@@ -682,6 +682,7 @@
 1,//     uint32_t Method;
 1,//     uint32_t AR_Num;
 1,//     uint32_t AR_Den;
+0,//    AR as input
 0,//     uint32_t DeblockingFilter;
 0,//     int32_t  Strength;
 0,//     int32_t  Threshold;

Modified: branches/avidemux_2.4_branch/avidemux/ADM_filter/vidVCD.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_filter/vidVCD.cpp	2007-07-19 05:58:22 UTC (rev 3417)
+++ branches/avidemux_2.4_branch/avidemux/ADM_filter/vidVCD.cpp	2007-07-19 19:39:25 UTC (rev 3418)
@@ -72,8 +72,8 @@
 static targetFmt SVCD={480, 720, 576, 480};
 static targetFmt DVD={720, 720, 576, 480};
 static targetFmt DVDHD1={352, 720, 576, 480};
-static targetFmt PSP={320, 320, 240, 240};
-static targetFmt PSPH264={480, 480, 272, 272};
+static targetFmt PSP={480, 480, 272, 272};
+static targetFmt PSPH264={720, 720, 480, 480};
 /* Dont forget to update DIA_resizeWiz if you change something here */
 
 targetFmt *allFormats[6]={&VCD,&SVCD,&DVD,&DVDHD1,&PSP,&PSPH264};

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_resizeWiz.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_resizeWiz.cpp	2007-07-19 05:58:22 UTC (rev 3417)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_resizeWiz.cpp	2007-07-19 19:39:25 UTC (rev 3418)
@@ -41,8 +41,8 @@
                              ONELINE(SVCD,"SVCD"),
                              ONELINE(DVD,"DVD"),
                              ONELINE(DVD_HD1,"DVD half D1"),
-                             ONELINE(PSP,"PSP"),
-                             ONELINE(PSP_FULLRES,"PSP full res"),
+                             ONELINE(PSP,"PSP 480*272"),
+                             ONELINE(PSP_FULLRES,"PSP full res (720*480"),
                           };
              diaMenuEntry menuFAspect[3]={
                {RESWIZ_AR_1_1,"1:1",NULL},



From gruntster at mail.berlios.de  Sat Jul 21 01:06:00 2007
From: gruntster at mail.berlios.de (gruntster at mail.berlios.de)
Date: Sat, 21 Jul 2007 01:06:00 +0200
Subject: [Avidemux-svn-commit] r3419 - in
	branches/avidemux_2.4_branch/avidemux: .
	ADM_userInterfaces/ADM_GTK/ADM_dialog
	ADM_userInterfaces/ADM_GTK/ADM_filters
	ADM_userInterfaces/ADM_NONE/ADM_gui2
	ADM_userInterfaces/ADM_QT4/ADM_dialog
	ADM_userInterfaces/ADM_QT4/ADM_gui
	ADM_userInterfaces/ADM_commonUI ADM_video
Message-ID: <200707202306.l6KN60mV007857@sheep.berlios.de>

Author: gruntster
Date: 2007-07-21 01:05:42 +0200 (Sat, 21 Jul 2007)
New Revision: 3419

Added:
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_flyPreview.h
Removed:
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_filters/gui_filter.cpp
Modified:
   branches/avidemux_2.4_branch/avidemux/ADM_preview.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_flyDialog.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_preview.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_filters/CMakeLists.txt
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_filters/Makefile.am
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_filters/gui_filtermanager.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_NONE/ADM_gui2/preview_none.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/T_flyDialog.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/T_preview.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_flyDialog.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_flyDialog.h
   branches/avidemux_2.4_branch/avidemux/ADM_video/ADM_genvideo.hxx
   branches/avidemux_2.4_branch/avidemux/gtk_gui.cpp
Log:
[Preview] flyDialog preview windows for GTK

Modified: branches/avidemux_2.4_branch/avidemux/ADM_preview.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_preview.cpp	2007-07-19 19:39:25 UTC (rev 3418)
+++ branches/avidemux_2.4_branch/avidemux/ADM_preview.cpp	2007-07-20 23:05:42 UTC (rev 3419)
@@ -187,7 +187,7 @@
             switch(previewMode)
             {
               case  ADM_PREVIEW_SEPARATE:
-                  GUI_PreviewInit(preview->getInfo()->width,preview->getInfo()->height,0);
+                  DIA_previewInit(preview->getInfo()->width,preview->getInfo()->height);
                   
                   /* no break here, not a mistake */
               case  ADM_PREVIEW_NONE:
@@ -255,7 +255,7 @@
 {
   renderLock();
       if(previewMode==ADM_PREVIEW_SEPARATE)
-                GUI_PreviewEnd();
+                DIA_previewEnd();
       if(  previewMode==ADM_PREVIEW_SIDE || previewMode==ADM_PREVIEW_TOP)
       {
         ADM_assert(original);
@@ -386,13 +386,13 @@
                 if(!defered_display) 
                   renderUpdateImage(resized->data,zoom);
             }
-          if( GUI_PreviewStillAlive())
+          if( DIA_previewStillAlive())
           {
                   aprintf("Preview: Ask for frame %lu\n",framenum);
                   if(framenum<=preview->getInfo()->nb_frames-1)
                   {
                           preview->getFrameNumberNoAlloc(framenum,&len,previewImage,&fl);
-                          if(!defered_display) GUI_PreviewUpdate(previewImage->data);
+                          if(!defered_display) DIA_previewUpdate(previewImage->data);
                   }
           }
           break;
@@ -507,9 +507,9 @@
                 ADM_assert(resized);
                 renderUpdateImage(resized->data,zoom);
             }
-            if( GUI_PreviewStillAlive())
+            if( DIA_previewStillAlive())
             {
-                GUI_PreviewUpdate(previewImage->data);
+                DIA_previewUpdate(previewImage->data);
             }
           break;
       case ADM_PREVIEW_SIDE:
@@ -529,6 +529,8 @@
 
 void admPreview::cleanUp(void)
 {
+	admPreview::stop();
+
 	if(rdrImage)
 	{
 		delete rdrImage;
@@ -546,17 +548,5 @@
 		delete previewImage; 
 		previewImage=NULL;
 	}
-
-	if(resized)
-	{
-		delete resized;
-		resized=NULL;
-	}
-
-	if(resizer)
-	{
-		delete resizer;
-		resizer=NULL;
-	}
 }
 // EOF

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_flyDialog.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_flyDialog.cpp	2007-07-19 19:39:25 UTC (rev 3418)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_flyDialog.cpp	2007-07-20 23:05:42 UTC (rev 3419)
@@ -12,30 +12,31 @@
 *                                                                         *
 ***************************************************************************///
 
-#include <config.h>
+#include "config.h"
 
-#include <string.h>
-#include <stdio.h>
-# include <math.h>
-
-#include <gdk/gdkkeysyms.h>
 #include <gtk/gtk.h>
 
 #include "default.h"
-
-#include "ADM_toolkit_gtk/ADM_gladeSupport.h"
 #include "ADM_toolkit_gtk/toolkit_gtk.h"
 #include "ADM_toolkit_gtk/toolkit_gtk_include.h"
-#include "ADM_toolkit/toolkit.hxx"
-
-#include "ADM_colorspace/ADM_rgb.h"
-#include "ADM_image.h"
 #include "ADM_video/ADM_genvideo.hxx"
 #include "DIA_flyDialog.h"
 #include "ADM_assert.h"
 
 extern void GUI_RGBDisplay(uint8_t * dis, uint32_t w, uint32_t h, void *widg);
 
+void ADM_flyDialog::postInit(uint32_t width, uint32_t height, AVDMGenericVideoStream *in,
+							 void *canvas, void *slider, int yuv)
+{
+	if (slider != NULL)
+	{
+		GtkAdjustment *adj = (GtkAdjustment*)gtk_adjustment_new(0, 0, in->getInfo()->nb_frames - 1, 0, 0, 0);
+
+		gtk_range_set_adjustment(GTK_RANGE(_slider), adj);
+		gtk_scale_set_digits(GTK_SCALE(_slider), 0);
+	}
+}
+
 uint8_t  ADM_flyDialog::display(void)
 {
 	ADM_assert(_canvas);
@@ -51,20 +52,30 @@
 
 	return 1; 
 }
+
 uint32_t ADM_flyDialog::sliderGet(void)
 {
-  ADM_assert(_slider);
-  GtkAdjustment *adj=gtk_range_get_adjustment (GTK_RANGE(_slider));
-  return (uint32_t)GTK_ADJUSTMENT(adj)->value;
+	ADM_assert(_slider);
+	GtkAdjustment *adj=gtk_range_get_adjustment (GTK_RANGE(_slider));
+	return (uint32_t)GTK_ADJUSTMENT(adj)->value;
 }
-uint8_t     ADM_flyDialog::sliderSet(uint32_t value)
+
+uint8_t ADM_flyDialog::sliderSet(uint32_t value)
 {
-  ADM_assert(_slider);
-  return 1; 
+	ADM_assert(_slider);
+
+	GtkAdjustment *adj = gtk_range_get_adjustment(GTK_RANGE(_slider));
+
+	adj->value = value;
+
+	gtk_range_set_adjustment(GTK_RANGE(_slider), adj);
+
+	return 1; 
 }
-uint8_t  ADM_flyDialog::isRgbInverted(void)
+
+uint8_t ADM_flyDialog::isRgbInverted(void)
 {
-  return 0; 
+	return 0; 
 }
 
 //EOF

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_preview.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_preview.cpp	2007-07-19 19:39:25 UTC (rev 3418)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_preview.cpp	2007-07-20 23:05:42 UTC (rev 3419)
@@ -1,6 +1,6 @@
 /***************************************************************************
-                          ADM_vidpreview.cpp  -  description
-                             -------------------
+                             DIA_preview.cpp
+                             ---------------
 
        Previewer, we switch to RGB (only one Xv at a time)   and display the incoming
        YV12 buffer in a nice windowd
@@ -20,366 +20,193 @@
  ***************************************************************************/
 
 #include "config.h"
- 
-#include <stdio.h>
-#include <stdlib.h>
-#include <string.h>
-
 #include <gtk/gtk.h>
-#include <time.h>
-#include <sys/time.h>
 
-#include "config.h"
-#include "fourcc.h"
-#include "avio.hxx"
-
-#include "avi_vars.h"
-#include "ADM_toolkit_gtk/ADM_gladeSupport.h"
+#include "default.h"
 #include "ADM_toolkit_gtk/toolkit_gtk.h"
 #include "ADM_toolkit_gtk/toolkit_gtk_include.h"
-#include "ADM_colorspace/ADM_rgb.h"
-#include "prototype.h"
-#include <ADM_assert.h>
-#include "gui_action.hxx"
+#include "ADM_video/ADM_genvideo.hxx"
+#include "ADM_assert.h"
 
-extern "C" {
-#include "ADM_libraries/ADM_lavcodec/avcodec.h"
-}
+#include "DIA_flyDialog.h"
+#include "DIA_flyPreview.h"
 
-extern void HandleAction (Action action);
-void GUI_detransient(void );
-void GUI_retransient(void );
+static GtkWidget *create_dialog1(void);
+extern float UI_calcZoomToFitScreen(GtkWindow* window, GtkWidget* drawingArea, uint32_t imageWidth, uint32_t imageHeight);
 
-static GtkWidget	*create_dialog1 (void);
-static uint8_t      stacked=0;
-static void 			previewRender(void);
-static gboolean		preview_exit(GtkButton * button, gpointer user_data);
-static gboolean         cb_prev(GtkButton * button, gpointer user_data);
-static gboolean         cb_stack(GtkButton * button, gpointer user_data);
-static gboolean         cb_next(GtkButton * button, gpointer user_data);
-static gboolean 		preview_exit_short (GtkWidget * widget,GdkEvent * event, gpointer user_data);
+static GtkWidget *dialog = NULL;
 
-static uint8_t *rgb_render=NULL,*rgb_alternate=NULL,*rgbDisplay=NULL;
-static GtkWidget *dialog=NULL;
-static uint32_t 	uw, uh,zoomW,zoomH;
-int 			lock;
-uint8_t		needDestroy=0;
-static int      needResponse=0;
-static ColYuvRgb    rgbConv(100,100);
-static ADMImageResizer *resizer=NULL;
+static flySeekablePreview *seekablePreview;
+static void seekablePreview_draw(void);
+static void seekablePreview_frame_changed(void);
 
-extern float UI_calcZoomToFitScreen(GtkWindow* window, GtkWidget* drawingArea, uint32_t imageWidth, uint32_t imageHeight);
-
-//*************************************************************
-// Short cut for filter preview
-// It is a modal blocking display of the datas given as arg
-//*************************************************************
-void GUI_PreviewShow(uint32_t w, uint32_t h, uint8_t *data)
+/* =================================
+            Filter Preview
+   ================================= */
+uint8_t DIA_filterPreview(char *captionText, AVDMGenericVideoStream *videoStream, uint32_t frame)
 {
-	if(rgb_render)
-	{
-		printf("\nWarning rgb render not null...\n");
-		delete[] rgb_render;
-		delete[] rgb_alternate;
-		rgb_alternate=NULL;
-		rgb_render=NULL;
-	}
+	ADM_assert(frame <= videoStream->getInfo()->nb_frames);
 
-	rgb_render=new uint8_t [w*h*4];
-	rgb_alternate=new uint8_t [w*h*4];
+	GtkWidget *hbuttonbox1, *buttonOk, *scale;
 
-	uw=w;
-	uh=h;
-	rgbConv.reset(w,h);
-	rgbConv.scale(data,rgb_render);
+	dialog = create_dialog1();
+	
+	scale = gtk_hscale_new (GTK_ADJUSTMENT (gtk_adjustment_new (0, 0, 110, 1, 10, 10)));
+	gtk_widget_show (scale);
+	gtk_box_pack_start (GTK_BOX(WID(vbox1)), scale, FALSE, TRUE, 0);
 
-	dialog=create_dialog1();
+	hbuttonbox1 = gtk_hbutton_box_new ();
+	gtk_widget_show (hbuttonbox1);
+	gtk_box_pack_start (GTK_BOX(WID(vbox1)), hbuttonbox1, FALSE, TRUE, 0);
+	gtk_button_box_set_layout (GTK_BUTTON_BOX(hbuttonbox1), GTK_BUTTONBOX_END);
+
+	buttonOk = gtk_button_new_from_stock ("gtk-ok");
+	gtk_widget_show(buttonOk);
+	gtk_container_add (GTK_CONTAINER(hbuttonbox1), buttonOk);
+	GTK_WIDGET_SET_FLAGS (buttonOk, GTK_CAN_DEFAULT);
+
+	GLADE_HOOKUP_OBJECT (dialog, scale, "scale");
+	GLADE_HOOKUP_OBJECT(dialog, hbuttonbox1, "hbuttonbox1");
+	GLADE_HOOKUP_OBJECT(dialog, buttonOk, "buttonOk");	
+	
 	gtk_register_dialog(dialog);
 
-	float zoom = UI_calcZoomToFitScreen(GTK_WINDOW(dialog), WID(drawingarea1), w, h);
+	if (captionText)
+		gtk_window_set_title(GTK_WINDOW(dialog), captionText);
 
-	zoomW = w * zoom;
-	zoomH = h * zoom;
+	uint32_t width, height;
 
+	width = videoStream->getInfo()->width;
+	height = videoStream->getInfo()->height;
+
+	float zoom = UI_calcZoomToFitScreen(GTK_WINDOW(dialog), WID(drawingarea1), width, height);
+
+	uint32_t zoomW = width * zoom;
+	uint32_t zoomH = height * zoom;
+
 	gtk_widget_set_usize(WID(drawingarea1), zoomW, zoomH);
 
 	if (zoom < 1)
-	{
 		gtk_window_set_position(GTK_WINDOW(dialog), GTK_WIN_POS_CENTER);
-		resizer = new ADMImageResizer(w, h, zoomW, zoomH, PIX_FMT_RGB32, PIX_FMT_RGB32);
-		rgbDisplay = new uint8_t[zoomW*zoomH*4];
-	}
-	
-	gtk_signal_connect(GTK_OBJECT(WID(drawingarea1)), "expose_event",
-		   GTK_SIGNAL_FUNC(previewRender), NULL);
 
-	gtk_dialog_run(GTK_DIALOG(dialog));
-	gtk_unregister_dialog(dialog);
-	gtk_widget_destroy(dialog);
+	gtk_signal_connect(GTK_OBJECT(WID(scale)), "value_changed", GTK_SIGNAL_FUNC(seekablePreview_frame_changed), NULL);
+	gtk_signal_connect(GTK_OBJECT(WID(drawingarea1)), "expose_event", GTK_SIGNAL_FUNC(seekablePreview_draw), NULL);
+	gtk_dialog_add_action_widget(GTK_DIALOG(dialog), WID(buttonOk), GTK_RESPONSE_OK);
 
-	delete[] rgb_render;
-	delete[] rgb_alternate;
+	gtk_widget_show(dialog);
 
-	if (resizer)
+	seekablePreview = new flySeekablePreview(width, height, videoStream, WID(drawingarea1), WID(scale));
+	seekablePreview->resizeImage(zoomW, zoomH);
+	seekablePreview->sliderSet(frame);
+	seekablePreview->sliderChanged();
+
+	int response;
+
+	while((response = gtk_dialog_run(GTK_DIALOG(dialog))) == GTK_RESPONSE_APPLY)
 	{
-		delete resizer;
-		delete rgbDisplay;
-		resizer=NULL;
-		rgbDisplay=NULL;
+		seekablePreview_draw();
 	}
 
-	rgb_alternate=NULL;
-	rgb_render=NULL;
+	gtk_unregister_dialog(dialog);
+	gtk_widget_destroy(dialog);
+	delete seekablePreview;
+
+	return (response == GTK_RESPONSE_OK);
 }
-//*************************************************************
-// Init previewer
-// It is a independant window, so we cannot use gtk_dialog_run
-//
-//*************************************************************
-uint8_t GUI_PreviewStillAlive( void )
-{
- 	if(dialog==NULL) return 0;
-  	return 1;
 
+void seekablePreview_draw(void)
+{
+	seekablePreview->display();
 }
-void GUI_PreviewInit(uint32_t w , uint32_t h,uint32_t modal)
+
+void seekablePreview_frame_changed(void)
 {
-        if(rgb_render)
-        {
-                printf("\n Warning rgb render not null...\n");
-                delete [] rgb_render;
-                delete [] rgb_alternate;
-                rgb_alternate=NULL;
-                rgb_render=NULL;
-        }
-        stacked=0;
-       ADM_assert(rgb_render=new uint8_t [w*h*4]);
-       ADM_assert(rgb_alternate=new uint8_t [w*h*4]);
-       uw=w;
-       uh=h;
-       rgbConv.reset(w,h); 
+	seekablePreview->sliderChanged();
+}
 
-       // add callback for destroy
-        lock=0;
-        needDestroy=1;
+/* =================================
+                Preview
+   ================================= */
+static flyPreview *preview;
+static void preview_draw(void);
 
-#define CNX(x,y,z)  gtk_signal_connect(GTK_OBJECT(x), #y, \
-                       GTK_SIGNAL_FUNC(z),                   (void *) NULL);
+void DIA_previewInit(uint32_t width, uint32_t height)
+{
+	dialog = create_dialog1();
+	gtk_widget_set_usize(WID(drawingarea1), width, height);
 
-        dialog=create_dialog1();
-/*
-        CNX(WID(buttonNext),clicked     ,cb_next);
-        CNX(WID(buttonPrev),clicked     ,cb_prev);
-*/
-        CNX(WID(drawingarea1),expose_event,previewRender);
+	gtk_signal_connect(GTK_OBJECT(WID(drawingarea1)), "expose_event", GTK_SIGNAL_FUNC(preview_draw), NULL);
+	gtk_widget_show(dialog);
 
- //       CNX(dialog    ,delete_event,preview_exit_short);
-
-        gtk_widget_set_usize (lookup_widget(dialog,"drawingarea1"),w,h);
-        gtk_widget_show(  dialog);
+	preview = new flyPreview(width, height, WID(drawingarea1));
 }
 
-static uint8_t stack(uint8_t *out, uint8_t *in, int width,int height)
+uint8_t DIA_previewStillAlive(void)
 {
- uint8_t *o1,*o2,*i;
- int x,y;
-        o1=out;
-        o2=out+((width*height)>>1);
-        i=in;
-        for(y=0;y<height>>1;y++)
-        {
-            memcpy(o1,i,width); 
-            memcpy(o2,i+width,width);  
-            o1+=width;
-            o2+=width;
-            i+=2*width;        
-        }   
-    return 1;
+	return (dialog != NULL);
 }
-// return 1 if preview is still running
-uint8_t  GUI_PreviewUpdate(uint8_t *data)
-{
-        if(  dialog)
-        {
 
-                // First convert YV12 to RGB
-                // COL_yv12rgb( uw, uh,data, rgb_render);
-                if(!stacked)
-                {
-                        rgbConv.scale(data,rgb_render);
-                }else
-                {
-                        stack(rgb_alternate,data, uw,uh);
-                        stack(rgb_alternate+uw*uh,data+uw*uh, uw>>1,uh>>1);
-                        stack(rgb_alternate+((5*uw*uh)>>2),data+((5*uw*uh)>>2), uw>>1,uh>>1);
-                        rgbConv.scale(rgb_alternate,rgb_render);
-                }
-                previewRender();
-                if(lock==1)
-                {
-                        dialog=NULL;
-                        return 0;
-                }
-                else
-                        return 1;
-        }
-        return 0;
-}
-uint8_t  GUI_PreviewRun(uint8_t *data)
+uint8_t DIA_previewUpdate(uint8_t *buffer)
 {
-    ADM_assert(0);
-}
+	if (dialog)
+	{
+		preview->setData(buffer);
+		preview->display();
 
-void GUI_PreviewEnd(void)
-{
-        if(dialog && needDestroy)
-        {
-                gtk_widget_destroy(dialog);
-        }
-        if(rgb_render)
-        {
-                delete [] rgb_render;
-                rgb_render=NULL;
-                delete [] rgb_alternate;
-                rgb_alternate=NULL;
-        }
-        dialog=NULL;
-        needDestroy=0;
+		return 1;
+	}
+
+	return 0;
 }
 
-void previewRender(void)
+void DIA_previewEnd(void)
 {
-	if(!dialog) return;
-
-	if (resizer)
+	if(dialog)
 	{
-		resizer->resize(rgb_render, rgbDisplay);
-		GUI_RGBDisplay(rgbDisplay, zoomW, zoomH, WID(drawingarea1));
+		delete preview;
+
+		gtk_widget_destroy(dialog);
+		dialog = NULL;
 	}
-	else
-		GUI_RGBDisplay(rgb_render, uw, uh, WID(drawingarea1));
 }
 
-gboolean         cb_stack(GtkButton * button, gpointer user_data)
+void preview_draw(void)
 {
-	stacked^=1;
-	return FALSE;
+	preview->display();
 }
 
-// Called when window is destroyed
-gboolean preview_exit_short (GtkWidget * widget, GdkEvent * event, gpointer user_data)
-{
-    UNUSED_ARG(widget);
-    UNUSED_ARG(event);
-    UNUSED_ARG(user_data);
-//	printf("destroyed\n");
-        printf("Destroy call\n");
-    if(lock==0 )
-    {
-    		lock=-1;
-		//printf(">\n");
-		needDestroy=0;
-    		GUI_PreviewEnd();
-                printf("Destroyed\n");
-                
-    }
-	return FALSE;
-}
-static gboolean         cb_prev(GtkButton * button, gpointer user_data)
-{
-        HandleAction(ACT_PreviousFrame);
-        return TRUE;
-}
-static gboolean         cb_next(GtkButton * button, gpointer user_data)
-{
-        HandleAction(ACT_NextFrame);
-        return FALSE;
-}
-/**********************************************************
-***********************************************************
-***********************************************************/
+
+/* =================================
+             Common Dialog
+   ================================= */
 GtkWidget*
 create_dialog1 (void)
 {
-  GtkWidget *dialog1;
-  GtkWidget *dialog_vbox1;
-  GtkWidget *vbox1;
-  GtkWidget *toolbar1;
-  GtkIconSize tmp_toolbar_icon_size;
-  GtkWidget *toolitem1;
-  GtkWidget *buttonPrev;
-  GtkWidget *toolitem2;
-  GtkWidget *buttonNext;
-  GtkWidget *toolitem3;
-  GtkWidget *buttonStack;
-  GtkWidget *drawingarea1;
-  GtkWidget *dialog_action_area1;
+	GtkWidget *dialog1;
+	GtkWidget *dialog_vbox1;
+	GtkWidget *vbox1;
+	GtkWidget *drawingarea1;
 
-  dialog1 = gtk_dialog_new ();
-  gtk_window_set_title (GTK_WINDOW (dialog1), _("Preview"));
-  gtk_window_set_type_hint (GTK_WINDOW (dialog1), GDK_WINDOW_TYPE_HINT_DIALOG);
+	dialog1 = gtk_dialog_new ();
+	gtk_window_set_title (GTK_WINDOW (dialog1), _("Preview"));
 
-  dialog_vbox1 = GTK_DIALOG (dialog1)->vbox;
-  gtk_widget_show (dialog_vbox1);
+	dialog_vbox1 = GTK_DIALOG (dialog1)->vbox;
+	gtk_widget_show (dialog_vbox1);
 
-  vbox1 = gtk_vbox_new (FALSE, 0);
-  gtk_widget_show (vbox1);
-  gtk_box_pack_start (GTK_BOX (dialog_vbox1), vbox1, TRUE, TRUE, 0);
+	vbox1 = gtk_vbox_new (FALSE, 0);
+	gtk_widget_show (vbox1);
+	gtk_box_pack_start (GTK_BOX (dialog_vbox1), vbox1, TRUE, TRUE, 0);
 
-  toolbar1 = gtk_toolbar_new ();
-  gtk_widget_show (toolbar1);
-  gtk_box_pack_start (GTK_BOX (vbox1), toolbar1, FALSE, FALSE, 0);
-  gtk_toolbar_set_style (GTK_TOOLBAR (toolbar1), GTK_TOOLBAR_BOTH);
-  tmp_toolbar_icon_size = gtk_toolbar_get_icon_size (GTK_TOOLBAR (toolbar1));
+	drawingarea1 = gtk_drawing_area_new ();
+	gtk_widget_show (drawingarea1);
+	gtk_box_pack_start (GTK_BOX (vbox1), drawingarea1, FALSE, TRUE, 0);
+	gtk_widget_set_size_request (drawingarea1, 100, 100);
 
-  toolitem1 = (GtkWidget*) gtk_tool_item_new ();
-  gtk_widget_show (toolitem1);
-  gtk_container_add (GTK_CONTAINER (toolbar1), toolitem1);
+	// Store pointers to all widgets, for use by lookup_widget().
+	GLADE_HOOKUP_OBJECT_NO_REF (dialog1, dialog1, "dialog1");
+	GLADE_HOOKUP_OBJECT_NO_REF (dialog1, dialog_vbox1, "dialog_vbox1");
+	GLADE_HOOKUP_OBJECT (dialog1, vbox1, "vbox1");
+	GLADE_HOOKUP_OBJECT (dialog1, drawingarea1, "drawingarea1");
 
-  buttonPrev = gtk_button_new_from_stock ("gtk-media-previous");
-  gtk_widget_show (buttonPrev);
-  gtk_container_add (GTK_CONTAINER (toolitem1), buttonPrev);
-
-  toolitem2 = (GtkWidget*) gtk_tool_item_new ();
-  gtk_widget_show (toolitem2);
-  gtk_container_add (GTK_CONTAINER (toolbar1), toolitem2);
-
-  buttonNext = gtk_button_new_from_stock ("gtk-media-next");
-  gtk_widget_show (buttonNext);
-  gtk_container_add (GTK_CONTAINER (toolitem2), buttonNext);
-
-  toolitem3 = (GtkWidget*) gtk_tool_item_new ();
-  gtk_widget_show (toolitem3);
-  gtk_container_add (GTK_CONTAINER (toolbar1), toolitem3);
-
-  buttonStack = gtk_button_new_with_mnemonic (_("Stack Field"));
-  gtk_widget_show (buttonStack);
-  gtk_container_add (GTK_CONTAINER (toolitem3), buttonStack);
-
-  drawingarea1 = gtk_drawing_area_new ();
-  gtk_widget_show (drawingarea1);
-  gtk_box_pack_start (GTK_BOX (vbox1), drawingarea1, TRUE, TRUE, 0);
-
-  dialog_action_area1 = GTK_DIALOG (dialog1)->action_area;
-  gtk_widget_show (dialog_action_area1);
-  gtk_button_box_set_layout (GTK_BUTTON_BOX (dialog_action_area1), GTK_BUTTONBOX_END);
-
-  /* Store pointers to all widgets, for use by lookup_widget(). */
-  GLADE_HOOKUP_OBJECT_NO_REF (dialog1, dialog1, "dialog1");
-  GLADE_HOOKUP_OBJECT_NO_REF (dialog1, dialog_vbox1, "dialog_vbox1");
-  GLADE_HOOKUP_OBJECT (dialog1, vbox1, "vbox1");
-  GLADE_HOOKUP_OBJECT (dialog1, toolbar1, "toolbar1");
-  GLADE_HOOKUP_OBJECT (dialog1, toolitem1, "toolitem1");
-  GLADE_HOOKUP_OBJECT (dialog1, buttonPrev, "buttonPrev");
-  GLADE_HOOKUP_OBJECT (dialog1, toolitem2, "toolitem2");
-  GLADE_HOOKUP_OBJECT (dialog1, buttonNext, "buttonNext");
-  GLADE_HOOKUP_OBJECT (dialog1, toolitem3, "toolitem3");
-  GLADE_HOOKUP_OBJECT (dialog1, buttonStack, "buttonStack");
-  GLADE_HOOKUP_OBJECT (dialog1, drawingarea1, "drawingarea1");
-  GLADE_HOOKUP_OBJECT_NO_REF (dialog1, dialog_action_area1, "dialog_action_area1");
-
-  return dialog1;
+	return dialog1;
 }
-
-
-

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_filters/CMakeLists.txt
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_filters/CMakeLists.txt	2007-07-19 19:39:25 UTC (rev 3418)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_filters/CMakeLists.txt	2007-07-20 23:05:42 UTC (rev 3419)
@@ -5,7 +5,7 @@
 SET(ADM_LIB ADM_filtersGtk)
 #
 SET(${ADM_LIB}_SRCS
-gui_filter.cpp  gui_filterlist.cpp  gui_filtermanager.cpp  gui_filtermanager_dialog.cpp  gui_filtersub.cpp
+gui_filterlist.cpp  gui_filtermanager.cpp  gui_filtermanager_dialog.cpp  gui_filtersub.cpp
 
 )
 ADD_LIBRARY(${ADM_LIB} STATIC ${${ADM_LIB}_SRCS})

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_filters/Makefile.am
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_filters/Makefile.am	2007-07-19 19:39:25 UTC (rev 3418)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_filters/Makefile.am	2007-07-20 23:05:42 UTC (rev 3419)
@@ -7,7 +7,7 @@
 
 libADM_filters_a_METASOURCES = AUTO
 
-libADM_filters_a_SOURCES = gui_filter.cpp  gui_filterlist.cpp  gui_filtermanager.cpp  gui_filtermanager_dialog.cpp  gui_filtersub.cpp
+libADM_filters_a_SOURCES = gui_filterlist.cpp  gui_filtermanager.cpp  gui_filtermanager_dialog.cpp  gui_filtersub.cpp
 
 
 

Deleted: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_filters/gui_filter.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_filters/gui_filter.cpp	2007-07-19 19:39:25 UTC (rev 3418)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_filters/gui_filter.cpp	2007-07-20 23:05:42 UTC (rev 3419)
@@ -1,630 +0,0 @@
-/***************************************************************************
-                          gui_filter.cpp  -  description
-                             -------------------
-    begin                : Wed Mar 27 2002
-    copyright            : (C) 2002 by mean
-    email                : fixounet at free.fr
- ***************************************************************************/
-
-/***************************************************************************
- *                                                                         *
- *   This program is free software; you can redistribute it and/or modify  *
- *   it under the terms of the GNU General Public License as published by  *
- *   the Free Software Foundation; either version 2 of the License, or     *
- *   (at your option) any later version.                                   *
- *                                                                         *
- ***************************************************************************/
-#include "config.h"
-#include <stdio.h>
-#include <stdlib.h>
-#include <string.h>
-
-
-#include <gtk/gtk.h>
-#include <gdk/gdkkeysyms.h>
-
-#include <time.h>
-#include <sys/time.h>
-
-#include "fourcc.h"
-#include "avio.hxx"
-
-#include "avi_vars.h"
-#include "ADM_editor/ADM_edit.hxx"
-#include "ADM_video/ADM_genvideo.hxx"
-#include "ADM_video/ADM_videoNull.h"
-#include "../ADM_userInterfaces/ADM_GTK/ADM_toolkit_gtk/toolkit_gtk.h"
-
-
-
-#include "avi_vars.h"
-#include "ADM_toolkit/toolkit.hxx"
-#include <ADM_assert.h>
-
-#include "ADM_toolkit/filesel.h"
-
-#include "prototype.h"
-#include "ADM_editor/ADM_edit.hxx"
-#include "ADM_video/ADM_genvideo.hxx"
-#include "ADM_filter/video_filters.h"
-#include "ADM_video/ADM_vidPartial.h"
-#include "../ADM_userInterfaces/ADM_GTK/ADM_toolkit_gtk/ADM_gladeSupport.h"
-#include "../ADM_userInterfaces/ADM_GTK/ADM_toolkit_gtk/toolkit_gtk.h"
-#include "ADM_filter/vidVCD.h"
-//__________________________________________
-
-extern AVDMGenericVideoStream *filterCreateFromTag (VF_FILTERS tag,
-						    CONFcouple * conf,
-						    AVDMGenericVideoStream *
-						    in);
-
-extern const char  *filterGetNameFromTag(VF_FILTERS tag);
-typedef enum 
-{
-  A_BEGIN = 10,
-  A_ADD,
-  A_CONFIGURE,
-  A_UP,
-  A_DOWN,
-  A_REMOVE,
-  A_DONE,
-  A_VCD,
-  A_SVCD,
-  A_DVD,
-  A_HALFD1,
-  A_LOAD,
-  A_SAVE,
-  A_PREVIEW,
-  A_PARTIAL,
-  A_SCRIPT,
-  A_DOUBLECLICK,
-  A_END
-}gui_act;
-//_______________________________________
-
-
-static VF_FILTERS new_filter (void);
-
-static void on_action (gui_act action);
-static void on_action_double_click (GtkButton * button, gpointer user_data);
-static void on_action_double_click_1 (GtkButton * button, gpointer user_data);
-static void updateFilterList (void);
-static void wrapToolButton(GtkWidget * wid, gpointer user_data);
-//___________________________________________
-extern FILTER_ENTRY allfilters[MAX_FILTER];
-extern uint32_t nb_video_filter;
-extern FILTER videofilters[MAX_FILTER];
-extern uint32_t nb_active_filter;
-extern ADM_Composer *video_body;
-// display all currently activated filters
-//_______________________________________
-
-extern GtkWidget *create_filterMain (void);
-
-static GtkWidget *dialog;
-static GtkWidget *dialog2;
-static GtkListStore *store;
-static GtkTreeViewColumn *column;
-static GtkCellRenderer *renderer;
-
-/*
-        Open the main filter dialog and call the handlers
-        if needed.
-
-*/
-int
-GUI_handleFilter (void)
-{
-
-#ifndef HAVE_ENCODER
-  return 0;
-}
-#else
-//VF_FILTERS tag;
-
-  getLastVideoFilter ();	// expand video to full size
-
-  // sanity check
-  if (nb_active_filter == 0)
-    {
-      nb_active_filter = 1;
-      videofilters[0].filter =
-	new AVDMVideoStreamNull (video_body, frameStart,
-				 frameEnd - frameStart);
-
-    }
-  dialog = create_filterMain ();
-  store=gtk_list_store_new (1, G_TYPE_STRING);
-  gtk_tree_view_set_model(GTK_TREE_VIEW(WID(treeview2)),GTK_TREE_MODEL (store));
-  gtk_tree_view_columns_autosize(GTK_TREE_VIEW(WID(treeview2)));
-  //gtk_widget_set_size_request (WID(treeview2), 400, 400);
-
-  renderer = gtk_cell_renderer_text_new ();
-  column = gtk_tree_view_column_new_with_attributes ("", renderer,
-                                                      "markup", (GdkModifierType) 0, NULL);
-  gtk_tree_view_append_column (GTK_TREE_VIEW (WID(treeview2)), column);
-  gtk_tree_view_column_set_spacing(column,26);
-//#define CALLME(x,y)   gtk_dialog_add_action_widget (GTK_DIALOG (dialog), WID(x),y)
-
-#define CALLME(x,y) gtk_signal_connect(GTK_OBJECT(WID(x)),"clicked",  GTK_SIGNAL_FUNC(wrapToolButton), (void *) y);
-
-  CALLME (toolbuttonAdd, A_ADD);
-  CALLME (toolbuttonRemove, A_REMOVE);
-  CALLME (toolbuttonProperties, A_CONFIGURE);
-  CALLME (toolbuttonUp, A_UP);
-  CALLME (toolbuttonDown, A_DOWN);
-  CALLME (toolbuttonVCD, A_VCD);
-  CALLME (toolbuttonSVCD, A_SVCD);
-  CALLME (toolbuttonDVD, A_DVD);
-  CALLME (toolbuttonSave, A_SAVE);
-  CALLME (toolbuttonOpen, A_LOAD);
-  CALLME (toolbuttonPreview, A_PREVIEW);
-  CALLME (toolbuttonPartial, A_PARTIAL);
-  CALLME (toolbuttonHD1, A_HALFD1);
-  CALLME (toolbutton13, A_SCRIPT);
-
-  // Add double click
-  gtk_signal_connect (GTK_OBJECT (WID(treeview2)), "row-activated", 
-        GTK_SIGNAL_FUNC (on_action_double_click_1),(void *)NULL);
-
-  //      gtk_dialog_add_action_widget (GTK_DIALOG (dialog), WID(treeview1),A_DOUBLECLICK);
-
-  gtk_widget_set_size_request (WID(treeview2), 400, 400);
-
-  updateFilterList ();
-  gtk_register_dialog (dialog);
-  //gtk_widget_show (dialog);
-  
-  gui_act ac;
-  int run = 1, reply;
-  while (run)
-    {
-      reply = gtk_dialog_run (GTK_DIALOG (dialog));
-      //printf("Action : %d\n",reply);
-      if (reply > A_BEGIN && reply < A_END)
-	{
-	  ac = (gui_act) reply;
-	  on_action (ac);
-	}
-      else
-	switch (reply)
-	  {
-          case GTK_RESPONSE_DELETE_EVENT:
-	  case GTK_RESPONSE_CLOSE:
-	  case GTK_RESPONSE_APPLY:
-	  case GTK_RESPONSE_OK:
-	  case GTK_RESPONSE_CANCEL:
-	    run = 0;
-	    break;
-	  default:
-	    ADM_assert (0);
-	  }
-    }
-  gtk_unregister_dialog (dialog);
-  gtk_widget_destroy (dialog);
-
-  return 1;
-}
-
-// gtk_dialog_add_action_widget seems buggy for toolbar button
-// workaround it...
-void wrapToolButton(GtkWidget * wid, gpointer user_data)
-{
-        gui_act action;
-#ifdef ARCH_64_BITS
-#define TPE long long int
-	long long int dummy;
-#else	
-        int dummy;
-#define TPE int
-#endif
-
-        dummy=(TPE)user_data;
-
-        action=(gui_act) dummy;
-        gtk_dialog_response(GTK_DIALOG(dialog),action);
-}
-//
-// One of the button of the main dialog was pressed
-// Retrieve also the associated filter and handle
-// the action
-//______________________________________________________
-void
-on_action (gui_act action)
-{
-  uint32_t action_parameter;
-  VF_FILTERS tag = VF_INVALID;
-
-  action_parameter = 0;
-  if (nb_active_filter > 1)
-    if (getSelectionNumber
-	(nb_active_filter - 1, WID(treeview2),
-	 store, &action_parameter))
-      action_parameter++;
-
-  switch (action)
-    {
-      // Add
-    case A_ADD:
-      tag = new_filter ();
-      // Raise back the old window
-      gtk_widget_grab_focus (dialog);
-      //
-      if (tag != VF_INVALID)
-	{
-	  CONFcouple *couple;
-	  videofilters[nb_active_filter].filter =
-	    filterCreateFromTag (tag, NULL,
-				 videofilters[nb_active_filter - 1].filter);
-	  if(!videofilters[nb_active_filter].filter->
-	    configure (videofilters[nb_active_filter - 1].filter))
-	  {
-	  	  delete videofilters[nb_active_filter].filter;
-	  	  break;
-	  }
-	  videofilters[nb_active_filter].filter->getCoupledConf (&couple);
-
-
-	  videofilters[nb_active_filter].tag = tag;
-	  videofilters[nb_active_filter].conf = couple;
-	  ;
-	  nb_active_filter++;
-	  updateFilterList ();
-	  //gdk_window_raise(dialog->window);
-	}
-      break;
-    case A_VCD:
-      setVCD ();
-      updateFilterList ();
-      break;
-    case A_SVCD:
-      setSVCD ();
-      updateFilterList ();
-      break;
-    case A_DVD:
-      setDVD ();
-      updateFilterList ();
-      break;
-    case A_HALFD1:
-      setHalfD1 ();
-      updateFilterList ();
-      break;
-    default:
-    case A_DOUBLECLICK:
-      printf ("Double clicked..");
-    //  break;
-    
-    case A_CONFIGURE:
-//            void *p;
-      if (action_parameter)
-	{
-	  if (videofilters[action_parameter].filter->
-	      configure (videofilters[action_parameter - 1].filter))
-	    {
-
-	      CONFcouple *couple;
-	      videofilters[action_parameter].filter->getCoupledConf (&couple);
-	      videofilters[action_parameter].conf = couple;
-//                      updateVideoFilters ();
-	      getFirstVideoFilter ();
-	      updateFilterList ();
-	    }
-	  // Raise back dialog
-	  //gtk_window_set_focus(GTK_WINDOW(dialog));
-	  //gdk_window_raise(dialog->window);
-	}
-      break;
-    case A_PARTIAL:
-
-      if (action_parameter)
-	{
-	  AVDMGenericVideoStream *replace;
-	  CONFcouple *conf;
-
-	  conf = videofilters[action_parameter].conf;
-	  if (videofilters[action_parameter].tag == VF_PARTIAL)	// cannot recurse
-	    {
-              GUI_Error_HIG (_("The filter is already partial"), NULL);
-	    }
-	  else
-	    {
-	      replace =
-		new ADMVideoPartial (videofilters[action_parameter - 1].
-				     filter,
-				     videofilters[action_parameter].tag,
-				     conf);
-	      if(replace->configure (videofilters[action_parameter - 1].filter))
-	      {
-			delete videofilters[action_parameter].filter;
-			if (conf) delete conf;
-			videofilters[action_parameter].filter = replace;
-			replace->getCoupledConf (&conf);
-			videofilters[action_parameter].conf = conf;
-			videofilters[action_parameter].tag = VF_PARTIAL;
-//                updateVideoFilters ();
-			getFirstVideoFilter ();
-			updateFilterList ();
-	      }
-	      else delete replace;
-	    }
-	}
-      break;
-    case A_UP:
-      if (action_parameter > 1)	// Select file
-	{
-	  // swap action parameter & action parameter -1
-	  FILTER tmp;
-	  memcpy (&tmp, &videofilters[action_parameter - 1], sizeof (FILTER));
-	  memcpy (&videofilters[action_parameter - 1],
-		  &videofilters[action_parameter], sizeof (FILTER));
-	  memcpy (&videofilters[action_parameter], &tmp, sizeof (FILTER));
-	  //updateVideoFilters ();
-	  getFirstVideoFilter ();
-	  // select action_parameter -1
-	  updateFilterList ();
-
-	  setSelectionNumber (nb_active_filter - 1,
-			      WID(treeview2),
-			      store, action_parameter - 2);
-
-	}
-      break;
-    case A_DOWN:
-      if (((int) action_parameter < (int) (nb_active_filter - 1)) && (action_parameter))	// Select file
-	{
-	  // swap action parameter & action parameter -1
-	  FILTER tmp;
-	  memcpy (&tmp, &videofilters[action_parameter + 1], sizeof (FILTER));
-	  memcpy (&videofilters[action_parameter + 1],
-		  &videofilters[action_parameter], sizeof (FILTER));
-	  memcpy (&videofilters[action_parameter], &tmp, sizeof (FILTER));
-	  // updateVideoFilters ();
-	  getFirstVideoFilter ();
-	  updateFilterList ();
-	  setSelectionNumber (nb_active_filter - 1,
-			      WID(treeview2),
-			      store, action_parameter);
-
-	}
-      break;
-
-    case A_REMOVE:
-//              CONFcouple *couple;
-      VF_FILTERS tag;
-      AVDMGenericVideoStream *old;
-      if (action_parameter > 0)
-	{
-	  // we store the one we will delete
-	  if (videofilters[action_parameter].conf)
-	    {
-	      delete videofilters[action_parameter].conf;
-	      videofilters[action_parameter].conf = NULL;
-	    }
-	  // recreate derivated filters
-	  for (uint32_t i = action_parameter + 1; i < nb_active_filter; i++)
-	    {
-	      old = videofilters[i - 1].filter;
-	      tag = videofilters[i].tag;
-
-	      videofilters[i - 1].filter = filterCreateFromTag (tag,
-								videofilters
-								[i].conf,
-								videofilters[i
-									     -
-									     2].
-								filter);
-
-	      videofilters[i - 1].conf = videofilters[i].conf;
-	      videofilters[i - 1].tag = tag;
-	      delete old;
-
-	    }
-	  delete videofilters[nb_active_filter - 1].filter;
-	  videofilters[nb_active_filter - 1].filter = NULL;
-	  nb_active_filter--;
-
-	}
-      updateFilterList ();
-      break;
-    case A_DONE:
-
-      break;
-    case A_PREVIEW:
-
-      if (action_parameter > 0)
-	{
-	  AVDMGenericVideoStream *in;
-	  uint32_t w, h, l, f;
-	  ADMImage *data;
-	  extern uint32_t curframe;
-	  in = videofilters[action_parameter].filter;
-	  w = in->getInfo ()->width;
-	  h = in->getInfo ()->height;
-	  data = new ADMImage (w, h);	//(uint8_t *) malloc (w * h * 3);
-	  ADM_assert (data);
-	  in->getFrameNumberNoAlloc (curframe, &l, data, &f);
-
-          GUI_PreviewShow(w,h,data->data);
-
-	  ADM_dealloc (data);
-	}
-
-      break;
-    case A_LOAD:
-#ifdef USE_LIBXML2
-      GUI_FileSelRead (_("Load set of filters"), filterLoadXml);
-#else
-      GUI_FileSelRead (_("Load set of filters"), filterLoad);
-#endif
-      updateFilterList ();
-      break;
-    case A_SAVE:
-      if (nb_active_filter < 2)
-	{
-          GUI_Error_HIG (_("Nothing to save"), NULL);
-	}
-      else
-#ifdef USE_LIBXML2
-            GUI_FileSelWrite (_("Save set of filters"), filterSaveXml);
-#else
-	GUI_FileSelWrite (_("Save set of filters"), filterSave);
-
-#endif
-      break;
-#if 0
-    default:
-      printf ("Unknown action :%d, action param %d\n", action,
-	      action_parameter);
-      ADM_assert (0);
-#endif
-    }
-  //updateFilterList();
-
-}
-//
-extern GtkWidget *create_dialogList (void);
-extern GtkListStore *storeFilterList;
-
-/**
- 	Pop-up a list of all available filters
-	Return the tag identifying the filter selected
-
-*/
-#define NB_TREE 7
-VF_FILTERS new_filter (void)
-{
-
-//  GtkObject *selected;
-  int position = 0;
-  uint32_t sel, max = 0;
-  VF_FILTERS tag = VF_INVALID;
-  GtkWidget             *trees[NB_TREE];
-  GtkListStore          *stores[NB_TREE];
-  GtkTreeViewColumn     *columns[NB_TREE];
-  GtkCellRenderer       *renderers[NB_TREE];
-  int                   startFilter[NB_TREE];
-
-  char *str=NULL;
-
-  GtkTreeIter iter;
-  uint8_t ret = 0;
-
-
-  dialog2 = create_dialogList ();
-  gtk_register_dialog (dialog2);
-  #define LOOK(x){ trees[x-1]=lookup_widget(dialog2,"treeview1"#x);\
-              stores[x-1]=gtk_list_store_new (1, G_TYPE_STRING);}
-  
-  LOOK(1);
-  LOOK(2);
-  LOOK(3);
-  LOOK(4);
-  LOOK(5);
-  LOOK(6);
-  LOOK(7);
-
-  gtk_widget_set_size_request (dialog2, -1, 520);
-  int current_tree=-1;
-  for (uint32_t i = 0; i < nb_video_filter; i++)
-    {
-      if (allfilters[i].viewable==1)
-	{
-                  str = g_strconcat("<span size=\"larger\" weight=\"bold\">", 
-                allfilters[i].name, "</span>\n",  
-                
-                allfilters[i].description, NULL);
-
-                
-
-	  gtk_list_store_append (stores[current_tree], &iter);
-	  gtk_list_store_set (stores[current_tree], &iter, 0,str ,-1);
-          g_free(str);
-	  max++;
-	}else 
-        {
-                current_tree++;
-                if(current_tree>=NB_TREE) break;
-                startFilter[current_tree]=i+1;
-        }
-    }
-  // Add double click
-  
-
-// Attach
-  for(int i=0;i<NB_TREE;i++)
-   {
-        gtk_tree_view_set_model(GTK_TREE_VIEW(trees[i]),GTK_TREE_MODEL (stores[i]));
-        gtk_tree_view_columns_autosize(GTK_TREE_VIEW(trees[i]));
-
-        renderers[i] = gtk_cell_renderer_text_new ();
-        GValue ypad = {0,};
-        g_value_init (&ypad, G_TYPE_INT);
-        g_value_set_int (&ypad, 12);
-        g_object_set_property(G_OBJECT(renderers[i]), "ypad", &ypad);
-        columns[i] = gtk_tree_view_column_new_with_attributes ("", renderers[i],
-                                                      "markup", (GdkModifierType) 0,
-                                                      NULL);
-        gtk_tree_view_append_column (GTK_TREE_VIEW (trees[i]), columns[i]);
-
-        gtk_signal_connect (GTK_OBJECT (trees[i]),
-                      "row-activated",
-                      GTK_SIGNAL_FUNC (on_action_double_click),
-                      (void *) dialog);
-   }
-  if (gtk_dialog_run (GTK_DIALOG (dialog2)) == GTK_RESPONSE_OK)
-    {
-        // 1- identify the current tab/treeview we are in
-        int page;
-
-                page=gtk_notebook_get_current_page(GTK_NOTEBOOK(lookup_widget(dialog2,"notebook1")));
-        // then get the selection
-
-      if ((ret = getSelectionNumber (max, trees[page], stores[page], &sel)))
-	{
-                tag = allfilters[sel+startFilter[page]].tag;
-	}
-    }
-  gtk_unregister_dialog (dialog2);
-  gtk_widget_destroy (dialog2);
-
-  return tag;
-}
-void
-updateFilterList (void)
-{
-GtkTreeIter iter;
-char *str;
-VF_FILTERS fil;
-  gtk_list_store_clear (store);
-  for (uint32_t i = 1; i < nb_active_filter; i++)
-    {
-                gtk_list_store_append (store, &iter);
-                //str=videofilters[i].filter->printConf ();
-                fil=videofilters[i].tag;
-                
-
-                str = g_strconcat("<span size=\"larger\" weight=\"bold\">", 
-                filterGetNameFromTag(fil), "</span>\n",  
-               
-                videofilters[i].filter->printConf (), NULL);
-
-                gtk_list_store_set (store, &iter, 0,str,-1);
-                g_free(str);
-    }
-
-}
-void
-on_action_double_click (GtkButton * button, gpointer user_data)
-{
-
-  gtk_dialog_response (GTK_DIALOG (dialog2), GTK_RESPONSE_OK);
-
-}
-void on_action_double_click_1 (GtkButton * button, gpointer user_data)
-{
-
-  gtk_dialog_response (GTK_DIALOG (dialog), A_DOUBLECLICK);
-
-}
-
-#endif

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_filters/gui_filtermanager.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_filters/gui_filtermanager.cpp	2007-07-19 19:39:25 UTC (rev 3418)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_filters/gui_filtermanager.cpp	2007-07-20 23:05:42 UTC (rev 3419)
@@ -329,18 +329,10 @@
 
     case A_PREVIEW:
         if (!action_parameter) break;
-        AVDMGenericVideoStream *in;
-        uint32_t w, h, l, f;
-        ADMImage *data;
+
         extern uint32_t curframe;
-        in = videofilters[action_parameter].filter;
-        w = in->getInfo ()->width;
-        h = in->getInfo ()->height;
-        data = new ADMImage (w, h);	//(uint8_t *) malloc (w * h * 3);
-        ADM_assert (data);
-        in->getFrameNumberNoAlloc (curframe, &l, data, &f);
-        GUI_PreviewShow(w,h,data->data);
-        ADM_dealloc (data);
+        DIA_filterPreview(_("Preview"), videofilters[action_parameter].filter, curframe);
+
         break;
 
     case A_LOAD:

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_NONE/ADM_gui2/preview_none.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_NONE/ADM_gui2/preview_none.cpp	2007-07-19 19:39:25 UTC (rev 3418)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_NONE/ADM_gui2/preview_none.cpp	2007-07-20 23:05:42 UTC (rev 3419)
@@ -20,23 +20,8 @@
 void UI_getWindowInfo(void *draw, GUI_WindowInfo *xinfo) {}
 void *UI_getDrawWidget(void ) {return NULL;}
 
-void GUI_PreviewInit(uint32_t w , uint32_t h, uint32_t modal)
-{}
-uint8_t 	GUI_PreviewUpdate(uint8_t *data)
-{
-  return 1;
-}
-void 	GUI_PreviewEnd( void)
-{}
-uint8_t  	GUI_PreviewRun(uint8_t *data)
-{
-  return 1;
-}
-uint8_t GUI_PreviewStillAlive( void )
-{
-  return 1;
-}
-void GUI_PreviewShow(uint32_t w, uint32_t h, uint8_t *data)
-{
-}
-
+void DIA_previewInit(uint32_t width, uint32_t height) {}
+uint8_t DIA_previewUpdate(uint8_t *buffer) {return 1;}
+void DIA_previewEnd(void) {}
+uint8_t DIA_previewStillAlive(void) {return 1;}
+uint8_t DIA_filterPreview(char *captionText, AVDMGenericVideoStream *videoStream, uint32_t frame) {}

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/T_flyDialog.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/T_flyDialog.cpp	2007-07-19 19:39:25 UTC (rev 3418)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/T_flyDialog.cpp	2007-07-20 23:05:42 UTC (rev 3419)
@@ -33,8 +33,9 @@
 #include "DIA_flyDialogQt4.h"
 #include "ADM_assert.h"
 
+void ADM_flyDialog::postInit(uint32_t width, uint32_t height, AVDMGenericVideoStream *in,
+							 void *canvas, void *slider, int yuv) {}
 
-//***************************************
 uint8_t  ADM_flyDialog::display(void)
 {
    ADM_QCanvas *view=(ADM_QCanvas *)_canvas;

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/T_preview.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/T_preview.cpp	2007-07-19 19:39:25 UTC (rev 3418)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/T_preview.cpp	2007-07-20 23:05:42 UTC (rev 3419)
@@ -54,32 +54,14 @@
  ColYuvRgb rgbConverter(640,480,1);
 extern void UI_purge( void );
 extern uint8_t UI_sliderResize(uint32_t w);;
+
+void DIA_previewInit(uint32_t width, uint32_t height) {}
+uint8_t DIA_previewUpdate(uint8_t *data) {return 1;}
+void DIA_previewEnd(void) {}
+uint8_t DIA_previewStillAlive(void) {return 1;}
+uint8_t	DIA_filterPreview(char *captionText, AVDMGenericVideoStream *videoStream, uint32_t frame) {}
+
 //****************************************************************************************************
-void GUI_PreviewInit(uint32_t w , uint32_t h, uint32_t modal)
-{}
-//****************************************************************************************************
-uint8_t 	GUI_PreviewUpdate(uint8_t *data)
-{
-  return 1;
-}
-//****************************************************************************************************
-void 	GUI_PreviewEnd( void)
-{}
-//****************************************************************************************************
-uint8_t  	GUI_PreviewRun(uint8_t *data)
-{
-  return 1;
-}
-//****************************************************************************************************
-uint8_t GUI_PreviewStillAlive( void )
-{
-  return 1;
-}
-//****************************************************************************************************
-void GUI_PreviewShow(uint32_t w, uint32_t h, uint8_t *data)
-{
-}
-//****************************************************************************************************
 /*
   Function to display
   Warning the incoming data are YUV!

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_flyDialog.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_flyDialog.cpp	2007-07-19 19:39:25 UTC (rev 3418)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_flyDialog.cpp	2007-07-20 23:05:42 UTC (rev 3419)
@@ -41,19 +41,25 @@
  ADM_flyDialog::ADM_flyDialog(uint32_t width,uint32_t height,AVDMGenericVideoStream *in,
                                 void *canvas, void *slider,int yuv)
 {
+	ADM_assert(_canvas);
+
+	if (slider)
+		ADM_assert(in);
+
   _w=_zoomW=width;
   _h=_zoomH=height;
   _isYuvProcessing=yuv;
   _in=in;
+
     if(isRgbInverted())
-    {
         _rgb=new ColYuvRgb(_w,_h,1);
-    }
     else
     _rgb=new ColYuvRgb(_w,_h);
+
   _rgb->reset(_w,_h);
-  ADM_assert(in);
+
   _yuvBuffer=new ADMImage(_w,_h);
+
   if(_isYuvProcessing)
   {
      _yuvBufferOut=new ADMImage(_w,_h);
@@ -65,14 +71,14 @@
     _yuvBufferOut=NULL;
   }
     _rgbBufferOut =new uint8_t [_w*_h*4];
+
   _slider=slider;
   _canvas=canvas;
-
-  ADM_assert(_slider);
-  ADM_assert(_canvas);
   _cookie=NULL;
   _rgbBufferDisplay=NULL;
   _resizer=NULL;
+
+  postInit(width, height, in, canvas, slider, yuv);
 }
 /**
     \fn cleanup
@@ -106,18 +112,13 @@
 */
 uint8_t    ADM_flyDialog::sliderChanged(void)
 {
-  uint32_t fn= sliderGet(),nb;
+  uint32_t fn= sliderGet();
   uint32_t len,flags;
   
     ADM_assert(_yuvBuffer);
     ADM_assert(_rgbBufferOut);
     ADM_assert(_in);
     
-    nb=_in->getInfo()->nb_frames;
-    fn=fn*nb;
-    fn/=100;
-    if(fn>=nb) fn=nb-1;
-    
     if(!_in->getFrameNumberNoAlloc(fn,&len,_yuvBuffer,&flags))
     {
       printf("[FlyDialog] Cannot get frame %u\n",fn); 

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_flyDialog.h
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_flyDialog.h	2007-07-19 19:39:25 UTC (rev 3418)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_flyDialog.h	2007-07-20 23:05:42 UTC (rev 3419)
@@ -38,6 +38,9 @@
           uint8_t  _isYuvProcessing;
 
 		  ADMImageResizer *_resizer;
+
+  virtual void postInit(uint32_t width,uint32_t height,AVDMGenericVideoStream *in,
+                                    void *canvas, void *slider,int yuv);
   public:
           void    *_cookie; // whatever
           void    *_slider; // widget

Added: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_flyPreview.h
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_flyPreview.h	2007-07-19 19:39:25 UTC (rev 3418)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_flyPreview.h	2007-07-20 23:05:42 UTC (rev 3419)
@@ -0,0 +1,29 @@
+#ifndef FLY_PREVIEW_H
+#define FLY_PREVIEW_H
+class flyPreview : public ADM_flyDialog
+{
+public:
+	uint8_t process(void) {return 1;}
+	uint8_t download(void) {return 1;}
+	uint8_t upload(void) {return 1;}
+	uint8_t cleanup(void) {return 1;}
+	uint8_t setData(uint8_t *buffer) {_rgb->scale(buffer, _rgbBufferOut);}
+
+	flyPreview(uint32_t width, uint32_t height, void *canvas) : 
+		ADM_flyDialog(width, height, NULL, canvas, NULL, 0) {delete _rgbBuffer; _rgbBuffer = NULL;};
+	virtual ~flyPreview(void) {_rgbBuffer = NULL;};
+};
+
+class flySeekablePreview : public ADM_flyDialog
+{
+public:
+	uint8_t process(void) {_rgbBufferOut = _rgbBuffer; return 1;}
+	uint8_t download(void) {return 1;}
+	uint8_t upload(void) {return 1;}
+	uint8_t cleanup(void) {return 1;}
+
+	flySeekablePreview(uint32_t width, uint32_t height, AVDMGenericVideoStream *videoStream, void *canvas, void *slider) : 
+		ADM_flyDialog(width, height, videoStream, canvas, slider, 0) {delete _rgbBufferOut;};
+	virtual ~flySeekablePreview(void) {_rgbBufferOut = NULL;};
+};
+#endif

Modified: branches/avidemux_2.4_branch/avidemux/ADM_video/ADM_genvideo.hxx
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_video/ADM_genvideo.hxx	2007-07-19 19:39:25 UTC (rev 3418)
+++ branches/avidemux_2.4_branch/avidemux/ADM_video/ADM_genvideo.hxx	2007-07-20 23:05:42 UTC (rev 3419)
@@ -40,13 +40,6 @@
 #include "ADM_video/ADM_confCouple.h"
 #include "ADM_image.h"
 
-
-void     GUI_PreviewInit(uint32_t w , uint32_t h, uint32_t modal);
-uint8_t  GUI_PreviewUpdate(uint8_t *data);
-void 	 GUI_PreviewEnd( void);
-uint8_t  GUI_PreviewRun(uint8_t *data);
-uint8_t  GUI_PreviewStillAlive( void );
-void     GUI_PreviewShow(uint32_t w, uint32_t h, uint8_t *data);
 #define Pixel uint8_t
 typedef struct
  {
@@ -127,6 +120,12 @@
 	  				{*couples=NULL;return 0;};
  };
 
+void     DIA_previewInit(uint32_t width, uint32_t height);
+uint8_t  DIA_previewUpdate(uint8_t *data);
+void 	 DIA_previewEnd(void);
+uint8_t  DIA_previewStillAlive(void);
+uint8_t	 DIA_filterPreview(char *captionText, AVDMGenericVideoStream *videoStream, uint32_t frame);
+
  // Pseudo class used to register filters automagically
  // Does not work atm
 class AVDMVideo_FilterDec

Modified: branches/avidemux_2.4_branch/avidemux/gtk_gui.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/gtk_gui.cpp	2007-07-19 19:39:25 UTC (rev 3418)
+++ branches/avidemux_2.4_branch/avidemux/gtk_gui.cpp	2007-07-20 23:05:42 UTC (rev 3419)
@@ -92,7 +92,6 @@
 
 void HandleAction (Action action);
 uint8_t A_rebuildKeyFrame (void);
-extern int GUI_handleFilter (void);
 extern int GUI_handleVFilter (void);
 extern void filterCleanUp (void);
 int A_audioSave(char *name);



From gruntster at mail.berlios.de  Sat Jul 21 01:52:01 2007
From: gruntster at mail.berlios.de (gruntster at mail.berlios.de)
Date: Sat, 21 Jul 2007 01:52:01 +0200
Subject: [Avidemux-svn-commit] r3420 -
	branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI
Message-ID: <200707202352.l6KNq1rC009311@sheep.berlios.de>

Author: gruntster
Date: 2007-07-21 01:51:53 +0200 (Sat, 21 Jul 2007)
New Revision: 3420

Modified:
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_flyDialog.cpp
Log:
[Preview] assert fix (oops)

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_flyDialog.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_flyDialog.cpp	2007-07-20 23:05:42 UTC (rev 3419)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_flyDialog.cpp	2007-07-20 23:51:53 UTC (rev 3420)
@@ -41,7 +41,7 @@
  ADM_flyDialog::ADM_flyDialog(uint32_t width,uint32_t height,AVDMGenericVideoStream *in,
                                 void *canvas, void *slider,int yuv)
 {
-	ADM_assert(_canvas);
+	ADM_assert(canvas);
 
 	if (slider)
 		ADM_assert(in);



From gruntster at mail.berlios.de  Sat Jul 21 03:10:41 2007
From: gruntster at mail.berlios.de (gruntster at mail.berlios.de)
Date: Sat, 21 Jul 2007 03:10:41 +0200
Subject: [Avidemux-svn-commit] r3421 - in
	branches/avidemux_2.4_branch/avidemux: .
	ADM_userInterfaces/ADM_commonUI
Message-ID: <200707210110.l6L1Afkq015050@sheep.berlios.de>

Author: gruntster
Date: 2007-07-21 03:10:27 +0200 (Sat, 21 Jul 2007)
New Revision: 3421

Modified:
   branches/avidemux_2.4_branch/avidemux/ADM_preview.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_flyPreview.h
Log:
[Preview] enable playback when a zoom mode has been set and the Separate preview window is open

Modified: branches/avidemux_2.4_branch/avidemux/ADM_preview.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_preview.cpp	2007-07-20 23:51:53 UTC (rev 3420)
+++ branches/avidemux_2.4_branch/avidemux/ADM_preview.cpp	2007-07-21 01:10:27 UTC (rev 3421)
@@ -293,7 +293,6 @@
               case  ADM_PREVIEW_SEPARATE:
                   preview=last;
                   break;
-                  /* no break here, not a mistake */
               case  ADM_PREVIEW_NONE:
                   break;
               case  ADM_PREVIEW_OUTPUT:
@@ -370,16 +369,20 @@
       case ADM_PREVIEW_SEPARATE:
             ADM_assert(preview);
             ADM_assert(previewImage);
-            if(zoom==ZOOM_1_1 || renderHasAccelZoom()  )
-            {
+
               if( !video_body->getUncompressedFrame(framenum+playbackOffset,rdrImage,&flags))
               {
                   return 0; 
               }
               UI_setFrameType(  rdrImage->flags,rdrImage->_Qp);
-              if(!defered_display) renderUpdateImage(rdrImage->data,zoom);
-            }else
+
+            if(zoom==ZOOM_1_1 || renderHasAccelZoom()  )
             {
+              if(!defered_display) 
+				  renderUpdateImage(rdrImage->data,zoom);
+            }
+			else
+            {
                 ADM_assert(resizer);
                 ADM_assert(resized);
                 resizer->resize(rdrImage,resized);

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_flyPreview.h
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_flyPreview.h	2007-07-20 23:51:53 UTC (rev 3420)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_flyPreview.h	2007-07-21 01:10:27 UTC (rev 3421)
@@ -23,7 +23,7 @@
 	uint8_t cleanup(void) {return 1;}
 
 	flySeekablePreview(uint32_t width, uint32_t height, AVDMGenericVideoStream *videoStream, void *canvas, void *slider) : 
-		ADM_flyDialog(width, height, videoStream, canvas, slider, 0) {delete _rgbBufferOut;};
+		ADM_flyDialog(width, height, videoStream, canvas, slider, 0) {delete _rgbBufferOut; _rgbBufferOut = NULL;};
 	virtual ~flySeekablePreview(void) {_rgbBufferOut = NULL;};
 };
 #endif



From gruntster at mail.berlios.de  Sat Jul 21 05:38:17 2007
From: gruntster at mail.berlios.de (gruntster at mail.berlios.de)
Date: Sat, 21 Jul 2007 05:38:17 +0200
Subject: [Avidemux-svn-commit] r3422 -
	branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog
Message-ID: <200707210338.l6L3cHWZ022381@sheep.berlios.de>

Author: gruntster
Date: 2007-07-21 05:38:04 +0200 (Sat, 21 Jul 2007)
New Revision: 3422

Modified:
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_preview.cpp
Log:
[Preview] fix filter preview (oops)

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_preview.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_preview.cpp	2007-07-21 01:10:27 UTC (rev 3421)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_preview.cpp	2007-07-21 03:38:04 UTC (rev 3422)
@@ -96,6 +96,7 @@
 	gtk_widget_show(dialog);
 
 	seekablePreview = new flySeekablePreview(width, height, videoStream, WID(drawingarea1), WID(scale));
+	seekablePreview->process();
 	seekablePreview->resizeImage(zoomW, zoomH);
 	seekablePreview->sliderSet(frame);
 	seekablePreview->sliderChanged();



From mean at mail.berlios.de  Sat Jul 21 17:46:42 2007
From: mean at mail.berlios.de (mean at BerliOS)
Date: Sat, 21 Jul 2007 17:46:42 +0200
Subject: [Avidemux-svn-commit] r3423 - in
	branches/avidemux_2.4_branch/avidemux: .
	ADM_userInterfaces/ADM_GTK/ADM_dialog
	ADM_userInterfaces/ADM_GTK/ADM_ocr ADM_userInterfaces/ADM_commonUI
Message-ID: <200707211546.l6LFkgE5025064@sheep.berlios.de>

Author: mean
Date: 2007-07-21 17:46:41 +0200 (Sat, 21 Jul 2007)
New Revision: 3423

Modified:
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/Makefile.am
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_ocr/Makefile.am
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/Makefile.am
   branches/avidemux_2.4_branch/avidemux/Makefile.am
Log:
[Automake] Crude hack to avoid circular dependancy

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/Makefile.am
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/Makefile.am	2007-07-21 03:38:04 UTC (rev 3422)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/Makefile.am	2007-07-21 15:46:41 UTC (rev 3423)
@@ -1,14 +1,14 @@
 
-noinst_LIBRARIES = libADM_dialog.a 
+noinst_LIBRARIES = libADM_dialogGtk.a 
 
 INCLUDES = $(all_includes) $(GTK_CFLAGS) $(XML_CFLAGS)  $(FREETYPE_CFLAGS) -DADM_SUBVERSION=@ADM_SUBVERSION@ \
 		-I../../../ADM_libraries/ADM_utilities \
 		-I../../ADM_commonUI -I../../.. -I../../../ADM_libraries/ADM_lavutil \
 		-I../../../ADM_inputs -I../../../ADM_outputs
 
-libADM_dialog_a_METASOURCES = AUTO
+libADM_dialogGtk_a_METASOURCES = AUTO
 
-libADM_dialog_a_SOURCES =  DIA_vcodec.cpp DIA_acodec.cpp \
+libADM_dialogGtk_a_SOURCES =  DIA_vcodec.cpp DIA_acodec.cpp \
 	DIA_properties.cpp  DIA_about.cpp DIA_recent.cpp \
 	DIA_resize.cpp DIA_working.cpp \
 	DIA_working.h DIA_busy.cpp DIA_busy.h DIA_exLame.cpp DIA_pipe.cpp  \

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_ocr/Makefile.am
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_ocr/Makefile.am	2007-07-21 03:38:04 UTC (rev 3422)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_ocr/Makefile.am	2007-07-21 15:46:41 UTC (rev 3423)
@@ -1,5 +1,5 @@
 
-noinst_LIBRARIES = libADM_ocr.a 
+noinst_LIBRARIES = libADM_ocrGtk.a 
 
 INCLUDES = $(all_includes) $(GTK_CFLAGS) $(XML_CFLAGS)  $(FREETYPE_CFLAGS) \
 		-I../../../ADM_libraries/ADM_utilities \
@@ -7,9 +7,9 @@
 		-I../../../ADM_inputs -I../../../ADM_outputs \
 		-I../../../ADM_ocr 
 
-libADM_ocr_a_METASOURCES = AUTO
+libADM_ocrGtk_a_METASOURCES = AUTO
 
-libADM_ocr_a_SOURCES =  adm_editglyph.cpp  adm_ocr.cpp
+libADM_ocrGtk_a_SOURCES =  adm_editglyph.cpp  adm_ocr.cpp
 
 EXTRA_DIST =  
 

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/Makefile.am
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/Makefile.am	2007-07-21 03:38:04 UTC (rev 3422)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/Makefile.am	2007-07-21 15:46:41 UTC (rev 3423)
@@ -1,4 +1,4 @@
-noinst_LIBRARIES = libADM_CommonUI.a 
+noinst_LIBRARIES = libADM_CommonUI.a libmergedCommonUI.a
 libADM_CommonUI_a_METASOURCES = AUTO
 libADM_CommonUI_a_SOURCES = GUI_sdlRender.cpp  GUI_xvRender.cpp  \
 DIA_resizeWiz.cpp DIA_builtin.cpp DIA_postproc.cpp DIA_enter.cpp \
@@ -14,7 +14,11 @@
 DIA_animated.cpp \
 DIA_ocr.cpp
 
+commonObjs:=$(subst .cpp,.o,$(libADM_CommonUI_a_SOURCES))
 
+libmergedCommonUI.a :  $(commonObjs) 
+	$(LD) -r -o libmergedCommonUI.o  $(commonObjs)  && touch libmergedCommonUI.a 
+
 INCLUDES = $(all_includes) $(GTK_CFLAGS) $(XML_CFLAGS)  $(FREETYPE_CFLAGS) -DADM_SUBVERSION=@ADM_SUBVERSION@ \
 		-I./../../ADM_libraries/ADM_utilities \
 		-I./../ADM_commonUI -I../../.. -I./../../ADM_libraries/ADM_lavutil \

Modified: branches/avidemux_2.4_branch/avidemux/Makefile.am
===================================================================
--- branches/avidemux_2.4_branch/avidemux/Makefile.am	2007-07-21 03:38:04 UTC (rev 3422)
+++ branches/avidemux_2.4_branch/avidemux/Makefile.am	2007-07-21 15:46:41 UTC (rev 3423)
@@ -23,11 +23,10 @@
 
 user_interface_gtk = \
 		./ADM_ocr/libADM_ocr.a					\
-		./ADM_userInterfaces/ADM_GTK/ADM_filters/libADM_filters.a \
-		./ADM_userInterfaces/ADM_commonUI/libADM_CommonUI.a	\
-		./ADM_userInterfaces/ADM_GTK/ADM_dialog/libADM_dialog.a	\
-		./ADM_userInterfaces/ADM_commonUI/libADM_CommonUI.a	\
-		./ADM_userInterfaces/ADM_GTK/ADM_ocr/libADM_ocr.a	\
+		./ADM_userInterfaces/ADM_commonUI/libmergedCommonUI.o  \
+		./ADM_userInterfaces/ADM_GTK/ADM_ocr/libADM_ocrGtk.a	\
+		./ADM_userInterfaces/ADM_GTK/ADM_filters/libADM_filtersGtk.a \
+		./ADM_userInterfaces/ADM_GTK/ADM_dialog/libADM_dialogGtk.a	\
 		./ADM_userInterfaces/ADM_GTK/ADM_dialogFactory/libADM_dialogFactory.a	\
 		./ADM_userInterfaces/ADM_GTK/ADM_gui2/libADM_gui2.a	\
 		./ADM_userInterfaces/ADM_GTK/ADM_toolkit_gtk/libADM_toolkit_gtk.a	 



From mean at mail.berlios.de  Sat Jul 21 17:48:44 2007
From: mean at mail.berlios.de (mean at BerliOS)
Date: Sat, 21 Jul 2007 17:48:44 +0200
Subject: [Avidemux-svn-commit] r3424 - in
	branches/avidemux_2.4_branch/avidemux: . ADM_codecs
Message-ID: <200707211548.l6LFmiKY025190@sheep.berlios.de>

Author: mean
Date: 2007-07-21 17:48:44 +0200 (Sat, 21 Jul 2007)
New Revision: 3424

Modified:
   branches/avidemux_2.4_branch/avidemux/ADM_codecs/ADM_codecs.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_codecs/ADM_ffmp43.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_codecs/ADM_ffmp43.h
   branches/avidemux_2.4_branch/avidemux/main.cpp
Log:
[LAV] Move init, give more info to decoder, hook logs

Modified: branches/avidemux_2.4_branch/avidemux/ADM_codecs/ADM_codecs.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_codecs/ADM_codecs.cpp	2007-07-21 15:46:41 UTC (rev 3423)
+++ branches/avidemux_2.4_branch/avidemux/ADM_codecs/ADM_codecs.cpp	2007-07-21 15:48:44 UTC (rev 3424)
@@ -319,7 +319,7 @@
 
   if (isMpeg4Compatible (fcc) == 1)
     {
-      return (decoders *) (new decoderFFMpeg4 (w, h, extraLen, extraData));
+      return (decoders *) (new decoderFFMpeg4 (w, h, fcc,extraLen, extraData));
       //    return(decoders *)( new decoderXvid(w,h));
       //    return(decoders *)( new decoderDIVX(w,h));
     }

Modified: branches/avidemux_2.4_branch/avidemux/ADM_codecs/ADM_ffmp43.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_codecs/ADM_ffmp43.cpp	2007-07-21 15:46:41 UTC (rev 3423)
+++ branches/avidemux_2.4_branch/avidemux/ADM_codecs/ADM_ffmp43.cpp	2007-07-21 15:48:44 UTC (rev 3424)
@@ -51,6 +51,8 @@
 AVCodec *codec=avcodec_find_decoder(x);\
 if(!codec) {GUI_Alert(_("Internal error finding codec"#x));ADM_assert(0);} \
   codecId=x; \
+  _context->workaround_bugs=FF_BUG_AUTODETECT; \
+  _context->error_concealment=3; \
   if (avcodec_open(_context, codec) < 0)  \
                       { \
                                         printf(" Decoder init: Lavcodec :"#x" video decoder failed!\n"); \
@@ -445,8 +447,9 @@
   _allowNull = 1;
   decoderMultiThread ();
   WRAP_Open (CODEC_ID_MPEG4);
+  printf("Non low delay mpeg4 decoder initialized\n");
 }
-decoderFFMpeg4::decoderFFMpeg4 (uint32_t w, uint32_t h, uint32_t l, uint8_t * d):decoderFF (w,
+decoderFFMpeg4::decoderFFMpeg4 (uint32_t w, uint32_t h, uint32_t fcc,uint32_t l, uint8_t * d):decoderFF (w,
 	   h)
 {
 // force low delay as avidemux don't handle B-frames
@@ -456,6 +459,8 @@
   _refCopy = 1;			// YUV420 only
   _context->extradata = (uint8_t *) d;
   _context->extradata_size = (int) l;
+  _context->codec_tag=fcc;
+  _context->stream_codec_tag=fcc;
   decoderMultiThread ();
   //  _context->flags|=FF_DEBUG_VIS_MV;
   WRAP_Open (CODEC_ID_MPEG4);
@@ -634,6 +639,36 @@
   WRAP_Open (CODEC_ID_FLV1);
 }
 
+extern uint8_t  lavformat_init(void);
+extern void     avcodec_init(void );
+extern  void    avcodec_register_all(void );
+extern "C"
+{
+  void adm_lavLogCallback(void  *instance, int level, const char* fmt, va_list list);
+}
+/**
+    \fn ADM_lavInit
+    \brief Init both lavcodec and lavformat
+*/
+void ADM_lavInit(void)
+{
+    avcodec_init();
+    avcodec_register_all();
+    lavformat_init();
+    av_log_set_callback(adm_lavLogCallback);
+#ifdef ADM_DEBUG
+  //  av_log_set_level(AV_LOG_DEBUG);
+#endif
 
+}
+void adm_lavLogCallback(void  *instance, int level, const char* fmt, va_list list)
+{
+    if(level>1) return;
+    char buf[256];
+  
+    vsnprintf(buf, sizeof(buf), fmt, list);
+    printf("[LAV] %s\n",buf);
+}
 
+
 #endif

Modified: branches/avidemux_2.4_branch/avidemux/ADM_codecs/ADM_ffmp43.h
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_codecs/ADM_ffmp43.h	2007-07-21 15:46:41 UTC (rev 3423)
+++ branches/avidemux_2.4_branch/avidemux/ADM_codecs/ADM_ffmp43.h	2007-07-21 15:48:44 UTC (rev 3424)
@@ -94,7 +94,7 @@
 
 
 public:
-  decoderFFMpeg4 (uint32_t w, uint32_t h, uint32_t l, uint8_t * d);
+  decoderFFMpeg4 (uint32_t w, uint32_t h, uint32_t fcc,uint32_t l, uint8_t * d);
   // mpeg4 can have B-frame
   virtual uint8_t bFramePossible (void)
   {

Modified: branches/avidemux_2.4_branch/avidemux/main.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/main.cpp	2007-07-21 15:46:41 UTC (rev 3423)
+++ branches/avidemux_2.4_branch/avidemux/main.cpp	2007-07-21 15:48:44 UTC (rev 3424)
@@ -51,14 +51,10 @@
 extern uint8_t filterDynLoad(const char *path);
 typedef void *FCT_VOID(void *);
 uint8_t lavformat_init(void);
-
-#ifdef USE_FFMPEG
-     extern "C" {
-     extern void        avcodec_init(void );
-     extern  void 	avcodec_register_all(void );
+extern void     ADM_lavInit();
+extern "C" {
      extern uint8_t     ADM_InitMemcpy(void);
-                       };
-#endif                       
+};
 
 #ifdef USE_SDL
 extern "C" {
@@ -262,13 +258,7 @@
 	}
 	ADM_dealloc(dynloadPath);
 
-// external filter
-#ifdef USE_FFMPEG
-    avcodec_init();
-    avcodec_register_all();
-    lavformat_init();
-#endif
-
+    ADM_lavInit();
 #ifdef HAVE_AUDIO
     AVDM_audioInit();
 #endif



From mean at mail.berlios.de  Sat Jul 21 18:37:54 2007
From: mean at mail.berlios.de (mean at BerliOS)
Date: Sat, 21 Jul 2007 18:37:54 +0200
Subject: [Avidemux-svn-commit] r3425 - branches/avidemux_2.4_branch/po
Message-ID: <200707211637.l6LGbs5j009250@sheep.berlios.de>

Author: mean
Date: 2007-07-21 18:37:51 +0200 (Sat, 21 Jul 2007)
New Revision: 3425

Modified:
   branches/avidemux_2.4_branch/po/de.po
Log:
[I18N] German translation update by Joo M.

Modified: branches/avidemux_2.4_branch/po/de.po
===================================================================
--- branches/avidemux_2.4_branch/po/de.po	2007-07-21 15:48:44 UTC (rev 3424)
+++ branches/avidemux_2.4_branch/po/de.po	2007-07-21 16:37:51 UTC (rev 3425)
@@ -7,14 +7,13 @@
 msgstr ""
 "Project-Id-Version: de\n"
 "Report-Msgid-Bugs-To: \n"
-"POT-Creation-Date: 2007-06-19 18:39+0200\n"
-"PO-Revision-Date: 2007-06-20 08:07+0100\n"
+"POT-Creation-Date: 2007-07-16 21:16+0200\n"
+"PO-Revision-Date: 2007-07-16 21:35+0100\n"
 "Last-Translator: Joo Martin <debian at joomart.de>\n"
 "Language-Team: German\n"
 "MIME-Version: 1.0\n"
 "Content-Type: text/plain; charset=UTF-8\n"
 "Content-Transfer-Encoding: 8bit\n"
-"X-Poedit-Language: German\n"
 "X-Poedit-Country: GERMANY\n"
 
 #: avidemux/ADM_audiocodec/ADM_codecwma.cpp:75
@@ -32,7 +31,7 @@
 
 #: avidemux/ADM_audiofilter/audioencoder_lame.cpp:215
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_properties.cpp:110
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:223
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:236
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_audioFilter.cpp:104
 #: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_props.cpp:101
 #, c-format
@@ -53,7 +52,7 @@
 
 #: avidemux/ADM_audiofilter/audioencoder_lame.cpp:219
 msgid "C_hannel mode:"
-msgstr "Ka_nalmodus:"
+msgstr "Ka_nal Modus:"
 
 #: avidemux/ADM_audiofilter/audioencoder_lame.cpp:222
 msgid "CBR"
@@ -72,14 +71,15 @@
 msgstr "Bit_rate Modus:"
 
 #: avidemux/ADM_audiofilter/audioencoder_lame.cpp:241
-#: avidemux/ADM_audiofilter/audioencoder_vorbis.cpp:287
+#: avidemux/ADM_audiofilter/audioencoder_vorbis.cpp:285
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_audioconfig.cpp:59
 msgid "_Bitrate:"
-msgstr "_Bitrate:"
+msgstr "_Bitrate (kb/s):"
 
 #: avidemux/ADM_audiofilter/audioencoder_lame.cpp:246
-#: avidemux/ADM_audiofilter/audioencoder_vorbis.cpp:289
+#: avidemux/ADM_audiofilter/audioencoder_vorbis.cpp:287
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_mjpeg.cpp:40
+#: avidemux/ADM_videoFilter/ADM_vidDecDec.cpp:204
 msgid "_Quality:"
 msgstr "Qualit?t:"
 
@@ -97,17 +97,19 @@
 "Die Anzahl Kan?le ist gr??er als vom gew?hlten Audio Codec verarbeiten kann.\n"
 "?ndere entweder den Codec oder benutze den Mixer-Filter, um weniger Kan?le zu haben."
 
-#: avidemux/ADM_audiofilter/audioencoder_vorbis.cpp:270
+#: avidemux/ADM_audiofilter/audioencoder_vorbis.cpp:268
 msgid "VBR"
 msgstr "VBR"
 
-#: avidemux/ADM_audiofilter/audioencoder_vorbis.cpp:271
+#: avidemux/ADM_audiofilter/audioencoder_vorbis.cpp:269
 msgid "Quality based"
-msgstr "qualitit?tsbasiert"
+msgstr "qualit?tsbasiert"
 
-#: avidemux/ADM_audiofilter/audioencoder_vorbis.cpp:273
+#: avidemux/ADM_audiofilter/audioencoder_vorbis.cpp:271
 #: avidemux/ADM_videoFilter/ADM_vidMcDeint.cpp:113
 #: avidemux/ADM_videoFilter/ADM_vidDGbob.cpp:91
+#: avidemux/ADM_videoFilter/ADM_vidDecDec.cpp:203
+#: avidemux/ADM_videoFilter/ADM_vidYadif.cpp:181
 msgid "_Mode:"
 msgstr "_Modus:"
 
@@ -120,7 +122,7 @@
 msgstr "Fehler beim Konvertieren nach BMP"
 
 #: avidemux/ADM_libraries/ADM_utilities/ADM_imageUtils.cpp:417
-#: avidemux/gtk_gui.cpp:1917
+#: avidemux/gtk_gui.cpp:1923
 msgid "Something bad happened"
 msgstr "Irgendwas Schlimmes ist passiert"
 
@@ -130,18 +132,22 @@
 
 #: avidemux/ADM_libraries/ADM_utilities/ADM_imageUtils.cpp:481
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_toolkit_gtk/TLK_filesel.cpp:335
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:105
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:110
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:117
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:126
 #: avidemux/ADM_outputs/oplug_ogm/op_ogsave.cpp:112
 #: avidemux/ADM_outputs/oplug_mpegFF/oplug_vcdff.cpp:380
-#: avidemux/ADM_ocr/ADM_ocrLoadSave.h:71
-#: avidemux/gtk_gui.cpp:890
-#: avidemux/gtk_gui.cpp:1522
+#: avidemux/ADM_ocr/adm_glyph.cpp:221
+#: avidemux/gtk_gui.cpp:895
+#: avidemux/gtk_gui.cpp:1527
 msgid "File error"
 msgstr "Dateifehler"
 
 #: avidemux/ADM_libraries/ADM_utilities/ADM_imageUtils.cpp:481
 #: avidemux/ADM_outputs/oplug_ogm/op_ogsave.cpp:112
 #: avidemux/ADM_outputs/oplug_mpegFF/oplug_vcdff.cpp:380
-#: avidemux/gtk_gui.cpp:1522
+#: avidemux/gtk_gui.cpp:1527
 #, c-format
 msgid "Cannot open \"%s\" for writing."
 msgstr "Kann \"%s\" nicht zum Schreiben ?ffnen."
@@ -193,112 +199,43 @@
 msgid "Incompatible frame rate"
 msgstr "Inkompatible Bildrate"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_hue.cpp:84
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_hue.cpp:76
 msgid "Hue"
 msgstr "Farbton"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_hue.cpp:184
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_hue.cpp:186
 msgid "Hue/Saturation"
 msgstr "Farbton/S?ttigung"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_hue.cpp:198
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_hue.cpp:200
 msgid "<b>Hue:</b>"
 msgstr "<b>Farbton:</b>"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_hue.cpp:206
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_hue.cpp:208
 msgid "<b>Saturation:</b>"
 msgstr "<b>S?ttigung:</b>"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_preview.cpp:280
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_preview.cpp:319
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_filters/gui_filtersub.cpp:150
 msgid "Preview"
 msgstr "Vorschau"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_preview.cpp:316
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_preview.cpp:355
 msgid "Stack Field"
 msgstr "Stapel-Feld"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_animated.cpp:83
-msgid "Select background picture"
-msgstr "Hintergrund-Bild ausw?hlen"
-
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_animated.cpp:169
-msgid "Animated Menu"
-msgstr "Animiertes Men?"
-
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_animated.cpp:193
-msgid "BackGround Image :"
-msgstr "Hintergrund Bild :"
-
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_animated.cpp:200
-msgid "Standard"
-msgstr "Standard"
-
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_animated.cpp:207
-msgid "NTSC (default is PAL)"
-msgstr "NTSC (voreingestellt ist PAL)"
-
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_animated.cpp:227
-msgid "Vignette Width"
-msgstr "Vignette Breite"
-
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_animated.cpp:234
-msgid "Vignette Height"
-msgstr "Vignette H?he"
-
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_animated.cpp:257
-msgid "<b>General</b>"
-msgstr "<b>generell</b>"
-
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_animated.cpp:276
-msgid "Chapter 1"
-msgstr "Kapitel 1"
-
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_animated.cpp:283
-msgid "Chapter 2"
-msgstr "Kapitel 2"
-
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_animated.cpp:290
-msgid "Chapter 3"
-msgstr "Kapitel 3"
-
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_animated.cpp:297
-msgid "Chapter 4"
-msgstr "Kapitel 4"
-
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_animated.cpp:304
-msgid "Chapter 5"
-msgstr "Kapitel 5"
-
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_animated.cpp:311
-msgid "Chapter 6"
-msgstr "Kapitel 6"
-
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_animated.cpp:324
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_animated.cpp:333
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_animated.cpp:342
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_animated.cpp:351
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_animated.cpp:360
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_animated.cpp:369
-msgid "Start frame for this vignette."
-msgstr "Starte Bild f?r diese Vignette."
-
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_animated.cpp:372
-msgid "<b>TimeCode</b>"
-msgstr "<b>Zeit-Code</b>"
-
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_coloryuv.cpp:155
 msgid "ColorYuv (From avisynth)"
 msgstr "Yuv-Farben (von AviSynth)"
 
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_coloryuv.cpp:179
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_contrast.cpp:197
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_contrast.cpp:215
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_contrast.cpp:210
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_contrast.cpp:228
 msgid "Contrast"
 msgstr "Kontrast"
 
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_coloryuv.cpp:186
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_contrast.cpp:224
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_contrast.cpp:237
 msgid "Brightness"
 msgstr "Helligkeit"
 
@@ -316,7 +253,7 @@
 msgstr "Brillianz Y"
 
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_coloryuv.cpp:214
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_contrast.cpp:242
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_contrast.cpp:255
 msgid "Chroma U"
 msgstr "Farbintensit?t U"
 
@@ -355,8 +292,8 @@
 #: avidemux/ADM_videoFilter/ADM_vidDecTelecide.cpp:101
 #: avidemux/ADM_videoFilter/ADM_lavpp_deint.cpp:105
 #: avidemux/ADM_videoFilter/ADM_vidRotate.cpp:264
-#: avidemux/gtk_gui.cpp:1995
-#: avidemux/gtk_gui.cpp:2094
+#: avidemux/gtk_gui.cpp:2001
+#: avidemux/gtk_gui.cpp:2100
 msgid "None"
 msgstr "Keine"
 
@@ -404,102 +341,77 @@
 msgid "<b>frame2</b>"
 msgstr "<b>Bild2</b>"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_ocr.cpp:85
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_ocr.cpp:57
 msgid "Mini OCR"
 msgstr "Mini OCR"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_ocr.cpp:118
-msgid "<b>Glyphs</b>"
-msgstr "<b>Schriftzeichen</b>"
-
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_ocr.cpp:132
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_ocr.cpp:75
 msgid "# of Glyphs :"
 msgstr "# von Schriftzeichen :"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_ocr.cpp:140
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_ocr.cpp:82
 msgid "# of lines"
 msgstr "# von Zeilen"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_ocr.cpp:148
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_ocr.cpp:156
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_ocr.cpp:89
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_ocr.cpp:96
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp:661
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp:668
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp:675
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp:788
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_idx_pg.cpp:166
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_idx_pg.cpp:206
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp:633
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp:649
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp:665
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp:695
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp:632
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp:648
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp:664
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp:694
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_resize.cpp:419
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_resize.cpp:433
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1403
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1429
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_tdeint.cpp:82
 msgid "0"
 msgstr "0"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_ocr.cpp:164
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_ocr.cpp:103
 msgid "<b>Stats</b>"
 msgstr "<b>Status</b>"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_ocr.cpp:186
-msgid "  "
-msgstr "  "
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_ocr.cpp:125
+msgid "Current Glyph"
+msgstr "Aktuelles Schriftzeichen"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_ocr.cpp:195
-msgid "VobSub"
-msgstr "VobSub"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_ocr.cpp:138
+msgid " Text:"
+msgstr " Text:"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_ocr.cpp:208
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_ocr.cpp:271
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_asharp.cpp:254
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_ocr.cpp:145
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_asharp.cpp:268
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_properties.cpp:262
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_properties.cpp:283
 msgid " "
 msgstr " "
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_ocr.cpp:217
-msgid "Output Srt"
-msgstr "Ausgabe SRT"
-
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_ocr.cpp:222
-msgid "<b>Files</b>"
-msgstr "<b>Dateien</b>"
-
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_ocr.cpp:228
-msgid "StartOcr"
-msgstr "StartOcr"
-
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_ocr.cpp:249
-msgid "Current Glyph"
-msgstr "Aktuelles Schriftzeichen"
-
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_ocr.cpp:263
-msgid " Text:"
-msgstr " Text:"
-
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_ocr.cpp:287
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_ocr.cpp:160
 msgid "Calibrate"
 msgstr "Kalibrieren"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_ocr.cpp:292
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_ocr.cpp:165
 msgid "Skip all"
 msgstr "Alles ?berspringen"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_ocr.cpp:297
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_ocr.cpp:170
 msgid "Skip Glyph"
 msgstr "Schriftzeichen ?berspringen"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_ocr.cpp:302
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_ocr.cpp:175
 msgid "Ignore glyph"
 msgstr "Schriftzeichen ignorieren"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_ocr.cpp:307
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_ocr.cpp:180
 msgid "Ok"
 msgstr "Ok"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_ocr.cpp:316
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_ocr.cpp:189
 msgid "<b>Bitmap</b>"
 msgstr "<b>Bitmap</b>"
 
@@ -569,11 +481,11 @@
 
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp:646
 msgid "<b>Average Bitrate:</b>"
-msgstr "<b>Durchschnittl. Bitrate:</b>"
+msgstr "<b>Durchschnittl. Bitrate (kb/s):</b>"
 
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp:654
 msgid "0 kB/s"
-msgstr "0 kB/s"
+msgstr "0 kb/s"
 
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp:699
 msgid "<b>Video Size:</b>"
@@ -594,11 +506,11 @@
 msgstr "0 MB"
 
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp:764
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_working.cpp:244
 msgid "<b>Elapsed:</b>"
 msgstr "<b>Vergangene Zeit:</b>"
 
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp:772
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_working.cpp:258
 msgid "<b>Time Remaining:</b>"
 msgstr "<b>Verbleibende Zeit:</b>"
 
@@ -608,7 +520,7 @@
 
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp:802
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_idx_pg.cpp:198
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp:437
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp:447
 msgid "00:00:00"
 msgstr "00:00:00"
 
@@ -621,7 +533,7 @@
 msgstr "Priorit?t:"
 
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp:843
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:178
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:186
 #: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_xvid4.cpp:61
 #: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_x264.cpp:105
 #: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_srt.cpp:108
@@ -633,7 +545,7 @@
 msgstr "?ber Normal"
 
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp:845
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:180
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:188
 #: avidemux/ADM_outputs/oplug_avi/op_avisave.cpp:74
 msgid "Normal"
 msgstr "Normal"
@@ -643,7 +555,7 @@
 msgstr "Unter Normal"
 
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp:847
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:182
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:190
 #: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_xvid4.cpp:59
 #: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_x264.cpp:104
 #: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_srt.cpp:107
@@ -654,43 +566,43 @@
 msgid "Pause / Abort"
 msgstr "Pause / Abbruch"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_eq2.cpp:330
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_eq2.cpp:343
 msgid "MPlayer eq2"
 msgstr "MPlayer eq2"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_eq2.cpp:356
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_eq2.cpp:369
 msgid "Brigh_tness:"
 msgstr "Helligkei_t:"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_eq2.cpp:364
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_eq2.cpp:377
 msgid "_Saturation:"
 msgstr "_S?ttigung:"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_eq2.cpp:399
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_eq2.cpp:412
 msgid "_Contrast:"
 msgstr "_Kontrast:"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_eq2.cpp:425
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_eq2.cpp:438
 msgid "_Initial:"
 msgstr "Anfangswert:"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_eq2.cpp:451
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_eq2.cpp:464
 msgid "_Red:"
 msgstr "_Rot:"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_eq2.cpp:468
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_eq2.cpp:481
 msgid "_Green:"
 msgstr "_Gr?n:"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_eq2.cpp:476
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_eq2.cpp:489
 msgid "_Blue:"
 msgstr "_Blau:"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_eq2.cpp:484
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_eq2.cpp:497
 msgid "_Weight:"
 msgstr "Ge_wichtung:"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_eq2.cpp:510
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_eq2.cpp:523
 msgid "<b>Gamma</b>"
 msgstr "<b>Gamma</b>"
 
@@ -738,15 +650,15 @@
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:185
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:369
 msgid "Average bitrate (kb/s):"
-msgstr "Durchschnittl. Bitrate (KB/s):"
+msgstr "Durchschnittl. Bitrate (kb/s):"
 
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:354
 msgid "Target bitrate (kb/s):"
-msgstr "Ziel-Bitrate (KB/s):"
+msgstr "Ziel-Bitrate (kb/s):"
 
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:362
 msgid "Target size (MBytes):"
-msgstr "Ziel-Gr??e (MB):"
+msgstr "Ziel-Gr??e (MBytes):"
 
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:479
 msgid "Select Custom Matrix File to write"
@@ -802,7 +714,7 @@
 
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:785
 msgid "Target video bitrate"
-msgstr "Ziel-Video-Bitrate"
+msgstr "Ziel-Video-Bitrate (kb/s)"
 
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:792
 msgid "Constant quantizer - each frame will get the same compression"
@@ -1129,7 +1041,7 @@
 
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:1238
 msgid "Rate distortion quantization, will find optimal encoding for each block"
-msgstr "Verzerrungsgrad Quantization, findet die optimale Kodierung f?r jeden Block"
+msgstr "Verzerrungsabh?ngige Quantization, findet die optimale Kodierung f?r jeden Block"
 
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:1240
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid.cpp:309
@@ -1173,11 +1085,11 @@
 
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:1316
 msgid "How much of the overflow the codec can eat into during undersized sections - larger values will bridge the gap faster"
-msgstr ""
+msgstr "Wieviel ?berlauf kann vom Kodierer w?hrend der winzigen Abschnitte verschluckt werden - gr??ere Werte schlie?en die L?cke schneller"
 
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:1321
 msgid "How much of the overflow the codec can eat into during oversized sections - larger values will bridge the gap faster"
-msgstr ""
+msgstr "Wieviel ?berlauf kann vom Kodierer w?hrend der ?bergro?en Abschnitte verschluckt werden - gr??ere Werte schlie?en die L?cke schneller"
 
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:1323
 msgid "Two pass tuning"
@@ -1197,15 +1109,15 @@
 
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:1362
 msgid "The higher this value, the more bits get taken from frames larger than the average size, and redistributed to others"
-msgstr ""
+msgstr "Je gr??er dieser Wert ist, desto mehr Bits werden von Bildern, die gr??er als die durchschnittliche Gr??e sind, genommen und an andere Bilder weiter verteilt"
 
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:1367
 msgid "The higher this value, the more bits get assigned to frames below the average frame size"
-msgstr ""
+msgstr "Je gr??er dieser Wert ist, desto mehr Bits werden Bildern zugewiesen, die kleiner als die durchschnittliche Gr??e sind"
 
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:1372
 msgid "0 = default from core (let XviD decide), else overflow payback percent per frame"
-msgstr ""
+msgstr "0 = Voreinstellung der zentralen Einheit (lass' XviD entscheiden), oder ?berlaufr?ckgabe in Prozent pro Bild"
 
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:1374
 msgid "Curve compression"
@@ -1217,11 +1129,11 @@
 
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:1591
 msgid "<b>Intra Matrix</b>"
-msgstr "<b>Intra Matrix</b>"
+msgstr "<b>Intrablock Matrix</b>"
 
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:1609
 msgid "<b>Inter Matrix</b>"
-msgstr "<b>Inter Matrix</b>"
+msgstr "<b>Interblock Matrix</b>"
 
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:560
 msgid "X264 configuration"
@@ -1233,7 +1145,7 @@
 
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:587
 msgid "Entry input for target file size or bitrate"
-msgstr ""
+msgstr "Ziel-Dateigr??e oder Bitrate eingeben"
 
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:589
 msgid "Quantizer (0-51):"
@@ -1241,11 +1153,11 @@
 
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:602
 msgid "Constant Quantizer - Each frame will the same compression. Low numbers equal higher quality while high numbers equal lower quality"
-msgstr ""
+msgstr "Konstanter Quantizer - Jedes Bild mit der gleichen Kompression. Niedrigere Zahlen entsprechen h?herer Qualit?t, hohe Zahlen entsprechen niedrigerer Qualit?t"
 
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:612
 msgid "Target Size:"
-msgstr "Zielgr??e:"
+msgstr "Zielgr??e: "
 
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:624
 msgid "Single Pass - Quality Quantizer (Average)"
@@ -1359,7 +1271,7 @@
 
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:705
 msgid "Set how many previous frames can be referenced by a P/B-frame. Numbers above 5 do not seem to improve quality greatly. Numbers are 3 to 5 are recommended"
-msgstr ""
+msgstr "Setzt die Anzahl von voraus gegangenen Bildern die von P/B-Bildern referenziert werden k?nnen. Zahlen ?ber 5 verbessern die Qualit?t kaum mehr. Zahlen zwischen 3 und 5 werden empfohlen."
 
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:708
 msgid "Max. Ref. frames"
@@ -1371,7 +1283,7 @@
 
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:728
 msgid "Define how many pixels are analysised. The higher the range the more accurate the analysis but the slower the encoding time"
-msgstr ""
+msgstr "Anzahl der Pixel, die analysiert werden sollen. Je h?her dieser Bereich desto sorgf?ltiger die Analyse, aber umso langsamer die Kodierungszeit"
 
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:731
 #: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_xvid4.cpp:89
@@ -1392,15 +1304,15 @@
 
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:744
 msgid "Calculate referencing individually based on each partition"
-msgstr ""
+msgstr "Berechnet die Referenzierung individuell, abh?ngig vom jeweiligen Teilbereich"
 
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:750
 msgid "Fast P-Skip"
-msgstr "Schneller P-Skip"
+msgstr "Schnelles ?berspringen von P-Bildern"
 
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:753
 msgid "Uncheck to enable fast p-skip"
-msgstr "Abw?hlen f?r schnellen P-Skip"
+msgstr "Abw?hlen des schnellen ?berspringen von P-Bildern"
 
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:756
 msgid "DCT decimate"
@@ -1412,7 +1324,7 @@
 
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:763
 msgid "Encode interlaced"
-msgstr "kodieren im Halbbildmodus"
+msgstr "Kodieren im Halbbildmodus"
 
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:765
 msgid "<b>Motion Estimation</b>"
@@ -1421,7 +1333,7 @@
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:792
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:804
 msgid "Enforce the size of a decoded pixel decoded to a certain value. Leave this at 1:1 for non-anamorphic video"
-msgstr ""
+msgstr "Erzwingt die Gr??e von dekodierten Pixeln, die zu einem bestimmten Wert dekodiert wurden. Lass' den Wert auf 1:1 f?r nicht-anamorphe Videos"
 
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:793
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:805
@@ -1430,13 +1342,13 @@
 msgstr "1"
 
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:808
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp:549
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp:559
 msgid "Custom"
 msgstr "Individuell"
 
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:813
 msgid "Set a custom aspect ratio. Default 1:1 is recommended for most video."
-msgstr ""
+msgstr "Individuelles Seitenverh?ltnis festlegen. Die Vorgabe 1:1 wird f?r die meisten Videos empfohlen."
 
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:818
 msgid "Predefined Aspect Ratios"
@@ -1458,7 +1370,7 @@
 
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:881
 msgid "Lossless compression method which usually improves the bitrate usage by 15% (especially on high bitrate). Helps the quality a lot but is slower. "
-msgstr ""
+msgstr "Verlustlose Kompressionsmethode, welche die Bitratenausnutzung gew?hnlich um 15% verbessert (besonders bei hohen Bitraten). Hilft der Qualit?t sehr, ist aber langsamer."
 
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:884
 #: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_x264.cpp:107
@@ -1468,7 +1380,7 @@
 
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:893
 msgid "Use rate distortion quantization to find optimal encoding for each block. Level 0 equals disabled, level 1 equals normal and level 2 equals high"
-msgstr ""
+msgstr "Verzerrungsabh?ngige Quantization verwenden, um die optimale Kodierung f?r jeden Block zu finden. Wert 0 = deaktiviert, Wert 1 = normal, Wert 2 = hoch"
 
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:900
 #: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_x264.cpp:109
@@ -1486,15 +1398,15 @@
 
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:919
 msgid "Enable in-loop deblocking to filter the video"
-msgstr ""
+msgstr "Aktiviert die 'in-loop' Deblockierung als Videofilter"
 
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:932
 msgid "Set the amount of blurring to use for block edges when they are found"
-msgstr ""
+msgstr "Betrag f?r Unsch?rfe festlegen, das bei gefundenen Blockkanten zu verwenden ist"
 
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:941
 msgid "Define the level for when deblocking is applied"
-msgstr ""
+msgstr "Die Schwelle festlegen, ab der das Deblockieren anzuwenden ist"
 
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:944
 msgid "<i>Threshold</i>"
@@ -1516,11 +1428,11 @@
 
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:989
 msgid "General block breakdown transformation"
-msgstr ""
+msgstr "Transformation von allgemeinen Blockunterteilungen"
 
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:992
 msgid "8x8, 8x16 and 16x8 P-frame search"
-msgstr "8x8, 8x16 und 16x8 P-Bild suchen"
+msgstr "8x8, 8x16 und 16x8 P-Bild Suche"
 
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:995
 msgid "Improve the P-frame quality"
@@ -1528,7 +1440,7 @@
 
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:998
 msgid "8x8, 8x16 and 16x8 B-frame search"
-msgstr "8x8, 8x16 und 16x8 B-Bild suchen"
+msgstr "8x8, 8x16 und 16x8 B-Bild Suche"
 
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1001
 msgid "Improve the B-frame quality"
@@ -1536,7 +1448,7 @@
 
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1004
 msgid "4x4, 4x8 and 8x4 P-frame search"
-msgstr "4x4, 4x8 und 8x4 P-Bild suchen"
+msgstr "4x4, 4x8 und 8x4 P-Bild Suche"
 
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1007
 msgid "Further improve the P-frame quality"
@@ -1544,19 +1456,19 @@
 
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1009
 msgid "8x8 Intra search"
-msgstr "8x8 Intra Suche"
+msgstr "8x8 Intrablock Suche"
 
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1012
 msgid "Enable DCT Intra block search to improve quality"
-msgstr ""
+msgstr "Aktiviert DCT Intrablock-Suche, um die Qualit?t zu verbessern"
 
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1015
 msgid "4x4 Intra search"
-msgstr "4x4 Intra Suche"
+msgstr "4x4 Intrablock Suche"
 
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1018
 msgid "Further enable DCT Intra block search to improve quality"
-msgstr ""
+msgstr "Aktiviert zus?tzliche DCT Intrablock-Suche, um die Qualit?t zu verbessern"
 
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1021
 msgid "<b>Partition Macroblocks</b>"
@@ -1564,19 +1476,19 @@
 
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1043
 msgid "Bias"
-msgstr "Bias"
+msgstr "Tendenz (Bias)"
 
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1056
 msgid "Increase / decrease probability for how often B-frames are used. Will not violate the maximum consecutive frame limit"
-msgstr ""
+msgstr "M?glichkeit vergr??ern/verkleinern, wie oft B-Bilder verwendet werden sollen. Dies verletzt nicht das Limit f?r die maximale Anzahl aufeinander folgender B-Bilder"
 
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1065
 msgid "Set the maximum number of consecutive B-frames. This defines how many duplicate frames can be droped. Numbers 2 to 5 are recommended. This greatly improves the use of bitrate and quality"
-msgstr ""
+msgstr "Die maximale Anzahl aufeinander folgender B-Bilder festlegen. Damit wird definiert, wieviele doppelte Bilder verworfen werden k?nnen. Zahlen 2 bis 5 werden empfohlen. Dies verbessert vor allem die Ausnutzung der Bitrate und die Qualit?t"
 
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1068
 msgid "Max Consecutive"
-msgstr "Max Aufeinanderfolge"
+msgstr "Max. Aufeinanderfolge"
 
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1079
 msgid "Bidirectional ME"
@@ -1584,15 +1496,15 @@
 
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1084
 msgid "Jointly optimize both Motion Vector's in B-frames. This will improve quality but take more time for encoding"
-msgstr ""
+msgstr "Verbundene Optimierung beider Bewegungsvektoren in B-Bildern. Dadurch wird die Qualit?t verbessert, das Kodieren kostet aber mehr Zeit"
 
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1086
 msgid "Weighted biprediction"
-msgstr ""
+msgstr "Gewichtete Doppelvorhersage (Biprediction)"
 
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1091
 msgid "Enables weighting of B-frames to help fades"
-msgstr ""
+msgstr "Aktiviert die Gewichtung von B-Bildern als Hilfe f?r ?berblendungen"
 
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1094
 msgid "Adaptative DCT"
@@ -1608,7 +1520,7 @@
 
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1107
 msgid "Allow B-frames to make references non-linearly to another B-frame (instead of creating a duplicate copy)"
-msgstr ""
+msgstr "Nichtlineare Referenzen von B-Bildern  zu anderen B-Bildern erlauben (anstatt doppelte Kopie zu erstellen)"
 
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1113
 msgid "B-Frame Direct Mode:  "
@@ -1640,7 +1552,7 @@
 
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1162
 msgid "Keyframe boost (%)"
-msgstr "I-Bild (keyframe) Erh?hung (%):"
+msgstr "I-Bild (keyframe) Erh?hung (%)"
 
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1169
 msgid "B-frame reduction (%)"
@@ -1652,7 +1564,7 @@
 
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1189
 msgid "Set how much bitrate is deducted from a B-frame as compared to the previous P-frame"
-msgstr ""
+msgstr "Legt fest, wieviel von der Bitrate eines B-Bildes abgezogen wird im Vergleich zum vorherigen P-Bild"
 
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1198
 msgid "Define how much the bitrate can fluctuate over the entire video. 0% results in a constant bitrate stream, while 100% results in a pure quality based bitrate stream"
@@ -1684,7 +1596,7 @@
 
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1265
 msgid "Define how much the quantizer rate can change between two consecutive frames"
-msgstr ""
+msgstr "Legt fest, wie stark sich der Quantizer zwischen zwei aufeinander folgenden Bildern ?ndern darf."
 
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1268
 msgid "<b>Quantization Limits</b>"
@@ -1753,11 +1665,11 @@
 
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1455
 msgid "Reduced fluctuations in Quantizer (before curve compression)"
-msgstr ""
+msgstr "Schwankungen des Quantizer reduzieren (vor der Kurvenkompression)"
 
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1464
 msgid "Reduce fluctuations in QP (after curve compression)"
-msgstr ""
+msgstr "Schwankungen des Quantizer reduzieren (nach der Kurvenkompression)"
 
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1467
 msgid "Quantizer Compression"
@@ -1765,11 +1677,11 @@
 
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1474
 msgid "Temp. Blur of est Frame Complexity"
-msgstr ""
+msgstr "Temp. Unsch?rfe der gesch?tzten Bildkomplexit?t"
 
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1481
 msgid "Temp. Blur of Quant after CC"
-msgstr ""
+msgstr "Temp. Unsch?rfe der Quant. nach CC"
 
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1488
 msgid "<b>Misc</b>"
@@ -1785,7 +1697,7 @@
 
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1530
 msgid "Quantization difference between chroma (color) and luma (brightness)"
-msgstr "Quantization Unterschied zwischen Farbintensit?t (Farbe) and Brillianz (Helligkeit)"
+msgstr "Quantization-Unterschied zwischen Farbintensit?t (Farbe) and Brillianz (Helligkeit)"
 
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1533
 msgid "Factor between I and P frame Quants"
@@ -1813,7 +1725,7 @@
 
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1595
 msgid "Flat matrix"
-msgstr ""
+msgstr "breite Matrix"
 
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1609
 msgid "Edit a loaded custom quantization matrix file"
@@ -1875,49 +1787,49 @@
 msgid "<b>Mode</b>"
 msgstr "<b>Modus</b>"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_mpdelogo.cpp:356
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_mpdelogo.cpp:378
 msgid "Mplayer Delogo"
 msgstr "Mplayer Delogo (Logo-Entfernung)"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_mpdelogo.cpp:374
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_mpdelogo.cpp:396
 msgid "X"
 msgstr "X"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_mpdelogo.cpp:381
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_mpdelogo.cpp:403
 msgid "Y"
 msgstr "Y"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_mpdelogo.cpp:388
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_mpdelogo.cpp:410
 msgid "W"
 msgstr "W"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_mpdelogo.cpp:395
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_mpdelogo.cpp:417
 msgid "H"
 msgstr "H"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_mpdelogo.cpp:402
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_mpdelogo.cpp:424
 msgid "Band"
 msgstr "Band"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_chromaShift.cpp:72
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_asharp.cpp:72
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_chromaShift.cpp:68
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_asharp.cpp:73
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_contrast.cpp:74
 msgid "ASHARP"
 msgstr "ASHARP"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_chromaShift.cpp:189
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_chromaShift.cpp:199
 msgid "ChromaShift"
 msgstr "Farbintensit?ts-Verschiebung"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_chromaShift.cpp:203
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_chromaShift.cpp:213
 msgid "U Shift :"
 msgstr "U Verschiebung:"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_chromaShift.cpp:210
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_chromaShift.cpp:220
 msgid "V Shift :"
 msgstr "V Verschiebung:"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_chromaShift.cpp:252
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_chromaShift.cpp:262
 msgid "<b>Preview</b>"
 msgstr "<b>Vorschau</b>"
 
@@ -1965,7 +1877,7 @@
 msgstr "Dank an ?bersetzer"
 
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_about.cpp:69
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:266
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:272
 msgid "Avidemux"
 msgstr "Avidemux"
 
@@ -2339,7 +2251,7 @@
 
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid.cpp:258
 msgid "Constant Bitrate (kbps)"
-msgstr "Konstante Bitrate (KB/s)"
+msgstr "Konstante Bitrate (kb/s)"
 
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid.cpp:266
 msgid "Dual pass (MBytes)"
@@ -2435,23 +2347,23 @@
 msgid "Enter parameters (i.e. -b 192 -m s ...)"
 msgstr "Parameter eingeben (z.B. -b 192 -m -s ...)"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_asharp.cpp:185
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_asharp.cpp:199
 msgid "ASharp by MarcFD"
 msgstr "ASharp von MarcFD"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_asharp.cpp:198
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_asharp.cpp:212
 msgid "Threshold :"
 msgstr "Schwelle :"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_asharp.cpp:206
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_asharp.cpp:220
 msgid "Strength :"
 msgstr "St?rke :"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_asharp.cpp:214
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_asharp.cpp:228
 msgid "Block Adaptative :"
 msgstr "Block anpassungsf?hig:"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_asharp.cpp:222
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_asharp.cpp:236
 msgid "Unknown flag :"
 msgstr "Unbekannter Schalter:"
 
@@ -2463,131 +2375,132 @@
 msgid "Processing"
 msgstr "Bearbeitung"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_working.cpp:243
-msgid "<b>Elasped:</b>"
-msgstr "<b>Vergangen:</b>"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_working.cpp:259
+msgid "<b>Time remaining:</b>"
+msgstr "<b>Verbleibende Zeit:</b>"
 
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_busy.cpp:120
 msgid "Busy"
 msgstr "arbeitet"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp:403
-msgid "Bitrate Calculator"
-msgstr "Bitrate Taschenrechner"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp:401
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:992
+msgid "Calculator"
+msgstr "Taschenrechner"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp:431
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp:414
+msgid "<b>Target</b>"
+msgstr "<b>Ziel</b>"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp:441
 msgid "Duration:"
 msgstr "Dauer:"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp:451
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp:461
 msgid "_Medium:"
 msgstr "_Medium:"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp:462
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp:472
 msgid "_Format:"
 msgstr "_Format:"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp:473
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp:531
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp:483
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp:541
 msgid "Total size (custom)"
 msgstr "Gesamtgr??e (individuell)"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp:483
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp:493
 msgid "_Custom size (MB):"
 msgstr "_Individuelle Gr??e (MB):"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp:497
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp:507
 msgid "Output container format"
 msgstr "Ausgabe-Container-Format"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp:501
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp:511
 #: avidemux/ADM_editor/ADM_outputfmt.h:38
 msgid "AVI"
 msgstr "AVI"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp:505
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp:515
 #: avidemux/ADM_editor/ADM_outputfmt.h:46
 msgid "OGM"
 msgstr "OGM"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp:509
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp:519
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_lavcodec.cpp:61
 msgid "MPEG"
 msgstr "MPEG"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp:524
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp:534
 msgid "Total size"
 msgstr "Gesamtgr??e"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp:528
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp:538
 msgid "1x 80 min. CD"
 msgstr "1x 80 min. CD"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp:533
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp:543
 msgid "2x 80 min. CD"
 msgstr "2x 80 min. CD"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp:537
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp:547
 msgid "1x 74 min. CD"
 msgstr "1x 74 min. CD"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp:541
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp:551
 msgid "2x 74 min. CD"
 msgstr "2x 74 min. CD"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp:545
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp:555
 msgid "DVD5"
 msgstr "DVD5"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp:555
-msgid "<b>Target</b>"
-msgstr "<b>Ziel</b>"
-
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp:575
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp:571
 msgid "Track _1:"
 msgstr "Spur _1:"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp:583
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp:579
 msgid "Audio bitrate in kb/s for track 1 (0 for no audio)"
-msgstr "Audio Bitrate in KB/s f?r Spur 1 (0 wenn ohne Audio)"
+msgstr "Audio Bitrate in kb/s f?r Spur 1 (0 wenn ohne Audio)"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp:591
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp:586
 msgid "Track _2: "
 msgstr "Spur _2: "
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp:599
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp:594
 msgid "Audio bitrate in kb/s for track 2 (optional)"
-msgstr "Audio Bitrate in KB/s f?r Spur 2 (optional)"
+msgstr "Audio Bitrate in kb/s f?r Spur 2 (optional)"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp:603
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp:598
 msgid "<b>Audio Bitrate</b>"
 msgstr "<b>Audio Bitrate</b>"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp:625
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp:624
 msgid "Audio size (MB):"
 msgstr "Audio Gr??e (MB):"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp:641
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp:640
 msgid "Video size (MB):"
 msgstr "Video Gr??e (MB):"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp:657
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp:656
 msgid "Total size (MB):"
 msgstr "Gesamtgr??e (MB):"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp:679
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp:678
 msgid "Video bitrate:"
 msgstr "Video Bitrate:"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp:687
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp:686
 msgid "Bits per pixel:"
 msgstr "Bits pro Pixel:"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp:703
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp:702
 msgid "0.0"
 msgstr "0.0"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp:711
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp:710
 msgid "<b>Result</b>"
 msgstr "<b>Ergebnis</b>"
 
@@ -2604,11 +2517,13 @@
 msgstr "Wiederholen"
 
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_properties.cpp:47
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:306
 #: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_props.cpp:26
 msgid "No"
 msgstr "Nein"
 
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_properties.cpp:47
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:307
 #: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_props.cpp:26
 msgid "Yes"
 msgstr "Ja"
@@ -2655,7 +2570,7 @@
 #: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_props.cpp:110
 #, c-format
 msgid "%lu Bps / %lu kbps"
-msgstr "%lu B/s / %lu kB/s"
+msgstr "%lu Byte/s,  %lu kb/s"
 
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_properties.cpp:136
 #: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_props.cpp:128
@@ -2693,7 +2608,7 @@
 msgstr "Seitenverh?ltnis:"
 
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_properties.cpp:318
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1021
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1056
 msgid "<b>Video</b>"
 msgstr "<b>Video</b>"
 
@@ -2738,28 +2653,33 @@
 msgstr "Variable Bitrate:"
 
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_properties.cpp:496
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1061
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1096
 msgid "<b>Audio</b>"
 msgstr "<b>Audio</b>"
 
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_jobs.cpp:25
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_jobs.cpp:26
 msgid "Ready"
 msgstr "Fertig"
 
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_jobs.cpp:25
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_jobs.cpp:26
 msgid "Succeeded"
 msgstr "Gelungen"
 
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_jobs.cpp:25
-#: avidemux/gtk_gui.cpp:2272
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_jobs.cpp:26
+#: avidemux/gtk_gui.cpp:2278
 msgid "Failed"
 msgstr "Fehlgeschlagen"
 
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_jobs.cpp:25
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_jobs.cpp:26
 msgid "Deleted"
 msgstr "Gel?scht"
 
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_jobs.cpp:25
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_jobs.cpp:26
 msgid "Running"
 msgstr "L?uft gerade"
 
@@ -2777,6 +2697,8 @@
 
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_jobs.cpp:134
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_jobs.cpp:172
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_jobs.cpp:183
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_jobs.cpp:196
 msgid "Sure!"
 msgstr "Sicher!"
 
@@ -2789,10 +2711,12 @@
 msgstr "Sollen wirklich alle Jobs gel?scht werden ?"
 
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_jobs.cpp:172
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_jobs.cpp:183
 msgid "Delete job"
 msgstr "Job l?schen"
 
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_jobs.cpp:172
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_jobs.cpp:183
 #, c-format
 msgid "Are you sure you want to delete %s job ?"
 msgstr "Soll wirklich der %s Job gel?scht werden ?"
@@ -2821,11 +2745,11 @@
 msgid "Run Job"
 msgstr "Job starten"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_contrast.cpp:238
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_contrast.cpp:251
 msgid "Luma"
 msgstr "Brillianz"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_contrast.cpp:246
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_contrast.cpp:259
 msgid "Chroma v"
 msgstr "Farbintensit?t V"
 
@@ -2873,7 +2797,7 @@
 msgid "Extra Settings"
 msgstr "Extra Einstellungen"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_equalizer.cpp:433
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_equalizer.cpp:449
 msgid "Equalizer"
 msgstr "Equalizer"
 
@@ -2895,7 +2819,7 @@
 
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_resize.cpp:362
 msgid "Destination"
-msgstr "Ziel :"
+msgstr "Ziel "
 
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_resize.cpp:380
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_resize.cpp:402
@@ -2935,31 +2859,31 @@
 msgid "Lanczos3"
 msgstr "Lanczos3"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_crop.cpp:263
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_crop.cpp:273
 msgid "Crop Settings"
 msgstr "Zuschnitt Einstellungen"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_crop.cpp:297
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_crop.cpp:307
 msgid "AutoCrop"
 msgstr "Auto-Zuschnitt"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_crop.cpp:319
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_crop.cpp:329
 msgid "Reset"
 msgstr "Zur?ck setzen"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_crop.cpp:328
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_crop.cpp:338
 msgid "Crop Left :"
 msgstr "Zuschnitt Links:"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_crop.cpp:336
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_crop.cpp:346
 msgid "Crop Top:"
 msgstr "Zuschnitt Oben:"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_crop.cpp:344
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_crop.cpp:354
 msgid "Crop Right:"
 msgstr "Zuschnitt Rechts:"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_crop.cpp:352
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_crop.cpp:362
 msgid "Crop Bottom:"
 msgstr "Zuschnitt Unten:"
 
@@ -2968,22 +2892,22 @@
 msgstr "Video Kodierer"
 
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_vcodec.cpp:118
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1041
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1081
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1076
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1116
 msgid "Configure"
 msgstr "Konfigurieren"
 
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_srt.cpp:92
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_srt.cpp:224
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_srt.cpp:237
 msgid "Subtitle Size and Position"
 msgstr "Untertitel Gr??e und Position"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_srt.cpp:238
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_srt.cpp:251
 msgid "Font Size:"
 msgstr "Schriftgr??e:"
 
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_jobs_save.cpp:49
-msgid "Select video to write"
+msgid "Select Video to Write"
 msgstr "Zu schreibendes Video ausw?hlen"
 
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_jobs_save.cpp:63
@@ -2991,42 +2915,42 @@
 msgstr "Ung?ltiger Dateiname"
 
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_jobs_save.cpp:63
-msgid "Please select or enter a valid filename"
-msgstr "Bitte g?ltigen Dateinamen ausw?hlen oder eingeben"
+msgid "Please select or enter a valid filename."
+msgstr "Bitte g?ltigen Dateinamen ausw?hlen oder eingeben."
 
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_jobs_save.cpp:69
 msgid "Invalid jobname"
 msgstr "Ung?ltiger Job-Name"
 
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_jobs_save.cpp:69
-msgid "Please select or enter a valid jobname"
-msgstr "Bitte g?ltigen Jobnamen ausw?hlen oder eingeben"
+msgid "Please select or enter a valid jobname."
+msgstr "Bitte g?ltigen Jobnamen ausw?hlen oder eingeben."
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_jobs_save.cpp:111
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_jobs_save.cpp:110
 msgid "Save Job"
 msgstr "Job speichern"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_jobs_save.cpp:130
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_jobs_save.cpp:131
 msgid "Select the output file"
 msgstr "Ausgabe-Datei ausw?hlen"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_jobs_save.cpp:144
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_jobs_save.cpp:145
 msgid "_Browse..."
 msgstr "_Auflisten..."
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_jobs_save.cpp:153
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_jobs_save.cpp:154
 msgid "Job name displayed in the job list and used as the script filename"
 msgstr "Jobname, der in der Job-Liste angezeigt und als Script-Dateiname verwendet wird "
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_jobs_save.cpp:162
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_jobs_save.cpp:163
 msgid "Filename of the audio/video output"
 msgstr "Dateiname f?r die Audio/Video Ausgabe"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_jobs_save.cpp:165
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_jobs_save.cpp:166
 msgid "_Job name:"
 msgstr "_Job Name:"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_jobs_save.cpp:172
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_jobs_save.cpp:173
 msgid "Output _file:"
 msgstr "Ausgabe _Datei:"
 
@@ -3060,19 +2984,19 @@
 msgid "Configure codec"
 msgstr "Konfiguriere Codec"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_bindings.cpp:427
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_bindings.cpp:437
 msgid "Input"
 msgstr "Eingang"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_bindings.cpp:428
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_bindings.cpp:438
 msgid "Output"
 msgstr "Ausgabe"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_bindings.cpp:429
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_bindings.cpp:439
 msgid "Side"
 msgstr "Seitlich"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_bindings.cpp:430
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_bindings.cpp:440
 #: avidemux/ADM_videoFilter/ADM_vidMcDeint.cpp:109
 #: avidemux/ADM_videoFilter/ADM_vidDGbob.cpp:81
 #: avidemux/ADM_videoFilter/ADM_vidDecTelecide.cpp:90
@@ -3080,510 +3004,510 @@
 msgid "Top"
 msgstr "Oben"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_bindings.cpp:431
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_bindings.cpp:441
 msgid "Separate"
 msgstr "Trennen"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_bindings.cpp:607
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_bindings.cpp:615
 #: avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/Q_gui2.cpp:499
 #, c-format
 msgid "Frame:%c(%02d)"
 msgstr "Bild:%c(%02d)"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:283
-#: avidemux/main.cpp:163
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:289
+#: avidemux/main.cpp:203
 msgid "_File"
 msgstr "_Datei"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:290
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:296
 msgid "_Open..."
 msgstr "_?ffnen..."
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:301
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:307
 msgid "_Append..."
 msgstr "_Anh?ngen..."
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:312
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:318
 msgid "_Save"
 msgstr "_Speichern"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:323
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:329
 msgid "Save _Video..."
 msgstr " _Video speichern"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:335
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:341
 msgid "Save _BMP Image..."
 msgstr "_BMP Bild speichern"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:339
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:345
 msgid "Save _JPEG Image..."
 msgstr "_JPEG Bild speichern"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:343
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:349
 msgid "Save _Selection as JPEG Images..."
 msgstr "A_uswahl als JPEG Bilder speichern..."
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:356
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:362
 msgid "Save _Project"
 msgstr "_Projekt speichern"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:364
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:370
 msgid "Save P_roject As..."
 msgstr "P_rojekt speichern als..."
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:372
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:378
 msgid "_Load/Run Project..."
 msgstr "Projekt _laden/starten..."
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:380
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:386
 msgid "A_dd to Joblist..."
 msgstr "Zur Jobliste hinzuf?gen..."
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:384
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:390
 msgid "Show _Joblist"
 msgstr "_Jobliste anzeigen"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:396
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:402
 msgid "Co_nnect to avsproxy"
 msgstr "Verbi_nde mit avsproxy"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:405
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:411
 msgid "Proper_ties"
 msgstr "Eigenschaf_ten"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:416
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:422
 msgid "AVI _Muxer Options"
 msgstr "AVI _Multiplexer Optionen"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:425
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:431
 msgid "_Quit"
 msgstr "_Beenden"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:436
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:442
 msgid "_Edit"
 msgstr "_Bearbeiten"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:443
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:449
 msgid "_Reset Edits"
 msgstr "?nderungen _zur?cknehmen"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:456
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:462
 msgid "Cu_t"
 msgstr "_Ausschneiden"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:467
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:473
 msgid "_Copy"
 msgstr "_Kopieren"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:478
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:484
 msgid "_Paste"
 msgstr "_Einf?gen"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:489
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:495
 msgid "_Delete"
 msgstr "_L?schen"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:505
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:511
 msgid "Set Marker _A"
 msgstr "Setze Marke _A"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:512
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:518
 msgid "Set Marker _B"
 msgstr "Setze Marke _B"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:524
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:530
 msgid "Pre_ferences"
 msgstr "Ein_stellungen"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:532
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:538
 msgid "_View"
 msgstr "An_sicht"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:539
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:545
 msgid "_Main Toolbar"
 msgstr "_Haupt-Werkzeugleiste"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:544
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:550
 msgid "_A/V Sidebar"
 msgstr "_A/V Seitenleiste"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:554
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:560
 msgid "_Zoom 1:4"
 msgstr "_Zoom 1:4"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:561
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:567
 msgid "Z_oom 1:2"
 msgstr "Z_oom 1:2"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:568
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:574
 msgid "Zoom _1:1"
 msgstr "Zoom _1:1"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:575
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:581
 msgid "Zoom _2:1"
 msgstr "Zoom _2:1"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:582
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:588
 msgid "Zoom _4:1"
 msgstr "Zoom _4:1"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:589
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:595
 msgid "Vi_deo"
 msgstr "Vi_deo"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:596
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:602
 msgid "_Decoder Options"
 msgstr "_Dekodierer Optionen"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:603
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:609
 msgid "_Postprocessing"
 msgstr "Nachbearbeitung"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:606
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:612
 msgid "Select postprocessing level"
 msgstr "Nachbearbeitungsstufe ausw?hlen"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:616
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:622
 msgid "P_review"
 msgstr "Vo_rschau"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:623
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:629
 msgid "Display _Output"
 msgstr "A_usgabe anzeigen"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:635
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:641
 msgid "_Frame Rate"
 msgstr "Bildrate"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:639
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:688
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:645
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:694
 msgid "_Encoder"
 msgstr "Kodier_er"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:646
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:652
 msgid "Fil_ters"
 msgstr "Fil_ter"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:653
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:659
 msgid "_Audio"
 msgstr "_Audio"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:660
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:666
 msgid "_Main Track"
 msgstr "_Haupt-Audiospur"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:664
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:670
 msgid "_Second Track"
 msgstr "_Zweite Audiospur"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:668
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:674
 msgid "_Build VBR Time Map"
 msgstr "Erstelle VBR Zeitkarte"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:677
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:683
 msgid "S_ave..."
 msgstr "Speichern..."
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:695
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:701
 msgid "_Filters"
 msgstr "_Filter"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:699
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:705
 msgid "_Tools"
 msgstr "_Werkzeuge"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:706
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:712
 msgid "_Calculator"
 msgstr "_Taschenrechner"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:722
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:728
 msgid "_Rebuild Frames (I & B)"
 msgstr "Bilder neu aufbauen (I & B)"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:726
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:732
 msgid "C_heck Frames (slow)"
 msgstr "Bilder ?berpr?fen (langsam)"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:730
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:736
 msgid "_Bitrate Histogram"
 msgstr "_Bitrate Histogramm"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:734
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:740
 msgid "_Scan for Black Frames..."
 msgstr "_Schwarze Bilder suchen..."
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:743
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:749
 msgid "_VOB -> VobSub"
 msgstr "_VOB -> VobSub"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:747
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:753
 msgid "_OCR (VobSub -> srt)"
 msgstr "_OCR (VobSub -> srt)"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:756
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:757
+msgid "_Edit Glyph"
+msgstr "Schriftzeichen b_earbeiten"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:766
 msgid "_Frame Hex Dump"
 msgstr "Bild Hexadez. Abbild"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:760
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:770
 msgid "A_uto"
 msgstr "A_uto"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:767
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:777
 msgid "_VCD"
 msgstr "_VCD"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:771
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:781
 msgid "_SVCD"
 msgstr "_SVCD"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:775
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:785
 msgid "_DVD"
 msgstr "_DVD"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:779
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:789
 msgid "_PSP"
 msgstr "_PSP"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:783
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:793
 msgid "PSP (_H.264)"
 msgstr "PSP (_H.264)"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:787
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:797
 msgid "_Go"
-msgstr "_Gehe"
+msgstr "Sprin_gen"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:794
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:804
 msgid "_Play/Stop"
 msgstr "Abspielen/Anhalten"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:805
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:815
 msgid "P_revious Frame"
 msgstr "Vo_rheriges Bild"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:816
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:826
 msgid "_Next Frame"
 msgstr "_N?chstes Bild"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:827
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:837
 msgid "Pr_evious Intra Frame"
 msgstr "Vorheriges I-Bild (keyframe)"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:838
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:848
 msgid "Next _Intra Frame"
 msgstr "N?chstes I-Bild (keyframe)"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:849
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:859
 msgid "Previou_s Black Frame"
 msgstr "Vorherige_s schwarzes Bild"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:853
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:863
 msgid "Ne_xt Black Frame"
 msgstr "N?_chstes schwarzes Bild"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:857
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:867
 msgid "_First Frame"
 msgstr "_Erstes Bild"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:868
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:878
 msgid "_Last Frame"
 msgstr "_Letztes Bild"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:884
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:894
 msgid "Go to Marker _A"
 msgstr "Gehe zu Marke _A"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:891
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:901
 msgid "Go to Marker _B"
 msgstr "Gehe zu Marke _B"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:903
-msgid "_Jump to Frame..."
-msgstr "Springe zu Bild..."
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:913
+msgid "Go to Fra_me..."
+msgstr "Springe zu _Bild..."
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:914
-msgid "Jump to _Time..."
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:924
+msgid "Go to _Time..."
 msgstr "Springe zur _Zeit..."
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:925
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:935
 msgid "_Custom"
 msgstr "_Individuell"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:929
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:939
 msgid "_Help"
 msgstr "_Hilfe"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:936
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:946
 msgid "_Built-in Support"
 msgstr "Eingebaute Unterst?tzung"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:940
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:950
 msgid "_About"
-msgstr "_?ber"
+msgstr "Infos _?ber Avidemux"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:958
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:968
 msgid "Open a file"
 msgstr "?ffne eine Datei"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:968
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:978
 msgid "Save the file"
 msgstr "Datei speichern"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:974
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:984
 msgid "Audio/video file information"
 msgstr "Audio/Video Datei-Information"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:982
-msgid "Calculator"
-msgstr "Taschenrechner"
-
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:985
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:995
 msgid "Bitrate/size calculator"
 msgstr "Bitrate/Gr??e berechnen"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1039
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1079
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1074
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1114
 msgid "Copy"
 msgstr "Kopie"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1044
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1079
 msgid "Configure video encoder"
 msgstr "Video Kodierer konfigurieren"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1049
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1105
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1084
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1140
 msgid "Filters"
 msgstr "Filter"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1052
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1087
 msgid "Video filters"
 msgstr "Video Filter"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1084
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1119
 msgid "Configure audio encoder"
 msgstr "Audio Kodierer konfigurieren"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1092
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1127
 msgid "Audio filters"
 msgstr "Audio Filter"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1113
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1148
 msgid "Shift:"
 msgstr "Verschiebung"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1116
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1151
 msgid "Enable time shift"
 msgstr "Zeitverschiebung einschalten"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1122
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1157
 msgid "Audio/video time shift (ms)"
 msgstr "A/V Zeitverschiebung (ms)"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1129
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1164
 msgid "<b>Format</b>"
 msgstr "<b>Format</b>"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1162
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1197
 msgid "<b>Selection</b>"
 msgstr "<b>Auswahl</b>"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1179
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1187
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1214
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1222
 msgid " 0000000"
 msgstr " 0000000"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1195
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1230
 msgid "A:"
 msgstr "A:"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1202
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1237
 msgid "Go to marker A"
 msgstr "Gehe zu Marke A"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1204
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1239
 msgid "B:"
 msgstr "B:"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1211
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1246
 msgid "Go to marker B"
 msgstr "Gehe zu Marke B"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1223
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1258
 msgid "Play"
 msgstr "Abspielen"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1237
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1272
 msgid "Stop"
 msgstr "Stopp"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1249
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1284
 msgid "Previous frame"
 msgstr "Vorheriges Bild"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1264
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1299
 msgid "Next frame"
 msgstr "N?chstes Bild"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1279
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1314
 msgid "Previous keyframe"
 msgstr "Vorheriges I-Bild (keyframe)"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1294
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1329
 msgid "Next keyframe"
 msgstr "N?chstes I-Bild (keyframe)"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1308
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1343
 msgid "Selection: start"
 msgstr "Auswahl: Start"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1319
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1354
 msgid "Selection: end"
 msgstr "Auswahl: Ende"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1330
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1365
 msgid "Previous black frame"
 msgstr "Vorheriges schwarzes Bild"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1341
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1376
 msgid "Next black frame"
 msgstr "N?chstes schwarzes Bild"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1352
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1387
 msgid "First frame"
 msgstr "Erstes Bild"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1363
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1398
 msgid "Last frame"
 msgstr "Letztes Bild"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1394
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1420
 msgid "Frame: "
 msgstr "Bild:"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1401
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1427
 msgid "Current frame"
 msgstr "Aktuelles Bild"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1406
-msgid "/0000000"
-msgstr "/0000000"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1432
+msgid "/ 0000000"
+msgstr "/ 0000000"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1413
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1439
 msgid "Time: "
 msgstr " Zeit:"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1420
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1446
 msgid "Current time"
 msgstr "Aktuelle Zeit"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1421
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1447
 msgid "00:00:00.000"
 msgstr "00:00:00.000"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1424
-msgid "/00:00:00,000"
-msgstr "/00:00:00,000"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1450
+msgid "/ 00:00:00,000"
+msgstr "/ 00:00:00,000"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1431
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1457
 msgid "Frame: ?"
 msgstr "Bild: ? "
 
@@ -3591,19 +3515,13 @@
 msgid "_Encoding mode:"
 msgstr "Kodi_er-Modus:"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialogFactory/FAC_hex.cpp:98
-msgid "Previous"
-msgstr "Vorheriges"
-
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialogFactory/FAC_hex.cpp:106
-msgid "Next"
-msgstr "N?chstes"
-
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialogFactory/FAC_hex.cpp:132
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialogFactory/FAC_hex.cpp:100
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialogFactory/FAC_hex.cpp:134
 msgid "_Previous"
 msgstr "_Vorheriges"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialogFactory/FAC_hex.cpp:162
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialogFactory/FAC_hex.cpp:108
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialogFactory/FAC_hex.cpp:164
 msgid "_Next"
 msgstr "_N?chstes"
 
@@ -3641,11 +3559,11 @@
 
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_filters/gui_filtermanager_dialog.cpp:184
 msgid "Half D1 Res"
-msgstr "Half D1 Aufl."
+msgstr "Halbe D1 Aufl."
 
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_filters/gui_filtermanager_dialog.cpp:187
 msgid "Half D1 resolution [Ctrl-2]"
-msgstr "Half D1 Aufl?sung [Strg-2]"
+msgstr "Halbe D1 Aufl?sung [Strg-2]"
 
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_filters/gui_filtermanager_dialog.cpp:195
 msgid "SVCD Res"
@@ -3691,7 +3609,6 @@
 
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_filters/gui_filtermanager_dialog.cpp:381
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_filters/gui_filterlist.cpp:223
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_srt.cpp:112
 msgid "Subtitles"
 msgstr "Untertitel"
 
@@ -3767,7 +3684,7 @@
 
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_filters/gui_filtersub.cpp:130
 msgid "Half D1 res"
-msgstr "Half D1 Aufl."
+msgstr "Halbe D1 Aufl."
 
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_filters/gui_filtersub.cpp:156
 msgid "Save as script"
@@ -3807,16 +3724,14 @@
 msgstr "Transformation"
 
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_filters/gui_filterlist.cpp:173
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_tdeint.cpp:102
 msgid "Denoise"
 msgstr "Rauschen verringern"
 
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_filters/gui_filterlist.cpp:198
 msgid "Sharpen/Blur"
-msgstr "Sch?rfen / Weichzeichnen"
+msgstr "Sch?rfe/Unsch?rfe"
 
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_filters/gui_filterlist.cpp:248
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_builtin.cpp:192
 msgid "Miscellaneous"
 msgstr "Verschiedenes"
 
@@ -3826,26 +3741,26 @@
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_toolkit_gtk/toolkit_dialog.cpp:779
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_toolkit_gtk/toolkit_dialog.cpp:842
 msgid "label1"
-msgstr ""
+msgstr "label1"
 
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_toolkit_gtk/toolkit_dialog.cpp:706
 msgid "Alert"
 msgstr "Meldung"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_toolkit_gtk/ADM_gladeSupport.cpp:251
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_toolkit_gtk/ADM_gladeSupport.cpp:275
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_toolkit_gtk/ADM_gladeSupport.cpp:252
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_toolkit_gtk/ADM_gladeSupport.cpp:276
 #, c-format
 msgid "Couldn't find pixmap file: %s"
 msgstr "Konnte Pixmap Datei %s nicht finden."
 
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_toolkit_gtk/TLK_filesel.cpp:121
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_toolkit_gtk/TLK_filesel.cpp:211
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_toolkit_gtk/TLK_filesel.cpp:474
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_toolkit_gtk/TLK_filesel.cpp:475
 msgid "Cannot open directory as a file"
 msgstr "Kann das Verzeichnis nicht als Datei ?ffnen"
 
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_toolkit_gtk/TLK_filesel.cpp:335
-#: avidemux/gtk_gui.cpp:887
+#: avidemux/gtk_gui.cpp:892
 #, c-format
 msgid "Cannot open \"%s\"."
 msgstr "\"%s\" kann nicht ge?ffnet werden."
@@ -3868,55 +3783,74 @@
 msgid "No write access to \"%s\"."
 msgstr "Keine Schreibrechte f?r  \"%s\"."
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_toolkit_gtk/TLK_filesel.cpp:528
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_toolkit_gtk/TLK_filesel.cpp:529
 msgid "Images"
 msgstr "Bilder"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_toolkit_gtk/TLK_filesel.cpp:540
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_toolkit_gtk/TLK_filesel.cpp:541
 msgid "All"
 msgstr "Alles"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/adm_ocr.cpp:209
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_ocr/adm_ocr.cpp:209
-msgid "Incorrect output file"
-msgstr "Fehlerhafte Ausgabe-Datei"
-
-#: avidemux/ADM_userInterfaces/ADM_GTK/adm_ocr.cpp:215
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_ocr/adm_ocr.cpp:215
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_ocr/adm_ocr.cpp:180
 msgid "Output file error"
 msgstr "Ausgabe-Datei Fehler"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/adm_ocr.cpp:215
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_ocr/adm_ocr.cpp:215
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_ocr/adm_ocr.cpp:180
 #, c-format
 msgid "Could not open \"%s\" for writing."
 msgstr "Konnte \"%s\" nicht zum Schreiben ?ffnen."
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/adm_ocr.cpp:224
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_ocr/adm_ocr.cpp:224
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_ocr/adm_ocr.cpp:189
 msgid "Problem loading sub"
 msgstr "Problem beim Laden von Sub"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/adm_ocr.cpp:589
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_ocr/adm_ocr.cpp:589
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_ocr/adm_ocr.cpp:295
+msgid "Select Glyphfile to save to"
+msgstr "Schriftzeichen-Datei zum Speichern ausw?hlen"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_ocr/adm_ocr.cpp:362
 msgid "Sure ?"
 msgstr "Sicher ?"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/adm_ocr.cpp:752
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_ocr/adm_ocr.cpp:752
-msgid "Select SRT to save"
-msgstr "Zu speichernde SRT ausw?hlen"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_ocr/adm_editglyph.cpp:53
+msgid "Select GlyphFile to edit"
+msgstr "Als Schriftzeichen-Datei speichern"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/adm_ocr.cpp:764
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_ocr/adm_ocr.cpp:764
-msgid "Select Glyoh to save"
-msgstr "Zu speichernde Schriftzeichen ausw?hlen"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_ocr/adm_editglyph.cpp:121
+msgid "String"
+msgstr "Zeichenkette"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/adm_ocr.cpp:778
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_ocr/adm_ocr.cpp:778
-msgid "No glyphs to save"
-msgstr "Keine Schriftzeichen zum Speichern vorhanden"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_ocr/adm_editglyph.cpp:123
+msgid "Search string"
+msgstr "Zeichenkette suchen"
 
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_ocr/adm_editglyph.cpp:149
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_ocr/adm_editglyph.cpp:192
+msgid "End reached"
+msgstr "Ende erreicht"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_ocr/adm_editglyph.cpp:149
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_ocr/adm_editglyph.cpp:192
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_ocr/adm_editglyph.cpp:216
+msgid "No more glyphs"
+msgstr "Keine weiteren Schriftzeichen"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_ocr/adm_editglyph.cpp:216
+msgid "Head reached"
+msgstr "Kopf erreicht"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_ocr/adm_editglyph.cpp:344
+msgid "dialog1"
+msgstr "dialog1"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_ocr/adm_editglyph.cpp:396
+msgid "Prev. Empty"
+msgstr "Vorheriges Leeres"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_ocr/adm_editglyph.cpp:418
+msgid "Next Empty"
+msgstr "N?chstes Leeres"
+
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_DVDff.cpp:55
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_SVCD.cpp:45
 msgid "Default"
@@ -3991,16 +3925,16 @@
 msgstr "_Interlacing:"
 
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_resizeWiz.cpp:59
-msgid "Target type"
-msgstr "Zieltyp"
+msgid "_Target type:"
+msgstr "_Zieltyp:"
 
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_resizeWiz.cpp:60
-msgid "Source aspect ratio"
-msgstr "Quell-Seitenverh?ltnis"
+msgid "_Source aspect ratio:"
+msgstr "_Quell-Seitenverh?ltnis:"
 
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_resizeWiz.cpp:61
-msgid "Dest. aspect ratio"
-msgstr "Ziel-Seitenverh?ltnis"
+msgid "_Destination aspect ratio:"
+msgstr "_Ziel-Seitenverh?ltnis:"
 
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_bitrateHisto.cpp:59
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_bitrateHisto.cpp:128
@@ -4012,8 +3946,8 @@
 msgstr "Bitrate Histogramm"
 
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_builtin.cpp:128
-msgid "Video codecs:"
-msgstr "Video Kodierer:"
+msgid "Video Codecs"
+msgstr "Video Kodierer"
 
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_builtin.cpp:129
 msgid "Xvid"
@@ -4024,8 +3958,8 @@
 msgstr "x264"
 
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_builtin.cpp:135
-msgid "Audio codecs:"
-msgstr "Audio Kodierer:"
+msgid "Audio Codecs"
+msgstr "Audio Kodierer"
 
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_builtin.cpp:136
 msgid "Aften"
@@ -4033,7 +3967,7 @@
 
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_builtin.cpp:137
 msgid "amrnb"
-msgstr ""
+msgstr "amrnb"
 
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_builtin.cpp:138
 msgid "FAAC"
@@ -4060,76 +3994,76 @@
 msgstr "MAD"
 
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_builtin.cpp:144
-msgid "Ogg Vorbis"
-msgstr "Ogg Vorbis"
+msgid "Vorbis"
+msgstr "Vorbis"
 
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_builtin.cpp:156
-msgid "Miscellaneous libraries:"
-msgstr "Verschiedene Bibliotheken:"
-
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_builtin.cpp:157
 msgid "aRts"
 msgstr "aRts"
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_builtin.cpp:158
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_builtin.cpp:157
 msgid "ESD"
 msgstr "ESD"
 
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_builtin.cpp:158
+msgid "Fontconfig"
+msgstr "Schriftkonfiguration"
+
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_builtin.cpp:159
-msgid "FontConfig"
-msgstr "Schrift Konfiguration"
-
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_builtin.cpp:160
 msgid "FreeType 2"
 msgstr "FreeType 2"
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_builtin.cpp:161
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_builtin.cpp:160
 msgid "gettext"
 msgstr "gettext"
 
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_builtin.cpp:161
+msgid "ALSA"
+msgstr "ALSA"
+
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_builtin.cpp:162
-msgid "Alsa"
-msgstr "Alsa"
-
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_builtin.cpp:163
 msgid "OSS"
 msgstr "OSS"
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_builtin.cpp:164
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_builtin.cpp:163
 msgid "SDL"
 msgstr "SDL"
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_builtin.cpp:165
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_builtin.cpp:164
 msgid "XVideo"
 msgstr "XVideo"
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_builtin.cpp:177
-msgid "CPU:"
-msgstr "CPU:"
-
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_builtin.cpp:178
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_builtin.cpp:166
 msgid "AltiVec"
 msgstr "AltiVec"
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_builtin.cpp:179
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_builtin.cpp:167
 msgid "PowerPC"
 msgstr "PowerPC"
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_builtin.cpp:180
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_builtin.cpp:168
 msgid "x86"
 msgstr "x86"
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_builtin.cpp:181
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_builtin.cpp:169
 msgid "x86-64"
 msgstr "x86-64"
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_builtin.cpp:191
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_builtin.cpp:176
 msgid "Codecs"
 msgstr "Kodierer"
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_builtin.cpp:196
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_builtin.cpp:177
+msgid "Libraries"
+msgstr "Bibliotheken"
+
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_builtin.cpp:178
+msgid "CPU"
+msgstr "CPU"
+
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_builtin.cpp:182
 msgid "Built-in Support"
-msgstr "Eingebaute Unterst?tzung"
+msgstr "Eingebauter Support"
 
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_postproc.cpp:40
 #: avidemux/ADM_videoFilter/ADM_vidForcedPP.cpp:60
@@ -4137,17 +4071,18 @@
 msgstr "_Filtersch?rfe:"
 
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_postproc.cpp:41
-msgid "_Swap U & V"
-msgstr "U mit V _tauschen"
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_lavDecoder.cpp:45
+msgid "_Swap U and V"
+msgstr "U mit V tau_schen"
 
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_postproc.cpp:51
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:269
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:285
 #: avidemux/ADM_videoFilter/ADM_vidForcedPP.cpp:72
 msgid "_Horizontal deblocking"
 msgstr "_Horizontal entblockieren"
 
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_postproc.cpp:52
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:270
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:286
 #: avidemux/ADM_videoFilter/ADM_vidForcedPP.cpp:73
 msgid "_Vertical deblocking"
 msgstr "_Vertikal entblockieren"
@@ -4157,188 +4092,208 @@
 msgid "_Deringing"
 msgstr "_De-Ringing"
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:162
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:170
 msgid "_Use systray while encoding"
 msgstr "Systemablage w?hrend des Kodierens ben_utzen"
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:163
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:171
 msgid "_Accept non-standard audio frequency for DVD"
 msgstr "Erlaube _Nicht-Standard Audio-Frequenz f?r DVD"
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:164
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:172
 msgid "_Use libavcodec MPEG-2 decoder"
 msgstr ""
 "MPEG Dekodierer libavcodec ben_utzen \n"
 "(ggf. Probleme bei Videos im Halbbildmodus!)"
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:165
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:173
 msgid "Create _OpenDML files"
 msgstr "_OpenDML-Dateien erstellen"
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:166
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:174
 msgid "Automatically _index MPEG files"
 msgstr "MPEG-Dateien automatisch _indizieren"
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:167
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:175
 msgid "Automatically _swap A and B if A>B"
 msgstr "Automatisch A mit B tauschen, wenn A > B"
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:168
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:176
 msgid "_Disable NUV audio sync"
 msgstr "NUV Audio-Sync _deaktivieren"
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:169
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:177
 msgid "_Load external filters"
 msgstr "Externe Filter _laden"
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:171
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:179
 msgid "Automatically _build VBR map"
 msgstr "VBR-Zeitkarte automatisch _erstellen"
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:172
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:180
 msgid "Automatically _rebuild index"
 msgstr "Index automatisch wieder erstellen"
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:173
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:181
 msgid "Automatically remove _packed bitstream"
 msgstr "Ge_packten Bitstream automatisch entfernen"
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:175
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:183
 msgid "_Number of threads:"
-msgstr "A_nzahl von Threads:"
+msgstr "A_nzahl der Threads:"
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:179
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:187
 msgid "Above normal"
 msgstr "?ber normal"
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:181
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:189
 msgid "Below normal"
 msgstr "Unter normal"
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:184
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:192
 msgid "_Encoding priority:"
 msgstr "Kodi_erungspriorit?t:"
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:185
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:193
 msgid "_Indexing/unpacking priority:"
 msgstr "_Indizieren/Entpacken Priorit?t:"
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:186
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:194
 msgid "_Playback priority:"
 msgstr "_Wiedergabe Priorit?t:"
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:188
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:196
 msgid "_Split MPEG files every (MB):"
 msgstr "Mpeg_s aufteilen alle (MB):"
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:190
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:198
 msgid "_Use alternative tag for MP3 in .mp4"
 msgstr "Alternatives 'Tag' f?r MP3 in .mp4 ben_utzen"
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:193
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:201
 msgid "GTK+ (slow)"
 msgstr "Gtk+ (langsam)"
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:195
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:203
 msgid "XVideo (best)"
 msgstr "XVideo (bestens)"
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:198
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:207
+msgid "SDL (GDI)"
+msgstr "SDL (GDI)"
+
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:208
+msgid "SDL (DirectX)"
+msgstr "SDL (DirectX)"
+
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:210
 msgid "SDL (good)"
 msgstr "SDL (gut)"
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:201
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:214
 msgid "Video _display:"
 msgstr "Video-Anzeige:"
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:206
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:219
 msgid "No alerts"
 msgstr "Keine Meldungen anzeigen"
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:207
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:220
 msgid "Display only error alerts"
 msgstr "Nur Fehlermeldungen anzeigen"
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:208
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:221
 msgid "Display all alerts"
 msgstr "Alle Meldungen anzeigen"
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:210
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:223
 msgid "_Message level:"
 msgstr "Anzeigestufe f?r Meldungen:"
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:215
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:228
 msgid "PCM"
 msgstr "PCM"
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:216
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:229
 msgid "Master"
 msgstr "Master"
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:217
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:230
 msgid "_Volume control:"
 msgstr "Lautst?rkeregler:"
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:222
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:235
 msgid "No downmixing"
 msgstr "Nicht herunter mischen"
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:224
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:237
 msgid "Pro Logic"
 msgstr "Dolby ProLogic"
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:225
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:238
 msgid "Pro Logic II"
 msgstr "Dolby ProLogic II"
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:227
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:240
 msgid "_Local playback downmixing:"
 msgstr "_Lokale Wiedergabe herunter mischen:"
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:256
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:272
 msgid "_Audio output:"
 msgstr "_Audio-Ausgabe:"
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:258
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:274
 msgid "ALSA _device:"
 msgstr "ALSA _Ger?t:"
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:271
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:287
 msgid "De_ringing"
 msgstr "De-_Ringing"
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:272
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:288
 #: avidemux/ADM_videoFilter/ADM_vidMSharpen.cpp:167
 msgid "_Strength:"
 msgstr "_St?rke:"
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:273
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:289
 msgid "Default Postprocessing"
 msgstr "Voreingestellte Nachbearbeitung"
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:287
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:303
 msgid "_Filter directory:"
 msgstr "_Filter-Verzeichnis:"
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:321
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:308
+msgid "Use _Global GlyphSet:"
+msgstr "_Globalen Schriftzeichensatz verwenden:"
+
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:309
+msgid "Gl_yphSet:"
+msgstr "Schrift_zeichensatz:"
+
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:343
+msgid "Global Glyphset"
+msgstr "Globaler Schriftzeichensatz"
+
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:348
 msgid "External Filters"
 msgstr "Externe Filter"
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:325
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:352
 msgid "Preferences"
 msgstr "Einstellungen"
 
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_gototime.cpp:27
-msgid "Hour"
-msgstr "Stunden"
+msgid "_Hours:"
+msgstr "Stun_den:"
 
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_gototime.cpp:28
-msgid "Minutes"
-msgstr "Minuten"
+msgid "_Minutes:"
+msgstr "_Minuten:"
 
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_gototime.cpp:29
-msgid "Seconds"
-msgstr "Sekunden"
+msgid "_Seconds:"
+msgstr "_Sekunden:"
 
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_lavcodec.cpp:52
 msgid "Full"
@@ -4414,7 +4369,7 @@
 
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_lavcodec.cpp:90
 msgid "_Filesize tolerance (kb):"
-msgstr "_Dateigr??e Toleranz (KB):"
+msgstr "_Dateigr??e Toleranz (kb):"
 
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_lavcodec.cpp:92
 msgid "_Quantizer compression:"
@@ -4451,20 +4406,20 @@
 msgstr "_Dynamischer Kompressionsbereich"
 
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_audioFilter.cpp:64
-msgid "_Time Shift (ms) "
-msgstr "Ve_rschiebung (ms) "
+msgid "_Time shift (ms):"
+msgstr "Ve_rschiebung (ms):"
 
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_audioFilter.cpp:64
-msgid "Time shift _value (ms):"
-msgstr "Zeitverschiebungs_wert (ms):"
+msgid "Time shift value (ms)"
+msgstr "Zeitverschiebungswert (ms)"
 
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_audioFilter.cpp:72
-msgid "R_esampling (Hz) "
-msgstr "R_esampling Frequenz (Hz)"
+msgid "R_esampling (Hz):"
+msgstr "R_esampling (Hz):"
 
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_audioFilter.cpp:72
-msgid "_Resampling frequency (Hz):"
-msgstr "_Resampling Frequenz (Hz):"
+msgid "Resampling frequency (Hz)"
+msgstr "Resampling Frequenz (Hz)"
 
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_audioFilter.cpp:81
 msgid "Film to PAL"
@@ -4538,17 +4493,13 @@
 msgid "Audio Filters"
 msgstr "Audio Filter"
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_lavDecoder.cpp:45
-msgid "Swap U & V:"
-msgstr "U mit V tauschen:"
-
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_lavDecoder.cpp:46
-msgid "Show _Vectors:"
-msgstr "Vektoren anzeigen"
+msgid "Show motion _vectors"
+msgstr "Bewegungs_vektoren anzeigen"
 
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_lavDecoder.cpp:48
-msgid "Lavcodec Decoder Configuration"
-msgstr "Libavcodec Dekodierer Konfiguration"
+msgid "Decoder Options"
+msgstr "Dekodierer Optionen"
 
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_tdeint.cpp:45
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_tdeint.cpp:51
@@ -4557,23 +4508,24 @@
 
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_tdeint.cpp:46
 #: avidemux/ADM_videoFilter/ADM_vidYadif.cpp:178
-msgid "Top Field First"
+msgid "Top field first"
 msgstr "Oberes Feld zuerst"
 
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_tdeint.cpp:47
-msgid "Bottom Field First"
+#: avidemux/ADM_videoFilter/ADM_vidYadif.cpp:177
+msgid "Bottom field first"
 msgstr "Unteres Feld zuerst"
 
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_tdeint.cpp:52
-msgid "Bottom Field (keep top)"
+msgid "Bottom field (keep top)"
 msgstr "Unteres Feld (oben halten)"
 
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_tdeint.cpp:53
-msgid "Top Field (keep Bottom)"
+msgid "Top field (keep bottom)"
 msgstr "Oberes Feld (unten halten)"
 
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_tdeint.cpp:58
-msgid "Cubic Interpolation"
+msgid "Cubic interpolation"
 msgstr "Kubische Interpolation"
 
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_tdeint.cpp:59
@@ -4581,7 +4533,7 @@
 msgstr "Ge?nderte ELA"
 
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_tdeint.cpp:60
-msgid "Kernel Interpolation"
+msgid "Kernel interpolation"
 msgstr "Kernel Interpolation"
 
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_tdeint.cpp:61
@@ -4589,27 +4541,27 @@
 msgstr "Ge?nderte ELA-2"
 
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_tdeint.cpp:66
-msgid "4 Fields Check"
-msgstr "4 Feldpr?fung"
+msgid "4 fields check"
+msgstr "4-Felder Pr?fung"
 
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_tdeint.cpp:67
-msgid "5 Fields Check"
-msgstr "5 Feldpr?fung"
+msgid "5 fields check"
+msgstr "5-Felder Pr?fung"
 
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_tdeint.cpp:68
-msgid "4 Fields Check (no avg)"
-msgstr "4 Feldpr?fung (kein Durchschnitt)"
+msgid "4 fields check (no avg)"
+msgstr "4-Felder Pr?fung (kein Durchschnitt)"
 
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_tdeint.cpp:69
-msgid "5 Fields Check (no avg)"
-msgstr "5 Feldpr?fung (kein Durchschnitt)"
+msgid "5 fields check (no avg)"
+msgstr "5-Felder Pr?fung (kein Durchschnitt)"
 
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_tdeint.cpp:75
-msgid "No Link"
+msgid "No link"
 msgstr "Keine Verkn?pfung"
 
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_tdeint.cpp:76
-msgid "Full Link"
+msgid "Full link"
 msgstr "Vollst?ndige Verkn?pfung"
 
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_tdeint.cpp:77
@@ -4626,6 +4578,7 @@
 
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_tdeint.cpp:91
 #: avidemux/ADM_videoFilter/ADM_vidDGbob.cpp:90
+#: avidemux/ADM_videoFilter/ADM_vidDecTelecide.cpp:111
 #: avidemux/ADM_videoFilter/ADM_vidKernelDeint.cpp:92
 msgid "_Field order:"
 msgstr "_Feldreihenfolge:"
@@ -4651,87 +4604,77 @@
 msgstr "_AP Typ:"
 
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_tdeint.cpp:100
-msgid "Use Chroma to evalute"
+msgid "Use ch_roma to evalute"
 msgstr "Farbintensit?t zur ?berpr?fung benutzen"
 
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_tdeint.cpp:101
-msgid "Try weave"
+msgid "Try _weave"
 msgstr "Versuche 'Weave'"
 
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_tdeint.cpp:102
+msgid "_Denoise"
+msgstr "Rauschen _verringern"
+
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_tdeint.cpp:103
-msgid "Sharp"
-msgstr "Sch?rfe erh?hen"
+#: avidemux/ADM_videoFilter/ADM_vidKernelDeint.cpp:94
+msgid "_Sharp"
+msgstr "_Sch?rfen"
 
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_tdeint.cpp:104
-msgid "Evalute all frames"
-msgstr "Alle Bilder ?berpr?fen"
+msgid "_Evalute all frames"
+msgstr "Alle Bilder ?b_erpr?fen"
 
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_tdeint.cpp:107
-msgid "Motion threshold, Luma:"
-msgstr "Bewegungsschwelle, Brillianz:"
+msgid "Motion threshold, l_uma:"
+msgstr "Beweg_ungsschwelle, Brillianz:"
 
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_tdeint.cpp:108
-msgid "Motion threshold, Chroma:"
-msgstr "Bewegungsschwelle, Farbintensit?t:"
+msgid "Motion threshold, c_hroma:"
+msgstr "Bewegungssc_hwelle, Farbintensit?t:"
 
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_tdeint.cpp:109
-msgid "Area combing threshold:"
+msgid "Area com_bing threshold:"
 msgstr "Bereich f?r kammartige Schwelle:"
 
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_tdeint.cpp:110
-msgid "Combed threshold:"
+msgid "Combe_d threshold:"
 msgstr "Kammartige Schwelle:"
 
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_tdeint.cpp:111
-msgid "Artefact prot. threshold:"
-msgstr "Artefakte-gesch?tzte Schwelle:"
+msgid "Artefact _protection threshold:"
+msgstr "Artefakte-_gesch?tzte Schwelle:"
 
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_tdeint.cpp:120
-msgid "TDEint Configuration"
-msgstr "TDEint Konfiguration"
+msgid "TDeint"
+msgstr "TDeint"
 
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_v2v.cpp:41
-msgid "Vob file(s):"
-msgstr "Vob Datei(en):"
+msgid "_VOB file(s):"
+msgstr "_Vob Datei(en):"
 
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_v2v.cpp:42
-msgid "IFO file:"
-msgstr "IFO Datei:"
+msgid "_IFO file:"
+msgstr "_IFO Datei:"
 
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_v2v.cpp:43
-msgid "Vobsub file:"
-msgstr "Vobsub Datei:"
+msgid "Vob_Sub file:"
+msgstr "Vob_Sub Datei:"
 
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_v2v.cpp:48
-msgid "Vob 2 Vobsub"
-msgstr "Vob nach Vobsub"
+msgid "VOB to VobSub"
+msgstr "VOB -> VobSub"
 
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_v2v.cpp:52
-msgid "VOB file"
-msgstr "VOB Datei"
-
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_v2v.cpp:52
-msgid "The selected vobfile does not exist."
-msgstr "Die ausgew?hlte VOB Datei existiert nicht."
-
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_v2v.cpp:57
-msgid "IFO file"
-msgstr "IFO Datei"
+msgid "The selected vobfile does not exist"
+msgstr "Die ausgew?hlte VOB Datei existiert nicht"
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_v2v.cpp:57
-msgid "The selected IFO file does not exist."
-msgstr "Die ausgew?hlte IFO Datei existiert nicht."
-
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_v2v.cpp:62
-msgid "VobSub file"
-msgstr "VobSub Datei"
+msgid "Please select a correct VobSub path/dir"
+msgstr "Bitte korrektes VobSub Verzeichnis ausw?hlen"
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_v2v.cpp:62
-msgid "Select a correct vobsub path/dir."
-msgstr "Korrektes VobSub Verzeichnis ausw?hlen"
-
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_srt.cpp:88
-msgid "_Subtitle File:"
+msgid "_Subtitle file:"
 msgstr "Unter_titel Datei:"
 
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_srt.cpp:89
@@ -4739,25 +4682,90 @@
 msgstr "Schri_ft (TrueType):"
 
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_srt.cpp:104
-msgid "Encoding:"
-msgstr "Zeichenkodierung:"
+msgid "_Encoding:"
+msgstr "Kodierung:"
 
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_srt.cpp:106
-msgid "Color"
-msgstr "Farbe"
+msgid "S_elect C_olor"
+msgstr "Farb_e ausw?hlen"
 
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_srt.cpp:107
-msgid "_Size and Position"
-msgstr "Gr??e und Po_sition"
+msgid "Set Size and _Position"
+msgstr "Gr??e und _Position setzen"
 
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_srt.cpp:108
-msgid "_Auto Split:"
-msgstr "_Automatisch teilen:"
+msgid "_Auto split"
+msgstr "_Automatisch teilen"
 
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_srt.cpp:109
 msgid "_Delay (ms):"
 msgstr "Ver_z?gerung (ms):"
 
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_srt.cpp:112
+msgid "Subtitler"
+msgstr "Untertitel Generator"
+
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_animated.cpp:36
+msgid "_Background Image:"
+msgstr "Hintergrund_bild:"
+
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_animated.cpp:37
+msgid "_NTSC(default is Pal):"
+msgstr "_NTSC (voreingestellt ist PAL):"
+
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_animated.cpp:38
+msgid "Vignette _Width:"
+msgstr "Vignette _Breite:"
+
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_animated.cpp:39
+msgid "Vignette _Height:"
+msgstr "Vignette _H?he:"
+
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_animated.cpp:42
+msgid "Vignette frame number"
+msgstr "Vignette Bildnummer"
+
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_animated.cpp:46
+msgid "Timecode:"
+msgstr "Zeitcode:"
+
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:82
+msgid "Select idx file:"
+msgstr "IDX-Datei ausw?hlen:"
+
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:83
+msgid "Use glyphset (optional):"
+msgstr "Schriftzeichensatz verwenden (optional):"
+
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:84
+msgid "Output SRT file"
+msgstr "Ausgabe SRT-Datei"
+
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:95
+msgid "Select input and ouput files"
+msgstr "Eingabe-und Ausgabedateien ausw?hlen"
+
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:105
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:117
+msgid "The idx/sub file does not exist."
+msgstr "Die IDX-/SUB-Datei existiert nicht."
+
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:110
+msgid "Please Select a valid output SRT file."
+msgstr "Bitte eine g?ltige SRT-Ausgabedatei ausw?hlen"
+
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:126
+msgid "Cannot load the glyphset file."
+msgstr "Schriftzeichen-Datei kann nicht geladen werden."
+
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:144
+msgid "Glyphset filename"
+msgstr "Dateiname f?r Schriftzeichensatz"
+
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:146
+msgid "Save Glyph"
+msgstr "Schriftzeichen speichern"
+
 #: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_xvid4.cpp:58
 msgid "Very Low"
 msgstr "Sehr niedrig"
@@ -4962,6 +4970,38 @@
 msgid "X264 Configuration"
 msgstr "X264 Konfiguration"
 
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_jobs.cpp:106
+msgid "Job Name"
+msgstr "Job Name"
+
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_jobs.cpp:106
+msgid "Status"
+msgstr "Status"
+
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_jobs.cpp:106
+msgid "Start Time"
+msgstr "Startzeit"
+
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_jobs.cpp:106
+msgid "End Time"
+msgstr "Endezeit"
+
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_jobs.cpp:196
+msgid "Delete *all* job"
+msgstr "*Alle* Jobs l?schen"
+
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_jobs.cpp:196
+msgid "Are you sure you want to delete ALL jobs ?"
+msgstr "Sollen wirklich alle Jobs gel?scht werden ?"
+
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_jobs.cpp:222
+msgid "Already done"
+msgstr "Schon erledigt"
+
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_jobs.cpp:222
+msgid "This script has already been successfully executed."
+msgstr "Dieses Skript wurde bereits erfolgreich ausgef?hrt."
+
 #: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialogFactory/T_filesel.cpp:62
 msgid "Select File to Read"
 msgstr "Einzulesende Datei ausw?hlen"
@@ -5169,20 +5209,20 @@
 msgid "Node not found"
 msgstr "Knoten nicht gefunden"
 
-#: avidemux/ADM_editor/ADM_edit.cpp:402
+#: avidemux/ADM_editor/ADM_edit.cpp:407
 msgid "File type identified but no loader support detected..."
 msgstr "Dateityp wurde ermittelt, aber keine Ladeunterst?tzung festgestellt."
 
-#: avidemux/ADM_editor/ADM_edit.cpp:403
+#: avidemux/ADM_editor/ADM_edit.cpp:408
 msgid "May be related to an old index file."
 msgstr "Es bezieht sich vielleicht auf eine alte Index-Datei."
 
-#: avidemux/ADM_editor/ADM_edit.cpp:410
+#: avidemux/ADM_editor/ADM_edit.cpp:415
 #, c-format
 msgid "Attempt to open %s failed!"
 msgstr "Versuch %s zu ?ffnen ist misslungen!"
 
-#: avidemux/ADM_editor/ADM_edit.cpp:434
+#: avidemux/ADM_editor/ADM_edit.cpp:439
 msgid ""
 "You cannot mix different video dimensions yet. Using the partial video filter later, will not work around this problem. The workaround is:\n"
 "1.) \"resize\" / \"add border\" / \"crop\" each stream to the same resolution\n"
@@ -5192,70 +5232,74 @@
 "1.) \"resize\" / \"add border\" / \"crop\" mit jedem Videostream bei gleicher Aufl?sung\n"
 "2.) Zusammenh?ngen aller erstellen Videostreams"
 
-#: avidemux/ADM_editor/ADM_edit.cpp:546
+#: avidemux/ADM_editor/ADM_edit.cpp:551
 msgid "Build Time Map"
 msgstr "Erstelle VBR Zeitkarte"
 
-#: avidemux/ADM_editor/ADM_edit.cpp:546
+#: avidemux/ADM_editor/ADM_edit.cpp:551
 msgid "Build VBR time map?"
 msgstr "VBR Zeitkarte erstellen?"
 
-#: avidemux/ADM_editor/ADM_edit.cpp:580
+#: avidemux/ADM_editor/ADM_edit.cpp:585
 msgid "Use that mode"
 msgstr "Benutze diesen Modus"
 
-#: avidemux/ADM_editor/ADM_edit.cpp:580
+#: avidemux/ADM_editor/ADM_edit.cpp:585
 msgid "H264 detected"
 msgstr "H264 gefunden"
 
-#: avidemux/ADM_editor/ADM_edit.cpp:580
+#: avidemux/ADM_editor/ADM_edit.cpp:585
 msgid ""
 "If the file is using bframe as reference, it can lead to crash or stutteting.\n"
 "Avidemux can use another mode which is safed but <b>YOU WILL LOOSE FRAME ACCURACY</b>.\n"
 "Do you want to use that mode ?"
 msgstr ""
+"Wenn die Datei B-Bilder als Referenz verwendet, kann das zum Absturz oder Stottern \n"
+"f?hren. Avidemux kann einen anderen Modus verwenden, der sicher ist, aber \n"
+"<b>DAMIT GEHT DIE BILD-GENAUIGKEIT VERLOREN</b>.\n"
+"Soll dieser Modus verwendet werden ?"
 
-#: avidemux/ADM_editor/ADM_edit.cpp:707
+#: avidemux/ADM_editor/ADM_edit.cpp:712
 msgid "Packed Bitstream detected"
 msgstr "Gepackten Bitstrom gefunden"
 
-#: avidemux/ADM_editor/ADM_edit.cpp:708
+#: avidemux/ADM_editor/ADM_edit.cpp:713
 msgid "Do you want me to unpack it ?"
 msgstr "Soll es entpackt werden ?"
 
-#: avidemux/ADM_editor/ADM_edit.cpp:728
+#: avidemux/ADM_editor/ADM_edit.cpp:733
 msgid "Could not unpack the video"
 msgstr "Video konnte nicht entpackt werden"
 
-#: avidemux/ADM_editor/ADM_edit.cpp:728
+#: avidemux/ADM_editor/ADM_edit.cpp:733
 msgid "Using backup decoder - not frame accurate."
 msgstr "Backup Dekodierer verwenden - nicht bildgenau."
 
-#: avidemux/ADM_editor/ADM_edit.cpp:733
+#: avidemux/ADM_editor/ADM_edit.cpp:738
 msgid "Weird"
 msgstr "Seltsam"
 
-#: avidemux/ADM_editor/ADM_edit.cpp:733
+#: avidemux/ADM_editor/ADM_edit.cpp:738
 msgid "The unpacking succeedeed but the index is still not up to date."
 msgstr "Das Entpacken war erfolgreich, aber der Index ist nicht aktuell."
 
-#: avidemux/ADM_editor/ADM_edit.cpp:739
+#: avidemux/ADM_editor/ADM_edit.cpp:744
 msgid "Troubles ahead"
 msgstr "Probleme weiter oben"
 
-#: avidemux/ADM_editor/ADM_edit.cpp:739
+#: avidemux/ADM_editor/ADM_edit.cpp:744
 msgid "This a VOP packed AVI."
 msgstr "Dies ist ein VOP-gepacktes AVI."
 
-#: avidemux/ADM_editor/ADM_edit.cpp:750
+#: avidemux/ADM_editor/ADM_edit.cpp:755
 msgid "Index is not up to date"
 msgstr "Index ist nicht aktuell"
 
-#: avidemux/ADM_editor/ADM_edit.cpp:750
+#: avidemux/ADM_editor/ADM_edit.cpp:755
 msgid "You should use Tool->Rebuild frame. Do it now ?"
 msgstr "Werkzeuge -> Bilder neu erstellen sollte verwendet werden. Starten ?"
 
-#: avidemux/ADM_editor/ADM_edit.cpp:1505
+#: avidemux/ADM_editor/ADM_edit.cpp:1510
 msgid ""
 "This looks like mpeg\n"
 " Do you want to index it?"
@@ -5263,7 +5307,7 @@
 "Dies schaut wie Mpeg aus\n"
 "Soll ein Index erstellt werden ?"
 
-#: avidemux/ADM_editor/ADM_edit.cpp:1557
+#: avidemux/ADM_editor/ADM_edit.cpp:1562
 msgid "Indexing failed"
 msgstr "Indizierung gescheitert"
 
@@ -5308,8 +5352,8 @@
 msgstr "AVI, gepacktes VOP"
 
 #: avidemux/ADM_editor/ADM_outputfmt.h:41
-msgid "AVI, unp. VOP"
-msgstr "AVI, ungepack. VOP"
+msgid "AVI, unpack VOP"
+msgstr "AVI, ungepacktes VOP"
 
 #: avidemux/ADM_editor/ADM_outputfmt.h:42
 msgid "MPEG-PS (A+V)"
@@ -5320,7 +5364,7 @@
 msgstr "MPEG-TS (A+V)"
 
 #: avidemux/ADM_editor/ADM_outputfmt.h:44
-msgid "MPEG Video"
+msgid "MPEG video"
 msgstr "MPEG Video"
 
 #: avidemux/ADM_editor/ADM_outputfmt.h:45
@@ -5335,11 +5379,11 @@
 msgid "Internal error finding codec"
 msgstr "Interner Fehler beim Finden eines Codec"
 
-#: avidemux/ADM_codecs/ADM_ffmpeg.cpp:51
+#: avidemux/ADM_codecs/ADM_ffmpeg.cpp:53
 msgid "Internal error opening codec"
 msgstr "Interner Fehler beim ?ffnen eines Codec"
 
-#: avidemux/ADM_codecs/ADM_ffmpeg.cpp:53
+#: avidemux/ADM_codecs/ADM_ffmpeg.cpp:55
 msgid "Internal error with context for  codec"
 msgstr "Interner Fehler mit Kontext f?r Codec"
 
@@ -5365,17 +5409,14 @@
 msgstr "Wechseln"
 
 #: avidemux/ADM_script/ADM_JSFunctions.cpp:556
-#: avidemux/ADM_videoFilter/ADM_vidDecTelecide.cpp:83
 msgid "No Strategy"
 msgstr "Keine Strategie"
 
 #: avidemux/ADM_script/ADM_JSFunctions.cpp:557
-#: avidemux/ADM_videoFilter/ADM_vidDecTelecide.cpp:84
 msgid "3:2 Pulldown"
 msgstr "3:2 Abriss"
 
 #: avidemux/ADM_script/ADM_JSFunctions.cpp:558
-#: avidemux/ADM_videoFilter/ADM_vidDecTelecide.cpp:85
 msgid "Pal/Secam"
 msgstr "Pal/Secam"
 
@@ -5400,7 +5441,7 @@
 msgid "Could not open subtitle file"
 msgstr "Untertitel-Datei kann nicht ge?ffnet werden"
 
-#: avidemux/ADM_video/ADM_vidSRT.cpp:238
+#: avidemux/ADM_video/ADM_vidSRT.cpp:235
 msgid "Cannot identify subtitle format"
 msgstr "Kann Untertitel-Datei nicht identifizieren"
 
@@ -5414,6 +5455,7 @@
 
 #: avidemux/ADM_videoFilter/ADM_vidMSharpen.cpp:166
 #: avidemux/ADM_videoFilter/ADM_vidDGbob.cpp:92
+#: avidemux/ADM_videoFilter/ADM_vidBlendRemoval.cpp:82
 #: avidemux/ADM_videoFilter/ADM_vidHardIvtcRemoval.cpp:87
 #: avidemux/ADM_videoFilter/ADM_vidKernelDeint.cpp:93
 msgid "_Threshold:"
@@ -5526,7 +5568,7 @@
 msgstr "_Vermischen"
 
 #: avidemux/ADM_videoFilter/ADM_vidDecDec.cpp:190
-msgid "Discard Closer"
+msgid "Discard closer"
 msgstr ""
 
 #: avidemux/ADM_videoFilter/ADM_vidDecDec.cpp:191
@@ -5538,7 +5580,7 @@
 msgstr ""
 
 #: avidemux/ADM_videoFilter/ADM_vidDecDec.cpp:193
-msgid "PullDown dupe removal"
+msgid "Pulldown dupe removal"
 msgstr ""
 
 #: avidemux/ADM_videoFilter/ADM_vidDecDec.cpp:196
@@ -5546,46 +5588,49 @@
 msgstr "Am Schnellsten (partielle Brillianz, keine Farbintensit?t)"
 
 #: avidemux/ADM_videoFilter/ADM_vidDecDec.cpp:197
-msgid "Fast (parial luma and chroma)"
+msgid "Fast (partial luma and chroma)"
 msgstr "Schnell (partielle Brillianz und Farbintensit?t)"
 
 #: avidemux/ADM_videoFilter/ADM_vidDecDec.cpp:198
-msgid "Medium (full luma no chroma)"
+msgid "Medium (full luma, no chroma)"
 msgstr "Mittel (volle Brillianz, keine Farbintensit?t)"
 
 #: avidemux/ADM_videoFilter/ADM_vidDecDec.cpp:199
 msgid "Slow (full luma and chroma)"
 msgstr "Langsam (volle Brillianz und Farbintensit?t)"
 
-#: avidemux/ADM_videoFilter/ADM_vidDecDec.cpp:203
-#: avidemux/ADM_videoFilter/ADM_vidYadif.cpp:181
-msgid "Mode"
-msgstr "Modus"
-
-#: avidemux/ADM_videoFilter/ADM_vidDecDec.cpp:204
-msgid "Quality"
-msgstr "Qualit?t"
-
 #: avidemux/ADM_videoFilter/ADM_vidDecDec.cpp:205
-msgid "Threshold 1"
-msgstr "Schwelle 1"
+msgid "_Threshold 1:"
+msgstr "_Schwelle 1:"
 
 #: avidemux/ADM_videoFilter/ADM_vidDecDec.cpp:206
-msgid "Threshold 2"
-msgstr "Schwelle 2"
+msgid "T_hreshold 2:"
+msgstr "S_chwelle 2:"
 
 #: avidemux/ADM_videoFilter/ADM_vidPalShift.cpp:76
-msgid "Try reverse"
-msgstr "R?ckw?rts versuchen"
+msgid "_Try reverse"
+msgstr "Umgekehrt _versuchen"
 
 #: avidemux/ADM_videoFilter/ADM_vidVlad.cpp:101
-msgid "Luma Temporal Threshold"
-msgstr "Tempor?re Brillianz-Schwelle"
+msgid "_Luma temporal threshold:"
+msgstr "Tempor?re _Brillianz-Schwelle:"
 
 #: avidemux/ADM_videoFilter/ADM_vidVlad.cpp:102
-msgid "Chroma Temporal Threshold"
-msgstr "Tempor?re Farbintensit?ts-Schwelle"
+msgid "Ch_roma temporal threshold:"
+msgstr "Tempor?re Farb_intensit?ts-Schwelle"
 
+#: avidemux/ADM_videoFilter/ADM_vidDecTelecide.cpp:83
+msgid "No strategy"
+msgstr "Keine Strategie"
+
+#: avidemux/ADM_videoFilter/ADM_vidDecTelecide.cpp:84
+msgid "3:2 pulldown"
+msgstr "3:2 Abriss"
+
+#: avidemux/ADM_videoFilter/ADM_vidDecTelecide.cpp:85
+msgid "PAL/SECAM"
+msgstr "PAL/SECAM"
+
 #: avidemux/ADM_videoFilter/ADM_vidDecTelecide.cpp:95
 msgid "Never"
 msgstr "Nie"
@@ -5607,7 +5652,7 @@
 msgstr "Postprozess nach bestem Treffer"
 
 #: avidemux/ADM_videoFilter/ADM_vidDecTelecide.cpp:104
-msgid "Postproc and show zones(debug)"
+msgid "Postproc and show zones (debug)"
 msgstr "Postprozess und 'Show Zones' (Debug)"
 
 #: avidemux/ADM_videoFilter/ADM_vidDecTelecide.cpp:105
@@ -5615,56 +5660,52 @@
 msgstr "Bild verarbeiten (keine Felder)"
 
 #: avidemux/ADM_videoFilter/ADM_vidDecTelecide.cpp:106
-msgid "Process image (not fields),debug"
+msgid "Process image (not fields), debug"
 msgstr "Bild verarbeiten (keine Felder) (Debug)"
 
 #: avidemux/ADM_videoFilter/ADM_vidDecTelecide.cpp:110
-msgid "Strategy"
-msgstr "Strategie"
+msgid "_Strategy:"
+msgstr "_Strategie:"
 
-#: avidemux/ADM_videoFilter/ADM_vidDecTelecide.cpp:111
-msgid "Field Order"
-msgstr "Feldreihenfolge"
-
 #: avidemux/ADM_videoFilter/ADM_vidDecTelecide.cpp:112
-msgid "Post Processing"
-msgstr "Nachbearbeitung"
+msgid "_Postprocessing:"
+msgstr "_Nachbearbeitung:"
 
 #: avidemux/ADM_videoFilter/ADM_vidDecTelecide.cpp:113
-msgid "Try backward"
-msgstr "R?ckw?rts versuchen"
+msgid "_Try backward:"
+msgstr "R?ckw?rts _versuchen:"
 
 #: avidemux/ADM_videoFilter/ADM_vidDecTelecide.cpp:115
-msgid "Direct Threshold"
-msgstr "Direkte Schwelle"
+msgid "_Direct threshold:"
+msgstr "_Direkte Schwelle:"
 
 #: avidemux/ADM_videoFilter/ADM_vidDecTelecide.cpp:116
-msgid "Backward Threshold"
-msgstr "R?ckw?rts-Schwelle"
+msgid "_Backward threshold:"
+msgstr "_R?ckw?rts-Schwelle:"
 
 #: avidemux/ADM_videoFilter/ADM_vidDecTelecide.cpp:117
-msgid "Noise Threshold"
-msgstr "Rauschen-Schwelle"
+msgid "_Noise threshold:"
+msgstr "R_auschschwelle:"
 
 #: avidemux/ADM_videoFilter/ADM_vidDecTelecide.cpp:118
-msgid "Post Proc Threshold"
-msgstr "Nachbearbeitungs-Schwelle"
+msgid "Postp_rocessing threshold:"
+msgstr "Nachbea_rbeitungs-Schwelle:"
 
 #: avidemux/ADM_videoFilter/ADM_vidDecTelecide.cpp:120
-msgid "Use Chroma to decide"
-msgstr "Farbintensit?t zur Entscheidung benutzen"
+msgid "_Use chroma to decide"
+msgstr "Farbintensit?t zur Entscheidung ben_utzen"
 
 #: avidemux/ADM_videoFilter/ADM_vidDecTelecide.cpp:121
-msgid "Show info"
-msgstr "Zeige Infos"
+msgid "Sho_w info"
+msgstr "Zei_ge Info"
 
 #: avidemux/ADM_videoFilter/ADM_vidDecTelecide.cpp:122
-msgid "Debug"
-msgstr "Fehlersuche"
+msgid "Debu_g"
+msgstr "Fehlers_uche"
 
 #: avidemux/ADM_videoFilter/ADM_vidDecTelecide.cpp:123
-msgid "Blend"
-msgstr "Vermischen"
+msgid "Bl_end"
+msgstr "V_ermischen"
 
 #: avidemux/ADM_videoFilter/ADM_vidDropOut.cpp:63
 msgid "DropOut Threshold"
@@ -5710,26 +5751,23 @@
 msgid "Start must be before end, and both within video # of frames."
 msgstr "Start muss vor dem Ende sein, und beide innerhalb der # der Bilder."
 
-#: avidemux/ADM_videoFilter/ADM_vidBlendRemoval.cpp:82
-msgid "threshold"
-msgstr "Schwelle"
-
 #: avidemux/ADM_videoFilter/ADM_vidBlendRemoval.cpp:83
-#: avidemux/ADM_videoFilter/ADM_vidHardIvtcRemoval.cpp:88
-msgid "If value is smaller than threshold it is considered valid. Smaller value might mean more false positive"
-msgstr ""
+msgid "If value is smaller than threshold it is considered valid.Smaller value might mean more false positive."
+msgstr "Wenn der Wert kleiner als die Schwelle ist, wird er als g?ltig angenommen. Kleinere Werte bedeuten mehr falsch-positiv"
 
 #: avidemux/ADM_videoFilter/ADM_vidBlendRemoval.cpp:85
-msgid "noise"
-msgstr "Rauschen"
+#: avidemux/ADM_videoFilter/ADM_vidHardIvtcRemoval.cpp:90
+msgid "_Noise:"
+msgstr "_Rauschen:"
 
 #: avidemux/ADM_videoFilter/ADM_vidBlendRemoval.cpp:85
-msgid "If pixel are closer than noise, they are considered to be the same"
+#: avidemux/ADM_videoFilter/ADM_vidHardIvtcRemoval.cpp:90
+msgid "If pixels are closer than noise, they are considered to be the same"
 msgstr "Wenn Pixel sich n?her sind als das Rauschen, dann nimm an, dass sie gleich sind"
 
 #: avidemux/ADM_videoFilter/ADM_vidBlendRemoval.cpp:86
-msgid "identical"
-msgstr "identisch"
+msgid "I_dentical:"
+msgstr "I_dentisch:"
 
 #: avidemux/ADM_videoFilter/ADM_vidBlendRemoval.cpp:86
 #: avidemux/ADM_videoFilter/ADM_vidHardIvtcRemoval.cpp:91
@@ -5737,8 +5775,9 @@
 msgstr ""
 
 #: avidemux/ADM_videoFilter/ADM_vidBlendRemoval.cpp:87
-msgid "show"
-msgstr "zeigen"
+#: avidemux/ADM_videoFilter/ADM_vidHardIvtcRemoval.cpp:92
+msgid "_Show metrics"
+msgstr "_Zeige Ma?e an"
 
 #: avidemux/ADM_videoFilter/ADM_vidBlendRemoval.cpp:87
 #: avidemux/ADM_videoFilter/ADM_vidHardIvtcRemoval.cpp:92
@@ -5761,42 +5800,34 @@
 msgid "Show _frame"
 msgstr "_Bild anzeigen"
 
-#: avidemux/ADM_videoFilter/ADM_vidASS.cpp:85
-msgid "_Subtitle file (ass/ssa)"
-msgstr "_Untertitel Datei (ass/ssa)"
-
-#: avidemux/ADM_videoFilter/ADM_vidASS.cpp:86
-msgid "_Line spacing"
-msgstr "Zeilenabstand:"
-
 #: avidemux/ADM_videoFilter/ADM_vidASS.cpp:87
-msgid "_Font scale"
-msgstr "Schriftskalierung"
+msgid "_Subtitle file (ASS/SSA):"
+msgstr "_Untertitel Datei (ASS/SSA):"
 
 #: avidemux/ADM_videoFilter/ADM_vidASS.cpp:88
-msgid "_Top margin"
-msgstr "_Oberer Rand"
+msgid "_Line spacing:"
+msgstr "Zei_lenabstand:"
 
 #: avidemux/ADM_videoFilter/ADM_vidASS.cpp:89
-msgid "_Bottom margin"
-msgstr "_Unterer Rand"
+msgid "_Font scale:"
+msgstr "Schri_ftskalierung:"
 
-#: avidemux/ADM_videoFilter/ADM_vidHardIvtcRemoval.cpp:90
-msgid "_Noise:"
-msgstr "_Rauschen:"
+#: avidemux/ADM_videoFilter/ADM_vidASS.cpp:90
+msgid "_Top margin:"
+msgstr "_Oberer Rand:"
 
-#: avidemux/ADM_videoFilter/ADM_vidHardIvtcRemoval.cpp:90
-msgid "If pixels are closer than noise, they are considered to be the same"
-msgstr "Wenn Pixel sich n?her sind als das Rauschen, dann nimm an, dass sie gleich sind"
+#: avidemux/ADM_videoFilter/ADM_vidASS.cpp:91
+msgid "Botto_m margin"
+msgstr "_Unterer Rand:"
 
+#: avidemux/ADM_videoFilter/ADM_vidHardIvtcRemoval.cpp:88
+msgid "If value is smaller than threshold it is considered valid. Smaller value might mean more false positive"
+msgstr "Wenn der Wert kleiner als die Schwelle ist, wird er als g?ltig angenommen. Kleinere Werte bedeuten mehr falsch-positiv"
+
 #: avidemux/ADM_videoFilter/ADM_vidHardIvtcRemoval.cpp:91
 msgid "_Identical:"
 msgstr "_Identisch:"
 
-#: avidemux/ADM_videoFilter/ADM_vidHardIvtcRemoval.cpp:92
-msgid "_Show metrics"
-msgstr "_Zeige Ma?e an"
-
 #: avidemux/ADM_videoFilter/ADM_vidForcedPP.cpp:61
 msgid "_Quantizer:"
 msgstr "_Quantizer:"
@@ -5836,10 +5867,6 @@
 "der Halbbilder (deinterlaceing)"
 
 #: avidemux/ADM_videoFilter/ADM_vidKernelDeint.cpp:94
-msgid "_Sharp"
-msgstr "_Sch?rfen"
-
-#: avidemux/ADM_videoFilter/ADM_vidKernelDeint.cpp:94
 msgid "_Sharper engine:"
 msgstr "Sch?rfe optimieren"
 
@@ -5860,11 +5887,11 @@
 msgstr "Bereiche mit Halbbildmodus anzeigen (f?r Tests!)"
 
 #: avidemux/ADM_videoFilter/ADM_vidYadif.cpp:171
-msgid "Temporal & Spatial check"
+msgid "Temporal & spatial check"
 msgstr "Zeitliche & r?umliche Pr?fung"
 
 #: avidemux/ADM_videoFilter/ADM_vidYadif.cpp:172
-msgid "Bob, T+S check"
+msgid "Bob, temporal & spatial check"
 msgstr "Bob, zeitliche & r?umliche Pr?fung"
 
 #: avidemux/ADM_videoFilter/ADM_vidYadif.cpp:173
@@ -5872,16 +5899,12 @@
 msgstr "Ohne r?umliche & zeitliche Pr?fung"
 
 #: avidemux/ADM_videoFilter/ADM_vidYadif.cpp:174
-msgid "Bob, Skip spatial temporal check"
-msgstr "Bob, Ohne r?umliche & zeitliche Pr?fung"
+msgid "Bob, skip spatial temporal check"
+msgstr "Bob, ohne r?umliche & zeitliche Pr?fung"
 
-#: avidemux/ADM_videoFilter/ADM_vidYadif.cpp:177
-msgid "Bottom Field first"
-msgstr "Unteres Feld zuerst"
-
 #: avidemux/ADM_videoFilter/ADM_vidYadif.cpp:182
-msgid "Order"
-msgstr "Reihenfolge"
+msgid "_Order:"
+msgstr "Reihenf_olge:"
 
 #: avidemux/ADM_videoFilter/ADM_vidRotate.cpp:265
 msgid "90 degrees"
@@ -5908,12 +5931,12 @@
 msgstr "270?"
 
 #: avidemux/ADM_videoFilter/ADM_vidRotate.cpp:269
-msgid "Angle"
-msgstr "Drehpunkt"
+msgid "_Angle:"
+msgstr "Winkel:"
 
 #: avidemux/ADM_videoFilter/ADM_vidRotate.cpp:271
-msgid "Rotate Params"
-msgstr "Parameter drehen"
+msgid "Rotate"
+msgstr "Drehen"
 
 #: avidemux/ADM_videoFilter/ADM_vidMPLResize.cpp:143
 #: avidemux/ADM_videoFilter/ADM_guiResize.cpp:96
@@ -5925,15 +5948,31 @@
 msgid "Width and height cannot be odd"
 msgstr "Breite und H?he k?nnen nicht ungerade sein"
 
-#: avidemux/ADM_osSupport/ADM_crashdump.cpp:239
+#: avidemux/ADM_osSupport/ADM_crashdump.cpp:200
+#: avidemux/ADM_osSupport/ADM_crashdump.cpp:224
+msgid "Fatal Error"
+msgstr "Fataler Fehler"
+
+#: avidemux/ADM_osSupport/ADM_crashdump.cpp:200
+#: avidemux/ADM_osSupport/ADM_crashdump.cpp:224
+msgid ""
+"A fatal error has occurred.\n"
+"\n"
+"Click OK to generate debug information. This may take a few minutes to complete."
+msgstr ""
+"Ein fataler Fehler wurde entdeckt.\n"
+"\n"
+"Bitte auf OK klicken um Debug-Informationen zu erstellen. Das kann einige Minuten dauern."
+
+#: avidemux/ADM_osSupport/ADM_crashdump.cpp:423
 msgid "Load it"
 msgstr "Lade es"
 
-#: avidemux/ADM_osSupport/ADM_crashdump.cpp:239
+#: avidemux/ADM_osSupport/ADM_crashdump.cpp:423
 msgid "Crash file"
 msgstr "Dateiabsturz"
 
-#: avidemux/ADM_osSupport/ADM_crashdump.cpp:240
+#: avidemux/ADM_osSupport/ADM_crashdump.cpp:424
 msgid ""
 "I have detected a crash file. \n"
 "Do you want to load it  ?\n"
@@ -6105,23 +6144,15 @@
 msgid "No stts table"
 msgstr "Keine stts Tabelle"
 
-#: avidemux/ADM_inputs/ADM_mp4/ADM_mp4Analyzer.cpp:570
+#: avidemux/ADM_inputs/ADM_mp4/ADM_mp4Analyzer.cpp:583
 msgid "Problem reading SVQ3 headers"
 msgstr "Problem beim Lesen der SVQ3 Kopfzeilen"
 
-#: avidemux/ADM_ocr/ADM_ocrLoadSave.h:22
-msgid "Select Glyphfile to save to"
-msgstr "Schriftzeichen-Datei zum Speichern ausw?hlen"
-
-#: avidemux/ADM_ocr/ADM_ocrLoadSave.h:30
+#: avidemux/ADM_ocr/adm_glyph.cpp:173
 msgid "Could not write the file"
 msgstr "Konnte Datei nicht schreiben"
 
-#: avidemux/ADM_ocr/ADM_ocrLoadSave.h:62
-msgid "Erase current glyphs ?"
-msgstr "Aktuelle Schriftzeichen l?schen ?"
-
-#: avidemux/ADM_ocr/ADM_ocrLoadSave.h:71
+#: avidemux/ADM_ocr/adm_glyph.cpp:221
 #, c-format
 msgid "Could not read \"%s\"."
 msgstr "Konnte \"%s\" nicht lesen."
@@ -6150,55 +6181,55 @@
 msgid "Generating VobSub file"
 msgstr "Erstelle VobSub Datei"
 
-#: avidemux/gui_navigate.cpp:75
-#: avidemux/gui_navigate.cpp:113
-#: avidemux/gui_navigate.cpp:389
-#: avidemux/gui_navigate.cpp:425
+#: avidemux/gui_navigate.cpp:76
+#: avidemux/gui_navigate.cpp:114
+#: avidemux/gui_navigate.cpp:390
+#: avidemux/gui_navigate.cpp:426
 msgid "Decompressing error"
 msgstr "Dekompressions-Fehler"
 
-#: avidemux/gui_navigate.cpp:75
+#: avidemux/gui_navigate.cpp:76
 msgid "Cannot decode next frame."
 msgstr "Kann n?chstes Bild nicht dekodieren."
 
-#: avidemux/gui_navigate.cpp:113
-#: avidemux/gui_navigate.cpp:425
+#: avidemux/gui_navigate.cpp:114
+#: avidemux/gui_navigate.cpp:426
 msgid "Cannot decode keyframe."
 msgstr "Kann I-Bild (keyframe) nicht dekodieren."
 
-#: avidemux/gui_navigate.cpp:236
+#: avidemux/gui_navigate.cpp:237
 msgid "Seeking"
 msgstr "Suche..."
 
-#: avidemux/gui_navigate.cpp:314
+#: avidemux/gui_navigate.cpp:315
 msgid "Finding black frames"
 msgstr "Finde schwarze Bilder "
 
-#: avidemux/gui_navigate.cpp:389
+#: avidemux/gui_navigate.cpp:390
 msgid "Cannot decode the frame."
 msgstr "Kann Bild nicht dekodieren."
 
-#: avidemux/gtk_gui.cpp:246
-msgid "Select ECMAScript to run "
+#: avidemux/gtk_gui.cpp:253
+msgid "Select ECMAScript to Run"
 msgstr "Auszuf?hrendes ECMA-Skript ausw?hlen"
 
-#: avidemux/gtk_gui.cpp:293
-#: avidemux/gtk_gui.cpp:332
+#: avidemux/gtk_gui.cpp:300
+#: avidemux/gtk_gui.cpp:339
 msgid "Obsolete"
 msgstr "?berfl?ssig"
 
-#: avidemux/gtk_gui.cpp:360
+#: avidemux/gtk_gui.cpp:367
 msgid "Not coded in this version"
 msgstr "Nicht ?bersetzt in dieser Version"
 
-#: avidemux/gtk_gui.cpp:373
-#: avidemux/gtk_gui.cpp:378
-#: avidemux/gtk_gui.cpp:493
-#: avidemux/gtk_gui.cpp:496
-msgid "Select AVI file..."
+#: avidemux/gtk_gui.cpp:382
+#: avidemux/gtk_gui.cpp:387
+#: avidemux/gtk_gui.cpp:506
+#: avidemux/gtk_gui.cpp:509
+msgid "Select AVI File..."
 msgstr "AVI-Datei ausw?hlen..."
 
-#: avidemux/gtk_gui.cpp:429
+#: avidemux/gtk_gui.cpp:442
 msgid ""
 "This is to be used to undo packed VOP on MPEG-4.\n"
 "Continue ?"
@@ -6206,127 +6237,127 @@
 "Dies wird ben?tigt, um das Packen von VOP von Mpeg-4 zur?ckzunehmen.\n"
 "Fortfahren ?"
 
-#: avidemux/gtk_gui.cpp:431
-msgid "Select AVI file to write"
-msgstr "Zu schreibende AVI-Datei ausw?hlen"
+#: avidemux/gtk_gui.cpp:444
+msgid "Select AVI File to Write"
+msgstr "Als AVI-Datei schreiben"
 
-#: avidemux/gtk_gui.cpp:437
-msgid "Select OGM file to write"
-msgstr "Zu schreibende OGM-Datei ausw?hlen"
+#: avidemux/gtk_gui.cpp:450
+msgid "Select OGM File to Write"
+msgstr "Als OGM-Datei schreiben"
 
-#: avidemux/gtk_gui.cpp:448
-#: avidemux/gtk_gui.cpp:459
-msgid "Select workbench to save"
-msgstr "Zu speichernden Arbeitsbereich ausw?hlen"
+#: avidemux/gtk_gui.cpp:461
+#: avidemux/gtk_gui.cpp:472
+msgid "Select Workbench to Save"
+msgstr "Arbeitsbereich als Projekt speichern"
 
-#: avidemux/gtk_gui.cpp:483
-msgid "Select raw file to save"
-msgstr "Zu speichernde Roh-Datei ausw?hlen"
+#: avidemux/gtk_gui.cpp:496
+msgid "Select Raw File to Save"
+msgstr "Als rohe Datei speichern"
 
-#: avidemux/gtk_gui.cpp:499
-msgid "Select AVI file to append..."
-msgstr "Anzuh?ngende AVI-Datei ausw?hlen..."
+#: avidemux/gtk_gui.cpp:512
+msgid "Select AVI File to Append..."
+msgstr "AVI-Datei ausw?hlen zum Anh?ngen"
 
-#: avidemux/gtk_gui.cpp:503
-msgid "Select file to save audio"
-msgstr "Zu speichernde Audio-Datei ausw?hlen"
+#: avidemux/gtk_gui.cpp:516
+msgid "Select File to Save Audio"
+msgstr "Als Audio-Datei speichern"
 
-#: avidemux/gtk_gui.cpp:537
-msgid "Select JPEG sequence to save"
-msgstr "Zu speichernde Jpeg-Folge ausw?hlen"
+#: avidemux/gtk_gui.cpp:550
+msgid "Select JPEG Sequence to Save"
+msgstr "Als JPEG-Folge speichern"
 
-#: avidemux/gtk_gui.cpp:540
-msgid "Select BMP to save"
-msgstr "Zu speichernde BMP-Datei ausw?hlen"
+#: avidemux/gtk_gui.cpp:553
+msgid "Select BMP to Save"
+msgstr "Als BMP-Datei speichern"
 
-#: avidemux/gtk_gui.cpp:544
-msgid "Select JPEG to save"
-msgstr "Zu speichernde JPEG-Datei ausw?hlen"
+#: avidemux/gtk_gui.cpp:557
+msgid "Select JPEG to Save"
+msgstr "Als JPEG-Datei speichern"
 
-#: avidemux/gtk_gui.cpp:597
-#: avidemux/gtk_gui.cpp:709
-msgid "Select file to save"
-msgstr "Zu speichernde Datei ausw?hlen"
+#: avidemux/gtk_gui.cpp:610
+#: avidemux/gtk_gui.cpp:714
+msgid "Select File to Save"
+msgstr "Als Datei speichern"
 
-#: avidemux/gtk_gui.cpp:649
-msgid "Select MP3 to load"
-msgstr "Zu ladende MP3 ausw?hlen"
+#: avidemux/gtk_gui.cpp:654
+msgid "Select MP3 to Load"
+msgstr "MP3-Datei ausw?hlen zum Laden"
 
-#: avidemux/gtk_gui.cpp:652
-msgid "Select AC3 to load"
-msgstr "Zu ladende AC3 ausw?hlen"
+#: avidemux/gtk_gui.cpp:657
+msgid "Select AC3 to Load"
+msgstr "AC3-Datei ausw?hlen zum Laden"
 
-#: avidemux/gtk_gui.cpp:655
-msgid "Select WAV to load"
-msgstr "Zu ladende WAV-Datei ausw?hlen"
+#: avidemux/gtk_gui.cpp:660
+msgid "Select WAV to Load"
+msgstr "WAV-Datei ausw?hlen zum Laden"
 
-#: avidemux/gtk_gui.cpp:703
+#: avidemux/gtk_gui.cpp:708
 msgid "Out of bounds"
 msgstr "Au?erhalb der Grenzen"
 
-#: avidemux/gtk_gui.cpp:714
-#: avidemux/gtk_gui.cpp:1905
+#: avidemux/gtk_gui.cpp:719
+#: avidemux/gtk_gui.cpp:1911
 msgid "Marker A > B"
 msgstr "Marke A > B"
 
-#: avidemux/gtk_gui.cpp:714
+#: avidemux/gtk_gui.cpp:719
 msgid "Cannot copy."
 msgstr "Kann nicht kopieren."
 
-#: avidemux/gtk_gui.cpp:726
+#: avidemux/gtk_gui.cpp:731
 msgid "Something bad happened (II))"
 msgstr "Irgendwas Schlimmes ist passiert (II))"
 
-#: avidemux/gtk_gui.cpp:740
+#: avidemux/gtk_gui.cpp:745
 msgid "Are you sure?"
 msgstr "Sicher?"
 
-#: avidemux/gtk_gui.cpp:795
-msgid "Change Frames per Second"
-msgstr "?ndere Bilder pro Sekunde"
+#: avidemux/gtk_gui.cpp:800
+msgid "Frame Rate"
+msgstr "Bildrate"
 
-#: avidemux/gtk_gui.cpp:795
-msgid "New FPS?"
-msgstr "Neues FPS?"
+#: avidemux/gtk_gui.cpp:800
+msgid "_Frames per second:"
+msgstr "_Bilder pro Sekunde:"
 
-#: avidemux/gtk_gui.cpp:818
+#: avidemux/gtk_gui.cpp:823
 msgid "Width is not a multiple of 8"
 msgstr "Breite ist kein Vielfaches von 8"
 
-#: avidemux/gtk_gui.cpp:819
+#: avidemux/gtk_gui.cpp:824
 msgid "This will make trouble for AVI files."
 msgstr "Dies wird bei AVI-Dateien Schwierigkeiten bereiten."
 
-#: avidemux/gtk_gui.cpp:829
+#: avidemux/gtk_gui.cpp:834
 msgid "Rebuild all Keyframes?"
 msgstr "Alle I-Bilder (keyframes) neu aufbauen?"
 
-#: avidemux/gtk_gui.cpp:887
+#: avidemux/gtk_gui.cpp:892
 msgid "Permission error"
 msgstr "Rechtefehler"
 
-#: avidemux/gtk_gui.cpp:890
+#: avidemux/gtk_gui.cpp:895
 #, c-format
 msgid "\"%s\" does not exist."
 msgstr "\"%s\" existiert nicht."
 
-#: avidemux/gtk_gui.cpp:932
+#: avidemux/gtk_gui.cpp:937
 msgid "Cannot open project using the video loader."
 msgstr "Projekt kann nicht mit dem Video-Lader ge?ffnet werden."
 
-#: avidemux/gtk_gui.cpp:933
+#: avidemux/gtk_gui.cpp:938
 msgid "Try 'File' -> 'Load/Run Project...'"
 msgstr "Versuche 'Datei' -> 'Projekt laden/starten...'"
 
-#: avidemux/gtk_gui.cpp:935
+#: avidemux/gtk_gui.cpp:940
 msgid "Could not open the file"
 msgstr "Datei kann nicht ge?ffnet werden"
 
-#: avidemux/gtk_gui.cpp:970
+#: avidemux/gtk_gui.cpp:975
 msgid "Multiple Audio Tracks"
 msgstr "Mehrere Audio-Spuren"
 
-#: avidemux/gtk_gui.cpp:970
+#: avidemux/gtk_gui.cpp:975
 msgid ""
 "The file you just loaded contains several audio tracks.\n"
 "Go to Audio->MainTrack to select the active one."
@@ -6334,281 +6365,281 @@
 "Die soeben geladene Datei enth?lt mehrere Audio-Spuren.\n"
 "Gehe zu Audio->Hauptspur und w?hle die aktive Spur aus."
 
-#: avidemux/gtk_gui.cpp:1060
+#: avidemux/gtk_gui.cpp:1065
 msgid "No audio decoder found for this file"
 msgstr "Keinen Audio Dekodierer f?r diese Datei gefunden"
 
-#: avidemux/gtk_gui.cpp:1061
+#: avidemux/gtk_gui.cpp:1066
 msgid "Save (A+V) will generate bad AVI. Save audio will work."
 msgstr "Speichern von (A+V) wird schlechtes AVI erzeugen. Speichern von Audio arbeitet gut."
 
-#: avidemux/gtk_gui.cpp:1117
+#: avidemux/gtk_gui.cpp:1122
 msgid "Something failed when appending"
 msgstr "Irgendwas ging schief beim Anh?ngen"
 
-#: avidemux/gtk_gui.cpp:1126
-#: avidemux/gtk_gui.cpp:1924
+#: avidemux/gtk_gui.cpp:1131
+#: avidemux/gtk_gui.cpp:1930
 msgid "Something bad happened (II)"
 msgstr "Irgendwas Schlimmes ist passiert (II)"
 
-#: avidemux/gtk_gui.cpp:1190
+#: avidemux/gtk_gui.cpp:1195
 msgid "Cannot save the audio in copy mode"
 msgstr "Kann im Kopie-Modus kein Audio speichern"
 
-#: avidemux/gtk_gui.cpp:1190
+#: avidemux/gtk_gui.cpp:1195
 msgid "Select WAV PCM as the audio codec, otherwise the audio file would be raw PCM."
 msgstr "Bitte WAV PCM als Audio Codec ausw?hlen, sonst w?re die Audio-Datei Roh-PCM."
 
-#: avidemux/gtk_gui.cpp:1198
-#: avidemux/gtk_gui.cpp:1554
+#: avidemux/gtk_gui.cpp:1203
+#: avidemux/gtk_gui.cpp:1559
 msgid "Saving audio"
 msgstr "Audio speichern"
 
-#: avidemux/gtk_gui.cpp:1275
+#: avidemux/gtk_gui.cpp:1280
 msgid "Get Frame"
 msgstr "Hole Bild"
 
-#: avidemux/gtk_gui.cpp:1275
+#: avidemux/gtk_gui.cpp:1280
 msgid "Cannot get this frame to save"
 msgstr "Kann dieses Bild nicht zum zum Speichern bekommen"
 
-#: avidemux/gtk_gui.cpp:1312
+#: avidemux/gtk_gui.cpp:1317
 msgid "Mark A > B"
 msgstr "Marke A > B"
 
-#: avidemux/gtk_gui.cpp:1312
+#: avidemux/gtk_gui.cpp:1317
 msgid "Set your markers correctly."
 msgstr "Bitte Marken korrekt setzen."
 
-#: avidemux/gtk_gui.cpp:1321
+#: avidemux/gtk_gui.cpp:1326
 msgid "Saving as set of jpegs"
 msgstr "Speichern als Satz von Jpeg-Dateien"
 
-#: avidemux/gtk_gui.cpp:1327
+#: avidemux/gtk_gui.cpp:1332
 msgid "Cannot decode frame"
 msgstr "Kann Bild nicht dekodieren"
 
-#: avidemux/gtk_gui.cpp:1327
+#: avidemux/gtk_gui.cpp:1332
 msgid "Aborting."
 msgstr "Abbruch."
 
-#: avidemux/gtk_gui.cpp:1338
-#: avidemux/gtk_gui.cpp:1357
-#: avidemux/gtk_gui.cpp:2268
+#: avidemux/gtk_gui.cpp:1343
+#: avidemux/gtk_gui.cpp:1362
+#: avidemux/gtk_gui.cpp:2274
 msgid "Done"
 msgstr "Fertig"
 
-#: avidemux/gtk_gui.cpp:1338
+#: avidemux/gtk_gui.cpp:1343
 #, c-format
 msgid "Saved %d images."
 msgstr "%d Bilder gespeichert."
 
-#: avidemux/gtk_gui.cpp:1340
+#: avidemux/gtk_gui.cpp:1345
 msgid "Error"
 msgstr "Fehler"
 
-#: avidemux/gtk_gui.cpp:1340
+#: avidemux/gtk_gui.cpp:1345
 msgid "Could not save all images."
 msgstr "Konnte nicht alle Bilder speichern."
 
-#: avidemux/gtk_gui.cpp:1357
+#: avidemux/gtk_gui.cpp:1362
 #, c-format
 msgid "Saved \"%s\"."
 msgstr "\"%s\" gespeichert."
 
-#: avidemux/gtk_gui.cpp:1359
+#: avidemux/gtk_gui.cpp:1364
 msgid "BMP op failed"
 msgstr "BMP Op. misslungen"
 
-#: avidemux/gtk_gui.cpp:1359
+#: avidemux/gtk_gui.cpp:1364
 #, c-format
 msgid "Saving %s as a BMP file failed."
 msgstr "Speichern von %s als BMP-Datei ist misslungen."
 
-#: avidemux/gtk_gui.cpp:1379
-#: avidemux/gtk_gui.cpp:1445
+#: avidemux/gtk_gui.cpp:1384
+#: avidemux/gtk_gui.cpp:1450
 msgid "Failed to open the file"
 msgstr "?ffnen der Datei gescheitert"
 
-#: avidemux/gtk_gui.cpp:1379
-#: avidemux/gtk_gui.cpp:1445
+#: avidemux/gtk_gui.cpp:1384
+#: avidemux/gtk_gui.cpp:1450
 msgid "Not a WAV file?"
 msgstr "Keine WAV-Datei?"
 
-#: avidemux/gtk_gui.cpp:1380
+#: avidemux/gtk_gui.cpp:1385
 #, c-format
 msgid "WAV open file failed..."
 msgstr "?ffnen der WAV Datei gescheitert"
 
-#: avidemux/gtk_gui.cpp:1515
+#: avidemux/gtk_gui.cpp:1520
 msgid "Cannot decompress audio frame"
 msgstr "Kann Audio nicht dekomprimieren"
 
-#: avidemux/gtk_gui.cpp:1529
+#: avidemux/gtk_gui.cpp:1534
 msgid "Memory Error"
 msgstr "Speicherfehler"
 
-#: avidemux/gtk_gui.cpp:1575
+#: avidemux/gtk_gui.cpp:1580
 msgid "No frames to encode"
 msgstr "Keine Bilder zum Kodieren"
 
-#: avidemux/gtk_gui.cpp:1575
+#: avidemux/gtk_gui.cpp:1580
 msgid "Please check markers. Is \"A>\" == \">B\"?"
 msgstr "Bitte Marken ?berpr?fen. Ist \"A>\" == \">B\"?"
 
-#: avidemux/gtk_gui.cpp:1694
+#: avidemux/gtk_gui.cpp:1700
 msgid "Saving raw video stream"
 msgstr "Rohe Videodaten speichern"
 
-#: avidemux/gtk_gui.cpp:1840
+#: avidemux/gtk_gui.cpp:1846
 msgid "Checking video"
 msgstr "Video pr?fen"
 
-#: avidemux/gtk_gui.cpp:1856
+#: avidemux/gtk_gui.cpp:1862
 msgid "No error found"
 msgstr "Keinen Fehler gefunden"
 
-#: avidemux/gtk_gui.cpp:1860
+#: avidemux/gtk_gui.cpp:1866
 #, c-format
 msgid "Errors found in %u frames"
 msgstr "Fehler wurden in %u Bildern gefunden"
 
-#: avidemux/gtk_gui.cpp:1878
+#: avidemux/gtk_gui.cpp:1884
 msgid "Cannot decompress the audio stream"
 msgstr "Kann Audio-Strom nicht dekomprimieren"
 
-#: avidemux/gtk_gui.cpp:1878
+#: avidemux/gtk_gui.cpp:1884
 msgid "Switch audio codec to Copy."
 msgstr "Schalte Audio-Codec um nach Kopie."
 
-#: avidemux/gtk_gui.cpp:1905
+#: avidemux/gtk_gui.cpp:1911
 msgid "Cannot delete the selection."
 msgstr "Die Auswahl kann nicht gel?scht werden."
 
-#: avidemux/gtk_gui.cpp:1910
+#: avidemux/gtk_gui.cpp:1916
 msgid "You can't remove all frames"
 msgstr "Es k?nnen nicht alle Bilder entfernt werden"
 
-#: avidemux/gtk_gui.cpp:1986
+#: avidemux/gtk_gui.cpp:1992
 msgid "Could not get tracks info"
 msgstr "Konnte keine Spur-Infos bekommen"
 
-#: avidemux/gtk_gui.cpp:1994
+#: avidemux/gtk_gui.cpp:2000
 msgid "Video"
 msgstr "Video"
 
-#: avidemux/gtk_gui.cpp:1994
+#: avidemux/gtk_gui.cpp:2000
 msgid "Take audio from video file"
 msgstr "Audio-Spur von der Video-Datei nehmen"
 
-#: avidemux/gtk_gui.cpp:1995
-#: avidemux/gtk_gui.cpp:2094
+#: avidemux/gtk_gui.cpp:2001
+#: avidemux/gtk_gui.cpp:2100
 msgid "No audio"
 msgstr "Keine Audio-Spur"
 
-#: avidemux/gtk_gui.cpp:1996
-#: avidemux/gtk_gui.cpp:2095
+#: avidemux/gtk_gui.cpp:2002
+#: avidemux/gtk_gui.cpp:2101
 msgid "External AC3"
 msgstr "Externes AC3"
 
-#: avidemux/gtk_gui.cpp:1996
-#: avidemux/gtk_gui.cpp:2095
+#: avidemux/gtk_gui.cpp:2002
+#: avidemux/gtk_gui.cpp:2101
 msgid "Take audio from external AC3 file"
 msgstr "Audio-Spur von externer AC3-Datei ?bernehmen"
 
-#: avidemux/gtk_gui.cpp:1997
-#: avidemux/gtk_gui.cpp:2096
+#: avidemux/gtk_gui.cpp:2003
+#: avidemux/gtk_gui.cpp:2102
 msgid "External MP3"
 msgstr "Externe MP3"
 
-#: avidemux/gtk_gui.cpp:1997
-#: avidemux/gtk_gui.cpp:2096
+#: avidemux/gtk_gui.cpp:2003
+#: avidemux/gtk_gui.cpp:2102
 msgid "Take audio from external MP3 file"
 msgstr "Audio-Spur von externer MP3-Datei ?bernehmen"
 
-#: avidemux/gtk_gui.cpp:1998
-#: avidemux/gtk_gui.cpp:2097
+#: avidemux/gtk_gui.cpp:2004
+#: avidemux/gtk_gui.cpp:2103
 msgid "External WAV"
 msgstr "Externe WAV"
 
-#: avidemux/gtk_gui.cpp:1998
-#: avidemux/gtk_gui.cpp:2097
+#: avidemux/gtk_gui.cpp:2004
+#: avidemux/gtk_gui.cpp:2103
 msgid "Take audio from external WAV file"
 msgstr "Audio-Spur von externer WAV-Datei ?bernehmen"
 
-#: avidemux/gtk_gui.cpp:2002
-#: avidemux/gtk_gui.cpp:2102
+#: avidemux/gtk_gui.cpp:2008
+#: avidemux/gtk_gui.cpp:2108
 msgid "_Audio source:"
 msgstr "_Audio Quelle:"
 
-#: avidemux/gtk_gui.cpp:2006
-#: avidemux/gtk_gui.cpp:2103
+#: avidemux/gtk_gui.cpp:2012
+#: avidemux/gtk_gui.cpp:2109
 msgid "_External file:"
 msgstr "_Externe Datei:"
 
-#: avidemux/gtk_gui.cpp:2021
+#: avidemux/gtk_gui.cpp:2027
 msgid "_Track from video:"
 msgstr "_Spur vom Video:"
 
-#: avidemux/gtk_gui.cpp:2031
+#: avidemux/gtk_gui.cpp:2037
 msgid "Main Audio Track"
 msgstr "Haupt-Audio-Spur"
 
-#: avidemux/gtk_gui.cpp:2037
-#: avidemux/gtk_gui.cpp:2115
+#: avidemux/gtk_gui.cpp:2043
+#: avidemux/gtk_gui.cpp:2121
 msgid "Cannot load"
 msgstr "Kann nicht laden"
 
-#: avidemux/gtk_gui.cpp:2037
-#: avidemux/gtk_gui.cpp:2115
+#: avidemux/gtk_gui.cpp:2043
+#: avidemux/gtk_gui.cpp:2121
 msgid "The selected audio file does not exist."
 msgstr "Die ausgew?hlte Audiodatei existiert nicht."
 
-#: avidemux/gtk_gui.cpp:2112
+#: avidemux/gtk_gui.cpp:2118
 msgid "Second Audio Track"
 msgstr "Zweite Audio-Spur"
 
-#: avidemux/gtk_gui.cpp:2144
+#: avidemux/gtk_gui.cpp:2150
 msgid "Error loading the MP3 file"
 msgstr "Fehler beim Laden der MP3 Datei"
 
-#: avidemux/gtk_gui.cpp:2153
-#: avidemux/gtk_gui.cpp:2175
-#: avidemux/gtk_gui.cpp:2197
+#: avidemux/gtk_gui.cpp:2159
+#: avidemux/gtk_gui.cpp:2181
+#: avidemux/gtk_gui.cpp:2203
 msgid "Second track loaded"
 msgstr "Zweite Spur geladen"
 
-#: avidemux/gtk_gui.cpp:2167
+#: avidemux/gtk_gui.cpp:2173
 msgid "Error loading the AC3 file"
 msgstr "Fehler beim Laden der AC3 Datei"
 
-#: avidemux/gtk_gui.cpp:2189
+#: avidemux/gtk_gui.cpp:2195
 msgid "Error loading the WAV file"
 msgstr "Fehler beim Laden der WAV Datei"
 
-#: avidemux/gtk_gui.cpp:2256
+#: avidemux/gtk_gui.cpp:2262
 msgid "Saving failed"
 msgstr "Speichern gescheitert"
 
-#: avidemux/gtk_gui.cpp:2256
+#: avidemux/gtk_gui.cpp:2262
 msgid "Saving the job failed. Maybe you have permission issue with ~/.avidemux"
 msgstr "Speichern des Jobs misslungen. Vielleicht bestehen Rechte-Probleme mit  ~/.avidemux"
 
-#: avidemux/gtk_gui.cpp:2268
+#: avidemux/gtk_gui.cpp:2274
 #, c-format
 msgid "File %s has been successfully saved."
 msgstr "Datei %s wurde erfolgreich gespeichert."
 
-#: avidemux/gtk_gui.cpp:2272
+#: avidemux/gtk_gui.cpp:2278
 #, c-format
 msgid "File %s was NOT saved correctly."
 msgstr "Datei %s wurde NICHT korrekt gespeichert."
 
-#: avidemux/gtk_gui.cpp:2426
+#: avidemux/gtk_gui.cpp:2432
 msgid "AvsProxy"
 msgstr "Avs-Proxy"
 
-#: avidemux/gtk_gui.cpp:2426
+#: avidemux/gtk_gui.cpp:2432
 msgid ""
 "Failed to connect to avsproxy.\n"
 "Is it running ?"
@@ -6616,34 +6647,30 @@
 "Fehler beim Verbinden mit Avs-Proxy.\n"
 "L?uft es ?"
 
-#: avidemux/gtk_gui.cpp:2431
+#: avidemux/gtk_gui.cpp:2437
 msgid "avsproxy"
 msgstr "avsproxy"
 
-#: avidemux/gtk_gui.cpp:2459
+#: avidemux/gtk_gui.cpp:2465
 msgid "Frame type:"
 msgstr "Bildtyp:"
 
-#: avidemux/gtk_gui.cpp:2460
+#: avidemux/gtk_gui.cpp:2466
 msgid "Frame size:"
 msgstr "Bildgr??e:"
 
-#: avidemux/gtk_gui.cpp:2462
+#: avidemux/gtk_gui.cpp:2468
 msgid "Frame Hex Dump"
 msgstr "Bild hexadez. Abbild"
 
 #: avidemux/GUI_jobs.cpp:37
-msgid "Something very wrong happened when buildint joblist"
+msgid "Something very wrong happened when building joblist."
 msgstr "Irgendwas ganz Falsches ist passiert beim Erstellen der Job-Liste"
 
 #: avidemux/GUI_jobs.cpp:42
-msgid "Nothing to do."
-msgstr "Nichts zu tun."
+msgid "There are no jobs stored"
+msgstr "Es wurden keine Jobs gespeichert"
 
-#: avidemux/GUI_jobs.cpp:42
-msgid "There is no jobs stored, nothing to do"
-msgstr "Keine Jobs gespeichert, nichts zu tun"
-
 #: avidemux/gui_autodrive.cpp:52
 msgid "No audio track"
 msgstr "Keine Audio-Spur"
@@ -6713,6 +6740,122 @@
 "Eventuell ist sanftes Kopieren erforderlich.\n"
 " Aktivieren?"
 
+#~ msgid "<b>Glyphs</b>"
+#~ msgstr "<b>Schriftzeichen</b>"
+#~ msgid "  "
+#~ msgstr "  "
+#~ msgid "VobSub"
+#~ msgstr "VobSub"
+#~ msgid "Output Srt"
+#~ msgstr "Ausgabe SRT"
+#~ msgid "<b>Files</b>"
+#~ msgstr "<b>Dateien</b>"
+#~ msgid "StartOcr"
+#~ msgstr "StartOcr"
+#~ msgid "Incorrect output file"
+#~ msgstr "Fehlerhafte Ausgabe-Datei"
+#~ msgid "Select SRT to save"
+#~ msgstr "Zu speichernde SRT ausw?hlen"
+#~ msgid "Select Glyoh to save"
+#~ msgstr "Zu speichernde Schriftzeichen ausw?hlen"
+#~ msgid "No glyphs to save"
+#~ msgstr "Keine Schriftzeichen zum Speichern vorhanden"
+#~ msgid "Erase current glyphs ?"
+#~ msgstr "Aktuelle Schriftzeichen l?schen ?"
+#~ msgid "Select background picture"
+#~ msgstr "Hintergrund-Bild ausw?hlen"
+#~ msgid "Animated Menu"
+#~ msgstr "Animiertes Men?"
+#~ msgid "Standard"
+#~ msgstr "Standard"
+#~ msgid "<b>General</b>"
+#~ msgstr "<b>generell</b>"
+#~ msgid "Chapter 1"
+#~ msgstr "Kapitel 1"
+#~ msgid "Chapter 2"
+#~ msgstr "Kapitel 2"
+#~ msgid "Chapter 3"
+#~ msgstr "Kapitel 3"
+#~ msgid "Chapter 4"
+#~ msgstr "Kapitel 4"
+#~ msgid "Chapter 5"
+#~ msgstr "Kapitel 5"
+#~ msgid "Chapter 6"
+#~ msgstr "Kapitel 6"
+#~ msgid "Start frame for this vignette."
+#~ msgstr "Starte Bild f?r diese Vignette."
+#~ msgid "<b>TimeCode</b>"
+#~ msgstr "<b>Zeit-Code</b>"
+#~ msgid "<b>Elasped:</b>"
+#~ msgstr "<b>Vergangen:</b>"
+#~ msgid "Bitrate Calculator"
+#~ msgstr "Bitrate Taschenrechner"
+#~ msgid "/0000000"
+#~ msgstr "/0000000"
+#~ msgid "Previous"
+#~ msgstr "Vorheriges"
+#~ msgid "Next"
+#~ msgstr "N?chstes"
+#~ msgid "Audio codecs:"
+#~ msgstr "Audio Kodierer:"
+#~ msgid "Miscellaneous libraries:"
+#~ msgstr "Verschiedene Bibliotheken:"
+#~ msgid "Alsa"
+#~ msgstr "Alsa"
+#~ msgid "Swap U & V:"
+#~ msgstr "U mit V tauschen:"
+#~ msgid "Lavcodec Decoder Configuration"
+#~ msgstr "Libavcodec Dekodierer Konfiguration"
+#~ msgid "Bottom Field First"
+#~ msgstr "Unteres Feld zuerst"
+#~ msgid "Sharp"
+#~ msgstr "Sch?rfe erh?hen"
+#~ msgid "TDEint Configuration"
+#~ msgstr "TDEint Konfiguration"
+#~ msgid "Vobsub file:"
+#~ msgstr "Vobsub Datei:"
+#~ msgid "Vob 2 Vobsub"
+#~ msgstr "Vob nach Vobsub"
+#~ msgid "VOB file"
+#~ msgstr "VOB Datei"
+#~ msgid "IFO file"
+#~ msgstr "IFO Datei"
+#~ msgid "The selected IFO file does not exist."
+#~ msgstr "Die ausgew?hlte IFO Datei existiert nicht."
+#~ msgid "Color"
+#~ msgstr "Farbe"
+#~ msgid "AVI, unp. VOP"
+#~ msgstr "AVI, ungepack. VOP"
+#~ msgid "Mode"
+#~ msgstr "Modus"
+#~ msgid "Quality"
+#~ msgstr "Qualit?t"
+#~ msgid "Threshold 1"
+#~ msgstr "Schwelle 1"
+#~ msgid "Threshold 2"
+#~ msgstr "Schwelle 2"
+#~ msgid "Field Order"
+#~ msgstr "Feldreihenfolge"
+#~ msgid "Post Processing"
+#~ msgstr "Nachbearbeitung"
+#~ msgid "threshold"
+#~ msgstr "Schwelle"
+#~ msgid "noise"
+#~ msgstr "Rauschen"
+#~ msgid "If pixel are closer than noise, they are considered to be the same"
+#~ msgstr ""
+#~ "Wenn Pixel sich n?her sind als das Rauschen, dann nimm an, dass sie "
+#~ "gleich sind"
+#~ msgid "identical"
+#~ msgstr "identisch"
+#~ msgid "show"
+#~ msgstr "zeigen"
+#~ msgid "Bob, T+S check"
+#~ msgstr "Bob, zeitliche & r?umliche Pr?fung"
+#~ msgid "New FPS?"
+#~ msgstr "Neues FPS?"
+#~ msgid "Nothing to do."
+#~ msgstr "Nichts zu tun."
 #~ msgid "Two pass - file size"
 #~ msgstr "Zwei Durchl?ufe - Dateigr??e"
 #~ msgid "Two pass - average bitrate"
@@ -6793,8 +6936,6 @@
 #~ msgstr "Bitte einen g?ltigen VOB-Dateinamen ausw?hlen oder eingeben"
 #~ msgid "Invalid ifo"
 #~ msgstr "Ung?ltiger IFO-Name"
-#~ msgid "Please select or enter a valid ifo file"
-#~ msgstr "Bitte einen g?ltigen IFO-Dateinamen ausw?hlen oder eingeben"
 #~ msgid "Invalid vobsubname"
 #~ msgstr "Ung?ltiger VobSub-Name"
 #~ msgid "Please select or enter a valid vobsub file"



From mean at mail.berlios.de  Sat Jul 21 18:39:09 2007
From: mean at mail.berlios.de (mean at BerliOS)
Date: Sat, 21 Jul 2007 18:39:09 +0200
Subject: [Avidemux-svn-commit] r3426 - branches/avidemux_2.4_branch/po
Message-ID: <200707211639.l6LGd9rv011408@sheep.berlios.de>

Author: mean
Date: 2007-07-21 18:38:55 +0200 (Sat, 21 Jul 2007)
New Revision: 3426

Modified:
   branches/avidemux_2.4_branch/po/avidemux.pot
Log:
[I18N] Updated pot file\n

Modified: branches/avidemux_2.4_branch/po/avidemux.pot
===================================================================
--- branches/avidemux_2.4_branch/po/avidemux.pot	2007-07-21 16:37:51 UTC (rev 3425)
+++ branches/avidemux_2.4_branch/po/avidemux.pot	2007-07-21 16:38:55 UTC (rev 3426)
@@ -8,7 +8,7 @@
 msgstr ""
 "Project-Id-Version: PACKAGE VERSION\n"
 "Report-Msgid-Bugs-To: \n"
-"POT-Creation-Date: 2007-04-24 13:16+0100\n"
+"POT-Creation-Date: 2007-07-21 18:42+0200\n"
 "PO-Revision-Date: YEAR-MO-DA HO:MI+ZONE\n"
 "Last-Translator: FULL NAME <EMAIL at ADDRESS>\n"
 "Language-Team: LANGUAGE <LL at li.org>\n"
@@ -17,7 +17,7 @@
 "Content-Transfer-Encoding: 8bit\n"
 
 #: avidemux/ADM_audiocodec/ADM_codecwma.cpp:75
-#: avidemux/ADM_audiocodec/ADM_codecwma.cpp:182
+#: avidemux/ADM_audiocodec/ADM_codecwma.cpp:183
 msgid "Internal error"
 msgstr ""
 
@@ -25,21 +25,16 @@
 msgid "Cannot open WMA2 codec."
 msgstr ""
 
-#: avidemux/ADM_audiocodec/ADM_codecwma.cpp:182
+#: avidemux/ADM_audiocodec/ADM_codecwma.cpp:183
 msgid "Cannot open AMR codec."
 msgstr ""
 
-#: avidemux/ADM_audiodevice/ADM_deviceoss.cpp:118
-msgid "Could not open OSS audio device"
-msgstr ""
-
-#: avidemux/ADM_audiodevice/ADM_deviceoss.cpp:118
-msgid "Check the permissions for /dev/dsp."
-msgstr ""
-
 #: avidemux/ADM_audiofilter/audioencoder_lame.cpp:215
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:199
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_audio.cpp:371
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_properties.cpp:110
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:236
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_audioFilter.cpp:104
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_props.cpp:101
+#, c-format
 msgid "Stereo"
 msgstr ""
 
@@ -48,12 +43,15 @@
 msgstr ""
 
 #: avidemux/ADM_audiofilter/audioencoder_lame.cpp:217
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_audio.cpp:370
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_properties.cpp:107
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_audioFilter.cpp:103
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_props.cpp:98
+#, c-format
 msgid "Mono"
 msgstr ""
 
 #: avidemux/ADM_audiofilter/audioencoder_lame.cpp:219
-msgid "Channel Mode"
+msgid "C_hannel mode:"
 msgstr ""
 
 #: avidemux/ADM_audiofilter/audioencoder_lame.cpp:222
@@ -69,35 +67,22 @@
 msgstr ""
 
 #: avidemux/ADM_audiofilter/audioencoder_lame.cpp:228
-#: avidemux/ADM_audiofilter/audioencoder_vorbis.cpp:273
-#: avidemux/ADM_videoFilter/ADM_vidDecDec.cpp:203
-#: avidemux/ADM_videoFilter/ADM_vidYadif.cpp:181
-msgid "Mode"
+msgid "Bit_rate mode:"
 msgstr ""
 
 #: avidemux/ADM_audiofilter/audioencoder_lame.cpp:241
-#: avidemux/ADM_audiofilter/audioencoder_vorbis.cpp:287
+#: avidemux/ADM_audiofilter/audioencoder_vorbis.cpp:288
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_audioconfig.cpp:59
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:624
-msgid "Bitrate"
+msgid "_Bitrate:"
 msgstr ""
 
 #: avidemux/ADM_audiofilter/audioencoder_lame.cpp:246
-#: avidemux/ADM_audiofilter/audioencoder_vorbis.cpp:289
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_mjpeg.cpp:82
+#: avidemux/ADM_audiofilter/audioencoder_vorbis.cpp:290
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_mjpeg.cpp:40
 #: avidemux/ADM_videoFilter/ADM_vidDecDec.cpp:204
-msgid "Quality"
+msgid "_Quality:"
 msgstr ""
 
-#: avidemux/ADM_audiofilter/audioencoder_vorbis.cpp:270
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_properties.cpp:469
-msgid "VBR"
-msgstr ""
-
-#: avidemux/ADM_audiofilter/audioencoder_vorbis.cpp:271
-msgid "Quality Based"
-msgstr ""
-
 #: avidemux/ADM_audiofilter/audiofilter_buildchain.cpp:322
 #: avidemux/gui_autodrive.cpp:82 avidemux/gui_autodrive.cpp:116
 msgid "Codec Error"
@@ -110,192 +95,30 @@
 "Either change codec or use the mixer filter to have less channels."
 msgstr ""
 
-#: avidemux/ADM_codecs/ADM_ffmp43.cpp:51
-msgid "Internal error finding codec"
+#: avidemux/ADM_audiofilter/audioencoder_vorbis.cpp:271
+msgid "VBR"
 msgstr ""
 
-#: avidemux/ADM_codecs/ADM_ffmpeg.cpp:51
-msgid "Internal error opening codec"
+#: avidemux/ADM_audiofilter/audioencoder_vorbis.cpp:272
+msgid "Quality based"
 msgstr ""
 
-#: avidemux/ADM_codecs/ADM_ffmpeg.cpp:53
-msgid "Internal error with context for  codec"
+#: avidemux/ADM_audiofilter/audioencoder_vorbis.cpp:274
+#: avidemux/ADM_videoFilter/ADM_vidMcDeint.cpp:113
+#: avidemux/ADM_videoFilter/ADM_vidDGbob.cpp:91
+#: avidemux/ADM_videoFilter/ADM_vidDecDec.cpp:203
+#: avidemux/ADM_videoFilter/ADM_vidYadif.cpp:181
+msgid "_Mode:"
 msgstr ""
 
-#: avidemux/ADM_codecs/ADM_ffmpeg.cpp:53
-msgid ""
-".\n"
-" Did you use too low / too high target for 2 pass ?"
+#: avidemux/ADM_encoder/adm_encffmpeg.cpp:261
+msgid "Incompatible settings"
 msgstr ""
 
-#: avidemux/ADM_editor/ADM_edFrameType.cpp:56
-msgid "No video loaded"
+#: avidemux/ADM_encoder/adm_encffmpeg.cpp:261
+msgid "At the moment, the DV codec only accepts 720*576 at 25"
 msgstr ""
 
-#: avidemux/ADM_editor/ADM_edFrameType.cpp:61
-msgid "Not indexable"
-msgstr ""
-
-#: avidemux/ADM_editor/ADM_edFrameType.cpp:61
-msgid "DivX 5 + packed?"
-msgstr ""
-
-#: avidemux/ADM_editor/ADM_edFrameType.cpp:119
-msgid "Aborted"
-msgstr ""
-
-#: avidemux/ADM_editor/ADM_edit.cpp:389
-msgid "File type identified but no loader support detected..."
-msgstr ""
-
-#: avidemux/ADM_editor/ADM_edit.cpp:390
-msgid "May be related to an old index file."
-msgstr ""
-
-#: avidemux/ADM_editor/ADM_edit.cpp:397
-#, c-format
-msgid "Attempt to open %s failed!"
-msgstr ""
-
-#: avidemux/ADM_editor/ADM_edit.cpp:421
-msgid ""
-"You cannot mix different video dimensions yet. Using the partial video "
-"filter later, will not work around this problem. The workaround is:\n"
-"1.) \"resize\" / \"add border\" / \"crop\" each stream to the same "
-"resolution\n"
-"2.) concatinate them together"
-msgstr ""
-
-#: avidemux/ADM_editor/ADM_edit.cpp:520
-msgid "Build Time Map"
-msgstr ""
-
-#: avidemux/ADM_editor/ADM_edit.cpp:520
-msgid "Build VBR time map?"
-msgstr ""
-
-#: avidemux/ADM_editor/ADM_edit.cpp:554
-msgid "Use that mode"
-msgstr ""
-
-#: avidemux/ADM_editor/ADM_edit.cpp:554
-msgid "H264 detected"
-msgstr ""
-
-#: avidemux/ADM_editor/ADM_edit.cpp:554
-msgid ""
-"If the file is using bframe as reference, it can lead to crash or "
-"stutteting.\n"
-"Avidemux can use another mode which is safed but <b>YOU WILL LOOSE FRAME "
-"ACCURACY</b>.\n"
-"Do you want to use that mode ?"
-msgstr ""
-
-#: avidemux/ADM_editor/ADM_edit.cpp:681
-msgid "Packed Bitstream detected"
-msgstr ""
-
-#: avidemux/ADM_editor/ADM_edit.cpp:682
-msgid "Do you want me to unpack it ?"
-msgstr ""
-
-#: avidemux/ADM_editor/ADM_edit.cpp:702
-msgid "Could not unpack the video"
-msgstr ""
-
-#: avidemux/ADM_editor/ADM_edit.cpp:702
-msgid "Using backup decoder - not frame accurate."
-msgstr ""
-
-#: avidemux/ADM_editor/ADM_edit.cpp:707
-msgid "Weird"
-msgstr ""
-
-#: avidemux/ADM_editor/ADM_edit.cpp:707
-msgid "The unpacking succeedeed but the index is still not up to date."
-msgstr ""
-
-#: avidemux/ADM_editor/ADM_edit.cpp:713
-msgid "Troubles ahead"
-msgstr ""
-
-#: avidemux/ADM_editor/ADM_edit.cpp:713
-msgid "This a VOP packed AVI."
-msgstr ""
-
-#: avidemux/ADM_editor/ADM_edit.cpp:724
-msgid "Index is not up to date"
-msgstr ""
-
-#: avidemux/ADM_editor/ADM_edit.cpp:724
-msgid "You should use Tool->Rebuild frame. Do it now ?"
-msgstr ""
-
-#: avidemux/ADM_editor/ADM_edit.cpp:1479
-msgid ""
-"This looks like mpeg\n"
-" Do you want to index it?"
-msgstr ""
-
-#: avidemux/ADM_editor/ADM_edit.cpp:1531
-msgid "Indexing failed"
-msgstr ""
-
-#: avidemux/ADM_editor/ADM_edLoadSave.cpp:75
-msgid "Unsupported"
-msgstr ""
-
-#: avidemux/ADM_editor/ADM_edLoadSave.cpp:301
-msgid "Old format project file"
-msgstr ""
-
-#: avidemux/ADM_editor/ADM_edLoadSave.cpp:301
-msgid "No more supported."
-msgstr ""
-
-#: avidemux/ADM_editor/ADM_outputfmt.h:38
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp:501
-msgid "AVI"
-msgstr ""
-
-#: avidemux/ADM_editor/ADM_outputfmt.h:39
-msgid "AVI, unp. VOP"
-msgstr ""
-
-#: avidemux/ADM_editor/ADM_outputfmt.h:40
-msgid "AVI, pack VOP"
-msgstr ""
-
-#: avidemux/ADM_editor/ADM_outputfmt.h:41
-msgid "AVI, dual audio"
-msgstr ""
-
-#: avidemux/ADM_editor/ADM_outputfmt.h:42
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp:505
-msgid "OGM"
-msgstr ""
-
-#: avidemux/ADM_editor/ADM_outputfmt.h:43
-msgid "MPEG Video"
-msgstr ""
-
-#: avidemux/ADM_editor/ADM_outputfmt.h:44
-msgid "MPEG-PS (A+V)"
-msgstr ""
-
-#: avidemux/ADM_editor/ADM_outputfmt.h:45
-msgid "MPEG-TS (A+V)"
-msgstr ""
-
-#: avidemux/ADM_editor/ADM_outputfmt.h:46
-msgid "MP4"
-msgstr ""
-
-#: avidemux/ADM_editor/ADM_outputfmt.h:47
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:756
-msgid "PSP"
-msgstr ""
-
 #: avidemux/ADM_encoder/adm_encConfig.cpp:192
 msgid "Wrong output format"
 msgstr ""
@@ -320,2012 +143,1658 @@
 msgid "Fatal error"
 msgstr ""
 
-#: avidemux/ADM_encoder/adm_encffmpeg.cpp:261
-msgid "Incompatible settings"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_bindings.cpp:437
+msgid "Input"
 msgstr ""
 
-#: avidemux/ADM_encoder/adm_encffmpeg.cpp:261
-msgid "At the moment, the DV codec only accepts 720*576 at 25"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_bindings.cpp:438
+msgid "Output"
 msgstr ""
 
-#: avidemux/ADM_filter/filter_saveload.cpp:156
-msgid "Problem reading XML filters"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_bindings.cpp:439
+msgid "Side"
 msgstr ""
 
-#: avidemux/ADM_filter/filter_saveload.cpp:164
-msgid "No filter found"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_bindings.cpp:440
+#: avidemux/ADM_videoFilter/ADM_vidMcDeint.cpp:109
+#: avidemux/ADM_videoFilter/ADM_vidKernelDeint.cpp:87
+#: avidemux/ADM_videoFilter/ADM_vidDGbob.cpp:81
+#: avidemux/ADM_videoFilter/ADM_vidDecTelecide.cpp:90
+msgid "Top"
 msgstr ""
 
-#: avidemux/ADM_filter/filter_saveload.cpp:200
-msgid "Could not find a filter"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_bindings.cpp:441
+msgid "Separate"
 msgstr ""
 
-#: avidemux/ADM_filter/filter_saveload.cpp:208
-msgid "No tag found"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_bindings.cpp:615
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/Q_gui2.cpp:499
+#, c-format
+msgid "Frame:%c(%02d)"
 msgstr ""
 
-#: avidemux/ADM_filter/filter_saveload.cpp:288
-msgid "Node not found"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:272
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_about.cpp:69
+msgid "Avidemux"
 msgstr ""
 
-#: avidemux/ADM_inputs/ADM_3gp/ADM_3gp.cpp:484
-msgid "Expect troubles"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:289
+#: avidemux/main.cpp:199
+msgid "_File"
 msgstr ""
 
-#: avidemux/ADM_inputs/ADM_3gp/ADM_3gp.cpp:971
-msgid "Problem reading SVQ3 headers"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:296
+msgid "_Open..."
 msgstr ""
 
-#: avidemux/ADM_inputs/ADM_3gp/ADM_3gp.cpp:1527
-msgid "No stts table"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:307
+msgid "_Append..."
 msgstr ""
 
-#: avidemux/ADM_inputs/ADM_h263/ADM_h263.cpp:257
-msgid "Size is not (s)QCIF"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:318
+msgid "_Save"
 msgstr ""
 
-#: avidemux/ADM_inputs/ADM_mpegdemuxer/dmx_indexer.cpp:148
-msgid "There is several mpeg file, append them ?"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:329
+msgid "Save _Video..."
 msgstr ""
 
-#: avidemux/ADM_inputs/ADM_mpegdemuxer/dmx_indexer.cpp:245
-msgid "Can't determine aspect ratio"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:341
+msgid "Save _BMP Image..."
 msgstr ""
 
-#: avidemux/ADM_inputs/ADM_mpegdemuxer/dmx_video.cpp:363
-msgid "Out of memory"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:345
+msgid "Save _JPEG Image..."
 msgstr ""
 
-#: avidemux/ADM_inputs/ADM_mpegdemuxer/dmx_video.cpp:547
-msgid "MPEG renumbering error"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:349
+msgid "Save _Selection as JPEG Images..."
 msgstr ""
 
-#: avidemux/ADM_inputs/ADM_nuv/ADM_nuv.cpp:560
-msgid "Sure you want to abort ?"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:362
+msgid "Save _Project"
 msgstr ""
 
-#: avidemux/ADM_inputs/ADM_nuv/ADM_nuv.cpp:771
-msgid "Size mismatch"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:370
+msgid "Save P_roject As..."
 msgstr ""
 
-#: avidemux/ADM_inputs/ADM_nuv/ADM_nuv.cpp:771
-msgid "Expect a crash."
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:378
+msgid "_Load/Run Project..."
 msgstr ""
 
-#: avidemux/ADM_inputs/ADM_nuv/ADM_nuv.cpp:1063
-msgid "Do you want to save an index ?"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:386
+msgid "A_dd to Joblist..."
 msgstr ""
 
-#: avidemux/ADM_inputs/ADM_ogm/ADM_ogm.cpp:355
-msgid "Take second track ?"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:390
+msgid "Show _Joblist"
 msgstr ""
 
-#: avidemux/ADM_inputs/ADM_ogm/ADM_ogm.cpp:435
-msgid "Scanning OGM"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:402
+msgid "Co_nnect to avsproxy"
 msgstr ""
 
-#: avidemux/ADM_inputs/ADM_openDML/ADM_openDML.cpp:285
-#: avidemux/ADM_inputs/ADM_openDML/ADM_openDML.cpp:370
-#: avidemux/ADM_inputs/ADM_openDML/ADM_openDML.cpp:505
-msgid "Malformed header"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:411
+msgid "Proper_ties"
 msgstr ""
 
-#: avidemux/ADM_libraries/ADM_lavformat/ADM_lavformat.cpp:308
-msgid "Incompatible frame rate"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:422
+msgid "AVI _Muxer Options"
 msgstr ""
 
-#: avidemux/ADM_libraries/ADM_lvemux/ADM_muxer.cpp:85
-#: avidemux/ADM_outputs/oplug_mpeg/op_mpegpass.cpp:153
-#: avidemux/ADM_outputs/oplug_mpegFF/oplug_vcdff.cpp:209
-msgid "Incompatible audio"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:431
+msgid "_Quit"
 msgstr ""
 
-#: avidemux/ADM_libraries/ADM_lvemux/ADM_muxer.cpp:85
-msgid "For DVD, audio must be MP2 or AC3."
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:442
+msgid "_Edit"
 msgstr ""
 
-#: avidemux/ADM_libraries/ADM_lvemux/ADM_muxer.cpp:92
-msgid "lvemux init failed"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:449
+msgid "_Reset Edits"
 msgstr ""
 
-#: avidemux/ADM_libraries/ADM_utilities/ADM_imageUtils.cpp:403
-msgid "Memory error"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:462
+msgid "Cu_t"
 msgstr ""
 
-#: avidemux/ADM_libraries/ADM_utilities/ADM_imageUtils.cpp:410
-msgid "Error converting to BMP"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:473
+msgid "_Copy"
 msgstr ""
 
-#: avidemux/ADM_libraries/ADM_utilities/ADM_imageUtils.cpp:417
-#: avidemux/gtk_gui.cpp:1925
-msgid "Something bad happened"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:484
+msgid "_Paste"
 msgstr ""
 
-#: avidemux/ADM_libraries/ADM_utilities/ADM_imageUtils.cpp:472
-msgid "Cannot encode the frame"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:495
+msgid "_Delete"
 msgstr ""
 
-#: avidemux/ADM_libraries/ADM_utilities/ADM_imageUtils.cpp:481
-#: avidemux/ADM_ocr/ADM_ocrLoadSave.h:71
-#: avidemux/ADM_outputs/oplug_mpegFF/oplug_vcdff.cpp:393
-#: avidemux/ADM_outputs/oplug_ogm/op_ogsave.cpp:112
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_toolkit_gtk/TLK_filesel.cpp:252
-#: avidemux/gtk_gui.cpp:880 avidemux/gtk_gui.cpp:1530
-msgid "File error"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:511
+msgid "Set Marker _A"
 msgstr ""
 
-#: avidemux/ADM_libraries/ADM_utilities/ADM_imageUtils.cpp:481
-#: avidemux/ADM_outputs/oplug_mpegFF/oplug_vcdff.cpp:393
-#: avidemux/ADM_outputs/oplug_ogm/op_ogsave.cpp:112 avidemux/gtk_gui.cpp:1530
-#, possible-c-format
-msgid "Cannot open \"%s\" for writing."
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:518
+msgid "Set Marker _B"
 msgstr ""
 
-#: avidemux/ADM_ocr/ADM_ocrLoadSave.h:22
-msgid "Select Glyphfile to save to"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:530
+msgid "Pre_ferences"
 msgstr ""
 
-#: avidemux/ADM_ocr/ADM_ocrLoadSave.h:30
-msgid "Could not write the file"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:538
+msgid "_View"
 msgstr ""
 
-#: avidemux/ADM_ocr/ADM_ocrLoadSave.h:62
-msgid "Erase current glyphs ?"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:545
+msgid "_Main Toolbar"
 msgstr ""
 
-#: avidemux/ADM_ocr/ADM_ocrLoadSave.h:71
-#, possible-c-format
-msgid "Could not read \"%s\"."
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:550
+msgid "_A/V Sidebar"
 msgstr ""
 
-#: avidemux/ADM_ocr/ADM_vob2vobsub.cpp:244
-msgid "Ifo error"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:560
+msgid "_Zoom 1:4"
 msgstr ""
 
-#: avidemux/ADM_ocr/ADM_vob2vobsub.cpp:244
-msgid "Error reading ifo file, aborting."
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:567
+msgid "Z_oom 1:2"
 msgstr ""
 
-#: avidemux/ADM_ocr/ADM_vob2vobsub.cpp:252
-msgid "Cannot write .idx"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:574
+msgid "Zoom _1:1"
 msgstr ""
 
-#: avidemux/ADM_ocr/ADM_vob2vobsub.cpp:265
-msgid "Cannot write .sub"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:581
+msgid "Zoom _2:1"
 msgstr ""
 
-#: avidemux/ADM_ocr/ADM_vob2vobsub.cpp:277
-msgid "Problem opening the mpeg files"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:588
+msgid "Zoom _4:1"
 msgstr ""
 
-#: avidemux/ADM_osSupport/ADM_fileio.cpp:102
-#: avidemux/ADM_osSupport/ADM_fileio.cpp:126
-#: avidemux/ADM_osSupport/ADM_fileio.cpp:146
-#: avidemux/ADM_osSupport/ADM_fileio.cpp:153
-#: avidemux/ADM_osSupport/ADM_fileio.cpp:164 avidemux/GUI_jobs.cpp:37
-msgid "Oops"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:595
+msgid "Vi_deo"
 msgstr ""
 
-#: avidemux/ADM_osSupport/ADM_fileio.cpp:102
-#, possible-c-format
-msgid "can't create custom directory (%s)."
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:602
+msgid "_Decoder Options"
 msgstr ""
 
-#: avidemux/ADM_osSupport/ADM_fileio.cpp:126
-#, possible-c-format
-msgid "can't create job directory (%s)."
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:609
+msgid "_Postprocessing"
 msgstr ""
 
-#: avidemux/ADM_osSupport/ADM_fileio.cpp:146
-msgid "can't determine $USERPROFILE."
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:612
+msgid "Select postprocessing level"
 msgstr ""
 
-#: avidemux/ADM_osSupport/ADM_fileio.cpp:153
-msgid "can't determine $HOME."
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:622
+msgid "P_review"
 msgstr ""
 
-#: avidemux/ADM_osSupport/ADM_fileio.cpp:164
-msgid "Cannot create the .avidemux directory"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:629
+msgid "Display _Output"
 msgstr ""
 
-#: avidemux/ADM_outputs/oplug_avi/op_avisave.cpp:74
-msgid "Normal"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:641
+msgid "_Frame Rate"
 msgstr ""
 
-#: avidemux/ADM_outputs/oplug_avi/op_avisave.cpp:75
-msgid "Mux every N video frames"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:645
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:694
+msgid "_Encoder"
 msgstr ""
 
-#: avidemux/ADM_outputs/oplug_avi/op_avisave.cpp:76
-msgid "Mux by packet size"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:652
+msgid "Fil_ters"
 msgstr ""
 
-#: avidemux/ADM_outputs/oplug_avi/op_avisave.cpp:79
-msgid "Muxing Type"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:659
+msgid "_Audio"
 msgstr ""
 
-#: avidemux/ADM_outputs/oplug_avi/op_avisave.cpp:80
-msgid "Split every MBytes"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:666
+msgid "_Main Track"
 msgstr ""
 
-#: avidemux/ADM_outputs/oplug_avi/op_avisave.cpp:82
-msgid "Mux Every x video frames"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:670
+msgid "_Second Track"
 msgstr ""
 
-#: avidemux/ADM_outputs/oplug_avi/op_avisave.cpp:83
-msgid "Mux with block of size"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:674
+msgid "_Build VBR Time Map"
 msgstr ""
 
-#: avidemux/ADM_outputs/oplug_avi/op_avisave.cpp:90
-msgid "Avi Muxer Option"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:683
+msgid "S_ave..."
 msgstr ""
 
-#: avidemux/ADM_outputs/oplug_avi/op_avisave.cpp:188
-msgid "Error initalizing audio filters"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:701
+msgid "_Filters"
 msgstr ""
 
-#: avidemux/ADM_outputs/oplug_avi/op_avisave.cpp:197
-msgid "Error initalizing video filters"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:705
+msgid "_Tools"
 msgstr ""
 
-#: avidemux/ADM_outputs/oplug_avi/op_avisave.cpp:446
-#: avidemux/ADM_outputs/oplug_avi/op_avisavecopy.cpp:96
-#: avidemux/ADM_outputs/oplug_avi/op_avisavecopy_pack.cpp:121
-#: avidemux/ADM_outputs/oplug_avi/op_avisavecopy_unpack.cpp:98
-msgid "Cannot initiate save"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:712
+msgid "_Calculator"
 msgstr ""
 
-#: avidemux/ADM_outputs/oplug_avi/op_saveprocess.cpp:73
-msgid ""
-"Width is not a multiple of 8\n"
-" continue anyway ?"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:728
+msgid "_Rebuild Frames (I & B)"
 msgstr ""
 
-#: avidemux/ADM_outputs/oplug_avi/op_saveprocess.cpp:93
-#: avidemux/ADM_outputs/oplug_mp4/oplug_mp4.cpp:170
-#: avidemux/ADM_outputs/oplug_ogm/op_ogsaveprocess.cpp:76
-msgid "Filter init failed"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:732
+msgid "C_heck Frames (slow)"
 msgstr ""
 
-#: avidemux/ADM_outputs/oplug_avi/op_saveprocess.cpp:127
-#: avidemux/ADM_outputs/oplug_mp4/oplug_mp4.cpp:395
-#: avidemux/ADM_outputs/oplug_ogm/op_ogsaveprocess.cpp:100
-msgid ""
-"\n"
-" Reuse the existing log-file ?"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:736
+msgid "_Bitrate Histogram"
 msgstr ""
 
-#: avidemux/ADM_outputs/oplug_avi/op_saveprocess.cpp:152
-#: avidemux/ADM_outputs/oplug_mp4/oplug_mp4.cpp:431
-msgid "Aborting"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:740
+msgid "_Scan for Black Frames..."
 msgstr ""
 
-#: avidemux/ADM_outputs/oplug_mp4/oplug_mp4.cpp:152
-msgid "Cannot initialize the video stream"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:749
+msgid "_VOB -> VobSub"
 msgstr ""
 
-#: avidemux/ADM_outputs/oplug_mp4/oplug_mp4.cpp:208
-#: avidemux/ADM_outputs/oplug_mp4/oplug_mp4.cpp:331
-#: avidemux/ADM_outputs/oplug_mp4/oplug_mp4.cpp:415
-#: avidemux/ADM_outputs/oplug_mpeg/op_mpegpass.cpp:352
-msgid "Error while encoding"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:753
+msgid "_OCR (VobSub -> srt)"
 msgstr ""
 
-#: avidemux/ADM_outputs/oplug_mp4/oplug_mp4.cpp:220
-msgid "KeyFrame error"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:757
+msgid "_Edit Glyph"
 msgstr ""
 
-#: avidemux/ADM_outputs/oplug_mp4/oplug_mp4.cpp:220
-msgid ""
-"The beginning frame is not a key frame.\n"
-"Please move the A marker."
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:766
+msgid "_Frame Hex Dump"
 msgstr ""
 
-#: avidemux/ADM_outputs/oplug_mp4/oplug_mp4.cpp:247
-msgid "Cannot initialize the audio stream"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:770
+msgid "A_uto"
 msgstr ""
 
-#: avidemux/ADM_outputs/oplug_mpeg/op_mpegpass.cpp:89
-msgid "This is not MPEG compatible"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:777
+msgid "_VCD"
 msgstr ""
 
-#: avidemux/ADM_outputs/oplug_mpeg/op_mpegpass.cpp:89
-msgid "You can't use the Copy codec."
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:781
+msgid "_SVCD"
 msgstr ""
 
-#: avidemux/ADM_outputs/oplug_mpeg/op_mpegpass.cpp:94
-#: avidemux/ADM_outputs/oplug_mpegFF/oplug_vcdff.cpp:156
-#: avidemux/ADM_outputs/oplug_mpegFF/oplug_vcdff.cpp:167
-msgid "There is no audio track"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:785
+msgid "_DVD"
 msgstr ""
 
-#: avidemux/ADM_outputs/oplug_mpeg/op_mpegpass.cpp:101
-msgid "The first frame is not intra frame"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:789
+msgid "_PSP"
 msgstr ""
 
-#: avidemux/ADM_outputs/oplug_mpeg/op_mpegpass.cpp:101
-msgid "Use the &lt;&lt; and the &gt;&gt; buttons to move using Intra frames."
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:793
+msgid "PSP (_H.264)"
 msgstr ""
 
-#: avidemux/ADM_outputs/oplug_mpeg/op_mpegpass.cpp:113
-#: avidemux/ADM_outputs/oplug_mpegFF/oplug_vcdff.cpp:177
-msgid "Audio track is not suitable"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:797
+msgid "_Go"
 msgstr ""
 
-#: avidemux/ADM_outputs/oplug_mpeg/op_mpegpass.cpp:153
-#: avidemux/ADM_outputs/oplug_mpegFF/oplug_vcdff.cpp:187
-msgid "For VCD, audio must be 44.1 kHz MP2."
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:804
+msgid "_Play/Stop"
 msgstr ""
 
-#: avidemux/ADM_outputs/oplug_mpeg/op_mpegpass.cpp:182
-msgid "For DVD, audio must be 48 kHz MP2(stereo), AC3, DTS or LPCM (stereo)."
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:815
+msgid "P_revious Frame"
 msgstr ""
 
-#: avidemux/ADM_outputs/oplug_mpegFF/oplug_vcdff.cpp:209
-msgid "For DVD, audio must be 48 kHz MP2, AC3 or LPCM."
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:826
+msgid "_Next Frame"
 msgstr ""
 
-#: avidemux/ADM_outputs/oplug_mpegFF/oplug_vcdff.cpp:326
-msgid "Reuse log file ?"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:837
+msgid "Pr_evious Intra Frame"
 msgstr ""
 
-#: avidemux/ADM_outputs/oplug_mpegFF/oplug_vcdff.cpp:341
-msgid "Error in pass 1"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:848
+msgid "Next _Intra Frame"
 msgstr ""
 
-#: avidemux/ADM_outputs/oplug_mpegFF/oplug_vcdff.cpp:491
-msgid "Error in pass 2"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:859
+msgid "Previou_s Black Frame"
 msgstr ""
 
-#: avidemux/ADM_outputs/oplug_ogm/op_ogsave.cpp:126
-msgid "Could not initialize video"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:863
+msgid "Ne_xt Black Frame"
 msgstr ""
 
-#: avidemux/ADM_outputs/oplug_ogm/op_ogsave.cpp:134
-msgid "Could not initialize audio"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:867
+msgid "_First Frame"
 msgstr ""
 
-#: avidemux/ADM_script/ADM_JSFunctions.cpp:230
-msgid "Select a directory"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:878
+msgid "_Last Frame"
 msgstr ""
 
-#: avidemux/ADM_script/ADM_JSFunctions.cpp:496
-msgid "Uinteger"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:894
+msgid "Go to Marker _A"
 msgstr ""
 
-#: avidemux/ADM_script/ADM_JSFunctions.cpp:511
-msgid "Float"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:901
+msgid "Go to Marker _B"
 msgstr ""
 
-#: avidemux/ADM_script/ADM_JSFunctions.cpp:528
-msgid "Toggle"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:913
+msgid "Go to Fra_me..."
 msgstr ""
 
-#: avidemux/ADM_script/ADM_JSFunctions.cpp:545
-#: avidemux/ADM_videoFilter/ADM_vidDecTelecide.cpp:83
-msgid "No Strategy"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:924
+msgid "Go to _Time..."
 msgstr ""
 
-#: avidemux/ADM_script/ADM_JSFunctions.cpp:546
-#: avidemux/ADM_videoFilter/ADM_vidDecTelecide.cpp:84
-msgid "3:2 Pulldown"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:935
+msgid "_Custom"
 msgstr ""
 
-#: avidemux/ADM_script/ADM_JSFunctions.cpp:547
-#: avidemux/ADM_videoFilter/ADM_vidDecTelecide.cpp:85
-msgid "Pal/Secam"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:939
+msgid "_Help"
 msgstr ""
 
-#: avidemux/ADM_script/ADM_JSFunctions.cpp:548
-#: avidemux/ADM_videoFilter/ADM_vidDecTelecide.cpp:86
-msgid "NTSC converted from PAL"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:946
+msgid "_Built-in Support"
 msgstr ""
 
-#: avidemux/ADM_script/ADM_JSFunctions.cpp:550
-msgid "menu"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:950
+msgid "_About"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_bitrateHisto.cpp:59
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_bitrateHisto.cpp:128
-msgid "No data"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:968
+msgid "Open a file"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_bitrateHisto.cpp:232
-msgid "Bitrate Histogram"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:978
+msgid "Save the file"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_builtin.cpp:95
-msgid "Option "
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:984
+msgid "Audio/video file information"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_DVDff.cpp:52
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_SVCD.cpp:42
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_resize.cpp:380
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_resize.cpp:402
-msgid "4:3"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:992
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp:401
+msgid "Calculator"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_DVDff.cpp:53
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_SVCD.cpp:43
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_resize.cpp:384
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_resize.cpp:406
-msgid "16:9"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:995
+msgid "Bitrate/size calculator"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_DVDff.cpp:55
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_SVCD.cpp:45
-msgid "Default"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1056
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_properties.cpp:318
+msgid "<b>Video</b>"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_DVDff.cpp:56
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_SVCD.cpp:46
-msgid "Tmpgenc"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1074
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1114
+msgid "Copy"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_DVDff.cpp:57
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_SVCD.cpp:47
-msgid "Anime"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1076
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1116
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_vcodec.cpp:118
+msgid "Configure"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_DVDff.cpp:58
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_SVCD.cpp:48
-msgid "KVCD"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1079
+msgid "Configure video encoder"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_DVDff.cpp:61
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_SVCD.cpp:51
-msgid "Progressive"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1084
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1140
+msgid "Filters"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_DVDff.cpp:62
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_SVCD.cpp:52
-msgid "Int. TFF"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1087
+msgid "Video filters"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_DVDff.cpp:63
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_SVCD.cpp:53
-msgid "Int. BFF"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1096
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_properties.cpp:496
+msgid "<b>Audio</b>"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_DVDff.cpp:74
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_SVCD.cpp:60
-msgid "Max Bitrate"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1119
+msgid "Configure audio encoder"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_DVDff.cpp:75
-msgid "Min Bitrate"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1127
+msgid "Audio filters"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_DVDff.cpp:76
-msgid "Use Xvid Rate Control"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1148
+msgid "Shift:"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_DVDff.cpp:78
-msgid "Buffer Size"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1151
+msgid "Enable time shift"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_DVDff.cpp:80
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_SVCD.cpp:57
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_properties.cpp:299
-msgid "Aspect Ratio"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1157
+msgid "Audio/video time shift (ms)"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_DVDff.cpp:81
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_lavcodec.cpp:73
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_SVCD.cpp:58
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvcd.cpp:265
-msgid "Matrices"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1164
+msgid "<b>Format</b>"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_DVDff.cpp:82
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_SVCD.cpp:59
-msgid "Gop Size"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1197
+msgid "<b>Selection</b>"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_DVDff.cpp:88
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_SVCD.cpp:66
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_filters/gui_filterlist.cpp:123
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_filters/gui_filtermanager_dialog.cpp:285
-msgid "Interlacing"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1214
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1222
+msgid " 0000000"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_gototime.cpp:27
-msgid "Hour"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1230
+msgid "A:"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_gototime.cpp:28
-msgid "Minutes"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1237
+msgid "Go to marker A"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_gototime.cpp:29
-msgid "Seconds"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1239
+msgid "B:"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_lavcodec.cpp:51
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_audio.cpp:257
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_audio.cpp:290
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_coloryuv.cpp:373
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_coloryuv.cpp:381
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_coloryuv.cpp:389
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp:420
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp:518
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp:526
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp:612
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_vobsub.cpp:219
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1095
-#: avidemux/ADM_videoFilter/ADM_lavpp_deint.cpp:105
-#: avidemux/ADM_videoFilter/ADM_vidDecTelecide.cpp:101
-#: avidemux/ADM_videoFilter/ADM_vidRotate.cpp:264 avidemux/gtk_gui.cpp:2003
-#: avidemux/gtk_gui.cpp:2102
-msgid "None"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1246
+msgid "Go to marker B"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_lavcodec.cpp:52
-msgid "Full"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1258
+msgid "Play"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_lavcodec.cpp:53
-msgid "Log"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1272
+msgid "Stop"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_lavcodec.cpp:54
-msgid "Phods"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1284
+msgid "Previous frame"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_lavcodec.cpp:55
-msgid "EPZS"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1299
+msgid "Next frame"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_lavcodec.cpp:56
-msgid "X1"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1314
+msgid "Previous keyframe"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_lavcodec.cpp:60
-msgid "H263"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1329
+msgid "Next keyframe"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_lavcodec.cpp:61
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp:509
-msgid "MPEG"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1343
+msgid "Selection: start"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_lavcodec.cpp:65
-msgid "MB Comparison"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1354
+msgid "Selection: end"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_lavcodec.cpp:66
-msgid "Fewest bits (vhq)"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1365
+msgid "Previous black frame"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_lavcodec.cpp:67
-msgid "Rate distortion"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1376
+msgid "Next black frame"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_lavcodec.cpp:74
-msgid "Min Qz"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1387
+msgid "First frame"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_lavcodec.cpp:75
-msgid "Max Qz"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1398
+msgid "Last frame"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_lavcodec.cpp:76
-msgid "Max QDiff"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1420
+msgid "Frame: "
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_lavcodec.cpp:78
-msgid "4MV"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1427
+msgid "Current frame"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_lavcodec.cpp:79
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:855
-msgid "Trellis"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1429
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp:661
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp:668
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp:675
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp:788
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_ocr.cpp:89
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_ocr.cpp:96
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_idx_pg.cpp:166
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_idx_pg.cpp:206
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp:632
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp:648
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp:664
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp:694
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_resize.cpp:419
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_resize.cpp:433
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_tdeint.cpp:82
+msgid "0"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_lavcodec.cpp:81
-msgid "Quarter Pel"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1432
+msgid "/ 0000000"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_lavcodec.cpp:82
-msgid "GMC"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1439
+msgid "Time: "
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_lavcodec.cpp:85
-msgid "Number of BFrames"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1446
+msgid "Current time"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_lavcodec.cpp:86
-msgid "Quantization type"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1447
+msgid "00:00:00.000"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_lavcodec.cpp:88
-msgid "Macroblock decision"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1450
+msgid "/ 00:00:00,000"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_lavcodec.cpp:90
-msgid "Filesize tolerance (kb"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1457
+msgid "Frame: ?"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_lavcodec.cpp:92
-msgid "Quantize compression"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_mpdelogo.cpp:378
+msgid "Mplayer Delogo"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_lavcodec.cpp:93
-msgid "Quantize blur"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_mpdelogo.cpp:396
+msgid "X"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_lavcodec.cpp:98
-msgid "User Interface"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_mpdelogo.cpp:403
+msgid "Y"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_lavcodec.cpp:101
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:1028
-msgid "Advanced Simple Profile"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_mpdelogo.cpp:410
+msgid "W"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_lavcodec.cpp:108
-msgid "Motion Estimation"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_mpdelogo.cpp:417
+msgid "H"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_lavcodec.cpp:112
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid.cpp:309
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:1240
-msgid "Quantization"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_mpdelogo.cpp:424
+msgid "Band"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_lavcodec.cpp:117
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1374
-msgid "Rate Control"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_crop.cpp:273
+msgid "Crop Settings"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_lavcodec.cpp:120
-msgid "Lavcodec Mpeg4 configuration"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_crop.cpp:307
+msgid "AutoCrop"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_postproc.cpp:40
-#: avidemux/ADM_videoFilter/ADM_vidForcedPP.cpp:60
-msgid "_Filter strength:"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_crop.cpp:329
+msgid "Reset"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_postproc.cpp:41
-msgid "Swap U&V"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_crop.cpp:338
+msgid "Crop Left :"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_postproc.cpp:51
-#: avidemux/ADM_videoFilter/ADM_vidForcedPP.cpp:72
-msgid "_Horizontal deblocking"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_crop.cpp:346
+msgid "Crop Top:"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_postproc.cpp:52
-#: avidemux/ADM_videoFilter/ADM_vidForcedPP.cpp:73
-msgid "_Vertical deblocking"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_crop.cpp:354
+msgid "Crop Right:"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_postproc.cpp:53
-#: avidemux/ADM_videoFilter/ADM_vidForcedPP.cpp:74
-msgid "_Deringing"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_crop.cpp:362
+msgid "Crop Bottom:"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:149
-msgid "Use systray while encoding"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_quota.cpp:90
+msgid "Filesystem full / quota exceeded"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:150
-msgid "Accept non standard audio frequency for DVD"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_quota.cpp:133
+msgid "Ignore"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:151
-msgid "Use lavcodec mpeg2 decoder"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_quota.cpp:155
+msgid "Retry"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:152
-msgid "Create openDML file"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_coloryuv.cpp:155
+msgid "ColorYuv (From avisynth)"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:153
-msgid "Automatically index mpeg files"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_coloryuv.cpp:179
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_contrast.cpp:210
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_contrast.cpp:228
+msgid "Contrast"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:154
-msgid "Automatically swap A and B if A>B"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_coloryuv.cpp:186
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_contrast.cpp:237
+msgid "Brightness"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:155
-msgid "Disable NUV audio sync"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_coloryuv.cpp:193
+msgid "Gamma"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:156
-msgid "Load external filters"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_coloryuv.cpp:200
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_audioFilter.cpp:97
+msgid "Gain"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:158
-msgid "Automatically build VBR map"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_coloryuv.cpp:207
+msgid "Luma Y"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:159
-msgid "Automatically rebuild index"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_coloryuv.cpp:214
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_contrast.cpp:255
+msgid "Chroma U"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:160
-msgid "Automatically remove packed bitstream"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_coloryuv.cpp:221
+msgid "Chroma V"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:163
-msgid "Number of threads"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_coloryuv.cpp:324
+msgid "<b>Color Correction Matrix</b>"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:164
-msgid "Split mpegs every (MB)"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_coloryuv.cpp:347
+msgid "Matrix"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:166
-msgid "Use alternative tag for mp3 in .mp4"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_coloryuv.cpp:354
+msgid "Opt"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:169
-msgid "Gtk (Slow)"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_coloryuv.cpp:361
+msgid "Level"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:171
-msgid "Xv (Best)"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_coloryuv.cpp:373
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_coloryuv.cpp:381
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_coloryuv.cpp:389
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp:553
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp:568
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp:583
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_vobsub.cpp:219
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1124
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_audioFilter.cpp:80
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_audioFilter.cpp:89
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_lavcodec.cpp:51
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_xvid4.cpp:57
+#: avidemux/ADM_videoFilter/ADM_lavpp_deint.cpp:105
+#: avidemux/ADM_videoFilter/ADM_vidRotate.cpp:264
+#: avidemux/ADM_videoFilter/ADM_vidDecTelecide.cpp:101
+#: avidemux/gtk_gui.cpp:2011 avidemux/gtk_gui.cpp:2110
+msgid "None"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:174
-msgid "SDL (Good)"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_coloryuv.cpp:374
+msgid "Rec.709"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:177
-msgid "Video Display"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_coloryuv.cpp:382
+msgid "Coring"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:182
-msgid "No alerts"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_coloryuv.cpp:390
+msgid "TV->PC"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:183
-msgid "Display only error alerts"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_coloryuv.cpp:391
+msgid "PC->TV"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:184
-msgid "Display all alerts"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_coloryuv.cpp:392
+msgid "PC->TV.Y"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:186
-msgid "Message level"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_coloryuv.cpp:398
+msgid ""
+"<b>Matrix Warning :</b>\n"
+"all above values are normalized to 256!"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:191
-msgid "PCM"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_coloryuv.cpp:404
+msgid "AutoGain"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:192
-msgid "Master"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_coloryuv.cpp:408
+msgid "Display Stats"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:193
-msgid "Volume control"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_coloryuv.cpp:412
+msgid "AutoWhite"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:198
-msgid "No downmixing"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_coloryuv.cpp:416
+msgid "<b>frame2</b>"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:200
-msgid "Prologic"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_preview.cpp:192
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_filters/gui_filtermanager.cpp:334
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_filters/gui_filtersub.cpp:150
+msgid "Preview"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:201
-msgid "Prologic II"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp:161
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp:183
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_encoding.cpp:53
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_encoding.cpp:71
+msgid "Privileges Required"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:203
-msgid "Local Playback Downmixing"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp:161
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp:183
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_encoding.cpp:53
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_encoding.cpp:71
+msgid "Root privileges are required to perform this operation."
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:232
-msgid "Audio output"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp:204
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_encoding.cpp:177
+msgid "Shutting down"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:245
-msgid "Horizontal deblocking"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp:381
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_working.cpp:150
+#, c-format
+msgid "%d%%"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:246
-msgid "Vertical deblocking"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp:404
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp:411
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp:418
+#, c-format
+msgid "%lu MB"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:247
-msgid "Deringing"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp:514
+msgid "Encoding..."
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:248
-msgid "Strength:"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp:545
+msgid "<b>Phase:</b>"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:249
-msgid "Default Postprocessing"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp:560
+msgid "<b>Video Codec:</b>"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:263
-msgid "Filter directory"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp:575
+msgid "<b>Audio Codec:</b>"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:301
-msgid "Preferences"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp:590
+msgid "<b>Container:</b>"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_resizeWiz.cpp:59
-msgid "Target type"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp:598
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp:795
+#: avidemux/ADM_libraries/ADM_utilities/avidemutils.cpp:331
+msgid "Unknown"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_resizeWiz.cpp:60
-msgid "Source aspect ratio"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp:622
+msgid "<b>Processed Frames:</b>"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_resizeWiz.cpp:61
-msgid "Dest. aspect ratio"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp:630
+msgid "<b>Total Frames:</b>"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_about.cpp:54
-msgid "translator-credits"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp:638
+msgid "<b>Quantiser:</b>"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_about.cpp:69
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:265
-msgid "Avidemux"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp:646
+msgid "<b>Average Bitrate:</b>"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_about.cpp:70
-msgid "? 2001-2006 Mean"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp:654
+msgid "0 kB/s"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_about.cpp:71
-msgid "Multiplatform video editor"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp:699
+msgid "<b>Video Size:</b>"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_about.cpp:72
-msgid ""
-"Avidemux is free software; you can redistribute it and/or modify it \n"
-"under the terms of the GNU General Public License version 2 \n"
-"as published by the Free Software Foundation.\n"
-"\n"
-"\t\t    GNU GENERAL PUBLIC LICENSE\n"
-"\t\t       Version 2, June 1991\n"
-"\n"
-" Copyright (C) 1989, 1991 Free Software Foundation, Inc.\n"
-"                       51 Franklin St, Fifth Floor, Boston, MA  02110-1301  "
-"USA\n"
-" Everyone is permitted to copy and distribute verbatim copies\n"
-" of this license document, but changing it is not allowed.\n"
-"\n"
-"\t\t\t    Preamble\n"
-"\n"
-"  The licenses for most software are designed to take away your\n"
-"freedom to share and change it.  By contrast, the GNU General Public\n"
-"License is intended to guarantee your freedom to share and change free\n"
-"software--to make sure the software is free for all its users.  This\n"
-"General Public License applies to most of the Free Software\n"
-"Foundation's software and to any other program whose authors commit to\n"
-"using it.  (Some other Free Software Foundation software is covered by\n"
-"the GNU Library General Public License instead.)  You can apply it to\n"
-"your programs, too.\n"
-"\n"
-"  When we speak of free software, we are referring to freedom, not\n"
-"price.  Our General Public Licenses are designed to make sure that you\n"
-"have the freedom to distribute copies of free software (and charge for\n"
-"this service if you wish), that you receive source code or can get it\n"
-"if you want it, that you can change the software or use pieces of it\n"
-"in new free programs; and that you know you can do these things.\n"
-"\n"
-"  To protect your rights, we need to make restrictions that forbid\n"
-"anyone to deny you these rights or to ask you to surrender the rights.\n"
-"These restrictions translate to certain responsibilities for you if you\n"
-"distribute copies of the software, or if you modify it.\n"
-"\n"
-"  For example, if you distribute copies of such a program, whether\n"
-"gratis or for a fee, you must give the recipients all the rights that\n"
-"you have.  You must make sure that they, too, receive or can get the\n"
-"source code.  And you must show them these terms so they know their\n"
-"rights.\n"
-"\n"
-"  We protect your rights with two steps: (1) copyright the software, and\n"
-"(2) offer you this license which gives you legal permission to copy,\n"
-"distribute and/or modify the software.\n"
-"\n"
-"  Also, for each author's protection and ours, we want to make certain\n"
-"that everyone understands that there is no warranty for this free\n"
-"software.  If the software is modified by someone else and passed on, we\n"
-"want its recipients to know that what they have is not the original, so\n"
-"that any problems introduced by others will not reflect on the original\n"
-"authors' reputations.\n"
-"\n"
-"  Finally, any free program is threatened constantly by software\n"
-"patents.  We wish to avoid the danger that redistributors of a free\n"
-"program will individually obtain patent licenses, in effect making the\n"
-"program proprietary.  To prevent this, we have made it clear that any\n"
-"patent must be licensed for everyone's free use or not licensed at all.\n"
-"\n"
-"  The precise terms and conditions for copying, distribution and\n"
-"modification follow.\n"
-"\n"
-"\t\t    GNU GENERAL PUBLIC LICENSE\n"
-"   TERMS AND CONDITIONS FOR COPYING, DISTRIBUTION AND MODIFICATION\n"
-"\n"
-"  0. This License applies to any program or other work which contains\n"
-"a notice placed by the copyright holder saying it may be distributed\n"
-"under the terms of this General Public License.  The \"Program\", below,\n"
-"refers to any such program or work, and a \"work based on the Program\"\n"
-"means either the Program or any derivative work under copyright law:\n"
-"that is to say, a work containing the Program or a portion of it,\n"
-"either verbatim or with modifications and/or translated into another\n"
-"language.  (Hereinafter, translation is included without limitation in\n"
-"the term \"modification\".)  Each licensee is addressed as \"you\".\n"
-"\n"
-"Activities other than copying, distribution and modification are not\n"
-"covered by this License; they are outside its scope.  The act of\n"
-"running the Program is not restricted, and the output from the Program\n"
-"is covered only if its contents constitute a work based on the\n"
-"Program (independent of having been made by running the Program).\n"
-"Whether that is true depends on what the Program does.\n"
-"\n"
-"  1. You may copy and distribute verbatim copies of the Program's\n"
-"source code as you receive it, in any medium, provided that you\n"
-"conspicuously and appropriately publish on each copy an appropriate\n"
-"copyright notice and disclaimer of warranty; keep intact all the\n"
-"notices that refer to this License and to the absence of any warranty;\n"
-"and give any other recipients of the Program a copy of this License\n"
-"along with the Program.\n"
-"\n"
-"You may charge a fee for the physical act of transferring a copy, and\n"
-"you may at your option offer warranty protection in exchange for a fee.\n"
-"\n"
-"  2. You may modify your copy or copies of the Program or any portion\n"
-"of it, thus forming a work based on the Program, and copy and\n"
-"distribute such modifications or work under the terms of Section 1\n"
-"above, provided that you also meet all of these conditions:\n"
-"\n"
-"    a) You must cause the modified files to carry prominent notices\n"
-"    stating that you changed the files and the date of any change.\n"
-"\n"
-"    b) You must cause any work that you distribute or publish, that in\n"
-"    whole or in part contains or is derived from the Program or any\n"
-"    part thereof, to be licensed as a whole at no charge to all third\n"
-"    parties under the terms of this License.\n"
-"\n"
-"    c) If the modified program normally reads commands interactively\n"
-"    when run, you must cause it, when started running for such\n"
-"    interactive use in the most ordinary way, to print or display an\n"
-"    announcement including an appropriate copyright notice and a\n"
-"    notice that there is no warranty (or else, saying that you provide\n"
-"    a warranty) and that users may redistribute the program under\n"
-"    these conditions, and telling the user how to view a copy of this\n"
-"    License.  (Exception: if the Program itself is interactive but\n"
-"    does not normally print such an announcement, your work based on\n"
-"    the Program is not required to print an announcement.)\n"
-"\n"
-"These requirements apply to the modified work as a whole.  If\n"
-"identifiable sections of that work are not derived from the Program,\n"
-"and can be reasonably considered independent and separate works in\n"
-"themselves, then this License, and its terms, do not apply to those\n"
-"sections when you distribute them as separate works.  But when you\n"
-"distribute the same sections as part of a whole which is a work based\n"
-"on the Program, the distribution of the whole must be on the terms of\n"
-"this License, whose permissions for other licensees extend to the\n"
-"entire whole, and thus to each and every part regardless of who wrote it.\n"
-"\n"
-"Thus, it is not the intent of this section to claim rights or contest\n"
-"your rights to work written entirely by you; rather, the intent is to\n"
-"exercise the right to control the distribution of derivative or\n"
-"collective works based on the Program.\n"
-"\n"
-"In addition, mere aggregation of another work not based on the Program\n"
-"with the Program (or with a work based on the Program) on a volume of\n"
-"a storage or distribution medium does not bring the other work under\n"
-"the scope of this License.\n"
-"\n"
-"  3. You may copy and distribute the Program (or a work based on it,\n"
-"under Section 2) in object code or executable form under the terms of\n"
-"Sections 1 and 2 above provided that you also do one of the following:\n"
-"\n"
-"    a) Accompany it with the complete corresponding machine-readable\n"
-"    source code, which must be distributed under the terms of Sections\n"
-"    1 and 2 above on a medium customarily used for software interchange; "
-"or,\n"
-"\n"
-"    b) Accompany it with a written offer, valid for at least three\n"
-"    years, to give any third party, for a charge no more than your\n"
-"    cost of physically performing source distribution, a complete\n"
-"    machine-readable copy of the corresponding source code, to be\n"
-"    distributed under the terms of Sections 1 and 2 above on a medium\n"
-"    customarily used for software interchange; or,\n"
-"\n"
-"    c) Accompany it with the information you received as to the offer\n"
-"    to distribute corresponding source code.  (This alternative is\n"
-"    allowed only for noncommercial distribution and only if you\n"
-"    received the program in object code or executable form with such\n"
-"    an offer, in accord with Subsection b above.)\n"
-"\n"
-"The source code for a work means the preferred form of the work for\n"
-"making modifications to it.  For an executable work, complete source\n"
-"code means all the source code for all modules it contains, plus any\n"
-"associated interface definition files, plus the scripts used to\n"
-"control compilation and installation of the executable.  However, as a\n"
-"special exception, the source code distributed need not include\n"
-"anything that is normally distributed (in either source or binary\n"
-"form) with the major components (compiler, kernel, and so on) of the\n"
-"operating system on which the executable runs, unless that component\n"
-"itself accompanies the executable.\n"
-"\n"
-"If distribution of executable or object code is made by offering\n"
-"access to copy from a designated place, then offering equivalent\n"
-"access to copy the source code from the same place counts as\n"
-"distribution of the source code, even though third parties are not\n"
-"compelled to copy the source along with the object code.\n"
-"\n"
-"  4. You may not copy, modify, sublicense, or distribute the Program\n"
-"except as expressly provided under this License.  Any attempt\n"
-"otherwise to copy, modify, sublicense or distribute the Program is\n"
-"void, and will automatically terminate your rights under this License.\n"
-"However, parties who have received copies, or rights, from you under\n"
-"this License will not have their licenses terminated so long as such\n"
-"parties remain in full compliance.\n"
-"\n"
-"  5. You are not required to accept this License, since you have not\n"
-"signed it.  However, nothing else grants you permission to modify or\n"
-"distribute the Program or its derivative works.  These actions are\n"
-"prohibited by law if you do not accept this License.  Therefore, by\n"
-"modifying or distributing the Program (or any work based on the\n"
-"Program), you indicate your acceptance of this License to do so, and\n"
-"all its terms and conditions for copying, distributing or modifying\n"
-"the Program or works based on it.\n"
-"\n"
-"  6. Each time you redistribute the Program (or any work based on the\n"
-"Program), the recipient automatically receives a license from the\n"
-"original licensor to copy, distribute or modify the Program subject to\n"
-"these terms and conditions.  You may not impose any further\n"
-"restrictions on the recipients' exercise of the rights granted herein.\n"
-"You are not responsible for enforcing compliance by third parties to\n"
-"this License.\n"
-"\n"
-"  7. If, as a consequence of a court judgment or allegation of patent\n"
-"infringement or for any other reason (not limited to patent issues),\n"
-"conditions are imposed on you (whether by court order, agreement or\n"
-"otherwise) that contradict the conditions of this License, they do not\n"
-"excuse you from the conditions of this License.  If you cannot\n"
-"distribute so as to satisfy simultaneously your obligations under this\n"
-"License and any other pertinent obligations, then as a consequence you\n"
-"may not distribute the Program at all.  For example, if a patent\n"
-"license would not permit royalty-free redistribution of the Program by\n"
-"all those who receive copies directly or indirectly through you, then\n"
-"the only way you could satisfy both it and this License would be to\n"
-"refrain entirely from distribution of the Program.\n"
-"\n"
-"If any portion of this section is held invalid or unenforceable under\n"
-"any particular circumstance, the balance of the section is intended to\n"
-"apply and the section as a whole is intended to apply in other\n"
-"circumstances.\n"
-"\n"
-"It is not the purpose of this section to induce you to infringe any\n"
-"patents or other property right claims or to contest validity of any\n"
-"such claims; this section has the sole purpose of protecting the\n"
-"integrity of the free software distribution system, which is\n"
-"implemented by public license practices.  Many people have made\n"
-"generous contributions to the wide range of software distributed\n"
-"through that system in reliance on consistent application of that\n"
-"system; it is up to the author/donor to decide if he or she is willing\n"
-"to distribute software through any other system and a licensee cannot\n"
-"impose that choice.\n"
-"\n"
-"This section is intended to make thoroughly clear what is believed to\n"
-"be a consequence of the rest of this License.\n"
-"\n"
-"  8. If the distribution and/or use of the Program is restricted in\n"
-"certain countries either by patents or by copyrighted interfaces, the\n"
-"original copyright holder who places the Program under this License\n"
-"may add an explicit geographical distribution limitation excluding\n"
-"those countries, so that distribution is permitted only in or among\n"
-"countries not thus excluded.  In such case, this License incorporates\n"
-"the limitation as if written in the body of this License.\n"
-"\n"
-"  9. The Free Software Foundation may publish revised and/or new versions\n"
-"of the General Public License from time to time.  Such new versions will\n"
-"be similar in spirit to the present version, but may differ in detail to\n"
-"address new problems or concerns.\n"
-"\n"
-"Each version is given a distinguishing version number.  If the Program\n"
-"specifies a version number of this License which applies to it and \"any\n"
-"later version\", you have the option of following the terms and conditions\n"
-"either of that version or of any later version published by the Free\n"
-"Software Foundation.  If the Program does not specify a version number of\n"
-"this License, you may choose any version ever published by the Free "
-"Software\n"
-"Foundation.\n"
-"\n"
-"  10. If you wish to incorporate parts of the Program into other free\n"
-"programs whose distribution conditions are different, write to the author\n"
-"to ask for permission.  For software which is copyrighted by the Free\n"
-"Software Foundation, write to the Free Software Foundation; we sometimes\n"
-"make exceptions for this.  Our decision will be guided by the two goals\n"
-"of preserving the free status of all derivatives of our free software and\n"
-"of promoting the sharing and reuse of software generally.\n"
-"\n"
-"\t\t\t    NO WARRANTY\n"
-"\n"
-"  11. BECAUSE THE PROGRAM IS LICENSED FREE OF CHARGE, THERE IS NO WARRANTY\n"
-"FOR THE PROGRAM, TO THE EXTENT PERMITTED BY APPLICABLE LAW.  EXCEPT WHEN\n"
-"OTHERWISE STATED IN WRITING THE COPYRIGHT HOLDERS AND/OR OTHER PARTIES\n"
-"PROVIDE THE PROGRAM \"AS IS\" WITHOUT WARRANTY OF ANY KIND, EITHER "
-"EXPRESSED\n"
-"OR IMPLIED, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF\n"
-"MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  THE ENTIRE RISK AS\n"
-"TO THE QUALITY AND PERFORMANCE OF THE PROGRAM IS WITH YOU.  SHOULD THE\n"
-"PROGRAM PROVE DEFECTIVE, YOU ASSUME THE COST OF ALL NECESSARY SERVICING,\n"
-"REPAIR OR CORRECTION.\n"
-"\n"
-"  12. IN NO EVENT UNLESS REQUIRED BY APPLICABLE LAW OR AGREED TO IN WRITING\n"
-"WILL ANY COPYRIGHT HOLDER, OR ANY OTHER PARTY WHO MAY MODIFY AND/OR\n"
-"REDISTRIBUTE THE PROGRAM AS PERMITTED ABOVE, BE LIABLE TO YOU FOR DAMAGES,\n"
-"INCLUDING ANY GENERAL, SPECIAL, INCIDENTAL OR CONSEQUENTIAL DAMAGES ARISING\n"
-"OUT OF THE USE OR INABILITY TO USE THE PROGRAM (INCLUDING BUT NOT LIMITED\n"
-"TO LOSS OF DATA OR DATA BEING RENDERED INACCURATE OR LOSSES SUSTAINED BY\n"
-"YOU OR THIRD PARTIES OR A FAILURE OF THE PROGRAM TO OPERATE WITH ANY OTHER\n"
-"PROGRAMS), EVEN IF SUCH HOLDER OR OTHER PARTY HAS BEEN ADVISED OF THE\n"
-"POSSIBILITY OF SUCH DAMAGES.\n"
-"\n"
-"\t\t     END OF TERMS AND CONDITIONS\n"
-"\n"
-"\t    How to Apply These Terms to Your New Programs\n"
-"\n"
-"  If you develop a new program, and you want it to be of the greatest\n"
-"possible use to the public, the best way to achieve this is to make it\n"
-"free software which everyone can redistribute and change under these terms.\n"
-"\n"
-"  To do so, attach the following notices to the program.  It is safest\n"
-"to attach them to the start of each source file to most effectively\n"
-"convey the exclusion of warranty; and each file should have at least\n"
-"the \"copyright\" line and a pointer to where the full notice is found.\n"
-"\n"
-"    <one line to give the program's name and a brief idea of what it does.>\n"
-"    Copyright (C) <year>  <name of author>\n"
-"\n"
-"    This program is free software; you can redistribute it and/or modify\n"
-"    it under the terms of the GNU General Public License as published by\n"
-"    the Free Software Foundation; either version 2 of the License, or\n"
-"    (at your option) any later version.\n"
-"\n"
-"    This program is distributed in the hope that it will be useful,\n"
-"    but WITHOUT ANY WARRANTY; without even the implied warranty of\n"
-"    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n"
-"    GNU General Public License for more details.\n"
-"\n"
-"    You should have received a copy of the GNU General Public License\n"
-"    along with this program; if not, write to the Free Software\n"
-"    Foundation, Inc., 51 Franklin St, Fifth Floor, Boston, MA  02110-1301  "
-"USA\n"
-"\n"
-"\n"
-"Also add information on how to contact you by electronic and paper mail.\n"
-"\n"
-"If the program is interactive, make it output a short notice like this\n"
-"when it starts in an interactive mode:\n"
-"\n"
-"    Gnomovision version 69, Copyright (C) year name of author\n"
-"    Gnomovision comes with ABSOLUTELY NO WARRANTY; for details type `show "
-"w'.\n"
-"    This is free software, and you are welcome to redistribute it\n"
-"    under certain conditions; type `show c' for details.\n"
-"\n"
-"The hypothetical commands `show w' and `show c' should show the appropriate\n"
-"parts of the General Public License.  Of course, the commands you use may\n"
-"be called something other than `show w' and `show c'; they could even be\n"
-"mouse-clicks or menu items--whatever suits your program.\n"
-"\n"
-"You should also get your employer (if you work as a programmer) or your\n"
-"school, if any, to sign a \"copyright disclaimer\" for the program, if\n"
-"necessary.  Here is a sample; alter the names:\n"
-"\n"
-"  Yoyodyne, Inc., hereby disclaims all copyright interest in the program\n"
-"  `Gnomovision' (which makes passes at compilers) written by James Hacker.\n"
-"\n"
-"  <signature of Ty Coon>, 1 April 1989\n"
-"  Ty Coon, President of Vice\n"
-"\n"
-"This General Public License does not permit incorporating your program into\n"
-"proprietary programs.  If your program is a subroutine library, you may\n"
-"consider it more useful to permit linking proprietary applications with the\n"
-"library.  If this is what you want to do, use the GNU Library General\n"
-"Public License instead of this License."
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp:707
+msgid "<b>Audio Size:</b>"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_about.cpp:74
-msgid "http://www.avidemux.org"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp:715
+msgid "<b>Total Size:</b>"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_acodec.cpp:138
-msgid "AudioCodec"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp:723
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp:731
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp:739
+msgid "0 MB"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_acodec.cpp:163
-msgid "Configure codec"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp:764
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_working.cpp:244
+msgid "<b>Elapsed:</b>"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_animated.cpp:83
-msgid "Select background picture"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp:772
+msgid "<b>Time Remaining:</b>"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_animated.cpp:169
-msgid "Animated Menu"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp:780
+msgid "<b>Frames/sec:</b>"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_animated.cpp:193
-msgid "BackGround Image :"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp:802
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_idx_pg.cpp:198
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp:447
+msgid "00:00:00"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_animated.cpp:200
-msgid "Standard"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp:826
+msgid "Shut down computer when finished"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_animated.cpp:207
-msgid "NTSC (default is PAL)"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp:834
+msgid "Priority:"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_animated.cpp:227
-msgid "Vignette Width"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp:843
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:186
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_x264.cpp:105
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_xvid4.cpp:61
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_srt.cpp:108
+msgid "High"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_animated.cpp:234
-msgid "Vignette Height"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp:844
+msgid "Above Normal"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_animated.cpp:257
-msgid "<b>General</b>"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp:845
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:188
+#: avidemux/ADM_outputs/oplug_avi/op_avisave.cpp:74
+msgid "Normal"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_animated.cpp:276
-msgid "Chapter 1"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp:846
+msgid "Below Normal"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_animated.cpp:283
-msgid "Chapter 2"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp:847
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:190
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_x264.cpp:104
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_xvid4.cpp:59
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_srt.cpp:107
+msgid "Low"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_animated.cpp:290
-msgid "Chapter 3"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp:884
+msgid "Pause / Abort"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_animated.cpp:297
-msgid "Chapter 4"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_hue.cpp:76
+msgid "Hue"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_animated.cpp:304
-msgid "Chapter 5"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_hue.cpp:186
+msgid "Hue/Saturation"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_animated.cpp:311
-msgid "Chapter 6"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_hue.cpp:200
+msgid "<b>Hue:</b>"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_animated.cpp:324
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_animated.cpp:333
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_animated.cpp:342
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_animated.cpp:351
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_animated.cpp:360
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_animated.cpp:369
-msgid "Start frame for this vignette."
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_hue.cpp:208
+msgid "<b>Saturation:</b>"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_animated.cpp:372
-msgid "<b>TimeCode</b>"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_jobs.cpp:25
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_jobs.cpp:26
+msgid "Ready"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_asharp.cpp:282
-msgid "ASharp by MarcFD"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_jobs.cpp:25
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_jobs.cpp:26
+msgid "Succeeded"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_asharp.cpp:295
-msgid "Threshold :"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_jobs.cpp:25
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_jobs.cpp:26
+#: avidemux/gtk_gui.cpp:2288
+msgid "Failed"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_asharp.cpp:303
-msgid "Strength :"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_jobs.cpp:25
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_jobs.cpp:26
+msgid "Deleted"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_asharp.cpp:311
-msgid "Block Adaptative :"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_jobs.cpp:25
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_jobs.cpp:26
+msgid "Running"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_asharp.cpp:319
-msgid "Unknown flag :"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_jobs.cpp:98
+msgid "  Job Name  "
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_asharp.cpp:351
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_ocr.cpp:208
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_ocr.cpp:271
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_properties.cpp:264
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_properties.cpp:292
-msgid " "
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_jobs.cpp:103
+msgid "Started at"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_audio.cpp:209
-msgid "Audio Processing"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_jobs.cpp:107
+msgid "Finished at"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_audio.cpp:227
-msgid "DRC"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_jobs.cpp:134
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_jobs.cpp:172
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_jobs.cpp:183
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_jobs.cpp:196
+msgid "Sure!"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_audio.cpp:235
-msgid "Timeshift"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_jobs.cpp:134
+msgid "Delete ALL jobs"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_audio.cpp:244
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1459
-msgid "<b>Misc</b>"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_jobs.cpp:134
+msgid "Are you sure you want to delete all jobs ?"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_audio.cpp:267
-msgid "Resample to hz"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_jobs.cpp:172
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_jobs.cpp:183
+msgid "Delete job"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_audio.cpp:277
-msgid "<b>Resampling</b>"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_jobs.cpp:172
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_jobs.cpp:183
+#, possible-c-format
+msgid "Are you sure you want to delete %s job ?"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_audio.cpp:296
-msgid "Film -> PAL"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_jobs.cpp:181
+msgid "Unknown event"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_audio.cpp:302
-msgid "PAL->Film"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_jobs.cpp:261
+msgid "Jobs"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_audio.cpp:308
-msgid "<b>Fps convert</b>"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_jobs.cpp:287
+msgid "Delete All Jobs"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_audio.cpp:327
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_coloryuv.cpp:200
-msgid "Gain"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_jobs.cpp:292
+msgid "Delete Job"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_audio.cpp:335
-msgid "Automatic ( max is -3dB)"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_jobs.cpp:297
+msgid "Run all jobs"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_audio.cpp:345
-msgid "Manual (db) : "
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_jobs.cpp:302
+msgid "Run Job"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_audio.cpp:357
-msgid "<b>Gain</b>"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_contrast.cpp:74
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_chromaShift.cpp:68
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_asharp.cpp:73
+msgid "ASHARP"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_audio.cpp:369
-msgid "No change"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_contrast.cpp:251
+msgid "Luma"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_audio.cpp:372
-msgid "Stereo+Surround"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_contrast.cpp:259
+msgid "Chroma v"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_audio.cpp:373
-msgid "Stereo+Center"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:109
+msgid "Select Xvid matrix file to load"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_audio.cpp:374
-msgid "Stereo+Center+Surround"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:121
+msgid "Error Loading"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_audio.cpp:375
-msgid "Stereo Front+Stero Rear"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:121
+msgid "Error loadind the custom matrix file."
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_audio.cpp:376
-msgid "5 channels"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:139
+msgid "Matrix Loaded"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_audio.cpp:377
-msgid "5.1"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:139
+msgid "The custom matrix file has been successfully loaded."
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_audio.cpp:378
-msgid "Dolby Prologic"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:179
+msgid "Size (MBytes):"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_audio.cpp:379
-msgid "Dolby Prologic 2"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:185
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:369
+msgid "Average bitrate (kb/s):"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_audio.cpp:381
-msgid "<b>Mixer</b>"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:354
+msgid "Target bitrate (kb/s):"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_busy.cpp:120
-msgid "Busy"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:362
+msgid "Target size (MBytes):"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp:403
-msgid "Bitrate Calculator"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:479
+msgid "Select Custom Matrix File to write"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp:431
-msgid "Duration:"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:484
+msgid "Error Writing"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp:437
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_idx_pg.cpp:198
-msgid "00:00:00"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:484
+msgid "Error writing the custom matrix file."
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp:451
-msgid "_Medium:"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:700
+msgid "XviD encoding options"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp:462
-msgid "_Format:"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:734
+msgid "Encoding type:"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp:473
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp:531
-msgid "Total size (custom)"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:739
+msgid "Bitrate (kb/s):"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp:483
-msgid "_Custom size (MB):"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:744
+msgid "Quantizer:"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp:497
-msgid "Output container format"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:756
+msgid "Select 1-pass or 2-pass encoding"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp:524
-msgid "Total size"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:760
+msgid "Single pass - bitrate"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp:528
-msgid "1x 80 min. CD"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:764
+msgid "Single pass - quantizer"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp:533
-msgid "2x 80 min. CD"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:768
+msgid "Two pass, final size"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp:537
-msgid "1x 74 min. CD"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:772
+msgid "Two pass, average bitrate"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp:541
-msgid "2x 74 min. CD"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:776
+msgid "Same Qz as input"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp:545
-msgid "DVD5"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:785
+msgid "Target video bitrate"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp:549
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:802
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:902
-msgid "Custom"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:792
+msgid "Constant quantizer - each frame will get the same compression"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp:555
-msgid "<b>Target</b>"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:794
+msgid "Variable bitrate mode"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp:575
-msgid "Track _1:"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:806
+msgid "_Interlaced"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp:583
-msgid "Audio bitrate in kb/s for track 1 (0 for no audio)"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:809
+msgid ""
+"Enables interlaced frame support - use only if your source contains "
+"interlacing artifacts (i.e. fields instead of progressive frames)"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp:591
-msgid "Track _2: "
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:811
+msgid "_Greyscale"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp:599
-msgid "Audio bitrate in kb/s for track 2 (optional)"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:814
+msgid "Encode in black & white"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp:603
-msgid "<b>Audio Bitrate</b>"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:820
+msgid "Ca_rtoon mode"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp:625
-msgid "Audio size (MB):"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:823
+msgid "Enables special motion estimation features for cartoons/anime"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp:633
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp:649
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp:665
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp:695
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp:534
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp:542
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp:558
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp:566
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp:574
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_idx_pg.cpp:166
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_idx_pg.cpp:206
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_ocr.cpp:148
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_ocr.cpp:156
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_resize.cpp:419
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_resize.cpp:433
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_srt.cpp:622
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1380
-msgid "0"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:825
+msgid "C_hroma optimizer"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp:641
-msgid "Video size (MB):"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:828
+msgid "Enables a chroma optimizer prefilter"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp:657
-msgid "Total size (MB):"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:834
+msgid "Turbo Mode"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp:679
-msgid "Video bitrate:"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:837
+msgid "Enables fast 1st pass encoding"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp:687
-msgid "Bits per pixel:"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:839
+msgid "Packed bitstream"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp:703
-msgid "0.0"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:842
+msgid "Enables Divx like packed vop, DO NOT SET, it is ugly"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp:711
-msgid "<b>Result</b>"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:844
+msgid "Main"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_chromaShift.cpp:264
-msgid "ChromaShift"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:863
+msgid "Motion search precision:"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_chromaShift.cpp:278
-msgid "U Shift :"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:867
+msgid "VHQ mode:"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_chromaShift.cpp:285
-msgid "V Shift :"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:880
+msgid ""
+"Higher settings give higher quality results, at the cost of slower encoding"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_chromaShift.cpp:327
-msgid "<b>Preview</b>"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:884
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid.cpp:357
+msgid "0 - None"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_cnr2.cpp:137
-msgid "Chroma Noise Reduction 2"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:888
+msgid "1 - Very low"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_cnr2.cpp:162
-msgid "<b>Scene change Treshold</b>"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:892
+msgid "2 - Low"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_cnr2.cpp:181
-msgid "Sensibility"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:896
+msgid "3 - Medium"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_cnr2.cpp:189
-msgid "Max"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:900
+msgid "4 - High"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_cnr2.cpp:204
-msgid "Luma :"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:904
+msgid "5 - Very high"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_cnr2.cpp:211
-msgid "Chroma U :"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:908
+msgid "6 - Ultra high"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_cnr2.cpp:218
-msgid "Chroma V :"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:917
+msgid "VHQ enables an additional search process to increase quality"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_cnr2.cpp:261
-msgid "Narrow"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:921
+msgid "0 - Off"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_cnr2.cpp:286
-msgid "<b>Settings</b>"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:925
+msgid "1 - Mode decision"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_cnr2.cpp:305
-msgid "Use also chroma to detect scene change"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:929
+msgid "2 - Limited search"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_cnr2.cpp:309
-msgid "<b>Mode</b>"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:933
+msgid "3 - Medium search"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_color.cpp:71
-msgid "Select Color"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:937
+msgid "4 - Wide search"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_coloryuv.cpp:155
-msgid "ColorYuv (From avisynth)"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:947
+msgid "C_hroma motion"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_coloryuv.cpp:179
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_contrast.cpp:246
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_contrast.cpp:263
-msgid "Contrast"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:950
+msgid "Use chroma information to estimate motion"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_coloryuv.cpp:186
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_contrast.cpp:276
-msgid "Brightness"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:952
+msgid "_4MV"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_coloryuv.cpp:193
-msgid "Gamma"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:955
+msgid "Use 4 motion vectors per macroblock, might give better compression"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_coloryuv.cpp:207
-msgid "Luma Y"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:957
+msgid "HQ _AC"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_coloryuv.cpp:214
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_contrast.cpp:297
-msgid "Chroma U"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:960
+msgid ""
+"Enable a better prediction of AC component. Turns on Lumi masking - applies "
+"more compression to dark/light areas that the eye cannot notice easily"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_coloryuv.cpp:221
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_contrast.cpp:301
-msgid "Chroma V"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:966
+msgid "I-frame interval - Min:"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_coloryuv.cpp:324
-msgid "<b>Color Correction Matrix</b>"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:974
+msgid "Minimum space between I-frames, 1 will disable forced I-frame spacing"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_coloryuv.cpp:347
-msgid "Matrix"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:976
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:1194
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:1199
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:1204
+msgid "Max:"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_coloryuv.cpp:354
-msgid "Opt"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:984
+msgid "Maximum number of frames allowed between I-frames"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_coloryuv.cpp:361
-msgid "Level"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:999
+msgid "Number of B-frames:"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_coloryuv.cpp:374
-msgid "Rec.709"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:1007
+msgid ""
+"Maximum number of sequential B-frames (when set to 0, the original I/P "
+"encoder is used)"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_coloryuv.cpp:382
-msgid "Coring"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:1013
+msgid "_Qpel"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_coloryuv.cpp:390
-msgid "TV->PC"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:1016
+msgid "Use Quarter pixel resolution for a more precise motion estimation"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_coloryuv.cpp:391
-msgid "PC->TV"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:1018
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_lavcodec.cpp:82
+msgid "_GMC"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_coloryuv.cpp:392
-msgid "PC->TV.Y"
-msgstr ""
-
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_coloryuv.cpp:398
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:1021
 msgid ""
-"<b>Matrix Warning :</b>\n"
-"all above values are normalized to 256!"
+"Global Motion Compensation can save bits on camera pans, zooming and rotation"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_coloryuv.cpp:404
-msgid "AutoGain"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:1023
+msgid "_BVHQ"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_coloryuv.cpp:408
-msgid "Display Stats"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:1026
+msgid "Produces nicer-looking B-frames"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_coloryuv.cpp:412
-msgid "AutoWhite"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:1028
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_lavcodec.cpp:101
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_xvid4.cpp:80
+msgid "Advanced Simple Profile"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_coloryuv.cpp:416
-msgid "<b>frame2</b>"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:1040
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:827
+msgid "As input"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_contrast.cpp:293
-msgid "Luma"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:1043
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:832
+msgid "Get PAR from input video file"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_crop.cpp:544
-msgid "Crop Settings"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:1049
+msgid "Pixel Width"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_crop.cpp:578
-msgid "AutoCrop"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:1051
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:796
+msgid ":"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_crop.cpp:600
-msgid "Reset"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:1060
+msgid "Pixel Height"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_crop.cpp:609
-msgid "Crop Left :"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:1061
+msgid "Pixel Aspect Ratio"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_crop.cpp:617
-msgid "Crop Top:"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:1066
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:965
+msgid "Motion & Misc"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_crop.cpp:625
-msgid "Crop Right:"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:1079
+msgid "Quantization type:"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_crop.cpp:633
-msgid "Crop Bottom:"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:1083
+msgid "_H.263"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp:269
-#, c-format
-msgid "Done : %02d%%"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:1086
+msgid "H.263 quantizers smooth the picture (useful at lower bitrates)"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp:377
-msgid "Encoding in Progress"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:1090
+msgid "_MPEG"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp:387
-msgid "<b><big>Encoding files</big></b>"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:1093
+msgid ""
+"MPEG quantizers (slightly slower) produce sharper picture (useful at higher "
+"bitrates)"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp:400
-msgid "<b>Phasis:</b>"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:1097
+msgid "_Custom Matrix"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp:410
-msgid "<b>Frame:</b>"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:1107
+msgid "Load Custom Matrix:  "
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp:428
-msgid "00000/00000"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:1128
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1581
+msgid "Open CQM file"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp:436
-msgid "<b>Vid codec:</b>"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:1136
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:1568
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1604
+msgid "Edit Custom Matrix"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp:447
-msgid "<b>Aud Codec:</b>"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:1153
+msgid "I-frame quantizer - Min:"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp:457
-msgid "<b>FPS:</b>"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:1158
+msgid "P-frame quantizer - Min:"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp:467
-msgid "<b>Vid Bitrate:</b>"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:1163
+msgid "B-frame quantizer - Min:"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp:477
-msgid "<b>Quantizer:</b>"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:1176
+msgid "Minimum quantizer allowed for I-frames"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp:487
-msgid "<b>Video Size:</b>"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:1182
+msgid "Minimum quantizer allowed for P-frames"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp:498
-msgid "<b>Audio Size:</b>"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:1188
+msgid "Minimum quantizer allowed for B-frames"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp:508
-msgid "<b>Total Size:</b>"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:1217
+msgid "Maximum quantizer allowed for I-frames"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp:550
-msgid "31"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:1223
+msgid "Maximum quantizer allowed for P-frames"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp:582
-msgid "<b>ETA:</b>"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:1229
+msgid "Maximum quantizer allowed for B-frames"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp:592
-msgid "0 h 0 mn 0 s"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:1231
+msgid "Quantizer restrictions"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp:602
-msgid "<b>Container:</b>"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:1235
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_lavcodec.cpp:79
+msgid "_Trellis quantization"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp:649
-msgid "Pause / Abort"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:1238
+msgid "Rate distortion quantization, will find optimal encoding for each block"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_eq2.cpp:330
-msgid "MPlayer eq2"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:1240
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid.cpp:309
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_lavcodec.cpp:112
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_xvid4.cpp:113
+msgid "Quantization"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_eq2.cpp:356
-msgid "Brigh_tness:"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:1268
+msgid "I-frame boost (%):"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_eq2.cpp:364
-msgid "_Saturation:"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:1273
+msgid "I-frames closer than ... frames..."
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_eq2.cpp:399
-msgid "_Contrast:"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:1278
+msgid "...are reduced by (%):"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_eq2.cpp:425
-msgid "_Initial:"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:1283
+msgid "Max overflow improvement (%):"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_eq2.cpp:451
-msgid "_Red:"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:1288
+msgid "Max overflow degradation (%):"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_eq2.cpp:468
-msgid "_Green:"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:1300
+#, possible-c-format
+msgid "A value of 20 will give 20% more bits to every I-frame"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_eq2.cpp:476
-msgid "_Blue:"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:1306
+msgid ""
+"I-frames appearing in the range below this value will be treated as "
+"consecutive keyframes"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_eq2.cpp:484
-msgid "_Weight:"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:1311
+msgid ""
+"Reduction of bitrate for the first consecutive I-frames. The last I-frame "
+"will get treated normally"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_eq2.cpp:510
-msgid "<b>Gamma</b>"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:1316
+msgid ""
+"How much of the overflow the codec can eat into during undersized sections - "
+"larger values will bridge the gap faster"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_equalizer.cpp:433
-msgid "Equalizer"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:1321
+msgid ""
+"How much of the overflow the codec can eat into during oversized sections - "
+"larger values will bridge the gap faster"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_exLame.cpp:80
-msgid "Lame command"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:1323
+msgid "Two pass tuning"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_exLame.cpp:89
-msgid "Enter parameters (i.e. -b 192 -m s ...)"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:1340
+msgid "High bitrate scenes (%):"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_hue.cpp:246
-msgid "Hue/Saturation"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:1345
+msgid "Low bitrate scenes (%):"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_hue.cpp:260
-msgid "<b>Hue:</b>"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:1350
+msgid "Overflow control strength (%):"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_hue.cpp:268
-msgid "<b>Saturation:</b>"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:1362
+msgid ""
+"The higher this value, the more bits get taken from frames larger than the "
+"average size, and redistributed to others"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_idx_pg.cpp:51
-msgid "Continue indexing"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:1367
+msgid ""
+"The higher this value, the more bits get assigned to frames below the "
+"average frame size"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_idx_pg.cpp:51
-msgid "Abort Requested"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:1372
+msgid ""
+"0 = default from core (let XviD decide), else overflow payback percent per "
+"frame"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_idx_pg.cpp:51
-msgid "Do you want to abort indexing ?"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:1374
+msgid "Curve compression"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_idx_pg.cpp:153
-msgid "Indexing..."
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:1378
+msgid "Second Pass"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_idx_pg.cpp:174
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_working.cpp:259
-msgid "Time left :"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:1591
+msgid "<b>Intra Matrix</b>"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_idx_pg.cpp:182
-msgid "Timecode :"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:1609
+msgid "<b>Inter Matrix</b>"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_idx_pg.cpp:190
-msgid "Nb pictures seen :"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_pipe.cpp:95
+msgid "Pipe to"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_idx_pg.cpp:214
-msgid "Indexing :"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_pipe.cpp:104
+msgid "Application path/name (/usr/bin/sox...)"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_idx_pg.cpp:222
-msgid "/dev/null"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_pipe.cpp:113
+msgid "Full parameter line"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_jobs.cpp:25
-msgid "Ready"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_ocr.cpp:57
+msgid "Mini OCR"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_jobs.cpp:25
-msgid "Succeeded"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_ocr.cpp:75
+msgid "# of Glyphs :"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_jobs.cpp:25
-#: avidemux/gtk_gui.cpp:2280
-msgid "Failed"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_ocr.cpp:82
+msgid "# of lines"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_jobs.cpp:25
-msgid "Deleted"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_ocr.cpp:103
+msgid "<b>Stats</b>"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_jobs.cpp:25
-msgid "Running"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_ocr.cpp:125
+msgid "Current Glyph"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_jobs.cpp:98
-msgid "  Job Name  "
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_ocr.cpp:138
+msgid " Text:"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_jobs.cpp:103
-msgid "Started at"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_ocr.cpp:145
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_properties.cpp:262
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_properties.cpp:283
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_asharp.cpp:268
+msgid " "
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_jobs.cpp:107
-msgid "Finished at"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_ocr.cpp:160
+msgid "Calibrate"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_jobs.cpp:134
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_jobs.cpp:172
-msgid "Sure!"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_ocr.cpp:165
+msgid "Skip all"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_jobs.cpp:134
-msgid "Delete ALL jobs"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_ocr.cpp:170
+msgid "Skip Glyph"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_jobs.cpp:134
-msgid "Are you sure you want to delete all jobs ?"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_ocr.cpp:175
+msgid "Ignore glyph"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_jobs.cpp:172
-msgid "Delete job"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_ocr.cpp:180
+msgid "Ok"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_jobs.cpp:172
-#, possible-c-format
-msgid "Are you sure you want to delete %s job ?"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_ocr.cpp:189
+msgid "<b>Bitmap</b>"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_jobs.cpp:181
-msgid "Unknown event"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_chromaShift.cpp:199
+msgid "ChromaShift"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_jobs.cpp:261
-msgid "Jobs"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_chromaShift.cpp:213
+msgid "U Shift :"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_jobs.cpp:287
-msgid "Delete All Jobs"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_chromaShift.cpp:220
+msgid "V Shift :"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_jobs.cpp:292
-msgid "Delete Job"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_chromaShift.cpp:262
+msgid "<b>Preview</b>"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_jobs.cpp:297
-msgid "Run all jobs"
-msgstr ""
-
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_jobs.cpp:302
-msgid "Run Job"
-msgstr ""
-
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_jobs_save.cpp:49
-msgid "Select video to write"
+msgid "Select Video to Write"
 msgstr ""
 
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_jobs_save.cpp:63
@@ -2333,7 +1802,7 @@
 msgstr ""
 
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_jobs_save.cpp:63
-msgid "Please select or enter a valid filename"
+msgid "Please select or enter a valid filename."
 msgstr ""
 
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_jobs_save.cpp:69
@@ -2341,340 +1810,330 @@
 msgstr ""
 
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_jobs_save.cpp:69
-msgid "Please select or enter a valid jobname"
+msgid "Please select or enter a valid jobname."
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_jobs_save.cpp:111
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_jobs_save.cpp:110
 msgid "Save Job"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_jobs_save.cpp:130
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_jobs_save.cpp:131
 msgid "Select the output file"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_jobs_save.cpp:144
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_jobs_save.cpp:145
 msgid "_Browse..."
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_jobs_save.cpp:153
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_jobs_save.cpp:154
 msgid "Job name displayed in the job list and used as the script filename"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_jobs_save.cpp:162
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_jobs_save.cpp:163
 msgid "Filename of the audio/video output"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_jobs_save.cpp:165
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_jobs_save.cpp:166
 msgid "_Job name:"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_jobs_save.cpp:172
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_jobs_save.cpp:173
 msgid "Output _file:"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_lavdecoder.cpp:79
-msgid "Libavcodec Decoder Option"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_idx_pg.cpp:51
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/T_index_pg.cpp:142
+msgid "Continue indexing"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_lavdecoder.cpp:88
-msgid "Swap UV"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_idx_pg.cpp:51
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/T_index_pg.cpp:142
+msgid "Abort Requested"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_lavdecoder.cpp:92
-msgid "Show motion Vectors"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_idx_pg.cpp:51
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/T_index_pg.cpp:142
+msgid "Do you want to abort indexing ?"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_mjpeg.cpp:73
-msgid "Mjpeg Codec settings"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_idx_pg.cpp:153
+msgid "Indexing..."
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_mjpeg.cpp:93
-msgid "Swap U & V"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_idx_pg.cpp:174
+msgid "Time left :"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_mpdelogo.cpp:356
-msgid "Mplayer Delogo"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_idx_pg.cpp:182
+msgid "Timecode :"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_mpdelogo.cpp:374
-msgid "X"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_idx_pg.cpp:190
+msgid "Nb pictures seen :"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_mpdelogo.cpp:381
-msgid "Y"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_idx_pg.cpp:214
+msgid "Indexing :"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_mpdelogo.cpp:388
-msgid "W"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_idx_pg.cpp:222
+msgid "/dev/null"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_mpdelogo.cpp:395
-msgid "H"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_exLame.cpp:80
+msgid "Lame command"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_mpdelogo.cpp:402
-msgid "Band"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_exLame.cpp:89
+msgid "Enter parameters (i.e. -b 192 -m s ...)"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_mpeg2opt.cpp:104
-msgid "Mpeg2 options"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_eq2.cpp:343
+msgid "MPlayer eq2"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_mpeg2opt.cpp:113
-msgid "Other arg"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_eq2.cpp:369
+msgid "Brigh_tness:"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_mpeg2opt.cpp:121
-msgid "Quantisation (2-31)"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_eq2.cpp:377
+msgid "_Saturation:"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_mpeg2opt.cpp:129
-msgid "Maximum bitrate (kbps)"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_eq2.cpp:412
+msgid "_Contrast:"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_ocr.cpp:85
-msgid "Mini OCR"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_eq2.cpp:438
+msgid "_Initial:"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_ocr.cpp:118
-msgid "<b>Glyphs</b>"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_eq2.cpp:464
+msgid "_Red:"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_ocr.cpp:132
-msgid "# of Glyphs :"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_eq2.cpp:481
+msgid "_Green:"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_ocr.cpp:140
-msgid "# of lines"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_eq2.cpp:489
+msgid "_Blue:"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_ocr.cpp:164
-msgid "<b>Stats</b>"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_eq2.cpp:497
+msgid "_Weight:"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_ocr.cpp:186
-msgid "  "
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_eq2.cpp:523
+msgid "<b>Gamma</b>"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_ocr.cpp:195
-msgid "VobSub"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_acodec.cpp:138
+msgid "AudioCodec"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_ocr.cpp:217
-msgid "Output Srt"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_acodec.cpp:163
+msgid "Configure codec"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_ocr.cpp:222
-msgid "<b>Files</b>"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_partial.cpp:123
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_filters/gui_filtersub.cpp:144
+msgid "Partial"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_ocr.cpp:228
-msgid "StartOcr"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_partial.cpp:137
+msgid "Start frame for partial :"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_ocr.cpp:249
-msgid "Current Glyph"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_partial.cpp:144
+msgid "End frame for partial :"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_ocr.cpp:263
-msgid " Text:"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_partial.cpp:167
+msgid "Configure partialized filter"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_ocr.cpp:287
-msgid "Calibrate"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_recent.cpp:96
+msgid "Recent files"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_ocr.cpp:292
-msgid "Skip all"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_working.cpp:223
+msgid "Processing"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_ocr.cpp:297
-msgid "Skip Glyph"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_working.cpp:259
+msgid "<b>Time remaining:</b>"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_ocr.cpp:302
-msgid "Ignore glyph"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp:414
+msgid "<b>Target</b>"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_ocr.cpp:307
-msgid "Ok"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp:441
+msgid "Duration:"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_ocr.cpp:316
-msgid "<b>Bitmap</b>"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp:461
+msgid "_Medium:"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_partial.cpp:123
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_filters/gui_filtersub.cpp:144
-msgid "Partial"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp:472
+msgid "_Format:"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_partial.cpp:137
-msgid "Start frame for partial :"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp:483
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp:541
+msgid "Total size (custom)"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_partial.cpp:144
-msgid "End frame for partial :"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp:493
+msgid "_Custom size (MB):"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_partial.cpp:167
-msgid "Configure partialized filter"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp:507
+msgid "Output container format"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_pause.cpp:93
-msgid "Paused"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp:511
+#: avidemux/ADM_editor/ADM_outputfmt.h:38
+msgid "AVI"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_pause.cpp:109
-msgid ""
-"<b>Encoding is paused.</b>\n"
-"\n"
-"You can either resume or Abort it."
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp:515
+#: avidemux/ADM_editor/ADM_outputfmt.h:46
+msgid "OGM"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_pause.cpp:136
-msgid "Abort"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp:519
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_lavcodec.cpp:61
+msgid "MPEG"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_pause.cpp:158
-msgid "Resume"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp:534
+msgid "Total size"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_pipe.cpp:95
-msgid "Pipe to"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp:538
+msgid "1x 80 min. CD"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_pipe.cpp:104
-msgid "Application path/name (/usr/bin/sox...)"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp:543
+msgid "2x 80 min. CD"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_pipe.cpp:113
-msgid "Full parameter line"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp:547
+msgid "1x 74 min. CD"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_preview.cpp:280
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_filters/gui_filtersub.cpp:150
-msgid "Preview"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp:551
+msgid "2x 74 min. CD"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_preview.cpp:316
-msgid "Stack Field"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp:555
+msgid "DVD5"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_properties.cpp:47
-#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_props.cpp:26
-msgid " No"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp:559
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:808
+msgid "Custom"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_properties.cpp:47
-#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_props.cpp:26
-msgid " Yes"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp:571
+msgid "Track _1:"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_properties.cpp:141
-#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_props.cpp:132
-#, c-format
-msgid "NONE"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp:579
+msgid "Audio bitrate in kb/s for track 1 (0 for no audio)"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_properties.cpp:207
-msgid "Informations"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp:586
+msgid "Track _2: "
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_properties.cpp:229
-msgid "Frame Rate"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp:594
+msgid "Audio bitrate in kb/s for track 2 (optional)"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_properties.cpp:236
-msgid "# of frames"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp:598
+msgid "<b>Audio Bitrate</b>"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_properties.cpp:243
-msgid "Codec 4CC"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp:624
+msgid "Audio size (MB):"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_properties.cpp:250
-msgid "Video Duration  "
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp:640
+msgid "Video size (MB):"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_properties.cpp:271
-msgid "Image size"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp:656
+msgid "Total size (MB):"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_properties.cpp:306
-msgid "-/-"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp:678
+msgid "Video bitrate:"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_properties.cpp:339
-msgid "Packed Bistream"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp:686
+msgid "Bits per pixel:"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_properties.cpp:346
-msgid "Quarter Pixel"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp:702
+msgid "0.0"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_properties.cpp:353
-msgid "GMC "
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp:710
+msgid "<b>Result</b>"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_properties.cpp:381
-msgid "<b>Extra Properties</b>"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_busy.cpp:120
+msgid "Busy"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_properties.cpp:386
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:998
-msgid "<b>Video</b>"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_cnr2.cpp:137
+msgid "Chroma Noise Reduction 2"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_properties.cpp:399
-msgid "Codec "
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_cnr2.cpp:162
+msgid "<b>Scene change Treshold</b>"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_properties.cpp:406
-msgid "Channels  "
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_cnr2.cpp:181
+msgid "Sensibility"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_properties.cpp:413
-msgid "Bitrate "
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_cnr2.cpp:189
+msgid "Max"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_properties.cpp:420
-msgid "Frequency"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_cnr2.cpp:204
+msgid "Luma :"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_properties.cpp:427
-msgid "Audio duration  "
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_cnr2.cpp:211
+msgid "Chroma U :"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_properties.cpp:482
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1038
-msgid "<b>Audio</b>"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_cnr2.cpp:218
+msgid "Chroma V :"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_quota.cpp:90
-msgid "Filesystem full / quota exceeded"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_cnr2.cpp:261
+msgid "Narrow"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_quota.cpp:133
-msgid "Ignore"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_cnr2.cpp:286
+msgid "<b>Settings</b>"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_quota.cpp:155
-msgid "Retry"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_cnr2.cpp:305
+msgid "Use also chroma to detect scene change"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_recent.cpp:96
-msgid "Recent files"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_cnr2.cpp:309
+msgid "<b>Mode</b>"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_requant.cpp:85
-msgid "Requantize Option"
-msgstr ""
-
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_requant.cpp:95
-msgid "Shrink factor"
-msgstr ""
-
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_resize.cpp:312
 msgid "Resize"
 msgstr ""
@@ -2697,9 +2156,24 @@
 
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_resize.cpp:376
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_resize.cpp:398
+#: avidemux/ADM_libraries/ADM_utilities/avidemutils.cpp:329
 msgid "1:1"
 msgstr ""
 
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_resize.cpp:380
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_resize.cpp:402
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_DVDff.cpp:52
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_SVCD.cpp:42
+msgid "4:3"
+msgstr ""
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_resize.cpp:384
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_resize.cpp:406
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_DVDff.cpp:53
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_SVCD.cpp:43
+msgid "16:9"
+msgstr ""
+
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_resize.cpp:412
 msgid " Error X:"
 msgstr ""
@@ -2724,274 +2198,605 @@
 msgid "Lanczos3"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_srt.cpp:348
-msgid "Subtitle to load"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_properties.cpp:47
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:306
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_props.cpp:26
+msgid "No"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_srt.cpp:358
-msgid "TTF font to use"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_properties.cpp:47
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:307
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_props.cpp:26
+msgid "Yes"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_srt.cpp:475
-msgid "Subtitle selector"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_properties.cpp:67
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_props.cpp:69
+#, c-format
+msgid "%lu x %lu"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_srt.cpp:488
-msgid "Subtitle file "
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_properties.cpp:70
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_props.cpp:70
+#, c-format
+msgid "%2.3f fps"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_srt.cpp:495
-msgid "Font (TTF)"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_properties.cpp:73
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_props.cpp:71
+#, c-format
+msgid "%ld frames"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_srt.cpp:502
-msgid "Encoding "
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_properties.cpp:83
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_properties.cpp:133
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_props.cpp:77
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_props.cpp:125
+#, c-format
+msgid "%02d:%02d:%02d.%03d"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_srt.cpp:509
-msgid "Font Size"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_properties.cpp:96
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_props.cpp:83
+#, c-format
+msgid "%s (%u:%u)"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_srt.cpp:522
-msgid "sub"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_properties.cpp:118
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_props.cpp:109
+#, c-format
+msgid "%lu Hz"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_srt.cpp:540
-msgid "font"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_properties.cpp:120
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_props.cpp:110
+#, c-format
+msgid "%lu Bps / %lu kbps"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_srt.cpp:560
-msgid "Ascii"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_properties.cpp:136
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_props.cpp:128
+#, c-format
+msgid "%.2f MB"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_srt.cpp:586
-msgid "Select color"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_properties.cpp:205
+msgid "Properties"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_srt.cpp:599
-msgid "Select"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_properties.cpp:234
+msgid "Frame Rate:"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_srt.cpp:603
-msgid "Auto split"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_properties.cpp:241
+msgid "Frame Count:"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_srt.cpp:609
-msgid "Delay in ms"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_properties.cpp:248
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_properties.cpp:426
+msgid "Total Duration:"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_srt.cpp:624
-msgid "Force background"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_properties.cpp:269
+msgid "Image Size:"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_tdeint.cpp:159
-msgid "TDeint param"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_properties.cpp:290
+msgid "Codec 4CC:"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_tdeint.cpp:173
-msgid "Field Order :"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_properties.cpp:304
+msgid "Aspect Ratio:"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_tdeint.cpp:185
-msgid "Bottom Field First"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_properties.cpp:337
+msgid "Global Motion Compensation:"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_tdeint.cpp:186
-#: avidemux/ADM_videoFilter/ADM_vidYadif.cpp:178
-msgid "Top Field First"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_properties.cpp:351
+msgid "Packed Bitstream:"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_tdeint.cpp:188
-msgid "Interpolate :"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_properties.cpp:365
+msgid "Quarter Pixel:"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_tdeint.cpp:200
-msgid "Top field (keep bottom)"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_properties.cpp:379
+msgid "<b>Extra Video Properties</b>"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_tdeint.cpp:201
-msgid "Bottom field (keep top)"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_properties.cpp:398
+msgid "Codec:"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_tdeint.cpp:203
-msgid "Type"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_properties.cpp:405
+msgid "Channels:"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_tdeint.cpp:215
-msgid "Cubic Interpolation"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_properties.cpp:412
+msgid "Bitrate:"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_tdeint.cpp:216
-msgid "Modified ELA"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_properties.cpp:419
+msgid "Frequency:"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_tdeint.cpp:217
-msgid "Kernerl interpolation"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_properties.cpp:468
+msgid "File Size:"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_tdeint.cpp:218
-msgid "Modified ELA-2"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_properties.cpp:482
+msgid "Variable Bitrate:"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_tdeint.cpp:220
-msgid "MntMode"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_about.cpp:54
+msgid "translator-credits"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_tdeint.cpp:232
-msgid "4 field check"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_about.cpp:70
+msgid "? 2001-2006 Mean"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_tdeint.cpp:233
-msgid "5 field check"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_about.cpp:71
+msgid "Multiplatform video editor"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_tdeint.cpp:234
-msgid "4 field check (no average)"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_about.cpp:72
+msgid ""
+"Avidemux is free software; you can redistribute it and/or modify it \n"
+"under the terms of the GNU General Public License version 2 \n"
+"as published by the Free Software Foundation.\n"
+"\n"
+"\t\t    GNU GENERAL PUBLIC LICENSE\n"
+"\t\t       Version 2, June 1991\n"
+"\n"
+" Copyright (C) 1989, 1991 Free Software Foundation, Inc.\n"
+"                       51 Franklin St, Fifth Floor, Boston, MA  02110-1301  "
+"USA\n"
+" Everyone is permitted to copy and distribute verbatim copies\n"
+" of this license document, but changing it is not allowed.\n"
+"\n"
+"\t\t\t    Preamble\n"
+"\n"
+"  The licenses for most software are designed to take away your\n"
+"freedom to share and change it.  By contrast, the GNU General Public\n"
+"License is intended to guarantee your freedom to share and change free\n"
+"software--to make sure the software is free for all its users.  This\n"
+"General Public License applies to most of the Free Software\n"
+"Foundation's software and to any other program whose authors commit to\n"
+"using it.  (Some other Free Software Foundation software is covered by\n"
+"the GNU Library General Public License instead.)  You can apply it to\n"
+"your programs, too.\n"
+"\n"
+"  When we speak of free software, we are referring to freedom, not\n"
+"price.  Our General Public Licenses are designed to make sure that you\n"
+"have the freedom to distribute copies of free software (and charge for\n"
+"this service if you wish), that you receive source code or can get it\n"
+"if you want it, that you can change the software or use pieces of it\n"
+"in new free programs; and that you know you can do these things.\n"
+"\n"
+"  To protect your rights, we need to make restrictions that forbid\n"
+"anyone to deny you these rights or to ask you to surrender the rights.\n"
+"These restrictions translate to certain responsibilities for you if you\n"
+"distribute copies of the software, or if you modify it.\n"
+"\n"
+"  For example, if you distribute copies of such a program, whether\n"
+"gratis or for a fee, you must give the recipients all the rights that\n"
+"you have.  You must make sure that they, too, receive or can get the\n"
+"source code.  And you must show them these terms so they know their\n"
+"rights.\n"
+"\n"
+"  We protect your rights with two steps: (1) copyright the software, and\n"
+"(2) offer you this license which gives you legal permission to copy,\n"
+"distribute and/or modify the software.\n"
+"\n"
+"  Also, for each author's protection and ours, we want to make certain\n"
+"that everyone understands that there is no warranty for this free\n"
+"software.  If the software is modified by someone else and passed on, we\n"
+"want its recipients to know that what they have is not the original, so\n"
+"that any problems introduced by others will not reflect on the original\n"
+"authors' reputations.\n"
+"\n"
+"  Finally, any free program is threatened constantly by software\n"
+"patents.  We wish to avoid the danger that redistributors of a free\n"
+"program will individually obtain patent licenses, in effect making the\n"
+"program proprietary.  To prevent this, we have made it clear that any\n"
+"patent must be licensed for everyone's free use or not licensed at all.\n"
+"\n"
+"  The precise terms and conditions for copying, distribution and\n"
+"modification follow.\n"
+"\n"
+"\t\t    GNU GENERAL PUBLIC LICENSE\n"
+"   TERMS AND CONDITIONS FOR COPYING, DISTRIBUTION AND MODIFICATION\n"
+"\n"
+"  0. This License applies to any program or other work which contains\n"
+"a notice placed by the copyright holder saying it may be distributed\n"
+"under the terms of this General Public License.  The \"Program\", below,\n"
+"refers to any such program or work, and a \"work based on the Program\"\n"
+"means either the Program or any derivative work under copyright law:\n"
+"that is to say, a work containing the Program or a portion of it,\n"
+"either verbatim or with modifications and/or translated into another\n"
+"language.  (Hereinafter, translation is included without limitation in\n"
+"the term \"modification\".)  Each licensee is addressed as \"you\".\n"
+"\n"
+"Activities other than copying, distribution and modification are not\n"
+"covered by this License; they are outside its scope.  The act of\n"
+"running the Program is not restricted, and the output from the Program\n"
+"is covered only if its contents constitute a work based on the\n"
+"Program (independent of having been made by running the Program).\n"
+"Whether that is true depends on what the Program does.\n"
+"\n"
+"  1. You may copy and distribute verbatim copies of the Program's\n"
+"source code as you receive it, in any medium, provided that you\n"
+"conspicuously and appropriately publish on each copy an appropriate\n"
+"copyright notice and disclaimer of warranty; keep intact all the\n"
+"notices that refer to this License and to the absence of any warranty;\n"
+"and give any other recipients of the Program a copy of this License\n"
+"along with the Program.\n"
+"\n"
+"You may charge a fee for the physical act of transferring a copy, and\n"
+"you may at your option offer warranty protection in exchange for a fee.\n"
+"\n"
+"  2. You may modify your copy or copies of the Program or any portion\n"
+"of it, thus forming a work based on the Program, and copy and\n"
+"distribute such modifications or work under the terms of Section 1\n"
+"above, provided that you also meet all of these conditions:\n"
+"\n"
+"    a) You must cause the modified files to carry prominent notices\n"
+"    stating that you changed the files and the date of any change.\n"
+"\n"
+"    b) You must cause any work that you distribute or publish, that in\n"
+"    whole or in part contains or is derived from the Program or any\n"
+"    part thereof, to be licensed as a whole at no charge to all third\n"
+"    parties under the terms of this License.\n"
+"\n"
+"    c) If the modified program normally reads commands interactively\n"
+"    when run, you must cause it, when started running for such\n"
+"    interactive use in the most ordinary way, to print or display an\n"
+"    announcement including an appropriate copyright notice and a\n"
+"    notice that there is no warranty (or else, saying that you provide\n"
+"    a warranty) and that users may redistribute the program under\n"
+"    these conditions, and telling the user how to view a copy of this\n"
+"    License.  (Exception: if the Program itself is interactive but\n"
+"    does not normally print such an announcement, your work based on\n"
+"    the Program is not required to print an announcement.)\n"
+"\n"
+"These requirements apply to the modified work as a whole.  If\n"
+"identifiable sections of that work are not derived from the Program,\n"
+"and can be reasonably considered independent and separate works in\n"
+"themselves, then this License, and its terms, do not apply to those\n"
+"sections when you distribute them as separate works.  But when you\n"
+"distribute the same sections as part of a whole which is a work based\n"
+"on the Program, the distribution of the whole must be on the terms of\n"
+"this License, whose permissions for other licensees extend to the\n"
+"entire whole, and thus to each and every part regardless of who wrote it.\n"
+"\n"
+"Thus, it is not the intent of this section to claim rights or contest\n"
+"your rights to work written entirely by you; rather, the intent is to\n"
+"exercise the right to control the distribution of derivative or\n"
+"collective works based on the Program.\n"
+"\n"
+"In addition, mere aggregation of another work not based on the Program\n"
+"with the Program (or with a work based on the Program) on a volume of\n"
+"a storage or distribution medium does not bring the other work under\n"
+"the scope of this License.\n"
+"\n"
+"  3. You may copy and distribute the Program (or a work based on it,\n"
+"under Section 2) in object code or executable form under the terms of\n"
+"Sections 1 and 2 above provided that you also do one of the following:\n"
+"\n"
+"    a) Accompany it with the complete corresponding machine-readable\n"
+"    source code, which must be distributed under the terms of Sections\n"
+"    1 and 2 above on a medium customarily used for software interchange; "
+"or,\n"
+"\n"
+"    b) Accompany it with a written offer, valid for at least three\n"
+"    years, to give any third party, for a charge no more than your\n"
+"    cost of physically performing source distribution, a complete\n"
+"    machine-readable copy of the corresponding source code, to be\n"
+"    distributed under the terms of Sections 1 and 2 above on a medium\n"
+"    customarily used for software interchange; or,\n"
+"\n"
+"    c) Accompany it with the information you received as to the offer\n"
+"    to distribute corresponding source code.  (This alternative is\n"
+"    allowed only for noncommercial distribution and only if you\n"
+"    received the program in object code or executable form with such\n"
+"    an offer, in accord with Subsection b above.)\n"
+"\n"
+"The source code for a work means the preferred form of the work for\n"
+"making modifications to it.  For an executable work, complete source\n"
+"code means all the source code for all modules it contains, plus any\n"
+"associated interface definition files, plus the scripts used to\n"
+"control compilation and installation of the executable.  However, as a\n"
+"special exception, the source code distributed need not include\n"
+"anything that is normally distributed (in either source or binary\n"
+"form) with the major components (compiler, kernel, and so on) of the\n"
+"operating system on which the executable runs, unless that component\n"
+"itself accompanies the executable.\n"
+"\n"
+"If distribution of executable or object code is made by offering\n"
+"access to copy from a designated place, then offering equivalent\n"
+"access to copy the source code from the same place counts as\n"
+"distribution of the source code, even though third parties are not\n"
+"compelled to copy the source along with the object code.\n"
+"\n"
+"  4. You may not copy, modify, sublicense, or distribute the Program\n"
+"except as expressly provided under this License.  Any attempt\n"
+"otherwise to copy, modify, sublicense or distribute the Program is\n"
+"void, and will automatically terminate your rights under this License.\n"
+"However, parties who have received copies, or rights, from you under\n"
+"this License will not have their licenses terminated so long as such\n"
+"parties remain in full compliance.\n"
+"\n"
+"  5. You are not required to accept this License, since you have not\n"
+"signed it.  However, nothing else grants you permission to modify or\n"
+"distribute the Program or its derivative works.  These actions are\n"
+"prohibited by law if you do not accept this License.  Therefore, by\n"
+"modifying or distributing the Program (or any work based on the\n"
+"Program), you indicate your acceptance of this License to do so, and\n"
+"all its terms and conditions for copying, distributing or modifying\n"
+"the Program or works based on it.\n"
+"\n"
+"  6. Each time you redistribute the Program (or any work based on the\n"
+"Program), the recipient automatically receives a license from the\n"
+"original licensor to copy, distribute or modify the Program subject to\n"
+"these terms and conditions.  You may not impose any further\n"
+"restrictions on the recipients' exercise of the rights granted herein.\n"
+"You are not responsible for enforcing compliance by third parties to\n"
+"this License.\n"
+"\n"
+"  7. If, as a consequence of a court judgment or allegation of patent\n"
+"infringement or for any other reason (not limited to patent issues),\n"
+"conditions are imposed on you (whether by court order, agreement or\n"
+"otherwise) that contradict the conditions of this License, they do not\n"
+"excuse you from the conditions of this License.  If you cannot\n"
+"distribute so as to satisfy simultaneously your obligations under this\n"
+"License and any other pertinent obligations, then as a consequence you\n"
+"may not distribute the Program at all.  For example, if a patent\n"
+"license would not permit royalty-free redistribution of the Program by\n"
+"all those who receive copies directly or indirectly through you, then\n"
+"the only way you could satisfy both it and this License would be to\n"
+"refrain entirely from distribution of the Program.\n"
+"\n"
+"If any portion of this section is held invalid or unenforceable under\n"
+"any particular circumstance, the balance of the section is intended to\n"
+"apply and the section as a whole is intended to apply in other\n"
+"circumstances.\n"
+"\n"
+"It is not the purpose of this section to induce you to infringe any\n"
+"patents or other property right claims or to contest validity of any\n"
+"such claims; this section has the sole purpose of protecting the\n"
+"integrity of the free software distribution system, which is\n"
+"implemented by public license practices.  Many people have made\n"
+"generous contributions to the wide range of software distributed\n"
+"through that system in reliance on consistent application of that\n"
+"system; it is up to the author/donor to decide if he or she is willing\n"
+"to distribute software through any other system and a licensee cannot\n"
+"impose that choice.\n"
+"\n"
+"This section is intended to make thoroughly clear what is believed to\n"
+"be a consequence of the rest of this License.\n"
+"\n"
+"  8. If the distribution and/or use of the Program is restricted in\n"
+"certain countries either by patents or by copyrighted interfaces, the\n"
+"original copyright holder who places the Program under this License\n"
+"may add an explicit geographical distribution limitation excluding\n"
+"those countries, so that distribution is permitted only in or among\n"
+"countries not thus excluded.  In such case, this License incorporates\n"
+"the limitation as if written in the body of this License.\n"
+"\n"
+"  9. The Free Software Foundation may publish revised and/or new versions\n"
+"of the General Public License from time to time.  Such new versions will\n"
+"be similar in spirit to the present version, but may differ in detail to\n"
+"address new problems or concerns.\n"
+"\n"
+"Each version is given a distinguishing version number.  If the Program\n"
+"specifies a version number of this License which applies to it and \"any\n"
+"later version\", you have the option of following the terms and conditions\n"
+"either of that version or of any later version published by the Free\n"
+"Software Foundation.  If the Program does not specify a version number of\n"
+"this License, you may choose any version ever published by the Free "
+"Software\n"
+"Foundation.\n"
+"\n"
+"  10. If you wish to incorporate parts of the Program into other free\n"
+"programs whose distribution conditions are different, write to the author\n"
+"to ask for permission.  For software which is copyrighted by the Free\n"
+"Software Foundation, write to the Free Software Foundation; we sometimes\n"
+"make exceptions for this.  Our decision will be guided by the two goals\n"
+"of preserving the free status of all derivatives of our free software and\n"
+"of promoting the sharing and reuse of software generally.\n"
+"\n"
+"\t\t\t    NO WARRANTY\n"
+"\n"
+"  11. BECAUSE THE PROGRAM IS LICENSED FREE OF CHARGE, THERE IS NO WARRANTY\n"
+"FOR THE PROGRAM, TO THE EXTENT PERMITTED BY APPLICABLE LAW.  EXCEPT WHEN\n"
+"OTHERWISE STATED IN WRITING THE COPYRIGHT HOLDERS AND/OR OTHER PARTIES\n"
+"PROVIDE THE PROGRAM \"AS IS\" WITHOUT WARRANTY OF ANY KIND, EITHER "
+"EXPRESSED\n"
+"OR IMPLIED, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF\n"
+"MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  THE ENTIRE RISK AS\n"
+"TO THE QUALITY AND PERFORMANCE OF THE PROGRAM IS WITH YOU.  SHOULD THE\n"
+"PROGRAM PROVE DEFECTIVE, YOU ASSUME THE COST OF ALL NECESSARY SERVICING,\n"
+"REPAIR OR CORRECTION.\n"
+"\n"
+"  12. IN NO EVENT UNLESS REQUIRED BY APPLICABLE LAW OR AGREED TO IN WRITING\n"
+"WILL ANY COPYRIGHT HOLDER, OR ANY OTHER PARTY WHO MAY MODIFY AND/OR\n"
+"REDISTRIBUTE THE PROGRAM AS PERMITTED ABOVE, BE LIABLE TO YOU FOR DAMAGES,\n"
+"INCLUDING ANY GENERAL, SPECIAL, INCIDENTAL OR CONSEQUENTIAL DAMAGES ARISING\n"
+"OUT OF THE USE OR INABILITY TO USE THE PROGRAM (INCLUDING BUT NOT LIMITED\n"
+"TO LOSS OF DATA OR DATA BEING RENDERED INACCURATE OR LOSSES SUSTAINED BY\n"
+"YOU OR THIRD PARTIES OR A FAILURE OF THE PROGRAM TO OPERATE WITH ANY OTHER\n"
+"PROGRAMS), EVEN IF SUCH HOLDER OR OTHER PARTY HAS BEEN ADVISED OF THE\n"
+"POSSIBILITY OF SUCH DAMAGES.\n"
+"\n"
+"\t\t     END OF TERMS AND CONDITIONS\n"
+"\n"
+"\t    How to Apply These Terms to Your New Programs\n"
+"\n"
+"  If you develop a new program, and you want it to be of the greatest\n"
+"possible use to the public, the best way to achieve this is to make it\n"
+"free software which everyone can redistribute and change under these terms.\n"
+"\n"
+"  To do so, attach the following notices to the program.  It is safest\n"
+"to attach them to the start of each source file to most effectively\n"
+"convey the exclusion of warranty; and each file should have at least\n"
+"the \"copyright\" line and a pointer to where the full notice is found.\n"
+"\n"
+"    <one line to give the program's name and a brief idea of what it does.>\n"
+"    Copyright (C) <year>  <name of author>\n"
+"\n"
+"    This program is free software; you can redistribute it and/or modify\n"
+"    it under the terms of the GNU General Public License as published by\n"
+"    the Free Software Foundation; either version 2 of the License, or\n"
+"    (at your option) any later version.\n"
+"\n"
+"    This program is distributed in the hope that it will be useful,\n"
+"    but WITHOUT ANY WARRANTY; without even the implied warranty of\n"
+"    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n"
+"    GNU General Public License for more details.\n"
+"\n"
+"    You should have received a copy of the GNU General Public License\n"
+"    along with this program; if not, write to the Free Software\n"
+"    Foundation, Inc., 51 Franklin St, Fifth Floor, Boston, MA  02110-1301  "
+"USA\n"
+"\n"
+"\n"
+"Also add information on how to contact you by electronic and paper mail.\n"
+"\n"
+"If the program is interactive, make it output a short notice like this\n"
+"when it starts in an interactive mode:\n"
+"\n"
+"    Gnomovision version 69, Copyright (C) year name of author\n"
+"    Gnomovision comes with ABSOLUTELY NO WARRANTY; for details type `show "
+"w'.\n"
+"    This is free software, and you are welcome to redistribute it\n"
+"    under certain conditions; type `show c' for details.\n"
+"\n"
+"The hypothetical commands `show w' and `show c' should show the appropriate\n"
+"parts of the General Public License.  Of course, the commands you use may\n"
+"be called something other than `show w' and `show c'; they could even be\n"
+"mouse-clicks or menu items--whatever suits your program.\n"
+"\n"
+"You should also get your employer (if you work as a programmer) or your\n"
+"school, if any, to sign a \"copyright disclaimer\" for the program, if\n"
+"necessary.  Here is a sample; alter the names:\n"
+"\n"
+"  Yoyodyne, Inc., hereby disclaims all copyright interest in the program\n"
+"  `Gnomovision' (which makes passes at compilers) written by James Hacker.\n"
+"\n"
+"  <signature of Ty Coon>, 1 April 1989\n"
+"  Ty Coon, President of Vice\n"
+"\n"
+"This General Public License does not permit incorporating your program into\n"
+"proprietary programs.  If your program is a subroutine library, you may\n"
+"consider it more useful to permit linking proprietary applications with the\n"
+"library.  If this is what you want to do, use the GNU Library General\n"
+"Public License instead of this License."
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_tdeint.cpp:235
-msgid "5 field check (no average)"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_about.cpp:74
+msgid "http://www.avidemux.org"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_tdeint.cpp:237
-msgid "Use Chroma to evalute"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid.cpp:237
+msgid "Xvid Encoder"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_tdeint.cpp:250
-msgid "Try weave "
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid.cpp:250
+msgid "Constant Quantizer"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_tdeint.cpp:263
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_filters/gui_filterlist.cpp:173
-msgid "Denoise"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid.cpp:258
+msgid "Constant Bitrate (kbps)"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_tdeint.cpp:276
-msgid "Link"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid.cpp:266
+msgid "Dual pass (MBytes)"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_tdeint.cpp:288
-msgid "No link"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid.cpp:292
+msgid "Basic"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_tdeint.cpp:289
-msgid "Full linking"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid.cpp:301
+msgid "Motion Search"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_tdeint.cpp:290
-msgid "Y to UV link"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid.cpp:317
+msgid "Max I frame interval "
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_tdeint.cpp:291
-msgid "UV to Y link"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid.cpp:333
+msgid "Min I frame interval"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_tdeint.cpp:293
-msgid "Sharp :"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid.cpp:361
+msgid "1- Very low"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_tdeint.cpp:306
-msgid "AP type"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid.cpp:365
+msgid "2- Low"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_tdeint.cpp:319
-msgid "Evaluate ALL frames"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid.cpp:369
+msgid "3- Medium"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_tdeint.cpp:331
-msgid "0 (read manual)"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid.cpp:373
+msgid "4- High"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_tdeint.cpp:332
-msgid "1 (read manual)"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid.cpp:377
+msgid "5- Very High"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_tdeint.cpp:333
-msgid "2 (read manual)"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid.cpp:381
+msgid "6- Ultra High"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_tdeint.cpp:339
-msgid "motion Threshold, Luma"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid.cpp:395
+msgid "H263 Quantizer"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_tdeint.cpp:346
-msgid "motion Threshold, Chroma"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid.cpp:400
+msgid "MPEG Quantizer"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_tdeint.cpp:369
-msgid "Area Combing Threshold"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid.cpp:407
+msgid "Advanced"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_tdeint.cpp:383
-msgid "Combed Treshold"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid.cpp:416
+msgid "Min I Frame Qzer"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_tdeint.cpp:398
-msgid "Artefact Protection threshold "
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid.cpp:424
+msgid "Max I Frame Qzer"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_v2v.cpp:56
-msgid "Select Vob file to scan"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid.cpp:432
+msgid "Min P Frame Qzer"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_v2v.cpp:67
-msgid "Select ifo file to use"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid.cpp:440
+msgid "Max P Frame Qzer"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_v2v.cpp:78
-msgid "Select vobsub to write"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid.cpp:480
+msgid "Quantizer"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_v2v.cpp:92
-msgid "Invalid vobname"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid.cpp:485
+msgid "Not Yet!"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_v2v.cpp:92
-msgid "Please select or enter a valid vob name"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid.cpp:490
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_x264.cpp:144
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_srt.cpp:147
+msgid "B Frames"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_v2v.cpp:98
-msgid "Invalid ifo"
-msgstr ""
-
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_v2v.cpp:98
-msgid "Please select or enter a valid ifo file"
-msgstr ""
-
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_v2v.cpp:104
-msgid "Invalid vobsubname"
-msgstr ""
-
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_v2v.cpp:104
-msgid "Please select or enter a valid vobsub file"
-msgstr ""
-
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_v2v.cpp:152
-msgid "Vob to Vobsub"
-msgstr ""
-
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_v2v.cpp:162
-msgid "Vob :"
-msgstr ""
-
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_v2v.cpp:169
-msgid "Ifo :"
-msgstr ""
-
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_v2v.cpp:176
-msgid "Output vobsub (.idx) :"
-msgstr ""
-
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_vcodec.cpp:104
-msgid "Video encoder"
-msgstr ""
-
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_vcodec.cpp:118
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1018
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1058
-msgid "Configure"
-msgstr ""
-
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_vobsub.cpp:98
 msgid "Select .idx file"
 msgstr ""
@@ -3024,2071 +2829,2371 @@
 msgid "Extra Settings"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_working.cpp:246
-msgid "dialog1"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_equalizer.cpp:449
+msgid "Equalizer"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_working.cpp:264
-msgid "0:0:0"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_vcodec.cpp:104
+msgid "Video encoder"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:554
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_asharp.cpp:199
+msgid "ASharp by MarcFD"
+msgstr ""
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_asharp.cpp:212
+msgid "Threshold :"
+msgstr ""
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_asharp.cpp:220
+msgid "Strength :"
+msgstr ""
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_asharp.cpp:228
+msgid "Block Adaptative :"
+msgstr ""
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_asharp.cpp:236
+msgid "Unknown flag :"
+msgstr ""
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:560
 msgid "X264 configuration"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:569
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:575
 msgid "Encoding Mode:"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:581
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:587
 msgid "Entry input for target file size or bitrate"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:583
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:589
 msgid "Quantizer (0-51):"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:596
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:602
 msgid ""
 "Constant Quantizer - Each frame will the same compression. Low numbers equal "
 "higher quality while high numbers equal lower quality"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:606
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:612
 msgid "Target Size:"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:618
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:624
 msgid "Single Pass - Quality Quantizer (Average)"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:619
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:625
 msgid "Single Pass - Quality Quantizer (Constant)"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:620
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:626
 msgid "Single Pass - Bitrate (Average)"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:621
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:627
 msgid "Two Pass - File Size"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:622
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:628
 msgid "Two Pass - Average bitrate"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:650
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:630
+msgid "Bitrate"
+msgstr ""
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:656
 msgid "Partition decision"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:657
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:663
 msgid "Method"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:669
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:675
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_x264.cpp:58
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_srt.cpp:61
 msgid "1  - Extremely Low (Fastest)"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:670
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:676
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_x264.cpp:59
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_srt.cpp:62
 msgid "2  - Very Low"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:671
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:677
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_x264.cpp:60
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_srt.cpp:63
 msgid "3  - Low"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:672
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:678
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_x264.cpp:61
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_srt.cpp:64
 msgid "4  - Medium"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:673
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:679
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_x264.cpp:62
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_srt.cpp:65
 msgid "5  - High (Default)"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:674
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:680
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_x264.cpp:63
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_srt.cpp:66
 msgid "6  - Very High"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:675
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:681
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_x264.cpp:64
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_srt.cpp:67
 msgid "6B - Very High (RDO on Bframes)"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:676
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:682
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_x264.cpp:65
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_srt.cpp:68
 msgid "7 - Ultra High"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:677
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:683
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_x264.cpp:66
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_srt.cpp:69
 msgid "7B - Ultra High (RDO on Bframes)"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:684
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:690
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_x264.cpp:72
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_srt.cpp:75
 msgid "Diamond search"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:685
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:691
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_x264.cpp:73
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_srt.cpp:76
 msgid "Hexagonal search"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:686
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:692
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_x264.cpp:74
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_srt.cpp:77
 msgid "Uneven multi hexagon"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:687
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:693
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_x264.cpp:75
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_srt.cpp:78
 msgid "Exhaustive search"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:699
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:705
 msgid ""
 "Set how many previous frames can be referenced by a P/B-frame. Numbers above "
 "5 do not seem to improve quality greatly. Numbers are 3 to 5 are recommended"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:702
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:708
 msgid "Max. Ref. frames"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:709
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:715
 msgid "Range"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:722
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:728
 msgid ""
 "Define how many pixels are analysised. The higher the range the more "
 "accurate the analysis but the slower the encoding time"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:725
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:731
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_x264.cpp:80
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_xvid4.cpp:89
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_srt.cpp:83
 msgid "Chroma ME"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:730
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:736
 msgid ""
 "Uses chroma (color) components for motion for compression and helps the "
 "quality"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:733
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:739
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_x264.cpp:81
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_srt.cpp:84
 msgid "Mixed Refs"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:738
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:744
 msgid "Calculate referencing individually based on each partition"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:744
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:750
 msgid "Fast P-Skip"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:747
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:753
 msgid "Uncheck to enable fast p-skip"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:750
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:756
 msgid "DCT decimate"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:754
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:760
 msgid "Interlace"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:757
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:763
 msgid "Encode interlaced"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:759
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:765
 msgid "<b>Motion Estimation</b>"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:786
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:798
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:792
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:804
 msgid ""
 "Enforce the size of a decoded pixel decoded to a certain value. Leave this "
 "at 1:1 for non-anamorphic video"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:787
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:799
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:793
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:805
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_tdeint.cpp:83
 msgid "1"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:790
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:1051
-msgid ":"
-msgstr ""
-
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:807
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:813
 msgid "Set a custom aspect ratio. Default 1:1 is recommended for most video."
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:812
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:818
 msgid "Predefined Aspect Ratios"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:817
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:823
 msgid "Set a common predefined aspect ratio"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:827
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:856
 msgid "<b>Sample Aspect Ratio (A/R)</b>"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:849
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:878
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_x264.cpp:108
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_srt.cpp:111
 msgid "CABAC"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:852
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:881
 msgid ""
 "Lossless compression method which usually improves the bitrate usage by 15% "
 "(especially on high bitrate). Helps the quality a lot but is slower. "
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:864
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:884
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_x264.cpp:107
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_srt.cpp:110
+msgid "Trellis"
+msgstr ""
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:893
 msgid ""
 "Use rate distortion quantization to find optimal encoding for each block. "
 "Level 0 equals disabled, level 1 equals normal and level 2 equals high"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:871
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:900
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_x264.cpp:109
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_srt.cpp:112
 msgid "Noise Reduction"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:880
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:909
 msgid "Set the amount of noise reduction"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:887
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:916
 msgid "Deblocking Filter :"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:890
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:919
 msgid "Enable in-loop deblocking to filter the video"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:903
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:932
 msgid "Set the amount of blurring to use for block edges when they are found"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:912
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:941
 msgid "Define the level for when deblocking is applied"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:915
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:944
 msgid "<i>Threshold</i>"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:923
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:952
 msgid "<i>Strength</i>"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:931
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:960
 msgid "<b>Misc. Options</b>"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:936
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:1066
-msgid "Motion & Misc"
-msgstr ""
-
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:957
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:986
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_x264.cpp:129
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_srt.cpp:132
 msgid "8x8 Transform"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:960
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:989
 msgid "General block breakdown transformation"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:963
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:992
 msgid "8x8, 8x16 and 16x8 P-frame search"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:966
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:995
 msgid "Improve the P-frame quality"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:969
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:998
 msgid "8x8, 8x16 and 16x8 B-frame search"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:972
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1001
 msgid "Improve the B-frame quality"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:975
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1004
 msgid "4x4, 4x8 and 8x4 P-frame search"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:978
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1007
 msgid "Further improve the P-frame quality"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:980
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1009
 msgid "8x8 Intra search"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:983
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1012
 msgid "Enable DCT Intra block search to improve quality"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:986
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1015
 msgid "4x4 Intra search"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:989
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1018
 msgid "Further enable DCT Intra block search to improve quality"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:992
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1021
 msgid "<b>Partition Macroblocks</b>"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1014
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1043
 msgid "Bias"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1027
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1056
 msgid ""
 "Increase / decrease probability for how often B-frames are used. Will not "
 "violate the maximum consecutive frame limit"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1036
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1065
 msgid ""
 "Set the maximum number of consecutive B-frames. This defines how many "
 "duplicate frames can be droped. Numbers 2 to 5 are recommended. This greatly "
 "improves the use of bitrate and quality"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1039
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1068
 msgid "Max Consecutive"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1050
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1079
 msgid "Bidirectional ME"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1055
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1084
 msgid ""
 "Jointly optimize both Motion Vector's in B-frames. This will improve quality "
 "but take more time for encoding"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1057
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1086
 msgid "Weighted biprediction"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1062
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1091
 msgid "Enables weighting of B-frames to help fades"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1065
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1094
 msgid "Adaptative DCT"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1070
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1099
 msgid ""
 "Use fewer B-frame if needed. This is always recommended. If not enabled, the "
 "codec will always use the maximum number of consecutive B-frames"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1073
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1102
 msgid "Use as reference"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1078
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1107
 msgid ""
 "Allow B-frames to make references non-linearly to another B-frame (instead "
 "of creating a duplicate copy)"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1084
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1113
 msgid "B-Frame Direct Mode:  "
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1092
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1121
 msgid "Auto"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1093
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1122
 msgid "Temporal"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1094
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1123
 msgid "Spatial"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1097
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1126
 msgid "<b>B-Frames</b>"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1102
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1131
 msgid "Partitions & Frames"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1130
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1159
 msgid "Set how much \"bitrate bonus\" a keyframe can get"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1133
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1162
 msgid "Keyframe boost (%)"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1140
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1169
 msgid "B-frame reduction (%)"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1147
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1176
 msgid "Bitrate variability (%)"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1160
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1189
 msgid ""
 "Set how much bitrate is deducted from a B-frame as compared to the previous "
 "P-frame"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1169
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1198
 msgid ""
 "Define how much the bitrate can fluctuate over the entire video. 0% results "
 "in a constant bitrate stream, while 100% results in a pure quality based "
 "bitrate stream"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1172
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1201
 msgid "<b>Bitrate</b>"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1190
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1219
 msgid "Min Qp"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1197
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1226
 msgid "Max Qp"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1204
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1233
 msgid "Max QP Step"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1218
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1247
 msgid "Enforce a minimum quantizer level"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1227
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1256
 msgid "Enforce a maximum quantizer level"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1236
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1265
 msgid ""
 "Define how much the quantizer rate can change between two consecutive frames"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1239
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1268
 msgid "<b>Quantization Limits</b>"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1257
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1286
 msgid "Scene Cut Threshold"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1271
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1300
 msgid ""
 "Increase / decrease sensitivity for detecting Scene Changes to compensate "
 "for. Improves I-frame usage and helps quality"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1274
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1303
 msgid "Min IDR frame interval"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1287
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1316
 msgid ""
 "Set minimum frame interval between IDR frames. Defines the minimum amount a "
 "frame can be reused and referenced by other frames before a new clean one is "
 "established"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1296
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1325
 msgid ""
 "Set maximum frame interval between IDR frames. Defines the maximum amount a "
 "frame can be reused and referenced by other frames before a new clean one is "
 "established"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1299
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1328
 msgid "Max IDR frame interval"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1306
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1335
 msgid "<b>More Rate Settings</b>"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1324
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1353
 msgid "VBV buffer size"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1331
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1360
 msgid "Initial VBV buffer (%)"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1338
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1367
 msgid "Maximum local bitrate"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1369
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1398
 msgid "<b>Video Buffer Verifier</b>"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1401
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1403
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_lavcodec.cpp:117
+msgid "Rate Control"
+msgstr ""
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1430
 msgid ""
 "Allowed variance of average bitrate. Lower values mean less variance. Higher "
 "values mean more variance."
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1404
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1433
 msgid "Bitrate Variance"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1417
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1446
 msgid ""
 "Allowed variance of average quantizer or quality. Lower values mean less "
 "variance. Higher values mean more variance. Note that 0 means constant "
 "quality while 1 means constant fluctuation. Recommended 0.6."
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1426
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1455
 msgid "Reduced fluctuations in Quantizer (before curve compression)"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1435
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1464
 msgid "Reduce fluctuations in QP (after curve compression)"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1438
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1467
 msgid "Quantizer Compression"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1445
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1474
 msgid "Temp. Blur of est Frame Complexity"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1452
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1481
 msgid "Temp. Blur of Quant after CC"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1483
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1488
+msgid "<b>Misc</b>"
+msgstr ""
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1512
 msgid "Quantization factors used between I- and P- frames"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1492
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1521
 msgid "Quantization used between P- and B- frames"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1501
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1530
 msgid "Quantization difference between chroma (color) and luma (brightness)"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1504
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1533
 msgid "Factor between I and P frame Quants"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1511
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1540
 msgid "Factor between P and B frame Quants"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1518
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1547
 msgid "Chroma QP Offset"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1525
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1554
 msgid "<b>Quantizers</b>"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1543
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1572
 msgid "Custom matrix"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1552
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:1128
-msgid "Open CQM file"
-msgstr ""
-
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1558
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1587
 msgid "JVT matrix"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1566
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1595
 msgid "Flat matrix"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1575
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:1136
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:1568
-msgid "Edit Custom Matrix"
-msgstr ""
-
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1580
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1609
 msgid "Edit a loaded custom quantization matrix file"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1588
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1617
 msgid "<b>Quantization Matrices</b>"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1593
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1622
 msgid "More"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1601
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1630
 msgid "Defaults"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvcd.cpp:186
-msgid "XVCD encoding"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_pause.cpp:93
+msgid "Paused"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvcd.cpp:195
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid.cpp:250
-msgid "Constant Quantizer"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_pause.cpp:109
+msgid ""
+"<b>Encoding is paused.</b>\n"
+"\n"
+"You can either resume or Abort it."
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvcd.cpp:209
-msgid "Constant Bitrate"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_pause.cpp:136
+msgid "Abort"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvcd.cpp:223
-msgid "Dual pass"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_pause.cpp:158
+msgid "Resume"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvcd.cpp:237
-msgid "Min bitrate (kbps) :"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_srt.cpp:92
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_srt.cpp:237
+msgid "Subtitle Size and Position"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvcd.cpp:245
-msgid "Max bitrate (kbps) :"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_srt.cpp:251
+msgid "Font Size:"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvcd.cpp:281
-msgid "Default mpeg"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_toolkit_gtk/toolkit_dialog.cpp:585
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_toolkit_gtk/toolkit_dialog.cpp:657
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_toolkit_gtk/toolkit_dialog.cpp:719
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_toolkit_gtk/toolkit_dialog.cpp:779
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_toolkit_gtk/toolkit_dialog.cpp:842
+msgid "label1"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvcd.cpp:285
-msgid "Tmpeng "
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_toolkit_gtk/toolkit_dialog.cpp:706
+msgid "Alert"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvcd.cpp:289
-msgid "Anim?"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_toolkit_gtk/TLK_filesel.cpp:121
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_toolkit_gtk/TLK_filesel.cpp:211
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_toolkit_gtk/TLK_filesel.cpp:474
+msgid "Cannot open directory as a file"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvcd.cpp:293
-msgid "K-VCD"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_toolkit_gtk/TLK_filesel.cpp:335
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:105
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:110
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:117
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:126
+#: avidemux/ADM_ocr/adm_glyph.cpp:221 avidemux/gtk_gui.cpp:894
+#: avidemux/gtk_gui.cpp:1523
+#: avidemux/ADM_outputs/oplug_mpegFF/oplug_vcdff.cpp:380
+#: avidemux/ADM_outputs/oplug_ogm/op_ogsave.cpp:112
+#: avidemux/ADM_libraries/ADM_utilities/ADM_imageUtils.cpp:481
+msgid "File error"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvcd.cpp:299
-msgid "Gop Size  (12):"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_toolkit_gtk/TLK_filesel.cpp:335
+#: avidemux/gtk_gui.cpp:891
+#, possible-c-format
+msgid "Cannot open \"%s\"."
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvcd.cpp:315
-msgid "Use Xvid ratecontrol"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_toolkit_gtk/TLK_filesel.cpp:345
+msgid "Overwrite file ?"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid.cpp:237
-msgid "Xvid Encoder"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_toolkit_gtk/TLK_filesel.cpp:370
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_toolkit_gtk/TLK_filesel.cpp:384
+msgid "It could be possible that you try to overwrite an input file!"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid.cpp:258
-msgid "Constant Bitrate (kbps)"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_toolkit_gtk/TLK_filesel.cpp:395
+msgid "Cannot write the file"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid.cpp:266
-msgid "Dual pass (MBytes)"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_toolkit_gtk/TLK_filesel.cpp:395
+#, possible-c-format
+msgid "No write access to \"%s\"."
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid.cpp:292
-msgid "Basic"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_toolkit_gtk/TLK_filesel.cpp:529
+msgid "Images"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid.cpp:301
-msgid "Motion Search"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_toolkit_gtk/TLK_filesel.cpp:541
+msgid "All"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid.cpp:317
-msgid "Max I frame interval "
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_toolkit_gtk/ADM_gladeSupport.cpp:252
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_toolkit_gtk/ADM_gladeSupport.cpp:276
+#, possible-c-format
+msgid "Couldn't find pixmap file: %s"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid.cpp:333
-msgid "Min I frame interval"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_filters/gui_filterlist.cpp:64
+msgid "Add Video Filter"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid.cpp:357
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:884
-msgid "0 - None"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_filters/gui_filterlist.cpp:98
+msgid "Transformation"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid.cpp:361
-msgid "1- Very low"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_filters/gui_filterlist.cpp:123
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_filters/gui_filtermanager_dialog.cpp:285
+msgid "Interlacing"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid.cpp:365
-msgid "2- Low"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_filters/gui_filterlist.cpp:148
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_filters/gui_filtermanager_dialog.cpp:309
+msgid "Colors"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid.cpp:369
-msgid "3- Medium"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_filters/gui_filterlist.cpp:173
+msgid "Denoise"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid.cpp:373
-msgid "4- High"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_filters/gui_filterlist.cpp:198
+msgid "Sharpen/Blur"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid.cpp:377
-msgid "5- Very High"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_filters/gui_filterlist.cpp:223
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_filters/gui_filtermanager_dialog.cpp:381
+msgid "Subtitles"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid.cpp:381
-msgid "6- Ultra High"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_filters/gui_filterlist.cpp:248
+msgid "Miscellaneous"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid.cpp:395
-msgid "H263 Quantizer"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_filters/gui_filtermanager.cpp:242
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_filters/Q_mainfilter.cpp:413
+msgid "The filter is already partial"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid.cpp:400
-msgid "MPEG Quantizer"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_filters/gui_filtermanager.cpp:340
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_filters/gui_filtermanager.cpp:342
+msgid "Load set of filters"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid.cpp:407
-msgid "Advanced"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_filters/gui_filtermanager.cpp:355
+msgid "Nothing to save"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid.cpp:416
-msgid "Min I Frame Qzer"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_filters/gui_filtermanager.cpp:359
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_filters/gui_filtermanager.cpp:361
+msgid "Save set of filters"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid.cpp:424
-msgid "Max I Frame Qzer"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_filters/gui_filtersub.cpp:52
+msgid "Video Filters"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid.cpp:432
-msgid "Min P Frame Qzer"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_filters/gui_filtersub.cpp:112
+msgid "VCD res"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid.cpp:440
-msgid "Max P Frame Qzer"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_filters/gui_filtersub.cpp:118
+msgid "SVCD res"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid.cpp:480
-msgid "Quantizer"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_filters/gui_filtersub.cpp:124
+msgid "DVD res"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid.cpp:485
-msgid "Not Yet!"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_filters/gui_filtersub.cpp:130
+msgid "Half D1 res"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid.cpp:490
-msgid "B Frames"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_filters/gui_filtersub.cpp:156
+msgid "Save as script"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:109
-msgid "Select Xvid matrix file to load"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_filters/gui_filtermanager_dialog.cpp:123
+msgid "Video Filter Manager"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:121
-msgid "Error Loading"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_filters/gui_filtermanager_dialog.cpp:145
+msgid "Open filter list [Ctrl-O]"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:121
-msgid "Error loadind the custom matrix file."
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_filters/gui_filtermanager_dialog.cpp:154
+msgid "Save filter list [Ctrl-S]"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:139
-msgid "Matrix Loaded"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_filters/gui_filtermanager_dialog.cpp:162
+msgid "Save Script"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:139
-msgid "The custom matrix file has been successfully loaded."
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_filters/gui_filtermanager_dialog.cpp:165
+msgid "Save as script [Ctrl-J]"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:479
-msgid "Select Custom Matrix File to write"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_filters/gui_filtermanager_dialog.cpp:173
+msgid "DVD Res"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:484
-msgid "Error Writing"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_filters/gui_filtermanager_dialog.cpp:176
+msgid "DVD resolution [Ctrl-1]"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:484
-msgid "Error writing the custom matrix file."
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_filters/gui_filtermanager_dialog.cpp:184
+msgid "Half D1 Res"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:700
-msgid "XviD encoding options"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_filters/gui_filtermanager_dialog.cpp:187
+msgid "Half D1 resolution [Ctrl-2]"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:734
-msgid "Encoding type:"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_filters/gui_filtermanager_dialog.cpp:195
+msgid "SVCD Res"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:739
-msgid "Bitrate (kb/s):"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_filters/gui_filtermanager_dialog.cpp:198
+msgid "SVCD resolution [Ctrl-3]"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:744
-msgid "Quantizer:"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_filters/gui_filtermanager_dialog.cpp:206
+msgid "VCD Res"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:756
-msgid "Select 1-pass or 2-pass encoding"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_filters/gui_filtermanager_dialog.cpp:209
+msgid "VCD resolution [Ctrl-4]"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:760
-msgid "Single pass - bitrate"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_filters/gui_filtermanager_dialog.cpp:260
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_x264.cpp:135
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_x264.cpp:148
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_srt.cpp:138
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_srt.cpp:151
+msgid "Transform"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:764
-msgid "Single pass - quantizer"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_filters/gui_filtermanager_dialog.cpp:333
+msgid "Noise"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:768
-msgid "Two pass, final size"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_filters/gui_filtermanager_dialog.cpp:357
+msgid "Sharpness"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:772
-msgid "Two pass, average bitrate"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_filters/gui_filtermanager_dialog.cpp:405
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_x264.cpp:117
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_srt.cpp:120
+msgid "Misc"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:776
-msgid "Same Qz as input"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_filters/gui_filtermanager_dialog.cpp:416
+msgid "External"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:785
-msgid "Target video bitrate"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_filters/gui_filtermanager_dialog.cpp:427
+msgid "Add selected filter to the Active Filters list"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:792
-msgid "Constant quantizer - each frame will get the same compression"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_filters/gui_filtermanager_dialog.cpp:433
+msgid "<b>Available Filters</b>"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:794
-msgid "Variable bitrate mode"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_filters/gui_filtermanager_dialog.cpp:478
+msgid "Remove filter"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:806
-msgid "_Interlaced"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_filters/gui_filtermanager_dialog.cpp:487
+msgid "Move filter down"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:809
-msgid ""
-"Enables interlaced frame support - use only if your source contains "
-"interlacing artifacts (i.e. fields instead of progressive frames)"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_filters/gui_filtermanager_dialog.cpp:496
+msgid "Move filter up"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:811
-msgid "_Greyscale"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_filters/gui_filtermanager_dialog.cpp:502
+msgid "P_artial"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:814
-msgid "Encode in black & white"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_filters/gui_filtermanager_dialog.cpp:505
+msgid "Apply the current filter only to a part of the file"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:820
-msgid "Ca_rtoon mode"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_filters/gui_filtermanager_dialog.cpp:510
+msgid "Configure filter"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:823
-msgid "Enables special motion estimation features for cartoons/anime"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_filters/gui_filtermanager_dialog.cpp:520
+msgid "C_onfigure"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:825
-msgid "C_hroma optimizer"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_filters/gui_filtermanager_dialog.cpp:524
+msgid "<b >Active Filters</b>"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:828
-msgid "Enables a chroma optimizer prefilter"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_filters/gui_filtermanager_dialog.cpp:551
+msgid "_Preview"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:834
-msgid "Turbo Mode"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialogFactory/DIA_color.cpp:71
+msgid "Select Color"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:837
-msgid "Enables fast 1st pass encoding"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialogFactory/FAC_bitrate.cpp:73
+msgid "_Encoding mode:"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:839
-msgid "Packed bitstream"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialogFactory/FAC_hex.cpp:100
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialogFactory/FAC_hex.cpp:134
+msgid "_Previous"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:842
-msgid "Enables Divx like packed vop, DO NOT SET, it is ugly"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialogFactory/FAC_hex.cpp:108
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialogFactory/FAC_hex.cpp:164
+msgid "_Next"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:844
-msgid "Main"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_ocr/adm_ocr.cpp:180
+msgid "Output file error"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:863
-msgid "Motion search precision:"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_ocr/adm_ocr.cpp:180
+#, possible-c-format
+msgid "Could not open \"%s\" for writing."
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:867
-msgid "VHQ mode:"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_ocr/adm_ocr.cpp:189
+msgid "Problem loading sub"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:880
-msgid ""
-"Higher settings give higher quality results, at the cost of slower encoding"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_ocr/adm_ocr.cpp:295
+msgid "Select Glyphfile to save to"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:888
-msgid "1 - Very low"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_ocr/adm_ocr.cpp:362
+msgid "Sure ?"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:892
-msgid "2 - Low"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_ocr/adm_editglyph.cpp:53
+msgid "Select GlyphFile to edit"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:896
-msgid "3 - Medium"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_ocr/adm_editglyph.cpp:121
+msgid "String"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:900
-msgid "4 - High"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_ocr/adm_editglyph.cpp:123
+msgid "Search string"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:904
-msgid "5 - Very high"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_ocr/adm_editglyph.cpp:149
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_ocr/adm_editglyph.cpp:192
+msgid "End reached"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:908
-msgid "6 - Ultra high"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_ocr/adm_editglyph.cpp:149
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_ocr/adm_editglyph.cpp:192
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_ocr/adm_editglyph.cpp:216
+msgid "No more glyphs"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:917
-msgid "VHQ enables an additional search process to increase quality"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_ocr/adm_editglyph.cpp:216
+msgid "Head reached"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:921
-msgid "0 - Off"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_ocr/adm_editglyph.cpp:344
+msgid "dialog1"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:925
-msgid "1 - Mode decision"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_ocr/adm_editglyph.cpp:396
+msgid "Prev. Empty"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:929
-msgid "2 - Limited search"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_ocr/adm_editglyph.cpp:418
+msgid "Next Empty"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:933
-msgid "3 - Medium search"
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_tdeint.cpp:45
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_tdeint.cpp:51
+msgid "Auto (might not work)"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:937
-msgid "4 - Wide search"
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_tdeint.cpp:46
+#: avidemux/ADM_videoFilter/ADM_vidYadif.cpp:178
+msgid "Top field first"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:947
-msgid "C_hroma motion"
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_tdeint.cpp:47
+#: avidemux/ADM_videoFilter/ADM_vidYadif.cpp:177
+msgid "Bottom field first"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:950
-msgid "Use chroma information to estimate motion"
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_tdeint.cpp:52
+msgid "Bottom field (keep top)"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:952
-msgid "_4MV"
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_tdeint.cpp:53
+msgid "Top field (keep bottom)"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:955
-msgid "Use 4 motion vectors per macroblock, might give better compression"
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_tdeint.cpp:58
+msgid "Cubic interpolation"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:957
-msgid "HQ _AC"
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_tdeint.cpp:59
+msgid "Modified ELA"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:960
-msgid ""
-"Enable a better prediction of AC component. Turns on Lumi masking - applies "
-"more compression to dark/light areas that the eye cannot notice easily"
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_tdeint.cpp:60
+msgid "Kernel interpolation"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:966
-msgid "I-frame interval - Min:"
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_tdeint.cpp:61
+msgid "Modified ELA-2"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:974
-msgid "Minimum space between I-frames, 1 will disable forced I-frame spacing"
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_tdeint.cpp:66
+msgid "4 fields check"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:976
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:1194
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:1199
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:1204
-msgid "Max:"
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_tdeint.cpp:67
+msgid "5 fields check"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:984
-msgid "Maximum number of frames allowed between I-frames"
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_tdeint.cpp:68
+msgid "4 fields check (no avg)"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:999
-msgid "Number of B-frames:"
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_tdeint.cpp:69
+msgid "5 fields check (no avg)"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:1007
-msgid ""
-"Maximum number of sequential B-frames (when set to 0, the original I/P "
-"encoder is used)"
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_tdeint.cpp:75
+msgid "No link"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:1013
-msgid "_Qpel"
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_tdeint.cpp:76
+msgid "Full link"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:1016
-msgid "Use Quarter pixel resolution for a more precise motion estimation"
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_tdeint.cpp:77
+msgid "Y to UV"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:1018
-msgid "_GMC"
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_tdeint.cpp:78
+msgid "UV to Y"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:1021
-msgid ""
-"Global Motion Compensation can save bits on camera pans, zooming and rotation"
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_tdeint.cpp:84
+msgid "2"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:1023
-msgid "_BVHQ"
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_tdeint.cpp:91
+#: avidemux/ADM_videoFilter/ADM_vidKernelDeint.cpp:92
+#: avidemux/ADM_videoFilter/ADM_vidDGbob.cpp:90
+#: avidemux/ADM_videoFilter/ADM_vidDecTelecide.cpp:111
+msgid "_Field order:"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:1026
-msgid "Produces nicer-looking B-frames"
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_tdeint.cpp:92
+msgid "_Interpolate:"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:1040
-msgid "As input"
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_tdeint.cpp:94
+msgid "_Type:"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:1043
-msgid "Get PAR from input video file"
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_tdeint.cpp:95
+msgid "_MntMode:"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:1049
-msgid "Pixel Width"
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_tdeint.cpp:96
+msgid "_Link:"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:1060
-msgid "Pixel Height"
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_tdeint.cpp:97
+msgid "_AP type:"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:1061
-msgid "Pixel Aspect Ratio"
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_tdeint.cpp:100
+msgid "Use ch_roma to evalute"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:1079
-msgid "Quantization type:"
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_tdeint.cpp:101
+msgid "Try _weave"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:1083
-msgid "_H.263"
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_tdeint.cpp:102
+msgid "_Denoise"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:1086
-msgid "H.263 quantizers smooth the picture (useful at lower bitrates)"
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_tdeint.cpp:103
+#: avidemux/ADM_videoFilter/ADM_vidKernelDeint.cpp:94
+msgid "_Sharp"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:1090
-msgid "_MPEG"
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_tdeint.cpp:104
+msgid "_Evalute all frames"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:1093
-msgid ""
-"MPEG quantizers (slightly slower) produce sharper picture (useful at higher "
-"bitrates)"
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_tdeint.cpp:107
+msgid "Motion threshold, l_uma:"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:1097
-msgid "_Custom Matrix"
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_tdeint.cpp:108
+msgid "Motion threshold, c_hroma:"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:1107
-msgid "Load Custom Matrix:  "
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_tdeint.cpp:109
+msgid "Area com_bing threshold:"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:1153
-msgid "I-frame quantizer - Min:"
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_tdeint.cpp:110
+msgid "Combe_d threshold:"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:1158
-msgid "P-frame quantizer - Min:"
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_tdeint.cpp:111
+msgid "Artefact _protection threshold:"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:1163
-msgid "B-frame quantizer - Min:"
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_tdeint.cpp:120
+msgid "TDeint"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:1176
-msgid "Minimum quantizer allowed for I-frames"
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_gototime.cpp:27
+msgid "_Hours:"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:1182
-msgid "Minimum quantizer allowed for P-frames"
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_gototime.cpp:28
+msgid "_Minutes:"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:1188
-msgid "Minimum quantizer allowed for B-frames"
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_gototime.cpp:29
+msgid "_Seconds:"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:1217
-msgid "Maximum quantizer allowed for I-frames"
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_srt.cpp:88
+msgid "_Subtitle file:"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:1223
-msgid "Maximum quantizer allowed for P-frames"
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_srt.cpp:89
+msgid "_Font (TTF):"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:1229
-msgid "Maximum quantizer allowed for B-frames"
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_srt.cpp:104
+msgid "_Encoding:"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:1231
-msgid "Quantizer restrictions"
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_srt.cpp:106
+msgid "S_elect C_olor"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:1235
-msgid "_Trellis quantization"
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_srt.cpp:107
+msgid "Set Size and _Position"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:1238
-msgid "Rate distortion quantization, will find optimal encoding for each block"
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_srt.cpp:108
+msgid "_Auto split"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:1268
-msgid "I-frame boost (%):"
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_srt.cpp:109
+msgid "_Delay (ms):"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:1273
-msgid "I-frames closer than ... frames..."
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_srt.cpp:112
+msgid "Subtitler"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:1278
-msgid "...are reduced by (%):"
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:170
+msgid "_Use systray while encoding"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:1283
-msgid "Max overflow improvement (%):"
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:171
+msgid "_Accept non-standard audio frequency for DVD"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:1288
-msgid "Max overflow degradation (%):"
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:172
+msgid "_Use libavcodec MPEG-2 decoder"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:1300
-#, possible-c-format
-msgid "A value of 20 will give 20% more bits to every I-frame"
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:173
+msgid "Create _OpenDML files"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:1306
-msgid ""
-"I-frames appearing in the range below this value will be treated as "
-"consecutive keyframes"
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:174
+msgid "Automatically _index MPEG files"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:1311
-msgid ""
-"Reduction of bitrate for the first consecutive I-frames. The last I-frame "
-"will get treated normally"
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:175
+msgid "Automatically _swap A and B if A>B"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:1316
-msgid ""
-"How much of the overflow the codec can eat into during undersized sections - "
-"larger values will bridge the gap faster"
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:176
+msgid "_Disable NUV audio sync"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:1321
-msgid ""
-"How much of the overflow the codec can eat into during oversized sections - "
-"larger values will bridge the gap faster"
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:177
+msgid "_Load external filters"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:1323
-msgid "Two pass tuning"
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:179
+msgid "Automatically _build VBR map"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:1340
-msgid "High bitrate scenes (%):"
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:180
+msgid "Automatically _rebuild index"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:1345
-msgid "Low bitrate scenes (%):"
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:181
+msgid "Automatically remove _packed bitstream"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:1350
-msgid "Overflow control strength (%):"
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:183
+msgid "_Number of threads:"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:1362
-msgid ""
-"The higher this value, the more bits get taken from frames larger than the "
-"average size, and redistributed to others"
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:187
+msgid "Above normal"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:1367
-msgid ""
-"The higher this value, the more bits get assigned to frames below the "
-"average frame size"
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:189
+msgid "Below normal"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:1372
-msgid ""
-"0 = default from core (let XviD decide), else overflow payback percent per "
-"frame"
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:192
+msgid "_Encoding priority:"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:1374
-msgid "Curve compression"
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:193
+msgid "_Indexing/unpacking priority:"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:1378
-msgid "Second Pass"
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:194
+msgid "_Playback priority:"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:1591
-msgid "<b>Intra Matrix</b>"
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:196
+msgid "_Split MPEG files every (MB):"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:1609
-msgid "<b>Inter Matrix</b>"
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:198
+msgid "_Use alternative tag for MP3 in .mp4"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_filters/gui_filter.cpp:327
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_filters/gui_filtermanager.cpp:241
-#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_filters/Q_mainfilter.cpp:396
-msgid "The filter is already partial"
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:201
+msgid "GTK+ (slow)"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_filters/gui_filter.cpp:455
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_filters/gui_filter.cpp:457
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_filters/gui_filtermanager.cpp:347
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_filters/gui_filtermanager.cpp:349
-msgid "Load set of filters"
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:203
+msgid "XVideo (best)"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_filters/gui_filter.cpp:464
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_filters/gui_filtermanager.cpp:362
-msgid "Nothing to save"
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:207
+msgid "SDL (GDI)"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_filters/gui_filter.cpp:468
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_filters/gui_filter.cpp:470
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_filters/gui_filtermanager.cpp:366
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_filters/gui_filtermanager.cpp:368
-msgid "Save set of filters"
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:208
+msgid "SDL (DirectX)"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_filters/gui_filterlist.cpp:64
-msgid "Add Video Filter"
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:210
+msgid "SDL (good)"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_filters/gui_filterlist.cpp:98
-msgid "Transformation"
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:214
+msgid "Video _display:"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_filters/gui_filterlist.cpp:148
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_filters/gui_filtermanager_dialog.cpp:309
-msgid "Colors"
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:219
+msgid "No alerts"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_filters/gui_filterlist.cpp:198
-msgid "Sharpen/Blur"
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:220
+msgid "Display only error alerts"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_filters/gui_filterlist.cpp:223
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_filters/gui_filtermanager_dialog.cpp:381
-msgid "Subtitles"
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:221
+msgid "Display all alerts"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_filters/gui_filterlist.cpp:248
-msgid "Miscellaneous"
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:223
+msgid "_Message level:"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_filters/gui_filtermanager_dialog.cpp:123
-msgid "Video Filter Manager"
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:228
+msgid "PCM"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_filters/gui_filtermanager_dialog.cpp:145
-msgid "Open filter list [Ctrl-O]"
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:229
+msgid "Master"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_filters/gui_filtermanager_dialog.cpp:154
-msgid "Save filter list [Ctrl-S]"
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:230
+msgid "_Volume control:"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_filters/gui_filtermanager_dialog.cpp:162
-msgid "Save Script"
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:235
+msgid "No downmixing"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_filters/gui_filtermanager_dialog.cpp:165
-msgid "Save as script [Ctrl-J]"
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:237
+msgid "Pro Logic"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_filters/gui_filtermanager_dialog.cpp:173
-msgid "DVD Res"
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:238
+msgid "Pro Logic II"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_filters/gui_filtermanager_dialog.cpp:176
-msgid "DVD resolution [Ctrl-1]"
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:240
+msgid "_Local playback downmixing:"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_filters/gui_filtermanager_dialog.cpp:184
-msgid "Half D1 Res"
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:272
+msgid "_Audio output:"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_filters/gui_filtermanager_dialog.cpp:187
-msgid "Half D1 resolution [Ctrl-2]"
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:274
+msgid "ALSA _device:"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_filters/gui_filtermanager_dialog.cpp:195
-msgid "SVCD Res"
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:285
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_postproc.cpp:51
+#: avidemux/ADM_videoFilter/ADM_vidForcedPP.cpp:72
+msgid "_Horizontal deblocking"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_filters/gui_filtermanager_dialog.cpp:198
-msgid "SVCD resolution [Ctrl-3]"
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:286
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_postproc.cpp:52
+#: avidemux/ADM_videoFilter/ADM_vidForcedPP.cpp:73
+msgid "_Vertical deblocking"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_filters/gui_filtermanager_dialog.cpp:206
-msgid "VCD Res"
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:287
+msgid "De_ringing"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_filters/gui_filtermanager_dialog.cpp:209
-msgid "VCD resolution [Ctrl-4]"
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:288
+#: avidemux/ADM_videoFilter/ADM_vidMSharpen.cpp:167
+msgid "_Strength:"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_filters/gui_filtermanager_dialog.cpp:260
-msgid "Transform"
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:289
+msgid "Default Postprocessing"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_filters/gui_filtermanager_dialog.cpp:333
-msgid "Noise"
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:303
+msgid "_Filter directory:"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_filters/gui_filtermanager_dialog.cpp:357
-msgid "Sharpness"
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:308
+msgid "Use _Global GlyphSet:"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_filters/gui_filtermanager_dialog.cpp:405
-msgid "Misc"
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:309
+msgid "Gl_yphSet:"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_filters/gui_filtermanager_dialog.cpp:416
-msgid "External"
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:343
+msgid "Global Glyphset"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_filters/gui_filtermanager_dialog.cpp:427
-msgid "Add selected filter to the Active Filters list"
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:348
+msgid "External Filters"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_filters/gui_filtermanager_dialog.cpp:433
-msgid "<b>Available Filters</b>"
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:352
+msgid "Preferences"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_filters/gui_filtermanager_dialog.cpp:478
-msgid "Remove filter"
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_DVDff.cpp:55
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_SVCD.cpp:45
+msgid "Default"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_filters/gui_filtermanager_dialog.cpp:487
-msgid "Move filter down"
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_DVDff.cpp:56
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_SVCD.cpp:46
+msgid "TMPGEnc"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_filters/gui_filtermanager_dialog.cpp:496
-msgid "Move filter up"
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_DVDff.cpp:57
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_SVCD.cpp:47
+msgid "Anime"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_filters/gui_filtermanager_dialog.cpp:502
-msgid "P_artial"
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_DVDff.cpp:58
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_SVCD.cpp:48
+msgid "KVCD"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_filters/gui_filtermanager_dialog.cpp:505
-msgid "Apply the current filter only to a part of the file"
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_DVDff.cpp:61
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_SVCD.cpp:51
+msgid "Progressive"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_filters/gui_filtermanager_dialog.cpp:510
-msgid "Configure filter"
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_DVDff.cpp:62
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_SVCD.cpp:52
+msgid "Interlaced TFF"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_filters/gui_filtermanager_dialog.cpp:520
-msgid "C_onfigure"
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_DVDff.cpp:63
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_SVCD.cpp:53
+msgid "Interlaced BFF"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_filters/gui_filtermanager_dialog.cpp:524
-msgid "<b >Active Filters</b>"
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_DVDff.cpp:74
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_SVCD.cpp:60
+msgid "Ma_x. bitrate:"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_filters/gui_filtermanager_dialog.cpp:551
-msgid "_Preview"
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_DVDff.cpp:75
+msgid "Mi_n. bitrate:"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_filters/gui_filtersub.cpp:52
-msgid "Video Filters"
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_DVDff.cpp:76
+msgid "_Use Xvid rate control"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_filters/gui_filtersub.cpp:112
-msgid "VCD res"
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_DVDff.cpp:78
+msgid "_Buffer size:"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_filters/gui_filtersub.cpp:118
-msgid "SVCD res"
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_DVDff.cpp:80
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_SVCD.cpp:57
+msgid "Aspect _ratio:"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_filters/gui_filtersub.cpp:124
-msgid "DVD res"
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_DVDff.cpp:81
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_SVCD.cpp:58
+msgid "_Matrices:"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_filters/gui_filtersub.cpp:130
-msgid "Half D1 res"
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_DVDff.cpp:82
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_SVCD.cpp:59
+msgid "_GOP size:"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_filters/gui_filtersub.cpp:156
-msgid "Save as script"
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_DVDff.cpp:88
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_SVCD.cpp:66
+msgid "_Interlacing:"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_bindings.cpp:425
-msgid "Input"
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_v2v.cpp:41
+msgid "_VOB file(s):"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_bindings.cpp:426
-msgid "Output"
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_v2v.cpp:42
+msgid "_IFO file:"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_bindings.cpp:427
-msgid "Side"
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_v2v.cpp:43
+msgid "Vob_Sub file:"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_bindings.cpp:428
-#: avidemux/ADM_videoFilter/ADM_vidDecTelecide.cpp:90
-#: avidemux/ADM_videoFilter/ADM_vidDGbob.cpp:81
-#: avidemux/ADM_videoFilter/ADM_vidKernelDeint.cpp:87
-#: avidemux/ADM_videoFilter/ADM_vidMcDeint.cpp:109
-msgid "Top"
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_v2v.cpp:48
+msgid "VOB to VobSub"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_bindings.cpp:429
-msgid "Separate"
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_v2v.cpp:52
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_v2v.cpp:57
+msgid "The selected vobfile does not exist"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_bindings.cpp:605
-#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/Q_gui2.cpp:429
-#, c-format
-msgid "Frame:%c(%02d)"
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_v2v.cpp:62
+msgid "Please select a correct VobSub path/dir"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:282
-#: avidemux/main.cpp:167
-msgid "_File"
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_bitrateHisto.cpp:59
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_bitrateHisto.cpp:128
+msgid "No data"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:289
-msgid "_Open..."
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_bitrateHisto.cpp:232
+msgid "Bitrate Histogram"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:300
-msgid "_Append..."
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_builtin.cpp:128
+msgid "Video Codecs"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:311
-msgid "_Save"
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_builtin.cpp:129
+msgid "Xvid"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:322
-msgid "Save _Video..."
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_builtin.cpp:130
+msgid "x264"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:334
-msgid "Save _BMP Image..."
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_builtin.cpp:135
+msgid "Audio Codecs"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:338
-msgid "Save _JPEG Image..."
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_builtin.cpp:136
+msgid "Aften"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:342
-msgid "Save _Selection as JPEG images..."
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_builtin.cpp:137
+msgid "amrnb"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:351
-msgid "Save _Project"
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_builtin.cpp:138
+msgid "FAAC"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:359
-msgid "Save P_roject As..."
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_builtin.cpp:139
+msgid "FAAD2"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:367
-msgid "_Load/Run Project..."
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_builtin.cpp:140
+msgid "LAME"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:375
-msgid "A_dd to Joblist..."
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_builtin.cpp:141
+msgid "liba52"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:379
-msgid "Show _Joblist"
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_builtin.cpp:142
+msgid "libdca"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:391
-msgid "Proper_ties"
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_builtin.cpp:143
+msgid "MAD"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:402
-msgid "AVI _Muxer Options"
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_builtin.cpp:144
+msgid "Vorbis"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:411
-msgid "_Quit"
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_builtin.cpp:156
+msgid "aRts"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:422
-msgid "_Edit"
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_builtin.cpp:157
+msgid "ESD"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:429
-msgid "_Reset Edits"
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_builtin.cpp:158
+msgid "Fontconfig"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:442
-msgid "Cu_t"
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_builtin.cpp:159
+msgid "FreeType 2"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:453
-msgid "_Copy"
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_builtin.cpp:160
+msgid "gettext"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:464
-msgid "_Paste"
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_builtin.cpp:161
+msgid "ALSA"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:475
-msgid "_Delete"
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_builtin.cpp:162
+msgid "OSS"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:491
-msgid "Set Marker _A"
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_builtin.cpp:163
+msgid "SDL"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:498
-msgid "Set Marker _B"
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_builtin.cpp:164
+msgid "XVideo"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:510
-msgid "Pre_ferences"
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_builtin.cpp:166
+msgid "AltiVec"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:518
-msgid "_View"
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_builtin.cpp:167
+msgid "PowerPC"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:525
-msgid "_Main Toolbar"
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_builtin.cpp:168
+msgid "x86"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:530
-msgid "_A/V Sidebar"
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_builtin.cpp:169
+msgid "x86-64"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:540
-msgid "_Zoom 1:4"
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_builtin.cpp:176
+msgid "Codecs"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:547
-msgid "Z_oom 1:2"
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_builtin.cpp:177
+msgid "Libraries"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:554
-msgid "Zoom _1:1"
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_builtin.cpp:178
+msgid "CPU"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:561
-msgid "Zoom _2:1"
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_builtin.cpp:182
+msgid "Built-in Support"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:568
-msgid "Zoom _4:1"
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_audioFilter.cpp:62
+msgid "_Dynamic range compression"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:575
-msgid "Vi_deo"
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_audioFilter.cpp:64
+msgid "_Time shift (ms):"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:582
-msgid "_Decoder Options"
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_audioFilter.cpp:64
+msgid "Time shift value (ms)"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:589
-msgid "_Postprocessing"
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_audioFilter.cpp:72
+msgid "R_esampling (Hz):"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:592
-msgid "Select postprocessing level"
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_audioFilter.cpp:72
+msgid "Resampling frequency (Hz)"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:602
-msgid "P_review"
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_audioFilter.cpp:81
+msgid "Film to PAL"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:609
-msgid "Display _Output"
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_audioFilter.cpp:82
+msgid "PAL to Film"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:621
-msgid "_Frame Rate"
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_audioFilter.cpp:85
+msgid "_Frame rate change:"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:625
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:674
-msgid "_Encoder"
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_audioFilter.cpp:90
+msgid "Automatic (max -3 dB)"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:632
-msgid "Fil_ters"
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_audioFilter.cpp:91
+msgid "Manual"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:639
-msgid "_Audio"
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_audioFilter.cpp:93
+msgid "_Gain mode:"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:646
-msgid "_Main Track"
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_audioFilter.cpp:95
+msgid "G_ain value:"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:650
-msgid "_Second Track"
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_audioFilter.cpp:102
+msgid "No change"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:654
-msgid "_Build VBR Time Map"
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_audioFilter.cpp:105
+msgid "Stereo+surround"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:663
-msgid "S_ave..."
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_audioFilter.cpp:106
+msgid "Stereo+center"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:681
-msgid "_Filters"
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_audioFilter.cpp:107
+msgid "Stereo+center+surround"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:685
-msgid "_Tools"
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_audioFilter.cpp:108
+msgid "Stereo front+stereo rear"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:692
-msgid "_Calculator"
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_audioFilter.cpp:109
+msgid "5 channels"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:708
-msgid "_Rebuild Frames (I & B)"
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_audioFilter.cpp:110
+msgid "5.1"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:712
-msgid "C_heck Frames (slow)"
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_audioFilter.cpp:111
+msgid "Dolby Pro Logic"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:716
-msgid "_Bitrate Histogram"
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_audioFilter.cpp:112
+msgid "Dolby Pro Logic II"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:720
-msgid "_Scan for Black Frames..."
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_audioFilter.cpp:115
+msgid "_Mixer:"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:729
-msgid "_VOB -> VobSub"
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_audioFilter.cpp:119
+msgid "Audio Filters"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:733
-msgid "_OCR (VobSub -> srt)"
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_lavcodec.cpp:52
+msgid "Full"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:737
-msgid "A_uto"
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_lavcodec.cpp:53
+msgid "Log"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:744
-msgid "_VCD"
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_lavcodec.cpp:54
+msgid "Phods"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:748
-msgid "_SVCD"
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_lavcodec.cpp:55
+msgid "EPZS"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:752
-msgid "_DVD"
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_lavcodec.cpp:56
+msgid "X1"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:760
-msgid "PSP (H264)"
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_lavcodec.cpp:60
+msgid "H.263"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:764
-msgid "_Go"
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_lavcodec.cpp:65
+msgid "MB comparison"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:771
-msgid "_Play/Stop"
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_lavcodec.cpp:66
+msgid "Fewest bits (vhq)"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:782
-msgid "P_revious Frame"
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_lavcodec.cpp:67
+msgid "Rate distortion"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:793
-msgid "_Next Frame"
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_lavcodec.cpp:73
+msgid "Matrices"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:804
-msgid "Pr_evious Intra Frame"
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_lavcodec.cpp:74
+msgid "Mi_n. quantizer:"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:815
-msgid "Next _Intra Frame"
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_lavcodec.cpp:75
+msgid "Ma_x. quantizer:"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:826
-msgid "Previou_s Black Frame"
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_lavcodec.cpp:76
+msgid "Max. quantizer _difference:"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:830
-msgid "Ne_xt Black Frame"
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_lavcodec.cpp:78
+msgid "4_MV"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:834
-msgid "_First Frame"
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_lavcodec.cpp:81
+msgid "_Quarter pixel"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:845
-msgid "_Last Frame"
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_lavcodec.cpp:85
+msgid "_Number of B frames:"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:861
-msgid "Go to Marker _A"
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_lavcodec.cpp:86
+msgid "_Quantization type:"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:868
-msgid "Go to Marker _B"
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_lavcodec.cpp:88
+msgid "_Macroblock decision:"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:880
-msgid "_Jump to Frame..."
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_lavcodec.cpp:90
+msgid "_Filesize tolerance (kb):"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:891
-msgid "Jump to _Time..."
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_lavcodec.cpp:92
+msgid "_Quantizer compression:"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:906
-msgid "_Help"
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_lavcodec.cpp:93
+msgid "Quantizer _blur:"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:913
-msgid "_About"
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_lavcodec.cpp:98
+msgid "User Interface"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:921
-msgid "Show builtin support"
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_lavcodec.cpp:108
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_x264.cpp:86
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_srt.cpp:89
+msgid "Motion Estimation"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:935
-msgid "Open a file"
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_lavcodec.cpp:120
+msgid "libavcodec MPEG-4 configuration"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:945
-msgid "Save the file"
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_resizeWiz.cpp:59
+msgid "_Target type:"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:951
-msgid "Audio/video file information"
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_resizeWiz.cpp:60
+msgid "_Source aspect ratio:"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:959
-msgid "Calculator"
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_resizeWiz.cpp:61
+msgid "_Destination aspect ratio:"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:962
-msgid "Bitrate/size calculator"
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_postproc.cpp:40
+#: avidemux/ADM_videoFilter/ADM_vidForcedPP.cpp:60
+msgid "_Filter strength:"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1016
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1056
-msgid "Copy"
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_postproc.cpp:41
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_lavDecoder.cpp:45
+msgid "_Swap U and V"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1021
-msgid "Configure video encoder"
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_postproc.cpp:53
+#: avidemux/ADM_videoFilter/ADM_vidForcedPP.cpp:74
+msgid "_Deringing"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1026
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1082
-msgid "Filters"
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:82
+msgid "Select idx file:"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1029
-msgid "Video filters"
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:83
+msgid "Use glyphset (optional):"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1061
-msgid "Configure audio encoder"
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:84
+msgid "Output SRT file"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1069
-msgid "Audio filters"
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:95
+msgid "Select input and ouput files"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1090
-msgid "Shift:"
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:105
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:117
+msgid "The idx/sub file does not exist."
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1093
-msgid "Enable time shift"
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:110
+msgid "Please Select a valid output SRT file."
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1099
-msgid "Audio/video time shift (ms)"
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:126
+msgid "Cannot load the glyphset file."
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1106
-msgid "<b>Format</b>"
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:144
+msgid "Glyphset filename"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1139
-msgid "<b>Selection</b>"
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:146
+msgid "Save Glyph"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1156
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1164
-msgid " 0000000"
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_mjpeg.cpp:41
+msgid "_Swap U&V:"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1172
-msgid "A:"
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_requant.cpp:48
+msgid "_Shrink Factor:"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1179
-msgid "Go to marker A"
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_lavDecoder.cpp:46
+msgid "Show motion _vectors"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1181
-msgid "B:"
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_lavDecoder.cpp:48
+msgid "Decoder Options"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1188
-msgid "Go to marker B"
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_animated.cpp:36
+msgid "_Background Image:"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1200
-msgid "Play"
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_animated.cpp:37
+msgid "_NTSC(default is Pal):"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1214
-msgid "Stop"
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_animated.cpp:38
+msgid "Vignette _Width:"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1226
-msgid "Previous frame"
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_animated.cpp:39
+msgid "Vignette _Height:"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1241
-msgid "Next frame"
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_animated.cpp:42
+msgid "Vignette frame number"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1256
-msgid "Previous keyframe"
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_animated.cpp:46
+msgid "Timecode:"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1271
-msgid "Next keyframe"
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_x264.cpp:69
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_srt.cpp:72
+msgid "Partition Decision"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1285
-msgid "Selection: start"
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_x264.cpp:77
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_xvid4.cpp:72
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_srt.cpp:80
+msgid "VHQ Mode"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1296
-msgid "Selection: end"
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_x264.cpp:78
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_srt.cpp:81
+msgid "Max Ref Frames"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1307
-msgid "Previous black frame"
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_x264.cpp:79
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_x264.cpp:143
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_xvid4.cpp:76
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_srt.cpp:82
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_srt.cpp:146
+msgid "Max B Frames"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1318
-msgid "Next black frame"
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_x264.cpp:82
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_srt.cpp:85
+msgid "Fast P Skip"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1329
-msgid "First frame"
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_x264.cpp:83
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_srt.cpp:86
+msgid "DCT Decimate"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1340
-msgid "Last frame"
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_x264.cpp:84
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_srt.cpp:87
+msgid "Interlaced"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1371
-msgid "Frame: "
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_x264.cpp:103
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_srt.cpp:106
+msgid "Disabled"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1378
-msgid "Current frame"
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_x264.cpp:110
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_srt.cpp:113
+msgid "Deblocking Filter"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1383
-msgid "/0000000"
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_x264.cpp:111
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_srt.cpp:114
+msgid "Strength"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1390
-msgid "Time: "
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_x264.cpp:112
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_srt.cpp:115
+msgid "Threshold"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1397
-msgid "Current time"
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_x264.cpp:130
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_srt.cpp:133
+msgid "8x8P Transform"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1398
-msgid "00:00:00.000"
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_x264.cpp:131
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_srt.cpp:134
+msgid "8x8B Transform"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1401
-msgid "/00:00:00,000"
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_x264.cpp:132
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_srt.cpp:135
+msgid "_4x4 Transform"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1408
-msgid "Frame: ?"
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_x264.cpp:133
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_srt.cpp:136
+msgid "_8x8I Transform"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/adm_ocr.cpp:209
-msgid "Incorrect output file"
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_x264.cpp:134
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_srt.cpp:137
+msgid "_4x4I Transform"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/adm_ocr.cpp:215
-msgid "Output file error"
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_x264.cpp:152
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_srt.cpp:155
+msgid "X264 Configuration"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/adm_ocr.cpp:215
-#, possible-c-format
-msgid "Could not open \"%s\" for writing."
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_jobs.cpp:106
+msgid "Job Name"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/adm_ocr.cpp:224
-msgid "Problem loading sub"
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_jobs.cpp:106
+msgid "Status"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/adm_ocr.cpp:589
-msgid "Sure ?"
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_jobs.cpp:106
+msgid "Start Time"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/adm_ocr.cpp:752
-msgid "Select SRT to save"
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_jobs.cpp:106
+msgid "End Time"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/adm_ocr.cpp:764
-msgid "Select Glyoh to save"
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_jobs.cpp:196
+msgid "Delete *all* job"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/adm_ocr.cpp:778
-msgid "No glyphs to save"
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_jobs.cpp:196
+msgid "Are you sure you want to delete ALL jobs ?"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_toolkit_gtk/ADM_gladeSupport.cpp:251
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_toolkit_gtk/ADM_gladeSupport.cpp:275
-#, possible-c-format
-msgid "Couldn't find pixmap file: %s"
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_jobs.cpp:222
+msgid "Already done"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_toolkit_gtk/TLK_filesel.cpp:121
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_toolkit_gtk/TLK_filesel.cpp:391
-msgid "Cannot open directory as a file"
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_jobs.cpp:222
+msgid "This script has already been successfully executed."
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_toolkit_gtk/TLK_filesel.cpp:252
-#: avidemux/gtk_gui.cpp:877
-#, possible-c-format
-msgid "Cannot open \"%s\"."
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_xvid4.cpp:58
+msgid "Very Low"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_toolkit_gtk/TLK_filesel.cpp:262
-msgid "Overwrite file ?"
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_xvid4.cpp:60
+#: avidemux/ADM_videoFilter/ADM_vidMcDeint.cpp:105
+msgid "Medium"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_toolkit_gtk/TLK_filesel.cpp:287
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_toolkit_gtk/TLK_filesel.cpp:301
-msgid "It could be possible that you try to overwrite an input file!"
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_xvid4.cpp:62
+msgid "Very High"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_toolkit_gtk/TLK_filesel.cpp:312
-msgid "Cannot write the file"
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_xvid4.cpp:63
+msgid "Ultra High"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_toolkit_gtk/TLK_filesel.cpp:312
-#, possible-c-format
-msgid "No write access to \"%s\"."
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_xvid4.cpp:64
+msgid "Motion Search Precision"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_toolkit_gtk/TLK_filesel.cpp:445
-msgid "Images"
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_xvid4.cpp:67
+msgid "Off"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_toolkit_gtk/TLK_filesel.cpp:457
-msgid "All"
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_xvid4.cpp:68
+msgid "Mode Decision"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_toolkit_gtk/toolkit_dialog.cpp:585
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_toolkit_gtk/toolkit_dialog.cpp:657
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_toolkit_gtk/toolkit_dialog.cpp:719
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_toolkit_gtk/toolkit_dialog.cpp:779
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_toolkit_gtk/toolkit_dialog.cpp:842
-msgid "label1"
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_xvid4.cpp:69
+msgid "Limited Search"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_toolkit_gtk/toolkit_dialog.cpp:706
-msgid "Alert"
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_xvid4.cpp:70
+msgid "Medium Search"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialogFactory/T_filesel.cpp:52
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_xvid4.cpp:71
+msgid "Wide Search"
+msgstr ""
+
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_xvid4.cpp:77
+msgid "Quarter Pixel"
+msgstr ""
+
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_xvid4.cpp:78
+msgid "GMC"
+msgstr ""
+
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_xvid4.cpp:79
+msgid "BVHQ"
+msgstr ""
+
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_xvid4.cpp:88
+msgid "4MV"
+msgstr ""
+
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_xvid4.cpp:90
+msgid "HQ AC"
+msgstr ""
+
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_xvid4.cpp:91
+msgid "More Search"
+msgstr ""
+
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_xvid4.cpp:96
+msgid "Min Gop Size"
+msgstr ""
+
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_xvid4.cpp:97
+msgid "Max Gop Size"
+msgstr ""
+
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_xvid4.cpp:98
+msgid "GOP Size"
+msgstr ""
+
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_xvid4.cpp:106
+msgid "H263"
+msgstr ""
+
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_xvid4.cpp:107
+msgid "Mpeg"
+msgstr ""
+
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_xvid4.cpp:108
+msgid "Quantization Matrix"
+msgstr ""
+
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_xvid4.cpp:109
+msgid "Trellis Quantization"
+msgstr ""
+
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_xvid4.cpp:117
+msgid "Two Pass Tuning"
+msgstr ""
+
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_xvid4.cpp:128
+msgid "Curve Compression"
+msgstr ""
+
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_xvid4.cpp:142
+msgid "Xvid4 Configuration"
+msgstr ""
+
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/T_index_pg.cpp:198
+#, c-format
+msgid "# Images :%0lu"
+msgstr ""
+
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/T_index_pg.cpp:216
+#, c-format
+msgid "Time Left :%02d:%02d:%02d"
+msgstr ""
+
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_filters/Q_mainfilter.cpp:580
+msgid "Partial Start Frame:"
+msgstr ""
+
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_filters/Q_mainfilter.cpp:581
+msgid "Partial End Frame:"
+msgstr ""
+
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_filters/Q_mainfilter.cpp:582
+msgid "Configure child"
+msgstr ""
+
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_filters/Q_mainfilter.cpp:585
+msgid "Partial Video Filter"
+msgstr ""
+
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialogFactory/T_filesel.cpp:62
+msgid "Select File to Read"
+msgstr ""
+
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialogFactory/T_filesel.cpp:65
+msgid "Select File to Write"
+msgstr ""
+
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialogFactory/T_filesel.cpp:69
 msgid "Select Directory"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialogFactory/T_filesel.cpp:54
-msgid "Select File"
+#: avidemux/ADM_videoFilter/ADM_vidVlad.cpp:101
+msgid "_Luma temporal threshold:"
 msgstr ""
 
-#: avidemux/ADM_video/ADM_guiResize.cpp:96
-#: avidemux/ADM_video/ADM_vidMPLResize.cpp:143
-msgid "Width and height cannot be 0"
+#: avidemux/ADM_videoFilter/ADM_vidVlad.cpp:102
+msgid "Ch_roma temporal threshold:"
 msgstr ""
 
-#: avidemux/ADM_video/ADM_guiResize.cpp:98
-#: avidemux/ADM_video/ADM_vidMPLResize.cpp:145
-msgid "Width and height cannot be odd"
+#: avidemux/ADM_videoFilter/ADM_vidMSharpen.cpp:163
+msgid "_Mask"
 msgstr ""
 
-#: avidemux/ADM_video/ADM_vidFieldUnblend.cpp:81
-msgid "Metrics"
+#: avidemux/ADM_videoFilter/ADM_vidMSharpen.cpp:164
+msgid "_High Q"
 msgstr ""
 
-#: avidemux/ADM_video/ADM_vidFieldUnblend.cpp:81
-msgid "Do you want to print metrics on screen ?"
+#: avidemux/ADM_videoFilter/ADM_vidMSharpen.cpp:166
+#: avidemux/ADM_videoFilter/ADM_vidKernelDeint.cpp:93
+#: avidemux/ADM_videoFilter/ADM_vidDGbob.cpp:92
+#: avidemux/ADM_videoFilter/ADM_vidBlendRemoval.cpp:82
+#: avidemux/ADM_videoFilter/ADM_vidHardIvtcRemoval.cpp:87
+msgid "_Threshold:"
 msgstr ""
 
-#: avidemux/ADM_video/ADM_vidSRT.cpp:215
-msgid "Could not open subtitle file"
+#: avidemux/ADM_videoFilter/ADM_vidMcDeint.cpp:104
+msgid "Fast"
 msgstr ""
 
-#: avidemux/ADM_video/ADM_vidSRT.cpp:238
-msgid "Cannot identify subtitle format"
+#: avidemux/ADM_videoFilter/ADM_vidMcDeint.cpp:106
+msgid "Slow iterative motion search"
 msgstr ""
 
+#: avidemux/ADM_videoFilter/ADM_vidMcDeint.cpp:107
+msgid "Extra slow (same as 3+multiple reference frames)"
+msgstr ""
+
+#: avidemux/ADM_videoFilter/ADM_vidMcDeint.cpp:110
+#: avidemux/ADM_videoFilter/ADM_vidKernelDeint.cpp:88
+#: avidemux/ADM_videoFilter/ADM_vidDGbob.cpp:82
+#: avidemux/ADM_videoFilter/ADM_vidDecTelecide.cpp:91
+msgid "Bottom"
+msgstr ""
+
+#: avidemux/ADM_videoFilter/ADM_vidMcDeint.cpp:114
+msgid "_Field dominance:"
+msgstr ""
+
+#: avidemux/ADM_videoFilter/ADM_vidMcDeint.cpp:115
+msgid "_Qp:"
+msgstr ""
+
+#: avidemux/ADM_videoFilter/ADM_vidForcedPP.cpp:61
+msgid "_Quantizer:"
+msgstr ""
+
+#: avidemux/ADM_videoFilter/ADM_vidSoften.cpp:68
+msgid "_Luma threshold:"
+msgstr ""
+
+#: avidemux/ADM_videoFilter/ADM_vidSoften.cpp:69
+msgid "C_hroma threshold:"
+msgstr ""
+
+#: avidemux/ADM_videoFilter/ADM_vidSoften.cpp:70
+msgid "_Radius:"
+msgstr ""
+
+#: avidemux/ADM_videoFilter/ADM_vidFade.cpp:65
+msgid "Out"
+msgstr ""
+
+#: avidemux/ADM_videoFilter/ADM_vidFade.cpp:65
+msgid "Fade out"
+msgstr ""
+
+#: avidemux/ADM_videoFilter/ADM_vidFade.cpp:65
+msgid "In"
+msgstr ""
+
+#: avidemux/ADM_videoFilter/ADM_vidFade.cpp:65
+msgid "Fade in"
+msgstr ""
+
+#: avidemux/ADM_videoFilter/ADM_vidFade.cpp:71
+msgid "_Fade type:"
+msgstr ""
+
+#: avidemux/ADM_videoFilter/ADM_vidFade.cpp:72
+msgid "_Start frame:"
+msgstr ""
+
+#: avidemux/ADM_videoFilter/ADM_vidFade.cpp:73
+msgid "_End frame:"
+msgstr ""
+
+#: avidemux/ADM_videoFilter/ADM_vidFade.cpp:74
+msgid "Fade to _black"
+msgstr ""
+
+#: avidemux/ADM_videoFilter/ADM_vidFade.cpp:83
+msgid "Parameter Error"
+msgstr ""
+
+#: avidemux/ADM_videoFilter/ADM_vidFade.cpp:83
+msgid "Start must be before end, and both within video # of frames."
+msgstr ""
+
+#: avidemux/ADM_videoFilter/ADM_vidKernelDeint.cpp:93
+msgid "Smaller means more deinterlacing"
+msgstr ""
+
+#: avidemux/ADM_videoFilter/ADM_vidKernelDeint.cpp:94
+msgid "_Sharper engine:"
+msgstr ""
+
+#: avidemux/ADM_videoFilter/ADM_vidKernelDeint.cpp:95
+msgid "T_woway"
+msgstr ""
+
+#: avidemux/ADM_videoFilter/ADM_vidKernelDeint.cpp:95
+msgid "Extrapolate better (better not to use it)"
+msgstr ""
+
+#: avidemux/ADM_videoFilter/ADM_vidKernelDeint.cpp:96
+msgid "_Map"
+msgstr ""
+
+#: avidemux/ADM_videoFilter/ADM_vidKernelDeint.cpp:96
+msgid "Show interlaced areas (for test!)"
+msgstr ""
+
+#: avidemux/ADM_videoFilter/ADM_vidResampleFPS.cpp:85
+msgid "_New frame rate:"
+msgstr ""
+
+#: avidemux/ADM_videoFilter/ADM_vidResampleFPS.cpp:86
+msgid "_Blend"
+msgstr ""
+
 #: avidemux/ADM_videoFilter/ADM_lavpp_deint.cpp:106
 msgid "Linear blend"
 msgstr ""
@@ -5117,47 +5222,165 @@
 msgid "_Autolevel"
 msgstr ""
 
-#: avidemux/ADM_videoFilter/ADM_vidASS.cpp:85
-msgid "_Subtitle file (ass/ssa)"
+#: avidemux/ADM_videoFilter/ADM_vidMPLD3Dlow.cpp:74
+#: avidemux/ADM_videoFilter/ADM_vidMPLD3D.cpp:74
+msgid "_Spatial luma strength:"
 msgstr ""
 
-#: avidemux/ADM_videoFilter/ADM_vidASS.cpp:86
-msgid "_Line spacing"
+#: avidemux/ADM_videoFilter/ADM_vidMPLD3Dlow.cpp:75
+#: avidemux/ADM_videoFilter/ADM_vidMPLD3D.cpp:75
+msgid "S_patial chroma strength:"
 msgstr ""
 
-#: avidemux/ADM_videoFilter/ADM_vidASS.cpp:87
-msgid "_Font scale"
+#: avidemux/ADM_videoFilter/ADM_vidMPLD3Dlow.cpp:76
+#: avidemux/ADM_videoFilter/ADM_vidMPLD3D.cpp:76
+msgid "_Temporal strength:"
 msgstr ""
 
-#: avidemux/ADM_videoFilter/ADM_vidASS.cpp:88
-msgid "_Top margin"
+#: /home/fx/avidemux/avidemux/ADM_videoFilter/ADM_vidDecDec.cpp:190
+msgid "Discard Closer"
 msgstr ""
 
-#: avidemux/ADM_videoFilter/ADM_vidASS.cpp:89
-msgid "_Bottom margin"
+#: /home/fx/avidemux/avidemux/ADM_videoFilter/ADM_vidDecDec.cpp:191
+#: avidemux/ADM_videoFilter/ADM_vidDecDec.cpp:191
+msgid "Replace (interpolate)"
 msgstr ""
 
-#: avidemux/ADM_videoFilter/ADM_vidBlendRemoval.cpp:82
-msgid "threshold"
+#: /home/fx/avidemux/avidemux/ADM_videoFilter/ADM_vidDecDec.cpp:192
+#: avidemux/ADM_videoFilter/ADM_vidDecDec.cpp:192
+msgid "Discard longer dupe (anim?s)"
 msgstr ""
 
+#: /home/fx/avidemux/avidemux/ADM_videoFilter/ADM_vidDecDec.cpp:193
+msgid "PullDown dupe removal"
+msgstr ""
+
+#: /home/fx/avidemux/avidemux/ADM_videoFilter/ADM_vidDecDec.cpp:196
+#: avidemux/ADM_videoFilter/ADM_vidDecDec.cpp:196
+msgid "Fastest (no chroma, partial luma)"
+msgstr ""
+
+#: /home/fx/avidemux/avidemux/ADM_videoFilter/ADM_vidDecDec.cpp:197
+msgid "Fast (parial luma and chroma)"
+msgstr ""
+
+#: /home/fx/avidemux/avidemux/ADM_videoFilter/ADM_vidDecDec.cpp:198
+msgid "Medium (full luma no chroma)"
+msgstr ""
+
+#: /home/fx/avidemux/avidemux/ADM_videoFilter/ADM_vidDecDec.cpp:199
+#: avidemux/ADM_videoFilter/ADM_vidDecDec.cpp:199
+msgid "Slow (full luma and chroma)"
+msgstr ""
+
+#: /home/fx/avidemux/avidemux/ADM_videoFilter/ADM_vidDecDec.cpp:203
+msgid "Mode"
+msgstr ""
+
+#: /home/fx/avidemux/avidemux/ADM_videoFilter/ADM_vidDecDec.cpp:204
+msgid "Quality"
+msgstr ""
+
+#: /home/fx/avidemux/avidemux/ADM_videoFilter/ADM_vidDecDec.cpp:205
+msgid "Threshold 1"
+msgstr ""
+
+#: /home/fx/avidemux/avidemux/ADM_videoFilter/ADM_vidDecDec.cpp:206
+msgid "Threshold 2"
+msgstr ""
+
+#: avidemux/ADM_videoFilter/ADM_vidMosaic.cpp:90
+msgid "_Horizontal stacking:"
+msgstr ""
+
+#: avidemux/ADM_videoFilter/ADM_vidMosaic.cpp:91
+msgid "_Vertical stacking:"
+msgstr ""
+
+#: avidemux/ADM_videoFilter/ADM_vidMosaic.cpp:92
+msgid "_Shrink factor:"
+msgstr ""
+
+#: avidemux/ADM_videoFilter/ADM_vidMosaic.cpp:93
+msgid "Show _frame"
+msgstr ""
+
+#: avidemux/ADM_videoFilter/ADM_vidStabilize.cpp:63
+msgid "Stabilize Threshold"
+msgstr ""
+
+#: avidemux/ADM_videoFilter/ADM_vidDropOut.cpp:63
+msgid "DropOut Threshold"
+msgstr ""
+
+#: avidemux/ADM_videoFilter/ADM_vidDenoise.cpp:386
+msgid "_Luma lock:"
+msgstr ""
+
+#: avidemux/ADM_videoFilter/ADM_vidDenoise.cpp:387
+msgid "C_hroma lock:"
+msgstr ""
+
+#: avidemux/ADM_videoFilter/ADM_vidDenoise.cpp:388
+msgid "L_uma threshold:"
+msgstr ""
+
+#: avidemux/ADM_videoFilter/ADM_vidDenoise.cpp:389
+msgid "Ch_roma threshold:"
+msgstr ""
+
+#: avidemux/ADM_videoFilter/ADM_vidDenoise.cpp:391
+msgid "_Scene change:"
+msgstr ""
+
+#: avidemux/ADM_videoFilter/ADM_vidDGbob.cpp:85
+msgid "Keep nb of frames and fps"
+msgstr ""
+
+#: avidemux/ADM_videoFilter/ADM_vidDGbob.cpp:86
+msgid "Double nb of frames and fps"
+msgstr ""
+
+#: avidemux/ADM_videoFilter/ADM_vidDGbob.cpp:87
+msgid "Double nb of frames (slow motion)"
+msgstr ""
+
+#: avidemux/ADM_videoFilter/ADM_vidDGbob.cpp:93
+msgid "_Extra"
+msgstr ""
+
+#: avidemux/ADM_videoFilter/ADM_vidDGbob.cpp:93
+msgid "Extra check, avoid using it"
+msgstr ""
+
+#: avidemux/ADM_videoFilter/ADM_vidMPLResize.cpp:143
+#: avidemux/ADM_videoFilter/ADM_guiResize.cpp:96
+msgid "Width and height cannot be 0"
+msgstr ""
+
+#: avidemux/ADM_videoFilter/ADM_vidMPLResize.cpp:145
+#: avidemux/ADM_videoFilter/ADM_guiResize.cpp:98
+msgid "Width and height cannot be odd"
+msgstr ""
+
 #: avidemux/ADM_videoFilter/ADM_vidBlendRemoval.cpp:83
-#: avidemux/ADM_videoFilter/ADM_vidHardIvtcRemoval.cpp:88
 msgid ""
-"If value is smaller than threshold it is considered valid. Smaller value "
-"might mean more false positive"
+"If value is smaller than threshold it is considered valid.Smaller value "
+"might mean more false positive."
 msgstr ""
 
 #: avidemux/ADM_videoFilter/ADM_vidBlendRemoval.cpp:85
-msgid "noise"
+#: avidemux/ADM_videoFilter/ADM_vidHardIvtcRemoval.cpp:90
+msgid "_Noise:"
 msgstr ""
 
 #: avidemux/ADM_videoFilter/ADM_vidBlendRemoval.cpp:85
-msgid "If pixel are closer than noise, they are considered to be the same"
+#: avidemux/ADM_videoFilter/ADM_vidHardIvtcRemoval.cpp:90
+msgid "If pixels are closer than noise, they are considered to be the same"
 msgstr ""
 
 #: avidemux/ADM_videoFilter/ADM_vidBlendRemoval.cpp:86
-msgid "identical"
+msgid "I_dentical:"
 msgstr ""
 
 #: avidemux/ADM_videoFilter/ADM_vidBlendRemoval.cpp:86
@@ -5166,7 +5389,8 @@
 msgstr ""
 
 #: avidemux/ADM_videoFilter/ADM_vidBlendRemoval.cpp:87
-msgid "show"
+#: avidemux/ADM_videoFilter/ADM_vidHardIvtcRemoval.cpp:92
+msgid "_Show metrics"
 msgstr ""
 
 #: avidemux/ADM_videoFilter/ADM_vidBlendRemoval.cpp:87
@@ -5175,52 +5399,102 @@
 msgstr ""
 
 #: avidemux/ADM_videoFilter/ADM_vidDecDec.cpp:190
-msgid "Discard Closer"
+msgid "Discard closer"
 msgstr ""
 
-#: avidemux/ADM_videoFilter/ADM_vidDecDec.cpp:191
-msgid "Replace (interpolate)"
+#: avidemux/ADM_videoFilter/ADM_vidDecDec.cpp:193
+msgid "Pulldown dupe removal"
 msgstr ""
 
-#: avidemux/ADM_videoFilter/ADM_vidDecDec.cpp:192
-msgid "Discard longer dupe (anim?s)"
+#: avidemux/ADM_videoFilter/ADM_vidDecDec.cpp:197
+msgid "Fast (partial luma and chroma)"
 msgstr ""
 
-#: avidemux/ADM_videoFilter/ADM_vidDecDec.cpp:193
-msgid "PullDown dupe removal"
+#: avidemux/ADM_videoFilter/ADM_vidDecDec.cpp:198
+msgid "Medium (full luma, no chroma)"
 msgstr ""
 
-#: avidemux/ADM_videoFilter/ADM_vidDecDec.cpp:196
-msgid "Fastest (no chroma, partial luma)"
+#: avidemux/ADM_videoFilter/ADM_vidDecDec.cpp:205
+msgid "_Threshold 1:"
 msgstr ""
 
-#: avidemux/ADM_videoFilter/ADM_vidDecDec.cpp:197
-msgid "Fast (parial luma and chroma)"
+#: avidemux/ADM_videoFilter/ADM_vidDecDec.cpp:206
+msgid "T_hreshold 2:"
 msgstr ""
 
-#: avidemux/ADM_videoFilter/ADM_vidDecDec.cpp:198
-msgid "Medium (full luma no chroma)"
+#: avidemux/ADM_videoFilter/ADM_vidPalShift.cpp:76
+msgid "_Try reverse"
 msgstr ""
 
-#: avidemux/ADM_videoFilter/ADM_vidDecDec.cpp:199
-msgid "Slow (full luma and chroma)"
+#: avidemux/ADM_videoFilter/ADM_vidASS.cpp:87
+msgid "_Subtitle file (ASS/SSA):"
 msgstr ""
 
-#: avidemux/ADM_videoFilter/ADM_vidDecDec.cpp:205
-msgid "Threshold 1"
+#: avidemux/ADM_videoFilter/ADM_vidASS.cpp:88
+msgid "_Line spacing:"
 msgstr ""
 
-#: avidemux/ADM_videoFilter/ADM_vidDecDec.cpp:206
-msgid "Threshold 2"
+#: avidemux/ADM_videoFilter/ADM_vidASS.cpp:89
+msgid "_Font scale:"
 msgstr ""
 
-#: avidemux/ADM_videoFilter/ADM_vidDecTelecide.cpp:91
-#: avidemux/ADM_videoFilter/ADM_vidDGbob.cpp:82
-#: avidemux/ADM_videoFilter/ADM_vidKernelDeint.cpp:88
-#: avidemux/ADM_videoFilter/ADM_vidMcDeint.cpp:110
-msgid "Bottom"
+#: avidemux/ADM_videoFilter/ADM_vidASS.cpp:90
+msgid "_Top margin:"
 msgstr ""
 
+#: avidemux/ADM_videoFilter/ADM_vidASS.cpp:91
+msgid "Botto_m margin"
+msgstr ""
+
+#: avidemux/ADM_videoFilter/ADM_vidRotate.cpp:265
+msgid "90 degrees"
+msgstr ""
+
+#: avidemux/ADM_videoFilter/ADM_vidRotate.cpp:265
+msgid "90?"
+msgstr ""
+
+#: avidemux/ADM_videoFilter/ADM_vidRotate.cpp:266
+msgid "180 degrees"
+msgstr ""
+
+#: avidemux/ADM_videoFilter/ADM_vidRotate.cpp:266
+msgid "180?"
+msgstr ""
+
+#: avidemux/ADM_videoFilter/ADM_vidRotate.cpp:267
+msgid "270 degrees"
+msgstr ""
+
+#: avidemux/ADM_videoFilter/ADM_vidRotate.cpp:267
+msgid "270?"
+msgstr ""
+
+#: avidemux/ADM_videoFilter/ADM_vidRotate.cpp:269
+msgid "_Angle:"
+msgstr ""
+
+#: avidemux/ADM_videoFilter/ADM_vidRotate.cpp:271
+msgid "Rotate"
+msgstr ""
+
+#: avidemux/ADM_videoFilter/ADM_vidDecTelecide.cpp:83
+msgid "No strategy"
+msgstr ""
+
+#: avidemux/ADM_videoFilter/ADM_vidDecTelecide.cpp:84
+msgid "3:2 pulldown"
+msgstr ""
+
+#: avidemux/ADM_videoFilter/ADM_vidDecTelecide.cpp:85
+msgid "PAL/SECAM"
+msgstr ""
+
+#: avidemux/ADM_videoFilter/ADM_vidDecTelecide.cpp:86
+#: avidemux/ADM_script/ADM_JSFunctions.cpp:559
+msgid "NTSC converted from PAL"
+msgstr ""
+
 #: avidemux/ADM_videoFilter/ADM_vidDecTelecide.cpp:95
 msgid "Never"
 msgstr ""
@@ -5242,7 +5516,7 @@
 msgstr ""
 
 #: avidemux/ADM_videoFilter/ADM_vidDecTelecide.cpp:104
-msgid "Postproc and show zones(debug)"
+msgid "Postproc and show zones (debug)"
 msgstr ""
 
 #: avidemux/ADM_videoFilter/ADM_vidDecTelecide.cpp:105
@@ -5250,614 +5524,733 @@
 msgstr ""
 
 #: avidemux/ADM_videoFilter/ADM_vidDecTelecide.cpp:106
-msgid "Process image (not fields),debug"
+msgid "Process image (not fields), debug"
 msgstr ""
 
 #: avidemux/ADM_videoFilter/ADM_vidDecTelecide.cpp:110
-msgid "Strategy"
+msgid "_Strategy:"
 msgstr ""
 
-#: avidemux/ADM_videoFilter/ADM_vidDecTelecide.cpp:111
-msgid "Field Order"
-msgstr ""
-
 #: avidemux/ADM_videoFilter/ADM_vidDecTelecide.cpp:112
-msgid "Post Processing"
+msgid "_Postprocessing:"
 msgstr ""
 
 #: avidemux/ADM_videoFilter/ADM_vidDecTelecide.cpp:113
-msgid "Try backward"
+msgid "_Try backward:"
 msgstr ""
 
 #: avidemux/ADM_videoFilter/ADM_vidDecTelecide.cpp:115
-msgid "Direct Threshold"
+msgid "_Direct threshold:"
 msgstr ""
 
 #: avidemux/ADM_videoFilter/ADM_vidDecTelecide.cpp:116
-msgid "Backward Threshold"
+msgid "_Backward threshold:"
 msgstr ""
 
 #: avidemux/ADM_videoFilter/ADM_vidDecTelecide.cpp:117
-msgid "Noise Threshold"
+msgid "_Noise threshold:"
 msgstr ""
 
 #: avidemux/ADM_videoFilter/ADM_vidDecTelecide.cpp:118
-msgid "Post Proc Threshold"
+msgid "Postp_rocessing threshold:"
 msgstr ""
 
 #: avidemux/ADM_videoFilter/ADM_vidDecTelecide.cpp:120
-msgid "Use Chroma to decide"
+msgid "_Use chroma to decide"
 msgstr ""
 
 #: avidemux/ADM_videoFilter/ADM_vidDecTelecide.cpp:121
-msgid "Show info"
+msgid "Sho_w info"
 msgstr ""
 
 #: avidemux/ADM_videoFilter/ADM_vidDecTelecide.cpp:122
-msgid "Debug"
+msgid "Debu_g"
 msgstr ""
 
 #: avidemux/ADM_videoFilter/ADM_vidDecTelecide.cpp:123
-msgid "Blend"
+msgid "Bl_end"
 msgstr ""
 
-#: avidemux/ADM_videoFilter/ADM_vidDenoise.cpp:386
-msgid "_Luma lock:"
+#: avidemux/ADM_videoFilter/ADM_vidYadif.cpp:171
+msgid "Temporal & spatial check"
 msgstr ""
 
-#: avidemux/ADM_videoFilter/ADM_vidDenoise.cpp:387
-msgid "C_hroma lock:"
+#: avidemux/ADM_videoFilter/ADM_vidYadif.cpp:172
+msgid "Bob, temporal & spatial check"
 msgstr ""
 
-#: avidemux/ADM_videoFilter/ADM_vidDenoise.cpp:388
-msgid "L_uma threshold:"
+#: avidemux/ADM_videoFilter/ADM_vidYadif.cpp:173
+msgid "Skip spatial temporal check"
 msgstr ""
 
-#: avidemux/ADM_videoFilter/ADM_vidDenoise.cpp:389
-msgid "Ch_roma threshold:"
+#: avidemux/ADM_videoFilter/ADM_vidYadif.cpp:174
+msgid "Bob, skip spatial temporal check"
 msgstr ""
 
-#: avidemux/ADM_videoFilter/ADM_vidDenoise.cpp:391
-msgid "_Scene change:"
+#: avidemux/ADM_videoFilter/ADM_vidYadif.cpp:182
+msgid "_Order:"
 msgstr ""
 
-#: avidemux/ADM_videoFilter/ADM_vidDGbob.cpp:85
-msgid "Keep nb of frames and fps"
+#: avidemux/ADM_videoFilter/ADM_vidHardIvtcRemoval.cpp:88
+msgid ""
+"If value is smaller than threshold it is considered valid. Smaller value "
+"might mean more false positive"
 msgstr ""
 
-#: avidemux/ADM_videoFilter/ADM_vidDGbob.cpp:86
-msgid "Double nb of frames and fps"
+#: avidemux/ADM_videoFilter/ADM_vidHardIvtcRemoval.cpp:91
+msgid "_Identical:"
 msgstr ""
 
-#: avidemux/ADM_videoFilter/ADM_vidDGbob.cpp:87
-msgid "Double nb of frames (slow motion)"
+#: avidemux/ADM_filter/filter_saveload.cpp:157
+msgid "Problem reading XML filters"
 msgstr ""
 
-#: avidemux/ADM_videoFilter/ADM_vidDGbob.cpp:90
-#: avidemux/ADM_videoFilter/ADM_vidKernelDeint.cpp:92
-msgid "_Field order:"
+#: avidemux/ADM_filter/filter_saveload.cpp:165
+msgid "No filter found"
 msgstr ""
 
-#: avidemux/ADM_videoFilter/ADM_vidDGbob.cpp:91
-#: avidemux/ADM_videoFilter/ADM_vidMcDeint.cpp:113
-msgid "_Mode:"
+#: avidemux/ADM_filter/filter_saveload.cpp:201
+msgid "Could not find a filter"
 msgstr ""
 
-#: avidemux/ADM_videoFilter/ADM_vidDGbob.cpp:92
-#: avidemux/ADM_videoFilter/ADM_vidHardIvtcRemoval.cpp:87
-#: avidemux/ADM_videoFilter/ADM_vidKernelDeint.cpp:93
-#: avidemux/ADM_videoFilter/ADM_vidMSharpen.cpp:166
-msgid "_Threshold:"
+#: avidemux/ADM_filter/filter_saveload.cpp:209
+msgid "No tag found"
 msgstr ""
 
-#: avidemux/ADM_videoFilter/ADM_vidDGbob.cpp:93
-msgid "_Extra"
+#: avidemux/ADM_filter/filter_saveload.cpp:289
+msgid "Node not found"
 msgstr ""
 
-#: avidemux/ADM_videoFilter/ADM_vidDGbob.cpp:93
-msgid "Extra check, avoid using it"
+#: avidemux/ADM_editor/ADM_edit.cpp:407
+msgid "File type identified but no loader support detected..."
 msgstr ""
 
-#: avidemux/ADM_videoFilter/ADM_vidDropOut.cpp:63
-msgid "DropOut Threshold"
+#: avidemux/ADM_editor/ADM_edit.cpp:408
+msgid "May be related to an old index file."
 msgstr ""
 
-#: avidemux/ADM_videoFilter/ADM_vidFade.cpp:65
-msgid "Out"
+#: avidemux/ADM_editor/ADM_edit.cpp:415
+#, c-format
+msgid "Attempt to open %s failed!"
 msgstr ""
 
-#: avidemux/ADM_videoFilter/ADM_vidFade.cpp:65
-msgid "Fade out"
+#: avidemux/ADM_editor/ADM_edit.cpp:439
+msgid ""
+"You cannot mix different video dimensions yet. Using the partial video "
+"filter later, will not work around this problem. The workaround is:\n"
+"1.) \"resize\" / \"add border\" / \"crop\" each stream to the same "
+"resolution\n"
+"2.) concatinate them together"
 msgstr ""
 
-#: avidemux/ADM_videoFilter/ADM_vidFade.cpp:65
-msgid "In"
+#: avidemux/ADM_editor/ADM_edit.cpp:551
+msgid "Build Time Map"
 msgstr ""
 
-#: avidemux/ADM_videoFilter/ADM_vidFade.cpp:65
-msgid "Fade in"
+#: avidemux/ADM_editor/ADM_edit.cpp:551
+msgid "Build VBR time map?"
 msgstr ""
 
-#: avidemux/ADM_videoFilter/ADM_vidFade.cpp:71
-msgid "_Fade type:"
+#: avidemux/ADM_editor/ADM_edit.cpp:585
+msgid "Use that mode"
 msgstr ""
 
-#: avidemux/ADM_videoFilter/ADM_vidFade.cpp:72
-msgid "_Start frame:"
+#: avidemux/ADM_editor/ADM_edit.cpp:585
+msgid "H264 detected"
 msgstr ""
 
-#: avidemux/ADM_videoFilter/ADM_vidFade.cpp:73
-msgid "_End frame:"
+#: avidemux/ADM_editor/ADM_edit.cpp:585
+msgid ""
+"If the file is using bframe as reference, it can lead to crash or "
+"stutteting.\n"
+"Avidemux can use another mode which is safed but <b>YOU WILL LOOSE FRAME "
+"ACCURACY</b>.\n"
+"Do you want to use that mode ?"
 msgstr ""
 
-#: avidemux/ADM_videoFilter/ADM_vidFade.cpp:74
-msgid "Fade to _black"
+#: avidemux/ADM_editor/ADM_edit.cpp:712
+msgid "Packed Bitstream detected"
 msgstr ""
 
-#: avidemux/ADM_videoFilter/ADM_vidFade.cpp:83
-msgid "Parameter Error"
+#: avidemux/ADM_editor/ADM_edit.cpp:713
+msgid "Do you want me to unpack it ?"
 msgstr ""
 
-#: avidemux/ADM_videoFilter/ADM_vidFade.cpp:83
-msgid "Start must be before end, and both within video # of frames."
+#: avidemux/ADM_editor/ADM_edit.cpp:733
+msgid "Could not unpack the video"
 msgstr ""
 
-#: avidemux/ADM_videoFilter/ADM_vidForcedPP.cpp:61
-msgid "_Quantizer:"
+#: avidemux/ADM_editor/ADM_edit.cpp:733
+msgid "Using backup decoder - not frame accurate."
 msgstr ""
 
-#: avidemux/ADM_videoFilter/ADM_vidHardIvtcRemoval.cpp:90
-msgid "_Noise:"
+#: avidemux/ADM_editor/ADM_edit.cpp:738
+msgid "Weird"
 msgstr ""
 
-#: avidemux/ADM_videoFilter/ADM_vidHardIvtcRemoval.cpp:90
-msgid "If pixels are closer than noise, they are considered to be the same"
+#: avidemux/ADM_editor/ADM_edit.cpp:738
+msgid "The unpacking succeedeed but the index is still not up to date."
 msgstr ""
 
-#: avidemux/ADM_videoFilter/ADM_vidHardIvtcRemoval.cpp:91
-msgid "_Identical:"
+#: avidemux/ADM_editor/ADM_edit.cpp:744
+msgid "Troubles ahead"
 msgstr ""
 
-#: avidemux/ADM_videoFilter/ADM_vidHardIvtcRemoval.cpp:92
-msgid "_Show metrics"
+#: avidemux/ADM_editor/ADM_edit.cpp:744
+msgid "This a VOP packed AVI."
 msgstr ""
 
-#: avidemux/ADM_videoFilter/ADM_vidKernelDeint.cpp:93
-msgid "Smaller means more deinterlacing"
+#: avidemux/ADM_editor/ADM_edit.cpp:755
+msgid "Index is not up to date"
 msgstr ""
 
-#: avidemux/ADM_videoFilter/ADM_vidKernelDeint.cpp:94
-msgid "_Sharp"
+#: avidemux/ADM_editor/ADM_edit.cpp:755
+msgid "You should use Tool->Rebuild frame. Do it now ?"
 msgstr ""
 
-#: avidemux/ADM_videoFilter/ADM_vidKernelDeint.cpp:94
-msgid "_Sharper engine:"
+#: avidemux/ADM_editor/ADM_edit.cpp:1510
+msgid ""
+"This looks like mpeg\n"
+" Do you want to index it?"
 msgstr ""
 
-#: avidemux/ADM_videoFilter/ADM_vidKernelDeint.cpp:95
-msgid "T_woway"
+#: avidemux/ADM_editor/ADM_edit.cpp:1562
+msgid "Indexing failed"
 msgstr ""
 
-#: avidemux/ADM_videoFilter/ADM_vidKernelDeint.cpp:95
-msgid "Extrapolate better (better not to use it)"
+#: avidemux/ADM_editor/ADM_edLoadSave.cpp:75
+msgid "Unsupported"
 msgstr ""
 
-#: avidemux/ADM_videoFilter/ADM_vidKernelDeint.cpp:96
-msgid "_Map"
+#: avidemux/ADM_editor/ADM_edLoadSave.cpp:301
+msgid "Old format project file"
 msgstr ""
 
-#: avidemux/ADM_videoFilter/ADM_vidKernelDeint.cpp:96
-msgid "Show interlaced areas (for test!)"
+#: avidemux/ADM_editor/ADM_edLoadSave.cpp:301
+msgid "No more supported."
 msgstr ""
 
-#: avidemux/ADM_videoFilter/ADM_vidMcDeint.cpp:104
-msgid "Fast"
+#: avidemux/ADM_editor/ADM_outputfmt.h:39
+msgid "AVI, dual audio"
 msgstr ""
 
-#: avidemux/ADM_videoFilter/ADM_vidMcDeint.cpp:105
-msgid "Medium"
+#: avidemux/ADM_editor/ADM_outputfmt.h:40
+msgid "AVI, pack VOP"
 msgstr ""
 
-#: avidemux/ADM_videoFilter/ADM_vidMcDeint.cpp:106
-msgid "Slow iterative motion search"
+#: avidemux/ADM_editor/ADM_outputfmt.h:41
+msgid "AVI, unpack VOP"
 msgstr ""
 
-#: avidemux/ADM_videoFilter/ADM_vidMcDeint.cpp:107
-msgid "Extra slow (same as 3+multiple reference frames)"
+#: avidemux/ADM_editor/ADM_outputfmt.h:42
+msgid "MPEG-PS (A+V)"
 msgstr ""
 
-#: avidemux/ADM_videoFilter/ADM_vidMcDeint.cpp:114
-msgid "_Field dominance:"
+#: avidemux/ADM_editor/ADM_outputfmt.h:43
+msgid "MPEG-TS (A+V)"
 msgstr ""
 
-#: avidemux/ADM_videoFilter/ADM_vidMcDeint.cpp:115
-msgid "_Qp:"
+#: avidemux/ADM_editor/ADM_outputfmt.h:44
+msgid "MPEG video"
 msgstr ""
 
-#: avidemux/ADM_videoFilter/ADM_vidMosaic.cpp:90
-msgid "_Horizontal stacking:"
+#: avidemux/ADM_editor/ADM_outputfmt.h:45
+msgid "MP4"
 msgstr ""
 
-#: avidemux/ADM_videoFilter/ADM_vidMosaic.cpp:91
-msgid "_Vertical stacking:"
+#: avidemux/ADM_editor/ADM_outputfmt.h:47
+msgid "PSP"
 msgstr ""
 
-#: avidemux/ADM_videoFilter/ADM_vidMosaic.cpp:92
-msgid "_Shrink factor:"
+#: avidemux/ADM_editor/ADM_edFrameType.cpp:58
+msgid "No video loaded"
 msgstr ""
 
-#: avidemux/ADM_videoFilter/ADM_vidMosaic.cpp:93
-msgid "Show _frame"
+#: avidemux/ADM_editor/ADM_edFrameType.cpp:63
+msgid "Not indexable"
 msgstr ""
 
-#: avidemux/ADM_videoFilter/ADM_vidMPLD3D.cpp:74
-#: avidemux/ADM_videoFilter/ADM_vidMPLD3Dlow.cpp:74
-msgid "_Spatial luma strength:"
+#: avidemux/ADM_editor/ADM_edFrameType.cpp:63
+msgid "DivX 5 + packed?"
 msgstr ""
 
-#: avidemux/ADM_videoFilter/ADM_vidMPLD3D.cpp:75
-#: avidemux/ADM_videoFilter/ADM_vidMPLD3Dlow.cpp:75
-msgid "S_patial chroma strength:"
+#: avidemux/ADM_editor/ADM_edFrameType.cpp:93
+msgid "Rebuilding Frames"
 msgstr ""
 
-#: avidemux/ADM_videoFilter/ADM_vidMPLD3D.cpp:76
-#: avidemux/ADM_videoFilter/ADM_vidMPLD3Dlow.cpp:76
-msgid "_Temporal strength:"
+#: avidemux/ADM_editor/ADM_edFrameType.cpp:129
+msgid "Aborted"
 msgstr ""
 
-#: avidemux/ADM_videoFilter/ADM_vidMSharpen.cpp:163
-msgid "_Mask"
+#: avidemux/ADM_codecs/ADM_ffmp43.cpp:52
+msgid "Internal error finding codec"
 msgstr ""
 
-#: avidemux/ADM_videoFilter/ADM_vidMSharpen.cpp:164
-msgid "_High Q"
+#: avidemux/ADM_codecs/ADM_ffmpeg.cpp:53
+msgid "Internal error opening codec"
 msgstr ""
 
-#: avidemux/ADM_videoFilter/ADM_vidMSharpen.cpp:167
-msgid "_Strength:"
+#: avidemux/ADM_codecs/ADM_ffmpeg.cpp:55
+msgid "Internal error with context for  codec"
 msgstr ""
 
-#: avidemux/ADM_videoFilter/ADM_vidPalShift.cpp:76
-msgid "Try reverse"
+#: avidemux/ADM_audio/audiotimeline.cpp:83
+#: avidemux/ADM_audio/audiotimeline.cpp:94
+msgid "Building VBR map"
 msgstr ""
 
-#: avidemux/ADM_videoFilter/ADM_vidResampleFPS.cpp:85
-msgid "_New frame rate:"
+#: avidemux/ADM_script/ADM_JSFunctions.cpp:236
+msgid "Select a directory"
 msgstr ""
 
-#: avidemux/ADM_videoFilter/ADM_vidResampleFPS.cpp:86
-msgid "_Blend"
+#: avidemux/ADM_script/ADM_JSFunctions.cpp:502
+msgid "Uinteger"
 msgstr ""
 
-#: avidemux/ADM_videoFilter/ADM_vidRotate.cpp:265
-msgid "90 degrees"
+#: avidemux/ADM_script/ADM_JSFunctions.cpp:517
+msgid "Float"
 msgstr ""
 
-#: avidemux/ADM_videoFilter/ADM_vidRotate.cpp:265
-msgid "90?"
+#: avidemux/ADM_script/ADM_JSFunctions.cpp:535
+msgid "Toggle"
 msgstr ""
 
-#: avidemux/ADM_videoFilter/ADM_vidRotate.cpp:266
-msgid "180 degrees"
+#: avidemux/ADM_script/ADM_JSFunctions.cpp:556
+msgid "No Strategy"
 msgstr ""
 
-#: avidemux/ADM_videoFilter/ADM_vidRotate.cpp:266
-msgid "180?"
+#: avidemux/ADM_script/ADM_JSFunctions.cpp:557
+msgid "3:2 Pulldown"
 msgstr ""
 
-#: avidemux/ADM_videoFilter/ADM_vidRotate.cpp:267
-msgid "270 degrees"
+#: avidemux/ADM_script/ADM_JSFunctions.cpp:558
+msgid "Pal/Secam"
 msgstr ""
 
-#: avidemux/ADM_videoFilter/ADM_vidRotate.cpp:267
-msgid "270?"
+#: avidemux/ADM_script/ADM_JSFunctions.cpp:561
+msgid "menu"
 msgstr ""
 
-#: avidemux/ADM_videoFilter/ADM_vidRotate.cpp:269
-msgid "Angle"
+#: avidemux/ADM_video/ADM_vidFieldUnblend.cpp:81
+msgid "Metrics"
 msgstr ""
 
-#: avidemux/ADM_videoFilter/ADM_vidRotate.cpp:271
-msgid "Rotate Params"
+#: avidemux/ADM_video/ADM_vidFieldUnblend.cpp:81
+msgid "Do you want to print metrics on screen ?"
 msgstr ""
 
-#: avidemux/ADM_videoFilter/ADM_vidSoften.cpp:68
-msgid "_Luma threshold:"
+#: avidemux/ADM_video/ADM_vidSRT.cpp:215
+msgid "Could not open subtitle file"
 msgstr ""
 
-#: avidemux/ADM_videoFilter/ADM_vidSoften.cpp:69
-msgid "C_hroma threshold:"
+#: avidemux/ADM_video/ADM_vidSRT.cpp:235
+msgid "Cannot identify subtitle format"
 msgstr ""
 
-#: avidemux/ADM_videoFilter/ADM_vidSoften.cpp:70
-msgid "_Radius:"
+#: avidemux/ADM_audiodevice/ADM_deviceoss.cpp:118
+msgid "Could not open OSS audio device"
 msgstr ""
 
-#: avidemux/ADM_videoFilter/ADM_vidStabilize.cpp:63
-msgid "Stabilize Threshold"
+#: avidemux/ADM_audiodevice/ADM_deviceoss.cpp:118
+msgid "Check the permissions for /dev/dsp."
 msgstr ""
 
-#: avidemux/ADM_videoFilter/ADM_vidVlad.cpp:101
-msgid "Luma Temporal Threshold"
+#: avidemux/ADM_ocr/adm_glyph.cpp:173
+msgid "Could not write the file"
 msgstr ""
 
-#: avidemux/ADM_videoFilter/ADM_vidVlad.cpp:102
-msgid "Chroma Temporal Threshold"
+#: avidemux/ADM_ocr/adm_glyph.cpp:221
+#, possible-c-format
+msgid "Could not read \"%s\"."
 msgstr ""
 
-#: avidemux/ADM_videoFilter/ADM_vidYadif.cpp:171
-msgid "Temporal & Spatial check"
+#: avidemux/ADM_ocr/ADM_vob2vobsub.cpp:254
+msgid "Ifo error"
 msgstr ""
 
-#: avidemux/ADM_videoFilter/ADM_vidYadif.cpp:172
-msgid "Bob, T+S check"
+#: avidemux/ADM_ocr/ADM_vob2vobsub.cpp:254
+msgid "Error reading ifo file, aborting."
 msgstr ""
 
-#: avidemux/ADM_videoFilter/ADM_vidYadif.cpp:173
-msgid "Skip spatial temporal check"
+#: avidemux/ADM_ocr/ADM_vob2vobsub.cpp:262
+msgid "Cannot write .idx"
 msgstr ""
 
-#: avidemux/ADM_videoFilter/ADM_vidYadif.cpp:174
-msgid "Bob, Skip spatial temporal check"
+#: avidemux/ADM_ocr/ADM_vob2vobsub.cpp:275
+msgid "Cannot write .sub"
 msgstr ""
 
-#: avidemux/ADM_videoFilter/ADM_vidYadif.cpp:177
-msgid "Bottom Field first"
+#: avidemux/ADM_ocr/ADM_vob2vobsub.cpp:287
+msgid "Problem opening the mpeg files"
 msgstr ""
 
-#: avidemux/ADM_videoFilter/ADM_vidYadif.cpp:182
-msgid "Order"
+#: avidemux/ADM_ocr/ADM_vob2vobsub.cpp:300
+msgid "Generating VobSub file"
 msgstr ""
 
-#: avidemux/gtk_gui.cpp:243
-msgid "Select ecmascript to run "
+#: avidemux/GUI_jobs.cpp:37 avidemux/ADM_osSupport/ADM_fileio.cpp:102
+#: avidemux/ADM_osSupport/ADM_fileio.cpp:126
+#: avidemux/ADM_osSupport/ADM_fileio.cpp:146
+#: avidemux/ADM_osSupport/ADM_fileio.cpp:153
+#: avidemux/ADM_osSupport/ADM_fileio.cpp:164
+msgid "Oops"
 msgstr ""
 
-#: avidemux/gtk_gui.cpp:290 avidemux/gtk_gui.cpp:329
+#: avidemux/GUI_jobs.cpp:37
+msgid "Something very wrong happened when building joblist."
+msgstr ""
+
+#: avidemux/GUI_jobs.cpp:42
+msgid "There are no jobs stored"
+msgstr ""
+
+#: avidemux/gui_navigate.cpp:76 avidemux/gui_navigate.cpp:114
+#: avidemux/gui_navigate.cpp:390 avidemux/gui_navigate.cpp:426
+msgid "Decompressing error"
+msgstr ""
+
+#: avidemux/gui_navigate.cpp:76
+msgid "Cannot decode next frame."
+msgstr ""
+
+#: avidemux/gui_navigate.cpp:114 avidemux/gui_navigate.cpp:426
+msgid "Cannot decode keyframe."
+msgstr ""
+
+#: avidemux/gui_navigate.cpp:237
+msgid "Seeking"
+msgstr ""
+
+#: avidemux/gui_navigate.cpp:315
+msgid "Finding black frames"
+msgstr ""
+
+#: avidemux/gui_navigate.cpp:390
+msgid "Cannot decode the frame."
+msgstr ""
+
+#: avidemux/gui_autodrive.cpp:52
+msgid "No audio track"
+msgstr ""
+
+#: avidemux/gui_autodrive.cpp:52
+msgid "An audio track is necessary to create such file"
+msgstr ""
+
+#: avidemux/gui_autodrive.cpp:82
+msgid "Cannot select mpeg4 sp codec."
+msgstr ""
+
+#: avidemux/gui_autodrive.cpp:117
+msgid ""
+"You don't have FAAC!.\n"
+"It is needed to create PSP compatible video."
+msgstr ""
+
+#: avidemux/gui_savenew.cpp:87
+msgid "Dual audio can only be used in copy mode"
+msgstr ""
+
+#: avidemux/gui_savenew.cpp:87
+msgid "Select Copy as the video codec."
+msgstr ""
+
+#: avidemux/gui_savenew.cpp:197 avidemux/gui_savenew.cpp:213
+#: avidemux/gui_savenew.cpp:226
+msgid "Incompatible output format"
+msgstr ""
+
+#: avidemux/gui_savenew.cpp:244
+msgid "There is no second track"
+msgstr ""
+
+#: avidemux/gui_savenew.cpp:244
+msgid "Select a second audio track in the Audio menu."
+msgstr ""
+
+#: avidemux/gui_savenew.cpp:248
+msgid "Select dual audio AVI to write"
+msgstr ""
+
+#: avidemux/gui_savenew.cpp:270 avidemux/gui_savenew.cpp:288
+msgid "This cannot have packed VOP"
+msgstr ""
+
+#: avidemux/gui_savenew.cpp:270 avidemux/gui_savenew.cpp:288
+msgid "It is not MPEG-4 video. File will not be saved."
+msgstr ""
+
+#: avidemux/gui_savenew.cpp:334
+msgid ""
+"You may need smart copy.\n"
+" Enable it ?"
+msgstr ""
+
+#: avidemux/guiplay.cpp:361
+msgid "Trouble initializing audio device"
+msgstr ""
+
+#: avidemux/gtk_gui.cpp:252
+msgid "Select ECMAScript to Run"
+msgstr ""
+
+#: avidemux/gtk_gui.cpp:299 avidemux/gtk_gui.cpp:338
 msgid "Obsolete"
 msgstr ""
 
-#: avidemux/gtk_gui.cpp:357
+#: avidemux/gtk_gui.cpp:366
 msgid "Not coded in this version"
 msgstr ""
 
-#: avidemux/gtk_gui.cpp:370 avidemux/gtk_gui.cpp:375 avidemux/gtk_gui.cpp:487
-#: avidemux/gtk_gui.cpp:490
-msgid "Select AVI file..."
+#: avidemux/gtk_gui.cpp:381 avidemux/gtk_gui.cpp:386 avidemux/gtk_gui.cpp:505
+#: avidemux/gtk_gui.cpp:508
+msgid "Select AVI File..."
 msgstr ""
 
-#: avidemux/gtk_gui.cpp:423
+#: avidemux/gtk_gui.cpp:441
 msgid ""
-"This is to be used to undo packed vop on mpeg4.\n"
+"This is to be used to undo packed VOP on MPEG-4.\n"
 "Continue ?"
 msgstr ""
 
-#: avidemux/gtk_gui.cpp:425
-msgid "Select Avi file to write"
+#: avidemux/gtk_gui.cpp:443
+msgid "Select AVI File to Write"
 msgstr ""
 
-#: avidemux/gtk_gui.cpp:431
-msgid "Select OGM file to write"
+#: avidemux/gtk_gui.cpp:449
+msgid "Select OGM File to Write"
 msgstr ""
 
-#: avidemux/gtk_gui.cpp:442 avidemux/gtk_gui.cpp:453
-msgid "Select workbench to save "
+#: avidemux/gtk_gui.cpp:460 avidemux/gtk_gui.cpp:471
+msgid "Select Workbench to Save"
 msgstr ""
 
-#: avidemux/gtk_gui.cpp:477
-msgid "Select raw file to save "
+#: avidemux/gtk_gui.cpp:495
+msgid "Select Raw File to Save"
 msgstr ""
 
-#: avidemux/gtk_gui.cpp:493
-msgid "Select AVI file to append..."
+#: avidemux/gtk_gui.cpp:511
+msgid "Select AVI File to Append..."
 msgstr ""
 
-#: avidemux/gtk_gui.cpp:497
-msgid "Select file to save audio"
+#: avidemux/gtk_gui.cpp:515
+msgid "Select File to Save Audio"
 msgstr ""
 
-#: avidemux/gtk_gui.cpp:531
-msgid "Select Jpeg sequence to save "
+#: avidemux/gtk_gui.cpp:549
+msgid "Select JPEG Sequence to Save"
 msgstr ""
 
-#: avidemux/gtk_gui.cpp:534
-msgid "Select BMP to save "
+#: avidemux/gtk_gui.cpp:552
+msgid "Select BMP to Save"
 msgstr ""
 
-#: avidemux/gtk_gui.cpp:538
-msgid "Select Jpeg to save "
+#: avidemux/gtk_gui.cpp:556
+msgid "Select JPEG to Save"
 msgstr ""
 
-#: avidemux/gtk_gui.cpp:591
-msgid "Select file to save"
+#: avidemux/gtk_gui.cpp:609 avidemux/gtk_gui.cpp:713
+msgid "Select File to Save"
 msgstr ""
 
-#: avidemux/gtk_gui.cpp:643
-msgid "Select MP3 to load "
+#: avidemux/gtk_gui.cpp:653
+msgid "Select MP3 to Load"
 msgstr ""
 
-#: avidemux/gtk_gui.cpp:646
-msgid "Select AC3 to load "
+#: avidemux/gtk_gui.cpp:656
+msgid "Select AC3 to Load"
 msgstr ""
 
-#: avidemux/gtk_gui.cpp:649
-msgid "Select WAV to load "
+#: avidemux/gtk_gui.cpp:659
+msgid "Select WAV to Load"
 msgstr ""
 
-#: avidemux/gtk_gui.cpp:697
+#: avidemux/gtk_gui.cpp:707
 msgid "Out of bounds"
 msgstr ""
 
-#: avidemux/gtk_gui.cpp:703
-msgid "Select  file to save "
-msgstr ""
-
-#: avidemux/gtk_gui.cpp:708 avidemux/gtk_gui.cpp:1913
+#: avidemux/gtk_gui.cpp:718 avidemux/gtk_gui.cpp:1921
 msgid "Marker A > B"
 msgstr ""
 
-#: avidemux/gtk_gui.cpp:708
+#: avidemux/gtk_gui.cpp:718
 msgid "Cannot copy."
 msgstr ""
 
-#: avidemux/gtk_gui.cpp:720
+#: avidemux/gtk_gui.cpp:730
 msgid "Something bad happened (II))"
 msgstr ""
 
-#: avidemux/gtk_gui.cpp:734
-msgid "Are you sure ?"
+#: avidemux/gtk_gui.cpp:744
+msgid "Are you sure?"
 msgstr ""
 
-#: avidemux/gtk_gui.cpp:812
+#: avidemux/gtk_gui.cpp:799
+msgid "Frame Rate"
+msgstr ""
+
+#: avidemux/gtk_gui.cpp:799
+msgid "_Frames per second:"
+msgstr ""
+
+#: avidemux/gtk_gui.cpp:822
 msgid "Width is not a multiple of 8"
 msgstr ""
 
-#: avidemux/gtk_gui.cpp:813
-msgid "This will make trouble for avi files."
+#: avidemux/gtk_gui.cpp:823
+msgid "This will make trouble for AVI files."
 msgstr ""
 
-#: avidemux/gtk_gui.cpp:823
+#: avidemux/gtk_gui.cpp:833
 msgid "Rebuild all Keyframes?"
 msgstr ""
 
-#: avidemux/gtk_gui.cpp:877
+#: avidemux/gtk_gui.cpp:891
 msgid "Permission error"
 msgstr ""
 
-#: avidemux/gtk_gui.cpp:880
+#: avidemux/gtk_gui.cpp:894
 #, possible-c-format
 msgid "\"%s\" does not exist."
 msgstr ""
 
-#: avidemux/gtk_gui.cpp:940
+#: avidemux/gtk_gui.cpp:936
 msgid "Cannot open project using the video loader."
 msgstr ""
 
-#: avidemux/gtk_gui.cpp:941
+#: avidemux/gtk_gui.cpp:937
 msgid "Try 'File' -> 'Load/Run Project...'"
 msgstr ""
 
-#: avidemux/gtk_gui.cpp:943
+#: avidemux/gtk_gui.cpp:939
 msgid "Could not open the file"
 msgstr ""
 
-#: avidemux/gtk_gui.cpp:978
+#: avidemux/gtk_gui.cpp:974
 msgid "Multiple Audio Tracks"
 msgstr ""
 
-#: avidemux/gtk_gui.cpp:978
+#: avidemux/gtk_gui.cpp:974
 msgid ""
 "The file you just loaded contains several audio tracks.\n"
 "Go to Audio->MainTrack to select the active one."
 msgstr ""
 
-#: avidemux/gtk_gui.cpp:1068
+#: avidemux/gtk_gui.cpp:1064
 msgid "No audio decoder found for this file"
 msgstr ""
 
-#: avidemux/gtk_gui.cpp:1069
+#: avidemux/gtk_gui.cpp:1065
 msgid "Save (A+V) will generate bad AVI. Save audio will work."
 msgstr ""
 
-#: avidemux/gtk_gui.cpp:1125
+#: avidemux/gtk_gui.cpp:1121
 msgid "Something failed when appending"
 msgstr ""
 
-#: avidemux/gtk_gui.cpp:1134 avidemux/gtk_gui.cpp:1932
+#: avidemux/gtk_gui.cpp:1130 avidemux/gtk_gui.cpp:1940
 msgid "Something bad happened (II)"
 msgstr ""
 
-#: avidemux/gtk_gui.cpp:1198
+#: avidemux/gtk_gui.cpp:1194
 msgid "Cannot save the audio in copy mode"
 msgstr ""
 
-#: avidemux/gtk_gui.cpp:1198
+#: avidemux/gtk_gui.cpp:1194
 msgid ""
 "Select WAV PCM as the audio codec, otherwise the audio file would be raw PCM."
 msgstr ""
 
-#: avidemux/gtk_gui.cpp:1206 avidemux/gtk_gui.cpp:1562
+#: avidemux/gtk_gui.cpp:1202 avidemux/gtk_gui.cpp:1562
 msgid "Saving audio"
 msgstr ""
 
-#: avidemux/gtk_gui.cpp:1283
+#: avidemux/gtk_gui.cpp:1279
 msgid "Get Frame"
 msgstr ""
 
-#: avidemux/gtk_gui.cpp:1283
+#: avidemux/gtk_gui.cpp:1279
 msgid "Cannot get this frame to save"
 msgstr ""
 
-#: avidemux/gtk_gui.cpp:1320
+#: avidemux/gtk_gui.cpp:1316
 msgid "Mark A > B"
 msgstr ""
 
-#: avidemux/gtk_gui.cpp:1320
+#: avidemux/gtk_gui.cpp:1316
 msgid "Set your markers correctly."
 msgstr ""
 
-#: avidemux/gtk_gui.cpp:1329
+#: avidemux/gtk_gui.cpp:1325
 msgid "Saving as set of jpegs"
 msgstr ""
 
-#: avidemux/gtk_gui.cpp:1335
+#: avidemux/gtk_gui.cpp:1331
 msgid "Cannot decode frame"
 msgstr ""
 
-#: avidemux/gtk_gui.cpp:1335
+#: avidemux/gtk_gui.cpp:1331
 msgid "Aborting."
 msgstr ""
 
-#: avidemux/gtk_gui.cpp:1346 avidemux/gtk_gui.cpp:1365
-#: avidemux/gtk_gui.cpp:2276
+#: avidemux/gtk_gui.cpp:1342 avidemux/gtk_gui.cpp:1361
+#: avidemux/gtk_gui.cpp:2284
 msgid "Done"
 msgstr ""
 
-#: avidemux/gtk_gui.cpp:1346
+#: avidemux/gtk_gui.cpp:1342
 #, possible-c-format
 msgid "Saved %d images."
 msgstr ""
 
-#: avidemux/gtk_gui.cpp:1348
+#: avidemux/gtk_gui.cpp:1344
 msgid "Error"
 msgstr ""
 
-#: avidemux/gtk_gui.cpp:1348
+#: avidemux/gtk_gui.cpp:1344
 msgid "Could not save all images."
 msgstr ""
 
-#: avidemux/gtk_gui.cpp:1365
+#: avidemux/gtk_gui.cpp:1361
 #, possible-c-format
 msgid "Saved \"%s\"."
 msgstr ""
 
-#: avidemux/gtk_gui.cpp:1367
+#: avidemux/gtk_gui.cpp:1363
 msgid "BMP op failed"
 msgstr ""
 
-#: avidemux/gtk_gui.cpp:1367
+#: avidemux/gtk_gui.cpp:1363
 #, possible-c-format
 msgid "Saving %s as a BMP file failed."
 msgstr ""
 
-#: avidemux/gtk_gui.cpp:1387 avidemux/gtk_gui.cpp:1453
+#: avidemux/gtk_gui.cpp:1383 avidemux/gtk_gui.cpp:1449
 msgid "Failed to open the file"
 msgstr ""
 
-#: avidemux/gtk_gui.cpp:1387 avidemux/gtk_gui.cpp:1453
+#: avidemux/gtk_gui.cpp:1383 avidemux/gtk_gui.cpp:1449
 msgid "Not a WAV file?"
 msgstr ""
 
-#: avidemux/gtk_gui.cpp:1388
+#: avidemux/gtk_gui.cpp:1384
 #, c-format
 msgid "WAV open file failed..."
 msgstr ""
 
-#: avidemux/gtk_gui.cpp:1523
+#: avidemux/gtk_gui.cpp:1516
 msgid "Cannot decompress audio frame"
 msgstr ""
 
-#: avidemux/gtk_gui.cpp:1537
+#: avidemux/gtk_gui.cpp:1523
+#: avidemux/ADM_outputs/oplug_mpegFF/oplug_vcdff.cpp:380
+#: avidemux/ADM_outputs/oplug_ogm/op_ogsave.cpp:112
+#: avidemux/ADM_libraries/ADM_utilities/ADM_imageUtils.cpp:481
+#, possible-c-format
+msgid "Cannot open \"%s\" for writing."
+msgstr ""
+
+#: avidemux/gtk_gui.cpp:1530
 msgid "Memory Error"
 msgstr ""
 
@@ -5869,224 +6262,515 @@
 msgid "Please check markers. Is \"A>\" == \">B\"?"
 msgstr ""
 
-#: avidemux/gtk_gui.cpp:1702
+#: avidemux/gtk_gui.cpp:1710
 msgid "Saving raw video stream"
 msgstr ""
 
-#: avidemux/gtk_gui.cpp:1864
+#: avidemux/gtk_gui.cpp:1856
+msgid "Checking video"
+msgstr ""
+
+#: avidemux/gtk_gui.cpp:1872
 msgid "No error found"
 msgstr ""
 
-#: avidemux/gtk_gui.cpp:1868
+#: avidemux/gtk_gui.cpp:1876
 #, c-format
 msgid "Errors found in %u frames"
 msgstr ""
 
-#: avidemux/gtk_gui.cpp:1886
+#: avidemux/gtk_gui.cpp:1894
 msgid "Cannot decompress the audio stream"
 msgstr ""
 
-#: avidemux/gtk_gui.cpp:1886
+#: avidemux/gtk_gui.cpp:1894
 msgid "Switch audio codec to Copy."
 msgstr ""
 
-#: avidemux/gtk_gui.cpp:1913
+#: avidemux/gtk_gui.cpp:1921
 msgid "Cannot delete the selection."
 msgstr ""
 
-#: avidemux/gtk_gui.cpp:1918
+#: avidemux/gtk_gui.cpp:1926
 msgid "You can't remove all frames"
 msgstr ""
 
-#: avidemux/gtk_gui.cpp:1994
+#: avidemux/gtk_gui.cpp:1933
+#: avidemux/ADM_libraries/ADM_utilities/ADM_imageUtils.cpp:417
+msgid "Something bad happened"
+msgstr ""
+
+#: avidemux/gtk_gui.cpp:2002
 msgid "Could not get tracks info"
 msgstr ""
 
-#: avidemux/gtk_gui.cpp:2002
+#: avidemux/gtk_gui.cpp:2010
 msgid "Video"
 msgstr ""
 
-#: avidemux/gtk_gui.cpp:2002
+#: avidemux/gtk_gui.cpp:2010
 msgid "Take audio from video file"
 msgstr ""
 
-#: avidemux/gtk_gui.cpp:2003 avidemux/gtk_gui.cpp:2102
+#: avidemux/gtk_gui.cpp:2011 avidemux/gtk_gui.cpp:2110
 msgid "No audio"
 msgstr ""
 
-#: avidemux/gtk_gui.cpp:2004 avidemux/gtk_gui.cpp:2103
+#: avidemux/gtk_gui.cpp:2012 avidemux/gtk_gui.cpp:2111
 msgid "External AC3"
 msgstr ""
 
-#: avidemux/gtk_gui.cpp:2004 avidemux/gtk_gui.cpp:2103
+#: avidemux/gtk_gui.cpp:2012 avidemux/gtk_gui.cpp:2111
 msgid "Take audio from external AC3 file"
 msgstr ""
 
-#: avidemux/gtk_gui.cpp:2005 avidemux/gtk_gui.cpp:2104
+#: avidemux/gtk_gui.cpp:2013 avidemux/gtk_gui.cpp:2112
 msgid "External MP3"
 msgstr ""
 
-#: avidemux/gtk_gui.cpp:2005 avidemux/gtk_gui.cpp:2104
+#: avidemux/gtk_gui.cpp:2013 avidemux/gtk_gui.cpp:2112
 msgid "Take audio from external MP3 file"
 msgstr ""
 
-#: avidemux/gtk_gui.cpp:2006 avidemux/gtk_gui.cpp:2105
-msgid "External Wav"
+#: avidemux/gtk_gui.cpp:2014 avidemux/gtk_gui.cpp:2113
+msgid "External WAV"
 msgstr ""
 
-#: avidemux/gtk_gui.cpp:2006 avidemux/gtk_gui.cpp:2105
+#: avidemux/gtk_gui.cpp:2014 avidemux/gtk_gui.cpp:2113
 msgid "Take audio from external WAV file"
 msgstr ""
 
-#: avidemux/gtk_gui.cpp:2010 avidemux/gtk_gui.cpp:2110
-msgid "Audio source"
+#: avidemux/gtk_gui.cpp:2018 avidemux/gtk_gui.cpp:2118
+msgid "_Audio source:"
 msgstr ""
 
-#: avidemux/gtk_gui.cpp:2014
-msgid "External filename"
+#: avidemux/gtk_gui.cpp:2022 avidemux/gtk_gui.cpp:2119
+msgid "_External file:"
 msgstr ""
 
-#: avidemux/gtk_gui.cpp:2045 avidemux/gtk_gui.cpp:2123
+#: avidemux/gtk_gui.cpp:2037
+msgid "_Track from video:"
+msgstr ""
+
+#: avidemux/gtk_gui.cpp:2047
+msgid "Main Audio Track"
+msgstr ""
+
+#: avidemux/gtk_gui.cpp:2053 avidemux/gtk_gui.cpp:2131
 msgid "Cannot load"
 msgstr ""
 
-#: avidemux/gtk_gui.cpp:2045 avidemux/gtk_gui.cpp:2123
+#: avidemux/gtk_gui.cpp:2053 avidemux/gtk_gui.cpp:2131
 msgid "The selected audio file does not exist."
 msgstr ""
 
-#: avidemux/gtk_gui.cpp:2111
-msgid "Filename"
+#: avidemux/gtk_gui.cpp:2128
+msgid "Second Audio Track"
 msgstr ""
 
-#: avidemux/gtk_gui.cpp:2120
-msgid "Select 2nd audio Track"
-msgstr ""
-
-#: avidemux/gtk_gui.cpp:2152
+#: avidemux/gtk_gui.cpp:2160
 msgid "Error loading the MP3 file"
 msgstr ""
 
-#: avidemux/gtk_gui.cpp:2161 avidemux/gtk_gui.cpp:2183
-#: avidemux/gtk_gui.cpp:2205
+#: avidemux/gtk_gui.cpp:2169 avidemux/gtk_gui.cpp:2191
+#: avidemux/gtk_gui.cpp:2213
 msgid "Second track loaded"
 msgstr ""
 
-#: avidemux/gtk_gui.cpp:2175
+#: avidemux/gtk_gui.cpp:2183
 msgid "Error loading the AC3 file"
 msgstr ""
 
-#: avidemux/gtk_gui.cpp:2197
+#: avidemux/gtk_gui.cpp:2205
 msgid "Error loading the WAV file"
 msgstr ""
 
-#: avidemux/gtk_gui.cpp:2264
+#: avidemux/gtk_gui.cpp:2272
 msgid "Saving failed"
 msgstr ""
 
-#: avidemux/gtk_gui.cpp:2264
+#: avidemux/gtk_gui.cpp:2272
 msgid "Saving the job failed. Maybe you have permission issue with ~/.avidemux"
 msgstr ""
 
-#: avidemux/gtk_gui.cpp:2276
+#: avidemux/gtk_gui.cpp:2284
 #, possible-c-format
 msgid "File %s has been successfully saved."
 msgstr ""
 
-#: avidemux/gtk_gui.cpp:2280
+#: avidemux/gtk_gui.cpp:2288
 #, possible-c-format
 msgid "File %s was NOT saved correctly."
 msgstr ""
 
-#: avidemux/guiplay.cpp:356
-msgid "Trouble initializing audio device"
+#: avidemux/gtk_gui.cpp:2442
+msgid "AvsProxy"
 msgstr ""
 
-#: avidemux/gui_autodrive.cpp:52
-msgid "No audio track"
+#: avidemux/gtk_gui.cpp:2442
+msgid ""
+"Failed to connect to avsproxy.\n"
+"Is it running ?"
 msgstr ""
 
-#: avidemux/gui_autodrive.cpp:52
-msgid "An audio track is necessary to create such file"
+#: avidemux/gtk_gui.cpp:2447
+msgid "avsproxy"
 msgstr ""
 
-#: avidemux/gui_autodrive.cpp:82
-msgid "Cannot select mpeg4 sp codec."
+#: avidemux/gtk_gui.cpp:2475
+msgid "Frame type:"
 msgstr ""
 
-#: avidemux/gui_autodrive.cpp:117
+#: avidemux/gtk_gui.cpp:2476
+msgid "Frame size:"
+msgstr ""
+
+#: avidemux/gtk_gui.cpp:2478
+msgid "Frame Hex Dump"
+msgstr ""
+
+#: avidemux/ADM_osSupport/ADM_misc.cpp:215
+#, c-format
+msgid "%lu minutes"
+msgstr ""
+
+#: avidemux/ADM_osSupport/ADM_misc.cpp:219
+#, c-format
+msgid "%lu minute"
+msgstr ""
+
+#: avidemux/ADM_osSupport/ADM_misc.cpp:227
+#, c-format
+msgid "%lu second"
+msgstr ""
+
+#: avidemux/ADM_osSupport/ADM_misc.cpp:231
+#, c-format
+msgid "%lu seconds"
+msgstr ""
+
+#: avidemux/ADM_osSupport/ADM_crashdump.cpp:200
+#: avidemux/ADM_osSupport/ADM_crashdump.cpp:224
+msgid "Fatal Error"
+msgstr ""
+
+#: avidemux/ADM_osSupport/ADM_crashdump.cpp:200
+#: avidemux/ADM_osSupport/ADM_crashdump.cpp:224
 msgid ""
-"You don't have FAAC!.\n"
-"It is needed to create PSP compatible video."
+"A fatal error has occurred.\n"
+"\n"
+"Click OK to generate debug information. This may take a few minutes to "
+"complete."
 msgstr ""
 
-#: avidemux/GUI_jobs.cpp:37
-msgid "Something very wrong happened when buildint joblist"
+#: avidemux/ADM_osSupport/ADM_crashdump.cpp:423
+msgid "Load it"
 msgstr ""
 
-#: avidemux/GUI_jobs.cpp:42
-msgid "Nothing to do."
+#: avidemux/ADM_osSupport/ADM_crashdump.cpp:423
+msgid "Crash file"
 msgstr ""
 
-#: avidemux/GUI_jobs.cpp:42
-msgid "There is no jobs stored, nothing to do"
+#: avidemux/ADM_osSupport/ADM_crashdump.cpp:424
+msgid ""
+"I have detected a crash file. \n"
+"Do you want to load it  ?\n"
+"(It will be deleted in all cases, you should save it if you want to keep it)"
 msgstr ""
 
-#: avidemux/gui_navigate.cpp:75 avidemux/gui_navigate.cpp:113
-#: avidemux/gui_navigate.cpp:389 avidemux/gui_navigate.cpp:425
-msgid "Decompressing error"
+#: avidemux/ADM_osSupport/ADM_fileio.cpp:102
+#, possible-c-format
+msgid "can't create custom directory (%s)."
 msgstr ""
 
-#: avidemux/gui_navigate.cpp:75
-msgid "Cannot decode next frame."
+#: avidemux/ADM_osSupport/ADM_fileio.cpp:126
+#, possible-c-format
+msgid "can't create job directory (%s)."
 msgstr ""
 
-#: avidemux/gui_navigate.cpp:113 avidemux/gui_navigate.cpp:425
-msgid "Cannot decode keyframe."
+#: avidemux/ADM_osSupport/ADM_fileio.cpp:146
+msgid "can't determine $USERPROFILE."
 msgstr ""
 
-#: avidemux/gui_navigate.cpp:236
-msgid "Seeking"
+#: avidemux/ADM_osSupport/ADM_fileio.cpp:153
+msgid "can't determine $HOME."
 msgstr ""
 
-#: avidemux/gui_navigate.cpp:389
-msgid "Cannot decode the frame."
+#: avidemux/ADM_osSupport/ADM_fileio.cpp:164
+msgid "Cannot create the .avidemux directory"
 msgstr ""
 
-#: avidemux/gui_savenew.cpp:87
-msgid "Dual audio can only be used in copy mode"
+#: avidemux/ADM_outputs/oplug_mp4/oplug_mp4.cpp:152
+msgid "Cannot initialize the video stream"
 msgstr ""
 
-#: avidemux/gui_savenew.cpp:87
-msgid "Select Copy as the video codec."
+#: avidemux/ADM_outputs/oplug_mp4/oplug_mp4.cpp:170
+#: avidemux/ADM_outputs/oplug_ogm/op_ogsaveprocess.cpp:76
+#: avidemux/ADM_outputs/oplug_avi/op_saveprocess.cpp:93
+msgid "Filter init failed"
 msgstr ""
 
-#: avidemux/gui_savenew.cpp:197 avidemux/gui_savenew.cpp:213
-#: avidemux/gui_savenew.cpp:226
-msgid "Incompatible output format"
+#: avidemux/ADM_outputs/oplug_mp4/oplug_mp4.cpp:208
+#: avidemux/ADM_outputs/oplug_mp4/oplug_mp4.cpp:331
+#: avidemux/ADM_outputs/oplug_mp4/oplug_mp4.cpp:415
+#: avidemux/ADM_outputs/oplug_mpeg/op_mpegpass.cpp:352
+msgid "Error while encoding"
 msgstr ""
 
-#: avidemux/gui_savenew.cpp:244
-msgid "There is no second track"
+#: avidemux/ADM_outputs/oplug_mp4/oplug_mp4.cpp:220
+msgid "KeyFrame error"
 msgstr ""
 
-#: avidemux/gui_savenew.cpp:244
-msgid "Select a second audio track in the Audio menu."
+#: avidemux/ADM_outputs/oplug_mp4/oplug_mp4.cpp:220
+msgid ""
+"The beginning frame is not a key frame.\n"
+"Please move the A marker."
 msgstr ""
 
-#: avidemux/gui_savenew.cpp:248
-msgid "Select dual audio AVI to write"
+#: avidemux/ADM_outputs/oplug_mp4/oplug_mp4.cpp:247
+msgid "Cannot initialize the audio stream"
 msgstr ""
 
-#: avidemux/gui_savenew.cpp:270 avidemux/gui_savenew.cpp:288
-msgid "This cannot have packed VOP"
+#: avidemux/ADM_outputs/oplug_mp4/oplug_mp4.cpp:395
+#: avidemux/ADM_outputs/oplug_ogm/op_ogsaveprocess.cpp:100
+#: avidemux/ADM_outputs/oplug_avi/op_saveprocess.cpp:127
+msgid ""
+"\n"
+" Reuse the existing log-file ?"
 msgstr ""
 
-#: avidemux/gui_savenew.cpp:270 avidemux/gui_savenew.cpp:288
-msgid "It is not MPEG-4 video. File will not be saved."
+#: avidemux/ADM_outputs/oplug_mp4/oplug_mp4.cpp:431
+#: avidemux/ADM_outputs/oplug_avi/op_saveprocess.cpp:152
+msgid "Aborting"
 msgstr ""
 
-#: avidemux/gui_savenew.cpp:334
+#: avidemux/ADM_outputs/oplug_mpeg/op_mpegpass.cpp:89
+msgid "This is not MPEG compatible"
+msgstr ""
+
+#: avidemux/ADM_outputs/oplug_mpeg/op_mpegpass.cpp:89
+msgid "You can't use the Copy codec."
+msgstr ""
+
+#: avidemux/ADM_outputs/oplug_mpeg/op_mpegpass.cpp:94
+#: avidemux/ADM_outputs/oplug_mpegFF/oplug_vcdff.cpp:143
+#: avidemux/ADM_outputs/oplug_mpegFF/oplug_vcdff.cpp:154
+msgid "There is no audio track"
+msgstr ""
+
+#: avidemux/ADM_outputs/oplug_mpeg/op_mpegpass.cpp:101
+msgid "The first frame is not intra frame"
+msgstr ""
+
+#: avidemux/ADM_outputs/oplug_mpeg/op_mpegpass.cpp:101
+msgid "Use the &lt;&lt; and the &gt;&gt; buttons to move using Intra frames."
+msgstr ""
+
+#: avidemux/ADM_outputs/oplug_mpeg/op_mpegpass.cpp:113
+#: avidemux/ADM_outputs/oplug_mpegFF/oplug_vcdff.cpp:164
+msgid "Audio track is not suitable"
+msgstr ""
+
+#: avidemux/ADM_outputs/oplug_mpeg/op_mpegpass.cpp:153
+#: avidemux/ADM_outputs/oplug_mpegFF/oplug_vcdff.cpp:196
+#: avidemux/ADM_libraries/ADM_lvemux/ADM_muxer.cpp:85
+msgid "Incompatible audio"
+msgstr ""
+
+#: avidemux/ADM_outputs/oplug_mpeg/op_mpegpass.cpp:153
+#: avidemux/ADM_outputs/oplug_mpegFF/oplug_vcdff.cpp:174
+msgid "For VCD, audio must be 44.1 kHz MP2."
+msgstr ""
+
+#: avidemux/ADM_outputs/oplug_mpeg/op_mpegpass.cpp:182
+msgid "For DVD, audio must be 48 kHz MP2(stereo), AC3, DTS or LPCM (stereo)."
+msgstr ""
+
+#: avidemux/ADM_outputs/oplug_mpegFF/oplug_vcdff.cpp:196
+msgid "For DVD, audio must be 48 kHz MP2, AC3 or LPCM."
+msgstr ""
+
+#: avidemux/ADM_outputs/oplug_mpegFF/oplug_vcdff.cpp:313
+msgid "Reuse log file ?"
+msgstr ""
+
+#: avidemux/ADM_outputs/oplug_mpegFF/oplug_vcdff.cpp:328
+msgid "Error in pass 1"
+msgstr ""
+
+#: avidemux/ADM_outputs/oplug_mpegFF/oplug_vcdff.cpp:478
+msgid "Error in pass 2"
+msgstr ""
+
+#: avidemux/ADM_outputs/oplug_ogm/op_ogsave.cpp:126
+msgid "Could not initialize video"
+msgstr ""
+
+#: avidemux/ADM_outputs/oplug_ogm/op_ogsave.cpp:134
+msgid "Could not initialize audio"
+msgstr ""
+
+#: avidemux/ADM_outputs/oplug_avi/op_avisavecopy.cpp:96
+#: avidemux/ADM_outputs/oplug_avi/op_avisavecopy_unpack.cpp:98
+#: avidemux/ADM_outputs/oplug_avi/op_avisavecopy_pack.cpp:121
+#: avidemux/ADM_outputs/oplug_avi/op_avisave.cpp:446
+msgid "Cannot initiate save"
+msgstr ""
+
+#: avidemux/ADM_outputs/oplug_avi/op_saveprocess.cpp:73
 msgid ""
-"You may need smart copy.\n"
-" Enable it ?"
+"Width is not a multiple of 8\n"
+" continue anyway ?"
 msgstr ""
+
+#: avidemux/ADM_outputs/oplug_avi/op_avisave.cpp:75
+msgid "Mux every N video frames"
+msgstr ""
+
+#: avidemux/ADM_outputs/oplug_avi/op_avisave.cpp:76
+msgid "Mux by packet size"
+msgstr ""
+
+#: avidemux/ADM_outputs/oplug_avi/op_avisave.cpp:79
+msgid "Muxing _type:"
+msgstr ""
+
+#: avidemux/ADM_outputs/oplug_avi/op_avisave.cpp:80
+msgid "_Split every MB:"
+msgstr ""
+
+#: avidemux/ADM_outputs/oplug_avi/op_avisave.cpp:82
+msgid "Mux _every x video frames:"
+msgstr ""
+
+#: avidemux/ADM_outputs/oplug_avi/op_avisave.cpp:83
+msgid "Mux in _blocks of x bytes:"
+msgstr ""
+
+#: avidemux/ADM_outputs/oplug_avi/op_avisave.cpp:90
+msgid "AVI Muxer Options"
+msgstr ""
+
+#: avidemux/ADM_outputs/oplug_avi/op_avisave.cpp:188
+msgid "Error initalizing audio filters"
+msgstr ""
+
+#: avidemux/ADM_outputs/oplug_avi/op_avisave.cpp:197
+msgid "Error initalizing video filters"
+msgstr ""
+
+#: avidemux/ADM_inputs/ADM_h263/ADM_h263.cpp:258
+msgid "Size is not (s)QCIF"
+msgstr ""
+
+#: avidemux/ADM_inputs/ADM_mpegdemuxer/dmx_indexer.cpp:149
+msgid "There is several mpeg file, append them ?"
+msgstr ""
+
+#: avidemux/ADM_inputs/ADM_mpegdemuxer/dmx_indexer.cpp:250
+msgid "Can't determine aspect ratio"
+msgstr ""
+
+#: avidemux/ADM_inputs/ADM_mpegdemuxer/dmx_video.cpp:355
+msgid "Out of memory"
+msgstr ""
+
+#: avidemux/ADM_inputs/ADM_mpegdemuxer/dmx_video.cpp:370
+msgid "Opening MPEG"
+msgstr ""
+
+#: avidemux/ADM_inputs/ADM_mpegdemuxer/dmx_video.cpp:539
+msgid "MPEG renumbering error"
+msgstr ""
+
+#: avidemux/ADM_inputs/ADM_nuv/ADM_nuv.cpp:542
+#: avidemux/ADM_inputs/ADM_nuv/ADM_nuv.cpp:571
+msgid "Opening Nuppel video"
+msgstr ""
+
+#: avidemux/ADM_inputs/ADM_nuv/ADM_nuv.cpp:547
+msgid "Sure you want to abort ?"
+msgstr ""
+
+#: avidemux/ADM_inputs/ADM_nuv/ADM_nuv.cpp:758
+msgid "Size mismatch"
+msgstr ""
+
+#: avidemux/ADM_inputs/ADM_nuv/ADM_nuv.cpp:758
+msgid "Expect a crash."
+msgstr ""
+
+#: avidemux/ADM_inputs/ADM_nuv/ADM_nuv.cpp:1050
+msgid "Do you want to save an index ?"
+msgstr ""
+
+#: avidemux/ADM_inputs/ADM_ogm/ADM_ogm.cpp:346
+msgid "Take second track ?"
+msgstr ""
+
+#: avidemux/ADM_inputs/ADM_ogm/ADM_ogm.cpp:426
+msgid "Scanning OGM"
+msgstr ""
+
+#: avidemux/ADM_inputs/ADM_openDML/ADM_openDML.cpp:281
+#: avidemux/ADM_inputs/ADM_openDML/ADM_openDML.cpp:366
+#: avidemux/ADM_inputs/ADM_openDML/ADM_openDML.cpp:501
+msgid "Malformed header"
+msgstr ""
+
+#: avidemux/ADM_inputs/ADM_openDML/ADM_openDMLDepack.cpp:93
+msgid "Unpacking bitstream"
+msgstr ""
+
+#: avidemux/ADM_inputs/ADM_openDML/ADM_opendml_reindex.cpp:68
+msgid "Indexing"
+msgstr ""
+
+#: avidemux/ADM_inputs/ADM_mp4/ADM_mp4Analyzer.cpp:583
+msgid "Problem reading SVQ3 headers"
+msgstr ""
+
+#: avidemux/ADM_inputs/ADM_mp4/ADM_mp4Indexer.cpp:346
+msgid "No stts table"
+msgstr ""
+
+#: avidemux/ADM_libraries/ADM_lvemux/ADM_muxer.cpp:85
+msgid "For DVD, audio must be MP2 or AC3."
+msgstr ""
+
+#: avidemux/ADM_libraries/ADM_lvemux/ADM_muxer.cpp:92
+msgid "lvemux init failed"
+msgstr ""
+
+#: avidemux/ADM_libraries/ADM_lavformat/ADM_lavformat.cpp:308
+msgid "Incompatible frame rate"
+msgstr ""
+
+#: avidemux/ADM_libraries/ADM_utilities/avidemutils.cpp:324
+msgid "NTSC 4:3"
+msgstr ""
+
+#: avidemux/ADM_libraries/ADM_utilities/avidemutils.cpp:325
+#: avidemux/ADM_libraries/ADM_utilities/avidemutils.cpp:326
+msgid "NTSC 16:9"
+msgstr ""
+
+#: avidemux/ADM_libraries/ADM_utilities/avidemutils.cpp:327
+msgid "PAL 4:3"
+msgstr ""
+
+#: avidemux/ADM_libraries/ADM_utilities/avidemutils.cpp:328
+msgid "PAL 16:9"
+msgstr ""
+
+#: avidemux/ADM_libraries/ADM_utilities/ADM_imageUtils.cpp:403
+msgid "Memory error"
+msgstr ""
+
+#: avidemux/ADM_libraries/ADM_utilities/ADM_imageUtils.cpp:410
+msgid "Error converting to BMP"
+msgstr ""
+
+#: avidemux/ADM_libraries/ADM_utilities/ADM_imageUtils.cpp:472
+msgid "Cannot encode the frame"
+msgstr ""



From mean at mail.berlios.de  Sat Jul 21 18:45:18 2007
From: mean at mail.berlios.de (mean at BerliOS)
Date: Sat, 21 Jul 2007 18:45:18 +0200
Subject: [Avidemux-svn-commit] r3427 - branches/avidemux_2.4_branch/po
Message-ID: <200707211645.l6LGjIfi019521@sheep.berlios.de>

Author: mean
Date: 2007-07-21 18:45:16 +0200 (Sat, 21 Jul 2007)
New Revision: 3427

Modified:
   branches/avidemux_2.4_branch/po/POTFILES.in
Log:
[I18N] Updated pot file\n

Modified: branches/avidemux_2.4_branch/po/POTFILES.in
===================================================================
--- branches/avidemux_2.4_branch/po/POTFILES.in	2007-07-21 16:38:55 UTC (rev 3426)
+++ branches/avidemux_2.4_branch/po/POTFILES.in	2007-07-21 16:45:16 UTC (rev 3427)
@@ -1,551 +1,1184 @@
-./avidemux/ADM_assert.h
-./avidemux/ADM_audio/ADM_a52info.cpp
-./avidemux/ADM_audio/ADM_a52info.h
-./avidemux/ADM_audio/ADM_aacinfo.cpp
-./avidemux/ADM_audio/ADM_aacinfo.h
-./avidemux/ADM_audio/ADM_audiodef.h
-./avidemux/ADM_audio/ADM_dcainfo.cpp
-./avidemux/ADM_audio/ADM_dcainfo.h
-./avidemux/ADM_audio/ADM_mp3info.cpp
-./avidemux/ADM_audio/ADM_mp3info.h
-./avidemux/ADM_audio/audioac3ex.cpp
-./avidemux/ADM_audio/audioex.h
-./avidemux/ADM_audio/audiogen.cpp
-./avidemux/ADM_audio/audiomp3ex.cpp
-./avidemux/ADM_audio/audiosource_ext.cpp
-./avidemux/ADM_audio/audiosource_ext.h
-./avidemux/ADM_audio/audiotimeline.cpp
-./avidemux/ADM_audio/audiowavex.cpp
-./avidemux/ADM_audio/audio_mpegidentify.cpp
-./avidemux/ADM_audio/audio_packetizer.cpp
+./avidemux/ADM_audiocodec/adm_ogg.h
+./avidemux/ADM_audiocodec/ADM_codecwma.cpp
+./avidemux/ADM_audiocodec/ADM_dca.cpp
+./avidemux/ADM_audiocodec/ADM_codecfaad.cpp
 ./avidemux/ADM_audiocodec/ADM_8bits.cpp
+./avidemux/ADM_audiocodec/ADM_lpcm.cpp
+./avidemux/ADM_audiocodec/ADM_codecwav.cpp
+./avidemux/ADM_audiocodec/ADM_codecmp3.cpp
 ./avidemux/ADM_audiocodec/ADM_audiocodec.cpp
+./avidemux/ADM_audiocodec/ADM_codecac3.cpp
 ./avidemux/ADM_audiocodec/ADM_audiocodec.h
-./avidemux/ADM_audiocodec/ADM_audiocodeclist.h
-./avidemux/ADM_audiocodec/ADM_codecac3.cpp
-./avidemux/ADM_audiocodec/ADM_codecfaad.cpp
-./avidemux/ADM_audiocodec/ADM_codecimaadpcm.cpp
-./avidemux/ADM_audiocodec/ADM_codecmp3.cpp
 ./avidemux/ADM_audiocodec/ADM_codeculaw.cpp
-./avidemux/ADM_audiocodec/ADM_codecwav.cpp
-./avidemux/ADM_audiocodec/ADM_codecwma.cpp
-./avidemux/ADM_audiocodec/ADM_dca.cpp
-./avidemux/ADM_audiocodec/ADM_lpcm.cpp
-./avidemux/ADM_audiocodec/adm_ogg.h
 ./avidemux/ADM_audiocodec/ADM_vorbis.h
 ./avidemux/ADM_audiocodec/audiocodec_ogg.cpp
-./avidemux/ADM_audiodevice/ADM_audiodevice.cpp
-./avidemux/ADM_audiodevice/ADM_audiodevice.h
-./avidemux/ADM_audiodevice/ADM_deviceALSA.cpp
-./avidemux/ADM_audiodevice/ADM_deviceALSA.h
-./avidemux/ADM_audiodevice/ADM_deviceArts.cpp
-./avidemux/ADM_audiodevice/ADM_deviceArts.h
-./avidemux/ADM_audiodevice/ADM_deviceAudioCore.cpp
-./avidemux/ADM_audiodevice/ADM_deviceAudioCore.h
-./avidemux/ADM_audiodevice/ADM_deviceEsd.cpp
-./avidemux/ADM_audiodevice/ADM_deviceEsd.h
-./avidemux/ADM_audiodevice/ADM_deviceoss.cpp
-./avidemux/ADM_audiodevice/ADM_deviceoss.h
-./avidemux/ADM_audiodevice/ADM_deviceSDL.cpp
-./avidemux/ADM_audiodevice/ADM_deviceSDL.h
-./avidemux/ADM_audiodevice/ADM_deviceWin32.cpp
-./avidemux/ADM_audiodevice/ADM_deviceWin32.h
-./avidemux/ADM_audiodevice/audio_out.h
-./avidemux/ADM_audiodevice/oss_out.cpp
+./avidemux/ADM_audiocodec/ADM_codecmsadpcm.cpp
+./avidemux/ADM_audiocodec/ADM_codecimaadpcm.cpp
+./avidemux/ADM_audiocodec/ADM_audiocodeclist.h
+./avidemux/ADM_audiofilter/audioencoder_twolame.h
+./avidemux/ADM_audiofilter/audioencoder_lame.cpp
+./avidemux/ADM_audiofilter/audioencoder_pcm.cpp
+./avidemux/ADM_audiofilter/audioencoder_lavcodec.cpp
+./avidemux/ADM_audiofilter/audioencoder_aften_param.h
+./avidemux/ADM_audiofilter/audiofilter_dolby.h
+./avidemux/ADM_audiofilter/audioencoder_buff.cpp
+./avidemux/ADM_audiofilter/audiofilter_sox.h
+./avidemux/ADM_audiofilter/audioencoder.h
+./avidemux/ADM_audiofilter/audiofilter_normalize.cpp
 ./avidemux/ADM_audiofilter/audiodeng_buildfilters.cpp
-./avidemux/ADM_audiofilter/audioencoder.cpp
-./avidemux/ADM_audiofilter/audioencoder.h
+./avidemux/ADM_audiofilter/audioeng_buildfilters.h
+./avidemux/ADM_audiofilter/resampl.h
+./avidemux/ADM_audiofilter/audiofilter_mixer.cpp
+./avidemux/ADM_audiofilter/audioeng_process.cpp
+./avidemux/ADM_audiofilter/audioencoder_twolame_param.h
 ./avidemux/ADM_audiofilter/audioencoder_aften.cpp
-./avidemux/ADM_audiofilter/audioencoder_aften.h
-./avidemux/ADM_audiofilter/audioencoder_aften_param.h
+./avidemux/ADM_audiofilter/audiofiler_sox.cpp
+./avidemux/ADM_audiofilter/audio_raw.h
+./avidemux/ADM_audiofilter/audioencoder_faac.h
+./avidemux/ADM_audiofilter/audiolib_sox.cpp
+./avidemux/ADM_audiofilter/audiofilter_limiter.cpp
+./avidemux/ADM_audiofilter/audiofilter_channel_route.h
+./avidemux/ADM_audiofilter/audiofilter_bridge.h
+./avidemux/ADM_audiofilter/audioencoder_twolame.cpp
+./avidemux/ADM_audiofilter/audiofilter_buildchain.cpp
+./avidemux/ADM_audiofilter/audioencoder_vorbis.h
 ./avidemux/ADM_audiofilter/audioencoder_config.h
-./avidemux/ADM_audiofilter/audioencoder_faac.cpp
-./avidemux/ADM_audiofilter/audioencoder_faac.h
+./avidemux/ADM_audiofilter/audiofilter_normalize.h
+./avidemux/ADM_audiofilter/audioeng_process.h
 ./avidemux/ADM_audiofilter/audioencoder_faac_param.h
-./avidemux/ADM_audiofilter/audioencoder_lame.cpp
+./avidemux/ADM_audiofilter/audiofilter_dolby.cpp
+./avidemux/ADM_audiofilter/audiofilter_sox.cpp
+./avidemux/ADM_audiofilter/audiofilter_limiter.h
+./avidemux/ADM_audiofilter/audiofilter_film2pal.h
 ./avidemux/ADM_audiofilter/audioencoder_lame.h
-./avidemux/ADM_audiofilter/audioencoder_lame_param.h
-./avidemux/ADM_audiofilter/audioencoder_lavcodec.cpp
+./avidemux/ADM_audiofilter/audioencoder_pcm.h
 ./avidemux/ADM_audiofilter/audioencoder_lavcodec.h
-./avidemux/ADM_audiofilter/audioencoder_pcm.cpp
-./avidemux/ADM_audiofilter/audioencoder_pcm.h
-./avidemux/ADM_audiofilter/audioencoder_twolame.cpp
-./avidemux/ADM_audiofilter/audioencoder_twolame.h
-./avidemux/ADM_audiofilter/audioencoder_twolame_param.h
-./avidemux/ADM_audiofilter/audioencoder_vorbis.cpp
-./avidemux/ADM_audiofilter/audioencoder_vorbis.h
 ./avidemux/ADM_audiofilter/audioencoder_vorbis_param.h
-./avidemux/ADM_audiofilter/audioeng_buff.cpp
-./avidemux/ADM_audiofilter/audioeng_buildfilters.h
-./avidemux/ADM_audiofilter/audioeng_process.cpp
-./avidemux/ADM_audiofilter/audioeng_process.h
-./avidemux/ADM_audiofilter/audiofilter_bridge.cpp
-./avidemux/ADM_audiofilter/audiofilter_bridge.h
-./avidemux/ADM_audiofilter/audiofilter_buildchain.cpp
+./avidemux/ADM_audiofilter/audio_raw.cpp
+./avidemux/ADM_audiofilter/audioencoder_faac.cpp
+./avidemux/ADM_audiofilter/audiofilter_normalize_param.h
 ./avidemux/ADM_audiofilter/audiofilter_channel_route.cpp
-./avidemux/ADM_audiofilter/audiofilter_channel_route.h
-./avidemux/ADM_audiofilter/audiofilter_dolby.cpp
-./avidemux/ADM_audiofilter/audiofilter_dolby.h
-./avidemux/ADM_audiofilter/audiofilter_film2pal.cpp
-./avidemux/ADM_audiofilter/audiofilter_film2pal.h
-./avidemux/ADM_audiofilter/audiofilter_limiter.cpp
-./avidemux/ADM_audiofilter/audiofilter_limiter.h
+./avidemux/ADM_audiofilter/audiofilter_mixer.h
 ./avidemux/ADM_audiofilter/audiofilter_limiter_param.h
-./avidemux/ADM_audiofilter/audiofilter_mixer.cpp
-./avidemux/ADM_audiofilter/audiofilter_mixer.h
-./avidemux/ADM_audiofilter/audiofilter_normalize.cpp
-./avidemux/ADM_audiofilter/audiofilter_normalize.h
-./avidemux/ADM_audiofilter/audiofilter_normalize_param.h
-./avidemux/ADM_audiofilter/audiofilter_sox.cpp
-./avidemux/ADM_audiofilter/audiofilter_sox.h
-./avidemux/ADM_audiofilter/audiolib_sox.cpp
+./avidemux/ADM_audiofilter/audiofilter_bridge.cpp
+./avidemux/ADM_audiofilter/audioencoder_aften.h
+./avidemux/ADM_audiofilter/audioencoder_lame_param.h
+./avidemux/ADM_audiofilter/audioencoder_vorbis.cpp
+./avidemux/ADM_audiofilter/audioencoder.cpp
 ./avidemux/ADM_audiofilter/audiolib_sox.h
-./avidemux/ADM_audiofilter/audio_raw.cpp
-./avidemux/ADM_audiofilter/audio_raw.h
-./avidemux/ADM_audiofilter/resampl.h
-./avidemux/ADM_codecs/ADM_codec.h
-./avidemux/ADM_codecs/ADM_codecNull.h
-./avidemux/ADM_codecs/ADM_codecs.cpp
-./avidemux/ADM_codecs/ADM_ffmp43.cpp
-./avidemux/ADM_codecs/ADM_ffmp43.h
-./avidemux/ADM_codecs/ADM_ffmpeg.cpp
-./avidemux/ADM_codecs/ADM_ffmpeg.h
-./avidemux/ADM_codecs/ADM_ffmpegConfig.h
-./avidemux/ADM_codecs/ADM_mjpeg.cpp
-./avidemux/ADM_codecs/ADM_mjpeg.h
-./avidemux/ADM_codecs/ADM_mjpegEncode.cpp
-./avidemux/ADM_codecs/ADM_mjpegEncode.h
-./avidemux/ADM_codecs/ADM_mpeg.cpp
-./avidemux/ADM_codecs/ADM_mpeg.h
-./avidemux/ADM_codecs/ADM_png.cpp
-./avidemux/ADM_codecs/ADM_png.h
-./avidemux/ADM_codecs/ADM_rgb16.cpp
-./avidemux/ADM_codecs/ADM_rgb16.h
-./avidemux/ADM_codecs/ADM_theora_dec.cpp
-./avidemux/ADM_codecs/ADM_theora_dec.h
-./avidemux/ADM_codecs/ADM_theora_enc.h
-./avidemux/ADM_codecs/ADM_uyvy.cpp
-./avidemux/ADM_codecs/ADM_uyvy.h
-./avidemux/ADM_codecs/ADM_x264.cpp
-./avidemux/ADM_codecs/ADM_x264.h
-./avidemux/ADM_codecs/ADM_x264param.h
-./avidemux/ADM_codecs/ADM_xvid.cpp
-./avidemux/ADM_codecs/ADM_xvid.h
-./avidemux/ADM_codecs/ADM_xvid4.cpp
-./avidemux/ADM_codecs/ADM_xvid4.h
-./avidemux/ADM_codecs/ADM_xvid4param.h
-./avidemux/ADM_codecs/ADM_xvidcvs.cpp
-./avidemux/ADM_codecs/ADM_xvideco.cpp
-./avidemux/ADM_codecs/ADM_xvideco.h
-./avidemux/ADM_colorspace/ADM_rgb.cpp
-./avidemux/ADM_colorspace/ADM_rgb.h
+./avidemux/ADM_audiofilter/audioeng_buff.cpp
+./avidemux/ADM_audiofilter/audiofilter_film2pal.cpp
+./avidemux/ADM_requant/putvlc.h
+./avidemux/ADM_requant/getvlc.h
+./avidemux/ADM_requant/tcrequant.h
 ./avidemux/ADM_colorspace/colorspace.h
 ./avidemux/ADM_colorspace/rgb2yuv.cpp
 ./avidemux/ADM_colorspace/yuv.cpp
-./avidemux/ADM_editor/ADMedAVIAUD.cpp
-./avidemux/ADM_editor/ADM_edAudio.cpp
-./avidemux/ADM_editor/ADM_edCache.cpp
-./avidemux/ADM_editor/ADM_edCache.h
-./avidemux/ADM_editor/ADM_edFrameType.cpp
-./avidemux/ADM_editor/ADM_edIdentify.cpp
-./avidemux/ADM_editor/ADM_edit.cpp
-./avidemux/ADM_editor/ADM_edLoadSave.cpp
-./avidemux/ADM_editor/ADM_edRender.cpp
-./avidemux/ADM_editor/ADM_edSearch.cpp
-./avidemux/ADM_editor/ADM_edStub.cpp
-./avidemux/ADM_editor/ADM_outputfmt.h
-./avidemux/ADM_editor/ADM_Video.cpp
-./avidemux/ADM_editor/ADM_Video.h
-./avidemux/ADM_encoder/ADM_encCodecDesc.h
+./avidemux/ADM_colorspace/ADM_rgb.cpp
+./avidemux/ADM_colorspace/ADM_rgb.h
+./avidemux/ADM_encoder/adm_encoder.cpp
+./avidemux/ADM_encoder/adm_encXvid4.cpp
+./avidemux/ADM_encoder/adm_encffmpeg.cpp
 ./avidemux/ADM_encoder/adm_encConfig.cpp
+./avidemux/ADM_encoder/adm_encyv12.h
+./avidemux/ADM_encoder/adm_encmjpeg.h
+./avidemux/ADM_encoder/adm_encx264.h
 ./avidemux/ADM_encoder/adm_encConfig.h
 ./avidemux/ADM_encoder/adm_encCopy.cpp
-./avidemux/ADM_encoder/adm_encCopy.h
 ./avidemux/ADM_encoder/adm_encdivx.cpp
-./avidemux/ADM_encoder/adm_encdivx.h
-./avidemux/ADM_encoder/adm_encdivx2p.cpp
+./avidemux/ADM_encoder/adm_encxvid.h
+./avidemux/ADM_encoder/ADM_videocodeclist.h
+./avidemux/ADM_encoder/adm_encRequant.cpp
 ./avidemux/ADM_encoder/adm_encffmatrix.h
-./avidemux/ADM_encoder/adm_encffmpeg.cpp
-./avidemux/ADM_encoder/adm_encffmpeg.h
-./avidemux/ADM_encoder/adm_encffmpeg1.cpp
-./avidemux/ADM_encoder/adm_encmjpeg.cpp
-./avidemux/ADM_encoder/adm_encmjpeg.h
 ./avidemux/ADM_encoder/adm_encmjpeg_param.h
+./avidemux/ADM_encoder/adm_encoder.h
 ./avidemux/ADM_encoder/adm_encmpeg2enc.cpp
 ./avidemux/ADM_encoder/adm_encmpeg2enc.h
-./avidemux/ADM_encoder/adm_encoder.cpp
-./avidemux/ADM_encoder/adm_encoder.h
-./avidemux/ADM_encoder/adm_encRequant.cpp
-./avidemux/ADM_encoder/adm_encRequant.h
+./avidemux/ADM_encoder/adm_encyv12.cpp
+./avidemux/ADM_encoder/adm_encmjpeg.cpp
 ./avidemux/ADM_encoder/adm_encx264.cpp
-./avidemux/ADM_encoder/adm_encx264.h
+./avidemux/ADM_encoder/adm_encXvid4.h
+./avidemux/ADM_encoder/adm_encffmpeg.h
 ./avidemux/ADM_encoder/adm_encxvid.cpp
-./avidemux/ADM_encoder/adm_encxvid.h
-./avidemux/ADM_encoder/adm_encXvid4.cpp
-./avidemux/ADM_encoder/adm_encXvid4.h
-./avidemux/ADM_encoder/adm_encyv12.cpp
-./avidemux/ADM_encoder/adm_encyv12.h
-./avidemux/ADM_encoder/ADM_videocodeclist.h
+./avidemux/ADM_encoder/adm_encdivx2p.cpp
+./avidemux/ADM_encoder/adm_encCopy.h
+./avidemux/ADM_encoder/adm_encdivx.h
 ./avidemux/ADM_encoder/xvid_vbr.h
-./avidemux/ADM_filter/ADM_vidDummyFilter.cpp
+./avidemux/ADM_encoder/adm_encRequant.h
+./avidemux/ADM_encoder/adm_encffmpeg1.cpp
+./avidemux/ADM_encoder/ADM_encCodecDesc.h
+./avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_menumap.h
+./avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_keymap.cpp
+./avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_bindings.cpp
+./avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp
+./avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_gtkRender.cpp
+./avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_mpdelogo.cpp
+./avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_crop.cpp
+./avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_quota.cpp
+./avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_coloryuv.cpp
+./avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_preview.cpp
+./avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp
+./avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_hue.cpp
+./avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_jobs.cpp
+./avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_contrast.cpp
+./avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp
+./avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_pipe.cpp
+./avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_flyDialog.cpp
+./avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_ocr.cpp
+./avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_chromaShift.cpp
+./avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_jobs_save.cpp
+./avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_idx_pg.cpp
+./avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_exLame.cpp
+./avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_eq2.cpp
+./avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_acodec.cpp
+./avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_partial.cpp
+./avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_recent.cpp
+./avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_working.cpp
+./avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp
+./avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_busy.cpp
+./avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_cnr2.cpp
+./avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_resize.cpp
+./avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_properties.cpp
+./avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_about.cpp
+./avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid.cpp
+./avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_vobsub.cpp
+./avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_equalizer.cpp
+./avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_vcodec.cpp
+./avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_asharp.cpp
+./avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp
+./avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_pause.cpp
+./avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_srt.cpp
+./avidemux/ADM_userInterfaces/ADM_GTK/ADM_toolkit_gtk/toolkit_gtk.h
+./avidemux/ADM_userInterfaces/ADM_GTK/ADM_toolkit_gtk/ADM_gladeSupport.h
+./avidemux/ADM_userInterfaces/ADM_GTK/ADM_toolkit_gtk/toolkit_gtk_include.h
+./avidemux/ADM_userInterfaces/ADM_GTK/ADM_toolkit_gtk/eggtrayicon.h
+./avidemux/ADM_userInterfaces/ADM_GTK/ADM_toolkit_gtk/toolkit_dialog.cpp
+./avidemux/ADM_userInterfaces/ADM_GTK/ADM_toolkit_gtk/toolkit.cpp
+./avidemux/ADM_userInterfaces/ADM_GTK/ADM_toolkit_gtk/TLK_filesel.cpp
+./avidemux/ADM_userInterfaces/ADM_GTK/ADM_toolkit_gtk/gtkmarkscale.h
+./avidemux/ADM_userInterfaces/ADM_GTK/ADM_toolkit_gtk/jogshuttle.h
+./avidemux/ADM_userInterfaces/ADM_GTK/ADM_toolkit_gtk/choice.cpp
+./avidemux/ADM_userInterfaces/ADM_GTK/ADM_toolkit_gtk/ADM_gladeSupport.cpp
+./avidemux/ADM_userInterfaces/ADM_GTK/ADM_toolkit_gtk/ADM_tray_gtk.cpp
+./avidemux/ADM_userInterfaces/ADM_GTK/ADM_filters/gui_filterlist.cpp
+./avidemux/ADM_userInterfaces/ADM_GTK/ADM_filters/gui_filtermanager.cpp
+./avidemux/ADM_userInterfaces/ADM_GTK/ADM_filters/gui_filtersub.cpp
+./avidemux/ADM_userInterfaces/ADM_GTK/ADM_filters/gui_filtermanager_dialog.cpp
+./avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialogFactory/FAC_notch.cpp
+./avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialogFactory/DIA_filesel.cpp
+./avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialogFactory/FAC_readOnlyText.cpp
+./avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialogFactory/DIA_color.cpp
+./avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialogFactory/FAC_frame.cpp
+./avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialogFactory/FAC_bitrate.cpp
+./avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialogFactory/DIA_dialogFactory.cpp
+./avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialogFactory/FAC_float.cpp
+./avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialogFactory/FAC_integer.cpp
+./avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialogFactory/FAC_toggle.cpp
+./avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialogFactory/FAC_menu.cpp
+./avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialogFactory/FAC_hex.cpp
+./avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialogFactory/FAC_bar.cpp
+./avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialogFactory/FAC_button.cpp
+./avidemux/ADM_userInterfaces/ADM_GTK/ADM_ocr/adm_ocr.cpp
+./avidemux/ADM_userInterfaces/ADM_GTK/ADM_ocr/adm_sup.cpp
+./avidemux/ADM_userInterfaces/ADM_GTK/ADM_ocr/adm_sup.h
+./avidemux/ADM_userInterfaces/ADM_GTK/ADM_ocr/adm_editglyph.cpp
+./avidemux/ADM_userInterfaces/ADM_commonUI/systray.h
+./avidemux/ADM_userInterfaces/ADM_commonUI/ADM_tray.h
+./avidemux/ADM_userInterfaces/ADM_commonUI/DIA_working.h
+./avidemux/ADM_userInterfaces/ADM_commonUI/DIA_flyContrast.h
+./avidemux/ADM_userInterfaces/ADM_commonUI/DIA_enter.h
+./avidemux/ADM_userInterfaces/ADM_commonUI/DIA_flyHue.h
+./avidemux/ADM_userInterfaces/ADM_commonUI/DIA_busy.h
+./avidemux/ADM_userInterfaces/ADM_commonUI/DIA_flyContrast.cpp
+./avidemux/ADM_userInterfaces/ADM_commonUI/DIA_idx_pg.h
+./avidemux/ADM_userInterfaces/ADM_commonUI/DIA_audioconfig.cpp
+./avidemux/ADM_userInterfaces/ADM_commonUI/DIA_encoding.h
+./avidemux/ADM_userInterfaces/ADM_commonUI/GUI_render.h
+./avidemux/ADM_userInterfaces/ADM_commonUI/DIA_resizeWiz.h
+./avidemux/ADM_userInterfaces/ADM_commonUI/DIA_tdeint.cpp
+./avidemux/ADM_userInterfaces/ADM_commonUI/GUI_sdlRender.h
+./avidemux/ADM_userInterfaces/ADM_commonUI/GUI_xvRender.h
+./avidemux/ADM_userInterfaces/ADM_commonUI/GUI_xvRender.cpp
+./avidemux/ADM_userInterfaces/ADM_commonUI/DIA_flyDialog.cpp
+./avidemux/ADM_userInterfaces/ADM_commonUI/GUI_accelRender.h
+./avidemux/ADM_userInterfaces/ADM_commonUI/DIA_flyAsharp.cpp
+./avidemux/ADM_userInterfaces/ADM_commonUI/DIA_gototime.cpp
+./avidemux/ADM_userInterfaces/ADM_commonUI/DIA_srt.cpp
+./avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp
+./avidemux/ADM_userInterfaces/ADM_commonUI/DIA_DVDff.cpp
+./avidemux/ADM_userInterfaces/ADM_commonUI/GUI_ui.h
+./avidemux/ADM_userInterfaces/ADM_commonUI/DIA_flySrtPos.h
+./avidemux/ADM_userInterfaces/ADM_commonUI/DIA_v2v.cpp
+./avidemux/ADM_userInterfaces/ADM_commonUI/DIA_SVCD.cpp
+./avidemux/ADM_userInterfaces/ADM_commonUI/GUI_sdlRender.cpp
+./avidemux/ADM_userInterfaces/ADM_commonUI/DIA_bitrateHisto.cpp
+./avidemux/ADM_userInterfaces/ADM_commonUI/DIA_builtin.cpp
+./avidemux/ADM_userInterfaces/ADM_commonUI/DIA_factory.h
+./avidemux/ADM_userInterfaces/ADM_commonUI/DIA_audioFilter.cpp
+./avidemux/ADM_userInterfaces/ADM_commonUI/DIA_lavcodec.cpp
+./avidemux/ADM_userInterfaces/ADM_commonUI/DIA_flyDialog.h
+./avidemux/ADM_userInterfaces/ADM_commonUI/DIA_resizeWiz.cpp
+./avidemux/ADM_userInterfaces/ADM_commonUI/DIA_flyChromaShift.cpp
+./avidemux/ADM_userInterfaces/ADM_commonUI/DIA_enter.cpp
+./avidemux/ADM_userInterfaces/ADM_commonUI/DIA_flyCrop.cpp
+./avidemux/ADM_userInterfaces/ADM_commonUI/DIA_flyChromaShift.h
+./avidemux/ADM_userInterfaces/ADM_commonUI/DIA_postproc.cpp
+./avidemux/ADM_userInterfaces/ADM_commonUI/DIA_flyAsharp.h
+./avidemux/ADM_userInterfaces/ADM_commonUI/GUI_render.cpp
+./avidemux/ADM_userInterfaces/ADM_commonUI/DIA_flyCrop.h
+./avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp
+./avidemux/ADM_userInterfaces/ADM_commonUI/DIA_mjpeg.cpp
+./avidemux/ADM_userInterfaces/ADM_commonUI/DIA_requant.cpp
+./avidemux/ADM_userInterfaces/ADM_commonUI/DIA_flyHue.cpp
+./avidemux/ADM_userInterfaces/ADM_commonUI/DIA_flySrtPos.cpp
+./avidemux/ADM_userInterfaces/ADM_commonUI/DIA_lavDecoder.cpp
+./avidemux/ADM_userInterfaces/ADM_commonUI/DIA_animated.cpp
+./avidemux/ADM_userInterfaces/ADM_commonUI/DIA_flyPreview.h
+./avidemux/ADM_userInterfaces/ADM_NONE/ADM_dialog/DIA_working.cpp
+./avidemux/ADM_userInterfaces/ADM_NONE/ADM_dialog/DIA_busy.cpp
+./avidemux/ADM_userInterfaces/ADM_NONE/ADM_dialog/DIA_encoding.cpp
+./avidemux/ADM_userInterfaces/ADM_NONE/ADM_dialog/DIA_none.cpp
+./avidemux/ADM_userInterfaces/ADM_NONE/ADM_dialog/alert_none.cpp
+./avidemux/ADM_userInterfaces/ADM_NONE/ADM_dialog/DIA_flyDialog.cpp
+./avidemux/ADM_userInterfaces/ADM_NONE/ADM_dialog/OCR_none.cpp
+./avidemux/ADM_userInterfaces/ADM_NONE/ADM_dialog/DIA_indexing.cpp
+./avidemux/ADM_userInterfaces/ADM_NONE/ADM_filters/filter_none.cpp
+./avidemux/ADM_userInterfaces/ADM_NONE/ADM_gui2/gui_none.cpp
+./avidemux/ADM_userInterfaces/ADM_NONE/ADM_gui2/file_none.cpp
+./avidemux/ADM_userInterfaces/ADM_NONE/ADM_gui2/preview_none.cpp
+./avidemux/ADM_userInterfaces/ADM_NONE/ADM_dialogFactory/DIA_dialogFactory.cpp
+./avidemux/ADM_userInterfaces/ADM_NONE/ADM_dialogFactory/FAC_toggle.cpp
+./avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/T_preview.cpp
+./avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui_none.cpp
+./avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/T_qslider.cpp
+./avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/ADM_qslider.h
+./avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/file_qt4.cpp
+./avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/ui_gui2.h
+./avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/translation_table.h
+./avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/Q_gui2.cpp
+./avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_busy.cpp
+./avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_x264.cpp
+./avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/OCR_none.cpp
+./avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/ui_srt.h
+./avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_jobs.cpp
+./avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_encoding.cpp
+./avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_srt.cpp
+./avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_xvid4.cpp
+./avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/ui_jobs.h
+./avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/ui_contrast.h
+./avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_none.cpp
+./avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_srt.cpp
+./avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/ui_working.h
+./avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/ui_resizing.h
+./avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/T_QCanvas.cpp
+./avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/oldq/AQ_asharp.cpp
+./avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/oldq/AQ_chromashift.cpp
+./avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/oldq/AQ_contrast.cpp
+./avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/oldq/AQ_crop.cpp
+./avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/oldq/AQ_encoding.cpp
+./avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/oldq/AQ_hue.cpp
+./avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/oldq/AQ_props.cpp
+./avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/oldq/AQ_srt.cpp
+./avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/oldq/AQ_working.cpp
+./avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_crop.cpp
+./avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/ui_chromashift.h
+./avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_working.cpp
+./avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/alert_qt4.cpp
+./avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/T_flyDialog.cpp
+./avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_resizing.cpp
+./avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_flyDialogQt4.h
+./avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/ui_props.h
+./avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/ui_crop.h
+./avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/ADM_flyTemplate.h
+./avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/ui_asharp.h
+./avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/ui_hue.h
+./avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_contrast.cpp
+./avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_hue.cpp
+./avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_props.cpp
+./avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/AQ_flyDialog.cpp
+./avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/ui_encoding.h
+./avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_asharp.cpp
+./avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_chromashift.cpp
+./avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/AQ_index_pg.cpp
+./avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/T_index_pg.cpp
+./avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/AQ_QCanvas.cpp
+./avidemux/ADM_userInterfaces/ADM_QT4/ADM_filters/filter_none.cpp
+./avidemux/ADM_userInterfaces/ADM_QT4/ADM_filters/ui_mainfilter.h
+./avidemux/ADM_userInterfaces/ADM_QT4/ADM_filters/Q_mainfilter.cpp
+./avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialogFactory/FAC_bar.cpp
+./avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialogFactory/T_bitrate.cpp
+./avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialogFactory/FAC_notch.cpp
+./avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialogFactory/FAC_readOnlyText.cpp
+./avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialogFactory/FAC_hex.cpp
+./avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialogFactory/FAC_integer.cpp
+./avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialogFactory/FAC_frame.cpp
+./avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialogFactory/FAC_float.cpp
+./avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialogFactory/T_dialogFactory.cpp
+./avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialogFactory/T_filesel.cpp
+./avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialogFactory/T_menu.cpp
+./avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialogFactory/T_toggle.cpp
+./avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialogFactory/T_button.cpp
+./avidemux/prefs.h
+./avidemux/ADM_videoFilter/ADM_vidLuma.h
+./avidemux/ADM_videoFilter/ADM_vidFastConvolution.cpp
+./avidemux/ADM_videoFilter/ADM_vidVlad.cpp
+./avidemux/ADM_videoFilter/ADM_vidMSharpen.cpp
+./avidemux/ADM_videoFilter/ADM_vidWhirl.cpp
+./avidemux/ADM_videoFilter/ADM_vidMcDeint.cpp
+./avidemux/ADM_videoFilter/ADM_vidField.h
+./avidemux/ADM_videoFilter/ADM_vidDGbob_param.h
+./avidemux/ADM_videoFilter/ADM_vidDeinterlace.cpp
+./avidemux/ADM_videoFilter/ADM_vidASS.h
+./avidemux/ADM_videoFilter/ADM_vidSwapFields.cpp
+./avidemux/ADM_videoFilter/ADM_vidFlux.h
+./avidemux/ADM_videoFilter/ADM_vidFlux.cpp
+./avidemux/ADM_videoFilter/ADM_vidForcedPP.cpp
+./avidemux/ADM_videoFilter/ADM_vidVlad.h
+./avidemux/ADM_videoFilter/ADM_vidKernelDeint.h
+./avidemux/ADM_videoFilter/ADM_vidForcedPP.h
+./avidemux/ADM_videoFilter/ADM_vidSoften.cpp
+./avidemux/ADM_videoFilter/ADM_vidFade.cpp
+./avidemux/ADM_videoFilter/ADM_vidBSmear.cpp
+./avidemux/ADM_videoFilter/ADM_vidFields.cpp
+./avidemux/ADM_videoFilter/ADM_vidAddBorder.cpp
+./avidemux/ADM_videoFilter/ADM_vidKernelDeint.cpp
+./avidemux/ADM_videoFilter/ADM_vidMsmooth.cpp
+./avidemux/ADM_videoFilter/ADM_vidResampleFPS.cpp
+./avidemux/ADM_videoFilter/ADM_vidFade_param.h
+./avidemux/ADM_videoFilter/ADM_vidMcDeint_param.h
+./avidemux/ADM_videoFilter/ADM_vidTDeint_param.h
+./avidemux/ADM_videoFilter/ADM_lavpp_deint.cpp
+./avidemux/ADM_videoFilter/ADM_vidMSharpen_param.h
+./avidemux/ADM_videoFilter/ADM_vidMPLD3Dlow.cpp
+./avidemux/ADM_videoFilter/ADM_vidAddBorder.h
+./avidemux/ADM_videoFilter/ADM_vidMosaic_param.h
+./avidemux/ADM_videoFilter/ADM_lavpp_deintparam.h
+./avidemux/ADM_videoFilter/foo.cpp
+./avidemux/ADM_videoFilter/ADM_vidDeinterlace.h
+./avidemux/ADM_videoFilter/ADM_vidDropOut.h
+./avidemux/ADM_videoFilter/ADMmpdetc.cpp
+./avidemux/ADM_videoFilter/ADM_vidMosaic.cpp
+./avidemux/ADM_videoFilter/ADM_vidPulldown.h
+./avidemux/ADM_videoFilter/ADM_vidSoften.h
+./avidemux/ADM_videoFilter/ADM_vidStabilize.cpp
+./avidemux/ADM_videoFilter/ADM_vidMPLD3Dlow.h
+./avidemux/ADM_videoFilter/ADM_vidDropOut.cpp
+./avidemux/ADM_videoFilter/ADM_vidDenoise.cpp
+./avidemux/ADM_videoFilter/ADM_vidDGbob.cpp
+./avidemux/ADM_videoFilter/ADM_vidChroma.cpp
+./avidemux/ADM_videoFilter/ADM_vidTdeint.cpp
+./avidemux/ADM_videoFilter/ADM_vidMPLD3D.h
+./avidemux/ADM_videoFilter/ADM_vidMPLD3D.cpp
+./avidemux/ADM_videoFilter/ADM_vidDenoise.h
+./avidemux/ADM_videoFilter/ADM_vidPulldown.cpp
+./avidemux/ADM_videoFilter/ADM_vidBlendRemoval_param.h
+./avidemux/ADM_videoFilter/ADM_vidAss_Params.h
+./avidemux/ADM_videoFilter/ADM_vidChroma.h
+./avidemux/ADM_videoFilter/ADM_vidMPLResize.cpp
+./avidemux/ADM_videoFilter/ADM_vidLargeMedian.cpp
+./avidemux/ADM_videoFilter/ADM_vidLargeMedian.h
+./avidemux/ADM_videoFilter/ADM_vidLuma.cpp
+./avidemux/ADM_videoFilter/ADM_vidResize25.cpp
+./avidemux/ADM_videoFilter/ADM_vidFlipV.cpp
+./avidemux/ADM_videoFilter/ADM_vidFlipV.h
+./avidemux/ADM_videoFilter/ADM_vidStabilize.h
+./avidemux/ADM_videoFilter/ADM_vidUVSwap.h
+./avidemux/ADM_videoFilter/ADM_vidUVSwap.cpp
+./avidemux/ADM_videoFilter/ADM_resizebis.cpp
+./avidemux/ADM_videoFilter/ADM_vidPalSmart.cpp
+./avidemux/ADM_videoFilter/ADM_vidPalSmart.h
+./avidemux/ADM_videoFilter/ADM_vidSwapFields.h
+./avidemux/ADM_videoFilter/ADM_vidSwapSmart.h
+./avidemux/ADM_videoFilter/ADM_vidSwapSmart.cpp
+./avidemux/ADM_videoFilter/ADM_resizeter.cpp
+./avidemux/ADM_videoFilter/ADM_vidSeparateField.h
+./avidemux/ADM_videoFilter/ADM_vidBlendRemoval.cpp
+./avidemux/ADM_videoFilter/ADM_vidSeparateField.cpp
+./avidemux/ADM_videoFilter/ADM_vidChromaShift.h
+./avidemux/ADM_videoFilter/ADM_guiResize.cpp
+./avidemux/ADM_videoFilter/ADM_vidReverse.cpp
+./avidemux/ADM_videoFilter/ADM_vidPalShift.h
+./avidemux/ADM_videoFilter/ADM_vidDecDec.cpp
+./avidemux/ADM_videoFilter/ADM_vidPalShift.cpp
+./avidemux/ADM_videoFilter/ADM_vidASS.cpp
+./avidemux/ADM_videoFilter/ADM_vidAnimated.h
+./avidemux/ADM_videoFilter/ADM_vidDeintASM.cpp
+./avidemux/ADM_videoFilter/ADM_vidResize.cpp
+./avidemux/ADM_videoFilter/ADM_vidRotate.cpp
+./avidemux/ADM_videoFilter/ADM_vidDecTelecide.cpp
+./avidemux/ADM_videoFilter/ADM_vidYadif.cpp
+./avidemux/ADM_videoFilter/ADM_vidDecTelecide.h
+./avidemux/ADM_videoFilter/ADM_vidDecTel_param.h
+./avidemux/ADM_videoFilter/ADM_vidAnimated.cpp
+./avidemux/ADM_videoFilter/ADM_vidDecDec_param.h
+./avidemux/ADM_videoFilter/ADM_vidHardIvtcRemoval.cpp
+./avidemux/ADM_videoFilter/ADM_vidMSmooth_param.h
+./avidemux/ADM_videoFilter/ADM_vidBlend.cpp
+./avidemux/ADM_videoFilter/ADM_vidChromaShift_param.h
+./avidemux/ADM_videoFilter/ADM_vidChromaShift.cpp
+./avidemux/ADM_videoFilter/ADM_vidAnimated_param.h
+./avidemux/ADM_toolkit/ADM_intfloat.cpp
+./avidemux/ADM_toolkit/filesel.h
+./avidemux/ADM_toolkit/ADM_audioQueue.h
+./avidemux/ADM_toolkit/automation.cpp
+./avidemux/ADM_toolkit/ADM_packetQueue.h
+./avidemux/ADM_toolkit/ADM_intfloat.h
+./avidemux/ADM_toolkit/bitmap.h
+./avidemux/ADM_toolkit/filesel.cpp
+./avidemux/ADM_toolkit/ADM_audioQueue.cpp
+./avidemux/ADM_toolkit/ADM_packetQueue.cpp
+./avidemux/ADM_filter/filter_saveload.cpp
+./avidemux/ADM_filter/video_filters.h
+./avidemux/ADM_filter/vidVCD.h
 ./avidemux/ADM_filter/filter.cpp
 ./avidemux/ADM_filter/filter_declaration.cpp
+./avidemux/ADM_filter/ADM_vidDummyFilter.cpp
+./avidemux/ADM_filter/vidVCD.cpp
 ./avidemux/ADM_filter/filter_dylib.cpp
-./avidemux/ADM_filter/filter_saveload.cpp
-./avidemux/ADM_filter/video_filters.h
-./avidemux/ADM_filter/vidVCD.cpp
-./avidemux/ADM_filter/vidVCD.h
-./avidemux/ADM_inputs/ADM_3gp/ADM_3gp.cpp
-./avidemux/ADM_inputs/ADM_3gp/ADM_3gp.h
-./avidemux/ADM_inputs/ADM_3gp/ADM_3gpAudio.cpp
-./avidemux/ADM_inputs/ADM_3gp/ADM_atom.cpp
-./avidemux/ADM_inputs/ADM_3gp/ADM_atom.h
-./avidemux/ADM_inputs/ADM_3gp/ADM_infoextractor.cpp
-./avidemux/ADM_inputs/ADM_asf/ADM_asf.cpp
+./avidemux/ADM_editor/ADM_edSearch.cpp
+./avidemux/ADM_editor/ADMedAVIAUD.cpp
+./avidemux/ADM_editor/ADM_edStub.cpp
+./avidemux/ADM_editor/ADM_edRender.cpp
+./avidemux/ADM_editor/ADM_Video.cpp
+./avidemux/ADM_editor/ADM_edIdentify.cpp
+./avidemux/ADM_editor/ADM_edAudio.cpp
+./avidemux/ADM_editor/ADM_edit.cpp
+./avidemux/ADM_editor/ADM_edLoadSave.cpp
+./avidemux/ADM_editor/ADM_edCache.cpp
+./avidemux/ADM_editor/ADM_Video.h
+./avidemux/ADM_editor/ADM_outputfmt.h
+./avidemux/ADM_editor/ADM_edFrameType.cpp
+./avidemux/ADM_editor/ADM_edCache.h
+./avidemux/ADM_preview.cpp
+./avidemux/main.cpp
+./avidemux/ADM_codecs/ADM_codecNull.h
+./avidemux/ADM_codecs/ADM_mjpegEncode.cpp
+./avidemux/ADM_codecs/ADM_uyvy.h
+./avidemux/ADM_codecs/ADM_png.cpp
+./avidemux/ADM_codecs/ADM_rgb16.h
+./avidemux/ADM_codecs/ADM_xvidcvs.cpp
+./avidemux/ADM_codecs/ADM_ffmp43.cpp
+./avidemux/ADM_codecs/ADM_x264param.h
+./avidemux/ADM_codecs/ADM_theora_dec.cpp
+./avidemux/ADM_codecs/ADM_ffmpegConfig.h
+./avidemux/ADM_codecs/ADM_codecs.cpp
+./avidemux/ADM_codecs/ADM_xvideco.cpp
+./avidemux/ADM_codecs/ADM_xvid4.h
+./avidemux/ADM_codecs/ADM_ffmpeg.cpp
+./avidemux/ADM_codecs/ADM_mjpeg.h
+./avidemux/ADM_codecs/ADM_x264.h
+./avidemux/ADM_codecs/ADM_uyvy.cpp
+./avidemux/ADM_codecs/ADM_theora_enc.h
+./avidemux/ADM_codecs/ADM_xvid.h
+./avidemux/ADM_codecs/ADM_rgb16.cpp
+./avidemux/ADM_codecs/ADM_xvid4param.h
+./avidemux/ADM_codecs/ADM_mjpegEncode.h
+./avidemux/ADM_codecs/ADM_png.h
+./avidemux/ADM_codecs/ADM_mpeg.h
+./avidemux/ADM_codecs/ADM_xvid4.cpp
+./avidemux/ADM_codecs/ADM_theora_dec.h
+./avidemux/ADM_codecs/ADM_mjpeg.cpp
+./avidemux/ADM_codecs/ADM_x264.cpp
+./avidemux/ADM_codecs/ADM_ffmp43.h
+./avidemux/ADM_codecs/ADM_xvideco.h
+./avidemux/ADM_codecs/ADM_ffmpeg.h
+./avidemux/ADM_codecs/ADM_xvid.cpp
+./avidemux/ADM_codecs/ADM_codec.h
+./avidemux/ADM_codecs/ADM_mpeg.cpp
+./avidemux/ADM_audio/ADM_mp3info.h
+./avidemux/ADM_audio/audiosource_ext.cpp
+./avidemux/ADM_audio/audioex.h
+./avidemux/ADM_audio/audio_mpegidentify.cpp
+./avidemux/ADM_audio/audiosource_ext.h
+./avidemux/ADM_audio/audiowavex.cpp
+./avidemux/ADM_audio/audiomp3ex.cpp
+./avidemux/ADM_audio/audioac3ex.cpp
+./avidemux/ADM_audio/ADM_aacinfo.h
+./avidemux/ADM_audio/ADM_dcainfo.h
+./avidemux/ADM_audio/ADM_a52info.h
+./avidemux/ADM_audio/ADM_audiodef.h
+./avidemux/ADM_audio/ADM_dcainfo.cpp
+./avidemux/ADM_audio/ADM_a52info.cpp
+./avidemux/ADM_audio/ADM_mp3info.cpp
+./avidemux/ADM_audio/audiogen.cpp
+./avidemux/ADM_audio/ADM_aacinfo.cpp
+./avidemux/ADM_audio/audio_packetizer.cpp
+./avidemux/ADM_audio/audiotimeline.cpp
+./avidemux/ADM_script/ADM_AvidemuxVideo.h
+./avidemux/ADM_script/StdFile.h
+./avidemux/ADM_script/DirectorySearch.h
+./avidemux/ADM_script/ADM_JSDirectorySearch.cpp
+./avidemux/ADM_script/ADM_Avidemux.cpp
+./avidemux/ADM_script/ADM_JSAvidemux.h
+./avidemux/ADM_script/ADM_Avidemux.h
+./avidemux/ADM_script/ADM_container.h
+./avidemux/ADM_script/ADM_JSDirectorySearch.h
+./avidemux/ADM_script/ADM_JSGlobal.cpp
+./avidemux/ADM_script/adm_scanner.h
+./avidemux/ADM_script/ADM_JSGlobal.h
+./avidemux/ADM_script/ADM_AvidemuxAudio.cpp
+./avidemux/ADM_script/ADM_JSAvidemuxAudio.h
+./avidemux/ADM_script/ADM_AvidemuxVideo.cpp
+./avidemux/ADM_script/ADM_AvidemuxAudio.h
+./avidemux/ADM_script/ADM_JSAvidemuxVideo.h
+./avidemux/ADM_script/ADM_JSAvidemux.cpp
+./avidemux/ADM_script/ADM_JSFunctions.cpp
+./avidemux/ADM_script/DirectorySearch.cpp
+./avidemux/ADM_script/ADM_JSAvidemuxAudio.cpp
+./avidemux/ADM_script/ADM_JSAvidemuxVideo.cpp
+./avidemux/ADM_video/ADM_vidNull.cpp
+./avidemux/ADM_video/ADM_vobsubinfo.h
+./avidemux/ADM_video/ADM_vidFieldUtil.cpp
+./avidemux/ADM_video/ADM_vidClean.h
+./avidemux/ADM_video/ADM_vidASharp_param.h
+./avidemux/ADM_video/ADM_vidColorYuv.h
+./avidemux/ADM_video/ADM_vidEqualizer.cpp
+./avidemux/ADM_video/ADM_vidFont.cpp
+./avidemux/ADM_video/ADM_vidColorYuv_param.h
+./avidemux/ADM_video/ADM_vidSRTload.cpp
+./avidemux/ADM_video/ADM_vidAsharp.cpp
+./avidemux/ADM_video/ADM_vidMPdelogo.h
+./avidemux/ADM_video/ADM_vidCached.h
+./avidemux/ADM_video/ADM_videoInfoExtractor.h
+./avidemux/ADM_video/ADM_confCouples.cpp
+./avidemux/ADM_video/ADM_vidSRT.h
+./avidemux/ADM_video/swscale_internal.h
+./avidemux/ADM_video/ADM_vidHue.cpp
+./avidemux/ADM_video/ADM_vidVobsub.cpp
+./avidemux/ADM_video/ADM_vidClean.cpp
+./avidemux/ADM_video/ADM_vidColorYuv.cpp
+./avidemux/ADM_video/ADM_vidUnblend.cpp
+./avidemux/ADM_video/ADM_vidHue.h
+./avidemux/ADM_video/ADM_vidRaw.cpp
+./avidemux/ADM_video/ADM_vidPartial_param.h
+./avidemux/ADM_video/ADM_vidFieldUnblend.cpp
+./avidemux/ADM_video/ADM_vidFieldUtil.h
+./avidemux/ADM_video/ADM_vidPartial.cpp
+./avidemux/ADM_video/ADM_vidContrast.cpp
+./avidemux/ADM_video/ADM_vidCNR2_param.h
+./avidemux/ADM_video/ADM_videoNull.h
+./avidemux/ADM_video/ADM_vidEqualizer.h
+./avidemux/ADM_video/ADM_reorderTemplate.cpp
+./avidemux/ADM_video/ADM_vidEq2.h
+./avidemux/ADM_video/ADM_vidCached.cpp
+./avidemux/ADM_video/ADM_genvideo.cpp
+./avidemux/ADM_video/ADM_vidContrast.h
+./avidemux/ADM_video/ADM_interlaced.h
+./avidemux/ADM_video/ADM_confCouple.h
+./avidemux/ADM_video/ADM_cache.cpp
+./avidemux/ADM_video/ADM_vidSRTRender.cpp
+./avidemux/ADM_video/ADM_vobsubinfo.cpp
+./avidemux/ADM_video/ADM_vidCNR2.cpp
+./avidemux/ADM_video/ADM_interlaced.cpp
+./avidemux/ADM_video/ADM_mpdetc.h
+./avidemux/ADM_video/ADM_vidDelta.cpp
+./avidemux/ADM_video/ADM_vidVobSub.h
+./avidemux/ADM_video/ADM_vidVobSubRender.cpp
+./avidemux/ADM_video/ADM_vidPartial.h
+./avidemux/ADM_video/ADM_vidCommonFilter.h
+./avidemux/ADM_video/ADM_vidSRT.cpp
+./avidemux/ADM_video/ADM_vidFont.h
+./avidemux/ADM_video/ADM_vidUnblend_param.h
+./avidemux/ADM_video/ADM_vidEq2.cpp
+./avidemux/ADM_video/ADM_vidCrop.cpp
+./avidemux/ADM_video/ADM_cache.h
+./avidemux/ADM_video/ADM_vidMPdelogo.cpp
+./avidemux/ADM_video/mmx_macros.h
+./avidemux/ADM_audiodevice/ADM_deviceWin32.cpp
+./avidemux/ADM_audiodevice/ADM_audiodevice.h
+./avidemux/ADM_audiodevice/ADM_deviceWin32.h
+./avidemux/ADM_audiodevice/ADM_deviceArts.cpp
+./avidemux/ADM_audiodevice/ADM_deviceoss.h
+./avidemux/ADM_audiodevice/ADM_deviceAudioCore.cpp
+./avidemux/ADM_audiodevice/ADM_deviceEsd.cpp
+./avidemux/ADM_audiodevice/ADM_deviceArts.h
+./avidemux/ADM_audiodevice/ADM_deviceAudioCore.h
+./avidemux/ADM_audiodevice/ADM_deviceEsd.h
+./avidemux/ADM_audiodevice/ADM_deviceALSA.cpp
+./avidemux/ADM_audiodevice/ADM_deviceSDL.cpp
+./avidemux/ADM_audiodevice/ADM_deviceALSA.h
+./avidemux/ADM_audiodevice/ADM_deviceSDL.h
+./avidemux/ADM_audiodevice/ADM_deviceJack.h
+./avidemux/ADM_audiodevice/oss_out.cpp
+./avidemux/ADM_audiodevice/audio_out.h
+./avidemux/ADM_audiodevice/ADM_audiodevice.cpp
+./avidemux/ADM_audiodevice/ADM_deviceJack.cpp
+./avidemux/ADM_audiodevice/ADM_deviceoss.cpp
+./avidemux/ADM_ocr/adm_glyph.cpp
+./avidemux/ADM_ocr/ADM_leftturn.h
+./avidemux/ADM_ocr/adm_glyph.h
+./avidemux/ADM_ocr/adm_leftturn.cpp
+./avidemux/ADM_ocr/ADM_vob2vobsub.cpp
+./avidemux/ADM_ocr/ADM_ocr.cpp
+./avidemux/ADM_ocr/ADM_ocr.h
+./avidemux/gtkgui.h
+./avidemux/ADM_lavcodec.h
+./avidemux/prototype.h
+./avidemux/GUI_jobs.cpp
+./avidemux/avi_vars.h
+./avidemux/gui_navigate.cpp
+./avidemux/ADM_infoExtractor/ADM_infoextractor.cpp
+./avidemux/ADM_assert.h
+./avidemux/gui_autodrive.cpp
+./avidemux/gui_savenew.cpp
+./avidemux/guiplay.cpp
+./avidemux/gtk_gui.cpp
+./avidemux/ADM_osSupport/ADM_memcpy.cpp
+./avidemux/ADM_osSupport/ADM_quota.cpp
+./avidemux/ADM_osSupport/ADM_cpuCap.h
+./avidemux/ADM_osSupport/ADM_misc.h
+./avidemux/ADM_osSupport/ADM_threads.h
+./avidemux/ADM_osSupport/ADM_threads.cpp
+./avidemux/ADM_osSupport/ADM_memory.cpp
+./avidemux/ADM_osSupport/ADM_debug.cpp
+./avidemux/ADM_osSupport/ADM_debugID.h
+./avidemux/ADM_osSupport/ADM_debug.h
+./avidemux/ADM_osSupport/ADM_quota.h
+./avidemux/ADM_osSupport/TLK_clock.h
+./avidemux/ADM_osSupport/TLK_clock.cpp
+./avidemux/ADM_osSupport/ADM_queue.cpp
+./avidemux/ADM_osSupport/ADM_queue.h
+./avidemux/ADM_osSupport/ADM_misc.cpp
+./avidemux/ADM_osSupport/ADM_crashdump.cpp
+./avidemux/ADM_osSupport/win32.cpp
+./avidemux/ADM_osSupport/ADM_memsupport.cpp
+./avidemux/ADM_osSupport/ADM_fileio.cpp
+./avidemux/ADM_osSupport/ADM_cpuCap.cpp
+./avidemux/ADM_outputs/oplug_mp4/oplug_mp4.h
+./avidemux/ADM_outputs/oplug_mp4/oplug_mp4.cpp
+./avidemux/ADM_outputs/oplug_mpeg/op_mpegpass.cpp
+./avidemux/ADM_outputs/oplug_mpegFF/oplug_vcdff.h
+./avidemux/ADM_outputs/oplug_mpegFF/oplug_encodervcd.h
+./avidemux/ADM_outputs/oplug_mpegFF/oplug_vcdff.cpp
+./avidemux/ADM_outputs/oplug_ogm/op_ogpage.cpp
+./avidemux/ADM_outputs/oplug_ogm/op_ogsaveprocess.cpp
+./avidemux/ADM_outputs/oplug_ogm/op_ogsave.cpp
+./avidemux/ADM_outputs/oplug_ogm/op_ogaudio.cpp
+./avidemux/ADM_outputs/oplug_ogm/op_ogpage.h
+./avidemux/ADM_outputs/oplug_ogm/op_ogsavecopy.cpp
+./avidemux/ADM_outputs/oplug_ogm/op_ogsavecopt.cpp
+./avidemux/ADM_outputs/oplug_ogm/op_ogsave.h
+./avidemux/ADM_outputs/oplug_avi/op_saveprocess.h
+./avidemux/ADM_outputs/oplug_avi/GUI_mux.h
+./avidemux/ADM_outputs/oplug_avi/op_avisavedual.cpp
+./avidemux/ADM_outputs/oplug_avi/op_savesmart.cpp
+./avidemux/ADM_outputs/oplug_avi/op_avisavecopy.cpp
+./avidemux/ADM_outputs/oplug_avi/op_aviwrite.cpp
+./avidemux/ADM_outputs/oplug_avi/op_saveprocess.cpp
+./avidemux/ADM_outputs/oplug_avi/op_savecopy.h
+./avidemux/ADM_outputs/oplug_avi/avilist.cpp
+./avidemux/ADM_outputs/oplug_avi/avilist.h
+./avidemux/ADM_outputs/oplug_avi/op_avisavecopy_unpack.cpp
+./avidemux/ADM_outputs/oplug_avi/op_avisave.h
+./avidemux/ADM_outputs/oplug_avi/op_avisavecopy_pack.cpp
+./avidemux/ADM_outputs/oplug_avi/op_avisave.cpp
 ./avidemux/ADM_inputs/ADM_asf/ADM_asf.h
-./avidemux/ADM_inputs/ADM_asf/ADM_asfChunk.cpp
 ./avidemux/ADM_inputs/ADM_asf/ADM_asfIo.h
-./avidemux/ADM_inputs/ADM_asf/ADM_asfPacket.cpp
 ./avidemux/ADM_inputs/ADM_asf/ADM_asfPacket.h
+./avidemux/ADM_inputs/ADM_asf/ADM_asf.cpp
 ./avidemux/ADM_inputs/ADM_asf/ADM_asf_audio.cpp
-./avidemux/ADM_inputs/ADM_avsproxy/ADM_avsproxy.cpp
-./avidemux/ADM_inputs/ADM_avsproxy/ADM_avsproxy.h
-./avidemux/ADM_inputs/ADM_avsproxy/ADM_avsproxy_internal.h
-./avidemux/ADM_inputs/ADM_avsproxy/ADM_avsproxy_net.cpp
-./avidemux/ADM_inputs/ADM_h263/ADM_h263.cpp
+./avidemux/ADM_inputs/ADM_asf/ADM_asfChunk.cpp
+./avidemux/ADM_inputs/ADM_asf/ADM_asfPacket.cpp
+./avidemux/ADM_inputs/ADM_h263/ADM_mp4.cpp
+./avidemux/ADM_inputs/ADM_h263/bitsRead.h
 ./avidemux/ADM_inputs/ADM_h263/ADM_h263.h
-./avidemux/ADM_inputs/ADM_h263/ADM_mp4.cpp
 ./avidemux/ADM_inputs/ADM_h263/bitsRead.cpp
-./avidemux/ADM_inputs/ADM_h263/bitsRead.h
+./avidemux/ADM_inputs/ADM_h263/ADM_h263.cpp
+./avidemux/ADM_inputs/ADM_inpics/bitmap.h
+./avidemux/ADM_inputs/ADM_inpics/ADM_pics.h
 ./avidemux/ADM_inputs/ADM_inpics/ADM_pics.cpp
-./avidemux/ADM_inputs/ADM_inpics/ADM_pics.h
-./avidemux/ADM_inputs/ADM_inpics/bitmap.h
-./avidemux/ADM_inputs/ADM_matroska/ADM_ebml.h
-./avidemux/ADM_inputs/ADM_matroska/ADM_mkv.cpp
-./avidemux/ADM_inputs/ADM_matroska/ADM_mkv.h
-./avidemux/ADM_inputs/ADM_matroska/ADM_mkvEntries.cpp
-./avidemux/ADM_inputs/ADM_matroska/ADM_mkvIndexer.cpp
-./avidemux/ADM_inputs/ADM_matroska/ADM_mkvTrackType.cpp
-./avidemux/ADM_inputs/ADM_matroska/ADM_mkv_audio.cpp
-./avidemux/ADM_inputs/ADM_matroska/ebml.cpp
-./avidemux/ADM_inputs/ADM_matroska/mkv_tagenum.h
-./avidemux/ADM_inputs/ADM_matroska/mkv_tags.cpp
-./avidemux/ADM_inputs/ADM_matroska/mkv_tags.h
+./avidemux/ADM_inputs/ADM_mpegdemuxer/dmx_demuxerMSDVR.h
+./avidemux/ADM_inputs/ADM_mpegdemuxer/dmx_demuxerES.cpp
 ./avidemux/ADM_inputs/ADM_mpegdemuxer/dmx_audio.cpp
+./avidemux/ADM_inputs/ADM_mpegdemuxer/dmx_indexer.h
+./avidemux/ADM_inputs/ADM_mpegdemuxer/dmx_demuxerEs.h
 ./avidemux/ADM_inputs/ADM_mpegdemuxer/dmx_audio.h
+./avidemux/ADM_inputs/ADM_mpegdemuxer/dmx_mpegstartcode.h
+./avidemux/ADM_inputs/ADM_mpegdemuxer/dmx_io.cpp
 ./avidemux/ADM_inputs/ADM_mpegdemuxer/dmx_demuxer.cpp
+./avidemux/ADM_inputs/ADM_mpegdemuxer/dmx_identify.cpp
+./avidemux/ADM_inputs/ADM_mpegdemuxer/dmx_video.h
+./avidemux/ADM_inputs/ADM_mpegdemuxer/dmx_demuxerPS.cpp
+./avidemux/ADM_inputs/ADM_mpegdemuxer/dmx_io.h
+./avidemux/ADM_inputs/ADM_mpegdemuxer/dmx_probe.h
 ./avidemux/ADM_inputs/ADM_mpegdemuxer/dmx_demuxer.h
-./avidemux/ADM_inputs/ADM_mpegdemuxer/dmx_demuxerES.cpp
-./avidemux/ADM_inputs/ADM_mpegdemuxer/dmx_demuxerEs.h
-./avidemux/ADM_inputs/ADM_mpegdemuxer/dmx_demuxerMSDVR.cpp
-./avidemux/ADM_inputs/ADM_mpegdemuxer/dmx_demuxerMSDVR.h
-./avidemux/ADM_inputs/ADM_mpegdemuxer/dmx_demuxerPS.cpp
+./avidemux/ADM_inputs/ADM_mpegdemuxer/dmx_identify.h
+./avidemux/ADM_inputs/ADM_mpegdemuxer/dmx_demuxerTS.cpp
 ./avidemux/ADM_inputs/ADM_mpegdemuxer/dmx_demuxerPS.h
-./avidemux/ADM_inputs/ADM_mpegdemuxer/dmx_demuxerTS.cpp
 ./avidemux/ADM_inputs/ADM_mpegdemuxer/dmx_demuxerTS.h
-./avidemux/ADM_inputs/ADM_mpegdemuxer/dmx_identify.cpp
-./avidemux/ADM_inputs/ADM_mpegdemuxer/dmx_identify.h
+./avidemux/ADM_inputs/ADM_mpegdemuxer/dmx_demuxerMSDVR.cpp
 ./avidemux/ADM_inputs/ADM_mpegdemuxer/dmx_indexer.cpp
-./avidemux/ADM_inputs/ADM_mpegdemuxer/dmx_indexer.h
-./avidemux/ADM_inputs/ADM_mpegdemuxer/dmx_indexer_h264.cpp
-./avidemux/ADM_inputs/ADM_mpegdemuxer/dmx_indexer_internal.h
-./avidemux/ADM_inputs/ADM_mpegdemuxer/dmx_indexer_mpeg2.cpp
-./avidemux/ADM_inputs/ADM_mpegdemuxer/dmx_io.cpp
-./avidemux/ADM_inputs/ADM_mpegdemuxer/dmx_io.h
-./avidemux/ADM_inputs/ADM_mpegdemuxer/dmx_mpegstartcode.h
-./avidemux/ADM_inputs/ADM_mpegdemuxer/dmx_probe.cpp
-./avidemux/ADM_inputs/ADM_mpegdemuxer/dmx_probe.h
 ./avidemux/ADM_inputs/ADM_mpegdemuxer/dmx_probeTS.cpp
 ./avidemux/ADM_inputs/ADM_mpegdemuxer/dmx_video.cpp
-./avidemux/ADM_inputs/ADM_mpegdemuxer/dmx_video.h
-./avidemux/ADM_inputs/ADM_nuv/ADM_nuv.cpp
+./avidemux/ADM_inputs/ADM_mpegdemuxer/dmx_probe.cpp
+./avidemux/ADM_inputs/ADM_mpegdemuxer/dmx_indexer_mpeg2.cpp
+./avidemux/ADM_inputs/ADM_mpegdemuxer/dmx_indexer_internal.h
+./avidemux/ADM_inputs/ADM_mpegdemuxer/dmx_indexer_h264.cpp
 ./avidemux/ADM_inputs/ADM_nuv/ADM_nuv.h
-./avidemux/ADM_inputs/ADM_nuv/ADM_nuvAudio.cpp
-./avidemux/ADM_inputs/ADM_nuv/ADM_rtGlob.h
-./avidemux/ADM_inputs/ADM_nuv/lzoconf.h
-./avidemux/ADM_inputs/ADM_nuv/minilzo.h
 ./avidemux/ADM_inputs/ADM_nuv/mmx.h
 ./avidemux/ADM_inputs/ADM_nuv/nuppel.h
-./avidemux/ADM_inputs/ADM_nuv/RTjpeg.h
 ./avidemux/ADM_inputs/ADM_nuv/RTjpegN.cpp
+./avidemux/ADM_inputs/ADM_nuv/ADM_nuvAudio.cpp
 ./avidemux/ADM_inputs/ADM_nuv/RTjpegN.h
+./avidemux/ADM_inputs/ADM_nuv/lzoconf.h
+./avidemux/ADM_inputs/ADM_nuv/ADM_rtGlob.h
+./avidemux/ADM_inputs/ADM_nuv/minilzo.h
 ./avidemux/ADM_inputs/ADM_nuv/RToldformat.cpp
+./avidemux/ADM_inputs/ADM_nuv/RTjpeg.h
+./avidemux/ADM_inputs/ADM_nuv/ADM_nuv.cpp
+./avidemux/ADM_inputs/ADM_ogm/ADM_ogmpages.cpp
+./avidemux/ADM_inputs/ADM_ogm/ADM_ogmAudio.cpp
+./avidemux/ADM_inputs/ADM_ogm/ADM_ogmreorder.cpp
+./avidemux/ADM_inputs/ADM_ogm/ADM_ogm.h
+./avidemux/ADM_inputs/ADM_ogm/ADM_ogmpages.h
 ./avidemux/ADM_inputs/ADM_ogm/ADM_oghead.h
 ./avidemux/ADM_inputs/ADM_ogm/ADM_ogm.cpp
-./avidemux/ADM_inputs/ADM_ogm/ADM_ogm.h
-./avidemux/ADM_inputs/ADM_ogm/ADM_ogmAudio.cpp
-./avidemux/ADM_inputs/ADM_ogm/ADM_ogmpages.cpp
-./avidemux/ADM_inputs/ADM_ogm/ADM_ogmpages.h
-./avidemux/ADM_inputs/ADM_ogm/ADM_ogmreorder.cpp
-./avidemux/ADM_inputs/ADM_openDML/ADM_odml_audio.cpp
+./avidemux/ADM_inputs/ADM_openDML/ADM_opendml_reorder.cpp
 ./avidemux/ADM_inputs/ADM_openDML/ADM_odml_audio.h
+./avidemux/ADM_inputs/ADM_openDML/ADM_openDML.h
 ./avidemux/ADM_inputs/ADM_openDML/ADM_odml_odml.cpp
+./avidemux/ADM_inputs/ADM_openDML/ADM_riff.cpp
+./avidemux/ADM_inputs/ADM_openDML/ADM_riff.h
+./avidemux/ADM_inputs/ADM_openDML/ADM_odml_audio.cpp
 ./avidemux/ADM_inputs/ADM_openDML/ADM_odml_regular.cpp
 ./avidemux/ADM_inputs/ADM_openDML/ADM_openDML.cpp
-./avidemux/ADM_inputs/ADM_openDML/ADM_openDML.h
 ./avidemux/ADM_inputs/ADM_openDML/ADM_openDMLDepack.cpp
 ./avidemux/ADM_inputs/ADM_openDML/ADM_opendml_reindex.cpp
-./avidemux/ADM_inputs/ADM_openDML/ADM_opendml_reorder.cpp
-./avidemux/ADM_inputs/ADM_openDML/ADM_riff.cpp
-./avidemux/ADM_inputs/ADM_openDML/ADM_riff.h
-./avidemux/ADM_lavcodec.h
+./avidemux/ADM_inputs/ADM_avsproxy/ADM_avsproxy.h
+./avidemux/ADM_inputs/ADM_avsproxy/ADM_avsproxy_net.cpp
+./avidemux/ADM_inputs/ADM_avsproxy/ADM_avsproxy.cpp
+./avidemux/ADM_inputs/ADM_avsproxy/ADM_avsproxy_internal.h
+./avidemux/ADM_inputs/ADM_matroska/ADM_mkv.cpp
+./avidemux/ADM_inputs/ADM_matroska/ADM_mkv.h
+./avidemux/ADM_inputs/ADM_matroska/ADM_mkvTrackType.cpp
+./avidemux/ADM_inputs/ADM_matroska/ADM_mkvIndexer.cpp
+./avidemux/ADM_inputs/ADM_matroska/ADM_ebml.h
+./avidemux/ADM_inputs/ADM_matroska/ebml.cpp
+./avidemux/ADM_inputs/ADM_matroska/mkv_tagenum.h
+./avidemux/ADM_inputs/ADM_matroska/mkv_tags.cpp
+./avidemux/ADM_inputs/ADM_matroska/mkv_tags.h
+./avidemux/ADM_inputs/ADM_matroska/ADM_mkv_audio.cpp
+./avidemux/ADM_inputs/ADM_matroska/ADM_mkvEntries.cpp
+./avidemux/ADM_inputs/ADM_mp4/ADM_atom.cpp
+./avidemux/ADM_inputs/ADM_mp4/ADM_atom.h
+./avidemux/ADM_inputs/ADM_mp4/ADM_mp4.cpp
+./avidemux/ADM_inputs/ADM_mp4/ADM_mp4.h
+./avidemux/ADM_inputs/ADM_mp4/ADM_mp4audio.cpp
+./avidemux/ADM_inputs/ADM_mp4/ADM_mp4Tree.h
+./avidemux/ADM_inputs/ADM_mp4/ADM_mp4Leaf.h
+./avidemux/ADM_inputs/ADM_mp4/ADM_mp4Leaf.cpp
+./avidemux/ADM_inputs/ADM_mp4/ADM_mp4Analyzer.cpp
+./avidemux/ADM_inputs/ADM_mp4/ADM_mp4Indexer.cpp
+./avidemux/ADM_inputs/ADM_flv/ADM_flv.cpp
+./avidemux/ADM_inputs/ADM_flv/ADM_flv.h
+./avidemux/ADM_inputs/ADM_flv/ADM_flvIndex.cpp
+./avidemux/ADM_inputs/ADM_flv/ADM_flvAudio.cpp
+./avidemux/ADM_inputs/ADM_amv/ADM_amvAudio.cpp
+./avidemux/ADM_inputs/ADM_amv/ADM_amv.cpp
+./avidemux/ADM_inputs/ADM_amv/ADM_amv.h
+./avidemux/ADM_libraries/ADM_lavcodec/i386/mmx.h
+./avidemux/ADM_libraries/ADM_lavcodec/i386/dsputil_mmx_avg.h
+./avidemux/ADM_libraries/ADM_lavcodec/i386/dsputil_mmx_rnd.h
+./avidemux/ADM_libraries/ADM_lavcodec/i386/dsputil_mmx_qns.h
+./avidemux/ADM_libraries/ADM_lavcodec/i386/vp3dsp_sse2.h
+./avidemux/ADM_libraries/ADM_lavcodec/i386/mathops.h
+./avidemux/ADM_libraries/ADM_lavcodec/i386/vp3dsp_mmx.h
+./avidemux/ADM_libraries/ADM_lavcodec/ppc/gcc_fixes.h
+./avidemux/ADM_libraries/ADM_lavcodec/ppc/dsputil_altivec.h
+./avidemux/ADM_libraries/ADM_lavcodec/ppc/dsputil_ppc.h
+./avidemux/ADM_libraries/ADM_lavcodec/ppc/mathops.h
+./avidemux/ADM_libraries/ADM_lavcodec/ppc/types_altivec.h
 ./avidemux/ADM_libraries/ADM_lavcodec/ac3.h
-./avidemux/ADM_libraries/ADM_lavcodec/ac3tab.h
-./avidemux/ADM_libraries/ADM_lavcodec/amr_float/interf_dec.h
-./avidemux/ADM_libraries/ADM_lavcodec/amr_float/interf_enc.h
-./avidemux/ADM_libraries/ADM_lavcodec/amr_float/interf_rom.h
-./avidemux/ADM_libraries/ADM_lavcodec/amr_float/rom_dec.h
-./avidemux/ADM_libraries/ADM_lavcodec/amr_float/rom_enc.h
-./avidemux/ADM_libraries/ADM_lavcodec/amr_float/sp_dec.h
-./avidemux/ADM_libraries/ADM_lavcodec/amr_float/sp_enc.h
-./avidemux/ADM_libraries/ADM_lavcodec/amr_float/typedef.h
-./avidemux/ADM_libraries/ADM_lavcodec/avcodec.h
-./avidemux/ADM_libraries/ADM_lavcodec/bitstream.h
-./avidemux/ADM_libraries/ADM_lavcodec/bytestream.h
-./avidemux/ADM_libraries/ADM_lavcodec/cabac.h
 ./avidemux/ADM_libraries/ADM_lavcodec/dsputil.h
-./avidemux/ADM_libraries/ADM_lavcodec/dvdata.h
-./avidemux/ADM_libraries/ADM_lavcodec/eval.h
+./avidemux/ADM_libraries/ADM_lavcodec/vp3data.h
 ./avidemux/ADM_libraries/ADM_lavcodec/faandct.h
+./avidemux/ADM_libraries/ADM_lavcodec/bitstream.h
+./avidemux/ADM_libraries/ADM_lavcodec/msmpeg4data.h
+./avidemux/ADM_libraries/ADM_lavcodec/oggvorbis.h
+./avidemux/ADM_libraries/ADM_lavcodec/os_support.h
+./avidemux/ADM_libraries/ADM_lavcodec/mpegaudiodectab.h
 ./avidemux/ADM_libraries/ADM_lavcodec/fastmemcpy.h
+./avidemux/ADM_libraries/ADM_lavcodec/h261data.h
+./avidemux/ADM_libraries/ADM_lavcodec/mpegaudio.h
+./avidemux/ADM_libraries/ADM_lavcodec/ra288.h
+./avidemux/ADM_libraries/ADM_lavcodec/svq1_cb.h
+./avidemux/ADM_libraries/ADM_lavcodec/mpeg4data.h
+./avidemux/ADM_libraries/ADM_lavcodec/wmadata.h
+./avidemux/ADM_libraries/ADM_lavcodec/truemotion1data.h
+./avidemux/ADM_libraries/ADM_lavcodec/vc1data.h
+./avidemux/ADM_libraries/ADM_lavcodec/rangecoder.h
 ./avidemux/ADM_libraries/ADM_lavcodec/golomb.h
-./avidemux/ADM_libraries/ADM_lavcodec/h261data.h
+./avidemux/ADM_libraries/ADM_lavcodec/qdm2data.h
+./avidemux/ADM_libraries/ADM_lavcodec/snow.h
+./avidemux/ADM_libraries/ADM_lavcodec/mpegaudiotab.h
+./avidemux/ADM_libraries/ADM_lavcodec/svq1_vlc.h
+./avidemux/ADM_libraries/ADM_lavcodec/h264data.h
+./avidemux/ADM_libraries/ADM_lavcodec/opt.h
+./avidemux/ADM_libraries/ADM_lavcodec/indeo3data.h
+./avidemux/ADM_libraries/ADM_lavcodec/simple_idct.h
+./avidemux/ADM_libraries/ADM_lavcodec/mpeg12data.h
+./avidemux/ADM_libraries/ADM_lavcodec/ac3tab.h
 ./avidemux/ADM_libraries/ADM_lavcodec/h263data.h
-./avidemux/ADM_libraries/ADM_lavcodec/h264data.h
-./avidemux/ADM_libraries/ADM_lavcodec/i386/dsputil_mmx_avg.h
-./avidemux/ADM_libraries/ADM_lavcodec/i386/dsputil_mmx_rnd.h
-./avidemux/ADM_libraries/ADM_lavcodec/i386/mathops.h
-./avidemux/ADM_libraries/ADM_lavcodec/i386/mmx.h
+./avidemux/ADM_libraries/ADM_lavcodec/avcodec.h
+./avidemux/ADM_libraries/ADM_lavcodec/mpegvideo.h
+./avidemux/ADM_libraries/ADM_lavcodec/vc1acdata.h
+./avidemux/ADM_libraries/ADM_lavcodec/cabac.h
+./avidemux/ADM_libraries/ADM_lavcodec/dvdata.h
+./avidemux/ADM_libraries/ADM_lavcodec/jul/dsputil.h
+./avidemux/ADM_libraries/ADM_lavcodec/jul/avcodec.h
+./avidemux/ADM_libraries/ADM_lavcodec/sp5x.h
+./avidemux/ADM_libraries/ADM_lavcodec/ra144.h
 ./avidemux/ADM_libraries/ADM_lavcodec/imgconvert_template.h
+./avidemux/ADM_libraries/ADM_lavcodec/bmp.h
+./avidemux/ADM_libraries/ADM_lavcodec/aac_ac3_parser.h
+./avidemux/ADM_libraries/ADM_lavcodec/cavs.h
+./avidemux/ADM_libraries/ADM_lavcodec/lcl.h
+./avidemux/ADM_libraries/ADM_lavcodec/lzo.h
+./avidemux/ADM_libraries/ADM_lavcodec/ac3_parser.h
+./avidemux/ADM_libraries/ADM_lavcodec/lzw.h
+./avidemux/ADM_libraries/ADM_lavcodec/dca.h
+./avidemux/ADM_libraries/ADM_lavcodec/allcodecs.h
+./avidemux/ADM_libraries/ADM_lavcodec/dcadata.h
+./avidemux/ADM_libraries/ADM_lavcodec/pnm.h
+./avidemux/ADM_libraries/ADM_lavcodec/atrac3data.h
+./avidemux/ADM_libraries/ADM_lavcodec/raw.h
+./avidemux/ADM_libraries/ADM_lavcodec/bytestream.h
+./avidemux/ADM_libraries/ADM_lavcodec/cavsdata.h
+./avidemux/ADM_libraries/ADM_lavcodec/cookdata.h
+./avidemux/ADM_libraries/ADM_lavcodec/eval.h
+./avidemux/ADM_libraries/ADM_lavcodec/imcdata.h
 ./avidemux/ADM_libraries/ADM_lavcodec/indeo2data.h
-./avidemux/ADM_libraries/ADM_lavcodec/indeo3data.h
-./avidemux/ADM_libraries/ADM_lavcodec/libpostproc/mangle.h
-./avidemux/ADM_libraries/ADM_lavcodec/libpostproc/postprocess.h
-./avidemux/ADM_libraries/ADM_lavcodec/libpostproc/postprocess_internal.h
 ./avidemux/ADM_libraries/ADM_lavcodec/mathops.h
-./avidemux/ADM_libraries/ADM_lavcodec/mpeg12data.h
-./avidemux/ADM_libraries/ADM_lavcodec/mpeg4data.h
-./avidemux/ADM_libraries/ADM_lavcodec/mpegaudio.h
-./avidemux/ADM_libraries/ADM_lavcodec/mpegaudiodectab.h
-./avidemux/ADM_libraries/ADM_lavcodec/mpegaudiotab.h
-./avidemux/ADM_libraries/ADM_lavcodec/mpegvideo.h
-./avidemux/ADM_libraries/ADM_lavcodec/msmpeg4data.h
-./avidemux/ADM_libraries/ADM_lavcodec/oggvorbis.h
-./avidemux/ADM_libraries/ADM_lavcodec/opt.h
-./avidemux/ADM_libraries/ADM_lavcodec/os_support.h
+./avidemux/ADM_libraries/ADM_lavcodec/mpcdata.h
 ./avidemux/ADM_libraries/ADM_lavcodec/parser.h
-./avidemux/ADM_libraries/ADM_lavcodec/ppc/dsputil_altivec.h
-./avidemux/ADM_libraries/ADM_lavcodec/ppc/dsputil_ppc.h
-./avidemux/ADM_libraries/ADM_lavcodec/ppc/gcc_fixes.h
-./avidemux/ADM_libraries/ADM_lavcodec/qdm2data.h
-./avidemux/ADM_libraries/ADM_lavcodec/ra144.h
-./avidemux/ADM_libraries/ADM_lavcodec/ra288.h
-./avidemux/ADM_libraries/ADM_lavcodec/rangecoder.h
 ./avidemux/ADM_libraries/ADM_lavcodec/ratecontrol.h
-./avidemux/ADM_libraries/ADM_lavcodec/simple_idct.h
-./avidemux/ADM_libraries/ADM_lavcodec/snow.h
-./avidemux/ADM_libraries/ADM_lavcodec/sp5x.h
-./avidemux/ADM_libraries/ADM_lavcodec/svq1_cb.h
-./avidemux/ADM_libraries/ADM_lavcodec/svq1_vlc.h
-./avidemux/ADM_libraries/ADM_lavcodec/truemotion1data.h
-./avidemux/ADM_libraries/ADM_lavcodec/vc1acdata.h
-./avidemux/ADM_libraries/ADM_lavcodec/vc1data.h
-./avidemux/ADM_libraries/ADM_lavcodec/vp3data.h
+./avidemux/ADM_libraries/ADM_lavcodec/rtjpeg.h
+./avidemux/ADM_libraries/ADM_lavcodec/truespeech_data.h
+./avidemux/ADM_libraries/ADM_lavcodec/ulti_cb.h
+./avidemux/ADM_libraries/ADM_lavcodec/vorbis.h
+./avidemux/ADM_libraries/ADM_lavcodec/vorbis_enc_data.h
 ./avidemux/ADM_libraries/ADM_lavcodec/vp56.h
 ./avidemux/ADM_libraries/ADM_lavcodec/vp56data.h
 ./avidemux/ADM_libraries/ADM_lavcodec/vp5data.h
 ./avidemux/ADM_libraries/ADM_lavcodec/vp6data.h
-./avidemux/ADM_libraries/ADM_lavcodec/wmadata.h
-./avidemux/ADM_libraries/ADM_lavformat/ADM_lavformat.cpp
-./avidemux/ADM_libraries/ADM_lavformat/ADM_lavformat.h
-./avidemux/ADM_libraries/ADM_lavformat/ADM_muxts.cpp
+./avidemux/ADM_libraries/ADM_lavcodec/xvid_internal.h
+./avidemux/ADM_libraries/ADM_lavcodec/bethsoftvideo.h
+./avidemux/ADM_libraries/ADM_lavcodec/dcahuff.h
+./avidemux/ADM_libraries/ADM_lavcodec/dnxhddata.h
+./avidemux/ADM_libraries/ADM_lavcodec/elbg.h
+./avidemux/ADM_libraries/ADM_lavcodec/h261.h
+./avidemux/ADM_libraries/ADM_lavcodec/h263.h
+./avidemux/ADM_libraries/ADM_lavcodec/h263_parser.h
+./avidemux/ADM_libraries/ADM_lavcodec/h264.h
+./avidemux/ADM_libraries/ADM_lavcodec/h264_parser.h
+./avidemux/ADM_libraries/ADM_lavcodec/jpegls.h
+./avidemux/ADM_libraries/ADM_lavcodec/jpeglsdec.h
+./avidemux/ADM_libraries/ADM_lavcodec/libxvid_internal.h
+./avidemux/ADM_libraries/ADM_lavcodec/mjpeg.h
+./avidemux/ADM_libraries/ADM_lavcodec/mjpegdec.h
+./avidemux/ADM_libraries/ADM_lavcodec/mjpegenc.h
+./avidemux/ADM_libraries/ADM_lavcodec/mpeg12.h
+./avidemux/ADM_libraries/ADM_lavcodec/mpeg12decdata.h
+./avidemux/ADM_libraries/ADM_lavcodec/mpeg4video_parser.h
+./avidemux/ADM_libraries/ADM_lavcodec/mpegaudiodata.h
+./avidemux/ADM_libraries/ADM_lavcodec/mpegaudiodecheader.h
+./avidemux/ADM_libraries/ADM_lavcodec/mpegvideo_common.h
+./avidemux/ADM_libraries/ADM_lavcodec/msmpeg4.h
+./avidemux/ADM_libraries/ADM_lavcodec/msmpeg4tab.h
+./avidemux/ADM_libraries/ADM_lavcodec/rl.h
+./avidemux/ADM_libraries/ADM_lavcodec/rle.h
+./avidemux/ADM_libraries/ADM_lavcodec/roqvideo.h
+./avidemux/ADM_libraries/ADM_lavcodec/s3tc.h
+./avidemux/ADM_libraries/ADM_lavcodec/sgi.h
+./avidemux/ADM_libraries/ADM_lavcodec/svq1.h
+./avidemux/ADM_libraries/ADM_lavcodec/svq1enc_cb.h
+./avidemux/ADM_libraries/ADM_lavcodec/tiff.h
+./avidemux/ADM_libraries/ADM_lavcodec/vc1.h
+./avidemux/ADM_libraries/ADM_lavcodec/wma.h
+./avidemux/ADM_libraries/ADM_lavcodec/xiph.h
+./avidemux/ADM_libraries/ADM_lavcodec/xvmc_render.h
+./avidemux/ADM_libraries/ADM_lavcodec/ffgenconf.h
+./avidemux/ADM_libraries/ADM_lavcodec/ffconf.h
+./avidemux/ADM_libraries/ADM_lavcodec/dsputil_cpu.h
+./avidemux/ADM_libraries/ADM_mplex/ADM_transfert.h
+./avidemux/ADM_libraries/ADM_mplex/stream_params.cpp
+./avidemux/ADM_libraries/ADM_mplex/streamType.h
+./avidemux/ADM_libraries/ADM_mplex/vector.cpp
+./avidemux/ADM_libraries/ADM_mplex/systems.cpp
+./avidemux/ADM_libraries/ADM_mplex/interact.cpp
+./avidemux/ADM_libraries/ADM_mplex/buffer.cpp
+./avidemux/ADM_libraries/ADM_mplex/zalphastrm_out.cpp
+./avidemux/ADM_libraries/ADM_mplex/multiplexor.cpp
+./avidemux/ADM_libraries/ADM_mplex/dtsstrm_in.cpp
+./avidemux/ADM_libraries/ADM_mplex/stillsstream.cpp
+./avidemux/ADM_libraries/ADM_mplex/ADM_mplexin.cpp
+./avidemux/ADM_libraries/ADM_mplex/ADM_transfert.cpp
+./avidemux/ADM_libraries/ADM_mplex/ADM_mthread.cpp
+./avidemux/ADM_libraries/ADM_mplex/ADM_mplexout.cpp
+./avidemux/ADM_libraries/ADM_mplex/audiostrm_out.cpp
+./avidemux/ADM_libraries/ADM_mplex/main_example.cpp
+./avidemux/ADM_libraries/ADM_mplex/bits.cpp
+./avidemux/ADM_libraries/ADM_mplex/ac3strm_in.cpp
+./avidemux/ADM_libraries/ADM_mplex/videostrm_in.cpp
+./avidemux/ADM_libraries/ADM_mplex/videostrm_out.cpp
+./avidemux/ADM_libraries/ADM_mplex/inputstrm.cpp
+./avidemux/ADM_libraries/ADM_mplex/mpastrm_in.cpp
+./avidemux/ADM_libraries/ADM_mplex/padstrm.cpp
+./avidemux/ADM_libraries/ADM_mplex/ADM_mthread.h
+./avidemux/ADM_libraries/ADM_mplex/zalphastrm_in.cpp
+./avidemux/ADM_libraries/ADM_mplex/ADM_inout.h
+./avidemux/ADM_libraries/ADM_mplex/lpcmstrm_in.cpp
+./avidemux/ADM_libraries/ADM_mplex/ADM_mplexmuxer.cpp
+./avidemux/ADM_libraries/ADM_libswscale/swscale_internal.h
+./avidemux/ADM_libraries/ADM_libswscale/ADM_mp.h
+./avidemux/ADM_libraries/ADM_libswscale/rgb2rgb.h
+./avidemux/ADM_libraries/ADM_libswscale/wrapper.h
+./avidemux/ADM_libraries/ADM_libswscale/ADM_mp.cpp
+./avidemux/ADM_libraries/ADM_libswscale/ADM_swscale.h
+./avidemux/ADM_libraries/ADM_libswscale/swscale.h
+./avidemux/ADM_libraries/ADM_lvemux/mux_out.h
+./avidemux/ADM_libraries/ADM_lvemux/ADM_muxer.h
+./avidemux/ADM_libraries/ADM_lvemux/ADM_muxer.cpp
+./avidemux/ADM_libraries/ADM_lavformat/avio.h
 ./avidemux/ADM_libraries/ADM_lavformat/ADM_tscrc.h
-./avidemux/ADM_libraries/ADM_lavformat/allformats.h
+./avidemux/ADM_libraries/ADM_lavformat/mpegts.h
+./avidemux/ADM_libraries/ADM_lavformat/mov.h
+./avidemux/ADM_libraries/ADM_lavformat/rtp.h
+./avidemux/ADM_libraries/ADM_lavformat/rtspcodes.h
+./avidemux/ADM_libraries/ADM_lavformat/asf.h
+./avidemux/ADM_libraries/ADM_lavformat/isom.h
+./avidemux/ADM_libraries/ADM_lavformat/barpainet.h
+./avidemux/ADM_libraries/ADM_lavformat/base64.h
+./avidemux/ADM_libraries/ADM_lavformat/dv1394.h
+./avidemux/ADM_libraries/ADM_lavformat/avi.h
 ./avidemux/ADM_libraries/ADM_lavformat/avformat.h
-./avidemux/ADM_libraries/ADM_lavformat/avi.h
-./avidemux/ADM_libraries/ADM_lavformat/avio.h
 ./avidemux/ADM_libraries/ADM_lavformat/dv.h
-./avidemux/ADM_libraries/ADM_lavformat/isom.h
-./avidemux/ADM_libraries/ADM_lavformat/mov.h
-./avidemux/ADM_libraries/ADM_lavformat/mpegts.h
-./avidemux/ADM_libraries/ADM_lavformat/qtpalette.h
+./avidemux/ADM_libraries/ADM_lavformat/flv.h
+./avidemux/ADM_libraries/ADM_lavformat/framehook.h
+./avidemux/ADM_libraries/ADM_lavformat/gxf.h
 ./avidemux/ADM_libraries/ADM_lavformat/riff.h
-./avidemux/ADM_libraries/ADM_lavformat/rtp.h
+./avidemux/ADM_libraries/ADM_lavformat/nut.h
 ./avidemux/ADM_libraries/ADM_lavformat/rtsp.h
-./avidemux/ADM_libraries/ADM_lavformat/rtspcodes.h
+./avidemux/ADM_libraries/ADM_lavformat/ogg2.h
+./avidemux/ADM_libraries/ADM_lavformat/os_support.h
+./avidemux/ADM_libraries/ADM_lavformat/rm.h
+./avidemux/ADM_libraries/ADM_lavformat/qtpalette.h
+./avidemux/ADM_libraries/ADM_lavformat/rtp_h264.h
+./avidemux/ADM_libraries/ADM_lavformat/voc.h
+./avidemux/ADM_libraries/ADM_lavformat/ADM_muxts.cpp
+./avidemux/ADM_libraries/ADM_lavformat/matroska.h
+./avidemux/ADM_libraries/ADM_lavformat/allformats.h
+./avidemux/ADM_libraries/ADM_lavformat/mpeg.h
+./avidemux/ADM_libraries/ADM_lavformat/ADM_lavformat.cpp
+./avidemux/ADM_libraries/ADM_lavformat/ADM_lavformat.h
+./avidemux/ADM_libraries/ADM_lavformat/network.h
+./avidemux/ADM_libraries/ADM_lavformat/rtp_internal.h
+./avidemux/ADM_libraries/ADM_lavutil/barpainet.h
+./avidemux/ADM_libraries/ADM_lavutil/lls.h
+./avidemux/ADM_libraries/ADM_lavutil/voc.h
+./avidemux/ADM_libraries/ADM_lavutil/base64.h
 ./avidemux/ADM_libraries/ADM_lavutil/adler32.h
-./avidemux/ADM_libraries/ADM_lavutil/avutil.h
+./avidemux/ADM_libraries/ADM_lavutil/dv.h
+./avidemux/ADM_libraries/ADM_lavutil/x86_cpu.h
+./avidemux/ADM_libraries/ADM_lavutil/dv1394.h
+./avidemux/ADM_libraries/ADM_lavutil/integer.h
+./avidemux/ADM_libraries/ADM_lavutil/mathematics.h
+./avidemux/ADM_libraries/ADM_lavutil/flv.h
+./avidemux/ADM_libraries/ADM_lavutil/allformats.h
+./avidemux/ADM_libraries/ADM_lavutil/framehook.h
+./avidemux/ADM_libraries/ADM_lavutil/crc.h
+./avidemux/ADM_libraries/ADM_lavutil/gxf.h
+./avidemux/ADM_libraries/ADM_lavutil/asf.h
+./avidemux/ADM_libraries/ADM_lavutil/rational.h
+./avidemux/ADM_libraries/ADM_lavutil/isom.h
+./avidemux/ADM_libraries/ADM_lavutil/avformat.h
+./avidemux/ADM_libraries/ADM_lavutil/internal.h
+./avidemux/ADM_libraries/ADM_lavutil/mpegts.h
 ./avidemux/ADM_libraries/ADM_lavutil/bswap.h
+./avidemux/ADM_libraries/ADM_lavutil/nut.h
+./avidemux/ADM_libraries/ADM_lavutil/ogg2.h
+./avidemux/ADM_libraries/ADM_lavutil/log.h
+./avidemux/ADM_libraries/ADM_lavutil/avi.h
+./avidemux/ADM_libraries/ADM_lavutil/os_support.h
+./avidemux/ADM_libraries/ADM_lavutil/md5.h
+./avidemux/ADM_libraries/ADM_lavutil/intfloat_readwrite.h
+./avidemux/ADM_libraries/ADM_lavutil/qtpalette.h
+./avidemux/ADM_libraries/ADM_lavutil/riff.h
+./avidemux/ADM_libraries/ADM_lavutil/rtp.h
 ./avidemux/ADM_libraries/ADM_lavutil/common.h
-./avidemux/ADM_libraries/ADM_lavutil/crc.h
+./avidemux/ADM_libraries/ADM_lavutil/mem.h
+./avidemux/ADM_libraries/ADM_lavutil/rtp_h264.h
+./avidemux/ADM_libraries/ADM_lavutil/rtsp.h
+./avidemux/ADM_libraries/ADM_lavutil/aes128.h
 ./avidemux/ADM_libraries/ADM_lavutil/fifo.h
-./avidemux/ADM_libraries/ADM_lavutil/integer.h
-./avidemux/ADM_libraries/ADM_lavutil/internal.h
-./avidemux/ADM_libraries/ADM_lavutil/intfloat_readwrite.h
+./avidemux/ADM_libraries/ADM_lavutil/softfloat.h
+./avidemux/ADM_libraries/ADM_lavutil/tree.h
+./avidemux/ADM_libraries/ADM_lavutil/avutil.h
+./avidemux/ADM_libraries/ADM_lavutil/jul/avutil.h
+./avidemux/ADM_libraries/ADM_lavutil/jul/common.h
+./avidemux/ADM_libraries/ADM_lavutil/avstring.h
+./avidemux/ADM_libraries/ADM_lavutil/rtspcodes.h
+./avidemux/ADM_libraries/ADM_lavutil/aes.h
 ./avidemux/ADM_libraries/ADM_lavutil/intreadwrite.h
-./avidemux/ADM_libraries/ADM_lavutil/lls.h
-./avidemux/ADM_libraries/ADM_lavutil/log.h
-./avidemux/ADM_libraries/ADM_lavutil/mathematics.h
-./avidemux/ADM_libraries/ADM_lavutil/md5.h
-./avidemux/ADM_libraries/ADM_lavutil/rational.h
-./avidemux/ADM_libraries/ADM_lavutil/x86_cpu.h
-./avidemux/ADM_libraries/ADM_liba52/a52.h
+./avidemux/ADM_libraries/ADM_lavutil/lzo.h
+./avidemux/ADM_libraries/ADM_lavutil/avio.h
+./avidemux/ADM_libraries/ADM_lavutil/rtp_internal.h
+./avidemux/ADM_libraries/ADM_lavutil/random.h
+./avidemux/ADM_libraries/ADM_lavutil/sha1.h
+./avidemux/ADM_libraries/ADM_liba52/bitstream.h
+./avidemux/ADM_libraries/ADM_liba52/tables.h
+./avidemux/ADM_libraries/ADM_liba52/mm_accel.h
 ./avidemux/ADM_libraries/ADM_liba52/a52_internal.h
 ./avidemux/ADM_libraries/ADM_liba52/attributes.h
-./avidemux/ADM_libraries/ADM_liba52/bitstream.h
-./avidemux/ADM_libraries/ADM_liba52/mm_accel.h
-./avidemux/ADM_libraries/ADM_liba52/tables.h
-./avidemux/ADM_libraries/ADM_libass/ass.h
-./avidemux/ADM_libraries/ADM_libass/ass_bitmap.h
-./avidemux/ADM_libraries/ADM_libass/ass_cache.h
-./avidemux/ADM_libraries/ADM_libass/ass_fontconfig.h
-./avidemux/ADM_libraries/ADM_libass/ass_library.h
-./avidemux/ADM_libraries/ADM_libass/ass_mp.h
-./avidemux/ADM_libraries/ADM_libass/ass_types.h
-./avidemux/ADM_libraries/ADM_libass/ass_utils.h
-./avidemux/ADM_libraries/ADM_libass/mputils.h
-./avidemux/ADM_libraries/ADM_libMad/bit.h
-./avidemux/ADM_libraries/ADM_libMad/decoder.h
-./avidemux/ADM_libraries/ADM_libMad/fixed.h
+./avidemux/ADM_libraries/ADM_liba52/a52.h
 ./avidemux/ADM_libraries/ADM_libMad/frame.h
-./avidemux/ADM_libraries/ADM_libMad/global.h
-./avidemux/ADM_libraries/ADM_libMad/huffman.h
-./avidemux/ADM_libraries/ADM_libMad/layer12.h
 ./avidemux/ADM_libraries/ADM_libMad/layer3.h
-./avidemux/ADM_libraries/ADM_libMad/mad.h
 ./avidemux/ADM_libraries/ADM_libMad/madmem.h
+./avidemux/ADM_libraries/ADM_libMad/decoder.h
 ./avidemux/ADM_libraries/ADM_libMad/stream.h
+./avidemux/ADM_libraries/ADM_libMad/global.h
+./avidemux/ADM_libraries/ADM_libMad/mad.h
 ./avidemux/ADM_libraries/ADM_libMad/synth.h
+./avidemux/ADM_libraries/ADM_libMad/bit.h
+./avidemux/ADM_libraries/ADM_libMad/layer12.h
 ./avidemux/ADM_libraries/ADM_libMad/timer.h
+./avidemux/ADM_libraries/ADM_libMad/huffman.h
 ./avidemux/ADM_libraries/ADM_libMad/version.h
-./avidemux/ADM_libraries/ADM_libMpeg2Dec/attributes.h
-./avidemux/ADM_libraries/ADM_libMpeg2Dec/convert.h
+./avidemux/ADM_libraries/ADM_libMad/fixed.h
+./avidemux/ADM_libraries/ADM_libass/ass_cache.h
+./avidemux/ADM_libraries/ADM_libass/mputils.h
+./avidemux/ADM_libraries/ADM_libass/ass_fontconfig.h
+./avidemux/ADM_libraries/ADM_libass/ass_mp.h
+./avidemux/ADM_libraries/ADM_libass/ass.h
+./avidemux/ADM_libraries/ADM_libass/ass_utils.h
+./avidemux/ADM_libraries/ADM_libass/ass_bitmap.h
+./avidemux/ADM_libraries/ADM_libass/ass_library.h
+./avidemux/ADM_libraries/ADM_libass/ass_font.h
+./avidemux/ADM_libraries/ADM_libass/ass_types.h
+./avidemux/ADM_libraries/ADM_libass/help_mp.h
+./avidemux/ADM_libraries/ADM_utilities/aviindexer.cpp
+./avidemux/ADM_libraries/ADM_utilities/aviio.cpp
+./avidemux/ADM_libraries/ADM_utilities/avifmt2.h
+./avidemux/ADM_libraries/ADM_utilities/ADM_bitstream.h
+./avidemux/ADM_libraries/ADM_utilities/broken.cpp
+./avidemux/ADM_libraries/ADM_utilities/fourcc.cpp
+./avidemux/ADM_libraries/ADM_utilities/ADM_print_priv.h
+./avidemux/ADM_libraries/ADM_utilities/subchunk.cpp
+./avidemux/ADM_libraries/ADM_utilities/ADM_compressedImage.h
+./avidemux/ADM_libraries/ADM_utilities/avidemutils.cpp
+./avidemux/ADM_libraries/ADM_utilities/fourcc.h
+./avidemux/ADM_libraries/ADM_utilities/subchunk.h
+./avidemux/ADM_libraries/ADM_utilities/ADM_fileio.cpp
+./avidemux/ADM_libraries/ADM_utilities/default.h
+./avidemux/ADM_libraries/ADM_utilities/aviframe.cpp
+./avidemux/ADM_libraries/ADM_utilities/avifmt.h
+./avidemux/ADM_libraries/ADM_utilities/avidemutils.h
+./avidemux/ADM_libraries/ADM_utilities/ADM_fileio.h
+./avidemux/ADM_libraries/ADM_utilities/prefs.cpp
+./avidemux/ADM_libraries/ADM_utilities/ADM_image.h
+./avidemux/ADM_libraries/ADM_utilities/ADM_pp.h
+./avidemux/ADM_libraries/ADM_utilities/admmangle.h
+./avidemux/ADM_libraries/ADM_utilities/ADM_imageResizer.cpp
+./avidemux/ADM_libraries/ADM_utilities/ADM_pp.cpp
+./avidemux/ADM_libraries/ADM_utilities/ADM_bitstream.cpp
+./avidemux/ADM_libraries/ADM_utilities/ADM_image.cpp
+./avidemux/ADM_libraries/ADM_utilities/ADM_imageUtils.cpp
+./avidemux/ADM_libraries/ADM_utilities/ADM_print.cpp
+./avidemux/ADM_libraries/ADM_libtwolame/energy.h
+./avidemux/ADM_libraries/ADM_libtwolame/psycho_2_absthr.h
+./avidemux/ADM_libraries/ADM_libtwolame/encode.h
+./avidemux/ADM_libraries/ADM_libtwolame/psycho_n1.h
+./avidemux/ADM_libraries/ADM_libtwolame/freqtable.h
+./avidemux/ADM_libraries/ADM_libtwolame/crc.h
+./avidemux/ADM_libraries/ADM_libtwolame/bitbuffer.h
+./avidemux/ADM_libraries/ADM_libtwolame/twolame.h
+./avidemux/ADM_libraries/ADM_libtwolame/ath.h
+./avidemux/ADM_libraries/ADM_libtwolame/util.h
+./avidemux/ADM_libraries/ADM_libtwolame/subband.h
+./avidemux/ADM_libraries/ADM_libtwolame/fft.h
+./avidemux/ADM_libraries/ADM_libtwolame/absthr.h
+./avidemux/ADM_libraries/ADM_libtwolame/critband.h
+./avidemux/ADM_libraries/ADM_libtwolame/dab.h
+./avidemux/ADM_libraries/ADM_libtwolame/enwindow.h
+./avidemux/ADM_libraries/ADM_libtwolame/psycho_1_critband.h
+./avidemux/ADM_libraries/ADM_libtwolame/encode_new.h
+./avidemux/ADM_libraries/ADM_libtwolame/musicin.h
+./avidemux/ADM_libraries/ADM_libtwolame/psycho_1_freqtable.h
+./avidemux/ADM_libraries/ADM_libtwolame/tables.h
+./avidemux/ADM_libraries/ADM_libtwolame/mem.h
+./avidemux/ADM_libraries/ADM_libtwolame/availbits.h
+./avidemux/ADM_libraries/ADM_libtwolame/encoder.h
+./avidemux/ADM_libraries/ADM_libtwolame/psycho_0.h
+./avidemux/ADM_libraries/ADM_libtwolame/psycho_1.h
+./avidemux/ADM_libraries/ADM_libtwolame/psycho_2.h
+./avidemux/ADM_libraries/ADM_libtwolame/psycho_3.h
+./avidemux/ADM_libraries/ADM_libtwolame/common.h
+./avidemux/ADM_libraries/ADM_libtwolame/psycho_4.h
+./avidemux/ADM_libraries/ADM_libMpeg2Dec/video_out.h
 ./avidemux/ADM_libraries/ADM_libMpeg2Dec/mmx.h
+./avidemux/ADM_libraries/ADM_libMpeg2Dec/mpeg2_internal.h
 ./avidemux/ADM_libraries/ADM_libMpeg2Dec/mpeg2.h
-./avidemux/ADM_libraries/ADM_libMpeg2Dec/mpeg2_internal.h
-./avidemux/ADM_libraries/ADM_libMpeg2Dec/video_out.h
+./avidemux/ADM_libraries/ADM_libMpeg2Dec/convert.h
 ./avidemux/ADM_libraries/ADM_libMpeg2Dec/vlc.h
-./avidemux/ADM_libraries/ADM_libmpeg2enc/ADM_mpe2enc.cpp
-./avidemux/ADM_libraries/ADM_libmpeg2enc/ADM_mpeg2enc.h
-./avidemux/ADM_libraries/ADM_libmpeg2enc/ADM_mpeg2Param.h
-./avidemux/ADM_libraries/ADM_libmpeg2enc/altivec/altivec_conf.h
-./avidemux/ADM_libraries/ADM_libmpeg2enc/altivec/altivec_motion.h
+./avidemux/ADM_libraries/ADM_libMpeg2Dec/attributes.h
 ./avidemux/ADM_libraries/ADM_libmpeg2enc/altivec/altivec_predict.h
 ./avidemux/ADM_libraries/ADM_libmpeg2enc/altivec/altivec_quantize.h
+./avidemux/ADM_libraries/ADM_libmpeg2enc/altivec/vectorize.h
 ./avidemux/ADM_libraries/ADM_libmpeg2enc/altivec/altivec_transform.h
 ./avidemux/ADM_libraries/ADM_libmpeg2enc/altivec/amber.h
 ./avidemux/ADM_libraries/ADM_libmpeg2enc/altivec/benchmark.h
+./avidemux/ADM_libraries/ADM_libmpeg2enc/altivec/altivec_conf.h
+./avidemux/ADM_libraries/ADM_libmpeg2enc/altivec/quantize_ref.h
+./avidemux/ADM_libraries/ADM_libmpeg2enc/altivec/verify.h
 ./avidemux/ADM_libraries/ADM_libmpeg2enc/altivec/mjpeg_logging.h
+./avidemux/ADM_libraries/ADM_libmpeg2enc/altivec/altivec_motion.h
+./avidemux/ADM_libraries/ADM_libmpeg2enc/altivec/syntaxconsts.h
+./avidemux/ADM_libraries/ADM_libmpeg2enc/altivec/quantize_precomp.h
 ./avidemux/ADM_libraries/ADM_libmpeg2enc/altivec/mjpeg_types.h
-./avidemux/ADM_libraries/ADM_libmpeg2enc/altivec/quantize_precomp.h
-./avidemux/ADM_libraries/ADM_libmpeg2enc/altivec/quantize_ref.h
-./avidemux/ADM_libraries/ADM_libmpeg2enc/altivec/syntaxconsts.h
-./avidemux/ADM_libraries/ADM_libmpeg2enc/altivec/vectorize.h
-./avidemux/ADM_libraries/ADM_libmpeg2enc/altivec/verify.h
-./avidemux/ADM_libraries/ADM_libmpeg2enc/attributes.h
+./avidemux/ADM_libraries/ADM_libmpeg2enc/mblock_sub44_sads_x86.h
+./avidemux/ADM_libraries/ADM_libmpeg2enc/quantize_ref.h
+./avidemux/ADM_libraries/ADM_libmpeg2enc/syntaxparams.h
+./avidemux/ADM_libraries/ADM_libmpeg2enc/yuv4mpeg.h
+./avidemux/ADM_libraries/ADM_libmpeg2enc/mmxsse_motion.h
 ./avidemux/ADM_libraries/ADM_libmpeg2enc/cpu_accel.h
+./avidemux/ADM_libraries/ADM_libmpeg2enc/mmx.h
+./avidemux/ADM_libraries/ADM_libmpeg2enc/mpeg2enc.h
+./avidemux/ADM_libraries/ADM_libmpeg2enc/format_codes.h
+./avidemux/ADM_libraries/ADM_libmpeg2enc/predict_ref.h
 ./avidemux/ADM_libraries/ADM_libmpeg2enc/fastintfns.h
-./avidemux/ADM_libraries/ADM_libmpeg2enc/format_codes.h
-./avidemux/ADM_libraries/ADM_libmpeg2enc/global.h
-./avidemux/ADM_libraries/ADM_libmpeg2enc/mblock_sub44_sads_x86.h
+./avidemux/ADM_libraries/ADM_libmpeg2enc/mjpeg_types.h
 ./avidemux/ADM_libraries/ADM_libmpeg2enc/mjpeg_logging.h
-./avidemux/ADM_libraries/ADM_libmpeg2enc/mjpeg_types.h
-./avidemux/ADM_libraries/ADM_libmpeg2enc/mmx.h
-./avidemux/ADM_libraries/ADM_libmpeg2enc/mmxsse_motion.h
-./avidemux/ADM_libraries/ADM_libmpeg2enc/motionsearch.h
-./avidemux/ADM_libraries/ADM_libmpeg2enc/mpeg2enc.h
 ./avidemux/ADM_libraries/ADM_libmpeg2enc/mpeg2parm.h
+./avidemux/ADM_libraries/ADM_libmpeg2enc/vlc.h
+./avidemux/ADM_libraries/ADM_libmpeg2enc/tables.h
+./avidemux/ADM_libraries/ADM_libmpeg2enc/synchrolib.h
 ./avidemux/ADM_libraries/ADM_libmpeg2enc/mpegconsts.h
-./avidemux/ADM_libraries/ADM_libmpeg2enc/predict_ref.h
-./avidemux/ADM_libraries/ADM_libmpeg2enc/quantize_ref.h
+./avidemux/ADM_libraries/ADM_libmpeg2enc/motionsearch.h
+./avidemux/ADM_libraries/ADM_libmpeg2enc/attributes.h
 ./avidemux/ADM_libraries/ADM_libmpeg2enc/simd.h
-./avidemux/ADM_libraries/ADM_libmpeg2enc/synchrolib.h
-./avidemux/ADM_libraries/ADM_libmpeg2enc/syntaxparams.h
-./avidemux/ADM_libraries/ADM_libmpeg2enc/tables.h
+./avidemux/ADM_libraries/ADM_libmpeg2enc/yuv4mpeg_intern.h
+./avidemux/ADM_libraries/ADM_libmpeg2enc/global.h
+./avidemux/ADM_libraries/ADM_libmpeg2enc/ADM_mpeg2Param.h
+./avidemux/ADM_libraries/ADM_libmpeg2enc/ADM_mpe2enc.cpp
 ./avidemux/ADM_libraries/ADM_libmpeg2enc/transfrm_ref.h
-./avidemux/ADM_libraries/ADM_libmpeg2enc/vlc.h
-./avidemux/ADM_libraries/ADM_libmpeg2enc/yuv4mpeg.h
-./avidemux/ADM_libraries/ADM_libmpeg2enc/yuv4mpeg_intern.h
-./avidemux/ADM_libraries/ADM_libswscale/ADM_mp.cpp
-./avidemux/ADM_libraries/ADM_libswscale/ADM_mp.h
-./avidemux/ADM_libraries/ADM_libswscale/rgb2rgb.h
-./avidemux/ADM_libraries/ADM_libswscale/swscale.h
-./avidemux/ADM_libraries/ADM_libswscale/swscale_internal.h
-./avidemux/ADM_libraries/ADM_libswscale/wrapper.h
-./avidemux/ADM_libraries/ADM_libtwolame/absthr.h
-./avidemux/ADM_libraries/ADM_libtwolame/ath.h
-./avidemux/ADM_libraries/ADM_libtwolame/availbits.h
-./avidemux/ADM_libraries/ADM_libtwolame/bitbuffer.h
-./avidemux/ADM_libraries/ADM_libtwolame/common.h
-./avidemux/ADM_libraries/ADM_libtwolame/crc.h
-./avidemux/ADM_libraries/ADM_libtwolame/critband.h
-./avidemux/ADM_libraries/ADM_libtwolame/dab.h
-./avidemux/ADM_libraries/ADM_libtwolame/encode.h
-./avidemux/ADM_libraries/ADM_libtwolame/encoder.h
-./avidemux/ADM_libraries/ADM_libtwolame/encode_new.h
-./avidemux/ADM_libraries/ADM_libtwolame/energy.h
-./avidemux/ADM_libraries/ADM_libtwolame/enwindow.h
-./avidemux/ADM_libraries/ADM_libtwolame/fft.h
-./avidemux/ADM_libraries/ADM_libtwolame/freqtable.h
-./avidemux/ADM_libraries/ADM_libtwolame/mem.h
-./avidemux/ADM_libraries/ADM_libtwolame/musicin.h
-./avidemux/ADM_libraries/ADM_libtwolame/psycho_0.h
-./avidemux/ADM_libraries/ADM_libtwolame/psycho_1.h
-./avidemux/ADM_libraries/ADM_libtwolame/psycho_1_critband.h
-./avidemux/ADM_libraries/ADM_libtwolame/psycho_1_freqtable.h
-./avidemux/ADM_libraries/ADM_libtwolame/psycho_2.h
-./avidemux/ADM_libraries/ADM_libtwolame/psycho_2_absthr.h
-./avidemux/ADM_libraries/ADM_libtwolame/psycho_3.h
-./avidemux/ADM_libraries/ADM_libtwolame/psycho_4.h
-./avidemux/ADM_libraries/ADM_libtwolame/psycho_n1.h
-./avidemux/ADM_libraries/ADM_libtwolame/subband.h
-./avidemux/ADM_libraries/ADM_libtwolame/tables.h
-./avidemux/ADM_libraries/ADM_libtwolame/twolame.h
-./avidemux/ADM_libraries/ADM_libtwolame/util.h
-./avidemux/ADM_libraries/ADM_lvemux/ADM_muxer.cpp
-./avidemux/ADM_libraries/ADM_lvemux/ADM_muxer.h
-./avidemux/ADM_libraries/ADM_lvemux/mux_out.h
-./avidemux/ADM_libraries/ADM_mplex/ac3strm_in.cpp
-./avidemux/ADM_libraries/ADM_mplex/ADM_inout.h
-./avidemux/ADM_libraries/ADM_mplex/ADM_mplexin.cpp
-./avidemux/ADM_libraries/ADM_mplex/ADM_mplexmuxer.cpp
-./avidemux/ADM_libraries/ADM_mplex/ADM_mplexout.cpp
-./avidemux/ADM_libraries/ADM_mplex/ADM_mthread.cpp
-./avidemux/ADM_libraries/ADM_mplex/ADM_mthread.h
-./avidemux/ADM_libraries/ADM_mplex/ADM_transfert.cpp
-./avidemux/ADM_libraries/ADM_mplex/ADM_transfert.h
-./avidemux/ADM_libraries/ADM_mplex/audiostrm_out.cpp
-./avidemux/ADM_libraries/ADM_mplex/bits.cpp
-./avidemux/ADM_libraries/ADM_mplex/buffer.cpp
-./avidemux/ADM_libraries/ADM_mplex/dtsstrm_in.cpp
-./avidemux/ADM_libraries/ADM_mplex/inputstrm.cpp
-./avidemux/ADM_libraries/ADM_mplex/interact.cpp
-./avidemux/ADM_libraries/ADM_mplex/lpcmstrm_in.cpp
-./avidemux/ADM_libraries/ADM_mplex/main_example.cpp
-./avidemux/ADM_libraries/ADM_mplex/mpastrm_in.cpp
-./avidemux/ADM_libraries/ADM_mplex/multiplexor.cpp
-./avidemux/ADM_libraries/ADM_mplex/padstrm.cpp
-./avidemux/ADM_libraries/ADM_mplex/stillsstream.cpp
-./avidemux/ADM_libraries/ADM_mplex/streamType.h
-./avidemux/ADM_libraries/ADM_mplex/stream_params.cpp
-./avidemux/ADM_libraries/ADM_mplex/systems.cpp
-./avidemux/ADM_libraries/ADM_mplex/vector.cpp
-./avidemux/ADM_libraries/ADM_mplex/videostrm_in.cpp
-./avidemux/ADM_libraries/ADM_mplex/videostrm_out.cpp
-./avidemux/ADM_libraries/ADM_mplex/zalphastrm_in.cpp
-./avidemux/ADM_libraries/ADM_mplex/zalphastrm_out.cpp
+./avidemux/ADM_libraries/ADM_libmpeg2enc/ADM_mpeg2enc.h
+./avidemux/ADM_libraries/ADM_xvidratectl/ADM_xvidr_internal.h
+./avidemux/ADM_libraries/ADM_xvidratectl/ADM_ratecontrol.h
+./avidemux/ADM_libraries/ADM_xvidratectl/ADM_oldxvid.cpp
+./avidemux/ADM_libraries/ADM_xvidratectl/ADM_xvidratectlVBV.cpp
+./avidemux/ADM_libraries/ADM_xvidratectl/ADM_xvidratectl.cpp
+./avidemux/ADM_libraries/ADM_smjs/jscpucfg.h
+./avidemux/ADM_libraries/ADM_smjs/jsautocfg.h
+./avidemux/ADM_libraries/ADM_smjs/jsscope.h
 ./avidemux/ADM_libraries/ADM_smjs/jsapi.h
 ./avidemux/ADM_libraries/ADM_smjs/jsarena.h
 ./avidemux/ADM_libraries/ADM_smjs/jsarray.h
 ./avidemux/ADM_libraries/ADM_smjs/jsatom.h
-./avidemux/ADM_libraries/ADM_smjs/jsautocfg.h
 ./avidemux/ADM_libraries/ADM_smjs/jsbit.h
 ./avidemux/ADM_libraries/ADM_smjs/jsbool.h
 ./avidemux/ADM_libraries/ADM_smjs/jsclist.h
-./avidemux/ADM_libraries/ADM_smjs/jscntxt.h
 ./avidemux/ADM_libraries/ADM_smjs/jscompat.h
 ./avidemux/ADM_libraries/ADM_smjs/jsconfig.h
-./avidemux/ADM_libraries/ADM_smjs/jscpucfg.h
 ./avidemux/ADM_libraries/ADM_smjs/jsdate.h
 ./avidemux/ADM_libraries/ADM_smjs/jsdbgapi.h
 ./avidemux/ADM_libraries/ADM_smjs/jsdhash.h
@@ -554,15 +1187,12 @@
 ./avidemux/ADM_libraries/ADM_smjs/jsexn.h
 ./avidemux/ADM_libraries/ADM_smjs/jsfile.h
 ./avidemux/ADM_libraries/ADM_smjs/jsfun.h
-./avidemux/ADM_libraries/ADM_smjs/jsgc.h
 ./avidemux/ADM_libraries/ADM_smjs/jshash.h
 ./avidemux/ADM_libraries/ADM_smjs/jsinterp.h
 ./avidemux/ADM_libraries/ADM_smjs/jslibmath.h
-./avidemux/ADM_libraries/ADM_smjs/jslock.h
 ./avidemux/ADM_libraries/ADM_smjs/jslong.h
 ./avidemux/ADM_libraries/ADM_smjs/jsmath.h
 ./avidemux/ADM_libraries/ADM_smjs/jsnum.h
-./avidemux/ADM_libraries/ADM_smjs/jsobj.h
 ./avidemux/ADM_libraries/ADM_smjs/jsopcode.h
 ./avidemux/ADM_libraries/ADM_smjs/jsosdep.h
 ./avidemux/ADM_libraries/ADM_smjs/jsotypes.h
@@ -572,459 +1202,27 @@
 ./avidemux/ADM_libraries/ADM_smjs/jspubtd.h
 ./avidemux/ADM_libraries/ADM_smjs/jsregexp.h
 ./avidemux/ADM_libraries/ADM_smjs/jsscan.h
-./avidemux/ADM_libraries/ADM_smjs/jsscope.h
 ./avidemux/ADM_libraries/ADM_smjs/jsscript.h
-./avidemux/ADM_libraries/ADM_smjs/jsstddef.h
 ./avidemux/ADM_libraries/ADM_smjs/jsstr.h
-./avidemux/ADM_libraries/ADM_smjs/jstypes.h
 ./avidemux/ADM_libraries/ADM_smjs/jsutil.h
 ./avidemux/ADM_libraries/ADM_smjs/jsxdrapi.h
 ./avidemux/ADM_libraries/ADM_smjs/jsxml.h
 ./avidemux/ADM_libraries/ADM_smjs/prmjtime.h
 ./avidemux/ADM_libraries/ADM_smjs/resource.h
-./avidemux/ADM_libraries/ADM_utilities/admmangle.h
-./avidemux/ADM_libraries/ADM_utilities/ADM_bitstream.cpp
-./avidemux/ADM_libraries/ADM_utilities/ADM_bitstream.h
-./avidemux/ADM_libraries/ADM_utilities/ADM_compressedImage.h
-./avidemux/ADM_libraries/ADM_utilities/ADM_fileio.cpp
-./avidemux/ADM_libraries/ADM_utilities/ADM_fileio.h
-./avidemux/ADM_libraries/ADM_utilities/ADM_image.cpp
-./avidemux/ADM_libraries/ADM_utilities/ADM_image.h
-./avidemux/ADM_libraries/ADM_utilities/ADM_imageResizer.cpp
-./avidemux/ADM_libraries/ADM_utilities/ADM_imageUtils.cpp
-./avidemux/ADM_libraries/ADM_utilities/ADM_pp.cpp
-./avidemux/ADM_libraries/ADM_utilities/ADM_pp.h
-./avidemux/ADM_libraries/ADM_utilities/ADM_print.cpp
-./avidemux/ADM_libraries/ADM_utilities/ADM_print_priv.h
-./avidemux/ADM_libraries/ADM_utilities/avidemutils.cpp
-./avidemux/ADM_libraries/ADM_utilities/avidemutils.h
-./avidemux/ADM_libraries/ADM_utilities/avifmt.h
-./avidemux/ADM_libraries/ADM_utilities/avifmt2.h
-./avidemux/ADM_libraries/ADM_utilities/aviframe.cpp
-./avidemux/ADM_libraries/ADM_utilities/aviindexer.cpp
-./avidemux/ADM_libraries/ADM_utilities/aviio.cpp
-./avidemux/ADM_libraries/ADM_utilities/broken.cpp
-./avidemux/ADM_libraries/ADM_utilities/default.h
-./avidemux/ADM_libraries/ADM_utilities/fourcc.cpp
-./avidemux/ADM_libraries/ADM_utilities/fourcc.h
-./avidemux/ADM_libraries/ADM_utilities/prefs.cpp
-./avidemux/ADM_libraries/ADM_utilities/subchunk.cpp
-./avidemux/ADM_libraries/ADM_utilities/subchunk.h
-./avidemux/ADM_libraries/ADM_xvidratectl/ADM_oldxvid.cpp
-./avidemux/ADM_libraries/ADM_xvidratectl/ADM_ratecontrol.h
-./avidemux/ADM_libraries/ADM_xvidratectl/ADM_xvidratectl.cpp
-./avidemux/ADM_libraries/ADM_xvidratectl/ADM_xvidratectlVBV.cpp
-./avidemux/ADM_libraries/ADM_xvidratectl/ADM_xvidr_internal.h
-./avidemux/ADM_ocr/adm_glyph.cpp
-./avidemux/ADM_ocr/adm_glyph.h
-./avidemux/ADM_ocr/adm_leftturn.cpp
-./avidemux/ADM_ocr/ADM_leftturn.h
-./avidemux/ADM_ocr/ADM_ocrLoadSave.h
-./avidemux/ADM_ocr/ADM_vob2vobsub.cpp
-./avidemux/ADM_osSupport/ADM_cpuCap.cpp
-./avidemux/ADM_osSupport/ADM_cpuCap.h
-./avidemux/ADM_osSupport/ADM_crashdump.cpp
-./avidemux/ADM_osSupport/ADM_debug.cpp
-./avidemux/ADM_osSupport/ADM_debug.h
-./avidemux/ADM_osSupport/ADM_debugID.h
-./avidemux/ADM_osSupport/ADM_fileio.cpp
-./avidemux/ADM_osSupport/ADM_memcpy.cpp
-./avidemux/ADM_osSupport/ADM_memory.cpp
-./avidemux/ADM_osSupport/ADM_memsupport.cpp
-./avidemux/ADM_osSupport/ADM_misc.cpp
-./avidemux/ADM_osSupport/ADM_misc.h
-./avidemux/ADM_osSupport/ADM_queue.cpp
-./avidemux/ADM_osSupport/ADM_queue.h
-./avidemux/ADM_osSupport/ADM_quota.cpp
-./avidemux/ADM_osSupport/ADM_quota.h
-./avidemux/ADM_osSupport/ADM_threads.cpp
-./avidemux/ADM_osSupport/ADM_threads.h
-./avidemux/ADM_osSupport/TLK_clock.cpp
-./avidemux/ADM_osSupport/TLK_clock.h
-./avidemux/ADM_osSupport/win32.cpp
-./avidemux/ADM_outputs/oplug_avi/avilist.cpp
-./avidemux/ADM_outputs/oplug_avi/avilist.h
-./avidemux/ADM_outputs/oplug_avi/GUI_mux.h
-./avidemux/ADM_outputs/oplug_avi/op_avisave.cpp
-./avidemux/ADM_outputs/oplug_avi/op_avisave.h
-./avidemux/ADM_outputs/oplug_avi/op_avisavecopy.cpp
-./avidemux/ADM_outputs/oplug_avi/op_avisavecopy_pack.cpp
-./avidemux/ADM_outputs/oplug_avi/op_avisavecopy_unpack.cpp
-./avidemux/ADM_outputs/oplug_avi/op_avisavedual.cpp
-./avidemux/ADM_outputs/oplug_avi/op_aviwrite.cpp
-./avidemux/ADM_outputs/oplug_avi/op_savecopy.h
-./avidemux/ADM_outputs/oplug_avi/op_saveprocess.cpp
-./avidemux/ADM_outputs/oplug_avi/op_saveprocess.h
-./avidemux/ADM_outputs/oplug_avi/op_savesmart.cpp
-./avidemux/ADM_outputs/oplug_mp4/oplug_mp4.cpp
-./avidemux/ADM_outputs/oplug_mp4/oplug_mp4.h
-./avidemux/ADM_outputs/oplug_mpeg/op_mpegpass.cpp
-./avidemux/ADM_outputs/oplug_mpegFF/oplug_encodervcd.h
-./avidemux/ADM_outputs/oplug_mpegFF/oplug_vcdff.cpp
-./avidemux/ADM_outputs/oplug_mpegFF/oplug_vcdff.h
-./avidemux/ADM_outputs/oplug_ogm/op_ogaudio.cpp
-./avidemux/ADM_outputs/oplug_ogm/op_ogpage.cpp
-./avidemux/ADM_outputs/oplug_ogm/op_ogpage.h
-./avidemux/ADM_outputs/oplug_ogm/op_ogsave.cpp
-./avidemux/ADM_outputs/oplug_ogm/op_ogsave.h
-./avidemux/ADM_outputs/oplug_ogm/op_ogsavecopy.cpp
-./avidemux/ADM_outputs/oplug_ogm/op_ogsaveprocess.cpp
-./avidemux/ADM_preview.cpp
-./avidemux/ADM_requant/getvlc.h
-./avidemux/ADM_requant/putvlc.h
-./avidemux/ADM_requant/tcrequant.h
-./avidemux/ADM_script/ADM_Avidemux.cpp
-./avidemux/ADM_script/ADM_Avidemux.h
-./avidemux/ADM_script/ADM_AvidemuxAudio.cpp
-./avidemux/ADM_script/ADM_AvidemuxAudio.h
-./avidemux/ADM_script/ADM_AvidemuxVideo.cpp
-./avidemux/ADM_script/ADM_AvidemuxVideo.h
-./avidemux/ADM_script/ADM_container.h
-./avidemux/ADM_script/ADM_JSAvidemux.cpp
-./avidemux/ADM_script/ADM_JSAvidemux.h
-./avidemux/ADM_script/ADM_JSAvidemuxAudio.cpp
-./avidemux/ADM_script/ADM_JSAvidemuxAudio.h
-./avidemux/ADM_script/ADM_JSAvidemuxVideo.cpp
-./avidemux/ADM_script/ADM_JSAvidemuxVideo.h
-./avidemux/ADM_script/ADM_JSDirectorySearch.cpp
-./avidemux/ADM_script/ADM_JSDirectorySearch.h
-./avidemux/ADM_script/ADM_JSFunctions.cpp
-./avidemux/ADM_script/ADM_JSGlobal.cpp
-./avidemux/ADM_script/ADM_JSGlobal.h
-./avidemux/ADM_script/adm_scanner.h
-./avidemux/ADM_script/DirectorySearch.cpp
-./avidemux/ADM_script/DirectorySearch.h
-./avidemux/ADM_script/StdFile.h
-./avidemux/ADM_toolkit/ADM_audioQueue.cpp
-./avidemux/ADM_toolkit/ADM_audioQueue.h
-./avidemux/ADM_toolkit/ADM_intfloat.cpp
-./avidemux/ADM_toolkit/ADM_intfloat.h
-./avidemux/ADM_toolkit/ADM_packetQueue.cpp
-./avidemux/ADM_toolkit/ADM_packetQueue.h
-./avidemux/ADM_toolkit/automation.cpp
-./avidemux/ADM_toolkit/bitmap.h
-./avidemux/ADM_toolkit/filesel.cpp
-./avidemux/ADM_toolkit/filesel.h
-./avidemux/ADM_userInterfaces/ADM_commonUI/ADM_tray.h
-./avidemux/ADM_userInterfaces/ADM_commonUI/DIA_audioconfig.cpp
-./avidemux/ADM_userInterfaces/ADM_commonUI/DIA_bitrateHisto.cpp
-./avidemux/ADM_userInterfaces/ADM_commonUI/DIA_builtin.cpp
-./avidemux/ADM_userInterfaces/ADM_commonUI/DIA_busy.h
-./avidemux/ADM_userInterfaces/ADM_commonUI/DIA_DVDff.cpp
-./avidemux/ADM_userInterfaces/ADM_commonUI/DIA_encoding.h
-./avidemux/ADM_userInterfaces/ADM_commonUI/DIA_enter.cpp
-./avidemux/ADM_userInterfaces/ADM_commonUI/DIA_enter.h
-./avidemux/ADM_userInterfaces/ADM_commonUI/DIA_factory.h
-./avidemux/ADM_userInterfaces/ADM_commonUI/DIA_gototime.cpp
-./avidemux/ADM_userInterfaces/ADM_commonUI/DIA_idx_pg.h
-./avidemux/ADM_userInterfaces/ADM_commonUI/DIA_lavcodec.cpp
-./avidemux/ADM_userInterfaces/ADM_commonUI/DIA_postproc.cpp
-./avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp
-./avidemux/ADM_userInterfaces/ADM_commonUI/DIA_resizeWiz.cpp
-./avidemux/ADM_userInterfaces/ADM_commonUI/DIA_resizeWiz.h
-./avidemux/ADM_userInterfaces/ADM_commonUI/DIA_SVCD.cpp
-./avidemux/ADM_userInterfaces/ADM_commonUI/DIA_working.h
-./avidemux/ADM_userInterfaces/ADM_commonUI/GUI_accelRender.h
-./avidemux/ADM_userInterfaces/ADM_commonUI/GUI_render.cpp
-./avidemux/ADM_userInterfaces/ADM_commonUI/GUI_render.h
-./avidemux/ADM_userInterfaces/ADM_commonUI/GUI_sdlRender.cpp
-./avidemux/ADM_userInterfaces/ADM_commonUI/GUI_sdlRender.h
-./avidemux/ADM_userInterfaces/ADM_commonUI/GUI_ui.h
-./avidemux/ADM_userInterfaces/ADM_commonUI/GUI_xvRender.cpp
-./avidemux/ADM_userInterfaces/ADM_commonUI/GUI_xvRender.h
-./avidemux/ADM_userInterfaces/ADM_commonUI/systray.h
-./avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_about.cpp
-./avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_acodec.cpp
-./avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_animated.cpp
-./avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_asharp.cpp
-./avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_audio.cpp
-./avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_busy.cpp
-./avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp
-./avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_chromaShift.cpp
-./avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_cnr2.cpp
-./avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_color.cpp
-./avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_coloryuv.cpp
-./avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_contrast.cpp
-./avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_crop.cpp
-./avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp
-./avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_eq2.cpp
-./avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_equalizer.cpp
-./avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_exLame.cpp
-./avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_hue.cpp
-./avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_idx_pg.cpp
-./avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_jobs.cpp
-./avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_jobs_save.cpp
-./avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_lavdecoder.cpp
-./avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_mjpeg.cpp
-./avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_mpdelogo.cpp
-./avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_mpeg2opt.cpp
-./avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_ocr.cpp
-./avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_partial.cpp
-./avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_pause.cpp
-./avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_pipe.cpp
-./avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_preview.cpp
-./avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_properties.cpp
-./avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_quota.cpp
-./avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_recent.cpp
-./avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_requant.cpp
-./avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_resize.cpp
-./avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_srt.cpp
-./avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_tdeint.cpp
-./avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_v2v.cpp
-./avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_vcodec.cpp
-./avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_vobsub.cpp
-./avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_working.cpp
-./avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp
-./avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvcd.cpp
-./avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid.cpp
-./avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp
-./avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialogFactory/DIA_dialogFactory.cpp
-./avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialogFactory/DIA_filesel.cpp
-./avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialogFactory/FAC_bar.cpp
-./avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialogFactory/FAC_bitrate.cpp
-./avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialogFactory/FAC_float.cpp
-./avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialogFactory/FAC_frame.cpp
-./avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialogFactory/FAC_integer.cpp
-./avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialogFactory/FAC_menu.cpp
-./avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialogFactory/FAC_notch.cpp
-./avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialogFactory/FAC_readOnlyText.cpp
-./avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialogFactory/FAC_toggle.cpp
-./avidemux/ADM_userInterfaces/ADM_GTK/ADM_filters/gui_filter.cpp
-./avidemux/ADM_userInterfaces/ADM_GTK/ADM_filters/gui_filterlist.cpp
-./avidemux/ADM_userInterfaces/ADM_GTK/ADM_filters/gui_filtermanager.cpp
-./avidemux/ADM_userInterfaces/ADM_GTK/ADM_filters/gui_filtermanager_dialog.cpp
-./avidemux/ADM_userInterfaces/ADM_GTK/ADM_filters/gui_filtersub.cpp
-./avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_bindings.cpp
-./avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_gtkRender.cpp
-./avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_keymap.cpp
-./avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp
-./avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_menumap.h
-./avidemux/ADM_userInterfaces/ADM_GTK/adm_ocr.cpp
-./avidemux/ADM_userInterfaces/ADM_GTK/ADM_toolkit_gtk/ADM_gladeSupport.cpp
-./avidemux/ADM_userInterfaces/ADM_GTK/ADM_toolkit_gtk/ADM_gladeSupport.h
-./avidemux/ADM_userInterfaces/ADM_GTK/ADM_toolkit_gtk/ADM_tray_gtk.cpp
-./avidemux/ADM_userInterfaces/ADM_GTK/ADM_toolkit_gtk/choice.cpp
-./avidemux/ADM_userInterfaces/ADM_GTK/ADM_toolkit_gtk/eggtrayicon.h
-./avidemux/ADM_userInterfaces/ADM_GTK/ADM_toolkit_gtk/TLK_filesel.cpp
-./avidemux/ADM_userInterfaces/ADM_GTK/ADM_toolkit_gtk/toolkit.cpp
-./avidemux/ADM_userInterfaces/ADM_GTK/ADM_toolkit_gtk/toolkit_dialog.cpp
-./avidemux/ADM_userInterfaces/ADM_GTK/ADM_toolkit_gtk/toolkit_gtk.h
-./avidemux/ADM_userInterfaces/ADM_GTK/ADM_toolkit_gtk/toolkit_gtk_include.h
-./avidemux/ADM_userInterfaces/ADM_NONE/ADM_dialog/alert_none.cpp
-./avidemux/ADM_userInterfaces/ADM_NONE/ADM_dialog/DIA_busy.cpp
-./avidemux/ADM_userInterfaces/ADM_NONE/ADM_dialog/DIA_encoding.cpp
-./avidemux/ADM_userInterfaces/ADM_NONE/ADM_dialog/DIA_indexing.cpp
-./avidemux/ADM_userInterfaces/ADM_NONE/ADM_dialog/DIA_none.cpp
-./avidemux/ADM_userInterfaces/ADM_NONE/ADM_dialog/DIA_working.cpp
-./avidemux/ADM_userInterfaces/ADM_NONE/ADM_dialog/OCR_none.cpp
-./avidemux/ADM_userInterfaces/ADM_NONE/ADM_dialogFactory/DIA_dialogFactory.cpp
-./avidemux/ADM_userInterfaces/ADM_NONE/ADM_dialogFactory/FAC_toggle.cpp
-./avidemux/ADM_userInterfaces/ADM_NONE/ADM_filters/filter_none.cpp
-./avidemux/ADM_userInterfaces/ADM_NONE/ADM_gui2/file_none.cpp
-./avidemux/ADM_userInterfaces/ADM_NONE/ADM_gui2/gui_none.cpp
-./avidemux/ADM_userInterfaces/ADM_NONE/ADM_gui2/preview_none.cpp
-./avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/alert_qt4.cpp
-./avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/AQ_encoding.cpp
-./avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/AQ_props.cpp
-./avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/AQ_working.cpp
-./avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_busy.cpp
-./avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_indexing.cpp
-./avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_none.cpp
-./avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/OCR_none.cpp
-./avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_encoding.cpp
-./avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_props.cpp
-./avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_working.cpp
-./avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/ui_encoding.h
-./avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/ui_props.h
-./avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/ui_working.h
-./avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialogFactory/AT_bitrate.cpp
-./avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialogFactory/AT_dialogFactory.cpp
-./avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialogFactory/AT_filesel.cpp
-./avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialogFactory/FAC_bar.cpp
-./avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialogFactory/FAC_float.cpp
-./avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialogFactory/FAC_frame.cpp
-./avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialogFactory/FAC_integer.cpp
-./avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialogFactory/FAC_menu.cpp
-./avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialogFactory/FAC_notch.cpp
-./avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialogFactory/FAC_readOnlyText.cpp
-./avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialogFactory/FAC_toggle.cpp
-./avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialogFactory/T_bitrate.cpp
-./avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialogFactory/T_dialogFactory.cpp
-./avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialogFactory/T_filesel.cpp
-./avidemux/ADM_userInterfaces/ADM_QT4/ADM_filters/AQ_mainfilter.cpp
-./avidemux/ADM_userInterfaces/ADM_QT4/ADM_filters/filter_none.cpp
-./avidemux/ADM_userInterfaces/ADM_QT4/ADM_filters/filter_rsc.cpp
-./avidemux/ADM_userInterfaces/ADM_QT4/ADM_filters/Q_mainfilter.cpp
-./avidemux/ADM_userInterfaces/ADM_QT4/ADM_filters/ui_mainfilter.h
-./avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/AQ_gui2.cpp
-./avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/AT_preview.cpp
-./avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/avidemux_rsc.cpp
-./avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/file_qt4.cpp
-./avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui_none.cpp
-./avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/Q_gui2.cpp
-./avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/translation_table.h
-./avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/T_preview.cpp
-./avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/ui_gui2.h
-./avidemux/ADM_video/ADM_cache.cpp
-./avidemux/ADM_video/ADM_cache.h
-./avidemux/ADM_video/ADM_confCouple.h
-./avidemux/ADM_video/ADM_confCouples.cpp
-./avidemux/ADM_video/ADM_genvideo.cpp
-./avidemux/ADM_video/ADM_guiResize.cpp
-./avidemux/ADM_video/ADM_interlaced.cpp
-./avidemux/ADM_video/ADM_interlaced.h
-./avidemux/ADM_video/ADM_mpdetc.cpp
-./avidemux/ADM_video/ADM_mpdetc.h
-./avidemux/ADM_video/ADM_resizebis.cpp
-./avidemux/ADM_video/ADM_resizeter.cpp
-./avidemux/ADM_video/ADM_vidAnimated.cpp
-./avidemux/ADM_video/ADM_vidAnimated.h
-./avidemux/ADM_video/ADM_vidAnimated_param.h
-./avidemux/ADM_video/ADM_vidAsharp.cpp
-./avidemux/ADM_video/ADM_vidASharp_param.h
-./avidemux/ADM_video/ADM_vidCached.cpp
-./avidemux/ADM_video/ADM_vidCached.h
-./avidemux/ADM_video/ADM_vidChromaShift.cpp
-./avidemux/ADM_video/ADM_vidChromaShift.h
-./avidemux/ADM_video/ADM_vidChromaShift_param.h
-./avidemux/ADM_video/ADM_vidClean.cpp
-./avidemux/ADM_video/ADM_vidClean.h
-./avidemux/ADM_video/ADM_vidCNR2.cpp
-./avidemux/ADM_video/ADM_vidCNR2_param.h
-./avidemux/ADM_video/ADM_vidColorYuv.cpp
-./avidemux/ADM_video/ADM_vidColorYuv.h
-./avidemux/ADM_video/ADM_vidColorYuv_param.h
-./avidemux/ADM_video/ADM_vidCommonFilter.h
-./avidemux/ADM_video/ADM_vidContrast.cpp
-./avidemux/ADM_video/ADM_vidContrast.h
-./avidemux/ADM_video/ADM_vidCrop.cpp
-./avidemux/ADM_video/ADM_vidDelta.cpp
-./avidemux/ADM_video/ADM_vidEq2.cpp
-./avidemux/ADM_video/ADM_vidEq2.h
-./avidemux/ADM_video/ADM_vidEqualizer.cpp
-./avidemux/ADM_video/ADM_vidEqualizer.h
-./avidemux/ADM_video/ADM_vidFieldUnblend.cpp
-./avidemux/ADM_video/ADM_vidFieldUtil.cpp
-./avidemux/ADM_video/ADM_vidFieldUtil.h
-./avidemux/ADM_video/ADM_vidFont.cpp
-./avidemux/ADM_video/ADM_vidFont.h
-./avidemux/ADM_video/ADM_vidHue.cpp
-./avidemux/ADM_video/ADM_vidHue.h
-./avidemux/ADM_video/ADM_vidMPdelogo.cpp
-./avidemux/ADM_video/ADM_vidMPdelogo.h
-./avidemux/ADM_video/ADM_vidMPLResize.cpp
-./avidemux/ADM_video/ADM_vidNull.cpp
-./avidemux/ADM_video/ADM_vidPartial.cpp
-./avidemux/ADM_video/ADM_vidPartial.h
-./avidemux/ADM_video/ADM_vidPartial_param.h
-./avidemux/ADM_video/ADM_vidRaw.cpp
-./avidemux/ADM_video/ADM_vidResize.cpp
-./avidemux/ADM_video/ADM_vidResize25.cpp
-./avidemux/ADM_video/ADM_vidSRT.cpp
-./avidemux/ADM_video/ADM_vidSRT.h
-./avidemux/ADM_video/ADM_vidSRTload.cpp
-./avidemux/ADM_video/ADM_vidSRTRender.cpp
-./avidemux/ADM_video/ADM_vidTdeint.cpp
-./avidemux/ADM_video/ADM_vidTDeint_param.h
-./avidemux/ADM_video/ADM_vidUnblend.cpp
-./avidemux/ADM_video/ADM_vidUnblend_param.h
-./avidemux/ADM_video/ADM_vidVobsub.cpp
-./avidemux/ADM_video/ADM_vidVobSub.h
-./avidemux/ADM_video/ADM_vidVobSubRender.cpp
-./avidemux/ADM_video/ADM_vobsubinfo.cpp
-./avidemux/ADM_video/ADM_vobsubinfo.h
-./avidemux/ADM_video/mmx_macros.h
-./avidemux/ADM_video/swscale_internal.h
-./avidemux/ADM_videoFilter/ADM_lavpp_deint.cpp
-./avidemux/ADM_videoFilter/ADM_lavpp_deintparam.h
-./avidemux/ADM_videoFilter/ADM_vidAddBorder.cpp
-./avidemux/ADM_videoFilter/ADM_vidAddBorder.h
-./avidemux/ADM_videoFilter/ADM_vidASS.cpp
-./avidemux/ADM_videoFilter/ADM_vidASS.h
-./avidemux/ADM_videoFilter/ADM_vidAss_Params.h
-./avidemux/ADM_videoFilter/ADM_vidBlend.cpp
-./avidemux/ADM_videoFilter/ADM_vidBlendRemoval.cpp
-./avidemux/ADM_videoFilter/ADM_vidBlendRemoval_param.h
-./avidemux/ADM_videoFilter/ADM_vidBSmear.cpp
-./avidemux/ADM_videoFilter/ADM_vidChroma.cpp
-./avidemux/ADM_videoFilter/ADM_vidChroma.h
-./avidemux/ADM_videoFilter/ADM_vidDecDec.cpp
-./avidemux/ADM_videoFilter/ADM_vidDecDec_param.h
-./avidemux/ADM_videoFilter/ADM_vidDecTelecide.cpp
-./avidemux/ADM_videoFilter/ADM_vidDecTelecide.h
-./avidemux/ADM_videoFilter/ADM_vidDecTel_param.h
-./avidemux/ADM_videoFilter/ADM_vidDeintASM.cpp
-./avidemux/ADM_videoFilter/ADM_vidDeinterlace.cpp
-./avidemux/ADM_videoFilter/ADM_vidDeinterlace.h
-./avidemux/ADM_videoFilter/ADM_vidDenoise.cpp
-./avidemux/ADM_videoFilter/ADM_vidDenoise.h
-./avidemux/ADM_videoFilter/ADM_vidDGbob.cpp
-./avidemux/ADM_videoFilter/ADM_vidDGbob_param.h
-./avidemux/ADM_videoFilter/ADM_vidDropOut.cpp
-./avidemux/ADM_videoFilter/ADM_vidDropOut.h
-./avidemux/ADM_videoFilter/ADM_vidFade.cpp
-./avidemux/ADM_videoFilter/ADM_vidFade_param.h
-./avidemux/ADM_videoFilter/ADM_vidFastConvolution.cpp
-./avidemux/ADM_videoFilter/ADM_vidField.h
-./avidemux/ADM_videoFilter/ADM_vidFields.cpp
-./avidemux/ADM_videoFilter/ADM_vidFlipV.cpp
-./avidemux/ADM_videoFilter/ADM_vidFlipV.h
-./avidemux/ADM_videoFilter/ADM_vidFlux.cpp
-./avidemux/ADM_videoFilter/ADM_vidFlux.h
-./avidemux/ADM_videoFilter/ADM_vidForcedPP.cpp
-./avidemux/ADM_videoFilter/ADM_vidForcedPP.h
-./avidemux/ADM_videoFilter/ADM_vidHardIvtcRemoval.cpp
-./avidemux/ADM_videoFilter/ADM_vidKernelDeint.cpp
-./avidemux/ADM_videoFilter/ADM_vidKernelDeint.h
-./avidemux/ADM_videoFilter/ADM_vidLargeMedian.cpp
-./avidemux/ADM_videoFilter/ADM_vidLargeMedian.h
-./avidemux/ADM_videoFilter/ADM_vidLuma.cpp
-./avidemux/ADM_videoFilter/ADM_vidLuma.h
-./avidemux/ADM_videoFilter/ADM_vidMcDeint.cpp
-./avidemux/ADM_videoFilter/ADM_vidMcDeint_param.h
-./avidemux/ADM_videoFilter/ADM_vidMosaic.cpp
-./avidemux/ADM_videoFilter/ADM_vidMosaic_param.h
-./avidemux/ADM_videoFilter/ADM_vidMPLD3D.cpp
-./avidemux/ADM_videoFilter/ADM_vidMPLD3D.h
-./avidemux/ADM_videoFilter/ADM_vidMPLD3Dlow.cpp
-./avidemux/ADM_videoFilter/ADM_vidMPLD3Dlow.h
-./avidemux/ADM_videoFilter/ADM_vidMSharpen.cpp
-./avidemux/ADM_videoFilter/ADM_vidMSharpen_param.h
-./avidemux/ADM_videoFilter/ADM_vidMsmooth.cpp
-./avidemux/ADM_videoFilter/ADM_vidMSmooth_param.h
-./avidemux/ADM_videoFilter/ADM_vidPalShift.cpp
-./avidemux/ADM_videoFilter/ADM_vidPalShift.h
-./avidemux/ADM_videoFilter/ADM_vidPalSmart.cpp
-./avidemux/ADM_videoFilter/ADM_vidPalSmart.h
-./avidemux/ADM_videoFilter/ADM_vidPulldown.cpp
-./avidemux/ADM_videoFilter/ADM_vidPulldown.h
-./avidemux/ADM_videoFilter/ADM_vidResampleFPS.cpp
-./avidemux/ADM_videoFilter/ADM_vidReverse.cpp
-./avidemux/ADM_videoFilter/ADM_vidRotate.cpp
-./avidemux/ADM_videoFilter/ADM_vidSeparateField.cpp
-./avidemux/ADM_videoFilter/ADM_vidSeparateField.h
-./avidemux/ADM_videoFilter/ADM_vidSoften.cpp
-./avidemux/ADM_videoFilter/ADM_vidSoften.h
-./avidemux/ADM_videoFilter/ADM_vidStabilize.cpp
-./avidemux/ADM_videoFilter/ADM_vidStabilize.h
-./avidemux/ADM_videoFilter/ADM_vidSwapFields.cpp
-./avidemux/ADM_videoFilter/ADM_vidSwapFields.h
-./avidemux/ADM_videoFilter/ADM_vidSwapSmart.cpp
-./avidemux/ADM_videoFilter/ADM_vidSwapSmart.h
-./avidemux/ADM_videoFilter/ADM_vidUVSwap.cpp
-./avidemux/ADM_videoFilter/ADM_vidUVSwap.h
-./avidemux/ADM_videoFilter/ADM_vidVlad.cpp
-./avidemux/ADM_videoFilter/ADM_vidVlad.h
-./avidemux/ADM_videoFilter/ADM_vidWhirl.cpp
-./avidemux/ADM_videoFilter/ADM_vidYadif.cpp
-./avidemux/avi_vars.h
-./avidemux/gtkgui.h
-./avidemux/gtk_gui.cpp
-./avidemux/guiplay.cpp
-./avidemux/gui_autodrive.cpp
-./avidemux/GUI_jobs.cpp
-./avidemux/gui_navigate.cpp
-./avidemux/gui_savenew.cpp
-./avidemux/main.cpp
-./avidemux/prefs.h
-./avidemux/prototype.h
+./avidemux/ADM_libraries/ADM_smjs/jsobj.h
+./avidemux/ADM_libraries/ADM_smjs/jscntxt.h
+./avidemux/ADM_libraries/ADM_smjs/jslock.h
+./avidemux/ADM_libraries/ADM_smjs/jsstddef.h
+./avidemux/ADM_libraries/ADM_smjs/jsgc.h
+./avidemux/ADM_libraries/ADM_smjs/jstypes.h
+./avidemux/ADM_libraries/ADM_libwrapper/libwrapper_dca.cpp
+./avidemux/ADM_libraries/ADM_libwrapper/libwrapper_dca.h
+./avidemux/ADM_libraries/ADM_libwrapper/libwrapper_global.cpp
+./avidemux/ADM_libraries/ADM_libwrapper/libwrapper.h
+./avidemux/ADM_libraries/ADM_libwrapper/libwrapper_global.h
+./avidemux/ADM_libraries/ADM_libwrapper/libwrapper_amrnb.cpp
+./avidemux/ADM_libraries/ADM_libwrapper/libwrapper_amrnb.h
+./avidemux/ADM_libraries/ADM_libwrapper/libwrapper.cpp
+./avidemux/ADM_libraries/ADM_libpostproc/mangle.h
+./avidemux/ADM_libraries/ADM_libpostproc/postprocess.h
+./avidemux/ADM_libraries/ADM_libpostproc/postprocess_internal.h



From mean at mail.berlios.de  Sat Jul 21 19:12:48 2007
From: mean at mail.berlios.de (mean at BerliOS)
Date: Sat, 21 Jul 2007 19:12:48 +0200
Subject: [Avidemux-svn-commit] r3428 -
	branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog
Message-ID: <200707211712.l6LHCmNv017944@sheep.berlios.de>

Author: mean
Date: 2007-07-21 19:12:46 +0200 (Sat, 21 Jul 2007)
New Revision: 3428

Modified:
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/Makefile.am
Log:
???

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/Makefile.am
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/Makefile.am	2007-07-21 16:45:16 UTC (rev 3427)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/Makefile.am	2007-07-21 17:12:46 UTC (rev 3428)
@@ -1,4 +1,4 @@
-
+#
 noinst_LIBRARIES = libADM_dialogGtk.a 
 
 INCLUDES = $(all_includes) $(GTK_CFLAGS) $(XML_CFLAGS)  $(FREETYPE_CFLAGS) -DADM_SUBVERSION=@ADM_SUBVERSION@ \



From mean at mail.berlios.de  Sat Jul 21 19:14:40 2007
From: mean at mail.berlios.de (mean at BerliOS)
Date: Sat, 21 Jul 2007 19:14:40 +0200
Subject: [Avidemux-svn-commit] r3429 -
	branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_filters
Message-ID: <200707211714.l6LHEeXt021127@sheep.berlios.de>

Author: mean
Date: 2007-07-21 19:14:39 +0200 (Sat, 21 Jul 2007)
New Revision: 3429

Modified:
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_filters/Makefile.am
Log:
[Automake] Rename libs

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_filters/Makefile.am
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_filters/Makefile.am	2007-07-21 17:12:46 UTC (rev 3428)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_filters/Makefile.am	2007-07-21 17:14:39 UTC (rev 3429)
@@ -1,13 +1,13 @@
 
-noinst_LIBRARIES = libADM_filters.a 
+noinst_LIBRARIES = libADM_filtersGtk.a 
 
 INCLUDES = $(all_includes) $(GTK_CFLAGS) $(XML_CFLAGS)   \
 		-I../../../ADM_libraries/ADM_utilities \
 		-I../../ADM_commonUI -I../../.. -I../../../ADM_libraries/ADM_lavutil 
 
-libADM_filters_a_METASOURCES = AUTO
+libADM_filtersGtk_a_METASOURCES = AUTO
 
-libADM_filters_a_SOURCES = gui_filterlist.cpp  gui_filtermanager.cpp  gui_filtermanager_dialog.cpp  gui_filtersub.cpp
+libADM_filtersGtk_a_SOURCES = gui_filterlist.cpp  gui_filtermanager.cpp  gui_filtermanager_dialog.cpp  gui_filtersub.cpp
 
 
 



From mean at mail.berlios.de  Sun Jul 22 11:28:23 2007
From: mean at mail.berlios.de (mean at BerliOS)
Date: Sun, 22 Jul 2007 11:28:23 +0200
Subject: [Avidemux-svn-commit] r3431 -
	branches/avidemux_2.4_branch/addons/tsscan
Message-ID: <200707220928.l6M9SN5M022862@sheep.berlios.de>

Author: mean
Date: 2007-07-22 11:28:23 +0200 (Sun, 22 Jul 2007)
New Revision: 3431

Modified:
   branches/avidemux_2.4_branch/addons/tsscan/tsscan.cpp
Log:
[TSSCAN] dispay info about dvb subs

Modified: branches/avidemux_2.4_branch/addons/tsscan/tsscan.cpp
===================================================================
--- branches/avidemux_2.4_branch/addons/tsscan/tsscan.cpp	2007-07-22 09:27:48 UTC (rev 3430)
+++ branches/avidemux_2.4_branch/addons/tsscan/tsscan.cpp	2007-07-22 09:28:23 UTC (rev 3431)
@@ -226,6 +226,7 @@
 			case 0x3: type="mpeg1 audio";break;
 			case 0x4: type="mpeg2 audio";break;
 			case 0x1b: type="h264 video";break;
+                        case 0x6: type="Private Stream";break;
 			default:;
 		}
 		printf("\tStream Type    :0x%x (%s)\n",buffer[index],type);
@@ -337,6 +338,8 @@
 	switch(tag)
 	{
 		case 0x52: printf("Stream identifier");break;
+                case 0x59: printf("DVB subtitles");break;
+                case 0x56: printf("Teletext");break;
 		case 0x0a: printf("Language descriptor");break;
 		default : printf("unknown");break;
 	}



From mean at mail.berlios.de  Sun Jul 22 11:27:49 2007
From: mean at mail.berlios.de (mean at BerliOS)
Date: Sun, 22 Jul 2007 11:27:49 +0200
Subject: [Avidemux-svn-commit] r3430 - in
	branches/avidemux_2.4_branch/avidemux: . ADM_editor
Message-ID: <200707220927.l6M9Rnxb022823@sheep.berlios.de>

Author: mean
Date: 2007-07-22 11:27:48 +0200 (Sun, 22 Jul 2007)
New Revision: 3430

Modified:
   branches/avidemux_2.4_branch/avidemux/ADM_editor/ADMedAVIAUD.cpp
   branches/avidemux_2.4_branch/avidemux/gtk_gui.cpp
Log:
revert r3410, it makes cutting mpeg crash+small cosmetic

Modified: branches/avidemux_2.4_branch/avidemux/ADM_editor/ADMedAVIAUD.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_editor/ADMedAVIAUD.cpp	2007-07-21 17:14:39 UTC (rev 3429)
+++ branches/avidemux_2.4_branch/avidemux/ADM_editor/ADMedAVIAUD.cpp	2007-07-22 09:27:48 UTC (rev 3430)
@@ -359,8 +359,7 @@
 {
   if (*audio)
     {
-      delete *
-	audio;
+      delete *audio;
       *audio = NULL;
     }
   if (!_videos[0]._audiostream)

Modified: branches/avidemux_2.4_branch/avidemux/gtk_gui.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/gtk_gui.cpp	2007-07-21 17:14:39 UTC (rev 3429)
+++ branches/avidemux_2.4_branch/avidemux/gtk_gui.cpp	2007-07-22 09:27:48 UTC (rev 3430)
@@ -1468,9 +1468,11 @@
 {
   if (currentaudiostream)
     {
-	delete currentaudiostream;
-        currentaudiostream=NULL;
-
+       if (currentaudiostream->isDestroyable ())        
+      {
+          delete currentaudiostream;
+          currentaudiostream=NULL;
+      }
       currentAudioSource=AudioNone;
       if(currentAudioName) ADM_dealloc(currentAudioName);
       currentAudioName=NULL;
@@ -2410,7 +2412,7 @@
       avifileinfo = (aviInfo *) NULL;
       video_body->cleanup ();
       curframe = 0;
-	  aviaudiostream=NULL;
+      currentaudiostream=NULL;
       A_changeAudioStream (NULL, AudioNone,NULL);
       filterCleanUp ();
       return 1;



From mean at mail.berlios.de  Sun Jul 22 18:05:17 2007
From: mean at mail.berlios.de (mean at BerliOS)
Date: Sun, 22 Jul 2007 18:05:17 +0200
Subject: [Avidemux-svn-commit] r3432 - in
	branches/avidemux_2.4_branch/avidemux: ADM_codecs ADM_filter
	ADM_inputs/ADM_mpegdemuxer ADM_videoFilter
Message-ID: <200707221605.l6MG5H9R028697@sheep.berlios.de>

Author: mean
Date: 2007-07-22 18:05:17 +0200 (Sun, 22 Jul 2007)
New Revision: 3432

Added:
   branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/ADM_vidDvbSub.cpp
Modified:
   branches/avidemux_2.4_branch/avidemux/ADM_codecs/ADM_ffmp43.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_codecs/ADM_ffmp43.h
   branches/avidemux_2.4_branch/avidemux/ADM_filter/filter_declaration.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_filter/video_filters.h
   branches/avidemux_2.4_branch/avidemux/ADM_inputs/ADM_mpegdemuxer/dmx_demuxerTS.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_inputs/ADM_mpegdemuxer/dmx_demuxerTS.h
   branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/CMakeLists.txt
Log:
[FILTER] First raw DVB subtitle filter, very incomplete

Modified: branches/avidemux_2.4_branch/avidemux/ADM_codecs/ADM_ffmp43.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_codecs/ADM_ffmp43.cpp	2007-07-22 09:28:23 UTC (rev 3431)
+++ branches/avidemux_2.4_branch/avidemux/ADM_codecs/ADM_ffmp43.cpp	2007-07-22 16:05:17 UTC (rev 3432)
@@ -639,6 +639,50 @@
   WRAP_Open (CODEC_ID_FLV1);
 }
 
+decoderFFDVBSub::decoderFFDVBSub (uint32_t w, uint32_t h, uint32_t l, uint8_t * d):decoderFF (w,	   h)
+{
+  _context->sub_id=1;
+  WRAP_Open (CODEC_ID_DVB_SUBTITLE);
+}
+//*********************
+/**
+    \fn decoderFFSubs
+    \brief Constructor for DVB subtitles...
+*/
+
+decoderFFSubs::decoderFFSubs (uint32_t subid)
+{
+  _context = avcodec_alloc_context ();
+  codecId= CODEC_ID_DVB_SUBTITLE;
+  subId=subid;
+  _context->sub_id=subId;
+  WRAP_Open (CODEC_ID_DVB_SUBTITLE);
+}
+decoderFFSubs:: ~ decoderFFSubs ()
+{
+  avcodec_close (_context);
+  ADM_dealloc (_context);
+  _context=NULL;
+  
+}
+
+uint8_t decoderFFSubs::uncompress (ADMCompressedImage * in, AVSubtitle * out)
+{
+  int ret=0;
+  int got_picture=0;
+  ret=avcodec_decode_subtitle(_context, out,
+                            &got_picture,
+                            in->data, in->dataLength); 
+     if(ret<0) 
+     {
+        printf("[FFSUB] Error %d\n",ret);
+        return 0; 
+     }
+     return 1;
+}
+
+
+//***************
 extern uint8_t  lavformat_init(void);
 extern void     avcodec_init(void );
 extern  void    avcodec_register_all(void );

Modified: branches/avidemux_2.4_branch/avidemux/ADM_codecs/ADM_ffmp43.h
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_codecs/ADM_ffmp43.h	2007-07-22 09:28:23 UTC (rev 3431)
+++ branches/avidemux_2.4_branch/avidemux/ADM_codecs/ADM_ffmp43.h	2007-07-22 16:05:17 UTC (rev 3432)
@@ -19,7 +19,20 @@
  ***************************************************************************/
 #ifdef USE_FFMPEG
 
+class decoderFFSubs
+{
+  protected:
+     int      codecId;
+     uint32_t subId;
+     AVCodecContext *_context;
+  public:
 
+    decoderFFSubs (uint32_t subId);
+    virtual ~ decoderFFSubs ();
+    virtual uint8_t uncompress (ADMCompressedImage * in, AVSubtitle * out); 
+};
+
+/****************************/
 class decoderFF:public decoders
 {
 protected:
@@ -302,5 +315,11 @@
 public:
   decoderFFFLV1 (uint32_t w, uint32_t h, uint32_t l, uint8_t * d);
 };
+class decoderFFDVBSub:public decoderFF
+{
+protected:
+public:
+  decoderFFDVBSub (uint32_t w, uint32_t h, uint32_t l, uint8_t * d);
+};
 
 #endif

Modified: branches/avidemux_2.4_branch/avidemux/ADM_filter/filter_declaration.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_filter/filter_declaration.cpp	2007-07-22 09:28:23 UTC (rev 3431)
+++ branches/avidemux_2.4_branch/avidemux/ADM_filter/filter_declaration.cpp	2007-07-22 16:05:17 UTC (rev 3432)
@@ -152,6 +152,7 @@
 	REGISTERX("ass","ASS","Add ASS/SSA subtitles to the picture.",VF_ASS,1,ass_create,ass_script);
 #endif
         REGISTERX("vobsub","VobSub","Embed VobSub subtitles into picture.",VF_VOBSUB,1,vobsub_create,vobsub_script);
+        REGISTERX("dvbsub","DVB sub","Embed DVB-T subtitle.",VF_DVBSUB,1,dvbsub_create,dvbsub_script);
         
 
         //*********************

Modified: branches/avidemux_2.4_branch/avidemux/ADM_filter/video_filters.h
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_filter/video_filters.h	2007-07-22 09:28:23 UTC (rev 3431)
+++ branches/avidemux_2.4_branch/avidemux/ADM_filter/video_filters.h	2007-07-22 16:05:17 UTC (rev 3432)
@@ -98,6 +98,7 @@
                 VF_FADE,
                 VF_ASS,
                 VF_YADIF,
+                VF_DVBSUB,
                 VF_DUMMY,
                 VF_EXTERNAL_START=0xF0000000
           }VF_FILTERS;

Modified: branches/avidemux_2.4_branch/avidemux/ADM_inputs/ADM_mpegdemuxer/dmx_demuxerTS.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_inputs/ADM_mpegdemuxer/dmx_demuxerTS.cpp	2007-07-22 09:28:23 UTC (rev 3431)
+++ branches/avidemux_2.4_branch/avidemux/ADM_inputs/ADM_mpegdemuxer/dmx_demuxerTS.cpp	2007-07-22 16:05:17 UTC (rev 3432)
@@ -302,7 +302,38 @@
                 }
                 return 1;
 }
+/**
+      \fn readPes
+      \brief Read a complete PES packet
+*/
+uint8_t dmx_demuxerTS::readPes(uint8_t *data, uint32_t *pesBlockLen, uint32_t *dts,uint32_t *pts)
+{
+  uint32_t total=0;
+    if(!refill())
+    {
+      printf("[DMX] Refill failed\n");
+      return 0; 
+    }
+    *dts=_pesDTS;
+    *pts=_pesPTS;
+    total=_pesBufferLen;
+    memcpy(data,_pesBuffer,_pesBufferLen);
+    while(packLen)
+    {
+        if(!refill())
+        {
+          printf("[DMX] Refill failed\n");
+          return 0; 
+        }
 
+        memcpy(data+total,_pesBuffer,_pesBufferLen);
+        total+=_pesBufferLen;      
+      
+    }
+    *pesBlockLen=total;
+    printf("[DMX] Read %d bytes, packMode %u, pesLen %u\n",*pesBlockLen,packMode,packLen);
+    return 1;
+}
 //
 //      Refill the pesBuffer
 //              Read packet of correct PID, locate a PES start and read the whole PES packet

Modified: branches/avidemux_2.4_branch/avidemux/ADM_inputs/ADM_mpegdemuxer/dmx_demuxerTS.h
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_inputs/ADM_mpegdemuxer/dmx_demuxerTS.h	2007-07-22 09:28:23 UTC (rev 3431)
+++ branches/avidemux_2.4_branch/avidemux/ADM_inputs/ADM_mpegdemuxer/dmx_demuxerTS.h	2007-07-22 16:05:17 UTC (rev 3432)
@@ -93,7 +93,7 @@
                   uint8_t         hasAudio(void) { return 1;} // MAYBE has audio
                   uint8_t         getStats(uint64_t *stat);
                   uint8_t         changePid(uint32_t newpid,uint32_t newpes);
-
+                  uint8_t         readPes(uint8_t *data, uint32_t *pesBlockLen, uint32_t *dts,uint32_t *pts);
 // Inlined
 uint8_t         read8i(void)
 {

Copied: branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/ADM_vidDvbSub.cpp (from rev 3422, branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/ADM_vidASS.cpp)
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/ADM_vidASS.cpp	2007-07-21 03:38:04 UTC (rev 3422)
+++ branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/ADM_vidDvbSub.cpp	2007-07-22 16:05:17 UTC (rev 3432)
@@ -0,0 +1,290 @@
+/***************************************************************************
+                         DVB-T subtitle filter
+    
+    copyright            : (C) 2007 by mean
+    email                : fixounet at free.fr
+ ***************************************************************************/
+
+/***************************************************************************
+ *                                                                         *
+ *   This program is free software; you can redistribute it and/or modify  *
+ *   it under the terms of the GNU General Public License as published by  *
+ *   the Free Software Foundation; either version 2 of the License, or     *
+ *   (at your option) any later version.                                   *
+ *                                                                         *
+ ***************************************************************************/
+
+
+
+#include "config.h"
+
+#include <stdio.h>
+#include <stdlib.h>
+#include <string.h>
+#include "ADM_lavcodec.h"
+#include "ADM_assert.h"
+#include "default.h"
+
+#include "fourcc.h"
+
+
+#include "ADM_toolkit/toolkit.hxx"
+#include "ADM_editor/ADM_edit.hxx"
+#include "ADM_video/ADM_genvideo.hxx"
+#include "ADM_video/ADM_vidCommonFilter.h"
+#include "ADM_filter/video_filters.h"
+#include "ADM_colorspace/ADM_rgb.h"
+#include "ADM_userInterfaces/ADM_commonUI/DIA_factory.h"
+
+#include "DIA_factory.h"
+#include "ADM_inputs/ADM_mpegdemuxer/dmx_mpegstartcode.h"
+#include "ADM_inputs/ADM_mpegdemuxer/dmx_demuxerTS.h"
+
+#include "ADM_colorspace/colorspace.h"
+#include "ADM_codecs/ADM_codec.h"
+#include "ADM_codecs/ADM_ffmp43.h"
+
+#define READ_BUFFER_SIZE (64*1024)
+
+class ADMVideoSubDVB : public AVDMGenericVideoStream 
+{
+protected:
+        virtual char* printConf(void);
+       
+        uint8_t init(void);
+        
+        decoderFFSubs *decoder;
+        ADMCompressedImage *binary;
+        dmx_demuxerTS *demuxer;
+        AVSubtitle  sub;
+        uint8_t     readBuffer[READ_BUFFER_SIZE];
+        uint32_t    _inited;
+        
+public:
+        ADMVideoSubDVB(AVDMGenericVideoStream *in, CONFcouple *conf);
+        virtual ~ADMVideoSubDVB();
+        virtual uint8_t getFrameNumberNoAlloc(uint32_t frame, uint32_t *len, ADMImage *data,uint32_t *flags);
+        uint8_t configure(AVDMGenericVideoStream *instream);
+        uint8_t	getCoupledConf(CONFcouple **conf);
+};
+
+static FILTER_PARAM assParam={7,
+        { /* float */ "font_scale",
+          /*float*/ "line_spacing",
+          /* int */ "top_margin",
+          /* int */ "bottom_margin",
+          /* bool */ "extract_embedded_fonts",
+          /* ADM_filename */ "fonts_dir",
+          /* ADM_filename */ "subfile" }};
+
+SCRIPT_CREATE(dvbsub_script,ADMVideoSubDVB,assParam);
+BUILD_CREATE(dvbsub_create,ADMVideoSubDVB);
+
+char *ADMVideoSubDVB::printConf() 
+{
+      static char buf[50];
+      sprintf((char *)buf," DVB Subtitle ");
+      
+      return buf;
+}
+
+
+uint8_t ADMVideoSubDVB::configure(AVDMGenericVideoStream * instream)
+{
+  
+   return 1;
+}
+
+//_______________________________________________________________
+
+ADMVideoSubDVB::ADMVideoSubDVB(AVDMGenericVideoStream *in, CONFcouple *conf) 
+{
+        _in=in;		
+        memcpy(&_info,_in->getInfo(),sizeof(_info));
+        
+        
+      
+        _uncompressed=new ADMImage(_in->getInfo()->width,_in->getInfo()->height);
+        ADM_assert(_uncompressed);
+        _info.encoding=1;
+        
+        decoder=new decoderFFSubs(1);
+        binary=new ADMCompressedImage;
+        binary->data=readBuffer+2;
+        
+        MPEG_TRACK track;
+        track.pid=0x96;
+
+        
+        demuxer=new dmx_demuxerTS(1,&track,0,DMX_MPG_TS);
+        _inited=init();
+
+      
+}
+// **********************************
+uint8_t ADMVideoSubDVB::init(void)
+{
+const char  *tsFileName="/capture/grey/Grey_anatomy_2007_05_22_Avec_Le_Temp.mpg";
+    // First create our demuxer
+     
+     if(!demuxer->open(tsFileName))
+     {
+        printf("Cannot open TS\n");
+        return 0; 
+     }
+      memset(&sub,0,sizeof(sub));
+     
+     return 1;
+} 
+
+//*******************************************
+ADMVideoSubDVB::~ADMVideoSubDVB() 
+{
+      if(_uncompressed) DELETE(_uncompressed);
+      if(decoder) delete decoder;
+      if(binary) delete binary;
+      if(demuxer) delete demuxer;
+      decoder=NULL;
+      binary=NULL;
+      demuxer=NULL;
+   
+}
+//*******************************************
+#define _r(c)  ((c)&0xff)
+#define _b(c)  (((c)>>16)&0xFF)
+#define _g(c)  (((c)>>8)&0xFF)
+#define _a(c)  ((c)>>24)
+#define rgba2y(c)  ( (( 263*_r(c)  + 516*_g(c) + 100*_b(c)) >> 10) + 16  )
+#define rgba2u(c)  ( (( 450*_r(c) - 376*_g(c) -  73*_b(c)) >> 10) + 128 )
+#define rgba2v(c)  ( ((-152*_r(c) - 298*_g(c) + 450*_b(c)) >> 10) + 128 )
+
+uint8_t ADMVideoSubDVB::getFrameNumberNoAlloc(uint32_t frame, uint32_t *len, ADMImage *data, uint32_t *flags) 
+{
+uint8_t *org=NULL;
+
+      // Read the original PIC
+        
+        if(!_in->getFrameNumberNoAlloc(frame, len, data, flags))
+                return 0;
+
+        if(!_inited) 
+        {
+          return 0; 
+        }
+        // Read the compressed DVB....
+        
+        uint32_t packetLen,dts,pts;
+          if(!demuxer->readPes(readBuffer,&packetLen, &dts,&pts)) return 1;
+          binary->dataLength=packetLen-3; // -2 for stream iD, -1 for ????
+          if(packetLen<=5) return 1;
+          // And decompress...
+          decoder->uncompress(binary,&sub);
+            
+          // Process All rectangles
+          
+            printf("Found %d rects to process\n",sub.num_rects);
+            for(int i=0;i<sub.num_rects;i++)
+            {
+              AVSubtitleRect *r=&(sub.rects[i]);
+              // First convert RGB to Y+ALPHA
+              for(int col=0;col<r->nb_colors;col++)
+              {
+                    // Color is RGB, convert to YUV
+                    uint32_t y,a;
+                    uint32_t rgb=r->rgba_palette[col];
+                
+                          y=rgba2y(rgb);
+                          a=_a(rgb);
+                          r->rgba_palette[col]=y+(a<<8);
+                          printf("Color %d, alpha %u luma %u rgb:%x\n",col,a,y,rgb);
+              }
+              // Palette is ready, display !
+              if(r->x>_info.width || r->y>_info.height)
+              {
+                  printf("[DVBSUB]Box is outside image\n");
+                  goto _skip;
+              }
+                  printf("x :%d\n",r->x);
+                  printf("y :%d\n",r->y);
+                  printf("w :%d\n",r->w);
+                  printf("h :%d\n",r->h);
+
+                  {
+                      uint32_t clipW,clipH;
+                      
+                      clipW=FFMIN(_info.width,r->x+r->w)-r->x;
+                      clipH=FFMIN(_info.height,r->y+r->h)-r->y;
+                      
+                      ADMImage image(r->w,r->h);
+                      ADMImage alphaImage(r->w,r->h);
+                      
+                      uint8_t *ptr=image.data;
+                      uint8_t *ptrAlpha=alphaImage.data;
+                      uint8_t *in=r->bitmap;
+                      for(int yy=0;yy<r->h;yy++)
+                      {
+                          for(int xx=0;xx<r->w;xx++)
+                          {
+                            uint32_t alpha;
+                            uint32_t val=*in++;
+                            
+                                  val=r->rgba_palette[val];
+                                  alpha=val>>8;
+                                  val&=0xff;
+                                  
+                                  *ptr++=val;
+                                  *ptrAlpha++=alpha;
+                          }
+                      }
+              
+                      // Merge Luma
+                      
+                      for(int yy=0;yy<clipH;yy++)
+                      {
+                          org=data->data+(yy+r->y)*_info.width+r->x;
+                          
+                          ptrAlpha=alphaImage.data+yy*r->w;
+                          ptr=image.data+yy*r->w;
+                        
+                          for(int xx=0;xx<clipW;xx++)
+                          {
+                            uint32_t val,before,alpha;
+                            
+                                  before=*org;
+                                  val=*ptr++;
+                                  alpha=*ptrAlpha++;
+                                  
+                                  val=val*alpha+(255-alpha)*before;
+                                  val>>=8;
+                                  *org++=val;
+                          }
+                      }
+              }
+               // Delete palette & data
+_skip:
+               av_free(r->rgba_palette);
+               av_free(r->bitmap);
+            } // Next rec..
+            memset(&sub,0,sizeof(sub));
+        
+        return 1;
+}
+
+uint8_t	ADMVideoSubDVB::getCoupledConf(CONFcouple **conf) 
+{
+
+        *conf=NULL; //new CONFcouple(0);
+#if 0
+#define _COUPLE_SET(x) (*conf)->setCouple(#x, _params->x);
+        _COUPLE_SET(font_scale)
+        _COUPLE_SET(line_spacing)
+        _COUPLE_SET(top_margin)
+        _COUPLE_SET(bottom_margin)
+        _COUPLE_SET(subfile)
+        _COUPLE_SET(fonts_dir)
+        _COUPLE_SET(extract_embedded_fonts)
+#endif
+     
+        return 1;
+}
+/************************************************/

Modified: branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/CMakeLists.txt
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/CMakeLists.txt	2007-07-22 09:28:23 UTC (rev 3431)
+++ branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/CMakeLists.txt	2007-07-22 16:05:17 UTC (rev 3432)
@@ -23,5 +23,6 @@
 ADM_vidTdeint.cpp
 ADM_vidChromaShift.cpp  
 ADM_vidAnimated.cpp
+ADM_vidDvbSub.cpp
 )
 ADD_LIBRARY(ADM_videoFilter STATIC ${ADM_videoFilter_SRCS})



From gruntster at mail.berlios.de  Sun Jul 22 19:24:07 2007
From: gruntster at mail.berlios.de (gruntster at mail.berlios.de)
Date: Sun, 22 Jul 2007 19:24:07 +0200
Subject: [Avidemux-svn-commit] r3433 - in
	branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces:
	ADM_GTK/ADM_dialogFactory ADM_commonUI
Message-ID: <200707221724.l6MHO7bn014413@sheep.berlios.de>

Author: gruntster
Date: 2007-07-22 19:23:52 +0200 (Sun, 22 Jul 2007)
New Revision: 3433

Modified:
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialogFactory/FAC_bitrate.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp
Log:
[I18N] include strings in pot file generation

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialogFactory/FAC_bitrate.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialogFactory/FAC_bitrate.cpp	2007-07-22 16:05:17 UTC (rev 3432)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialogFactory/FAC_bitrate.cpp	2007-07-22 17:23:52 UTC (rev 3433)
@@ -92,16 +92,12 @@
   combo = gtk_combo_box_new_text ();
   gtk_widget_show (combo);
   
-  
   gtk_label_set_mnemonic_widget (GTK_LABEL(label1), combo);
+  gtk_combo_box_append_text (GTK_COMBO_BOX (combo),_("Single pass - bitrate"));
+  gtk_combo_box_append_text (GTK_COMBO_BOX (combo),_("Single pass - constant quality"));
+  gtk_combo_box_append_text (GTK_COMBO_BOX (combo),_("Two pass - video size"));
+  gtk_combo_box_append_text (GTK_COMBO_BOX (combo),_("Two pass - average bitrate"));
   
-#define add(x) gtk_combo_box_append_text (GTK_COMBO_BOX (combo),_(#x));
-  
-  add(Single pass - bitrate);
-  add(Single pass - constant quality);
-  add(Two pass - video size);
-  add(Two pass - average bitrate);
-  
   PUT_ARRAY(1,0,combo);
   
   
@@ -201,36 +197,36 @@
   GtkSpinButton *spin=(GtkSpinButton*)w[3];
   GtkLabel *label=(GtkLabel*)w[1];
   int rank=gtk_combo_box_get_active(GTK_COMBO_BOX(combo));
-#undef P
+//#undef P
 #undef M
 #undef S
-#define P(x) gtk_label_set_text_with_mnemonic(GTK_LABEL(label),_(#x));
+//#define P(x) gtk_label_set_text_with_mnemonic(GTK_LABEL(label),_(#x));
 #define M(x,y) gtk_spin_button_set_range  (GTK_SPIN_BUTTON(spin),x,y)
 #define S(x)   gtk_spin_button_set_value  (GTK_SPIN_BUTTON(spin),x)
   switch(rank)
   {
     case 0: //CBR
-          P(_Bitrate (kb/s):);
+          gtk_label_set_text_with_mnemonic(GTK_LABEL(label),_("_Bitrate (kb/s):"));
           M(0,20000);
           S(copy.bitrate);
           break; 
     case 1:// CQ
-          P(_Quantizer:);
+          gtk_label_set_text_with_mnemonic(GTK_LABEL(label),_("_Quantizer:"));
           M(2,maxQ);
           S(copy.qz);
           break;
     case 2 : // 2pass Filesize
-          P(_Video size (MB):);
+          gtk_label_set_text_with_mnemonic(GTK_LABEL(label),_("_Video size (MB):"));
           M(1,8000);
           S(copy.finalsize);
           break;
     case 3 : // 2pass Avg
-          P(_Average bitrate (kb/s):);
+          gtk_label_set_text_with_mnemonic(GTK_LABEL(label),_("_Average bitrate (kb/s):"));
           M(0,20000);
           S(copy.avg_bitrate);
           break;
     case 4 : // Same Qz as input
-          P(-);
+          gtk_label_set_text_with_mnemonic(GTK_LABEL(label),_("-"));
           M(0,0);
           break;
     default:ADM_assert(0);

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp	2007-07-22 16:05:17 UTC (rev 3432)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp	2007-07-22 17:23:52 UTC (rev 3433)
@@ -311,32 +311,32 @@
         /**********************************************************************/
         /* First Tab : user interface */
         diaElem *diaUser[]={&useSysTray,&menuMessage};
-        diaElemTabs tabUser("User Interface",2,diaUser);
+        diaElemTabs tabUser(_("User Interface"),2,diaUser);
         
          /* First Tab bis: user interface : Auto*/
         diaElem *diaAuto[]={&autoSwap,&togAutoVbr,&togAutoIndex,&togAutoUnpack,&autoIndex,};
-        diaElemTabs tabAuto("Automation",5,diaAuto);
+        diaElemTabs tabAuto(_("Automation"),5,diaAuto);
         
         /* Second Tab : input */
         diaElem *diaInput[]={&nuvAudio,&useLavcodec};
-        diaElemTabs tabInput("Input",2,(diaElem **)diaInput);
+        diaElemTabs tabInput(_("Input"),2,(diaElem **)diaInput);
         
         /* Third Tab : output */
         diaElem *diaOutput[]={&autoSplit,&openDml,&allowAnyMpeg,&togTagMp3};
-        diaElemTabs tabOutput("Output",4,(diaElem **)diaOutput);
+        diaElemTabs tabOutput(_("Output"),4,(diaElem **)diaOutput);
         
         /* Fourth Tab : audio */
         diaElem *diaAudio[]={&menuMixer,&menuVolume,&menuAudio,&entryAlsaDevice};
-        diaElemTabs tabAudio("Audio",4,(diaElem **)diaAudio);
+        diaElemTabs tabAudio(_("Audio"),4,(diaElem **)diaAudio);
         
         /* Fifth Tab : video */
         
         diaElem *diaVideo[]={&menuVideoMode,&framePP};
-        diaElemTabs tabVideo("Video",2,(diaElem **)diaVideo);
+        diaElemTabs tabVideo(_("Video"),2,(diaElem **)diaVideo);
         
         /* Sixth Tab : mthread */
         diaElem *diaCpu[]={&multiThread, &menuEncodePriority, &menuIndexPriority, &menuPlaybackPriority};
-        diaElemTabs tabCpu("CPU",4,(diaElem **)diaCpu);
+        diaElemTabs tabCpu(_("CPU"),4,(diaElem **)diaCpu);
         
         /* 7th Tab : Global Glyph */
         diaElem *diaGlyph[]={&menuGlobaGlyh,&entryGLyphPath};



From gruntster at mail.berlios.de  Sun Jul 22 19:45:21 2007
From: gruntster at mail.berlios.de (gruntster at mail.berlios.de)
Date: Sun, 22 Jul 2007 19:45:21 +0200
Subject: [Avidemux-svn-commit] r3434 - branches/avidemux_2.4_branch/po
Message-ID: <200707221745.l6MHjLEh015637@sheep.berlios.de>

Author: gruntster
Date: 2007-07-22 19:44:51 +0200 (Sun, 22 Jul 2007)
New Revision: 3434

Modified:
   branches/avidemux_2.4_branch/po/it.po
   branches/avidemux_2.4_branch/po/ja.po
Log:
[I18N] ja.po update by tetsuro & it.po update by zoppo

Modified: branches/avidemux_2.4_branch/po/it.po
===================================================================
--- branches/avidemux_2.4_branch/po/it.po	2007-07-22 17:23:52 UTC (rev 3433)
+++ branches/avidemux_2.4_branch/po/it.po	2007-07-22 17:44:51 UTC (rev 3434)
@@ -7,7 +7,7 @@
 "Project-Id-Version: avidemux\n"
 "Report-Msgid-Bugs-To: \n"
 "POT-Creation-Date: 2006-10-04 22:09+0300\n"
-"PO-Revision-Date: 2007-07-11 19:31+0100\n"
+"PO-Revision-Date: 2007-07-21 12:17+0100\n"
 "Last-Translator: \n"
 "Language-Team: it\n"
 "MIME-Version: 1.0\n"
@@ -43,7 +43,7 @@
 
 #: avidemux/ADM_audiofilter/audioencoder_lame.cpp:215
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_audioFilter.cpp:104
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:229
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:236
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_properties.cpp:110
 #: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_props.cpp:101
 #, c-format
@@ -122,8 +122,8 @@
 "The number of channels is greater than what the selected audio codec can do.\n"
 "Either change codec or use the mixer filter to have less channels."
 msgstr ""
-"Il numero di canali ? maggiore di quello supportato dal codec audio selezionato. \n"
-" Cambia il codec o usa il filtro mixer per ridurre i canali."
+"Il numero di canali ? maggiore di quello supportato dal codec audio selezionato.\n"
+"Cambia il codec o usa il filtro mixer per ridurre i canali."
 
 #: avidemux/ADM_codecs/ADM_ffmp43.cpp:52
 msgid "Internal error finding codec"
@@ -474,7 +474,7 @@
 msgstr "Errore conversione in BMP"
 
 #: avidemux/ADM_libraries/ADM_utilities/ADM_imageUtils.cpp:417
-#: avidemux/gtk_gui.cpp:1920
+#: avidemux/gtk_gui.cpp:1922
 msgid "Something bad happened"
 msgstr "C'? stato qualche errore"
 
@@ -483,20 +483,23 @@
 msgstr "Impossibile codificare il fotogramma"
 
 #: avidemux/ADM_libraries/ADM_utilities/ADM_imageUtils.cpp:481
-#: avidemux/ADM_ocr/ADM_ocrLoadSave.h:71
+#: avidemux/ADM_ocr/adm_glyph.cpp:221
 #: avidemux/ADM_outputs/oplug_mpegFF/oplug_vcdff.cpp:380
 #: avidemux/ADM_outputs/oplug_ogm/op_ogsave.cpp:112
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_ocr/adm_editglyph.cpp:364
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:105
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:110
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:117
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:126
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_toolkit_gtk/TLK_filesel.cpp:335
-#: avidemux/gtk_gui.cpp:893
-#: avidemux/gtk_gui.cpp:1525
+#: avidemux/gtk_gui.cpp:895
+#: avidemux/gtk_gui.cpp:1527
 msgid "File error"
 msgstr "Errore file"
 
 #: avidemux/ADM_libraries/ADM_utilities/ADM_imageUtils.cpp:481
 #: avidemux/ADM_outputs/oplug_mpegFF/oplug_vcdff.cpp:380
 #: avidemux/ADM_outputs/oplug_ogm/op_ogsave.cpp:112
-#: avidemux/gtk_gui.cpp:1525
+#: avidemux/gtk_gui.cpp:1527
 #, c-format
 msgid "Cannot open \"%s\" for writing."
 msgstr "Impossibile aprire \"%s\" per la scrittura."
@@ -530,21 +533,11 @@
 msgid "Unknown"
 msgstr "Sconosciuto"
 
-#: avidemux/ADM_ocr/ADM_ocrLoadSave.h:22
-msgid "Select Glyphfile to save to"
-msgstr "Seleziona il file Glyph in cui salvare"
-
-#: avidemux/ADM_ocr/ADM_ocrLoadSave.h:30
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_ocr/adm_editglyph.cpp:282
+#: avidemux/ADM_ocr/adm_glyph.cpp:173
 msgid "Could not write the file"
 msgstr "Impossibile scrivere il file"
 
-#: avidemux/ADM_ocr/ADM_ocrLoadSave.h:62
-msgid "Erase current glyphs ?"
-msgstr "Eliminare i glyph correnti?"
-
-#: avidemux/ADM_ocr/ADM_ocrLoadSave.h:71
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_ocr/adm_editglyph.cpp:364
+#: avidemux/ADM_ocr/adm_glyph.cpp:221
 #, c-format
 msgid "Could not read \"%s\"."
 msgstr "Impossibile leggere \"%s\"."
@@ -659,7 +652,7 @@
 msgstr "%lu secondi"
 
 #: avidemux/ADM_outputs/oplug_avi/op_avisave.cpp:74
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:181
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:188
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp:845
 msgid "Normal"
 msgstr "Normale"
@@ -919,8 +912,8 @@
 #: avidemux/ADM_videoFilter/ADM_lavpp_deint.cpp:105
 #: avidemux/ADM_videoFilter/ADM_vidDecTelecide.cpp:101
 #: avidemux/ADM_videoFilter/ADM_vidRotate.cpp:264
-#: avidemux/gtk_gui.cpp:1998
-#: avidemux/gtk_gui.cpp:2097
+#: avidemux/gtk_gui.cpp:2000
+#: avidemux/gtk_gui.cpp:2099
 msgid "None"
 msgstr "Nessuno"
 
@@ -1376,19 +1369,56 @@
 msgid "_Swap U&V:"
 msgstr "_Inverti U e V"
 
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:82
+msgid "Select idx file:"
+msgstr "Seleziona un file idx:"
+
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:83
+msgid "Use glyphset (optional):"
+msgstr "Usa set di glifi (opzionale):"
+
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:84
+msgid "Output SRT file"
+msgstr "File SRT in uscita"
+
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:95
+msgid "Select input and ouput files"
+msgstr "Seleziona file di ingresso e di uscita"
+
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:105
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:117
+msgid "The idx/sub file does not exist."
+msgstr "Il file idx/sub non esiste."
+
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:110
+msgid "Please Select a valid output SRT file."
+msgstr "Seleziona un file SRT in uscita valido."
+
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:126
+msgid "Cannot load the glyphset file."
+msgstr "Impossibile caricare il set di glifi."
+
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:144
+msgid "Glyphset filename"
+msgstr "Nome file del set di glifi"
+
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:146
+msgid "Save Glyph"
+msgstr "Salva glifo"
+
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_postproc.cpp:40
 #: avidemux/ADM_videoFilter/ADM_vidForcedPP.cpp:60
 msgid "_Filter strength:"
 msgstr "Intensit? _filtro:"
 
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_postproc.cpp:51
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:278
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:285
 #: avidemux/ADM_videoFilter/ADM_vidForcedPP.cpp:72
 msgid "_Horizontal deblocking"
 msgstr "Deblocking _orizzontale"
 
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_postproc.cpp:52
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:279
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:286
 #: avidemux/ADM_videoFilter/ADM_vidForcedPP.cpp:73
 msgid "_Vertical deblocking"
 msgstr "Deblocking _verticale"
@@ -1398,55 +1428,55 @@
 msgid "_Deringing"
 msgstr "_Deringing"
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:163
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:170
 msgid "_Use systray while encoding"
 msgstr "_Usa systray durante la codifica"
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:164
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:171
 msgid "_Accept non-standard audio frequency for DVD"
 msgstr "_Accetta frequenze audio non standard per DVD"
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:165
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:172
 msgid "_Use libavcodec MPEG-2 decoder"
 msgstr "_Usa decodificatore libavcodec MPEG-2"
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:166
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:173
 msgid "Create _OpenDML files"
 msgstr "Crea file _OpenDML"
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:167
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:174
 msgid "Automatically _index MPEG files"
 msgstr "Indicizza automaticamente i file MPEG"
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:168
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:175
 msgid "Automatically _swap A and B if A>B"
 msgstr "Inverti automaticamente A e B se A>B"
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:169
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:176
 msgid "_Disable NUV audio sync"
 msgstr "_Disattiva sincronizzazione audio NUV"
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:170
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:177
 msgid "_Load external filters"
 msgstr "_Carica filtri esterni"
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:172
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:179
 msgid "Automatically _build VBR map"
 msgstr "_Crea automaticamente la mappa VBR"
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:173
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:180
 msgid "Automatically _rebuild index"
 msgstr "_Ricostrusci automaticamente l'indice"
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:174
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:181
 msgid "Automatically remove _packed bitstream"
 msgstr "Rimuovi automaticamente il _flusso di bit compresso"
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:176
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:183
 msgid "_Number of threads:"
 msgstr "_Numero di thread:"
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:179
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:186
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp:843
 #: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_srt.cpp:108
 #: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_x264.cpp:105
@@ -1454,15 +1484,15 @@
 msgid "High"
 msgstr "Alta"
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:180
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:187
 msgid "Above normal"
 msgstr "Al di sopra del normale"
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:182
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:189
 msgid "Below normal"
 msgstr "Al di sotto del normale"
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:183
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:190
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp:847
 #: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_srt.cpp:107
 #: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_x264.cpp:104
@@ -1470,124 +1500,148 @@
 msgid "Low"
 msgstr "Bassa"
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:185
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:192
 msgid "_Encoding priority:"
 msgstr "_Priorit? di codifica:"
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:186
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:193
 msgid "_Indexing/unpacking priority:"
 msgstr "Priorit? di _indicizzazione/decompressione:"
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:187
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:194
 msgid "_Playback priority:"
 msgstr "Priorit? playback:"
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:189
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:196
 msgid "_Split MPEG files every (MB):"
 msgstr "_Dividi i file MPEG ogni (MB):"
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:191
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:198
 msgid "_Use alternative tag for MP3 in .mp4"
 msgstr "_Usa etichette alternative per gli MP3 in file .mp4"
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:194
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:201
 msgid "GTK+ (slow)"
 msgstr "GTK+ (lento)"
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:196
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:203
 msgid "XVideo (best)"
 msgstr "XVideo (migliore)"
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:200
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:207
 msgid "SDL (GDI)"
 msgstr "SDL (GDI)"
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:201
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:208
 msgid "SDL (DirectX)"
 msgstr "SDL (DirectX)"
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:203
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:210
 msgid "SDL (good)"
 msgstr "SDL (buono)"
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:207
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:214
 msgid "Video _display:"
 msgstr "_Visualizzazione video:"
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:212
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:219
 msgid "No alerts"
 msgstr "Nessun avviso"
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:213
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:220
 msgid "Display only error alerts"
 msgstr "Visualizza solo gli avvisi di errore"
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:214
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:221
 msgid "Display all alerts"
 msgstr "Visualizza tutti gli avvisi"
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:216
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:223
 msgid "_Message level:"
 msgstr "Livello _messaggio:"
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:221
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:228
 msgid "PCM"
 msgstr "PCM"
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:222
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:229
 msgid "Master"
 msgstr "Master"
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:223
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:230
 msgid "_Volume control:"
 msgstr "Controllo _volume:"
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:228
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:235
 msgid "No downmixing"
 msgstr "No downmixing"
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:230
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:237
 msgid "Pro Logic"
 msgstr "Pro Logic"
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:231
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:238
 msgid "Pro Logic II"
 msgstr "Pro Logic II"
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:233
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:240
 msgid "_Local playback downmixing:"
 msgstr "_Local playback downmixing:"
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:265
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:272
 msgid "_Audio output:"
 msgstr "Output _audio"
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:267
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:274
 msgid "ALSA _device:"
 msgstr "_Dispositivo ALSA:"
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:280
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:287
 msgid "De_ringing"
 msgstr "De_ringing"
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:281
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:288
 #: avidemux/ADM_videoFilter/ADM_vidMSharpen.cpp:167
 msgid "_Strength:"
 msgstr "_Forza:"
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:282
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:289
 msgid "Default Postprocessing"
 msgstr "Postprocessing predefinito"
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:296
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:303
 msgid "_Filter directory:"
 msgstr "Cartella _filtri:"
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:330
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:306
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_properties.cpp:47
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_props.cpp:26
+msgid "No"
+msgstr "No"
+
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:307
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_properties.cpp:47
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_props.cpp:26
+msgid "Yes"
+msgstr "S?"
+
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:308
+msgid "Use _Global GlyphSet:"
+msgstr "Usa set di glifi _globale:"
+
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:309
+msgid "Gl_yphSet:"
+msgstr "Set di gl_ifi:"
+
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:343
+msgid "Global Glyphset"
+msgstr "Set di glifi globale"
+
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:348
 msgid "External Filters"
 msgstr "Filtri esterni"
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:334
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:352
 msgid "Preferences"
 msgstr "Preferenze"
 
@@ -1721,11 +1775,11 @@
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp:788
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_idx_pg.cpp:166
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_idx_pg.cpp:206
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_ocr.cpp:148
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_ocr.cpp:156
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_ocr.cpp:89
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_ocr.cpp:96
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_resize.cpp:419
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_resize.cpp:433
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1399
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1429
 msgid "0"
 msgstr "0"
 
@@ -1841,7 +1895,7 @@
 msgstr "Matteo 'Maff' Angelino"
 
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_about.cpp:69
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:267
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:272
 msgid "Avidemux"
 msgstr "Avidemux"
 
@@ -2200,9 +2254,9 @@
 "library.  If this is what you want to do, use the GNU Library General\n"
 "Public License instead of this License."
 msgstr ""
-"Avidemux ? un programma libero e gratuito; puoi ridistribuirlo e/o modificarlo\n"
-"secondo i termini della Licenza Pubblica Generica GNU versione 2\n"
-"come pubblicato dalla Free Software Foundation.\n"
+"Avidemux ? un programma libero e gratuito; puoi ridistribuirlo e/o\n"
+"modificarlo secondo i termini della Licenza Pubblica Generica GNU\n"
+"versione 2 come pubblicato dalla Free Software Foundation.\n"
 "\n"
 "\t\t    GNU GENERAL PUBLIC LICENSE\n"
 "\t\t       Version 2, June 1991\n"
@@ -2557,35 +2611,34 @@
 msgid "Configure codec"
 msgstr "Configura codec"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_asharp.cpp:72
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_chromaShift.cpp:72
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_asharp.cpp:73
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_chromaShift.cpp:68
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_contrast.cpp:74
 msgid "ASHARP"
 msgstr "ASHARP"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_asharp.cpp:185
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_asharp.cpp:199
 msgid "ASharp by MarcFD"
 msgstr "ASharp di MarcFD"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_asharp.cpp:198
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_asharp.cpp:212
 msgid "Threshold :"
 msgstr "Soglia:"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_asharp.cpp:206
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_asharp.cpp:220
 msgid "Strength :"
 msgstr "Forza:"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_asharp.cpp:214
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_asharp.cpp:228
 msgid "Block Adaptative :"
 msgstr "Blocco adattativo:"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_asharp.cpp:222
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_asharp.cpp:236
 msgid "Unknown flag :"
 msgstr "Flag sconosciuta:"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_asharp.cpp:254
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_ocr.cpp:208
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_ocr.cpp:271
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_asharp.cpp:268
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_ocr.cpp:145
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_properties.cpp:262
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_properties.cpp:283
 msgid " "
@@ -2596,7 +2649,7 @@
 msgstr "Occupato"
 
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp:401
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:987
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:992
 msgid "Calculator"
 msgstr "Calcola bitrate"
 
@@ -2712,19 +2765,19 @@
 msgid "<b>Result</b>"
 msgstr "<b>Risultato</b>"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_chromaShift.cpp:189
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_chromaShift.cpp:199
 msgid "ChromaShift"
 msgstr "ChromaShift"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_chromaShift.cpp:203
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_chromaShift.cpp:213
 msgid "U Shift :"
 msgstr "U Shift :"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_chromaShift.cpp:210
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_chromaShift.cpp:220
 msgid "V Shift :"
 msgstr "V Shift :"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_chromaShift.cpp:252
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_chromaShift.cpp:262
 msgid "<b>Preview</b>"
 msgstr "<b>Anteprima</b>"
 
@@ -2777,13 +2830,13 @@
 msgstr "ColorYuv (da Avisynth)"
 
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_coloryuv.cpp:179
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_contrast.cpp:197
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_contrast.cpp:215
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_contrast.cpp:210
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_contrast.cpp:228
 msgid "Contrast"
 msgstr "Contrasto"
 
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_coloryuv.cpp:186
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_contrast.cpp:224
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_contrast.cpp:237
 msgid "Brightness"
 msgstr "Luminosit?"
 
@@ -2796,7 +2849,7 @@
 msgstr "Luma Y"
 
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_coloryuv.cpp:214
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_contrast.cpp:242
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_contrast.cpp:255
 msgid "Chroma U"
 msgstr "Croma U"
 
@@ -2864,39 +2917,39 @@
 msgid "<b>frame2</b>"
 msgstr "<b>fotogramma2</b>"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_contrast.cpp:238
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_contrast.cpp:251
 msgid "Luma"
 msgstr "Luma"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_contrast.cpp:246
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_contrast.cpp:259
 msgid "Chroma v"
 msgstr "Croma V"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_crop.cpp:263
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_crop.cpp:273
 msgid "Crop Settings"
 msgstr "Impostazioni ritaglio"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_crop.cpp:297
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_crop.cpp:307
 msgid "AutoCrop"
 msgstr "AutoCrop"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_crop.cpp:319
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_crop.cpp:329
 msgid "Reset"
 msgstr "Ripristina"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_crop.cpp:328
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_crop.cpp:338
 msgid "Crop Left :"
 msgstr "Taglia a sinistra:"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_crop.cpp:336
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_crop.cpp:346
 msgid "Crop Top:"
 msgstr "Taglia in alto:"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_crop.cpp:344
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_crop.cpp:354
 msgid "Crop Right:"
 msgstr "Taglia a destra:"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_crop.cpp:352
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_crop.cpp:362
 msgid "Crop Bottom:"
 msgstr "Taglia in basso:"
 
@@ -3023,47 +3076,47 @@
 msgid "Pause / Abort"
 msgstr "Pausa / Annulla"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_eq2.cpp:330
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_eq2.cpp:343
 msgid "MPlayer eq2"
 msgstr "MPlayer eq2"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_eq2.cpp:356
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_eq2.cpp:369
 msgid "Brigh_tness:"
 msgstr "Luminosi_t?:"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_eq2.cpp:364
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_eq2.cpp:377
 msgid "_Saturation:"
 msgstr "_Saturazione:"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_eq2.cpp:399
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_eq2.cpp:412
 msgid "_Contrast:"
 msgstr "_Contrasto:"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_eq2.cpp:425
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_eq2.cpp:438
 msgid "_Initial:"
 msgstr "_Iniziale:"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_eq2.cpp:451
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_eq2.cpp:464
 msgid "_Red:"
 msgstr "_Rosso:"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_eq2.cpp:468
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_eq2.cpp:481
 msgid "_Green:"
 msgstr "_Verde:"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_eq2.cpp:476
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_eq2.cpp:489
 msgid "_Blue:"
 msgstr "_Blu:"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_eq2.cpp:484
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_eq2.cpp:497
 msgid "_Weight:"
 msgstr "_Peso:"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_eq2.cpp:510
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_eq2.cpp:523
 msgid "<b>Gamma</b>"
 msgstr "<b>Gamma</b>"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_equalizer.cpp:433
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_equalizer.cpp:449
 msgid "Equalizer"
 msgstr "Equalizzatore"
 
@@ -3075,19 +3128,19 @@
 msgid "Enter parameters (i.e. -b 192 -m s ...)"
 msgstr "Immetti parametri (es. -b 192 -ms ...)"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_hue.cpp:84
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_hue.cpp:76
 msgid "Hue"
 msgstr "Tonalit?"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_hue.cpp:184
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_hue.cpp:186
 msgid "Hue/Saturation"
 msgstr "Tonalit?/Saturazione"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_hue.cpp:198
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_hue.cpp:200
 msgid "<b>Hue:</b>"
 msgstr "<b>Tonalit?:</b>"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_hue.cpp:206
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_hue.cpp:208
 msgid "<b>Saturation:</b>"
 msgstr "<b>Saturazione:</b>"
 
@@ -3142,7 +3195,7 @@
 
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_jobs.cpp:25
 #: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_jobs.cpp:26
-#: avidemux/gtk_gui.cpp:2275
+#: avidemux/gtk_gui.cpp:2277
 msgid "Failed"
 msgstr "Fallito"
 
@@ -3266,99 +3319,75 @@
 msgid "Output _file:"
 msgstr "_File in uscita:"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_mpdelogo.cpp:356
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_mpdelogo.cpp:378
 msgid "Mplayer Delogo"
 msgstr "Mplayer Delogo"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_mpdelogo.cpp:374
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_mpdelogo.cpp:396
 msgid "X"
 msgstr "X"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_mpdelogo.cpp:381
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_mpdelogo.cpp:403
 msgid "Y"
 msgstr "Y"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_mpdelogo.cpp:388
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_mpdelogo.cpp:410
 msgid "W"
 msgstr "W"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_mpdelogo.cpp:395
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_mpdelogo.cpp:417
 msgid "H"
 msgstr "H"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_mpdelogo.cpp:402
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_mpdelogo.cpp:424
 msgid "Band"
 msgstr "Band"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_ocr.cpp:85
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_ocr.cpp:57
 msgid "Mini OCR"
 msgstr "Mini OCR"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_ocr.cpp:118
-msgid "<b>Glyphs</b>"
-msgstr "<b>Glyphs</b>"
-
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_ocr.cpp:132
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_ocr.cpp:75
 msgid "# of Glyphs :"
-msgstr "Numero di Glyphs :"
+msgstr "Numero di glifi :"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_ocr.cpp:140
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_ocr.cpp:82
 msgid "# of lines"
 msgstr "Numero di linee"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_ocr.cpp:164
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_ocr.cpp:103
 msgid "<b>Stats</b>"
 msgstr "<b>Statistiche</b>"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_ocr.cpp:186
-msgid "  "
-msgstr "  "
-
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_ocr.cpp:195
-msgid "VobSub"
-msgstr "VobSub"
-
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_ocr.cpp:217
-msgid "Output Srt"
-msgstr "Output Srt"
-
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_ocr.cpp:222
-msgid "<b>Files</b>"
-msgstr "<b>File</b>"
-
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_ocr.cpp:228
-msgid "StartOcr"
-msgstr "StartOcr"
-
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_ocr.cpp:249
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_ocr.cpp:125
 msgid "Current Glyph"
-msgstr "Glyph corrente"
+msgstr "Glifo corrente"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_ocr.cpp:263
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_ocr.cpp:138
 msgid " Text:"
 msgstr "Testo:"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_ocr.cpp:287
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_ocr.cpp:160
 msgid "Calibrate"
 msgstr "Calibra"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_ocr.cpp:292
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_ocr.cpp:165
 msgid "Skip all"
 msgstr "Salta tutti"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_ocr.cpp:297
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_ocr.cpp:170
 msgid "Skip Glyph"
-msgstr "Salta Glyph"
+msgstr "Salta glifo"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_ocr.cpp:302
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_ocr.cpp:175
 msgid "Ignore glyph"
-msgstr "Ignora glyph"
+msgstr "Ignora glifo"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_ocr.cpp:307
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_ocr.cpp:180
 msgid "Ok"
 msgstr "Ok"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_ocr.cpp:316
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_ocr.cpp:189
 msgid "<b>Bitmap</b>"
 msgstr "<b>Bitmap</b>"
 
@@ -3422,16 +3451,6 @@
 msgid "Stack Field"
 msgstr "Impila campi"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_properties.cpp:47
-#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_props.cpp:26
-msgid "No"
-msgstr "No"
-
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_properties.cpp:47
-#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_props.cpp:26
-msgid "Yes"
-msgstr "S?"
-
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_properties.cpp:67
 #: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_props.cpp:69
 #, c-format
@@ -3512,7 +3531,7 @@
 msgstr "Proporzioni:"
 
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_properties.cpp:318
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1026
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1056
 msgid "<b>Video</b>"
 msgstr "<b>Video</b>"
 
@@ -3557,7 +3576,7 @@
 msgstr "Bitrate variabile:"
 
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_properties.cpp:496
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1066
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1096
 msgid "<b>Audio</b>"
 msgstr "<b>Audio</b>"
 
@@ -3622,11 +3641,11 @@
 msgstr "Lanczos3"
 
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_srt.cpp:92
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_srt.cpp:224
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_srt.cpp:237
 msgid "Subtitle Size and Position"
 msgstr "Dimensione e posizione sottotitoli"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_srt.cpp:238
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_srt.cpp:251
 msgid "Font Size:"
 msgstr "Dimensione carattere:"
 
@@ -3635,8 +3654,8 @@
 msgstr "Codificatore video"
 
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_vcodec.cpp:118
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1046
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1086
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1076
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1116
 msgid "Configure"
 msgstr "Configura"
 
@@ -3816,7 +3835,7 @@
 
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:705
 msgid "Set how many previous frames can be referenced by a P/B-frame. Numbers above 5 do not seem to improve quality greatly. Numbers are 3 to 5 are recommended"
-msgstr "Imposta a quanti fotorammi precedenti pu? riferirsi un fotogramma-P/B. Valori superiori a 5 non sembrano migliorare molto la qualit?. Sono consigliati i valori da 3 a 5"
+msgstr "Imposta a quanti fotogrammi precedenti pu? riferirsi un fotogramma-P/B. Valori superiori a 5 non sembrano migliorare molto la qualit?. Sono consigliati i valori da 3 a 5"
 
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:708
 msgid "Max. Ref. frames"
@@ -4066,7 +4085,7 @@
 
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1099
 msgid "Use fewer B-frame if needed. This is always recommended. If not enabled, the codec will always use the maximum number of consecutive B-frames"
-msgstr "Usa meno fotogrammiB se necessario. Sempre consigliato. Se disattivo, il codec user? sempre il numero massimo di fotogrammi-B consecutivi"
+msgstr "Usa meno fotogrammi-B se necessario. Sempre consigliato. Se disattivo, il codec user? sempre il numero massimo di fotogrammi-B consecutivi"
 
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1102
 msgid "Use as reference"
@@ -4078,7 +4097,7 @@
 
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1113
 msgid "B-Frame Direct Mode:  "
-msgstr "Modalit? diretta fotorammi-B:"
+msgstr "Modalit? diretta fotogrammi-B:"
 
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1121
 msgid "Auto"
@@ -4118,7 +4137,7 @@
 
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1189
 msgid "Set how much bitrate is deducted from a B-frame as compared to the previous P-frame"
-msgstr "Imposta quanto bitrate ? dedotto dal fotogramma-B risetto al precedente fotogramma-P"
+msgstr "Imposta quanto bitrate ? dedotto dal fotogramma-B rispetto al precedente fotogramma-P"
 
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:1198
 msgid "Define how much the bitrate can fluctuate over the entire video. 0% results in a constant bitrate stream, while 100% results in a pure quality based bitrate stream"
@@ -4668,7 +4687,7 @@
 
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:1007
 msgid "Maximum number of sequential B-frames (when set to 0, the original I/P encoder is used)"
-msgstr "Massimo numero di fotogrammi-B sequenziali (se impostato a 0, viene usato  il codificatore I/P originale)"
+msgstr "Massimo numero di fotogrammi-B sequenziali (se impostato a 0, viene usato il codificatore I/P originale)"
 
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:1013
 msgid "_Qpel"
@@ -4772,7 +4791,7 @@
 
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:1238
 msgid "Rate distortion quantization, will find optimal encoding for each block"
-msgstr "Quantizzatore tasso di distorsione, trova codifica ottimale per ogni blocco"
+msgstr "Quantizzatore del tasso di distorsione, trova codifica ottimale per ogni blocco"
 
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:1268
 msgid "I-frame boost (%):"
@@ -5013,7 +5032,7 @@
 
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_filters/gui_filtermanager_dialog.cpp:416
 msgid "External"
-msgstr "Esterne"
+msgstr "Esterni"
 
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_filters/gui_filtermanager_dialog.cpp:427
 msgid "Add selected filter to the Active Filters list"
@@ -5083,19 +5102,19 @@
 msgid "Save as script"
 msgstr "Salva come script"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_bindings.cpp:428
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_bindings.cpp:431
 msgid "Input"
 msgstr "Input"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_bindings.cpp:429
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_bindings.cpp:432
 msgid "Output"
 msgstr "Output"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_bindings.cpp:430
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_bindings.cpp:433
 msgid "Side"
 msgstr "Laterale"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_bindings.cpp:431
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_bindings.cpp:434
 #: avidemux/ADM_videoFilter/ADM_vidDecTelecide.cpp:90
 #: avidemux/ADM_videoFilter/ADM_vidDGbob.cpp:81
 #: avidemux/ADM_videoFilter/ADM_vidKernelDeint.cpp:87
@@ -5103,595 +5122,575 @@
 msgid "Top"
 msgstr "Alto"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_bindings.cpp:432
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_bindings.cpp:435
 msgid "Separate"
 msgstr "Separati"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_bindings.cpp:606
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_bindings.cpp:609
 #: avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/Q_gui2.cpp:499
 #, c-format
 msgid "Frame:%c(%02d)"
 msgstr "Fotogramma: %c(%02d)"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:284
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:289
 #: avidemux/main.cpp:202
 msgid "_File"
 msgstr "_File"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:291
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:296
 msgid "_Open..."
 msgstr "_Apri..."
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:302
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:307
 msgid "_Append..."
 msgstr "A_ggiungi"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:313
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:318
 msgid "_Save"
 msgstr "_Salva"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:324
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:329
 msgid "Save _Video..."
 msgstr "Salva _video..."
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:336
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:341
 msgid "Save _BMP Image..."
 msgstr "Salva immagine _BMP..."
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:340
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:345
 msgid "Save _JPEG Image..."
 msgstr "Salva immagine _JPEG..."
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:344
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:349
 msgid "Save _Selection as JPEG Images..."
 msgstr "Salva _selezione in immagini JPEG..."
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:357
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:362
 msgid "Save _Project"
 msgstr "Salva _progetto"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:365
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:370
 msgid "Save P_roject As..."
 msgstr "Salva p_rogetto come..."
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:373
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:378
 msgid "_Load/Run Project..."
 msgstr "Car_ica/esegui progetto..."
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:381
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:386
 msgid "A_dd to Joblist..."
 msgstr "Aggi_ungi alla lista attivit?"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:385
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:390
 msgid "Show _Joblist"
 msgstr "Mostra _lista attivit?"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:397
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:402
 msgid "Co_nnect to avsproxy"
 msgstr "Co_nnetti a avsproxy"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:406
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:411
 msgid "Proper_ties"
 msgstr "Proprie_t?"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:417
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:422
 msgid "AVI _Muxer Options"
 msgstr "Opzioni _Muxer AVI"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:426
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:431
 msgid "_Quit"
 msgstr "_Esci"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:437
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:442
 msgid "_Edit"
 msgstr "_Modifica"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:444
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:449
 msgid "_Reset Edits"
 msgstr "A_nnulla"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:457
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:462
 msgid "Cu_t"
 msgstr "_Taglia"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:468
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:473
 msgid "_Copy"
 msgstr "_Copia"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:479
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:484
 msgid "_Paste"
 msgstr "_Incolla"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:490
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:495
 msgid "_Delete"
 msgstr "_Elimina"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:506
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:511
 msgid "Set Marker _A"
 msgstr "Imposta segnalibro _A"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:513
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:518
 msgid "Set Marker _B"
 msgstr "Imposta segnalibro _B"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:525
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:530
 msgid "Pre_ferences"
 msgstr "_Preferenze"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:533
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:538
 msgid "_View"
 msgstr "_Visualizza"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:540
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:545
 msgid "_Main Toolbar"
 msgstr "_Barra degli strumenti"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:545
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:550
 msgid "_A/V Sidebar"
 msgstr "Barra laterale _A/V"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:555
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:560
 msgid "_Zoom 1:4"
 msgstr "_Zoom 1:4"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:562
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:567
 msgid "Z_oom 1:2"
 msgstr "Z_oom 1:2"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:569
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:574
 msgid "Zoom _1:1"
 msgstr "Zoom _1:1"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:576
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:581
 msgid "Zoom _2:1"
 msgstr "Zoom _2:1"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:583
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:588
 msgid "Zoom _4:1"
 msgstr "Zoom _4:1"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:590
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:595
 msgid "Vi_deo"
 msgstr "Vi_deo"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:597
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:602
 msgid "_Decoder Options"
 msgstr "_Opzioni codifica"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:604
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:609
 msgid "_Postprocessing"
 msgstr "_Postprocessing"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:607
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:612
 msgid "Select postprocessing level"
 msgstr "Seleziona livello di postprocessing"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:617
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:622
 msgid "P_review"
 msgstr "_Anteprima"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:624
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:629
 msgid "Display _Output"
 msgstr "_Esegui video in uscita"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:636
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:641
 msgid "_Frame Rate"
 msgstr "_Frame rate"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:640
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:689
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:645
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:694
 msgid "_Encoder"
 msgstr "_Decodificatore"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:647
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:652
 msgid "Fil_ters"
 msgstr "Fil_tri"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:654
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:659
 msgid "_Audio"
 msgstr "_Audio"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:661
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:666
 msgid "_Main Track"
 msgstr "_Traccia principale"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:665
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:670
 msgid "_Second Track"
-msgstr "Traccia _secondaria"
+msgstr "T_raccia secondaria"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:669
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:674
 msgid "_Build VBR Time Map"
 msgstr "_Crea VBR Time Map"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:678
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:683
 msgid "S_ave..."
 msgstr "_Salva..."
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:696
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:701
 msgid "_Filters"
 msgstr "_Filtri"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:700
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:705
 msgid "_Tools"
 msgstr "_Strumenti"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:707
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:712
 msgid "_Calculator"
 msgstr "_Calcola bitrate"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:723
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:728
 msgid "_Rebuild Frames (I & B)"
 msgstr "_Ricostruisci fotogrammi (I & B)"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:727
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:732
 msgid "C_heck Frames (slow)"
 msgstr "V_erifica fotogrammi (lento)"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:731
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:736
 msgid "_Bitrate Histogram"
 msgstr "Istogramma _bitrate"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:735
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:740
 msgid "_Scan for Black Frames..."
-msgstr "_Cerca fotogrammi neri..."
+msgstr "Cerca fotogrammi _neri..."
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:744
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:749
 msgid "_VOB -> VobSub"
 msgstr "_VOB -> VobSub"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:748
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:753
 msgid "_OCR (VobSub -> srt)"
 msgstr "_OCR (VobSub -> srt)"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:752
-msgid "Edit glyph"
-msgstr "Modifica glyph"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:757
+msgid "_Edit Glyph"
+msgstr "_Modifica glifo"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:761
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:766
 msgid "_Frame Hex Dump"
 msgstr "Hex Dump _fotogramma"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:765
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:770
 msgid "A_uto"
 msgstr "A_uto"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:772
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:777
 msgid "_VCD"
 msgstr "_VCD"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:776
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:781
 msgid "_SVCD"
 msgstr "_SVCD"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:780
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:785
 msgid "_DVD"
 msgstr "_DVD"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:784
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:789
 msgid "_PSP"
 msgstr "_PSP"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:788
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:793
 msgid "PSP (_H.264)"
 msgstr "PSP (_H.264)"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:792
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:797
 msgid "_Go"
 msgstr "_Vai"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:799
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:804
 msgid "_Play/Stop"
 msgstr "_Play/Stop"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:810
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:815
 msgid "P_revious Frame"
 msgstr "Fotogramma p_recedente"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:821
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:826
 msgid "_Next Frame"
 msgstr "Fotogramma _successivo"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:832
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:837
 msgid "Pr_evious Intra Frame"
 msgstr "Fotogramma chiave pr_ecedente"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:843
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:848
 msgid "Next _Intra Frame"
 msgstr "Fotogramma ch_iave successivo"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:854
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:859
 msgid "Previou_s Black Frame"
 msgstr "Fotogramma nero pre_cedente"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:858
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:863
 msgid "Ne_xt Black Frame"
-msgstr "Fotogramma nero s_uccessivo"
+msgstr "Fotogramma nero successi_vo"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:862
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:867
 msgid "_First Frame"
 msgstr "Primo _fotogramma"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:873
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:878
 msgid "_Last Frame"
 msgstr "_Ultimo fotogramma"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:889
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:894
 msgid "Go to Marker _A"
 msgstr "Vai al segnalibro _A"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:896
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:901
 msgid "Go to Marker _B"
 msgstr "Vai al segnalibro _B"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:908
-msgid "_Jump to Frame..."
-msgstr "_Vai al fotogramma..."
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:913
+msgid "Go to Fra_me..."
+msgstr "Vai al fotogra_mma..."
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:919
-msgid "Jump to _Time..."
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:924
+msgid "Go to _Time..."
 msgstr "Vai al _tempo..."
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:930
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:935
 msgid "_Custom"
 msgstr "_Preferiti"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:934
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:939
 msgid "_Help"
-msgstr "_Aiuto"
+msgstr "A_iuto"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:941
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:946
 msgid "_Built-in Support"
-msgstr "Supporto _incorporato"
+msgstr "_Supporto incorporato"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:945
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:950
 msgid "_About"
 msgstr "_Informazioni"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:963
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:968
 msgid "Open a file"
 msgstr "Apri un file"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:973
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:978
 msgid "Save the file"
 msgstr "Salva il file"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:979
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:984
 msgid "Audio/video file information"
 msgstr "Informazioni audio/video del file"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:990
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:995
 msgid "Bitrate/size calculator"
 msgstr "Calcola bitrate/dimensione"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1044
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1084
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1074
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1114
 msgid "Copy"
 msgstr "Copia"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1049
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1079
 msgid "Configure video encoder"
 msgstr "Configura codificatore video"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1054
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1110
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1084
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1140
 msgid "Filters"
 msgstr "Filtri"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1057
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1087
 msgid "Video filters"
 msgstr "Filtri video"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1089
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1119
 msgid "Configure audio encoder"
 msgstr "Configura codificatore audio"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1097
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1127
 msgid "Audio filters"
 msgstr "Filtri audio"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1118
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1148
 msgid "Shift:"
 msgstr "Ritardo:"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1121
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1151
 msgid "Enable time shift"
 msgstr "Attiva ritardo audio"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1127
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1157
 msgid "Audio/video time shift (ms)"
 msgstr "Ritardo audio/video (ms)"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1134
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1164
 msgid "<b>Format</b>"
 msgstr "<b>Formato</b>"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1167
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1197
 msgid "<b>Selection</b>"
 msgstr "<b>Seleziona</b>"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1184
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1192
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1214
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1222
 msgid " 0000000"
 msgstr " 0000000"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1200
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1230
 msgid "A:"
 msgstr "A:"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1207
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1237
 msgid "Go to marker A"
 msgstr "Vai al segnalibro A"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1209
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1239
 msgid "B:"
 msgstr "B:"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1216
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1246
 msgid "Go to marker B"
 msgstr "Vai al segnalibro B"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1228
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1258
 msgid "Play"
 msgstr "Play"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1242
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1272
 msgid "Stop"
 msgstr "Stop"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1254
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1284
 msgid "Previous frame"
 msgstr "Fotogramma precedente"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1269
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1299
 msgid "Next frame"
 msgstr "Fotogramma successivo"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1284
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1314
 msgid "Previous keyframe"
 msgstr "Fotogramma chiave precedente"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1299
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1329
 msgid "Next keyframe"
 msgstr "Fotogramma chiave successivo"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1313
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1343
 msgid "Selection: start"
 msgstr "Selezione: inizio"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1324
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1354
 msgid "Selection: end"
 msgstr "Selezione: fine"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1335
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1365
 msgid "Previous black frame"
 msgstr "Fotogramma nero precedente"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1346
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1376
 msgid "Next black frame"
 msgstr "Fotogramma nero successivo"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1357
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1387
 msgid "First frame"
-msgstr "Primo fotogramm"
+msgstr "Primo fotogramma"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1368
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1398
 msgid "Last frame"
-msgstr "Ultimo fotogramm"
+msgstr "Ultimo fotogramma"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1390
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1420
 msgid "Frame: "
 msgstr "Fotogramma:"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1397
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1427
 msgid "Current frame"
 msgstr "Fotogramma attuale:"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1402
-msgid "/0000000"
-msgstr "/0000000"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1432
+msgid "/ 0000000"
+msgstr "/ 0000000"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1409
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1439
 msgid "Time: "
 msgstr "Tempo:"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1416
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1446
 msgid "Current time"
 msgstr "Tempo attuale"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1417
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1447
 msgid "00:00:00.000"
 msgstr "00:00:00.000"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1420
-msgid "/00:00:00,000"
-msgstr "/00:00:00,000"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1450
+msgid "/ 00:00:00,000"
+msgstr "/ 00:00:00,000"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1427
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1457
 msgid "Frame: ?"
-msgstr "Fotogramm: ?"
+msgstr "Fotogramma: ?"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_ocr/adm_editglyph.cpp:55
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_ocr/adm_editglyph.cpp:53
 msgid "Select GlyphFile to edit"
-msgstr "Seleziona il file Glyph da modificare"
+msgstr "Seleziona il file glifo da modificare"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_ocr/adm_editglyph.cpp:123
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_ocr/adm_editglyph.cpp:121
 msgid "String"
 msgstr "String"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_ocr/adm_editglyph.cpp:125
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_ocr/adm_editglyph.cpp:123
 msgid "Search string"
 msgstr "Ricerca stringa"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_ocr/adm_editglyph.cpp:151
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_ocr/adm_editglyph.cpp:194
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_ocr/adm_editglyph.cpp:149
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_ocr/adm_editglyph.cpp:192
 msgid "End reached"
 msgstr "Fine raggiunta"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_ocr/adm_editglyph.cpp:151
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_ocr/adm_editglyph.cpp:194
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_ocr/adm_editglyph.cpp:218
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_ocr/adm_editglyph.cpp:149
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_ocr/adm_editglyph.cpp:192
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_ocr/adm_editglyph.cpp:216
 msgid "No more glyphs"
-msgstr "Nessun altro glyph"
+msgstr "Nessun altro glifo"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_ocr/adm_editglyph.cpp:218
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_ocr/adm_editglyph.cpp:216
 msgid "Head reached"
 msgstr "Testa raggiunta"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_ocr/adm_editglyph.cpp:427
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_ocr/adm_editglyph.cpp:344
 msgid "dialog1"
 msgstr "dialog1"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_ocr/adm_editglyph.cpp:479
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_ocr/adm_editglyph.cpp:396
 msgid "Prev. Empty"
 msgstr "Vuoto precedente"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_ocr/adm_editglyph.cpp:501
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_ocr/adm_editglyph.cpp:418
 msgid "Next Empty"
 msgstr "Vuoto successivo"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_ocr/adm_ocr.cpp:209
-#: avidemux/ADM_userInterfaces/ADM_GTK/adm_ocr.cpp:209
-msgid "Incorrect output file"
-msgstr "File di usceita non corretto"
-
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_ocr/adm_ocr.cpp:215
-#: avidemux/ADM_userInterfaces/ADM_GTK/adm_ocr.cpp:215
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_ocr/adm_ocr.cpp:180
 msgid "Output file error"
 msgstr "Errore file di uscita"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_ocr/adm_ocr.cpp:215
-#: avidemux/ADM_userInterfaces/ADM_GTK/adm_ocr.cpp:215
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_ocr/adm_ocr.cpp:180
 #, c-format
 msgid "Could not open \"%s\" for writing."
 msgstr "Impossibile aprire \"%s\" per la scrittura."
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_ocr/adm_ocr.cpp:224
-#: avidemux/ADM_userInterfaces/ADM_GTK/adm_ocr.cpp:224
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_ocr/adm_ocr.cpp:189
 msgid "Problem loading sub"
 msgstr "Problema di caricamento sottotitoli"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_ocr/adm_ocr.cpp:589
-#: avidemux/ADM_userInterfaces/ADM_GTK/adm_ocr.cpp:589
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_ocr/adm_ocr.cpp:295
+msgid "Select Glyphfile to save to"
+msgstr "Seleziona il file glifo in cui salvare"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_ocr/adm_ocr.cpp:362
 msgid "Sure ?"
 msgstr "Sicuro?"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_ocr/adm_ocr.cpp:752
-#: avidemux/ADM_userInterfaces/ADM_GTK/adm_ocr.cpp:752
-msgid "Select SRT to save"
-msgstr "Seleziona SRT da salvare"
-
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_ocr/adm_ocr.cpp:764
-#: avidemux/ADM_userInterfaces/ADM_GTK/adm_ocr.cpp:764
-msgid "Select Glyoh to save"
-msgstr "Seleziona Glyph da salvare"
-
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_ocr/adm_ocr.cpp:778
-#: avidemux/ADM_userInterfaces/ADM_GTK/adm_ocr.cpp:778
-msgid "No glyphs to save"
-msgstr "Nessun glyph da salvare"
-
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_toolkit_gtk/ADM_gladeSupport.cpp:251
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_toolkit_gtk/ADM_gladeSupport.cpp:275
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_toolkit_gtk/ADM_gladeSupport.cpp:252
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_toolkit_gtk/ADM_gladeSupport.cpp:276
 #, c-format
 msgid "Couldn't find pixmap file: %s"
 msgstr "Impossibile trovare il file pixmap: %s"
@@ -5703,7 +5702,7 @@
 msgstr "Impossibile aprire la cartella come un file"
 
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_toolkit_gtk/TLK_filesel.cpp:335
-#: avidemux/gtk_gui.cpp:890
+#: avidemux/gtk_gui.cpp:892
 #, c-format
 msgid "Cannot open \"%s\"."
 msgstr "Impossibile aprire \"%s\"."
@@ -5898,7 +5897,7 @@
 
 #: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_xvid4.cpp:91
 msgid "More Search"
-msgstr "Ricerca ancora"
+msgstr "Ricerca ulteriore"
 
 #: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_xvid4.cpp:96
 msgid "Min Gop Size"
@@ -6064,23 +6063,23 @@
 msgid "_Autolevel"
 msgstr "Livello _automatico"
 
-#: avidemux/ADM_videoFilter/ADM_vidASS.cpp:85
+#: avidemux/ADM_videoFilter/ADM_vidASS.cpp:87
 msgid "_Subtitle file (ASS/SSA):"
 msgstr "File _sottotitoli (ASS/SSA):"
 
-#: avidemux/ADM_videoFilter/ADM_vidASS.cpp:86
+#: avidemux/ADM_videoFilter/ADM_vidASS.cpp:88
 msgid "_Line spacing:"
 msgstr "Inter_linea:"
 
-#: avidemux/ADM_videoFilter/ADM_vidASS.cpp:87
+#: avidemux/ADM_videoFilter/ADM_vidASS.cpp:89
 msgid "_Font scale:"
 msgstr "Dimensione _carattere:"
 
-#: avidemux/ADM_videoFilter/ADM_vidASS.cpp:88
+#: avidemux/ADM_videoFilter/ADM_vidASS.cpp:90
 msgid "_Top margin:"
 msgstr "Margine _superiore:"
 
-#: avidemux/ADM_videoFilter/ADM_vidASS.cpp:89
+#: avidemux/ADM_videoFilter/ADM_vidASS.cpp:91
 msgid "Botto_m margin"
 msgstr "_Margine inferiore"
 
@@ -6527,27 +6526,27 @@
 msgid "_Order:"
 msgstr "_Ordine:"
 
-#: avidemux/gtk_gui.cpp:251
+#: avidemux/gtk_gui.cpp:253
 msgid "Select ECMAScript to Run"
 msgstr "Seleziona un ECMAScript da eseguire"
 
-#: avidemux/gtk_gui.cpp:298
-#: avidemux/gtk_gui.cpp:337
+#: avidemux/gtk_gui.cpp:300
+#: avidemux/gtk_gui.cpp:339
 msgid "Obsolete"
 msgstr "Obsoleto"
 
-#: avidemux/gtk_gui.cpp:365
+#: avidemux/gtk_gui.cpp:367
 msgid "Not coded in this version"
 msgstr "Non codificato in questa versione"
 
-#: avidemux/gtk_gui.cpp:380
-#: avidemux/gtk_gui.cpp:385
-#: avidemux/gtk_gui.cpp:504
-#: avidemux/gtk_gui.cpp:507
+#: avidemux/gtk_gui.cpp:382
+#: avidemux/gtk_gui.cpp:387
+#: avidemux/gtk_gui.cpp:506
+#: avidemux/gtk_gui.cpp:509
 msgid "Select AVI File..."
 msgstr "Seleziona un file AVI..."
 
-#: avidemux/gtk_gui.cpp:440
+#: avidemux/gtk_gui.cpp:442
 msgid ""
 "This is to be used to undo packed VOP on MPEG-4.\n"
 "Continue ?"
@@ -6555,127 +6554,127 @@
 "Questo deve essere usato per decomprimere il VOP su MPEG-4.\n"
 "Continuare?"
 
-#: avidemux/gtk_gui.cpp:442
+#: avidemux/gtk_gui.cpp:444
 msgid "Select AVI File to Write"
 msgstr "Seleziona il file AVI da scrivere"
 
-#: avidemux/gtk_gui.cpp:448
+#: avidemux/gtk_gui.cpp:450
 msgid "Select OGM File to Write"
 msgstr "Seleziona il file OGM da scrivere"
 
-#: avidemux/gtk_gui.cpp:459
-#: avidemux/gtk_gui.cpp:470
+#: avidemux/gtk_gui.cpp:461
+#: avidemux/gtk_gui.cpp:472
 msgid "Select Workbench to Save"
 msgstr "Seleziona il Tavolo da lavoro da salvare"
 
-#: avidemux/gtk_gui.cpp:494
+#: avidemux/gtk_gui.cpp:496
 msgid "Select Raw File to Save"
 msgstr "Seleziona il file grezzo da salvare"
 
-#: avidemux/gtk_gui.cpp:510
+#: avidemux/gtk_gui.cpp:512
 msgid "Select AVI File to Append..."
 msgstr "Seleziona il file AVI da aggiungere..."
 
-#: avidemux/gtk_gui.cpp:514
+#: avidemux/gtk_gui.cpp:516
 msgid "Select File to Save Audio"
 msgstr "Seleziona il file audio da salvare"
 
-#: avidemux/gtk_gui.cpp:548
+#: avidemux/gtk_gui.cpp:550
 msgid "Select JPEG Sequence to Save"
 msgstr "Seleziona la sequenza JPEG da salvare"
 
-#: avidemux/gtk_gui.cpp:551
+#: avidemux/gtk_gui.cpp:553
 msgid "Select BMP to Save"
 msgstr "Seleziona il file BMP da salvare"
 
-#: avidemux/gtk_gui.cpp:555
+#: avidemux/gtk_gui.cpp:557
 msgid "Select JPEG to Save"
 msgstr "Seleziona il file JPEG da salvare"
 
-#: avidemux/gtk_gui.cpp:608
-#: avidemux/gtk_gui.cpp:712
+#: avidemux/gtk_gui.cpp:610
+#: avidemux/gtk_gui.cpp:714
 msgid "Select File to Save"
 msgstr "Seleziona il file da salvare"
 
-#: avidemux/gtk_gui.cpp:652
+#: avidemux/gtk_gui.cpp:654
 msgid "Select MP3 to Load"
 msgstr "Seleziona il file MP3 da caricare"
 
-#: avidemux/gtk_gui.cpp:655
+#: avidemux/gtk_gui.cpp:657
 msgid "Select AC3 to Load"
 msgstr "Seleziona il file AC3 da caricare"
 
-#: avidemux/gtk_gui.cpp:658
+#: avidemux/gtk_gui.cpp:660
 msgid "Select WAV to Load"
 msgstr "Seleziona il file WAV da caricare"
 
-#: avidemux/gtk_gui.cpp:706
+#: avidemux/gtk_gui.cpp:708
 msgid "Out of bounds"
 msgstr "Oltre i limiti"
 
-#: avidemux/gtk_gui.cpp:717
-#: avidemux/gtk_gui.cpp:1908
+#: avidemux/gtk_gui.cpp:719
+#: avidemux/gtk_gui.cpp:1910
 msgid "Marker A > B"
 msgstr "Segnalibro A > B"
 
-#: avidemux/gtk_gui.cpp:717
+#: avidemux/gtk_gui.cpp:719
 msgid "Cannot copy."
 msgstr "Impossibile copiare."
 
-#: avidemux/gtk_gui.cpp:729
+#: avidemux/gtk_gui.cpp:731
 msgid "Something bad happened (II))"
 msgstr "C'? stato qualche errore (II)"
 
-#: avidemux/gtk_gui.cpp:743
+#: avidemux/gtk_gui.cpp:745
 msgid "Are you sure?"
 msgstr "Sei sicuro?"
 
-#: avidemux/gtk_gui.cpp:798
+#: avidemux/gtk_gui.cpp:800
 msgid "Frame Rate"
 msgstr "Frame rate"
 
-#: avidemux/gtk_gui.cpp:798
+#: avidemux/gtk_gui.cpp:800
 msgid "_Frames per second:"
 msgstr "_Fotogrammi al secondo:"
 
-#: avidemux/gtk_gui.cpp:821
+#: avidemux/gtk_gui.cpp:823
 msgid "Width is not a multiple of 8"
 msgstr "La larghezza non ? un multiplo di 8"
 
-#: avidemux/gtk_gui.cpp:822
+#: avidemux/gtk_gui.cpp:824
 msgid "This will make trouble for AVI files."
 msgstr "Questo causer? un problema per i file AVI."
 
-#: avidemux/gtk_gui.cpp:832
+#: avidemux/gtk_gui.cpp:834
 msgid "Rebuild all Keyframes?"
 msgstr "Ricostruire tutti i fotogrammi chiave?"
 
-#: avidemux/gtk_gui.cpp:890
+#: avidemux/gtk_gui.cpp:892
 msgid "Permission error"
 msgstr "Errore di permesso"
 
-#: avidemux/gtk_gui.cpp:893
+#: avidemux/gtk_gui.cpp:895
 #, c-format
 msgid "\"%s\" does not exist."
 msgstr "\"%s\" non esiste."
 
-#: avidemux/gtk_gui.cpp:935
+#: avidemux/gtk_gui.cpp:937
 msgid "Cannot open project using the video loader."
 msgstr "Impossibile aprire il progetto usando il caricatore video."
 
-#: avidemux/gtk_gui.cpp:936
+#: avidemux/gtk_gui.cpp:938
 msgid "Try 'File' -> 'Load/Run Project...'"
 msgstr "Prova 'File' -> 'Carica/esegui progetto...'"
 
-#: avidemux/gtk_gui.cpp:938
+#: avidemux/gtk_gui.cpp:940
 msgid "Could not open the file"
 msgstr "Impossibile aprire il file"
 
-#: avidemux/gtk_gui.cpp:973
+#: avidemux/gtk_gui.cpp:975
 msgid "Multiple Audio Tracks"
 msgstr "Tracce audio multiple"
 
-#: avidemux/gtk_gui.cpp:973
+#: avidemux/gtk_gui.cpp:975
 msgid ""
 "The file you just loaded contains several audio tracks.\n"
 "Go to Audio->MainTrack to select the active one."
@@ -6683,281 +6682,281 @@
 "Il file appena caricato contiene diverse tracce audio.\n"
 "Vai a 'Audio' -> 'Traccia principale' per selezionare la traccia attiva."
 
-#: avidemux/gtk_gui.cpp:1063
+#: avidemux/gtk_gui.cpp:1065
 msgid "No audio decoder found for this file"
 msgstr "Nessun decodificatore trovato per questo file"
 
-#: avidemux/gtk_gui.cpp:1064
+#: avidemux/gtk_gui.cpp:1066
 msgid "Save (A+V) will generate bad AVI. Save audio will work."
 msgstr "Salvare (A+V) generer? un file AVI difettoso. Salvare l'audio funzioner?."
 
-#: avidemux/gtk_gui.cpp:1120
+#: avidemux/gtk_gui.cpp:1122
 msgid "Something failed when appending"
 msgstr "Qualcosa ? fallito nell'esecuzione"
 
-#: avidemux/gtk_gui.cpp:1129
-#: avidemux/gtk_gui.cpp:1927
+#: avidemux/gtk_gui.cpp:1131
+#: avidemux/gtk_gui.cpp:1929
 msgid "Something bad happened (II)"
 msgstr "C'? stato qualche errore (II)"
 
-#: avidemux/gtk_gui.cpp:1193
+#: avidemux/gtk_gui.cpp:1195
 msgid "Cannot save the audio in copy mode"
 msgstr "Impossibile salvare l'audio in modalit? copia"
 
-#: avidemux/gtk_gui.cpp:1193
+#: avidemux/gtk_gui.cpp:1195
 msgid "Select WAV PCM as the audio codec, otherwise the audio file would be raw PCM."
 msgstr "Seleziona il codec audio WAV PCM, altrimenti il file audio sar? PCM grezzo."
 
-#: avidemux/gtk_gui.cpp:1201
-#: avidemux/gtk_gui.cpp:1557
+#: avidemux/gtk_gui.cpp:1203
+#: avidemux/gtk_gui.cpp:1559
 msgid "Saving audio"
 msgstr "Salvataggio audio in corso"
 
-#: avidemux/gtk_gui.cpp:1278
+#: avidemux/gtk_gui.cpp:1280
 msgid "Get Frame"
 msgstr "Prendi fotogramma"
 
-#: avidemux/gtk_gui.cpp:1278
+#: avidemux/gtk_gui.cpp:1280
 msgid "Cannot get this frame to save"
 msgstr "Impossibile salvare questo fotogramma"
 
-#: avidemux/gtk_gui.cpp:1315
+#: avidemux/gtk_gui.cpp:1317
 msgid "Mark A > B"
 msgstr "Segnalibro A > B"
 
-#: avidemux/gtk_gui.cpp:1315
+#: avidemux/gtk_gui.cpp:1317
 msgid "Set your markers correctly."
 msgstr "Imposta i tuoi segnalibri correttamente."
 
-#: avidemux/gtk_gui.cpp:1324
+#: avidemux/gtk_gui.cpp:1326
 msgid "Saving as set of jpegs"
 msgstr "Salvataggio come gruppo di jpeg in corso"
 
-#: avidemux/gtk_gui.cpp:1330
+#: avidemux/gtk_gui.cpp:1332
 msgid "Cannot decode frame"
 msgstr "Impossibile decodificare il fotogramma"
 
-#: avidemux/gtk_gui.cpp:1330
+#: avidemux/gtk_gui.cpp:1332
 msgid "Aborting."
 msgstr "Annullamento in corso."
 
-#: avidemux/gtk_gui.cpp:1341
-#: avidemux/gtk_gui.cpp:1360
-#: avidemux/gtk_gui.cpp:2271
+#: avidemux/gtk_gui.cpp:1343
+#: avidemux/gtk_gui.cpp:1362
+#: avidemux/gtk_gui.cpp:2273
 msgid "Done"
 msgstr "Fatto"
 
-#: avidemux/gtk_gui.cpp:1341
+#: avidemux/gtk_gui.cpp:1343
 #, c-format
 msgid "Saved %d images."
 msgstr "%d immagini salvate."
 
-#: avidemux/gtk_gui.cpp:1343
+#: avidemux/gtk_gui.cpp:1345
 msgid "Error"
 msgstr "Errore"
 
-#: avidemux/gtk_gui.cpp:1343
+#: avidemux/gtk_gui.cpp:1345
 msgid "Could not save all images."
 msgstr "Impossibile salvare tutte le immagini."
 
-#: avidemux/gtk_gui.cpp:1360
+#: avidemux/gtk_gui.cpp:1362
 #, c-format
 msgid "Saved \"%s\"."
 msgstr "\"%s\" salvato."
 
-#: avidemux/gtk_gui.cpp:1362
+#: avidemux/gtk_gui.cpp:1364
 msgid "BMP op failed"
 msgstr "Op. BMP fallita"
 
-#: avidemux/gtk_gui.cpp:1362
+#: avidemux/gtk_gui.cpp:1364
 #, c-format
 msgid "Saving %s as a BMP file failed."
 msgstr "Salvataggio di %s come file BMP fallito."
 
-#: avidemux/gtk_gui.cpp:1382
-#: avidemux/gtk_gui.cpp:1448
+#: avidemux/gtk_gui.cpp:1384
+#: avidemux/gtk_gui.cpp:1450
 msgid "Failed to open the file"
 msgstr "L'apertura del file ? fallita"
 
-#: avidemux/gtk_gui.cpp:1382
-#: avidemux/gtk_gui.cpp:1448
+#: avidemux/gtk_gui.cpp:1384
+#: avidemux/gtk_gui.cpp:1450
 msgid "Not a WAV file?"
 msgstr "Non ? un file WAV?"
 
-#: avidemux/gtk_gui.cpp:1383
+#: avidemux/gtk_gui.cpp:1385
 #, c-format
 msgid "WAV open file failed..."
 msgstr "L'apertura del file WAV ? fallita"
 
-#: avidemux/gtk_gui.cpp:1518
+#: avidemux/gtk_gui.cpp:1520
 msgid "Cannot decompress audio frame"
 msgstr "Impossibile decomprimere il segmento audio"
 
-#: avidemux/gtk_gui.cpp:1532
+#: avidemux/gtk_gui.cpp:1534
 msgid "Memory Error"
 msgstr "Errore di memoria"
 
-#: avidemux/gtk_gui.cpp:1578
+#: avidemux/gtk_gui.cpp:1580
 msgid "No frames to encode"
 msgstr "Nessun fotogramma da codificare"
 
-#: avidemux/gtk_gui.cpp:1578
+#: avidemux/gtk_gui.cpp:1580
 msgid "Please check markers. Is \"A>\" == \">B\"?"
 msgstr "Controlla i segnalibri. ? \"A>\" == \">B\"?"
 
-#: avidemux/gtk_gui.cpp:1697
+#: avidemux/gtk_gui.cpp:1699
 msgid "Saving raw video stream"
 msgstr "Salvataggio flusso video grezzo in corso"
 
-#: avidemux/gtk_gui.cpp:1843
+#: avidemux/gtk_gui.cpp:1845
 msgid "Checking video"
 msgstr "Verifica video in corso"
 
-#: avidemux/gtk_gui.cpp:1859
+#: avidemux/gtk_gui.cpp:1861
 msgid "No error found"
 msgstr "Nessun errore trovato"
 
-#: avidemux/gtk_gui.cpp:1863
+#: avidemux/gtk_gui.cpp:1865
 #, c-format
 msgid "Errors found in %u frames"
 msgstr "Errore trovato nel fotogramma %u"
 
-#: avidemux/gtk_gui.cpp:1881
+#: avidemux/gtk_gui.cpp:1883
 msgid "Cannot decompress the audio stream"
 msgstr "Impossibile decomprimere il flusso audio"
 
-#: avidemux/gtk_gui.cpp:1881
+#: avidemux/gtk_gui.cpp:1883
 msgid "Switch audio codec to Copy."
 msgstr "Sposta la codifica audio su Copia."
 
-#: avidemux/gtk_gui.cpp:1908
+#: avidemux/gtk_gui.cpp:1910
 msgid "Cannot delete the selection."
 msgstr "Impossibile eliminare la selezione."
 
-#: avidemux/gtk_gui.cpp:1913
+#: avidemux/gtk_gui.cpp:1915
 msgid "You can't remove all frames"
 msgstr "Non puoi rimuovere tutti i fotogrammi."
 
-#: avidemux/gtk_gui.cpp:1989
+#: avidemux/gtk_gui.cpp:1991
 msgid "Could not get tracks info"
 msgstr "Impossibile ottenere informazioni sulla traccia"
 
-#: avidemux/gtk_gui.cpp:1997
+#: avidemux/gtk_gui.cpp:1999
 msgid "Video"
 msgstr "Video"
 
-#: avidemux/gtk_gui.cpp:1997
+#: avidemux/gtk_gui.cpp:1999
 msgid "Take audio from video file"
 msgstr "Recupera audio dal file video"
 
-#: avidemux/gtk_gui.cpp:1998
-#: avidemux/gtk_gui.cpp:2097
+#: avidemux/gtk_gui.cpp:2000
+#: avidemux/gtk_gui.cpp:2099
 msgid "No audio"
 msgstr "Nessuna traccia audio"
 
-#: avidemux/gtk_gui.cpp:1999
-#: avidemux/gtk_gui.cpp:2098
+#: avidemux/gtk_gui.cpp:2001
+#: avidemux/gtk_gui.cpp:2100
 msgid "External AC3"
 msgstr "AC3 esterno"
 
-#: avidemux/gtk_gui.cpp:1999
-#: avidemux/gtk_gui.cpp:2098
+#: avidemux/gtk_gui.cpp:2001
+#: avidemux/gtk_gui.cpp:2100
 msgid "Take audio from external AC3 file"
 msgstr "Prendi l'audio da un file AC3 esterno"
 
-#: avidemux/gtk_gui.cpp:2000
-#: avidemux/gtk_gui.cpp:2099
+#: avidemux/gtk_gui.cpp:2002
+#: avidemux/gtk_gui.cpp:2101
 msgid "External MP3"
 msgstr "MP3 esterno"
 
-#: avidemux/gtk_gui.cpp:2000
-#: avidemux/gtk_gui.cpp:2099
+#: avidemux/gtk_gui.cpp:2002
+#: avidemux/gtk_gui.cpp:2101
 msgid "Take audio from external MP3 file"
 msgstr "Prendi l'audio da un file MP3 esterno"
 
-#: avidemux/gtk_gui.cpp:2001
-#: avidemux/gtk_gui.cpp:2100
+#: avidemux/gtk_gui.cpp:2003
+#: avidemux/gtk_gui.cpp:2102
 msgid "External WAV"
 msgstr "WAV esterno"
 
-#: avidemux/gtk_gui.cpp:2001
-#: avidemux/gtk_gui.cpp:2100
+#: avidemux/gtk_gui.cpp:2003
+#: avidemux/gtk_gui.cpp:2102
 msgid "Take audio from external WAV file"
 msgstr "Prendi l'audio da un file WAV esterno"
 
-#: avidemux/gtk_gui.cpp:2005
-#: avidemux/gtk_gui.cpp:2105
+#: avidemux/gtk_gui.cpp:2007
+#: avidemux/gtk_gui.cpp:2107
 msgid "_Audio source:"
 msgstr "Sorgente _audio:"
 
-#: avidemux/gtk_gui.cpp:2009
-#: avidemux/gtk_gui.cpp:2106
+#: avidemux/gtk_gui.cpp:2011
+#: avidemux/gtk_gui.cpp:2108
 msgid "_External file:"
 msgstr "File _esterno:"
 
-#: avidemux/gtk_gui.cpp:2024
+#: avidemux/gtk_gui.cpp:2026
 msgid "_Track from video:"
 msgstr "_Traccia dal video:"
 
-#: avidemux/gtk_gui.cpp:2034
+#: avidemux/gtk_gui.cpp:2036
 msgid "Main Audio Track"
 msgstr "Traccia audio principale"
 
-#: avidemux/gtk_gui.cpp:2040
-#: avidemux/gtk_gui.cpp:2118
+#: avidemux/gtk_gui.cpp:2042
+#: avidemux/gtk_gui.cpp:2120
 msgid "Cannot load"
 msgstr "Impossibile caricare"
 
-#: avidemux/gtk_gui.cpp:2040
-#: avidemux/gtk_gui.cpp:2118
+#: avidemux/gtk_gui.cpp:2042
+#: avidemux/gtk_gui.cpp:2120
 msgid "The selected audio file does not exist."
 msgstr "Il file audio selezionato non esiste."
 
-#: avidemux/gtk_gui.cpp:2115
+#: avidemux/gtk_gui.cpp:2117
 msgid "Second Audio Track"
 msgstr "Traccia audio secondaria"
 
-#: avidemux/gtk_gui.cpp:2147
+#: avidemux/gtk_gui.cpp:2149
 msgid "Error loading the MP3 file"
 msgstr "Errore nel caricamento del file MP3"
 
-#: avidemux/gtk_gui.cpp:2156
-#: avidemux/gtk_gui.cpp:2178
-#: avidemux/gtk_gui.cpp:2200
+#: avidemux/gtk_gui.cpp:2158
+#: avidemux/gtk_gui.cpp:2180
+#: avidemux/gtk_gui.cpp:2202
 msgid "Second track loaded"
 msgstr "Seconda traccia caricata"
 
-#: avidemux/gtk_gui.cpp:2170
+#: avidemux/gtk_gui.cpp:2172
 msgid "Error loading the AC3 file"
 msgstr "Errore nel caricamento del file AC3"
 
-#: avidemux/gtk_gui.cpp:2192
+#: avidemux/gtk_gui.cpp:2194
 msgid "Error loading the WAV file"
 msgstr "Errore nel caricamento del file WAV"
 
-#: avidemux/gtk_gui.cpp:2259
+#: avidemux/gtk_gui.cpp:2261
 msgid "Saving failed"
 msgstr "Salvataggio fallito"
 
-#: avidemux/gtk_gui.cpp:2259
+#: avidemux/gtk_gui.cpp:2261
 msgid "Saving the job failed. Maybe you have permission issue with ~/.avidemux"
 msgstr "Il salvataggio dell'attivit? ? fallito. Forse c'? un problema di permesso con ~/.avidemux"
 
-#: avidemux/gtk_gui.cpp:2271
+#: avidemux/gtk_gui.cpp:2273
 #, c-format
 msgid "File %s has been successfully saved."
 msgstr "Il file %s ? stato salvato con successo."
 
-#: avidemux/gtk_gui.cpp:2275
+#: avidemux/gtk_gui.cpp:2277
 #, c-format
 msgid "File %s was NOT saved correctly."
 msgstr "Il file %s non ? stato salvato correttamente."
 
-#: avidemux/gtk_gui.cpp:2429
+#: avidemux/gtk_gui.cpp:2431
 msgid "AvsProxy"
 msgstr "AvsProxy"
 
-#: avidemux/gtk_gui.cpp:2429
+#: avidemux/gtk_gui.cpp:2431
 msgid ""
 "Failed to connect to avsproxy.\n"
 "Is it running ?"
@@ -6965,21 +6964,21 @@
 "Connessione a avsproxy fallita.\n"
 "? in esecuzione?"
 
-#: avidemux/gtk_gui.cpp:2434
+#: avidemux/gtk_gui.cpp:2436
 msgid "avsproxy"
 msgstr "avsproxy"
 
-#: avidemux/gtk_gui.cpp:2462
+#: avidemux/gtk_gui.cpp:2464
 msgid "Frame type:"
 msgstr "Tipo di fotogramma:"
 
-#: avidemux/gtk_gui.cpp:2463
+#: avidemux/gtk_gui.cpp:2465
 msgid "Frame size:"
 msgstr "Dimensione fotogramma:"
 
-#: avidemux/gtk_gui.cpp:2465
+#: avidemux/gtk_gui.cpp:2467
 msgid "Frame Hex Dump"
-msgstr "Hex Dump _fotogramma"
+msgstr "Hex Dump fotogramma"
 
 #: avidemux/guiplay.cpp:365
 msgid "Trouble initializing audio device"

Modified: branches/avidemux_2.4_branch/po/ja.po
===================================================================
--- branches/avidemux_2.4_branch/po/ja.po	2007-07-22 17:23:52 UTC (rev 3433)
+++ branches/avidemux_2.4_branch/po/ja.po	2007-07-22 17:44:51 UTC (rev 3434)
@@ -7,8 +7,8 @@
 msgstr ""
 "Project-Id-Version: ja\n"
 "Report-Msgid-Bugs-To: \n"
-"POT-Creation-Date: 2007-06-27 22:39+0100\n"
-"PO-Revision-Date: 2007-07-02 16:53+0900\n"
+"POT-Creation-Date: 2007-07-18 13:22+0100\n"
+"PO-Revision-Date: 2007-07-19 23:56+0900\n"
 "Last-Translator: tetsuro\n"
 "Language-Team: Japan\n"
 "MIME-Version: 1.0\n"
@@ -43,7 +43,7 @@
 
 #: avidemux/ADM_audiofilter/audioencoder_lame.cpp:215
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_audioFilter.cpp:104
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:223
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:236
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_properties.cpp:110
 #: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_props.cpp:101
 #, c-format
@@ -129,15 +129,15 @@
 msgid "Internal error finding codec"
 msgstr "??????????????"
 
-#: avidemux/ADM_codecs/ADM_ffmpeg.cpp:51
+#: avidemux/ADM_codecs/ADM_ffmpeg.cpp:53
 msgid "Internal error opening codec"
 msgstr "???????????????"
 
-#: avidemux/ADM_codecs/ADM_ffmpeg.cpp:53
+#: avidemux/ADM_codecs/ADM_ffmpeg.cpp:55
 msgid "Internal error with context for  codec"
 msgstr "??????????????"
 
-#: avidemux/ADM_codecs/ADM_ffmpeg.cpp:53
+#: avidemux/ADM_codecs/ADM_ffmpeg.cpp:55
 msgid ""
 ".\n"
 " Did you use too low / too high target for 2 pass ?"
@@ -165,20 +165,20 @@
 msgid "Aborted"
 msgstr "??????"
 
-#: avidemux/ADM_editor/ADM_edit.cpp:404
+#: avidemux/ADM_editor/ADM_edit.cpp:407
 msgid "File type identified but no loader support detected..."
 msgstr "???????????????????????????????..."
 
-#: avidemux/ADM_editor/ADM_edit.cpp:405
+#: avidemux/ADM_editor/ADM_edit.cpp:408
 msgid "May be related to an old index file."
 msgstr "????????????????????????."
 
-#: avidemux/ADM_editor/ADM_edit.cpp:412
+#: avidemux/ADM_editor/ADM_edit.cpp:415
 #, c-format
 msgid "Attempt to open %s failed!"
 msgstr "%s ????????????!"
 
-#: avidemux/ADM_editor/ADM_edit.cpp:436
+#: avidemux/ADM_editor/ADM_edit.cpp:439
 msgid ""
 "You cannot mix different video dimensions yet. Using the partial video filter later, will not work around this problem. The workaround is:\n"
 "1.) \"resize\" / \"add border\" / \"crop\" each stream to the same resolution\n"
@@ -188,23 +188,23 @@
 "1.) ??????? \"resize\" / \"add border\" / \"crop\" ????????????\n"
 "2.) ??????????"
 
-#: avidemux/ADM_editor/ADM_edit.cpp:548
+#: avidemux/ADM_editor/ADM_edit.cpp:551
 msgid "Build Time Map"
 msgstr "???????????"
 
-#: avidemux/ADM_editor/ADM_edit.cpp:548
+#: avidemux/ADM_editor/ADM_edit.cpp:551
 msgid "Build VBR time map?"
 msgstr "VBR ???????????????"
 
-#: avidemux/ADM_editor/ADM_edit.cpp:582
+#: avidemux/ADM_editor/ADM_edit.cpp:585
 msgid "Use that mode"
 msgstr "????????"
 
-#: avidemux/ADM_editor/ADM_edit.cpp:582
+#: avidemux/ADM_editor/ADM_edit.cpp:585
 msgid "H264 detected"
 msgstr "H264???????"
 
-#: avidemux/ADM_editor/ADM_edit.cpp:582
+#: avidemux/ADM_editor/ADM_edit.cpp:585
 msgid ""
 "If the file is using bframe as reference, it can lead to crash or stutteting.\n"
 "Avidemux can use another mode which is safed but <b>YOU WILL LOOSE FRAME ACCURACY</b>.\n"
@@ -214,47 +214,47 @@
 "Avidemux ?????????????????????<b>???????????????????</b>.\n"
 "??????????? ?"
 
-#: avidemux/ADM_editor/ADM_edit.cpp:709
+#: avidemux/ADM_editor/ADM_edit.cpp:712
 msgid "Packed Bitstream detected"
 msgstr "???????????????????"
 
-#: avidemux/ADM_editor/ADM_edit.cpp:710
+#: avidemux/ADM_editor/ADM_edit.cpp:713
 msgid "Do you want me to unpack it ?"
 msgstr "???????????? ?"
 
-#: avidemux/ADM_editor/ADM_edit.cpp:730
+#: avidemux/ADM_editor/ADM_edit.cpp:733
 msgid "Could not unpack the video"
 msgstr "?????????????"
 
-#: avidemux/ADM_editor/ADM_edit.cpp:730
+#: avidemux/ADM_editor/ADM_edit.cpp:733
 msgid "Using backup decoder - not frame accurate."
 msgstr "????????????? - ???????????."
 
-#: avidemux/ADM_editor/ADM_edit.cpp:735
+#: avidemux/ADM_editor/ADM_edit.cpp:738
 msgid "Weird"
 msgstr ""
 
-#: avidemux/ADM_editor/ADM_edit.cpp:735
+#: avidemux/ADM_editor/ADM_edit.cpp:738
 msgid "The unpacking succeedeed but the index is still not up to date."
 msgstr "???????????????????????????????."
 
-#: avidemux/ADM_editor/ADM_edit.cpp:741
+#: avidemux/ADM_editor/ADM_edit.cpp:744
 msgid "Troubles ahead"
 msgstr ""
 
-#: avidemux/ADM_editor/ADM_edit.cpp:741
+#: avidemux/ADM_editor/ADM_edit.cpp:744
 msgid "This a VOP packed AVI."
 msgstr "???VOP????AVI??."
 
-#: avidemux/ADM_editor/ADM_edit.cpp:752
+#: avidemux/ADM_editor/ADM_edit.cpp:755
 msgid "Index is not up to date"
 msgstr "????????????????"
 
-#: avidemux/ADM_editor/ADM_edit.cpp:752
+#: avidemux/ADM_editor/ADM_edit.cpp:755
 msgid "You should use Tool->Rebuild frame. Do it now ?"
 msgstr "???->???????? ???????. ??????? ?"
 
-#: avidemux/ADM_editor/ADM_edit.cpp:1507
+#: avidemux/ADM_editor/ADM_edit.cpp:1510
 msgid ""
 "This looks like mpeg\n"
 " Do you want to index it?"
@@ -262,7 +262,7 @@
 "??? mpeg ?????\n"
 " ???????????????? ?"
 
-#: avidemux/ADM_editor/ADM_edit.cpp:1559
+#: avidemux/ADM_editor/ADM_edit.cpp:1562
 msgid "Indexing failed"
 msgstr "???????????"
 
@@ -376,7 +376,7 @@
 msgid "Size is not (s)QCIF"
 msgstr "????(s)QCIF???"
 
-#: avidemux/ADM_inputs/ADM_mp4/ADM_mp4Analyzer.cpp:570
+#: avidemux/ADM_inputs/ADM_mp4/ADM_mp4Analyzer.cpp:583
 msgid "Problem reading SVQ3 headers"
 msgstr "SVQ3????????"
 
@@ -407,7 +407,7 @@
 #: avidemux/ADM_inputs/ADM_nuv/ADM_nuv.cpp:542
 #: avidemux/ADM_inputs/ADM_nuv/ADM_nuv.cpp:571
 msgid "Opening Nuppel video"
-msgstr "Nupple?????????"
+msgstr "Nuppel?????????"
 
 #: avidemux/ADM_inputs/ADM_nuv/ADM_nuv.cpp:547
 msgid "Sure you want to abort ?"
@@ -437,7 +437,7 @@
 #: avidemux/ADM_inputs/ADM_openDML/ADM_openDML.cpp:366
 #: avidemux/ADM_inputs/ADM_openDML/ADM_openDML.cpp:501
 msgid "Malformed header"
-msgstr "??????"
+msgstr "?????????"
 
 #: avidemux/ADM_inputs/ADM_openDML/ADM_openDMLDepack.cpp:93
 msgid "Unpacking bitstream"
@@ -474,7 +474,7 @@
 msgstr "BMP???????"
 
 #: avidemux/ADM_libraries/ADM_utilities/ADM_imageUtils.cpp:417
-#: avidemux/gtk_gui.cpp:1917
+#: avidemux/gtk_gui.cpp:1927
 msgid "Something bad happened"
 msgstr "????????????"
 
@@ -483,19 +483,23 @@
 msgstr "???????????????"
 
 #: avidemux/ADM_libraries/ADM_utilities/ADM_imageUtils.cpp:481
-#: avidemux/ADM_ocr/ADM_ocrLoadSave.h:71
+#: avidemux/ADM_ocr/adm_glyph.cpp:221
 #: avidemux/ADM_outputs/oplug_mpegFF/oplug_vcdff.cpp:380
 #: avidemux/ADM_outputs/oplug_ogm/op_ogsave.cpp:112
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:105
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:110
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:117
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:126
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_toolkit_gtk/TLK_filesel.cpp:335
-#: avidemux/gtk_gui.cpp:890
-#: avidemux/gtk_gui.cpp:1522
+#: avidemux/gtk_gui.cpp:895
+#: avidemux/gtk_gui.cpp:1524
 msgid "File error"
 msgstr "???????"
 
 #: avidemux/ADM_libraries/ADM_utilities/ADM_imageUtils.cpp:481
 #: avidemux/ADM_outputs/oplug_mpegFF/oplug_vcdff.cpp:380
 #: avidemux/ADM_outputs/oplug_ogm/op_ogsave.cpp:112
-#: avidemux/gtk_gui.cpp:1522
+#: avidemux/gtk_gui.cpp:1524
 #, possible-c-format
 msgid "Cannot open \"%s\" for writing."
 msgstr "????? \"%s\" ??????."
@@ -529,19 +533,11 @@
 msgid "Unknown"
 msgstr "??"
 
-#: avidemux/ADM_ocr/ADM_ocrLoadSave.h:22
-msgid "Select Glyphfile to save to"
-msgstr "??????????????"
-
-#: avidemux/ADM_ocr/ADM_ocrLoadSave.h:30
+#: avidemux/ADM_ocr/adm_glyph.cpp:173
 msgid "Could not write the file"
 msgstr "???????????"
 
-#: avidemux/ADM_ocr/ADM_ocrLoadSave.h:62
-msgid "Erase current glyphs ?"
-msgstr "??????????? ?"
-
-#: avidemux/ADM_ocr/ADM_ocrLoadSave.h:71
+#: avidemux/ADM_ocr/adm_glyph.cpp:221
 #, possible-c-format
 msgid "Could not read \"%s\"."
 msgstr "\"%s\" ??????."
@@ -584,7 +580,7 @@
 msgstr ""
 "????????????.\n"
 "\n"
-"OK????????????????????. ?????????????????????."
+"?????????????OK??????????. ?????????????????????."
 
 #: avidemux/ADM_osSupport/ADM_crashdump.cpp:423
 msgid "Load it"
@@ -656,7 +652,7 @@
 msgstr "%lu ?"
 
 #: avidemux/ADM_outputs/oplug_avi/op_avisave.cpp:74
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:180
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:188
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp:845
 msgid "Normal"
 msgstr "??"
@@ -857,6 +853,30 @@
 msgid "menu"
 msgstr "????"
 
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_animated.cpp:36
+msgid "_Background Image:"
+msgstr "????(_B):"
+
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_animated.cpp:37
+msgid "_NTSC(default is Pal):"
+msgstr "_NTSC (??????PAL)"
+
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_animated.cpp:38
+msgid "Vignette _Width:"
+msgstr "?????(_W):"
+
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_animated.cpp:39
+msgid "Vignette _Height:"
+msgstr "??????(_H):"
+
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_animated.cpp:42
+msgid "Vignette frame number"
+msgstr "?????????"
+
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_animated.cpp:46
+msgid "Timecode:"
+msgstr "??????:"
+
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_audioFilter.cpp:62
 msgid "_Dynamic range compression"
 msgstr "?????(_D)"
@@ -871,7 +891,7 @@
 
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_audioFilter.cpp:72
 msgid "R_esampling (Hz):"
-msgstr "???????(_E) (Hz):"
+msgstr "?????(_E) (Hz):"
 
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_audioFilter.cpp:72
 msgid "Resampling frequency (Hz)"
@@ -892,8 +912,8 @@
 #: avidemux/ADM_videoFilter/ADM_lavpp_deint.cpp:105
 #: avidemux/ADM_videoFilter/ADM_vidDecTelecide.cpp:101
 #: avidemux/ADM_videoFilter/ADM_vidRotate.cpp:264
-#: avidemux/gtk_gui.cpp:1995
-#: avidemux/gtk_gui.cpp:2094
+#: avidemux/gtk_gui.cpp:2005
+#: avidemux/gtk_gui.cpp:2104
 msgid "None"
 msgstr "??"
 
@@ -1191,7 +1211,7 @@
 
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_gototime.cpp:27
 msgid "_Hours:"
-msgstr "?(_H):"
+msgstr "??(_H):"
 
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_gototime.cpp:28
 msgid "_Minutes:"
@@ -1343,25 +1363,62 @@
 
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_lavDecoder.cpp:48
 msgid "Decoder Options"
-msgstr "??????????"
+msgstr "?????????"
 
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_mjpeg.cpp:41
 msgid "_Swap U&V:"
 msgstr "U?V???(_S):"
 
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:82
+msgid "Select idx file:"
+msgstr "idx???????:"
+
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:83
+msgid "Use glyphset (optional):"
+msgstr "?????????(??):"
+
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:84
+msgid "Output SRT file"
+msgstr "??SRT????"
+
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:95
+msgid "Select input and ouput files"
+msgstr "??????????"
+
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:105
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:117
+msgid "The idx/sub file does not exist."
+msgstr "idx/sub??????????."
+
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:110
+msgid "Please Select a valid output SRT file."
+msgstr "?????SRT???????????."
+
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:126
+msgid "Cannot load the glyphset file."
+msgstr "?????????????????."
+
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:144
+msgid "Glyphset filename"
+msgstr "???????????"
+
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp:146
+msgid "Save Glyph"
+msgstr "??????"
+
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_postproc.cpp:40
 #: avidemux/ADM_videoFilter/ADM_vidForcedPP.cpp:60
 msgid "_Filter strength:"
 msgstr "???????(_F):"
 
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_postproc.cpp:51
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:269
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:285
 #: avidemux/ADM_videoFilter/ADM_vidForcedPP.cpp:72
 msgid "_Horizontal deblocking"
 msgstr "???????(_H)"
 
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_postproc.cpp:52
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:270
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:286
 #: avidemux/ADM_videoFilter/ADM_vidForcedPP.cpp:73
 msgid "_Vertical deblocking"
 msgstr "???????(_V)"
@@ -1371,55 +1428,55 @@
 msgid "_Deringing"
 msgstr "????(_D)"
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:162
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:170
 msgid "_Use systray while encoding"
 msgstr "??????????????(_U)"
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:163
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:171
 msgid "_Accept non-standard audio frequency for DVD"
 msgstr "DVD?????????????????(_A)"
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:164
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:172
 msgid "_Use libavcodec MPEG-2 decoder"
 msgstr "lavcodec MPEG2 ???????(_U)"
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:165
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:173
 msgid "Create _OpenDML files"
 msgstr "OpenDML?????????(_O)"
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:166
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:174
 msgid "Automatically _index MPEG files"
 msgstr "????MPEG????????????????(_I)"
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:167
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:175
 msgid "Automatically _swap A and B if A>B"
 msgstr "A>B??????A?B?????????(_S)"
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:168
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:176
 msgid "_Disable NUV audio sync"
 msgstr "NUV???????????(_D)"
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:169
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:177
 msgid "_Load external filters"
 msgstr "??????????(_L)"
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:171
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:179
 msgid "Automatically _build VBR map"
 msgstr "????VBR????????(_B)"
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:172
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:180
 msgid "Automatically _rebuild index"
 msgstr "????????????????(_R)"
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:173
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:181
 msgid "Automatically remove _packed bitstream"
 msgstr "?????????????????????(_P)"
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:175
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:183
 msgid "_Number of threads:"
 msgstr "?????(_N):"
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:178
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:186
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp:843
 #: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_srt.cpp:108
 #: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_x264.cpp:105
@@ -1427,15 +1484,15 @@
 msgid "High"
 msgstr "??"
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:179
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:187
 msgid "Above normal"
 msgstr "????"
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:181
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:189
 msgid "Below normal"
 msgstr "????"
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:182
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:190
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp:847
 #: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_srt.cpp:107
 #: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_x264.cpp:104
@@ -1443,112 +1500,148 @@
 msgid "Low"
 msgstr "??"
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:184
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:192
 msgid "_Encoding priority:"
 msgstr "?????????(_E):"
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:185
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:193
 msgid "_Indexing/unpacking priority:"
 msgstr "???????/?????????(_I):"
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:186
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:194
 msgid "_Playback priority:"
 msgstr "??????(_P):"
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:188
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:196
 msgid "_Split MPEG files every (MB):"
 msgstr "??MB??MPEG?????????(_S):"
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:190
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:198
 msgid "_Use alternative tag for MP3 in .mp4"
 msgstr ".mp4?mp3????????(_U)"
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:193
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:201
 msgid "GTK+ (slow)"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:195
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:203
 msgid "XVideo (best)"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:198
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:207
+msgid "SDL (GDI)"
+msgstr ""
+
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:208
+msgid "SDL (DirectX)"
+msgstr ""
+
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:210
 msgid "SDL (good)"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:201
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:214
 msgid "Video _display:"
 msgstr "????(_D):"
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:206
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:219
 msgid "No alerts"
 msgstr "?????"
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:207
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:220
 msgid "Display only error alerts"
 msgstr "????????????"
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:208
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:221
 msgid "Display all alerts"
 msgstr "???????????"
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:210
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:223
 msgid "_Message level:"
 msgstr "????????(_M):"
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:215
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:228
 msgid "PCM"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:216
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:229
 msgid "Master"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:217
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:230
 msgid "_Volume control:"
 msgstr "????(_V):"
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:222
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:235
 msgid "No downmixing"
 msgstr "?????????"
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:224
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:237
 msgid "Pro Logic"
 msgstr "??????????"
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:225
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:238
 msgid "Pro Logic II"
 msgstr "??????????II"
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:227
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:240
 msgid "_Local playback downmixing:"
 msgstr "?????????????(_L):"
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:256
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:272
 msgid "_Audio output:"
 msgstr "????(_A):"
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:271
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:274
+msgid "ALSA _device:"
+msgstr "ALSA????(_D):"
+
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:287
 msgid "De_ringing"
 msgstr "????(_R)"
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:272
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:288
 #: avidemux/ADM_videoFilter/ADM_vidMSharpen.cpp:167
 msgid "_Strength:"
 msgstr "??(_S):"
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:273
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:289
 msgid "Default Postprocessing"
 msgstr "?????????"
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:287
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:303
 msgid "_Filter directory:"
 msgstr "?????????(_F):"
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:321
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:306
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_properties.cpp:47
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_props.cpp:26
+msgid "No"
+msgstr "???"
+
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:307
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_properties.cpp:47
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_props.cpp:26
+msgid "Yes"
+msgstr "??"
+
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:308
+msgid "Use _Global GlyphSet:"
+msgstr "??????????????(_G):"
+
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:309
+msgid "Gl_yphSet:"
+msgstr "??????(_Y):"
+
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:343
+msgid "Global Glyphset"
+msgstr "???????????"
+
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:348
 msgid "External Filters"
 msgstr "??????"
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:325
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp:352
 msgid "Preferences"
 msgstr "??"
 
@@ -1582,11 +1675,11 @@
 
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_srt.cpp:106
 msgid "S_elect C_olor"
-msgstr "????(_E_O)"
+msgstr "????(_E)(_O)"
 
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_srt.cpp:107
 msgid "Set Size and _Position"
-msgstr "?????????(_P)"
+msgstr "?????????(_P)"
 
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_srt.cpp:108
 msgid "_Auto split"
@@ -1611,6 +1704,7 @@
 msgstr "??????????"
 
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_tdeint.cpp:47
+#: avidemux/ADM_videoFilter/ADM_vidYadif.cpp:177
 msgid "Bottom field first"
 msgstr "??????????"
 
@@ -1681,11 +1775,11 @@
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp:788
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_idx_pg.cpp:166
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_idx_pg.cpp:206
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_ocr.cpp:148
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_ocr.cpp:156
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_ocr.cpp:89
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_ocr.cpp:96
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_resize.cpp:419
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_resize.cpp:433
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1403
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1429
 msgid "0"
 msgstr "0"
 
@@ -1769,7 +1863,7 @@
 
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_tdeint.cpp:120
 msgid "TDeint"
-msgstr "TDeint"
+msgstr ""
 
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_v2v.cpp:41
 msgid "_VOB file(s):"
@@ -1794,14 +1888,14 @@
 
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_v2v.cpp:62
 msgid "Please select a correct VobSub path/dir"
-msgstr "???VobSub???/???????????"
+msgstr "???VobSub??/???????????"
 
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_about.cpp:54
 msgid "translator-credits"
 msgstr "tetsuro"
 
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_about.cpp:69
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:266
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:272
 msgid "Avidemux"
 msgstr "Avidemux"
 
@@ -2173,104 +2267,34 @@
 msgid "Configure codec"
 msgstr "????????"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_animated.cpp:83
-msgid "Select background picture"
-msgstr "???????"
-
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_animated.cpp:169
-msgid "Animated Menu"
-msgstr ""
-
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_animated.cpp:193
-msgid "BackGround Image :"
-msgstr "???? :"
-
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_animated.cpp:200
-msgid "Standard"
-msgstr "??"
-
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_animated.cpp:207
-msgid "NTSC (default is PAL)"
-msgstr "NTSC (??????PAL)"
-
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_animated.cpp:227
-msgid "Vignette Width"
-msgstr "?????"
-
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_animated.cpp:234
-msgid "Vignette Height"
-msgstr "??????"
-
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_animated.cpp:257
-msgid "<b>General</b>"
-msgstr "<b>??</b>"
-
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_animated.cpp:276
-msgid "Chapter 1"
-msgstr "?????1"
-
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_animated.cpp:283
-msgid "Chapter 2"
-msgstr "?????2"
-
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_animated.cpp:290
-msgid "Chapter 3"
-msgstr "?????3"
-
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_animated.cpp:297
-msgid "Chapter 4"
-msgstr "?????4"
-
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_animated.cpp:304
-msgid "Chapter 5"
-msgstr "?????5"
-
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_animated.cpp:311
-msgid "Chapter 6"
-msgstr "?????6"
-
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_animated.cpp:324
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_animated.cpp:333
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_animated.cpp:342
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_animated.cpp:351
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_animated.cpp:360
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_animated.cpp:369
-msgid "Start frame for this vignette."
-msgstr "?????????????????"
-
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_animated.cpp:372
-msgid "<b>TimeCode</b>"
-msgstr "<b>??????</b>"
-
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_asharp.cpp:72
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_chromaShift.cpp:72
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_asharp.cpp:73
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_chromaShift.cpp:68
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_contrast.cpp:74
 msgid "ASHARP"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_asharp.cpp:185
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_asharp.cpp:199
 msgid "ASharp by MarcFD"
 msgstr "MarcFD???ASharp"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_asharp.cpp:198
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_asharp.cpp:212
 msgid "Threshold :"
 msgstr "?? :"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_asharp.cpp:206
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_asharp.cpp:220
 msgid "Strength :"
 msgstr "?? :"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_asharp.cpp:214
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_asharp.cpp:228
 msgid "Block Adaptative :"
 msgstr "??????? :"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_asharp.cpp:222
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_asharp.cpp:236
 msgid "Unknown flag :"
 msgstr "????? :"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_asharp.cpp:254
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_ocr.cpp:208
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_ocr.cpp:271
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_asharp.cpp:268
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_ocr.cpp:145
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_properties.cpp:262
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_properties.cpp:283
 msgid " "
@@ -2281,7 +2305,7 @@
 msgstr ""
 
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_calculator.cpp:401
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:982
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:992
 msgid "Calculator"
 msgstr "??"
 
@@ -2397,19 +2421,19 @@
 msgid "<b>Result</b>"
 msgstr "<b>??</b>"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_chromaShift.cpp:189
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_chromaShift.cpp:199
 msgid "ChromaShift"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_chromaShift.cpp:203
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_chromaShift.cpp:213
 msgid "U Shift :"
 msgstr "U ???:"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_chromaShift.cpp:210
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_chromaShift.cpp:220
 msgid "V Shift :"
 msgstr "V ???:"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_chromaShift.cpp:252
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_chromaShift.cpp:262
 msgid "<b>Preview</b>"
 msgstr "<b>?????</b>"
 
@@ -2462,13 +2486,13 @@
 msgstr "ColorYuv (Avisynth??)"
 
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_coloryuv.cpp:179
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_contrast.cpp:197
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_contrast.cpp:215
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_contrast.cpp:210
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_contrast.cpp:228
 msgid "Contrast"
 msgstr "??????"
 
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_coloryuv.cpp:186
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_contrast.cpp:224
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_contrast.cpp:237
 msgid "Brightness"
 msgstr "???"
 
@@ -2481,7 +2505,7 @@
 msgstr "?? Y"
 
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_coloryuv.cpp:214
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_contrast.cpp:242
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_contrast.cpp:255
 msgid "Chroma U"
 msgstr "?? U"
 
@@ -2549,39 +2573,39 @@
 msgid "<b>frame2</b>"
 msgstr "<b>????2</b>"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_contrast.cpp:238
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_contrast.cpp:251
 msgid "Luma"
 msgstr "??"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_contrast.cpp:246
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_contrast.cpp:259
 msgid "Chroma v"
 msgstr "?? v"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_crop.cpp:263
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_crop.cpp:273
 msgid "Crop Settings"
 msgstr "???????"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_crop.cpp:297
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_crop.cpp:307
 msgid "AutoCrop"
 msgstr "??????"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_crop.cpp:319
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_crop.cpp:329
 msgid "Reset"
 msgstr "????"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_crop.cpp:328
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_crop.cpp:338
 msgid "Crop Left :"
 msgstr "?????:"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_crop.cpp:336
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_crop.cpp:346
 msgid "Crop Top:"
 msgstr "?????:"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_crop.cpp:344
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_crop.cpp:354
 msgid "Crop Right:"
 msgstr "?????:"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_crop.cpp:352
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_crop.cpp:362
 msgid "Crop Bottom:"
 msgstr "?????:"
 
@@ -2708,47 +2732,47 @@
 msgid "Pause / Abort"
 msgstr "?? / ??"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_eq2.cpp:330
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_eq2.cpp:343
 msgid "MPlayer eq2"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_eq2.cpp:356
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_eq2.cpp:369
 msgid "Brigh_tness:"
 msgstr "???(_T):"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_eq2.cpp:364
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_eq2.cpp:377
 msgid "_Saturation:"
 msgstr "???(_S):"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_eq2.cpp:399
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_eq2.cpp:412
 msgid "_Contrast:"
 msgstr "??????(_C):"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_eq2.cpp:425
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_eq2.cpp:438
 msgid "_Initial:"
 msgstr "??(_I):"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_eq2.cpp:451
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_eq2.cpp:464
 msgid "_Red:"
 msgstr "?(_R):"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_eq2.cpp:468
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_eq2.cpp:481
 msgid "_Green:"
 msgstr "?(_G):"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_eq2.cpp:476
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_eq2.cpp:489
 msgid "_Blue:"
 msgstr "?(_B):"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_eq2.cpp:484
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_eq2.cpp:497
 msgid "_Weight:"
 msgstr "??(_W):"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_eq2.cpp:510
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_eq2.cpp:523
 msgid "<b>Gamma</b>"
 msgstr "<b>???</b>"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_equalizer.cpp:433
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_equalizer.cpp:449
 msgid "Equalizer"
 msgstr "?????"
 
@@ -2760,19 +2784,19 @@
 msgid "Enter parameters (i.e. -b 192 -m s ...)"
 msgstr "???????? (?: -b 192 -m s ...)"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_hue.cpp:84
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_hue.cpp:76
 msgid "Hue"
 msgstr "??"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_hue.cpp:184
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_hue.cpp:186
 msgid "Hue/Saturation"
 msgstr "??/???"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_hue.cpp:198
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_hue.cpp:200
 msgid "<b>Hue:</b>"
 msgstr "<b>??:</b>"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_hue.cpp:206
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_hue.cpp:208
 msgid "<b>Saturation:</b>"
 msgstr "<b>???:</b>"
 
@@ -2811,29 +2835,33 @@
 msgid "Indexing :"
 msgstr "?????????:"
 
-# NUL for MS Windows
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_idx_pg.cpp:222
 msgid "/dev/null"
 msgstr "NUL"
 
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_jobs.cpp:25
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_jobs.cpp:26
 msgid "Ready"
 msgstr ""
 
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_jobs.cpp:25
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_jobs.cpp:26
 msgid "Succeeded"
 msgstr "????"
 
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_jobs.cpp:25
-#: avidemux/gtk_gui.cpp:2272
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_jobs.cpp:26
+#: avidemux/gtk_gui.cpp:2282
 msgid "Failed"
 msgstr "????"
 
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_jobs.cpp:25
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_jobs.cpp:26
 msgid "Deleted"
 msgstr "????"
 
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_jobs.cpp:25
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_jobs.cpp:26
 msgid "Running"
 msgstr "???"
 
@@ -2851,6 +2879,8 @@
 
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_jobs.cpp:134
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_jobs.cpp:172
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_jobs.cpp:183
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_jobs.cpp:196
 msgid "Sure!"
 msgstr "??!"
 
@@ -2863,10 +2893,12 @@
 msgstr "?????????????? ?"
 
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_jobs.cpp:172
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_jobs.cpp:183
 msgid "Delete job"
 msgstr "??????"
 
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_jobs.cpp:172
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_jobs.cpp:183
 #, possible-c-format
 msgid "Are you sure you want to delete %s job ?"
 msgstr "??? %s ?????????? ?"
@@ -2937,105 +2969,81 @@
 
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_jobs_save.cpp:166
 msgid "_Job name:"
-msgstr "????(_J)"
+msgstr "????(_J):"
 
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_jobs_save.cpp:173
 msgid "Output _file:"
 msgstr "??????(_F):"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_mpdelogo.cpp:356
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_mpdelogo.cpp:378
 msgid "Mplayer Delogo"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_mpdelogo.cpp:374
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_mpdelogo.cpp:396
 msgid "X"
 msgstr "X"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_mpdelogo.cpp:381
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_mpdelogo.cpp:403
 msgid "Y"
 msgstr "Y"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_mpdelogo.cpp:388
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_mpdelogo.cpp:410
 msgid "W"
 msgstr "W"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_mpdelogo.cpp:395
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_mpdelogo.cpp:417
 msgid "H"
 msgstr "H"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_mpdelogo.cpp:402
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_mpdelogo.cpp:424
 msgid "Band"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_ocr.cpp:85
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_ocr.cpp:57
 msgid "Mini OCR"
 msgstr "?? OCR"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_ocr.cpp:118
-msgid "<b>Glyphs</b>"
-msgstr "<b>???</b>"
-
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_ocr.cpp:132
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_ocr.cpp:75
 msgid "# of Glyphs :"
 msgstr "?????:"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_ocr.cpp:140
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_ocr.cpp:82
 msgid "# of lines"
 msgstr "??"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_ocr.cpp:164
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_ocr.cpp:103
 msgid "<b>Stats</b>"
 msgstr "<b>?????</b>"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_ocr.cpp:186
-msgid "  "
-msgstr "  "
-
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_ocr.cpp:195
-msgid "VobSub"
-msgstr "VobSub"
-
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_ocr.cpp:217
-msgid "Output Srt"
-msgstr "??Srt"
-
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_ocr.cpp:222
-msgid "<b>Files</b>"
-msgstr "<b>????</b>"
-
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_ocr.cpp:228
-msgid "StartOcr"
-msgstr "OCR??"
-
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_ocr.cpp:249
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_ocr.cpp:125
 msgid "Current Glyph"
 msgstr "??????"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_ocr.cpp:263
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_ocr.cpp:138
 msgid " Text:"
 msgstr "????:"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_ocr.cpp:287
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_ocr.cpp:160
 msgid "Calibrate"
 msgstr "??"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_ocr.cpp:292
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_ocr.cpp:165
 msgid "Skip all"
 msgstr "???????"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_ocr.cpp:297
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_ocr.cpp:170
 msgid "Skip Glyph"
 msgstr "????????"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_ocr.cpp:302
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_ocr.cpp:175
 msgid "Ignore glyph"
 msgstr "??????"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_ocr.cpp:307
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_ocr.cpp:180
 msgid "Ok"
 msgstr "Ok"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_ocr.cpp:316
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_ocr.cpp:189
 msgid "<b>Bitmap</b>"
 msgstr "<b>??????</b>"
 
@@ -3090,25 +3098,15 @@
 msgid "Full parameter line"
 msgstr "????????"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_preview.cpp:280
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_preview.cpp:319
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_filters/gui_filtersub.cpp:150
 msgid "Preview"
 msgstr "?????"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_preview.cpp:316
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_preview.cpp:355
 msgid "Stack Field"
 msgstr ""
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_properties.cpp:47
-#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_props.cpp:26
-msgid "No"
-msgstr "???"
-
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_properties.cpp:47
-#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_props.cpp:26
-msgid "Yes"
-msgstr "??"
-
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_properties.cpp:67
 #: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_props.cpp:69
 #, c-format
@@ -3189,7 +3187,7 @@
 msgstr "??????:"
 
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_properties.cpp:318
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1021
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1056
 msgid "<b>Video</b>"
 msgstr "<b>??</b>"
 
@@ -3234,7 +3232,7 @@
 msgstr "????????:"
 
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_properties.cpp:496
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1061
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1096
 msgid "<b>Audio</b>"
 msgstr "<b>??</b>"
 
@@ -3299,11 +3297,11 @@
 msgstr ""
 
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_srt.cpp:92
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_srt.cpp:224
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_srt.cpp:237
 msgid "Subtitle Size and Position"
 msgstr "????????"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_srt.cpp:238
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_srt.cpp:251
 msgid "Font Size:"
 msgstr "???????:"
 
@@ -3312,8 +3310,8 @@
 msgstr "???????"
 
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_vcodec.cpp:118
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1041
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1081
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1076
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1116
 msgid "Configure"
 msgstr "??"
 
@@ -3453,7 +3451,7 @@
 #: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_srt.cpp:67
 #: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_x264.cpp:64
 msgid "6B - Very High (RDO on Bframes)"
-msgstr "6B - ????? (RDO on Bframes)"
+msgstr "6B - ????? (B??????RDO)"
 
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:682
 #: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_srt.cpp:68
@@ -3465,7 +3463,7 @@
 #: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_srt.cpp:69
 #: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_x264.cpp:66
 msgid "7B - Ultra High (RDO on Bframes)"
-msgstr "7B - ??? (RDO on Bframes)"
+msgstr "7B - ??? (B??????RDO)"
 
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_x264.cpp:690
 #: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_srt.cpp:75
@@ -4093,7 +4091,7 @@
 
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:121
 msgid "Error loadind the custom matrix file."
-msgstr "????????????????????"
+msgstr "????????????????????."
 
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_xvid4.cpp:139
 msgid "Matrix Loaded"
@@ -4759,19 +4757,19 @@
 msgid "Save as script"
 msgstr "??????????"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_bindings.cpp:427
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_bindings.cpp:437
 msgid "Input"
 msgstr "??"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_bindings.cpp:428
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_bindings.cpp:438
 msgid "Output"
 msgstr "??"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_bindings.cpp:429
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_bindings.cpp:439
 msgid "Side"
 msgstr "???"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_bindings.cpp:430
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_bindings.cpp:440
 #: avidemux/ADM_videoFilter/ADM_vidDecTelecide.cpp:90
 #: avidemux/ADM_videoFilter/ADM_vidDGbob.cpp:81
 #: avidemux/ADM_videoFilter/ADM_vidKernelDeint.cpp:87
@@ -4779,552 +4777,575 @@
 msgid "Top"
 msgstr "???"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_bindings.cpp:431
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_bindings.cpp:441
 msgid "Separate"
 msgstr "??"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_bindings.cpp:607
-#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/Q_gui2.cpp:439
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_bindings.cpp:615
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/Q_gui2.cpp:499
 #, c-format
 msgid "Frame:%c(%02d)"
 msgstr "????:%c(%02d)"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:283
-#: avidemux/main.cpp:163
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:289
+#: avidemux/main.cpp:203
 msgid "_File"
 msgstr "????(_F)"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:290
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:296
 msgid "_Open..."
 msgstr "??(_O)"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:301
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:307
 msgid "_Append..."
 msgstr "??(_A)"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:312
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:318
 msgid "_Save"
 msgstr "??(_S)"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:323
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:329
 msgid "Save _Video..."
 msgstr "?????(_V)"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:335
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:341
 msgid "Save _BMP Image..."
 msgstr "BMP?????(_B)"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:339
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:345
 msgid "Save _JPEG Image..."
 msgstr "JPEG?????(_J)"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:343
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:349
 msgid "Save _Selection as JPEG Images..."
 msgstr "???JPEG???????(_S)"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:356
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:362
 msgid "Save _Project"
 msgstr "?????????(_P)"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:364
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:370
 msgid "Save P_roject As..."
 msgstr "???????????????(_R)"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:372
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:378
 msgid "_Load/Run Project..."
 msgstr "??????????/??(_L)"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:380
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:386
 msgid "A_dd to Joblist..."
 msgstr "?????????(_D)"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:384
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:390
 msgid "Show _Joblist"
 msgstr "????????(_J)"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:396
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:402
 msgid "Co_nnect to avsproxy"
 msgstr "AvsProxy???(_N)"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:405
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:411
 msgid "Proper_ties"
 msgstr "?????(_T)"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:416
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:422
 msgid "AVI _Muxer Options"
 msgstr "AVI????????(_M)"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:425
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:431
 msgid "_Quit"
 msgstr "??(_Q)"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:436
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:442
 msgid "_Edit"
 msgstr "??(_E)"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:443
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:449
 msgid "_Reset Edits"
 msgstr "???????(_R)"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:456
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:462
 msgid "Cu_t"
 msgstr "???(_T)"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:467
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:473
 msgid "_Copy"
 msgstr "???(_C)"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:478
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:484
 msgid "_Paste"
 msgstr "????(_P)"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:489
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:495
 msgid "_Delete"
 msgstr "??(_D)"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:505
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:511
 msgid "Set Marker _A"
 msgstr "????A???(_A)"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:512
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:518
 msgid "Set Marker _B"
 msgstr "????B???(_B)"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:524
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:530
 msgid "Pre_ferences"
 msgstr "??(_F)"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:532
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:538
 msgid "_View"
 msgstr "??(_V)"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:539
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:545
 msgid "_Main Toolbar"
 msgstr "??????(_M)"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:544
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:550
 msgid "_A/V Sidebar"
 msgstr "A/V??????(_A)"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:554
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:560
 msgid "_Zoom 1:4"
 msgstr "??? 1:4 (_Z)"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:561
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:567
 msgid "Z_oom 1:2"
 msgstr "??? 1:2 (_O)"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:568
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:574
 msgid "Zoom _1:1"
 msgstr "??? 1:1 (_1)"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:575
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:581
 msgid "Zoom _2:1"
 msgstr "??? 2:1 (_2)"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:582
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:588
 msgid "Zoom _4:1"
 msgstr "??? 4:1 (_4)"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:589
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:595
 msgid "Vi_deo"
 msgstr "??(_D)"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:596
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:602
 msgid "_Decoder Options"
 msgstr "?????????(_D)"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:603
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:609
 msgid "_Postprocessing"
 msgstr "???(_P)"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:606
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:612
 msgid "Select postprocessing level"
 msgstr "?????????"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:616
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:622
 msgid "P_review"
 msgstr "?????(_R)"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:623
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:629
 msgid "Display _Output"
 msgstr "?????(_O)"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:635
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:641
 msgid "_Frame Rate"
 msgstr "???????(_F)"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:639
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:688
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:645
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:694
 msgid "_Encoder"
 msgstr "?????(_E)"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:646
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:652
 msgid "Fil_ters"
 msgstr "????(_T)"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:653
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:659
 msgid "_Audio"
 msgstr "??(_A)"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:660
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:666
 msgid "_Main Track"
 msgstr "?????(_M)"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:664
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:670
 msgid "_Second Track"
 msgstr "??????(_S)"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:668
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:674
 msgid "_Build VBR Time Map"
 msgstr "VBR?????????(_B)"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:677
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:683
 msgid "S_ave..."
 msgstr "??(_A)"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:695
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:701
 msgid "_Filters"
 msgstr "????(_F)"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:699
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:705
 msgid "_Tools"
 msgstr "???(_T)"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:706
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:712
 msgid "_Calculator"
 msgstr "??(_C)"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:722
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:728
 msgid "_Rebuild Frames (I & B)"
 msgstr "????(I?B)????(_R)"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:726
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:732
 msgid "C_heck Frames (slow)"
 msgstr "??????(_H) (??)"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:730
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:736
 msgid "_Bitrate Histogram"
 msgstr "?????? ??????(_B)"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:734
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:740
 msgid "_Scan for Black Frames..."
 msgstr "??????????(_S)"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:743
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:749
 msgid "_VOB -> VobSub"
 msgstr "_VOB -> VobSub"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:747
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:753
 msgid "_OCR (VobSub -> srt)"
 msgstr "_OCR (VobSub -> srt)"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:756
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:757
+msgid "_Edit Glyph"
+msgstr "??????(_E)"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:766
 msgid "_Frame Hex Dump"
 msgstr "????16????(_F)"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:760
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:770
 msgid "A_uto"
 msgstr "??(_U)"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:767
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:777
 msgid "_VCD"
 msgstr "_VCD"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:771
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:781
 msgid "_SVCD"
 msgstr "_SVCD"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:775
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:785
 msgid "_DVD"
 msgstr "_DVD"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:779
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:789
 msgid "_PSP"
 msgstr "_PSP"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:783
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:793
 msgid "PSP (_H.264)"
 msgstr "PSP (_H.264)"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:787
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:797
 msgid "_Go"
 msgstr "??(_G)"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:794
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:804
 msgid "_Play/Stop"
 msgstr "??/??(_P)"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:805
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:815
 msgid "P_revious Frame"
 msgstr "??????(_R)"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:816
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:826
 msgid "_Next Frame"
 msgstr "??????(_N)"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:827
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:837
 msgid "Pr_evious Intra Frame"
 msgstr "??I-????(_E)"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:838
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:848
 msgid "Next _Intra Frame"
 msgstr "??I-????(_I)"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:849
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:859
 msgid "Previou_s Black Frame"
 msgstr "???????(_S)"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:853
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:863
 msgid "Ne_xt Black Frame"
 msgstr "???????(_X)"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:857
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:867
 msgid "_First Frame"
 msgstr "???????(_F)"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:868
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:878
 msgid "_Last Frame"
 msgstr "???????(_L)"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:884
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:894
 msgid "Go to Marker _A"
 msgstr "????A???(_A)"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:891
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:901
 msgid "Go to Marker _B"
 msgstr "????B???(_B)"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:903
-msgid "_Jump to Frame..."
-msgstr "???????(_J)"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:913
+msgid "Go to Fra_me..."
+msgstr "???????(_M)"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:914
-msgid "Jump to _Time..."
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:924
+msgid "Go to _Time..."
 msgstr "?????(_T)"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:925
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:935
 msgid "_Custom"
 msgstr "????(_C)"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:929
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:939
 msgid "_Help"
 msgstr "???(_H)"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:936
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:946
 msgid "_Built-in Support"
 msgstr "??????(_B)"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:940
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:950
 msgid "_About"
 msgstr "Avidemux????(_A)"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:958
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:968
 msgid "Open a file"
 msgstr "???????"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:968
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:978
 msgid "Save the file"
 msgstr "?????????"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:974
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:984
 msgid "Audio/video file information"
 msgstr "??/????????"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:985
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:995
 msgid "Bitrate/size calculator"
 msgstr "??????/?????"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1039
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1079
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1074
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1114
 msgid "Copy"
 msgstr "???"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1044
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1079
 msgid "Configure video encoder"
 msgstr "??????????"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1049
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1105
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1084
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1140
 msgid "Filters"
 msgstr "????"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1052
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1087
 msgid "Video filters"
 msgstr "??????"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1084
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1119
 msgid "Configure audio encoder"
 msgstr "??????????"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1092
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1127
 msgid "Audio filters"
 msgstr "??????"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1113
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1148
 msgid "Shift:"
 msgstr "??:"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1116
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1151
 msgid "Enable time shift"
 msgstr "??????????"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1122
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1157
 msgid "Audio/video time shift (ms)"
 msgstr "??/?????? (ms)"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1129
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1164
 msgid "<b>Format</b>"
 msgstr "<b>??</b>"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1162
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1197
 msgid "<b>Selection</b>"
 msgstr "<b>??</b>"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1179
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1187
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1214
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1222
 msgid " 0000000"
 msgstr " 0000000"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1195
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1230
 msgid "A:"
 msgstr "A :"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1202
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1237
 msgid "Go to marker A"
 msgstr "????A???"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1204
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1239
 msgid "B:"
 msgstr "B?:"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1211
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1246
 msgid "Go to marker B"
 msgstr "????B???"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1223
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1258
 msgid "Play"
 msgstr "??"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1237
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1272
 msgid "Stop"
 msgstr "??"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1249
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1284
 msgid "Previous frame"
 msgstr "??????"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1264
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1299
 msgid "Next frame"
 msgstr "??????"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1279
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1314
 msgid "Previous keyframe"
 msgstr "????????"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1294
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1329
 msgid "Next keyframe"
 msgstr "????????"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1308
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1343
 msgid "Selection: start"
 msgstr "??: ??"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1319
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1354
 msgid "Selection: end"
 msgstr "??: ??"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1330
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1365
 msgid "Previous black frame"
 msgstr "???????"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1341
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1376
 msgid "Next black frame"
 msgstr "???????"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1352
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1387
 msgid "First frame"
 msgstr "???????"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1363
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1398
 msgid "Last frame"
 msgstr "???????"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1394
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1420
 msgid "Frame: "
 msgstr "????: "
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1401
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1427
 msgid "Current frame"
 msgstr "???????"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1406
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1432
 msgid "/ 0000000"
 msgstr "/ 0000000"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1413
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1439
 msgid "Time: "
 msgstr "??: "
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1420
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1446
 msgid "Current time"
 msgstr "?????"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1421
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1447
 msgid "00:00:00.000"
 msgstr "00:00:00.000"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1424
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1450
 msgid "/ 00:00:00,000"
 msgstr "/ 00:00:00,000"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1431
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp:1457
 msgid "Frame: ?"
 msgstr "????: ?"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_ocr/adm_ocr.cpp:209
-#: avidemux/ADM_userInterfaces/ADM_GTK/adm_ocr.cpp:209
-msgid "Incorrect output file"
-msgstr "?????????"
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_ocr/adm_editglyph.cpp:53
+msgid "Select GlyphFile to edit"
+msgstr "??????????????"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_ocr/adm_ocr.cpp:215
-#: avidemux/ADM_userInterfaces/ADM_GTK/adm_ocr.cpp:215
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_ocr/adm_editglyph.cpp:121
+msgid "String"
+msgstr "???"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_ocr/adm_editglyph.cpp:123
+msgid "Search string"
+msgstr "?????"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_ocr/adm_editglyph.cpp:149
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_ocr/adm_editglyph.cpp:192
+msgid "End reached"
+msgstr "???????"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_ocr/adm_editglyph.cpp:149
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_ocr/adm_editglyph.cpp:192
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_ocr/adm_editglyph.cpp:216
+msgid "No more glyphs"
+msgstr "?????????"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_ocr/adm_editglyph.cpp:216
+msgid "Head reached"
+msgstr "???????"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_ocr/adm_editglyph.cpp:344
+msgid "dialog1"
+msgstr ""
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_ocr/adm_editglyph.cpp:396
+msgid "Prev. Empty"
+msgstr "???"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_ocr/adm_editglyph.cpp:418
+msgid "Next Empty"
+msgstr "???"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_ocr/adm_ocr.cpp:180
 msgid "Output file error"
 msgstr "?????????"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_ocr/adm_ocr.cpp:215
-#: avidemux/ADM_userInterfaces/ADM_GTK/adm_ocr.cpp:215
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_ocr/adm_ocr.cpp:180
 #, possible-c-format
 msgid "Could not open \"%s\" for writing."
 msgstr "????? \"%s\" ??????"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_ocr/adm_ocr.cpp:224
-#: avidemux/ADM_userInterfaces/ADM_GTK/adm_ocr.cpp:224
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_ocr/adm_ocr.cpp:189
 msgid "Problem loading sub"
-msgstr "????????"
+msgstr "???????"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_ocr/adm_ocr.cpp:589
-#: avidemux/ADM_userInterfaces/ADM_GTK/adm_ocr.cpp:589
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_ocr/adm_ocr.cpp:295
+msgid "Select Glyphfile to save to"
+msgstr "??????????????"
+
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_ocr/adm_ocr.cpp:362
 msgid "Sure ?"
 msgstr "?? ?"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_ocr/adm_ocr.cpp:752
-#: avidemux/ADM_userInterfaces/ADM_GTK/adm_ocr.cpp:752
-msgid "Select SRT to save"
-msgstr "????SRT???"
-
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_ocr/adm_ocr.cpp:764
-#: avidemux/ADM_userInterfaces/ADM_GTK/adm_ocr.cpp:764
-msgid "Select Glyoh to save"
-msgstr "??????????"
-
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_ocr/adm_ocr.cpp:778
-#: avidemux/ADM_userInterfaces/ADM_GTK/adm_ocr.cpp:778
-msgid "No glyphs to save"
-msgstr "?????????????"
-
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_toolkit_gtk/ADM_gladeSupport.cpp:251
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_toolkit_gtk/ADM_gladeSupport.cpp:275
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_toolkit_gtk/ADM_gladeSupport.cpp:252
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_toolkit_gtk/ADM_gladeSupport.cpp:276
 #, possible-c-format
 msgid "Couldn't find pixmap file: %s"
 msgstr "pixmap????: %s ????????"
@@ -5336,7 +5357,7 @@
 msgstr "?????????????????"
 
 #: avidemux/ADM_userInterfaces/ADM_GTK/ADM_toolkit_gtk/TLK_filesel.cpp:335
-#: avidemux/gtk_gui.cpp:887
+#: avidemux/gtk_gui.cpp:892
 #, possible-c-format
 msgid "Cannot open \"%s\"."
 msgstr "\"%s\" ??????."
@@ -5359,11 +5380,11 @@
 msgid "No write access to \"%s\"."
 msgstr "\"%s\" ??????????????."
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_toolkit_gtk/TLK_filesel.cpp:528
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_toolkit_gtk/TLK_filesel.cpp:529
 msgid "Images"
 msgstr "??"
 
-#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_toolkit_gtk/TLK_filesel.cpp:540
+#: avidemux/ADM_userInterfaces/ADM_GTK/ADM_toolkit_gtk/TLK_filesel.cpp:541
 msgid "All"
 msgstr "???"
 
@@ -5573,6 +5594,38 @@
 msgid "Xvid4 Configuration"
 msgstr "XviD4 ??"
 
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_jobs.cpp:106
+msgid "Job Name"
+msgstr "????"
+
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_jobs.cpp:106
+msgid "Status"
+msgstr "?????"
+
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_jobs.cpp:106
+msgid "Start Time"
+msgstr "????"
+
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_jobs.cpp:106
+msgid "End Time"
+msgstr "????"
+
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_jobs.cpp:196
+msgid "Delete *all* job"
+msgstr "*?*??????"
+
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_jobs.cpp:196
+msgid "Are you sure you want to delete ALL jobs ?"
+msgstr "?????????????? ?"
+
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_jobs.cpp:222
+msgid "Already done"
+msgstr "?????"
+
+#: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_jobs.cpp:222
+msgid "This script has already been successfully executed."
+msgstr "????????????????."
+
 #: avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/T_index_pg.cpp:198
 #, c-format
 msgid "# Images :%0lu"
@@ -5627,13 +5680,13 @@
 msgid "Cannot identify subtitle format"
 msgstr "????????????"
 
-#: avidemux/ADM_video/ADM_guiResize.cpp:96
-#: avidemux/ADM_video/ADM_vidMPLResize.cpp:143
+#: avidemux/ADM_videoFilter/ADM_guiResize.cpp:96
+#: avidemux/ADM_videoFilter/ADM_vidMPLResize.cpp:143
 msgid "Width and height cannot be 0"
 msgstr "????? 0 ???????"
 
-#: avidemux/ADM_video/ADM_guiResize.cpp:98
-#: avidemux/ADM_video/ADM_vidMPLResize.cpp:145
+#: avidemux/ADM_videoFilter/ADM_guiResize.cpp:98
+#: avidemux/ADM_videoFilter/ADM_vidMPLResize.cpp:145
 msgid "Width and height cannot be odd"
 msgstr "????? ?????????"
 
@@ -5665,23 +5718,23 @@
 msgid "_Autolevel"
 msgstr "?????(_A)"
 
-#: avidemux/ADM_videoFilter/ADM_vidASS.cpp:85
+#: avidemux/ADM_videoFilter/ADM_vidASS.cpp:87
 msgid "_Subtitle file (ASS/SSA):"
 msgstr "??????(_S) (ASS/SSA):"
 
-#: avidemux/ADM_videoFilter/ADM_vidASS.cpp:86
+#: avidemux/ADM_videoFilter/ADM_vidASS.cpp:88
 msgid "_Line spacing:"
 msgstr "???????(_L):"
 
-#: avidemux/ADM_videoFilter/ADM_vidASS.cpp:87
+#: avidemux/ADM_videoFilter/ADM_vidASS.cpp:89
 msgid "_Font scale:"
 msgstr "????????(_F):"
 
-#: avidemux/ADM_videoFilter/ADM_vidASS.cpp:88
+#: avidemux/ADM_videoFilter/ADM_vidASS.cpp:90
 msgid "_Top margin:"
 msgstr "???(_T):"
 
-#: avidemux/ADM_videoFilter/ADM_vidASS.cpp:89
+#: avidemux/ADM_videoFilter/ADM_vidASS.cpp:91
 msgid "Botto_m margin"
 msgstr "???(_M)"
 
@@ -5963,7 +6016,7 @@
 
 #: avidemux/ADM_videoFilter/ADM_vidKernelDeint.cpp:94
 msgid "_Sharper engine:"
-msgstr "?????????????(_S)"
+msgstr "?????????????(_S):"
 
 #: avidemux/ADM_videoFilter/ADM_vidKernelDeint.cpp:95
 msgid "T_woway"
@@ -5999,7 +6052,7 @@
 
 #: avidemux/ADM_videoFilter/ADM_vidMcDeint.cpp:115
 msgid "_Qp:"
-msgstr ""
+msgstr "_Qp:"
 
 #: avidemux/ADM_videoFilter/ADM_vidMosaic.cpp:90
 msgid "_Horizontal stacking:"
@@ -6128,155 +6181,155 @@
 msgid "_Order:"
 msgstr "????(_O):"
 
-#: avidemux/gtk_gui.cpp:246
+#: avidemux/gtk_gui.cpp:253
 msgid "Select ECMAScript to Run"
 msgstr "????ECMA????????"
 
-#: avidemux/gtk_gui.cpp:293
-#: avidemux/gtk_gui.cpp:332
+#: avidemux/gtk_gui.cpp:300
+#: avidemux/gtk_gui.cpp:339
 msgid "Obsolete"
 msgstr "??"
 
-#: avidemux/gtk_gui.cpp:360
+#: avidemux/gtk_gui.cpp:367
 msgid "Not coded in this version"
 msgstr "????????????????????"
 
-#: avidemux/gtk_gui.cpp:373
-#: avidemux/gtk_gui.cpp:378
-#: avidemux/gtk_gui.cpp:493
-#: avidemux/gtk_gui.cpp:496
+#: avidemux/gtk_gui.cpp:382
+#: avidemux/gtk_gui.cpp:387
+#: avidemux/gtk_gui.cpp:506
+#: avidemux/gtk_gui.cpp:509
 msgid "Select AVI File..."
 msgstr "AVI???????..."
 
-#: avidemux/gtk_gui.cpp:429
+#: avidemux/gtk_gui.cpp:442
 msgid ""
 "This is to be used to undo packed VOP on MPEG-4.\n"
 "Continue ?"
 msgstr ""
-"???MPEG4?????vop??????????.\n"
+"???MPEG4?????VOP??????????.\n"
 "???????"
 
-#: avidemux/gtk_gui.cpp:431
+#: avidemux/gtk_gui.cpp:444
 msgid "Select AVI File to Write"
 msgstr "???AVI???????"
 
-#: avidemux/gtk_gui.cpp:437
+#: avidemux/gtk_gui.cpp:450
 msgid "Select OGM File to Write"
 msgstr "???OGM???????"
 
-#: avidemux/gtk_gui.cpp:448
-#: avidemux/gtk_gui.cpp:459
+#: avidemux/gtk_gui.cpp:461
+#: avidemux/gtk_gui.cpp:472
 msgid "Select Workbench to Save"
 msgstr "?????????????"
 
-#: avidemux/gtk_gui.cpp:483
+#: avidemux/gtk_gui.cpp:496
 msgid "Select Raw File to Save"
 msgstr "????raw???????"
 
-#: avidemux/gtk_gui.cpp:499
+#: avidemux/gtk_gui.cpp:512
 msgid "Select AVI File to Append..."
 msgstr "????AVI???????..."
 
-#: avidemux/gtk_gui.cpp:503
+#: avidemux/gtk_gui.cpp:516
 msgid "Select File to Save Audio"
 msgstr "??????????????"
 
-#: avidemux/gtk_gui.cpp:537
+#: avidemux/gtk_gui.cpp:550
 msgid "Select JPEG Sequence to Save"
 msgstr "????JPEG?????"
 
-#: avidemux/gtk_gui.cpp:540
+#: avidemux/gtk_gui.cpp:553
 msgid "Select BMP to Save"
 msgstr "????BMP???"
 
-#: avidemux/gtk_gui.cpp:544
+#: avidemux/gtk_gui.cpp:557
 msgid "Select JPEG to Save"
 msgstr "????JPEG???"
 
-#: avidemux/gtk_gui.cpp:597
-#: avidemux/gtk_gui.cpp:709
+#: avidemux/gtk_gui.cpp:610
+#: avidemux/gtk_gui.cpp:714
 msgid "Select File to Save"
 msgstr "???????????"
 
-#: avidemux/gtk_gui.cpp:649
+#: avidemux/gtk_gui.cpp:654
 msgid "Select MP3 to Load"
 msgstr "???MP3???"
 
-#: avidemux/gtk_gui.cpp:652
+#: avidemux/gtk_gui.cpp:657
 msgid "Select AC3 to Load"
 msgstr "???AC3???"
 
-#: avidemux/gtk_gui.cpp:655
+#: avidemux/gtk_gui.cpp:660
 msgid "Select WAV to Load"
 msgstr "???WAV???"
 
-#: avidemux/gtk_gui.cpp:703
+#: avidemux/gtk_gui.cpp:708
 msgid "Out of bounds"
 msgstr "???"
 
-#: avidemux/gtk_gui.cpp:714
-#: avidemux/gtk_gui.cpp:1905
+#: avidemux/gtk_gui.cpp:719
+#: avidemux/gtk_gui.cpp:1915
 msgid "Marker A > B"
 msgstr "???? A?>?B"
 
-#: avidemux/gtk_gui.cpp:714
+#: avidemux/gtk_gui.cpp:719
 msgid "Cannot copy."
 msgstr "????????."
 
-#: avidemux/gtk_gui.cpp:726
+#: avidemux/gtk_gui.cpp:731
 msgid "Something bad happened (II))"
 msgstr "???????????? (II)"
 
-#: avidemux/gtk_gui.cpp:740
+#: avidemux/gtk_gui.cpp:745
 msgid "Are you sure?"
 msgstr "???????"
 
-#: avidemux/gtk_gui.cpp:795
+#: avidemux/gtk_gui.cpp:800
 msgid "Frame Rate"
 msgstr "???????"
 
-#: avidemux/gtk_gui.cpp:795
+#: avidemux/gtk_gui.cpp:800
 msgid "_Frames per second:"
 msgstr "????/?(_F):"
 
-#: avidemux/gtk_gui.cpp:818
+#: avidemux/gtk_gui.cpp:823
 msgid "Width is not a multiple of 8"
 msgstr "?? 8 ??????????"
 
-#: avidemux/gtk_gui.cpp:819
+#: avidemux/gtk_gui.cpp:824
 msgid "This will make trouble for AVI files."
 msgstr "???AVI?????????????."
 
-#: avidemux/gtk_gui.cpp:829
+#: avidemux/gtk_gui.cpp:834
 msgid "Rebuild all Keyframes?"
 msgstr "???????????????????"
 
-#: avidemux/gtk_gui.cpp:887
+#: avidemux/gtk_gui.cpp:892
 msgid "Permission error"
 msgstr "??????? ???"
 
-#: avidemux/gtk_gui.cpp:890
+#: avidemux/gtk_gui.cpp:895
 #, possible-c-format
 msgid "\"%s\" does not exist."
 msgstr "\"%s\" ??????."
 
-#: avidemux/gtk_gui.cpp:932
+#: avidemux/gtk_gui.cpp:937
 msgid "Cannot open project using the video loader."
 msgstr "????????????????????????."
 
-#: avidemux/gtk_gui.cpp:933
+#: avidemux/gtk_gui.cpp:938
 msgid "Try 'File' -> 'Load/Run Project...'"
 msgstr "'????' -> '??????????/??'?????????"
 
-#: avidemux/gtk_gui.cpp:935
+#: avidemux/gtk_gui.cpp:940
 msgid "Could not open the file"
 msgstr "??????????"
 
-#: avidemux/gtk_gui.cpp:970
+#: avidemux/gtk_gui.cpp:975
 msgid "Multiple Audio Tracks"
 msgstr "?????????"
 
-#: avidemux/gtk_gui.cpp:970
+#: avidemux/gtk_gui.cpp:975
 msgid ""
 "The file you just loaded contains several audio tracks.\n"
 "Go to Audio->MainTrack to select the active one."
@@ -6284,281 +6337,281 @@
 "???????????????????????????.\n"
 "??->????? ???????????????????."
 
-#: avidemux/gtk_gui.cpp:1060
+#: avidemux/gtk_gui.cpp:1065
 msgid "No audio decoder found for this file"
 msgstr "??????????????????????"
 
-#: avidemux/gtk_gui.cpp:1061
+#: avidemux/gtk_gui.cpp:1066
 msgid "Save (A+V) will generate bad AVI. Save audio will work."
 msgstr "(A+V)?????AVI???????. ??????????."
 
-#: avidemux/gtk_gui.cpp:1117
+#: avidemux/gtk_gui.cpp:1122
 msgid "Something failed when appending"
 msgstr "?????????????"
 
-#: avidemux/gtk_gui.cpp:1126
-#: avidemux/gtk_gui.cpp:1924
+#: avidemux/gtk_gui.cpp:1131
+#: avidemux/gtk_gui.cpp:1934
 msgid "Something bad happened (II)"
 msgstr "???????????? (II)"
 
-#: avidemux/gtk_gui.cpp:1190
+#: avidemux/gtk_gui.cpp:1195
 msgid "Cannot save the audio in copy mode"
 msgstr "?????????????????"
 
-#: avidemux/gtk_gui.cpp:1190
+#: avidemux/gtk_gui.cpp:1195
 msgid "Select WAV PCM as the audio codec, otherwise the audio file would be raw PCM."
 msgstr "WAV PCM?????????????????. ??????????????raw PCM?????."
 
-#: avidemux/gtk_gui.cpp:1198
-#: avidemux/gtk_gui.cpp:1554
+#: avidemux/gtk_gui.cpp:1203
+#: avidemux/gtk_gui.cpp:1556
 msgid "Saving audio"
 msgstr "?????"
 
-#: avidemux/gtk_gui.cpp:1275
+#: avidemux/gtk_gui.cpp:1280
 msgid "Get Frame"
 msgstr "???????"
 
-#: avidemux/gtk_gui.cpp:1275
+#: avidemux/gtk_gui.cpp:1280
 msgid "Cannot get this frame to save"
 msgstr "???????????????"
 
-#: avidemux/gtk_gui.cpp:1312
+#: avidemux/gtk_gui.cpp:1317
 msgid "Mark A > B"
 msgstr "??? A > B"
 
-#: avidemux/gtk_gui.cpp:1312
+#: avidemux/gtk_gui.cpp:1317
 msgid "Set your markers correctly."
 msgstr "???????????????."
 
-#: avidemux/gtk_gui.cpp:1321
+#: avidemux/gtk_gui.cpp:1326
 msgid "Saving as set of jpegs"
 msgstr "JPEG??????"
 
-#: avidemux/gtk_gui.cpp:1327
+#: avidemux/gtk_gui.cpp:1332
 msgid "Cannot decode frame"
 msgstr "??????????????"
 
-#: avidemux/gtk_gui.cpp:1327
+#: avidemux/gtk_gui.cpp:1332
 msgid "Aborting."
 msgstr "???????."
 
-#: avidemux/gtk_gui.cpp:1338
-#: avidemux/gtk_gui.cpp:1357
-#: avidemux/gtk_gui.cpp:2268
+#: avidemux/gtk_gui.cpp:1343
+#: avidemux/gtk_gui.cpp:1362
+#: avidemux/gtk_gui.cpp:2278
 msgid "Done"
 msgstr "??"
 
-#: avidemux/gtk_gui.cpp:1338
+#: avidemux/gtk_gui.cpp:1343
 #, possible-c-format
 msgid "Saved %d images."
 msgstr "%d ?????."
 
-#: avidemux/gtk_gui.cpp:1340
+#: avidemux/gtk_gui.cpp:1345
 msgid "Error"
 msgstr "???"
 
-#: avidemux/gtk_gui.cpp:1340
+#: avidemux/gtk_gui.cpp:1345
 msgid "Could not save all images."
 msgstr "???????????"
 
-#: avidemux/gtk_gui.cpp:1357
+#: avidemux/gtk_gui.cpp:1362
 #, possible-c-format
 msgid "Saved \"%s\"."
 msgstr "\"%s\" ???."
 
-#: avidemux/gtk_gui.cpp:1359
+#: avidemux/gtk_gui.cpp:1364
 msgid "BMP op failed"
 msgstr "BMP op ??"
 
-#: avidemux/gtk_gui.cpp:1359
+#: avidemux/gtk_gui.cpp:1364
 #, possible-c-format
 msgid "Saving %s as a BMP file failed."
 msgstr "%s ?BMP?????????????????."
 
-#: avidemux/gtk_gui.cpp:1379
-#: avidemux/gtk_gui.cpp:1445
+#: avidemux/gtk_gui.cpp:1384
+#: avidemux/gtk_gui.cpp:1450
 msgid "Failed to open the file"
 msgstr "???????????"
 
-#: avidemux/gtk_gui.cpp:1379
-#: avidemux/gtk_gui.cpp:1445
+#: avidemux/gtk_gui.cpp:1384
+#: avidemux/gtk_gui.cpp:1450
 msgid "Not a WAV file?"
 msgstr "WAV??????????"
 
-#: avidemux/gtk_gui.cpp:1380
+#: avidemux/gtk_gui.cpp:1385
 #, c-format
 msgid "WAV open file failed..."
 msgstr "WAV???????????..."
 
-#: avidemux/gtk_gui.cpp:1515
+#: avidemux/gtk_gui.cpp:1517
 msgid "Cannot decompress audio frame"
 msgstr "??????????????"
 
-#: avidemux/gtk_gui.cpp:1529
+#: avidemux/gtk_gui.cpp:1531
 msgid "Memory Error"
 msgstr "??????"
 
-#: avidemux/gtk_gui.cpp:1575
+#: avidemux/gtk_gui.cpp:1577
 msgid "No frames to encode"
 msgstr "?????????????????"
 
-#: avidemux/gtk_gui.cpp:1575
+#: avidemux/gtk_gui.cpp:1577
 msgid "Please check markers. Is \"A>\" == \">B\"?"
 msgstr "????????????. \"A>\" == \">B\" ??? ?"
 
-#: avidemux/gtk_gui.cpp:1694
+#: avidemux/gtk_gui.cpp:1704
 msgid "Saving raw video stream"
 msgstr "raw ???????????"
 
-#: avidemux/gtk_gui.cpp:1840
+#: avidemux/gtk_gui.cpp:1850
 msgid "Checking video"
 msgstr "????????"
 
-#: avidemux/gtk_gui.cpp:1856
+#: avidemux/gtk_gui.cpp:1866
 msgid "No error found"
 msgstr "???????????"
 
-#: avidemux/gtk_gui.cpp:1860
+#: avidemux/gtk_gui.cpp:1870
 #, c-format
 msgid "Errors found in %u frames"
 msgstr "%u ????????????????"
 
-#: avidemux/gtk_gui.cpp:1878
+#: avidemux/gtk_gui.cpp:1888
 msgid "Cannot decompress the audio stream"
 msgstr "???????????????"
 
-#: avidemux/gtk_gui.cpp:1878
+#: avidemux/gtk_gui.cpp:1888
 msgid "Switch audio codec to Copy."
 msgstr "?????????????????."
 
-#: avidemux/gtk_gui.cpp:1905
+#: avidemux/gtk_gui.cpp:1915
 msgid "Cannot delete the selection."
 msgstr "??????????."
 
-#: avidemux/gtk_gui.cpp:1910
+#: avidemux/gtk_gui.cpp:1920
 msgid "You can't remove all frames"
 msgstr "?????????????"
 
-#: avidemux/gtk_gui.cpp:1986
+#: avidemux/gtk_gui.cpp:1996
 msgid "Could not get tracks info"
 msgstr "?????????????"
 
-#: avidemux/gtk_gui.cpp:1994
+#: avidemux/gtk_gui.cpp:2004
 msgid "Video"
 msgstr "??"
 
-#: avidemux/gtk_gui.cpp:1994
+#: avidemux/gtk_gui.cpp:2004
 msgid "Take audio from video file"
 msgstr "?????????????"
 
-#: avidemux/gtk_gui.cpp:1995
-#: avidemux/gtk_gui.cpp:2094
+#: avidemux/gtk_gui.cpp:2005
+#: avidemux/gtk_gui.cpp:2104
 msgid "No audio"
 msgstr "????"
 
-#: avidemux/gtk_gui.cpp:1996
-#: avidemux/gtk_gui.cpp:2095
+#: avidemux/gtk_gui.cpp:2006
+#: avidemux/gtk_gui.cpp:2105
 msgid "External AC3"
 msgstr "??AC3"
 
-#: avidemux/gtk_gui.cpp:1996
-#: avidemux/gtk_gui.cpp:2095
+#: avidemux/gtk_gui.cpp:2006
+#: avidemux/gtk_gui.cpp:2105
 msgid "Take audio from external AC3 file"
 msgstr "??AC3???????????"
 
-#: avidemux/gtk_gui.cpp:1997
-#: avidemux/gtk_gui.cpp:2096
+#: avidemux/gtk_gui.cpp:2007
+#: avidemux/gtk_gui.cpp:2106
 msgid "External MP3"
 msgstr "??MP3"
 
-#: avidemux/gtk_gui.cpp:1997
-#: avidemux/gtk_gui.cpp:2096
+#: avidemux/gtk_gui.cpp:2007
+#: avidemux/gtk_gui.cpp:2106
 msgid "Take audio from external MP3 file"
 msgstr "??MP3???????????"
 
-#: avidemux/gtk_gui.cpp:1998
-#: avidemux/gtk_gui.cpp:2097
+#: avidemux/gtk_gui.cpp:2008
+#: avidemux/gtk_gui.cpp:2107
 msgid "External WAV"
 msgstr "??WAV"
 
-#: avidemux/gtk_gui.cpp:1998
-#: avidemux/gtk_gui.cpp:2097
+#: avidemux/gtk_gui.cpp:2008
+#: avidemux/gtk_gui.cpp:2107
 msgid "Take audio from external WAV file"
 msgstr "??WAV???????????"
 
-#: avidemux/gtk_gui.cpp:2002
-#: avidemux/gtk_gui.cpp:2102
+#: avidemux/gtk_gui.cpp:2012
+#: avidemux/gtk_gui.cpp:2112
 msgid "_Audio source:"
 msgstr "?????(_A):"
 
-#: avidemux/gtk_gui.cpp:2006
-#: avidemux/gtk_gui.cpp:2103
+#: avidemux/gtk_gui.cpp:2016
+#: avidemux/gtk_gui.cpp:2113
 msgid "_External file:"
 msgstr "??????(_E):"
 
-#: avidemux/gtk_gui.cpp:2021
+#: avidemux/gtk_gui.cpp:2031
 msgid "_Track from video:"
 msgstr "?????????(_T):"
 
-#: avidemux/gtk_gui.cpp:2031
+#: avidemux/gtk_gui.cpp:2041
 msgid "Main Audio Track"
 msgstr "???????"
 
-#: avidemux/gtk_gui.cpp:2037
-#: avidemux/gtk_gui.cpp:2115
+#: avidemux/gtk_gui.cpp:2047
+#: avidemux/gtk_gui.cpp:2125
 msgid "Cannot load"
 msgstr "??????"
 
-#: avidemux/gtk_gui.cpp:2037
-#: avidemux/gtk_gui.cpp:2115
+#: avidemux/gtk_gui.cpp:2047
+#: avidemux/gtk_gui.cpp:2125
 msgid "The selected audio file does not exist."
 msgstr "?????????????????"
 
-#: avidemux/gtk_gui.cpp:2112
+#: avidemux/gtk_gui.cpp:2122
 msgid "Second Audio Track"
 msgstr "????????"
 
-#: avidemux/gtk_gui.cpp:2144
+#: avidemux/gtk_gui.cpp:2154
 msgid "Error loading the MP3 file"
 msgstr "MP3??????????"
 
-#: avidemux/gtk_gui.cpp:2153
-#: avidemux/gtk_gui.cpp:2175
-#: avidemux/gtk_gui.cpp:2197
+#: avidemux/gtk_gui.cpp:2163
+#: avidemux/gtk_gui.cpp:2185
+#: avidemux/gtk_gui.cpp:2207
 msgid "Second track loaded"
 msgstr "?????????????"
 
-#: avidemux/gtk_gui.cpp:2167
+#: avidemux/gtk_gui.cpp:2177
 msgid "Error loading the AC3 file"
 msgstr "AC3??????????"
 
-#: avidemux/gtk_gui.cpp:2189
+#: avidemux/gtk_gui.cpp:2199
 msgid "Error loading the WAV file"
 msgstr "WAV??????????"
 
-#: avidemux/gtk_gui.cpp:2256
+#: avidemux/gtk_gui.cpp:2266
 msgid "Saving failed"
 msgstr "?????"
 
-#: avidemux/gtk_gui.cpp:2256
+#: avidemux/gtk_gui.cpp:2266
 msgid "Saving the job failed. Maybe you have permission issue with ~/.avidemux"
 msgstr "?????????. ~/.avidemux ?????????????"
 
-#: avidemux/gtk_gui.cpp:2268
+#: avidemux/gtk_gui.cpp:2278
 #, possible-c-format
 msgid "File %s has been successfully saved."
 msgstr "???? %s ??????????."
 
-#: avidemux/gtk_gui.cpp:2272
+#: avidemux/gtk_gui.cpp:2282
 #, possible-c-format
 msgid "File %s was NOT saved correctly."
 msgstr "???? %s ????????????."
 
-#: avidemux/gtk_gui.cpp:2426
+#: avidemux/gtk_gui.cpp:2436
 msgid "AvsProxy"
 msgstr "AvsProxy"
 
-#: avidemux/gtk_gui.cpp:2426
+#: avidemux/gtk_gui.cpp:2436
 msgid ""
 "Failed to connect to avsproxy.\n"
 "Is it running ?"
@@ -6566,23 +6619,23 @@
 "AvsProxy???????.\n"
 "??????????? ?"
 
-#: avidemux/gtk_gui.cpp:2431
+#: avidemux/gtk_gui.cpp:2441
 msgid "avsproxy"
 msgstr "AvsProxy"
 
-#: avidemux/gtk_gui.cpp:2459
+#: avidemux/gtk_gui.cpp:2469
 msgid "Frame type:"
 msgstr "???????:"
 
-#: avidemux/gtk_gui.cpp:2460
+#: avidemux/gtk_gui.cpp:2470
 msgid "Frame size:"
 msgstr "???????:"
 
-#: avidemux/gtk_gui.cpp:2462
+#: avidemux/gtk_gui.cpp:2472
 msgid "Frame Hex Dump"
 msgstr "????16????"
 
-#: avidemux/guiplay.cpp:365
+#: avidemux/guiplay.cpp:361
 msgid "Trouble initializing audio device"
 msgstr "?????????????"
 
@@ -6607,38 +6660,38 @@
 "PSP????????????????."
 
 #: avidemux/GUI_jobs.cpp:37
-msgid "Something very wrong happened when buildint joblist"
+msgid "Something very wrong happened when building joblist."
 msgstr "??????????????????????????"
 
 #: avidemux/GUI_jobs.cpp:42
 msgid "There are no jobs stored"
 msgstr "?????????"
 
-#: avidemux/gui_navigate.cpp:75
-#: avidemux/gui_navigate.cpp:113
-#: avidemux/gui_navigate.cpp:389
-#: avidemux/gui_navigate.cpp:425
+#: avidemux/gui_navigate.cpp:76
+#: avidemux/gui_navigate.cpp:114
+#: avidemux/gui_navigate.cpp:390
+#: avidemux/gui_navigate.cpp:426
 msgid "Decompressing error"
 msgstr "??(decompression)???"
 
-#: avidemux/gui_navigate.cpp:75
+#: avidemux/gui_navigate.cpp:76
 msgid "Cannot decode next frame."
 msgstr "????????????????"
 
-#: avidemux/gui_navigate.cpp:113
-#: avidemux/gui_navigate.cpp:425
+#: avidemux/gui_navigate.cpp:114
+#: avidemux/gui_navigate.cpp:426
 msgid "Cannot decode keyframe."
 msgstr "????????????????"
 
-#: avidemux/gui_navigate.cpp:236
+#: avidemux/gui_navigate.cpp:237
 msgid "Seeking"
 msgstr "????"
 
-#: avidemux/gui_navigate.cpp:314
+#: avidemux/gui_navigate.cpp:315
 msgid "Finding black frames"
 msgstr "?????????"
 
-#: avidemux/gui_navigate.cpp:389
+#: avidemux/gui_navigate.cpp:390
 msgid "Cannot decode the frame."
 msgstr "????????????????"
 
@@ -6690,7 +6743,7 @@
 ##### I added below
 ############## Preferences
 msgid "Automation"
-msgstr "??"
+msgstr "???"
 
 msgid "Audio"
 msgstr "??"



From gruntster at mail.berlios.de  Mon Jul 23 03:54:21 2007
From: gruntster at mail.berlios.de (gruntster at mail.berlios.de)
Date: Mon, 23 Jul 2007 03:54:21 +0200
Subject: [Avidemux-svn-commit] r3435 - branches/avidemux_2.4_branch/avidemux
Message-ID: <200707230154.l6N1sLbF024776@sheep.berlios.de>

Author: gruntster
Date: 2007-07-23 03:54:10 +0200 (Mon, 23 Jul 2007)
New Revision: 3435

Modified:
   branches/avidemux_2.4_branch/avidemux/avi_vars.h
   branches/avidemux_2.4_branch/avidemux/gtk_gui.cpp
Log:
fix r3410 & fix large leak when using second audio track

Modified: branches/avidemux_2.4_branch/avidemux/avi_vars.h
===================================================================
--- branches/avidemux_2.4_branch/avidemux/avi_vars.h	2007-07-22 17:44:51 UTC (rev 3434)
+++ branches/avidemux_2.4_branch/avidemux/avi_vars.h	2007-07-23 01:54:10 UTC (rev 3435)
@@ -55,7 +55,11 @@
 ;
 
 
-EXTERN AVDMGenericAudioStream *aviaudiostream;
+EXTERN AVDMGenericAudioStream *aviaudiostream
+#ifdef __DECLARE__
+=(AVDMGenericAudioStream *)NULL
+#endif
+;
 EXTERN AVDMGenericAudioStream *currentaudiostream
 #ifdef __DECLARE__
 =(AVDMGenericAudioStream *)NULL

Modified: branches/avidemux_2.4_branch/avidemux/gtk_gui.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/gtk_gui.cpp	2007-07-22 17:44:51 UTC (rev 3434)
+++ branches/avidemux_2.4_branch/avidemux/gtk_gui.cpp	2007-07-23 01:54:10 UTC (rev 3435)
@@ -69,11 +69,8 @@
 
 #include "ADM_libmpeg2enc/ADM_mpeg2enc.h"
 
-#include "ADM_filter/video_filters.h"
-
 #include "ADM_userInterfaces/ADM_commonUI/DIA_factory.h"
 
-#include "ADM_assert.h"
 void A_handleSecondTrack (int tracktype);
 int A_delete(uint32_t start, uint32_t end);
 void A_saveImg (char *name);
@@ -1035,28 +1032,7 @@
     }
   else
     {
-      /*
-      ** <JSC> Sat Feb 21 15:30:15 CET 2004
-      ** problem: second edl load will raise a crash
-      ** why: 1) the last run generates aviaudiostream [video_body->getAudioStream()]
-      **         which is set to currentaudiostream    [changeAudioStream()]
-      **      2) second call of video_body->getAudioStream() will free(aviaudiostream)
-      **         which is the same as free(currentaudiostream)
-      **      3) following changeAudioStream() call will use the free()'d memory
-      **         [currentaudiostream->isDestroyable()]
-      **      efence with EF_PROTECT_FREE=1 will raise SIGSEGV and show you
-      **      currentaudiostream is not accessable
-      **      warning: without efense it will crash somethere other
-      **
-      ** I'm not sure why aviaudiostream is global. This issue will not
-      ** occure if aviaudiostream is local and be lost at end of this block.
-      ** nasty workaround: only the raise condition will be fixed
-      */
-      if( currentaudiostream == aviaudiostream ){
-         aviaudiostream = NULL; // free of memory done in changeAudioStream()
-      }
-      /* </JSC> */
-      video_body->getAudioStream (&aviaudiostream);
+	  video_body->getAudioStream (&aviaudiostream);
       A_changeAudioStream (aviaudiostream, AudioAvi,NULL);
       if (aviaudiostream)
 	if (!aviaudiostream->isDecompressable ())
@@ -1468,11 +1444,6 @@
 {
   if (currentaudiostream)
     {
-       if (currentaudiostream->isDestroyable ())        
-      {
-          delete currentaudiostream;
-          currentaudiostream=NULL;
-      }
       currentAudioSource=AudioNone;
       if(currentAudioName) ADM_dealloc(currentAudioName);
       currentAudioName=NULL;
@@ -1639,19 +1610,30 @@
 		avifileinfo=NULL;
 	}
 
-	if (currentaudiostream)
+	if (aviaudiostream)
 	{
-	// always destroyable on exit           if(currentaudiostream->isDestroyable())
-		delete currentaudiostream;
-		currentaudiostream=NULL;
+		delete aviaudiostream;
+		aviaudiostream=NULL;
 	}
 
+	if (secondaudiostream)
+	{
+		delete secondaudiostream;
+		secondaudiostream=NULL;
+	}
+
 	if (currentAudioName)
 	{
 		ADM_dealloc(currentAudioName);
 		currentAudioName = NULL;
 	}
 
+	if (secondAudioName)
+	{
+		ADM_dealloc(secondAudioName);
+		secondAudioName = NULL;
+	}
+
 	if (actual_workbench_file)
 	{
 		ADM_dealloc(actual_workbench_file);
@@ -1664,6 +1646,7 @@
 		video_body=NULL;
 	}
 
+	currentaudiostream=NULL;
 	filterCleanUp();
 	admPreview::cleanUp();
 }
@@ -2412,8 +2395,17 @@
       avifileinfo = (aviInfo *) NULL;
       video_body->cleanup ();
       curframe = 0;
-      currentaudiostream=NULL;
       A_changeAudioStream (NULL, AudioNone,NULL);
+
+	  if (aviaudiostream)
+		delete aviaudiostream;
+
+	  if (secondaudiostream)
+		delete secondaudiostream;
+
+	  aviaudiostream=NULL;
+	  secondaudiostream=NULL;
+
       filterCleanUp ();
       return 1;
     }



From mean at mail.berlios.de  Mon Jul 23 08:21:43 2007
From: mean at mail.berlios.de (mean at BerliOS)
Date: Mon, 23 Jul 2007 08:21:43 +0200
Subject: [Avidemux-svn-commit] r3436 - in
	branches/avidemux_2.4_branch/avidemux:
	ADM_libraries/ADM_utilities ADM_userInterfaces/ADM_commonUI
	ADM_videoFilter
Message-ID: <200707230621.l6N6Lhba021713@sheep.berlios.de>

Author: mean
Date: 2007-07-23 08:21:42 +0200 (Mon, 23 Jul 2007)
New Revision: 3436

Added:
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_tsSub.cpp
Modified:
   branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_utilities/ADM_image.h
   branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_utilities/ADM_imageUtils.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/CMakeLists.txt
   branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/ADM_vidDvbSub.cpp
Log:
[DVBSUB] Handle chroma, add reduceby2 to image

Modified: branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_utilities/ADM_image.h
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_utilities/ADM_image.h	2007-07-23 01:54:10 UTC (rev 3435)
+++ branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_utilities/ADM_image.h	2007-07-23 06:21:42 UTC (rev 3436)
@@ -112,7 +112,7 @@
 		ADMImage(uint32_t width, uint32_t height);
                 ADMImage(uint32_t width, uint32_t height,uint32_t dummy); /// To create linked datas image        
 
-                
+                uint8_t   LumaReduceBy2(void);
 		~ADMImage();
         uint8_t getWidthHeight(uint32_t *w,uint32_t *h)
                     {

Modified: branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_utilities/ADM_imageUtils.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_utilities/ADM_imageUtils.cpp	2007-07-23 01:54:10 UTC (rev 3435)
+++ branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_utilities/ADM_imageUtils.cpp	2007-07-23 06:21:42 UTC (rev 3436)
@@ -487,4 +487,31 @@
         delete [] buffer;
         return 1;
 }
+/**
+      \fn LumaReduceBy2
+      \brief Very simple reduce by 2 both hz & vz for luma plane only.
+*/
+ uint8_t   ADMImage::LumaReduceBy2(void)
+{
+  uint8_t *ptr1,*ptr2,*outptr;
+  for(int y=0;y<_height>>1;y++)
+  {
+    
+    ptr1=data+y*_width*2;
+    ptr2=ptr1+_width;
+    outptr=data+(_width>>1)*y;
+    for(int x=0;x<_width>>1;x++)
+    {
+      uint32_t a,b,c,d;  
+          a=ptr1[0]+ptr1[1];
+          b=ptr2[0]+ptr2[1];
+          ptr1+=2;
+          ptr2+=2;
+          a=(a+b)>>2;
+          *outptr++=a;
+    }
+  }
+  return 1;
+  
+}
 //EOF

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/CMakeLists.txt
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/CMakeLists.txt	2007-07-23 01:54:10 UTC (rev 3435)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/CMakeLists.txt	2007-07-23 06:21:42 UTC (rev 3436)
@@ -9,7 +9,7 @@
 DIA_audioFilter.cpp   DIA_enter.cpp           DIA_flyCrop.cpp      DIA_gototime.cpp    DIA_postproc.cpp  DIA_srt.cpp        GUI_render.cpp
 DIA_bitrateHisto.cpp  DIA_flyAsharp.cpp       DIA_flyDialog.cpp    DIA_lavcodec.cpp    DIA_prefs.cpp     DIA_SVCD.cpp       GUI_sdlRender.cpp
 DIA_builtin.cpp       DIA_flyChromaShift.cpp  DIA_flyHue.cpp       DIA_lavDecoder.cpp  DIA_requant.cpp   DIA_tdeint.cpp     GUI_xvRender.cpp
-DIA_animated.cpp      DIA_ocr.cpp
+DIA_animated.cpp      DIA_ocr.cpp DIA_tsSub.cpp
 )
 ADD_LIBRARY(${ADM_LIB} STATIC ${${ADM_LIB}_SRCS})
 ADD_ADM_LIB(${ADM_LIB} ADM_userInterfaces)

Copied: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_tsSub.cpp (from rev 3422, branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_v2v.cpp)
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_v2v.cpp	2007-07-21 03:38:04 UTC (rev 3422)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_tsSub.cpp	2007-07-23 06:21:42 UTC (rev 3436)
@@ -0,0 +1,102 @@
+/***************************************************************************
+                          GUI_mux.h  -  description
+                             -------------------
+    begin                : Wed Jul 3 2002
+    copyright            : (C) 2002 by mean
+    email                : fixounet at free.fr
+ ***************************************************************************/
+
+/***************************************************************************
+ *                                                                         *
+ *   This program is free software; you can redistribute it and/or modify  *
+ *   it under the terms of the GNU General Public License as published by  *
+ *   the Free Software Foundation; either version 2 of the License, or     *
+ *   (at your option) any later version.                                   *
+ *                                                                         *
+ ***************************************************************************/
+# include "config.h"
+
+#include <sys/types.h>
+#include <sys/stat.h>
+#include <unistd.h>
+#include <string.h>
+#include <stdio.h>
+
+# include <math.h>
+#include "ADM_lavcodec.h"
+#include "default.h"
+#include "ADM_toolkit/toolkit.hxx"
+#include "ADM_toolkit/filesel.h"
+#include "DIA_factory.h"
+#include "ADM_mpegdemuxer/dmx_mpegstartcode.h"
+#include "ADM_mpegdemuxer/dmx_demuxerTS.h"
+
+#include "ADM_colorspace/colorspace.h"
+#include "ADM_codecs/ADM_codec.h"
+#include "ADM_codecs/ADM_ffmp43.h"
+
+
+/**
+      \fn DIA_tsSubs
+      \brief  Convert TS subs to something different
+*/
+uint8_t  DIA_tsSub(void)
+{
+uint8_t ret=0;
+const char  *tsFileName="/capture/grey/Grey_anatomy_2007_05_22_Avec_Le_Temp.mpg";
+uint32_t pid=0x96;
+uint8_t  packetBuffer[64*1024];
+uint32_t packetLen;
+uint32_t pts,dts;
+
+    // Prepare our decoder
+    decoderFFSubs *decoder=new decoderFFSubs(1);
+
+    //
+    ADMCompressedImage *binary=new ADMCompressedImage;
+    AVSubtitle  sub;
+    
+    // 
+    MPEG_TRACK track;
+    track.pid=pid;
+    // First create our demuxer
+     dmx_demuxerTS *demuxer=new dmx_demuxerTS(1,&track,0,DMX_MPG_TS);
+     if(!demuxer->open(tsFileName)) goto nd;
+     binary->data=packetBuffer+2;
+     memset(&sub,0,sizeof(sub));
+     while(demuxer->readPes(packetBuffer,&packetLen, &dts,&pts))
+     {
+       printf("Found packet : %u \n",packetLen);
+       binary->dataLength=packetLen-3; // -2 for stream iD, -1 for ????
+       if(packetLen>5)
+       {
+        decoder->uncompress(binary,&sub);
+        
+        // And now cleanup the subs
+        printf("Found %d rects to process\n",sub.num_rects);
+        for(int i=0;i<sub.num_rects;i++)
+        {
+          AVSubtitleRect *r=&(sub.rects[i]); 
+              printf("x :%d\n",r->x);
+              printf("y :%d\n",r->y);
+              printf("w :%d\n",r->w);
+              printf("h :%d\n",r->h);
+              // rgba_palette
+              // Bitmap
+        }
+       }
+       
+     }
+// Inlined
+
+nd:
+      delete demuxer;
+      demuxer=NULL;
+      delete decoder;
+      decoder=NULL;
+      delete binary;
+      binary=NULL;
+      return ret;
+}
+//EOF
+

Modified: branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/ADM_vidDvbSub.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/ADM_vidDvbSub.cpp	2007-07-23 01:54:10 UTC (rev 3435)
+++ branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/ADM_vidDvbSub.cpp	2007-07-23 06:21:42 UTC (rev 3436)
@@ -190,12 +190,14 @@
               for(int col=0;col<r->nb_colors;col++)
               {
                     // Color is RGB, convert to YUV
-                    uint32_t y,a;
+                    uint32_t y,u,v,a;
                     uint32_t rgb=r->rgba_palette[col];
                 
                           y=rgba2y(rgb);
+                          u=rgba2u(rgb)&0xff;
+                          v=rgba2v(rgb)&0xff;
                           a=_a(rgb);
-                          r->rgba_palette[col]=y+(a<<8);
+                          r->rgba_palette[col]=y+(u<<8)+(v<<16)+(a<<24);
                           printf("Color %d, alpha %u luma %u rgb:%x\n",col,a,y,rgb);
               }
               // Palette is ready, display !
@@ -216,24 +218,28 @@
                       clipH=FFMIN(_info.height,r->y+r->h)-r->y;
                       
                       ADMImage image(r->w,r->h);
+                      ADMImage imageU(r->w,r->h);
+                      ADMImage imageV(r->w,r->h);
                       ADMImage alphaImage(r->w,r->h);
                       
                       uint8_t *ptr=image.data;
+                      uint8_t *ptrU=imageU.data;
+                      uint8_t *ptrV=imageV.data;
                       uint8_t *ptrAlpha=alphaImage.data;
                       uint8_t *in=r->bitmap;
                       for(int yy=0;yy<r->h;yy++)
                       {
                           for(int xx=0;xx<r->w;xx++)
                           {
-                            uint32_t alpha;
+                            uint32_t alpha,valout;
                             uint32_t val=*in++;
                             
                                   val=r->rgba_palette[val];
-                                  alpha=val>>8;
-                                  val&=0xff;
                                   
-                                  *ptr++=val;
-                                  *ptrAlpha++=alpha;
+                                  *ptrAlpha++=(val>>24)&0xff;
+                                  *ptr++=(val&0xff);;
+                                  *ptrU++=(val>>8)&0xff;
+                                  *ptrV++=(val>>16)&0xff;
                           }
                       }
               
@@ -259,6 +265,55 @@
                                   *org++=val;
                           }
                       }
+                      // Shrink alpha  & u & v
+                     alphaImage.LumaReduceBy2();
+                     imageU.LumaReduceBy2();
+                     imageV.LumaReduceBy2();
+                     r->x>>=1;
+                     r->y>>=1;
+                     r->w>>=1;
+                     r->h>>=1;
+                     clipH>>=1;
+                     clipW>>=1;
+                     
+                     
+                      uint8_t *orgU=(uint8_t *)(UPLANE(data)+(r->y)*(_info.width>>1)+(r->x));
+                      uint8_t *orgV=(uint8_t *)(VPLANE(data)+(r->y)*(_info.width>>1)+(r->x));
+#if 1
+                      // Merge
+                      for(int yy=0;yy<clipH;yy++)
+                      {
+                          ptrAlpha=alphaImage.data+yy*(r->w);
+                          ptrU=imageU.data+yy*r->w;
+                          ptrV=imageV.data+yy*r->w;
+                        
+                          for(int xx=0;xx<clipW;xx++)
+                          {
+                            uint32_t val,valU,valV,before,alpha;
+                            uint32_t newU,newV;
+                                  
+                                  newU=*ptrU++;
+                                  newV=*ptrV++;  // New color
+                                 
+                                   newU=(newU+newV)/2;
+                                   newV=newU;
+                                  
+                                  alpha=*ptrAlpha++;
+                                  
+                                  before=*orgU; // old color
+                                  valU=newU*alpha+(255-alpha)*before;
+                                  
+                                  before=*orgV;
+                                  valV=newV*alpha+(255-alpha)*before;
+                                  
+                                  valU=valU>>8;
+                                  valV=valV>>8;
+                                  
+                                  *orgU++=valU;
+                                  *orgV++=valV;
+                          }
+                      }
+#endif
               }
                // Delete palette & data
 _skip:
@@ -273,7 +328,7 @@
 uint8_t	ADMVideoSubDVB::getCoupledConf(CONFcouple **conf) 
 {
 
-        *conf=NULL; //new CONFcouple(0);
+        *conf=new CONFcouple(0);
 #if 0
 #define _COUPLE_SET(x) (*conf)->setCouple(#x, _params->x);
         _COUPLE_SET(font_scale)



From mean at mail.berlios.de  Mon Jul 23 08:25:42 2007
From: mean at mail.berlios.de (mean at BerliOS)
Date: Mon, 23 Jul 2007 08:25:42 +0200
Subject: [Avidemux-svn-commit] r3437 -
	branches/avidemux_2.4_branch/avidemux/ADM_videoFilter
Message-ID: <200707230625.l6N6PgCU021929@sheep.berlios.de>

Author: mean
Date: 2007-07-23 08:25:42 +0200 (Mon, 23 Jul 2007)
New Revision: 3437

Modified:
   branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/Makefile.am
Log:
[AUTOMAKE] update with dvb

Modified: branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/Makefile.am
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/Makefile.am	2007-07-23 06:21:42 UTC (rev 3436)
+++ branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/Makefile.am	2007-07-23 06:25:42 UTC (rev 3437)
@@ -61,7 +61,8 @@
  ADM_vidRotate.cpp \
  ADM_vidYadif.cpp \
  ADM_vidYadif_asm.c \
- ADM_vidAnimated.cpp
+ ADM_vidAnimated.cpp \
+ ADM_vidDvbSub.cpp
 			
 
 



From mean at mail.berlios.de  Mon Jul 23 08:31:10 2007
From: mean at mail.berlios.de (mean at BerliOS)
Date: Mon, 23 Jul 2007 08:31:10 +0200
Subject: [Avidemux-svn-commit] r3438 -
	branches/avidemux_2.4_branch/avidemux/ADM_colorspace
Message-ID: <200707230631.l6N6VAIw022284@sheep.berlios.de>

Author: mean
Date: 2007-07-23 08:31:10 +0200 (Mon, 23 Jul 2007)
New Revision: 3438

Modified:
   branches/avidemux_2.4_branch/avidemux/ADM_colorspace/ADM_rgb.cpp
Log:
Dont crash when cleaning up and no video loaded

Modified: branches/avidemux_2.4_branch/avidemux/ADM_colorspace/ADM_rgb.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_colorspace/ADM_rgb.cpp	2007-07-23 06:25:42 UTC (rev 3437)
+++ branches/avidemux_2.4_branch/avidemux/ADM_colorspace/ADM_rgb.cpp	2007-07-23 06:31:10 UTC (rev 3438)
@@ -98,7 +98,7 @@
     CLEANUP();
     FLAGS();
     PixelFormat fmt=TARGET_COLORSPACE;
-   
+    if(!ww || !hh) return 0;   
 	 _context=(void *)sws_getContext(
                       ww,hh,
                       PIX_FMT_YUV420P ,
@@ -275,7 +275,7 @@
  int flags=0;
 	CLEANUP();
     FLAGS();
-   
+   if(!ww || !hh) return 0;
 	 _context=(void *)sws_getContext(
 				    		ww,hh,
 						PIX_FMT_YUV420P ,



From mean at mail.berlios.de  Mon Jul 23 21:01:44 2007
From: mean at mail.berlios.de (mean at BerliOS)
Date: Mon, 23 Jul 2007 21:01:44 +0200
Subject: [Avidemux-svn-commit] r3439 - branches/avidemux_2.4_branch
Message-ID: <200707231901.l6NJ1imb021704@sheep.berlios.de>

Author: mean
Date: 2007-07-23 21:01:43 +0200 (Mon, 23 Jul 2007)
New Revision: 3439

Modified:
   branches/avidemux_2.4_branch/config.h.cmake
Log:
[CMAKE] Fix locales

Modified: branches/avidemux_2.4_branch/config.h.cmake
===================================================================
--- branches/avidemux_2.4_branch/config.h.cmake	2007-07-23 06:31:10 UTC (rev 3438)
+++ branches/avidemux_2.4_branch/config.h.cmake	2007-07-23 19:01:43 UTC (rev 3439)
@@ -13,7 +13,7 @@
 #cmakedefine ADM_BIG_ENDIAN
 
 #define PACKAGE   "avidemux"
-#define ADMLOCALE "${ADMLOCALE}"
+#define ADM_LOCALE "${ADM_LOCALE}"
 
 /* If we need to explictely link to iconv */
 #cmakedefine NEEED_LIBICONV



From mean at mail.berlios.de  Mon Jul 23 21:26:54 2007
From: mean at mail.berlios.de (mean at BerliOS)
Date: Mon, 23 Jul 2007 21:26:54 +0200
Subject: [Avidemux-svn-commit] r3440 - branches/avidemux_2.4_branch
Message-ID: <200707231926.l6NJQseI023191@sheep.berlios.de>

Author: mean
Date: 2007-07-23 21:26:54 +0200 (Mon, 23 Jul 2007)
New Revision: 3440

Modified:
   branches/avidemux_2.4_branch/config.h.cmake
Log:
[CMAKE] Correct fix

Modified: branches/avidemux_2.4_branch/config.h.cmake
===================================================================
--- branches/avidemux_2.4_branch/config.h.cmake	2007-07-23 19:01:43 UTC (rev 3439)
+++ branches/avidemux_2.4_branch/config.h.cmake	2007-07-23 19:26:54 UTC (rev 3440)
@@ -13,7 +13,7 @@
 #cmakedefine ADM_BIG_ENDIAN
 
 #define PACKAGE   "avidemux"
-#define ADM_LOCALE "${ADM_LOCALE}"
+#define ADMLOCALE "${ADM_LOCALE}"
 
 /* If we need to explictely link to iconv */
 #cmakedefine NEEED_LIBICONV



From gruntster at mail.berlios.de  Tue Jul 24 02:42:55 2007
From: gruntster at mail.berlios.de (gruntster at mail.berlios.de)
Date: Tue, 24 Jul 2007 02:42:55 +0200
Subject: [Avidemux-svn-commit] r3441 - in
	branches/avidemux_2.4_branch/avidemux: ADM_osSupport
	ADM_userInterfaces/ADM_GTK/ADM_toolkit_gtk
Message-ID: <200707240042.l6O0gt9X028020@sheep.berlios.de>

Author: gruntster
Date: 2007-07-24 02:42:36 +0200 (Tue, 24 Jul 2007)
New Revision: 3441

Modified:
   branches/avidemux_2.4_branch/avidemux/ADM_osSupport/ADM_misc.h
   branches/avidemux_2.4_branch/avidemux/ADM_osSupport/win32.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_toolkit_gtk/toolkit.cpp
Log:
[Win32] resize GTK dialogs based on working area rather than screen resolution + multi-monitor support

Modified: branches/avidemux_2.4_branch/avidemux/ADM_osSupport/ADM_misc.h
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_osSupport/ADM_misc.h	2007-07-23 19:26:54 UTC (rev 3440)
+++ branches/avidemux_2.4_branch/avidemux/ADM_osSupport/ADM_misc.h	2007-07-24 00:42:36 UTC (rev 3441)
@@ -85,6 +85,7 @@
 	#define SHTDN_REASON_FLAG_PLANNED 0x80000000
 
 	int shutdown_win32(void);
+	void getWorkingArea(uint32_t *width, uint32_t *height);
 #else
 	#include <sys/resource.h>
 #endif

Modified: branches/avidemux_2.4_branch/avidemux/ADM_osSupport/win32.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_osSupport/win32.cpp	2007-07-23 19:26:54 UTC (rev 3440)
+++ branches/avidemux_2.4_branch/avidemux/ADM_osSupport/win32.cpp	2007-07-24 00:42:36 UTC (rev 3441)
@@ -1,18 +1,17 @@
 #include "config.h"
+
+#ifdef ADM_WIN32
+#define WIN32_CLASH
 #include <stdio.h>
 #include <stdlib.h>
-#include <math.h>
+
 #include "default.h" 
 #include "ADM_misc.h"
-
-
-#ifdef ADM_WIN32
 #include "windows.h"
-#include "winbase.h"
 #include "io.h"
 #include "winsock2.h"
-#define WIN32_CLASH
 #include "ADM_assert.h" 
+
 uint8_t win32_netInit(void);
 
 void ADM_usleep(unsigned long us)
@@ -424,5 +423,39 @@
 	return true;
 }
 
+#define MONITOR_DEFAULTTONEAREST    0x00000002
+
+void getWorkingArea(uint32_t *width, uint32_t *height)
+{
+	typedef void* (WINAPI *MonitorFromWindow)(HWND hwnd, uint32_t dwFlags);
+	typedef bool (WINAPI *GetMonitorInfo)(void *hMonitor, LPMONITORINFO lpmi);
+
+	static HMODULE user32 = GetModuleHandle("user32.dll");
+	static MonitorFromWindow pMonitorFromWindow = (MonitorFromWindow)GetProcAddress(user32, "MonitorFromWindow");
+	static GetMonitorInfo pGetMonitorInfo = (GetMonitorInfo)GetProcAddress(user32, "GetMonitorInfoA");
+
+	if (pMonitorFromWindow == NULL)
+	{
+		RECT rect;
+
+		// Required for NT4 - no multi-monitor support
+		SystemParametersInfo(SPI_GETWORKAREA, 0, &rect, 0);
+
+		*width = rect.right - rect.left;
+		*height = rect.bottom - rect.top;
+	}
+	else
+	{
+		void *hMonitor = pMonitorFromWindow(GetForegroundWindow(), MONITOR_DEFAULTTONEAREST);
+
+		MONITORINFO monitorInfo;
+
+		monitorInfo.cbSize = sizeof(MONITORINFO);
+		pGetMonitorInfo(hMonitor, &monitorInfo);
+
+		*width = monitorInfo.rcWork.right - monitorInfo.rcWork.left;
+		*height = monitorInfo.rcWork.bottom - monitorInfo.rcWork.top;
+	}
+}
 #endif
 

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_toolkit_gtk/toolkit.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_toolkit_gtk/toolkit.cpp	2007-07-23 19:26:54 UTC (rev 3440)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_toolkit_gtk/toolkit.cpp	2007-07-24 00:42:36 UTC (rev 3441)
@@ -20,14 +20,11 @@
 #include "config.h"
 #include <stdio.h>
 #include <stdlib.h>
-#include <time.h>
-#include <math.h>
+#include <gtk/gtk.h>
+
 #ifndef ADM_WIN32
 #include <unistd.h>
 #endif
-#include <gtk/gtk.h>
-#include <ctype.h>
-#include <sys/time.h>
 
 #include "avi_vars.h"
 #include "ADM_misc.h"
@@ -195,6 +192,9 @@
 */
 uint8_t UI_getPhysicalScreenSize(uint32_t *w, uint32_t *h)
 {
+#ifdef ADM_WIN32
+	getWorkingArea(w, h);
+#else
 	static int inited = 0;
 	static int ww,hh;
 
@@ -208,7 +208,8 @@
 
     *w=ww;
     *h=hh;
+#endif
 
-    return 1;
+	return 1;
 }
 //EOF



From gruntster at mail.berlios.de  Tue Jul 24 20:53:45 2007
From: gruntster at mail.berlios.de (gruntster at mail.berlios.de)
Date: Tue, 24 Jul 2007 20:53:45 +0200
Subject: [Avidemux-svn-commit] r3442 - in
	branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces:
	ADM_GTK/ADM_gui2 ADM_NONE/ADM_gui2 ADM_QT4/ADM_gui ADM_commonUI
Message-ID: <200707241853.l6OIrjq2017634@sheep.berlios.de>

Author: gruntster
Date: 2007-07-24 20:53:25 +0200 (Tue, 24 Jul 2007)
New Revision: 3442

Modified:
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_bindings.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_NONE/ADM_gui2/gui_none.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/Q_gui2.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/T_preview.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui_none.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/GUI_render.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/GUI_ui.h
Log:
[Playback] resize Qt4 playback window to fit video + reduce zoom if it exceeds screen resolution

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_bindings.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_bindings.cpp	2007-07-24 00:42:36 UTC (rev 3441)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_bindings.cpp	2007-07-24 18:53:25 UTC (rev 3442)
@@ -1080,11 +1080,6 @@
         return 1;
 }
 
-uint8_t UI_shrink(uint32_t w,uint32_t h)
-{
-        gtk_widget_set_usize(guiRootWindow, w, h);
-        return 1;
-}
 // Override arrow keys to quickly navigate
 uint8_t UI_arrow_enabled(void)
 {

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_NONE/ADM_gui2/gui_none.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_NONE/ADM_gui2/gui_none.cpp	2007-07-24 00:42:36 UTC (rev 3441)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_NONE/ADM_gui2/gui_none.cpp	2007-07-24 18:53:25 UTC (rev 3442)
@@ -126,10 +126,6 @@
   return 1;
 }
 
-uint8_t UI_shrink(uint32_t w,uint32_t h)
-{
-  return 1;
-}
 uint8_t UI_arrow_enabled(void)
 {
   return 1;

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/Q_gui2.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/Q_gui2.cpp	2007-07-24 00:42:36 UTC (rev 3441)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/Q_gui2.cpp	2007-07-24 18:53:25 UTC (rev 3442)
@@ -1,706 +1,712 @@
-/***************************************************************************
-    copyright            : (C) 2001 by mean
-    email                : fixounet at free.fr
- ***************************************************************************/
-
-/***************************************************************************
- *                                                                         *
- *   This program is free software; you can redistribute it and/or modify  *
- *   it under the terms of the GNU General Public License as published by  *
- *   the Free Software Foundation; either version 2 of the License, or     *
- *   (at your option) any later version.                                   *
- *                                                                         *
- ***************************************************************************/
-#include "config.h"
-#define CUSTOM_SLIDER
-#include <stdio.h>
-#include <stdlib.h>
-#include <math.h>
-
-#include <QtCore/QVariant>
-#include <QtGui/QAction>
-#include <QtGui/QApplication>
-#include <QtGui/QButtonGroup>
-#include <QtGui/QFrame>
-#include <QtGui/QGraphicsView>
-#include <QtGui/QHBoxLayout>
-#include <QtGui/QMainWindow>
-#include <QtGui/QMenu>
-#include <QtGui/QMenuBar>
-#include <QtGui/QSlider>
-#include <QtGui/QSpacerItem>
-#include <QtGui/QStatusBar>
-#include <QtGui/QToolButton>
-#include <QtGui/QVBoxLayout>
-#include <QtGui/QWidget>
-#include <ADM_qslider.h>
-
-#include "default.h"
-#include "ADM_osSupport/ADM_misc.h"
-#include "ADM_codecs/ADM_codec.h"
-#include "gui_action.hxx"
-#include "ADM_editor/ADM_outputfmt.h"
-#include "ADM_toolkit/filesel.h"
-#include "prefs.h"
-
-extern int automation(void );
-extern void HandleAction(Action a);
-extern uint32_t encoderGetNbEncoder (void);
-extern const char *encoderGetIndexedName (uint32_t i);
-extern uint32_t audioFilterGetNbEncoder(void);
-extern const char* audioFilterGetIndexedName(uint32_t i);
-extern void checkCrashFile(void);
-static void setupMenus(void);
-static void GUI_initCustom(void);
-#ifdef CUSTOM_SLIDER
-static ADM_QSlider *slider=NULL;
-#else
-static QSlider *slider=NULL;
-#endif
-static int _upd_in_progres=0;
-/* Ugly game with macro so that buttons emit their name ...*/
-static char     *customNames[ADM_MAC_CUSTOM_SCRIPT];
-static QAction  *customActions[ADM_MAC_CUSTOM_SCRIPT];
-static uint32_t ADM_nbCustom=0;
-
-
-#include "ui_gui2.h"
-
-#define WIDGET(x)  (((MainWindow *)QuiMainWindows)->ui.x)
-    
-#define CONNECT(object,zzz) connect( (ui.object),SIGNAL(triggered()),this,SLOT(buttonPressed()));
-#define CONNECT_TB(object,zzz) connect( (ui.object),SIGNAL(clicked(bool)),this,SLOT(toolButtonPressed(bool)));
-#define DECLARE_VAR(object,signal_name) {#object,signal_name},
-             
-#include "translation_table.h"    
-/*
-    Declare the table converting widget name to our internal signal           
-*/
-typedef struct adm_qt4_translation
-{
-  const char *name;
-  Action     action; 
-};
-const adm_qt4_translation myTranslationTable[]=
-{
-#define PROCESS DECLARE_VAR
-     LIST_OF_OBJECTS
-     LIST_OF_BUTTONS
-#undef PROCESS
-};
-static Action searchTranslationTable(const char *name);
-#define SIZEOF_MY_TRANSLATION sizeof(myTranslationTable)/sizeof(adm_qt4_translation)
-/*
-    Declare the class that will be our main window
-
-*/
- class MainWindow : public QMainWindow
- {
-     Q_OBJECT
-
- public:
-     MainWindow();
-     Ui_MainWindow ui;
- public slots:
-     void timeChanged(int);
-     void buttonPressed(void);
-     void custom(void);
-     void toolButtonPressed(bool z);
-     void comboChanged(int z)
-     {
-        const char *source=qPrintable(sender()->objectName());
-
-        if(!strcmp(source,"comboBoxVideo"))  
-        {
-          bool b=FALSE;;
-          if(ui.comboBoxVideo->currentIndex())
-          {
-             b=TRUE;
-          }
-          ui.pushButtonVideoConf->setEnabled(b);
-          ui.pushButtonVideoFilter->setEnabled(b);
-          HandleAction (ACT_VideoCodecChanged) ;
-        }
-        else 
-          if(!strcmp(source,"comboBoxAudio"))  
-        {
-          bool b=FALSE;
-          if(ui.comboBoxAudio->currentIndex())
-          {
-             b=TRUE;
-          }
-          ui.pushButtonAudioConf->setEnabled(b);
-          ui.pushButtonAudioFilter->setEnabled(b);
-          HandleAction (ACT_AudioCodecChanged) ;
-        }else
-        if(!strcmp(source,"comboBoxPreview"))  
-        {
-          HandleAction (ACT_PreviewChanged) ;
-        }
-        
-
-        printf("From +: %s\n",source);
-     }
-      void sliderMoved(int u) 
-        {
-          if(!_upd_in_progres)
-          {
-            HandleAction (ACT_Scale) ;
-          }
-        }
- private slots:
-   
-
- private:
-     
- };
-
-
-MainWindow::MainWindow()     : QMainWindow()
- {
-     ui.setupUi(this);
-     /*
-        Connect our button to buttonPressed
-     */
-#define PROCESS CONNECT
-     LIST_OF_OBJECTS
-#undef PROCESS
-#define PROCESS CONNECT_TB
-     LIST_OF_BUTTONS
-#undef PROCESS
-     // ComboBox
-         
-         
-         
-         //ACT_VideoCodecChanged
-         connect( ui.comboBoxVideo,SIGNAL(activated(int)),this,SLOT(comboChanged(int)));
-         connect( ui.comboBoxAudio,SIGNAL(activated(int)),this,SLOT(comboChanged(int)));
-         connect( ui.comboBoxPreview,SIGNAL(activated(int)),this,SLOT(comboChanged(int)));
-     // Slider
-          slider=ui.horizontalSlider;
-          slider->setMinimum(0);
-          slider->setMaximum(1000);
-          connect( slider,SIGNAL(valueChanged(int)),this,SLOT(sliderMoved(int)));
-          //connect( slider,SIGNAL(sliderMoved()),this,SLOT(sliderMoved()));
-  
-          // Add a second toolbar
-          QToolBar *toolBarMove;
-            toolBarMove = new QToolBar(this);
-            toolBarMove->setObjectName(QString::fromUtf8("toolBarMove"));
-            toolBarMove->setOrientation(Qt::Horizontal);
-            this->addToolBar(static_cast<Qt::ToolBarArea>(4), toolBarMove);
-          // And actions to it
-#define ADD(x) toolBarMove->addAction(ui.x)
-            ADD(actionPlay);
-            ADD(actionPlay_Stop);
-            ADD(actionPrevious_Frame);
-            ADD(actionNext_Frame);
-            ADD(actionPrevious_intra_frame);
-            ADD(actionNext_intra_frame);
-            ADD(actionSet_marker_A);
-            ADD(actionSet_marker_B);
-            ADD(actionPrevious_black_frame);
-            ADD(actionNext_blak_frame);
-            ADD(actionFirst_Frame);
-            ADD(actionLast_Frame);
-            ADD(actionGo_to_Marker_A);
-            ADD(actionGo_to_Marker_B);
-            //** Add shortcuts **//
-            QKeySequence seqFilter("CTRL+Alt+F");
-            ui.actionFilters->setShortcut(seqFilter);
-            // default state
-            bool b=0;
-          ui.pushButtonVideoConf->setEnabled(b);
-          ui.pushButtonVideoFilter->setEnabled(b);
-          ui.pushButtonAudioConf->setEnabled(b);
-          ui.pushButtonAudioFilter->setEnabled(b);
-          /* Time Shift */
-  connect(ui.checkBox_TimeShift,SIGNAL(stateChanged(int)),this,SLOT(timeChanged(int)));
-  connect(ui.spinBox_TimeValue,SIGNAL(valueChanged(int)),this,SLOT(timeChanged(int)));
-          
-          
-          
-          /* Build the custom menu */
-          GUI_initCustom();
-          for(int i=0;i<ADM_nbCustom;i++)
-          {
-            customActions[i]=new QAction(customNames[i],NULL);
-            ui.menuCustom->addAction(customActions[i]);
-            connect(customActions[i], SIGNAL(triggered()), this, SLOT(custom()));
-          }
-          printf("Menu built\n");
- }
- /**
-    \fn     custom
-    \brief  Invoked when one of the custom script has been called
- */
-void MainWindow::custom(void)
-{
-    printf("[CUSTOM] Invoked\n");
-    QObject *ptr=sender();
-    if(!ptr) return;
-    for(int i=0;i<ADM_nbCustom;i++)
-    {
-      if(customActions[i]==ptr)
-      {
-        printf("[Custom] %u/%u scrips\n",i,ADM_nbCustom);
-        HandleAction( (Action)(ACT_CUSTOM_BASE+i));
-        return; 
-      }
-    }
-    printf("[Custom] Not found\n");
-}
-/**
-    Get the custom entry 
-
-*/
-const char * GUI_getCustomScript(uint32_t nb)
-{
-    ADM_assert(nb<ADM_nbCustom);
-    return customNames[nb];
-
-}
-/**
-    \fn timeChanged
-    \brief Called whenever timeshift is on/off'ed or value changes
-*/
-void MainWindow::timeChanged(int)
-{
-   HandleAction (ACT_TimeShift) ;
-}
- /*
-      We receive a button press event
- */
- void MainWindow::buttonPressed(void)
- {
-    // Receveid a key press Event, look into table..
-   const char *source=qPrintable(sender()->objectName());
-
-    printf("Button From : %s\n",source);
-    Action action=searchTranslationTable(source);
-    if(action!=ACT_DUMMY)
-    {
-      HandleAction (action) ;
-    }
-
- }
-  void MainWindow::toolButtonPressed(bool i)
-  {
-     buttonPressed();
-  }
-//*********************************************
-//***** Hook to core                ***********
-//*********************************************
-extern int global_argc;
-extern char **global_argv;
-extern void UI_QT4VideoWidget(QFrame *frame);
-int UI_Init(int nargc,char **nargv)
-{
-  global_argc=nargc;
-  global_argv=nargv;
-  return 0;
-}
-QWidget *QuiMainWindows=NULL;
-QGraphicsView *drawWindow=NULL;
-uint8_t UI_updateRecentMenu( void );
-
-/**
-    \fn UI_getCurrentPreview(void)
-    \brief Read previewmode from comboxbox 
-*/
-
-int    UI_getCurrentPreview(void)
-{
-  return WIDGET(comboBoxPreview)->currentIndex(); 
-}
-/**
-    \fn UI_setCurrentPreview(int ne)
-    \brief Update comboxbox with previewmode
-*/
-
-void   UI_setCurrentPreview(int ne)
-{
-    WIDGET(comboBoxPreview)->setCurrentIndex(ne); 
-}
-
-
-/**
-    \fn UI_RunApp(void)
-    \brief Main entry point for the GUI application
-*/
-int UI_RunApp(void)
-{
-Q_INIT_RESOURCE(avidemux);
-Q_INIT_RESOURCE(filter);
-   QApplication a( global_argc, global_argv );
-   MainWindow * mw = new MainWindow();
-    
-    a.connect( &a, SIGNAL(lastWindowClosed()), &a, SLOT(quit()) );
-    
-    mw->show();
-    
-    QuiMainWindows=(QWidget*)mw;
-   
-    UI_QT4VideoWidget(mw->ui.frame_video);  // Add the widget that will handle video display
-    UI_updateRecentMenu(  );
-    setupMenus();
-    checkCrashFile();
-    
-   if (global_argc >= 2)
-    {
-     automation();
-    }
-    return a.exec();
-}
-/**
-    \fn searchTranslationTable(const char *name))
-    \brief return the action corresponding to a give button. The translation table is in translation_table.h
-*/
-Action searchTranslationTable(const char *name)
-{
-  for(int i=0;i< SIZEOF_MY_TRANSLATION;i++)
-  {
-    if(!strcmp(name, myTranslationTable[i].name))
-    {
-      return  myTranslationTable[i].action;
-    }
-  }
-  printf("WARNING : Signal not found in translation table : %s\n",name);
-  return ACT_DUMMY;
-}
-/**
-    \fn     UI_updateRecentMenu( void )
-    \brief  Update the recent submenu with the latest files loaded
-*/
-uint8_t UI_updateRecentMenu( void )
-{
-const char **names;
-uint32_t nb_item=0;
-QAction *actions[4]={WIDGET(actionRecent0),WIDGET(actionRecent1),WIDGET(actionRecent2),WIDGET(actionRecent3)};
-        names=prefs->get_lastfiles();
-        
-        // hide them all
-        for(int i=0;i<4;i++) actions[i]->setVisible(0);
-        // Redraw..
-        for( nb_item=0;nb_item<4;nb_item++)
-        {
-                if(!names[nb_item]) 
-                {
-                   return 1;
-                }
-                else
-                {
-                    //actions[nb_item]->setVisible(1);
-                    // Replace widget ?
-                    actions[nb_item]->setText(names[nb_item]);
-                    actions[nb_item]->setVisible(1);
-                }
-                // Update name
-        }
-        return 1;
-}
-/** 
-  \fn    setupMenus(void)
-  \brief Fill in video & audio co
-*/
-void setupMenus(void)
-{
-        uint32_t nbVid;
-        const char *name;
-
-                nbVid=encoderGetNbEncoder();
-                printf("Found %d video encoder\n",nbVid);
-                for(uint32_t i=1;i<nbVid;i++)
-                {
-                        name=encoderGetIndexedName(i);
-                        WIDGET(comboBoxVideo)->addItem(name);
-                }
-
-        // And A codec
-        
-        uint32_t nbAud;
-
-                nbAud=audioFilterGetNbEncoder();
-                printf("Found %d audio encoder\n",nbAud);		       
-                for(uint32_t i=1;i<nbAud;i++)
-                {
-                        name=audioFilterGetIndexedName(i);
-                        WIDGET(comboBoxAudio)->addItem(name);
-                }
-      /*   Fill in output format window */
-        uint32_t nbFormat;
-
-                nbFormat=sizeof(ADM_allOutputFormat)/sizeof(ADM_FORMAT_DESC);
-                printf("Found %d Format \n",nbFormat);
-                for(uint32_t i=0;i<nbFormat;i++)
-                {
-                       WIDGET(comboBoxFormat)->addItem(_(ADM_allOutputFormat[i].text));	
-                }
-        
-}
-/*
-    Return % of scale (between 0 and 1)
-*/
-double 	UI_readScale( void )
-{
-  double v;
-  if(!slider) v=0;
-  v= (double)(slider->value());
-  v/=10;
-  printf("GetScale\n");
-  return v;
-}
-void UI_setScale( double val )
-{
-if(_upd_in_progres) return;
- _upd_in_progres++;
-   slider->setValue( (int)val*10);
- _upd_in_progres--;
-   
-}
-void UI_purge( void )
-{
- QCoreApplication::processEvents ();
-}
-
-
-//*******************************************
-
-/**
-    \fn UI_setTitle(char *name)
-    \brief Set the main window title, usually name if the file being edited
-*/
-void UI_setTitle(char *name)
-{
-      char title[1024];
-
-      strcpy(title,"Avidemux 2 ");
-      strncat(title,name,200);
-
-      QuiMainWindows->setWindowTitle( title);
-}
-/**
-    \fn     UI_setFrameType( uint32_t frametype,uint32_t qp)
-    \brief  Display frametype (I/P/B) and associated quantizer
-*/
-
-void UI_setFrameType( uint32_t frametype,uint32_t qp)
-{
-char string[100];
-char	c='?';
-      switch(frametype)
-      {
-              case AVI_KEY_FRAME: c='I';break;
-              case AVI_B_FRAME: c='B';break;
-              case 0: c='P';break;
-              default:c='?';break;
-      
-      }
-      sprintf(string,_("Frame:%c(%02d)"),c,qp);
-      WIDGET(label_8)->setText(string);	
-
-}
-/**
-    \fn     UI_updateFrameCount(uint32_t curFrame)
-    \brief  Display the current displayed frame #
-*/
-
-void UI_updateFrameCount(uint32_t curFrame)
-{
-    char string[30];
-        sprintf(string,"%lu",curFrame);
-	WIDGET(lineEdit)->setText(string);
-    
-}
-/**
-    \fn      UI_setFrameCount(uint32_t curFrame,uint32_t total)
-    \brief  Display the current displayed frame # and total frame #
-*/
-
-void UI_setFrameCount(uint32_t curFrame,uint32_t total)
-{
-    char text[80]; 
-    if(total) total--; // We display from 0 to X  
-    
-    UI_updateFrameCount(curFrame);
-    
-    sprintf(text, "/ %lu ", total);
-    WIDGET(label_2)->setText(text);
-    
-}
-/**
-    \fn     UI_updateTimeCount(uint32_t curFrame,uint32_t fps)
-    \brief  Display the time corresponding to current frame according to fps (fps1000)
-*/
-
-void UI_updateTimeCount(uint32_t curFrame,uint32_t fps)
-{
- char text[80];   
- uint16_t mm,hh,ss,ms;
-
-      frame2time(curFrame,fps, &hh, &mm, &ss, &ms);
-      sprintf(text, "%02d:%02d:%02d.%03d", hh, mm, ss, ms);
-      WIDGET(lineEdit_2)->setText(text);
-
-}
-/**
-    \fn     UI_updateTimeCount(uint32_t curFrame,uint32_t fps)
-    \brief  Display the time corresponding to current frame according to fps (fps1000) and total duration
-*/
-
-void UI_setTimeCount(uint32_t curFrame,uint32_t total, uint32_t fps)
-{
- char text[80];   
- uint16_t mm,hh,ss,ms;
-
-        UI_updateTimeCount(curFrame,fps);
-      frame2time(total,fps, &hh, &mm, &ss, &ms);
-      sprintf(text, "/%02d:%02d:%02d.%03d", hh, mm, ss, ms);
-      WIDGET(label_7)->setText(text);
-#ifdef CUSTOM_SLIDER
-      slider->setNbFrames(total);
-#endif
-}
-/**
-    \fn     UI_setMarkers(uint32_t a, uint32_t b )
-    \brief  Display frame # for marker A & B
-*/
-
-void UI_setMarkers(uint32_t a, uint32_t b )
-{
- char text[80];
-      snprintf(text,79,"%lu",a);
-      WIDGET(label_9)->setText(text);
-      snprintf(text,79,"%lu",b);
-      WIDGET(label_10)->setText(text);
-      //
-#ifdef CUSTOM_SLIDER
-      slider->setA(a);
-      slider->setB(b);
-#endif
-}
-/**
-    \fn     UI_getCurrentVCodec(void)
-    \brief  Returns the current selected video code in menu, i.e its number (0 being the first)
-*/
-
-int 	UI_getCurrentVCodec(void)
-{
-  int i=WIDGET(comboBoxVideo)->currentIndex();
-  if(i<0) i=0;
-  return i; 
-}
-/**
-    \fn     UI_setVideoCodec( int i)
-    \brief  Select the video codec which is # x in pulldown menu (starts at zero :copy)
-*/
-
-void UI_setVideoCodec( int i)
-{
-  int b=!!i;
-    WIDGET(comboBoxVideo)->setCurrentIndex(i);
-    
-     WIDGET(pushButtonVideoConf)->setEnabled(b);
-     WIDGET(pushButtonVideoFilter)->setEnabled(b);
-}
-/**
-    \fn     UI_getCurrentACodec(void)
-    \brief  Returns the current selected audio code in menu, i.e its number (0 being the first)
-*/
-
-int 	UI_getCurrentACodec(void)
-{
-   int i=WIDGET(comboBoxAudio)->currentIndex();
-  if(i<0) i=0;
-  return i; 
-}
-/**
-    \fn     UI_setAudioCodec( int i)
-    \brief  Select the audio codec which is # x in pulldown menu (starts at zero :copy)
-*/
-
-void UI_setAudioCodec( int i)
-{ int b=!!i;
-   WIDGET(comboBoxAudio)->setCurrentIndex(i);
-    WIDGET(pushButtonAudioConf)->setEnabled(b);
-    WIDGET(pushButtonAudioFilter)->setEnabled(b);
-}
-/**
-    \fn     UI_GetCurrentFormat(void)
-    \brief  Returns the current selected output format
-*/
-
-ADM_OUT_FORMAT 	UI_GetCurrentFormat( void )
-{
-    int i=WIDGET(comboBoxFormat)->currentIndex();
-  if(i<0) i=0;
-  return (ADM_OUT_FORMAT)i; 
-}
-/**
-    \fn     UI_SetCurrentFormat( ADM_OUT_FORMAT fmt )
-    \brief  Select  output format
-*/
-uint8_t 	UI_SetCurrentFormat( ADM_OUT_FORMAT fmt )
-{
-    WIDGET(comboBoxFormat)->setCurrentIndex((int)fmt);
-}
-uint8_t UI_sliderResize(uint32_t w)
-{
-  printf("sliderResize %u\n",w);
-  slider->resize(w,w);
-  return 1; 
-}
-/**
-      \fn GUI_initCustom
-      \brief Initialize custom menu
-*/
-void GUI_initCustom(void )
-{
-  char *customdir=ADM_getCustomDir();
-  if(!customdir) 
-  {
-      printf("No custom dir...\n");
-      return;
-  }
-  /* Collect the name */
-   if(! buildDirectoryContent(&ADM_nbCustom,customdir, customNames,ADM_MAC_CUSTOM_SCRIPT,".js"))
-    {
-      printf("Failed to build custom dir content");
-      return;
-    }
-  if(!ADM_nbCustom)
-  {
-      printf("No custom script\n");
-  }
-  printf("Found %u custom scripts, adding them\n",ADM_nbCustom);
-}
-/**
-      \fn UI_getTimeShift
-      \brief get state (on/off) and value for time Shift
-*/
-uint8_t UI_getTimeShift(int *onoff,int *value)
-{
-  if(WIDGET(checkBox_TimeShift)->checkState()==Qt::Checked)
-        *onoff=1;
-  else
-        *onoff=0;
-  *value=WIDGET(spinBox_TimeValue)->value();
-  return 1;
-}
-/**
-      \fn UI_setTimeShift
-      \brief get state (on/off) and value for time Shift
-*/
-
-uint8_t UI_setTimeShift(int onoff,int value)
-{
-  if(onoff)
-    WIDGET(checkBox_TimeShift)->setCheckState(Qt::Checked);
-  else
-    WIDGET(checkBox_TimeShift)->setCheckState(Qt::Unchecked);
-  WIDGET(spinBox_TimeValue)->setValue(value);
-  return 1;
-}
-
-//********************************************
-//EOF
+/***************************************************************************
+    copyright            : (C) 2001 by mean
+    email                : fixounet at free.fr
+ ***************************************************************************/
+
+/***************************************************************************
+ *                                                                         *
+ *   This program is free software; you can redistribute it and/or modify  *
+ *   it under the terms of the GNU General Public License as published by  *
+ *   the Free Software Foundation; either version 2 of the License, or     *
+ *   (at your option) any later version.                                   *
+ *                                                                         *
+ ***************************************************************************/
+#include "config.h"
+#define CUSTOM_SLIDER
+#include <stdio.h>
+#include <stdlib.h>
+#include <math.h>
+
+#include <QtCore/QVariant>
+#include <QtGui/QAction>
+#include <QtGui/QApplication>
+#include <QtGui/QButtonGroup>
+#include <QtGui/QFrame>
+#include <QtGui/QGraphicsView>
+#include <QtGui/QHBoxLayout>
+#include <QtGui/QMainWindow>
+#include <QtGui/QMenu>
+#include <QtGui/QMenuBar>
+#include <QtGui/QSlider>
+#include <QtGui/QSpacerItem>
+#include <QtGui/QStatusBar>
+#include <QtGui/QToolButton>
+#include <QtGui/QVBoxLayout>
+#include <QtGui/QWidget>
+#include <ADM_qslider.h>
+
+#include "default.h"
+#include "ADM_osSupport/ADM_misc.h"
+#include "ADM_codecs/ADM_codec.h"
+#include "gui_action.hxx"
+#include "ADM_editor/ADM_outputfmt.h"
+#include "ADM_toolkit/filesel.h"
+#include "prefs.h"
+
+extern uint8_t UI_getPhysicalScreenSize(uint32_t *w,uint32_t *h);
+extern int automation(void );
+extern void HandleAction(Action a);
+extern uint32_t encoderGetNbEncoder (void);
+extern const char *encoderGetIndexedName (uint32_t i);
+extern uint32_t audioFilterGetNbEncoder(void);
+extern const char* audioFilterGetIndexedName(uint32_t i);
+extern void checkCrashFile(void);
+static void setupMenus(void);
+static void GUI_initCustom(void);
+#ifdef CUSTOM_SLIDER
+static ADM_QSlider *slider=NULL;
+#else
+static QSlider *slider=NULL;
+#endif
+static int _upd_in_progres=0;
+/* Ugly game with macro so that buttons emit their name ...*/
+static char     *customNames[ADM_MAC_CUSTOM_SCRIPT];
+static QAction  *customActions[ADM_MAC_CUSTOM_SCRIPT];
+static uint32_t ADM_nbCustom=0;
+
+
+#include "ui_gui2.h"
+
+#define WIDGET(x)  (((MainWindow *)QuiMainWindows)->ui.x)
+    
+#define CONNECT(object,zzz) connect( (ui.object),SIGNAL(triggered()),this,SLOT(buttonPressed()));
+#define CONNECT_TB(object,zzz) connect( (ui.object),SIGNAL(clicked(bool)),this,SLOT(toolButtonPressed(bool)));
+#define DECLARE_VAR(object,signal_name) {#object,signal_name},
+             
+#include "translation_table.h"    
+/*
+    Declare the table converting widget name to our internal signal           
+*/
+typedef struct adm_qt4_translation
+{
+  const char *name;
+  Action     action; 
+};
+const adm_qt4_translation myTranslationTable[]=
+{
+#define PROCESS DECLARE_VAR
+     LIST_OF_OBJECTS
+     LIST_OF_BUTTONS
+#undef PROCESS
+};
+static Action searchTranslationTable(const char *name);
+#define SIZEOF_MY_TRANSLATION sizeof(myTranslationTable)/sizeof(adm_qt4_translation)
+/*
+    Declare the class that will be our main window
+
+*/
+ class MainWindow : public QMainWindow
+ {
+     Q_OBJECT
+
+ public:
+     MainWindow();
+     Ui_MainWindow ui;
+ public slots:
+     void timeChanged(int);
+     void buttonPressed(void);
+     void custom(void);
+     void toolButtonPressed(bool z);
+     void comboChanged(int z)
+     {
+        const char *source=qPrintable(sender()->objectName());
+
+        if(!strcmp(source,"comboBoxVideo"))  
+        {
+          bool b=FALSE;;
+          if(ui.comboBoxVideo->currentIndex())
+          {
+             b=TRUE;
+          }
+          ui.pushButtonVideoConf->setEnabled(b);
+          ui.pushButtonVideoFilter->setEnabled(b);
+          HandleAction (ACT_VideoCodecChanged) ;
+        }
+        else 
+          if(!strcmp(source,"comboBoxAudio"))  
+        {
+          bool b=FALSE;
+          if(ui.comboBoxAudio->currentIndex())
+          {
+             b=TRUE;
+          }
+          ui.pushButtonAudioConf->setEnabled(b);
+          ui.pushButtonAudioFilter->setEnabled(b);
+          HandleAction (ACT_AudioCodecChanged) ;
+        }else
+        if(!strcmp(source,"comboBoxPreview"))  
+        {
+          HandleAction (ACT_PreviewChanged) ;
+        }
+        
+
+        printf("From +: %s\n",source);
+     }
+      void sliderMoved(int u) 
+        {
+          if(!_upd_in_progres)
+          {
+            HandleAction (ACT_Scale) ;
+          }
+        }
+ private slots:
+   
+
+ private:
+     
+ };
+
+
+MainWindow::MainWindow()     : QMainWindow()
+ {
+     ui.setupUi(this);
+     /*
+        Connect our button to buttonPressed
+     */
+#define PROCESS CONNECT
+     LIST_OF_OBJECTS
+#undef PROCESS
+#define PROCESS CONNECT_TB
+     LIST_OF_BUTTONS
+#undef PROCESS
+     // ComboBox
+         
+         
+         
+         //ACT_VideoCodecChanged
+         connect( ui.comboBoxVideo,SIGNAL(activated(int)),this,SLOT(comboChanged(int)));
+         connect( ui.comboBoxAudio,SIGNAL(activated(int)),this,SLOT(comboChanged(int)));
+         connect( ui.comboBoxPreview,SIGNAL(activated(int)),this,SLOT(comboChanged(int)));
+     // Slider
+          slider=ui.horizontalSlider;
+          slider->setMinimum(0);
+          slider->setMaximum(1000);
+          connect( slider,SIGNAL(valueChanged(int)),this,SLOT(sliderMoved(int)));
+          //connect( slider,SIGNAL(sliderMoved()),this,SLOT(sliderMoved()));
+  
+          // Add a second toolbar
+          QToolBar *toolBarMove;
+            toolBarMove = new QToolBar(this);
+            toolBarMove->setObjectName(QString::fromUtf8("toolBarMove"));
+            toolBarMove->setOrientation(Qt::Horizontal);
+            this->addToolBar(static_cast<Qt::ToolBarArea>(4), toolBarMove);
+          // And actions to it
+#define ADD(x) toolBarMove->addAction(ui.x)
+            ADD(actionPlay);
+            ADD(actionPlay_Stop);
+            ADD(actionPrevious_Frame);
+            ADD(actionNext_Frame);
+            ADD(actionPrevious_intra_frame);
+            ADD(actionNext_intra_frame);
+            ADD(actionSet_marker_A);
+            ADD(actionSet_marker_B);
+            ADD(actionPrevious_black_frame);
+            ADD(actionNext_blak_frame);
+            ADD(actionFirst_Frame);
+            ADD(actionLast_Frame);
+            ADD(actionGo_to_Marker_A);
+            ADD(actionGo_to_Marker_B);
+            //** Add shortcuts **//
+            QKeySequence seqFilter("CTRL+Alt+F");
+            ui.actionFilters->setShortcut(seqFilter);
+            // default state
+            bool b=0;
+          ui.pushButtonVideoConf->setEnabled(b);
+          ui.pushButtonVideoFilter->setEnabled(b);
+          ui.pushButtonAudioConf->setEnabled(b);
+          ui.pushButtonAudioFilter->setEnabled(b);
+          /* Time Shift */
+  connect(ui.checkBox_TimeShift,SIGNAL(stateChanged(int)),this,SLOT(timeChanged(int)));
+  connect(ui.spinBox_TimeValue,SIGNAL(valueChanged(int)),this,SLOT(timeChanged(int)));
+          
+          
+          
+          /* Build the custom menu */
+          GUI_initCustom();
+          for(int i=0;i<ADM_nbCustom;i++)
+          {
+            customActions[i]=new QAction(customNames[i],NULL);
+            ui.menuCustom->addAction(customActions[i]);
+            connect(customActions[i], SIGNAL(triggered()), this, SLOT(custom()));
+          }
+          printf("Menu built\n");
+ }
+ /**
+    \fn     custom
+    \brief  Invoked when one of the custom script has been called
+ */
+void MainWindow::custom(void)
+{
+    printf("[CUSTOM] Invoked\n");
+    QObject *ptr=sender();
+    if(!ptr) return;
+    for(int i=0;i<ADM_nbCustom;i++)
+    {
+      if(customActions[i]==ptr)
+      {
+        printf("[Custom] %u/%u scrips\n",i,ADM_nbCustom);
+        HandleAction( (Action)(ACT_CUSTOM_BASE+i));
+        return; 
+      }
+    }
+    printf("[Custom] Not found\n");
+}
+/**
+    Get the custom entry 
+
+*/
+const char * GUI_getCustomScript(uint32_t nb)
+{
+    ADM_assert(nb<ADM_nbCustom);
+    return customNames[nb];
+
+}
+/**
+    \fn timeChanged
+    \brief Called whenever timeshift is on/off'ed or value changes
+*/
+void MainWindow::timeChanged(int)
+{
+   HandleAction (ACT_TimeShift) ;
+}
+ /*
+      We receive a button press event
+ */
+ void MainWindow::buttonPressed(void)
+ {
+    // Receveid a key press Event, look into table..
+   const char *source=qPrintable(sender()->objectName());
+
+    printf("Button From : %s\n",source);
+    Action action=searchTranslationTable(source);
+    if(action!=ACT_DUMMY)
+    {
+      HandleAction (action) ;
+    }
+
+ }
+  void MainWindow::toolButtonPressed(bool i)
+  {
+     buttonPressed();
+  }
+//*********************************************
+//***** Hook to core                ***********
+//*********************************************
+extern int global_argc;
+extern char **global_argv;
+extern void UI_QT4VideoWidget(QFrame *frame);
+int UI_Init(int nargc,char **nargv)
+{
+  global_argc=nargc;
+  global_argv=nargv;
+  return 0;
+}
+QWidget *QuiMainWindows=NULL;
+QGraphicsView *drawWindow=NULL;
+uint8_t UI_updateRecentMenu( void );
+
+/**
+    \fn UI_getCurrentPreview(void)
+    \brief Read previewmode from comboxbox 
+*/
+
+int    UI_getCurrentPreview(void)
+{
+  return WIDGET(comboBoxPreview)->currentIndex(); 
+}
+/**
+    \fn UI_setCurrentPreview(int ne)
+    \brief Update comboxbox with previewmode
+*/
+
+void   UI_setCurrentPreview(int ne)
+{
+    WIDGET(comboBoxPreview)->setCurrentIndex(ne); 
+}
+
+
+/**
+    \fn UI_RunApp(void)
+    \brief Main entry point for the GUI application
+*/
+int UI_RunApp(void)
+{
+Q_INIT_RESOURCE(avidemux);
+Q_INIT_RESOURCE(filter);
+   QApplication a( global_argc, global_argv );
+   MainWindow * mw = new MainWindow();
+    
+    a.connect( &a, SIGNAL(lastWindowClosed()), &a, SLOT(quit()) );
+    
+	uint32_t w, h;
+
+	UI_getPhysicalScreenSize(&w,&h); //gtk_widget_get_parent_window (guiRootWindow));
+    printf("The screen seems to be %u x %u px\n",w,h);
+
+    mw->show();
+    
+    QuiMainWindows=(QWidget*)mw;
+   
+    UI_QT4VideoWidget(mw->ui.frame_video);  // Add the widget that will handle video display
+    UI_updateRecentMenu(  );
+    setupMenus();
+    checkCrashFile();
+    
+   if (global_argc >= 2)
+    {
+     automation();
+    }
+    return a.exec();
+}
+/**
+    \fn searchTranslationTable(const char *name))
+    \brief return the action corresponding to a give button. The translation table is in translation_table.h
+*/
+Action searchTranslationTable(const char *name)
+{
+  for(int i=0;i< SIZEOF_MY_TRANSLATION;i++)
+  {
+    if(!strcmp(name, myTranslationTable[i].name))
+    {
+      return  myTranslationTable[i].action;
+    }
+  }
+  printf("WARNING : Signal not found in translation table : %s\n",name);
+  return ACT_DUMMY;
+}
+/**
+    \fn     UI_updateRecentMenu( void )
+    \brief  Update the recent submenu with the latest files loaded
+*/
+uint8_t UI_updateRecentMenu( void )
+{
+const char **names;
+uint32_t nb_item=0;
+QAction *actions[4]={WIDGET(actionRecent0),WIDGET(actionRecent1),WIDGET(actionRecent2),WIDGET(actionRecent3)};
+        names=prefs->get_lastfiles();
+        
+        // hide them all
+        for(int i=0;i<4;i++) actions[i]->setVisible(0);
+        // Redraw..
+        for( nb_item=0;nb_item<4;nb_item++)
+        {
+                if(!names[nb_item]) 
+                {
+                   return 1;
+                }
+                else
+                {
+                    //actions[nb_item]->setVisible(1);
+                    // Replace widget ?
+                    actions[nb_item]->setText(names[nb_item]);
+                    actions[nb_item]->setVisible(1);
+                }
+                // Update name
+        }
+        return 1;
+}
+/** 
+  \fn    setupMenus(void)
+  \brief Fill in video & audio co
+*/
+void setupMenus(void)
+{
+        uint32_t nbVid;
+        const char *name;
+
+                nbVid=encoderGetNbEncoder();
+                printf("Found %d video encoder\n",nbVid);
+                for(uint32_t i=1;i<nbVid;i++)
+                {
+                        name=encoderGetIndexedName(i);
+                        WIDGET(comboBoxVideo)->addItem(name);
+                }
+
+        // And A codec
+        
+        uint32_t nbAud;
+
+                nbAud=audioFilterGetNbEncoder();
+                printf("Found %d audio encoder\n",nbAud);		       
+                for(uint32_t i=1;i<nbAud;i++)
+                {
+                        name=audioFilterGetIndexedName(i);
+                        WIDGET(comboBoxAudio)->addItem(name);
+                }
+      /*   Fill in output format window */
+        uint32_t nbFormat;
+
+                nbFormat=sizeof(ADM_allOutputFormat)/sizeof(ADM_FORMAT_DESC);
+                printf("Found %d Format \n",nbFormat);
+                for(uint32_t i=0;i<nbFormat;i++)
+                {
+                       WIDGET(comboBoxFormat)->addItem(_(ADM_allOutputFormat[i].text));	
+                }
+        
+}
+/*
+    Return % of scale (between 0 and 1)
+*/
+double 	UI_readScale( void )
+{
+  double v;
+  if(!slider) v=0;
+  v= (double)(slider->value());
+  v/=10;
+  printf("GetScale\n");
+  return v;
+}
+void UI_setScale( double val )
+{
+if(_upd_in_progres) return;
+ _upd_in_progres++;
+   slider->setValue( (int)val*10);
+ _upd_in_progres--;
+   
+}
+void UI_purge( void )
+{
+ QCoreApplication::processEvents ();
+}
+
+
+//*******************************************
+
+/**
+    \fn UI_setTitle(char *name)
+    \brief Set the main window title, usually name if the file being edited
+*/
+void UI_setTitle(char *name)
+{
+      char title[1024];
+
+      strcpy(title,"Avidemux 2 ");
+      strncat(title,name,200);
+
+      QuiMainWindows->setWindowTitle( title);
+}
+/**
+    \fn     UI_setFrameType( uint32_t frametype,uint32_t qp)
+    \brief  Display frametype (I/P/B) and associated quantizer
+*/
+
+void UI_setFrameType( uint32_t frametype,uint32_t qp)
+{
+char string[100];
+char	c='?';
+      switch(frametype)
+      {
+              case AVI_KEY_FRAME: c='I';break;
+              case AVI_B_FRAME: c='B';break;
+              case 0: c='P';break;
+              default:c='?';break;
+      
+      }
+      sprintf(string,_("Frame:%c(%02d)"),c,qp);
+      WIDGET(label_8)->setText(string);	
+
+}
+/**
+    \fn     UI_updateFrameCount(uint32_t curFrame)
+    \brief  Display the current displayed frame #
+*/
+
+void UI_updateFrameCount(uint32_t curFrame)
+{
+    char string[30];
+        sprintf(string,"%lu",curFrame);
+	WIDGET(lineEdit)->setText(string);
+    
+}
+/**
+    \fn      UI_setFrameCount(uint32_t curFrame,uint32_t total)
+    \brief  Display the current displayed frame # and total frame #
+*/
+
+void UI_setFrameCount(uint32_t curFrame,uint32_t total)
+{
+    char text[80]; 
+    if(total) total--; // We display from 0 to X  
+    
+    UI_updateFrameCount(curFrame);
+    
+    sprintf(text, "/ %lu ", total);
+    WIDGET(label_2)->setText(text);
+    
+}
+/**
+    \fn     UI_updateTimeCount(uint32_t curFrame,uint32_t fps)
+    \brief  Display the time corresponding to current frame according to fps (fps1000)
+*/
+
+void UI_updateTimeCount(uint32_t curFrame,uint32_t fps)
+{
+ char text[80];   
+ uint16_t mm,hh,ss,ms;
+
+      frame2time(curFrame,fps, &hh, &mm, &ss, &ms);
+      sprintf(text, "%02d:%02d:%02d.%03d", hh, mm, ss, ms);
+      WIDGET(lineEdit_2)->setText(text);
+
+}
+/**
+    \fn     UI_updateTimeCount(uint32_t curFrame,uint32_t fps)
+    \brief  Display the time corresponding to current frame according to fps (fps1000) and total duration
+*/
+
+void UI_setTimeCount(uint32_t curFrame,uint32_t total, uint32_t fps)
+{
+ char text[80];   
+ uint16_t mm,hh,ss,ms;
+
+        UI_updateTimeCount(curFrame,fps);
+      frame2time(total,fps, &hh, &mm, &ss, &ms);
+      sprintf(text, "/%02d:%02d:%02d.%03d", hh, mm, ss, ms);
+      WIDGET(label_7)->setText(text);
+#ifdef CUSTOM_SLIDER
+      slider->setNbFrames(total);
+#endif
+}
+/**
+    \fn     UI_setMarkers(uint32_t a, uint32_t b )
+    \brief  Display frame # for marker A & B
+*/
+
+void UI_setMarkers(uint32_t a, uint32_t b )
+{
+ char text[80];
+      snprintf(text,79,"%lu",a);
+      WIDGET(label_9)->setText(text);
+      snprintf(text,79,"%lu",b);
+      WIDGET(label_10)->setText(text);
+      //
+#ifdef CUSTOM_SLIDER
+      slider->setA(a);
+      slider->setB(b);
+#endif
+}
+/**
+    \fn     UI_getCurrentVCodec(void)
+    \brief  Returns the current selected video code in menu, i.e its number (0 being the first)
+*/
+
+int 	UI_getCurrentVCodec(void)
+{
+  int i=WIDGET(comboBoxVideo)->currentIndex();
+  if(i<0) i=0;
+  return i; 
+}
+/**
+    \fn     UI_setVideoCodec( int i)
+    \brief  Select the video codec which is # x in pulldown menu (starts at zero :copy)
+*/
+
+void UI_setVideoCodec( int i)
+{
+  int b=!!i;
+    WIDGET(comboBoxVideo)->setCurrentIndex(i);
+    
+     WIDGET(pushButtonVideoConf)->setEnabled(b);
+     WIDGET(pushButtonVideoFilter)->setEnabled(b);
+}
+/**
+    \fn     UI_getCurrentACodec(void)
+    \brief  Returns the current selected audio code in menu, i.e its number (0 being the first)
+*/
+
+int 	UI_getCurrentACodec(void)
+{
+   int i=WIDGET(comboBoxAudio)->currentIndex();
+  if(i<0) i=0;
+  return i; 
+}
+/**
+    \fn     UI_setAudioCodec( int i)
+    \brief  Select the audio codec which is # x in pulldown menu (starts at zero :copy)
+*/
+
+void UI_setAudioCodec( int i)
+{ int b=!!i;
+   WIDGET(comboBoxAudio)->setCurrentIndex(i);
+    WIDGET(pushButtonAudioConf)->setEnabled(b);
+    WIDGET(pushButtonAudioFilter)->setEnabled(b);
+}
+/**
+    \fn     UI_GetCurrentFormat(void)
+    \brief  Returns the current selected output format
+*/
+
+ADM_OUT_FORMAT 	UI_GetCurrentFormat( void )
+{
+    int i=WIDGET(comboBoxFormat)->currentIndex();
+  if(i<0) i=0;
+  return (ADM_OUT_FORMAT)i; 
+}
+/**
+    \fn     UI_SetCurrentFormat( ADM_OUT_FORMAT fmt )
+    \brief  Select  output format
+*/
+uint8_t 	UI_SetCurrentFormat( ADM_OUT_FORMAT fmt )
+{
+    WIDGET(comboBoxFormat)->setCurrentIndex((int)fmt);
+}
+uint8_t UI_sliderResize(uint32_t w)
+{
+  printf("sliderResize %u\n",w);
+  slider->resize(w,w);
+  return 1; 
+}
+/**
+      \fn GUI_initCustom
+      \brief Initialize custom menu
+*/
+void GUI_initCustom(void )
+{
+  char *customdir=ADM_getCustomDir();
+  if(!customdir) 
+  {
+      printf("No custom dir...\n");
+      return;
+  }
+  /* Collect the name */
+   if(! buildDirectoryContent(&ADM_nbCustom,customdir, customNames,ADM_MAC_CUSTOM_SCRIPT,".js"))
+    {
+      printf("Failed to build custom dir content");
+      return;
+    }
+  if(!ADM_nbCustom)
+  {
+      printf("No custom script\n");
+  }
+  printf("Found %u custom scripts, adding them\n",ADM_nbCustom);
+}
+/**
+      \fn UI_getTimeShift
+      \brief get state (on/off) and value for time Shift
+*/
+uint8_t UI_getTimeShift(int *onoff,int *value)
+{
+  if(WIDGET(checkBox_TimeShift)->checkState()==Qt::Checked)
+        *onoff=1;
+  else
+        *onoff=0;
+  *value=WIDGET(spinBox_TimeValue)->value();
+  return 1;
+}
+/**
+      \fn UI_setTimeShift
+      \brief get state (on/off) and value for time Shift
+*/
+
+uint8_t UI_setTimeShift(int onoff,int value)
+{
+  if(onoff)
+    WIDGET(checkBox_TimeShift)->setCheckState(Qt::Checked);
+  else
+    WIDGET(checkBox_TimeShift)->setCheckState(Qt::Unchecked);
+  WIDGET(spinBox_TimeValue)->setValue(value);
+  return 1;
+}
+
+//********************************************
+//EOF

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/T_preview.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/T_preview.cpp	2007-07-24 00:42:36 UTC (rev 3441)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/T_preview.cpp	2007-07-24 18:53:25 UTC (rev 3442)
@@ -37,14 +37,14 @@
 #if !defined(ADM_WIN32) && !defined(__APPLE__)
 #include <QX11Info>
 #endif
-#include "fourcc.h"
 #include "avio.hxx"
 
 #include "ADM_colorspace/ADM_rgb.h"
 #include "GUI_render.h"
 #include "GUI_accelRender.h"
 #include "prefs.h"
-#include <ADM_assert.h>
+#include "ADM_assert.h"
+#include "ui_gui2.h"
     
 void UI_QT4VideoWidget(QFrame *host);
 static QFrame *hostFrame=NULL;
@@ -146,37 +146,40 @@
     
 }
 
-#define ADM_RSZ(a,x,y) {a->resize(x,y);a->setMinimumSize(x,y);}
-#define ADM_RSZ_MAX(a,x,y) {a->resize(x,y);a->setMinimumSize(x,y);a->setMaximumSize(x,y);}
+#define ADM_RSZ(a,x,y) {a->setMinimumSize(x,y); a->resize(x,y);}
+#define ADM_RSZ_MAX(a,x,y) {a->setMinimumSize(x,y); a->setMaximumSize(x,y); a->resize(x,y);}
 /**
       \brief Resize the window
 */
 void  UI_updateDrawWindowSize(void *win,uint32_t w,uint32_t h)
 {
-  if(displayW==w && displayH==h && rgbDataBuffer) return ;
-  if(rgbDataBuffer) delete [] rgbDataBuffer;
-  rgbDataBuffer=NULL;
-  rgbDataBuffer=new uint8_t [w*h*4]; // 32 bits / color
-  displayW=w;
-  displayH=h;
-  // Resize Host window
-  // It depends on where the frame start
-  printf("[RDR] %d x %d\n",hostFrame->x(),hostFrame->y());
-  uint32_t totalw=displayW+hostFrame->x();
-  uint32_t totalh=displayH+hostFrame->y()+50;
-  ADM_RSZ(QuiMainWindows,totalw,totalh);
-  // And resize child windows
-  
-  ADM_RSZ_MAX(hostFrame,displayW,displayH);
-  ADM_RSZ_MAX(videoWindow,displayW,displayH);
-  
-  UI_sliderResize(w);
-  
-  UI_purge();
-  
+	if(displayW == w && displayH == h && rgbDataBuffer)
+		return;
 
-  printf("[RDR] Resizing to %u x %u\n",displayW,displayH);
-  return ;
+	QMainWindow *mainWindow = (QMainWindow*)hostFrame->parentWidget()->parentWidget();
+	QWidget *centralWidget = hostFrame->parentWidget();
+
+	uint32_t totalW = w + hostFrame->x();
+	uint32_t totalH = (mainWindow->height() - centralWidget->height()) + hostFrame->y() + h;
+
+	if(rgbDataBuffer)
+		delete[] rgbDataBuffer;
+
+	rgbDataBuffer = new uint8_t[w * h * 4]; // 32 bits / color
+	displayW = w;
+	displayH = h;
+
+	// Resize host window
+	ADM_RSZ(QuiMainWindows, totalW, totalH);
+
+	// And resize child windows
+	ADM_RSZ_MAX(hostFrame, displayW, displayH);
+	ADM_RSZ_MAX(videoWindow, displayW, displayH);
+
+	UI_sliderResize(w);
+	UI_purge();
+
+	printf("[RDR] Resizing to %u x %u\n", displayW, displayH);
 }
 /**
       \brief Retrieve info from window, needed for accel layer

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui_none.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui_none.cpp	2007-07-24 00:42:36 UTC (rev 3441)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui_none.cpp	2007-07-24 18:53:25 UTC (rev 3442)
@@ -8,63 +8,27 @@
 //
 //
 
-#include <config.h>
-#include <stdio.h>
-#include <stdlib.h>
-#include "default.h"
-#include "ADM_toolkit/toolkit.hxx"
-#include "GUI_ui.h"
+#include "config.h"
 
-static ADM_OUT_FORMAT format=ADM_AVI;
-static int audioCodec=0;
-static int videoCodec=0;
-//**************************************************
-//**************************************************
+#include <QtGui/QApplication>
+#include <QtGui/QDesktopWidget>
 
-//**************************************************
-//**************************************************
-void UI_setAProcessToggleStatus( uint8_t status )
-{}
-void UI_setVProcessToggleStatus( uint8_t status )
-{}
+void UI_setAProcessToggleStatus( uint8_t status ) {}
+void UI_setVProcessToggleStatus( uint8_t status ) {}
+void UI_iconify( void ) {}
+void UI_deiconify( void ) {}
+uint32_t UI_readCurFrame( void ) {return 0;}
+void UI_JumpDone(void) {}
+void UI_toogleSide(void) {}
+void UI_toogleMain(void) {}
+uint8_t UI_arrow_enabled(void) {return 1;}
+uint8_t UI_arrow_disabled(void) {return 1;}
 
-//**************************************************
-
-
-void UI_iconify( void )
-{}
-void UI_deiconify( void )
-{}
-
-uint32_t UI_readCurFrame( void )
+uint8_t UI_getPhysicalScreenSize(uint32_t *w,uint32_t *h)
 {
-    return 0;
-}
-void UI_JumpDone(void)
-{}
+	QRect qrect = QApplication::desktop()->availableGeometry();
 
-
-void UI_toogleSide(void)
-{}
-void UI_toogleMain(void)
-{}
-
-
-
-uint8_t UI_shrink(uint32_t w,uint32_t h)
-{
-  return 1;
+	*w = (uint32_t)qrect.width();
+	*h = (uint32_t)qrect.height();
 }
-uint8_t UI_arrow_enabled(void)
-{
-  return 1;
-}
-uint8_t UI_arrow_disabled(void)
-{
-  return 1;
-}
-uint8_t UI_getPhysicalScreenSize(uint32_t *w,uint32_t *h)
-{
-  *w=*h=10000; 
-}
 // EOF

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/GUI_render.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/GUI_render.cpp	2007-07-24 00:42:36 UTC (rev 3441)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/GUI_render.cpp	2007-07-24 18:53:25 UTC (rev 3442)
@@ -46,9 +46,7 @@
 
 
 extern uint8_t BitBlit(uint8_t *dst, uint32_t pitchDest,uint8_t *src,uint32_t pitchSrc,uint32_t width, uint32_t height);
-
 extern void UI_purge(void);
-extern uint8_t UI_shrink(uint32_t w,uint32_t h);
 
 static uint8_t	updateWindowSize(void * win, uint32_t w, uint32_t h);
 static uint8_t  GUI_ConvertRGB(uint8_t * in, uint8_t * out, uint32_t w, uint32_t h);

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/GUI_ui.h
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/GUI_ui.h	2007-07-24 00:42:36 UTC (rev 3441)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/GUI_ui.h	2007-07-24 18:53:25 UTC (rev 3442)
@@ -44,7 +44,6 @@
 
 uint8_t UI_updateRecentMenu( void );
 
-uint8_t UI_shrink(uint32_t w,uint32_t h);
 uint8_t UI_arrow_enabled(void);
 uint8_t UI_arrow_disabled(void);
 #endif



From gruntster at mail.berlios.de  Tue Jul 24 21:09:09 2007
From: gruntster at mail.berlios.de (gruntster at mail.berlios.de)
Date: Tue, 24 Jul 2007 21:09:09 +0200
Subject: [Avidemux-svn-commit] r3443 -
	branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui
Message-ID: <200707241909.l6OJ99Du018516@sheep.berlios.de>

Author: gruntster
Date: 2007-07-24 21:08:47 +0200 (Tue, 24 Jul 2007)
New Revision: 3443

Modified:
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/T_preview.cpp
Log:
[Playback] fix for Linux

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/T_preview.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/T_preview.cpp	2007-07-24 18:53:25 UTC (rev 3442)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/T_preview.cpp	2007-07-24 19:08:47 UTC (rev 3443)
@@ -30,6 +30,7 @@
 #include <QtGui/QButtonGroup>
 #include <QtGui/QFrame>
 #include <QtGui/QGraphicsView>
+#include <QtGui/QSlider>
 #include <QMessageBox>
 #include <QPainter>
 #include <QImage>



From mean at mail.berlios.de  Wed Jul 25 19:39:37 2007
From: mean at mail.berlios.de (mean at BerliOS)
Date: Wed, 25 Jul 2007 19:39:37 +0200
Subject: [Avidemux-svn-commit] r3444 - branches/avidemux_2.4_branch
Message-ID: <200707251739.l6PHdbHp004170@sheep.berlios.de>

Author: mean
Date: 2007-07-25 19:39:35 +0200 (Wed, 25 Jul 2007)
New Revision: 3444

Modified:
   branches/avidemux_2.4_branch/ConfigureChecks.cmake
Log:
[CMAKE] Sikon patch for FAAC/X264 inc/lib flags

Modified: branches/avidemux_2.4_branch/ConfigureChecks.cmake
===================================================================
--- branches/avidemux_2.4_branch/ConfigureChecks.cmake	2007-07-24 19:08:47 UTC (rev 3443)
+++ branches/avidemux_2.4_branch/ConfigureChecks.cmake	2007-07-25 17:39:35 UTC (rev 3444)
@@ -284,8 +284,10 @@
 # X264
 ########################################
 SET(CMAKE_REQUIRED_FLAGS "-include stdint.h")
+SET(CMAKE_REQUIRED_LIBRARIES "-lm -lpthread")
 ADM_CHECK_HL(x264 x264.h x264 x264_encoder_open USE_X264)
 SET(CMAKE_REQUIRED_FLAGS)
+SET(CMAKE_REQUIRED_LIBRARIES)
 ########################################
 # PNG
 ########################################
@@ -318,9 +320,9 @@
 ########################################
 # FAAC
 ########################################
+SET(CMAKE_REQUIRED_FLAGS "-include stdint.h")
 ADM_CHECK_HL(FAAC faac.h faac faacEncClose USE_FAAC)
-
-
+SET(CMAKE_REQUIRED_FLAGS)
 ########################################
 # FreeType
 ########################################



From mean at mail.berlios.de  Wed Jul 25 20:17:35 2007
From: mean at mail.berlios.de (mean at BerliOS)
Date: Wed, 25 Jul 2007 20:17:35 +0200
Subject: [Avidemux-svn-commit] r3445 - in
	branches/avidemux_2.4_branch/avidemux: . ADM_ocr
	ADM_userInterfaces/ADM_GTK/ADM_ocr
	ADM_userInterfaces/ADM_NONE/ADM_dialog
	ADM_userInterfaces/ADM_QT4/ADM_dialog
	ADM_userInterfaces/ADM_commonUI
Message-ID: <200707251817.l6PIHZEB007138@sheep.berlios.de>

Author: mean
Date: 2007-07-25 20:17:34 +0200 (Wed, 25 Jul 2007)
New Revision: 3445

Added:
   branches/avidemux_2.4_branch/avidemux/ADM_ocr/ADM_ocrInternal.h
Modified:
   branches/avidemux_2.4_branch/avidemux/ADM_ocr/ADM_ocr.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_ocr/ADM_ocr.h
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_ocr/adm_ocr.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_NONE/ADM_dialog/DIA_none.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_none.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp
   branches/avidemux_2.4_branch/avidemux/gtk_gui.cpp
Log:
[OCR] Preparatory work for TS ocr

Modified: branches/avidemux_2.4_branch/avidemux/ADM_ocr/ADM_ocr.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_ocr/ADM_ocr.cpp	2007-07-25 17:39:35 UTC (rev 3444)
+++ branches/avidemux_2.4_branch/avidemux/ADM_ocr/ADM_ocr.cpp	2007-07-25 18:17:34 UTC (rev 3445)
@@ -16,7 +16,12 @@
  #include <string.h>
  #include "ADM_assert.h"
  #include "default.h"
+
+ #include "ADM_editor/ADM_edit.hxx"
+ #include "ADM_video/ADM_genvideo.hxx"
+
  #include "ADM_ocr.h"
+#include "ADM_ocrInternal.h"
  #include "ADM_toolkit/toolkit.hxx"
  #include "ADM_userInterfaces/ADM_commonUI/DIA_enter.h"
 

Modified: branches/avidemux_2.4_branch/avidemux/ADM_ocr/ADM_ocr.h
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_ocr/ADM_ocr.h	2007-07-25 17:39:35 UTC (rev 3444)
+++ branches/avidemux_2.4_branch/avidemux/ADM_ocr/ADM_ocr.h	2007-07-25 18:17:34 UTC (rev 3445)
@@ -1,34 +1,40 @@
-//
-// C++ Interface: %{MODULE}
-//
-// Description: 
-//
-//
-// Author: %{AUTHOR} <%{EMAIL}>, (C) %{YEAR}
-//
-// Copyright: See COPYING file that comes with this distribution
-//
-//
+/***************************************************************************
+                         
+     External Interface for OCR engine
+     
+    copyright            : (C) 2007 by mean
+    email                : fixounet at free.fr
+ ***************************************************************************/
+
+/***************************************************************************
+ *                                                                         *
+ *   This program is free software; you can redistribute it and/or modify  *
+ *   it under the terms of the GNU General Public License as published by  *
+ *   the Free Software Foundation; either version 2 of the License, or     *
+ *   (at your option) any later version.                                   *
+ *                                                                         *
+ ***************************************************************************/
 #ifndef ADM_OCR_H
 #define ADM_OCR_H
-#include "adm_glyph.h"
+#include "ADM_video/ADM_vobsubinfo.h"
+#include "ADM_video/ADM_vidVobSub.h"
+#include "ADM_ocr/adm_glyph.h"
+typedef enum
+{
+	ADM_OCR_TYPE_VOBSUB=1,
+	ADM_OCR_TYPE_TS=2,
+}ADM_OCR_SOURCE_TYPE;
 
 
-typedef enum 
+typedef struct
 {
-        ReplyOk=1,
-        ReplyClose=0,
-        ReplyCalibrate=2,
-        ReplySkip=3,
-        ReplySkipAll=4
-}ReplyType;
-// GUI independant part
-ReplyType handleGlyph(uint8_t *workArea,uint32_t start, uint32_t end,uint32_t w,uint32_t h,uint32_t base,admGlyph *head);
-ReplyType ocrBitmap(uint8_t *workArea,uint32_t w,uint32_t h,char *decodedString,admGlyph *head);
-uint8_t   mergeBitmap(uint8_t *bitin, uint8_t *bitout, uint8_t *maskin,uint32_t w, uint32_t h);
-void ocrUpdateMinThreshold(void);
+	ADM_OCR_SOURCE_TYPE type;
+	vobSubParam *subparam;
+	char		*TsFile;
+}ADM_OCR_SOURCE;
 
-// In GUI dependant part
-ReplyType glyphToText(admGlyph *glyph,admGlyph *head);
 
+uint8_t ADM_ocr_engine(   ADM_OCR_SOURCE & source,const char *labelSrt,admGlyph *head);
+
+
 #endif 

Copied: branches/avidemux_2.4_branch/avidemux/ADM_ocr/ADM_ocrInternal.h (from rev 3443, branches/avidemux_2.4_branch/avidemux/ADM_ocr/ADM_ocr.h)
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_ocr/ADM_ocr.h	2007-07-24 19:08:47 UTC (rev 3443)
+++ branches/avidemux_2.4_branch/avidemux/ADM_ocr/ADM_ocrInternal.h	2007-07-25 18:17:34 UTC (rev 3445)
@@ -0,0 +1,34 @@
+/***************************************************************************
+                         
+     Internal Interface for OCR engine
+     
+    copyright            : (C) 2007 by mean
+    email                : fixounet at free.fr
+ ***************************************************************************/
+
+#ifndef ADM_OCR_INTERNAL_H
+#define ADM_OCR_INTERNAL_H
+ 
+#include "adm_glyph.h"
+
+
+typedef enum 
+{
+        ReplyOk=1,
+        ReplyClose=0,
+        ReplyCalibrate=2,
+        ReplySkip=3,
+        ReplySkipAll=4
+}ReplyType;
+
+// GUI independant part
+ReplyType handleGlyph(uint8_t *workArea,uint32_t start, uint32_t end,uint32_t w,uint32_t h,uint32_t base,admGlyph *head);
+ReplyType ocrBitmap(uint8_t *workArea,uint32_t w,uint32_t h,char *decodedString,admGlyph *head);
+uint8_t   mergeBitmap(uint8_t *bitin, uint8_t *bitout, uint8_t *maskin,uint32_t w, uint32_t h);
+void ocrUpdateMinThreshold(void);
+
+// In GUI dependant part
+ReplyType glyphToText(admGlyph *glyph,admGlyph *head);
+
+
+#endif 

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_ocr/adm_ocr.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_ocr/adm_ocr.cpp	2007-07-25 17:39:35 UTC (rev 3444)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_ocr/adm_ocr.cpp	2007-07-25 18:17:34 UTC (rev 3445)
@@ -67,6 +67,7 @@
 #include "ADM_video/ADM_vidVobSub.h"
 #include "ADM_leftturn.h"
 #include "DIA_enter.h"
+#include "ADM_ocrInternal.h"
 #include "ADM_ocr.h"
 /******************************/
 
@@ -114,7 +115,7 @@
         Main
    +++++++++++++++++++++++++++++++++++++++++++++++++++++++ */
    
-uint8_t ADM_ocr_engine(  vobSubParam *subparam,const char *labelSrt,admGlyph *head)
+uint8_t ADM_ocr_engine(   ADM_OCR_SOURCE & source,const char *labelSrt,admGlyph *head)
 {
 // 
     uint32_t nbSub=0;
@@ -181,7 +182,7 @@
        goto endIt;
     }
      
-    vobsub=new ADMVideoVobSub(subparam->subname,subparam->index);
+    vobsub=new ADMVideoVobSub(source.subparam->subname,source.subparam->index);
     nbSub=vobsub->getNbImage();
    
     if(!nbSub)

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_NONE/ADM_dialog/DIA_none.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_NONE/ADM_dialog/DIA_none.cpp	2007-07-25 17:39:35 UTC (rev 3444)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_NONE/ADM_dialog/DIA_none.cpp	2007-07-25 18:17:34 UTC (rev 3445)
@@ -63,7 +63,7 @@
 #include "ADM_codecs/ADM_ffmpegConfig.h"
 
 #include "DIA_resizeWiz.h"
-    
+#include "ADM_ocr/ADM_ocr.h"
 #include "ADM_assert.h"
 int SliderIsShifted=0;
 
@@ -161,7 +161,7 @@
 }
 uint8_t DIA_glyphEdit(void) {return 0;};
 #include "ADM_ocr/adm_glyph.h"
-uint8_t ADM_ocr_engine(  vobSubParam *subparam,const char *labelSrt,admGlyph *head)
+uint8_t ADM_ocr_engine(   ADM_OCR_SOURCE & source,const char *labelSrt,admGlyph *head)
 {
   return 0; 
 }

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_none.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_none.cpp	2007-07-25 17:39:35 UTC (rev 3444)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_none.cpp	2007-07-25 18:17:34 UTC (rev 3445)
@@ -104,8 +104,8 @@
 {
   return 0; 
 }
-#include "ADM_ocr/adm_glyph.h"
-uint8_t ADM_ocr_engine(  vobSubParam *subparam,const char *labelSrt,admGlyph *head)
+#include "ADM_ocr/ADM_ocr.h"
+uint8_t ADM_ocr_engine(   ADM_OCR_SOURCE & source,const char *labelSrt,admGlyph *head)
 {
   return 0; 
 }

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp	2007-07-25 17:39:35 UTC (rev 3444)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp	2007-07-25 18:17:34 UTC (rev 3445)
@@ -45,8 +45,10 @@
 #include "prefs.h"
 #include "ADM_assert.h"
 
+#include "ADM_ocr/ADM_ocr.h"
+
 extern uint8_t DIA_vobsub(vobSubParam *param);
-extern uint8_t ADM_ocr_engine(  vobSubParam *subparam,const char *labelSrt,admGlyph *head);
+
 static void cb_idx(void *foo);
 static void cleanupSub(vobSubParam *p);
 /**
@@ -129,7 +131,10 @@
             printf("[GLYPH] Found %u glyph\n");
          }
         // We have our SRT and our idx/sub files : Go go go
-        ADM_ocr_engine(&subparam,srtFileName,&head);
+         ADM_OCR_SOURCE source;
+         source.type=ADM_OCR_TYPE_VOBSUB;
+         source.subparam=&subparam;
+        ADM_ocr_engine(source,srtFileName,&head);
         
         // Save glyph set 
 _save:

Modified: branches/avidemux_2.4_branch/avidemux/gtk_gui.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/gtk_gui.cpp	2007-07-25 17:39:35 UTC (rev 3444)
+++ branches/avidemux_2.4_branch/avidemux/gtk_gui.cpp	2007-07-25 18:17:34 UTC (rev 3445)
@@ -146,7 +146,6 @@
 extern uint8_t A_autoDrive(Action action);
 int ignore_change;
 
-extern uint8_t ADM_ocr_engine( void);
 extern uint8_t DIA_ocrGen(void);
 uint8_t A_TimeShift(void);
 PARAM_MUX muxMode = MUX_REGULAR;
@@ -227,7 +226,6 @@
         case ACT_ViewSide: UI_toogleSide();return;
       case ACT_Ocr:
                 DIA_ocrGen(); //
-                //ADM_ocr_engine( );
                 return;
       case ACT_AudioConfigure:
     		audioCodecSelect();



From gruntster at mail.berlios.de  Thu Jul 26 15:34:21 2007
From: gruntster at mail.berlios.de (gruntster at mail.berlios.de)
Date: Thu, 26 Jul 2007 15:34:21 +0200
Subject: [Avidemux-svn-commit] r3446 - in
	branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces:
	ADM_GTK/ADM_dialog ADM_GTK/ADM_gui2 ADM_QT4/ADM_dialog ADM_commonUI
Message-ID: <200707261334.l6QDYLYs017021@sheep.berlios.de>

Author: gruntster
Date: 2007-07-26 15:33:46 +0200 (Thu, 26 Jul 2007)
New Revision: 3446

Modified:
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_asharp.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_chromaShift.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_contrast.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_crop.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_eq2.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_equalizer.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_flyDialog.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_hue.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_mpdelogo.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_preview.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_srt.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_gtkRender.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/T_flyDialog.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_flyAsharp.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_flyAsharp.h
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_flyChromaShift.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_flyChromaShift.h
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_flyContrast.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_flyContrast.h
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_flyCrop.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_flyCrop.h
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_flyDialog.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_flyDialog.h
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_flyHue.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_flyHue.h
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_flyPreview.h
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_flySrtPos.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_flySrtPos.h
Log:
[Preview] centralise all resize logic to flyDialog + manually centre filter windows + optimise YUV & RGB resizing

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_asharp.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_asharp.cpp	2007-07-25 18:17:34 UTC (rev 3445)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_asharp.cpp	2007-07-26 13:33:46 UTC (rev 3446)
@@ -54,8 +54,6 @@
 static GtkWidget *dialog=NULL;
 static flyASharp *myCrop=NULL;
 
-extern float UI_calcZoomToFitScreen(GtkWindow* window, GtkWidget* drawingArea, uint32_t imageWidth, uint32_t imageHeight);
-
 //
 //      Video is in YV12 Colorspace
 //
@@ -71,19 +69,6 @@
         dialog=create_dialog1();
         gtk_register_dialog(dialog);
         gtk_window_set_title (GTK_WINDOW (dialog), _("ASHARP"));
-
-		float zoom = UI_calcZoomToFitScreen(GTK_WINDOW(dialog), WID(drawingarea1), width, height);
-
-		uint32_t zoomW = width * zoom;
-		uint32_t zoomH = height * zoom;
-
-		gtk_widget_set_usize(WID(drawingarea1), zoomW, zoomH);
-
-		if (zoom < 1)
-		{
-			gtk_window_set_position(GTK_WINDOW(dialog), GTK_WIN_POS_CENTER);
-		}
-
         gtk_widget_show(dialog);
 
         gtk_signal_connect(GTK_OBJECT(WID(drawingarea1)), "expose_event",
@@ -99,7 +84,6 @@
           
         myCrop=new flyASharp( width, height,in,WID(drawingarea1),WID(hscale1));
         memcpy(&(myCrop->param),param,sizeof(ASHARP_PARAM));
-		myCrop->resizeImage(zoomW, zoomH);
         myCrop->upload();
         myCrop->sliderChanged();
         ret=0;

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_chromaShift.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_chromaShift.cpp	2007-07-25 18:17:34 UTC (rev 3445)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_chromaShift.cpp	2007-07-26 13:33:46 UTC (rev 3446)
@@ -1,308 +1,293 @@
-/***************************************************************************
-                          ADM_guiChromaShift.cpp  -  description
-                             -------------------
-    begin                : Sun Aug 24 2003
-    copyright            : (C) 2002-2003 by mean
-    email                : fixounet at free.fr
- ***************************************************************************/
-
-/***************************************************************************
- *                                                                         *
- *   This program is free software; you can redistribute it and/or modify  *
- *   it under the terms of the GNU General Public License as published by  *
- *   the Free Software Foundation; either version 2 of the License, or     *
- *   (at your option) any later version.                                   *
- *                                                                         *
- ***************************************************************************/
-#include <config.h>
-#include <string.h>
-#include <stdio.h>
-#include <gdk/gdkkeysyms.h>
-#include <gtk/gtk.h>
-# include <math.h>
-
-#include "default.h"
-#include "ADM_toolkit_gtk/toolkit_gtk.h"
-#include "ADM_toolkit_gtk/toolkit_gtk_include.h"
-#include "ADM_toolkit/toolkit.hxx"
-
-#include "ADM_image.h"
-#include "ADM_video/ADM_genvideo.hxx"
-#include "ADM_colorspace/ADM_rgb.h"
-#include "ADM_assert.h"
-#include "DIA_flyDialog.h"
-#include "ADM_videoFilter/ADM_vidChromaShift_param.h"
-#include "DIA_flyChromaShift.h"
-
-static int lock=0;
-
-static GtkWidget *dialog;
-static GtkWidget *create_ChromaShift( void );
-
-
-static void read( void );
-static void upload ( void );
-static gboolean gui_draw( void );
-static gboolean gui_update( void );
-static gboolean slider_update( void );
-static void update(void);
-
-static flyChromaShift *myCrop=NULL;
-
-extern float UI_calcZoomToFitScreen(GtkWindow* window, GtkWidget* drawingArea, uint32_t imageWidth, uint32_t imageHeight);
-//**************************************
-
-uint8_t DIA_getChromaShift( AVDMGenericVideoStream *instream,CHROMASHIFT_PARAM    *param );
-uint8_t DIA_getChromaShift( AVDMGenericVideoStream *in,CHROMASHIFT_PARAM    *param )
-{
-uint8_t ret=0;
-  
-        uint32_t width,height;
-
-        // Allocate space for green-ised video
-        width=in->getInfo()->width;
-        height=in->getInfo()->height;
-
-        dialog=create_ChromaShift();
-        gtk_register_dialog(dialog);
-        gtk_window_set_title (GTK_WINDOW (dialog), _("ASHARP"));
-
-		float zoom = UI_calcZoomToFitScreen(GTK_WINDOW(dialog), WID(drawingarea1), width, height);
+/***************************************************************************
+                          ADM_guiChromaShift.cpp  -  description
+                             -------------------
+    begin                : Sun Aug 24 2003
+    copyright            : (C) 2002-2003 by mean
+    email                : fixounet at free.fr
+ ***************************************************************************/
 
-		uint32_t zoomW = width * zoom;
-		uint32_t zoomH = height * zoom;
+/***************************************************************************
+ *                                                                         *
+ *   This program is free software; you can redistribute it and/or modify  *
+ *   it under the terms of the GNU General Public License as published by  *
+ *   the Free Software Foundation; either version 2 of the License, or     *
+ *   (at your option) any later version.                                   *
+ *                                                                         *
+ ***************************************************************************/
+#include <config.h>
+#include <string.h>
+#include <stdio.h>
+#include <gdk/gdkkeysyms.h>
+#include <gtk/gtk.h>
+# include <math.h>
 
-		gtk_widget_set_usize(WID(drawingarea1), zoomW, zoomH);
+#include "default.h"
+#include "ADM_toolkit_gtk/toolkit_gtk.h"
+#include "ADM_toolkit_gtk/toolkit_gtk_include.h"
+#include "ADM_toolkit/toolkit.hxx"
 
-		if (zoom < 1)
-		{
-			gtk_window_set_position(GTK_WINDOW(dialog), GTK_WIN_POS_CENTER);
-		}
-
-        gtk_widget_show(dialog);
-	
-        myCrop=new flyChromaShift( width, height,in,WID(drawingarea1),WID(hscale));
-        memcpy(&(myCrop->param),param,sizeof(CHROMASHIFT_PARAM));
-		myCrop->resizeImage(zoomW, zoomH);
-        myCrop->upload();
-        myCrop->sliderChanged();
-        
-        gtk_signal_connect(GTK_OBJECT(WID(drawingarea1)), "expose_event",
-            GTK_SIGNAL_FUNC(gui_draw),
-            NULL);
-        
-        gtk_signal_connect (GTK_OBJECT(WID( spinbutton_U)), "value_changed",
-                    GTK_SIGNAL_FUNC (gui_update),
-                    NULL);
-        gtk_signal_connect (GTK_OBJECT(WID( spinbutton_V)), "value_changed",
-                    GTK_SIGNAL_FUNC (gui_update),
-                    NULL);
-        gtk_signal_connect (GTK_OBJECT(WID( spinbutton_V)), "value_changed",
-                    GTK_SIGNAL_FUNC (gui_update),
-                    NULL);
-         gtk_signal_connect (GTK_OBJECT(WID( hscale)), "value_changed",
-                    GTK_SIGNAL_FUNC (slider_update),
-                    NULL);
-
-          
-       
-        ret=0;
-        int response;
-        response=gtk_dialog_run(GTK_DIALOG(dialog));
-
-        if(response==GTK_RESPONSE_OK)
-        {
-            myCrop->download();
-            memcpy(param,&(myCrop->param),sizeof(CHROMASHIFT_PARAM));
-            ret=1;
-        }
-        gtk_unregister_dialog(dialog);
-        gtk_widget_destroy(dialog);
-        delete myCrop;
-        return ret;
-}
-      
-/**********************************/
-void read( void )
-{
-	myCrop->download();
-}
-void upload ( void )
-{
-	myCrop->upload();
-}
-gboolean slider_update( void )
-{
-        myCrop->sliderChanged();
-        return true;
-}
-gboolean gui_update( void)
-{
-  if(lock) return true;
-      myCrop->update();
-  return true;
-}
-gboolean gui_draw( void )
-{
-	myCrop->display();
-	return true;
-}
-
-/******************************/
-#define SPIN_GET(x,y) {y= gtk_spin_button_get_value_as_int(GTK_SPIN_BUTTON(lookup_widget(dialog,#x))) ;\
-				printf(#x":%d\n", y);}
-
-#define SPIN_SET(x,y)  {gtk_spin_button_set_value(GTK_SPIN_BUTTON(lookup_widget(dialog,#x)),(gfloat)y) ; printf(#x":%d\n", y);}
-
-
-uint8_t    flyChromaShift::upload(void)
-{
-        SPIN_SET(spinbutton_U,param.u);
-        SPIN_SET(spinbutton_V,param.v);
-  return 1;
-}
-uint8_t    flyChromaShift::download(void)
-{
-        SPIN_GET(spinbutton_U,param.u);
-        SPIN_GET(spinbutton_V,param.v);
-  
-  return 1;
-}
-
-
-/*----------------------------------------------------------------*/
-
-GtkWidget*
-create_ChromaShift (void)
-{
-  GtkWidget *ChromaShift;
-  GtkWidget *dialog_vbox1;
-  GtkWidget *vbox1;
-  GtkWidget *table1;
-  GtkWidget *label1;
-  GtkWidget *label2;
-  GtkObject *spinbutton_U_adj;
-  GtkWidget *spinbutton_U;
-  GtkObject *spinbutton_V_adj;
-  GtkWidget *spinbutton_V;
-  GtkWidget *hscale;
-  GtkWidget *frame1;
-  GtkWidget *alignment1;
-  GtkWidget *drawingarea1;
-  GtkWidget *label3;
-  GtkWidget *dialog_action_area1;
-  GtkWidget *cancelbutton1;
-  GtkWidget *applybutton1;
-  GtkWidget *okbutton1;
-
-  ChromaShift = gtk_dialog_new ();
-  gtk_window_set_title (GTK_WINDOW (ChromaShift), _("ChromaShift"));
-  gtk_window_set_type_hint (GTK_WINDOW (ChromaShift), GDK_WINDOW_TYPE_HINT_DIALOG);
-
-  dialog_vbox1 = GTK_DIALOG (ChromaShift)->vbox;
-  gtk_widget_show (dialog_vbox1);
-
-  vbox1 = gtk_vbox_new (FALSE, 0);
-  gtk_widget_show (vbox1);
-  gtk_box_pack_start (GTK_BOX (dialog_vbox1), vbox1, TRUE, TRUE, 0);
-
-  table1 = gtk_table_new (2, 2, FALSE);
-  gtk_widget_show (table1);
-  gtk_box_pack_start (GTK_BOX (vbox1), table1, FALSE, FALSE, 0);
-
-  label1 = gtk_label_new (_("U Shift :"));
-  gtk_widget_show (label1);
-  gtk_table_attach (GTK_TABLE (table1), label1, 0, 1, 0, 1,
-                    (GtkAttachOptions) (GTK_FILL),
-                    (GtkAttachOptions) (0), 0, 0);
-  gtk_misc_set_alignment (GTK_MISC (label1), 0, 0.5);
-
-  label2 = gtk_label_new (_("V Shift :"));
-  gtk_widget_show (label2);
-  gtk_table_attach (GTK_TABLE (table1), label2, 0, 1, 1, 2,
-                    (GtkAttachOptions) (GTK_FILL),
-                    (GtkAttachOptions) (0), 0, 0);
-  gtk_misc_set_alignment (GTK_MISC (label2), 0, 0.5);
-
-  spinbutton_U_adj = gtk_adjustment_new (0, -32, 32, 1, 10, 10);
-  spinbutton_U = gtk_spin_button_new (GTK_ADJUSTMENT (spinbutton_U_adj), 1, 0);
-  gtk_widget_show (spinbutton_U);
-  gtk_table_attach (GTK_TABLE (table1), spinbutton_U, 1, 2, 0, 1,
-                    (GtkAttachOptions) (0),
-                    (GtkAttachOptions) (0), 0, 0);
-  gtk_spin_button_set_numeric (GTK_SPIN_BUTTON (spinbutton_U), TRUE);
-
-  spinbutton_V_adj = gtk_adjustment_new (0, -32, 32, 1, 10, 10);
-  spinbutton_V = gtk_spin_button_new (GTK_ADJUSTMENT (spinbutton_V_adj), 1, 0);
-  gtk_widget_show (spinbutton_V);
-  gtk_table_attach (GTK_TABLE (table1), spinbutton_V, 1, 2, 1, 2,
-                    (GtkAttachOptions) (0),
-                    (GtkAttachOptions) (0), 0, 0);
-  gtk_spin_button_set_numeric (GTK_SPIN_BUTTON (spinbutton_V), TRUE);
-
-  hscale = gtk_hscale_new (GTK_ADJUSTMENT (gtk_adjustment_new (0, 0, 100, 1, 1, 1)));
-  gtk_widget_show (hscale);
-  gtk_box_pack_start (GTK_BOX (vbox1), hscale, FALSE, FALSE, 0);
-  gtk_scale_set_digits (GTK_SCALE (hscale), 0);
-
-  frame1 = gtk_frame_new (NULL);
-  gtk_widget_show (frame1);
-  gtk_box_pack_start (GTK_BOX (vbox1), frame1, TRUE, TRUE, 0);
-  gtk_frame_set_shadow_type (GTK_FRAME (frame1), GTK_SHADOW_NONE);
-
-  alignment1 = gtk_alignment_new (0.5, 0.5, 1, 1);
-  gtk_widget_show (alignment1);
-  gtk_container_add (GTK_CONTAINER (frame1), alignment1);
-  gtk_alignment_set_padding (GTK_ALIGNMENT (alignment1), 0, 0, 12, 0);
-
-  drawingarea1 = gtk_drawing_area_new ();
-  gtk_widget_show (drawingarea1);
-  gtk_container_add (GTK_CONTAINER (alignment1), drawingarea1);
-
-  label3 = gtk_label_new (_("<b>Preview</b>"));
-  gtk_widget_show (label3);
-  gtk_frame_set_label_widget (GTK_FRAME (frame1), label3);
-  gtk_label_set_use_markup (GTK_LABEL (label3), TRUE);
-
-  dialog_action_area1 = GTK_DIALOG (ChromaShift)->action_area;
-  gtk_widget_show (dialog_action_area1);
-  gtk_button_box_set_layout (GTK_BUTTON_BOX (dialog_action_area1), GTK_BUTTONBOX_END);
-
-  cancelbutton1 = gtk_button_new_from_stock ("gtk-cancel");
-  gtk_widget_show (cancelbutton1);
-  gtk_dialog_add_action_widget (GTK_DIALOG (ChromaShift), cancelbutton1, GTK_RESPONSE_CANCEL);
-  GTK_WIDGET_SET_FLAGS (cancelbutton1, GTK_CAN_DEFAULT);
-
-  applybutton1 = gtk_button_new_from_stock ("gtk-apply");
-  gtk_widget_show (applybutton1);
-  gtk_dialog_add_action_widget (GTK_DIALOG (ChromaShift), applybutton1, GTK_RESPONSE_APPLY);
-  GTK_WIDGET_SET_FLAGS (applybutton1, GTK_CAN_DEFAULT);
-
-  okbutton1 = gtk_button_new_from_stock ("gtk-ok");
-  gtk_widget_show (okbutton1);
-  gtk_dialog_add_action_widget (GTK_DIALOG (ChromaShift), okbutton1, GTK_RESPONSE_OK);
-  GTK_WIDGET_SET_FLAGS (okbutton1, GTK_CAN_DEFAULT);
-
-  /* Store pointers to all widgets, for use by lookup_widget(). */
-  GLADE_HOOKUP_OBJECT_NO_REF (ChromaShift, ChromaShift, "ChromaShift");
-  GLADE_HOOKUP_OBJECT_NO_REF (ChromaShift, dialog_vbox1, "dialog_vbox1");
-  GLADE_HOOKUP_OBJECT (ChromaShift, vbox1, "vbox1");
-  GLADE_HOOKUP_OBJECT (ChromaShift, table1, "table1");
-  GLADE_HOOKUP_OBJECT (ChromaShift, label1, "label1");
-  GLADE_HOOKUP_OBJECT (ChromaShift, label2, "label2");
-  GLADE_HOOKUP_OBJECT (ChromaShift, spinbutton_U, "spinbutton_U");
-  GLADE_HOOKUP_OBJECT (ChromaShift, spinbutton_V, "spinbutton_V");
-  GLADE_HOOKUP_OBJECT (ChromaShift, hscale, "hscale");
-  GLADE_HOOKUP_OBJECT (ChromaShift, frame1, "frame1");
-  GLADE_HOOKUP_OBJECT (ChromaShift, alignment1, "alignment1");
-  GLADE_HOOKUP_OBJECT (ChromaShift, drawingarea1, "drawingarea1");
-  GLADE_HOOKUP_OBJECT (ChromaShift, label3, "label3");
-  GLADE_HOOKUP_OBJECT_NO_REF (ChromaShift, dialog_action_area1, "dialog_action_area1");
-  GLADE_HOOKUP_OBJECT (ChromaShift, cancelbutton1, "cancelbutton1");
-  GLADE_HOOKUP_OBJECT (ChromaShift, applybutton1, "applybutton1");
-  GLADE_HOOKUP_OBJECT (ChromaShift, okbutton1, "okbutton1");
-
-  return ChromaShift;
-}
-
-
+#include "ADM_image.h"
+#include "ADM_video/ADM_genvideo.hxx"
+#include "ADM_colorspace/ADM_rgb.h"
+#include "ADM_assert.h"
+#include "DIA_flyDialog.h"
+#include "ADM_videoFilter/ADM_vidChromaShift_param.h"
+#include "DIA_flyChromaShift.h"
+
+static int lock=0;
+
+static GtkWidget *dialog;
+static GtkWidget *create_ChromaShift( void );
+
+
+static void read( void );
+static void upload ( void );
+static gboolean gui_draw( void );
+static gboolean gui_update( void );
+static gboolean slider_update( void );
+static void update(void);
+
+static flyChromaShift *myCrop=NULL;
+
+//**************************************
+
+uint8_t DIA_getChromaShift( AVDMGenericVideoStream *instream,CHROMASHIFT_PARAM    *param );
+uint8_t DIA_getChromaShift( AVDMGenericVideoStream *in,CHROMASHIFT_PARAM    *param )
+{
+uint8_t ret=0;
+  
+        uint32_t width,height;
+
+        // Allocate space for green-ised video
+        width=in->getInfo()->width;
+        height=in->getInfo()->height;
+
+        dialog=create_ChromaShift();
+        gtk_register_dialog(dialog);
+        gtk_window_set_title (GTK_WINDOW (dialog), _("ASHARP"));
+        gtk_widget_show(dialog);
+	
+        myCrop=new flyChromaShift( width, height,in,WID(drawingarea1),WID(hscale));
+        memcpy(&(myCrop->param),param,sizeof(CHROMASHIFT_PARAM));
+        myCrop->upload();
+        myCrop->sliderChanged();
+        
+        gtk_signal_connect(GTK_OBJECT(WID(drawingarea1)), "expose_event",
+            GTK_SIGNAL_FUNC(gui_draw),
+            NULL);
+        
+        gtk_signal_connect (GTK_OBJECT(WID( spinbutton_U)), "value_changed",
+                    GTK_SIGNAL_FUNC (gui_update),
+                    NULL);
+        gtk_signal_connect (GTK_OBJECT(WID( spinbutton_V)), "value_changed",
+                    GTK_SIGNAL_FUNC (gui_update),
+                    NULL);
+        gtk_signal_connect (GTK_OBJECT(WID( spinbutton_V)), "value_changed",
+                    GTK_SIGNAL_FUNC (gui_update),
+                    NULL);
+         gtk_signal_connect (GTK_OBJECT(WID( hscale)), "value_changed",
+                    GTK_SIGNAL_FUNC (slider_update),
+                    NULL);
+
+          
+       
+        ret=0;
+        int response;
+        response=gtk_dialog_run(GTK_DIALOG(dialog));
+
+        if(response==GTK_RESPONSE_OK)
+        {
+            myCrop->download();
+            memcpy(param,&(myCrop->param),sizeof(CHROMASHIFT_PARAM));
+            ret=1;
+        }
+        gtk_unregister_dialog(dialog);
+        gtk_widget_destroy(dialog);
+        delete myCrop;
+        return ret;
+}
+      
+/**********************************/
+void read( void )
+{
+	myCrop->download();
+}
+void upload ( void )
+{
+	myCrop->upload();
+}
+gboolean slider_update( void )
+{
+        myCrop->sliderChanged();
+        return true;
+}
+gboolean gui_update( void)
+{
+  if(lock) return true;
+      myCrop->update();
+  return true;
+}
+gboolean gui_draw( void )
+{
+	myCrop->display();
+	return true;
+}
+
+/******************************/
+#define SPIN_GET(x,y) {y= gtk_spin_button_get_value_as_int(GTK_SPIN_BUTTON(lookup_widget(dialog,#x))) ;\
+				printf(#x":%d\n", y);}
+
+#define SPIN_SET(x,y)  {gtk_spin_button_set_value(GTK_SPIN_BUTTON(lookup_widget(dialog,#x)),(gfloat)y) ; printf(#x":%d\n", y);}
+
+
+uint8_t    flyChromaShift::upload(void)
+{
+        SPIN_SET(spinbutton_U,param.u);
+        SPIN_SET(spinbutton_V,param.v);
+  return 1;
+}
+uint8_t    flyChromaShift::download(void)
+{
+        SPIN_GET(spinbutton_U,param.u);
+        SPIN_GET(spinbutton_V,param.v);
+  
+  return 1;
+}
+
+
+/*----------------------------------------------------------------*/
+
+GtkWidget*
+create_ChromaShift (void)
+{
+  GtkWidget *ChromaShift;
+  GtkWidget *dialog_vbox1;
+  GtkWidget *vbox1;
+  GtkWidget *table1;
+  GtkWidget *label1;
+  GtkWidget *label2;
+  GtkObject *spinbutton_U_adj;
+  GtkWidget *spinbutton_U;
+  GtkObject *spinbutton_V_adj;
+  GtkWidget *spinbutton_V;
+  GtkWidget *hscale;
+  GtkWidget *frame1;
+  GtkWidget *alignment1;
+  GtkWidget *drawingarea1;
+  GtkWidget *label3;
+  GtkWidget *dialog_action_area1;
+  GtkWidget *cancelbutton1;
+  GtkWidget *applybutton1;
+  GtkWidget *okbutton1;
+
+  ChromaShift = gtk_dialog_new ();
+  gtk_window_set_title (GTK_WINDOW (ChromaShift), _("ChromaShift"));
+  gtk_window_set_type_hint (GTK_WINDOW (ChromaShift), GDK_WINDOW_TYPE_HINT_DIALOG);
+
+  dialog_vbox1 = GTK_DIALOG (ChromaShift)->vbox;
+  gtk_widget_show (dialog_vbox1);
+
+  vbox1 = gtk_vbox_new (FALSE, 0);
+  gtk_widget_show (vbox1);
+  gtk_box_pack_start (GTK_BOX (dialog_vbox1), vbox1, TRUE, TRUE, 0);
+
+  table1 = gtk_table_new (2, 2, FALSE);
+  gtk_widget_show (table1);
+  gtk_box_pack_start (GTK_BOX (vbox1), table1, FALSE, FALSE, 0);
+
+  label1 = gtk_label_new (_("U Shift :"));
+  gtk_widget_show (label1);
+  gtk_table_attach (GTK_TABLE (table1), label1, 0, 1, 0, 1,
+                    (GtkAttachOptions) (GTK_FILL),
+                    (GtkAttachOptions) (0), 0, 0);
+  gtk_misc_set_alignment (GTK_MISC (label1), 0, 0.5);
+
+  label2 = gtk_label_new (_("V Shift :"));
+  gtk_widget_show (label2);
+  gtk_table_attach (GTK_TABLE (table1), label2, 0, 1, 1, 2,
+                    (GtkAttachOptions) (GTK_FILL),
+                    (GtkAttachOptions) (0), 0, 0);
+  gtk_misc_set_alignment (GTK_MISC (label2), 0, 0.5);
+
+  spinbutton_U_adj = gtk_adjustment_new (0, -32, 32, 1, 10, 10);
+  spinbutton_U = gtk_spin_button_new (GTK_ADJUSTMENT (spinbutton_U_adj), 1, 0);
+  gtk_widget_show (spinbutton_U);
+  gtk_table_attach (GTK_TABLE (table1), spinbutton_U, 1, 2, 0, 1,
+                    (GtkAttachOptions) (0),
+                    (GtkAttachOptions) (0), 0, 0);
+  gtk_spin_button_set_numeric (GTK_SPIN_BUTTON (spinbutton_U), TRUE);
+
+  spinbutton_V_adj = gtk_adjustment_new (0, -32, 32, 1, 10, 10);
+  spinbutton_V = gtk_spin_button_new (GTK_ADJUSTMENT (spinbutton_V_adj), 1, 0);
+  gtk_widget_show (spinbutton_V);
+  gtk_table_attach (GTK_TABLE (table1), spinbutton_V, 1, 2, 1, 2,
+                    (GtkAttachOptions) (0),
+                    (GtkAttachOptions) (0), 0, 0);
+  gtk_spin_button_set_numeric (GTK_SPIN_BUTTON (spinbutton_V), TRUE);
+
+  hscale = gtk_hscale_new (GTK_ADJUSTMENT (gtk_adjustment_new (0, 0, 100, 1, 1, 1)));
+  gtk_widget_show (hscale);
+  gtk_box_pack_start (GTK_BOX (vbox1), hscale, FALSE, FALSE, 0);
+  gtk_scale_set_digits (GTK_SCALE (hscale), 0);
+
+  frame1 = gtk_frame_new (NULL);
+  gtk_widget_show (frame1);
+  gtk_box_pack_start (GTK_BOX (vbox1), frame1, TRUE, TRUE, 0);
+  gtk_frame_set_shadow_type (GTK_FRAME (frame1), GTK_SHADOW_NONE);
+
+  alignment1 = gtk_alignment_new (0.5, 0.5, 1, 1);
+  gtk_widget_show (alignment1);
+  gtk_container_add (GTK_CONTAINER (frame1), alignment1);
+  gtk_alignment_set_padding (GTK_ALIGNMENT (alignment1), 0, 0, 12, 0);
+
+  drawingarea1 = gtk_drawing_area_new ();
+  gtk_widget_show (drawingarea1);
+  gtk_container_add (GTK_CONTAINER (alignment1), drawingarea1);
+
+  label3 = gtk_label_new (_("<b>Preview</b>"));
+  gtk_widget_show (label3);
+  gtk_frame_set_label_widget (GTK_FRAME (frame1), label3);
+  gtk_label_set_use_markup (GTK_LABEL (label3), TRUE);
+
+  dialog_action_area1 = GTK_DIALOG (ChromaShift)->action_area;
+  gtk_widget_show (dialog_action_area1);
+  gtk_button_box_set_layout (GTK_BUTTON_BOX (dialog_action_area1), GTK_BUTTONBOX_END);
+
+  cancelbutton1 = gtk_button_new_from_stock ("gtk-cancel");
+  gtk_widget_show (cancelbutton1);
+  gtk_dialog_add_action_widget (GTK_DIALOG (ChromaShift), cancelbutton1, GTK_RESPONSE_CANCEL);
+  GTK_WIDGET_SET_FLAGS (cancelbutton1, GTK_CAN_DEFAULT);
+
+  applybutton1 = gtk_button_new_from_stock ("gtk-apply");
+  gtk_widget_show (applybutton1);
+  gtk_dialog_add_action_widget (GTK_DIALOG (ChromaShift), applybutton1, GTK_RESPONSE_APPLY);
+  GTK_WIDGET_SET_FLAGS (applybutton1, GTK_CAN_DEFAULT);
+
+  okbutton1 = gtk_button_new_from_stock ("gtk-ok");
+  gtk_widget_show (okbutton1);
+  gtk_dialog_add_action_widget (GTK_DIALOG (ChromaShift), okbutton1, GTK_RESPONSE_OK);
+  GTK_WIDGET_SET_FLAGS (okbutton1, GTK_CAN_DEFAULT);
+
+  /* Store pointers to all widgets, for use by lookup_widget(). */
+  GLADE_HOOKUP_OBJECT_NO_REF (ChromaShift, ChromaShift, "ChromaShift");
+  GLADE_HOOKUP_OBJECT_NO_REF (ChromaShift, dialog_vbox1, "dialog_vbox1");
+  GLADE_HOOKUP_OBJECT (ChromaShift, vbox1, "vbox1");
+  GLADE_HOOKUP_OBJECT (ChromaShift, table1, "table1");
+  GLADE_HOOKUP_OBJECT (ChromaShift, label1, "label1");
+  GLADE_HOOKUP_OBJECT (ChromaShift, label2, "label2");
+  GLADE_HOOKUP_OBJECT (ChromaShift, spinbutton_U, "spinbutton_U");
+  GLADE_HOOKUP_OBJECT (ChromaShift, spinbutton_V, "spinbutton_V");
+  GLADE_HOOKUP_OBJECT (ChromaShift, hscale, "hscale");
+  GLADE_HOOKUP_OBJECT (ChromaShift, frame1, "frame1");
+  GLADE_HOOKUP_OBJECT (ChromaShift, alignment1, "alignment1");
+  GLADE_HOOKUP_OBJECT (ChromaShift, drawingarea1, "drawingarea1");
+  GLADE_HOOKUP_OBJECT (ChromaShift, label3, "label3");
+  GLADE_HOOKUP_OBJECT_NO_REF (ChromaShift, dialog_action_area1, "dialog_action_area1");
+  GLADE_HOOKUP_OBJECT (ChromaShift, cancelbutton1, "cancelbutton1");
+  GLADE_HOOKUP_OBJECT (ChromaShift, applybutton1, "applybutton1");
+  GLADE_HOOKUP_OBJECT (ChromaShift, okbutton1, "okbutton1");
+
+  return ChromaShift;
+}
+
+

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_contrast.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_contrast.cpp	2007-07-25 18:17:34 UTC (rev 3445)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_contrast.cpp	2007-07-26 13:33:46 UTC (rev 3446)
@@ -1,310 +1,294 @@
-/***************************************************************************
-                          ADM_guiContrast.cpp  -  description
-                             -------------------
-    begin                : Mon Sep 23 2002
-    copyright            : (C) 2002 by mean
-    email                : fixounet at free.fr
- ***************************************************************************/
-
-/***************************************************************************
- *                                                                         *
- *   This program is free software; you can redistribute it and/or modify  *
- *   it under the terms of the GNU General Public License as published by  *
- *   the Free Software Foundation; either version 2 of the License, or     *
- *   (at your option) any later version.                                   *
- *                                                                         *
- ***************************************************************************/
-#include "config.h"
-
-#include <stdio.h>
-#include <stdlib.h>
-#include <string.h>
-
-#include <gtk/gtk.h>
-#include <time.h>
-#include <sys/time.h>
-#include <math.h>
-
-
-#include "fourcc.h"
-#include "avio.hxx"
-
-#include "avi_vars.h"
-#ifdef HAVE_ENCODER
-
-
-#include "ADM_editor/ADM_edit.hxx"
-#include "ADM_video/ADM_genvideo.hxx"
-#include "ADM_video/ADM_vidContrast.h"
-#include "ADM_toolkit/toolkit.hxx"
-#include "ADM_colorspace/ADM_rgb.h"
-#include "ADM_toolkit_gtk/ADM_gladeSupport.h"
-#include "ADM_toolkit_gtk/toolkit_gtk.h"
-#include "ADM_toolkit_gtk/toolkit_gtk_include.h"
-#include <ADM_assert.h>
-#include "DIA_flyDialog.h"
-#include "DIA_flyContrast.h"
-
-/********************************************************************/
-static GtkWidget *create_dialog1 (void);
-static GtkWidget *dialog = NULL;
-
-static gboolean gui_draw (GtkWidget * widget,
-			  GdkEventExpose * event, gpointer user_data);
-static void gui_update (GtkButton * button, gpointer user_data);
-static void frame_changed( void );
-
-static int lock=0;
-static flyContrast *myCrop=NULL;
-
-extern float UI_calcZoomToFitScreen(GtkWindow* window, GtkWidget* drawingArea, uint32_t imageWidth, uint32_t imageHeight);
-
-/********************************************************************/
-uint8_t DIA_contrast(AVDMGenericVideoStream *in,CONTRAST_PARAM *param)
-{
-  
-   uint32_t width,height;
-      uint8_t ret=0;
-        // Allocate space for green-ised video
-        width=in->getInfo()->width;
-        height=in->getInfo()->height;
-
-        dialog=create_dialog1();
-        gtk_register_dialog(dialog);
-        gtk_window_set_title (GTK_WINDOW (dialog), _("ASHARP"));
-
-		float zoom = UI_calcZoomToFitScreen(GTK_WINDOW(dialog), WID(drawingarea1), width, height);
+/***************************************************************************
+                          ADM_guiContrast.cpp  -  description
+                             -------------------
+    begin                : Mon Sep 23 2002
+    copyright            : (C) 2002 by mean
+    email                : fixounet at free.fr
+ ***************************************************************************/
 
-		uint32_t zoomW = width * zoom;
-		uint32_t zoomH = height * zoom;
+/***************************************************************************
+ *                                                                         *
+ *   This program is free software; you can redistribute it and/or modify  *
+ *   it under the terms of the GNU General Public License as published by  *
+ *   the Free Software Foundation; either version 2 of the License, or     *
+ *   (at your option) any later version.                                   *
+ *                                                                         *
+ ***************************************************************************/
+#include "config.h"
 
-		gtk_widget_set_usize(WID(drawingarea1), zoomW, zoomH);
+#include <stdio.h>
+#include <stdlib.h>
+#include <string.h>
 
-		if (zoom < 1)
-		{
-			gtk_window_set_position(GTK_WINDOW(dialog), GTK_WIN_POS_CENTER);
-		}
-
-        gtk_widget_show(dialog);	
-        
-          // and value changed
-#define CNX(x,y) gtk_signal_connect(GTK_OBJECT(WID(x)), y, GTK_SIGNAL_FUNC(gui_update), (void *) (1));
-
-        CNX (checkLuma, "toggled");
-        CNX (checkbuttonU, "toggled");
-        CNX (checkbuttonV, "toggled");
-        
-        
-        CNX (hscaleContrast, "value_changed");
-        CNX (hscaleContrast, "drag_data_received");
-      
-        CNX (hscaleBright, "value_changed");
-        CNX (hscaleBright, "drag_data_received");
-        gtk_signal_connect(GTK_OBJECT(WID(hscale1)), "value_changed",GTK_SIGNAL_FUNC(frame_changed),   NULL);
-        gtk_signal_connect(GTK_OBJECT(WID(drawingarea1)), "expose_event",
-            GTK_SIGNAL_FUNC(gui_draw),
-            NULL);
-
-
-          
-        myCrop=new flyContrast( width, height,in,WID(drawingarea1),WID(hscale1));
-        memcpy(&(myCrop->param),param,sizeof(CONTRAST_PARAM));
-		myCrop->resizeImage(zoomW, zoomH);
-        myCrop->upload();
-        myCrop->sliderChanged();
-        ret=0;
-        int response;
-        response=gtk_dialog_run(GTK_DIALOG(dialog));
-
-        if(response==GTK_RESPONSE_OK)
-        {
-            myCrop->download();
-            memcpy(param,&(myCrop->param),sizeof(CONTRAST_PARAM));
-            ret=1;
-        }
-        gtk_unregister_dialog(dialog);
-        gtk_widget_destroy(dialog);
-        delete myCrop;
-        return ret;
-}
-
-
-//
-//        Check entered values and green-out the selected portion on the screen
-//        Each value must be even
-//
-void frame_changed( void )
-{
-  myCrop->sliderChanged();
-}
-void gui_update (GtkButton * button, gpointer user_data)
-{
-  if(lock) return;
-    myCrop->update();
-}
-
-gboolean gui_draw (GtkWidget * widget, GdkEventExpose * event, gpointer user_data)
-{
-  myCrop->display();
-  return TRUE;
-}
-
-/**************************************/
-#define CHECKBOX(x,y) if(TRUE==gtk_toggle_button_get_active(GTK_TOGGLE_BUTTON(lookup_widget(dialog,#x))))  \
-			y=1; else y=0;
-#define SCHECKBOX(x,y) gtk_toggle_button_set_active(GTK_TOGGLE_BUTTON(lookup_widget(dialog,#x)),y)
-
-
-uint8_t flyContrast::upload(void)
-{
-    lock++;
-      SCHECKBOX (checkLuma, param.doLuma);
-      SCHECKBOX (checkbuttonU, param.doChromaU);
-      SCHECKBOX (checkbuttonV, param.doChromaV);
-
-      GtkAdjustment *adj=gtk_range_get_adjustment (GTK_RANGE(WID(hscaleBright)));
-      GTK_ADJUSTMENT(adj)->value=param.offset;
-  
-      adj=gtk_range_get_adjustment (GTK_RANGE(WID(hscaleContrast)));
-      GTK_ADJUSTMENT(adj)->value=param.coef;
-    lock--;
-    return 1;
-}
-uint8_t flyContrast::download (void)
-{
-  CHECKBOX (checkLuma, param.doLuma);
-  CHECKBOX (checkbuttonU, param.doChromaU);
-  CHECKBOX (checkbuttonV, param.doChromaV);
-  
-  GtkAdjustment *adj=gtk_range_get_adjustment (GTK_RANGE(WID(hscaleBright)));
-  param.offset= (int32_t)GTK_ADJUSTMENT(adj)->value;
-  
-  adj=gtk_range_get_adjustment (GTK_RANGE(WID(hscaleContrast)));
-  param.coef=GTK_ADJUSTMENT(adj)->value;
-   return 1;
-}
-
-GtkWidget*
-create_dialog1 (void)
-{
-  GtkWidget *dialog1;
-  GtkWidget *dialog_vbox1;
-  GtkWidget *vbox1;
-  GtkWidget *hbox1;
-  GtkWidget *vbox3;
-  GtkWidget *label1;
-  GtkWidget *hscaleContrast;
-  GtkWidget *label2;
-  GtkWidget *hscaleBright;
-  GtkWidget *vbox2;
-  GtkWidget *checkLuma;
-  GtkWidget *checkbuttonU;
-  GtkWidget *checkbuttonV;
-  GtkWidget *hscale1;
-  GtkWidget *drawingarea1;
-  GtkWidget *dialog_action_area1;
-  GtkWidget *cancelbutton1;
-  GtkWidget *okbutton1;
-
-  dialog1 = gtk_dialog_new ();
-  gtk_window_set_title (GTK_WINDOW (dialog1), _("Contrast"));
-  gtk_window_set_type_hint (GTK_WINDOW (dialog1), GDK_WINDOW_TYPE_HINT_DIALOG);
-
-  dialog_vbox1 = GTK_DIALOG (dialog1)->vbox;
-  gtk_widget_show (dialog_vbox1);
-
-  vbox1 = gtk_vbox_new (FALSE, 0);
-  gtk_widget_show (vbox1);
-  gtk_box_pack_start (GTK_BOX (dialog_vbox1), vbox1, TRUE, TRUE, 0);
-
-  hbox1 = gtk_hbox_new (FALSE, 0);
-  gtk_widget_show (hbox1);
-  gtk_box_pack_start (GTK_BOX (vbox1), hbox1, TRUE, TRUE, 0);
-
-  vbox3 = gtk_vbox_new (FALSE, 0);
-  gtk_widget_show (vbox3);
-  gtk_box_pack_start (GTK_BOX (hbox1), vbox3, TRUE, TRUE, 0);
-
-  label1 = gtk_label_new (_("Contrast"));
-  gtk_widget_show (label1);
-  gtk_box_pack_start (GTK_BOX (vbox3), label1, FALSE, FALSE, 0);
-
-  hscaleContrast = gtk_hscale_new (GTK_ADJUSTMENT (gtk_adjustment_new (1, 0.5, 1.5, 0.1, 0.1, 0)));
-  gtk_widget_show (hscaleContrast);
-  gtk_box_pack_start (GTK_BOX (vbox3), hscaleContrast, FALSE, TRUE, 0);
-  gtk_scale_set_value_pos (GTK_SCALE (hscaleContrast), GTK_POS_LEFT);
-
-  label2 = gtk_label_new (_("Brightness"));
-  gtk_widget_show (label2);
-  gtk_box_pack_start (GTK_BOX (vbox3), label2, FALSE, FALSE, 0);
-
-  hscaleBright = gtk_hscale_new (GTK_ADJUSTMENT (gtk_adjustment_new (0, -127, 127, 1, 1, 0)));
-  gtk_widget_show (hscaleBright);
-  gtk_box_pack_start (GTK_BOX (vbox3), hscaleBright, FALSE, TRUE, 0);
-  gtk_scale_set_value_pos (GTK_SCALE (hscaleBright), GTK_POS_LEFT);
-  gtk_scale_set_digits (GTK_SCALE (hscaleBright), 0);
-
-  vbox2 = gtk_vbox_new (FALSE, 0);
-  gtk_widget_show (vbox2);
-  gtk_box_pack_start (GTK_BOX (hbox1), vbox2, TRUE, TRUE, 0);
-
-  checkLuma = gtk_check_button_new_with_mnemonic (_("Luma"));
-  gtk_widget_show (checkLuma);
-  gtk_box_pack_start (GTK_BOX (vbox2), checkLuma, FALSE, FALSE, 0);
-
-  checkbuttonU = gtk_check_button_new_with_mnemonic (_("Chroma U"));
-  gtk_widget_show (checkbuttonU);
-  gtk_box_pack_start (GTK_BOX (vbox2), checkbuttonU, FALSE, FALSE, 0);
-
-  checkbuttonV = gtk_check_button_new_with_mnemonic (_("Chroma v"));
-  gtk_widget_show (checkbuttonV);
-  gtk_box_pack_start (GTK_BOX (vbox2), checkbuttonV, FALSE, FALSE, 0);
-
-  hscale1 = gtk_hscale_new (GTK_ADJUSTMENT (gtk_adjustment_new (0, 0, 99, 1, 1, 1)));
-  gtk_widget_show (hscale1);
-  gtk_box_pack_start (GTK_BOX (vbox1), hscale1, TRUE, TRUE, 0);
-
-  drawingarea1 = gtk_drawing_area_new ();
-  gtk_widget_show (drawingarea1);
-  gtk_box_pack_start (GTK_BOX (vbox1), drawingarea1, TRUE, TRUE, 0);
-  gtk_widget_set_size_request (drawingarea1, -1, 300);
-
-  dialog_action_area1 = GTK_DIALOG (dialog1)->action_area;
-  gtk_widget_show (dialog_action_area1);
-  gtk_button_box_set_layout (GTK_BUTTON_BOX (dialog_action_area1), GTK_BUTTONBOX_END);
-
-  cancelbutton1 = gtk_button_new_from_stock ("gtk-cancel");
-  gtk_widget_show (cancelbutton1);
-  gtk_dialog_add_action_widget (GTK_DIALOG (dialog1), cancelbutton1, GTK_RESPONSE_CANCEL);
-  GTK_WIDGET_SET_FLAGS (cancelbutton1, GTK_CAN_DEFAULT);
-
-  okbutton1 = gtk_button_new_from_stock ("gtk-ok");
-  gtk_widget_show (okbutton1);
-  gtk_dialog_add_action_widget (GTK_DIALOG (dialog1), okbutton1, GTK_RESPONSE_OK);
-  GTK_WIDGET_SET_FLAGS (okbutton1, GTK_CAN_DEFAULT);
-
-  /* Store pointers to all widgets, for use by lookup_widget(). */
-  GLADE_HOOKUP_OBJECT_NO_REF (dialog1, dialog1, "dialog1");
-  GLADE_HOOKUP_OBJECT_NO_REF (dialog1, dialog_vbox1, "dialog_vbox1");
-  GLADE_HOOKUP_OBJECT (dialog1, vbox1, "vbox1");
-  GLADE_HOOKUP_OBJECT (dialog1, hbox1, "hbox1");
-  GLADE_HOOKUP_OBJECT (dialog1, vbox3, "vbox3");
-  GLADE_HOOKUP_OBJECT (dialog1, label1, "label1");
-  GLADE_HOOKUP_OBJECT (dialog1, hscaleContrast, "hscaleContrast");
-  GLADE_HOOKUP_OBJECT (dialog1, label2, "label2");
-  GLADE_HOOKUP_OBJECT (dialog1, hscaleBright, "hscaleBright");
-  GLADE_HOOKUP_OBJECT (dialog1, vbox2, "vbox2");
-  GLADE_HOOKUP_OBJECT (dialog1, checkLuma, "checkLuma");
-  GLADE_HOOKUP_OBJECT (dialog1, checkbuttonU, "checkbuttonU");
-  GLADE_HOOKUP_OBJECT (dialog1, checkbuttonV, "checkbuttonV");
-  GLADE_HOOKUP_OBJECT (dialog1, hscale1, "hscale1");
-  GLADE_HOOKUP_OBJECT (dialog1, drawingarea1, "drawingarea1");
-  GLADE_HOOKUP_OBJECT_NO_REF (dialog1, dialog_action_area1, "dialog_action_area1");
-  GLADE_HOOKUP_OBJECT (dialog1, cancelbutton1, "cancelbutton1");
-  GLADE_HOOKUP_OBJECT (dialog1, okbutton1, "okbutton1");
-
-  return dialog1;
-}
-
-
-#endif
+#include <gtk/gtk.h>
+#include <time.h>
+#include <sys/time.h>
+#include <math.h>
+
+
+#include "fourcc.h"
+#include "avio.hxx"
+
+#include "avi_vars.h"
+#ifdef HAVE_ENCODER
+
+
+#include "ADM_editor/ADM_edit.hxx"
+#include "ADM_video/ADM_genvideo.hxx"
+#include "ADM_video/ADM_vidContrast.h"
+#include "ADM_toolkit/toolkit.hxx"
+#include "ADM_colorspace/ADM_rgb.h"
+#include "ADM_toolkit_gtk/ADM_gladeSupport.h"
+#include "ADM_toolkit_gtk/toolkit_gtk.h"
+#include "ADM_toolkit_gtk/toolkit_gtk_include.h"
+#include <ADM_assert.h>
+#include "DIA_flyDialog.h"
+#include "DIA_flyContrast.h"
+
+/********************************************************************/
+static GtkWidget *create_dialog1 (void);
+static GtkWidget *dialog = NULL;
+
+static gboolean gui_draw (GtkWidget * widget,
+			  GdkEventExpose * event, gpointer user_data);
+static void gui_update (GtkButton * button, gpointer user_data);
+static void frame_changed( void );
+
+static int lock=0;
+static flyContrast *myCrop=NULL;
+
+/********************************************************************/
+uint8_t DIA_contrast(AVDMGenericVideoStream *in,CONTRAST_PARAM *param)
+{
+  
+   uint32_t width,height;
+      uint8_t ret=0;
+        // Allocate space for green-ised video
+        width=in->getInfo()->width;
+        height=in->getInfo()->height;
+
+        dialog=create_dialog1();
+        gtk_register_dialog(dialog);
+        gtk_window_set_title (GTK_WINDOW (dialog), _("ASHARP"));
+        gtk_widget_show(dialog);	
+        
+          // and value changed
+#define CNX(x,y) gtk_signal_connect(GTK_OBJECT(WID(x)), y, GTK_SIGNAL_FUNC(gui_update), (void *) (1));
+
+        CNX (checkLuma, "toggled");
+        CNX (checkbuttonU, "toggled");
+        CNX (checkbuttonV, "toggled");
+        
+        
+        CNX (hscaleContrast, "value_changed");
+        CNX (hscaleContrast, "drag_data_received");
+      
+        CNX (hscaleBright, "value_changed");
+        CNX (hscaleBright, "drag_data_received");
+        gtk_signal_connect(GTK_OBJECT(WID(hscale1)), "value_changed",GTK_SIGNAL_FUNC(frame_changed),   NULL);
+        gtk_signal_connect(GTK_OBJECT(WID(drawingarea1)), "expose_event",
+            GTK_SIGNAL_FUNC(gui_draw),
+            NULL);
+
+
+          
+        myCrop=new flyContrast( width, height,in,WID(drawingarea1),WID(hscale1));
+        memcpy(&(myCrop->param),param,sizeof(CONTRAST_PARAM));
+        myCrop->upload();
+        myCrop->sliderChanged();
+        ret=0;
+        int response;
+        response=gtk_dialog_run(GTK_DIALOG(dialog));
+
+        if(response==GTK_RESPONSE_OK)
+        {
+            myCrop->download();
+            memcpy(param,&(myCrop->param),sizeof(CONTRAST_PARAM));
+            ret=1;
+        }
+        gtk_unregister_dialog(dialog);
+        gtk_widget_destroy(dialog);
+        delete myCrop;
+        return ret;
+}
+
+
+//
+//        Check entered values and green-out the selected portion on the screen
+//        Each value must be even
+//
+void frame_changed( void )
+{
+  myCrop->sliderChanged();
+}
+void gui_update (GtkButton * button, gpointer user_data)
+{
+  if(lock) return;
+    myCrop->update();
+}
+
+gboolean gui_draw (GtkWidget * widget, GdkEventExpose * event, gpointer user_data)
+{
+  myCrop->display();
+  return TRUE;
+}
+
+/**************************************/
+#define CHECKBOX(x,y) if(TRUE==gtk_toggle_button_get_active(GTK_TOGGLE_BUTTON(lookup_widget(dialog,#x))))  \
+			y=1; else y=0;
+#define SCHECKBOX(x,y) gtk_toggle_button_set_active(GTK_TOGGLE_BUTTON(lookup_widget(dialog,#x)),y)
+
+
+uint8_t flyContrast::upload(void)
+{
+    lock++;
+      SCHECKBOX (checkLuma, param.doLuma);
+      SCHECKBOX (checkbuttonU, param.doChromaU);
+      SCHECKBOX (checkbuttonV, param.doChromaV);
+
+      GtkAdjustment *adj=gtk_range_get_adjustment (GTK_RANGE(WID(hscaleBright)));
+      GTK_ADJUSTMENT(adj)->value=param.offset;
+  
+      adj=gtk_range_get_adjustment (GTK_RANGE(WID(hscaleContrast)));
+      GTK_ADJUSTMENT(adj)->value=param.coef;
+    lock--;
+    return 1;
+}
+uint8_t flyContrast::download (void)
+{
+  CHECKBOX (checkLuma, param.doLuma);
+  CHECKBOX (checkbuttonU, param.doChromaU);
+  CHECKBOX (checkbuttonV, param.doChromaV);
+  
+  GtkAdjustment *adj=gtk_range_get_adjustment (GTK_RANGE(WID(hscaleBright)));
+  param.offset= (int32_t)GTK_ADJUSTMENT(adj)->value;
+  
+  adj=gtk_range_get_adjustment (GTK_RANGE(WID(hscaleContrast)));
+  param.coef=GTK_ADJUSTMENT(adj)->value;
+   return 1;
+}
+
+GtkWidget*
+create_dialog1 (void)
+{
+  GtkWidget *dialog1;
+  GtkWidget *dialog_vbox1;
+  GtkWidget *vbox1;
+  GtkWidget *hbox1;
+  GtkWidget *vbox3;
+  GtkWidget *label1;
+  GtkWidget *hscaleContrast;
+  GtkWidget *label2;
+  GtkWidget *hscaleBright;
+  GtkWidget *vbox2;
+  GtkWidget *checkLuma;
+  GtkWidget *checkbuttonU;
+  GtkWidget *checkbuttonV;
+  GtkWidget *hscale1;
+  GtkWidget *drawingarea1;
+  GtkWidget *dialog_action_area1;
+  GtkWidget *cancelbutton1;
+  GtkWidget *okbutton1;
+
+  dialog1 = gtk_dialog_new ();
+  gtk_window_set_title (GTK_WINDOW (dialog1), _("Contrast"));
+  gtk_window_set_type_hint (GTK_WINDOW (dialog1), GDK_WINDOW_TYPE_HINT_DIALOG);
+
+  dialog_vbox1 = GTK_DIALOG (dialog1)->vbox;
+  gtk_widget_show (dialog_vbox1);
+
+  vbox1 = gtk_vbox_new (FALSE, 0);
+  gtk_widget_show (vbox1);
+  gtk_box_pack_start (GTK_BOX (dialog_vbox1), vbox1, TRUE, TRUE, 0);
+
+  hbox1 = gtk_hbox_new (FALSE, 0);
+  gtk_widget_show (hbox1);
+  gtk_box_pack_start (GTK_BOX (vbox1), hbox1, TRUE, TRUE, 0);
+
+  vbox3 = gtk_vbox_new (FALSE, 0);
+  gtk_widget_show (vbox3);
+  gtk_box_pack_start (GTK_BOX (hbox1), vbox3, TRUE, TRUE, 0);
+
+  label1 = gtk_label_new (_("Contrast"));
+  gtk_widget_show (label1);
+  gtk_box_pack_start (GTK_BOX (vbox3), label1, FALSE, FALSE, 0);
+
+  hscaleContrast = gtk_hscale_new (GTK_ADJUSTMENT (gtk_adjustment_new (1, 0.5, 1.5, 0.1, 0.1, 0)));
+  gtk_widget_show (hscaleContrast);
+  gtk_box_pack_start (GTK_BOX (vbox3), hscaleContrast, FALSE, TRUE, 0);
+  gtk_scale_set_value_pos (GTK_SCALE (hscaleContrast), GTK_POS_LEFT);
+
+  label2 = gtk_label_new (_("Brightness"));
+  gtk_widget_show (label2);
+  gtk_box_pack_start (GTK_BOX (vbox3), label2, FALSE, FALSE, 0);
+
+  hscaleBright = gtk_hscale_new (GTK_ADJUSTMENT (gtk_adjustment_new (0, -127, 127, 1, 1, 0)));
+  gtk_widget_show (hscaleBright);
+  gtk_box_pack_start (GTK_BOX (vbox3), hscaleBright, FALSE, TRUE, 0);
+  gtk_scale_set_value_pos (GTK_SCALE (hscaleBright), GTK_POS_LEFT);
+  gtk_scale_set_digits (GTK_SCALE (hscaleBright), 0);
+
+  vbox2 = gtk_vbox_new (FALSE, 0);
+  gtk_widget_show (vbox2);
+  gtk_box_pack_start (GTK_BOX (hbox1), vbox2, TRUE, TRUE, 0);
+
+  checkLuma = gtk_check_button_new_with_mnemonic (_("Luma"));
+  gtk_widget_show (checkLuma);
+  gtk_box_pack_start (GTK_BOX (vbox2), checkLuma, FALSE, FALSE, 0);
+
+  checkbuttonU = gtk_check_button_new_with_mnemonic (_("Chroma U"));
+  gtk_widget_show (checkbuttonU);
+  gtk_box_pack_start (GTK_BOX (vbox2), checkbuttonU, FALSE, FALSE, 0);
+
+  checkbuttonV = gtk_check_button_new_with_mnemonic (_("Chroma v"));
+  gtk_widget_show (checkbuttonV);
+  gtk_box_pack_start (GTK_BOX (vbox2), checkbuttonV, FALSE, FALSE, 0);
+
+  hscale1 = gtk_hscale_new (GTK_ADJUSTMENT (gtk_adjustment_new (0, 0, 99, 1, 1, 1)));
+  gtk_widget_show (hscale1);
+  gtk_box_pack_start (GTK_BOX (vbox1), hscale1, TRUE, TRUE, 0);
+
+  drawingarea1 = gtk_drawing_area_new ();
+  gtk_widget_show (drawingarea1);
+  gtk_box_pack_start (GTK_BOX (vbox1), drawingarea1, TRUE, TRUE, 0);
+  gtk_widget_set_size_request (drawingarea1, -1, 300);
+
+  dialog_action_area1 = GTK_DIALOG (dialog1)->action_area;
+  gtk_widget_show (dialog_action_area1);
+  gtk_button_box_set_layout (GTK_BUTTON_BOX (dialog_action_area1), GTK_BUTTONBOX_END);
+
+  cancelbutton1 = gtk_button_new_from_stock ("gtk-cancel");
+  gtk_widget_show (cancelbutton1);
+  gtk_dialog_add_action_widget (GTK_DIALOG (dialog1), cancelbutton1, GTK_RESPONSE_CANCEL);
+  GTK_WIDGET_SET_FLAGS (cancelbutton1, GTK_CAN_DEFAULT);
+
+  okbutton1 = gtk_button_new_from_stock ("gtk-ok");
+  gtk_widget_show (okbutton1);
+  gtk_dialog_add_action_widget (GTK_DIALOG (dialog1), okbutton1, GTK_RESPONSE_OK);
+  GTK_WIDGET_SET_FLAGS (okbutton1, GTK_CAN_DEFAULT);
+
+  /* Store pointers to all widgets, for use by lookup_widget(). */
+  GLADE_HOOKUP_OBJECT_NO_REF (dialog1, dialog1, "dialog1");
+  GLADE_HOOKUP_OBJECT_NO_REF (dialog1, dialog_vbox1, "dialog_vbox1");
+  GLADE_HOOKUP_OBJECT (dialog1, vbox1, "vbox1");
+  GLADE_HOOKUP_OBJECT (dialog1, hbox1, "hbox1");
+  GLADE_HOOKUP_OBJECT (dialog1, vbox3, "vbox3");
+  GLADE_HOOKUP_OBJECT (dialog1, label1, "label1");
+  GLADE_HOOKUP_OBJECT (dialog1, hscaleContrast, "hscaleContrast");
+  GLADE_HOOKUP_OBJECT (dialog1, label2, "label2");
+  GLADE_HOOKUP_OBJECT (dialog1, hscaleBright, "hscaleBright");
+  GLADE_HOOKUP_OBJECT (dialog1, vbox2, "vbox2");
+  GLADE_HOOKUP_OBJECT (dialog1, checkLuma, "checkLuma");
+  GLADE_HOOKUP_OBJECT (dialog1, checkbuttonU, "checkbuttonU");
+  GLADE_HOOKUP_OBJECT (dialog1, checkbuttonV, "checkbuttonV");
+  GLADE_HOOKUP_OBJECT (dialog1, hscale1, "hscale1");
+  GLADE_HOOKUP_OBJECT (dialog1, drawingarea1, "drawingarea1");
+  GLADE_HOOKUP_OBJECT_NO_REF (dialog1, dialog_action_area1, "dialog_action_area1");
+  GLADE_HOOKUP_OBJECT (dialog1, cancelbutton1, "cancelbutton1");
+  GLADE_HOOKUP_OBJECT (dialog1, okbutton1, "okbutton1");
+
+  return dialog1;
+}
+
+
+#endif

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_crop.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_crop.cpp	2007-07-25 18:17:34 UTC (rev 3445)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_crop.cpp	2007-07-26 13:33:46 UTC (rev 3446)
@@ -40,7 +40,6 @@
 #include "DIA_flyCrop.h"
 
 static GtkWidget	*create_dialog1 (void);
-extern float UI_calcZoomToFitScreen(GtkWindow* window, GtkWidget* drawingArea, uint32_t imageWidth, uint32_t imageHeight);
 
 /* Link between UI and core */
 static gboolean 	ui_draw( void );
@@ -74,19 +73,6 @@
 	dialog=create_dialog1();
 	gtk_register_dialog(dialog);
 	gtk_window_set_title(GTK_WINDOW(dialog), name);
-
-	float zoom = UI_calcZoomToFitScreen(GTK_WINDOW(dialog), WID(drawingarea1), width, height);
-
-	uint32_t zoomW = width * zoom;
-	uint32_t zoomH = height * zoom;
-
-	gtk_widget_set_usize(WID(drawingarea1), zoomW, zoomH);
-
-	if (zoom < 1)
-	{
-		gtk_window_set_position(GTK_WINDOW(dialog), GTK_WIN_POS_CENTER);
-	}
-
 	gtk_widget_show(dialog);
 	
 #define CONNECT(x,y,z) 	gtk_signal_connect(GTK_OBJECT(WID(x)), #y, GTK_SIGNAL_FUNC(z), NULL);
@@ -108,7 +94,6 @@
 	CONNECT_SPIN(Bottom);
 
 	myCrop=new flyCrop(width, height,in,WID(drawingarea1),WID(scale));
-	myCrop->resizeImage(zoomW, zoomH);
 	myCrop->left=param->left;
 	myCrop->right=param->right;
 	myCrop->top=param->top;

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_eq2.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_eq2.cpp	2007-07-25 18:17:34 UTC (rev 3445)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_eq2.cpp	2007-07-26 13:33:46 UTC (rev 3446)
@@ -69,6 +69,7 @@
 static ColYuvRgb    *rgbConv=NULL;
 
 extern float UI_calcZoomToFitScreen(GtkWindow* window, GtkWidget* drawingArea, uint32_t imageWidth, uint32_t imageHeight);
+extern void UI_centreCanvasWindow(GtkWindow *window, GtkWidget *canvas, int newCanvasWidth, int newCanvasHeight);
 
 /************************************************************************/
 uint8_t DIA_getEQ2Param(Eq2_Param *param, AVDMGenericVideoStream *in)
@@ -142,7 +143,7 @@
 
 		if (zoom < 1)
 		{
-			gtk_window_set_position(GTK_WINDOW(dialog), GTK_WIN_POS_CENTER);
+			UI_centreCanvasWindow((GtkWindow*)dialog, WID(drawingarea1), zoomW, zoomH);
 			resizer = new ADMImageResizer(w, h, zoomW, zoomH, PIX_FMT_YUV420P, PIX_FMT_RGB32);
 		}
 

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_equalizer.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_equalizer.cpp	2007-07-25 18:17:34 UTC (rev 3445)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_equalizer.cpp	2007-07-26 13:33:46 UTC (rev 3446)
@@ -62,6 +62,7 @@
 
 extern void GUI_RGBDisplay(uint8_t * dis, uint32_t w, uint32_t h, void *widg);
 extern float UI_calcZoomToFitScreen(GtkWindow* window, GtkWidget* drawingArea, uint32_t imageWidth, uint32_t imageHeight);
+extern void UI_centreCanvasWindow(GtkWindow *window, GtkWidget *canvas, int newCanvasWidth, int newCanvasHeight);
 
 static ADMImage *imgsrc,*imgdst,*imgdisplay;
 static GtkWidget *dialog=NULL;
@@ -129,7 +130,7 @@
 
 	if (zoom < 1)
 	{
-		gtk_window_set_position(GTK_WINDOW(dialog), GTK_WIN_POS_CENTER);
+		UI_centreCanvasWindow((GtkWindow*)dialog, WID(drawingarea1), zoomW, zoomH);
 		resizer = new ADMImageResizer(w, h, zoomW, zoomH, PIX_FMT_YUV420P, PIX_FMT_RGB32);
 	}
 

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_flyDialog.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_flyDialog.cpp	2007-07-25 18:17:34 UTC (rev 3445)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_flyDialog.cpp	2007-07-26 13:33:46 UTC (rev 3446)
@@ -1,81 +1,87 @@
-/***************************************************************************
-    copyright            : (C) 2006 by mean
-    email                : fixounet at free.fr
-***************************************************************************/
-
-/***************************************************************************
-*                                                                         *
-*   This program is free software; you can redistribute it and/or modify  *
-*   it under the terms of the GNU General Public License as published by  *
-*   the Free Software Foundation; either version 2 of the License, or     *
-*   (at your option) any later version.                                   *
-*                                                                         *
-***************************************************************************///
-
-#include "config.h"
-
-#include <gtk/gtk.h>
-
-#include "default.h"
-#include "ADM_toolkit_gtk/toolkit_gtk.h"
-#include "ADM_toolkit_gtk/toolkit_gtk_include.h"
-#include "ADM_video/ADM_genvideo.hxx"
-#include "DIA_flyDialog.h"
-#include "ADM_assert.h"
-
-extern void GUI_RGBDisplay(uint8_t * dis, uint32_t w, uint32_t h, void *widg);
-
-void ADM_flyDialog::postInit(uint32_t width, uint32_t height, AVDMGenericVideoStream *in,
-							 void *canvas, void *slider, int yuv)
-{
-	if (slider != NULL)
-	{
-		GtkAdjustment *adj = (GtkAdjustment*)gtk_adjustment_new(0, 0, in->getInfo()->nb_frames - 1, 0, 0, 0);
-
-		gtk_range_set_adjustment(GTK_RANGE(_slider), adj);
-		gtk_scale_set_digits(GTK_SCALE(_slider), 0);
-	}
-}
-
-uint8_t  ADM_flyDialog::display(void)
-{
-	ADM_assert(_canvas);
-	ADM_assert(_rgbBufferOut);
-
-	if (_resizer)
-	{
-		_resizer->resize(_rgbBufferOut, _rgbBufferDisplay);
-		GUI_RGBDisplay(_rgbBufferDisplay, _zoomW, _zoomH, _canvas);
-	}
-	else
-		GUI_RGBDisplay(_rgbBufferOut, _w, _h, _canvas);
-
-	return 1; 
-}
-
-uint32_t ADM_flyDialog::sliderGet(void)
-{
-	ADM_assert(_slider);
-	GtkAdjustment *adj=gtk_range_get_adjustment (GTK_RANGE(_slider));
-	return (uint32_t)GTK_ADJUSTMENT(adj)->value;
-}
-
-uint8_t ADM_flyDialog::sliderSet(uint32_t value)
-{
-	ADM_assert(_slider);
-
-	GtkAdjustment *adj = gtk_range_get_adjustment(GTK_RANGE(_slider));
-
-	adj->value = value;
-
-	gtk_range_set_adjustment(GTK_RANGE(_slider), adj);
-
-	return 1; 
-}
-
-uint8_t ADM_flyDialog::isRgbInverted(void)
-{
-	return 0; 
-}
-
-//EOF
+/***************************************************************************
+    copyright            : (C) 2006 by mean
+    email                : fixounet at free.fr
+***************************************************************************/
+
+/***************************************************************************
+*                                                                         *
+*   This program is free software; you can redistribute it and/or modify  *
+*   it under the terms of the GNU General Public License as published by  *
+*   the Free Software Foundation; either version 2 of the License, or     *
+*   (at your option) any later version.                                   *
+*                                                                         *
+***************************************************************************///
+
+#include "config.h"
+
+#include <gtk/gtk.h>
+
+#include "default.h"
+#include "ADM_toolkit_gtk/toolkit_gtk.h"
+#include "ADM_toolkit_gtk/toolkit_gtk_include.h"
+#include "ADM_video/ADM_genvideo.hxx"
+#include "DIA_flyDialog.h"
+#include "ADM_assert.h"
+
+extern void GUI_RGBDisplay(uint8_t * dis, uint32_t w, uint32_t h, void *widg);
+extern float UI_calcZoomToFitScreen(GtkWindow* window, GtkWidget* drawingArea, uint32_t imageWidth, uint32_t imageHeight);
+extern void UI_centreCanvasWindow(GtkWindow *window, GtkWidget *canvas, int newCanvasWidth, int newCanvasHeight);
+
+void ADM_flyDialog::postInit(void)
+{
+	if (_slider)
+	{
+		GtkAdjustment *adj = (GtkAdjustment*)gtk_adjustment_new(0, 0, _in->getInfo()->nb_frames - 1, 0, 1, 0);
+
+		gtk_range_set_adjustment(GTK_RANGE(_slider), adj);
+		gtk_scale_set_digits(GTK_SCALE(_slider), 0);
+	}
+
+	GtkWindow *window = (GtkWindow*)gtk_widget_get_ancestor((GtkWidget*)_canvas, GTK_TYPE_WINDOW);
+	UI_centreCanvasWindow(window, (GtkWidget*)_canvas, _zoomW, _zoomH);
+	gtk_widget_set_usize((GtkWidget*)_canvas, _zoomW, _zoomH);
+}
+
+float ADM_flyDialog::calcZoomFactor(void)
+{
+	GtkWindow *window = (GtkWindow*)gtk_widget_get_ancestor((GtkWidget*)_canvas, GTK_TYPE_WINDOW);
+
+	return UI_calcZoomToFitScreen(window, (GtkWidget*)_canvas, _w, _h);
+}
+
+uint8_t  ADM_flyDialog::display(void)
+{
+	ADM_assert(_canvas);
+	ADM_assert(_rgbBufferOut);
+
+	GUI_RGBDisplay(_rgbBufferOut, _zoomW, _zoomH, _canvas);
+
+	return 1; 
+}
+
+uint32_t ADM_flyDialog::sliderGet(void)
+{
+	ADM_assert(_slider);
+	GtkAdjustment *adj=gtk_range_get_adjustment (GTK_RANGE(_slider));
+	return (uint32_t)GTK_ADJUSTMENT(adj)->value;
+}
+
+uint8_t ADM_flyDialog::sliderSet(uint32_t value)
+{
+	ADM_assert(_slider);
+
+	GtkAdjustment *adj = gtk_range_get_adjustment(GTK_RANGE(_slider));
+
+	adj->value = value;
+
+	gtk_range_set_adjustment(GTK_RANGE(_slider), adj);
+
+	return 1; 
+}
+
+uint8_t ADM_flyDialog::isRgbInverted(void)
+{
+	return 0; 
+}
+
+//EOF

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_hue.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_hue.cpp	2007-07-25 18:17:34 UTC (rev 3445)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_hue.cpp	2007-07-26 13:33:46 UTC (rev 3446)
@@ -56,8 +56,6 @@
 static GtkWidget *dialog=NULL;
 static flyHue *myCrop=NULL;
 
-extern float UI_calcZoomToFitScreen(GtkWindow* window, GtkWidget* drawingArea, uint32_t imageWidth, uint32_t imageHeight);
-
 /**
       \fn DIA_getHue
       \brief Handle Hue (fly)Dialog
@@ -75,18 +73,6 @@
         
         gtk_window_set_title (GTK_WINDOW (dialog), _("Hue"));
 
-		float zoom = UI_calcZoomToFitScreen(GTK_WINDOW(dialog), WID(drawingarea1), width, height);
-
-		uint32_t zoomW = width * zoom;
-		uint32_t zoomH = height * zoom;
-
-		gtk_widget_set_usize(WID(drawingarea1), zoomW, zoomH);
-
-		if (zoom < 1)
-		{
-			gtk_window_set_position(GTK_WINDOW(dialog), GTK_WIN_POS_CENTER);
-		}
-
         gtk_signal_connect(GTK_OBJECT(WID(drawingarea1)), "expose_event",
             GTK_SIGNAL_FUNC(draw),
             NULL);
@@ -98,7 +84,6 @@
           
         myCrop=new flyHue( width, height,in,WID(drawingarea1),WID(hscale1));
         memcpy(&(myCrop->param),param,sizeof(Hue_Param));
-		myCrop->resizeImage(zoomW, zoomH);
         myCrop->upload();
         myCrop->sliderChanged();
         ret=0;

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_mpdelogo.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_mpdelogo.cpp	2007-07-25 18:17:34 UTC (rev 3445)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_mpdelogo.cpp	2007-07-26 13:33:46 UTC (rev 3446)
@@ -1,111 +1,112 @@
-/***************************************************************************
-                          DIA_crop.cpp  -  description
-                             -------------------
-
-			    GUI for cropping including autocrop
-			    +Revisted the Gtk2 way
-			     +Autocrop now in RGB space (more accurate)
-
-    begin                : Fri May 3 2002
-    copyright            : (C) 2002 by mean
-    email                : fixounet at free.fr
- ***************************************************************************/
-
-/***************************************************************************
- *                                                                         *
- *   This program is free software; you can redistribute it and/or modify  *
- *   it under the terms of the GNU General Public License as published by  *
- *   the Free Software Foundation; either version 2 of the License, or     *
- *   (at your option) any later version.                                   *
- *                                                                         *
- ***************************************************************************/
-
-#include "config.h"
-
-#include <string.h>
-#include <stdio.h>
-
-#include <gdk/gdkkeysyms.h>
-#include <gtk/gtk.h>
-#include <math.h>
-
-#include "default.h"
-#include "ADM_toolkit_gtk/toolkit_gtk.h"
-#include "ADM_toolkit_gtk/toolkit_gtk_include.h"
-#include "ADM_toolkit/toolkit.hxx"
-
-#include "ADM_image.h"
-#include "ADM_video/ADM_genvideo.hxx"
-#include "ADM_colorspace/ADM_rgb.h"
-#include "ADM_assert.h"
-#include "ADM_video/ADM_vidMPdelogo.h"
-
+/***************************************************************************
+                          DIA_crop.cpp  -  description
+                             -------------------
+
+			    GUI for cropping including autocrop
+			    +Revisted the Gtk2 way
+			     +Autocrop now in RGB space (more accurate)
+
+    begin                : Fri May 3 2002
+    copyright            : (C) 2002 by mean
+    email                : fixounet at free.fr
+ ***************************************************************************/
+
+/***************************************************************************
+ *                                                                         *
+ *   This program is free software; you can redistribute it and/or modify  *
+ *   it under the terms of the GNU General Public License as published by  *
+ *   the Free Software Foundation; either version 2 of the License, or     *
+ *   (at your option) any later version.                                   *
+ *                                                                         *
+ ***************************************************************************/
+
+#include "config.h"
+
+#include <string.h>
+#include <stdio.h>
+
+#include <gdk/gdkkeysyms.h>
+#include <gtk/gtk.h>
+#include <math.h>
+
+#include "default.h"
+#include "ADM_toolkit_gtk/toolkit_gtk.h"
+#include "ADM_toolkit_gtk/toolkit_gtk_include.h"
+#include "ADM_toolkit/toolkit.hxx"
+
+#include "ADM_image.h"
+#include "ADM_video/ADM_genvideo.hxx"
+#include "ADM_colorspace/ADM_rgb.h"
+#include "ADM_assert.h"
+#include "ADM_video/ADM_vidMPdelogo.h"
+
 extern "C" {
 #include "ADM_libraries/ADM_lavcodec/avcodec.h"
-}
-
-static GtkWidget	*create_dialog1 (void);
-static void  		ui_read ( void);
-static void  		ui_update ( void);
-static void 		draw (GtkWidget *dialog,uint32_t w,uint32_t h );
-static gboolean 	gui_draw( void );
-static void 		autocrop (void );
-static void 		reset( void );
-static void 		ui_upload(void);
-static gboolean		ui_changed(void);
-
-
-static void		prepare(uint32_t img);
-static void 		frame_changed( void );
-
-extern void GUI_RGBDisplay(uint8_t * dis, uint32_t w, uint32_t h, void *widg);
-extern float UI_calcZoomToFitScreen(GtkWindow* window, GtkWidget* drawingArea, uint32_t imageWidth, uint32_t imageHeight);
-
-static ColYuvRgb    *rgbConv=NULL;
-static uint8_t *working=NULL;
-static uint8_t *rgbBufferDisplay=NULL;
-static uint8_t *original=NULL;
-static GtkWidget *dialog=NULL;
-static uint32_t x,y,w,h,zoomW,zoomH,band;
-
-static AVDMGenericVideoStream *incoming=NULL;
-static ADMImage *imgsrc=NULL;
-static ADMImageResizer *resizer=NULL;
-
-static int lock=0,width,height;
-
-
-//
-//	Video is in YV12 Colorspace
-//
-//
-uint8_t DIA_getMPdelogo(MPDELOGO_PARAM *param,AVDMGenericVideoStream *in)
-
-{
-	// Allocate space for green-ised video
-	width=in->getInfo()->width;
-	height=in->getInfo()->height;
-		
-	working=new uint8_t [width*height*4];	
-	original=NULL;
-
-	uint8_t ret=0;
-
-	dialog=create_dialog1();
-        gtk_register_dialog(dialog);
-	
-	x=param->xoff;
-	y=param->yoff;
-	w=param->lw;
-	h=param->lh;
-	band=param->band;
-
-	imgsrc=new ADMImage(width,height);
-	incoming=in;
-	
-	rgbConv=new ColYuvRgb(width,height);
-        rgbConv->reset(width,height);
-
+}
+
+static GtkWidget	*create_dialog1 (void);
+static void  		ui_read ( void);
+static void  		ui_update ( void);
+static void 		draw (GtkWidget *dialog,uint32_t w,uint32_t h );
+static gboolean 	gui_draw( void );
+static void 		autocrop (void );
+static void 		reset( void );
+static void 		ui_upload(void);
+static gboolean		ui_changed(void);
+
+
+static void		prepare(uint32_t img);
+static void 		frame_changed( void );
+
+extern void GUI_RGBDisplay(uint8_t * dis, uint32_t w, uint32_t h, void *widg);
+extern float UI_calcZoomToFitScreen(GtkWindow* window, GtkWidget* drawingArea, uint32_t imageWidth, uint32_t imageHeight);
+extern void UI_centreCanvasWindow(GtkWindow *window, GtkWidget *canvas, int newCanvasWidth, int newCanvasHeight);
+
+static ColYuvRgb    *rgbConv=NULL;
+static uint8_t *working=NULL;
+static uint8_t *rgbBufferDisplay=NULL;
+static uint8_t *original=NULL;
+static GtkWidget *dialog=NULL;
+static uint32_t x,y,w,h,zoomW,zoomH,band;
+
+static AVDMGenericVideoStream *incoming=NULL;
+static ADMImage *imgsrc=NULL;
+static ADMImageResizer *resizer=NULL;
+
+static int lock=0,width,height;
+
+
+//
+//	Video is in YV12 Colorspace
+//
+//
+uint8_t DIA_getMPdelogo(MPDELOGO_PARAM *param,AVDMGenericVideoStream *in)
+
+{
+	// Allocate space for green-ised video
+	width=in->getInfo()->width;
+	height=in->getInfo()->height;
+		
+	working=new uint8_t [width*height*4];	
+	original=NULL;
+
+	uint8_t ret=0;
+
+	dialog=create_dialog1();
+        gtk_register_dialog(dialog);
+	
+	x=param->xoff;
+	y=param->yoff;
+	w=param->lw;
+	h=param->lh;
+	band=param->band;
+
+	imgsrc=new ADMImage(width,height);
+	incoming=in;
+	
+	rgbConv=new ColYuvRgb(width,height);
+        rgbConv->reset(width,height);
+
 	float zoom = UI_calcZoomToFitScreen(GTK_WINDOW(dialog), WID(drawingarea1), width, height);
 
 	zoomW = width * zoom;
@@ -116,418 +117,418 @@
 
 	if (zoom < 1)
 	{
-		gtk_window_set_position(GTK_WINDOW(dialog), GTK_WIN_POS_CENTER);
+		UI_centreCanvasWindow((GtkWindow*)dialog, WID(drawingarea1), zoomW, zoomH);
 		resizer = new ADMImageResizer(width, height, zoomW, zoomH, PIX_FMT_RGB32, PIX_FMT_RGB32);
-	}
-
-	prepare(0);
-	gtk_widget_show(dialog);
-	
-	ui_upload();
-	ui_update();
-	
-#define CONNECT(x,y,z) 	gtk_signal_connect(GTK_OBJECT(WID(x)), #y,GTK_SIGNAL_FUNC(z),   NULL);
-
-        CONNECT(drawingarea1,expose_event,gui_draw);
-        CONNECT(hscale1,value_changed,frame_changed);	  
-		      
-#define CONNECT_SPIN(x) CONNECT(spinbutton##x, value_changed,ui_changed)
-      	  
-        CONNECT_SPIN(X);
-        CONNECT_SPIN(Y);
-        CONNECT_SPIN(W);
-        CONNECT_SPIN(H);
-        CONNECT_SPIN(Band);
-	  
-	draw(dialog,width,height);
-
-	ret=0;
-	int response;
-	while( (response=gtk_dialog_run(GTK_DIALOG(dialog)))==GTK_RESPONSE_APPLY)
-	{
-		ui_changed();
-		
-	}
-	if(response==GTK_RESPONSE_OK)
-        {
-		ui_read( );
-		param->xoff=x;
-                param->yoff=y;
-                param->lw=w;
-                param->lh=h;
-                param->band=band;
-		ret=1;
-	}
-        gtk_unregister_dialog(dialog);
-	gtk_widget_destroy(dialog);
-	delete working;	
-	delete imgsrc;
-	delete rgbConv;
-
-	if (resizer)
-	{
-		delete resizer;
-		delete[] rgbBufferDisplay;
-
-		resizer=NULL;
-		rgbBufferDisplay=NULL;
-	}
-
-	working=NULL;
-	dialog=NULL;
-	original=NULL;
-	imgsrc=NULL;
-	return ret;
-}
-void frame_changed( void )
-{
-uint32_t new_frame,max,l,f;
-double   percent;
-GtkWidget *wid;	
-GtkAdjustment *adj;
-
-        max=incoming->getInfo()->nb_frames;
-        wid=WID(hscale1);
-        adj=gtk_range_get_adjustment (GTK_RANGE(wid));
-        new_frame=0;
-        
-        percent=(double)GTK_ADJUSTMENT(adj)->value;
-        percent*=max;
-        percent/=100.;
-        new_frame=(uint32_t)floor(percent);
-        
-        if(new_frame>=max) new_frame=max-1;
-        
-        prepare(new_frame);
-        ui_update();
-        gui_draw();
-
-
-}
-void prepare(uint32_t img)
-{
-	uint32_t l,f;
-	
-	ADM_assert(incoming->getFrameNumberNoAlloc(img,&l,imgsrc,&f));
-	original=imgsrc->data;
-	
-
-}
-gboolean ui_changed(void)
-{
-	if(!lock)
-	{
-		ui_read();
-		memcpy(working,original,(width*height*3)>>1);
-		ui_update();
-		draw(dialog,width,height);
-	}
-		return true;
-}
-
-
-/*---------------------------------------------------------------------------
-	Actually draw the working frame on screen
-*/
-gboolean gui_draw( void )
-{
-	draw(dialog,width,height);
-	return true;
-}
-void draw (GtkWidget *dialog,uint32_t w,uint32_t h )
-{
-	GtkWidget *draw=WID(drawingarea1);
-
-	if (resizer)
-	{
-		resizer->resize(working, rgbBufferDisplay);
-		GUI_RGBDisplay(rgbBufferDisplay, zoomW, zoomH, (void*)draw);
-	}
-	else
-		GUI_RGBDisplay(working, w, h, (void*)draw);
-}
-/*---------------------------------------------------------------------------
-	Read entried from dialog box
-*/
-
-#define SPIN_GET(x,y) {x= gtk_spin_button_get_value_as_int(GTK_SPIN_BUTTON(WID(spinbutton##y))) ;}
-#define SPIN_SET(x,y)  {gtk_spin_button_set_value(GTK_SPIN_BUTTON(WID(spinbutton##y)),(gfloat)x) ;}
-
-
-void ui_read (void )
-{
-	int reject=0;
-	
-			SPIN_GET(x,X);
-			SPIN_GET(y,Y);
-			SPIN_GET(h,H);
-			SPIN_GET(w,W);
-                        SPIN_GET(band,Band);
-			
-			//printf("%d %d %d %d\n",x,y,w,h);
-			
-			x&=0xffffe;
-			y&=0xffffe;
-			h&=0xffffe;
-			w&=0xffffe;
-			
-			if((x+w)>width)
-				{
-                                        if(w>=width) w=width;
-                                        x=width-w;
-                                        reject=1;
-				}
-			if((y+h)>height)
-				{
-                                        if(h>=height) h=height;
-                                        y=height-h;
-                                        reject=1;
-				}
-			if(reject)
-				ui_upload();
-}
-
-void ui_upload(void)
-{
-	lock++;
-	SPIN_SET(x,X);
-	SPIN_SET(y,Y);
-	SPIN_SET(w,W);
-	SPIN_SET(h,H);
-        SPIN_SET(band,Band);
-	lock--;
-}
-//____________________________________
-void reset( void )
-{
-	
-	x=y=w=h=0;
-	ui_upload();
-	ui_update();
-	gui_draw();
-	
-
-}
-/*---------------------------------------------------------------------------
-	Green-ify the displayed frame on cropped parts
-*/
-void ui_update( )
-{
-
-        uint8_t  *in,*in2;
-        uint8_t *buffer=working;
-
-        rgbConv->scale(original,buffer);
-        // Buffer is in RGB space
-        in=buffer+x*4+y*width*4;
-        in2=buffer+(x+w)*4+y*width*4;
-        
-        for(int yy=0;yy<h;yy++)
-        {
-          in[0]=in[2]=0;in[1]=0xff;
-          in2[0]=in2[2]=0;in2[1]=0xff;
-          in+=width*4;
-          in2+=width*4;
-        }
-        in=buffer+(y*width+x)*4;
-        in2=buffer+((y+h)*width+x)*4;
-        for(int yy=0;yy<w;yy++)
-        {
-          in[0]=in[2]=0;in[1]=0xff;
-          in2[0]=in2[2]=0;in2[1]=0xff;
-          in+=4;
-          in2+=4;
-        }
-
-}
-
-//--------------------------------------------
-GtkWidget*
-create_dialog1 (void)
-{
-  GtkWidget *dialog1;
-  GtkWidget *dialog_vbox1;
-  GtkWidget *vbox1;
-  GtkWidget *vbox2;
-  GtkWidget *table2;
-  GtkWidget *label3;
-  GtkWidget *label4;
-  GtkWidget *label5;
-  GtkWidget *label6;
-  GtkWidget *label7;
-  GtkObject *spinbuttonX_adj;
-  GtkWidget *spinbuttonX;
-  GtkObject *spinbuttonY_adj;
-  GtkWidget *spinbuttonY;
-  GtkObject *spinbuttonW_adj;
-  GtkWidget *spinbuttonW;
-  GtkObject *spinbuttonH_adj;
-  GtkWidget *spinbuttonH;
-  GtkWidget *hseparator1;
-  GtkWidget *hseparator2;
-  GtkObject *spinbuttonBand_adj;
-  GtkWidget *spinbuttonBand;
-  GtkWidget *hseparator3;
-  GtkWidget *hscale1;
-  GtkWidget *drawingarea1;
-  GtkWidget *dialog_action_area1;
-  GtkWidget *cancelbutton1;
-  GtkWidget *okbutton1;
-
-  dialog1 = gtk_dialog_new ();
-  gtk_window_set_title (GTK_WINDOW (dialog1), _("Mplayer Delogo"));
-  gtk_window_set_type_hint (GTK_WINDOW (dialog1), GDK_WINDOW_TYPE_HINT_DIALOG);
-
-  dialog_vbox1 = GTK_DIALOG (dialog1)->vbox;
-  gtk_widget_show (dialog_vbox1);
-
-  vbox1 = gtk_vbox_new (FALSE, 0);
-  gtk_widget_show (vbox1);
-  gtk_box_pack_start (GTK_BOX (dialog_vbox1), vbox1, TRUE, TRUE, 0);
-
-  vbox2 = gtk_vbox_new (FALSE, 0);
-  gtk_widget_show (vbox2);
-  gtk_box_pack_start (GTK_BOX (vbox1), vbox2, FALSE, FALSE, 0);
-
-  table2 = gtk_table_new (3, 4, FALSE);
-  gtk_widget_show (table2);
-  gtk_box_pack_start (GTK_BOX (vbox2), table2, TRUE, TRUE, 0);
-
-  label3 = gtk_label_new (_("X"));
-  gtk_widget_show (label3);
-  gtk_table_attach (GTK_TABLE (table2), label3, 0, 1, 0, 1,
-                    (GtkAttachOptions) (GTK_FILL),
-                    (GtkAttachOptions) (0), 0, 0);
-  gtk_misc_set_alignment (GTK_MISC (label3), 0, 0.5);
-
-  label4 = gtk_label_new (_("Y"));
-  gtk_widget_show (label4);
-  gtk_table_attach (GTK_TABLE (table2), label4, 0, 1, 1, 2,
-                    (GtkAttachOptions) (GTK_FILL),
-                    (GtkAttachOptions) (0), 0, 0);
-  gtk_misc_set_alignment (GTK_MISC (label4), 0, 0.5);
-
-  label5 = gtk_label_new (_("W"));
-  gtk_widget_show (label5);
-  gtk_table_attach (GTK_TABLE (table2), label5, 2, 3, 0, 1,
-                    (GtkAttachOptions) (GTK_FILL),
-                    (GtkAttachOptions) (0), 0, 0);
-  gtk_misc_set_alignment (GTK_MISC (label5), 0, 0.5);
-
-  label6 = gtk_label_new (_("H"));
-  gtk_widget_show (label6);
-  gtk_table_attach (GTK_TABLE (table2), label6, 2, 3, 1, 2,
-                    (GtkAttachOptions) (GTK_FILL),
-                    (GtkAttachOptions) (0), 0, 0);
-  gtk_misc_set_alignment (GTK_MISC (label6), 0, 0.5);
-
-  label7 = gtk_label_new (_("Band"));
-  gtk_widget_show (label7);
-  gtk_table_attach (GTK_TABLE (table2), label7, 0, 1, 2, 3,
-                    (GtkAttachOptions) (GTK_FILL),
-                    (GtkAttachOptions) (0), 0, 0);
-  gtk_misc_set_alignment (GTK_MISC (label7), 0, 0.5);
-
-  spinbuttonX_adj = gtk_adjustment_new (1, 0, 2000, 1, 10, 10);
-  spinbuttonX = gtk_spin_button_new (GTK_ADJUSTMENT (spinbuttonX_adj), 1, 0);
-  gtk_widget_show (spinbuttonX);
-  gtk_table_attach (GTK_TABLE (table2), spinbuttonX, 1, 2, 0, 1,
-                    (GtkAttachOptions) (GTK_EXPAND | GTK_FILL),
-                    (GtkAttachOptions) (0), 0, 0);
-
-  spinbuttonY_adj = gtk_adjustment_new (1, 0, 2000, 1, 10, 10);
-  spinbuttonY = gtk_spin_button_new (GTK_ADJUSTMENT (spinbuttonY_adj), 1, 0);
-  gtk_widget_show (spinbuttonY);
-  gtk_table_attach (GTK_TABLE (table2), spinbuttonY, 1, 2, 1, 2,
-                    (GtkAttachOptions) (GTK_EXPAND | GTK_FILL),
-                    (GtkAttachOptions) (0), 0, 0);
-
-  spinbuttonW_adj = gtk_adjustment_new (1, 0, 2000, 1, 10, 10);
-  spinbuttonW = gtk_spin_button_new (GTK_ADJUSTMENT (spinbuttonW_adj), 1, 0);
-  gtk_widget_show (spinbuttonW);
-  gtk_table_attach (GTK_TABLE (table2), spinbuttonW, 3, 4, 0, 1,
-                    (GtkAttachOptions) (GTK_EXPAND | GTK_FILL),
-                    (GtkAttachOptions) (0), 0, 0);
-
-  spinbuttonH_adj = gtk_adjustment_new (1, 0, 2000, 1, 10, 10);
-  spinbuttonH = gtk_spin_button_new (GTK_ADJUSTMENT (spinbuttonH_adj), 1, 0);
-  gtk_widget_show (spinbuttonH);
-  gtk_table_attach (GTK_TABLE (table2), spinbuttonH, 3, 4, 1, 2,
-                    (GtkAttachOptions) (GTK_EXPAND | GTK_FILL),
-                    (GtkAttachOptions) (0), 0, 0);
-
-  hseparator1 = gtk_hseparator_new ();
-  gtk_widget_show (hseparator1);
-  gtk_table_attach (GTK_TABLE (table2), hseparator1, 3, 4, 2, 3,
-                    (GtkAttachOptions) (GTK_FILL),
-                    (GtkAttachOptions) (GTK_FILL), 0, 0);
-
-  hseparator2 = gtk_hseparator_new ();
-  gtk_widget_show (hseparator2);
-  gtk_table_attach (GTK_TABLE (table2), hseparator2, 2, 3, 2, 3,
-                    (GtkAttachOptions) (GTK_FILL),
-                    (GtkAttachOptions) (GTK_FILL), 0, 0);
-
-  spinbuttonBand_adj = gtk_adjustment_new (1, 0, 100, 1, 10, 10);
-  spinbuttonBand = gtk_spin_button_new (GTK_ADJUSTMENT (spinbuttonBand_adj), 1, 0);
-  gtk_widget_show (spinbuttonBand);
-  gtk_table_attach (GTK_TABLE (table2), spinbuttonBand, 1, 2, 2, 3,
-                    (GtkAttachOptions) (GTK_EXPAND | GTK_FILL),
-                    (GtkAttachOptions) (0), 0, 0);
-
-  hseparator3 = gtk_hseparator_new ();
-  gtk_widget_show (hseparator3);
-  gtk_box_pack_start (GTK_BOX (vbox2), hseparator3, FALSE, FALSE, 0);
-
-  hscale1 = gtk_hscale_new (GTK_ADJUSTMENT (gtk_adjustment_new (0, 0, 100, 1, 1, 0)));
-  gtk_widget_show (hscale1);
-  gtk_box_pack_start (GTK_BOX (vbox1), hscale1, FALSE, FALSE, 0);
-
-  drawingarea1 = gtk_drawing_area_new ();
-  gtk_widget_show (drawingarea1);
-  gtk_box_pack_start (GTK_BOX (vbox1), drawingarea1, TRUE, TRUE, 0);
-  gtk_widget_set_size_request (drawingarea1, 100, 100);
-
-  dialog_action_area1 = GTK_DIALOG (dialog1)->action_area;
-  gtk_widget_show (dialog_action_area1);
-  gtk_button_box_set_layout (GTK_BUTTON_BOX (dialog_action_area1), GTK_BUTTONBOX_END);
-
-  cancelbutton1 = gtk_button_new_from_stock ("gtk-cancel");
-  gtk_widget_show (cancelbutton1);
-  gtk_dialog_add_action_widget (GTK_DIALOG (dialog1), cancelbutton1, GTK_RESPONSE_CANCEL);
-  GTK_WIDGET_SET_FLAGS (cancelbutton1, GTK_CAN_DEFAULT);
-
-  okbutton1 = gtk_button_new_from_stock ("gtk-ok");
-  gtk_widget_show (okbutton1);
-  gtk_dialog_add_action_widget (GTK_DIALOG (dialog1), okbutton1, GTK_RESPONSE_OK);
-  GTK_WIDGET_SET_FLAGS (okbutton1, GTK_CAN_DEFAULT);
-
-  /* Store pointers to all widgets, for use by lookup_widget(). */
-  GLADE_HOOKUP_OBJECT_NO_REF (dialog1, dialog1, "dialog1");
-  GLADE_HOOKUP_OBJECT_NO_REF (dialog1, dialog_vbox1, "dialog_vbox1");
-  GLADE_HOOKUP_OBJECT (dialog1, vbox1, "vbox1");
-  GLADE_HOOKUP_OBJECT (dialog1, vbox2, "vbox2");
-  GLADE_HOOKUP_OBJECT (dialog1, table2, "table2");
-  GLADE_HOOKUP_OBJECT (dialog1, label3, "label3");
-  GLADE_HOOKUP_OBJECT (dialog1, label4, "label4");
-  GLADE_HOOKUP_OBJECT (dialog1, label5, "label5");
-  GLADE_HOOKUP_OBJECT (dialog1, label6, "label6");
-  GLADE_HOOKUP_OBJECT (dialog1, label7, "label7");
-  GLADE_HOOKUP_OBJECT (dialog1, spinbuttonX, "spinbuttonX");
-  GLADE_HOOKUP_OBJECT (dialog1, spinbuttonY, "spinbuttonY");
-  GLADE_HOOKUP_OBJECT (dialog1, spinbuttonW, "spinbuttonW");
-  GLADE_HOOKUP_OBJECT (dialog1, spinbuttonH, "spinbuttonH");
-  GLADE_HOOKUP_OBJECT (dialog1, hseparator1, "hseparator1");
-  GLADE_HOOKUP_OBJECT (dialog1, hseparator2, "hseparator2");
-  GLADE_HOOKUP_OBJECT (dialog1, spinbuttonBand, "spinbuttonBand");
-  GLADE_HOOKUP_OBJECT (dialog1, hseparator3, "hseparator3");
-  GLADE_HOOKUP_OBJECT (dialog1, hscale1, "hscale1");
-  GLADE_HOOKUP_OBJECT (dialog1, drawingarea1, "drawingarea1");
-  GLADE_HOOKUP_OBJECT_NO_REF (dialog1, dialog_action_area1, "dialog_action_area1");
-  GLADE_HOOKUP_OBJECT (dialog1, cancelbutton1, "cancelbutton1");
-  GLADE_HOOKUP_OBJECT (dialog1, okbutton1, "okbutton1");
-
-  return dialog1;
-}
-
-
+	}
+
+	prepare(0);
+	gtk_widget_show(dialog);
+	
+	ui_upload();
+	ui_update();
+	
+#define CONNECT(x,y,z) 	gtk_signal_connect(GTK_OBJECT(WID(x)), #y,GTK_SIGNAL_FUNC(z),   NULL);
+
+        CONNECT(drawingarea1,expose_event,gui_draw);
+        CONNECT(hscale1,value_changed,frame_changed);	  
+		      
+#define CONNECT_SPIN(x) CONNECT(spinbutton##x, value_changed,ui_changed)
+      	  
+        CONNECT_SPIN(X);
+        CONNECT_SPIN(Y);
+        CONNECT_SPIN(W);
+        CONNECT_SPIN(H);
+        CONNECT_SPIN(Band);
+	  
+	draw(dialog,width,height);
+
+	ret=0;
+	int response;
+	while( (response=gtk_dialog_run(GTK_DIALOG(dialog)))==GTK_RESPONSE_APPLY)
+	{
+		ui_changed();
+		
+	}
+	if(response==GTK_RESPONSE_OK)
+        {
+		ui_read( );
+		param->xoff=x;
+                param->yoff=y;
+                param->lw=w;
+                param->lh=h;
+                param->band=band;
+		ret=1;
+	}
+        gtk_unregister_dialog(dialog);
+	gtk_widget_destroy(dialog);
+	delete working;	
+	delete imgsrc;
+	delete rgbConv;
+
+	if (resizer)
+	{
+		delete resizer;
+		delete[] rgbBufferDisplay;
+
+		resizer=NULL;
+		rgbBufferDisplay=NULL;
+	}
+
+	working=NULL;
+	dialog=NULL;
+	original=NULL;
+	imgsrc=NULL;
+	return ret;
+}
+void frame_changed( void )
+{
+uint32_t new_frame,max,l,f;
+double   percent;
+GtkWidget *wid;	
+GtkAdjustment *adj;
+
+        max=incoming->getInfo()->nb_frames;
+        wid=WID(hscale1);
+        adj=gtk_range_get_adjustment (GTK_RANGE(wid));
+        new_frame=0;
+        
+        percent=(double)GTK_ADJUSTMENT(adj)->value;
+        percent*=max;
+        percent/=100.;
+        new_frame=(uint32_t)floor(percent);
+        
+        if(new_frame>=max) new_frame=max-1;
+        
+        prepare(new_frame);
+        ui_update();
+        gui_draw();
+
+
+}
+void prepare(uint32_t img)
+{
+	uint32_t l,f;
+	
+	ADM_assert(incoming->getFrameNumberNoAlloc(img,&l,imgsrc,&f));
+	original=imgsrc->data;
+	
+
+}
+gboolean ui_changed(void)
+{
+	if(!lock)
+	{
+		ui_read();
+		memcpy(working,original,(width*height*3)>>1);
+		ui_update();
+		draw(dialog,width,height);
+	}
+		return true;
+}
+
+
+/*---------------------------------------------------------------------------
+	Actually draw the working frame on screen
+*/
+gboolean gui_draw( void )
+{
+	draw(dialog,width,height);
+	return true;
+}
+void draw (GtkWidget *dialog,uint32_t w,uint32_t h )
+{
+	GtkWidget *draw=WID(drawingarea1);
+
+	if (resizer)
+	{
+		resizer->resize(working, rgbBufferDisplay);
+		GUI_RGBDisplay(rgbBufferDisplay, zoomW, zoomH, (void*)draw);
+	}
+	else
+		GUI_RGBDisplay(working, w, h, (void*)draw);
+}
+/*---------------------------------------------------------------------------
+	Read entried from dialog box
+*/
+
+#define SPIN_GET(x,y) {x= gtk_spin_button_get_value_as_int(GTK_SPIN_BUTTON(WID(spinbutton##y))) ;}
+#define SPIN_SET(x,y)  {gtk_spin_button_set_value(GTK_SPIN_BUTTON(WID(spinbutton##y)),(gfloat)x) ;}
+
+
+void ui_read (void )
+{
+	int reject=0;
+	
+			SPIN_GET(x,X);
+			SPIN_GET(y,Y);
+			SPIN_GET(h,H);
+			SPIN_GET(w,W);
+                        SPIN_GET(band,Band);
+			
+			//printf("%d %d %d %d\n",x,y,w,h);
+			
+			x&=0xffffe;
+			y&=0xffffe;
+			h&=0xffffe;
+			w&=0xffffe;
+			
+			if((x+w)>width)
+				{
+                                        if(w>=width) w=width;
+                                        x=width-w;
+                                        reject=1;
+				}
+			if((y+h)>height)
+				{
+                                        if(h>=height) h=height;
+                                        y=height-h;
+                                        reject=1;
+				}
+			if(reject)
+				ui_upload();
+}
+
+void ui_upload(void)
+{
+	lock++;
+	SPIN_SET(x,X);
+	SPIN_SET(y,Y);
+	SPIN_SET(w,W);
+	SPIN_SET(h,H);
+        SPIN_SET(band,Band);
+	lock--;
+}
+//____________________________________
+void reset( void )
+{
+	
+	x=y=w=h=0;
+	ui_upload();
+	ui_update();
+	gui_draw();
+	
+
+}
+/*---------------------------------------------------------------------------
+	Green-ify the displayed frame on cropped parts
+*/
+void ui_update( )
+{
+
+        uint8_t  *in,*in2;
+        uint8_t *buffer=working;
+
+        rgbConv->scale(original,buffer);
+        // Buffer is in RGB space
+        in=buffer+x*4+y*width*4;
+        in2=buffer+(x+w)*4+y*width*4;
+        
+        for(int yy=0;yy<h;yy++)
+        {
+          in[0]=in[2]=0;in[1]=0xff;
+          in2[0]=in2[2]=0;in2[1]=0xff;
+          in+=width*4;
+          in2+=width*4;
+        }
+        in=buffer+(y*width+x)*4;
+        in2=buffer+((y+h)*width+x)*4;
+        for(int yy=0;yy<w;yy++)
+        {
+          in[0]=in[2]=0;in[1]=0xff;
+          in2[0]=in2[2]=0;in2[1]=0xff;
+          in+=4;
+          in2+=4;
+        }
+
+}
+
+//--------------------------------------------
+GtkWidget*
+create_dialog1 (void)
+{
+  GtkWidget *dialog1;
+  GtkWidget *dialog_vbox1;
+  GtkWidget *vbox1;
+  GtkWidget *vbox2;
+  GtkWidget *table2;
+  GtkWidget *label3;
+  GtkWidget *label4;
+  GtkWidget *label5;
+  GtkWidget *label6;
+  GtkWidget *label7;
+  GtkObject *spinbuttonX_adj;
+  GtkWidget *spinbuttonX;
+  GtkObject *spinbuttonY_adj;
+  GtkWidget *spinbuttonY;
+  GtkObject *spinbuttonW_adj;
+  GtkWidget *spinbuttonW;
+  GtkObject *spinbuttonH_adj;
+  GtkWidget *spinbuttonH;
+  GtkWidget *hseparator1;
+  GtkWidget *hseparator2;
+  GtkObject *spinbuttonBand_adj;
+  GtkWidget *spinbuttonBand;
+  GtkWidget *hseparator3;
+  GtkWidget *hscale1;
+  GtkWidget *drawingarea1;
+  GtkWidget *dialog_action_area1;
+  GtkWidget *cancelbutton1;
+  GtkWidget *okbutton1;
+
+  dialog1 = gtk_dialog_new ();
+  gtk_window_set_title (GTK_WINDOW (dialog1), _("Mplayer Delogo"));
+  gtk_window_set_type_hint (GTK_WINDOW (dialog1), GDK_WINDOW_TYPE_HINT_DIALOG);
+
+  dialog_vbox1 = GTK_DIALOG (dialog1)->vbox;
+  gtk_widget_show (dialog_vbox1);
+
+  vbox1 = gtk_vbox_new (FALSE, 0);
+  gtk_widget_show (vbox1);
+  gtk_box_pack_start (GTK_BOX (dialog_vbox1), vbox1, TRUE, TRUE, 0);
+
+  vbox2 = gtk_vbox_new (FALSE, 0);
+  gtk_widget_show (vbox2);
+  gtk_box_pack_start (GTK_BOX (vbox1), vbox2, FALSE, FALSE, 0);
+
+  table2 = gtk_table_new (3, 4, FALSE);
+  gtk_widget_show (table2);
+  gtk_box_pack_start (GTK_BOX (vbox2), table2, TRUE, TRUE, 0);
+
+  label3 = gtk_label_new (_("X"));
+  gtk_widget_show (label3);
+  gtk_table_attach (GTK_TABLE (table2), label3, 0, 1, 0, 1,
+                    (GtkAttachOptions) (GTK_FILL),
+                    (GtkAttachOptions) (0), 0, 0);
+  gtk_misc_set_alignment (GTK_MISC (label3), 0, 0.5);
+
+  label4 = gtk_label_new (_("Y"));
+  gtk_widget_show (label4);
+  gtk_table_attach (GTK_TABLE (table2), label4, 0, 1, 1, 2,
+                    (GtkAttachOptions) (GTK_FILL),
+                    (GtkAttachOptions) (0), 0, 0);
+  gtk_misc_set_alignment (GTK_MISC (label4), 0, 0.5);
+
+  label5 = gtk_label_new (_("W"));
+  gtk_widget_show (label5);
+  gtk_table_attach (GTK_TABLE (table2), label5, 2, 3, 0, 1,
+                    (GtkAttachOptions) (GTK_FILL),
+                    (GtkAttachOptions) (0), 0, 0);
+  gtk_misc_set_alignment (GTK_MISC (label5), 0, 0.5);
+
+  label6 = gtk_label_new (_("H"));
+  gtk_widget_show (label6);
+  gtk_table_attach (GTK_TABLE (table2), label6, 2, 3, 1, 2,
+                    (GtkAttachOptions) (GTK_FILL),
+                    (GtkAttachOptions) (0), 0, 0);
+  gtk_misc_set_alignment (GTK_MISC (label6), 0, 0.5);
+
+  label7 = gtk_label_new (_("Band"));
+  gtk_widget_show (label7);
+  gtk_table_attach (GTK_TABLE (table2), label7, 0, 1, 2, 3,
+                    (GtkAttachOptions) (GTK_FILL),
+                    (GtkAttachOptions) (0), 0, 0);
+  gtk_misc_set_alignment (GTK_MISC (label7), 0, 0.5);
+
+  spinbuttonX_adj = gtk_adjustment_new (1, 0, 2000, 1, 10, 10);
+  spinbuttonX = gtk_spin_button_new (GTK_ADJUSTMENT (spinbuttonX_adj), 1, 0);
+  gtk_widget_show (spinbuttonX);
+  gtk_table_attach (GTK_TABLE (table2), spinbuttonX, 1, 2, 0, 1,
+                    (GtkAttachOptions) (GTK_EXPAND | GTK_FILL),
+                    (GtkAttachOptions) (0), 0, 0);
+
+  spinbuttonY_adj = gtk_adjustment_new (1, 0, 2000, 1, 10, 10);
+  spinbuttonY = gtk_spin_button_new (GTK_ADJUSTMENT (spinbuttonY_adj), 1, 0);
+  gtk_widget_show (spinbuttonY);
+  gtk_table_attach (GTK_TABLE (table2), spinbuttonY, 1, 2, 1, 2,
+                    (GtkAttachOptions) (GTK_EXPAND | GTK_FILL),
+                    (GtkAttachOptions) (0), 0, 0);
+
+  spinbuttonW_adj = gtk_adjustment_new (1, 0, 2000, 1, 10, 10);
+  spinbuttonW = gtk_spin_button_new (GTK_ADJUSTMENT (spinbuttonW_adj), 1, 0);
+  gtk_widget_show (spinbuttonW);
+  gtk_table_attach (GTK_TABLE (table2), spinbuttonW, 3, 4, 0, 1,
+                    (GtkAttachOptions) (GTK_EXPAND | GTK_FILL),
+                    (GtkAttachOptions) (0), 0, 0);
+
+  spinbuttonH_adj = gtk_adjustment_new (1, 0, 2000, 1, 10, 10);
+  spinbuttonH = gtk_spin_button_new (GTK_ADJUSTMENT (spinbuttonH_adj), 1, 0);
+  gtk_widget_show (spinbuttonH);
+  gtk_table_attach (GTK_TABLE (table2), spinbuttonH, 3, 4, 1, 2,
+                    (GtkAttachOptions) (GTK_EXPAND | GTK_FILL),
+                    (GtkAttachOptions) (0), 0, 0);
+
+  hseparator1 = gtk_hseparator_new ();
+  gtk_widget_show (hseparator1);
+  gtk_table_attach (GTK_TABLE (table2), hseparator1, 3, 4, 2, 3,
+                    (GtkAttachOptions) (GTK_FILL),
+                    (GtkAttachOptions) (GTK_FILL), 0, 0);
+
+  hseparator2 = gtk_hseparator_new ();
+  gtk_widget_show (hseparator2);
+  gtk_table_attach (GTK_TABLE (table2), hseparator2, 2, 3, 2, 3,
+                    (GtkAttachOptions) (GTK_FILL),
+                    (GtkAttachOptions) (GTK_FILL), 0, 0);
+
+  spinbuttonBand_adj = gtk_adjustment_new (1, 0, 100, 1, 10, 10);
+  spinbuttonBand = gtk_spin_button_new (GTK_ADJUSTMENT (spinbuttonBand_adj), 1, 0);
+  gtk_widget_show (spinbuttonBand);
+  gtk_table_attach (GTK_TABLE (table2), spinbuttonBand, 1, 2, 2, 3,
+                    (GtkAttachOptions) (GTK_EXPAND | GTK_FILL),
+                    (GtkAttachOptions) (0), 0, 0);
+
+  hseparator3 = gtk_hseparator_new ();
+  gtk_widget_show (hseparator3);
+  gtk_box_pack_start (GTK_BOX (vbox2), hseparator3, FALSE, FALSE, 0);
+
+  hscale1 = gtk_hscale_new (GTK_ADJUSTMENT (gtk_adjustment_new (0, 0, 100, 1, 1, 0)));
+  gtk_widget_show (hscale1);
+  gtk_box_pack_start (GTK_BOX (vbox1), hscale1, FALSE, FALSE, 0);
+
+  drawingarea1 = gtk_drawing_area_new ();
+  gtk_widget_show (drawingarea1);
+  gtk_box_pack_start (GTK_BOX (vbox1), drawingarea1, TRUE, TRUE, 0);
+  gtk_widget_set_size_request (drawingarea1, 100, 100);
+
+  dialog_action_area1 = GTK_DIALOG (dialog1)->action_area;
+  gtk_widget_show (dialog_action_area1);
+  gtk_button_box_set_layout (GTK_BUTTON_BOX (dialog_action_area1), GTK_BUTTONBOX_END);
+
+  cancelbutton1 = gtk_button_new_from_stock ("gtk-cancel");
+  gtk_widget_show (cancelbutton1);
+  gtk_dialog_add_action_widget (GTK_DIALOG (dialog1), cancelbutton1, GTK_RESPONSE_CANCEL);
+  GTK_WIDGET_SET_FLAGS (cancelbutton1, GTK_CAN_DEFAULT);
+
+  okbutton1 = gtk_button_new_from_stock ("gtk-ok");
+  gtk_widget_show (okbutton1);
+  gtk_dialog_add_action_widget (GTK_DIALOG (dialog1), okbutton1, GTK_RESPONSE_OK);
+  GTK_WIDGET_SET_FLAGS (okbutton1, GTK_CAN_DEFAULT);
+
+  /* Store pointers to all widgets, for use by lookup_widget(). */
+  GLADE_HOOKUP_OBJECT_NO_REF (dialog1, dialog1, "dialog1");
+  GLADE_HOOKUP_OBJECT_NO_REF (dialog1, dialog_vbox1, "dialog_vbox1");
+  GLADE_HOOKUP_OBJECT (dialog1, vbox1, "vbox1");
+  GLADE_HOOKUP_OBJECT (dialog1, vbox2, "vbox2");
+  GLADE_HOOKUP_OBJECT (dialog1, table2, "table2");
+  GLADE_HOOKUP_OBJECT (dialog1, label3, "label3");
+  GLADE_HOOKUP_OBJECT (dialog1, label4, "label4");
+  GLADE_HOOKUP_OBJECT (dialog1, label5, "label5");
+  GLADE_HOOKUP_OBJECT (dialog1, label6, "label6");
+  GLADE_HOOKUP_OBJECT (dialog1, label7, "label7");
+  GLADE_HOOKUP_OBJECT (dialog1, spinbuttonX, "spinbuttonX");
+  GLADE_HOOKUP_OBJECT (dialog1, spinbuttonY, "spinbuttonY");
+  GLADE_HOOKUP_OBJECT (dialog1, spinbuttonW, "spinbuttonW");
+  GLADE_HOOKUP_OBJECT (dialog1, spinbuttonH, "spinbuttonH");
+  GLADE_HOOKUP_OBJECT (dialog1, hseparator1, "hseparator1");
+  GLADE_HOOKUP_OBJECT (dialog1, hseparator2, "hseparator2");
+  GLADE_HOOKUP_OBJECT (dialog1, spinbuttonBand, "spinbuttonBand");
+  GLADE_HOOKUP_OBJECT (dialog1, hseparator3, "hseparator3");
+  GLADE_HOOKUP_OBJECT (dialog1, hscale1, "hscale1");
+  GLADE_HOOKUP_OBJECT (dialog1, drawingarea1, "drawingarea1");
+  GLADE_HOOKUP_OBJECT_NO_REF (dialog1, dialog_action_area1, "dialog_action_area1");
+  GLADE_HOOKUP_OBJECT (dialog1, cancelbutton1, "cancelbutton1");
+  GLADE_HOOKUP_OBJECT (dialog1, okbutton1, "okbutton1");
+
+  return dialog1;
+}
+
+

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_preview.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_preview.cpp	2007-07-25 18:17:34 UTC (rev 3445)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_preview.cpp	2007-07-26 13:33:46 UTC (rev 3446)
@@ -32,7 +32,6 @@
 #include "DIA_flyPreview.h"
 
 static GtkWidget *create_dialog1(void);
-extern float UI_calcZoomToFitScreen(GtkWindow* window, GtkWidget* drawingArea, uint32_t imageWidth, uint32_t imageHeight);
 
 static GtkWidget *dialog = NULL;
 
@@ -79,16 +78,6 @@
 	width = videoStream->getInfo()->width;
 	height = videoStream->getInfo()->height;
 
-	float zoom = UI_calcZoomToFitScreen(GTK_WINDOW(dialog), WID(drawingarea1), width, height);
-
-	uint32_t zoomW = width * zoom;
-	uint32_t zoomH = height * zoom;
-
-	gtk_widget_set_usize(WID(drawingarea1), zoomW, zoomH);
-
-	if (zoom < 1)
-		gtk_window_set_position(GTK_WINDOW(dialog), GTK_WIN_POS_CENTER);
-
 	gtk_signal_connect(GTK_OBJECT(WID(scale)), "value_changed", GTK_SIGNAL_FUNC(seekablePreview_frame_changed), NULL);
 	gtk_signal_connect(GTK_OBJECT(WID(drawingarea1)), "expose_event", GTK_SIGNAL_FUNC(seekablePreview_draw), NULL);
 	gtk_dialog_add_action_widget(GTK_DIALOG(dialog), WID(buttonOk), GTK_RESPONSE_OK);
@@ -97,7 +86,6 @@
 
 	seekablePreview = new flySeekablePreview(width, height, videoStream, WID(drawingarea1), WID(scale));
 	seekablePreview->process();
-	seekablePreview->resizeImage(zoomW, zoomH);
 	seekablePreview->sliderSet(frame);
 	seekablePreview->sliderChanged();
 

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_srt.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_srt.cpp	2007-07-25 18:17:34 UTC (rev 3445)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_srt.cpp	2007-07-26 13:33:46 UTC (rev 3446)
@@ -1,311 +1,296 @@
-/***************************************************************************
-                          ADM_guiSRT.cpp  -  description
-                             -------------------
-    begin                : Wed Dec 18 2002
-    copyright            : (C) 2002 by mean
-    email                : fixounet at free.fr
- ***************************************************************************/
-
-/***************************************************************************
- *                                                                         *
- *   This program is free software; you can redistribute it and/or modify  *
- *   it under the terms of the GNU General Public License as published by  *
- *   the Free Software Foundation; either version 2 of the License, or     *
- *   (at your option) any later version.                                   *
- *                                                                         *
- ***************************************************************************/
-#include "config.h"
-
-#include <stdio.h>
-#include <stdlib.h>
-#include <string.h>
-
-#include <gtk/gtk.h>
-#include <time.h>
-#include <sys/time.h>
-#include <math.h>
-#include <iconv.h>
-
-
-#include "fourcc.h"
-#include "avio.hxx"
-
-#ifdef USE_FREETYPE
-
-#include "avi_vars.h"
-#include "ADM_toolkit/toolkit.hxx"
-#include "ADM_toolkit/filesel.h"
-
-
-
-#include "ADM_editor/ADM_edit.hxx"
-#include "ADM_video/ADM_genvideo.hxx"
-
-//#include "ADM_video/ADM_vidFont.h"
-class ADMfont;
-#include "ADM_video/ADM_vidSRT.h"
-
-#include "ADM_toolkit_gtk/ADM_gladeSupport.h"
-#include "ADM_toolkit_gtk/toolkit_gtk.h"
-#include "ADM_toolkit_gtk/toolkit_gtk_include.h"
-
-#include "ADM_colorspace/ADM_rgb.h"
-#include "ADM_colorspace/colorspace.h"
-
-#include "ADM_osSupport/ADM_debugID.h"
-#define MODULE_NAME MODULE_FILTER
-#include "ADM_osSupport/ADM_debug.h"
-
-#include <ADM_assert.h>
-#include "DIA_flyDialog.h"
-#include "DIA_flySrtPos.h"
-
-
-static void read( void );
-static void upload ( void );
-static gboolean slider_update( void );
-static gboolean gui_update( void);
-static gboolean gui_draw( void );
-static GtkWidget *create_dialog1 (void);
-
-static GtkWidget *dialog=NULL;
-static flySrtPos *myCrop=NULL;
-static int lock=0;
-
-extern float UI_calcZoomToFitScreen(GtkWindow* window, GtkWidget* drawingArea, uint32_t imageWidth, uint32_t imageHeight);
-/**
-      \fn DIA_srtPos
-      \brief Dialog that handles subtitle size and position
-*/
-int DIA_srtPos(AVDMGenericVideoStream *in,uint32_t *size,uint32_t *position)
-{
-  uint8_t ret=0;
-  
-        uint32_t width,height;
-
-        // Allocate space for green-ised video
-        width=in->getInfo()->width;
-        height=in->getInfo()->height;
-
-        dialog=create_dialog1();
-        gtk_register_dialog(dialog);
-        gtk_window_set_title (GTK_WINDOW (dialog), _("Subtitle Size and Position"));
-
-		float zoom = UI_calcZoomToFitScreen(GTK_WINDOW(dialog), WID(drawingarea1), width, height);
+/***************************************************************************
+                          ADM_guiSRT.cpp  -  description
+                             -------------------
+    begin                : Wed Dec 18 2002
+    copyright            : (C) 2002 by mean
+    email                : fixounet at free.fr
+ ***************************************************************************/
 
-		uint32_t zoomW = width * zoom;
-		uint32_t zoomH = height * zoom;
+/***************************************************************************
+ *                                                                         *
+ *   This program is free software; you can redistribute it and/or modify  *
+ *   it under the terms of the GNU General Public License as published by  *
+ *   the Free Software Foundation; either version 2 of the License, or     *
+ *   (at your option) any later version.                                   *
+ *                                                                         *
+ ***************************************************************************/
+#include "config.h"
 
-		gtk_widget_set_usize(WID(drawingarea1), zoomW, zoomH);
+#include <stdio.h>
+#include <stdlib.h>
+#include <string.h>
 
-		if (zoom < 1)
-		{
-			gtk_window_set_position(GTK_WINDOW(dialog), GTK_WIN_POS_CENTER);
-		}
-
-        gtk_widget_show(dialog);
-	
-        myCrop=new flySrtPos( width, height,in,WID(drawingarea1),WID(hscale1));
-        myCrop->param.fontSize=*size;
-        myCrop->param.position=*position;
-
-        gtk_range_set_range(GTK_RANGE(WID(vscale1)),0,height-1);
-
-		myCrop->resizeImage(zoomW, zoomH);
-        myCrop->upload();
-        myCrop->sliderChanged();
-        
-        gtk_signal_connect(GTK_OBJECT(WID(drawingarea1)), "expose_event",
-            GTK_SIGNAL_FUNC(gui_draw),
-            NULL);
-        
-        gtk_signal_connect (GTK_OBJECT(WID( spinbutton1)), "value_changed",
-                    GTK_SIGNAL_FUNC (gui_update),
-                    NULL);
-        
-         gtk_signal_connect (GTK_OBJECT(WID( hscale1)), "value_changed",
-                    GTK_SIGNAL_FUNC (slider_update),
-                    NULL);
-
-          gtk_signal_connect (GTK_OBJECT(WID( vscale1)), "value_changed",
-                    GTK_SIGNAL_FUNC (gui_update),
-                    NULL);
-       
-        ret=0;
-        int response;
-        response=gtk_dialog_run(GTK_DIALOG(dialog));
-
-        if(response==GTK_RESPONSE_OK)
-        {
-            myCrop->download();
-            *size=myCrop->param.fontSize;
-            *position=myCrop->param.position;
-            ret=1;
-        }
-        gtk_unregister_dialog(dialog);
-        gtk_widget_destroy(dialog);
-        delete myCrop;
-        return ret;
-}
-/**********************************/
-void read( void )
-{
-	myCrop->download();
-}
-gboolean slider_update( void )
-{
-        myCrop->sliderChanged();
-        return true;
-}
-gboolean gui_update( void)
-{
-  if(lock) return true;
-      myCrop->update();
-  return true;
-}
-gboolean gui_draw( void )
-{
-	myCrop->display();
-	return true;
-}
-
-/******************************/
-#define SPIN_GET(x,y) {y= gtk_spin_button_get_value_as_int(GTK_SPIN_BUTTON(lookup_widget(dialog,#x))) ;\
-				printf(#x":%d\n", y);}
-
-#define SPIN_SET(x,y)  {gtk_spin_button_set_value(GTK_SPIN_BUTTON(lookup_widget(dialog,#x)),(gfloat)y) ; printf(#x":%d\n", y);}
-
-
-uint8_t    flySrtPos::upload(void)
-{
-        SPIN_SET(spinbutton1,param.fontSize);
-        
-        int32_t max=_h;
-        max-=(SRT_MAX_LINE)*param.fontSize;
-        if(max<0) max=0;
-        if(param.position>=max)
-        {
-          param.position=max;
-        }
-        
-        GtkAdjustment *adj=gtk_range_get_adjustment (GTK_RANGE(WID(vscale1)));
-        GTK_ADJUSTMENT(adj)->value=param.position;
-        return 1;
-}
-uint8_t    flySrtPos::download(void)
-{
-        SPIN_GET(spinbutton1,param.fontSize);
-        GtkAdjustment *adj=gtk_range_get_adjustment (GTK_RANGE(WID(vscale1)));
-        param.position=(uint32_t)GTK_ADJUSTMENT(adj)->value;
-        
-        int32_t max=_h;
-        max-=(SRT_MAX_LINE)*param.fontSize;
-        if(max<0) max=0;
-        if(param.position>=max)
-        {
-          param.position=max;
-          upload(); 
-        }
-        
-        return 1;
-}
-
-/*
-	Almost straigh out of glade2
-
-*/
-
-GtkWidget*
-create_dialog1 (void)
-{
-  GtkWidget *dialog1;
-  GtkWidget *dialog_vbox1;
-  GtkWidget *vbox1;
-  GtkWidget *hbox1;
-  GtkWidget *label1;
-  GtkObject *spinbutton1_adj;
-  GtkWidget *spinbutton1;
-  GtkWidget *hscale1;
-  GtkWidget *hbox2;
-  GtkWidget *drawingarea1;
-  GtkWidget *vscale1;
-  GtkWidget *dialog_action_area1;
-  GtkWidget *cancelbutton1;
-  GtkWidget *okbutton1;
-
-  dialog1 = gtk_dialog_new ();
-  gtk_window_set_title (GTK_WINDOW (dialog1), _("Subtitle Size and Position"));
-  gtk_window_set_type_hint (GTK_WINDOW (dialog1), GDK_WINDOW_TYPE_HINT_DIALOG);
-
-  dialog_vbox1 = GTK_DIALOG (dialog1)->vbox;
-  gtk_widget_show (dialog_vbox1);
-
-  vbox1 = gtk_vbox_new (FALSE, 0);
-  gtk_widget_show (vbox1);
-  gtk_box_pack_start (GTK_BOX (dialog_vbox1), vbox1, TRUE, TRUE, 0);
-
-  hbox1 = gtk_hbox_new (FALSE, 0);
-  gtk_widget_show (hbox1);
-  gtk_box_pack_start (GTK_BOX (vbox1), hbox1, FALSE, FALSE, 0);
-
-  label1 = gtk_label_new (_("Font Size:"));
-  gtk_widget_show (label1);
-  gtk_box_pack_start (GTK_BOX (hbox1), label1, FALSE, FALSE, 0);
-
-  spinbutton1_adj = gtk_adjustment_new (1, 6, 99, 1, 10, 10);
-  spinbutton1 = gtk_spin_button_new (GTK_ADJUSTMENT (spinbutton1_adj), 1, 2);
-  gtk_widget_show (spinbutton1);
-  gtk_box_pack_start (GTK_BOX (hbox1), spinbutton1, FALSE, FALSE, 0);
-  gtk_spin_button_set_numeric (GTK_SPIN_BUTTON (spinbutton1), TRUE);
-
-  hscale1 = gtk_hscale_new (GTK_ADJUSTMENT (gtk_adjustment_new (0, 0, 99, 1, 1, 1)));
-  gtk_widget_show (hscale1);
-  gtk_box_pack_start (GTK_BOX (vbox1), hscale1, FALSE, FALSE, 0);
-
-  hbox2 = gtk_hbox_new (FALSE, 0);
-  gtk_widget_show (hbox2);
-  gtk_box_pack_start (GTK_BOX (vbox1), hbox2, TRUE, TRUE, 0);
-
-  drawingarea1 = gtk_drawing_area_new ();
-  gtk_widget_show (drawingarea1);
-  gtk_box_pack_start (GTK_BOX (hbox2), drawingarea1, TRUE, TRUE, 0);
-
-  vscale1 = gtk_vscale_new (GTK_ADJUSTMENT (gtk_adjustment_new (0, 100, 1, 1, 1, 1)));
-  gtk_widget_show (vscale1);
-  gtk_box_pack_start (GTK_BOX (hbox2), vscale1, FALSE, FALSE, 0);
-  gtk_scale_set_digits (GTK_SCALE (vscale1), 0);
-
-  dialog_action_area1 = GTK_DIALOG (dialog1)->action_area;
-  gtk_widget_show (dialog_action_area1);
-  gtk_button_box_set_layout (GTK_BUTTON_BOX (dialog_action_area1), GTK_BUTTONBOX_END);
-
-  cancelbutton1 = gtk_button_new_from_stock ("gtk-cancel");
-  gtk_widget_show (cancelbutton1);
-  gtk_dialog_add_action_widget (GTK_DIALOG (dialog1), cancelbutton1, GTK_RESPONSE_CANCEL);
-  GTK_WIDGET_SET_FLAGS (cancelbutton1, GTK_CAN_DEFAULT);
-
-  okbutton1 = gtk_button_new_from_stock ("gtk-ok");
-  gtk_widget_show (okbutton1);
-  gtk_dialog_add_action_widget (GTK_DIALOG (dialog1), okbutton1, GTK_RESPONSE_OK);
-  GTK_WIDGET_SET_FLAGS (okbutton1, GTK_CAN_DEFAULT);
-
-  /* Store pointers to all widgets, for use by lookup_widget(). */
-  GLADE_HOOKUP_OBJECT_NO_REF (dialog1, dialog1, "dialog1");
-  GLADE_HOOKUP_OBJECT_NO_REF (dialog1, dialog_vbox1, "dialog_vbox1");
-  GLADE_HOOKUP_OBJECT (dialog1, vbox1, "vbox1");
-  GLADE_HOOKUP_OBJECT (dialog1, hbox1, "hbox1");
-  GLADE_HOOKUP_OBJECT (dialog1, label1, "label1");
-  GLADE_HOOKUP_OBJECT (dialog1, spinbutton1, "spinbutton1");
-  GLADE_HOOKUP_OBJECT (dialog1, hscale1, "hscale1");
-  GLADE_HOOKUP_OBJECT (dialog1, hbox2, "hbox2");
-  GLADE_HOOKUP_OBJECT (dialog1, drawingarea1, "drawingarea1");
-  GLADE_HOOKUP_OBJECT (dialog1, vscale1, "vscale1");
-  GLADE_HOOKUP_OBJECT_NO_REF (dialog1, dialog_action_area1, "dialog_action_area1");
-  GLADE_HOOKUP_OBJECT (dialog1, cancelbutton1, "cancelbutton1");
-  GLADE_HOOKUP_OBJECT (dialog1, okbutton1, "okbutton1");
-
-  return dialog1;
-}
-
-//-------------------------------
-#endif //FREETYPE
+#include <gtk/gtk.h>
+#include <time.h>
+#include <sys/time.h>
+#include <math.h>
+#include <iconv.h>
+
+
+#include "fourcc.h"
+#include "avio.hxx"
+
+#ifdef USE_FREETYPE
+
+#include "avi_vars.h"
+#include "ADM_toolkit/toolkit.hxx"
+#include "ADM_toolkit/filesel.h"
+
+
+
+#include "ADM_editor/ADM_edit.hxx"
+#include "ADM_video/ADM_genvideo.hxx"
+
+//#include "ADM_video/ADM_vidFont.h"
+class ADMfont;
+#include "ADM_video/ADM_vidSRT.h"
+
+#include "ADM_toolkit_gtk/ADM_gladeSupport.h"
+#include "ADM_toolkit_gtk/toolkit_gtk.h"
+#include "ADM_toolkit_gtk/toolkit_gtk_include.h"
+
+#include "ADM_colorspace/ADM_rgb.h"
+#include "ADM_colorspace/colorspace.h"
+
+#include "ADM_osSupport/ADM_debugID.h"
+#define MODULE_NAME MODULE_FILTER
+#include "ADM_osSupport/ADM_debug.h"
+
+#include <ADM_assert.h>
+#include "DIA_flyDialog.h"
+#include "DIA_flySrtPos.h"
+
+
+static void read( void );
+static void upload ( void );
+static gboolean slider_update( void );
+static gboolean gui_update( void);
+static gboolean gui_draw( void );
+static GtkWidget *create_dialog1 (void);
+
+static GtkWidget *dialog=NULL;
+static flySrtPos *myCrop=NULL;
+static int lock=0;
+
+/**
+      \fn DIA_srtPos
+      \brief Dialog that handles subtitle size and position
+*/
+int DIA_srtPos(AVDMGenericVideoStream *in,uint32_t *size,uint32_t *position)
+{
+  uint8_t ret=0;
+  
+        uint32_t width,height;
+
+        // Allocate space for green-ised video
+        width=in->getInfo()->width;
+        height=in->getInfo()->height;
+
+        dialog=create_dialog1();
+        gtk_register_dialog(dialog);
+        gtk_window_set_title (GTK_WINDOW (dialog), _("Subtitle Size and Position"));
+        gtk_widget_show(dialog);
+	
+        myCrop=new flySrtPos( width, height,in,WID(drawingarea1),WID(hscale1));
+        myCrop->param.fontSize=*size;
+        myCrop->param.position=*position;
+
+        gtk_range_set_range(GTK_RANGE(WID(vscale1)),0,height-1);
+
+        myCrop->upload();
+        myCrop->sliderChanged();
+        
+        gtk_signal_connect(GTK_OBJECT(WID(drawingarea1)), "expose_event",
+            GTK_SIGNAL_FUNC(gui_draw),
+            NULL);
+        
+        gtk_signal_connect (GTK_OBJECT(WID( spinbutton1)), "value_changed",
+                    GTK_SIGNAL_FUNC (gui_update),
+                    NULL);
+        
+         gtk_signal_connect (GTK_OBJECT(WID( hscale1)), "value_changed",
+                    GTK_SIGNAL_FUNC (slider_update),
+                    NULL);
+
+          gtk_signal_connect (GTK_OBJECT(WID( vscale1)), "value_changed",
+                    GTK_SIGNAL_FUNC (gui_update),
+                    NULL);
+       
+        ret=0;
+        int response;
+        response=gtk_dialog_run(GTK_DIALOG(dialog));
+
+        if(response==GTK_RESPONSE_OK)
+        {
+            myCrop->download();
+            *size=myCrop->param.fontSize;
+            *position=myCrop->param.position;
+            ret=1;
+        }
+        gtk_unregister_dialog(dialog);
+        gtk_widget_destroy(dialog);
+        delete myCrop;
+        return ret;
+}
+/**********************************/
+void read( void )
+{
+	myCrop->download();
+}
+gboolean slider_update( void )
+{
+        myCrop->sliderChanged();
+        return true;
+}
+gboolean gui_update( void)
+{
+  if(lock) return true;
+      myCrop->update();
+  return true;
+}
+gboolean gui_draw( void )
+{
+	myCrop->display();
+	return true;
+}
+
+/******************************/
+#define SPIN_GET(x,y) {y= gtk_spin_button_get_value_as_int(GTK_SPIN_BUTTON(lookup_widget(dialog,#x))) ;\
+				printf(#x":%d\n", y);}
+
+#define SPIN_SET(x,y)  {gtk_spin_button_set_value(GTK_SPIN_BUTTON(lookup_widget(dialog,#x)),(gfloat)y) ; printf(#x":%d\n", y);}
+
+
+uint8_t    flySrtPos::upload(void)
+{
+        SPIN_SET(spinbutton1,param.fontSize);
+        
+        int32_t max=_h;
+        max-=(SRT_MAX_LINE)*param.fontSize;
+        if(max<0) max=0;
+        if(param.position>=max)
+        {
+          param.position=max;
+        }
+        
+        GtkAdjustment *adj=gtk_range_get_adjustment (GTK_RANGE(WID(vscale1)));
+        GTK_ADJUSTMENT(adj)->value=param.position;
+        return 1;
+}
+uint8_t    flySrtPos::download(void)
+{
+        SPIN_GET(spinbutton1,param.fontSize);
+        GtkAdjustment *adj=gtk_range_get_adjustment (GTK_RANGE(WID(vscale1)));
+        param.position=(uint32_t)GTK_ADJUSTMENT(adj)->value;
+        
+        int32_t max=_h;
+        max-=(SRT_MAX_LINE)*param.fontSize;
+        if(max<0) max=0;
+        if(param.position>=max)
+        {
+          param.position=max;
+          upload(); 
+        }
+        
+        return 1;
+}
+
+/*
+	Almost straigh out of glade2
+
+*/
+
+GtkWidget*
+create_dialog1 (void)
+{
+  GtkWidget *dialog1;
+  GtkWidget *dialog_vbox1;
+  GtkWidget *vbox1;
+  GtkWidget *hbox1;
+  GtkWidget *label1;
+  GtkObject *spinbutton1_adj;
+  GtkWidget *spinbutton1;
+  GtkWidget *hscale1;
+  GtkWidget *hbox2;
+  GtkWidget *drawingarea1;
+  GtkWidget *vscale1;
+  GtkWidget *dialog_action_area1;
+  GtkWidget *cancelbutton1;
+  GtkWidget *okbutton1;
+
+  dialog1 = gtk_dialog_new ();
+  gtk_window_set_title (GTK_WINDOW (dialog1), _("Subtitle Size and Position"));
+  gtk_window_set_type_hint (GTK_WINDOW (dialog1), GDK_WINDOW_TYPE_HINT_DIALOG);
+
+  dialog_vbox1 = GTK_DIALOG (dialog1)->vbox;
+  gtk_widget_show (dialog_vbox1);
+
+  vbox1 = gtk_vbox_new (FALSE, 0);
+  gtk_widget_show (vbox1);
+  gtk_box_pack_start (GTK_BOX (dialog_vbox1), vbox1, TRUE, TRUE, 0);
+
+  hbox1 = gtk_hbox_new (FALSE, 0);
+  gtk_widget_show (hbox1);
+  gtk_box_pack_start (GTK_BOX (vbox1), hbox1, FALSE, FALSE, 0);
+
+  label1 = gtk_label_new (_("Font Size:"));
+  gtk_widget_show (label1);
+  gtk_box_pack_start (GTK_BOX (hbox1), label1, FALSE, FALSE, 0);
+
+  spinbutton1_adj = gtk_adjustment_new (1, 6, 99, 1, 10, 10);
+  spinbutton1 = gtk_spin_button_new (GTK_ADJUSTMENT (spinbutton1_adj), 1, 2);
+  gtk_widget_show (spinbutton1);
+  gtk_box_pack_start (GTK_BOX (hbox1), spinbutton1, FALSE, FALSE, 0);
+  gtk_spin_button_set_numeric (GTK_SPIN_BUTTON (spinbutton1), TRUE);
+
+  hscale1 = gtk_hscale_new (GTK_ADJUSTMENT (gtk_adjustment_new (0, 0, 99, 1, 1, 1)));
+  gtk_widget_show (hscale1);
+  gtk_box_pack_start (GTK_BOX (vbox1), hscale1, FALSE, FALSE, 0);
+
+  hbox2 = gtk_hbox_new (FALSE, 0);
+  gtk_widget_show (hbox2);
+  gtk_box_pack_start (GTK_BOX (vbox1), hbox2, TRUE, TRUE, 0);
+
+  drawingarea1 = gtk_drawing_area_new ();
+  gtk_widget_show (drawingarea1);
+  gtk_box_pack_start (GTK_BOX (hbox2), drawingarea1, TRUE, TRUE, 0);
+
+  vscale1 = gtk_vscale_new (GTK_ADJUSTMENT (gtk_adjustment_new (0, 100, 1, 1, 1, 1)));
+  gtk_widget_show (vscale1);
+  gtk_box_pack_start (GTK_BOX (hbox2), vscale1, FALSE, FALSE, 0);
+  gtk_scale_set_digits (GTK_SCALE (vscale1), 0);
+
+  dialog_action_area1 = GTK_DIALOG (dialog1)->action_area;
+  gtk_widget_show (dialog_action_area1);
+  gtk_button_box_set_layout (GTK_BUTTON_BOX (dialog_action_area1), GTK_BUTTONBOX_END);
+
+  cancelbutton1 = gtk_button_new_from_stock ("gtk-cancel");
+  gtk_widget_show (cancelbutton1);
+  gtk_dialog_add_action_widget (GTK_DIALOG (dialog1), cancelbutton1, GTK_RESPONSE_CANCEL);
+  GTK_WIDGET_SET_FLAGS (cancelbutton1, GTK_CAN_DEFAULT);
+
+  okbutton1 = gtk_button_new_from_stock ("gtk-ok");
+  gtk_widget_show (okbutton1);
+  gtk_dialog_add_action_widget (GTK_DIALOG (dialog1), okbutton1, GTK_RESPONSE_OK);
+  GTK_WIDGET_SET_FLAGS (okbutton1, GTK_CAN_DEFAULT);
+
+  /* Store pointers to all widgets, for use by lookup_widget(). */
+  GLADE_HOOKUP_OBJECT_NO_REF (dialog1, dialog1, "dialog1");
+  GLADE_HOOKUP_OBJECT_NO_REF (dialog1, dialog_vbox1, "dialog_vbox1");
+  GLADE_HOOKUP_OBJECT (dialog1, vbox1, "vbox1");
+  GLADE_HOOKUP_OBJECT (dialog1, hbox1, "hbox1");
+  GLADE_HOOKUP_OBJECT (dialog1, label1, "label1");
+  GLADE_HOOKUP_OBJECT (dialog1, spinbutton1, "spinbutton1");
+  GLADE_HOOKUP_OBJECT (dialog1, hscale1, "hscale1");
+  GLADE_HOOKUP_OBJECT (dialog1, hbox2, "hbox2");
+  GLADE_HOOKUP_OBJECT (dialog1, drawingarea1, "drawingarea1");
+  GLADE_HOOKUP_OBJECT (dialog1, vscale1, "vscale1");
+  GLADE_HOOKUP_OBJECT_NO_REF (dialog1, dialog_action_area1, "dialog_action_area1");
+  GLADE_HOOKUP_OBJECT (dialog1, cancelbutton1, "cancelbutton1");
+  GLADE_HOOKUP_OBJECT (dialog1, okbutton1, "okbutton1");
+
+  return dialog1;
+}
+
+//-------------------------------
+#endif //FREETYPE

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_gtkRender.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_gtkRender.cpp	2007-07-25 18:17:34 UTC (rev 3445)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_gtkRender.cpp	2007-07-26 13:33:46 UTC (rev 3446)
@@ -18,21 +18,17 @@
 
 #include <stdio.h>         
 #include <stdlib.h>
-#include <math.h>
 #include <unistd.h>
 
 #include <gtk/gtk.h>
 #ifdef ADM_WIN32
+#define WIN32_CLASH
 #include <gdk/gdkwin32.h>
 #else
 #include <gdk/gdkx.h>
 #endif
 
-#include <time.h>
-#include <sys/time.h>
-
-#include <../ADM_assert.h>
-#define WIN32_CLASH
+#include "../ADM_assert.h"
 #include "default.h"
 #include "../ADM_osSupport/ADM_misc.h"
 
@@ -41,10 +37,8 @@
 
 #include "ADM_toolkit_gtk/toolkit_gtk.h"
 
-#include "../prefs.h"
 #include "../../../ADM_colorspace/ADM_rgb.h"
 #include "../../../ADM_libraries/ADM_libswscale/ADM_mp.h"
-#include "../gtkgui.h"
 
 void GUI_gtk_grow_off(int onff);
 
@@ -148,4 +142,24 @@
 	else
 		return 1;
 }
+
+// GTK doesn't centre the window correctly.  Use this function to centre windows with a canvas that is yet to resized.
+void UI_centreCanvasWindow(GtkWindow *window, GtkWidget *canvas, int newCanvasWidth, int newCanvasHeight)
+{
+	int winWidth, winHeight, widgetWidth, widgetHeight;
+	uint32_t resWidth, resHeight;
+
+	UI_getPhysicalScreenSize(&resWidth, &resHeight);
+	gtk_widget_get_size_request((GtkWidget*)canvas, &widgetWidth, &widgetHeight);
+	gtk_window_get_size(window, &winWidth, &winHeight);
+
+	winWidth = newCanvasWidth;
+	winHeight = (winHeight - widgetHeight) + newCanvasHeight;
+
+	// Take borders and captions into consideration (GTK doesn't seem to support this so we'll have to guess)
+	winWidth += 10;
+	winHeight += 40;
+
+	gtk_window_move(window, ((int)resWidth - winWidth) / 2, ((int)resHeight - winHeight) / 2);
+}
 // EOF

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/T_flyDialog.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/T_flyDialog.cpp	2007-07-25 18:17:34 UTC (rev 3445)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/T_flyDialog.cpp	2007-07-26 13:33:46 UTC (rev 3446)
@@ -33,8 +33,8 @@
 #include "DIA_flyDialogQt4.h"
 #include "ADM_assert.h"
 
-void ADM_flyDialog::postInit(uint32_t width, uint32_t height, AVDMGenericVideoStream *in,
-							 void *canvas, void *slider, int yuv) {}
+void ADM_flyDialog::postInit() {}
+float ADM_flyDialog::calcZoomFactor(void) {return 1;}
 
 uint8_t  ADM_flyDialog::display(void)
 {

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_flyAsharp.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_flyAsharp.cpp	2007-07-25 18:17:34 UTC (rev 3445)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_flyAsharp.cpp	2007-07-26 13:33:46 UTC (rev 3446)
@@ -42,7 +42,7 @@
 {
     download();
     process();
-    _rgb->scale(_yuvBufferOut->data,_rgbBufferOut);
+	copyYuvFinalToRgb();
     display();
     return 1;
 }
@@ -50,7 +50,7 @@
 {
 uint8_t *src,*dst;
 uint32_t stride;
-int32_t T,D,B,B2;   
+int32_t T,D,B,B2;
 uint32_t ww,hh;
 
 

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_flyAsharp.h
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_flyAsharp.h	2007-07-25 18:17:34 UTC (rev 3445)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_flyAsharp.h	2007-07-26 13:33:46 UTC (rev 3446)
@@ -13,9 +13,6 @@
    uint8_t    upload(void);
    uint8_t    update(void);
    flyASharp (uint32_t width,uint32_t height,AVDMGenericVideoStream *in,
-                                    void *canvas, void *slider) : ADM_flyDialog(width, height,in,canvas, slider,1) 
-                    {
-                      
-                    };
+                                    void *canvas, void *slider) : ADM_flyDialog(width, height,in,canvas, slider,1,RESIZE_AUTO) {};
 };
 #endif

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_flyChromaShift.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_flyChromaShift.cpp	2007-07-25 18:17:34 UTC (rev 3445)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_flyChromaShift.cpp	2007-07-26 13:33:46 UTC (rev 3446)
@@ -49,7 +49,7 @@
 {
    download();
     process();
-    _rgb->scale(_yuvBufferOut->data,_rgbBufferOut);
+	copyYuvFinalToRgb();
     display();
 }
 //EOF

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_flyChromaShift.h
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_flyChromaShift.h	2007-07-25 18:17:34 UTC (rev 3445)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_flyChromaShift.h	2007-07-26 13:33:46 UTC (rev 3446)
@@ -11,10 +11,7 @@
    uint8_t    upload(void);
    uint8_t    update(void);
    flyChromaShift (uint32_t width,uint32_t height,AVDMGenericVideoStream *in,
-                                    void *canvas, void *slider) : ADM_flyDialog(width, height,in,canvas, slider,1) 
-                    {
-                      
-                    };
+                                    void *canvas, void *slider) : ADM_flyDialog(width, height,in,canvas, slider,1,RESIZE_AUTO) {};
 };
 
 #endif

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_flyContrast.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_flyContrast.cpp	2007-07-25 18:17:34 UTC (rev 3445)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_flyContrast.cpp	2007-07-26 13:33:46 UTC (rev 3446)
@@ -31,7 +31,7 @@
 {
     download();
     process();
-    _rgb->scale(_yuvBufferOut->data,_rgbBufferOut);
+	copyYuvFinalToRgb();
     display();
     return 1;
 }

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_flyContrast.h
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_flyContrast.h	2007-07-25 18:17:34 UTC (rev 3445)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_flyContrast.h	2007-07-26 13:33:46 UTC (rev 3446)
@@ -13,7 +13,7 @@
    uint8_t    upload(void);
    uint8_t    update(void);
    flyContrast (uint32_t width,uint32_t height,AVDMGenericVideoStream *in,
-                                    void *canvas, void *slider) : ADM_flyDialog(width, height,in,canvas, slider,1) 
+                                    void *canvas, void *slider) : ADM_flyDialog(width, height,in,canvas, slider,1,RESIZE_AUTO)
                     {
                       
                     };

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_flyCrop.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_flyCrop.cpp	2007-07-25 18:17:34 UTC (rev 3445)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_flyCrop.cpp	2007-07-26 13:33:46 UTC (rev 3446)
@@ -98,6 +98,8 @@
                 in+=4*w;
   
         }
+
+		copyRgbFinalToDisplay();
 }
 
 /*----------------------------------

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_flyCrop.h
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_flyCrop.h	2007-07-25 18:17:34 UTC (rev 3445)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_flyCrop.h	2007-07-26 13:33:46 UTC (rev 3446)
@@ -1,5 +1,3 @@
-
-
 #ifndef FLY_CROP_H
 #define FLY_CROP_H
 class flyCrop : public ADM_flyDialog
@@ -13,6 +11,6 @@
    uint8_t    upload(void);
    uint8_t    autocrop(void);
    flyCrop (uint32_t width,uint32_t height,AVDMGenericVideoStream *in,
-                                    void *canvas, void *slider) : ADM_flyDialog(width, height,in,canvas, slider,0) {};
+                                    void *canvas, void *slider) : ADM_flyDialog(width, height,in,canvas, slider,0,RESIZE_LAST) {};
 };
 #endif

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_flyDialog.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_flyDialog.cpp	2007-07-25 18:17:34 UTC (rev 3445)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_flyDialog.cpp	2007-07-26 13:33:46 UTC (rev 3446)
@@ -16,70 +16,95 @@
 
 #include <stdio.h>
 #include <stdlib.h>
-#include <math.h>
-#include <string.h>
-#include <time.h>
-#include <sys/time.h>
 
 #include "default.h"
 
-#include "ADM_colorspace/colorspace.h"
 #include "ADM_colorspace/ADM_rgb.h"
 #include "ADM_commonUI/GUI_render.h"
 #include "ADM_video/ADM_genvideo.hxx"
 #include "DIA_flyDialog.h"
-
 #include "ADM_assert.h"
 
 extern "C" {
 #include "ADM_libraries/ADM_lavcodec/avcodec.h"
 }
 
-/**
-    \fn ADM_flyDialog
-*/
- ADM_flyDialog::ADM_flyDialog(uint32_t width,uint32_t height,AVDMGenericVideoStream *in,
-                                void *canvas, void *slider,int yuv)
+ADM_flyDialog::ADM_flyDialog(uint32_t width,uint32_t height,AVDMGenericVideoStream *in,
+                                void *canvas, void *slider,int yuv, ResizeMethod resizeMethod)
 {
 	ADM_assert(canvas);
 
 	if (slider)
 		ADM_assert(in);
 
-  _w=_zoomW=width;
-  _h=_zoomH=height;
-  _isYuvProcessing=yuv;
-  _in=in;
+	_w = width;
+	_h = height;
+	_isYuvProcessing = yuv;
+	_in = in;
+	_slider = slider;
+	_canvas = canvas;
+	_cookie = NULL;
+	_resizeMethod = resizeMethod;
 
-    if(isRgbInverted())
-        _rgb=new ColYuvRgb(_w,_h,1);
-    else
-    _rgb=new ColYuvRgb(_w,_h);
+	if (isRgbInverted())
+		_rgb=new ColYuvRgb(_w,_h,1);
+	else
+		_rgb=new ColYuvRgb(_w,_h);
 
-  _rgb->reset(_w,_h);
+	_rgb->reset(_w,_h);
 
-  _yuvBuffer=new ADMImage(_w,_h);
+	_yuvBuffer=new ADMImage(_w,_h);
 
-  if(_isYuvProcessing)
-  {
-     _yuvBufferOut=new ADMImage(_w,_h);
-     _rgbBuffer=NULL;
-  }
-  else
-  {
-    _rgbBuffer =new uint8_t [_w*_h*4];
-    _yuvBufferOut=NULL;
-  }
-    _rgbBufferOut =new uint8_t [_w*_h*4];
+	if(_isYuvProcessing)
+	{
+		_yuvBufferOut=new ADMImage(_w,_h);
+		_rgbBuffer=NULL;
+	}
+	else
+	{
+		_rgbBuffer =new uint8_t [_w*_h*4];
+		_yuvBufferOut=NULL;
+	}
 
-  _slider=slider;
-  _canvas=canvas;
-  _cookie=NULL;
-  _rgbBufferDisplay=NULL;
-  _resizer=NULL;
+	_rgbBufferOut =new uint8_t [_w*_h*4];
 
-  postInit(width, height, in, canvas, slider, yuv);
+	if (_resizeMethod == RESIZE_AUTO || _resizeMethod == RESIZE_LAST)
+	{
+		float zoom = calcZoomFactor();
+
+		if (zoom == 1)
+			_resizeMethod = RESIZE_NONE;
+		else
+		{
+			_zoomW = _w * zoom;
+			_zoomH = _h * zoom;
+		}
+	}
+
+	if (_resizeMethod == RESIZE_AUTO || _resizeMethod == RESIZE_LAST)
+	{
+		PixelFormat sourceColour;
+
+		if (_resizeMethod == RESIZE_AUTO || _isYuvProcessing)
+			sourceColour = PIX_FMT_YUV420P;
+		else
+			sourceColour = PIX_FMT_RGB32;
+
+		_resizer = new ADMImageResizer(_w, _h, _zoomW, _zoomH, sourceColour, PIX_FMT_RGB32);
+		_rgbBufferDisplay = new uint8_t[_w * _h * 4];
+	}
+	else
+	{
+		_zoomW = _w;
+		_zoomH = _h;
+
+		_resizer = NULL;
+		_rgbBufferDisplay = NULL;
+	}
+
+	postInit();
 }
+
 /**
     \fn cleanup
     \brief deallocate
@@ -124,40 +149,49 @@
       printf("[FlyDialog] Cannot get frame %u\n",fn); 
       return 0;
     }
-    /* Process...*/
-    
+
+    // Process...    
     if(_isYuvProcessing)
     {
         process();
-        _rgb->scale(_yuvBufferOut->data,_rgbBufferOut);
-        
-    } else // RGB Processing
-      
+		copyYuvFinalToRgb();
+    }
+	else // RGB Processing      
     {
         ADM_assert(_rgbBuffer);
-        _rgb->scale(_yuvBuffer->data,_rgbBuffer);
+		copyYuvScratchToRgb();
         process();
     }
+
     display();
 }
 
-void ADM_flyDialog::resizeImage(uint32_t width, uint32_t height)
+void ADM_flyDialog::copyYuvFinalToRgb(void)
 {
-	_zoomW = width;
-	_zoomH = height;
+	if (_resizeMethod == RESIZE_AUTO || _resizeMethod == RESIZE_LAST)
+		_resizer->resize(_yuvBufferOut->data, _rgbBufferOut);
+	else
+		_rgb->scale(_yuvBufferOut->data, _rgbBufferOut);
+}
 
-	if (_resizer)
+void ADM_flyDialog::copyYuvScratchToRgb(void)
+{
+	if (_resizeMethod == RESIZE_AUTO)
+		_resizer->resize(_yuvBuffer->data,_rgbBuffer);
+	else
+		_rgb->scale(_yuvBuffer->data,_rgbBuffer);
+}
+
+void ADM_flyDialog::copyRgbFinalToDisplay(void)
+{
+	if (_resizeMethod == RESIZE_LAST)
 	{
-		delete _resizer;
-		delete[] _rgbBufferDisplay;
-	}
+		_resizer->resize(_rgbBufferOut, _rgbBufferDisplay);
 
-	if (width == _w && height == _h)
-		_resizer = NULL;
-	else
-	{
-		_resizer = new ADMImageResizer(_w, _h, _zoomW, _zoomH, PIX_FMT_RGB32, PIX_FMT_RGB32);
-		_rgbBufferDisplay = new uint8_t[_zoomW * _zoomH * 4];
+		uint8_t* tempRgb = _rgbBufferDisplay;
+
+		_rgbBufferDisplay = _rgbBufferOut;
+		_rgbBufferOut = tempRgb;
 	}
 }
 

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_flyDialog.h
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_flyDialog.h	2007-07-25 18:17:34 UTC (rev 3445)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_flyDialog.h	2007-07-26 13:33:46 UTC (rev 3446)
@@ -24,6 +24,12 @@
  ***************************************************************************/
 #ifndef ADM_FLY_DIALOG_H
 #define ADM_FLY_DIALOG_H
+enum ResizeMethod {
+    RESIZE_NONE = 0,	// No automatic resize
+	RESIZE_AUTO = 1,	// Resize image when convenient (YUV: after filter, RGB: before applying filter)
+	RESIZE_LAST = 2		// Resize image after filter has been applied (slower for RGB)
+};
+
 class ADM_flyDialog
 {
   protected:
@@ -36,11 +42,15 @@
           uint8_t  *_rgbBufferOut;
 		  uint8_t  *_rgbBufferDisplay;
           uint8_t  _isYuvProcessing;
-
+		  ResizeMethod _resizeMethod;
 		  ADMImageResizer *_resizer;
 
-  virtual void postInit(uint32_t width,uint32_t height,AVDMGenericVideoStream *in,
-                                    void *canvas, void *slider,int yuv);
+  virtual void postInit(void);
+		  float calcZoomFactor(void);
+          void copyYuvFinalToRgb(void);
+          void copyYuvScratchToRgb(void);
+		  void copyRgbFinalToDisplay(void);
+
   public:
           void    *_cookie; // whatever
           void    *_slider; // widget
@@ -61,11 +71,10 @@
           uint8_t  isRgbInverted(void);
   virtual uint8_t  update(void) {};
           uint8_t  cleanup(void);
-		  void resizeImage(uint32_t width, uint32_t height);
-         /*                               */
-                  ADM_flyDialog(uint32_t width,uint32_t height,AVDMGenericVideoStream *in,
-                                    void *canvas, void *slider,int yuv);
-    virtual      ~ADM_flyDialog(void);
+
+          ADM_flyDialog(uint32_t width, uint32_t height, AVDMGenericVideoStream *in,
+                             void *canvas, void *slider, int yuv, ResizeMethod resizeMethod);
+  virtual ~ADM_flyDialog(void);
 };
 
 #endif

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_flyHue.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_flyHue.cpp	2007-07-25 18:17:34 UTC (rev 3445)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_flyHue.cpp	2007-07-26 13:33:46 UTC (rev 3446)
@@ -46,7 +46,7 @@
 {
     download();
     process();
-    _rgb->scale(_yuvBufferOut->data,_rgbBufferOut);
+	copyYuvFinalToRgb();
     display();
     return 1;
 }        

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_flyHue.h
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_flyHue.h	2007-07-25 18:17:34 UTC (rev 3445)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_flyHue.h	2007-07-26 13:33:46 UTC (rev 3446)
@@ -11,9 +11,6 @@
    uint8_t    upload(void);
    uint8_t    update(void);
    flyHue (uint32_t width,uint32_t height,AVDMGenericVideoStream *in,
-                                    void *canvas, void *slider) : ADM_flyDialog(width, height,in,canvas, slider,1) 
-                    {
-                      
-                    };
+                                    void *canvas, void *slider) : ADM_flyDialog(width, height,in,canvas, slider,1,RESIZE_AUTO) {};
 };
 #endif

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_flyPreview.h
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_flyPreview.h	2007-07-25 18:17:34 UTC (rev 3445)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_flyPreview.h	2007-07-26 13:33:46 UTC (rev 3446)
@@ -7,10 +7,10 @@
 	uint8_t download(void) {return 1;}
 	uint8_t upload(void) {return 1;}
 	uint8_t cleanup(void) {return 1;}
-	uint8_t setData(uint8_t *buffer) {_rgb->scale(buffer, _rgbBufferOut);}
+	uint8_t setData(uint8_t *buffer) {_rgb->scale(buffer, _rgbBufferOut); return 1;}
 
 	flyPreview(uint32_t width, uint32_t height, void *canvas) : 
-		ADM_flyDialog(width, height, NULL, canvas, NULL, 0) {delete _rgbBuffer; _rgbBuffer = NULL;};
+		ADM_flyDialog(width, height, NULL, canvas, NULL, 0, RESIZE_NONE) {delete _rgbBuffer; _rgbBuffer = NULL;};
 	virtual ~flyPreview(void) {_rgbBuffer = NULL;};
 };
 
@@ -23,7 +23,7 @@
 	uint8_t cleanup(void) {return 1;}
 
 	flySeekablePreview(uint32_t width, uint32_t height, AVDMGenericVideoStream *videoStream, void *canvas, void *slider) : 
-		ADM_flyDialog(width, height, videoStream, canvas, slider, 0) {delete _rgbBufferOut; _rgbBufferOut = NULL;};
+		ADM_flyDialog(width, height, videoStream, canvas, slider, 0, RESIZE_AUTO) {delete _rgbBufferOut; _rgbBufferOut = NULL;};
 	virtual ~flySeekablePreview(void) {_rgbBufferOut = NULL;};
 };
 #endif

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_flySrtPos.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_flySrtPos.cpp	2007-07-25 18:17:34 UTC (rev 3445)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_flySrtPos.cpp	2007-07-26 13:33:46 UTC (rev 3446)
@@ -59,7 +59,7 @@
 {
     download();
     process();
-    _rgb->scale(_yuvBufferOut->data,_rgbBufferOut);
+	copyYuvFinalToRgb();
     display();
 }
 #endif

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_flySrtPos.h
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_flySrtPos.h	2007-07-25 18:17:34 UTC (rev 3445)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_flySrtPos.h	2007-07-26 13:33:46 UTC (rev 3446)
@@ -19,10 +19,7 @@
    uint8_t    upload(void);
    uint8_t    update(void);
    flySrtPos (uint32_t width,uint32_t height,AVDMGenericVideoStream *in,
-                                    void *canvas, void *slider) : ADM_flyDialog(width, height,in,canvas, slider,1) 
-                    {
-                      
-                    };
+                                    void *canvas, void *slider) : ADM_flyDialog(width, height,in,canvas, slider,1,RESIZE_AUTO) {};
 };
 
 #endif



From gruntster at mail.berlios.de  Thu Jul 26 17:11:12 2007
From: gruntster at mail.berlios.de (gruntster at mail.berlios.de)
Date: Thu, 26 Jul 2007 17:11:12 +0200
Subject: [Avidemux-svn-commit] r3447 -
	branches/avidemux_2.4_branch/avidemux/ADM_inputs/ADM_asf
Message-ID: <200707261511.l6QFBCHt023125@sheep.berlios.de>

Author: gruntster
Date: 2007-07-26 17:11:01 +0200 (Thu, 26 Jul 2007)
New Revision: 3447

Modified:
   branches/avidemux_2.4_branch/avidemux/ADM_inputs/ADM_asf/ADM_asf_audio.cpp
Log:
fix mem leak (asf audio)

Modified: branches/avidemux_2.4_branch/avidemux/ADM_inputs/ADM_asf/ADM_asf_audio.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_inputs/ADM_asf/ADM_asf_audio.cpp	2007-07-26 13:33:46 UTC (rev 3446)
+++ branches/avidemux_2.4_branch/avidemux/ADM_inputs/ADM_asf/ADM_asf_audio.cpp	2007-07-26 15:11:01 UTC (rev 3447)
@@ -173,6 +173,7 @@
       *len=bit->len;
 #warning FIXME      
       *samples=384; // ?
+	  delete[] bit->data;
       delete bit;
       return 1;
     }



From gruntster at mail.berlios.de  Thu Jul 26 19:40:48 2007
From: gruntster at mail.berlios.de (gruntster at mail.berlios.de)
Date: Thu, 26 Jul 2007 19:40:48 +0200
Subject: [Avidemux-svn-commit] r3448 -
	branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog
Message-ID: <200707261740.l6QHemOB013740@sheep.berlios.de>

Author: gruntster
Date: 2007-07-26 19:40:36 +0200 (Thu, 26 Jul 2007)
New Revision: 3448

Modified:
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_asharp.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_chromashift.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_contrast.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_crop.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_hue.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_srt.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/T_flyDialog.cpp
Log:
[Preview] expand filter preview windows to fit video (Qt4)

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_asharp.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_asharp.cpp	2007-07-26 15:11:01 UTC (rev 3447)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_asharp.cpp	2007-07-26 17:40:36 UTC (rev 3448)
@@ -73,7 +73,7 @@
         // Allocate space for green-ised video
         width=in->getInfo()->width;
         height=in->getInfo()->height;
-        ui.graphicsView->resize(width,height);
+
         canvas=new ADM_QCanvas(ui.graphicsView,width,height);
         
         myCrop=new flyASharp( width, height,in,canvas,ui.horizontalSlider);

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_chromashift.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_chromashift.cpp	2007-07-26 15:11:01 UTC (rev 3447)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_chromashift.cpp	2007-07-26 17:40:36 UTC (rev 3448)
@@ -77,7 +77,6 @@
         ui.spinBoxV->setMaximum(boundary/2);
         ui.spinBoxV->setMinimum(-boundary);
         
-        ui.graphicsView->resize(width,height);
         canvas=new ADM_QCanvas(ui.graphicsView,width,height);
         
         myCrop=new flyChromaShift( width, height,in,canvas,ui.horizontalSlider);

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_contrast.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_contrast.cpp	2007-07-26 15:11:01 UTC (rev 3447)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_contrast.cpp	2007-07-26 17:40:36 UTC (rev 3448)
@@ -73,7 +73,7 @@
         // Allocate space for green-ised video
         width=in->getInfo()->width;
         height=in->getInfo()->height;
-        ui.graphicsView->resize(width,height);
+
         canvas=new ADM_QCanvas(ui.graphicsView,width,height);
         
         myCrop=new flyContrast( width, height,in,canvas,ui.horizontalSlider);

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_crop.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_crop.cpp	2007-07-26 15:11:01 UTC (rev 3447)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_crop.cpp	2007-07-26 17:40:36 UTC (rev 3448)
@@ -74,7 +74,7 @@
         // Allocate space for green-ised video
         width=in->getInfo()->width;
         height=in->getInfo()->height;
-        ui.graphicsView->resize(width,height);
+
         canvas=new ADM_QCanvas(ui.graphicsView,width,height);
         
         myCrop=new flyCrop( width, height,in,canvas,ui.horizontalSlider);

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_hue.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_hue.cpp	2007-07-26 15:11:01 UTC (rev 3447)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_hue.cpp	2007-07-26 17:40:36 UTC (rev 3448)
@@ -73,7 +73,7 @@
         // Allocate space for green-ised video
         width=in->getInfo()->width;
         height=in->getInfo()->height;
-        ui.graphicsView->resize(width,height);
+
         canvas=new ADM_QCanvas(ui.graphicsView,width,height);
         
         myCrop=new flyHue( width, height,in,canvas,ui.horizontalSlider);

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_srt.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_srt.cpp	2007-07-26 15:11:01 UTC (rev 3447)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_srt.cpp	2007-07-26 17:40:36 UTC (rev 3448)
@@ -73,7 +73,7 @@
         // Allocate space for green-ised video
         width=in->getInfo()->width;
         height=in->getInfo()->height;
-        ui.graphicsView->resize(width,height);
+
         canvas=new ADM_QCanvas(ui.graphicsView,width,height);
         
         myCrop=new flySrtPos( width, height,in,canvas,ui.horizontalSlider);

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/T_flyDialog.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/T_flyDialog.cpp	2007-07-26 15:11:01 UTC (rev 3447)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/T_flyDialog.cpp	2007-07-26 17:40:36 UTC (rev 3448)
@@ -14,26 +14,23 @@
 
 #include "config.h"
 
-#include <string.h>
-#include <stdio.h>
-#include <stdlib.h>
-
-
-
 #include <QtGui/QGraphicsView>
 #include <QtGui/QSlider>
 
 #include "default.h"
-#include "ADM_toolkit/toolkit.hxx"
-#include "ADM_colorspace/ADM_rgb.h"
-
-#include "ADM_image.h"
+#include "ADM_assert.h"
 #include "ADM_video/ADM_genvideo.hxx"
 #include "DIA_flyDialog.h"
 #include "DIA_flyDialogQt4.h"
-#include "ADM_assert.h"
 
-void ADM_flyDialog::postInit() {}
+void ADM_flyDialog::postInit()
+{
+	QWidget *graphicsView = ((ADM_QCanvas*)_canvas)->parentWidget();
+
+	graphicsView->setMinimumSize(_w, _h);
+	graphicsView->resize(_w, _h);
+}
+
 float ADM_flyDialog::calcZoomFactor(void) {return 1;}
 
 uint8_t  ADM_flyDialog::display(void)



From mean at mail.berlios.de  Thu Jul 26 20:09:45 2007
From: mean at mail.berlios.de (mean at BerliOS)
Date: Thu, 26 Jul 2007 20:09:45 +0200
Subject: [Avidemux-svn-commit] r3449 - in
	branches/avidemux_2.4_branch/avidemux: ADM_ocr
	ADM_userInterfaces/ADM_GTK/ADM_ocr
Message-ID: <200707261809.l6QI9jJB015249@sheep.berlios.de>

Author: mean
Date: 2007-07-26 20:09:45 +0200 (Thu, 26 Jul 2007)
New Revision: 3449

Added:
   branches/avidemux_2.4_branch/avidemux/ADM_ocr/ADM_bitmapSource.cpp
Modified:
   branches/avidemux_2.4_branch/avidemux/ADM_ocr/ADM_ocrInternal.h
   branches/avidemux_2.4_branch/avidemux/ADM_ocr/CMakeLists.txt
   branches/avidemux_2.4_branch/avidemux/ADM_ocr/Makefile.am
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_ocr/adm_ocr.cpp
Log:
[OCR] Prepare for TS subs

Copied: branches/avidemux_2.4_branch/avidemux/ADM_ocr/ADM_bitmapSource.cpp (from rev 3447, branches/avidemux_2.4_branch/avidemux/ADM_ocr/ADM_ocr.cpp)
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_ocr/ADM_ocr.cpp	2007-07-26 15:11:01 UTC (rev 3447)
+++ branches/avidemux_2.4_branch/avidemux/ADM_ocr/ADM_bitmapSource.cpp	2007-07-26 18:09:45 UTC (rev 3449)
@@ -0,0 +1,140 @@
+/***************************************************************************
+      Front end for bitmap sources (vobsub, ts, sup,...)
+      (C) 2007 Mean
+ ***************************************************************************/
+/***************************************************************************
+ *                                                                         *
+ *   This program is free software; you can redistribute it and/or modify  *
+ *   it under the terms of the GNU General Public License as published by  *
+ *   the Free Software Foundation; either version 2 of the License, or     *
+ *   (at your option) any later version.                                   *
+ *                                                                         *
+ ***************************************************************************/
+ #include "config.h"
+ #include <stdio.h>
+ #include <stdlib.h>
+ #include <string.h>
+ #include "ADM_assert.h"
+ #include "default.h"
+
+ #include "ADM_editor/ADM_edit.hxx"
+ #include "ADM_video/ADM_genvideo.hxx"
+
+ #include "ADM_ocr.h"
+#include "ADM_ocrInternal.h"
+ #include "ADM_toolkit/toolkit.hxx"
+ #include "ADM_userInterfaces/ADM_commonUI/DIA_enter.h"
+
+/*  *****************************
+ * 	**** Case 1 : Vobsub ********
+ *  *****************************
+ */
+
+class ADM_BitmapSource_VobSub : public ADM_BitmapSource
+{
+protected:
+			ADMVideoVobSub *_vobsub;
+			uint32_t		_nbPics;
+public: 
+								ADM_BitmapSource_VobSub(void);
+			virtual uint8_t     init(ADM_OCR_SOURCE *source);
+			virtual 			~ADM_BitmapSource_VobSub();
+			virtual uint32_t 	getNbImages(void);
+			virtual vobSubBitmap *getBitmap(uint32_t nb,uint32_t *start, uint32_t *end,uint32_t *first,uint32_t *last);
+};
+
+ADM_BitmapSource_VobSub::ADM_BitmapSource_VobSub(void)
+{
+	_vobsub=NULL;
+	_nbPics=0;
+}
+ADM_BitmapSource_VobSub::~ADM_BitmapSource_VobSub()
+{
+	if(_vobsub) delete _vobsub;
+	_vobsub=NULL;
+}
+uint8_t     ADM_BitmapSource_VobSub::init(ADM_OCR_SOURCE *source)
+{
+	_vobsub=new ADMVideoVobSub(source->subparam->subname,source->subparam->index);
+	if(!_vobsub)
+	{
+		printf("[BitmapSource_VS] Cannot open source\n");
+		return 0;
+	}
+	_nbPics=_vobsub->getNbImage();
+	return 1;
+}
+uint32_t 	ADM_BitmapSource_VobSub::getNbImages(void)
+{
+	return _nbPics;
+}
+/**
+ * 		\fn getBitmap
+ * 		\brief returns a bitmap in black & white (luma+alpha)
+ * */
+vobSubBitmap *ADM_BitmapSource_VobSub::getBitmap(uint32_t nb,uint32_t *start, uint32_t *end,uint32_t *first,uint32_t *last)
+{
+	return _vobsub->getBitmap(nb,start, end,first,last);
+}
+/*  *****************************
+ * 	**** Case 2 : TsSub  ********
+ *  *****************************
+ */
+
+class ADM_BitmapSource_TsSub : public ADM_BitmapSource
+{
+protected:
+			uint32_t		_nbPics;
+public: 
+								ADM_BitmapSource_TsSub(void);
+			virtual uint8_t     init(ADM_OCR_SOURCE *source);
+			virtual 			~ADM_BitmapSource_TsSub();
+			virtual uint32_t 	getNbImages(void);
+			virtual vobSubBitmap *getBitmap(uint32_t nb,uint32_t *start, uint32_t *end,uint32_t *first,uint32_t *last);
+};
+
+ADM_BitmapSource_TsSub::ADM_BitmapSource_TsSub(void)
+{
+	_nbPics=0x7FFFF;
+}
+ADM_BitmapSource_TsSub::~ADM_BitmapSource_TsSub()
+{
+
+}
+uint8_t     ADM_BitmapSource_TsSub::init(ADM_OCR_SOURCE *source)
+{
+	
+		return 0;
+}
+uint32_t 	ADM_BitmapSource_TsSub::getNbImages(void)
+{
+	return _nbPics;
+}
+/**
+ * 		\fn getBitmap
+ * 		\brief returns a bitmap in black & white (luma+alpha)
+ * */
+vobSubBitmap *ADM_BitmapSource_TsSub::getBitmap(uint32_t nb,uint32_t *start, uint32_t *end,uint32_t *first,uint32_t *last)
+{
+	return NULL;
+}
+//**********************************************************
+//**********************************************************
+//**********************************************************
+/**
+ * 	\fn ADM_buildBitmapSource
+ * \brief Instantiate the correct bitmap source
+*/
+ADM_BitmapSource *ADM_buildBitmapSource(ADM_OCR_SOURCE *source)
+{
+	switch(source->type)
+	{
+			case ADM_OCR_TYPE_VOBSUB: 	return new ADM_BitmapSource_VobSub();
+			case ADM_OCR_TYPE_TS: 		return new ADM_BitmapSource_TsSub();
+			default:
+						printf("[BitmapSource] Unknown source type %d\n",source->type);
+						ADM_assert(0);
+	}
+	return NULL;
+}
+//EOF

Modified: branches/avidemux_2.4_branch/avidemux/ADM_ocr/ADM_ocrInternal.h
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_ocr/ADM_ocrInternal.h	2007-07-26 17:40:36 UTC (rev 3448)
+++ branches/avidemux_2.4_branch/avidemux/ADM_ocr/ADM_ocrInternal.h	2007-07-26 18:09:45 UTC (rev 3449)
@@ -30,5 +30,21 @@
 // In GUI dependant part
 ReplyType glyphToText(admGlyph *glyph,admGlyph *head);
 
+/**
+ * \class ADM_BitmapSource
+ * \brief Front end base class for all OCR'able bitmap source
+ */
+class ADM_BitmapSource
+{
+				
+public: 
+								ADM_BitmapSource(void) {};
+			virtual uint8_t     init(ADM_OCR_SOURCE *source)=0;
+			virtual 			~ADM_BitmapSource() {};
+			virtual uint32_t 	getNbImages(void)=0;
+			virtual vobSubBitmap *getBitmap(uint32_t nb,uint32_t *start, uint32_t *end,uint32_t *first,uint32_t *last)=0;
+};
 
+ADM_BitmapSource *ADM_buildBitmapSource(ADM_OCR_SOURCE *source);
+
 #endif 

Modified: branches/avidemux_2.4_branch/avidemux/ADM_ocr/CMakeLists.txt
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_ocr/CMakeLists.txt	2007-07-26 17:40:36 UTC (rev 3448)
+++ branches/avidemux_2.4_branch/avidemux/ADM_ocr/CMakeLists.txt	2007-07-26 18:09:45 UTC (rev 3449)
@@ -2,6 +2,7 @@
 SET(ADM_ocr_SRCS 
 adm_glyph.cpp  adm_leftturn.cpp  ADM_vob2vobsub.cpp
 ADM_ocr.cpp
+ADM_bitmapSource.cpp
 )
 ADD_LIBRARY(ADM_ocr STATIC ${ADM_ocr_SRCS})
 include_directories(../ADM_inputs)

Modified: branches/avidemux_2.4_branch/avidemux/ADM_ocr/Makefile.am
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_ocr/Makefile.am	2007-07-26 17:40:36 UTC (rev 3448)
+++ branches/avidemux_2.4_branch/avidemux/ADM_ocr/Makefile.am	2007-07-26 18:09:45 UTC (rev 3449)
@@ -7,7 +7,7 @@
 
 libADM_ocr_a_METASOURCES = AUTO
 
-libADM_ocr_a_SOURCES =   adm_glyph.cpp adm_leftturn.cpp ADM_vob2vobsub.cpp ADM_ocr.cpp
+libADM_ocr_a_SOURCES =   adm_glyph.cpp adm_leftturn.cpp ADM_vob2vobsub.cpp ADM_ocr.cpp ADM_bitmapSource.cpp
 
 
 EXTRA_DIST =  ADM_leftturn.h     ADM_vob2vobsub.cpp  adm_glyph.h  \

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_ocr/adm_ocr.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_ocr/adm_ocr.cpp	2007-07-26 17:40:36 UTC (rev 3448)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_ocr/adm_ocr.cpp	2007-07-26 18:09:45 UTC (rev 3449)
@@ -67,8 +67,9 @@
 #include "ADM_video/ADM_vidVobSub.h"
 #include "ADM_leftturn.h"
 #include "DIA_enter.h"
+
+#include "ADM_ocr.h"
 #include "ADM_ocrInternal.h"
-#include "ADM_ocr.h"
 /******************************/
 
 #define TESTSUB "/home/fx/usbstick/subs/vts_01_0.idx"
@@ -120,7 +121,7 @@
 // 
     uint32_t nbSub=0;
     FILE *out=NULL;
-    ADMVideoVobSub *vobsub=NULL;
+    ADM_BitmapSource *bitmapSource=NULL;
     uint32_t startTime,endTime;
     uint32_t w,h,oldw=0,oldh=0;
     uint32_t oldbitmapw=0;
@@ -181,15 +182,24 @@
        GUI_Error_HIG(_("Output file error"), _("Could not open \"%s\" for writing."), labelSrt);
        goto endIt;
     }
-     
-    vobsub=new ADMVideoVobSub(source.subparam->subname,source.subparam->index);
-    nbSub=vobsub->getNbImage();
+    bitmapSource=ADM_buildBitmapSource(&source);
+    if(!bitmapSource)
+    {
+    	goto _again;
+    }
+    if(!bitmapSource->init(&source))
+    {
+    		printf("[OCR] Bitmap source failed\n");
+    		goto _again;
+    }
+    
+    nbSub=bitmapSource->getNbImages();
    
     if(!nbSub)
     {
       GUI_Error_HIG(_("Problem loading sub"), NULL);
-        delete vobsub;
-        vobsub=NULL;
+        delete bitmapSource;
+        bitmapSource=NULL;
         goto _again;
      }
     seqNum=1;   // Sub number in srt file
@@ -201,7 +211,7 @@
     for(uint32_t i=0;i<nbSub;i++)
     {
             first=last=0;
-            bitmap=vobsub->getBitmap(i,&startTime, &endTime,&first,&last);
+            bitmap=bitmapSource->getBitmap(i,&startTime, &endTime,&first,&last);
             ADM_assert(last>=first);
             
             // something ?
@@ -274,9 +284,9 @@
     // Final round
     gtk_widget_set_sensitive(WID(frameBitmap),0);
    // gtk_widget_set_sensitive(WID(Current_Glyph),0);     
-    if(vobsub)
-        delete vobsub;
-    vobsub=NULL;
+    if(bitmapSource)
+        delete bitmapSource;
+    bitmapSource=NULL;
     if(out) 
         fclose(out);
     out=NULL;



From mean at mail.berlios.de  Fri Jul 27 18:57:49 2007
From: mean at mail.berlios.de (mean at BerliOS)
Date: Fri, 27 Jul 2007 18:57:49 +0200
Subject: [Avidemux-svn-commit] r3450 - in
	branches/avidemux_2.4_branch/avidemux: . ADM_codecs ADM_ocr
	ADM_userInterfaces/ADM_GTK/ADM_gui2
	ADM_userInterfaces/ADM_commonUI ADM_video ADM_videoFilter
Message-ID: <200707271657.l6RGvnoj020410@sheep.berlios.de>

Author: mean
Date: 2007-07-27 18:57:44 +0200 (Fri, 27 Jul 2007)
New Revision: 3450

Added:
   branches/avidemux_2.4_branch/avidemux/ADM_video/ADM_vidVobSubBitmap.h
   branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/ADM_vidDvbSub.h
Modified:
   branches/avidemux_2.4_branch/avidemux/ADM_codecs/ADM_ffmp43.h
   branches/avidemux_2.4_branch/avidemux/ADM_ocr/ADM_bitmapSource.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_menumap.h
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_video/ADM_vidVobSub.h
   branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/ADM_vidDvbSub.cpp
   branches/avidemux_2.4_branch/avidemux/gtk_gui.cpp
   branches/avidemux_2.4_branch/avidemux/gui_action.hxx
Log:
[OCR] More on mpeg TS ocr, still incomplete

Modified: branches/avidemux_2.4_branch/avidemux/ADM_codecs/ADM_ffmp43.h
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_codecs/ADM_ffmp43.h	2007-07-26 18:09:45 UTC (rev 3449)
+++ branches/avidemux_2.4_branch/avidemux/ADM_codecs/ADM_ffmp43.h	2007-07-27 16:57:44 UTC (rev 3450)
@@ -18,7 +18,7 @@
  *                                                                         *
  ***************************************************************************/
 #ifdef USE_FFMPEG
-
+#include "ADM_lavcodec.h"
 class decoderFFSubs
 {
   protected:

Modified: branches/avidemux_2.4_branch/avidemux/ADM_ocr/ADM_bitmapSource.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_ocr/ADM_bitmapSource.cpp	2007-07-26 18:09:45 UTC (rev 3449)
+++ branches/avidemux_2.4_branch/avidemux/ADM_ocr/ADM_bitmapSource.cpp	2007-07-27 16:57:44 UTC (rev 3450)
@@ -21,9 +21,10 @@
  #include "ADM_video/ADM_genvideo.hxx"
 
  #include "ADM_ocr.h"
-#include "ADM_ocrInternal.h"
+ #include "ADM_ocrInternal.h"
  #include "ADM_toolkit/toolkit.hxx"
  #include "ADM_userInterfaces/ADM_commonUI/DIA_enter.h"
+ #include "ADM_videoFilter/ADM_vidDvbSub.h"
 
 /*  *****************************
  * 	**** Case 1 : Vobsub ********
@@ -80,11 +81,14 @@
  * 	**** Case 2 : TsSub  ********
  *  *****************************
  */
-
+#define TS_WIDTH  720
+#define TS_HEIGHT 576
 class ADM_BitmapSource_TsSub : public ADM_BitmapSource
 {
 protected:
 			uint32_t		_nbPics;
+			ADMVideoSubDVB  *_dvb;
+			vobSubBitmap    *_bitmap;
 public: 
 								ADM_BitmapSource_TsSub(void);
 			virtual uint8_t     init(ADM_OCR_SOURCE *source);
@@ -96,15 +100,22 @@
 ADM_BitmapSource_TsSub::ADM_BitmapSource_TsSub(void)
 {
 	_nbPics=0x7FFFF;
+	_dvb=NULL;
+	_bitmap=new vobSubBitmap(TS_WIDTH,TS_HEIGHT);
 }
 ADM_BitmapSource_TsSub::~ADM_BitmapSource_TsSub()
 {
-
+	if(_dvb) delete _dvb;
+	_dvb=NULL;
+	if(_bitmap) delete _bitmap;
+	_bitmap=NULL;
 }
 uint8_t     ADM_BitmapSource_TsSub::init(ADM_OCR_SOURCE *source)
 {
+	_dvb=new ADMVideoSubDVB("/capture/grey/Grey_anatomy_2007_05_22_Avec_Le_Temp.mpg",0x96,TS_WIDTH,TS_HEIGHT);
 	
-		return 0;
+	ADM_assert(_dvb);
+	return _dvb->init("/capture/grey/Grey_anatomy_2007_05_22_Avec_Le_Temp.mpg");
 }
 uint32_t 	ADM_BitmapSource_TsSub::getNbImages(void)
 {
@@ -113,10 +124,68 @@
 /**
  * 		\fn getBitmap
  * 		\brief returns a bitmap in black & white (luma+alpha)
+ *      @param nb : unused
+ *      @start : Timecode of start (ms)
+ * 		@end   : Timecode of end (ms)
+ * 		@first : First non empty line
+ * 		@last  : Last non empty line
  * */
 vobSubBitmap *ADM_BitmapSource_TsSub::getBitmap(uint32_t nb,uint32_t *start, uint32_t *end,uint32_t *first,uint32_t *last)
 {
-	return NULL;
+	uint32_t pts;
+	// First get our bitmap
+	  if(! _dvb->getNextBitmap(_bitmap,&pts))
+	  {
+		  printf("[BitmapSource] cannot get next bitmap\n");
+		  return NULL;
+	  }
+	  // Now build it
+	  // First & last are the 1st and last non empty lines
+	  *first=0;
+	  *last=TS_HEIGHT-1;
+	  
+	  // Lookup the actual beginning /end
+	  uint32_t top=0;
+	   while(top<TS_HEIGHT && !_bitmap->isDirty(top) ) top++;
+	        
+	        if(top==TS_HEIGHT)
+	        {
+	                printf("[BitmapSource]Empty bitmap\n");
+	                return NULL; 
+	        }
+	  // 
+	        *first=top;
+	        
+	  // Now bottom
+	        uint32_t bottom=TS_HEIGHT-1;
+	        while(bottom>top && !_bitmap->isDirty(bottom) ) bottom--;
+	        if(bottom==top)
+	        {
+	        	   printf("[BitmapSource]Empty bitmap\n");
+	        	   return NULL; 
+	        }
+	        *last=bottom;
+	        
+	  // start & end are timecodes
+	  *start=pts/90;
+	  *end=*start+1000;
+			  
+	  // Set alpha as luma
+	  uint8_t *in,*out;
+	  in=_bitmap->_bitmap;
+	  out=_bitmap->_alphaMask;
+	  for(uint32_t yy=0;yy<TS_HEIGHT;yy++)
+		  for(uint32_t xx=0;xx<TS_WIDTH;xx++)
+		  {
+			  if(*in) *out=255;
+			  else *out=0;
+			  
+			  in++;
+			  out++;
+			  
+		  }
+		  
+	return _bitmap;
 }
 //**********************************************************
 //**********************************************************

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp	2007-07-26 18:09:45 UTC (rev 3449)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp	2007-07-27 16:57:44 UTC (rev 3450)
@@ -36,11 +36,11 @@
   GtkWidget *menuitem1;
   GtkWidget *menuitem1_menu;
   GtkWidget *open_video1;
-  GtkWidget *image8323;
+  GtkWidget *image8373;
   GtkWidget *append_video1;
-  GtkWidget *image8324;
+  GtkWidget *image8374;
   GtkWidget *save_stuff;
-  GtkWidget *image8325;
+  GtkWidget *image8375;
   GtkWidget *save_stuff_menu;
   GtkWidget *save_as_avi1;
   GtkWidget *separator1;
@@ -50,41 +50,41 @@
   GtkWidget *close1;
   GtkWidget *separator3;
   GtkWidget *save_project1;
-  GtkWidget *image8326;
+  GtkWidget *image8376;
   GtkWidget *save_project_as1;
-  GtkWidget *image8327;
+  GtkWidget *image8377;
   GtkWidget *run_script1;
-  GtkWidget *image8328;
+  GtkWidget *image8378;
   GtkWidget *add_to_joblist1;
   GtkWidget *joblist1;
   GtkWidget *separator16;
   GtkWidget *connect_to_avsproxy1;
   GtkWidget *separator18;
   GtkWidget *video_informations1;
-  GtkWidget *image8329;
+  GtkWidget *image8379;
   GtkWidget *avi_muxer_options1;
   GtkWidget *separator4;
   GtkWidget *quit1;
-  GtkWidget *image8330;
+  GtkWidget *image8380;
   GtkWidget *menuitem2;
   GtkWidget *menuitem2_menu;
   GtkWidget *reset_edits1;
-  GtkWidget *image8331;
+  GtkWidget *image8381;
   GtkWidget *separator5;
   GtkWidget *cut1;
-  GtkWidget *image8332;
+  GtkWidget *image8382;
   GtkWidget *copy1;
-  GtkWidget *image8333;
+  GtkWidget *image8383;
   GtkWidget *paste1;
-  GtkWidget *image8334;
+  GtkWidget *image8384;
   GtkWidget *delete1;
-  GtkWidget *image8335;
+  GtkWidget *image8385;
   GtkWidget *separator6;
   GtkWidget *set_marker_a1;
   GtkWidget *set_marker_b1;
   GtkWidget *separator7;
   GtkWidget *preferences1;
-  GtkWidget *image8336;
+  GtkWidget *image8386;
   GtkWidget *view1;
   GtkWidget *view1_menu;
   GtkWidget *toolbar1;
@@ -113,13 +113,13 @@
   GtkWidget *build_vbr_time_map1;
   GtkWidget *separator11;
   GtkWidget *save_audio1;
-  GtkWidget *image8337;
+  GtkWidget *image8387;
   GtkWidget *audio_encoder1;
   GtkWidget *filters2;
   GtkWidget *tools1;
   GtkWidget *tools1_menu;
   GtkWidget *calculator1;
-  GtkWidget *image8338;
+  GtkWidget *image8388;
   GtkWidget *separator12;
   GtkWidget *rebuild_frames;
   GtkWidget *check_frames;
@@ -128,6 +128,7 @@
   GtkWidget *separator13;
   GtkWidget *v2v;
   GtkWidget *ocr_vobsub_2_srt;
+  GtkWidget *ocr_dvb;
   GtkWidget *edit_glyph1;
   GtkWidget *separator17;
   GtkWidget *see_hex1;
@@ -141,35 +142,35 @@
   GtkWidget *go1;
   GtkWidget *go1_menu;
   GtkWidget *play_video1;
-  GtkWidget *image8339;
+  GtkWidget *image8389;
   GtkWidget *previous_frame1;
-  GtkWidget *image8340;
+  GtkWidget *image8390;
   GtkWidget *next_frame1;
-  GtkWidget *image8341;
+  GtkWidget *image8391;
   GtkWidget *previous_intra_frame1;
-  GtkWidget *image8342;
+  GtkWidget *image8392;
   GtkWidget *next_intra_frame1;
-  GtkWidget *image8343;
+  GtkWidget *image8393;
   GtkWidget *search_previous_black_frame1;
   GtkWidget *search_next_black_frame1;
   GtkWidget *first_frame1;
-  GtkWidget *image8344;
+  GtkWidget *image8394;
   GtkWidget *last_frame1;
-  GtkWidget *image8345;
+  GtkWidget *image8395;
   GtkWidget *separator14;
   GtkWidget *go_to_marker_a1;
   GtkWidget *go_to_marker_b1;
   GtkWidget *separator15;
   GtkWidget *jum_to_frame1;
-  GtkWidget *image8346;
+  GtkWidget *image8396;
   GtkWidget *jump_to_time1;
-  GtkWidget *image8347;
+  GtkWidget *image8397;
   GtkWidget *custom1;
   GtkWidget *help2;
   GtkWidget *help2_menu;
   GtkWidget *show_builtin_support1;
   GtkWidget *about1;
-  GtkWidget *image8348;
+  GtkWidget *image8398;
   GtkWidget *toolbar2;
   GtkIconSize tmp_toolbar_icon_size;
   GtkWidget *menutoolbuttonOpen;
@@ -300,9 +301,9 @@
                               GDK_O, (GdkModifierType)( GDK_CONTROL_MASK),
                               GTK_ACCEL_VISIBLE);
 
-  image8323 = gtk_image_new_from_stock ("gtk-open", GTK_ICON_SIZE_MENU);
-  gtk_widget_show (image8323);
-  gtk_image_menu_item_set_image (GTK_IMAGE_MENU_ITEM (open_video1), image8323);
+  image8373 = gtk_image_new_from_stock ("gtk-open", GTK_ICON_SIZE_MENU);
+  gtk_widget_show (image8373);
+  gtk_image_menu_item_set_image (GTK_IMAGE_MENU_ITEM (open_video1), image8373);
 
   append_video1 = gtk_image_menu_item_new_with_mnemonic (_("_Append..."));
   gtk_widget_show (append_video1);
@@ -311,17 +312,17 @@
                               GDK_A, (GdkModifierType)( GDK_CONTROL_MASK | GDK_MOD1_MASK),
                               GTK_ACCEL_VISIBLE);
 
-  image8324 = gtk_image_new_from_stock ("gtk-add", GTK_ICON_SIZE_MENU);
-  gtk_widget_show (image8324);
-  gtk_image_menu_item_set_image (GTK_IMAGE_MENU_ITEM (append_video1), image8324);
+  image8374 = gtk_image_new_from_stock ("gtk-add", GTK_ICON_SIZE_MENU);
+  gtk_widget_show (image8374);
+  gtk_image_menu_item_set_image (GTK_IMAGE_MENU_ITEM (append_video1), image8374);
 
   save_stuff = gtk_image_menu_item_new_with_mnemonic (_("_Save"));
   gtk_widget_show (save_stuff);
   gtk_container_add (GTK_CONTAINER (menuitem1_menu), save_stuff);
 
-  image8325 = gtk_image_new_from_stock ("gtk-save", GTK_ICON_SIZE_MENU);
-  gtk_widget_show (image8325);
-  gtk_image_menu_item_set_image (GTK_IMAGE_MENU_ITEM (save_stuff), image8325);
+  image8375 = gtk_image_new_from_stock ("gtk-save", GTK_ICON_SIZE_MENU);
+  gtk_widget_show (image8375);
+  gtk_image_menu_item_set_image (GTK_IMAGE_MENU_ITEM (save_stuff), image8375);
 
   save_stuff_menu = gtk_menu_new ();
   gtk_menu_item_set_submenu (GTK_MENU_ITEM (save_stuff), save_stuff_menu);
@@ -363,25 +364,25 @@
   gtk_widget_show (save_project1);
   gtk_container_add (GTK_CONTAINER (menuitem1_menu), save_project1);
 
-  image8326 = gtk_image_new_from_stock ("gtk-save", GTK_ICON_SIZE_MENU);
-  gtk_widget_show (image8326);
-  gtk_image_menu_item_set_image (GTK_IMAGE_MENU_ITEM (save_project1), image8326);
+  image8376 = gtk_image_new_from_stock ("gtk-save", GTK_ICON_SIZE_MENU);
+  gtk_widget_show (image8376);
+  gtk_image_menu_item_set_image (GTK_IMAGE_MENU_ITEM (save_project1), image8376);
 
   save_project_as1 = gtk_image_menu_item_new_with_mnemonic (_("Save P_roject As..."));
   gtk_widget_show (save_project_as1);
   gtk_container_add (GTK_CONTAINER (menuitem1_menu), save_project_as1);
 
-  image8327 = gtk_image_new_from_stock ("gtk-save-as", GTK_ICON_SIZE_MENU);
-  gtk_widget_show (image8327);
-  gtk_image_menu_item_set_image (GTK_IMAGE_MENU_ITEM (save_project_as1), image8327);
+  image8377 = gtk_image_new_from_stock ("gtk-save-as", GTK_ICON_SIZE_MENU);
+  gtk_widget_show (image8377);
+  gtk_image_menu_item_set_image (GTK_IMAGE_MENU_ITEM (save_project_as1), image8377);
 
   run_script1 = gtk_image_menu_item_new_with_mnemonic (_("_Load/Run Project..."));
   gtk_widget_show (run_script1);
   gtk_container_add (GTK_CONTAINER (menuitem1_menu), run_script1);
 
-  image8328 = gtk_image_new_from_stock ("gtk-execute", GTK_ICON_SIZE_MENU);
-  gtk_widget_show (image8328);
-  gtk_image_menu_item_set_image (GTK_IMAGE_MENU_ITEM (run_script1), image8328);
+  image8378 = gtk_image_new_from_stock ("gtk-execute", GTK_ICON_SIZE_MENU);
+  gtk_widget_show (image8378);
+  gtk_image_menu_item_set_image (GTK_IMAGE_MENU_ITEM (run_script1), image8378);
 
   add_to_joblist1 = gtk_menu_item_new_with_mnemonic (_("A_dd to Joblist..."));
   gtk_widget_show (add_to_joblist1);
@@ -415,9 +416,9 @@
                               GDK_Return, (GdkModifierType)( GDK_MOD1_MASK),
                               GTK_ACCEL_VISIBLE);
 
-  image8329 = gtk_image_new_from_stock ("gtk-properties", GTK_ICON_SIZE_MENU);
-  gtk_widget_show (image8329);
-  gtk_image_menu_item_set_image (GTK_IMAGE_MENU_ITEM (video_informations1), image8329);
+  image8379 = gtk_image_new_from_stock ("gtk-properties", GTK_ICON_SIZE_MENU);
+  gtk_widget_show (image8379);
+  gtk_image_menu_item_set_image (GTK_IMAGE_MENU_ITEM (video_informations1), image8379);
 
   avi_muxer_options1 = gtk_menu_item_new_with_mnemonic (_("AVI _Muxer Options"));
   gtk_widget_show (avi_muxer_options1);
@@ -435,9 +436,9 @@
                               GDK_Q, (GdkModifierType)( GDK_CONTROL_MASK),
                               GTK_ACCEL_VISIBLE);
 
-  image8330 = gtk_image_new_from_stock ("gtk-quit", GTK_ICON_SIZE_MENU);
-  gtk_widget_show (image8330);
-  gtk_image_menu_item_set_image (GTK_IMAGE_MENU_ITEM (quit1), image8330);
+  image8380 = gtk_image_new_from_stock ("gtk-quit", GTK_ICON_SIZE_MENU);
+  gtk_widget_show (image8380);
+  gtk_image_menu_item_set_image (GTK_IMAGE_MENU_ITEM (quit1), image8380);
 
   menuitem2 = gtk_menu_item_new_with_mnemonic (_("_Edit"));
   gtk_widget_show (menuitem2);
@@ -450,9 +451,9 @@
   gtk_widget_show (reset_edits1);
   gtk_container_add (GTK_CONTAINER (menuitem2_menu), reset_edits1);
 
-  image8331 = gtk_image_new_from_stock ("gtk-undo", GTK_ICON_SIZE_MENU);
-  gtk_widget_show (image8331);
-  gtk_image_menu_item_set_image (GTK_IMAGE_MENU_ITEM (reset_edits1), image8331);
+  image8381 = gtk_image_new_from_stock ("gtk-undo", GTK_ICON_SIZE_MENU);
+  gtk_widget_show (image8381);
+  gtk_image_menu_item_set_image (GTK_IMAGE_MENU_ITEM (reset_edits1), image8381);
 
   separator5 = gtk_separator_menu_item_new ();
   gtk_widget_show (separator5);
@@ -466,9 +467,9 @@
                               GDK_X, (GdkModifierType)( GDK_CONTROL_MASK),
                               GTK_ACCEL_VISIBLE);
 
-  image8332 = gtk_image_new_from_stock ("gtk-cut", GTK_ICON_SIZE_MENU);
-  gtk_widget_show (image8332);
-  gtk_image_menu_item_set_image (GTK_IMAGE_MENU_ITEM (cut1), image8332);
+  image8382 = gtk_image_new_from_stock ("gtk-cut", GTK_ICON_SIZE_MENU);
+  gtk_widget_show (image8382);
+  gtk_image_menu_item_set_image (GTK_IMAGE_MENU_ITEM (cut1), image8382);
 
   copy1 = gtk_image_menu_item_new_with_mnemonic (_("_Copy"));
   gtk_widget_show (copy1);
@@ -477,9 +478,9 @@
                               GDK_C, (GdkModifierType)( GDK_CONTROL_MASK),
                               GTK_ACCEL_VISIBLE);
 
-  image8333 = gtk_image_new_from_stock ("gtk-copy", GTK_ICON_SIZE_MENU);
-  gtk_widget_show (image8333);
-  gtk_image_menu_item_set_image (GTK_IMAGE_MENU_ITEM (copy1), image8333);
+  image8383 = gtk_image_new_from_stock ("gtk-copy", GTK_ICON_SIZE_MENU);
+  gtk_widget_show (image8383);
+  gtk_image_menu_item_set_image (GTK_IMAGE_MENU_ITEM (copy1), image8383);
 
   paste1 = gtk_image_menu_item_new_with_mnemonic (_("_Paste"));
   gtk_widget_show (paste1);
@@ -488,9 +489,9 @@
                               GDK_V, (GdkModifierType)( GDK_CONTROL_MASK),
                               GTK_ACCEL_VISIBLE);
 
-  image8334 = gtk_image_new_from_stock ("gtk-paste", GTK_ICON_SIZE_MENU);
-  gtk_widget_show (image8334);
-  gtk_image_menu_item_set_image (GTK_IMAGE_MENU_ITEM (paste1), image8334);
+  image8384 = gtk_image_new_from_stock ("gtk-paste", GTK_ICON_SIZE_MENU);
+  gtk_widget_show (image8384);
+  gtk_image_menu_item_set_image (GTK_IMAGE_MENU_ITEM (paste1), image8384);
 
   delete1 = gtk_image_menu_item_new_with_mnemonic (_("_Delete"));
   gtk_widget_show (delete1);
@@ -499,9 +500,9 @@
                               GDK_Delete, (GdkModifierType)( 0 ),
                               GTK_ACCEL_VISIBLE);
 
-  image8335 = gtk_image_new_from_stock ("gtk-remove", GTK_ICON_SIZE_MENU);
-  gtk_widget_show (image8335);
-  gtk_image_menu_item_set_image (GTK_IMAGE_MENU_ITEM (delete1), image8335);
+  image8385 = gtk_image_new_from_stock ("gtk-remove", GTK_ICON_SIZE_MENU);
+  gtk_widget_show (image8385);
+  gtk_image_menu_item_set_image (GTK_IMAGE_MENU_ITEM (delete1), image8385);
 
   separator6 = gtk_separator_menu_item_new ();
   gtk_widget_show (separator6);
@@ -531,9 +532,9 @@
   gtk_widget_show (preferences1);
   gtk_container_add (GTK_CONTAINER (menuitem2_menu), preferences1);
 
-  image8336 = gtk_image_new_from_stock ("gtk-preferences", GTK_ICON_SIZE_MENU);
-  gtk_widget_show (image8336);
-  gtk_image_menu_item_set_image (GTK_IMAGE_MENU_ITEM (preferences1), image8336);
+  image8386 = gtk_image_new_from_stock ("gtk-preferences", GTK_ICON_SIZE_MENU);
+  gtk_widget_show (image8386);
+  gtk_image_menu_item_set_image (GTK_IMAGE_MENU_ITEM (preferences1), image8386);
 
   view1 = gtk_menu_item_new_with_mnemonic (_("_View"));
   gtk_widget_show (view1);
@@ -687,9 +688,9 @@
                               GDK_S, (GdkModifierType)( GDK_CONTROL_MASK | GDK_MOD1_MASK),
                               GTK_ACCEL_VISIBLE);
 
-  image8337 = gtk_image_new_from_stock ("gtk-save-as", GTK_ICON_SIZE_MENU);
-  gtk_widget_show (image8337);
-  gtk_image_menu_item_set_image (GTK_IMAGE_MENU_ITEM (save_audio1), image8337);
+  image8387 = gtk_image_new_from_stock ("gtk-save-as", GTK_ICON_SIZE_MENU);
+  gtk_widget_show (image8387);
+  gtk_image_menu_item_set_image (GTK_IMAGE_MENU_ITEM (save_audio1), image8387);
 
   audio_encoder1 = gtk_menu_item_new_with_mnemonic (_("_Encoder"));
   gtk_widget_show (audio_encoder1);
@@ -716,9 +717,9 @@
                               GDK_F7, (GdkModifierType)( 0 ),
                               GTK_ACCEL_VISIBLE);
 
-  image8338 = create_pixmap (mainWindow, "gnome-calculator_small.xpm");
-  gtk_widget_show (image8338);
-  gtk_image_menu_item_set_image (GTK_IMAGE_MENU_ITEM (calculator1), image8338);
+  image8388 = create_pixmap (mainWindow, "gnome-calculator_small.xpm");
+  gtk_widget_show (image8388);
+  gtk_image_menu_item_set_image (GTK_IMAGE_MENU_ITEM (calculator1), image8388);
 
   separator12 = gtk_separator_menu_item_new ();
   gtk_widget_show (separator12);
@@ -754,6 +755,10 @@
   gtk_widget_show (ocr_vobsub_2_srt);
   gtk_container_add (GTK_CONTAINER (tools1_menu), ocr_vobsub_2_srt);
 
+  ocr_dvb = gtk_menu_item_new_with_mnemonic (_("OCR (TS->srt)"));
+  gtk_widget_show (ocr_dvb);
+  gtk_container_add (GTK_CONTAINER (tools1_menu), ocr_dvb);
+
   edit_glyph1 = gtk_menu_item_new_with_mnemonic (_("_Edit Glyph"));
   gtk_widget_show (edit_glyph1);
   gtk_container_add (GTK_CONTAINER (tools1_menu), edit_glyph1);
@@ -808,9 +813,9 @@
                               GDK_P, (GdkModifierType)( 0 ),
                               GTK_ACCEL_VISIBLE);
 
-  image8339 = gtk_image_new_from_stock ("gtk-media-play", GTK_ICON_SIZE_MENU);
-  gtk_widget_show (image8339);
-  gtk_image_menu_item_set_image (GTK_IMAGE_MENU_ITEM (play_video1), image8339);
+  image8389 = gtk_image_new_from_stock ("gtk-media-play", GTK_ICON_SIZE_MENU);
+  gtk_widget_show (image8389);
+  gtk_image_menu_item_set_image (GTK_IMAGE_MENU_ITEM (play_video1), image8389);
 
   previous_frame1 = gtk_image_menu_item_new_with_mnemonic (_("P_revious Frame"));
   gtk_widget_show (previous_frame1);
@@ -819,9 +824,9 @@
                               GDK_KP_4, (GdkModifierType)( 0 ),
                               GTK_ACCEL_VISIBLE);
 
-  image8340 = gtk_image_new_from_stock ("gtk-media-previous", GTK_ICON_SIZE_MENU);
-  gtk_widget_show (image8340);
-  gtk_image_menu_item_set_image (GTK_IMAGE_MENU_ITEM (previous_frame1), image8340);
+  image8390 = gtk_image_new_from_stock ("gtk-media-previous", GTK_ICON_SIZE_MENU);
+  gtk_widget_show (image8390);
+  gtk_image_menu_item_set_image (GTK_IMAGE_MENU_ITEM (previous_frame1), image8390);
 
   next_frame1 = gtk_image_menu_item_new_with_mnemonic (_("_Next Frame"));
   gtk_widget_show (next_frame1);
@@ -830,9 +835,9 @@
                               GDK_KP_6, (GdkModifierType)( 0 ),
                               GTK_ACCEL_VISIBLE);
 
-  image8341 = gtk_image_new_from_stock ("gtk-media-next", GTK_ICON_SIZE_MENU);
-  gtk_widget_show (image8341);
-  gtk_image_menu_item_set_image (GTK_IMAGE_MENU_ITEM (next_frame1), image8341);
+  image8391 = gtk_image_new_from_stock ("gtk-media-next", GTK_ICON_SIZE_MENU);
+  gtk_widget_show (image8391);
+  gtk_image_menu_item_set_image (GTK_IMAGE_MENU_ITEM (next_frame1), image8391);
 
   previous_intra_frame1 = gtk_image_menu_item_new_with_mnemonic (_("Pr_evious Intra Frame"));
   gtk_widget_show (previous_intra_frame1);
@@ -841,9 +846,9 @@
                               GDK_KP_2, (GdkModifierType)( 0 ),
                               GTK_ACCEL_VISIBLE);
 
-  image8342 = gtk_image_new_from_stock ("gtk-media-rewind", GTK_ICON_SIZE_MENU);
-  gtk_widget_show (image8342);
-  gtk_image_menu_item_set_image (GTK_IMAGE_MENU_ITEM (previous_intra_frame1), image8342);
+  image8392 = gtk_image_new_from_stock ("gtk-media-rewind", GTK_ICON_SIZE_MENU);
+  gtk_widget_show (image8392);
+  gtk_image_menu_item_set_image (GTK_IMAGE_MENU_ITEM (previous_intra_frame1), image8392);
 
   next_intra_frame1 = gtk_image_menu_item_new_with_mnemonic (_("Next _Intra Frame"));
   gtk_widget_show (next_intra_frame1);
@@ -852,9 +857,9 @@
                               GDK_KP_8, (GdkModifierType)( 0 ),
                               GTK_ACCEL_VISIBLE);
 
-  image8343 = gtk_image_new_from_stock ("gtk-media-forward", GTK_ICON_SIZE_MENU);
-  gtk_widget_show (image8343);
-  gtk_image_menu_item_set_image (GTK_IMAGE_MENU_ITEM (next_intra_frame1), image8343);
+  image8393 = gtk_image_new_from_stock ("gtk-media-forward", GTK_ICON_SIZE_MENU);
+  gtk_widget_show (image8393);
+  gtk_image_menu_item_set_image (GTK_IMAGE_MENU_ITEM (next_intra_frame1), image8393);
 
   search_previous_black_frame1 = gtk_menu_item_new_with_mnemonic (_("Previou_s Black Frame"));
   gtk_widget_show (search_previous_black_frame1);
@@ -871,9 +876,9 @@
                               GDK_Home, (GdkModifierType)( 0 ),
                               GTK_ACCEL_VISIBLE);
 
-  image8344 = gtk_image_new_from_stock ("gtk-goto-first", GTK_ICON_SIZE_MENU);
-  gtk_widget_show (image8344);
-  gtk_image_menu_item_set_image (GTK_IMAGE_MENU_ITEM (first_frame1), image8344);
+  image8394 = gtk_image_new_from_stock ("gtk-goto-first", GTK_ICON_SIZE_MENU);
+  gtk_widget_show (image8394);
+  gtk_image_menu_item_set_image (GTK_IMAGE_MENU_ITEM (first_frame1), image8394);
 
   last_frame1 = gtk_image_menu_item_new_with_mnemonic (_("_Last Frame"));
   gtk_widget_show (last_frame1);
@@ -882,9 +887,9 @@
                               GDK_End, (GdkModifierType)( 0 ),
                               GTK_ACCEL_VISIBLE);
 
-  image8345 = gtk_image_new_from_stock ("gtk-goto-last", GTK_ICON_SIZE_MENU);
-  gtk_widget_show (image8345);
-  gtk_image_menu_item_set_image (GTK_IMAGE_MENU_ITEM (last_frame1), image8345);
+  image8395 = gtk_image_new_from_stock ("gtk-goto-last", GTK_ICON_SIZE_MENU);
+  gtk_widget_show (image8395);
+  gtk_image_menu_item_set_image (GTK_IMAGE_MENU_ITEM (last_frame1), image8395);
 
   separator14 = gtk_separator_menu_item_new ();
   gtk_widget_show (separator14);
@@ -917,9 +922,9 @@
                               GDK_F, (GdkModifierType)( GDK_CONTROL_MASK),
                               GTK_ACCEL_VISIBLE);
 
-  image8346 = gtk_image_new_from_stock ("gtk-jump-to", GTK_ICON_SIZE_MENU);
-  gtk_widget_show (image8346);
-  gtk_image_menu_item_set_image (GTK_IMAGE_MENU_ITEM (jum_to_frame1), image8346);
+  image8396 = gtk_image_new_from_stock ("gtk-jump-to", GTK_ICON_SIZE_MENU);
+  gtk_widget_show (image8396);
+  gtk_image_menu_item_set_image (GTK_IMAGE_MENU_ITEM (jum_to_frame1), image8396);
 
   jump_to_time1 = gtk_image_menu_item_new_with_mnemonic (_("Go to _Time..."));
   gtk_widget_show (jump_to_time1);
@@ -928,9 +933,9 @@
                               GDK_T, (GdkModifierType)( GDK_CONTROL_MASK),
                               GTK_ACCEL_VISIBLE);
 
-  image8347 = gtk_image_new_from_stock ("gtk-jump-to", GTK_ICON_SIZE_MENU);
-  gtk_widget_show (image8347);
-  gtk_image_menu_item_set_image (GTK_IMAGE_MENU_ITEM (jump_to_time1), image8347);
+  image8397 = gtk_image_new_from_stock ("gtk-jump-to", GTK_ICON_SIZE_MENU);
+  gtk_widget_show (image8397);
+  gtk_image_menu_item_set_image (GTK_IMAGE_MENU_ITEM (jump_to_time1), image8397);
 
   custom1 = gtk_menu_item_new_with_mnemonic (_("_Custom"));
   gtk_widget_show (custom1);
@@ -951,9 +956,9 @@
   gtk_widget_show (about1);
   gtk_container_add (GTK_CONTAINER (help2_menu), about1);
 
-  image8348 = gtk_image_new_from_stock ("gtk-about", GTK_ICON_SIZE_MENU);
-  gtk_widget_show (image8348);
-  gtk_image_menu_item_set_image (GTK_IMAGE_MENU_ITEM (about1), image8348);
+  image8398 = gtk_image_new_from_stock ("gtk-about", GTK_ICON_SIZE_MENU);
+  gtk_widget_show (image8398);
+  gtk_image_menu_item_set_image (GTK_IMAGE_MENU_ITEM (about1), image8398);
 
   toolbar2 = gtk_toolbar_new ();
   gtk_widget_show (toolbar2);
@@ -1475,11 +1480,11 @@
   GLADE_HOOKUP_OBJECT (mainWindow, menuitem1, "menuitem1");
   GLADE_HOOKUP_OBJECT (mainWindow, menuitem1_menu, "menuitem1_menu");
   GLADE_HOOKUP_OBJECT (mainWindow, open_video1, "open_video1");
-  GLADE_HOOKUP_OBJECT (mainWindow, image8323, "image8323");
+  GLADE_HOOKUP_OBJECT (mainWindow, image8373, "image8373");
   GLADE_HOOKUP_OBJECT (mainWindow, append_video1, "append_video1");
-  GLADE_HOOKUP_OBJECT (mainWindow, image8324, "image8324");
+  GLADE_HOOKUP_OBJECT (mainWindow, image8374, "image8374");
   GLADE_HOOKUP_OBJECT (mainWindow, save_stuff, "save_stuff");
-  GLADE_HOOKUP_OBJECT (mainWindow, image8325, "image8325");
+  GLADE_HOOKUP_OBJECT (mainWindow, image8375, "image8375");
   GLADE_HOOKUP_OBJECT (mainWindow, save_stuff_menu, "save_stuff_menu");
   GLADE_HOOKUP_OBJECT (mainWindow, save_as_avi1, "save_as_avi1");
   GLADE_HOOKUP_OBJECT (mainWindow, separator1, "separator1");
@@ -1489,41 +1494,41 @@
   GLADE_HOOKUP_OBJECT (mainWindow, close1, "close1");
   GLADE_HOOKUP_OBJECT (mainWindow, separator3, "separator3");
   GLADE_HOOKUP_OBJECT (mainWindow, save_project1, "save_project1");
-  GLADE_HOOKUP_OBJECT (mainWindow, image8326, "image8326");
+  GLADE_HOOKUP_OBJECT (mainWindow, image8376, "image8376");
   GLADE_HOOKUP_OBJECT (mainWindow, save_project_as1, "save_project_as1");
-  GLADE_HOOKUP_OBJECT (mainWindow, image8327, "image8327");
+  GLADE_HOOKUP_OBJECT (mainWindow, image8377, "image8377");
   GLADE_HOOKUP_OBJECT (mainWindow, run_script1, "run_script1");
-  GLADE_HOOKUP_OBJECT (mainWindow, image8328, "image8328");
+  GLADE_HOOKUP_OBJECT (mainWindow, image8378, "image8378");
   GLADE_HOOKUP_OBJECT (mainWindow, add_to_joblist1, "add_to_joblist1");
   GLADE_HOOKUP_OBJECT (mainWindow, joblist1, "joblist1");
   GLADE_HOOKUP_OBJECT (mainWindow, separator16, "separator16");
   GLADE_HOOKUP_OBJECT (mainWindow, connect_to_avsproxy1, "connect_to_avsproxy1");
   GLADE_HOOKUP_OBJECT (mainWindow, separator18, "separator18");
   GLADE_HOOKUP_OBJECT (mainWindow, video_informations1, "video_informations1");
-  GLADE_HOOKUP_OBJECT (mainWindow, image8329, "image8329");
+  GLADE_HOOKUP_OBJECT (mainWindow, image8379, "image8379");
   GLADE_HOOKUP_OBJECT (mainWindow, avi_muxer_options1, "avi_muxer_options1");
   GLADE_HOOKUP_OBJECT (mainWindow, separator4, "separator4");
   GLADE_HOOKUP_OBJECT (mainWindow, quit1, "quit1");
-  GLADE_HOOKUP_OBJECT (mainWindow, image8330, "image8330");
+  GLADE_HOOKUP_OBJECT (mainWindow, image8380, "image8380");
   GLADE_HOOKUP_OBJECT (mainWindow, menuitem2, "menuitem2");
   GLADE_HOOKUP_OBJECT (mainWindow, menuitem2_menu, "menuitem2_menu");
   GLADE_HOOKUP_OBJECT (mainWindow, reset_edits1, "reset_edits1");
-  GLADE_HOOKUP_OBJECT (mainWindow, image8331, "image8331");
+  GLADE_HOOKUP_OBJECT (mainWindow, image8381, "image8381");
   GLADE_HOOKUP_OBJECT (mainWindow, separator5, "separator5");
   GLADE_HOOKUP_OBJECT (mainWindow, cut1, "cut1");
-  GLADE_HOOKUP_OBJECT (mainWindow, image8332, "image8332");
+  GLADE_HOOKUP_OBJECT (mainWindow, image8382, "image8382");
   GLADE_HOOKUP_OBJECT (mainWindow, copy1, "copy1");
-  GLADE_HOOKUP_OBJECT (mainWindow, image8333, "image8333");
+  GLADE_HOOKUP_OBJECT (mainWindow, image8383, "image8383");
   GLADE_HOOKUP_OBJECT (mainWindow, paste1, "paste1");
-  GLADE_HOOKUP_OBJECT (mainWindow, image8334, "image8334");
+  GLADE_HOOKUP_OBJECT (mainWindow, image8384, "image8384");
   GLADE_HOOKUP_OBJECT (mainWindow, delete1, "delete1");
-  GLADE_HOOKUP_OBJECT (mainWindow, image8335, "image8335");
+  GLADE_HOOKUP_OBJECT (mainWindow, image8385, "image8385");
   GLADE_HOOKUP_OBJECT (mainWindow, separator6, "separator6");
   GLADE_HOOKUP_OBJECT (mainWindow, set_marker_a1, "set_marker_a1");
   GLADE_HOOKUP_OBJECT (mainWindow, set_marker_b1, "set_marker_b1");
   GLADE_HOOKUP_OBJECT (mainWindow, separator7, "separator7");
   GLADE_HOOKUP_OBJECT (mainWindow, preferences1, "preferences1");
-  GLADE_HOOKUP_OBJECT (mainWindow, image8336, "image8336");
+  GLADE_HOOKUP_OBJECT (mainWindow, image8386, "image8386");
   GLADE_HOOKUP_OBJECT (mainWindow, view1, "view1");
   GLADE_HOOKUP_OBJECT (mainWindow, view1_menu, "view1_menu");
   GLADE_HOOKUP_OBJECT (mainWindow, toolbar1, "toolbar1");
@@ -1552,13 +1557,13 @@
   GLADE_HOOKUP_OBJECT (mainWindow, build_vbr_time_map1, "build_vbr_time_map1");
   GLADE_HOOKUP_OBJECT (mainWindow, separator11, "separator11");
   GLADE_HOOKUP_OBJECT (mainWindow, save_audio1, "save_audio1");
-  GLADE_HOOKUP_OBJECT (mainWindow, image8337, "image8337");
+  GLADE_HOOKUP_OBJECT (mainWindow, image8387, "image8387");
   GLADE_HOOKUP_OBJECT (mainWindow, audio_encoder1, "audio_encoder1");
   GLADE_HOOKUP_OBJECT (mainWindow, filters2, "filters2");
   GLADE_HOOKUP_OBJECT (mainWindow, tools1, "tools1");
   GLADE_HOOKUP_OBJECT (mainWindow, tools1_menu, "tools1_menu");
   GLADE_HOOKUP_OBJECT (mainWindow, calculator1, "calculator1");
-  GLADE_HOOKUP_OBJECT (mainWindow, image8338, "image8338");
+  GLADE_HOOKUP_OBJECT (mainWindow, image8388, "image8388");
   GLADE_HOOKUP_OBJECT (mainWindow, separator12, "separator12");
   GLADE_HOOKUP_OBJECT (mainWindow, rebuild_frames, "rebuild_frames");
   GLADE_HOOKUP_OBJECT (mainWindow, check_frames, "check_frames");
@@ -1567,6 +1572,7 @@
   GLADE_HOOKUP_OBJECT (mainWindow, separator13, "separator13");
   GLADE_HOOKUP_OBJECT (mainWindow, v2v, "v2v");
   GLADE_HOOKUP_OBJECT (mainWindow, ocr_vobsub_2_srt, "ocr_vobsub_2_srt");
+  GLADE_HOOKUP_OBJECT (mainWindow, ocr_dvb, "ocr_dvb");
   GLADE_HOOKUP_OBJECT (mainWindow, edit_glyph1, "edit_glyph1");
   GLADE_HOOKUP_OBJECT (mainWindow, separator17, "separator17");
   GLADE_HOOKUP_OBJECT (mainWindow, see_hex1, "see_hex1");
@@ -1580,35 +1586,35 @@
   GLADE_HOOKUP_OBJECT (mainWindow, go1, "go1");
   GLADE_HOOKUP_OBJECT (mainWindow, go1_menu, "go1_menu");
   GLADE_HOOKUP_OBJECT (mainWindow, play_video1, "play_video1");
-  GLADE_HOOKUP_OBJECT (mainWindow, image8339, "image8339");
+  GLADE_HOOKUP_OBJECT (mainWindow, image8389, "image8389");
   GLADE_HOOKUP_OBJECT (mainWindow, previous_frame1, "previous_frame1");
-  GLADE_HOOKUP_OBJECT (mainWindow, image8340, "image8340");
+  GLADE_HOOKUP_OBJECT (mainWindow, image8390, "image8390");
   GLADE_HOOKUP_OBJECT (mainWindow, next_frame1, "next_frame1");
-  GLADE_HOOKUP_OBJECT (mainWindow, image8341, "image8341");
+  GLADE_HOOKUP_OBJECT (mainWindow, image8391, "image8391");
   GLADE_HOOKUP_OBJECT (mainWindow, previous_intra_frame1, "previous_intra_frame1");
-  GLADE_HOOKUP_OBJECT (mainWindow, image8342, "image8342");
+  GLADE_HOOKUP_OBJECT (mainWindow, image8392, "image8392");
   GLADE_HOOKUP_OBJECT (mainWindow, next_intra_frame1, "next_intra_frame1");
-  GLADE_HOOKUP_OBJECT (mainWindow, image8343, "image8343");
+  GLADE_HOOKUP_OBJECT (mainWindow, image8393, "image8393");
   GLADE_HOOKUP_OBJECT (mainWindow, search_previous_black_frame1, "search_previous_black_frame1");
   GLADE_HOOKUP_OBJECT (mainWindow, search_next_black_frame1, "search_next_black_frame1");
   GLADE_HOOKUP_OBJECT (mainWindow, first_frame1, "first_frame1");
-  GLADE_HOOKUP_OBJECT (mainWindow, image8344, "image8344");
+  GLADE_HOOKUP_OBJECT (mainWindow, image8394, "image8394");
   GLADE_HOOKUP_OBJECT (mainWindow, last_frame1, "last_frame1");
-  GLADE_HOOKUP_OBJECT (mainWindow, image8345, "image8345");
+  GLADE_HOOKUP_OBJECT (mainWindow, image8395, "image8395");
   GLADE_HOOKUP_OBJECT (mainWindow, separator14, "separator14");
   GLADE_HOOKUP_OBJECT (mainWindow, go_to_marker_a1, "go_to_marker_a1");
   GLADE_HOOKUP_OBJECT (mainWindow, go_to_marker_b1, "go_to_marker_b1");
   GLADE_HOOKUP_OBJECT (mainWindow, separator15, "separator15");
   GLADE_HOOKUP_OBJECT (mainWindow, jum_to_frame1, "jum_to_frame1");
-  GLADE_HOOKUP_OBJECT (mainWindow, image8346, "image8346");
+  GLADE_HOOKUP_OBJECT (mainWindow, image8396, "image8396");
   GLADE_HOOKUP_OBJECT (mainWindow, jump_to_time1, "jump_to_time1");
-  GLADE_HOOKUP_OBJECT (mainWindow, image8347, "image8347");
+  GLADE_HOOKUP_OBJECT (mainWindow, image8397, "image8397");
   GLADE_HOOKUP_OBJECT (mainWindow, custom1, "custom1");
   GLADE_HOOKUP_OBJECT (mainWindow, help2, "help2");
   GLADE_HOOKUP_OBJECT (mainWindow, help2_menu, "help2_menu");
   GLADE_HOOKUP_OBJECT (mainWindow, show_builtin_support1, "show_builtin_support1");
   GLADE_HOOKUP_OBJECT (mainWindow, about1, "about1");
-  GLADE_HOOKUP_OBJECT (mainWindow, image8348, "image8348");
+  GLADE_HOOKUP_OBJECT (mainWindow, image8398, "image8398");
   GLADE_HOOKUP_OBJECT (mainWindow, toolbar2, "toolbar2");
   GLADE_HOOKUP_OBJECT (mainWindow, menutoolbuttonOpen, "menutoolbuttonOpen");
   GLADE_HOOKUP_OBJECT (mainWindow, toolitem11, "toolitem11");

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_menumap.h
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_menumap.h	2007-07-26 18:09:45 UTC (rev 3449)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_menumap.h	2007-07-27 16:57:44 UTC (rev 3450)
@@ -75,6 +75,10 @@
  
  CALLBACK(run_script1		   	        ,ACT_RunScript);
  CALLBACK( ocr_vobsub_2_srt                     ,ACT_Ocr);
+ 
+ CALLBACK( ocr_dvb                     ,ACT_DVB_Ocr);
+ 
+ 
 CALLBACK(item1                                 ,ACT_AllBlackFrames);
 
 CALLBACK(first_frame1                          ,ACT_Begin);

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp	2007-07-26 18:09:45 UTC (rev 3449)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp	2007-07-27 16:57:44 UTC (rev 3450)
@@ -137,7 +137,6 @@
         ADM_ocr_engine(source,srtFileName,&head);
         
         // Save glyph set 
-_save:
         if(globalGlyph)
         {
           uint32_t nb=1;
@@ -154,7 +153,7 @@
             }
             if(save) ADM_dezalloc(save);
         }
-cleanup:
+
   cleanupSub(&subparam);
   if(srtFileName )ADM_dezalloc(srtFileName);
   srtFileName=NULL;
@@ -162,7 +161,112 @@
   return 1;  
 }
 /**
+    \fn DIA_ocrDvb
+    \brief Dialog to select input & output files before calling the actual ocr engine
+*/
+uint8_t DIA_ocrDvb(void)
+{
 
+  vobSubParam subparam={NULL,0,0};
+  char *srtFileName=NULL;
+  char *glyphFileName=NULL;
+  admGlyph head(16,16);
+  char *globalGlyph=NULL;
+  uint32_t globalGlyphOn=0;
+  prefs->get(FEATURE_GLOBAL_GLYPH_ACTIVE,&globalGlyphOn);
+  if(globalGlyphOn)
+  {
+     prefs->get(FEATURE_GLOBAL_GLYPH_NAME,&globalGlyph);
+     if(!*globalGlyph)
+     {
+        ADM_dezalloc(globalGlyph);
+        globalGlyph=NULL; 
+     }
+  }
+
+  if(globalGlyph)
+  {
+    glyphFileName=globalGlyph;
+  }
+_againX:  
+  // Fist build a dialogFactory to get input and output files
+  diaElemFile     selectGlyph(1,&glyphFileName,_("Use glyphset (optional):"),NULL);  
+  diaElemFile     selectSrt(1,&srtFileName,_("Output SRT file"),NULL);
+  
+  diaElem *elems[]={&selectSrt,&selectGlyph};
+  
+  
+   uint32_t n=2;
+   if(globalGlyph)
+   {
+     n--; // Remove glyph from dialog
+   }
+  
+        if( !diaFactoryRun(_("Select input and ouput files"),n,elems))
+        {
+          cleanupSub(&subparam);
+          if(srtFileName )ADM_dezalloc(srtFileName);
+          srtFileName=NULL;
+          destroyGlyphTree(&head);
+          return 0;
+        }
+       // TODO Check input TS file
+        if(!srtFileName || !*srtFileName)
+        {
+          GUI_Error_HIG(_("File error"),_("Please Select a valid output SRT file."));
+          goto _againX; 
+        }
+         if(glyphFileName && *glyphFileName)
+         {
+           if(!ADM_fileExist(glyphFileName))
+            {
+              GUI_Error_HIG(_("File error"),_("The idx/sub file does not exist."));
+              goto _againX; 
+            }
+            // Purge previous glyph set if any
+            destroyGlyphTree(&head);
+            uint32_t nb;
+            printf("[OCR] Loading glyphset :<%s>\n",glyphFileName);
+            if(!loadGlyph(glyphFileName,&head,&nb))
+            {
+              GUI_Error_HIG(_("File error"),_("Cannot load the glyphset file."));
+              goto _againX;               
+            }
+            printf("[GLYPH] Found %u glyph\n");
+         }
+        // We have our SRT and our idx/sub files : Go go go
+         ADM_OCR_SOURCE source;
+         source.type=ADM_OCR_TYPE_TS;
+         source.TsFile=NULL;
+         ADM_ocr_engine(source,srtFileName,&head);
+        
+        // Save glyph set 
+
+        if(globalGlyph)
+        {
+          uint32_t nb=1;
+           saveGlyph(globalGlyph,&head,nb);
+        }else
+        {
+            char *save=NULL;
+            uint32_t nb=1;
+              diaElemFile     selectSave(1,&save,_("Glyphset filename"),NULL);
+              diaElem *elems2[]={&selectSave};
+            if( diaFactoryRun(_("Save Glyph"),1,elems2))
+            {
+              saveGlyph(save,&head,nb);
+            }
+            if(save) ADM_dezalloc(save);
+        }
+
+  cleanupSub(&subparam);
+  if(srtFileName )ADM_dezalloc(srtFileName);
+  srtFileName=NULL;
+  destroyGlyphTree(&head);
+  return 1;  
+}
+/**
+
 */
 void cleanupSub(vobSubParam *p)
 {

Modified: branches/avidemux_2.4_branch/avidemux/ADM_video/ADM_vidVobSub.h
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_video/ADM_vidVobSub.h	2007-07-26 18:09:45 UTC (rev 3449)
+++ branches/avidemux_2.4_branch/avidemux/ADM_video/ADM_vidVobSub.h	2007-07-27 16:57:44 UTC (rev 3450)
@@ -25,31 +25,7 @@
         int32_t         subShift;
 }vobSubParam;
 //************************************
-class vobSubBitmap
-{
-  protected:
-        uint8_t                         *_dirty;                   /// Dirty lines (non transparent)
-  public:
-        uint8_t                         isDirty(uint32_t line);
-        uint8_t                         setDirty(uint32_t line);
-
-        uint32_t                        _width,_height;
-        uint32_t                        placeTop, placeHeight;     /// Position of the sub
-      
-        uint8_t                         *_bitmap;                  /// YUV image
-        uint8_t                         *_alphaMask;               /// alpha mask 
-        
- 
-                                        vobSubBitmap(uint32_t w, uint32_t h); 
-                                        ~vobSubBitmap();
-        void                            clear(void);
-        
-                                        /// Convert palette bitmap to yuv&mask bitmap
-        uint8_t                         buildYUV( int16_t *palette ); 
-                                        /// Generate the final bitmap (resized)
-        uint8_t                         subResize(vobSubBitmap **tgt,uint32_t newx,uint32_t newy,
-                                                uint32_t oldtop, uint32_t oldheight);
-};
+#include "ADM_video/ADM_vidVobSubBitmap.h"
 //************************************
 class  ADMVideoVobSub:public AVDMGenericVideoStream
  {

Copied: branches/avidemux_2.4_branch/avidemux/ADM_video/ADM_vidVobSubBitmap.h (from rev 3449, branches/avidemux_2.4_branch/avidemux/ADM_video/ADM_vidVobSub.h)
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_video/ADM_vidVobSub.h	2007-07-26 18:09:45 UTC (rev 3449)
+++ branches/avidemux_2.4_branch/avidemux/ADM_video/ADM_vidVobSubBitmap.h	2007-07-27 16:57:44 UTC (rev 3450)
@@ -0,0 +1,40 @@
+
+/***************************************************************************
+ *                                                                         *
+ *   This program is free software; you can redistribute it and/or modify  *
+ *   it under the terms of the GNU General Public License as published by  *
+ *   the Free Software Foundation; either version 2 of the License, or     *
+ *   (at your option) any later version.                                   *
+ *                                                                         *
+ ***************************************************************************/
+
+#ifndef _VOBSUB_BITMAP_H
+#define _VOBSUB_BITMAP_H
+//************************************
+class vobSubBitmap
+{
+  protected:
+        uint8_t                         *_dirty;                   /// Dirty lines (non transparent)
+  public:
+        uint8_t                         isDirty(uint32_t line);
+        uint8_t                         setDirty(uint32_t line);
+
+        uint32_t                        _width,_height;
+        uint32_t                        placeTop, placeHeight;     /// Position of the sub
+      
+        uint8_t                         *_bitmap;                  /// YUV image
+        uint8_t                         *_alphaMask;               /// alpha mask 
+        
+ 
+                                        vobSubBitmap(uint32_t w, uint32_t h); 
+                                        ~vobSubBitmap();
+        void                            clear(void);
+        
+                                        /// Convert palette bitmap to yuv&mask bitmap
+        uint8_t                         buildYUV( int16_t *palette ); 
+                                        /// Generate the final bitmap (resized)
+        uint8_t                         subResize(vobSubBitmap **tgt,uint32_t newx,uint32_t newy,
+                                                uint32_t oldtop, uint32_t oldheight);
+};
+
+#endif

Modified: branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/ADM_vidDvbSub.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/ADM_vidDvbSub.cpp	2007-07-26 18:09:45 UTC (rev 3449)
+++ branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/ADM_vidDvbSub.cpp	2007-07-27 16:57:44 UTC (rev 3450)
@@ -1,6 +1,10 @@
 /***************************************************************************
                          DVB-T subtitle filter
     
+    This is a dummy DVB-T Filter and should be only used through OCR
+    The filter exists just for debugging purpose and should not be exposed
+    to end user at all.
+    
     copyright            : (C) 2007 by mean
     email                : fixounet at free.fr
  ***************************************************************************/
@@ -37,37 +41,10 @@
 #include "ADM_userInterfaces/ADM_commonUI/DIA_factory.h"
 
 #include "DIA_factory.h"
-#include "ADM_inputs/ADM_mpegdemuxer/dmx_mpegstartcode.h"
-#include "ADM_inputs/ADM_mpegdemuxer/dmx_demuxerTS.h"
 
 #include "ADM_colorspace/colorspace.h"
 #include "ADM_codecs/ADM_codec.h"
-#include "ADM_codecs/ADM_ffmp43.h"
-
-#define READ_BUFFER_SIZE (64*1024)
-
-class ADMVideoSubDVB : public AVDMGenericVideoStream 
-{
-protected:
-        virtual char* printConf(void);
-       
-        uint8_t init(void);
-        
-        decoderFFSubs *decoder;
-        ADMCompressedImage *binary;
-        dmx_demuxerTS *demuxer;
-        AVSubtitle  sub;
-        uint8_t     readBuffer[READ_BUFFER_SIZE];
-        uint32_t    _inited;
-        
-public:
-        ADMVideoSubDVB(AVDMGenericVideoStream *in, CONFcouple *conf);
-        virtual ~ADMVideoSubDVB();
-        virtual uint8_t getFrameNumberNoAlloc(uint32_t frame, uint32_t *len, ADMImage *data,uint32_t *flags);
-        uint8_t configure(AVDMGenericVideoStream *instream);
-        uint8_t	getCoupledConf(CONFcouple **conf);
-};
-
+#include "ADM_vidDvbSub.h"
 static FILTER_PARAM assParam={7,
         { /* float */ "font_scale",
           /*float*/ "line_spacing",
@@ -94,7 +71,34 @@
   
    return 1;
 }
+//_______________________________________________________________
 
+ADMVideoSubDVB::ADMVideoSubDVB(const char *ts, uint32_t pid,uint32_t w, uint32_t h) 
+{
+        _in=NULL;		
+        memset(&_info,0,sizeof(_info));
+        _info.width=w;
+        _info.height=h;
+        _inited=0;
+        
+      
+        _uncompressed=new ADMImage(getInfo()->width,getInfo()->height);
+        ADM_assert(_uncompressed);
+        _info.encoding=1;
+        
+        decoder=new decoderFFSubs(1);
+        binary=new ADMCompressedImage;
+        binary->data=readBuffer+2;
+        
+        MPEG_TRACK track;
+        track.pid=pid;
+
+        
+        demuxer=new dmx_demuxerTS(1,&track,0,DMX_MPG_TS);
+      
+
+      
+}
 //_______________________________________________________________
 
 ADMVideoSubDVB::ADMVideoSubDVB(AVDMGenericVideoStream *in, CONFcouple *conf) 
@@ -117,14 +121,17 @@
 
         
         demuxer=new dmx_demuxerTS(1,&track,0,DMX_MPG_TS);
-        _inited=init();
+        _inited=init(NULL);
 
       
 }
 // **********************************
-uint8_t ADMVideoSubDVB::init(void)
+uint8_t ADMVideoSubDVB::init(const char  *tsFileName)
 {
-const char  *tsFileName="/capture/grey/Grey_anatomy_2007_05_22_Avec_Le_Temp.mpg";
+	// For test only!
+#ifdef ADM_DEBUG
+	if(!tsFileName) tsFileName="/capture/grey/Grey_anatomy_2007_05_22_Avec_Le_Temp.mpg";
+#endif
     // First create our demuxer
      
      if(!demuxer->open(tsFileName))
@@ -133,7 +140,7 @@
         return 0; 
      }
       memset(&sub,0,sizeof(sub));
-     
+      _inited=1;
      return 1;
 } 
 
@@ -244,7 +251,6 @@
                       }
               
                       // Merge Luma
-                      
                       for(int yy=0;yy<clipH;yy++)
                       {
                           org=data->data+(yy+r->y)*_info.width+r->x;
@@ -324,22 +330,124 @@
         
         return 1;
 }
+/**
+ * \fn 			getNextBitmap
+ * \brief 		Decode a bitmap and store the result (luma only) in the caller supplied vobSubBitmap
+ * @param data  (in) Vobsubbitmap to put image in
+ * @param pts   Raw pts in 90 Khz Tick
+ * @return      0 on failure, 1 on success 
+ * */
+uint8_t ADMVideoSubDVB::getNextBitmap(vobSubBitmap *data,uint32_t *pts) 
+{
+uint8_t *org=NULL;
 
+        uint32_t packetLen,dts; //,pts;
+        // Clear incoming picture
+        	data->clear();
+        
+          if(!demuxer->readPes(readBuffer,&packetLen, &dts,pts)) return 0;
+          binary->dataLength=packetLen-3; // -2 for stream iD, -1 for ????
+          if(packetLen<=5) return 1;
+          // And decompress...
+          decoder->uncompress(binary,&sub);
+            
+          // Process All rectangles
+          
+            printf("Found %d rects to process\n",sub.num_rects);
+            for(int i=0;i<sub.num_rects;i++)
+            {
+              AVSubtitleRect *r=&(sub.rects[i]);
+              // First convert RGB to Y+ALPHA
+              for(int col=0;col<r->nb_colors;col++)
+              {
+                    // Color is RGB, convert to YUV
+                    uint32_t y,u,v,a;
+                    uint32_t rgb=r->rgba_palette[col];
+                
+                          y=rgba2y(rgb);
+                          u=rgba2u(rgb)&0xff;
+                          v=rgba2v(rgb)&0xff;
+                          a=_a(rgb);
+                          r->rgba_palette[col]=y+(u<<8)+(v<<16)+(a<<24);
+                          printf("Color %d, alpha %u luma %u rgb:%x\n",col,a,y,rgb);
+              }
+              // Palette is ready, display !
+              if(r->x>_info.width || r->y>_info.height)
+              {
+                  printf("[DVBSUB]Box is outside image\n");
+                  goto _skipX;
+              }
+                  printf("x :%d\n",r->x);
+                  printf("y :%d\n",r->y);
+                  printf("w :%d\n",r->w);
+                  printf("h :%d\n",r->h);
+
+                  {
+                      uint32_t clipW,clipH;
+                      
+                      clipW=FFMIN(_info.width,r->x+r->w)-r->x;
+                      clipH=FFMIN(_info.height,r->y+r->h)-r->y;
+                      
+                      ADMImage image(r->w,r->h);
+                      ADMImage alphaImage(r->w,r->h);
+                      
+                      uint8_t *ptr=image.data;
+                      uint8_t *ptrAlpha=alphaImage.data;
+                      uint8_t *in=r->bitmap;
+                      for(int yy=0;yy<r->h;yy++)
+                      {
+                          for(int xx=0;xx<r->w;xx++)
+                          {
+                            uint32_t alpha,valout;
+                            uint32_t val=*in++;
+                            
+                                  val=r->rgba_palette[val];
+                                  
+                                  *ptrAlpha++=(val>>24)&0xff;
+                                  *ptr++=(val&0xff);;
+                          }
+                      }
+              
+                      // Merge Luma
+                      
+                      for(int yy=0;yy<clipH;yy++)
+                      {
+                          org=data->_bitmap+(yy+r->y)*_info.width+r->x;
+                          
+                          ptrAlpha=alphaImage.data+yy*r->w;
+                          ptr=image.data+yy*r->w;
+                          int clean=0;
+                          for(int xx=0;xx<clipW;xx++)
+                          {
+                            uint32_t val,before,alpha;
+                            
+                                  //before=*org;
+                                  val=*ptr++;
+                                  alpha=*ptrAlpha++;
+                                  
+                                  val=val*alpha;//+(255-alpha)*before;
+                                  val=val>>8;
+                                  if(val>10) clean=1; // Remove noise
+                                  *org++=val;
+                                  
+                          }
+                          if(clean) data->setDirty(r->y+yy);
+                      }
+                  }
+                   // We dont need chroma here...
+               // Delete palette & data
+_skipX:
+               av_free(r->rgba_palette);
+               av_free(r->bitmap);
+            } // Next rec..
+            memset(&sub,0,sizeof(sub));
+        
+        return 1;
+}
 uint8_t	ADMVideoSubDVB::getCoupledConf(CONFcouple **conf) 
 {
 
         *conf=new CONFcouple(0);
-#if 0
-#define _COUPLE_SET(x) (*conf)->setCouple(#x, _params->x);
-        _COUPLE_SET(font_scale)
-        _COUPLE_SET(line_spacing)
-        _COUPLE_SET(top_margin)
-        _COUPLE_SET(bottom_margin)
-        _COUPLE_SET(subfile)
-        _COUPLE_SET(fonts_dir)
-        _COUPLE_SET(extract_embedded_fonts)
-#endif
-     
         return 1;
 }
 /************************************************/

Copied: branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/ADM_vidDvbSub.h (from rev 3449, branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/ADM_vidDvbSub.cpp)
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/ADM_vidDvbSub.cpp	2007-07-26 18:09:45 UTC (rev 3449)
+++ branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/ADM_vidDvbSub.h	2007-07-27 16:57:44 UTC (rev 3450)
@@ -0,0 +1,53 @@
+/***************************************************************************
+                         DVB-T subtitle filter
+    
+    copyright            : (C) 2007 by mean
+    email                : fixounet at free.fr
+ ***************************************************************************/
+
+/***************************************************************************
+ *                                                                         *
+ *   This program is free software; you can redistribute it and/or modify  *
+ *   it under the terms of the GNU General Public License as published by  *
+ *   the Free Software Foundation; either version 2 of the License, or     *
+ *   (at your option) any later version.                                   *
+ *                                                                         *
+ ***************************************************************************/
+
+#ifndef ADM_VIDDVBSUB_H
+#define ADM_VIDDVBSUB_H
+#include "ADM_inputs/ADM_mpegdemuxer/dmx_mpegstartcode.h"
+#include "ADM_inputs/ADM_mpegdemuxer/dmx_demuxerTS.h"
+
+#include "ADM_codecs/ADM_ffmp43.h"
+#include "ADM_video/ADM_vidVobSubBitmap.h"
+
+
+#define READ_BUFFER_SIZE (64*1024)
+
+class ADMVideoSubDVB : public AVDMGenericVideoStream 
+{
+protected:
+        virtual char* printConf(void);
+       
+       
+        
+        decoderFFSubs *decoder;
+        ADMCompressedImage *binary;
+        dmx_demuxerTS *demuxer;
+        AVSubtitle  sub;
+        uint8_t     readBuffer[READ_BUFFER_SIZE];
+        uint32_t    _inited;
+        
+public:
+        ADMVideoSubDVB(AVDMGenericVideoStream *in, CONFcouple *conf);
+        ADMVideoSubDVB(const char *fileName, uint32_t pid,uint32_t w,uint32_t h);
+        virtual ~ADMVideoSubDVB();
+        virtual uint8_t getFrameNumberNoAlloc(uint32_t frame, uint32_t *len, ADMImage *data,uint32_t *flags);
+        uint8_t configure(AVDMGenericVideoStream *instream);
+        uint8_t	getCoupledConf(CONFcouple **conf);
+        uint8_t getNextBitmap(vobSubBitmap *data,uint32_t *pts);
+        uint8_t init(const char  *tsFileName);
+};
+#endif
+/************************************************/

Modified: branches/avidemux_2.4_branch/avidemux/gtk_gui.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/gtk_gui.cpp	2007-07-26 18:09:45 UTC (rev 3449)
+++ branches/avidemux_2.4_branch/avidemux/gtk_gui.cpp	2007-07-27 16:57:44 UTC (rev 3450)
@@ -147,6 +147,7 @@
 int ignore_change;
 
 extern uint8_t DIA_ocrGen(void);
+extern uint8_t DIA_ocrDvb(void);
 uint8_t A_TimeShift(void);
 PARAM_MUX muxMode = MUX_REGULAR;
 int muxParam = 0;
@@ -224,6 +225,9 @@
                 return;
         case ACT_ViewMain: UI_toogleMain();return;
         case ACT_ViewSide: UI_toogleSide();return;
+        case ACT_DVB_Ocr:
+        		DIA_ocrDvb();
+        		break;
       case ACT_Ocr:
                 DIA_ocrGen(); //
                 return;

Modified: branches/avidemux_2.4_branch/avidemux/gui_action.hxx
===================================================================
--- branches/avidemux_2.4_branch/avidemux/gui_action.hxx	2007-07-26 18:09:45 UTC (rev 3449)
+++ branches/avidemux_2.4_branch/avidemux/gui_action.hxx	2007-07-27 16:57:44 UTC (rev 3450)
@@ -164,6 +164,7 @@
 ACT_PreviewChanged,
 ACT_Bitrate,
 ACT_Ocr,
+ACT_DVB_Ocr,
 ACT_SelectTrack1,
 ACT_ViewMain,
 ACT_ViewSide,



From gruntster at mail.berlios.de  Sat Jul 28 13:54:22 2007
From: gruntster at mail.berlios.de (gruntster at mail.berlios.de)
Date: Sat, 28 Jul 2007 13:54:22 +0200
Subject: [Avidemux-svn-commit] r3451 - branches/avidemux_2.4_branch
Message-ID: <200707281154.l6SBsMuo000613@sheep.berlios.de>

Author: gruntster
Date: 2007-07-28 13:54:11 +0200 (Sat, 28 Jul 2007)
New Revision: 3451

Modified:
   branches/avidemux_2.4_branch/ConfigureChecks.cmake
Log:
[CMAKE] fix x264 detection for Win32

Modified: branches/avidemux_2.4_branch/ConfigureChecks.cmake
===================================================================
--- branches/avidemux_2.4_branch/ConfigureChecks.cmake	2007-07-27 16:57:44 UTC (rev 3450)
+++ branches/avidemux_2.4_branch/ConfigureChecks.cmake	2007-07-28 11:54:11 UTC (rev 3451)
@@ -284,7 +284,13 @@
 # X264
 ########################################
 SET(CMAKE_REQUIRED_FLAGS "-include stdint.h")
+
+if(WIN32)
+SET(CMAKE_REQUIRED_LIBRARIES "-lm -lpthreadGC2")
+else(WIN32)
 SET(CMAKE_REQUIRED_LIBRARIES "-lm -lpthread")
+endif(WIN32)
+
 ADM_CHECK_HL(x264 x264.h x264 x264_encoder_open USE_X264)
 SET(CMAKE_REQUIRED_FLAGS)
 SET(CMAKE_REQUIRED_LIBRARIES)



From mean at mail.berlios.de  Sat Jul 28 16:52:04 2007
From: mean at mail.berlios.de (mean at BerliOS)
Date: Sat, 28 Jul 2007 16:52:04 +0200
Subject: [Avidemux-svn-commit] r3452 - in
	branches/avidemux_2.4_branch/avidemux: ADM_ocr
	ADM_userInterfaces/ADM_GTK/ADM_dialog
	ADM_userInterfaces/ADM_GTK/ADM_ocr
	ADM_userInterfaces/ADM_commonUI ADM_videoFilter
Message-ID: <200707281452.l6SEq4BO012232@sheep.berlios.de>

Author: mean
Date: 2007-07-28 16:52:03 +0200 (Sat, 28 Jul 2007)
New Revision: 3452

Modified:
   branches/avidemux_2.4_branch/avidemux/ADM_ocr/ADM_bitmapSource.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_ocr/ADM_ocr.h
   branches/avidemux_2.4_branch/avidemux/ADM_ocr/ADM_ocrInternal.h
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_ocr.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_ocr/adm_ocr.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/ADM_vidDvbSub.cpp
Log:
[OCR] Mostly working TS subtitles OCR

Modified: branches/avidemux_2.4_branch/avidemux/ADM_ocr/ADM_bitmapSource.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_ocr/ADM_bitmapSource.cpp	2007-07-28 11:54:11 UTC (rev 3451)
+++ branches/avidemux_2.4_branch/avidemux/ADM_ocr/ADM_bitmapSource.cpp	2007-07-28 14:52:03 UTC (rev 3452)
@@ -41,7 +41,7 @@
 			virtual uint8_t     init(ADM_OCR_SOURCE *source);
 			virtual 			~ADM_BitmapSource_VobSub();
 			virtual uint32_t 	getNbImages(void);
-			virtual vobSubBitmap *getBitmap(uint32_t nb,uint32_t *start, uint32_t *end,uint32_t *first,uint32_t *last);
+			virtual vobSubBitmap *getBitmap(uint32_t nb,uint32_t *start, uint32_t *end,uint32_t *first,uint32_t *last,uint32_t *eos);
 };
 
 ADM_BitmapSource_VobSub::ADM_BitmapSource_VobSub(void)
@@ -73,8 +73,9 @@
  * 		\fn getBitmap
  * 		\brief returns a bitmap in black & white (luma+alpha)
  * */
-vobSubBitmap *ADM_BitmapSource_VobSub::getBitmap(uint32_t nb,uint32_t *start, uint32_t *end,uint32_t *first,uint32_t *last)
+vobSubBitmap *ADM_BitmapSource_VobSub::getBitmap(uint32_t nb,uint32_t *start, uint32_t *end,uint32_t *first,uint32_t *last,uint32_t *endofstream)
 {
+	*endofstream=0;
 	return _vobsub->getBitmap(nb,start, end,first,last);
 }
 /*  *****************************
@@ -83,18 +84,21 @@
  */
 #define TS_WIDTH  720
 #define TS_HEIGHT 576
+#define NO_STARTING_TIMECODE 0xFFFFFFF
 class ADM_BitmapSource_TsSub : public ADM_BitmapSource
 {
 protected:
 			uint32_t		_nbPics;
 			ADMVideoSubDVB  *_dvb;
 			vobSubBitmap    *_bitmap;
+			uint32_t		_firstTimeCode;
 public: 
 								ADM_BitmapSource_TsSub(void);
 			virtual uint8_t     init(ADM_OCR_SOURCE *source);
 			virtual 			~ADM_BitmapSource_TsSub();
 			virtual uint32_t 	getNbImages(void);
-			virtual vobSubBitmap *getBitmap(uint32_t nb,uint32_t *start, uint32_t *end,uint32_t *first,uint32_t *last);
+			virtual vobSubBitmap *getBitmap(uint32_t nb,uint32_t *start, uint32_t *end,uint32_t *first,uint32_t *last,
+									uint32_t *eos);
 };
 
 ADM_BitmapSource_TsSub::ADM_BitmapSource_TsSub(void)
@@ -102,6 +106,7 @@
 	_nbPics=0x7FFFF;
 	_dvb=NULL;
 	_bitmap=new vobSubBitmap(TS_WIDTH,TS_HEIGHT);
+	_firstTimeCode=NO_STARTING_TIMECODE;
 }
 ADM_BitmapSource_TsSub::~ADM_BitmapSource_TsSub()
 {
@@ -112,10 +117,10 @@
 }
 uint8_t     ADM_BitmapSource_TsSub::init(ADM_OCR_SOURCE *source)
 {
-	_dvb=new ADMVideoSubDVB("/capture/grey/Grey_anatomy_2007_05_22_Avec_Le_Temp.mpg",0x96,TS_WIDTH,TS_HEIGHT);
+	_dvb=new ADMVideoSubDVB(source->TsFile,source->TsPid,TS_WIDTH,TS_HEIGHT);
 	
 	ADM_assert(_dvb);
-	return _dvb->init("/capture/grey/Grey_anatomy_2007_05_22_Avec_Le_Temp.mpg");
+	return _dvb->init(source->TsFile);
 }
 uint32_t 	ADM_BitmapSource_TsSub::getNbImages(void)
 {
@@ -130,15 +135,23 @@
  * 		@first : First non empty line
  * 		@last  : Last non empty line
  * */
-vobSubBitmap *ADM_BitmapSource_TsSub::getBitmap(uint32_t nb,uint32_t *start, uint32_t *end,uint32_t *first,uint32_t *last)
+vobSubBitmap *ADM_BitmapSource_TsSub::getBitmap(uint32_t nb,uint32_t *start, uint32_t *end,uint32_t *first,uint32_t *last,uint32_t *endOfStream)
 {
 	uint32_t pts;
+	//
+	*endOfStream=0;
 	// First get our bitmap
 	  if(! _dvb->getNextBitmap(_bitmap,&pts))
 	  {
 		  printf("[BitmapSource] cannot get next bitmap\n");
+		  *endOfStream=1;
 		  return NULL;
 	  }
+	  // First ?
+	  if(_firstTimeCode==NO_STARTING_TIMECODE)
+	  {
+		  _firstTimeCode=pts;
+	  }
 	  // Now build it
 	  // First & last are the 1st and last non empty lines
 	  *first=0;
@@ -167,7 +180,14 @@
 	        *last=bottom;
 	        
 	  // start & end are timecodes
-	  *start=pts/90;
+#define WRAP_TIMECODE 0x3FFFFFFF
+	  if(pts>_firstTimeCode)
+	  {
+		  *start=(pts-_firstTimeCode)/90;
+	  }else
+	  {
+		  *start=((WRAP_TIMECODE-pts)+_firstTimeCode)/90;
+	  }
 	  *end=*start+1000;
 			  
 	  // Set alpha as luma

Modified: branches/avidemux_2.4_branch/avidemux/ADM_ocr/ADM_ocr.h
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_ocr/ADM_ocr.h	2007-07-28 11:54:11 UTC (rev 3451)
+++ branches/avidemux_2.4_branch/avidemux/ADM_ocr/ADM_ocr.h	2007-07-28 14:52:03 UTC (rev 3452)
@@ -31,6 +31,7 @@
 	ADM_OCR_SOURCE_TYPE type;
 	vobSubParam *subparam;
 	char		*TsFile;
+	uint32_t    TsPid;
 }ADM_OCR_SOURCE;
 
 

Modified: branches/avidemux_2.4_branch/avidemux/ADM_ocr/ADM_ocrInternal.h
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_ocr/ADM_ocrInternal.h	2007-07-28 11:54:11 UTC (rev 3451)
+++ branches/avidemux_2.4_branch/avidemux/ADM_ocr/ADM_ocrInternal.h	2007-07-28 14:52:03 UTC (rev 3452)
@@ -42,7 +42,8 @@
 			virtual uint8_t     init(ADM_OCR_SOURCE *source)=0;
 			virtual 			~ADM_BitmapSource() {};
 			virtual uint32_t 	getNbImages(void)=0;
-			virtual vobSubBitmap *getBitmap(uint32_t nb,uint32_t *start, uint32_t *end,uint32_t *first,uint32_t *last)=0;
+			virtual vobSubBitmap *getBitmap(uint32_t nb,uint32_t *start, uint32_t *end,uint32_t *first,uint32_t *last,
+											uint32_t *eos)=0;
 };
 
 ADM_BitmapSource *ADM_buildBitmapSource(ADM_OCR_SOURCE *source);

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_ocr.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_ocr.cpp	2007-07-28 11:54:11 UTC (rev 3451)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_ocr.cpp	2007-07-28 14:52:03 UTC (rev 3452)
@@ -32,10 +32,11 @@
   GtkWidget *label9;
   GtkWidget *labelNbGlyphs;
   GtkWidget *labelNbLines;
+  GtkWidget *label15;
+  GtkWidget *labelTime;
   GtkWidget *label7;
   GtkWidget *frameBitmap;
   GtkWidget *vbox7;
-  GtkWidget *drawingareaBitmap;
   GtkWidget *table2;
   GtkWidget *label13;
   GtkWidget *drawingareaSmall;
@@ -48,6 +49,7 @@
   GtkWidget *buttonSkip;
   GtkWidget *buttonIgnore;
   GtkWidget *buttonOk;
+  GtkWidget *drawingareaBitmap;
   GtkWidget *hseparator1;
   GtkWidget *label12;
   GtkWidget *dialog_action_area1;
@@ -68,7 +70,7 @@
   gtk_widget_show (frame5);
   gtk_box_pack_start (GTK_BOX (vbox1), frame5, FALSE, FALSE, 0);
 
-  table1 = gtk_table_new (2, 2, FALSE);
+  table1 = gtk_table_new (3, 2, FALSE);
   gtk_widget_show (table1);
   gtk_container_add (GTK_CONTAINER (frame5), table1);
 
@@ -100,6 +102,20 @@
                     (GtkAttachOptions) (0), 0, 0);
   gtk_misc_set_alignment (GTK_MISC (labelNbLines), 0, 0.5);
 
+  label15 = gtk_label_new (_("TimeCode:"));
+  gtk_widget_show (label15);
+  gtk_table_attach (GTK_TABLE (table1), label15, 0, 1, 2, 3,
+                    (GtkAttachOptions) (GTK_FILL),
+                    (GtkAttachOptions) (0), 0, 0);
+  gtk_misc_set_alignment (GTK_MISC (label15), 0, 0.5);
+
+  labelTime = gtk_label_new (_("0:0:0"));
+  gtk_widget_show (labelTime);
+  gtk_table_attach (GTK_TABLE (table1), labelTime, 1, 2, 2, 3,
+                    (GtkAttachOptions) (GTK_FILL),
+                    (GtkAttachOptions) (0), 0, 0);
+  gtk_misc_set_alignment (GTK_MISC (labelTime), 0, 0.5);
+
   label7 = gtk_label_new (_("<b>Stats</b>"));
   gtk_widget_show (label7);
   gtk_frame_set_label_widget (GTK_FRAME (frame5), label7);
@@ -113,14 +129,9 @@
   gtk_widget_show (vbox7);
   gtk_container_add (GTK_CONTAINER (frameBitmap), vbox7);
 
-  drawingareaBitmap = gtk_drawing_area_new ();
-  gtk_widget_show (drawingareaBitmap);
-  gtk_box_pack_start (GTK_BOX (vbox7), drawingareaBitmap, FALSE, FALSE, 0);
-  gtk_widget_set_size_request (drawingareaBitmap, 5, 11);
-
   table2 = gtk_table_new (2, 2, FALSE);
   gtk_widget_show (table2);
-  gtk_box_pack_start (GTK_BOX (vbox7), table2, TRUE, TRUE, 0);
+  gtk_box_pack_start (GTK_BOX (vbox7), table2, FALSE, FALSE, 0);
 
   label13 = gtk_label_new (_("Current Glyph"));
   gtk_widget_show (label13);
@@ -155,7 +166,7 @@
 
   hbuttonbox1 = gtk_hbutton_box_new ();
   gtk_widget_show (hbuttonbox1);
-  gtk_box_pack_start (GTK_BOX (vbox7), hbuttonbox1, TRUE, TRUE, 0);
+  gtk_box_pack_start (GTK_BOX (vbox7), hbuttonbox1, FALSE, FALSE, 0);
 
   buttonCalibrate = gtk_button_new_with_mnemonic (_("Calibrate"));
   gtk_widget_show (buttonCalibrate);
@@ -182,6 +193,11 @@
   gtk_container_add (GTK_CONTAINER (hbuttonbox1), buttonOk);
   GTK_WIDGET_SET_FLAGS (buttonOk, GTK_CAN_DEFAULT);
 
+  drawingareaBitmap = gtk_drawing_area_new ();
+  gtk_widget_show (drawingareaBitmap);
+  gtk_box_pack_start (GTK_BOX (vbox7), drawingareaBitmap, TRUE, TRUE, 0);
+  gtk_widget_set_size_request (drawingareaBitmap, 5, 11);
+
   hseparator1 = gtk_hseparator_new ();
   gtk_widget_show (hseparator1);
   gtk_box_pack_start (GTK_BOX (vbox7), hseparator1, TRUE, TRUE, 0);
@@ -210,10 +226,11 @@
   GLADE_HOOKUP_OBJECT (dialog1, label9, "label9");
   GLADE_HOOKUP_OBJECT (dialog1, labelNbGlyphs, "labelNbGlyphs");
   GLADE_HOOKUP_OBJECT (dialog1, labelNbLines, "labelNbLines");
+  GLADE_HOOKUP_OBJECT (dialog1, label15, "label15");
+  GLADE_HOOKUP_OBJECT (dialog1, labelTime, "labelTime");
   GLADE_HOOKUP_OBJECT (dialog1, label7, "label7");
   GLADE_HOOKUP_OBJECT (dialog1, frameBitmap, "frameBitmap");
   GLADE_HOOKUP_OBJECT (dialog1, vbox7, "vbox7");
-  GLADE_HOOKUP_OBJECT (dialog1, drawingareaBitmap, "drawingareaBitmap");
   GLADE_HOOKUP_OBJECT (dialog1, table2, "table2");
   GLADE_HOOKUP_OBJECT (dialog1, label13, "label13");
   GLADE_HOOKUP_OBJECT (dialog1, drawingareaSmall, "drawingareaSmall");
@@ -226,6 +243,7 @@
   GLADE_HOOKUP_OBJECT (dialog1, buttonSkip, "buttonSkip");
   GLADE_HOOKUP_OBJECT (dialog1, buttonIgnore, "buttonIgnore");
   GLADE_HOOKUP_OBJECT (dialog1, buttonOk, "buttonOk");
+  GLADE_HOOKUP_OBJECT (dialog1, drawingareaBitmap, "drawingareaBitmap");
   GLADE_HOOKUP_OBJECT (dialog1, hseparator1, "hseparator1");
   GLADE_HOOKUP_OBJECT (dialog1, label12, "label12");
   GLADE_HOOKUP_OBJECT_NO_REF (dialog1, dialog_action_area1, "dialog_action_area1");

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_ocr/adm_ocr.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_ocr/adm_ocr.cpp	2007-07-28 11:54:11 UTC (rev 3451)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_ocr/adm_ocr.cpp	2007-07-28 14:52:03 UTC (rev 3452)
@@ -75,6 +75,12 @@
 #define TESTSUB "/home/fx/usbstick/subs/vts_01_0.idx"
 #define CONNECT(x,y,z) 	gtk_signal_connect(GTK_OBJECT(WID(x)), #y,GTK_SIGNAL_FUNC(z),   NULL);
 
+
+/* Minimal size of the current glyph display window */
+#define MAX_W 65
+#define MAX_H 65
+
+
 extern  uint8_t DIA_vobsub(vobSubParam *param);
 //********************************************
 extern  GtkWidget *DIA_ocr(void);
@@ -87,6 +93,7 @@
 static GtkWidget *mainDisplay=NULL;
 static GtkWidget *smallDisplay=NULL;
 static uint32_t redraw_x,redraw_y;
+static uint32_t clipW=0,clipH=0;
 //********************************************
 //ReplyType glyphToText(admGlyph *glyph,admGlyph *head);
 static ReplyType setup(void);
@@ -138,7 +145,8 @@
     workArea=NULL;
     bitmap=NULL;
     sdata=NULL;
-    
+    clipW=0;
+    clipH=0;
 
     
 // Create UI && prepare callback
@@ -155,11 +163,15 @@
     
    
     gtk_widget_show(dialog);
+    //
+    
 //  disable
     
     mainDisplay=WID(drawingareaBitmap);
     smallDisplay=WID(drawingareaSmall);
     
+   
+    
     CONNECT(drawingareaBitmap,expose_event,gui_draw);
     CONNECT(drawingareaSmall,expose_event,gui_draw_small);
 
@@ -204,14 +216,15 @@
      }
     seqNum=1;   // Sub number in srt file
     oldw=oldh=0;
-
+    uint32_t eos;
     //******************    
     // Load all bitmaps
     //******************
     for(uint32_t i=0;i<nbSub;i++)
     {
             first=last=0;
-            bitmap=bitmapSource->getBitmap(i,&startTime, &endTime,&first,&last);
+            bitmap=bitmapSource->getBitmap(i,&startTime, &endTime,&first,&last,&eos);
+            if(eos) break;
             ADM_assert(last>=first);
             
             // something ?
@@ -267,6 +280,12 @@
              uint16_t hh,mm,ss,ms;
              ms2time(startTime, &hh, &mm, &ss, &ms);
              fprintf(out,"%02d:%02d:%02d,%03d --> ",hh,mm,ss,ms);
+             
+             // Update Timecode
+             char timeCode[100];
+             snprintf(timeCode,100,"%02d:%02d:%02d,%03d",hh,mm,ss,ms);
+             gtk_label_set_text(GTK_LABEL(WID(labelTime)),timeCode);
+             
              ms2time(endTime, &hh, &mm, &ss, &ms);
              fprintf(out,"%02d:%02d:%02d,%03d\n",hh,mm,ss,ms);
              fprintf(out,"%s\n\n",decodedString);
@@ -416,12 +435,20 @@
 {
     if(sw!=glyph->width || sh!=glyph->height)
     {
+    	
         if(sdata) delete [] sdata;
         sdata=NULL;
         sw=glyph->width;
         sh=glyph->height;
         sdata=new uint8_t[(sw*2+2)*(sh*2+2)];
-        gtk_widget_set_usize(smallDisplay, sw*2+2, sh*2+2);
+        clipW= sw*2+2;
+        clipH=  sh*2+2;
+#ifndef MAX
+        #define MAX(a,b) a>b?a:b
+#endif
+        clipW=MAX(MAX_W,clipW);
+        clipH=MAX(MAX_H,clipH);
+        gtk_widget_set_usize(smallDisplay, clipW,clipH);
     }
     uint32_t stride=sw*2+2;
     uint8_t *in=glyph->data;
@@ -449,15 +476,29 @@
 
 gboolean gui_draw_small(void)
 { 
+	if(clipW && clipH)
+	{
+		 gdk_draw_rectangle(smallDisplay->window,
+				 				smallDisplay->style->fg_gc[GTK_STATE_NORMAL],
+				 				1, // Filled
+		                        0,                          // X
+		                        0,                          // y
+		                        clipW,
+		                        clipH);
+		
+	
+	}
  if(sw && sh && sdata)
+ {
     gdk_draw_gray_image(smallDisplay->window, smallDisplay->style->fg_gc[GTK_STATE_NORMAL],
-                        0,                          // X
-                        0,                          // y
-                        sw*2+2,                          //width
-                        sh*2+2,                          //h*2, // heigth
+                        1,                          // X
+                        1,                          // y
+                        sw*2+1,                          //width
+                        sh*2+1,                          //h*2, // heigth
                         GDK_RGB_DITHER_NONE,
                         sdata, // buffer
                         sw*2+2 );
+ }
     return true;
 }
 

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp	2007-07-28 11:54:11 UTC (rev 3451)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp	2007-07-28 14:52:03 UTC (rev 3452)
@@ -50,7 +50,7 @@
 extern uint8_t DIA_vobsub(vobSubParam *param);
 
 static void cb_idx(void *foo);
-static void cleanupSub(vobSubParam *p);
+static void cleanupSub(ADM_OCR_SOURCE *p);
 /**
     \fn DIA_ocrGen
     \brief Dialog to select input & output files before calling the actual ocr engine
@@ -64,6 +64,14 @@
   admGlyph head(16,16);
   char *globalGlyph=NULL;
   uint32_t globalGlyphOn=0;
+  ADM_OCR_SOURCE source;
+  
+  memset(&source,0,sizeof(source));
+  
+  source.type=ADM_OCR_TYPE_VOBSUB;
+  source.subparam=&subparam;
+  
+  
   prefs->get(FEATURE_GLOBAL_GLYPH_ACTIVE,&globalGlyphOn);
   if(globalGlyphOn)
   {
@@ -96,7 +104,7 @@
   
         if( !diaFactoryRun(_("Select input and ouput files"),n,elems))
         {
-          cleanupSub(&subparam);
+          cleanupSub(&source);
           if(srtFileName )ADM_dezalloc(srtFileName);
           srtFileName=NULL;
           destroyGlyphTree(&head);
@@ -131,9 +139,9 @@
             printf("[GLYPH] Found %u glyph\n");
          }
         // We have our SRT and our idx/sub files : Go go go
-         ADM_OCR_SOURCE source;
-         source.type=ADM_OCR_TYPE_VOBSUB;
-         source.subparam=&subparam;
+         
+         
+         
         ADM_ocr_engine(source,srtFileName,&head);
         
         // Save glyph set 
@@ -154,7 +162,7 @@
             if(save) ADM_dezalloc(save);
         }
 
-  cleanupSub(&subparam);
+  cleanupSub(&source);
   if(srtFileName )ADM_dezalloc(srtFileName);
   srtFileName=NULL;
   destroyGlyphTree(&head);
@@ -170,9 +178,16 @@
   vobSubParam subparam={NULL,0,0};
   char *srtFileName=NULL;
   char *glyphFileName=NULL;
+  char *tsFileName=NULL;
   admGlyph head(16,16);
   char *globalGlyph=NULL;
   uint32_t globalGlyphOn=0;
+  uint32_t pid=0x96;
+  ADM_OCR_SOURCE source;
+  
+  memset(&source,0,sizeof(source));
+  source.type=ADM_OCR_TYPE_TS;
+  
   prefs->get(FEATURE_GLOBAL_GLYPH_ACTIVE,&globalGlyphOn);
   if(globalGlyphOn)
   {
@@ -190,13 +205,15 @@
   }
 _againX:  
   // Fist build a dialogFactory to get input and output files
+  diaElemFile     selectTs(1,&tsFileName,_("Input TS:"),NULL);
+  diaElemUInteger selectPid(&pid,_("Subtitle PID:"),0,255);
   diaElemFile     selectGlyph(1,&glyphFileName,_("Use glyphset (optional):"),NULL);  
   diaElemFile     selectSrt(1,&srtFileName,_("Output SRT file"),NULL);
   
-  diaElem *elems[]={&selectSrt,&selectGlyph};
+  diaElem *elems[]={&selectTs,&selectPid,&selectSrt,&selectGlyph};
   
   
-   uint32_t n=2;
+   uint32_t n=4;
    if(globalGlyph)
    {
      n--; // Remove glyph from dialog
@@ -204,7 +221,7 @@
   
         if( !diaFactoryRun(_("Select input and ouput files"),n,elems))
         {
-          cleanupSub(&subparam);
+          cleanupSub(&source);
           if(srtFileName )ADM_dezalloc(srtFileName);
           srtFileName=NULL;
           destroyGlyphTree(&head);
@@ -234,10 +251,11 @@
             }
             printf("[GLYPH] Found %u glyph\n");
          }
-        // We have our SRT and our idx/sub files : Go go go
-         ADM_OCR_SOURCE source;
-         source.type=ADM_OCR_TYPE_TS;
-         source.TsFile=NULL;
+        // We have our SRT and our TS file
+         
+  
+         source.TsFile=ADM_strdup(tsFileName);
+         source.TsPid=pid;
          ADM_ocr_engine(source,srtFileName,&head);
         
         // Save glyph set 
@@ -259,29 +277,51 @@
             if(save) ADM_dezalloc(save);
         }
 
-  cleanupSub(&subparam);
+  cleanupSub(&source);
   if(srtFileName )ADM_dezalloc(srtFileName);
   srtFileName=NULL;
+  
+  if(tsFileName )ADM_dezalloc(tsFileName);
+  tsFileName=NULL;
+  
   destroyGlyphTree(&head);
   return 1;  
 }
 /**
-
+		\fn 	cleanupSub
+		\brief 	Free all ressources allocated to source
 */
-void cleanupSub(vobSubParam *p)
+void cleanupSub(ADM_OCR_SOURCE *p)
 {
-  if(p->subname) ADM_dezalloc(p->subname);
-  p->subname=NULL; 
+  if(p->TsFile)
+  {
+	  	ADM_dezalloc(p->TsFile);
+	  	p->TsFile=NULL;
+  }
+  if(p->subparam)
+  {
+	  vobSubParam *subparam=p->subparam;
+	  if(subparam->subname)
+	  {
+		  ADM_dezalloc(subparam->subname);
+		  subparam->subname=NULL;
+	  }
+	  
+  }
   
 }
 /**
-
+	\fn cb_idx
+	\brief Callback to select sub/language/...
 */
 void cb_idx(void *foo)
 {
    vobSubParam *bar=(vobSubParam *)foo;
-   
-    cleanupSub(bar);
+   if(bar->subname)
+   	  {
+   		  ADM_dezalloc(bar->subname);
+   		  bar->subname=NULL;
+   	  }
     DIA_vobsub(bar);
 }
 //EOF

Modified: branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/ADM_vidDvbSub.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/ADM_vidDvbSub.cpp	2007-07-28 11:54:11 UTC (rev 3451)
+++ branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/ADM_vidDvbSub.cpp	2007-07-28 14:52:03 UTC (rev 3452)
@@ -213,11 +213,12 @@
                   printf("[DVBSUB]Box is outside image\n");
                   goto _skip;
               }
+#if 0
                   printf("x :%d\n",r->x);
                   printf("y :%d\n",r->y);
                   printf("w :%d\n",r->w);
                   printf("h :%d\n",r->h);
-
+#endif
                   {
                       uint32_t clipW,clipH;
                       
@@ -369,7 +370,9 @@
                           v=rgba2v(rgb)&0xff;
                           a=_a(rgb);
                           r->rgba_palette[col]=y+(u<<8)+(v<<16)+(a<<24);
+#if 0
                           printf("Color %d, alpha %u luma %u rgb:%x\n",col,a,y,rgb);
+#endif
               }
               // Palette is ready, display !
               if(r->x>_info.width || r->y>_info.height)
@@ -377,11 +380,12 @@
                   printf("[DVBSUB]Box is outside image\n");
                   goto _skipX;
               }
+#if 0
                   printf("x :%d\n",r->x);
                   printf("y :%d\n",r->y);
                   printf("w :%d\n",r->w);
                   printf("h :%d\n",r->h);
-
+#endif
                   {
                       uint32_t clipW,clipH;
                       



From mean at mail.berlios.de  Sat Jul 28 18:47:46 2007
From: mean at mail.berlios.de (mean at BerliOS)
Date: Sat, 28 Jul 2007 18:47:46 +0200
Subject: [Avidemux-svn-commit] r3453 - in
	branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces:
	ADM_GTK/ADM_dialog ADM_commonUI
Message-ID: <200707281647.l6SGlk8S014510@sheep.berlios.de>

Author: mean
Date: 2007-07-28 18:47:43 +0200 (Sat, 28 Jul 2007)
New Revision: 3453

Modified:
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_ocr.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp
Log:
[OCR] Cosmetic

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_ocr.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_ocr.cpp	2007-07-28 14:52:03 UTC (rev 3452)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_ocr.cpp	2007-07-28 16:47:43 UTC (rev 3453)
@@ -19,7 +19,6 @@
 #include "ADM_toolkit_gtk/toolkit_gtk.h"
 #include "ADM_toolkit_gtk/toolkit_gtk_include.h"
 
-
 GtkWidget*
 DIA_ocr (void)
 {
@@ -28,12 +27,12 @@
   GtkWidget *vbox1;
   GtkWidget *frame5;
   GtkWidget *table1;
-  GtkWidget *label8;
-  GtkWidget *label9;
   GtkWidget *labelNbGlyphs;
+  GtkWidget *labelTime;
   GtkWidget *labelNbLines;
+  GtkWidget *label9;
   GtkWidget *label15;
-  GtkWidget *labelTime;
+  GtkWidget *label8;
   GtkWidget *label7;
   GtkWidget *frameBitmap;
   GtkWidget *vbox7;
@@ -54,7 +53,10 @@
   GtkWidget *label12;
   GtkWidget *dialog_action_area1;
   GtkWidget *closebutton1;
+  GtkTooltips *tooltips;
 
+  tooltips = gtk_tooltips_new ();
+
   dialog1 = gtk_dialog_new ();
   gtk_window_set_title (GTK_WINDOW (dialog1), _("Mini OCR"));
   gtk_window_set_type_hint (GTK_WINDOW (dialog1), GDK_WINDOW_TYPE_HINT_DIALOG);
@@ -74,47 +76,50 @@
   gtk_widget_show (table1);
   gtk_container_add (GTK_CONTAINER (frame5), table1);
 
-  label8 = gtk_label_new (_("# of Glyphs :"));
-  gtk_widget_show (label8);
-  gtk_table_attach (GTK_TABLE (table1), label8, 0, 1, 0, 1,
-                    (GtkAttachOptions) (0),
-                    (GtkAttachOptions) (0), 0, 0);
-  gtk_misc_set_alignment (GTK_MISC (label8), 0, 0.5);
-
-  label9 = gtk_label_new (_("# of lines"));
-  gtk_widget_show (label9);
-  gtk_table_attach (GTK_TABLE (table1), label9, 0, 1, 1, 2,
-                    (GtkAttachOptions) (0),
-                    (GtkAttachOptions) (0), 0, 0);
-  gtk_misc_set_alignment (GTK_MISC (label9), 0, 0.5);
-
   labelNbGlyphs = gtk_label_new (_("0"));
   gtk_widget_show (labelNbGlyphs);
   gtk_table_attach (GTK_TABLE (table1), labelNbGlyphs, 1, 2, 0, 1,
-                    (GtkAttachOptions) (0),
+                    (GtkAttachOptions) (GTK_EXPAND | GTK_FILL),
                     (GtkAttachOptions) (0), 0, 0);
   gtk_misc_set_alignment (GTK_MISC (labelNbGlyphs), 0, 0.5);
 
+  labelTime = gtk_label_new (_("0:0:0"));
+  gtk_widget_show (labelTime);
+  gtk_table_attach (GTK_TABLE (table1), labelTime, 1, 2, 2, 3,
+                    (GtkAttachOptions) (GTK_EXPAND | GTK_FILL),
+                    (GtkAttachOptions) (0), 0, 0);
+  gtk_misc_set_alignment (GTK_MISC (labelTime), 0, 0.5);
+
   labelNbLines = gtk_label_new (_("0"));
   gtk_widget_show (labelNbLines);
   gtk_table_attach (GTK_TABLE (table1), labelNbLines, 1, 2, 1, 2,
-                    (GtkAttachOptions) (0),
+                    (GtkAttachOptions) (GTK_EXPAND | GTK_FILL),
                     (GtkAttachOptions) (0), 0, 0);
   gtk_misc_set_alignment (GTK_MISC (labelNbLines), 0, 0.5);
 
+  label9 = gtk_label_new (_("# of lines"));
+  gtk_widget_show (label9);
+  gtk_table_attach (GTK_TABLE (table1), label9, 0, 1, 1, 2,
+                    (GtkAttachOptions) (0),
+                    (GtkAttachOptions) (0), 0, 0);
+  gtk_label_set_justify (GTK_LABEL (label9), GTK_JUSTIFY_FILL);
+  gtk_misc_set_alignment (GTK_MISC (label9), 0, 0.5);
+
   label15 = gtk_label_new (_("TimeCode:"));
   gtk_widget_show (label15);
   gtk_table_attach (GTK_TABLE (table1), label15, 0, 1, 2, 3,
-                    (GtkAttachOptions) (GTK_FILL),
+                    (GtkAttachOptions) (0),
                     (GtkAttachOptions) (0), 0, 0);
+  gtk_label_set_justify (GTK_LABEL (label15), GTK_JUSTIFY_FILL);
   gtk_misc_set_alignment (GTK_MISC (label15), 0, 0.5);
 
-  labelTime = gtk_label_new (_("0:0:0"));
-  gtk_widget_show (labelTime);
-  gtk_table_attach (GTK_TABLE (table1), labelTime, 1, 2, 2, 3,
+  label8 = gtk_label_new (_("# of Glyphs :"));
+  gtk_widget_show (label8);
+  gtk_table_attach (GTK_TABLE (table1), label8, 0, 1, 0, 1,
                     (GtkAttachOptions) (GTK_FILL),
                     (GtkAttachOptions) (0), 0, 0);
-  gtk_misc_set_alignment (GTK_MISC (labelTime), 0, 0.5);
+  gtk_label_set_justify (GTK_LABEL (label8), GTK_JUSTIFY_FILL);
+  gtk_misc_set_alignment (GTK_MISC (label8), 0, 0.5);
 
   label7 = gtk_label_new (_("<b>Stats</b>"));
   gtk_widget_show (label7);
@@ -168,25 +173,29 @@
   gtk_widget_show (hbuttonbox1);
   gtk_box_pack_start (GTK_BOX (vbox7), hbuttonbox1, FALSE, FALSE, 0);
 
-  buttonCalibrate = gtk_button_new_with_mnemonic (_("Calibrate"));
+  buttonCalibrate = gtk_button_new_with_mnemonic (_("_Calibrate"));
   gtk_widget_show (buttonCalibrate);
   gtk_container_add (GTK_CONTAINER (hbuttonbox1), buttonCalibrate);
   GTK_WIDGET_SET_FLAGS (buttonCalibrate, GTK_CAN_DEFAULT);
+  gtk_tooltips_set_tip (tooltips, buttonCalibrate, _("If the glyphs are too thin, enter a lower value here"), NULL);
 
-  buttonSkipAll = gtk_button_new_with_mnemonic (_("Skip all"));
+  buttonSkipAll = gtk_button_new_with_mnemonic (_("S_kip all"));
   gtk_widget_show (buttonSkipAll);
   gtk_container_add (GTK_CONTAINER (hbuttonbox1), buttonSkipAll);
   GTK_WIDGET_SET_FLAGS (buttonSkipAll, GTK_CAN_DEFAULT);
+  gtk_tooltips_set_tip (tooltips, buttonSkipAll, _("Skip the whole image"), NULL);
 
   buttonSkip = gtk_button_new_with_mnemonic (_("Skip Glyph"));
   gtk_widget_show (buttonSkip);
   gtk_container_add (GTK_CONTAINER (hbuttonbox1), buttonSkip);
   GTK_WIDGET_SET_FLAGS (buttonSkip, GTK_CAN_DEFAULT);
+  gtk_tooltips_set_tip (tooltips, buttonSkip, _("Skip the current letter/glyph"), NULL);
 
-  buttonIgnore = gtk_button_new_with_mnemonic (_("Ignore glyph"));
+  buttonIgnore = gtk_button_new_with_mnemonic (_("_Ignore glyph"));
   gtk_widget_show (buttonIgnore);
   gtk_container_add (GTK_CONTAINER (hbuttonbox1), buttonIgnore);
   GTK_WIDGET_SET_FLAGS (buttonIgnore, GTK_CAN_DEFAULT);
+  gtk_tooltips_set_tip (tooltips, buttonIgnore, _("This glyph will be ignored from now on"), NULL);
 
   buttonOk = gtk_button_new_with_mnemonic (_("Ok"));
   gtk_widget_show (buttonOk);
@@ -222,12 +231,12 @@
   GLADE_HOOKUP_OBJECT (dialog1, vbox1, "vbox1");
   GLADE_HOOKUP_OBJECT (dialog1, frame5, "frame5");
   GLADE_HOOKUP_OBJECT (dialog1, table1, "table1");
-  GLADE_HOOKUP_OBJECT (dialog1, label8, "label8");
-  GLADE_HOOKUP_OBJECT (dialog1, label9, "label9");
   GLADE_HOOKUP_OBJECT (dialog1, labelNbGlyphs, "labelNbGlyphs");
+  GLADE_HOOKUP_OBJECT (dialog1, labelTime, "labelTime");
   GLADE_HOOKUP_OBJECT (dialog1, labelNbLines, "labelNbLines");
+  GLADE_HOOKUP_OBJECT (dialog1, label9, "label9");
   GLADE_HOOKUP_OBJECT (dialog1, label15, "label15");
-  GLADE_HOOKUP_OBJECT (dialog1, labelTime, "labelTime");
+  GLADE_HOOKUP_OBJECT (dialog1, label8, "label8");
   GLADE_HOOKUP_OBJECT (dialog1, label7, "label7");
   GLADE_HOOKUP_OBJECT (dialog1, frameBitmap, "frameBitmap");
   GLADE_HOOKUP_OBJECT (dialog1, vbox7, "vbox7");
@@ -248,6 +257,7 @@
   GLADE_HOOKUP_OBJECT (dialog1, label12, "label12");
   GLADE_HOOKUP_OBJECT_NO_REF (dialog1, dialog_action_area1, "dialog_action_area1");
   GLADE_HOOKUP_OBJECT (dialog1, closebutton1, "closebutton1");
+  GLADE_HOOKUP_OBJECT_NO_REF (dialog1, tooltips, "tooltips");
 
   return dialog1;
 }

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp	2007-07-28 14:52:03 UTC (rev 3452)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_ocr.cpp	2007-07-28 16:47:43 UTC (rev 3453)
@@ -227,7 +227,13 @@
           destroyGlyphTree(&head);
           return 0;
         }
-       // TODO Check input TS file
+        // TS file exists ?
+        if(!ADM_fileExist(tsFileName))
+        {
+        	  GUI_Error_HIG(_("File error"),_("Please Select a valid TS file."));
+        	  goto _againX;
+        }
+       
         if(!srtFileName || !*srtFileName)
         {
           GUI_Error_HIG(_("File error"),_("Please Select a valid output SRT file."));
@@ -252,8 +258,7 @@
             printf("[GLYPH] Found %u glyph\n");
          }
         // We have our SRT and our TS file
-         
-  
+        // Call the OCR engine...
          source.TsFile=ADM_strdup(tsFileName);
          source.TsPid=pid;
          ADM_ocr_engine(source,srtFileName,&head);



From mean at mail.berlios.de  Sat Jul 28 19:03:20 2007
From: mean at mail.berlios.de (mean at BerliOS)
Date: Sat, 28 Jul 2007 19:03:20 +0200
Subject: [Avidemux-svn-commit] r3454 - in branches/avidemux_2.4_branch: .
	cmake
Message-ID: <200707281703.l6SH3KpX028733@sheep.berlios.de>

Author: mean
Date: 2007-07-28 19:03:19 +0200 (Sat, 28 Jul 2007)
New Revision: 3454

Modified:
   branches/avidemux_2.4_branch/CMakeLists.txt
   branches/avidemux_2.4_branch/ConfigureChecks.cmake
   branches/avidemux_2.4_branch/cmake/FindArts.cmake
   branches/avidemux_2.4_branch/cmake/FindSubversion.cmake
   branches/avidemux_2.4_branch/cmake/Po.cmake
   branches/avidemux_2.4_branch/cmake/admSDL.cmake
   branches/avidemux_2.4_branch/cmake/adm_checkHeaderLib.cmake
   branches/avidemux_2.4_branch/cmake/adm_qt4.cmake
Log:
[CMAKE] Accept NO_${FEATURE} to disable stuff part 1, patch by ak+converted to unix end of line

Modified: branches/avidemux_2.4_branch/CMakeLists.txt
===================================================================
--- branches/avidemux_2.4_branch/CMakeLists.txt	2007-07-28 16:47:43 UTC (rev 3453)
+++ branches/avidemux_2.4_branch/CMakeLists.txt	2007-07-28 17:03:19 UTC (rev 3454)
@@ -1,209 +1,221 @@
-##########################################################
-# main cmake file for avidemux
-# Derived from the one available in sim-im & kde4
-##########################################################
-MESSAGE("#####################################")
-MESSAGE("Configure Started")
-MESSAGE("#####################################")
-PROJECT(Avidemux2)
-CMAKE_MINIMUM_REQUIRED(VERSION 2.4.4)
-SET(CMAKE_COLOR_MAKEFILE ON)
-
-# where to look first for cmake modules, before ${CMAKE_ROOT}/Modules/ is checked
-SET(CMAKE_MODULE_PATH "${CMAKE_SOURCE_DIR}/cmake")
-# XMingw ?
-OPTION(XMINGW FALSE)
-if(XMINGW)
-MESSAGE(STATUS "Xmingw set, forcing win32 target")
-SET(WIN32 1)
-endif(XMINGW)
-
-#**************************************************
-# MESSAGE
-#**************************************************
-SET(CMAKE_C_FLAGS $ENV{CFLAGS})
-SET(CMAKE_CXX_FLAGS $ENV{CXXFLAGS})
-
-MESSAGE("EXTRA Cflags:${CMAKE_C_FLAGS}")
-MESSAGE("EXTRA CXXflags:${CMAKE_CXX_FLAGS}")
-#*************************************************
-include(UsePkgConfig)
-include(MacroEnsureOutOfSourceBuild)
-
-include(Po)
-include(CheckCXXCompilerFlag)
-
-#**************************************************
-# Subversion
-#**************************************************
-if(NOT CMAKE_BUILD_TYPE STREQUAL "Debug")
-	MESSAGE(STATUS "<Checking for Subversion>")
-	MESSAGE(STATUS "<***********************>")
-	include(FindSubversion)
-
-	FIND_PACKAGE(Subversion)
-	IF(Subversion_FOUND)
-		Subversion_WC_INFO(${PROJECT_SOURCE_DIR} Project)
-		MESSAGE(STATUS "Current revision is ${Project_WC_REVISION}")
-		SET(ADM_SUBVERSION ${Project_WC_REVISION})
-	ELSE(Subversion_FOUND)
-		MESSAGE(STATUS "Could not find Subversion")
-	ENDIF(Subversion_FOUND)
-ENDIF(NOT CMAKE_BUILD_TYPE STREQUAL "Debug")
-
-IF(NOT Subversion_FOUND)
-	SET(ADM_SUBVERSION 0)
-ENDIF(NOT Subversion_FOUND)
-
-#**************************************************
-# libxml2
-#**************************************************
-MESSAGE(STATUS "<Checking for LibXML2>")
-MESSAGE(STATUS "<*********************>")
-include(FindLibXml2)
-if(NOT LIBXML2_FOUND)
-  MESSAGE(FATAL_ERROR "Could not find Libxml2")
-endif(NOT LIBXML2_FOUND)
-MESSAGE(STATUS "LibXML2 OK")
-SET(LIBXML2_DEFINITIONS,${LIBXML2_DEFINITIONS})
-SET(LIBXML2_INCLUDE_DIR,${LIBXML2_INCLUDE_DIR})
-#**************************************************
-# PKG Config
-#**************************************************
-MESSAGE(STATUS "<Checking for PKG-CONFIG>")
-MESSAGE(STATUS "<***********************>")
-if(NOT PKGCONFIG_EXECUTABLE)
-             MESSAGE(FATAL_ERROR "Could not find pkg-config")
-endif(NOT PKGCONFIG_EXECUTABLE)
-MESSAGE(STATUS "OK ${PKGCONFIG_EXECUTABLE}")
-#**************************************************
-# Search for FREETYPE
-#**************************************************
-MESSAGE(STATUS "<Checking for FreeType through PKG-CONFIG>")
-MESSAGE(STATUS "<****************************************>")
-PKGCONFIG(freetype2 FT_INCLUDE FT_LIB FT_LDFLAGS FT_CFLAGS)
-
-IF(NOT FT_INCLUDE)
-    MESSAGE(STATUS "Could not find Freetype ")
-ELSE(NOT FT_INCLUDE)
-    SET(FT_FOUND TRUE)
-    SET(FT_CFLAGS ${FT_CFLAGS})
-    SET(FT_LDFLAGS ${FT_LDFLAGS})
-    SET(FT_INCLUDE ${FT_INCLUDE})
-    MESSAGE(STATUS "LDFLAGS <${FT_LDFLAGS}>")
-    MESSAGE(STATUS "LIBS <${FT_LIB}>")
-    MESSAGE(STATUS OK)
-    MESSAGE(STATUS "FreeType Found ("${FT_CFLAGS} ${FT_INCLUDE}")")
-    
-ENDIF(NOT FT_INCLUDE)
-#**************************************************
-# Search for  X11 (not on windows)
-#**************************************************
-if(NOT WIN32)
-        MESSAGE(STATUS "<Checking for X11>")
-        MESSAGE(STATUS "<******************************>")
-        include(FindX11)
-        if(NOT X11_FOUND)
-             MESSAGE(FATAL_ERROR "Could not find X11")
-        endif(NOT X11_FOUND)
-        MESSAGE(STATUS OK)
-endif(NOT WIN32)
-#**************************************************
-# Search for GLIB through PKG-Config
-#**************************************************
-MESSAGE(STATUS "<Checking for GLIB>")
-MESSAGE(STATUS "<******************************>")
-PKGCONFIG(glib-2.0 GLIB_INCLUDE GLIB_LIB GLIB_LDFLAGS GLIB_CFLAGS)
-
-IF(NOT GLIB_INCLUDE)
-    MESSAGE(STATUS "Could not find GLIB - cannot compile avidemux2_gtk here")
-ELSE(NOT GLIB_INCLUDE)
-    SET(GLIB_FOUND,TRUE)
-    SET(GLIB_CFLAGS,${GLIB_CFLAGS})
-    SET(GLIB_LDFLAGS,${GLIB_LDFLAGS})
-    SET(GLIB_LIB,${GLIB_LIB})
-    MESSAGE(STATUS OK)
-    MESSAGE("GLIB Found ("${GLIB_CFLAGS}")")
-    
-ENDIF(NOT GLIB_INCLUDE)
-#**************************************************
-# Search for GTK through PKG-Config
-#**************************************************
-MESSAGE(STATUS "<Checking for GTK>")
-MESSAGE(STATUS "<******************************>")
-PKGCONFIG(gtk+-2.0 GTK_INCLUDE GTK_LIB GTK_LDFLAGS GTK_CFLAGS)
-
-IF(NOT GTK_CFLAGS)
-    MESSAGE(STATUS "Could not find GTK - cannot compile avidemux2_gtk here")
-ELSE(NOT GTK_CFLAGS)
-    SET(GTK_FOUND TRUE)
-    SET(GTK_CFLAGS,${GTK_CFLAGS})
-    SET(GTK_LDFLAGS,${GTK_LDFLAGS})
-    SET(GTK_LIB,${GTK_LIB})
-    MESSAGE(STATUS OK)
-ENDIF(NOT GTK_CFLAGS)
-#**************************************************
-# Search for Gthread through PKG-Config
-#**************************************************
-MESSAGE(STATUS "<Checking for Gthread>")
-MESSAGE(STATUS "<******************************>")
-PKGCONFIG(gthread-2.0 GTHREAD_INCLUDE GTHREAD_LIB GTHREAD_LDFLAGS GTHREAD_CFLAGS)
-
-IF(NOT GTHREAD_CFLAGS)
-    MESSAGE(STATUS "Could not find GTHREAD")
-    SET(GTK_FOUND FALSE)
-ELSE(NOT GTHREAD_CFLAGS)
-    SET(GTHREAD_LDFLAGS,${GTHREAD_LDFLAGS})
-    MESSAGE(STATUS "OK ${GTHREAD_LDFLAGS}")
-ENDIF(NOT GTHREAD_CFLAGS)
-#**************************************************
-# Search for QT4 
-#**************************************************
-MESSAGE(STATUS "<Checking for QT4>")
-MESSAGE(STATUS "<******************************>")
-include(FindQt4)
-if(QT4_FOUND AND MINGW)
-if(XMINGW) # Cross compile ?
-        SET(QTXM /rot2/qt_4.3)
-        #
-	SET(QT_QMAKE_EXECUTABLE qmake)
-	SET(QT_UIC_EXECUTABLE uic-qt4)
-	SET(QT_MOC_EXECUTABLE moc-qt4)
-	SET(QT_RCC_EXECUTABLE rcc)
-	SET(QT_QTGUI_LIBRARY QtGui4 ) # FIXME
-        SET(QT_QTCORE_LIBRARY QtCore4 ) # FIXME
-
-        SET(CMAKE_CXX_FLAGS "-I${QTXM}/include ${CMAKE_CXX_FLAGS}")
-        LINK_DIRECTORIES(${QTXM}/bin)
-        LINK_DIRECTORIES(${QTXM}/lib)
-
-else(XMINGW)
-	MESSAGE(STATUS "** MINGW ** OVERRIDING PATH FOR QT4 You may have to edit CMakeLists.txt!!!")
-	SET(QT_QMAKE_EXECUTABLE qmake)
-	SET(QT_UIC_EXECUTABLE uic)
-	SET(QT_MOC_EXECUTABLE moc)
-	SET(QT_RCC_EXECUTABLE rcc)
-endif(XMINGW)
-endif(QT4_FOUND AND MINGW)
-
-# do config checks
-include(ConfigureChecks.cmake)
-
-# create config.h
-CONFIGURE_FILE(config.h.cmake ${CMAKE_CURRENT_BINARY_DIR}/config.h)
-# #
- include_DIRECTORIES(${CMAKE_CURRENT_BINARY_DIR} ${CMAKE_SOURCE_DIR}/avidemux ${CMAKE_SOURCE_DIR}/avidemux/ADM_libraries)
- include_directories(${CMAKE_SOURCE_DIR}/avidemux/ADM_libraries/ADM_utilities/ ${CMAKE_SOURCE_DIR}/avidemux/ADM_libraries/ADM_lavutil)
- include_directories(${CMAKE_SOURCE_DIR}/avidemux/ADM_libraries/ADM_lavcodec  )
-#**********************************************
-# Some CFLAGS
-#**********************************************
-add_definitions (-D_FILE_OFFSET_BITS=64 -D_LARGE_FILES)
-add_definitions( -DHAVE_CONFIG_H )
-
-ADD_SUBDIRECTORY(avidemux)
-
-###############################
-# Summary
-###############################
-include(conf_summary)
+##########################################################
+# main cmake file for avidemux
+# Derived from the one available in sim-im & kde4
+##########################################################
+MESSAGE("#####################################")
+MESSAGE("Configure Started")
+MESSAGE("#####################################")
+PROJECT(Avidemux2)
+CMAKE_MINIMUM_REQUIRED(VERSION 2.4.4)
+SET(CMAKE_COLOR_MAKEFILE ON)
+
+# where to look first for cmake modules, before ${CMAKE_ROOT}/Modules/ is checked
+SET(CMAKE_MODULE_PATH "${CMAKE_SOURCE_DIR}/cmake")
+# XMingw ?
+OPTION(XMINGW FALSE)
+if(XMINGW)
+MESSAGE(STATUS "Xmingw set, forcing win32 target")
+SET(WIN32 1)
+endif(XMINGW)
+
+#**************************************************
+# MESSAGE
+#**************************************************
+SET(CMAKE_C_FLAGS $ENV{CFLAGS})
+SET(CMAKE_CXX_FLAGS $ENV{CXXFLAGS})
+
+MESSAGE("EXTRA Cflags:${CMAKE_C_FLAGS}")
+MESSAGE("EXTRA CXXflags:${CMAKE_CXX_FLAGS}")
+#*************************************************
+include(UsePkgConfig)
+include(MacroEnsureOutOfSourceBuild)
+
+include(Po)
+include(CheckCXXCompilerFlag)
+
+#**************************************************
+# Subversion
+#**************************************************
+if(NOT CMAKE_BUILD_TYPE STREQUAL "Debug")
+	MESSAGE(STATUS "<Checking for Subversion>")
+	MESSAGE(STATUS "<***********************>")
+	include(FindSubversion)
+
+	FIND_PACKAGE(Subversion)
+	IF(Subversion_FOUND)
+		Subversion_WC_INFO(${PROJECT_SOURCE_DIR} Project)
+		MESSAGE(STATUS "Current revision is ${Project_WC_REVISION}")
+		SET(ADM_SUBVERSION ${Project_WC_REVISION})
+	ELSE(Subversion_FOUND)
+		MESSAGE(STATUS "Could not find Subversion")
+	ENDIF(Subversion_FOUND)
+ENDIF(NOT CMAKE_BUILD_TYPE STREQUAL "Debug")
+
+IF(NOT Subversion_FOUND)
+	SET(ADM_SUBVERSION 0)
+ENDIF(NOT Subversion_FOUND)
+
+#**************************************************
+# libxml2
+#**************************************************
+MESSAGE(STATUS "<Checking for LibXML2>")
+MESSAGE(STATUS "<*********************>")
+include(FindLibXml2)
+if(NOT LIBXML2_FOUND)
+  MESSAGE(FATAL_ERROR "Could not find Libxml2")
+endif(NOT LIBXML2_FOUND)
+MESSAGE(STATUS "LibXML2 OK")
+SET(LIBXML2_DEFINITIONS,${LIBXML2_DEFINITIONS})
+SET(LIBXML2_INCLUDE_DIR,${LIBXML2_INCLUDE_DIR})
+#**************************************************
+# PKG Config
+#**************************************************
+MESSAGE(STATUS "<Checking for PKG-CONFIG>")
+MESSAGE(STATUS "<***********************>")
+if(NOT PKGCONFIG_EXECUTABLE)
+             MESSAGE(FATAL_ERROR "Could not find pkg-config")
+endif(NOT PKGCONFIG_EXECUTABLE)
+MESSAGE(STATUS "OK ${PKGCONFIG_EXECUTABLE}")
+#**************************************************
+# Search for FREETYPE
+#**************************************************
+MESSAGE(STATUS "<Checking for FreeType through PKG-CONFIG>")
+MESSAGE(STATUS "<****************************************>")
+if(NO_FREETYPE)
+message(status "<disabled per request>")
+else(NO_FREETYPE)
+PKGCONFIG(freetype2 FT_INCLUDE FT_LIB FT_LDFLAGS FT_CFLAGS)
+
+IF(NOT FT_INCLUDE)
+    MESSAGE(STATUS "Could not find Freetype ")
+ELSE(NOT FT_INCLUDE)
+    SET(FT_FOUND TRUE)
+    SET(FT_CFLAGS ${FT_CFLAGS})
+    SET(FT_LDFLAGS ${FT_LDFLAGS})
+    SET(FT_INCLUDE ${FT_INCLUDE})
+    MESSAGE(STATUS "LDFLAGS <${FT_LDFLAGS}>")
+    MESSAGE(STATUS "LIBS <${FT_LIB}>")
+    MESSAGE(STATUS OK)
+    MESSAGE(STATUS "FreeType Found ("${FT_CFLAGS} ${FT_INCLUDE}")")
+    
+ENDIF(NOT FT_INCLUDE)
+endif(NO_FREETYPE)
+#**************************************************
+# Search for  X11 (not on windows)
+#**************************************************
+if(NOT WIN32)
+        MESSAGE(STATUS "<Checking for X11>")
+        MESSAGE(STATUS "<******************************>")
+        include(FindX11)
+        if(NOT X11_FOUND)
+             MESSAGE(FATAL_ERROR "Could not find X11")
+        endif(NOT X11_FOUND)
+        MESSAGE(STATUS OK)
+endif(NOT WIN32)
+#**************************************************
+# Search for GLIB through PKG-Config
+#**************************************************
+MESSAGE(STATUS "<Checking for GLIB>")
+MESSAGE(STATUS "<******************************>")
+PKGCONFIG(glib-2.0 GLIB_INCLUDE GLIB_LIB GLIB_LDFLAGS GLIB_CFLAGS)
+
+IF(NOT GLIB_INCLUDE)
+    MESSAGE(STATUS "Could not find GLIB - cannot compile avidemux2_gtk here")
+ELSE(NOT GLIB_INCLUDE)
+    SET(GLIB_FOUND,TRUE)
+    SET(GLIB_CFLAGS,${GLIB_CFLAGS})
+    SET(GLIB_LDFLAGS,${GLIB_LDFLAGS})
+    SET(GLIB_LIB,${GLIB_LIB})
+    MESSAGE(STATUS OK)
+    MESSAGE("GLIB Found ("${GLIB_CFLAGS}")")
+    
+ENDIF(NOT GLIB_INCLUDE)
+#**************************************************
+# Search for GTK through PKG-Config
+#**************************************************
+MESSAGE(STATUS "<Checking for GTK>")
+MESSAGE(STATUS "<******************************>")
+if(NO_GTK)
+message(status "<disabled per request>")
+else(NO_GTK)
+PKGCONFIG(gtk+-2.0 GTK_INCLUDE GTK_LIB GTK_LDFLAGS GTK_CFLAGS)
+
+IF(NOT GTK_CFLAGS)
+    MESSAGE(STATUS "Could not find GTK - cannot compile avidemux2_gtk here")
+ELSE(NOT GTK_CFLAGS)
+    SET(GTK_FOUND TRUE)
+    SET(GTK_CFLAGS,${GTK_CFLAGS})
+    SET(GTK_LDFLAGS,${GTK_LDFLAGS})
+    SET(GTK_LIB,${GTK_LIB})
+    MESSAGE(STATUS OK)
+ENDIF(NOT GTK_CFLAGS)
+endif(NO_GTK)
+#**************************************************
+# Search for Gthread through PKG-Config
+#**************************************************
+MESSAGE(STATUS "<Checking for Gthread>")
+MESSAGE(STATUS "<******************************>")
+PKGCONFIG(gthread-2.0 GTHREAD_INCLUDE GTHREAD_LIB GTHREAD_LDFLAGS GTHREAD_CFLAGS)
+
+IF(NOT GTHREAD_CFLAGS)
+    MESSAGE(STATUS "Could not find GTHREAD")
+    SET(GTK_FOUND FALSE)
+ELSE(NOT GTHREAD_CFLAGS)
+    SET(GTHREAD_LDFLAGS,${GTHREAD_LDFLAGS})
+    MESSAGE(STATUS "OK ${GTHREAD_LDFLAGS}")
+ENDIF(NOT GTHREAD_CFLAGS)
+#**************************************************
+# Search for QT4 
+#**************************************************
+MESSAGE(STATUS "<Checking for QT4>")
+MESSAGE(STATUS "<******************************>")
+if(NO_QT4)
+message(status "<disabled per request>")
+else(NO_QT4)
+include(FindQt4)
+if(QT4_FOUND AND MINGW)
+if(XMINGW) # Cross compile ?
+        SET(QTXM /rot2/qt_4.3)
+        #
+	SET(QT_QMAKE_EXECUTABLE qmake)
+	SET(QT_UIC_EXECUTABLE uic-qt4)
+	SET(QT_MOC_EXECUTABLE moc-qt4)
+	SET(QT_RCC_EXECUTABLE rcc)
+	SET(QT_QTGUI_LIBRARY QtGui4 ) # FIXME
+        SET(QT_QTCORE_LIBRARY QtCore4 ) # FIXME
+
+        SET(CMAKE_CXX_FLAGS "-I${QTXM}/include ${CMAKE_CXX_FLAGS}")
+        LINK_DIRECTORIES(${QTXM}/bin)
+        LINK_DIRECTORIES(${QTXM}/lib)
+
+else(XMINGW)
+	MESSAGE(STATUS "** MINGW ** OVERRIDING PATH FOR QT4 You may have to edit CMakeLists.txt!!!")
+	SET(QT_QMAKE_EXECUTABLE qmake)
+	SET(QT_UIC_EXECUTABLE uic)
+	SET(QT_MOC_EXECUTABLE moc)
+	SET(QT_RCC_EXECUTABLE rcc)
+endif(XMINGW)
+endif(QT4_FOUND AND MINGW)
+endif(NO_QT4)
+
+# do config checks
+include(ConfigureChecks.cmake)
+
+# create config.h
+CONFIGURE_FILE(config.h.cmake ${CMAKE_CURRENT_BINARY_DIR}/config.h)
+# #
+ include_DIRECTORIES(${CMAKE_CURRENT_BINARY_DIR} ${CMAKE_SOURCE_DIR}/avidemux ${CMAKE_SOURCE_DIR}/avidemux/ADM_libraries)
+ include_directories(${CMAKE_SOURCE_DIR}/avidemux/ADM_libraries/ADM_utilities/ ${CMAKE_SOURCE_DIR}/avidemux/ADM_libraries/ADM_lavutil)
+ include_directories(${CMAKE_SOURCE_DIR}/avidemux/ADM_libraries/ADM_lavcodec  )
+#**********************************************
+# Some CFLAGS
+#**********************************************
+add_definitions (-D_FILE_OFFSET_BITS=64 -D_LARGE_FILES)
+add_definitions( -DHAVE_CONFIG_H )
+
+ADD_SUBDIRECTORY(avidemux)
+
+###############################
+# Summary
+###############################
+include(conf_summary)

Modified: branches/avidemux_2.4_branch/ConfigureChecks.cmake
===================================================================
--- branches/avidemux_2.4_branch/ConfigureChecks.cmake	2007-07-28 16:47:43 UTC (rev 3453)
+++ branches/avidemux_2.4_branch/ConfigureChecks.cmake	2007-07-28 17:03:19 UTC (rev 3454)
@@ -1,429 +1,445 @@
-###############################
-# Part Of avidemux cmake conf #
-###############################
-##
-INCLUDE(CheckIncludeFiles)
-INCLUDE(CheckSymbolExists)
-INCLUDE(CheckFunctionExists)
-INCLUDE(CheckLibraryExists)
-include(lavcodec)
-include(CMakeDetermineSystem)
-include(adm_checkHeaderLib)
-include(adm_compile)
-#INCLUDE(CheckStructMember)
-check_function_exists(gettimeofday    HAVE_GETTIMEOFDAY)
-# Header
-CHECK_INCLUDE_FILES(inttypes.h      HAVE_INTTYPES_H)                    # simapi.h
-CHECK_INCLUDE_FILES(stddef.h        HAVE_STDDEF_H)                      # simapi.h
-CHECK_INCLUDE_FILES(stdint.h        HAVE_STDINT_H)                      # simapi.h
-CHECK_INCLUDE_FILES(stdlib.h        HAVE_STDLIB_H)                      # simapi.h
-CHECK_INCLUDE_FILES(string.h        HAVE_STRING_H)                      # _core/libintl.cpp
-CHECK_INCLUDE_FILES(sys/stat.h      HAVE_SYS_STAT_H)                    # gpg/gpg.cpp
-CHECK_INCLUDE_FILES(sys/types.h     HAVE_SYS_TYPES_H)                   # simapi.h
-CHECK_INCLUDE_FILES(unistd.h        HAVE_UNISTD_H)                      # simapi.h
-CHECK_INCLUDE_FILES(malloc.h        HAVE_MALLOC_H)                      # simapi.h
-CHECK_INCLUDE_FILES(libintl.h       HAVE_LIBINTL_H)                      # simapi.h
-# Set lavcodec/util/format configuration
-SET_LAVCODEC_FLAGS()
-
-# Symbols
-CHECK_SYMBOL_EXISTS(strcasecmp  "strings.h"         HAVE_STRCASECMP)    # simapi.h, various
-
-# Functions
-IF(NOT WIN32) # there is a chmod function on win32, but not usable the way we want...
-  CHECK_FUNCTION_EXISTS(chmod     HAVE_CHMOD)         # __homedir/homedir.cpp, gpg/gpg.cpp
-ENDIF(NOT WIN32)
-# VERSION(s)
-SET(VERSION 2.4)
-SET(PACKAGE_VERSION 2.4)
-
-# We use FFMPEG
-SET(ENABLE_THREADS    1)
-SET(USE_MP3    1)
-SET(USE_AC3    1)
-SET(USE_FFMPEG    1)
-SET(USE_MJPEG    1)
-SET(USE_LIBXML2    1)
-SET(HAVE_LRINTF    1)
-SET(EMULATE_FAST_INT    1)
-SET(RUNTIME_CPUDETECT    1)
-
-
-
-########################################
-# taist : Should fail!
-########################################
-ADM_CHECK_HL(teist larreme.h mzfdgp3lame lagggme_icnit HAVE_LzertgIBMP3LAME)
-if(HAVE_LzertgIBMP3LAME)
-  MESSAGE(FATAL "THAT TEST SHOULD HAVE FAILED EXPECT PROBLEM")
-endif(HAVE_LzertgIBMP3LAME)
-
-########################################
-# Gettext
-########################################
-if(HAVE_LIBINTL_H)
-  MESSAGE(STATUS "<Checking gettext >")
-  MESSAGE(STATUS "<**************** >")
-# Try linking without -lintl
-  ADM_COMPILE( gettext.cpp "" "" WITHOUT_LIBINTL outputWithoutLibintl)
-  if(WITHOUT_LIBINTL)
-      SET(HAVE_GETTEXT 1)
-      MESSAGE(STATUS "Ok, No lib needed (${ADM_GETTEXT_LIB})")
-  else(WITHOUT_LIBINTL)
-      ADM_COMPILE( gettext.cpp "" "-lintl" WITH_LIBINTL outputWithLibintl)
-      if(WITH_LIBINTL)
-        SET(ADM_GETTEXT_LIB "-lintl")
-        SET(HAVE_GETTEXT 1)
-        MESSAGE(STATUS "Ok, libintl needed")
-      else(WITH_LIBINTL)
-        MESSAGE(STATUS "Does not work, without ${outputWithoutLibintl}")
-        MESSAGE(STATUS "Does not work, with    ${outputWithLibintl}")
-      endif(WITH_LIBINTL)
-  endif(WITHOUT_LIBINTL)
-endif(HAVE_LIBINTL_H)
-########################################
-# Locale
-########################################
-SET(ADM_LOCALE "${CMAKE_INSTALL_PREFIX}/share/locale")
-########################################
-# WIN32
-########################################
-if(WIN32)
-SET(WIN32_DEF 1)
-else(WIN32)
-SET(WIN32_DEF 0)
-endif(WIN32)
-########################################
-# MacIntel
-########################################
-if(CMAKE_OSX_SYSROOT)
-  SET(ADM_BSD_FAMILY 1)
-#  SET(CYG_MANGLING 1)
-endif(CMAKE_OSX_SYSROOT)
-
-########################################
-# ALSA
-########################################
-if(NOT WIN32 AND NOT CMAKE_OSX_SYSROOT)
-  MESSAGE(STATUS "<Checking for ALSA>")
-  MESSAGE(STATUS "<*****************>")
-  include(FindAlsa)
-  if(ALSA_FOUND)
-    ALSA_VERSION_STRING(alsaVersion)
-    MESSAGE("Found alsa version :${alsaVersion}") 
-    MESSAGE("Found alsa lib     :${ASOUND_LIBRARY}")
-    SET(ALSA_SUPPORT 1)
-    SET(ALSA_1_0_SUPPORT 1)
-  endif(ALSA_FOUND)
-endif(NOT WIN32 AND NOT CMAKE_OSX_SYSROOT)
-########################################
-# SDL
-########################################
-MESSAGE(STATUS "<Checking for SDL>")
-MESSAGE(STATUS "<*****************>")
-#include(FindSDL)
-include(admSDL)
-ADM_FIND_SDL()
-if(SDL_FOUND)
- SET(USE_SDL 1)
- MESSAGE(STATUS "Found")
-else(SDL_FOUND)
-  MESSAGE(STATUS "Not Found")
-endif(SDL_FOUND)
-########################################
-# FONTCONFIG
-########################################
-ADM_CHECK_HL(FontConfig fontconfig/fontconfig.h fontconfig FcStrSetCreate USE_FONTCONFIG)
-if(USE_FONTCONFIG)
-SET(HAVE_FONTCONFIG 1)
-endif(USE_FONTCONFIG)
-########################################
-# Xvideo
-########################################
-if(NOT WIN32)
-
-SET(CMAKE_REQUIRED_FLAGS "-include X11/Xlib.h")
-SET(CMAKE_REQUIRED_LIBRARIES "${X11_LIBRARIES}")
-SET(CMAKE_REQUIRED_INCLUDE "${X11_INCLUDE_DIR}")
-
-ADM_CHECK_HL(Xvideo X11/extensions/Xvlib.h Xv XvShmPutImage USE_XV)
-MESSAGE(STATUS "(i used ${CMAKE_REQUIRED_FLAGS}**${X11_INCLUDE_DIR})")
-MESSAGE(STATUS "(and ${CMAKE_REQUIRED_LIBRARIES}**${X11_LIBRARIES})")
-
-SET(CMAKE_REQUIRED_FLAGS )
-SET(CMAKE_REQUIRED_LIBRARIES )
-SET(CMAKE_REQUIRED_INCLUDE )
-
-
-endif(NOT WIN32)
-########################################
-# OSS
-########################################
-
-if(NOT WIN32)
-MESSAGE(STATUS "<Checking for OSS>")
-MESSAGE(STATUS "<*****************>")
-CHECK_INCLUDE_FILES(sys/soundcard.h      OSS_SUPPORT)
-if(OSS_SUPPORT)
-MESSAGE(STATUS "Found")
-else(OSS_SUPPORT)
-MESSAGE(STATUS "Not found")
-endif(OSS_SUPPORT)
-
-endif(NOT WIN32)
-########################################
-# ARTS
-########################################
-if(NOT WIN32)
-include(FindArts)
-endif(NOT WIN32)
-
-########################################
-# ESD
-########################################
-if(NOT WIN32)
-ADM_CHECK_HL(Esd esd.h  esd esd_close USE_ESD)
-endif(NOT WIN32)
-########################################
-# JACK
-########################################
-if(NOT WIN32)
-ADM_CHECK_HL(Jack jack/jack.h  jack jack_client_close USE_JACK)
-endif(NOT WIN32)
-########################################
-# Aften
-########################################
-if(WIN32)
-SET(CMAKE_REQUIRED_FLAGS "-lm -lpthreadGC2")
-else(WIN32)
-SET(CMAKE_REQUIRED_FLAGS "-lm -lpthread")
-endif(WIN32)
-
-ADM_CHECK_HL(Aften aften/aften.h  aften aften_encode_init USE_AFTEN)
-if(USE_AFTEN)
-# TODO! Check aften version 5/6/7!
-SET(USE_AFTEN_07 1)
-endif(USE_AFTEN)
-SET(CMAKE_REQUIRED_FLAGS "")
-########################################
-# SRC
-########################################
-ADM_CHECK_HL(libsamplerate samplerate.h samplerate src_get_version USE_SRC)
-########################################
-# ICONV
-########################################
-# search ICON.h
-MESSAGE(STATUS "<Checking for iconv.h>")
-MESSAGE(STATUS "<******************************>")
-CHECK_INCLUDE_FILES(iconv.h HAVE_ICONV_H)
-if(NOT HAVE_ICONV_H)
-  MESSAGE(FATAL "iconv.h not found")
-endif(NOT HAVE_ICONV_H)
-
-# need libiconv ?
-CHECK_LIBRARY_EXISTS(iconv libiconv "" LINK_WITH_ICONV)
-if(LINK_WITH_ICONV)
-  SET(NEED_LIBICONV 1)
-  MESSAGE(STATUS "libiconv found, probably needed")
-else(LINK_WITH_ICONV)
-  MESSAGE(STATUS "libiconv not found, probably not needed")
-endif(LINK_WITH_ICONV)
-
-#
-MESSAGE(STATUS "<Checking if iconv needs const>")
-
-if(NEED_LIBICONV)
-ADM_COMPILE_WITH_WITHOUT(iconv_check.cpp "-DICONV_NEED_CONST" "-liconv" ICONV_WITH)
-else(NEED_LIBICONV)
-ADM_COMPILE_WITH_WITHOUT(iconv_check.cpp "-DICONV_NEED_CONST" "-lm" ICONV_WITH)
-endif(NEED_LIBICONV)
-
-if(ICONV_WITH)
-  MESSAGE(STATUS "Yes")
-  SET(ICONV_NEED_CONST 1)
-else(ICONV_WITH)
-    MESSAGE(STATUS "No")
-endif(ICONV_WITH)
-########################################
-# LAME
-########################################
-SET(CMAKE_REQUIRED_LIBRARIES "-lm")
-ADM_CHECK_HL(Lame lame/lame.h mp3lame lame_init HAVE_LIBMP3LAME)
-SET(CMAKE_REQUIRED_LIBRARIES )
-########################################
-# Xvid
-########################################
-ADM_CHECK_HL(Xvid xvid.h xvidcore xvid_plugin_single USE_XVID_4)
-########################################
-# AMR_NB
-########################################
-if(USE_LATE_BINDING)
-	CHECK_INCLUDE_FILES(amrnb/interf_dec.h USE_AMR_NB)
-else(USE_LATE_BINDING)
-	ADM_CHECK_HL(AMRNB amrnb/interf_dec.h amrnb GP3Decoder_Interface_Decode USE_AMR_NB)
-endif(USE_LATE_BINDING)
-
-if(USE_AMR_NB)
-	SET(CONFIG_AMR_NB 1)
-endif(USE_AMR_NB)
-########################################
-# Libdca
-########################################
-SET(CMAKE_REQUIRED_FLAGS "-include stdint.h")
-SET(CMAKE_REQUIRED_LIBRARIES "-lm")
-
-if(USE_LATE_BINDING)
-	CHECK_INCLUDE_FILES(dts.h USE_LIBDCA)
-else(USE_LATE_BINDING)
-	ADM_CHECK_HL(libdca dts.h dts dts_init USE_LIBDCA)
-endif(USE_LATE_BINDING)
-
-SET(CMAKE_REQUIRED_LIBRARIES)
-SET(CMAKE_REQUIRED_FLAGS)
-########################################
-# X264
-########################################
-SET(CMAKE_REQUIRED_FLAGS "-include stdint.h")
-
-if(WIN32)
-SET(CMAKE_REQUIRED_LIBRARIES "-lm -lpthreadGC2")
-else(WIN32)
-SET(CMAKE_REQUIRED_LIBRARIES "-lm -lpthread")
-endif(WIN32)
-
-ADM_CHECK_HL(x264 x264.h x264 x264_encoder_open USE_X264)
-SET(CMAKE_REQUIRED_FLAGS)
-SET(CMAKE_REQUIRED_LIBRARIES)
-########################################
-# PNG
-########################################
-ADM_CHECK_HL(libPNG png.h png png_malloc USE_PNG)
-
-
-########################################
-# FAAD
-########################################
-
-ADM_CHECK_HL(FAAD faad.h faad faacDecInit USE_FAAD_P)
-if(NOT USE_FAAD_P)
- MESSAGE(STATUS "Trying neaac variant")
- ADM_CHECK_HL(NeAAC faad.h faad NeAACDecInit USE_FAAD_A)
-endif(NOT USE_FAAD_P)
-if(USE_FAAD_P OR USE_FAAD_A)
-  SET(USE_FAAD  1)
-endif(USE_FAAD_P OR USE_FAAD_A)
-# See if we need old FAAD or NEW
-if(USE_FAAD)
-MESSAGE(STATUS "<Checking if faad needs old proto>")
-ADM_COMPILE_WITH_WITHOUT(faad_check.cpp "-DOLD_FAAD_PROTO" "-lfaad" FAAD_WITH)
-if(FAAD_WITH)
-  MESSAGE(STATUS "Yes")
-  SET(OLD_FAAD_PROTO 1)
-else(FAAD_WITH)
-    MESSAGE(STATUS "No")
-endif(FAAD_WITH)
-endif(USE_FAAD)
-########################################
-# FAAC
-########################################
-SET(CMAKE_REQUIRED_FLAGS "-include stdint.h")
-ADM_CHECK_HL(FAAC faac.h faac faacEncClose USE_FAAC)
-SET(CMAKE_REQUIRED_FLAGS)
-########################################
-# FreeType
-########################################
-if(FT_FOUND)
-SET(USE_FREETYPE 1)
-endif(FT_FOUND)
-########################################
-# Vorbis
-########################################
-
- ADM_CHECK_HL(Vorbis vorbis/vorbisenc.h vorbis vorbis_info_init USE_VORBIS1)
- ADM_CHECK_HL(Vorbis vorbis/vorbisenc.h vorbisenc vorbis_encode_init USE_VORBIS2)
- if(USE_VORBIS1 AND USE_VORBIS2)
-   SET(USE_VORBIS 1)
- endif(USE_VORBIS1 AND USE_VORBIS2)
-
-########################################
-# End test
-########################################
-
- ADM_CHECK_HL(Invalid dummy_header.h dummy_libxyz dummy_func_tyu DUMMY_TEST)
- ADM_CHECK_HL(Invalid stdio.h dummy_libxyz dummy_func_tyu DUMMY_TEST2)
- if(DUMMY_TEST OR DUMMY_TEST2)
-   MESSAGE(FATAL "This test should have failed!!!")
-   MESSAGE(FATAL "This test should have failed!!!")
-   MESSAGE(FATAL "This test should have failed!!!")
- endif(DUMMY_TEST OR DUMMY_TEST2)
-
-########################################
-# CPU and Host
-########################################
-# ASSUME GCC >=2
-SET(HAVE_BUILTIN_VECTOR 1)
-SET(HAVE_AUDIO    1)
-MESSAGE(STATUS "<Checking CPU and OS>")
-MESSAGE(STATUS "<*******************>")
-MESSAGE("<CPU:${CMAKE_SYSTEM_PROCESSOR}>")
-# windows is always X86 for now on...
- if(WIN32)
-   MESSAGE(STATUS WIN32)
-   SET(ADM_WIN32 1)
-   SET(CYG_MANGLING 1)
-   SET(ARCH_X86    1)
-   SET(HAVE_MMX    1)
-   SET(ENABLE_MMX    1)
-   SET(ARCH_X86    1)
-   SET(HAVE_MMX    1)
-   SET(ARCH_X86_32    1)
-   SET(FPM_INTEL    1)
-   SET(MEMALIGN_HACK    1)
-   add_definitions(-mms-bitfields -mno-cygwin)
- else(WIN32)
-      if(CMAKE_OSX_SYSROOT AND  ${CMAKE_SYSTEM_PROCESSOR} STREQUAL "i386")
-        SET(CYG_MANGLING 1)
-        MESSAGE(STATUS "x86 CPU, MACINTEL")
-        SET(ARCH_X86    1)
-        SET(HAVE_MMX    1)
-        SET(ENABLE_MMX    1)
-        SET(ARCH_X86_32    1)
-        SET(FPM_INTEL    1)
-      endif(CMAKE_OSX_SYSROOT AND  ${CMAKE_SYSTEM_PROCESSOR} STREQUAL "i386")
-
-      if(${CMAKE_SYSTEM_PROCESSOR} STREQUAL "i586" OR ${CMAKE_SYSTEM_PROCESSOR} STREQUAL "i686")
-          MESSAGE(STATUS "x86 CPU")
-          SET(ARCH_X86    1)
-          SET(HAVE_MMX    1)
-          SET(ENABLE_MMX    1)
-          SET(ARCH_X86_32    1)
-          SET(FPM_INTEL    1)
-     endif(${CMAKE_SYSTEM_PROCESSOR} STREQUAL "i586" OR ${CMAKE_SYSTEM_PROCESSOR} STREQUAL "i686")
-     if( ${CMAKE_SYSTEM_PROCESSOR} STREQUAL "x86_64" OR ${CMAKE_SYSTEM_PROCESSOR} STREQUAL "amd64")
-         MESSAGE(STATUS "AMD64 CPU")
-         SET(ARCH_X86    1)
-         SET(ARCH_X86_64    1)
-         SET(FPM_DEFAULT    1)
-         SET(ARCH_64_BITS    1)
-         SET(HAVE_MMX    1)
-         SET(ENABLE_MMX    1)
-     endif( ${CMAKE_SYSTEM_PROCESSOR} STREQUAL "x86_64" OR ${CMAKE_SYSTEM_PROCESSOR} STREQUAL "amd64")
- endif(WIN32)
-MESSAGE(STATUS "<End of CPU and OS Check>")
-MESSAGE(STATUS "<******************************>")
-#
-include(adm_log)
-#
-if(NOT CMAKE_BUILD_TYPE)
-  SET(CMAKE_BUILD_TYPE "Release")
-endif(NOT CMAKE_BUILD_TYPE)
-
-if(CMAKE_BUILD_TYPE STREQUAL "Debug")
-MESSAGE(STATUS "** DEBUG BUILD (${CMAKE_BUILD_TYPE})**")
-add_definitions(-DADM_DEBUG)
-else (CMAKE_BUILD_TYPE STREQUAL "Debug")
-MESSAGE(STATUS "** RELEASE BUILD (${CMAKE_BUILD_TYPE})**")
-endif(CMAKE_BUILD_TYPE STREQUAL "Debug")
-
-MESSAGE("LINK_FLAGS ${CMAKE_LD_FLAGS}")
-# EOF
+###############################
+# Part Of avidemux cmake conf #
+###############################
+##
+INCLUDE(CheckIncludeFiles)
+INCLUDE(CheckSymbolExists)
+INCLUDE(CheckFunctionExists)
+INCLUDE(CheckLibraryExists)
+include(lavcodec)
+include(CMakeDetermineSystem)
+include(adm_checkHeaderLib)
+include(adm_compile)
+#INCLUDE(CheckStructMember)
+check_function_exists(gettimeofday    HAVE_GETTIMEOFDAY)
+# Header
+CHECK_INCLUDE_FILES(inttypes.h      HAVE_INTTYPES_H)                    # simapi.h
+CHECK_INCLUDE_FILES(stddef.h        HAVE_STDDEF_H)                      # simapi.h
+CHECK_INCLUDE_FILES(stdint.h        HAVE_STDINT_H)                      # simapi.h
+CHECK_INCLUDE_FILES(stdlib.h        HAVE_STDLIB_H)                      # simapi.h
+CHECK_INCLUDE_FILES(string.h        HAVE_STRING_H)                      # _core/libintl.cpp
+CHECK_INCLUDE_FILES(sys/stat.h      HAVE_SYS_STAT_H)                    # gpg/gpg.cpp
+CHECK_INCLUDE_FILES(sys/types.h     HAVE_SYS_TYPES_H)                   # simapi.h
+CHECK_INCLUDE_FILES(unistd.h        HAVE_UNISTD_H)                      # simapi.h
+CHECK_INCLUDE_FILES(malloc.h        HAVE_MALLOC_H)                      # simapi.h
+CHECK_INCLUDE_FILES(libintl.h       HAVE_LIBINTL_H)                      # simapi.h
+# Set lavcodec/util/format configuration
+SET_LAVCODEC_FLAGS()
+
+# Symbols
+CHECK_SYMBOL_EXISTS(strcasecmp  "strings.h"         HAVE_STRCASECMP)    # simapi.h, various
+
+# Functions
+IF(NOT WIN32) # there is a chmod function on win32, but not usable the way we want...
+  CHECK_FUNCTION_EXISTS(chmod     HAVE_CHMOD)         # __homedir/homedir.cpp, gpg/gpg.cpp
+ENDIF(NOT WIN32)
+# VERSION(s)
+SET(VERSION 2.4)
+SET(PACKAGE_VERSION 2.4)
+
+# We use FFMPEG
+SET(ENABLE_THREADS    1)
+SET(USE_MP3    1)
+SET(USE_AC3    1)
+SET(USE_FFMPEG    1)
+SET(USE_MJPEG    1)
+SET(USE_LIBXML2    1)
+SET(HAVE_LRINTF    1)
+SET(EMULATE_FAST_INT    1)
+SET(RUNTIME_CPUDETECT    1)
+
+
+
+########################################
+# taist : Should fail!
+########################################
+ADM_CHECK_HL(teist larreme.h mzfdgp3lame lagggme_icnit HAVE_LzertgIBMP3LAME)
+if(HAVE_LzertgIBMP3LAME)
+  MESSAGE(FATAL "THAT TEST SHOULD HAVE FAILED EXPECT PROBLEM")
+endif(HAVE_LzertgIBMP3LAME)
+
+########################################
+# Gettext
+########################################
+if(HAVE_LIBINTL_H)
+  MESSAGE(STATUS "<Checking gettext >")
+  MESSAGE(STATUS "<**************** >")
+if(NO_NLS)
+message(status "<disabled per request>")
+else(NO_NLS)
+# Try linking without -lintl
+  ADM_COMPILE( gettext.cpp "" "" WITHOUT_LIBINTL outputWithoutLibintl)
+  if(WITHOUT_LIBINTL)
+      SET(HAVE_GETTEXT 1)
+      MESSAGE(STATUS "Ok, No lib needed (${ADM_GETTEXT_LIB})")
+  else(WITHOUT_LIBINTL)
+      ADM_COMPILE( gettext.cpp "" "-lintl" WITH_LIBINTL outputWithLibintl)
+      if(WITH_LIBINTL)
+        SET(ADM_GETTEXT_LIB "-lintl")
+        SET(HAVE_GETTEXT 1)
+        MESSAGE(STATUS "Ok, libintl needed")
+      else(WITH_LIBINTL)
+        MESSAGE(STATUS "Does not work, without ${outputWithoutLibintl}")
+        MESSAGE(STATUS "Does not work, with    ${outputWithLibintl}")
+      endif(WITH_LIBINTL)
+  endif(WITHOUT_LIBINTL)
+endif(HAVE_LIBINTL_H)
+endif(NO_NLS)
+########################################
+# Locale
+########################################
+SET(ADM_LOCALE "${CMAKE_INSTALL_PREFIX}/share/locale")
+########################################
+# WIN32
+########################################
+if(WIN32)
+SET(WIN32_DEF 1)
+else(WIN32)
+SET(WIN32_DEF 0)
+endif(WIN32)
+########################################
+# MacIntel
+########################################
+if(CMAKE_OSX_SYSROOT)
+  SET(ADM_BSD_FAMILY 1)
+#  SET(CYG_MANGLING 1)
+endif(CMAKE_OSX_SYSROOT)
+
+########################################
+# ALSA
+########################################
+if(NOT WIN32 AND NOT CMAKE_OSX_SYSROOT)
+  MESSAGE(STATUS "<Checking for ALSA>")
+  MESSAGE(STATUS "<*****************>")
+if(NO_ALSA)
+message(status "<disabled per request>")
+else(NO_ALSA)
+  include(FindAlsa)
+  if(ALSA_FOUND)
+    ALSA_VERSION_STRING(alsaVersion)
+    MESSAGE("Found alsa version :${alsaVersion}") 
+    MESSAGE("Found alsa lib     :${ASOUND_LIBRARY}")
+    SET(ALSA_SUPPORT 1)
+    SET(ALSA_1_0_SUPPORT 1)
+  endif(ALSA_FOUND)
+endif(NO_ALSA)
+endif(NOT WIN32 AND NOT CMAKE_OSX_SYSROOT)
+########################################
+# SDL
+########################################
+MESSAGE(STATUS "<Checking for SDL>")
+MESSAGE(STATUS "<*****************>")
+#include(FindSDL)
+include(admSDL)
+if(NO_SDL)
+message(status "<disabled per request>")
+else(NO_SDL)
+ADM_FIND_SDL()
+if(SDL_FOUND)
+ SET(USE_SDL 1)
+ MESSAGE(STATUS "Found")
+else(SDL_FOUND)
+  MESSAGE(STATUS "Not Found")
+endif(SDL_FOUND)
+endif(NO_SDL)
+########################################
+# FONTCONFIG
+########################################
+ADM_CHECK_HL(FontConfig fontconfig/fontconfig.h fontconfig FcStrSetCreate USE_FONTCONFIG)
+if(USE_FONTCONFIG)
+SET(HAVE_FONTCONFIG 1)
+endif(USE_FONTCONFIG)
+########################################
+# Xvideo
+########################################
+if(NOT WIN32)
+
+SET(CMAKE_REQUIRED_FLAGS "-include X11/Xlib.h")
+SET(CMAKE_REQUIRED_LIBRARIES "${X11_LIBRARIES}")
+SET(CMAKE_REQUIRED_INCLUDE "${X11_INCLUDE_DIR}")
+
+ADM_CHECK_HL(Xvideo X11/extensions/Xvlib.h Xv XvShmPutImage USE_XV)
+MESSAGE(STATUS "(i used ${CMAKE_REQUIRED_FLAGS}**${X11_INCLUDE_DIR})")
+MESSAGE(STATUS "(and ${CMAKE_REQUIRED_LIBRARIES}**${X11_LIBRARIES})")
+
+SET(CMAKE_REQUIRED_FLAGS )
+SET(CMAKE_REQUIRED_LIBRARIES )
+SET(CMAKE_REQUIRED_INCLUDE )
+
+
+endif(NOT WIN32)
+########################################
+# OSS
+########################################
+
+if(NOT WIN32)
+MESSAGE(STATUS "<Checking for OSS>")
+MESSAGE(STATUS "<*****************>")
+if(NO_OSS)
+message(status "<disabled per request>")
+else(NO_OSS)
+CHECK_INCLUDE_FILES(sys/soundcard.h      OSS_SUPPORT)
+if(OSS_SUPPORT)
+MESSAGE(STATUS "Found")
+else(OSS_SUPPORT)
+MESSAGE(STATUS "Not found")
+endif(OSS_SUPPORT)
+endif(NO_OSS)
+
+endif(NOT WIN32)
+########################################
+# ARTS
+########################################
+if(NOT WIN32)
+include(FindArts)
+endif(NOT WIN32)
+
+########################################
+# ESD
+########################################
+if(NOT WIN32)
+ADM_CHECK_HL(Esd esd.h  esd esd_close USE_ESD)
+endif(NOT WIN32)
+########################################
+# JACK
+########################################
+if(NOT WIN32)
+ADM_CHECK_HL(Jack jack/jack.h  jack jack_client_close USE_JACK)
+endif(NOT WIN32)
+########################################
+# Aften
+########################################
+if(WIN32)
+SET(CMAKE_REQUIRED_FLAGS "-lm -lpthreadGC2")
+else(WIN32)
+SET(CMAKE_REQUIRED_FLAGS "-lm -lpthread")
+endif(WIN32)
+
+ADM_CHECK_HL(Aften aften/aften.h  aften aften_encode_init USE_AFTEN)
+if(USE_AFTEN)
+# TODO! Check aften version 5/6/7!
+SET(USE_AFTEN_07 1)
+endif(USE_AFTEN)
+SET(CMAKE_REQUIRED_FLAGS "")
+########################################
+# SRC
+########################################
+ADM_CHECK_HL(libsamplerate samplerate.h samplerate src_get_version USE_SRC)
+########################################
+# ICONV
+########################################
+# search ICON.h
+MESSAGE(STATUS "<Checking for iconv.h>")
+MESSAGE(STATUS "<******************************>")
+CHECK_INCLUDE_FILES(iconv.h HAVE_ICONV_H)
+if(NOT HAVE_ICONV_H)
+  MESSAGE(FATAL "iconv.h not found")
+endif(NOT HAVE_ICONV_H)
+
+# need libiconv ?
+CHECK_LIBRARY_EXISTS(iconv libiconv "" LINK_WITH_ICONV)
+if(LINK_WITH_ICONV)
+  SET(NEED_LIBICONV 1)
+  MESSAGE(STATUS "libiconv found, probably needed")
+else(LINK_WITH_ICONV)
+  MESSAGE(STATUS "libiconv not found, probably not needed")
+endif(LINK_WITH_ICONV)
+
+#
+MESSAGE(STATUS "<Checking if iconv needs const>")
+
+if(NEED_LIBICONV)
+ADM_COMPILE_WITH_WITHOUT(iconv_check.cpp "-DICONV_NEED_CONST" "-liconv" ICONV_WITH)
+else(NEED_LIBICONV)
+ADM_COMPILE_WITH_WITHOUT(iconv_check.cpp "-DICONV_NEED_CONST" "-lm" ICONV_WITH)
+endif(NEED_LIBICONV)
+
+if(ICONV_WITH)
+  MESSAGE(STATUS "Yes")
+  SET(ICONV_NEED_CONST 1)
+else(ICONV_WITH)
+    MESSAGE(STATUS "No")
+endif(ICONV_WITH)
+########################################
+# LAME
+########################################
+SET(CMAKE_REQUIRED_LIBRARIES "-lm")
+ADM_CHECK_HL(Lame lame/lame.h mp3lame lame_init HAVE_LIBMP3LAME)
+SET(CMAKE_REQUIRED_LIBRARIES )
+########################################
+# Xvid
+########################################
+ADM_CHECK_HL(Xvid xvid.h xvidcore xvid_plugin_single USE_XVID_4)
+########################################
+# AMR_NB
+########################################
+if(USE_LATE_BINDING)
+	CHECK_INCLUDE_FILES(amrnb/interf_dec.h USE_AMR_NB)
+else(USE_LATE_BINDING)
+	ADM_CHECK_HL(AMRNB amrnb/interf_dec.h amrnb GP3Decoder_Interface_Decode USE_AMR_NB)
+endif(USE_LATE_BINDING)
+
+if(USE_AMR_NB)
+	SET(CONFIG_AMR_NB 1)
+endif(USE_AMR_NB)
+########################################
+# Libdca
+########################################
+SET(CMAKE_REQUIRED_FLAGS "-include stdint.h")
+SET(CMAKE_REQUIRED_LIBRARIES "-lm")
+
+if(USE_LATE_BINDING)
+	CHECK_INCLUDE_FILES(dts.h USE_LIBDCA)
+else(USE_LATE_BINDING)
+	ADM_CHECK_HL(libdca dts.h dts dts_init USE_LIBDCA)
+endif(USE_LATE_BINDING)
+
+SET(CMAKE_REQUIRED_LIBRARIES)
+SET(CMAKE_REQUIRED_FLAGS)
+########################################
+# X264
+########################################
+SET(CMAKE_REQUIRED_FLAGS "-include stdint.h")
+
+if(WIN32)
+SET(CMAKE_REQUIRED_LIBRARIES "-lm -lpthreadGC2")
+else(WIN32)
+SET(CMAKE_REQUIRED_LIBRARIES "-lm -lpthread")
+endif(WIN32)
+
+ADM_CHECK_HL(x264 x264.h x264 x264_encoder_open USE_X264)
+SET(CMAKE_REQUIRED_FLAGS)
+SET(CMAKE_REQUIRED_LIBRARIES)
+########################################
+# PNG
+########################################
+ADM_CHECK_HL(libPNG png.h png png_malloc USE_PNG)
+
+
+########################################
+# FAAD
+########################################
+
+ADM_CHECK_HL(FAAD faad.h faad faacDecInit USE_FAAD_P)
+if(NOT USE_FAAD_P)
+ MESSAGE(STATUS "Trying neaac variant")
+ ADM_CHECK_HL(NeAAC faad.h faad NeAACDecInit USE_FAAD_A)
+endif(NOT USE_FAAD_P)
+if(USE_FAAD_P OR USE_FAAD_A)
+  SET(USE_FAAD  1)
+endif(USE_FAAD_P OR USE_FAAD_A)
+# See if we need old FAAD or NEW
+if(USE_FAAD)
+MESSAGE(STATUS "<Checking if faad needs old proto>")
+ADM_COMPILE_WITH_WITHOUT(faad_check.cpp "-DOLD_FAAD_PROTO" "-lfaad" FAAD_WITH)
+if(FAAD_WITH)
+  MESSAGE(STATUS "Yes")
+  SET(OLD_FAAD_PROTO 1)
+else(FAAD_WITH)
+    MESSAGE(STATUS "No")
+endif(FAAD_WITH)
+endif(USE_FAAD)
+########################################
+# FAAC
+########################################
+SET(CMAKE_REQUIRED_FLAGS "-include stdint.h")
+ADM_CHECK_HL(FAAC faac.h faac faacEncClose USE_FAAC)
+SET(CMAKE_REQUIRED_FLAGS)
+########################################
+# FreeType
+########################################
+if(FT_FOUND)
+SET(USE_FREETYPE 1)
+endif(FT_FOUND)
+########################################
+# Vorbis
+########################################
+
+ ADM_CHECK_HL(Vorbis vorbis/vorbisenc.h vorbis vorbis_info_init USE_VORBIS1)
+ ADM_CHECK_HL(Vorbis vorbis/vorbisenc.h vorbisenc vorbis_encode_init USE_VORBIS2)
+ if(USE_VORBIS1 AND USE_VORBIS2)
+   SET(USE_VORBIS 1)
+ endif(USE_VORBIS1 AND USE_VORBIS2)
+
+########################################
+# End test
+########################################
+
+ ADM_CHECK_HL(Invalid dummy_header.h dummy_libxyz dummy_func_tyu DUMMY_TEST)
+ ADM_CHECK_HL(Invalid stdio.h dummy_libxyz dummy_func_tyu DUMMY_TEST2)
+ if(DUMMY_TEST OR DUMMY_TEST2)
+   MESSAGE(FATAL "This test should have failed!!!")
+   MESSAGE(FATAL "This test should have failed!!!")
+   MESSAGE(FATAL "This test should have failed!!!")
+ endif(DUMMY_TEST OR DUMMY_TEST2)
+
+########################################
+# CPU and Host
+########################################
+# ASSUME GCC >=2
+SET(HAVE_BUILTIN_VECTOR 1)
+SET(HAVE_AUDIO    1)
+MESSAGE(STATUS "<Checking CPU and OS>")
+MESSAGE(STATUS "<*******************>")
+MESSAGE("<CPU:${CMAKE_SYSTEM_PROCESSOR}>")
+# windows is always X86 for now on...
+ if(WIN32)
+   MESSAGE(STATUS WIN32)
+   SET(ADM_WIN32 1)
+   SET(CYG_MANGLING 1)
+   SET(ARCH_X86    1)
+   SET(HAVE_MMX    1)
+   SET(ENABLE_MMX    1)
+   SET(ARCH_X86    1)
+   SET(HAVE_MMX    1)
+   SET(ARCH_X86_32    1)
+   SET(FPM_INTEL    1)
+   SET(MEMALIGN_HACK    1)
+   add_definitions(-mms-bitfields -mno-cygwin)
+ else(WIN32)
+      if(CMAKE_OSX_SYSROOT AND  ${CMAKE_SYSTEM_PROCESSOR} STREQUAL "i386")
+        SET(CYG_MANGLING 1)
+        MESSAGE(STATUS "x86 CPU, MACINTEL")
+        SET(ARCH_X86    1)
+        SET(HAVE_MMX    1)
+        SET(ENABLE_MMX    1)
+        SET(ARCH_X86_32    1)
+        SET(FPM_INTEL    1)
+      endif(CMAKE_OSX_SYSROOT AND  ${CMAKE_SYSTEM_PROCESSOR} STREQUAL "i386")
+
+      if(${CMAKE_SYSTEM_PROCESSOR} STREQUAL "i586" OR ${CMAKE_SYSTEM_PROCESSOR} STREQUAL "i686")
+          MESSAGE(STATUS "x86 CPU")
+          SET(ARCH_X86    1)
+          SET(HAVE_MMX    1)
+          SET(ENABLE_MMX    1)
+          SET(ARCH_X86_32    1)
+          SET(FPM_INTEL    1)
+     endif(${CMAKE_SYSTEM_PROCESSOR} STREQUAL "i586" OR ${CMAKE_SYSTEM_PROCESSOR} STREQUAL "i686")
+     if( ${CMAKE_SYSTEM_PROCESSOR} STREQUAL "x86_64" OR ${CMAKE_SYSTEM_PROCESSOR} STREQUAL "amd64")
+         MESSAGE(STATUS "AMD64 CPU")
+         SET(ARCH_X86    1)
+         SET(ARCH_X86_64    1)
+         SET(FPM_DEFAULT    1)
+         SET(ARCH_64_BITS    1)
+         SET(HAVE_MMX    1)
+         SET(ENABLE_MMX    1)
+     endif( ${CMAKE_SYSTEM_PROCESSOR} STREQUAL "x86_64" OR ${CMAKE_SYSTEM_PROCESSOR} STREQUAL "amd64")
+ endif(WIN32)
+MESSAGE(STATUS "<End of CPU and OS Check>")
+MESSAGE(STATUS "<******************************>")
+#
+include(adm_log)
+#
+if(NOT CMAKE_BUILD_TYPE)
+  SET(CMAKE_BUILD_TYPE "Release")
+endif(NOT CMAKE_BUILD_TYPE)
+
+if(CMAKE_BUILD_TYPE STREQUAL "Debug")
+MESSAGE(STATUS "** DEBUG BUILD (${CMAKE_BUILD_TYPE})**")
+add_definitions(-DADM_DEBUG)
+else (CMAKE_BUILD_TYPE STREQUAL "Debug")
+MESSAGE(STATUS "** RELEASE BUILD (${CMAKE_BUILD_TYPE})**")
+endif(CMAKE_BUILD_TYPE STREQUAL "Debug")
+
+MESSAGE("LINK_FLAGS ${CMAKE_LD_FLAGS}")
+# EOF

Modified: branches/avidemux_2.4_branch/cmake/FindArts.cmake
===================================================================
--- branches/avidemux_2.4_branch/cmake/FindArts.cmake	2007-07-28 16:47:43 UTC (rev 3453)
+++ branches/avidemux_2.4_branch/cmake/FindArts.cmake	2007-07-28 17:03:19 UTC (rev 3454)
@@ -1,23 +1,27 @@
-# Find arts CFLAGS etc
-
-MESSAGE(STATUS "<** ARTS **>")
-MESSAGE(STATUS "<---------->")
-FIND_PROGRAM(ARTS_CONFIG_EXECUTABLE artsc-config)
-MARK_AS_ADVANCED(ARTS_CONFIG_EXECUTABLE)
-
-IF(ARTS_CONFIG_EXECUTABLE)
-    EXECUTE_PROCESS(COMMAND ${ARTS_CONFIG_EXECUTABLE} --cflags
-      OUTPUT_VARIABLE ARTS_CFLAGS
-      OUTPUT_STRIP_TRAILING_WHITESPACE)
-    MESSAGE(STATUS "Arts cflags : ${ARTS_CFLAGS}")
-    EXECUTE_PROCESS(COMMAND ${ARTS_CONFIG_EXECUTABLE} --libs
-      OUTPUT_VARIABLE ARTS_LDFLAGS
-      OUTPUT_STRIP_TRAILING_WHITESPACE)
-    MESSAGE(STATUS "Arts ldflags : ${ARTS_LDFLAGS}")
-    SET(USE_ARTS 1)
-ELSE(ARTS_CONFIG_EXECUTABLE)
-MESSAGE(STATUS "Not found")
-ENDIF(ARTS_CONFIG_EXECUTABLE)
-
-
-# FindSubversion.cmake ends here.
+# Find arts CFLAGS etc
+
+MESSAGE(STATUS "<** ARTS **>")
+MESSAGE(STATUS "<---------->")
+if(NO_ARTS)
+message(status "<disabled per request>")
+else(NO_ARTS)
+FIND_PROGRAM(ARTS_CONFIG_EXECUTABLE artsc-config)
+MARK_AS_ADVANCED(ARTS_CONFIG_EXECUTABLE)
+
+IF(ARTS_CONFIG_EXECUTABLE)
+    EXECUTE_PROCESS(COMMAND ${ARTS_CONFIG_EXECUTABLE} --cflags
+      OUTPUT_VARIABLE ARTS_CFLAGS
+      OUTPUT_STRIP_TRAILING_WHITESPACE)
+    MESSAGE(STATUS "Arts cflags : ${ARTS_CFLAGS}")
+    EXECUTE_PROCESS(COMMAND ${ARTS_CONFIG_EXECUTABLE} --libs
+      OUTPUT_VARIABLE ARTS_LDFLAGS
+      OUTPUT_STRIP_TRAILING_WHITESPACE)
+    MESSAGE(STATUS "Arts ldflags : ${ARTS_LDFLAGS}")
+    SET(USE_ARTS 1)
+ELSE(ARTS_CONFIG_EXECUTABLE)
+MESSAGE(STATUS "Not found")
+ENDIF(ARTS_CONFIG_EXECUTABLE)
+endif(NO_ARTS)
+
+
+# FindSubversion.cmake ends here.

Modified: branches/avidemux_2.4_branch/cmake/FindSubversion.cmake
===================================================================
--- branches/avidemux_2.4_branch/cmake/FindSubversion.cmake	2007-07-28 16:47:43 UTC (rev 3453)
+++ branches/avidemux_2.4_branch/cmake/FindSubversion.cmake	2007-07-28 17:03:19 UTC (rev 3454)
@@ -1,120 +1,120 @@
-# - Extract information from a subversion working copy
-# The module defines the following variables:
-#  Subversion_SVN_EXECUTABLE - path to svn command line client
-#  Subversion_VERSION_SVN - version of svn command line client
-#  Subversion_FOUND - true if the command line client was found
-# If the command line client executable is found the macro
-#  Subversion_WC_INFO(<dir> <var-prefix>)
-# is defined to extract information of a subversion working copy at
-# a given location. The macro defines the following variables:
-#  <var-prefix>_WC_URL - url of the repository (at <dir>)
-#  <var-prefix>_WC_ROOT - root url of the repository
-#  <var-prefix>_WC_REVISION - current revision
-#  <var-prefix>_WC_LAST_CHANGED_AUTHOR - author of last commit
-#  <var-prefix>_WC_LAST_CHANGED_DATE - date of last commit
-#  <var-prefix>_WC_LAST_CHANGED_REV - revision of last commit
-#  <var-prefix>_WC_LAST_CHANGED_LOG - last log of base revision
-#  <var-prefix>_WC_INFO - output of command `svn info <dir>'
-# Example usage:
-#  FIND_PACKAGE(Subversion)
-#  IF(Subversion_FOUND)
-#    Subversion_WC_INFO(${PROJECT_SOURCE_DIR} Project)
-#    MESSAGE("Current revision is ${Project_WC_REVISION}")
-#  ENDIF(Subversion_FOUND)
-
-# Copyright (c) 2006, Tristan Carel
-# All rights reserved.
-# Redistribution and use in source and binary forms, with or without
-# modification, are permitted provided that the following conditions are met:
-#
-#     * Redistributions of source code must retain the above copyright
-#       notice, this list of conditions and the following disclaimer.
-#     * Redistributions in binary form must reproduce the above copyright
-#       notice, this list of conditions and the following disclaimer in the
-#       documentation and/or other materials provided with the distribution.
-#     * Neither the name of the University of California, Berkeley nor the
-#       names of its contributors may be used to endorse or promote products
-#       derived from this software without specific prior written permission.
-#
-# THIS SOFTWARE IS PROVIDED BY THE REGENTS AND CONTRIBUTORS ``AS IS'' AND ANY
-# EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED
-# WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE
-# DISCLAIMED. IN NO EVENT SHALL THE REGENTS AND CONTRIBUTORS BE LIABLE FOR ANY
-# DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES
-# (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;
-# LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND
-# ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
-# (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
-# SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
-
-# $Id: FindSubversion.cmake,v 1.1.2.1 2006/11/13 17:59:54 hoffman Exp $
-
-SET(Subversion_FOUND FALSE)
-SET(Subversion_SVN_FOUND FALSE)
-
-FIND_PROGRAM(Subversion_SVN_EXECUTABLE svn
-  DOC "subversion command line client")
-MARK_AS_ADVANCED(Subversion_SVN_EXECUTABLE)
-
-IF(Subversion_SVN_EXECUTABLE)
-  SET(Subversion_SVN_FOUND TRUE)
-  SET(Subversion_FOUND TRUE)
-
-  MACRO(Subversion_WC_INFO dir prefix)
-    EXECUTE_PROCESS(COMMAND ${Subversion_SVN_EXECUTABLE} --version
-      WORKING_DIRECTORY ${PROJECT_SOURCE_DIR}
-      OUTPUT_VARIABLE Subversion_VERSION_SVN
-      OUTPUT_STRIP_TRAILING_WHITESPACE)
-    MESSAGE(STATUS "Getting svn version from ${dir}")
-    EXECUTE_PROCESS(COMMAND ${Subversion_SVN_EXECUTABLE} info . 
-      WORKING_DIRECTORY ${dir}
-      OUTPUT_VARIABLE ${prefix}_WC_INFO
-      ERROR_VARIABLE Subversion_svn_info_error
-      RESULT_VARIABLE Subversion_svn_info_result
-      OUTPUT_STRIP_TRAILING_WHITESPACE)
-
-    IF(NOT ${Subversion_svn_info_result} EQUAL 0)
-      MESSAGE(SEND_ERROR "Command \"${Subversion_SVN_EXECUTABLE} info ${dir}\" failed with output:\n${Subversion_svn_info_error}")
-    ELSE(NOT ${Subversion_svn_info_result} EQUAL 0)
-
-      STRING(REGEX REPLACE "^(.*\n)?svn, version ([.0-9]+).*"
-        "\\2" Subversion_VERSION_SVN "${Subversion_VERSION_SVN}")
-      STRING(REGEX REPLACE "^(.*\n)?URL: ([^\n]+).*"
-        "\\2" ${prefix}_WC_URL "${${prefix}_WC_INFO}")
-      STRING(REGEX REPLACE "^(.*\n)?Revision: ([^\n]+).*"
-        "\\2" ${prefix}_WC_REVISION "${${prefix}_WC_INFO}")
-      STRING(REGEX REPLACE "^(.*\n)?Last Changed Author: ([^\n]+).*"
-        "\\2" ${prefix}_WC_LAST_CHANGED_AUTHOR "${${prefix}_WC_INFO}")
-      STRING(REGEX REPLACE "^(.*\n)?Last Changed Rev: ([^\n]+).*"
-        "\\2" ${prefix}_WC_LAST_CHANGED_REV "${${prefix}_WC_INFO}")
-      STRING(REGEX REPLACE "^(.*\n)?Last Changed Date: ([^\n]+).*"
-        "\\2" ${prefix}_WC_LAST_CHANGED_DATE "${${prefix}_WC_INFO}")
-
-    ENDIF(NOT ${Subversion_svn_info_result} EQUAL 0)
-
-    EXECUTE_PROCESS(COMMAND
-      ${Subversion_SVN_EXECUTABLE} log -r BASE .
-      WORKING_DIRECTORY ${PROJECT_SOURCE_DIR}
-      OUTPUT_VARIABLE Subversion_LAST_CHANGED_LOG
-      ERROR_VARIABLE Subversion_svn_log_error
-      RESULT_VARIABLE Subversion_svn_log_result
-      OUTPUT_STRIP_TRAILING_WHITESPACE)
-
-    IF(NOT ${Subversion_svn_log_result} EQUAL 0)
-      MESSAGE(SEND_ERROR "Command \"${Subversion_SVN_EXECUTABLE} log -r BASE ${dir}\" failed with output:\n${Subversion_svn_log_error}")
-    ENDIF(NOT ${Subversion_svn_log_result} EQUAL 0)
-  ENDMACRO(Subversion_WC_INFO)
-
-ENDIF(Subversion_SVN_EXECUTABLE)
-
-IF(NOT Subversion_FOUND)
-  IF(NOT Subversion_FIND_QUIETLY)
-    MESSAGE(STATUS "Subversion was not found.")
-  ELSE(NOT Subversion_FIND_QUIETLY)
-    IF(Subversion_FIND_REQUIRED)
-      MESSAGE(FATAL_ERROR "Subversion was not found.")
-    ENDIF(Subversion_FIND_REQUIRED)
-  ENDIF(NOT Subversion_FIND_QUIETLY)
-ENDIF(NOT Subversion_FOUND)
-
-# FindSubversion.cmake ends here.
+# - Extract information from a subversion working copy
+# The module defines the following variables:
+#  Subversion_SVN_EXECUTABLE - path to svn command line client
+#  Subversion_VERSION_SVN - version of svn command line client
+#  Subversion_FOUND - true if the command line client was found
+# If the command line client executable is found the macro
+#  Subversion_WC_INFO(<dir> <var-prefix>)
+# is defined to extract information of a subversion working copy at
+# a given location. The macro defines the following variables:
+#  <var-prefix>_WC_URL - url of the repository (at <dir>)
+#  <var-prefix>_WC_ROOT - root url of the repository
+#  <var-prefix>_WC_REVISION - current revision
+#  <var-prefix>_WC_LAST_CHANGED_AUTHOR - author of last commit
+#  <var-prefix>_WC_LAST_CHANGED_DATE - date of last commit
+#  <var-prefix>_WC_LAST_CHANGED_REV - revision of last commit
+#  <var-prefix>_WC_LAST_CHANGED_LOG - last log of base revision
+#  <var-prefix>_WC_INFO - output of command `svn info <dir>'
+# Example usage:
+#  FIND_PACKAGE(Subversion)
+#  IF(Subversion_FOUND)
+#    Subversion_WC_INFO(${PROJECT_SOURCE_DIR} Project)
+#    MESSAGE("Current revision is ${Project_WC_REVISION}")
+#  ENDIF(Subversion_FOUND)
+
+# Copyright (c) 2006, Tristan Carel
+# All rights reserved.
+# Redistribution and use in source and binary forms, with or without
+# modification, are permitted provided that the following conditions are met:
+#
+#     * Redistributions of source code must retain the above copyright
+#       notice, this list of conditions and the following disclaimer.
+#     * Redistributions in binary form must reproduce the above copyright
+#       notice, this list of conditions and the following disclaimer in the
+#       documentation and/or other materials provided with the distribution.
+#     * Neither the name of the University of California, Berkeley nor the
+#       names of its contributors may be used to endorse or promote products
+#       derived from this software without specific prior written permission.
+#
+# THIS SOFTWARE IS PROVIDED BY THE REGENTS AND CONTRIBUTORS ``AS IS'' AND ANY
+# EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED
+# WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE
+# DISCLAIMED. IN NO EVENT SHALL THE REGENTS AND CONTRIBUTORS BE LIABLE FOR ANY
+# DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES
+# (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;
+# LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND
+# ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
+# (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
+# SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
+
+# $Id: FindSubversion.cmake,v 1.1.2.1 2006/11/13 17:59:54 hoffman Exp $
+
+SET(Subversion_FOUND FALSE)
+SET(Subversion_SVN_FOUND FALSE)
+
+FIND_PROGRAM(Subversion_SVN_EXECUTABLE svn
+  DOC "subversion command line client")
+MARK_AS_ADVANCED(Subversion_SVN_EXECUTABLE)
+
+IF(Subversion_SVN_EXECUTABLE)
+  SET(Subversion_SVN_FOUND TRUE)
+  SET(Subversion_FOUND TRUE)
+
+  MACRO(Subversion_WC_INFO dir prefix)
+    EXECUTE_PROCESS(COMMAND ${Subversion_SVN_EXECUTABLE} --version
+      WORKING_DIRECTORY ${PROJECT_SOURCE_DIR}
+      OUTPUT_VARIABLE Subversion_VERSION_SVN
+      OUTPUT_STRIP_TRAILING_WHITESPACE)
+    MESSAGE(STATUS "Getting svn version from ${dir}")
+    EXECUTE_PROCESS(COMMAND ${Subversion_SVN_EXECUTABLE} info . 
+      WORKING_DIRECTORY ${dir}
+      OUTPUT_VARIABLE ${prefix}_WC_INFO
+      ERROR_VARIABLE Subversion_svn_info_error
+      RESULT_VARIABLE Subversion_svn_info_result
+      OUTPUT_STRIP_TRAILING_WHITESPACE)
+
+    IF(NOT ${Subversion_svn_info_result} EQUAL 0)
+      MESSAGE(SEND_ERROR "Command \"${Subversion_SVN_EXECUTABLE} info ${dir}\" failed with output:\n${Subversion_svn_info_error}")
+    ELSE(NOT ${Subversion_svn_info_result} EQUAL 0)
+
+      STRING(REGEX REPLACE "^(.*\n)?svn, version ([.0-9]+).*"
+        "\\2" Subversion_VERSION_SVN "${Subversion_VERSION_SVN}")
+      STRING(REGEX REPLACE "^(.*\n)?URL: ([^\n]+).*"
+        "\\2" ${prefix}_WC_URL "${${prefix}_WC_INFO}")
+      STRING(REGEX REPLACE "^(.*\n)?Revision: ([^\n]+).*"
+        "\\2" ${prefix}_WC_REVISION "${${prefix}_WC_INFO}")
+      STRING(REGEX REPLACE "^(.*\n)?Last Changed Author: ([^\n]+).*"
+        "\\2" ${prefix}_WC_LAST_CHANGED_AUTHOR "${${prefix}_WC_INFO}")
+      STRING(REGEX REPLACE "^(.*\n)?Last Changed Rev: ([^\n]+).*"
+        "\\2" ${prefix}_WC_LAST_CHANGED_REV "${${prefix}_WC_INFO}")
+      STRING(REGEX REPLACE "^(.*\n)?Last Changed Date: ([^\n]+).*"
+        "\\2" ${prefix}_WC_LAST_CHANGED_DATE "${${prefix}_WC_INFO}")
+
+    ENDIF(NOT ${Subversion_svn_info_result} EQUAL 0)
+
+    EXECUTE_PROCESS(COMMAND
+      ${Subversion_SVN_EXECUTABLE} log -r BASE .
+      WORKING_DIRECTORY ${PROJECT_SOURCE_DIR}
+      OUTPUT_VARIABLE Subversion_LAST_CHANGED_LOG
+      ERROR_VARIABLE Subversion_svn_log_error
+      RESULT_VARIABLE Subversion_svn_log_result
+      OUTPUT_STRIP_TRAILING_WHITESPACE)
+
+    IF(NOT ${Subversion_svn_log_result} EQUAL 0)
+      MESSAGE(SEND_ERROR "Command \"${Subversion_SVN_EXECUTABLE} log -r BASE ${dir}\" failed with output:\n${Subversion_svn_log_error}")
+    ENDIF(NOT ${Subversion_svn_log_result} EQUAL 0)
+  ENDMACRO(Subversion_WC_INFO)
+
+ENDIF(Subversion_SVN_EXECUTABLE)
+
+IF(NOT Subversion_FOUND)
+  IF(NOT Subversion_FIND_QUIETLY)
+    MESSAGE(STATUS "Subversion was not found.")
+  ELSE(NOT Subversion_FIND_QUIETLY)
+    IF(Subversion_FIND_REQUIRED)
+      MESSAGE(FATAL_ERROR "Subversion was not found.")
+    ENDIF(Subversion_FIND_REQUIRED)
+  ENDIF(NOT Subversion_FIND_QUIETLY)
+ENDIF(NOT Subversion_FOUND)
+
+# FindSubversion.cmake ends here.

Modified: branches/avidemux_2.4_branch/cmake/Po.cmake
===================================================================
--- branches/avidemux_2.4_branch/cmake/Po.cmake	2007-07-28 16:47:43 UTC (rev 3453)
+++ branches/avidemux_2.4_branch/cmake/Po.cmake	2007-07-28 17:03:19 UTC (rev 3454)
@@ -1,59 +1,59 @@
-# a small macro to create mo files out of po's
-# Taken from sim-im.org
-
-MACRO(FIND_MSGFMT)
-    IF(NOT MSGFMT_EXECUTABLE)
-        IF(NOT MSGFMT_NOT_FOUND)
-            SET(MSGFMT_NAME "msgfmt")
-            FIND_PROGRAM(MSGFMT_EXECUTABLE ${MSGFMT_NAME})
-
-            IF (NOT MSGFMT_EXECUTABLE)
-              MESSAGE(FATAL_ERROR "${MSGFMT_NAME} not found - po files can't be processed")
-              SET(MSGFMT_NOT_FOUND "1")     # to avoid double checking in one cmake run
-            ENDIF (NOT MSGFMT_EXECUTABLE)
-
-            MARK_AS_ADVANCED(MSGFMT_EXECUTABLE)
-        ENDIF(NOT MSGFMT_NOT_FOUND)
-    ENDIF(NOT MSGFMT_EXECUTABLE)
-ENDMACRO(FIND_MSGFMT)
-
-MACRO(COMPILE_PO_FILES po_subdir _sources)
-    FIND_MSGFMT()
-    SET(_basename avidemux2)
-	
-    IF(MSGFMT_EXECUTABLE)
-        FILE(GLOB po_files ${po_subdir}/*.po)
-
-        FOREACH(po_input ${po_files})
-
-            GET_FILENAME_COMPONENT(_in       ${po_input} ABSOLUTE)
-            GET_FILENAME_COMPONENT(_basename ${po_input} NAME_WE)
-
-            IF(WIN32)
-                FILE(MAKE_DIRECTORY ${CMAKE_BINARY_DIR}/po)
-                GET_FILENAME_COMPONENT(_out ${CMAKE_BINARY_DIR}/po/${_basename}.mo ABSOLUTE)
-            ELSE(WIN32)
-                FILE(MAKE_DIRECTORY ${CMAKE_CURRENT_BINARY_DIR}/po)
-                GET_FILENAME_COMPONENT(_out ${CMAKE_CURRENT_BINARY_DIR}/po/${_basename}.mo ABSOLUTE)
-            ENDIF(WIN32)
-            
-            ADD_CUSTOM_COMMAND(
-                OUTPUT ${_out}
-                COMMAND ${CMAKE_COMMAND}
-                    -E echo
-                    "Generating" ${_out} "from" ${_in}
-                COMMAND ${MSGFMT_EXECUTABLE}
-                    ${_in}
-                    -o ${_out}
-                DEPENDS ${_in}
-            )
-                
-            SET(mo_files ${mo_files} ${_out})
-
-            INSTALL(FILES ${_out} DESTINATION ${CMAKE_INSTALL_PREFIX}/share/locale/${_basename}/LC_MESSAGES RENAME avidemux.mo)
-        ENDFOREACH(po_input ${po_files})
-
-        SET(${_sources} ${${_sources}} ${mo_files})
-    ENDIF(MSGFMT_EXECUTABLE)
-ENDMACRO(COMPILE_PO_FILES po_subdir)
-
+# a small macro to create mo files out of po's
+# Taken from sim-im.org
+
+MACRO(FIND_MSGFMT)
+    IF(NOT MSGFMT_EXECUTABLE)
+        IF(NOT MSGFMT_NOT_FOUND)
+            SET(MSGFMT_NAME "msgfmt")
+            FIND_PROGRAM(MSGFMT_EXECUTABLE ${MSGFMT_NAME})
+
+            IF (NOT MSGFMT_EXECUTABLE)
+              MESSAGE(FATAL_ERROR "${MSGFMT_NAME} not found - po files can't be processed")
+              SET(MSGFMT_NOT_FOUND "1")     # to avoid double checking in one cmake run
+            ENDIF (NOT MSGFMT_EXECUTABLE)
+
+            MARK_AS_ADVANCED(MSGFMT_EXECUTABLE)
+        ENDIF(NOT MSGFMT_NOT_FOUND)
+    ENDIF(NOT MSGFMT_EXECUTABLE)
+ENDMACRO(FIND_MSGFMT)
+
+MACRO(COMPILE_PO_FILES po_subdir _sources)
+    FIND_MSGFMT()
+    SET(_basename avidemux2)
+	
+    IF(MSGFMT_EXECUTABLE)
+        FILE(GLOB po_files ${po_subdir}/*.po)
+
+        FOREACH(po_input ${po_files})
+
+            GET_FILENAME_COMPONENT(_in       ${po_input} ABSOLUTE)
+            GET_FILENAME_COMPONENT(_basename ${po_input} NAME_WE)
+
+            IF(WIN32)
+                FILE(MAKE_DIRECTORY ${CMAKE_BINARY_DIR}/po)
+                GET_FILENAME_COMPONENT(_out ${CMAKE_BINARY_DIR}/po/${_basename}.mo ABSOLUTE)
+            ELSE(WIN32)
+                FILE(MAKE_DIRECTORY ${CMAKE_CURRENT_BINARY_DIR}/po)
+                GET_FILENAME_COMPONENT(_out ${CMAKE_CURRENT_BINARY_DIR}/po/${_basename}.mo ABSOLUTE)
+            ENDIF(WIN32)
+            
+            ADD_CUSTOM_COMMAND(
+                OUTPUT ${_out}
+                COMMAND ${CMAKE_COMMAND}
+                    -E echo
+                    "Generating" ${_out} "from" ${_in}
+                COMMAND ${MSGFMT_EXECUTABLE}
+                    ${_in}
+                    -o ${_out}
+                DEPENDS ${_in}
+            )
+                
+            SET(mo_files ${mo_files} ${_out})
+
+            INSTALL(FILES ${_out} DESTINATION ${CMAKE_INSTALL_PREFIX}/share/locale/${_basename}/LC_MESSAGES RENAME avidemux.mo)
+        ENDFOREACH(po_input ${po_files})
+
+        SET(${_sources} ${${_sources}} ${mo_files})
+    ENDIF(MSGFMT_EXECUTABLE)
+ENDMACRO(COMPILE_PO_FILES po_subdir)
+

Modified: branches/avidemux_2.4_branch/cmake/admSDL.cmake
===================================================================
--- branches/avidemux_2.4_branch/cmake/admSDL.cmake	2007-07-28 16:47:43 UTC (rev 3453)
+++ branches/avidemux_2.4_branch/cmake/admSDL.cmake	2007-07-28 17:03:19 UTC (rev 3454)
@@ -1,36 +1,36 @@
-# - Locate the SDL library using sdl-config
-# This module defines
-#  SDL_LIBRARY, the library to link against
-#  SDL_FOUND, if false, do not try to link to SDL
-#  SDL_INCLUDE_DIR, where to find SDL.h
-#
-MACRO(ADM_FIND_SDL)
-
-FIND_PROGRAM(SDL_EXECUTABLE
-  NAMES sdl-config
-  PATHS
-  $ENV{SDLDIR}/bin
-)
-if(SDL_EXECUTABLE)
-  MESSAGE(STATUS "sdl-config found ${SDL_EXECUTABLE}")
-# Check we can run it
-    SET(_return_VALUE TRUE)
-    IF(_return_VALUE)
-      EXEC_PROGRAM(sh ARGS "${SDL_EXECUTABLE} --libs"   OUTPUT_VARIABLE SDL_LDFLAGS )
-      EXEC_PROGRAM(sh ARGS "${SDL_EXECUTABLE} --cflags" OUTPUT_VARIABLE SDL_CFLAGS )
-      SET(SDL_FOUND TRUE)
-      MESSAGE(STATUS "cflags : ${SDL_CFLAGS}")
-      MESSAGE(STATUS "libs   : ${SDL_LDFLAGS}")
-  ENDIF(_return_VALUE)
-else(SDL_EXECUTABLE)
-  MESSAGE(STATUS "sdl-config not found ")
-endif(SDL_EXECUTABLE)
-
-ENDMACRO(ADM_FIND_SDL)
-
-MACRO(SDLify _source)
-if(SDL_FOUND)
-        SET_SOURCE_FILES_PROPERTIES(${_source}
-                                     PROPERTIES COMPILE_FLAGS ${SDL_CFLAGS}) 
-endif(SDL_FOUND)
-ENDMACRO(SDLify _source)
+# - Locate the SDL library using sdl-config
+# This module defines
+#  SDL_LIBRARY, the library to link against
+#  SDL_FOUND, if false, do not try to link to SDL
+#  SDL_INCLUDE_DIR, where to find SDL.h
+#
+MACRO(ADM_FIND_SDL)
+
+FIND_PROGRAM(SDL_EXECUTABLE
+  NAMES sdl-config
+  PATHS
+  $ENV{SDLDIR}/bin
+)
+if(SDL_EXECUTABLE)
+  MESSAGE(STATUS "sdl-config found ${SDL_EXECUTABLE}")
+# Check we can run it
+    SET(_return_VALUE TRUE)
+    IF(_return_VALUE)
+      EXEC_PROGRAM(sh ARGS "${SDL_EXECUTABLE} --libs"   OUTPUT_VARIABLE SDL_LDFLAGS )
+      EXEC_PROGRAM(sh ARGS "${SDL_EXECUTABLE} --cflags" OUTPUT_VARIABLE SDL_CFLAGS )
+      SET(SDL_FOUND TRUE)
+      MESSAGE(STATUS "cflags : ${SDL_CFLAGS}")
+      MESSAGE(STATUS "libs   : ${SDL_LDFLAGS}")
+  ENDIF(_return_VALUE)
+else(SDL_EXECUTABLE)
+  MESSAGE(STATUS "sdl-config not found ")
+endif(SDL_EXECUTABLE)
+
+ENDMACRO(ADM_FIND_SDL)
+
+MACRO(SDLify _source)
+if(SDL_FOUND)
+        SET_SOURCE_FILES_PROPERTIES(${_source}
+                                     PROPERTIES COMPILE_FLAGS ${SDL_CFLAGS}) 
+endif(SDL_FOUND)
+ENDMACRO(SDLify _source)

Modified: branches/avidemux_2.4_branch/cmake/adm_checkHeaderLib.cmake
===================================================================
--- branches/avidemux_2.4_branch/cmake/adm_checkHeaderLib.cmake	2007-07-28 16:47:43 UTC (rev 3453)
+++ branches/avidemux_2.4_branch/cmake/adm_checkHeaderLib.cmake	2007-07-28 17:03:19 UTC (rev 3454)
@@ -3,6 +3,9 @@
 MACRO (ADM_CHECK_HL _banner _includeName _libName _libFunc _varToSet)
 MESSAGE(STATUS "<Checking for ${_banner}>")
 MESSAGE(STATUS "<******************************>")
+if(NO_${_banner})
+message(status "<disabled per request>")
+else(NO_${_banner})
  SET(_oldCRF ${CMAKE_REQUIRED_FLAGS})
  SET(CMAKE_REQUIRED_FLAGS "$ENV{CFLAGS} ${_oldCRF}")
 #MESSAGE(STATUS "CMAKE_REQUIRED_FLAGS:${CMAKE_REQUIRED_FLAGS}")
@@ -29,6 +32,7 @@
      MESSAGE(STATUS "${_banner} support off")
 endif(${_varToSet})
 SET(CMAKE_REQUIRED_FLAGS "${_oldCRF}")
+endif(NO_${_banner})
 ENDMACRO (ADM_CHECK_HL _includeName _libName _libFunc _varToSet)
 
 

Modified: branches/avidemux_2.4_branch/cmake/adm_qt4.cmake
===================================================================
--- branches/avidemux_2.4_branch/cmake/adm_qt4.cmake	2007-07-28 16:47:43 UTC (rev 3453)
+++ branches/avidemux_2.4_branch/cmake/adm_qt4.cmake	2007-07-28 17:03:19 UTC (rev 3454)
@@ -1,59 +1,59 @@
-##############################################################"
-# FOR AQ
-# Q_foo.cpp and foo.ui => AQ_foo.cpp, ui_foo.h and Q_foo.moc
-##############################################################"
-MACRO(Q_UIMOCIFY _source)
-  ADD_CUSTOM_COMMAND(OUTPUT ${CMAKE_CURRENT_BINARY_DIR}/AQ_${_source}.cpp
-                     COMMAND  ${QT_UIC_EXECUTABLE} ${CMAKE_CURRENT_SOURCE_DIR}/${_source}.ui -o ui_${_source}.h
-                     COMMAND  ${QT_MOC_EXECUTABLE} ${CMAKE_CURRENT_SOURCE_DIR}/Q_${_source}.cpp -o Q_${_source}.moc
-                     COMMAND  echo "#include \"Q_${_source}.cpp\"" > AQ_${_source}.cpp
-                     COMMAND  echo "#include \"Q_${_source}.moc\"" >> AQ_${_source}.cpp
-                     DEPENDS  ${CMAKE_CURRENT_SOURCE_DIR}/${_source}.ui  ${CMAKE_CURRENT_SOURCE_DIR}/Q_${_source}.cpp
-                     VERBATIM
-                )
-ENDMACRO(Q_UIMOCIFY _source)
-
-##############################################################"
-# FOR 
-# foo.qrc->foo_rsc.cpp
-##############################################################"
-# $(RCC)  $< -o $@   -name filter
-MACRO(Q_RCC _source)
-  ADD_CUSTOM_COMMAND(OUTPUT   ${CMAKE_CURRENT_BINARY_DIR}/${_source}_rsc.cpp
-                     COMMAND  ${QT_RCC_EXECUTABLE} ${CMAKE_CURRENT_SOURCE_DIR}/${_source}.qrc -o ${_source}_rsc.cpp -name ${_source}
-                     DEPENDS  ${CMAKE_CURRENT_SOURCE_DIR}/${_source}.qrc
-                     VERBATIM
-                )
-ENDMACRO(Q_RCC _source)
-
-##############################################################"
-# FOR AT
-# T_foo.cpp i => AT_foo.cpp and T_foo.moc
-##############################################################"
-MACRO(Q_MOCIFY _source)
-  ADD_CUSTOM_COMMAND(OUTPUT ${CMAKE_CURRENT_BINARY_DIR}/AT_${_source}.cpp
-                     COMMAND  ${QT_MOC_EXECUTABLE} ${CMAKE_CURRENT_SOURCE_DIR}/T_${_source}.cpp -o T_${_source}.moc 
-                     COMMAND  echo "#include \"T_${_source}.cpp\"" > AT_${_source}.cpp
-                     COMMAND  echo "#include \"T_${_source}.moc\"" >> AT_${_source}.cpp
-                     DEPENDS  ${CMAKE_CURRENT_SOURCE_DIR}/T_${_source}.cpp
-                     VERBATIM
-                )
-ENDMACRO(Q_MOCIFY _source)
-
-# Add to our Targets..
-FOREACH(_current ${${ADM_LIB}_Q})
- Q_UIMOCIFY(${_current})
- SET(${ADM_LIB}_SRCS ${${ADM_LIB}_SRCS} ${CMAKE_CURRENT_BINARY_DIR}/AQ_${_current}.cpp)
-ENDFOREACH(_current ${${ADM_LIB}_Q})
-
-FOREACH(_current ${${ADM_LIB}_T})
- Q_MOCIFY(${_current})
- SET(${ADM_LIB}_SRCS ${${ADM_LIB}_SRCS} ${CMAKE_CURRENT_BINARY_DIR}/AT_${_current}.cpp)
-ENDFOREACH(_current ${${ADM_LIB}_T})
-
-include_directories(${CMAKE_CURRENT_SOURCE_DIR} ${CMAKE_CURRENT_BINARY_DIR})
-
-ADD_LIBRARY(${ADM_LIB} STATIC ${${ADM_LIB}_SRCS})
-ADD_ADM_LIB(${ADM_LIB} ADM_libraries)
-
-# EOF
+##############################################################"
+# FOR AQ
+# Q_foo.cpp and foo.ui => AQ_foo.cpp, ui_foo.h and Q_foo.moc
+##############################################################"
+MACRO(Q_UIMOCIFY _source)
+  ADD_CUSTOM_COMMAND(OUTPUT ${CMAKE_CURRENT_BINARY_DIR}/AQ_${_source}.cpp
+                     COMMAND  ${QT_UIC_EXECUTABLE} ${CMAKE_CURRENT_SOURCE_DIR}/${_source}.ui -o ui_${_source}.h
+                     COMMAND  ${QT_MOC_EXECUTABLE} ${CMAKE_CURRENT_SOURCE_DIR}/Q_${_source}.cpp -o Q_${_source}.moc
+                     COMMAND  echo "#include \"Q_${_source}.cpp\"" > AQ_${_source}.cpp
+                     COMMAND  echo "#include \"Q_${_source}.moc\"" >> AQ_${_source}.cpp
+                     DEPENDS  ${CMAKE_CURRENT_SOURCE_DIR}/${_source}.ui  ${CMAKE_CURRENT_SOURCE_DIR}/Q_${_source}.cpp
+                     VERBATIM
+                )
+ENDMACRO(Q_UIMOCIFY _source)
+
+##############################################################"
+# FOR 
+# foo.qrc->foo_rsc.cpp
+##############################################################"
+# $(RCC)  $< -o $@   -name filter
+MACRO(Q_RCC _source)
+  ADD_CUSTOM_COMMAND(OUTPUT   ${CMAKE_CURRENT_BINARY_DIR}/${_source}_rsc.cpp
+                     COMMAND  ${QT_RCC_EXECUTABLE} ${CMAKE_CURRENT_SOURCE_DIR}/${_source}.qrc -o ${_source}_rsc.cpp -name ${_source}
+                     DEPENDS  ${CMAKE_CURRENT_SOURCE_DIR}/${_source}.qrc
+                     VERBATIM
+                )
+ENDMACRO(Q_RCC _source)
+
+##############################################################"
+# FOR AT
+# T_foo.cpp i => AT_foo.cpp and T_foo.moc
+##############################################################"
+MACRO(Q_MOCIFY _source)
+  ADD_CUSTOM_COMMAND(OUTPUT ${CMAKE_CURRENT_BINARY_DIR}/AT_${_source}.cpp
+                     COMMAND  ${QT_MOC_EXECUTABLE} ${CMAKE_CURRENT_SOURCE_DIR}/T_${_source}.cpp -o T_${_source}.moc 
+                     COMMAND  echo "#include \"T_${_source}.cpp\"" > AT_${_source}.cpp
+                     COMMAND  echo "#include \"T_${_source}.moc\"" >> AT_${_source}.cpp
+                     DEPENDS  ${CMAKE_CURRENT_SOURCE_DIR}/T_${_source}.cpp
+                     VERBATIM
+                )
+ENDMACRO(Q_MOCIFY _source)
+
+# Add to our Targets..
+FOREACH(_current ${${ADM_LIB}_Q})
+ Q_UIMOCIFY(${_current})
+ SET(${ADM_LIB}_SRCS ${${ADM_LIB}_SRCS} ${CMAKE_CURRENT_BINARY_DIR}/AQ_${_current}.cpp)
+ENDFOREACH(_current ${${ADM_LIB}_Q})
+
+FOREACH(_current ${${ADM_LIB}_T})
+ Q_MOCIFY(${_current})
+ SET(${ADM_LIB}_SRCS ${${ADM_LIB}_SRCS} ${CMAKE_CURRENT_BINARY_DIR}/AT_${_current}.cpp)
+ENDFOREACH(_current ${${ADM_LIB}_T})
+
+include_directories(${CMAKE_CURRENT_SOURCE_DIR} ${CMAKE_CURRENT_BINARY_DIR})
+
+ADD_LIBRARY(${ADM_LIB} STATIC ${${ADM_LIB}_SRCS})
+ADD_ADM_LIB(${ADM_LIB} ADM_libraries)
+
+# EOF



From mean at mail.berlios.de  Sun Jul 29 08:56:34 2007
From: mean at mail.berlios.de (mean at BerliOS)
Date: Sun, 29 Jul 2007 08:56:34 +0200
Subject: [Avidemux-svn-commit] r3455 -
	branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI
Message-ID: <200707290656.l6T6uYnK009670@sheep.berlios.de>

Author: mean
Date: 2007-07-29 08:56:33 +0200 (Sun, 29 Jul 2007)
New Revision: 3455

Modified:
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/Makefile.am
Log:
[Automake] Add missing file

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/Makefile.am
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/Makefile.am	2007-07-28 17:03:19 UTC (rev 3454)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/Makefile.am	2007-07-29 06:56:33 UTC (rev 3455)
@@ -12,7 +12,8 @@
 DIA_tdeint.cpp DIA_v2v.cpp \
 DIA_lavDecoder.cpp  DIA_srt.cpp \
 DIA_animated.cpp \
-DIA_ocr.cpp
+DIA_ocr.cpp \
+DIA_tSub.cpp
 
 commonObjs:=$(subst .cpp,.o,$(libADM_CommonUI_a_SOURCES))
 



From mean at mail.berlios.de  Sun Jul 29 08:58:01 2007
From: mean at mail.berlios.de (mean at BerliOS)
Date: Sun, 29 Jul 2007 08:58:01 +0200
Subject: [Avidemux-svn-commit] r3456 -
	branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI
Message-ID: <200707290658.l6T6w1UZ009768@sheep.berlios.de>

Author: mean
Date: 2007-07-29 08:58:00 +0200 (Sun, 29 Jul 2007)
New Revision: 3456

Modified:
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/Makefile.am
Log:
[Automake] typo

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/Makefile.am
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/Makefile.am	2007-07-29 06:56:33 UTC (rev 3455)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/Makefile.am	2007-07-29 06:58:00 UTC (rev 3456)
@@ -13,7 +13,7 @@
 DIA_lavDecoder.cpp  DIA_srt.cpp \
 DIA_animated.cpp \
 DIA_ocr.cpp \
-DIA_tSub.cpp
+DIA_tsSub.cpp
 
 commonObjs:=$(subst .cpp,.o,$(libADM_CommonUI_a_SOURCES))
 



From mean at mail.berlios.de  Sun Jul 29 09:03:35 2007
From: mean at mail.berlios.de (mean at BerliOS)
Date: Sun, 29 Jul 2007 09:03:35 +0200
Subject: [Avidemux-svn-commit] r3457 -
	branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_libswscale
Message-ID: <200707290703.l6T73Z1o010065@sheep.berlios.de>

Author: mean
Date: 2007-07-29 09:03:35 +0200 (Sun, 29 Jul 2007)
New Revision: 3457

Modified:
   branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_libswscale/Makefile.am
Log:
[AUTOMAKE] Fix green screen

Modified: branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_libswscale/Makefile.am
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_libswscale/Makefile.am	2007-07-29 06:58:00 UTC (rev 3456)
+++ branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_libswscale/Makefile.am	2007-07-29 07:03:35 UTC (rev 3457)
@@ -16,5 +16,5 @@
 
 ####### kdevelop will overwrite this part!!! (end)############
 
-INCLUDES= $(all_includes)  -I../ADM_lavutil -I../ADM_utilities -I..
+INCLUDES= $(all_includes)  -I../ADM_lavutil -I../ADM_utilities -I.. -DCONFIG_GPL
 noinst_HEADERS = 



From mean at mail.berlios.de  Sun Jul 29 19:16:09 2007
From: mean at mail.berlios.de (mean at BerliOS)
Date: Sun, 29 Jul 2007 19:16:09 +0200
Subject: [Avidemux-svn-commit] r3458 - in
	branches/avidemux_2.4_branch/avidemux:
	ADM_userInterfaces/ADM_QT4/ADM_dialog ADM_video
Message-ID: <200707291716.l6THG9TF022616@sheep.berlios.de>

Author: mean
Date: 2007-07-29 19:16:06 +0200 (Sun, 29 Jul 2007)
New Revision: 3458

Added:
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_vobsub.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/vobsub.ui
Modified:
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/CMakeLists.txt
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_none.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Makefile.am
   branches/avidemux_2.4_branch/avidemux/ADM_video/ADM_vobsubinfo.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_video/ADM_vobsubinfo.h
Log:
[QT] Add dialog for vobsub (ugly)

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/CMakeLists.txt
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/CMakeLists.txt	2007-07-29 07:03:35 UTC (rev 3457)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/CMakeLists.txt	2007-07-29 17:16:06 UTC (rev 3458)
@@ -15,6 +15,7 @@
 resizing
 jobs
 working
+vobsub
 )
 #
 SET(${ADM_LIB}_T

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_none.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_none.cpp	2007-07-29 07:03:35 UTC (rev 3457)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_none.cpp	2007-07-29 17:16:06 UTC (rev 3458)
@@ -82,7 +82,7 @@
 uint8_t DIA_getEqualizer(EqualizerParam *param, AVDMGenericVideoStream *in){return 0;}
 uint8_t DIA_getMPdelogo(MPDELOGO_PARAM *param,AVDMGenericVideoStream *in){return 0;}
 //uint8_t DIA_getPartial(PARTIAL_CONFIG *param,AVDMGenericVideoStream *son,AVDMGenericVideoStream *previous){return 0;}
-uint8_t DIA_vobsub(vobSubParam *param){return 0;}
+//uint8_t DIA_vobsub(vobSubParam *param){return 0;}
 //uint8_t DIA_x264(COMPRES_PARAMS *config){return 0;}
 //uint8_t DIA_job(uint32_t nb,char **name){return 0;}
 uint8_t DIA_videoCodec (SelectCodecType * codec){return 0;}

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Makefile.am
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Makefile.am	2007-07-29 07:03:35 UTC (rev 3457)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Makefile.am	2007-07-29 17:16:06 UTC (rev 3458)
@@ -8,6 +8,7 @@
 AQ_contrast.cpp AQ_hue.cpp \
 AQ_srt.cpp \
 AT_index_pg.cpp DIA_x264.cpp \
+AQ_vobsub.cpp \
 DIA_srt.cpp
 
 INCLUDES = $(all_includes)  $(XML_CFLAGS)  $(FREETYPE_CFLAGS) -DADM_SUBVERSION=@ADM_SUBVERSION@ \

Copied: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_vobsub.cpp (from rev 3453, branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_srt.cpp)
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_srt.cpp	2007-07-28 16:47:43 UTC (rev 3453)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_vobsub.cpp	2007-07-29 17:16:06 UTC (rev 3458)
@@ -0,0 +1,150 @@
+/***************************************************************************
+                          Q_SRT.cpp  -  description
+                             -------------------
+
+    Handle the QT specific part of the fontsize & position dialog box
+    copyright            : (C) 2002/2007 by mean
+    email                : fixounet at free.fr
+ ***************************************************************************/
+
+/***************************************************************************
+ *                                                                         *
+ *   This program is free software; you can redistribute it and/or modify  *
+ *   it under the terms of the GNU General Public License as published by  *
+ *   the Free Software Foundation; either version 2 of the License, or     *
+ *   (at your option) any later version.                                   *
+ *                                                                         *
+ ***************************************************************************/
+
+#include <config.h>
+#include <string.h>
+#include <stdio.h>
+#include <math.h>
+
+#include "ui_vobsub.h"
+
+#include "default.h"
+#include "ADM_toolkit/toolkit.hxx"
+#include "ADM_toolkit/filesel.h"
+#include "ADM_image.h"
+#include "ADM_video/ADM_genvideo.hxx"
+#include "ADM_colorspace/ADM_rgb.h"
+
+#include "ADM_video/ADM_vobsubinfo.h"
+#include "ADM_video/ADM_vidVobSub.h"
+
+#include "ADM_assert.h"
+
+
+
+//
+//	Video is in YV12 Colorspace
+//
+//
+class Ui_vobsubWindow : public QDialog
+ {
+     Q_OBJECT
+ protected :
+	 vobSubParam *param;
+	 void  		 fillLanguage(const char *file);
+ public:
+     Ui_vobsubWindow(vobSubParam *param);
+     ~Ui_vobsubWindow();
+     Ui_DialogVobSub ui;
+     
+     void  gather(void);
+ public slots:
+ private slots:
+ 		void idxSel(bool i);
+ private:
+     
+ };
+  Ui_vobsubWindow::Ui_vobsubWindow(vobSubParam *parm)
+  {
+    uint32_t width,height;
+    	this->param=parm;
+        ui.setupUi(this);
+        connect( ui.pushButtonIdx,SIGNAL(clicked(bool)),this,SLOT(idxSel(bool)));
+        // Set what was there...
+        if(param->subname)
+        {
+    		ui.lineEditIdx->setText(param->subname);
+    		fillLanguage(param->subname);
+    		ui.comboBoxLanguage->setCurrentIndex(param->index);
+        }
+        
+  }
+  /**
+   * 	\fn gather
+   * 	\brief Collect info from dialog and fill the param struct with it
+   */
+void  Ui_vobsubWindow::gather(void)
+{
+	if(param->subname) ADM_dezalloc(param->subname);
+	param->subname=NULL;
+	param->subname=ADM_strdup(ui.lineEditIdx->text().toAscii().data());
+	param->index=ui.comboBoxLanguage->currentIndex();
+}
+/**
+ * 	\fn fillLanguage
+ *  \brief Update the language combobox with what's in the idx file
+ *  @param file : idx file (in)
+ */
+void  Ui_vobsubWindow::fillLanguage(const char *file)
+{
+	// Grab info also
+			 vobSubLanguage *lang=NULL;
+			 QComboBox *combo=(ui.comboBoxLanguage);
+			 
+			  combo->clear();
+			  lang=vobSubAllocateLanguage();
+			    
+			  if(vobSubGetLanguage(file,lang))
+			  {
+			      // add them
+			    for(int i=0;i<lang->nbLanguage;i++)
+			    {
+			    		combo->addItem(lang->language[i].name);
+			    }
+			  }
+			    // Destroy
+			  vobSubDestroyLanguage(lang);
+			  // Reset index
+			  ui.comboBoxLanguage->setCurrentIndex(0);
+}
+Ui_vobsubWindow::~Ui_vobsubWindow()
+{
+}
+
+void Ui_vobsubWindow::idxSel(bool i)
+{
+	char fileIdx[1024];
+	
+	if(FileSel_SelectRead(_("Select Idx File"),fileIdx,1023, NULL) && ADM_fileExist(fileIdx))
+	{
+		// Set entry
+		ui.lineEditIdx->setText(fileIdx);
+		fillLanguage(fileIdx);
+	}
+}
+
+
+/**
+      \fn     DIA_vobsub
+      \brief  Dialog to select vobsub file, language and shift. 
+*/
+uint8_t DIA_vobsub(vobSubParam *param)
+{
+        uint8_t ret=0;
+        Ui_vobsubWindow dialog(param);        
+        if(dialog.exec()==QDialog::Accepted)
+        {
+        	dialog.gather();
+            ret=1;
+        }
+        return ret;
+}
+//____________________________________
+// EOF
+
+

Copied: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/vobsub.ui (from rev 3453, branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/srt.ui)
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/srt.ui	2007-07-28 16:47:43 UTC (rev 3453)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/vobsub.ui	2007-07-29 17:16:06 UTC (rev 3458)
@@ -0,0 +1,113 @@
+<ui version="4.0" >
+ <class>DialogVobSub</class>
+ <widget class="QDialog" name="DialogVobSub" >
+  <property name="geometry" >
+   <rect>
+    <x>0</x>
+    <y>0</y>
+    <width>334</width>
+    <height>137</height>
+   </rect>
+  </property>
+  <property name="windowTitle" >
+   <string>Subtitle Font Size and Position</string>
+  </property>
+  <layout class="QGridLayout" >
+   <property name="margin" >
+    <number>9</number>
+   </property>
+   <property name="spacing" >
+    <number>6</number>
+   </property>
+   <item row="1" column="2" >
+    <widget class="QComboBox" name="comboBoxLanguage" />
+   </item>
+   <item row="2" column="2" >
+    <widget class="QSpinBox" name="spinBox" >
+     <property name="maximum" >
+      <number>20000</number>
+     </property>
+     <property name="minimum" >
+      <number>-2000</number>
+     </property>
+    </widget>
+   </item>
+   <item row="2" column="0" >
+    <widget class="QLabel" name="label_3" >
+     <property name="text" >
+      <string>Delay :</string>
+     </property>
+    </widget>
+   </item>
+   <item row="0" column="1" colspan="3" >
+    <widget class="QLineEdit" name="lineEditIdx" />
+   </item>
+   <item row="0" column="4" >
+    <widget class="QPushButton" name="pushButtonIdx" >
+     <property name="text" >
+      <string>Select File</string>
+     </property>
+    </widget>
+   </item>
+   <item row="1" column="0" colspan="2" >
+    <widget class="QLabel" name="label_2" >
+     <property name="text" >
+      <string>Language :</string>
+     </property>
+    </widget>
+   </item>
+   <item row="0" column="0" >
+    <widget class="QLabel" name="label" >
+     <property name="text" >
+      <string>Idx File :</string>
+     </property>
+    </widget>
+   </item>
+   <item row="3" column="3" colspan="2" >
+    <widget class="QDialogButtonBox" name="buttonBox" >
+     <property name="orientation" >
+      <enum>Qt::Horizontal</enum>
+     </property>
+     <property name="standardButtons" >
+      <set>QDialogButtonBox::Cancel|QDialogButtonBox::NoButton|QDialogButtonBox::Ok</set>
+     </property>
+    </widget>
+   </item>
+  </layout>
+ </widget>
+ <resources/>
+ <connections>
+  <connection>
+   <sender>buttonBox</sender>
+   <signal>accepted()</signal>
+   <receiver>DialogVobSub</receiver>
+   <slot>accept()</slot>
+   <hints>
+    <hint type="sourcelabel" >
+     <x>248</x>
+     <y>254</y>
+    </hint>
+    <hint type="destinationlabel" >
+     <x>157</x>
+     <y>274</y>
+    </hint>
+   </hints>
+  </connection>
+  <connection>
+   <sender>buttonBox</sender>
+   <signal>rejected()</signal>
+   <receiver>DialogVobSub</receiver>
+   <slot>reject()</slot>
+   <hints>
+    <hint type="sourcelabel" >
+     <x>316</x>
+     <y>260</y>
+    </hint>
+    <hint type="destinationlabel" >
+     <x>286</x>
+     <y>274</y>
+    </hint>
+   </hints>
+  </connection>
+ </connections>
+</ui>

Modified: branches/avidemux_2.4_branch/avidemux/ADM_video/ADM_vobsubinfo.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_video/ADM_vobsubinfo.cpp	2007-07-29 07:03:35 UTC (rev 3457)
+++ branches/avidemux_2.4_branch/avidemux/ADM_video/ADM_vobsubinfo.cpp	2007-07-29 17:16:06 UTC (rev 3458)
@@ -222,7 +222,7 @@
   return 1;
 }
 //*****************************************
-uint8_t vobSubGetLanguage(char *filename,vobSubLanguage *lingua)
+uint8_t vobSubGetLanguage(const char *filename,vobSubLanguage *lingua)
 {
   char str[1024];
   char s[16];

Modified: branches/avidemux_2.4_branch/avidemux/ADM_video/ADM_vobsubinfo.h
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_video/ADM_vobsubinfo.h	2007-07-29 07:03:35 UTC (rev 3457)
+++ branches/avidemux_2.4_branch/avidemux/ADM_video/ADM_vobsubinfo.h	2007-07-29 17:16:06 UTC (rev 3458)
@@ -52,7 +52,7 @@
 uint8_t vobSubRead(char *filename,int index,VobSubInfo **info);
 uint8_t destroySubInfo(VobSubInfo *sub);
 
-uint8_t         vobSubGetLanguage(char *filename,vobSubLanguage *lingua);
+uint8_t         vobSubGetLanguage(const char *filename,vobSubLanguage *lingua);
 vobSubLanguage  *vobSubAllocateLanguage(void);
 uint8_t         vobSubDestroyLanguage(vobSubLanguage *lingua);
 



From mean at mail.berlios.de  Mon Jul 30 19:41:12 2007
From: mean at mail.berlios.de (mean at BerliOS)
Date: Mon, 30 Jul 2007 19:41:12 +0200
Subject: [Avidemux-svn-commit] r3459 -
	branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_ocr
Message-ID: <200707301741.l6UHfC4T002360@sheep.berlios.de>

Author: mean
Date: 2007-07-30 19:41:12 +0200 (Mon, 30 Jul 2007)
New Revision: 3459

Modified:
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_ocr/adm_ocr.cpp
Log:
[OCR] Begin factorizing GTK code

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_ocr/adm_ocr.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_ocr/adm_ocr.cpp	2007-07-29 17:16:06 UTC (rev 3458)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_ocr/adm_ocr.cpp	2007-07-30 17:41:12 UTC (rev 3459)
@@ -119,10 +119,103 @@
     actionIgnore,
     actionCalibrate
 }ocrAction;
+
+/**************************
+ *  UI Dependant part
+ *************************/
+uint8_t ADM_ocrUpdateNbLines(void *ui,uint32_t cur,uint32_t total);
+uint8_t ADM_ocrUpdateNbGlyphs(void *ui,uint32_t nbGlyphs);
+uint8_t ADM_ocrUpdateTextAndTime(void *ui,char *decodedString,char *timeCode);
+uint8_t ADM_ocrDrawFull(void *d);
+uint8_t ADM_ocrUiEnd(void *d);
+void *ADM_ocrUiSetup(void);
 /* +++++++++++++++++++++++++++++++++++++++++++++++++++++++
         Main
    +++++++++++++++++++++++++++++++++++++++++++++++++++++++ */
-   
+uint8_t ADM_ocrUpdateNbLines(void *ui,uint32_t cur,uint32_t total)
+{
+char text[50];         
+         snprintf(text,50,"%03d/%03d",cur,total);
+         gtk_label_set_text(GTK_LABEL(WID(labelNbLines)),text);
+         return 1;
+}
+uint8_t ADM_ocrUpdateNbGlyphs(void *ui,uint32_t nbGlyphs)
+{
+char text[50];         
+         snprintf(text,50,"%03d",nbGlyphs);
+         gtk_label_set_text(GTK_LABEL(WID(labelNbGlyphs)),text);
+         return 1;
+}
+uint8_t ADM_ocrUpdateTextAndTime(void *ui,char *decodedString,char *timeCode)
+{
+             gtk_label_set_text(GTK_LABEL(WID(labelText)),decodedString);
+             gtk_label_set_text(GTK_LABEL(WID(labelTime)),timeCode);
+             return 1;
+}            
+uint8_t ADM_ocrDrawFull(void *d)
+{
+			UI_purge();
+             gui_draw();
+             UI_purge();
+             return 1;
+}
+
+uint8_t ADM_ocrUiEnd(void *d)
+{
+	GtkWidget *dialog=(GtkWidget *)d;
+	ADM_assert(dialog);
+		// Final round
+	    gtk_widget_set_sensitive(WID(frameBitmap),0);
+	   // gtk_widget_set_sensitive(WID(Current_Glyph),0);     
+	  
+	  
+	    gtk_unregister_dialog(dialog);
+	    gtk_widget_destroy(dialog);
+
+}
+void *ADM_ocrUiSetup(void)
+{
+	// Create UI && prepare callback
+	 	dialog=NULL;
+	    mainDisplay=NULL;
+	    smallDisplay=NULL;
+	    workArea=NULL;
+	    bitmap=NULL;
+	    sdata=NULL;
+	    clipW=0;
+	    clipH=0;
+	    dialog=DIA_ocr();
+	    gtk_register_dialog(dialog);
+	#define ASSOCIATE(x,y)   gtk_dialog_add_action_widget (GTK_DIALOG (dialog), WID(x),y)
+	    
+	    ASSOCIATE(buttonOk,   actionAccept);
+	    ASSOCIATE(buttonSkip,     actionSkip);
+	    ASSOCIATE(buttonSkipAll,     actionSkipAll);
+	    ASSOCIATE(buttonIgnore,   actionIgnore);
+	    ASSOCIATE(buttonCalibrate,   actionCalibrate);
+	    
+	   
+	    gtk_widget_show(dialog);
+	    //
+	    
+	//  disable
+	    
+	    mainDisplay=WID(drawingareaBitmap);
+	    smallDisplay=WID(drawingareaSmall);
+	    
+	   
+	    
+	    CONNECT(drawingareaBitmap,expose_event,gui_draw);
+	    CONNECT(drawingareaSmall,expose_event,gui_draw_small);
+
+	    CONNECT(entry,activate,cb_accept);
+	    return (void *)dialog;
+	
+}
+/**
+ * 		\fn 		ADM_ocr_engine
+ * 		\brief 		Common part of the OCR engine
+ */
 uint8_t ADM_ocr_engine(   ADM_OCR_SOURCE & source,const char *labelSrt,admGlyph *head)
 {
 // 
@@ -138,44 +231,11 @@
     char     text[1024];
     nbGlyphs=0;
     ReplyType reply;
+    void *ui=NULL;
     
-    dialog=NULL;
-    mainDisplay=NULL;
-    smallDisplay=NULL;
-    workArea=NULL;
-    bitmap=NULL;
-    sdata=NULL;
-    clipW=0;
-    clipH=0;
-
+    ui=ADM_ocrUiSetup();
     
-// Create UI && prepare callback
-    
-    dialog=DIA_ocr();
-    gtk_register_dialog(dialog);
-#define ASSOCIATE(x,y)   gtk_dialog_add_action_widget (GTK_DIALOG (dialog), WID(x),y)
-    
-    ASSOCIATE(buttonOk,   actionAccept);
-    ASSOCIATE(buttonSkip,     actionSkip);
-    ASSOCIATE(buttonSkipAll,     actionSkipAll);
-    ASSOCIATE(buttonIgnore,   actionIgnore);
-    ASSOCIATE(buttonCalibrate,   actionCalibrate);
-    
-   
-    gtk_widget_show(dialog);
-    //
-    
-//  disable
-    
-    mainDisplay=WID(drawingareaBitmap);
-    smallDisplay=WID(drawingareaSmall);
-    
-   
-    
-    CONNECT(drawingareaBitmap,expose_event,gui_draw);
-    CONNECT(drawingareaSmall,expose_event,gui_draw_small);
 
-    CONNECT(entry,activate,cb_accept);
 _again:    
     
     printf("Go go go\n");
@@ -259,10 +319,8 @@
            {                
                 UI_purge();  // Force redaw
            }
-           // Merge
-             UI_purge();
-             gui_draw();
-             UI_purge();
+           // Merge & draw
+             ADM_ocrDrawFull(ui);
              // OCR
               reply=ocrBitmap(workArea,w,h,decodedString,head);
               if(reply==ReplyClose) goto endIt;
@@ -275,7 +333,8 @@
                 }
              
              //
-             gtk_label_set_text(GTK_LABEL(WID(labelText)),decodedString);
+             
+             
              fprintf(out,"%d\n",seqNum++);
              uint16_t hh,mm,ss,ms;
              ms2time(startTime, &hh, &mm, &ss, &ms);
@@ -284,7 +343,7 @@
              // Update Timecode
              char timeCode[100];
              snprintf(timeCode,100,"%02d:%02d:%02d,%03d",hh,mm,ss,ms);
-             gtk_label_set_text(GTK_LABEL(WID(labelTime)),timeCode);
+             ADM_ocrUpdateTextAndTime(ui,decodedString,timeCode);
              
              ms2time(endTime, &hh, &mm, &ss, &ms);
              fprintf(out,"%02d:%02d:%02d,%03d\n",hh,mm,ss,ms);
@@ -293,25 +352,22 @@
              oldw=w;
              oldh=h;
              // Update infos
-             sprintf(text,"%03d/%03d",i+1,nbSub);
-             gtk_label_set_text(GTK_LABEL(WID(labelNbLines)),text);
-             sprintf(text,"%03d",nbGlyphs);
-             gtk_label_set_text(GTK_LABEL(WID(labelNbGlyphs)),text);
+             ADM_ocrUpdateNbLines(ui,i+1,nbSub);
+             ADM_ocrUpdateNbGlyphs(ui,nbGlyphs);
     }
 
 endIt:
-    // Final round
-    gtk_widget_set_sensitive(WID(frameBitmap),0);
-   // gtk_widget_set_sensitive(WID(Current_Glyph),0);     
-    if(bitmapSource)
-        delete bitmapSource;
-    bitmapSource=NULL;
+	ADM_ocrUiEnd(ui);
+	ui=NULL;
+    
     if(out) 
-        fclose(out);
-    out=NULL;
-    gtk_unregister_dialog(dialog);
-    gtk_widget_destroy(dialog);
-
+          fclose(out);
+      out=NULL;
+      
+      if(bitmapSource)
+    	        delete bitmapSource;
+    	    bitmapSource=NULL;
+      
     return 1;
 
 }
@@ -330,7 +386,7 @@
         return 1;
 
 }
-
+/************************ UI Dependant part ********************/
 /**
         Search throught the existing glyphs , if not present create it
         and append the text to decodedString



From mean at mail.berlios.de  Mon Jul 30 20:27:37 2007
From: mean at mail.berlios.de (mean at BerliOS)
Date: Mon, 30 Jul 2007 20:27:37 +0200
Subject: [Avidemux-svn-commit] r3460 - in
	branches/avidemux_2.4_branch/avidemux: ADM_ocr
	ADM_userInterfaces/ADM_GTK/ADM_ocr
Message-ID: <200707301827.l6UIRbr7004436@sheep.berlios.de>

Author: mean
Date: 2007-07-30 20:27:36 +0200 (Mon, 30 Jul 2007)
New Revision: 3460

Modified:
   branches/avidemux_2.4_branch/avidemux/ADM_ocr/ADM_ocr.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_ocr/ADM_ocrInternal.h
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_ocr/adm_ocr.cpp
Log:
[OCR]  Factorizing GTK code

Modified: branches/avidemux_2.4_branch/avidemux/ADM_ocr/ADM_ocr.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_ocr/ADM_ocr.cpp	2007-07-30 17:41:12 UTC (rev 3459)
+++ branches/avidemux_2.4_branch/avidemux/ADM_ocr/ADM_ocr.cpp	2007-07-30 18:27:36 UTC (rev 3460)
@@ -28,7 +28,6 @@
 static uint32_t minThreshold=0x80;
 
 /* In the UI related code */
-//extern ReplyType glyphToText(admGlyph *glyph);
 extern void UI_purge(void);
 
 extern uint8_t adm_estimate_glyphSize(admGlyph *glyph,uint32_t *minx, uint32_t *maxx,uint32_t *miny,uint32_t *maxy,int *raw);
@@ -135,7 +134,7 @@
          
          
             // printf("Found glyph: %lu %lu\n",colstart,colend);  
-            reply=handleGlyph(workArea,colstart,colend,w,bottom,top,head);
+            reply=handleGlyph(workArea,colstart,colend,w,bottom,top,head,decodedString);
             switch(reply)
                 {
                         case ReplySkip:break;
@@ -175,7 +174,8 @@
                 that case we use another method to extract the glyph.
                 We split it using leftturn method and do it again.
 */
-ReplyType handleGlyph(uint8_t *workArea,uint32_t start, uint32_t end,uint32_t w,uint32_t h,uint32_t base,admGlyph *head)
+ReplyType handleGlyph(uint8_t *workArea,uint32_t start, uint32_t end,uint32_t w,uint32_t h,uint32_t base,
+							admGlyph *head,char *decodedString)
 {
 uint8_t found=0;
 static int inc=1;
@@ -233,7 +233,7 @@
                 
                     if(lefty->width)
                     {
-                        reply=glyphToText(lefty,head);
+                        reply=glyphToText(lefty,head,decodedString);
                         if(reply!=ReplyOk)
                         {
                             printf("Glyph2text failed(1)\n");
@@ -253,7 +253,7 @@
             if(raw) delete [] raw;
             if(glyph->width)
             {
-                reply=glyphToText(glyph,head);
+                reply=glyphToText(glyph,head,decodedString);
                 if(reply!=ReplyOk)                 
                 {
                     printf("Glyph2text failed(2)\n");

Modified: branches/avidemux_2.4_branch/avidemux/ADM_ocr/ADM_ocrInternal.h
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_ocr/ADM_ocrInternal.h	2007-07-30 17:41:12 UTC (rev 3459)
+++ branches/avidemux_2.4_branch/avidemux/ADM_ocr/ADM_ocrInternal.h	2007-07-30 18:27:36 UTC (rev 3460)
@@ -22,13 +22,14 @@
 }ReplyType;
 
 // GUI independant part
-ReplyType handleGlyph(uint8_t *workArea,uint32_t start, uint32_t end,uint32_t w,uint32_t h,uint32_t base,admGlyph *head);
+ReplyType handleGlyph(uint8_t *workArea,uint32_t start, uint32_t end,uint32_t w,uint32_t h,uint32_t base,
+							admGlyph *head,char *decodedstring);
 ReplyType ocrBitmap(uint8_t *workArea,uint32_t w,uint32_t h,char *decodedString,admGlyph *head);
 uint8_t   mergeBitmap(uint8_t *bitin, uint8_t *bitout, uint8_t *maskin,uint32_t w, uint32_t h);
 void ocrUpdateMinThreshold(void);
 
 // In GUI dependant part
-ReplyType glyphToText(admGlyph *glyph,admGlyph *head);
+ReplyType glyphToText(admGlyph *glyph,admGlyph *head,char *decodedString);
 
 /**
  * \class ADM_BitmapSource

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_ocr/adm_ocr.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_ocr/adm_ocr.cpp	2007-07-30 17:41:12 UTC (rev 3459)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_ocr/adm_ocr.cpp	2007-07-30 18:27:36 UTC (rev 3460)
@@ -84,28 +84,13 @@
 extern  uint8_t DIA_vobsub(vobSubParam *param);
 //********************************************
 extern  GtkWidget *DIA_ocr(void);
-static gboolean   gui_draw( void );
-static gboolean   gui_draw_small( void );
-static void       displaySmall( admGlyph *glyph );
-static int        cb_accept(GtkObject * object, gpointer user_data);
 
-static GtkWidget *dialog=NULL;
-static GtkWidget *mainDisplay=NULL;
-static GtkWidget *smallDisplay=NULL;
-static uint32_t redraw_x,redraw_y;
-static uint32_t clipW=0,clipH=0;
+ReplyType glyphToText(admGlyph *glyph,admGlyph *head,char *decodedString);
 //********************************************
-//ReplyType glyphToText(admGlyph *glyph,admGlyph *head);
-static ReplyType setup(void);
-//********************************************
-static uint8_t ocrSaveGlyph(admGlyph *head);
 
-static uint8_t *workArea;
-static vobSubBitmap *bitmap;
-static uint8_t *sdata=NULL;
-static uint32_t nbGlyphs;
-static char decodedString[1024];
 
+
+
 typedef enum
 {
     actionLoadVob=10,
@@ -126,92 +111,14 @@
 uint8_t ADM_ocrUpdateNbLines(void *ui,uint32_t cur,uint32_t total);
 uint8_t ADM_ocrUpdateNbGlyphs(void *ui,uint32_t nbGlyphs);
 uint8_t ADM_ocrUpdateTextAndTime(void *ui,char *decodedString,char *timeCode);
-uint8_t ADM_ocrDrawFull(void *d);
+uint8_t ADM_ocrDrawFull(void *d,uint8_t *data);
 uint8_t ADM_ocrUiEnd(void *d);
-void *ADM_ocrUiSetup(void);
+void 	*ADM_ocrUiSetup(void);
+uint8_t ADM_ocrSetRedrawSize(uint32_t w,uint32_t h);
 /* +++++++++++++++++++++++++++++++++++++++++++++++++++++++
         Main
    +++++++++++++++++++++++++++++++++++++++++++++++++++++++ */
-uint8_t ADM_ocrUpdateNbLines(void *ui,uint32_t cur,uint32_t total)
-{
-char text[50];         
-         snprintf(text,50,"%03d/%03d",cur,total);
-         gtk_label_set_text(GTK_LABEL(WID(labelNbLines)),text);
-         return 1;
-}
-uint8_t ADM_ocrUpdateNbGlyphs(void *ui,uint32_t nbGlyphs)
-{
-char text[50];         
-         snprintf(text,50,"%03d",nbGlyphs);
-         gtk_label_set_text(GTK_LABEL(WID(labelNbGlyphs)),text);
-         return 1;
-}
-uint8_t ADM_ocrUpdateTextAndTime(void *ui,char *decodedString,char *timeCode)
-{
-             gtk_label_set_text(GTK_LABEL(WID(labelText)),decodedString);
-             gtk_label_set_text(GTK_LABEL(WID(labelTime)),timeCode);
-             return 1;
-}            
-uint8_t ADM_ocrDrawFull(void *d)
-{
-			UI_purge();
-             gui_draw();
-             UI_purge();
-             return 1;
-}
 
-uint8_t ADM_ocrUiEnd(void *d)
-{
-	GtkWidget *dialog=(GtkWidget *)d;
-	ADM_assert(dialog);
-		// Final round
-	    gtk_widget_set_sensitive(WID(frameBitmap),0);
-	   // gtk_widget_set_sensitive(WID(Current_Glyph),0);     
-	  
-	  
-	    gtk_unregister_dialog(dialog);
-	    gtk_widget_destroy(dialog);
-
-}
-void *ADM_ocrUiSetup(void)
-{
-	// Create UI && prepare callback
-	 	dialog=NULL;
-	    mainDisplay=NULL;
-	    smallDisplay=NULL;
-	    workArea=NULL;
-	    bitmap=NULL;
-	    sdata=NULL;
-	    clipW=0;
-	    clipH=0;
-	    dialog=DIA_ocr();
-	    gtk_register_dialog(dialog);
-	#define ASSOCIATE(x,y)   gtk_dialog_add_action_widget (GTK_DIALOG (dialog), WID(x),y)
-	    
-	    ASSOCIATE(buttonOk,   actionAccept);
-	    ASSOCIATE(buttonSkip,     actionSkip);
-	    ASSOCIATE(buttonSkipAll,     actionSkipAll);
-	    ASSOCIATE(buttonIgnore,   actionIgnore);
-	    ASSOCIATE(buttonCalibrate,   actionCalibrate);
-	    
-	   
-	    gtk_widget_show(dialog);
-	    //
-	    
-	//  disable
-	    
-	    mainDisplay=WID(drawingareaBitmap);
-	    smallDisplay=WID(drawingareaSmall);
-	    
-	   
-	    
-	    CONNECT(drawingareaBitmap,expose_event,gui_draw);
-	    CONNECT(drawingareaSmall,expose_event,gui_draw_small);
-
-	    CONNECT(entry,activate,cb_accept);
-	    return (void *)dialog;
-	
-}
 /**
  * 		\fn 		ADM_ocr_engine
  * 		\brief 		Common part of the OCR engine
@@ -221,6 +128,7 @@
 // 
     uint32_t nbSub=0;
     FILE *out=NULL;
+    vobSubBitmap *bitmap=NULL;
     ADM_BitmapSource *bitmapSource=NULL;
     uint32_t startTime,endTime;
     uint32_t w,h,oldw=0,oldh=0;
@@ -229,9 +137,11 @@
     uint32_t first,last;
     uint32_t seqNum;
     char     text[1024];
-    nbGlyphs=0;
     ReplyType reply;
     void *ui=NULL;
+    char decodedString[1024];
+    uint8_t *workArea=NULL;
+    uint32_t nbGlyphs=0;
     
     ui=ADM_ocrUiSetup();
     
@@ -242,11 +152,11 @@
     
     // Everything ready go go go 
          
-    redraw_x=redraw_y=0;
+   
     UI_purge();
 //  Time to go
     
-    gtk_widget_set_sensitive(WID(frameBitmap),1);
+    //gtk_widget_set_sensitive(WID(frameBitmap),1);
  
     out=fopen(labelSrt,"wb");
     if(!out)
@@ -308,8 +218,8 @@
            // 
            w=bitmap->_width;
            h=last-first+1;
-           redraw_x=w;
-           redraw_y=h;
+           
+           ADM_ocrSetRedrawSize(w,h);
            //**
            
            // Build
@@ -320,7 +230,7 @@
                 UI_purge();  // Force redaw
            }
            // Merge & draw
-             ADM_ocrDrawFull(ui);
+             ADM_ocrDrawFull(ui,workArea);
              // OCR
               reply=ocrBitmap(workArea,w,h,decodedString,head);
               if(reply==ReplyClose) goto endIt;
@@ -371,27 +281,26 @@
     return 1;
 
 }
-/**
-    \fn ocrSaveGlyph
-    \brief bridge to saveGlyph
-*/
-uint8_t ocrSaveGlyph(admGlyph *head)
-{
-  char *name=NULL;
-          GUI_FileSelWrite(_("Select Glyphfile to save to"), &name);
-        if(!name)
-            return 0;
-        saveGlyph(name,head,nbGlyphs);
-        ADM_dealloc(name);
-        return 1;
 
-}
 /************************ UI Dependant part ********************/
 /**
         Search throught the existing glyphs , if not present create it
         and append the text to decodedString
 */
-ReplyType glyphToText(admGlyph *glyph,admGlyph *head)
+
+static GtkWidget *dialog=NULL;
+static GtkWidget *mainDisplay=NULL;
+static GtkWidget *smallDisplay=NULL;
+
+static uint32_t clipW=0,clipH=0;
+
+static gboolean   gui_draw( void );
+static gboolean   gui_draw_small( void );
+static void       displaySmall( admGlyph *glyph );
+static int        cb_accept(GtkObject * object, gpointer user_data);
+
+
+ReplyType glyphToText(admGlyph *glyph,admGlyph *head,char *decodedString)
 {
  admGlyph *cand;
             //printf("2t: %d x %d\n",glyph->width,glyph->height);
@@ -422,7 +331,7 @@
                 case actionIgnore:
                         glyph->code=NULL;
                         insertInGlyphTree(head,glyph);
-                        nbGlyphs++;
+                        //*nbGl++;
                         break;
                 case actionCalibrate: return ReplyCalibrate;
                 case actionAccept:
@@ -433,7 +342,7 @@
                         insertInGlyphTree(head,glyph);
                         //printf("New glyph:%s\n",glyph->code);
                         strcat(decodedString,glyph->code);
-                        nbGlyphs++;
+                        //*nbGl++;
                        
                     }
                     else delete glyph;
@@ -464,11 +373,22 @@
            return ReplyOk;  
 
 }
+static int sx=0,sy=0,sw=0,sh=0;
+static int redraw_x=0,redraw_y=0;
+static uint8_t *drawing=NULL;
+static uint8_t *sdata=NULL;
+uint8_t ADM_ocrSetRedrawSize(uint32_t w,uint32_t h)
+{
+		redraw_x=w;
+		redraw_y=h;
+		return 1;
+}
 
 //*****************************************************************************************
 gboolean gui_draw( void )
 {
 static int lastx=0,lasty=0;
+	if(!drawing) return true;
     if(lastx!=redraw_x || lasty!=redraw_y)
         gtk_widget_set_usize(mainDisplay, redraw_x, redraw_y);
     lastx=redraw_x;
@@ -480,13 +400,12 @@
                         redraw_x,                          //width
                         redraw_y,                          //h*2, // heigth
                         GDK_RGB_DITHER_NONE,
-                        workArea, // buffer
+                        drawing, // buffer
                         redraw_x );
     return true;
 }
 //*****************************************************************************************
- static int sx=0,sy=0,sw=0,sh=0;
-
+ 
 void displaySmall( admGlyph *glyph)
 {
     if(sw!=glyph->width || sh!=glyph->height)
@@ -569,5 +488,84 @@
         gtk_signal_emit_by_name(GTK_OBJECT(WID(buttonOk)),"clicked",(gpointer)1);
         return 0;
 }
+uint8_t ADM_ocrUpdateNbLines(void *ui,uint32_t cur,uint32_t total)
+{
+char text[50];         
+         snprintf(text,50,"%03d/%03d",cur,total);
+         gtk_label_set_text(GTK_LABEL(WID(labelNbLines)),text);
+         return 1;
+}
+uint8_t ADM_ocrUpdateNbGlyphs(void *ui,uint32_t nbGlyphs)
+{
+char text[50];         
+         snprintf(text,50,"%03d",nbGlyphs);
+         gtk_label_set_text(GTK_LABEL(WID(labelNbGlyphs)),text);
+         return 1;
+}
+uint8_t ADM_ocrUpdateTextAndTime(void *ui,char *decodedString,char *timeCode)
+{
+             gtk_label_set_text(GTK_LABEL(WID(labelText)),decodedString);
+             gtk_label_set_text(GTK_LABEL(WID(labelTime)),timeCode);
+             return 1;
+}            
+uint8_t ADM_ocrDrawFull(void *d,uint8_t *data)
+{
+		    drawing=data;;
+			UI_purge();
+             gui_draw();
+             UI_purge();
+             return 1;
+}
 
+uint8_t ADM_ocrUiEnd(void *d)
+{
+	GtkWidget *dialog=(GtkWidget *)d;
+	ADM_assert(dialog);
+		// Final round
+	    gtk_widget_set_sensitive(WID(frameBitmap),0);
+	   // gtk_widget_set_sensitive(WID(Current_Glyph),0);     
+	  
+	  
+	    gtk_unregister_dialog(dialog);
+	    gtk_widget_destroy(dialog);
+
+}
+void *ADM_ocrUiSetup(void)
+{
+	// Create UI && prepare callback
+	 	dialog=NULL;
+	    mainDisplay=NULL;
+	    smallDisplay=NULL;
+	    drawing=NULL;
+	    sdata=NULL;
+	    clipW=0;
+	    clipH=0;
+	    dialog=DIA_ocr();
+	    gtk_register_dialog(dialog);
+	#define ASSOCIATE(x,y)   gtk_dialog_add_action_widget (GTK_DIALOG (dialog), WID(x),y)
+	    
+	    ASSOCIATE(buttonOk,   actionAccept);
+	    ASSOCIATE(buttonSkip,     actionSkip);
+	    ASSOCIATE(buttonSkipAll,     actionSkipAll);
+	    ASSOCIATE(buttonIgnore,   actionIgnore);
+	    ASSOCIATE(buttonCalibrate,   actionCalibrate);
+	    
+	   
+	    gtk_widget_show(dialog);
+	    //
+	    
+	//  disable
+	    
+	    mainDisplay=WID(drawingareaBitmap);
+	    smallDisplay=WID(drawingareaSmall);
+	    
+	   
+	    
+	    CONNECT(drawingareaBitmap,expose_event,gui_draw);
+	    CONNECT(drawingareaSmall,expose_event,gui_draw_small);
+
+	    CONNECT(entry,activate,cb_accept);
+	    return (void *)dialog;
+	
+}
 //;



From gruntster at mail.berlios.de  Mon Jul 30 20:51:01 2007
From: gruntster at mail.berlios.de (gruntster at mail.berlios.de)
Date: Mon, 30 Jul 2007 20:51:01 +0200
Subject: [Avidemux-svn-commit] r3461 - branches/avidemux_2.4_branch/cmake
Message-ID: <200707301851.l6UIp1sF007877@sheep.berlios.de>

Author: gruntster
Date: 2007-07-30 20:49:54 +0200 (Mon, 30 Jul 2007)
New Revision: 3461

Modified:
   branches/avidemux_2.4_branch/cmake/admSDL.cmake
   branches/avidemux_2.4_branch/cmake/adm_qt4.cmake
Log:
[CMake] support MinGW makefiles (MSYS is no longer required)

Modified: branches/avidemux_2.4_branch/cmake/admSDL.cmake
===================================================================
--- branches/avidemux_2.4_branch/cmake/admSDL.cmake	2007-07-30 18:27:36 UTC (rev 3460)
+++ branches/avidemux_2.4_branch/cmake/admSDL.cmake	2007-07-30 18:49:54 UTC (rev 3461)
@@ -14,14 +14,24 @@
 if(SDL_EXECUTABLE)
   MESSAGE(STATUS "sdl-config found ${SDL_EXECUTABLE}")
 # Check we can run it
-    SET(_return_VALUE TRUE)
-    IF(_return_VALUE)
-      EXEC_PROGRAM(sh ARGS "${SDL_EXECUTABLE} --libs"   OUTPUT_VARIABLE SDL_LDFLAGS )
-      EXEC_PROGRAM(sh ARGS "${SDL_EXECUTABLE} --cflags" OUTPUT_VARIABLE SDL_CFLAGS )
+    FIND_PROGRAM(SH_EXECUTABLE NAMES sh)
+
+    IF(SH_EXECUTABLE)
+      MESSAGE(STATUS "sh found ${SH_EXECUTABLE}")
+    
+      EXEC_PROGRAM(${SH_EXECUTABLE} ARGS "${SDL_EXECUTABLE} --libs"   OUTPUT_VARIABLE SDL_LDFLAGS )
+      EXEC_PROGRAM(${SH_EXECUTABLE} ARGS "${SDL_EXECUTABLE} --cflags" OUTPUT_VARIABLE SDL_CFLAGS )
       SET(SDL_FOUND TRUE)
+    ELSEIF(WIN32)
+      SET(SDL_FOUND TRUE)
+      SET(SDL_LDFLAGS "-L/mingw/lib -lmingw32 -lSDLmain -lSDL -mwindows")
+      SET(SDL_CFLAGS "-I/mingw/include/SDL -D_GNU_SOURCE=1 -Dmain=SDL_main")
+    ENDIF(SH_EXECUTABLE)
+    
+    IF(SDL_FOUND)
       MESSAGE(STATUS "cflags : ${SDL_CFLAGS}")
       MESSAGE(STATUS "libs   : ${SDL_LDFLAGS}")
-  ENDIF(_return_VALUE)
+    ENDIF(SDL_FOUND)
 else(SDL_EXECUTABLE)
   MESSAGE(STATUS "sdl-config not found ")
 endif(SDL_EXECUTABLE)

Modified: branches/avidemux_2.4_branch/cmake/adm_qt4.cmake
===================================================================
--- branches/avidemux_2.4_branch/cmake/adm_qt4.cmake	2007-07-30 18:27:36 UTC (rev 3460)
+++ branches/avidemux_2.4_branch/cmake/adm_qt4.cmake	2007-07-30 18:49:54 UTC (rev 3461)
@@ -2,6 +2,12 @@
 # FOR AQ
 # Q_foo.cpp and foo.ui => AQ_foo.cpp, ui_foo.h and Q_foo.moc
 ##############################################################"
+IF(WIN32)
+	SET(VERBATIM "")
+ELSE(WIN32)
+	SET(VERBATIM "VERBATIM")
+ENDIF(WIN32)
+
 MACRO(Q_UIMOCIFY _source)
   ADD_CUSTOM_COMMAND(OUTPUT ${CMAKE_CURRENT_BINARY_DIR}/AQ_${_source}.cpp
                      COMMAND  ${QT_UIC_EXECUTABLE} ${CMAKE_CURRENT_SOURCE_DIR}/${_source}.ui -o ui_${_source}.h
@@ -9,7 +15,7 @@
                      COMMAND  echo "#include \"Q_${_source}.cpp\"" > AQ_${_source}.cpp
                      COMMAND  echo "#include \"Q_${_source}.moc\"" >> AQ_${_source}.cpp
                      DEPENDS  ${CMAKE_CURRENT_SOURCE_DIR}/${_source}.ui  ${CMAKE_CURRENT_SOURCE_DIR}/Q_${_source}.cpp
-                     VERBATIM
+                     ${VERBATIM}
                 )
 ENDMACRO(Q_UIMOCIFY _source)
 
@@ -22,7 +28,7 @@
   ADD_CUSTOM_COMMAND(OUTPUT   ${CMAKE_CURRENT_BINARY_DIR}/${_source}_rsc.cpp
                      COMMAND  ${QT_RCC_EXECUTABLE} ${CMAKE_CURRENT_SOURCE_DIR}/${_source}.qrc -o ${_source}_rsc.cpp -name ${_source}
                      DEPENDS  ${CMAKE_CURRENT_SOURCE_DIR}/${_source}.qrc
-                     VERBATIM
+                     ${VERBATIM}
                 )
 ENDMACRO(Q_RCC _source)
 
@@ -36,7 +42,7 @@
                      COMMAND  echo "#include \"T_${_source}.cpp\"" > AT_${_source}.cpp
                      COMMAND  echo "#include \"T_${_source}.moc\"" >> AT_${_source}.cpp
                      DEPENDS  ${CMAKE_CURRENT_SOURCE_DIR}/T_${_source}.cpp
-                     VERBATIM
+                     ${VERBATIM}
                 )
 ENDMACRO(Q_MOCIFY _source)
 



From mean at mail.berlios.de  Tue Jul 31 08:24:45 2007
From: mean at mail.berlios.de (mean at BerliOS)
Date: Tue, 31 Jul 2007 08:24:45 +0200
Subject: [Avidemux-svn-commit] r3462 - in
	branches/avidemux_2.4_branch/avidemux: . ADM_ocr
	ADM_userInterfaces/ADM_GTK/ADM_ocr
	ADM_userInterfaces/ADM_NONE/ADM_dialog
	ADM_userInterfaces/ADM_QT4/ADM_dialog
Message-ID: <200707310624.l6V6Oj8Y011780@sheep.berlios.de>

Author: mean
Date: 2007-07-31 08:24:44 +0200 (Tue, 31 Jul 2007)
New Revision: 3462

Added:
   branches/avidemux_2.4_branch/avidemux/ADM_ocr/ADM_ocrEngine.cpp
Modified:
   branches/avidemux_2.4_branch/avidemux/ADM_ocr/ADM_ocrInternal.h
   branches/avidemux_2.4_branch/avidemux/ADM_ocr/CMakeLists.txt
   branches/avidemux_2.4_branch/avidemux/ADM_ocr/Makefile.am
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_ocr/adm_ocr.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_NONE/ADM_dialog/DIA_none.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_none.cpp
   branches/avidemux_2.4_branch/avidemux/CMakeLists.txt
Log:
[OCR] Split engine from Gtk

Copied: branches/avidemux_2.4_branch/avidemux/ADM_ocr/ADM_ocrEngine.cpp (from rev 3460, branches/avidemux_2.4_branch/avidemux/ADM_ocr/ADM_ocr.cpp)
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_ocr/ADM_ocr.cpp	2007-07-30 18:27:36 UTC (rev 3460)
+++ branches/avidemux_2.4_branch/avidemux/ADM_ocr/ADM_ocrEngine.cpp	2007-07-31 06:24:44 UTC (rev 3462)
@@ -0,0 +1,209 @@
+/***************************************************************************
+      UI independant part of the OCR engine
+      (C) 2007 Mean
+ ***************************************************************************/
+/***************************************************************************
+ *                                                                         *
+ *   This program is free software; you can redistribute it and/or modify  *
+ *   it under the terms of the GNU General Public License as published by  *
+ *   the Free Software Foundation; either version 2 of the License, or     *
+ *   (at your option) any later version.                                   *
+ *                                                                         *
+ ***************************************************************************/
+ #include "config.h"
+ #include <stdio.h>
+ #include <stdlib.h>
+ #include <string.h>
+ #include "ADM_assert.h"
+ #include "default.h"
+
+ #include "ADM_editor/ADM_edit.hxx"
+ #include "ADM_video/ADM_genvideo.hxx"
+
+ #include "ADM_ocr.h"
+ #include "ADM_ocrInternal.h"
+ #include "ADM_toolkit/toolkit.hxx"
+
+
+
+/**************************
+ *  UI Dependant part
+ *************************/
+uint8_t ADM_ocrUpdateNbLines(void *ui,uint32_t cur,uint32_t total);
+uint8_t ADM_ocrUpdateNbGlyphs(void *ui,uint32_t nbGlyphs);
+uint8_t ADM_ocrUpdateTextAndTime(void *ui,char *decodedString,char *timeCode);
+uint8_t ADM_ocrDrawFull(void *d,uint8_t *data);
+uint8_t ADM_ocrUiEnd(void *d);
+void 	*ADM_ocrUiSetup(void);
+uint8_t ADM_ocrSetRedrawSize(uint32_t w,uint32_t h);
+
+extern void UI_purge(void);
+/* +++++++++++++++++++++++++++++++++++++++++++++++++++++++
+        Main
+   +++++++++++++++++++++++++++++++++++++++++++++++++++++++ */
+
+/**
+ * 		\fn 		ADM_ocr_engine
+ * 		\brief 		Common part of the OCR engine
+ */
+uint8_t ADM_ocr_engine(   ADM_OCR_SOURCE & source,const char *labelSrt,admGlyph *head)
+{
+// 
+    uint32_t nbSub=0;
+    FILE *out=NULL;
+    vobSubBitmap *bitmap=NULL;
+    ADM_BitmapSource *bitmapSource=NULL;
+    uint32_t startTime,endTime;
+    uint32_t w,h,oldw=0,oldh=0;
+    uint32_t oldbitmapw=0;
+    uint32_t oldbitmaph=0;
+    uint32_t first,last;
+    uint32_t seqNum;
+    char     text[1024];
+    ReplyType reply;
+    void *ui=NULL;
+    char decodedString[1024];
+    uint8_t *workArea=NULL;
+    uint32_t nbGlyphs=0;
+    
+    ui=ADM_ocrUiSetup();
+    
+
+_again:    
+    
+    printf("Go go go\n");
+    
+    // Everything ready go go go 
+         
+   
+    UI_purge();
+//  Time to go
+    
+    //gtk_widget_set_sensitive(WID(frameBitmap),1);
+ 
+    out=fopen(labelSrt,"wb");
+    if(!out)
+    {
+       GUI_Error_HIG(_("Output file error"), _("Could not open \"%s\" for writing."), labelSrt);
+       goto endIt;
+    }
+    bitmapSource=ADM_buildBitmapSource(&source);
+    if(!bitmapSource)
+    {
+    	goto _again;
+    }
+    if(!bitmapSource->init(&source))
+    {
+    		printf("[OCR] Bitmap source failed\n");
+    		goto _again;
+    }
+    
+    nbSub=bitmapSource->getNbImages();
+   
+    if(!nbSub)
+    {
+      GUI_Error_HIG(_("Problem loading sub"), NULL);
+        delete bitmapSource;
+        bitmapSource=NULL;
+        goto _again;
+     }
+    seqNum=1;   // Sub number in srt file
+    oldw=oldh=0;
+    uint32_t eos;
+    //******************    
+    // Load all bitmaps
+    //******************
+    for(uint32_t i=0;i<nbSub;i++)
+    {
+            first=last=0;
+            bitmap=bitmapSource->getBitmap(i,&startTime, &endTime,&first,&last,&eos);
+            if(eos) break;
+            ADM_assert(last>=first);
+            
+            // something ?
+            if(!bitmap) continue;
+            if(first==last) continue;
+
+            // If the bitmap size changed or does not exist yet...
+            if(!workArea || oldbitmapw!=bitmap->_width || oldbitmaph!=bitmap->_height)
+            {
+              if(workArea) 
+              {
+                delete [] workArea;
+                workArea=NULL; 
+              }
+              // Workarea is actually bigger than what we use
+              workArea=new uint8_t[bitmap->_width*(bitmap->_height)];
+              memset(workArea,0,bitmap->_width*(bitmap->_height));
+            }
+            oldbitmaph=bitmap->_height;
+            oldbitmapw=bitmap->_width;
+           // 
+           w=bitmap->_width;
+           h=last-first+1;
+           
+           ADM_ocrSetRedrawSize(w,h);
+           //**
+           
+           // Build
+againPlease:
+           mergeBitmap(bitmap->_bitmap+first*w, workArea, bitmap->_alphaMask+first*w,  w,   h);
+           if(oldw!=w || oldh !=h)
+           {                
+                UI_purge();  // Force redaw
+           }
+           // Merge & draw
+             ADM_ocrDrawFull(ui,workArea);
+             // OCR
+              reply=ocrBitmap(workArea,w,h,decodedString,head);
+              if(reply==ReplyClose) goto endIt;
+              if(reply==ReplyCalibrate)
+                {
+                        //
+                        //printf("TADA!!!!\n");
+                        ocrUpdateMinThreshold();
+                        goto againPlease;
+                }
+             
+             //
+             
+             
+             fprintf(out,"%d\n",seqNum++);
+             uint16_t hh,mm,ss,ms;
+             ms2time(startTime, &hh, &mm, &ss, &ms);
+             fprintf(out,"%02d:%02d:%02d,%03d --> ",hh,mm,ss,ms);
+             
+             // Update Timecode
+             char timeCode[100];
+             snprintf(timeCode,100,"%02d:%02d:%02d,%03d",hh,mm,ss,ms);
+             ADM_ocrUpdateTextAndTime(ui,decodedString,timeCode);
+             
+             ms2time(endTime, &hh, &mm, &ss, &ms);
+             fprintf(out,"%02d:%02d:%02d,%03d\n",hh,mm,ss,ms);
+             fprintf(out,"%s\n\n",decodedString);
+             //             
+             oldw=w;
+             oldh=h;
+             // Update infos
+             ADM_ocrUpdateNbLines(ui,i+1,nbSub);
+             ADM_ocrUpdateNbGlyphs(ui,nbGlyphs);
+    }
+
+endIt:
+	ADM_ocrUiEnd(ui);
+	ui=NULL;
+    
+    if(out) 
+          fclose(out);
+      out=NULL;
+      
+      if(bitmapSource)
+    	        delete bitmapSource;
+    	    bitmapSource=NULL;
+      
+    return 1;
+
+}
+
+
+//EOF

Modified: branches/avidemux_2.4_branch/avidemux/ADM_ocr/ADM_ocrInternal.h
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_ocr/ADM_ocrInternal.h	2007-07-30 18:49:54 UTC (rev 3461)
+++ branches/avidemux_2.4_branch/avidemux/ADM_ocr/ADM_ocrInternal.h	2007-07-31 06:24:44 UTC (rev 3462)
@@ -26,7 +26,7 @@
 							admGlyph *head,char *decodedstring);
 ReplyType ocrBitmap(uint8_t *workArea,uint32_t w,uint32_t h,char *decodedString,admGlyph *head);
 uint8_t   mergeBitmap(uint8_t *bitin, uint8_t *bitout, uint8_t *maskin,uint32_t w, uint32_t h);
-void ocrUpdateMinThreshold(void);
+void 	  ocrUpdateMinThreshold(void);
 
 // In GUI dependant part
 ReplyType glyphToText(admGlyph *glyph,admGlyph *head,char *decodedString);
@@ -46,7 +46,6 @@
 			virtual vobSubBitmap *getBitmap(uint32_t nb,uint32_t *start, uint32_t *end,uint32_t *first,uint32_t *last,
 											uint32_t *eos)=0;
 };
-
 ADM_BitmapSource *ADM_buildBitmapSource(ADM_OCR_SOURCE *source);
 
 #endif 

Modified: branches/avidemux_2.4_branch/avidemux/ADM_ocr/CMakeLists.txt
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_ocr/CMakeLists.txt	2007-07-30 18:49:54 UTC (rev 3461)
+++ branches/avidemux_2.4_branch/avidemux/ADM_ocr/CMakeLists.txt	2007-07-31 06:24:44 UTC (rev 3462)
@@ -3,6 +3,7 @@
 adm_glyph.cpp  adm_leftturn.cpp  ADM_vob2vobsub.cpp
 ADM_ocr.cpp
 ADM_bitmapSource.cpp
+ADM_ocrEngine.cpp
 )
 ADD_LIBRARY(ADM_ocr STATIC ${ADM_ocr_SRCS})
 include_directories(../ADM_inputs)

Modified: branches/avidemux_2.4_branch/avidemux/ADM_ocr/Makefile.am
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_ocr/Makefile.am	2007-07-30 18:49:54 UTC (rev 3461)
+++ branches/avidemux_2.4_branch/avidemux/ADM_ocr/Makefile.am	2007-07-31 06:24:44 UTC (rev 3462)
@@ -7,7 +7,7 @@
 
 libADM_ocr_a_METASOURCES = AUTO
 
-libADM_ocr_a_SOURCES =   adm_glyph.cpp adm_leftturn.cpp ADM_vob2vobsub.cpp ADM_ocr.cpp ADM_bitmapSource.cpp
+libADM_ocr_a_SOURCES =   adm_glyph.cpp adm_leftturn.cpp ADM_vob2vobsub.cpp ADM_ocr.cpp ADM_bitmapSource.cpp ADM_ocrEngine.cpp
 
 
 EXTRA_DIST =  ADM_leftturn.h     ADM_vob2vobsub.cpp  adm_glyph.h  \

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_ocr/adm_ocr.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_ocr/adm_ocr.cpp	2007-07-30 18:49:54 UTC (rev 3461)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_ocr/adm_ocr.cpp	2007-07-31 06:24:44 UTC (rev 3462)
@@ -85,7 +85,7 @@
 //********************************************
 extern  GtkWidget *DIA_ocr(void);
 
-ReplyType glyphToText(admGlyph *glyph,admGlyph *head,char *decodedString);
+
 //********************************************
 
 
@@ -105,183 +105,7 @@
     actionCalibrate
 }ocrAction;
 
-/**************************
- *  UI Dependant part
- *************************/
-uint8_t ADM_ocrUpdateNbLines(void *ui,uint32_t cur,uint32_t total);
-uint8_t ADM_ocrUpdateNbGlyphs(void *ui,uint32_t nbGlyphs);
-uint8_t ADM_ocrUpdateTextAndTime(void *ui,char *decodedString,char *timeCode);
-uint8_t ADM_ocrDrawFull(void *d,uint8_t *data);
-uint8_t ADM_ocrUiEnd(void *d);
-void 	*ADM_ocrUiSetup(void);
-uint8_t ADM_ocrSetRedrawSize(uint32_t w,uint32_t h);
-/* +++++++++++++++++++++++++++++++++++++++++++++++++++++++
-        Main
-   +++++++++++++++++++++++++++++++++++++++++++++++++++++++ */
 
-/**
- * 		\fn 		ADM_ocr_engine
- * 		\brief 		Common part of the OCR engine
- */
-uint8_t ADM_ocr_engine(   ADM_OCR_SOURCE & source,const char *labelSrt,admGlyph *head)
-{
-// 
-    uint32_t nbSub=0;
-    FILE *out=NULL;
-    vobSubBitmap *bitmap=NULL;
-    ADM_BitmapSource *bitmapSource=NULL;
-    uint32_t startTime,endTime;
-    uint32_t w,h,oldw=0,oldh=0;
-    uint32_t oldbitmapw=0;
-    uint32_t oldbitmaph=0;
-    uint32_t first,last;
-    uint32_t seqNum;
-    char     text[1024];
-    ReplyType reply;
-    void *ui=NULL;
-    char decodedString[1024];
-    uint8_t *workArea=NULL;
-    uint32_t nbGlyphs=0;
-    
-    ui=ADM_ocrUiSetup();
-    
-
-_again:    
-    
-    printf("Go go go\n");
-    
-    // Everything ready go go go 
-         
-   
-    UI_purge();
-//  Time to go
-    
-    //gtk_widget_set_sensitive(WID(frameBitmap),1);
- 
-    out=fopen(labelSrt,"wb");
-    if(!out)
-    {
-       GUI_Error_HIG(_("Output file error"), _("Could not open \"%s\" for writing."), labelSrt);
-       goto endIt;
-    }
-    bitmapSource=ADM_buildBitmapSource(&source);
-    if(!bitmapSource)
-    {
-    	goto _again;
-    }
-    if(!bitmapSource->init(&source))
-    {
-    		printf("[OCR] Bitmap source failed\n");
-    		goto _again;
-    }
-    
-    nbSub=bitmapSource->getNbImages();
-   
-    if(!nbSub)
-    {
-      GUI_Error_HIG(_("Problem loading sub"), NULL);
-        delete bitmapSource;
-        bitmapSource=NULL;
-        goto _again;
-     }
-    seqNum=1;   // Sub number in srt file
-    oldw=oldh=0;
-    uint32_t eos;
-    //******************    
-    // Load all bitmaps
-    //******************
-    for(uint32_t i=0;i<nbSub;i++)
-    {
-            first=last=0;
-            bitmap=bitmapSource->getBitmap(i,&startTime, &endTime,&first,&last,&eos);
-            if(eos) break;
-            ADM_assert(last>=first);
-            
-            // something ?
-            if(!bitmap) continue;
-            if(first==last) continue;
-
-            // If the bitmap size changed or does not exist yet...
-            if(!workArea || oldbitmapw!=bitmap->_width || oldbitmaph!=bitmap->_height)
-            {
-              if(workArea) 
-              {
-                delete [] workArea;
-                workArea=NULL; 
-              }
-              // Workarea is actually bigger than what we use
-              workArea=new uint8_t[bitmap->_width*(bitmap->_height)];
-              memset(workArea,0,bitmap->_width*(bitmap->_height));
-            }
-            oldbitmaph=bitmap->_height;
-            oldbitmapw=bitmap->_width;
-           // 
-           w=bitmap->_width;
-           h=last-first+1;
-           
-           ADM_ocrSetRedrawSize(w,h);
-           //**
-           
-           // Build
-againPlease:
-           mergeBitmap(bitmap->_bitmap+first*w, workArea, bitmap->_alphaMask+first*w,  w,   h);
-           if(oldw!=w || oldh !=h)
-           {                
-                UI_purge();  // Force redaw
-           }
-           // Merge & draw
-             ADM_ocrDrawFull(ui,workArea);
-             // OCR
-              reply=ocrBitmap(workArea,w,h,decodedString,head);
-              if(reply==ReplyClose) goto endIt;
-              if(reply==ReplyCalibrate)
-                {
-                        //
-                        //printf("TADA!!!!\n");
-                        ocrUpdateMinThreshold();
-                        goto againPlease;
-                }
-             
-             //
-             
-             
-             fprintf(out,"%d\n",seqNum++);
-             uint16_t hh,mm,ss,ms;
-             ms2time(startTime, &hh, &mm, &ss, &ms);
-             fprintf(out,"%02d:%02d:%02d,%03d --> ",hh,mm,ss,ms);
-             
-             // Update Timecode
-             char timeCode[100];
-             snprintf(timeCode,100,"%02d:%02d:%02d,%03d",hh,mm,ss,ms);
-             ADM_ocrUpdateTextAndTime(ui,decodedString,timeCode);
-             
-             ms2time(endTime, &hh, &mm, &ss, &ms);
-             fprintf(out,"%02d:%02d:%02d,%03d\n",hh,mm,ss,ms);
-             fprintf(out,"%s\n\n",decodedString);
-             //             
-             oldw=w;
-             oldh=h;
-             // Update infos
-             ADM_ocrUpdateNbLines(ui,i+1,nbSub);
-             ADM_ocrUpdateNbGlyphs(ui,nbGlyphs);
-    }
-
-endIt:
-	ADM_ocrUiEnd(ui);
-	ui=NULL;
-    
-    if(out) 
-          fclose(out);
-      out=NULL;
-      
-      if(bitmapSource)
-    	        delete bitmapSource;
-    	    bitmapSource=NULL;
-      
-    return 1;
-
-}
-
 /************************ UI Dependant part ********************/
 /**
         Search throught the existing glyphs , if not present create it

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_NONE/ADM_dialog/DIA_none.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_NONE/ADM_dialog/DIA_none.cpp	2007-07-30 18:49:54 UTC (rev 3461)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_NONE/ADM_dialog/DIA_none.cpp	2007-07-31 06:24:44 UTC (rev 3462)
@@ -159,10 +159,50 @@
     printf("*********************************\n");
     printf("*********************************\n");
 }
+// OCR Stubs
+#include "ADM_ocr/ADM_ocr.h"
+#include "ADM_ocr/ADM_ocrInternal.h"
+
 uint8_t DIA_glyphEdit(void) {return 0;};
-#include "ADM_ocr/adm_glyph.h"
-uint8_t ADM_ocr_engine(   ADM_OCR_SOURCE & source,const char *labelSrt,admGlyph *head)
+
+uint8_t ADM_ocrUpdateNbLines(void *ui,uint32_t cur,uint32_t total)
 {
-  return 0; 
+	return 0;
 }
+uint8_t ADM_ocrUpdateNbGlyphs(void *ui,uint32_t nbGlyphs)
+{
+	return 0;
+}
+;
+uint8_t ADM_ocrUpdateTextAndTime(void *ui,char *decodedString,char *timeCode)
+{
+	return 0;
+}
+;
+uint8_t ADM_ocrDrawFull(void *d,uint8_t *data)
+{
+	return 0;
+}
+;
+uint8_t ADM_ocrUiEnd(void *d)
+{
+	return 0;
+}
+;
+void 	*ADM_ocrUiSetup(void)
+{
+	return 0;
+}
+;
+uint8_t ADM_ocrSetRedrawSize(uint32_t w,uint32_t h)
+{
+	return 0;
+}
+;
+
+ReplyType glyphToText(admGlyph *glyph,admGlyph *head,char *decodedString)
+{
+	return ReplyOk;
+}
+
 //EOF

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_none.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_none.cpp	2007-07-30 18:49:54 UTC (rev 3461)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_none.cpp	2007-07-31 06:24:44 UTC (rev 3462)
@@ -104,11 +104,49 @@
 {
   return 0; 
 }
+
+// OCR Stubs
 #include "ADM_ocr/ADM_ocr.h"
-uint8_t ADM_ocr_engine(   ADM_OCR_SOURCE & source,const char *labelSrt,admGlyph *head)
+#include "ADM_ocr/ADM_ocrInternal.h"
+uint8_t ADM_ocrUpdateNbLines(void *ui,uint32_t cur,uint32_t total)
 {
-  return 0; 
+	return 0;
 }
+uint8_t ADM_ocrUpdateNbGlyphs(void *ui,uint32_t nbGlyphs)
+{
+	return 0;
+}
+;
+uint8_t ADM_ocrUpdateTextAndTime(void *ui,char *decodedString,char *timeCode)
+{
+	return 0;
+}
+;
+uint8_t ADM_ocrDrawFull(void *d,uint8_t *data)
+{
+	return 0;
+}
+;
+uint8_t ADM_ocrUiEnd(void *d)
+{
+	return 0;
+}
+;
+void 	*ADM_ocrUiSetup(void)
+{
+	return 0;
+}
+;
+uint8_t ADM_ocrSetRedrawSize(uint32_t w,uint32_t h)
+{
+	return 0;
+}
+;
 
+ReplyType glyphToText(admGlyph *glyph,admGlyph *head,char *decodedString)
+{
+	return ReplyOk;
+}
+
 //EOF
 

Modified: branches/avidemux_2.4_branch/avidemux/CMakeLists.txt
===================================================================
--- branches/avidemux_2.4_branch/avidemux/CMakeLists.txt	2007-07-30 18:49:54 UTC (rev 3461)
+++ branches/avidemux_2.4_branch/avidemux/CMakeLists.txt	2007-07-31 06:24:44 UTC (rev 3462)
@@ -210,8 +210,8 @@
 
 if(GTK_FOUND)
 TARGET_LINK_LIBRARIES(avidemux2_gtk ADM_commonUI )
+TARGET_LINK_LIBRARIES(avidemux2_gtk ADM_ocr )
 TARGET_LINK_LIBRARIES(avidemux2_gtk ADM_ocrGtk )
-TARGET_LINK_LIBRARIES(avidemux2_gtk ADM_ocr )
 TARGET_LINK_LIBRARIES(avidemux2_gtk ADM_dialogGtk )
 TARGET_LINK_LIBRARIES(avidemux2_gtk ADM_filtersGtk )
 TARGET_LINK_LIBRARIES(avidemux2_gtk ADM_dialogFactoryGtk )



From mean at mail.berlios.de  Tue Jul 31 08:41:52 2007
From: mean at mail.berlios.de (mean at BerliOS)
Date: Tue, 31 Jul 2007 08:41:52 +0200
Subject: [Avidemux-svn-commit] r3463 - branches/avidemux_2.4_branch/avidemux
Message-ID: <200707310641.l6V6fq3I012669@sheep.berlios.de>

Author: mean
Date: 2007-07-31 08:41:52 +0200 (Tue, 31 Jul 2007)
New Revision: 3463

Modified:
   branches/avidemux_2.4_branch/avidemux/Makefile.am
Log:
[Automake] update for split ocr/gtk

Modified: branches/avidemux_2.4_branch/avidemux/Makefile.am
===================================================================
--- branches/avidemux_2.4_branch/avidemux/Makefile.am	2007-07-31 06:24:44 UTC (rev 3462)
+++ branches/avidemux_2.4_branch/avidemux/Makefile.am	2007-07-31 06:41:52 UTC (rev 3463)
@@ -22,7 +22,8 @@
 endif
 
 user_interface_gtk = \
-		./ADM_ocr/libADM_ocr.a					\
+		./ADM_toolkit/libADM_toolkit.a				\
+		./ADM_ocr/libADM_ocr.a	\
 		./ADM_userInterfaces/ADM_commonUI/libmergedCommonUI.o  \
 		./ADM_userInterfaces/ADM_GTK/ADM_ocr/libADM_ocrGtk.a	\
 		./ADM_userInterfaces/ADM_GTK/ADM_filters/libADM_filtersGtk.a \
@@ -32,15 +33,18 @@
 		./ADM_userInterfaces/ADM_GTK/ADM_toolkit_gtk/libADM_toolkit_gtk.a	 
 		
 user_interface_cli = \
+		./ADM_ocr/libADM_ocr.a	\
 		./ADM_userInterfaces/ADM_NONE/ADM_gui2/libADM_gui2.a	\
 		./ADM_userInterfaces/ADM_NONE/ADM_dialog/libADM_dialog.a	\
 		./ADM_userInterfaces/ADM_NONE/ADM_dialogFactory/libADM_dialogFactory.a	\
 		./ADM_userInterfaces/ADM_commonUI/libADM_CommonUI.a	\
 		./ADM_userInterfaces/ADM_NONE/ADM_gui2/libADM_gui2.a	\
-		./ADM_userInterfaces/ADM_NONE/ADM_filters/libADM_filters.a 
+		./ADM_userInterfaces/ADM_NONE/ADM_filters/libADM_filters.a \ 
+		./ADM_toolkit/libADM_toolkit.a				
 		
 		
 user_interface_qt4 = \
+			./ADM_ocr/libADM_ocr.a	\
 			./ADM_userInterfaces/ADM_QT4/ADM_gui/libADM_gui2.a	\
 			./ADM_userInterfaces/ADM_QT4/ADM_dialog/libADM_dialog.a	\
 			./ADM_userInterfaces/ADM_QT4/ADM_dialog/AQ_srt.o	\
@@ -48,7 +52,8 @@
 			./ADM_userInterfaces/ADM_commonUI/libADM_CommonUI.a	\
 			./ADM_userInterfaces/ADM_QT4/ADM_dialogFactory/libADM_dialogFactory.a	\
 			./ADM_userInterfaces/ADM_QT4/ADM_gui/libADM_gui2.a	\
-			./ADM_userInterfaces/ADM_QT4/ADM_filters/libADM_filters.a 
+			./ADM_userInterfaces/ADM_QT4/ADM_filters/libADM_filters.a \
+			./ADM_toolkit/libADM_toolkit.a				
 
 adm_src =   guiplay.cpp  \
 	gui_savenew.cpp  gui_navigate.cpp gtk_gui.cpp   \
@@ -100,7 +105,6 @@
 ./ADM_video/libADM_video.a				\
 ./ADM_colorspace/libADM_colorspace.a			\
 ./ADM_audiodevice/libADM_audiodevice.a			\
-./ADM_ocr/libADM_ocr.a					\
 ./ADM_outputs/oplug_mp4/liboplug_mp4.a			\
 ./ADM_outputs/oplug_mpeg/liboplug_mpeg.a		\
 ./ADM_outputs/oplug_mpegFF/liboplug_mpegFF.a		\
@@ -137,11 +141,9 @@
 ./ADM_libraries/ADM_xvidratectl/libADM_xvidratectl.a
 
 adm_postlib= \
-./ADM_toolkit/libADM_toolkit.a				\
 ./ADM_libraries/ADM_utilities/libADM_library.a		\
 ./ADM_osSupport/libADM_ossupport.a			\
 ./ADM_libraries/ADM_libswscale/libswscale.a		\
-./ADM_ocr/libADM_ocr.a					\
 $(libmpeg2enc_Altivec) \
 $(win32_icon)
 



From mean at mail.berlios.de  Tue Jul 31 19:36:02 2007
From: mean at mail.berlios.de (mean at BerliOS)
Date: Tue, 31 Jul 2007 19:36:02 +0200
Subject: [Avidemux-svn-commit] r3464 - in
	branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4:
	. ADM_ocr
Message-ID: <200707311736.l6VHa2xW002282@sheep.berlios.de>

Author: mean
Date: 2007-07-31 19:36:01 +0200 (Tue, 31 Jul 2007)
New Revision: 3464

Added:
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_ocr/
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_ocr/CMakeLists.txt
Log:
[QT] Skeleton for OCR

Added: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_ocr/CMakeLists.txt
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_ocr/CMakeLists.txt	2007-07-31 06:41:52 UTC (rev 3463)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_ocr/CMakeLists.txt	2007-07-31 17:36:01 UTC (rev 3464)
@@ -0,0 +1,24 @@
+################################
+#
+################################
+include(AdmLib)
+SET(ADM_LIB ADM_ocrQT4)
+#
+SET(${ADM_LIB}_Q
+ocr
+)
+#
+SET(${ADM_LIB}_T
+)
+#
+SET(${ADM_LIB}_SRCS
+)
+
+
+################################
+include(adm_qt4)
+################################
+include_directories(.. ../../../ADM_osSupport ../../../ADM_inputs)
+include_directories(${QT_INCLUDES})
+
+



From gruntster at mail.berlios.de  Tue Jul 31 21:51:54 2007
From: gruntster at mail.berlios.de (gruntster at mail.berlios.de)
Date: Tue, 31 Jul 2007 21:51:54 +0200
Subject: [Avidemux-svn-commit] r3465 - in
	branches/avidemux_2.4_branch/avidemux:
	ADM_libraries/ADM_mplex ADM_libraries/ADM_xvidratectl
	ADM_outputs/oplug_mpegFF
Message-ID: <200707311951.l6VJps7u012852@sheep.berlios.de>

Author: gruntster
Date: 2007-07-31 21:51:36 +0200 (Tue, 31 Jul 2007)
New Revision: 3465

Modified:
   branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_mplex/ADM_mplexmuxer.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_mplex/multiplexor.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_mplex/multiplexor.hpp
   branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_xvidratectl/ADM_oldxvid.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_xvidratectl/ADM_ratecontrol.h
   branches/avidemux_2.4_branch/avidemux/ADM_outputs/oplug_mpegFF/oplug_vcdff.cpp
Log:
fix mem leaks (DVD/xVCD + MPEG)

Modified: branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_mplex/ADM_mplexmuxer.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_mplex/ADM_mplexmuxer.cpp	2007-07-31 17:36:01 UTC (rev 3464)
+++ branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_mplex/ADM_mplexmuxer.cpp	2007-07-31 19:51:36 UTC (rev 3465)
@@ -182,7 +182,7 @@
         mplexStreamDescriptor audioDesc;
         mplexStreamDescriptor videoDesc;
 
-        printf("[Muxer Slave Thread] Slave thread : creating job & muxer\n");
+        printf("[Muxer Slave Thread] Creating job & muxer\n");
 
         
         printf("output file created\n");
@@ -205,10 +205,12 @@
         
         Multiplexor mux(job, *outputStream);
                
-        printf("Slave :Muxing\n");
+        printf("[Muxer Slave Thread] Muxing\n");
         mux.Multiplex();
+		mux.Close();
+
         slaveRunning=0;
-        printf("Slace Thread exiting\n");
+        printf("[Muxer Slave Thread] Exiting\n");
         pthread_exit(0);
 }        
 //___________________________________________________________________________

Modified: branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_mplex/multiplexor.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_mplex/multiplexor.cpp	2007-07-31 17:36:01 UTC (rev 3464)
+++ branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_mplex/multiplexor.cpp	2007-07-31 19:51:36 UTC (rev 3465)
@@ -63,7 +63,15 @@
 
 }
 
+void Multiplexor::Close(void)
+{
+	std::vector<ElementaryStream *>::iterator str;
 
+	for( str = estreams.begin(); str < estreams.end(); ++str )
+		delete (*str);
+}
+
+
 /******************************************************************
  *
  * Initialisation of stream syntax paramters based on selected user

Modified: branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_mplex/multiplexor.hpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_mplex/multiplexor.hpp	2007-07-31 17:36:01 UTC (rev 3464)
+++ branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_mplex/multiplexor.hpp	2007-07-31 19:51:36 UTC (rev 3465)
@@ -13,14 +13,11 @@
 class Multiplexor
 {
 public:
-	Multiplexor(MultiplexJob &job, OutputStream &output);
+	Multiplexor(MultiplexJob &job, OutputStream &output);	
+	void Close(void);
 	void Multiplex ();
-
-
-	void ByteposTimecode( bitcount_t bytepos, clockticks &ts );
-	
+	void ByteposTimecode( bitcount_t bytepos, clockticks &ts );	
 	inline Sys_header_struc *SystemHeader() { return &sys_header; }
-
 	unsigned int PacketPayload(	MuxStream &strm,
 								bool buffers, bool PTSstamp, bool DTSstamp );
 	unsigned int WritePacket( unsigned int     max_packet_data_size,

Modified: branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_xvidratectl/ADM_oldxvid.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_xvidratectl/ADM_oldxvid.cpp	2007-07-31 17:36:01 UTC (rev 3464)
+++ branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_xvidratectl/ADM_oldxvid.cpp	2007-07-31 19:51:36 UTC (rev 3465)
@@ -29,6 +29,11 @@
 	_state=RS_IDLE;
 	_nbFrames++;
 }
+
+ADM_ratecontrol::~ADM_ratecontrol()
+{
+	delete _logname;
+}
 #if 0 // RMED
 extern "C" {
 #include "ADM_encoder/xvid_vbr.h"
@@ -42,7 +47,6 @@
 		vbrFinish(&mpegvbr);
 	}
 	_state=RS_IDLE;
-
 }
 //
 ADM_oldXvidRc::ADM_oldXvidRc(uint32_t fps1000, char *logname) : ADM_ratecontrol(fps1000,logname)

Modified: branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_xvidratectl/ADM_ratecontrol.h
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_xvidratectl/ADM_ratecontrol.h	2007-07-31 17:36:01 UTC (rev 3464)
+++ branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_xvidratectl/ADM_ratecontrol.h	2007-07-31 19:51:36 UTC (rev 3465)
@@ -43,7 +43,7 @@
 		ADM_rstate _state;
 public:
 			ADM_ratecontrol(uint32_t fps1000, char *logname);
-	virtual 	~ADM_ratecontrol() {};
+	virtual 	~ADM_ratecontrol();
 	/** Maxbr & minbr in Bps, vbvsize in kBytes); Default is none */
 	virtual 	uint8_t setVBVInfo(uint32_t maxbr,uint32_t minbr, uint32_t vbvsize) FORBIDDEN ;
 	virtual		uint8_t startPass1( void )FORBIDDEN;

Modified: branches/avidemux_2.4_branch/avidemux/ADM_outputs/oplug_mpegFF/oplug_vcdff.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_outputs/oplug_mpegFF/oplug_vcdff.cpp	2007-07-31 17:36:01 UTC (rev 3464)
+++ branches/avidemux_2.4_branch/avidemux/ADM_outputs/oplug_mpegFF/oplug_vcdff.cpp	2007-07-31 19:51:36 UTC (rev 3465)
@@ -91,15 +91,13 @@
 uint8_t oplug_mpegff(const char *name, ADM_OUT_FORMAT type)
 {
 AVDMGenericVideoStream *_incoming;
-//EncoderFFMPEGMpeg1  *encoder;
-Encoder  *encoder;
-
+Encoder  *encoder=NULL;
 ADMMpegMuxer	*muxer=NULL;
 FILE 		*file=NULL;
 uint8_t		audioBuffer[48000];
 uint32_t	audioLen=0;
 uint32_t _w,_h,_fps1000,_page,total;	
-AVDMGenericAudioStream	*audio;
+AVDMGenericAudioStream	*audio=NULL;
 uint32_t len,flags;
 uint32_t size;
 ADM_MUXER_TYPE mux;
@@ -110,6 +108,7 @@
 uint32_t  total_sample=0;
 ADMBitstream bitstream(0);
 uint32_t audioSum=0;
+DIA_encoding  *encoding;
 
         twoPass=new char[strlen(name)+6];
         twoFake=new char[strlen(name)+6];
@@ -141,7 +140,7 @@
                     if(!currentaudiostream)
                     {
                       GUI_Error_HIG(_("There is no audio track"), NULL);
-                        return 0;
+					  goto finishvcdff;
                     }
                     audio=mpt_getAudioStream();
                     mux=MUXER_TS;
@@ -152,7 +151,7 @@
                 if(!currentaudiostream)
                 {
                   GUI_Error_HIG(_("There is no audio track"), NULL);
-                        return 0;
+				  goto finishvcdff;
                 }
                 audio=mpt_getAudioStream();
                 // Have to check the type
@@ -162,7 +161,7 @@
                 if(!audio)
                 {
                   GUI_Error_HIG(_("Audio track is not suitable"), NULL);
-                        return 0;
+				  goto finishvcdff;
                 }
                 // Check
                 WAVHeader *hdr=audio->getInfo();	
@@ -172,8 +171,7 @@
                         if(hdr->frequency!=44100 ||  hdr->encoding != WAV_MP2)
                         {
                             GUI_Error_HIG(("Incompatible audio"),_( "For VCD, audio must be 44.1 kHz MP2."));
-                            deleteAudioFilter(audio);
-                            return 0;
+							goto finishvcdff;
                         }
                         mux=MUXER_VCD;
                         printf("X*CD: Using VCD PS\n");
@@ -192,9 +190,8 @@
                             if(hdr->frequency!=48000 || 
                                 (hdr->encoding != WAV_MP2 && hdr->encoding!=WAV_AC3 && hdr->encoding!=WAV_LPCM))
                             {
-                                deleteAudioFilter(audio);
                                 GUI_Error_HIG(_("Incompatible audio"), _("For DVD, audio must be 48 kHz MP2, AC3 or LPCM."));
-                                return 0 ;
+								goto finishvcdff;
                             }
                             mux=MUXER_DVD;
                             printf("X*VCD: Using DVD PS\n");
@@ -248,19 +245,14 @@
 
       encoder->setLogFile(twoPass,total);
       if(!encoder->configure(_incoming))
-      {
-              delete encoder;
-              return 0;
-      }
+              goto finishvcdff;
 
-
       _buffer=new uint8_t[_page]; // Might overflow if _page only
       _outbuffer=new uint8_t[_page];
 
       ADM_assert(  _buffer);
       ADM_assert(  _outbuffer);
-    
-      DIA_encoding  *encoding;
+
       encoding =new DIA_encoding(_fps1000);
       switch(current_codec)
       {
@@ -329,10 +321,7 @@
                                         }
                                         encoding->setFrame(i,bitstream.len,bitstream.out_quantizer,total);
                                         if(!encoding->isAlive())
-                                        {
-
                                               goto finishvcdff;
-                                        }
                                 }
                         }
                         encoder->startPass2();
@@ -358,11 +347,8 @@
               {
                 if(!muxer->open(name,0,mux,avifileinfo,audio->getInfo()))
                 {
-                  delete muxer;
-                  muxer=NULL;
-                  deleteAudioFilter(audio);
                   printf("Muxer init failed\n");
-                  return 0 ;
+				  goto finishvcdff;
                 }
                 double sample_time;
 
@@ -378,7 +364,7 @@
                 if(!file)
                 {
                   GUI_Error_HIG(_("File error"), _("Cannot open \"%s\" for writing."), name);
-                  return 0 ;
+				  goto finishvcdff;
                 }
               }
           if(encoder->isDualPass())
@@ -435,7 +421,6 @@
                  {
                    printf("[mpegFF]Both audio & video done\n");
                    if(context.audioDone==1 && context.videoDone==1) ret=1;
-                   else ret=0;
                    accessMutex.unlock();
                    goto finishvcdff;
                  }
@@ -454,7 +439,6 @@
              {
                printf("[mpegFF]Both audio & video done\n");
                if(context.audioDone==1 && context.videoDone==1) ret=1;
-               else ret=0;
                accessMutex.unlock();
                goto finishvcdff;
              }
@@ -515,31 +499,31 @@
                 encoding->setFrame(i,bitstream.len,bitstream.out_quantizer,total);
                 encoding->setAudioSize(audioSum);
                 if(!encoding->isAlive ())
-                        {
-                                  ret=0;        
                                   goto finishvcdff;
-                        }
         }
         ret=1;
 finishvcdff:
         printf("[MPEGFF] Finishing..\n");
         delete encoding;
         end();
+
         if(file)
         {
                 fclose(file);
                 file=NULL;
         }
-        else
-        {  
-            if(muxer)
-            {
+        else if(muxer)
+        {
                 muxer->close();
                 delete muxer;
                 muxer=NULL;
-            }
         }
+
         delete encoder;
+
+		if (audio)
+			deleteAudioFilter(audio);
+
         return ret;
 }
 	



