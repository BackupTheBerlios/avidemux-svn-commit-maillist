<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Avidemux-svn-commit] r2942 - in	branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces:	ADM_GTK/ADM_dialogFactory ADM_NONE/ADM_dialogFactory	ADM_QT4/ADM_dialogFactory ADM_commonUI
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/avidemux-svn-commit/2007-April/index.html" >
   <LINK REL="made" HREF="mailto:avidemux-svn-commit%40lists.berlios.de?Subject=Re%3A%20%5BAvidemux-svn-commit%5D%20r2942%20-%20in%0A%09branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces%3A%0A%09ADM_GTK/ADM_dialogFactory%20ADM_NONE/ADM_dialogFactory%0A%09ADM_QT4/ADM_dialogFactory%20ADM_commonUI&In-Reply-To=%3C200704151032.l3FAWN0N019147%40sheep.berlios.de%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000259.html">
   <LINK REL="Next"  HREF="000261.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Avidemux-svn-commit] r2942 - in	branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces:	ADM_GTK/ADM_dialogFactory ADM_NONE/ADM_dialogFactory	ADM_QT4/ADM_dialogFactory ADM_commonUI</H1>
    <B>mean at BerliOS</B> 
    <A HREF="mailto:avidemux-svn-commit%40lists.berlios.de?Subject=Re%3A%20%5BAvidemux-svn-commit%5D%20r2942%20-%20in%0A%09branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces%3A%0A%09ADM_GTK/ADM_dialogFactory%20ADM_NONE/ADM_dialogFactory%0A%09ADM_QT4/ADM_dialogFactory%20ADM_commonUI&In-Reply-To=%3C200704151032.l3FAWN0N019147%40sheep.berlios.de%3E"
       TITLE="[Avidemux-svn-commit] r2942 - in	branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces:	ADM_GTK/ADM_dialogFactory ADM_NONE/ADM_dialogFactory	ADM_QT4/ADM_dialogFactory ADM_commonUI">mean at mail.berlios.de
       </A><BR>
    <I>Sun Apr 15 12:32:23 CEST 2007</I>
    <P><UL>
        <LI>Previous message: <A HREF="000259.html">[Avidemux-svn-commit] r2941 - branches/avidemux_2.4_branch
</A></li>
        <LI>Next message: <A HREF="000261.html">[Avidemux-svn-commit] r2943 - in	branches/avidemux_2.4_branch/avidemux: ADM_script	ADM_userInterfaces/ADM_GTK/ADM_dialogFactory	ADM_userInterfaces/ADM_NONE/ADM_dialogFactory	ADM_userInterfaces/ADM_QT4/ADM_dialogFactory	ADM_userInterfaces/ADM_commonUI
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#260">[ date ]</a>
              <a href="thread.html#260">[ thread ]</a>
              <a href="subject.html#260">[ subject ]</a>
              <a href="author.html#260">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Author: mean
Date: 2007-04-15 12:32:22 +0200 (Sun, 15 Apr 2007)
New Revision: 2942

Added:
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialogFactory/FAC_frame.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialogFactory/FAC_frame.cpp
Modified:
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialogFactory/Makefile.am
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_NONE/ADM_dialogFactory/FAC_toggle.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialogFactory/Makefile.am
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_factory.h
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp
Log:
added new widget frame (gtk only)

Added: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialogFactory/FAC_frame.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialogFactory/FAC_frame.cpp	2007-04-14 19:25:59 UTC (rev 2941)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialogFactory/FAC_frame.cpp	2007-04-15 10:32:22 UTC (rev 2942)
@@ -0,0 +1,106 @@
+/***************************************************************************
+  FAC_toggle.cpp
+  Handle dialog factory element : Toggle
+  (C) 2006 Mean <A HREF="https://lists.berlios.de/mailman/listinfo/avidemux-svn-commit">Fixounet at free.fr</A> 
+***************************************************************************/
+
+/***************************************************************************
+ *                                                                         *
+ *   This program is free software; you can redistribute it and/or modify  *
+ *   it under the terms of the GNU General Public License as published by  *
+ *   the Free Software Foundation; either version 2 of the License, or     *
+ *   (at your option) any later version.                                   *
+ *                                                                         *
+ ***************************************************************************/
+
+#include &lt;config.h&gt;
+
+
+#include &lt;string.h&gt;
+#include &lt;stdio.h&gt;
+#include &lt;math.h&gt;
+
+#include &quot;default.h&quot;
+#include &quot;ADM_toolkit_gtk/ADM_gladeSupport.h&quot;
+#include &quot;ADM_toolkit_gtk/toolkit_gtk.h&quot;
+#include &quot;ADM_toolkit_gtk/toolkit_gtk_include.h&quot;
+#include &quot;ADM_commonUI/DIA_factory.h&quot;
+#include &quot;ADM_assert.h&quot;
+
+
+diaElemFrame::diaElemFrame(const char *toggleTitle, const char *tip)
+  : diaElem(ELEM_FRAME)
+{
+  param=NULL;
+  paramTitle=toggleTitle;
+  this-&gt;tip=tip;
+  nbElems=0;
+  frameSize=0;
+  setSize(2);
+}
+void diaElemFrame::swallow(diaElem *widget)
+{
+  elems[nbElems]=widget;
+  frameSize+=widget-&gt;getSize();
+ // setSize(frameSize);
+  nbElems++;
+  ADM_assert(nbElems&lt;DIA_MAX_FRAME); 
+  
+}
+diaElemFrame::~diaElemFrame()
+{
+  
+}
+void diaElemFrame::setMe(void *dialog, void *opaque,uint32_t line)
+{
+  
+  GtkWidget *label;
+  GtkWidget *table;
+  char str[200];
+  
+  
+  sprintf(str,&quot;&lt;b&gt;%s&lt;/b&gt;&quot;,paramTitle);
+  label = gtk_label_new (str);
+  gtk_label_set_use_markup (GTK_LABEL (label), TRUE);
+  gtk_widget_show(label);
+  
+   table = gtk_table_new (frameSize, 2, FALSE);
+   
+  gtk_table_set_col_spacings (GTK_TABLE (table), 12);
+  gtk_table_set_row_spacings (GTK_TABLE (table), 6);
+  gtk_container_set_border_width (GTK_CONTAINER (table), 6);
+  
+   
+   gtk_widget_show(table);
+   
+   gtk_table_attach (GTK_TABLE (opaque), label, 0, 1, line, line+1,
+                    (GtkAttachOptions) (GTK_EXPAND | GTK_FILL),
+                    (GtkAttachOptions) (0), 0, 1);
+
+   gtk_misc_set_alignment (GTK_MISC (label), 0, 1);
+
+   gtk_table_attach (GTK_TABLE (opaque), table, 0, 2, line+1, line+2,
+                    (GtkAttachOptions) (GTK_EXPAND | GTK_FILL),
+                    (GtkAttachOptions) (0), 0, 0);
+    
+    
+  uint32_t v=0;
+  for(int i=0;i&lt;nbElems;i++)
+  {
+    elems[i]-&gt;setMe(dialog,table,v); 
+    v+=elems[i]-&gt;getSize();
+  }
+}
+void diaElemFrame::getMe(void)
+{
+   for(int i=0;i&lt;nbElems;i++)
+  {
+    elems[i]-&gt;getMe(); 
+  }
+}
+void diaElemFrame::enable(uint32_t onoff)
+{
+//   GtkWidget *widget=(GtkWidget *)myWidget;
+//   gtk_widget_set_sensitive(GTK_WIDGET(myWidget),onoff);
+}
+//EOF

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialogFactory/Makefile.am
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialogFactory/Makefile.am	2007-04-14 19:25:59 UTC (rev 2941)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialogFactory/Makefile.am	2007-04-15 10:32:22 UTC (rev 2942)
@@ -8,7 +8,16 @@
 
 libADM_dialogFactory_a_METASOURCES = AUTO
 
-libADM_dialogFactory_a_SOURCES = DIA_dialogFactory.cpp FAC_toggle.cpp FAC_integer.cpp FAC_float.cpp FAC_menu.cpp \
-				DIA_filesel.cpp FAC_bitrate.cpp FAC_bar.cpp FAC_readOnlyText.cpp FAC_notch.cpp
+libADM_dialogFactory_a_SOURCES = DIA_dialogFactory.cpp \
+FAC_toggle.cpp \
+FAC_integer.cpp \
+FAC_float.cpp \
+FAC_menu.cpp \
+DIA_filesel.cpp \
+FAC_bitrate.cpp \
+FAC_bar.cpp \
+FAC_readOnlyText.cpp \
+FAC_notch.cpp \
+FAC_frame.cpp
 
 

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_NONE/ADM_dialogFactory/FAC_toggle.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_NONE/ADM_dialogFactory/FAC_toggle.cpp	2007-04-14 19:25:59 UTC (rev 2941)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_NONE/ADM_dialogFactory/FAC_toggle.cpp	2007-04-15 10:32:22 UTC (rev 2942)
@@ -267,5 +267,29 @@
 { 
 }
 //******************************************************
+diaElemFrame::diaElemFrame(const char *toggleTitle, const char *tip)
+  : diaElem(ELEM_FRAME)
+{
+  
+}
+void diaElemFrame::swallow(diaElem *widget)
+{
+ 
+}
+diaElemFrame::~diaElemFrame()
+{
+  
+}
+void diaElemFrame::setMe(void *dialog, void *opaque,uint32_t line)
+{
+ 
+}
+void diaElemFrame::getMe(void)
+{
+  
+}
+void diaElemFrame::enable(uint32_t onoff)
+{
 
+}
 //EOF

Copied: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialogFactory/FAC_frame.cpp (from rev 2929, branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialogFactory/FAC_toggle.cpp)
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialogFactory/FAC_toggle.cpp	2007-04-12 18:41:56 UTC (rev 2929)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialogFactory/FAC_frame.cpp	2007-04-15 10:32:22 UTC (rev 2942)
@@ -0,0 +1,61 @@
+/***************************************************************************
+  FAC_toggle.cpp
+  Handle dialog factory element : Toggle
+  (C) 2006 Mean <A HREF="https://lists.berlios.de/mailman/listinfo/avidemux-svn-commit">Fixounet at free.fr</A> 
+***************************************************************************/
+
+/***************************************************************************
+ *                                                                         *
+ *   This program is free software; you can redistribute it and/or modify  *
+ *   it under the terms of the GNU General Public License as published by  *
+ *   the Free Software Foundation; either version 2 of the License, or     *
+ *   (at your option) any later version.                                   *
+ *                                                                         *
+ ***************************************************************************/
+
+#include &lt;config.h&gt;
+
+
+#include &lt;string.h&gt;
+#include &lt;stdio.h&gt;
+#include &lt;stdlib.h&gt;
+#include &lt;math.h&gt;
+
+#include &lt;QDialog&gt;
+#include &lt;QMessageBox&gt;
+#include &lt;QGridLayout&gt;
+#include &lt;QCheckBox&gt;
+
+#include &quot;default.h&quot;
+#include &quot;ADM_commonUI/DIA_factory.h&quot;
+#include &quot;ADM_assert.h&quot;
+diaElemFrame::diaElemFrame(const char *toggleTitle, const char *tip)
+  : diaElem(ELEM_FRAME)
+{
+  
+}
+void diaElemFrame::swallow(diaElem *widget)
+{
+ 
+}
+diaElemFrame::~diaElemFrame()
+{
+  
+}
+void diaElemFrame::setMe(void *dialog, void *opaque,uint32_t line)
+{
+ 
+}
+void diaElemFrame::getMe(void)
+{
+  
+}
+void diaElemFrame::enable(uint32_t onoff)
+{
+
+}
+
+
+//******************************************************
+
+//EOF

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialogFactory/Makefile.am
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialogFactory/Makefile.am	2007-04-14 19:25:59 UTC (rev 2941)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialogFactory/Makefile.am	2007-04-15 10:32:22 UTC (rev 2942)
@@ -3,7 +3,7 @@
 
 libADM_dialogFactory_a_METASOURCES = AUTO
 
-libADM_dialogFactory_a_SOURCES = AT_dialogFactory.cpp FAC_toggle.cpp FAC_integer.cpp FAC_menu.cpp FAC_float.cpp AT_filesel.cpp AT_bitrate.cpp FAC_bar.cpp FAC_readOnlyText.cpp FAC_notch.cpp
+libADM_dialogFactory_a_SOURCES = AT_dialogFactory.cpp FAC_toggle.cpp FAC_integer.cpp FAC_menu.cpp FAC_float.cpp AT_filesel.cpp AT_bitrate.cpp FAC_bar.cpp FAC_readOnlyText.cpp FAC_notch.cpp FAC_frame.cpp
 
 
 INCLUDES = $(all_includes)  $(XML_CFLAGS)  $(FREETYPE_CFLAGS) -DADM_SUBVERSION=@ADM_SUBVERSION@ \

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_factory.h
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_factory.h	2007-04-14 19:25:59 UTC (rev 2941)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_factory.h	2007-04-15 10:32:22 UTC (rev 2942)
@@ -32,6 +32,7 @@
   ELEM_NOTCH,
   ELEM_DIR_SELECT,
   ELEM_TEXT,
+  ELEM_FRAME,
   ELEM_MAX=ELEM_TOGGLE
 };
 /*********************************************/
@@ -307,6 +308,23 @@
   {
   }
 };
+/**********************************************/
+#define DIA_MAX_FRAME 10
+class diaElemFrame : public diaElem
+{
+  uint32_t frameSize;
+  uint32_t nbElems;
+  diaElem  *elems[DIA_MAX_FRAME];
+public:
+  
+  diaElemFrame(const char *toggleTitle, const char *tip=NULL);
+  virtual ~diaElemFrame() ;
+  void setMe(void *dialog, void *opaque,uint32_t line);
+  void getMe(void) ;
+  void swallow(diaElem *widget);
+  void enable(uint32_t onoff);
+};
+/**********************************************/
 
 /*********************************************/
 uint8_t diaFactoryRun(const char *title,uint32_t nb,diaElem **elems);

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp	2007-04-14 19:25:59 UTC (rev 2941)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp	2007-04-15 10:32:22 UTC (rev 2942)
@@ -72,8 +72,20 @@
 uint32_t autoindex=0;
 uint32_t autounpack=0;
 uint32_t alternate_mp3_tag=1;
+uint32_t pp_type=3;
+uint32_t pp_value=5;
+uint32_t hzd,vzd,dring;
 	olddevice=newdevice=AVDM_getCurrentDevice();
 
+        // Default pp
+         if(!prefs-&gt;get(DEFAULT_POSTPROC_TYPE,&amp;pp_type)) pp_type=3;
+         if(!prefs-&gt;get(DEFAULT_POSTPROC_VALUE,&amp;pp_value)) pp_value=3;
+#define DOME(x,y) y=!!(pp_type &amp; x)
+    
+    DOME(1,hzd);
+    DOME(2,vzd);
+    DOME(4,dring);
+     
         // Alsa
         if( prefs-&gt;get(DEVICE_AUDIO_ALSA_DEVICE, &amp;alsaDevice) != RC_OK )
                 alsaDevice = ADM_strdup(&quot;plughw:0,0&quot;);
@@ -221,7 +233,12 @@
         
         diaElemText entryAlsaDevice(&amp;alsaDevice,&quot;Alsa Device&quot;,NULL);
         
-        
+        // default Post proc
+     diaElemToggle     fhzd(&amp;hzd,_(&quot;Default Postproc, Horizontal deblocking&quot;));
+     diaElemToggle     fvzd(&amp;vzd,_(&quot;Default Potsproc, Vertical deblocking&quot;));
+     diaElemToggle     fdring(&amp;dring,_(&quot;Default Postproc, Deringing&quot;));
+     diaElemUInteger   postProcStrength(&amp;pp_value,_(&quot;Default Postproc strength:&quot;),0,5);
+     
         // Filter path
         if( prefs-&gt;get(FILTERS_AUTOLOAD_PATH, &amp;filterPath) != RC_OK )
 #ifndef CYG_MANGLING
@@ -254,8 +271,8 @@
         
         /* Fifth Tab : video */
         
-        diaElem *diaVideo[]={&amp;menuVideoMode};
-        diaElemTabs tabVideo(&quot;Video&quot;,1,(diaElem **)diaVideo);
+        diaElem *diaVideo[]={&amp;menuVideoMode,&amp;fhzd,&amp;fvzd,&amp;fdring,&amp;postProcStrength};
+        diaElemTabs tabVideo(&quot;Video&quot;,5,(diaElem **)diaVideo);
         
         /* Sixth Tab : mthread */
         diaElem *diaMthread[]={&amp;multiThread};
@@ -270,6 +287,15 @@
         if( diaFactoryRunTabs(_(&quot;Preferences&quot;),8,tabs))
 	{
 		ret=1;
+                // Postproc
+                #undef DOME
+                #define DOME(x,y) if(y) pp_type |=x;
+                pp_type=0;
+                DOME(1,hzd);
+                DOME(2,vzd);
+                DOME(4,dring);
+                prefs-&gt;set(DEFAULT_POSTPROC_TYPE,pp_type);
+                prefs-&gt;set(DEFAULT_POSTPROC_VALUE,pp_value);
                 //
                  prefs-&gt;set(FEATURE_AUTO_UNPACK,autounpack);
                  // autovbr
@@ -334,7 +360,6 @@
         {
                 prefs-&gt;set(DEFAULT_POSTPROC_TYPE,type);
                 prefs-&gt;set(DEFAULT_POSTPROC_VALUE,strength);
-
         }
 //	video_body-&gt;setPostProc(type, strength, uv);
 }


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000259.html">[Avidemux-svn-commit] r2941 - branches/avidemux_2.4_branch
</A></li>
	<LI>Next message: <A HREF="000261.html">[Avidemux-svn-commit] r2943 - in	branches/avidemux_2.4_branch/avidemux: ADM_script	ADM_userInterfaces/ADM_GTK/ADM_dialogFactory	ADM_userInterfaces/ADM_NONE/ADM_dialogFactory	ADM_userInterfaces/ADM_QT4/ADM_dialogFactory	ADM_userInterfaces/ADM_commonUI
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#260">[ date ]</a>
              <a href="thread.html#260">[ thread ]</a>
              <a href="subject.html#260">[ subject ]</a>
              <a href="author.html#260">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/avidemux-svn-commit">More information about the Avidemux-svn-commit
mailing list</a><br>
</body></html>
