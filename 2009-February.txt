From mean at mail.berlios.de  Sun Feb  1 19:30:47 2009
From: mean at mail.berlios.de (mean at BerliOS)
Date: Sun, 1 Feb 2009 19:30:47 +0100
Subject: [Avidemux-svn-commit] r4554 -
	branches/avidemux_2.6_branch_mean/avidemux/ADM_libraries/ADM_ffmpeg/ffmpeg_config
Message-ID: <200902011830.n11IUliv018536@sheep.berlios.de>

Author: mean
Date: 2009-02-01 19:30:47 +0100 (Sun, 01 Feb 2009)
New Revision: 4554

Modified:
   branches/avidemux_2.6_branch_mean/avidemux/ADM_libraries/ADM_ffmpeg/ffmpeg_config/config.h
   branches/avidemux_2.6_branch_mean/avidemux/ADM_libraries/ADM_ffmpeg/ffmpeg_config/ffconf.c
Log:
[WIN32]

Modified: branches/avidemux_2.6_branch_mean/avidemux/ADM_libraries/ADM_ffmpeg/ffmpeg_config/config.h
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/ADM_libraries/ADM_ffmpeg/ffmpeg_config/config.h	2009-01-31 18:34:12 UTC (rev 4553)
+++ branches/avidemux_2.6_branch_mean/avidemux/ADM_libraries/ADM_ffmpeg/ffmpeg_config/config.h	2009-02-01 18:30:47 UTC (rev 4554)
@@ -482,5 +482,9 @@
 #define HAVE_ROUNDF 1
 #define HAVE_THREADS 1
 #define RUNTIME_CPUDETECT 1
+#ifdef __MINGW32__
+#define EXTERN_PREFIX "_"
+#else // __MINGW32__
 #define EXTERN_PREFIX
+#endif // __MINGW32__
 #define restrict __restrict__

Modified: branches/avidemux_2.6_branch_mean/avidemux/ADM_libraries/ADM_ffmpeg/ffmpeg_config/ffconf.c
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/ADM_libraries/ADM_ffmpeg/ffmpeg_config/ffconf.c	2009-01-31 18:34:12 UTC (rev 4553)
+++ branches/avidemux_2.6_branch_mean/avidemux/ADM_libraries/ADM_ffmpeg/ffmpeg_config/ffconf.c	2009-02-01 18:30:47 UTC (rev 4554)
@@ -471,7 +471,11 @@
 	printf("#define HAVE_ROUND 1\n");
 	printf("#define HAVE_ROUNDF 1\n");
 	printf("#define HAVE_THREADS 1\n");
-	printf("#define RUNTIME_CPUDETECT 1\n");
-	printf("#define EXTERN_PREFIX\n");
+	printf("#define RUNTIME_CPUDETECT 1\n");
+    printf("#ifdef __MINGW32__\n");
+        printf("#define EXTERN_PREFIX \"_\"\n");
+    printf("#else // __MINGW32__\n");
+        printf("#define EXTERN_PREFIX\n");
+    printf("#endif // __MINGW32__\n");
 	printf("#define restrict __restrict__\n");
 }



From mean at mail.berlios.de  Sun Feb  1 19:49:56 2009
From: mean at mail.berlios.de (mean at BerliOS)
Date: Sun, 1 Feb 2009 19:49:56 +0100
Subject: [Avidemux-svn-commit] r4555 - in
	branches/avidemux_2.6_branch_mean/avidemux: . ADM_coreMuxer/src
Message-ID: <200902011849.n11InuAd020232@sheep.berlios.de>

Author: mean
Date: 2009-02-01 19:49:56 +0100 (Sun, 01 Feb 2009)
New Revision: 4555

Modified:
   branches/avidemux_2.6_branch_mean/avidemux/ADM_coreMuxer/src/CMakeLists.txt
   branches/avidemux_2.6_branch_mean/avidemux/CMakeLists.txt
Log:
[Win32]

Modified: branches/avidemux_2.6_branch_mean/avidemux/ADM_coreMuxer/src/CMakeLists.txt
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/ADM_coreMuxer/src/CMakeLists.txt	2009-02-01 18:30:47 UTC (rev 4554)
+++ branches/avidemux_2.6_branch_mean/avidemux/ADM_coreMuxer/src/CMakeLists.txt	2009-02-01 18:49:56 UTC (rev 4555)
@@ -9,6 +9,6 @@
 ADD_LIBRARY(ADM_coreMuxer SHARED ${ADMcoreMuxer_SRCS})
 INCLUDE_DIRECTORIES(${CMAKE_SOURCE_DIR}/avidemux/ADM_coreAudio/include)
 INCLUDE_DIRECTORIES(${CMAKE_SOURCE_DIR}/avidemux/ADM_libraries/ADM_ffmpeg)
-TARGET_LINK_LIBRARIES(ADM_coreMuxer ADM_coreImage ADM_coreAudio ADM_core)
+TARGET_LINK_LIBRARIES(ADM_coreMuxer ADM_coreImage ADM_coreAudio ADM_core ADM_libavcodec ADM_libavformat ADM_libavutil)
 
 INSTALL(TARGETS ADM_coreMuxer RUNTIME DESTINATION ${BIN_DIR}  LIBRARY DESTINATION lib  ARCHIVE DESTINATION lib)

Modified: branches/avidemux_2.6_branch_mean/avidemux/CMakeLists.txt
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/CMakeLists.txt	2009-02-01 18:30:47 UTC (rev 4554)
+++ branches/avidemux_2.6_branch_mean/avidemux/CMakeLists.txt	2009-02-01 18:49:56 UTC (rev 4555)
@@ -122,10 +122,10 @@
 	STRING(REPLACE "." "," PRODUCTVERSION ${PRODUCTVERSION_STRING})
 	SET(PRODUCTVERSION "${PRODUCTVERSION},0")
 
-	CONFIGURE_FILE("${CMAKE_SOURCE_DIR}/cmake/admWin32.rc.in" ${CMAKE_CURRENT_BINARY_DIR}/admWin32.rc IMMEDIATE)
-	ADD_CUSTOM_COMMAND(OUTPUT ${CMAKE_CURRENT_BINARY_DIR}/admWin32.obj COMMAND windres.exe -i ${CMAKE_CURRENT_BINARY_DIR}/admWin32.rc -o ${CMAKE_CURRENT_BINARY_DIR}/admWin32.obj -O coff --define VS_VERSION_INFO=1)
+	#CONFIGURE_FILE("${CMAKE_SOURCE_DIR}/cmake/admWin32.rc.in" ${CMAKE_CURRENT_BINARY_DIR}/admWin32.rc IMMEDIATE)
+	#ADD_CUSTOM_COMMAND(OUTPUT ${CMAKE_CURRENT_BINARY_DIR}/admWin32.obj COMMAND windres.exe -i ${CMAKE_CURRENT_BINARY_DIR}/admWin32.rc -o ${CMAKE_CURRENT_BINARY_DIR}/admWin32.obj -O coff --define VS_VERSION_INFO=1)
 
-	SET(ADM_EXE_SRCS ${ADM_EXE_SRCS} "${CMAKE_CURRENT_BINARY_DIR}/admWin32.obj")
+	#SET(ADM_EXE_SRCS ${ADM_EXE_SRCS} "${CMAKE_CURRENT_BINARY_DIR}/admWin32.obj")
 ENDIF (WIN32)
 
 ########################################



From mean at mail.berlios.de  Mon Feb  2 07:30:27 2009
From: mean at mail.berlios.de (mean at BerliOS)
Date: Mon, 2 Feb 2009 07:30:27 +0100
Subject: [Avidemux-svn-commit] r4556 - in
	branches/avidemux_2.6_branch_mean/avidemux: .
	ADM_coreMuxer/include ADM_coreMuxer/src ADM_muxerGate
	ADM_muxerGate/include ADM_muxerGate/src
Message-ID: <200902020630.n126URWB016311@sheep.berlios.de>

Author: mean
Date: 2009-02-02 07:30:24 +0100 (Mon, 02 Feb 2009)
New Revision: 4556

Added:
   branches/avidemux_2.6_branch_mean/avidemux/ADM_muxerGate/
   branches/avidemux_2.6_branch_mean/avidemux/ADM_muxerGate/CMakeLists.txt
   branches/avidemux_2.6_branch_mean/avidemux/ADM_muxerGate/include/
   branches/avidemux_2.6_branch_mean/avidemux/ADM_muxerGate/include/ADM_videoCopy.h
   branches/avidemux_2.6_branch_mean/avidemux/ADM_muxerGate/src/
   branches/avidemux_2.6_branch_mean/avidemux/ADM_muxerGate/src/ADM_videoCopy.cpp
   branches/avidemux_2.6_branch_mean/avidemux/ADM_muxerGate/src/CMakeLists.txt
Removed:
   branches/avidemux_2.6_branch_mean/avidemux/ADM_coreMuxer/include/ADM_videoCopy.h
   branches/avidemux_2.6_branch_mean/avidemux/ADM_coreMuxer/src/ADM_videoCopy.cpp
Modified:
   branches/avidemux_2.6_branch_mean/avidemux/ADM_coreMuxer/src/CMakeLists.txt
   branches/avidemux_2.6_branch_mean/avidemux/CMakeLists.txt
Log:
[CoreMuxer] Remove videocopy from coreMuxer and put it in muxerGate

Deleted: branches/avidemux_2.6_branch_mean/avidemux/ADM_coreMuxer/include/ADM_videoCopy.h
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/ADM_coreMuxer/include/ADM_videoCopy.h	2009-02-01 18:49:56 UTC (rev 4555)
+++ branches/avidemux_2.6_branch_mean/avidemux/ADM_coreMuxer/include/ADM_videoCopy.h	2009-02-02 06:30:24 UTC (rev 4556)
@@ -1,27 +0,0 @@
-/**
-
-*/
-#ifndef ADM_VIDEOCOPY_H
-#define ADM_VIDEOCOPY_H
-#include "ADM_muxer.h"
-/**
-    \class ADM_videoStream
-
-*/
-#include "ADM_compressedImage.h"
-class ADM_videoStreamCopy: public ADM_videoStream
-{
-protected:
-            uint32_t start,end;
-            ADMCompressedImage image;
-public:
-             ADM_videoStreamCopy();
-    virtual ~ADM_videoStreamCopy();
-
-virtual     bool     getPacket(uint32_t *len, uint8_t *data, uint32_t maxLen,uint64_t *pts,uint64_t *dts,
-                                    uint32_t *flags);
-virtual     bool     getExtraData(uint32_t *extraLen, uint8_t **extraData) ;
-virtual     bool     providePts(void) {return false;}
-virtual     uint64_t getVideoDuration(void);
-};
-#endif

Deleted: branches/avidemux_2.6_branch_mean/avidemux/ADM_coreMuxer/src/ADM_videoCopy.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/ADM_coreMuxer/src/ADM_videoCopy.cpp	2009-02-01 18:49:56 UTC (rev 4555)
+++ branches/avidemux_2.6_branch_mean/avidemux/ADM_coreMuxer/src/ADM_videoCopy.cpp	2009-02-02 06:30:24 UTC (rev 4556)
@@ -1,74 +0,0 @@
-/**
-    \file ADM_videoCopy
-    \brief Wrapper 
-    (c) Mean 2008/GPLv2
-
-*/
-
-#include "ADM_default.h"
-#include "ADM_videoCopy.h"
-#include "ADM_editor/ADM_edit.hxx"
-
-extern ADM_Composer *video_body; // Fixme!
-/**
-    \fn ADM_videoStreamCopy
-*/
-ADM_videoStreamCopy::ADM_videoStreamCopy()
-{
-    aviInfo info;
-    video_body->getVideoInfo(&info);
-    width=info.width;
-    height=info.height;
-    fourCC=info.fcc;
-    averageFps1000=info.fps1000;
-    isCFR=false;
-    start=0;
-    end=100; // FIXME
-
-}
-/**
-    \fn ADM_videoStreamCopy
-*/
-ADM_videoStreamCopy::~ADM_videoStreamCopy()
-{
-
-}
-/**
-    \fn getExtraData
-*/
-bool     ADM_videoStreamCopy::getExtraData(uint32_t *extraLen, uint8_t **extraData)
-{
-
-  return video_body->getExtraHeaderData(extraLen,extraData);
-}
- 
-/**
-    \fn getPacket
-*/
-bool  ADM_videoStreamCopy::getPacket(uint32_t *len, uint8_t *data, uint32_t maxLen,
-                    uint64_t *pts,uint64_t *dts,
-                    uint32_t *flags)
-{
-    image.data=data;
-    if(false==video_body->getCompressedPicure(start,&image))
-    {
-            printf("[StreamCopy] Get packet failed for frame %d\n",start);
-            return false;
-    }
-    *len=image.dataLength;
-    ADM_assert(*len<maxLen);
-    *pts=image.demuxerPts;
-    *dts=image.demuxerDts;
-    *flags=image.flags;
-    start++;
-    return true;
-}
-/**
-    \fn getVideoDuration
-*/
-uint64_t        ADM_videoStreamCopy::getVideoDuration(void)
-{
-    return video_body->getVideoDuration();
-
-}
-     

Modified: branches/avidemux_2.6_branch_mean/avidemux/ADM_coreMuxer/src/CMakeLists.txt
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/ADM_coreMuxer/src/CMakeLists.txt	2009-02-01 18:49:56 UTC (rev 4555)
+++ branches/avidemux_2.6_branch_mean/avidemux/ADM_coreMuxer/src/CMakeLists.txt	2009-02-02 06:30:24 UTC (rev 4556)
@@ -1,7 +1,6 @@
 
 SET(ADMcoreMuxer_SRCS
 ADM_dynaMuxer.cpp
-ADM_videoCopy.cpp
 ADM_muxerUtils.cpp
 ADM_audioClock.cpp
 )	

Added: branches/avidemux_2.6_branch_mean/avidemux/ADM_muxerGate/CMakeLists.txt
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/ADM_muxerGate/CMakeLists.txt	2009-02-01 18:49:56 UTC (rev 4555)
+++ branches/avidemux_2.6_branch_mean/avidemux/ADM_muxerGate/CMakeLists.txt	2009-02-02 06:30:24 UTC (rev 4556)
@@ -0,0 +1 @@
+ADD_SUBDIRECTORY(src)

Copied: branches/avidemux_2.6_branch_mean/avidemux/ADM_muxerGate/include/ADM_videoCopy.h (from rev 4555, branches/avidemux_2.6_branch_mean/avidemux/ADM_coreMuxer/include/ADM_videoCopy.h)
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/ADM_coreMuxer/include/ADM_videoCopy.h	2009-02-01 18:49:56 UTC (rev 4555)
+++ branches/avidemux_2.6_branch_mean/avidemux/ADM_muxerGate/include/ADM_videoCopy.h	2009-02-02 06:30:24 UTC (rev 4556)
@@ -0,0 +1,27 @@
+/**
+
+*/
+#ifndef ADM_VIDEOCOPY_H
+#define ADM_VIDEOCOPY_H
+#include "ADM_muxer.h"
+/**
+    \class ADM_videoStream
+
+*/
+#include "ADM_compressedImage.h"
+class ADM_videoStreamCopy: public ADM_videoStream
+{
+protected:
+            uint32_t start,end;
+            ADMCompressedImage image;
+public:
+             ADM_videoStreamCopy();
+    virtual ~ADM_videoStreamCopy();
+
+virtual     bool     getPacket(uint32_t *len, uint8_t *data, uint32_t maxLen,uint64_t *pts,uint64_t *dts,
+                                    uint32_t *flags);
+virtual     bool     getExtraData(uint32_t *extraLen, uint8_t **extraData) ;
+virtual     bool     providePts(void) {return false;}
+virtual     uint64_t getVideoDuration(void);
+};
+#endif

Copied: branches/avidemux_2.6_branch_mean/avidemux/ADM_muxerGate/src/ADM_videoCopy.cpp (from rev 4555, branches/avidemux_2.6_branch_mean/avidemux/ADM_coreMuxer/src/ADM_videoCopy.cpp)
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/ADM_coreMuxer/src/ADM_videoCopy.cpp	2009-02-01 18:49:56 UTC (rev 4555)
+++ branches/avidemux_2.6_branch_mean/avidemux/ADM_muxerGate/src/ADM_videoCopy.cpp	2009-02-02 06:30:24 UTC (rev 4556)
@@ -0,0 +1,74 @@
+/**
+    \file ADM_videoCopy
+    \brief Wrapper 
+    (c) Mean 2008/GPLv2
+
+*/
+
+#include "ADM_default.h"
+#include "ADM_videoCopy.h"
+#include "ADM_editor/ADM_edit.hxx"
+
+extern ADM_Composer *video_body; // Fixme!
+/**
+    \fn ADM_videoStreamCopy
+*/
+ADM_videoStreamCopy::ADM_videoStreamCopy()
+{
+    aviInfo info;
+    video_body->getVideoInfo(&info);
+    width=info.width;
+    height=info.height;
+    fourCC=info.fcc;
+    averageFps1000=info.fps1000;
+    isCFR=false;
+    start=0;
+    end=100; // FIXME
+
+}
+/**
+    \fn ADM_videoStreamCopy
+*/
+ADM_videoStreamCopy::~ADM_videoStreamCopy()
+{
+
+}
+/**
+    \fn getExtraData
+*/
+bool     ADM_videoStreamCopy::getExtraData(uint32_t *extraLen, uint8_t **extraData)
+{
+
+  return video_body->getExtraHeaderData(extraLen,extraData);
+}
+ 
+/**
+    \fn getPacket
+*/
+bool  ADM_videoStreamCopy::getPacket(uint32_t *len, uint8_t *data, uint32_t maxLen,
+                    uint64_t *pts,uint64_t *dts,
+                    uint32_t *flags)
+{
+    image.data=data;
+    if(false==video_body->getCompressedPicure(start,&image))
+    {
+            printf("[StreamCopy] Get packet failed for frame %d\n",start);
+            return false;
+    }
+    *len=image.dataLength;
+    ADM_assert(*len<maxLen);
+    *pts=image.demuxerPts;
+    *dts=image.demuxerDts;
+    *flags=image.flags;
+    start++;
+    return true;
+}
+/**
+    \fn getVideoDuration
+*/
+uint64_t        ADM_videoStreamCopy::getVideoDuration(void)
+{
+    return video_body->getVideoDuration();
+
+}
+     

Added: branches/avidemux_2.6_branch_mean/avidemux/ADM_muxerGate/src/CMakeLists.txt
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/ADM_muxerGate/src/CMakeLists.txt	2009-02-01 18:49:56 UTC (rev 4555)
+++ branches/avidemux_2.6_branch_mean/avidemux/ADM_muxerGate/src/CMakeLists.txt	2009-02-02 06:30:24 UTC (rev 4556)
@@ -0,0 +1,5 @@
+SET(ADM_muxerGate_SRCS
+ADM_videoCopy.cpp
+)
+include_directories(../include)
+ADD_ADM_LIB_ALL_TARGETS(ADM_muxerGate ${ADM_muxerGate_SRCS})

Modified: branches/avidemux_2.6_branch_mean/avidemux/CMakeLists.txt
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/CMakeLists.txt	2009-02-01 18:49:56 UTC (rev 4555)
+++ branches/avidemux_2.6_branch_mean/avidemux/CMakeLists.txt	2009-02-02 06:30:24 UTC (rev 4556)
@@ -65,6 +65,7 @@
 INCLUDE_DIRECTORIES("${CMAKE_CURRENT_SOURCE_DIR}/ADM_libraries/ADM_ffmpeg/libavutil")
 INCLUDE_DIRECTORIES("${CMAKE_CURRENT_SOURCE_DIR}/ADM_libraries/ADM_ffmpeg/")
 INCLUDE_DIRECTORIES("${CMAKE_CURRENT_SOURCE_DIR}/ADM_libraries/ADM_ffmpeg/ADM_lavcodec")
+INCLUDE_DIRECTORIES("${CMAKE_CURRENT_SOURCE_DIR}/ADM_muxerGate/include/")
 
 IF (GETTEXT_FOUND)
 	INCLUDE_DIRECTORIES(${GETTEXT_INCLUDE_DIR})
@@ -171,6 +172,7 @@
 	ADM_audiofilter
 	#ADM_audioEncoder
 	ADM_editor
+	ADM_muxerGate
 	ADM_audiocodec
 	ADM_audio
 	ADM_script



From gruntster at mail.berlios.de  Mon Feb  2 16:48:11 2009
From: gruntster at mail.berlios.de (gruntster at mail.berlios.de)
Date: Mon, 2 Feb 2009 16:48:11 +0100
Subject: [Avidemux-svn-commit] r4557 -
	branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog
Message-ID: <200902021548.n12FmBor030430@sheep.berlios.de>

Author: gruntster
Date: 2009-02-02 16:47:58 +0100 (Mon, 02 Feb 2009)
New Revision: 4557

Modified:
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/alert_qt4.cpp
Log:
[Qt] honour LFs for alert boxes

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/alert_qt4.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/alert_qt4.cpp	2009-02-02 06:30:24 UTC (rev 4556)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/alert_qt4.cpp	2009-02-02 15:47:58 UTC (rev 4557)
@@ -41,131 +41,141 @@
 }
 
 //****************************************************************************************************
-void            GUI_Info_HIG(const ADM_LOG_LEVEL level,const char *primary, const char *secondary_format, ...)
+void GUI_Info_HIG(const ADM_LOG_LEVEL level,const char *primary, const char *secondary_format, ...)
 {
-  uint32_t msglvl=2;
-  char *string;
-  char alertstring[1024];
-  char alertstring2[1024];
+	uint32_t msglvl = 2;
+	QString alertString;
 
-        prefs->get(MESSAGE_LEVEL,&msglvl);
+	prefs->get(MESSAGE_LEVEL, &msglvl);
 
-        if(msglvl<level)
-        {
-                printf("Info : %s \n",primary);
-                return;
-        }
+	if (msglvl<level)
+	{
+		printf("Info: %s\n",primary);
+		return;
+	}
 
-        if(! secondary_format)
-        {
-            snprintf(alertstring,1024,"<big><b>%s</b></big>",primary);
-         }else
-         {
-            va_list ap;
-            va_start(ap, secondary_format);
-            vsnprintf(alertstring2,1023,secondary_format, ap);
-            snprintf(alertstring,1024,"<big><b>%s</b></big><br><br>%s",primary,alertstring2);
-            va_end(ap);
-         }
-        QMessageBox::StandardButton reply;
-          reply = QMessageBox::information(qtLastRegisteredDialog(), QString::fromUtf8(QT_TR_NOOP("Info")),
-                                    QString::fromUtf8(alertstring),
-                                    QMessageBox::Ok );
+	if (!secondary_format)
+		alertString = "<big><b>" + QString::fromUtf8(primary) + "</b></big>";
+	else
+	{
+		va_list ap;
+		va_start(ap, secondary_format);
 
+		alertString.vsprintf(secondary_format, ap);
+		alertString = "<big><b>" + QString::fromUtf8(primary) + "</b></big><br><br>" + alertString;
+		alertString.replace("\n", "<br>");
+
+		va_end(ap);
+	}
+
+	QMessageBox::StandardButton reply;
+
+	reply = QMessageBox::information(qtLastRegisteredDialog(), QString::fromUtf8(QT_TR_NOOP("Info")),
+		alertString, QMessageBox::Ok);
 }
 //****************************************************************************************************
-void            GUI_Error_HIG(const char *primary, const char *secondary_format, ...)
+void GUI_Error_HIG(const char *primary, const char *secondary_format, ...)
 {
-  uint32_t msglvl=2;
-  char *string;
-  char alertstring[1024];
-  char alertstring2[1024];
-  
-        prefs->get(MESSAGE_LEVEL,&msglvl);
+	uint32_t msglvl = 2;
+	QString alertString;
 
-        if(msglvl==ADM_LOG_NONE) 
-        {
-                printf("Error :%s\n",primary);
-                return;
-        }
+	prefs->get(MESSAGE_LEVEL, &msglvl);
 
-        if(! secondary_format)
-        {
-            snprintf(alertstring,1024,"<big><b>%s</b></big>",primary);
-         }else
-         {
-            va_list ap;
-            va_start(ap, secondary_format);
-            vsnprintf(alertstring2,1023,secondary_format, ap);
-            snprintf(alertstring,1024,"<big><b>%s</b></big><br><br>%s",primary,alertstring2);
-            va_end(ap);
-         }
-          QMessageBox::StandardButton reply;
-          reply = QMessageBox::critical(qtLastRegisteredDialog(), QString::fromUtf8(QT_TR_NOOP("Info")),
-                                    QString::fromUtf8(alertstring),
-                                    QMessageBox::Ok );
+	if (msglvl == ADM_LOG_NONE)
+	{
+		printf("Error: %s\n", primary);
+		return;
+	}
+
+	if (!secondary_format)
+		alertString = "<big><b>" + QString::fromUtf8(primary) + "</b></big>";
+	else
+	{
+		va_list ap;
+		va_start(ap, secondary_format);
+
+		alertString.vsprintf(secondary_format, ap);
+		alertString = "<big><b>" + QString::fromUtf8(primary) + "</b></big><br><br>" + alertString;
+		alertString.replace("\n", "<br>");
+
+		va_end(ap);
+	}
+
+	QMessageBox::StandardButton reply;
+
+	reply = QMessageBox::critical(qtLastRegisteredDialog(), QString::fromUtf8(QT_TR_NOOP("Info")),
+		alertString, QMessageBox::Ok);
 }
 //****************************************************************************************************
-int             GUI_Confirmation_HIG(const char *button_confirm, const char *primary, const char *secondary_format, ...)
+int GUI_Confirmation_HIG(const char *button_confirm, const char *primary, const char *secondary_format, ...)
 {
-uint32_t msglvl=2;
-char alertstring[1024];
-char alertstring2[1024];
-        if (beQuiet)
-              {
-                      printf("Info: %s\n", primary);
-                      return 0;
-              }
-        
-        if (!secondary_format)
-        {
-              snprintf(alertstring,1024,"<big><b>%s</b></big>",primary);
-        }
-        else
-        {	
-              va_list ap;
-              va_start(ap, secondary_format);
-              vsnprintf(alertstring2,1023,secondary_format, ap);
-              snprintf(alertstring,1024,"<big><b>%s</b></big><br><br>%s",primary,alertstring2);
-              va_end(ap);
-        }
-          QMessageBox::StandardButton reply;
-          reply = QMessageBox::question(qtLastRegisteredDialog(), QString::fromUtf8(QT_TR_NOOP("Confirmation")),
-                                    QString::fromUtf8(alertstring),
-                                    QMessageBox::Yes | QMessageBox::No );
-          if(reply==QMessageBox::Yes) return 1;
-        return 0; 
+	QString alertString;
+
+	if (beQuiet)
+	{
+		printf("Info: %s\n", primary);
+		return 0;
+	}
+
+	if (!secondary_format)
+		alertString = "<big><b>" + QString::fromUtf8(primary) + "</b></big>";
+	else
+	{
+		va_list ap;
+		va_start(ap, secondary_format);
+
+		alertString.vsprintf(secondary_format, ap);
+		alertString = "<big><b>" + QString::fromUtf8(primary) + "</b></big><br><br>" + alertString;
+		alertString.replace("\n", "<br>");
+
+		va_end(ap);
+	}
+
+	QMessageBox::StandardButton reply;
+
+	reply = QMessageBox::question(qtLastRegisteredDialog(), QString::fromUtf8(QT_TR_NOOP("Confirmation")),
+		alertString, QMessageBox::Yes | QMessageBox::No);
+
+	if (reply == QMessageBox::Yes)
+		return 1;
+
+	return 0;
 }
 //****************************************************************************************************
-int             GUI_YesNo(const char *primary, const char *secondary_format, ...)
+int GUI_YesNo(const char *primary, const char *secondary_format, ...)
 {
-uint32_t msglvl=2;
-char alertstring[1024];
-char alertstring2[1024];
-        if (beQuiet)
-              {
-                      printf("Info: %s\n", primary);
-                      return 0;
-              }
-        
-        if (!secondary_format)
-        {
-              snprintf(alertstring,1024,"<big><b>%s</b></big>",primary);
-        }
-        else
-        {	
-              va_list ap;
-              va_start(ap, secondary_format);
-              vsnprintf(alertstring2,1023,secondary_format, ap);
-              snprintf(alertstring,1024,"<big><b>%s</b></big><br><br>%s",primary,alertstring2);
-              va_end(ap);
-        }
-          QMessageBox::StandardButton reply;
-          reply = QMessageBox::question(qtLastRegisteredDialog(), QString::fromUtf8(QT_TR_NOOP("Confirmation")),
-                                    QString::fromUtf8(alertstring),
-                                    QMessageBox::Yes | QMessageBox::No );
-          if(reply==QMessageBox::Yes) return 1;
-        return 0; 
+	uint32_t msglvl = 2;
+	QString alertString;
+
+	if (beQuiet)
+	{
+		printf("Info: %s\n", primary);
+		return 0;
+	}
+
+	if (!secondary_format)
+		alertString = "<big><b>" + QString::fromUtf8(primary) + "</b></big>";
+	else
+	{
+		va_list ap;
+		va_start(ap, secondary_format);
+
+		alertString.vsprintf(secondary_format, ap);
+		alertString = "<big><b>" + QString::fromUtf8(primary) + "</b></big><br><br>" + alertString;
+		alertString.replace("\n", "<br>");
+
+		va_end(ap);
+	}
+
+	QMessageBox::StandardButton reply;
+
+	reply = QMessageBox::question(qtLastRegisteredDialog(), QString::fromUtf8(QT_TR_NOOP("Confirmation")),
+		alertString, QMessageBox::Yes | QMessageBox::No);
+
+	if (reply == QMessageBox::Yes)
+		return 1;
+
+	return 0; 
 }
 //****************************************************************************************************
 int             GUI_Question(const char *alertstring)



From gruntster at mail.berlios.de  Mon Feb  2 17:59:13 2009
From: gruntster at mail.berlios.de (gruntster at mail.berlios.de)
Date: Mon, 2 Feb 2009 17:59:13 +0100
Subject: [Avidemux-svn-commit] r4558 - in
	branches/avidemux_2.4_branch/avidemux: . ADM_editor
	ADM_userInterfaces/ADM_QT4/ADM_dialog
Message-ID: <200902021659.n12GxDgt004936@sheep.berlios.de>

Author: gruntster
Date: 2009-02-02 17:59:07 +0100 (Mon, 02 Feb 2009)
New Revision: 4558

Modified:
   branches/avidemux_2.4_branch/avidemux/ADM_editor/ADM_edit.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_props.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/vobsub.ui
   branches/avidemux_2.4_branch/avidemux/gui_savenew.cpp
Log:
[I18N] various translation fixes

Modified: branches/avidemux_2.4_branch/avidemux/ADM_editor/ADM_edit.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_editor/ADM_edit.cpp	2009-02-02 15:47:58 UTC (rev 4557)
+++ branches/avidemux_2.4_branch/avidemux/ADM_editor/ADM_edit.cpp	2009-02-02 16:59:07 UTC (rev 4558)
@@ -425,19 +425,11 @@
       aviInfo info0, infox;
       _videos[   0     ]._aviheader->getVideoInfo (&info0);
       _videos[_nb_video]._aviheader->getVideoInfo (&infox);
-      if( info0.width != infox.width || info0.height != infox.height ){
-        char str[512+1];
-         str[0] = '\0';
-         if( info0.width != infox.width )
-            strcpy(str,"width");
-         if( info0.height != infox.height )
-            snprintf(str+strlen(str),512-strlen(str),
-              "%sheight%sdifferent between first and this video stream",
-                 (strlen(str)?" and ":""),
-                 (strlen(str)?" are ":" is ") );
-         str[512] = '\0';
-         GUI_Error_HIG(str,QT_TR_NOOP("You cannot mix different video dimensions yet. Using the partial video filter later, will not work around this problem. The workaround is:\n1.) \"resize\" / \"add border\" / \"crop\" each stream to the same resolution\n2.) concatinate them together"));
-         delete _videos[_nb_video]._aviheader;
+
+      if(info0.width != infox.width || info0.height != infox.height)
+	  {
+         GUI_Error_HIG(QT_TR_NOOP("Video dimensions don't match."), QT_TR_NOOP("You cannot mix different video dimensions yet. Using the partial video filter later will not work around this problem. The workaround is:\n\n1) \"Resize\" / \"Add Border\" / \"Crop\" each stream to the same resolution\n2) Concatenate them together"));
+		 delete _videos[_nb_video]._aviheader;
          return 0;
       }
    }

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_props.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_props.cpp	2009-02-02 15:47:58 UTC (rev 4557)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_props.cpp	2009-02-02 16:59:07 UTC (rev 4558)
@@ -83,7 +83,7 @@
         har=video_body->getPARHeight();
         getAspectRatioFromAR(war,har, &s);
 		FILLTEXT5(LabelAspectRatio,QT_TR_NOOP("%s (%u:%u)"), s,war,har);
-#define SET_YES(a,b) ui.a->setText(yesno[b])
+#define SET_YES(a,b) ui.a->setText(QString::fromUtf8(yesno[b]))
 #define FILLQT_TR_NOOP(q) ui.q->setText(QString::fromUtf8(text));
         SET_YES(LabelPackedBitstream,vop);
         SET_YES(LabelQuarterPixel,qpel);

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/vobsub.ui
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/vobsub.ui	2009-02-02 15:47:58 UTC (rev 4557)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/vobsub.ui	2009-02-02 16:59:07 UTC (rev 4558)
@@ -10,7 +10,7 @@
    </rect>
   </property>
   <property name="windowTitle" >
-   <string>Subtitle Font Size and Position</string>
+   <string>VobSub Settings</string>
   </property>
   <layout class="QVBoxLayout" >
    <property name="margin" >

Modified: branches/avidemux_2.4_branch/avidemux/gui_savenew.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/gui_savenew.cpp	2009-02-02 15:47:58 UTC (rev 4557)
+++ branches/avidemux_2.4_branch/avidemux/gui_savenew.cpp	2009-02-02 16:59:07 UTC (rev 4558)
@@ -28,8 +28,6 @@
 #define WIN32_CLASH
 #include "avi_vars.h"
 
-
-#include "avi_vars.h"
 #include "prototype.h"
 #include "ADM_toolkit/toolkit.hxx"
 #include "ADM_assert.h"
@@ -55,6 +53,7 @@
 #include "ADM_toolkit/filesel.h"
 #include "GUI_ui.h"
 #include "oplug_mpegFF/oplug_vcdff.h"
+#include "DIA_enter.h"
 
 static uint8_t  A_SaveAudioNVideo(const char *name);
  extern int A_SaveUnpackedVop(const char *name);
@@ -346,10 +345,10 @@
                   }
                   else
                   {
-                    if(GUI_Question(QT_TR_NOOP("You may need smart copy.\n Enable it ?")))
+                    if (GUI_Question(QT_TR_NOOP("You may need smart copy.\nEnable it?")))
                     {
                         value=4;
-                        if( ! GUI_getIntegerValue(&value, 2, 31, "_Q factor (set 4):"))
+                        if (!DIA_GetIntegerValue(&value, 2, 31, QT_TR_NOOP("Smart Copy"), QT_TR_NOOP("_Q factor (set 4):")))
                                       return 0;
                         nw=new   GenericAviSaveSmart(value);
                     }



From gruntster at mail.berlios.de  Mon Feb  2 19:23:40 2009
From: gruntster at mail.berlios.de (gruntster at mail.berlios.de)
Date: Mon, 2 Feb 2009 19:23:40 +0100
Subject: [Avidemux-svn-commit] r4559 -
	branches/avidemux_2.4_branch/platforms/windows/installer
Message-ID: <200902021823.n12INeGO005856@sheep.berlios.de>

Author: gruntster
Date: 2009-02-02 19:23:30 +0100 (Mon, 02 Feb 2009)
New Revision: 4559

Modified:
   branches/avidemux_2.4_branch/platforms/windows/installer/avidemux.nsi
Log:
[Win32] update installer for new libexpat

Modified: branches/avidemux_2.4_branch/platforms/windows/installer/avidemux.nsi
===================================================================
--- branches/avidemux_2.4_branch/platforms/windows/installer/avidemux.nsi	2009-02-02 16:59:07 UTC (rev 4558)
+++ branches/avidemux_2.4_branch/platforms/windows/installer/avidemux.nsi	2009-02-02 18:23:30 UTC (rev 4559)
@@ -172,7 +172,7 @@
     File ${BUILDDIR}\iconv.dll
     File ${BUILDDIR}\intl.dll
     File ${BUILDDIR}\libaften.dll
-    File ${BUILDDIR}\libexpat.dll
+    File ${BUILDDIR}\libexpat-*.dll
     File ${BUILDDIR}\libfaac.dll
     File ${BUILDDIR}\libfaad2.dll
     File ${BUILDDIR}\libfontconfig-1.dll
@@ -523,7 +523,7 @@
     Delete /REBOOTOK $INSTDIR\libfontconfig-1.dll
     Delete /REBOOTOK $INSTDIR\libfaad2.dll
     Delete /REBOOTOK $INSTDIR\libfaac.dll
-    Delete /REBOOTOK $INSTDIR\libexpat.dll
+    Delete /REBOOTOK $INSTDIR\libexpat-*.dll
     Delete /REBOOTOK $INSTDIR\libaften.dll
     Delete /REBOOTOK $INSTDIR\intl.dll
     Delete /REBOOTOK $INSTDIR\iconv.dll



From gruntster at mail.berlios.de  Mon Feb  2 22:30:37 2009
From: gruntster at mail.berlios.de (gruntster at mail.berlios.de)
Date: Mon, 2 Feb 2009 22:30:37 +0100
Subject: [Avidemux-svn-commit] r4560 - in
	branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_x264:
	. qt4
Message-ID: <200902022130.n12LUb1L017722@sheep.berlios.de>

Author: gruntster
Date: 2009-02-02 22:30:30 +0100 (Mon, 02 Feb 2009)
New Revision: 4560

Modified:
   branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_x264/encoder.cpp
   branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_x264/options.cpp
   branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_x264/options.h
   branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_x264/qt4/x264ConfigDialog.cpp
Log:
[x264] support libx264 core 66

Modified: branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_x264/encoder.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_x264/encoder.cpp	2009-02-02 18:23:30 UTC (rev 4559)
+++ branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_x264/encoder.cpp	2009-02-02 21:30:30 UTC (rev 4560)
@@ -573,7 +573,9 @@
 	printf("[x264] analyse.i_mv_range = %d\n", x264Param->analyse.i_mv_range);
 	printf("[x264] analyse.i_mv_range_thread = %d\n", x264Param->analyse.i_mv_range_thread);
 	printf("[x264] analyse.i_direct_mv_pred = %d\n", x264Param->analyse.i_direct_mv_pred);
+#if X264_BUILD < 66
 	printf("[x264] analyse.i_direct_8x8_inference = %d\n", x264Param->analyse.i_direct_8x8_inference);
+#endif
 	printf("[x264] analyse.b_weighted_bipred = %d\n", x264Param->analyse.b_weighted_bipred);
 	printf("[x264] analyse.b_transform_8x8 = %d\n", x264Param->analyse.b_transform_8x8);
 	printf("[x264] analyse.inter = %d\n", x264Param->analyse.inter);

Modified: branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_x264/options.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_x264/options.cpp	2009-02-02 18:23:30 UTC (rev 4559)
+++ branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_x264/options.cpp	2009-02-02 21:30:30 UTC (rev 4560)
@@ -592,6 +592,7 @@
 		_param.analyse.i_direct_mv_pred = directPredictionMode;
 }
 
+#if X264_BUILD < 66
 int x264Options::getDirectPredictionSize(void)
 {
 	return _param.analyse.i_direct_8x8_inference;
@@ -602,6 +603,7 @@
 	if (directPredictionSize >= -1 && directPredictionSize <= 1)
 		_param.analyse.i_direct_8x8_inference = directPredictionSize;
 }
+#endif
 
 int x264Options::getChromaLumaQuantiserDifference(void)
 {
@@ -1308,6 +1310,7 @@
 
 	xmlNewChild(xmlNodeChild, NULL, (xmlChar*)"directPredictionMode", xmlBuffer);
 
+#if X264_BUILD < 66
 	switch (getDirectPredictionSize())
 	{
 		case 0:
@@ -1320,6 +1323,7 @@
 			strcpy((char*)xmlBuffer, "smallest");
 			break;
 	}
+#endif
 
 	xmlNewChild(xmlNodeChild, NULL, (xmlChar*)"directPredictionSize", xmlBuffer);
 	xmlNewChild(xmlNodeChild, NULL, (xmlChar*)"chromaLumaQuantiserDifference", number2String(xmlBuffer, bufferSize, getChromaLumaQuantiserDifference()));

Modified: branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_x264/options.h
===================================================================
--- branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_x264/options.h	2009-02-02 18:23:30 UTC (rev 4559)
+++ branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_x264/options.h	2009-02-02 21:30:30 UTC (rev 4560)
@@ -207,8 +207,10 @@
 	unsigned int getDirectPredictionMode(void);
 	void setDirectPredictionMode(unsigned int directPredictionMode);
 
+#if X264_BUILD < 66
 	int getDirectPredictionSize(void);
 	void setDirectPredictionSize(int directPredictionSize);
+#endif
 
 	int getChromaLumaQuantiserDifference(void);
 	void setChromaLumaQuantiserDifference(int chromaLumaQuantiserDifference);

Modified: branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_x264/qt4/x264ConfigDialog.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_x264/qt4/x264ConfigDialog.cpp	2009-02-02 18:23:30 UTC (rev 4559)
+++ branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_x264/qt4/x264ConfigDialog.cpp	2009-02-02 21:30:30 UTC (rev 4560)
@@ -90,6 +90,11 @@
 	ui.meSpinBox->setMaximum(9);
 #endif
 
+#if X264_BUILD >= 66
+	ui.label_41->setVisible(false);
+	ui.predictSizeComboBox->setVisible(false);
+#endif
+
 	// Frame tab
 	connect(ui.loopFilterCheckBox, SIGNAL(toggled(bool)), this, SLOT(loopFilterCheckBox_toggled(bool)));
 	connect(ui.cabacCheckBox, SIGNAL(toggled(bool)), this, SLOT(cabacCheckBox_toggled(bool)));
@@ -635,10 +640,12 @@
 
 	ui.predictModeComboBox->setCurrentIndex(options->getDirectPredictionMode());
 
+#if X264_BUILD < 66
 	if (options->getDirectPredictionSize() == -1)
 		ui.predictSizeComboBox->setCurrentIndex(0);
 	else
 		ui.predictSizeComboBox->setCurrentIndex(options->getDirectPredictionSize());
+#endif
 
 	// Prediction tab
 	ui.weightedPredictCheckBox->setChecked(options->getWeightedPrediction());
@@ -843,10 +850,12 @@
 
 	options->setDirectPredictionMode(ui.predictModeComboBox->currentIndex());
 
+#if X264_BUILD < 66
 	if (ui.predictSizeComboBox->currentIndex() == 0)
 		options->setDirectPredictionSize(-1);
 	else
 		options->setDirectPredictionSize(ui.predictSizeComboBox->currentIndex());
+#endif
 
 	options->setWeightedPrediction(ui.weightedPredictCheckBox->isChecked());
 	options->setDct8x8(ui.dct8x8CheckBox->isChecked());



From gruntster at mail.berlios.de  Mon Feb  2 22:32:30 2009
From: gruntster at mail.berlios.de (gruntster at mail.berlios.de)
Date: Mon, 2 Feb 2009 22:32:30 +0100
Subject: [Avidemux-svn-commit] r4561 - in
	branches/avidemux_2.5_branch_gruntster: . avidemux/ADM_core/src
	avidemux/ADM_userInterfaces/ADM_commonUI
	avidemux/ADM_videoFilter cmake cmake/patches
Message-ID: <200902022132.n12LWUJP017908@sheep.berlios.de>

Author: gruntster
Date: 2009-02-02 22:32:18 +0100 (Mon, 02 Feb 2009)
New Revision: 4561

Modified:
   branches/avidemux_2.5_branch_gruntster/CMakeLists.txt
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_core/src/ADM_cpuCap.cpp
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_core/src/CMakeLists.txt
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_tsSub.cpp
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_videoFilter/ADM_vidDvbSub.cpp
   branches/avidemux_2.5_branch_gruntster/cmake/admFFmpegBuild.cmake
   branches/avidemux_2.5_branch_gruntster/cmake/patches/libavcodec_avcodec.h.patch
   branches/avidemux_2.5_branch_gruntster/cmake/patches/libavcodec_ffv1.c.patch
   branches/avidemux_2.5_branch_gruntster/cmake/patches/libavcodec_h263dec.c.patch
   branches/avidemux_2.5_branch_gruntster/cmake/patches/libavcodec_h264.c.patch
   branches/avidemux_2.5_branch_gruntster/cmake/patches/libavcodec_mpeg12.c.patch
   branches/avidemux_2.5_branch_gruntster/cmake/patches/libavcodec_utils.c.patch
   branches/avidemux_2.5_branch_gruntster/cmake/patches/libavformat_file.c.patch
   branches/avidemux_2.5_branch_gruntster/cmake/patches/libavformat_flvenc.c.patch
   branches/avidemux_2.5_branch_gruntster/cmake/patches/libavformat_isom.c.patch
   branches/avidemux_2.5_branch_gruntster/cmake/patches/libavformat_matroskaenc.c.patch
   branches/avidemux_2.5_branch_gruntster/cmake/patches/libavformat_movenc.c.patch
   branches/avidemux_2.5_branch_gruntster/cmake/patches/libavutil_internal.h.patch
   branches/avidemux_2.5_branch_gruntster/cmake/patches/libavutil_mem.c.patch
Log:
[ffmpeg] update to FFmpeg r16945 & libswscale r28447

Modified: branches/avidemux_2.5_branch_gruntster/CMakeLists.txt
===================================================================
--- branches/avidemux_2.5_branch_gruntster/CMakeLists.txt	2009-02-02 21:30:30 UTC (rev 4560)
+++ branches/avidemux_2.5_branch_gruntster/CMakeLists.txt	2009-02-02 21:32:18 UTC (rev 4561)
@@ -156,11 +156,10 @@
 
 	CHECK_FUNCTION_EXISTS(gettimeofday HAVE_GETTIMEOFDAY)
 
-	CHECK_INCLUDE_FILES(byteswap.h   HAVE_BYTESWAP_H)	# libavutil
 	CHECK_INCLUDE_FILES(inttypes.h   HAVE_INTTYPES_H)	# internal use, mpeg2enc, mplex
 	CHECK_INCLUDE_FILES(stdint.h     HAVE_STDINT_H)		# internal use, mpeg2enc, mplex
 	CHECK_INCLUDE_FILES(sys/types.h  HAVE_SYS_TYPES_H)	# mad, mpeg2enc
-	CHECK_INCLUDE_FILES(malloc.h     HAVE_MALLOC_H)		# libavcodec, libavutil, libpostproc, libswscale, mplex
+	CHECK_INCLUDE_FILES(malloc.h     HAVE_MALLOC_H)		# mplex
 	SET(SYSTEM_HEADERS_CHECKED 1 CACHE BOOL "")
 	MARK_AS_ADVANCED(SYSTEM_HEADERS_CHECKED)
 

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_core/src/ADM_cpuCap.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_core/src/ADM_cpuCap.cpp	2009-02-02 21:30:30 UTC (rev 4560)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_core/src/ADM_cpuCap.cpp	2009-02-02 21:32:18 UTC (rev 4561)
@@ -37,10 +37,6 @@
 #ifdef ADM_CPU_X86
 extern "C" 
 {
-#define AV_WN16
-#define AV_WN32
-#define AV_RN16
-#define AV_RN32
 #include "libavcodec/dsputil.h"
 }
 #endif

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_core/src/CMakeLists.txt
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_core/src/CMakeLists.txt	2009-02-02 21:30:30 UTC (rev 4560)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_core/src/CMakeLists.txt	2009-02-02 21:32:18 UTC (rev 4561)
@@ -14,5 +14,6 @@
 ENDIF (MINGW)
 
 REMOVE_DEFINITIONS(-DHAVE_CONFIG_H)
+include_directories("${FFMPEG_BINARY_DIR}")
 
 INSTALL(TARGETS ADM_core RUNTIME DESTINATION ${BIN_DIR}  LIBRARY DESTINATION lib  ARCHIVE DESTINATION lib)

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_tsSub.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_tsSub.cpp	2009-02-02 21:30:30 UTC (rev 4560)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_tsSub.cpp	2009-02-02 21:32:18 UTC (rev 4561)
@@ -70,7 +70,7 @@
         printf("Found %d rects to process\n",sub.num_rects);
         for(int i=0;i<sub.num_rects;i++)
         {
-          AVSubtitleRect *r=&(sub.rects[i]); 
+          AVSubtitleRect *r= sub.rects[i]; 
               printf("x :%d\n",r->x);
               printf("y :%d\n",r->y);
               printf("w :%d\n",r->w);

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_videoFilter/ADM_vidDvbSub.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_videoFilter/ADM_vidDvbSub.cpp	2009-02-02 21:30:30 UTC (rev 4560)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_videoFilter/ADM_vidDvbSub.cpp	2009-02-02 21:32:18 UTC (rev 4561)
@@ -182,19 +182,20 @@
             printf("Found %d rects to process\n",sub.num_rects);
             for(int i=0;i<sub.num_rects;i++)
             {
-              AVSubtitleRect *r=&(sub.rects[i]);
+              AVSubtitleRect *r= sub.rects[i];
               // First convert RGB to Y+ALPHA
               for(int col=0;col<r->nb_colors;col++)
               {
                     // Color is RGB, convert to YUV
                     uint32_t y,u,v,a;
-                    uint32_t rgb=r->rgba_palette[col];
+                    uint32_t rgb = ((uint32_t*)r->pict.data[1])[col];
                 
                           y=rgba2y(rgb);
                           u=rgba2u(rgb)&0xff;
                           v=rgba2v(rgb)&0xff;
                           a=_a(rgb);
-                          r->rgba_palette[col]=y+(u<<8)+(v<<16)+(a<<24);
+
+						  ((uint32_t*)r->pict.data[1])[col] = y + (u << 8) + (v << 16) + (a << 24);
                           printf("Color %d, alpha %u luma %u rgb:%x\n",col,a,y,rgb);
               }
               // Palette is ready, display !
@@ -224,7 +225,7 @@
                       uint8_t *ptrU=imageU.data;
                       uint8_t *ptrV=imageV.data;
                       uint8_t *ptrAlpha=alphaImage.data;
-                      uint8_t *in=r->bitmap;
+                      uint8_t *in=r->pict.data[0];
                       for(int yy=0;yy<r->h;yy++)
                       {
                           for(int xx=0;xx<r->w;xx++)
@@ -232,7 +233,7 @@
                             uint32_t alpha,valout;
                             uint32_t val=*in++;
                             
-                                  val=r->rgba_palette[val];
+								  val = ((uint32_t*)r->pict.data[1])[val];
                                   
                                   *ptrAlpha++=(val>>24)&0xff;
                                   *ptr++=(val&0xff);;
@@ -314,8 +315,8 @@
               }
                // Delete palette & data
 _skip:
-               av_free(r->rgba_palette);
-               av_free(r->bitmap);
+			  av_freep(r->pict.data[0]);
+			  av_freep(r->pict.data[1]);
             } // Next rec..
             memset(&sub,0,sizeof(sub));
         
@@ -347,19 +348,19 @@
             printf("Found %d rects to process\n",sub.num_rects);
             for(int i=0;i<sub.num_rects;i++)
             {
-              AVSubtitleRect *r=&(sub.rects[i]);
+              AVSubtitleRect *r = sub.rects[i];
               // First convert RGB to Y+ALPHA
               for(int col=0;col<r->nb_colors;col++)
               {
                     // Color is RGB, convert to YUV
                     uint32_t y,u,v,a;
-                    uint32_t rgb=r->rgba_palette[col];
+					uint32_t rgb = ((uint32_t*)r->pict.data[1])[col];
                 
                           y=rgba2y(rgb);
                           u=rgba2u(rgb)&0xff;
                           v=rgba2v(rgb)&0xff;
                           a=_a(rgb);
-                          r->rgba_palette[col]=y+(u<<8)+(v<<16)+(a<<24);
+                          ((uint32_t*)r->pict.data[1])[col] = y + (u << 8) + (v << 16) + (a << 24);
 #if 0
                           printf("Color %d, alpha %u luma %u rgb:%x\n",col,a,y,rgb);
 #endif
@@ -387,7 +388,7 @@
                       
                       uint8_t *ptr=image.data;
                       uint8_t *ptrAlpha=alphaImage.data;
-                      uint8_t *in=r->bitmap;
+                      uint8_t *in=r->pict.data[0];
                       for(int yy=0;yy<r->h;yy++)
                       {
                           for(int xx=0;xx<r->w;xx++)
@@ -395,7 +396,7 @@
                             uint32_t alpha,valout;
                             uint32_t val=*in++;
                             
-                                  val=r->rgba_palette[val];
+								  val = ((uint32_t*)r->pict.data[1])[val];
                                   
                                   *ptrAlpha++=(val>>24)&0xff;
                                   *ptr++=(val&0xff);;
@@ -431,8 +432,8 @@
                    // We dont need chroma here...
                // Delete palette & data
 _skipX:
-               av_free(r->rgba_palette);
-               av_free(r->bitmap);
+				  av_freep(r->pict.data[0]);
+				  av_freep(r->pict.data[1]);
             } // Next rec..
             memset(&sub,0,sizeof(sub));
         

Modified: branches/avidemux_2.5_branch_gruntster/cmake/admFFmpegBuild.cmake
===================================================================
--- branches/avidemux_2.5_branch_gruntster/cmake/admFFmpegBuild.cmake	2009-02-02 21:30:30 UTC (rev 4560)
+++ branches/avidemux_2.5_branch_gruntster/cmake/admFFmpegBuild.cmake	2009-02-02 21:32:18 UTC (rev 4561)
@@ -1,7 +1,7 @@
 include(admFFmpegUtil)
 
-set(FFMPEG_VERSION 16000)
-set(SWSCALE_VERSION 28058)
+set(FFMPEG_VERSION 16945)
+set(SWSCALE_VERSION 28447)
 set(FFMPEG_SOURCE_DIR "${CMAKE_SOURCE_DIR}/avidemux/ADM_libraries/ffmpeg")
 set(FFMPEG_BINARY_DIR "${CMAKE_BINARY_DIR}/avidemux/ADM_libraries/ffmpeg")
 
@@ -12,7 +12,7 @@
 set(FFMPEG_MUXERS  flv  ipod  matroska  mov  mp4  psp  tg2  tgp)
 set(FFMPEG_PARSERS  h263  h264  mpeg4video)
 set(FFMPEG_PROTOCOLS  file)
-set(FFMPEG_FLAGS  --enable-shared --disable-static --disable-filters --disable-protocols --disable-network --disable-indevs --disable-outdevs --disable-bsfs
+set(FFMPEG_FLAGS  --enable-shared --disable-static --disable-filters --disable-protocols --disable-indevs --disable-outdevs --disable-bsfs
 				  --disable-parsers --disable-decoders --disable-encoders --disable-demuxers --disable-muxers --enable-postproc --enable-swscale --enable-gpl 
 				  --prefix=${CMAKE_INSTALL_PREFIX})
 

Modified: branches/avidemux_2.5_branch_gruntster/cmake/patches/libavcodec_avcodec.h.patch
===================================================================
--- branches/avidemux_2.5_branch_gruntster/cmake/patches/libavcodec_avcodec.h.patch	2009-02-02 21:30:30 UTC (rev 4560)
+++ branches/avidemux_2.5_branch_gruntster/cmake/patches/libavcodec_avcodec.h.patch	2009-02-02 21:32:18 UTC (rev 4561)
@@ -1,8 +1,8 @@
-*** libavcodec/avcodec.h.old	Sun Jan 25 00:55:13 2009
---- libavcodec/avcodec.h	Sun Jan 25 00:55:13 2009
+*** libavcodec/avcodec.h.old	Mon Feb  2 19:49:48 2009
+--- libavcodec/avcodec.h	Mon Feb  2 19:49:47 2009
 ***************
-*** 497,502 ****
---- 497,504 ----
+*** 500,505 ****
+--- 500,507 ----
   #define CODEC_FLAG2_CHUNKS        0x00008000 ///< Input bitstream might be truncated at a packet boundaries instead of only at frame boundaries.
   #define CODEC_FLAG2_NON_LINEAR_QUANT 0x00010000 ///< Use MPEG-2 nonlinear quantizer.
   #define CODEC_FLAG2_BIT_RESERVOIR 0x00020000 ///< Use a bit reservoir when encoding if possible
@@ -12,8 +12,8 @@
   /* Unsupported options :
    *              Syntax Arithmetic coding (SAC)
 ***************
-*** 1274,1279 ****
---- 1276,1282 ----
+*** 1281,1286 ****
+--- 1283,1289 ----
        * - decoding: unused
        */
       int rc_max_rate;
@@ -22,8 +22,8 @@
       /**
        * minimum bitrate
 ***************
-*** 1288,1293 ****
---- 1291,1298 ----
+*** 1295,1300 ****
+--- 1298,1305 ----
        * - decoding: unused
        */
       int rc_buffer_size;

Modified: branches/avidemux_2.5_branch_gruntster/cmake/patches/libavcodec_ffv1.c.patch
===================================================================
--- branches/avidemux_2.5_branch_gruntster/cmake/patches/libavcodec_ffv1.c.patch	2009-02-02 21:30:30 UTC (rev 4560)
+++ branches/avidemux_2.5_branch_gruntster/cmake/patches/libavcodec_ffv1.c.patch	2009-02-02 21:32:18 UTC (rev 4561)
@@ -1,8 +1,8 @@
-*** libavcodec/ffv1.c.old	Sat Jan 24 22:23:51 2009
---- libavcodec/ffv1.c	Sat Jan 24 22:23:50 2009
+*** libavcodec/ffv1.c.old	Mon Feb  2 19:49:49 2009
+--- libavcodec/ffv1.c	Mon Feb  2 19:49:48 2009
 ***************
-*** 958,963 ****
---- 958,965 ----
+*** 959,964 ****
+--- 959,966 ----
           clear_state(f);
       }else{
           p->key_frame= 0;

Modified: branches/avidemux_2.5_branch_gruntster/cmake/patches/libavcodec_h263dec.c.patch
===================================================================
--- branches/avidemux_2.5_branch_gruntster/cmake/patches/libavcodec_h263dec.c.patch	2009-02-02 21:30:30 UTC (rev 4560)
+++ branches/avidemux_2.5_branch_gruntster/cmake/patches/libavcodec_h263dec.c.patch	2009-02-02 21:32:18 UTC (rev 4561)
@@ -1,5 +1,5 @@
-*** libavcodec/h263dec.c.old	Sat Jan 24 21:36:31 2009
---- libavcodec/h263dec.c	Sat Jan 24 21:36:30 2009
+*** libavcodec/h263dec.c.old	Mon Feb  2 19:49:50 2009
+--- libavcodec/h263dec.c	Mon Feb  2 19:49:49 2009
 ***************
 *** 118,123 ****
 --- 118,140 ----
@@ -27,8 +27,8 @@
   av_cold int ff_h263_decode_end(AVCodecContext *avctx)
   {
 ***************
-*** 412,417 ****
---- 429,440 ----
+*** 409,414 ****
+--- 426,437 ----
       } else {
           ret = h263_decode_picture_header(s);
       }
@@ -42,8 +42,8 @@
       if(ret==FRAME_SKIPPED) return get_consumed_bytes(s, buf_size);
   
 ***************
-*** 690,695 ****
---- 713,726 ----
+*** 687,692 ****
+--- 710,723 ----
   
   assert(s->current_picture.pict_type == s->current_picture_ptr->pict_type);
   assert(s->current_picture.pict_type == s->pict_type);

Modified: branches/avidemux_2.5_branch_gruntster/cmake/patches/libavcodec_h264.c.patch
===================================================================
--- branches/avidemux_2.5_branch_gruntster/cmake/patches/libavcodec_h264.c.patch	2009-02-02 21:30:30 UTC (rev 4560)
+++ branches/avidemux_2.5_branch_gruntster/cmake/patches/libavcodec_h264.c.patch	2009-02-02 21:32:18 UTC (rev 4561)
@@ -1,8 +1,8 @@
-*** libavcodec/h264.c.old	Sun Jan 25 00:55:16 2009
---- libavcodec/h264.c	Sun Jan 25 00:55:16 2009
+*** libavcodec/h264.c.old	Mon Feb  2 19:49:51 2009
+--- libavcodec/h264.c	Mon Feb  2 19:49:50 2009
 ***************
-*** 7948,7953 ****
---- 7948,7964 ----
+*** 8010,8015 ****
+--- 8010,8026 ----
       return 0;
   }
   

Modified: branches/avidemux_2.5_branch_gruntster/cmake/patches/libavcodec_mpeg12.c.patch
===================================================================
--- branches/avidemux_2.5_branch_gruntster/cmake/patches/libavcodec_mpeg12.c.patch	2009-02-02 21:30:30 UTC (rev 4560)
+++ branches/avidemux_2.5_branch_gruntster/cmake/patches/libavcodec_mpeg12.c.patch	2009-02-02 21:32:18 UTC (rev 4561)
@@ -1,8 +1,8 @@
-*** libavcodec/mpeg12.c.old	Sun Jan 25 00:55:17 2009
---- libavcodec/mpeg12.c	Sun Jan 25 00:55:17 2009
+*** libavcodec/mpeg12.c.old	Mon Feb  2 19:49:52 2009
+--- libavcodec/mpeg12.c	Mon Feb  2 19:49:51 2009
 ***************
-*** 1925,1930 ****
---- 1925,1935 ----
+*** 1937,1942 ****
+--- 1937,1947 ----
           ff_er_frame_end(s);
   
           MPV_frame_end(s);

Modified: branches/avidemux_2.5_branch_gruntster/cmake/patches/libavcodec_utils.c.patch
===================================================================
--- branches/avidemux_2.5_branch_gruntster/cmake/patches/libavcodec_utils.c.patch	2009-02-02 21:30:30 UTC (rev 4560)
+++ branches/avidemux_2.5_branch_gruntster/cmake/patches/libavcodec_utils.c.patch	2009-02-02 21:32:18 UTC (rev 4561)
@@ -1,8 +1,8 @@
-*** libavcodec/utils.c.old	Sun Jan 25 00:55:21 2009
---- libavcodec/utils.c	Sun Jan 25 00:55:21 2009
+*** libavcodec/utils.c.old	Mon Feb  2 19:49:56 2009
+--- libavcodec/utils.c	Mon Feb  2 19:49:55 2009
 ***************
-*** 945,954 ****
---- 945,956 ----
+*** 526,535 ****
+--- 526,537 ----
   
       if((avctx->codec->capabilities & CODEC_CAP_DELAY) || buf_size){
           //FIXME remove the check below _after_ ensuring that all audio check that the available space is enough
@@ -16,18 +16,18 @@
           *frame_size_ptr < avctx->channels * avctx->frame_size * sizeof(int16_t)){
               av_log(avctx, AV_LOG_ERROR, "buffer %d too small\n", *frame_size_ptr);
 ***************
-*** 1365,1371 ****
+*** 940,946 ****
           return -1;
       }
-  #if !defined(HAVE_MKSTEMP)
+  #if !HAVE_MKSTEMP
 !     fd = open(*filename, O_RDWR | O_BINARY | O_CREAT, 0444);
   #else
       snprintf(*filename, len, "/tmp/%sXXXXXX", prefix);
       fd = mkstemp(*filename);
---- 1367,1373 ----
+--- 942,948 ----
           return -1;
       }
-  #if !defined(HAVE_MKSTEMP)
+  #if !HAVE_MKSTEMP
 !     fd = open(*filename, O_RDWR /* MEANX | O_BINARY*/ | O_CREAT, 0444);
   #else
       snprintf(*filename, len, "/tmp/%sXXXXXX", prefix);

Modified: branches/avidemux_2.5_branch_gruntster/cmake/patches/libavformat_file.c.patch
===================================================================
--- branches/avidemux_2.5_branch_gruntster/cmake/patches/libavformat_file.c.patch	2009-02-02 21:30:30 UTC (rev 4560)
+++ branches/avidemux_2.5_branch_gruntster/cmake/patches/libavformat_file.c.patch	2009-02-02 21:32:18 UTC (rev 4561)
@@ -1,8 +1,8 @@
-*** libavformat/file.c.old	Sun Jan 25 00:55:22 2009
---- libavformat/file.c	Sun Jan 25 00:55:22 2009
+*** libavformat/file.c.old	Mon Feb  2 19:49:57 2009
+--- libavformat/file.c	Mon Feb  2 19:49:56 2009
 ***************
-*** 27,32 ****
---- 27,98 ----
+*** 30,35 ****
+--- 30,101 ----
   #include <stdlib.h>
   #include "os_support.h"
   

Modified: branches/avidemux_2.5_branch_gruntster/cmake/patches/libavformat_flvenc.c.patch
===================================================================
--- branches/avidemux_2.5_branch_gruntster/cmake/patches/libavformat_flvenc.c.patch	2009-02-02 21:30:30 UTC (rev 4560)
+++ branches/avidemux_2.5_branch_gruntster/cmake/patches/libavformat_flvenc.c.patch	2009-02-02 21:32:18 UTC (rev 4561)
@@ -1,26 +1,26 @@
-*** libavformat/flvenc.c.old	Sun Jan 25 00:55:23 2009
---- libavformat/flvenc.c	Sun Jan 25 00:55:23 2009
+*** libavformat/flvenc.c.old	Mon Feb  2 19:49:58 2009
+--- libavformat/flvenc.c	Mon Feb  2 19:49:57 2009
 ***************
-*** 382,388 ****
+*** 389,395 ****
       "video/x-flv",
       "flv",
       sizeof(FLVContext),
-! #ifdef CONFIG_LIBMP3LAME
+! #if CONFIG_LIBMP3LAME
       CODEC_ID_MP3,
   #else // CONFIG_LIBMP3LAME
       CODEC_ID_ADPCM_SWF,
---- 382,389 ----
+--- 389,396 ----
       "video/x-flv",
       "flv",
       sizeof(FLVContext),
-! //MEANX #ifdef CONFIG_LIBMP3LAME
-! #ifdef HAVE_LIBMP3LAME  
+! //MEANX #if CONFIG_LIBMP3LAME
+! #ifdef HAVE_LIBMP3LAME
       CODEC_ID_MP3,
   #else // CONFIG_LIBMP3LAME
       CODEC_ID_ADPCM_SWF,
 ***************
-*** 394,396 ****
---- 395,403 ----
+*** 401,403 ****
+--- 402,410 ----
       .codec_tag= (const AVCodecTag* const []){flv_video_codec_ids, flv_audio_codec_ids, 0},
       .flags= AVFMT_GLOBALHEADER,
   };

Modified: branches/avidemux_2.5_branch_gruntster/cmake/patches/libavformat_isom.c.patch
===================================================================
--- branches/avidemux_2.5_branch_gruntster/cmake/patches/libavformat_isom.c.patch	2009-02-02 21:30:30 UTC (rev 4560)
+++ branches/avidemux_2.5_branch_gruntster/cmake/patches/libavformat_isom.c.patch	2009-02-02 21:32:18 UTC (rev 4561)
@@ -1,7 +1,7 @@
-*** libavformat/isom.c.old	Sun Jan 25 00:55:24 2009
---- libavformat/isom.c	Sun Jan 25 00:55:23 2009
+*** libavformat/isom.c.old	Mon Feb  2 19:49:59 2009
+--- libavformat/isom.c	Mon Feb  2 19:49:59 2009
 ***************
-*** 184,190 ****
+*** 187,193 ****
       { CODEC_ID_MACE3, MKTAG('M', 'A', 'C', '3') }, /* Macintosh Audio Compression and Expansion 3:1 */
       { CODEC_ID_MACE6, MKTAG('M', 'A', 'C', '6') }, /* Macintosh Audio Compression and Expansion 6:1 */
   
@@ -9,7 +9,7 @@
       { CODEC_ID_MP3, 0x6D730055 }, /* MPEG layer 3 */
   
   /*  { CODEC_ID_OGG_VORBIS, MKTAG('O', 'g', 'g', 'S') }, *//* sample files at http://heroinewarrior.com/xmovie.php3 use this tag */
---- 184,193 ----
+--- 187,196 ----
       { CODEC_ID_MACE3, MKTAG('M', 'A', 'C', '3') }, /* Macintosh Audio Compression and Expansion 3:1 */
       { CODEC_ID_MACE6, MKTAG('M', 'A', 'C', '6') }, /* Macintosh Audio Compression and Expansion 6:1 */
   

Modified: branches/avidemux_2.5_branch_gruntster/cmake/patches/libavformat_matroskaenc.c.patch
===================================================================
--- branches/avidemux_2.5_branch_gruntster/cmake/patches/libavformat_matroskaenc.c.patch	2009-02-02 21:30:30 UTC (rev 4560)
+++ branches/avidemux_2.5_branch_gruntster/cmake/patches/libavformat_matroskaenc.c.patch	2009-02-02 21:32:18 UTC (rev 4561)
@@ -1,8 +1,8 @@
-*** libavformat/matroskaenc.c.old	Sun Jan 25 00:55:25 2009
---- libavformat/matroskaenc.c	Sun Jan 25 00:55:25 2009
+*** libavformat/matroskaenc.c.old	Mon Feb  2 19:50:00 2009
+--- libavformat/matroskaenc.c	Mon Feb  2 19:49:59 2009
 ***************
-*** 393,398 ****
---- 393,399 ----
+*** 394,399 ****
+--- 394,400 ----
   
   static int put_xiph_codecpriv(AVFormatContext *s, ByteIOContext *pb, AVCodecContext *codec)
   {
@@ -11,8 +11,8 @@
       int header_len[3];
       int first_header_size;
 ***************
-*** 417,422 ****
---- 418,445 ----
+*** 418,423 ****
+--- 419,446 ----
           put_buffer(pb, header_start[j], header_len[j]);
   
       return 0;
@@ -42,8 +42,8 @@
   
   #define FLAC_STREAMINFO_SIZE 34
 ***************
-*** 553,558 ****
---- 576,598 ----
+*** 554,559 ****
+--- 577,599 ----
           put_ebml_uint (pb, MATROSKA_ID_TRACKNUMBER     , i + 1);
           put_ebml_uint (pb, MATROSKA_ID_TRACKUID        , i + 1);
           put_ebml_uint (pb, MATROSKA_ID_TRACKFLAGLACING , 0);    // no lacing (yet)
@@ -68,8 +68,8 @@
           if (st->language[0])
               put_ebml_string(pb, MATROSKA_ID_TRACKLANGUAGE, st->language);
 ***************
-*** 922,924 ****
---- 962,974 ----
+*** 926,928 ****
+--- 966,978 ----
       .flags = AVFMT_GLOBALHEADER,
       .codec_tag = (const AVCodecTag* const []){codec_wav_tags, 0},
   };

Modified: branches/avidemux_2.5_branch_gruntster/cmake/patches/libavformat_movenc.c.patch
===================================================================
--- branches/avidemux_2.5_branch_gruntster/cmake/patches/libavformat_movenc.c.patch	2009-02-02 21:30:30 UTC (rev 4560)
+++ branches/avidemux_2.5_branch_gruntster/cmake/patches/libavformat_movenc.c.patch	2009-02-02 21:32:18 UTC (rev 4561)
@@ -1,8 +1,8 @@
-*** libavformat/movenc.c.old	Sun Jan 25 00:55:26 2009
---- libavformat/movenc.c	Sun Jan 25 00:55:25 2009
+*** libavformat/movenc.c.old	Mon Feb  2 19:50:01 2009
+--- libavformat/movenc.c	Mon Feb  2 19:50:00 2009
 ***************
-*** 1857,1859 ****
---- 1857,1871 ----
+*** 1913,1915 ****
+--- 1913,1927 ----
       .codec_tag = (const AVCodecTag* const []){ff_mp4_obj_type, 0},
   };
   #endif

Modified: branches/avidemux_2.5_branch_gruntster/cmake/patches/libavutil_internal.h.patch
===================================================================
--- branches/avidemux_2.5_branch_gruntster/cmake/patches/libavutil_internal.h.patch	2009-02-02 21:30:30 UTC (rev 4560)
+++ branches/avidemux_2.5_branch_gruntster/cmake/patches/libavutil_internal.h.patch	2009-02-02 21:32:18 UTC (rev 4561)
@@ -1,11 +1,11 @@
-*** libavutil/internal.h.old	Sun Jan 25 00:55:28 2009
---- libavutil/internal.h	Sun Jan 25 00:55:28 2009
+*** libavutil/internal.h.old	Mon Feb  2 19:50:03 2009
+--- libavutil/internal.h	Mon Feb  2 19:50:02 2009
 ***************
-*** 223,234 ****
---- 223,236 ----
+*** 219,230 ****
+--- 219,232 ----
   #endif
   
-  /* avoid usage of various functions */
+  /* avoid usage of dangerous/inappropriate system functions */
 + #if 0 //MEANX
   #undef  malloc
   #define malloc please_use_av_malloc

Modified: branches/avidemux_2.5_branch_gruntster/cmake/patches/libavutil_mem.c.patch
===================================================================
--- branches/avidemux_2.5_branch_gruntster/cmake/patches/libavutil_mem.c.patch	2009-02-02 21:30:30 UTC (rev 4560)
+++ branches/avidemux_2.5_branch_gruntster/cmake/patches/libavutil_mem.c.patch	2009-02-02 21:32:18 UTC (rev 4561)
@@ -1,18 +1,12 @@
-*** libavutil/mem.c	Sat Jan 24 20:25:19 2009
---- libavutil/mem.c	Sat Jan 24 20:17:09 2009
+*** libavutil/mem.c.old	Mon Feb  2 20:01:23 2009
+--- libavutil/mem.c	Mon Feb  2 20:01:22 2009
 ***************
-*** 35,124 ****
-  #include <malloc.h>
-  #endif
+*** 46,131 ****
   
-- /* you can redefine av_malloc and av_free in your project to use your
--    memory allocator. You do not need to suppress this file because the
--    linker will do it automatically */
-- 
   void *av_malloc(unsigned int size)
   {
-!     void *ptr;
-! #ifdef CONFIG_MEMALIGN_HACK
+!     void *ptr = NULL;
+! #if CONFIG_MEMALIGN_HACK
 !     long diff;
 ! #endif
   
@@ -20,20 +14,22 @@
 !     if(size > (INT_MAX-16) )
 !         return NULL;
 ! 
-! #ifdef CONFIG_MEMALIGN_HACK
+! #if CONFIG_MEMALIGN_HACK
 !     ptr = malloc(size+16);
 !     if(!ptr)
 !         return ptr;
 !     diff= ((-(long)ptr - 1)&15) + 1;
 !     ptr = (char*)ptr + diff;
 !     ((char*)ptr)[-1]= diff;
-! #elif defined (HAVE_MEMALIGN)
+! #elif HAVE_POSIX_MEMALIGN
+!     posix_memalign(&ptr,16,size);
+! #elif HAVE_MEMALIGN
 !     ptr = memalign(16,size);
 !     /* Why 64?
 !        Indeed, we should align it:
 !          on 4 for 386
 !          on 16 for 486
-!          on 32 for 586, PPro - k6-III
+!          on 32 for 586, PPro - K6-III
 !          on 64 for K7 (maybe for P3 too).
 !        Because L1 and L2 caches are aligned on those values.
 !        But I don't want to code such logic here!
@@ -41,10 +37,10 @@
 !      /* Why 16?
 !         Because some CPUs need alignment, for example SSE2 on P4, & most RISC CPUs
 !         it will just trigger an exception and the unaligned load will be done in the
-!         exception handler or it will just segfault (SSE2 on P4)
+!         exception handler or it will just segfault (SSE2 on P4).
 !         Why not larger? Because I did not see a difference in benchmarks ...
 !      */
-!      /* benchmarks with p3
+!      /* benchmarks with P3
 !         memalign(64)+1          3071,3051,3032
 !         memalign(64)+2          3051,3032,3041
 !         memalign(64)+4          2911,2896,2915
@@ -53,7 +49,7 @@
 !         memalign(64)+32         2546,2545,2571
 !         memalign(64)+64         2570,2533,2558
   
-!         btw, malloc seems to do 8 byte alignment by default here
+!         BTW, malloc seems to do 8-byte alignment by default here.
 !      */
 ! #else
 !     ptr = malloc(size);
@@ -63,7 +59,7 @@
   
 ! void *av_realloc(void *ptr, unsigned int size)
   {
-! #ifdef CONFIG_MEMALIGN_HACK
+! #if CONFIG_MEMALIGN_HACK
 !     int diff;
 ! #endif
   
@@ -71,7 +67,7 @@
 !     if(size > (INT_MAX-16) )
 !         return NULL;
 ! 
-! #ifdef CONFIG_MEMALIGN_HACK
+! #if CONFIG_MEMALIGN_HACK
 !     //FIXME this isn't aligned correctly, though it probably isn't needed
 !     if(!ptr) return av_malloc(size);
 !     diff= ((char*)ptr)[-1];
@@ -85,16 +81,14 @@
   {
 !     /* XXX: this test should not be needed on most libcs */
 !     if (ptr)
-! #ifdef CONFIG_MEMALIGN_HACK
+! #if CONFIG_MEMALIGN_HACK
 !         free((char*)ptr - ((char*)ptr)[-1]);
   #else
 !         free(ptr);
   #endif
   }
   
---- 35,146 ----
-  #include <malloc.h>
-  #endif
+--- 46,155 ----
   
   void *av_malloc(unsigned int size)
   {
@@ -126,13 +120,13 @@
 ! #ifdef __APPLE__
 ! 	if (!ptr)
 ! 		return av_malloc(newsize);
-  
+! 
 ! 	if (!newsize)
 ! 	{
 ! 		av_free(ptr);
 ! 		return NULL;
 ! 	}
-! 
+  
 ! 	return realloc(ptr, newsize);
   #else
 ! 	void *nalloc;



From gruntster at mail.berlios.de  Tue Feb  3 17:10:56 2009
From: gruntster at mail.berlios.de (gruntster at mail.berlios.de)
Date: Tue, 3 Feb 2009 17:10:56 +0100
Subject: [Avidemux-svn-commit] r4562 -
	branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog
Message-ID: <200902031610.n13GAuLd025422@sheep.berlios.de>

Author: gruntster
Date: 2009-02-03 17:10:50 +0100 (Tue, 03 Feb 2009)
New Revision: 4562

Modified:
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/alert_qt4.cpp
Log:
[Qt] UTF-8 fix for alert boxes

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/alert_qt4.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/alert_qt4.cpp	2009-02-02 21:32:18 UTC (rev 4561)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/alert_qt4.cpp	2009-02-03 16:10:50 UTC (rev 4562)
@@ -62,6 +62,7 @@
 		va_start(ap, secondary_format);
 
 		alertString.vsprintf(secondary_format, ap);
+		alertString = QString::fromUtf8(alertString.toAscii().constData());
 		alertString = "<big><b>" + QString::fromUtf8(primary) + "</b></big><br><br>" + alertString;
 		alertString.replace("\n", "<br>");
 
@@ -95,6 +96,7 @@
 		va_start(ap, secondary_format);
 
 		alertString.vsprintf(secondary_format, ap);
+		alertString = QString::fromUtf8(alertString.toAscii().constData());
 		alertString = "<big><b>" + QString::fromUtf8(primary) + "</b></big><br><br>" + alertString;
 		alertString.replace("\n", "<br>");
 
@@ -125,6 +127,7 @@
 		va_start(ap, secondary_format);
 
 		alertString.vsprintf(secondary_format, ap);
+		alertString = QString::fromUtf8(alertString.toAscii().constData());
 		alertString = "<big><b>" + QString::fromUtf8(primary) + "</b></big><br><br>" + alertString;
 		alertString.replace("\n", "<br>");
 
@@ -161,6 +164,7 @@
 		va_start(ap, secondary_format);
 
 		alertString.vsprintf(secondary_format, ap);
+		alertString = QString::fromUtf8(alertString.toAscii().constData());
 		alertString = "<big><b>" + QString::fromUtf8(primary) + "</b></big><br><br>" + alertString;
 		alertString.replace("\n", "<br>");
 



From gruntster at mail.berlios.de  Tue Feb  3 17:50:36 2009
From: gruntster at mail.berlios.de (gruntster at mail.berlios.de)
Date: Tue, 3 Feb 2009 17:50:36 +0100
Subject: [Avidemux-svn-commit] r4563 -
	branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog
Message-ID: <200902031650.n13Goav0029279@sheep.berlios.de>

Author: gruntster
Date: 2009-02-03 17:50:31 +0100 (Tue, 03 Feb 2009)
New Revision: 4563

Modified:
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/alert_qt4.cpp
Log:
[Qt] fix headers to enable translator for alert boxes

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/alert_qt4.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/alert_qt4.cpp	2009-02-03 16:10:50 UTC (rev 4562)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/alert_qt4.cpp	2009-02-03 16:50:31 UTC (rev 4563)
@@ -1,23 +1,14 @@
 #include "config.h"
-#include <stdio.h>
-#include <stdlib.h>
-#include <sys/types.h>
-#include <sys/stat.h>
-#include <unistd.h>
-#include <string.h>
-#include <stdio.h>
-#include <stdarg.h>
-#include <ctype.h>
-#include <math.h>
-#include "default.h"
-#include "prefs.h"
-#include "default.h"
 
-#include <QDialog>
+#ifdef HAVE_GETTEXT
+#  include <libintl.h>
+#endif
+
 #include <QMessageBox>
 
+#include "default.h"
+#include "prefs.h"
 #include "ADM_toolkit/toolkit.hxx"
-#include "ADM_assert.h" 
 #include "../ADM_toolkit/qtToolkit.h"
 
 static int beQuiet=0;



From mean at mail.berlios.de  Tue Feb  3 19:57:09 2009
From: mean at mail.berlios.de (mean at BerliOS)
Date: Tue, 3 Feb 2009 19:57:09 +0100
Subject: [Avidemux-svn-commit] r4564 - in branches/avidemux_2.6_branch_mean:
	. avidemux/ADM_coreUI/include
	avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog
	avidemux/ADM_userInterfaces/ADM_QT4/ADM_filters
Message-ID: <200902031857.n13Iv94g026266@sheep.berlios.de>

Author: mean
Date: 2009-02-03 19:57:09 +0100 (Tue, 03 Feb 2009)
New Revision: 4564

Modified:
   branches/avidemux_2.6_branch_mean/CMakeLists.txt
   branches/avidemux_2.6_branch_mean/avidemux/ADM_coreUI/include/DIA_working.h
   branches/avidemux_2.6_branch_mean/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/CMakeLists.txt
   branches/avidemux_2.6_branch_mean/avidemux/ADM_userInterfaces/ADM_QT4/ADM_filters/Q_mainfilter.cpp
Log:
[QT4] Re-enable QT

Modified: branches/avidemux_2.6_branch_mean/CMakeLists.txt
===================================================================
--- branches/avidemux_2.6_branch_mean/CMakeLists.txt	2009-02-03 16:50:31 UTC (rev 4563)
+++ branches/avidemux_2.6_branch_mean/CMakeLists.txt	2009-02-03 18:57:09 UTC (rev 4564)
@@ -87,7 +87,7 @@
 # since it uses the minimum set of required libraries and CMake will 
 # fail if these aren't met.
 SET(ADM_UI_GTK 1)
-SET(ADM_UI_QT4 0)
+SET(ADM_UI_QT4 1)
 
 SET(ADM_INSTALL_DIR "${CMAKE_INSTALL_PREFIX}")
 

Modified: branches/avidemux_2.6_branch_mean/avidemux/ADM_coreUI/include/DIA_working.h
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/ADM_coreUI/include/DIA_working.h	2009-02-03 16:50:31 UTC (rev 4563)
+++ branches/avidemux_2.6_branch_mean/avidemux/ADM_coreUI/include/DIA_working.h	2009-02-03 18:57:09 UTC (rev 4564)
@@ -20,7 +20,7 @@
 
 #ifndef __DIA_WK__
 #define __DIA_WK__
-
+#include "ADM_clock.h"
 	class DIA_workingBase
 	{
 		protected :

Modified: branches/avidemux_2.6_branch_mean/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/CMakeLists.txt
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/CMakeLists.txt	2009-02-03 16:50:31 UTC (rev 4563)
+++ branches/avidemux_2.6_branch_mean/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/CMakeLists.txt	2009-02-03 18:57:09 UTC (rev 4564)
@@ -1,13 +1,14 @@
 SET(ADM_LIB ADM_dialogQt4)
 
 SET(uiFiles
-	about.ui  calculator.ui  
+	about.ui  
+        calculator.ui  
 #encoding.ui  
         license.ui
 	jobs.ui  props.ui  vobsub.ui  working.ui)
 
 SET(headers
-	Q_about.h  Q_calculator.h  i
+	Q_about.h  Q_calculator.h  
 #Q_encoding.h
 	Q_license.h  Q_jobs.h  Q_props.h  Q_vobsub.h  Q_working.h  T_index_pg.h)
 
@@ -17,11 +18,16 @@
 
 SET(${ADM_LIB}_SRCS ${${ADM_LIB}_SRCS}
 	${${ADM_LIB}_headers}  ${${ADM_LIB}_source}  ${${ADM_LIB}_resource}  Q_about.cpp  
-	Q_calculator.cpp  
+#	Q_calculator.cpp  
 #Q_encoding.cpp  
         Q_license.cpp
-	Q_jobs.cpp  Q_props.cpp   Q_vobsub.cpp  Q_working.cpp   T_index_pg.cpp
-	alert_qt4.cpp  DIA_busy.cpp  DIA_none.cpp  DIA_xvid4.cpp  OCR_none.cpp)
+	Q_jobs.cpp  Q_props.cpp   
+#Q_vobsub.cpp  
+#Q_working.cpp   
+        T_index_pg.cpp
+	alert_qt4.cpp  DIA_busy.cpp  DIA_none.cpp  
+#DIA_xvid4.cpp  OCR_none.cpp
+)
 
 ADD_DEFINITIONS(-DADM_SUBVERSION=${ADM_SUBVERSION})
 INCLUDE_DIRECTORIES(${CMAKE_CURRENT_BINARY_DIR})

Modified: branches/avidemux_2.6_branch_mean/avidemux/ADM_userInterfaces/ADM_QT4/ADM_filters/Q_mainfilter.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/ADM_userInterfaces/ADM_QT4/ADM_filters/Q_mainfilter.cpp	2009-02-03 16:50:31 UTC (rev 4563)
+++ branches/avidemux_2.6_branch_mean/avidemux/ADM_userInterfaces/ADM_QT4/ADM_filters/Q_mainfilter.cpp	2009-02-03 18:57:09 UTC (rev 4564)
@@ -31,7 +31,7 @@
 #include "DIA_fileSel.h"
 
 # include "prefs.h"
-#include "ADM_audiodevice/audio_out.h"
+//#include "ADM_audiodevice/audio_out.h"
 
 #include "ADM_userInterfaces/ADM_render/GUI_render.h"
 



From mean at mail.berlios.de  Tue Feb  3 19:57:11 2009
From: mean at mail.berlios.de (mean at BerliOS)
Date: Tue, 3 Feb 2009 19:57:11 +0100
Subject: [Avidemux-svn-commit] r4565 -
	branches/avidemux_2.6_branch_mean/avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui
Message-ID: <200902031857.n13IvBQZ026282@sheep.berlios.de>

Author: mean
Date: 2009-02-03 19:57:11 +0100 (Tue, 03 Feb 2009)
New Revision: 4565

Modified:
   branches/avidemux_2.6_branch_mean/avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/CMakeLists.txt
Log:
[QT4] Re-enable QT

Modified: branches/avidemux_2.6_branch_mean/avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/CMakeLists.txt
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/CMakeLists.txt	2009-02-03 18:57:09 UTC (rev 4564)
+++ branches/avidemux_2.6_branch_mean/avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/CMakeLists.txt	2009-02-03 18:57:11 UTC (rev 4565)
@@ -5,8 +5,10 @@
 QT4_ADD_RESOURCES(${ADM_LIB}_resource  avidemux.qrc)
 
 SET(${ADM_LIB}_SRCS
-	Q_gui2.cpp  T_preview.cpp  file_qt4.cpp  gui_none.cpp  ADM_qslider.cpp
+	Q_gui2.cpp  
+#T_preview.cpp  
+        file_qt4.cpp  gui_none.cpp  ADM_qslider.cpp
 	${${ADM_LIB}_header}  ${${ADM_LIB}_source}  ${${ADM_LIB}_resource})
 
 INCLUDE_DIRECTORIES(${CMAKE_CURRENT_BINARY_DIR}  ${CMAKE_CURRENT_SOURCE_DIR})
-ADD_ADM_LIB_QT4_TARGET(${ADM_LIB} ${${ADM_LIB}_SRCS})
\ No newline at end of file
+ADD_ADM_LIB_QT4_TARGET(${ADM_LIB} ${${ADM_LIB}_SRCS})



From mean at mail.berlios.de  Wed Feb  4 20:10:18 2009
From: mean at mail.berlios.de (mean at BerliOS)
Date: Wed, 4 Feb 2009 20:10:18 +0100
Subject: [Avidemux-svn-commit] r4568 - in
	branches/avidemux_2.6_branch_mean/plugins/ADM_muxers:
	muxerFlv muxerMp4
Message-ID: <200902041910.n14JAIrY026211@sheep.berlios.de>

Author: mean
Date: 2009-02-04 20:10:17 +0100 (Wed, 04 Feb 2009)
New Revision: 4568

Modified:
   branches/avidemux_2.6_branch_mean/plugins/ADM_muxers/muxerFlv/CMakeLists.txt
   branches/avidemux_2.6_branch_mean/plugins/ADM_muxers/muxerMp4/CMakeLists.txt
Log:
[Plugin/Win32] link with needed libs

Modified: branches/avidemux_2.6_branch_mean/plugins/ADM_muxers/muxerFlv/CMakeLists.txt
===================================================================
--- branches/avidemux_2.6_branch_mean/plugins/ADM_muxers/muxerFlv/CMakeLists.txt	2009-02-04 19:10:15 UTC (rev 4567)
+++ branches/avidemux_2.6_branch_mean/plugins/ADM_muxers/muxerFlv/CMakeLists.txt	2009-02-04 19:10:17 UTC (rev 4568)
@@ -6,7 +6,7 @@
 )
 
 ADD_LIBRARY(ADM_mx_flv SHARED ${ADM_flv_SRCS})
-
+TARGET_LINK_LIBRARIES(ADM_mx_flv  ADM_libavutil ADM_libavformat)
 INCLUDE_DIRECTORIES("${AVIDEMUX_SOURCE_DIR}/avidemux/ADM_libraries/ADM_ffmpeg")
 
 INIT_MUXER(ADM_mx_flv)

Modified: branches/avidemux_2.6_branch_mean/plugins/ADM_muxers/muxerMp4/CMakeLists.txt
===================================================================
--- branches/avidemux_2.6_branch_mean/plugins/ADM_muxers/muxerMp4/CMakeLists.txt	2009-02-04 19:10:15 UTC (rev 4567)
+++ branches/avidemux_2.6_branch_mean/plugins/ADM_muxers/muxerMp4/CMakeLists.txt	2009-02-04 19:10:17 UTC (rev 4568)
@@ -8,7 +8,7 @@
 ADD_LIBRARY(ADM_mx_mp4 SHARED ${ADM_mp4_SRCS})
 
 INCLUDE_DIRECTORIES("${AVIDEMUX_SOURCE_DIR}/avidemux/ADM_libraries/ADM_ffmpeg")
-
+TARGET_LINK_LIBRARIES(ADM_mx_mp4  ADM_libavutil ADM_libavformat)
 INIT_MUXER(ADM_mx_mp4)
 INSTALL_MUXER(ADM_mx_mp4)
 



From mean at mail.berlios.de  Wed Feb  4 20:10:16 2009
From: mean at mail.berlios.de (mean at BerliOS)
Date: Wed, 4 Feb 2009 20:10:16 +0100
Subject: [Avidemux-svn-commit] r4567 -
	branches/avidemux_2.6_branch_mean/plugins/ADM_audioDevices/Sdl
Message-ID: <200902041910.n14JAGne026201@sheep.berlios.de>

Author: mean
Date: 2009-02-04 20:10:15 +0100 (Wed, 04 Feb 2009)
New Revision: 4567

Modified:
   branches/avidemux_2.6_branch_mean/plugins/ADM_audioDevices/Sdl/ADM_deviceSDL.cpp
Log:
[SDLAudio] Avoid race when stopping device

Modified: branches/avidemux_2.6_branch_mean/plugins/ADM_audioDevices/Sdl/ADM_deviceSDL.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/plugins/ADM_audioDevices/Sdl/ADM_deviceSDL.cpp	2009-02-03 18:57:13 UTC (rev 4566)
+++ branches/avidemux_2.6_branch_mean/plugins/ADM_audioDevices/Sdl/ADM_deviceSDL.cpp	2009-02-04 19:10:15 UTC (rev 4567)
@@ -48,6 +48,7 @@
 */
 void SDL_callback(void *userdata, Uint8 *stream, int len)
 {
+
     sdlAudioDevice *me=(sdlAudioDevice *)userdata;
     me->callback(stream,len);
 }
@@ -62,6 +63,8 @@
         memset(stream,0,len);
         return true;
     }
+    // Make sure there is no race with the other thread...
+    if(stopRequest!=AUDIO_DEVICE_STARTED || !audioBuffer) return true;
     mutex.lock();
     uint32_t avail=wrIndex-rdIndex;
     if(avail<len)



From mean at mail.berlios.de  Thu Feb  5 07:50:38 2009
From: mean at mail.berlios.de (mean at BerliOS)
Date: Thu, 5 Feb 2009 07:50:38 +0100
Subject: [Avidemux-svn-commit] r4569 -
	branches/avidemux_2.6_branch_mean/avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui
Message-ID: <200902050650.n156ocN9029066@sheep.berlios.de>

Author: mean
Date: 2009-02-05 07:50:35 +0100 (Thu, 05 Feb 2009)
New Revision: 4569

Modified:
   branches/avidemux_2.6_branch_mean/avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/Q_gui2.cpp
   branches/avidemux_2.6_branch_mean/avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui
   branches/avidemux_2.6_branch_mean/avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/translation_table.h
Log:
[QT4] Add plugins info menu entry + hook output format + add configure output button

Modified: branches/avidemux_2.6_branch_mean/avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/Q_gui2.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/Q_gui2.cpp	2009-02-04 19:10:17 UTC (rev 4568)
+++ branches/avidemux_2.6_branch_mean/avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/Q_gui2.cpp	2009-02-05 06:50:35 UTC (rev 4569)
@@ -50,6 +50,10 @@
 extern int A_appendAvi(const char *name);
 extern char *actual_workbench_file;
 extern void FileSel_ReadWrite(SELFILE_CB *cb, int rw, const char *name, const char *actual_workbench_file);
+
+uint32_t ADM_mx_getNbMuxers(void);
+const char *ADM_mx_getName(uint32_t i);
+
 
 int SliderIsShifted=0;
 static void setupMenus(void);
@@ -733,13 +737,13 @@
 	}
 
 	/*   Fill in output format window */
-	uint32_t nbFormat;
+	uint32_t nbFormat=ADM_mx_getNbMuxers();
 
-	nbFormat=sizeof(ADM_allOutputFormat)/sizeof(ADM_FORMAT_DESC);
 	printf("Found %d format(s)\n",nbFormat);
 	for(uint32_t i=0;i<nbFormat;i++)
-	{
-		WIDGET(comboBoxFormat)->addItem(QT_TR_NOOP(ADM_allOutputFormat[i].text));	
+	{
+        const char *name=ADM_mx_getName(i);
+		WIDGET(comboBoxFormat)->addItem(name);	
 	}
 
 }

Modified: branches/avidemux_2.6_branch_mean/avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui	2009-02-04 19:10:17 UTC (rev 4568)
+++ branches/avidemux_2.6_branch_mean/avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui	2009-02-05 06:50:35 UTC (rev 4569)
@@ -7,14 +7,16 @@
     <x>0</x>
     <y>0</y>
     <width>838</width>
-    <height>568</height>
+    <height>606</height>
    </rect>
   </property>
   <property name="windowTitle" >
    <string>Avidemux</string>
   </property>
   <property name="windowIcon" >
-   <iconset/>
+   <iconset>
+    <normaloff/>
+   </iconset>
   </property>
   <property name="iconSize" >
    <size>
@@ -27,69 +29,33 @@
     <property name="spacing" >
      <number>6</number>
     </property>
-    <property name="leftMargin" >
+    <property name="margin" >
      <number>9</number>
     </property>
-    <property name="topMargin" >
-     <number>9</number>
-    </property>
-    <property name="rightMargin" >
-     <number>9</number>
-    </property>
-    <property name="bottomMargin" >
-     <number>9</number>
-    </property>
     <item>
      <layout class="QHBoxLayout" >
       <property name="spacing" >
        <number>6</number>
       </property>
-      <property name="leftMargin" >
+      <property name="margin" >
        <number>0</number>
       </property>
-      <property name="topMargin" >
-       <number>0</number>
-      </property>
-      <property name="rightMargin" >
-       <number>0</number>
-      </property>
-      <property name="bottomMargin" >
-       <number>0</number>
-      </property>
       <item>
        <layout class="QVBoxLayout" >
         <property name="spacing" >
          <number>6</number>
         </property>
-        <property name="leftMargin" >
+        <property name="margin" >
          <number>0</number>
         </property>
-        <property name="topMargin" >
-         <number>0</number>
-        </property>
-        <property name="rightMargin" >
-         <number>0</number>
-        </property>
-        <property name="bottomMargin" >
-         <number>0</number>
-        </property>
         <item>
          <layout class="QVBoxLayout" >
           <property name="spacing" >
            <number>0</number>
           </property>
-          <property name="leftMargin" >
+          <property name="margin" >
            <number>0</number>
           </property>
-          <property name="topMargin" >
-           <number>0</number>
-          </property>
-          <property name="rightMargin" >
-           <number>0</number>
-          </property>
-          <property name="bottomMargin" >
-           <number>0</number>
-          </property>
           <item>
            <widget class="QLabel" name="label_3" >
             <property name="sizePolicy" >
@@ -120,7 +86,7 @@
             <property name="sizeType" >
              <enum>QSizePolicy::Fixed</enum>
             </property>
-            <property name="sizeHint" >
+            <property name="sizeHint" stdset="0" >
              <size>
               <width>20</width>
               <height>5</height>
@@ -133,18 +99,9 @@
             <property name="spacing" >
              <number>0</number>
             </property>
-            <property name="leftMargin" >
+            <property name="margin" >
              <number>0</number>
             </property>
-            <property name="topMargin" >
-             <number>0</number>
-            </property>
-            <property name="rightMargin" >
-             <number>0</number>
-            </property>
-            <property name="bottomMargin" >
-             <number>0</number>
-            </property>
             <item>
              <spacer>
               <property name="orientation" >
@@ -153,7 +110,7 @@
               <property name="sizeType" >
                <enum>QSizePolicy::Fixed</enum>
               </property>
-              <property name="sizeHint" >
+              <property name="sizeHint" stdset="0" >
                <size>
                 <width>12</width>
                 <height>0</height>
@@ -166,18 +123,9 @@
               <property name="spacing" >
                <number>6</number>
               </property>
-              <property name="leftMargin" >
+              <property name="margin" >
                <number>0</number>
               </property>
-              <property name="topMargin" >
-               <number>0</number>
-              </property>
-              <property name="rightMargin" >
-               <number>0</number>
-              </property>
-              <property name="bottomMargin" >
-               <number>0</number>
-              </property>
               <item>
                <widget class="QComboBox" name="comboBoxVideo" >
                 <property name="sizePolicy" >
@@ -237,7 +185,7 @@
             <property name="sizeType" >
              <enum>QSizePolicy::Fixed</enum>
             </property>
-            <property name="sizeHint" >
+            <property name="sizeHint" stdset="0" >
              <size>
               <width>1</width>
               <height>14</height>
@@ -275,7 +223,7 @@
             <property name="sizeType" >
              <enum>QSizePolicy::Fixed</enum>
             </property>
-            <property name="sizeHint" >
+            <property name="sizeHint" stdset="0" >
              <size>
               <width>20</width>
               <height>5</height>
@@ -288,18 +236,9 @@
             <property name="spacing" >
              <number>0</number>
             </property>
-            <property name="leftMargin" >
+            <property name="margin" >
              <number>0</number>
             </property>
-            <property name="topMargin" >
-             <number>0</number>
-            </property>
-            <property name="rightMargin" >
-             <number>0</number>
-            </property>
-            <property name="bottomMargin" >
-             <number>0</number>
-            </property>
             <item>
              <spacer>
               <property name="orientation" >
@@ -308,7 +247,7 @@
               <property name="sizeType" >
                <enum>QSizePolicy::Fixed</enum>
               </property>
-              <property name="sizeHint" >
+              <property name="sizeHint" stdset="0" >
                <size>
                 <width>12</width>
                 <height>0</height>
@@ -321,18 +260,9 @@
               <property name="spacing" >
                <number>6</number>
               </property>
-              <property name="leftMargin" >
+              <property name="margin" >
                <number>0</number>
               </property>
-              <property name="topMargin" >
-               <number>0</number>
-              </property>
-              <property name="rightMargin" >
-               <number>0</number>
-              </property>
-              <property name="bottomMargin" >
-               <number>0</number>
-              </property>
               <item>
                <widget class="QComboBox" name="comboBoxAudio" >
                 <property name="sizePolicy" >
@@ -385,18 +315,9 @@
                 <property name="spacing" >
                  <number>6</number>
                 </property>
-                <property name="leftMargin" >
+                <property name="margin" >
                  <number>0</number>
                 </property>
-                <property name="topMargin" >
-                 <number>0</number>
-                </property>
-                <property name="rightMargin" >
-                 <number>0</number>
-                </property>
-                <property name="bottomMargin" >
-                 <number>0</number>
-                </property>
                 <item>
                  <widget class="QCheckBox" name="checkBox_TimeShift" >
                   <property name="text" >
@@ -434,7 +355,7 @@
             <property name="sizeType" >
              <enum>QSizePolicy::Fixed</enum>
             </property>
-            <property name="sizeHint" >
+            <property name="sizeHint" stdset="0" >
              <size>
               <width>1</width>
               <height>14</height>
@@ -466,7 +387,7 @@
             <property name="sizeType" >
              <enum>QSizePolicy::Fixed</enum>
             </property>
-            <property name="sizeHint" >
+            <property name="sizeHint" stdset="0" >
              <size>
               <width>20</width>
               <height>5</height>
@@ -475,68 +396,75 @@
            </spacer>
           </item>
           <item>
-           <layout class="QHBoxLayout" >
-            <property name="spacing" >
-             <number>0</number>
+           <spacer>
+            <property name="orientation" >
+             <enum>Qt::Vertical</enum>
             </property>
-            <property name="leftMargin" >
-             <number>0</number>
+            <property name="sizeType" >
+             <enum>QSizePolicy::Expanding</enum>
             </property>
-            <property name="topMargin" >
-             <number>0</number>
+            <property name="sizeHint" stdset="0" >
+             <size>
+              <width>20</width>
+              <height>10</height>
+             </size>
             </property>
-            <property name="rightMargin" >
-             <number>0</number>
-            </property>
-            <property name="bottomMargin" >
-             <number>0</number>
-            </property>
-            <item>
-             <spacer>
-              <property name="orientation" >
-               <enum>Qt::Horizontal</enum>
-              </property>
-              <property name="sizeType" >
-               <enum>QSizePolicy::Fixed</enum>
-              </property>
-              <property name="sizeHint" >
-               <size>
-                <width>12</width>
-                <height>1</height>
-               </size>
-              </property>
-             </spacer>
-            </item>
-            <item>
-             <widget class="QComboBox" name="comboBoxFormat" >
-              <property name="sizePolicy" >
-               <sizepolicy vsizetype="Fixed" hsizetype="Minimum" >
-                <horstretch>0</horstretch>
-                <verstretch>0</verstretch>
-               </sizepolicy>
-              </property>
-             </widget>
-            </item>
-           </layout>
+           </spacer>
           </item>
+         </layout>
+        </item>
+        <item>
+         <layout class="QHBoxLayout" >
+          <property name="spacing" >
+           <number>0</number>
+          </property>
+          <property name="margin" >
+           <number>0</number>
+          </property>
           <item>
            <spacer>
             <property name="orientation" >
-             <enum>Qt::Vertical</enum>
+             <enum>Qt::Horizontal</enum>
             </property>
             <property name="sizeType" >
-             <enum>QSizePolicy::Expanding</enum>
+             <enum>QSizePolicy::Fixed</enum>
             </property>
-            <property name="sizeHint" >
+            <property name="sizeHint" stdset="0" >
              <size>
-              <width>20</width>
-              <height>10</height>
+              <width>12</width>
+              <height>1</height>
              </size>
             </property>
            </spacer>
           </item>
+          <item>
+           <widget class="QComboBox" name="comboBoxFormat" >
+            <property name="sizePolicy" >
+             <sizepolicy vsizetype="Fixed" hsizetype="Minimum" >
+              <horstretch>0</horstretch>
+              <verstretch>0</verstretch>
+             </sizepolicy>
+            </property>
+           </widget>
+          </item>
          </layout>
         </item>
+        <item>
+         <widget class="QPushButton" name="pushButtonFormatConfigure" >
+          <property name="enabled" >
+           <bool>true</bool>
+          </property>
+          <property name="sizePolicy" >
+           <sizepolicy vsizetype="Fixed" hsizetype="Minimum" >
+            <horstretch>0</horstretch>
+            <verstretch>0</verstretch>
+           </sizepolicy>
+          </property>
+          <property name="text" >
+           <string>Configure</string>
+          </property>
+         </widget>
+        </item>
        </layout>
       </item>
       <item>
@@ -544,18 +472,9 @@
         <property name="spacing" >
          <number>6</number>
         </property>
-        <property name="leftMargin" >
+        <property name="margin" >
          <number>0</number>
         </property>
-        <property name="topMargin" >
-         <number>0</number>
-        </property>
-        <property name="rightMargin" >
-         <number>0</number>
-        </property>
-        <property name="bottomMargin" >
-         <number>0</number>
-        </property>
         <item>
          <widget class="QFrame" name="frame_video" >
           <property name="sizePolicy" >
@@ -592,7 +511,7 @@
           <property name="sizeType" >
            <enum>QSizePolicy::Expanding</enum>
           </property>
-          <property name="sizeHint" >
+          <property name="sizeHint" stdset="0" >
            <size>
             <width>0</width>
             <height>0</height>
@@ -609,35 +528,17 @@
       <property name="spacing" >
        <number>6</number>
       </property>
-      <property name="leftMargin" >
+      <property name="margin" >
        <number>0</number>
       </property>
-      <property name="topMargin" >
-       <number>0</number>
-      </property>
-      <property name="rightMargin" >
-       <number>0</number>
-      </property>
-      <property name="bottomMargin" >
-       <number>0</number>
-      </property>
       <item>
        <layout class="QVBoxLayout" >
         <property name="spacing" >
          <number>6</number>
         </property>
-        <property name="leftMargin" >
+        <property name="margin" >
          <number>0</number>
         </property>
-        <property name="topMargin" >
-         <number>0</number>
-        </property>
-        <property name="rightMargin" >
-         <number>0</number>
-        </property>
-        <property name="bottomMargin" >
-         <number>0</number>
-        </property>
         <item>
          <spacer>
           <property name="orientation" >
@@ -646,7 +547,7 @@
           <property name="sizeType" >
            <enum>QSizePolicy::Expanding</enum>
           </property>
-          <property name="sizeHint" >
+          <property name="sizeHint" stdset="0" >
            <size>
             <width>0</width>
             <height>0</height>
@@ -672,25 +573,17 @@
           <property name="spacing" >
            <number>6</number>
           </property>
-          <property name="leftMargin" >
+          <property name="margin" >
            <number>0</number>
           </property>
-          <property name="topMargin" >
-           <number>0</number>
-          </property>
-          <property name="rightMargin" >
-           <number>0</number>
-          </property>
-          <property name="bottomMargin" >
-           <number>0</number>
-          </property>
           <item>
            <widget class="QToolButton" name="toolButtonPlay" >
             <property name="text" >
              <string>...</string>
             </property>
             <property name="icon" >
-             <iconset resource="avidemux.qrc" >:/new/prefix1/pics/player_play.png</iconset>
+             <iconset resource="avidemux.qrc" >
+              <normaloff>:/new/prefix1/pics/player_play.png</normaloff>:/new/prefix1/pics/player_play.png</iconset>
             </property>
             <property name="iconSize" >
              <size>
@@ -709,7 +602,8 @@
              <string>...</string>
             </property>
             <property name="icon" >
-             <iconset resource="avidemux.qrc" >:/new/prefix1/pics/player_stop.png</iconset>
+             <iconset resource="avidemux.qrc" >
+              <normaloff>:/new/prefix1/pics/player_stop.png</normaloff>:/new/prefix1/pics/player_stop.png</iconset>
             </property>
             <property name="iconSize" >
              <size>
@@ -728,7 +622,8 @@
              <string>...</string>
             </property>
             <property name="icon" >
-             <iconset resource="avidemux.qrc" >:/new/prefix1/pics/back.png</iconset>
+             <iconset resource="avidemux.qrc" >
+              <normaloff>:/new/prefix1/pics/back.png</normaloff>:/new/prefix1/pics/back.png</iconset>
             </property>
             <property name="iconSize" >
              <size>
@@ -747,7 +642,8 @@
              <string>...</string>
             </property>
             <property name="icon" >
-             <iconset resource="avidemux.qrc" >:/new/prefix1/pics/forward.png</iconset>
+             <iconset resource="avidemux.qrc" >
+              <normaloff>:/new/prefix1/pics/forward.png</normaloff>:/new/prefix1/pics/forward.png</iconset>
             </property>
             <property name="iconSize" >
              <size>
@@ -766,7 +662,8 @@
              <string>...</string>
             </property>
             <property name="icon" >
-             <iconset resource="avidemux.qrc" >:/new/prefix1/pics/player_rew.png</iconset>
+             <iconset resource="avidemux.qrc" >
+              <normaloff>:/new/prefix1/pics/player_rew.png</normaloff>:/new/prefix1/pics/player_rew.png</iconset>
             </property>
             <property name="iconSize" >
              <size>
@@ -785,7 +682,8 @@
              <string>...</string>
             </property>
             <property name="icon" >
-             <iconset resource="avidemux.qrc" >:/new/prefix1/pics/player_fwd.png</iconset>
+             <iconset resource="avidemux.qrc" >
+              <normaloff>:/new/prefix1/pics/player_fwd.png</normaloff>:/new/prefix1/pics/player_fwd.png</iconset>
             </property>
             <property name="iconSize" >
              <size>
@@ -804,7 +702,8 @@
              <string>...</string>
             </property>
             <property name="icon" >
-             <iconset resource="avidemux.qrc" >:/new/prefix1/pics/markA.png</iconset>
+             <iconset resource="avidemux.qrc" >
+              <normaloff>:/new/prefix1/pics/markA.png</normaloff>:/new/prefix1/pics/markA.png</iconset>
             </property>
             <property name="iconSize" >
              <size>
@@ -823,7 +722,8 @@
              <string>...</string>
             </property>
             <property name="icon" >
-             <iconset resource="avidemux.qrc" >:/new/prefix1/pics/markB.png</iconset>
+             <iconset resource="avidemux.qrc" >
+              <normaloff>:/new/prefix1/pics/markB.png</normaloff>:/new/prefix1/pics/markB.png</iconset>
             </property>
             <property name="iconSize" >
              <size>
@@ -842,7 +742,8 @@
              <string>...</string>
             </property>
             <property name="icon" >
-             <iconset resource="avidemux.qrc" >:/new/prefix1/pics/prev_black.png</iconset>
+             <iconset resource="avidemux.qrc" >
+              <normaloff>:/new/prefix1/pics/prev_black.png</normaloff>:/new/prefix1/pics/prev_black.png</iconset>
             </property>
             <property name="iconSize" >
              <size>
@@ -861,7 +762,8 @@
              <string>...</string>
             </property>
             <property name="icon" >
-             <iconset resource="avidemux.qrc" >:/new/prefix1/pics/next_black.png</iconset>
+             <iconset resource="avidemux.qrc" >
+              <normaloff>:/new/prefix1/pics/next_black.png</normaloff>:/new/prefix1/pics/next_black.png</iconset>
             </property>
             <property name="iconSize" >
              <size>
@@ -880,7 +782,8 @@
              <string>...</string>
             </property>
             <property name="icon" >
-             <iconset resource="avidemux.qrc" >:/new/prefix1/pics/player_start.png</iconset>
+             <iconset resource="avidemux.qrc" >
+              <normaloff>:/new/prefix1/pics/player_start.png</normaloff>:/new/prefix1/pics/player_start.png</iconset>
             </property>
             <property name="iconSize" >
              <size>
@@ -899,7 +802,8 @@
              <string>...</string>
             </property>
             <property name="icon" >
-             <iconset resource="avidemux.qrc" >:/new/prefix1/pics/player_end.png</iconset>
+             <iconset resource="avidemux.qrc" >
+              <normaloff>:/new/prefix1/pics/player_end.png</normaloff>:/new/prefix1/pics/player_end.png</iconset>
             </property>
             <property name="iconSize" >
              <size>
@@ -917,7 +821,7 @@
             <property name="orientation" >
              <enum>Qt::Horizontal</enum>
             </property>
-            <property name="sizeHint" >
+            <property name="sizeHint" stdset="0" >
              <size>
               <width>20</width>
               <height>20</height>
@@ -932,18 +836,9 @@
           <property name="spacing" >
            <number>6</number>
           </property>
-          <property name="leftMargin" >
+          <property name="margin" >
            <number>0</number>
           </property>
-          <property name="topMargin" >
-           <number>0</number>
-          </property>
-          <property name="rightMargin" >
-           <number>0</number>
-          </property>
-          <property name="bottomMargin" >
-           <number>0</number>
-          </property>
           <item>
            <widget class="QLabel" name="label" >
             <property name="sizePolicy" >
@@ -1023,7 +918,7 @@
             <property name="sizeType" >
              <enum>QSizePolicy::Fixed</enum>
             </property>
-            <property name="sizeHint" >
+            <property name="sizeHint" stdset="0" >
              <size>
               <width>20</width>
               <height>20</height>
@@ -1098,7 +993,7 @@
             <property name="sizeType" >
              <enum>QSizePolicy::Fixed</enum>
             </property>
-            <property name="sizeHint" >
+            <property name="sizeHint" stdset="0" >
              <size>
               <width>20</width>
               <height>20</height>
@@ -1142,7 +1037,7 @@
             <property name="orientation" >
              <enum>Qt::Horizontal</enum>
             </property>
-            <property name="sizeHint" >
+            <property name="sizeHint" stdset="0" >
              <size>
               <width>60</width>
               <height>20</height>
@@ -1162,7 +1057,7 @@
         <property name="sizeType" >
          <enum>QSizePolicy::Fixed</enum>
         </property>
-        <property name="sizeHint" >
+        <property name="sizeHint" stdset="0" >
          <size>
           <width>14</width>
           <height>95</height>
@@ -1175,18 +1070,9 @@
         <property name="spacing" >
          <number>6</number>
         </property>
-        <property name="leftMargin" >
+        <property name="margin" >
          <number>0</number>
         </property>
-        <property name="topMargin" >
-         <number>0</number>
-        </property>
-        <property name="rightMargin" >
-         <number>0</number>
-        </property>
-        <property name="bottomMargin" >
-         <number>0</number>
-        </property>
         <item>
          <spacer>
           <property name="orientation" >
@@ -1195,7 +1081,7 @@
           <property name="sizeType" >
            <enum>QSizePolicy::Expanding</enum>
           </property>
-          <property name="sizeHint" >
+          <property name="sizeHint" stdset="0" >
            <size>
             <width>0</width>
             <height>0</height>
@@ -1357,7 +1243,7 @@
         <property name="sizeType" >
          <enum>QSizePolicy::Fixed</enum>
         </property>
-        <property name="sizeHint" >
+        <property name="sizeHint" stdset="0" >
          <size>
           <width>14</width>
           <height>95</height>
@@ -1370,18 +1256,9 @@
         <property name="spacing" >
          <number>4</number>
         </property>
-        <property name="leftMargin" >
+        <property name="margin" >
          <number>0</number>
         </property>
-        <property name="topMargin" >
-         <number>0</number>
-        </property>
-        <property name="rightMargin" >
-         <number>0</number>
-        </property>
-        <property name="bottomMargin" >
-         <number>0</number>
-        </property>
         <item>
          <spacer>
           <property name="orientation" >
@@ -1390,7 +1267,7 @@
           <property name="sizeType" >
            <enum>QSizePolicy::Expanding</enum>
           </property>
-          <property name="sizeHint" >
+          <property name="sizeHint" stdset="0" >
            <size>
             <width>0</width>
             <height>0</height>
@@ -1407,7 +1284,8 @@
            <string>...</string>
           </property>
           <property name="icon" >
-           <iconset resource="avidemux.qrc" >:/new/prefix1/pics/arts.png</iconset>
+           <iconset resource="avidemux.qrc" >
+            <normaloff>:/new/prefix1/pics/arts.png</normaloff>:/new/prefix1/pics/arts.png</iconset>
           </property>
           <property name="checkable" >
            <bool>true</bool>
@@ -1454,7 +1332,7 @@
      <x>0</x>
      <y>0</y>
      <width>838</width>
-     <height>22</height>
+     <height>25</height>
     </rect>
    </property>
    <widget class="QMenu" name="menuHelp" >
@@ -1462,6 +1340,7 @@
      <string>&amp;Help</string>
     </property>
     <addaction name="actionShow_built_in_support" />
+    <addaction name="actionPlugins" />
     <addaction name="actionAbout_avidemux" />
    </widget>
    <widget class="QMenu" name="menuVideo" >
@@ -1665,7 +1544,8 @@
   </widget>
   <action name="actionOpen" >
    <property name="icon" >
-    <iconset resource="avidemux.qrc" >:/new/prefix1/pics/fileopen.png</iconset>
+    <iconset resource="avidemux.qrc" >
+     <normaloff>:/new/prefix1/pics/fileopen.png</normaloff>:/new/prefix1/pics/fileopen.png</iconset>
    </property>
    <property name="text" >
     <string>&amp;Open...</string>
@@ -1721,7 +1601,8 @@
   </action>
   <action name="actionSet_marker_A" >
    <property name="icon" >
-    <iconset resource="avidemux.qrc" >:/new/prefix1/pics/markA.png</iconset>
+    <iconset resource="avidemux.qrc" >
+     <normaloff>:/new/prefix1/pics/markA.png</normaloff>:/new/prefix1/pics/markA.png</iconset>
    </property>
    <property name="text" >
     <string>Set Marker A</string>
@@ -1738,7 +1619,8 @@
   </action>
   <action name="actionSet_marker_B" >
    <property name="icon" >
-    <iconset resource="avidemux.qrc" >:/new/prefix1/pics/markB.png</iconset>
+    <iconset resource="avidemux.qrc" >
+     <normaloff>:/new/prefix1/pics/markB.png</normaloff>:/new/prefix1/pics/markB.png</iconset>
    </property>
    <property name="text" >
     <string>Set Marker B</string>
@@ -1760,7 +1642,8 @@
   </action>
   <action name="actionProperties" >
    <property name="icon" >
-    <iconset resource="avidemux.qrc" >:/new/prefix1/pics/info.png</iconset>
+    <iconset resource="avidemux.qrc" >
+     <normaloff>:/new/prefix1/pics/info.png</normaloff>:/new/prefix1/pics/info.png</iconset>
    </property>
    <property name="text" >
     <string>&amp;Information...</string>
@@ -1771,7 +1654,8 @@
   </action>
   <action name="actionSave_video" >
    <property name="icon" >
-    <iconset resource="avidemux.qrc" >:/new/prefix1/pics/filesave.png</iconset>
+    <iconset resource="avidemux.qrc" >
+     <normaloff>:/new/prefix1/pics/filesave.png</normaloff>:/new/prefix1/pics/filesave.png</iconset>
    </property>
    <property name="text" >
     <string>Save &amp;Video...</string>
@@ -1810,7 +1694,8 @@
   </action>
   <action name="actionLoad_run_project" >
    <property name="icon" >
-    <iconset resource="avidemux.qrc" >:/new/prefix1/pics/project_open.png</iconset>
+    <iconset resource="avidemux.qrc" >
+     <normaloff>:/new/prefix1/pics/project_open.png</normaloff>:/new/prefix1/pics/project_open.png</iconset>
    </property>
    <property name="text" >
     <string>&amp;Load/Run Project...</string>
@@ -1824,7 +1709,8 @@
   </action>
   <action name="actionSave_project" >
    <property name="icon" >
-    <iconset resource="avidemux.qrc" >:/new/prefix1/pics/filesave.png</iconset>
+    <iconset resource="avidemux.qrc" >
+     <normaloff>:/new/prefix1/pics/filesave.png</normaloff>:/new/prefix1/pics/filesave.png</iconset>
    </property>
    <property name="text" >
     <string>Save &amp;Project</string>
@@ -1838,7 +1724,8 @@
   </action>
   <action name="actionSave_project_as" >
    <property name="icon" >
-    <iconset resource="avidemux.qrc" >:/new/prefix1/pics/filesaveas.png</iconset>
+    <iconset resource="avidemux.qrc" >
+     <normaloff>:/new/prefix1/pics/filesaveas.png</normaloff>:/new/prefix1/pics/filesaveas.png</iconset>
    </property>
    <property name="text" >
     <string>Save P&amp;roject As...</string>
@@ -2008,7 +1895,8 @@
   </action>
   <action name="actionCalculator" >
    <property name="icon" >
-    <iconset resource="avidemux.qrc" >:/new/prefix1/pics/calc.png</iconset>
+    <iconset resource="avidemux.qrc" >
+     <normaloff>:/new/prefix1/pics/calc.png</normaloff>:/new/prefix1/pics/calc.png</iconset>
    </property>
    <property name="text" >
     <string>&amp;Calculator...</string>
@@ -2074,7 +1962,8 @@
   </action>
   <action name="actionPlay_Stop" >
    <property name="icon" >
-    <iconset resource="avidemux.qrc" >:/new/prefix1/pics/player_stop.png</iconset>
+    <iconset resource="avidemux.qrc" >
+     <normaloff>:/new/prefix1/pics/player_stop.png</normaloff>:/new/prefix1/pics/player_stop.png</iconset>
    </property>
    <property name="text" >
     <string>Stop</string>
@@ -2091,7 +1980,8 @@
   </action>
   <action name="actionPrevious_Frame" >
    <property name="icon" >
-    <iconset resource="avidemux.qrc" >:/new/prefix1/pics/back.png</iconset>
+    <iconset resource="avidemux.qrc" >
+     <normaloff>:/new/prefix1/pics/back.png</normaloff>:/new/prefix1/pics/back.png</iconset>
    </property>
    <property name="text" >
     <string>P&amp;revious Frame</string>
@@ -2102,7 +1992,8 @@
   </action>
   <action name="actionNext_Frame" >
    <property name="icon" >
-    <iconset resource="avidemux.qrc" >:/new/prefix1/pics/forward.png</iconset>
+    <iconset resource="avidemux.qrc" >
+     <normaloff>:/new/prefix1/pics/forward.png</normaloff>:/new/prefix1/pics/forward.png</iconset>
    </property>
    <property name="text" >
     <string>&amp;Next Frame</string>
@@ -2113,7 +2004,8 @@
   </action>
   <action name="actionPrevious_intra_frame" >
    <property name="icon" >
-    <iconset resource="avidemux.qrc" >:/new/prefix1/pics/player_rew.png</iconset>
+    <iconset resource="avidemux.qrc" >
+     <normaloff>:/new/prefix1/pics/player_rew.png</normaloff>:/new/prefix1/pics/player_rew.png</iconset>
    </property>
    <property name="text" >
     <string>Pr&amp;evious Intra Frame</string>
@@ -2130,7 +2022,8 @@
   </action>
   <action name="actionNext_intra_frame" >
    <property name="icon" >
-    <iconset resource="avidemux.qrc" >:/new/prefix1/pics/player_fwd.png</iconset>
+    <iconset resource="avidemux.qrc" >
+     <normaloff>:/new/prefix1/pics/player_fwd.png</normaloff>:/new/prefix1/pics/player_fwd.png</iconset>
    </property>
    <property name="text" >
     <string>Next &amp;Intra Frame</string>
@@ -2147,7 +2040,8 @@
   </action>
   <action name="actionPrevious_black_frame" >
    <property name="icon" >
-    <iconset resource="avidemux.qrc" >:/new/prefix1/pics/prev_black.png</iconset>
+    <iconset resource="avidemux.qrc" >
+     <normaloff>:/new/prefix1/pics/prev_black.png</normaloff>:/new/prefix1/pics/prev_black.png</iconset>
    </property>
    <property name="text" >
     <string>Previou&amp;s Black Frame</string>
@@ -2161,7 +2055,8 @@
   </action>
   <action name="actionNext_blak_frame" >
    <property name="icon" >
-    <iconset resource="avidemux.qrc" >:/new/prefix1/pics/next_black.png</iconset>
+    <iconset resource="avidemux.qrc" >
+     <normaloff>:/new/prefix1/pics/next_black.png</normaloff>:/new/prefix1/pics/next_black.png</iconset>
    </property>
    <property name="text" >
     <string>Ne&amp;xt Black Frame</string>
@@ -2175,7 +2070,8 @@
   </action>
   <action name="actionFirst_Frame" >
    <property name="icon" >
-    <iconset resource="avidemux.qrc" >:/new/prefix1/pics/player_start.png</iconset>
+    <iconset resource="avidemux.qrc" >
+     <normaloff>:/new/prefix1/pics/player_start.png</normaloff>:/new/prefix1/pics/player_start.png</iconset>
    </property>
    <property name="text" >
     <string>&amp;First Frame</string>
@@ -2186,7 +2082,8 @@
   </action>
   <action name="actionLast_Frame" >
    <property name="icon" >
-    <iconset resource="avidemux.qrc" >:/new/prefix1/pics/player_end.png</iconset>
+    <iconset resource="avidemux.qrc" >
+     <normaloff>:/new/prefix1/pics/player_end.png</normaloff>:/new/prefix1/pics/player_end.png</iconset>
    </property>
    <property name="text" >
     <string>&amp;Last Frame</string>
@@ -2197,7 +2094,8 @@
   </action>
   <action name="actionGo_to_Marker_A" >
    <property name="icon" >
-    <iconset resource="avidemux.qrc" >:/new/prefix1/pics/gotoA.png</iconset>
+    <iconset resource="avidemux.qrc" >
+     <normaloff>:/new/prefix1/pics/gotoA.png</normaloff>:/new/prefix1/pics/gotoA.png</iconset>
    </property>
    <property name="text" >
     <string>Jump to Marker &amp;A</string>
@@ -2214,7 +2112,8 @@
   </action>
   <action name="actionGo_to_Marker_B" >
    <property name="icon" >
-    <iconset resource="avidemux.qrc" >:/new/prefix1/pics/gotoB.png</iconset>
+    <iconset resource="avidemux.qrc" >
+     <normaloff>:/new/prefix1/pics/gotoB.png</normaloff>:/new/prefix1/pics/gotoB.png</iconset>
    </property>
    <property name="text" >
     <string>Jump to Marker &amp;B</string>
@@ -2269,7 +2168,8 @@
   </action>
   <action name="actionPlay" >
    <property name="icon" >
-    <iconset resource="avidemux.qrc" >:/new/prefix1/pics/player_play.png</iconset>
+    <iconset resource="avidemux.qrc" >
+     <normaloff>:/new/prefix1/pics/player_play.png</normaloff>:/new/prefix1/pics/player_play.png</iconset>
    </property>
    <property name="text" >
     <string>&amp;Play/Stop</string>
@@ -2411,7 +2311,8 @@
     <bool>true</bool>
    </property>
    <property name="icon" >
-    <iconset resource="avidemux.qrc" >:/new/prefix1/pics/preview_input.png</iconset>
+    <iconset resource="avidemux.qrc" >
+     <normaloff>:/new/prefix1/pics/preview_input.png</normaloff>:/new/prefix1/pics/preview_input.png</iconset>
    </property>
    <property name="text" >
     <string>&amp;Input</string>
@@ -2422,7 +2323,8 @@
     <bool>true</bool>
    </property>
    <property name="icon" >
-    <iconset resource="avidemux.qrc" >:/new/prefix1/pics/preview_output.png</iconset>
+    <iconset resource="avidemux.qrc" >
+     <normaloff>:/new/prefix1/pics/preview_output.png</normaloff>:/new/prefix1/pics/preview_output.png</iconset>
    </property>
    <property name="text" >
     <string>&amp;Output</string>
@@ -2433,7 +2335,8 @@
     <bool>true</bool>
    </property>
    <property name="icon" >
-    <iconset resource="avidemux.qrc" >:/new/prefix1/pics/preview_side.png</iconset>
+    <iconset resource="avidemux.qrc" >
+     <normaloff>:/new/prefix1/pics/preview_side.png</normaloff>:/new/prefix1/pics/preview_side.png</iconset>
    </property>
    <property name="text" >
     <string>Si&amp;de</string>
@@ -2444,7 +2347,8 @@
     <bool>true</bool>
    </property>
    <property name="icon" >
-    <iconset resource="avidemux.qrc" >:/new/prefix1/pics/preview_top.png</iconset>
+    <iconset resource="avidemux.qrc" >
+     <normaloff>:/new/prefix1/pics/preview_top.png</normaloff>:/new/prefix1/pics/preview_top.png</iconset>
    </property>
    <property name="text" >
     <string>&amp;Top</string>
@@ -2455,7 +2359,8 @@
     <bool>true</bool>
    </property>
    <property name="icon" >
-    <iconset resource="avidemux.qrc" >:/new/prefix1/pics/preview_separate.png</iconset>
+    <iconset resource="avidemux.qrc" >
+     <normaloff>:/new/prefix1/pics/preview_separate.png</normaloff>:/new/prefix1/pics/preview_separate.png</iconset>
    </property>
    <property name="text" >
     <string>&amp;Separate</string>
@@ -2504,6 +2409,11 @@
     <string>Ctrl+W</string>
    </property>
   </action>
+  <action name="actionPlugins" >
+   <property name="text" >
+    <string>Plugins</string>
+   </property>
+  </action>
  </widget>
  <customwidgets>
   <customwidget>

Modified: branches/avidemux_2.6_branch_mean/avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/translation_table.h
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/translation_table.h	2009-02-04 19:10:17 UTC (rev 4568)
+++ branches/avidemux_2.6_branch_mean/avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/translation_table.h	2009-02-05 06:50:35 UTC (rev 4569)
@@ -68,7 +68,8 @@
 PROCESS(actionPSP_H264,ACT_AUTO_PSP_H264)\
 PROCESS(actionIPOD,ACT_AUTO_IPOD) \
 PROCESS(actionAdd_to_joblist,ACT_ADD_JOB) \
-PROCESS(actionShow_Joblist,ACT_HANDLE_JOB)  
+PROCESS(actionShow_Joblist,ACT_HANDLE_JOB)  \
+PROCESS(actionPlugins,ACT_PLUGIN_INFO)  
 
 #if 0
 PROCESS(actionPrevious_intra_frame,ACT_PreviousKFrame) \
@@ -80,6 +81,7 @@
 #define LIST_OF_BUTTONS     PROCESS(pushButtonVideoConf, ACT_VideoCodec)  \
 PROCESS(pushButtonVideoFilter, ACT_VideoParameter) \
 PROCESS(pushButtonAudioConf, ACT_AudioCodec) \
+PROCESS(pushButtonFormatConfigure, ACT_SetMuxParam) \
 PROCESS(pushButtonAudioFilter, ACT_AudioFilters) \
 PROCESS(toolButtonPlay, ACT_PlayAvi) \
 PROCESS(toolButtonStop, ACT_StopAvi) \



From mean at mail.berlios.de  Thu Feb  5 19:30:45 2009
From: mean at mail.berlios.de (mean at BerliOS)
Date: Thu, 5 Feb 2009 19:30:45 +0100
Subject: [Avidemux-svn-commit] r4570 - in
	branches/avidemux_2.6_branch_mean/avidemux/ADM_userInterfaces/ADM_GTK:
	ADM_gui2 glade/main
Message-ID: <200902051830.n15IUjk0019512@sheep.berlios.de>

Author: mean
Date: 2009-02-05 19:30:43 +0100 (Thu, 05 Feb 2009)
New Revision: 4570

Modified:
   branches/avidemux_2.6_branch_mean/avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_bindings.cpp
   branches/avidemux_2.6_branch_mean/avidemux/ADM_userInterfaces/ADM_GTK/glade/main/gtk2_build.glade
Log:
[Gtk] Fix output format dialog

Modified: branches/avidemux_2.6_branch_mean/avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_bindings.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_bindings.cpp	2009-02-05 06:50:35 UTC (rev 4569)
+++ branches/avidemux_2.6_branch_mean/avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_bindings.cpp	2009-02-05 18:30:43 UTC (rev 4570)
@@ -184,8 +184,9 @@
 
 	{"buttonFilters"		,"clicked"		,ACT_VideoParameter},
 	{"buttonAudioFilter"	,"clicked"		,ACT_AudioFilters},
-	{"buttonConfV"			,"clicked"		,ACT_VideoCodec},
+	{"buttonConfV"			,"clicked"		,ACT_SetMuxParam},
 	{"buttonConfA"			,"clicked"		,ACT_AudioCodec},
+	{"buttonConfF"			,"clicked"		,ACT_SetMuxParam},
 
 	{"buttonPrevBlack"		,"clicked"		,ACT_PrevBlackFrame},
 	{"buttonNextBlack"		,"clicked"		,ACT_NextBlackFrame},

Modified: branches/avidemux_2.6_branch_mean/avidemux/ADM_userInterfaces/ADM_GTK/glade/main/gtk2_build.glade
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/ADM_userInterfaces/ADM_GTK/glade/main/gtk2_build.glade	2009-02-05 06:50:35 UTC (rev 4569)
+++ branches/avidemux_2.6_branch_mean/avidemux/ADM_userInterfaces/ADM_GTK/glade/main/gtk2_build.glade	2009-02-05 18:30:43 UTC (rev 4570)
@@ -1,2642 +1,1949 @@
-<?xml version="1.0" standalone="no"?> <!--*- mode: xml -*-->
-<!DOCTYPE glade-interface SYSTEM "http://glade.gnome.org/glade-2.0.dtd">
-
+<?xml version="1.0" encoding="UTF-8" standalone="no"?>
+<!DOCTYPE glade-interface SYSTEM "glade-2.0.dtd">
+<!--*- mode: xml -*-->
 <glade-interface>
-
-<widget class="GtkWindow" id="mainWindow">
-  <property name="visible">True</property>
-  <property name="title" translatable="yes">Avidemux</property>
-  <property name="type">GTK_WINDOW_TOPLEVEL</property>
-  <property name="window_position">GTK_WIN_POS_NONE</property>
-  <property name="modal">False</property>
-  <property name="resizable">True</property>
-  <property name="destroy_with_parent">False</property>
-  <property name="icon">avidemux_icon_small.png</property>
-  <property name="decorated">True</property>
-  <property name="skip_taskbar_hint">False</property>
-  <property name="skip_pager_hint">False</property>
-  <property name="type_hint">GDK_WINDOW_TYPE_HINT_NORMAL</property>
-  <property name="gravity">GDK_GRAVITY_NORTH_WEST</property>
-  <property name="focus_on_map">True</property>
-  <property name="urgency_hint">False</property>
-
-  <child>
-    <widget class="GtkVBox" id="vbox1">
-      <property name="visible">True</property>
-      <property name="homogeneous">False</property>
-      <property name="spacing">0</property>
-
-      <child>
-	<widget class="GtkMenuBar" id="menuBar">
-	  <property name="visible">True</property>
-	  <property name="can_focus">True</property>
-	  <property name="pack_direction">GTK_PACK_DIRECTION_LTR</property>
-	  <property name="child_pack_direction">GTK_PACK_DIRECTION_LTR</property>
-
-	  <child>
-	    <widget class="GtkMenuItem" id="menuitem1">
-	      <property name="visible">True</property>
-	      <property name="label" translatable="yes">_File</property>
-	      <property name="use_underline">True</property>
-
-	      <child>
-		<widget class="GtkMenu" id="menuitem1_menu">
-
-		  <child>
-		    <widget class="GtkImageMenuItem" id="open_video1">
-		      <property name="visible">True</property>
-		      <property name="label" translatable="yes">_Open...</property>
-		      <property name="use_underline">True</property>
-		      <accelerator key="O" modifiers="GDK_CONTROL_MASK" signal="activate"/>
-
-		      <child internal-child="image">
-			<widget class="GtkImage" id="image8523">
-			  <property name="visible">True</property>
-			  <property name="stock">gtk-open</property>
-			  <property name="icon_size">1</property>
-			  <property name="xalign">0.5</property>
-			  <property name="yalign">0.5</property>
-			  <property name="xpad">0</property>
-			  <property name="ypad">0</property>
-			</widget>
-		      </child>
-		    </widget>
-		  </child>
-
-		  <child>
-		    <widget class="GtkImageMenuItem" id="append_video1">
-		      <property name="visible">True</property>
-		      <property name="label" translatable="yes">_Append...</property>
-		      <property name="use_underline">True</property>
-		      <accelerator key="A" modifiers="GDK_CONTROL_MASK | GDK_MOD1_MASK" signal="activate"/>
-
-		      <child internal-child="image">
-			<widget class="GtkImage" id="image8524">
-			  <property name="visible">True</property>
-			  <property name="stock">gtk-add</property>
-			  <property name="icon_size">1</property>
-			  <property name="xalign">0.5</property>
-			  <property name="yalign">0.5</property>
-			  <property name="xpad">0</property>
-			  <property name="ypad">0</property>
-			</widget>
-		      </child>
-		    </widget>
-		  </child>
-
-		  <child>
-		    <widget class="GtkImageMenuItem" id="save_stuff">
-		      <property name="visible">True</property>
-		      <property name="label" translatable="yes">_Save</property>
-		      <property name="use_underline">True</property>
-
-		      <child internal-child="image">
-			<widget class="GtkImage" id="image8525">
-			  <property name="visible">True</property>
-			  <property name="stock">gtk-save</property>
-			  <property name="icon_size">1</property>
-			  <property name="xalign">0.5</property>
-			  <property name="yalign">0.5</property>
-			  <property name="xpad">0</property>
-			  <property name="ypad">0</property>
-			</widget>
-		      </child>
-
-		      <child>
-			<widget class="GtkMenu" id="save_stuff_menu">
-
-			  <child>
-			    <widget class="GtkMenuItem" id="save_as_avi1">
-			      <property name="visible">True</property>
-			      <property name="label" translatable="yes">Save _Video...</property>
-			      <property name="use_underline">True</property>
-			      <accelerator key="S" modifiers="GDK_CONTROL_MASK" signal="activate"/>
-			    </widget>
-			  </child>
-
-			  <child>
-			    <widget class="GtkSeparatorMenuItem" id="separator1">
-			      <property name="visible">True</property>
-			    </widget>
-			  </child>
-
-			  <child>
-			    <widget class="GtkMenuItem" id="save_image1">
-			      <property name="visible">True</property>
-			      <property name="label" translatable="yes">Save _BMP Image...</property>
-			      <property name="use_underline">True</property>
-			    </widget>
-			  </child>
-
-			  <child>
-			    <widget class="GtkMenuItem" id="save_jpg_image1">
-			      <property name="visible">True</property>
-			      <property name="label" translatable="yes">Save _JPEG Image...</property>
-			      <property name="use_underline">True</property>
-			    </widget>
-			  </child>
-
-			  <child>
-			    <widget class="GtkMenuItem" id="save_selection_as_jpegs1">
-			      <property name="visible">True</property>
-			      <property name="label" translatable="yes">Save _Selection as JPEG Images...</property>
-			      <property name="use_underline">True</property>
-			    </widget>
-			  </child>
-			</widget>
-		      </child>
-		    </widget>
-		  </child>
-
-		  <child>
-		    <widget class="GtkImageMenuItem" id="close1">
-		      <property name="visible">True</property>
-		      <property name="label">gtk-close</property>
-		      <property name="use_stock">True</property>
-		    </widget>
-		  </child>
-
-		  <child>
-		    <widget class="GtkSeparatorMenuItem" id="separator3">
-		      <property name="visible">True</property>
-		    </widget>
-		  </child>
-
-		  <child>
-		    <widget class="GtkImageMenuItem" id="save_project1">
-		      <property name="visible">True</property>
-		      <property name="label" translatable="yes">Save _Project</property>
-		      <property name="use_underline">True</property>
-
-		      <child internal-child="image">
-			<widget class="GtkImage" id="image8526">
-			  <property name="visible">True</property>
-			  <property name="stock">gtk-save</property>
-			  <property name="icon_size">1</property>
-			  <property name="xalign">0.5</property>
-			  <property name="yalign">0.5</property>
-			  <property name="xpad">0</property>
-			  <property name="ypad">0</property>
-			</widget>
-		      </child>
-		    </widget>
-		  </child>
-
-		  <child>
-		    <widget class="GtkImageMenuItem" id="save_project_as1">
-		      <property name="visible">True</property>
-		      <property name="label" translatable="yes">Save P_roject As...</property>
-		      <property name="use_underline">True</property>
-
-		      <child internal-child="image">
-			<widget class="GtkImage" id="image8527">
-			  <property name="visible">True</property>
-			  <property name="stock">gtk-save-as</property>
-			  <property name="icon_size">1</property>
-			  <property name="xalign">0.5</property>
-			  <property name="yalign">0.5</property>
-			  <property name="xpad">0</property>
-			  <property name="ypad">0</property>
-			</widget>
-		      </child>
-		    </widget>
-		  </child>
-
-		  <child>
-		    <widget class="GtkImageMenuItem" id="run_script1">
-		      <property name="visible">True</property>
-		      <property name="label" translatable="yes">_Load/Run Project...</property>
-		      <property name="use_underline">True</property>
-
-		      <child internal-child="image">
-			<widget class="GtkImage" id="image8528">
-			  <property name="visible">True</property>
-			  <property name="stock">gtk-execute</property>
-			  <property name="icon_size">1</property>
-			  <property name="xalign">0.5</property>
-			  <property name="yalign">0.5</property>
-			  <property name="xpad">0</property>
-			  <property name="ypad">0</property>
-			</widget>
-		      </child>
-		    </widget>
-		  </child>
-
-		  <child>
-		    <widget class="GtkMenuItem" id="add_to_joblist1">
-		      <property name="visible">True</property>
-		      <property name="label" translatable="yes">A_dd to Joblist...</property>
-		      <property name="use_underline">True</property>
-		    </widget>
-		  </child>
-
-		  <child>
-		    <widget class="GtkMenuItem" id="joblist1">
-		      <property name="visible">True</property>
-		      <property name="label" translatable="yes">Show _Joblist</property>
-		      <property name="use_underline">True</property>
-		      <accelerator key="J" modifiers="GDK_CONTROL_MASK" signal="activate"/>
-		    </widget>
-		  </child>
-
-		  <child>
-		    <widget class="GtkSeparatorMenuItem" id="separator16">
-		      <property name="visible">True</property>
-		    </widget>
-		  </child>
-
-		  <child>
-		    <widget class="GtkMenuItem" id="connect_to_avsproxy1">
-		      <property name="visible">True</property>
-		      <property name="label" translatable="yes">Co_nnect to avsproxy</property>
-		      <property name="use_underline">True</property>
-		    </widget>
-		  </child>
-
-		  <child>
-		    <widget class="GtkSeparatorMenuItem" id="separator18">
-		      <property name="visible">True</property>
-		    </widget>
-		  </child>
-
-		  <child>
-		    <widget class="GtkImageMenuItem" id="video_informations1">
-		      <property name="visible">True</property>
-		      <property name="label" translatable="yes">Proper_ties</property>
-		      <property name="use_underline">True</property>
-		      <accelerator key="Return" modifiers="GDK_MOD1_MASK" signal="activate"/>
-
-		      <child internal-child="image">
-			<widget class="GtkImage" id="image8529">
-			  <property name="visible">True</property>
-			  <property name="stock">gtk-properties</property>
-			  <property name="icon_size">1</property>
-			  <property name="xalign">0.5</property>
-			  <property name="yalign">0.5</property>
-			  <property name="xpad">0</property>
-			  <property name="ypad">0</property>
-			</widget>
-		      </child>
-		    </widget>
-		  </child>
-
-		  <child>
-		    <widget class="GtkMenuItem" id="avi_muxer_options1">
-		      <property name="visible">True</property>
-		      <property name="label" translatable="yes">AVI _Muxer Options</property>
-		      <property name="use_underline">True</property>
-		    </widget>
-		  </child>
-
-		  <child>
-		    <widget class="GtkSeparatorMenuItem" id="separator4">
-		      <property name="visible">True</property>
-		    </widget>
-		  </child>
-
-		  <child>
-		    <widget class="GtkImageMenuItem" id="quit1">
-		      <property name="visible">True</property>
-		      <property name="label" translatable="yes">_Quit</property>
-		      <property name="use_underline">True</property>
-		      <accelerator key="Q" modifiers="GDK_CONTROL_MASK" signal="activate"/>
-
-		      <child internal-child="image">
-			<widget class="GtkImage" id="image8530">
-			  <property name="visible">True</property>
-			  <property name="stock">gtk-quit</property>
-			  <property name="icon_size">1</property>
-			  <property name="xalign">0.5</property>
-			  <property name="yalign">0.5</property>
-			  <property name="xpad">0</property>
-			  <property name="ypad">0</property>
-			</widget>
-		      </child>
-		    </widget>
-		  </child>
-		</widget>
-	      </child>
-	    </widget>
-	  </child>
-
-	  <child>
-	    <widget class="GtkMenuItem" id="menuitem2">
-	      <property name="visible">True</property>
-	      <property name="label" translatable="yes">_Edit</property>
-	      <property name="use_underline">True</property>
-
-	      <child>
-		<widget class="GtkMenu" id="menuitem2_menu">
-
-		  <child>
-		    <widget class="GtkImageMenuItem" id="reset_edits1">
-		      <property name="visible">True</property>
-		      <property name="label" translatable="yes">_Reset Edits</property>
-		      <property name="use_underline">True</property>
-
-		      <child internal-child="image">
-			<widget class="GtkImage" id="image8531">
-			  <property name="visible">True</property>
-			  <property name="stock">gtk-undo</property>
-			  <property name="icon_size">1</property>
-			  <property name="xalign">0.5</property>
-			  <property name="yalign">0.5</property>
-			  <property name="xpad">0</property>
-			  <property name="ypad">0</property>
-			</widget>
-		      </child>
-		    </widget>
-		  </child>
-
-		  <child>
-		    <widget class="GtkSeparatorMenuItem" id="separator5">
-		      <property name="visible">True</property>
-		    </widget>
-		  </child>
-
-		  <child>
-		    <widget class="GtkImageMenuItem" id="cut1">
-		      <property name="visible">True</property>
-		      <property name="label" translatable="yes">Cu_t</property>
-		      <property name="use_underline">True</property>
-		      <accelerator key="X" modifiers="GDK_CONTROL_MASK" signal="activate"/>
-
-		      <child internal-child="image">
-			<widget class="GtkImage" id="image8532">
-			  <property name="visible">True</property>
-			  <property name="stock">gtk-cut</property>
-			  <property name="icon_size">1</property>
-			  <property name="xalign">0.5</property>
-			  <property name="yalign">0.5</property>
-			  <property name="xpad">0</property>
-			  <property name="ypad">0</property>
-			</widget>
-		      </child>
-		    </widget>
-		  </child>
-
-		  <child>
-		    <widget class="GtkImageMenuItem" id="copy1">
-		      <property name="visible">True</property>
-		      <property name="label" translatable="yes">_Copy</property>
-		      <property name="use_underline">True</property>
-		      <accelerator key="C" modifiers="GDK_CONTROL_MASK" signal="activate"/>
-
-		      <child internal-child="image">
-			<widget class="GtkImage" id="image8533">
-			  <property name="visible">True</property>
-			  <property name="stock">gtk-copy</property>
-			  <property name="icon_size">1</property>
-			  <property name="xalign">0.5</property>
-			  <property name="yalign">0.5</property>
-			  <property name="xpad">0</property>
-			  <property name="ypad">0</property>
-			</widget>
-		      </child>
-		    </widget>
-		  </child>
-
-		  <child>
-		    <widget class="GtkImageMenuItem" id="paste1">
-		      <property name="visible">True</property>
-		      <property name="label" translatable="yes">_Paste</property>
-		      <property name="use_underline">True</property>
-		      <accelerator key="V" modifiers="GDK_CONTROL_MASK" signal="activate"/>
-
-		      <child internal-child="image">
-			<widget class="GtkImage" id="image8534">
-			  <property name="visible">True</property>
-			  <property name="stock">gtk-paste</property>
-			  <property name="icon_size">1</property>
-			  <property name="xalign">0.5</property>
-			  <property name="yalign">0.5</property>
-			  <property name="xpad">0</property>
-			  <property name="ypad">0</property>
-			</widget>
-		      </child>
-		    </widget>
-		  </child>
-
-		  <child>
-		    <widget class="GtkImageMenuItem" id="delete1">
-		      <property name="visible">True</property>
-		      <property name="label" translatable="yes">_Delete</property>
-		      <property name="use_underline">True</property>
-		      <accelerator key="Delete" modifiers="0" signal="activate"/>
-
-		      <child internal-child="image">
-			<widget class="GtkImage" id="image8535">
-			  <property name="visible">True</property>
-			  <property name="stock">gtk-remove</property>
-			  <property name="icon_size">1</property>
-			  <property name="xalign">0.5</property>
-			  <property name="yalign">0.5</property>
-			  <property name="xpad">0</property>
-			  <property name="ypad">0</property>
-			</widget>
-		      </child>
-		    </widget>
-		  </child>
-
-		  <child>
-		    <widget class="GtkSeparatorMenuItem" id="separator6">
-		      <property name="visible">True</property>
-		    </widget>
-		  </child>
-
-		  <child>
-		    <widget class="GtkMenuItem" id="set_marker_a1">
-		      <property name="visible">True</property>
-		      <property name="label" translatable="yes">Set Marker _A</property>
-		      <property name="use_underline">True</property>
-		      <accelerator key="bracketleft" modifiers="0" signal="activate"/>
-		    </widget>
-		  </child>
-
-		  <child>
-		    <widget class="GtkMenuItem" id="set_marker_b1">
-		      <property name="visible">True</property>
-		      <property name="label" translatable="yes">Set Marker _B</property>
-		      <property name="use_underline">True</property>
-		      <accelerator key="bracketright" modifiers="0" signal="activate"/>
-		    </widget>
-		  </child>
-
-		  <child>
-		    <widget class="GtkSeparatorMenuItem" id="separator7">
-		      <property name="visible">True</property>
-		    </widget>
-		  </child>
-
-		  <child>
-		    <widget class="GtkImageMenuItem" id="preferences1">
-		      <property name="visible">True</property>
-		      <property name="label" translatable="yes">Pre_ferences</property>
-		      <property name="use_underline">True</property>
-
-		      <child internal-child="image">
-			<widget class="GtkImage" id="image8536">
-			  <property name="visible">True</property>
-			  <property name="stock">gtk-preferences</property>
-			  <property name="icon_size">1</property>
-			  <property name="xalign">0.5</property>
-			  <property name="yalign">0.5</property>
-			  <property name="xpad">0</property>
-			  <property name="ypad">0</property>
-			</widget>
-		      </child>
-		    </widget>
-		  </child>
-		</widget>
-	      </child>
-	    </widget>
-	  </child>
-
-	  <child>
-	    <widget class="GtkMenuItem" id="view1">
-	      <property name="visible">True</property>
-	      <property name="label" translatable="yes">_View</property>
-	      <property name="use_underline">True</property>
-
-	      <child>
-		<widget class="GtkMenu" id="view1_menu">
-
-		  <child>
-		    <widget class="GtkCheckMenuItem" id="toolbar1">
-		      <property name="visible">True</property>
-		      <property name="label" translatable="yes">_Main Toolbar</property>
-		      <property name="use_underline">True</property>
-		      <property name="active">True</property>
-		    </widget>
-		  </child>
-
-		  <child>
-		    <widget class="GtkCheckMenuItem" id="sidebar1">
-		      <property name="visible">True</property>
-		      <property name="label" translatable="yes">_A/V Sidebar</property>
-		      <property name="use_underline">True</property>
-		      <property name="active">True</property>
-		    </widget>
-		  </child>
-
-		  <child>
-		    <widget class="GtkSeparatorMenuItem" id="separator8">
-		      <property name="visible">True</property>
-		    </widget>
-		  </child>
-
-		  <child>
-		    <widget class="GtkMenuItem" id="zoom_1_4">
-		      <property name="visible">True</property>
-		      <property name="label" translatable="yes">_Zoom 1:4</property>
-		      <property name="use_underline">True</property>
-		      <accelerator key="4" modifiers="GDK_CONTROL_MASK | GDK_SHIFT_MASK" signal="activate"/>
-		    </widget>
-		  </child>
-
-		  <child>
-		    <widget class="GtkMenuItem" id="zoom_1_2">
-		      <property name="visible">True</property>
-		      <property name="label" translatable="yes">Z_oom 1:2</property>
-		      <property name="use_underline">True</property>
-		      <accelerator key="2" modifiers="GDK_CONTROL_MASK | GDK_SHIFT_MASK" signal="activate"/>
-		    </widget>
-		  </child>
-
-		  <child>
-		    <widget class="GtkMenuItem" id="zoom_1_1">
-		      <property name="visible">True</property>
-		      <property name="label" translatable="yes">Zoom _1:1</property>
-		      <property name="use_underline">True</property>
-		      <accelerator key="1" modifiers="GDK_CONTROL_MASK | GDK_MOD1_MASK" signal="activate"/>
-		    </widget>
-		  </child>
-
-		  <child>
-		    <widget class="GtkMenuItem" id="zoom_2_1">
-		      <property name="visible">True</property>
-		      <property name="label" translatable="yes">Zoom _2:1</property>
-		      <property name="use_underline">True</property>
-		      <accelerator key="2" modifiers="GDK_CONTROL_MASK | GDK_MOD1_MASK" signal="activate"/>
-		    </widget>
-		  </child>
-		</widget>
-	      </child>
-	    </widget>
-	  </child>
-
-	  <child>
-	    <widget class="GtkMenuItem" id="video_1">
-	      <property name="visible">True</property>
-	      <property name="label" translatable="yes">Vi_deo</property>
-	      <property name="use_underline">True</property>
-
-	      <child>
-		<widget class="GtkMenu" id="video_1_menu">
-
-		  <child>
-		    <widget class="GtkMenuItem" id="decoder_options1">
-		      <property name="visible">True</property>
-		      <property name="label" translatable="yes">_Decoder Options</property>
-		      <property name="use_underline">True</property>
-		      <accelerator key="F3" modifiers="0" signal="activate"/>
-		    </widget>
-		  </child>
-
-		  <child>
-		    <widget class="GtkMenuItem" id="set_postprocessing1">
-		      <property name="visible">True</property>
-		      <property name="tooltip" translatable="yes">Select postprocessing level</property>
-		      <property name="label" translatable="yes">_Postprocessing</property>
-		      <property name="use_underline">True</property>
-		      <accelerator key="F4" modifiers="0" signal="activate"/>
-		    </widget>
-		  </child>
-
-		  <child>
-		    <widget class="GtkSeparatorMenuItem" id="separator9">
-		      <property name="visible">True</property>
-		    </widget>
-		  </child>
-
-		  <child>
-		    <widget class="GtkCheckMenuItem" id="preview1">
-		      <property name="visible">True</property>
-		      <property name="label" translatable="yes">P_review</property>
-		      <property name="use_underline">True</property>
-		      <property name="active">False</property>
-		      <accelerator key="F5" modifiers="0" signal="activate"/>
-		    </widget>
-		  </child>
-
-		  <child>
-		    <widget class="GtkCheckMenuItem" id="display_output1">
-		      <property name="visible">True</property>
-		      <property name="label" translatable="yes">Display _Output</property>
-		      <property name="use_underline">True</property>
-		      <property name="active">False</property>
-		      <accelerator key="F6" modifiers="0" signal="activate"/>
-		    </widget>
-		  </child>
-
-		  <child>
-		    <widget class="GtkSeparatorMenuItem" id="separator10">
-		      <property name="visible">True</property>
-		    </widget>
-		  </child>
-
-		  <child>
-		    <widget class="GtkMenuItem" id="change_fps">
-		      <property name="visible">True</property>
-		      <property name="label" translatable="yes">_Frame Rate</property>
-		      <property name="use_underline">True</property>
-		    </widget>
-		  </child>
-
-		  <child>
-		    <widget class="GtkMenuItem" id="videoencoder">
-		      <property name="visible">True</property>
-		      <property name="label" translatable="yes">_Encoder</property>
-		      <property name="use_underline">True</property>
-		      <accelerator key="V" modifiers="GDK_CONTROL_MASK | GDK_MOD1_MASK" signal="activate"/>
-		    </widget>
-		  </child>
-
-		  <child>
-		    <widget class="GtkMenuItem" id="filters1">
-		      <property name="visible">True</property>
-		      <property name="label" translatable="yes">Fil_ters</property>
-		      <property name="use_underline">True</property>
-		      <accelerator key="F" modifiers="GDK_CONTROL_MASK | GDK_MOD1_MASK" signal="activate"/>
-		    </widget>
-		  </child>
-		</widget>
-	      </child>
-	    </widget>
-	  </child>
-
-	  <child>
-	    <widget class="GtkMenuItem" id="audio1">
-	      <property name="visible">True</property>
-	      <property name="label" translatable="yes">_Audio</property>
-	      <property name="use_underline">True</property>
-
-	      <child>
-		<widget class="GtkMenu" id="audio1_menu">
-
-		  <child>
-		    <widget class="GtkMenuItem" id="main_audio">
-		      <property name="visible">True</property>
-		      <property name="label" translatable="yes">_Main Track</property>
-		      <property name="use_underline">True</property>
-		    </widget>
-		  </child>
-
-		  <child>
-		    <widget class="GtkMenuItem" id="second_audio_track1">
-		      <property name="visible">True</property>
-		      <property name="label" translatable="yes">_Second Track</property>
-		      <property name="use_underline">True</property>
-		    </widget>
-		  </child>
-
-		  <child>
-		    <widget class="GtkMenuItem" id="build_vbr_time_map1">
-		      <property name="visible">True</property>
-		      <property name="label" translatable="yes">_Build VBR Time Map</property>
-		      <property name="use_underline">True</property>
-		    </widget>
-		  </child>
-
-		  <child>
-		    <widget class="GtkSeparatorMenuItem" id="separator11">
-		      <property name="visible">True</property>
-		    </widget>
-		  </child>
-
-		  <child>
-		    <widget class="GtkImageMenuItem" id="save_audio1">
-		      <property name="visible">True</property>
-		      <property name="label" translatable="yes">S_ave...</property>
-		      <property name="use_underline">True</property>
-		      <accelerator key="S" modifiers="GDK_CONTROL_MASK | GDK_MOD1_MASK" signal="activate"/>
-
-		      <child internal-child="image">
-			<widget class="GtkImage" id="image8537">
-			  <property name="visible">True</property>
-			  <property name="stock">gtk-save-as</property>
-			  <property name="icon_size">1</property>
-			  <property name="xalign">0.5</property>
-			  <property name="yalign">0.5</property>
-			  <property name="xpad">0</property>
-			  <property name="ypad">0</property>
-			</widget>
-		      </child>
-		    </widget>
-		  </child>
-
-		  <child>
-		    <widget class="GtkMenuItem" id="audio_encoder1">
-		      <property name="visible">True</property>
-		      <property name="label" translatable="yes">_Encoder</property>
-		      <property name="use_underline">True</property>
-		      <accelerator key="A" modifiers="GDK_CONTROL_MASK | GDK_MOD1_MASK" signal="activate"/>
-		    </widget>
-		  </child>
-
-		  <child>
-		    <widget class="GtkMenuItem" id="filters2">
-		      <property name="visible">True</property>
-		      <property name="label" translatable="yes">_Filters</property>
-		      <property name="use_underline">True</property>
-		    </widget>
-		  </child>
-		</widget>
-	      </child>
-	    </widget>
-	  </child>
-
-	  <child>
-	    <widget class="GtkMenuItem" id="tools1">
-	      <property name="visible">True</property>
-	      <property name="label" translatable="yes">_Tools</property>
-	      <property name="use_underline">True</property>
-
-	      <child>
-		<widget class="GtkMenu" id="tools1_menu">
-
-		  <child>
-		    <widget class="GtkImageMenuItem" id="calculator1">
-		      <property name="visible">True</property>
-		      <property name="label" translatable="yes">_Calculator</property>
-		      <property name="use_underline">True</property>
-		      <accelerator key="F7" modifiers="0" signal="activate"/>
-
-		      <child internal-child="image">
-			<widget class="GtkImage" id="image8538">
-			  <property name="visible">True</property>
-			  <property name="pixbuf">gnome-calculator_small.xpm</property>
-			  <property name="xalign">0.5</property>
-			  <property name="yalign">0.5</property>
-			  <property name="xpad">0</property>
-			  <property name="ypad">0</property>
-			</widget>
-		      </child>
-		    </widget>
-		  </child>
-
-		  <child>
-		    <widget class="GtkSeparatorMenuItem" id="separator12">
-		      <property name="visible">True</property>
-		    </widget>
-		  </child>
-
-		  <child>
-		    <widget class="GtkMenuItem" id="rebuild_frames">
-		      <property name="visible">True</property>
-		      <property name="label" translatable="yes">_Rebuild Frames (I &amp; B)</property>
-		      <property name="use_underline">True</property>
-		    </widget>
-		  </child>
-
-		  <child>
-		    <widget class="GtkMenuItem" id="check_frames">
-		      <property name="visible">True</property>
-		      <property name="label" translatable="yes">C_heck Frames (slow)</property>
-		      <property name="use_underline">True</property>
-		    </widget>
-		  </child>
-
-		  <child>
-		    <widget class="GtkMenuItem" id="bitrate_histogram1">
-		      <property name="visible">True</property>
-		      <property name="label" translatable="yes">_Bitrate Histogram</property>
-		      <property name="use_underline">True</property>
-		    </widget>
-		  </child>
-
-		  <child>
-		    <widget class="GtkMenuItem" id="item1">
-		      <property name="visible">True</property>
-		      <property name="label" translatable="yes">_Scan for Black Frames...</property>
-		      <property name="use_underline">True</property>
-		    </widget>
-		  </child>
-
-		  <child>
-		    <widget class="GtkSeparatorMenuItem" id="separator13">
-		      <property name="visible">True</property>
-		    </widget>
-		  </child>
-
-		  <child>
-		    <widget class="GtkMenuItem" id="v2v">
-		      <property name="visible">True</property>
-		      <property name="label" translatable="yes">_VOB -&gt; VobSub</property>
-		      <property name="use_underline">True</property>
-		    </widget>
-		  </child>
-
-		  <child>
-		    <widget class="GtkMenuItem" id="ocr_vobsub_2_srt">
-		      <property name="visible">True</property>
-		      <property name="label" translatable="yes">_OCR (VobSub -&gt; srt)</property>
-		      <property name="use_underline">True</property>
-		    </widget>
-		  </child>
-
-		  <child>
-		    <widget class="GtkMenuItem" id="ocr_dvb">
-		      <property name="visible">True</property>
-		      <property name="label" translatable="yes">OCR (TS-&gt;srt)</property>
-		      <property name="use_underline">True</property>
-		    </widget>
-		  </child>
-
-		  <child>
-		    <widget class="GtkMenuItem" id="edit_glyph1">
-		      <property name="visible">True</property>
-		      <property name="label" translatable="yes">_Edit Glyph</property>
-		      <property name="use_underline">True</property>
-		    </widget>
-		  </child>
-
-		  <child>
-		    <widget class="GtkSeparatorMenuItem" id="separator17">
-		      <property name="visible">True</property>
-		    </widget>
-		  </child>
-
-		  <child>
-		    <widget class="GtkMenuItem" id="see_hex1">
-		      <property name="visible">True</property>
-		      <property name="label" translatable="yes">_Frame Hex Dump</property>
-		      <property name="use_underline">True</property>
-		    </widget>
-		  </child>
-		</widget>
-	      </child>
-	    </widget>
-	  </child>
-
-	  <child>
-	    <widget class="GtkMenuItem" id="help1">
-	      <property name="visible">True</property>
-	      <property name="label" translatable="yes">A_uto</property>
-	      <property name="use_underline">True</property>
-
-	      <child>
-		<widget class="GtkMenu" id="help1_menu">
-
-		  <child>
-		    <widget class="GtkMenuItem" id="vcd1">
-		      <property name="visible">True</property>
-		      <property name="label" translatable="yes">_VCD</property>
-		      <property name="use_underline">True</property>
-		    </widget>
-		  </child>
-
-		  <child>
-		    <widget class="GtkMenuItem" id="svcd1">
-		      <property name="visible">True</property>
-		      <property name="label" translatable="yes">_SVCD</property>
-		      <property name="use_underline">True</property>
-		    </widget>
-		  </child>
-
-		  <child>
-		    <widget class="GtkMenuItem" id="dvd1">
-		      <property name="visible">True</property>
-		      <property name="label" translatable="yes">_DVD</property>
-		      <property name="use_underline">True</property>
-		    </widget>
-		  </child>
-
-		  <child>
-		    <widget class="GtkMenuItem" id="psp1">
-		      <property name="visible">True</property>
-		      <property name="label" translatable="yes">_PSP</property>
-		      <property name="use_underline">True</property>
-		    </widget>
-		  </child>
-
-		  <child>
-		    <widget class="GtkMenuItem" id="psp_(h264)1">
-		      <property name="visible">True</property>
-		      <property name="label" translatable="yes">PSP (_H.264)</property>
-		      <property name="use_underline">True</property>
-		    </widget>
-		  </child>
-
-		  <child>
-		    <widget class="GtkMenuItem" id="flv1">
-		      <property name="visible">True</property>
-		      <property name="label" translatable="yes">F_LV</property>
-		      <property name="use_underline">True</property>
-		    </widget>
-		  </child>
-
-		  <child>
-		    <widget class="GtkMenuItem" id="Ipod">
-		      <property name="visible">True</property>
-		      <property name="label" translatable="yes">IPOD (mpeg4)</property>
-		      <property name="use_underline">True</property>
-		    </widget>
-		  </child>
-		</widget>
-	      </child>
-	    </widget>
-	  </child>
-
-	  <child>
-	    <widget class="GtkMenuItem" id="go1">
-	      <property name="visible">True</property>
-	      <property name="label" translatable="yes">_Go</property>
-	      <property name="use_underline">True</property>
-
-	      <child>
-		<widget class="GtkMenu" id="go1_menu">
-
-		  <child>
-		    <widget class="GtkImageMenuItem" id="play_video1">
-		      <property name="visible">True</property>
-		      <property name="label" translatable="yes">_Play/Stop</property>
-		      <property name="use_underline">True</property>
-		      <accelerator key="P" modifiers="0" signal="activate"/>
-
-		      <child internal-child="image">
-			<widget class="GtkImage" id="image8539">
-			  <property name="visible">True</property>
-			  <property name="stock">gtk-media-play</property>
-			  <property name="icon_size">1</property>
-			  <property name="xalign">0.5</property>
-			  <property name="yalign">0.5</property>
-			  <property name="xpad">0</property>
-			  <property name="ypad">0</property>
-			</widget>
-		      </child>
-		    </widget>
-		  </child>
-
-		  <child>
-		    <widget class="GtkImageMenuItem" id="previous_frame1">
-		      <property name="visible">True</property>
-		      <property name="label" translatable="yes">P_revious Frame</property>
-		      <property name="use_underline">True</property>
-		      <accelerator key="KP_4" modifiers="0" signal="activate"/>
-
-		      <child internal-child="image">
-			<widget class="GtkImage" id="image8540">
-			  <property name="visible">True</property>
-			  <property name="stock">gtk-media-previous</property>
-			  <property name="icon_size">1</property>
-			  <property name="xalign">0.5</property>
-			  <property name="yalign">0.5</property>
-			  <property name="xpad">0</property>
-			  <property name="ypad">0</property>
-			</widget>
-		      </child>
-		    </widget>
-		  </child>
-
-		  <child>
-		    <widget class="GtkImageMenuItem" id="next_frame1">
-		      <property name="visible">True</property>
-		      <property name="label" translatable="yes">_Next Frame</property>
-		      <property name="use_underline">True</property>
-		      <accelerator key="KP_6" modifiers="0" signal="activate"/>
-
-		      <child internal-child="image">
-			<widget class="GtkImage" id="image8541">
-			  <property name="visible">True</property>
-			  <property name="stock">gtk-media-next</property>
-			  <property name="icon_size">1</property>
-			  <property name="xalign">0.5</property>
-			  <property name="yalign">0.5</property>
-			  <property name="xpad">0</property>
-			  <property name="ypad">0</property>
-			</widget>
-		      </child>
-		    </widget>
-		  </child>
-
-		  <child>
-		    <widget class="GtkImageMenuItem" id="previous_intra_frame1">
-		      <property name="visible">True</property>
-		      <property name="label" translatable="yes">Pr_evious Intra Frame</property>
-		      <property name="use_underline">True</property>
-		      <accelerator key="KP_2" modifiers="0" signal="activate"/>
-
-		      <child internal-child="image">
-			<widget class="GtkImage" id="image8542">
-			  <property name="visible">True</property>
-			  <property name="stock">gtk-media-rewind</property>
-			  <property name="icon_size">1</property>
-			  <property name="xalign">0.5</property>
-			  <property name="yalign">0.5</property>
-			  <property name="xpad">0</property>
-			  <property name="ypad">0</property>
-			</widget>
-		      </child>
-		    </widget>
-		  </child>
-
-		  <child>
-		    <widget class="GtkImageMenuItem" id="next_intra_frame1">
-		      <property name="visible">True</property>
-		      <property name="label" translatable="yes">Next _Intra Frame</property>
-		      <property name="use_underline">True</property>
-		      <accelerator key="KP_8" modifiers="0" signal="activate"/>
-
-		      <child internal-child="image">
-			<widget class="GtkImage" id="image8543">
-			  <property name="visible">True</property>
-			  <property name="stock">gtk-media-forward</property>
-			  <property name="icon_size">1</property>
-			  <property name="xalign">0.5</property>
-			  <property name="yalign">0.5</property>
-			  <property name="xpad">0</property>
-			  <property name="ypad">0</property>
-			</widget>
-		      </child>
-		    </widget>
-		  </child>
-
-		  <child>
-		    <widget class="GtkMenuItem" id="search_previous_black_frame1">
-		      <property name="visible">True</property>
-		      <property name="label" translatable="yes">Previou_s Black Frame</property>
-		      <property name="use_underline">True</property>
-		    </widget>
-		  </child>
-
-		  <child>
-		    <widget class="GtkMenuItem" id="search_next_black_frame1">
-		      <property name="visible">True</property>
-		      <property name="label" translatable="yes">Ne_xt Black Frame</property>
-		      <property name="use_underline">True</property>
-		    </widget>
-		  </child>
-
-		  <child>
-		    <widget class="GtkImageMenuItem" id="first_frame1">
-		      <property name="visible">True</property>
-		      <property name="label" translatable="yes">_First Frame</property>
-		      <property name="use_underline">True</property>
-		      <accelerator key="Home" modifiers="0" signal="activate"/>
-
-		      <child internal-child="image">
-			<widget class="GtkImage" id="image8544">
-			  <property name="visible">True</property>
-			  <property name="stock">gtk-goto-first</property>
-			  <property name="icon_size">1</property>
-			  <property name="xalign">0.5</property>
-			  <property name="yalign">0.5</property>
-			  <property name="xpad">0</property>
-			  <property name="ypad">0</property>
-			</widget>
-		      </child>
-		    </widget>
-		  </child>
-
-		  <child>
-		    <widget class="GtkImageMenuItem" id="last_frame1">
-		      <property name="visible">True</property>
-		      <property name="label" translatable="yes">_Last Frame</property>
-		      <property name="use_underline">True</property>
-		      <accelerator key="End" modifiers="0" signal="activate"/>
-
-		      <child internal-child="image">
-			<widget class="GtkImage" id="image8545">
-			  <property name="visible">True</property>
-			  <property name="stock">gtk-goto-last</property>
-			  <property name="icon_size">1</property>
-			  <property name="xalign">0.5</property>
-			  <property name="yalign">0.5</property>
-			  <property name="xpad">0</property>
-			  <property name="ypad">0</property>
-			</widget>
-		      </child>
-		    </widget>
-		  </child>
-
-		  <child>
-		    <widget class="GtkSeparatorMenuItem" id="separator14">
-		      <property name="visible">True</property>
-		    </widget>
-		  </child>
-
-		  <child>
-		    <widget class="GtkMenuItem" id="go_to_marker_a1">
-		      <property name="visible">True</property>
-		      <property name="label" translatable="yes">Go to Marker _A</property>
-		      <property name="use_underline">True</property>
-		      <accelerator key="bracketleft" modifiers="GDK_CONTROL_MASK" signal="activate"/>
-		    </widget>
-		  </child>
-
-		  <child>
-		    <widget class="GtkMenuItem" id="go_to_marker_b1">
-		      <property name="visible">True</property>
-		      <property name="label" translatable="yes">Go to Marker _B</property>
-		      <property name="use_underline">True</property>
-		      <accelerator key="bracketright" modifiers="GDK_CONTROL_MASK" signal="activate"/>
-		    </widget>
-		  </child>
-
-		  <child>
-		    <widget class="GtkSeparatorMenuItem" id="separator15">
-		      <property name="visible">True</property>
-		    </widget>
-		  </child>
-
-		  <child>
-		    <widget class="GtkImageMenuItem" id="jum_to_frame1">
-		      <property name="visible">True</property>
-		      <property name="label" translatable="yes">Go to Fra_me...</property>
-		      <property name="use_underline">True</property>
-		      <accelerator key="F" modifiers="GDK_CONTROL_MASK" signal="activate"/>
-
-		      <child internal-child="image">
-			<widget class="GtkImage" id="image8546">
-			  <property name="visible">True</property>
-			  <property name="stock">gtk-jump-to</property>
-			  <property name="icon_size">1</property>
-			  <property name="xalign">0.5</property>
-			  <property name="yalign">0.5</property>
-			  <property name="xpad">0</property>
-			  <property name="ypad">0</property>
-			</widget>
-		      </child>
-		    </widget>
-		  </child>
-
-		  <child>
-		    <widget class="GtkImageMenuItem" id="jump_to_time1">
-		      <property name="visible">True</property>
-		      <property name="label" translatable="yes">Go to _Time...</property>
-		      <property name="use_underline">True</property>
-		      <accelerator key="T" modifiers="GDK_CONTROL_MASK" signal="activate"/>
-
-		      <child internal-child="image">
-			<widget class="GtkImage" id="image8547">
-			  <property name="visible">True</property>
-			  <property name="stock">gtk-jump-to</property>
-			  <property name="icon_size">1</property>
-			  <property name="xalign">0.5</property>
-			  <property name="yalign">0.5</property>
-			  <property name="xpad">0</property>
-			  <property name="ypad">0</property>
-			</widget>
-		      </child>
-		    </widget>
-		  </child>
-		</widget>
-	      </child>
-	    </widget>
-	  </child>
-
-	  <child>
-	    <widget class="GtkMenuItem" id="custom1">
-	      <property name="visible">True</property>
-	      <property name="label" translatable="yes">_Custom</property>
-	      <property name="use_underline">True</property>
-	    </widget>
-	  </child>
-
-	  <child>
-	    <widget class="GtkMenuItem" id="help2">
-	      <property name="visible">True</property>
-	      <property name="label" translatable="yes">_Help</property>
-	      <property name="use_underline">True</property>
-
-	      <child>
-		<widget class="GtkMenu" id="help2_menu">
-
-		  <child>
-		    <widget class="GtkMenuItem" id="plugins1">
-		      <property name="visible">True</property>
-		      <property name="label" translatable="yes">_Plugins</property>
-		      <property name="use_underline">True</property>
-		      <signal name="activate" handler="on_plugins1_activate" last_modification_time="Sat, 21 Jun 2008 18:24:10 GMT"/>
-		    </widget>
-		  </child>
-
-		  <child>
-		    <widget class="GtkMenuItem" id="show_builtin_support1">
-		      <property name="visible">True</property>
-		      <property name="label" translatable="yes">_Built-in Support</property>
-		      <property name="use_underline">True</property>
-		    </widget>
-		  </child>
-
-		  <child>
-		    <widget class="GtkImageMenuItem" id="about1">
-		      <property name="visible">True</property>
-		      <property name="label" translatable="yes">_About</property>
-		      <property name="use_underline">True</property>
-
-		      <child internal-child="image">
-			<widget class="GtkImage" id="image8548">
-			  <property name="visible">True</property>
-			  <property name="stock">gtk-about</property>
-			  <property name="icon_size">1</property>
-			  <property name="xalign">0.5</property>
-			  <property name="yalign">0.5</property>
-			  <property name="xpad">0</property>
-			  <property name="ypad">0</property>
-			</widget>
-		      </child>
-		    </widget>
-		  </child>
-		</widget>
-	      </child>
-	    </widget>
-	  </child>
-	</widget>
-	<packing>
-	  <property name="padding">0</property>
-	  <property name="expand">False</property>
-	  <property name="fill">False</property>
-	</packing>
-      </child>
-
-      <child>
-	<widget class="GtkToolbar" id="toolbar2">
-	  <property name="visible">True</property>
-	  <property name="orientation">GTK_ORIENTATION_HORIZONTAL</property>
-	  <property name="toolbar_style">GTK_TOOLBAR_BOTH_HORIZ</property>
-	  <property name="tooltips">True</property>
-	  <property name="show_arrow">True</property>
-
-	  <child>
-	    <widget class="GtkMenuToolButton" id="menutoolbuttonOpen">
-	      <property name="visible">True</property>
-	      <property name="tooltip" translatable="yes">Open a file</property>
-	      <property name="stock_id">gtk-open</property>
-	      <property name="visible_horizontal">True</property>
-	      <property name="visible_vertical">True</property>
-	      <property name="is_important">True</property>
-	    </widget>
-	    <packing>
-	      <property name="expand">False</property>
-	      <property name="homogeneous">False</property>
-	    </packing>
-	  </child>
-
-	  <child>
-	    <widget class="GtkToolItem" id="toolitem11">
-	      <property name="visible">True</property>
-	      <property name="visible_horizontal">True</property>
-	      <property name="visible_vertical">True</property>
-	      <property name="is_important">False</property>
-	    </widget>
-	    <packing>
-	      <property name="expand">False</property>
-	      <property name="homogeneous">False</property>
-	    </packing>
-	  </child>
-
-	  <child>
-	    <widget class="GtkToolButton" id="toolbuttonSave">
-	      <property name="visible">True</property>
-	      <property name="tooltip" translatable="yes">Save the file</property>
-	      <property name="stock_id">gtk-save</property>
-	      <property name="visible_horizontal">True</property>
-	      <property name="visible_vertical">True</property>
-	      <property name="is_important">True</property>
-	    </widget>
-	    <packing>
-	      <property name="expand">False</property>
-	      <property name="homogeneous">True</property>
-	    </packing>
-	  </child>
-
-	  <child>
-	    <widget class="GtkToolButton" id="toolbuttonInfo">
-	      <property name="visible">True</property>
-	      <property name="tooltip" translatable="yes">Audio/video file information</property>
-	      <property name="stock_id">gtk-properties</property>
-	      <property name="visible_horizontal">True</property>
-	      <property name="visible_vertical">True</property>
-	      <property name="is_important">False</property>
-	    </widget>
-	    <packing>
-	      <property name="expand">False</property>
-	      <property name="homogeneous">True</property>
-	    </packing>
-	  </child>
-
-	  <child>
-	    <widget class="GtkSeparatorToolItem" id="separatortoolitem1">
-	      <property name="visible">True</property>
-	      <property name="draw">True</property>
-	      <property name="visible_horizontal">True</property>
-	      <property name="visible_vertical">True</property>
-	    </widget>
-	    <packing>
-	      <property name="expand">False</property>
-	      <property name="homogeneous">False</property>
-	    </packing>
-	  </child>
-
-	  <child>
-	    <widget class="GtkToolButton" id="toolbuttonCalc">
-	      <property name="visible">True</property>
-	      <property name="tooltip" translatable="yes">Bitrate/size calculator</property>
-	      <property name="label" translatable="yes">Calculator</property>
-	      <property name="use_underline">True</property>
-	      <property name="icon">gnome-calculator.png</property>
-	      <property name="visible_horizontal">True</property>
-	      <property name="visible_vertical">True</property>
-	      <property name="is_important">True</property>
-	    </widget>
-	    <packing>
-	      <property name="expand">False</property>
-	      <property name="homogeneous">True</property>
-	    </packing>
-	  </child>
-
-	  <child>
-	    <widget class="GtkSeparatorToolItem" id="separatortoolitem2">
-	      <property name="visible">True</property>
-	      <property name="draw">True</property>
-	      <property name="visible_horizontal">True</property>
-	      <property name="visible_vertical">True</property>
-	    </widget>
-	    <packing>
-	      <property name="expand">False</property>
-	      <property name="homogeneous">False</property>
-	    </packing>
-	  </child>
-
-	  <child>
-	    <widget class="GtkToolItem" id="toolitem12">
-	      <property name="visible">True</property>
-	      <property name="visible_horizontal">True</property>
-	      <property name="visible_vertical">True</property>
-	      <property name="is_important">False</property>
-
-	      <child>
-		<widget class="GtkComboBox" id="comboboxPreview">
-		  <property name="visible">True</property>
-		  <property name="items" translatable="yes"></property>
-		  <property name="add_tearoffs">False</property>
-		  <property name="focus_on_click">True</property>
-		</widget>
-	      </child>
-	    </widget>
-	    <packing>
-	      <property name="expand">False</property>
-	      <property name="homogeneous">False</property>
-	    </packing>
-	  </child>
-
-	  <child>
-	    <widget class="GtkToolItem" id="toolitem13">
-	      <property name="visible">True</property>
-	      <property name="visible_horizontal">True</property>
-	      <property name="visible_vertical">True</property>
-	      <property name="is_important">False</property>
-
-	      <child>
-		<widget class="GtkToggleButton" id="togglebutton1">
-		  <property name="visible">True</property>
-		  <property name="can_focus">True</property>
-		  <property name="relief">GTK_RELIEF_NONE</property>
-		  <property name="focus_on_click">True</property>
-		  <property name="active">False</property>
-		  <property name="inconsistent">False</property>
-
-		  <child>
-		    <widget class="GtkImage" id="image8272">
-		      <property name="width_request">17</property>
-		      <property name="height_request">16</property>
-		      <property name="visible">True</property>
-		      <property name="pixbuf">audio-volume-medium.png</property>
-		      <property name="xalign">0.5</property>
-		      <property name="yalign">0.5</property>
-		      <property name="xpad">0</property>
-		      <property name="ypad">0</property>
-		    </widget>
-		  </child>
-		</widget>
-	      </child>
-	    </widget>
-	    <packing>
-	      <property name="expand">False</property>
-	      <property name="homogeneous">False</property>
-	    </packing>
-	  </child>
-
-	  <child>
-	    <widget class="GtkToolItem" id="toolitem14">
-	      <property name="visible">True</property>
-	      <property name="visible_horizontal">True</property>
-	      <property name="visible_vertical">True</property>
-	      <property name="is_important">False</property>
-
-	      <child>
-		<widget class="GtkHScale" id="hscalVolume">
-		  <property name="width_request">100</property>
-		  <property name="visible">True</property>
-		  <property name="can_focus">True</property>
-		  <property name="draw_value">False</property>
-		  <property name="value_pos">GTK_POS_TOP</property>
-		  <property name="digits">0</property>
-		  <property name="update_policy">GTK_UPDATE_CONTINUOUS</property>
-		  <property name="inverted">False</property>
-		  <property name="adjustment">99 0 100 1 1 1</property>
-		</widget>
-	      </child>
-	    </widget>
-	    <packing>
-	      <property name="expand">False</property>
-	      <property name="homogeneous">False</property>
-	    </packing>
-	  </child>
-	</widget>
-	<packing>
-	  <property name="padding">0</property>
-	  <property name="expand">False</property>
-	  <property name="fill">False</property>
-	</packing>
-      </child>
-
-      <child>
-	<widget class="GtkVBox" id="vbox10">
-	  <property name="visible">True</property>
-	  <property name="homogeneous">False</property>
-	  <property name="spacing">3</property>
-
-	  <child>
-	    <widget class="GtkHBox" id="hbox14">
-	      <property name="visible">True</property>
-	      <property name="homogeneous">False</property>
-	      <property name="spacing">0</property>
-
-	      <child>
-		<widget class="GtkAlignment" id="alignment19">
-		  <property name="visible">True</property>
-		  <property name="xalign">0.5</property>
-		  <property name="yalign">0.5</property>
-		  <property name="xscale">1</property>
-		  <property name="yscale">1</property>
-		  <property name="top_padding">3</property>
-		  <property name="bottom_padding">0</property>
-		  <property name="left_padding">3</property>
-		  <property name="right_padding">0</property>
-
-		  <child>
-		    <widget class="GtkVBox" id="vbox9">
-		      <property name="visible">True</property>
-		      <property name="homogeneous">False</property>
-		      <property name="spacing">9</property>
-
-		      <child>
-			<widget class="GtkVBox" id="vbox11">
-			  <property name="visible">True</property>
-			  <property name="homogeneous">False</property>
-			  <property name="spacing">0</property>
-
-			  <child>
-			    <widget class="GtkLabel" id="label18">
-			      <property name="visible">True</property>
-			      <property name="label" translatable="yes">&lt;b&gt;Video&lt;/b&gt;</property>
-			      <property name="use_underline">False</property>
-			      <property name="use_markup">True</property>
-			      <property name="justify">GTK_JUSTIFY_LEFT</property>
-			      <property name="wrap">False</property>
-			      <property name="selectable">False</property>
-			      <property name="xalign">0</property>
-			      <property name="yalign">0.5</property>
-			      <property name="xpad">0</property>
-			      <property name="ypad">0</property>
-			      <property name="ellipsize">PANGO_ELLIPSIZE_NONE</property>
-			      <property name="width_chars">-1</property>
-			      <property name="single_line_mode">False</property>
-			      <property name="angle">0</property>
-			    </widget>
-			    <packing>
-			      <property name="padding">0</property>
-			      <property name="expand">False</property>
-			      <property name="fill">False</property>
-			    </packing>
-			  </child>
-
-			  <child>
-			    <widget class="GtkAlignment" id="alignment12">
-			      <property name="visible">True</property>
-			      <property name="xalign">0.5</property>
-			      <property name="yalign">0.5</property>
-			      <property name="xscale">1</property>
-			      <property name="yscale">1</property>
-			      <property name="top_padding">3</property>
-			      <property name="bottom_padding">0</property>
-			      <property name="left_padding">12</property>
-			      <property name="right_padding">0</property>
-
-			      <child>
-				<widget class="GtkVBox" id="vbox7">
-				  <property name="visible">True</property>
-				  <property name="homogeneous">False</property>
-				  <property name="spacing">3</property>
-
-				  <child>
-				    <widget class="GtkComboBox" id="comboboxVideo">
-				      <property name="visible">True</property>
-				      <property name="items" translatable="yes">Copy</property>
-				      <property name="add_tearoffs">False</property>
-				      <property name="focus_on_click">True</property>
-				    </widget>
-				    <packing>
-				      <property name="padding">0</property>
-				      <property name="expand">False</property>
-				      <property name="fill">False</property>
-				    </packing>
-				  </child>
-
-				  <child>
-				    <widget class="GtkButton" id="buttonConfV">
-				      <property name="visible">True</property>
-				      <property name="tooltip" translatable="yes">Configure video encoder</property>
-				      <property name="can_focus">True</property>
-				      <property name="label" translatable="yes">Configure</property>
-				      <property name="use_underline">True</property>
-				      <property name="relief">GTK_RELIEF_NORMAL</property>
-				      <property name="focus_on_click">True</property>
-				      <accelerator key="F3" modifiers="0" signal="clicked"/>
-				    </widget>
-				    <packing>
-				      <property name="padding">0</property>
-				      <property name="expand">False</property>
-				      <property name="fill">False</property>
-				    </packing>
-				  </child>
-
-				  <child>
-				    <widget class="GtkButton" id="buttonFilters">
-				      <property name="visible">True</property>
-				      <property name="tooltip" translatable="yes">Video filters</property>
-				      <property name="can_focus">True</property>
-				      <property name="label" translatable="yes">Filters</property>
-				      <property name="use_underline">True</property>
-				      <property name="relief">GTK_RELIEF_NORMAL</property>
-				      <property name="focus_on_click">True</property>
-				      <accelerator key="F1" modifiers="0" signal="clicked"/>
-				    </widget>
-				    <packing>
-				      <property name="padding">0</property>
-				      <property name="expand">False</property>
-				      <property name="fill">False</property>
-				    </packing>
-				  </child>
-				</widget>
-			      </child>
-			    </widget>
-			    <packing>
-			      <property name="padding">0</property>
-			      <property name="expand">True</property>
-			      <property name="fill">True</property>
-			    </packing>
-			  </child>
-			</widget>
-			<packing>
-			  <property name="padding">0</property>
-			  <property name="expand">False</property>
-			  <property name="fill">False</property>
-			</packing>
-		      </child>
-
-		      <child>
-			<widget class="GtkVBox" id="vbox12">
-			  <property name="visible">True</property>
-			  <property name="homogeneous">False</property>
-			  <property name="spacing">0</property>
-
-			  <child>
-			    <widget class="GtkLabel" id="label19">
-			      <property name="visible">True</property>
-			      <property name="label" translatable="yes">&lt;b&gt;Audio&lt;/b&gt;</property>
-			      <property name="use_underline">False</property>
-			      <property name="use_markup">True</property>
-			      <property name="justify">GTK_JUSTIFY_LEFT</property>
-			      <property name="wrap">False</property>
-			      <property name="selectable">False</property>
-			      <property name="xalign">0</property>
-			      <property name="yalign">0.5</property>
-			      <property name="xpad">0</property>
-			      <property name="ypad">0</property>
-			      <property name="ellipsize">PANGO_ELLIPSIZE_NONE</property>
-			      <property name="width_chars">-1</property>
-			      <property name="single_line_mode">False</property>
-			      <property name="angle">0</property>
-			    </widget>
-			    <packing>
-			      <property name="padding">0</property>
-			      <property name="expand">False</property>
-			      <property name="fill">False</property>
-			    </packing>
-			  </child>
-
-			  <child>
-			    <widget class="GtkAlignment" id="alignment13">
-			      <property name="visible">True</property>
-			      <property name="xalign">0.5</property>
-			      <property name="yalign">0.5</property>
-			      <property name="xscale">1</property>
-			      <property name="yscale">1</property>
-			      <property name="top_padding">3</property>
-			      <property name="bottom_padding">0</property>
-			      <property name="left_padding">12</property>
-			      <property name="right_padding">0</property>
-
-			      <child>
-				<widget class="GtkVBox" id="vbox8">
-				  <property name="visible">True</property>
-				  <property name="homogeneous">False</property>
-				  <property name="spacing">3</property>
-
-				  <child>
-				    <widget class="GtkComboBox" id="comboboxAudio">
-				      <property name="visible">True</property>
-				      <property name="items" translatable="yes">Copy</property>
-				      <property name="add_tearoffs">False</property>
-				      <property name="focus_on_click">True</property>
-				    </widget>
-				    <packing>
-				      <property name="padding">0</property>
-				      <property name="expand">False</property>
-				      <property name="fill">False</property>
-				    </packing>
-				  </child>
-
-				  <child>
-				    <widget class="GtkButton" id="buttonConfA">
-				      <property name="visible">True</property>
-				      <property name="tooltip" translatable="yes">Configure audio encoder</property>
-				      <property name="can_focus">True</property>
-				      <property name="label" translatable="yes">Configure</property>
-				      <property name="use_underline">True</property>
-				      <property name="relief">GTK_RELIEF_NORMAL</property>
-				      <property name="focus_on_click">True</property>
-				      <accelerator key="F4" modifiers="0" signal="clicked"/>
-				    </widget>
-				    <packing>
-				      <property name="padding">0</property>
-				      <property name="expand">False</property>
-				      <property name="fill">False</property>
-				    </packing>
-				  </child>
-
-				  <child>
-				    <widget class="GtkButton" id="buttonAudioFilter">
-				      <property name="visible">True</property>
-				      <property name="tooltip" translatable="yes">Audio filters</property>
-				      <property name="can_focus">True</property>
-				      <property name="relief">GTK_RELIEF_NORMAL</property>
-				      <property name="focus_on_click">True</property>
-				      <accelerator key="F2" modifiers="0" signal="clicked"/>
-
-				      <child>
-					<widget class="GtkAlignment" id="alignment16">
-					  <property name="visible">True</property>
-					  <property name="xalign">0.5</property>
-					  <property name="yalign">0.5</property>
-					  <property name="xscale">0</property>
-					  <property name="yscale">0</property>
-					  <property name="top_padding">0</property>
-					  <property name="bottom_padding">0</property>
-					  <property name="left_padding">0</property>
-					  <property name="right_padding">0</property>
-
-					  <child>
-					    <widget class="GtkHBox" id="hbox18">
-					      <property name="visible">True</property>
-					      <property name="homogeneous">False</property>
-					      <property name="spacing">2</property>
-
-					      <child>
-						<widget class="GtkLabel" id="label22">
-						  <property name="visible">True</property>
-						  <property name="label" translatable="yes">Filters</property>
-						  <property name="use_underline">True</property>
-						  <property name="use_markup">False</property>
-						  <property name="justify">GTK_JUSTIFY_LEFT</property>
-						  <property name="wrap">False</property>
-						  <property name="selectable">False</property>
-						  <property name="xalign">0.5</property>
-						  <property name="yalign">0.5</property>
-						  <property name="xpad">0</property>
-						  <property name="ypad">0</property>
-						  <property name="ellipsize">PANGO_ELLIPSIZE_NONE</property>
-						  <property name="width_chars">-1</property>
-						  <property name="single_line_mode">False</property>
-						  <property name="angle">0</property>
-						</widget>
-						<packing>
-						  <property name="padding">0</property>
-						  <property name="expand">False</property>
-						  <property name="fill">False</property>
-						</packing>
-					      </child>
-					    </widget>
-					  </child>
-					</widget>
-				      </child>
-				    </widget>
-				    <packing>
-				      <property name="padding">0</property>
-				      <property name="expand">False</property>
-				      <property name="fill">False</property>
-				    </packing>
-				  </child>
-
-				  <child>
-				    <widget class="GtkHBox" id="hbox19">
-				      <property name="visible">True</property>
-				      <property name="homogeneous">False</property>
-				      <property name="spacing">6</property>
-
-				      <child>
-					<widget class="GtkCheckButton" id="CheckButtonTimeshift">
-					  <property name="visible">True</property>
-					  <property name="tooltip" translatable="yes">Enable time shift</property>
-					  <property name="can_focus">True</property>
-					  <property name="label" translatable="yes">Shift:</property>
-					  <property name="use_underline">True</property>
-					  <property name="relief">GTK_RELIEF_NORMAL</property>
-					  <property name="focus_on_click">True</property>
-					  <property name="active">False</property>
-					  <property name="inconsistent">False</property>
-					  <property name="draw_indicator">True</property>
-					</widget>
-					<packing>
-					  <property name="padding">0</property>
-					  <property name="expand">False</property>
-					  <property name="fill">False</property>
-					</packing>
-				      </child>
-
-				      <child>
-					<widget class="GtkSpinButton" id="spinbuttonTimeShift">
-					  <property name="visible">True</property>
-					  <property name="tooltip" translatable="yes">Audio/video time shift (ms)</property>
-					  <property name="can_focus">True</property>
-					  <property name="climb_rate">1</property>
-					  <property name="digits">0</property>
-					  <property name="numeric">True</property>
-					  <property name="update_policy">GTK_UPDATE_ALWAYS</property>
-					  <property name="snap_to_ticks">False</property>
-					  <property name="wrap">False</property>
-					  <property name="adjustment">0 -99999 99999 1 10 10</property>
-					</widget>
-					<packing>
-					  <property name="padding">0</property>
-					  <property name="expand">True</property>
-					  <property name="fill">True</property>
-					</packing>
-				      </child>
-				    </widget>
-				    <packing>
-				      <property name="padding">0</property>
-				      <property name="expand">True</property>
-				      <property name="fill">True</property>
-				    </packing>
-				  </child>
-				</widget>
-			      </child>
-			    </widget>
-			    <packing>
-			      <property name="padding">0</property>
-			      <property name="expand">True</property>
-			      <property name="fill">True</property>
-			    </packing>
-			  </child>
-			</widget>
-			<packing>
-			  <property name="padding">0</property>
-			  <property name="expand">False</property>
-			  <property name="fill">False</property>
-			</packing>
-		      </child>
-
-		      <child>
-			<widget class="GtkVBox" id="vbox13">
-			  <property name="visible">True</property>
-			  <property name="homogeneous">False</property>
-			  <property name="spacing">0</property>
-
-			  <child>
-			    <widget class="GtkLabel" id="label20">
-			      <property name="visible">True</property>
-			      <property name="label" translatable="yes">&lt;b&gt;Format&lt;/b&gt;</property>
-			      <property name="use_underline">False</property>
-			      <property name="use_markup">True</property>
-			      <property name="justify">GTK_JUSTIFY_LEFT</property>
-			      <property name="wrap">False</property>
-			      <property name="selectable">False</property>
-			      <property name="xalign">0</property>
-			      <property name="yalign">0.5</property>
-			      <property name="xpad">0</property>
-			      <property name="ypad">0</property>
-			      <property name="ellipsize">PANGO_ELLIPSIZE_NONE</property>
-			      <property name="width_chars">-1</property>
-			      <property name="single_line_mode">False</property>
-			      <property name="angle">0</property>
-			    </widget>
-			    <packing>
-			      <property name="padding">0</property>
-			      <property name="expand">False</property>
-			      <property name="fill">False</property>
-			    </packing>
-			  </child>
-
-			  <child>
-			    <widget class="GtkAlignment" id="alignment14">
-			      <property name="visible">True</property>
-			      <property name="xalign">0.5</property>
-			      <property name="yalign">0.5</property>
-			      <property name="xscale">1</property>
-			      <property name="yscale">1</property>
-			      <property name="top_padding">3</property>
-			      <property name="bottom_padding">0</property>
-			      <property name="left_padding">12</property>
-			      <property name="right_padding">0</property>
-
-			      <child>
-				<widget class="GtkComboBox" id="comboboxFormat">
-				  <property name="visible">True</property>
-				  <property name="add_tearoffs">False</property>
-				  <property name="focus_on_click">True</property>
-				</widget>
-			      </child>
-			    </widget>
-			    <packing>
-			      <property name="padding">0</property>
-			      <property name="expand">True</property>
-			      <property name="fill">True</property>
-			    </packing>
-			  </child>
-			</widget>
-			<packing>
-			  <property name="padding">0</property>
-			  <property name="expand">False</property>
-			  <property name="fill">False</property>
-			</packing>
-		      </child>
-		    </widget>
-		  </child>
-		</widget>
-		<packing>
-		  <property name="padding">0</property>
-		  <property name="expand">False</property>
-		  <property name="fill">False</property>
-		</packing>
-	      </child>
-
-	      <child>
-		<widget class="GtkDrawingArea" id="guiDrawing">
-		  <property name="width_request">496</property>
-		  <property name="height_request">288</property>
-		  <property name="visible">True</property>
-		  <property name="sensitive">False</property>
-		</widget>
-		<packing>
-		  <property name="padding">0</property>
-		  <property name="expand">True</property>
-		  <property name="fill">True</property>
-		</packing>
-	      </child>
-	    </widget>
-	    <packing>
-	      <property name="padding">0</property>
-	      <property name="expand">True</property>
-	      <property name="fill">True</property>
-	    </packing>
-	  </child>
-
-	  <child>
-	    <widget class="GtkTable" id="table2">
-	      <property name="border_width">3</property>
-	      <property name="visible">True</property>
-	      <property name="n_rows">3</property>
-	      <property name="n_columns">2</property>
-	      <property name="homogeneous">False</property>
-	      <property name="row_spacing">0</property>
-	      <property name="column_spacing">6</property>
-
-	      <child>
-		<widget class="GtkHBox" id="hbox16">
-		  <property name="visible">True</property>
-		  <property name="homogeneous">False</property>
-		  <property name="spacing">6</property>
-
-		  <child>
-		    <widget class="GtkLabel" id="label1">
-		      <property name="visible">True</property>
-		      <property name="label" translatable="yes">Frame: </property>
-		      <property name="use_underline">False</property>
-		      <property name="use_markup">False</property>
-		      <property name="justify">GTK_JUSTIFY_LEFT</property>
-		      <property name="wrap">False</property>
-		      <property name="selectable">False</property>
-		      <property name="xalign">0.5</property>
-		      <property name="yalign">0.5</property>
-		      <property name="xpad">0</property>
-		      <property name="ypad">0</property>
-		      <property name="ellipsize">PANGO_ELLIPSIZE_NONE</property>
-		      <property name="width_chars">-1</property>
-		      <property name="single_line_mode">False</property>
-		      <property name="angle">0</property>
-		    </widget>
-		    <packing>
-		      <property name="padding">0</property>
-		      <property name="expand">False</property>
-		      <property name="fill">False</property>
-		    </packing>
-		  </child>
-
-		  <child>
-		    <widget class="GtkEntry" id="boxCurFrame">
-		      <property name="visible">True</property>
-		      <property name="tooltip" translatable="yes">Current frame</property>
-		      <property name="can_focus">True</property>
-		      <property name="editable">True</property>
-		      <property name="visibility">True</property>
-		      <property name="max_length">8</property>
-		      <property name="text" translatable="yes">0</property>
-		      <property name="has_frame">True</property>
-		      <property name="invisible_char">*</property>
-		      <property name="activates_default">False</property>
-		      <property name="width_chars">8</property>
-		    </widget>
-		    <packing>
-		      <property name="padding">0</property>
-		      <property name="expand">False</property>
-		      <property name="fill">False</property>
-		    </packing>
-		  </child>
-
-		  <child>
-		    <widget class="GtkLabel" id="labelTotalFrame">
-		      <property name="visible">True</property>
-		      <property name="can_focus">True</property>
-		      <property name="label" translatable="yes">/ 0000000</property>
-		      <property name="use_underline">False</property>
-		      <property name="use_markup">False</property>
-		      <property name="justify">GTK_JUSTIFY_LEFT</property>
-		      <property name="wrap">False</property>
-		      <property name="selectable">True</property>
-		      <property name="xalign">0.5</property>
-		      <property name="yalign">0.5</property>
-		      <property name="xpad">5</property>
-		      <property name="ypad">0</property>
-		      <property name="ellipsize">PANGO_ELLIPSIZE_NONE</property>
-		      <property name="width_chars">-1</property>
-		      <property name="single_line_mode">False</property>
-		      <property name="angle">0</property>
-		    </widget>
-		    <packing>
-		      <property name="padding">0</property>
-		      <property name="expand">False</property>
-		      <property name="fill">False</property>
-		    </packing>
-		  </child>
-
-		  <child>
-		    <widget class="GtkLabel" id="label4">
-		      <property name="visible">True</property>
-		      <property name="label" translatable="yes">Time: </property>
-		      <property name="use_underline">False</property>
-		      <property name="use_markup">False</property>
-		      <property name="justify">GTK_JUSTIFY_LEFT</property>
-		      <property name="wrap">False</property>
-		      <property name="selectable">False</property>
-		      <property name="xalign">0.5</property>
-		      <property name="yalign">0.5</property>
-		      <property name="xpad">0</property>
-		      <property name="ypad">0</property>
-		      <property name="ellipsize">PANGO_ELLIPSIZE_NONE</property>
-		      <property name="width_chars">-1</property>
-		      <property name="single_line_mode">False</property>
-		      <property name="angle">0</property>
-		    </widget>
-		    <packing>
-		      <property name="padding">0</property>
-		      <property name="expand">False</property>
-		      <property name="fill">False</property>
-		    </packing>
-		  </child>
-
-		  <child>
-		    <widget class="GtkEntry" id="boxCurTime">
-		      <property name="visible">True</property>
-		      <property name="tooltip" translatable="yes">Current time</property>
-		      <property name="can_focus">True</property>
-		      <property name="editable">True</property>
-		      <property name="visibility">True</property>
-		      <property name="max_length">0</property>
-		      <property name="text" translatable="yes">00:00:00.000</property>
-		      <property name="has_frame">True</property>
-		      <property name="invisible_char">*</property>
-		      <property name="activates_default">False</property>
-		      <property name="width_chars">13</property>
-		    </widget>
-		    <packing>
-		      <property name="padding">0</property>
-		      <property name="expand">False</property>
-		      <property name="fill">False</property>
-		    </packing>
-		  </child>
-
-		  <child>
-		    <widget class="GtkLabel" id="labelTotalTime">
-		      <property name="visible">True</property>
-		      <property name="can_focus">True</property>
-		      <property name="label" translatable="yes">/ 00:00:00,000</property>
-		      <property name="use_underline">False</property>
-		      <property name="use_markup">False</property>
-		      <property name="justify">GTK_JUSTIFY_LEFT</property>
-		      <property name="wrap">False</property>
-		      <property name="selectable">True</property>
-		      <property name="xalign">0.5</property>
-		      <property name="yalign">0.5</property>
-		      <property name="xpad">5</property>
-		      <property name="ypad">0</property>
-		      <property name="ellipsize">PANGO_ELLIPSIZE_NONE</property>
-		      <property name="width_chars">-1</property>
-		      <property name="single_line_mode">False</property>
-		      <property name="angle">0</property>
-		    </widget>
-		    <packing>
-		      <property name="padding">0</property>
-		      <property name="expand">False</property>
-		      <property name="fill">False</property>
-		    </packing>
-		  </child>
-
-		  <child>
-		    <widget class="GtkLabel" id="labelFrameType">
-		      <property name="visible">True</property>
-		      <property name="can_focus">True</property>
-		      <property name="label" translatable="yes">Frame: ?</property>
-		      <property name="use_underline">False</property>
-		      <property name="use_markup">False</property>
-		      <property name="justify">GTK_JUSTIFY_LEFT</property>
-		      <property name="wrap">False</property>
-		      <property name="selectable">True</property>
-		      <property name="xalign">0.5</property>
-		      <property name="yalign">0.5</property>
-		      <property name="xpad">0</property>
-		      <property name="ypad">0</property>
-		      <property name="ellipsize">PANGO_ELLIPSIZE_NONE</property>
-		      <property name="width_chars">-1</property>
-		      <property name="single_line_mode">False</property>
-		      <property name="angle">0</property>
-		    </widget>
-		    <packing>
-		      <property name="padding">0</property>
-		      <property name="expand">False</property>
-		      <property name="fill">False</property>
-		    </packing>
-		  </child>
-		</widget>
-		<packing>
-		  <property name="left_attach">0</property>
-		  <property name="right_attach">1</property>
-		  <property name="top_attach">2</property>
-		  <property name="bottom_attach">3</property>
-		  <property name="y_options"></property>
-		</packing>
-	      </child>
-
-	      <child>
-		<widget class="GtkHScale" id="sliderNavigate">
-		  <property name="visible">True</property>
-		  <property name="draw_value">True</property>
-		  <property name="value_pos">GTK_POS_LEFT</property>
-		  <property name="digits">1</property>
-		  <property name="update_policy">GTK_UPDATE_CONTINUOUS</property>
-		  <property name="inverted">False</property>
-		  <property name="adjustment">0 0 99.9899978638 0.00999999977648 1 0</property>
-		</widget>
-		<packing>
-		  <property name="left_attach">0</property>
-		  <property name="right_attach">1</property>
-		  <property name="top_attach">0</property>
-		  <property name="bottom_attach">1</property>
-		</packing>
-	      </child>
-
-	      <child>
-		<widget class="GtkHBox" id="hbox10">
-		  <property name="visible">True</property>
-		  <property name="homogeneous">False</property>
-		  <property name="spacing">0</property>
-
-		  <child>
-		    <widget class="GtkButton" id="buttonPlay">
-		      <property name="visible">True</property>
-		      <property name="tooltip" translatable="yes">Play</property>
-		      <property name="relief">GTK_RELIEF_NONE</property>
-		      <property name="focus_on_click">False</property>
-		      <accelerator key="space" modifiers="0" signal="clicked"/>
-
-		      <child>
-			<widget class="GtkImage" id="image591">
-			  <property name="visible">True</property>
-			  <property name="pixbuf">play.xpm</property>
-			  <property name="xalign">0.5</property>
-			  <property name="yalign">0.5</property>
-			  <property name="xpad">0</property>
-			  <property name="ypad">0</property>
-			</widget>
-		      </child>
-		    </widget>
-		    <packing>
-		      <property name="padding">0</property>
-		      <property name="expand">False</property>
-		      <property name="fill">False</property>
-		    </packing>
-		  </child>
-
-		  <child>
-		    <widget class="GtkButton" id="buttonStop">
-		      <property name="visible">True</property>
-		      <property name="tooltip" translatable="yes">Stop</property>
-		      <property name="can_focus">True</property>
-		      <property name="relief">GTK_RELIEF_NONE</property>
-		      <property name="focus_on_click">False</property>
-
-		      <child>
-			<widget class="GtkImage" id="image5056">
-			  <property name="visible">True</property>
-			  <property name="pixbuf">stop.xpm</property>
-			  <property name="xalign">0.5</property>
-			  <property name="yalign">0.5</property>
-			  <property name="xpad">0</property>
-			  <property name="ypad">0</property>
-			</widget>
-		      </child>
-		    </widget>
-		    <packing>
-		      <property name="padding">0</property>
-		      <property name="expand">False</property>
-		      <property name="fill">False</property>
-		    </packing>
-		  </child>
-
-		  <child>
-		    <widget class="GtkButton" id="buttonPrevFrame">
-		      <property name="visible">True</property>
-		      <property name="tooltip" translatable="yes">Previous frame</property>
-		      <property name="relief">GTK_RELIEF_NONE</property>
-		      <property name="focus_on_click">False</property>
-		      <accelerator key="KP_4" modifiers="0" signal="clicked"/>
-
-		      <child>
-			<widget class="GtkImage" id="image593">
-			  <property name="visible">True</property>
-			  <property name="pixbuf">backward.xpm</property>
-			  <property name="xalign">0.5</property>
-			  <property name="yalign">0.5</property>
-			  <property name="xpad">0</property>
-			  <property name="ypad">0</property>
-			</widget>
-		      </child>
-		    </widget>
-		    <packing>
-		      <property name="padding">0</property>
-		      <property name="expand">False</property>
-		      <property name="fill">False</property>
-		    </packing>
-		  </child>
-
-		  <child>
-		    <widget class="GtkButton" id="buttonNextFrame">
-		      <property name="visible">True</property>
-		      <property name="tooltip" translatable="yes">Next frame</property>
-		      <property name="relief">GTK_RELIEF_NONE</property>
-		      <property name="focus_on_click">False</property>
-		      <accelerator key="KP_6" modifiers="0" signal="clicked"/>
-
-		      <child>
-			<widget class="GtkImage" id="image594">
-			  <property name="visible">True</property>
-			  <property name="pixbuf">forward.xpm</property>
-			  <property name="xalign">0.5</property>
-			  <property name="yalign">0.5</property>
-			  <property name="xpad">0</property>
-			  <property name="ypad">0</property>
-			</widget>
-		      </child>
-		    </widget>
-		    <packing>
-		      <property name="padding">0</property>
-		      <property name="expand">False</property>
-		      <property name="fill">False</property>
-		    </packing>
-		  </child>
-
-		  <child>
-		    <widget class="GtkButton" id="buttonPrevKFrame">
-		      <property name="visible">True</property>
-		      <property name="tooltip" translatable="yes">Previous keyframe</property>
-		      <property name="relief">GTK_RELIEF_NONE</property>
-		      <property name="focus_on_click">False</property>
-		      <accelerator key="KP_2" modifiers="0" signal="clicked"/>
-
-		      <child>
-			<widget class="GtkImage" id="image595">
-			  <property name="visible">True</property>
-			  <property name="pixbuf">Kbackward.xpm</property>
-			  <property name="xalign">0.5</property>
-			  <property name="yalign">0.5</property>
-			  <property name="xpad">0</property>
-			  <property name="ypad">0</property>
-			</widget>
-		      </child>
-		    </widget>
-		    <packing>
-		      <property name="padding">0</property>
-		      <property name="expand">False</property>
-		      <property name="fill">False</property>
-		    </packing>
-		  </child>
-
-		  <child>
-		    <widget class="GtkButton" id="buttonNextKFrame">
-		      <property name="visible">True</property>
-		      <property name="tooltip" translatable="yes">Next keyframe</property>
-		      <property name="relief">GTK_RELIEF_NONE</property>
-		      <property name="focus_on_click">False</property>
-		      <accelerator key="KP_8" modifiers="0" signal="clicked"/>
-
-		      <child>
-			<widget class="GtkImage" id="image596">
-			  <property name="visible">True</property>
-			  <property name="pixbuf">Kforward.xpm</property>
-			  <property name="xalign">0.5</property>
-			  <property name="yalign">0.5</property>
-			  <property name="xpad">0</property>
-			  <property name="ypad">0</property>
-			</widget>
-		      </child>
-		    </widget>
-		    <packing>
-		      <property name="padding">0</property>
-		      <property name="expand">False</property>
-		      <property name="fill">False</property>
-		    </packing>
-		  </child>
-
-		  <child>
-		    <widget class="GtkButton" id="buttonMarkA">
-		      <property name="visible">True</property>
-		      <property name="tooltip" translatable="yes">Selection: start</property>
-		      <property name="can_focus">True</property>
-		      <property name="relief">GTK_RELIEF_NONE</property>
-		      <property name="focus_on_click">False</property>
-
-		      <child>
-			<widget class="GtkImage" id="image2306">
-			  <property name="visible">True</property>
-			  <property name="pixbuf">markA.xpm</property>
-			  <property name="xalign">0.5</property>
-			  <property name="yalign">0.5</property>
-			  <property name="xpad">0</property>
-			  <property name="ypad">0</property>
-			</widget>
-		      </child>
-		    </widget>
-		    <packing>
-		      <property name="padding">0</property>
-		      <property name="expand">False</property>
-		      <property name="fill">False</property>
-		    </packing>
-		  </child>
-
-		  <child>
-		    <widget class="GtkButton" id="buttonMarkB">
-		      <property name="visible">True</property>
-		      <property name="tooltip" translatable="yes">Selection: end</property>
-		      <property name="can_focus">True</property>
-		      <property name="relief">GTK_RELIEF_NONE</property>
-		      <property name="focus_on_click">False</property>
-
-		      <child>
-			<widget class="GtkImage" id="image2307">
-			  <property name="visible">True</property>
-			  <property name="pixbuf">markB.xpm</property>
-			  <property name="xalign">0.5</property>
-			  <property name="yalign">0.5</property>
-			  <property name="xpad">0</property>
-			  <property name="ypad">0</property>
-			</widget>
-		      </child>
-		    </widget>
-		    <packing>
-		      <property name="padding">0</property>
-		      <property name="expand">False</property>
-		      <property name="fill">False</property>
-		    </packing>
-		  </child>
-
-		  <child>
-		    <widget class="GtkButton" id="buttonPrevBlack">
-		      <property name="visible">True</property>
-		      <property name="tooltip" translatable="yes">Previous black frame</property>
-		      <property name="can_focus">True</property>
-		      <property name="relief">GTK_RELIEF_NONE</property>
-		      <property name="focus_on_click">False</property>
-
-		      <child>
-			<widget class="GtkImage" id="image2308">
-			  <property name="visible">True</property>
-			  <property name="pixbuf">xpm_prevblack.xpm</property>
-			  <property name="xalign">0.5</property>
-			  <property name="yalign">0.5</property>
-			  <property name="xpad">0</property>
-			  <property name="ypad">0</property>
-			</widget>
-		      </child>
-		    </widget>
-		    <packing>
-		      <property name="padding">0</property>
-		      <property name="expand">False</property>
-		      <property name="fill">False</property>
-		    </packing>
-		  </child>
-
-		  <child>
-		    <widget class="GtkButton" id="buttonNextBlack">
-		      <property name="visible">True</property>
-		      <property name="tooltip" translatable="yes">Next black frame</property>
-		      <property name="can_focus">True</property>
-		      <property name="relief">GTK_RELIEF_NONE</property>
-		      <property name="focus_on_click">False</property>
-
-		      <child>
-			<widget class="GtkImage" id="image2309">
-			  <property name="visible">True</property>
-			  <property name="pixbuf">xpm_nextblack.xpm</property>
-			  <property name="xalign">0.5</property>
-			  <property name="yalign">0.5</property>
-			  <property name="xpad">0</property>
-			  <property name="ypad">0</property>
-			</widget>
-		      </child>
-		    </widget>
-		    <packing>
-		      <property name="padding">0</property>
-		      <property name="expand">False</property>
-		      <property name="fill">False</property>
-		    </packing>
-		  </child>
-
-		  <child>
-		    <widget class="GtkButton" id="buttonBegin">
-		      <property name="visible">True</property>
-		      <property name="tooltip" translatable="yes">First frame</property>
-		      <property name="can_focus">True</property>
-		      <property name="relief">GTK_RELIEF_NONE</property>
-		      <property name="focus_on_click">False</property>
-
-		      <child>
-			<widget class="GtkImage" id="image5057">
-			  <property name="visible">True</property>
-			  <property name="pixbuf">begin.xpm</property>
-			  <property name="xalign">0.5</property>
-			  <property name="yalign">0.5</property>
-			  <property name="xpad">0</property>
-			  <property name="ypad">0</property>
-			</widget>
-		      </child>
-		    </widget>
-		    <packing>
-		      <property name="padding">0</property>
-		      <property name="expand">False</property>
-		      <property name="fill">False</property>
-		    </packing>
-		  </child>
-
-		  <child>
-		    <widget class="GtkButton" id="buttonEnd">
-		      <property name="visible">True</property>
-		      <property name="tooltip" translatable="yes">Last frame</property>
-		      <property name="can_focus">True</property>
-		      <property name="relief">GTK_RELIEF_NONE</property>
-		      <property name="focus_on_click">False</property>
-
-		      <child>
-			<widget class="GtkImage" id="image2245">
-			  <property name="visible">True</property>
-			  <property name="pixbuf">end.xpm</property>
-			  <property name="xalign">0.5</property>
-			  <property name="yalign">0.5</property>
-			  <property name="xpad">0</property>
-			  <property name="ypad">0</property>
-			</widget>
-		      </child>
-		    </widget>
-		    <packing>
-		      <property name="padding">0</property>
-		      <property name="expand">False</property>
-		      <property name="fill">False</property>
-		    </packing>
-		  </child>
-		</widget>
-		<packing>
-		  <property name="left_attach">0</property>
-		  <property name="right_attach">1</property>
-		  <property name="top_attach">1</property>
-		  <property name="bottom_attach">2</property>
-		</packing>
-	      </child>
-
-	      <child>
-		<widget class="GtkVBox" id="vbox14">
-		  <property name="visible">True</property>
-		  <property name="homogeneous">False</property>
-		  <property name="spacing">0</property>
-
-		  <child>
-		    <widget class="GtkLabel" id="label21">
-		      <property name="visible">True</property>
-		      <property name="label" translatable="yes">&lt;b&gt;Selection&lt;/b&gt;</property>
-		      <property name="use_underline">False</property>
-		      <property name="use_markup">True</property>
-		      <property name="justify">GTK_JUSTIFY_LEFT</property>
-		      <property name="wrap">False</property>
-		      <property name="selectable">False</property>
-		      <property name="xalign">0</property>
-		      <property name="yalign">0.5</property>
-		      <property name="xpad">0</property>
-		      <property name="ypad">0</property>
-		      <property name="ellipsize">PANGO_ELLIPSIZE_NONE</property>
-		      <property name="width_chars">-1</property>
-		      <property name="single_line_mode">False</property>
-		      <property name="angle">0</property>
-		    </widget>
-		    <packing>
-		      <property name="padding">0</property>
-		      <property name="expand">False</property>
-		      <property name="fill">False</property>
-		    </packing>
-		  </child>
-
-		  <child>
-		    <widget class="GtkAlignment" id="alignment15">
-		      <property name="visible">True</property>
-		      <property name="xalign">0.5</property>
-		      <property name="yalign">0.5</property>
-		      <property name="xscale">1</property>
-		      <property name="yscale">1</property>
-		      <property name="top_padding">3</property>
-		      <property name="bottom_padding">0</property>
-		      <property name="left_padding">12</property>
-		      <property name="right_padding">0</property>
-
-		      <child>
-			<widget class="GtkTable" id="table1">
-			  <property name="visible">True</property>
-			  <property name="n_rows">2</property>
-			  <property name="n_columns">2</property>
-			  <property name="homogeneous">False</property>
-			  <property name="row_spacing">3</property>
-			  <property name="column_spacing">3</property>
-
-			  <child>
-			    <widget class="GtkButton" id="buttonGotoB">
-			      <property name="height_request">20</property>
-			      <property name="visible">True</property>
-			      <property name="tooltip" translatable="yes">Go to marker B</property>
-			      <property name="label" translatable="yes">B:</property>
-			      <property name="use_underline">True</property>
-			      <property name="relief">GTK_RELIEF_NORMAL</property>
-			      <property name="focus_on_click">True</property>
-			    </widget>
-			    <packing>
-			      <property name="left_attach">0</property>
-			      <property name="right_attach">1</property>
-			      <property name="top_attach">1</property>
-			      <property name="bottom_attach">2</property>
-			      <property name="x_options"></property>
-			      <property name="y_options"></property>
-			    </packing>
-			  </child>
-
-			  <child>
-			    <widget class="GtkButton" id="buttonGotoA">
-			      <property name="height_request">20</property>
-			      <property name="visible">True</property>
-			      <property name="tooltip" translatable="yes">Go to marker A</property>
-			      <property name="label" translatable="yes">A:</property>
-			      <property name="use_underline">True</property>
-			      <property name="relief">GTK_RELIEF_NORMAL</property>
-			      <property name="focus_on_click">True</property>
-			    </widget>
-			    <packing>
-			      <property name="left_attach">0</property>
-			      <property name="right_attach">1</property>
-			      <property name="top_attach">0</property>
-			      <property name="bottom_attach">1</property>
-			      <property name="x_options"></property>
-			      <property name="y_options"></property>
-			    </packing>
-			  </child>
-
-			  <child>
-			    <widget class="GtkLabel" id="labelMarkB">
-			      <property name="visible">True</property>
-			      <property name="can_focus">True</property>
-			      <property name="label" translatable="yes"> 0000000</property>
-			      <property name="use_underline">False</property>
-			      <property name="use_markup">False</property>
-			      <property name="justify">GTK_JUSTIFY_LEFT</property>
-			      <property name="wrap">False</property>
-			      <property name="selectable">True</property>
-			      <property name="xalign">0.5</property>
-			      <property name="yalign">0.5</property>
-			      <property name="xpad">0</property>
-			      <property name="ypad">0</property>
-			      <property name="ellipsize">PANGO_ELLIPSIZE_NONE</property>
-			      <property name="width_chars">-1</property>
-			      <property name="single_line_mode">False</property>
-			      <property name="angle">0</property>
-			    </widget>
-			    <packing>
-			      <property name="left_attach">1</property>
-			      <property name="right_attach">2</property>
-			      <property name="top_attach">1</property>
-			      <property name="bottom_attach">2</property>
-			      <property name="x_options"></property>
-			      <property name="y_options"></property>
-			    </packing>
-			  </child>
-
-			  <child>
-			    <widget class="GtkLabel" id="labelMarkA">
-			      <property name="visible">True</property>
-			      <property name="can_focus">True</property>
-			      <property name="label" translatable="yes"> 0000000</property>
-			      <property name="use_underline">False</property>
-			      <property name="use_markup">False</property>
-			      <property name="justify">GTK_JUSTIFY_LEFT</property>
-			      <property name="wrap">False</property>
-			      <property name="selectable">True</property>
-			      <property name="xalign">0.5</property>
-			      <property name="yalign">0.5</property>
-			      <property name="xpad">0</property>
-			      <property name="ypad">0</property>
-			      <property name="ellipsize">PANGO_ELLIPSIZE_NONE</property>
-			      <property name="width_chars">-1</property>
-			      <property name="single_line_mode">False</property>
-			      <property name="angle">0</property>
-			    </widget>
-			    <packing>
-			      <property name="left_attach">1</property>
-			      <property name="right_attach">2</property>
-			      <property name="top_attach">0</property>
-			      <property name="bottom_attach">1</property>
-			      <property name="x_options"></property>
-			      <property name="y_options"></property>
-			    </packing>
-			  </child>
-			</widget>
-		      </child>
-		    </widget>
-		    <packing>
-		      <property name="padding">0</property>
-		      <property name="expand">True</property>
-		      <property name="fill">True</property>
-		    </packing>
-		  </child>
-		</widget>
-		<packing>
-		  <property name="left_attach">1</property>
-		  <property name="right_attach">2</property>
-		  <property name="top_attach">1</property>
-		  <property name="bottom_attach">3</property>
-		  <property name="x_options"></property>
-		  <property name="y_options"></property>
-		</packing>
-	      </child>
-
-	      <child>
-		<widget class="Custom" id="jogg">
-		  <property name="visible">True</property>
-		  <property name="creation_function">jog_shuttle_new</property>
-		  <property name="int1">0</property>
-		  <property name="int2">0</property>
-		  <property name="last_modification_time">Sun, 07 Oct 2007 12:58:40 GMT</property>
-		</widget>
-		<packing>
-		  <property name="left_attach">1</property>
-		  <property name="right_attach">2</property>
-		  <property name="top_attach">0</property>
-		  <property name="bottom_attach">1</property>
-		  <property name="x_options">fill</property>
-		  <property name="y_options">expand</property>
-		</packing>
-	      </child>
-	    </widget>
-	    <packing>
-	      <property name="padding">0</property>
-	      <property name="expand">False</property>
-	      <property name="fill">False</property>
-	    </packing>
-	  </child>
-	</widget>
-	<packing>
-	  <property name="padding">0</property>
-	  <property name="expand">True</property>
-	  <property name="fill">True</property>
-	</packing>
-      </child>
-    </widget>
-  </child>
-</widget>
-
+  <widget class="GtkWindow" id="mainWindow">
+    <property name="visible">True</property>
+    <property name="title" translatable="yes">Avidemux</property>
+    <property name="icon">avidemux_icon_small.png</property>
+    <child>
+      <widget class="GtkVBox" id="vbox1">
+        <property name="visible">True</property>
+        <child>
+          <widget class="GtkMenuBar" id="menuBar">
+            <property name="visible">True</property>
+            <property name="can_focus">True</property>
+            <child>
+              <widget class="GtkMenuItem" id="menuitem1">
+                <property name="visible">True</property>
+                <property name="label" translatable="yes">_File</property>
+                <property name="use_underline">True</property>
+                <child>
+                  <widget class="GtkMenu" id="menuitem1_menu">
+                    <child>
+                      <widget class="GtkImageMenuItem" id="open_video1">
+                        <property name="visible">True</property>
+                        <property name="label" translatable="yes">_Open...</property>
+                        <property name="use_underline">True</property>
+                        <accelerator key="O" modifiers="GDK_CONTROL_MASK" signal="activate"/>
+                        <child internal-child="image">
+                          <widget class="GtkImage" id="image8523">
+                            <property name="visible">True</property>
+                            <property name="stock">gtk-open</property>
+                            <property name="icon_size">1</property>
+                          </widget>
+                        </child>
+                      </widget>
+                    </child>
+                    <child>
+                      <widget class="GtkImageMenuItem" id="append_video1">
+                        <property name="visible">True</property>
+                        <property name="label" translatable="yes">_Append...</property>
+                        <property name="use_underline">True</property>
+                        <accelerator key="A" modifiers="GDK_CONTROL_MASK | GDK_MOD1_MASK" signal="activate"/>
+                        <child internal-child="image">
+                          <widget class="GtkImage" id="image8524">
+                            <property name="visible">True</property>
+                            <property name="stock">gtk-add</property>
+                            <property name="icon_size">1</property>
+                          </widget>
+                        </child>
+                      </widget>
+                    </child>
+                    <child>
+                      <widget class="GtkImageMenuItem" id="save_stuff">
+                        <property name="visible">True</property>
+                        <property name="label" translatable="yes">_Save</property>
+                        <property name="use_underline">True</property>
+                        <child>
+                          <widget class="GtkMenu" id="save_stuff_menu">
+                            <child>
+                              <widget class="GtkMenuItem" id="save_as_avi1">
+                                <property name="visible">True</property>
+                                <property name="label" translatable="yes">Save _Video...</property>
+                                <property name="use_underline">True</property>
+                                <accelerator key="S" modifiers="GDK_CONTROL_MASK" signal="activate"/>
+                              </widget>
+                            </child>
+                            <child>
+                              <widget class="GtkSeparatorMenuItem" id="separator1">
+                                <property name="visible">True</property>
+                              </widget>
+                            </child>
+                            <child>
+                              <widget class="GtkMenuItem" id="save_image1">
+                                <property name="visible">True</property>
+                                <property name="label" translatable="yes">Save _BMP Image...</property>
+                                <property name="use_underline">True</property>
+                              </widget>
+                            </child>
+                            <child>
+                              <widget class="GtkMenuItem" id="save_jpg_image1">
+                                <property name="visible">True</property>
+                                <property name="label" translatable="yes">Save _JPEG Image...</property>
+                                <property name="use_underline">True</property>
+                              </widget>
+                            </child>
+                            <child>
+                              <widget class="GtkMenuItem" id="save_selection_as_jpegs1">
+                                <property name="visible">True</property>
+                                <property name="label" translatable="yes">Save _Selection as JPEG Images...</property>
+                                <property name="use_underline">True</property>
+                              </widget>
+                            </child>
+                          </widget>
+                        </child>
+                        <child internal-child="image">
+                          <widget class="GtkImage" id="image8525">
+                            <property name="visible">True</property>
+                            <property name="stock">gtk-save</property>
+                            <property name="icon_size">1</property>
+                          </widget>
+                        </child>
+                      </widget>
+                    </child>
+                    <child>
+                      <widget class="GtkImageMenuItem" id="close1">
+                        <property name="visible">True</property>
+                        <property name="label">gtk-close</property>
+                        <property name="use_underline">True</property>
+                        <property name="use_stock">True</property>
+                      </widget>
+                    </child>
+                    <child>
+                      <widget class="GtkSeparatorMenuItem" id="separator3">
+                        <property name="visible">True</property>
+                      </widget>
+                    </child>
+                    <child>
+                      <widget class="GtkImageMenuItem" id="save_project1">
+                        <property name="visible">True</property>
+                        <property name="label" translatable="yes">Save _Project</property>
+                        <property name="use_underline">True</property>
+                        <child internal-child="image">
+                          <widget class="GtkImage" id="image8526">
+                            <property name="visible">True</property>
+                            <property name="stock">gtk-save</property>
+                            <property name="icon_size">1</property>
+                          </widget>
+                        </child>
+                      </widget>
+                    </child>
+                    <child>
+                      <widget class="GtkImageMenuItem" id="save_project_as1">
+                        <property name="visible">True</property>
+                        <property name="label" translatable="yes">Save P_roject As...</property>
+                        <property name="use_underline">True</property>
+                        <child internal-child="image">
+                          <widget class="GtkImage" id="image8527">
+                            <property name="visible">True</property>
+                            <property name="stock">gtk-save-as</property>
+                            <property name="icon_size">1</property>
+                          </widget>
+                        </child>
+                      </widget>
+                    </child>
+                    <child>
+                      <widget class="GtkImageMenuItem" id="run_script1">
+                        <property name="visible">True</property>
+                        <property name="label" translatable="yes">_Load/Run Project...</property>
+                        <property name="use_underline">True</property>
+                        <child internal-child="image">
+                          <widget class="GtkImage" id="image8528">
+                            <property name="visible">True</property>
+                            <property name="stock">gtk-execute</property>
+                            <property name="icon_size">1</property>
+                          </widget>
+                        </child>
+                      </widget>
+                    </child>
+                    <child>
+                      <widget class="GtkMenuItem" id="add_to_joblist1">
+                        <property name="visible">True</property>
+                        <property name="label" translatable="yes">A_dd to Joblist...</property>
+                        <property name="use_underline">True</property>
+                      </widget>
+                    </child>
+                    <child>
+                      <widget class="GtkMenuItem" id="joblist1">
+                        <property name="visible">True</property>
+                        <property name="label" translatable="yes">Show _Joblist</property>
+                        <property name="use_underline">True</property>
+                        <accelerator key="J" modifiers="GDK_CONTROL_MASK" signal="activate"/>
+                      </widget>
+                    </child>
+                    <child>
+                      <widget class="GtkSeparatorMenuItem" id="separator16">
+                        <property name="visible">True</property>
+                      </widget>
+                    </child>
+                    <child>
+                      <widget class="GtkMenuItem" id="connect_to_avsproxy1">
+                        <property name="visible">True</property>
+                        <property name="label" translatable="yes">Co_nnect to avsproxy</property>
+                        <property name="use_underline">True</property>
+                      </widget>
+                    </child>
+                    <child>
+                      <widget class="GtkSeparatorMenuItem" id="separator18">
+                        <property name="visible">True</property>
+                      </widget>
+                    </child>
+                    <child>
+                      <widget class="GtkImageMenuItem" id="video_informations1">
+                        <property name="visible">True</property>
+                        <property name="label" translatable="yes">Proper_ties</property>
+                        <property name="use_underline">True</property>
+                        <accelerator key="Return" modifiers="GDK_MOD1_MASK" signal="activate"/>
+                        <child internal-child="image">
+                          <widget class="GtkImage" id="image8529">
+                            <property name="visible">True</property>
+                            <property name="stock">gtk-properties</property>
+                            <property name="icon_size">1</property>
+                          </widget>
+                        </child>
+                      </widget>
+                    </child>
+                    <child>
+                      <widget class="GtkMenuItem" id="avi_muxer_options1">
+                        <property name="visible">True</property>
+                        <property name="label" translatable="yes">AVI _Muxer Options</property>
+                        <property name="use_underline">True</property>
+                      </widget>
+                    </child>
+                    <child>
+                      <widget class="GtkSeparatorMenuItem" id="separator4">
+                        <property name="visible">True</property>
+                      </widget>
+                    </child>
+                    <child>
+                      <widget class="GtkImageMenuItem" id="quit1">
+                        <property name="visible">True</property>
+                        <property name="label" translatable="yes">_Quit</property>
+                        <property name="use_underline">True</property>
+                        <accelerator key="Q" modifiers="GDK_CONTROL_MASK" signal="activate"/>
+                        <child internal-child="image">
+                          <widget class="GtkImage" id="image8530">
+                            <property name="visible">True</property>
+                            <property name="stock">gtk-quit</property>
+                            <property name="icon_size">1</property>
+                          </widget>
+                        </child>
+                      </widget>
+                    </child>
+                  </widget>
+                </child>
+              </widget>
+            </child>
+            <child>
+              <widget class="GtkMenuItem" id="menuitem2">
+                <property name="visible">True</property>
+                <property name="label" translatable="yes">_Edit</property>
+                <property name="use_underline">True</property>
+                <child>
+                  <widget class="GtkMenu" id="menuitem2_menu">
+                    <child>
+                      <widget class="GtkImageMenuItem" id="reset_edits1">
+                        <property name="visible">True</property>
+                        <property name="label" translatable="yes">_Reset Edits</property>
+                        <property name="use_underline">True</property>
+                        <child internal-child="image">
+                          <widget class="GtkImage" id="image8531">
+                            <property name="visible">True</property>
+                            <property name="stock">gtk-undo</property>
+                            <property name="icon_size">1</property>
+                          </widget>
+                        </child>
+                      </widget>
+                    </child>
+                    <child>
+                      <widget class="GtkSeparatorMenuItem" id="separator5">
+                        <property name="visible">True</property>
+                      </widget>
+                    </child>
+                    <child>
+                      <widget class="GtkImageMenuItem" id="cut1">
+                        <property name="visible">True</property>
+                        <property name="label" translatable="yes">Cu_t</property>
+                        <property name="use_underline">True</property>
+                        <accelerator key="X" modifiers="GDK_CONTROL_MASK" signal="activate"/>
+                        <child internal-child="image">
+                          <widget class="GtkImage" id="image8532">
+                            <property name="visible">True</property>
+                            <property name="stock">gtk-cut</property>
+                            <property name="icon_size">1</property>
+                          </widget>
+                        </child>
+                      </widget>
+                    </child>
+                    <child>
+                      <widget class="GtkImageMenuItem" id="copy1">
+                        <property name="visible">True</property>
+                        <property name="label" translatable="yes">_Copy</property>
+                        <property name="use_underline">True</property>
+                        <accelerator key="C" modifiers="GDK_CONTROL_MASK" signal="activate"/>
+                        <child internal-child="image">
+                          <widget class="GtkImage" id="image8533">
+                            <property name="visible">True</property>
+                            <property name="stock">gtk-copy</property>
+                            <property name="icon_size">1</property>
+                          </widget>
+                        </child>
+                      </widget>
+                    </child>
+                    <child>
+                      <widget class="GtkImageMenuItem" id="paste1">
+                        <property name="visible">True</property>
+                        <property name="label" translatable="yes">_Paste</property>
+                        <property name="use_underline">True</property>
+                        <accelerator key="V" modifiers="GDK_CONTROL_MASK" signal="activate"/>
+                        <child internal-child="image">
+                          <widget class="GtkImage" id="image8534">
+                            <property name="visible">True</property>
+                            <property name="stock">gtk-paste</property>
+                            <property name="icon_size">1</property>
+                          </widget>
+                        </child>
+                      </widget>
+                    </child>
+                    <child>
+                      <widget class="GtkImageMenuItem" id="delete1">
+                        <property name="visible">True</property>
+                        <property name="label" translatable="yes">_Delete</property>
+                        <property name="use_underline">True</property>
+                        <accelerator key="Delete" modifiers="" signal="activate"/>
+                        <child internal-child="image">
+                          <widget class="GtkImage" id="image8535">
+                            <property name="visible">True</property>
+                            <property name="stock">gtk-remove</property>
+                            <property name="icon_size">1</property>
+                          </widget>
+                        </child>
+                      </widget>
+                    </child>
+                    <child>
+                      <widget class="GtkSeparatorMenuItem" id="separator6">
+                        <property name="visible">True</property>
+                      </widget>
+                    </child>
+                    <child>
+                      <widget class="GtkMenuItem" id="set_marker_a1">
+                        <property name="visible">True</property>
+                        <property name="label" translatable="yes">Set Marker _A</property>
+                        <property name="use_underline">True</property>
+                        <accelerator key="bracketleft" modifiers="" signal="activate"/>
+                      </widget>
+                    </child>
+                    <child>
+                      <widget class="GtkMenuItem" id="set_marker_b1">
+                        <property name="visible">True</property>
+                        <property name="label" translatable="yes">Set Marker _B</property>
+                        <property name="use_underline">True</property>
+                        <accelerator key="bracketright" modifiers="" signal="activate"/>
+                      </widget>
+                    </child>
+                    <child>
+                      <widget class="GtkSeparatorMenuItem" id="separator7">
+                        <property name="visible">True</property>
+                      </widget>
+                    </child>
+                    <child>
+                      <widget class="GtkImageMenuItem" id="preferences1">
+                        <property name="visible">True</property>
+                        <property name="label" translatable="yes">Pre_ferences</property>
+                        <property name="use_underline">True</property>
+                        <child internal-child="image">
+                          <widget class="GtkImage" id="image8536">
+                            <property name="visible">True</property>
+                            <property name="stock">gtk-preferences</property>
+                            <property name="icon_size">1</property>
+                          </widget>
+                        </child>
+                      </widget>
+                    </child>
+                  </widget>
+                </child>
+              </widget>
+            </child>
+            <child>
+              <widget class="GtkMenuItem" id="view1">
+                <property name="visible">True</property>
+                <property name="label" translatable="yes">_View</property>
+                <property name="use_underline">True</property>
+                <child>
+                  <widget class="GtkMenu" id="view1_menu">
+                    <child>
+                      <widget class="GtkCheckMenuItem" id="toolbar1">
+                        <property name="visible">True</property>
+                        <property name="label" translatable="yes">_Main Toolbar</property>
+                        <property name="use_underline">True</property>
+                        <property name="active">True</property>
+                      </widget>
+                    </child>
+                    <child>
+                      <widget class="GtkCheckMenuItem" id="sidebar1">
+                        <property name="visible">True</property>
+                        <property name="label" translatable="yes">_A/V Sidebar</property>
+                        <property name="use_underline">True</property>
+                        <property name="active">True</property>
+                      </widget>
+                    </child>
+                    <child>
+                      <widget class="GtkSeparatorMenuItem" id="separator8">
+                        <property name="visible">True</property>
+                      </widget>
+                    </child>
+                    <child>
+                      <widget class="GtkMenuItem" id="zoom_1_4">
+                        <property name="visible">True</property>
+                        <property name="label" translatable="yes">_Zoom 1:4</property>
+                        <property name="use_underline">True</property>
+                        <accelerator key="4" modifiers="GDK_SHIFT_MASK | GDK_CONTROL_MASK" signal="activate"/>
+                      </widget>
+                    </child>
+                    <child>
+                      <widget class="GtkMenuItem" id="zoom_1_2">
+                        <property name="visible">True</property>
+                        <property name="label" translatable="yes">Z_oom 1:2</property>
+                        <property name="use_underline">True</property>
+                        <accelerator key="2" modifiers="GDK_SHIFT_MASK | GDK_CONTROL_MASK" signal="activate"/>
+                      </widget>
+                    </child>
+                    <child>
+                      <widget class="GtkMenuItem" id="zoom_1_1">
+                        <property name="visible">True</property>
+                        <property name="label" translatable="yes">Zoom _1:1</property>
+                        <property name="use_underline">True</property>
+                        <accelerator key="1" modifiers="GDK_CONTROL_MASK | GDK_MOD1_MASK" signal="activate"/>
+                      </widget>
+                    </child>
+                    <child>
+                      <widget class="GtkMenuItem" id="zoom_2_1">
+                        <property name="visible">True</property>
+                        <property name="label" translatable="yes">Zoom _2:1</property>
+                        <property name="use_underline">True</property>
+                        <accelerator key="2" modifiers="GDK_CONTROL_MASK | GDK_MOD1_MASK" signal="activate"/>
+                      </widget>
+                    </child>
+                  </widget>
+                </child>
+              </widget>
+            </child>
+            <child>
+              <widget class="GtkMenuItem" id="video_1">
+                <property name="visible">True</property>
+                <property name="label" translatable="yes">Vi_deo</property>
+                <property name="use_underline">True</property>
+                <child>
+                  <widget class="GtkMenu" id="video_1_menu">
+                    <child>
+                      <widget class="GtkMenuItem" id="decoder_options1">
+                        <property name="visible">True</property>
+                        <property name="label" translatable="yes">_Decoder Options</property>
+                        <property name="use_underline">True</property>
+                        <accelerator key="F3" modifiers="" signal="activate"/>
+                      </widget>
+                    </child>
+                    <child>
+                      <widget class="GtkMenuItem" id="set_postprocessing1">
+                        <property name="visible">True</property>
+                        <property name="tooltip" translatable="yes">Select postprocessing level</property>
+                        <property name="label" translatable="yes">_Postprocessing</property>
+                        <property name="use_underline">True</property>
+                        <accelerator key="F4" modifiers="" signal="activate"/>
+                      </widget>
+                    </child>
+                    <child>
+                      <widget class="GtkSeparatorMenuItem" id="separator9">
+                        <property name="visible">True</property>
+                      </widget>
+                    </child>
+                    <child>
+                      <widget class="GtkCheckMenuItem" id="preview1">
+                        <property name="visible">True</property>
+                        <property name="label" translatable="yes">P_review</property>
+                        <property name="use_underline">True</property>
+                        <accelerator key="F5" modifiers="" signal="activate"/>
+                      </widget>
+                    </child>
+                    <child>
+                      <widget class="GtkCheckMenuItem" id="display_output1">
+                        <property name="visible">True</property>
+                        <property name="label" translatable="yes">Display _Output</property>
+                        <property name="use_underline">True</property>
+                        <accelerator key="F6" modifiers="" signal="activate"/>
+                      </widget>
+                    </child>
+                    <child>
+                      <widget class="GtkSeparatorMenuItem" id="separator10">
+                        <property name="visible">True</property>
+                      </widget>
+                    </child>
+                    <child>
+                      <widget class="GtkMenuItem" id="change_fps">
+                        <property name="visible">True</property>
+                        <property name="label" translatable="yes">_Frame Rate</property>
+                        <property name="use_underline">True</property>
+                      </widget>
+                    </child>
+                    <child>
+                      <widget class="GtkMenuItem" id="videoencoder">
+                        <property name="visible">True</property>
+                        <property name="label" translatable="yes">_Encoder</property>
+                        <property name="use_underline">True</property>
+                        <accelerator key="V" modifiers="GDK_CONTROL_MASK | GDK_MOD1_MASK" signal="activate"/>
+                      </widget>
+                    </child>
+                    <child>
+                      <widget class="GtkMenuItem" id="filters1">
+                        <property name="visible">True</property>
+                        <property name="label" translatable="yes">Fil_ters</property>
+                        <property name="use_underline">True</property>
+                        <accelerator key="F" modifiers="GDK_CONTROL_MASK | GDK_MOD1_MASK" signal="activate"/>
+                      </widget>
+                    </child>
+                  </widget>
+                </child>
+              </widget>
+            </child>
+            <child>
+              <widget class="GtkMenuItem" id="audio1">
+                <property name="visible">True</property>
+                <property name="label" translatable="yes">_Audio</property>
+                <property name="use_underline">True</property>
+                <child>
+                  <widget class="GtkMenu" id="audio1_menu">
+                    <child>
+                      <widget class="GtkMenuItem" id="main_audio">
+                        <property name="visible">True</property>
+                        <property name="label" translatable="yes">_Main Track</property>
+                        <property name="use_underline">True</property>
+                      </widget>
+                    </child>
+                    <child>
+                      <widget class="GtkMenuItem" id="second_audio_track1">
+                        <property name="visible">True</property>
+                        <property name="label" translatable="yes">_Second Track</property>
+                        <property name="use_underline">True</property>
+                      </widget>
+                    </child>
+                    <child>
+                      <widget class="GtkMenuItem" id="build_vbr_time_map1">
+                        <property name="visible">True</property>
+                        <property name="label" translatable="yes">_Build VBR Time Map</property>
+                        <property name="use_underline">True</property>
+                      </widget>
+                    </child>
+                    <child>
+                      <widget class="GtkSeparatorMenuItem" id="separator11">
+                        <property name="visible">True</property>
+                      </widget>
+                    </child>
+                    <child>
+                      <widget class="GtkImageMenuItem" id="save_audio1">
+                        <property name="visible">True</property>
+                        <property name="label" translatable="yes">S_ave...</property>
+                        <property name="use_underline">True</property>
+                        <accelerator key="S" modifiers="GDK_CONTROL_MASK | GDK_MOD1_MASK" signal="activate"/>
+                        <child internal-child="image">
+                          <widget class="GtkImage" id="image8537">
+                            <property name="visible">True</property>
+                            <property name="stock">gtk-save-as</property>
+                            <property name="icon_size">1</property>
+                          </widget>
+                        </child>
+                      </widget>
+                    </child>
+                    <child>
+                      <widget class="GtkMenuItem" id="audio_encoder1">
+                        <property name="visible">True</property>
+                        <property name="label" translatable="yes">_Encoder</property>
+                        <property name="use_underline">True</property>
+                        <accelerator key="A" modifiers="GDK_CONTROL_MASK | GDK_MOD1_MASK" signal="activate"/>
+                      </widget>
+                    </child>
+                    <child>
+                      <widget class="GtkMenuItem" id="filters2">
+                        <property name="visible">True</property>
+                        <property name="label" translatable="yes">_Filters</property>
+                        <property name="use_underline">True</property>
+                      </widget>
+                    </child>
+                  </widget>
+                </child>
+              </widget>
+            </child>
+            <child>
+              <widget class="GtkMenuItem" id="tools1">
+                <property name="visible">True</property>
+                <property name="label" translatable="yes">_Tools</property>
+                <property name="use_underline">True</property>
+                <child>
+                  <widget class="GtkMenu" id="tools1_menu">
+                    <child>
+                      <widget class="GtkImageMenuItem" id="calculator1">
+                        <property name="visible">True</property>
+                        <property name="label" translatable="yes">_Calculator</property>
+                        <property name="use_underline">True</property>
+                        <accelerator key="F7" modifiers="" signal="activate"/>
+                        <child internal-child="image">
+                          <widget class="GtkImage" id="image8538">
+                            <property name="visible">True</property>
+                            <property name="pixbuf">gnome-calculator_small.xpm</property>
+                          </widget>
+                        </child>
+                      </widget>
+                    </child>
+                    <child>
+                      <widget class="GtkSeparatorMenuItem" id="separator12">
+                        <property name="visible">True</property>
+                      </widget>
+                    </child>
+                    <child>
+                      <widget class="GtkMenuItem" id="rebuild_frames">
+                        <property name="visible">True</property>
+                        <property name="label" translatable="yes">_Rebuild Frames (I &amp; B)</property>
+                        <property name="use_underline">True</property>
+                      </widget>
+                    </child>
+                    <child>
+                      <widget class="GtkMenuItem" id="check_frames">
+                        <property name="visible">True</property>
+                        <property name="label" translatable="yes">C_heck Frames (slow)</property>
+                        <property name="use_underline">True</property>
+                      </widget>
+                    </child>
+                    <child>
+                      <widget class="GtkMenuItem" id="bitrate_histogram1">
+                        <property name="visible">True</property>
+                        <property name="label" translatable="yes">_Bitrate Histogram</property>
+                        <property name="use_underline">True</property>
+                      </widget>
+                    </child>
+                    <child>
+                      <widget class="GtkMenuItem" id="item1">
+                        <property name="visible">True</property>
+                        <property name="label" translatable="yes">_Scan for Black Frames...</property>
+                        <property name="use_underline">True</property>
+                      </widget>
+                    </child>
+                    <child>
+                      <widget class="GtkSeparatorMenuItem" id="separator13">
+                        <property name="visible">True</property>
+                      </widget>
+                    </child>
+                    <child>
+                      <widget class="GtkMenuItem" id="v2v">
+                        <property name="visible">True</property>
+                        <property name="label" translatable="yes">_VOB -&gt; VobSub</property>
+                        <property name="use_underline">True</property>
+                      </widget>
+                    </child>
+                    <child>
+                      <widget class="GtkMenuItem" id="ocr_vobsub_2_srt">
+                        <property name="visible">True</property>
+                        <property name="label" translatable="yes">_OCR (VobSub -&gt; srt)</property>
+                        <property name="use_underline">True</property>
+                      </widget>
+                    </child>
+                    <child>
+                      <widget class="GtkMenuItem" id="ocr_dvb">
+                        <property name="visible">True</property>
+                        <property name="label" translatable="yes">OCR (TS-&gt;srt)</property>
+                        <property name="use_underline">True</property>
+                      </widget>
+                    </child>
+                    <child>
+                      <widget class="GtkMenuItem" id="edit_glyph1">
+                        <property name="visible">True</property>
+                        <property name="label" translatable="yes">_Edit Glyph</property>
+                        <property name="use_underline">True</property>
+                      </widget>
+                    </child>
+                    <child>
+                      <widget class="GtkSeparatorMenuItem" id="separator17">
+                        <property name="visible">True</property>
+                      </widget>
+                    </child>
+                    <child>
+                      <widget class="GtkMenuItem" id="see_hex1">
+                        <property name="visible">True</property>
+                        <property name="label" translatable="yes">_Frame Hex Dump</property>
+                        <property name="use_underline">True</property>
+                      </widget>
+                    </child>
+                  </widget>
+                </child>
+              </widget>
+            </child>
+            <child>
+              <widget class="GtkMenuItem" id="help1">
+                <property name="visible">True</property>
+                <property name="label" translatable="yes">A_uto</property>
+                <property name="use_underline">True</property>
+                <child>
+                  <widget class="GtkMenu" id="help1_menu">
+                    <child>
+                      <widget class="GtkMenuItem" id="vcd1">
+                        <property name="visible">True</property>
+                        <property name="label" translatable="yes">_VCD</property>
+                        <property name="use_underline">True</property>
+                      </widget>
+                    </child>
+                    <child>
+                      <widget class="GtkMenuItem" id="svcd1">
+                        <property name="visible">True</property>
+                        <property name="label" translatable="yes">_SVCD</property>
+                        <property name="use_underline">True</property>
+                      </widget>
+                    </child>
+                    <child>
+                      <widget class="GtkMenuItem" id="dvd1">
+                        <property name="visible">True</property>
+                        <property name="label" translatable="yes">_DVD</property>
+                        <property name="use_underline">True</property>
+                      </widget>
+                    </child>
+                    <child>
+                      <widget class="GtkMenuItem" id="psp1">
+                        <property name="visible">True</property>
+                        <property name="label" translatable="yes">_PSP</property>
+                        <property name="use_underline">True</property>
+                      </widget>
+                    </child>
+                    <child>
+                      <widget class="GtkMenuItem" id="psp_(h264)1">
+                        <property name="visible">True</property>
+                        <property name="label" translatable="yes">PSP (_H.264)</property>
+                        <property name="use_underline">True</property>
+                      </widget>
+                    </child>
+                    <child>
+                      <widget class="GtkMenuItem" id="flv1">
+                        <property name="visible">True</property>
+                        <property name="label" translatable="yes">F_LV</property>
+                        <property name="use_underline">True</property>
+                      </widget>
+                    </child>
+                    <child>
+                      <widget class="GtkMenuItem" id="Ipod">
+                        <property name="visible">True</property>
+                        <property name="label" translatable="yes">IPOD (mpeg4)</property>
+                        <property name="use_underline">True</property>
+                      </widget>
+                    </child>
+                  </widget>
+                </child>
+              </widget>
+            </child>
+            <child>
+              <widget class="GtkMenuItem" id="go1">
+                <property name="visible">True</property>
+                <property name="label" translatable="yes">_Go</property>
+                <property name="use_underline">True</property>
+                <child>
+                  <widget class="GtkMenu" id="go1_menu">
+                    <child>
+                      <widget class="GtkImageMenuItem" id="play_video1">
+                        <property name="visible">True</property>
+                        <property name="label" translatable="yes">_Play/Stop</property>
+                        <property name="use_underline">True</property>
+                        <accelerator key="P" modifiers="" signal="activate"/>
+                        <child internal-child="image">
+                          <widget class="GtkImage" id="image8539">
+                            <property name="visible">True</property>
+                            <property name="stock">gtk-media-play</property>
+                            <property name="icon_size">1</property>
+                          </widget>
+                        </child>
+                      </widget>
+                    </child>
+                    <child>
+                      <widget class="GtkImageMenuItem" id="previous_frame1">
+                        <property name="visible">True</property>
+                        <property name="label" translatable="yes">P_revious Frame</property>
+                        <property name="use_underline">True</property>
+                        <accelerator key="KP_4" modifiers="" signal="activate"/>
+                        <child internal-child="image">
+                          <widget class="GtkImage" id="image8540">
+                            <property name="visible">True</property>
+                            <property name="stock">gtk-media-previous</property>
+                            <property name="icon_size">1</property>
+                          </widget>
+                        </child>
+                      </widget>
+                    </child>
+                    <child>
+                      <widget class="GtkImageMenuItem" id="next_frame1">
+                        <property name="visible">True</property>
+                        <property name="label" translatable="yes">_Next Frame</property>
+                        <property name="use_underline">True</property>
+                        <accelerator key="KP_6" modifiers="" signal="activate"/>
+                        <child internal-child="image">
+                          <widget class="GtkImage" id="image8541">
+                            <property name="visible">True</property>
+                            <property name="stock">gtk-media-next</property>
+                            <property name="icon_size">1</property>
+                          </widget>
+                        </child>
+                      </widget>
+                    </child>
+                    <child>
+                      <widget class="GtkImageMenuItem" id="previous_intra_frame1">
+                        <property name="visible">True</property>
+                        <property name="label" translatable="yes">Pr_evious Intra Frame</property>
+                        <property name="use_underline">True</property>
+                        <accelerator key="KP_2" modifiers="" signal="activate"/>
+                        <child internal-child="image">
+                          <widget class="GtkImage" id="image8542">
+                            <property name="visible">True</property>
+                            <property name="stock">gtk-media-rewind</property>
+                            <property name="icon_size">1</property>
+                          </widget>
+                        </child>
+                      </widget>
+                    </child>
+                    <child>
+                      <widget class="GtkImageMenuItem" id="next_intra_frame1">
+                        <property name="visible">True</property>
+                        <property name="label" translatable="yes">Next _Intra Frame</property>
+                        <property name="use_underline">True</property>
+                        <accelerator key="KP_8" modifiers="" signal="activate"/>
+                        <child internal-child="image">
+                          <widget class="GtkImage" id="image8543">
+                            <property name="visible">True</property>
+                            <property name="stock">gtk-media-forward</property>
+                            <property name="icon_size">1</property>
+                          </widget>
+                        </child>
+                      </widget>
+                    </child>
+                    <child>
+                      <widget class="GtkMenuItem" id="search_previous_black_frame1">
+                        <property name="visible">True</property>
+                        <property name="label" translatable="yes">Previou_s Black Frame</property>
+                        <property name="use_underline">True</property>
+                      </widget>
+                    </child>
+                    <child>
+                      <widget class="GtkMenuItem" id="search_next_black_frame1">
+                        <property name="visible">True</property>
+                        <property name="label" translatable="yes">Ne_xt Black Frame</property>
+                        <property name="use_underline">True</property>
+                      </widget>
+                    </child>
+                    <child>
+                      <widget class="GtkImageMenuItem" id="first_frame1">
+                        <property name="visible">True</property>
+                        <property name="label" translatable="yes">_First Frame</property>
+                        <property name="use_underline">True</property>
+                        <accelerator key="Home" modifiers="" signal="activate"/>
+                        <child internal-child="image">
+                          <widget class="GtkImage" id="image8544">
+                            <property name="visible">True</property>
+                            <property name="stock">gtk-goto-first</property>
+                            <property name="icon_size">1</property>
+                          </widget>
+                        </child>
+                      </widget>
+                    </child>
+                    <child>
+                      <widget class="GtkImageMenuItem" id="last_frame1">
+                        <property name="visible">True</property>
+                        <property name="label" translatable="yes">_Last Frame</property>
+                        <property name="use_underline">True</property>
+                        <accelerator key="End" modifiers="" signal="activate"/>
+                        <child internal-child="image">
+                          <widget class="GtkImage" id="image8545">
+                            <property name="visible">True</property>
+                            <property name="stock">gtk-goto-last</property>
+                            <property name="icon_size">1</property>
+                          </widget>
+                        </child>
+                      </widget>
+                    </child>
+                    <child>
+                      <widget class="GtkSeparatorMenuItem" id="separator14">
+                        <property name="visible">True</property>
+                      </widget>
+                    </child>
+                    <child>
+                      <widget class="GtkMenuItem" id="go_to_marker_a1">
+                        <property name="visible">True</property>
+                        <property name="label" translatable="yes">Go to Marker _A</property>
+                        <property name="use_underline">True</property>
+                        <accelerator key="bracketleft" modifiers="GDK_CONTROL_MASK" signal="activate"/>
+                      </widget>
+                    </child>
+                    <child>
+                      <widget class="GtkMenuItem" id="go_to_marker_b1">
+                        <property name="visible">True</property>
+                        <property name="label" translatable="yes">Go to Marker _B</property>
+                        <property name="use_underline">True</property>
+                        <accelerator key="bracketright" modifiers="GDK_CONTROL_MASK" signal="activate"/>
+                      </widget>
+                    </child>
+                    <child>
+                      <widget class="GtkSeparatorMenuItem" id="separator15">
+                        <property name="visible">True</property>
+                      </widget>
+                    </child>
+                    <child>
+                      <widget class="GtkImageMenuItem" id="jum_to_frame1">
+                        <property name="visible">True</property>
+                        <property name="label" translatable="yes">Go to Fra_me...</property>
+                        <property name="use_underline">True</property>
+                        <accelerator key="F" modifiers="GDK_CONTROL_MASK" signal="activate"/>
+                        <child internal-child="image">
+                          <widget class="GtkImage" id="image8546">
+                            <property name="visible">True</property>
+                            <property name="stock">gtk-jump-to</property>
+                            <property name="icon_size">1</property>
+                          </widget>
+                        </child>
+                      </widget>
+                    </child>
+                    <child>
+                      <widget class="GtkImageMenuItem" id="jump_to_time1">
+                        <property name="visible">True</property>
+                        <property name="label" translatable="yes">Go to _Time...</property>
+                        <property name="use_underline">True</property>
+                        <accelerator key="T" modifiers="GDK_CONTROL_MASK" signal="activate"/>
+                        <child internal-child="image">
+                          <widget class="GtkImage" id="image8547">
+                            <property name="visible">True</property>
+                            <property name="stock">gtk-jump-to</property>
+                            <property name="icon_size">1</property>
+                          </widget>
+                        </child>
+                      </widget>
+                    </child>
+                  </widget>
+                </child>
+              </widget>
+            </child>
+            <child>
+              <widget class="GtkMenuItem" id="custom1">
+                <property name="visible">True</property>
+                <property name="label" translatable="yes">_Custom</property>
+                <property name="use_underline">True</property>
+              </widget>
+            </child>
+            <child>
+              <widget class="GtkMenuItem" id="help2">
+                <property name="visible">True</property>
+                <property name="label" translatable="yes">_Help</property>
+                <property name="use_underline">True</property>
+                <child>
+                  <widget class="GtkMenu" id="help2_menu">
+                    <child>
+                      <widget class="GtkMenuItem" id="plugins1">
+                        <property name="visible">True</property>
+                        <property name="label" translatable="yes">_Plugins</property>
+                        <property name="use_underline">True</property>
+                        <signal name="activate" handler="on_plugins1_activate"/>
+                      </widget>
+                    </child>
+                    <child>
+                      <widget class="GtkMenuItem" id="show_builtin_support1">
+                        <property name="visible">True</property>
+                        <property name="label" translatable="yes">_Built-in Support</property>
+                        <property name="use_underline">True</property>
+                      </widget>
+                    </child>
+                    <child>
+                      <widget class="GtkImageMenuItem" id="about1">
+                        <property name="visible">True</property>
+                        <property name="label" translatable="yes">_About</property>
+                        <property name="use_underline">True</property>
+                        <child internal-child="image">
+                          <widget class="GtkImage" id="image8548">
+                            <property name="visible">True</property>
+                            <property name="stock">gtk-about</property>
+                            <property name="icon_size">1</property>
+                          </widget>
+                        </child>
+                      </widget>
+                    </child>
+                  </widget>
+                </child>
+              </widget>
+            </child>
+          </widget>
+          <packing>
+            <property name="expand">False</property>
+            <property name="fill">False</property>
+          </packing>
+        </child>
+        <child>
+          <widget class="GtkToolbar" id="toolbar2">
+            <property name="visible">True</property>
+            <property name="toolbar_style">GTK_TOOLBAR_BOTH_HORIZ</property>
+            <child>
+              <widget class="GtkMenuToolButton" id="menutoolbuttonOpen">
+                <property name="visible">True</property>
+                <property name="tooltip" translatable="yes">Open a file</property>
+                <property name="is_important">True</property>
+                <property name="stock_id">gtk-open</property>
+              </widget>
+              <packing>
+                <property name="expand">False</property>
+                <property name="homogeneous">False</property>
+              </packing>
+            </child>
+            <child>
+              <widget class="GtkToolItem" id="toolitem11">
+                <property name="visible">True</property>
+              </widget>
+              <packing>
+                <property name="expand">False</property>
+                <property name="homogeneous">False</property>
+              </packing>
+            </child>
+            <child>
+              <widget class="GtkToolButton" id="toolbuttonSave">
+                <property name="visible">True</property>
+                <property name="tooltip" translatable="yes">Save the file</property>
+                <property name="is_important">True</property>
+                <property name="stock_id">gtk-save</property>
+              </widget>
+              <packing>
+                <property name="expand">False</property>
+              </packing>
+            </child>
+            <child>
+              <widget class="GtkToolButton" id="toolbuttonInfo">
+                <property name="visible">True</property>
+                <property name="tooltip" translatable="yes">Audio/video file information</property>
+                <property name="stock_id">gtk-properties</property>
+              </widget>
+              <packing>
+                <property name="expand">False</property>
+              </packing>
+            </child>
+            <child>
+              <widget class="GtkSeparatorToolItem" id="separatortoolitem1">
+                <property name="visible">True</property>
+              </widget>
+              <packing>
+                <property name="expand">False</property>
+                <property name="homogeneous">False</property>
+              </packing>
+            </child>
+            <child>
+              <widget class="GtkToolButton" id="toolbuttonCalc">
+                <property name="visible">True</property>
+                <property name="tooltip" translatable="yes">Bitrate/size calculator</property>
+                <property name="is_important">True</property>
+                <property name="label" translatable="yes">Calculator</property>
+                <property name="use_underline">True</property>
+                <property name="icon">gnome-calculator.png</property>
+              </widget>
+              <packing>
+                <property name="expand">False</property>
+              </packing>
+            </child>
+            <child>
+              <widget class="GtkSeparatorToolItem" id="separatortoolitem2">
+                <property name="visible">True</property>
+              </widget>
+              <packing>
+                <property name="expand">False</property>
+                <property name="homogeneous">False</property>
+              </packing>
+            </child>
+            <child>
+              <widget class="GtkToolItem" id="toolitem12">
+                <property name="visible">True</property>
+                <child>
+                  <widget class="GtkComboBox" id="comboboxPreview">
+                    <property name="visible">True</property>
+                    <property name="items" translatable="yes"></property>
+                  </widget>
+                </child>
+              </widget>
+              <packing>
+                <property name="expand">False</property>
+                <property name="homogeneous">False</property>
+              </packing>
+            </child>
+            <child>
+              <widget class="GtkToolItem" id="toolitem13">
+                <property name="visible">True</property>
+                <child>
+                  <widget class="GtkToggleButton" id="togglebutton1">
+                    <property name="visible">True</property>
+                    <property name="can_focus">True</property>
+                    <property name="relief">GTK_RELIEF_NONE</property>
+                    <property name="response_id">0</property>
+                    <child>
+                      <widget class="GtkImage" id="image8272">
+                        <property name="width_request">17</property>
+                        <property name="height_request">16</property>
+                        <property name="visible">True</property>
+                        <property name="pixbuf">audio-volume-medium.png</property>
+                      </widget>
+                    </child>
+                  </widget>
+                </child>
+              </widget>
+              <packing>
+                <property name="expand">False</property>
+                <property name="homogeneous">False</property>
+              </packing>
+            </child>
+            <child>
+              <widget class="GtkToolItem" id="toolitem14">
+                <property name="visible">True</property>
+                <child>
+                  <widget class="GtkHScale" id="hscalVolume">
+                    <property name="width_request">100</property>
+                    <property name="visible">True</property>
+                    <property name="can_focus">True</property>
+                    <property name="adjustment">99 0 100 1 1 1</property>
+                    <property name="digits">0</property>
+                    <property name="draw_value">False</property>
+                  </widget>
+                </child>
+              </widget>
+              <packing>
+                <property name="expand">False</property>
+                <property name="homogeneous">False</property>
+              </packing>
+            </child>
+          </widget>
+          <packing>
+            <property name="expand">False</property>
+            <property name="fill">False</property>
+            <property name="position">1</property>
+          </packing>
+        </child>
+        <child>
+          <widget class="GtkVBox" id="vbox10">
+            <property name="visible">True</property>
+            <property name="spacing">3</property>
+            <child>
+              <widget class="GtkHBox" id="hbox14">
+                <property name="visible">True</property>
+                <child>
+                  <widget class="GtkAlignment" id="alignment19">
+                    <property name="visible">True</property>
+                    <property name="top_padding">3</property>
+                    <property name="left_padding">3</property>
+                    <child>
+                      <widget class="GtkVBox" id="vbox9">
+                        <property name="visible">True</property>
+                        <property name="spacing">9</property>
+                        <child>
+                          <widget class="GtkVBox" id="vbox11">
+                            <property name="visible">True</property>
+                            <child>
+                              <widget class="GtkLabel" id="label18">
+                                <property name="visible">True</property>
+                                <property name="xalign">0</property>
+                                <property name="label" translatable="yes">&lt;b&gt;Video&lt;/b&gt;</property>
+                                <property name="use_markup">True</property>
+                              </widget>
+                              <packing>
+                                <property name="expand">False</property>
+                                <property name="fill">False</property>
+                              </packing>
+                            </child>
+                            <child>
+                              <widget class="GtkAlignment" id="alignment12">
+                                <property name="visible">True</property>
+                                <property name="top_padding">3</property>
+                                <property name="left_padding">12</property>
+                                <child>
+                                  <widget class="GtkVBox" id="vbox7">
+                                    <property name="visible">True</property>
+                                    <property name="spacing">3</property>
+                                    <child>
+                                      <widget class="GtkComboBox" id="comboboxVideo">
+                                        <property name="visible">True</property>
+                                        <property name="items" translatable="yes">Copy</property>
+                                      </widget>
+                                      <packing>
+                                        <property name="expand">False</property>
+                                        <property name="fill">False</property>
+                                      </packing>
+                                    </child>
+                                    <child>
+                                      <widget class="GtkButton" id="buttonConfV">
+                                        <property name="visible">True</property>
+                                        <property name="can_focus">True</property>
+                                        <property name="tooltip" translatable="yes">Configure video encoder</property>
+                                        <property name="label" translatable="yes">Configure</property>
+                                        <property name="use_underline">True</property>
+                                        <property name="response_id">0</property>
+                                        <accelerator key="F3" modifiers="" signal="clicked"/>
+                                      </widget>
+                                      <packing>
+                                        <property name="expand">False</property>
+                                        <property name="fill">False</property>
+                                        <property name="position">1</property>
+                                      </packing>
+                                    </child>
+                                    <child>
+                                      <widget class="GtkButton" id="buttonFilters">
+                                        <property name="visible">True</property>
+                                        <property name="can_focus">True</property>
+                                        <property name="tooltip" translatable="yes">Video filters</property>
+                                        <property name="label" translatable="yes">Filters</property>
+                                        <property name="use_underline">True</property>
+                                        <property name="response_id">0</property>
+                                        <accelerator key="F1" modifiers="" signal="clicked"/>
+                                      </widget>
+                                      <packing>
+                                        <property name="expand">False</property>
+                                        <property name="fill">False</property>
+                                        <property name="position">2</property>
+                                      </packing>
+                                    </child>
+                                  </widget>
+                                </child>
+                              </widget>
+                              <packing>
+                                <property name="position">1</property>
+                              </packing>
+                            </child>
+                          </widget>
+                          <packing>
+                            <property name="expand">False</property>
+                            <property name="fill">False</property>
+                          </packing>
+                        </child>
+                        <child>
+                          <widget class="GtkVBox" id="vbox12">
+                            <property name="visible">True</property>
+                            <child>
+                              <widget class="GtkLabel" id="label19">
+                                <property name="visible">True</property>
+                                <property name="xalign">0</property>
+                                <property name="label" translatable="yes">&lt;b&gt;Audio&lt;/b&gt;</property>
+                                <property name="use_markup">True</property>
+                              </widget>
+                              <packing>
+                                <property name="expand">False</property>
+                                <property name="fill">False</property>
+                              </packing>
+                            </child>
+                            <child>
+                              <widget class="GtkAlignment" id="alignment13">
+                                <property name="visible">True</property>
+                                <property name="top_padding">3</property>
+                                <property name="left_padding">12</property>
+                                <child>
+                                  <widget class="GtkVBox" id="vbox8">
+                                    <property name="visible">True</property>
+                                    <property name="spacing">3</property>
+                                    <child>
+                                      <widget class="GtkComboBox" id="comboboxAudio">
+                                        <property name="visible">True</property>
+                                        <property name="items" translatable="yes">Copy</property>
+                                      </widget>
+                                      <packing>
+                                        <property name="expand">False</property>
+                                        <property name="fill">False</property>
+                                      </packing>
+                                    </child>
+                                    <child>
+                                      <widget class="GtkButton" id="buttonConfA">
+                                        <property name="visible">True</property>
+                                        <property name="can_focus">True</property>
+                                        <property name="tooltip" translatable="yes">Configure audio encoder</property>
+                                        <property name="label" translatable="yes">Configure</property>
+                                        <property name="use_underline">True</property>
+                                        <property name="response_id">0</property>
+                                        <accelerator key="F4" modifiers="" signal="clicked"/>
+                                      </widget>
+                                      <packing>
+                                        <property name="expand">False</property>
+                                        <property name="fill">False</property>
+                                        <property name="position">1</property>
+                                      </packing>
+                                    </child>
+                                    <child>
+                                      <widget class="GtkButton" id="buttonAudioFilter">
+                                        <property name="visible">True</property>
+                                        <property name="can_focus">True</property>
+                                        <property name="tooltip" translatable="yes">Audio filters</property>
+                                        <property name="response_id">0</property>
+                                        <accelerator key="F2" modifiers="" signal="clicked"/>
+                                        <child>
+                                          <widget class="GtkAlignment" id="alignment16">
+                                            <property name="visible">True</property>
+                                            <property name="xscale">0</property>
+                                            <property name="yscale">0</property>
+                                            <child>
+                                              <widget class="GtkHBox" id="hbox18">
+                                                <property name="visible">True</property>
+                                                <property name="spacing">2</property>
+                                                <child>
+                                                  <widget class="GtkLabel" id="label22">
+                                                    <property name="visible">True</property>
+                                                    <property name="label" translatable="yes">Filters</property>
+                                                    <property name="use_underline">True</property>
+                                                  </widget>
+                                                  <packing>
+                                                    <property name="expand">False</property>
+                                                    <property name="fill">False</property>
+                                                  </packing>
+                                                </child>
+                                              </widget>
+                                            </child>
+                                          </widget>
+                                        </child>
+                                      </widget>
+                                      <packing>
+                                        <property name="expand">False</property>
+                                        <property name="fill">False</property>
+                                        <property name="position">2</property>
+                                      </packing>
+                                    </child>
+                                    <child>
+                                      <widget class="GtkHBox" id="hbox19">
+                                        <property name="visible">True</property>
+                                        <property name="spacing">6</property>
+                                        <child>
+                                          <widget class="GtkCheckButton" id="CheckButtonTimeshift">
+                                            <property name="visible">True</property>
+                                            <property name="can_focus">True</property>
+                                            <property name="tooltip" translatable="yes">Enable time shift</property>
+                                            <property name="label" translatable="yes">Shift:</property>
+                                            <property name="use_underline">True</property>
+                                            <property name="response_id">0</property>
+                                            <property name="draw_indicator">True</property>
+                                          </widget>
+                                          <packing>
+                                            <property name="expand">False</property>
+                                            <property name="fill">False</property>
+                                          </packing>
+                                        </child>
+                                        <child>
+                                          <widget class="GtkSpinButton" id="spinbuttonTimeShift">
+                                            <property name="visible">True</property>
+                                            <property name="can_focus">True</property>
+                                            <property name="tooltip" translatable="yes">Audio/video time shift (ms)</property>
+                                            <property name="adjustment">0 -99999 99999 1 10 10</property>
+                                            <property name="climb_rate">1</property>
+                                            <property name="numeric">True</property>
+                                          </widget>
+                                          <packing>
+                                            <property name="position">1</property>
+                                          </packing>
+                                        </child>
+                                      </widget>
+                                      <packing>
+                                        <property name="position">3</property>
+                                      </packing>
+                                    </child>
+                                  </widget>
+                                </child>
+                              </widget>
+                              <packing>
+                                <property name="position">1</property>
+                              </packing>
+                            </child>
+                          </widget>
+                          <packing>
+                            <property name="expand">False</property>
+                            <property name="fill">False</property>
+                            <property name="position">1</property>
+                          </packing>
+                        </child>
+                        <child>
+                          <widget class="GtkVBox" id="vbox13">
+                            <property name="visible">True</property>
+                            <child>
+                              <widget class="GtkLabel" id="label20">
+                                <property name="visible">True</property>
+                                <property name="xalign">0</property>
+                                <property name="label" translatable="yes">&lt;b&gt;Format&lt;/b&gt;</property>
+                                <property name="use_markup">True</property>
+                              </widget>
+                              <packing>
+                                <property name="expand">False</property>
+                                <property name="fill">False</property>
+                              </packing>
+                            </child>
+                            <child>
+                              <widget class="GtkAlignment" id="alignment1">
+                                <property name="visible">True</property>
+                                <property name="top_padding">3</property>
+                                <property name="left_padding">12</property>
+                                <child>
+                                  <widget class="GtkVBox" id="vbox2">
+                                    <property name="visible">True</property>
+                                    <property name="spacing">3</property>
+                                    <child>
+                                      <widget class="GtkComboBox" id="comboboxFormat">
+                                        <property name="visible">True</property>
+                                        <property name="items" translatable="yes">Copy</property>
+                                      </widget>
+                                      <packing>
+                                        <property name="expand">False</property>
+                                        <property name="fill">False</property>
+                                      </packing>
+                                    </child>
+                                    <child>
+                                      <widget class="GtkButton" id="buttonConfF">
+                                        <property name="visible">True</property>
+                                        <property name="can_focus">True</property>
+                                        <property name="tooltip" translatable="yes">Configure video encoder</property>
+                                        <property name="label" translatable="yes">Configure</property>
+                                        <property name="use_underline">True</property>
+                                        <property name="response_id">0</property>
+                                        <accelerator key="F3" modifiers="" signal="clicked"/>
+                                      </widget>
+                                      <packing>
+                                        <property name="expand">False</property>
+                                        <property name="fill">False</property>
+                                        <property name="position">1</property>
+                                      </packing>
+                                    </child>
+                                  </widget>
+                                </child>
+                              </widget>
+                              <packing>
+                                <property name="position">1</property>
+                              </packing>
+                            </child>
+                          </widget>
+                          <packing>
+                            <property name="expand">False</property>
+                            <property name="fill">False</property>
+                            <property name="position">2</property>
+                          </packing>
+                        </child>
+                      </widget>
+                    </child>
+                  </widget>
+                  <packing>
+                    <property name="expand">False</property>
+                    <property name="fill">False</property>
+                  </packing>
+                </child>
+                <child>
+                  <widget class="GtkDrawingArea" id="guiDrawing">
+                    <property name="width_request">496</property>
+                    <property name="height_request">288</property>
+                    <property name="visible">True</property>
+                    <property name="sensitive">False</property>
+                  </widget>
+                  <packing>
+                    <property name="position">1</property>
+                  </packing>
+                </child>
+              </widget>
+            </child>
+            <child>
+              <widget class="GtkTable" id="table2">
+                <property name="visible">True</property>
+                <property name="border_width">3</property>
+                <property name="n_rows">3</property>
+                <property name="n_columns">2</property>
+                <property name="column_spacing">6</property>
+                <child>
+                  <widget class="Custom" id="jogg">
+                    <property name="visible">True</property>
+                    <property name="creation_function">jog_shuttle_new</property>
+                  </widget>
+                  <packing>
+                    <property name="left_attach">1</property>
+                    <property name="right_attach">2</property>
+                    <property name="x_options">GTK_FILL</property>
+                    <property name="y_options">GTK_EXPAND</property>
+                  </packing>
+                </child>
+                <child>
+                  <widget class="GtkVBox" id="vbox14">
+                    <property name="visible">True</property>
+                    <child>
+                      <widget class="GtkLabel" id="label21">
+                        <property name="visible">True</property>
+                        <property name="xalign">0</property>
+                        <property name="label" translatable="yes">&lt;b&gt;Selection&lt;/b&gt;</property>
+                        <property name="use_markup">True</property>
+                      </widget>
+                      <packing>
+                        <property name="expand">False</property>
+                        <property name="fill">False</property>
+                      </packing>
+                    </child>
+                    <child>
+                      <widget class="GtkAlignment" id="alignment15">
+                        <property name="visible">True</property>
+                        <property name="top_padding">3</property>
+                        <property name="left_padding">12</property>
+                        <child>
+                          <widget class="GtkTable" id="table1">
+                            <property name="visible">True</property>
+                            <property name="n_rows">2</property>
+                            <property name="n_columns">2</property>
+                            <property name="column_spacing">3</property>
+                            <property name="row_spacing">3</property>
+                            <child>
+                              <widget class="GtkLabel" id="labelMarkA">
+                                <property name="visible">True</property>
+                                <property name="can_focus">True</property>
+                                <property name="label" translatable="yes"> 0000000</property>
+                                <property name="selectable">True</property>
+                              </widget>
+                              <packing>
+                                <property name="left_attach">1</property>
+                                <property name="right_attach">2</property>
+                                <property name="x_options"></property>
+                                <property name="y_options"></property>
+                              </packing>
+                            </child>
+                            <child>
+                              <widget class="GtkLabel" id="labelMarkB">
+                                <property name="visible">True</property>
+                                <property name="can_focus">True</property>
+                                <property name="label" translatable="yes"> 0000000</property>
+                                <property name="selectable">True</property>
+                              </widget>
+                              <packing>
+                                <property name="left_attach">1</property>
+                                <property name="right_attach">2</property>
+                                <property name="top_attach">1</property>
+                                <property name="bottom_attach">2</property>
+                                <property name="x_options"></property>
+                                <property name="y_options"></property>
+                              </packing>
+                            </child>
+                            <child>
+                              <widget class="GtkButton" id="buttonGotoA">
+                                <property name="height_request">20</property>
+                                <property name="visible">True</property>
+                                <property name="tooltip" translatable="yes">Go to marker A</property>
+                                <property name="label" translatable="yes">A:</property>
+                                <property name="use_underline">True</property>
+                                <property name="response_id">0</property>
+                              </widget>
+                              <packing>
+                                <property name="x_options"></property>
+                                <property name="y_options"></property>
+                              </packing>
+                            </child>
+                            <child>
+                              <widget class="GtkButton" id="buttonGotoB">
+                                <property name="height_request">20</property>
+                                <property name="visible">True</property>
+                                <property name="tooltip" translatable="yes">Go to marker B</property>
+                                <property name="label" translatable="yes">B:</property>
+                                <property name="use_underline">True</property>
+                                <property name="response_id">0</property>
+                              </widget>
+                              <packing>
+                                <property name="top_attach">1</property>
+                                <property name="bottom_attach">2</property>
+                                <property name="x_options"></property>
+                                <property name="y_options"></property>
+                              </packing>
+                            </child>
+                          </widget>
+                        </child>
+                      </widget>
+                      <packing>
+                        <property name="position">1</property>
+                      </packing>
+                    </child>
+                  </widget>
+                  <packing>
+                    <property name="left_attach">1</property>
+                    <property name="right_attach">2</property>
+                    <property name="top_attach">1</property>
+                    <property name="bottom_attach">3</property>
+                    <property name="x_options"></property>
+                    <property name="y_options"></property>
+                  </packing>
+                </child>
+                <child>
+                  <widget class="GtkHBox" id="hbox10">
+                    <property name="visible">True</property>
+                    <child>
+                      <widget class="GtkButton" id="buttonPlay">
+                        <property name="visible">True</property>
+                        <property name="tooltip" translatable="yes">Play</property>
+                        <property name="relief">GTK_RELIEF_NONE</property>
+                        <property name="focus_on_click">False</property>
+                        <property name="response_id">0</property>
+                        <accelerator key="space" modifiers="" signal="clicked"/>
+                        <child>
+                          <widget class="GtkImage" id="image591">
+                            <property name="visible">True</property>
+                            <property name="pixbuf">play.xpm</property>
+                          </widget>
+                        </child>
+                      </widget>
+                      <packing>
+                        <property name="expand">False</property>
+                        <property name="fill">False</property>
+                      </packing>
+                    </child>
+                    <child>
+                      <widget class="GtkButton" id="buttonStop">
+                        <property name="visible">True</property>
+                        <property name="can_focus">True</property>
+                        <property name="tooltip" translatable="yes">Stop</property>
+                        <property name="relief">GTK_RELIEF_NONE</property>
+                        <property name="focus_on_click">False</property>
+                        <property name="response_id">0</property>
+                        <child>
+                          <widget class="GtkImage" id="image5056">
+                            <property name="visible">True</property>
+                            <property name="pixbuf">stop.xpm</property>
+                          </widget>
+                        </child>
+                      </widget>
+                      <packing>
+                        <property name="expand">False</property>
+                        <property name="fill">False</property>
+                        <property name="position">1</property>
+                      </packing>
+                    </child>
+                    <child>
+                      <widget class="GtkButton" id="buttonPrevFrame">
+                        <property name="visible">True</property>
+                        <property name="tooltip" translatable="yes">Previous frame</property>
+                        <property name="relief">GTK_RELIEF_NONE</property>
+                        <property name="focus_on_click">False</property>
+                        <property name="response_id">0</property>
+                        <accelerator key="KP_4" modifiers="" signal="clicked"/>
+                        <child>
+                          <widget class="GtkImage" id="image593">
+                            <property name="visible">True</property>
+                            <property name="pixbuf">backward.xpm</property>
+                          </widget>
+                        </child>
+                      </widget>
+                      <packing>
+                        <property name="expand">False</property>
+                        <property name="fill">False</property>
+                        <property name="position">2</property>
+                      </packing>
+                    </child>
+                    <child>
+                      <widget class="GtkButton" id="buttonNextFrame">
+                        <property name="visible">True</property>
+                        <property name="tooltip" translatable="yes">Next frame</property>
+                        <property name="relief">GTK_RELIEF_NONE</property>
+                        <property name="focus_on_click">False</property>
+                        <property name="response_id">0</property>
+                        <accelerator key="KP_6" modifiers="" signal="clicked"/>
+                        <child>
+                          <widget class="GtkImage" id="image594">
+                            <property name="visible">True</property>
+                            <property name="pixbuf">forward.xpm</property>
+                          </widget>
+                        </child>
+                      </widget>
+                      <packing>
+                        <property name="expand">False</property>
+                        <property name="fill">False</property>
+                        <property name="position">3</property>
+                      </packing>
+                    </child>
+                    <child>
+                      <widget class="GtkButton" id="buttonPrevKFrame">
+                        <property name="visible">True</property>
+                        <property name="tooltip" translatable="yes">Previous keyframe</property>
+                        <property name="relief">GTK_RELIEF_NONE</property>
+                        <property name="focus_on_click">False</property>
+                        <property name="response_id">0</property>
+                        <accelerator key="KP_2" modifiers="" signal="clicked"/>
+                        <child>
+                          <widget class="GtkImage" id="image595">
+                            <property name="visible">True</property>
+                            <property name="pixbuf">Kbackward.xpm</property>
+                          </widget>
+                        </child>
+                      </widget>
+                      <packing>
+                        <property name="expand">False</property>
+                        <property name="fill">False</property>
+                        <property name="position">4</property>
+                      </packing>
+                    </child>
+                    <child>
+                      <widget class="GtkButton" id="buttonNextKFrame">
+                        <property name="visible">True</property>
+                        <property name="tooltip" translatable="yes">Next keyframe</property>
+                        <property name="relief">GTK_RELIEF_NONE</property>
+                        <property name="focus_on_click">False</property>
+                        <property name="response_id">0</property>
+                        <accelerator key="KP_8" modifiers="" signal="clicked"/>
+                        <child>
+                          <widget class="GtkImage" id="image596">
+                            <property name="visible">True</property>
+                            <property name="pixbuf">Kforward.xpm</property>
+                          </widget>
+                        </child>
+                      </widget>
+                      <packing>
+                        <property name="expand">False</property>
+                        <property name="fill">False</property>
+                        <property name="position">5</property>
+                      </packing>
+                    </child>
+                    <child>
+                      <widget class="GtkButton" id="buttonMarkA">
+                        <property name="visible">True</property>
+                        <property name="can_focus">True</property>
+                        <property name="tooltip" translatable="yes">Selection: start</property>
+                        <property name="relief">GTK_RELIEF_NONE</property>
+                        <property name="focus_on_click">False</property>
+                        <property name="response_id">0</property>
+                        <child>
+                          <widget class="GtkImage" id="image2306">
+                            <property name="visible">True</property>
+                            <property name="pixbuf">markA.xpm</property>
+                          </widget>
+                        </child>
+                      </widget>
+                      <packing>
+                        <property name="expand">False</property>
+                        <property name="fill">False</property>
+                        <property name="position">6</property>
+                      </packing>
+                    </child>
+                    <child>
+                      <widget class="GtkButton" id="buttonMarkB">
+                        <property name="visible">True</property>
+                        <property name="can_focus">True</property>
+                        <property name="tooltip" translatable="yes">Selection: end</property>
+                        <property name="relief">GTK_RELIEF_NONE</property>
+                        <property name="focus_on_click">False</property>
+                        <property name="response_id">0</property>
+                        <child>
+                          <widget class="GtkImage" id="image2307">
+                            <property name="visible">True</property>
+                            <property name="pixbuf">markB.xpm</property>
+                          </widget>
+                        </child>
+                      </widget>
+                      <packing>
+                        <property name="expand">False</property>
+                        <property name="fill">False</property>
+                        <property name="position">7</property>
+                      </packing>
+                    </child>
+                    <child>
+                      <widget class="GtkButton" id="buttonPrevBlack">
+                        <property name="visible">True</property>
+                        <property name="can_focus">True</property>
+                        <property name="tooltip" translatable="yes">Previous black frame</property>
+                        <property name="relief">GTK_RELIEF_NONE</property>
+                        <property name="focus_on_click">False</property>
+                        <property name="response_id">0</property>
+                        <child>
+                          <widget class="GtkImage" id="image2308">
+                            <property name="visible">True</property>
+                            <property name="pixbuf">xpm_prevblack.xpm</property>
+                          </widget>
+                        </child>
+                      </widget>
+                      <packing>
+                        <property name="expand">False</property>
+                        <property name="fill">False</property>
+                        <property name="position">8</property>
+                      </packing>
+                    </child>
+                    <child>
+                      <widget class="GtkButton" id="buttonNextBlack">
+                        <property name="visible">True</property>
+                        <property name="can_focus">True</property>
+                        <property name="tooltip" translatable="yes">Next black frame</property>
+                        <property name="relief">GTK_RELIEF_NONE</property>
+                        <property name="focus_on_click">False</property>
+                        <property name="response_id">0</property>
+                        <child>
+                          <widget class="GtkImage" id="image2309">
+                            <property name="visible">True</property>
+                            <property name="pixbuf">xpm_nextblack.xpm</property>
+                          </widget>
+                        </child>
+                      </widget>
+                      <packing>
+                        <property name="expand">False</property>
+                        <property name="fill">False</property>
+                        <property name="position">9</property>
+                      </packing>
+                    </child>
+                    <child>
+                      <widget class="GtkButton" id="buttonBegin">
+                        <property name="visible">True</property>
+                        <property name="can_focus">True</property>
+                        <property name="tooltip" translatable="yes">First frame</property>
+                        <property name="relief">GTK_RELIEF_NONE</property>
+                        <property name="focus_on_click">False</property>
+                        <property name="response_id">0</property>
+                        <child>
+                          <widget class="GtkImage" id="image5057">
+                            <property name="visible">True</property>
+                            <property name="pixbuf">begin.xpm</property>
+                          </widget>
+                        </child>
+                      </widget>
+                      <packing>
+                        <property name="expand">False</property>
+                        <property name="fill">False</property>
+                        <property name="position">10</property>
+                      </packing>
+                    </child>
+                    <child>
+                      <widget class="GtkButton" id="buttonEnd">
+                        <property name="visible">True</property>
+                        <property name="can_focus">True</property>
+                        <property name="tooltip" translatable="yes">Last frame</property>
+                        <property name="relief">GTK_RELIEF_NONE</property>
+                        <property name="focus_on_click">False</property>
+                        <property name="response_id">0</property>
+                        <child>
+                          <widget class="GtkImage" id="image2245">
+                            <property name="visible">True</property>
+                            <property name="pixbuf">end.xpm</property>
+                          </widget>
+                        </child>
+                      </widget>
+                      <packing>
+                        <property name="expand">False</property>
+                        <property name="fill">False</property>
+                        <property name="position">11</property>
+                      </packing>
+                    </child>
+                  </widget>
+                  <packing>
+                    <property name="top_attach">1</property>
+                    <property name="bottom_attach">2</property>
+                  </packing>
+                </child>
+                <child>
+                  <widget class="GtkHScale" id="sliderNavigate">
+                    <property name="visible">True</property>
+                    <property name="adjustment">0 0 99.989997863799999 0.0099999997764800008 1 0</property>
+                    <property name="value_pos">GTK_POS_LEFT</property>
+                  </widget>
+                </child>
+                <child>
+                  <widget class="GtkHBox" id="hbox16">
+                    <property name="visible">True</property>
+                    <property name="spacing">6</property>
+                    <child>
+                      <widget class="GtkLabel" id="label1">
+                        <property name="visible">True</property>
+                        <property name="label" translatable="yes">Frame: </property>
+                      </widget>
+                      <packing>
+                        <property name="expand">False</property>
+                        <property name="fill">False</property>
+                      </packing>
+                    </child>
+                    <child>
+                      <widget class="GtkEntry" id="boxCurFrame">
+                        <property name="visible">True</property>
+                        <property name="can_focus">True</property>
+                        <property name="tooltip" translatable="yes">Current frame</property>
+                        <property name="max_length">8</property>
+                        <property name="invisible_char">*</property>
+                        <property name="width_chars">8</property>
+                        <property name="text" translatable="yes">0</property>
+                      </widget>
+                      <packing>
+                        <property name="expand">False</property>
+                        <property name="fill">False</property>
+                        <property name="position">1</property>
+                      </packing>
+                    </child>
+                    <child>
+                      <widget class="GtkLabel" id="labelTotalFrame">
+                        <property name="visible">True</property>
+                        <property name="can_focus">True</property>
+                        <property name="xpad">5</property>
+                        <property name="label" translatable="yes">/ 0000000</property>
+                        <property name="selectable">True</property>
+                      </widget>
+                      <packing>
+                        <property name="expand">False</property>
+                        <property name="fill">False</property>
+                        <property name="position">2</property>
+                      </packing>
+                    </child>
+                    <child>
+                      <widget class="GtkLabel" id="label4">
+                        <property name="visible">True</property>
+                        <property name="label" translatable="yes">Time: </property>
+                      </widget>
+                      <packing>
+                        <property name="expand">False</property>
+                        <property name="fill">False</property>
+                        <property name="position">3</property>
+                      </packing>
+                    </child>
+                    <child>
+                      <widget class="GtkEntry" id="boxCurTime">
+                        <property name="visible">True</property>
+                        <property name="can_focus">True</property>
+                        <property name="tooltip" translatable="yes">Current time</property>
+                        <property name="invisible_char">*</property>
+                        <property name="width_chars">13</property>
+                        <property name="text" translatable="yes">00:00:00.000</property>
+                      </widget>
+                      <packing>
+                        <property name="expand">False</property>
+                        <property name="fill">False</property>
+                        <property name="position">4</property>
+                      </packing>
+                    </child>
+                    <child>
+                      <widget class="GtkLabel" id="labelTotalTime">
+                        <property name="visible">True</property>
+                        <property name="can_focus">True</property>
+                        <property name="xpad">5</property>
+                        <property name="label" translatable="yes">/ 00:00:00,000</property>
+                        <property name="selectable">True</property>
+                      </widget>
+                      <packing>
+                        <property name="expand">False</property>
+                        <property name="fill">False</property>
+                        <property name="position">5</property>
+                      </packing>
+                    </child>
+                    <child>
+                      <widget class="GtkLabel" id="labelFrameType">
+                        <property name="visible">True</property>
+                        <property name="can_focus">True</property>
+                        <property name="label" translatable="yes">Frame: ?</property>
+                        <property name="selectable">True</property>
+                      </widget>
+                      <packing>
+                        <property name="expand">False</property>
+                        <property name="fill">False</property>
+                        <property name="position">6</property>
+                      </packing>
+                    </child>
+                  </widget>
+                  <packing>
+                    <property name="top_attach">2</property>
+                    <property name="bottom_attach">3</property>
+                    <property name="y_options"></property>
+                  </packing>
+                </child>
+              </widget>
+              <packing>
+                <property name="expand">False</property>
+                <property name="fill">False</property>
+                <property name="position">1</property>
+              </packing>
+            </child>
+          </widget>
+          <packing>
+            <property name="position">2</property>
+          </packing>
+        </child>
+      </widget>
+    </child>
+  </widget>
 </glade-interface>



From mean at mail.berlios.de  Thu Feb  5 20:03:30 2009
From: mean at mail.berlios.de (mean at BerliOS)
Date: Thu, 5 Feb 2009 20:03:30 +0100
Subject: [Avidemux-svn-commit] r4571 -
	branches/avidemux_2.6_branch_mean/avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui
Message-ID: <200902051903.n15J3Ubu009764@sheep.berlios.de>

Author: mean
Date: 2009-02-05 20:03:29 +0100 (Thu, 05 Feb 2009)
New Revision: 4571

Removed:
   branches/avidemux_2.6_branch_mean/avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/Q_seekablePreview.cpp
   branches/avidemux_2.6_branch_mean/avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/Q_seekablePreview.h
   branches/avidemux_2.6_branch_mean/avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/preview.ui
Modified:
   branches/avidemux_2.6_branch_mean/avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/CMakeLists.txt
Log:
[Qt] Remove duplicate files

Modified: branches/avidemux_2.6_branch_mean/avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/CMakeLists.txt
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/CMakeLists.txt	2009-02-05 18:30:43 UTC (rev 4570)
+++ branches/avidemux_2.6_branch_mean/avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/CMakeLists.txt	2009-02-05 19:03:29 UTC (rev 4571)
@@ -12,5 +12,6 @@
 	${${ADM_LIB}_header}  ${${ADM_LIB}_source}  ${${ADM_LIB}_resource})
 
 INCLUDE_DIRECTORIES(${CMAKE_CURRENT_BINARY_DIR}  ${CMAKE_CURRENT_SOURCE_DIR})
+INCLUDE_DIRECTORIES(${CMAKE_CURRENT_SOURCE_DIR}/../ADM_filters  )
 INCLUDE_DIRECTORIES(${CMAKE_CURRENT_BINARY_DIR}/../ADM_filters  )
 ADD_ADM_LIB_QT4_TARGET(${ADM_LIB} ${${ADM_LIB}_SRCS})

Deleted: branches/avidemux_2.6_branch_mean/avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/Q_seekablePreview.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/Q_seekablePreview.cpp	2009-02-05 18:30:43 UTC (rev 4570)
+++ branches/avidemux_2.6_branch_mean/avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/Q_seekablePreview.cpp	2009-02-05 19:03:29 UTC (rev 4571)
@@ -1,52 +0,0 @@
-/***************************************************************************
-                           Q_seekablePreview.cpp
-                           ---------------------
-
-    begin                : Fri Sep 5 2008
-    copyright            : (C) 2008 by gruntster
- ***************************************************************************/
-
-/***************************************************************************
- *                                                                         *
- *   This program is free software; you can redistribute it and/or modify  *
- *   it under the terms of the GNU General Public License as published by  *
- *   the Free Software Foundation; either version 2 of the License, or     *
- *   (at your option) any later version.                                   *
- *                                                                         *
- ***************************************************************************/
-
-#include "Q_seekablePreview.h"
-
-Ui_seekablePreviewWindow::Ui_seekablePreviewWindow(AVDMGenericVideoStream *videoStream, uint32_t defaultFrame) : QDialog()
-{
-	ui.setupUi(this);
-
-	uint32_t canvasWidth = videoStream->getInfo()->width;
-	uint32_t canvasHeight = videoStream->getInfo()->height;
-
-	canvas = new ADM_QCanvas(ui.frame, canvasWidth, canvasHeight);
-	seekablePreview = new flySeekablePreview(canvasWidth, canvasHeight, videoStream, canvas, ui.horizontalSlider);
-
-	seekablePreview->process();
-	seekablePreview->sliderSet(defaultFrame);
-	seekablePreview->sliderChanged();
-
-	connect(ui.okButton, SIGNAL(clicked(bool)), this, SLOT(closeWindow()));
-	connect(ui.horizontalSlider, SIGNAL(valueChanged(int)), this, SLOT(sliderChanged(int)));
-}
-
-Ui_seekablePreviewWindow::~Ui_seekablePreviewWindow()
-{
-	delete seekablePreview;
-	delete canvas;
-}
-
-void Ui_seekablePreviewWindow::closeWindow()
-{
-	close();
-}
-
-void Ui_seekablePreviewWindow::sliderChanged(int value)
-{
-	seekablePreview->sliderChanged();
-}
\ No newline at end of file

Deleted: branches/avidemux_2.6_branch_mean/avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/Q_seekablePreview.h
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/Q_seekablePreview.h	2009-02-05 18:30:43 UTC (rev 4570)
+++ branches/avidemux_2.6_branch_mean/avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/Q_seekablePreview.h	2009-02-05 19:03:29 UTC (rev 4571)
@@ -1,39 +0,0 @@
-/***************************************************************************
-                            Q_seekablePreview.h
-                            -------------------
-
-    begin                : Fri Sep 5 2008
-    copyright            : (C) 2008 by gruntster
- ***************************************************************************/
-
-/***************************************************************************
- *                                                                         *
- *   This program is free software; you can redistribute it and/or modify  *
- *   it under the terms of the GNU General Public License as published by  *
- *   the Free Software Foundation; either version 2 of the License, or     *
- *   (at your option) any later version.                                   *
- *                                                                         *
- ***************************************************************************/
-
-#include "ui_seekablePreview.h"
-
-#include "ADM_assert.h"
-#include "ADM_videoFilter.h"
-#include "DIA_flyDialog.h"
-#include "../ADM_dialog/DIA_flyPreview.h"
-
-class Ui_seekablePreviewWindow : public QDialog
-{
-	Q_OBJECT
-
-public:
-	ADM_QCanvas *canvas;
-	flySeekablePreview *seekablePreview;
-	Ui_seekablePreviewDialog ui;
-	Ui_seekablePreviewWindow(AVDMGenericVideoStream *videoStream, uint32_t defaultFrame = 0);
-	~Ui_seekablePreviewWindow();
-
-public slots:
-	void closeWindow();
-	void sliderChanged(int value);
-};

Deleted: branches/avidemux_2.6_branch_mean/avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/preview.ui
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/preview.ui	2009-02-05 18:30:43 UTC (rev 4570)
+++ branches/avidemux_2.6_branch_mean/avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/preview.ui	2009-02-05 19:03:29 UTC (rev 4571)
@@ -1,36 +0,0 @@
-<ui version="4.0" >
- <class>previewDialog</class>
- <widget class="QDialog" name="previewDialog" >
-  <property name="geometry" >
-   <rect>
-    <x>0</x>
-    <y>0</y>
-    <width>400</width>
-    <height>300</height>
-   </rect>
-  </property>
-  <property name="windowTitle" >
-   <string>Preview</string>
-  </property>
-  <layout class="QVBoxLayout" >
-   <property name="margin" >
-    <number>9</number>
-   </property>
-   <property name="spacing" >
-    <number>6</number>
-   </property>
-   <item>
-    <widget class="QFrame" name="frame" >
-     <property name="frameShape" >
-      <enum>QFrame::StyledPanel</enum>
-     </property>
-     <property name="frameShadow" >
-      <enum>QFrame::Raised</enum>
-     </property>
-    </widget>
-   </item>
-  </layout>
- </widget>
- <resources/>
- <connections/>
-</ui>



From gruntster at mail.berlios.de  Thu Feb  5 20:10:49 2009
From: gruntster at mail.berlios.de (gruntster at mail.berlios.de)
Date: Thu, 5 Feb 2009 20:10:49 +0100
Subject: [Avidemux-svn-commit] r4572 - branches/avidemux_2.4_branch/po
Message-ID: <200902051910.n15JAnps011570@sheep.berlios.de>

Author: gruntster
Date: 2009-02-05 20:10:42 +0100 (Thu, 05 Feb 2009)
New Revision: 4572

Modified:
   branches/avidemux_2.4_branch/po/avidemux_it.ts
   branches/avidemux_2.4_branch/po/it.po
Log:
[I18N] Italian update by zoppo

Modified: branches/avidemux_2.4_branch/po/avidemux_it.ts
===================================================================
--- branches/avidemux_2.4_branch/po/avidemux_it.ts	2009-02-05 19:03:29 UTC (rev 4571)
+++ branches/avidemux_2.4_branch/po/avidemux_it.ts	2009-02-05 19:10:42 UTC (rev 4572)
@@ -1,6 +1,5 @@
 <?xml version="1.0" encoding="utf-8"?>
 <!DOCTYPE TS><TS version="1.1" language="it">
-<defaultcodec></defaultcodec>
 <context>
     <name></name>
     <message>
@@ -279,11 +278,6 @@
         <translation>Immagine di _sfonfo:</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_commonUI/DIA_animated.cpp" line="37"/>
-        <source>_NTSC(default is Pal):</source>
-        <translation>N_TSC (predefinito ? Pal):</translation>
-    </message>
-    <message>
         <location filename="../avidemux/ADM_userInterfaces/ADM_commonUI/DIA_animated.cpp" line="38"/>
         <source>Vignette _Width:</source>
         <translation>_Larghezza vignetta:</translation>
@@ -1029,7 +1023,7 @@
         <translation>Configurazione libavcodec MPEG-2</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_commonUI/DIA_animated.cpp" line="53"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_commonUI/DIA_SVCD.cpp" line="70"/>
         <source>MPEG-2 Configuration</source>
         <translation>Configurazione MPEG-2</translation>
     </message>
@@ -1298,6 +1292,16 @@
         <source>PSP full res. (720 * 480)</source>
         <translation>PSP ris. completa (720 * 480)</translation>
     </message>
+    <message>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_commonUI/DIA_animated.cpp" line="37"/>
+        <source>_NTSC (default is PAL):</source>
+        <translation>N_TSC (predefinito ? Pal):</translation>
+    </message>
+    <message>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_commonUI/DIA_animated.cpp" line="53"/>
+        <source>Animated Menu</source>
+        <translation>Menu animato</translation>
+    </message>
 </context>
 <context>
     <name>@default</name>
@@ -1631,7 +1635,7 @@
 Click OK to generate debug information. This may take a few minutes to complete.</source>
         <translation>? avvenuto un errore fatale.
 
-Clicca OK per visualizzare le informazioni di debug. Potrebbe richiedere alcuni minuti.</translation>
+Clicca OK per produrre le informazioni di debug. Potrebbe richiedere alcuni minuti.</translation>
     </message>
     <message>
         <location filename="../avidemux/ADM_osSupport/ADM_crashdump.cpp" line="437"/>
@@ -1753,12 +1757,12 @@
         <translation>Errore durante la codifica</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_outputs/oplug_mp4/oplug_mp4.cpp" line="469"/>
+        <location filename="../avidemux/ADM_outputs/oplug_mp4/oplug_mp4.cpp" line="471"/>
         <source>KeyFrame error</source>
         <translation>Errore fotogramma chiave</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_outputs/oplug_mp4/oplug_mp4.cpp" line="469"/>
+        <location filename="../avidemux/ADM_outputs/oplug_mp4/oplug_mp4.cpp" line="471"/>
         <source>The beginning frame is not a key frame.
 Please move the A marker.</source>
         <translation>Il fotogramma iniziale non ? un fotogramma chiave.
@@ -1790,12 +1794,12 @@
         <translation>La frequenza deve essere 44100, 22050 o 11025 Hz.</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_outputs/oplug_mp4/oplug_mp4.cpp" line="230"/>
+        <location filename="../avidemux/ADM_outputs/oplug_mp4/oplug_mp4.cpp" line="212"/>
         <source>Cannot initialize the audio stream</source>
         <translation>Impossibile inizializzare il flusso audio</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_outputs/oplug_mp4/oplug_mp4.cpp" line="418"/>
+        <location filename="../avidemux/ADM_outputs/oplug_mp4/oplug_mp4.cpp" line="420"/>
         <source>
  Reuse the existing log-file ?</source>
         <translation>  Riutilizzare il file log esistente?</translation>
@@ -2822,7 +2826,7 @@
     <message>
         <location filename="../avidemux/gtk_gui.cpp" line="1103"/>
         <source>Something failed when appending</source>
-        <translation>Qualcosa ? fallito durante l&apos;aggiunta</translation>
+        <translation>Errore durante l&apos;aggiunta</translation>
     </message>
     <message>
         <location filename="../avidemux/gtk_gui.cpp" line="1944"/>
@@ -3216,53 +3220,46 @@
         <translation>Impossibile decodificare il fotogramma.</translation>
     </message>
     <message>
-        <location filename="../avidemux/gui_savenew.cpp" line="89"/>
+        <location filename="../avidemux/gui_savenew.cpp" line="88"/>
         <source>Dual audio can only be used in copy mode</source>
         <translation>Il doppio audio pu? essere usato solo in modalit? copia</translation>
     </message>
     <message>
-        <location filename="../avidemux/gui_savenew.cpp" line="89"/>
+        <location filename="../avidemux/gui_savenew.cpp" line="88"/>
         <source>Select Copy as the video codec.</source>
         <translation>Seleziona Copia come codec video.</translation>
     </message>
     <message>
-        <location filename="../avidemux/gui_savenew.cpp" line="238"/>
+        <location filename="../avidemux/gui_savenew.cpp" line="237"/>
         <source>Incompatible output format</source>
         <translation>Formato in uscita incompatibile</translation>
     </message>
     <message>
-        <location filename="../avidemux/gui_savenew.cpp" line="259"/>
+        <location filename="../avidemux/gui_savenew.cpp" line="258"/>
         <source>There is no second track</source>
         <translation>Non c&apos;? una seconda traccia</translation>
     </message>
     <message>
-        <location filename="../avidemux/gui_savenew.cpp" line="259"/>
+        <location filename="../avidemux/gui_savenew.cpp" line="258"/>
         <source>Select a second audio track in the Audio menu.</source>
         <translation>Seleziona una seconda traccia nel menu Audio.</translation>
     </message>
     <message>
-        <location filename="../avidemux/gui_savenew.cpp" line="263"/>
+        <location filename="../avidemux/gui_savenew.cpp" line="262"/>
         <source>Select dual audio AVI to write</source>
         <translation>Seleziona il file AVI con doppio audio da scrivere</translation>
     </message>
     <message>
-        <location filename="../avidemux/gui_savenew.cpp" line="303"/>
+        <location filename="../avidemux/gui_savenew.cpp" line="302"/>
         <source>This cannot have packed VOP</source>
         <translation>Non pu? avere VOP compresso</translation>
     </message>
     <message>
-        <location filename="../avidemux/gui_savenew.cpp" line="303"/>
+        <location filename="../avidemux/gui_savenew.cpp" line="302"/>
         <source>It is not MPEG-4 video. File will not be saved.</source>
         <translation>Non ? un video MPEG-4. Il file non verr? salvato.</translation>
     </message>
     <message>
-        <location filename="../avidemux/gui_savenew.cpp" line="349"/>
-        <source>You may need smart copy.
- Enable it ?</source>
-        <translation>Potresti avere bisogno di una copia intelligente.
- Attivarla?</translation>
-    </message>
-    <message>
         <location filename="../avidemux/guiplay.cpp" line="359"/>
         <source>Trouble initializing audio device</source>
         <translation>Problema nell&apos;inizializzare il dispositivo audio</translation>
@@ -3358,27 +3355,27 @@
         <translation>Movimento</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/alert_qt4.cpp" line="30"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/alert_qt4.cpp" line="21"/>
         <source>Alert</source>
         <translation>Avviso</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/alert_qt4.cpp" line="104"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/alert_qt4.cpp" line="99"/>
         <source>Info</source>
         <translation>Info</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/alert_qt4.cpp" line="164"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/alert_qt4.cpp" line="167"/>
         <source>Confirmation</source>
         <translation>Conferma</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/alert_qt4.cpp" line="211"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/alert_qt4.cpp" line="212"/>
         <source>Question</source>
         <translation>Domanda</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/alert_qt4.cpp" line="203"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/alert_qt4.cpp" line="205"/>
         <source>Question ?</source>
         <translation>Domanda?</translation>
     </message>
@@ -4410,15 +4407,15 @@
     <message>
         <location filename="../avidemux/ADM_outputs/oplug_mpegFF/oplug_vcdff.cpp" line="373"/>
         <source>Encoding</source>
-        <translation>Codifica in corso</translation>
+        <translation>Codifica</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_outputs/oplug_mp4/oplug_mp4.cpp" line="426"/>
+        <location filename="../avidemux/ADM_outputs/oplug_mp4/oplug_mp4.cpp" line="428"/>
         <source>1st Pass</source>
         <translation>1a passata</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_outputs/oplug_mp4/oplug_mp4.cpp" line="501"/>
+        <location filename="../avidemux/ADM_outputs/oplug_mp4/oplug_mp4.cpp" line="503"/>
         <source>2nd Pass</source>
         <translation>2a passata</translation>
     </message>
@@ -4616,12 +4613,12 @@
         <translation>Impossibile determinare la cartella Application Data.</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_outputs/oplug_mp4/oplug_mp4.cpp" line="248"/>
+        <location filename="../avidemux/ADM_outputs/oplug_mp4/oplug_mp4.cpp" line="230"/>
         <source>Invalid audio stream detected</source>
         <translation>Rilevato flusso audio non valido</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_outputs/oplug_mp4/oplug_mp4.cpp" line="248"/>
+        <location filename="../avidemux/ADM_outputs/oplug_mp4/oplug_mp4.cpp" line="230"/>
         <source>The audio stream may be invalid for this container.
 
 Continue anyway?</source>
@@ -5074,6 +5071,28 @@
         <source>Aspect Ratio:</source>
         <translation>Proporzioni:</translation>
     </message>
+    <message>
+        <location filename="../avidemux/gtk_gui.cpp" line="2035"/>
+        <source>Audio track %d (%s/%d channels/%d kbit per s/%d ms shift)</source>
+        <translation>Traccia audio %d (%s/%d canali/%d kbit per s/ritardo %d ms)</translation>
+    </message>
+    <message>
+        <location filename="../avidemux/gui_savenew.cpp" line="348"/>
+        <source>You may need smart copy.
+Enable it?</source>
+        <translation>Potresti avere bisogno di una copia intelligente.
+Attivarla?</translation>
+    </message>
+    <message>
+        <location filename="../avidemux/gui_savenew.cpp" line="351"/>
+        <source>Smart Copy</source>
+        <translation>Copia intelligente</translation>
+    </message>
+    <message>
+        <location filename="../avidemux/gui_savenew.cpp" line="351"/>
+        <source>_Q factor (set 4):</source>
+        <translation>Fattore _Q (4 predefinito):</translation>
+    </message>
 </context>
 <context>
     <name>ADMImage</name>
@@ -6193,98 +6212,89 @@
         <translation>Tentativo di aprire %s fallito!</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_editor/ADM_edit.cpp" line="439"/>
-        <source>You cannot mix different video dimensions yet. Using the partial video filter later, will not work around this problem. The workaround is:
-1.) &quot;resize&quot; / &quot;add border&quot; / &quot;crop&quot; each stream to the same resolution
-2.) concatinate them together</source>
-        <translation>Non puoi ancora mescolare dimensioni video differenti. Usare il filtro video parziale, non risolver? il problema. La soluzione ?:
-1.) &quot;ridimensiona&quot; / &quot;aggiungi bordi&quot; / &quot;ritaglia&quot; ogni flusso alla stessa risoluzione
-2.) concatenali insieme</translation>
-    </message>
-    <message>
-        <location filename="../avidemux/ADM_editor/ADM_edit.cpp" line="551"/>
+        <location filename="../avidemux/ADM_editor/ADM_edit.cpp" line="543"/>
         <source>Build Time Map</source>
         <translation>Crea time map</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_editor/ADM_edit.cpp" line="551"/>
+        <location filename="../avidemux/ADM_editor/ADM_edit.cpp" line="543"/>
         <source>Build VBR time map?</source>
         <translation>Creare la time map VBR?</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_editor/ADM_edit.cpp" line="715"/>
+        <location filename="../avidemux/ADM_editor/ADM_edit.cpp" line="707"/>
         <source>Packed Bitstream detected</source>
         <translation>Flusso di bit compresso rilevato</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_editor/ADM_edit.cpp" line="716"/>
+        <location filename="../avidemux/ADM_editor/ADM_edit.cpp" line="708"/>
         <source>Do you want me to unpack it ?</source>
         <translation>Vuoi decomprimerlo?</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_editor/ADM_edit.cpp" line="736"/>
+        <location filename="../avidemux/ADM_editor/ADM_edit.cpp" line="728"/>
         <source>Could not unpack the video</source>
         <translation>Impossibile decomprimere il video</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_editor/ADM_edit.cpp" line="736"/>
+        <location filename="../avidemux/ADM_editor/ADM_edit.cpp" line="728"/>
         <source>Using backup decoder - not frame accurate.</source>
         <translation>Utilizzo decodificatore backup - non preciso sui fotogrammi.</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_editor/ADM_edit.cpp" line="741"/>
+        <location filename="../avidemux/ADM_editor/ADM_edit.cpp" line="733"/>
         <source>Weird</source>
         <translation>Strano</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_editor/ADM_edit.cpp" line="741"/>
+        <location filename="../avidemux/ADM_editor/ADM_edit.cpp" line="733"/>
         <source>The unpacking succeedeed but the index is still not up to date.</source>
         <translation>La decompressione ? riuscita ma l&apos;indice non ? ancora aggiornato.</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_editor/ADM_edit.cpp" line="747"/>
+        <location filename="../avidemux/ADM_editor/ADM_edit.cpp" line="739"/>
         <source>Troubles ahead</source>
         <translation>Problemi avanti</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_editor/ADM_edit.cpp" line="747"/>
+        <location filename="../avidemux/ADM_editor/ADM_edit.cpp" line="739"/>
         <source>This a VOP packed AVI.</source>
         <translation>Questo ? un AVI compresso con VOP.</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_editor/ADM_edit.cpp" line="758"/>
+        <location filename="../avidemux/ADM_editor/ADM_edit.cpp" line="750"/>
         <source>Index is not up to date</source>
         <translation>L&apos;indice non ? aggiornato</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_editor/ADM_edit.cpp" line="758"/>
+        <location filename="../avidemux/ADM_editor/ADM_edit.cpp" line="750"/>
         <source>You should use Tool-&gt;Rebuild frame. Do it now ?</source>
         <translation>Dovresti usare Strumenti -&gt; Ricostruisci fotogrammi. Vuoi farlo ora?</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_editor/ADM_edit.cpp" line="1520"/>
+        <location filename="../avidemux/ADM_editor/ADM_edit.cpp" line="1512"/>
         <source>This looks like mpeg
  Do you want to index it?</source>
         <translation>Questo sembra un file mpeg
  Vuoi indicizzarlo?</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_editor/ADM_edit.cpp" line="1572"/>
+        <location filename="../avidemux/ADM_editor/ADM_edit.cpp" line="1564"/>
         <source>Indexing failed</source>
         <translation>Indicizzazione fallita</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_editor/ADM_edit.cpp" line="585"/>
+        <location filename="../avidemux/ADM_editor/ADM_edit.cpp" line="577"/>
         <source>Use safe mode</source>
         <translation>Usa modalit? sicura</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_editor/ADM_edit.cpp" line="585"/>
+        <location filename="../avidemux/ADM_editor/ADM_edit.cpp" line="577"/>
         <source>H.264 detected</source>
         <translation>H.264 rilevato</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_editor/ADM_edit.cpp" line="585"/>
+        <location filename="../avidemux/ADM_editor/ADM_edit.cpp" line="577"/>
         <source>If the file is using B-frames as reference it can lead to a crash or stuttering.
 Avidemux can use another mode which is safe but YOU WILL LOSE FRAME ACCURACY.
 Do you want to use that mode?</source>
@@ -6292,6 +6302,21 @@
 Avidemux pu? utilizzare un&apos;altra modalit? pi? sicura, ma PERDERAI PRECISIONE NEI FOTOGRAMMI.
 Vuoi usare questa modalit??</translation>
     </message>
+    <message>
+        <location filename="../avidemux/ADM_editor/ADM_edit.cpp" line="431"/>
+        <source>Video dimensions don&apos;t match.</source>
+        <translation>Le dimensioni video non corrispondono.</translation>
+    </message>
+    <message>
+        <location filename="../avidemux/ADM_editor/ADM_edit.cpp" line="431"/>
+        <source>You cannot mix different video dimensions yet. Using the partial video filter later will not work around this problem. The workaround is:
+
+1) &quot;Resize&quot; / &quot;Add Border&quot; / &quot;Crop&quot; each stream to the same resolution
+2) Concatenate them together</source>
+        <translation>Non ? possibile unire video di dimensioni diverse. L&apos;utilizzo del filtro video parziale non risolve il problema. La soluzione ? la seguente:
+1) ridimensiona, aggiungi bordi o ritaglia tutti i flussi alla stessa risoluzione
+2) concatenali insieme</translation>
+    </message>
 </context>
 <context>
     <name>ADM_Qbitrate</name>
@@ -6457,7 +6482,7 @@
     <message>
         <location filename="../avidemux/ADM_outputs/oplug_ogm/op_ogsaveprocess.cpp" line="167"/>
         <source>Encoding</source>
-        <translation>Codifica in corso</translation>
+        <translation>Codifica</translation>
     </message>
 </context>
 <context>
@@ -7356,7 +7381,7 @@
         <translation>0</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/working.ui" line="88"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/working.ui" line="85"/>
         <source>00:00:00</source>
         <translation>00:00:00</translation>
     </message>
@@ -7566,26 +7591,21 @@
         <translation>Dimensione carattere:</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/working.ui" line="16"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/working.ui" line="13"/>
         <source>Processing</source>
         <translation>Processing</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/working.ui" line="50"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/working.ui" line="47"/>
         <source>Elapsed:</source>
         <translation>Tempo trascorso:</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/working.ui" line="71"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/working.ui" line="68"/>
         <source>Time Remaining:</source>
         <translation>Tempo rimanente:</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/working.ui" line="168"/>
-        <source>Cancel</source>
-        <translation>Annulla</translation>
-    </message>
-    <message>
         <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_filters/mainfilter.ui" line="19"/>
         <source>Video Filter Manager</source>
         <translation>Gestore filtri video</translation>
@@ -7970,11 +7990,6 @@
 <context>
     <name>DialogVobSub</name>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/vobsub.ui" line="13"/>
-        <source>Subtitle Font Size and Position</source>
-        <translation>Dimensione e posizione sottotitoli</translation>
-    </message>
-    <message>
         <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/vobsub.ui" line="33"/>
         <source>Language:</source>
         <translation>Lingua:</translation>
@@ -7989,6 +8004,11 @@
         <source>Delay:</source>
         <translation>Ritardo:</translation>
     </message>
+    <message>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/vobsub.ui" line="13"/>
+        <source>VobSub Settings</source>
+        <translation>Impostazioni VobSub</translation>
+    </message>
 </context>
 <context>
     <name>EncoderCopy</name>
@@ -8092,6 +8112,24 @@
     </message>
 </context>
 <context>
+    <name>EqualiserDialog</name>
+    <message>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/equaliser.ui" line="21"/>
+        <source>Equaliser</source>
+        <translation>Equalizzatore</translation>
+    </message>
+    <message>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/equaliser.ui" line="41"/>
+        <source>Settings</source>
+        <translation>Impostazioni</translation>
+    </message>
+    <message>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/equaliser.ui" line="255"/>
+        <source>Histogram</source>
+        <translation>Istogramma</translation>
+    </message>
+</context>
+<context>
     <name>GenericAviSave</name>
     <message>
         <location filename="../avidemux/ADM_outputs/oplug_avi/op_avisave.cpp" line="189"/>
@@ -8197,7 +8235,7 @@
     <message>
         <location filename="../avidemux/ADM_outputs/oplug_avi/op_saveprocess.cpp" line="267"/>
         <source>Encoding</source>
-        <translation>Codifica in corso</translation>
+        <translation>Codifica</translation>
     </message>
     <message>
         <location filename="../avidemux/ADM_outputs/oplug_avi/op_saveprocess.cpp" line="269"/>
@@ -8381,7 +8419,7 @@
         <translation>Configura</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1851"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1852"/>
         <source>Filters</source>
         <translation>Filtri</translation>
     </message>
@@ -8471,17 +8509,17 @@
         <translation>&amp;Audio</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1426"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1427"/>
         <source>&amp;File</source>
         <translation>&amp;File</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1430"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1431"/>
         <source>&amp;Recent Files</source>
         <translation>File &amp;recenti</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1439"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1440"/>
         <source>&amp;Save</source>
         <translation>&amp;Salva</translation>
     </message>
@@ -8491,692 +8529,692 @@
         <translation>&amp;Strumenti</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1352"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1355"/>
         <source>&amp;Edit</source>
         <translation>&amp;Modifica</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1368"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1369"/>
         <source>&amp;View</source>
         <translation>Visua&amp;lizza</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1372"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1373"/>
         <source>&amp;Preview Mode</source>
         <translation>&amp;Modalit? anteprima</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1389"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1390"/>
         <source>&amp;Custom</source>
         <translation>&amp;Preferiti</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1394"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1395"/>
         <source>&amp;Go</source>
         <translation>&amp;Vai</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1414"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1415"/>
         <source>A&amp;uto</source>
         <translation>A&amp;uto</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1519"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1520"/>
         <source>&amp;Open...</source>
         <translation>&amp;Apri...</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1522"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1523"/>
         <source>Ctrl+O</source>
         <translation>Ctrl+O</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1527"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1528"/>
         <source>&amp;Append...</source>
         <translation>A&amp;ggiungi...</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1530"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1531"/>
         <source>Ctrl+Alt+A</source>
         <translation>Ctrl+Alt+A</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1535"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1536"/>
         <source>&amp;Quit</source>
         <translation>&amp;Esci</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1540"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1541"/>
         <source>Cu&amp;t</source>
         <translation>&amp;Taglia</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1543"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1544"/>
         <source>Ctrl+X</source>
         <translation>Ctrl+X</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1548"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1549"/>
         <source>&amp;Copy</source>
         <translation>&amp;Copia</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1551"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1552"/>
         <source>Ctrl+C</source>
         <translation>Ctrl+C</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1556"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1557"/>
         <source>&amp;Paste</source>
         <translation>&amp;Incolla</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1559"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1560"/>
         <source>Ctrl+V</source>
         <translation>Ctrl+V</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1564"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1565"/>
         <source>&amp;Delete</source>
         <translation>&amp;Elimina</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1567"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1568"/>
         <source>Del</source>
         <translation>Canc</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1581"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1582"/>
         <source>Set Marker A</source>
         <translation>Imposta segnalibro A</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1584"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1585"/>
         <source>[</source>
         <translation>[</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1598"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1599"/>
         <source>Set Marker B</source>
         <translation>Imposta segnalibro B</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1601"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1602"/>
         <source>]</source>
         <translation>]</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1606"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1607"/>
         <source>Pre&amp;ferences...</source>
         <translation>&amp;Preferenze...</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1614"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1615"/>
         <source>&amp;Information...</source>
         <translation>&amp;Informazioni...</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1617"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1618"/>
         <source>Alt+Return</source>
         <translation>Alt+Invio</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1625"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1626"/>
         <source>Save &amp;Video...</source>
         <translation>Salva &amp;video...</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1631"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1632"/>
         <source>Save Video</source>
         <translation>Salva video</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1639"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1640"/>
         <source>Save &amp;BMP Image...</source>
         <translation>Salva immagine &amp;BMP...</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1645"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1646"/>
         <source>Save BMP Image</source>
         <translation>Salva immagine BMP</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1650"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1651"/>
         <source>Save &amp;JPEG Image...</source>
         <translation>Salva immagine &amp;JPEG...</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1656"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1657"/>
         <source>Save JPEG Image</source>
         <translation>Salva immagine JPEG</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1664"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1665"/>
         <source>&amp;Load/Run Project...</source>
         <translation>&amp;Carica/esegui progetto...</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1670"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1671"/>
         <source>Load/Run Project</source>
         <translation>Carica/esegui progetto</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1678"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1679"/>
         <source>Save &amp;Project</source>
         <translation>Salva &amp;progetto</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1684"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1685"/>
         <source>Save Project</source>
         <translation>Salva progetto</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1634"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1635"/>
         <source>Ctrl+S</source>
         <translation>Ctrl+S</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1692"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1693"/>
         <source>Save P&amp;roject As...</source>
         <translation>Salva p&amp;rogetto con nome...</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1698"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1699"/>
         <source>Save Project As</source>
         <translation>Salva progetto con nome</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1703"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1704"/>
         <source>Main toolbar</source>
         <translation>Barra degli strumenti principale</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1708"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1709"/>
         <source>A/V toolbar</source>
         <translation>Barra degli strumenti audio/video</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1716"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1717"/>
         <source>&amp;Zoom 1:4</source>
         <translation>&amp;Zoom 1:4</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1719"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1720"/>
         <source>Ctrl+Shift+4</source>
         <translation>Ctrl+Shift+4</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1727"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1728"/>
         <source>Z&amp;oom 1:2</source>
         <translation>Z&amp;oom 1:2</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1730"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1731"/>
         <source>Ctrl+Shift+2</source>
         <translation>Ctrl+Shift+2</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1741"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1742"/>
         <source>Zoom &amp;1:1</source>
         <translation>Zoom &amp;1:1</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1744"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1745"/>
         <source>Ctrl+Alt+1</source>
         <translation>Ctrl+Alt+1</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1752"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1753"/>
         <source>Zoom &amp;2:1</source>
         <translation>Zoom &amp;2:1</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1755"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1756"/>
         <source>Ctrl+Alt+2</source>
         <translation>Ctrl+Alt+2</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1760"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1761"/>
         <source>Zoom 4:1</source>
         <translation>Zoom 4:1</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1765"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1766"/>
         <source>&amp;Decoder Options...</source>
         <translation>Opzioni &amp;decodificatore...</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1771"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1772"/>
         <source>Decoder Options</source>
         <translation>Opzioni decodificatore</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1774"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1775"/>
         <source>F3</source>
         <translation>F3</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1779"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1780"/>
         <source>&amp;Postprocessing...</source>
         <translation>&amp;Postprocessing...</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1782"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1783"/>
         <source>F4</source>
         <translation>F4</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1787"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1788"/>
         <source>&amp;Frame Rate...</source>
         <translation>&amp;Frame rate...</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1793"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1794"/>
         <source>Frame Rate</source>
         <translation>Frame rate</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1840"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1841"/>
         <source>Encoder</source>
         <translation>Codificatore</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1803"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1804"/>
         <source>Fil&amp;ters...</source>
         <translation>Fil&amp;tri...</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1806"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1807"/>
         <source>Ctrl+Alt+F</source>
         <translation>Ctrl+Alt+F</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1811"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1812"/>
         <source>&amp;Main Track...</source>
         <translation>Traccia &amp;principale...</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1816"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1817"/>
         <source>&amp;Secondary Track...</source>
         <translation>Traccia &amp;secondaria...</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1827"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1828"/>
         <source>Build VBR Time Map</source>
         <translation>Crea time map VBR</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1832"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1833"/>
         <source>S&amp;ave...</source>
         <translation>S&amp;alva...</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1835"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1836"/>
         <source>Ctrl+Alt+S</source>
         <translation>Ctrl+Alt+S</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1845"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1846"/>
         <source>&amp;Filters</source>
         <translation>&amp;Filtri</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1862"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1863"/>
         <source>&amp;Calculator...</source>
         <translation>&amp;Calcolatrice...</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1865"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1866"/>
         <source>F7</source>
         <translation>F7</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1870"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1871"/>
         <source>&amp;Rebuild I &amp;&amp; B Frames</source>
         <translation>&amp;Ricostruisci fotogrammi I &amp;&amp; B</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1876"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1877"/>
         <source>Rebuild I &amp; B Frames</source>
         <translation>Ricostruisci fotogrammi I &amp;&amp; B</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1881"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1882"/>
         <source>&amp;Bitrate Histogram...</source>
         <translation>Istogramma &amp;bitrate...</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1887"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1888"/>
         <source>Bitrate Histogram</source>
         <translation>Istogramma bitrate</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1892"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1893"/>
         <source>&amp;Scan for Black Frames...</source>
         <translation>C&amp;erca fotogrammi neri...</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1898"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1899"/>
         <source>Scan for Black Frames</source>
         <translation>Cerca fotogrammi neri</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1903"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1904"/>
         <source>&amp;VOB -&gt; VobSub...</source>
         <translation>&amp;VOB -&gt; VobSub...</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1909"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1910"/>
         <source>VOB -&gt; VobSub</source>
         <translation>VOB -&gt; VobSub</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1914"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1915"/>
         <source>&amp;OCR (VobSub -&gt; srt)...</source>
         <translation>&amp;OCR (VobSub -&gt; srt)...</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1920"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1921"/>
         <source>OCR (VobSub -&gt; srt)</source>
         <translation>OCR (VobSub -&gt; srt)</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1934"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1935"/>
         <source>Stop</source>
         <translation>Stop</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="2132"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="2133"/>
         <source>P</source>
         <translation>P</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1945"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1946"/>
         <source>P&amp;revious Frame</source>
         <translation>Fotogramma p&amp;recedente</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1948"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1949"/>
         <source>Left</source>
         <translation>Sinistra</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1956"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1957"/>
         <source>&amp;Next Frame</source>
         <translation>Fotogramma &amp;successivo</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1959"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1960"/>
         <source>Right</source>
         <translation>Destra</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1967"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1968"/>
         <source>Pr&amp;evious Intra Frame</source>
         <translation>Fotogramma chiave pr&amp;ecedente</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1973"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1974"/>
         <source>Previous Intra Frame</source>
         <translation>Fotogramma chiave precedente</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1976"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1977"/>
         <source>Down</source>
         <translation>Gi?</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1984"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1985"/>
         <source>Next &amp;Intra Frame</source>
         <translation>Fotogramma ch&amp;iave successivo</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1990"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1991"/>
         <source>Next Intra Frame</source>
         <translation>Fotogramma chiave successivo</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1993"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1994"/>
         <source>Up</source>
         <translation>Su</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="2001"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="2002"/>
         <source>Previou&amp;s Black Frame</source>
         <translation>Fotogramma nero pre&amp;cedente</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="2007"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="2008"/>
         <source>Previous Black Frame</source>
         <translation>Fotogramma nero precedente</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="2015"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="2016"/>
         <source>Ne&amp;xt Black Frame</source>
         <translation>Fotogramma nero successi&amp;vo</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="2021"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="2022"/>
         <source>Next Black Frame</source>
         <translation>Fotogramma nero successivo</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="2029"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="2030"/>
         <source>&amp;First Frame</source>
         <translation>Primo &amp;fotogramma</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="2032"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="2033"/>
         <source>Home</source>
         <translation>Home</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="2040"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="2041"/>
         <source>&amp;Last Frame</source>
         <translation>&amp;Ultimo fotogramma</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="2043"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="2044"/>
         <source>End</source>
         <translation>Fine</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="2051"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="2052"/>
         <source>Jump to Marker &amp;A</source>
         <translation>Vai al segnalibro &amp;A</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="2057"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="2058"/>
         <source>Jump to Marker A</source>
         <translation>Vai al segnalibro A</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="2060"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="2061"/>
         <source>Ctrl+[</source>
         <translation>Ctrl+[</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="2068"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="2069"/>
         <source>Jump to Marker &amp;B</source>
         <translation>Vai al segnalibro &amp;B</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="2074"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="2075"/>
         <source>Jump to Marker B</source>
         <translation>Vai al segnalibro B</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="2077"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="2078"/>
         <source>Ctrl+]</source>
         <translation>Ctrl+]</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="2082"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="2083"/>
         <source>Jump to Fra&amp;me...</source>
         <translation>Vai al fotogra&amp;mma...</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="2085"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="2086"/>
         <source>Ctrl+F</source>
         <translation>Ctrl+F</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="2090"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="2091"/>
         <source>Jump to &amp;Time...</source>
         <translation>Vai al &amp;tempo...</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="2093"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="2094"/>
         <source>Ctrl+T</source>
         <translation>Ctrl+T</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="2098"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="2099"/>
         <source>&amp;Built-in Support...</source>
         <translation>&amp;Supporto incorporato...</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="2104"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="2105"/>
         <source>Built-in Support</source>
         <translation>Supporto incorporato</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="2109"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="2110"/>
         <source>&amp;About Avidemux...</source>
         <translation>Informazioni su &amp;Avidemux...</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="2115"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="2116"/>
         <source>About Avidemux</source>
         <translation>Informazioni su Avidemux</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="2123"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="2124"/>
         <source>&amp;Play/Stop</source>
         <translation>&amp;Play/Stop</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="2129"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="2130"/>
         <source>Play/Stop</source>
         <translation>Play/Stop</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="2137"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="2138"/>
         <source>Recent0</source>
         <translation>Recent0</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="2142"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="2143"/>
         <source>Recent1</source>
         <translation>Recent1</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="2147"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="2148"/>
         <source>Recent2</source>
         <translation>Recent2</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="2152"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="2153"/>
         <source>Recent3</source>
         <translation>Recent3</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="2188"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="2189"/>
         <source>Add to &amp;Joblist...</source>
         <translation>Aggiungi alla &amp;lista attivit?...</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="2194"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="2195"/>
         <source>Add to Joblist</source>
         <translation>Aggiungi alla lista attivit?</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="2199"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="2200"/>
         <source>View &amp;Joblist...</source>
         <translation>Mostra &amp;lista attivit?...</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="2205"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="2206"/>
         <source>View Joblist</source>
         <translation>Mostra lista attivit?</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="2208"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="2209"/>
         <source>Ctrl+J</source>
         <translation>Ctrl+J</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="2213"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="2214"/>
         <source>Co&amp;nnect to avsproxy</source>
         <translation>Co&amp;nnetti a avsproxy</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="2219"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="2220"/>
         <source>Connect to avsproxy</source>
         <translation>Connetti a avsproxy</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="2224"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="2225"/>
         <source>&amp;Reset Edits</source>
         <translation>A&amp;nnulla modifiche</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="2229"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="2230"/>
         <source>Save</source>
         <translation>Salva</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="2234"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="2235"/>
         <source>OCR (&amp;TS -&gt; srt)...</source>
         <translation>OCR (&amp;TS -&gt; srt)...</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="2240"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="2241"/>
         <source>OCR (TS -&gt; srt)</source>
         <translation>OCR (TS -&gt; srt)</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="2245"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="2246"/>
         <source>Edit &amp;Glyphs...</source>
         <translation>Modifica &amp;glifi...</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="2251"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="2252"/>
         <source>Edit Glyphs</source>
         <translation>Modifica glifi</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="2314"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="2315"/>
         <source>&amp;Input</source>
         <translation>&amp;Input</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="2319"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="2320"/>
         <source>&amp;Output</source>
         <translation>&amp;Output</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="2324"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="2325"/>
         <source>Si&amp;de</source>
         <translation>&amp;Affiancati lateralmente</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="2329"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="2330"/>
         <source>&amp;Top</source>
         <translation>Affiancati ver&amp;ticalmente</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="2334"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="2335"/>
         <source>&amp;Separate</source>
         <translation>&amp;Separati</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="2349"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="2350"/>
         <source>&amp;Close</source>
         <translation>&amp;Chiudi</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="2352"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="2353"/>
         <source>Ctrl+W</source>
         <translation>Ctrl+W</translation>
     </message>
@@ -9186,7 +9224,7 @@
         <translation>ms</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="2357"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="2358"/>
         <source>Save Selection as JPEG Images...</source>
         <translation>Salva selezione in immagini JPEG...</translation>
     </message>
@@ -9201,45 +9239,55 @@
         <translation>B:</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="2157"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="2158"/>
         <source>&amp;Video CD...</source>
         <translation>&amp;Video CD...</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="2162"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="2163"/>
         <source>&amp;Super Video CD...</source>
         <translation>&amp;Super Video CD...</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="2167"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="2168"/>
         <source>&amp;DVD...</source>
         <translation>&amp;DVD...</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="2172"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="2173"/>
         <source>&amp;PlayStation Portable...</source>
         <translation>&amp;PlayStation Portable...</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="2177"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="2178"/>
         <source>PlayStation Portable (&amp;H.264)...</source>
         <translation>PlayStation Portable (&amp;H.264)...</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="2183"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="2184"/>
         <source>PlayStation Portable (H.264)</source>
         <translation>PlayStation Portable (H.264)</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="2339"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="2340"/>
         <source>&amp;Flash Video</source>
         <translation>&amp;Flash Video</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="2344"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="2345"/>
         <source>&amp;iPod (MPEG-4 ASP)...</source>
         <translation>&amp;iPod (MPEG-4 ASP)...</translation>
     </message>
+    <message>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="2363"/>
+        <source>&amp;Preferences...</source>
+        <translation>&amp;Preferenze...</translation>
+    </message>
+    <message>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="2368"/>
+        <source>&amp;AVI Muxer Options...</source>
+        <translation>Opzioni Muxer &amp;AVI</translation>
+    </message>
 </context>
 <context>
     <name>MpegMuxer</name>
@@ -9473,7 +9521,7 @@
     <message>
         <location filename="../avidemux/ADM_videoFilter/ADM_vidDecTelecide.cpp" line="131"/>
         <source>Decomb Telecide</source>
-        <translation type="unfinished">Decomb Telecide</translation>
+        <translation>Decomb Telecide</translation>
     </message>
 </context>
 <context>
@@ -9481,7 +9529,7 @@
     <message>
         <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_license.cpp" line="708"/>
         <source>&lt;!DOCTYPE html PUBLIC &quot;-//W3C//DTD HTML 4.01 Transitional//EN&quot;&gt;&lt;html&gt;&lt;head&gt;  &lt;title&gt;Avidemux is free software; you can redistribute it and/or  modify it under the terms of the GNU General Public License  version 2 as published by the Free Software Foundation&lt;/title&gt;&lt;style type=&quot;text/css&quot;&gt;&lt;!-- /* Style Definitions */ p.licenseStyle, li.licenseStyle, div.licenseStyle        {margin:0cm;        margin-bottom:.0001pt;        font-size:12.0pt;        font-family:&quot;Times New Roman&quot;;} /* Page Definitions */ @page Section1        {size:612.0pt 792.0pt;        margin:72.0pt 90.0pt 72.0pt 90.0pt;}div.Section1        {page:Section1;}--&gt;&lt;/style&gt;&lt;/head&gt;&lt;body lang=&quot;EN-GB&quot; style=&apos;text-justify-trim:punctuation&apos;&gt;  &lt;div class=&quot;Section1&quot;&gt;    &lt;p class=&quot;licenseStyle&quot; style=&apos;text-autospace:none&apos;&gt;    &lt;span style=&apos;font-size:1!
 0.0pt; font-family:Arial&apos;&gt;Avidemux is    free software; you can redistribute it and/or modify it under    the terms of the GNU General Public License version 2 as    published by the Free Software Foundation.&lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; style=&apos;text-autospace:none&apos;&gt;    &lt;b&gt;&lt;span style=&apos;font-size:10.0pt; font-family:Arial&apos;&gt;    &lt;/span&gt;&lt;/b&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; align=&quot;center&quot; style=    &apos;text-align:center;text-autospace:none&apos;&gt;&lt;b&gt;&lt;span style=    &apos;font-size:10.0pt;font-family:Arial&apos;&gt;GNU GENERAL PUBLIC    LICENSE&lt;/span&gt;&lt;/b&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; align=&quot;center&quot; style=    &apos;text-align:center;text-autospace:none&apos;&gt;&lt;b&gt;&lt;span style=    &apos;font-size:10.0pt;font-family:Arial&apos;&gt;Version 2, June    1991&lt;/span&gt;&lt;/b&gt;&lt;/p&gt;    &lt;p class=&qu!
 ot;licenseStyle&quot; style=&apos;text-autospace:none&apos;&gt!
 ;    &lt
;span style=&apos;font-size:10.0pt; font-family:Arial&apos;&gt; &lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; align=&quot;center&quot; style=    &apos;text-align:center;text-autospace:none&apos;&gt;&lt;span style=    &apos;font-size:10.0pt;font-family:Arial&apos;&gt;Copyright (C) 1989, 1991    Free Software Foundation, Inc.&lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; align=&quot;center&quot; style=    &apos;text-align:center;text-autospace:none&apos;&gt;&lt;span lang=&quot;FR&quot; style=    &apos;font-size:10.0pt;font-family:Arial&apos;&gt;59 Temple Place, Suite    330, Boston, MA  02111-1307  USA&lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; align=&quot;center&quot; style=    &apos;text-align:center;text-autospace:none&apos;&gt;&lt;span lang=&quot;FR&quot; style=    &apos;font-size:10.0pt;font-family:Arial&apos;&gt; &lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; style=    &apos;text-align:justify;text-a!
 utospace:none&apos;&gt;&lt;span style=    &apos;font-size:10.0pt;font-family:Arial&apos;&gt;Everyone is permitted to    copy and distribute verbatim copies of this license document,    but changing it is not allowed.&lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; style=&apos;text-autospace:none&apos;&gt;    &lt;span style=&apos;font-size:10.0pt; font-family:Arial&apos;&gt; &lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; align=&quot;center&quot; style=    &apos;text-align:center;text-autospace:none&apos;&gt;&lt;b&gt;&lt;span style=    &apos;font-size:10.0pt;font-family:Arial&apos;&gt;Preamble&lt;/span&gt;&lt;/b&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; style=&apos;text-autospace:none&apos;&gt;    &lt;span style=&apos;font-size:10.0pt; font-family:Arial&apos;&gt; &lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; style=    &apos;text-align:justify;text-autospace:none&apos;&gt;&lt;span style=    &apos;font-size:10.0pt;fo!
 nt-family:Arial&apos;&gt;The licenses for most    software are!
  designe
d to take away your freedom to share and    change it.  By contrast, the GNU General Public License is    intended to guarantee your freedom to share and change free    software--to make sure the software is free for all its users.     This General Public License applies to most of the Free    Software Foundation&apos;s software and to any other program whose    authors commit to using it.  (Some other Free Software    Foundation software is covered by the GNU Library General    Public License instead.)  You can apply it to your programs,    too.&lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; style=    &apos;text-align:justify;text-autospace:none&apos;&gt;&lt;span style=    &apos;font-size:10.0pt;font-family:Arial&apos;&gt; &lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; style=    &apos;text-align:justify;text-autospace:none&apos;&gt;&lt;span style=    &apos;font-size:10.0pt;font-family:Arial&apos;&gt;When we speak of free    software, we are !
 referring to freedom, not price.  Our General    Public Licenses are designed to make sure that you have the    freedom to distribute copies of free software (and charge for    this service if you wish), that you receive source code or can    get it if you want it, that you can change the software or use    pieces of it in new free programs; and that you know you can do    these things.&lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; style=    &apos;text-align:justify;text-autospace:none&apos;&gt;&lt;span style=    &apos;font-size:10.0pt;font-family:Arial&apos;&gt; &lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; style=    &apos;text-align:justify;text-autospace:none&apos;&gt;&lt;span style=    &apos;font-size:10.0pt;font-family:Arial&apos;&gt;To protect your rights, we    need to make restrictions that forbid anyone to deny you these    rights or to ask you to surrender the rights. These    restrictions translate to certain responsibilities fo!
 r you if    you distribute copies of the software, or if you m!
 odify   
 it.&lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; style=    &apos;text-align:justify;text-autospace:none&apos;&gt;&lt;span style=    &apos;font-size:10.0pt;font-family:Arial&apos;&gt; &lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; style=    &apos;text-align:justify;text-autospace:none&apos;&gt;&lt;span style=    &apos;font-size:10.0pt;font-family:Arial&apos;&gt;For example, if you    distribute copies of such a program, whether gratis or for a    fee, you must give the recipients all the rights that you have.     You must make sure that they, too, receive or can get the    source code.  And you must show them these terms so they know    their rights.&lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; style=    &apos;text-align:justify;text-autospace:none&apos;&gt;&lt;span style=    &apos;font-size:10.0pt;font-family:Arial&apos;&gt; &lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; style=    &apos;text-align:justify!
 ;text-autospace:none&apos;&gt;&lt;span style=    &apos;font-size:10.0pt;font-family:Arial&apos;&gt;We protect your rights    with two steps: (1) copyright the software, and (2) offer you    this license which gives you legal permission to copy,    distribute and/or modify the software.&lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; style=    &apos;text-align:justify;text-autospace:none&apos;&gt;&lt;span style=    &apos;font-size:10.0pt;font-family:Arial&apos;&gt; &lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; style=    &apos;text-align:justify;text-autospace:none&apos;&gt;&lt;span style=    &apos;font-size:10.0pt;font-family:Arial&apos;&gt;Also, for each author&apos;s    protection and ours, we want to make certain that everyone    understands that there is no warranty for this free software.     If the software is modified by someone else and passed on, we    want its recipients to know that what they have is not the    original, so that an!
 y problems introduced by others will not    reflect on the ori!
 ginal au
thors&apos; reputations.&lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; style=    &apos;text-align:justify;text-autospace:none&apos;&gt;&lt;span style=    &apos;font-size:10.0pt;font-family:Arial&apos;&gt; &lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; style=    &apos;text-align:justify;text-autospace:none&apos;&gt;&lt;span style=    &apos;font-size:10.0pt;font-family:Arial&apos;&gt;Finally, any free program    is threatened constantly by software patents.  We wish to avoid    the danger that redistributors of a free program will    individually obtain patent licenses, in effect making the    program proprietary.  To prevent this, we have made it clear    that any patent must be licensed for everyone&apos;s free use or not    licensed at all.&lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; style=    &apos;text-align:justify;text-autospace:none&apos;&gt;&lt;span style=    &apos;font-size:10.0pt;font-family:Arial&apos;&gt; &lt;/s!
 pan&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; style=    &apos;text-align:justify;text-autospace:none&apos;&gt;&lt;span style=    &apos;font-size:10.0pt;font-family:Arial&apos;&gt;The precise terms and    conditions for copying, distribution and modification    follow.&lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; style=&apos;text-autospace:none&apos;&gt;    &lt;span style=&apos;font-size:10.0pt; font-family:Arial&apos;&gt; &lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; style=&apos;text-autospace:none&apos;&gt;    &lt;span style=&apos;font-size:10.0pt; font-family:Arial&apos;&gt; &lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; align=&quot;center&quot; style=    &apos;text-align:center;text-autospace:none&apos;&gt;&lt;b&gt;&lt;span style=    &apos;font-size:10.0pt;font-family:Arial&apos;&gt;GNU GENERAL PUBLIC    LICENSE&lt;/span&gt;&lt;/b&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; align=&quot;center&quot!
 ; style=    &apos;text-align:center;text-autospace:none&apos;&!
 gt;&lt;b
&gt;&lt;span style=    &apos;font-size:10.0pt;font-family:Arial&apos;&gt;TERMS AND CONDITIONS FOR    COPYING, DISTRIBUTION AND MODIFICATION&lt;/span&gt;&lt;/b&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; style=&apos;text-autospace:none&apos;&gt;    &lt;span style=&apos;font-size:10.0pt; font-family:Arial&apos;&gt; &lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; style=    &apos;text-align:justify;text-autospace:none&apos;&gt;&lt;span style=    &apos;font-size:10.0pt;font-family:Arial&apos;&gt;0. This License applies to    any program or other work which contains a notice placed by the    copyright holder saying it may be distributed under the terms    of this General Public License.  The &quot;Program&quot;, below, refers    to any such program or work, and a &quot;work based on the Program&quot;    means either the Program or any derivative work under copyright    law: that is to say, a work containing the Program or a portion    of it, either verbat!
 im or with modifications and/or translated    into another language.  (Hereinafter, translation is included    without limitation in the term &quot;modification&quot;.)  Each licensee    is addressed as &quot;you&quot;.&lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; style=    &apos;text-align:justify;text-autospace:none&apos;&gt;&lt;span style=    &apos;font-size:10.0pt;font-family:Arial&apos;&gt; &lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; style=    &apos;text-align:justify;text-autospace:none&apos;&gt;&lt;span style=    &apos;font-size:10.0pt;font-family:Arial&apos;&gt;Activities other than    copying, distribution and modification are not covered by this    License; they are outside its scope.  The act of running the    Program is not restricted, and the output from the Program is    covered only if its contents constitute a work based on the    Program (independent of having been made by running the    Program). Whether that is true d!
 epends on what the Program    does.&lt;/span&gt;&lt;/p&gt;    !
 &lt;p cl
ass=&quot;licenseStyle&quot; style=    &apos;text-align:justify;text-autospace:none&apos;&gt;&lt;span style=    &apos;font-size:10.0pt;font-family:Arial&apos;&gt; &lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; style=    &apos;text-align:justify;text-autospace:none&apos;&gt;&lt;span style=    &apos;font-size:10.0pt;font-family:Arial&apos;&gt;1. You may copy and    distribute verbatim copies of the Program&apos;s source code as you    receive it, in any medium, provided that you conspicuously and    appropriately publish on each copy an appropriate copyright    notice and disclaimer of warranty; keep intact all the notices    that refer to this License and to the absence of any warranty;    and give any other recipients of the Program a copy of this    License along with the Program.&lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; style=    &apos;text-align:justify;text-autospace:none&apos;&gt;&lt;span style=    &apos;font-size:10.0pt;font-famil!
 y:Arial&apos;&gt; &lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; style=    &apos;text-align:justify;text-autospace:none&apos;&gt;&lt;span style=    &apos;font-size:10.0pt;font-family:Arial&apos;&gt;You may charge a fee for    the physical act of transferring a copy, and you may at your    option offer warranty protection in exchange for a    fee.&lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; style=    &apos;text-align:justify;text-autospace:none&apos;&gt;&lt;span style=    &apos;font-size:10.0pt;font-family:Arial&apos;&gt; &lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; style=    &apos;text-align:justify;text-autospace:none&apos;&gt;&lt;span style=    &apos;font-size:10.0pt;font-family:Arial&apos;&gt;2. You may modify your    copy or copies of the Program or any portion of it, thus    forming a work based on the Program, and copy and distribute    such modifications or work under the terms of Section 1 above,    provided tha!
 t you also meet all of these conditions:&lt;/span&gt;&lt;/p&gt!
 ;    &lt
;p class=&quot;licenseStyle&quot; style=    &apos;text-align:justify;text-autospace:none&apos;&gt;&lt;span style=    &apos;font-size:10.0pt;font-family:Arial&apos;&gt; &lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; style=    &apos;text-align:justify;text-autospace:none&apos;&gt;&lt;span style=    &apos;font-size:10.0pt;font-family:Arial&apos;&gt;a) You must cause the    modified files to carry prominent notices stating that you    changed the files and the date of any change.&lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; style=    &apos;text-align:justify;text-autospace:none&apos;&gt;&lt;span style=    &apos;font-size:10.0pt;font-family:Arial&apos;&gt; &lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; style=    &apos;text-align:justify;text-autospace:none&apos;&gt;&lt;span style=    &apos;font-size:10.0pt;font-family:Arial&apos;&gt;b) You must cause any work    that you distribute or publish, that in whole or in part    contain!
 s or is derived from the Program or any part thereof, to    be licensed as a whole at no charge to all third parties under    the terms of this License.&lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; style=    &apos;text-align:justify;text-autospace:none&apos;&gt;&lt;span style=    &apos;font-size:10.0pt;font-family:Arial&apos;&gt; &lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; style=    &apos;text-align:justify;text-autospace:none&apos;&gt;&lt;span style=    &apos;font-size:10.0pt;font-family:Arial&apos;&gt;c) If the modified program    normally reads commands interactively when run, you must cause    it, when started running for such interactive use in the most    ordinary way, to print or display an announcement including an    appropriate copyright notice and a notice that there is no    warranty (or else, saying that you provide a warranty) and that    users may redistribute the program under these conditions, and    telling the user ho!
 w to view a copy of this License.     (Exception: if the Progr!
 am itsel
f is interactive but does not    normally print such an announcement, your work based on the    Program is not required to print an announcement.)&lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; style=    &apos;text-align:justify;text-autospace:none&apos;&gt;&lt;span style=    &apos;font-size:10.0pt;font-family:Arial&apos;&gt; &lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; style=    &apos;text-align:justify;text-autospace:none&apos;&gt;&lt;span style=    &apos;font-size:10.0pt;font-family:Arial&apos;&gt; &lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; style=    &apos;text-align:justify;text-autospace:none&apos;&gt;&lt;span style=    &apos;font-size:10.0pt;font-family:Arial&apos;&gt;These requirements apply    to the modified work as a whole.  If identifiable sections of    that work are not derived from the Program, and can be    reasonably considered independent and separate works in    themselves, then this License, and its t!
 erms, do not apply to    those sections when you distribute them as separate works.  But    when you distribute the same sections as part of a whole which    is a work based on the Program, the distribution of the whole    must be on the terms of this License, whose permissions for    other licensees extend to the entire whole, and thus to each    and every part regardless of who wrote it.&lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; style=    &apos;text-align:justify;text-autospace:none&apos;&gt;&lt;span style=    &apos;font-size:10.0pt;font-family:Arial&apos;&gt; &lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; style=    &apos;text-align:justify;text-autospace:none&apos;&gt;&lt;span style=    &apos;font-size:10.0pt;font-family:Arial&apos;&gt;Thus, it is not the intent    of this section to claim rights or contest your rights to work    written entirely by you; rather, the intent is to exercise the    right to control the distribution of de!
 rivative or collective    works based on the Program.&lt;/span!
 &gt;&lt;
/p&gt;    &lt;p class=&quot;licenseStyle&quot; style=    &apos;text-align:justify;text-autospace:none&apos;&gt;&lt;span style=    &apos;font-size:10.0pt;font-family:Arial&apos;&gt; &lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; style=    &apos;text-align:justify;text-autospace:none&apos;&gt;&lt;span style=    &apos;font-size:10.0pt;font-family:Arial&apos;&gt;In addition, mere    aggregation of another work not based on the Program with the    Program (or with a work based on the Program) on a volume of a    storage or distribution medium does not bring the other work    under the scope of this License.&lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; style=    &apos;text-align:justify;text-autospace:none&apos;&gt;&lt;span style=    &apos;font-size:10.0pt;font-family:Arial&apos;&gt; &lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; style=    &apos;text-align:justify;text-autospace:none&apos;&gt;&lt;span style=    &apos;font-size:10!
 .0pt;font-family:Arial&apos;&gt;3. You may copy and    distribute the Program (or a work based on it, under Section 2)    in object code or executable form under the terms of Sections 1    and 2 above provided that you also do one of the    following:&lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; style=    &apos;text-align:justify;text-autospace:none&apos;&gt;&lt;span style=    &apos;font-size:10.0pt;font-family:Arial&apos;&gt; &lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; style=    &apos;text-align:justify;text-autospace:none&apos;&gt;&lt;span style=    &apos;font-size:10.0pt;font-family:Arial&apos;&gt;a) Accompany it with the    complete corresponding machine-readable source code, which must    be distributed under the terms of Sections 1 and 2 above on a    medium customarily used for software interchange;    or,&lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; style=    &apos;text-align:justify;text-autospace:none&apos;&g!
 t;&lt;span style=    &apos;font-size:10.0pt;font-family:Arial&!
 apos;&gt
; &lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; style=    &apos;text-align:justify;text-autospace:none&apos;&gt;&lt;span style=    &apos;font-size:10.0pt;font-family:Arial&apos;&gt;b) Accompany it with a    written offer, valid for at least three years, to give any    third party, for a charge no more than your cost of physically    performing source distribution, a complete machine-readable    copy of the corresponding source code, to be distributed under    the terms of Sections 1 and 2 above on a medium customarily    used for software interchange; or,&lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; style=    &apos;text-align:justify;text-autospace:none&apos;&gt;&lt;span style=    &apos;font-size:10.0pt;font-family:Arial&apos;&gt; &lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; style=    &apos;text-align:justify;text-autospace:none&apos;&gt;&lt;span style=    &apos;font-size:10.0pt;font-family:Arial&apos;&gt;c) Accompany it!
  with the    information you received as to the offer to distribute    corresponding source code.  (This alternative is allowed only    for noncommercial distribution and only if you received the    program in object code or executable form with such an offer,    in accord with Subsection b above.)&lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; style=    &apos;text-align:justify;text-autospace:none&apos;&gt;&lt;span style=    &apos;font-size:10.0pt;font-family:Arial&apos;&gt; &lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; style=    &apos;text-align:justify;text-autospace:none&apos;&gt;&lt;span style=    &apos;font-size:10.0pt;font-family:Arial&apos;&gt;The source code for a work    means the preferred form of the work for making modifications    to it.  For an executable work, complete source code means all    the source code for all modules it contains, plus any    associated interface definition files, plus the scripts used to    control c!
 ompilation and installation of the executable.     However, as!
  a speci
al exception, the source code distributed    need not include anything that is normally distributed (in    either source or binary form) with the major components    (compiler, kernel, and so on) of the operating system on which    the executable runs, unless that component itself accompanies    the executable.&lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; style=    &apos;text-align:justify;text-autospace:none&apos;&gt;&lt;span style=    &apos;font-size:10.0pt;font-family:Arial&apos;&gt; &lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; style=    &apos;text-align:justify;text-autospace:none&apos;&gt;&lt;span style=    &apos;font-size:10.0pt;font-family:Arial&apos;&gt;If distribution of    executable or object code is made by offering access to copy    from a designated place, then offering equivalent access to    copy the source code from the same place counts as distribution    of the source code, even though third parties are not compelled   !
  to copy the source along with the object code.&lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; style=    &apos;text-align:justify;text-autospace:none&apos;&gt;&lt;span style=    &apos;font-size:10.0pt;font-family:Arial&apos;&gt; &lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; style=    &apos;text-align:justify;text-autospace:none&apos;&gt;&lt;span style=    &apos;font-size:10.0pt;font-family:Arial&apos;&gt; &lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; style=    &apos;text-align:justify;text-autospace:none&apos;&gt;&lt;span style=    &apos;font-size:10.0pt;font-family:Arial&apos;&gt;4. You may not copy,    modify, sublicense, or distribute the Program except as    expressly provided under this License.  Any attempt otherwise    to copy, modify, sublicense or distribute the Program is void,    and will automatically terminate your rights under this    License. However, parties who have received copies, or rights,    from you !
 under this License will not have their licenses    terminated !
 so long 
as such parties remain in full    compliance.&lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; style=    &apos;text-align:justify;text-autospace:none&apos;&gt;&lt;span style=    &apos;font-size:10.0pt;font-family:Arial&apos;&gt; &lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; style=    &apos;text-align:justify;text-autospace:none&apos;&gt;&lt;span style=    &apos;font-size:10.0pt;font-family:Arial&apos;&gt;5. You are not required to    accept this License, since you have not signed it.  However,    nothing else grants you permission to modify or distribute the    Program or its derivative works.  These actions are prohibited    by law if you do not accept this License.  Therefore, by    modifying or distributing the Program (or any work based on the    Program), you indicate your acceptance of this License to do    so, and all its terms and conditions for copying, distributing    or modifying the Program or works based on it.&lt;/span&gt;&lt;/p&!
 gt;    &lt;p class=&quot;licenseStyle&quot; style=    &apos;text-align:justify;text-autospace:none&apos;&gt;&lt;span style=    &apos;font-size:10.0pt;font-family:Arial&apos;&gt; &lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; style=    &apos;text-align:justify;text-autospace:none&apos;&gt;&lt;span style=    &apos;font-size:10.0pt;font-family:Arial&apos;&gt;6. Each time you    redistribute the Program (or any work based on the Program),    the recipient automatically receives a license from the    original licensor to copy, distribute or modify the Program    subject to these terms and conditions.  You may not impose any    further restrictions on the recipients&apos; exercise of the rights    granted herein. You are not responsible for enforcing    compliance by third parties to this License.&lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; style=    &apos;text-align:justify;text-autospace:none&apos;&gt;&lt;span style=    &apos;font-size:10.0pt!
 ;font-family:Arial&apos;&gt; &lt;/span&gt;&lt;/p&gt;    &lt;p !
 class=&q
uot;licenseStyle&quot; style=    &apos;text-align:justify;text-autospace:none&apos;&gt;&lt;span style=    &apos;font-size:10.0pt;font-family:Arial&apos;&gt;7. If, as a consequence of    a court judgment or allegation of patent infringement or for    any other reason (not limited to patent issues), conditions are    imposed on you (whether by court order, agreement or otherwise)    that contradict the conditions of this License, they do not    excuse you from the conditions of this License.  If you cannot    distribute so as to satisfy simultaneously your obligations    under this License and any other pertinent obligations, then as    a consequence you may not distribute the Program at all.  For    example, if a patent license would not permit royalty-free    redistribution of the Program by all those who receive copies    directly or indirectly through you, then the only way you could    satisfy both it and this License would be to refrain entirely    from distribution of t!
 he Program.&lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; style=    &apos;text-align:justify;text-autospace:none&apos;&gt;&lt;span style=    &apos;font-size:10.0pt;font-family:Arial&apos;&gt; &lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; style=    &apos;text-align:justify;text-autospace:none&apos;&gt;&lt;span style=    &apos;font-size:10.0pt;font-family:Arial&apos;&gt;If any portion of this    section is held invalid or unenforceable under any particular    circumstance, the balance of the section is intended to apply    and the section as a whole is intended to apply in other    circumstances.&lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; style=    &apos;text-align:justify;text-autospace:none&apos;&gt;&lt;span style=    &apos;font-size:10.0pt;font-family:Arial&apos;&gt; &lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; style=    &apos;text-align:justify;text-autospace:none&apos;&gt;&lt;span style=    &apos;f!
 ont-size:10.0pt;font-family:Arial&apos;&gt;It is not the purpo!
 se of   
 this section to induce you to infringe any patents or other    property right claims or to contest validity of any such    claims; this section has the sole purpose of protecting the    integrity of the free software distribution system, which is    implemented by public license practices.  Many people have made    generous contributions to the wide range of software    distributed through that system in reliance on consistent    application of that system; it is up to the author/donor to    decide if he or she is willing to distribute software through    any other system and a licensee cannot impose that    choice.&lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; style=    &apos;text-align:justify;text-autospace:none&apos;&gt;&lt;span style=    &apos;font-size:10.0pt;font-family:Arial&apos;&gt; &lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; style=    &apos;text-align:justify;text-autospace:none&apos;&gt;&lt;span style=    &apos;font-size:10.0!
 pt;font-family:Arial&apos;&gt;This section is intended    to make thoroughly clear what is believed to be a consequence    of the rest of this License.&lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; style=    &apos;text-align:justify;text-autospace:none&apos;&gt;&lt;span style=    &apos;font-size:10.0pt;font-family:Arial&apos;&gt; &lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; style=    &apos;text-align:justify;text-autospace:none&apos;&gt;&lt;span style=    &apos;font-size:10.0pt;font-family:Arial&apos;&gt; &lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; style=    &apos;text-align:justify;text-autospace:none&apos;&gt;&lt;span style=    &apos;font-size:10.0pt;font-family:Arial&apos;&gt;8. If the distribution    and/or use of the Program is restricted in certain countries    either by patents or by copyrighted interfaces, the original    copyright holder who places the Program under this License may    add an explicit geograph!
 ical distribution limitation excluding    those countries, so !
 that dis
tribution is permitted only in or    among countries not thus excluded.  In such case, this License    incorporates the limitation as if written in the body of this    License.&lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; style=    &apos;text-align:justify;text-autospace:none&apos;&gt;&lt;span style=    &apos;font-size:10.0pt;font-family:Arial&apos;&gt; &lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; style=    &apos;text-align:justify;text-autospace:none&apos;&gt;&lt;span style=    &apos;font-size:10.0pt;font-family:Arial&apos;&gt;9. The Free Software    Foundation may publish revised and/or new versions of the    General Public License from time to time.  Such new versions    will be similar in spirit to the present version, but may    differ in detail to address new problems or    concerns.&lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; style=    &apos;text-align:justify;text-autospace:none&apos;&gt;&lt;span style=    &apos!
 ;font-size:10.0pt;font-family:Arial&apos;&gt; &lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; style=    &apos;text-align:justify;text-autospace:none&apos;&gt;&lt;span style=    &apos;font-size:10.0pt;font-family:Arial&apos;&gt;Each version is given a    distinguishing version number.  If the Program specifies a    version number of this License which applies to it and &quot;any    later version&quot;, you have the option of following the terms and    conditions either of that version or of any later version    published by the Free Software Foundation.  If the Program does    not specify a version number of this License, you may choose    any version ever published by the Free Software    Foundation.&lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; style=    &apos;text-align:justify;text-autospace:none&apos;&gt;&lt;span style=    &apos;font-size:10.0pt;font-family:Arial&apos;&gt; &lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; s!
 tyle=    &apos;text-align:justify;text-autospace:none&apos;&gt!
 ;&lt;spa
n style=    &apos;font-size:10.0pt;font-family:Arial&apos;&gt;10. If you wish to    incorporate parts of the Program into other free programs whose    distribution conditions are different, write to the author to    ask for permission.  For software which is copyrighted by the    Free Software Foundation, write to the Free Software    Foundation; we sometimes make exceptions for this.  Our    decision will be guided by the two goals of preserving the free    status of all derivatives of our free software and of promoting    the sharing and reuse of software generally.&lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; style=&apos;text-autospace:none&apos;&gt;    &lt;span style=&apos;font-size:10.0pt; font-family:Arial&apos;&gt; &lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; align=&quot;center&quot; style=    &apos;text-align:center;text-autospace:none&apos;&gt;&lt;b&gt;&lt;span style=    &apos;font-size:10.0pt;font-family:Arial&apos;&gt;NO WARRAN!
 TY&lt;/span&gt;&lt;/b&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; style=&apos;text-autospace:none&apos;&gt;    &lt;span style=&apos;font-size:10.0pt; font-family:Arial&apos;&gt; &lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; style=    &apos;text-align:justify;text-autospace:none&apos;&gt;&lt;span style=    &apos;font-size:10.0pt;font-family:Arial&apos;&gt;11. BECAUSE THE PROGRAM IS    LICENSED FREE OF CHARGE, THERE IS NO WARRANTY FOR THE PROGRAM,    TO THE EXTENT PERMITTED BY APPLICABLE LAW.  EXCEPT WHEN    OTHERWISE STATED IN WRITING THE COPYRIGHT HOLDERS AND/OR OTHER    PARTIES PROVIDE THE PROGRAM &quot;AS IS&quot; WITHOUT WARRANTY OF ANY    KIND, EITHER EXPRESSED OR IMPLIED, INCLUDING, BUT NOT LIMITED    TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A    PARTICULAR PURPOSE.  THE ENTIRE RISK AS TO THE QUALITY AND    PERFORMANCE OF THE PROGRAM IS WITH YOU.  SHOULD THE PROGRAM    PROVE DEFECTIVE, YOU ASSUME THE COST OF ALL NECESSAR!
 Y    SERVICING, REPAIR OR CORRECTION.&lt;/span&gt;&lt;/p&gt;  !
   &lt;p 
class=&quot;licenseStyle&quot; style=    &apos;text-align:justify;text-autospace:none&apos;&gt;&lt;span style=    &apos;font-size:10.0pt;font-family:Arial&apos;&gt; &lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; style=    &apos;text-align:justify;text-autospace:none&apos;&gt;&lt;span style=    &apos;font-size:10.0pt;font-family:Arial&apos;&gt;12. IN NO EVENT UNLESS    REQUIRED BY APPLICABLE LAW OR AGREED TO IN WRITING WILL ANY    COPYRIGHT HOLDER, OR ANY OTHER PARTY WHO MAY MODIFY AND/OR    REDISTRIBUTE THE PROGRAM AS PERMITTED ABOVE, BE LIABLE TO YOU    FOR DAMAGES, INCLUDING ANY GENERAL, SPECIAL, INCIDENTAL OR    CONSEQUENTIAL DAMAGES ARISING OUT OF THE USE OR INABILITY TO    USE THE PROGRAM (INCLUDING BUT NOT LIMITED TO LOSS OF DATA OR    DATA BEING RENDERED INACCURATE OR LOSSES SUSTAINED BY YOU OR    THIRD PARTIES OR A FAILURE OF THE PROGRAM TO OPERATE WITH ANY    OTHER PROGRAMS), EVEN IF SUCH HOLDER OR OTHER PARTY HAS BEEN    ADVISED OF THE POSSIBILITY !
 OF SUCH DAMAGES.&lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; style=&apos;text-autospace:none&apos;&gt;    &lt;span style=&apos;font-size:10.0pt; font-family:Arial&apos;&gt; &lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; align=&quot;center&quot; style=    &apos;text-align:center;text-autospace:none&apos;&gt;&lt;b&gt;&lt;span style=    &apos;font-size:10.0pt;font-family:Arial&apos;&gt;END OF TERMS AND    CONDITIONS&lt;/span&gt;&lt;/b&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; style=&apos;text-autospace:none&apos;&gt;    &lt;span style=&apos;font-size:10.0pt; font-family:Arial&apos;&gt; &lt;/span&gt;&lt;/p&gt;  &lt;/div&gt;&lt;/body&gt;&lt;/html&gt;</source>
-        <translation type="unfinished"></translation>
+        <translation>&lt;!DOCTYPE html PUBLIC &quot;-//W3C//DTD HTML 4.01 Transitional//EN&quot;&gt;&lt;html&gt;&lt;head&gt;  &lt;title&gt;Avidemux ? un programma libero e gratuito; puoi ridistribuirlo e/o modificarlo secondo i termini della Licenza Pubblica Generica GNU versione 2 come pubblicato dalla Free Software Foundation.&lt;/title&gt;&lt;style type=&quot;text/css&quot;&gt;&lt;!-- /* Style Definitions */ p.licenseStyle, li.licenseStyle, div.licenseStyle        {margin:0cm;        margin-bottom:.0001pt;        font-size:12.0pt;        font-family:&quot;Times New Roman&quot;;} /* Page Definitions */ @page Section1        {size:612.0pt 792.0pt;        margin:72.0pt 90.0pt 72.0pt 90.0pt;}div.Section1        {page:Section1;}--&gt;&lt;/style&gt;&lt;/head&gt;&lt;body lang=&quot;EN-GB&quot; style=&apos;text-justify-trim:punctuation&apos;&gt;  &lt;div class=&quot;Section1&quot;&gt;    &lt;p class=&quot;licenseStyle&quot; style=&apos;text-autospace:none&apos;&gt;    &lt;span !
 style=&apos;font-size:10.0pt; font-family:Arial&apos;&gt;Avidemux ? un programma libero e gratuito; puoi ridistribuirlo e/o modificarlo secondo i termini della Licenza Pubblica Generica GNU versione 2 come pubblicato dalla Free Software Foundation.&lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; style=&apos;text-autospace:none&apos;&gt;    &lt;b&gt;&lt;span style=&apos;font-size:10.0pt; font-family:Arial&apos;&gt;    &lt;/span&gt;&lt;/b&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; align=&quot;center&quot; style=    &apos;text-align:center;text-autospace:none&apos;&gt;&lt;b&gt;&lt;span style=    &apos;font-size:10.0pt;font-family:Arial&apos;&gt;GNU GENERAL PUBLIC    LICENSE&lt;/span&gt;&lt;/b&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; align=&quot;center&quot; style=    &apos;text-align:center;text-autospace:none&apos;&gt;&lt;b&gt;&lt;span style=    &apos;font-size:10.0pt;font-family:Arial&apos;&gt;Version 2, June    1991&lt;/span&gt;&lt;/b!
 &gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; style=&!
 apos;tex
t-autospace:none&apos;&gt;    &lt;span style=&apos;font-size:10.0pt; font-family:Arial&apos;&gt; &lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; align=&quot;center&quot; style=    &apos;text-align:center;text-autospace:none&apos;&gt;&lt;span style=    &apos;font-size:10.0pt;font-family:Arial&apos;&gt;Copyright (C) 1989, 1991    Free Software Foundation, Inc.&lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; align=&quot;center&quot; style=    &apos;text-align:center;text-autospace:none&apos;&gt;&lt;span lang=&quot;FR&quot; style=    &apos;font-size:10.0pt;font-family:Arial&apos;&gt;59 Temple Place, Suite    330, Boston, MA  02111-1307  USA&lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; align=&quot;center&quot; style=    &apos;text-align:center;text-autospace:none&apos;&gt;&lt;span lang=&quot;FR&quot; style=    &apos;font-size:10.0pt;font-family:Arial&apos;&gt; &lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; style=  !
   &apos;text-align:justify;text-autospace:none&apos;&gt;&lt;span style=    &apos;font-size:10.0pt;font-family:Arial&apos;&gt;Everyone is permitted to    copy and distribute verbatim copies of this license document,    but changing it is not allowed.&lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; style=&apos;text-autospace:none&apos;&gt;    &lt;span style=&apos;font-size:10.0pt; font-family:Arial&apos;&gt; &lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; align=&quot;center&quot; style=    &apos;text-align:center;text-autospace:none&apos;&gt;&lt;b&gt;&lt;span style=    &apos;font-size:10.0pt;font-family:Arial&apos;&gt;Preamble&lt;/span&gt;&lt;/b&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; style=&apos;text-autospace:none&apos;&gt;    &lt;span style=&apos;font-size:10.0pt; font-family:Arial&apos;&gt; &lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; style=    &apos;text-align:justify;text-autospace:none&apos;&gt;&lt;span st!
 yle=    &apos;font-size:10.0pt;font-family:Arial&apos;&gt;The !
 licenses
 for most    software are designed to take away your freedom to share and    change it.  By contrast, the GNU General Public License is    intended to guarantee your freedom to share and change free    software--to make sure the software is free for all its users.     This General Public License applies to most of the Free    Software Foundation&apos;s software and to any other program whose    authors commit to using it.  (Some other Free Software    Foundation software is covered by the GNU Library General    Public License instead.)  You can apply it to your programs,    too.&lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; style=    &apos;text-align:justify;text-autospace:none&apos;&gt;&lt;span style=    &apos;font-size:10.0pt;font-family:Arial&apos;&gt; &lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; style=    &apos;text-align:justify;text-autospace:none&apos;&gt;&lt;span style=    &apos;font-size:10.0pt;font-family:Arial&apos;&gt;When we s!
 peak of free    software, we are referring to freedom, not price.  Our General    Public Licenses are designed to make sure that you have the    freedom to distribute copies of free software (and charge for    this service if you wish), that you receive source code or can    get it if you want it, that you can change the software or use    pieces of it in new free programs; and that you know you can do    these things.&lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; style=    &apos;text-align:justify;text-autospace:none&apos;&gt;&lt;span style=    &apos;font-size:10.0pt;font-family:Arial&apos;&gt; &lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; style=    &apos;text-align:justify;text-autospace:none&apos;&gt;&lt;span style=    &apos;font-size:10.0pt;font-family:Arial&apos;&gt;To protect your rights, we    need to make restrictions that forbid anyone to deny you these    rights or to ask you to surrender the rights. These    restrictions transla!
 te to certain responsibilities for you if    you distribute co!
 pies of 
the software, or if you modify    it.&lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; style=    &apos;text-align:justify;text-autospace:none&apos;&gt;&lt;span style=    &apos;font-size:10.0pt;font-family:Arial&apos;&gt; &lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; style=    &apos;text-align:justify;text-autospace:none&apos;&gt;&lt;span style=    &apos;font-size:10.0pt;font-family:Arial&apos;&gt;For example, if you    distribute copies of such a program, whether gratis or for a    fee, you must give the recipients all the rights that you have.     You must make sure that they, too, receive or can get the    source code.  And you must show them these terms so they know    their rights.&lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; style=    &apos;text-align:justify;text-autospace:none&apos;&gt;&lt;span style=    &apos;font-size:10.0pt;font-family:Arial&apos;&gt; &lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; s!
 tyle=    &apos;text-align:justify;text-autospace:none&apos;&gt;&lt;span style=    &apos;font-size:10.0pt;font-family:Arial&apos;&gt;We protect your rights    with two steps: (1) copyright the software, and (2) offer you    this license which gives you legal permission to copy,    distribute and/or modify the software.&lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; style=    &apos;text-align:justify;text-autospace:none&apos;&gt;&lt;span style=    &apos;font-size:10.0pt;font-family:Arial&apos;&gt; &lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; style=    &apos;text-align:justify;text-autospace:none&apos;&gt;&lt;span style=    &apos;font-size:10.0pt;font-family:Arial&apos;&gt;Also, for each author&apos;s    protection and ours, we want to make certain that everyone    understands that there is no warranty for this free software.     If the software is modified by someone else and passed on, we    want its recipients to know that what they have i!
 s not the    original, so that any problems introduced by othe!
 rs will 
not    reflect on the original authors&apos; reputations.&lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; style=    &apos;text-align:justify;text-autospace:none&apos;&gt;&lt;span style=    &apos;font-size:10.0pt;font-family:Arial&apos;&gt; &lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; style=    &apos;text-align:justify;text-autospace:none&apos;&gt;&lt;span style=    &apos;font-size:10.0pt;font-family:Arial&apos;&gt;Finally, any free program    is threatened constantly by software patents.  We wish to avoid    the danger that redistributors of a free program will    individually obtain patent licenses, in effect making the    program proprietary.  To prevent this, we have made it clear    that any patent must be licensed for everyone&apos;s free use or not    licensed at all.&lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; style=    &apos;text-align:justify;text-autospace:none&apos;&gt;&lt;span style=    &apos;font-size:10.0pt;f!
 ont-family:Arial&apos;&gt; &lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; style=    &apos;text-align:justify;text-autospace:none&apos;&gt;&lt;span style=    &apos;font-size:10.0pt;font-family:Arial&apos;&gt;The precise terms and    conditions for copying, distribution and modification    follow.&lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; style=&apos;text-autospace:none&apos;&gt;    &lt;span style=&apos;font-size:10.0pt; font-family:Arial&apos;&gt; &lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; style=&apos;text-autospace:none&apos;&gt;    &lt;span style=&apos;font-size:10.0pt; font-family:Arial&apos;&gt; &lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; align=&quot;center&quot; style=    &apos;text-align:center;text-autospace:none&apos;&gt;&lt;b&gt;&lt;span style=    &apos;font-size:10.0pt;font-family:Arial&apos;&gt;GNU GENERAL PUBLIC    LICENSE&lt;/span&gt;&lt;/b&gt;&lt;/p&gt;    &lt;p class=&quot;licenseSt!
 yle&quot; align=&quot;center&quot; style=    &apos;text-align:!
 center;t
ext-autospace:none&apos;&gt;&lt;b&gt;&lt;span style=    &apos;font-size:10.0pt;font-family:Arial&apos;&gt;TERMS AND CONDITIONS FOR    COPYING, DISTRIBUTION AND MODIFICATION&lt;/span&gt;&lt;/b&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; style=&apos;text-autospace:none&apos;&gt;    &lt;span style=&apos;font-size:10.0pt; font-family:Arial&apos;&gt; &lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; style=    &apos;text-align:justify;text-autospace:none&apos;&gt;&lt;span style=    &apos;font-size:10.0pt;font-family:Arial&apos;&gt;0. This License applies to    any program or other work which contains a notice placed by the    copyright holder saying it may be distributed under the terms    of this General Public License.  The &quot;Program&quot;, below, refers    to any such program or work, and a &quot;work based on the Program&quot;    means either the Program or any derivative work under copyright    law: that is to say, a work containing the Program or !
 a portion    of it, either verbatim or with modifications and/or translated    into another language.  (Hereinafter, translation is included    without limitation in the term &quot;modification&quot;.)  Each licensee    is addressed as &quot;you&quot;.&lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; style=    &apos;text-align:justify;text-autospace:none&apos;&gt;&lt;span style=    &apos;font-size:10.0pt;font-family:Arial&apos;&gt; &lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; style=    &apos;text-align:justify;text-autospace:none&apos;&gt;&lt;span style=    &apos;font-size:10.0pt;font-family:Arial&apos;&gt;Activities other than    copying, distribution and modification are not covered by this    License; they are outside its scope.  The act of running the    Program is not restricted, and the output from the Program is    covered only if its contents constitute a work based on the    Program (independent of having been made by running the   !
  Program). Whether that is true depends on what the Program   !
  does.&l
t;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; style=    &apos;text-align:justify;text-autospace:none&apos;&gt;&lt;span style=    &apos;font-size:10.0pt;font-family:Arial&apos;&gt; &lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; style=    &apos;text-align:justify;text-autospace:none&apos;&gt;&lt;span style=    &apos;font-size:10.0pt;font-family:Arial&apos;&gt;1. You may copy and    distribute verbatim copies of the Program&apos;s source code as you    receive it, in any medium, provided that you conspicuously and    appropriately publish on each copy an appropriate copyright    notice and disclaimer of warranty; keep intact all the notices    that refer to this License and to the absence of any warranty;    and give any other recipients of the Program a copy of this    License along with the Program.&lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; style=    &apos;text-align:justify;text-autospace:none&apos;&gt;&lt;span style=    !
 &apos;font-size:10.0pt;font-family:Arial&apos;&gt; &lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; style=    &apos;text-align:justify;text-autospace:none&apos;&gt;&lt;span style=    &apos;font-size:10.0pt;font-family:Arial&apos;&gt;You may charge a fee for    the physical act of transferring a copy, and you may at your    option offer warranty protection in exchange for a    fee.&lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; style=    &apos;text-align:justify;text-autospace:none&apos;&gt;&lt;span style=    &apos;font-size:10.0pt;font-family:Arial&apos;&gt; &lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; style=    &apos;text-align:justify;text-autospace:none&apos;&gt;&lt;span style=    &apos;font-size:10.0pt;font-family:Arial&apos;&gt;2. You may modify your    copy or copies of the Program or any portion of it, thus    forming a work based on the Program, and copy and distribute    such modifications or work under the terms of!
  Section 1 above,    provided that you also meet all of these !
 conditio
ns:&lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; style=    &apos;text-align:justify;text-autospace:none&apos;&gt;&lt;span style=    &apos;font-size:10.0pt;font-family:Arial&apos;&gt; &lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; style=    &apos;text-align:justify;text-autospace:none&apos;&gt;&lt;span style=    &apos;font-size:10.0pt;font-family:Arial&apos;&gt;a) You must cause the    modified files to carry prominent notices stating that you    changed the files and the date of any change.&lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; style=    &apos;text-align:justify;text-autospace:none&apos;&gt;&lt;span style=    &apos;font-size:10.0pt;font-family:Arial&apos;&gt; &lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; style=    &apos;text-align:justify;text-autospace:none&apos;&gt;&lt;span style=    &apos;font-size:10.0pt;font-family:Arial&apos;&gt;b) You must cause any work    that you distribute or publish, th!
 at in whole or in part    contains or is derived from the Program or any part thereof, to    be licensed as a whole at no charge to all third parties under    the terms of this License.&lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; style=    &apos;text-align:justify;text-autospace:none&apos;&gt;&lt;span style=    &apos;font-size:10.0pt;font-family:Arial&apos;&gt; &lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; style=    &apos;text-align:justify;text-autospace:none&apos;&gt;&lt;span style=    &apos;font-size:10.0pt;font-family:Arial&apos;&gt;c) If the modified program    normally reads commands interactively when run, you must cause    it, when started running for such interactive use in the most    ordinary way, to print or display an announcement including an    appropriate copyright notice and a notice that there is no    warranty (or else, saying that you provide a warranty) and that    users may redistribute the program under these condi!
 tions, and    telling the user how to view a copy of this Lice!
 nse.    
 (Exception: if the Program itself is interactive but does not    normally print such an announcement, your work based on the    Program is not required to print an announcement.)&lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; style=    &apos;text-align:justify;text-autospace:none&apos;&gt;&lt;span style=    &apos;font-size:10.0pt;font-family:Arial&apos;&gt; &lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; style=    &apos;text-align:justify;text-autospace:none&apos;&gt;&lt;span style=    &apos;font-size:10.0pt;font-family:Arial&apos;&gt; &lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; style=    &apos;text-align:justify;text-autospace:none&apos;&gt;&lt;span style=    &apos;font-size:10.0pt;font-family:Arial&apos;&gt;These requirements apply    to the modified work as a whole.  If identifiable sections of    that work are not derived from the Program, and can be    reasonably considered independent and separate works in    themsel!
 ves, then this License, and its terms, do not apply to    those sections when you distribute them as separate works.  But    when you distribute the same sections as part of a whole which    is a work based on the Program, the distribution of the whole    must be on the terms of this License, whose permissions for    other licensees extend to the entire whole, and thus to each    and every part regardless of who wrote it.&lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; style=    &apos;text-align:justify;text-autospace:none&apos;&gt;&lt;span style=    &apos;font-size:10.0pt;font-family:Arial&apos;&gt; &lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; style=    &apos;text-align:justify;text-autospace:none&apos;&gt;&lt;span style=    &apos;font-size:10.0pt;font-family:Arial&apos;&gt;Thus, it is not the intent    of this section to claim rights or contest your rights to work    written entirely by you; rather, the intent is to exercise the    right !
 to control the distribution of derivative or collective    wor!
 ks based
 on the Program.&lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; style=    &apos;text-align:justify;text-autospace:none&apos;&gt;&lt;span style=    &apos;font-size:10.0pt;font-family:Arial&apos;&gt; &lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; style=    &apos;text-align:justify;text-autospace:none&apos;&gt;&lt;span style=    &apos;font-size:10.0pt;font-family:Arial&apos;&gt;In addition, mere    aggregation of another work not based on the Program with the    Program (or with a work based on the Program) on a volume of a    storage or distribution medium does not bring the other work    under the scope of this License.&lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; style=    &apos;text-align:justify;text-autospace:none&apos;&gt;&lt;span style=    &apos;font-size:10.0pt;font-family:Arial&apos;&gt; &lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; style=    &apos;text-align:justify;text-autospace:none&apos;&gt;&lt;!
 span style=    &apos;font-size:10.0pt;font-family:Arial&apos;&gt;3. You may copy and    distribute the Program (or a work based on it, under Section 2)    in object code or executable form under the terms of Sections 1    and 2 above provided that you also do one of the    following:&lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; style=    &apos;text-align:justify;text-autospace:none&apos;&gt;&lt;span style=    &apos;font-size:10.0pt;font-family:Arial&apos;&gt; &lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; style=    &apos;text-align:justify;text-autospace:none&apos;&gt;&lt;span style=    &apos;font-size:10.0pt;font-family:Arial&apos;&gt;a) Accompany it with the    complete corresponding machine-readable source code, which must    be distributed under the terms of Sections 1 and 2 above on a    medium customarily used for software interchange;    or,&lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; style=    &apos;text-align:ju!
 stify;text-autospace:none&apos;&gt;&lt;span style=    &apos;fo!
 nt-size:
10.0pt;font-family:Arial&apos;&gt; &lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; style=    &apos;text-align:justify;text-autospace:none&apos;&gt;&lt;span style=    &apos;font-size:10.0pt;font-family:Arial&apos;&gt;b) Accompany it with a    written offer, valid for at least three years, to give any    third party, for a charge no more than your cost of physically    performing source distribution, a complete machine-readable    copy of the corresponding source code, to be distributed under    the terms of Sections 1 and 2 above on a medium customarily    used for software interchange; or,&lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; style=    &apos;text-align:justify;text-autospace:none&apos;&gt;&lt;span style=    &apos;font-size:10.0pt;font-family:Arial&apos;&gt; &lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; style=    &apos;text-align:justify;text-autospace:none&apos;&gt;&lt;span style=    &apos;font-size:10.0pt;font-fami!
 ly:Arial&apos;&gt;c) Accompany it with the    information you received as to the offer to distribute    corresponding source code.  (This alternative is allowed only    for noncommercial distribution and only if you received the    program in object code or executable form with such an offer,    in accord with Subsection b above.)&lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; style=    &apos;text-align:justify;text-autospace:none&apos;&gt;&lt;span style=    &apos;font-size:10.0pt;font-family:Arial&apos;&gt; &lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; style=    &apos;text-align:justify;text-autospace:none&apos;&gt;&lt;span style=    &apos;font-size:10.0pt;font-family:Arial&apos;&gt;The source code for a work    means the preferred form of the work for making modifications    to it.  For an executable work, complete source code means all    the source code for all modules it contains, plus any    associated interface definition files, plus!
  the scripts used to    control compilation and installation o!
 f the ex
ecutable.     However, as a special exception, the source code distributed    need not include anything that is normally distributed (in    either source or binary form) with the major components    (compiler, kernel, and so on) of the operating system on which    the executable runs, unless that component itself accompanies    the executable.&lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; style=    &apos;text-align:justify;text-autospace:none&apos;&gt;&lt;span style=    &apos;font-size:10.0pt;font-family:Arial&apos;&gt; &lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; style=    &apos;text-align:justify;text-autospace:none&apos;&gt;&lt;span style=    &apos;font-size:10.0pt;font-family:Arial&apos;&gt;If distribution of    executable or object code is made by offering access to copy    from a designated place, then offering equivalent access to    copy the source code from the same place counts as distribution    of the source code, even though t!
 hird parties are not compelled    to copy the source along with the object code.&lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; style=    &apos;text-align:justify;text-autospace:none&apos;&gt;&lt;span style=    &apos;font-size:10.0pt;font-family:Arial&apos;&gt; &lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; style=    &apos;text-align:justify;text-autospace:none&apos;&gt;&lt;span style=    &apos;font-size:10.0pt;font-family:Arial&apos;&gt; &lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; style=    &apos;text-align:justify;text-autospace:none&apos;&gt;&lt;span style=    &apos;font-size:10.0pt;font-family:Arial&apos;&gt;4. You may not copy,    modify, sublicense, or distribute the Program except as    expressly provided under this License.  Any attempt otherwise    to copy, modify, sublicense or distribute the Program is void,    and will automatically terminate your rights under this    License. However, parties who have receive!
 d copies, or rights,    from you under this License will not h!
 ave thei
r licenses    terminated so long as such parties remain in full    compliance.&lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; style=    &apos;text-align:justify;text-autospace:none&apos;&gt;&lt;span style=    &apos;font-size:10.0pt;font-family:Arial&apos;&gt; &lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; style=    &apos;text-align:justify;text-autospace:none&apos;&gt;&lt;span style=    &apos;font-size:10.0pt;font-family:Arial&apos;&gt;5. You are not required to    accept this License, since you have not signed it.  However,    nothing else grants you permission to modify or distribute the    Program or its derivative works.  These actions are prohibited    by law if you do not accept this License.  Therefore, by    modifying or distributing the Program (or any work based on the    Program), you indicate your acceptance of this License to do    so, and all its terms and conditions for copying, distributing    or modifying the Program or works!
  based on it.&lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; style=    &apos;text-align:justify;text-autospace:none&apos;&gt;&lt;span style=    &apos;font-size:10.0pt;font-family:Arial&apos;&gt; &lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; style=    &apos;text-align:justify;text-autospace:none&apos;&gt;&lt;span style=    &apos;font-size:10.0pt;font-family:Arial&apos;&gt;6. Each time you    redistribute the Program (or any work based on the Program),    the recipient automatically receives a license from the    original licensor to copy, distribute or modify the Program    subject to these terms and conditions.  You may not impose any    further restrictions on the recipients&apos; exercise of the rights    granted herein. You are not responsible for enforcing    compliance by third parties to this License.&lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; style=    &apos;text-align:justify;text-autospace:none&apos;&gt;&lt;span!
  style=    &apos;font-size:10.0pt;font-family:Arial&apos;&gt; !
 &lt;/spa
n&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; style=    &apos;text-align:justify;text-autospace:none&apos;&gt;&lt;span style=    &apos;font-size:10.0pt;font-family:Arial&apos;&gt;7. If, as a consequence of    a court judgment or allegation of patent infringement or for    any other reason (not limited to patent issues), conditions are    imposed on you (whether by court order, agreement or otherwise)    that contradict the conditions of this License, they do not    excuse you from the conditions of this License.  If you cannot    distribute so as to satisfy simultaneously your obligations    under this License and any other pertinent obligations, then as    a consequence you may not distribute the Program at all.  For    example, if a patent license would not permit royalty-free    redistribution of the Program by all those who receive copies    directly or indirectly through you, then the only way you could    satisfy both it and this License would be to refrain e!
 ntirely    from distribution of the Program.&lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; style=    &apos;text-align:justify;text-autospace:none&apos;&gt;&lt;span style=    &apos;font-size:10.0pt;font-family:Arial&apos;&gt; &lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; style=    &apos;text-align:justify;text-autospace:none&apos;&gt;&lt;span style=    &apos;font-size:10.0pt;font-family:Arial&apos;&gt;If any portion of this    section is held invalid or unenforceable under any particular    circumstance, the balance of the section is intended to apply    and the section as a whole is intended to apply in other    circumstances.&lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; style=    &apos;text-align:justify;text-autospace:none&apos;&gt;&lt;span style=    &apos;font-size:10.0pt;font-family:Arial&apos;&gt; &lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; style=    &apos;text-align:justify;text-autospace:none&ap!
 os;&gt;&lt;span style=    &apos;font-size:10.0pt;font-family:A!
 rial&apo
s;&gt;It is not the purpose of    this section to induce you to infringe any patents or other    property right claims or to contest validity of any such    claims; this section has the sole purpose of protecting the    integrity of the free software distribution system, which is    implemented by public license practices.  Many people have made    generous contributions to the wide range of software    distributed through that system in reliance on consistent    application of that system; it is up to the author/donor to    decide if he or she is willing to distribute software through    any other system and a licensee cannot impose that    choice.&lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; style=    &apos;text-align:justify;text-autospace:none&apos;&gt;&lt;span style=    &apos;font-size:10.0pt;font-family:Arial&apos;&gt; &lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; style=    &apos;text-align:justify;text-autospace:none&apos;&gt;&lt;sp!
 an style=    &apos;font-size:10.0pt;font-family:Arial&apos;&gt;This section is intended    to make thoroughly clear what is believed to be a consequence    of the rest of this License.&lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; style=    &apos;text-align:justify;text-autospace:none&apos;&gt;&lt;span style=    &apos;font-size:10.0pt;font-family:Arial&apos;&gt; &lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; style=    &apos;text-align:justify;text-autospace:none&apos;&gt;&lt;span style=    &apos;font-size:10.0pt;font-family:Arial&apos;&gt; &lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; style=    &apos;text-align:justify;text-autospace:none&apos;&gt;&lt;span style=    &apos;font-size:10.0pt;font-family:Arial&apos;&gt;8. If the distribution    and/or use of the Program is restricted in certain countries    either by patents or by copyrighted interfaces, the original    copyright holder who places the Program under this Licens!
 e may    add an explicit geographical distribution limitation !
 excludin
g    those countries, so that distribution is permitted only in or    among countries not thus excluded.  In such case, this License    incorporates the limitation as if written in the body of this    License.&lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; style=    &apos;text-align:justify;text-autospace:none&apos;&gt;&lt;span style=    &apos;font-size:10.0pt;font-family:Arial&apos;&gt; &lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; style=    &apos;text-align:justify;text-autospace:none&apos;&gt;&lt;span style=    &apos;font-size:10.0pt;font-family:Arial&apos;&gt;9. The Free Software    Foundation may publish revised and/or new versions of the    General Public License from time to time.  Such new versions    will be similar in spirit to the present version, but may    differ in detail to address new problems or    concerns.&lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; style=    &apos;text-align:justify;text-autospace:none&!
 apos;&gt;&lt;span style=    &apos;font-size:10.0pt;font-family:Arial&apos;&gt; &lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; style=    &apos;text-align:justify;text-autospace:none&apos;&gt;&lt;span style=    &apos;font-size:10.0pt;font-family:Arial&apos;&gt;Each version is given a    distinguishing version number.  If the Program specifies a    version number of this License which applies to it and &quot;any    later version&quot;, you have the option of following the terms and    conditions either of that version or of any later version    published by the Free Software Foundation.  If the Program does    not specify a version number of this License, you may choose    any version ever published by the Free Software    Foundation.&lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; style=    &apos;text-align:justify;text-autospace:none&apos;&gt;&lt;span style=    &apos;font-size:10.0pt;font-family:Arial&apos;&gt; &lt;/span&gt;&lt;/p&gt;    &lt;p!
  class=&quot;licenseStyle&quot; style=    &apos;text-align:jus!
 tify;tex
t-autospace:none&apos;&gt;&lt;span style=    &apos;font-size:10.0pt;font-family:Arial&apos;&gt;10. If you wish to    incorporate parts of the Program into other free programs whose    distribution conditions are different, write to the author to    ask for permission.  For software which is copyrighted by the    Free Software Foundation, write to the Free Software    Foundation; we sometimes make exceptions for this.  Our    decision will be guided by the two goals of preserving the free    status of all derivatives of our free software and of promoting    the sharing and reuse of software generally.&lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; style=&apos;text-autospace:none&apos;&gt;    &lt;span style=&apos;font-size:10.0pt; font-family:Arial&apos;&gt; &lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; align=&quot;center&quot; style=    &apos;text-align:center;text-autospace:none&apos;&gt;&lt;b&gt;&lt;span style=    &apos;font-size:10.0pt;fon!
 t-family:Arial&apos;&gt;NO WARRANTY&lt;/span&gt;&lt;/b&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; style=&apos;text-autospace:none&apos;&gt;    &lt;span style=&apos;font-size:10.0pt; font-family:Arial&apos;&gt; &lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; style=    &apos;text-align:justify;text-autospace:none&apos;&gt;&lt;span style=    &apos;font-size:10.0pt;font-family:Arial&apos;&gt;11. BECAUSE THE PROGRAM IS    LICENSED FREE OF CHARGE, THERE IS NO WARRANTY FOR THE PROGRAM,    TO THE EXTENT PERMITTED BY APPLICABLE LAW.  EXCEPT WHEN    OTHERWISE STATED IN WRITING THE COPYRIGHT HOLDERS AND/OR OTHER    PARTIES PROVIDE THE PROGRAM &quot;AS IS&quot; WITHOUT WARRANTY OF ANY    KIND, EITHER EXPRESSED OR IMPLIED, INCLUDING, BUT NOT LIMITED    TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A    PARTICULAR PURPOSE.  THE ENTIRE RISK AS TO THE QUALITY AND    PERFORMANCE OF THE PROGRAM IS WITH YOU.  SHOULD THE PROGRAM    PROVE DEFECTIVE, YO!
 U ASSUME THE COST OF ALL NECESSARY    SERVICING, REPAIR OR COR!
 RECTION.
&lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; style=    &apos;text-align:justify;text-autospace:none&apos;&gt;&lt;span style=    &apos;font-size:10.0pt;font-family:Arial&apos;&gt; &lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; style=    &apos;text-align:justify;text-autospace:none&apos;&gt;&lt;span style=    &apos;font-size:10.0pt;font-family:Arial&apos;&gt;12. IN NO EVENT UNLESS    REQUIRED BY APPLICABLE LAW OR AGREED TO IN WRITING WILL ANY    COPYRIGHT HOLDER, OR ANY OTHER PARTY WHO MAY MODIFY AND/OR    REDISTRIBUTE THE PROGRAM AS PERMITTED ABOVE, BE LIABLE TO YOU    FOR DAMAGES, INCLUDING ANY GENERAL, SPECIAL, INCIDENTAL OR    CONSEQUENTIAL DAMAGES ARISING OUT OF THE USE OR INABILITY TO    USE THE PROGRAM (INCLUDING BUT NOT LIMITED TO LOSS OF DATA OR    DATA BEING RENDERED INACCURATE OR LOSSES SUSTAINED BY YOU OR    THIRD PARTIES OR A FAILURE OF THE PROGRAM TO OPERATE WITH ANY    OTHER PROGRAMS), EVEN IF SUCH HOLDER OR OTHER PARTY HAS BE!
 EN    ADVISED OF THE POSSIBILITY OF SUCH DAMAGES.&lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; style=&apos;text-autospace:none&apos;&gt;    &lt;span style=&apos;font-size:10.0pt; font-family:Arial&apos;&gt; &lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; align=&quot;center&quot; style=    &apos;text-align:center;text-autospace:none&apos;&gt;&lt;b&gt;&lt;span style=    &apos;font-size:10.0pt;font-family:Arial&apos;&gt;END OF TERMS AND    CONDITIONS&lt;/span&gt;&lt;/b&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; style=&apos;text-autospace:none&apos;&gt;    &lt;span style=&apos;font-size:10.0pt; font-family:Arial&apos;&gt; &lt;/span&gt;&lt;/p&gt;  &lt;/div&gt;&lt;/body&gt;&lt;/html&gt;</translation>
     </message>
 </context>
 <context>
@@ -9555,6 +9603,11 @@
         <source>Root privileges are required to perform this operation.</source>
         <translation>Sono richesti i privilegi di amministratore per eseguire questa operazione.</translation>
     </message>
+    <message>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_encoding.cpp" line="127"/>
+        <source>Pause / Abort</source>
+        <translation>Pausa / Annulla </translation>
+    </message>
 </context>
 <context>
     <name>filtermainWindow</name>

Modified: branches/avidemux_2.4_branch/po/it.po
===================================================================
--- branches/avidemux_2.4_branch/po/it.po	2009-02-05 19:03:29 UTC (rev 4571)
+++ branches/avidemux_2.4_branch/po/it.po	2009-02-05 19:10:42 UTC (rev 4572)
@@ -3,7 +3,7 @@
 "Project-Id-Version: avidemux\n"
 "Report-Msgid-Bugs-To: \n"
 "POT-Creation-Date: 2006-10-04 22:09+0300\n"
-"PO-Revision-Date: 2008-10-18 09:53+0100\n"
+"PO-Revision-Date: 2009-02-03 14:44+0100\n"
 "Last-Translator: \n"
 "Language-Team: it\n"
 "MIME-Version: 1.0\n"
@@ -170,8 +170,8 @@
 #: avidemux/ADM_outputs/oplug_flv/oplug_flv.cpp:236
 #: avidemux/ADM_outputs/oplug_flv/oplug_flv.cpp:257
 #: avidemux/ADM_outputs/oplug_mp4/oplug_mp4.cpp:165
-#: avidemux/ADM_outputs/oplug_mp4/oplug_mp4.cpp:257
-#: avidemux/ADM_outputs/oplug_mp4/oplug_mp4.cpp:278
+#: avidemux/ADM_outputs/oplug_mp4/oplug_mp4.cpp:239
+#: avidemux/ADM_outputs/oplug_mp4/oplug_mp4.cpp:251
 #: avidemux/ADM_outputs/oplug_mpeg/op_mpegpass.cpp:221
 #: avidemux/ADM_outputs/oplug_mpeg/op_mpegpass.cpp:225
 #: avidemux/ADM_outputs/oplug_mpegFF/oplug_vcdff.cpp:379
@@ -407,33 +407,39 @@
 msgid "Attempt to open %s failed!"
 msgstr "Tentativo di aprire %s fallito!"
 
-#: avidemux/ADM_editor/ADM_edit.cpp:439
+#: avidemux/ADM_editor/ADM_edit.cpp:431
+msgid "Video dimensions don't match."
+msgstr "Le dimensioni video non corrispondono."
+
+#: avidemux/ADM_editor/ADM_edit.cpp:431
 msgid ""
-"You cannot mix different video dimensions yet. Using the partial video filter later, will not work around this problem. The workaround is:\n"
-"1.) \"resize\" / \"add border\" / \"crop\" each stream to the same resolution\n"
-"2.) concatinate them together"
+"You cannot mix different video dimensions yet. Using the partial video filter later will not work around this problem. The workaround is:\n"
+"\n"
+"1) \"Resize\" / \"Add Border\" / \"Crop\" each stream to the same resolution\n"
+"2) Concatenate them together"
 msgstr ""
-"Non puoi ancora mescolare dimensioni video differenti. Usare il filtro video parziale, non risolver? il problema. La soluzione ?:\n"
-"1.) \"ridimensiona\" / \"aggiungi bordi\" / \"ritaglia\" ogni flusso alla stessa risoluzione\n"
-"2.) concatenali insieme"
+"Non ? possibile unire video di dimensioni diverse. L'utilizzo del filtro video parziale non risolve il problema. La soluzione ? la seguente:\n"
+"\n"
+"1) ridimensiona, aggiungi bordi o ritaglia tutti i flussi alla stessa risoluzione\n"
+"2) concatenali insieme"
 
-#: avidemux/ADM_editor/ADM_edit.cpp:551
+#: avidemux/ADM_editor/ADM_edit.cpp:543
 msgid "Build Time Map"
 msgstr "Crea time map"
 
-#: avidemux/ADM_editor/ADM_edit.cpp:551
+#: avidemux/ADM_editor/ADM_edit.cpp:543
 msgid "Build VBR time map?"
 msgstr "Creare la time map VBR?"
 
-#: avidemux/ADM_editor/ADM_edit.cpp:585
+#: avidemux/ADM_editor/ADM_edit.cpp:577
 msgid "Use safe mode"
 msgstr "Usa modalit? sicura"
 
-#: avidemux/ADM_editor/ADM_edit.cpp:585
+#: avidemux/ADM_editor/ADM_edit.cpp:577
 msgid "H.264 detected"
 msgstr "H.264 rilevato"
 
-#: avidemux/ADM_editor/ADM_edit.cpp:585
+#: avidemux/ADM_editor/ADM_edit.cpp:577
 msgid ""
 "If the file is using B-frames as reference it can lead to a crash or stuttering.\n"
 "Avidemux can use another mode which is safe but YOU WILL LOSE FRAME ACCURACY.\n"
@@ -443,47 +449,47 @@
 "Avidemux pu? utilizzare un'altra modalit? pi? sicura, ma PERDERAI PRECISIONE NEI FOTOGRAMMI.\n"
 "Vuoi usare questa modalit??"
 
-#: avidemux/ADM_editor/ADM_edit.cpp:715
+#: avidemux/ADM_editor/ADM_edit.cpp:707
 msgid "Packed Bitstream detected"
 msgstr "Flusso di bit compresso rilevato"
 
-#: avidemux/ADM_editor/ADM_edit.cpp:716
+#: avidemux/ADM_editor/ADM_edit.cpp:708
 msgid "Do you want me to unpack it ?"
 msgstr "Vuoi decomprimerlo?"
 
-#: avidemux/ADM_editor/ADM_edit.cpp:736
+#: avidemux/ADM_editor/ADM_edit.cpp:728
 msgid "Could not unpack the video"
 msgstr "Impossibile decomprimere il video"
 
-#: avidemux/ADM_editor/ADM_edit.cpp:736
+#: avidemux/ADM_editor/ADM_edit.cpp:728
 msgid "Using backup decoder - not frame accurate."
 msgstr "Utilizzo decodificatore backup - non preciso sui fotogrammi."
 
-#: avidemux/ADM_editor/ADM_edit.cpp:741
+#: avidemux/ADM_editor/ADM_edit.cpp:733
 msgid "Weird"
 msgstr "Strano"
 
-#: avidemux/ADM_editor/ADM_edit.cpp:741
+#: avidemux/ADM_editor/ADM_edit.cpp:733
 msgid "The unpacking succeedeed but the index is still not up to date."
 msgstr "La decompressione ? riuscita ma l'indice non ? ancora aggiornato."
 
-#: avidemux/ADM_editor/ADM_edit.cpp:747
+#: avidemux/ADM_editor/ADM_edit.cpp:739
 msgid "Troubles ahead"
 msgstr "Problemi avanti"
 
-#: avidemux/ADM_editor/ADM_edit.cpp:747
+#: avidemux/ADM_editor/ADM_edit.cpp:739
 msgid "This a VOP packed AVI."
 msgstr "Questo ? un AVI compresso con VOP."
 
-#: avidemux/ADM_editor/ADM_edit.cpp:758
+#: avidemux/ADM_editor/ADM_edit.cpp:750
 msgid "Index is not up to date"
 msgstr "L'indice non ? aggiornato"
 
-#: avidemux/ADM_editor/ADM_edit.cpp:758
+#: avidemux/ADM_editor/ADM_edit.cpp:750
 msgid "You should use Tool->Rebuild frame. Do it now ?"
 msgstr "Dovresti usare Strumenti -> Ricostruisci fotogrammi. Vuoi farlo ora?"
 
-#: avidemux/ADM_editor/ADM_edit.cpp:1520
+#: avidemux/ADM_editor/ADM_edit.cpp:1512
 msgid ""
 "This looks like mpeg\n"
 " Do you want to index it?"
@@ -491,7 +497,7 @@
 "Questo sembra un file mpeg\n"
 " Vuoi indicizzarlo?"
 
-#: avidemux/ADM_editor/ADM_edit.cpp:1572
+#: avidemux/ADM_editor/ADM_edit.cpp:1564
 msgid "Indexing failed"
 msgstr "Indicizzazione fallita"
 
@@ -1129,6 +1135,7 @@
 msgstr "Aggiunge un'immagine png come logo."
 
 #: avidemux/ADM_filter/filter_declaration.cpp:182
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_animated.cpp:53
 msgid "Animated Menu"
 msgstr "Menu animato"
 
@@ -1468,7 +1475,7 @@
 msgstr ""
 "? avvenuto un errore fatale.\n"
 "\n"
-"Clicca OK per visualizzare le informazioni di debug. Potrebbe richiedere alcuni minuti."
+"Clicca OK per produrre le informazioni di debug. Potrebbe richiedere alcuni minuti."
 
 #: avidemux/ADM_osSupport/ADM_crashdump.cpp:437
 msgid "Load it"
@@ -1617,7 +1624,7 @@
 #: avidemux/ADM_outputs/oplug_flv/oplug_flv.cpp:188
 #: avidemux/ADM_outputs/oplug_flv/oplug_flv.cpp:240
 #: avidemux/ADM_outputs/oplug_mp4/oplug_mp4.cpp:163
-#: avidemux/ADM_outputs/oplug_mp4/oplug_mp4.cpp:261
+#: avidemux/ADM_outputs/oplug_mp4/oplug_mp4.cpp:243
 #: avidemux/ADM_outputs/oplug_ogm/op_ogaudio.cpp:70
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_audioFilter.cpp:80
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_audioFilter.cpp:89
@@ -1735,7 +1742,7 @@
 msgstr "Inizializzazione filtro fallita"
 
 #: avidemux/ADM_outputs/oplug_avi/op_saveprocess.cpp:128
-#: avidemux/ADM_outputs/oplug_mp4/oplug_mp4.cpp:418
+#: avidemux/ADM_outputs/oplug_mp4/oplug_mp4.cpp:420
 #: avidemux/ADM_outputs/oplug_ogm/op_ogsaveprocess.cpp:103
 msgid ""
 "\n"
@@ -1745,7 +1752,7 @@
 " Riutilizzare il file log esistente?"
 
 #: avidemux/ADM_outputs/oplug_avi/op_saveprocess.cpp:137
-#: avidemux/ADM_outputs/oplug_mp4/oplug_mp4.cpp:426
+#: avidemux/ADM_outputs/oplug_mp4/oplug_mp4.cpp:428
 msgid "1st Pass"
 msgstr "1a passata"
 
@@ -1760,14 +1767,15 @@
 #: avidemux/ADM_outputs/oplug_mpegFF/oplug_vcdff.cpp:373
 #: avidemux/ADM_outputs/oplug_ogm/op_ogsaveprocess.cpp:167
 msgid "Encoding"
-msgstr "Codifica in corso"
+msgstr "Codifica"
 
 #: avidemux/ADM_outputs/oplug_avi/op_saveprocess.cpp:269
-#: avidemux/ADM_outputs/oplug_mp4/oplug_mp4.cpp:501
+#: avidemux/ADM_outputs/oplug_mp4/oplug_mp4.cpp:503
 msgid "2nd Pass"
 msgstr "2a passata"
 
 #: avidemux/ADM_outputs/oplug_avi/op_savesmart.cpp:107
+#: avidemux/gui_savenew.cpp:351
 msgid "Smart Copy"
 msgstr "Copia intelligente"
 
@@ -1783,23 +1791,23 @@
 
 #: avidemux/ADM_outputs/oplug_dummy/oplug_dummy.cpp:206
 #: avidemux/ADM_outputs/oplug_flv/oplug_flv.cpp:321
-#: avidemux/ADM_outputs/oplug_mp4/oplug_mp4.cpp:346
-#: avidemux/ADM_outputs/oplug_mp4/oplug_mp4.cpp:462
+#: avidemux/ADM_outputs/oplug_mp4/oplug_mp4.cpp:300
+#: avidemux/ADM_outputs/oplug_mp4/oplug_mp4.cpp:464
 #: avidemux/ADM_outputs/oplug_mpeg/op_mpegpass.cpp:352
 msgid "Error while encoding"
 msgstr "Errore durante la codifica"
 
 #: avidemux/ADM_outputs/oplug_dummy/oplug_dummy.cpp:213
 #: avidemux/ADM_outputs/oplug_flv/oplug_flv.cpp:328
-#: avidemux/ADM_outputs/oplug_mp4/oplug_mp4.cpp:353
-#: avidemux/ADM_outputs/oplug_mp4/oplug_mp4.cpp:469
+#: avidemux/ADM_outputs/oplug_mp4/oplug_mp4.cpp:307
+#: avidemux/ADM_outputs/oplug_mp4/oplug_mp4.cpp:471
 msgid "KeyFrame error"
 msgstr "Errore fotogramma chiave"
 
 #: avidemux/ADM_outputs/oplug_dummy/oplug_dummy.cpp:213
 #: avidemux/ADM_outputs/oplug_flv/oplug_flv.cpp:328
-#: avidemux/ADM_outputs/oplug_mp4/oplug_mp4.cpp:353
-#: avidemux/ADM_outputs/oplug_mp4/oplug_mp4.cpp:469
+#: avidemux/ADM_outputs/oplug_mp4/oplug_mp4.cpp:307
+#: avidemux/ADM_outputs/oplug_mp4/oplug_mp4.cpp:471
 msgid ""
 "The beginning frame is not a key frame.\n"
 "Please move the A marker."
@@ -1829,7 +1837,7 @@
 msgstr "La frequenza deve essere 44100, 22050 o 11025 Hz."
 
 #: avidemux/ADM_outputs/oplug_flv/oplug_flv.cpp:225
-#: avidemux/ADM_outputs/oplug_mp4/oplug_mp4.cpp:230
+#: avidemux/ADM_outputs/oplug_mp4/oplug_mp4.cpp:212
 msgid "Cannot initialize the audio stream"
 msgstr "Impossibile inizializzare il flusso audio"
 
@@ -1837,11 +1845,11 @@
 msgid "PSP"
 msgstr "PSP"
 
-#: avidemux/ADM_outputs/oplug_mp4/oplug_mp4.cpp:248
+#: avidemux/ADM_outputs/oplug_mp4/oplug_mp4.cpp:230
 msgid "Invalid audio stream detected"
 msgstr "Rilevato flusso audio non valido"
 
-#: avidemux/ADM_outputs/oplug_mp4/oplug_mp4.cpp:248
+#: avidemux/ADM_outputs/oplug_mp4/oplug_mp4.cpp:230
 msgid ""
 "The audio stream may be invalid for this container.\n"
 "\n"
@@ -2037,7 +2045,7 @@
 msgstr "Seleziona immagine di sfonfo"
 
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_animated.cpp:37
-msgid "_NTSC(default is Pal):"
+msgid "_NTSC (default is PAL):"
 msgstr "N_TSC (predefinito ? Pal):"
 
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_animated.cpp:38
@@ -2056,11 +2064,6 @@
 msgid "Timecode:"
 msgstr "Timecode:"
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_animated.cpp:53
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_SVCD.cpp:70
-msgid "MPEG-2 Configuration"
-msgstr "Configurazione MPEG-2"
-
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_audioconfig.cpp:56
 msgid "Audio Configuration"
 msgstr "Configurazione audio"
@@ -3147,6 +3150,10 @@
 msgid "_Delay (ms):"
 msgstr "_Ritardo (ms):"
 
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_SVCD.cpp:70
+msgid "MPEG-2 Configuration"
+msgstr "Configurazione MPEG-2"
+
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_tdeint.cpp:45
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_tdeint.cpp:51
 msgid "Auto (might not work)"
@@ -8367,7 +8374,7 @@
 
 #: avidemux/gtk_gui.cpp:1103
 msgid "Something failed when appending"
-msgstr "Qualcosa ? fallito durante l'aggiunta"
+msgstr "Errore durante l'aggiunta"
 
 #: avidemux/gtk_gui.cpp:1114
 #: avidemux/gtk_gui.cpp:1944
@@ -8564,6 +8571,11 @@
 msgid "_External file:"
 msgstr "File _esterno:"
 
+#: avidemux/gtk_gui.cpp:2035
+#, c-format
+msgid "Audio track %d (%s/%d channels/%d kbit per s/%d ms shift)"
+msgstr "Traccia audio %d (%s/%d canali/%d kbit per s/ritardo %d ms)"
+
 #: avidemux/gtk_gui.cpp:2041
 msgid "_Track from video:"
 msgstr "_Traccia dal video:"
@@ -8730,47 +8742,51 @@
 msgid "Cannot decode the frame."
 msgstr "Impossibile decodificare il fotogramma."
 
-#: avidemux/gui_savenew.cpp:89
+#: avidemux/gui_savenew.cpp:88
 msgid "Dual audio can only be used in copy mode"
 msgstr "Il doppio audio pu? essere usato solo in modalit? copia"
 
-#: avidemux/gui_savenew.cpp:89
+#: avidemux/gui_savenew.cpp:88
 msgid "Select Copy as the video codec."
 msgstr "Seleziona Copia come codec video."
 
-#: avidemux/gui_savenew.cpp:209
-#: avidemux/gui_savenew.cpp:225
-#: avidemux/gui_savenew.cpp:238
+#: avidemux/gui_savenew.cpp:208
+#: avidemux/gui_savenew.cpp:224
+#: avidemux/gui_savenew.cpp:237
 msgid "Incompatible output format"
 msgstr "Formato in uscita incompatibile"
 
-#: avidemux/gui_savenew.cpp:259
+#: avidemux/gui_savenew.cpp:258
 msgid "There is no second track"
 msgstr "Non c'? una seconda traccia"
 
-#: avidemux/gui_savenew.cpp:259
+#: avidemux/gui_savenew.cpp:258
 msgid "Select a second audio track in the Audio menu."
 msgstr "Seleziona una seconda traccia nel menu Audio."
 
-#: avidemux/gui_savenew.cpp:263
+#: avidemux/gui_savenew.cpp:262
 msgid "Select dual audio AVI to write"
 msgstr "Seleziona il file AVI con doppio audio da scrivere"
 
-#: avidemux/gui_savenew.cpp:285
-#: avidemux/gui_savenew.cpp:303
+#: avidemux/gui_savenew.cpp:284
+#: avidemux/gui_savenew.cpp:302
 msgid "This cannot have packed VOP"
 msgstr "Non pu? avere VOP compresso"
 
-#: avidemux/gui_savenew.cpp:285
-#: avidemux/gui_savenew.cpp:303
+#: avidemux/gui_savenew.cpp:284
+#: avidemux/gui_savenew.cpp:302
 msgid "It is not MPEG-4 video. File will not be saved."
 msgstr "Non ? un video MPEG-4. Il file non verr? salvato."
 
-#: avidemux/gui_savenew.cpp:349
+#: avidemux/gui_savenew.cpp:348
 msgid ""
 "You may need smart copy.\n"
-" Enable it ?"
+"Enable it?"
 msgstr ""
 "Potresti avere bisogno di una copia intelligente.\n"
-" Attivarla?"
+"Attivarla?"
 
+#: avidemux/gui_savenew.cpp:351
+msgid "_Q factor (set 4):"
+msgstr "Fattore _Q (4 predefinito):"
+



From gruntster at mail.berlios.de  Thu Feb  5 21:04:21 2009
From: gruntster at mail.berlios.de (gruntster at mail.berlios.de)
Date: Thu, 5 Feb 2009 21:04:21 +0100
Subject: [Avidemux-svn-commit] r4573 - in
	branches/avidemux_2.5_branch_gruntster: avidemux
	avidemux/ADM_editor avidemux/ADM_outputs/oplug_mp4
	avidemux/ADM_toolkit
	avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog po
Message-ID: <200902052004.n15K4L1m025851@sheep.berlios.de>

Author: gruntster
Date: 2009-02-05 21:04:06 +0100 (Thu, 05 Feb 2009)
New Revision: 4573

Modified:
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_editor/ADM_edit.cpp
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_outputs/oplug_mp4/oplug_mp4.cpp
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_toolkit/automation.cpp
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_props.cpp
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/alert_qt4.cpp
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/vobsub.ui
   branches/avidemux_2.5_branch_gruntster/avidemux/gui_savenew.cpp
   branches/avidemux_2.5_branch_gruntster/po/avidemux_it.ts
   branches/avidemux_2.5_branch_gruntster/po/it.po
Log:
[Merge] integrate changes from 2.4 branch (r4572)

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_editor/ADM_edit.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_editor/ADM_edit.cpp	2009-02-05 19:10:42 UTC (rev 4572)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_editor/ADM_edit.cpp	2009-02-05 20:04:06 UTC (rev 4573)
@@ -415,19 +415,11 @@
       aviInfo info0, infox;
       _videos[   0     ]._aviheader->getVideoInfo (&info0);
       _videos[_nb_video]._aviheader->getVideoInfo (&infox);
-      if( info0.width != infox.width || info0.height != infox.height ){
-        char str[512+1];
-         str[0] = '\0';
-         if( info0.width != infox.width )
-            strcpy(str,"width");
-         if( info0.height != infox.height )
-            snprintf(str+strlen(str),512-strlen(str),
-              "%sheight%sdifferent between first and this video stream",
-                 (strlen(str)?" and ":""),
-                 (strlen(str)?" are ":" is ") );
-         str[512] = '\0';
-         GUI_Error_HIG(str,QT_TR_NOOP("You cannot mix different video dimensions yet. Using the partial video filter later, will not work around this problem. The workaround is:\n1.) \"resize\" / \"add border\" / \"crop\" each stream to the same resolution\n2.) concatinate them together"));
-         delete _videos[_nb_video]._aviheader;
+
+      if(info0.width != infox.width || info0.height != infox.height)
+	  {
+         GUI_Error_HIG(QT_TR_NOOP("Video dimensions don't match."), QT_TR_NOOP("You cannot mix different video dimensions yet. Using the partial video filter later will not work around this problem. The workaround is:\n\n1) \"Resize\" / \"Add Border\" / \"Crop\" each stream to the same resolution\n2) Concatenate them together"));
+		 delete _videos[_nb_video]._aviheader;
          return 0;
       }
    }

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_outputs/oplug_mp4/oplug_mp4.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_outputs/oplug_mp4/oplug_mp4.cpp	2009-02-05 19:10:42 UTC (rev 4572)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_outputs/oplug_mp4/oplug_mp4.cpp	2009-02-05 20:04:06 UTC (rev 4573)
@@ -371,10 +371,7 @@
 					  }
 				  }
 				  else
-				  {
-					  r = 0;
 					  break;
-				  }
 			  }
 
 			  muxer->writeVideoPacket(&bitstream);

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_toolkit/automation.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_toolkit/automation.cpp	2009-02-05 19:10:42 UTC (rev 4572)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_toolkit/automation.cpp	2009-02-05 20:04:06 UTC (rev 4573)
@@ -183,9 +183,9 @@
         {"audio-map",		0,"build audio map (MP3 VBR)",	call_buildtimemap},
         {"audio-bitrate",	1,"set audio encoding bitrate",	call_audiobitrate},
         {"fps",	                1,"set frames per second",	call_fps},
-        {"audio-codec",		1,"set audio codec (MP2/MP3/AC3/NONE (WAV PCM)/TWOLAME/COPY)",call_audiocodec},
+        {"audio-codec",		1,"set audio codec (AAC/AC3/COPY/MP2/MP3/NONE (WAV PCM)/TWOLAME)",call_audiocodec},
         
-        {"video-codec",		1,"set video codec (Divx/Xvid/FFmpeg4/VCD/SVCD/DVD/XVCD/XSVCD/COPY)",				call_videocodec},
+        {"video-codec",		1,"set video codec (COPY/DV/DVD/FFHUFF/FFmpeg4/FFV1/FLV1/H263/HUFF/MJPEG/REQUANT/SVCD/VCD/x264/XDVD/Xvid4/XVCD/XSVCD/Y800/YV12)", call_videocodec},
         {"video-conf",		1	,"set video codec conf (cq=q|cbr=br|2pass=size)[,mbr=br][,matrix=(0|1|2|3)]",				call_videoconf},
         {"reuse-2pass-log",	0	,"reuse 2pass logfile if it exists",	set_reuse_2pass_log},
         {"set-pp",		2	,"set post processing default value, value(1=hdeblok|2=vdeblock|4=dering) and strength (0-5)",
@@ -387,6 +387,10 @@
 {
 	if(!strcasecmp(p,"MP2"))
 		audio_selectCodecByTag(WAV_MP2);
+#ifdef USE_FAAC
+	else if(!strcasecmp(p,"AAC"))
+		audioCodecSetcodec( AUDIOENC_FAAC );
+#endif
 	else if(!strcasecmp(p,"AC3"))
 		audio_selectCodecByTag( WAV_AC3 );
 	else if(!strcasecmp(p,"MP3"))
@@ -473,9 +477,9 @@
           printf("\n    --%s, %s ", reaction_table[i].string,reaction_table[i].help_string);
           switch(reaction_table[i].have_arg)
           {
-                  case 0:	 printf(" ( no arg )");break;
-                  case 1:	 printf(" (one arg )");break;
-                  case 2:	 printf(" (two args )");break;
+                  case 0:	 printf(" (no args)");break;
+                  case 1:	 printf(" (one arg)");break;
+                  case 2:	 printf(" (two args)");break;
                   case 3:	 printf(" (three args) ");break;
 
           }

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_props.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_props.cpp	2009-02-05 19:10:42 UTC (rev 4572)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_props.cpp	2009-02-05 20:04:06 UTC (rev 4573)
@@ -62,7 +62,7 @@
         har=video_body->getPARHeight();
         getAspectRatioFromAR(war,har, &s);
 		FILLTEXT5(LabelAspectRatio,QT_TR_NOOP("%s (%u:%u)"), s,war,har);
-#define SET_YES(a,b) ui.a->setText(yesno[b])
+#define SET_YES(a,b) ui.a->setText(QString::fromUtf8(yesno[b]))
 #define FILLQT_TR_NOOP(q) ui.q->setText(QString::fromUtf8(text));
         SET_YES(LabelPackedBitstream,vop);
         SET_YES(LabelQuarterPixel,qpel);

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/alert_qt4.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/alert_qt4.cpp	2009-02-05 19:10:42 UTC (rev 4572)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/alert_qt4.cpp	2009-02-05 20:04:06 UTC (rev 4573)
@@ -43,114 +43,117 @@
 }
 
 //****************************************************************************************************
-void            GUI_Info_HIG(const ADM_LOG_LEVEL level,const char *primary, const char *secondary_format)
+void GUI_Info_HIG(const ADM_LOG_LEVEL level,const char *primary, const char *secondary_format)
 {
-  uint32_t msglvl=2;
-  char *string;
-  char alertstring[1024];
+	uint32_t msglvl = 2;
+	QString alertString;
 
-        prefs->get(MESSAGE_LEVEL,&msglvl);
+	prefs->get(MESSAGE_LEVEL, &msglvl);
 
-        if(msglvl<level)
-        {
-                printf("Info : %s \n",primary);
-                return;
-        }
+	if (msglvl<level)
+	{
+		printf("Info: %s\n",primary);
+		return;
+	}
 
-        if(! secondary_format)
-        {
-            snprintf(alertstring,1024,"<big><b>%s</b></big>",primary);
-         }else
-         {
-        	 snprintf(alertstring,1024,"<big><b>%s</b></big><br><br>%s",primary,secondary_format);
-         }
-        QMessageBox::StandardButton reply;
-          reply = QMessageBox::information(qtLastRegisteredDialog(), QString::fromUtf8(QT_TR_NOOP("Info")),
-                                    QString::fromUtf8(alertstring),
-                                    QMessageBox::Ok );
+	if (!secondary_format)
+		alertString = "<big><b>" + QString::fromUtf8(primary) + "</b></big>";
+	else
+	{
+		alertString = "<big><b>" + QString::fromUtf8(primary) + "</b></big><br><br>" + QString::fromUtf8(secondary_format);
+		alertString.replace("\n", "<br>");
+	}
 
+	QMessageBox::StandardButton reply;
+
+	reply = QMessageBox::information(qtLastRegisteredDialog(), QString::fromUtf8(QT_TR_NOOP("Info")),
+		alertString, QMessageBox::Ok);
 }
 //****************************************************************************************************
-void            GUI_Error_HIG(const char *primary, const char *secondary_format)
+void GUI_Error_HIG(const char *primary, const char *secondary_format)
 {
-  uint32_t msglvl=2;
-  char *string;
-  char alertstring[1024];
-  
-  
-        prefs->get(MESSAGE_LEVEL,&msglvl);
+	uint32_t msglvl = 2;
+	QString alertString;
 
-        if(msglvl==ADM_LOG_NONE) 
-        {
-                printf("Error :%s\n",primary);
-                return;
-        }
+	prefs->get(MESSAGE_LEVEL, &msglvl);
 
-        if(! secondary_format)
-        {
-            snprintf(alertstring,1024,"<big><b>%s</b></big>",primary);
-         }else
-         {
-        	 snprintf(alertstring,1024,"<big><b>%s</b></big><br><br>%s",primary,secondary_format);
-         }
-          QMessageBox::StandardButton reply;
-          reply = QMessageBox::critical(qtLastRegisteredDialog(), QString::fromUtf8(QT_TR_NOOP("Info")),
-                                    QString::fromUtf8(alertstring),
-                                    QMessageBox::Ok );
+	if (msglvl == ADM_LOG_NONE)
+	{
+		printf("Error: %s\n", primary);
+		return;
+	}
+
+	if (!secondary_format)
+		alertString = "<big><b>" + QString::fromUtf8(primary) + "</b></big>";
+	else
+	{
+		alertString = "<big><b>" + QString::fromUtf8(primary) + "</b></big><br><br>" + QString::fromUtf8(secondary_format);
+		alertString.replace("\n", "<br>");
+	}
+
+	QMessageBox::StandardButton reply;
+
+	reply = QMessageBox::critical(qtLastRegisteredDialog(), QString::fromUtf8(QT_TR_NOOP("Info")),
+		alertString, QMessageBox::Ok);
 }
 //****************************************************************************************************
-int             GUI_Confirmation_HIG(const char *button_confirm, const char *primary, const char *secondary_format)
+int GUI_Confirmation_HIG(const char *button_confirm, const char *primary, const char *secondary_format)
 {
-uint32_t msglvl=2;
-char alertstring[1024];
+	QString alertString;
 
-        if (beQuiet)
-              {
-                      printf("Info: %s\n", primary);
-                      return 0;
-              }
-        
-        if (!secondary_format)
-        {
-              snprintf(alertstring,1024,"<big><b>%s</b></big>",primary);
-        }
-        else
-        {	
-        	snprintf(alertstring,1024,"<big><b>%s</b></big><br><br>%s",primary,secondary_format);
-        }
-          QMessageBox::StandardButton reply;
-          reply = QMessageBox::question(qtLastRegisteredDialog(), QString::fromUtf8(QT_TR_NOOP("Confirmation")),
-                                    QString::fromUtf8(alertstring),
-                                    QMessageBox::Yes | QMessageBox::No );
-          if(reply==QMessageBox::Yes) return 1;
-        return 0; 
+	if (beQuiet)
+	{
+		printf("Info: %s\n", primary);
+		return 0;
+	}
+
+	if (!secondary_format)
+		alertString = "<big><b>" + QString::fromUtf8(primary) + "</b></big>";
+	else
+	{
+		alertString = "<big><b>" + QString::fromUtf8(primary) + "</b></big><br><br>" + QString::fromUtf8(secondary_format);
+		alertString.replace("\n", "<br>");
+	}
+
+	QMessageBox::StandardButton reply;
+
+	reply = QMessageBox::question(qtLastRegisteredDialog(), QString::fromUtf8(QT_TR_NOOP("Confirmation")),
+		alertString, QMessageBox::Yes | QMessageBox::No);
+
+	if (reply == QMessageBox::Yes)
+		return 1;
+
+	return 0;
 }
 //****************************************************************************************************
-int             GUI_YesNo(const char *primary, const char *secondary_format)
+int GUI_YesNo(const char *primary, const char *secondary_format)
 {
-uint32_t msglvl=2;
-char alertstring[1024];
-char alertstring2[1024];
-        if (beQuiet)
-              {
-                      printf("Info: %s\n", primary);
-                      return 0;
-              }
-        
-        if (!secondary_format)
-        {
-              snprintf(alertstring,1024,"<big><b>%s</b></big>",primary);
-        }
-        else
-        {	
-        	snprintf(alertstring,1024,"<big><b>%s</b></big><br><br>%s",primary,secondary_format);
-        }
-          QMessageBox::StandardButton reply;
-          reply = QMessageBox::question(qtLastRegisteredDialog(), QString::fromUtf8(QT_TR_NOOP("Confirmation")),
-                                    QString::fromUtf8(alertstring),
-                                    QMessageBox::Yes | QMessageBox::No );
-          if(reply==QMessageBox::Yes) return 1;
-        return 0; 
+	uint32_t msglvl = 2;
+	QString alertString;
+
+	if (beQuiet)
+	{
+		printf("Info: %s\n", primary);
+		return 0;
+	}
+
+	if (!secondary_format)
+		alertString = "<big><b>" + QString::fromUtf8(primary) + "</b></big>";
+	else
+	{
+		alertString = "<big><b>" + QString::fromUtf8(primary) + "</b></big><br><br>" + QString::fromUtf8(secondary_format);
+		alertString.replace("\n", "<br>");
+	}
+
+	QMessageBox::StandardButton reply;
+
+	reply = QMessageBox::question(qtLastRegisteredDialog(), QString::fromUtf8(QT_TR_NOOP("Confirmation")),
+		alertString, QMessageBox::Yes | QMessageBox::No);
+
+	if (reply == QMessageBox::Yes)
+		return 1;
+
+	return 0; 
 }
 //****************************************************************************************************
 int             GUI_Question(const char *alertstring)

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/vobsub.ui
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/vobsub.ui	2009-02-05 19:10:42 UTC (rev 4572)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/vobsub.ui	2009-02-05 20:04:06 UTC (rev 4573)
@@ -10,7 +10,7 @@
    </rect>
   </property>
   <property name="windowTitle" >
-   <string>Subtitle Font Size and Position</string>
+   <string>VobSub Settings</string>
   </property>
   <layout class="QVBoxLayout" >
    <property name="margin" >

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/gui_savenew.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/gui_savenew.cpp	2009-02-05 19:10:42 UTC (rev 4572)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/gui_savenew.cpp	2009-02-05 20:04:06 UTC (rev 4573)
@@ -40,6 +40,7 @@
 #include "ADM_outputs/oplug_avi/op_saveprocess.h"
 #include "ADM_outputs/oplug_avi/op_savesmart.hxx"
 
+#include "DIA_enter.h"
 
 #include "DIA_fileSel.h"
 #include "ADM_userInterfaces/ADM_commonUI/GUI_ui.h"
@@ -335,11 +336,11 @@
                   }
                   else
                   {
-                    if(GUI_Question(QT_TR_NOOP("You may need smart copy.\n Enable it ?")))
+                    if (GUI_Question(QT_TR_NOOP("You may need smart copy.\nEnable it?")))
                     {
                         value=4;
-                        if( ! DIA_GetIntegerValue(&value, 2, 31, "_Q factor (set 4):",""))
-                                      return 0;
+                        if (!DIA_GetIntegerValue(&value, 2, 31, QT_TR_NOOP("Smart Copy"), QT_TR_NOOP("_Q factor (set 4):")))
+							return 0;
                         nw=new   GenericAviSaveSmart(value);
                     }
                 }

Modified: branches/avidemux_2.5_branch_gruntster/po/avidemux_it.ts
===================================================================
--- branches/avidemux_2.5_branch_gruntster/po/avidemux_it.ts	2009-02-05 19:10:42 UTC (rev 4572)
+++ branches/avidemux_2.5_branch_gruntster/po/avidemux_it.ts	2009-02-05 20:04:06 UTC (rev 4573)
@@ -1,6 +1,5 @@
 <?xml version="1.0" encoding="utf-8"?>
 <!DOCTYPE TS><TS version="1.1" language="it">
-<defaultcodec></defaultcodec>
 <context>
     <name></name>
     <message>
@@ -279,11 +278,6 @@
         <translation>Immagine di _sfonfo:</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_commonUI/DIA_animated.cpp" line="37"/>
-        <source>_NTSC(default is Pal):</source>
-        <translation>N_TSC (predefinito ? Pal):</translation>
-    </message>
-    <message>
         <location filename="../avidemux/ADM_userInterfaces/ADM_commonUI/DIA_animated.cpp" line="38"/>
         <source>Vignette _Width:</source>
         <translation>_Larghezza vignetta:</translation>
@@ -1029,7 +1023,7 @@
         <translation>Configurazione libavcodec MPEG-2</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_commonUI/DIA_animated.cpp" line="53"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_commonUI/DIA_SVCD.cpp" line="70"/>
         <source>MPEG-2 Configuration</source>
         <translation>Configurazione MPEG-2</translation>
     </message>
@@ -1298,6 +1292,16 @@
         <source>PSP full res. (720 * 480)</source>
         <translation>PSP ris. completa (720 * 480)</translation>
     </message>
+    <message>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_commonUI/DIA_animated.cpp" line="37"/>
+        <source>_NTSC (default is PAL):</source>
+        <translation>N_TSC (predefinito ? Pal):</translation>
+    </message>
+    <message>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_commonUI/DIA_animated.cpp" line="53"/>
+        <source>Animated Menu</source>
+        <translation>Menu animato</translation>
+    </message>
 </context>
 <context>
     <name>@default</name>
@@ -1631,7 +1635,7 @@
 Click OK to generate debug information. This may take a few minutes to complete.</source>
         <translation>? avvenuto un errore fatale.
 
-Clicca OK per visualizzare le informazioni di debug. Potrebbe richiedere alcuni minuti.</translation>
+Clicca OK per produrre le informazioni di debug. Potrebbe richiedere alcuni minuti.</translation>
     </message>
     <message>
         <location filename="../avidemux/ADM_osSupport/ADM_crashdump.cpp" line="437"/>
@@ -1753,12 +1757,12 @@
         <translation>Errore durante la codifica</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_outputs/oplug_mp4/oplug_mp4.cpp" line="469"/>
+        <location filename="../avidemux/ADM_outputs/oplug_mp4/oplug_mp4.cpp" line="471"/>
         <source>KeyFrame error</source>
         <translation>Errore fotogramma chiave</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_outputs/oplug_mp4/oplug_mp4.cpp" line="469"/>
+        <location filename="../avidemux/ADM_outputs/oplug_mp4/oplug_mp4.cpp" line="471"/>
         <source>The beginning frame is not a key frame.
 Please move the A marker.</source>
         <translation>Il fotogramma iniziale non ? un fotogramma chiave.
@@ -1790,12 +1794,12 @@
         <translation>La frequenza deve essere 44100, 22050 o 11025 Hz.</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_outputs/oplug_mp4/oplug_mp4.cpp" line="230"/>
+        <location filename="../avidemux/ADM_outputs/oplug_mp4/oplug_mp4.cpp" line="212"/>
         <source>Cannot initialize the audio stream</source>
         <translation>Impossibile inizializzare il flusso audio</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_outputs/oplug_mp4/oplug_mp4.cpp" line="418"/>
+        <location filename="../avidemux/ADM_outputs/oplug_mp4/oplug_mp4.cpp" line="420"/>
         <source>
  Reuse the existing log-file ?</source>
         <translation>  Riutilizzare il file log esistente?</translation>
@@ -2822,7 +2826,7 @@
     <message>
         <location filename="../avidemux/gtk_gui.cpp" line="1103"/>
         <source>Something failed when appending</source>
-        <translation>Qualcosa ? fallito durante l&apos;aggiunta</translation>
+        <translation>Errore durante l&apos;aggiunta</translation>
     </message>
     <message>
         <location filename="../avidemux/gtk_gui.cpp" line="1944"/>
@@ -3216,53 +3220,46 @@
         <translation>Impossibile decodificare il fotogramma.</translation>
     </message>
     <message>
-        <location filename="../avidemux/gui_savenew.cpp" line="89"/>
+        <location filename="../avidemux/gui_savenew.cpp" line="88"/>
         <source>Dual audio can only be used in copy mode</source>
         <translation>Il doppio audio pu? essere usato solo in modalit? copia</translation>
     </message>
     <message>
-        <location filename="../avidemux/gui_savenew.cpp" line="89"/>
+        <location filename="../avidemux/gui_savenew.cpp" line="88"/>
         <source>Select Copy as the video codec.</source>
         <translation>Seleziona Copia come codec video.</translation>
     </message>
     <message>
-        <location filename="../avidemux/gui_savenew.cpp" line="238"/>
+        <location filename="../avidemux/gui_savenew.cpp" line="237"/>
         <source>Incompatible output format</source>
         <translation>Formato in uscita incompatibile</translation>
     </message>
     <message>
-        <location filename="../avidemux/gui_savenew.cpp" line="259"/>
+        <location filename="../avidemux/gui_savenew.cpp" line="258"/>
         <source>There is no second track</source>
         <translation>Non c&apos;? una seconda traccia</translation>
     </message>
     <message>
-        <location filename="../avidemux/gui_savenew.cpp" line="259"/>
+        <location filename="../avidemux/gui_savenew.cpp" line="258"/>
         <source>Select a second audio track in the Audio menu.</source>
         <translation>Seleziona una seconda traccia nel menu Audio.</translation>
     </message>
     <message>
-        <location filename="../avidemux/gui_savenew.cpp" line="263"/>
+        <location filename="../avidemux/gui_savenew.cpp" line="262"/>
         <source>Select dual audio AVI to write</source>
         <translation>Seleziona il file AVI con doppio audio da scrivere</translation>
     </message>
     <message>
-        <location filename="../avidemux/gui_savenew.cpp" line="303"/>
+        <location filename="../avidemux/gui_savenew.cpp" line="302"/>
         <source>This cannot have packed VOP</source>
         <translation>Non pu? avere VOP compresso</translation>
     </message>
     <message>
-        <location filename="../avidemux/gui_savenew.cpp" line="303"/>
+        <location filename="../avidemux/gui_savenew.cpp" line="302"/>
         <source>It is not MPEG-4 video. File will not be saved.</source>
         <translation>Non ? un video MPEG-4. Il file non verr? salvato.</translation>
     </message>
     <message>
-        <location filename="../avidemux/gui_savenew.cpp" line="349"/>
-        <source>You may need smart copy.
- Enable it ?</source>
-        <translation>Potresti avere bisogno di una copia intelligente.
- Attivarla?</translation>
-    </message>
-    <message>
         <location filename="../avidemux/guiplay.cpp" line="359"/>
         <source>Trouble initializing audio device</source>
         <translation>Problema nell&apos;inizializzare il dispositivo audio</translation>
@@ -3358,27 +3355,27 @@
         <translation>Movimento</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/alert_qt4.cpp" line="30"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/alert_qt4.cpp" line="21"/>
         <source>Alert</source>
         <translation>Avviso</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/alert_qt4.cpp" line="104"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/alert_qt4.cpp" line="99"/>
         <source>Info</source>
         <translation>Info</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/alert_qt4.cpp" line="164"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/alert_qt4.cpp" line="167"/>
         <source>Confirmation</source>
         <translation>Conferma</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/alert_qt4.cpp" line="211"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/alert_qt4.cpp" line="212"/>
         <source>Question</source>
         <translation>Domanda</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/alert_qt4.cpp" line="203"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/alert_qt4.cpp" line="205"/>
         <source>Question ?</source>
         <translation>Domanda?</translation>
     </message>
@@ -4410,15 +4407,15 @@
     <message>
         <location filename="../avidemux/ADM_outputs/oplug_mpegFF/oplug_vcdff.cpp" line="373"/>
         <source>Encoding</source>
-        <translation>Codifica in corso</translation>
+        <translation>Codifica</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_outputs/oplug_mp4/oplug_mp4.cpp" line="426"/>
+        <location filename="../avidemux/ADM_outputs/oplug_mp4/oplug_mp4.cpp" line="428"/>
         <source>1st Pass</source>
         <translation>1a passata</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_outputs/oplug_mp4/oplug_mp4.cpp" line="501"/>
+        <location filename="../avidemux/ADM_outputs/oplug_mp4/oplug_mp4.cpp" line="503"/>
         <source>2nd Pass</source>
         <translation>2a passata</translation>
     </message>
@@ -4616,12 +4613,12 @@
         <translation>Impossibile determinare la cartella Application Data.</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_outputs/oplug_mp4/oplug_mp4.cpp" line="248"/>
+        <location filename="../avidemux/ADM_outputs/oplug_mp4/oplug_mp4.cpp" line="230"/>
         <source>Invalid audio stream detected</source>
         <translation>Rilevato flusso audio non valido</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_outputs/oplug_mp4/oplug_mp4.cpp" line="248"/>
+        <location filename="../avidemux/ADM_outputs/oplug_mp4/oplug_mp4.cpp" line="230"/>
         <source>The audio stream may be invalid for this container.
 
 Continue anyway?</source>
@@ -5074,6 +5071,28 @@
         <source>Aspect Ratio:</source>
         <translation>Proporzioni:</translation>
     </message>
+    <message>
+        <location filename="../avidemux/gtk_gui.cpp" line="2035"/>
+        <source>Audio track %d (%s/%d channels/%d kbit per s/%d ms shift)</source>
+        <translation>Traccia audio %d (%s/%d canali/%d kbit per s/ritardo %d ms)</translation>
+    </message>
+    <message>
+        <location filename="../avidemux/gui_savenew.cpp" line="348"/>
+        <source>You may need smart copy.
+Enable it?</source>
+        <translation>Potresti avere bisogno di una copia intelligente.
+Attivarla?</translation>
+    </message>
+    <message>
+        <location filename="../avidemux/gui_savenew.cpp" line="351"/>
+        <source>Smart Copy</source>
+        <translation>Copia intelligente</translation>
+    </message>
+    <message>
+        <location filename="../avidemux/gui_savenew.cpp" line="351"/>
+        <source>_Q factor (set 4):</source>
+        <translation>Fattore _Q (4 predefinito):</translation>
+    </message>
 </context>
 <context>
     <name>ADMImage</name>
@@ -6193,98 +6212,89 @@
         <translation>Tentativo di aprire %s fallito!</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_editor/ADM_edit.cpp" line="439"/>
-        <source>You cannot mix different video dimensions yet. Using the partial video filter later, will not work around this problem. The workaround is:
-1.) &quot;resize&quot; / &quot;add border&quot; / &quot;crop&quot; each stream to the same resolution
-2.) concatinate them together</source>
-        <translation>Non puoi ancora mescolare dimensioni video differenti. Usare il filtro video parziale, non risolver? il problema. La soluzione ?:
-1.) &quot;ridimensiona&quot; / &quot;aggiungi bordi&quot; / &quot;ritaglia&quot; ogni flusso alla stessa risoluzione
-2.) concatenali insieme</translation>
-    </message>
-    <message>
-        <location filename="../avidemux/ADM_editor/ADM_edit.cpp" line="551"/>
+        <location filename="../avidemux/ADM_editor/ADM_edit.cpp" line="543"/>
         <source>Build Time Map</source>
         <translation>Crea time map</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_editor/ADM_edit.cpp" line="551"/>
+        <location filename="../avidemux/ADM_editor/ADM_edit.cpp" line="543"/>
         <source>Build VBR time map?</source>
         <translation>Creare la time map VBR?</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_editor/ADM_edit.cpp" line="715"/>
+        <location filename="../avidemux/ADM_editor/ADM_edit.cpp" line="707"/>
         <source>Packed Bitstream detected</source>
         <translation>Flusso di bit compresso rilevato</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_editor/ADM_edit.cpp" line="716"/>
+        <location filename="../avidemux/ADM_editor/ADM_edit.cpp" line="708"/>
         <source>Do you want me to unpack it ?</source>
         <translation>Vuoi decomprimerlo?</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_editor/ADM_edit.cpp" line="736"/>
+        <location filename="../avidemux/ADM_editor/ADM_edit.cpp" line="728"/>
         <source>Could not unpack the video</source>
         <translation>Impossibile decomprimere il video</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_editor/ADM_edit.cpp" line="736"/>
+        <location filename="../avidemux/ADM_editor/ADM_edit.cpp" line="728"/>
         <source>Using backup decoder - not frame accurate.</source>
         <translation>Utilizzo decodificatore backup - non preciso sui fotogrammi.</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_editor/ADM_edit.cpp" line="741"/>
+        <location filename="../avidemux/ADM_editor/ADM_edit.cpp" line="733"/>
         <source>Weird</source>
         <translation>Strano</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_editor/ADM_edit.cpp" line="741"/>
+        <location filename="../avidemux/ADM_editor/ADM_edit.cpp" line="733"/>
         <source>The unpacking succeedeed but the index is still not up to date.</source>
         <translation>La decompressione ? riuscita ma l&apos;indice non ? ancora aggiornato.</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_editor/ADM_edit.cpp" line="747"/>
+        <location filename="../avidemux/ADM_editor/ADM_edit.cpp" line="739"/>
         <source>Troubles ahead</source>
         <translation>Problemi avanti</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_editor/ADM_edit.cpp" line="747"/>
+        <location filename="../avidemux/ADM_editor/ADM_edit.cpp" line="739"/>
         <source>This a VOP packed AVI.</source>
         <translation>Questo ? un AVI compresso con VOP.</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_editor/ADM_edit.cpp" line="758"/>
+        <location filename="../avidemux/ADM_editor/ADM_edit.cpp" line="750"/>
         <source>Index is not up to date</source>
         <translation>L&apos;indice non ? aggiornato</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_editor/ADM_edit.cpp" line="758"/>
+        <location filename="../avidemux/ADM_editor/ADM_edit.cpp" line="750"/>
         <source>You should use Tool-&gt;Rebuild frame. Do it now ?</source>
         <translation>Dovresti usare Strumenti -&gt; Ricostruisci fotogrammi. Vuoi farlo ora?</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_editor/ADM_edit.cpp" line="1520"/>
+        <location filename="../avidemux/ADM_editor/ADM_edit.cpp" line="1512"/>
         <source>This looks like mpeg
  Do you want to index it?</source>
         <translation>Questo sembra un file mpeg
  Vuoi indicizzarlo?</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_editor/ADM_edit.cpp" line="1572"/>
+        <location filename="../avidemux/ADM_editor/ADM_edit.cpp" line="1564"/>
         <source>Indexing failed</source>
         <translation>Indicizzazione fallita</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_editor/ADM_edit.cpp" line="585"/>
+        <location filename="../avidemux/ADM_editor/ADM_edit.cpp" line="577"/>
         <source>Use safe mode</source>
         <translation>Usa modalit? sicura</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_editor/ADM_edit.cpp" line="585"/>
+        <location filename="../avidemux/ADM_editor/ADM_edit.cpp" line="577"/>
         <source>H.264 detected</source>
         <translation>H.264 rilevato</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_editor/ADM_edit.cpp" line="585"/>
+        <location filename="../avidemux/ADM_editor/ADM_edit.cpp" line="577"/>
         <source>If the file is using B-frames as reference it can lead to a crash or stuttering.
 Avidemux can use another mode which is safe but YOU WILL LOSE FRAME ACCURACY.
 Do you want to use that mode?</source>
@@ -6292,6 +6302,21 @@
 Avidemux pu? utilizzare un&apos;altra modalit? pi? sicura, ma PERDERAI PRECISIONE NEI FOTOGRAMMI.
 Vuoi usare questa modalit??</translation>
     </message>
+    <message>
+        <location filename="../avidemux/ADM_editor/ADM_edit.cpp" line="431"/>
+        <source>Video dimensions don&apos;t match.</source>
+        <translation>Le dimensioni video non corrispondono.</translation>
+    </message>
+    <message>
+        <location filename="../avidemux/ADM_editor/ADM_edit.cpp" line="431"/>
+        <source>You cannot mix different video dimensions yet. Using the partial video filter later will not work around this problem. The workaround is:
+
+1) &quot;Resize&quot; / &quot;Add Border&quot; / &quot;Crop&quot; each stream to the same resolution
+2) Concatenate them together</source>
+        <translation>Non ? possibile unire video di dimensioni diverse. L&apos;utilizzo del filtro video parziale non risolve il problema. La soluzione ? la seguente:
+1) ridimensiona, aggiungi bordi o ritaglia tutti i flussi alla stessa risoluzione
+2) concatenali insieme</translation>
+    </message>
 </context>
 <context>
     <name>ADM_Qbitrate</name>
@@ -6457,7 +6482,7 @@
     <message>
         <location filename="../avidemux/ADM_outputs/oplug_ogm/op_ogsaveprocess.cpp" line="167"/>
         <source>Encoding</source>
-        <translation>Codifica in corso</translation>
+        <translation>Codifica</translation>
     </message>
 </context>
 <context>
@@ -7356,7 +7381,7 @@
         <translation>0</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/working.ui" line="88"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/working.ui" line="85"/>
         <source>00:00:00</source>
         <translation>00:00:00</translation>
     </message>
@@ -7566,26 +7591,21 @@
         <translation>Dimensione carattere:</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/working.ui" line="16"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/working.ui" line="13"/>
         <source>Processing</source>
         <translation>Processing</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/working.ui" line="50"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/working.ui" line="47"/>
         <source>Elapsed:</source>
         <translation>Tempo trascorso:</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/working.ui" line="71"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/working.ui" line="68"/>
         <source>Time Remaining:</source>
         <translation>Tempo rimanente:</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/working.ui" line="168"/>
-        <source>Cancel</source>
-        <translation>Annulla</translation>
-    </message>
-    <message>
         <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_filters/mainfilter.ui" line="19"/>
         <source>Video Filter Manager</source>
         <translation>Gestore filtri video</translation>
@@ -7970,11 +7990,6 @@
 <context>
     <name>DialogVobSub</name>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/vobsub.ui" line="13"/>
-        <source>Subtitle Font Size and Position</source>
-        <translation>Dimensione e posizione sottotitoli</translation>
-    </message>
-    <message>
         <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/vobsub.ui" line="33"/>
         <source>Language:</source>
         <translation>Lingua:</translation>
@@ -7989,6 +8004,11 @@
         <source>Delay:</source>
         <translation>Ritardo:</translation>
     </message>
+    <message>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/vobsub.ui" line="13"/>
+        <source>VobSub Settings</source>
+        <translation>Impostazioni VobSub</translation>
+    </message>
 </context>
 <context>
     <name>EncoderCopy</name>
@@ -8092,6 +8112,24 @@
     </message>
 </context>
 <context>
+    <name>EqualiserDialog</name>
+    <message>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/equaliser.ui" line="21"/>
+        <source>Equaliser</source>
+        <translation>Equalizzatore</translation>
+    </message>
+    <message>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/equaliser.ui" line="41"/>
+        <source>Settings</source>
+        <translation>Impostazioni</translation>
+    </message>
+    <message>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/equaliser.ui" line="255"/>
+        <source>Histogram</source>
+        <translation>Istogramma</translation>
+    </message>
+</context>
+<context>
     <name>GenericAviSave</name>
     <message>
         <location filename="../avidemux/ADM_outputs/oplug_avi/op_avisave.cpp" line="189"/>
@@ -8197,7 +8235,7 @@
     <message>
         <location filename="../avidemux/ADM_outputs/oplug_avi/op_saveprocess.cpp" line="267"/>
         <source>Encoding</source>
-        <translation>Codifica in corso</translation>
+        <translation>Codifica</translation>
     </message>
     <message>
         <location filename="../avidemux/ADM_outputs/oplug_avi/op_saveprocess.cpp" line="269"/>
@@ -8381,7 +8419,7 @@
         <translation>Configura</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1851"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1852"/>
         <source>Filters</source>
         <translation>Filtri</translation>
     </message>
@@ -8471,17 +8509,17 @@
         <translation>&amp;Audio</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1426"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1427"/>
         <source>&amp;File</source>
         <translation>&amp;File</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1430"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1431"/>
         <source>&amp;Recent Files</source>
         <translation>File &amp;recenti</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1439"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1440"/>
         <source>&amp;Save</source>
         <translation>&amp;Salva</translation>
     </message>
@@ -8491,692 +8529,692 @@
         <translation>&amp;Strumenti</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1352"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1355"/>
         <source>&amp;Edit</source>
         <translation>&amp;Modifica</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1368"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1369"/>
         <source>&amp;View</source>
         <translation>Visua&amp;lizza</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1372"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1373"/>
         <source>&amp;Preview Mode</source>
         <translation>&amp;Modalit? anteprima</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1389"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1390"/>
         <source>&amp;Custom</source>
         <translation>&amp;Preferiti</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1394"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1395"/>
         <source>&amp;Go</source>
         <translation>&amp;Vai</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1414"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1415"/>
         <source>A&amp;uto</source>
         <translation>A&amp;uto</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1519"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1520"/>
         <source>&amp;Open...</source>
         <translation>&amp;Apri...</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1522"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1523"/>
         <source>Ctrl+O</source>
         <translation>Ctrl+O</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1527"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1528"/>
         <source>&amp;Append...</source>
         <translation>A&amp;ggiungi...</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1530"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1531"/>
         <source>Ctrl+Alt+A</source>
         <translation>Ctrl+Alt+A</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1535"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1536"/>
         <source>&amp;Quit</source>
         <translation>&amp;Esci</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1540"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1541"/>
         <source>Cu&amp;t</source>
         <translation>&amp;Taglia</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1543"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1544"/>
         <source>Ctrl+X</source>
         <translation>Ctrl+X</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1548"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1549"/>
         <source>&amp;Copy</source>
         <translation>&amp;Copia</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1551"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1552"/>
         <source>Ctrl+C</source>
         <translation>Ctrl+C</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1556"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1557"/>
         <source>&amp;Paste</source>
         <translation>&amp;Incolla</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1559"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1560"/>
         <source>Ctrl+V</source>
         <translation>Ctrl+V</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1564"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1565"/>
         <source>&amp;Delete</source>
         <translation>&amp;Elimina</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1567"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1568"/>
         <source>Del</source>
         <translation>Canc</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1581"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1582"/>
         <source>Set Marker A</source>
         <translation>Imposta segnalibro A</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1584"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1585"/>
         <source>[</source>
         <translation>[</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1598"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1599"/>
         <source>Set Marker B</source>
         <translation>Imposta segnalibro B</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1601"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1602"/>
         <source>]</source>
         <translation>]</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1606"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1607"/>
         <source>Pre&amp;ferences...</source>
         <translation>&amp;Preferenze...</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1614"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1615"/>
         <source>&amp;Information...</source>
         <translation>&amp;Informazioni...</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1617"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1618"/>
         <source>Alt+Return</source>
         <translation>Alt+Invio</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1625"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1626"/>
         <source>Save &amp;Video...</source>
         <translation>Salva &amp;video...</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1631"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1632"/>
         <source>Save Video</source>
         <translation>Salva video</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1639"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1640"/>
         <source>Save &amp;BMP Image...</source>
         <translation>Salva immagine &amp;BMP...</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1645"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1646"/>
         <source>Save BMP Image</source>
         <translation>Salva immagine BMP</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1650"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1651"/>
         <source>Save &amp;JPEG Image...</source>
         <translation>Salva immagine &amp;JPEG...</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1656"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1657"/>
         <source>Save JPEG Image</source>
         <translation>Salva immagine JPEG</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1664"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1665"/>
         <source>&amp;Load/Run Project...</source>
         <translation>&amp;Carica/esegui progetto...</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1670"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1671"/>
         <source>Load/Run Project</source>
         <translation>Carica/esegui progetto</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1678"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1679"/>
         <source>Save &amp;Project</source>
         <translation>Salva &amp;progetto</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1684"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1685"/>
         <source>Save Project</source>
         <translation>Salva progetto</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1634"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1635"/>
         <source>Ctrl+S</source>
         <translation>Ctrl+S</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1692"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1693"/>
         <source>Save P&amp;roject As...</source>
         <translation>Salva p&amp;rogetto con nome...</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1698"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1699"/>
         <source>Save Project As</source>
         <translation>Salva progetto con nome</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1703"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1704"/>
         <source>Main toolbar</source>
         <translation>Barra degli strumenti principale</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1708"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1709"/>
         <source>A/V toolbar</source>
         <translation>Barra degli strumenti audio/video</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1716"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1717"/>
         <source>&amp;Zoom 1:4</source>
         <translation>&amp;Zoom 1:4</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1719"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1720"/>
         <source>Ctrl+Shift+4</source>
         <translation>Ctrl+Shift+4</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1727"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1728"/>
         <source>Z&amp;oom 1:2</source>
         <translation>Z&amp;oom 1:2</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1730"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1731"/>
         <source>Ctrl+Shift+2</source>
         <translation>Ctrl+Shift+2</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1741"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1742"/>
         <source>Zoom &amp;1:1</source>
         <translation>Zoom &amp;1:1</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1744"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1745"/>
         <source>Ctrl+Alt+1</source>
         <translation>Ctrl+Alt+1</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1752"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1753"/>
         <source>Zoom &amp;2:1</source>
         <translation>Zoom &amp;2:1</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1755"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1756"/>
         <source>Ctrl+Alt+2</source>
         <translation>Ctrl+Alt+2</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1760"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1761"/>
         <source>Zoom 4:1</source>
         <translation>Zoom 4:1</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1765"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1766"/>
         <source>&amp;Decoder Options...</source>
         <translation>Opzioni &amp;decodificatore...</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1771"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1772"/>
         <source>Decoder Options</source>
         <translation>Opzioni decodificatore</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1774"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1775"/>
         <source>F3</source>
         <translation>F3</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1779"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1780"/>
         <source>&amp;Postprocessing...</source>
         <translation>&amp;Postprocessing...</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1782"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1783"/>
         <source>F4</source>
         <translation>F4</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1787"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1788"/>
         <source>&amp;Frame Rate...</source>
         <translation>&amp;Frame rate...</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1793"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1794"/>
         <source>Frame Rate</source>
         <translation>Frame rate</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1840"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1841"/>
         <source>Encoder</source>
         <translation>Codificatore</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1803"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1804"/>
         <source>Fil&amp;ters...</source>
         <translation>Fil&amp;tri...</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1806"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1807"/>
         <source>Ctrl+Alt+F</source>
         <translation>Ctrl+Alt+F</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1811"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1812"/>
         <source>&amp;Main Track...</source>
         <translation>Traccia &amp;principale...</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1816"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1817"/>
         <source>&amp;Secondary Track...</source>
         <translation>Traccia &amp;secondaria...</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1827"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1828"/>
         <source>Build VBR Time Map</source>
         <translation>Crea time map VBR</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1832"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1833"/>
         <source>S&amp;ave...</source>
         <translation>S&amp;alva...</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1835"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1836"/>
         <source>Ctrl+Alt+S</source>
         <translation>Ctrl+Alt+S</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1845"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1846"/>
         <source>&amp;Filters</source>
         <translation>&amp;Filtri</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1862"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1863"/>
         <source>&amp;Calculator...</source>
         <translation>&amp;Calcolatrice...</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1865"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1866"/>
         <source>F7</source>
         <translation>F7</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1870"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1871"/>
         <source>&amp;Rebuild I &amp;&amp; B Frames</source>
         <translation>&amp;Ricostruisci fotogrammi I &amp;&amp; B</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1876"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1877"/>
         <source>Rebuild I &amp; B Frames</source>
         <translation>Ricostruisci fotogrammi I &amp;&amp; B</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1881"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1882"/>
         <source>&amp;Bitrate Histogram...</source>
         <translation>Istogramma &amp;bitrate...</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1887"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1888"/>
         <source>Bitrate Histogram</source>
         <translation>Istogramma bitrate</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1892"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1893"/>
         <source>&amp;Scan for Black Frames...</source>
         <translation>C&amp;erca fotogrammi neri...</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1898"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1899"/>
         <source>Scan for Black Frames</source>
         <translation>Cerca fotogrammi neri</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1903"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1904"/>
         <source>&amp;VOB -&gt; VobSub...</source>
         <translation>&amp;VOB -&gt; VobSub...</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1909"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1910"/>
         <source>VOB -&gt; VobSub</source>
         <translation>VOB -&gt; VobSub</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1914"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1915"/>
         <source>&amp;OCR (VobSub -&gt; srt)...</source>
         <translation>&amp;OCR (VobSub -&gt; srt)...</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1920"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1921"/>
         <source>OCR (VobSub -&gt; srt)</source>
         <translation>OCR (VobSub -&gt; srt)</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1934"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1935"/>
         <source>Stop</source>
         <translation>Stop</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="2132"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="2133"/>
         <source>P</source>
         <translation>P</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1945"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1946"/>
         <source>P&amp;revious Frame</source>
         <translation>Fotogramma p&amp;recedente</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1948"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1949"/>
         <source>Left</source>
         <translation>Sinistra</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1956"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1957"/>
         <source>&amp;Next Frame</source>
         <translation>Fotogramma &amp;successivo</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1959"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1960"/>
         <source>Right</source>
         <translation>Destra</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1967"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1968"/>
         <source>Pr&amp;evious Intra Frame</source>
         <translation>Fotogramma chiave pr&amp;ecedente</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1973"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1974"/>
         <source>Previous Intra Frame</source>
         <translation>Fotogramma chiave precedente</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1976"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1977"/>
         <source>Down</source>
         <translation>Gi?</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1984"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1985"/>
         <source>Next &amp;Intra Frame</source>
         <translation>Fotogramma ch&amp;iave successivo</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1990"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1991"/>
         <source>Next Intra Frame</source>
         <translation>Fotogramma chiave successivo</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1993"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1994"/>
         <source>Up</source>
         <translation>Su</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="2001"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="2002"/>
         <source>Previou&amp;s Black Frame</source>
         <translation>Fotogramma nero pre&amp;cedente</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="2007"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="2008"/>
         <source>Previous Black Frame</source>
         <translation>Fotogramma nero precedente</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="2015"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="2016"/>
         <source>Ne&amp;xt Black Frame</source>
         <translation>Fotogramma nero successi&amp;vo</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="2021"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="2022"/>
         <source>Next Black Frame</source>
         <translation>Fotogramma nero successivo</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="2029"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="2030"/>
         <source>&amp;First Frame</source>
         <translation>Primo &amp;fotogramma</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="2032"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="2033"/>
         <source>Home</source>
         <translation>Home</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="2040"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="2041"/>
         <source>&amp;Last Frame</source>
         <translation>&amp;Ultimo fotogramma</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="2043"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="2044"/>
         <source>End</source>
         <translation>Fine</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="2051"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="2052"/>
         <source>Jump to Marker &amp;A</source>
         <translation>Vai al segnalibro &amp;A</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="2057"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="2058"/>
         <source>Jump to Marker A</source>
         <translation>Vai al segnalibro A</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="2060"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="2061"/>
         <source>Ctrl+[</source>
         <translation>Ctrl+[</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="2068"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="2069"/>
         <source>Jump to Marker &amp;B</source>
         <translation>Vai al segnalibro &amp;B</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="2074"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="2075"/>
         <source>Jump to Marker B</source>
         <translation>Vai al segnalibro B</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="2077"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="2078"/>
         <source>Ctrl+]</source>
         <translation>Ctrl+]</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="2082"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="2083"/>
         <source>Jump to Fra&amp;me...</source>
         <translation>Vai al fotogra&amp;mma...</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="2085"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="2086"/>
         <source>Ctrl+F</source>
         <translation>Ctrl+F</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="2090"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="2091"/>
         <source>Jump to &amp;Time...</source>
         <translation>Vai al &amp;tempo...</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="2093"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="2094"/>
         <source>Ctrl+T</source>
         <translation>Ctrl+T</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="2098"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="2099"/>
         <source>&amp;Built-in Support...</source>
         <translation>&amp;Supporto incorporato...</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="2104"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="2105"/>
         <source>Built-in Support</source>
         <translation>Supporto incorporato</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="2109"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="2110"/>
         <source>&amp;About Avidemux...</source>
         <translation>Informazioni su &amp;Avidemux...</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="2115"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="2116"/>
         <source>About Avidemux</source>
         <translation>Informazioni su Avidemux</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="2123"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="2124"/>
         <source>&amp;Play/Stop</source>
         <translation>&amp;Play/Stop</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="2129"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="2130"/>
         <source>Play/Stop</source>
         <translation>Play/Stop</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="2137"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="2138"/>
         <source>Recent0</source>
         <translation>Recent0</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="2142"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="2143"/>
         <source>Recent1</source>
         <translation>Recent1</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="2147"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="2148"/>
         <source>Recent2</source>
         <translation>Recent2</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="2152"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="2153"/>
         <source>Recent3</source>
         <translation>Recent3</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="2188"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="2189"/>
         <source>Add to &amp;Joblist...</source>
         <translation>Aggiungi alla &amp;lista attivit?...</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="2194"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="2195"/>
         <source>Add to Joblist</source>
         <translation>Aggiungi alla lista attivit?</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="2199"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="2200"/>
         <source>View &amp;Joblist...</source>
         <translation>Mostra &amp;lista attivit?...</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="2205"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="2206"/>
         <source>View Joblist</source>
         <translation>Mostra lista attivit?</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="2208"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="2209"/>
         <source>Ctrl+J</source>
         <translation>Ctrl+J</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="2213"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="2214"/>
         <source>Co&amp;nnect to avsproxy</source>
         <translation>Co&amp;nnetti a avsproxy</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="2219"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="2220"/>
         <source>Connect to avsproxy</source>
         <translation>Connetti a avsproxy</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="2224"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="2225"/>
         <source>&amp;Reset Edits</source>
         <translation>A&amp;nnulla modifiche</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="2229"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="2230"/>
         <source>Save</source>
         <translation>Salva</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="2234"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="2235"/>
         <source>OCR (&amp;TS -&gt; srt)...</source>
         <translation>OCR (&amp;TS -&gt; srt)...</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="2240"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="2241"/>
         <source>OCR (TS -&gt; srt)</source>
         <translation>OCR (TS -&gt; srt)</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="2245"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="2246"/>
         <source>Edit &amp;Glyphs...</source>
         <translation>Modifica &amp;glifi...</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="2251"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="2252"/>
         <source>Edit Glyphs</source>
         <translation>Modifica glifi</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="2314"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="2315"/>
         <source>&amp;Input</source>
         <translation>&amp;Input</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="2319"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="2320"/>
         <source>&amp;Output</source>
         <translation>&amp;Output</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="2324"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="2325"/>
         <source>Si&amp;de</source>
         <translation>&amp;Affiancati lateralmente</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="2329"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="2330"/>
         <source>&amp;Top</source>
         <translation>Affiancati ver&amp;ticalmente</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="2334"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="2335"/>
         <source>&amp;Separate</source>
         <translation>&amp;Separati</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="2349"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="2350"/>
         <source>&amp;Close</source>
         <translation>&amp;Chiudi</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="2352"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="2353"/>
         <source>Ctrl+W</source>
         <translation>Ctrl+W</translation>
     </message>
@@ -9186,7 +9224,7 @@
         <translation>ms</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="2357"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="2358"/>
         <source>Save Selection as JPEG Images...</source>
         <translation>Salva selezione in immagini JPEG...</translation>
     </message>
@@ -9201,45 +9239,55 @@
         <translation>B:</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="2157"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="2158"/>
         <source>&amp;Video CD...</source>
         <translation>&amp;Video CD...</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="2162"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="2163"/>
         <source>&amp;Super Video CD...</source>
         <translation>&amp;Super Video CD...</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="2167"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="2168"/>
         <source>&amp;DVD...</source>
         <translation>&amp;DVD...</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="2172"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="2173"/>
         <source>&amp;PlayStation Portable...</source>
         <translation>&amp;PlayStation Portable...</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="2177"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="2178"/>
         <source>PlayStation Portable (&amp;H.264)...</source>
         <translation>PlayStation Portable (&amp;H.264)...</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="2183"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="2184"/>
         <source>PlayStation Portable (H.264)</source>
         <translation>PlayStation Portable (H.264)</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="2339"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="2340"/>
         <source>&amp;Flash Video</source>
         <translation>&amp;Flash Video</translation>
     </message>
     <message>
-        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="2344"/>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="2345"/>
         <source>&amp;iPod (MPEG-4 ASP)...</source>
         <translation>&amp;iPod (MPEG-4 ASP)...</translation>
     </message>
+    <message>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="2363"/>
+        <source>&amp;Preferences...</source>
+        <translation>&amp;Preferenze...</translation>
+    </message>
+    <message>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="2368"/>
+        <source>&amp;AVI Muxer Options...</source>
+        <translation>Opzioni Muxer &amp;AVI</translation>
+    </message>
 </context>
 <context>
     <name>MpegMuxer</name>
@@ -9473,7 +9521,7 @@
     <message>
         <location filename="../avidemux/ADM_videoFilter/ADM_vidDecTelecide.cpp" line="131"/>
         <source>Decomb Telecide</source>
-        <translation type="unfinished">Decomb Telecide</translation>
+        <translation>Decomb Telecide</translation>
     </message>
 </context>
 <context>
@@ -9481,7 +9529,7 @@
     <message>
         <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_license.cpp" line="708"/>
         <source>&lt;!DOCTYPE html PUBLIC &quot;-//W3C//DTD HTML 4.01 Transitional//EN&quot;&gt;&lt;html&gt;&lt;head&gt;  &lt;title&gt;Avidemux is free software; you can redistribute it and/or  modify it under the terms of the GNU General Public License  version 2 as published by the Free Software Foundation&lt;/title&gt;&lt;style type=&quot;text/css&quot;&gt;&lt;!-- /* Style Definitions */ p.licenseStyle, li.licenseStyle, div.licenseStyle        {margin:0cm;        margin-bottom:.0001pt;        font-size:12.0pt;        font-family:&quot;Times New Roman&quot;;} /* Page Definitions */ @page Section1        {size:612.0pt 792.0pt;        margin:72.0pt 90.0pt 72.0pt 90.0pt;}div.Section1        {page:Section1;}--&gt;&lt;/style&gt;&lt;/head&gt;&lt;body lang=&quot;EN-GB&quot; style=&apos;text-justify-trim:punctuation&apos;&gt;  &lt;div class=&quot;Section1&quot;&gt;    &lt;p class=&quot;licenseStyle&quot; style=&apos;text-autospace:none&apos;&gt;    &lt;span style=&apos;font-size:1!
 0.0pt; font-family:Arial&apos;&gt;Avidemux is    free software; you can redistribute it and/or modify it under    the terms of the GNU General Public License version 2 as    published by the Free Software Foundation.&lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; style=&apos;text-autospace:none&apos;&gt;    &lt;b&gt;&lt;span style=&apos;font-size:10.0pt; font-family:Arial&apos;&gt;    &lt;/span&gt;&lt;/b&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; align=&quot;center&quot; style=    &apos;text-align:center;text-autospace:none&apos;&gt;&lt;b&gt;&lt;span style=    &apos;font-size:10.0pt;font-family:Arial&apos;&gt;GNU GENERAL PUBLIC    LICENSE&lt;/span&gt;&lt;/b&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; align=&quot;center&quot; style=    &apos;text-align:center;text-autospace:none&apos;&gt;&lt;b&gt;&lt;span style=    &apos;font-size:10.0pt;font-family:Arial&apos;&gt;Version 2, June    1991&lt;/span&gt;&lt;/b&gt;&lt;/p&gt;    &lt;p class=&qu!
 ot;licenseStyle&quot; style=&apos;text-autospace:none&apos;&gt!
 ;    &lt
;span style=&apos;font-size:10.0pt; font-family:Arial&apos;&gt; &lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; align=&quot;center&quot; style=    &apos;text-align:center;text-autospace:none&apos;&gt;&lt;span style=    &apos;font-size:10.0pt;font-family:Arial&apos;&gt;Copyright (C) 1989, 1991    Free Software Foundation, Inc.&lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; align=&quot;center&quot; style=    &apos;text-align:center;text-autospace:none&apos;&gt;&lt;span lang=&quot;FR&quot; style=    &apos;font-size:10.0pt;font-family:Arial&apos;&gt;59 Temple Place, Suite    330, Boston, MA  02111-1307  USA&lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; align=&quot;center&quot; style=    &apos;text-align:center;text-autospace:none&apos;&gt;&lt;span lang=&quot;FR&quot; style=    &apos;font-size:10.0pt;font-family:Arial&apos;&gt; &lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; style=    &apos;text-align:justify;text-a!
 utospace:none&apos;&gt;&lt;span style=    &apos;font-size:10.0pt;font-family:Arial&apos;&gt;Everyone is permitted to    copy and distribute verbatim copies of this license document,    but changing it is not allowed.&lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; style=&apos;text-autospace:none&apos;&gt;    &lt;span style=&apos;font-size:10.0pt; font-family:Arial&apos;&gt; &lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; align=&quot;center&quot; style=    &apos;text-align:center;text-autospace:none&apos;&gt;&lt;b&gt;&lt;span style=    &apos;font-size:10.0pt;font-family:Arial&apos;&gt;Preamble&lt;/span&gt;&lt;/b&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; style=&apos;text-autospace:none&apos;&gt;    &lt;span style=&apos;font-size:10.0pt; font-family:Arial&apos;&gt; &lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; style=    &apos;text-align:justify;text-autospace:none&apos;&gt;&lt;span style=    &apos;font-size:10.0pt;fo!
 nt-family:Arial&apos;&gt;The licenses for most    software are!
  designe
d to take away your freedom to share and    change it.  By contrast, the GNU General Public License is    intended to guarantee your freedom to share and change free    software--to make sure the software is free for all its users.     This General Public License applies to most of the Free    Software Foundation&apos;s software and to any other program whose    authors commit to using it.  (Some other Free Software    Foundation software is covered by the GNU Library General    Public License instead.)  You can apply it to your programs,    too.&lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; style=    &apos;text-align:justify;text-autospace:none&apos;&gt;&lt;span style=    &apos;font-size:10.0pt;font-family:Arial&apos;&gt; &lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; style=    &apos;text-align:justify;text-autospace:none&apos;&gt;&lt;span style=    &apos;font-size:10.0pt;font-family:Arial&apos;&gt;When we speak of free    software, we are !
 referring to freedom, not price.  Our General    Public Licenses are designed to make sure that you have the    freedom to distribute copies of free software (and charge for    this service if you wish), that you receive source code or can    get it if you want it, that you can change the software or use    pieces of it in new free programs; and that you know you can do    these things.&lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; style=    &apos;text-align:justify;text-autospace:none&apos;&gt;&lt;span style=    &apos;font-size:10.0pt;font-family:Arial&apos;&gt; &lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; style=    &apos;text-align:justify;text-autospace:none&apos;&gt;&lt;span style=    &apos;font-size:10.0pt;font-family:Arial&apos;&gt;To protect your rights, we    need to make restrictions that forbid anyone to deny you these    rights or to ask you to surrender the rights. These    restrictions translate to certain responsibilities fo!
 r you if    you distribute copies of the software, or if you m!
 odify   
 it.&lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; style=    &apos;text-align:justify;text-autospace:none&apos;&gt;&lt;span style=    &apos;font-size:10.0pt;font-family:Arial&apos;&gt; &lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; style=    &apos;text-align:justify;text-autospace:none&apos;&gt;&lt;span style=    &apos;font-size:10.0pt;font-family:Arial&apos;&gt;For example, if you    distribute copies of such a program, whether gratis or for a    fee, you must give the recipients all the rights that you have.     You must make sure that they, too, receive or can get the    source code.  And you must show them these terms so they know    their rights.&lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; style=    &apos;text-align:justify;text-autospace:none&apos;&gt;&lt;span style=    &apos;font-size:10.0pt;font-family:Arial&apos;&gt; &lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; style=    &apos;text-align:justify!
 ;text-autospace:none&apos;&gt;&lt;span style=    &apos;font-size:10.0pt;font-family:Arial&apos;&gt;We protect your rights    with two steps: (1) copyright the software, and (2) offer you    this license which gives you legal permission to copy,    distribute and/or modify the software.&lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; style=    &apos;text-align:justify;text-autospace:none&apos;&gt;&lt;span style=    &apos;font-size:10.0pt;font-family:Arial&apos;&gt; &lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; style=    &apos;text-align:justify;text-autospace:none&apos;&gt;&lt;span style=    &apos;font-size:10.0pt;font-family:Arial&apos;&gt;Also, for each author&apos;s    protection and ours, we want to make certain that everyone    understands that there is no warranty for this free software.     If the software is modified by someone else and passed on, we    want its recipients to know that what they have is not the    original, so that an!
 y problems introduced by others will not    reflect on the ori!
 ginal au
thors&apos; reputations.&lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; style=    &apos;text-align:justify;text-autospace:none&apos;&gt;&lt;span style=    &apos;font-size:10.0pt;font-family:Arial&apos;&gt; &lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; style=    &apos;text-align:justify;text-autospace:none&apos;&gt;&lt;span style=    &apos;font-size:10.0pt;font-family:Arial&apos;&gt;Finally, any free program    is threatened constantly by software patents.  We wish to avoid    the danger that redistributors of a free program will    individually obtain patent licenses, in effect making the    program proprietary.  To prevent this, we have made it clear    that any patent must be licensed for everyone&apos;s free use or not    licensed at all.&lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; style=    &apos;text-align:justify;text-autospace:none&apos;&gt;&lt;span style=    &apos;font-size:10.0pt;font-family:Arial&apos;&gt; &lt;/s!
 pan&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; style=    &apos;text-align:justify;text-autospace:none&apos;&gt;&lt;span style=    &apos;font-size:10.0pt;font-family:Arial&apos;&gt;The precise terms and    conditions for copying, distribution and modification    follow.&lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; style=&apos;text-autospace:none&apos;&gt;    &lt;span style=&apos;font-size:10.0pt; font-family:Arial&apos;&gt; &lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; style=&apos;text-autospace:none&apos;&gt;    &lt;span style=&apos;font-size:10.0pt; font-family:Arial&apos;&gt; &lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; align=&quot;center&quot; style=    &apos;text-align:center;text-autospace:none&apos;&gt;&lt;b&gt;&lt;span style=    &apos;font-size:10.0pt;font-family:Arial&apos;&gt;GNU GENERAL PUBLIC    LICENSE&lt;/span&gt;&lt;/b&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; align=&quot;center&quot!
 ; style=    &apos;text-align:center;text-autospace:none&apos;&!
 gt;&lt;b
&gt;&lt;span style=    &apos;font-size:10.0pt;font-family:Arial&apos;&gt;TERMS AND CONDITIONS FOR    COPYING, DISTRIBUTION AND MODIFICATION&lt;/span&gt;&lt;/b&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; style=&apos;text-autospace:none&apos;&gt;    &lt;span style=&apos;font-size:10.0pt; font-family:Arial&apos;&gt; &lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; style=    &apos;text-align:justify;text-autospace:none&apos;&gt;&lt;span style=    &apos;font-size:10.0pt;font-family:Arial&apos;&gt;0. This License applies to    any program or other work which contains a notice placed by the    copyright holder saying it may be distributed under the terms    of this General Public License.  The &quot;Program&quot;, below, refers    to any such program or work, and a &quot;work based on the Program&quot;    means either the Program or any derivative work under copyright    law: that is to say, a work containing the Program or a portion    of it, either verbat!
 im or with modifications and/or translated    into another language.  (Hereinafter, translation is included    without limitation in the term &quot;modification&quot;.)  Each licensee    is addressed as &quot;you&quot;.&lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; style=    &apos;text-align:justify;text-autospace:none&apos;&gt;&lt;span style=    &apos;font-size:10.0pt;font-family:Arial&apos;&gt; &lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; style=    &apos;text-align:justify;text-autospace:none&apos;&gt;&lt;span style=    &apos;font-size:10.0pt;font-family:Arial&apos;&gt;Activities other than    copying, distribution and modification are not covered by this    License; they are outside its scope.  The act of running the    Program is not restricted, and the output from the Program is    covered only if its contents constitute a work based on the    Program (independent of having been made by running the    Program). Whether that is true d!
 epends on what the Program    does.&lt;/span&gt;&lt;/p&gt;    !
 &lt;p cl
ass=&quot;licenseStyle&quot; style=    &apos;text-align:justify;text-autospace:none&apos;&gt;&lt;span style=    &apos;font-size:10.0pt;font-family:Arial&apos;&gt; &lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; style=    &apos;text-align:justify;text-autospace:none&apos;&gt;&lt;span style=    &apos;font-size:10.0pt;font-family:Arial&apos;&gt;1. You may copy and    distribute verbatim copies of the Program&apos;s source code as you    receive it, in any medium, provided that you conspicuously and    appropriately publish on each copy an appropriate copyright    notice and disclaimer of warranty; keep intact all the notices    that refer to this License and to the absence of any warranty;    and give any other recipients of the Program a copy of this    License along with the Program.&lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; style=    &apos;text-align:justify;text-autospace:none&apos;&gt;&lt;span style=    &apos;font-size:10.0pt;font-famil!
 y:Arial&apos;&gt; &lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; style=    &apos;text-align:justify;text-autospace:none&apos;&gt;&lt;span style=    &apos;font-size:10.0pt;font-family:Arial&apos;&gt;You may charge a fee for    the physical act of transferring a copy, and you may at your    option offer warranty protection in exchange for a    fee.&lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; style=    &apos;text-align:justify;text-autospace:none&apos;&gt;&lt;span style=    &apos;font-size:10.0pt;font-family:Arial&apos;&gt; &lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; style=    &apos;text-align:justify;text-autospace:none&apos;&gt;&lt;span style=    &apos;font-size:10.0pt;font-family:Arial&apos;&gt;2. You may modify your    copy or copies of the Program or any portion of it, thus    forming a work based on the Program, and copy and distribute    such modifications or work under the terms of Section 1 above,    provided tha!
 t you also meet all of these conditions:&lt;/span&gt;&lt;/p&gt!
 ;    &lt
;p class=&quot;licenseStyle&quot; style=    &apos;text-align:justify;text-autospace:none&apos;&gt;&lt;span style=    &apos;font-size:10.0pt;font-family:Arial&apos;&gt; &lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; style=    &apos;text-align:justify;text-autospace:none&apos;&gt;&lt;span style=    &apos;font-size:10.0pt;font-family:Arial&apos;&gt;a) You must cause the    modified files to carry prominent notices stating that you    changed the files and the date of any change.&lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; style=    &apos;text-align:justify;text-autospace:none&apos;&gt;&lt;span style=    &apos;font-size:10.0pt;font-family:Arial&apos;&gt; &lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; style=    &apos;text-align:justify;text-autospace:none&apos;&gt;&lt;span style=    &apos;font-size:10.0pt;font-family:Arial&apos;&gt;b) You must cause any work    that you distribute or publish, that in whole or in part    contain!
 s or is derived from the Program or any part thereof, to    be licensed as a whole at no charge to all third parties under    the terms of this License.&lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; style=    &apos;text-align:justify;text-autospace:none&apos;&gt;&lt;span style=    &apos;font-size:10.0pt;font-family:Arial&apos;&gt; &lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; style=    &apos;text-align:justify;text-autospace:none&apos;&gt;&lt;span style=    &apos;font-size:10.0pt;font-family:Arial&apos;&gt;c) If the modified program    normally reads commands interactively when run, you must cause    it, when started running for such interactive use in the most    ordinary way, to print or display an announcement including an    appropriate copyright notice and a notice that there is no    warranty (or else, saying that you provide a warranty) and that    users may redistribute the program under these conditions, and    telling the user ho!
 w to view a copy of this License.     (Exception: if the Progr!
 am itsel
f is interactive but does not    normally print such an announcement, your work based on the    Program is not required to print an announcement.)&lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; style=    &apos;text-align:justify;text-autospace:none&apos;&gt;&lt;span style=    &apos;font-size:10.0pt;font-family:Arial&apos;&gt; &lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; style=    &apos;text-align:justify;text-autospace:none&apos;&gt;&lt;span style=    &apos;font-size:10.0pt;font-family:Arial&apos;&gt; &lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; style=    &apos;text-align:justify;text-autospace:none&apos;&gt;&lt;span style=    &apos;font-size:10.0pt;font-family:Arial&apos;&gt;These requirements apply    to the modified work as a whole.  If identifiable sections of    that work are not derived from the Program, and can be    reasonably considered independent and separate works in    themselves, then this License, and its t!
 erms, do not apply to    those sections when you distribute them as separate works.  But    when you distribute the same sections as part of a whole which    is a work based on the Program, the distribution of the whole    must be on the terms of this License, whose permissions for    other licensees extend to the entire whole, and thus to each    and every part regardless of who wrote it.&lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; style=    &apos;text-align:justify;text-autospace:none&apos;&gt;&lt;span style=    &apos;font-size:10.0pt;font-family:Arial&apos;&gt; &lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; style=    &apos;text-align:justify;text-autospace:none&apos;&gt;&lt;span style=    &apos;font-size:10.0pt;font-family:Arial&apos;&gt;Thus, it is not the intent    of this section to claim rights or contest your rights to work    written entirely by you; rather, the intent is to exercise the    right to control the distribution of de!
 rivative or collective    works based on the Program.&lt;/span!
 &gt;&lt;
/p&gt;    &lt;p class=&quot;licenseStyle&quot; style=    &apos;text-align:justify;text-autospace:none&apos;&gt;&lt;span style=    &apos;font-size:10.0pt;font-family:Arial&apos;&gt; &lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; style=    &apos;text-align:justify;text-autospace:none&apos;&gt;&lt;span style=    &apos;font-size:10.0pt;font-family:Arial&apos;&gt;In addition, mere    aggregation of another work not based on the Program with the    Program (or with a work based on the Program) on a volume of a    storage or distribution medium does not bring the other work    under the scope of this License.&lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; style=    &apos;text-align:justify;text-autospace:none&apos;&gt;&lt;span style=    &apos;font-size:10.0pt;font-family:Arial&apos;&gt; &lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; style=    &apos;text-align:justify;text-autospace:none&apos;&gt;&lt;span style=    &apos;font-size:10!
 .0pt;font-family:Arial&apos;&gt;3. You may copy and    distribute the Program (or a work based on it, under Section 2)    in object code or executable form under the terms of Sections 1    and 2 above provided that you also do one of the    following:&lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; style=    &apos;text-align:justify;text-autospace:none&apos;&gt;&lt;span style=    &apos;font-size:10.0pt;font-family:Arial&apos;&gt; &lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; style=    &apos;text-align:justify;text-autospace:none&apos;&gt;&lt;span style=    &apos;font-size:10.0pt;font-family:Arial&apos;&gt;a) Accompany it with the    complete corresponding machine-readable source code, which must    be distributed under the terms of Sections 1 and 2 above on a    medium customarily used for software interchange;    or,&lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; style=    &apos;text-align:justify;text-autospace:none&apos;&g!
 t;&lt;span style=    &apos;font-size:10.0pt;font-family:Arial&!
 apos;&gt
; &lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; style=    &apos;text-align:justify;text-autospace:none&apos;&gt;&lt;span style=    &apos;font-size:10.0pt;font-family:Arial&apos;&gt;b) Accompany it with a    written offer, valid for at least three years, to give any    third party, for a charge no more than your cost of physically    performing source distribution, a complete machine-readable    copy of the corresponding source code, to be distributed under    the terms of Sections 1 and 2 above on a medium customarily    used for software interchange; or,&lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; style=    &apos;text-align:justify;text-autospace:none&apos;&gt;&lt;span style=    &apos;font-size:10.0pt;font-family:Arial&apos;&gt; &lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; style=    &apos;text-align:justify;text-autospace:none&apos;&gt;&lt;span style=    &apos;font-size:10.0pt;font-family:Arial&apos;&gt;c) Accompany it!
  with the    information you received as to the offer to distribute    corresponding source code.  (This alternative is allowed only    for noncommercial distribution and only if you received the    program in object code or executable form with such an offer,    in accord with Subsection b above.)&lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; style=    &apos;text-align:justify;text-autospace:none&apos;&gt;&lt;span style=    &apos;font-size:10.0pt;font-family:Arial&apos;&gt; &lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; style=    &apos;text-align:justify;text-autospace:none&apos;&gt;&lt;span style=    &apos;font-size:10.0pt;font-family:Arial&apos;&gt;The source code for a work    means the preferred form of the work for making modifications    to it.  For an executable work, complete source code means all    the source code for all modules it contains, plus any    associated interface definition files, plus the scripts used to    control c!
 ompilation and installation of the executable.     However, as!
  a speci
al exception, the source code distributed    need not include anything that is normally distributed (in    either source or binary form) with the major components    (compiler, kernel, and so on) of the operating system on which    the executable runs, unless that component itself accompanies    the executable.&lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; style=    &apos;text-align:justify;text-autospace:none&apos;&gt;&lt;span style=    &apos;font-size:10.0pt;font-family:Arial&apos;&gt; &lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; style=    &apos;text-align:justify;text-autospace:none&apos;&gt;&lt;span style=    &apos;font-size:10.0pt;font-family:Arial&apos;&gt;If distribution of    executable or object code is made by offering access to copy    from a designated place, then offering equivalent access to    copy the source code from the same place counts as distribution    of the source code, even though third parties are not compelled   !
  to copy the source along with the object code.&lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; style=    &apos;text-align:justify;text-autospace:none&apos;&gt;&lt;span style=    &apos;font-size:10.0pt;font-family:Arial&apos;&gt; &lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; style=    &apos;text-align:justify;text-autospace:none&apos;&gt;&lt;span style=    &apos;font-size:10.0pt;font-family:Arial&apos;&gt; &lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; style=    &apos;text-align:justify;text-autospace:none&apos;&gt;&lt;span style=    &apos;font-size:10.0pt;font-family:Arial&apos;&gt;4. You may not copy,    modify, sublicense, or distribute the Program except as    expressly provided under this License.  Any attempt otherwise    to copy, modify, sublicense or distribute the Program is void,    and will automatically terminate your rights under this    License. However, parties who have received copies, or rights,    from you !
 under this License will not have their licenses    terminated !
 so long 
as such parties remain in full    compliance.&lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; style=    &apos;text-align:justify;text-autospace:none&apos;&gt;&lt;span style=    &apos;font-size:10.0pt;font-family:Arial&apos;&gt; &lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; style=    &apos;text-align:justify;text-autospace:none&apos;&gt;&lt;span style=    &apos;font-size:10.0pt;font-family:Arial&apos;&gt;5. You are not required to    accept this License, since you have not signed it.  However,    nothing else grants you permission to modify or distribute the    Program or its derivative works.  These actions are prohibited    by law if you do not accept this License.  Therefore, by    modifying or distributing the Program (or any work based on the    Program), you indicate your acceptance of this License to do    so, and all its terms and conditions for copying, distributing    or modifying the Program or works based on it.&lt;/span&gt;&lt;/p&!
 gt;    &lt;p class=&quot;licenseStyle&quot; style=    &apos;text-align:justify;text-autospace:none&apos;&gt;&lt;span style=    &apos;font-size:10.0pt;font-family:Arial&apos;&gt; &lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; style=    &apos;text-align:justify;text-autospace:none&apos;&gt;&lt;span style=    &apos;font-size:10.0pt;font-family:Arial&apos;&gt;6. Each time you    redistribute the Program (or any work based on the Program),    the recipient automatically receives a license from the    original licensor to copy, distribute or modify the Program    subject to these terms and conditions.  You may not impose any    further restrictions on the recipients&apos; exercise of the rights    granted herein. You are not responsible for enforcing    compliance by third parties to this License.&lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; style=    &apos;text-align:justify;text-autospace:none&apos;&gt;&lt;span style=    &apos;font-size:10.0pt!
 ;font-family:Arial&apos;&gt; &lt;/span&gt;&lt;/p&gt;    &lt;p !
 class=&q
uot;licenseStyle&quot; style=    &apos;text-align:justify;text-autospace:none&apos;&gt;&lt;span style=    &apos;font-size:10.0pt;font-family:Arial&apos;&gt;7. If, as a consequence of    a court judgment or allegation of patent infringement or for    any other reason (not limited to patent issues), conditions are    imposed on you (whether by court order, agreement or otherwise)    that contradict the conditions of this License, they do not    excuse you from the conditions of this License.  If you cannot    distribute so as to satisfy simultaneously your obligations    under this License and any other pertinent obligations, then as    a consequence you may not distribute the Program at all.  For    example, if a patent license would not permit royalty-free    redistribution of the Program by all those who receive copies    directly or indirectly through you, then the only way you could    satisfy both it and this License would be to refrain entirely    from distribution of t!
 he Program.&lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; style=    &apos;text-align:justify;text-autospace:none&apos;&gt;&lt;span style=    &apos;font-size:10.0pt;font-family:Arial&apos;&gt; &lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; style=    &apos;text-align:justify;text-autospace:none&apos;&gt;&lt;span style=    &apos;font-size:10.0pt;font-family:Arial&apos;&gt;If any portion of this    section is held invalid or unenforceable under any particular    circumstance, the balance of the section is intended to apply    and the section as a whole is intended to apply in other    circumstances.&lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; style=    &apos;text-align:justify;text-autospace:none&apos;&gt;&lt;span style=    &apos;font-size:10.0pt;font-family:Arial&apos;&gt; &lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; style=    &apos;text-align:justify;text-autospace:none&apos;&gt;&lt;span style=    &apos;f!
 ont-size:10.0pt;font-family:Arial&apos;&gt;It is not the purpo!
 se of   
 this section to induce you to infringe any patents or other    property right claims or to contest validity of any such    claims; this section has the sole purpose of protecting the    integrity of the free software distribution system, which is    implemented by public license practices.  Many people have made    generous contributions to the wide range of software    distributed through that system in reliance on consistent    application of that system; it is up to the author/donor to    decide if he or she is willing to distribute software through    any other system and a licensee cannot impose that    choice.&lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; style=    &apos;text-align:justify;text-autospace:none&apos;&gt;&lt;span style=    &apos;font-size:10.0pt;font-family:Arial&apos;&gt; &lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; style=    &apos;text-align:justify;text-autospace:none&apos;&gt;&lt;span style=    &apos;font-size:10.0!
 pt;font-family:Arial&apos;&gt;This section is intended    to make thoroughly clear what is believed to be a consequence    of the rest of this License.&lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; style=    &apos;text-align:justify;text-autospace:none&apos;&gt;&lt;span style=    &apos;font-size:10.0pt;font-family:Arial&apos;&gt; &lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; style=    &apos;text-align:justify;text-autospace:none&apos;&gt;&lt;span style=    &apos;font-size:10.0pt;font-family:Arial&apos;&gt; &lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; style=    &apos;text-align:justify;text-autospace:none&apos;&gt;&lt;span style=    &apos;font-size:10.0pt;font-family:Arial&apos;&gt;8. If the distribution    and/or use of the Program is restricted in certain countries    either by patents or by copyrighted interfaces, the original    copyright holder who places the Program under this License may    add an explicit geograph!
 ical distribution limitation excluding    those countries, so !
 that dis
tribution is permitted only in or    among countries not thus excluded.  In such case, this License    incorporates the limitation as if written in the body of this    License.&lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; style=    &apos;text-align:justify;text-autospace:none&apos;&gt;&lt;span style=    &apos;font-size:10.0pt;font-family:Arial&apos;&gt; &lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; style=    &apos;text-align:justify;text-autospace:none&apos;&gt;&lt;span style=    &apos;font-size:10.0pt;font-family:Arial&apos;&gt;9. The Free Software    Foundation may publish revised and/or new versions of the    General Public License from time to time.  Such new versions    will be similar in spirit to the present version, but may    differ in detail to address new problems or    concerns.&lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; style=    &apos;text-align:justify;text-autospace:none&apos;&gt;&lt;span style=    &apos!
 ;font-size:10.0pt;font-family:Arial&apos;&gt; &lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; style=    &apos;text-align:justify;text-autospace:none&apos;&gt;&lt;span style=    &apos;font-size:10.0pt;font-family:Arial&apos;&gt;Each version is given a    distinguishing version number.  If the Program specifies a    version number of this License which applies to it and &quot;any    later version&quot;, you have the option of following the terms and    conditions either of that version or of any later version    published by the Free Software Foundation.  If the Program does    not specify a version number of this License, you may choose    any version ever published by the Free Software    Foundation.&lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; style=    &apos;text-align:justify;text-autospace:none&apos;&gt;&lt;span style=    &apos;font-size:10.0pt;font-family:Arial&apos;&gt; &lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; s!
 tyle=    &apos;text-align:justify;text-autospace:none&apos;&gt!
 ;&lt;spa
n style=    &apos;font-size:10.0pt;font-family:Arial&apos;&gt;10. If you wish to    incorporate parts of the Program into other free programs whose    distribution conditions are different, write to the author to    ask for permission.  For software which is copyrighted by the    Free Software Foundation, write to the Free Software    Foundation; we sometimes make exceptions for this.  Our    decision will be guided by the two goals of preserving the free    status of all derivatives of our free software and of promoting    the sharing and reuse of software generally.&lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; style=&apos;text-autospace:none&apos;&gt;    &lt;span style=&apos;font-size:10.0pt; font-family:Arial&apos;&gt; &lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; align=&quot;center&quot; style=    &apos;text-align:center;text-autospace:none&apos;&gt;&lt;b&gt;&lt;span style=    &apos;font-size:10.0pt;font-family:Arial&apos;&gt;NO WARRAN!
 TY&lt;/span&gt;&lt;/b&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; style=&apos;text-autospace:none&apos;&gt;    &lt;span style=&apos;font-size:10.0pt; font-family:Arial&apos;&gt; &lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; style=    &apos;text-align:justify;text-autospace:none&apos;&gt;&lt;span style=    &apos;font-size:10.0pt;font-family:Arial&apos;&gt;11. BECAUSE THE PROGRAM IS    LICENSED FREE OF CHARGE, THERE IS NO WARRANTY FOR THE PROGRAM,    TO THE EXTENT PERMITTED BY APPLICABLE LAW.  EXCEPT WHEN    OTHERWISE STATED IN WRITING THE COPYRIGHT HOLDERS AND/OR OTHER    PARTIES PROVIDE THE PROGRAM &quot;AS IS&quot; WITHOUT WARRANTY OF ANY    KIND, EITHER EXPRESSED OR IMPLIED, INCLUDING, BUT NOT LIMITED    TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A    PARTICULAR PURPOSE.  THE ENTIRE RISK AS TO THE QUALITY AND    PERFORMANCE OF THE PROGRAM IS WITH YOU.  SHOULD THE PROGRAM    PROVE DEFECTIVE, YOU ASSUME THE COST OF ALL NECESSAR!
 Y    SERVICING, REPAIR OR CORRECTION.&lt;/span&gt;&lt;/p&gt;  !
   &lt;p 
class=&quot;licenseStyle&quot; style=    &apos;text-align:justify;text-autospace:none&apos;&gt;&lt;span style=    &apos;font-size:10.0pt;font-family:Arial&apos;&gt; &lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; style=    &apos;text-align:justify;text-autospace:none&apos;&gt;&lt;span style=    &apos;font-size:10.0pt;font-family:Arial&apos;&gt;12. IN NO EVENT UNLESS    REQUIRED BY APPLICABLE LAW OR AGREED TO IN WRITING WILL ANY    COPYRIGHT HOLDER, OR ANY OTHER PARTY WHO MAY MODIFY AND/OR    REDISTRIBUTE THE PROGRAM AS PERMITTED ABOVE, BE LIABLE TO YOU    FOR DAMAGES, INCLUDING ANY GENERAL, SPECIAL, INCIDENTAL OR    CONSEQUENTIAL DAMAGES ARISING OUT OF THE USE OR INABILITY TO    USE THE PROGRAM (INCLUDING BUT NOT LIMITED TO LOSS OF DATA OR    DATA BEING RENDERED INACCURATE OR LOSSES SUSTAINED BY YOU OR    THIRD PARTIES OR A FAILURE OF THE PROGRAM TO OPERATE WITH ANY    OTHER PROGRAMS), EVEN IF SUCH HOLDER OR OTHER PARTY HAS BEEN    ADVISED OF THE POSSIBILITY !
 OF SUCH DAMAGES.&lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; style=&apos;text-autospace:none&apos;&gt;    &lt;span style=&apos;font-size:10.0pt; font-family:Arial&apos;&gt; &lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; align=&quot;center&quot; style=    &apos;text-align:center;text-autospace:none&apos;&gt;&lt;b&gt;&lt;span style=    &apos;font-size:10.0pt;font-family:Arial&apos;&gt;END OF TERMS AND    CONDITIONS&lt;/span&gt;&lt;/b&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; style=&apos;text-autospace:none&apos;&gt;    &lt;span style=&apos;font-size:10.0pt; font-family:Arial&apos;&gt; &lt;/span&gt;&lt;/p&gt;  &lt;/div&gt;&lt;/body&gt;&lt;/html&gt;</source>
-        <translation type="unfinished"></translation>
+        <translation>&lt;!DOCTYPE html PUBLIC &quot;-//W3C//DTD HTML 4.01 Transitional//EN&quot;&gt;&lt;html&gt;&lt;head&gt;  &lt;title&gt;Avidemux ? un programma libero e gratuito; puoi ridistribuirlo e/o modificarlo secondo i termini della Licenza Pubblica Generica GNU versione 2 come pubblicato dalla Free Software Foundation.&lt;/title&gt;&lt;style type=&quot;text/css&quot;&gt;&lt;!-- /* Style Definitions */ p.licenseStyle, li.licenseStyle, div.licenseStyle        {margin:0cm;        margin-bottom:.0001pt;        font-size:12.0pt;        font-family:&quot;Times New Roman&quot;;} /* Page Definitions */ @page Section1        {size:612.0pt 792.0pt;        margin:72.0pt 90.0pt 72.0pt 90.0pt;}div.Section1        {page:Section1;}--&gt;&lt;/style&gt;&lt;/head&gt;&lt;body lang=&quot;EN-GB&quot; style=&apos;text-justify-trim:punctuation&apos;&gt;  &lt;div class=&quot;Section1&quot;&gt;    &lt;p class=&quot;licenseStyle&quot; style=&apos;text-autospace:none&apos;&gt;    &lt;span !
 style=&apos;font-size:10.0pt; font-family:Arial&apos;&gt;Avidemux ? un programma libero e gratuito; puoi ridistribuirlo e/o modificarlo secondo i termini della Licenza Pubblica Generica GNU versione 2 come pubblicato dalla Free Software Foundation.&lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; style=&apos;text-autospace:none&apos;&gt;    &lt;b&gt;&lt;span style=&apos;font-size:10.0pt; font-family:Arial&apos;&gt;    &lt;/span&gt;&lt;/b&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; align=&quot;center&quot; style=    &apos;text-align:center;text-autospace:none&apos;&gt;&lt;b&gt;&lt;span style=    &apos;font-size:10.0pt;font-family:Arial&apos;&gt;GNU GENERAL PUBLIC    LICENSE&lt;/span&gt;&lt;/b&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; align=&quot;center&quot; style=    &apos;text-align:center;text-autospace:none&apos;&gt;&lt;b&gt;&lt;span style=    &apos;font-size:10.0pt;font-family:Arial&apos;&gt;Version 2, June    1991&lt;/span&gt;&lt;/b!
 &gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; style=&!
 apos;tex
t-autospace:none&apos;&gt;    &lt;span style=&apos;font-size:10.0pt; font-family:Arial&apos;&gt; &lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; align=&quot;center&quot; style=    &apos;text-align:center;text-autospace:none&apos;&gt;&lt;span style=    &apos;font-size:10.0pt;font-family:Arial&apos;&gt;Copyright (C) 1989, 1991    Free Software Foundation, Inc.&lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; align=&quot;center&quot; style=    &apos;text-align:center;text-autospace:none&apos;&gt;&lt;span lang=&quot;FR&quot; style=    &apos;font-size:10.0pt;font-family:Arial&apos;&gt;59 Temple Place, Suite    330, Boston, MA  02111-1307  USA&lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; align=&quot;center&quot; style=    &apos;text-align:center;text-autospace:none&apos;&gt;&lt;span lang=&quot;FR&quot; style=    &apos;font-size:10.0pt;font-family:Arial&apos;&gt; &lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; style=  !
   &apos;text-align:justify;text-autospace:none&apos;&gt;&lt;span style=    &apos;font-size:10.0pt;font-family:Arial&apos;&gt;Everyone is permitted to    copy and distribute verbatim copies of this license document,    but changing it is not allowed.&lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; style=&apos;text-autospace:none&apos;&gt;    &lt;span style=&apos;font-size:10.0pt; font-family:Arial&apos;&gt; &lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; align=&quot;center&quot; style=    &apos;text-align:center;text-autospace:none&apos;&gt;&lt;b&gt;&lt;span style=    &apos;font-size:10.0pt;font-family:Arial&apos;&gt;Preamble&lt;/span&gt;&lt;/b&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; style=&apos;text-autospace:none&apos;&gt;    &lt;span style=&apos;font-size:10.0pt; font-family:Arial&apos;&gt; &lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; style=    &apos;text-align:justify;text-autospace:none&apos;&gt;&lt;span st!
 yle=    &apos;font-size:10.0pt;font-family:Arial&apos;&gt;The !
 licenses
 for most    software are designed to take away your freedom to share and    change it.  By contrast, the GNU General Public License is    intended to guarantee your freedom to share and change free    software--to make sure the software is free for all its users.     This General Public License applies to most of the Free    Software Foundation&apos;s software and to any other program whose    authors commit to using it.  (Some other Free Software    Foundation software is covered by the GNU Library General    Public License instead.)  You can apply it to your programs,    too.&lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; style=    &apos;text-align:justify;text-autospace:none&apos;&gt;&lt;span style=    &apos;font-size:10.0pt;font-family:Arial&apos;&gt; &lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; style=    &apos;text-align:justify;text-autospace:none&apos;&gt;&lt;span style=    &apos;font-size:10.0pt;font-family:Arial&apos;&gt;When we s!
 peak of free    software, we are referring to freedom, not price.  Our General    Public Licenses are designed to make sure that you have the    freedom to distribute copies of free software (and charge for    this service if you wish), that you receive source code or can    get it if you want it, that you can change the software or use    pieces of it in new free programs; and that you know you can do    these things.&lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; style=    &apos;text-align:justify;text-autospace:none&apos;&gt;&lt;span style=    &apos;font-size:10.0pt;font-family:Arial&apos;&gt; &lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; style=    &apos;text-align:justify;text-autospace:none&apos;&gt;&lt;span style=    &apos;font-size:10.0pt;font-family:Arial&apos;&gt;To protect your rights, we    need to make restrictions that forbid anyone to deny you these    rights or to ask you to surrender the rights. These    restrictions transla!
 te to certain responsibilities for you if    you distribute co!
 pies of 
the software, or if you modify    it.&lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; style=    &apos;text-align:justify;text-autospace:none&apos;&gt;&lt;span style=    &apos;font-size:10.0pt;font-family:Arial&apos;&gt; &lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; style=    &apos;text-align:justify;text-autospace:none&apos;&gt;&lt;span style=    &apos;font-size:10.0pt;font-family:Arial&apos;&gt;For example, if you    distribute copies of such a program, whether gratis or for a    fee, you must give the recipients all the rights that you have.     You must make sure that they, too, receive or can get the    source code.  And you must show them these terms so they know    their rights.&lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; style=    &apos;text-align:justify;text-autospace:none&apos;&gt;&lt;span style=    &apos;font-size:10.0pt;font-family:Arial&apos;&gt; &lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; s!
 tyle=    &apos;text-align:justify;text-autospace:none&apos;&gt;&lt;span style=    &apos;font-size:10.0pt;font-family:Arial&apos;&gt;We protect your rights    with two steps: (1) copyright the software, and (2) offer you    this license which gives you legal permission to copy,    distribute and/or modify the software.&lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; style=    &apos;text-align:justify;text-autospace:none&apos;&gt;&lt;span style=    &apos;font-size:10.0pt;font-family:Arial&apos;&gt; &lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; style=    &apos;text-align:justify;text-autospace:none&apos;&gt;&lt;span style=    &apos;font-size:10.0pt;font-family:Arial&apos;&gt;Also, for each author&apos;s    protection and ours, we want to make certain that everyone    understands that there is no warranty for this free software.     If the software is modified by someone else and passed on, we    want its recipients to know that what they have i!
 s not the    original, so that any problems introduced by othe!
 rs will 
not    reflect on the original authors&apos; reputations.&lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; style=    &apos;text-align:justify;text-autospace:none&apos;&gt;&lt;span style=    &apos;font-size:10.0pt;font-family:Arial&apos;&gt; &lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; style=    &apos;text-align:justify;text-autospace:none&apos;&gt;&lt;span style=    &apos;font-size:10.0pt;font-family:Arial&apos;&gt;Finally, any free program    is threatened constantly by software patents.  We wish to avoid    the danger that redistributors of a free program will    individually obtain patent licenses, in effect making the    program proprietary.  To prevent this, we have made it clear    that any patent must be licensed for everyone&apos;s free use or not    licensed at all.&lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; style=    &apos;text-align:justify;text-autospace:none&apos;&gt;&lt;span style=    &apos;font-size:10.0pt;f!
 ont-family:Arial&apos;&gt; &lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; style=    &apos;text-align:justify;text-autospace:none&apos;&gt;&lt;span style=    &apos;font-size:10.0pt;font-family:Arial&apos;&gt;The precise terms and    conditions for copying, distribution and modification    follow.&lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; style=&apos;text-autospace:none&apos;&gt;    &lt;span style=&apos;font-size:10.0pt; font-family:Arial&apos;&gt; &lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; style=&apos;text-autospace:none&apos;&gt;    &lt;span style=&apos;font-size:10.0pt; font-family:Arial&apos;&gt; &lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; align=&quot;center&quot; style=    &apos;text-align:center;text-autospace:none&apos;&gt;&lt;b&gt;&lt;span style=    &apos;font-size:10.0pt;font-family:Arial&apos;&gt;GNU GENERAL PUBLIC    LICENSE&lt;/span&gt;&lt;/b&gt;&lt;/p&gt;    &lt;p class=&quot;licenseSt!
 yle&quot; align=&quot;center&quot; style=    &apos;text-align:!
 center;t
ext-autospace:none&apos;&gt;&lt;b&gt;&lt;span style=    &apos;font-size:10.0pt;font-family:Arial&apos;&gt;TERMS AND CONDITIONS FOR    COPYING, DISTRIBUTION AND MODIFICATION&lt;/span&gt;&lt;/b&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; style=&apos;text-autospace:none&apos;&gt;    &lt;span style=&apos;font-size:10.0pt; font-family:Arial&apos;&gt; &lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; style=    &apos;text-align:justify;text-autospace:none&apos;&gt;&lt;span style=    &apos;font-size:10.0pt;font-family:Arial&apos;&gt;0. This License applies to    any program or other work which contains a notice placed by the    copyright holder saying it may be distributed under the terms    of this General Public License.  The &quot;Program&quot;, below, refers    to any such program or work, and a &quot;work based on the Program&quot;    means either the Program or any derivative work under copyright    law: that is to say, a work containing the Program or !
 a portion    of it, either verbatim or with modifications and/or translated    into another language.  (Hereinafter, translation is included    without limitation in the term &quot;modification&quot;.)  Each licensee    is addressed as &quot;you&quot;.&lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; style=    &apos;text-align:justify;text-autospace:none&apos;&gt;&lt;span style=    &apos;font-size:10.0pt;font-family:Arial&apos;&gt; &lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; style=    &apos;text-align:justify;text-autospace:none&apos;&gt;&lt;span style=    &apos;font-size:10.0pt;font-family:Arial&apos;&gt;Activities other than    copying, distribution and modification are not covered by this    License; they are outside its scope.  The act of running the    Program is not restricted, and the output from the Program is    covered only if its contents constitute a work based on the    Program (independent of having been made by running the   !
  Program). Whether that is true depends on what the Program   !
  does.&l
t;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; style=    &apos;text-align:justify;text-autospace:none&apos;&gt;&lt;span style=    &apos;font-size:10.0pt;font-family:Arial&apos;&gt; &lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; style=    &apos;text-align:justify;text-autospace:none&apos;&gt;&lt;span style=    &apos;font-size:10.0pt;font-family:Arial&apos;&gt;1. You may copy and    distribute verbatim copies of the Program&apos;s source code as you    receive it, in any medium, provided that you conspicuously and    appropriately publish on each copy an appropriate copyright    notice and disclaimer of warranty; keep intact all the notices    that refer to this License and to the absence of any warranty;    and give any other recipients of the Program a copy of this    License along with the Program.&lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; style=    &apos;text-align:justify;text-autospace:none&apos;&gt;&lt;span style=    !
 &apos;font-size:10.0pt;font-family:Arial&apos;&gt; &lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; style=    &apos;text-align:justify;text-autospace:none&apos;&gt;&lt;span style=    &apos;font-size:10.0pt;font-family:Arial&apos;&gt;You may charge a fee for    the physical act of transferring a copy, and you may at your    option offer warranty protection in exchange for a    fee.&lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; style=    &apos;text-align:justify;text-autospace:none&apos;&gt;&lt;span style=    &apos;font-size:10.0pt;font-family:Arial&apos;&gt; &lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; style=    &apos;text-align:justify;text-autospace:none&apos;&gt;&lt;span style=    &apos;font-size:10.0pt;font-family:Arial&apos;&gt;2. You may modify your    copy or copies of the Program or any portion of it, thus    forming a work based on the Program, and copy and distribute    such modifications or work under the terms of!
  Section 1 above,    provided that you also meet all of these !
 conditio
ns:&lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; style=    &apos;text-align:justify;text-autospace:none&apos;&gt;&lt;span style=    &apos;font-size:10.0pt;font-family:Arial&apos;&gt; &lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; style=    &apos;text-align:justify;text-autospace:none&apos;&gt;&lt;span style=    &apos;font-size:10.0pt;font-family:Arial&apos;&gt;a) You must cause the    modified files to carry prominent notices stating that you    changed the files and the date of any change.&lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; style=    &apos;text-align:justify;text-autospace:none&apos;&gt;&lt;span style=    &apos;font-size:10.0pt;font-family:Arial&apos;&gt; &lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; style=    &apos;text-align:justify;text-autospace:none&apos;&gt;&lt;span style=    &apos;font-size:10.0pt;font-family:Arial&apos;&gt;b) You must cause any work    that you distribute or publish, th!
 at in whole or in part    contains or is derived from the Program or any part thereof, to    be licensed as a whole at no charge to all third parties under    the terms of this License.&lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; style=    &apos;text-align:justify;text-autospace:none&apos;&gt;&lt;span style=    &apos;font-size:10.0pt;font-family:Arial&apos;&gt; &lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; style=    &apos;text-align:justify;text-autospace:none&apos;&gt;&lt;span style=    &apos;font-size:10.0pt;font-family:Arial&apos;&gt;c) If the modified program    normally reads commands interactively when run, you must cause    it, when started running for such interactive use in the most    ordinary way, to print or display an announcement including an    appropriate copyright notice and a notice that there is no    warranty (or else, saying that you provide a warranty) and that    users may redistribute the program under these condi!
 tions, and    telling the user how to view a copy of this Lice!
 nse.    
 (Exception: if the Program itself is interactive but does not    normally print such an announcement, your work based on the    Program is not required to print an announcement.)&lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; style=    &apos;text-align:justify;text-autospace:none&apos;&gt;&lt;span style=    &apos;font-size:10.0pt;font-family:Arial&apos;&gt; &lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; style=    &apos;text-align:justify;text-autospace:none&apos;&gt;&lt;span style=    &apos;font-size:10.0pt;font-family:Arial&apos;&gt; &lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; style=    &apos;text-align:justify;text-autospace:none&apos;&gt;&lt;span style=    &apos;font-size:10.0pt;font-family:Arial&apos;&gt;These requirements apply    to the modified work as a whole.  If identifiable sections of    that work are not derived from the Program, and can be    reasonably considered independent and separate works in    themsel!
 ves, then this License, and its terms, do not apply to    those sections when you distribute them as separate works.  But    when you distribute the same sections as part of a whole which    is a work based on the Program, the distribution of the whole    must be on the terms of this License, whose permissions for    other licensees extend to the entire whole, and thus to each    and every part regardless of who wrote it.&lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; style=    &apos;text-align:justify;text-autospace:none&apos;&gt;&lt;span style=    &apos;font-size:10.0pt;font-family:Arial&apos;&gt; &lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; style=    &apos;text-align:justify;text-autospace:none&apos;&gt;&lt;span style=    &apos;font-size:10.0pt;font-family:Arial&apos;&gt;Thus, it is not the intent    of this section to claim rights or contest your rights to work    written entirely by you; rather, the intent is to exercise the    right !
 to control the distribution of derivative or collective    wor!
 ks based
 on the Program.&lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; style=    &apos;text-align:justify;text-autospace:none&apos;&gt;&lt;span style=    &apos;font-size:10.0pt;font-family:Arial&apos;&gt; &lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; style=    &apos;text-align:justify;text-autospace:none&apos;&gt;&lt;span style=    &apos;font-size:10.0pt;font-family:Arial&apos;&gt;In addition, mere    aggregation of another work not based on the Program with the    Program (or with a work based on the Program) on a volume of a    storage or distribution medium does not bring the other work    under the scope of this License.&lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; style=    &apos;text-align:justify;text-autospace:none&apos;&gt;&lt;span style=    &apos;font-size:10.0pt;font-family:Arial&apos;&gt; &lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; style=    &apos;text-align:justify;text-autospace:none&apos;&gt;&lt;!
 span style=    &apos;font-size:10.0pt;font-family:Arial&apos;&gt;3. You may copy and    distribute the Program (or a work based on it, under Section 2)    in object code or executable form under the terms of Sections 1    and 2 above provided that you also do one of the    following:&lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; style=    &apos;text-align:justify;text-autospace:none&apos;&gt;&lt;span style=    &apos;font-size:10.0pt;font-family:Arial&apos;&gt; &lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; style=    &apos;text-align:justify;text-autospace:none&apos;&gt;&lt;span style=    &apos;font-size:10.0pt;font-family:Arial&apos;&gt;a) Accompany it with the    complete corresponding machine-readable source code, which must    be distributed under the terms of Sections 1 and 2 above on a    medium customarily used for software interchange;    or,&lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; style=    &apos;text-align:ju!
 stify;text-autospace:none&apos;&gt;&lt;span style=    &apos;fo!
 nt-size:
10.0pt;font-family:Arial&apos;&gt; &lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; style=    &apos;text-align:justify;text-autospace:none&apos;&gt;&lt;span style=    &apos;font-size:10.0pt;font-family:Arial&apos;&gt;b) Accompany it with a    written offer, valid for at least three years, to give any    third party, for a charge no more than your cost of physically    performing source distribution, a complete machine-readable    copy of the corresponding source code, to be distributed under    the terms of Sections 1 and 2 above on a medium customarily    used for software interchange; or,&lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; style=    &apos;text-align:justify;text-autospace:none&apos;&gt;&lt;span style=    &apos;font-size:10.0pt;font-family:Arial&apos;&gt; &lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; style=    &apos;text-align:justify;text-autospace:none&apos;&gt;&lt;span style=    &apos;font-size:10.0pt;font-fami!
 ly:Arial&apos;&gt;c) Accompany it with the    information you received as to the offer to distribute    corresponding source code.  (This alternative is allowed only    for noncommercial distribution and only if you received the    program in object code or executable form with such an offer,    in accord with Subsection b above.)&lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; style=    &apos;text-align:justify;text-autospace:none&apos;&gt;&lt;span style=    &apos;font-size:10.0pt;font-family:Arial&apos;&gt; &lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; style=    &apos;text-align:justify;text-autospace:none&apos;&gt;&lt;span style=    &apos;font-size:10.0pt;font-family:Arial&apos;&gt;The source code for a work    means the preferred form of the work for making modifications    to it.  For an executable work, complete source code means all    the source code for all modules it contains, plus any    associated interface definition files, plus!
  the scripts used to    control compilation and installation o!
 f the ex
ecutable.     However, as a special exception, the source code distributed    need not include anything that is normally distributed (in    either source or binary form) with the major components    (compiler, kernel, and so on) of the operating system on which    the executable runs, unless that component itself accompanies    the executable.&lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; style=    &apos;text-align:justify;text-autospace:none&apos;&gt;&lt;span style=    &apos;font-size:10.0pt;font-family:Arial&apos;&gt; &lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; style=    &apos;text-align:justify;text-autospace:none&apos;&gt;&lt;span style=    &apos;font-size:10.0pt;font-family:Arial&apos;&gt;If distribution of    executable or object code is made by offering access to copy    from a designated place, then offering equivalent access to    copy the source code from the same place counts as distribution    of the source code, even though t!
 hird parties are not compelled    to copy the source along with the object code.&lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; style=    &apos;text-align:justify;text-autospace:none&apos;&gt;&lt;span style=    &apos;font-size:10.0pt;font-family:Arial&apos;&gt; &lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; style=    &apos;text-align:justify;text-autospace:none&apos;&gt;&lt;span style=    &apos;font-size:10.0pt;font-family:Arial&apos;&gt; &lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; style=    &apos;text-align:justify;text-autospace:none&apos;&gt;&lt;span style=    &apos;font-size:10.0pt;font-family:Arial&apos;&gt;4. You may not copy,    modify, sublicense, or distribute the Program except as    expressly provided under this License.  Any attempt otherwise    to copy, modify, sublicense or distribute the Program is void,    and will automatically terminate your rights under this    License. However, parties who have receive!
 d copies, or rights,    from you under this License will not h!
 ave thei
r licenses    terminated so long as such parties remain in full    compliance.&lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; style=    &apos;text-align:justify;text-autospace:none&apos;&gt;&lt;span style=    &apos;font-size:10.0pt;font-family:Arial&apos;&gt; &lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; style=    &apos;text-align:justify;text-autospace:none&apos;&gt;&lt;span style=    &apos;font-size:10.0pt;font-family:Arial&apos;&gt;5. You are not required to    accept this License, since you have not signed it.  However,    nothing else grants you permission to modify or distribute the    Program or its derivative works.  These actions are prohibited    by law if you do not accept this License.  Therefore, by    modifying or distributing the Program (or any work based on the    Program), you indicate your acceptance of this License to do    so, and all its terms and conditions for copying, distributing    or modifying the Program or works!
  based on it.&lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; style=    &apos;text-align:justify;text-autospace:none&apos;&gt;&lt;span style=    &apos;font-size:10.0pt;font-family:Arial&apos;&gt; &lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; style=    &apos;text-align:justify;text-autospace:none&apos;&gt;&lt;span style=    &apos;font-size:10.0pt;font-family:Arial&apos;&gt;6. Each time you    redistribute the Program (or any work based on the Program),    the recipient automatically receives a license from the    original licensor to copy, distribute or modify the Program    subject to these terms and conditions.  You may not impose any    further restrictions on the recipients&apos; exercise of the rights    granted herein. You are not responsible for enforcing    compliance by third parties to this License.&lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; style=    &apos;text-align:justify;text-autospace:none&apos;&gt;&lt;span!
  style=    &apos;font-size:10.0pt;font-family:Arial&apos;&gt; !
 &lt;/spa
n&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; style=    &apos;text-align:justify;text-autospace:none&apos;&gt;&lt;span style=    &apos;font-size:10.0pt;font-family:Arial&apos;&gt;7. If, as a consequence of    a court judgment or allegation of patent infringement or for    any other reason (not limited to patent issues), conditions are    imposed on you (whether by court order, agreement or otherwise)    that contradict the conditions of this License, they do not    excuse you from the conditions of this License.  If you cannot    distribute so as to satisfy simultaneously your obligations    under this License and any other pertinent obligations, then as    a consequence you may not distribute the Program at all.  For    example, if a patent license would not permit royalty-free    redistribution of the Program by all those who receive copies    directly or indirectly through you, then the only way you could    satisfy both it and this License would be to refrain e!
 ntirely    from distribution of the Program.&lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; style=    &apos;text-align:justify;text-autospace:none&apos;&gt;&lt;span style=    &apos;font-size:10.0pt;font-family:Arial&apos;&gt; &lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; style=    &apos;text-align:justify;text-autospace:none&apos;&gt;&lt;span style=    &apos;font-size:10.0pt;font-family:Arial&apos;&gt;If any portion of this    section is held invalid or unenforceable under any particular    circumstance, the balance of the section is intended to apply    and the section as a whole is intended to apply in other    circumstances.&lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; style=    &apos;text-align:justify;text-autospace:none&apos;&gt;&lt;span style=    &apos;font-size:10.0pt;font-family:Arial&apos;&gt; &lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; style=    &apos;text-align:justify;text-autospace:none&ap!
 os;&gt;&lt;span style=    &apos;font-size:10.0pt;font-family:A!
 rial&apo
s;&gt;It is not the purpose of    this section to induce you to infringe any patents or other    property right claims or to contest validity of any such    claims; this section has the sole purpose of protecting the    integrity of the free software distribution system, which is    implemented by public license practices.  Many people have made    generous contributions to the wide range of software    distributed through that system in reliance on consistent    application of that system; it is up to the author/donor to    decide if he or she is willing to distribute software through    any other system and a licensee cannot impose that    choice.&lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; style=    &apos;text-align:justify;text-autospace:none&apos;&gt;&lt;span style=    &apos;font-size:10.0pt;font-family:Arial&apos;&gt; &lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; style=    &apos;text-align:justify;text-autospace:none&apos;&gt;&lt;sp!
 an style=    &apos;font-size:10.0pt;font-family:Arial&apos;&gt;This section is intended    to make thoroughly clear what is believed to be a consequence    of the rest of this License.&lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; style=    &apos;text-align:justify;text-autospace:none&apos;&gt;&lt;span style=    &apos;font-size:10.0pt;font-family:Arial&apos;&gt; &lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; style=    &apos;text-align:justify;text-autospace:none&apos;&gt;&lt;span style=    &apos;font-size:10.0pt;font-family:Arial&apos;&gt; &lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; style=    &apos;text-align:justify;text-autospace:none&apos;&gt;&lt;span style=    &apos;font-size:10.0pt;font-family:Arial&apos;&gt;8. If the distribution    and/or use of the Program is restricted in certain countries    either by patents or by copyrighted interfaces, the original    copyright holder who places the Program under this Licens!
 e may    add an explicit geographical distribution limitation !
 excludin
g    those countries, so that distribution is permitted only in or    among countries not thus excluded.  In such case, this License    incorporates the limitation as if written in the body of this    License.&lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; style=    &apos;text-align:justify;text-autospace:none&apos;&gt;&lt;span style=    &apos;font-size:10.0pt;font-family:Arial&apos;&gt; &lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; style=    &apos;text-align:justify;text-autospace:none&apos;&gt;&lt;span style=    &apos;font-size:10.0pt;font-family:Arial&apos;&gt;9. The Free Software    Foundation may publish revised and/or new versions of the    General Public License from time to time.  Such new versions    will be similar in spirit to the present version, but may    differ in detail to address new problems or    concerns.&lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; style=    &apos;text-align:justify;text-autospace:none&!
 apos;&gt;&lt;span style=    &apos;font-size:10.0pt;font-family:Arial&apos;&gt; &lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; style=    &apos;text-align:justify;text-autospace:none&apos;&gt;&lt;span style=    &apos;font-size:10.0pt;font-family:Arial&apos;&gt;Each version is given a    distinguishing version number.  If the Program specifies a    version number of this License which applies to it and &quot;any    later version&quot;, you have the option of following the terms and    conditions either of that version or of any later version    published by the Free Software Foundation.  If the Program does    not specify a version number of this License, you may choose    any version ever published by the Free Software    Foundation.&lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; style=    &apos;text-align:justify;text-autospace:none&apos;&gt;&lt;span style=    &apos;font-size:10.0pt;font-family:Arial&apos;&gt; &lt;/span&gt;&lt;/p&gt;    &lt;p!
  class=&quot;licenseStyle&quot; style=    &apos;text-align:jus!
 tify;tex
t-autospace:none&apos;&gt;&lt;span style=    &apos;font-size:10.0pt;font-family:Arial&apos;&gt;10. If you wish to    incorporate parts of the Program into other free programs whose    distribution conditions are different, write to the author to    ask for permission.  For software which is copyrighted by the    Free Software Foundation, write to the Free Software    Foundation; we sometimes make exceptions for this.  Our    decision will be guided by the two goals of preserving the free    status of all derivatives of our free software and of promoting    the sharing and reuse of software generally.&lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; style=&apos;text-autospace:none&apos;&gt;    &lt;span style=&apos;font-size:10.0pt; font-family:Arial&apos;&gt; &lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; align=&quot;center&quot; style=    &apos;text-align:center;text-autospace:none&apos;&gt;&lt;b&gt;&lt;span style=    &apos;font-size:10.0pt;fon!
 t-family:Arial&apos;&gt;NO WARRANTY&lt;/span&gt;&lt;/b&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; style=&apos;text-autospace:none&apos;&gt;    &lt;span style=&apos;font-size:10.0pt; font-family:Arial&apos;&gt; &lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; style=    &apos;text-align:justify;text-autospace:none&apos;&gt;&lt;span style=    &apos;font-size:10.0pt;font-family:Arial&apos;&gt;11. BECAUSE THE PROGRAM IS    LICENSED FREE OF CHARGE, THERE IS NO WARRANTY FOR THE PROGRAM,    TO THE EXTENT PERMITTED BY APPLICABLE LAW.  EXCEPT WHEN    OTHERWISE STATED IN WRITING THE COPYRIGHT HOLDERS AND/OR OTHER    PARTIES PROVIDE THE PROGRAM &quot;AS IS&quot; WITHOUT WARRANTY OF ANY    KIND, EITHER EXPRESSED OR IMPLIED, INCLUDING, BUT NOT LIMITED    TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A    PARTICULAR PURPOSE.  THE ENTIRE RISK AS TO THE QUALITY AND    PERFORMANCE OF THE PROGRAM IS WITH YOU.  SHOULD THE PROGRAM    PROVE DEFECTIVE, YO!
 U ASSUME THE COST OF ALL NECESSARY    SERVICING, REPAIR OR COR!
 RECTION.
&lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; style=    &apos;text-align:justify;text-autospace:none&apos;&gt;&lt;span style=    &apos;font-size:10.0pt;font-family:Arial&apos;&gt; &lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; style=    &apos;text-align:justify;text-autospace:none&apos;&gt;&lt;span style=    &apos;font-size:10.0pt;font-family:Arial&apos;&gt;12. IN NO EVENT UNLESS    REQUIRED BY APPLICABLE LAW OR AGREED TO IN WRITING WILL ANY    COPYRIGHT HOLDER, OR ANY OTHER PARTY WHO MAY MODIFY AND/OR    REDISTRIBUTE THE PROGRAM AS PERMITTED ABOVE, BE LIABLE TO YOU    FOR DAMAGES, INCLUDING ANY GENERAL, SPECIAL, INCIDENTAL OR    CONSEQUENTIAL DAMAGES ARISING OUT OF THE USE OR INABILITY TO    USE THE PROGRAM (INCLUDING BUT NOT LIMITED TO LOSS OF DATA OR    DATA BEING RENDERED INACCURATE OR LOSSES SUSTAINED BY YOU OR    THIRD PARTIES OR A FAILURE OF THE PROGRAM TO OPERATE WITH ANY    OTHER PROGRAMS), EVEN IF SUCH HOLDER OR OTHER PARTY HAS BE!
 EN    ADVISED OF THE POSSIBILITY OF SUCH DAMAGES.&lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; style=&apos;text-autospace:none&apos;&gt;    &lt;span style=&apos;font-size:10.0pt; font-family:Arial&apos;&gt; &lt;/span&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; align=&quot;center&quot; style=    &apos;text-align:center;text-autospace:none&apos;&gt;&lt;b&gt;&lt;span style=    &apos;font-size:10.0pt;font-family:Arial&apos;&gt;END OF TERMS AND    CONDITIONS&lt;/span&gt;&lt;/b&gt;&lt;/p&gt;    &lt;p class=&quot;licenseStyle&quot; style=&apos;text-autospace:none&apos;&gt;    &lt;span style=&apos;font-size:10.0pt; font-family:Arial&apos;&gt; &lt;/span&gt;&lt;/p&gt;  &lt;/div&gt;&lt;/body&gt;&lt;/html&gt;</translation>
     </message>
 </context>
 <context>
@@ -9555,6 +9603,11 @@
         <source>Root privileges are required to perform this operation.</source>
         <translation>Sono richesti i privilegi di amministratore per eseguire questa operazione.</translation>
     </message>
+    <message>
+        <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_encoding.cpp" line="127"/>
+        <source>Pause / Abort</source>
+        <translation>Pausa / Annulla </translation>
+    </message>
 </context>
 <context>
     <name>filtermainWindow</name>

Modified: branches/avidemux_2.5_branch_gruntster/po/it.po
===================================================================
--- branches/avidemux_2.5_branch_gruntster/po/it.po	2009-02-05 19:10:42 UTC (rev 4572)
+++ branches/avidemux_2.5_branch_gruntster/po/it.po	2009-02-05 20:04:06 UTC (rev 4573)
@@ -3,7 +3,7 @@
 "Project-Id-Version: avidemux\n"
 "Report-Msgid-Bugs-To: \n"
 "POT-Creation-Date: 2006-10-04 22:09+0300\n"
-"PO-Revision-Date: 2008-10-18 09:53+0100\n"
+"PO-Revision-Date: 2009-02-03 14:44+0100\n"
 "Last-Translator: \n"
 "Language-Team: it\n"
 "MIME-Version: 1.0\n"
@@ -170,8 +170,8 @@
 #: avidemux/ADM_outputs/oplug_flv/oplug_flv.cpp:236
 #: avidemux/ADM_outputs/oplug_flv/oplug_flv.cpp:257
 #: avidemux/ADM_outputs/oplug_mp4/oplug_mp4.cpp:165
-#: avidemux/ADM_outputs/oplug_mp4/oplug_mp4.cpp:257
-#: avidemux/ADM_outputs/oplug_mp4/oplug_mp4.cpp:278
+#: avidemux/ADM_outputs/oplug_mp4/oplug_mp4.cpp:239
+#: avidemux/ADM_outputs/oplug_mp4/oplug_mp4.cpp:251
 #: avidemux/ADM_outputs/oplug_mpeg/op_mpegpass.cpp:221
 #: avidemux/ADM_outputs/oplug_mpeg/op_mpegpass.cpp:225
 #: avidemux/ADM_outputs/oplug_mpegFF/oplug_vcdff.cpp:379
@@ -407,33 +407,39 @@
 msgid "Attempt to open %s failed!"
 msgstr "Tentativo di aprire %s fallito!"
 
-#: avidemux/ADM_editor/ADM_edit.cpp:439
+#: avidemux/ADM_editor/ADM_edit.cpp:431
+msgid "Video dimensions don't match."
+msgstr "Le dimensioni video non corrispondono."
+
+#: avidemux/ADM_editor/ADM_edit.cpp:431
 msgid ""
-"You cannot mix different video dimensions yet. Using the partial video filter later, will not work around this problem. The workaround is:\n"
-"1.) \"resize\" / \"add border\" / \"crop\" each stream to the same resolution\n"
-"2.) concatinate them together"
+"You cannot mix different video dimensions yet. Using the partial video filter later will not work around this problem. The workaround is:\n"
+"\n"
+"1) \"Resize\" / \"Add Border\" / \"Crop\" each stream to the same resolution\n"
+"2) Concatenate them together"
 msgstr ""
-"Non puoi ancora mescolare dimensioni video differenti. Usare il filtro video parziale, non risolver? il problema. La soluzione ?:\n"
-"1.) \"ridimensiona\" / \"aggiungi bordi\" / \"ritaglia\" ogni flusso alla stessa risoluzione\n"
-"2.) concatenali insieme"
+"Non ? possibile unire video di dimensioni diverse. L'utilizzo del filtro video parziale non risolve il problema. La soluzione ? la seguente:\n"
+"\n"
+"1) ridimensiona, aggiungi bordi o ritaglia tutti i flussi alla stessa risoluzione\n"
+"2) concatenali insieme"
 
-#: avidemux/ADM_editor/ADM_edit.cpp:551
+#: avidemux/ADM_editor/ADM_edit.cpp:543
 msgid "Build Time Map"
 msgstr "Crea time map"
 
-#: avidemux/ADM_editor/ADM_edit.cpp:551
+#: avidemux/ADM_editor/ADM_edit.cpp:543
 msgid "Build VBR time map?"
 msgstr "Creare la time map VBR?"
 
-#: avidemux/ADM_editor/ADM_edit.cpp:585
+#: avidemux/ADM_editor/ADM_edit.cpp:577
 msgid "Use safe mode"
 msgstr "Usa modalit? sicura"
 
-#: avidemux/ADM_editor/ADM_edit.cpp:585
+#: avidemux/ADM_editor/ADM_edit.cpp:577
 msgid "H.264 detected"
 msgstr "H.264 rilevato"
 
-#: avidemux/ADM_editor/ADM_edit.cpp:585
+#: avidemux/ADM_editor/ADM_edit.cpp:577
 msgid ""
 "If the file is using B-frames as reference it can lead to a crash or stuttering.\n"
 "Avidemux can use another mode which is safe but YOU WILL LOSE FRAME ACCURACY.\n"
@@ -443,47 +449,47 @@
 "Avidemux pu? utilizzare un'altra modalit? pi? sicura, ma PERDERAI PRECISIONE NEI FOTOGRAMMI.\n"
 "Vuoi usare questa modalit??"
 
-#: avidemux/ADM_editor/ADM_edit.cpp:715
+#: avidemux/ADM_editor/ADM_edit.cpp:707
 msgid "Packed Bitstream detected"
 msgstr "Flusso di bit compresso rilevato"
 
-#: avidemux/ADM_editor/ADM_edit.cpp:716
+#: avidemux/ADM_editor/ADM_edit.cpp:708
 msgid "Do you want me to unpack it ?"
 msgstr "Vuoi decomprimerlo?"
 
-#: avidemux/ADM_editor/ADM_edit.cpp:736
+#: avidemux/ADM_editor/ADM_edit.cpp:728
 msgid "Could not unpack the video"
 msgstr "Impossibile decomprimere il video"
 
-#: avidemux/ADM_editor/ADM_edit.cpp:736
+#: avidemux/ADM_editor/ADM_edit.cpp:728
 msgid "Using backup decoder - not frame accurate."
 msgstr "Utilizzo decodificatore backup - non preciso sui fotogrammi."
 
-#: avidemux/ADM_editor/ADM_edit.cpp:741
+#: avidemux/ADM_editor/ADM_edit.cpp:733
 msgid "Weird"
 msgstr "Strano"
 
-#: avidemux/ADM_editor/ADM_edit.cpp:741
+#: avidemux/ADM_editor/ADM_edit.cpp:733
 msgid "The unpacking succeedeed but the index is still not up to date."
 msgstr "La decompressione ? riuscita ma l'indice non ? ancora aggiornato."
 
-#: avidemux/ADM_editor/ADM_edit.cpp:747
+#: avidemux/ADM_editor/ADM_edit.cpp:739
 msgid "Troubles ahead"
 msgstr "Problemi avanti"
 
-#: avidemux/ADM_editor/ADM_edit.cpp:747
+#: avidemux/ADM_editor/ADM_edit.cpp:739
 msgid "This a VOP packed AVI."
 msgstr "Questo ? un AVI compresso con VOP."
 
-#: avidemux/ADM_editor/ADM_edit.cpp:758
+#: avidemux/ADM_editor/ADM_edit.cpp:750
 msgid "Index is not up to date"
 msgstr "L'indice non ? aggiornato"
 
-#: avidemux/ADM_editor/ADM_edit.cpp:758
+#: avidemux/ADM_editor/ADM_edit.cpp:750
 msgid "You should use Tool->Rebuild frame. Do it now ?"
 msgstr "Dovresti usare Strumenti -> Ricostruisci fotogrammi. Vuoi farlo ora?"
 
-#: avidemux/ADM_editor/ADM_edit.cpp:1520
+#: avidemux/ADM_editor/ADM_edit.cpp:1512
 msgid ""
 "This looks like mpeg\n"
 " Do you want to index it?"
@@ -491,7 +497,7 @@
 "Questo sembra un file mpeg\n"
 " Vuoi indicizzarlo?"
 
-#: avidemux/ADM_editor/ADM_edit.cpp:1572
+#: avidemux/ADM_editor/ADM_edit.cpp:1564
 msgid "Indexing failed"
 msgstr "Indicizzazione fallita"
 
@@ -1129,6 +1135,7 @@
 msgstr "Aggiunge un'immagine png come logo."
 
 #: avidemux/ADM_filter/filter_declaration.cpp:182
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_animated.cpp:53
 msgid "Animated Menu"
 msgstr "Menu animato"
 
@@ -1468,7 +1475,7 @@
 msgstr ""
 "? avvenuto un errore fatale.\n"
 "\n"
-"Clicca OK per visualizzare le informazioni di debug. Potrebbe richiedere alcuni minuti."
+"Clicca OK per produrre le informazioni di debug. Potrebbe richiedere alcuni minuti."
 
 #: avidemux/ADM_osSupport/ADM_crashdump.cpp:437
 msgid "Load it"
@@ -1617,7 +1624,7 @@
 #: avidemux/ADM_outputs/oplug_flv/oplug_flv.cpp:188
 #: avidemux/ADM_outputs/oplug_flv/oplug_flv.cpp:240
 #: avidemux/ADM_outputs/oplug_mp4/oplug_mp4.cpp:163
-#: avidemux/ADM_outputs/oplug_mp4/oplug_mp4.cpp:261
+#: avidemux/ADM_outputs/oplug_mp4/oplug_mp4.cpp:243
 #: avidemux/ADM_outputs/oplug_ogm/op_ogaudio.cpp:70
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_audioFilter.cpp:80
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_audioFilter.cpp:89
@@ -1735,7 +1742,7 @@
 msgstr "Inizializzazione filtro fallita"
 
 #: avidemux/ADM_outputs/oplug_avi/op_saveprocess.cpp:128
-#: avidemux/ADM_outputs/oplug_mp4/oplug_mp4.cpp:418
+#: avidemux/ADM_outputs/oplug_mp4/oplug_mp4.cpp:420
 #: avidemux/ADM_outputs/oplug_ogm/op_ogsaveprocess.cpp:103
 msgid ""
 "\n"
@@ -1745,7 +1752,7 @@
 " Riutilizzare il file log esistente?"
 
 #: avidemux/ADM_outputs/oplug_avi/op_saveprocess.cpp:137
-#: avidemux/ADM_outputs/oplug_mp4/oplug_mp4.cpp:426
+#: avidemux/ADM_outputs/oplug_mp4/oplug_mp4.cpp:428
 msgid "1st Pass"
 msgstr "1a passata"
 
@@ -1760,14 +1767,15 @@
 #: avidemux/ADM_outputs/oplug_mpegFF/oplug_vcdff.cpp:373
 #: avidemux/ADM_outputs/oplug_ogm/op_ogsaveprocess.cpp:167
 msgid "Encoding"
-msgstr "Codifica in corso"
+msgstr "Codifica"
 
 #: avidemux/ADM_outputs/oplug_avi/op_saveprocess.cpp:269
-#: avidemux/ADM_outputs/oplug_mp4/oplug_mp4.cpp:501
+#: avidemux/ADM_outputs/oplug_mp4/oplug_mp4.cpp:503
 msgid "2nd Pass"
 msgstr "2a passata"
 
 #: avidemux/ADM_outputs/oplug_avi/op_savesmart.cpp:107
+#: avidemux/gui_savenew.cpp:351
 msgid "Smart Copy"
 msgstr "Copia intelligente"
 
@@ -1783,23 +1791,23 @@
 
 #: avidemux/ADM_outputs/oplug_dummy/oplug_dummy.cpp:206
 #: avidemux/ADM_outputs/oplug_flv/oplug_flv.cpp:321
-#: avidemux/ADM_outputs/oplug_mp4/oplug_mp4.cpp:346
-#: avidemux/ADM_outputs/oplug_mp4/oplug_mp4.cpp:462
+#: avidemux/ADM_outputs/oplug_mp4/oplug_mp4.cpp:300
+#: avidemux/ADM_outputs/oplug_mp4/oplug_mp4.cpp:464
 #: avidemux/ADM_outputs/oplug_mpeg/op_mpegpass.cpp:352
 msgid "Error while encoding"
 msgstr "Errore durante la codifica"
 
 #: avidemux/ADM_outputs/oplug_dummy/oplug_dummy.cpp:213
 #: avidemux/ADM_outputs/oplug_flv/oplug_flv.cpp:328
-#: avidemux/ADM_outputs/oplug_mp4/oplug_mp4.cpp:353
-#: avidemux/ADM_outputs/oplug_mp4/oplug_mp4.cpp:469
+#: avidemux/ADM_outputs/oplug_mp4/oplug_mp4.cpp:307
+#: avidemux/ADM_outputs/oplug_mp4/oplug_mp4.cpp:471
 msgid "KeyFrame error"
 msgstr "Errore fotogramma chiave"
 
 #: avidemux/ADM_outputs/oplug_dummy/oplug_dummy.cpp:213
 #: avidemux/ADM_outputs/oplug_flv/oplug_flv.cpp:328
-#: avidemux/ADM_outputs/oplug_mp4/oplug_mp4.cpp:353
-#: avidemux/ADM_outputs/oplug_mp4/oplug_mp4.cpp:469
+#: avidemux/ADM_outputs/oplug_mp4/oplug_mp4.cpp:307
+#: avidemux/ADM_outputs/oplug_mp4/oplug_mp4.cpp:471
 msgid ""
 "The beginning frame is not a key frame.\n"
 "Please move the A marker."
@@ -1829,7 +1837,7 @@
 msgstr "La frequenza deve essere 44100, 22050 o 11025 Hz."
 
 #: avidemux/ADM_outputs/oplug_flv/oplug_flv.cpp:225
-#: avidemux/ADM_outputs/oplug_mp4/oplug_mp4.cpp:230
+#: avidemux/ADM_outputs/oplug_mp4/oplug_mp4.cpp:212
 msgid "Cannot initialize the audio stream"
 msgstr "Impossibile inizializzare il flusso audio"
 
@@ -1837,11 +1845,11 @@
 msgid "PSP"
 msgstr "PSP"
 
-#: avidemux/ADM_outputs/oplug_mp4/oplug_mp4.cpp:248
+#: avidemux/ADM_outputs/oplug_mp4/oplug_mp4.cpp:230
 msgid "Invalid audio stream detected"
 msgstr "Rilevato flusso audio non valido"
 
-#: avidemux/ADM_outputs/oplug_mp4/oplug_mp4.cpp:248
+#: avidemux/ADM_outputs/oplug_mp4/oplug_mp4.cpp:230
 msgid ""
 "The audio stream may be invalid for this container.\n"
 "\n"
@@ -2037,7 +2045,7 @@
 msgstr "Seleziona immagine di sfonfo"
 
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_animated.cpp:37
-msgid "_NTSC(default is Pal):"
+msgid "_NTSC (default is PAL):"
 msgstr "N_TSC (predefinito ? Pal):"
 
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_animated.cpp:38
@@ -2056,11 +2064,6 @@
 msgid "Timecode:"
 msgstr "Timecode:"
 
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_animated.cpp:53
-#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_SVCD.cpp:70
-msgid "MPEG-2 Configuration"
-msgstr "Configurazione MPEG-2"
-
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_audioconfig.cpp:56
 msgid "Audio Configuration"
 msgstr "Configurazione audio"
@@ -3147,6 +3150,10 @@
 msgid "_Delay (ms):"
 msgstr "_Ritardo (ms):"
 
+#: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_SVCD.cpp:70
+msgid "MPEG-2 Configuration"
+msgstr "Configurazione MPEG-2"
+
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_tdeint.cpp:45
 #: avidemux/ADM_userInterfaces/ADM_commonUI/DIA_tdeint.cpp:51
 msgid "Auto (might not work)"
@@ -8367,7 +8374,7 @@
 
 #: avidemux/gtk_gui.cpp:1103
 msgid "Something failed when appending"
-msgstr "Qualcosa ? fallito durante l'aggiunta"
+msgstr "Errore durante l'aggiunta"
 
 #: avidemux/gtk_gui.cpp:1114
 #: avidemux/gtk_gui.cpp:1944
@@ -8564,6 +8571,11 @@
 msgid "_External file:"
 msgstr "File _esterno:"
 
+#: avidemux/gtk_gui.cpp:2035
+#, c-format
+msgid "Audio track %d (%s/%d channels/%d kbit per s/%d ms shift)"
+msgstr "Traccia audio %d (%s/%d canali/%d kbit per s/ritardo %d ms)"
+
 #: avidemux/gtk_gui.cpp:2041
 msgid "_Track from video:"
 msgstr "_Traccia dal video:"
@@ -8730,47 +8742,51 @@
 msgid "Cannot decode the frame."
 msgstr "Impossibile decodificare il fotogramma."
 
-#: avidemux/gui_savenew.cpp:89
+#: avidemux/gui_savenew.cpp:88
 msgid "Dual audio can only be used in copy mode"
 msgstr "Il doppio audio pu? essere usato solo in modalit? copia"
 
-#: avidemux/gui_savenew.cpp:89
+#: avidemux/gui_savenew.cpp:88
 msgid "Select Copy as the video codec."
 msgstr "Seleziona Copia come codec video."
 
-#: avidemux/gui_savenew.cpp:209
-#: avidemux/gui_savenew.cpp:225
-#: avidemux/gui_savenew.cpp:238
+#: avidemux/gui_savenew.cpp:208
+#: avidemux/gui_savenew.cpp:224
+#: avidemux/gui_savenew.cpp:237
 msgid "Incompatible output format"
 msgstr "Formato in uscita incompatibile"
 
-#: avidemux/gui_savenew.cpp:259
+#: avidemux/gui_savenew.cpp:258
 msgid "There is no second track"
 msgstr "Non c'? una seconda traccia"
 
-#: avidemux/gui_savenew.cpp:259
+#: avidemux/gui_savenew.cpp:258
 msgid "Select a second audio track in the Audio menu."
 msgstr "Seleziona una seconda traccia nel menu Audio."
 
-#: avidemux/gui_savenew.cpp:263
+#: avidemux/gui_savenew.cpp:262
 msgid "Select dual audio AVI to write"
 msgstr "Seleziona il file AVI con doppio audio da scrivere"
 
-#: avidemux/gui_savenew.cpp:285
-#: avidemux/gui_savenew.cpp:303
+#: avidemux/gui_savenew.cpp:284
+#: avidemux/gui_savenew.cpp:302
 msgid "This cannot have packed VOP"
 msgstr "Non pu? avere VOP compresso"
 
-#: avidemux/gui_savenew.cpp:285
-#: avidemux/gui_savenew.cpp:303
+#: avidemux/gui_savenew.cpp:284
+#: avidemux/gui_savenew.cpp:302
 msgid "It is not MPEG-4 video. File will not be saved."
 msgstr "Non ? un video MPEG-4. Il file non verr? salvato."
 
-#: avidemux/gui_savenew.cpp:349
+#: avidemux/gui_savenew.cpp:348
 msgid ""
 "You may need smart copy.\n"
-" Enable it ?"
+"Enable it?"
 msgstr ""
 "Potresti avere bisogno di una copia intelligente.\n"
-" Attivarla?"
+"Attivarla?"
 
+#: avidemux/gui_savenew.cpp:351
+msgid "_Q factor (set 4):"
+msgstr "Fattore _Q (4 predefinito):"
+



From mean at mail.berlios.de  Fri Feb  6 07:56:10 2009
From: mean at mail.berlios.de (mean at BerliOS)
Date: Fri, 6 Feb 2009 07:56:10 +0100
Subject: [Avidemux-svn-commit] r4574 - in
	branches/avidemux_2.6_branch_mean/avidemux: ADM_editor
	ADM_userInterfaces/ADM_QT4/ADM_gui
Message-ID: <200902060656.n166uAMd016560@sheep.berlios.de>

Author: mean
Date: 2009-02-06 07:56:08 +0100 (Fri, 06 Feb 2009)
New Revision: 4574

Modified:
   branches/avidemux_2.6_branch_mean/avidemux/ADM_editor/ADM_edit.cpp
   branches/avidemux_2.6_branch_mean/avidemux/ADM_editor/ADM_edit.hxx
   branches/avidemux_2.6_branch_mean/avidemux/ADM_editor/ADMedAVIAUD.cpp
   branches/avidemux_2.6_branch_mean/avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/T_preview.cpp
Log:
[Audio] Better handling of holes

Modified: branches/avidemux_2.6_branch_mean/avidemux/ADM_editor/ADM_edit.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/ADM_editor/ADM_edit.cpp	2009-02-05 20:04:06 UTC (rev 4573)
+++ branches/avidemux_2.6_branch_mean/avidemux/ADM_editor/ADM_edit.cpp	2009-02-06 06:56:08 UTC (rev 4574)
@@ -80,8 +80,10 @@
 ADM_Composer::ADM_Composer (void) : ADM_audioStream(NULL,NULL)
 {
 uint32_t type,value;
-   audioBufferStart=0;
-   audioBufferEnd=0;
+
+   packetBufferSize=0;
+   packetBufferDts=ADM_NO_PTS;
+
   _nb_segment = 0;
   _nb_video = 0;
   _total_frames = 0;

Modified: branches/avidemux_2.6_branch_mean/avidemux/ADM_editor/ADM_edit.hxx
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/ADM_editor/ADM_edit.hxx	2009-02-05 20:04:06 UTC (rev 4573)
+++ branches/avidemux_2.6_branch_mean/avidemux/ADM_editor/ADM_edit.hxx	2009-02-06 06:56:08 UTC (rev 4574)
@@ -111,15 +111,15 @@
  	uint32_t  							_audio_start;
 }_SEGMENT;
 /**
-        
+            \class ADM_Composer
 */
 class ADM_Composer : public ADM_audioStream
 {
   private:
                 
-    uint8_t                             audioBuffer[ADM_EDITOR_AUDIO_BUFFER_SIZE];
-    uint32_t                            audioBufferStart;
-    uint32_t                            audioBufferEnd;
+//    uint8_t                             audioBuffer[ADM_EDITOR_AUDIO_BUFFER_SIZE];
+//    uint32_t                            audioBufferStart;
+//    uint32_t                            audioBufferEnd;
 
                     uint8_t dupe(ADMImage *src,ADMImage *dst,_VIDEOS *vid); 
                                                             // Duplicate img, do colorspace
@@ -254,7 +254,15 @@
 					//______________________________
 					//   audioStream
 					//______________________________
+protected:
+#define ADM_EDITOR_PACKET_BUFFER_SIZE (20*1024)
+                        uint8_t  packetBuffer[ADM_EDITOR_PACKET_BUFFER_SIZE];
+                        uint32_t packetBufferSize;
+                        uint64_t packetBufferDts;
+                        uint32_t packetBufferSamples;
+                        bool     refillPacketBuffer(void);
   
+public:
         
 virtual uint8_t         getPacket(uint8_t *buffer,uint32_t *size, uint32_t sizeMax,uint32_t *nbSample,uint64_t *dts);
         uint8_t         getPCMPacket(float  *dest, uint32_t sizeMax, uint32_t *samples,uint64_t *odts);

Modified: branches/avidemux_2.6_branch_mean/avidemux/ADM_editor/ADMedAVIAUD.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/ADM_editor/ADMedAVIAUD.cpp	2009-02-05 20:04:06 UTC (rev 4573)
+++ branches/avidemux_2.6_branch_mean/avidemux/ADM_editor/ADMedAVIAUD.cpp	2009-02-06 06:56:08 UTC (rev 4574)
@@ -53,6 +53,25 @@
 #define MYAUDIO (_videos[0].audioTracks[_videos[0].currentAudioStream])
 
 /**
+    \fn refillPacketBuffer
+    \brief Fetch a new packet
+*/
+bool ADM_Composer::refillPacketBuffer(void)
+{
+   packetBufferSize=0; 
+   ADM_audioStreamTrack *trk=getTrack(0);
+    if(!trk) return false;    
+   if(!trk->stream->getPacket(packetBuffer,&packetBufferSize,ADM_EDITOR_PACKET_BUFFER_SIZE,
+                        &packetBufferSamples,&packetBufferDts))
+    {
+            adm_printf(ADM_PRINT_ERROR,"[Composer::getPCMPacket] Read failed\n");
+            return false;
+    }
+    return true;
+}
+
+
+/**
     \fn     getPCMPacket
     \brief  Get audio packet
 
@@ -60,93 +79,100 @@
 
 uint8_t ADM_Composer::getPCMPacket(float  *dest, uint32_t sizeMax, uint32_t *samples,uint64_t *odts)
 {
-uint32_t nbSamples,fillerSample=0;   // FIXME : Store & fix the DTS error correctly!!!!
-uint64_t dts;
-uint32_t inSize,nbOut;
+uint32_t fillerSample=0;   // FIXME : Store & fix the DTS error correctly!!!!
+uint32_t inSize;
 bool drop=false;
 
+
+again:
     *samples=0;
     ADM_audioStreamTrack *trk=getTrack(0);
-    if(!trk) return 0;    
-
-    // Read a packet from stream 0
-again:
-    drop=false;
-    fillerSample=0;
-    if(!trk->stream->getPacket(audioBuffer,&inSize,ADM_EDITOR_AUDIO_BUFFER_SIZE,&nbSamples,&dts))
+    if(!trk) return false;
+    // Do we already have a packet ?
+    if(!packetBufferSize)
     {
-            adm_printf(ADM_PRINT_ERROR,"[Composer::getPCMPacket] Read failed\n");
-            return 0;
+        if(!refillPacketBuffer())
+        {
+            printf("[Editor] Cannot refill audio\n");
+        }
     }
-    vprintf("[PCMPacket]  Got %d samples, time code %08lu  lastDts=%08lu delta =%08ld\n",nbSamples,dts,lastDts,dts-lastDts);
+    // We do now
+    vprintf("[PCMPacket]  Got %d samples, time code %08lu  lastDts=%08lu delta =%08ld\n",packetBufferSamples,packetBufferDts,lastDts,packetBufferDts-lastDts);
+
+
     // Check if the Dts matches
-    if(lastDts!=ADM_AUDIO_NO_DTS && dts!=ADM_AUDIO_NO_DTS)
+    if(lastDts!=ADM_AUDIO_NO_DTS &&packetBufferDts!=ADM_AUDIO_NO_DTS)
     {
-        if(abs(lastDts-dts)>ADM_ALLOWED_DRIFT_US)
+        if(abs(lastDts-packetBufferDts)>ADM_ALLOWED_DRIFT_US)
         {
-        printf("[Composer::getPCMPacket] drift %d, computed :%lu got %lu\n",(int)(lastDts-dts),lastDts,dts);
-        if(dts<lastDts)
-        {
-            printf("[Composer::getPCMPacket] Dropping packet\n");
-            drop=true;
-        }else 
-        {
-            // Else add filler 
-            // Compute filler size
-            float f=dts-lastDts; // in us
-            f*=wavHeader.frequency;
-            f/=1000000.;
-            // in samples!
-            uint32_t fillerSample=(uint32_t )(f+0.49);
-            uint32_t mx=sizeMax/trk->wavheader.channels;
-            
-            if(mx<fillerSample) fillerSample=mx;
-            // arbitrary cap, max 4kSample in one go
-            // about 100 ms
-            if(fillerSample>4*1024) 
+            printf("[Composer::getPCMPacket] drift %d, computed :%lu got %lu\n",(int)(lastDts-packetBufferDts),lastDts,packetBufferDts);
+            if(packetBufferDts<lastDts)
             {
-                fillerSample=4*1024;
-            }
-            uint32_t start=fillerSample*sizeof(float)*trk->wavheader.channels;
-            memset(dest,0,start);
+                printf("[Composer::getPCMPacket] Dropping packet %"LU" last =%"LU"\n",lastDts/1000,packetBufferDts/1000);
+                drop=true;
+            }else 
+            {
+                // There is a "hole" in audio
+                // Let's add some filler
+                // Compute filler size
+                float f=packetBufferDts-lastDts; // in us
+                f*=wavHeader.frequency;
+                f/=1000000.;
+                // in samples!
+                uint32_t fillerSample=(uint32_t )(f+0.49);
+                uint32_t mx=sizeMax/trk->wavheader.channels;
+                
+                if(mx<fillerSample) fillerSample=mx;
+                // arbitrary cap, max 4kSample in one go
+                // about 100 ms
+                if(fillerSample>4*1024) 
+                {
+                    fillerSample=4*1024;
+                }
+                uint32_t start=fillerSample*sizeof(float)*trk->wavheader.channels;
+                memset(dest,0,start);
 
-            advanceDtsBySample(fillerSample);
-            dest+=fillerSample*trk->wavheader.channels;
-            vprintf("[Composer::getPCMPacket] Adding %u padding samples, dts is now %lu\n",fillerSample,lastDts);
+                advanceDtsBySample(fillerSample);
+                dest+=fillerSample*trk->wavheader.channels;
+                vprintf("[Composer::getPCMPacket] Adding %u padding samples, dts is now %lu\n",fillerSample,lastDts);
+                return true;
        }
       }
-    }else
-    {
-        // If lastDts is not initialized....
-        if(lastDts==ADM_AUDIO_NO_DTS) lastDts=dts;
     }
-    // Call codec...
-    if(!trk->codec->run(audioBuffer, inSize, dest, &nbOut))
+    // If lastDts is not initialized....
+    if(lastDts==ADM_AUDIO_NO_DTS) lastDts=packetBufferDts;
+    
+    //
+    //  The packet is ok, decode it...
+    //
+    uint32_t nbOut=0; // Nb sample as seen by codec
+    if(!trk->codec->run(packetBuffer, packetBufferSize, dest, &nbOut))
     {
+            packetBufferSize=0; // consume
             adm_printf(ADM_PRINT_ERROR,"[Composer::getPCMPacket] codec failed failed\n");
-            return 0;
+            return false;
     }
-    
-    //
-    //
+    packetBufferSize=0; // consume
+
+    // Compute how much decoded sample to compare with what demuxer said
     uint32_t decodedSample=nbOut;
     decodedSample/=trk->wavheader.channels;
-    if(!decodedSample && !fillerSample) goto again;
-#define ADM_MAX_JITTER 5000  // in samples
-    if(abs(nbSamples-decodedSample)>ADM_MAX_JITTER)
+    if(!decodedSample) goto again;
+#define ADM_MAX_JITTER 5000  // in samples, due to clock accuracy, it can be +er, -er, + er, -er etc etc
+    if(abs(decodedSample-packetBufferSamples)>ADM_MAX_JITTER)
     {
-        printf("[Composer::getPCMPacket] Demuxer was wrong %d vs %d samples!\n",nbSamples,decodedSample);
+        printf("[Composer::getPCMPacket] Demuxer was wrong %d vs %d samples!\n",packetBufferSamples,decodedSample);
     }
     
-    // This packet has been dropped, try the next one
-    if(drop==true && !fillerSample) goto again;
+    // This packet has been dropped (too early packt), try the next one
+    if(drop==true) goto again;
     // Update infos
-    *samples=(decodedSample+fillerSample);
+    *samples=(decodedSample);
     *odts=lastDts;
     advanceDtsBySample(decodedSample);
     vprintf("[Composer::getPCMPacket] Adding %u decodedSample, dts is not %lu\n",fillerSample,lastDts);
     ADM_assert(sizeMax>=(fillerSample+decodedSample)*trk->wavheader.channels);
-    return 1;
+    return true;
 }
 /**
         \fn getPacket

Modified: branches/avidemux_2.6_branch_mean/avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/T_preview.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/T_preview.cpp	2009-02-05 20:04:06 UTC (rev 4573)
+++ branches/avidemux_2.6_branch_mean/avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/T_preview.cpp	2009-02-06 06:56:08 UTC (rev 4574)
@@ -49,9 +49,9 @@
 	ADM_assert(frame <= videoStream->getInfo()->nb_frames);
 
 	printf("** DIA_filterPreview %i **\n", frame);
-//	Ui_seekablePreviewWindow previewDialog(videoStream, frame);
+	Ui_seekablePreviewWindow previewDialog(NULL,videoStream, frame);
 
-//	previewDialog.exec();
+	previewDialog.exec();
 }
 
 //****************************************************************************************************



From mean at mail.berlios.de  Fri Feb  6 20:01:12 2009
From: mean at mail.berlios.de (mean at BerliOS)
Date: Fri, 6 Feb 2009 20:01:12 +0100
Subject: [Avidemux-svn-commit] r4575 - tags
Message-ID: <200902061901.n16J1CHf023241@sheep.berlios.de>

Author: mean
Date: 2009-02-06 20:01:12 +0100 (Fri, 06 Feb 2009)
New Revision: 4575

Added:
   tags/avidemux_2.4.4/
Log:


Copied: tags/avidemux_2.4.4 (from rev 4574, branches/avidemux_2.4_branch)



From mean at mail.berlios.de  Fri Feb  6 20:07:37 2009
From: mean at mail.berlios.de (mean at BerliOS)
Date: Fri, 6 Feb 2009 20:07:37 +0100
Subject: [Avidemux-svn-commit] r4576 - tags/avidemux_2.4.4
Message-ID: <200902061907.n16J7bVE023982@sheep.berlios.de>

Author: mean
Date: 2009-02-06 20:07:37 +0100 (Fri, 06 Feb 2009)
New Revision: 4576

Modified:
   tags/avidemux_2.4.4/CMakeLists.txt
   tags/avidemux_2.4.4/ConfigureChecks.cmake
   tags/avidemux_2.4.4/configure.in.in
Log:
[2.4.4] Set version to 2.4.4 and remove svn check

Modified: tags/avidemux_2.4.4/CMakeLists.txt
===================================================================
--- tags/avidemux_2.4.4/CMakeLists.txt	2009-02-06 19:01:12 UTC (rev 4575)
+++ tags/avidemux_2.4.4/CMakeLists.txt	2009-02-06 19:07:37 UTC (rev 4576)
@@ -35,21 +35,7 @@
 #**************************************************
 # Subversion
 #**************************************************
-if(NOT NO_SVN AND NOT CMAKE_BUILD_TYPE STREQUAL "Debug" AND EXISTS "${CMAKE_SOURCE_DIR}/.svn")
-	MESSAGE(STATUS "<Checking for Subversion>")
-	MESSAGE(STATUS "<***********************>")
-	include(FindSubversion)
 
-	FIND_PACKAGE(Subversion)
-	IF(Subversion_FOUND)
-		Subversion_WC_INFO(${PROJECT_SOURCE_DIR} Project)
-		MESSAGE(STATUS "Current revision is ${Project_WC_REVISION}")
-		SET(ADM_SUBVERSION ${Project_WC_REVISION})
-	ELSE(Subversion_FOUND)
-		MESSAGE(STATUS "Could not find Subversion")
-	ENDIF(Subversion_FOUND)
-ENDIF(NOT NO_SVN AND NOT CMAKE_BUILD_TYPE STREQUAL "Debug" AND EXISTS "${CMAKE_SOURCE_DIR}/.svn")
-
 IF(NOT Subversion_FOUND)
 	SET(ADM_SUBVERSION 0)
 ENDIF(NOT Subversion_FOUND)

Modified: tags/avidemux_2.4.4/ConfigureChecks.cmake
===================================================================
--- tags/avidemux_2.4.4/ConfigureChecks.cmake	2009-02-06 19:01:12 UTC (rev 4575)
+++ tags/avidemux_2.4.4/ConfigureChecks.cmake	2009-02-06 19:07:37 UTC (rev 4576)
@@ -130,8 +130,8 @@
 ########################################
 # Standard Avidemux defines
 ########################################
-SET(VERSION 2.4.3)
-SET(PACKAGE_VERSION 2.4.3)
+SET(VERSION 2.4.4)
+SET(PACKAGE_VERSION 2.4.4)
 
 SET(HAVE_BUILTIN_VECTOR 1)
 SET(HAVE_AUDIO 1)

Modified: tags/avidemux_2.4.4/configure.in.in
===================================================================
--- tags/avidemux_2.4.4/configure.in.in	2009-02-06 19:01:12 UTC (rev 4575)
+++ tags/avidemux_2.4.4/configure.in.in	2009-02-06 19:07:37 UTC (rev 4576)
@@ -38,17 +38,9 @@
 dnl Perform program name transformation
 AC_ARG_PROGRAM
 dnl Automake doc recommends to do this only here. (Janos)
-AM_INIT_AUTOMAKE(avidemux,"2.4.3")
+AM_INIT_AUTOMAKE(avidemux,"2.4.4")
 ADM_SUBVERSION="0"
 
-if [[ -f .svn/entries ]]; then
-	AC_PATH_PROG(SVNVERSION, svnversion, no)
-	
-	if test "$SVNVERSION" != "no" ; then
-		rev=`svnversion . | sed 's/^.*://g' | sed 's/M$//g'`
-		ADM_SUBVERSION="\"$rev\""
-	fi
-fi
 
 dnl almost the same like KDE_SET_PEFIX but the path is /usr/local
 unset CDPATH



From mean at mail.berlios.de  Sat Feb  7 15:34:29 2009
From: mean at mail.berlios.de (mean at BerliOS)
Date: Sat, 7 Feb 2009 15:34:29 +0100
Subject: [Avidemux-svn-commit] r4577 - in branches/avidemux_2.6_branch_mean:
	avidemux/ADM_editor plugins/ADM_demuxers/MpegPS
Message-ID: <200902071434.n17EYT6h031006@sheep.berlios.de>

Author: mean
Date: 2009-02-07 15:34:28 +0100 (Sat, 07 Feb 2009)
New Revision: 4577

Modified:
   branches/avidemux_2.6_branch_mean/avidemux/ADM_editor/ADMedAVIAUD.cpp
   branches/avidemux_2.6_branch_mean/plugins/ADM_demuxers/MpegPS/ADM_ps.h
   branches/avidemux_2.6_branch_mean/plugins/ADM_demuxers/MpegPS/ADM_psAudio.cpp
   branches/avidemux_2.6_branch_mean/plugins/ADM_demuxers/MpegPS/dmxPSPacket.cpp
Log:
[PsAudio] Better seek

Modified: branches/avidemux_2.6_branch_mean/avidemux/ADM_editor/ADMedAVIAUD.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/ADM_editor/ADMedAVIAUD.cpp	2009-02-06 19:07:37 UTC (rev 4576)
+++ branches/avidemux_2.6_branch_mean/avidemux/ADM_editor/ADMedAVIAUD.cpp	2009-02-07 14:34:28 UTC (rev 4577)
@@ -165,7 +165,11 @@
     }
     
     // This packet has been dropped (too early packt), try the next one
-    if(drop==true) goto again;
+    if(drop==true)
+    {
+        // TODO Check if the packet somehow overlaps, i.e. starts too early but finish ok
+        goto again;
+    }
     // Update infos
     *samples=(decodedSample);
     *odts=lastDts;

Modified: branches/avidemux_2.6_branch_mean/plugins/ADM_demuxers/MpegPS/ADM_ps.h
===================================================================
--- branches/avidemux_2.6_branch_mean/plugins/ADM_demuxers/MpegPS/ADM_ps.h	2009-02-06 19:07:37 UTC (rev 4576)
+++ branches/avidemux_2.6_branch_mean/plugins/ADM_demuxers/MpegPS/ADM_ps.h	2009-02-07 14:34:28 UTC (rev 4577)
@@ -41,6 +41,7 @@
 }dmxFrame;
 /**
     \struct ADM_psAudioSeekPoint
+    \brief The dts are stored in rescaled us. Warning the low level getpacket is getting absolute 90 khzTick
 */
 typedef struct
 {            

Modified: branches/avidemux_2.6_branch_mean/plugins/ADM_demuxers/MpegPS/ADM_psAudio.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/plugins/ADM_demuxers/MpegPS/ADM_psAudio.cpp	2009-02-06 19:07:37 UTC (rev 4576)
+++ branches/avidemux_2.6_branch_mean/plugins/ADM_demuxers/MpegPS/ADM_psAudio.cpp	2009-02-07 14:34:28 UTC (rev 4577)
@@ -21,6 +21,9 @@
 #include <math.h>
 
 #include "ADM_ps.h"
+
+#define aprintf printf
+
 /**
     \fn ADM_psAccess
 */
@@ -70,27 +73,27 @@
 }
 /**
     \fn goToTime
+    \brief Rememember seekPoint.dts time is already scaled and in us
 */                              
 bool      ADM_psAccess::goToTime(uint64_t timeUs)
 {
     // Convert time in us to scaled 90 kHz tick
-    double f=timeUs;
-    f*=90;
-    f/=1000;
-    f+=dtsOffset;
-    uint64_t n=(uint64_t)f;
-
-    if(n<=seekPoints[seekPoints.size()-1].dts)
+    
+    if(timeUs<seekPoints[0].dts)
     {
+            aprintf("[PsAudio] Requested %"LU" tick before 1st seek point at :%"LU"\n",(uint32_t)timeUs/1000,(uint32_t)seekPoints[0].dts/1000);
             demuxer.setPos(seekPoints[0].position);
             return true;
     }
 
-    for(int i=0;i<seekPoints.size()-1;i++)
+    for(int i=1;i<seekPoints.size();i++)
     {
-        if(seekPoints[i].dts >=n && seekPoints[i+1].dts>n)
+        if(seekPoints[i].dts >=timeUs )
         {
-            demuxer.setPos(seekPoints[i].position);
+            aprintf("[PsAudio] Requested %"LU" tick seeking to  at :%"LU" us (next is %"LU"ms \n",(uint32_t)timeUs/1000,
+                    (uint32_t)seekPoints[i-1].dts/1000,
+                    (uint32_t)seekPoints[i].dts/1000);
+            demuxer.setPos(seekPoints[i-1].position);
             return true;
         }
     }
@@ -119,6 +122,11 @@
     if(d==ADM_NO_PTS) *dts=p;
             else *dts=d;
     *dts=timeConvert(*dts);
+    if(*dts!=ADM_NO_PTS) 
+    {
+        aprintf("[psAudio] getPacket dts = %"LU" ms\n",(uint32_t)*dts/1000);
+    }
+
     return true;
 }
 

Modified: branches/avidemux_2.6_branch_mean/plugins/ADM_demuxers/MpegPS/dmxPSPacket.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/plugins/ADM_demuxers/MpegPS/dmxPSPacket.cpp	2009-02-06 19:07:37 UTC (rev 4576)
+++ branches/avidemux_2.6_branch_mean/plugins/ADM_demuxers/MpegPS/dmxPSPacket.cpp	2009-02-07 14:34:28 UTC (rev 4577)
@@ -81,7 +81,11 @@
 
 bool    psPacket::setPos(uint64_t pos)
 {
-    return true;
+    if(!_file->setpos(pos))
+    {
+        printf("[psPacket] Cannot seek to %"LLX"\n", pos);
+        return false;
+    }
 }
 
 /**



From mean at mail.berlios.de  Sat Feb  7 15:34:30 2009
From: mean at mail.berlios.de (mean at BerliOS)
Date: Sat, 7 Feb 2009 15:34:30 +0100
Subject: [Avidemux-svn-commit] r4578 -
	branches/avidemux_2.6_branch_mean/plugins/ADM_demuxers/MpegPS
Message-ID: <200902071434.n17EYUQT031016@sheep.berlios.de>

Author: mean
Date: 2009-02-07 15:34:30 +0100 (Sat, 07 Feb 2009)
New Revision: 4578

Modified:
   branches/avidemux_2.6_branch_mean/plugins/ADM_demuxers/MpegPS/ADM_psAudio.cpp
Log:
[PsAudio] Silence output

Modified: branches/avidemux_2.6_branch_mean/plugins/ADM_demuxers/MpegPS/ADM_psAudio.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/plugins/ADM_demuxers/MpegPS/ADM_psAudio.cpp	2009-02-07 14:34:28 UTC (rev 4577)
+++ branches/avidemux_2.6_branch_mean/plugins/ADM_demuxers/MpegPS/ADM_psAudio.cpp	2009-02-07 14:34:30 UTC (rev 4578)
@@ -22,7 +22,11 @@
 
 #include "ADM_ps.h"
 
-#define aprintf printf
+#if 0
+    #define aprintf printf
+#else
+    #define aprintf(...) {}
+#endif
 
 /**
     \fn ADM_psAccess



From gruntster at mail.berlios.de  Sun Feb  8 18:05:10 2009
From: gruntster at mail.berlios.de (gruntster at mail.berlios.de)
Date: Sun, 8 Feb 2009 18:05:10 +0100
Subject: [Avidemux-svn-commit] r4579 - in
	branches/avidemux_2.5_branch_gruntster: . platforms
	platforms/mac platforms/mac/External_libs
	platforms/mac/External_libs/scripts
	platforms/mac/External_libs/scripts/patches platforms/windows
	platforms/windows/build_scripts
	platforms/windows/build_scripts/avidemux_2.4
	platforms/windows/build_scripts/avidemux_2.4/Tools
	platforms/windows/installer
Message-ID: <200902081705.n18H5AZM026667@sheep.berlios.de>

Author: gruntster
Date: 2009-02-08 18:04:43 +0100 (Sun, 08 Feb 2009)
New Revision: 4579

Added:
   branches/avidemux_2.5_branch_gruntster/platforms/
   branches/avidemux_2.5_branch_gruntster/platforms/Readme.txt
   branches/avidemux_2.5_branch_gruntster/platforms/freebsd/
   branches/avidemux_2.5_branch_gruntster/platforms/mac/
   branches/avidemux_2.5_branch_gruntster/platforms/mac/External_libs/
   branches/avidemux_2.5_branch_gruntster/platforms/mac/External_libs/readme.txt
   branches/avidemux_2.5_branch_gruntster/platforms/mac/External_libs/scripts/
   branches/avidemux_2.5_branch_gruntster/platforms/mac/External_libs/scripts/0005-pkgconfig.sh
   branches/avidemux_2.5_branch_gruntster/platforms/mac/External_libs/scripts/0010-libexpat.sh
   branches/avidemux_2.5_branch_gruntster/platforms/mac/External_libs/scripts/0016-ncursesw.sh
   branches/avidemux_2.5_branch_gruntster/platforms/mac/External_libs/scripts/0017-ncurses.sh
   branches/avidemux_2.5_branch_gruntster/platforms/mac/External_libs/scripts/0020-gettext.sh
   branches/avidemux_2.5_branch_gruntster/platforms/mac/External_libs/scripts/0025-freetype.sh
   branches/avidemux_2.5_branch_gruntster/platforms/mac/External_libs/scripts/0030-fontconfig.sh
   branches/avidemux_2.5_branch_gruntster/platforms/mac/External_libs/scripts/0120-libjpeg.sh
   branches/avidemux_2.5_branch_gruntster/platforms/mac/External_libs/scripts/0130-libtiff.sh
   branches/avidemux_2.5_branch_gruntster/platforms/mac/External_libs/scripts/0140-libpng.sh
   branches/avidemux_2.5_branch_gruntster/platforms/mac/External_libs/scripts/0150-libxml.sh
   branches/avidemux_2.5_branch_gruntster/platforms/mac/External_libs/scripts/0200-pixman.sh
   branches/avidemux_2.5_branch_gruntster/platforms/mac/External_libs/scripts/0201-libcairo-quartz.sh
   branches/avidemux_2.5_branch_gruntster/platforms/mac/External_libs/scripts/0205-libglib.sh
   branches/avidemux_2.5_branch_gruntster/platforms/mac/External_libs/scripts/0210-libatk.sh
   branches/avidemux_2.5_branch_gruntster/platforms/mac/External_libs/scripts/0214-patch-pango.sh
   branches/avidemux_2.5_branch_gruntster/platforms/mac/External_libs/scripts/0215-libpango-quartz.sh
   branches/avidemux_2.5_branch_gruntster/platforms/mac/External_libs/scripts/0220-libgtk-quartz.sh
   branches/avidemux_2.5_branch_gruntster/platforms/mac/External_libs/scripts/0300-lame.sh
   branches/avidemux_2.5_branch_gruntster/platforms/mac/External_libs/scripts/0310-xvid.sh
   branches/avidemux_2.5_branch_gruntster/platforms/mac/External_libs/scripts/0320-x264.sh
   branches/avidemux_2.5_branch_gruntster/platforms/mac/External_libs/scripts/0330-patch-libaften.sh
   branches/avidemux_2.5_branch_gruntster/platforms/mac/External_libs/scripts/0331-libaften.sh
   branches/avidemux_2.5_branch_gruntster/platforms/mac/External_libs/scripts/SetEnv-universal.txt
   branches/avidemux_2.5_branch_gruntster/platforms/mac/External_libs/scripts/patches/
   branches/avidemux_2.5_branch_gruntster/platforms/mac/External_libs/scripts/patches/aften-0.0.8.patch
   branches/avidemux_2.5_branch_gruntster/platforms/mac/External_libs/scripts/patches/pango-patch-ltmain.sh.diff
   branches/avidemux_2.5_branch_gruntster/platforms/windows/
   branches/avidemux_2.5_branch_gruntster/platforms/windows/build_scripts/
   branches/avidemux_2.5_branch_gruntster/platforms/windows/build_scripts/Set Common Environment Variables.bat
   branches/avidemux_2.5_branch_gruntster/platforms/windows/build_scripts/avidemux_2.4/
   branches/avidemux_2.5_branch_gruntster/platforms/windows/build_scripts/avidemux_2.4/1. Perform Build.bat
   branches/avidemux_2.5_branch_gruntster/platforms/windows/build_scripts/avidemux_2.4/1b. Continue Build.bat
   branches/avidemux_2.5_branch_gruntster/platforms/windows/build_scripts/avidemux_2.4/2. Create Packages.bat
   branches/avidemux_2.5_branch_gruntster/platforms/windows/build_scripts/avidemux_2.4/2a. Update Notes.bat
   branches/avidemux_2.5_branch_gruntster/platforms/windows/build_scripts/avidemux_2.4/2b. Package Build.bat
   branches/avidemux_2.5_branch_gruntster/platforms/windows/build_scripts/avidemux_2.4/Package Notes.xml
   branches/avidemux_2.5_branch_gruntster/platforms/windows/build_scripts/avidemux_2.4/Set Avidemux 2.4 Environment Variables.bat
   branches/avidemux_2.5_branch_gruntster/platforms/windows/build_scripts/avidemux_2.4/Tools/
   branches/avidemux_2.5_branch_gruntster/platforms/windows/build_scripts/avidemux_2.4/Tools/Get Revision Number.bat
   branches/avidemux_2.5_branch_gruntster/platforms/windows/build_scripts/avidemux_2.4/Tools/Revision No template.bat
   branches/avidemux_2.5_branch_gruntster/platforms/windows/build_scripts/avidemux_2.4/Tools/gennotes.sh
   branches/avidemux_2.5_branch_gruntster/platforms/windows/build_scripts/avidemux_2.4/Tools/gentouch.sh
   branches/avidemux_2.5_branch_gruntster/platforms/windows/build_scripts/avidemux_2.4/Tools/package_notes.xslt
   branches/avidemux_2.5_branch_gruntster/platforms/windows/build_scripts/avidemux_2.4/Tools/touch_files.xslt
   branches/avidemux_2.5_branch_gruntster/platforms/windows/installer/
   branches/avidemux_2.5_branch_gruntster/platforms/windows/installer/InstallOptions.ini
   branches/avidemux_2.5_branch_gruntster/platforms/windows/installer/License.rtf
   branches/avidemux_2.5_branch_gruntster/platforms/windows/installer/PageHeader.bmp
   branches/avidemux_2.5_branch_gruntster/platforms/windows/installer/WelcomeFinishStrip.bmp
   branches/avidemux_2.5_branch_gruntster/platforms/windows/installer/avidemux.nsi
   branches/avidemux_2.5_branch_gruntster/platforms/windows/installer/genlog.sh
   branches/avidemux_2.5_branch_gruntster/platforms/windows/installer/revision.xslt
   branches/avidemux_2.5_branch_gruntster/platforms/windows/installer/svnlog.xslt
Log:
[Merge] merge platform build scripts from 2.4 branch

Added: branches/avidemux_2.5_branch_gruntster/platforms/Readme.txt
===================================================================
--- branches/avidemux_2.5_branch_gruntster/platforms/Readme.txt	2009-02-07 14:34:30 UTC (rev 4578)
+++ branches/avidemux_2.5_branch_gruntster/platforms/Readme.txt	2009-02-08 17:04:43 UTC (rev 4579)
@@ -0,0 +1,6 @@
+This platforms directory inside the Avidemux tree will contain utilities,
+build scripts, build projects, small howto's and other considered 
+usefull "things" for the several platforms and OSes avidemux can be
+build on.
+
+ 

Added: branches/avidemux_2.5_branch_gruntster/platforms/mac/External_libs/readme.txt
===================================================================
--- branches/avidemux_2.5_branch_gruntster/platforms/mac/External_libs/readme.txt	2009-02-07 14:34:30 UTC (rev 4578)
+++ branches/avidemux_2.5_branch_gruntster/platforms/mac/External_libs/readme.txt	2009-02-08 17:04:43 UTC (rev 4579)
@@ -0,0 +1,120 @@
+External Libraries
+(This is for 10.4 or above)
+
+**************************************************************************
+* 22 July 2008, Harry van der wolf
+* This is very much a "work in progress" thing and far from stable.
+* It can be considered in pre-alpha stage.
+* Scripts up to and including 0215 "should" work
+* Some 300 scripts should work too (xvid), others "are in the make"
+**************************************************************************
+
+
+
+CREDITS
+This way of building libraries for OSX has been developed (AFAIK) by Ippei Ukai for the
+Open Source project Hugin. I simply copied the way of working and developed and created
+the scripts necessary for Avidemux (unfortunately only a few libraries are the same) 
+
+INTRODUCTION
+The scripts in the scripts directory can be used to build the necessary libraries for Avidemux.
+This part describes where we want to place the development tree for our "External Libraries" that 
+Avidemux depends on. Although the "External Libraries" directory "External_libs" structure is 
+placed inside the Avidemux SVN tree by default, this does not necessarily need to be the place 
+where you really want to build your libraries. Even more, it's better to place your build tree
+somewhere else. 
+
+So the first question then is: where do you want to have your development tree? As you (might) know,
+the "normal" location is /usr/local. MacPorts uses /opt/local by default and Fink uses /sw. 
+We do not want to use these locations!
+
+Apart from the fact that it is a bad idea to mix up development trees, another drawback is that 
+these directories are not in "user space", therefore always requiring a root authorization, 
+e.g. "sudo make install" as a last step. When keeping the development tree in user space 
+(e.g. /Users/<your_username>/development/ or /Users/Shared/development/), you don't need to "sudo". 
+Note that the latter option also creates a development directory in user space but keeps it away from 
+your "normal" user data.
+
+So, from this moment "we" have decided to build our development tree in user space.
+
+Note: As mentioned before: If you position your development tree outside user space, you need to 
+run everything as root user. The scripts are not tailored towards that "sudo" kind of use 
+and need modification to work that way. 
+
+PREPARATIONS
+It is best to create your development tree next to your avidemux tree. So if you have your
+Avidemux SVN tree in /Users/<username>/development/avidemux_2.4_branch, you make your
+"External_libs" tree in /Users/<username>/development/External_libs.
+This has a couple of advantages:
+- If you screw up your avidemux tree, you can simply throw it away without worrying about
+your built libraries.
+- If the name of the avidemux branch might change due to new developments or versions, you can still
+continue to use your own libraries tree and leave it where it is.
+- If you also built on other projects and want to use this same approach you can use this libraries
+tree next to your avidemux_2.4_branch, <project 2>, <project 3>, etc .. source trees (like /usr/local,
+/opt/local (MacPorts) or /sw (Fink) also contain all "non system" libraries on your system). 
+
+We first create our development tree next to our avidemux tree (assuming we are in 
+/Users/<username>/development where also our avidemux tree resides) and inside it a repository directory
+four our binaries/libraries.
+$ mkdir External_libs External_libs/repository
+
+Now you can create a scripts directory inside your External_libs directory or create a symbolic
+link (recommended) to the scripts directory in your avidemux tree, thereby automatically synchronizing
+scripts in that tree via SVN. I create a symbolic link.
+$ ln -s /Users/<username>/development/avidemux_2.4_branch/platforms/mac/External_libs/scripts /Users/<username>/development/External_libs/scripts
+
+
+WARNING
+The configure scripts of the libraries you want to compile, also check for libraries and headers
+inside /usr/local, /opt/local (Maccports) and /sw (Fink).
+This means that we need to get them "out of the way" as we do not want the libraries to link to 
+these headers and libraries, but only to the headers and libraries inside out External_libs build tree.
+So, before starting to build, you need to disable them by renaming them (not entirely without risk).
+$ sudo mv /usr/local /usr/local.org   (Linux way of building)
+$ sudo mv /opt/local /opt/local.org   (MacPorts)
+$ sudo mc /sw /sw.org                 (Fink)
+
+Note: You can off course give them any name you like.
+Note 2: Do not a "sudo mv /usr /usr.org" as your system won't function anymore 
+
+
+HOWTO:
+0. Modify your External_libs/scripts/SetEnv-universal.txt. The path in the myREPOSITORYDIR variable 
+needs to match exactly the path you use. So, if you are Spiderman and you build inside your HOME 
+directory you need to specify:
+myREPOSITORYDIR="/Users/Spiderman/development/External_libs/repository";
+
+1. Download the sources. The top of the script will show you a "download location" where you can find the source.
+You typically want to place it in the "External_libs" folder.
+2. Check your External_libs/scripts/SetEnv-universal.txt file, especially the myREPOSITORYDIR variable.
+3. Open a Terminal window (bash is preferred).
+5. 'cd' into the directory of source you want to compile. (eg. 'cd External_libs/jpeg-6b')
+4. Set the variables for the compilation. (eg. 'source ../scripts/SetEnv-universal.txt')
+6. Using the appropriate shell script, build the source. (eg. 'sh ../scripts/0120-libjpeg.sh')
+
+
+RESULT:
+The programs and libraries will be installed into $myREPOSITORYDIR, which you can manage independently 
+from the systems you are currently using (e.g /usr, /usr/local, /opt, /sw).
+
+
+TIPS:
+When compiling programs from source you need to specify the above directory as prefix. You probably have to 
+specify the correct SDK (-isysroot) and MacOS target version (-mmacosx-version-min) as well.
+You can make multiple 'repositories' as well. For example, you can make one for statically and 
+one for dynamically linked product, or ones with different target architecture/OS versions. 
+
+
+LIBRARIES:
+The library scripts are all numbered and should be executed in the order they are numbered for the
+scripts below 300.
+The scripts above 300 build the plugins for Avidemux. They are not neccessary but will expand the
+possible codecs you can use. Note that most scripts have gaps between numbers. There are also a couple
+of patch scripts. They should be run (once) before building the libraries.
+
+
+LICENSE:
+The scripts for compiling universal builds are originally copyrighted by Ippei Ukai (2007-2008), and distributed under the modified BSD license.
+
+

Added: branches/avidemux_2.5_branch_gruntster/platforms/mac/External_libs/scripts/0005-pkgconfig.sh
===================================================================
--- branches/avidemux_2.5_branch_gruntster/platforms/mac/External_libs/scripts/0005-pkgconfig.sh	2009-02-07 14:34:30 UTC (rev 4578)
+++ branches/avidemux_2.5_branch_gruntster/platforms/mac/External_libs/scripts/0005-pkgconfig.sh	2009-02-08 17:04:43 UTC (rev 4579)
@@ -0,0 +1,121 @@
+# ------------------
+#    pkgconfig 
+# ------------------
+# $Id: $
+# Copyright (c) 2008, Ippei Ukai
+# Modified for pkgconfig by Harry van der Wolf, 2008 06 14
+
+# download location http://pkgconfig.freedesktop.org/releases/
+
+# prepare
+
+# export REPOSITORYDIR="/PATH2HUGIN/mac/ExternalPrograms/repository" \
+# ARCHS="ppc i386" \
+#  ppcTARGET="powerpc-apple-darwin8" \
+#  i386TARGET="i386-apple-darwin8" \
+#  ppcMACSDKDIR="/Developer/SDKs/MacOSX10.4u.sdk" \
+#  i386MACSDKDIR="/Developer/SDKs/MacOSX10.4u.sdk" \
+#  ppcONLYARG="-mcpu=G3 -mtune=G4" \
+#  i386ONLYARG="-mfpmath=sse -msse2 -mtune=pentium-m -ftree-vectorize" \
+#  OTHERARGs="";
+
+
+# init
+
+let NUMARCH="0"
+
+for i in $ARCHS
+do
+  NUMARCH=$(($NUMARCH + 1))
+done
+
+mkdir -p "$REPOSITORYDIR/bin";
+mkdir -p "$REPOSITORYDIR/lib";
+mkdir -p "$REPOSITORYDIR/include";
+
+MAIN_LIB_VER="0"
+FULL_LIB_VER="$MAIN_LIB_VER.23"
+
+
+# compile
+
+for ARCH in $ARCHS
+do
+
+ mkdir -p "$REPOSITORYDIR/arch/$ARCH/bin";
+ mkdir -p "$REPOSITORYDIR/arch/$ARCH/lib";
+ mkdir -p "$REPOSITORYDIR/arch/$ARCH/include";
+
+ ARCHARGs=""
+ MACSDKDIR=""
+
+ if [ $ARCH = "i386" -o $ARCH = "i686" ]
+ then
+  TARGET=$i386TARGET
+  MACSDKDIR=$i386MACSDKDIR
+  ARCHARGs="$i386ONLYARG"
+ elif [ $ARCH = "ppc" -o $ARCH = "ppc750" -o $ARCH = "ppc7400" ]
+ then
+  TARGET=$ppcTARGET
+  MACSDKDIR=$ppcMACSDKDIR
+  ARCHARGs="$ppcONLYARG"
+ elif [ $ARCH = "ppc64" -o $ARCH = "ppc970" ]
+ then
+  TARGET=$ppc64TARGET
+  MACSDKDIR=$ppc64MACSDKDIR
+  ARCHARGs="$ppc64ONLYARG"
+ elif [ $ARCH = "x86_64" ]
+ then
+  TARGET=$x64TARGET
+  MACSDKDIR=$x64MACSDKDIR
+  ARCHARGs="$x64ONLYARG"
+ fi
+
+ # first patch the make file
+
+
+ env CFLAGS="-isysroot $MACSDKDIR -arch $ARCH $ARCHARGs $OTHERARGs -O2 -dead_strip" \
+  CXXFLAGS="-isysroot $MACSDKDIR -arch $ARCH $ARCHARGs $OTHERARGs -O2 -dead_strip" \
+  CPPFLAGS="-I$REPOSITORYDIR/include -no-cpp-precomp" \
+  LDFLAGS="-L$REPOSITORYDIR/lib -dead_strip" \
+  NEXT_ROOT="$MACSDKDIR" \
+  ./configure --prefix="$REPOSITORYDIR" \
+  --host="$TARGET" --target="$TARGET" CC="gcc -arch $ARCH" --exec-prefix=$REPOSITORYDIR/arch/$ARCH \
+  --enable-shared \
+;
+
+
+ make clean;
+ make;
+ make install;
+
+done
+
+
+# merge execs
+
+for program in bin/pkg-config
+do
+
+ if [ $NUMARCH -eq 1 ]
+ then
+  mv "$REPOSITORYDIR/arch/$ARCHS/$program" "$REPOSITORYDIR/$program";
+  strip "$REPOSITORYDIR/$program";
+  continue
+ fi
+
+ LIPOARGs=""
+
+ for ARCH in $ARCHS
+ do
+  LIPOARGs="$LIPOARGs $REPOSITORYDIR/arch/$ARCH/$program"
+ done
+
+ lipo $LIPOARGs -create -output "$REPOSITORYDIR/$program";
+
+ strip "$REPOSITORYDIR/$program";
+
+done
+
+# create pkgconfig directory
+ mkdir -p "$REPOSITORYDIR/lib/pkgconfig";

Added: branches/avidemux_2.5_branch_gruntster/platforms/mac/External_libs/scripts/0010-libexpat.sh
===================================================================
--- branches/avidemux_2.5_branch_gruntster/platforms/mac/External_libs/scripts/0010-libexpat.sh	2009-02-07 14:34:30 UTC (rev 4578)
+++ branches/avidemux_2.5_branch_gruntster/platforms/mac/External_libs/scripts/0010-libexpat.sh	2009-02-08 17:04:43 UTC (rev 4579)
@@ -0,0 +1,121 @@
+# ------------------
+#     libexpat
+# ------------------
+# Based on the works of (c) 2007, Ippei Ukai
+# Modified for avidemux by Harry van der Wolf 200806
+
+# download location http://sourceforge.net/projects/expat/
+
+# prepare
+
+# export REPOSITORYDIR="/PATH2HUGIN/mac/ExternalPrograms/repository" \
+# ARCHS="ppc i386" \
+#  ppcTARGET="powerpc-apple-darwin8" \
+#  i386TARGET="i386-apple-darwin8" \
+#  ppcMACSDKDIR="/Developer/SDKs/MacOSX10.4u.sdk" \
+#  i386MACSDKDIR="/Developer/SDKs/MacOSX10.4u.sdk" \
+#  ppcONLYARG="-mcpu=G3 -mtune=G4" \
+#  i386ONLYARG="-mfpmath=sse -msse2 -mtune=pentium-m -ftree-vectorize" \
+#  OTHERARGs="";
+
+
+# init
+
+let NUMARCH="0"
+
+for i in $ARCHS
+do
+  NUMARCH=$(($NUMARCH + 1))
+done
+
+mkdir -p "$REPOSITORYDIR/bin";
+mkdir -p "$REPOSITORYDIR/lib";
+mkdir -p "$REPOSITORYDIR/include";
+
+EXPATVER_M="1"
+EXPATVER_FULL="$EXPATVER_M.5.2"
+
+OTHERMAKEARGs=""
+
+# compile
+
+for ARCH in $ARCHS
+do
+
+ mkdir -p "$REPOSITORYDIR/arch/$ARCH/bin";
+ mkdir -p "$REPOSITORYDIR/arch/$ARCH/lib";
+ mkdir -p "$REPOSITORYDIR/arch/$ARCH/include";
+
+ ARCHARGs=""
+ MACSDKDIR=""
+
+ if [ $ARCH = "i386" -o $ARCH = "i686" ]
+ then
+  TARGET=$i386TARGET
+  MACSDKDIR=$i386MACSDKDIR
+  ARCHARGs="$i386ONLYARG"
+ elif [ $ARCH = "ppc" -o $ARCH = "ppc750" -o $ARCH = "ppc7400" ]
+ then
+  TARGET=$ppcTARGET
+  MACSDKDIR=$ppcMACSDKDIR
+  ARCHARGs="$ppcONLYARG"
+ elif [ $ARCH = "ppc64" -o $ARCH = "ppc970" ]
+ then
+  TARGET=$ppc64TARGET
+  MACSDKDIR=$ppc64MACSDKDIR
+  ARCHARGs="$ppc64ONLYARG"
+ elif [ $ARCH = "x86_64" ]
+ then
+  TARGET=$x64TARGET
+  MACSDKDIR=$x64MACSDKDIR
+  ARCHARGs="$x64ONLYARG"
+ fi
+
+ export PATH=/usr/bin:$PATH
+ env CFLAGS="-isysroot $MACSDKDIR -arch $ARCH $ARCHARGs $OTHERARGs -O2 -dead_strip" \
+  CXXFLAGS="-isysroot $MACSDKDIR -arch $ARCH $ARCHARGs $OTHERARGs -O2 -dead_strip" \
+  CPPFLAGS="-I$REPOSITORYDIR/include" \
+  LDFLAGS="-L$REPOSITORYDIR/lib -dead_strip -prebind" \
+  NEXT_ROOT="$MACSDKDIR" \
+  ./configure --prefix="$REPOSITORYDIR" --disable-dependency-tracking \
+  --host="$TARGET" --exec-prefix=$REPOSITORYDIR/arch/$ARCH \
+  --enable-shared;
+
+ make clean;
+ #make
+ make $OTHERMAKEARGs buildlib;
+ make installlib;
+
+done
+
+
+# merge libexpat
+
+for liba in lib/libexpat.a lib/libexpat.$EXPATVER_FULL.dylib
+do
+
+ if [ $NUMARCH -eq 1 ]
+ then
+  mv "$REPOSITORYDIR/arch/$ARCHS/$liba" "$REPOSITORYDIR/$liba";
+  ranlib "$REPOSITORYDIR/$liba";
+  continue
+ fi
+
+ LIPOARGs=""
+ 
+ for ARCH in $ARCHS
+ do
+  LIPOARGs="$LIPOARGs $REPOSITORYDIR/arch/$ARCH/$liba"
+ done
+
+ lipo $LIPOARGs -create -output "$REPOSITORYDIR/$liba";
+ ranlib "$REPOSITORYDIR/$liba";
+
+done
+
+if [ -f "$REPOSITORYDIR/lib/libexpat.$EXPATVER_FULL.dylib" ]
+then
+ install_name_tool -id "$REPOSITORYDIR/lib/libexpat.$EXPATVER_FULL.dylib" "$REPOSITORYDIR/lib/libexpat.$EXPATVER_FULL.dylib"
+ ln -sfn libexpat.$EXPATVER_FULL.dylib $REPOSITORYDIR/lib/libexpat.$EXPATVER_M.dylib;
+ ln -sfn libexpat.$EXPATVER_FULL.dylib $REPOSITORYDIR/lib/libexpat.dylib;
+fi

Added: branches/avidemux_2.5_branch_gruntster/platforms/mac/External_libs/scripts/0016-ncursesw.sh
===================================================================
--- branches/avidemux_2.5_branch_gruntster/platforms/mac/External_libs/scripts/0016-ncursesw.sh	2009-02-07 14:34:30 UTC (rev 4578)
+++ branches/avidemux_2.5_branch_gruntster/platforms/mac/External_libs/scripts/0016-ncursesw.sh	2009-02-08 17:04:43 UTC (rev 4579)
@@ -0,0 +1,159 @@
+# ------------------
+#    nucrsesw.
+# ------------------
+# Based on the works of (c) 2007, Ippei Ukai
+# Modified for avidemux by Harry van der Wolf 200806
+
+# download location ftp://ftp.gnu.org/gnu/ncurses
+
+# nucrsesw. and nucrsesw.are both run from the same nucrsesw.tar.gz and
+# from the same directory. 
+# The nucrsesw. script needs to be run before the nucrsesw.script 
+# and comes with one extra compile setting --enable-widec 
+
+
+# prepare
+
+# export REPOSITORYDIR="/PATH2HUGIN/mac/ExternalPrograms/repository" \
+# ARCHS="ppc i386" \
+#  ppcTARGET="powerpc-apple-darwin8" \
+#  i386TARGET="i386-apple-darwin8" \
+#  ppcMACSDKDIR="/Developer/SDKs/MacOSX10.4u.sdk" \
+#  i386MACSDKDIR="/Developer/SDKs/MacOSX10.4u.sdk" \
+#  ppcONLYARG="-mcpu=G3 -mtune=G4" \
+#  i386ONLYARG="-mfpmath=sse -msse2 -mtune=pentium-m -ftree-vectorize" \
+#  OTHERARGs="";
+
+
+# init
+
+let NUMARCH="0"
+
+for i in $ARCHS
+do
+  NUMARCH=$(($NUMARCH + 1))
+done
+
+mkdir -p "$REPOSITORYDIR/bin";
+mkdir -p "$REPOSITORYDIR/lib";
+mkdir -p "$REPOSITORYDIR/include";
+
+MAIN_LIB_VER="5"
+#FULL_LIB_VER="$MAIN_LIB_VER.6"
+
+
+# compile
+
+for ARCH in $ARCHS
+do
+
+ mkdir -p "$REPOSITORYDIR/arch/$ARCH/bin";
+ mkdir -p "$REPOSITORYDIR/arch/$ARCH/lib";
+ mkdir -p "$REPOSITORYDIR/arch/$ARCH/include";
+
+ ARCHARGs=""
+ MACSDKDIR=""
+
+ if [ $ARCH = "i386" -o $ARCH = "i686" ]
+ then
+  TARGET=$i386TARGET
+  MACSDKDIR=$i386MACSDKDIR
+  ARCHARGs="$i386ONLYARG"
+ elif [ $ARCH = "ppc" -o $ARCH = "ppc750" -o $ARCH = "ppc7400" ]
+ then
+  TARGET=$ppcTARGET
+  MACSDKDIR=$ppcMACSDKDIR
+  ARCHARGs="$ppcONLYARG"
+ elif [ $ARCH = "ppc64" -o $ARCH = "ppc970" ]
+ then
+  TARGET=$ppc64TARGET
+  MACSDKDIR=$ppc64MACSDKDIR
+  ARCHARGs="$ppc64ONLYARG"
+ elif [ $ARCH = "x86_64" ]
+ then
+  TARGET=$x64TARGET
+  MACSDKDIR=$x64MACSDKDIR
+  ARCHARGs="$x64ONLYARG"
+ fi
+
+
+ #patch first
+ #patch -p0 < patch-configure 
+
+ export PATH=/usr/bin:$PATH
+
+ env CFLAGS="-isysroot $MACSDKDIR -arch $ARCH $ARCHARGs $OTHERARGs -O2 -dead_strip" \
+  CXXFLAGS="-isysroot $MACSDKDIR -arch $ARCH $ARCHARGs $OTHERARGs -O2 -dead_strip" \
+  CPPFLAGS="-I$REPOSITORYDIR/include -I/usr/include -no-cpp-precomp" \
+  LDFLAGS="-L$REPOSITORYDIR/lib -L/usr/lib -dead_strip -prebind" \
+  NEXT_ROOT="$MACSDKDIR" \
+  ./configure --prefix="$REPOSITORYDIR" --disable-dependency-tracking \
+  --host="$TARGET" --exec-prefix=$REPOSITORYDIR/arch/$ARCH \
+  --enable-widec --with-shared --disable-rpath --without-progs \
+  --without-debug --without-ada \
+  --enable-safe-sprintf --enable-sigwinch \
+;
+
+ make clean;
+ make;
+ make install;
+
+done
+
+
+# merge libs
+
+for liba in lib/libnucrsesw.a lib/libncurses++w.a lib/libnucrsesw.$MAIN_LIB_VER.dylib lib/libpanelw.a lib/libpanelw.$MAIN_LIB_VER.dylib lib/libmenuw.a lib/libmenuw.$MAIN_LIB_VER.dylib lib/libformw.a lib/libformw.$MAIN_LIB_VER.dylib
+do
+
+ if [ $NUMARCH -eq 1 ]
+ then
+  mv "$REPOSITORYDIR/arch/$ARCHS/$liba" "$REPOSITORYDIR/$liba";
+  ranlib "$REPOSITORYDIR/$liba";
+  continue
+ fi
+
+ LIPOARGs=""
+ 
+ for ARCH in $ARCHS
+ do
+  LIPOARGs="$LIPOARGs $REPOSITORYDIR/arch/$ARCH/$liba"
+ done
+
+ lipo $LIPOARGs -create -output "$REPOSITORYDIR/$liba";
+ ranlib "$REPOSITORYDIR/$liba";
+
+done
+
+if [ -f "$REPOSITORYDIR/lib/libnucrsesw.$MAIN_LIB_VER.dylib" ]
+then
+ install_name_tool -id "$REPOSITORYDIR/lib/libnucrsesw.$MAIN_LIB_VER.dylib" "$REPOSITORYDIR/lib/libnucrsesw.$MAIN_LIB_VER.dylib"
+ ln -sfn libnucrsesw.$MAIN_LIB_VER.dylib $REPOSITORYDIR/lib/libnucrsesw.dylib;
+fi
+
+if [ -f "$REPOSITORYDIR/lib/libpanelw.$MAIN_LIB_VER.dylib" ]
+then
+ install_name_tool -id "$REPOSITORYDIR/lib/libpanelw.$MAIN_LIB_VER.dylib" "$REPOSITORYDIR/lib/libpanelw.$MAIN_LIB_VER.dylib"
+ ln -sfn libpanelw.$MAIN_LIB_VER.dylib $REPOSITORYDIR/lib/libpanelw.dylib;
+fi
+
+if [ -f "$REPOSITORYDIR/lib/libmenuw.$MAIN_LIB_VER.dylib" ]
+then
+ install_name_tool -id "$REPOSITORYDIR/lib/libmenuw.$MAIN_LIB_VER.dylib" "$REPOSITORYDIR/lib/libmenuw.$MAIN_LIB_VER.dylib"
+ ln -sfn libmenuw.$MAIN_LIB_VER.dylib $REPOSITORYDIR/lib/libmenuw.dylib;
+fi
+
+if [ -f "$REPOSITORYDIR/lib/libformw.$MAIN_LIB_VER.dylib" ]
+then
+ install_name_tool -id "$REPOSITORYDIR/lib/libformw.$MAIN_LIB_VER.dylib" "$REPOSITORYDIR/lib/libformw.$MAIN_LIB_VER.dylib"
+ ln -sfn libformw.$MAIN_LIB_VER.dylib $REPOSITORYDIR/lib/libformw.dylib;
+fi
+
+#Copy shell script
+for ARCH in $ARCHS
+do
+ mkdir -p "$REPOSITORYDIR/bin";
+ sed 's/^exec_prefix.*$/exec_prefix=\$\{prefix\}/' "$REPOSITORYDIR/arch/$ARCH/bin/ncursesw5-config" > "$REPOSITORYDIR/bin/ncursesw5-config";
+ break;
+done
+

Added: branches/avidemux_2.5_branch_gruntster/platforms/mac/External_libs/scripts/0017-ncurses.sh
===================================================================
--- branches/avidemux_2.5_branch_gruntster/platforms/mac/External_libs/scripts/0017-ncurses.sh	2009-02-07 14:34:30 UTC (rev 4578)
+++ branches/avidemux_2.5_branch_gruntster/platforms/mac/External_libs/scripts/0017-ncurses.sh	2009-02-08 17:04:43 UTC (rev 4579)
@@ -0,0 +1,160 @@
+# ------------------
+#    ncurses 
+# ------------------
+# Based on the works of (c) 2007, Ippei Ukai
+# Modified for avidemux by Harry van der Wolf 200806
+
+# download location ftp://ftp.gnu.org/gnu/ncurses
+
+# ncursesw and ncurses are both run from the same ncurses tar.gz and
+# from the same directory.
+# The ncursesw script needs to be run before the ncurses script
+# and comes with one extra compile setting --enable-widec
+
+
+# prepare
+
+# export REPOSITORYDIR="/PATH2HUGIN/mac/ExternalPrograms/repository" \
+# ARCHS="ppc i386" \
+#  ppcTARGET="powerpc-apple-darwin8" \
+#  i386TARGET="i386-apple-darwin8" \
+#  ppcMACSDKDIR="/Developer/SDKs/MacOSX10.4u.sdk" \
+#  i386MACSDKDIR="/Developer/SDKs/MacOSX10.4u.sdk" \
+#  ppcONLYARG="-mcpu=G3 -mtune=G4" \
+#  i386ONLYARG="-mfpmath=sse -msse2 -mtune=pentium-m -ftree-vectorize" \
+#  OTHERARGs="";
+
+
+# init
+
+let NUMARCH="0"
+
+for i in $ARCHS
+do
+  NUMARCH=$(($NUMARCH + 1))
+done
+
+mkdir -p "$REPOSITORYDIR/bin";
+mkdir -p "$REPOSITORYDIR/lib";
+mkdir -p "$REPOSITORYDIR/include";
+
+MAIN_LIB_VER="5"
+#FULL_LIB_VER="$MAIN_LIB_VER.6"
+
+
+# compile
+
+for ARCH in $ARCHS
+do
+
+ mkdir -p "$REPOSITORYDIR/arch/$ARCH/bin";
+ mkdir -p "$REPOSITORYDIR/arch/$ARCH/lib";
+ mkdir -p "$REPOSITORYDIR/arch/$ARCH/include";
+
+ ARCHARGs=""
+ MACSDKDIR=""
+
+ if [ $ARCH = "i386" -o $ARCH = "i686" ]
+ then
+  TARGET=$i386TARGET
+  MACSDKDIR=$i386MACSDKDIR
+  ARCHARGs="$i386ONLYARG"
+ elif [ $ARCH = "ppc" -o $ARCH = "ppc750" -o $ARCH = "ppc7400" ]
+ then
+  TARGET=$ppcTARGET
+  MACSDKDIR=$ppcMACSDKDIR
+  ARCHARGs="$ppcONLYARG"
+ elif [ $ARCH = "ppc64" -o $ARCH = "ppc970" ]
+ then
+  TARGET=$ppc64TARGET
+  MACSDKDIR=$ppc64MACSDKDIR
+  ARCHARGs="$ppc64ONLYARG"
+ elif [ $ARCH = "x86_64" ]
+ then
+  TARGET=$x64TARGET
+  MACSDKDIR=$x64MACSDKDIR
+  ARCHARGs="$x64ONLYARG"
+ fi
+
+
+ #patch first
+ #patch -p0 < patch-configure 
+
+ export PATH=/usr/bin:$PATH
+
+ env CFLAGS="-isysroot $MACSDKDIR -arch $ARCH $ARCHARGs $OTHERARGs -O2 -dead_strip" \
+  CXXFLAGS="-isysroot $MACSDKDIR -arch $ARCH $ARCHARGs $OTHERARGs -O2 -dead_strip" \
+  CPPFLAGS="-I$REPOSITORYDIR/include -I/usr/include -no-cpp-precomp" \
+  LDFLAGS="-L$REPOSITORYDIR/lib -L/usr/lib -dead_strip -prebind" \
+  NEXT_ROOT="$MACSDKDIR" \
+  ./configure --prefix="$REPOSITORYDIR" --disable-dependency-tracking \
+  --host="$TARGET" --exec-prefix=$REPOSITORYDIR/arch/$ARCH \
+  --with-shared --disable-rpath --without-progs \
+  --without-debug --without-ada \
+  --enable-safe-sprintf --enable-sigwinch \
+;
+
+ make clean;
+ make;
+ make install;
+
+done
+
+
+# merge libs
+
+for liba in lib/libncurses.a lib/libncurses.$MAIN_LIB_VER.dylib lib/libpanel.a lib/libpanel.$MAIN_LIB_VER.dylib lib/libmenu.a lib/libmenu.$MAIN_LIB_VER.dylib lib/libform.a lib/libform.$MAIN_LIB_VER.dylib
+do
+
+ if [ $NUMARCH -eq 1 ]
+ then
+  mv "$REPOSITORYDIR/arch/$ARCHS/$liba" "$REPOSITORYDIR/$liba";
+  ranlib "$REPOSITORYDIR/$liba";
+  continue
+ fi
+
+ LIPOARGs=""
+ 
+ for ARCH in $ARCHS
+ do
+  LIPOARGs="$LIPOARGs $REPOSITORYDIR/arch/$ARCH/$liba"
+ done
+
+ lipo $LIPOARGs -create -output "$REPOSITORYDIR/$liba";
+ ranlib "$REPOSITORYDIR/$liba";
+
+done
+
+if [ -f "$REPOSITORYDIR/lib/libncurses.$MAIN_LIB_VER.dylib" ]
+then
+ install_name_tool -id "$REPOSITORYDIR/lib/libncurses.$MAIN_LIB_VER.dylib" "$REPOSITORYDIR/lib/libncurses.$MAIN_LIB_VER.dylib"
+ ln -sfn libncurses.$MAIN_LIB_VER.dylib $REPOSITORYDIR/lib/libncurses.dylib;
+fi
+
+if [ -f "$REPOSITORYDIR/lib/libpanel.$MAIN_LIB_VER.dylib" ]
+then
+ install_name_tool -id "$REPOSITORYDIR/lib/libpanel.$MAIN_LIB_VER.dylib" "$REPOSITORYDIR/lib/libpanel.$MAIN_LIB_VER.dylib"
+ ln -sfn libpanel.$MAIN_LIB_VER.dylib $REPOSITORYDIR/lib/libpanel.dylib;
+fi
+
+if [ -f "$REPOSITORYDIR/lib/libmenu.$MAIN_LIB_VER.dylib" ]
+then
+ install_name_tool -id "$REPOSITORYDIR/lib/libmenu.$MAIN_LIB_VER.dylib" "$REPOSITORYDIR/lib/libmenu.$MAIN_LIB_VER.dylib"
+ ln -sfn libmenu.$MAIN_LIB_VER.dylib $REPOSITORYDIR/lib/libmenu.dylib;
+fi
+
+if [ -f "$REPOSITORYDIR/lib/libform.$MAIN_LIB_VER.dylib" ]
+then
+ install_name_tool -id "$REPOSITORYDIR/lib/libform.$MAIN_LIB_VER.dylib" "$REPOSITORYDIR/lib/libform.$MAIN_LIB_VER.dylib"
+ ln -sfn libform.$MAIN_LIB_VER.dylib $REPOSITORYDIR/lib/libform.dylib;
+fi
+
+#Copy shell script
+for ARCH in $ARCHS
+do
+ mkdir -p "$REPOSITORYDIR/bin";
+ sed 's/^exec_prefix.*$/exec_prefix=\$\{prefix\}/' "$REPOSITORYDIR/arch/$ARCH/bin/ncurses5-config" > "$REPOSITORYDIR/bin/ncurses5-config";
+ break;
+done
+
+

Added: branches/avidemux_2.5_branch_gruntster/platforms/mac/External_libs/scripts/0020-gettext.sh
===================================================================
--- branches/avidemux_2.5_branch_gruntster/platforms/mac/External_libs/scripts/0020-gettext.sh	2009-02-07 14:34:30 UTC (rev 4578)
+++ branches/avidemux_2.5_branch_gruntster/platforms/mac/External_libs/scripts/0020-gettext.sh	2009-02-08 17:04:43 UTC (rev 4579)
@@ -0,0 +1,213 @@
+# ------------------
+#    gettext 
+# ------------------
+# Based on the works of (c) 2007, Ippei Ukai
+# Modified for avidemux by Harry van der Wolf 200806
+
+# download location ftp.gnu.org/gnu/gettext/
+
+# prepare
+
+# export REPOSITORYDIR="/PATH2HUGIN/mac/ExternalPrograms/repository" \
+# ARCHS="ppc i386" \
+#  ppcTARGET="powerpc-apple-darwin8" \
+#  i386TARGET="i386-apple-darwin8" \
+#  ppcMACSDKDIR="/Developer/SDKs/MacOSX10.4u.sdk" \
+#  i386MACSDKDIR="/Developer/SDKs/MacOSX10.4u.sdk" \
+#  ppcONLYARG="-mcpu=G3 -mtune=G4" \
+#  i386ONLYARG="-mfpmath=sse -msse2 -mtune=pentium-m -ftree-vectorize" \
+#  OTHERARGs="";
+
+
+# init
+
+let NUMARCH="0"
+
+for i in $ARCHS
+do
+  NUMARCH=$(($NUMARCH + 1))
+done
+
+mkdir -p "$REPOSITORYDIR/bin";
+mkdir -p "$REPOSITORYDIR/lib";
+mkdir -p "$REPOSITORYDIR/include";
+
+GETTEXTVER_M="0"
+GEETTEXTVER_FULL="$GETTEXTVER_M.17"
+MAIN_LIB_VER="0"
+FULL_LIB_VER="$MAIN_LIB_VER.17"
+
+
+# compile
+
+for ARCH in $ARCHS
+do
+
+ mkdir -p "$REPOSITORYDIR/arch/$ARCH/bin";
+ mkdir -p "$REPOSITORYDIR/arch/$ARCH/lib";
+ mkdir -p "$REPOSITORYDIR/arch/$ARCH/include";
+
+ ARCHARGs=""
+ MACSDKDIR=""
+
+ if [ $ARCH = "i386" -o $ARCH = "i686" ]
+ then
+  TARGET=$i386TARGET
+  MACSDKDIR=$i386MACSDKDIR
+  ARCHARGs="$i386ONLYARG"
+ elif [ $ARCH = "ppc" -o $ARCH = "ppc750" -o $ARCH = "ppc7400" ]
+ then
+  TARGET=$ppcTARGET
+  MACSDKDIR=$ppcMACSDKDIR
+  ARCHARGs="$ppcONLYARG"
+ elif [ $ARCH = "ppc64" -o $ARCH = "ppc970" ]
+ then
+  TARGET=$ppc64TARGET
+  MACSDKDIR=$ppc64MACSDKDIR
+  ARCHARGs="$ppc64ONLYARG"
+ elif [ $ARCH = "x86_64" ]
+ then
+  TARGET=$x64TARGET
+  MACSDKDIR=$x64MACSDKDIR
+  ARCHARGs="$x64ONLYARG"
+ fi
+
+ # first patch the make file
+ #patch -po < patch-gettext-tools-Makefile.in
+
+export PATH=/usr/bin:$PATH
+
+ env CFLAGS="-isysroot $MACSDKDIR -arch $ARCH $ARCHARGs $OTHERARGs -O2 -dead_strip" \
+  CXXFLAGS="-isysroot $MACSDKDIR -arch $ARCH $ARCHARGs $OTHERARGs -O2 -dead_strip" \
+  CPPFLAGS="-I$REPOSITORYDIR/include -I/usr/include -no-cpp-precomp" \
+  LDFLAGS="-L$REPOSITORYDIR/lib -L/usr/lib -dead_strip" \
+  NEXT_ROOT="$MACSDKDIR" \
+  ./configure --prefix="$REPOSITORYDIR" --disable-dependency-tracking \
+  --host="$TARGET" --exec-prefix=$REPOSITORYDIR/arch/$ARCH \
+  --enable-shared --disable-csharp --without-emacs \
+  --with-included-gettext --with-included-glib \
+  --with-included-libxml --without-examples \
+  --with-included-libcroco  \
+;
+##  --without-acl --disable-acl \
+#;
+
+# export CFLAGS="-isysroot $MACSDKDIR -arch $ARCH $ARCHARGs $OTHERARGs -O2 -dead_strip" \
+#  CXXFLAGS="-isysroot $MACSDKDIR -arch $ARCH $ARCHARGs $OTHERARGs -O2 -dead_strip" \
+#  CPPFLAGS="-I$REPOSITORYDIR/include -I/usr/include -no-cpp-precomp" \
+#  LDFLAGS="-L$REPOSITORYDIR/lib -L/usr/lib -dead_strip -prebind" \
+#  NEXT_ROOT="$MACSDKDIR" \
+#  LIBPATH="$REPOSITORYDIR/arch/$ARCHS/lib" /usr/lib \
+#  BINPATH="$REPOSITORYDIR/arch/$ARCHS/bin" \
+#  GCCLDFLAGS="-isysroot $MACSDKDIR -arch $ARCH $ARCHARGs $OTHERARGs" \
+#  ;
+#  ./configure --prefix="$REPOSITORYDIR" --disable-dependency-tracking \
+#  --host="$TARGET" --exec-prefix=$REPOSITORYDIR/arch/$ARCH \
+#  ;
+#  --enable-shared --disable-csharp --without-emacs \
+#  --with-included-gettext --with-included-glib \
+#  --with-included-libxml \ 
+#  --with-included-libcroco  \
+#  ;
+
+
+ make clean;
+ make;
+ make install;
+
+done
+
+
+# merge libgettext
+
+for liba in lib/libgettext.a lib/libgettextlib-$FULL_LIB_VER.dylib lib/libgettextpo.0.4.0.dylib lib/libgettextsrc-$FULL_LIB_VER.dylib lib/libasprintf.0.0.0.dylib lib/libasprintf.a lib/libintl.8.0.2.dylib lib/libintl.a  
+do
+
+ if [ $NUMARCH -eq 1 ]
+ then
+  mv "$REPOSITORYDIR/arch/$ARCHS/$liba" "$REPOSITORYDIR/$liba";
+  ranlib "$REPOSITORYDIR/$liba";
+  continue
+ fi
+
+ LIPOARGs=""
+ 
+ for ARCH in $ARCHS
+ do
+  LIPOARGs="$LIPOARGs $REPOSITORYDIR/arch/$ARCH/$liba"
+ done
+
+ lipo $LIPOARGs -create -output "$REPOSITORYDIR/$liba";
+ ranlib "$REPOSITORYDIR/$liba";
+
+done
+
+if [ -f "$REPOSITORYDIR/lib/libgettextlib-$FULL_LIB_VER.dylib" ]
+then
+ install_name_tool -id "$REPOSITORYDIR/lib/libgettextlib-$FULL_LIB_VER.dylib" "$REPOSITORYDIR/lib/libgettextlib-$FULL_LIB_VER.dylib"
+ ln -sfn libgettextlib-$FULL_LIB_VER.dylib $REPOSITORYDIR/lib/libgettextlib.dylib;
+fi
+
+if [ -f "$REPOSITORYDIR/lib/libgettextsrc-$FULL_LIB_VER.dylib" ]
+then
+ install_name_tool -id "$REPOSITORYDIR/lib/libgettextsrc-$FULL_LIB_VER.dylib" "$REPOSITORYDIR/lib/libgettextsrc-$FULL_LIB_VER.dylib"
+ ln -sfn libgettextsrc-$FULL_LIB_VER.dylib $REPOSITORYDIR/lib/libgettextsrc.dylib;
+fi
+
+if [ -f "$REPOSITORYDIR/lib/libgettextpo.0.4.0.dylib" ]
+then
+ install_name_tool -id "$REPOSITORYDIR/lib/libgettextpo.0.4.0.dylib" "$REPOSITORYDIR/lib/libgettextpo.0.4.0.dylib"
+ ln -sfn libgettextpo.0.4.0.dylib $REPOSITORYDIR/lib/libgettextpo.0.dylib;
+ ln -sfn libgettextpo.0.4.0.dylib $REPOSITORYDIR/lib/libgettextpo.dylib;
+fi
+
+if [ -f "$REPOSITORYDIR/lib/libasprintf.0.0.0.dylib" ]
+then
+ install_name_tool -id "$REPOSITORYDIR/lib/libasprintf.0.0.0.dylib" "$REPOSITORYDIR/lib/libasprintf.0.0.0.dylib"
+ ln -sfn libasprintf.0.0.0.dylib $REPOSITORYDIR/lib/libasprintf.0.dylib;
+ ln -sfn libasprintf.0.0.0.dylib $REPOSITORYDIR/lib/libasprintf.dylib;
+fi
+
+if [ -f "$REPOSITORYDIR/lib/libintl.8.0.2.dylib" ]
+then
+ install_name_tool -id "$REPOSITORYDIR/lib/libintl.8.0.2.dylib" "$REPOSITORYDIR/lib/libintl.8.0.2.dylib"
+ ln -sfn libintl.8.0.2.dylib $REPOSITORYDIR/lib/libintl.8.dylib;
+ ln -sfn libintl.8.0.2.dylib $REPOSITORYDIR/lib/libintl.dylib;
+fi
+
+#Copy shell script
+for ARCH in $ARCHS
+do
+ mkdir -p "$REPOSITORYDIR/bin";
+ cp "$REPOSITORYDIR/arch/$ARCH/bin/gettext.sh" "$REPOSITORYDIR/bin/gettext.sh";
+ sed 's/^exec_prefix.*$/exec_prefix=\$\{prefix\}/' "$REPOSITORYDIR/arch/$ARCH/bin/gettextize" > "$REPOSITORYDIR/bin/gettextize";
+ sed 's/^exec_prefix.*$/exec_prefix=\$\{prefix\}/' "$REPOSITORYDIR/arch/$ARCH/bin/autopoint" > "$REPOSITORYDIR/bin/autopoint";
+ break;
+done
+
+# merge execs
+for program in bin/gettext bin/ngettext bin/xgettext bin/msgattrib bin/msgcmp bin/msgconv bin/msgexec bin/msgfmt bin/msginit bin/msgunfmt bin/msgcat bin/msgcomm bin/msgen bin/msgfilter bin/msggrep bin/msgmerge bin/msguniq bin/envsubst bin/recode-sr-latin 
+do
+
+ if [ $NUMARCH -eq 1 ]
+ then
+  mv "$REPOSITORYDIR/arch/$ARCHS/$program" "$REPOSITORYDIR/$program";
+  strip "$REPOSITORYDIR/$program";
+  continue
+ fi
+
+ LIPOARGs=""
+
+ for ARCH in $ARCHS
+ do
+  LIPOARGs="$LIPOARGs $REPOSITORYDIR/arch/$ARCH/$program"
+ done
+
+ lipo $LIPOARGs -create -output "$REPOSITORYDIR/$program";
+
+ strip "$REPOSITORYDIR/$program";
+
+done
+
+
+

Added: branches/avidemux_2.5_branch_gruntster/platforms/mac/External_libs/scripts/0025-freetype.sh
===================================================================
--- branches/avidemux_2.5_branch_gruntster/platforms/mac/External_libs/scripts/0025-freetype.sh	2009-02-07 14:34:30 UTC (rev 4578)
+++ branches/avidemux_2.5_branch_gruntster/platforms/mac/External_libs/scripts/0025-freetype.sh	2009-02-08 17:04:43 UTC (rev 4579)
@@ -0,0 +1,139 @@
+# ------------------
+#    freetype 
+# ------------------
+# Based on the works of (c) 2007, Ippei Ukai
+# Modified for avidemux by Harry van der Wolf 200806
+
+# download location http://download.savannah.gnu.org/releases/freetype/
+
+# prepare
+
+# export REPOSITORYDIR="/PATH2HUGIN/mac/ExternalPrograms/repository" \
+# ARCHS="ppc i386" \
+#  ppcTARGET="powerpc-apple-darwin8" \
+#  i386TARGET="i386-apple-darwin8" \
+#  ppcMACSDKDIR="/Developer/SDKs/MacOSX10.4u.sdk" \
+#  i386MACSDKDIR="/Developer/SDKs/MacOSX10.4u.sdk" \
+#  ppcONLYARG="-mcpu=G3 -mtune=G4" \
+#  i386ONLYARG="-mfpmath=sse -msse2 -mtune=pentium-m -ftree-vectorize" \
+#  OTHERARGs="";
+
+
+# init
+
+let NUMARCH="0"
+
+for i in $ARCHS
+do
+  NUMARCH=$(($NUMARCH + 1))
+done
+
+mkdir -p "$REPOSITORYDIR/bin";
+mkdir -p "$REPOSITORYDIR/lib";
+mkdir -p "$REPOSITORYDIR/include";
+
+MAIN_LIB_VER="6"
+FULL_LIB_VER="$MAIN_LIB_VER"
+
+
+# compile
+
+for ARCH in $ARCHS
+do
+
+ mkdir -p "$REPOSITORYDIR/arch/$ARCH/bin";
+ mkdir -p "$REPOSITORYDIR/arch/$ARCH/lib";
+ mkdir -p "$REPOSITORYDIR/arch/$ARCH/include";
+
+ ARCHARGs=""
+ MACSDKDIR=""
+
+ if [ $ARCH = "i386" -o $ARCH = "i686" ]
+ then
+  TARGET=$i386TARGET
+  MACSDKDIR=$i386MACSDKDIR
+  ARCHARGs="$i386ONLYARG"
+ elif [ $ARCH = "ppc" -o $ARCH = "ppc750" -o $ARCH = "ppc7400" ]
+ then
+  TARGET=$ppcTARGET
+  MACSDKDIR=$ppcMACSDKDIR
+  ARCHARGs="$ppcONLYARG"
+ elif [ $ARCH = "ppc64" -o $ARCH = "ppc970" ]
+ then
+  TARGET=$ppc64TARGET
+  MACSDKDIR=$ppc64MACSDKDIR
+  ARCHARGs="$ppc64ONLYARG"
+ elif [ $ARCH = "x86_64" ]
+ then
+  TARGET=$x64TARGET
+  MACSDKDIR=$x64MACSDKDIR
+  ARCHARGs="$x64ONLYARG"
+ fi
+
+ # first patch the make file
+
+export PATH=/usr/bin:$PATH
+
+ env CFLAGS="-isysroot $MACSDKDIR -arch $ARCH $ARCHARGs $OTHERARGs -O2 -dead_strip" \
+  CXXFLAGS="-isysroot $MACSDKDIR -arch $ARCH $ARCHARGs $OTHERARGs -O2 -dead_strip" \
+  CPPFLAGS="-I$REPOSITORYDIR/include -no-cpp-precomp" \
+  LDFLAGS="-L$REPOSITORYDIR/lib -dead_strip" \
+  NEXT_ROOT="$MACSDKDIR" \
+  ./configure --prefix="$REPOSITORYDIR" \
+  --host="$TARGET" --target="$TARGET" CC="gcc -arch $ARCH" --exec-prefix=$REPOSITORYDIR/arch/$ARCH \
+  --enable-shared --with-old-mac-fonts \
+;
+
+
+ make clean;
+ make;
+ make install;
+
+done
+
+
+# merge libfreetype
+
+for liba in lib/libfreetype.a lib/libfreetype.$FULL_LIB_VER.dylib   
+do
+
+ if [ $NUMARCH -eq 1 ]
+ then
+  mv "$REPOSITORYDIR/arch/$ARCHS/$liba" "$REPOSITORYDIR/$liba";
+  ranlib "$REPOSITORYDIR/$liba";
+  continue
+ fi
+
+ LIPOARGs=""
+ 
+ for ARCH in $ARCHS
+ do
+  LIPOARGs="$LIPOARGs $REPOSITORYDIR/arch/$ARCH/$liba"
+ done
+
+ lipo $LIPOARGs -create -output "$REPOSITORYDIR/$liba";
+ ranlib "$REPOSITORYDIR/$liba";
+
+done
+
+if [ -f "$REPOSITORYDIR/lib/libfreetype.$FULL_LIB_VER.dylib" ]
+then
+ install_name_tool -id "$REPOSITORYDIR/lib/libfreetype.$FULL_LIB_VER.dylib" "$REPOSITORYDIR/lib/libfreetype.$FULL_LIB_VER.dylib"
+ ln -sfn $REPOSITORYDIR/lib/libfreetype.dylib;
+fi
+
+#pkgconfig
+for ARCH in $ARCHS
+do
+ mkdir -p "$REPOSITORYDIR/lib/pkgconfig";
+ sed 's/^exec_prefix.*$/exec_prefix=\$\{prefix\}/' "$REPOSITORYDIR/arch/$ARCH/lib/pkgconfig/freetype2.pc" > "$REPOSITORYDIR/lib/pkgconfig/freetype2.pc";
+ break;
+done
+
+#Copy shell script
+for ARCH in $ARCHS
+do
+ mkdir -p "$REPOSITORYDIR/bin";
+ sed 's/^exec_prefix.*$/exec_prefix=\$\{prefix\}/' "$REPOSITORYDIR/arch/$ARCH/bin/freetype-config" > "$REPOSITORYDIR/bin/freetype-config";
+ break;
+done

Added: branches/avidemux_2.5_branch_gruntster/platforms/mac/External_libs/scripts/0030-fontconfig.sh
===================================================================
--- branches/avidemux_2.5_branch_gruntster/platforms/mac/External_libs/scripts/0030-fontconfig.sh	2009-02-07 14:34:30 UTC (rev 4578)
+++ branches/avidemux_2.5_branch_gruntster/platforms/mac/External_libs/scripts/0030-fontconfig.sh	2009-02-08 17:04:43 UTC (rev 4579)
@@ -0,0 +1,163 @@
+# ------------------
+#    fontconfig 
+# ------------------
+# Based on the works of (c) 2007, Ippei Ukai
+# Modified for avidemux by Harry van der Wolf 200806
+
+# download location http://fontconfig.org/release/
+
+# prepare
+
+# export REPOSITORYDIR="/PATH2HUGIN/mac/ExternalPrograms/repository" \
+# ARCHS="ppc i386" \
+#  ppcTARGET="powerpc-apple-darwin8" \
+#  i386TARGET="i386-apple-darwin8" \
+#  ppcMACSDKDIR="/Developer/SDKs/MacOSX10.4u.sdk" \
+#  i386MACSDKDIR="/Developer/SDKs/MacOSX10.4u.sdk" \
+#  ppcONLYARG="-mcpu=G3 -mtune=G4" \
+#  i386ONLYARG="-mfpmath=sse -msse2 -mtune=pentium-m -ftree-vectorize" \
+#  OTHERARGs="";
+
+
+# init
+
+let NUMARCH="0"
+
+for i in $ARCHS
+do
+  NUMARCH=$(($NUMARCH + 1))
+done
+
+mkdir -p "$REPOSITORYDIR/bin";
+mkdir -p "$REPOSITORYDIR/lib";
+mkdir -p "$REPOSITORYDIR/include";
+
+MAIN_LIB_VER="1"
+FULL_LIB_VER="$MAIN_LIB_VER.3.0"
+
+
+# compile
+
+for ARCH in $ARCHS
+do
+
+ mkdir -p "$REPOSITORYDIR/arch/$ARCH/bin";
+ mkdir -p "$REPOSITORYDIR/arch/$ARCH/lib";
+ mkdir -p "$REPOSITORYDIR/arch/$ARCH/include";
+
+ ARCHARGs=""
+ MACSDKDIR=""
+
+ if [ $ARCH = "i386" -o $ARCH = "i686" ]
+ then
+  TARGET=$i386TARGET
+  MACSDKDIR=$i386MACSDKDIR
+  ARCHARGs="$i386ONLYARG"
+ elif [ $ARCH = "ppc" -o $ARCH = "ppc750" -o $ARCH = "ppc7400" ]
+ then
+  TARGET=$ppcTARGET
+  MACSDKDIR=$ppcMACSDKDIR
+  ARCHARGs="$ppcONLYARG"
+ elif [ $ARCH = "ppc64" -o $ARCH = "ppc970" ]
+ then
+  TARGET=$ppc64TARGET
+  MACSDKDIR=$ppc64MACSDKDIR
+  ARCHARGs="$ppc64ONLYARG"
+ elif [ $ARCH = "x86_64" ]
+ then
+  TARGET=$x64TARGET
+  MACSDKDIR=$x64MACSDKDIR
+  ARCHARGs="$x64ONLYARG"
+ fi
+
+export PATH=/usr/bin:$REPOSITORYDIR/bin:$PATH
+
+
+ env CFLAGS="-isysroot $MACSDKDIR -arch $ARCH $ARCHARGs $OTHERARGs -O2 -dead_strip" \
+  CXXFLAGS="-isysroot $MACSDKDIR -arch $ARCH $ARCHARGs $OTHERARGs -O2 -dead_strip" \
+  CPPFLAGS="-I$REPOSITORYDIR/include -I/usr/include -no-cpp-precomp" \
+  LDFLAGS="-L$REPOSITORYDIR/lib -L/usr/lib -dead_strip" \
+  NEXT_ROOT="$MACSDKDIR" \
+  PKG_CONFIG_PATH=$REPOSITORYDIR/lib/pkgconfig \
+  ./configure --prefix="$REPOSITORYDIR" --disable-dependency-tracking \
+  --host="$TARGET" --target="$TARGET" --exec-prefix=$REPOSITORYDIR/arch/$ARCH \
+  --with-add-fonts=/Library/Fonts,/Network/Library/Fonts,/System/Library/Fonts,${prefix}/share/fonts \
+  --enable-shared  --disable-docs --with-freetype-config=$REPOSITORYDIR/arch/$ARCH/bin/freetype-config \
+;
+#   ./configure --prefix="$REPOSITORYDIR" --disable-dependency-tracking --enable-libxml2 \
+
+
+ make clean;
+ make;
+ make install;
+
+done
+
+
+# merge libfontconfig
+
+for liba in lib/libfontconfig.a lib/libfontconfig.$FULL_LIB_VER.dylib   
+do
+
+ if [ $NUMARCH -eq 1 ]
+ then
+  mv "$REPOSITORYDIR/arch/$ARCHS/$liba" "$REPOSITORYDIR/$liba";
+  ranlib "$REPOSITORYDIR/$liba";
+  continue
+ fi
+
+ LIPOARGs=""
+ 
+ for ARCH in $ARCHS
+ do
+  LIPOARGs="$LIPOARGs $REPOSITORYDIR/arch/$ARCH/$liba"
+ done
+
+ lipo $LIPOARGs -create -output "$REPOSITORYDIR/$liba";
+ ranlib "$REPOSITORYDIR/$liba";
+
+done
+
+if [ -f "$REPOSITORYDIR/lib/libfontconfig.$FULL_LIB_VER.dylib" ]
+then
+ install_name_tool -id "$REPOSITORYDIR/lib/libfontconfig.$FULL_LIB_VER.dylib" "$REPOSITORYDIR/lib/libfontconfig.$FULL_LIB_VER.dylib"
+ ln -sfn $REPOSITORYDIR/lib/libfontconfig.$FULL_LIB_VER.dylib $REPOSITORYDIR/lib/libfontconfig.$MAIN_LIB_VER.dylib
+ ln -sfn $REPOSITORYDIR/lib/libfontconfig.$FULL_LIB_VER.dylib $REPOSITORYDIR/lib/libfontconfig.dylib;
+fi
+
+#pkgconfig
+for ARCH in $ARCHS
+do
+ mkdir -p "$REPOSITORYDIR/lib/pkgconfig";
+ sed 's/^exec_prefix.*$/exec_prefix=\$\{prefix\}/' "$REPOSITORYDIR/arch/$ARCH/lib/pkgconfig/fontconfig.pc" > "$REPOSITORYDIR/lib/pkgconfig/fontconfig.pc.tmp";
+ # fontconfig needs an extra step
+ sed 's+arch/ppc/++' "$REPOSITORYDIR/lib/pkgconfig/fontconfig.pc.tmp" > "$REPOSITORYDIR/lib/pkgconfig/fontconfig.pc";
+ rm "$REPOSITORYDIR/lib/pkgconfig/fontconfig.pc.tmp"
+break;
+done
+
+# merge execs
+for program in bin/fc-cache bin/fc-cat bin/fc-list bin/fc-match
+do
+
+ if [ $NUMARCH -eq 1 ]
+ then
+  mv "$REPOSITORYDIR/arch/$ARCHS/$program" "$REPOSITORYDIR/$program";
+  strip "$REPOSITORYDIR/$program";
+  continue
+ fi
+
+ LIPOARGs=""
+
+ for ARCH in $ARCHS
+ do
+  LIPOARGs="$LIPOARGs $REPOSITORYDIR/arch/$ARCH/$program"
+ done
+
+ lipo $LIPOARGs -create -output "$REPOSITORYDIR/$program";
+
+ strip "$REPOSITORYDIR/$program";
+
+done
+
+

Added: branches/avidemux_2.5_branch_gruntster/platforms/mac/External_libs/scripts/0120-libjpeg.sh
===================================================================
--- branches/avidemux_2.5_branch_gruntster/platforms/mac/External_libs/scripts/0120-libjpeg.sh	2009-02-07 14:34:30 UTC (rev 4578)
+++ branches/avidemux_2.5_branch_gruntster/platforms/mac/External_libs/scripts/0120-libjpeg.sh	2009-02-08 17:04:43 UTC (rev 4579)
@@ -0,0 +1,139 @@
+# ------------------
+#     libjpeg
+# ------------------
+# $Id: libjpeg.sh 1902 2007-02-04 22:27:47Z ippei $
+# Copyright (c) 2007, Ippei Ukai
+
+
+# prepare
+
+# export REPOSITORYDIR="/PATH2HUGIN/mac/ExternalPrograms/repository" \
+# ARCHS="ppc i386" \
+#  ppcTARGET="powerpc-apple-darwin7" \
+#  ppcMACSDKDIR="/Developer/SDKs/MacOSX10.3.9.sdk" \
+#  ppcONLYARG="-mcpu=G3 -mtune=G4 -mmacosx-version-min=10.3" \
+#  i386TARGET="i386-apple-darwin8" \
+#  i386MACSDKDIR="/Developer/SDKs/MacOSX10.4u.sdk" \
+#  i386ONLYARG="-march=prescott -mtune=pentium-m -ftree-vectorize -mmacosx-version-min=10.4" \
+#  OTHERARGs="";
+
+
+# init
+
+let NUMARCH="0"
+
+for i in $ARCHS
+do
+  NUMARCH=$(($NUMARCH + 1))
+done
+
+mkdir -p "$REPOSITORYDIR/bin";
+mkdir -p "$REPOSITORYDIR/lib";
+mkdir -p "$REPOSITORYDIR/include";
+
+
+# compile
+
+# update some of libtool stuff
+cp /usr/share/libtool/config* ./;
+
+for ARCH in $ARCHS
+do
+
+ mkdir -p "$REPOSITORYDIR/arch/$ARCH/bin";
+ mkdir -p "$REPOSITORYDIR/arch/$ARCH/lib";
+ mkdir -p "$REPOSITORYDIR/arch/$ARCH/include";
+
+ ARCHARGs=""
+ MACSDKDIR=""
+
+ if [ $ARCH = "i386" -o $ARCH = "i686" ]
+ then
+  TARGET=$i386TARGET
+  MACSDKDIR=$i386MACSDKDIR
+  ARCHARGs="$i386ONLYARG"
+ elif [ $ARCH = "ppc" -o $ARCH = "ppc750" -o $ARCH = "ppc7400" ]
+ then
+  TARGET=$ppcTARGET
+  MACSDKDIR=$ppcMACSDKDIR
+  ARCHARGs="$ppcONLYARG"
+ elif [ $ARCH = "ppc64" -o $ARCH = "ppc970" ]
+ then
+  TARGET=$ppc64TARGET
+  MACSDKDIR=$ppc64MACSDKDIR
+  ARCHARGs="$ppc64ONLYARG"
+ elif [ $ARCH = "x86_64" ]
+ then
+  TARGET=$x64TARGET
+  MACSDKDIR=$x64MACSDKDIR
+  ARCHARGs="$x64ONLYARG"
+ fi
+
+ env CFLAGS="-isysroot $MACSDKDIR -arch $ARCH $ARCHARGs $OTHERARGs -O2 -dead_strip" \
+  CXXFLAGS="-isysroot $MACSDKDIR -arch $ARCH $ARCHARGs $OTHERARGs -O2 -dead_strip" \
+  CPPFLAGS="-I$REPOSITORYDIR/include -I/usr/include" \
+  LDFLAGS="-L$REPOSITORYDIR/lib -L/usr/lib -dead_strip" \
+  NEXT_ROOT="$MACSDKDIR" \
+  ./configure --prefix="$REPOSITORYDIR" --disable-dependency-tracking \
+  --host="$TARGET" --exec-prefix=$REPOSITORYDIR/arch/$ARCH \
+  --disable-shared --enable-static;
+
+ make clean;
+ make install-lib;
+
+ # the old config-make stuff do not create shared library well. Best do it by hand.
+ rm "libjpeg.62.0.0.dylib";
+ gcc -isysroot $MACSDKDIR -arch $ARCH $ARCHARGs $OTHERARGs -dead_strip \
+  -dynamiclib -flat_namespace -undefined suppress \
+  -lmx -shared-libgcc -current_version 62.0.0 -compatibility_version 62.0.0\
+  -install_name "$REPOSITORYDIR/lib/libjpeg.62.dylib" -o libjpeg.62.0.0.dylib \
+  jcomapi.o jutils.o jerror.o jmemmgr.o jmemnobs.o \
+  jcapimin.o jcapistd.o jctrans.o jcparam.o jdatadst.o jcinit.o \
+  jcmaster.o jcmarker.o jcmainct.o jcprepct.o jccoefct.o jccolor.o \
+  jcsample.o jchuff.o jcphuff.o jcdctmgr.o jfdctfst.o jfdctflt.o \
+  jfdctint.o \
+  jdapimin.o jdapistd.o jdtrans.o jdatasrc.o jdmaster.o \
+  jdinput.o jdmarker.o jdhuff.o jdphuff.o jdmainct.o jdcoefct.o \
+  jdpostct.o jddctmgr.o jidctfst.o jidctflt.o jidctint.o jidctred.o \
+  jdsample.o jdcolor.o jquant1.o jquant2.o jdmerge.o;
+ install "libjpeg.62.0.0.dylib" "$REPOSITORYDIR/arch/$ARCH/lib";
+
+done
+
+
+# merge libjpeg
+
+for liba in lib/libjpeg.a lib/libjpeg.62.0.0.dylib
+do
+
+ if [ $NUMARCH -eq 1 ]
+ then
+  mv "$REPOSITORYDIR/arch/$ARCHS/$liba" "$REPOSITORYDIR/$liba";
+  if [[ $liba == *.a ]]
+  then 
+   ranlib "$REPOSITORYDIR/$liba";
+  fi
+  continue
+ fi
+
+ LIPOARGs=""
+ 
+ for ARCH in $ARCHS
+ do
+  LIPOARGs="$LIPOARGs $REPOSITORYDIR/arch/$ARCH/$liba"
+ done
+
+ lipo $LIPOARGs -create -output "$REPOSITORYDIR/$liba";
+ if [[ $liba == *.a ]]
+ then 
+  ranlib "$REPOSITORYDIR/$liba";
+ fi
+ 
+done
+
+
+if [ -f "$REPOSITORYDIR/lib/libjpeg.62.0.0.dylib" ]
+then
+ ln -sfn "libjpeg.62.0.0.dylib" "$REPOSITORYDIR/lib/libjpeg.62.dylib";
+ ln -sfn "libjpeg.62.0.0.dylib" "$REPOSITORYDIR/lib/libjpeg.dylib";
+fi

Added: branches/avidemux_2.5_branch_gruntster/platforms/mac/External_libs/scripts/0130-libtiff.sh
===================================================================
--- branches/avidemux_2.5_branch_gruntster/platforms/mac/External_libs/scripts/0130-libtiff.sh	2009-02-07 14:34:30 UTC (rev 4578)
+++ branches/avidemux_2.5_branch_gruntster/platforms/mac/External_libs/scripts/0130-libtiff.sh	2009-02-08 17:04:43 UTC (rev 4579)
@@ -0,0 +1,190 @@
+# ------------------
+#     libtiff
+# ------------------
+# $Id: libtiff.sh 1902 2007-02-04 22:27:47Z ippei $
+# Copyright (c) 2007, Ippei Ukai
+# Modified for avidemux by Harry van der Wolf 20080614
+
+# download location http://www.remotesensing.org/libtiff/
+
+# prepare
+
+# export REPOSITORYDIR="/PATH2HUGIN/mac/ExternalPrograms/repository" \
+# ARCHS="ppc i386" \
+# ppcTARGET="powerpc-apple-darwin7" \
+# i386TARGET="i386-apple-darwin8" \
+#  ppcMACSDKDIR="/Developer/SDKs/MacOSX10.4u.sdk" \
+#  i386MACSDKDIR="/Developer/SDKs/MacOSX10.3.9.sdk" \
+#  ppcONLYARG="-mcpu=G3 -mtune=G4" \
+#  i386ONLYARG="-mfpmath=sse -msse2 -mtune=pentium-m -ftree-vectorize" \
+#  OTHERARGs="";
+
+
+# init
+
+let NUMARCH="0"
+
+for i in $ARCHS
+do
+  NUMARCH=$(($NUMARCH + 1))
+done
+
+mkdir -p "$REPOSITORYDIR/bin";
+mkdir -p "$REPOSITORYDIR/lib";
+mkdir -p "$REPOSITORYDIR/include";
+
+
+# compile
+
+for ARCH in $ARCHS
+do
+
+ mkdir -p "$REPOSITORYDIR/arch/$ARCH/bin";
+ mkdir -p "$REPOSITORYDIR/arch/$ARCH/lib";
+ mkdir -p "$REPOSITORYDIR/arch/$ARCH/include";
+
+ ARCHARGs=""
+ MACSDKDIR=""
+ OTHERMAKEARGs=""
+
+ if [ $ARCH = "i386" -o $ARCH = "i686" ]
+ then
+  TARGET=$i386TARGET
+  MACSDKDIR=$i386MACSDKDIR
+  ARCHARGs="$i386ONLYARG"
+ elif [ $ARCH = "ppc" -o $ARCH = "ppc750" -o $ARCH = "ppc7400" ]
+ then
+  TARGET=$ppcTARGET
+  MACSDKDIR=$ppcMACSDKDIR
+  ARCHARGs="$ppcONLYARG"
+ elif [ $ARCH = "ppc64" -o $ARCH = "ppc970" ]
+ then
+  TARGET=$ppc64TARGET
+  MACSDKDIR=$ppc64MACSDKDIR
+  ARCHARGs="$ppc64ONLYARG"
+ elif [ $ARCH = "x86_64" ]
+ then
+  TARGET=$x64TARGET
+  MACSDKDIR=$x64MACSDKDIR
+  ARCHARGs="$x64ONLYARG"
+ fi
+
+ env CFLAGS="-isysroot $MACSDKDIR -arch $ARCH $ARCHARGs $OTHERARGs -O2 -dead_strip" \
+  CXXFLAGS="-isysroot $MACSDKDIR -arch $ARCH $ARCHARGs $OTHERARGs -O2 -dead_strip" \
+  CPPFLAGS="-I$REPOSITORYDIR/include" \
+  LDFLAGS="-L$REPOSITORYDIR/lib -dead_strip" \
+  NEXT_ROOT="$MACSDKDIR" \
+  ./configure --prefix="$REPOSITORYDIR" --disable-dependency-tracking \
+  --host="$TARGET" --exec-prefix=$REPOSITORYDIR/arch/$ARCH \
+  --enable-static --enable-shared --with-apple-opengl-framework --without-x;
+
+ make clean;
+ cd ./port; make $OTHERMAKEARGs;
+ cd ../libtiff; make $OTHERMAKEARGs install;
+ cd ../;
+
+ rm $REPOSITORYDIR/include/tiffconf.h;
+ cp "./libtiff/tiffconf.h" "$REPOSITORYDIR/arch/$ARCH/include/tiffconf.h";
+
+done
+
+
+# merge libtiff
+
+for liba in lib/libtiff.a lib/libtiffxx.a lib/libtiff.3.dylib lib/libtiffxx.3.dylib
+do
+
+ if [ $NUMARCH -eq 1 ]
+ then
+  mv "$REPOSITORYDIR/arch/$ARCHS/$liba" "$REPOSITORYDIR/$liba";
+  if [[ $liba == *.a ]]
+  then 
+   ranlib "$REPOSITORYDIR/$liba";
+  fi
+  continue
+ fi
+
+ LIPOARGs=""
+ 
+ for ARCH in $ARCHS
+ do
+  LIPOARGs="$LIPOARGs $REPOSITORYDIR/arch/$ARCH/$liba"
+ done
+
+ lipo $LIPOARGs -create -output "$REPOSITORYDIR/$liba";
+ if [[ $liba == *.a ]]
+ then 
+  ranlib "$REPOSITORYDIR/$liba";
+ fi
+
+done
+
+
+if [ -f "$REPOSITORYDIR/lib/libtiff.3.dylib" ]
+then
+ install_name_tool -id "$REPOSITORYDIR/lib/libtiff.3.dylib" "$REPOSITORYDIR/lib/libtiff.3.dylib";
+ ln -sfn libtiff.3.dylib $REPOSITORYDIR/lib/libtiff.dylib;
+fi
+if [ -f "$REPOSITORYDIR/lib/libtiffxx.3.dylib" ]
+then
+ install_name_tool -id "$REPOSITORYDIR/lib/libtiffxx.3.dylib" "$REPOSITORYDIR/lib/libtiffxx.3.dylib";
+ for ARCH in $ARCHS
+ do
+  install_name_tool -change "$REPOSITORYDIR/arch/$ARCH/lib/libtiff.3.dylib" "$REPOSITORYDIR/lib/libtiff.3.dylib" "$REPOSITORYDIR/lib/libtiffxx.3.dylib";
+ done
+ ln -sfn libtiffxx.3.dylib $REPOSITORYDIR/lib/libtiffxx.dylib;
+fi
+
+
+
+# merge config.h
+
+for conf_h in include/tiffconf.h
+do
+ 
+ echo "" > "$REPOSITORYDIR/$conf_h";
+
+ if [ $NUMARCH -eq 1 ]
+ then
+  mv $REPOSITORYDIR/arch/$ARCHS/$conf_h $REPOSITORYDIR/$conf_h;
+  continue;
+ fi
+
+ for ARCH in $ARCHS
+ do
+  if [ $ARCH = "i386" -o $ARCH = "i686" ]
+  then
+   echo "#if defined(__i386__)"              >> "$REPOSITORYDIR/$conf_h";
+   echo ""                                   >> "$REPOSITORYDIR/$conf_h";
+   cat  "$REPOSITORYDIR/arch/$ARCH/$conf_h"  >> "$REPOSITORYDIR/$conf_h";
+   echo ""                                   >> "$REPOSITORYDIR/$conf_h";
+   echo "#endif"                             >> "$REPOSITORYDIR/$conf_h";
+  elif [ $ARCH = "ppc" -o $ARCH = "ppc750" -o $ARCH = "ppc7400" ]
+  then
+   echo "#if defined(__ppc__)"               >> "$REPOSITORYDIR/$conf_h";
+   echo ""                                   >> "$REPOSITORYDIR/$conf_h";
+   cat  "$REPOSITORYDIR/arch/$ARCH/$conf_h"  >> "$REPOSITORYDIR/$conf_h";
+   echo ""                                   >> "$REPOSITORYDIR/$conf_h";
+   echo "#endif"                             >> "$REPOSITORYDIR/$conf_h";
+  elif [ $ARCH = "ppc64" -o $ARCH = "ppc970" ]
+  then
+   echo "#if defined(__ppc64__)"             >> "$REPOSITORYDIR/$conf_h";
+   echo ""                                   >> "$REPOSITORYDIR/$conf_h";
+   cat  "$REPOSITORYDIR/arch/$ARCH/$conf_h"  >> "$REPOSITORYDIR/$conf_h";
+   echo ""                                   >> "$REPOSITORYDIR/$conf_h";
+   echo "#endif"                             >> "$REPOSITORYDIR/$conf_h";
+  elif [ $ARCH = "x86_64" ]
+  then
+   echo "#if defined(__x86_64__)"             >> "$REPOSITORYDIR/$conf_h";
+   echo ""                                   >> "$REPOSITORYDIR/$conf_h";
+   cat  "$REPOSITORYDIR/arch/$ARCH/$conf_h"  >> "$REPOSITORYDIR/$conf_h";
+   echo ""                                   >> "$REPOSITORYDIR/$conf_h";
+   echo "#endif"                             >> "$REPOSITORYDIR/$conf_h";
+  fi
+ done
+
+done
+
+
+
+

Added: branches/avidemux_2.5_branch_gruntster/platforms/mac/External_libs/scripts/0140-libpng.sh
===================================================================
--- branches/avidemux_2.5_branch_gruntster/platforms/mac/External_libs/scripts/0140-libpng.sh	2009-02-07 14:34:30 UTC (rev 4578)
+++ branches/avidemux_2.5_branch_gruntster/platforms/mac/External_libs/scripts/0140-libpng.sh	2009-02-08 17:04:43 UTC (rev 4579)
@@ -0,0 +1,150 @@
+# ------------------
+#     libpng
+# ------------------
+# $Id: libpng.sh 1902 2007-02-04 22:27:47Z ippei $
+# Copyright (c) 2007, Ippei Ukai
+# Modified for avidemux by Harry van der Wolf 20080614
+
+# download location http://libpng.sourceforge.net/
+
+# prepare
+
+# export REPOSITORYDIR="/PATH2HUGIN/mac/ExternalPrograms/repository" \
+# ARCHS="ppc i386" \
+#  ppcTARGET="powerpc-apple-darwin8" \
+#  i386TARGET="i386-apple-darwin8" \
+#  ppcMACSDKDIR="/Developer/SDKs/MacOSX10.4u.sdk" \
+#  i386MACSDKDIR="/Developer/SDKs/MacOSX10.3.9.sdk" \
+#  ppcONLYARG="-mcpu=G3 -mtune=G4" \
+#  i386ONLYARG="-mfpmath=sse -msse2 -mtune=pentium-m -ftree-vectorize" \
+#  ppc64ONLYARG="-mcpu=G5 -mtune=G5 -ftree-vectorize" \
+#  OTHERARGs="";
+
+
+# init
+
+let NUMARCH="0"
+
+for i in $ARCHS
+do
+  NUMARCH=$(($NUMARCH + 1))
+done
+
+mkdir -p "$REPOSITORYDIR/bin";
+mkdir -p "$REPOSITORYDIR/lib";
+mkdir -p "$REPOSITORYDIR/include";
+
+PNGVER="1.2.29"
+
+
+# compile
+
+# patch makefile.darwin
+sed -e 's/-dynamiclib/-dynamiclib \$\(GCCLDFLAGS\)/g' scripts/makefile.darwin > makefile;
+
+for ARCH in $ARCHS
+do
+
+ mkdir -p "$REPOSITORYDIR/arch/$ARCH/bin";
+ mkdir -p "$REPOSITORYDIR/arch/$ARCH/lib";
+ mkdir -p "$REPOSITORYDIR/arch/$ARCH/include";
+
+ ARCHARGs=""
+ MACSDKDIR=""
+
+ if [ $ARCH = "i386" -o $ARCH = "i686" ]
+ then
+  TARGET=$i386TARGET
+  MACSDKDIR=$i386MACSDKDIR
+  ARCHARGs="$i386ONLYARG"
+ elif [ $ARCH = "ppc" -o $ARCH = "ppc750" -o $ARCH = "ppc7400" ]
+ then
+  TARGET=$ppcTARGET
+  MACSDKDIR=$ppcMACSDKDIR
+  ARCHARGs="$ppcONLYARG"
+ elif [ $ARCH = "ppc64" -o $ARCH = "ppc970" ]
+ then
+  TARGET=$ppc64TARGET
+  MACSDKDIR=$ppc64MACSDKDIR
+  ARCHARGs="$ppc64ONLYARG"
+ elif [ $ARCH = "x86_64" ]
+ then
+  TARGET=$x64TARGET
+  MACSDKDIR=$x64MACSDKDIR
+  ARCHARGs="$x64ONLYARG"
+ fi
+
+ make clean;
+ make install-static install-shared \
+  prefix="$REPOSITORYDIR" \
+  ZLIBLIB="$MACSDKDIR/usr/lib" \
+  ZLIBINC="$MACSDKDIR/usr/include" \
+  CFLAGS="-isysroot $MACSDKDIR -arch $ARCH $ARCHARGs $OTHERARGs -O2 -dead_strip" \
+  LDFLAGS="-L$REPOSITORYDIR/lib -L. -L$ZLIBLIB -lpng12 -lz" \
+  NEXT_ROOT="$MACSDKDIR" \
+  LIBPATH="$REPOSITORYDIR/arch/$ARCH/lib" \
+  BINPATH="$REPOSITORYDIR/arch/$ARCH/bin" \
+  GCCLDFLAGS="-isysroot $MACSDKDIR -arch $ARCH $ARCHARGs $OTHERARGs";
+
+done
+
+
+# merge libpng
+
+for liba in lib/libpng12.a lib/libpng12.0.$PNGVER.dylib lib/libpng.3.$PNGVER.dylib
+do
+
+ if [ $NUMARCH -eq 1 ]
+ then
+  mv "$REPOSITORYDIR/arch/$ARCHS/$liba" "$REPOSITORYDIR/$liba";
+  if [[ $liba == *.a ]]
+  then 
+   ranlib "$REPOSITORYDIR/$liba";
+  fi
+  continue
+ fi
+
+ LIPOARGs=""
+ 
+ for ARCH in $ARCHS
+ do
+  LIPOARGs="$LIPOARGs $REPOSITORYDIR/arch/$ARCH/$liba"
+ done
+
+ lipo $LIPOARGs -create -output "$REPOSITORYDIR/$liba";
+ if [[ $liba == *.a ]]
+ then 
+  ranlib "$REPOSITORYDIR/$liba";
+ fi
+
+done
+
+
+if [ -f "$REPOSITORYDIR/lib/libpng12.a" ]
+then
+ ln -sfn libpng12.a $REPOSITORYDIR/lib/libpng.a;
+fi
+
+if [ -f "$REPOSITORYDIR/lib/libpng12.0.$PNGVER.dylib" ]
+then
+ install_name_tool -id "$REPOSITORYDIR/lib/libpng12.0.dylib" "$REPOSITORYDIR/lib/libpng12.0.$PNGVER.dylib"
+ ln -sfn libpng12.0.$PNGVER.dylib $REPOSITORYDIR/lib/libpng12.0.dylib;
+ ln -sfn libpng12.0.$PNGVER.dylib $REPOSITORYDIR/lib/libpng12.dylib;
+fi
+if [ -f "$REPOSITORYDIR/lib/libpng.3.$PNGVER.dylib" ]
+then
+ install_name_tool -id "$REPOSITORYDIR/lib/libpng.3.dylib" "$REPOSITORYDIR/lib/libpng.3.$PNGVER.dylib"
+ ln -sfn libpng.3.$PNGVER.dylib $REPOSITORYDIR/lib/libpng.3.dylib;
+ ln -sfn libpng.3.$PNGVER.dylib $REPOSITORYDIR/lib/libpng.dylib;
+fi
+
+#pkgconfig
+for ARCH in $ARCHS
+do
+ mkdir -p "$REPOSITORYDIR/lib/pkgconfig";
+ #sed 's+arch/$ARCH/++' "$REPOSITORYDIR/arch/$ARCH/lib/pkgconfig/libpng12.pc" > "$REPOSITORYDIR/lib/pkgconfig/libpng12.pc";
+ sed 's/^libdir.*$/libdir=\$\{prefix\}\/lib/' "$REPOSITORYDIR/arch/$ARCH/lib/pkgconfig/libpng12.pc" > "$REPOSITORYDIR/lib/pkgconfig/libpng12.pc";
+ break;
+done
+ln -sfn $REPOSITORYDIR/lib/pkgconfig/libpng12.pc $REPOSITORYDIR/lib/pkgconfig/libpng.pc
+

Added: branches/avidemux_2.5_branch_gruntster/platforms/mac/External_libs/scripts/0150-libxml.sh
===================================================================
--- branches/avidemux_2.5_branch_gruntster/platforms/mac/External_libs/scripts/0150-libxml.sh	2009-02-07 14:34:30 UTC (rev 4578)
+++ branches/avidemux_2.5_branch_gruntster/platforms/mac/External_libs/scripts/0150-libxml.sh	2009-02-08 17:04:43 UTC (rev 4579)
@@ -0,0 +1,133 @@
+# ------------------
+#    libxml2 
+# ------------------
+# Based on the works of (c) 2007, Ippei Ukai
+# Modified for avidemux by Harry van der Wolf
+
+# download location ftp://xmlsoft.org/libxml2/
+
+# prepare
+
+# export REPOSITORYDIR="/PATH2HUGIN/mac/ExternalPrograms/repository" \
+# ARCHS="ppc i386" \
+#  ppcTARGET="powerpc-apple-darwin8" \
+#  i386TARGET="i386-apple-darwin8" \
+#  ppcMACSDKDIR="/Developer/SDKs/MacOSX10.4u.sdk" \
+#  i386MACSDKDIR="/Developer/SDKs/MacOSX10.4u.sdk" \
+#  ppcONLYARG="-mcpu=G3 -mtune=G4" \
+#  i386ONLYARG="-mfpmath=sse -msse2 -mtune=pentium-m -ftree-vectorize" \
+#  OTHERARGs="";
+
+
+# init
+
+let NUMARCH="0"
+
+for i in $ARCHS
+do
+  NUMARCH=$(($NUMARCH + 1))
+done
+
+mkdir -p "$REPOSITORYDIR/bin";
+mkdir -p "$REPOSITORYDIR/lib";
+mkdir -p "$REPOSITORYDIR/include";
+
+MAIN_LIB_VER="2"
+FULL_LIB_VER="$MAIN_LIB_VER.6.32"
+
+
+# compile
+
+for ARCH in $ARCHS
+do
+
+ mkdir -p "$REPOSITORYDIR/arch/$ARCH/bin";
+ mkdir -p "$REPOSITORYDIR/arch/$ARCH/lib";
+ mkdir -p "$REPOSITORYDIR/arch/$ARCH/include";
+
+ ARCHARGs=""
+ MACSDKDIR=""
+
+ if [ $ARCH = "i386" -o $ARCH = "i686" ]
+ then
+  TARGET=$i386TARGET
+  MACSDKDIR=$i386MACSDKDIR
+  ARCHARGs="$i386ONLYARG"
+ elif [ $ARCH = "ppc" -o $ARCH = "ppc750" -o $ARCH = "ppc7400" ]
+ then
+  TARGET=$ppcTARGET
+  MACSDKDIR=$ppcMACSDKDIR
+  ARCHARGs="$ppcONLYARG"
+ elif [ $ARCH = "ppc64" -o $ARCH = "ppc970" ]
+ then
+  TARGET=$ppc64TARGET
+  MACSDKDIR=$ppc64MACSDKDIR
+  ARCHARGs="$ppc64ONLYARG"
+ elif [ $ARCH = "x86_64" ]
+ then
+  TARGET=$x64TARGET
+  MACSDKDIR=$x64MACSDKDIR
+  ARCHARGs="$x64ONLYARG"
+ fi
+
+ # first patch the make file
+
+
+ env CFLAGS="-isysroot $MACSDKDIR -arch $ARCH $ARCHARGs $OTHERARGs -O2 -dead_strip" \
+  CXXFLAGS="-isysroot $MACSDKDIR -arch $ARCH $ARCHARGs $OTHERARGs -O2 -dead_strip" \
+  CPPFLAGS="-I$REPOSITORYDIR/include -no-cpp-precomp" \
+  LDFLAGS="-L$REPOSITORYDIR/lib -dead_strip" \
+  NEXT_ROOT="$MACSDKDIR" \
+  PKG_CONFIG_PATH=$REPOSITORYDIR/lib/pkgconfig \
+  ./configure --prefix="$REPOSITORYDIR" \
+  --host="$TARGET" --target="$TARGET" --without-python --exec-prefix=$REPOSITORYDIR/arch/$ARCH \
+  --enable-shared \
+;
+
+
+ make clean;
+ make;
+ make install;
+
+done
+
+
+# merge libxml2
+
+for liba in lib/libxml2.a lib/libxml2.$FULL_LIB_VER.dylib   
+do
+
+ if [ $NUMARCH -eq 1 ]
+ then
+  mv "$REPOSITORYDIR/arch/$ARCHS/$liba" "$REPOSITORYDIR/$liba";
+  ranlib "$REPOSITORYDIR/$liba";
+  continue
+ fi
+
+ LIPOARGs=""
+ 
+ for ARCH in $ARCHS
+ do
+  LIPOARGs="$LIPOARGs $REPOSITORYDIR/arch/$ARCH/$liba"
+ done
+
+ lipo $LIPOARGs -create -output "$REPOSITORYDIR/$liba";
+ ranlib "$REPOSITORYDIR/$liba";
+
+done
+
+if [ -f "$REPOSITORYDIR/lib/libxml2.$FULL_LIB_VER.dylib" ]
+then
+ install_name_tool -id "$REPOSITORYDIR/lib/libxml2.$FULL_LIB_VER.dylib" "$REPOSITORYDIR/lib/libxml2.$FULL_LIB_VER.dylib";
+ ln -sfn libxml2.$FULL_LIB_VER.dylib $REPOSITORYDIR/lib/libxml2.$MAIN_LIB_VER.dylib;
+ ln -sfn libxml2.$FULL_LIB_VER.dylib $REPOSITORYDIR/lib/libxml2.dylib;
+fi
+
+#pkgconfig
+for ARCH in $ARCHS
+do
+ mkdir -p "$REPOSITORYDIR/lib/pkgconfig";
+ sed 's/^exec_prefix.*$/exec_prefix=\$\{prefix\}/' "$REPOSITORYDIR/arch/$ARCH/lib/pkgconfig/libxml-2.0.pc" > "$REPOSITORYDIR/lib/pkgconfig/libxml-2.0.pc";
+ break;
+done
+

Added: branches/avidemux_2.5_branch_gruntster/platforms/mac/External_libs/scripts/0200-pixman.sh
===================================================================
--- branches/avidemux_2.5_branch_gruntster/platforms/mac/External_libs/scripts/0200-pixman.sh	2009-02-07 14:34:30 UTC (rev 4578)
+++ branches/avidemux_2.5_branch_gruntster/platforms/mac/External_libs/scripts/0200-pixman.sh	2009-02-08 17:04:43 UTC (rev 4579)
@@ -0,0 +1,142 @@
+# ------------------
+#     libpixman
+# ------------------
+# Based on the works of (c) 2007, Ippei Ukai
+# Modified for avidemux by Harry van der Wolf 200806
+
+# download location http://cairographics.org/releases/
+
+# prepare
+
+# export REPOSITORYDIR="/PATH2HUGIN/mac/ExternalPrograms/repository" \
+# ARCHS="ppc i386" \
+# ppcTARGET="powerpc-apple-darwin7" \
+# i386TARGET="i386-apple-darwin8" \
+#  ppcMACSDKDIR="/Developer/SDKs/MacOSX10.4u.sdk" \
+#  i386MACSDKDIR="/Developer/SDKs/MacOSX10.3.9.sdk" \
+#  ppcONLYARG="-mcpu=G3 -mtune=G4" \
+#  i386ONLYARG="-mfpmath=sse -msse2 -mtune=pentium-m -ftree-vectorize" \
+#  OTHERARGs="";
+
+
+# init
+
+let NUMARCH="0"
+
+for i in $ARCHS
+do
+  NUMARCH=$(($NUMARCH + 1))
+done
+
+mkdir -p "$REPOSITORYDIR/bin";
+mkdir -p "$REPOSITORYDIR/lib";
+mkdir -p "$REPOSITORYDIR/include";
+
+MAIN_LIB_VER="1.0"
+FULL_LIB_VER="$MAIN_LIB_VER.11.6"
+
+
+
+# compile
+
+for ARCH in $ARCHS
+do
+
+ mkdir -p "$REPOSITORYDIR/arch/$ARCH/bin";
+ mkdir -p "$REPOSITORYDIR/arch/$ARCH/lib";
+ mkdir -p "$REPOSITORYDIR/arch/$ARCH/include";
+
+ ARCHARGs=""
+ MACSDKDIR=""
+ OTHERMAKEARGs=""
+
+ if [ $ARCH = "i386" -o $ARCH = "i686" ]
+ then
+  TARGET=$i386TARGET
+  MACSDKDIR=$i386MACSDKDIR
+  ARCHARGs="$i386ONLYARG"
+ elif [ $ARCH = "ppc" -o $ARCH = "ppc750" -o $ARCH = "ppc7400" ]
+ then
+  TARGET=$ppcTARGET
+  MACSDKDIR=$ppcMACSDKDIR
+  ARCHARGs="$ppcONLYARG"
+ elif [ $ARCH = "ppc64" -o $ARCH = "ppc970" ]
+ then
+  TARGET=$ppc64TARGET
+  MACSDKDIR=$ppc64MACSDKDIR
+  ARCHARGs="$ppc64ONLYARG"
+ elif [ $ARCH = "x86_64" ]
+ then
+  TARGET=$x64TARGET
+  MACSDKDIR=$x64MACSDKDIR
+  ARCHARGs="$x64ONLYARG"
+ fi
+
+export PATH=/usr/bin:$PATH
+
+ env CFLAGS="-isysroot $MACSDKDIR -arch $ARCH $ARCHARGs $OTHERARGs -O2 -dead_strip" \
+  CXXFLAGS="-isysroot $MACSDKDIR -arch $ARCH $ARCHARGs $OTHERARGs -O2 -dead_strip" \
+  CPPFLAGS="-I$REPOSITORYDIR/include" \
+  LDFLAGS="-L$REPOSITORYDIR/lib -dead_strip" \
+  NEXT_ROOT="$MACSDKDIR" \
+  PKG_CONFIG_PATH=$REPOSITORYDIR/lib/pkgconfig \
+ ./configure --prefix="$REPOSITORYDIR" --disable-dependency-tracking \
+  --host="$TARGET" --exec-prefix=$REPOSITORYDIR/arch/$ARCH CC="gcc -arch $ARCH" \
+  --enable-static --enable-shared ;
+
+ make clean;
+ make $OTHERMAKEARGs;
+ make $OTHERMAKEARGs install;
+
+done
+
+
+# merge libpixman
+
+for liba in lib/libpixman-1.a lib/libpixman-$FULL_LIB_VER.dylib 
+do
+
+ if [ $NUMARCH -eq 1 ]
+ then
+  mv "$REPOSITORYDIR/arch/$ARCHS/$liba" "$REPOSITORYDIR/$liba";
+  if [[ $liba == *.a ]]
+  then 
+   ranlib "$REPOSITORYDIR/$liba";
+  fi
+  continue
+ fi
+
+ LIPOARGs=""
+ 
+ for ARCH in $ARCHS
+ do
+  LIPOARGs="$LIPOARGs $REPOSITORYDIR/arch/$ARCH/$liba"
+ done
+
+ lipo $LIPOARGs -create -output "$REPOSITORYDIR/$liba";
+ if [[ $liba == *.a ]]
+ then 
+  ranlib "$REPOSITORYDIR/$liba";
+ fi
+
+done
+
+
+if [ -f "$REPOSITORYDIR/lib/libpixman-$FULL_LIB_VER.dylib" ]
+then
+ install_name_tool -id "$REPOSITORYDIR/lib/libpixman-$FULL_LIB_VER.dylib" "$REPOSITORYDIR/lib/libpixman-$FULL_LIB_VER.dylib";
+ ln -sfn libpixman-$FULL_LIB_VER.dylib $REPOSITORYDIR/lib/libpixman-$MAIN_LIB_VER.dylib;
+ ln -sfn libpixman-$FULL_LIB_VER.dylib $REPOSITORYDIR/lib/libpixman.dylib;
+fi
+
+#pkgconfig
+for ARCH in $ARCHS
+do
+ mkdir -p "$REPOSITORYDIR/lib/pkgconfig";
+ sed 's/^exec_prefix.*$/exec_prefix=\$\{prefix\}/' "$REPOSITORYDIR/arch/$ARCH/lib/pkgconfig/pixman-1.pc" > "$REPOSITORYDIR/lib/pkgconfig/pixman-1.pc";
+ break;
+done
+
+
+
+

Added: branches/avidemux_2.5_branch_gruntster/platforms/mac/External_libs/scripts/0201-libcairo-quartz.sh
===================================================================
--- branches/avidemux_2.5_branch_gruntster/platforms/mac/External_libs/scripts/0201-libcairo-quartz.sh	2009-02-07 14:34:30 UTC (rev 4578)
+++ branches/avidemux_2.5_branch_gruntster/platforms/mac/External_libs/scripts/0201-libcairo-quartz.sh	2009-02-08 17:04:43 UTC (rev 4579)
@@ -0,0 +1,149 @@
+# ------------------
+#     libcairo
+# ------------------
+# Based on the works of (c) 2007, Ippei Ukai
+# Modified for avidemux by Harry van der Wolf 200806
+
+# download location http://cairographics.org/releases/
+
+# prepare
+
+# export REPOSITORYDIR="/PATH2HUGIN/mac/ExternalPrograms/repository" \
+# ARCHS="ppc i386" \
+# ppcTARGET="powerpc-apple-darwin7" \
+# i386TARGET="i386-apple-darwin8" \
+#  ppcMACSDKDIR="/Developer/SDKs/MacOSX10.4u.sdk" \
+#  i386MACSDKDIR="/Developer/SDKs/MacOSX10.3.9.sdk" \
+#  ppcONLYARG="-mcpu=G3 -mtune=G4" \
+#  i386ONLYARG="-mfpmath=sse -msse2 -mtune=pentium-m -ftree-vectorize" \
+#  OTHERARGs="";
+
+
+# init
+
+let NUMARCH="0"
+
+for i in $ARCHS
+do
+  NUMARCH=$(($NUMARCH + 1))
+done
+
+mkdir -p "$REPOSITORYDIR/bin";
+mkdir -p "$REPOSITORYDIR/lib";
+mkdir -p "$REPOSITORYDIR/include";
+
+MAIN_LIB_VER="2"
+FULL_LIB_VER="$MAIN_LIB_VER.17.5"
+
+
+
+# compile
+
+for ARCH in $ARCHS
+do
+
+ mkdir -p "$REPOSITORYDIR/arch/$ARCH/bin";
+ mkdir -p "$REPOSITORYDIR/arch/$ARCH/lib";
+ mkdir -p "$REPOSITORYDIR/arch/$ARCH/include";
+
+ ARCHARGs=""
+ MACSDKDIR=""
+ OTHERMAKEARGs=""
+
+ if [ $ARCH = "i386" -o $ARCH = "i686" ]
+ then
+  TARGET=$i386TARGET
+  MACSDKDIR=$i386MACSDKDIR
+  ARCHARGs="$i386ONLYARG"
+ elif [ $ARCH = "ppc" -o $ARCH = "ppc750" -o $ARCH = "ppc7400" ]
+ then
+  TARGET=$ppcTARGET
+  MACSDKDIR=$ppcMACSDKDIR
+  ARCHARGs="$ppcONLYARG"
+ elif [ $ARCH = "ppc64" -o $ARCH = "ppc970" ]
+ then
+  TARGET=$ppc64TARGET
+  MACSDKDIR=$ppc64MACSDKDIR
+  ARCHARGs="$ppc64ONLYARG"
+ elif [ $ARCH = "x86_64" ]
+ then
+  TARGET=$x64TARGET
+  MACSDKDIR=$x64MACSDKDIR
+  ARCHARGs="$x64ONLYARG"
+ fi
+
+export PATH=/usr/bin:$REPOSITORYDIR/bin:$PATH
+
+
+ env CFLAGS="-isysroot $MACSDKDIR -O2" \
+  CXXFLAGS="-isysroot $MACSDKDIR -O2" \
+  CPPFLAGS="-I$REPOSITORYDIR/include -I/usr/include" \
+  LDFLAGS="-L$REPOSITORYDIR/lib -L/usr/lib" \
+  NEXT_ROOT="$MACSDKDIR" \
+  PKG_CONFIG_PATH="$REPOSITORYDIR/lib/pkgconfig" \
+  ./configure --prefix="$REPOSITORYDIR"  --disable-dependency-tracking \
+  --host="$TARGET" --exec-prefix=$REPOSITORYDIR/arch/$ARCH CC="gcc -arch $ARCH"\
+  --enable-quartz --enable-atsui --without-x \
+;
+
+ make clean;
+ make $OTHERMAKEARGs;
+ make $OTHERMAKEARGs install;
+
+done
+
+
+# merge libcairo
+
+for liba in lib/libcairo.a lib/libcairo.$FULL_LIB_VER.dylib 
+do
+
+ if [ $NUMARCH -eq 1 ]
+ then
+  mv "$REPOSITORYDIR/arch/$ARCHS/$liba" "$REPOSITORYDIR/$liba";
+  if [[ $liba == *.a ]]
+  then 
+   ranlib "$REPOSITORYDIR/$liba";
+  fi
+  continue
+ fi
+
+ LIPOARGs=""
+ 
+ for ARCH in $ARCHS
+ do
+  LIPOARGs="$LIPOARGs $REPOSITORYDIR/arch/$ARCH/$liba"
+ done
+
+ lipo $LIPOARGs -create -output "$REPOSITORYDIR/$liba";
+ if [[ $liba == *.a ]]
+ then 
+  ranlib "$REPOSITORYDIR/$liba";
+ fi
+
+done
+
+
+if [ -f "$REPOSITORYDIR/lib/libcairo.$FULL_LIB_VER.dylib" ]
+then
+ install_name_tool -id "$REPOSITORYDIR/lib/libcairo.$FULL_LIB_VER.dylib" "$REPOSITORYDIR/lib/libcairo.$FULL_LIB_VER.dylib";
+ ln -sfn libcairo.$FULL_LIB_VER.dylib $REPOSITORYDIR/lib/libcairo.$MAIN_LIB_VER.dylib;
+ ln -sfn libcairo.$FULL_LIB_VER.dylib $REPOSITORYDIR/lib/libcairo.dylib;
+fi
+
+#pkgconfig
+for ARCH in $ARCHS
+do
+ mkdir -p "$REPOSITORYDIR/lib/pkgconfig";
+ sed 's/^exec_prefix.*$/exec_prefix=\$\{prefix\}/' "$REPOSITORYDIR/arch/$ARCH/lib/pkgconfig/cairo-pdf.pc" > "$REPOSITORYDIR/lib/pkgconfig/cairo-pdf.pc";
+ sed 's/^exec_prefix.*$/exec_prefix=\$\{prefix\}/' "$REPOSITORYDIR/arch/$ARCH/lib/pkgconfig/cairo-png.pc" > "$REPOSITORYDIR/lib/pkgconfig/cairo-png.pc";
+ sed 's/^exec_prefix.*$/exec_prefix=\$\{prefix\}/' "$REPOSITORYDIR/arch/$ARCH/lib/pkgconfig/cairo-ps.pc" > "$REPOSITORYDIR/lib/pkgconfig/cairo-ps.pc";
+ sed 's/^exec_prefix.*$/exec_prefix=\$\{prefix\}/' "$REPOSITORYDIR/arch/$ARCH/lib/pkgconfig/cairo-quartz.pc" > "$REPOSITORYDIR/lib/pkgconfig/cairo-quartz.pc";
+ sed 's/^exec_prefix.*$/exec_prefix=\$\{prefix\}/' "$REPOSITORYDIR/arch/$ARCH/lib/pkgconfig/cairo-svg.pc" > "$REPOSITORYDIR/lib/pkgconfig/cairo-svg.pc";
+ sed 's/^exec_prefix.*$/exec_prefix=\$\{prefix\}/' "$REPOSITORYDIR/arch/$ARCH/lib/pkgconfig/cairo.pc" > "$REPOSITORYDIR/lib/pkgconfig/cairo.pc";
+ break;
+done
+
+
+
+

Added: branches/avidemux_2.5_branch_gruntster/platforms/mac/External_libs/scripts/0205-libglib.sh
===================================================================
--- branches/avidemux_2.5_branch_gruntster/platforms/mac/External_libs/scripts/0205-libglib.sh	2009-02-07 14:34:30 UTC (rev 4578)
+++ branches/avidemux_2.5_branch_gruntster/platforms/mac/External_libs/scripts/0205-libglib.sh	2009-02-08 17:04:43 UTC (rev 4579)
@@ -0,0 +1,208 @@
+# ------------------
+#     libglib
+# ------------------
+# Based on the works of (c) 2007, Ippei Ukai
+# Modified for avidemux by Harry van der Wolf 200806
+
+# download location ftp://ftp.gtk.org/pub/glib/
+
+# prepare
+
+# export REPOSITORYDIR="/PATH2HUGIN/mac/ExternalPrograms/repository" \
+# ARCHS="ppc i386" \
+# ppcTARGET="powerpc-apple-darwin7" \
+# i386TARGET="i386-apple-darwin8" \
+#  ppcMACSDKDIR="/Developer/SDKs/MacOSX10.4u.sdk" \
+#  i386MACSDKDIR="/Developer/SDKs/MacOSX10.3.9.sdk" \
+#  ppcONLYARG="-mcpu=G3 -mtune=G4" \
+#  i386ONLYARG="-mfpmath=sse -msse2 -mtune=pentium-m -ftree-vectorize" \
+#  OTHERARGs="";
+
+
+# init
+
+let NUMARCH="0"
+
+for i in $ARCHS
+do
+  NUMARCH=$(($NUMARCH + 1))
+done
+
+mkdir -p "$REPOSITORYDIR/bin";
+mkdir -p "$REPOSITORYDIR/lib";
+mkdir -p "$REPOSITORYDIR/include";
+
+MAIN_LIB_VER="2.0"
+EXT_MAIN_LIB_VER="2.0.0"
+FULL_LIB_VER="$EXT_MAIN_LIB_VER.1400.5"
+
+
+
+# compile
+
+for ARCH in $ARCHS
+do
+
+ mkdir -p "$REPOSITORYDIR/arch/$ARCH/bin";
+ mkdir -p "$REPOSITORYDIR/arch/$ARCH/lib";
+ mkdir -p "$REPOSITORYDIR/arch/$ARCH/include";
+
+ ARCHARGs=""
+ MACSDKDIR=""
+ OTHERARGs="-funroll-loops -fstrict-aliasing"
+ OTHERMAKEARGs=""
+
+ if [ $ARCH = "i386" -o $ARCH = "i686" ]
+ then
+  TARGET=$i386TARGET
+  MACSDKDIR=$i386MACSDKDIR
+  ARCHARGs="$i386ONLYARG"
+ elif [ $ARCH = "ppc" -o $ARCH = "ppc750" -o $ARCH = "ppc7400" ]
+ then
+  TARGET=$ppcTARGET
+  MACSDKDIR=$ppcMACSDKDIR
+  ARCHARGs="$ppcONLYARG"
+ elif [ $ARCH = "ppc64" -o $ARCH = "ppc970" ]
+ then
+  TARGET=$ppc64TARGET
+  MACSDKDIR=$ppc64MACSDKDIR
+  ARCHARGs="$ppc64ONLYARG"
+ elif [ $ARCH = "x86_64" ]
+ then
+  TARGET=$x64TARGET
+  MACSDKDIR=$x64MACSDKDIR
+  ARCHARGs="$x64ONLYARG"
+ fi
+
+ export PATH=/usr/bin:$REPOSITORYDIR/bin:$PATH
+
+ env CFLAGS="-isysroot $MACSDKDIR -arch $ARCH $ARCHARGs $OTHERARGs -O2" \
+  CXXFLAGS="-isysroot $MACSDKDIR -arch $ARCH $ARCHARGs $OTHERARGs -O2" \
+  CPPFLAGS="-I$REPOSITORYDIR/arch/$ARCH/include -I$REPOSITORYDIR/include -I/usr/include" \
+  LDFLAGS="-L$REPOSITORYDIR/arch/$ARCH/lib -L$REPOSITORYDIR/lib -L/usr/lib -dead_strip -bind_at_load" \
+  NEXT_ROOT="$MACSDKDIR" \
+  PKG_CONFIG_PATH="$REPOSITORYDIR/lib/pkgconfig" \
+  ./configure --disable-gtk-doc --disable-html --prefix="$REPOSITORYDIR"  --disable-dependency-tracking \
+  --host="$TARGET" --exec-prefix=$REPOSITORYDIR/arch/$ARCH  --with-libiconv --enable-shared --enable-static\
+ ;
+
+
+ make clean;
+  make $OTHERMAKEARGs;
+ make $OTHERMAKEARGs install;
+
+done
+
+
+# merge libglib
+
+for liba in lib/libglib-2.0.a lib/libgobject-2.0.a lib/libgthread-2.0.a lib/libgmodule-2.0.a lib/libglib-$FULL_LIB_VER.dylib lib/libgmodule-$FULL_LIB_VER.dylib lib/libgobject-$FULL_LIB_VER.dylib lib/libgthread-$FULL_LIB_VER.dylib
+do
+
+ if [ $NUMARCH -eq 1 ]
+ then
+  mv "$REPOSITORYDIR/arch/$ARCHS/$liba" "$REPOSITORYDIR/$liba";
+  if [[ $liba == *.a ]]
+  then 
+   ranlib "$REPOSITORYDIR/$liba";
+  fi
+  continue
+ fi
+
+ LIPOARGs=""
+ 
+ for ARCH in $ARCHS
+ do
+  LIPOARGs="$LIPOARGs $REPOSITORYDIR/arch/$ARCH/$liba"
+ done
+
+ lipo $LIPOARGs -create -output "$REPOSITORYDIR/$liba";
+ if [[ $liba == *.a ]]
+ then 
+  ranlib "$REPOSITORYDIR/$liba";
+ fi
+
+done
+
+
+if [ -f "$REPOSITORYDIR/lib/libglib-$FULL_LIB_VER.dylib" ]
+then
+ install_name_tool -id "$REPOSITORYDIR/lib/libglib-$FULL_LIB_VER.dylib" "$REPOSITORYDIR/lib/libglib-$FULL_LIB_VER.dylib";
+ ln -sfn libglib-$FULL_LIB_VER.dylib $REPOSITORYDIR/lib/libglib-$EXT_MAIN_LIB_VER.dylib;
+ ln -sfn libglib-$FULL_LIB_VER.dylib $REPOSITORYDIR/lib/libglib-$MAIN_LIB_VER.dylib;
+ ln -sfn libglib-$FULL_LIB_VER.dylib $REPOSITORYDIR/lib/libglib-dylib;
+fi
+
+if [ -f "$REPOSITORYDIR/lib/libgmodule-$FULL_LIB_VER.dylib" ]
+then
+ install_name_tool -id "$REPOSITORYDIR/lib/libgmodule-$FULL_LIB_VER.dylib" "$REPOSITORYDIR/lib/libgmodule-$FULL_LIB_VER.dylib";
+ ln -sfn libgmodule-$FULL_LIB_VER.dylib $REPOSITORYDIR/lib/libgmodule-$EXT_MAIN_LIB_VER.dylib;
+ ln -sfn libgmodule-$FULL_LIB_VER.dylib $REPOSITORYDIR/lib/libgmodule-$MAIN_LIB_VER.dylib;
+ ln -sfn libgmodule-$FULL_LIB_VER.dylib $REPOSITORYDIR/lib/libgmodule-dylib;
+fi
+
+if [ -f "$REPOSITORYDIR/lib/libgobject-$FULL_LIB_VER.dylib" ]
+then
+ install_name_tool -id "$REPOSITORYDIR/lib/libgobject-$FULL_LIB_VER.dylib" "$REPOSITORYDIR/lib/libgobject-$FULL_LIB_VER.dylib";
+ ln -sfn libgobject-$FULL_LIB_VER.dylib $REPOSITORYDIR/lib/libgobject-$EXT_MAIN_LIB_VER.dylib;
+ ln -sfn libgobject-$FULL_LIB_VER.dylib $REPOSITORYDIR/lib/libgobject-$MAIN_LIB_VER.dylib;
+ ln -sfn libgobject-$FULL_LIB_VER.dylib $REPOSITORYDIR/lib/libgobject-dylib;
+fi
+
+if [ -f "$REPOSITORYDIR/lib/libgthread-$FULL_LIB_VER.dylib" ]
+then
+ install_name_tool -id "$REPOSITORYDIR/lib/libgthread-$FULL_LIB_VER.dylib" "$REPOSITORYDIR/lib/libgthread-$FULL_LIB_VER.dylib";
+ ln -sfn libgthread-$FULL_LIB_VER.dylib $REPOSITORYDIR/lib/libgthread-$EXT_MAIN_LIB_VER.dylib;
+ ln -sfn libgthread-$FULL_LIB_VER.dylib $REPOSITORYDIR/lib/libgthread-$MAIN_LIB_VER.dylib;
+ ln -sfn libgthread-$FULL_LIB_VER.dylib $REPOSITORYDIR/lib/libgthread-dylib;
+fi
+
+# Create directory structure for big_endian / little_endian
+mkdir -p $REPOSITORYDIR/lib/glib-$MAIN_LIB_VER $REPOSITORYDIR/lib/glib-$MAIN_LIB_VER/include
+
+#pkgconfig
+for ARCH in $ARCHS
+do
+ mkdir -p "$REPOSITORYDIR/lib/pkgconfig";
+ sed 's/^exec_prefix.*$/exec_prefix=\$\{prefix\}/' "$REPOSITORYDIR/arch/$ARCH/lib/pkgconfig/glib-2.0.pc" > "$REPOSITORYDIR/lib/pkgconfig/glib-2.0.pc";
+ sed 's/^exec_prefix.*$/exec_prefix=\$\{prefix\}/' "$REPOSITORYDIR/arch/$ARCH/lib/pkgconfig/gmodule-2.0.pc" > "$REPOSITORYDIR/lib/pkgconfig/gmodule-2.0.pc";
+ sed 's/^exec_prefix.*$/exec_prefix=\$\{prefix\}/' "$REPOSITORYDIR/arch/$ARCH/lib/pkgconfig/gmodule-export-2.0.pc" > "$REPOSITORYDIR/lib/pkgconfig/gmodule-export-2.0.pc";
+ sed 's/^exec_prefix.*$/exec_prefix=\$\{prefix\}/' "$REPOSITORYDIR/arch/$ARCH/lib/pkgconfig/gmodule-no-export-2.0.pc" > "$REPOSITORYDIR/lib/pkgconfig/gmodule-no-export-2.0.pc";
+ sed 's/^exec_prefix.*$/exec_prefix=\$\{prefix\}/' "$REPOSITORYDIR/arch/$ARCH/lib/pkgconfig/gobject-2.0.pc" > "$REPOSITORYDIR/lib/pkgconfig/gobject-2.0.pc";
+ sed 's/^exec_prefix.*$/exec_prefix=\$\{prefix\}/' "$REPOSITORYDIR/arch/$ARCH/lib/pkgconfig/gthread-2.0.pc" > "$REPOSITORYDIR/lib/pkgconfig/gthread-2.0.pc";
+ break;
+done
+
+#Copy shell script
+for ARCH in $ARCHS
+do
+ mkdir -p "$REPOSITORYDIR/bin";
+ cp "$REPOSITORYDIR/arch/$ARCH/bin/glib-mkenums" "$REPOSITORYDIR/bin/glib-mkenums";
+ cp "$REPOSITORYDIR/arch/$ARCH/bin/glib-gettextize" "$REPOSITORYDIR/bin/glib-gettextize";
+ break;
+done
+
+# merge execs
+for program in bin/glib-genmarshal bin/gobject-query
+do
+
+ if [ $NUMARCH -eq 1 ]
+ then
+  mv "$REPOSITORYDIR/arch/$ARCHS/$program" "$REPOSITORYDIR/$program";
+  strip "$REPOSITORYDIR/$program";
+  continue
+ fi
+
+ LIPOARGs=""
+
+ for ARCH in $ARCHS
+ do
+  LIPOARGs="$LIPOARGs $REPOSITORYDIR/arch/$ARCH/$program"
+ done
+
+ lipo $LIPOARGs -create -output "$REPOSITORYDIR/$program";
+
+ strip "$REPOSITORYDIR/$program";
+
+done
+

Added: branches/avidemux_2.5_branch_gruntster/platforms/mac/External_libs/scripts/0210-libatk.sh
===================================================================
--- branches/avidemux_2.5_branch_gruntster/platforms/mac/External_libs/scripts/0210-libatk.sh	2009-02-07 14:34:30 UTC (rev 4578)
+++ branches/avidemux_2.5_branch_gruntster/platforms/mac/External_libs/scripts/0210-libatk.sh	2009-02-08 17:04:43 UTC (rev 4579)
@@ -0,0 +1,145 @@
+# ------------------
+#     libatk
+# ------------------
+# Based on the works of (c) 2007, Ippei Ukai
+# Modified for avidemux by Harry van der Wolf 200806
+
+# download location http://ftp.gnome.org/pub/gnome/sources/atk/
+
+# prepare
+
+# export REPOSITORYDIR="/PATH2HUGIN/mac/ExternalPrograms/repository" \
+# ARCHS="ppc i386" \
+# ppcTARGET="powerpc-apple-darwin7" \
+# i386TARGET="i386-apple-darwin8" \
+#  ppcMACSDKDIR="/Developer/SDKs/MacOSX10.4u.sdk" \
+#  i386MACSDKDIR="/Developer/SDKs/MacOSX10.3.9.sdk" \
+#  ppcONLYARG="-mcpu=G3 -mtune=G4" \
+#  i386ONLYARG="-mfpmath=sse -msse2 -mtune=pentium-m -ftree-vectorize" \
+#  OTHERARGs="";
+
+
+# init
+
+let NUMARCH="0"
+
+for i in $ARCHS
+do
+  NUMARCH=$(($NUMARCH + 1))
+done
+
+mkdir -p "$REPOSITORYDIR/bin";
+mkdir -p "$REPOSITORYDIR/lib";
+mkdir -p "$REPOSITORYDIR/include";
+
+MAIN_LIB_VER="1.0"
+EXT_MAIN_LIB_VER="1.0.0"
+FULL_LIB_VER="$EXT_MAIN_LIB_VER.2209.1"
+
+
+
+# compile
+
+for ARCH in $ARCHS
+do
+
+ mkdir -p "$REPOSITORYDIR/arch/$ARCH/bin";
+ mkdir -p "$REPOSITORYDIR/arch/$ARCH/lib";
+ mkdir -p "$REPOSITORYDIR/arch/$ARCH/include";
+
+ ARCHARGs=""
+ MACSDKDIR=""
+ OTHERARGs="-funroll-loops -fstrict-aliasing"
+ OTHERMAKEARGs=""
+
+ if [ $ARCH = "i386" -o $ARCH = "i686" ]
+ then
+  TARGET=$i386TARGET
+  MACSDKDIR=$i386MACSDKDIR
+  ARCHARGs="$i386ONLYARG"
+ elif [ $ARCH = "ppc" -o $ARCH = "ppc750" -o $ARCH = "ppc7400" ]
+ then
+  TARGET=$ppcTARGET
+  MACSDKDIR=$ppcMACSDKDIR
+  ARCHARGs="$ppcONLYARG"
+ elif [ $ARCH = "ppc64" -o $ARCH = "ppc970" ]
+ then
+  TARGET=$ppc64TARGET
+  MACSDKDIR=$ppc64MACSDKDIR
+  ARCHARGs="$ppc64ONLYARG"
+ elif [ $ARCH = "x86_64" ]
+ then
+  TARGET=$x64TARGET
+  MACSDKDIR=$x64MACSDKDIR
+  ARCHARGs="$x64ONLYARG"
+ fi
+
+ export PATH=/usr/bin:$REPOSITORYDIR/bin:$PATH
+
+ env CFLAGS="-isysroot $MACSDKDIR -arch $ARCH $ARCHARGs $OTHERARGs -O2" \
+  CXXFLAGS="-isysroot $MACSDKDIR -arch $ARCH $ARCHARGs $OTHERARGs -O2" \
+  CPPFLAGS="-I$REPOSITORYDIR/arch/$ARCH/include -I$REPOSITORYDIR/include -I/usr/include" \
+  LDFLAGS="-L$REPOSITORYDIR/lib -L$REPOSITORYDIR/arch/$ARCH/lib -L/usr/lib -dead_strip" \
+  NEXT_ROOT="$MACSDKDIR" \
+  PKG_CONFIG_PATH="$REPOSITORYDIR/arch/$ARCH/lib/pkgconfig" \
+  ./configure --prefix="$REPOSITORYDIR"  --disable-dependency-tracking \
+  --host="$TARGET" --exec-prefix=$REPOSITORYDIR/arch/$ARCH \
+  --enable-shared --enable-static \
+ ;
+
+
+ make clean;
+  make $OTHERMAKEARGs;
+ make $OTHERMAKEARGs install;
+
+done
+
+
+# merge libatk
+
+for liba in lib/libatk-1.0.a lib/libatk-$FULL_LIB_VER.dylib 
+do
+
+ if [ $NUMARCH -eq 1 ]
+ then
+  mv "$REPOSITORYDIR/arch/$ARCHS/$liba" "$REPOSITORYDIR/$liba";
+  if [[ $liba == *.a ]]
+  then 
+   ranlib "$REPOSITORYDIR/$liba";
+  fi
+  continue
+ fi
+
+ LIPOARGs=""
+ 
+ for ARCH in $ARCHS
+ do
+  LIPOARGs="$LIPOARGs $REPOSITORYDIR/arch/$ARCH/$liba"
+ done
+
+ lipo $LIPOARGs -create -output "$REPOSITORYDIR/$liba";
+ if [[ $liba == *.a ]]
+ then 
+  ranlib "$REPOSITORYDIR/$liba";
+ fi
+
+done
+
+
+if [ -f "$REPOSITORYDIR/lib/libatk-$FULL_LIB_VER.dylib" ]
+then
+ install_name_tool -id "$REPOSITORYDIR/lib/libatk-$FULL_LIB_VER.dylib" "$REPOSITORYDIR/lib/libatk-$FULL_LIB_VER.dylib";
+ ln -sfn libatk-$FULL_LIB_VER.dylib $REPOSITORYDIR/lib/libatk-$EXT_MAIN_LIB_VER.dylib;
+ ln -sfn libatk-$FULL_LIB_VER.dylib $REPOSITORYDIR/lib/libatk-$MAIN_LIB_VER.dylib;
+ #ln -sfn libatk-$FULL_LIB_VER.dylib $REPOSITORYDIR/lib/libatk.dylib;
+fi
+
+#pkgconfig
+for ARCH in $ARCHS
+do
+ mkdir -p "$REPOSITORYDIR/lib/pkgconfig";
+ sed 's/^exec_prefix.*$/exec_prefix=\$\{prefix\}/' "$REPOSITORYDIR/arch/$ARCH/lib/pkgconfig/atk.pc" > "$REPOSITORYDIR/lib/pkgconfig/atk.pc";
+ break;
+done
+
+

Added: branches/avidemux_2.5_branch_gruntster/platforms/mac/External_libs/scripts/0214-patch-pango.sh
===================================================================
--- branches/avidemux_2.5_branch_gruntster/platforms/mac/External_libs/scripts/0214-patch-pango.sh	2009-02-07 14:34:30 UTC (rev 4578)
+++ branches/avidemux_2.5_branch_gruntster/platforms/mac/External_libs/scripts/0214-patch-pango.sh	2009-02-08 17:04:43 UTC (rev 4579)
@@ -0,0 +1,10 @@
+# ------------------
+#    patch pango 
+# ------------------
+# Harry van der Wolf, 2008 07
+
+# This script will patch pango for OSX 
+# It needs to be run once
+
+patch -p0 <  "$REPOSITORYDIR/../scripts/patches/pango-patch-ltmain.sh.diff" 
+

Added: branches/avidemux_2.5_branch_gruntster/platforms/mac/External_libs/scripts/0215-libpango-quartz.sh
===================================================================
--- branches/avidemux_2.5_branch_gruntster/platforms/mac/External_libs/scripts/0215-libpango-quartz.sh	2009-02-07 14:34:30 UTC (rev 4578)
+++ branches/avidemux_2.5_branch_gruntster/platforms/mac/External_libs/scripts/0215-libpango-quartz.sh	2009-02-08 17:04:43 UTC (rev 4579)
@@ -0,0 +1,198 @@
+# ------------------
+#     libpango
+# ------------------
+# Based on the works of (c) 2007, Ippei Ukai
+# Created for avidemux by Harry van der Wolf
+
+# download location http://ftp.gnome.org/pub/GNOME/sources/pango
+
+# prepare
+
+# export REPOSITORYDIR="/PATH2HUGIN/mac/ExternalPrograms/repository" \
+# ARCHS="ppc i386" \
+# ppcTARGET="powerpc-apple-darwin7" \
+# i386TARGET="i386-apple-darwin8" \
+#  ppcMACSDKDIR="/Developer/SDKs/MacOSX10.4u.sdk" \
+#  i386MACSDKDIR="/Developer/SDKs/MacOSX10.3.9.sdk" \
+#  ppcONLYARG="-mcpu=G3 -mtune=G4" \
+#  i386ONLYARG="-mfpmath=sse -msse2 -mtune=pentium-m -ftree-vectorize" \
+#  OTHERARGs="";
+
+
+# init
+
+let NUMARCH="0"
+
+for i in $ARCHS
+do
+  NUMARCH=$(($NUMARCH + 1))
+done
+
+mkdir -p "$REPOSITORYDIR/bin";
+mkdir -p "$REPOSITORYDIR/lib";
+mkdir -p "$REPOSITORYDIR/include";
+
+MAIN_LIB_VER="1.0"
+EXT_MAIN_LIB_VER="1.0.0"
+FULL_LIB_VER="$EXT_MAIN_LIB_VER.2002.1"
+
+
+
+# compile
+
+for ARCH in $ARCHS
+do
+
+ mkdir -p "$REPOSITORYDIR/arch/$ARCH/bin";
+ mkdir -p "$REPOSITORYDIR/arch/$ARCH/lib";
+ mkdir -p "$REPOSITORYDIR/arch/$ARCH/include";
+
+ ARCHARGs=""
+ MACSDKDIR=""
+ #OTHERARGs="-no-cpp-precomp"
+ OTHERARGs=""
+ OTHERMAKEARGs=""
+
+ if [ $ARCH = "i386" -o $ARCH = "i686" ]
+ then
+  TARGET=$i386TARGET
+  MACSDKDIR=$i386MACSDKDIR
+  ARCHARGs="$i386ONLYARG"
+ elif [ $ARCH = "ppc" -o $ARCH = "ppc750" -o $ARCH = "ppc7400" ]
+ then
+  TARGET=$ppcTARGET
+  MACSDKDIR=$ppcMACSDKDIR
+  ARCHARGs="$ppcONLYARG"
+ elif [ $ARCH = "ppc64" -o $ARCH = "ppc970" ]
+ then
+  TARGET=$ppc64TARGET
+  MACSDKDIR=$ppc64MACSDKDIR
+  ARCHARGs="$ppc64ONLYARG"
+ elif [ $ARCH = "x86_64" ]
+ then
+  TARGET=$x64TARGET
+  MACSDKDIR=$x64MACSDKDIR
+  ARCHARGs="$x64ONLYARG"
+ fi
+
+ export PATH=/usr/bin:$REPOSITORYDIR/bin:$PATH
+
+# The separated build trees should guarantee that the right endian value is used
+# but just to make sure that the right endian is compiled we copy the glibconfig.h
+# into $REPOSITORYDIR/lib/glib-2.0/include
+ cp $REPOSITORYDIR/arch/$ARCH/lib/glib-2.0/include/glibconfig.h $REPOSITORYDIR/lib/glib-2.0/include
+
+
+ env CFLAGS="-isysroot $MACSDKDIR -arch $ARCH $ARCHARGs $OTHERARGs -O2" \
+  CXXFLAGS="-isysroot $MACSDKDIR -arch $ARCH $ARCHARGs $OTHERARGs -O2" \
+  CPPFLAGS="-I$REPOSITORYDIR/include -no-cpp-precomp" \
+  LDFLAGS="-L$REPOSITORYDIR/lib -L$REPOSITORYDIR/arch/$ARCH/lib -lexpat -dead_strip -arch $ARCH -no-undefined -bind_at_load" \
+  NEXT_ROOT="$MACSDKDIR" \
+  PKG_CONFIG_PATH="$REPOSITORYDIR/lib/pkgconfig" \
+  ./configure --enable-cairo --prefix="$REPOSITORYDIR"  --disable-dependency-tracking \
+  --host="$TARGET" --exec-prefix=$REPOSITORYDIR/arch/$ARCH  \
+  --without-x --disable-gtk-doc --enable-static --enable-shared \
+ ;
+
+ make clean;
+ make $OTHERMAKEARGs;
+ make $OTHERMAKEARGs install;
+
+
+# Remove glibconfig.h again from $REPOSITORYDIR/lib/glib-2.0/include
+ rm $REPOSITORYDIR/lib/glib-2.0/include/glibconfig.h
+done
+
+
+# merge libpango
+for liba in lib/libpango-$MAIN_LIB_VER.a lib/libpango-$FULL_LIB_VER.dylib lib/libpangocairo-$FULL_LIB_VER.dylib lib/libpangoft2-$FULL_LIB_VER.dylib lib/libpangoft2-$MAIN_LIB_VER.a
+do
+
+ if [ $NUMARCH -eq 1 ]
+ then
+  mv "$REPOSITORYDIR/arch/$ARCHS/$liba" "$REPOSITORYDIR/$liba";
+  if [[ $liba == *.a ]]
+  then 
+   ranlib "$REPOSITORYDIR/$liba";
+  fi
+  continue
+ fi
+
+ LIPOARGs=""
+ 
+ for ARCH in $ARCHS
+ do
+  LIPOARGs="$LIPOARGs $REPOSITORYDIR/arch/$ARCH/$liba"
+ done
+
+ lipo $LIPOARGs -create -output "$REPOSITORYDIR/$liba";
+ if [[ $liba == *.a ]]
+ then 
+  ranlib "$REPOSITORYDIR/$liba";
+ fi
+
+done
+
+
+if [ -f "$REPOSITORYDIR/lib/libpango-$FULL_LIB_VER.dylib" ]
+then
+ install_name_tool -id "$REPOSITORYDIR/lib/libpango-$FULL_LIB_VER.dylib" "$REPOSITORYDIR/lib/libpango-$FULL_LIB_VER.dylib";
+ ln -sfn libpango-$FULL_LIB_VER.dylib $REPOSITORYDIR/lib/libpango-$EXT_MAIN_LIB_VER.dylib;
+ ln -sfn libpango-$FULL_LIB_VER.dylib $REPOSITORYDIR/lib/libpango-$MAIN_LIB_VER.dylib;
+ ln -sfn libpango-$FULL_LIB_VER.dylib $REPOSITORYDIR/lib/libpango-dylib;
+fi
+
+if [ -f "$REPOSITORYDIR/lib/libpangocairo-$FULL_LIB_VER.dylib" ]
+then
+ install_name_tool -id "$REPOSITORYDIR/lib/libpangocairo-$FULL_LIB_VER.dylib" "$REPOSITORYDIR/lib/libpangocairo-$FULL_LIB_VER.dylib";
+ ln -sfn libpangocairo-$FULL_LIB_VER.dylib $REPOSITORYDIR/lib/libpangocairo-$EXT_MAIN_LIB_VER.dylib;
+ ln -sfn libpangocairo-$FULL_LIB_VER.dylib $REPOSITORYDIR/lib/libpangocairo-$MAIN_LIB_VER.dylib;
+ ln -sfn libpangocairo-$FULL_LIB_VER.dylib $REPOSITORYDIR/lib/libpangocairo-dylib;
+fi
+
+if [ -f "$REPOSITORYDIR/lib/libpangoft2-$FULL_LIB_VER.dylib" ]
+then
+ install_name_tool -id "$REPOSITORYDIR/lib/libpangoft2-$FULL_LIB_VER.dylib" "$REPOSITORYDIR/lib/libpangoft2-$FULL_LIB_VER.dylib";
+ ln -sfn libpangoft2-$FULL_LIB_VER.dylib $REPOSITORYDIR/lib/libpangoft2-$EXT_MAIN_LIB_VER.dylib;
+ ln -sfn libpangoft2-$FULL_LIB_VER.dylib $REPOSITORYDIR/lib/libpangoft2-$MAIN_LIB_VER.dylib;
+ ln -sfn libpangoft2-$FULL_LIB_VER.dylib $REPOSITORYDIR/lib/libpangoft2-dylib;
+fi
+
+
+# Merge modules
+mkdir -p $REPOSITORYDIR/lib/pango $REPOSITORYDIR/lib/pango/1.6.0 $REPOSITORYDIR/lib/pango/1.6.0/modules
+
+MODS_DIR="lib/pango/1.6.0/modules/"
+
+for mods in $MODS_DIR/pango-arabic-fc.so $MODS_DIR/pango-basic-fc.so $MODS_DIR/pango-hebrew-fc.so $MODS_DIR/pango-indic-lang.so $MODS_DIR/pango-syriac-fc.so $MODS_DIR/pango-tibetan-fc.so $MODS_DIR/pango-arabic-lang.so $MODS_DIR/pango-hangul-fc.so $MODS_DIR/pango-indic-fc.so $MODS_DIR/pango-khmer-fc.so $MODS_DIR/pango-thai-fc.so
+do
+
+ if [ $NUMARCH -eq 1 ]
+ then
+  mv "$REPOSITORYDIR/arch/$ARCHS/$mods" "$REPOSITORYDIR/$mods";
+ fi
+
+ LIPOARGs=""
+
+ for ARCH in $ARCHS
+ do
+   LIPOARGs="$LIPOARGs $REPOSITORYDIR/arch/$ARCH/$mods"
+ done
+
+ lipo $LIPOARGs -create -output "$REPOSITORYDIR/$mods";
+
+done
+
+
+
+#pkgconfig
+for ARCH in $ARCHS
+do
+ mkdir -p "$REPOSITORYDIR/lib/pkgconfig";
+ sed 's/^exec_prefix.*$/exec_prefix=\$\{prefix\}/' "$REPOSITORYDIR/arch/$ARCH/lib/pkgconfig/pango.pc" > "$REPOSITORYDIR/lib/pkgconfig/pango.pc";
+ sed 's/^exec_prefix.*$/exec_prefix=\$\{prefix\}/' "$REPOSITORYDIR/arch/$ARCH/lib/pkgconfig/pangoft2.pc" > "$REPOSITORYDIR/lib/pkgconfig/pangoft2.pc";
+ break;
+done
+
+
+

Added: branches/avidemux_2.5_branch_gruntster/platforms/mac/External_libs/scripts/0220-libgtk-quartz.sh
===================================================================
--- branches/avidemux_2.5_branch_gruntster/platforms/mac/External_libs/scripts/0220-libgtk-quartz.sh	2009-02-07 14:34:30 UTC (rev 4578)
+++ branches/avidemux_2.5_branch_gruntster/platforms/mac/External_libs/scripts/0220-libgtk-quartz.sh	2009-02-08 17:04:43 UTC (rev 4579)
@@ -0,0 +1,164 @@
+# ------------------
+#     libglib
+# ------------------
+# Based on the works of (c) 2007, Ippei Ukai
+# Modified for avidemux by Harry van der Wolf 200806
+
+# download location ftp://ftp.gtk.org/pub/glib/
+
+# prepare
+
+# export REPOSITORYDIR="/PATH2HUGIN/mac/ExternalPrograms/repository" \
+# ARCHS="ppc i386" \
+# ppcTARGET="powerpc-apple-darwin7" \
+# i386TARGET="i386-apple-darwin8" \
+#  ppcMACSDKDIR="/Developer/SDKs/MacOSX10.4u.sdk" \
+#  i386MACSDKDIR="/Developer/SDKs/MacOSX10.3.9.sdk" \
+#  ppcONLYARG="-mcpu=G3 -mtune=G4" \
+#  i386ONLYARG="-mfpmath=sse -msse2 -mtune=pentium-m -ftree-vectorize" \
+#  OTHERARGs="";
+
+
+# init
+
+let NUMARCH="0"
+
+for i in $ARCHS
+do
+  NUMARCH=$(($NUMARCH + 1))
+done
+
+mkdir -p "$REPOSITORYDIR/bin";
+mkdir -p "$REPOSITORYDIR/lib";
+mkdir -p "$REPOSITORYDIR/include";
+
+MAIN_LIB_VER="2.0"
+EXT_MAIN_LIB_VER="2.0.0"
+FULL_LIB_VER="$EXT_MAIN_LIB_VER.1400.5"
+
+
+
+# compile
+
+for ARCH in $ARCHS
+do
+
+ mkdir -p "$REPOSITORYDIR/arch/$ARCH/bin";
+ mkdir -p "$REPOSITORYDIR/arch/$ARCH/lib";
+ mkdir -p "$REPOSITORYDIR/arch/$ARCH/include";
+
+ ARCHARGs=""
+ MACSDKDIR=""
+ OTHERARGs="-funroll-loops -fstrict-aliasing"
+ OTHERMAKEARGs=""
+
+ if [ $ARCH = "i386" -o $ARCH = "i686" ]
+ then
+  TARGET=$i386TARGET
+  MACSDKDIR=$i386MACSDKDIR
+  ARCHARGs="$i386ONLYARG"
+ elif [ $ARCH = "ppc" -o $ARCH = "ppc750" -o $ARCH = "ppc7400" ]
+ then
+  TARGET=$ppcTARGET
+  MACSDKDIR=$ppcMACSDKDIR
+  ARCHARGs="$ppcONLYARG"
+ elif [ $ARCH = "ppc64" -o $ARCH = "ppc970" ]
+ then
+  TARGET=$ppc64TARGET
+  MACSDKDIR=$ppc64MACSDKDIR
+  ARCHARGs="$ppc64ONLYARG"
+ elif [ $ARCH = "x86_64" ]
+ then
+  TARGET=$x64TARGET
+  MACSDKDIR=$x64MACSDKDIR
+  ARCHARGs="$x64ONLYARG"
+ fi
+
+ export PATH=/usr/bin:$REPOSITORYDIR/arch/$ARCH/bin:$PATH
+
+ env CFLAGS="-isysroot $MACSDKDIR -arch $ARCH $ARCHARGs $OTHERARGs -O2" \
+  CXXFLAGS="-isysroot $MACSDKDIR -arch $ARCH $ARCHARGs $OTHERARGs -O2" \
+  CPPFLAGS="-I$REPOSITORYDIR/include -I$REPOSITORYDIR/arch/$ARCH/include -I/usr/include" \
+  LDFLAGS="-L$REPOSITORYDIR/lib -L$REPOSITORYDIR/arch/$ARCH/lib -L/usr/lib -dead_strip -bind_at_load" \
+  NEXT_ROOT="$MACSDKDIR" \
+  PKG_CONFIG_PATH="$REPOSITORYDIR/arch/$ARCH/lib/pkgconfig" \
+  ./configure --disable-gtk-doc --disable-html --prefix="$REPOSITORYDIR"  --disable-dependency-tracking \
+  --host="$TARGET" --exec-prefix=$REPOSITORYDIR/arch/$ARCH \
+ ;
+
+
+ make clean;
+  make $OTHERMAKEARGs;
+ make $OTHERMAKEARGs install;
+
+done
+
+
+# merge libglib
+
+for liba in lib/libglib-a lib/libglib-$FULL_LIB_VER.dylib lib/libgmodule-$FULL_LIB_VER.dylib lib/libgobject-$FULL_LIB_VER.dylib lib/libgthread-$FULL_LIB_VER.dylib
+do
+
+ if [ $NUMARCH -eq 1 ]
+ then
+  mv "$REPOSITORYDIR/arch/$ARCHS/$liba" "$REPOSITORYDIR/$liba";
+  if [[ $liba == *.a ]]
+  then 
+   ranlib "$REPOSITORYDIR/$liba";
+  fi
+  continue
+ fi
+
+ LIPOARGs=""
+ 
+ for ARCH in $ARCHS
+ do
+  LIPOARGs="$LIPOARGs $REPOSITORYDIR/arch/$ARCH/$liba"
+ done
+
+ lipo $LIPOARGs -create -output "$REPOSITORYDIR/$liba";
+ if [[ $liba == *.a ]]
+ then 
+  ranlib "$REPOSITORYDIR/$liba";
+ fi
+
+done
+
+
+if [ -f "$REPOSITORYDIR/lib/libglib-$FULL_LIB_VER.dylib" ]
+then
+ install_name_tool -id "$REPOSITORYDIR/lib/libglib-$FULL_LIB_VER.dylib" "$REPOSITORYDIR/lib/libglib-$FULL_LIB_VER.dylib";
+ ln -sfn libglib-$FULL_LIB_VER.dylib $REPOSITORYDIR/lib/libglib-$EXT_MAIN_LIB_VER.dylib;
+ ln -sfn libglib-$FULL_LIB_VER.dylib $REPOSITORYDIR/lib/libglib-$MAIN_LIB_VER.dylib;
+ ln -sfn libglib-$FULL_LIB_VER.dylib $REPOSITORYDIR/lib/libglib-dylib;
+fi
+
+if [ -f "$REPOSITORYDIR/lib/libgmodule-$FULL_LIB_VER.dylib" ]
+then
+ install_name_tool -id "$REPOSITORYDIR/lib/libgmodule-$FULL_LIB_VER.dylib" "$REPOSITORYDIR/lib/libgmodule-$FULL_LIB_VER.dylib";
+ ln -sfn libgmodule-$FULL_LIB_VER.dylib $REPOSITORYDIR/lib/libgmodule-$EXT_MAIN_LIB_VER.dylib;
+ ln -sfn libgmodule-$FULL_LIB_VER.dylib $REPOSITORYDIR/lib/libgmodule-$MAIN_LIB_VER.dylib;
+ ln -sfn libgmodule-$FULL_LIB_VER.dylib $REPOSITORYDIR/lib/libgmodule-dylib;
+fi
+
+if [ -f "$REPOSITORYDIR/lib/libgobject-$FULL_LIB_VER.dylib" ]
+then
+ install_name_tool -id "$REPOSITORYDIR/lib/libgobject-$FULL_LIB_VER.dylib" "$REPOSITORYDIR/lib/libgobject-$FULL_LIB_VER.dylib";
+ ln -sfn libgobject-$FULL_LIB_VER.dylib $REPOSITORYDIR/lib/libgobject-$EXT_MAIN_LIB_VER.dylib;
+ ln -sfn libgobject-$FULL_LIB_VER.dylib $REPOSITORYDIR/lib/libgobject-$MAIN_LIB_VER.dylib;
+ ln -sfn libgobject-$FULL_LIB_VER.dylib $REPOSITORYDIR/lib/libgobject-dylib;
+fi
+
+if [ -f "$REPOSITORYDIR/lib/libgthread-$FULL_LIB_VER.dylib" ]
+then
+ install_name_tool -id "$REPOSITORYDIR/lib/libgthread-$FULL_LIB_VER.dylib" "$REPOSITORYDIR/lib/libgthread-$FULL_LIB_VER.dylib";
+ ln -sfn libgthread-$FULL_LIB_VER.dylib $REPOSITORYDIR/lib/libgthread-$EXT_MAIN_LIB_VER.dylib;
+ ln -sfn libgthread-$FULL_LIB_VER.dylib $REPOSITORYDIR/lib/libgthread-$MAIN_LIB_VER.dylib;
+ ln -sfn libgthread-$FULL_LIB_VER.dylib $REPOSITORYDIR/lib/libgthread-dylib;
+fi
+
+# Create directory structure for big_endian / little_endian
+mkdir -p $REPOSITORYDIR/lib/glib-$MAIN_LIB_VER $REPOSITORYDIR/lib/glib-$MAIN_LIB_VER/include
+
+
+

Added: branches/avidemux_2.5_branch_gruntster/platforms/mac/External_libs/scripts/0300-lame.sh
===================================================================
--- branches/avidemux_2.5_branch_gruntster/platforms/mac/External_libs/scripts/0300-lame.sh	2009-02-07 14:34:30 UTC (rev 4578)
+++ branches/avidemux_2.5_branch_gruntster/platforms/mac/External_libs/scripts/0300-lame.sh	2009-02-08 17:04:43 UTC (rev 4579)
@@ -0,0 +1,147 @@
+# ------------------
+#    mp3lame 
+# ------------------
+# Based on the works of (c) 2007, Ippei Ukai
+# Created for avidemux by Harry van der Wolf
+
+# download location http://lame.sourceforge.net/
+
+# prepare
+
+# export REPOSITORYDIR="/PATH2HUGIN/mac/ExternalPrograms/repository" \
+# ARCHS="ppc i386" \
+#  ppcTARGET="powerpc-apple-darwin8" \
+#  i386TARGET="i386-apple-darwin8" \
+#  ppcMACSDKDIR="/Developer/SDKs/MacOSX10.4u.sdk" \
+#  i386MACSDKDIR="/Developer/SDKs/MacOSX10.4u.sdk" \
+#  ppcONLYARG="-mcpu=G3 -mtune=G4" \
+#  i386ONLYARG="-mfpmath=sse -msse2 -mtune=pentium-m -ftree-vectorize" \
+#  OTHERARGs="";
+
+
+# init
+
+let NUMARCH="0"
+
+for i in $ARCHS
+do
+  NUMARCH=$(($NUMARCH + 1))
+done
+
+mkdir -p "$REPOSITORYDIR/bin";
+mkdir -p "$REPOSITORYDIR/lib";
+mkdir -p "$REPOSITORYDIR/include";
+
+MAIN_LIB_VER="0"
+FULL_LIB_VER="$MAIN_LIB_VER.0.0"
+
+
+# compile
+
+for ARCH in $ARCHS
+do
+
+ mkdir -p "$REPOSITORYDIR/arch/$ARCH/bin";
+ mkdir -p "$REPOSITORYDIR/arch/$ARCH/lib";
+ mkdir -p "$REPOSITORYDIR/arch/$ARCH/include";
+
+ ARCHARGs=""
+ MACSDKDIR=""
+
+ if [ $ARCH = "i386" -o $ARCH = "i686" ]
+ then
+  TARGET=$i386TARGET
+  MACSDKDIR=$i386MACSDKDIR
+  ARCHARGs="$i386ONLYARG"
+ elif [ $ARCH = "ppc" -o $ARCH = "ppc750" -o $ARCH = "ppc7400" ]
+ then
+  TARGET=$ppcTARGET
+  MACSDKDIR=$ppcMACSDKDIR
+  ARCHARGs="$ppcONLYARG"
+ elif [ $ARCH = "ppc64" -o $ARCH = "ppc970" ]
+ then
+  TARGET=$ppc64TARGET
+  MACSDKDIR=$ppc64MACSDKDIR
+  ARCHARGs="$ppc64ONLYARG"
+ elif [ $ARCH = "x86_64" ]
+ then
+  TARGET=$x64TARGET
+  MACSDKDIR=$x64MACSDKDIR
+  ARCHARGs="$x64ONLYARG"
+ fi
+
+ # first patch the make file
+
+
+ env CFLAGS="-isysroot $MACSDKDIR -arch $ARCH $ARCHARGs $OTHERARGs -O2 -dead_strip" \
+  CXXFLAGS="-isysroot $MACSDKDIR -arch $ARCH $ARCHARGs $OTHERARGs -O2 -dead_strip" \
+  CPPFLAGS="-I$REPOSITORYDIR/include" \
+  LDFLAGS="-L$REPOSITORYDIR/lib -dead_strip" \
+  NEXT_ROOT="$MACSDKDIR" \
+  ./configure --prefix="$REPOSITORYDIR" \
+  --host="$TARGET" --target="$TARGET" CC="gcc -arch $ARCH" --exec-prefix=$REPOSITORYDIR/arch/$ARCH \
+  --enable-shared --enable-static \
+;
+
+
+ make clean;
+ make;
+ make install;
+
+done
+
+
+# merge libmp3lame
+
+for liba in lib/libmp3lame.a lib/libmp3lame.$FULL_LIB_VER.dylib   
+do
+
+ if [ $NUMARCH -eq 1 ]
+ then
+  mv "$REPOSITORYDIR/arch/$ARCHS/$liba" "$REPOSITORYDIR/$liba";
+  ranlib "$REPOSITORYDIR/$liba";
+  continue
+ fi
+
+ LIPOARGs=""
+ 
+ for ARCH in $ARCHS
+ do
+  LIPOARGs="$LIPOARGs $REPOSITORYDIR/arch/$ARCH/$liba"
+ done
+
+ lipo $LIPOARGs -create -output "$REPOSITORYDIR/$liba";
+ ranlib "$REPOSITORYDIR/$liba";
+
+done
+
+if [ -f "$REPOSITORYDIR/lib/libmp3lame.$FULL_LIB_VER.dylib" ]
+then
+ install_name_tool -id "$REPOSITORYDIR/lib/libmp3lame.$FULL_LIB_VER.dylib" "$REPOSITORYDIR/lib/libmp3lame.$FULL_LIB_VER.dylib"
+ ln -sfn $REPOSITORYDIR/lib/libmp3lame.$FULL_LIB_VER.dylib $REPOSITORYDIR/lib/libmp3lame.$MAIN_LIB_VER.dylib
+ ln -sfn $REPOSITORYDIR/lib/libmp3lame.$FULL_LIB_VER.dylib $REPOSITORYDIR/lib/libmp3lame.dylib;
+fi
+
+# merge execs
+for program in bin/lame
+do
+
+ if [ $NUMARCH -eq 1 ]
+ then
+  mv "$REPOSITORYDIR/arch/$ARCHS/$program" "$REPOSITORYDIR/$program";
+  strip "$REPOSITORYDIR/$program";
+  continue
+ fi
+
+ LIPOARGs=""
+
+ for ARCH in $ARCHS
+ do
+  LIPOARGs="$LIPOARGs $REPOSITORYDIR/arch/$ARCH/$program"
+ done
+
+ lipo $LIPOARGs -create -output "$REPOSITORYDIR/$program";
+
+ strip "$REPOSITORYDIR/$program";
+
+done

Added: branches/avidemux_2.5_branch_gruntster/platforms/mac/External_libs/scripts/0310-xvid.sh
===================================================================
--- branches/avidemux_2.5_branch_gruntster/platforms/mac/External_libs/scripts/0310-xvid.sh	2009-02-07 14:34:30 UTC (rev 4578)
+++ branches/avidemux_2.5_branch_gruntster/platforms/mac/External_libs/scripts/0310-xvid.sh	2009-02-08 17:04:43 UTC (rev 4579)
@@ -0,0 +1,135 @@
+# ------------------
+#    libvxid 
+# ------------------
+# Based on the works of (c) 2007, Ippei Ukai
+# Created for avidemux by Harry van der Wolf
+
+# download location daily build http://downloads.xvid.org/downloads/xvid_latest.tar.gz
+# or download latest source from CVS
+# cvs -d:pserver:anonymous at cvs.xvid.org:/xvid co xvidcore
+
+# prepare
+
+# export REPOSITORYDIR="/PATH2HUGIN/mac/ExternalPrograms/repository" \
+# ARCHS="ppc i386" \
+#  ppcTARGET="powerpc-apple-darwin8" \
+#  i386TARGET="i386-apple-darwin8" \
+#  ppcMACSDKDIR="/Developer/SDKs/MacOSX10.4u.sdk" \
+#  i386MACSDKDIR="/Developer/SDKs/MacOSX10.4u.sdk" \
+#  ppcONLYARG="-mcpu=G3 -mtune=G4" \
+#  i386ONLYARG="-mfpmath=sse -msse2 -mtune=pentium-m -ftree-vectorize" \
+#  OTHERARGs="";
+
+
+# init
+
+let NUMARCH="0"
+
+for i in $ARCHS
+do
+  NUMARCH=$(($NUMARCH + 1))
+done
+
+mkdir -p "$REPOSITORYDIR/bin";
+mkdir -p "$REPOSITORYDIR/lib";
+mkdir -p "$REPOSITORYDIR/include";
+
+#MAIN_LIB_VER="4"
+FULL_LIB_VER="$MAIN_LIB_VER.4"
+
+# Xvid is a little strange. We need to dive into the tree and do a make clean (just in case)
+cd xvidcore/build/generic
+make clean
+
+# As we are using a nightly build or a CVS we need to run bootstrap first
+./bootstrap.sh
+
+
+# compile
+
+for ARCH in $ARCHS
+do
+
+ mkdir -p "$REPOSITORYDIR/arch/$ARCH/bin";
+ mkdir -p "$REPOSITORYDIR/arch/$ARCH/lib";
+ mkdir -p "$REPOSITORYDIR/arch/$ARCH/include";
+
+ ARCHARGs=""
+ MACSDKDIR=""
+ 
+
+
+ if [ $ARCH = "i386" -o $ARCH = "i686" ]
+ then
+  TARGET=$i386TARGET
+  MACSDKDIR=$i386MACSDKDIR
+  ARCHARGs="$i386ONLYARG"
+   ExtraARG="--disable-assembly"
+ elif [ $ARCH = "ppc" -o $ARCH = "ppc750" -o $ARCH = "ppc7400" ]
+ then
+  TARGET=$ppcTARGET
+  MACSDKDIR=$ppcMACSDKDIR
+  ARCHARGs="$ppcONLYARG $ppcONLYExtraARG"
+  ExtraARG="-maltivec"
+ elif [ $ARCH = "ppc64" -o $ARCH = "ppc970" ]
+ then
+  TARGET=$ppc64TARGET
+  MACSDKDIR=$ppc64MACSDKDIR
+  ARCHARGs="$ppc64ONLYARG"
+ elif [ $ARCH = "x86_64" ]
+ then
+  TARGET=$x64TARGET
+  MACSDKDIR=$x64MACSDKDIR
+  ARCHARGs="$x64ONLYARG"
+ fi
+
+
+ env CFLAGS="-isysroot $MACSDKDIR -arch $ARCH $ARCHARGs $OTHERARGs -O2 -dead_strip" \
+  CXXFLAGS="-isysroot $MACSDKDIR -arch $ARCH $ARCHARGs $OTHERARGs -O2 -dead_strip" \
+  CPPFLAGS="-I$REPOSITORYDIR/include" \
+  LDFLAGS="-L$REPOSITORYDIR/lib -isysroot $MACSDKDIR" \
+  NEXT_ROOT="$MACSDKDIR" \
+  ./configure --prefix="$REPOSITORYDIR" \
+  --host="$TARGET" --target="$TARGET" CC="gcc -arch $ARCH $ExtraARG" --exec-prefix=$REPOSITORYDIR/arch/$ARCH \
+  --enable-shared --enable-static \
+;
+
+
+# make clean;
+ make;
+ make install;
+ make clean;
+
+done
+
+
+# merge libvxid
+
+for liba in lib/libvxid.a lib/libvxid.$FULL_LIB_VER.dylib   
+do
+
+ if [ $NUMARCH -eq 1 ]
+ then
+  mv "$REPOSITORYDIR/arch/$ARCHS/$liba" "$REPOSITORYDIR/$liba";
+  ranlib "$REPOSITORYDIR/$liba";
+  continue
+ fi
+
+ LIPOARGs=""
+ 
+ for ARCH in $ARCHS
+ do
+  LIPOARGs="$LIPOARGs $REPOSITORYDIR/arch/$ARCH/$liba"
+ done
+
+ lipo $LIPOARGs -create -output "$REPOSITORYDIR/$liba";
+ ranlib "$REPOSITORYDIR/$liba";
+
+done
+
+if [ -f "$REPOSITORYDIR/lib/libvxid.$FULL_LIB_VER.dylib" ]
+then
+ install_name_tool -id "$REPOSITORYDIR/lib/libvxid.$FULL_LIB_VER.dylib" "$REPOSITORYDIR/lib/libvxid.$FULL_LIB_VER.dylib"
+ ln -sfn $REPOSITORYDIR/lib/libvxid.$FULL_LIB_VER.dylib $REPOSITORYDIR/lib/libvxid.dylib;
+fi
+

Added: branches/avidemux_2.5_branch_gruntster/platforms/mac/External_libs/scripts/0320-x264.sh
===================================================================
--- branches/avidemux_2.5_branch_gruntster/platforms/mac/External_libs/scripts/0320-x264.sh	2009-02-07 14:34:30 UTC (rev 4578)
+++ branches/avidemux_2.5_branch_gruntster/platforms/mac/External_libs/scripts/0320-x264.sh	2009-02-08 17:04:43 UTC (rev 4579)
@@ -0,0 +1,128 @@
+# ------------------
+#    libx264 
+# ------------------
+# Based on the works of (c) 2007, Ippei Ukai
+# Created for avidemux by Harry van der Wolf
+
+# download location daily build http://downloads.xvid.org/downloads/xvid_latest.tar.gz
+# or download latest source from CVS
+# cvs -d:pserver:anonymous at cvs.xvid.org:/xvid co xvidcore
+
+# prepare
+
+# export REPOSITORYDIR="/PATH2HUGIN/mac/ExternalPrograms/repository" \
+# ARCHS="ppc i386" \
+#  ppcTARGET="powerpc-apple-darwin8" \
+#  i386TARGET="i386-apple-darwin8" \
+#  ppcMACSDKDIR="/Developer/SDKs/MacOSX10.4u.sdk" \
+#  i386MACSDKDIR="/Developer/SDKs/MacOSX10.4u.sdk" \
+#  ppcONLYARG="-mcpu=G3 -mtune=G4" \
+#  i386ONLYARG="-mfpmath=sse -msse2 -mtune=pentium-m -ftree-vectorize" \
+#  OTHERARGs="";
+
+
+# init
+
+let NUMARCH="0"
+
+for i in $ARCHS
+do
+  NUMARCH=$(($NUMARCH + 1))
+done
+
+mkdir -p "$REPOSITORYDIR/bin";
+mkdir -p "$REPOSITORYDIR/lib";
+mkdir -p "$REPOSITORYDIR/include";
+
+#MAIN_LIB_VER="4"
+FULL_LIB_VER="59"
+
+# compile
+
+for ARCH in $ARCHS
+do
+
+ mkdir -p "$REPOSITORYDIR/arch/$ARCH/bin";
+ mkdir -p "$REPOSITORYDIR/arch/$ARCH/lib";
+ mkdir -p "$REPOSITORYDIR/arch/$ARCH/include";
+
+ ARCHARGs=""
+ MACSDKDIR=""
+ 
+
+
+ if [ $ARCH = "i386" -o $ARCH = "i686" ]
+ then
+  TARGET=$i386TARGET
+  MACSDKDIR=$i386MACSDKDIR
+  ARCHARGs="$i386ONLYARG"
+  OTHERARGs="--disable-assembly"
+ elif [ $ARCH = "ppc" -o $ARCH = "ppc750" -o $ARCH = "ppc7400" ]
+ then
+  TARGET=$ppcTARGET
+  MACSDKDIR=$ppcMACSDKDIR
+  ARCHARGs="$ppcONLYARG $ppcONLYExtraARG"
+  OTHERARGs="-mabi=altivec -maltivec"
+ elif [ $ARCH = "ppc64" -o $ARCH = "ppc970" ]
+ then
+  TARGET=$ppc64TARGET
+  MACSDKDIR=$ppc64MACSDKDIR
+  ARCHARGs="$ppc64ONLYARG"
+ elif [ $ARCH = "x86_64" ]
+ then
+  TARGET=$x64TARGET
+  MACSDKDIR=$x64MACSDKDIR
+  ARCHARGs="$x64ONLYARG"
+ fi
+
+
+ env CFLAGS="-isysroot $MACSDKDIR -arch $ARCH $ARCHARGs $OTHERARGs -O2 -dead_strip -fno-common" \
+  CXXFLAGS="-isysroot $MACSDKDIR -arch $ARCH $ARCHARGs $OTHERARGs -O2 -dead_strip -fno-common" \
+  CPPFLAGS="-I$REPOSITORYDIR/include" \
+  LDFLAGS="-L$REPOSITORYDIR/lib" \
+  NEXT_ROOT="$MACSDKDIR" \
+  ./configure --prefix="$REPOSITORYDIR" --enable-pthread --enable-pic \
+  --exec-prefix=$REPOSITORYDIR/arch/$ARCH \
+;
+#  --enable-shared --enable-static \
+#;
+#   --host="$TARGET" --target="$TARGET"  --exec-prefix=$REPOSITORYDIR/arch/$ARCH \
+
+
+ make clean;
+ make;
+ make install;
+
+done
+
+
+# merge libx264
+
+for liba in lib/libx264.a lib/libx264.$FULL_LIB_VER.dylib   
+do
+
+ if [ $NUMARCH -eq 1 ]
+ then
+  mv "$REPOSITORYDIR/arch/$ARCHS/$liba" "$REPOSITORYDIR/$liba";
+  ranlib "$REPOSITORYDIR/$liba";
+  continue
+ fi
+
+ LIPOARGs=""
+ 
+ for ARCH in $ARCHS
+ do
+  LIPOARGs="$LIPOARGs $REPOSITORYDIR/arch/$ARCH/$liba"
+ done
+
+ lipo $LIPOARGs -create -output "$REPOSITORYDIR/$liba";
+ ranlib "$REPOSITORYDIR/$liba";
+
+done
+
+if [ -f "$REPOSITORYDIR/lib/libx264.$FULL_LIB_VER.dylib" ]
+then
+ install_name_tool -id "$REPOSITORYDIR/lib/libx264.$FULL_LIB_VER.dylib" "$REPOSITORYDIR/lib/libx264.$FULL_LIB_VER.dylib"
+ ln -sfn $REPOSITORYDIR/lib/libx264.$FULL_LIB_VER.dylib $REPOSITORYDIR/lib/libx264.dylib;
+fi
+

Added: branches/avidemux_2.5_branch_gruntster/platforms/mac/External_libs/scripts/0330-patch-libaften.sh
===================================================================
--- branches/avidemux_2.5_branch_gruntster/platforms/mac/External_libs/scripts/0330-patch-libaften.sh	2009-02-07 14:34:30 UTC (rev 4578)
+++ branches/avidemux_2.5_branch_gruntster/platforms/mac/External_libs/scripts/0330-patch-libaften.sh	2009-02-08 17:04:43 UTC (rev 4579)
@@ -0,0 +1,10 @@
+# ------------------
+#    patch aften 
+# ------------------
+# Harry van der Wolf, 2008
+
+# This script will patch aften for OSX to make the PPC side compile correctly.
+# It needs to be run once
+
+patch -p0 <  "$REPOSITORYDIR/../scripts/patches/aften-0.0.8.patch" 
+

Added: branches/avidemux_2.5_branch_gruntster/platforms/mac/External_libs/scripts/0331-libaften.sh
===================================================================
--- branches/avidemux_2.5_branch_gruntster/platforms/mac/External_libs/scripts/0331-libaften.sh	2009-02-07 14:34:30 UTC (rev 4578)
+++ branches/avidemux_2.5_branch_gruntster/platforms/mac/External_libs/scripts/0331-libaften.sh	2009-02-08 17:04:43 UTC (rev 4579)
@@ -0,0 +1,134 @@
+# ------------------
+#    aften 
+# ------------------
+# Based on the works of (c) 2007, Ippei Ukai
+# Modified for avidemux by Harry van der Wolf 200806
+
+# download location http://aften.sourceforge.net/
+
+# prepare
+
+# export REPOSITORYDIR="/PATH2HUGIN/mac/ExternalPrograms/repository" \
+# ARCHS="ppc i386" \
+#  ppcTARGET="powerpc-apple-darwin8" \
+#  i386TARGET="i386-apple-darwin8" \
+#  ppcMACSDKDIR="/Developer/SDKs/MacOSX10.4u.sdk" \
+#  i386MACSDKDIR="/Developer/SDKs/MacOSX10.4u.sdk" \
+#  ppcONLYARG="-mcpu=G3 -mtune=G4" \
+#  i386ONLYARG="-mfpmath=sse -msse2 -mtune=pentium-m -ftree-vectorize" \
+#  OTHERARGs="";
+
+
+# init
+
+let NUMARCH="0"
+
+for i in $ARCHS
+do
+  NUMARCH=$(($NUMARCH + 1))
+done
+
+mkdir -p "$REPOSITORYDIR/bin";
+mkdir -p "$REPOSITORYDIR/lib";
+mkdir -p "$REPOSITORYDIR/include";
+
+MAIN_LIB_VER="0"
+FULL_LIB_VER="$MAIN_LIB_VER.0.8"
+
+
+# compile
+
+for ARCH in $ARCHS
+do
+
+ mkdir -p "$REPOSITORYDIR/arch/$ARCH/bin";
+ mkdir -p "$REPOSITORYDIR/arch/$ARCH/lib";
+ mkdir -p "$REPOSITORYDIR/arch/$ARCH/include";
+
+ ARCHARGs=""
+ MACSDKDIR=""
+
+ if [ $ARCH = "i386" -o $ARCH = "i686" ]
+ then
+  TARGET=$i386TARGET
+  MACSDKDIR=$i386MACSDKDIR
+  ARCHARGs="$i386ONLYARG"
+ elif [ $ARCH = "ppc" -o $ARCH = "ppc750" -o $ARCH = "ppc7400" ]
+ then
+  TARGET=$ppcTARGET
+  MACSDKDIR=$ppcMACSDKDIR
+  ARCHARGs="$ppcONLYARG"
+ elif [ $ARCH = "ppc64" -o $ARCH = "ppc970" ]
+ then
+  TARGET=$ppc64TARGET
+  MACSDKDIR=$ppc64MACSDKDIR
+  ARCHARGs="$ppc64ONLYARG"
+ elif [ $ARCH = "x86_64" ]
+ then
+  TARGET=$x64TARGET
+  MACSDKDIR=$x64MACSDKDIR
+  ARCHARGs="$x64ONLYARG"
+ fi
+
+
+ mkdir -p $ARCH;
+ cd $ARCH;
+ rm CMakeCache.txt;
+
+export CMAKE_INCLUDE_PATH="$REPOSITORYDIR/include"
+export CMAKE_LIBRARY_PATH="$REPOSITORYDIR/lib"
+export  LDFLAGS="-L$REPOSITORYDIR/lib -dead_strip" \
+export  NEXT_ROOT="$MACSDKDIR" \
+export  PKG_CONFIG_PATH=$REPOSITORYDIR/lib/pkgconfig \
+export PATH=/usr/bin:$PATH
+
+
+cmake  \
+  -DCMAKE_INSTALL_PREFIX="$REPOSITORYDIR" \
+  -DCMAKE_OSX_ARCHITECTURES="$TARGET" \
+  -DCMAKE_OSX_SYSROOT="$MACSDKDIR"\
+   -DSHARED=OFF \
+  -DCMAKE_C_FLAGS="-arch $ARCH -fno-common -O2 -dead_strip" \
+  -DCMAKE_CXX_FLAGS="-arch $ARCH -fno-common -O2 -dead_strip" \
+  ..;
+
+#   -DSHARED=ON \
+
+
+ make;
+ make install;
+ cd ..
+done
+
+
+# merge libaften
+
+for liba in lib/libaften.a lib/libaften.$FULL_LIB_VER.dylib   
+do
+
+ if [ $NUMARCH -eq 1 ]
+ then
+  mv "$REPOSITORYDIR/arch/$ARCHS/$liba" "$REPOSITORYDIR/$liba";
+  ranlib "$REPOSITORYDIR/$liba";
+  continue
+ fi
+
+ LIPOARGs=""
+ 
+ for ARCH in $ARCHS
+ do
+  LIPOARGs="$LIPOARGs $REPOSITORYDIR/arch/$ARCH/$liba"
+ done
+
+ lipo $LIPOARGs -create -output "$REPOSITORYDIR/$liba";
+ ranlib "$REPOSITORYDIR/$liba";
+
+done
+
+if [ -f "$REPOSITORYDIR/lib/libaften.$FULL_LIB_VER.dylib" ]
+then
+ install_name_tool -id "$REPOSITORYDIR/lib/libaften.$FULL_LIB_VER.dylib" "$REPOSITORYDIR/lib/libaften.$FULL_LIB_VER.dylib"
+ ln -sfn $REPOSITORYDIR/lib/libaften.$FULL_LIB_VER.dylib $REPOSITORYDIR/lib/libaften.$MAIN_LIB_VER.dylib
+ ln -sfn $REPOSITORYDIR/lib/libaften.$FULL_LIB_VER.dylib $REPOSITORYDIR/lib/libaften.dylib;
+fi
+

Added: branches/avidemux_2.5_branch_gruntster/platforms/mac/External_libs/scripts/SetEnv-universal.txt
===================================================================
--- branches/avidemux_2.5_branch_gruntster/platforms/mac/External_libs/scripts/SetEnv-universal.txt	2009-02-07 14:34:30 UTC (rev 4578)
+++ branches/avidemux_2.5_branch_gruntster/platforms/mac/External_libs/scripts/SetEnv-universal.txt	2009-02-08 17:04:43 UTC (rev 4579)
@@ -0,0 +1,38 @@
+# Configuration for 2 part universal build
+
+
+# has to be the absolute path from /
+# myREPOSITORYDIR="<Absolute_path_to>/External_libs/repository";
+myREPOSITORYDIR="/Users/Shared/development/avidemux_related/External_libs/repository";
+
+# number of jobs that make can use, probably same as the number of CPUs.
+PROCESSNUM=$(hostinfo | grep "Processors active:" | sed 's/^.*://' | wc -w | sed 's/[^[:digit:]]//g');
+
+#  ARCHS="ppc i386" \
+
+
+mkdir -p $myREPOSITORYDIR;
+
+export \
+ REPOSITORYDIR="$myREPOSITORYDIR" \
+ ARCHS="ppc i386" \
+ \
+ ppcTARGET="powerpc-apple-darwin7" \
+ ppcMACSDKDIR="/Developer/SDKs/MacOSX10.4u.sdk" \
+ ppcONLYARG="-mcpu=G3 -mtune=G4 -mmacosx-version-min=10.3" \
+ \
+ i386TARGET="i386-apple-darwin8" \
+ i386MACSDKDIR="/Developer/SDKs/MacOSX10.4u.sdk" \
+ i386ONLYARG="-march=prescott -mtune=pentium-m -ftree-vectorize -mmacosx-version-min=10.4" \
+ \
+ OTHERARGs="" \
+ OTHERMAKEARGs="--jobs=$PROCESSNUM";
+
+# Extra cmake environment settings
+export CMAKE_INCLUDE_PATH="$REPOSITORYDIR/include"
+export CMAKE_LIBRARY_PATH="$REPOSITORYDIR/lib"
+
+
+
+# $Id: SetEnv-universal.txt 1902 2007-02-04 22:27:47Z ippei $
+# Minor modifications by Harry van der Wolf

Added: branches/avidemux_2.5_branch_gruntster/platforms/mac/External_libs/scripts/patches/aften-0.0.8.patch
===================================================================
--- branches/avidemux_2.5_branch_gruntster/platforms/mac/External_libs/scripts/patches/aften-0.0.8.patch	2009-02-07 14:34:30 UTC (rev 4578)
+++ branches/avidemux_2.5_branch_gruntster/platforms/mac/External_libs/scripts/patches/aften-0.0.8.patch	2009-02-08 17:04:43 UTC (rev 4579)
@@ -0,0 +1,26 @@
+diff -aur aften-0.0.8-orig/CMakeLists.txt aften-0.0.8/CMakeLists.txt
+--- CMakeLists.txt    2007-09-08 02:51:47.000000000 +0100
++++ CMakeLists.txt    2007-12-06 12:46:45.000000000 +0000
+@@ -85,6 +85,10 @@
+   ENDIF(CMAKE_SYSTEM MATCHES "Windows")
+ ENDIF(CMAKE_UNAME)
+ 
++IF (CROSS_SYSTEM_MACHINE)
++  SET(CMAKE_SYSTEM_MACHINE ${CROSS_SYSTEM_MACHINE})
++ENDIF (CROSS_SYSTEM_MACHINE)
++
+ DETECT_COMPILER()
+ 
+ CHECK_64BITS()
+diff -aur aften-0.0.8-orig/libaften/ppc/ppc_cpu_caps.h aften-0.0.8/libaften/ppc/ppc_cpu_caps.h
+--- libaften/ppc/ppc_cpu_caps.h    2007-07-28 13:26:23.000000000 +0100
++++ libaften/ppc/ppc_cpu_caps.h    2007-12-06 12:59:03.000000000 +0000
+@@ -20,7 +20,7 @@
+ #ifndef PPC_CPU_CAPS_H
+ #define PPC_CPU_CAPS_H
+ 
+-#include "common.h"
++#include "aften-types.h"
+ #include "cpu_caps.h"
+ 
+ extern int ppc_cpu_caps_altivec;

Added: branches/avidemux_2.5_branch_gruntster/platforms/mac/External_libs/scripts/patches/pango-patch-ltmain.sh.diff
===================================================================
--- branches/avidemux_2.5_branch_gruntster/platforms/mac/External_libs/scripts/patches/pango-patch-ltmain.sh.diff	2009-02-07 14:34:30 UTC (rev 4578)
+++ branches/avidemux_2.5_branch_gruntster/platforms/mac/External_libs/scripts/patches/pango-patch-ltmain.sh.diff	2009-02-08 17:04:43 UTC (rev 4579)
@@ -0,0 +1,20 @@
+--- ltmain.sh.orig	2008-01-09 03:50:47.000000000 -0600
++++ ltmain.sh	2008-01-09 03:52:08.000000000 -0600
+@@ -1639,7 +1639,7 @@
+ 	continue
+ 	;;
+ 
+-     -mt|-mthreads|-kthread|-Kthread|-pthread|-pthreads|--thread-safe|-threads)
++     -mt|-mthreads|-kthread|-Kthread|-lpthread|-pthreads|--thread-safe|-threads)
+ 	compiler_flags="$compiler_flags $arg"
+ 	compile_command="$compile_command $arg"
+ 	finalize_command="$finalize_command $arg"
+@@ -2134,7 +2134,7 @@
+ 	lib=
+ 	found=no
+ 	case $deplib in
+-	-mt|-mthreads|-kthread|-Kthread|-pthread|-pthreads|--thread-safe|-threads)
++	-mt|-mthreads|-kthread|-Kthread|-lpthread|-pthreads|--thread-safe|-threads)
+ 	  if test "$linkmode,$pass" = "prog,link"; then
+ 	    compile_deplibs="$deplib $compile_deplibs"
+ 	    finalize_deplibs="$deplib $finalize_deplibs"

Added: branches/avidemux_2.5_branch_gruntster/platforms/windows/build_scripts/Set Common Environment Variables.bat
===================================================================
--- branches/avidemux_2.5_branch_gruntster/platforms/windows/build_scripts/Set Common Environment Variables.bat	2009-02-07 14:34:30 UTC (rev 4578)
+++ branches/avidemux_2.5_branch_gruntster/platforms/windows/build_scripts/Set Common Environment Variables.bat	2009-02-08 17:04:43 UTC (rev 4579)
@@ -0,0 +1,78 @@
+ at echo off
+
+set ProgramFiles32=%ProgramFiles%
+if "%PROCESSOR_ARCHITECTURE%" == "AMD64" for /D %%d in ("%ProgramFiles(x86)%") do set ProgramFiles32=%%~fsd
+set nsisDir=%ProgramFiles32%\NSIS
+
+set devDir=C:\Dev
+set mingwDir=%devDir%\MinGW
+set msysDir=C:/Dev/MSYS
+set usrLocalDir=%msysDir%/local
+set CMAKE_INCLUDE_PATH=%usrLocalDir%/include
+set CMAKE_LIBRARY_PATH=%usrLocalDir%/lib
+set PKG_CONFIG_PATH=%usrLocalDir%\lib\pkgconfig
+set SDLDIR=%usrLocalDir%
+set CFLAGS=-I%CMAKE_INCLUDE_PATH% -L%CMAKE_LIBRARY_PATH%
+set CXXFLAGS=-I%CMAKE_INCLUDE_PATH% -L%CMAKE_LIBRARY_PATH%
+set qtDir=%devDir%\Qt
+
+if exist "%qtDir%" (
+	for /f %%d in ('dir /b /ad /on %qtDir%') do set qtVer=%%d
+) else (
+	echo Qt 4 could not be found at "%qtDir%".  Please download from http://www.trolltech.com
+	goto error
+)
+
+set qtDir=%qtDir%\%qtVer%
+
+if exist "%devDir%\CMake 2.4\bin" (
+	set cmakeDir=%devDir%\CMake 2.4\bin
+	goto foundCMake
+)
+
+if exist "%ProgramFiles32%\CMake 2.4\bin" (
+	set cmakeDir=%ProgramFiles32%\CMake 2.4\bin
+	goto foundCMake
+)
+
+if exist "%devDir%\CMake 2.6\bin" (
+	set cmakeDir=%devDir%\CMake 2.6\bin
+	goto foundCMake
+)
+
+if exist "%ProgramFiles32%\CMake 2.6\bin" (
+	set cmakeDir=%ProgramFiles32%\CMake 2.6\bin
+) else (
+	echo CMake could not be found.  Please download from http://www.cmake.org
+	goto error
+)
+
+:foundCMake
+if not exist "%mingwDir%" (
+	echo MinGW could not be found at "%mingwDir%".  Please download from http://www.mingw.org
+	goto error
+)
+
+if not exist "%CMAKE_INCLUDE_PATH%" (
+	echo Include path could not be found at "%CMAKE_INCLUDE_PATH%".
+	goto error
+)
+
+if not exist "%CMAKE_LIBRARY_PATH%" (
+	echo Library path could not be found at "%CMAKE_LIBRARY_PATH%".
+	goto error
+)
+
+if not exist "%nsisDir%" (
+	echo NSIS could not be found at "%nsisDir%".  Please download from http://nsis.sourceforge.net
+	goto error
+)
+
+set PATH=%cmakeDir%;%mingwDir%\bin;%usrLocalDir%\bin;%qtDir%\bin;%PATH%
+
+goto end
+
+:error
+set ERRORLEVEL=1
+
+:end
\ No newline at end of file

Added: branches/avidemux_2.5_branch_gruntster/platforms/windows/build_scripts/avidemux_2.4/1. Perform Build.bat
===================================================================
--- branches/avidemux_2.5_branch_gruntster/platforms/windows/build_scripts/avidemux_2.4/1. Perform Build.bat	2009-02-07 14:34:30 UTC (rev 4578)
+++ branches/avidemux_2.5_branch_gruntster/platforms/windows/build_scripts/avidemux_2.4/1. Perform Build.bat	2009-02-08 17:04:43 UTC (rev 4579)
@@ -0,0 +1,35 @@
+ at echo off
+
+set curDir=%CD%
+call "Set Avidemux 2.4 Environment Variables"
+
+if errorlevel 1 goto error
+
+cd "%sourceDir%"
+echo Cleaning build directories
+rmdir /s /q build 2> NULL
+rmdir /s /q buildcli 2> NULL
+
+if exist build goto removalFailure
+if exist buildcli goto removalFailure
+
+mkdir buildcli
+mkdir build
+
+echo Performing Subversion update
+svn up .
+
+cd %curDir%
+call "1b. Continue Build"
+
+goto end
+
+:removalFailure
+echo ERROR - build or buildcli could not be fully deleted.
+echo Aborting.
+pause
+
+:error
+set ERRORLEVEL=1
+
+:end

Added: branches/avidemux_2.5_branch_gruntster/platforms/windows/build_scripts/avidemux_2.4/1b. Continue Build.bat
===================================================================
--- branches/avidemux_2.5_branch_gruntster/platforms/windows/build_scripts/avidemux_2.4/1b. Continue Build.bat	2009-02-07 14:34:30 UTC (rev 4578)
+++ branches/avidemux_2.5_branch_gruntster/platforms/windows/build_scripts/avidemux_2.4/1b. Continue Build.bat	2009-02-08 17:04:43 UTC (rev 4579)
@@ -0,0 +1,34 @@
+ at echo off
+
+call "Set Avidemux 2.4 Environment Variables"
+
+cd "%sourceDir%\build"
+
+cmake -DUSE_LATE_BINDING=1 -G"MinGW Makefiles" ..
+
+if errorlevel 1 goto error
+
+pause
+mingw32-make avidemux2_gtk
+mingw32-make avidemux2_qt4
+mingw32-make mofiles
+mingw32-make qmfiles
+
+copy /y .\avidemux\avidemux2_gtk.exe "%buildDir%"
+copy /y .\avidemux\avidemux2_qt4.exe "%buildDir%"
+
+cd ..\buildcli
+
+cmake -DUSE_LATE_BINDING=1 -G"MinGW Makefiles" -DNO_SDL=1 ..
+mingw32-make avidemux2_cli
+
+copy /y .\avidemux\avidemux2_cli.exe "%buildDir%"
+
+echo Finished!
+goto end
+
+:error
+set ERRORLEVEL=1
+
+:end
+pause
\ No newline at end of file

Added: branches/avidemux_2.5_branch_gruntster/platforms/windows/build_scripts/avidemux_2.4/2. Create Packages.bat
===================================================================
--- branches/avidemux_2.5_branch_gruntster/platforms/windows/build_scripts/avidemux_2.4/2. Create Packages.bat	2009-02-07 14:34:30 UTC (rev 4578)
+++ branches/avidemux_2.5_branch_gruntster/platforms/windows/build_scripts/avidemux_2.4/2. Create Packages.bat	2009-02-08 17:04:43 UTC (rev 4579)
@@ -0,0 +1,12 @@
+ at call "2a. Update Notes.bat"
+
+if errorlevel 1 goto error
+
+ at call "2b. Package Build.bat"
+
+goto end
+
+:error
+set ERRORLEVEL 1
+
+:end
\ No newline at end of file

Added: branches/avidemux_2.5_branch_gruntster/platforms/windows/build_scripts/avidemux_2.4/2a. Update Notes.bat
===================================================================
--- branches/avidemux_2.5_branch_gruntster/platforms/windows/build_scripts/avidemux_2.4/2a. Update Notes.bat	2009-02-07 14:34:30 UTC (rev 4578)
+++ branches/avidemux_2.5_branch_gruntster/platforms/windows/build_scripts/avidemux_2.4/2a. Update Notes.bat	2009-02-08 17:04:43 UTC (rev 4579)
@@ -0,0 +1,30 @@
+ at echo off
+
+call "Set Avidemux 2.4 Environment Variables"
+if errorlevel 1 goto error
+
+set PATH=%msysDir%\bin;%PATH%
+set curDir=%CD%
+
+echo -- Generating Change Log.html --
+cd "..\..\installer"
+sh genlog.sh
+
+echo -- Generating Package Notes.html --
+cd "%curDir%\Tools"
+sh gennotes.sh
+
+echo -- Generating Touch Files.html --
+sh gentouch.sh
+
+echo -- Generating avidemux.pot --
+cd "%sourceDir%\po"
+sh update_pot.bash
+
+goto end
+
+:error
+set ERRORLEVEL=1
+
+:end
+pause
\ No newline at end of file

Added: branches/avidemux_2.5_branch_gruntster/platforms/windows/build_scripts/avidemux_2.4/2b. Package Build.bat
===================================================================
--- branches/avidemux_2.5_branch_gruntster/platforms/windows/build_scripts/avidemux_2.4/2b. Package Build.bat	2009-02-07 14:34:30 UTC (rev 4578)
+++ branches/avidemux_2.5_branch_gruntster/platforms/windows/build_scripts/avidemux_2.4/2b. Package Build.bat	2009-02-08 17:04:43 UTC (rev 4579)
@@ -0,0 +1,32 @@
+ at echo off
+
+call "Set Avidemux 2.4 Environment Variables"
+
+cd Tools
+call "Get Revision Number"
+cd ..
+
+set curDir=%CD%
+set zipFile=avidemux_2.4_r%revisionNo%_win32.zip
+set exeFile=avidemux_2.4_r%revisionNo%_win32.exe
+set packageDir=%CD%\%revisionNo%
+
+echo %packageDir%
+mkdir %packageDir%
+
+copy "%buildDir%\Change Log.html" "%packageDir%"
+move "Tools\Package Notes.html" "%packageDir%"
+copy "%sourceDir%\po\avidemux.pot" "%packageDir%"
+
+cd %buildDir%
+zip -r "%packageDir%\%zipFile%" *
+cd %curDir%
+advzip -z -4 "%packageDir%\%zipFile%"
+
+echo -- Generating %exeFile% --
+echo !define BUILDDIR %buildDir% > "..\..\installer\builddir.nsh"
+"%nsisDir%\makensis" /V2 "..\..\installer\avidemux.nsi"
+
+move "..\..\installer\%exeFile%" "%packageDir%"
+
+pause
\ No newline at end of file

Added: branches/avidemux_2.5_branch_gruntster/platforms/windows/build_scripts/avidemux_2.4/Package Notes.xml
===================================================================
--- branches/avidemux_2.5_branch_gruntster/platforms/windows/build_scripts/avidemux_2.4/Package Notes.xml	2009-02-07 14:34:30 UTC (rev 4578)
+++ branches/avidemux_2.5_branch_gruntster/platforms/windows/build_scripts/avidemux_2.4/Package Notes.xml	2009-02-08 17:04:43 UTC (rev 4579)
@@ -0,0 +1,426 @@
+<?xml version="1.0"?>
+<log>
+  <buildentry revision="4508" date="2009-01-01">
+    <comment>Updated x264 to r1069.</comment>
+  </buildentry>
+  <buildentry revision="4502" date="2008-12-27">
+    <comment>Updated GTK+ to version 2.14.6-1.</comment>
+    <comment>Updated Libxml2 to version 2.7.2+.</comment>
+    <comment>Updated x264 to r1062 (patched).</comment>
+    <comment>Updated Xvid to 1.2.1.</comment>    
+  </buildentry>
+  <buildentry revision="4499" date="2008-12-03">
+    <comment>Packaged using NSIS 2.41.</comment>
+    <comment>Updated Avisynth Proxy GUI to version 2.06.</comment>
+    <comment>Updated GLib to version 2.18.3-1.</comment>
+    <comment>Updated GTK+ to version 2.14.5-1.</comment>
+    <comment>Updated Libxml2 to version 2.7.2.</comment>
+    <comment>Updated Pango to version 1.22.2-1.</comment>
+    <comment>Updated Qt to version 4.4.3.</comment>
+    <comment>Updated win_iconv to version 20080403.</comment>
+    <comment>Updated x264 to r1046 (patched).</comment>
+    <comment>Updated Xvid to 1.2.0.</comment>
+  </buildentry>
+  <buildentry revision="4494" date="2008-10-22">
+    <comment>Updated GTK+ to version 2.14.4-1.</comment>
+  </buildentry>
+  <buildentry revision="4486" date="2008-10-18">
+    <comment>Updated GLib to version 2.18.2-1.</comment>
+  </buildentry>
+  <buildentry revision="4473" date="2008-10-15">
+  </buildentry>
+  <buildentry revision="4458" date="2008-10-13">
+  </buildentry>
+  <buildentry revision="4454" date="2008-10-08">
+  </buildentry>
+  <buildentry revision="4445" date="2008-10-06">
+    <comment>Updated x264 to r999 (patched).</comment>
+  </buildentry>
+  <buildentry revision="4435" date="2008-10-02">
+    <comment>Updated x264 to r997 (patched).</comment>
+  </buildentry>
+  <buildentry revision="4421" date="2008-09-30">
+    <comment>Updated x264 to r995 (patched).</comment>
+  </buildentry>
+  <buildentry revision="4413" date="2008-09-26">
+    <comment>Updated Cairo to version 1.8.0-1.</comment>
+    <comment>Updated LAME to version 3.98.2.</comment>
+    <comment>Updated libpng to version 1.2.32.</comment>
+    <comment>Updated Pango to version 1.22.0-1.</comment>
+  </buildentry>
+  <buildentry revision="4407" date="2008-09-25">
+    <comment>Updated ATK to version 1.24.0-1.</comment>
+    <comment>Updated GLib to version 2.18.1-2.</comment>
+    <comment>Updated GTK+ to version 2.14.3-2.</comment>
+  </buildentry>
+  <buildentry revision="4402" date="2008-09-23">
+    <comment>Updated x264 to r987 (patched).</comment>
+  </buildentry>
+  <buildentry revision="4392" date="2008-09-22">
+    <comment>Updated x264 to r986 (patched).</comment>
+  </buildentry>
+  <buildentry revision="4376" date="2008-09-20">
+    <comment>Updated ATK to version 1.22.0-2.</comment>
+    <comment>Updated GLib to version 2.18.1-1.</comment>
+    <comment>Updated GTK+ to version 2.14.2-1.</comment>
+    <comment>Updated Libxml2 to version 2.7.1.</comment>
+    <comment>Updated Pango to version 1.20.5-2.</comment>
+    <comment>Updated Qt to version 4.4.2.</comment>
+    <comment>Updated x264 to r979 (patched).</comment>
+  </buildentry>
+  <buildentry revision="4346" date="2008-09-14">
+    <comment>Reverted GTK+ back to original 2.14.1 (Avidemux has now been fixed).</comment>
+    <comment>Updated x264 to r968 (patched).</comment>
+  </buildentry>
+  <buildentry revision="4324" date="2008-09-11">
+    <comment>Patched GTK+ 2.14.1 to fix incorrect spin button ranges.</comment>
+  </buildentry>
+  <buildentry revision="4316" date="2008-09-08">
+    <comment>Updated GLib to version 2.18.0-2.</comment>
+    <comment>Updated GTK+ to version 2.14.1-1.</comment>
+    <comment>Updated x264 to r965 (patched).</comment>
+  </buildentry>
+  <buildentry revision="4304" date="2008-09-02">
+    <comment>Updated Qt to version 4.4.1.</comment>
+    <comment>Updated x264 to r956 (patched).</comment>
+  </buildentry>
+  <buildentry revision="4297" date="2008-07-31">
+    <comment>Updated x264 to r927 (patched).</comment>
+  </buildentry>
+  <buildentry revision="4281" date="2008-07-25">
+    <comment>Updated x264 to r918 (patched).</comment>
+  </buildentry>
+  <buildentry revision="4276 [2.4.3 Final]" date="2008-07-24">
+  </buildentry>
+  <buildentry revision="4269" date="2008-07-21">
+    <comment>Updated GLib to version 2.16.5.</comment>
+    <comment>Updated x264 to r915 (patched).</comment>
+  </buildentry>
+  <buildentry revision="4219" date="2008-07-16">
+  </buildentry>
+  <buildentry revision="4211" date="2008-07-13">
+    <comment>Updated GLib to version 2.16.4.</comment>
+    <comment>Updated GTK+ to version 2.12.11.</comment>
+    <comment>Updated Pango to version 1.20.5.</comment>
+    <comment>Updated x264 to r912 (patched).</comment>
+  </buildentry>
+  <buildentry revision="4195 [2.4.2 Final]" date="2008-07-06">
+    <comment>Updated LAME to version 3.98.</comment>
+    <comment>Updated x264 to r899 (patched).</comment>
+  </buildentry>
+  <buildentry revision="4182" date="2008-06-30">
+  </buildentry>
+  <buildentry revision="4170" date="2008-06-27">
+  </buildentry>
+  <buildentry revision="4160" date="2008-06-25">
+    <comment>Updated x264 to r891 (patched).</comment>
+  </buildentry>
+  <buildentry revision="4145" date="2008-06-22">
+    <comment>Updated x264 to r889 (patched).</comment>
+  </buildentry>
+  <buildentry revision="4123" date="2008-06-18">
+  </buildentry>
+  <buildentry revision="4114" date="2008-06-17">
+    <comment>Updated Freetype to version 2.3.6.</comment>
+    <comment>Updated x264 to r886 (patched).</comment>
+  </buildentry>
+  <buildentry revision="4090" date="2008-06-12">
+    <comment>Updated GTK+ to version 2.12.10.</comment>
+    <comment>Updated x264 to r881, patched and compiled with MinGW GCC 4.2.1-sjlj-2.</comment>
+  </buildentry>
+  <buildentry revision="4081" date="2008-06-01">
+    <comment>Updated Cairo to version 1.6.4-2.</comment>
+    <comment>Updated libpng to version 1.2.29.</comment>
+    <comment>Updated Pango to version 1.20.3.</comment>
+  </buildentry>
+  <buildentry revision="4028" date="2008-05-14">
+    <comment>Updated Libxml2 to version 2.6.32+.</comment>
+    <comment>Updated Qt to version 4.4.0.</comment>
+    <comment>Updated x264 to r845.</comment>
+  </buildentry>
+  <buildentry revision="4017" date="2008-05-03">
+    <comment>Updated x264 to r839.</comment>
+  </buildentry>
+  <buildentry revision="3982" date="2008-04-24">
+    <comment>Updated Cairo to version 1.6.4-1.</comment>
+    <comment>Updated GLib to version 2.16.3.</comment>
+    <comment>Updated Pango to version 1.20.2.</comment>
+    <comment>Updated x264 to r828.</comment>
+  </buildentry>
+  <buildentry revision="3974" date="2008-04-10">
+    <comment>Updated GLib to version 2.16.2.</comment>
+    <comment>Updated x264 to r816.</comment>
+  </buildentry>
+  <buildentry revision="3947" date="2008-04-01">
+    <comment>Updated x264 to r808, compiled with Microsoft Visual C++ 6 SP5.</comment>
+  </buildentry>
+  <buildentry revision="3945" date="2008-03-30">
+    <comment>Updated win_iconv to version 20080320.</comment>
+    <comment>Updated x264 to r798, compiled with Microsoft Visual C++ 9.</comment>
+  </buildentry>
+  <buildentry revision="3908" date="2008-03-19">
+    <comment>Updated GTK+ to version 2.12.9.</comment>
+    <comment>Recompiled Aften 0.0.8 with Microsoft Visual C++ 9 (to enable SSE3).</comment>
+    <comment>Recompiled Avidemux and LAME with MinGW's GCC 4.2.1-sjlj-2.</comment>
+    <comment>Replaced libiconv with win_iconv (20080317).</comment>
+    <comment>Reverted x264 back to SVN revision 741.</comment>
+  </buildentry>
+  <buildentry revision="3872" date="2008-03-13">
+    <comment>Updated ATK to version 1.22.0.</comment>
+    <comment>Updated Avisynth Proxy GUI to version 2.04.</comment>
+    <comment>Updated Fontconfig to version 2.4.2 (20071015).</comment>
+    <comment>Updated GLib to version 2.16.1.</comment>
+    <comment>Updated Qt to version 4.3.4.</comment>
+    <comment>Updated Pango to version 1.20.0.</comment>
+    <comment>Updated x264 to SVN revision 745.</comment>
+  </buildentry>
+  <buildentry revision="3791 [2.4.1 Final]" date="2008-02-15">
+  </buildentry>
+  <buildentry revision="3789" date="2008-02-08">
+    <comment>Updated GLib to version 2.14.6-1.</comment>
+  </buildentry>
+  <buildentry revision="3784" date="2008-02-02">
+    <comment>Compiled CLI without SDL so output is directed to the console instead of log files.</comment>
+  </buildentry>
+  <buildentry revision="3779" date="2008-01-29">
+    <comment>Updated x264 to SVN revision 736.</comment>
+  </buildentry>
+  <buildentry revision="3775" date="2008-01-28">
+    <comment>Updated gettext to version 0.17-1.</comment>
+    <comment>Updated Libxml2 to version 2.6.30+.</comment>
+    <comment>Updated x264 to SVN revision 735.</comment>
+  </buildentry>
+  <buildentry revision="3764" date="2008-01-22">
+    <comment>Updated gettext to version 0.17.</comment>
+  </buildentry>
+  <buildentry revision="3756" date="2008-01-18">
+    <comment>Updated Cairo to version 1.4.14.</comment>
+    <comment>Updated GLib to version 2.14.5.</comment>
+    <comment>Updated Pango to version 1.18.4.</comment>
+    <comment>Updated SDL to version 1.2.13.</comment>
+    <comment>Updated x264 to SVN revision 721.</comment>
+  </buildentry>
+  <buildentry revision="3731 [2.4.0 Final]" date="2007-12-24">
+    <comment>Updated x264 to SVN revision 712.</comment>
+  </buildentry>
+  <buildentry revision="3728" date="2007-12-13">
+    <comment>Updated Qt to version 4.3.3.</comment>
+    <comment>Updated x264 to SVN revision 711.</comment>
+  </buildentry>
+  <buildentry revision="3718" date="2007-12-03">
+    <comment>Updated x264 to SVN revision 708.</comment>
+  </buildentry>
+  <buildentry revision="3707" date="2007-11-29">
+    <comment>Updated GLib to version 2.14.4.</comment>
+    <comment>Updated x264 to SVN revision 702.</comment>
+  </buildentry>
+  <buildentry revision="3699" date="2007-11-22">
+    <comment>Updated GLib to version 2.14.3.</comment>
+    <comment>Updated FAAD2 to version 2.6.1.</comment>
+    <comment>Updated x264 to SVN revision 700.</comment>
+  </buildentry>
+  <buildentry revision="3688 [2.4.0 Preview 3.1]" date="2007-11-12">
+    <comment>FAAC support was missing from the earlier preview 3 build.</comment>
+  </buildentry>
+  <buildentry revision="3688 [2.4.0 Preview 3]" date="2007-11-11">
+  </buildentry>
+  <buildentry revision="3676" date="2007-10-31">
+    <comment>Updated FAAC to version 1.26.</comment>
+    <comment>Updated FAAD2 to version 2.6.</comment>
+    <comment>Updated x264 to SVN revision 681.</comment>
+  </buildentry>
+  <buildentry revision="3665" date="2007-10-23">
+    <comment>Updated GLib to version 2.14.2.</comment>
+    <comment>Updated Pango to version 1.18.3.</comment>
+  </buildentry>
+  <buildentry revision="3658" date="2007-10-17">
+  </buildentry>
+  <buildentry revision="3639" date="2007-10-10">
+    <comment>Reverted GTK+ back to version 2.10.14 (due to reports of instability).</comment>
+  </buildentry>
+  <buildentry revision="3625" date="2007-10-07">
+    <comment>Updated Qt to version 4.3.2.</comment>
+  </buildentry>
+  <buildentry revision="3600" date="2007-09-26">
+    <comment>Updated Aften to version 0.0.8</comment>
+    <comment>Updated ATK to version 1.20.0.</comment>
+    <comment>Updated Cairo to version 1.4.10.</comment>
+    <comment>Updated GLib to version 2.14.1.</comment>
+    <comment>Updated GTK+ to version 2.12.0.</comment>
+    <comment>Updated Libxml2 to 2.6.30.</comment>
+    <comment>Updated Pango to version 1.18.2.</comment>
+    <comment>Updated SDL to version 1.2.12.</comment>
+    <comment>Updated x264 to SVN revision 680.</comment>
+  </buildentry>
+  <buildentry revision="3591" date="2007-09-22">
+    <comment>Updated x264 to SVN revision 677.</comment>
+  </buildentry>
+  <buildentry revision="3587" date="2007-09-11">
+    <comment>Updated x264 to SVN revision 674.</comment>
+  </buildentry>
+  <buildentry revision="3579" date="2007-09-05">
+  </buildentry>
+  <buildentry revision="3570" date="2007-08-31">
+  </buildentry>
+  <buildentry revision="3563" date="2007-08-26">
+  </buildentry>
+  <buildentry revision="3553" date="2007-08-23">
+  </buildentry>
+  <buildentry revision="3535" date="2007-08-19">
+  </buildentry>
+  <buildentry revision="3516" date="2007-08-16">
+    <comment>Updated Freetype to version 2.3.5.</comment>
+    <comment>Updated GLib to version 2.14.0.</comment>
+  </buildentry>
+  <buildentry revision="3500" date="2007-08-13">
+    <comment>Updated Qt to version 4.3.1.</comment>
+  </buildentry>
+  <buildentry revision="3488" date="2007-08-08">
+  </buildentry>
+  <buildentry revision="3475" date="2007-08-05">
+    <comment>Updated GTK+ to version 2.10.14.</comment>
+  </buildentry>
+  <buildentry revision="3465" date="2007-08-01">
+    <comment>Packaged using NSIS 2.29.</comment>
+  </buildentry>
+  <buildentry revision="3451" date="2007-07-28">
+    <comment>Updated GLib to version 2.12.13.</comment>
+    <comment>Updated Xvid to CVS HEAD 2007-07-26.</comment>
+    <comment>Updated Vorbis to version 1.2.0.</comment>
+  </buildentry>
+  <buildentry revision="3441" date="2007-07-24">
+    <comment>Updated GCC to version 4.2.1.</comment>
+  </buildentry>
+  <buildentry revision="3412" date="2007-07-18">
+    <comment>Updated x264 to SVN revision 667.</comment>
+  </buildentry>
+  <buildentry revision="3374" date="2007-07-16">
+  </buildentry>
+  <buildentry revision="3364" date="2007-07-14">
+  </buildentry>
+  <buildentry revision="3353" date="2007-07-10">
+    <comment>Updated GCC to version 4.2.0 again.</comment>
+  </buildentry>
+  <buildentry revision="3342" date="2007-07-08">
+  </buildentry>
+  <buildentry revision="3332" date="2007-07-06">
+    <comment>Updated x264 to SVN revision 663.</comment>
+    <comment>Updated Xvid to CVS HEAD 2007-06-28.</comment>
+  </buildentry>
+  <buildentry revision="3322 [2.4.0 Preview 2]" date="2007-06-30">
+    <comment>Reverted GCC back to version 4.1.2 (due to video issues).</comment>
+  </buildentry>
+  <buildentry revision="3317" date="2007-06-28">
+    <comment>Updated Xvid to CVS HEAD 2007-06-27.</comment>
+    <comment>Reverted GTK+ back to version 2.10.9 (due to reports of instability).</comment>
+  </buildentry>
+  <buildentry revision="3310" date="2007-06-26">
+  </buildentry>
+  <buildentry revision="3294" date="2007-06-24">
+    <comment>Updated Freetype to version 2.3.4.</comment>
+    <comment>Updated Libxml2 to version 2.6.28.</comment>
+    <comment>Updated x264 to SVN revision 662.</comment>
+    <comment>Recompiled Aften 0.07 with Microsoft Visual C++ 8 (to fix SSE2 threading issue).</comment>
+  </buildentry>
+  <buildentry revision="3283" date="2007-06-21">
+    <comment>Updated x264 to SVN revision 661.</comment>
+  </buildentry>
+  <buildentry revision="3273" date="2007-06-18">
+  </buildentry>
+  <buildentry revision="3253" date="2007-06-15">
+    <comment>Updated GCC to version 4.2.0 (also recompiled LAME).</comment>
+    <comment>Updated Aften to version 0.07 (R522 to fix GCC alignment issue).</comment>
+    <comment>Updated Cairo to version 1.4.8.</comment>
+    <comment>Updated Fontconfig to version 2.4.2.</comment>
+    <comment>Updated GLib to version 2.12.12.</comment>
+    <comment>Updated GTK+ to version 2.10.13.</comment>
+    <comment>Updated Pango to version 1.16.4.</comment>
+    <comment>Updated Qt to version 4.3.0.</comment>
+    <comment>Updated x264 to SVN revision 659.</comment>
+    <comment>Updated Xvid to CVS HEAD 2007-06-03.</comment>
+    <comment>Avidemux was built using new CMake scripts.</comment>
+    <comment>Packaged using NSIS 2.28.</comment>
+  </buildentry>
+  <buildentry revision="3140" date="2007-05-25">
+  </buildentry>
+  <buildentry revision="3124" date="2007-05-22">
+  </buildentry>
+  <buildentry revision="3110" date="2007-05-18">
+  </buildentry>
+  <buildentry revision="3099" date="2007-05-16">
+  </buildentry>
+  <buildentry revision="3086" date="2007-05-14">
+  </buildentry>
+  <buildentry revision="3070" date="2007-05-13">
+  </buildentry>
+  <buildentry revision="3059" date="2007-05-10">
+  </buildentry>
+  <buildentry revision="3048" date="2007-05-09">
+  </buildentry>
+  <buildentry revision="3040" date="2007-05-07">
+    <comment>Updated Avisynth Proxy GUI to 2007-05-04.</comment>
+    <comment>Removed ADM Tools.</comment>
+    <comment>Installer now prompts to remove previous version before installing.</comment>
+  </buildentry>
+  <buildentry revision="3015" date="2007-05-04">
+    <comment>Updated x264 to SVN revision 655.</comment>
+    <comment>Updated Avisynth Proxy GUI to 2007-05-02.</comment>
+    <comment>Installer now adds Avisynth Proxy GUI to Start Menu.</comment>
+  </buildentry>
+  <buildentry revision="3003" date="2007-05-02">
+    <comment>Added Avisynth Proxy GUI to Installer.</comment>
+  </buildentry>
+  <buildentry revision="2994" date="2007-04-30">
+    <comment>Updated Xvid to CVS HEAD 2007-04-29.</comment>
+    <comment>Added Avisynth Proxy to Installer.</comment>
+  </buildentry>
+  <buildentry revision="2975" date="2007-04-27">
+  </buildentry>
+  <buildentry revision="2960" date="2007-04-24">
+    <comment>Updated x264 to SVN revision 654.</comment>
+    <comment>Added GTK translations to installer.  Standard GTK windows (e.g. Open and Save) are now correctly translated.</comment>
+    <comment>The Installer now prohibits ADM Tools from being installed if the GTK+ user interface isn't also chosen.</comment>
+  </buildentry>
+  <buildentry revision="2955" date="2007-04-23">
+    <comment>Updated x264 to SVN revision 652.</comment>
+    <comment>Updated ADM Tools to 2007-04-20.</comment>
+    <comment>Installer now remembers previous installation folder (thanks LoRd_MuldeR).</comment>
+    <comment>Translations now work when starting Avidemux via the shortcuts created by the Installer (thanks Tetsuro).</comment>
+  </buildentry>
+  <buildentry revision="2953" date="2007-04-19">
+  </buildentry>
+  <buildentry revision="2951" date="2007-04-20">
+    <comment>Updated Xvid to CVS HEAD 2007-04-17.</comment>
+    <comment>Updated ADM Tools to 2007-04-18.</comment>
+  </buildentry>
+  <buildentry revision="2948" date="2007-04-17">
+  </buildentry>
+  <buildentry revision="2945" date="2007-04-15">
+    <comment>A bug in the Avidemux configure script prevented full compiler optimisations from being enabled. This has now been rectified, which means the main Avidemux executables are larger but hopefully faster in certain areas.</comment>
+    <comment>The installer now uses improved compression so the file size is smaller than the last release.</comment>
+    <comment>Included ADM Tools.</comment>
+  </buildentry>
+  <buildentry revision="2934" date="2007-04-13">
+    <comment>Updated x264 to SVN revision 650.</comment>
+    <comment>Introduced a new installer.</comment>
+  </buildentry>
+  <buildentry revision="2926 [Release 2]" date="2007-04-11">
+    <comment>Updated x264 to SVN revision 649.</comment>
+    <comment>
+      FAAC and FAAD2 have been rebuilt. Prior builds incorrectly included DRM versions
+      of both libraries, which aren't appropriate for Avidemux.
+    </comment>
+  </buildentry>
+  <buildentry revision="2926" date="2007-04-07">
+    <comment>Updated Aften to version 0.06</comment>
+    <comment>Updated x264 to SVN revision 648.</comment>
+  </buildentry>
+  <buildentry revision="2922" date="2007-04-05">
+    <comment>Updated x264 to SVN revision 641.</comment>
+  </buildentry>
+  <buildentry revision="2916" date="2007-04-02">
+    <comment>Updated x264 to SVN revision 636.</comment>
+  </buildentry>
+  <buildentry revision="2910" date="2007-03-29">
+  </buildentry>
+</log>

Added: branches/avidemux_2.5_branch_gruntster/platforms/windows/build_scripts/avidemux_2.4/Set Avidemux 2.4 Environment Variables.bat
===================================================================
--- branches/avidemux_2.5_branch_gruntster/platforms/windows/build_scripts/avidemux_2.4/Set Avidemux 2.4 Environment Variables.bat	2009-02-07 14:34:30 UTC (rev 4578)
+++ branches/avidemux_2.5_branch_gruntster/platforms/windows/build_scripts/avidemux_2.4/Set Avidemux 2.4 Environment Variables.bat	2009-02-08 17:04:43 UTC (rev 4579)
@@ -0,0 +1,50 @@
+call "..\Set Common Environment Variables"
+
+if errorlevel 1 goto error
+
+zip > NUL 2> NUL
+if errorlevel 1 (
+	echo Info-ZIP could not be found in the PATH.  Please download from http://www.info-zip.org
+	goto error
+)
+
+advzip > NUL 2> NUL
+if errorlevel 1 (
+	echo AdvanceCOMP could not be found in the PATH.  Please download from http://advancemame.sourceforge.net
+	goto error
+)
+
+svn help > NUL 2> NUL
+if errorlevel 1 (
+	echo Subversion could not be found in the PATH.  Please download from http://subversion.tigris.org/
+	goto error
+)
+
+xsltproc --version > NUL 2> NUL
+if errorlevel 1 (
+	echo xsltproc could not be found in the PATH.  Please download from http://www.zlatkovic.com
+	goto error
+)
+
+set buildDir=%devDir%\avidemux_2.4_build
+set curDir=%CD%
+cd ..\..\..\..
+set sourceDir=%CD%
+cd "%curDir%"
+
+if not exist "%buildDir%" (
+	echo Build directory could not be found at "%buildDir%".
+	goto error
+)
+
+if not exist "%sourceDir%" (
+	echo Source directory could not be found at "%sourceDir%".
+	goto error
+)
+
+goto end
+
+:error
+set ERRORLEVEL=1
+
+:end
\ No newline at end of file

Added: branches/avidemux_2.5_branch_gruntster/platforms/windows/build_scripts/avidemux_2.4/Tools/Get Revision Number.bat
===================================================================
--- branches/avidemux_2.5_branch_gruntster/platforms/windows/build_scripts/avidemux_2.4/Tools/Get Revision Number.bat	2009-02-07 14:34:30 UTC (rev 4578)
+++ branches/avidemux_2.5_branch_gruntster/platforms/windows/build_scripts/avidemux_2.4/Tools/Get Revision Number.bat	2009-02-08 17:04:43 UTC (rev 4579)
@@ -0,0 +1,10 @@
+if not exist "..\..\..\installer\revision.nsh" goto end
+
+copy "Revision No template.bat" + "..\..\..\installer\revision.nsh" temp.bat > NUL
+
+call temp.bat
+del temp.bat
+
+set revisionNo=%revisionNo:~17,4%
+
+:end
\ No newline at end of file

Added: branches/avidemux_2.5_branch_gruntster/platforms/windows/build_scripts/avidemux_2.4/Tools/Revision No template.bat
===================================================================
--- branches/avidemux_2.5_branch_gruntster/platforms/windows/build_scripts/avidemux_2.4/Tools/Revision No template.bat	2009-02-07 14:34:30 UTC (rev 4578)
+++ branches/avidemux_2.5_branch_gruntster/platforms/windows/build_scripts/avidemux_2.4/Tools/Revision No template.bat	2009-02-08 17:04:43 UTC (rev 4579)
@@ -0,0 +1 @@
+set revisionNo=
\ No newline at end of file

Added: branches/avidemux_2.5_branch_gruntster/platforms/windows/build_scripts/avidemux_2.4/Tools/gennotes.sh
===================================================================
--- branches/avidemux_2.5_branch_gruntster/platforms/windows/build_scripts/avidemux_2.4/Tools/gennotes.sh	2009-02-07 14:34:30 UTC (rev 4578)
+++ branches/avidemux_2.5_branch_gruntster/platforms/windows/build_scripts/avidemux_2.4/Tools/gennotes.sh	2009-02-08 17:04:43 UTC (rev 4579)
@@ -0,0 +1 @@
+xsltproc package_notes.xslt "../Package Notes.xml" > "Package Notes.html"
\ No newline at end of file

Added: branches/avidemux_2.5_branch_gruntster/platforms/windows/build_scripts/avidemux_2.4/Tools/gentouch.sh
===================================================================
--- branches/avidemux_2.5_branch_gruntster/platforms/windows/build_scripts/avidemux_2.4/Tools/gentouch.sh	2009-02-07 14:34:30 UTC (rev 4578)
+++ branches/avidemux_2.5_branch_gruntster/platforms/windows/build_scripts/avidemux_2.4/Tools/gentouch.sh	2009-02-08 17:04:43 UTC (rev 4579)
@@ -0,0 +1 @@
+xsltproc touch_files.xslt "../Package Notes.xml" > "../Touch 2.4 Files.html"
\ No newline at end of file

Added: branches/avidemux_2.5_branch_gruntster/platforms/windows/build_scripts/avidemux_2.4/Tools/package_notes.xslt
===================================================================
--- branches/avidemux_2.5_branch_gruntster/platforms/windows/build_scripts/avidemux_2.4/Tools/package_notes.xslt	2009-02-07 14:34:30 UTC (rev 4578)
+++ branches/avidemux_2.5_branch_gruntster/platforms/windows/build_scripts/avidemux_2.4/Tools/package_notes.xslt	2009-02-08 17:04:43 UTC (rev 4579)
@@ -0,0 +1,127 @@
+<?xml version="1.0" encoding="utf-8"?>
+
+<xsl:stylesheet version="1.0"
+    xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
+  <xsl:output method="html" indent="yes" />
+
+  <xsl:template match="log">
+    <html>
+      <head>
+        <meta content="text/html; charset=ISO-8859-1" http-equiv="content-type" />
+        <style type="text/css">
+          body {
+          margin: 10px 15px 0px 15px;
+          height: 100%;
+          font-size: 82%;
+          }
+
+          h1 {
+          padding: 0;
+          font-family: Helvetica,Arial,sans-serif;
+          font-size: 1.7em;
+          font-weight: bold;
+          color: #1B57B1;
+          vertical-align: bottom;
+          text-align: center;
+          width: 100%;
+          }
+
+          div, p, table, td, th {
+          font-family: Tahoma,Helvetica,Arial,sans-serif;
+          font-size: 1em;
+          color: #333;
+          }
+
+          table.build {
+          border-collapse: collapse;
+          border: 1px solid #ccc;
+          }
+
+          table.build td, table.roadmap th {
+          border: 1px solid #ccc;
+          }
+
+          table.build th {
+          background: #ddd;
+          padding: 5px;
+          }
+
+          table.build td {
+          background: #f7f7f7;
+          padding-left: 15px;
+          padding-right: 15px;
+          padding-top: 5px;
+          padding-bottom: 5px;
+          }
+        </style>
+        <title>Avidemux 2.4 Win32 Package Notes</title>
+      </head>
+      <body>
+        <h1>Avidemux 2.4 Win32 Package Notes</h1>
+        <div>
+          <xsl:apply-templates select="buildentry" />
+        </div>
+      </body>
+    </html>
+  </xsl:template>
+
+  <xsl:template match="buildentry">
+    <p>
+      <b>
+        <xsl:text>Revision&#160;</xsl:text>
+        <xsl:value-of select="@revision"/>
+      </b>
+      <xsl:text>&#160;(</xsl:text>
+      <xsl:call-template name="FormatDate">
+        <xsl:with-param name="Date" select="@date" />
+      </xsl:call-template>
+      <xsl:text>)</xsl:text>
+      <br/>
+
+      <xsl:for-each select="comment">
+        <li>
+          <xsl:value-of select="."/>
+        </li>
+      </xsl:for-each>
+    </p>
+  </xsl:template>
+
+  <xsl:template name="FormatDate">
+    <xsl:param name="Date"/>
+
+    <!-- Day -->
+    <xsl:value-of select="substring($Date, 9, 2)" />
+    <xsl:text>&#160;</xsl:text>
+
+    <!-- Month -->
+    <xsl:call-template name="FormatMonth">
+      <xsl:with-param name="Month" select="substring($Date, 6, 2)" />
+    </xsl:call-template>
+    <xsl:text>&#160;</xsl:text>
+
+    <!-- Year -->
+    <xsl:value-of select="substring($Date, 1, 4)"/>
+    <!-- <xsl:text>&#160;</xsl:text>-->
+
+    <!-- Time -->
+    <!-- <xsl:value-of select="substring($Date, 12, 8)"/>-->
+  </xsl:template>
+
+  <xsl:template name="FormatMonth">
+    <xsl:param name="Month"/>
+    <xsl:choose>
+      <xsl:when test="$Month = '01'">Jan</xsl:when>
+      <xsl:when test="$Month = '02'">Feb</xsl:when>
+      <xsl:when test="$Month = '03'">Mar</xsl:when>
+      <xsl:when test="$Month = '04'">Apr</xsl:when>
+      <xsl:when test="$Month = '05'">May</xsl:when>
+      <xsl:when test="$Month = '06'">Jun</xsl:when>
+      <xsl:when test="$Month = '07'">Jul</xsl:when>
+      <xsl:when test="$Month = '08'">Aug</xsl:when>
+      <xsl:when test="$Month = '09'">Sep</xsl:when>
+      <xsl:when test="$Month = '10'">Oct</xsl:when>
+      <xsl:when test="$Month = '11'">Nov</xsl:when>
+      <xsl:when test="$Month = '12'">Dec</xsl:when>
+    </xsl:choose>
+  </xsl:template>
+</xsl:stylesheet>
\ No newline at end of file

Added: branches/avidemux_2.5_branch_gruntster/platforms/windows/build_scripts/avidemux_2.4/Tools/touch_files.xslt
===================================================================
--- branches/avidemux_2.5_branch_gruntster/platforms/windows/build_scripts/avidemux_2.4/Tools/touch_files.xslt	2009-02-07 14:34:30 UTC (rev 4578)
+++ branches/avidemux_2.5_branch_gruntster/platforms/windows/build_scripts/avidemux_2.4/Tools/touch_files.xslt	2009-02-08 17:04:43 UTC (rev 4579)
@@ -0,0 +1,152 @@
+<xsl:stylesheet version="1.0"
+    xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
+  <xsl:output method="html" indent="yes" />
+
+  <xsl:template match="/">
+    <xsl:text disable-output-escaping="yes">&lt;?php
+      function touchDirContents($path, $time)
+      {
+        $dirHandle = opendir($path);
+
+        while (($resource = readdir($dirHandle)) != false)
+        {
+          if (is_file($path . "/" . $resource))
+          {
+            touch($path . "/" . $resource, $time);
+          }
+        }
+
+        closedir($dirHandle);
+      }
+      </xsl:text>
+    <xsl:apply-templates select="log" />
+    <xsl:text disable-output-escaping="yes">?&gt;</xsl:text>
+  </xsl:template>
+
+  <xsl:template match="log" mode="php">
+    <script language="php">
+      <xsl:apply-templates select="buildentry" />
+    </script>
+  </xsl:template>
+
+  <xsl:template match="buildentry">
+    <xsl:variable name="fileName">
+      <xsl:call-template name="getFileName">
+        <xsl:with-param name="revision" select="@revision" />
+      </xsl:call-template>
+    </xsl:variable>
+    <xsl:variable name="day">
+      <xsl:call-template name="getDay">
+        <xsl:with-param name="date" select="@date" />
+      </xsl:call-template>
+    </xsl:variable>
+    <xsl:variable name="month">
+      <xsl:call-template name="getMonth">
+        <xsl:with-param name="date" select="@date" />
+      </xsl:call-template>
+    </xsl:variable>
+    <xsl:variable name="year">
+      <xsl:call-template name="getYear">
+        <xsl:with-param name="date" select="@date" />
+      </xsl:call-template>
+    </xsl:variable>
+
+    <xsl:text>touch("</xsl:text>
+    <xsl:value-of select="$fileName" />
+    <xsl:text>", mktime(0, 0, 0, </xsl:text>
+    <xsl:value-of select="$month" />
+    <xsl:text>, </xsl:text>
+    <xsl:value-of select="$day" />
+    <xsl:text>, </xsl:text>
+    <xsl:value-of select="$year" />
+    <xsl:text>)); </xsl:text>
+
+    <xsl:text>touchDirContents("</xsl:text>
+    <xsl:value-of select="$fileName" />
+    <xsl:text>", mktime(0, 0, 0, </xsl:text>
+    <xsl:value-of select="$month" />
+    <xsl:text>, </xsl:text>
+    <xsl:value-of select="$day" />
+    <xsl:text>, </xsl:text>
+    <xsl:value-of select="$year" />
+    <xsl:text>)); </xsl:text>
+  </xsl:template>
+
+  <xsl:template name='getDay'>
+    <xsl:param name='date' />
+    <xsl:variable name="day" select="substring(@date, 9, 2)"/>
+    <xsl:choose>
+      <xsl:when test="starts-with($day, '0')">
+        <xsl:value-of select="substring($day, 2)" />
+      </xsl:when>
+      <xsl:otherwise>
+        <xsl:value-of select="$day" />
+      </xsl:otherwise>
+    </xsl:choose>
+  </xsl:template>
+
+  <xsl:template name='getMonth'>
+    <xsl:param name='date' />
+    <xsl:variable name="month" select="substring(@date, 6, 2)"/>
+    <xsl:choose>
+      <xsl:when test="starts-with($month, '0')">
+        <xsl:value-of select="substring($month, 2)" />
+      </xsl:when>
+      <xsl:otherwise>
+        <xsl:value-of select="$month" />
+      </xsl:otherwise>
+    </xsl:choose>
+  </xsl:template>
+
+  <xsl:template name='getYear'>
+    <xsl:param name='date' />
+    <xsl:value-of select="substring(@date, 1, 4)"/>
+  </xsl:template>
+
+  <xsl:template name='getFileName'>
+    <xsl:param name='revision' />
+
+    <xsl:text>2.4/</xsl:text>
+
+    <xsl:choose>
+      <xsl:when test="contains($revision, 'Final')">
+        <xsl:text>Milestone/</xsl:text>
+        <xsl:variable name="version" select="substring-after($revision, ' [')"/>
+        <xsl:value-of select="substring-before($version, ' ')" />
+        <xsl:text>_(</xsl:text>
+        <xsl:value-of select="substring-before($revision, ' [')" />
+        <xsl:text>)</xsl:text>
+      </xsl:when>
+      <xsl:otherwise>
+        <xsl:text>SVN/</xsl:text>
+        <xsl:choose>
+          <xsl:when test="contains($revision, 'Preview')">
+            <xsl:variable name="version" select="substring-after($revision, ' [')"/>
+            <xsl:variable name="minorVersion" select="substring-after($version, ' ')"/>
+            <xsl:value-of select="substring-before($revision, ' [')"/>
+            <xsl:text>_</xsl:text>
+            <xsl:call-template name="convertToLower">
+              <xsl:with-param name="toconvert" select="translate(substring-before($minorVersion, ']'), ' ', '_')" />
+            </xsl:call-template>
+          </xsl:when>
+          <xsl:when test="contains($revision, 'Release')">
+            <xsl:value-of select="substring-before($revision, ' [')" />
+            <xsl:text>_r</xsl:text>
+            <xsl:variable name="version" select="substring-after($revision, ' [Release ')"/>
+            <xsl:value-of select="substring-before($version, ']')" />
+          </xsl:when>
+          <xsl:otherwise>
+            <xsl:value-of select="$revision"/>
+          </xsl:otherwise>
+        </xsl:choose>
+      </xsl:otherwise>
+    </xsl:choose>
+  </xsl:template>
+
+  <xsl:template name='convertToLower'>
+    <xsl:param name='toconvert' />
+    <xsl:variable name="lcletters">abcdefghijklmnopqrstuvwxyz</xsl:variable>
+    <xsl:variable name="ucletters">ABCDEFGHIJKLMNOPQRSTUVWXYZ</xsl:variable>
+    <xsl:value-of select="translate($toconvert,$ucletters,$lcletters)" />
+  </xsl:template>
+</xsl:stylesheet>
\ No newline at end of file

Added: branches/avidemux_2.5_branch_gruntster/platforms/windows/installer/InstallOptions.ini
===================================================================
--- branches/avidemux_2.5_branch_gruntster/platforms/windows/installer/InstallOptions.ini	2009-02-07 14:34:30 UTC (rev 4578)
+++ branches/avidemux_2.5_branch_gruntster/platforms/windows/installer/InstallOptions.ini	2009-02-08 17:04:43 UTC (rev 4579)
@@ -0,0 +1,37 @@
+[Settings]
+NumFields=4
+
+[Field 1]
+Type=label
+Text=Create icons for Avidemux:
+Left=0
+Right=-1
+Top=10
+Bottom=20
+
+[Field 2]
+Type=checkbox
+Text=On my &Desktop
+Left=12
+Right=-1
+Top=28
+Bottom=38
+State=1
+
+[Field 3]
+Type=checkbox
+Text=In my &Start Menu Programs folder
+Left=12
+Right=-1
+Top=46
+Bottom=56
+State=1
+
+[Field 4]
+Type=checkbox
+Text=In my &Quick Launch bar
+Left=12
+Right=-1
+Top=64
+Bottom=74
+State=1
\ No newline at end of file

Added: branches/avidemux_2.5_branch_gruntster/platforms/windows/installer/License.rtf
===================================================================
--- branches/avidemux_2.5_branch_gruntster/platforms/windows/installer/License.rtf	2009-02-07 14:34:30 UTC (rev 4578)
+++ branches/avidemux_2.5_branch_gruntster/platforms/windows/installer/License.rtf	2009-02-08 17:04:43 UTC (rev 4579)
@@ -0,0 +1,102 @@
+{\rtf1\ansi\ansicpg1252\deff0\deflang2057{\fonttbl{\f0\fswiss\fprq2\fcharset0 Arial;}{\f1\fswiss\fcharset0 Arial;}}
+{\*\generator Msftedit 5.41.15.1507;}\viewkind4\uc1\pard\nowidctlpar\f0\fs20 Avidemux is free software; you can redistribute it and/or modify it under the terms of the GNU General Public License version 2 as published by the Free Software Foundation.\b\par
+\par
+\pard\nowidctlpar\qc GNU GENERAL PUBLIC LICENSE\par
+Version 2, June 1991\b0\par
+\pard\nowidctlpar\par
+\pard\nowidctlpar\qc Copyright (C) 1989, 1991 Free Software Foundation, Inc.\par
+\lang1036 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA\par
+\par
+\pard\nowidctlpar\qj\lang2057 Everyone is permitted to copy and distribute verbatim copies of this license document, but changing it is not allowed.\par
+\pard\nowidctlpar\par
+\pard\nowidctlpar\qc\b Preamble\par
+\pard\nowidctlpar\b0\par
+\pard\nowidctlpar\qj The licenses for most software are designed to take away your freedom to share and change it.  By contrast, the GNU General Public License is intended to guarantee your freedom to share and change free software--to make sure the software is free for all its users.  This General Public License applies to most of the Free Software Foundation's software and to any other program whose authors commit to using it.  (Some other Free Software Foundation software is covered by the GNU Library General Public License instead.)  You can apply it to your programs, too.\par
+\par
+When we speak of free software, we are referring to freedom, not price.  Our General Public Licenses are designed to make sure that you have the freedom to distribute copies of free software (and charge for this service if you wish), that you receive source code or can get it if you want it, that you can change the software or use pieces of it in new free programs; and that you know you can do these things.\par
+\par
+To protect your rights, we need to make restrictions that forbid anyone to deny you these rights or to ask you to surrender the rights. These restrictions translate to certain responsibilities for you if you distribute copies of the software, or if you modify it.\par
+\par
+For example, if you distribute copies of such a program, whether gratis or for a fee, you must give the recipients all the rights that you have.  You must make sure that they, too, receive or can get the source code.  And you must show them these terms so they know their rights.\par
+\par
+We protect your rights with two steps: (1) copyright the software, and (2) offer you this license which gives you legal permission to copy, distribute and/or modify the software.\par
+\par
+Also, for each author's protection and ours, we want to make certain that everyone understands that there is no warranty for this free software.  If the software is modified by someone else and passed on, we want its recipients to know that what they have is not the original, so that any problems introduced by others will not reflect on the original authors' reputations.\par
+\par
+Finally, any free program is threatened constantly by software patents.  We wish to avoid the danger that redistributors of a free program will individually obtain patent licenses, in effect making the program proprietary.  To prevent this, we have made it clear that any patent must be licensed for everyone's free use or not licensed at all.\par
+\par
+The precise terms and conditions for copying, distribution and modification follow.\par
+\pard\nowidctlpar\par
+\par
+\pard\nowidctlpar\qc\b GNU GENERAL PUBLIC LICENSE\par
+TERMS AND CONDITIONS FOR COPYING, DISTRIBUTION AND MODIFICATION\par
+\pard\nowidctlpar\b0\par
+\pard\nowidctlpar\qj 0. This License applies to any program or other work which contains a notice placed by the copyright holder saying it may be distributed under the terms of this General Public License.  The "Program", below, refers to any such program or work, and a "work based on the Program" means either the Program or any derivative work under copyright law: that is to say, a work containing the Program or a portion of it, either verbatim or with modifications and/or translated into another language.  (Hereinafter, translation is included without limitation in the term "modification".)  Each licensee is addressed as "you".\par
+\par
+Activities other than copying, distribution and modification are not covered by this License; they are outside its scope.  The act of running the Program is not restricted, and the output from the Program is covered only if its contents constitute a work based on the Program (independent of having been made by running the Program). Whether that is true depends on what the Program does.\par
+\par
+1. You may copy and distribute verbatim copies of the Program's source code as you receive it, in any medium, provided that you conspicuously and appropriately publish on each copy an appropriate copyright notice and disclaimer of warranty; keep intact all the notices that refer to this License and to the absence of any warranty; and give any other recipients of the Program a copy of this License along with the Program.\par
+\par
+You may charge a fee for the physical act of transferring a copy, and you may at your option offer warranty protection in exchange for a fee.\par
+\par
+2. You may modify your copy or copies of the Program or any portion of it, thus forming a work based on the Program, and copy and distribute such modifications or work under the terms of Section 1 above, provided that you also meet all of these conditions:\par
+\par
+a) You must cause the modified files to carry prominent notices stating that you changed the files and the date of any change.\par
+\par
+b) You must cause any work that you distribute or publish, that in whole or in part contains or is derived from the Program or any part thereof, to be licensed as a whole at no charge to all third parties under the terms of this License.\par
+\par
+c) If the modified program normally reads commands interactively when run, you must cause it, when started running for such interactive use in the most ordinary way, to print or display an announcement including an appropriate copyright notice and a notice that there is no warranty (or else, saying that you provide a warranty) and that users may redistribute the program under these conditions, and telling the user how to view a copy of this License.  (Exception: if the Program itself is interactive but does not normally print such an announcement, your work based on the Program is not required to print an announcement.)\par
+\par
+\par
+These requirements apply to the modified work as a whole.  If identifiable sections of that work are not derived from the Program, and can be reasonably considered independent and separate works in themselves, then this License, and its terms, do not apply to those sections when you distribute them as separate works.  But when you distribute the same sections as part of a whole which is a work based on the Program, the distribution of the whole must be on the terms of this License, whose permissions for other licensees extend to the entire whole, and thus to each and every part regardless of who wrote it.\par
+\par
+Thus, it is not the intent of this section to claim rights or contest your rights to work written entirely by you; rather, the intent is to exercise the right to control the distribution of derivative or collective works based on the Program.\par
+\par
+In addition, mere aggregation of another work not based on the Program with the Program (or with a work based on the Program) on a volume of a storage or distribution medium does not bring the other work under the scope of this License.\par
+\par
+3. You may copy and distribute the Program (or a work based on it, under Section 2) in object code or executable form under the terms of Sections 1 and 2 above provided that you also do one of the following:\par
+\par
+a) Accompany it with the complete corresponding machine-readable source code, which must be distributed under the terms of Sections 1 and 2 above on a medium customarily used for software interchange; or,\par
+\par
+b) Accompany it with a written offer, valid for at least three years, to give any third party, for a charge no more than your cost of physically performing source distribution, a complete machine-readable copy of the corresponding source code, to be distributed under the terms of Sections 1 and 2 above on a medium customarily used for software interchange; or,\par
+\par
+c) Accompany it with the information you received as to the offer to distribute corresponding source code.  (This alternative is allowed only for noncommercial distribution and only if you received the program in object code or executable form with such an offer, in accord with Subsection b above.)\par
+\par
+The source code for a work means the preferred form of the work for making modifications to it.  For an executable work, complete source code means all the source code for all modules it contains, plus any associated interface definition files, plus the scripts used to control compilation and installation of the executable.  However, as a special exception, the source code distributed need not include anything that is normally distributed (in either source or binary form) with the major components (compiler, kernel, and so on) of the operating system on which the executable runs, unless that component itself accompanies the executable.\par
+\par
+If distribution of executable or object code is made by offering access to copy from a designated place, then offering equivalent access to copy the source code from the same place counts as distribution of the source code, even though third parties are not compelled to copy the source along with the object code.\par
+\par
+\par
+4. You may not copy, modify, sublicense, or distribute the Program except as expressly provided under this License.  Any attempt otherwise to copy, modify, sublicense or distribute the Program is void, and will automatically terminate your rights under this License. However, parties who have received copies, or rights, from you under this License will not have their licenses terminated so long as such parties remain in full compliance.\par
+\par
+5. You are not required to accept this License, since you have not signed it.  However, nothing else grants you permission to modify or distribute the Program or its derivative works.  These actions are prohibited by law if you do not accept this License.  Therefore, by modifying or distributing the Program (or any work based on the Program), you indicate your acceptance of this License to do so, and all its terms and conditions for copying, distributing or modifying the Program or works based on it.\par
+\par
+6. Each time you redistribute the Program (or any work based on the Program), the recipient automatically receives a license from the original licensor to copy, distribute or modify the Program subject to these terms and conditions.  You may not impose any further restrictions on the recipients' exercise of the rights granted herein. You are not responsible for enforcing compliance by third parties to this License.\par
+\par
+7. If, as a consequence of a court judgment or allegation of patent infringement or for any other reason (not limited to patent issues), conditions are imposed on you (whether by court order, agreement or otherwise) that contradict the conditions of this License, they do not excuse you from the conditions of this License.  If you cannot distribute so as to satisfy simultaneously your obligations under this License and any other pertinent obligations, then as a consequence you may not distribute the Program at all.  For example, if a patent license would not permit royalty-free redistribution of the Program by all those who receive copies directly or indirectly through you, then the only way you could satisfy both it and this License would be to refrain entirely from distribution of the Program.\par
+\par
+If any portion of this section is held invalid or unenforceable under any particular circumstance, the balance of the section is intended to apply and the section as a whole is intended to apply in other circumstances.\par
+\par
+It is not the purpose of this section to induce you to infringe any patents or other property right claims or to contest validity of any such claims; this section has the sole purpose of protecting the integrity of the free software distribution system, which is implemented by public license practices.  Many people have made generous contributions to the wide range of software distributed through that system in reliance on consistent application of that system; it is up to the author/donor to decide if he or she is willing to distribute software through any other system and a licensee cannot impose that choice.\par
+\par
+This section is intended to make thoroughly clear what is believed to be a consequence of the rest of this License.\par
+\par
+\par
+8. If the distribution and/or use of the Program is restricted in certain countries either by patents or by copyrighted interfaces, the original copyright holder who places the Program under this License may add an explicit geographical distribution limitation excluding those countries, so that distribution is permitted only in or among countries not thus excluded.  In such case, this License incorporates the limitation as if written in the body of this License.\par
+\par
+9. The Free Software Foundation may publish revised and/or new versions of the General Public License from time to time.  Such new versions will be similar in spirit to the present version, but may differ in detail to address new problems or concerns.\par
+\par
+Each version is given a distinguishing version number.  If the Program specifies a version number of this License which applies to it and "any later version", you have the option of following the terms and conditions either of that version or of any later version published by the Free Software Foundation.  If the Program does not specify a version number of this License, you may choose any version ever published by the Free Software Foundation.\par
+\par
+10. If you wish to incorporate parts of the Program into other free programs whose distribution conditions are different, write to the author to ask for permission.  For software which is copyrighted by the Free Software Foundation, write to the Free Software Foundation; we sometimes make exceptions for this.  Our decision will be guided by the two goals of preserving the free status of all derivatives of our free software and of promoting the sharing and reuse of software generally.\par
+\pard\nowidctlpar\par
+\pard\nowidctlpar\qc\b NO WARRANTY\par
+\pard\nowidctlpar\b0\par
+\pard\nowidctlpar\qj 11. BECAUSE THE PROGRAM IS LICENSED FREE OF CHARGE, THERE IS NO WARRANTY FOR THE PROGRAM, TO THE EXTENT PERMITTED BY APPLICABLE LAW.  EXCEPT WHEN OTHERWISE STATED IN WRITING THE COPYRIGHT HOLDERS AND/OR OTHER PARTIES PROVIDE THE PROGRAM "AS IS" WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESSED OR IMPLIED, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  THE ENTIRE RISK AS TO THE QUALITY AND PERFORMANCE OF THE PROGRAM IS WITH YOU.  SHOULD THE PROGRAM PROVE DEFECTIVE, YOU ASSUME THE COST OF ALL NECESSARY SERVICING, REPAIR OR CORRECTION.\par
+\par
+12. IN NO EVENT UNLESS REQUIRED BY APPLICABLE LAW OR AGREED TO IN WRITING WILL ANY COPYRIGHT HOLDER, OR ANY OTHER PARTY WHO MAY MODIFY AND/OR REDISTRIBUTE THE PROGRAM AS PERMITTED ABOVE, BE LIABLE TO YOU FOR DAMAGES, INCLUDING ANY GENERAL, SPECIAL, INCIDENTAL OR CONSEQUENTIAL DAMAGES ARISING OUT OF THE USE OR INABILITY TO USE THE PROGRAM (INCLUDING BUT NOT LIMITED TO LOSS OF DATA OR DATA BEING RENDERED INACCURATE OR LOSSES SUSTAINED BY YOU OR THIRD PARTIES OR A FAILURE OF THE PROGRAM TO OPERATE WITH ANY OTHER PROGRAMS), EVEN IF SUCH HOLDER OR OTHER PARTY HAS BEEN ADVISED OF THE POSSIBILITY OF SUCH DAMAGES.\par
+\pard\nowidctlpar\par
+\pard\nowidctlpar\qc\b END OF TERMS AND CONDITIONS\par
+\pard\b0\f1\par
+}
+
\ No newline at end of file

Added: branches/avidemux_2.5_branch_gruntster/platforms/windows/installer/PageHeader.bmp
===================================================================
(Binary files differ)


Property changes on: branches/avidemux_2.5_branch_gruntster/platforms/windows/installer/PageHeader.bmp
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Added: branches/avidemux_2.5_branch_gruntster/platforms/windows/installer/WelcomeFinishStrip.bmp
===================================================================
(Binary files differ)


Property changes on: branches/avidemux_2.5_branch_gruntster/platforms/windows/installer/WelcomeFinishStrip.bmp
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Added: branches/avidemux_2.5_branch_gruntster/platforms/windows/installer/avidemux.nsi
===================================================================
--- branches/avidemux_2.5_branch_gruntster/platforms/windows/installer/avidemux.nsi	2009-02-07 14:34:30 UTC (rev 4578)
+++ branches/avidemux_2.5_branch_gruntster/platforms/windows/installer/avidemux.nsi	2009-02-08 17:04:43 UTC (rev 4579)
@@ -0,0 +1,822 @@
+##########################
+# Included files
+##########################
+!include Sections.nsh
+!include MUI.nsh
+!include WinMessages.nsh
+!include revision.nsh
+!include builddir.nsh
+
+Name "Avidemux 2.4.3 beta r${REVISION}"
+
+SetCompressor /SOLID lzma
+SetCompressorDictSize 96
+
+##########################
+# Defines
+##########################
+!define INTERNALNAME "Avidemux 2.4"
+!define REGKEY "SOFTWARE\${INTERNALNAME}"
+!define UNINST_REGKEY "SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall\${INTERNALNAME}"
+!define VERSION 2.4.3.${REVISION}
+!define COMPANY "Free Software Foundation"
+!define URL "http://www.avidemux.org"
+
+!define INSTALL_OPTS_INI "InstallOptions.ini"
+
+##########################
+# MUI defines
+##########################
+!define MUI_ICON "${NSISDIR}\Contrib\Graphics\Icons\modern-install-blue-full.ico"
+!define MUI_HEADERIMAGE
+!define MUI_HEADERIMAGE_RIGHT
+!define MUI_HEADERIMAGE_BITMAP "PageHeader.bmp"
+!define MUI_STARTMENUPAGE_REGISTRY_ROOT HKLM
+!define MUI_STARTMENUPAGE_REGISTRY_KEY "${REGKEY}"
+!define MUI_STARTMENUPAGE_REGISTRY_VALUENAME StartMenuGroup
+!define MUI_STARTMENUPAGE_DEFAULTFOLDER Avidemux
+!define MUI_STARTMENUPAGE_NODISABLE
+!define MUI_WELCOMEFINISHPAGE_BITMAP "WelcomeFinishStrip.bmp"
+!define MUI_UNICON "..\..\..\avidemux\xpm\adm.ico"
+!define MUI_UNFINISHPAGE_NOAUTOCLOSE
+!define MUI_COMPONENTSPAGE_NODESC
+
+##########################
+# Variables
+##########################
+Var CreateDesktopIcon
+Var CreateStartMenuGroup
+Var CreateQuickLaunchIcon
+Var StartMenuGroup
+
+##########################
+# Installer pages
+##########################
+!insertmacro MUI_PAGE_WELCOME
+!insertmacro MUI_PAGE_LICENSE License.rtf
+!define MUI_PAGE_CUSTOMFUNCTION_LEAVE CheckSelectedUIs
+!insertmacro MUI_PAGE_COMPONENTS
+Page custom InstallOptionsPage
+!define MUI_PAGE_CUSTOMFUNCTION_PRE IsStartMenuRequired
+!insertmacro MUI_PAGE_STARTMENU Application $StartMenuGroup
+!insertmacro MUI_PAGE_DIRECTORY
+!define MUI_PAGE_CUSTOMFUNCTION_PRE ActivateInternalSections
+!insertmacro MUI_PAGE_INSTFILES
+!define MUI_FINISHPAGE_RUN
+!define MUI_FINISHPAGE_RUN_FUNCTION RunAvidemux
+!define MUI_FINISHPAGE_RUN_TEXT "Run ${INTERNALNAME} now"
+!define MUI_FINISHPAGE_SHOWREADME "$INSTDIR\Change Log.html"
+!define MUI_FINISHPAGE_SHOWREADME_TEXT "View Change Log now"
+!define MUI_FINISHPAGE_LINK "Visit the Avidemux Win32 Builds website"
+!define MUI_FINISHPAGE_LINK_LOCATION "http://www.razorbyte.com.au/avidemux/"
+!define MUI_PAGE_CUSTOMFUNCTION_PRE ConfigureFinishPage
+!define MUI_PAGE_CUSTOMFUNCTION_SHOW OnShowFinishPage
+!insertmacro MUI_PAGE_FINISH
+!insertmacro MUI_UNPAGE_CONFIRM
+!insertmacro MUI_UNPAGE_INSTFILES
+
+##########################
+# Installer languages
+##########################
+!insertmacro MUI_LANGUAGE English
+
+##########################
+#Reserve files
+##########################
+ReserveFile "${INSTALL_OPTS_INI}"
+!insertmacro MUI_RESERVEFILE_INSTALLOPTIONS
+
+##########################
+# Installer attributes
+##########################
+OutFile avidemux_2.4_r${REVISION}_win32.exe
+InstallDir "$PROGRAMFILES\Avidemux 2.4"
+CRCCheck on
+XPStyle on
+ShowInstDetails nevershow
+VIProductVersion 2.4.3.${REVISION}
+VIAddVersionKey ProductName Avidemux
+VIAddVersionKey ProductVersion "${VERSION} (beta)"
+VIAddVersionKey FileVersion ""
+VIAddVersionKey FileDescription ""
+VIAddVersionKey LegalCopyright ""
+InstallDirRegKey HKLM "${REGKEY}" Path
+ShowUninstDetails nevershow
+BrandingText "Packaged by Gruntster"
+InstType Standard
+InstType Full
+
+##########################
+# Macros
+##########################
+!macro InstallGtkLanguage LANG_NAME LANG_CODE
+	SetOverwrite on
+
+	!insertmacro SectionFlagIsSet ${SecUiGtk} ${SF_SELECTED} installGtk${LANG_CODE} endGtk${LANG_CODE}
+
+installGtk${LANG_CODE}:
+    SetOutPath $INSTDIR\share\locale\${LANG_CODE}\LC_MESSAGES
+    File ${BUILDDIR}\share\locale\${LANG_CODE}\LC_MESSAGES\avidemux.mo
+    File ${BUILDDIR}\share\locale\${LANG_CODE}\LC_MESSAGES\gtk20.mo
+
+    WriteRegStr HKLM "${REGKEY}\Components" ${LANG_NAME} 1
+endGtk${LANG_CODE}:
+!macroend
+
+!macro InstallQt4Language LANG_NAME LANG_CODE
+	SetOverwrite on
+
+	!insertmacro SectionFlagIsSet ${SecUiQt4} ${SF_SELECTED} installQt4${LANG_CODE} endQt4${LANG_CODE}
+
+installQt4${LANG_CODE}:	
+	SetOutPath $INSTDIR\i18n
+    File ${BUILDDIR}\i18n\avidemux_${LANG_CODE}.qm
+    File ${BUILDDIR}\i18n\qt_${LANG_CODE}.qm
+    
+    WriteRegStr HKLM "${REGKEY}\Components" ${LANG_NAME} 1
+endQt4${LANG_CODE}:    
+!macroend
+
+!macro UninstallLanguage LANG_NAME LANG_CODE
+    RmDir /r /REBOOTOK $INSTDIR\share\locale\${LANG_CODE}
+    Delete /REBOOTOK $INSTDIR\i18n\avidemux_${LANG_CODE}.qm
+    Delete /REBOOTOK $INSTDIR\i18n\qt_${LANG_CODE}.qm
+    
+    DeleteRegValue HKLM "${REGKEY}\Components" ${LANG_NAME}
+!macroend
+
+# Macro for selecting sections based on registry setting
+!macro SELECT_SECTION SECTION_NAME SECTION_ID
+    Push $R0
+    ReadRegStr $R0 HKLM "${REGKEY}\Components" "${SECTION_NAME}"
+    StrCmp $R0 1 0 next${SECTION_ID}
+    !insertmacro SelectSection "${SECTION_ID}"
+    GoTo done${SECTION_ID}
+next${SECTION_ID}:
+    !insertmacro UnselectSection "${SECTION_ID}"
+done${SECTION_ID}:
+    Pop $R0
+!macroend
+
+##########################
+# Installer sections
+##########################
+Section "Core files (required)" SecCore
+    SectionIn 1 2 RO
+    SetOutPath $INSTDIR
+    SetOverwrite on
+    File "${BUILDDIR}\Build Info.txt"
+    File "${BUILDDIR}\Change Log.html"
+    File ${BUILDDIR}\zlib1.dll
+    File ${BUILDDIR}\freetype6.dll
+    File ${BUILDDIR}\iconv.dll
+    File ${BUILDDIR}\intl.dll
+    File ${BUILDDIR}\libaften.dll
+    File ${BUILDDIR}\libexpat-*.dll
+    File ${BUILDDIR}\libfaac.dll
+    File ${BUILDDIR}\libfaad2.dll
+    File ${BUILDDIR}\libfontconfig-1.dll
+    File ${BUILDDIR}\libmp3lame-0.dll
+    File ${BUILDDIR}\libx264-*.dll
+    File ${BUILDDIR}\libxml2.dll
+    File ${BUILDDIR}\ogg.dll
+    File ${BUILDDIR}\pthreadGC2.dll
+    File ${BUILDDIR}\SDL.dll
+    File ${BUILDDIR}\vorbis.dll
+    File ${BUILDDIR}\vorbisenc.dll
+    File ${BUILDDIR}\xmltok.dll
+    File ${BUILDDIR}\xvidcore.dll
+    SetOutPath $INSTDIR\etc\fonts
+    File /r ${BUILDDIR}\etc\fonts\*
+
+    # if $PROFILE\avidemux exists and $APPDATA\avidemux doesn't, then move it
+    IfFileExists "$PROFILE\avidemux" 0 end
+    IfFileExists "$APPDATA\avidemux" end
+
+    Rename "$PROFILE\avidemux" "$APPDATA\avidemux"
+
+end:
+    WriteRegStr HKLM "${REGKEY}\Components" "Core files (required)" 1
+SectionEnd
+
+SectionGroup /e "User interfaces" SecGrpUI
+    Section "Command line" SecUiCli
+        SectionIn 1 2
+        SetOutPath $INSTDIR
+        SetOverwrite on
+        File ${BUILDDIR}\avidemux2_cli.exe
+        WriteRegStr HKLM "${REGKEY}\Components" "Command line" 1
+    SectionEnd
+
+    Section GTK+ SecUiGtk
+        SectionIn 2
+        SetOverwrite on
+        SetOutPath $INSTDIR\etc\gtk-2.0
+        File /r ${BUILDDIR}\etc\gtk-2.0\*
+        SetOutPath $INSTDIR\etc\pango
+        File /r ${BUILDDIR}\etc\pango\*
+        SetOutPath $INSTDIR\lib\gtk-2.0
+        File /r ${BUILDDIR}\lib\gtk-2.0\*
+        SetOutPath $INSTDIR\share\themes
+        File /r ${BUILDDIR}\share\themes\*
+        SetOutPath $INSTDIR
+        File ${BUILDDIR}\avidemux2_gtk.exe
+        File ${BUILDDIR}\gtk2_prefs.exe
+        File ${BUILDDIR}\jpeg62.dll
+        File ${BUILDDIR}\libatk-1.0-0.dll
+        File ${BUILDDIR}\libcairo-2.dll
+        File ${BUILDDIR}\libgdk_pixbuf-2.0-0.dll
+        File ${BUILDDIR}\libgdk-win32-2.0-0.dll
+        File ${BUILDDIR}\libgio-2.0-0.dll
+        File ${BUILDDIR}\libglib-2.0-0.dll
+        File ${BUILDDIR}\libgmodule-2.0-0.dll
+        File ${BUILDDIR}\libgobject-2.0-0.dll
+        File ${BUILDDIR}\libgthread-2.0-0.dll
+        File ${BUILDDIR}\libgtk-win32-2.0-0.dll
+        File ${BUILDDIR}\libpango-1.0-0.dll
+        File ${BUILDDIR}\libpangocairo-1.0-0.dll
+        File ${BUILDDIR}\libpangowin32-1.0-0.dll
+        File ${BUILDDIR}\libpng12-0.dll
+        File ${BUILDDIR}\libtiff3.dll
+        WriteRegStr HKLM "${REGKEY}\Components" GTK+ 1
+    SectionEnd
+    
+    Section Qt4 SecUiQt4
+        SectionIn 1 2
+        SetOutPath $INSTDIR
+        SetOverwrite on
+        File ${BUILDDIR}\QtGui4.dll
+        File ${BUILDDIR}\avidemux2_qt4.exe
+        File ${BUILDDIR}\mingwm10.dll
+        File ${BUILDDIR}\QtCore4.dll
+        WriteRegStr HKLM "${REGKEY}\Components" Qt4 1
+    SectionEnd    
+SectionGroupEnd
+
+SectionGroup "Additional languages" SecGrpLang
+    Section "Catalan (GTK+ only)" SecLangCatalan
+        SectionIn 2
+        !insertmacro InstallGtkLanguage Catalan ca
+    SectionEnd
+
+    Section "Czech" SecLangCzech
+        SectionIn 2
+        !insertmacro InstallGtkLanguage Czech cs
+        !insertmacro InstallQt4Language Czech cs
+    SectionEnd
+
+    Section "French" SecLangFrench
+        SectionIn 2
+        !insertmacro InstallGtkLanguage French fr
+        !insertmacro InstallQt4Language French fr
+    SectionEnd
+
+    Section "German (GTK+ only)" SecLangGerman
+        SectionIn 2
+        !insertmacro InstallGtkLanguage German de
+    SectionEnd
+
+    Section "Greek (GTK+ only)" SecLangGreek
+        SectionIn 2
+        !insertmacro InstallGtkLanguage Greek el
+    SectionEnd
+
+    Section "Italian" SecLangItalian
+        SectionIn 2
+        !insertmacro InstallGtkLanguage Italian it
+        !insertmacro InstallQt4Language Italian it
+    SectionEnd
+
+    Section "Japanese (GTK+ only)" SecLangJapanese
+        SectionIn 2
+        !insertmacro InstallGtkLanguage Japanese ja
+    SectionEnd
+
+    Section "Russian (GTK+ only)" SecLangRussian
+        SectionIn 2
+        !insertmacro InstallGtkLanguage Russian ru
+    SectionEnd
+
+    Section "Serbian Cyrillic (GTK+ only)" SecLangSerbianCyrillic
+        SectionIn 2
+        !insertmacro InstallGtkLanguage SerbianCyrillic sr
+    SectionEnd
+
+    Section "Serbian Latin (GTK+ only)" SecLangSerbianLatin
+        SectionIn 2
+        !insertmacro InstallGtkLanguage SerbianLatin sr at latin
+    SectionEnd
+
+    Section "Spanish (GTK+ only)" SecLangSpanish
+        SectionIn 2
+        !insertmacro InstallGtkLanguage Spanish es
+    SectionEnd
+
+    Section "Turkish (GTK+ only)" SecLangTurkish
+        SectionIn 2
+        !insertmacro InstallGtkLanguage Turkish tr
+    SectionEnd
+SectionGroupEnd
+
+Section AvsProxy SecAvsProxy
+    SectionIn 2
+    SetOutPath $INSTDIR
+    SetOverwrite on
+    File /r ${BUILDDIR}\avsproxy.exe
+    File /r ${BUILDDIR}\avsproxy_gui.exe
+    WriteRegStr HKLM "${REGKEY}\Components" "AvsProxy" 1
+SectionEnd
+
+Section "Sample external filter" SecFilter
+    SectionIn 2
+    SetOutPath $INSTDIR\plugin
+    SetOverwrite on
+    File /r ${BUILDDIR}\plugin\*
+    WriteRegStr HKLM "${REGKEY}\Components" "Sample external filter" 1
+SectionEnd
+
+Section "-Start menu Change Log" SecStartMenuChangeLog
+    CreateDirectory $SMPROGRAMS\$StartMenuGroup
+    !insertmacro MUI_STARTMENU_WRITE_BEGIN Application
+    SetOutPath $INSTDIR
+    CreateShortcut "$SMPROGRAMS\$StartMenuGroup\Change Log.lnk" "$INSTDIR\Change Log.html"
+    !insertmacro MUI_STARTMENU_WRITE_END
+    WriteRegStr HKLM "${REGKEY}\Components" "Start menu" 1
+SectionEnd
+
+Section "-Start menu GTK+" SecStartMenuGtk
+    CreateDirectory $SMPROGRAMS\$StartMenuGroup
+    !insertmacro MUI_STARTMENU_WRITE_BEGIN Application
+    SetOutPath $INSTDIR
+    CreateShortcut "$SMPROGRAMS\$StartMenuGroup\${INTERNALNAME} GTK+.lnk" $INSTDIR\avidemux2_gtk.exe
+    !insertmacro MUI_STARTMENU_WRITE_END
+    WriteRegStr HKLM "${REGKEY}\Components" "Start menu" 1
+SectionEnd
+
+Section "-Start menu Qt4" SecStartMenuQt4
+    CreateDirectory $SMPROGRAMS\$StartMenuGroup
+    !insertmacro MUI_STARTMENU_WRITE_BEGIN Application
+    SetOutPath $INSTDIR
+    CreateShortcut "$SMPROGRAMS\$StartMenuGroup\${INTERNALNAME} Qt4.lnk" $INSTDIR\avidemux2_qt4.exe
+    !insertmacro MUI_STARTMENU_WRITE_END
+    WriteRegStr HKLM "${REGKEY}\Components" "Start menu" 1
+SectionEnd
+
+Section "-Start menu AVS Proxy GUI" SecStartMenuAvsProxyGui
+    CreateDirectory $SMPROGRAMS\$StartMenuGroup
+    !insertmacro MUI_STARTMENU_WRITE_BEGIN Application
+    SetOutPath $INSTDIR
+    CreateShortcut "$SMPROGRAMS\$StartMenuGroup\AVS Proxy GUI.lnk" "$INSTDIR\avsproxy_gui.exe"
+    !insertmacro MUI_STARTMENU_WRITE_END
+    WriteRegStr HKLM "${REGKEY}\Components" "Start menu" 1
+SectionEnd
+
+Section "-Quick Launch GTK+" SecQuickLaunchGtk
+    SetOutPath $INSTDIR
+    CreateShortcut "$QUICKLAUNCH\${INTERNALNAME} GTK+.lnk" $INSTDIR\avidemux2_gtk.exe
+    WriteRegStr HKLM "${REGKEY}\Components" "Quick Launch" 1
+SectionEnd
+
+Section "-Quick Launch Qt4" SecQuickLaunchQt4
+    SetOutPath $INSTDIR
+    CreateShortcut "$QUICKLAUNCH\${INTERNALNAME} Qt4.lnk" $INSTDIR\avidemux2_qt4.exe
+    WriteRegStr HKLM "${REGKEY}\Components" "Quick Launch" 1
+SectionEnd
+
+Section "-Desktop GTK+" SecDesktopGtk
+    SetOutPath $INSTDIR
+    CreateShortcut "$DESKTOP\${INTERNALNAME} GTK+.lnk" $INSTDIR\avidemux2_gtk.exe
+    WriteRegStr HKLM "${REGKEY}\Components" "Desktop" 1
+SectionEnd
+
+Section "-Desktop Qt4" SecDesktopQt4
+    SetOutPath $INSTDIR
+    CreateShortcut "$DESKTOP\${INTERNALNAME} Qt4.lnk" $INSTDIR\avidemux2_qt4.exe
+    WriteRegStr HKLM "${REGKEY}\Components" "Desktop" 1
+SectionEnd
+
+Section -post SecUninstaller
+    SectionIn 1 2
+    WriteRegStr HKLM "${REGKEY}" Path $INSTDIR
+    SetOutPath $INSTDIR
+    WriteUninstaller $INSTDIR\uninstall.exe
+    WriteRegStr HKLM "${UNINST_REGKEY}" DisplayName "${INTERNALNAME}"
+    WriteRegStr HKLM "${UNINST_REGKEY}" DisplayVersion "${VERSION}"
+    WriteRegStr HKLM "${UNINST_REGKEY}" DisplayIcon $INSTDIR\uninstall.exe
+    WriteRegStr HKLM "${UNINST_REGKEY}" UninstallString $INSTDIR\uninstall.exe
+    WriteRegDWORD HKLM "${UNINST_REGKEY}" NoModify 1
+    WriteRegDWORD HKLM "${UNINST_REGKEY}" NoRepair 1
+SectionEnd
+
+##########################
+# Uninstaller sections
+##########################
+Section /o "un.Sample external filter" UnSecFilter
+    RmDir /r /REBOOTOK $INSTDIR\plugin
+    DeleteRegValue HKLM "${REGKEY}\Components" "Sample external filter"
+SectionEnd
+
+Section /o "un.AvsProxy" UnSecAvsProxy
+    Delete /REBOOTOK $INSTDIR\avsproxy.exe
+    Delete /REBOOTOK $INSTDIR\avsproxy_gui.exe
+    DeleteRegValue HKLM "${REGKEY}\Components" "AvsProxy"
+SectionEnd
+
+Section /o un.Catalan UnSecLangCatalan
+	!insertmacro UninstallLanguage Catalan ca
+SectionEnd
+
+Section /o un.Czech UnSecLangCzech
+	!insertmacro UninstallLanguage Czech cs
+SectionEnd
+
+Section /o un.French UnSecLangFrench
+	!insertmacro UninstallLanguage French fr
+SectionEnd
+
+Section /o un.German UnSecLangGerman
+	!insertmacro UninstallLanguage German de
+SectionEnd
+
+Section /o un.Greek UnSecLangGreek
+	!insertmacro UninstallLanguage Greek el
+SectionEnd
+
+Section /o un.Italian UnSecLangItalian
+	!insertmacro UninstallLanguage Italian it
+SectionEnd
+
+Section /o un.Japanese UnSecLangJapanese
+	!insertmacro UninstallLanguage Japanese ja
+SectionEnd
+
+Section /o un.Russian UnSecLangRussian
+	!insertmacro UninstallLanguage Russian ru
+SectionEnd
+
+Section /o un.Serbian UnSecLangSerbianCyrillic
+	!insertmacro UninstallLanguage SerbianCyrillic sr
+SectionEnd
+
+Section /o un.SerbianLatin UnSecLangSerbianLatin
+	!insertmacro UninstallLanguage SerbianLatin sr at latin
+SectionEnd
+
+Section /o un.Spanish UnSecLangSpanish
+	!insertmacro UninstallLanguage Spanish es
+SectionEnd
+
+Section /o un.Turkish UnSecLangTurkish
+	!insertmacro UninstallLanguage Turkish tr
+SectionEnd
+
+Section /o un.GTK+ UnSecUiGtk
+	Delete /REBOOTOK $INSTDIR\libtiff3.dll
+	Delete /REBOOTOK $INSTDIR\libpng12-0.dll
+    Delete /REBOOTOK $INSTDIR\libpangowin32-1.0-0.dll
+    Delete /REBOOTOK $INSTDIR\libpangocairo-1.0-0.dll
+    Delete /REBOOTOK $INSTDIR\libpango-1.0-0.dll
+    Delete /REBOOTOK $INSTDIR\libgio-2.0-0.dll
+    Delete /REBOOTOK $INSTDIR\libglib-2.0-0.dll
+    Delete /REBOOTOK $INSTDIR\libgtk-win32-2.0-0.dll
+    Delete /REBOOTOK $INSTDIR\libgthread-2.0-0.dll
+    Delete /REBOOTOK $INSTDIR\libgobject-2.0-0.dll
+    Delete /REBOOTOK $INSTDIR\libgmodule-2.0-0.dll
+    Delete /REBOOTOK $INSTDIR\libgdk-win32-2.0-0.dll
+    Delete /REBOOTOK $INSTDIR\libgdk_pixbuf-2.0-0.dll
+    Delete /REBOOTOK $INSTDIR\libcairo-2.dll
+    Delete /REBOOTOK $INSTDIR\libatk-1.0-0.dll
+    Delete /REBOOTOK $INSTDIR\jpeg62.dll
+    Delete /REBOOTOK $INSTDIR\gtk2_prefs.exe
+    Delete /REBOOTOK $INSTDIR\avidemux2_gtk.exe
+    RmDir /r /REBOOTOK $INSTDIR\share\themes
+    RmDir /r /REBOOTOK $INSTDIR\lib\gtk-2.0
+    RmDir /r /REBOOTOK $INSTDIR\etc\gtk-2.0
+    RmDir /r /REBOOTOK $INSTDIR\etc\pango
+    DeleteRegValue HKLM "${REGKEY}\Components" GTK+
+SectionEnd
+
+Section /o un.Qt4 UnSecUiQt4
+    Delete /REBOOTOK $INSTDIR\QtCore4.dll
+    Delete /REBOOTOK $INSTDIR\mingwm10.dll
+    Delete /REBOOTOK $INSTDIR\avidemux2_qt4.exe
+    Delete /REBOOTOK $INSTDIR\QtGui4.dll
+    DeleteRegValue HKLM "${REGKEY}\Components" Qt4
+SectionEnd
+
+Section /o "un.Command line" UnSecUiCli
+    Delete /REBOOTOK $INSTDIR\avidemux2_cli.exe
+    DeleteRegValue HKLM "${REGKEY}\Components" "Command line"
+SectionEnd
+
+Section /o "un.Core files (required)" UnSecCore
+    Delete /REBOOTOK $INSTDIR\xvidcore.dll
+    Delete /REBOOTOK $INSTDIR\xmltok.dll
+    Delete /REBOOTOK $INSTDIR\vorbisenc.dll
+    Delete /REBOOTOK $INSTDIR\vorbis.dll
+    Delete /REBOOTOK $INSTDIR\SDL.dll
+    Delete /REBOOTOK $INSTDIR\pthreadGC2.dll
+    Delete /REBOOTOK $INSTDIR\ogg.dll
+    Delete /REBOOTOK $INSTDIR\libxml2.dll
+    Delete /REBOOTOK $INSTDIR\libx264-*.dll
+    Delete /REBOOTOK $INSTDIR\libmp3lame-0.dll
+    Delete /REBOOTOK $INSTDIR\libfontconfig-1.dll
+    Delete /REBOOTOK $INSTDIR\libfaad2.dll
+    Delete /REBOOTOK $INSTDIR\libfaac.dll
+    Delete /REBOOTOK $INSTDIR\libexpat-*.dll
+    Delete /REBOOTOK $INSTDIR\libaften.dll
+    Delete /REBOOTOK $INSTDIR\intl.dll
+    Delete /REBOOTOK $INSTDIR\iconv.dll
+    Delete /REBOOTOK $INSTDIR\freetype6.dll
+    Delete /REBOOTOK $INSTDIR\zlib1.dll
+    Delete /REBOOTOK "$INSTDIR\Build Info.txt"
+    Delete /REBOOTOK "$INSTDIR\Change Log.html"
+    Delete /REBOOTOK "$INSTDIR\stdout.txt"
+    Delete /REBOOTOK "$INSTDIR\stderr.txt"
+    RmDir /r /REBOOTOK $INSTDIR\etc\fonts
+    DeleteRegValue HKLM "${REGKEY}\Components" Avidemux
+    
+    RmDir /REBOOTOK $INSTDIR\share\gettext
+    RmDir /REBOOTOK $INSTDIR\share
+SectionEnd
+
+Section /o "un.Start menu" UnSecStartMenu
+    Delete /REBOOTOK "$SMPROGRAMS\$StartMenuGroup\Change Log.lnk"
+    Delete /REBOOTOK "$SMPROGRAMS\$StartMenuGroup\${INTERNALNAME} GTK+.lnk"
+    Delete /REBOOTOK "$SMPROGRAMS\$StartMenuGroup\${INTERNALNAME} Qt4.lnk"
+    Delete /REBOOTOK "$SMPROGRAMS\$StartMenuGroup\AVS Proxy GUI.lnk"
+SectionEnd
+
+Section /o "un.Quick Launch" UnSecQuickLaunch
+    Delete /REBOOTOK "$QUICKLAUNCH\${INTERNALNAME} GTK+.lnk"
+    Delete /REBOOTOK "$QUICKLAUNCH\${INTERNALNAME} Qt4.lnk"
+SectionEnd
+
+Section /o "un.Desktop" UnSecDesktop
+    Delete /REBOOTOK "$DESKTOP\${INTERNALNAME} GTK+.lnk"
+    Delete /REBOOTOK "$DESKTOP\${INTERNALNAME} Qt4.lnk"
+SectionEnd
+
+Section un.post UnSecUninstaller
+    RmDir /REBOOTOK $INSTDIR\etc
+    RmDir /REBOOTOK $INSTDIR\i18n
+    RmDir /REBOOTOK $INSTDIR\lib
+    RmDir /REBOOTOK $INSTDIR\share\locale
+    RmDir /REBOOTOK $INSTDIR\share
+    
+    DeleteRegKey HKLM "${UNINST_REGKEY}"
+    Delete /REBOOTOK $INSTDIR\uninstall.exe
+    DeleteRegValue HKLM "${REGKEY}" StartMenuGroup
+    DeleteRegValue HKLM "${REGKEY}" Path
+    DeleteRegKey /IfEmpty HKLM "${REGKEY}\Components"
+    DeleteRegKey /IfEmpty HKLM "${REGKEY}"
+    RmDir /REBOOTOK $SMPROGRAMS\$StartMenuGroup
+    RmDir /REBOOTOK $INSTDIR
+    Push $R0
+    StrCpy $R0 $StartMenuGroup 1
+    StrCmp $R0 ">" no_smgroup
+no_smgroup:
+    Pop $R0
+SectionEnd
+
+##########################
+# Installer functions
+##########################
+Function .onInit
+    ReadRegStr $R0  HKLM "${UNINST_REGKEY}" "UninstallString"
+    StrCmp $R0 "" startInstall
+ 
+    MessageBox MB_YESNO|MB_ICONEXCLAMATION "${INTERNALNAME} has already been installed. $\n$\nDo you want to remove \
+      the previous version before installing $(^Name)?" IDNO startInstall
+  
+    # Run the uninstaller
+    ClearErrors
+    ExecWait '$R0 _?=$INSTDIR' ; Do not copy the uninstaller to a temp file
+
+startInstall:
+    InitPluginsDir
+    
+    !insertmacro MUI_INSTALLOPTIONS_EXTRACT "${INSTALL_OPTS_INI}"
+
+    # Make sure a User Interface is selected in previous install preferences
+    ReadRegStr $0 HKLM "${REGKEY}\Components" "Command line"
+    StrCmp $0 1 populate
+    ReadRegStr $0 HKLM "${REGKEY}\Components" "GTK+"
+    StrCmp $0 1 populate
+    ReadRegStr $0 HKLM "${REGKEY}\Components" "Qt4"
+    StrCmp $0 1 populate
+
+    # No UI exists, so go with defaults
+    Goto end
+
+    #Select sections based on last install
+populate:
+    !insertmacro MUI_STARTMENU_GETFOLDER Application $StartMenuGroup
+    !insertmacro SELECT_SECTION "Command line" ${SecUiCli}
+    !insertmacro SELECT_SECTION Qt4 ${SecUiQt4}
+    !insertmacro SELECT_SECTION GTK+ ${SecUiGtk}
+    !insertmacro SELECT_SECTION Catalan ${SecLangCatalan}
+    !insertmacro SELECT_SECTION Czech ${SecLangCzech}
+    !insertmacro SELECT_SECTION French ${SecLangFrench}
+    !insertmacro SELECT_SECTION German ${SecLangGerman}
+    !insertmacro SELECT_SECTION Greek ${SecLangGreek}
+    !insertmacro SELECT_SECTION Italian ${SecLangItalian}
+    !insertmacro SELECT_SECTION Japanese ${SecLangJapanese}
+    !insertmacro SELECT_SECTION Russian ${SecLangRussian}
+    !insertmacro SELECT_SECTION SerbianCyrillic ${SecLangSerbianCyrillic}
+    !insertmacro SELECT_SECTION SerbianLatin ${SecLangSerbianLatin}
+    !insertmacro SELECT_SECTION Spanish ${SecLangSpanish}
+    !insertmacro SELECT_SECTION Turkish ${SecLangTurkish}
+    !insertmacro SELECT_SECTION "Sample external filter" ${SecFilter}
+    !insertmacro SELECT_SECTION AvsProxy ${SecAvsProxy}
+
+    #startMenu:
+    ReadRegStr $0 HKLM "${REGKEY}\Components" "Start menu"
+    !insertmacro MUI_INSTALLOPTIONS_WRITE "${INSTALL_OPTS_INI}" "Field 3" "State" $0
+    
+    #desktop:
+    ReadRegStr $0 HKLM "${REGKEY}\Components" "Desktop"
+    !insertmacro MUI_INSTALLOPTIONS_WRITE "${INSTALL_OPTS_INI}" "Field 2" "State" $0
+    
+    #quickLaunch:
+    ReadRegStr $0 HKLM "${REGKEY}\Components" "Quick Launch"
+    !insertmacro MUI_INSTALLOPTIONS_WRITE "${INSTALL_OPTS_INI}" "Field 4" "State" $0
+    
+end:
+FunctionEnd
+
+Function .onSelChange
+	!insertmacro SectionFlagIsSet ${SecUiGtk} ${SF_SELECTED} end checkCLI
+checkCLI:
+	!insertmacro SectionFlagIsSet ${SecUiCli} ${SF_SELECTED} end disable
+	
+disable:  # GTK langs only
+	SectionSetFlags ${SecLangCatalan} SF_RO
+	SectionSetFlags ${SecLangCzech} SF_RO
+	SectionSetFlags ${SecLangFrench} SF_RO
+	SectionSetFlags ${SecLangGerman} SF_RO
+	SectionSetFlags ${SecLangGreek} SF_RO	
+	SectionSetFlags ${SecLangJapanese} SF_RO
+	SectionSetFlags ${SecLangRussian} SF_RO
+	SectionSetFlags ${SecLangSerbianCyrillic} SF_RO
+	SectionSetFlags ${SecLangSerbianLatin} SF_RO
+	SectionSetFlags ${SecLangSpanish} SF_RO
+	SectionSetFlags ${SecLangTurkish} SF_RO
+end:
+FunctionEnd
+
+Function CheckSelectedUIs
+	!insertmacro SectionFlagIsSet ${SecGrpUI} ${SF_SELECTED} end checkPartial
+checkPartial:
+	!insertmacro SectionFlagIsSet ${SecGrpUI} ${SF_PSELECTED} end displayError
+displayError:
+    MessageBox MB_OK|MB_ICONSTOP "At least one User Interface must be selected."
+    Abort
+end:
+FunctionEnd
+
+LangString INSTALL_OPTS_PAGE_TITLE ${LANG_ENGLISH} "Choose Install Options"
+LangString INSTALL_OPTS_PAGE_SUBTITLE ${LANG_ENGLISH} "Choose where to install Avidemux icons."
+
+Function InstallOptionsPage
+    Call IsInstallOptionsRequired
+
+    !insertmacro MUI_HEADER_TEXT "$(INSTALL_OPTS_PAGE_TITLE)" "$(INSTALL_OPTS_PAGE_SUBTITLE)"
+    !insertmacro MUI_INSTALLOPTIONS_DISPLAY "${INSTALL_OPTS_INI}"
+    
+    Call ReadInstallOptions
+FunctionEnd
+
+Function IsInstallOptionsRequired
+	!insertmacro SectionFlagIsSet ${SecUiGtk} ${SF_SELECTED} end checkQt4
+checkQt4:
+	!insertmacro SectionFlagIsSet ${SecUiQt4} ${SF_SELECTED} end resetOptions
+
+resetOptions:
+    StrCpy $CreateDesktopIcon 0
+    StrCpy $CreateStartMenuGroup 0
+    StrCpy $CreateQuickLaunchIcon 0
+    Abort
+
+end:
+FunctionEnd
+
+Function ReadInstallOptions
+    !insertmacro MUI_INSTALLOPTIONS_READ $CreateDesktopIcon "${INSTALL_OPTS_INI}" "Field 2" "State"
+    !insertmacro MUI_INSTALLOPTIONS_READ $CreateStartMenuGroup "${INSTALL_OPTS_INI}" "Field 3" "State"
+    !insertmacro MUI_INSTALLOPTIONS_READ $CreateQuickLaunchIcon "${INSTALL_OPTS_INI}" "Field 4" "State"
+FunctionEnd
+
+Function IsStartMenuRequired
+    StrCmp $CreateStartMenuGroup 1 +2
+        Abort    
+FunctionEnd
+
+Function ActivateInternalSections
+    #AVS Proxy GUI shortcut:
+    SectionGetFlags ${SecAvsProxy} $0
+    IntOp $0 $0 & ${SF_SELECTED}
+    IntOp $0 $0 & $CreateStartMenuGroup
+    SectionSetFlags ${SecStartMenuAvsProxyGui} $0
+    
+    #Change Log shortcut:
+    SectionSetFlags ${SecStartMenuChangeLog} $CreateStartMenuGroup
+
+    #GTK shortcuts:
+    SectionGetFlags ${SecUiGtk} $0
+    IntOp $0 $0 & ${SF_SELECTED}
+
+    IntOp $1 $0 & $CreateDesktopIcon
+    SectionSetFlags ${SecDesktopGtk} $1
+    
+    IntOp $1 $0 & $CreateQuickLaunchIcon
+    SectionSetFlags ${SecQuickLaunchGtk} $1
+    
+    IntOp $1 $0 & $CreateStartMenuGroup
+    SectionSetFlags ${SecStartMenuGtk} $1
+    
+    #Qt4 shortcuts:
+    SectionGetFlags ${SecUiQt4} $0
+    IntOp $0 $0 & ${SF_SELECTED}
+    
+    IntOp $1 $0 & $CreateDesktopIcon
+    SectionSetFlags ${SecDesktopQt4} $1
+    
+    IntOp $1 $0 & $CreateQuickLaunchIcon
+    SectionSetFlags ${SecQuickLaunchQt4} $1
+    
+    IntOp $1 $0 & $CreateStartMenuGroup
+    SectionSetFlags ${SecStartMenuQt4} $1
+FunctionEnd
+
+Function ConfigureFinishPage
+    SectionGetFlags ${SecUiGtk} $0
+    IntOp $0 $0 & ${SF_SELECTED}
+    StrCmp $0 ${SF_SELECTED} end
+    
+    SectionGetFlags ${SecUiQt4} $0
+    IntOp $0 $0 & ${SF_SELECTED}
+    StrCmp $0 ${SF_SELECTED} end
+
+    DeleteINISec "$PLUGINSDIR\ioSpecial.ini" "Field 4"
+        
+end:
+FunctionEnd
+
+Function OnShowFinishPage
+    # Make hyperlink underlined to keep it consistent with web browsers
+    GetDlgItem $0 $MUI_HWND 1205
+    CreateFont $1 "$(^Font)" 9 500 /UNDERLINE
+    SendMessage $0 ${WM_SETFONT} $1 0    
+FunctionEnd
+
+Function RunAvidemux
+    SetOutPath $INSTDIR
+
+#Qt4:
+    SectionGetFlags ${SecUiQt4} $0
+    IntOp $0 $0 & ${SF_SELECTED}
+    
+    StrCmp $0 ${SF_SELECTED} 0 GTK
+        Exec "$INSTDIR\avidemux2_qt4.exe"
+
+    Goto end
+    
+GTK:
+    SectionGetFlags ${SecUiGtk} $0
+    IntOp $0 $0 & ${SF_SELECTED}
+    
+    StrCmp $0 ${SF_SELECTED} 0 End
+        Exec "$INSTDIR\avidemux2_gtk.exe"    
+    
+end:
+FunctionEnd
+
+##########################
+# Uninstaller functions
+##########################
+Function un.onInit
+    ReadRegStr $INSTDIR HKLM "${REGKEY}" Path
+    !insertmacro MUI_STARTMENU_GETFOLDER Application $StartMenuGroup
+    !insertmacro SELECT_SECTION "Core files (required)" ${UnSecCore}
+    !insertmacro SELECT_SECTION "Command line" ${UnSecUiCli}
+    !insertmacro SELECT_SECTION Qt4 ${UnSecUiQt4}
+    !insertmacro SELECT_SECTION GTK+ ${UnSecUiGtk}
+    !insertmacro SELECT_SECTION Catalan ${UnSecLangCatalan}
+    !insertmacro SELECT_SECTION Czech ${UnSecLangCzech}
+    !insertmacro SELECT_SECTION French ${UnSecLangFrench}
+    !insertmacro SELECT_SECTION German ${UnSecLangGerman}
+    !insertmacro SELECT_SECTION Greek ${UnSecLangGreek}
+    !insertmacro SELECT_SECTION Italian ${UnSecLangItalian}
+    !insertmacro SELECT_SECTION Japanese ${UnSecLangJapanese}
+    !insertmacro SELECT_SECTION Russian ${UnSecLangRussian}
+    !insertmacro SELECT_SECTION SerbianCyrillic ${UnSecLangSerbianCyrillic}
+    !insertmacro SELECT_SECTION SerbianLatin ${UnSecLangSerbianLatin}
+    !insertmacro SELECT_SECTION Spanish ${UnSecLangSpanish}
+    !insertmacro SELECT_SECTION Turkish ${UnSecLangTurkish}
+    !insertmacro SELECT_SECTION AvsProxy ${UnSecAvsProxy}
+    !insertmacro SELECT_SECTION "Sample external filter" ${UnSecFilter}
+    !insertmacro SELECT_SECTION "Start menu" ${UnSecStartMenu}
+    !insertmacro SELECT_SECTION "Quick Launch" ${UnSecQuickLaunch}
+    !insertmacro SELECT_SECTION "Desktop" ${UnSecDesktop}
+FunctionEnd

Added: branches/avidemux_2.5_branch_gruntster/platforms/windows/installer/genlog.sh
===================================================================
--- branches/avidemux_2.5_branch_gruntster/platforms/windows/installer/genlog.sh	2009-02-07 14:34:30 UTC (rev 4578)
+++ branches/avidemux_2.5_branch_gruntster/platforms/windows/installer/genlog.sh	2009-02-08 17:04:43 UTC (rev 4579)
@@ -0,0 +1,4 @@
+svn log --stop-on-copy --xml $SOURCEDIR > svn.xml
+xsltproc svnlog.xslt svn.xml > "$BUILDDIR/Change Log.html"
+xsltproc revision.xslt svn.xml > revision.nsh
+rm svn.xml

Added: branches/avidemux_2.5_branch_gruntster/platforms/windows/installer/revision.xslt
===================================================================
--- branches/avidemux_2.5_branch_gruntster/platforms/windows/installer/revision.xslt	2009-02-07 14:34:30 UTC (rev 4578)
+++ branches/avidemux_2.5_branch_gruntster/platforms/windows/installer/revision.xslt	2009-02-08 17:04:43 UTC (rev 4579)
@@ -0,0 +1,12 @@
+<?xml version="1.0" encoding="utf-8"?>
+
+<xsl:stylesheet version="1.0"
+    xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
+
+  <xsl:output method="text"/>
+
+  <xsl:template match="/">
+    <xsl:text>!define REVISION </xsl:text>
+    <xsl:value-of select="log/logentry/@revision"/>
+  </xsl:template>
+</xsl:stylesheet>
\ No newline at end of file

Added: branches/avidemux_2.5_branch_gruntster/platforms/windows/installer/svnlog.xslt
===================================================================
--- branches/avidemux_2.5_branch_gruntster/platforms/windows/installer/svnlog.xslt	2009-02-07 14:34:30 UTC (rev 4578)
+++ branches/avidemux_2.5_branch_gruntster/platforms/windows/installer/svnlog.xslt	2009-02-08 17:04:43 UTC (rev 4579)
@@ -0,0 +1,132 @@
+<?xml version="1.0" encoding="utf-8"?>
+
+<xsl:stylesheet version="1.0"
+    xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
+
+  <xsl:template match="log">
+    <html>
+      <head>
+        <meta content="text/html; charset=ISO-8859-1" http-equiv="content-type" />
+        <style type="text/css">
+          body {
+          margin: 10px 15px 0px 15px;
+          height: 100%;
+          font-size: 82%;
+          }
+
+          h1 {
+          padding: 0;
+          font-family: Helvetica,Arial,sans-serif;
+          font-size: 1.7em;
+          font-weight: bold;
+          color: #1B57B1;
+          vertical-align: bottom;
+          text-align: center;
+          width: 100%;
+          }
+
+          div, p, table, td, th {
+          font-family: Tahoma,Helvetica,Arial,sans-serif;
+          font-size: 1em;
+          color: #333;
+          }
+
+          table.build {
+          border-collapse: collapse;
+          border: 1px solid #ccc;
+          }
+
+          table.build td, table.roadmap th {
+          border: 1px solid #ccc;
+          }
+
+          table.build th {
+          background: #ddd;
+          padding: 5px;
+          }
+
+          table.build td {
+          background: #f7f7f7;
+          padding-left: 15px;
+          padding-right: 15px;
+          padding-top: 5px;
+          padding-bottom: 5px;
+          }
+        </style>
+        <title>Avidemux 2.4 Change Log</title>
+      </head>
+      <body>
+        <h1>Avidemux 2.4 Change Log</h1>
+        <div align="center">
+          <table class="build">
+            <tr>
+              <th>Revision</th>
+              <th>Date</th>
+              <th>Author</th>
+              <th>Description</th>
+            </tr>
+            <xsl:apply-templates select="logentry" />
+          </table>
+        </div>
+      </body>
+    </html>
+  </xsl:template>
+
+  <xsl:template match="logentry">
+    <tr>
+      <td>
+        <xsl:value-of select="@revision"/>
+      </td>
+      <td>
+        <xsl:call-template name="FormatDate">
+          <xsl:with-param name="Date" select="date" />
+        </xsl:call-template>
+      </td>
+      <td>
+        <xsl:value-of select="author"/>
+      </td>
+      <td>
+        <xsl:value-of select="msg"/>
+      </td>
+    </tr>
+  </xsl:template>
+
+  <xsl:template name="FormatDate">
+    <xsl:param name="Date"/>
+    
+    <!-- Day -->
+    <xsl:value-of select="substring($Date, 9, 2)" />
+    <xsl:text>&#160;</xsl:text>
+
+    <!-- Month -->
+    <xsl:call-template name="FormatMonth">
+      <xsl:with-param name="Month" select="substring($Date, 6, 2)" />
+    </xsl:call-template>
+    <xsl:text>&#160;</xsl:text>
+
+    <!-- Year -->
+    <xsl:value-of select="substring($Date, 1, 4)"/>
+    <!-- <xsl:text>&#160;</xsl:text>-->
+    
+    <!-- Time -->
+    <!-- <xsl:value-of select="substring($Date, 12, 8)"/>-->
+  </xsl:template>
+
+  <xsl:template name="FormatMonth">
+    <xsl:param name="Month"/>
+    <xsl:choose>
+      <xsl:when test="$Month = '01'">Jan</xsl:when>
+      <xsl:when test="$Month = '02'">Feb</xsl:when>
+      <xsl:when test="$Month = '03'">Mar</xsl:when>
+      <xsl:when test="$Month = '04'">Apr</xsl:when>
+      <xsl:when test="$Month = '05'">May</xsl:when>
+      <xsl:when test="$Month = '06'">Jun</xsl:when>
+      <xsl:when test="$Month = '07'">Jul</xsl:when>
+      <xsl:when test="$Month = '08'">Aug</xsl:when>
+      <xsl:when test="$Month = '09'">Sep</xsl:when>
+      <xsl:when test="$Month = '10'">Oct</xsl:when>
+      <xsl:when test="$Month = '11'">Nov</xsl:when>
+      <xsl:when test="$Month = '12'">Dec</xsl:when>
+    </xsl:choose>
+  </xsl:template>
+</xsl:stylesheet>



From gruntster at mail.berlios.de  Sun Feb  8 18:29:01 2009
From: gruntster at mail.berlios.de (gruntster at mail.berlios.de)
Date: Sun, 8 Feb 2009 18:29:01 +0100
Subject: [Avidemux-svn-commit] r4580 - in
	branches/avidemux_2.5_branch_gruntster/platforms/windows/build_scripts:
	. avidemux
Message-ID: <200902081729.n18HT1e2029001@sheep.berlios.de>

Author: gruntster
Date: 2009-02-08 18:28:54 +0100 (Sun, 08 Feb 2009)
New Revision: 4580

Added:
   branches/avidemux_2.5_branch_gruntster/platforms/windows/build_scripts/avidemux/
   branches/avidemux_2.5_branch_gruntster/platforms/windows/build_scripts/avidemux/Set Avidemux Environment Variables.bat
Removed:
   branches/avidemux_2.5_branch_gruntster/platforms/windows/build_scripts/avidemux/Set Avidemux 2.4 Environment Variables.bat
   branches/avidemux_2.5_branch_gruntster/platforms/windows/build_scripts/avidemux_2.4/
Modified:
   branches/avidemux_2.5_branch_gruntster/platforms/windows/build_scripts/Set Common Environment Variables.bat
   branches/avidemux_2.5_branch_gruntster/platforms/windows/build_scripts/avidemux/1. Perform Build.bat
   branches/avidemux_2.5_branch_gruntster/platforms/windows/build_scripts/avidemux/1b. Continue Build.bat
   branches/avidemux_2.5_branch_gruntster/platforms/windows/build_scripts/avidemux/2a. Update Notes.bat
   branches/avidemux_2.5_branch_gruntster/platforms/windows/build_scripts/avidemux/2b. Package Build.bat
Log:
[Win32] update build scripts for 2.5

Modified: branches/avidemux_2.5_branch_gruntster/platforms/windows/build_scripts/Set Common Environment Variables.bat
===================================================================
--- branches/avidemux_2.5_branch_gruntster/platforms/windows/build_scripts/Set Common Environment Variables.bat	2009-02-08 17:04:43 UTC (rev 4579)
+++ branches/avidemux_2.5_branch_gruntster/platforms/windows/build_scripts/Set Common Environment Variables.bat	2009-02-08 17:28:54 UTC (rev 4580)
@@ -4,9 +4,9 @@
 if "%PROCESSOR_ARCHITECTURE%" == "AMD64" for /D %%d in ("%ProgramFiles(x86)%") do set ProgramFiles32=%%~fsd
 set nsisDir=%ProgramFiles32%\NSIS
 
-set devDir=C:\Dev
+set devDir=E:\Dev
 set mingwDir=%devDir%\MinGW
-set msysDir=C:/Dev/MSYS
+set msysDir=E:/Dev/MSYS
 set usrLocalDir=%msysDir%/local
 set CMAKE_INCLUDE_PATH=%usrLocalDir%/include
 set CMAKE_LIBRARY_PATH=%usrLocalDir%/lib
@@ -68,7 +68,7 @@
 	goto error
 )
 
-set PATH=%cmakeDir%;%mingwDir%\bin;%usrLocalDir%\bin;%qtDir%\bin;%PATH%
+set PATH=%cmakeDir%;%mingwDir%\bin;%usrLocalDir%\bin;%msysDir%\bin;%qtDir%\bin;%PATH%
 
 goto end
 

Copied: branches/avidemux_2.5_branch_gruntster/platforms/windows/build_scripts/avidemux (from rev 4579, branches/avidemux_2.5_branch_gruntster/platforms/windows/build_scripts/avidemux_2.4)

Modified: branches/avidemux_2.5_branch_gruntster/platforms/windows/build_scripts/avidemux/1. Perform Build.bat
===================================================================
--- branches/avidemux_2.5_branch_gruntster/platforms/windows/build_scripts/avidemux_2.4/1. Perform Build.bat	2009-02-08 17:04:43 UTC (rev 4579)
+++ branches/avidemux_2.5_branch_gruntster/platforms/windows/build_scripts/avidemux/1. Perform Build.bat	2009-02-08 17:28:54 UTC (rev 4580)
@@ -1,20 +1,23 @@
 @echo off
 
 set curDir=%CD%
-call "Set Avidemux 2.4 Environment Variables"
+call "Set Avidemux Environment Variables"
 
 if errorlevel 1 goto error
 
 cd "%sourceDir%"
 echo Cleaning build directories
 rmdir /s /q build 2> NULL
-rmdir /s /q buildcli 2> NULL
 
+cd "%sourceDir%\plugins"
+rmdir /s /q build 2> NULL
+
 if exist build goto removalFailure
-if exist buildcli goto removalFailure
+cd "%sourceDir%"
+if exist build goto removalFailure
 
-mkdir buildcli
 mkdir build
+mkdir plugins\build
 
 echo Performing Subversion update
 svn up .
@@ -25,7 +28,7 @@
 goto end
 
 :removalFailure
-echo ERROR - build or buildcli could not be fully deleted.
+echo ERROR - build directories could not be fully deleted.
 echo Aborting.
 pause
 

Modified: branches/avidemux_2.5_branch_gruntster/platforms/windows/build_scripts/avidemux/1b. Continue Build.bat
===================================================================
--- branches/avidemux_2.5_branch_gruntster/platforms/windows/build_scripts/avidemux_2.4/1b. Continue Build.bat	2009-02-08 17:04:43 UTC (rev 4579)
+++ branches/avidemux_2.5_branch_gruntster/platforms/windows/build_scripts/avidemux/1b. Continue Build.bat	2009-02-08 17:28:54 UTC (rev 4580)
@@ -1,29 +1,30 @@
 @echo off
 
-call "Set Avidemux 2.4 Environment Variables"
+call "Set Avidemux Environment Variables"
+if errorlevel 1 goto error
 
 cd "%sourceDir%\build"
+cmake -G"MSYS Makefiles" -DCMAKE_INSTALL_PREFIX="%buildDir%" ..
 
-cmake -DUSE_LATE_BINDING=1 -G"MinGW Makefiles" ..
+if errorlevel 1 goto error
+pause
 
+set msysSourceDir=%sourceDir:\=/%
+echo %msysSourceDir%
+cd "%sourceDir%\plugins\build"
+cmake -G"MSYS Makefiles" -DCMAKE_INSTALL_PREFIX="%buildDir%" -DAVIDEMUX_CORECONFIG_DIR="%msysSourceDir%/build/config" -DAVIDEMUX_INSTALL_PREFIX="%buildDir%" -DAVIDEMUX_SOURCE_DIR="%msysSourceDir%" ..
+
 if errorlevel 1 goto error
-
 pause
-mingw32-make avidemux2_gtk
-mingw32-make avidemux2_qt4
-mingw32-make mofiles
-mingw32-make qmfiles
 
-copy /y .\avidemux\avidemux2_gtk.exe "%buildDir%"
-copy /y .\avidemux\avidemux2_qt4.exe "%buildDir%"
+cd "%sourceDir%\build"
+make install
 
-cd ..\buildcli
+cd "%sourceDir%\plugins\build"
+make install
 
-cmake -DUSE_LATE_BINDING=1 -G"MinGW Makefiles" -DNO_SDL=1 ..
-mingw32-make avidemux2_cli
+del /s "%buildDir%\*.a"
 
-copy /y .\avidemux\avidemux2_cli.exe "%buildDir%"
-
 echo Finished!
 goto end
 

Modified: branches/avidemux_2.5_branch_gruntster/platforms/windows/build_scripts/avidemux/2a. Update Notes.bat
===================================================================
--- branches/avidemux_2.5_branch_gruntster/platforms/windows/build_scripts/avidemux_2.4/2a. Update Notes.bat	2009-02-08 17:04:43 UTC (rev 4579)
+++ branches/avidemux_2.5_branch_gruntster/platforms/windows/build_scripts/avidemux/2a. Update Notes.bat	2009-02-08 17:28:54 UTC (rev 4580)
@@ -1,6 +1,6 @@
 @echo off
 
-call "Set Avidemux 2.4 Environment Variables"
+call "Set Avidemux Environment Variables"
 if errorlevel 1 goto error
 
 set PATH=%msysDir%\bin;%PATH%

Modified: branches/avidemux_2.5_branch_gruntster/platforms/windows/build_scripts/avidemux/2b. Package Build.bat
===================================================================
--- branches/avidemux_2.5_branch_gruntster/platforms/windows/build_scripts/avidemux_2.4/2b. Package Build.bat	2009-02-08 17:04:43 UTC (rev 4579)
+++ branches/avidemux_2.5_branch_gruntster/platforms/windows/build_scripts/avidemux/2b. Package Build.bat	2009-02-08 17:28:54 UTC (rev 4580)
@@ -1,6 +1,6 @@
 @echo off
 
-call "Set Avidemux 2.4 Environment Variables"
+call "Set Avidemux Environment Variables"
 
 cd Tools
 call "Get Revision Number"

Deleted: branches/avidemux_2.5_branch_gruntster/platforms/windows/build_scripts/avidemux/Set Avidemux 2.4 Environment Variables.bat
===================================================================
--- branches/avidemux_2.5_branch_gruntster/platforms/windows/build_scripts/avidemux_2.4/Set Avidemux 2.4 Environment Variables.bat	2009-02-08 17:04:43 UTC (rev 4579)
+++ branches/avidemux_2.5_branch_gruntster/platforms/windows/build_scripts/avidemux/Set Avidemux 2.4 Environment Variables.bat	2009-02-08 17:28:54 UTC (rev 4580)
@@ -1,50 +0,0 @@
-call "..\Set Common Environment Variables"
-
-if errorlevel 1 goto error
-
-zip > NUL 2> NUL
-if errorlevel 1 (
-	echo Info-ZIP could not be found in the PATH.  Please download from http://www.info-zip.org
-	goto error
-)
-
-advzip > NUL 2> NUL
-if errorlevel 1 (
-	echo AdvanceCOMP could not be found in the PATH.  Please download from http://advancemame.sourceforge.net
-	goto error
-)
-
-svn help > NUL 2> NUL
-if errorlevel 1 (
-	echo Subversion could not be found in the PATH.  Please download from http://subversion.tigris.org/
-	goto error
-)
-
-xsltproc --version > NUL 2> NUL
-if errorlevel 1 (
-	echo xsltproc could not be found in the PATH.  Please download from http://www.zlatkovic.com
-	goto error
-)
-
-set buildDir=%devDir%\avidemux_2.4_build
-set curDir=%CD%
-cd ..\..\..\..
-set sourceDir=%CD%
-cd "%curDir%"
-
-if not exist "%buildDir%" (
-	echo Build directory could not be found at "%buildDir%".
-	goto error
-)
-
-if not exist "%sourceDir%" (
-	echo Source directory could not be found at "%sourceDir%".
-	goto error
-)
-
-goto end
-
-:error
-set ERRORLEVEL=1
-
-:end
\ No newline at end of file

Copied: branches/avidemux_2.5_branch_gruntster/platforms/windows/build_scripts/avidemux/Set Avidemux Environment Variables.bat (from rev 4579, branches/avidemux_2.5_branch_gruntster/platforms/windows/build_scripts/avidemux_2.4/Set Avidemux 2.4 Environment Variables.bat)
===================================================================
--- branches/avidemux_2.5_branch_gruntster/platforms/windows/build_scripts/avidemux_2.4/Set Avidemux 2.4 Environment Variables.bat	2009-02-08 17:04:43 UTC (rev 4579)
+++ branches/avidemux_2.5_branch_gruntster/platforms/windows/build_scripts/avidemux/Set Avidemux Environment Variables.bat	2009-02-08 17:28:54 UTC (rev 4580)
@@ -0,0 +1,45 @@
+call "..\Set Common Environment Variables"
+
+if errorlevel 1 goto error
+
+zip > NUL 2> NUL
+if errorlevel 1 (
+	echo Info-ZIP could not be found in the PATH.  Please download from http://www.info-zip.org
+	goto error
+)
+
+advzip > NUL 2> NUL
+if errorlevel 1 (
+	echo AdvanceCOMP could not be found in the PATH.  Please download from http://advancemame.sourceforge.net
+	goto error
+)
+
+svn help > NUL 2> NUL
+if errorlevel 1 (
+	echo Subversion could not be found in the PATH.  Please download from http://subversion.tigris.org/
+	goto error
+)
+
+xsltproc --version > NUL 2> NUL
+if errorlevel 1 (
+	echo xsltproc could not be found in the PATH.  Please download from http://www.zlatkovic.com
+	goto error
+)
+
+set buildDir=%devDir%\avidemux_2.5_build
+set curDir=%CD%
+cd ..\..\..\..
+set sourceDir=%CD%
+cd "%curDir%"
+
+if not exist "%sourceDir%" (
+	echo Source directory could not be found at "%sourceDir%".
+	goto error
+)
+
+goto end
+
+:error
+set ERRORLEVEL=1
+
+:end
\ No newline at end of file



From gruntster at mail.berlios.de  Mon Feb  9 22:07:37 2009
From: gruntster at mail.berlios.de (gruntster at mail.berlios.de)
Date: Mon, 9 Feb 2009 22:07:37 +0100
Subject: [Avidemux-svn-commit] r4581 - in
	branches/avidemux_2.5_branch_gruntster/platforms/windows:
	build_scripts/avidemux build_scripts/avidemux/Tools installer
Message-ID: <200902092107.n19L7bDc022763@sheep.berlios.de>

Author: gruntster
Date: 2009-02-09 22:07:24 +0100 (Mon, 09 Feb 2009)
New Revision: 4581

Removed:
   branches/avidemux_2.5_branch_gruntster/platforms/windows/installer/InstallOptions.ini
Modified:
   branches/avidemux_2.5_branch_gruntster/platforms/windows/build_scripts/avidemux/1. Perform Build.bat
   branches/avidemux_2.5_branch_gruntster/platforms/windows/build_scripts/avidemux/1b. Continue Build.bat
   branches/avidemux_2.5_branch_gruntster/platforms/windows/build_scripts/avidemux/2b. Package Build.bat
   branches/avidemux_2.5_branch_gruntster/platforms/windows/build_scripts/avidemux/Package Notes.xml
   branches/avidemux_2.5_branch_gruntster/platforms/windows/build_scripts/avidemux/Tools/gentouch.sh
   branches/avidemux_2.5_branch_gruntster/platforms/windows/build_scripts/avidemux/Tools/package_notes.xslt
   branches/avidemux_2.5_branch_gruntster/platforms/windows/installer/avidemux.nsi
   branches/avidemux_2.5_branch_gruntster/platforms/windows/installer/svnlog.xslt
Log:
[Win32] update installer script for 2.5 (now using Modern UI 2 and Memento) [Part 1]

Modified: branches/avidemux_2.5_branch_gruntster/platforms/windows/build_scripts/avidemux/1. Perform Build.bat
===================================================================
--- branches/avidemux_2.5_branch_gruntster/platforms/windows/build_scripts/avidemux/1. Perform Build.bat	2009-02-08 17:28:54 UTC (rev 4580)
+++ branches/avidemux_2.5_branch_gruntster/platforms/windows/build_scripts/avidemux/1. Perform Build.bat	2009-02-09 21:07:24 UTC (rev 4581)
@@ -7,10 +7,10 @@
 
 cd "%sourceDir%"
 echo Cleaning build directories
-rmdir /s /q build 2> NULL
+rmdir /s /q build 2> NUL
 
 cd "%sourceDir%\plugins"
-rmdir /s /q build 2> NULL
+rmdir /s /q build 2> NUL
 
 if exist build goto removalFailure
 cd "%sourceDir%"

Modified: branches/avidemux_2.5_branch_gruntster/platforms/windows/build_scripts/avidemux/1b. Continue Build.bat
===================================================================
--- branches/avidemux_2.5_branch_gruntster/platforms/windows/build_scripts/avidemux/1b. Continue Build.bat	2009-02-08 17:28:54 UTC (rev 4580)
+++ branches/avidemux_2.5_branch_gruntster/platforms/windows/build_scripts/avidemux/1b. Continue Build.bat	2009-02-09 21:07:24 UTC (rev 4581)
@@ -24,6 +24,8 @@
 make install
 
 del /s "%buildDir%\*.a"
+del "%buildDir%\lib\ADM_plugins\audioDecoder\libADM_ad_dca.dll"
+del "%buildDir%\lib\ADM_plugins\audioDecoder\libADM_ad_amrnb.dll"
 
 echo Finished!
 goto end

Modified: branches/avidemux_2.5_branch_gruntster/platforms/windows/build_scripts/avidemux/2b. Package Build.bat
===================================================================
--- branches/avidemux_2.5_branch_gruntster/platforms/windows/build_scripts/avidemux/2b. Package Build.bat	2009-02-08 17:28:54 UTC (rev 4580)
+++ branches/avidemux_2.5_branch_gruntster/platforms/windows/build_scripts/avidemux/2b. Package Build.bat	2009-02-09 21:07:24 UTC (rev 4581)
@@ -7,8 +7,8 @@
 cd ..
 
 set curDir=%CD%
-set zipFile=avidemux_2.4_r%revisionNo%_win32.zip
-set exeFile=avidemux_2.4_r%revisionNo%_win32.exe
+set zipFile=avidemux_2.5_r%revisionNo%_win32.zip
+set exeFile=avidemux_2.5_r%revisionNo%_win32.exe
 set packageDir=%CD%\%revisionNo%
 
 echo %packageDir%
@@ -29,4 +29,4 @@
 
 move "..\..\installer\%exeFile%" "%packageDir%"
 
-pause
\ No newline at end of file
+pause

Modified: branches/avidemux_2.5_branch_gruntster/platforms/windows/build_scripts/avidemux/Package Notes.xml
===================================================================
--- branches/avidemux_2.5_branch_gruntster/platforms/windows/build_scripts/avidemux/Package Notes.xml	2009-02-08 17:28:54 UTC (rev 4580)
+++ branches/avidemux_2.5_branch_gruntster/platforms/windows/build_scripts/avidemux/Package Notes.xml	2009-02-09 21:07:24 UTC (rev 4581)
@@ -1,426 +1,6 @@
 <?xml version="1.0"?>
 <log>
-  <buildentry revision="4508" date="2009-01-01">
-    <comment>Updated x264 to r1069.</comment>
+  <buildentry revision="" date="">
+    <comment></comment>
   </buildentry>
-  <buildentry revision="4502" date="2008-12-27">
-    <comment>Updated GTK+ to version 2.14.6-1.</comment>
-    <comment>Updated Libxml2 to version 2.7.2+.</comment>
-    <comment>Updated x264 to r1062 (patched).</comment>
-    <comment>Updated Xvid to 1.2.1.</comment>    
-  </buildentry>
-  <buildentry revision="4499" date="2008-12-03">
-    <comment>Packaged using NSIS 2.41.</comment>
-    <comment>Updated Avisynth Proxy GUI to version 2.06.</comment>
-    <comment>Updated GLib to version 2.18.3-1.</comment>
-    <comment>Updated GTK+ to version 2.14.5-1.</comment>
-    <comment>Updated Libxml2 to version 2.7.2.</comment>
-    <comment>Updated Pango to version 1.22.2-1.</comment>
-    <comment>Updated Qt to version 4.4.3.</comment>
-    <comment>Updated win_iconv to version 20080403.</comment>
-    <comment>Updated x264 to r1046 (patched).</comment>
-    <comment>Updated Xvid to 1.2.0.</comment>
-  </buildentry>
-  <buildentry revision="4494" date="2008-10-22">
-    <comment>Updated GTK+ to version 2.14.4-1.</comment>
-  </buildentry>
-  <buildentry revision="4486" date="2008-10-18">
-    <comment>Updated GLib to version 2.18.2-1.</comment>
-  </buildentry>
-  <buildentry revision="4473" date="2008-10-15">
-  </buildentry>
-  <buildentry revision="4458" date="2008-10-13">
-  </buildentry>
-  <buildentry revision="4454" date="2008-10-08">
-  </buildentry>
-  <buildentry revision="4445" date="2008-10-06">
-    <comment>Updated x264 to r999 (patched).</comment>
-  </buildentry>
-  <buildentry revision="4435" date="2008-10-02">
-    <comment>Updated x264 to r997 (patched).</comment>
-  </buildentry>
-  <buildentry revision="4421" date="2008-09-30">
-    <comment>Updated x264 to r995 (patched).</comment>
-  </buildentry>
-  <buildentry revision="4413" date="2008-09-26">
-    <comment>Updated Cairo to version 1.8.0-1.</comment>
-    <comment>Updated LAME to version 3.98.2.</comment>
-    <comment>Updated libpng to version 1.2.32.</comment>
-    <comment>Updated Pango to version 1.22.0-1.</comment>
-  </buildentry>
-  <buildentry revision="4407" date="2008-09-25">
-    <comment>Updated ATK to version 1.24.0-1.</comment>
-    <comment>Updated GLib to version 2.18.1-2.</comment>
-    <comment>Updated GTK+ to version 2.14.3-2.</comment>
-  </buildentry>
-  <buildentry revision="4402" date="2008-09-23">
-    <comment>Updated x264 to r987 (patched).</comment>
-  </buildentry>
-  <buildentry revision="4392" date="2008-09-22">
-    <comment>Updated x264 to r986 (patched).</comment>
-  </buildentry>
-  <buildentry revision="4376" date="2008-09-20">
-    <comment>Updated ATK to version 1.22.0-2.</comment>
-    <comment>Updated GLib to version 2.18.1-1.</comment>
-    <comment>Updated GTK+ to version 2.14.2-1.</comment>
-    <comment>Updated Libxml2 to version 2.7.1.</comment>
-    <comment>Updated Pango to version 1.20.5-2.</comment>
-    <comment>Updated Qt to version 4.4.2.</comment>
-    <comment>Updated x264 to r979 (patched).</comment>
-  </buildentry>
-  <buildentry revision="4346" date="2008-09-14">
-    <comment>Reverted GTK+ back to original 2.14.1 (Avidemux has now been fixed).</comment>
-    <comment>Updated x264 to r968 (patched).</comment>
-  </buildentry>
-  <buildentry revision="4324" date="2008-09-11">
-    <comment>Patched GTK+ 2.14.1 to fix incorrect spin button ranges.</comment>
-  </buildentry>
-  <buildentry revision="4316" date="2008-09-08">
-    <comment>Updated GLib to version 2.18.0-2.</comment>
-    <comment>Updated GTK+ to version 2.14.1-1.</comment>
-    <comment>Updated x264 to r965 (patched).</comment>
-  </buildentry>
-  <buildentry revision="4304" date="2008-09-02">
-    <comment>Updated Qt to version 4.4.1.</comment>
-    <comment>Updated x264 to r956 (patched).</comment>
-  </buildentry>
-  <buildentry revision="4297" date="2008-07-31">
-    <comment>Updated x264 to r927 (patched).</comment>
-  </buildentry>
-  <buildentry revision="4281" date="2008-07-25">
-    <comment>Updated x264 to r918 (patched).</comment>
-  </buildentry>
-  <buildentry revision="4276 [2.4.3 Final]" date="2008-07-24">
-  </buildentry>
-  <buildentry revision="4269" date="2008-07-21">
-    <comment>Updated GLib to version 2.16.5.</comment>
-    <comment>Updated x264 to r915 (patched).</comment>
-  </buildentry>
-  <buildentry revision="4219" date="2008-07-16">
-  </buildentry>
-  <buildentry revision="4211" date="2008-07-13">
-    <comment>Updated GLib to version 2.16.4.</comment>
-    <comment>Updated GTK+ to version 2.12.11.</comment>
-    <comment>Updated Pango to version 1.20.5.</comment>
-    <comment>Updated x264 to r912 (patched).</comment>
-  </buildentry>
-  <buildentry revision="4195 [2.4.2 Final]" date="2008-07-06">
-    <comment>Updated LAME to version 3.98.</comment>
-    <comment>Updated x264 to r899 (patched).</comment>
-  </buildentry>
-  <buildentry revision="4182" date="2008-06-30">
-  </buildentry>
-  <buildentry revision="4170" date="2008-06-27">
-  </buildentry>
-  <buildentry revision="4160" date="2008-06-25">
-    <comment>Updated x264 to r891 (patched).</comment>
-  </buildentry>
-  <buildentry revision="4145" date="2008-06-22">
-    <comment>Updated x264 to r889 (patched).</comment>
-  </buildentry>
-  <buildentry revision="4123" date="2008-06-18">
-  </buildentry>
-  <buildentry revision="4114" date="2008-06-17">
-    <comment>Updated Freetype to version 2.3.6.</comment>
-    <comment>Updated x264 to r886 (patched).</comment>
-  </buildentry>
-  <buildentry revision="4090" date="2008-06-12">
-    <comment>Updated GTK+ to version 2.12.10.</comment>
-    <comment>Updated x264 to r881, patched and compiled with MinGW GCC 4.2.1-sjlj-2.</comment>
-  </buildentry>
-  <buildentry revision="4081" date="2008-06-01">
-    <comment>Updated Cairo to version 1.6.4-2.</comment>
-    <comment>Updated libpng to version 1.2.29.</comment>
-    <comment>Updated Pango to version 1.20.3.</comment>
-  </buildentry>
-  <buildentry revision="4028" date="2008-05-14">
-    <comment>Updated Libxml2 to version 2.6.32+.</comment>
-    <comment>Updated Qt to version 4.4.0.</comment>
-    <comment>Updated x264 to r845.</comment>
-  </buildentry>
-  <buildentry revision="4017" date="2008-05-03">
-    <comment>Updated x264 to r839.</comment>
-  </buildentry>
-  <buildentry revision="3982" date="2008-04-24">
-    <comment>Updated Cairo to version 1.6.4-1.</comment>
-    <comment>Updated GLib to version 2.16.3.</comment>
-    <comment>Updated Pango to version 1.20.2.</comment>
-    <comment>Updated x264 to r828.</comment>
-  </buildentry>
-  <buildentry revision="3974" date="2008-04-10">
-    <comment>Updated GLib to version 2.16.2.</comment>
-    <comment>Updated x264 to r816.</comment>
-  </buildentry>
-  <buildentry revision="3947" date="2008-04-01">
-    <comment>Updated x264 to r808, compiled with Microsoft Visual C++ 6 SP5.</comment>
-  </buildentry>
-  <buildentry revision="3945" date="2008-03-30">
-    <comment>Updated win_iconv to version 20080320.</comment>
-    <comment>Updated x264 to r798, compiled with Microsoft Visual C++ 9.</comment>
-  </buildentry>
-  <buildentry revision="3908" date="2008-03-19">
-    <comment>Updated GTK+ to version 2.12.9.</comment>
-    <comment>Recompiled Aften 0.0.8 with Microsoft Visual C++ 9 (to enable SSE3).</comment>
-    <comment>Recompiled Avidemux and LAME with MinGW's GCC 4.2.1-sjlj-2.</comment>
-    <comment>Replaced libiconv with win_iconv (20080317).</comment>
-    <comment>Reverted x264 back to SVN revision 741.</comment>
-  </buildentry>
-  <buildentry revision="3872" date="2008-03-13">
-    <comment>Updated ATK to version 1.22.0.</comment>
-    <comment>Updated Avisynth Proxy GUI to version 2.04.</comment>
-    <comment>Updated Fontconfig to version 2.4.2 (20071015).</comment>
-    <comment>Updated GLib to version 2.16.1.</comment>
-    <comment>Updated Qt to version 4.3.4.</comment>
-    <comment>Updated Pango to version 1.20.0.</comment>
-    <comment>Updated x264 to SVN revision 745.</comment>
-  </buildentry>
-  <buildentry revision="3791 [2.4.1 Final]" date="2008-02-15">
-  </buildentry>
-  <buildentry revision="3789" date="2008-02-08">
-    <comment>Updated GLib to version 2.14.6-1.</comment>
-  </buildentry>
-  <buildentry revision="3784" date="2008-02-02">
-    <comment>Compiled CLI without SDL so output is directed to the console instead of log files.</comment>
-  </buildentry>
-  <buildentry revision="3779" date="2008-01-29">
-    <comment>Updated x264 to SVN revision 736.</comment>
-  </buildentry>
-  <buildentry revision="3775" date="2008-01-28">
-    <comment>Updated gettext to version 0.17-1.</comment>
-    <comment>Updated Libxml2 to version 2.6.30+.</comment>
-    <comment>Updated x264 to SVN revision 735.</comment>
-  </buildentry>
-  <buildentry revision="3764" date="2008-01-22">
-    <comment>Updated gettext to version 0.17.</comment>
-  </buildentry>
-  <buildentry revision="3756" date="2008-01-18">
-    <comment>Updated Cairo to version 1.4.14.</comment>
-    <comment>Updated GLib to version 2.14.5.</comment>
-    <comment>Updated Pango to version 1.18.4.</comment>
-    <comment>Updated SDL to version 1.2.13.</comment>
-    <comment>Updated x264 to SVN revision 721.</comment>
-  </buildentry>
-  <buildentry revision="3731 [2.4.0 Final]" date="2007-12-24">
-    <comment>Updated x264 to SVN revision 712.</comment>
-  </buildentry>
-  <buildentry revision="3728" date="2007-12-13">
-    <comment>Updated Qt to version 4.3.3.</comment>
-    <comment>Updated x264 to SVN revision 711.</comment>
-  </buildentry>
-  <buildentry revision="3718" date="2007-12-03">
-    <comment>Updated x264 to SVN revision 708.</comment>
-  </buildentry>
-  <buildentry revision="3707" date="2007-11-29">
-    <comment>Updated GLib to version 2.14.4.</comment>
-    <comment>Updated x264 to SVN revision 702.</comment>
-  </buildentry>
-  <buildentry revision="3699" date="2007-11-22">
-    <comment>Updated GLib to version 2.14.3.</comment>
-    <comment>Updated FAAD2 to version 2.6.1.</comment>
-    <comment>Updated x264 to SVN revision 700.</comment>
-  </buildentry>
-  <buildentry revision="3688 [2.4.0 Preview 3.1]" date="2007-11-12">
-    <comment>FAAC support was missing from the earlier preview 3 build.</comment>
-  </buildentry>
-  <buildentry revision="3688 [2.4.0 Preview 3]" date="2007-11-11">
-  </buildentry>
-  <buildentry revision="3676" date="2007-10-31">
-    <comment>Updated FAAC to version 1.26.</comment>
-    <comment>Updated FAAD2 to version 2.6.</comment>
-    <comment>Updated x264 to SVN revision 681.</comment>
-  </buildentry>
-  <buildentry revision="3665" date="2007-10-23">
-    <comment>Updated GLib to version 2.14.2.</comment>
-    <comment>Updated Pango to version 1.18.3.</comment>
-  </buildentry>
-  <buildentry revision="3658" date="2007-10-17">
-  </buildentry>
-  <buildentry revision="3639" date="2007-10-10">
-    <comment>Reverted GTK+ back to version 2.10.14 (due to reports of instability).</comment>
-  </buildentry>
-  <buildentry revision="3625" date="2007-10-07">
-    <comment>Updated Qt to version 4.3.2.</comment>
-  </buildentry>
-  <buildentry revision="3600" date="2007-09-26">
-    <comment>Updated Aften to version 0.0.8</comment>
-    <comment>Updated ATK to version 1.20.0.</comment>
-    <comment>Updated Cairo to version 1.4.10.</comment>
-    <comment>Updated GLib to version 2.14.1.</comment>
-    <comment>Updated GTK+ to version 2.12.0.</comment>
-    <comment>Updated Libxml2 to 2.6.30.</comment>
-    <comment>Updated Pango to version 1.18.2.</comment>
-    <comment>Updated SDL to version 1.2.12.</comment>
-    <comment>Updated x264 to SVN revision 680.</comment>
-  </buildentry>
-  <buildentry revision="3591" date="2007-09-22">
-    <comment>Updated x264 to SVN revision 677.</comment>
-  </buildentry>
-  <buildentry revision="3587" date="2007-09-11">
-    <comment>Updated x264 to SVN revision 674.</comment>
-  </buildentry>
-  <buildentry revision="3579" date="2007-09-05">
-  </buildentry>
-  <buildentry revision="3570" date="2007-08-31">
-  </buildentry>
-  <buildentry revision="3563" date="2007-08-26">
-  </buildentry>
-  <buildentry revision="3553" date="2007-08-23">
-  </buildentry>
-  <buildentry revision="3535" date="2007-08-19">
-  </buildentry>
-  <buildentry revision="3516" date="2007-08-16">
-    <comment>Updated Freetype to version 2.3.5.</comment>
-    <comment>Updated GLib to version 2.14.0.</comment>
-  </buildentry>
-  <buildentry revision="3500" date="2007-08-13">
-    <comment>Updated Qt to version 4.3.1.</comment>
-  </buildentry>
-  <buildentry revision="3488" date="2007-08-08">
-  </buildentry>
-  <buildentry revision="3475" date="2007-08-05">
-    <comment>Updated GTK+ to version 2.10.14.</comment>
-  </buildentry>
-  <buildentry revision="3465" date="2007-08-01">
-    <comment>Packaged using NSIS 2.29.</comment>
-  </buildentry>
-  <buildentry revision="3451" date="2007-07-28">
-    <comment>Updated GLib to version 2.12.13.</comment>
-    <comment>Updated Xvid to CVS HEAD 2007-07-26.</comment>
-    <comment>Updated Vorbis to version 1.2.0.</comment>
-  </buildentry>
-  <buildentry revision="3441" date="2007-07-24">
-    <comment>Updated GCC to version 4.2.1.</comment>
-  </buildentry>
-  <buildentry revision="3412" date="2007-07-18">
-    <comment>Updated x264 to SVN revision 667.</comment>
-  </buildentry>
-  <buildentry revision="3374" date="2007-07-16">
-  </buildentry>
-  <buildentry revision="3364" date="2007-07-14">
-  </buildentry>
-  <buildentry revision="3353" date="2007-07-10">
-    <comment>Updated GCC to version 4.2.0 again.</comment>
-  </buildentry>
-  <buildentry revision="3342" date="2007-07-08">
-  </buildentry>
-  <buildentry revision="3332" date="2007-07-06">
-    <comment>Updated x264 to SVN revision 663.</comment>
-    <comment>Updated Xvid to CVS HEAD 2007-06-28.</comment>
-  </buildentry>
-  <buildentry revision="3322 [2.4.0 Preview 2]" date="2007-06-30">
-    <comment>Reverted GCC back to version 4.1.2 (due to video issues).</comment>
-  </buildentry>
-  <buildentry revision="3317" date="2007-06-28">
-    <comment>Updated Xvid to CVS HEAD 2007-06-27.</comment>
-    <comment>Reverted GTK+ back to version 2.10.9 (due to reports of instability).</comment>
-  </buildentry>
-  <buildentry revision="3310" date="2007-06-26">
-  </buildentry>
-  <buildentry revision="3294" date="2007-06-24">
-    <comment>Updated Freetype to version 2.3.4.</comment>
-    <comment>Updated Libxml2 to version 2.6.28.</comment>
-    <comment>Updated x264 to SVN revision 662.</comment>
-    <comment>Recompiled Aften 0.07 with Microsoft Visual C++ 8 (to fix SSE2 threading issue).</comment>
-  </buildentry>
-  <buildentry revision="3283" date="2007-06-21">
-    <comment>Updated x264 to SVN revision 661.</comment>
-  </buildentry>
-  <buildentry revision="3273" date="2007-06-18">
-  </buildentry>
-  <buildentry revision="3253" date="2007-06-15">
-    <comment>Updated GCC to version 4.2.0 (also recompiled LAME).</comment>
-    <comment>Updated Aften to version 0.07 (R522 to fix GCC alignment issue).</comment>
-    <comment>Updated Cairo to version 1.4.8.</comment>
-    <comment>Updated Fontconfig to version 2.4.2.</comment>
-    <comment>Updated GLib to version 2.12.12.</comment>
-    <comment>Updated GTK+ to version 2.10.13.</comment>
-    <comment>Updated Pango to version 1.16.4.</comment>
-    <comment>Updated Qt to version 4.3.0.</comment>
-    <comment>Updated x264 to SVN revision 659.</comment>
-    <comment>Updated Xvid to CVS HEAD 2007-06-03.</comment>
-    <comment>Avidemux was built using new CMake scripts.</comment>
-    <comment>Packaged using NSIS 2.28.</comment>
-  </buildentry>
-  <buildentry revision="3140" date="2007-05-25">
-  </buildentry>
-  <buildentry revision="3124" date="2007-05-22">
-  </buildentry>
-  <buildentry revision="3110" date="2007-05-18">
-  </buildentry>
-  <buildentry revision="3099" date="2007-05-16">
-  </buildentry>
-  <buildentry revision="3086" date="2007-05-14">
-  </buildentry>
-  <buildentry revision="3070" date="2007-05-13">
-  </buildentry>
-  <buildentry revision="3059" date="2007-05-10">
-  </buildentry>
-  <buildentry revision="3048" date="2007-05-09">
-  </buildentry>
-  <buildentry revision="3040" date="2007-05-07">
-    <comment>Updated Avisynth Proxy GUI to 2007-05-04.</comment>
-    <comment>Removed ADM Tools.</comment>
-    <comment>Installer now prompts to remove previous version before installing.</comment>
-  </buildentry>
-  <buildentry revision="3015" date="2007-05-04">
-    <comment>Updated x264 to SVN revision 655.</comment>
-    <comment>Updated Avisynth Proxy GUI to 2007-05-02.</comment>
-    <comment>Installer now adds Avisynth Proxy GUI to Start Menu.</comment>
-  </buildentry>
-  <buildentry revision="3003" date="2007-05-02">
-    <comment>Added Avisynth Proxy GUI to Installer.</comment>
-  </buildentry>
-  <buildentry revision="2994" date="2007-04-30">
-    <comment>Updated Xvid to CVS HEAD 2007-04-29.</comment>
-    <comment>Added Avisynth Proxy to Installer.</comment>
-  </buildentry>
-  <buildentry revision="2975" date="2007-04-27">
-  </buildentry>
-  <buildentry revision="2960" date="2007-04-24">
-    <comment>Updated x264 to SVN revision 654.</comment>
-    <comment>Added GTK translations to installer.  Standard GTK windows (e.g. Open and Save) are now correctly translated.</comment>
-    <comment>The Installer now prohibits ADM Tools from being installed if the GTK+ user interface isn't also chosen.</comment>
-  </buildentry>
-  <buildentry revision="2955" date="2007-04-23">
-    <comment>Updated x264 to SVN revision 652.</comment>
-    <comment>Updated ADM Tools to 2007-04-20.</comment>
-    <comment>Installer now remembers previous installation folder (thanks LoRd_MuldeR).</comment>
-    <comment>Translations now work when starting Avidemux via the shortcuts created by the Installer (thanks Tetsuro).</comment>
-  </buildentry>
-  <buildentry revision="2953" date="2007-04-19">
-  </buildentry>
-  <buildentry revision="2951" date="2007-04-20">
-    <comment>Updated Xvid to CVS HEAD 2007-04-17.</comment>
-    <comment>Updated ADM Tools to 2007-04-18.</comment>
-  </buildentry>
-  <buildentry revision="2948" date="2007-04-17">
-  </buildentry>
-  <buildentry revision="2945" date="2007-04-15">
-    <comment>A bug in the Avidemux configure script prevented full compiler optimisations from being enabled. This has now been rectified, which means the main Avidemux executables are larger but hopefully faster in certain areas.</comment>
-    <comment>The installer now uses improved compression so the file size is smaller than the last release.</comment>
-    <comment>Included ADM Tools.</comment>
-  </buildentry>
-  <buildentry revision="2934" date="2007-04-13">
-    <comment>Updated x264 to SVN revision 650.</comment>
-    <comment>Introduced a new installer.</comment>
-  </buildentry>
-  <buildentry revision="2926 [Release 2]" date="2007-04-11">
-    <comment>Updated x264 to SVN revision 649.</comment>
-    <comment>
-      FAAC and FAAD2 have been rebuilt. Prior builds incorrectly included DRM versions
-      of both libraries, which aren't appropriate for Avidemux.
-    </comment>
-  </buildentry>
-  <buildentry revision="2926" date="2007-04-07">
-    <comment>Updated Aften to version 0.06</comment>
-    <comment>Updated x264 to SVN revision 648.</comment>
-  </buildentry>
-  <buildentry revision="2922" date="2007-04-05">
-    <comment>Updated x264 to SVN revision 641.</comment>
-  </buildentry>
-  <buildentry revision="2916" date="2007-04-02">
-    <comment>Updated x264 to SVN revision 636.</comment>
-  </buildentry>
-  <buildentry revision="2910" date="2007-03-29">
-  </buildentry>
 </log>

Modified: branches/avidemux_2.5_branch_gruntster/platforms/windows/build_scripts/avidemux/Tools/gentouch.sh
===================================================================
--- branches/avidemux_2.5_branch_gruntster/platforms/windows/build_scripts/avidemux/Tools/gentouch.sh	2009-02-08 17:28:54 UTC (rev 4580)
+++ branches/avidemux_2.5_branch_gruntster/platforms/windows/build_scripts/avidemux/Tools/gentouch.sh	2009-02-09 21:07:24 UTC (rev 4581)
@@ -1 +1 @@
-xsltproc touch_files.xslt "../Package Notes.xml" > "../Touch 2.4 Files.html"
\ No newline at end of file
+xsltproc touch_files.xslt "../Package Notes.xml" > "../Touch 2.5 Files.html"
\ No newline at end of file

Modified: branches/avidemux_2.5_branch_gruntster/platforms/windows/build_scripts/avidemux/Tools/package_notes.xslt
===================================================================
--- branches/avidemux_2.5_branch_gruntster/platforms/windows/build_scripts/avidemux/Tools/package_notes.xslt	2009-02-08 17:28:54 UTC (rev 4580)
+++ branches/avidemux_2.5_branch_gruntster/platforms/windows/build_scripts/avidemux/Tools/package_notes.xslt	2009-02-09 21:07:24 UTC (rev 4581)
@@ -54,10 +54,10 @@
           padding-bottom: 5px;
           }
         </style>
-        <title>Avidemux 2.4 Win32 Package Notes</title>
+        <title>Avidemux 2.5 Win32 Package Notes</title>
       </head>
       <body>
-        <h1>Avidemux 2.4 Win32 Package Notes</h1>
+        <h1>Avidemux 2.5 Win32 Package Notes</h1>
         <div>
           <xsl:apply-templates select="buildentry" />
         </div>

Deleted: branches/avidemux_2.5_branch_gruntster/platforms/windows/installer/InstallOptions.ini
===================================================================
--- branches/avidemux_2.5_branch_gruntster/platforms/windows/installer/InstallOptions.ini	2009-02-08 17:28:54 UTC (rev 4580)
+++ branches/avidemux_2.5_branch_gruntster/platforms/windows/installer/InstallOptions.ini	2009-02-09 21:07:24 UTC (rev 4581)
@@ -1,37 +0,0 @@
-[Settings]
-NumFields=4
-
-[Field 1]
-Type=label
-Text=Create icons for Avidemux:
-Left=0
-Right=-1
-Top=10
-Bottom=20
-
-[Field 2]
-Type=checkbox
-Text=On my &Desktop
-Left=12
-Right=-1
-Top=28
-Bottom=38
-State=1
-
-[Field 3]
-Type=checkbox
-Text=In my &Start Menu Programs folder
-Left=12
-Right=-1
-Top=46
-Bottom=56
-State=1
-
-[Field 4]
-Type=checkbox
-Text=In my &Quick Launch bar
-Left=12
-Right=-1
-Top=64
-Bottom=74
-State=1
\ No newline at end of file

Modified: branches/avidemux_2.5_branch_gruntster/platforms/windows/installer/avidemux.nsi
===================================================================
--- branches/avidemux_2.5_branch_gruntster/platforms/windows/installer/avidemux.nsi	2009-02-08 17:28:54 UTC (rev 4580)
+++ branches/avidemux_2.5_branch_gruntster/platforms/windows/installer/avidemux.nsi	2009-02-09 21:07:24 UTC (rev 4581)
@@ -2,12 +2,13 @@
 # Included files
 ##########################
 !include Sections.nsh
-!include MUI.nsh
-!include WinMessages.nsh
+!include MUI2.nsh
+!include nsDialogs.nsh
+!include Memento.nsh
 !include revision.nsh
 !include builddir.nsh
 
-Name "Avidemux 2.4.3 beta r${REVISION}"
+Name "Avidemux 2.5.0 beta r${REVISION}"
 
 SetCompressor /SOLID lzma
 SetCompressorDictSize 96
@@ -15,14 +16,18 @@
 ##########################
 # Defines
 ##########################
-!define INTERNALNAME "Avidemux 2.4"
+!define INTERNALNAME "Avidemux 2.5"
 !define REGKEY "SOFTWARE\${INTERNALNAME}"
 !define UNINST_REGKEY "SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall\${INTERNALNAME}"
-!define VERSION 2.4.3.${REVISION}
+!define VERSION 2.5.0.${REVISION}
 !define COMPANY "Free Software Foundation"
 !define URL "http://www.avidemux.org"
 
-!define INSTALL_OPTS_INI "InstallOptions.ini"
+##########################
+# Memento defines
+##########################
+!define MEMENTO_REGISTRY_ROOT HKLM
+!define MEMENTO_REGISTRY_KEY "${REGKEY}"
 
 ##########################
 # MUI defines
@@ -56,7 +61,7 @@
 !insertmacro MUI_PAGE_LICENSE License.rtf
 !define MUI_PAGE_CUSTOMFUNCTION_LEAVE CheckSelectedUIs
 !insertmacro MUI_PAGE_COMPONENTS
-Page custom InstallOptionsPage
+Page custom InstallOptionsPage InstallOptionsPageLeave
 !define MUI_PAGE_CUSTOMFUNCTION_PRE IsStartMenuRequired
 !insertmacro MUI_PAGE_STARTMENU Application $StartMenuGroup
 !insertmacro MUI_PAGE_DIRECTORY
@@ -70,7 +75,6 @@
 !define MUI_FINISHPAGE_LINK "Visit the Avidemux Win32 Builds website"
 !define MUI_FINISHPAGE_LINK_LOCATION "http://www.razorbyte.com.au/avidemux/"
 !define MUI_PAGE_CUSTOMFUNCTION_PRE ConfigureFinishPage
-!define MUI_PAGE_CUSTOMFUNCTION_SHOW OnShowFinishPage
 !insertmacro MUI_PAGE_FINISH
 !insertmacro MUI_UNPAGE_CONFIRM
 !insertmacro MUI_UNPAGE_INSTFILES
@@ -81,20 +85,14 @@
 !insertmacro MUI_LANGUAGE English
 
 ##########################
-#Reserve files
-##########################
-ReserveFile "${INSTALL_OPTS_INI}"
-!insertmacro MUI_RESERVEFILE_INSTALLOPTIONS
-
-##########################
 # Installer attributes
 ##########################
-OutFile avidemux_2.4_r${REVISION}_win32.exe
-InstallDir "$PROGRAMFILES\Avidemux 2.4"
+OutFile avidemux_2.5_r${REVISION}_win32.exe
+InstallDir "$PROGRAMFILES\Avidemux 2.5"
 CRCCheck on
 XPStyle on
 ShowInstDetails nevershow
-VIProductVersion 2.4.3.${REVISION}
+VIProductVersion 2.5.0.${REVISION}
 VIAddVersionKey ProductName Avidemux
 VIAddVersionKey ProductVersion "${VERSION} (beta)"
 VIAddVersionKey FileVersion ""
@@ -119,7 +117,6 @@
     File ${BUILDDIR}\share\locale\${LANG_CODE}\LC_MESSAGES\avidemux.mo
     File ${BUILDDIR}\share\locale\${LANG_CODE}\LC_MESSAGES\gtk20.mo
 
-    WriteRegStr HKLM "${REGKEY}\Components" ${LANG_NAME} 1
 endGtk${LANG_CODE}:
 !macroend
 
@@ -132,32 +129,16 @@
 	SetOutPath $INSTDIR\i18n
     File ${BUILDDIR}\i18n\avidemux_${LANG_CODE}.qm
     File ${BUILDDIR}\i18n\qt_${LANG_CODE}.qm
-    
-    WriteRegStr HKLM "${REGKEY}\Components" ${LANG_NAME} 1
-endQt4${LANG_CODE}:    
+
+endQt4${LANG_CODE}:
 !macroend
 
 !macro UninstallLanguage LANG_NAME LANG_CODE
     RmDir /r /REBOOTOK $INSTDIR\share\locale\${LANG_CODE}
     Delete /REBOOTOK $INSTDIR\i18n\avidemux_${LANG_CODE}.qm
     Delete /REBOOTOK $INSTDIR\i18n\qt_${LANG_CODE}.qm
-    
-    DeleteRegValue HKLM "${REGKEY}\Components" ${LANG_NAME}
 !macroend
 
-# Macro for selecting sections based on registry setting
-!macro SELECT_SECTION SECTION_NAME SECTION_ID
-    Push $R0
-    ReadRegStr $R0 HKLM "${REGKEY}\Components" "${SECTION_NAME}"
-    StrCmp $R0 1 0 next${SECTION_ID}
-    !insertmacro SelectSection "${SECTION_ID}"
-    GoTo done${SECTION_ID}
-next${SECTION_ID}:
-    !insertmacro UnselectSection "${SECTION_ID}"
-done${SECTION_ID}:
-    Pop $R0
-!macroend
-
 ##########################
 # Installer sections
 ##########################
@@ -171,44 +152,42 @@
     File ${BUILDDIR}\freetype6.dll
     File ${BUILDDIR}\iconv.dll
     File ${BUILDDIR}\intl.dll
+    File ${BUILDDIR}\libADM_core.dll
+    File ${BUILDDIR}\libADM_coreAudio.dll
+    File ${BUILDDIR}\libADM_coreImage.dll
+    File ${BUILDDIR}\libADM_coreUI.dll
+    File ${BUILDDIR}\libADM_smjs.dll
     File ${BUILDDIR}\libaften.dll
     File ${BUILDDIR}\libexpat-*.dll
-    File ${BUILDDIR}\libfaac.dll
-    File ${BUILDDIR}\libfaad2.dll
     File ${BUILDDIR}\libfontconfig-1.dll
-    File ${BUILDDIR}\libmp3lame-0.dll
-    File ${BUILDDIR}\libx264-*.dll
     File ${BUILDDIR}\libxml2.dll
     File ${BUILDDIR}\ogg.dll
     File ${BUILDDIR}\pthreadGC2.dll
     File ${BUILDDIR}\SDL.dll
-    File ${BUILDDIR}\vorbis.dll
-    File ${BUILDDIR}\vorbisenc.dll
     File ${BUILDDIR}\xmltok.dll
-    File ${BUILDDIR}\xvidcore.dll
+    File ${BUILDDIR}\AUTHORS.
+    File ${BUILDDIR}\COPYING.
+    File ${BUILDDIR}\README.
+    File ${BUILDDIR}\avcodec-*.dll
+    File ${BUILDDIR}\avformat-*.dll
+    File ${BUILDDIR}\avutil-*.dll
+    File ${BUILDDIR}\postproc-*.dll
+    File ${BUILDDIR}\swscale-*.dll
     SetOutPath $INSTDIR\etc\fonts
     File /r ${BUILDDIR}\etc\fonts\*
-
-    # if $PROFILE\avidemux exists and $APPDATA\avidemux doesn't, then move it
-    IfFileExists "$PROFILE\avidemux" 0 end
-    IfFileExists "$APPDATA\avidemux" end
-
-    Rename "$PROFILE\avidemux" "$APPDATA\avidemux"
-
-end:
-    WriteRegStr HKLM "${REGKEY}\Components" "Core files (required)" 1
 SectionEnd
 
 SectionGroup /e "User interfaces" SecGrpUI
-    Section "Command line" SecUiCli
+    ${MementoSection} "Command line" SecUiCli
         SectionIn 1 2
         SetOutPath $INSTDIR
         SetOverwrite on
         File ${BUILDDIR}\avidemux2_cli.exe
-        WriteRegStr HKLM "${REGKEY}\Components" "Command line" 1
-    SectionEnd
+        File ${BUILDDIR}\libADM_render_cli.dll
+        File ${BUILDDIR}\libADM_UICli.dll
+    ${MementoSectionEnd}
 
-    Section GTK+ SecUiGtk
+    ${MementoUnselectedSection} GTK+ SecUiGtk
         SectionIn 2
         SetOverwrite on
         SetOutPath $INSTDIR\etc\gtk-2.0
@@ -223,6 +202,8 @@
         File ${BUILDDIR}\avidemux2_gtk.exe
         File ${BUILDDIR}\gtk2_prefs.exe
         File ${BUILDDIR}\jpeg62.dll
+        File ${BUILDDIR}\libADM_render_gtk.dll
+        File ${BUILDDIR}\libADM_UIGtk.dll
         File ${BUILDDIR}\libatk-1.0-0.dll
         File ${BUILDDIR}\libcairo-2.dll
         File ${BUILDDIR}\libgdk_pixbuf-2.0-0.dll
@@ -238,163 +219,800 @@
         File ${BUILDDIR}\libpangowin32-1.0-0.dll
         File ${BUILDDIR}\libpng12-0.dll
         File ${BUILDDIR}\libtiff3.dll
-        WriteRegStr HKLM "${REGKEY}\Components" GTK+ 1
-    SectionEnd
-    
-    Section Qt4 SecUiQt4
+    ${MementoSectionEnd}
+
+    ${MementoSection} Qt4 SecUiQt4
         SectionIn 1 2
         SetOutPath $INSTDIR
         SetOverwrite on
         File ${BUILDDIR}\QtGui4.dll
         File ${BUILDDIR}\avidemux2_qt4.exe
+        File ${BUILDDIR}\libADM_render_qt4.dll
+        File ${BUILDDIR}\libADM_UIQT4.dll
         File ${BUILDDIR}\mingwm10.dll
         File ${BUILDDIR}\QtCore4.dll
-        WriteRegStr HKLM "${REGKEY}\Components" Qt4 1
-    SectionEnd    
+    ${MementoSectionEnd}
 SectionGroupEnd
 
+SectionGroup Plugins SecGrpPlugin
+	SectionGroup "Audio Decoders" SecGrpAudioDecoder
+		${MementoSection} "FAAD2 (AAC)" SecAudDecFaad
+			SectionIn 1 2
+			SetOverwrite on
+			SetOutPath $INSTDIR\lib\ADM_plugins\audioDecoder
+			File ${BUILDDIR}\lib\ADM_plugins\audioDecoder\libADM_ad_faad.dll
+			SetOutPath $INSTDIR
+			File ${BUILDDIR}\libfaad2.dll
+		${MementoSectionEnd}
+		${MementoSection} "liba52 (AC-3)" SecAudDecA52
+			SectionIn 1 2
+			SetOverwrite on
+			SetOutPath $INSTDIR\lib\ADM_plugins\audioDecoder
+			File ${BUILDDIR}\lib\ADM_plugins\audioDecoder\libADM_ad_a52.dll
+		${MementoSectionEnd}
+		${MementoSection} "MAD (MPEG)" SecAudDecMad
+			SectionIn 1 2
+			SetOverwrite on
+			SetOutPath $INSTDIR\lib\ADM_plugins\audioDecoder
+			File ${BUILDDIR}\lib\ADM_plugins\audioDecoder\libADM_ad_Mad.dll
+		${MementoSectionEnd}
+	SectionGroupEnd
+	SectionGroup "Audio Devices" SecGrpAudioDevice
+		${MementoUnselectedSection} SDL SecAudDevSdl
+			SectionIn 2
+			SetOverwrite on
+			SetOutPath $INSTDIR\lib\ADM_plugins\audioDevices
+			File ${BUILDDIR}\lib\ADM_plugins\audioDevices\libADM_av_sdl.dll
+		${MementoSectionEnd}
+		${MementoSection} "MS Windows (Waveform)" SecAudDevWaveform
+			SectionIn 1 2
+			SetOverwrite on
+			SetOutPath $INSTDIR\lib\ADM_plugins\audioDevices
+			File ${BUILDDIR}\lib\ADM_plugins\audioDevices\libADM_av_win32.dll
+		${MementoSectionEnd}
+	SectionGroupEnd
+	SectionGroup "Audio Encoders" SecGrpAudioEncoder
+		${MementoSection} "FAAC (AAC)" SecAudEncFaac
+			SectionIn 1 2
+			SetOverwrite on
+			SetOutPath $INSTDIR\lib\ADM_plugins\audioEncoders
+			File ${BUILDDIR}\lib\ADM_plugins\audioEncoders\libADM_ae_faac.dll
+			SetOutPath $INSTDIR
+			File ${BUILDDIR}\libfaac.dll
+		${MementoSectionEnd}
+		${MementoSection} "LAME (MP3)" SecAudEncLame
+			SectionIn 1 2
+			SetOverwrite on
+			SetOutPath $INSTDIR\lib\ADM_plugins\audioEncoders
+			File ${BUILDDIR}\lib\ADM_plugins\audioEncoders\libADM_ae_lame.dll
+			SetOutPath $INSTDIR
+			File ${BUILDDIR}\libmp3lame-0.dll
+		${MementoSectionEnd}
+		${MementoSection} "libavcodec (AC-3)" SecAudEncLavAc3
+			SectionIn 1 2
+			SetOverwrite on
+			SetOutPath $INSTDIR\lib\ADM_plugins\audioEncoders
+			File ${BUILDDIR}\lib\ADM_plugins\audioEncoders\libADM_ae_lav_ac3.dll
+		${MementoSectionEnd}
+		${MementoSection} "libavcodec (MP2)" SecAudEncLavMp2
+			SectionIn 1 2
+			SetOverwrite on
+			SetOutPath $INSTDIR\lib\ADM_plugins\audioEncoders
+			File ${BUILDDIR}\lib\ADM_plugins\audioEncoders\libADM_ae_lav_mp2.dll
+		${MementoSectionEnd}
+		${MementoSection} "libvorbis (Vorbis)" SecAudEncVorbis
+			SectionIn 1 2
+			SetOverwrite on
+			SetOutPath $INSTDIR\lib\ADM_plugins\audioEncoders
+			File ${BUILDDIR}\lib\ADM_plugins\audioEncoders\libADM_ae_vorbis.dll
+			SetOutPath $INSTDIR
+			File ${BUILDDIR}\vorbis.dll
+			File ${BUILDDIR}\vorbisenc.dll
+		${MementoSectionEnd}
+		${MementoSection} "PCM" SecAudEncPcm
+			SectionIn 1 2
+			SetOverwrite on
+			SetOutPath $INSTDIR\lib\ADM_plugins\audioEncoders
+			File ${BUILDDIR}\lib\ADM_plugins\audioEncoders\libADM_ae_pcm.dll
+		${MementoSectionEnd}
+		${MementoSection} "TwoLAME (MP2)" SecAudEncTwoLame
+			SectionIn 1 2
+			SetOverwrite on
+			SetOutPath $INSTDIR\lib\ADM_plugins\audioEncoders
+			File ${BUILDDIR}\lib\ADM_plugins\audioEncoders\libADM_ae_twolame.dll
+		${MementoSectionEnd}
+	SectionGroupEnd
+	SectionGroup "Video Encoders" SecGrpVideoEncoder
+		${MementoSection} "x264 (MPEG-4 AVC)" SecVidEncX264
+			SectionIn 1 2
+			SetOverwrite on
+			SetOutPath $INSTDIR\lib\ADM_plugins\videoEncoder
+			File ${BUILDDIR}\lib\ADM_plugins\videoEncoder\libADM_vidEnc_x264.dll
+			SetOutPath $INSTDIR\lib\ADM_plugins\videoEncoder\x264
+			!insertmacro SectionFlagIsSet ${SecUiGtk} ${SF_SELECTED} InstallGtk CheckQt4
+InstallGtk:
+			File ${BUILDDIR}\lib\ADM_plugins\videoEncoder\x264\libADM_vidEnc_x264_Gtk.dll
+CheckQt4:
+			!insertmacro SectionFlagIsSet ${SecUiQt4} ${SF_SELECTED} InstallQt4 End
+InstallQt4:
+			File ${BUILDDIR}\lib\ADM_plugins\videoEncoder\x264\libADM_vidEnc_x264_Qt.dll
+End:
+			File ${BUILDDIR}\lib\ADM_plugins\videoEncoder\x264\x264Param.xsd
+			File ${BUILDDIR}\lib\ADM_plugins\videoEncoder\x264\*.xml
+			SetOutPath $INSTDIR
+			File ${BUILDDIR}\libx264-*.dll
+		${MementoSectionEnd}
+		${MementoSection} "Xvid (MPEG-4 ASP)" SecVidEncXvid
+			SectionIn 1 2
+			SetOverwrite on
+			SetOutPath $INSTDIR\lib\ADM_plugins\videoEncoder
+			File ${BUILDDIR}\lib\ADM_plugins\videoEncoder\libADM_vidEnc_xvid.dll
+SetOutPath $INSTDIR\lib\ADM_plugins\videoEncoder\xvid
+			!insertmacro SectionFlagIsSet ${SecUiGtk} ${SF_SELECTED} InstallGtk CheckQt4
+InstallGtk:
+			File ${BUILDDIR}\lib\ADM_plugins\videoEncoder\xvid\libADM_vidEnc_Xvid_Gtk.dll
+CheckQt4:
+			!insertmacro SectionFlagIsSet ${SecUiQt4} ${SF_SELECTED} InstallQt4 End
+InstallQt4:
+			File ${BUILDDIR}\lib\ADM_plugins\videoEncoder\xvid\libADM_vidEnc_Xvid_Qt.dll
+End:
+			File ${BUILDDIR}\lib\ADM_plugins\videoEncoder\xvid\XvidParam.xsd
+			#File ${BUILDDIR}\lib\ADM_plugins\videoEncoder\xvid\*.xml
+			SetOutPath $INSTDIR
+			File ${BUILDDIR}\xvidcore.dll
+		${MementoSectionEnd}
+	SectionGroupEnd
+	SectionGroup "Video Filters" SecGrpVideoFilter
+		SectionGroup "Transform Filters" SecGrpVideoFilterTransform
+			${MementoSection} "Add Black Borders" SecVidFltBlackBorders
+				SectionIn 1 2
+				SetOverwrite on
+				SetOutPath $INSTDIR\lib\ADM_plugins\videoFilter
+				File ${BUILDDIR}\lib\ADM_plugins\videoFilter\libADM_vf_addborders.dll
+			${MementoSectionEnd}
+			${MementoSection} "Avisynth Resize" SecVidFltAvisynthResize
+				SectionIn 1 2
+				SetOverwrite on
+				SetOutPath $INSTDIR\lib\ADM_plugins\videoFilter
+
+				!insertmacro SectionFlagIsSet ${SecUiGtk} ${SF_SELECTED} InstallGtk CheckQt4
+InstallGtk:
+				File ${BUILDDIR}\lib\ADM_plugins\videoFilter\libADM_vf_avisynthResize_gtk.dll
+CheckQt4:
+				!insertmacro SectionFlagIsSet ${SecUiQt4} ${SF_SELECTED} InstallQt4 End
+InstallQt4:
+				File ${BUILDDIR}\lib\ADM_plugins\videoFilter\libADM_vf_avisynthResize_qt4.dll
+End:
+			${MementoSectionEnd}
+			${MementoSection} "Blacken Borders" SecVidFltBlackenBorders
+				SectionIn 1 2
+				SetOverwrite on
+				SetOutPath $INSTDIR\lib\ADM_plugins\videoFilter
+				File ${BUILDDIR}\lib\ADM_plugins\videoFilter\libADM_vf_blackenBorders.dll
+			${MementoSectionEnd}
+			${MementoSection} "Crop" SecVidFltCrop
+				SectionIn 1 2
+				SetOverwrite on
+				SetOutPath $INSTDIR\lib\ADM_plugins\videoFilter
+
+				!insertmacro SectionFlagIsSet ${SecUiGtk} ${SF_SELECTED} InstallGtk CheckQt4
+InstallGtk:
+				File ${BUILDDIR}\lib\ADM_plugins\videoFilter\libADM_vf_Crop_gtk.dll
+CheckQt4:
+				!insertmacro SectionFlagIsSet ${SecUiQt4} ${SF_SELECTED} InstallQt4 End
+InstallQt4:
+				File ${BUILDDIR}\lib\ADM_plugins\videoFilter\libADM_vf_crop_qt4.dll
+End:
+			${MementoSectionEnd}
+			${MementoSection} "Fade" SecVidFltFade
+				SectionIn 1 2
+				SetOverwrite on
+				SetOutPath $INSTDIR\lib\ADM_plugins\videoFilter
+				File ${BUILDDIR}\lib\ADM_plugins\videoFilter\libADM_vf_fade.dll
+			${MementoSectionEnd}
+			${MementoSection} "MPlayer Resize" SecVidFltMplayerResize
+				SectionIn 1 2
+				SetOverwrite on
+				SetOutPath $INSTDIR\lib\ADM_plugins\videoFilter
+
+				!insertmacro SectionFlagIsSet ${SecUiGtk} ${SF_SELECTED} InstallGtk CheckQt4
+InstallGtk:
+				File ${BUILDDIR}\lib\ADM_plugins\videoFilter\libADM_vf_mplayerResize_gtk.dll
+CheckQt4:
+				!insertmacro SectionFlagIsSet ${SecUiQt4} ${SF_SELECTED} InstallQt4 End
+InstallQt4:
+				File ${BUILDDIR}\lib\ADM_plugins\videoFilter\libADM_vf_mplayerResize_qt4.dll
+End:
+			${MementoSectionEnd}
+			${MementoSection} "Resample FPS" SecVidFltResampleFps
+				SectionIn 1 2
+				SetOverwrite on
+				SetOutPath $INSTDIR\lib\ADM_plugins\videoFilter
+				File ${BUILDDIR}\lib\ADM_plugins\videoFilter\libADM_vf_resampleFps.dll
+			${MementoSectionEnd}
+			${MementoSection} "Reverse" SecVidFltReverse
+				SectionIn 1 2
+				SetOverwrite on
+				SetOutPath $INSTDIR\lib\ADM_plugins\videoFilter
+				File ${BUILDDIR}\lib\ADM_plugins\videoFilter\libADM_vf_reverse.dll
+			${MementoSectionEnd}
+			${MementoSection} "Rotate" SecVidFltRotate
+				SectionIn 1 2
+				SetOverwrite on
+				SetOutPath $INSTDIR\lib\ADM_plugins\videoFilter
+				File ${BUILDDIR}\lib\ADM_plugins\videoFilter\libADM_vf_rotate.dll
+			${MementoSectionEnd}
+			${MementoSection} "Vertical Flip" SecVidFltVerticalFlip
+				SectionIn 1 2
+				SetOverwrite on
+				SetOutPath $INSTDIR\lib\ADM_plugins\videoFilter
+				File ${BUILDDIR}\lib\ADM_plugins\videoFilter\libADM_vf_vflip.dll
+			${MementoSectionEnd}
+		SectionGroupEnd
+		SectionGroup "Interlacing Filters" SecGrpVideoFilterInterlacing
+			${MementoSection} "Decomb Decimate" SecVidFltDecombDecimate
+				SectionIn 1 2
+				SetOverwrite on
+				SetOutPath $INSTDIR\lib\ADM_plugins\videoFilter
+				File ${BUILDDIR}\lib\ADM_plugins\videoFilter\libADM_vf_decimate.dll
+			${MementoSectionEnd}
+			${MementoSection} "Decomb Telecide" SecVidFltDecombTelecide
+				SectionIn 1 2
+				SetOverwrite on
+				SetOutPath $INSTDIR\lib\ADM_plugins\videoFilter
+				File ${BUILDDIR}\lib\ADM_plugins\videoFilter\libADM_vf_telecide.dll
+			${MementoSectionEnd}
+			${MementoSection} "Deinterlace" SecVidFltDeinterlace
+				SectionIn 1 2
+				SetOverwrite on
+				SetOutPath $INSTDIR\lib\ADM_plugins\videoFilter
+				File ${BUILDDIR}\lib\ADM_plugins\videoFilter\libADM_vf_Deinterlace.dll
+			${MementoSectionEnd}
+			${MementoSection} "DG Bob" SecVidFltDbGob
+				SectionIn 1 2
+				SetOverwrite on
+				SetOutPath $INSTDIR\lib\ADM_plugins\videoFilter
+				File ${BUILDDIR}\lib\ADM_plugins\videoFilter\libADM_vf_blendDgBob.dll
+			${MementoSectionEnd}
+			${MementoSection} "Drop" SecVidFltDrop
+				SectionIn 1 2
+				SetOverwrite on
+				SetOutPath $INSTDIR\lib\ADM_plugins\videoFilter
+				File ${BUILDDIR}\lib\ADM_plugins\videoFilter\libADM_vf_dropOut.dll
+			${MementoSectionEnd}
+			${MementoSection} "Fade" SecVidFltFadeInterlace
+				SectionIn 1 2
+				SetOverwrite on
+				SetOutPath $INSTDIR\lib\ADM_plugins\videoFilter
+				File ${BUILDDIR}\lib\ADM_plugins\videoFilter\libADM_vf_separateField.dll
+			${MementoSectionEnd}
+			${MementoSection} "Gauss Smooth" SecVidFltGaussSmooth
+				SectionIn 1 2
+				SetOverwrite on
+				SetOutPath $INSTDIR\lib\ADM_plugins\videoFilter
+				File ${BUILDDIR}\lib\ADM_plugins\videoFilter\libADM_vf_fastconvolutiongauss.dll
+			${MementoSectionEnd}
+			${MementoSection} "Keep Even Fields" SecVidFltKeepEvenFields
+				SectionIn 1 2
+				SetOverwrite on
+				SetOutPath $INSTDIR\lib\ADM_plugins\videoFilter
+				File ${BUILDDIR}\lib\ADM_plugins\videoFilter\libADM_vf_keepEvenField.dll
+			${MementoSectionEnd}
+			${MementoSection} "Keep Odd Fields" SecVidFltKeepOddFields
+				SectionIn 1 2
+				SetOverwrite on
+				SetOutPath $INSTDIR\lib\ADM_plugins\videoFilter
+				File ${BUILDDIR}\lib\ADM_plugins\videoFilter\libADM_vf_keepOddField.dll
+			${MementoSectionEnd}
+			${MementoSection} "KernelDeint" SecVidFltKernelDeint
+				SectionIn 1 2
+				SetOverwrite on
+				SetOutPath $INSTDIR\lib\ADM_plugins\videoFilter
+				File ${BUILDDIR}\lib\ADM_plugins\videoFilter\libADM_vf_kernelDeint.dll
+			${MementoSectionEnd}
+			${MementoSection} "libavcodec Deinterlacer" SecVidFltLavDeinterlacer
+				SectionIn 1 2
+				SetOverwrite on
+				SetOutPath $INSTDIR\lib\ADM_plugins\videoFilter
+				File ${BUILDDIR}\lib\ADM_plugins\videoFilter\libADM_vf_lavDeinterlace.dll
+			${MementoSectionEnd}
+			${MementoSection} "mcDeint" SecVidFltMcDeint
+				SectionIn 1 2
+				SetOverwrite on
+				SetOutPath $INSTDIR\lib\ADM_plugins\videoFilter
+				File ${BUILDDIR}\lib\ADM_plugins\videoFilter\libADM_vf_mcdeint.dll
+			${MementoSectionEnd}
+			${MementoSection} "Mean" SecVidFltMean
+				SectionIn 1 2
+				SetOverwrite on
+				SetOutPath $INSTDIR\lib\ADM_plugins\videoFilter
+				File ${BUILDDIR}\lib\ADM_plugins\videoFilter\libADM_vf_fastconvolutionmean.dll
+			${MementoSectionEnd}
+			${MementoSection} "Median" SecVidFltMedian
+				SectionIn 1 2
+				SetOverwrite on
+				SetOutPath $INSTDIR\lib\ADM_plugins\videoFilter
+				File ${BUILDDIR}\lib\ADM_plugins\videoFilter\libADM_vf_fastconvolutionmedian.dll
+			${MementoSectionEnd}
+			${MementoSection} "Merge Fields" SecVidFltMergeFields
+				SectionIn 1 2
+				SetOverwrite on
+				SetOutPath $INSTDIR\lib\ADM_plugins\videoFilter
+				File ${BUILDDIR}\lib\ADM_plugins\videoFilter\libADM_vf_mergeField.dll
+			${MementoSectionEnd}
+			${MementoSection} "PAL Field Shift" SecVidFltPalFieldShift
+				SectionIn 1 2
+				SetOverwrite on
+				SetOutPath $INSTDIR\lib\ADM_plugins\videoFilter
+				File ${BUILDDIR}\lib\ADM_plugins\videoFilter\libADM_vf_palShift.dll
+			${MementoSectionEnd}
+			${MementoSection} "PAL Smart Field Shift" SecVidFltPalSmartFieldShift
+				SectionIn 1 2
+				SetOverwrite on
+				SetOutPath $INSTDIR\lib\ADM_plugins\videoFilter
+				File ${BUILDDIR}\lib\ADM_plugins\videoFilter\libADM_vf_smartPalShift.dll
+			${MementoSectionEnd}
+			${MementoSection} "Pulldown" SecVidFltPulldown
+				SectionIn 1 2
+				SetOverwrite on
+				SetOutPath $INSTDIR\lib\ADM_plugins\videoFilter
+				File ${BUILDDIR}\lib\ADM_plugins\videoFilter\libADM_vf_Pulldown.dll
+			${MementoSectionEnd}
+			${MementoSection} "Separate Fields" SecVidFltSeparateFields
+				SectionIn 1 2
+				SetOverwrite on
+				SetOutPath $INSTDIR\lib\ADM_plugins\videoFilter
+				File ${BUILDDIR}\lib\ADM_plugins\videoFilter\libADM_vf_hzStackField.dll
+			${MementoSectionEnd}
+			${MementoSection} "Sharpen" SecVidFltSharpen
+				SectionIn 1 2
+				SetOverwrite on
+				SetOutPath $INSTDIR\lib\ADM_plugins\videoFilter
+				File ${BUILDDIR}\lib\ADM_plugins\videoFilter\libADM_vf_fastconvolutionsharpen.dll
+			${MementoSectionEnd}
+			${MementoSection} "Smart Swap Fields" SecVidFltSmartSwapFields
+				SectionIn 1 2
+				SetOverwrite on
+				SetOutPath $INSTDIR\lib\ADM_plugins\videoFilter
+				File ${BUILDDIR}\lib\ADM_plugins\videoFilter\libADM_vf_smartSwapField.dll
+			${MementoSectionEnd}
+			${MementoSection} "Stack Fields" SecVidFltStackFields
+				SectionIn 1 2
+				SetOverwrite on
+				SetOutPath $INSTDIR\lib\ADM_plugins\videoFilter
+				File ${BUILDDIR}\lib\ADM_plugins\videoFilter\libADM_vf_stackField.dll
+			${MementoSectionEnd}
+			${MementoSection} "Swap Fields" SecVidFltSwapFields
+				SectionIn 1 2
+				SetOverwrite on
+				SetOutPath $INSTDIR\lib\ADM_plugins\videoFilter
+				File ${BUILDDIR}\lib\ADM_plugins\videoFilter\libADM_vf_swapField.dll
+			${MementoSectionEnd}
+			${MementoSection} "TDeint" SecVidFltTDeint
+				SectionIn 1 2
+				SetOverwrite on
+				SetOutPath $INSTDIR\lib\ADM_plugins\videoFilter
+				File ${BUILDDIR}\lib\ADM_plugins\videoFilter\libADM_vf_tdeint.dll
+			${MementoSectionEnd}
+			${MementoSection} "Unstack Fields" SecVidFltUnstackFields
+				SectionIn 1 2
+				SetOverwrite on
+				SetOutPath $INSTDIR\lib\ADM_plugins\videoFilter
+				File ${BUILDDIR}\lib\ADM_plugins\videoFilter\libADM_vf_unstackField.dll
+			${MementoSectionEnd}
+			${MementoSection} "yadif" SecVidFltYadif
+				SectionIn 1 2
+				SetOverwrite on
+				SetOutPath $INSTDIR\lib\ADM_plugins\videoFilter
+				File ${BUILDDIR}\lib\ADM_plugins\videoFilter\libADM_vf_yadif.dll
+			${MementoSectionEnd}
+		SectionGroupEnd
+		SectionGroup "Colour Filters" SecGrpVideoFilterColour
+			${MementoSection} "Avisynth ColorYUV" SecVidFltAvisynthColorYuv
+				SectionIn 1 2
+				SetOverwrite on
+				SetOutPath $INSTDIR\lib\ADM_plugins\videoFilter
+
+				!insertmacro SectionFlagIsSet ${SecUiGtk} ${SF_SELECTED} InstallGtk CheckQt4
+InstallGtk:
+				File ${BUILDDIR}\lib\ADM_plugins\videoFilter\libADM_vf_colorYUV_gtk.dll
+CheckQt4:
+				!insertmacro SectionFlagIsSet ${SecUiQt4} ${SF_SELECTED} InstallQt4 End
+InstallQt4:
+				File ${BUILDDIR}\lib\ADM_plugins\videoFilter\libADM_vf_colorYUV_qt4.dll
+End:
+			${MementoSectionEnd}
+			${MementoSection} "Blend Removal" SecVidFltBlendRemoval
+				SectionIn 1 2
+				SetOverwrite on
+				SetOutPath $INSTDIR\lib\ADM_plugins\videoFilter
+				File ${BUILDDIR}\lib\ADM_plugins\videoFilter\libADM_vf_blendRemoval.dll
+			${MementoSectionEnd}
+			${MementoSection} "Chroma Shift" SecVidFltChromaShift
+				SectionIn 1 2
+				SetOverwrite on
+				SetOutPath $INSTDIR\lib\ADM_plugins\videoFilter
+
+				!insertmacro SectionFlagIsSet ${SecUiGtk} ${SF_SELECTED} InstallGtk CheckQt4
+InstallGtk:
+				File ${BUILDDIR}\lib\ADM_plugins\videoFilter\libADM_vf_chromaShift_gtk.dll
+CheckQt4:
+				!insertmacro SectionFlagIsSet ${SecUiQt4} ${SF_SELECTED} InstallQt4 End
+InstallQt4:
+				File ${BUILDDIR}\lib\ADM_plugins\videoFilter\libADM_vf_chromaShift_qt4.dll
+End:
+			${MementoSectionEnd}
+			${MementoSection} "Chroma U" SecVidFltChromaU
+				SectionIn 1 2
+				SetOverwrite on
+				SetOutPath $INSTDIR\lib\ADM_plugins\videoFilter
+				File ${BUILDDIR}\lib\ADM_plugins\videoFilter\libADM_vidChromaU.dll
+			${MementoSectionEnd}
+			${MementoSection} "Chroma V" SecVidFltChromaV
+				SectionIn 1 2
+				SetOverwrite on
+				SetOutPath $INSTDIR\lib\ADM_plugins\videoFilter
+				File ${BUILDDIR}\lib\ADM_plugins\videoFilter\libADM_vidChromaV.dll
+			${MementoSectionEnd}
+			${MementoSection} "Contrast" SecVidFltContrast
+				SectionIn 1 2
+				SetOverwrite on
+				SetOutPath $INSTDIR\lib\ADM_plugins\videoFilter
+
+				!insertmacro SectionFlagIsSet ${SecUiGtk} ${SF_SELECTED} InstallGtk CheckQt4
+InstallGtk:
+				File ${BUILDDIR}\lib\ADM_plugins\videoFilter\libADM_vf_contrast_gtk.dll
+CheckQt4:
+				!insertmacro SectionFlagIsSet ${SecUiQt4} ${SF_SELECTED} InstallQt4 End
+InstallQt4:
+				File ${BUILDDIR}\lib\ADM_plugins\videoFilter\libADM_vf_contrast_qt4.dll
+End:
+			${MementoSectionEnd}
+			${MementoSection} "Luma Delta" SecVidFltLumaDelta
+				SectionIn 1 2
+				SetOverwrite on
+				SetOutPath $INSTDIR\lib\ADM_plugins\videoFilter
+				File ${BUILDDIR}\lib\ADM_plugins\videoFilter\libADM_vf_Delta.dll
+			${MementoSectionEnd}
+			${MementoSection} "Luma Equaliser" SecVidFltLumaEqualiser
+				SectionIn 1 2
+				SetOverwrite on
+				SetOutPath $INSTDIR\lib\ADM_plugins\videoFilter
+
+				!insertmacro SectionFlagIsSet ${SecUiGtk} ${SF_SELECTED} InstallGtk CheckQt4
+InstallGtk:
+				File ${BUILDDIR}\lib\ADM_plugins\videoFilter\libADM_vf_equalizer_gtk.dll
+CheckQt4:
+				!insertmacro SectionFlagIsSet ${SecUiQt4} ${SF_SELECTED} InstallQt4 End
+InstallQt4:
+				File ${BUILDDIR}\lib\ADM_plugins\videoFilter\libADM_vf_equalizer_qt4.dll
+End:
+			${MementoSectionEnd}
+			${MementoSection} "Luma Only" SecVidFltLumaOnly
+				SectionIn 1 2
+				SetOverwrite on
+				SetOutPath $INSTDIR\lib\ADM_plugins\videoFilter
+				File ${BUILDDIR}\lib\ADM_plugins\videoFilter\libADM_vf_lumaonly.dll
+			${MementoSectionEnd}
+			${MementoSection} "Mplayer Eq2" SecVidFltMPlayerEq2
+				SectionIn 1 2
+				SetOverwrite on
+				SetOutPath $INSTDIR\lib\ADM_plugins\videoFilter
+
+				!insertmacro SectionFlagIsSet ${SecUiGtk} ${SF_SELECTED} InstallGtk CheckQt4
+InstallGtk:
+				File ${BUILDDIR}\lib\ADM_plugins\videoFilter\libADM_vf_eq2_gtk.dll
+CheckQt4:
+				!insertmacro SectionFlagIsSet ${SecUiQt4} ${SF_SELECTED} InstallQt4 End
+InstallQt4:
+				File ${BUILDDIR}\lib\ADM_plugins\videoFilter\libADM_vf_eq2_qt4.dll
+End:
+			${MementoSectionEnd}
+			${MementoSection} "Mplayer Hue" SecVidFltMPlayerHue
+				SectionIn 1 2
+				SetOverwrite on
+				SetOutPath $INSTDIR\lib\ADM_plugins\videoFilter
+
+				!insertmacro SectionFlagIsSet ${SecUiGtk} ${SF_SELECTED} InstallGtk CheckQt4
+InstallGtk:
+				File ${BUILDDIR}\lib\ADM_plugins\videoFilter\libADM_vf_hue_gtk.dll
+CheckQt4:
+				!insertmacro SectionFlagIsSet ${SecUiQt4} ${SF_SELECTED} InstallQt4 End
+InstallQt4:
+				File ${BUILDDIR}\lib\ADM_plugins\videoFilter\libADM_vf_hue_qt4.dll
+End:
+			${MementoSectionEnd}
+			${MementoSection} "Swap U and V" SecVidFltSwapUandV
+				SectionIn 1 2
+				SetOverwrite on
+				SetOutPath $INSTDIR\lib\ADM_plugins\videoFilter
+				File ${BUILDDIR}\lib\ADM_plugins\videoFilter\libADM_vf_swapuv.dll
+			${MementoSectionEnd}
+		SectionGroupEnd
+		SectionGroup "Noise Filters" SecGrpVideoFilterNoise
+			${MementoSection} "Cnr2" SecVidFltCnr2
+				SectionIn 1 2
+				SetOverwrite on
+				SetOutPath $INSTDIR\lib\ADM_plugins\videoFilter
+
+				!insertmacro SectionFlagIsSet ${SecUiGtk} ${SF_SELECTED} InstallGtk CheckQt4
+InstallGtk:
+				File ${BUILDDIR}\lib\ADM_plugins\videoFilter\libADM_vf_cnr2_gtk.dll
+CheckQt4:
+				!insertmacro SectionFlagIsSet ${SecUiQt4} ${SF_SELECTED} InstallQt4 End
+InstallQt4:
+				File ${BUILDDIR}\lib\ADM_plugins\videoFilter\libADM_vf_cnr2_qt4.dll
+End:
+			${MementoSectionEnd}
+			${MementoSection} "Denoise" SecVidFltDenoise
+				SectionIn 1 2
+				SetOverwrite on
+				SetOutPath $INSTDIR\lib\ADM_plugins\videoFilter
+				File ${BUILDDIR}\lib\ADM_plugins\videoFilter\libADM_vf_Denoise.dll
+			${MementoSectionEnd}
+			${MementoSection} "FluxSmooth" SecVidFltFluxSmooth
+				SectionIn 1 2
+				SetOverwrite on
+				SetOutPath $INSTDIR\lib\ADM_plugins\videoFilter
+				File ${BUILDDIR}\lib\ADM_plugins\videoFilter\libADM_vf_FluxSmooth.dll
+			${MementoSectionEnd}
+			${MementoSection} "Forced Post-processing" SecVidFltForcedPostProcessing
+				SectionIn 1 2
+				SetOverwrite on
+				SetOutPath $INSTDIR\lib\ADM_plugins\videoFilter
+				File ${BUILDDIR}\lib\ADM_plugins\videoFilter\libADM_vf_forcedPP.dll
+			${MementoSectionEnd}
+			${MementoSection} "Light Denoiser" SecVidFltLightDenoiser
+				SectionIn 1 2
+				SetOverwrite on
+				SetOutPath $INSTDIR\lib\ADM_plugins\videoFilter
+				File ${BUILDDIR}\lib\ADM_plugins\videoFilter\libADM_vf_Stabilize.dll
+			${MementoSectionEnd}
+			${MementoSection} "Median (5x5)" SecVidFltMediam5x5
+				SectionIn 1 2
+				SetOverwrite on
+				SetOutPath $INSTDIR\lib\ADM_plugins\videoFilter
+				File ${BUILDDIR}\lib\ADM_plugins\videoFilter\libADM_vf_largemedian.dll
+			${MementoSectionEnd}
+			${MementoSection} "MPlayer Denoise3d" SecVidFltMPlayerDenoise3d
+				SectionIn 1 2
+				SetOverwrite on
+				SetOutPath $INSTDIR\lib\ADM_plugins\videoFilter
+				File ${BUILDDIR}\lib\ADM_plugins\videoFilter\libADM_vf_denoise3d.dll
+			${MementoSectionEnd}
+			${MementoSection} "MPlayer Hqdn3d" SecVidFltMPlayerHqdn3d
+				SectionIn 1 2
+				SetOverwrite on
+				SetOutPath $INSTDIR\lib\ADM_plugins\videoFilter
+				File ${BUILDDIR}\lib\ADM_plugins\videoFilter\libADM_vf_denoise3dhq.dll
+			${MementoSectionEnd}
+			${MementoSection} "Temporal Cleaner" SecVidFltTemporalCleaner
+				SectionIn 1 2
+				SetOverwrite on
+				SetOutPath $INSTDIR\lib\ADM_plugins\videoFilter
+				File ${BUILDDIR}\lib\ADM_plugins\videoFilter\libADM_vf_vlad.dll
+			${MementoSectionEnd}
+			${MementoSection} "TIsophote" SecVidFltTisophote
+				SectionIn 1 2
+				SetOverwrite on
+				SetOutPath $INSTDIR\lib\ADM_plugins\videoFilter
+				File ${BUILDDIR}\lib\ADM_plugins\videoFilter\libADM_vf_Tisophote.dll
+			${MementoSectionEnd}
+		SectionGroupEnd
+		SectionGroup "Sharpness Filters" SecGrpVideoFilterSharpness
+			${MementoSection} "asharp" SecVidFltAsharp
+				SectionIn 1 2
+				SetOverwrite on
+				SetOutPath $INSTDIR\lib\ADM_plugins\videoFilter
+
+				!insertmacro SectionFlagIsSet ${SecUiGtk} ${SF_SELECTED} InstallGtk CheckQt4
+InstallGtk:
+				File ${BUILDDIR}\lib\ADM_plugins\videoFilter\libADM_vf_asharp_gtk.dll
+CheckQt4:
+				!insertmacro SectionFlagIsSet ${SecUiQt4} ${SF_SELECTED} InstallQt4 End
+InstallQt4:
+				File ${BUILDDIR}\lib\ADM_plugins\videoFilter\libADM_vf_asharp_qt4.dll
+End:
+			${MementoSectionEnd}
+			${MementoSection} "MSharpen" SecVidFltMSharpen
+				SectionIn 1 2
+				SetOverwrite on
+				SetOutPath $INSTDIR\lib\ADM_plugins\videoFilter
+				File ${BUILDDIR}\lib\ADM_plugins\videoFilter\libADM_vf_mSharpen.dll
+			${MementoSectionEnd}
+			${MementoSection} "MSmooth" SecVidFltMSmooth
+				SectionIn 1 2
+				SetOverwrite on
+				SetOutPath $INSTDIR\lib\ADM_plugins\videoFilter
+				File ${BUILDDIR}\lib\ADM_plugins\videoFilter\libADM_vf_mSmooth.dll
+			${MementoSectionEnd}
+			${MementoSection} "Soften" SecVidFltSoften
+				SectionIn 1 2
+				SetOverwrite on
+				SetOutPath $INSTDIR\lib\ADM_plugins\videoFilter
+				File ${BUILDDIR}\lib\ADM_plugins\videoFilter\libADM_vf_soften.dll
+			${MementoSectionEnd}
+		SectionGroupEnd
+		SectionGroup "Subtitle Filters" SecGrpVideoFilterSubtitle
+			${MementoSection} "ASS/SSA" SecVidFltAssSsa
+				SectionIn 1 2
+				SetOverwrite on
+				SetOutPath $INSTDIR\lib\ADM_plugins\videoFilter
+				File ${BUILDDIR}\lib\ADM_plugins\videoFilter\libADM_vf_ssa.dll
+			${MementoSectionEnd}
+			${MementoSection} "Subtitler" SecVidFltSubtitler
+				SectionIn 1 2
+				SetOverwrite on
+				SetOutPath $INSTDIR\lib\ADM_plugins\videoFilter
+
+				!insertmacro SectionFlagIsSet ${SecUiGtk} ${SF_SELECTED} InstallGtk CheckQt4
+InstallGtk:
+				File ${BUILDDIR}\lib\ADM_plugins\videoFilter\libADM_vf_sub_gtk.dll
+CheckQt4:
+				!insertmacro SectionFlagIsSet ${SecUiQt4} ${SF_SELECTED} InstallQt4 End
+InstallQt4:
+				File ${BUILDDIR}\lib\ADM_plugins\videoFilter\libADM_vf_sub_qt4.dll
+End:
+			${MementoSectionEnd}
+		SectionGroupEnd
+		SectionGroup "Miscellaneous Filters" SecGrpVideoFilterMiscellaneous
+			${MementoSection} "Mosaic" SecVidFltMosaic
+				SectionIn 1 2
+				SetOverwrite on
+				SetOutPath $INSTDIR\lib\ADM_plugins\videoFilter
+				File ${BUILDDIR}\lib\ADM_plugins\videoFilter\libADM_vf_Mosaic.dll
+			${MementoSectionEnd}
+			${MementoSection} "MPlayer Delogo" SecVidFltMPlayerDelogo
+				SectionIn 1 2
+				SetOverwrite on
+				SetOutPath $INSTDIR\lib\ADM_plugins\videoFilter
+
+				!insertmacro SectionFlagIsSet ${SecUiGtk} ${SF_SELECTED} InstallGtk CheckQt4
+InstallGtk:
+				File ${BUILDDIR}\lib\ADM_plugins\videoFilter\libADM_vf_mpdelogo_gtk.dll
+CheckQt4:
+				!insertmacro SectionFlagIsSet ${SecUiQt4} ${SF_SELECTED} InstallQt4 End
+InstallQt4:
+				File ${BUILDDIR}\lib\ADM_plugins\videoFilter\libADM_vf_mpdelogo_qt4.dll
+End:
+			${MementoSectionEnd}
+			${MementoSection} "Whirl" SecVidFltWhirl
+				SectionIn 1 2
+				SetOverwrite on
+				SetOutPath $INSTDIR\lib\ADM_plugins\videoFilter
+				File ${BUILDDIR}\lib\ADM_plugins\videoFilter\libADM_vf_Whirl.dll
+			${MementoSectionEnd}
+		SectionGroupEnd
+	SectionGroupEnd
+SectionGroupEnd
+
 SectionGroup "Additional languages" SecGrpLang
-    Section "Catalan (GTK+ only)" SecLangCatalan
+    ${MementoUnselectedSection} "Catalan (GTK+ only)" SecLangCatalan
         SectionIn 2
         !insertmacro InstallGtkLanguage Catalan ca
-    SectionEnd
+    ${MementoSectionEnd}
 
-    Section "Czech" SecLangCzech
+    ${MementoUnselectedSection} "Czech" SecLangCzech
         SectionIn 2
         !insertmacro InstallGtkLanguage Czech cs
         !insertmacro InstallQt4Language Czech cs
-    SectionEnd
+    ${MementoSectionEnd}
 
-    Section "French" SecLangFrench
+    ${MementoUnselectedSection} "French" SecLangFrench
         SectionIn 2
         !insertmacro InstallGtkLanguage French fr
         !insertmacro InstallQt4Language French fr
-    SectionEnd
+    ${MementoSectionEnd}
 
-    Section "German (GTK+ only)" SecLangGerman
+    ${MementoUnselectedSection} "German (GTK+ only)" SecLangGerman
         SectionIn 2
         !insertmacro InstallGtkLanguage German de
-    SectionEnd
+    ${MementoSectionEnd}
 
-    Section "Greek (GTK+ only)" SecLangGreek
+    ${MementoUnselectedSection} "Greek (GTK+ only)" SecLangGreek
         SectionIn 2
         !insertmacro InstallGtkLanguage Greek el
-    SectionEnd
+    ${MementoSectionEnd}
 
-    Section "Italian" SecLangItalian
+    ${MementoUnselectedSection} "Italian" SecLangItalian
         SectionIn 2
         !insertmacro InstallGtkLanguage Italian it
         !insertmacro InstallQt4Language Italian it
-    SectionEnd
+    ${MementoSectionEnd}
 
-    Section "Japanese (GTK+ only)" SecLangJapanese
+    ${MementoUnselectedSection} "Japanese (GTK+ only)" SecLangJapanese
         SectionIn 2
         !insertmacro InstallGtkLanguage Japanese ja
-    SectionEnd
+    ${MementoSectionEnd}
 
-    Section "Russian (GTK+ only)" SecLangRussian
+    ${MementoUnselectedSection} "Russian (GTK+ only)" SecLangRussian
         SectionIn 2
         !insertmacro InstallGtkLanguage Russian ru
-    SectionEnd
+    ${MementoSectionEnd}
 
-    Section "Serbian Cyrillic (GTK+ only)" SecLangSerbianCyrillic
+    ${MementoUnselectedSection} "Serbian Cyrillic (GTK+ only)" SecLangSerbianCyrillic
         SectionIn 2
         !insertmacro InstallGtkLanguage SerbianCyrillic sr
-    SectionEnd
+    ${MementoSectionEnd}
 
-    Section "Serbian Latin (GTK+ only)" SecLangSerbianLatin
+    ${MementoUnselectedSection} "Serbian Latin (GTK+ only)" SecLangSerbianLatin
         SectionIn 2
         !insertmacro InstallGtkLanguage SerbianLatin sr at latin
-    SectionEnd
+    ${MementoSectionEnd}
 
-    Section "Spanish (GTK+ only)" SecLangSpanish
+    ${MementoUnselectedSection} "Spanish (GTK+ only)" SecLangSpanish
         SectionIn 2
         !insertmacro InstallGtkLanguage Spanish es
-    SectionEnd
+    ${MementoSectionEnd}
 
-    Section "Turkish (GTK+ only)" SecLangTurkish
+    ${MementoUnselectedSection} "Turkish (GTK+ only)" SecLangTurkish
         SectionIn 2
         !insertmacro InstallGtkLanguage Turkish tr
-    SectionEnd
+    ${MementoSectionEnd}
 SectionGroupEnd
 
-Section AvsProxy SecAvsProxy
+${MementoUnselectedSection} "Avisynth Proxy" SecAvsProxy
     SectionIn 2
     SetOutPath $INSTDIR
     SetOverwrite on
     File /r ${BUILDDIR}\avsproxy.exe
     File /r ${BUILDDIR}\avsproxy_gui.exe
-    WriteRegStr HKLM "${REGKEY}\Components" "AvsProxy" 1
-SectionEnd
+${MementoSectionEnd}
 
-Section "Sample external filter" SecFilter
-    SectionIn 2
-    SetOutPath $INSTDIR\plugin
-    SetOverwrite on
-    File /r ${BUILDDIR}\plugin\*
-    WriteRegStr HKLM "${REGKEY}\Components" "Sample external filter" 1
-SectionEnd
-
-Section "-Start menu Change Log" SecStartMenuChangeLog
+${MementoSection} "-Start menu Change Log" SecStartMenuChangeLog
     CreateDirectory $SMPROGRAMS\$StartMenuGroup
     !insertmacro MUI_STARTMENU_WRITE_BEGIN Application
     SetOutPath $INSTDIR
     CreateShortcut "$SMPROGRAMS\$StartMenuGroup\Change Log.lnk" "$INSTDIR\Change Log.html"
     !insertmacro MUI_STARTMENU_WRITE_END
-    WriteRegStr HKLM "${REGKEY}\Components" "Start menu" 1
-SectionEnd
+${MementoSectionEnd}
 
-Section "-Start menu GTK+" SecStartMenuGtk
+${MementoSection} "-Start menu GTK+" SecStartMenuGtk
     CreateDirectory $SMPROGRAMS\$StartMenuGroup
     !insertmacro MUI_STARTMENU_WRITE_BEGIN Application
     SetOutPath $INSTDIR
     CreateShortcut "$SMPROGRAMS\$StartMenuGroup\${INTERNALNAME} GTK+.lnk" $INSTDIR\avidemux2_gtk.exe
     !insertmacro MUI_STARTMENU_WRITE_END
-    WriteRegStr HKLM "${REGKEY}\Components" "Start menu" 1
-SectionEnd
+${MementoSectionEnd}
 
-Section "-Start menu Qt4" SecStartMenuQt4
+${MementoSection} "-Start menu Qt4" SecStartMenuQt4
     CreateDirectory $SMPROGRAMS\$StartMenuGroup
     !insertmacro MUI_STARTMENU_WRITE_BEGIN Application
     SetOutPath $INSTDIR
     CreateShortcut "$SMPROGRAMS\$StartMenuGroup\${INTERNALNAME} Qt4.lnk" $INSTDIR\avidemux2_qt4.exe
     !insertmacro MUI_STARTMENU_WRITE_END
-    WriteRegStr HKLM "${REGKEY}\Components" "Start menu" 1
-SectionEnd
+${MementoSectionEnd}
 
-Section "-Start menu AVS Proxy GUI" SecStartMenuAvsProxyGui
+${MementoSection} "-Start menu AVS Proxy GUI" SecStartMenuAvsProxyGui
     CreateDirectory $SMPROGRAMS\$StartMenuGroup
     !insertmacro MUI_STARTMENU_WRITE_BEGIN Application
     SetOutPath $INSTDIR
     CreateShortcut "$SMPROGRAMS\$StartMenuGroup\AVS Proxy GUI.lnk" "$INSTDIR\avsproxy_gui.exe"
     !insertmacro MUI_STARTMENU_WRITE_END
-    WriteRegStr HKLM "${REGKEY}\Components" "Start menu" 1
-SectionEnd
+${MementoSectionEnd}
 
-Section "-Quick Launch GTK+" SecQuickLaunchGtk
+${MementoSection} "-Quick Launch GTK+" SecQuickLaunchGtk
     SetOutPath $INSTDIR
     CreateShortcut "$QUICKLAUNCH\${INTERNALNAME} GTK+.lnk" $INSTDIR\avidemux2_gtk.exe
-    WriteRegStr HKLM "${REGKEY}\Components" "Quick Launch" 1
-SectionEnd
+${MementoSectionEnd}
 
-Section "-Quick Launch Qt4" SecQuickLaunchQt4
+${MementoSection} "-Quick Launch Qt4" SecQuickLaunchQt4
     SetOutPath $INSTDIR
     CreateShortcut "$QUICKLAUNCH\${INTERNALNAME} Qt4.lnk" $INSTDIR\avidemux2_qt4.exe
-    WriteRegStr HKLM "${REGKEY}\Components" "Quick Launch" 1
-SectionEnd
+${MementoSectionEnd}
 
-Section "-Desktop GTK+" SecDesktopGtk
+${MementoSection} "-Desktop GTK+" SecDesktopGtk
     SetOutPath $INSTDIR
     CreateShortcut "$DESKTOP\${INTERNALNAME} GTK+.lnk" $INSTDIR\avidemux2_gtk.exe
-    WriteRegStr HKLM "${REGKEY}\Components" "Desktop" 1
-SectionEnd
+${MementoSectionEnd}
 
-Section "-Desktop Qt4" SecDesktopQt4
+${MementoSection} "-Desktop Qt4" SecDesktopQt4
     SetOutPath $INSTDIR
     CreateShortcut "$DESKTOP\${INTERNALNAME} Qt4.lnk" $INSTDIR\avidemux2_qt4.exe
-    WriteRegStr HKLM "${REGKEY}\Components" "Desktop" 1
-SectionEnd
+${MementoSectionEnd}
 
+${MementoSectionDone}
+
 Section -post SecUninstaller
     SectionIn 1 2
     WriteRegStr HKLM "${REGKEY}" Path $INSTDIR
@@ -411,15 +1029,9 @@
 ##########################
 # Uninstaller sections
 ##########################
-Section /o "un.Sample external filter" UnSecFilter
-    RmDir /r /REBOOTOK $INSTDIR\plugin
-    DeleteRegValue HKLM "${REGKEY}\Components" "Sample external filter"
-SectionEnd
-
 Section /o "un.AvsProxy" UnSecAvsProxy
     Delete /REBOOTOK $INSTDIR\avsproxy.exe
     Delete /REBOOTOK $INSTDIR\avsproxy_gui.exe
-    DeleteRegValue HKLM "${REGKEY}\Components" "AvsProxy"
 SectionEnd
 
 Section /o un.Catalan UnSecLangCatalan
@@ -493,7 +1105,6 @@
     RmDir /r /REBOOTOK $INSTDIR\lib\gtk-2.0
     RmDir /r /REBOOTOK $INSTDIR\etc\gtk-2.0
     RmDir /r /REBOOTOK $INSTDIR\etc\pango
-    DeleteRegValue HKLM "${REGKEY}\Components" GTK+
 SectionEnd
 
 Section /o un.Qt4 UnSecUiQt4
@@ -501,12 +1112,10 @@
     Delete /REBOOTOK $INSTDIR\mingwm10.dll
     Delete /REBOOTOK $INSTDIR\avidemux2_qt4.exe
     Delete /REBOOTOK $INSTDIR\QtGui4.dll
-    DeleteRegValue HKLM "${REGKEY}\Components" Qt4
 SectionEnd
 
 Section /o "un.Command line" UnSecUiCli
     Delete /REBOOTOK $INSTDIR\avidemux2_cli.exe
-    DeleteRegValue HKLM "${REGKEY}\Components" "Command line"
 SectionEnd
 
 Section /o "un.Core files (required)" UnSecCore
@@ -534,8 +1143,7 @@
     Delete /REBOOTOK "$INSTDIR\stdout.txt"
     Delete /REBOOTOK "$INSTDIR\stderr.txt"
     RmDir /r /REBOOTOK $INSTDIR\etc\fonts
-    DeleteRegValue HKLM "${REGKEY}\Components" Avidemux
-    
+
     RmDir /REBOOTOK $INSTDIR\share\gettext
     RmDir /REBOOTOK $INSTDIR\share
 SectionEnd
@@ -568,7 +1176,6 @@
     Delete /REBOOTOK $INSTDIR\uninstall.exe
     DeleteRegValue HKLM "${REGKEY}" StartMenuGroup
     DeleteRegValue HKLM "${REGKEY}" Path
-    DeleteRegKey /IfEmpty HKLM "${REGKEY}\Components"
     DeleteRegKey /IfEmpty HKLM "${REGKEY}"
     RmDir /REBOOTOK $SMPROGRAMS\$StartMenuGroup
     RmDir /REBOOTOK $INSTDIR
@@ -585,71 +1192,56 @@
 Function .onInit
     ReadRegStr $R0  HKLM "${UNINST_REGKEY}" "UninstallString"
     StrCmp $R0 "" startInstall
- 
+
     MessageBox MB_YESNO|MB_ICONEXCLAMATION "${INTERNALNAME} has already been installed. $\n$\nDo you want to remove \
       the previous version before installing $(^Name)?" IDNO startInstall
-  
+
     # Run the uninstaller
     ClearErrors
     ExecWait '$R0 _?=$INSTDIR' ; Do not copy the uninstaller to a temp file
 
 startInstall:
     InitPluginsDir
-    
-    !insertmacro MUI_INSTALLOPTIONS_EXTRACT "${INSTALL_OPTS_INI}"
 
-    # Make sure a User Interface is selected in previous install preferences
-    ReadRegStr $0 HKLM "${REGKEY}\Components" "Command line"
-    StrCmp $0 1 populate
-    ReadRegStr $0 HKLM "${REGKEY}\Components" "GTK+"
-    StrCmp $0 1 populate
-    ReadRegStr $0 HKLM "${REGKEY}\Components" "Qt4"
-    StrCmp $0 1 populate
+    ${MementoSectionRestore}
+	!insertmacro MUI_STARTMENU_GETFOLDER Application $StartMenuGroup
 
-    # No UI exists, so go with defaults
-    Goto end
+#checkStartMenuGtk:
+	!insertmacro SectionFlagIsSet ${SecStartMenuGtk} ${SF_SELECTED} enableStartMenu checkStartMenuQt4
+checkStartMenuQt4:
+	!insertmacro SectionFlagIsSet ${SecStartMenuQt4} ${SF_SELECTED} enableStartMenu checkDesktopGtk
 
-    #Select sections based on last install
-populate:
-    !insertmacro MUI_STARTMENU_GETFOLDER Application $StartMenuGroup
-    !insertmacro SELECT_SECTION "Command line" ${SecUiCli}
-    !insertmacro SELECT_SECTION Qt4 ${SecUiQt4}
-    !insertmacro SELECT_SECTION GTK+ ${SecUiGtk}
-    !insertmacro SELECT_SECTION Catalan ${SecLangCatalan}
-    !insertmacro SELECT_SECTION Czech ${SecLangCzech}
-    !insertmacro SELECT_SECTION French ${SecLangFrench}
-    !insertmacro SELECT_SECTION German ${SecLangGerman}
-    !insertmacro SELECT_SECTION Greek ${SecLangGreek}
-    !insertmacro SELECT_SECTION Italian ${SecLangItalian}
-    !insertmacro SELECT_SECTION Japanese ${SecLangJapanese}
-    !insertmacro SELECT_SECTION Russian ${SecLangRussian}
-    !insertmacro SELECT_SECTION SerbianCyrillic ${SecLangSerbianCyrillic}
-    !insertmacro SELECT_SECTION SerbianLatin ${SecLangSerbianLatin}
-    !insertmacro SELECT_SECTION Spanish ${SecLangSpanish}
-    !insertmacro SELECT_SECTION Turkish ${SecLangTurkish}
-    !insertmacro SELECT_SECTION "Sample external filter" ${SecFilter}
-    !insertmacro SELECT_SECTION AvsProxy ${SecAvsProxy}
+enableStartMenu:
+	StrCpy $CreateStartMenuGroup 1
 
-    #startMenu:
-    ReadRegStr $0 HKLM "${REGKEY}\Components" "Start menu"
-    !insertmacro MUI_INSTALLOPTIONS_WRITE "${INSTALL_OPTS_INI}" "Field 3" "State" $0
-    
-    #desktop:
-    ReadRegStr $0 HKLM "${REGKEY}\Components" "Desktop"
-    !insertmacro MUI_INSTALLOPTIONS_WRITE "${INSTALL_OPTS_INI}" "Field 2" "State" $0
-    
-    #quickLaunch:
-    ReadRegStr $0 HKLM "${REGKEY}\Components" "Quick Launch"
-    !insertmacro MUI_INSTALLOPTIONS_WRITE "${INSTALL_OPTS_INI}" "Field 4" "State" $0
-    
+checkDesktopGtk:
+	!insertmacro SectionFlagIsSet ${SecDesktopGtk} ${SF_SELECTED} enableDesktop checkDesktopQt4
+checkDesktopQt4:
+	!insertmacro SectionFlagIsSet ${SecDesktopQt4} ${SF_SELECTED} enableDesktop checkQuickLaunchGtk
+
+enableDesktop:
+	StrCpy $CreateDesktopIcon 1
+	
+checkQuickLaunchGtk:
+	!insertmacro SectionFlagIsSet ${SecQuickLaunchGtk} ${SF_SELECTED} enableQuickLaunch checkQuickLaunchQt4
+checkQuickLaunchQt4:
+	!insertmacro SectionFlagIsSet ${SecQuickLaunchQt4} ${SF_SELECTED} enableQuickLaunch end
+
+enableQuickLaunch:
+	StrCpy $CreateQuickLaunchIcon 1	
+
 end:
 FunctionEnd
 
+Function .onInstSuccess
+	${MementoSectionSave}
+FunctionEnd
+
 Function .onSelChange
 	!insertmacro SectionFlagIsSet ${SecUiGtk} ${SF_SELECTED} end checkCLI
 checkCLI:
 	!insertmacro SectionFlagIsSet ${SecUiCli} ${SF_SELECTED} end disable
-	
+
 disable:  # GTK langs only
 	SectionSetFlags ${SecLangCatalan} SF_RO
 	SectionSetFlags ${SecLangCzech} SF_RO
@@ -677,16 +1269,47 @@
 
 LangString INSTALL_OPTS_PAGE_TITLE ${LANG_ENGLISH} "Choose Install Options"
 LangString INSTALL_OPTS_PAGE_SUBTITLE ${LANG_ENGLISH} "Choose where to install Avidemux icons."
+Var dlgInstallOptions
+Var lblCreateIcons
+Var chkDesktop
+Var chkStartMenu
+Var chkQuickLaunch
 
 Function InstallOptionsPage
-    Call IsInstallOptionsRequired
+	Call IsInstallOptionsRequired
+	!insertmacro MUI_HEADER_TEXT "$(INSTALL_OPTS_PAGE_TITLE)" "$(INSTALL_OPTS_PAGE_SUBTITLE)"
 
-    !insertmacro MUI_HEADER_TEXT "$(INSTALL_OPTS_PAGE_TITLE)" "$(INSTALL_OPTS_PAGE_SUBTITLE)"
-    !insertmacro MUI_INSTALLOPTIONS_DISPLAY "${INSTALL_OPTS_INI}"
-    
-    Call ReadInstallOptions
+	nsDialogs::Create 1018
+	Pop $dlgInstallOptions
+
+	${If} $dlgInstallOptions == error
+		Abort
+	${EndIf}
+
+	${NSD_CreateLabel} 0 0u 100% 12u "Create icons for Avidemux:"
+	Pop $lblCreateIcons
+
+	${NSD_CreateCheckBox} 0 18u 100% 12u "On my &Desktop"
+	Pop $chkDesktop
+	${NSD_SetState} $chkDesktop $CreateDesktopIcon
+
+	${NSD_CreateCheckBox} 0 36u 100% 12u "In my &Start Menu Programs folder"
+	Pop $chkStartMenu
+	${NSD_SetState} $chkStartMenu $CreateStartMenuGroup
+
+	${NSD_CreateCheckBox} 0 54u 100% 12u "In my &Quick Launch bar"
+	Pop $chkQuickLaunch
+	${NSD_SetState} $chkQuickLaunch $CreateQuickLaunchIcon
+
+	nsDialogs::Show
 FunctionEnd
 
+Function InstallOptionsPageLeave
+	${NSD_GetState} $chkDesktop $CreateDesktopIcon
+	${NSD_GetState} $chkStartMenu $CreateStartMenuGroup
+	${NSD_GetState} $chkQuickLaunch $CreateQuickLaunchIcon
+FunctionEnd
+
 Function IsInstallOptionsRequired
 	!insertmacro SectionFlagIsSet ${SecUiGtk} ${SF_SELECTED} end checkQt4
 checkQt4:
@@ -701,15 +1324,9 @@
 end:
 FunctionEnd
 
-Function ReadInstallOptions
-    !insertmacro MUI_INSTALLOPTIONS_READ $CreateDesktopIcon "${INSTALL_OPTS_INI}" "Field 2" "State"
-    !insertmacro MUI_INSTALLOPTIONS_READ $CreateStartMenuGroup "${INSTALL_OPTS_INI}" "Field 3" "State"
-    !insertmacro MUI_INSTALLOPTIONS_READ $CreateQuickLaunchIcon "${INSTALL_OPTS_INI}" "Field 4" "State"
-FunctionEnd
-
 Function IsStartMenuRequired
     StrCmp $CreateStartMenuGroup 1 +2
-        Abort    
+        Abort
 FunctionEnd
 
 Function ActivateInternalSections
@@ -718,7 +1335,7 @@
     IntOp $0 $0 & ${SF_SELECTED}
     IntOp $0 $0 & $CreateStartMenuGroup
     SectionSetFlags ${SecStartMenuAvsProxyGui} $0
-    
+
     #Change Log shortcut:
     SectionSetFlags ${SecStartMenuChangeLog} $CreateStartMenuGroup
 
@@ -728,23 +1345,23 @@
 
     IntOp $1 $0 & $CreateDesktopIcon
     SectionSetFlags ${SecDesktopGtk} $1
-    
+
     IntOp $1 $0 & $CreateQuickLaunchIcon
     SectionSetFlags ${SecQuickLaunchGtk} $1
-    
+
     IntOp $1 $0 & $CreateStartMenuGroup
     SectionSetFlags ${SecStartMenuGtk} $1
-    
+
     #Qt4 shortcuts:
     SectionGetFlags ${SecUiQt4} $0
     IntOp $0 $0 & ${SF_SELECTED}
-    
+
     IntOp $1 $0 & $CreateDesktopIcon
     SectionSetFlags ${SecDesktopQt4} $1
-    
+
     IntOp $1 $0 & $CreateQuickLaunchIcon
     SectionSetFlags ${SecQuickLaunchQt4} $1
-    
+
     IntOp $1 $0 & $CreateStartMenuGroup
     SectionSetFlags ${SecStartMenuQt4} $1
 FunctionEnd
@@ -753,42 +1370,35 @@
     SectionGetFlags ${SecUiGtk} $0
     IntOp $0 $0 & ${SF_SELECTED}
     StrCmp $0 ${SF_SELECTED} end
-    
+
     SectionGetFlags ${SecUiQt4} $0
     IntOp $0 $0 & ${SF_SELECTED}
     StrCmp $0 ${SF_SELECTED} end
 
     DeleteINISec "$PLUGINSDIR\ioSpecial.ini" "Field 4"
-        
+
 end:
 FunctionEnd
 
-Function OnShowFinishPage
-    # Make hyperlink underlined to keep it consistent with web browsers
-    GetDlgItem $0 $MUI_HWND 1205
-    CreateFont $1 "$(^Font)" 9 500 /UNDERLINE
-    SendMessage $0 ${WM_SETFONT} $1 0    
-FunctionEnd
-
 Function RunAvidemux
     SetOutPath $INSTDIR
 
 #Qt4:
     SectionGetFlags ${SecUiQt4} $0
     IntOp $0 $0 & ${SF_SELECTED}
-    
+
     StrCmp $0 ${SF_SELECTED} 0 GTK
         Exec "$INSTDIR\avidemux2_qt4.exe"
 
     Goto end
-    
+
 GTK:
     SectionGetFlags ${SecUiGtk} $0
     IntOp $0 $0 & ${SF_SELECTED}
-    
+
     StrCmp $0 ${SF_SELECTED} 0 End
         Exec "$INSTDIR\avidemux2_gtk.exe"    
-    
+
 end:
 FunctionEnd
 
@@ -798,25 +1408,4 @@
 Function un.onInit
     ReadRegStr $INSTDIR HKLM "${REGKEY}" Path
     !insertmacro MUI_STARTMENU_GETFOLDER Application $StartMenuGroup
-    !insertmacro SELECT_SECTION "Core files (required)" ${UnSecCore}
-    !insertmacro SELECT_SECTION "Command line" ${UnSecUiCli}
-    !insertmacro SELECT_SECTION Qt4 ${UnSecUiQt4}
-    !insertmacro SELECT_SECTION GTK+ ${UnSecUiGtk}
-    !insertmacro SELECT_SECTION Catalan ${UnSecLangCatalan}
-    !insertmacro SELECT_SECTION Czech ${UnSecLangCzech}
-    !insertmacro SELECT_SECTION French ${UnSecLangFrench}
-    !insertmacro SELECT_SECTION German ${UnSecLangGerman}
-    !insertmacro SELECT_SECTION Greek ${UnSecLangGreek}
-    !insertmacro SELECT_SECTION Italian ${UnSecLangItalian}
-    !insertmacro SELECT_SECTION Japanese ${UnSecLangJapanese}
-    !insertmacro SELECT_SECTION Russian ${UnSecLangRussian}
-    !insertmacro SELECT_SECTION SerbianCyrillic ${UnSecLangSerbianCyrillic}
-    !insertmacro SELECT_SECTION SerbianLatin ${UnSecLangSerbianLatin}
-    !insertmacro SELECT_SECTION Spanish ${UnSecLangSpanish}
-    !insertmacro SELECT_SECTION Turkish ${UnSecLangTurkish}
-    !insertmacro SELECT_SECTION AvsProxy ${UnSecAvsProxy}
-    !insertmacro SELECT_SECTION "Sample external filter" ${UnSecFilter}
-    !insertmacro SELECT_SECTION "Start menu" ${UnSecStartMenu}
-    !insertmacro SELECT_SECTION "Quick Launch" ${UnSecQuickLaunch}
-    !insertmacro SELECT_SECTION "Desktop" ${UnSecDesktop}
 FunctionEnd

Modified: branches/avidemux_2.5_branch_gruntster/platforms/windows/installer/svnlog.xslt
===================================================================
--- branches/avidemux_2.5_branch_gruntster/platforms/windows/installer/svnlog.xslt	2009-02-08 17:28:54 UTC (rev 4580)
+++ branches/avidemux_2.5_branch_gruntster/platforms/windows/installer/svnlog.xslt	2009-02-09 21:07:24 UTC (rev 4581)
@@ -53,10 +53,10 @@
           padding-bottom: 5px;
           }
         </style>
-        <title>Avidemux 2.4 Change Log</title>
+        <title>Avidemux 2.5 Change Log</title>
       </head>
       <body>
-        <h1>Avidemux 2.4 Change Log</h1>
+        <h1>Avidemux 2.5 Change Log</h1>
         <div align="center">
           <table class="build">
             <tr>



From gruntster at mail.berlios.de  Tue Feb 10 17:00:31 2009
From: gruntster at mail.berlios.de (gruntster at mail.berlios.de)
Date: Tue, 10 Feb 2009 17:00:31 +0100
Subject: [Avidemux-svn-commit] r4582 - in
	branches/avidemux_2.5_branch_gruntster/platforms/windows:
	build_scripts/avidemux installer
Message-ID: <200902101600.n1AG0VwQ017200@sheep.berlios.de>

Author: gruntster
Date: 2009-02-10 17:00:26 +0100 (Tue, 10 Feb 2009)
New Revision: 4582

Modified:
   branches/avidemux_2.5_branch_gruntster/platforms/windows/build_scripts/avidemux/2b. Package Build.bat
   branches/avidemux_2.5_branch_gruntster/platforms/windows/installer/avidemux.nsi
Log:
[Win32] update installer script for 2.5 (generate log for uninstalling) [Part 2]

Modified: branches/avidemux_2.5_branch_gruntster/platforms/windows/build_scripts/avidemux/2b. Package Build.bat
===================================================================
--- branches/avidemux_2.5_branch_gruntster/platforms/windows/build_scripts/avidemux/2b. Package Build.bat	2009-02-09 21:07:24 UTC (rev 4581)
+++ branches/avidemux_2.5_branch_gruntster/platforms/windows/build_scripts/avidemux/2b. Package Build.bat	2009-02-10 16:00:26 UTC (rev 4582)
@@ -24,9 +24,7 @@
 advzip -z -4 "%packageDir%\%zipFile%"
 
 echo -- Generating %exeFile% --
-echo !define BUILDDIR %buildDir% > "..\..\installer\builddir.nsh"
-"%nsisDir%\makensis" /V2 "..\..\installer\avidemux.nsi"
+cd %buildDir%
+"%nsisDir%\makensis" /V2 /NOCD /DNSIDIR="%curDir%\..\..\installer" /DEXEDIR="%packageDir%" "%curDir%\..\..\installer\avidemux.nsi"
 
-move "..\..\installer\%exeFile%" "%packageDir%"
-
 pause

Modified: branches/avidemux_2.5_branch_gruntster/platforms/windows/installer/avidemux.nsi
===================================================================
--- branches/avidemux_2.5_branch_gruntster/platforms/windows/installer/avidemux.nsi	2009-02-09 21:07:24 UTC (rev 4581)
+++ branches/avidemux_2.5_branch_gruntster/platforms/windows/installer/avidemux.nsi	2009-02-10 16:00:26 UTC (rev 4582)
@@ -5,8 +5,8 @@
 !include MUI2.nsh
 !include nsDialogs.nsh
 !include Memento.nsh
-!include revision.nsh
-!include builddir.nsh
+!include FileFunc.nsh
+!include ${NSIDIR}\revision.nsh
 
 Name "Avidemux 2.5.0 beta r${REVISION}"
 
@@ -35,14 +35,14 @@
 !define MUI_ICON "${NSISDIR}\Contrib\Graphics\Icons\modern-install-blue-full.ico"
 !define MUI_HEADERIMAGE
 !define MUI_HEADERIMAGE_RIGHT
-!define MUI_HEADERIMAGE_BITMAP "PageHeader.bmp"
+!define MUI_HEADERIMAGE_BITMAP "${NSIDIR}\PageHeader.bmp"
 !define MUI_STARTMENUPAGE_REGISTRY_ROOT HKLM
 !define MUI_STARTMENUPAGE_REGISTRY_KEY "${REGKEY}"
 !define MUI_STARTMENUPAGE_REGISTRY_VALUENAME StartMenuGroup
 !define MUI_STARTMENUPAGE_DEFAULTFOLDER Avidemux
 !define MUI_STARTMENUPAGE_NODISABLE
-!define MUI_WELCOMEFINISHPAGE_BITMAP "WelcomeFinishStrip.bmp"
-!define MUI_UNICON "..\..\..\avidemux\xpm\adm.ico"
+!define MUI_WELCOMEFINISHPAGE_BITMAP "${NSIDIR}\WelcomeFinishStrip.bmp"
+!define MUI_UNICON "${NSIDIR}\..\..\..\avidemux\xpm\adm.ico"
 !define MUI_UNFINISHPAGE_NOAUTOCLOSE
 !define MUI_COMPONENTSPAGE_NODESC
 
@@ -58,7 +58,7 @@
 # Installer pages
 ##########################
 !insertmacro MUI_PAGE_WELCOME
-!insertmacro MUI_PAGE_LICENSE License.rtf
+!insertmacro MUI_PAGE_LICENSE "${NSIDIR}\License.rtf"
 !define MUI_PAGE_CUSTOMFUNCTION_LEAVE CheckSelectedUIs
 !insertmacro MUI_PAGE_COMPONENTS
 Page custom InstallOptionsPage InstallOptionsPageLeave
@@ -87,7 +87,7 @@
 ##########################
 # Installer attributes
 ##########################
-OutFile avidemux_2.5_r${REVISION}_win32.exe
+OutFile ${EXEDIR}\avidemux_2.5_r${REVISION}_win32.exe
 InstallDir "$PROGRAMFILES\Avidemux 2.5"
 CRCCheck on
 XPStyle on
@@ -105,6 +105,71 @@
 InstType Full
 
 ##########################
+# Uninstaller macros
+##########################
+!define UninstallLogPath "$INSTDIR\uninstall.log"
+Var UninstallLogHandle
+
+; Uninstall log file missing.
+LangString UninstallLogMissing ${LANG_ENGLISH} "uninstall.log not found!$\r$\nUninstallation cannot proceed!"
+
+!macro InstallFile FILEREGEX
+	File "${FILEREGEX}"
+	!define Index 'Line${__LINE__}'
+	${GetFileName} "${FILEREGEX}" $R0
+	FindFirst $0 $1 "$OUTDIR\$R0"
+	StrCmp $0 "" "${Index}-End"
+"${Index}-Loop:"
+	StrCmp $1 "" "${Index}-End"
+	FileWrite $UninstallLogHandle "$OUTDIR\$1$\r$\n"
+	FindNext $0 $1
+	Goto "${Index}-Loop"
+"${Index}-End:"
+	!undef Index
+!macroend
+!define File "!insertmacro InstallFile"
+ 
+!macro InstallFolder FILEREGEX
+	File /r "${FILEREGEX}\*"
+	Push "$OUTDIR"
+	Call InstallFolderInternal
+!macroend
+!define Folder "!insertmacro InstallFolder"
+ 
+Function InstallFolderInternal
+	Pop $9
+	!define Index 'Line${__LINE__}'
+	FindFirst $0 $1 "$9\*"
+	StrCmp $0 "" "${Index}-End"
+"${Index}-Loop:"
+	StrCmp $1 "" "${Index}-End"
+	StrCmp $1 "." "${Index}-Next"
+	StrCmp $1 ".." "${Index}-Next"
+	IfFileExists "$9\$1\*" 0 "${Index}-Write"
+		Push $0
+		Push $9
+		Push "$9\$1"
+		Call InstallFolderInternal
+		Pop $9
+		Pop $0
+		Goto "${Index}-Next"
+"${Index}-Write:"
+	FileWrite $UninstallLogHandle "$9\$1$\r$\n"
+"${Index}-Next:"
+	FindNext $0 $1
+	Goto "${Index}-Loop"
+"${Index}-End:"
+	!undef Index
+FunctionEnd
+
+; WriteUninstaller macro
+!macro WriteUninstaller Path
+	WriteUninstaller "${Path}"
+	FileWrite $UninstallLogHandle "${Path}$\r$\n"
+!macroend
+!define WriteUninstaller "!insertmacro WriteUninstaller"
+
+##########################
 # Macros
 ##########################
 !macro InstallGtkLanguage LANG_NAME LANG_CODE
@@ -114,8 +179,8 @@
 
 installGtk${LANG_CODE}:
     SetOutPath $INSTDIR\share\locale\${LANG_CODE}\LC_MESSAGES
-    File ${BUILDDIR}\share\locale\${LANG_CODE}\LC_MESSAGES\avidemux.mo
-    File ${BUILDDIR}\share\locale\${LANG_CODE}\LC_MESSAGES\gtk20.mo
+    ${File} share\locale\${LANG_CODE}\LC_MESSAGES\avidemux.mo
+    ${File} share\locale\${LANG_CODE}\LC_MESSAGES\gtk20.mo
 
 endGtk${LANG_CODE}:
 !macroend
@@ -127,54 +192,54 @@
 
 installQt4${LANG_CODE}:	
 	SetOutPath $INSTDIR\i18n
-    File ${BUILDDIR}\i18n\avidemux_${LANG_CODE}.qm
-    File ${BUILDDIR}\i18n\qt_${LANG_CODE}.qm
+    ${File} i18n\avidemux_${LANG_CODE}.qm
+    ${File} i18n\qt_${LANG_CODE}.qm
 
 endQt4${LANG_CODE}:
 !macroend
 
-!macro UninstallLanguage LANG_NAME LANG_CODE
-    RmDir /r /REBOOTOK $INSTDIR\share\locale\${LANG_CODE}
-    Delete /REBOOTOK $INSTDIR\i18n\avidemux_${LANG_CODE}.qm
-    Delete /REBOOTOK $INSTDIR\i18n\qt_${LANG_CODE}.qm
-!macroend
-
 ##########################
 # Installer sections
 ##########################
+Section -OpenLogFile
+	CreateDirectory "$INSTDIR"
+	FileOpen $UninstallLogHandle ${UninstallLogPath} a
+	FileSeek $UninstallLogHandle 0 END
+SectionEnd
+
 Section "Core files (required)" SecCore
     SectionIn 1 2 RO
     SetOutPath $INSTDIR
     SetOverwrite on
-    File "${BUILDDIR}\Build Info.txt"
-    File "${BUILDDIR}\Change Log.html"
-    File ${BUILDDIR}\zlib1.dll
-    File ${BUILDDIR}\freetype6.dll
-    File ${BUILDDIR}\iconv.dll
-    File ${BUILDDIR}\intl.dll
-    File ${BUILDDIR}\libADM_core.dll
-    File ${BUILDDIR}\libADM_coreAudio.dll
-    File ${BUILDDIR}\libADM_coreImage.dll
-    File ${BUILDDIR}\libADM_coreUI.dll
-    File ${BUILDDIR}\libADM_smjs.dll
-    File ${BUILDDIR}\libaften.dll
-    File ${BUILDDIR}\libexpat-*.dll
-    File ${BUILDDIR}\libfontconfig-1.dll
-    File ${BUILDDIR}\libxml2.dll
-    File ${BUILDDIR}\ogg.dll
-    File ${BUILDDIR}\pthreadGC2.dll
-    File ${BUILDDIR}\SDL.dll
-    File ${BUILDDIR}\xmltok.dll
-    File ${BUILDDIR}\AUTHORS.
-    File ${BUILDDIR}\COPYING.
-    File ${BUILDDIR}\README.
-    File ${BUILDDIR}\avcodec-*.dll
-    File ${BUILDDIR}\avformat-*.dll
-    File ${BUILDDIR}\avutil-*.dll
-    File ${BUILDDIR}\postproc-*.dll
-    File ${BUILDDIR}\swscale-*.dll
+    ${File} "Build Info.txt"
+    ${File} "Change Log.html"
+    ${File} zlib1.dll
+    ${File} freetype6.dll
+    ${File} iconv.dll
+    ${File} intl.dll
+    ${File} libADM_core.dll
+    ${File} libADM_coreAudio.dll
+    ${File} libADM_coreImage.dll
+    ${File} libADM_coreUI.dll
+    ${File} libADM_smjs.dll
+    ${File} libaften.dll
+    ${File} libexpat-*.dll
+    ${File} libfontconfig-1.dll
+    ${File} libxml2.dll
+    ${File} ogg.dll
+    ${File} pthreadGC2.dll
+    ${File} SDL.dll
+    ${File} xmltok.dll
+    ${File} AUTHORS.
+    ${File} COPYING.
+    ${File} README.
+    ${File} avcodec-*.dll
+    ${File} avformat-*.dll
+    ${File} avutil-*.dll
+    ${File} postproc-*.dll
+    ${File} swscale-*.dll
     SetOutPath $INSTDIR\etc\fonts
-    File /r ${BUILDDIR}\etc\fonts\*
+    ${Folder} etc\fonts
 SectionEnd
 
 SectionGroup /e "User interfaces" SecGrpUI
@@ -182,55 +247,55 @@
         SectionIn 1 2
         SetOutPath $INSTDIR
         SetOverwrite on
-        File ${BUILDDIR}\avidemux2_cli.exe
-        File ${BUILDDIR}\libADM_render_cli.dll
-        File ${BUILDDIR}\libADM_UICli.dll
+        ${File} avidemux2_cli.exe
+        ${File} libADM_render_cli.dll
+        ${File} libADM_UICli.dll
     ${MementoSectionEnd}
 
     ${MementoUnselectedSection} GTK+ SecUiGtk
         SectionIn 2
         SetOverwrite on
         SetOutPath $INSTDIR\etc\gtk-2.0
-        File /r ${BUILDDIR}\etc\gtk-2.0\*
+        ${Folder} etc\gtk-2.0
         SetOutPath $INSTDIR\etc\pango
-        File /r ${BUILDDIR}\etc\pango\*
+        ${Folder} etc\pango
         SetOutPath $INSTDIR\lib\gtk-2.0
-        File /r ${BUILDDIR}\lib\gtk-2.0\*
+        ${Folder} lib\gtk-2.0
         SetOutPath $INSTDIR\share\themes
-        File /r ${BUILDDIR}\share\themes\*
+        ${Folder} share\themes
         SetOutPath $INSTDIR
-        File ${BUILDDIR}\avidemux2_gtk.exe
-        File ${BUILDDIR}\gtk2_prefs.exe
-        File ${BUILDDIR}\jpeg62.dll
-        File ${BUILDDIR}\libADM_render_gtk.dll
-        File ${BUILDDIR}\libADM_UIGtk.dll
-        File ${BUILDDIR}\libatk-1.0-0.dll
-        File ${BUILDDIR}\libcairo-2.dll
-        File ${BUILDDIR}\libgdk_pixbuf-2.0-0.dll
-        File ${BUILDDIR}\libgdk-win32-2.0-0.dll
-        File ${BUILDDIR}\libgio-2.0-0.dll
-        File ${BUILDDIR}\libglib-2.0-0.dll
-        File ${BUILDDIR}\libgmodule-2.0-0.dll
-        File ${BUILDDIR}\libgobject-2.0-0.dll
-        File ${BUILDDIR}\libgthread-2.0-0.dll
-        File ${BUILDDIR}\libgtk-win32-2.0-0.dll
-        File ${BUILDDIR}\libpango-1.0-0.dll
-        File ${BUILDDIR}\libpangocairo-1.0-0.dll
-        File ${BUILDDIR}\libpangowin32-1.0-0.dll
-        File ${BUILDDIR}\libpng12-0.dll
-        File ${BUILDDIR}\libtiff3.dll
+        ${File} avidemux2_gtk.exe
+        ${File} gtk2_prefs.exe
+        ${File} jpeg62.dll
+        ${File} libADM_render_gtk.dll
+        ${File} libADM_UIGtk.dll
+        ${File} libatk-1.0-0.dll
+        ${File} libcairo-2.dll
+        ${File} libgdk_pixbuf-2.0-0.dll
+        ${File} libgdk-win32-2.0-0.dll
+        ${File} libgio-2.0-0.dll
+        ${File} libglib-2.0-0.dll
+        ${File} libgmodule-2.0-0.dll
+        ${File} libgobject-2.0-0.dll
+        ${File} libgthread-2.0-0.dll
+        ${File} libgtk-win32-2.0-0.dll
+        ${File} libpango-1.0-0.dll
+        ${File} libpangocairo-1.0-0.dll
+        ${File} libpangowin32-1.0-0.dll
+        ${File} libpng12-0.dll
+        ${File} libtiff3.dll
     ${MementoSectionEnd}
 
     ${MementoSection} Qt4 SecUiQt4
         SectionIn 1 2
         SetOutPath $INSTDIR
         SetOverwrite on
-        File ${BUILDDIR}\QtGui4.dll
-        File ${BUILDDIR}\avidemux2_qt4.exe
-        File ${BUILDDIR}\libADM_render_qt4.dll
-        File ${BUILDDIR}\libADM_UIQT4.dll
-        File ${BUILDDIR}\mingwm10.dll
-        File ${BUILDDIR}\QtCore4.dll
+        ${File} QtGui4.dll
+        ${File} avidemux2_qt4.exe
+        ${File} libADM_render_qt4.dll
+        ${File} libADM_UIQT4.dll
+        ${File} mingwm10.dll
+        ${File} QtCore4.dll
     ${MementoSectionEnd}
 SectionGroupEnd
 
@@ -240,21 +305,21 @@
 			SectionIn 1 2
 			SetOverwrite on
 			SetOutPath $INSTDIR\lib\ADM_plugins\audioDecoder
-			File ${BUILDDIR}\lib\ADM_plugins\audioDecoder\libADM_ad_faad.dll
+			${File} lib\ADM_plugins\audioDecoder\libADM_ad_faad.dll
 			SetOutPath $INSTDIR
-			File ${BUILDDIR}\libfaad2.dll
+			${File} libfaad2.dll
 		${MementoSectionEnd}
 		${MementoSection} "liba52 (AC-3)" SecAudDecA52
 			SectionIn 1 2
 			SetOverwrite on
 			SetOutPath $INSTDIR\lib\ADM_plugins\audioDecoder
-			File ${BUILDDIR}\lib\ADM_plugins\audioDecoder\libADM_ad_a52.dll
+			${File} lib\ADM_plugins\audioDecoder\libADM_ad_a52.dll
 		${MementoSectionEnd}
 		${MementoSection} "MAD (MPEG)" SecAudDecMad
 			SectionIn 1 2
 			SetOverwrite on
 			SetOutPath $INSTDIR\lib\ADM_plugins\audioDecoder
-			File ${BUILDDIR}\lib\ADM_plugins\audioDecoder\libADM_ad_Mad.dll
+			${File} lib\ADM_plugins\audioDecoder\libADM_ad_Mad.dll
 		${MementoSectionEnd}
 	SectionGroupEnd
 	SectionGroup "Audio Devices" SecGrpAudioDevice
@@ -262,13 +327,13 @@
 			SectionIn 2
 			SetOverwrite on
 			SetOutPath $INSTDIR\lib\ADM_plugins\audioDevices
-			File ${BUILDDIR}\lib\ADM_plugins\audioDevices\libADM_av_sdl.dll
+			${File} lib\ADM_plugins\audioDevices\libADM_av_sdl.dll
 		${MementoSectionEnd}
 		${MementoSection} "MS Windows (Waveform)" SecAudDevWaveform
 			SectionIn 1 2
 			SetOverwrite on
 			SetOutPath $INSTDIR\lib\ADM_plugins\audioDevices
-			File ${BUILDDIR}\lib\ADM_plugins\audioDevices\libADM_av_win32.dll
+			${File} lib\ADM_plugins\audioDevices\libADM_av_win32.dll
 		${MementoSectionEnd}
 	SectionGroupEnd
 	SectionGroup "Audio Encoders" SecGrpAudioEncoder
@@ -276,50 +341,50 @@
 			SectionIn 1 2
 			SetOverwrite on
 			SetOutPath $INSTDIR\lib\ADM_plugins\audioEncoders
-			File ${BUILDDIR}\lib\ADM_plugins\audioEncoders\libADM_ae_faac.dll
+			${File} lib\ADM_plugins\audioEncoders\libADM_ae_faac.dll
 			SetOutPath $INSTDIR
-			File ${BUILDDIR}\libfaac.dll
+			${File} libfaac.dll
 		${MementoSectionEnd}
 		${MementoSection} "LAME (MP3)" SecAudEncLame
 			SectionIn 1 2
 			SetOverwrite on
 			SetOutPath $INSTDIR\lib\ADM_plugins\audioEncoders
-			File ${BUILDDIR}\lib\ADM_plugins\audioEncoders\libADM_ae_lame.dll
+			${File} lib\ADM_plugins\audioEncoders\libADM_ae_lame.dll
 			SetOutPath $INSTDIR
-			File ${BUILDDIR}\libmp3lame-0.dll
+			${File} libmp3lame-0.dll
 		${MementoSectionEnd}
 		${MementoSection} "libavcodec (AC-3)" SecAudEncLavAc3
 			SectionIn 1 2
 			SetOverwrite on
 			SetOutPath $INSTDIR\lib\ADM_plugins\audioEncoders
-			File ${BUILDDIR}\lib\ADM_plugins\audioEncoders\libADM_ae_lav_ac3.dll
+			${File} lib\ADM_plugins\audioEncoders\libADM_ae_lav_ac3.dll
 		${MementoSectionEnd}
 		${MementoSection} "libavcodec (MP2)" SecAudEncLavMp2
 			SectionIn 1 2
 			SetOverwrite on
 			SetOutPath $INSTDIR\lib\ADM_plugins\audioEncoders
-			File ${BUILDDIR}\lib\ADM_plugins\audioEncoders\libADM_ae_lav_mp2.dll
+			${File} lib\ADM_plugins\audioEncoders\libADM_ae_lav_mp2.dll
 		${MementoSectionEnd}
 		${MementoSection} "libvorbis (Vorbis)" SecAudEncVorbis
 			SectionIn 1 2
 			SetOverwrite on
 			SetOutPath $INSTDIR\lib\ADM_plugins\audioEncoders
-			File ${BUILDDIR}\lib\ADM_plugins\audioEncoders\libADM_ae_vorbis.dll
+			${File} lib\ADM_plugins\audioEncoders\libADM_ae_vorbis.dll
 			SetOutPath $INSTDIR
-			File ${BUILDDIR}\vorbis.dll
-			File ${BUILDDIR}\vorbisenc.dll
+			${File} vorbis.dll
+			${File} vorbisenc.dll
 		${MementoSectionEnd}
 		${MementoSection} "PCM" SecAudEncPcm
 			SectionIn 1 2
 			SetOverwrite on
 			SetOutPath $INSTDIR\lib\ADM_plugins\audioEncoders
-			File ${BUILDDIR}\lib\ADM_plugins\audioEncoders\libADM_ae_pcm.dll
+			${File} lib\ADM_plugins\audioEncoders\libADM_ae_pcm.dll
 		${MementoSectionEnd}
 		${MementoSection} "TwoLAME (MP2)" SecAudEncTwoLame
 			SectionIn 1 2
 			SetOverwrite on
 			SetOutPath $INSTDIR\lib\ADM_plugins\audioEncoders
-			File ${BUILDDIR}\lib\ADM_plugins\audioEncoders\libADM_ae_twolame.dll
+			${File} lib\ADM_plugins\audioEncoders\libADM_ae_twolame.dll
 		${MementoSectionEnd}
 	SectionGroupEnd
 	SectionGroup "Video Encoders" SecGrpVideoEncoder
@@ -327,39 +392,39 @@
 			SectionIn 1 2
 			SetOverwrite on
 			SetOutPath $INSTDIR\lib\ADM_plugins\videoEncoder
-			File ${BUILDDIR}\lib\ADM_plugins\videoEncoder\libADM_vidEnc_x264.dll
+			${File} lib\ADM_plugins\videoEncoder\libADM_vidEnc_x264.dll
 			SetOutPath $INSTDIR\lib\ADM_plugins\videoEncoder\x264
 			!insertmacro SectionFlagIsSet ${SecUiGtk} ${SF_SELECTED} InstallGtk CheckQt4
 InstallGtk:
-			File ${BUILDDIR}\lib\ADM_plugins\videoEncoder\x264\libADM_vidEnc_x264_Gtk.dll
+			${File} lib\ADM_plugins\videoEncoder\x264\libADM_vidEnc_x264_Gtk.dll
 CheckQt4:
 			!insertmacro SectionFlagIsSet ${SecUiQt4} ${SF_SELECTED} InstallQt4 End
 InstallQt4:
-			File ${BUILDDIR}\lib\ADM_plugins\videoEncoder\x264\libADM_vidEnc_x264_Qt.dll
+			${File} lib\ADM_plugins\videoEncoder\x264\libADM_vidEnc_x264_Qt.dll
 End:
-			File ${BUILDDIR}\lib\ADM_plugins\videoEncoder\x264\x264Param.xsd
-			File ${BUILDDIR}\lib\ADM_plugins\videoEncoder\x264\*.xml
+			${File} lib\ADM_plugins\videoEncoder\x264\x264Param.xsd
+			${File} lib\ADM_plugins\videoEncoder\x264\*.xml
 			SetOutPath $INSTDIR
-			File ${BUILDDIR}\libx264-*.dll
+			${File} libx264-*.dll
 		${MementoSectionEnd}
 		${MementoSection} "Xvid (MPEG-4 ASP)" SecVidEncXvid
 			SectionIn 1 2
 			SetOverwrite on
 			SetOutPath $INSTDIR\lib\ADM_plugins\videoEncoder
-			File ${BUILDDIR}\lib\ADM_plugins\videoEncoder\libADM_vidEnc_xvid.dll
+			${File} lib\ADM_plugins\videoEncoder\libADM_vidEnc_xvid.dll
 SetOutPath $INSTDIR\lib\ADM_plugins\videoEncoder\xvid
 			!insertmacro SectionFlagIsSet ${SecUiGtk} ${SF_SELECTED} InstallGtk CheckQt4
 InstallGtk:
-			File ${BUILDDIR}\lib\ADM_plugins\videoEncoder\xvid\libADM_vidEnc_Xvid_Gtk.dll
+			${File} lib\ADM_plugins\videoEncoder\xvid\libADM_vidEnc_Xvid_Gtk.dll
 CheckQt4:
 			!insertmacro SectionFlagIsSet ${SecUiQt4} ${SF_SELECTED} InstallQt4 End
 InstallQt4:
-			File ${BUILDDIR}\lib\ADM_plugins\videoEncoder\xvid\libADM_vidEnc_Xvid_Qt.dll
+			${File} lib\ADM_plugins\videoEncoder\xvid\libADM_vidEnc_Xvid_Qt.dll
 End:
-			File ${BUILDDIR}\lib\ADM_plugins\videoEncoder\xvid\XvidParam.xsd
-			#File ${BUILDDIR}\lib\ADM_plugins\videoEncoder\xvid\*.xml
+			${File} lib\ADM_plugins\videoEncoder\xvid\XvidParam.xsd
+			#${File} lib\ADM_plugins\videoEncoder\xvid\*.xml
 			SetOutPath $INSTDIR
-			File ${BUILDDIR}\xvidcore.dll
+			${File} xvidcore.dll
 		${MementoSectionEnd}
 	SectionGroupEnd
 	SectionGroup "Video Filters" SecGrpVideoFilter
@@ -368,7 +433,7 @@
 				SectionIn 1 2
 				SetOverwrite on
 				SetOutPath $INSTDIR\lib\ADM_plugins\videoFilter
-				File ${BUILDDIR}\lib\ADM_plugins\videoFilter\libADM_vf_addborders.dll
+				${File} lib\ADM_plugins\videoFilter\libADM_vf_addborders.dll
 			${MementoSectionEnd}
 			${MementoSection} "Avisynth Resize" SecVidFltAvisynthResize
 				SectionIn 1 2
@@ -377,18 +442,18 @@
 
 				!insertmacro SectionFlagIsSet ${SecUiGtk} ${SF_SELECTED} InstallGtk CheckQt4
 InstallGtk:
-				File ${BUILDDIR}\lib\ADM_plugins\videoFilter\libADM_vf_avisynthResize_gtk.dll
+				${File} lib\ADM_plugins\videoFilter\libADM_vf_avisynthResize_gtk.dll
 CheckQt4:
 				!insertmacro SectionFlagIsSet ${SecUiQt4} ${SF_SELECTED} InstallQt4 End
 InstallQt4:
-				File ${BUILDDIR}\lib\ADM_plugins\videoFilter\libADM_vf_avisynthResize_qt4.dll
+				${File} lib\ADM_plugins\videoFilter\libADM_vf_avisynthResize_qt4.dll
 End:
 			${MementoSectionEnd}
 			${MementoSection} "Blacken Borders" SecVidFltBlackenBorders
 				SectionIn 1 2
 				SetOverwrite on
 				SetOutPath $INSTDIR\lib\ADM_plugins\videoFilter
-				File ${BUILDDIR}\lib\ADM_plugins\videoFilter\libADM_vf_blackenBorders.dll
+				${File} lib\ADM_plugins\videoFilter\libADM_vf_blackenBorders.dll
 			${MementoSectionEnd}
 			${MementoSection} "Crop" SecVidFltCrop
 				SectionIn 1 2
@@ -397,18 +462,18 @@
 
 				!insertmacro SectionFlagIsSet ${SecUiGtk} ${SF_SELECTED} InstallGtk CheckQt4
 InstallGtk:
-				File ${BUILDDIR}\lib\ADM_plugins\videoFilter\libADM_vf_Crop_gtk.dll
+				${File} lib\ADM_plugins\videoFilter\libADM_vf_Crop_gtk.dll
 CheckQt4:
 				!insertmacro SectionFlagIsSet ${SecUiQt4} ${SF_SELECTED} InstallQt4 End
 InstallQt4:
-				File ${BUILDDIR}\lib\ADM_plugins\videoFilter\libADM_vf_crop_qt4.dll
+				${File} lib\ADM_plugins\videoFilter\libADM_vf_crop_qt4.dll
 End:
 			${MementoSectionEnd}
 			${MementoSection} "Fade" SecVidFltFade
 				SectionIn 1 2
 				SetOverwrite on
 				SetOutPath $INSTDIR\lib\ADM_plugins\videoFilter
-				File ${BUILDDIR}\lib\ADM_plugins\videoFilter\libADM_vf_fade.dll
+				${File} lib\ADM_plugins\videoFilter\libADM_vf_fade.dll
 			${MementoSectionEnd}
 			${MementoSection} "MPlayer Resize" SecVidFltMplayerResize
 				SectionIn 1 2
@@ -417,36 +482,36 @@
 
 				!insertmacro SectionFlagIsSet ${SecUiGtk} ${SF_SELECTED} InstallGtk CheckQt4
 InstallGtk:
-				File ${BUILDDIR}\lib\ADM_plugins\videoFilter\libADM_vf_mplayerResize_gtk.dll
+				${File} lib\ADM_plugins\videoFilter\libADM_vf_mplayerResize_gtk.dll
 CheckQt4:
 				!insertmacro SectionFlagIsSet ${SecUiQt4} ${SF_SELECTED} InstallQt4 End
 InstallQt4:
-				File ${BUILDDIR}\lib\ADM_plugins\videoFilter\libADM_vf_mplayerResize_qt4.dll
+				${File} lib\ADM_plugins\videoFilter\libADM_vf_mplayerResize_qt4.dll
 End:
 			${MementoSectionEnd}
 			${MementoSection} "Resample FPS" SecVidFltResampleFps
 				SectionIn 1 2
 				SetOverwrite on
 				SetOutPath $INSTDIR\lib\ADM_plugins\videoFilter
-				File ${BUILDDIR}\lib\ADM_plugins\videoFilter\libADM_vf_resampleFps.dll
+				${File} lib\ADM_plugins\videoFilter\libADM_vf_resampleFps.dll
 			${MementoSectionEnd}
 			${MementoSection} "Reverse" SecVidFltReverse
 				SectionIn 1 2
 				SetOverwrite on
 				SetOutPath $INSTDIR\lib\ADM_plugins\videoFilter
-				File ${BUILDDIR}\lib\ADM_plugins\videoFilter\libADM_vf_reverse.dll
+				${File} lib\ADM_plugins\videoFilter\libADM_vf_reverse.dll
 			${MementoSectionEnd}
 			${MementoSection} "Rotate" SecVidFltRotate
 				SectionIn 1 2
 				SetOverwrite on
 				SetOutPath $INSTDIR\lib\ADM_plugins\videoFilter
-				File ${BUILDDIR}\lib\ADM_plugins\videoFilter\libADM_vf_rotate.dll
+				${File} lib\ADM_plugins\videoFilter\libADM_vf_rotate.dll
 			${MementoSectionEnd}
 			${MementoSection} "Vertical Flip" SecVidFltVerticalFlip
 				SectionIn 1 2
 				SetOverwrite on
 				SetOutPath $INSTDIR\lib\ADM_plugins\videoFilter
-				File ${BUILDDIR}\lib\ADM_plugins\videoFilter\libADM_vf_vflip.dll
+				${File} lib\ADM_plugins\videoFilter\libADM_vf_vflip.dll
 			${MementoSectionEnd}
 		SectionGroupEnd
 		SectionGroup "Interlacing Filters" SecGrpVideoFilterInterlacing
@@ -454,157 +519,157 @@
 				SectionIn 1 2
 				SetOverwrite on
 				SetOutPath $INSTDIR\lib\ADM_plugins\videoFilter
-				File ${BUILDDIR}\lib\ADM_plugins\videoFilter\libADM_vf_decimate.dll
+				${File} lib\ADM_plugins\videoFilter\libADM_vf_decimate.dll
 			${MementoSectionEnd}
 			${MementoSection} "Decomb Telecide" SecVidFltDecombTelecide
 				SectionIn 1 2
 				SetOverwrite on
 				SetOutPath $INSTDIR\lib\ADM_plugins\videoFilter
-				File ${BUILDDIR}\lib\ADM_plugins\videoFilter\libADM_vf_telecide.dll
+				${File} lib\ADM_plugins\videoFilter\libADM_vf_telecide.dll
 			${MementoSectionEnd}
 			${MementoSection} "Deinterlace" SecVidFltDeinterlace
 				SectionIn 1 2
 				SetOverwrite on
 				SetOutPath $INSTDIR\lib\ADM_plugins\videoFilter
-				File ${BUILDDIR}\lib\ADM_plugins\videoFilter\libADM_vf_Deinterlace.dll
+				${File} lib\ADM_plugins\videoFilter\libADM_vf_Deinterlace.dll
 			${MementoSectionEnd}
 			${MementoSection} "DG Bob" SecVidFltDbGob
 				SectionIn 1 2
 				SetOverwrite on
 				SetOutPath $INSTDIR\lib\ADM_plugins\videoFilter
-				File ${BUILDDIR}\lib\ADM_plugins\videoFilter\libADM_vf_blendDgBob.dll
+				${File} lib\ADM_plugins\videoFilter\libADM_vf_blendDgBob.dll
 			${MementoSectionEnd}
 			${MementoSection} "Drop" SecVidFltDrop
 				SectionIn 1 2
 				SetOverwrite on
 				SetOutPath $INSTDIR\lib\ADM_plugins\videoFilter
-				File ${BUILDDIR}\lib\ADM_plugins\videoFilter\libADM_vf_dropOut.dll
+				${File} lib\ADM_plugins\videoFilter\libADM_vf_dropOut.dll
 			${MementoSectionEnd}
 			${MementoSection} "Fade" SecVidFltFadeInterlace
 				SectionIn 1 2
 				SetOverwrite on
 				SetOutPath $INSTDIR\lib\ADM_plugins\videoFilter
-				File ${BUILDDIR}\lib\ADM_plugins\videoFilter\libADM_vf_separateField.dll
+				${File} lib\ADM_plugins\videoFilter\libADM_vf_separateField.dll
 			${MementoSectionEnd}
 			${MementoSection} "Gauss Smooth" SecVidFltGaussSmooth
 				SectionIn 1 2
 				SetOverwrite on
 				SetOutPath $INSTDIR\lib\ADM_plugins\videoFilter
-				File ${BUILDDIR}\lib\ADM_plugins\videoFilter\libADM_vf_fastconvolutiongauss.dll
+				${File} lib\ADM_plugins\videoFilter\libADM_vf_fastconvolutiongauss.dll
 			${MementoSectionEnd}
 			${MementoSection} "Keep Even Fields" SecVidFltKeepEvenFields
 				SectionIn 1 2
 				SetOverwrite on
 				SetOutPath $INSTDIR\lib\ADM_plugins\videoFilter
-				File ${BUILDDIR}\lib\ADM_plugins\videoFilter\libADM_vf_keepEvenField.dll
+				${File} lib\ADM_plugins\videoFilter\libADM_vf_keepEvenField.dll
 			${MementoSectionEnd}
 			${MementoSection} "Keep Odd Fields" SecVidFltKeepOddFields
 				SectionIn 1 2
 				SetOverwrite on
 				SetOutPath $INSTDIR\lib\ADM_plugins\videoFilter
-				File ${BUILDDIR}\lib\ADM_plugins\videoFilter\libADM_vf_keepOddField.dll
+				${File} lib\ADM_plugins\videoFilter\libADM_vf_keepOddField.dll
 			${MementoSectionEnd}
 			${MementoSection} "KernelDeint" SecVidFltKernelDeint
 				SectionIn 1 2
 				SetOverwrite on
 				SetOutPath $INSTDIR\lib\ADM_plugins\videoFilter
-				File ${BUILDDIR}\lib\ADM_plugins\videoFilter\libADM_vf_kernelDeint.dll
+				${File} lib\ADM_plugins\videoFilter\libADM_vf_kernelDeint.dll
 			${MementoSectionEnd}
 			${MementoSection} "libavcodec Deinterlacer" SecVidFltLavDeinterlacer
 				SectionIn 1 2
 				SetOverwrite on
 				SetOutPath $INSTDIR\lib\ADM_plugins\videoFilter
-				File ${BUILDDIR}\lib\ADM_plugins\videoFilter\libADM_vf_lavDeinterlace.dll
+				${File} lib\ADM_plugins\videoFilter\libADM_vf_lavDeinterlace.dll
 			${MementoSectionEnd}
 			${MementoSection} "mcDeint" SecVidFltMcDeint
 				SectionIn 1 2
 				SetOverwrite on
 				SetOutPath $INSTDIR\lib\ADM_plugins\videoFilter
-				File ${BUILDDIR}\lib\ADM_plugins\videoFilter\libADM_vf_mcdeint.dll
+				${File} lib\ADM_plugins\videoFilter\libADM_vf_mcdeint.dll
 			${MementoSectionEnd}
 			${MementoSection} "Mean" SecVidFltMean
 				SectionIn 1 2
 				SetOverwrite on
 				SetOutPath $INSTDIR\lib\ADM_plugins\videoFilter
-				File ${BUILDDIR}\lib\ADM_plugins\videoFilter\libADM_vf_fastconvolutionmean.dll
+				${File} lib\ADM_plugins\videoFilter\libADM_vf_fastconvolutionmean.dll
 			${MementoSectionEnd}
 			${MementoSection} "Median" SecVidFltMedian
 				SectionIn 1 2
 				SetOverwrite on
 				SetOutPath $INSTDIR\lib\ADM_plugins\videoFilter
-				File ${BUILDDIR}\lib\ADM_plugins\videoFilter\libADM_vf_fastconvolutionmedian.dll
+				${File} lib\ADM_plugins\videoFilter\libADM_vf_fastconvolutionmedian.dll
 			${MementoSectionEnd}
 			${MementoSection} "Merge Fields" SecVidFltMergeFields
 				SectionIn 1 2
 				SetOverwrite on
 				SetOutPath $INSTDIR\lib\ADM_plugins\videoFilter
-				File ${BUILDDIR}\lib\ADM_plugins\videoFilter\libADM_vf_mergeField.dll
+				${File} lib\ADM_plugins\videoFilter\libADM_vf_mergeField.dll
 			${MementoSectionEnd}
 			${MementoSection} "PAL Field Shift" SecVidFltPalFieldShift
 				SectionIn 1 2
 				SetOverwrite on
 				SetOutPath $INSTDIR\lib\ADM_plugins\videoFilter
-				File ${BUILDDIR}\lib\ADM_plugins\videoFilter\libADM_vf_palShift.dll
+				${File} lib\ADM_plugins\videoFilter\libADM_vf_palShift.dll
 			${MementoSectionEnd}
 			${MementoSection} "PAL Smart Field Shift" SecVidFltPalSmartFieldShift
 				SectionIn 1 2
 				SetOverwrite on
 				SetOutPath $INSTDIR\lib\ADM_plugins\videoFilter
-				File ${BUILDDIR}\lib\ADM_plugins\videoFilter\libADM_vf_smartPalShift.dll
+				${File} lib\ADM_plugins\videoFilter\libADM_vf_smartPalShift.dll
 			${MementoSectionEnd}
 			${MementoSection} "Pulldown" SecVidFltPulldown
 				SectionIn 1 2
 				SetOverwrite on
 				SetOutPath $INSTDIR\lib\ADM_plugins\videoFilter
-				File ${BUILDDIR}\lib\ADM_plugins\videoFilter\libADM_vf_Pulldown.dll
+				${File} lib\ADM_plugins\videoFilter\libADM_vf_Pulldown.dll
 			${MementoSectionEnd}
 			${MementoSection} "Separate Fields" SecVidFltSeparateFields
 				SectionIn 1 2
 				SetOverwrite on
 				SetOutPath $INSTDIR\lib\ADM_plugins\videoFilter
-				File ${BUILDDIR}\lib\ADM_plugins\videoFilter\libADM_vf_hzStackField.dll
+				${File} lib\ADM_plugins\videoFilter\libADM_vf_hzStackField.dll
 			${MementoSectionEnd}
 			${MementoSection} "Sharpen" SecVidFltSharpen
 				SectionIn 1 2
 				SetOverwrite on
 				SetOutPath $INSTDIR\lib\ADM_plugins\videoFilter
-				File ${BUILDDIR}\lib\ADM_plugins\videoFilter\libADM_vf_fastconvolutionsharpen.dll
+				${File} lib\ADM_plugins\videoFilter\libADM_vf_fastconvolutionsharpen.dll
 			${MementoSectionEnd}
 			${MementoSection} "Smart Swap Fields" SecVidFltSmartSwapFields
 				SectionIn 1 2
 				SetOverwrite on
 				SetOutPath $INSTDIR\lib\ADM_plugins\videoFilter
-				File ${BUILDDIR}\lib\ADM_plugins\videoFilter\libADM_vf_smartSwapField.dll
+				${File} lib\ADM_plugins\videoFilter\libADM_vf_smartSwapField.dll
 			${MementoSectionEnd}
 			${MementoSection} "Stack Fields" SecVidFltStackFields
 				SectionIn 1 2
 				SetOverwrite on
 				SetOutPath $INSTDIR\lib\ADM_plugins\videoFilter
-				File ${BUILDDIR}\lib\ADM_plugins\videoFilter\libADM_vf_stackField.dll
+				${File} lib\ADM_plugins\videoFilter\libADM_vf_stackField.dll
 			${MementoSectionEnd}
 			${MementoSection} "Swap Fields" SecVidFltSwapFields
 				SectionIn 1 2
 				SetOverwrite on
 				SetOutPath $INSTDIR\lib\ADM_plugins\videoFilter
-				File ${BUILDDIR}\lib\ADM_plugins\videoFilter\libADM_vf_swapField.dll
+				${File} lib\ADM_plugins\videoFilter\libADM_vf_swapField.dll
 			${MementoSectionEnd}
 			${MementoSection} "TDeint" SecVidFltTDeint
 				SectionIn 1 2
 				SetOverwrite on
 				SetOutPath $INSTDIR\lib\ADM_plugins\videoFilter
-				File ${BUILDDIR}\lib\ADM_plugins\videoFilter\libADM_vf_tdeint.dll
+				${File} lib\ADM_plugins\videoFilter\libADM_vf_tdeint.dll
 			${MementoSectionEnd}
 			${MementoSection} "Unstack Fields" SecVidFltUnstackFields
 				SectionIn 1 2
 				SetOverwrite on
 				SetOutPath $INSTDIR\lib\ADM_plugins\videoFilter
-				File ${BUILDDIR}\lib\ADM_plugins\videoFilter\libADM_vf_unstackField.dll
+				${File} lib\ADM_plugins\videoFilter\libADM_vf_unstackField.dll
 			${MementoSectionEnd}
 			${MementoSection} "yadif" SecVidFltYadif
 				SectionIn 1 2
 				SetOverwrite on
 				SetOutPath $INSTDIR\lib\ADM_plugins\videoFilter
-				File ${BUILDDIR}\lib\ADM_plugins\videoFilter\libADM_vf_yadif.dll
+				${File} lib\ADM_plugins\videoFilter\libADM_vf_yadif.dll
 			${MementoSectionEnd}
 		SectionGroupEnd
 		SectionGroup "Colour Filters" SecGrpVideoFilterColour
@@ -615,18 +680,18 @@
 
 				!insertmacro SectionFlagIsSet ${SecUiGtk} ${SF_SELECTED} InstallGtk CheckQt4
 InstallGtk:
-				File ${BUILDDIR}\lib\ADM_plugins\videoFilter\libADM_vf_colorYUV_gtk.dll
+				${File} lib\ADM_plugins\videoFilter\libADM_vf_colorYUV_gtk.dll
 CheckQt4:
 				!insertmacro SectionFlagIsSet ${SecUiQt4} ${SF_SELECTED} InstallQt4 End
 InstallQt4:
-				File ${BUILDDIR}\lib\ADM_plugins\videoFilter\libADM_vf_colorYUV_qt4.dll
+				${File} lib\ADM_plugins\videoFilter\libADM_vf_colorYUV_qt4.dll
 End:
 			${MementoSectionEnd}
 			${MementoSection} "Blend Removal" SecVidFltBlendRemoval
 				SectionIn 1 2
 				SetOverwrite on
 				SetOutPath $INSTDIR\lib\ADM_plugins\videoFilter
-				File ${BUILDDIR}\lib\ADM_plugins\videoFilter\libADM_vf_blendRemoval.dll
+				${File} lib\ADM_plugins\videoFilter\libADM_vf_blendRemoval.dll
 			${MementoSectionEnd}
 			${MementoSection} "Chroma Shift" SecVidFltChromaShift
 				SectionIn 1 2
@@ -635,24 +700,24 @@
 
 				!insertmacro SectionFlagIsSet ${SecUiGtk} ${SF_SELECTED} InstallGtk CheckQt4
 InstallGtk:
-				File ${BUILDDIR}\lib\ADM_plugins\videoFilter\libADM_vf_chromaShift_gtk.dll
+				${File} lib\ADM_plugins\videoFilter\libADM_vf_chromaShift_gtk.dll
 CheckQt4:
 				!insertmacro SectionFlagIsSet ${SecUiQt4} ${SF_SELECTED} InstallQt4 End
 InstallQt4:
-				File ${BUILDDIR}\lib\ADM_plugins\videoFilter\libADM_vf_chromaShift_qt4.dll
+				${File} lib\ADM_plugins\videoFilter\libADM_vf_chromaShift_qt4.dll
 End:
 			${MementoSectionEnd}
 			${MementoSection} "Chroma U" SecVidFltChromaU
 				SectionIn 1 2
 				SetOverwrite on
 				SetOutPath $INSTDIR\lib\ADM_plugins\videoFilter
-				File ${BUILDDIR}\lib\ADM_plugins\videoFilter\libADM_vidChromaU.dll
+				${File} lib\ADM_plugins\videoFilter\libADM_vidChromaU.dll
 			${MementoSectionEnd}
 			${MementoSection} "Chroma V" SecVidFltChromaV
 				SectionIn 1 2
 				SetOverwrite on
 				SetOutPath $INSTDIR\lib\ADM_plugins\videoFilter
-				File ${BUILDDIR}\lib\ADM_plugins\videoFilter\libADM_vidChromaV.dll
+				${File} lib\ADM_plugins\videoFilter\libADM_vidChromaV.dll
 			${MementoSectionEnd}
 			${MementoSection} "Contrast" SecVidFltContrast
 				SectionIn 1 2
@@ -661,18 +726,18 @@
 
 				!insertmacro SectionFlagIsSet ${SecUiGtk} ${SF_SELECTED} InstallGtk CheckQt4
 InstallGtk:
-				File ${BUILDDIR}\lib\ADM_plugins\videoFilter\libADM_vf_contrast_gtk.dll
+				${File} lib\ADM_plugins\videoFilter\libADM_vf_contrast_gtk.dll
 CheckQt4:
 				!insertmacro SectionFlagIsSet ${SecUiQt4} ${SF_SELECTED} InstallQt4 End
 InstallQt4:
-				File ${BUILDDIR}\lib\ADM_plugins\videoFilter\libADM_vf_contrast_qt4.dll
+				${File} lib\ADM_plugins\videoFilter\libADM_vf_contrast_qt4.dll
 End:
 			${MementoSectionEnd}
 			${MementoSection} "Luma Delta" SecVidFltLumaDelta
 				SectionIn 1 2
 				SetOverwrite on
 				SetOutPath $INSTDIR\lib\ADM_plugins\videoFilter
-				File ${BUILDDIR}\lib\ADM_plugins\videoFilter\libADM_vf_Delta.dll
+				${File} lib\ADM_plugins\videoFilter\libADM_vf_Delta.dll
 			${MementoSectionEnd}
 			${MementoSection} "Luma Equaliser" SecVidFltLumaEqualiser
 				SectionIn 1 2
@@ -681,18 +746,18 @@
 
 				!insertmacro SectionFlagIsSet ${SecUiGtk} ${SF_SELECTED} InstallGtk CheckQt4
 InstallGtk:
-				File ${BUILDDIR}\lib\ADM_plugins\videoFilter\libADM_vf_equalizer_gtk.dll
+				${File} lib\ADM_plugins\videoFilter\libADM_vf_equalizer_gtk.dll
 CheckQt4:
 				!insertmacro SectionFlagIsSet ${SecUiQt4} ${SF_SELECTED} InstallQt4 End
 InstallQt4:
-				File ${BUILDDIR}\lib\ADM_plugins\videoFilter\libADM_vf_equalizer_qt4.dll
+				${File} lib\ADM_plugins\videoFilter\libADM_vf_equalizer_qt4.dll
 End:
 			${MementoSectionEnd}
 			${MementoSection} "Luma Only" SecVidFltLumaOnly
 				SectionIn 1 2
 				SetOverwrite on
 				SetOutPath $INSTDIR\lib\ADM_plugins\videoFilter
-				File ${BUILDDIR}\lib\ADM_plugins\videoFilter\libADM_vf_lumaonly.dll
+				${File} lib\ADM_plugins\videoFilter\libADM_vf_lumaonly.dll
 			${MementoSectionEnd}
 			${MementoSection} "Mplayer Eq2" SecVidFltMPlayerEq2
 				SectionIn 1 2
@@ -701,11 +766,11 @@
 
 				!insertmacro SectionFlagIsSet ${SecUiGtk} ${SF_SELECTED} InstallGtk CheckQt4
 InstallGtk:
-				File ${BUILDDIR}\lib\ADM_plugins\videoFilter\libADM_vf_eq2_gtk.dll
+				${File} lib\ADM_plugins\videoFilter\libADM_vf_eq2_gtk.dll
 CheckQt4:
 				!insertmacro SectionFlagIsSet ${SecUiQt4} ${SF_SELECTED} InstallQt4 End
 InstallQt4:
-				File ${BUILDDIR}\lib\ADM_plugins\videoFilter\libADM_vf_eq2_qt4.dll
+				${File} lib\ADM_plugins\videoFilter\libADM_vf_eq2_qt4.dll
 End:
 			${MementoSectionEnd}
 			${MementoSection} "Mplayer Hue" SecVidFltMPlayerHue
@@ -715,18 +780,18 @@
 
 				!insertmacro SectionFlagIsSet ${SecUiGtk} ${SF_SELECTED} InstallGtk CheckQt4
 InstallGtk:
-				File ${BUILDDIR}\lib\ADM_plugins\videoFilter\libADM_vf_hue_gtk.dll
+				${File} lib\ADM_plugins\videoFilter\libADM_vf_hue_gtk.dll
 CheckQt4:
 				!insertmacro SectionFlagIsSet ${SecUiQt4} ${SF_SELECTED} InstallQt4 End
 InstallQt4:
-				File ${BUILDDIR}\lib\ADM_plugins\videoFilter\libADM_vf_hue_qt4.dll
+				${File} lib\ADM_plugins\videoFilter\libADM_vf_hue_qt4.dll
 End:
 			${MementoSectionEnd}
 			${MementoSection} "Swap U and V" SecVidFltSwapUandV
 				SectionIn 1 2
 				SetOverwrite on
 				SetOutPath $INSTDIR\lib\ADM_plugins\videoFilter
-				File ${BUILDDIR}\lib\ADM_plugins\videoFilter\libADM_vf_swapuv.dll
+				${File} lib\ADM_plugins\videoFilter\libADM_vf_swapuv.dll
 			${MementoSectionEnd}
 		SectionGroupEnd
 		SectionGroup "Noise Filters" SecGrpVideoFilterNoise
@@ -737,66 +802,66 @@
 
 				!insertmacro SectionFlagIsSet ${SecUiGtk} ${SF_SELECTED} InstallGtk CheckQt4
 InstallGtk:
-				File ${BUILDDIR}\lib\ADM_plugins\videoFilter\libADM_vf_cnr2_gtk.dll
+				${File} lib\ADM_plugins\videoFilter\libADM_vf_cnr2_gtk.dll
 CheckQt4:
 				!insertmacro SectionFlagIsSet ${SecUiQt4} ${SF_SELECTED} InstallQt4 End
 InstallQt4:
-				File ${BUILDDIR}\lib\ADM_plugins\videoFilter\libADM_vf_cnr2_qt4.dll
+				${File} lib\ADM_plugins\videoFilter\libADM_vf_cnr2_qt4.dll
 End:
 			${MementoSectionEnd}
 			${MementoSection} "Denoise" SecVidFltDenoise
 				SectionIn 1 2
 				SetOverwrite on
 				SetOutPath $INSTDIR\lib\ADM_plugins\videoFilter
-				File ${BUILDDIR}\lib\ADM_plugins\videoFilter\libADM_vf_Denoise.dll
+				${File} lib\ADM_plugins\videoFilter\libADM_vf_Denoise.dll
 			${MementoSectionEnd}
 			${MementoSection} "FluxSmooth" SecVidFltFluxSmooth
 				SectionIn 1 2
 				SetOverwrite on
 				SetOutPath $INSTDIR\lib\ADM_plugins\videoFilter
-				File ${BUILDDIR}\lib\ADM_plugins\videoFilter\libADM_vf_FluxSmooth.dll
+				${File} lib\ADM_plugins\videoFilter\libADM_vf_FluxSmooth.dll
 			${MementoSectionEnd}
 			${MementoSection} "Forced Post-processing" SecVidFltForcedPostProcessing
 				SectionIn 1 2
 				SetOverwrite on
 				SetOutPath $INSTDIR\lib\ADM_plugins\videoFilter
-				File ${BUILDDIR}\lib\ADM_plugins\videoFilter\libADM_vf_forcedPP.dll
+				${File} lib\ADM_plugins\videoFilter\libADM_vf_forcedPP.dll
 			${MementoSectionEnd}
 			${MementoSection} "Light Denoiser" SecVidFltLightDenoiser
 				SectionIn 1 2
 				SetOverwrite on
 				SetOutPath $INSTDIR\lib\ADM_plugins\videoFilter
-				File ${BUILDDIR}\lib\ADM_plugins\videoFilter\libADM_vf_Stabilize.dll
+				${File} lib\ADM_plugins\videoFilter\libADM_vf_Stabilize.dll
 			${MementoSectionEnd}
 			${MementoSection} "Median (5x5)" SecVidFltMediam5x5
 				SectionIn 1 2
 				SetOverwrite on
 				SetOutPath $INSTDIR\lib\ADM_plugins\videoFilter
-				File ${BUILDDIR}\lib\ADM_plugins\videoFilter\libADM_vf_largemedian.dll
+				${File} lib\ADM_plugins\videoFilter\libADM_vf_largemedian.dll
 			${MementoSectionEnd}
 			${MementoSection} "MPlayer Denoise3d" SecVidFltMPlayerDenoise3d
 				SectionIn 1 2
 				SetOverwrite on
 				SetOutPath $INSTDIR\lib\ADM_plugins\videoFilter
-				File ${BUILDDIR}\lib\ADM_plugins\videoFilter\libADM_vf_denoise3d.dll
+				${File} lib\ADM_plugins\videoFilter\libADM_vf_denoise3d.dll
 			${MementoSectionEnd}
 			${MementoSection} "MPlayer Hqdn3d" SecVidFltMPlayerHqdn3d
 				SectionIn 1 2
 				SetOverwrite on
 				SetOutPath $INSTDIR\lib\ADM_plugins\videoFilter
-				File ${BUILDDIR}\lib\ADM_plugins\videoFilter\libADM_vf_denoise3dhq.dll
+				${File} lib\ADM_plugins\videoFilter\libADM_vf_denoise3dhq.dll
 			${MementoSectionEnd}
 			${MementoSection} "Temporal Cleaner" SecVidFltTemporalCleaner
 				SectionIn 1 2
 				SetOverwrite on
 				SetOutPath $INSTDIR\lib\ADM_plugins\videoFilter
-				File ${BUILDDIR}\lib\ADM_plugins\videoFilter\libADM_vf_vlad.dll
+				${File} lib\ADM_plugins\videoFilter\libADM_vf_vlad.dll
 			${MementoSectionEnd}
 			${MementoSection} "TIsophote" SecVidFltTisophote
 				SectionIn 1 2
 				SetOverwrite on
 				SetOutPath $INSTDIR\lib\ADM_plugins\videoFilter
-				File ${BUILDDIR}\lib\ADM_plugins\videoFilter\libADM_vf_Tisophote.dll
+				${File} lib\ADM_plugins\videoFilter\libADM_vf_Tisophote.dll
 			${MementoSectionEnd}
 		SectionGroupEnd
 		SectionGroup "Sharpness Filters" SecGrpVideoFilterSharpness
@@ -807,30 +872,30 @@
 
 				!insertmacro SectionFlagIsSet ${SecUiGtk} ${SF_SELECTED} InstallGtk CheckQt4
 InstallGtk:
-				File ${BUILDDIR}\lib\ADM_plugins\videoFilter\libADM_vf_asharp_gtk.dll
+				${File} lib\ADM_plugins\videoFilter\libADM_vf_asharp_gtk.dll
 CheckQt4:
 				!insertmacro SectionFlagIsSet ${SecUiQt4} ${SF_SELECTED} InstallQt4 End
 InstallQt4:
-				File ${BUILDDIR}\lib\ADM_plugins\videoFilter\libADM_vf_asharp_qt4.dll
+				${File} lib\ADM_plugins\videoFilter\libADM_vf_asharp_qt4.dll
 End:
 			${MementoSectionEnd}
 			${MementoSection} "MSharpen" SecVidFltMSharpen
 				SectionIn 1 2
 				SetOverwrite on
 				SetOutPath $INSTDIR\lib\ADM_plugins\videoFilter
-				File ${BUILDDIR}\lib\ADM_plugins\videoFilter\libADM_vf_mSharpen.dll
+				${File} lib\ADM_plugins\videoFilter\libADM_vf_mSharpen.dll
 			${MementoSectionEnd}
 			${MementoSection} "MSmooth" SecVidFltMSmooth
 				SectionIn 1 2
 				SetOverwrite on
 				SetOutPath $INSTDIR\lib\ADM_plugins\videoFilter
-				File ${BUILDDIR}\lib\ADM_plugins\videoFilter\libADM_vf_mSmooth.dll
+				${File} lib\ADM_plugins\videoFilter\libADM_vf_mSmooth.dll
 			${MementoSectionEnd}
 			${MementoSection} "Soften" SecVidFltSoften
 				SectionIn 1 2
 				SetOverwrite on
 				SetOutPath $INSTDIR\lib\ADM_plugins\videoFilter
-				File ${BUILDDIR}\lib\ADM_plugins\videoFilter\libADM_vf_soften.dll
+				${File} lib\ADM_plugins\videoFilter\libADM_vf_soften.dll
 			${MementoSectionEnd}
 		SectionGroupEnd
 		SectionGroup "Subtitle Filters" SecGrpVideoFilterSubtitle
@@ -838,7 +903,7 @@
 				SectionIn 1 2
 				SetOverwrite on
 				SetOutPath $INSTDIR\lib\ADM_plugins\videoFilter
-				File ${BUILDDIR}\lib\ADM_plugins\videoFilter\libADM_vf_ssa.dll
+				${File} lib\ADM_plugins\videoFilter\libADM_vf_ssa.dll
 			${MementoSectionEnd}
 			${MementoSection} "Subtitler" SecVidFltSubtitler
 				SectionIn 1 2
@@ -847,11 +912,11 @@
 
 				!insertmacro SectionFlagIsSet ${SecUiGtk} ${SF_SELECTED} InstallGtk CheckQt4
 InstallGtk:
-				File ${BUILDDIR}\lib\ADM_plugins\videoFilter\libADM_vf_sub_gtk.dll
+				${File} lib\ADM_plugins\videoFilter\libADM_vf_sub_gtk.dll
 CheckQt4:
 				!insertmacro SectionFlagIsSet ${SecUiQt4} ${SF_SELECTED} InstallQt4 End
 InstallQt4:
-				File ${BUILDDIR}\lib\ADM_plugins\videoFilter\libADM_vf_sub_qt4.dll
+				${File} lib\ADM_plugins\videoFilter\libADM_vf_sub_qt4.dll
 End:
 			${MementoSectionEnd}
 		SectionGroupEnd
@@ -860,7 +925,7 @@
 				SectionIn 1 2
 				SetOverwrite on
 				SetOutPath $INSTDIR\lib\ADM_plugins\videoFilter
-				File ${BUILDDIR}\lib\ADM_plugins\videoFilter\libADM_vf_Mosaic.dll
+				${File} lib\ADM_plugins\videoFilter\libADM_vf_Mosaic.dll
 			${MementoSectionEnd}
 			${MementoSection} "MPlayer Delogo" SecVidFltMPlayerDelogo
 				SectionIn 1 2
@@ -869,18 +934,18 @@
 
 				!insertmacro SectionFlagIsSet ${SecUiGtk} ${SF_SELECTED} InstallGtk CheckQt4
 InstallGtk:
-				File ${BUILDDIR}\lib\ADM_plugins\videoFilter\libADM_vf_mpdelogo_gtk.dll
+				${File} lib\ADM_plugins\videoFilter\libADM_vf_mpdelogo_gtk.dll
 CheckQt4:
 				!insertmacro SectionFlagIsSet ${SecUiQt4} ${SF_SELECTED} InstallQt4 End
 InstallQt4:
-				File ${BUILDDIR}\lib\ADM_plugins\videoFilter\libADM_vf_mpdelogo_qt4.dll
+				${File} lib\ADM_plugins\videoFilter\libADM_vf_mpdelogo_qt4.dll
 End:
 			${MementoSectionEnd}
 			${MementoSection} "Whirl" SecVidFltWhirl
 				SectionIn 1 2
 				SetOverwrite on
 				SetOutPath $INSTDIR\lib\ADM_plugins\videoFilter
-				File ${BUILDDIR}\lib\ADM_plugins\videoFilter\libADM_vf_Whirl.dll
+				${File} lib\ADM_plugins\videoFilter\libADM_vf_Whirl.dll
 			${MementoSectionEnd}
 		SectionGroupEnd
 	SectionGroupEnd
@@ -955,8 +1020,8 @@
     SectionIn 2
     SetOutPath $INSTDIR
     SetOverwrite on
-    File /r ${BUILDDIR}\avsproxy.exe
-    File /r ${BUILDDIR}\avsproxy_gui.exe
+    ${File} avsproxy.exe
+    ${File} avsproxy_gui.exe
 ${MementoSectionEnd}
 
 ${MementoSection} "-Start menu Change Log" SecStartMenuChangeLog
@@ -1026,164 +1091,46 @@
     WriteRegDWORD HKLM "${UNINST_REGKEY}" NoRepair 1
 SectionEnd
 
-##########################
-# Uninstaller sections
-##########################
-Section /o "un.AvsProxy" UnSecAvsProxy
-    Delete /REBOOTOK $INSTDIR\avsproxy.exe
-    Delete /REBOOTOK $INSTDIR\avsproxy_gui.exe
+Section -CloseLogFile
+	FileClose $UninstallLogHandle
+	SetFileAttributes ${UninstallLogPath} HIDDEN
 SectionEnd
-
-Section /o un.Catalan UnSecLangCatalan
-	!insertmacro UninstallLanguage Catalan ca
-SectionEnd
-
-Section /o un.Czech UnSecLangCzech
-	!insertmacro UninstallLanguage Czech cs
-SectionEnd
-
-Section /o un.French UnSecLangFrench
-	!insertmacro UninstallLanguage French fr
-SectionEnd
-
-Section /o un.German UnSecLangGerman
-	!insertmacro UninstallLanguage German de
-SectionEnd
-
-Section /o un.Greek UnSecLangGreek
-	!insertmacro UninstallLanguage Greek el
-SectionEnd
-
-Section /o un.Italian UnSecLangItalian
-	!insertmacro UninstallLanguage Italian it
-SectionEnd
-
-Section /o un.Japanese UnSecLangJapanese
-	!insertmacro UninstallLanguage Japanese ja
-SectionEnd
-
-Section /o un.Russian UnSecLangRussian
-	!insertmacro UninstallLanguage Russian ru
-SectionEnd
-
-Section /o un.Serbian UnSecLangSerbianCyrillic
-	!insertmacro UninstallLanguage SerbianCyrillic sr
-SectionEnd
-
-Section /o un.SerbianLatin UnSecLangSerbianLatin
-	!insertmacro UninstallLanguage SerbianLatin sr at latin
-SectionEnd
-
-Section /o un.Spanish UnSecLangSpanish
-	!insertmacro UninstallLanguage Spanish es
-SectionEnd
-
-Section /o un.Turkish UnSecLangTurkish
-	!insertmacro UninstallLanguage Turkish tr
-SectionEnd
-
-Section /o un.GTK+ UnSecUiGtk
-	Delete /REBOOTOK $INSTDIR\libtiff3.dll
-	Delete /REBOOTOK $INSTDIR\libpng12-0.dll
-    Delete /REBOOTOK $INSTDIR\libpangowin32-1.0-0.dll
-    Delete /REBOOTOK $INSTDIR\libpangocairo-1.0-0.dll
-    Delete /REBOOTOK $INSTDIR\libpango-1.0-0.dll
-    Delete /REBOOTOK $INSTDIR\libgio-2.0-0.dll
-    Delete /REBOOTOK $INSTDIR\libglib-2.0-0.dll
-    Delete /REBOOTOK $INSTDIR\libgtk-win32-2.0-0.dll
-    Delete /REBOOTOK $INSTDIR\libgthread-2.0-0.dll
-    Delete /REBOOTOK $INSTDIR\libgobject-2.0-0.dll
-    Delete /REBOOTOK $INSTDIR\libgmodule-2.0-0.dll
-    Delete /REBOOTOK $INSTDIR\libgdk-win32-2.0-0.dll
-    Delete /REBOOTOK $INSTDIR\libgdk_pixbuf-2.0-0.dll
-    Delete /REBOOTOK $INSTDIR\libcairo-2.dll
-    Delete /REBOOTOK $INSTDIR\libatk-1.0-0.dll
-    Delete /REBOOTOK $INSTDIR\jpeg62.dll
-    Delete /REBOOTOK $INSTDIR\gtk2_prefs.exe
-    Delete /REBOOTOK $INSTDIR\avidemux2_gtk.exe
-    RmDir /r /REBOOTOK $INSTDIR\share\themes
-    RmDir /r /REBOOTOK $INSTDIR\lib\gtk-2.0
-    RmDir /r /REBOOTOK $INSTDIR\etc\gtk-2.0
-    RmDir /r /REBOOTOK $INSTDIR\etc\pango
-SectionEnd
-
-Section /o un.Qt4 UnSecUiQt4
-    Delete /REBOOTOK $INSTDIR\QtCore4.dll
-    Delete /REBOOTOK $INSTDIR\mingwm10.dll
-    Delete /REBOOTOK $INSTDIR\avidemux2_qt4.exe
-    Delete /REBOOTOK $INSTDIR\QtGui4.dll
-SectionEnd
-
-Section /o "un.Command line" UnSecUiCli
-    Delete /REBOOTOK $INSTDIR\avidemux2_cli.exe
-SectionEnd
-
-Section /o "un.Core files (required)" UnSecCore
-    Delete /REBOOTOK $INSTDIR\xvidcore.dll
-    Delete /REBOOTOK $INSTDIR\xmltok.dll
-    Delete /REBOOTOK $INSTDIR\vorbisenc.dll
-    Delete /REBOOTOK $INSTDIR\vorbis.dll
-    Delete /REBOOTOK $INSTDIR\SDL.dll
-    Delete /REBOOTOK $INSTDIR\pthreadGC2.dll
-    Delete /REBOOTOK $INSTDIR\ogg.dll
-    Delete /REBOOTOK $INSTDIR\libxml2.dll
-    Delete /REBOOTOK $INSTDIR\libx264-*.dll
-    Delete /REBOOTOK $INSTDIR\libmp3lame-0.dll
-    Delete /REBOOTOK $INSTDIR\libfontconfig-1.dll
-    Delete /REBOOTOK $INSTDIR\libfaad2.dll
-    Delete /REBOOTOK $INSTDIR\libfaac.dll
-    Delete /REBOOTOK $INSTDIR\libexpat-*.dll
-    Delete /REBOOTOK $INSTDIR\libaften.dll
-    Delete /REBOOTOK $INSTDIR\intl.dll
-    Delete /REBOOTOK $INSTDIR\iconv.dll
-    Delete /REBOOTOK $INSTDIR\freetype6.dll
-    Delete /REBOOTOK $INSTDIR\zlib1.dll
-    Delete /REBOOTOK "$INSTDIR\Build Info.txt"
-    Delete /REBOOTOK "$INSTDIR\Change Log.html"
-    Delete /REBOOTOK "$INSTDIR\stdout.txt"
-    Delete /REBOOTOK "$INSTDIR\stderr.txt"
-    RmDir /r /REBOOTOK $INSTDIR\etc\fonts
-
-    RmDir /REBOOTOK $INSTDIR\share\gettext
-    RmDir /REBOOTOK $INSTDIR\share
-SectionEnd
-
-Section /o "un.Start menu" UnSecStartMenu
-    Delete /REBOOTOK "$SMPROGRAMS\$StartMenuGroup\Change Log.lnk"
+ 
+Section Uninstall
+	!insertmacro MUI_STARTMENU_GETFOLDER Application $StartMenuGroup	
+	
+	Delete /REBOOTOK "$QUICKLAUNCH\${INTERNALNAME} GTK+.lnk"
+    Delete /REBOOTOK "$QUICKLAUNCH\${INTERNALNAME} Qt4.lnk"
+    Delete /REBOOTOK "$DESKTOP\${INTERNALNAME} GTK+.lnk"
+    Delete /REBOOTOK "$DESKTOP\${INTERNALNAME} Qt4.lnk"
+	Delete /REBOOTOK "$SMPROGRAMS\$StartMenuGroup\Change Log.lnk"
     Delete /REBOOTOK "$SMPROGRAMS\$StartMenuGroup\${INTERNALNAME} GTK+.lnk"
     Delete /REBOOTOK "$SMPROGRAMS\$StartMenuGroup\${INTERNALNAME} Qt4.lnk"
     Delete /REBOOTOK "$SMPROGRAMS\$StartMenuGroup\AVS Proxy GUI.lnk"
-SectionEnd
-
-Section /o "un.Quick Launch" UnSecQuickLaunch
-    Delete /REBOOTOK "$QUICKLAUNCH\${INTERNALNAME} GTK+.lnk"
-    Delete /REBOOTOK "$QUICKLAUNCH\${INTERNALNAME} Qt4.lnk"
-SectionEnd
-
-Section /o "un.Desktop" UnSecDesktop
-    Delete /REBOOTOK "$DESKTOP\${INTERNALNAME} GTK+.lnk"
-    Delete /REBOOTOK "$DESKTOP\${INTERNALNAME} Qt4.lnk"
-SectionEnd
-
-Section un.post UnSecUninstaller
-    RmDir /REBOOTOK $INSTDIR\etc
-    RmDir /REBOOTOK $INSTDIR\i18n
-    RmDir /REBOOTOK $INSTDIR\lib
-    RmDir /REBOOTOK $INSTDIR\share\locale
-    RmDir /REBOOTOK $INSTDIR\share
+    RmDir /REBOOTOK $SMPROGRAMS\$StartMenuGroup
+    DeleteRegValue HKLM "${REGKEY}" StartMenuGroup
     
     DeleteRegKey HKLM "${UNINST_REGKEY}"
-    Delete /REBOOTOK $INSTDIR\uninstall.exe
-    DeleteRegValue HKLM "${REGKEY}" StartMenuGroup
     DeleteRegValue HKLM "${REGKEY}" Path
     DeleteRegKey /IfEmpty HKLM "${REGKEY}"
-    RmDir /REBOOTOK $SMPROGRAMS\$StartMenuGroup
-    RmDir /REBOOTOK $INSTDIR
-    Push $R0
-    StrCpy $R0 $StartMenuGroup 1
-    StrCmp $R0 ">" no_smgroup
-no_smgroup:
+
+	FileOpen $UninstallLogHandle "${UninstallLogPath}" r
+UninstallLoop:
+    ClearErrors
+    FileRead $UninstallLogHandle $R0
+    IfErrors UninstallEnd
+	Push $R0
+    Call un.TrimNewLines
     Pop $R0
+    Delete "$R0"
+    Goto UninstallLoop
+UninstallEnd:
+	FileClose $UninstallLogHandle
+	Delete "${UninstallLogPath}"
+	Delete "$INSTDIR\uninstall.exe"
+	Push "\"
+	Call un.RemoveEmptyDirs
+	RMDir "$INSTDIR"
 SectionEnd
 
 ##########################
@@ -1204,6 +1151,7 @@
     InitPluginsDir
 
     ${MementoSectionRestore}
+    SetShellVarContext all
 	!insertmacro MUI_STARTMENU_GETFOLDER Application $StartMenuGroup
 
 #checkStartMenuGtk:
@@ -1397,7 +1345,7 @@
     IntOp $0 $0 & ${SF_SELECTED}
 
     StrCmp $0 ${SF_SELECTED} 0 End
-        Exec "$INSTDIR\avidemux2_gtk.exe"    
+        Exec "$INSTDIR\avidemux2_gtk.exe"
 
 end:
 FunctionEnd
@@ -1406,6 +1354,58 @@
 # Uninstaller functions
 ##########################
 Function un.onInit
-    ReadRegStr $INSTDIR HKLM "${REGKEY}" Path
-    !insertmacro MUI_STARTMENU_GETFOLDER Application $StartMenuGroup
+	!insertmacro MUI_STARTMENU_GETFOLDER Application $StartMenuGroup
+	SetShellVarContext all
 FunctionEnd
+
+; TrimNewlines (copied from NSIS documentation)
+; input, top of stack  (e.g. whatever$\r$\n)
+; output, top of stack (replaces, with e.g. whatever)
+; modifies no other variables.
+Function un.TrimNewlines
+	Exch $R0
+	Push $R1
+	Push $R2
+	StrCpy $R1 0
+
+loop:
+	IntOp $R1 $R1 - 1
+	StrCpy $R2 $R0 1 $R1
+	StrCmp $R2 "$\r" loop
+	StrCmp $R2 "$\n" loop
+	IntOp $R1 $R1 + 1
+	IntCmp $R1 0 no_trim_needed
+	StrCpy $R0 $R0 $R1
+
+no_trim_needed:
+	Pop $R2
+	Pop $R1
+	Exch $R0
+FunctionEnd
+ 
+Function un.RemoveEmptyDirs
+	Pop $9
+	!define Index 'Line${__LINE__}'
+	FindFirst $0 $1 "$INSTDIR$9*"
+	StrCmp $0 "" "${Index}-End"
+"${Index}-Loop:"
+	StrCmp $1 "" "${Index}-End"
+	StrCmp $1 "." "${Index}-Next"
+	StrCmp $1 ".." "${Index}-Next"
+	Push $0
+	Push $1
+	Push $9
+	Push "$9$1\"
+	Call un.RemoveEmptyDirs
+	Pop $9
+	Pop $1
+	Pop $0
+;"${Index}-Remove:"
+	RMDir "$INSTDIR$9$1"
+"${Index}-Next:"
+	FindNext $0 $1
+	Goto "${Index}-Loop"
+"${Index}-End:"
+	FindClose $0
+	!undef Index
+FunctionEnd



From mean at mail.berlios.de  Wed Feb 11 07:27:29 2009
From: mean at mail.berlios.de (mean at BerliOS)
Date: Wed, 11 Feb 2009 07:27:29 +0100
Subject: [Avidemux-svn-commit] r4583 - in branches/avidemux_2.6_branch_mean:
	avidemux avidemux/ADM_coreDemuxerMpeg/include
	avidemux/ADM_coreDemuxerMpeg/src plugins/ADM_demuxers/MpegPS
Message-ID: <200902110627.n1B6RSOe007835@sheep.berlios.de>

Author: mean
Date: 2009-02-11 07:27:26 +0100 (Wed, 11 Feb 2009)
New Revision: 4583

Added:
   branches/avidemux_2.6_branch_mean/avidemux/ADM_coreDemuxerMpeg/include/ADM_indexFile.h
   branches/avidemux_2.6_branch_mean/avidemux/ADM_coreDemuxerMpeg/include/dmxPSPacket.h
   branches/avidemux_2.6_branch_mean/avidemux/ADM_coreDemuxerMpeg/src/ADM_indexFile.cpp
   branches/avidemux_2.6_branch_mean/avidemux/ADM_coreDemuxerMpeg/src/dmxPSPacket.cpp
Removed:
   branches/avidemux_2.6_branch_mean/avidemux/ADM_coreDemuxerMpeg/src/dmx_demuxer.cpp
   branches/avidemux_2.6_branch_mean/avidemux/ADM_coreDemuxerMpeg/src/dmx_demuxerES.cpp
   branches/avidemux_2.6_branch_mean/avidemux/ADM_coreDemuxerMpeg/src/dmx_demuxerMSDVR.cpp
   branches/avidemux_2.6_branch_mean/avidemux/ADM_coreDemuxerMpeg/src/dmx_demuxerPS.cpp
   branches/avidemux_2.6_branch_mean/avidemux/ADM_coreDemuxerMpeg/src/dmx_demuxerTS.cpp
   branches/avidemux_2.6_branch_mean/plugins/ADM_demuxers/MpegPS/ADM_indexFile.cpp
   branches/avidemux_2.6_branch_mean/plugins/ADM_demuxers/MpegPS/ADM_indexFile.h
   branches/avidemux_2.6_branch_mean/plugins/ADM_demuxers/MpegPS/dmxPSPacket.cpp
   branches/avidemux_2.6_branch_mean/plugins/ADM_demuxers/MpegPS/dmxPSPacket.h
   branches/avidemux_2.6_branch_mean/plugins/ADM_demuxers/MpegPS/dmx_io.cpp
   branches/avidemux_2.6_branch_mean/plugins/ADM_demuxers/MpegPS/dmx_io.h
   branches/avidemux_2.6_branch_mean/plugins/ADM_demuxers/MpegPS/dmx_mpegstartcode.h
Modified:
   branches/avidemux_2.6_branch_mean/avidemux/ADM_coreDemuxerMpeg/include/dmx_io.h
   branches/avidemux_2.6_branch_mean/avidemux/ADM_coreDemuxerMpeg/include/dmx_mpegstartcode.h
   branches/avidemux_2.6_branch_mean/avidemux/ADM_coreDemuxerMpeg/src/CMakeLists.txt
   branches/avidemux_2.6_branch_mean/avidemux/ADM_coreDemuxerMpeg/src/dmx_io.cpp
   branches/avidemux_2.6_branch_mean/avidemux/CMakeLists.txt
   branches/avidemux_2.6_branch_mean/plugins/ADM_demuxers/MpegPS/CMakeLists.txt
Log:
[Mpeg] Factorize mpeg/mpegps related code in codeDemuxerMpeg

Copied: branches/avidemux_2.6_branch_mean/avidemux/ADM_coreDemuxerMpeg/include/ADM_indexFile.h (from rev 4578, branches/avidemux_2.6_branch_mean/plugins/ADM_demuxers/MpegPS/ADM_indexFile.h)
===================================================================
--- branches/avidemux_2.6_branch_mean/plugins/ADM_demuxers/MpegPS/ADM_indexFile.h	2009-02-07 14:34:30 UTC (rev 4578)
+++ branches/avidemux_2.6_branch_mean/avidemux/ADM_coreDemuxerMpeg/include/ADM_indexFile.h	2009-02-11 06:27:26 UTC (rev 4583)
@@ -0,0 +1,74 @@
+/**
+    \file ADM_indexFile
+    \brief Handle index file reading
+    copyright            : (C) 2009 by mean
+    email                : fixounet at free.fr
+        
+ ***************************************************************************/
+
+/***************************************************************************
+ *                                                                         *
+ *   This program is free software; you can redistribute it and/or modify  *
+ *   it under the terms of the GNU General Public License as published by  *
+ *   the Free Software Foundation; either version 2 of the License, or     *
+ *   (at your option) any later version.                                   *
+ *                                                                         *
+ ***************************************************************************/
+
+#ifndef ADM_INDEXFILE_H
+#define ADM_INDEXFILE_H
+#include <vector>
+/**
+    \class indexFile
+    \brief Read a index file easily
+*/
+#define ADM_INDEX_BUFFER (20*1024)
+/**
+    \class dmxToken
+*/
+class dmxToken
+{
+protected:
+    char *name;
+    char *value;
+    FILE *file;
+    void  purgeTokens(void);
+public:
+    
+    dmxToken(const char *name,const char *value);
+    ~dmxToken();
+    char *getName(void);
+    char *getValue(void);
+    bool  isNumeric(void);
+    uint32_t getAsNumber(void);
+};
+
+/**
+    \class indexFile
+*/
+
+class indexFile
+{
+protected:
+    uint8_t         buffer[ADM_INDEX_BUFFER];
+    dmxToken        *searchToken(const char *name);
+    void            purgeTokens(void);
+
+    FILE            *file;
+    std::vector <dmxToken *> ListOfTokens;
+public:
+
+        indexFile();
+        ~indexFile();
+    bool open(const char *name);
+    bool close(void);
+    bool goToSection(const char *section);
+    bool readSection(const char *section);
+    uint32_t getAsUint32(const char *token);
+    uint32_t getAsHex(const char *token);
+    char *getAsString(const char *token);
+    bool  readString(uint32_t maxLen,uint8_t *buffer);
+
+};
+
+#endif
\ No newline at end of file

Copied: branches/avidemux_2.6_branch_mean/avidemux/ADM_coreDemuxerMpeg/include/dmxPSPacket.h (from rev 4578, branches/avidemux_2.6_branch_mean/plugins/ADM_demuxers/MpegPS/dmxPSPacket.h)
===================================================================
--- branches/avidemux_2.6_branch_mean/plugins/ADM_demuxers/MpegPS/dmxPSPacket.h	2009-02-07 14:34:30 UTC (rev 4578)
+++ branches/avidemux_2.6_branch_mean/avidemux/ADM_coreDemuxerMpeg/include/dmxPSPacket.h	2009-02-11 06:27:26 UTC (rev 4583)
@@ -0,0 +1,112 @@
+/**
+    dmxPSPacket.cpp
+
+*/
+
+#ifndef DMXPSPACKET_H
+#define DMXPSPACKET_H
+
+#include "dmx_io.h"
+#include "ADM_Video.h"
+
+/**
+    \struct psPacketInfo
+
+*/
+typedef struct
+{
+    uint64_t pts;
+    uint64_t dts;
+    uint64_t startAt;
+    uint32_t offset;
+
+}psPacketInfo;
+
+/**
+    \class psPacket
+*/
+class psPacket
+{
+protected:
+    int         doNoComplainAnyMore;
+    fileParser  *_file;
+    uint64_t    _size;
+    uint8_t     getPacketInfo(uint8_t stream,uint8_t *substream,uint32_t *olen,uint64_t *opts,uint64_t *odts);
+public:
+                psPacket(void);
+                ~psPacket();
+    bool        open(const char *filenames,bool dontappend);
+    bool        close(void);
+    virtual bool        getPacket(uint32_t maxSize, uint8_t *pid, uint32_t *packetSize,uint64_t *pts,uint64_t *dts,uint8_t *buffer,uint64_t *startAt);
+    virtual bool        getPacketOfType(uint8_t pid,uint32_t maxSize, uint32_t *packetSize,uint64_t *pts,uint64_t *dts,uint8_t *buffer,uint64_t *startAt);
+    uint64_t    getPos(void);
+    bool        setPos(uint64_t pos);
+    uint64_t    getSize(void) { return _file->getSize();}
+};
+/**
+    \class psPacketLinear
+*/
+#define ADM_PACKET_LINEAR 10*1024
+
+class psPacketLinear : public psPacket
+{
+protected:
+        uint8_t  myPid;
+        uint64_t startAt;
+        uint32_t bufferLen;
+        uint64_t bufferPts;
+        uint64_t bufferDts;
+        uint32_t bufferIndex;
+        uint8_t  buffer[ADM_PACKET_LINEAR];
+        bool     eof;
+        bool     refill(void);
+        uint64_t oldStartAt;
+        uint32_t oldBufferLen;
+        uint64_t oldBufferPts;
+        uint64_t oldBufferDts;
+        uint32_t consumed;
+
+public:
+                psPacketLinear(uint8_t pid);
+                ~psPacketLinear();
+        uint32_t getConsumed(void);
+        uint8_t  readi8();
+        uint16_t readi16();
+        uint32_t readi32();
+        bool     sync(uint8_t *pid);
+        bool    read(uint32_t len, uint8_t *buffer);
+        bool    forward(uint32_t v);
+        bool    stillOk(void) {return !eof;};
+        bool    getInfo(psPacketInfo *info);
+        bool    seek(uint64_t packetStart, uint32_t offset);
+        bool    changePid(uint32_t pid) ;
+};
+/**
+    \class psPacketLinearTracker
+*/
+typedef struct
+{
+    uint32_t count;
+    uint32_t size;
+    
+    uint64_t startAt;
+    uint32_t startCount;
+    uint32_t startSize;
+    uint64_t startDts;
+}packetStats;
+
+class psPacketLinearTracker : public psPacketLinear
+{
+protected:
+      packetStats stats[256];
+
+public:
+                        psPacketLinearTracker(uint8_t pid);
+                        ~psPacketLinearTracker();
+         packetStats    *getStat(int intdex);
+         bool           resetStats(void);
+virtual  bool           getPacketOfType(uint8_t pid,uint32_t maxSize, uint32_t *packetSize,uint64_t *pts,uint64_t *dts,uint8_t *buffer,uint64_t *startAt);
+};
+
+
+#endif
\ No newline at end of file

Modified: branches/avidemux_2.6_branch_mean/avidemux/ADM_coreDemuxerMpeg/include/dmx_io.h
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/ADM_coreDemuxerMpeg/include/dmx_io.h	2009-02-10 16:00:26 UTC (rev 4582)
+++ branches/avidemux_2.6_branch_mean/avidemux/ADM_coreDemuxerMpeg/include/dmx_io.h	2009-02-11 06:27:26 UTC (rev 4583)
@@ -58,6 +58,7 @@
                         uint64_t getSize( void ) ;
                         uint32_t read32(uint32_t l, uint8_t *buffer);
                         uint8_t  end(void) { return _off==_size-1;};
+						void hexDump(uint8_t *buf, int size);
 #ifdef NO_INLINE_FP
                         uint32_t read32i(void );
                         uint16_t read16i(void );

Modified: branches/avidemux_2.6_branch_mean/avidemux/ADM_coreDemuxerMpeg/include/dmx_mpegstartcode.h
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/ADM_coreDemuxerMpeg/include/dmx_mpegstartcode.h	2009-02-10 16:00:26 UTC (rev 4582)
+++ branches/avidemux_2.6_branch_mean/avidemux/ADM_coreDemuxerMpeg/include/dmx_mpegstartcode.h	2009-02-11 06:27:26 UTC (rev 4583)
@@ -13,7 +13,7 @@
 
 #define USER_DATA_START_CODE    0xb2
 #define SYSTEM_START_CODE       0xbb
-#define PADDING_CODE                                            0xbe
+#define PADDING_CODE            0xbe
 #define PRIVATE_STREAM_1        0xbd
 #define PRIVATE_STREAM_2        0xbf
 #define SYSTEM_END_CODE         0xb9

Copied: branches/avidemux_2.6_branch_mean/avidemux/ADM_coreDemuxerMpeg/src/ADM_indexFile.cpp (from rev 4578, branches/avidemux_2.6_branch_mean/plugins/ADM_demuxers/MpegPS/ADM_indexFile.cpp)
===================================================================
--- branches/avidemux_2.6_branch_mean/plugins/ADM_demuxers/MpegPS/ADM_indexFile.cpp	2009-02-07 14:34:30 UTC (rev 4578)
+++ branches/avidemux_2.6_branch_mean/avidemux/ADM_coreDemuxerMpeg/src/ADM_indexFile.cpp	2009-02-11 06:27:26 UTC (rev 4583)
@@ -0,0 +1,238 @@
+/**
+    \file ADM_indexFile
+    \brief Handle index file reading
+    copyright            : (C) 2009 by mean
+    email                : fixounet at free.fr
+        
+ ***************************************************************************/
+
+/***************************************************************************
+ *                                                                         *
+ *   This program is free software; you can redistribute it and/or modify  *
+ *   it under the terms of the GNU General Public License as published by  *
+ *   the Free Software Foundation; either version 2 of the License, or     *
+ *   (at your option) any later version.                                   *
+ *                                                                         *
+ ***************************************************************************/
+#include "ADM_default.h"
+#include "ADM_indexFile.h"
+#include "ctype.h"
+/**
+
+*/
+dmxToken::dmxToken(const char *name,const char *value)
+{
+    this->name=ADM_strdup(name);
+    this->value=ADM_strdup(value);
+}
+/**
+
+*/
+dmxToken::~dmxToken()
+{
+    if(name) ADM_dealloc(name);
+    if(value) ADM_dealloc(value);
+}
+
+char *dmxToken::getName(void) {return name;}
+char *dmxToken::getValue(void){return value;}
+/**
+
+*/
+bool  dmxToken::isNumeric(void)
+{
+bool num=true;
+int l=strlen(value);
+    for(int i=0;i<l;i++)
+    {
+        char v=value[i];
+        if(!isdigit(v)&& v!=0x0a && v!=0x0d) num=false;
+    }
+    return num;
+}   
+/**
+
+*/
+uint32_t dmxToken::getAsNumber(void)
+{
+uint32_t v;
+    v=atoi(value);
+    return v;
+}
+
+//****************************************************************************************
+
+/**
+
+*/
+
+indexFile::indexFile()
+{
+    file=NULL;
+}
+/**
+
+*/
+
+indexFile::~indexFile()
+{
+   close();
+}
+/**
+
+*/
+void  indexFile::purgeTokens(void)
+{
+    while(ListOfTokens.size())
+    {
+        delete ListOfTokens[0];
+        ListOfTokens.erase(ListOfTokens.begin());
+    }
+}
+/**
+
+*/
+dmxToken        *indexFile::searchToken(const char *name)
+{
+    for(int i=0;i<ListOfTokens.size();i++)
+    {
+        dmxToken *tk=ListOfTokens[i];
+        if(!strcasecmp(name,tk->getName())) return tk;
+    }
+    printf("[indexFile] Token %s not found\n",name);
+    return NULL;
+}
+/**
+
+*/
+
+bool indexFile::open(const char *name)
+{
+    file=fopen(name,"rt");
+    if(!file) return false;
+    return true;
+}
+
+/**
+
+*/
+
+bool indexFile::close(void)
+{
+    if(file)
+    {
+        fclose(file);
+        file=NULL;
+    }
+    purgeTokens();
+
+}
+
+/**
+
+*/
+
+bool indexFile::goToSection(const char *section)
+{
+char match[100];
+    sprintf(match,"[%s]\n",section);
+    fseek(file,0,SEEK_SET);
+    while(1)
+    {
+        if(!fgets((char*)buffer,ADM_INDEX_BUFFER,file) )
+        {
+            printf("[indexFile] Cannot find section %s,%s*\n",section,match);
+            return false;
+        }
+        if(!strcasecmp((char*)buffer,match)) return true;
+    }
+    return false;
+}
+
+/**
+    \fn readSection
+*/
+
+bool indexFile::readSection(const char *section)
+{
+    if(false==goToSection(section)) return false;
+    // Until we reach the next section, store all couples name/value into the
+    //
+    while(1)
+    {
+        if(!readString(ADM_INDEX_BUFFER,buffer)) break;
+        if(buffer[0]=='[') break; // end of section
+        // Now search the = and replace it by a zero
+        char *head,*tail;
+        head=(char *)buffer;
+        tail=(char *)buffer;
+        tail=strstr((char *)buffer,"=");
+        if(!tail) 
+        {
+            printf("[psIndexer]Weird line :%s\n",buffer);
+        }
+        *tail=0;
+        tail++;
+        dmxToken *tk=new dmxToken(head,tail);
+        ListOfTokens.push_back(tk);
+
+    }
+    return true;
+}
+
+/**
+
+*/
+
+uint32_t indexFile::getAsUint32(const char *name)
+{
+    dmxToken *token=searchToken(name);
+    if(!token) return 0;
+    if(token->isNumeric()) return token->getAsNumber();
+    printf("[psIndex] token %s is not a digit : %s\n",name,token->getValue());
+    return 0;
+}
+
+/** 
+    \fn getAsHex
+    \read entry as hex
+
+*/
+
+uint32_t indexFile::getAsHex(const char *name)
+{
+    uint32_t v;
+    dmxToken *token=searchToken(name);
+    char *s;
+    if(!token) return 0;
+    s=token->getValue();
+    sscanf(s,"%x",&v);
+    return v;
+}
+
+/**
+
+*/
+
+char *indexFile::getAsString(const char *name)
+{
+    dmxToken *token=searchToken(name);
+    if(!token) return NULL;
+    return token->getValue();
+
+}
+
+/**
+
+*/
+
+bool  indexFile::readString(uint32_t maxLen,uint8_t *buffer)
+{
+    if(!fgets((char *)buffer,maxLen,file)) return false;
+    buffer[maxLen-1]=0;
+    return true;
+}
+
+
+//EOF
+

Modified: branches/avidemux_2.6_branch_mean/avidemux/ADM_coreDemuxerMpeg/src/CMakeLists.txt
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/ADM_coreDemuxerMpeg/src/CMakeLists.txt	2009-02-10 16:00:26 UTC (rev 4582)
+++ branches/avidemux_2.6_branch_mean/avidemux/ADM_coreDemuxerMpeg/src/CMakeLists.txt	2009-02-11 06:27:26 UTC (rev 4583)
@@ -4,12 +4,9 @@
 #
 
 SET(ADMcoreDemuxerMpeg_SRCS
-#dmx_demuxer.cpp
-#dmx_demuxerES.cpp
-#dmx_demuxerMSDVR.cpp
-#dmx_demuxerPS.cpp
-#dmx_demuxerTS.cpp
-#dmx_io.cpp
+ADM_indexFile.cpp
+dmx_io.cpp
+dmxPSPacket.cpp
 )	
 #*************************************************
 ADD_LIBRARY(ADM_coreDemuxerMpeg SHARED ${ADMcoreDemuxerMpeg_SRCS})

Copied: branches/avidemux_2.6_branch_mean/avidemux/ADM_coreDemuxerMpeg/src/dmxPSPacket.cpp (from rev 4578, branches/avidemux_2.6_branch_mean/plugins/ADM_demuxers/MpegPS/dmxPSPacket.cpp)
===================================================================
--- branches/avidemux_2.6_branch_mean/plugins/ADM_demuxers/MpegPS/dmxPSPacket.cpp	2009-02-07 14:34:30 UTC (rev 4578)
+++ branches/avidemux_2.6_branch_mean/avidemux/ADM_coreDemuxerMpeg/src/dmxPSPacket.cpp	2009-02-11 06:27:26 UTC (rev 4583)
@@ -0,0 +1,660 @@
+/**
+    \file dmxPSPacket
+    \brief Packet demuxer for mpeg PS
+    copyright            : (C) 2005-2008 by mean
+    email                : fixounet at free.fr
+        
+ ***************************************************************************/
+
+/***************************************************************************
+ *                                                                         *
+ *   This program is free software; you can redistribute it and/or modify  *
+ *   it under the terms of the GNU General Public License as published by  *
+ *   the Free Software Foundation; either version 2 of the License, or     *
+ *   (at your option) any later version.                                   *
+ *                                                                         *
+ ***************************************************************************/
+#include "ADM_default.h"
+
+#include "dmxPSPacket.h"
+#include "dmx_mpegstartcode.h"
+
+/**
+    \fn psPacket
+    \brief ctor
+*/
+psPacket::psPacket(void)
+{
+    doNoComplainAnyMore=0;
+    _file=NULL;
+}
+/**
+    \fn psPacket
+    \brief dtor
+*/
+psPacket::~psPacket()
+{
+    close();
+}
+/**
+    \fn open
+    \brief dtor
+*/
+bool psPacket::open(const char *filenames,bool dontappend)
+{
+FP_TYPE opentype=FP_APPEND;
+    if(dontappend) opentype=FP_DONT_APPEND;
+    _file=new fileParser();
+    if(!_file->open(filenames,&opentype))
+    {
+        printf("[DmxPS] cannot open %s\n",filenames);
+        delete _file;
+        _file=NULL;
+        return false;
+    }
+    _size=_file->getSize();
+    return true;
+}
+/**
+    \fn close
+    \brief dtor
+*/
+bool psPacket::close(void)
+{
+    if(_file)
+    {
+        delete _file;
+        _file=NULL;
+    }
+    return true;
+}
+/**
+    \fn getPos
+*/
+uint64_t    psPacket::getPos(void)
+{
+    return 0;
+}
+/**
+    \fn setPos
+*/
+
+bool    psPacket::setPos(uint64_t pos)
+{
+    if(!_file->setpos(pos))
+    {
+        printf("[psPacket] Cannot seek to %"LLX"\n", pos);
+        return false;
+    }
+}
+
+/**
+    \fn getPacketOfType
+    \brief Only returns packet of type pid
+*/      
+
+bool        psPacket::getPacketOfType(uint8_t pid,uint32_t maxSize, uint32_t *packetSize,uint64_t *pts,uint64_t *dts,uint8_t *buffer,uint64_t *startAt)
+{
+
+    bool xit=false;
+    uint8_t tmppid;
+    while(1)
+    {
+        if(true!=getPacket(maxSize,&tmppid,packetSize,pts,dts,buffer,startAt))
+                return false;
+        else
+                if(tmppid==pid) return true;
+    }
+    return false;
+}
+/**
+    \fn getPacket
+*/      
+bool        psPacket::getPacket(uint32_t maxSize, uint8_t *pid, uint32_t *packetSize,uint64_t *opts,uint64_t *odts,uint8_t *buffer,uint64_t *startAt)
+{
+uint32_t globstream,len;
+uint8_t  stream,substream;
+uint64_t pts,dts;
+        // Resync on our stream
+_again2:
+        *pid=0;
+        if(!_file->sync(&stream)) 
+        {
+                uint64_t pos;
+                _file->getpos(&pos);
+                printf("[DmxPS] cannot sync  at "LLU"/"LLU"\n",pos,_size);
+                return false;
+        }
+// Position of this packet just before startcode
+        _file->getpos(startAt);
+        *startAt-=4;
+// Handle out of band stuff        
+        if(stream==PACK_START_CODE) 
+        {
+        		_file->forward(8);
+        		goto _again2;
+        }
+        if( stream==PADDING_CODE ||stream==SYSTEM_START_CODE) 
+        {
+                        len=_file->read16i();
+                        //printf("\tForwarding %lu bytes\n",len);
+        		_file->forward(len);
+        		goto _again2;
+        }
+        // Only keep relevant parts
+        // i.e. a/v : C0 C9 E0 E9
+        // subs 20-29
+        // private data 1/2
+#define INSIDE(min,max) (stream>=min && stream<max)
+        if(!(  INSIDE(0xC0,0xC9) || INSIDE(0xE0,0xE9) || INSIDE(0x20,0x29) || stream==PRIVATE_STREAM_1 || stream==PRIVATE_STREAM_2
+        			)) goto _again2;
+        // Ok we got a candidate
+        if(!getPacketInfo(stream,&substream,&len,&pts,&dts))   
+        {
+                goto _again2;
+        }
+        
+        //printf("Main Stream :%x substream :%x\n",stream,substream);
+        if(stream==PRIVATE_STREAM_1) globstream=0xFF00+substream;
+                else                 globstream=stream;
+
+        *pid=globstream;
+        *opts=pts;
+        *odts=dts;
+        *packetSize=len;
+        if(len>     maxSize)
+        {
+                printf("[DmxPS] Packet too big %d vs %d\n",len,maxSize);
+        }
+        if(!_file->read32(len,buffer)) return false;
+        return true;
+       
+}
+/**
+
+    \fn getPacketInfo
+    \brief       Retrieve info about the packet we just met.It is assumed that parser is just after the packet startcode
+
+*/
+
+uint8_t psPacket::getPacketInfo(uint8_t stream,uint8_t *substream,uint32_t *olen,uint64_t *opts,uint64_t *odts)
+{
+
+//uint32_t un ,deux;
+uint64_t size=0;
+uint8_t c,d;
+uint8_t align=0;
+                        
+                *substream=0xff;
+                *opts=ADM_NO_PTS;
+                *odts=ADM_NO_PTS;
+                
+                                        
+                size=_file->read16i();
+                if((stream==PADDING_CODE) || 
+                	 (stream==PRIVATE_STREAM_2)
+                        ||(stream==SYSTEM_START_CODE) //?
+                        ) // special case, no header
+                        {
+                                *olen=size;      
+                                return 1;
+                        }
+                                
+                        //      remove padding if any                                           
+        
+                while((c=_file->read8i()) == 0xff) 
+                {
+                        size--;
+                }
+//----------------------------------------------------------------------------
+//-------------------------------MPEG-2 PES packet style----------------------
+//----------------------------------------------------------------------------
+                if(((c&0xC0)==0x80))
+                {
+                        uint32_t ptsdts,len;
+                        //printf("\n mpeg2 type \n");
+                        //_muxTypeMpeg2=1;
+                        // c= copyright and stuff       
+                        //printf(" %x align\n",c);      
+                        if(c & 4) align=1;      
+                        c=_file->read8i();     // PTS/DTS
+                        //printf("%x ptsdts\n",c
+                        ptsdts=c>>6;
+                        // header len
+                        len=_file->read8i();
+                        size-=3;  
+
+                        switch(ptsdts)
+                        {
+                                case 2: // PTS=1 DTS=0
+                                        if(len>=5)
+                                        {
+                                                uint64_t pts1,pts2,pts0;
+                                                //      printf("\n PTS10\n");
+                                                        pts0=_file->read8i();  
+                                                        pts1=_file->read16i(); 
+                                                        pts2=_file->read16i();                 
+                                                        len-=5;
+                                                        size-=5;
+                                                        *opts=(pts1>>1)<<15;
+                                                        *opts+=pts2>>1;
+                                                        *opts+=(((pts0&6)>>1)<<30);
+                                        }
+                                        break;
+                                case 3: // PTS=1 DTS=1
+                                                #define PTS11_ADV 10 // nut monkey
+                                                if(len>=PTS11_ADV)
+                                                {
+                                                        uint32_t skip=PTS11_ADV;
+                                                        uint64_t pts1,pts2,dts,pts0;
+                                                                //      printf("\n PTS10\n");
+                                                                pts0=_file->read8i();  
+                                                                pts1=_file->read16i(); 
+                                                                pts2=_file->read16i(); 
+                                                                                        
+                                                                *opts=(pts1>>1)<<15;
+                                                                *opts+=pts2>>1;
+                                                                *opts+=(((pts0&6)>>1)<<30);
+                                                                pts0=_file->read8i();  
+                                                                pts1=_file->read16i(); 
+                                                                pts2=_file->read16i();                 
+                                                                dts=(pts1>>1)<<15;
+                                                                dts+=pts2>>1;
+                                                                dts+=(((pts0&6)>>1)<<30);
+                                                                len-=skip;
+                                                                size-=skip;
+                                                                *odts=dts;
+                                                                        //printf("DTS: %lx\n",dts);                
+                                                   }
+                                                   break;               
+                                case 1:
+                                                return 0;//ADM_assert(0); // forbidden !
+                                                break;
+                                case 0: 
+                                                // printf("\n PTS00\n");
+                                                break; // no pts nor dts
+                                                                                
+                                                            
+                        }  
+// Extension bit        
+// >stealthdave<                                
+
+                        // Skip remaining headers if any
+                        if(len) 
+                        {
+                                _file->forward(len);
+                                size=size-len;
+                        }
+                                
+                if(stream==PRIVATE_STREAM_1)
+                {
+                        if(size>5)
+                        {
+                        // read sub id
+                               *substream=_file->read8i();
+  //                    printf("\n Subid : %x",*subid);
+                                switch(*substream)
+                                {
+                                // DTS
+                                        case 0x88:case 0x89:case 0x8A:case 0x8B:
+                                        
+                                                *substream=*substream-0x48;
+                                                break;
+
+                                //AC3
+                                        case 0x80:case 0x81:case 0x82:case 0x83:
+                                        case 0x84:case 0x85:case 0x86:case 0x87:
+                                                *substream=*substream-0x80;
+                                                break;
+                                // PCM
+                                        case 0xA0:case 0xA1:case 0xa2:case 0xa3:
+                                        case 0xA4:case 0xA5:case 0xa6:case 0xa7:
+                                                // we have an additionnal header
+                                                // of 3 bytes
+                                                _file->forward(3);
+                                                size-=3;
+                                                break;
+                                // Subs
+                                case 0x20:case 0x21:case 0x22:case 0x23:
+                                case 0x24:case 0x25:case 0x26:case 0x27:
+                                                break;
+                             
+                                default:
+                                                doNoComplainAnyMore++;
+                                                if(doNoComplainAnyMore<10)
+                                                    printf("[DmxPS]Unkown substream %x\n",*substream);
+                                                *substream=0xff;
+                                }
+                                // skip audio header (if not sub)
+                                if(*substream>0x26 || *substream<0x20)
+                                {
+                                        _file->forward(3);
+                                        size-=3;
+                                }
+                                size--;
+                        }
+                }
+               //    printf(" pid %x size : %x len %x\n",sid,size,len);
+                *olen=size;
+                return 1;
+        }
+//----------------------------------------------------------------------------------------------                
+//-------------------------------MPEG-1 PES packet style----------------------                                  
+//----------------------------------------------------------------------------------------------                                        
+           if(0) //_muxTypeMpeg2)
+                {
+                        printf("[DmxPS]*** packet type 1 inside type 2 ?????*****\n");
+                        return 0; // mmmm                       
+                }
+          // now look at  STD buffer size if present
+          // 01xxxxxxxxx
+          if ((c>>6) == 1) 
+          {       // 01
+                        size-=2;
+                        _file->read8i();                       // skip one byte
+                        c=_file->read8i();   // then another
+           }                       
+           // PTS/DTS
+           switch(c>>4)
+           {
+                case 2:
+                {
+                        // 0010 xxxx PTS only
+                        uint64_t pts1,pts2,pts0;
+                                        size -= 4;
+                                        pts0=(c>>1) &7;
+                                        pts1=_file->read16i()>>1;
+                                        pts2=_file->read16i()>>1;
+                                        *opts=pts2+(pts1<<15)+(pts0<<30);
+                                        break;
+                  }
+                  case 3:
+                  {               // 0011 xxxx
+                        uint64_t pts1,pts2,pts0;
+                                        size -= 9;
+                                                                        
+                                        pts0=(c>>1) &7;
+                                        pts1=_file->read16i()>>1;
+                                        pts2=_file->read16i()>>1;
+                                        *opts=pts2+(pts1<<15)+(pts0<<30);
+                                        _file->forward(5);
+                   }                                                               
+                   break;
+                   
+                case 1:
+                        // 0001 xxx             
+                        // PTSDTS=01 not allowed                        
+                                return 0;
+                                break; 
+                }
+                                                                
+
+                if(!align)      
+                        size--;         
+        *olen=size;
+        return 1;
+}
+//************************************************************************************
+
+#define ADM_PACKET_LINEAR 10*1024
+/**
+    \fn psPacket
+*/
+psPacketLinear::psPacketLinear(uint8_t pid) : psPacket()
+{
+    oldStartAt=startAt=0xfffffff;
+    oldBufferLen=bufferLen=0;
+    bufferIndex=0;
+    myPid=pid;
+    eof=false;
+}
+/**
+    \fn ~psPacket
+*/
+psPacketLinear::~psPacketLinear() 
+{
+}
+/**
+    \fn refill
+*/
+bool psPacketLinear::refill(void) 
+{
+// In case a startcade spawns across 2 packets
+// we have to keep track of the old one
+        oldBufferDts=bufferDts;
+        oldBufferPts=bufferPts;
+        oldStartAt=startAt;
+        oldBufferLen=bufferLen;
+        if( false== getPacketOfType(myPid,ADM_PACKET_LINEAR, &bufferLen,&bufferPts,&bufferDts,buffer,&startAt)) return false;
+        bufferIndex=0;
+        return true;
+}
+/**
+    \fn readi8
+*/
+uint8_t psPacketLinear::readi8(void)
+{
+    consumed++;
+    if(bufferIndex<bufferLen)
+    {
+        return buffer[bufferIndex++];
+    }
+    if(false==refill()) 
+    {
+        eof=1;
+        return 0;
+    }
+    ADM_assert(bufferLen);
+    bufferIndex=1;
+    return buffer[0];
+    
+}
+/**
+    \fn readi16
+*/
+uint16_t psPacketLinear::readi16(void)
+{
+    if(bufferIndex+1<bufferLen)
+    {
+        uint16_t v=(buffer[bufferIndex]<<8)+buffer[bufferIndex+1];;
+        bufferIndex+=2;
+        consumed+=2;
+        return v;
+    }
+    return (readi8()<<8)+readi8();
+}
+/**
+    \fn readi32
+*/
+uint32_t psPacketLinear::readi32(void)
+{
+    if(bufferIndex+3<bufferLen)
+    {
+        uint8_t *p=buffer+bufferIndex;
+        uint32_t v=(p[0]<<24)+(p[1]<<16)+(p[2]<<8)+p[3];
+        bufferIndex+=4;
+        consumed+=4;
+        return v;
+    }
+    return (readi16()<<16)+readi16();
+}
+/**
+    \fn forward
+*/
+bool psPacketLinear::forward(uint32_t v)
+{
+    if(bufferIndex+v-1<bufferLen)
+    {
+        bufferIndex+=v;
+        consumed+=v;
+        return true;
+    }
+    if(!refill()) return false;
+    uint32_t delta=bufferLen-bufferIndex;
+    v-=delta;
+    consumed+=delta;
+    return forward(v);
+}
+
+/**
+    \fn bool    read(uint32_t len, uint8_t *buffer);
+    \brief
+*/
+bool    psPacketLinear::read(uint32_t len, uint8_t *out)
+{
+    // Enough already ?
+    while(len)
+    {
+        uint32_t avail=bufferLen-bufferIndex;
+        uint32_t chunk=avail;
+        if(chunk>len) chunk=len;
+#if 0
+        printf("len:%ld avail:%ld chunk %ld index:%d size:%d\n",
+                len,avail,chunk,bufferIndex,bufferLen);
+#endif
+        memcpy(out,buffer+bufferIndex,chunk);
+        bufferIndex+=chunk;
+        len-=chunk;
+        out+=chunk;
+        consumed+=chunk;
+        if(bufferIndex==bufferLen)
+        {
+            //printf("Refill\n");
+            if(false==refill()) return false;
+        }
+    }
+    return true;
+}
+/**
+        \fn getInfo
+        \brief Returns info about the current (or previous if it spawns) packet.
+            It is expected that the caller will do -4 to the index to get the start of the 
+            startCode
+*/
+bool    psPacketLinear::getInfo(psPacketInfo *info)
+{
+    if(bufferIndex<4)
+    {
+        info->startAt=this->oldStartAt;
+        info->offset=oldBufferLen+bufferIndex;
+        info->pts=oldBufferPts;
+        info->dts=oldBufferDts;
+
+    }else
+    {
+        info->startAt=this->startAt;
+        info->offset=bufferIndex;
+        info->pts=bufferPts;
+        info->dts=bufferDts;
+    }
+    return true;
+
+};
+/**
+    \fn seek
+    \brief Async jump
+*/
+bool    psPacketLinear::seek(uint64_t packetStart, uint32_t offset)
+{
+    if(!_file->setpos(packetStart))
+    {
+        printf("[psPacket] Cannot seek to %"LLX"\n",packetStart);
+        return 0;
+    }
+    refill();
+    ADM_assert(offset<bufferLen);
+    bufferIndex=offset;
+    
+    return true;
+}
+/**
+    \fn getConsumed
+    \brief returns the # of bytes consumed since the last call
+*/
+uint32_t psPacketLinear::getConsumed(void)
+{
+    uint32_t c=consumed;
+    consumed=0;
+    return c;
+}
+/**
+    \fn changePid
+    \brief change the pid of the stream we read (used when probing all tracks)
+*/
+bool    psPacketLinear::changePid(uint32_t pid) 
+{
+    myPid=(pid&0xff);
+    bufferLen=bufferIndex=0;
+    return true;
+}
+/* ********************************************************* */
+/**
+    \fn psPacketLinearTracker
+*/
+ psPacketLinearTracker::psPacketLinearTracker(uint8_t pid)  : psPacketLinear(pid)
+{
+   
+}
+/**
+    \fn ~psPacketLinearTracker
+*/
+psPacketLinearTracker::~psPacketLinearTracker()
+{
+
+    resetStats();
+}
+/**
+        \fn getStat
+*/
+packetStats    *psPacketLinearTracker::getStat(int index)
+{   
+    if(index<0 || index>=256) ADM_assert(0);
+    return stats+index;
+}
+/**
+    \fn getPacketgetPacketOfType
+    \brief Keep track of all the packets we have seen so far.
+    Usefull to detect the streams present and to look up the PTS/DTS of audio streams for the audio part of the index
+*/
+bool           psPacketLinearTracker::getPacketOfType(uint8_t pid,uint32_t maxSize, uint32_t *packetSize,uint64_t *pts,uint64_t *dts,uint8_t *buffer,uint64_t *startAt)
+{
+ bool xit=false;
+    uint8_t tmppid;
+    while(1)
+    {
+        if(true!=getPacket(maxSize,&tmppid,packetSize,pts,dts,buffer,startAt))
+                return false;
+        else
+        {
+                // Update 
+                ADM_assert(tmppid<0x100);
+                packetStats *p=stats+tmppid;
+                uint64_t ts=*pts;
+                if(ts==ADM_NO_PTS) ts=*dts;
+                if(ts!=ADM_NO_PTS)
+                {
+                    p->startCount=p->count;
+                    p->startAt=*startAt;
+                    p->startSize=p->size;
+                    p->startDts=ts;
+                }
+                p->count++;
+                p->size+=*packetSize;
+                if(tmppid==pid) return true;
+        }
+    }
+    return false;
+}
+/**
+    \fn resetStats
+*/
+bool           psPacketLinearTracker::resetStats(void)
+{
+    memset(stats,0,sizeof(stats));
+    for(int i=0;i<256;i++)
+    {
+        packetStats *p=stats+i;
+        p->startDts=ADM_NO_PTS;
+    }
+}
+//EOF

Deleted: branches/avidemux_2.6_branch_mean/avidemux/ADM_coreDemuxerMpeg/src/dmx_demuxer.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/ADM_coreDemuxerMpeg/src/dmx_demuxer.cpp	2009-02-10 16:00:26 UTC (rev 4582)
+++ branches/avidemux_2.6_branch_mean/avidemux/ADM_coreDemuxerMpeg/src/dmx_demuxer.cpp	2009-02-11 06:27:26 UTC (rev 4583)
@@ -1,30 +0,0 @@
-/***************************************************************************
-                         Base demuxer class
-    
-    copyright            : (C) 2002 by mean
-    email                : fixounet at free.fr
- ***************************************************************************/
-
-/***************************************************************************
- *                                                                         *
- *   This program is free software; you can redistribute it and/or modify  *
- *   it under the terms of the GNU General Public License as published by  *
- *   the Free Software Foundation; either version 2 of the License, or     *
- *   (at your option) any later version.                                   *
- *                                                                         *
- ***************************************************************************/
-
-#include "ADM_default.h"
-#include <string.h>
-#include <math.h>
-
-#include "dmx_demuxer.h"
-
-dmx_demuxer::dmx_demuxer(void)
-{
-        _size=0;
-        _lastErr=0;
-}
-dmx_demuxer::~dmx_demuxer(void)
-{
-}

Deleted: branches/avidemux_2.6_branch_mean/avidemux/ADM_coreDemuxerMpeg/src/dmx_demuxerES.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/ADM_coreDemuxerMpeg/src/dmx_demuxerES.cpp	2009-02-10 16:00:26 UTC (rev 4582)
+++ branches/avidemux_2.6_branch_mean/avidemux/ADM_coreDemuxerMpeg/src/dmx_demuxerES.cpp	2009-02-11 06:27:26 UTC (rev 4583)
@@ -1,160 +0,0 @@
-/***************************************************************************
-                          Base class for Mpeg Demuxer
-                             -------------------
-                
-    copyright            : (C) 2005 by mean
-    email                : fixounet at free.fr
- ***************************************************************************/
-
-/***************************************************************************
- *                                                                         *
- *   This program is free software; you can redistribute it and/or modify  *
- *   it under the terms of the GNU General Public License as published by  *
- *   the Free Software Foundation; either version 2 of the License, or     *
- *   (at your option) any later version.                                   *
- *                                                                         *
- ***************************************************************************/
-
-#include <string.h>
-#include <math.h>
-
-#include "ADM_default.h"
-
-#include "dmx_demuxerEs.h"
- 
-dmx_demuxerES::dmx_demuxerES(void)
-{
-        consumed=0;
-        parser=new fileParser();
-        stampAbs=0;
-}
-dmx_demuxerES::~dmx_demuxerES()
-{
-        if(parser) delete parser;
-        parser=NULL;
-}
-uint8_t dmx_demuxerES::open(const char *name)
-{
-FP_TYPE fp=FP_DONT_APPEND;
-        if(! parser->open(name,&fp)) return 0;
-        _size=parser->getSize();
-        return 1;
-}
-uint8_t dmx_demuxerES::forward(uint32_t f)
-{
-        consumed+=f;
-        return parser->forward(f);
-}
-uint8_t  dmx_demuxerES::stamp(void)
-{
-        consumed=0;
-        parser->getpos(&stampAbs);
-        stampAbs-=4;
-}
-uint64_t dmx_demuxerES::elapsed(void)
-{
-        return consumed;        
-}
-uint8_t  dmx_demuxerES::getPos( uint64_t *abs,uint64_t *rel)
-{
-        *rel=0;
-        parser->getpos(abs);       
-        return 1;
-}
-uint8_t dmx_demuxerES::setPos( uint64_t abs,uint64_t  rel)
-{
-               return parser->setpos(abs);
-}
-/*
-        Sync on mpeg sync word, returns the sync point in abs/r
-*/
-uint8_t         dmx_demuxerES::sync( uint8_t *stream,uint64_t *abs,uint64_t *r,uint64_t *pts,uint64_t *dts)
-{
-uint32_t val,hnt;
-         *r=0;
-                *pts=ADM_NO_PTS;
-                *dts=ADM_NO_PTS;
-
-                val=0;
-                hnt=0;                  
-                        
-                // preload
-                hnt=(read8i()<<16) + (read8i()<<8) +read8i();
-                if(_lastErr)
-                {
-                        _lastErr=0;
-                        printf("\n io error , aborting sync\n");
-                        return 0;       
-                }
-                
-                while((hnt!=0x00001))
-                {
-                                        
-                        hnt<<=8;
-                        val=read8i();                                   
-                        hnt+=val;
-                        hnt&=0xffffff;  
-                                        
-                        if(_lastErr)
-                        {
-                             _lastErr=0;
-                            printf("\n io error , aborting sync\n");
-                            return 0;
-                         }
-                                                                        
-                }
-                                
-                *stream=read8i();
-                parser->getpos(abs);
-                *abs-=4;
-                return 1;
-}
-
-/**
-          \fn syncH264
-          \brief search h264 startcode 00 00 00 01
-*/
-uint8_t         dmx_demuxerES::syncH264( uint8_t *stream,uint64_t *abs,uint64_t *r,uint64_t *pts,uint64_t *dts)
-{
-uint32_t val,hnt;
-         *r=0;
-                *pts=ADM_NO_PTS;
-                *dts=ADM_NO_PTS;
-
-                val=0;
-                hnt=0;                  
-                        
-                // preload
-                hnt=(read8i()<<24)+(read8i()<<16) + (read8i()<<8) +read8i();
-                if(_lastErr)
-                {
-                        _lastErr=0;
-                        printf("\n io error , aborting sync\n");
-                        return 0;       
-                }
-                
-                while((hnt!=1))
-                {
-                                        
-                        hnt<<=8;
-                        val=read8i();                                   
-                        hnt+=val;
-                        
-                                        
-                        if(_lastErr)
-                        {
-                             _lastErr=0;
-                            printf("\n io error , aborting sync\n");
-                            return 0;
-                         }
-                                                                        
-                }
-                                
-                *stream=read8i();
-                parser->getpos(abs);
-                *abs-=5;
-                return 1;
-}
-
-          
-          

Deleted: branches/avidemux_2.6_branch_mean/avidemux/ADM_coreDemuxerMpeg/src/dmx_demuxerMSDVR.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/ADM_coreDemuxerMpeg/src/dmx_demuxerMSDVR.cpp	2009-02-10 16:00:26 UTC (rev 4582)
+++ branches/avidemux_2.6_branch_mean/avidemux/ADM_coreDemuxerMpeg/src/dmx_demuxerMSDVR.cpp	2009-02-11 06:27:26 UTC (rev 4583)
@@ -1,418 +0,0 @@
-/***************************************************************************
-       MSDVR aka mpeg ES in asf file
-       
-    copyright            : (C) 2006 by mean
-    email                : fixounet at free.fr
- ***************************************************************************/
-
-/***************************************************************************
- *                                                                         *
- *   This program is free software; you can redistribute it and/or modify  *
- *   it under the terms of the GNU General Public License as published by  *
- *   the Free Software Foundation; either version 2 of the License, or     *
- *   (at your option) any later version.                                   *
- *                                                                         *
- ***************************************************************************/
-#if 0
-#include <string.h>
-#include <math.h>
-
-#include "ADM_default.h"
-
-#include "dmx_demuxerMSDVR.h"
-
-#include "../ADM_asf/ADM_asfPacket.h"
-#include "../ADM_asf/ADM_asf.h"
-
-#define PARSER ((asfPacket *)aParser)
-// ******************************************************
-uint8_t         dmx_demuxerMSDVR::changePid(uint32_t newpid,uint32_t newpes)
-{
-  myPid=newpid ;
-  myPes=newpes;
-  _pesBufferStart=0;  // Big value so that we read
-  _pesBufferLen=0;
-  _pesBufferIndex=0;
-}
-// ******************************************************
-dmx_demuxerMSDVR::dmx_demuxerMSDVR(uint32_t nb,MPEG_TRACK *tracks,uint32_t multi)
-{
-  consumed=0;
-  aParser=NULL;
-  stampAbs=0;
-  _pesBuffer=new uint8_t [MAX_MSDVR_BUFFER];
-
-  memset(seen,0,sizeof(seen));
-
-  _pesBufferStart=0;  // Big value so that we read
-  _pesBufferLen=0;
-  _pesBufferIndex=0;
-  ADM_assert(nb>0);
-  tracked=NULL;
-
-  nbTracked=nb;
-  for(int i=0;i<256;i++) trackPTS[i]=ADM_NO_PTS;
-  myPid=tracks[0].pid;
-  
-  if(nb!=256)     // Only pick one track as main, and a few as informative
-  {
-                
-    memset(mask,0,256);
-    tracked=new uint8_t[nbTracked];
-    for(int i=1;i<nb;i++)
-    {
-      mask[tracks[i].pid&0xff]=1;
-      tracked[i]=tracks[i].pid&0xff;
-    }                
-                
-  }else
-  {
-    memset(mask,1,256); // take all tracks
-  }
-
-  _probeSize=0; 
-  memset(seen,0,255*sizeof(uint64_t));     
-  printf("Creating mpeg PS demuxer  main Pid: %X \n",myPid);
-  _multi=multi;
-  _fd=NULL;
-  _dataStart=0;
-}
-// ******************************************************
-dmx_demuxerMSDVR::~dmx_demuxerMSDVR()
-{
-  if(aParser)
-  {
-    asfPacket *p=PARSER;
-    delete p;
-    aParser=NULL;
-  }
-  if(_fd)
-  {
-    fclose(_fd);
-    _fd=NULL; 
-  }
-  if(_pesBuffer) delete [] _pesBuffer;
-  _pesBuffer=NULL;
-  if(tracked) delete [] tracked;
-  tracked=NULL;
-}
-/*
-        Get stats about the PES ids tracked in tracked order
-        if nbTracked=256 it means tracks all possible PES id
-        The 0 rank is video
-*/
-// ******************************************************
-uint8_t       dmx_demuxerMSDVR::getStats(uint64_t *oseen)
-{
-  if(nbTracked!=256)
-  {
-    oseen[0]=0;
-    for(int i=1;i<nbTracked;i++)
-    {
-      oseen[i]=seen[tracked[i]];
-    }
-  }
-  else
-  {
-    for(int i=0;i<nbTracked;i++)
-    {
-      oseen[i]=seen[i];
-    }
-  }
-  return 1;
-}
-// ******************************************************
-uint8_t         dmx_demuxerMSDVR::getAllPTS(uint64_t *stat)
-{
-  if(nbTracked!=256)
-  {
-    stat[0]=0;
-    for(int i=1;i<nbTracked;i++)
-    {
-      stat[i]=trackPTS[tracked[i]];
-    }
-  }
-  else
-  {
-    for(int i=0;i<nbTracked;i++)
-    {
-      stat[i]=trackPTS[i];
-    }
-  }
-  return 1;
-}
-// ******************************************************
-uint8_t dmx_demuxerMSDVR::setProbeSize(uint32_t sz)
-{
-  _probeSize=sz;
-  return 1;
-}
-// ******************************************************
-uint8_t dmx_demuxerMSDVR::forward(uint32_t f)
-{
-  uint32_t left;        
-  if(_pesBufferIndex+f<=_pesBufferLen) 
-  {
-    _pesBufferIndex+=f;
-    consumed+=f;
-    return 1;
-  }
-        // else read another packet
-  left=_pesBufferLen-_pesBufferIndex;
-  f-=left;
-  consumed+=left;
-  if(!refill()) return 0;
-  return forward(f);
-}
-// ******************************************************
-uint8_t  dmx_demuxerMSDVR::stamp(void)
-{
-  consumed=0;        
-}
-// ******************************************************
-uint64_t dmx_demuxerMSDVR::elapsed(void)
-{
-  return consumed;        
-}
-// ******************************************************
-uint8_t  dmx_demuxerMSDVR::getPos( uint64_t *abs,uint64_t *rel)
-{
-  *rel=_pesBufferIndex;
-  *abs=_pesBufferStart;       
-  return 1;
-}
-// ******************************************************
-uint64_t dmx_demuxerMSDVR::getSize( void) 
-{
-  return (uint64_t)_nbPackets; 
-}
-// ******************************************************
-uint8_t dmx_demuxerMSDVR::setPos( uint64_t abs,uint64_t  rel)
-{
-				// Need to move ?
-  if(abs==_pesBufferStart && _pesBufferLen)
-  {
-    if(_pesBufferLen<rel)
-    {
-      printf("Asked setpos to go %lu whereas %lu is max\n",
-             rel,_pesBufferLen);
-      ADM_assert(rel<_pesBufferLen);
-    }
-    _pesBufferIndex=rel;
-    return 1;
-  }
-  // Seek...
-  if(!PARSER->goToPacket(abs))
-  {
-    printf("[MSDVR] Seek to %u failed\n",abs); 
-  }
-  _pesBufferStart=abs;
-  PARSER->purge(); // just in case
-  if(!refill())
-  {
-    printf("DMX_PS: refill failed\n");
-    return 0;
-  }
-                
-  if(rel>_pesBufferLen)
-  {
-    printf("Set pos failed : asked rel:%lu max: %lu, absPos:%llu absPosafterRefill:%llu\n",
-           rel,_pesBufferLen,abs,_pesBufferStart);
-    ADM_assert(rel<_pesBufferLen);                        
-  }
-
-  _pesBufferIndex=rel;
-  return 1;
-               
-}
-/*
-        Sync on mpeg sync word, returns the sync point in abs/r
-*/
-
-
-// ******************************************************
-uint32_t         dmx_demuxerMSDVR::read(uint8_t *w,uint32_t len)
-{
-  uint32_t mx;
-                // enough in buffer ?
-  if(_pesBufferIndex+len<=_pesBufferLen)
-  {
-    memcpy(w,_pesBuffer+_pesBufferIndex,len);
-    _pesBufferIndex+=len;
-    consumed+=len;
-    return len;
-  }
-                // flush
-  mx=_pesBufferLen-_pesBufferIndex;
-  if(mx)
-  {
-    memcpy(w,_pesBuffer+_pesBufferIndex,mx);
-    _pesBufferIndex+=mx;
-    consumed+=mx;
-    w+=mx;
-    len-=mx;
-  }
-  if(!refill())
-  {
-    printf("Refill failed at %d  \n",_pesBufferStart);
-    _lastErr=1;
-    return 0;
-  }
-  return mx+read(w,len);
-}
-// ******************************************************
-uint8_t         dmx_demuxerMSDVR::sync( uint8_t *stream,uint64_t *abs,uint64_t *r,uint64_t *pts,uint64_t *dts)
-{
-  uint32_t val,hnt;
-  *r=0;
-
-  val=0;
-  hnt=0;
-
-                // preload
-  hnt=read32i();
-  if(_lastErr)
-  {
-    _lastErr=0;
-    printf("\n io error , aborting sync 1\n");
-    return 0;       
-  }
-  val=hnt&0xff;
-  while(((hnt&0xffffff00)!=0x100))
-  {
-
-    hnt<<=8;
-    val=read8i();
-    hnt+=val;
-    if(_lastErr)
-    {
-      _lastErr=0;
-      printf("\n io error , aborting sync 2\n");
-      return 0;
-    }
-
-  }
-
-  *stream=val;
-                // Case 1 : assume we are still in the same packet
-  if(_pesBufferIndex>=4)
-  {
-    *abs=_pesBufferStart;
-    *r=_pesBufferIndex-4;
-    *pts=_pesPTS;
-    *dts=_pesDTS;
-  }
-  else
-  {       // pick what is needed from oldPesStart etc...
-                        // since the beginning in the previous packet
-    uint32_t left=4-_pesBufferIndex;
-    left=_oldPesLen-left;
-#if 0
-                                 printf("Next packet : %I64X Len :%lu, using previous packet %I64X len:%u as pos=%lu\n",
-                                 		_pesBufferStart,_pesBufferLen,_oldPesStart,_oldPesLen,_pesBufferIndex);
-#endif
-                                 if(left>_oldPesLen)
-{
-  printf("Need %lu bytes from previous packet, which len is %lu\n",left,_oldPesLen);
-  ADM_assert(0);
-}
-                                *abs=_oldPesStart;
-                                *r=left;
-                                *pts=_oldPTS;
-                                *dts=_oldDTS;
-  }
-  return 1;
-}
-// ******************************************************
-
-uint8_t dmx_demuxerMSDVR::refill(void)
-{
-  // read one packet
-                
-          _pesDTS=ADM_NO_PTS;
-          _pesPTS=ADM_NO_PTS;
-          _pesBufferStart=0;
-          _pesBufferLen=0;
-          _pesBufferIndex=0;
-          while(!_pesBufferLen)
-          {
-              if(!PARSER->nextPacket(0xff))
-              {
-                  printf("[MSDVR] Packet Error\n");
-                  return 0; 
-              }
-          
-              PARSER->skipPacket();
-              // Now fill buffer
-              if(demuxerQueue.isEmpty()) continue;
-              while(!demuxerQueue.isEmpty())
-              {
-                asfBit *bit;
-                ADM_assert(demuxerQueue.pop((void**)&bit));
-                if(bit->stream!=myPid)
-                {
-                  if(bit->stream<0x100 && mask[bit->stream &0xff])
-                  {
-                    seen[bit->stream]+=bit->len;
-                  }
-		  if (bit->data) delete[] bit->data;
-                  delete bit;
-                }else
-                {
-                  _pesBufferStart=bit->packet;
-                  memcpy(&(_pesBuffer[_pesBufferLen]),bit->data,bit->len);
-                  _pesBufferLen+=bit->len;
-                  if (bit->data) delete[] bit->data;
-                  delete bit;
-                }
-              }
-              return 1;
-          }
-          return 0;
-}
-/***********************************************/
-uint8_t dmx_demuxerMSDVR::open(const char *name)
-{
-  int r=5;
-  const chunky *id=NULL;
-  //
-  _fd=fopen(name,"rb");
-  if(!_fd)
-  {
-    printf("Demuxer MSDVR open failed\n");
-    return 0; 
-  }
-  // Get the data chunk and ignore others
-  asfChunk h(_fd);
-
-  printf("[MSDVR] Searching data\n");
-  while(r--)
-  {
-    h.nextChunk();    // Skip headers
-    id=h.chunkId();
-    h.dump();
-    if(id->id==ADM_CHUNK_DATA_CHUNK) break;
-    h.skipChunk();
-  }
-  if(id->id!=ADM_CHUNK_DATA_CHUNK)
-  {
-    printf("[MSDVR] Cannot find data chunk\n");
-    return 0; 
-  }
-  h.read32();
-  h.read32();
-  h.read32();
-  h.read32();
-  _nbPackets=(uint32_t) h.read64();
-  h.read16();
-  //********** Ready
-  _dataStart=ftello(_fd);
-  asfPacket *packet;
-  packet=new asfPacket(_fd,_nbPackets,0x2000,&demuxerQueue,_dataStart);
-  aParser=(void *)packet;
-  printf("[MSDVR] Opened ok\n");
-  return 1;
-}
-#endif
-// ******************************************************
-// EOF

Deleted: branches/avidemux_2.6_branch_mean/avidemux/ADM_coreDemuxerMpeg/src/dmx_demuxerPS.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/ADM_coreDemuxerMpeg/src/dmx_demuxerPS.cpp	2009-02-10 16:00:26 UTC (rev 4582)
+++ branches/avidemux_2.6_branch_mean/avidemux/ADM_coreDemuxerMpeg/src/dmx_demuxerPS.cpp	2009-02-11 06:27:26 UTC (rev 4583)
@@ -1,723 +0,0 @@
-/***************************************************************************
-                          PS demuxer
-                             -------------------
-
-    copyright            : (C) 2005 by mean
-    email                : fixounet at free.fr
- ***************************************************************************/
-
-/***************************************************************************
- *                                                                         *
- *   This program is free software; you can redistribute it and/or modify  *
- *   it under the terms of the GNU General Public License as published by  *
- *   the Free Software Foundation; either version 2 of the License, or     *
- *   (at your option) any later version.                                   *
- *                                                                         *
- ***************************************************************************/
-
-#include <string.h>
-#include <math.h>
-
-#include "ADM_default.h"
-
-#include "dmx_demuxerPS.h"
-uint8_t         dmx_demuxerPS::changePid(uint32_t newpid,uint32_t newpes)
-{
-          myPid=newpes & 0xff;
-          if(myPid<9 || (myPid>=0xA0&&myPid<=0xA9) || (myPid>=0x20 && myPid<0x27) ||(myPid>=0x40 && myPid<=0x49) ) myPid|=0xff00;
-        _pesBufferStart=0;  // Big value so that we read
-        _pesBufferLen=0;
-        _pesBufferIndex=0;
-}
-dmx_demuxerPS::dmx_demuxerPS(uint32_t nb,MPEG_TRACK *tracks,uint32_t multi)
-{
-        consumed=0;
-        parser=new fileParser();
-        stampAbs=0;
-        _pesBuffer=new uint8_t [MAX_PES_BUFFER];
-
-        memset(seen,0,sizeof(seen));
-
-        _pesBufferStart=0;  // Big value so that we read
-        _pesBufferLen=0;
-        _pesBufferIndex=0;
-        ADM_assert(nb>0);
-        tracked=NULL;
-
-        nbTracked=nb;
-        for(int i=0;i<256;i++) trackPTS[i]=ADM_NO_PTS;
-        myPid=tracks[0].pes;
-
-        if(nb!=256)     // Only pick one track as main, and a few as informative
-        {
-
-                memset(mask,0,256);
-                tracked=new uint8_t[nbTracked];
-                for(int i=1;i<nb;i++)
-                {
-                        mask[tracks[i].pes&0xff]=1;
-                        tracked[i]=tracks[i].pes&0xff;
-                }
-
-        }else
-        {
-                memset(mask,1,256); // take all tracks
-        }
-
-        if(myPid<9 || (myPid>0xA0&&myPid<0xA9) || (myPid>=0x20 && myPid<0x27)) myPid|=0xff00;
-
-
-
-       	_probeSize=0;
-       	memset(seen,0,255*sizeof(uint64_t));
-        printf("Creating mpeg PS demuxer  main Pid: %X \n",myPid);
-        _multi=multi;
-}
-dmx_demuxerPS::~dmx_demuxerPS()
-{
-        if(parser) delete parser;
-        parser=NULL;
-        if(_pesBuffer) delete [] _pesBuffer;
-        _pesBuffer=NULL;
-        if(tracked) delete [] tracked;
-        tracked=NULL;
-}
-/*
-        Get stats about the PES ids tracked in tracked order
-        if nbTracked=256 it means tracks all possible PES id
-        The 0 rank is video
-*/
-uint8_t       dmx_demuxerPS::getStats(uint64_t *oseen)
-{
-        if(nbTracked!=256)
-        {
-                oseen[0]=0;
-                for(int i=1;i<nbTracked;i++)
-                {
-                        oseen[i]=seen[tracked[i]];
-                }
-        }
-        else
-        {
-                 for(int i=0;i<nbTracked;i++)
-                {
-                        oseen[i]=seen[i];
-                }
-        }
-        return 1;
-}
-uint8_t         dmx_demuxerPS::getAllPTS(uint64_t *stat)
-{
-        if(nbTracked!=256)
-        {
-                stat[0]=0;
-                for(int i=1;i<nbTracked;i++)
-                {
-                        stat[i]=trackPTS[tracked[i]];
-                }
-        }
-        else
-        {
-                 for(int i=0;i<nbTracked;i++)
-                {
-                        stat[i]=trackPTS[i];
-                }
-        }
-        return 1;
-}
-
-uint8_t dmx_demuxerPS::setProbeSize(uint32_t sz)
-{
-		_probeSize=sz;
-		return 1;
-}
-uint8_t dmx_demuxerPS::open(const char *name)
-{
-FP_TYPE fp=FP_DONT_APPEND;
-        if(_multi) fp=FP_APPEND;
-        if(! parser->open(name,&fp)) return 0;
-        _size=parser->getSize();
-
-        return 1;
-}
-uint8_t dmx_demuxerPS::forward(uint32_t f)
-{
-uint32_t left;
-        if(_pesBufferIndex+f<=_pesBufferLen)
-        {
-                _pesBufferIndex+=f;
-                consumed+=f;
-                return 1;
-        }
-        // else read another packet
-        left=_pesBufferLen-_pesBufferIndex;
-        f-=left;
-        consumed+=left;
-        if(!refill()) return 0;
-        return forward(f);
-}
-uint8_t  dmx_demuxerPS::stamp(void)
-{
-        consumed=0;
-}
-uint64_t dmx_demuxerPS::elapsed(void)
-{
-        return consumed;
-}
-uint8_t  dmx_demuxerPS::getPos( uint64_t *abs,uint64_t *rel)
-{
-        *rel=_pesBufferIndex;
-        *abs=_pesBufferStart;
-        return 1;
-}
-uint8_t dmx_demuxerPS::setPos( uint64_t abs,uint64_t  rel)
-{
-				// Need to move ?
-				if(abs==_pesBufferStart && _pesBufferLen)
-				{
-						if(_pesBufferLen<rel)
-							{
-								printf("Asked setpos to go %"LLU" whereas %"LU" is max\n",
-											rel,_pesBufferLen);
-								ADM_assert(rel<_pesBufferLen);
-							}
-
-					  _pesBufferIndex=rel;
-					  return 1;
-
-				}
-               if(!parser->setpos(abs))
-                {
-                        printf("DMX_PS: setPos failed\n");
-                         return 0;
-                }
-                _pesBufferStart=abs;
-                if(!refill())
-                {
-                        printf("DMX_PS: refill failed\n");
-                        return 0;
-                }
-
-                if(rel>_pesBufferLen)
-                {
-                        printf("Set pos failed : asked rel:%"LLU" max: %"LU", absPos:%"LLU" absPosafterRefill:%"LLU"\n",
-                                        rel,_pesBufferLen,abs,_pesBufferStart);
-                        ADM_assert(rel<_pesBufferLen);
-                }
-
-                _pesBufferIndex=rel;
-                return 1;
-
-}
-/*
-        Sync on mpeg sync word, returns the sync point in abs/r
-*/
-
-
-
-uint32_t         dmx_demuxerPS::read(uint8_t *w,uint32_t len)
-{
-uint32_t mx;
-                // enough in buffer ?
-                if(_pesBufferIndex+len<=_pesBufferLen)
-                {
-                        memcpy(w,_pesBuffer+_pesBufferIndex,len);
-                        _pesBufferIndex+=len;
-                        consumed+=len;
-                        return len;
-                }
-                // flush
-                mx=_pesBufferLen-_pesBufferIndex;
-                if(mx)
-                {
-                        memcpy(w,_pesBuffer+_pesBufferIndex,mx);
-                        _pesBufferIndex+=mx;
-                        consumed+=mx;
-                        w+=mx;
-                        len-=mx;
-                }
-                if(!refill())
-                {
-                        printf("Refill failed at %"LLD"  \n",_pesBufferStart);
-                        _lastErr=1;
-                         return 0;
-                }
-                return mx+read(w,len);
-}
-uint8_t         dmx_demuxerPS::sync( uint8_t *stream,uint64_t *abs,uint64_t *r,uint64_t *pts,uint64_t *dts)
-{
-uint32_t val,hnt;
-         *r=0;
-
-                val=0;
-                hnt=0;
-
-                // preload
-                hnt=read32i();
-                if(_lastErr)
-                {
-                        _lastErr=0;
-                        printf("\n io error , aborting sync 1\n");
-                        return 0;
-                }
-                val=hnt&0xff;
-                while(((hnt&0xffffff00)!=0x100))
-                {
-
-                        hnt<<=8;
-                        val=read8i();
-                        hnt+=val;
-                        if(_lastErr)
-                        {
-                             _lastErr=0;
-                            printf("\n io error , aborting sync 2\n");
-                            return 0;
-                         }
-
-                }
-
-                *stream=val;
-                // Case 1 : assume we are still in the same packet
-                if(_pesBufferIndex>=4)
-                {
-                        *abs=_pesBufferStart;
-                        *r=_pesBufferIndex-4;
-                        *pts=_pesPTS;
-                        *dts=_pesDTS;
-                }
-                else
-                {       // pick what is needed from oldPesStart etc...
-                        // since the beginning in the previous packet
-                        uint32_t left=4-_pesBufferIndex;
-                                 left=_oldPesLen-left;
-#if 0
-                                 printf("Next packet : %I64X Len :%lu, using previous packet %I64X len:%u as pos=%lu\n",
-                                 		_pesBufferStart,_pesBufferLen,_oldPesStart,_oldPesLen,_pesBufferIndex);
-#endif
-                                 if(left>_oldPesLen)
-                                {
-                                        printf("Need %"LU" bytes from previous packet, which len is %"LU"\n",left,_oldPesLen);
-                                        ADM_assert(0);
-                                }
-                                *abs=_oldPesStart;
-                                *r=left;
-                                *pts=_oldPTS;
-                                *dts=_oldDTS;
-                }
-                return 1;
-}
-
-//
-//      Refill the pesBuffer
-//              Only with the pid that is of interest for us
-//              Update PTS/DTS
-//              Keep track of other pes len
-//
- uint8_t         dmx_demuxerPS::getPacketInfo(uint8_t **data, uint32_t *len, uint32_t *usableLen,uint64_t *pts)
- {
-            *data=_pesBuffer;
-            *len=_pesBufferLen;
-            *usableLen=_pesBufferLen-_pesBufferIndex;
-            *pts=_pesPTS;
-            return 1;
- }
-uint8_t dmx_demuxerPS::refill(void)
-{
-uint32_t globstream,len;
-uint8_t  stream,substream;
-uint64_t abs,pts,dts;
-        // Resync on our stream
-_again:
-        if(!parser->sync(&stream))
-        {
-                uint64_t pos;
-                parser->getpos(&pos);
-                printf("DmxPS: cannot sync  at %"LLU"/%"LLU"\n",pos,_size);
-                _lastErr=1;
-                return 0;
-        }
-        parser->getpos(&abs);
-        if(_probeSize)
-        {
-        	uint64_t pos;
-                parser->getpos(&pos);
-                if(pos>_probeSize)
-                {
-                		printf("Probe exceeded\n");
-                		return 0;
-                }
-        }
-// Handle out of band stuff
-        if(stream==PACK_START_CODE)
-        {
-        		parser->forward(8);
-        		goto _again;
-        }
-        if(stream==PADDING_CODE || stream==SYSTEM_START_CODE)
-        {
-                        len=parser->read16i();
-                        //printf("\tForwarding %lu bytes\n",len);
-        		parser->forward(len);
-        		goto _again;
-        }
-        // Only keep relevant parts
-        // i.e. a/v : C0 C9 E0 E9
-        // subs 20-29
-        // private data 1/2
-#define INSIDE(min,max) (stream>=min && stream<max)
-        if(!(  INSIDE(0xC0,0xC9) || INSIDE(0xE0,0xE9) || INSIDE(0x20,0x29) || stream==PRIVATE_STREAM_1 || stream==PRIVATE_STREAM_2
-        			)) goto _again;
-        // Ok we got a candidate
-        parser->getpos(&abs);
-        abs-=4;
-        if(!getPacketInfo(stream,&substream,&len,&pts,&dts))
-        {
-                goto _again;
-        }
-        if(!len) goto _again;
-        if(len>MAX_PES_BUFFER) goto _again;
-
-        if(stream==PRIVATE_STREAM_1) globstream=0xFF00+substream;
-                else                 globstream=stream;
-      //  seen[globstream & 0xFF]+=len;
-        if(myPid==globstream)
-        {
-                _oldPesStart=_pesBufferStart;
-                _oldPesLen=_pesBufferLen;
-                _oldPTS=_pesPTS;
-                _oldDTS=_pesDTS;
-
-                _pesDTS=dts;
-                _pesPTS=pts;
-                _pesBufferStart=abs;
-                _pesBufferLen=len;
-                _pesBufferIndex=0;
-
-                if(!parser->read32(len,_pesBuffer))
-                {
-                        printf("Read failed dmx_demuxerPS::refill %d\n",len);
-                        return 0;
-                }
-                return 1;
-        }
-        if(mask[globstream &0xff])
-        {
-                seen[globstream& 0xff]+=len;
-                if(trackPTS[globstream&0xff]==ADM_NO_PTS && pts!=ADM_NO_PTS)
-                {
-                        trackPTS[globstream & 0xff]=pts;
-                }
-
-        }
-        // Here keep track of other tracks
-         parser->forward(len);
-        goto _again;
-        return 0;
-}
-/***************************************************
-    Alternate refill, we read the whole packet
-****************************************************/
-uint8_t dmx_demuxerPS::refillFull(uint8_t *outstream)
-{
-uint32_t globstream,len;
-uint8_t  stream,substream;
-uint64_t abs,pts,dts;
-        // Resync on our stream
-_again2:
-        *outstream=0;
-        if(!parser->sync(&stream))
-        {
-                uint64_t pos;
-                parser->getpos(&pos);
-                printf("DmxPS: cannot sync  at %"LLU"/%"LLU"\n",pos,_size);
-                _lastErr=1;
-                return 0;
-        }
-        parser->getpos(&abs);
-        if(_probeSize)
-        {
-        	uint64_t pos;
-                parser->getpos(&pos);
-                if(pos>_probeSize)
-                {
-                		printf("Probe exceeded\n");
-                		return 0;
-                }
-        }
-// Handle out of band stuff
-        if(stream==PACK_START_CODE)
-        {
-        		parser->forward(8);
-        		goto _again2;
-        }
-        if( stream==PADDING_CODE ||stream==SYSTEM_START_CODE)
-        {
-                        len=parser->read16i();
-                        //printf("\tForwarding %lu bytes\n",len);
-        		parser->forward(len);
-        		goto _again2;
-        }
-        // Only keep relevant parts
-        // i.e. a/v : C0 C9 E0 E9
-        // subs 20-29
-        // private data 1/2
-#define INSIDE(min,max) (stream>=min && stream<max)
-        if(!(  INSIDE(0xC0,0xC9) || INSIDE(0xE0,0xE9) || INSIDE(0x20,0x29) || stream==PRIVATE_STREAM_1 || stream==PRIVATE_STREAM_2
-        			)) goto _again2;
-        // Ok we got a candidate
-        parser->getpos(&abs);
-        abs-=4;
-        if(!getPacketInfo(stream,&substream,&len,&pts,&dts))
-        {
-                goto _again2;
-        }
-        if(len>MAX_PES_BUFFER) goto _again2;
-
-        if(stream==PRIVATE_STREAM_1) globstream=0xFF00+substream;
-                else                 globstream=stream;
-      //  seen[globstream & 0xFF]+=len;
-
-            uint32_t headerLen;
-            uint64_t curPos,totalLen;
-
-                 parser->getpos(&curPos);
-                 headerLen=curPos-abs;
-                _oldPesStart=_pesBufferStart;
-                _oldPesLen=_pesBufferLen;
-                _oldPTS=_pesPTS;
-                _oldDTS=_pesDTS;
-
-                totalLen=headerLen+len;
-
-                _pesDTS=dts;
-                _pesPTS=pts;
-                _pesBufferStart=abs;
-                _pesBufferLen=totalLen;
-                _pesBufferIndex=headerLen;
-                parser->setpos(abs);
-                *outstream=globstream;
-                if(!parser->read32(totalLen,_pesBuffer)) return 0;
-                return 1;
-
-}
-/*
-        Retrieve info about the packet we just met
-        It is assumed that parser is just after the packet startcode
-
-*/
-
-uint8_t dmx_demuxerPS::getPacketInfo(uint8_t stream,uint8_t *substream,uint32_t *olen,uint64_t *opts,uint64_t *odts)
-{
-
-//uint32_t un ,deux;
-uint64_t size=0;
-uint8_t c,d;
-uint8_t align=0;
-
-                *substream=0xff;
-                *opts=ADM_NO_PTS;
-                *odts=ADM_NO_PTS;
-
-
-                size=parser->read16i();
-                if((stream==PADDING_CODE) ||
-                	 (stream==PRIVATE_STREAM_2)
-                        ||(stream==SYSTEM_START_CODE) //?
-                        ) // special case, no header
-                        {
-                                *olen=size;
-                                return 1;
-                        }
-
-                        //      remove padding if any
-
-                while((c=parser->read8i()) == 0xff)
-                {
-                        size--;
-                }
-//----------------------------------------------------------------------------
-//-------------------------------MPEG-2 PES packet style----------------------
-//----------------------------------------------------------------------------
-                if(((c&0xC0)==0x80))
-                {
-                        uint32_t ptsdts,len;
-                        //printf("\n mpeg2 type \n");
-                        //_muxTypeMpeg2=1;
-                        // c= copyright and stuff
-                        //printf(" %x align\n",c);
-                        if(c & 4) align=1;
-                        c=parser->read8i();     // PTS/DTS
-                        //printf("%x ptsdts\n",c
-                        ptsdts=c>>6;
-                        // header len
-                        len=parser->read8i();
-                        size-=3;
-
-                        switch(ptsdts)
-                        {
-                                case 2: // PTS=1 DTS=0
-                                        if(len>=5)
-                                        {
-                                                uint64_t pts1,pts2,pts0;
-                                                //      printf("\n PTS10\n");
-                                                        pts0=parser->read8i();
-                                                        pts1=parser->read16i();
-                                                        pts2=parser->read16i();
-                                                        len-=5;
-                                                        size-=5;
-                                                        *opts=(pts1>>1)<<15;
-                                                        *opts+=pts2>>1;
-                                                        *opts+=(((pts0&6)>>1)<<30);
-                                        }
-                                        break;
-                                case 3: // PTS=1 DTS=1
-                                                #define PTS11_ADV 10 // nut monkey
-                                                if(len>=PTS11_ADV)
-                                                {
-                                                        uint32_t skip=PTS11_ADV;
-                                                        uint64_t pts1,pts2,dts,pts0;
-                                                                //      printf("\n PTS10\n");
-                                                                pts0=parser->read8i();
-                                                                pts1=parser->read16i();
-                                                                pts2=parser->read16i();
-
-                                                                *opts=(pts1>>1)<<15;
-                                                                *opts+=pts2>>1;
-                                                                *opts+=(((pts0&6)>>1)<<30);
-                                                                pts0=parser->read8i();
-                                                                pts1=parser->read16i();
-                                                                pts2=parser->read16i();
-                                                                dts=(pts1>>1)<<15;
-                                                                dts+=pts2>>1;
-                                                                dts+=(((pts0&6)>>1)<<30);
-                                                                len-=skip;
-                                                                size-=skip;
-                                                                *odts=dts;
-                                                                        //printf("DTS: %lx\n",dts);
-                                                   }
-                                                   break;
-                                case 1:
-                                                return 0;//ADM_assert(0); // forbidden !
-                                                break;
-                                case 0:
-                                                // printf("\n PTS00\n");
-                                                break; // no pts nor dts
-
-
-                        }
-// Extension bit
-// >stealthdave<
-
-                        // Skip remaining headers if any
-                        if(len)
-                        {
-                                parser->forward(len);
-                                size=size-len;
-                        }
-
-                if(stream==PRIVATE_STREAM_1)
-                {
-                        if(size>5)
-                        {
-                        // read sub id
-                               *substream=parser->read8i();
-  //                    printf("\n Subid : %x",*subid);
-                                switch(*substream)
-                                {
-                                // DTS
-                                        case 0x88:case 0x89:case 0x8A:case 0x8B:
-
-                                                *substream=*substream-0x48;
-                                                break;
-
-                                //AC3
-                                        case 0x80:case 0x81:case 0x82:case 0x83:
-                                        case 0x84:case 0x85:case 0x86:case 0x87:
-                                                *substream=*substream-0x80;
-                                                break;
-                                // PCM
-                                        case 0xA0:case 0xA1:case 0xa2:case 0xa3:
-                                        case 0xA4:case 0xA5:case 0xa6:case 0xa7:
-                                                // we have an additionnal header
-                                                // of 3 bytes
-                                                parser->forward(3);
-                                                size-=3;
-                                                break;
-                                // Subs
-                                case 0x20:case 0x21:case 0x22:case 0x23:
-                                case 0x24:case 0x25:case 0x26:case 0x27:
-                                                break;
-
-                                default:
-                                                printf("Unkown substream %x\n",*substream);
-                                                *substream=0xff;
-                                }
-                                // skip audio header (if not sub)
-                                if(*substream>0x26 || *substream<0x20)
-                                {
-                                        parser->forward(3);
-                                        size-=3;
-                                }
-                                size--;
-                        }
-                }
-               //    printf(" pid %x size : %x len %x\n",sid,size,len);
-                *olen=size;
-                return 1;
-        }
-//----------------------------------------------------------------------------------------------
-//-------------------------------MPEG-1 PES packet style----------------------
-//----------------------------------------------------------------------------------------------
-           if(0) //_muxTypeMpeg2)
-                {
-                        printf("*** packet type 1 inside type 2 ?????*****\n");
-                        return 0; // mmmm
-                }
-          // now look at  STD buffer size if present
-          // 01xxxxxxxxx
-          if ((c>>6) == 1)
-          {       // 01
-                        size-=2;
-                        parser->read8i();                       // skip one byte
-                        c=parser->read8i();   // then another
-           }
-           // PTS/DTS
-           switch(c>>4)
-           {
-                case 2:
-                {
-                        // 0010 xxxx PTS only
-                        uint64_t pts1,pts2,pts0;
-                                        size -= 4;
-                                        pts0=(c>>1) &7;
-                                        pts1=parser->read16i()>>1;
-                                        pts2=parser->read16i()>>1;
-                                        *opts=pts2+(pts1<<15)+(pts0<<30);
-                                        break;
-                  }
-                  case 3:
-                  {               // 0011 xxxx
-                        uint64_t pts1,pts2,pts0;
-                                        size -= 9;
-
-                                        pts0=(c>>1) &7;
-                                        pts1=parser->read16i()>>1;
-                                        pts2=parser->read16i()>>1;
-                                        *opts=pts2+(pts1<<15)+(pts0<<30);
-                                        parser->forward(5);
-                   }
-                   break;
-
-                case 1:
-                        // 0001 xxx
-                        // PTSDTS=01 not allowed
-                                return 0;
-                                break;
-                }
-
-
-                if(!align)
-                        size--;
-        *olen=size;
-        return 1;
-}

Deleted: branches/avidemux_2.6_branch_mean/avidemux/ADM_coreDemuxerMpeg/src/dmx_demuxerTS.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/ADM_coreDemuxerMpeg/src/dmx_demuxerTS.cpp	2009-02-10 16:00:26 UTC (rev 4582)
+++ branches/avidemux_2.6_branch_mean/avidemux/ADM_coreDemuxerMpeg/src/dmx_demuxerTS.cpp	2009-02-11 06:27:26 UTC (rev 4583)
@@ -1,843 +0,0 @@
-/***************************************************************************
-                          TS demuxer
-                             -------------------
-
-    copyright            : (C) 2005 by mean
-    email                : fixounet at free.fr
-
-        Here we try to read a whole PES packet at a time...
-        So we concatenate all TS packet to get it
-        Else it is a pain to handle potentiel padding bytes
-
-        A special case, if the PES size is 0, it means it is an unbound
-        PES packet, and so the demuxer must guess the size when encountering
-        the next TS packet having the payload unit flag
-        It is a way to overcome the 64k size limit of the PES packetization
-        In that case the padding must be in the adaptation layer bytes.
-
-
- ***************************************************************************/
-
-/***************************************************************************
- *                                                                         *
- *   This program is free software; you can redistribute it and/or modify  *
- *   it under the terms of the GNU General Public License as published by  *
- *   the Free Software Foundation; either version 2 of the License, or     *
- *   (at your option) any later version.                                   *
- *                                                                         *
- ***************************************************************************/
-
-#include <string.h>
-#include <math.h>
-
-#include "ADM_default.h"
-
-//#define TS_VERBOSE 1
-
-#include "dmx_mpegstartcode.h"
-#include "dmx_demuxerTS.h"
-uint8_t         dmx_demuxerTS::changePid(uint32_t newpid,uint32_t newpes)
-{
-          myPid=newpid;
-          // Be sure our new Pid is taken care of
-          allPid[newpid]=1;
-
-        _pesBufferStart=0;  // Big value so that we read
-        _pesBufferLen=0;
-        _pesBufferIndex=0;
-}
-dmx_demuxerTS::dmx_demuxerTS(uint32_t nb,MPEG_TRACK *tracks,uint32_t psi,DMX_TYPE muxType)
-{
-        consumed=0;
-        parser=new fileParser();
-        stampAbs=0;
-        _pesBuffer=new uint8_t [MAX_TS_BUFFER];
-
-        memset(seen,0,sizeof(seen));
-        memset(allPid,0,sizeof(allPid));
-        _pesBufferStart=0;  // Big value so that we read
-        _pesBufferLen=0;
-        _pesBufferIndex=0;
-        ADM_assert(nb>0);
-        tracked=NULL;
-        nbTracked=nb;
-        myPid=tracks[0].pid; // For mpeg TS we use the PID field as the PES field is irrelevant
-        printf("Ts: Using %x as pid for track 0\n",myPid);
-
-        // Build reverse lookup
-        if(nb==TS_ALL_PID)
-                for(int i=0;i<nb;i++)
-                    allPid[ i ]=1+i;
-        else
-                for(int i=0;i<nb;i++)
-                {
-                        allPid[ tracks[i].pid ]=1+i;
-                }
-
-        _probeSize=0;
-        packMode=0;
-        packLen=0;
-        isPsi=psi;
-        switch(muxType)
-        {
-          case DMX_MPG_TS: TS_PacketSize=TS_PACKET_SIZE;break;
-          case DMX_MPG_TS2: TS_PacketSize=TS2_PACKET_SIZE;break;
-          default: ADM_assert(0);
-        }
-        printf("Creating mpeg TS demuxer  main Pid: %X , pes id :%x, packet size=%u\n",myPid,tracks[0].pes,TS_PacketSize);
-}
-dmx_demuxerTS::~dmx_demuxerTS()
-{
-        if(parser) delete parser;
-        parser=NULL;
-        if(_pesBuffer) delete [] _pesBuffer;
-        _pesBuffer=NULL;
-        if(tracked) delete [] tracked;
-        tracked=NULL;
-}
-/*
-        Get stats about the PES ids tracked in tracked order
-        if nbTracked=256 it means tracks all possible PES id
-        The 0 rank is video
-*/
-uint8_t       dmx_demuxerTS::getStats(uint64_t *oseen)
-{
-        for(int i=0;i<nbTracked;i++)
-        {
-                oseen[i]=seen[i];
-        }
-        return 1;
-}
-uint8_t dmx_demuxerTS::setProbeSize(uint32_t sz)
-{
-		_probeSize=sz;
-		return 1;
-}
-uint8_t dmx_demuxerTS::open(const char *name)
-{
-FP_TYPE fp=FP_DONT_APPEND;
-
-        if(! parser->open(name,&fp)) return 0;
-        _size=parser->getSize();
-        return 1;
-}
-uint8_t dmx_demuxerTS::forward(uint32_t f)
-{
-uint32_t left;
-        if(_pesBufferIndex+f<=_pesBufferLen)
-        {
-                _pesBufferIndex+=f;
-                consumed+=f;
-                return 1;
-        }
-        // else read another packet
-        left=_pesBufferLen-_pesBufferIndex;
-        f-=left;
-        consumed+=left;
-        if(!refill()) return 0;
-        return forward(f);
-}
-uint8_t  dmx_demuxerTS::stamp(void)
-{
-        consumed=0;
-}
-uint64_t dmx_demuxerTS::elapsed(void)
-{
-        return consumed;
-}
-uint8_t  dmx_demuxerTS::getPos( uint64_t *abs,uint64_t *rel)
-{
-        *rel=_pesBufferIndex;
-        *abs=_pesBufferStart;
-        return 1;
-}
-uint8_t dmx_demuxerTS::setPos( uint64_t abs,uint64_t  rel)
-{
-        // Still in same packet ?
-        if(abs==_pesBufferStart && _pesBufferLen)
-        {
-                if(_pesBufferLen<rel)
-                {
-                        printf("Asked setpos to go %"LLU" whereas %"LU" is max\n",
-                                rel,_pesBufferLen);
-                        ADM_assert(rel<_pesBufferLen);
-                }
-
-                _pesBufferIndex=rel;
-                return 1;
-        }
-        // There is a risk we don't get the PES start for that
-        //
-        packMode=0;
-        if(!parser->setpos(abs))
-        {
-                printf("DMX_TS: setPos failed\n");
-                return 0;
-        }
-        _pesBufferStart=abs;
-        if(!refill())
-        {
-                printf("DMX_TS: refill failed\n");
-                return 0;
-        }
-
-        if(rel>_pesBufferLen)
-        {
-                printf("Set pos failed : asked rel:%"LLU" max: %"LU", absPos:%"LLU" absPosafterRefill:%"LLU"\n",
-                                        rel,_pesBufferLen,abs,_pesBufferStart);
-                ADM_assert(rel<_pesBufferLen);
-        }
-
-        _pesBufferIndex=rel;
-        return 1;
-}
-/*
-        Sync on mpeg sync word, returns the sync point in abs/r
-*/
-
-
-uint32_t         dmx_demuxerTS::read(uint8_t *w,uint32_t len)
-{
-uint32_t mx;
-                // enough in buffer ?
-                if(_pesBufferIndex+len<=_pesBufferLen)
-                {
-                        memcpy(w,_pesBuffer+_pesBufferIndex,len);
-                        _pesBufferIndex+=len;
-                        consumed+=len;
-                        return len;
-                }
-                // flush
-                mx=_pesBufferLen-_pesBufferIndex;
-                if(mx)
-                {
-                        memcpy(w,_pesBuffer+_pesBufferIndex,mx);
-                        _pesBufferIndex+=mx;
-                        consumed+=mx;
-                        w+=mx;
-                        len-=mx;
-                }
-                if(!refill())
-                {
-                        _lastErr=1;
-                         return mx;
-                }
-                return mx+read(w,len);
-}
-uint8_t         dmx_demuxerTS::sync( uint8_t *stream,uint64_t *abs,uint64_t *r,uint64_t *pts,uint64_t *dts)
-{
-uint32_t val,hnt;
-retry:
-         *r=0;
-
-                val=0;
-                hnt=0;
-
-                // preload
-                hnt=(read8i()<<16) + (read8i()<<8) +read8i();
-                if(_lastErr)
-                {
-                        _lastErr=0;
-                        printf("\n io error , aborting sync\n");
-                        return 0;
-                }
-
-                while((hnt!=0x00001))
-                {
-
-                        hnt<<=8;
-                        val=read8i();
-                        hnt+=val;
-                        hnt&=0xffffff;
-
-                        if(_lastErr)
-                        {
-                             _lastErr=0;
-                            printf("\n io error , aborting sync\n");
-                            return 0;
-                         }
-
-                }
-
-                *stream=read8i();
-                // Case 1 : assume we are still in the same packet
-                if(_pesBufferIndex>=4)
-                {
-                        *abs=_pesBufferStart;
-                        *r=_pesBufferIndex-4;
-                        *pts=_pesPTS;
-                        *dts=_pesDTS;
-                }
-                else
-                {       // pick what is needed from oldPesStart etc...
-                        // since the beginning in the previous packet
-                        uint32_t left=4-_pesBufferIndex;
-                                 if(left>_oldPesLen)
-                                 { // previous Packet which len is very shoty
-                                   // Ignore
-                                   _pesBufferIndex=0;
-                                   printf("Ignoring too short packet");
-                                   goto retry;
-                                 }
-                                 left=_oldPesLen-left;
-#if 0
-                                 printf("Next packet : %I64X Len :%"LU", using previous packet %I64X len:%u as pos=%"LU"\n",
-                                 		_pesBufferStart,_pesBufferLen,_oldPesStart,_oldPesLen,_pesBufferIndex);
-#endif
-                                 if(left>_oldPesLen)
-                                {
-                                        printf("Need %"LU" bytes from previous packet, which len is %"LU"\n",left,_oldPesLen);
-                                        ADM_assert(0);
-                                }
-                                *abs=_oldPesStart;
-                                *r=left;
-                                *pts=_oldPTS;
-                                *dts=_oldDTS;
-                }
-                return 1;
-}
-/**
-      \fn readPes
-      \brief Read a complete PES packet
-*/
-uint8_t dmx_demuxerTS::readPes(uint8_t *data, uint32_t *pesBlockLen, uint32_t *dts,uint32_t *pts)
-{
-  uint32_t total=0;
-    if(!refill())
-    {
-      printf("[DMX] Refill failed\n");
-      return 0;
-    }
-    *dts=_pesDTS;
-    *pts=_pesPTS;
-    total=_pesBufferLen;
-    memcpy(data,_pesBuffer,_pesBufferLen);
-    while(packLen)
-    {
-        if(!refill())
-        {
-          printf("[DMX] Refill failed\n");
-          return 0;
-        }
-
-        memcpy(data+total,_pesBuffer,_pesBufferLen);
-        total+=_pesBufferLen;
-
-    }
-    *pesBlockLen=total;
-    printf("[DMX] Read %d bytes, packMode %u, pesLen %u\n",*pesBlockLen,packMode,packLen);
-    return 1;
-}
-//
-//      Refill the pesBuffer
-//              Read packet of correct PID, locate a PES start and read the whole PES packet
-//              It cannot be bigger than 64 k in bound mode, in that case packMode=1, packLen is the leftover to read
-//
-//
-uint8_t dmx_demuxerTS::refill(void)
-{
-uint32_t consumed,len,pid,payload=0;
-uint8_t  stream,substream;
-uint64_t count,abs,pts,dts,first;
-uint32_t left,cc,lenPes;
-
-        _pesBufferIndex=0;
-
-
-_againBranch:
-        while(1)
-        {
-                if(!readPacket(&pid,&left, &payload,&abs,&cc))
-                {
-                        printf("dmxTs: Cannot read packet (1) at %"LLX"\n",abs);
-                        return 0;
-                }
-                if(allPid[pid])
-                        break;
-                parser->forward(left); // Else skip packet
-        }
-
-        if(!payload) // Take as is...
-        {
-                if(pid==myPid)
-                {
-                        // No payloadStart, read it raw
-                        _oldPesStart=_pesBufferStart;
-                        _oldPesLen=_pesBufferLen;
-                        _pesBufferStart=abs;
-
-                        parser->read32(left,_pesBuffer);
-                        // FIXME HACK
-                        if(TS_PacketSize==192 && left >4)
-                          {
-                            left-=4; // Remove timestamp of m2ts packet
-                          }
-                       // FIXME HACK
-                        _pesBufferLen=left;
-
-
-                        _pesPTS=ADM_NO_PTS;
-                        _pesDTS=ADM_NO_PTS;
-                        // If we are in pack mode, cut padding bits
-                        if(packMode)
-                        {
-                                if(packLen<left)
-                                {
-#if 1 //def 1  TS_VERBOSE
-                                        printf("Dropping some bytes : %"LU" / %"LU"\n",_pesBufferLen,packLen);
-#endif
-                                         _pesBufferLen=packLen;
-                                }
-#if 0
-                                printf("at %llx, packLen=%"LU" minus %"LU"\n",_pesBufferStart,packLen,_pesBufferLen);
-#endif
-                                packLen-=_pesBufferLen;
-
-                                if(!packLen)
-                                {
-                                  packMode=0;
-                                }
-                        }
-                        return 1;
-                }
-                // Udate info on that track
-                updateTracker(pid,left);
-                parser->forward(left);
-                goto _againBranch;
-        }
-        // Payload present, read header
-#ifdef TS_VERBOSE
-        parser->getpos(&first);
-        printf("BF: left:%"LU" delta :%"LLU"\n",left,first-abs);
-#endif
-        if(pid==myPid && isPsi)
-        {
-                if(!getInfoPSI(&consumed,&lenPes))
-                        goto _againBranch;
-                if(left<consumed)
-                        goto _againBranch;
-                left-=consumed;
-                _pesBufferStart=abs;
-
-
-                _pesPTS=ADM_NO_PTS;
-                _pesDTS=ADM_NO_PTS;
-
-                parser->read32(left,_pesBuffer);
-                 // FIXME HACK
-                if(TS_PacketSize==192 && left >4)
-                  {
-                    left-=4; // Remove timestamp of m2ts packet
-                  }
-                _pesBufferLen=left;
-                 // FIXME HACK
-                return 1;
-        }
-
-
-        if(!getInfoPES(&consumed,&dts,&pts,&stream,&substream,&lenPes))
-        {
-                        printf("dmxTs: get info failed at %"LLX"\n",abs);
-                        goto _againBranch;
-        }
-#ifdef TS_VERBOSE
-        printf("Stream :%x found at %"LLX" size :%"LU"\n",stream,abs,lenPes);
-        parser->getpos(&count);
-        printf("consumed :%"LU" left:%"LU" delta :%"LLU"\n",consumed,left,count-first);
-        if(count-first!=consumed) printf("*** PES header length is wrong***\n");
-
-#endif
-        if(consumed>left)
-        {
-                printf("Wrong PES header at %"LLX" %"LU" / %"LU"\n",abs,consumed,left);
-                goto _againBranch;
-        }
-
-        left-=consumed;
-        if(myPid==pid)
-        {
-                if(lenPes)
-                {
-                        packMode=1;
-                        packLen=lenPes;
-                }
-                else
-                {
-                        packMode=0;
-                }
-
-                _oldPesStart=_pesBufferStart;
-                _oldPesLen=_pesBufferLen;
-
-                _pesBufferStart=abs;
-
-
-                _pesPTS=pts;
-                _pesDTS=dts;
-
-                parser->read32(left,_pesBuffer);
-                  // FIXME HACK
-                if(TS_PacketSize==192 && left >4)
-                  {
-                    left-=4; // Remove timestamp of m2ts packet
-                  }
-                _pesBufferLen=left;
-                if(packMode)
-                {
-                        if(packLen<left) _pesBufferLen=packLen;
-                        packLen-=_pesBufferLen;
-                        if(!packLen) packMode=0;
-                }
-                return 1;
-        }
-        // update info
-        updateTracker(pid,left);
-        parser->forward(left);
-        goto _againBranch;
-}
-//***********************************
-// Read a Ts packet and extract
-// interesting infos
-//***********************************
-uint8_t dmx_demuxerTS::readPacket(uint32_t *opid,uint32_t *oleft, uint32_t *isPayloadStart,uint64_t *ostart,uint32_t *occ)
-{
-uint32_t consumed,len,pid,payloadunit=0,discarded;
-uint64_t count,abs;
-uint32_t left;
-uint8_t  byte1,byte2;
-        parser->getpos(&count);
-#ifdef TS_VERBOSE
-        printf("Starting sync at %"LLX"\n",count);
-#endif
-_again:
-        payloadunit=0;
-        parser->getpos(&count);
-        count=_size-count;
-        discarded=0;
-        while(parser->read8i()!=0x47 && count>TS_PacketSize)
-                {
-                        discarded++;
-                        count--;
-                }
-        if(count<TS_PacketSize)
-        {
-                printf("DmxTS: cannot sync (EOF reached) \n");
-                _lastErr=1;
-                return 0;
-        }
-        // Check that there is a 0x47 later on...
-        parser->getpos(&abs);
-        if(discarded) // We did not have a continuous sync, check 2 more packet boundaries..
-        {
-
-                parser->forward(TS_PacketSize-1);
-                byte1=parser->read8i();
-                parser->forward(TS_PacketSize-1);
-                byte2=parser->read8i();
-                parser->setpos(abs);  // The setpos/getpos is mostly free due to the parser large buffer
-                if(byte1!=0x47 || byte2!=0x47) goto _again;
-        }
-#ifdef TS_VERBOSE
-        printf("Sync at %"LLX"\n",abs-1);
-#endif
-        // Memorize where it starts
-        *ostart=abs-1;
-        // Read Pid etc...
-        pid=parser->read16i();
-        if((pid>>8) & TS_UNIT_START) payloadunit=1;
-        pid&=0x1fff; // remove flags
-        if(discarded)
-                printf("Ts: Discontinuity of %"LU" at %"LLX" pid:%"LX"\n",discarded,abs,pid);
-        // Start of packet..
-        left=TS_PacketSize-3;
-        if(_probeSize)
-        {
-                if(abs>_probeSize)
-                {
-                		printf("dmxTs:Probe exceeded\n");
-                		return 0;
-                }
-        }
-        // Ok now get some informations....
-        // only interested in my Pid & user data Pid
-        if(pid!=myPid && pid<0x10)
-        {
-                parser->forward(left);
-                goto _again;
-        }
-        // One of the stream we are looking for ?
-        if(!allPid[pid])
-        {
-                parser->forward(left);
-                goto _again; // No
-        }
-        // Remove header if any
-
-        int cc,val,adaptation;
-        // Flags : adaptation layer + continuity counter etc...
-        val=parser->read8i();
-        left--;
-        cc=val & 0xf;
-        adaptation=(val >>4)&0x3;
-        if(!(adaptation & 1)) // no payload
-        {
-                parser->forward(left);
-                goto _again;
-        }
-        if(adaptation & 2) // There is an adaptation field
-        {
-                val=parser->read8i();
-                left--;
-                if(val>=left)
-                {
-                 printf("Wrong adaptation layer size at %"LLX" size=%"LU", bytes left = %"LU" pid=%"LX"\n",abs,val,left,pid);
-                 goto _again; // need to search..
-                }
-                parser->forward(val); // skip adaptation field
-                left-=val;
-        }
-        // Ok now we got the raw data packet
-        *oleft=left;
-        *opid=pid;
-        *occ=cc;
-
-        if(payloadunit) // A PSI or PES packet starts here
-        {
-                *isPayloadStart=1;
-        }else
-                *isPayloadStart=0;
-        return 1;
-}
-/*
-        Retrieve info about the packet we just met
-        It is assumed that parser is just after the packet startcode
-
-*/
-uint8_t       dmx_demuxerTS::updateTracker(uint32_t trackerPid,uint32_t nbData)
-{
-        seen[(allPid[trackerPid])-1]+=nbData;
-        return 1;
-}
-
-uint8_t       dmx_demuxerTS::getInfoPES(uint32_t *oconsumed,uint64_t *odts,uint64_t *opts,
-                                        uint8_t *ostream,uint8_t *substream,
-                                        uint32_t *olen)
-{
-
-uint32_t headconsumd=0;
-int size=0,nulsize=0;
-uint8_t c,d;
-uint8_t align=0;
-                *oconsumed=0;
-
-                // Check it looks like a PES header
-                // It could be a PSI header ...
-                if(parser->read8i()) return 0;
-                if(parser->read8i()) return 0;
-                if(parser->read8i()!=1) return 0;
-                *ostream=parser->read8i(); // Stream
-                headconsumd=4;
-//
-
-                *substream=0xff;
-                *opts=ADM_NO_PTS;
-                *odts=ADM_NO_PTS;
-
-
-                size=parser->read16i();
-                headconsumd+=2;
-                if(!size) nulsize=1;
-                if((*ostream==PADDING_CODE) ||
-                	 (*ostream==PRIVATE_STREAM_2)
-                        ||(*ostream==SYSTEM_START_CODE) //?
-                        ) // special case, no header
-                        {
-                                if(nulsize) size=0;
-                                *olen=size;
-                                *oconsumed=headconsumd;
-                                return 1;
-                        }
-
-                        //      remove padding if any
-
-                while((c=parser->read8i()) == 0xff)
-                {
-                        headconsumd++;
-                        size--;
-                }
-//----------------------------------------------------------------------------
-//-------------------------------MPEG-2 PES packet style----------------------
-//----------------------------------------------------------------------------
-                if(((c&0xC0)!=0x80))
-                {
-                        printf("DmxTs: Not mpeg2 PES!\n");
-                        return 0;
-                }
-
-                        uint32_t ptsdts,len;
-                        //printf("\n mpeg2 type \n");
-                        //_muxTypeMpeg2=1;
-                        // c= copyright and stuff
-                        //printf(" %x align\n",c);
-                        if(c & 4) align=1;
-                        c=parser->read8i();     // PTS/DTS
-                        //printf("%x ptsdts\n",c
-                        ptsdts=c>>6;
-                        // header len
-                        len=parser->read8i();
-                        size-=3;
-                        headconsumd+=3;
-
-                        switch(ptsdts)
-                        {
-                                case 2: // PTS=1 DTS=0
-                                        if(len>=5)
-                                        {
-                                                uint64_t pts1,pts2,pts0;
-                                                //      printf("\n PTS10\n");
-                                                        pts0=parser->read8i();
-                                                        pts1=parser->read16i();
-                                                        pts2=parser->read16i();
-                                                        len-=5;
-                                                        size-=5;
-                                                        headconsumd+=5;
-                                                        *opts=(pts1>>1)<<15;
-                                                        *opts+=pts2>>1;
-                                                        *opts+=(((pts0&6)>>1)<<30);
-                                        }
-                                        break;
-                                case 3: // PTS=1 DTS=1
-                                                #define PTS11_ADV 10 // nut monkey
-                                                if(len>=PTS11_ADV)
-                                                {
-                                                        uint32_t skip=PTS11_ADV;
-                                                        uint64_t pts1,pts2,dts,pts0;
-                                                                //      printf("\n PTS10\n");
-                                                                pts0=parser->read8i();
-                                                                pts1=parser->read16i();
-                                                                pts2=parser->read16i();
-
-                                                                *opts=(pts1>>1)<<15;
-                                                                *opts+=pts2>>1;
-                                                                *opts+=(((pts0&6)>>1)<<30);
-                                                                pts0=parser->read8i();
-                                                                pts1=parser->read16i();
-                                                                pts2=parser->read16i();
-                                                                dts=(pts1>>1)<<15;
-                                                                dts+=pts2>>1;
-                                                                dts+=(((pts0&6)>>1)<<30);
-                                                                len-=skip;
-                                                                size-=skip;
-                                                                *odts=dts;
-                                                                headconsumd+=10;
-                                                                        //printf("DTS: %lx\n",dts);
-                                                   }
-                                                   break;
-                                case 1:
-                                                return 0;//ADM_assert(0); // forbidden !
-                                                break;
-                                case 0:
-                                                // printf("\n PTS00\n");
-                                                break; // no pts nor dts
-
-
-                        }
-// Extension bit
-// >stealthdave<
-
-                        // Skip remaining headers if any
-                        if(len)
-                        {
-                                parser->forward(len);
-                                size=size-len;
-                                headconsumd+=len;
-                        }
-
-
-               //    printf(" pid %x size : %x len %x\n",sid,size,len);
-                if(nulsize) size=0;
-                *olen=size;
-                *oconsumed=headconsumd;
-                return 1;
-}
-uint8_t dmx_demuxerTS::getInfoPSI(uint32_t *oconsumed,uint32_t *olen)
-{
-        *oconsumed=*olen=0;
-        return 1;
-
-}
-/**
-      \fn    syncH264
-      \brief Search H264 startcode in the stream
-*/
-uint8_t         dmx_demuxerTS::syncH264( uint8_t *stream,uint64_t *abs,uint64_t *r,uint64_t *pts,uint64_t *dts)
-{
-uint32_t val,hnt;
-retry:
-         *r=0;
-
-                val=0;
-                hnt=0;
-
-                // preload
-                hnt=(read8i()<<24) + (read8i()<<16) +(read8i()<<8)+(read8i());
-                if(_lastErr)
-                {
-                        _lastErr=0;
-                        printf("\n io error , aborting sync\n");
-                        return 0;
-                }
-
-                while((hnt!=1))
-                {
-
-                        hnt<<=8;
-                        val=read8i();
-                        hnt+=val;
-
-                        if(_lastErr)
-                        {
-                             _lastErr=0;
-                            printf("\n io error , aborting sync\n");
-                            return 0;
-                         }
-
-                }
-
-                *stream=read8i();
-                // Case 1 : assume we are still in the same packet
-                if(_pesBufferIndex>=5)
-                {
-                        *abs=_pesBufferStart;
-                        *r=_pesBufferIndex-5;
-                        *pts=_pesPTS;
-                        *dts=_pesDTS;
-                }
-                else
-                {       // pick what is needed from oldPesStart etc...
-                        // since the beginning in the previous packet
-                        uint32_t left=5-_pesBufferIndex;
-                                 if(left>_oldPesLen)
-                                 { // previous Packet which len is very shoty
-                                   // Ignore
-                                   _pesBufferIndex=0;
-                                   printf("Ignoring too short packet");
-                                   goto retry;
-                                 }
-                                 left=_oldPesLen-left;
-#if 0
-                                 printf("Next packet : %I64X Len :%"LU", using previous packet %I64X len:%u as pos=%"LU"\n",
-                                 		_pesBufferStart,_pesBufferLen,_oldPesStart,_oldPesLen,_pesBufferIndex);
-#endif
-                                 if(left>_oldPesLen)
-                                {
-                                        printf("Need %"LU" bytes from previous packet, which len is %"LU"\n",left,_oldPesLen);
-                                        ADM_assert(0);
-                                }
-                                *abs=_oldPesStart;
-                                *r=left;
-                                *pts=_oldPTS;
-                                *dts=_oldDTS;
-                }
-                return 1;
-}

Modified: branches/avidemux_2.6_branch_mean/avidemux/ADM_coreDemuxerMpeg/src/dmx_io.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/ADM_coreDemuxerMpeg/src/dmx_io.cpp	2009-02-10 16:00:26 UTC (rev 4582)
+++ branches/avidemux_2.6_branch_mean/avidemux/ADM_coreDemuxerMpeg/src/dmx_io.cpp	2009-02-11 06:27:26 UTC (rev 4583)
@@ -22,9 +22,9 @@
 #include <math.h>
 
 #include "ADM_default.h"
-
 #include "dmx_io.h"
 
+#define aprintf(...) {}
 
 fileParser::fileParser( void )
 {
@@ -55,6 +55,7 @@
         }
         if(_buffer) delete [] _buffer;
         _buffer=NULL;
+        _nbFd=0;
 }
 
 /*
@@ -102,7 +103,7 @@
         // no number sequence
         if( decimals == 0 )
         {
-                printf( "\nSimple loading: \n" );
+                aprintf( "\nSimple loading: \n" );
                 delete [] followup;
                 _nbFd = 1;
                 _curFd = 0;
@@ -120,9 +121,9 @@
                 fseeko( _fd[0], 0, SEEK_SET );
                 _sizeFdCumul[0]=0;
                 _size=_sizeFd[0];
-                printf( " file: %s, size: %"LLU"\n", filename, _sizeFd[0] );
-                printf( " found 1 files \n" );
-                printf( "Done \n" );
+                aprintf( " file: %s, size: %"LLU"\n", filename, _sizeFd[0] );
+                aprintf( " found 1 files \n" );
+                aprintf( "Done \n" );
                 return 1;
         }
 
@@ -154,7 +155,7 @@
                 buffer_fd = new FILE * [tabSize];
                 buffer_sizeFd = new uint64_t [tabSize];
 
-                printf( "\nAuto adding: \n" );
+                aprintf( "\nAuto adding: \n" );
                 while( last_followup == 0 )
                 {
                         strcpy( followup, left );
@@ -177,7 +178,7 @@
                         buffer_sizeFd[count] = ftello( buffer_fd[count] );
                         fseeko( buffer_fd[count], 0, SEEK_SET );
 
-                        printf( " file %d: %s, size: %"LLU"\n", (count + 1), followup, buffer_sizeFd[count] );
+                        aprintf( " file %d: %s, size: %"LLU"\n", (count + 1), followup, buffer_sizeFd[count] );
 
                         // increase number
                         number[decimals - 1] = number[decimals - 1] + 1;
@@ -226,8 +227,8 @@
                                 *multi=FP_DONT_APPEND;
                 }
 
-                printf( " found %d files \n", count );
-                printf( "Done \n" );
+                aprintf( " found %d files \n", count );
+                aprintf( "Done \n" );
         } // if( decimals == 0 )
                 return 1;
 } // fileParser::open()
@@ -305,7 +306,7 @@
         // preload
         if((4+_off)>=_size)
         {
-                printf("Dmx IO: End of file met (%"LLU" / %"LLU" seg%"LU")\n",_off,_size,_nbFd);
+                printf("Dmx IO: End of file met (%"LLU" / %"LLU" seg:%"LU")\n",_off,_size,_nbFd);
                 return 0;
         }
         hnt=(read8i()<<16) + (read8i()<<8) +read8i();
@@ -338,7 +339,7 @@
         // preload
         if((5+_off)>=_size)
         {
-                printf("Dmx IO: End of file met (%"LLU" / %"LLU" seg%"LU")\n",_off,_size,_nbFd);
+                printf("Dmx IO: End of file met (%"LLU" / %"LLU" seg:%"LU")\n",_off,_size,_nbFd);
                 return 0;
         }
         hnt=(read8i()<<24)+(read8i()<<16) + (read8i()<<8) +read8i();
@@ -500,3 +501,40 @@
         return r;
 }
 #endif
+
+void fileParser::hexDump(uint8_t *buf, int size)
+{
+	int len, i, j, c;
+
+	for(i=0;i<size;i+=16)
+	{
+		len = size - i;
+
+		if (len > 16)
+			len = 16;
+
+		printf("%08x ", i);
+
+		for(j=0;j<16;j++)
+		{
+			if (j < len)
+				printf(" %02x", buf[i+j]);
+			else
+				printf("   ");
+		}
+
+		printf(" ");
+
+		for(j=0;j<len;j++)
+		{
+			c = buf[i+j];
+
+			if (c < ' ' || c > '~')
+				c = '.';
+
+			printf("%c", c);
+		}
+
+		printf("\n");
+	}
+}

Modified: branches/avidemux_2.6_branch_mean/avidemux/CMakeLists.txt
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/CMakeLists.txt	2009-02-10 16:00:26 UTC (rev 4582)
+++ branches/avidemux_2.6_branch_mean/avidemux/CMakeLists.txt	2009-02-11 06:27:26 UTC (rev 4583)
@@ -344,8 +344,8 @@
 ADD_LIB_ALL_TARGETS(ADM_coreAudio)
 ADD_SUBDIRECTORY(ADM_coreDemuxer)
 ADD_LIB_ALL_TARGETS(ADM_coreDemuxer)
-#ADD_SUBDIRECTORY(ADM_coreDemuxerMpeg)
-#ADD_LIB_ALL_TARGETS(ADM_coreDemuxerMpeg)
+ADD_SUBDIRECTORY(ADM_coreDemuxerMpeg)
+ADD_LIB_ALL_TARGETS(ADM_coreDemuxerMpeg)
 ADD_SUBDIRECTORY(ADM_coreAudioDevice)
 ADD_LIB_ALL_TARGETS(ADM_coreAudioDevice)
 ADD_SUBDIRECTORY(ADM_coreUtils)

Deleted: branches/avidemux_2.6_branch_mean/plugins/ADM_demuxers/MpegPS/ADM_indexFile.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/plugins/ADM_demuxers/MpegPS/ADM_indexFile.cpp	2009-02-10 16:00:26 UTC (rev 4582)
+++ branches/avidemux_2.6_branch_mean/plugins/ADM_demuxers/MpegPS/ADM_indexFile.cpp	2009-02-11 06:27:26 UTC (rev 4583)
@@ -1,238 +0,0 @@
-/**
-    \file ADM_indexFile
-    \brief Handle index file reading
-    copyright            : (C) 2009 by mean
-    email                : fixounet at free.fr
-        
- ***************************************************************************/
-
-/***************************************************************************
- *                                                                         *
- *   This program is free software; you can redistribute it and/or modify  *
- *   it under the terms of the GNU General Public License as published by  *
- *   the Free Software Foundation; either version 2 of the License, or     *
- *   (at your option) any later version.                                   *
- *                                                                         *
- ***************************************************************************/
-#include "ADM_default.h"
-#include "ADM_indexFile.h"
-#include "ctype.h"
-/**
-
-*/
-dmxToken::dmxToken(const char *name,const char *value)
-{
-    this->name=ADM_strdup(name);
-    this->value=ADM_strdup(value);
-}
-/**
-
-*/
-dmxToken::~dmxToken()
-{
-    if(name) ADM_dealloc(name);
-    if(value) ADM_dealloc(value);
-}
-
-char *dmxToken::getName(void) {return name;}
-char *dmxToken::getValue(void){return value;}
-/**
-
-*/
-bool  dmxToken::isNumeric(void)
-{
-bool num=true;
-int l=strlen(value);
-    for(int i=0;i<l;i++)
-    {
-        char v=value[i];
-        if(!isdigit(v)&& v!=0x0a && v!=0x0d) num=false;
-    }
-    return num;
-}   
-/**
-
-*/
-uint32_t dmxToken::getAsNumber(void)
-{
-uint32_t v;
-    v=atoi(value);
-    return v;
-}
-
-//****************************************************************************************
-
-/**
-
-*/
-
-indexFile::indexFile()
-{
-    file=NULL;
-}
-/**
-
-*/
-
-indexFile::~indexFile()
-{
-   close();
-}
-/**
-
-*/
-void  indexFile::purgeTokens(void)
-{
-    while(ListOfTokens.size())
-    {
-        delete ListOfTokens[0];
-        ListOfTokens.erase(ListOfTokens.begin());
-    }
-}
-/**
-
-*/
-dmxToken        *indexFile::searchToken(const char *name)
-{
-    for(int i=0;i<ListOfTokens.size();i++)
-    {
-        dmxToken *tk=ListOfTokens[i];
-        if(!strcasecmp(name,tk->getName())) return tk;
-    }
-    printf("[indexFile] Token %s not found\n",name);
-    return NULL;
-}
-/**
-
-*/
-
-bool indexFile::open(const char *name)
-{
-    file=fopen(name,"rt");
-    if(!file) return false;
-    return true;
-}
-
-/**
-
-*/
-
-bool indexFile::close(void)
-{
-    if(file)
-    {
-        fclose(file);
-        file=NULL;
-    }
-    purgeTokens();
-
-}
-
-/**
-
-*/
-
-bool indexFile::goToSection(const char *section)
-{
-char match[100];
-    sprintf(match,"[%s]\n",section);
-    fseek(file,0,SEEK_SET);
-    while(1)
-    {
-        if(!fgets((char*)buffer,ADM_INDEX_BUFFER,file) )
-        {
-            printf("[indexFile] Cannot find section %s,%s*\n",section,match);
-            return false;
-        }
-        if(!strcasecmp((char*)buffer,match)) return true;
-    }
-    return false;
-}
-
-/**
-    \fn readSection
-*/
-
-bool indexFile::readSection(const char *section)
-{
-    if(false==goToSection(section)) return false;
-    // Until we reach the next section, store all couples name/value into the
-    //
-    while(1)
-    {
-        if(!readString(ADM_INDEX_BUFFER,buffer)) break;
-        if(buffer[0]=='[') break; // end of section
-        // Now search the = and replace it by a zero
-        char *head,*tail;
-        head=(char *)buffer;
-        tail=(char *)buffer;
-        tail=strstr((char *)buffer,"=");
-        if(!tail) 
-        {
-            printf("[psIndexer]Weird line :%s\n",buffer);
-        }
-        *tail=0;
-        tail++;
-        dmxToken *tk=new dmxToken(head,tail);
-        ListOfTokens.push_back(tk);
-
-    }
-    return true;
-}
-
-/**
-
-*/
-
-uint32_t indexFile::getAsUint32(const char *name)
-{
-    dmxToken *token=searchToken(name);
-    if(!token) return 0;
-    if(token->isNumeric()) return token->getAsNumber();
-    printf("[psIndex] token %s is not a digit : %s\n",name,token->getValue());
-    return 0;
-}
-
-/** 
-    \fn getAsHex
-    \read entry as hex
-
-*/
-
-uint32_t indexFile::getAsHex(const char *name)
-{
-    uint32_t v;
-    dmxToken *token=searchToken(name);
-    char *s;
-    if(!token) return 0;
-    s=token->getValue();
-    sscanf(s,"%x",&v);
-    return v;
-}
-
-/**
-
-*/
-
-char *indexFile::getAsString(const char *name)
-{
-    dmxToken *token=searchToken(name);
-    if(!token) return NULL;
-    return token->getValue();
-
-}
-
-/**
-
-*/
-
-bool  indexFile::readString(uint32_t maxLen,uint8_t *buffer)
-{
-    if(!fgets((char *)buffer,maxLen,file)) return false;
-    buffer[maxLen-1]=0;
-    return true;
-}
-
-
-//EOF
-

Deleted: branches/avidemux_2.6_branch_mean/plugins/ADM_demuxers/MpegPS/ADM_indexFile.h
===================================================================
--- branches/avidemux_2.6_branch_mean/plugins/ADM_demuxers/MpegPS/ADM_indexFile.h	2009-02-10 16:00:26 UTC (rev 4582)
+++ branches/avidemux_2.6_branch_mean/plugins/ADM_demuxers/MpegPS/ADM_indexFile.h	2009-02-11 06:27:26 UTC (rev 4583)
@@ -1,74 +0,0 @@
-/**
-    \file ADM_indexFile
-    \brief Handle index file reading
-    copyright            : (C) 2009 by mean
-    email                : fixounet at free.fr
-        
- ***************************************************************************/
-
-/***************************************************************************
- *                                                                         *
- *   This program is free software; you can redistribute it and/or modify  *
- *   it under the terms of the GNU General Public License as published by  *
- *   the Free Software Foundation; either version 2 of the License, or     *
- *   (at your option) any later version.                                   *
- *                                                                         *
- ***************************************************************************/
-
-#ifndef ADM_INDEXFILE_H
-#define ADM_INDEXFILE_H
-#include <vector>
-/**
-    \class indexFile
-    \brief Read a index file easily
-*/
-#define ADM_INDEX_BUFFER (20*1024)
-/**
-    \class dmxToken
-*/
-class dmxToken
-{
-protected:
-    char *name;
-    char *value;
-    FILE *file;
-    void  purgeTokens(void);
-public:
-    
-    dmxToken(const char *name,const char *value);
-    ~dmxToken();
-    char *getName(void);
-    char *getValue(void);
-    bool  isNumeric(void);
-    uint32_t getAsNumber(void);
-};
-
-/**
-    \class indexFile
-*/
-
-class indexFile
-{
-protected:
-    uint8_t         buffer[ADM_INDEX_BUFFER];
-    dmxToken        *searchToken(const char *name);
-    void            purgeTokens(void);
-
-    FILE            *file;
-    std::vector <dmxToken *> ListOfTokens;
-public:
-
-        indexFile();
-        ~indexFile();
-    bool open(const char *name);
-    bool close(void);
-    bool goToSection(const char *section);
-    bool readSection(const char *section);
-    uint32_t getAsUint32(const char *token);
-    uint32_t getAsHex(const char *token);
-    char *getAsString(const char *token);
-    bool  readString(uint32_t maxLen,uint8_t *buffer);
-
-};
-
-#endif
\ No newline at end of file

Modified: branches/avidemux_2.6_branch_mean/plugins/ADM_demuxers/MpegPS/CMakeLists.txt
===================================================================
--- branches/avidemux_2.6_branch_mean/plugins/ADM_demuxers/MpegPS/CMakeLists.txt	2009-02-10 16:00:26 UTC (rev 4582)
+++ branches/avidemux_2.6_branch_mean/plugins/ADM_demuxers/MpegPS/CMakeLists.txt	2009-02-11 06:27:26 UTC (rev 4583)
@@ -7,13 +7,11 @@
 	ADM_psAudio.cpp
 	ADM_psAudioProbe.cpp
 	ADM_psAudioProbe.h
-
-    dmxPSPacket.cpp
-    dmx_io.cpp
-    ADM_indexFile.cpp
 )
 
 ADD_LIBRARY(ADM_dm_ps SHARED ${ADM_ps_SRCS})
+TARGET_LINK_LIBRARIES(ADM_dm_ps ADM_coreDemuxerMpeg)
+INCLUDE_DIRECTORIES("${AVIDEMUX_SOURCE_DIR}/avidemux/ADM_coreDemuxerMpeg/include")
 
 
 

Deleted: branches/avidemux_2.6_branch_mean/plugins/ADM_demuxers/MpegPS/dmxPSPacket.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/plugins/ADM_demuxers/MpegPS/dmxPSPacket.cpp	2009-02-10 16:00:26 UTC (rev 4582)
+++ branches/avidemux_2.6_branch_mean/plugins/ADM_demuxers/MpegPS/dmxPSPacket.cpp	2009-02-11 06:27:26 UTC (rev 4583)
@@ -1,660 +0,0 @@
-/**
-    \file dmxPSPacket
-    \brief Packet demuxer for mpeg PS
-    copyright            : (C) 2005-2008 by mean
-    email                : fixounet at free.fr
-        
- ***************************************************************************/
-
-/***************************************************************************
- *                                                                         *
- *   This program is free software; you can redistribute it and/or modify  *
- *   it under the terms of the GNU General Public License as published by  *
- *   the Free Software Foundation; either version 2 of the License, or     *
- *   (at your option) any later version.                                   *
- *                                                                         *
- ***************************************************************************/
-#include "ADM_default.h"
-
-#include "dmxPSPacket.h"
-#include "dmx_mpegstartcode.h"
-
-/**
-    \fn psPacket
-    \brief ctor
-*/
-psPacket::psPacket(void)
-{
-    doNoComplainAnyMore=0;
-    _file=NULL;
-}
-/**
-    \fn psPacket
-    \brief dtor
-*/
-psPacket::~psPacket()
-{
-    close();
-}
-/**
-    \fn open
-    \brief dtor
-*/
-bool psPacket::open(const char *filenames,bool dontappend)
-{
-FP_TYPE opentype=FP_APPEND;
-    if(dontappend) opentype=FP_DONT_APPEND;
-    _file=new fileParser();
-    if(!_file->open(filenames,&opentype))
-    {
-        printf("[DmxPS] cannot open %s\n",filenames);
-        delete _file;
-        _file=NULL;
-        return false;
-    }
-    _size=_file->getSize();
-    return true;
-}
-/**
-    \fn close
-    \brief dtor
-*/
-bool psPacket::close(void)
-{
-    if(_file)
-    {
-        delete _file;
-        _file=NULL;
-    }
-    return true;
-}
-/**
-    \fn getPos
-*/
-uint64_t    psPacket::getPos(void)
-{
-    return 0;
-}
-/**
-    \fn setPos
-*/
-
-bool    psPacket::setPos(uint64_t pos)
-{
-    if(!_file->setpos(pos))
-    {
-        printf("[psPacket] Cannot seek to %"LLX"\n", pos);
-        return false;
-    }
-}
-
-/**
-    \fn getPacketOfType
-    \brief Only returns packet of type pid
-*/      
-
-bool        psPacket::getPacketOfType(uint8_t pid,uint32_t maxSize, uint32_t *packetSize,uint64_t *pts,uint64_t *dts,uint8_t *buffer,uint64_t *startAt)
-{
-
-    bool xit=false;
-    uint8_t tmppid;
-    while(1)
-    {
-        if(true!=getPacket(maxSize,&tmppid,packetSize,pts,dts,buffer,startAt))
-                return false;
-        else
-                if(tmppid==pid) return true;
-    }
-    return false;
-}
-/**
-    \fn getPacket
-*/      
-bool        psPacket::getPacket(uint32_t maxSize, uint8_t *pid, uint32_t *packetSize,uint64_t *opts,uint64_t *odts,uint8_t *buffer,uint64_t *startAt)
-{
-uint32_t globstream,len;
-uint8_t  stream,substream;
-uint64_t pts,dts;
-        // Resync on our stream
-_again2:
-        *pid=0;
-        if(!_file->sync(&stream)) 
-        {
-                uint64_t pos;
-                _file->getpos(&pos);
-                printf("[DmxPS] cannot sync  at "LLU"/"LLU"\n",pos,_size);
-                return false;
-        }
-// Position of this packet just before startcode
-        _file->getpos(startAt);
-        *startAt-=4;
-// Handle out of band stuff        
-        if(stream==PACK_START_CODE) 
-        {
-        		_file->forward(8);
-        		goto _again2;
-        }
-        if( stream==PADDING_CODE ||stream==SYSTEM_START_CODE) 
-        {
-                        len=_file->read16i();
-                        //printf("\tForwarding %lu bytes\n",len);
-        		_file->forward(len);
-        		goto _again2;
-        }
-        // Only keep relevant parts
-        // i.e. a/v : C0 C9 E0 E9
-        // subs 20-29
-        // private data 1/2
-#define INSIDE(min,max) (stream>=min && stream<max)
-        if(!(  INSIDE(0xC0,0xC9) || INSIDE(0xE0,0xE9) || INSIDE(0x20,0x29) || stream==PRIVATE_STREAM_1 || stream==PRIVATE_STREAM_2
-        			)) goto _again2;
-        // Ok we got a candidate
-        if(!getPacketInfo(stream,&substream,&len,&pts,&dts))   
-        {
-                goto _again2;
-        }
-        
-        //printf("Main Stream :%x substream :%x\n",stream,substream);
-        if(stream==PRIVATE_STREAM_1) globstream=0xFF00+substream;
-                else                 globstream=stream;
-
-        *pid=globstream;
-        *opts=pts;
-        *odts=dts;
-        *packetSize=len;
-        if(len>     maxSize)
-        {
-                printf("[DmxPS] Packet too big %d vs %d\n",len,maxSize);
-        }
-        if(!_file->read32(len,buffer)) return false;
-        return true;
-       
-}
-/**
-
-    \fn getPacketInfo
-    \brief       Retrieve info about the packet we just met.It is assumed that parser is just after the packet startcode
-
-*/
-
-uint8_t psPacket::getPacketInfo(uint8_t stream,uint8_t *substream,uint32_t *olen,uint64_t *opts,uint64_t *odts)
-{
-
-//uint32_t un ,deux;
-uint64_t size=0;
-uint8_t c,d;
-uint8_t align=0;
-                        
-                *substream=0xff;
-                *opts=ADM_NO_PTS;
-                *odts=ADM_NO_PTS;
-                
-                                        
-                size=_file->read16i();
-                if((stream==PADDING_CODE) || 
-                	 (stream==PRIVATE_STREAM_2)
-                        ||(stream==SYSTEM_START_CODE) //?
-                        ) // special case, no header
-                        {
-                                *olen=size;      
-                                return 1;
-                        }
-                                
-                        //      remove padding if any                                           
-        
-                while((c=_file->read8i()) == 0xff) 
-                {
-                        size--;
-                }
-//----------------------------------------------------------------------------
-//-------------------------------MPEG-2 PES packet style----------------------
-//----------------------------------------------------------------------------
-                if(((c&0xC0)==0x80))
-                {
-                        uint32_t ptsdts,len;
-                        //printf("\n mpeg2 type \n");
-                        //_muxTypeMpeg2=1;
-                        // c= copyright and stuff       
-                        //printf(" %x align\n",c);      
-                        if(c & 4) align=1;      
-                        c=_file->read8i();     // PTS/DTS
-                        //printf("%x ptsdts\n",c
-                        ptsdts=c>>6;
-                        // header len
-                        len=_file->read8i();
-                        size-=3;  
-
-                        switch(ptsdts)
-                        {
-                                case 2: // PTS=1 DTS=0
-                                        if(len>=5)
-                                        {
-                                                uint64_t pts1,pts2,pts0;
-                                                //      printf("\n PTS10\n");
-                                                        pts0=_file->read8i();  
-                                                        pts1=_file->read16i(); 
-                                                        pts2=_file->read16i();                 
-                                                        len-=5;
-                                                        size-=5;
-                                                        *opts=(pts1>>1)<<15;
-                                                        *opts+=pts2>>1;
-                                                        *opts+=(((pts0&6)>>1)<<30);
-                                        }
-                                        break;
-                                case 3: // PTS=1 DTS=1
-                                                #define PTS11_ADV 10 // nut monkey
-                                                if(len>=PTS11_ADV)
-                                                {
-                                                        uint32_t skip=PTS11_ADV;
-                                                        uint64_t pts1,pts2,dts,pts0;
-                                                                //      printf("\n PTS10\n");
-                                                                pts0=_file->read8i();  
-                                                                pts1=_file->read16i(); 
-                                                                pts2=_file->read16i(); 
-                                                                                        
-                                                                *opts=(pts1>>1)<<15;
-                                                                *opts+=pts2>>1;
-                                                                *opts+=(((pts0&6)>>1)<<30);
-                                                                pts0=_file->read8i();  
-                                                                pts1=_file->read16i(); 
-                                                                pts2=_file->read16i();                 
-                                                                dts=(pts1>>1)<<15;
-                                                                dts+=pts2>>1;
-                                                                dts+=(((pts0&6)>>1)<<30);
-                                                                len-=skip;
-                                                                size-=skip;
-                                                                *odts=dts;
-                                                                        //printf("DTS: %lx\n",dts);                
-                                                   }
-                                                   break;               
-                                case 1:
-                                                return 0;//ADM_assert(0); // forbidden !
-                                                break;
-                                case 0: 
-                                                // printf("\n PTS00\n");
-                                                break; // no pts nor dts
-                                                                                
-                                                            
-                        }  
-// Extension bit        
-// >stealthdave<                                
-
-                        // Skip remaining headers if any
-                        if(len) 
-                        {
-                                _file->forward(len);
-                                size=size-len;
-                        }
-                                
-                if(stream==PRIVATE_STREAM_1)
-                {
-                        if(size>5)
-                        {
-                        // read sub id
-                               *substream=_file->read8i();
-  //                    printf("\n Subid : %x",*subid);
-                                switch(*substream)
-                                {
-                                // DTS
-                                        case 0x88:case 0x89:case 0x8A:case 0x8B:
-                                        
-                                                *substream=*substream-0x48;
-                                                break;
-
-                                //AC3
-                                        case 0x80:case 0x81:case 0x82:case 0x83:
-                                        case 0x84:case 0x85:case 0x86:case 0x87:
-                                                *substream=*substream-0x80;
-                                                break;
-                                // PCM
-                                        case 0xA0:case 0xA1:case 0xa2:case 0xa3:
-                                        case 0xA4:case 0xA5:case 0xa6:case 0xa7:
-                                                // we have an additionnal header
-                                                // of 3 bytes
-                                                _file->forward(3);
-                                                size-=3;
-                                                break;
-                                // Subs
-                                case 0x20:case 0x21:case 0x22:case 0x23:
-                                case 0x24:case 0x25:case 0x26:case 0x27:
-                                                break;
-                             
-                                default:
-                                                doNoComplainAnyMore++;
-                                                if(doNoComplainAnyMore<10)
-                                                    printf("[DmxPS]Unkown substream %x\n",*substream);
-                                                *substream=0xff;
-                                }
-                                // skip audio header (if not sub)
-                                if(*substream>0x26 || *substream<0x20)
-                                {
-                                        _file->forward(3);
-                                        size-=3;
-                                }
-                                size--;
-                        }
-                }
-               //    printf(" pid %x size : %x len %x\n",sid,size,len);
-                *olen=size;
-                return 1;
-        }
-//----------------------------------------------------------------------------------------------                
-//-------------------------------MPEG-1 PES packet style----------------------                                  
-//----------------------------------------------------------------------------------------------                                        
-           if(0) //_muxTypeMpeg2)
-                {
-                        printf("[DmxPS]*** packet type 1 inside type 2 ?????*****\n");
-                        return 0; // mmmm                       
-                }
-          // now look at  STD buffer size if present
-          // 01xxxxxxxxx
-          if ((c>>6) == 1) 
-          {       // 01
-                        size-=2;
-                        _file->read8i();                       // skip one byte
-                        c=_file->read8i();   // then another
-           }                       
-           // PTS/DTS
-           switch(c>>4)
-           {
-                case 2:
-                {
-                        // 0010 xxxx PTS only
-                        uint64_t pts1,pts2,pts0;
-                                        size -= 4;
-                                        pts0=(c>>1) &7;
-                                        pts1=_file->read16i()>>1;
-                                        pts2=_file->read16i()>>1;
-                                        *opts=pts2+(pts1<<15)+(pts0<<30);
-                                        break;
-                  }
-                  case 3:
-                  {               // 0011 xxxx
-                        uint64_t pts1,pts2,pts0;
-                                        size -= 9;
-                                                                        
-                                        pts0=(c>>1) &7;
-                                        pts1=_file->read16i()>>1;
-                                        pts2=_file->read16i()>>1;
-                                        *opts=pts2+(pts1<<15)+(pts0<<30);
-                                        _file->forward(5);
-                   }                                                               
-                   break;
-                   
-                case 1:
-                        // 0001 xxx             
-                        // PTSDTS=01 not allowed                        
-                                return 0;
-                                break; 
-                }
-                                                                
-
-                if(!align)      
-                        size--;         
-        *olen=size;
-        return 1;
-}
-//************************************************************************************
-
-#define ADM_PACKET_LINEAR 10*1024
-/**
-    \fn psPacket
-*/
-psPacketLinear::psPacketLinear(uint8_t pid) : psPacket()
-{
-    oldStartAt=startAt=0xfffffff;
-    oldBufferLen=bufferLen=0;
-    bufferIndex=0;
-    myPid=pid;
-    eof=false;
-}
-/**
-    \fn ~psPacket
-*/
-psPacketLinear::~psPacketLinear() 
-{
-}
-/**
-    \fn refill
-*/
-bool psPacketLinear::refill(void) 
-{
-// In case a startcade spawns across 2 packets
-// we have to keep track of the old one
-        oldBufferDts=bufferDts;
-        oldBufferPts=bufferPts;
-        oldStartAt=startAt;
-        oldBufferLen=bufferLen;
-        if( false== getPacketOfType(myPid,ADM_PACKET_LINEAR, &bufferLen,&bufferPts,&bufferDts,buffer,&startAt)) return false;
-        bufferIndex=0;
-        return true;
-}
-/**
-    \fn readi8
-*/
-uint8_t psPacketLinear::readi8(void)
-{
-    consumed++;
-    if(bufferIndex<bufferLen)
-    {
-        return buffer[bufferIndex++];
-    }
-    if(false==refill()) 
-    {
-        eof=1;
-        return 0;
-    }
-    ADM_assert(bufferLen);
-    bufferIndex=1;
-    return buffer[0];
-    
-}
-/**
-    \fn readi16
-*/
-uint16_t psPacketLinear::readi16(void)
-{
-    if(bufferIndex+1<bufferLen)
-    {
-        uint16_t v=(buffer[bufferIndex]<<8)+buffer[bufferIndex+1];;
-        bufferIndex+=2;
-        consumed+=2;
-        return v;
-    }
-    return (readi8()<<8)+readi8();
-}
-/**
-    \fn readi32
-*/
-uint32_t psPacketLinear::readi32(void)
-{
-    if(bufferIndex+3<bufferLen)
-    {
-        uint8_t *p=buffer+bufferIndex;
-        uint32_t v=(p[0]<<24)+(p[1]<<16)+(p[2]<<8)+p[3];
-        bufferIndex+=4;
-        consumed+=4;
-        return v;
-    }
-    return (readi16()<<16)+readi16();
-}
-/**
-    \fn forward
-*/
-bool psPacketLinear::forward(uint32_t v)
-{
-    if(bufferIndex+v-1<bufferLen)
-    {
-        bufferIndex+=v;
-        consumed+=v;
-        return true;
-    }
-    if(!refill()) return false;
-    uint32_t delta=bufferLen-bufferIndex;
-    v-=delta;
-    consumed+=delta;
-    return forward(v);
-}
-
-/**
-    \fn bool    read(uint32_t len, uint8_t *buffer);
-    \brief
-*/
-bool    psPacketLinear::read(uint32_t len, uint8_t *out)
-{
-    // Enough already ?
-    while(len)
-    {
-        uint32_t avail=bufferLen-bufferIndex;
-        uint32_t chunk=avail;
-        if(chunk>len) chunk=len;
-#if 0
-        printf("len:%ld avail:%ld chunk %ld index:%d size:%d\n",
-                len,avail,chunk,bufferIndex,bufferLen);
-#endif
-        memcpy(out,buffer+bufferIndex,chunk);
-        bufferIndex+=chunk;
-        len-=chunk;
-        out+=chunk;
-        consumed+=chunk;
-        if(bufferIndex==bufferLen)
-        {
-            //printf("Refill\n");
-            if(false==refill()) return false;
-        }
-    }
-    return true;
-}
-/**
-        \fn getInfo
-        \brief Returns info about the current (or previous if it spawns) packet.
-            It is expected that the caller will do -4 to the index to get the start of the 
-            startCode
-*/
-bool    psPacketLinear::getInfo(psPacketInfo *info)
-{
-    if(bufferIndex<4)
-    {
-        info->startAt=this->oldStartAt;
-        info->offset=oldBufferLen+bufferIndex;
-        info->pts=oldBufferPts;
-        info->dts=oldBufferDts;
-
-    }else
-    {
-        info->startAt=this->startAt;
-        info->offset=bufferIndex;
-        info->pts=bufferPts;
-        info->dts=bufferDts;
-    }
-    return true;
-
-};
-/**
-    \fn seek
-    \brief Async jump
-*/
-bool    psPacketLinear::seek(uint64_t packetStart, uint32_t offset)
-{
-    if(!_file->setpos(packetStart))
-    {
-        printf("[psPacket] Cannot seek to %"LLX"\n",packetStart);
-        return 0;
-    }
-    refill();
-    ADM_assert(offset<bufferLen);
-    bufferIndex=offset;
-    
-    return true;
-}
-/**
-    \fn getConsumed
-    \brief returns the # of bytes consumed since the last call
-*/
-uint32_t psPacketLinear::getConsumed(void)
-{
-    uint32_t c=consumed;
-    consumed=0;
-    return c;
-}
-/**
-    \fn changePid
-    \brief change the pid of the stream we read (used when probing all tracks)
-*/
-bool    psPacketLinear::changePid(uint32_t pid) 
-{
-    myPid=(pid&0xff);
-    bufferLen=bufferIndex=0;
-    return true;
-}
-/* ********************************************************* */
-/**
-    \fn psPacketLinearTracker
-*/
- psPacketLinearTracker::psPacketLinearTracker(uint8_t pid)  : psPacketLinear(pid)
-{
-   
-}
-/**
-    \fn ~psPacketLinearTracker
-*/
-psPacketLinearTracker::~psPacketLinearTracker()
-{
-
-    resetStats();
-}
-/**
-        \fn getStat
-*/
-packetStats    *psPacketLinearTracker::getStat(int index)
-{   
-    if(index<0 || index>=256) ADM_assert(0);
-    return stats+index;
-}
-/**
-    \fn getPacketgetPacketOfType
-    \brief Keep track of all the packets we have seen so far.
-    Usefull to detect the streams present and to look up the PTS/DTS of audio streams for the audio part of the index
-*/
-bool           psPacketLinearTracker::getPacketOfType(uint8_t pid,uint32_t maxSize, uint32_t *packetSize,uint64_t *pts,uint64_t *dts,uint8_t *buffer,uint64_t *startAt)
-{
- bool xit=false;
-    uint8_t tmppid;
-    while(1)
-    {
-        if(true!=getPacket(maxSize,&tmppid,packetSize,pts,dts,buffer,startAt))
-                return false;
-        else
-        {
-                // Update 
-                ADM_assert(tmppid<0x100);
-                packetStats *p=stats+tmppid;
-                uint64_t ts=*pts;
-                if(ts==ADM_NO_PTS) ts=*dts;
-                if(ts!=ADM_NO_PTS)
-                {
-                    p->startCount=p->count;
-                    p->startAt=*startAt;
-                    p->startSize=p->size;
-                    p->startDts=ts;
-                }
-                p->count++;
-                p->size+=*packetSize;
-                if(tmppid==pid) return true;
-        }
-    }
-    return false;
-}
-/**
-    \fn resetStats
-*/
-bool           psPacketLinearTracker::resetStats(void)
-{
-    memset(stats,0,sizeof(stats));
-    for(int i=0;i<256;i++)
-    {
-        packetStats *p=stats+i;
-        p->startDts=ADM_NO_PTS;
-    }
-}
-//EOF

Deleted: branches/avidemux_2.6_branch_mean/plugins/ADM_demuxers/MpegPS/dmxPSPacket.h
===================================================================
--- branches/avidemux_2.6_branch_mean/plugins/ADM_demuxers/MpegPS/dmxPSPacket.h	2009-02-10 16:00:26 UTC (rev 4582)
+++ branches/avidemux_2.6_branch_mean/plugins/ADM_demuxers/MpegPS/dmxPSPacket.h	2009-02-11 06:27:26 UTC (rev 4583)
@@ -1,112 +0,0 @@
-/**
-    dmxPSPacket.cpp
-
-*/
-
-#ifndef DMXPSPACKET_H
-#define DMXPSPACKET_H
-
-#include "dmx_io.h"
-#include "ADM_Video.h"
-
-/**
-    \struct psPacketInfo
-
-*/
-typedef struct
-{
-    uint64_t pts;
-    uint64_t dts;
-    uint64_t startAt;
-    uint32_t offset;
-
-}psPacketInfo;
-
-/**
-    \class psPacket
-*/
-class psPacket
-{
-protected:
-    int         doNoComplainAnyMore;
-    fileParser  *_file;
-    uint64_t    _size;
-    uint8_t     getPacketInfo(uint8_t stream,uint8_t *substream,uint32_t *olen,uint64_t *opts,uint64_t *odts);
-public:
-                psPacket(void);
-                ~psPacket();
-    bool        open(const char *filenames,bool dontappend);
-    bool        close(void);
-    virtual bool        getPacket(uint32_t maxSize, uint8_t *pid, uint32_t *packetSize,uint64_t *pts,uint64_t *dts,uint8_t *buffer,uint64_t *startAt);
-    virtual bool        getPacketOfType(uint8_t pid,uint32_t maxSize, uint32_t *packetSize,uint64_t *pts,uint64_t *dts,uint8_t *buffer,uint64_t *startAt);
-    uint64_t    getPos(void);
-    bool        setPos(uint64_t pos);
-    uint64_t    getSize(void) { return _file->getSize();}
-};
-/**
-    \class psPacketLinear
-*/
-#define ADM_PACKET_LINEAR 10*1024
-
-class psPacketLinear : public psPacket
-{
-protected:
-        uint8_t  myPid;
-        uint64_t startAt;
-        uint32_t bufferLen;
-        uint64_t bufferPts;
-        uint64_t bufferDts;
-        uint32_t bufferIndex;
-        uint8_t  buffer[ADM_PACKET_LINEAR];
-        bool     eof;
-        bool     refill(void);
-        uint64_t oldStartAt;
-        uint32_t oldBufferLen;
-        uint64_t oldBufferPts;
-        uint64_t oldBufferDts;
-        uint32_t consumed;
-
-public:
-                psPacketLinear(uint8_t pid);
-                ~psPacketLinear();
-        uint32_t getConsumed(void);
-        uint8_t  readi8();
-        uint16_t readi16();
-        uint32_t readi32();
-        bool     sync(uint8_t *pid);
-        bool    read(uint32_t len, uint8_t *buffer);
-        bool    forward(uint32_t v);
-        bool    stillOk(void) {return !eof;};
-        bool    getInfo(psPacketInfo *info);
-        bool    seek(uint64_t packetStart, uint32_t offset);
-        bool    changePid(uint32_t pid) ;
-};
-/**
-    \class psPacketLinearTracker
-*/
-typedef struct
-{
-    uint32_t count;
-    uint32_t size;
-    
-    uint64_t startAt;
-    uint32_t startCount;
-    uint32_t startSize;
-    uint64_t startDts;
-}packetStats;
-
-class psPacketLinearTracker : public psPacketLinear
-{
-protected:
-      packetStats stats[256];
-
-public:
-                        psPacketLinearTracker(uint8_t pid);
-                        ~psPacketLinearTracker();
-         packetStats    *getStat(int intdex);
-         bool           resetStats(void);
-virtual  bool           getPacketOfType(uint8_t pid,uint32_t maxSize, uint32_t *packetSize,uint64_t *pts,uint64_t *dts,uint8_t *buffer,uint64_t *startAt);
-};
-
-
-#endif
\ No newline at end of file

Deleted: branches/avidemux_2.6_branch_mean/plugins/ADM_demuxers/MpegPS/dmx_io.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/plugins/ADM_demuxers/MpegPS/dmx_io.cpp	2009-02-10 16:00:26 UTC (rev 4582)
+++ branches/avidemux_2.6_branch_mean/plugins/ADM_demuxers/MpegPS/dmx_io.cpp	2009-02-11 06:27:26 UTC (rev 4583)
@@ -1,540 +0,0 @@
-/***************************************************************************
-                          dmx_io.cpp  -  description
-                             -------------------
-
-    copyright            : (C) 2005 by mean
-    email                : fixounet at free.fr
-
-    This just handles mpeg sync search and little endian/big endin integer reading
-    It also handle multiple files seen as one logical file and buffering
-        to speed up ios
-
- ***************************************************************************/
-
-/***************************************************************************
- *                                                                         *
- *   This program is free software; you can redistribute it and/or modify  *
- *   it under the terms of the GNU General Public License as published by  *
- *   the Free Software Foundation; either version 2 of the License, or     *
- *   (at your option) any later version.                                   *
- *                                                                         *
- ***************************************************************************/
-#include <math.h>
-
-#include "ADM_default.h"
-#include "dmx_io.h"
-
-#define aprintf(...) {}
-
-fileParser::fileParser( void )
-{
-                _fd=NULL;
-                _sizeFd=NULL;
-                _off=0;
-                _nbFd=0;
-                _curFd=0;
-                _buffer=new uint8_t[DMX_BUFFER];
-                _head=_tail=0;
-                _size=0;
-}
-
-fileParser::~fileParser()
-{
-        if(_nbFd)
-        {
-                 for(uint32_t i=0;i<_nbFd;i++)
-                 {
-                                if(_fd[i])
-                                        fclose(_fd[i]);
-                 }
-                delete [] _fd;
-                delete [] _sizeFd;
-                delete [] _sizeFdCumul;
-
-
-        }
-        if(_buffer) delete [] _buffer;
-        _buffer=NULL;
-        _nbFd=0;
-}
-
-/*
-        Open one file, probe to see if there is several file with contiguous name
-        and handle them as one big file if that's the case
-
-        If multi is set to probe, return value will be APPEND if there is several files, dont_append if one
-        if multi is set to dont_append, file won't be auto appended even if they exist
-*/
-uint8_t fileParser::open( const char *filename,FP_TYPE *multi )
-{
-        char *dot = NULL;                   // pointer to the last dot in filename
-        uint8_t decimals = 0;               // number of decimals
-        char *left = NULL, *number = NULL, *right = NULL; // parts of filename (after splitting)
-
-        char *followup = new char[ strlen(filename) + 1 ]; // possible follow-up filename
-        uint8_t first_followup = 1;         // indicates first follow-up
-        uint8_t last_followup = 0;          // indicates last follow-up (by number: 99)
-        uint8_t count = 0;                  // number of follow-ups
-
-        FILE **buffer_fd = NULL;            // _fd buffer
-        uint64_t *buffer_sizeFd = NULL;     // _sizeFd buffer
-
-        int i = 0;                          // index (general use)
-
-
-        // find the last dot
-        dot = strrchr( filename, '.' );
-
-        // count the decimals before the dot
-        decimals = 1;
-        while( (dot != NULL) && ((dot - decimals) != filename) &&
-               (dot[0 - decimals] >= '0') && (dot[0 - decimals] <= '9') )
-                { decimals++; }
-        decimals--;
-
-        // Nuv files can have 20 decimals
-        // Keep it down to 10000
-        if(decimals>4) decimals=4;
-        if(*multi==FP_DONT_APPEND)
-        {
-                if(decimals) printf("There was several files, but dont append was forced\n");
-                decimals=0;
-        }
-        // no number sequence
-        if( decimals == 0 )
-        {
-                aprintf( "\nSimple loading: \n" );
-                delete [] followup;
-                _nbFd = 1;
-                _curFd = 0;
-                _fd = new FILE * [_nbFd];
-                _sizeFd = new uint64_t [_nbFd];
-                _sizeFdCumul = new uint64_t [_nbFd];
-
-                // open file
-                if(! (_fd[0] = fopen(filename, "rb")) )
-                  { return 0; }
-
-                // calculate file-size
-                fseeko( _fd[0], 0, SEEK_END );
-                _sizeFd[0] = ftello( _fd[0] );
-                fseeko( _fd[0], 0, SEEK_SET );
-                _sizeFdCumul[0]=0;
-                _size=_sizeFd[0];
-                aprintf( " file: %s, size: %"LLU"\n", filename, _sizeFd[0] );
-                aprintf( " found 1 files \n" );
-                aprintf( "Done \n" );
-                return 1;
-        }
-
-        // possible number sequence
-        else
-        {
-                // split the filename in <left>, <number> and <right>
-                // -----
-
-                // <left> part
-                left = new char[(dot - filename - decimals) + 1];
-                strncpy( left, filename, (dot - filename - decimals) );
-                left[(dot - filename - decimals)] = '\0';
-
-                // <number> part
-                number = new char[decimals + 1];
-                strncpy( number, (dot - decimals), decimals );
-                number[decimals] = '\0';
-
-                // <right> part
-                right = new char[ strlen(dot) ];
-                strcpy( right, dot );
-
-                // add the file, and all existing follow-ups
-                // -----
-                uint32_t tabSize;
-
-                tabSize=(uint32_t)pow(10,decimals);
-                buffer_fd = new FILE * [tabSize];
-                buffer_sizeFd = new uint64_t [tabSize];
-
-                aprintf( "\nAuto adding: \n" );
-                while( last_followup == 0 )
-                {
-                        strcpy( followup, left );
-                        strcat( followup, number );
-                        strcat( followup, right );
-
-                        // open file
-                        buffer_fd[count] = fopen(followup, "rb");
-                        if(! buffer_fd[count] )
-                        {
-                                // we need at least one file!
-                                if( first_followup == 1 )
-                                  { return 0; }
-                                else
-                                  { printf( " file: %s not found. \n", followup ); break; }
-                        }
-
-                        // calculate file-size
-                        fseeko( buffer_fd[count], 0, SEEK_END );
-                        buffer_sizeFd[count] = ftello( buffer_fd[count] );
-                        fseeko( buffer_fd[count], 0, SEEK_SET );
-
-                        aprintf( " file %d: %s, size: %"LLU"\n", (count + 1), followup, buffer_sizeFd[count] );
-
-                        // increase number
-                        number[decimals - 1] = number[decimals - 1] + 1;
-                        for( i = decimals - 1; i >= 0; i-- )
-                        {
-                                if( number[i] > '9' )
-                                {
-                                        if( i == 0 )
-                                          { last_followup = 1; break; }
-                                        number[i] = '0';
-                                        number[i - 1] = number[i - 1] + 1;
-                                }
-                        }
-
-                        first_followup = 0;
-                        count++;
-                } // while( last_followup == 0 )
-
-                // copy from buffer
-                _nbFd = count;
-                _curFd = 0;
-                _fd = new FILE * [_nbFd];
-                _sizeFd = new uint64_t [_nbFd];
-                _sizeFdCumul = new uint64_t [_nbFd];
-                uint64_t total=0;
-                for( i = 0; i < count; i++ )
-                {
-                        _fd[i] = buffer_fd[i];
-                        _sizeFd[i] = buffer_sizeFd[i];
-                        _sizeFdCumul[i]=total;
-                        total+=buffer_sizeFd[i];
-                }
-                _size=total;
-                // clean up
-                delete [] followup;
-                delete [] left;
-                delete [] number;
-                delete [] right;
-                delete [] buffer_fd;
-                delete [] buffer_sizeFd;
-                if(*multi==FP_PROBE)
-                {
-                        if(count>1)
-                                *multi=FP_APPEND;       //
-                        else
-                                *multi=FP_DONT_APPEND;
-                }
-
-                aprintf( " found %d files \n", count );
-                aprintf( "Done \n" );
-        } // if( decimals == 0 )
-                return 1;
-} // fileParser::open()
-
-
-/*----------------------------------------
-
-------------------------------------------*/
-
-uint8_t fileParser::forward(uint64_t jmp)
-{
-                // still in the buffer ?
-                if((_off+jmp)<_tail)
-                {
-                        _off+=jmp;
-                        return 1;
-                }
-
-               // locate the new file
-
-               if(_off+jmp>=_size)
-                        {
-                               _off=_size-1;
-                               _head=_off;
-                               _tail=_off;
-                               return 0;
-                        }
-                _off+=jmp;  // final location
-                for(uint32_t i=_curFd;i<_nbFd;i++)
-                {
-                        if(_off>=_sizeFdCumul[i] && _off<(_sizeFdCumul[i]+_sizeFd[i]))
-                        {
-                                _curFd=i;
-                                fseeko(_fd[i],_off-_sizeFdCumul[i],SEEK_SET);
-                                _head=_tail=_off;
-                                return 1;
-                        }
-
-                }
-
-                return 0;
-}
-
-uint8_t fileParser::setpos(uint64_t o)
-{
-
-                if(o>=_head && o<_tail)
-                {
-                        _off=o;
-                        return 1;
-                }
-                for(uint32_t i=0;i<_nbFd;i++)
-                        {
-                                if( (o>=_sizeFdCumul[i]) && o<(_sizeFdCumul[i]+_sizeFd[i]))
-                                        {
-                                                        _curFd=i;
-                                                        _off=o;
-                                                        fseeko(_fd[_curFd],_off-_sizeFdCumul[i],SEEK_SET);
-                                                        _head=_tail=_off; // Flush
-                                                  return 1;
-                                        }
-                        }
-                        printf("\n cannot seek to %"LLU"\n",o);
-                        return 0;
-}
-//
-//      Search packet signature and return packet type
-//_______________________________________
-uint8_t fileParser::sync(uint8_t *stream)
-{
-uint32_t val,hnt;
-
-        val=0;
-        hnt=0;
-        // preload
-        if((4+_off)>=_size)
-        {
-                printf("Dmx IO: End of file met (%"LLU" / %"LLU" seg:%"LU")\n",_off,_size,_nbFd);
-                return 0;
-        }
-        hnt=(read8i()<<16) + (read8i()<<8) +read8i();
-
-
-        while((hnt!=0x00001))
-        {
-                hnt<<=8;
-                val=read8i();
-                hnt+=val;
-                hnt&=0xffffff;
-                if(_curFd==_nbFd-1)
-                {
-                                if((4+_off)>=_size) return 0;
-                }
-        }
-
-        *stream=read8i();
-        return 1;
-}
-//
-//      Search packet signature and return packet type
-//_______________________________________
-uint8_t fileParser::syncH264(uint8_t *stream)
-{
-uint32_t val,hnt;
-
-        val=0;
-        hnt=0;
-        // preload
-        if((5+_off)>=_size)
-        {
-                printf("Dmx IO: End of file met (%"LLU" / %"LLU" seg:%"LU")\n",_off,_size,_nbFd);
-                return 0;
-        }
-        hnt=(read8i()<<24)+(read8i()<<16) + (read8i()<<8) +read8i();
-
-
-        while((hnt!=0x1))
-        {
-                hnt<<=8;
-                val=read8i();
-                hnt+=val;
-                if(_curFd==_nbFd-1)
-                {
-                                if((5+_off)>=_size) return 0;
-                }
-        }
-
-        *stream=read8i();
-        return 1;
-}
-
-uint8_t fileParser::getpos(uint64_t *o)
-{
-         *o=_off;
-         return 1;
-
-}
-
-
- uint64_t fileParser::getSize( void )
-{
-        return  _size;
-
-}
-/*--------------------------------------------------
-                Read l bytes from file
-----------------------------------------------------*/
-uint32_t fileParser::read32(uint32_t len, uint8_t *buffer)
-{
-uint32_t r;
-
-uint64_t remain,begin,mx,last;
-
-        ADM_assert(_off>=_head);
-        ADM_assert(_off<=_tail);
-
-        if(_head>=_size-1) return 0;
-
-// Check we do not go out of bound
-        if(_off+len>=_size)
-        {
-                len=_size-_off;
-        }
-
-        remain=_tail-_off;
-        begin=_off-_head;
-
-
-
-        // everything in cache ?
-        if(len<=remain)
-        {
-                memcpy(buffer,_buffer+begin,len);
-                _off+=len;
-                return len;
-        }
-
-        // No enough data, purge cache
-        if(remain)
-        {
-                memcpy(buffer,_buffer+begin,remain);
-                _off+=remain;
-                len-=remain;
-                buffer+=remain;
-                return remain+read32(len,buffer);
-        }
-
-        // Reload ?
-        // What is left in that file ?
-        mx=_sizeFd[_curFd]+_sizeFdCumul[_curFd]-_off;
-        // Do we need more, if so jump over it
-        if(len>mx)
-        {
-                fread(buffer,mx,1,_fd[_curFd]);
-                len-=mx;
-                _off+=mx;
-                buffer+=mx;
-                _head=_tail=_off;
-                _curFd++;
-                if(_curFd>=_nbFd) return 0;
-                fseeko(_fd[_curFd],0,SEEK_SET);
-                return mx+read32(len,buffer);
-        }
-        // Read what is available in file, store leftover in the buffer
-        fread(buffer,len,1,_fd[_curFd]);
-        _off+=len;
-        // available in that file
-        mx-=len;
-        if(mx>DMX_BUFFER) mx=DMX_BUFFER;
-        fread(_buffer,mx,1,_fd[_curFd]);
-        _head=_off;
-        _tail=_head+mx;
-
-         return len;
-
-}
-#ifdef NO_INLINE_FP
-uint32_t fileParser::read32i(void )
-{
-       uint32_t v;
-       uint8_t c[4];
-       uint8_t *p;
-        // case one, it fits in the buffer
-        //
-        if(_off+4<_tail)
-        {
-                p=&(_buffer[_off-_head]);
-                _off+=4;
-        }
-        else
-        {
-               read32(4,c);
-               p=c;
-        }
-       v= (p[0]<<24)+(p[1]<<16)+(p[2]<<8)+p[3];
-       return v;
-}
-uint16_t fileParser::read16i(void )
-{
-  uint32_t v;
-       uint8_t c[4];
-       uint8_t *p;
-        // case one, it fits in the buffer
-        //
-        if(_off+2<_tail)
-        {
-                p=&(_buffer[_off-_head]);
-                _off+=2;
-        }
-        else
-        {
-               read32(2,c);
-               p=c;
-        }
-       v= (p[0]<<8)+p[1];
-       return v;
-}
-uint8_t fileParser::read8i(void )
-{
-uint8_t r;
-        if(_off+1<_tail)
-        {
-                r= _buffer[_off-_head];
-                _off++;
-        }
-        else
-        {
-                read32(1,&r);
-        }
-        return r;
-}
-#endif
-
-void fileParser::hexDump(uint8_t *buf, int size)
-{
-	int len, i, j, c;
-
-	for(i=0;i<size;i+=16)
-	{
-		len = size - i;
-
-		if (len > 16)
-			len = 16;
-
-		printf("%08x ", i);
-
-		for(j=0;j<16;j++)
-		{
-			if (j < len)
-				printf(" %02x", buf[i+j]);
-			else
-				printf("   ");
-		}
-
-		printf(" ");
-
-		for(j=0;j<len;j++)
-		{
-			c = buf[i+j];
-
-			if (c < ' ' || c > '~')
-				c = '.';
-
-			printf("%c", c);
-		}
-
-		printf("\n");
-	}
-}

Deleted: branches/avidemux_2.6_branch_mean/plugins/ADM_demuxers/MpegPS/dmx_io.h
===================================================================
--- branches/avidemux_2.6_branch_mean/plugins/ADM_demuxers/MpegPS/dmx_io.h	2009-02-10 16:00:26 UTC (rev 4582)
+++ branches/avidemux_2.6_branch_mean/plugins/ADM_demuxers/MpegPS/dmx_io.h	2009-02-11 06:27:26 UTC (rev 4583)
@@ -1,129 +0,0 @@
-/***************************************************************************
-                          ADM_mpegparser.h  -  description
-                             -------------------
-    begin                : Tue Oct 15 2002
-    copyright            : (C) 2002 by mean
-    email                : fixounet at free.fr
- ***************************************************************************/
-
-/***************************************************************************
- *                                                                         *
- *   This program is free software; you can redistribute it and/or modify  *
- *   it under the terms of the GNU General Public License as published by  *
- *   the Free Software Foundation; either version 2 of the License, or     *
- *   (at your option) any later version.                                   *
- *                                                                         *
- ***************************************************************************/
-#ifndef FPARSER_
-#define FPARSER_
-#define DMX_BUFFER 1024*100
-
-/*
-        _off is the logical offset in the file
-        _head is the logical offset of the 1st byte in _buffer
-        _tail is the logical offset of the last byte in the buffer
-
-
-*/
-typedef enum 
-{
-        FP_PROBE=1,
-        FP_DONT_APPEND=2,
-        FP_APPEND=3
-}FP_TYPE;
-
- class fileParser
-{
-        private:
-         
-            uint8_t  *_buffer;
-            uint64_t _off;              // Absolute offset
-            
-            uint32_t _curFd;        
-            uint32_t _nbFd;
-            FILE      **_fd;
-            uint64_t *_sizeFd;          // Filesize for file X
-            uint64_t *_sizeFdCumul;     // Cumulative side from beginning =offset for the 1st byte in the file
-            uint64_t _head,_tail,_size;       
-           
-        public:
-                                fileParser(void);
-                                ~fileParser();                                         
-                        uint8_t  open(const char *name,FP_TYPE *multi);
-                        uint8_t  forward(uint64_t u);
-                        uint8_t  sync(uint8_t *t );
-                        uint8_t  syncH264(uint8_t *t );
-                        uint8_t  getpos(uint64_t *o);
-                        uint8_t  setpos(uint64_t o);                
-                        uint64_t getSize( void ) ;
-                        uint32_t read32(uint32_t l, uint8_t *buffer);
-                        uint8_t  end(void) { return _off==_size-1;};
-						void hexDump(uint8_t *buf, int size);
-#ifdef NO_INLINE_FP
-                        uint32_t read32i(void );
-                        uint16_t read16i(void );
-                        uint8_t  read8i(void );
-                        
-
-#else
-uint32_t read32i(void )
-{
-       uint32_t v;
-       uint8_t c[4];
-       uint8_t *p;
-        // case one, it fits in the buffer
-        //
-        if(_off+3<_tail)
-        {
-                p=&(_buffer[_off-_head]);
-                _off+=4;
-        }
-        else
-        {
-               read32(4,c);
-               p=c;
-        }
-       v= (p[0]<<24)+(p[1]<<16)+(p[2]<<8)+p[3];
-       return v;
-}
-uint16_t read16i(void )
-{
-  uint32_t v;
-       uint8_t c[4];
-       uint8_t *p;
-        // case one, it fits in the buffer
-        //
-        if(_off+1<_tail)
-        {
-                p=&(_buffer[_off-_head]);
-                _off+=2;
-        }
-        else
-        {
-               read32(2,c);
-               p=c;
-        }
-       v= (p[0]<<8)+p[1];
-       return v;
-}
-uint8_t read8i(void )
-{
-uint8_t r;
-        if(_off<_tail)
-        {
-                r= _buffer[_off-_head];
-                _off++;     
-        }
-        else
-        {
-                read32(1,&r);     
-        }
-        return r;
-}
-#endif
-
-
-} ;
-
-
-#endif

Deleted: branches/avidemux_2.6_branch_mean/plugins/ADM_demuxers/MpegPS/dmx_mpegstartcode.h
===================================================================
--- branches/avidemux_2.6_branch_mean/plugins/ADM_demuxers/MpegPS/dmx_mpegstartcode.h	2009-02-10 16:00:26 UTC (rev 4582)
+++ branches/avidemux_2.6_branch_mean/plugins/ADM_demuxers/MpegPS/dmx_mpegstartcode.h	2009-02-11 06:27:26 UTC (rev 4583)
@@ -1,22 +0,0 @@
-#ifndef DMX_STARTCODE
-#define DMX_STARTCODE
-
-#define PICTURE_START_CODE 0x00L
-#define SLICE_MIN_START    0x01L
-#define SLICE_MAX_START    0xAFL
-#define SEQ_START_CODE     0xB3L
-#define EXT_START_CODE     0xB5L
-#define SEQ_END_CODE       0xB7L
-#define GOP_START_CODE     0xB8L
-#define ISO_END_CODE       0xB9L
-#define PACK_START_CODE    0xBAL
-
-#define USER_DATA_START_CODE    0xb2
-#define SYSTEM_START_CODE       0xbb
-#define PADDING_CODE            0xbe
-#define PRIVATE_STREAM_1        0xbd
-#define PRIVATE_STREAM_2        0xbf
-#define SYSTEM_END_CODE         0xb9
-
-
-#endif



From gruntster at mail.berlios.de  Thu Feb 12 21:13:54 2009
From: gruntster at mail.berlios.de (gruntster at mail.berlios.de)
Date: Thu, 12 Feb 2009 21:13:54 +0100
Subject: [Avidemux-svn-commit] r4584 -
	branches/avidemux_2.5_branch_gruntster/platforms/windows/installer
Message-ID: <200902122013.n1CKDsOk011594@sheep.berlios.de>

Author: gruntster
Date: 2009-02-12 21:13:49 +0100 (Thu, 12 Feb 2009)
New Revision: 4584

Modified:
   branches/avidemux_2.5_branch_gruntster/platforms/windows/installer/avidemux.nsi
Log:
[Win32] update installer to remember previously selected components when upgrading

Modified: branches/avidemux_2.5_branch_gruntster/platforms/windows/installer/avidemux.nsi
===================================================================
--- branches/avidemux_2.5_branch_gruntster/platforms/windows/installer/avidemux.nsi	2009-02-11 06:27:26 UTC (rev 4583)
+++ branches/avidemux_2.5_branch_gruntster/platforms/windows/installer/avidemux.nsi	2009-02-12 20:13:49 UTC (rev 4584)
@@ -6,6 +6,7 @@
 !include nsDialogs.nsh
 !include Memento.nsh
 !include FileFunc.nsh
+!include WordFunc.nsh
 !include ${NSIDIR}\revision.nsh
 
 Name "Avidemux 2.5.0 beta r${REVISION}"
@@ -42,8 +43,8 @@
 !define MUI_STARTMENUPAGE_DEFAULTFOLDER Avidemux
 !define MUI_STARTMENUPAGE_NODISABLE
 !define MUI_WELCOMEFINISHPAGE_BITMAP "${NSIDIR}\WelcomeFinishStrip.bmp"
+!define MUI_UNWELCOMEFINISHPAGE_BITMAP "${NSIDIR}\WelcomeFinishStrip.bmp"
 !define MUI_UNICON "${NSIDIR}\..\..\..\avidemux\xpm\adm.ico"
-!define MUI_UNFINISHPAGE_NOAUTOCLOSE
 !define MUI_COMPONENTSPAGE_NODESC
 
 ##########################
@@ -53,12 +54,16 @@
 Var CreateStartMenuGroup
 Var CreateQuickLaunchIcon
 Var StartMenuGroup
+Var PreviousVersion
+Var PreviousVersionState
+Var ReinstallUninstall
 
 ##########################
 # Installer pages
 ##########################
 !insertmacro MUI_PAGE_WELCOME
 !insertmacro MUI_PAGE_LICENSE "${NSIDIR}\License.rtf"
+ Page custom ReinstallPage ReinstallPageLeave
 !define MUI_PAGE_CUSTOMFUNCTION_LEAVE CheckSelectedUIs
 !insertmacro MUI_PAGE_COMPONENTS
 Page custom InstallOptionsPage InstallOptionsPageLeave
@@ -66,6 +71,8 @@
 !insertmacro MUI_PAGE_STARTMENU Application $StartMenuGroup
 !insertmacro MUI_PAGE_DIRECTORY
 !define MUI_PAGE_CUSTOMFUNCTION_PRE ActivateInternalSections
+!define MUI_PAGE_CUSTOMFUNCTION_SHOW InstFilesPageShow
+!define MUI_PAGE_CUSTOMFUNCTION_LEAVE InstFilesPageLeave
 !insertmacro MUI_PAGE_INSTFILES
 !define MUI_FINISHPAGE_RUN
 !define MUI_FINISHPAGE_RUN_FUNCTION RunAvidemux
@@ -76,8 +83,12 @@
 !define MUI_FINISHPAGE_LINK_LOCATION "http://www.razorbyte.com.au/avidemux/"
 !define MUI_PAGE_CUSTOMFUNCTION_PRE ConfigureFinishPage
 !insertmacro MUI_PAGE_FINISH
+
+!define MUI_PAGE_CUSTOMFUNCTION_PRE un.ConfirmPagePre
 !insertmacro MUI_UNPAGE_CONFIRM
 !insertmacro MUI_UNPAGE_INSTFILES
+!define MUI_PAGE_CUSTOMFUNCTION_PRE un.FinishPagePre
+!insertmacro MUI_UNPAGE_FINISH
 
 ##########################
 # Installer languages
@@ -92,6 +103,7 @@
 CRCCheck on
 XPStyle on
 ShowInstDetails nevershow
+ShowUninstDetails nevershow
 VIProductVersion 2.5.0.${REVISION}
 VIAddVersionKey ProductName Avidemux
 VIAddVersionKey ProductVersion "${VERSION} (beta)"
@@ -99,7 +111,6 @@
 VIAddVersionKey FileDescription ""
 VIAddVersionKey LegalCopyright ""
 InstallDirRegKey HKLM "${REGKEY}" Path
-ShowUninstDetails nevershow
 BrandingText "Packaged by Gruntster"
 InstType Standard
 InstType Full
@@ -107,6 +118,9 @@
 ##########################
 # Uninstaller macros
 ##########################
+!insertmacro un.GetOptions
+!insertmacro un.GetParameters
+
 !define UninstallLogPath "$INSTDIR\uninstall.log"
 Var UninstallLogHandle
 
@@ -1081,6 +1095,7 @@
 Section -post SecUninstaller
     SectionIn 1 2
     WriteRegStr HKLM "${REGKEY}" Path $INSTDIR
+    WriteRegStr HKLM "${REGKEY}" Version ${VERSION}
     SetOutPath $INSTDIR
     WriteUninstaller $INSTDIR\uninstall.exe
     WriteRegStr HKLM "${UNINST_REGKEY}" DisplayName "${INTERNALNAME}"
@@ -1137,21 +1152,44 @@
 # Installer functions
 ##########################
 Function .onInit
-    ReadRegStr $R0  HKLM "${UNINST_REGKEY}" "UninstallString"
-    StrCmp $R0 "" startInstall
+	Call LoadPreviousSettings
 
-    MessageBox MB_YESNO|MB_ICONEXCLAMATION "${INTERNALNAME} has already been installed. $\n$\nDo you want to remove \
-      the previous version before installing $(^Name)?" IDNO startInstall
+	ReadRegStr $PreviousVersion HKLM "${REGKEY}" Version
 
-    # Run the uninstaller
-    ClearErrors
-    ExecWait '$R0 _?=$INSTDIR' ; Do not copy the uninstaller to a temp file
-
-startInstall:
+	${If} $PreviousVersion != ""
+		${VersionCompare} ${VERSION} $PreviousVersion $PreviousVersionState
+	${EndIf}
+	
     InitPluginsDir
+    SetShellVarContext all
+FunctionEnd
 
+Function .onInstSuccess
+	${MementoSectionSave}
+FunctionEnd
+
+Function .onSelChange
+	!insertmacro SectionFlagIsSet ${SecUiGtk} ${SF_SELECTED} end checkCLI
+checkCLI:
+	!insertmacro SectionFlagIsSet ${SecUiCli} ${SF_SELECTED} end disable
+
+disable:  # GTK langs only
+	SectionSetFlags ${SecLangCatalan} SF_RO
+	SectionSetFlags ${SecLangCzech} SF_RO
+	SectionSetFlags ${SecLangFrench} SF_RO
+	SectionSetFlags ${SecLangGerman} SF_RO
+	SectionSetFlags ${SecLangGreek} SF_RO
+	SectionSetFlags ${SecLangJapanese} SF_RO
+	SectionSetFlags ${SecLangRussian} SF_RO
+	SectionSetFlags ${SecLangSerbianCyrillic} SF_RO
+	SectionSetFlags ${SecLangSerbianLatin} SF_RO
+	SectionSetFlags ${SecLangSpanish} SF_RO
+	SectionSetFlags ${SecLangTurkish} SF_RO
+end:
+FunctionEnd
+
+Function LoadPreviousSettings
     ${MementoSectionRestore}
-    SetShellVarContext all
 	!insertmacro MUI_STARTMENU_GETFOLDER Application $StartMenuGroup
 
 #checkStartMenuGtk:
@@ -1181,28 +1219,30 @@
 end:
 FunctionEnd
 
-Function .onInstSuccess
-	${MementoSectionSave}
-FunctionEnd
+Function RunUninstaller
+    ReadRegStr $R1  HKLM "${UNINST_REGKEY}" "UninstallString"
 
-Function .onSelChange
-	!insertmacro SectionFlagIsSet ${SecUiGtk} ${SF_SELECTED} end checkCLI
-checkCLI:
-	!insertmacro SectionFlagIsSet ${SecUiCli} ${SF_SELECTED} end disable
+	${If} $R1 == ""
+		Return
+	${EndIf}
 
-disable:  # GTK langs only
-	SectionSetFlags ${SecLangCatalan} SF_RO
-	SectionSetFlags ${SecLangCzech} SF_RO
-	SectionSetFlags ${SecLangFrench} SF_RO
-	SectionSetFlags ${SecLangGerman} SF_RO
-	SectionSetFlags ${SecLangGreek} SF_RO	
-	SectionSetFlags ${SecLangJapanese} SF_RO
-	SectionSetFlags ${SecLangRussian} SF_RO
-	SectionSetFlags ${SecLangSerbianCyrillic} SF_RO
-	SectionSetFlags ${SecLangSerbianLatin} SF_RO
-	SectionSetFlags ${SecLangSpanish} SF_RO
-	SectionSetFlags ${SecLangTurkish} SF_RO
-end:
+	;Run uninstaller
+	HideWindow
+	ClearErrors
+	
+	${If} $PreviousVersionState == 0
+	${AndIf} $ReinstallUninstall == 1
+		ExecWait '$R1 _?=$INSTDIR'
+	${Else}
+		ExecWait '$R1 /frominstall _?=$INSTDIR'
+	${EndIf}
+
+	IfErrors NoRemoveUninstaller
+	IfFileExists "$INSTDIR\uninstall.exe" 0 NoRemoveUninstaller
+		Delete "$R1"
+		RMDir $INSTDIR
+
+NoRemoveUninstaller:
 FunctionEnd
 
 Function CheckSelectedUIs
@@ -1314,6 +1354,24 @@
     SectionSetFlags ${SecStartMenuQt4} $1
 FunctionEnd
 
+Function InstFilesPageShow
+	${If} $ReinstallUninstall != ""
+		Call RunUninstaller
+		BringToFront
+	${EndIf}
+FunctionEnd
+
+Function InstFilesPageLeave
+	; Don't advance automatically if details expanded
+	FindWindow $R0 "#32770" "" $HWNDPARENT
+	GetDlgItem $R0 $R0 1016
+	System::Call user32::IsWindowVisible(i$R0)i.s
+	Pop $R0
+
+	StrCmp $R0 0 +2
+	SetAutoClose false
+FunctionEnd
+
 Function ConfigureFinishPage
     SectionGetFlags ${SecUiGtk} $0
     IntOp $0 $0 & ${SF_SELECTED}
@@ -1350,11 +1408,95 @@
 end:
 FunctionEnd
 
+Var ReinstallUninstallButton
+
+Function ReinstallPage
+	${If} $PreviousVersion == ""
+		Abort
+	${EndIf}
+
+	nsDialogs::Create /NOUNLOAD 1018
+	Pop $0
+
+	${If} $PreviousVersionState == 1
+		!insertmacro MUI_HEADER_TEXT "Already Installed" "Choose how you want to install ${INTERNALNAME}."
+		nsDialogs::CreateItem /NOUNLOAD STATIC ${WS_VISIBLE}|${WS_CHILD}|${WS_CLIPSIBLINGS} 0 0 0 100% 40 "An older version of Avidemux is installed on your system.  Select the operation you want to perform and click Next to continue."
+		Pop $R0
+		nsDialogs::CreateItem /NOUNLOAD BUTTON ${BS_AUTORADIOBUTTON}|${BS_VCENTER}|${BS_MULTILINE}|${WS_VISIBLE}|${WS_CHILD}|${WS_CLIPSIBLINGS}|${WS_GROUP}|${WS_TABSTOP} 0 10 55 100% 30 "Upgrade Avidemux using previous settings (recommended)"
+		Pop $ReinstallUninstallButton
+		nsDialogs::CreateItem /NOUNLOAD BUTTON ${BS_AUTORADIOBUTTON}|${BS_TOP}|${BS_MULTILINE}|${WS_VISIBLE}|${WS_CHILD}|${WS_CLIPSIBLINGS} 0 10 85 100% 50 "Change settings (advanced)"
+		Pop $R0
+
+		${If} $ReinstallUninstall == ""
+			StrCpy $ReinstallUninstall 1
+		${EndIf}
+	${ElseIf} $PreviousVersionState == 2
+		!insertmacro MUI_HEADER_TEXT "Already Installed" "Choose how you want to install ${INTERNALNAME}."
+		nsDialogs::CreateItem /NOUNLOAD STATIC ${WS_VISIBLE}|${WS_CHILD}|${WS_CLIPSIBLINGS} 0 0 0 100% 40 "A newer version of FileZilla is already installed! It is not recommended that you downgrade to an older version. Select the operation you want to perform and click Next to continue."
+		Pop $R0
+		nsDialogs::CreateItem /NOUNLOAD BUTTON ${BS_AUTORADIOBUTTON}|${BS_VCENTER}|${BS_MULTILINE}|${WS_VISIBLE}|${WS_CHILD}|${WS_CLIPSIBLINGS}|${WS_GROUP}|${WS_TABSTOP} 0 10 55 100% 30 "Downgrade Avidemux using previous settings (recommended)"
+		Pop $ReinstallUninstallButton
+		nsDialogs::CreateItem /NOUNLOAD BUTTON ${BS_AUTORADIOBUTTON}|${BS_TOP}|${BS_MULTILINE}|${WS_VISIBLE}|${WS_CHILD}|${WS_CLIPSIBLINGS} 0 10 85 100% 50 "Change settings (advanced)"
+		Pop $R0
+
+		${If} $ReinstallUninstall == ""
+			StrCpy $ReinstallUninstall 1
+		${EndIf}
+	${ElseIf} $PreviousVersionState == 0
+		!insertmacro MUI_HEADER_TEXT "Already Installed" "Choose the maintenance option to perform."
+		nsDialogs::CreateItem /NOUNLOAD STATIC ${WS_VISIBLE}|${WS_CHILD}|${WS_CLIPSIBLINGS} 0 0 0 100% 40 "Avidemux ${VERSION} is already installed. Select the operation you want to perform and click Next to continue."
+		Pop $R0
+		nsDialogs::CreateItem /NOUNLOAD BUTTON ${BS_AUTORADIOBUTTON}|${BS_VCENTER}|${BS_MULTILINE}|${WS_VISIBLE}|${WS_CHILD}|${WS_CLIPSIBLINGS}|${WS_GROUP}|${WS_TABSTOP} 0 10 55 100% 30 "Add/Remove/Reinstall components"
+		Pop $R0
+		nsDialogs::CreateItem /NOUNLOAD BUTTON ${BS_AUTORADIOBUTTON}|${BS_TOP}|${BS_MULTILINE}|${WS_VISIBLE}|${WS_CHILD}|${WS_CLIPSIBLINGS} 0 10 85 100% 50 "Uninstall FileZilla"
+		Pop $ReinstallUninstallButton
+
+		${If} $ReinstallUninstall == ""
+			StrCpy $ReinstallUninstall 2
+		${EndIf}
+	${Else}
+		MessageBox MB_ICONSTOP "Unknown value of PreviousVersionState, aborting" /SD IDOK
+		Abort
+	${EndIf}
+
+	${If} $ReinstallUninstall == "1"
+		SendMessage $ReinstallUninstallButton ${BM_SETCHECK} 1 0
+	${Else}
+		SendMessage $R0 ${BM_SETCHECK} 1 0
+	${EndIf}
+
+	nsDialogs::Show
+FunctionEnd
+
+Function ReinstallPageLeave
+	SendMessage $ReinstallUninstallButton ${BM_GETCHECK} 0 0 $R0
+
+	${If} $R0 == 1
+		; Option to uninstall old version selected
+		StrCpy $ReinstallUninstall 1
+	${Else}
+		; Custom up/downgrade or add/remove/reinstall
+		StrCpy $ReinstallUninstall 2
+	${EndIf}
+
+	${If} $ReinstallUninstall == 1
+		${If} $PreviousVersionState == 0
+			Call RunUninstaller
+			Quit
+		${Else}
+			; Need to reload defaults. User could have
+			; chosen custom, change something, went back and selected
+			; the express option.
+			Call LoadPreviousSettings
+		${EndIf}
+	${EndIf}
+FunctionEnd
+
+
 ##########################
 # Uninstaller functions
 ##########################
 Function un.onInit
-	!insertmacro MUI_STARTMENU_GETFOLDER Application $StartMenuGroup
 	SetShellVarContext all
 FunctionEnd
 
@@ -1409,3 +1551,20 @@
 	FindClose $0
 	!undef Index
 FunctionEnd
+
+Function un.ConfirmPagePre
+	${un.GetParameters} $R0
+	${un.GetOptions} $R0 "/frominstall" $R1
+	${Unless} ${Errors}
+		Abort
+	${EndUnless}
+FunctionEnd
+
+Function un.FinishPagePre
+	${un.GetParameters} $R0
+	${un.GetOptions} $R0 "/frominstall" $R1
+	${Unless} ${Errors}
+		SetRebootFlag false
+		Abort
+	${EndUnless}
+FunctionEnd



From gruntster at mail.berlios.de  Fri Feb 13 23:29:46 2009
From: gruntster at mail.berlios.de (gruntster at mail.berlios.de)
Date: Fri, 13 Feb 2009 23:29:46 +0100
Subject: [Avidemux-svn-commit] r4585 -
	branches/avidemux_2.5_branch_gruntster/plugins
Message-ID: <200902132229.n1DMTkpS010405@sheep.berlios.de>

Author: gruntster
Date: 2009-02-13 23:29:42 +0100 (Fri, 13 Feb 2009)
New Revision: 4585

Removed:
   branches/avidemux_2.5_branch_gruntster/plugins/ADM_audiodecoder/
Log:
[svn] remove empty folders



From gruntster at mail.berlios.de  Sat Feb 14 00:10:36 2009
From: gruntster at mail.berlios.de (gruntster at mail.berlios.de)
Date: Sat, 14 Feb 2009 00:10:36 +0100
Subject: [Avidemux-svn-commit] r4586 - in
	branches/avidemux_2.5_branch_gruntster/platforms/windows:
	build_scripts/avidemux installer
Message-ID: <200902132310.n1DNAaiB016863@sheep.berlios.de>

Author: gruntster
Date: 2009-02-14 00:10:28 +0100 (Sat, 14 Feb 2009)
New Revision: 4586

Added:
   branches/avidemux_2.5_branch_gruntster/platforms/windows/installer/PageHeaderGtk.bmp
Modified:
   branches/avidemux_2.5_branch_gruntster/platforms/windows/build_scripts/avidemux/2b. Package Build.bat
   branches/avidemux_2.5_branch_gruntster/platforms/windows/installer/PageHeader.bmp
   branches/avidemux_2.5_branch_gruntster/platforms/windows/installer/avidemux.nsi
Log:
[Win32] split UIs to separate installers

Modified: branches/avidemux_2.5_branch_gruntster/platforms/windows/build_scripts/avidemux/2b. Package Build.bat
===================================================================
--- branches/avidemux_2.5_branch_gruntster/platforms/windows/build_scripts/avidemux/2b. Package Build.bat	2009-02-13 22:29:42 UTC (rev 4585)
+++ branches/avidemux_2.5_branch_gruntster/platforms/windows/build_scripts/avidemux/2b. Package Build.bat	2009-02-13 23:10:28 UTC (rev 4586)
@@ -7,8 +7,7 @@
 cd ..
 
 set curDir=%CD%
-set zipFile=avidemux_2.5_r%revisionNo%_win32.zip
-set exeFile=avidemux_2.5_r%revisionNo%_win32.exe
+set zipFile=avidemux_2.5_r%revisionNo%_full_win32.zip
 set packageDir=%CD%\%revisionNo%
 
 echo %packageDir%
@@ -23,8 +22,10 @@
 cd %curDir%
 advzip -z -4 "%packageDir%\%zipFile%"
 
-echo -- Generating %exeFile% --
 cd %buildDir%
-"%nsisDir%\makensis" /V2 /NOCD /DNSIDIR="%curDir%\..\..\installer" /DEXEDIR="%packageDir%" "%curDir%\..\..\installer\avidemux.nsi"
+echo -- Generating GTK+ Installer --
+"%nsisDir%\makensis" /V2 /NOCD /DINST_GTK /DNSIDIR="%curDir%\..\..\installer" /DEXEDIR="%packageDir%" "%curDir%\..\..\installer\avidemux.nsi"
+echo -- Generating Qt Installer --
+"%nsisDir%\makensis" /V2 /NOCD /DINST_QT /DNSIDIR="%curDir%\..\..\installer" /DEXEDIR="%packageDir%" "%curDir%\..\..\installer\avidemux.nsi"
 
 pause

Modified: branches/avidemux_2.5_branch_gruntster/platforms/windows/installer/PageHeader.bmp
===================================================================
(Binary files differ)

Copied: branches/avidemux_2.5_branch_gruntster/platforms/windows/installer/PageHeaderGtk.bmp (from rev 4583, branches/avidemux_2.5_branch_gruntster/platforms/windows/installer/PageHeader.bmp)

Modified: branches/avidemux_2.5_branch_gruntster/platforms/windows/installer/avidemux.nsi
===================================================================
--- branches/avidemux_2.5_branch_gruntster/platforms/windows/installer/avidemux.nsi	2009-02-13 22:29:42 UTC (rev 4585)
+++ branches/avidemux_2.5_branch_gruntster/platforms/windows/installer/avidemux.nsi	2009-02-13 23:10:28 UTC (rev 4586)
@@ -9,8 +9,6 @@
 !include WordFunc.nsh
 !include ${NSIDIR}\revision.nsh
 
-Name "Avidemux 2.5.0 beta r${REVISION}"
-
 SetCompressor /SOLID lzma
 SetCompressorDictSize 96
 
@@ -24,6 +22,30 @@
 !define COMPANY "Free Software Foundation"
 !define URL "http://www.avidemux.org"
 
+!ifndef INST_GTK
+!ifndef INST_QT
+!define INST_GTK
+!define INST_QT
+!endif
+!endif
+
+!ifdef INST_GTK
+!ifdef INST_QT
+!define INST_BOTH
+!endif
+!endif
+
+!ifdef INST_BOTH
+OutFile ${EXEDIR}\avidemux_2.5_r${REVISION}_full_win32.exe
+Name "Avidemux 2.5.0 Full beta r${REVISION}"
+!else ifdef INST_QT
+OutFile ${EXEDIR}\avidemux_2.5_r${REVISION}_win32.exe
+Name "Avidemux 2.5.0 beta r${REVISION}"
+!else ifdef INST_GTK
+OutFile ${EXEDIR}\avidemux_2.5_r${REVISION}_gtk_win32.exe
+Name "Avidemux 2.5.0 GTK+ beta r${REVISION}"
+!endif
+
 ##########################
 # Memento defines
 ##########################
@@ -36,7 +58,11 @@
 !define MUI_ICON "${NSISDIR}\Contrib\Graphics\Icons\modern-install-blue-full.ico"
 !define MUI_HEADERIMAGE
 !define MUI_HEADERIMAGE_RIGHT
+!ifdef INST_GTK
+!define MUI_HEADERIMAGE_BITMAP "${NSIDIR}\PageHeaderGtk.bmp"
+!else
 !define MUI_HEADERIMAGE_BITMAP "${NSIDIR}\PageHeader.bmp"
+!endif
 !define MUI_STARTMENUPAGE_REGISTRY_ROOT HKLM
 !define MUI_STARTMENUPAGE_REGISTRY_KEY "${REGKEY}"
 !define MUI_STARTMENUPAGE_REGISTRY_VALUENAME StartMenuGroup
@@ -44,7 +70,11 @@
 !define MUI_STARTMENUPAGE_NODISABLE
 !define MUI_WELCOMEFINISHPAGE_BITMAP "${NSIDIR}\WelcomeFinishStrip.bmp"
 !define MUI_UNWELCOMEFINISHPAGE_BITMAP "${NSIDIR}\WelcomeFinishStrip.bmp"
+!ifdef INST_GTK
 !define MUI_UNICON "${NSIDIR}\..\..\..\avidemux\xpm\adm.ico"
+!else
+!define MUI_UNICON "${NSIDIR}\..\..\..\avidemux\xpm\avidemux.ico"
+!endif
 !define MUI_COMPONENTSPAGE_NODESC
 
 ##########################
@@ -64,9 +94,11 @@
 !insertmacro MUI_PAGE_WELCOME
 !insertmacro MUI_PAGE_LICENSE "${NSIDIR}\License.rtf"
  Page custom ReinstallPage ReinstallPageLeave
+!ifdef INST_BOTH
 !define MUI_PAGE_CUSTOMFUNCTION_LEAVE CheckSelectedUIs
+!endif
 !insertmacro MUI_PAGE_COMPONENTS
-Page custom InstallOptionsPage InstallOptionsPageLeave
+Page custom InstallOptionsPage
 !define MUI_PAGE_CUSTOMFUNCTION_PRE IsStartMenuRequired
 !insertmacro MUI_PAGE_STARTMENU Application $StartMenuGroup
 !insertmacro MUI_PAGE_DIRECTORY
@@ -79,7 +111,7 @@
 !define MUI_FINISHPAGE_RUN_TEXT "Run ${INTERNALNAME} now"
 !define MUI_FINISHPAGE_SHOWREADME "$INSTDIR\Change Log.html"
 !define MUI_FINISHPAGE_SHOWREADME_TEXT "View Change Log now"
-!define MUI_FINISHPAGE_LINK "Visit the Avidemux Win32 Builds website"
+!define MUI_FINISHPAGE_LINK "Visit the Avidemux Windows Builds website"
 !define MUI_FINISHPAGE_LINK_LOCATION "http://www.razorbyte.com.au/avidemux/"
 !define MUI_PAGE_CUSTOMFUNCTION_PRE ConfigureFinishPage
 !insertmacro MUI_PAGE_FINISH
@@ -98,8 +130,7 @@
 ##########################
 # Installer attributes
 ##########################
-OutFile ${EXEDIR}\avidemux_2.5_r${REVISION}_win32.exe
-InstallDir "$PROGRAMFILES\Avidemux 2.5"
+InstallDir "$PROGRAMFILES\${INTERNALNAME}"
 CRCCheck on
 XPStyle on
 ShowInstDetails nevershow
@@ -187,6 +218,7 @@
 # Macros
 ##########################
 !macro InstallGtkLanguage LANG_NAME LANG_CODE
+!ifdef INST_GTK
 	SetOverwrite on
 
 	!insertmacro SectionFlagIsSet ${SecUiGtk} ${SF_SELECTED} installGtk${LANG_CODE} endGtk${LANG_CODE}
@@ -197,19 +229,22 @@
     ${File} share\locale\${LANG_CODE}\LC_MESSAGES\gtk20.mo
 
 endGtk${LANG_CODE}:
+!endif
 !macroend
 
-!macro InstallQt4Language LANG_NAME LANG_CODE
+!macro InstallQtLanguage LANG_NAME LANG_CODE
+!ifdef INST_QT
 	SetOverwrite on
 
-	!insertmacro SectionFlagIsSet ${SecUiQt4} ${SF_SELECTED} installQt4${LANG_CODE} endQt4${LANG_CODE}
+	!insertmacro SectionFlagIsSet ${SecUiQt} ${SF_SELECTED} installQt${LANG_CODE} endQt${LANG_CODE}
 
-installQt4${LANG_CODE}:	
+installQt${LANG_CODE}:
 	SetOutPath $INSTDIR\i18n
     ${File} i18n\avidemux_${LANG_CODE}.qm
     ${File} i18n\qt_${LANG_CODE}.qm
 
-endQt4${LANG_CODE}:
+endQt${LANG_CODE}:
+!endif
 !macroend
 
 ##########################
@@ -221,7 +256,7 @@
 	FileSeek $UninstallLogHandle 0 END
 SectionEnd
 
-Section "Core files (required)" SecCore
+Section "Avidemux Core" SecCore
     SectionIn 1 2 RO
     SetOutPath $INSTDIR
     SetOverwrite on
@@ -266,8 +301,14 @@
         ${File} libADM_UICli.dll
     ${MementoSectionEnd}
 
-    ${MementoUnselectedSection} GTK+ SecUiGtk
-        SectionIn 2
+!ifdef INST_BOTH
+	${MementoUnselectedSection} GTK+ SecUiGtk    
+	SectionIn 2
+!else ifdef INST_GTK
+	${MementoSection} GTK+ SecUiGtk    
+	SectionIn 1 2 RO
+!endif
+!ifdef INST_BOTH | INST_GTK
         SetOverwrite on
         SetOutPath $INSTDIR\etc\gtk-2.0
         ${Folder} etc\gtk-2.0
@@ -299,9 +340,15 @@
         ${File} libpng12-0.dll
         ${File} libtiff3.dll
     ${MementoSectionEnd}
+!endif
 
-    ${MementoSection} Qt4 SecUiQt4
+!ifdef INST_QT
+    ${MementoSection} Qt SecUiQt
+!ifdef INST_BOTH
         SectionIn 1 2
+!else
+		SectionIn 1 2 RO
+!endif
         SetOutPath $INSTDIR
         SetOverwrite on
         ${File} QtGui4.dll
@@ -311,6 +358,7 @@
         ${File} mingwm10.dll
         ${File} QtCore4.dll
     ${MementoSectionEnd}
+!endif
 SectionGroupEnd
 
 SectionGroup Plugins SecGrpPlugin
@@ -408,14 +456,18 @@
 			SetOutPath $INSTDIR\lib\ADM_plugins\videoEncoder
 			${File} lib\ADM_plugins\videoEncoder\libADM_vidEnc_x264.dll
 			SetOutPath $INSTDIR\lib\ADM_plugins\videoEncoder\x264
-			!insertmacro SectionFlagIsSet ${SecUiGtk} ${SF_SELECTED} InstallGtk CheckQt4
+!ifdef INST_GTK
+			!insertmacro SectionFlagIsSet ${SecUiGtk} ${SF_SELECTED} InstallGtk CheckQt
 InstallGtk:
 			${File} lib\ADM_plugins\videoEncoder\x264\libADM_vidEnc_x264_Gtk.dll
-CheckQt4:
-			!insertmacro SectionFlagIsSet ${SecUiQt4} ${SF_SELECTED} InstallQt4 End
-InstallQt4:
+CheckQt:
+!endif
+!ifdef INST_QT
+			!insertmacro SectionFlagIsSet ${SecUiQt} ${SF_SELECTED} InstallQt End
+InstallQt:
 			${File} lib\ADM_plugins\videoEncoder\x264\libADM_vidEnc_x264_Qt.dll
 End:
+!endif
 			${File} lib\ADM_plugins\videoEncoder\x264\x264Param.xsd
 			${File} lib\ADM_plugins\videoEncoder\x264\*.xml
 			SetOutPath $INSTDIR
@@ -426,15 +478,19 @@
 			SetOverwrite on
 			SetOutPath $INSTDIR\lib\ADM_plugins\videoEncoder
 			${File} lib\ADM_plugins\videoEncoder\libADM_vidEnc_xvid.dll
-SetOutPath $INSTDIR\lib\ADM_plugins\videoEncoder\xvid
-			!insertmacro SectionFlagIsSet ${SecUiGtk} ${SF_SELECTED} InstallGtk CheckQt4
+			SetOutPath $INSTDIR\lib\ADM_plugins\videoEncoder\xvid
+!ifdef INST_GTK
+			!insertmacro SectionFlagIsSet ${SecUiGtk} ${SF_SELECTED} InstallGtk CheckQt
 InstallGtk:
 			${File} lib\ADM_plugins\videoEncoder\xvid\libADM_vidEnc_Xvid_Gtk.dll
-CheckQt4:
-			!insertmacro SectionFlagIsSet ${SecUiQt4} ${SF_SELECTED} InstallQt4 End
-InstallQt4:
+CheckQt:
+!endif
+!ifdef INST_QT
+			!insertmacro SectionFlagIsSet ${SecUiQt} ${SF_SELECTED} InstallQt End
+InstallQt:
 			${File} lib\ADM_plugins\videoEncoder\xvid\libADM_vidEnc_Xvid_Qt.dll
 End:
+!endif
 			${File} lib\ADM_plugins\videoEncoder\xvid\XvidParam.xsd
 			#${File} lib\ADM_plugins\videoEncoder\xvid\*.xml
 			SetOutPath $INSTDIR
@@ -453,15 +509,18 @@
 				SectionIn 1 2
 				SetOverwrite on
 				SetOutPath $INSTDIR\lib\ADM_plugins\videoFilter
-
-				!insertmacro SectionFlagIsSet ${SecUiGtk} ${SF_SELECTED} InstallGtk CheckQt4
+!ifdef INST_GTK
+				!insertmacro SectionFlagIsSet ${SecUiGtk} ${SF_SELECTED} InstallGtk CheckQt
 InstallGtk:
 				${File} lib\ADM_plugins\videoFilter\libADM_vf_avisynthResize_gtk.dll
-CheckQt4:
-				!insertmacro SectionFlagIsSet ${SecUiQt4} ${SF_SELECTED} InstallQt4 End
-InstallQt4:
+CheckQt:
+!endif
+!ifdef INST_QT
+				!insertmacro SectionFlagIsSet ${SecUiQt} ${SF_SELECTED} InstallQt End
+InstallQt:
 				${File} lib\ADM_plugins\videoFilter\libADM_vf_avisynthResize_qt4.dll
 End:
+!endif
 			${MementoSectionEnd}
 			${MementoSection} "Blacken Borders" SecVidFltBlackenBorders
 				SectionIn 1 2
@@ -473,15 +532,18 @@
 				SectionIn 1 2
 				SetOverwrite on
 				SetOutPath $INSTDIR\lib\ADM_plugins\videoFilter
-
-				!insertmacro SectionFlagIsSet ${SecUiGtk} ${SF_SELECTED} InstallGtk CheckQt4
+!ifdef INST_GTK
+				!insertmacro SectionFlagIsSet ${SecUiGtk} ${SF_SELECTED} InstallGtk CheckQt
 InstallGtk:
 				${File} lib\ADM_plugins\videoFilter\libADM_vf_Crop_gtk.dll
-CheckQt4:
-				!insertmacro SectionFlagIsSet ${SecUiQt4} ${SF_SELECTED} InstallQt4 End
-InstallQt4:
+CheckQt:
+!endif
+!ifdef INST_QT
+				!insertmacro SectionFlagIsSet ${SecUiQt} ${SF_SELECTED} InstallQt End
+InstallQt:
 				${File} lib\ADM_plugins\videoFilter\libADM_vf_crop_qt4.dll
 End:
+!endif
 			${MementoSectionEnd}
 			${MementoSection} "Fade" SecVidFltFade
 				SectionIn 1 2
@@ -493,15 +555,18 @@
 				SectionIn 1 2
 				SetOverwrite on
 				SetOutPath $INSTDIR\lib\ADM_plugins\videoFilter
-
-				!insertmacro SectionFlagIsSet ${SecUiGtk} ${SF_SELECTED} InstallGtk CheckQt4
+!ifdef INST_GTK
+				!insertmacro SectionFlagIsSet ${SecUiGtk} ${SF_SELECTED} InstallGtk CheckQt
 InstallGtk:
 				${File} lib\ADM_plugins\videoFilter\libADM_vf_mplayerResize_gtk.dll
-CheckQt4:
-				!insertmacro SectionFlagIsSet ${SecUiQt4} ${SF_SELECTED} InstallQt4 End
-InstallQt4:
+CheckQt:
+!endif
+!ifdef INST_QT
+				!insertmacro SectionFlagIsSet ${SecUiQt} ${SF_SELECTED} InstallQt End
+InstallQt:
 				${File} lib\ADM_plugins\videoFilter\libADM_vf_mplayerResize_qt4.dll
 End:
+!endif
 			${MementoSectionEnd}
 			${MementoSection} "Resample FPS" SecVidFltResampleFps
 				SectionIn 1 2
@@ -691,15 +756,18 @@
 				SectionIn 1 2
 				SetOverwrite on
 				SetOutPath $INSTDIR\lib\ADM_plugins\videoFilter
-
-				!insertmacro SectionFlagIsSet ${SecUiGtk} ${SF_SELECTED} InstallGtk CheckQt4
+!ifdef INST_GTK
+				!insertmacro SectionFlagIsSet ${SecUiGtk} ${SF_SELECTED} InstallGtk CheckQt
 InstallGtk:
 				${File} lib\ADM_plugins\videoFilter\libADM_vf_colorYUV_gtk.dll
-CheckQt4:
-				!insertmacro SectionFlagIsSet ${SecUiQt4} ${SF_SELECTED} InstallQt4 End
-InstallQt4:
+CheckQt:
+!endif
+!ifdef INST_QT
+				!insertmacro SectionFlagIsSet ${SecUiQt} ${SF_SELECTED} InstallQt End
+InstallQt:
 				${File} lib\ADM_plugins\videoFilter\libADM_vf_colorYUV_qt4.dll
 End:
+!endif
 			${MementoSectionEnd}
 			${MementoSection} "Blend Removal" SecVidFltBlendRemoval
 				SectionIn 1 2
@@ -711,15 +779,18 @@
 				SectionIn 1 2
 				SetOverwrite on
 				SetOutPath $INSTDIR\lib\ADM_plugins\videoFilter
-
-				!insertmacro SectionFlagIsSet ${SecUiGtk} ${SF_SELECTED} InstallGtk CheckQt4
+!ifdef INST_GTK
+				!insertmacro SectionFlagIsSet ${SecUiGtk} ${SF_SELECTED} InstallGtk CheckQt
 InstallGtk:
 				${File} lib\ADM_plugins\videoFilter\libADM_vf_chromaShift_gtk.dll
-CheckQt4:
-				!insertmacro SectionFlagIsSet ${SecUiQt4} ${SF_SELECTED} InstallQt4 End
-InstallQt4:
+CheckQt:
+!endif
+!ifdef INST_QT
+				!insertmacro SectionFlagIsSet ${SecUiQt} ${SF_SELECTED} InstallQt End
+InstallQt:
 				${File} lib\ADM_plugins\videoFilter\libADM_vf_chromaShift_qt4.dll
 End:
+!endif
 			${MementoSectionEnd}
 			${MementoSection} "Chroma U" SecVidFltChromaU
 				SectionIn 1 2
@@ -737,15 +808,18 @@
 				SectionIn 1 2
 				SetOverwrite on
 				SetOutPath $INSTDIR\lib\ADM_plugins\videoFilter
-
-				!insertmacro SectionFlagIsSet ${SecUiGtk} ${SF_SELECTED} InstallGtk CheckQt4
+!ifdef INST_GTK
+				!insertmacro SectionFlagIsSet ${SecUiGtk} ${SF_SELECTED} InstallGtk CheckQt
 InstallGtk:
 				${File} lib\ADM_plugins\videoFilter\libADM_vf_contrast_gtk.dll
-CheckQt4:
-				!insertmacro SectionFlagIsSet ${SecUiQt4} ${SF_SELECTED} InstallQt4 End
-InstallQt4:
+CheckQt:
+!endif
+!ifdef INST_QT
+				!insertmacro SectionFlagIsSet ${SecUiQt} ${SF_SELECTED} InstallQt End
+InstallQt:
 				${File} lib\ADM_plugins\videoFilter\libADM_vf_contrast_qt4.dll
 End:
+!endif
 			${MementoSectionEnd}
 			${MementoSection} "Luma Delta" SecVidFltLumaDelta
 				SectionIn 1 2
@@ -757,15 +831,18 @@
 				SectionIn 1 2
 				SetOverwrite on
 				SetOutPath $INSTDIR\lib\ADM_plugins\videoFilter
-
-				!insertmacro SectionFlagIsSet ${SecUiGtk} ${SF_SELECTED} InstallGtk CheckQt4
+!ifdef INST_GTK
+				!insertmacro SectionFlagIsSet ${SecUiGtk} ${SF_SELECTED} InstallGtk CheckQt
 InstallGtk:
 				${File} lib\ADM_plugins\videoFilter\libADM_vf_equalizer_gtk.dll
-CheckQt4:
-				!insertmacro SectionFlagIsSet ${SecUiQt4} ${SF_SELECTED} InstallQt4 End
-InstallQt4:
+CheckQt:
+!endif
+!ifdef INST_QT
+				!insertmacro SectionFlagIsSet ${SecUiQt} ${SF_SELECTED} InstallQt End
+InstallQt:
 				${File} lib\ADM_plugins\videoFilter\libADM_vf_equalizer_qt4.dll
 End:
+!endif
 			${MementoSectionEnd}
 			${MementoSection} "Luma Only" SecVidFltLumaOnly
 				SectionIn 1 2
@@ -777,29 +854,35 @@
 				SectionIn 1 2
 				SetOverwrite on
 				SetOutPath $INSTDIR\lib\ADM_plugins\videoFilter
-
-				!insertmacro SectionFlagIsSet ${SecUiGtk} ${SF_SELECTED} InstallGtk CheckQt4
+!ifdef INST_GTK
+				!insertmacro SectionFlagIsSet ${SecUiGtk} ${SF_SELECTED} InstallGtk CheckQt
 InstallGtk:
 				${File} lib\ADM_plugins\videoFilter\libADM_vf_eq2_gtk.dll
-CheckQt4:
-				!insertmacro SectionFlagIsSet ${SecUiQt4} ${SF_SELECTED} InstallQt4 End
-InstallQt4:
+CheckQt:
+!endif
+!ifdef INST_QT
+				!insertmacro SectionFlagIsSet ${SecUiQt} ${SF_SELECTED} InstallQt End
+InstallQt:
 				${File} lib\ADM_plugins\videoFilter\libADM_vf_eq2_qt4.dll
 End:
+!endif
 			${MementoSectionEnd}
 			${MementoSection} "Mplayer Hue" SecVidFltMPlayerHue
 				SectionIn 1 2
 				SetOverwrite on
 				SetOutPath $INSTDIR\lib\ADM_plugins\videoFilter
-
-				!insertmacro SectionFlagIsSet ${SecUiGtk} ${SF_SELECTED} InstallGtk CheckQt4
+!ifdef INST_GTK
+				!insertmacro SectionFlagIsSet ${SecUiGtk} ${SF_SELECTED} InstallGtk CheckQt
 InstallGtk:
 				${File} lib\ADM_plugins\videoFilter\libADM_vf_hue_gtk.dll
-CheckQt4:
-				!insertmacro SectionFlagIsSet ${SecUiQt4} ${SF_SELECTED} InstallQt4 End
-InstallQt4:
+CheckQt:
+!endif
+!ifdef INST_QT
+				!insertmacro SectionFlagIsSet ${SecUiQt} ${SF_SELECTED} InstallQt End
+InstallQt:
 				${File} lib\ADM_plugins\videoFilter\libADM_vf_hue_qt4.dll
 End:
+!endif
 			${MementoSectionEnd}
 			${MementoSection} "Swap U and V" SecVidFltSwapUandV
 				SectionIn 1 2
@@ -813,15 +896,18 @@
 				SectionIn 1 2
 				SetOverwrite on
 				SetOutPath $INSTDIR\lib\ADM_plugins\videoFilter
-
-				!insertmacro SectionFlagIsSet ${SecUiGtk} ${SF_SELECTED} InstallGtk CheckQt4
+!ifdef INST_GTK
+				!insertmacro SectionFlagIsSet ${SecUiGtk} ${SF_SELECTED} InstallGtk CheckQt
 InstallGtk:
 				${File} lib\ADM_plugins\videoFilter\libADM_vf_cnr2_gtk.dll
-CheckQt4:
-				!insertmacro SectionFlagIsSet ${SecUiQt4} ${SF_SELECTED} InstallQt4 End
-InstallQt4:
+CheckQt:
+!endif
+!ifdef INST_QT
+				!insertmacro SectionFlagIsSet ${SecUiQt} ${SF_SELECTED} InstallQt End
+InstallQt:
 				${File} lib\ADM_plugins\videoFilter\libADM_vf_cnr2_qt4.dll
 End:
+!endif
 			${MementoSectionEnd}
 			${MementoSection} "Denoise" SecVidFltDenoise
 				SectionIn 1 2
@@ -883,15 +969,18 @@
 				SectionIn 1 2
 				SetOverwrite on
 				SetOutPath $INSTDIR\lib\ADM_plugins\videoFilter
-
-				!insertmacro SectionFlagIsSet ${SecUiGtk} ${SF_SELECTED} InstallGtk CheckQt4
+!ifdef INST_GTK
+				!insertmacro SectionFlagIsSet ${SecUiGtk} ${SF_SELECTED} InstallGtk CheckQt
 InstallGtk:
 				${File} lib\ADM_plugins\videoFilter\libADM_vf_asharp_gtk.dll
-CheckQt4:
-				!insertmacro SectionFlagIsSet ${SecUiQt4} ${SF_SELECTED} InstallQt4 End
-InstallQt4:
+CheckQt:
+!endif
+!ifdef INST_QT
+				!insertmacro SectionFlagIsSet ${SecUiQt} ${SF_SELECTED} InstallQt End
+InstallQt:
 				${File} lib\ADM_plugins\videoFilter\libADM_vf_asharp_qt4.dll
 End:
+!endif
 			${MementoSectionEnd}
 			${MementoSection} "MSharpen" SecVidFltMSharpen
 				SectionIn 1 2
@@ -923,15 +1012,18 @@
 				SectionIn 1 2
 				SetOverwrite on
 				SetOutPath $INSTDIR\lib\ADM_plugins\videoFilter
-
-				!insertmacro SectionFlagIsSet ${SecUiGtk} ${SF_SELECTED} InstallGtk CheckQt4
+!ifdef INST_GTK
+				!insertmacro SectionFlagIsSet ${SecUiGtk} ${SF_SELECTED} InstallGtk CheckQt
 InstallGtk:
 				${File} lib\ADM_plugins\videoFilter\libADM_vf_sub_gtk.dll
-CheckQt4:
-				!insertmacro SectionFlagIsSet ${SecUiQt4} ${SF_SELECTED} InstallQt4 End
-InstallQt4:
+CheckQt:
+!endif
+!ifdef INST_QT
+				!insertmacro SectionFlagIsSet ${SecUiQt} ${SF_SELECTED} InstallQt End
+InstallQt:
 				${File} lib\ADM_plugins\videoFilter\libADM_vf_sub_qt4.dll
 End:
+!endif
 			${MementoSectionEnd}
 		SectionGroupEnd
 		SectionGroup "Miscellaneous Filters" SecGrpVideoFilterMiscellaneous
@@ -945,15 +1037,18 @@
 				SectionIn 1 2
 				SetOverwrite on
 				SetOutPath $INSTDIR\lib\ADM_plugins\videoFilter
-
-				!insertmacro SectionFlagIsSet ${SecUiGtk} ${SF_SELECTED} InstallGtk CheckQt4
+!ifdef INST_GTK
+				!insertmacro SectionFlagIsSet ${SecUiGtk} ${SF_SELECTED} InstallGtk CheckQt
 InstallGtk:
 				${File} lib\ADM_plugins\videoFilter\libADM_vf_mpdelogo_gtk.dll
-CheckQt4:
-				!insertmacro SectionFlagIsSet ${SecUiQt4} ${SF_SELECTED} InstallQt4 End
-InstallQt4:
+CheckQt:
+!endif
+!ifdef INST_QT
+				!insertmacro SectionFlagIsSet ${SecUiQt} ${SF_SELECTED} InstallQt End
+InstallQt:
 				${File} lib\ADM_plugins\videoFilter\libADM_vf_mpdelogo_qt4.dll
 End:
+!endif
 			${MementoSectionEnd}
 			${MementoSection} "Whirl" SecVidFltWhirl
 				SectionIn 1 2
@@ -966,68 +1061,122 @@
 SectionGroupEnd
 
 SectionGroup "Additional languages" SecGrpLang
+!ifdef INST_BOTH | INST_GTK
+!ifdef INST_BOTH
     ${MementoUnselectedSection} "Catalan (GTK+ only)" SecLangCatalan
+!else ifdef INST_GTK
+	${MementoUnselectedSection} "Catalan" SecLangCatalan
+!endif
         SectionIn 2
         !insertmacro InstallGtkLanguage Catalan ca
     ${MementoSectionEnd}
+!endif
 
     ${MementoUnselectedSection} "Czech" SecLangCzech
         SectionIn 2
         !insertmacro InstallGtkLanguage Czech cs
-        !insertmacro InstallQt4Language Czech cs
+        !insertmacro InstallQtLanguage Czech cs
     ${MementoSectionEnd}
 
     ${MementoUnselectedSection} "French" SecLangFrench
         SectionIn 2
         !insertmacro InstallGtkLanguage French fr
-        !insertmacro InstallQt4Language French fr
+        !insertmacro InstallQtLanguage French fr
     ${MementoSectionEnd}
 
+!ifdef INST_BOTH | INST_GTK
+!ifdef INST_BOTH
     ${MementoUnselectedSection} "German (GTK+ only)" SecLangGerman
+!else ifdef INST_GTK
+	${MementoUnselectedSection} "German" SecLangGerman
+!endif
         SectionIn 2
         !insertmacro InstallGtkLanguage German de
     ${MementoSectionEnd}
+!endif
 
+!ifdef INST_BOTH | INST_GTK
+!ifdef INST_BOTH
     ${MementoUnselectedSection} "Greek (GTK+ only)" SecLangGreek
+!else ifdef INST_GTK
+	${MementoUnselectedSection} "Greek" SecLangGreek
+!endif
         SectionIn 2
         !insertmacro InstallGtkLanguage Greek el
     ${MementoSectionEnd}
+!endif
 
     ${MementoUnselectedSection} "Italian" SecLangItalian
         SectionIn 2
         !insertmacro InstallGtkLanguage Italian it
-        !insertmacro InstallQt4Language Italian it
+        !insertmacro InstallQtLanguage Italian it
     ${MementoSectionEnd}
 
+!ifdef INST_BOTH | INST_GTK
+!ifdef INST_BOTH
     ${MementoUnselectedSection} "Japanese (GTK+ only)" SecLangJapanese
+!else ifdef INST_GTK
+	${MementoUnselectedSection} "Japanese" SecLangJapanese
+!endif
         SectionIn 2
         !insertmacro InstallGtkLanguage Japanese ja
     ${MementoSectionEnd}
+!endif
 
+!ifdef INST_BOTH | INST_GTK
+!ifdef INST_BOTH
     ${MementoUnselectedSection} "Russian (GTK+ only)" SecLangRussian
+!else ifdef INST_GTK
+	${MementoUnselectedSection} "Russian" SecLangRussian
+!endif
         SectionIn 2
         !insertmacro InstallGtkLanguage Russian ru
     ${MementoSectionEnd}
+!endif
 
+!ifdef INST_BOTH | INST_GTK
+!ifdef INST_BOTH
     ${MementoUnselectedSection} "Serbian Cyrillic (GTK+ only)" SecLangSerbianCyrillic
+!else ifdef INST_GTK
+    ${MementoUnselectedSection} "Serbian Cyrillic" SecLangSerbianCyrillic
+!endif
         SectionIn 2
         !insertmacro InstallGtkLanguage SerbianCyrillic sr
     ${MementoSectionEnd}
+!endif
 
-    ${MementoUnselectedSection} "Serbian Latin (GTK+ only)" SecLangSerbianLatin
+!ifdef INST_BOTH | INST_GTK
+!ifdef INST_BOTH
+	${MementoUnselectedSection} "Serbian Latin (GTK+ only)" SecLangSerbianLatin
+!else ifdef INST_GTK
+    ${MementoUnselectedSection} "Serbian Latin" SecLangSerbianLatin
+!endif
         SectionIn 2
         !insertmacro InstallGtkLanguage SerbianLatin sr at latin
     ${MementoSectionEnd}
+!endif
 
+!ifdef INST_BOTH | INST_GTK
+!ifdef INST_BOTH
     ${MementoUnselectedSection} "Spanish (GTK+ only)" SecLangSpanish
+!else ifdef INST_GTK
+	${MementoUnselectedSection} "Spanish" SecLangSpanish
+!endif
         SectionIn 2
         !insertmacro InstallGtkLanguage Spanish es
     ${MementoSectionEnd}
+!endif
 
+!ifdef INST_BOTH | INST_GTK
+!ifdef INST_BOTH
     ${MementoUnselectedSection} "Turkish (GTK+ only)" SecLangTurkish
+!else ifdef INST_GTK
+	${MementoUnselectedSection} "Turkish" SecLangTurkish
+!endif
         SectionIn 2
         !insertmacro InstallGtkLanguage Turkish tr
     ${MementoSectionEnd}
+!endif
 SectionGroupEnd
 
 ${MementoUnselectedSection} "Avisynth Proxy" SecAvsProxy
@@ -1047,19 +1196,23 @@
 ${MementoSectionEnd}
 
 ${MementoSection} "-Start menu GTK+" SecStartMenuGtk
+!ifdef INST_GTK
     CreateDirectory $SMPROGRAMS\$StartMenuGroup
     !insertmacro MUI_STARTMENU_WRITE_BEGIN Application
     SetOutPath $INSTDIR
     CreateShortcut "$SMPROGRAMS\$StartMenuGroup\${INTERNALNAME} GTK+.lnk" $INSTDIR\avidemux2_gtk.exe
     !insertmacro MUI_STARTMENU_WRITE_END
+!endif
 ${MementoSectionEnd}
 
-${MementoSection} "-Start menu Qt4" SecStartMenuQt4
+${MementoSection} "-Start menu Qt" SecStartMenuQt
+!ifdef INST_QT
     CreateDirectory $SMPROGRAMS\$StartMenuGroup
     !insertmacro MUI_STARTMENU_WRITE_BEGIN Application
     SetOutPath $INSTDIR
-    CreateShortcut "$SMPROGRAMS\$StartMenuGroup\${INTERNALNAME} Qt4.lnk" $INSTDIR\avidemux2_qt4.exe
+    CreateShortcut "$SMPROGRAMS\$StartMenuGroup\${INTERNALNAME} Qt.lnk" $INSTDIR\avidemux2_qt4.exe
     !insertmacro MUI_STARTMENU_WRITE_END
+!endif
 ${MementoSectionEnd}
 
 ${MementoSection} "-Start menu AVS Proxy GUI" SecStartMenuAvsProxyGui
@@ -1071,23 +1224,31 @@
 ${MementoSectionEnd}
 
 ${MementoSection} "-Quick Launch GTK+" SecQuickLaunchGtk
+!ifdef INST_GTK
     SetOutPath $INSTDIR
     CreateShortcut "$QUICKLAUNCH\${INTERNALNAME} GTK+.lnk" $INSTDIR\avidemux2_gtk.exe
+!endif
 ${MementoSectionEnd}
 
-${MementoSection} "-Quick Launch Qt4" SecQuickLaunchQt4
+${MementoSection} "-Quick Launch Qt" SecQuickLaunchQt
+!ifdef INST_QT
     SetOutPath $INSTDIR
-    CreateShortcut "$QUICKLAUNCH\${INTERNALNAME} Qt4.lnk" $INSTDIR\avidemux2_qt4.exe
+    CreateShortcut "$QUICKLAUNCH\${INTERNALNAME} Qt.lnk" $INSTDIR\avidemux2_qt4.exe
+!endif
 ${MementoSectionEnd}
 
 ${MementoSection} "-Desktop GTK+" SecDesktopGtk
+!ifdef INST_GTK
     SetOutPath $INSTDIR
     CreateShortcut "$DESKTOP\${INTERNALNAME} GTK+.lnk" $INSTDIR\avidemux2_gtk.exe
+!endif
 ${MementoSectionEnd}
 
-${MementoSection} "-Desktop Qt4" SecDesktopQt4
+${MementoSection} "-Desktop Qt" SecDesktopQt
+!ifdef INST_QT
     SetOutPath $INSTDIR
-    CreateShortcut "$DESKTOP\${INTERNALNAME} Qt4.lnk" $INSTDIR\avidemux2_qt4.exe
+    CreateShortcut "$DESKTOP\${INTERNALNAME} Qt.lnk" $INSTDIR\avidemux2_qt4.exe
+!endif
 ${MementoSectionEnd}
 
 ${MementoSectionDone}
@@ -1113,14 +1274,20 @@
  
 Section Uninstall
 	!insertmacro MUI_STARTMENU_GETFOLDER Application $StartMenuGroup	
-	
+
+!ifdef INST_GTK
 	Delete /REBOOTOK "$QUICKLAUNCH\${INTERNALNAME} GTK+.lnk"
-    Delete /REBOOTOK "$QUICKLAUNCH\${INTERNALNAME} Qt4.lnk"
     Delete /REBOOTOK "$DESKTOP\${INTERNALNAME} GTK+.lnk"
-    Delete /REBOOTOK "$DESKTOP\${INTERNALNAME} Qt4.lnk"
+    Delete /REBOOTOK "$SMPROGRAMS\$StartMenuGroup\${INTERNALNAME} GTK+.lnk"
+!endif
+
+!ifdef INST_QT
+    Delete /REBOOTOK "$QUICKLAUNCH\${INTERNALNAME} Qt.lnk"
+    Delete /REBOOTOK "$DESKTOP\${INTERNALNAME} Qt.lnk"
+    Delete /REBOOTOK "$SMPROGRAMS\$StartMenuGroup\${INTERNALNAME} Qt.lnk"
+!endif
+
 	Delete /REBOOTOK "$SMPROGRAMS\$StartMenuGroup\Change Log.lnk"
-    Delete /REBOOTOK "$SMPROGRAMS\$StartMenuGroup\${INTERNALNAME} GTK+.lnk"
-    Delete /REBOOTOK "$SMPROGRAMS\$StartMenuGroup\${INTERNALNAME} Qt4.lnk"
     Delete /REBOOTOK "$SMPROGRAMS\$StartMenuGroup\AVS Proxy GUI.lnk"
     RmDir /REBOOTOK $SMPROGRAMS\$StartMenuGroup
     DeleteRegValue HKLM "${REGKEY}" StartMenuGroup
@@ -1168,6 +1335,7 @@
 	${MementoSectionSave}
 FunctionEnd
 
+!ifdef INST_BOTH
 Function .onSelChange
 	!insertmacro SectionFlagIsSet ${SecUiGtk} ${SF_SELECTED} end checkCLI
 checkCLI:
@@ -1187,31 +1355,32 @@
 	SectionSetFlags ${SecLangTurkish} SF_RO
 end:
 FunctionEnd
+!endif
 
 Function LoadPreviousSettings
     ${MementoSectionRestore}
 	!insertmacro MUI_STARTMENU_GETFOLDER Application $StartMenuGroup
 
 #checkStartMenuGtk:
-	!insertmacro SectionFlagIsSet ${SecStartMenuGtk} ${SF_SELECTED} enableStartMenu checkStartMenuQt4
-checkStartMenuQt4:
-	!insertmacro SectionFlagIsSet ${SecStartMenuQt4} ${SF_SELECTED} enableStartMenu checkDesktopGtk
+	!insertmacro SectionFlagIsSet ${SecStartMenuGtk} ${SF_SELECTED} enableStartMenu checkStartMenuQt
+checkStartMenuQt:
+	!insertmacro SectionFlagIsSet ${SecStartMenuQt} ${SF_SELECTED} enableStartMenu checkDesktopGtk
 
 enableStartMenu:
 	StrCpy $CreateStartMenuGroup 1
 
 checkDesktopGtk:
-	!insertmacro SectionFlagIsSet ${SecDesktopGtk} ${SF_SELECTED} enableDesktop checkDesktopQt4
-checkDesktopQt4:
-	!insertmacro SectionFlagIsSet ${SecDesktopQt4} ${SF_SELECTED} enableDesktop checkQuickLaunchGtk
+	!insertmacro SectionFlagIsSet ${SecDesktopGtk} ${SF_SELECTED} enableDesktop checkDesktopQt
+checkDesktopQt:
+	!insertmacro SectionFlagIsSet ${SecDesktopQt} ${SF_SELECTED} enableDesktop checkQuickLaunchGtk
 
 enableDesktop:
 	StrCpy $CreateDesktopIcon 1
 	
 checkQuickLaunchGtk:
-	!insertmacro SectionFlagIsSet ${SecQuickLaunchGtk} ${SF_SELECTED} enableQuickLaunch checkQuickLaunchQt4
-checkQuickLaunchQt4:
-	!insertmacro SectionFlagIsSet ${SecQuickLaunchQt4} ${SF_SELECTED} enableQuickLaunch end
+	!insertmacro SectionFlagIsSet ${SecQuickLaunchGtk} ${SF_SELECTED} enableQuickLaunch checkQuickLaunchQt
+checkQuickLaunchQt:
+	!insertmacro SectionFlagIsSet ${SecQuickLaunchQt} ${SF_SELECTED} enableQuickLaunch end
 
 enableQuickLaunch:
 	StrCpy $CreateQuickLaunchIcon 1	
@@ -1245,6 +1414,7 @@
 NoRemoveUninstaller:
 FunctionEnd
 
+!ifdef INST_BOTH
 Function CheckSelectedUIs
 	!insertmacro SectionFlagIsSet ${SecGrpUI} ${SF_SELECTED} end checkPartial
 checkPartial:
@@ -1254,6 +1424,7 @@
     Abort
 end:
 FunctionEnd
+!endif
 
 LangString INSTALL_OPTS_PAGE_TITLE ${LANG_ENGLISH} "Choose Install Options"
 LangString INSTALL_OPTS_PAGE_SUBTITLE ${LANG_ENGLISH} "Choose where to install Avidemux icons."
@@ -1280,30 +1451,40 @@
 	${NSD_CreateCheckBox} 0 18u 100% 12u "On my &Desktop"
 	Pop $chkDesktop
 	${NSD_SetState} $chkDesktop $CreateDesktopIcon
+	${NSD_OnClick} $chkDesktop UpdateInstallOptions
 
 	${NSD_CreateCheckBox} 0 36u 100% 12u "In my &Start Menu Programs folder"
 	Pop $chkStartMenu
 	${NSD_SetState} $chkStartMenu $CreateStartMenuGroup
+	${NSD_OnClick} $chkStartMenu UpdateInstallOptions
 
 	${NSD_CreateCheckBox} 0 54u 100% 12u "In my &Quick Launch bar"
 	Pop $chkQuickLaunch
 	${NSD_SetState} $chkQuickLaunch $CreateQuickLaunchIcon
+	${NSD_OnClick} $chkQuickLaunch UpdateInstallOptions
 
 	nsDialogs::Show
 FunctionEnd
 
-Function InstallOptionsPageLeave
+Function UpdateInstallOptions
 	${NSD_GetState} $chkDesktop $CreateDesktopIcon
 	${NSD_GetState} $chkStartMenu $CreateStartMenuGroup
 	${NSD_GetState} $chkQuickLaunch $CreateQuickLaunchIcon
 FunctionEnd
 
 Function IsInstallOptionsRequired
-	!insertmacro SectionFlagIsSet ${SecUiGtk} ${SF_SELECTED} end checkQt4
-checkQt4:
-	!insertmacro SectionFlagIsSet ${SecUiQt4} ${SF_SELECTED} end resetOptions
+!ifdef INST_GTK
+	!insertmacro SectionFlagIsSet ${SecUiGtk} ${SF_SELECTED} end checkQt
+checkQt:
+!ifndef INST_BOTH
+Goto end
+!endif
+!endif
+!ifdef INST_QT
+	!insertmacro SectionFlagIsSet ${SecUiQt} ${SF_SELECTED} end resetOptions
+resetOptions:
+!endif
 
-resetOptions:
     StrCpy $CreateDesktopIcon 0
     StrCpy $CreateStartMenuGroup 0
     StrCpy $CreateQuickLaunchIcon 0
@@ -1327,6 +1508,7 @@
     #Change Log shortcut:
     SectionSetFlags ${SecStartMenuChangeLog} $CreateStartMenuGroup
 
+!ifdef INST_GTK
     #GTK shortcuts:
     SectionGetFlags ${SecUiGtk} $0
     IntOp $0 $0 & ${SF_SELECTED}
@@ -1339,19 +1521,22 @@
 
     IntOp $1 $0 & $CreateStartMenuGroup
     SectionSetFlags ${SecStartMenuGtk} $1
+!endif
 
-    #Qt4 shortcuts:
-    SectionGetFlags ${SecUiQt4} $0
+!ifdef INST_QT
+    #Qt shortcuts:
+    SectionGetFlags ${SecUiQt} $0
     IntOp $0 $0 & ${SF_SELECTED}
 
     IntOp $1 $0 & $CreateDesktopIcon
-    SectionSetFlags ${SecDesktopQt4} $1
+    SectionSetFlags ${SecDesktopQt} $1
 
     IntOp $1 $0 & $CreateQuickLaunchIcon
-    SectionSetFlags ${SecQuickLaunchQt4} $1
+    SectionSetFlags ${SecQuickLaunchQt} $1
 
     IntOp $1 $0 & $CreateStartMenuGroup
-    SectionSetFlags ${SecStartMenuQt4} $1
+    SectionSetFlags ${SecStartMenuQt} $1
+!endif
 FunctionEnd
 
 Function InstFilesPageShow
@@ -1373,13 +1558,17 @@
 FunctionEnd
 
 Function ConfigureFinishPage
+!ifdef INST_GTK
     SectionGetFlags ${SecUiGtk} $0
     IntOp $0 $0 & ${SF_SELECTED}
     StrCmp $0 ${SF_SELECTED} end
+!endif
 
-    SectionGetFlags ${SecUiQt4} $0
+!ifdef INST_QT
+    SectionGetFlags ${SecUiQt} $0
     IntOp $0 $0 & ${SF_SELECTED}
     StrCmp $0 ${SF_SELECTED} end
+!endif
 
     DeleteINISec "$PLUGINSDIR\ioSpecial.ini" "Field 4"
 
@@ -1389,21 +1578,25 @@
 Function RunAvidemux
     SetOutPath $INSTDIR
 
-#Qt4:
-    SectionGetFlags ${SecUiQt4} $0
+!ifdef INST_QT
+#Qt:
+    SectionGetFlags ${SecUiQt} $0
     IntOp $0 $0 & ${SF_SELECTED}
 
     StrCmp $0 ${SF_SELECTED} 0 GTK
         Exec "$INSTDIR\avidemux2_qt4.exe"
 
     Goto end
+GTK:
+!endif
 
-GTK:
+!ifdef INST_GTK
     SectionGetFlags ${SecUiGtk} $0
     IntOp $0 $0 & ${SF_SELECTED}
 
     StrCmp $0 ${SF_SELECTED} 0 End
         Exec "$INSTDIR\avidemux2_gtk.exe"
+!endif
 
 end:
 FunctionEnd



From gruntster at mail.berlios.de  Sat Feb 14 00:30:03 2009
From: gruntster at mail.berlios.de (gruntster at mail.berlios.de)
Date: Sat, 14 Feb 2009 00:30:03 +0100
Subject: [Avidemux-svn-commit] r4587 - in
	branches/avidemux_2.5_branch_gruntster: avidemux
	avidemux/ADM_core/src cmake platforms/windows/build_scripts/avidemux
	platforms/windows/installer plugins/ADM_videoEncoder/ADM_vidEnc_x264
	plugins/ADM_videoEncoder/ADM_vidEnc_x264/gtk
	plugins/ADM_videoEncoder/ADM_vidEnc_x264/qt4
	plugins/ADM_videoEncoder/ADM_vidEnc_x264/xml
	plugins/ADM_videoEncoder/ADM_vidEnc_xvid
	plugins/ADM_videoEncoder/ADM_vidEnc_xvid/gtk
	plugins/ADM_videoEncoder/ADM_vidEnc_xvid/qt4
Message-ID: <200902132330.n1DNU3iK019776@sheep.berlios.de>

Author: gruntster
Date: 2009-02-14 00:29:49 +0100 (Sat, 14 Feb 2009)
New Revision: 4587

Modified:
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_core/src/ADM_fileio.cpp
   branches/avidemux_2.5_branch_gruntster/avidemux/main.cpp
   branches/avidemux_2.5_branch_gruntster/cmake/ad_plugin.cmake
   branches/avidemux_2.5_branch_gruntster/cmake/admPluginVideoEncoder.cmake
   branches/avidemux_2.5_branch_gruntster/cmake/ae_plugin.cmake
   branches/avidemux_2.5_branch_gruntster/cmake/av_plugin.cmake
   branches/avidemux_2.5_branch_gruntster/cmake/vf_plugin.cmake
   branches/avidemux_2.5_branch_gruntster/platforms/windows/build_scripts/avidemux/1b. Continue Build.bat
   branches/avidemux_2.5_branch_gruntster/platforms/windows/installer/avidemux.nsi
   branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_x264/CMakeLists.txt
   branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_x264/gtk/CMakeLists.txt
   branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_x264/qt4/CMakeLists.txt
   branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_x264/xml/CMakeLists.txt
   branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_xvid/CMakeLists.txt
   branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_xvid/gtk/CMakeLists.txt
   branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/CMakeLists.txt
Log:
[Win32] make plugins folder less obtuse

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_core/src/ADM_fileio.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_core/src/ADM_fileio.cpp	2009-02-13 23:10:28 UTC (rev 4586)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_core/src/ADM_fileio.cpp	2009-02-13 23:29:49 UTC (rev 4587)
@@ -269,10 +269,11 @@
 	result = (char *)new char [length];
 	strcpy(result, base0);
 	strcat(result, separator);
-
 	strcat(result, base1);
-	strcat(result, separator);
 
+	if (strlen(base1))
+		strcat(result, separator);
+
 	if (base2)
 	{
 		strcat(result, base2);
@@ -337,7 +338,20 @@
 
 char *ADM_getPluginPath(void)
 {
-	return ADM_getInstallRelativePath("lib", "ADM_plugins", "videoEncoder");
+#ifdef _WIN32
+	const char *startDir="";
+	const char *pluginDir="plugins";
+#else
+	const char *pluginDir="ADM_plugins";
+
+#ifdef __APPLE__
+    const char *startDir="../Resources/lib";
+#else
+    const char *startDir="lib";
+#endif
+#endif
+
+	return ADM_getInstallRelativePath(startDir, pluginDir, "videoEncoder");
 }
 /*
       Get the root directory for .avidemux stuff

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/main.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/main.cpp	2009-02-13 23:10:28 UTC (rev 4586)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/main.cpp	2009-02-13 23:29:49 UTC (rev 4587)
@@ -223,16 +223,23 @@
 
 	//***************Plugins *********************
 	// Load system wide audio decoder plugin
+#ifdef _WIN32
+	const char *startDir="";
+	const char *pluginDir="plugins";
+#else
+	const char *pluginDir="ADM_plugins";
+
 #ifdef __APPLE__
     const char *startDir="../Resources/lib";
 #else
     const char *startDir="lib";
 #endif
-	char *adPlugins = ADM_getInstallRelativePath(startDir,"ADM_plugins","audioDecoder");
-	char *vfPlugins = ADM_getInstallRelativePath(startDir,"ADM_plugins","videoFilter");
-    char *avPlugins = ADM_getInstallRelativePath(startDir,"ADM_plugins","audioDevices");    
-    char *aePlugins = ADM_getInstallRelativePath(startDir,"ADM_plugins","audioEncoders");    
+#endif
 
+	char *adPlugins = ADM_getInstallRelativePath(startDir,pluginDir,"audioDecoder");
+	char *vfPlugins = ADM_getInstallRelativePath(startDir,pluginDir,"videoFilter");
+    char *avPlugins = ADM_getInstallRelativePath(startDir,pluginDir,"audioDevices");
+    char *aePlugins = ADM_getInstallRelativePath(startDir,pluginDir,"audioEncoders");
 
 	ADM_ad_loadPlugins(adPlugins);
 	delete [] adPlugins;

Modified: branches/avidemux_2.5_branch_gruntster/cmake/ad_plugin.cmake
===================================================================
--- branches/avidemux_2.5_branch_gruntster/cmake/ad_plugin.cmake	2009-02-13 23:10:28 UTC (rev 4586)
+++ branches/avidemux_2.5_branch_gruntster/cmake/ad_plugin.cmake	2009-02-13 23:29:49 UTC (rev 4587)
@@ -1,3 +1,9 @@
+IF (WIN32)
+	SET(AUDDEC_INSTALL_DIR "${CMAKE_INSTALL_PREFIX}/plugins/audioDecoder/")
+ELSE (WIN32)
+	SET(AUDDEC_INSTALL_DIR "${CMAKE_INSTALL_PREFIX}/lib/ADM_plugins/audioDecoder/")
+ENDIF (WIN32)
+
 MACRO(INIT_AUDIO_PLUGIN _lib)
 	INCLUDE_DIRECTORIES("${CMAKE_BINARY_DIR}/config")
 	INCLUDE_DIRECTORIES("${CMAKE_SOURCE_DIR}/../avidemux/ADM_core/include")
@@ -6,5 +12,5 @@
 ENDMACRO(INIT_AUDIO_PLUGIN)
 
 MACRO(INSTALL_AUDIODECODER _lib)
-	INSTALL(TARGETS ${_lib} DESTINATION "${CMAKE_INSTALL_PREFIX}/lib/ADM_plugins/audioDecoder/")
+	INSTALL(TARGETS ${_lib} DESTINATION "${AUDDEC_INSTALL_DIR}")
 ENDMACRO(INSTALL_AUDIODECODER)

Modified: branches/avidemux_2.5_branch_gruntster/cmake/admPluginVideoEncoder.cmake
===================================================================
--- branches/avidemux_2.5_branch_gruntster/cmake/admPluginVideoEncoder.cmake	2009-02-13 23:10:28 UTC (rev 4586)
+++ branches/avidemux_2.5_branch_gruntster/cmake/admPluginVideoEncoder.cmake	2009-02-13 23:29:49 UTC (rev 4587)
@@ -1,3 +1,9 @@
+IF (WIN32)
+	SET(VIDENC_INSTALL_DIR "${CMAKE_INSTALL_PREFIX}/plugins/videoEncoder/")
+ELSE (WIN32)
+	SET(VIDENC_INSTALL_DIR "${CMAKE_INSTALL_PREFIX}/lib/ADM_plugins/videoEncoder/")
+ENDIF (WIN32)
+
 MACRO(INIT_VIDEO_ENCODER_PLUGIN _lib)
 	INCLUDE_DIRECTORIES("${CMAKE_BINARY_DIR}/config")
 	INCLUDE_DIRECTORIES("${CMAKE_SOURCE_DIR}/../avidemux/ADM_core/include")
@@ -6,5 +12,5 @@
 ENDMACRO(INIT_VIDEO_ENCODER_PLUGIN)
 
 MACRO(INSTALL_VIDEO_ENCODER _lib)
-	INSTALL(TARGETS ${_lib} DESTINATION "${CMAKE_INSTALL_PREFIX}/lib/ADM_plugins/videoEncoder/")
+	INSTALL(TARGETS ${_lib} DESTINATION "${VIDENC_INSTALL_DIR}")
 ENDMACRO(INSTALL_VIDEO_ENCODER)

Modified: branches/avidemux_2.5_branch_gruntster/cmake/ae_plugin.cmake
===================================================================
--- branches/avidemux_2.5_branch_gruntster/cmake/ae_plugin.cmake	2009-02-13 23:10:28 UTC (rev 4586)
+++ branches/avidemux_2.5_branch_gruntster/cmake/ae_plugin.cmake	2009-02-13 23:29:49 UTC (rev 4587)
@@ -1,3 +1,9 @@
+IF (WIN32)
+	SET(AUDENC_INSTALL_DIR "${CMAKE_INSTALL_PREFIX}/plugins/audioEncoders/")
+ELSE (WIN32)
+	SET(AUDENC_INSTALL_DIR "${CMAKE_INSTALL_PREFIX}/lib/ADM_plugins/audioEncoders/")
+ENDIF (WIN32)
+
 MACRO(INIT_AUDIO_ENCODER _lib)
 	INCLUDE_DIRECTORIES("${CMAKE_SOURCE_DIR}/../avidemux/ADM_core/include")
 	INCLUDE_DIRECTORIES("${CMAKE_SOURCE_DIR}/../avidemux/ADM_coreAudio/include")
@@ -7,5 +13,5 @@
 ENDMACRO(INIT_AUDIO_ENCODER)
 
 MACRO(INSTALL_AUDIOENCODER _lib)
-	INSTALL(TARGETS ${_lib} DESTINATION "${CMAKE_INSTALL_PREFIX}/lib/ADM_plugins/audioEncoders/")
+	INSTALL(TARGETS ${_lib} DESTINATION "${AUDENC_INSTALL_DIR}")
 ENDMACRO(INSTALL_AUDIOENCODER)

Modified: branches/avidemux_2.5_branch_gruntster/cmake/av_plugin.cmake
===================================================================
--- branches/avidemux_2.5_branch_gruntster/cmake/av_plugin.cmake	2009-02-13 23:10:28 UTC (rev 4586)
+++ branches/avidemux_2.5_branch_gruntster/cmake/av_plugin.cmake	2009-02-13 23:29:49 UTC (rev 4587)
@@ -1,3 +1,9 @@
+IF (WIN32)
+	SET(AUDDEV_INSTALL_DIR "${CMAKE_INSTALL_PREFIX}/plugins/audioDevices/")
+ELSE (WIN32)
+	SET(AUDDEV_INSTALL_DIR "${CMAKE_INSTALL_PREFIX}/lib/ADM_plugins/audioDevices/")
+ENDIF (WIN32)
+
 MACRO(INIT_AUDIO_DEVICE _lib)
 	INCLUDE_DIRECTORIES("${CMAKE_SOURCE_DIR}/../avidemux/ADM_core/include")
 	INCLUDE_DIRECTORIES("${CMAKE_SOURCE_DIR}/../avidemux/ADM_coreAudio/include")
@@ -5,5 +11,5 @@
 ENDMACRO(INIT_AUDIO_DEVICE)
 
 MACRO(INSTALL_AUDIODEVICE _lib)
-	INSTALL(TARGETS ${_lib} DESTINATION "${CMAKE_INSTALL_PREFIX}/lib/ADM_plugins/audioDevices/")
+	INSTALL(TARGETS ${_lib} DESTINATION "${AUDDEV_INSTALL_DIR}")
 ENDMACRO(INSTALL_AUDIODEVICE)

Modified: branches/avidemux_2.5_branch_gruntster/cmake/vf_plugin.cmake
===================================================================
--- branches/avidemux_2.5_branch_gruntster/cmake/vf_plugin.cmake	2009-02-13 23:10:28 UTC (rev 4586)
+++ branches/avidemux_2.5_branch_gruntster/cmake/vf_plugin.cmake	2009-02-13 23:29:49 UTC (rev 4587)
@@ -1,3 +1,9 @@
+IF (WIN32)
+	SET(VIDFLT_INSTALL_DIR "${CMAKE_INSTALL_PREFIX}/plugins/videoFilter/")
+ELSE (WIN32)
+	SET(VIDFLT_INSTALL_DIR "${CMAKE_INSTALL_PREFIX}/lib/ADM_plugins/videoFilter/")
+ENDIF (WIN32)
+
 MACRO(INIT_VIDEOFILTER_PLUGIN _lib)
     INCLUDE_DIRECTORIES(.)
 	INCLUDE_DIRECTORIES("${AVIDEMUX_CORECONFIG_DIR}")
@@ -8,5 +14,5 @@
 
 MACRO(INSTALL_VIDEOFILTER _lib)
 	TARGET_LINK_LIBRARIES(${_lib} ADM_core ADM_coreUI ADM_coreImage )
-	INSTALL(TARGETS ${_lib} DESTINATION "${CMAKE_INSTALL_PREFIX}/lib/ADM_plugins/videoFilter/")
+	INSTALL(TARGETS ${_lib} DESTINATION "${VIDFLT_INSTALL_DIR}")
 ENDMACRO(INSTALL_VIDEOFILTER)

Modified: branches/avidemux_2.5_branch_gruntster/platforms/windows/build_scripts/avidemux/1b. Continue Build.bat
===================================================================
--- branches/avidemux_2.5_branch_gruntster/platforms/windows/build_scripts/avidemux/1b. Continue Build.bat	2009-02-13 23:10:28 UTC (rev 4586)
+++ branches/avidemux_2.5_branch_gruntster/platforms/windows/build_scripts/avidemux/1b. Continue Build.bat	2009-02-13 23:29:49 UTC (rev 4587)
@@ -10,7 +10,6 @@
 pause
 
 set msysSourceDir=%sourceDir:\=/%
-echo %msysSourceDir%
 cd "%sourceDir%\plugins\build"
 cmake -G"MSYS Makefiles" -DCMAKE_INSTALL_PREFIX="%buildDir%" -DAVIDEMUX_CORECONFIG_DIR="%msysSourceDir%/build/config" -DAVIDEMUX_INSTALL_PREFIX="%buildDir%" -DAVIDEMUX_SOURCE_DIR="%msysSourceDir%" ..
 
@@ -24,8 +23,8 @@
 make install
 
 del /s "%buildDir%\*.a"
-del "%buildDir%\lib\ADM_plugins\audioDecoder\libADM_ad_dca.dll"
-del "%buildDir%\lib\ADM_plugins\audioDecoder\libADM_ad_amrnb.dll"
+del "%buildDir%\plugins\audioDecoder\libADM_ad_dca.dll"
+del "%buildDir%\plugins\audioDecoder\libADM_ad_amrnb.dll"
 
 echo Finished!
 goto end

Modified: branches/avidemux_2.5_branch_gruntster/platforms/windows/installer/avidemux.nsi
===================================================================
--- branches/avidemux_2.5_branch_gruntster/platforms/windows/installer/avidemux.nsi	2009-02-13 23:10:28 UTC (rev 4586)
+++ branches/avidemux_2.5_branch_gruntster/platforms/windows/installer/avidemux.nsi	2009-02-13 23:29:49 UTC (rev 4587)
@@ -111,8 +111,8 @@
 !define MUI_FINISHPAGE_RUN_TEXT "Run ${INTERNALNAME} now"
 !define MUI_FINISHPAGE_SHOWREADME "$INSTDIR\Change Log.html"
 !define MUI_FINISHPAGE_SHOWREADME_TEXT "View Change Log now"
-!define MUI_FINISHPAGE_LINK "Visit the Avidemux Windows Builds website"
-!define MUI_FINISHPAGE_LINK_LOCATION "http://www.razorbyte.com.au/avidemux/"
+!define MUI_FINISHPAGE_LINK "Visit the Avidemux Builds for Windows website"
+!define MUI_FINISHPAGE_LINK_LOCATION "http://avidemux.razorbyte.com.au/"
 !define MUI_PAGE_CUSTOMFUNCTION_PRE ConfigureFinishPage
 !insertmacro MUI_PAGE_FINISH
 
@@ -366,72 +366,72 @@
 		${MementoSection} "FAAD2 (AAC)" SecAudDecFaad
 			SectionIn 1 2
 			SetOverwrite on
-			SetOutPath $INSTDIR\lib\ADM_plugins\audioDecoder
-			${File} lib\ADM_plugins\audioDecoder\libADM_ad_faad.dll
+			SetOutPath $INSTDIR\plugins\audioDecoder
+			${File} plugins\audioDecoder\libADM_ad_faad.dll
 			SetOutPath $INSTDIR
 			${File} libfaad2.dll
 		${MementoSectionEnd}
 		${MementoSection} "liba52 (AC-3)" SecAudDecA52
 			SectionIn 1 2
 			SetOverwrite on
-			SetOutPath $INSTDIR\lib\ADM_plugins\audioDecoder
-			${File} lib\ADM_plugins\audioDecoder\libADM_ad_a52.dll
+			SetOutPath $INSTDIR\plugins\audioDecoder
+			${File} plugins\audioDecoder\libADM_ad_a52.dll
 		${MementoSectionEnd}
 		${MementoSection} "MAD (MPEG)" SecAudDecMad
 			SectionIn 1 2
 			SetOverwrite on
-			SetOutPath $INSTDIR\lib\ADM_plugins\audioDecoder
-			${File} lib\ADM_plugins\audioDecoder\libADM_ad_Mad.dll
+			SetOutPath $INSTDIR\plugins\audioDecoder
+			${File} plugins\audioDecoder\libADM_ad_Mad.dll
 		${MementoSectionEnd}
 	SectionGroupEnd
 	SectionGroup "Audio Devices" SecGrpAudioDevice
 		${MementoUnselectedSection} SDL SecAudDevSdl
 			SectionIn 2
 			SetOverwrite on
-			SetOutPath $INSTDIR\lib\ADM_plugins\audioDevices
-			${File} lib\ADM_plugins\audioDevices\libADM_av_sdl.dll
+			SetOutPath $INSTDIR\plugins\audioDevices
+			${File} plugins\audioDevices\libADM_av_sdl.dll
 		${MementoSectionEnd}
 		${MementoSection} "MS Windows (Waveform)" SecAudDevWaveform
 			SectionIn 1 2
 			SetOverwrite on
-			SetOutPath $INSTDIR\lib\ADM_plugins\audioDevices
-			${File} lib\ADM_plugins\audioDevices\libADM_av_win32.dll
+			SetOutPath $INSTDIR\plugins\audioDevices
+			${File} plugins\audioDevices\libADM_av_win32.dll
 		${MementoSectionEnd}
 	SectionGroupEnd
 	SectionGroup "Audio Encoders" SecGrpAudioEncoder
 		${MementoSection} "FAAC (AAC)" SecAudEncFaac
 			SectionIn 1 2
 			SetOverwrite on
-			SetOutPath $INSTDIR\lib\ADM_plugins\audioEncoders
-			${File} lib\ADM_plugins\audioEncoders\libADM_ae_faac.dll
+			SetOutPath $INSTDIR\plugins\audioEncoders
+			${File} plugins\audioEncoders\libADM_ae_faac.dll
 			SetOutPath $INSTDIR
 			${File} libfaac.dll
 		${MementoSectionEnd}
 		${MementoSection} "LAME (MP3)" SecAudEncLame
 			SectionIn 1 2
 			SetOverwrite on
-			SetOutPath $INSTDIR\lib\ADM_plugins\audioEncoders
-			${File} lib\ADM_plugins\audioEncoders\libADM_ae_lame.dll
+			SetOutPath $INSTDIR\plugins\audioEncoders
+			${File} plugins\audioEncoders\libADM_ae_lame.dll
 			SetOutPath $INSTDIR
 			${File} libmp3lame-0.dll
 		${MementoSectionEnd}
 		${MementoSection} "libavcodec (AC-3)" SecAudEncLavAc3
 			SectionIn 1 2
 			SetOverwrite on
-			SetOutPath $INSTDIR\lib\ADM_plugins\audioEncoders
-			${File} lib\ADM_plugins\audioEncoders\libADM_ae_lav_ac3.dll
+			SetOutPath $INSTDIR\plugins\audioEncoders
+			${File} plugins\audioEncoders\libADM_ae_lav_ac3.dll
 		${MementoSectionEnd}
 		${MementoSection} "libavcodec (MP2)" SecAudEncLavMp2
 			SectionIn 1 2
 			SetOverwrite on
-			SetOutPath $INSTDIR\lib\ADM_plugins\audioEncoders
-			${File} lib\ADM_plugins\audioEncoders\libADM_ae_lav_mp2.dll
+			SetOutPath $INSTDIR\plugins\audioEncoders
+			${File} plugins\audioEncoders\libADM_ae_lav_mp2.dll
 		${MementoSectionEnd}
 		${MementoSection} "libvorbis (Vorbis)" SecAudEncVorbis
 			SectionIn 1 2
 			SetOverwrite on
-			SetOutPath $INSTDIR\lib\ADM_plugins\audioEncoders
-			${File} lib\ADM_plugins\audioEncoders\libADM_ae_vorbis.dll
+			SetOutPath $INSTDIR\plugins\audioEncoders
+			${File} plugins\audioEncoders\libADM_ae_vorbis.dll
 			SetOutPath $INSTDIR
 			${File} vorbis.dll
 			${File} vorbisenc.dll
@@ -439,60 +439,60 @@
 		${MementoSection} "PCM" SecAudEncPcm
 			SectionIn 1 2
 			SetOverwrite on
-			SetOutPath $INSTDIR\lib\ADM_plugins\audioEncoders
-			${File} lib\ADM_plugins\audioEncoders\libADM_ae_pcm.dll
+			SetOutPath $INSTDIR\plugins\audioEncoders
+			${File} plugins\audioEncoders\libADM_ae_pcm.dll
 		${MementoSectionEnd}
 		${MementoSection} "TwoLAME (MP2)" SecAudEncTwoLame
 			SectionIn 1 2
 			SetOverwrite on
-			SetOutPath $INSTDIR\lib\ADM_plugins\audioEncoders
-			${File} lib\ADM_plugins\audioEncoders\libADM_ae_twolame.dll
+			SetOutPath $INSTDIR\plugins\audioEncoders
+			${File} plugins\audioEncoders\libADM_ae_twolame.dll
 		${MementoSectionEnd}
 	SectionGroupEnd
 	SectionGroup "Video Encoders" SecGrpVideoEncoder
 		${MementoSection} "x264 (MPEG-4 AVC)" SecVidEncX264
 			SectionIn 1 2
 			SetOverwrite on
-			SetOutPath $INSTDIR\lib\ADM_plugins\videoEncoder
-			${File} lib\ADM_plugins\videoEncoder\libADM_vidEnc_x264.dll
-			SetOutPath $INSTDIR\lib\ADM_plugins\videoEncoder\x264
+			SetOutPath $INSTDIR\plugins\videoEncoder
+			${File} plugins\videoEncoder\libADM_vidEnc_x264.dll
+			SetOutPath $INSTDIR\plugins\videoEncoder\x264
 !ifdef INST_GTK
 			!insertmacro SectionFlagIsSet ${SecUiGtk} ${SF_SELECTED} InstallGtk CheckQt
 InstallGtk:
-			${File} lib\ADM_plugins\videoEncoder\x264\libADM_vidEnc_x264_Gtk.dll
+			${File} plugins\videoEncoder\x264\libADM_vidEnc_x264_Gtk.dll
 CheckQt:
 !endif
 !ifdef INST_QT
 			!insertmacro SectionFlagIsSet ${SecUiQt} ${SF_SELECTED} InstallQt End
 InstallQt:
-			${File} lib\ADM_plugins\videoEncoder\x264\libADM_vidEnc_x264_Qt.dll
+			${File} plugins\videoEncoder\x264\libADM_vidEnc_x264_Qt.dll
 End:
 !endif
-			${File} lib\ADM_plugins\videoEncoder\x264\x264Param.xsd
-			${File} lib\ADM_plugins\videoEncoder\x264\*.xml
+			${File} plugins\videoEncoder\x264\x264Param.xsd
+			${File} plugins\videoEncoder\x264\*.xml
 			SetOutPath $INSTDIR
 			${File} libx264-*.dll
 		${MementoSectionEnd}
 		${MementoSection} "Xvid (MPEG-4 ASP)" SecVidEncXvid
 			SectionIn 1 2
 			SetOverwrite on
-			SetOutPath $INSTDIR\lib\ADM_plugins\videoEncoder
-			${File} lib\ADM_plugins\videoEncoder\libADM_vidEnc_xvid.dll
-			SetOutPath $INSTDIR\lib\ADM_plugins\videoEncoder\xvid
+			SetOutPath $INSTDIR\plugins\videoEncoder
+			${File} plugins\videoEncoder\libADM_vidEnc_xvid.dll
+			SetOutPath $INSTDIR\plugins\videoEncoder\xvid
 !ifdef INST_GTK
 			!insertmacro SectionFlagIsSet ${SecUiGtk} ${SF_SELECTED} InstallGtk CheckQt
 InstallGtk:
-			${File} lib\ADM_plugins\videoEncoder\xvid\libADM_vidEnc_Xvid_Gtk.dll
+			${File} plugins\videoEncoder\xvid\libADM_vidEnc_Xvid_Gtk.dll
 CheckQt:
 !endif
 !ifdef INST_QT
 			!insertmacro SectionFlagIsSet ${SecUiQt} ${SF_SELECTED} InstallQt End
 InstallQt:
-			${File} lib\ADM_plugins\videoEncoder\xvid\libADM_vidEnc_Xvid_Qt.dll
+			${File} plugins\videoEncoder\xvid\libADM_vidEnc_Xvid_Qt.dll
 End:
 !endif
-			${File} lib\ADM_plugins\videoEncoder\xvid\XvidParam.xsd
-			#${File} lib\ADM_plugins\videoEncoder\xvid\*.xml
+			${File} plugins\videoEncoder\xvid\XvidParam.xsd
+			#${File} plugins\videoEncoder\xvid\*.xml
 			SetOutPath $INSTDIR
 			${File} xvidcore.dll
 		${MementoSectionEnd}
@@ -502,526 +502,526 @@
 			${MementoSection} "Add Black Borders" SecVidFltBlackBorders
 				SectionIn 1 2
 				SetOverwrite on
-				SetOutPath $INSTDIR\lib\ADM_plugins\videoFilter
-				${File} lib\ADM_plugins\videoFilter\libADM_vf_addborders.dll
+				SetOutPath $INSTDIR\plugins\videoFilter
+				${File} plugins\videoFilter\libADM_vf_addborders.dll
 			${MementoSectionEnd}
 			${MementoSection} "Avisynth Resize" SecVidFltAvisynthResize
 				SectionIn 1 2
 				SetOverwrite on
-				SetOutPath $INSTDIR\lib\ADM_plugins\videoFilter
+				SetOutPath $INSTDIR\plugins\videoFilter
 !ifdef INST_GTK
 				!insertmacro SectionFlagIsSet ${SecUiGtk} ${SF_SELECTED} InstallGtk CheckQt
 InstallGtk:
-				${File} lib\ADM_plugins\videoFilter\libADM_vf_avisynthResize_gtk.dll
+				${File} plugins\videoFilter\libADM_vf_avisynthResize_gtk.dll
 CheckQt:
 !endif
 !ifdef INST_QT
 				!insertmacro SectionFlagIsSet ${SecUiQt} ${SF_SELECTED} InstallQt End
 InstallQt:
-				${File} lib\ADM_plugins\videoFilter\libADM_vf_avisynthResize_qt4.dll
+				${File} plugins\videoFilter\libADM_vf_avisynthResize_qt4.dll
 End:
 !endif
 			${MementoSectionEnd}
 			${MementoSection} "Blacken Borders" SecVidFltBlackenBorders
 				SectionIn 1 2
 				SetOverwrite on
-				SetOutPath $INSTDIR\lib\ADM_plugins\videoFilter
-				${File} lib\ADM_plugins\videoFilter\libADM_vf_blackenBorders.dll
+				SetOutPath $INSTDIR\plugins\videoFilter
+				${File} plugins\videoFilter\libADM_vf_blackenBorders.dll
 			${MementoSectionEnd}
 			${MementoSection} "Crop" SecVidFltCrop
 				SectionIn 1 2
 				SetOverwrite on
-				SetOutPath $INSTDIR\lib\ADM_plugins\videoFilter
+				SetOutPath $INSTDIR\plugins\videoFilter
 !ifdef INST_GTK
 				!insertmacro SectionFlagIsSet ${SecUiGtk} ${SF_SELECTED} InstallGtk CheckQt
 InstallGtk:
-				${File} lib\ADM_plugins\videoFilter\libADM_vf_Crop_gtk.dll
+				${File} plugins\videoFilter\libADM_vf_Crop_gtk.dll
 CheckQt:
 !endif
 !ifdef INST_QT
 				!insertmacro SectionFlagIsSet ${SecUiQt} ${SF_SELECTED} InstallQt End
 InstallQt:
-				${File} lib\ADM_plugins\videoFilter\libADM_vf_crop_qt4.dll
+				${File} plugins\videoFilter\libADM_vf_crop_qt4.dll
 End:
 !endif
 			${MementoSectionEnd}
 			${MementoSection} "Fade" SecVidFltFade
 				SectionIn 1 2
 				SetOverwrite on
-				SetOutPath $INSTDIR\lib\ADM_plugins\videoFilter
-				${File} lib\ADM_plugins\videoFilter\libADM_vf_fade.dll
+				SetOutPath $INSTDIR\plugins\videoFilter
+				${File} plugins\videoFilter\libADM_vf_fade.dll
 			${MementoSectionEnd}
 			${MementoSection} "MPlayer Resize" SecVidFltMplayerResize
 				SectionIn 1 2
 				SetOverwrite on
-				SetOutPath $INSTDIR\lib\ADM_plugins\videoFilter
+				SetOutPath $INSTDIR\plugins\videoFilter
 !ifdef INST_GTK
 				!insertmacro SectionFlagIsSet ${SecUiGtk} ${SF_SELECTED} InstallGtk CheckQt
 InstallGtk:
-				${File} lib\ADM_plugins\videoFilter\libADM_vf_mplayerResize_gtk.dll
+				${File} plugins\videoFilter\libADM_vf_mplayerResize_gtk.dll
 CheckQt:
 !endif
 !ifdef INST_QT
 				!insertmacro SectionFlagIsSet ${SecUiQt} ${SF_SELECTED} InstallQt End
 InstallQt:
-				${File} lib\ADM_plugins\videoFilter\libADM_vf_mplayerResize_qt4.dll
+				${File} plugins\videoFilter\libADM_vf_mplayerResize_qt4.dll
 End:
 !endif
 			${MementoSectionEnd}
 			${MementoSection} "Resample FPS" SecVidFltResampleFps
 				SectionIn 1 2
 				SetOverwrite on
-				SetOutPath $INSTDIR\lib\ADM_plugins\videoFilter
-				${File} lib\ADM_plugins\videoFilter\libADM_vf_resampleFps.dll
+				SetOutPath $INSTDIR\plugins\videoFilter
+				${File} plugins\videoFilter\libADM_vf_resampleFps.dll
 			${MementoSectionEnd}
 			${MementoSection} "Reverse" SecVidFltReverse
 				SectionIn 1 2
 				SetOverwrite on
-				SetOutPath $INSTDIR\lib\ADM_plugins\videoFilter
-				${File} lib\ADM_plugins\videoFilter\libADM_vf_reverse.dll
+				SetOutPath $INSTDIR\plugins\videoFilter
+				${File} plugins\videoFilter\libADM_vf_reverse.dll
 			${MementoSectionEnd}
 			${MementoSection} "Rotate" SecVidFltRotate
 				SectionIn 1 2
 				SetOverwrite on
-				SetOutPath $INSTDIR\lib\ADM_plugins\videoFilter
-				${File} lib\ADM_plugins\videoFilter\libADM_vf_rotate.dll
+				SetOutPath $INSTDIR\plugins\videoFilter
+				${File} plugins\videoFilter\libADM_vf_rotate.dll
 			${MementoSectionEnd}
 			${MementoSection} "Vertical Flip" SecVidFltVerticalFlip
 				SectionIn 1 2
 				SetOverwrite on
-				SetOutPath $INSTDIR\lib\ADM_plugins\videoFilter
-				${File} lib\ADM_plugins\videoFilter\libADM_vf_vflip.dll
+				SetOutPath $INSTDIR\plugins\videoFilter
+				${File} plugins\videoFilter\libADM_vf_vflip.dll
 			${MementoSectionEnd}
 		SectionGroupEnd
 		SectionGroup "Interlacing Filters" SecGrpVideoFilterInterlacing
 			${MementoSection} "Decomb Decimate" SecVidFltDecombDecimate
 				SectionIn 1 2
 				SetOverwrite on
-				SetOutPath $INSTDIR\lib\ADM_plugins\videoFilter
-				${File} lib\ADM_plugins\videoFilter\libADM_vf_decimate.dll
+				SetOutPath $INSTDIR\plugins\videoFilter
+				${File} plugins\videoFilter\libADM_vf_decimate.dll
 			${MementoSectionEnd}
 			${MementoSection} "Decomb Telecide" SecVidFltDecombTelecide
 				SectionIn 1 2
 				SetOverwrite on
-				SetOutPath $INSTDIR\lib\ADM_plugins\videoFilter
-				${File} lib\ADM_plugins\videoFilter\libADM_vf_telecide.dll
+				SetOutPath $INSTDIR\plugins\videoFilter
+				${File} plugins\videoFilter\libADM_vf_telecide.dll
 			${MementoSectionEnd}
 			${MementoSection} "Deinterlace" SecVidFltDeinterlace
 				SectionIn 1 2
 				SetOverwrite on
-				SetOutPath $INSTDIR\lib\ADM_plugins\videoFilter
-				${File} lib\ADM_plugins\videoFilter\libADM_vf_Deinterlace.dll
+				SetOutPath $INSTDIR\plugins\videoFilter
+				${File} plugins\videoFilter\libADM_vf_Deinterlace.dll
 			${MementoSectionEnd}
 			${MementoSection} "DG Bob" SecVidFltDbGob
 				SectionIn 1 2
 				SetOverwrite on
-				SetOutPath $INSTDIR\lib\ADM_plugins\videoFilter
-				${File} lib\ADM_plugins\videoFilter\libADM_vf_blendDgBob.dll
+				SetOutPath $INSTDIR\plugins\videoFilter
+				${File} plugins\videoFilter\libADM_vf_blendDgBob.dll
 			${MementoSectionEnd}
 			${MementoSection} "Drop" SecVidFltDrop
 				SectionIn 1 2
 				SetOverwrite on
-				SetOutPath $INSTDIR\lib\ADM_plugins\videoFilter
-				${File} lib\ADM_plugins\videoFilter\libADM_vf_dropOut.dll
+				SetOutPath $INSTDIR\plugins\videoFilter
+				${File} plugins\videoFilter\libADM_vf_dropOut.dll
 			${MementoSectionEnd}
 			${MementoSection} "Fade" SecVidFltFadeInterlace
 				SectionIn 1 2
 				SetOverwrite on
-				SetOutPath $INSTDIR\lib\ADM_plugins\videoFilter
-				${File} lib\ADM_plugins\videoFilter\libADM_vf_separateField.dll
+				SetOutPath $INSTDIR\plugins\videoFilter
+				${File} plugins\videoFilter\libADM_vf_separateField.dll
 			${MementoSectionEnd}
 			${MementoSection} "Gauss Smooth" SecVidFltGaussSmooth
 				SectionIn 1 2
 				SetOverwrite on
-				SetOutPath $INSTDIR\lib\ADM_plugins\videoFilter
-				${File} lib\ADM_plugins\videoFilter\libADM_vf_fastconvolutiongauss.dll
+				SetOutPath $INSTDIR\plugins\videoFilter
+				${File} plugins\videoFilter\libADM_vf_fastconvolutiongauss.dll
 			${MementoSectionEnd}
 			${MementoSection} "Keep Even Fields" SecVidFltKeepEvenFields
 				SectionIn 1 2
 				SetOverwrite on
-				SetOutPath $INSTDIR\lib\ADM_plugins\videoFilter
-				${File} lib\ADM_plugins\videoFilter\libADM_vf_keepEvenField.dll
+				SetOutPath $INSTDIR\plugins\videoFilter
+				${File} plugins\videoFilter\libADM_vf_keepEvenField.dll
 			${MementoSectionEnd}
 			${MementoSection} "Keep Odd Fields" SecVidFltKeepOddFields
 				SectionIn 1 2
 				SetOverwrite on
-				SetOutPath $INSTDIR\lib\ADM_plugins\videoFilter
-				${File} lib\ADM_plugins\videoFilter\libADM_vf_keepOddField.dll
+				SetOutPath $INSTDIR\plugins\videoFilter
+				${File} plugins\videoFilter\libADM_vf_keepOddField.dll
 			${MementoSectionEnd}
 			${MementoSection} "KernelDeint" SecVidFltKernelDeint
 				SectionIn 1 2
 				SetOverwrite on
-				SetOutPath $INSTDIR\lib\ADM_plugins\videoFilter
-				${File} lib\ADM_plugins\videoFilter\libADM_vf_kernelDeint.dll
+				SetOutPath $INSTDIR\plugins\videoFilter
+				${File} plugins\videoFilter\libADM_vf_kernelDeint.dll
 			${MementoSectionEnd}
 			${MementoSection} "libavcodec Deinterlacer" SecVidFltLavDeinterlacer
 				SectionIn 1 2
 				SetOverwrite on
-				SetOutPath $INSTDIR\lib\ADM_plugins\videoFilter
-				${File} lib\ADM_plugins\videoFilter\libADM_vf_lavDeinterlace.dll
+				SetOutPath $INSTDIR\plugins\videoFilter
+				${File} plugins\videoFilter\libADM_vf_lavDeinterlace.dll
 			${MementoSectionEnd}
 			${MementoSection} "mcDeint" SecVidFltMcDeint
 				SectionIn 1 2
 				SetOverwrite on
-				SetOutPath $INSTDIR\lib\ADM_plugins\videoFilter
-				${File} lib\ADM_plugins\videoFilter\libADM_vf_mcdeint.dll
+				SetOutPath $INSTDIR\plugins\videoFilter
+				${File} plugins\videoFilter\libADM_vf_mcdeint.dll
 			${MementoSectionEnd}
 			${MementoSection} "Mean" SecVidFltMean
 				SectionIn 1 2
 				SetOverwrite on
-				SetOutPath $INSTDIR\lib\ADM_plugins\videoFilter
-				${File} lib\ADM_plugins\videoFilter\libADM_vf_fastconvolutionmean.dll
+				SetOutPath $INSTDIR\plugins\videoFilter
+				${File} plugins\videoFilter\libADM_vf_fastconvolutionmean.dll
 			${MementoSectionEnd}
 			${MementoSection} "Median" SecVidFltMedian
 				SectionIn 1 2
 				SetOverwrite on
-				SetOutPath $INSTDIR\lib\ADM_plugins\videoFilter
-				${File} lib\ADM_plugins\videoFilter\libADM_vf_fastconvolutionmedian.dll
+				SetOutPath $INSTDIR\plugins\videoFilter
+				${File} plugins\videoFilter\libADM_vf_fastconvolutionmedian.dll
 			${MementoSectionEnd}
 			${MementoSection} "Merge Fields" SecVidFltMergeFields
 				SectionIn 1 2
 				SetOverwrite on
-				SetOutPath $INSTDIR\lib\ADM_plugins\videoFilter
-				${File} lib\ADM_plugins\videoFilter\libADM_vf_mergeField.dll
+				SetOutPath $INSTDIR\plugins\videoFilter
+				${File} plugins\videoFilter\libADM_vf_mergeField.dll
 			${MementoSectionEnd}
 			${MementoSection} "PAL Field Shift" SecVidFltPalFieldShift
 				SectionIn 1 2
 				SetOverwrite on
-				SetOutPath $INSTDIR\lib\ADM_plugins\videoFilter
-				${File} lib\ADM_plugins\videoFilter\libADM_vf_palShift.dll
+				SetOutPath $INSTDIR\plugins\videoFilter
+				${File} plugins\videoFilter\libADM_vf_palShift.dll
 			${MementoSectionEnd}
 			${MementoSection} "PAL Smart Field Shift" SecVidFltPalSmartFieldShift
 				SectionIn 1 2
 				SetOverwrite on
-				SetOutPath $INSTDIR\lib\ADM_plugins\videoFilter
-				${File} lib\ADM_plugins\videoFilter\libADM_vf_smartPalShift.dll
+				SetOutPath $INSTDIR\plugins\videoFilter
+				${File} plugins\videoFilter\libADM_vf_smartPalShift.dll
 			${MementoSectionEnd}
 			${MementoSection} "Pulldown" SecVidFltPulldown
 				SectionIn 1 2
 				SetOverwrite on
-				SetOutPath $INSTDIR\lib\ADM_plugins\videoFilter
-				${File} lib\ADM_plugins\videoFilter\libADM_vf_Pulldown.dll
+				SetOutPath $INSTDIR\plugins\videoFilter
+				${File} plugins\videoFilter\libADM_vf_Pulldown.dll
 			${MementoSectionEnd}
 			${MementoSection} "Separate Fields" SecVidFltSeparateFields
 				SectionIn 1 2
 				SetOverwrite on
-				SetOutPath $INSTDIR\lib\ADM_plugins\videoFilter
-				${File} lib\ADM_plugins\videoFilter\libADM_vf_hzStackField.dll
+				SetOutPath $INSTDIR\plugins\videoFilter
+				${File} plugins\videoFilter\libADM_vf_hzStackField.dll
 			${MementoSectionEnd}
 			${MementoSection} "Sharpen" SecVidFltSharpen
 				SectionIn 1 2
 				SetOverwrite on
-				SetOutPath $INSTDIR\lib\ADM_plugins\videoFilter
-				${File} lib\ADM_plugins\videoFilter\libADM_vf_fastconvolutionsharpen.dll
+				SetOutPath $INSTDIR\plugins\videoFilter
+				${File} plugins\videoFilter\libADM_vf_fastconvolutionsharpen.dll
 			${MementoSectionEnd}
 			${MementoSection} "Smart Swap Fields" SecVidFltSmartSwapFields
 				SectionIn 1 2
 				SetOverwrite on
-				SetOutPath $INSTDIR\lib\ADM_plugins\videoFilter
-				${File} lib\ADM_plugins\videoFilter\libADM_vf_smartSwapField.dll
+				SetOutPath $INSTDIR\plugins\videoFilter
+				${File} plugins\videoFilter\libADM_vf_smartSwapField.dll
 			${MementoSectionEnd}
 			${MementoSection} "Stack Fields" SecVidFltStackFields
 				SectionIn 1 2
 				SetOverwrite on
-				SetOutPath $INSTDIR\lib\ADM_plugins\videoFilter
-				${File} lib\ADM_plugins\videoFilter\libADM_vf_stackField.dll
+				SetOutPath $INSTDIR\plugins\videoFilter
+				${File} plugins\videoFilter\libADM_vf_stackField.dll
 			${MementoSectionEnd}
 			${MementoSection} "Swap Fields" SecVidFltSwapFields
 				SectionIn 1 2
 				SetOverwrite on
-				SetOutPath $INSTDIR\lib\ADM_plugins\videoFilter
-				${File} lib\ADM_plugins\videoFilter\libADM_vf_swapField.dll
+				SetOutPath $INSTDIR\plugins\videoFilter
+				${File} plugins\videoFilter\libADM_vf_swapField.dll
 			${MementoSectionEnd}
 			${MementoSection} "TDeint" SecVidFltTDeint
 				SectionIn 1 2
 				SetOverwrite on
-				SetOutPath $INSTDIR\lib\ADM_plugins\videoFilter
-				${File} lib\ADM_plugins\videoFilter\libADM_vf_tdeint.dll
+				SetOutPath $INSTDIR\plugins\videoFilter
+				${File} plugins\videoFilter\libADM_vf_tdeint.dll
 			${MementoSectionEnd}
 			${MementoSection} "Unstack Fields" SecVidFltUnstackFields
 				SectionIn 1 2
 				SetOverwrite on
-				SetOutPath $INSTDIR\lib\ADM_plugins\videoFilter
-				${File} lib\ADM_plugins\videoFilter\libADM_vf_unstackField.dll
+				SetOutPath $INSTDIR\plugins\videoFilter
+				${File} plugins\videoFilter\libADM_vf_unstackField.dll
 			${MementoSectionEnd}
 			${MementoSection} "yadif" SecVidFltYadif
 				SectionIn 1 2
 				SetOverwrite on
-				SetOutPath $INSTDIR\lib\ADM_plugins\videoFilter
-				${File} lib\ADM_plugins\videoFilter\libADM_vf_yadif.dll
+				SetOutPath $INSTDIR\plugins\videoFilter
+				${File} plugins\videoFilter\libADM_vf_yadif.dll
 			${MementoSectionEnd}
 		SectionGroupEnd
 		SectionGroup "Colour Filters" SecGrpVideoFilterColour
 			${MementoSection} "Avisynth ColorYUV" SecVidFltAvisynthColorYuv
 				SectionIn 1 2
 				SetOverwrite on
-				SetOutPath $INSTDIR\lib\ADM_plugins\videoFilter
+				SetOutPath $INSTDIR\plugins\videoFilter
 !ifdef INST_GTK
 				!insertmacro SectionFlagIsSet ${SecUiGtk} ${SF_SELECTED} InstallGtk CheckQt
 InstallGtk:
-				${File} lib\ADM_plugins\videoFilter\libADM_vf_colorYUV_gtk.dll
+				${File} plugins\videoFilter\libADM_vf_colorYUV_gtk.dll
 CheckQt:
 !endif
 !ifdef INST_QT
 				!insertmacro SectionFlagIsSet ${SecUiQt} ${SF_SELECTED} InstallQt End
 InstallQt:
-				${File} lib\ADM_plugins\videoFilter\libADM_vf_colorYUV_qt4.dll
+				${File} plugins\videoFilter\libADM_vf_colorYUV_qt4.dll
 End:
 !endif
 			${MementoSectionEnd}
 			${MementoSection} "Blend Removal" SecVidFltBlendRemoval
 				SectionIn 1 2
 				SetOverwrite on
-				SetOutPath $INSTDIR\lib\ADM_plugins\videoFilter
-				${File} lib\ADM_plugins\videoFilter\libADM_vf_blendRemoval.dll
+				SetOutPath $INSTDIR\plugins\videoFilter
+				${File} plugins\videoFilter\libADM_vf_blendRemoval.dll
 			${MementoSectionEnd}
 			${MementoSection} "Chroma Shift" SecVidFltChromaShift
 				SectionIn 1 2
 				SetOverwrite on
-				SetOutPath $INSTDIR\lib\ADM_plugins\videoFilter
+				SetOutPath $INSTDIR\plugins\videoFilter
 !ifdef INST_GTK
 				!insertmacro SectionFlagIsSet ${SecUiGtk} ${SF_SELECTED} InstallGtk CheckQt
 InstallGtk:
-				${File} lib\ADM_plugins\videoFilter\libADM_vf_chromaShift_gtk.dll
+				${File} plugins\videoFilter\libADM_vf_chromaShift_gtk.dll
 CheckQt:
 !endif
 !ifdef INST_QT
 				!insertmacro SectionFlagIsSet ${SecUiQt} ${SF_SELECTED} InstallQt End
 InstallQt:
-				${File} lib\ADM_plugins\videoFilter\libADM_vf_chromaShift_qt4.dll
+				${File} plugins\videoFilter\libADM_vf_chromaShift_qt4.dll
 End:
 !endif
 			${MementoSectionEnd}
 			${MementoSection} "Chroma U" SecVidFltChromaU
 				SectionIn 1 2
 				SetOverwrite on
-				SetOutPath $INSTDIR\lib\ADM_plugins\videoFilter
-				${File} lib\ADM_plugins\videoFilter\libADM_vidChromaU.dll
+				SetOutPath $INSTDIR\plugins\videoFilter
+				${File} plugins\videoFilter\libADM_vidChromaU.dll
 			${MementoSectionEnd}
 			${MementoSection} "Chroma V" SecVidFltChromaV
 				SectionIn 1 2
 				SetOverwrite on
-				SetOutPath $INSTDIR\lib\ADM_plugins\videoFilter
-				${File} lib\ADM_plugins\videoFilter\libADM_vidChromaV.dll
+				SetOutPath $INSTDIR\plugins\videoFilter
+				${File} plugins\videoFilter\libADM_vidChromaV.dll
 			${MementoSectionEnd}
 			${MementoSection} "Contrast" SecVidFltContrast
 				SectionIn 1 2
 				SetOverwrite on
-				SetOutPath $INSTDIR\lib\ADM_plugins\videoFilter
+				SetOutPath $INSTDIR\plugins\videoFilter
 !ifdef INST_GTK
 				!insertmacro SectionFlagIsSet ${SecUiGtk} ${SF_SELECTED} InstallGtk CheckQt
 InstallGtk:
-				${File} lib\ADM_plugins\videoFilter\libADM_vf_contrast_gtk.dll
+				${File} plugins\videoFilter\libADM_vf_contrast_gtk.dll
 CheckQt:
 !endif
 !ifdef INST_QT
 				!insertmacro SectionFlagIsSet ${SecUiQt} ${SF_SELECTED} InstallQt End
 InstallQt:
-				${File} lib\ADM_plugins\videoFilter\libADM_vf_contrast_qt4.dll
+				${File} plugins\videoFilter\libADM_vf_contrast_qt4.dll
 End:
 !endif
 			${MementoSectionEnd}
 			${MementoSection} "Luma Delta" SecVidFltLumaDelta
 				SectionIn 1 2
 				SetOverwrite on
-				SetOutPath $INSTDIR\lib\ADM_plugins\videoFilter
-				${File} lib\ADM_plugins\videoFilter\libADM_vf_Delta.dll
+				SetOutPath $INSTDIR\plugins\videoFilter
+				${File} plugins\videoFilter\libADM_vf_Delta.dll
 			${MementoSectionEnd}
 			${MementoSection} "Luma Equaliser" SecVidFltLumaEqualiser
 				SectionIn 1 2
 				SetOverwrite on
-				SetOutPath $INSTDIR\lib\ADM_plugins\videoFilter
+				SetOutPath $INSTDIR\plugins\videoFilter
 !ifdef INST_GTK
 				!insertmacro SectionFlagIsSet ${SecUiGtk} ${SF_SELECTED} InstallGtk CheckQt
 InstallGtk:
-				${File} lib\ADM_plugins\videoFilter\libADM_vf_equalizer_gtk.dll
+				${File} plugins\videoFilter\libADM_vf_equalizer_gtk.dll
 CheckQt:
 !endif
 !ifdef INST_QT
 				!insertmacro SectionFlagIsSet ${SecUiQt} ${SF_SELECTED} InstallQt End
 InstallQt:
-				${File} lib\ADM_plugins\videoFilter\libADM_vf_equalizer_qt4.dll
+				${File} plugins\videoFilter\libADM_vf_equalizer_qt4.dll
 End:
 !endif
 			${MementoSectionEnd}
 			${MementoSection} "Luma Only" SecVidFltLumaOnly
 				SectionIn 1 2
 				SetOverwrite on
-				SetOutPath $INSTDIR\lib\ADM_plugins\videoFilter
-				${File} lib\ADM_plugins\videoFilter\libADM_vf_lumaonly.dll
+				SetOutPath $INSTDIR\plugins\videoFilter
+				${File} plugins\videoFilter\libADM_vf_lumaonly.dll
 			${MementoSectionEnd}
 			${MementoSection} "Mplayer Eq2" SecVidFltMPlayerEq2
 				SectionIn 1 2
 				SetOverwrite on
-				SetOutPath $INSTDIR\lib\ADM_plugins\videoFilter
+				SetOutPath $INSTDIR\plugins\videoFilter
 !ifdef INST_GTK
 				!insertmacro SectionFlagIsSet ${SecUiGtk} ${SF_SELECTED} InstallGtk CheckQt
 InstallGtk:
-				${File} lib\ADM_plugins\videoFilter\libADM_vf_eq2_gtk.dll
+				${File} plugins\videoFilter\libADM_vf_eq2_gtk.dll
 CheckQt:
 !endif
 !ifdef INST_QT
 				!insertmacro SectionFlagIsSet ${SecUiQt} ${SF_SELECTED} InstallQt End
 InstallQt:
-				${File} lib\ADM_plugins\videoFilter\libADM_vf_eq2_qt4.dll
+				${File} plugins\videoFilter\libADM_vf_eq2_qt4.dll
 End:
 !endif
 			${MementoSectionEnd}
 			${MementoSection} "Mplayer Hue" SecVidFltMPlayerHue
 				SectionIn 1 2
 				SetOverwrite on
-				SetOutPath $INSTDIR\lib\ADM_plugins\videoFilter
+				SetOutPath $INSTDIR\plugins\videoFilter
 !ifdef INST_GTK
 				!insertmacro SectionFlagIsSet ${SecUiGtk} ${SF_SELECTED} InstallGtk CheckQt
 InstallGtk:
-				${File} lib\ADM_plugins\videoFilter\libADM_vf_hue_gtk.dll
+				${File} plugins\videoFilter\libADM_vf_hue_gtk.dll
 CheckQt:
 !endif
 !ifdef INST_QT
 				!insertmacro SectionFlagIsSet ${SecUiQt} ${SF_SELECTED} InstallQt End
 InstallQt:
-				${File} lib\ADM_plugins\videoFilter\libADM_vf_hue_qt4.dll
+				${File} plugins\videoFilter\libADM_vf_hue_qt4.dll
 End:
 !endif
 			${MementoSectionEnd}
 			${MementoSection} "Swap U and V" SecVidFltSwapUandV
 				SectionIn 1 2
 				SetOverwrite on
-				SetOutPath $INSTDIR\lib\ADM_plugins\videoFilter
-				${File} lib\ADM_plugins\videoFilter\libADM_vf_swapuv.dll
+				SetOutPath $INSTDIR\plugins\videoFilter
+				${File} plugins\videoFilter\libADM_vf_swapuv.dll
 			${MementoSectionEnd}
 		SectionGroupEnd
 		SectionGroup "Noise Filters" SecGrpVideoFilterNoise
 			${MementoSection} "Cnr2" SecVidFltCnr2
 				SectionIn 1 2
 				SetOverwrite on
-				SetOutPath $INSTDIR\lib\ADM_plugins\videoFilter
+				SetOutPath $INSTDIR\plugins\videoFilter
 !ifdef INST_GTK
 				!insertmacro SectionFlagIsSet ${SecUiGtk} ${SF_SELECTED} InstallGtk CheckQt
 InstallGtk:
-				${File} lib\ADM_plugins\videoFilter\libADM_vf_cnr2_gtk.dll
+				${File} plugins\videoFilter\libADM_vf_cnr2_gtk.dll
 CheckQt:
 !endif
 !ifdef INST_QT
 				!insertmacro SectionFlagIsSet ${SecUiQt} ${SF_SELECTED} InstallQt End
 InstallQt:
-				${File} lib\ADM_plugins\videoFilter\libADM_vf_cnr2_qt4.dll
+				${File} plugins\videoFilter\libADM_vf_cnr2_qt4.dll
 End:
 !endif
 			${MementoSectionEnd}
 			${MementoSection} "Denoise" SecVidFltDenoise
 				SectionIn 1 2
 				SetOverwrite on
-				SetOutPath $INSTDIR\lib\ADM_plugins\videoFilter
-				${File} lib\ADM_plugins\videoFilter\libADM_vf_Denoise.dll
+				SetOutPath $INSTDIR\plugins\videoFilter
+				${File} plugins\videoFilter\libADM_vf_Denoise.dll
 			${MementoSectionEnd}
 			${MementoSection} "FluxSmooth" SecVidFltFluxSmooth
 				SectionIn 1 2
 				SetOverwrite on
-				SetOutPath $INSTDIR\lib\ADM_plugins\videoFilter
-				${File} lib\ADM_plugins\videoFilter\libADM_vf_FluxSmooth.dll
+				SetOutPath $INSTDIR\plugins\videoFilter
+				${File} plugins\videoFilter\libADM_vf_FluxSmooth.dll
 			${MementoSectionEnd}
 			${MementoSection} "Forced Post-processing" SecVidFltForcedPostProcessing
 				SectionIn 1 2
 				SetOverwrite on
-				SetOutPath $INSTDIR\lib\ADM_plugins\videoFilter
-				${File} lib\ADM_plugins\videoFilter\libADM_vf_forcedPP.dll
+				SetOutPath $INSTDIR\plugins\videoFilter
+				${File} plugins\videoFilter\libADM_vf_forcedPP.dll
 			${MementoSectionEnd}
 			${MementoSection} "Light Denoiser" SecVidFltLightDenoiser
 				SectionIn 1 2
 				SetOverwrite on
-				SetOutPath $INSTDIR\lib\ADM_plugins\videoFilter
-				${File} lib\ADM_plugins\videoFilter\libADM_vf_Stabilize.dll
+				SetOutPath $INSTDIR\plugins\videoFilter
+				${File} plugins\videoFilter\libADM_vf_Stabilize.dll
 			${MementoSectionEnd}
 			${MementoSection} "Median (5x5)" SecVidFltMediam5x5
 				SectionIn 1 2
 				SetOverwrite on
-				SetOutPath $INSTDIR\lib\ADM_plugins\videoFilter
-				${File} lib\ADM_plugins\videoFilter\libADM_vf_largemedian.dll
+				SetOutPath $INSTDIR\plugins\videoFilter
+				${File} plugins\videoFilter\libADM_vf_largemedian.dll
 			${MementoSectionEnd}
 			${MementoSection} "MPlayer Denoise3d" SecVidFltMPlayerDenoise3d
 				SectionIn 1 2
 				SetOverwrite on
-				SetOutPath $INSTDIR\lib\ADM_plugins\videoFilter
-				${File} lib\ADM_plugins\videoFilter\libADM_vf_denoise3d.dll
+				SetOutPath $INSTDIR\plugins\videoFilter
+				${File} plugins\videoFilter\libADM_vf_denoise3d.dll
 			${MementoSectionEnd}
 			${MementoSection} "MPlayer Hqdn3d" SecVidFltMPlayerHqdn3d
 				SectionIn 1 2
 				SetOverwrite on
-				SetOutPath $INSTDIR\lib\ADM_plugins\videoFilter
-				${File} lib\ADM_plugins\videoFilter\libADM_vf_denoise3dhq.dll
+				SetOutPath $INSTDIR\plugins\videoFilter
+				${File} plugins\videoFilter\libADM_vf_denoise3dhq.dll
 			${MementoSectionEnd}
 			${MementoSection} "Temporal Cleaner" SecVidFltTemporalCleaner
 				SectionIn 1 2
 				SetOverwrite on
-				SetOutPath $INSTDIR\lib\ADM_plugins\videoFilter
-				${File} lib\ADM_plugins\videoFilter\libADM_vf_vlad.dll
+				SetOutPath $INSTDIR\plugins\videoFilter
+				${File} plugins\videoFilter\libADM_vf_vlad.dll
 			${MementoSectionEnd}
 			${MementoSection} "TIsophote" SecVidFltTisophote
 				SectionIn 1 2
 				SetOverwrite on
-				SetOutPath $INSTDIR\lib\ADM_plugins\videoFilter
-				${File} lib\ADM_plugins\videoFilter\libADM_vf_Tisophote.dll
+				SetOutPath $INSTDIR\plugins\videoFilter
+				${File} plugins\videoFilter\libADM_vf_Tisophote.dll
 			${MementoSectionEnd}
 		SectionGroupEnd
 		SectionGroup "Sharpness Filters" SecGrpVideoFilterSharpness
 			${MementoSection} "asharp" SecVidFltAsharp
 				SectionIn 1 2
 				SetOverwrite on
-				SetOutPath $INSTDIR\lib\ADM_plugins\videoFilter
+				SetOutPath $INSTDIR\plugins\videoFilter
 !ifdef INST_GTK
 				!insertmacro SectionFlagIsSet ${SecUiGtk} ${SF_SELECTED} InstallGtk CheckQt
 InstallGtk:
-				${File} lib\ADM_plugins\videoFilter\libADM_vf_asharp_gtk.dll
+				${File} plugins\videoFilter\libADM_vf_asharp_gtk.dll
 CheckQt:
 !endif
 !ifdef INST_QT
 				!insertmacro SectionFlagIsSet ${SecUiQt} ${SF_SELECTED} InstallQt End
 InstallQt:
-				${File} lib\ADM_plugins\videoFilter\libADM_vf_asharp_qt4.dll
+				${File} plugins\videoFilter\libADM_vf_asharp_qt4.dll
 End:
 !endif
 			${MementoSectionEnd}
 			${MementoSection} "MSharpen" SecVidFltMSharpen
 				SectionIn 1 2
 				SetOverwrite on
-				SetOutPath $INSTDIR\lib\ADM_plugins\videoFilter
-				${File} lib\ADM_plugins\videoFilter\libADM_vf_mSharpen.dll
+				SetOutPath $INSTDIR\plugins\videoFilter
+				${File} plugins\videoFilter\libADM_vf_mSharpen.dll
 			${MementoSectionEnd}
 			${MementoSection} "MSmooth" SecVidFltMSmooth
 				SectionIn 1 2
 				SetOverwrite on
-				SetOutPath $INSTDIR\lib\ADM_plugins\videoFilter
-				${File} lib\ADM_plugins\videoFilter\libADM_vf_mSmooth.dll
+				SetOutPath $INSTDIR\plugins\videoFilter
+				${File} plugins\videoFilter\libADM_vf_mSmooth.dll
 			${MementoSectionEnd}
 			${MementoSection} "Soften" SecVidFltSoften
 				SectionIn 1 2
 				SetOverwrite on
-				SetOutPath $INSTDIR\lib\ADM_plugins\videoFilter
-				${File} lib\ADM_plugins\videoFilter\libADM_vf_soften.dll
+				SetOutPath $INSTDIR\plugins\videoFilter
+				${File} plugins\videoFilter\libADM_vf_soften.dll
 			${MementoSectionEnd}
 		SectionGroupEnd
 		SectionGroup "Subtitle Filters" SecGrpVideoFilterSubtitle
 			${MementoSection} "ASS/SSA" SecVidFltAssSsa
 				SectionIn 1 2
 				SetOverwrite on
-				SetOutPath $INSTDIR\lib\ADM_plugins\videoFilter
-				${File} lib\ADM_plugins\videoFilter\libADM_vf_ssa.dll
+				SetOutPath $INSTDIR\plugins\videoFilter
+				${File} plugins\videoFilter\libADM_vf_ssa.dll
 			${MementoSectionEnd}
 			${MementoSection} "Subtitler" SecVidFltSubtitler
 				SectionIn 1 2
 				SetOverwrite on
-				SetOutPath $INSTDIR\lib\ADM_plugins\videoFilter
+				SetOutPath $INSTDIR\plugins\videoFilter
 !ifdef INST_GTK
 				!insertmacro SectionFlagIsSet ${SecUiGtk} ${SF_SELECTED} InstallGtk CheckQt
 InstallGtk:
-				${File} lib\ADM_plugins\videoFilter\libADM_vf_sub_gtk.dll
+				${File} plugins\videoFilter\libADM_vf_sub_gtk.dll
 CheckQt:
 !endif
 !ifdef INST_QT
 				!insertmacro SectionFlagIsSet ${SecUiQt} ${SF_SELECTED} InstallQt End
 InstallQt:
-				${File} lib\ADM_plugins\videoFilter\libADM_vf_sub_qt4.dll
+				${File} plugins\videoFilter\libADM_vf_sub_qt4.dll
 End:
 !endif
 			${MementoSectionEnd}
@@ -1030,31 +1030,31 @@
 			${MementoSection} "Mosaic" SecVidFltMosaic
 				SectionIn 1 2
 				SetOverwrite on
-				SetOutPath $INSTDIR\lib\ADM_plugins\videoFilter
-				${File} lib\ADM_plugins\videoFilter\libADM_vf_Mosaic.dll
+				SetOutPath $INSTDIR\plugins\videoFilter
+				${File} plugins\videoFilter\libADM_vf_Mosaic.dll
 			${MementoSectionEnd}
 			${MementoSection} "MPlayer Delogo" SecVidFltMPlayerDelogo
 				SectionIn 1 2
 				SetOverwrite on
-				SetOutPath $INSTDIR\lib\ADM_plugins\videoFilter
+				SetOutPath $INSTDIR\plugins\videoFilter
 !ifdef INST_GTK
 				!insertmacro SectionFlagIsSet ${SecUiGtk} ${SF_SELECTED} InstallGtk CheckQt
 InstallGtk:
-				${File} lib\ADM_plugins\videoFilter\libADM_vf_mpdelogo_gtk.dll
+				${File} plugins\videoFilter\libADM_vf_mpdelogo_gtk.dll
 CheckQt:
 !endif
 !ifdef INST_QT
 				!insertmacro SectionFlagIsSet ${SecUiQt} ${SF_SELECTED} InstallQt End
 InstallQt:
-				${File} lib\ADM_plugins\videoFilter\libADM_vf_mpdelogo_qt4.dll
+				${File} plugins\videoFilter\libADM_vf_mpdelogo_qt4.dll
 End:
 !endif
 			${MementoSectionEnd}
 			${MementoSection} "Whirl" SecVidFltWhirl
 				SectionIn 1 2
 				SetOverwrite on
-				SetOutPath $INSTDIR\lib\ADM_plugins\videoFilter
-				${File} lib\ADM_plugins\videoFilter\libADM_vf_Whirl.dll
+				SetOutPath $INSTDIR\plugins\videoFilter
+				${File} plugins\videoFilter\libADM_vf_Whirl.dll
 			${MementoSectionEnd}
 		SectionGroupEnd
 	SectionGroupEnd

Modified: branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_x264/CMakeLists.txt
===================================================================
--- branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_x264/CMakeLists.txt	2009-02-13 23:10:28 UTC (rev 4586)
+++ branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_x264/CMakeLists.txt	2009-02-13 23:29:49 UTC (rev 4587)
@@ -26,6 +26,6 @@
 
 		INIT_VIDEO_ENCODER_PLUGIN(ADM_vidEnc_x264)
 		INSTALL_VIDEO_ENCODER(ADM_vidEnc_x264)
-		INSTALL(FILES x264Param.xsd DESTINATION "${CMAKE_INSTALL_PREFIX}/lib/ADM_plugins/videoEncoder/${PLUGIN_SUBDIR}")
+		INSTALL(FILES x264Param.xsd DESTINATION "${VIDENC_INSTALL_DIR}${PLUGIN_SUBDIR}")
 	ENDIF (LIBXML2_FOUND)
 ENDIF (X264_FOUND)
\ No newline at end of file

Modified: branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_x264/gtk/CMakeLists.txt
===================================================================
--- branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_x264/gtk/CMakeLists.txt	2009-02-13 23:10:28 UTC (rev 4586)
+++ branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_x264/gtk/CMakeLists.txt	2009-02-13 23:29:49 UTC (rev 4587)
@@ -23,5 +23,5 @@
 	ENDIF(GETTEXT_FOUND)
 
 	INIT_VIDEO_ENCODER_PLUGIN(${GTK_PLUGIN_NAME})
-	INSTALL(TARGETS ${GTK_PLUGIN_NAME} DESTINATION "${CMAKE_INSTALL_PREFIX}/lib/ADM_plugins/videoEncoder/${PLUGIN_SUBDIR}")
+	INSTALL(TARGETS ${GTK_PLUGIN_NAME} DESTINATION "${VIDENC_INSTALL_DIR}${PLUGIN_SUBDIR}")
 ENDIF (GTK_FOUND AND GTHREAD_FOUND)
\ No newline at end of file

Modified: branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_x264/qt4/CMakeLists.txt
===================================================================
--- branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_x264/qt4/CMakeLists.txt	2009-02-13 23:10:28 UTC (rev 4586)
+++ branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_x264/qt4/CMakeLists.txt	2009-02-13 23:29:49 UTC (rev 4587)
@@ -16,5 +16,5 @@
 	TARGET_LINK_LIBRARIES(${QT_PLUGIN_NAME} ADM_vidEnc_x264 ADM_core ADM_coreUI ${QT_QTGUI_LIBRARY} ${QT_QTCORE_LIBRARY})
 
 	INIT_VIDEO_ENCODER_PLUGIN(${QT_PLUGIN_NAME})
-	INSTALL(TARGETS ${QT_PLUGIN_NAME} DESTINATION "${CMAKE_INSTALL_PREFIX}/lib/ADM_plugins/videoEncoder/${PLUGIN_SUBDIR}")
+	INSTALL(TARGETS ${QT_PLUGIN_NAME} DESTINATION "${VIDENC_INSTALL_DIR}${PLUGIN_SUBDIR}")
 ENDIF (QT4_FOUND)
\ No newline at end of file

Modified: branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_x264/xml/CMakeLists.txt
===================================================================
--- branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_x264/xml/CMakeLists.txt	2009-02-13 23:10:28 UTC (rev 4586)
+++ branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_x264/xml/CMakeLists.txt	2009-02-13 23:29:49 UTC (rev 4587)
@@ -1 +1 @@
-INSTALL(FILES "PlayStation Portable.xml" DESTINATION "${CMAKE_INSTALL_PREFIX}/lib/ADM_plugins/videoEncoder/${PLUGIN_SUBDIR}")
\ No newline at end of file
+INSTALL(FILES "PlayStation Portable.xml" DESTINATION "${VIDENC_INSTALL_DIR}${PLUGIN_SUBDIR}")
\ No newline at end of file

Modified: branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_xvid/CMakeLists.txt
===================================================================
--- branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_xvid/CMakeLists.txt	2009-02-13 23:10:28 UTC (rev 4586)
+++ branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_xvid/CMakeLists.txt	2009-02-13 23:29:49 UTC (rev 4587)
@@ -24,6 +24,6 @@
 
 		INIT_VIDEO_ENCODER_PLUGIN(ADM_vidEnc_xvid)
 		INSTALL_VIDEO_ENCODER(ADM_vidEnc_xvid)
-		INSTALL(FILES XvidParam.xsd DESTINATION "${CMAKE_INSTALL_PREFIX}/lib/ADM_plugins/videoEncoder/${PLUGIN_SUBDIR}")
+		INSTALL(FILES XvidParam.xsd DESTINATION "${VIDENC_INSTALL_DIR}${PLUGIN_SUBDIR}")
 	ENDIF (LIBXML2_FOUND)
 ENDIF (XVID_FOUND)
\ No newline at end of file

Modified: branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_xvid/gtk/CMakeLists.txt
===================================================================
--- branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_xvid/gtk/CMakeLists.txt	2009-02-13 23:10:28 UTC (rev 4586)
+++ branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_xvid/gtk/CMakeLists.txt	2009-02-13 23:29:49 UTC (rev 4587)
@@ -23,5 +23,5 @@
 	ENDIF(GETTEXT_FOUND)
 
 	INIT_VIDEO_ENCODER_PLUGIN(${GTK_PLUGIN_NAME})
-	INSTALL(TARGETS ${GTK_PLUGIN_NAME} DESTINATION "${CMAKE_INSTALL_PREFIX}/lib/ADM_plugins/videoEncoder/${PLUGIN_SUBDIR}")
+	INSTALL(TARGETS ${GTK_PLUGIN_NAME} DESTINATION "${VIDENC_INSTALL_DIR}${PLUGIN_SUBDIR}")
 ENDIF (GTK_FOUND AND GTHREAD_FOUND)
\ No newline at end of file

Modified: branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/CMakeLists.txt
===================================================================
--- branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/CMakeLists.txt	2009-02-13 23:10:28 UTC (rev 4586)
+++ branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/CMakeLists.txt	2009-02-13 23:29:49 UTC (rev 4587)
@@ -16,5 +16,5 @@
 	TARGET_LINK_LIBRARIES(${QT_PLUGIN_NAME} ADM_vidEnc_xvid ADM_coreUI ${QT_QTGUI_LIBRARY} ${QT_QTCORE_LIBRARY})
 
 	INIT_VIDEO_ENCODER_PLUGIN(${QT_PLUGIN_NAME})
-	INSTALL(TARGETS ${QT_PLUGIN_NAME} DESTINATION "${CMAKE_INSTALL_PREFIX}/lib/ADM_plugins/videoEncoder/${PLUGIN_SUBDIR}")
+	INSTALL(TARGETS ${QT_PLUGIN_NAME} DESTINATION "${VIDENC_INSTALL_DIR}${PLUGIN_SUBDIR}")
 ENDIF (QT4_FOUND)
\ No newline at end of file



From gruntster at mail.berlios.de  Sat Feb 14 22:08:16 2009
From: gruntster at mail.berlios.de (gruntster at mail.berlios.de)
Date: Sat, 14 Feb 2009 22:08:16 +0100
Subject: [Avidemux-svn-commit] r4588 - in
	branches/avidemux_2.5_branch_gruntster: avidemux cmake
	platforms/windows/installer
Message-ID: <200902142108.n1EL8G7L003299@sheep.berlios.de>

Author: gruntster
Date: 2009-02-14 22:08:10 +0100 (Sat, 14 Feb 2009)
New Revision: 4588

Modified:
   branches/avidemux_2.5_branch_gruntster/avidemux/CMakeLists.txt
   branches/avidemux_2.5_branch_gruntster/cmake/admWin32.rc.in
   branches/avidemux_2.5_branch_gruntster/platforms/windows/installer/avidemux.nsi
Log:
[Win32] use correct icons for executables

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/CMakeLists.txt
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/CMakeLists.txt	2009-02-13 23:29:49 UTC (rev 4587)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/CMakeLists.txt	2009-02-14 21:08:10 UTC (rev 4588)
@@ -115,10 +115,15 @@
 	STRING(REPLACE "." "," PRODUCTVERSION ${PRODUCTVERSION_STRING})
 	SET(PRODUCTVERSION "${PRODUCTVERSION},0")
 
-	CONFIGURE_FILE("${CMAKE_SOURCE_DIR}/cmake/admWin32.rc.in" ${CMAKE_CURRENT_BINARY_DIR}/admWin32.rc IMMEDIATE)
-	ADD_CUSTOM_COMMAND(OUTPUT ${CMAKE_CURRENT_BINARY_DIR}/admWin32.obj COMMAND windres.exe -i ${CMAKE_CURRENT_BINARY_DIR}/admWin32.rc -o ${CMAKE_CURRENT_BINARY_DIR}/admWin32.obj -O coff --define VS_VERSION_INFO=1)
+	SET(AVIDEMUX_ICON "adm.ico")
+	SET(WIN_RES_GTK "admWinGtk.obj")
+	CONFIGURE_FILE("${CMAKE_SOURCE_DIR}/cmake/admWin32.rc.in" ${CMAKE_CURRENT_BINARY_DIR}/admWinGtk.rc IMMEDIATE)
+	ADD_CUSTOM_COMMAND(OUTPUT ${CMAKE_CURRENT_BINARY_DIR}/${WIN_RES_GTK} COMMAND windres.exe -i ${CMAKE_CURRENT_BINARY_DIR}/admWinGtk.rc -o ${CMAKE_CURRENT_BINARY_DIR}/${WIN_RES_GTK} -O coff --define VS_VERSION_INFO=1)
 
-	SET(ADM_EXE_SRCS ${ADM_EXE_SRCS} "${CMAKE_CURRENT_BINARY_DIR}/admWin32.obj")
+	SET(AVIDEMUX_ICON "avidemux.ico")
+	SET(WIN_RES_QT "admWinQt.obj")
+	CONFIGURE_FILE("${CMAKE_SOURCE_DIR}/cmake/admWin32.rc.in" ${CMAKE_CURRENT_BINARY_DIR}/admWinQt.rc IMMEDIATE)
+	ADD_CUSTOM_COMMAND(OUTPUT ${CMAKE_CURRENT_BINARY_DIR}/${WIN_RES_QT} COMMAND windres.exe -i ${CMAKE_CURRENT_BINARY_DIR}/admWinQt.rc -o ${CMAKE_CURRENT_BINARY_DIR}/${WIN_RES_QT} -O coff --define VS_VERSION_INFO=1)
 ENDIF (WIN32)
 
 ########################################
@@ -126,18 +131,18 @@
 ########################################
 SET(ADM_EXE_SRCS ${ADM_EXE_SRCS} ADM_preview.cpp  gtk_gui.cpp  gui_autodrive.cpp  GUI_jobs.cpp  gui_navigate.cpp  guiplay.cpp  gui_savenew.cpp  main.cpp  gui_action.cpp)
 
-ADD_EXECUTABLE(avidemux2_cli MACOSX_BUNDLE ${ADM_EXE_SRCS} ${MO_FILES})
+ADD_EXECUTABLE(avidemux2_cli MACOSX_BUNDLE ${ADM_EXE_SRCS} ${MO_FILES} ${WIN_RES_GTK})
 ADD_TARGET_CFLAGS(avidemux2_cli "-I${CMAKE_BINARY_DIR}/config/cli")
 ADD_DEPENDENCIES(avidemux2_cli mofiles  ffmpeg)
 
 IF (ADM_UI_GTK)
-	ADD_EXECUTABLE(avidemux2_gtk MACOSX_BUNDLE ${ADM_EXE_SRCS} ${MO_FILES})
+	ADD_EXECUTABLE(avidemux2_gtk MACOSX_BUNDLE ${ADM_EXE_SRCS} ${MO_FILES} ${WIN_RES_GTK})
 	ADD_TARGET_CFLAGS(avidemux2_gtk "-I${CMAKE_BINARY_DIR}/config/gtk")
 	ADD_DEPENDENCIES(avidemux2_gtk mofiles  ffmpeg)
 ENDIF (ADM_UI_GTK)
 
 IF (ADM_UI_QT4)
-	ADD_EXECUTABLE(avidemux2_qt4 MACOSX_BUNDLE ${ADM_EXE_SRCS} ${QM_FILES})
+	ADD_EXECUTABLE(avidemux2_qt4 MACOSX_BUNDLE ${ADM_EXE_SRCS} ${QM_FILES} ${WIN_RES_QT})
 	ADD_TARGET_CFLAGS(avidemux2_qt4 "-I${CMAKE_BINARY_DIR}/config/qt4")
 	ADD_DEPENDENCIES(avidemux2_qt4 qmfiles  ffmpeg)
 ENDIF (ADM_UI_QT4)

Modified: branches/avidemux_2.5_branch_gruntster/cmake/admWin32.rc.in
===================================================================
--- branches/avidemux_2.5_branch_gruntster/cmake/admWin32.rc.in	2009-02-13 23:29:49 UTC (rev 4587)
+++ branches/avidemux_2.5_branch_gruntster/cmake/admWin32.rc.in	2009-02-14 21:08:10 UTC (rev 4588)
@@ -15,7 +15,7 @@
             VALUE "FileDescription",  "Avidemux ${PRODUCTVERSION_STRING}"
             VALUE "FileVersion",      "${FILEVERSION_STRING}"
             VALUE "InternalName",     "avidemux"
-            VALUE "LegalCopyright",   "Copyright ? 2001-2007 Free Software Foundation"
+            VALUE "LegalCopyright",   "Copyright ? 2001-2009 Free Software Foundation"
             VALUE "OriginalFilename", ""
             VALUE "ProductName",      "Avidemux"
             VALUE "ProductVersion",   "${PRODUCTVERSION_STRING}"
@@ -28,4 +28,4 @@
     END
 END
 
-100 ICON "${CMAKE_SOURCE_DIR}/avidemux/xpm/adm.ico"
\ No newline at end of file
+100 ICON "${CMAKE_SOURCE_DIR}/avidemux/xpm/${AVIDEMUX_ICON}"
\ No newline at end of file

Modified: branches/avidemux_2.5_branch_gruntster/platforms/windows/installer/avidemux.nsi
===================================================================
--- branches/avidemux_2.5_branch_gruntster/platforms/windows/installer/avidemux.nsi	2009-02-13 23:29:49 UTC (rev 4587)
+++ branches/avidemux_2.5_branch_gruntster/platforms/windows/installer/avidemux.nsi	2009-02-14 21:08:10 UTC (rev 4588)
@@ -292,7 +292,7 @@
 SectionEnd
 
 SectionGroup /e "User interfaces" SecGrpUI
-    ${MementoSection} "Command line" SecUiCli
+    ${MementoUnselectedSection} "Command line" SecUiCli
         SectionIn 1 2
         SetOutPath $INSTDIR
         SetOverwrite on
@@ -302,10 +302,10 @@
     ${MementoSectionEnd}
 
 !ifdef INST_BOTH
-	${MementoUnselectedSection} GTK+ SecUiGtk    
+	${MementoUnselectedSection} GTK+ SecUiGtk
 	SectionIn 2
 !else ifdef INST_GTK
-	${MementoSection} GTK+ SecUiGtk    
+	${MementoSection} GTK+ SecUiGtk
 	SectionIn 1 2 RO
 !endif
 !ifdef INST_BOTH | INST_GTK



From gruntster at mail.berlios.de  Sat Feb 14 22:09:00 2009
From: gruntster at mail.berlios.de (gruntster at mail.berlios.de)
Date: Sat, 14 Feb 2009 22:09:00 +0100
Subject: [Avidemux-svn-commit] r4589 - in
	branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces:
	ADM_GTK/ADM_dialog ADM_QT4/ADM_dialog
Message-ID: <200902142109.n1EL90Av003348@sheep.berlios.de>

Author: gruntster
Date: 2009-02-14 22:08:55 +0100 (Sat, 14 Feb 2009)
New Revision: 4589

Modified:
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_about.cpp
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/about.ui
Log:
[UI] update copyright year

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_about.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_about.cpp	2009-02-14 21:08:10 UTC (rev 4588)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_about.cpp	2009-02-14 21:08:55 UTC (rev 4589)
@@ -52,7 +52,7 @@
   gtk_about_dialog_set_version (GTK_ABOUT_DIALOG (aboutdialog1), subversion);
 // /MEANX
   gtk_about_dialog_set_name (GTK_ABOUT_DIALOG (aboutdialog1), "Avidemux");
-  gtk_about_dialog_set_copyright (GTK_ABOUT_DIALOG (aboutdialog1), "\302\251 2001 - 2008 Mean");
+  gtk_about_dialog_set_copyright (GTK_ABOUT_DIALOG (aboutdialog1), "\302\251 2001 - 2009 Mean");
   gtk_about_dialog_set_comments (GTK_ABOUT_DIALOG (aboutdialog1), QT_TR_NOOP("Multi-platform Video Editor"));
   gtk_about_dialog_set_license (GTK_ABOUT_DIALOG (aboutdialog1), QT_TR_NOOP("Avidemux is free software; you can redistribute it and/or modify it\nunder the terms of the GNU General Public License version 2\nas published by the Free Software Foundation.\n\n\t\t    GNU GENERAL PUBLIC LICENSE\n\t\t       Version 2, June 1991\n\n Copyright (C) 1989, 1991 Free Software Foundation, Inc.\n                       51 Franklin St, Fifth Floor, Boston, MA  02110-1301  USA\n Everyone is permitted to copy and distribute verbatim copies\n of this license document, but changing it is not allowed.\n\n\t\t\t    Preamble\n\n  The licenses for most software are designed to take away your\nfreedom to share and change it.  By contrast, the GNU General Public\nLicense is intended to guarantee your freedom to share and change free\nsoftware--to make sure the software is free for all its users.  This\nGeneral Public License applies to most of the Free Software\nFoundation's software and to any othe!
 r program whose authors commit to\nusing it.  (Some other Free Software Foundation software is covered by\nthe GNU Library General Public License instead.)  You can apply it to\nyour programs, too.\n\n  When we speak of free software, we are referring to freedom, not\nprice.  Our General Public Licenses are designed to make sure that you\nhave the freedom to distribute copies of free software (and charge for\nthis service if you wish), that you receive source code or can get it\nif you want it, that you can change the software or use pieces of it\nin new free programs; and that you know you can do these things.\n\n  To protect your rights, we need to make restrictions that forbid\nanyone to deny you these rights or to ask you to surrender the rights.\nThese restrictions translate to certain responsibilities for you if you\ndistribute copies of the software, or if you modify it.\n\n  For example, if you distribute copies of such a program, whether\ngratis or for a fee, you m!
 ust give the recipients all the rights that\nyou have.  You mu!
 st make 
sure that they, too, receive or can get the\nsource code.  And you must show them these terms so they know their\nrights.\n\n  We protect your rights with two steps: (1) copyright the software, and\n(2) offer you this license which gives you legal permission to copy,\ndistribute and/or modify the software.\n\n  Also, for each author's protection and ours, we want to make certain\nthat everyone understands that there is no warranty for this free\nsoftware.  If the software is modified by someone else and passed on, we\nwant its recipients to know that what they have is not the original, so\nthat any problems introduced by others will not reflect on the original\nauthors' reputations.\n\n  Finally, any free program is threatened constantly by software\npatents.  We wish to avoid the danger that redistributors of a free\nprogram will individually obtain patent licenses, in effect making the\nprogram proprietary.  To prevent this, we have made it clear that any\npatent must be l!
 icensed for everyone's free use or not licensed at all.\n\n  The precise terms and conditions for copying, distribution and\nmodification follow.\n\n\t\t    GNU GENERAL PUBLIC LICENSE\n   TERMS AND CONDITIONS FOR COPYING, DISTRIBUTION AND MODIFICATION\n\n  0. This License applies to any program or other work which contains\na notice placed by the copyright holder saying it may be distributed\nunder the terms of this General Public License.  The \"Program\", below,\nrefers to any such program or work, and a \"work based on the Program\"\nmeans either the Program or any derivative work under copyright law:\nthat is to say, a work containing the Program or a portion of it,\neither verbatim or with modifications and/or translated into another\nlanguage.  (Hereinafter, translation is included without limitation in\nthe term \"modification\".)  Each licensee is addressed as \"you\".\n\nActivities other than copying, distribution and modification are not\ncovered by this License; !
 they are outside its scope.  The act of\nrunning the Program i!
 s not re
stricted, and the output from the Program\nis covered only if its contents constitute a work based on the\nProgram (independent of having been made by running the Program).\nWhether that is true depends on what the Program does.\n\n  1. You may copy and distribute verbatim copies of the Program's\nsource code as you receive it, in any medium, provided that you\nconspicuously and appropriately publish on each copy an appropriate\ncopyright notice and disclaimer of warranty; keep intact all the\nnotices that refer to this License and to the absence of any warranty;\nand give any other recipients of the Program a copy of this License\nalong with the Program.\n\nYou may charge a fee for the physical act of transferring a copy, and\nyou may at your option offer warranty protection in exchange for a fee.\n\n  2. You may modify your copy or copies of the Program or any portion\nof it, thus forming a work based on the Program, and copy and\ndistribute such modifications or work unde!
 r the terms of Section 1\nabove, provided that you also meet all of these conditions:\n\n    a) You must cause the modified files to carry prominent notices\n    stating that you changed the files and the date of any change.\n\n    b) You must cause any work that you distribute or publish, that in\n    whole or in part contains or is derived from the Program or any\n    part thereof, to be licensed as a whole at no charge to all third\n    parties under the terms of this License.\n\n    c) If the modified program normally reads commands interactively\n    when run, you must cause it, when started running for such\n    interactive use in the most ordinary way, to print or display an\n    announcement including an appropriate copyright notice and a\n    notice that there is no warranty (or else, saying that you provide\n    a warranty) and that users may redistribute the program under\n    these conditions, and telling the user how to view a copy of this\n    License.  (Excep!
 tion: if the Program itself is interactive but\n    does not n!
 ormally 
print such an announcement, your work based on\n    the Program is not required to print an announcement.)\n\nThese requirements apply to the modified work as a whole.  If\nidentifiable sections of that work are not derived from the Program,\nand can be reasonably considered independent and separate works in\nthemselves, then this License, and its terms, do not apply to those\nsections when you distribute them as separate works.  But when you\ndistribute the same sections as part of a whole which is a work based\non the Program, the distribution of the whole must be on the terms of\nthis License, whose permissions for other licensees extend to the\nentire whole, and thus to each and every part regardless of who wrote it.\n\nThus, it is not the intent of this section to claim rights or contest\nyour rights to work written entirely by you; rather, the intent is to\nexercise the right to control the distribution of derivative or\ncollective works based on the Program.\n\nIn add!
 ition, mere aggregation of another work not based on the Program\nwith the Program (or with a work based on the Program) on a volume of\na storage or distribution medium does not bring the other work under\nthe scope of this License.\n\n  3. You may copy and distribute the Program (or a work based on it,\nunder Section 2) in object code or executable form under the terms of\nSections 1 and 2 above provided that you also do one of the following:\n\n    a) Accompany it with the complete corresponding machine-readable\n    source code, which must be distributed under the terms of Sections\n    1 and 2 above on a medium customarily used for software interchange; or,\n\n    b) Accompany it with a written offer, valid for at least three\n    years, to give any third party, for a charge no more than your\n    cost of physically performing source distribution, a complete\n    machine-readable copy of the corresponding source code, to be\n    distributed under the terms of Sections !
 1 and 2 above on a medium\n    customarily used for software i!
 nterchan
ge; or,\n\n    c) Accompany it with the information you received as to the offer\n    to distribute corresponding source code.  (This alternative is\n    allowed only for noncommercial distribution and only if you\n    received the program in object code or executable form with such\n    an offer, in accord with Subsection b above.)\n\nThe source code for a work means the preferred form of the work for\nmaking modifications to it.  For an executable work, complete source\ncode means all the source code for all modules it contains, plus any\nassociated interface definition files, plus the scripts used to\ncontrol compilation and installation of the executable.  However, as a\nspecial exception, the source code distributed need not include\nanything that is normally distributed (in either source or binary\nform) with the major components (compiler, kernel, and so on) of the\noperating system on which the executable runs, unless that component\nitself accompanies the executable!
 .\n\nIf distribution of executable or object code is made by offering\naccess to copy from a designated place, then offering equivalent\naccess to copy the source code from the same place counts as\ndistribution of the source code, even though third parties are not\ncompelled to copy the source along with the object code.\n\n  4. You may not copy, modify, sublicense, or distribute the Program\nexcept as expressly provided under this License.  Any attempt\notherwise to copy, modify, sublicense or distribute the Program is\nvoid, and will automatically terminate your rights under this License.\nHowever, parties who have received copies, or rights, from you under\nthis License will not have their licenses terminated so long as such\nparties remain in full compliance.\n\n  5. You are not required to accept this License, since you have not\nsigned it.  However, nothing else grants you permission to modify or\ndistribute the Program or its derivative works.  These actions are\npr!
 ohibited by law if you do not accept this License.  Therefore,!
  by\nmod
ifying or distributing the Program (or any work based on the\nProgram), you indicate your acceptance of this License to do so, and\nall its terms and conditions for copying, distributing or modifying\nthe Program or works based on it.\n\n  6. Each time you redistribute the Program (or any work based on the\nProgram), the recipient automatically receives a license from the\noriginal licensor to copy, distribute or modify the Program subject to\nthese terms and conditions.  You may not impose any further\nrestrictions on the recipients' exercise of the rights granted herein.\nYou are not responsible for enforcing compliance by third parties to\nthis License.\n\n  7. If, as a consequence of a court judgment or allegation of patent\ninfringement or for any other reason (not limited to patent issues),\nconditions are imposed on you (whether by court order, agreement or\notherwise) that contradict the conditions of this License, they do not\nexcuse you from the conditions of this !
 License.  If you cannot\ndistribute so as to satisfy simultaneously your obligations under this\nLicense and any other pertinent obligations, then as a consequence you\nmay not distribute the Program at all.  For example, if a patent\nlicense would not permit royalty-free redistribution of the Program by\nall those who receive copies directly or indirectly through you, then\nthe only way you could satisfy both it and this License would be to\nrefrain entirely from distribution of the Program.\n\nIf any portion of this section is held invalid or unenforceable under\nany particular circumstance, the balance of the section is intended to\napply and the section as a whole is intended to apply in other\ncircumstances.\n\nIt is not the purpose of this section to induce you to infringe any\npatents or other property right claims or to contest validity of any\nsuch claims; this section has the sole purpose of protecting the\nintegrity of the free software distribution system, which!
  is\nimplemented by public license practices.  Many people hav!
 e made\n
generous contributions to the wide range of software distributed\nthrough that system in reliance on consistent application of that\nsystem; it is up to the author/donor to decide if he or she is willing\nto distribute software through any other system and a licensee cannot\nimpose that choice.\n\nThis section is intended to make thoroughly clear what is believed to\nbe a consequence of the rest of this License.\n\n  8. If the distribution and/or use of the Program is restricted in\ncertain countries either by patents or by copyrighted interfaces, the\noriginal copyright holder who places the Program under this License\nmay add an explicit geographical distribution limitation excluding\nthose countries, so that distribution is permitted only in or among\ncountries not thus excluded.  In such case, this License incorporates\nthe limitation as if written in the body of this License.\n\n  9. The Free Software Foundation may publish revised and/or new versions\nof the General Pu!
 blic License from time to time.  Such new versions will\nbe similar in spirit to the present version, but may differ in detail to\naddress new problems or concerns.\n\nEach version is given a distinguishing version number.  If the Program\nspecifies a version number of this License which applies to it and \"any\nlater version\", you have the option of following the terms and conditions\neither of that version or of any later version published by the Free\nSoftware Foundation.  If the Program does not specify a version number of\nthis License, you may choose any version ever published by the Free Software\nFoundation.\n\n  10. If you wish to incorporate parts of the Program into other free\nprograms whose distribution conditions are different, write to the author\nto ask for permission.  For software which is copyrighted by the Free\nSoftware Foundation, write to the Free Software Foundation; we sometimes\nmake exceptions for this.  Our decision will be guided by the two goa!
 ls\nof preserving the free status of all derivatives of our fr!
 ee softw
are and\nof promoting the sharing and reuse of software generally.\n\n\t\t\t    NO WARRANTY\n\n  11. BECAUSE THE PROGRAM IS LICENSED FREE OF CHARGE, THERE IS NO WARRANTY\nFOR THE PROGRAM, TO THE EXTENT PERMITTED BY APPLICABLE LAW.  EXCEPT WHEN\nOTHERWISE STATED IN WRITING THE COPYRIGHT HOLDERS AND/OR OTHER PARTIES\nPROVIDE THE PROGRAM \"AS IS\" WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESSED\nOR IMPLIED, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF\nMERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  THE ENTIRE RISK AS\nTO THE QUALITY AND PERFORMANCE OF THE PROGRAM IS WITH YOU.  SHOULD THE\nPROGRAM PROVE DEFECTIVE, YOU ASSUME THE COST OF ALL NECESSARY SERVICING,\nREPAIR OR CORRECTION.\n\n  12. IN NO EVENT UNLESS REQUIRED BY APPLICABLE LAW OR AGREED TO IN WRITING\nWILL ANY COPYRIGHT HOLDER, OR ANY OTHER PARTY WHO MAY MODIFY AND/OR\nREDISTRIBUTE THE PROGRAM AS PERMITTED ABOVE, BE LIABLE TO YOU FOR DAMAGES,\nINCLUDING ANY GENERAL, SPECIAL, INCIDENTAL OR CONSEQUENT!
 IAL DAMAGES ARISING\nOUT OF THE USE OR INABILITY TO USE THE PROGRAM (INCLUDING BUT NOT LIMITED\nTO LOSS OF DATA OR DATA BEING RENDERED INACCURATE OR LOSSES SUSTAINED BY\nYOU OR THIRD PARTIES OR A FAILURE OF THE PROGRAM TO OPERATE WITH ANY OTHER\nPROGRAMS), EVEN IF SUCH HOLDER OR OTHER PARTY HAS BEEN ADVISED OF THE\nPOSSIBILITY OF SUCH DAMAGES.\n\n\t\t     END OF TERMS AND CONDITIONS\n\n\t    How to Apply These Terms to Your New Programs\n\n  If you develop a new program, and you want it to be of the greatest\npossible use to the public, the best way to achieve this is to make it\nfree software which everyone can redistribute and change under these terms.\n\n  To do so, attach the following notices to the program.  It is safest\nto attach them to the start of each source file to most effectively\nconvey the exclusion of warranty; and each file should have at least\nthe \"copyright\" line and a pointer to where the full notice is found.\n\n    <one line to give the program's !
 name and a brief idea of what it does.>\n    Copyright (C) <ye!
 ar>  <na
me of author>\n\n    This program is free software; you can redistribute it and/or modify\n    it under the terms of the GNU General Public License as published by\n    the Free Software Foundation; either version 2 of the License, or\n    (at your option) any later version.\n\n    This program is distributed in the hope that it will be useful,\n    but WITHOUT ANY WARRANTY; without even the implied warranty of\n    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n    GNU General Public License for more details.\n\n    You should have received a copy of the GNU General Public License\n    along with this program; if not, write to the Free Software\n    Foundation, Inc., 51 Franklin St, Fifth Floor, Boston, MA  02110-1301  USA\n\n\nAlso add information on how to contact you by electronic and paper mail.\n\nIf the program is interactive, make it output a short notice like this\nwhen it starts in an interactive mode:\n\n    Gnomovision version 69, Copyright (C) ye!
 ar name of author\n    Gnomovision comes with ABSOLUTELY NO WARRANTY; for details type `show w'.\n    This is free software, and you are welcome to redistribute it\n    under certain conditions; type `show c' for details.\n\nThe hypothetical commands `show w' and `show c' should show the appropriate\nparts of the General Public License.  Of course, the commands you use may\nbe called something other than `show w' and `show c'; they could even be\nmouse-clicks or menu items--whatever suits your program.\n\nYou should also get your employer (if you work as a programmer) or your\nschool, if any, to sign a \"copyright disclaimer\" for the program, if\nnecessary.  Here is a sample; alter the names:\n\n  Yoyodyne, Inc., hereby disclaims all copyright interest in the program\n  `Gnomovision' (which makes passes at compilers) written by James Hacker.\n\n  <signature of Ty Coon>, 1 April 1989\n  Ty Coon, President of Vice\n\nThis General Public License does not permit incorporating !
 your program into\nproprietary programs.  If your program is a!
  subrout
ine library, you may\nconsider it more useful to permit linking proprietary applications with the\nlibrary.  If this is what you want to do, use the GNU Library General\nPublic License instead of this License."));
   gtk_about_dialog_set_website (GTK_ABOUT_DIALOG (aboutdialog1), "http://www.avidemux.org");

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/about.ui
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/about.ui	2009-02-14 21:08:10 UTC (rev 4588)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/about.ui	2009-02-14 21:08:55 UTC (rev 4589)
@@ -107,7 +107,7 @@
      <item>
       <widget class="QLabel" name="label_3" >
        <property name="text" >
-        <string>? 2001 - 2008  Mean</string>
+        <string>? 2001 - 2009  Mean</string>
        </property>
        <property name="alignment" >
         <set>Qt::AlignCenter</set>



From gruntster at mail.berlios.de  Sun Feb 15 14:15:33 2009
From: gruntster at mail.berlios.de (gruntster at mail.berlios.de)
Date: Sun, 15 Feb 2009 14:15:33 +0100
Subject: [Avidemux-svn-commit] r4590 - in
	branches/avidemux_2.5_branch_gruntster/platforms/windows/build_scripts:
	. x264
Message-ID: <200902151315.n1FDFX0N016034@sheep.berlios.de>

Author: gruntster
Date: 2009-02-15 14:15:22 +0100 (Sun, 15 Feb 2009)
New Revision: 4590

Added:
   branches/avidemux_2.5_branch_gruntster/platforms/windows/build_scripts/x264/
   branches/avidemux_2.5_branch_gruntster/platforms/windows/build_scripts/x264/Perform Build.bat
Modified:
   branches/avidemux_2.5_branch_gruntster/platforms/windows/build_scripts/Set Common Environment Variables.bat
Log:
[Win32] libx264 build script

Modified: branches/avidemux_2.5_branch_gruntster/platforms/windows/build_scripts/Set Common Environment Variables.bat
===================================================================
--- branches/avidemux_2.5_branch_gruntster/platforms/windows/build_scripts/Set Common Environment Variables.bat	2009-02-14 21:08:55 UTC (rev 4589)
+++ branches/avidemux_2.5_branch_gruntster/platforms/windows/build_scripts/Set Common Environment Variables.bat	2009-02-15 13:15:22 UTC (rev 4590)
@@ -14,6 +14,7 @@
 set SDLDIR=%usrLocalDir%
 set CFLAGS=-I%CMAKE_INCLUDE_PATH% -L%CMAKE_LIBRARY_PATH%
 set CXXFLAGS=-I%CMAKE_INCLUDE_PATH% -L%CMAKE_LIBRARY_PATH%
+set LDFLAGS=-L%CMAKE_LIBRARY_PATH%
 set qtDir=%devDir%\Qt
 
 if exist "%qtDir%" (

Added: branches/avidemux_2.5_branch_gruntster/platforms/windows/build_scripts/x264/Perform Build.bat
===================================================================
--- branches/avidemux_2.5_branch_gruntster/platforms/windows/build_scripts/x264/Perform Build.bat	2009-02-14 21:08:55 UTC (rev 4589)
+++ branches/avidemux_2.5_branch_gruntster/platforms/windows/build_scripts/x264/Perform Build.bat	2009-02-15 13:15:22 UTC (rev 4590)
@@ -0,0 +1,28 @@
+ at echo off
+
+call "../Set Common Environment Variables"
+
+if errorlevel 1 goto error
+
+set PATH=%PATH%;%devDir%\Git\bin
+
+rm "%usrLocalDir%/include/x264.h"
+cd "%devDir%"
+
+rm -r -f x264
+
+echo Downloading from git
+git clone git://git.videolan.org/x264.git
+if errorlevel 1 goto end
+
+cd "%devDir%/x264"
+sh ./configure --prefix=/usr/local --enable-shared
+if errorlevel 1 goto end
+
+make install
+if errorlevel 1 goto end
+
+copy "%usrLocalDir%/bin/libx264-*.dll" "%devDir%\avidemux_2.5_build"
+
+:end
+pause
\ No newline at end of file



From mean at mail.berlios.de  Sun Feb 15 14:48:00 2009
From: mean at mail.berlios.de (mean at BerliOS)
Date: Sun, 15 Feb 2009 14:48:00 +0100
Subject: [Avidemux-svn-commit] r4591 - in branches/avidemux_2.6_branch_mean:
	avidemux/ADM_coreDemuxerMpeg/include
	avidemux/ADM_coreDemuxerMpeg/src plugins/ADM_demuxers/MpegPS
Message-ID: <200902151348.n1FDm0Ck019973@sheep.berlios.de>

Author: mean
Date: 2009-02-15 14:47:59 +0100 (Sun, 15 Feb 2009)
New Revision: 4591

Added:
   branches/avidemux_2.6_branch_mean/avidemux/ADM_coreDemuxerMpeg/include/dmxPacket.h
   branches/avidemux_2.6_branch_mean/avidemux/ADM_coreDemuxerMpeg/src/dmxPacket.cpp
Modified:
   branches/avidemux_2.6_branch_mean/avidemux/ADM_coreDemuxerMpeg/include/dmxPSPacket.h
   branches/avidemux_2.6_branch_mean/avidemux/ADM_coreDemuxerMpeg/src/CMakeLists.txt
   branches/avidemux_2.6_branch_mean/avidemux/ADM_coreDemuxerMpeg/src/dmxPSPacket.cpp
   branches/avidemux_2.6_branch_mean/plugins/ADM_demuxers/MpegPS/ADM_psIndex.cpp
Log:
[Mpeg] Begin to factorize code

Modified: branches/avidemux_2.6_branch_mean/avidemux/ADM_coreDemuxerMpeg/include/dmxPSPacket.h
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/ADM_coreDemuxerMpeg/include/dmxPSPacket.h	2009-02-15 13:15:22 UTC (rev 4590)
+++ branches/avidemux_2.6_branch_mean/avidemux/ADM_coreDemuxerMpeg/include/dmxPSPacket.h	2009-02-15 13:47:59 UTC (rev 4591)
@@ -6,42 +6,26 @@
 #ifndef DMXPSPACKET_H
 #define DMXPSPACKET_H
 
-#include "dmx_io.h"
+#include "dmxPacket.h"
 #include "ADM_Video.h"
 
-/**
-    \struct psPacketInfo
 
-*/
-typedef struct
-{
-    uint64_t pts;
-    uint64_t dts;
-    uint64_t startAt;
-    uint32_t offset;
 
-}psPacketInfo;
-
 /**
     \class psPacket
 */
-class psPacket
+class psPacket : public ADMMpegPacket
 {
 protected:
-    int         doNoComplainAnyMore;
-    fileParser  *_file;
-    uint64_t    _size;
-    uint8_t     getPacketInfo(uint8_t stream,uint8_t *substream,uint32_t *olen,uint64_t *opts,uint64_t *odts);
+    uint8_t             getPacketInfo(uint8_t stream,uint8_t *substream,uint32_t *olen,uint64_t *opts,uint64_t *odts);
 public:
-                psPacket(void);
-                ~psPacket();
-    bool        open(const char *filenames,bool dontappend);
-    bool        close(void);
+                        psPacket(void);
+    virtual            ~psPacket();
+    virtual bool        open(const char *filenames,bool dontappend);
+    virtual bool        close(void);
     virtual bool        getPacket(uint32_t maxSize, uint8_t *pid, uint32_t *packetSize,uint64_t *pts,uint64_t *dts,uint8_t *buffer,uint64_t *startAt);
-    virtual bool        getPacketOfType(uint8_t pid,uint32_t maxSize, uint32_t *packetSize,uint64_t *pts,uint64_t *dts,uint8_t *buffer,uint64_t *startAt);
-    uint64_t    getPos(void);
-    bool        setPos(uint64_t pos);
-    uint64_t    getSize(void) { return _file->getSize();}
+    virtual uint64_t    getPos(void);
+    virtual bool        setPos(uint64_t pos);
 };
 /**
     \class psPacketLinear
@@ -77,7 +61,7 @@
         bool    read(uint32_t len, uint8_t *buffer);
         bool    forward(uint32_t v);
         bool    stillOk(void) {return !eof;};
-        bool    getInfo(psPacketInfo *info);
+        bool    getInfo(dmxPacketInfo *info);
         bool    seek(uint64_t packetStart, uint32_t offset);
         bool    changePid(uint32_t pid) ;
 };

Added: branches/avidemux_2.6_branch_mean/avidemux/ADM_coreDemuxerMpeg/include/dmxPacket.h
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/ADM_coreDemuxerMpeg/include/dmxPacket.h	2009-02-15 13:15:22 UTC (rev 4590)
+++ branches/avidemux_2.6_branch_mean/avidemux/ADM_coreDemuxerMpeg/include/dmxPacket.h	2009-02-15 13:47:59 UTC (rev 4591)
@@ -0,0 +1,55 @@
+/**
+    \file dmxPacket.cpp
+
+*/
+
+#ifndef DMXPACKET_H
+#define DMXPACKET_H
+
+#include "dmx_io.h"
+
+/**
+    \struct dmxPacketInfo
+
+*/
+typedef struct
+{
+    uint64_t pts;
+    uint64_t dts;
+    uint64_t startAt;
+    uint32_t offset;
+
+}dmxPacketInfo;
+
+
+/**
+     \class ADMMpegPacket
+     \brief Base class for mpeg packet
+*/
+class ADMMpegPacket
+{
+protected:
+    int         doNoComplainAnyMore;
+    fileParser  *_file;
+    uint64_t    _size;
+
+
+public:
+                        ADMMpegPacket(void);
+    virtual             ~ADMMpegPacket();
+    virtual bool        open(const char *filenames,bool dontappend)=0;
+    virtual bool        close(void)=0;
+    virtual bool        getPacket(uint32_t maxSize, uint8_t *pid, uint32_t *packetSize,uint64_t *pts,uint64_t *dts,uint8_t *buffer,uint64_t *startAt)=0;
+    virtual bool        getPacketOfType(uint8_t pid,uint32_t maxSize, uint32_t *packetSize,uint64_t *pts,uint64_t *dts,uint8_t *buffer,uint64_t *startAt);
+    virtual uint64_t    getPos(void)=0;
+    virtual bool        setPos(uint64_t pos)=0;
+
+    uint64_t    getSize(void) { return _file->getSize();}
+
+
+};
+
+
+#endif
+//EOF
+

Modified: branches/avidemux_2.6_branch_mean/avidemux/ADM_coreDemuxerMpeg/src/CMakeLists.txt
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/ADM_coreDemuxerMpeg/src/CMakeLists.txt	2009-02-15 13:15:22 UTC (rev 4590)
+++ branches/avidemux_2.6_branch_mean/avidemux/ADM_coreDemuxerMpeg/src/CMakeLists.txt	2009-02-15 13:47:59 UTC (rev 4591)
@@ -6,6 +6,7 @@
 SET(ADMcoreDemuxerMpeg_SRCS
 ADM_indexFile.cpp
 dmx_io.cpp
+dmxPacket.cpp
 dmxPSPacket.cpp
 )	
 #*************************************************

Modified: branches/avidemux_2.6_branch_mean/avidemux/ADM_coreDemuxerMpeg/src/dmxPSPacket.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/ADM_coreDemuxerMpeg/src/dmxPSPacket.cpp	2009-02-15 13:15:22 UTC (rev 4590)
+++ branches/avidemux_2.6_branch_mean/avidemux/ADM_coreDemuxerMpeg/src/dmxPSPacket.cpp	2009-02-15 13:47:59 UTC (rev 4591)
@@ -23,10 +23,9 @@
     \fn psPacket
     \brief ctor
 */
-psPacket::psPacket(void)
+psPacket::psPacket(void) 
 {
-    doNoComplainAnyMore=0;
-    _file=NULL;
+
 }
 /**
     \fn psPacket
@@ -89,25 +88,6 @@
 }
 
 /**
-    \fn getPacketOfType
-    \brief Only returns packet of type pid
-*/      
-
-bool        psPacket::getPacketOfType(uint8_t pid,uint32_t maxSize, uint32_t *packetSize,uint64_t *pts,uint64_t *dts,uint8_t *buffer,uint64_t *startAt)
-{
-
-    bool xit=false;
-    uint8_t tmppid;
-    while(1)
-    {
-        if(true!=getPacket(maxSize,&tmppid,packetSize,pts,dts,buffer,startAt))
-                return false;
-        else
-                if(tmppid==pid) return true;
-    }
-    return false;
-}
-/**
     \fn getPacket
 */      
 bool        psPacket::getPacket(uint32_t maxSize, uint8_t *pid, uint32_t *packetSize,uint64_t *opts,uint64_t *odts,uint8_t *buffer,uint64_t *startAt)
@@ -531,7 +511,7 @@
             It is expected that the caller will do -4 to the index to get the start of the 
             startCode
 */
-bool    psPacketLinear::getInfo(psPacketInfo *info)
+bool    psPacketLinear::getInfo(dmxPacketInfo *info)
 {
     if(bufferIndex<4)
     {

Added: branches/avidemux_2.6_branch_mean/avidemux/ADM_coreDemuxerMpeg/src/dmxPacket.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/ADM_coreDemuxerMpeg/src/dmxPacket.cpp	2009-02-15 13:15:22 UTC (rev 4590)
+++ branches/avidemux_2.6_branch_mean/avidemux/ADM_coreDemuxerMpeg/src/dmxPacket.cpp	2009-02-15 13:47:59 UTC (rev 4591)
@@ -0,0 +1,60 @@
+/**
+    \file dmxPacket
+    \brief Packet demuxer for mpeg 
+    copyright            : (C) 2005-2009 by mean
+    email                : fixounet at free.fr
+        
+ ***************************************************************************/
+
+/***************************************************************************
+ *                                                                         *
+ *   This program is free software; you can redistribute it and/or modify  *
+ *   it under the terms of the GNU General Public License as published by  *
+ *   the Free Software Foundation; either version 2 of the License, or     *
+ *   (at your option) any later version.                                   *
+ *                                                                         *
+ ***************************************************************************/
+#include "ADM_default.h"
+
+#include "dmxPacket.h"
+
+/**
+    \fn ADMMpegPacket
+*/
+ADMMpegPacket::ADMMpegPacket(void)
+{
+     doNoComplainAnyMore=0;
+    _file=NULL;
+    _size=0;
+
+}
+/**
+    \fn ~ADMMpegPacket
+
+*/
+ADMMpegPacket::~ADMMpegPacket()
+{
+    if(_file) delete _file;
+    _file=NULL;
+}
+
+/**
+    \fn getPacketOfType
+    \brief Only returns packet of type pid
+*/      
+
+bool        ADMMpegPacket::getPacketOfType(uint8_t pid,uint32_t maxSize, uint32_t *packetSize,uint64_t *pts,uint64_t *dts,uint8_t *buffer,uint64_t *startAt)
+{
+
+    bool xit=false;
+    uint8_t tmppid;
+    while(1)
+    {
+        if(true!=getPacket(maxSize,&tmppid,packetSize,pts,dts,buffer,startAt))
+                return false;
+        else
+                if(tmppid==pid) return true;
+    }
+    return false;
+}
+//EOF
\ No newline at end of file

Modified: branches/avidemux_2.6_branch_mean/plugins/ADM_demuxers/MpegPS/ADM_psIndex.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/plugins/ADM_demuxers/MpegPS/ADM_psIndex.cpp	2009-02-15 13:15:22 UTC (rev 4590)
+++ branches/avidemux_2.6_branch_mean/plugins/ADM_demuxers/MpegPS/ADM_psIndex.cpp	2009-02-15 13:47:59 UTC (rev 4591)
@@ -96,7 +96,7 @@
         bool    writeVideo(PSVideo *video);
         bool    writeAudio(void);
         bool    writeSystem(const char *filename,bool append);
-        bool    Mark(indexerData *data,psPacketInfo *s,markType update);
+        bool    Mark(indexerData *data,dmxPacketInfo *s,markType update);
 
 };
 /**
@@ -146,7 +146,7 @@
 
 PSVideo video;
 indexerData  data;    
-psPacketInfo info;
+dmxPacketInfo info;
 
     memset(&data,0,sizeof(data));
     char indexName[strlen(file)+5];
@@ -293,7 +293,7 @@
     If the beginning is not a pic, but a gop start for example, we had to add/remove those.
 
 */
-bool  PsIndexer::Mark(indexerData *data,psPacketInfo *info,markType update)
+bool  PsIndexer::Mark(indexerData *data,dmxPacketInfo *info,markType update)
 {
     int offset=data->nextOffset;
     data->nextOffset=0;



From mean at mail.berlios.de  Sun Feb 15 14:48:05 2009
From: mean at mail.berlios.de (mean at BerliOS)
Date: Sun, 15 Feb 2009 14:48:05 +0100
Subject: [Avidemux-svn-commit] r4593 -
	branches/avidemux_2.6_branch_mean/avidemux/ADM_coreDemuxerMpeg/src
Message-ID: <200902151348.n1FDm5c3019993@sheep.berlios.de>

Author: mean
Date: 2009-02-15 14:48:05 +0100 (Sun, 15 Feb 2009)
New Revision: 4593

Modified:
   branches/avidemux_2.6_branch_mean/avidemux/ADM_coreDemuxerMpeg/src/dmxPSPacket.cpp
Log:
[psPacket] Fix error in forward

Modified: branches/avidemux_2.6_branch_mean/avidemux/ADM_coreDemuxerMpeg/src/dmxPSPacket.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/ADM_coreDemuxerMpeg/src/dmxPSPacket.cpp	2009-02-15 13:48:02 UTC (rev 4592)
+++ branches/avidemux_2.6_branch_mean/avidemux/ADM_coreDemuxerMpeg/src/dmxPSPacket.cpp	2009-02-15 13:48:05 UTC (rev 4593)
@@ -399,13 +399,19 @@
 */
 bool psPacketLinear::refill(void) 
 {
-// In case a startcade spawns across 2 packets
+// In case a startcode spawns across 2 packets
 // we have to keep track of the old one
         oldBufferDts=bufferDts;
         oldBufferPts=bufferPts;
         oldStartAt=startAt;
         oldBufferLen=bufferLen;
-        if( false== getPacketOfType(myPid,ADM_PACKET_LINEAR, &bufferLen,&bufferPts,&bufferDts,buffer,&startAt)) return false;
+        if( false== getPacketOfType(myPid,ADM_PACKET_LINEAR, &bufferLen,&bufferPts,&bufferDts,buffer,&startAt)) 
+        {
+            printf("[PsPacketLinear] Refill failed for pid :%x\n",myPid);
+            bufferIndex=bufferLen=0;
+            return false;
+        }
+        //printf("Refill : At :%"LLX" size :%"LD"\n",startAt,bufferLen);
         bufferIndex=0;
         return true;
 }
@@ -463,17 +469,22 @@
 */
 bool psPacketLinear::forward(uint32_t v)
 {
-    if(bufferIndex+v-1<bufferLen)
+next:
+ uint32_t delta=bufferLen-bufferIndex;
+    if(v>100*1000)
     {
+        ADM_assert(0);
+    }
+    if(v<=delta)
+    {
         bufferIndex+=v;
         consumed+=v;
         return true;
     }
+    // v>delta
+    v-=delta;
     if(!refill()) return false;
-    uint32_t delta=bufferLen-bufferIndex;
-    v-=delta;
-    consumed+=delta;
-    return forward(v);
+    goto next;
 }
 
 /**
@@ -541,7 +552,11 @@
         printf("[psPacket] Cannot seek to %"LLX"\n",packetStart);
         return 0;
     }
-    refill();
+    if(!refill())
+    {
+        printf("[PsPacketLinear] Seek to %"LLX":%"LX" failed\n",packetStart,offset);
+        return false;
+    }
     ADM_assert(offset<bufferLen);
     bufferIndex=offset;
     
@@ -573,7 +588,7 @@
 */
  psPacketLinearTracker::psPacketLinearTracker(uint8_t pid)  : psPacketLinear(pid)
 {
-   
+   resetStats();
 }
 /**
     \fn ~psPacketLinearTracker
@@ -581,7 +596,7 @@
 psPacketLinearTracker::~psPacketLinearTracker()
 {
 
-    resetStats();
+    
 }
 /**
         \fn getStat



From mean at mail.berlios.de  Sun Feb 15 14:48:02 2009
From: mean at mail.berlios.de (mean at BerliOS)
Date: Sun, 15 Feb 2009 14:48:02 +0100
Subject: [Avidemux-svn-commit] r4592 -
	branches/avidemux_2.6_branch_mean/plugins/ADM_demuxers/MpegPS
Message-ID: <200902151348.n1FDm2Ml019983@sheep.berlios.de>

Author: mean
Date: 2009-02-15 14:48:02 +0100 (Sun, 15 Feb 2009)
New Revision: 4592

Modified:
   branches/avidemux_2.6_branch_mean/plugins/ADM_demuxers/MpegPS/ADM_psAudioProbe.cpp
Log:
[psProbe] Correct lu/llu

Modified: branches/avidemux_2.6_branch_mean/plugins/ADM_demuxers/MpegPS/ADM_psAudioProbe.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/plugins/ADM_demuxers/MpegPS/ADM_psAudioProbe.cpp	2009-02-15 13:47:59 UTC (rev 4591)
+++ branches/avidemux_2.6_branch_mean/plugins/ADM_demuxers/MpegPS/ADM_psAudioProbe.cpp	2009-02-15 13:48:02 UTC (rev 4592)
@@ -68,10 +68,10 @@
     // Now synthetize
     for(int i=0x0;i<0xFF;i++)   
     {
-         packetStats *stat=packet->getStat(i);
+        packetStats *stat=packet->getStat(i);
         if(stat->count)
         {
-            printf("[PsProbeAudo] Pid:%x count:%d size:%d\n",i,stat->count,stat->size);
+            printf("[PsProbeAudo] Pid:%x count:%"LX" size:%"LD"\n",i,stat->count,stat->size);
         }
 
          if(stat->count>=PROBE_MIN_PACKET && stat->size>PROBE_MIN_SIZE)



From mean at mail.berlios.de  Sun Feb 15 14:48:06 2009
From: mean at mail.berlios.de (mean at BerliOS)
Date: Sun, 15 Feb 2009 14:48:06 +0100
Subject: [Avidemux-svn-commit] r4594 -
	branches/avidemux_2.6_branch_mean/avidemux/ADM_editor
Message-ID: <200902151348.n1FDm6ie020003@sheep.berlios.de>

Author: mean
Date: 2009-02-15 14:48:06 +0100 (Sun, 15 Feb 2009)
New Revision: 4594

Modified:
   branches/avidemux_2.6_branch_mean/avidemux/ADM_editor/ADMedAVIAUD.cpp
Log:
[Editor] update samples when putting filler audio block

Modified: branches/avidemux_2.6_branch_mean/avidemux/ADM_editor/ADMedAVIAUD.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/ADM_editor/ADMedAVIAUD.cpp	2009-02-15 13:48:05 UTC (rev 4593)
+++ branches/avidemux_2.6_branch_mean/avidemux/ADM_editor/ADMedAVIAUD.cpp	2009-02-15 13:48:06 UTC (rev 4594)
@@ -134,6 +134,7 @@
 
                 advanceDtsBySample(fillerSample);
                 dest+=fillerSample*trk->wavheader.channels;
+                *samples=fillerSample;
                 vprintf("[Composer::getPCMPacket] Adding %u padding samples, dts is now %lu\n",fillerSample,lastDts);
                 return true;
        }



From mean at mail.berlios.de  Sun Feb 15 14:48:08 2009
From: mean at mail.berlios.de (mean at BerliOS)
Date: Sun, 15 Feb 2009 14:48:08 +0100
Subject: [Avidemux-svn-commit] r4595 -
	branches/avidemux_2.6_branch_mean/plugins/ADM_demuxers/MpegPS
Message-ID: <200902151348.n1FDm80E020013@sheep.berlios.de>

Author: mean
Date: 2009-02-15 14:48:08 +0100 (Sun, 15 Feb 2009)
New Revision: 4595

Modified:
   branches/avidemux_2.6_branch_mean/plugins/ADM_demuxers/MpegPS/ADM_psReadIndex.cpp
Log:
[Editor] Handle Mpeg is PTS only (such as TS->PS done by ffmpeg)

Modified: branches/avidemux_2.6_branch_mean/plugins/ADM_demuxers/MpegPS/ADM_psReadIndex.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/plugins/ADM_demuxers/MpegPS/ADM_psReadIndex.cpp	2009-02-15 13:48:06 UTC (rev 4594)
+++ branches/avidemux_2.6_branch_mean/plugins/ADM_demuxers/MpegPS/ADM_psReadIndex.cpp	2009-02-15 13:48:08 UTC (rev 4595)
@@ -205,8 +205,29 @@
         // Make sure everyone starts at 0
         // Search first timestamp (audio/video)
 
+        switch( _videostream.dwRate)
+        {
+            case 25000:   dtsIncrement=40000;break;
+            case 23976:   dtsIncrement=41708;break;
+            case 29970:   dtsIncrement=33367;break;
+            default : dtsIncrement=1;
+                    printf("[psDemux] Fps not handled for DTS increment\n");
 
+        }
         uint64_t startDts=ListOfFrames[0]->dts;
+        uint64_t startPts=ListOfFrames[0]->pts;
+        // Special case when we dont have DTS but only PTS
+        if(startDts==ADM_NO_PTS) // Do we have DTS ?
+        {
+            if(startPts!=ADM_NO_PTS)
+            {
+                if(startPts>=2*dtsIncrement)
+                {
+                    startDts=startPts-2*dtsIncrement;
+                } else startDts=0;
+                ListOfFrames[0]->dts=startDts;
+            }
+        }
         for(int i=0;i<listOfAudioTracks.size();i++)
         {
             uint64_t a=listOfAudioTracks[i]->access->seekPoints[0].dts;
@@ -230,33 +251,30 @@
 
         // Now fill in the missing timestamp and convert to us
         // for video
-
-        switch( _videostream.dwRate)
-        {
-            case 25000:   dtsIncrement=40000;break;
-            case 23976:   dtsIncrement=41708;break;
-            case 29970:   dtsIncrement=33367;break;
-            default : dtsIncrement=1;
-                    printf("[psDemux] Fps not handled for DTS increment\n");
-
-        }
+        // We are sure to have both PTS & DTS for 1st image
+        // Guess missing DTS/PTS for video
         for(int i=0;i<ListOfFrames.size();i++)
         {
             dmxFrame *frame=ListOfFrames[i];
+            printf("[psUpdate] raw DTS: %"LLU" PTS:%"LLU"\n",frame->dts,frame->pts);
             if(frame->pts==ADM_NO_PTS || frame->dts==ADM_NO_PTS)
             {
                 lastDts+=dtsIncrement;
                 lastPts+=dtsIncrement;
                 frame->dts=lastDts;
+                // If we have PTS keep it...
+                if(frame->pts!=ADM_NO_PTS)
+                    frame->pts=timeConvert(frame->pts);
                 //frame->pts=lastPts; // THIS IS WRONG NEED REORDERING
 
-            }else      
+            }else    // We got both, use them  
             {
+                
                 frame->dts=lastDts=timeConvert(frame->dts);
                 frame->pts=lastPts=timeConvert(frame->pts);
             }
         }
-        // convert to us for Audio tracks
+        // convert to us for Audio tracks (seek points)
         for(int i=0;i<listOfAudioTracks.size();i++)
         {
             ADM_psTrackDescriptor *track=listOfAudioTracks[i];
@@ -268,6 +286,18 @@
                     access->seekPoints[j].dts=access->timeConvert( access->seekPoints[j].dts);
             }
         }
+#if 1
+        for(int i=0;i<ListOfFrames.size();i++)
+        {
+            dmxFrame *frame=ListOfFrames[i];
+            int64_t pts,dts;
+            pts=frame->pts;
+            dts=frame->dts;
+            if(pts!=ADM_NO_PTS) pts/=1000;
+            if(dts!=ADM_NO_PTS) dts/=1000;
+            printf("[psVideo] Framex %d PTS:%"LLD" ms DTS:%"LLD" ms\n",i,pts,dts);
+        }
+#endif
         return 1;
                     
 }



From mean at mail.berlios.de  Sun Feb 15 14:48:10 2009
From: mean at mail.berlios.de (mean at BerliOS)
Date: Sun, 15 Feb 2009 14:48:10 +0100
Subject: [Avidemux-svn-commit] r4596 -
	branches/avidemux_2.6_branch_mean/avidemux/ADM_codecs
Message-ID: <200902151348.n1FDmAdl020025@sheep.berlios.de>

Author: mean
Date: 2009-02-15 14:48:10 +0100 (Sun, 15 Feb 2009)
New Revision: 4596

Modified:
   branches/avidemux_2.6_branch_mean/avidemux/ADM_codecs/ADM_ffmp43.cpp
Log:
[Codec] use reordered opaque (cleaner)

Modified: branches/avidemux_2.6_branch_mean/avidemux/ADM_codecs/ADM_ffmp43.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/ADM_codecs/ADM_ffmp43.cpp	2009-02-15 13:48:08 UTC (rev 4595)
+++ branches/avidemux_2.6_branch_mean/avidemux/ADM_codecs/ADM_ffmp43.cpp	2009-02-15 13:48:10 UTC (rev 4596)
@@ -106,8 +106,9 @@
       out->_qSize = out->_qStride = 0;
       out->quant = NULL;
     }
-//    printf("[LAVC] Old pts :%"LLD" new pts :%"LLD"\n",out->Pts, (uint64_t)(src->opaque));
-    out->Pts= (uint64_t)(src->opaque);
+    //printf("[LAVC] Old pts :%"LLD" new pts :%"LLD"\n",out->Pts, (uint64_t)(src->reordered_opaque));
+    //printf("[LAVC] pts: %"LLU"\n",src->pts);
+    out->Pts= (uint64_t)(src->reordered_opaque);
     return 1;
 }
 /**
@@ -354,13 +355,14 @@
     }
    // Put a safe value....
    out->Pts=in->demuxerPts;
-  _frame.opaque=(void *)out->Pts;
-  
+    _context->reordered_opaque=in->demuxerPts;
+  //_frame.opaque=(void *)out->Pts;
+  //printf("Incoming Pts :%"LLD"\n",out->Pts);
   ret = avcodec_decode_video (_context, &_frame, &got_picture, in->data, in->dataLength);
   if(!bFramePossible())
   {
     // No delay, the value is sure, no need to hide it in opaque
-    _frame.opaque=(void *)in->demuxerPts;
+    _context->reordered_opaque=(int64_t)in->demuxerPts;
   }
   out->_qStride = 0;		//Default = no quant
   if (0 > ret && !_context->hurry_up)



From mean at mail.berlios.de  Sun Feb 15 14:48:11 2009
From: mean at mail.berlios.de (mean at BerliOS)
Date: Sun, 15 Feb 2009 14:48:11 +0100
Subject: [Avidemux-svn-commit] r4597 -
	branches/avidemux_2.6_branch_mean/plugins/ADM_demuxers/MpegPS
Message-ID: <200902151348.n1FDmBws020035@sheep.berlios.de>

Author: mean
Date: 2009-02-15 14:48:11 +0100 (Sun, 15 Feb 2009)
New Revision: 4597

Added:
   branches/avidemux_2.6_branch_mean/plugins/ADM_demuxers/MpegPS/ADM_psComputeTimeStamp.cpp
Log:
[psRead] Warn if DTS goes backward, compute missing pts/dts

Added: branches/avidemux_2.6_branch_mean/plugins/ADM_demuxers/MpegPS/ADM_psComputeTimeStamp.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/plugins/ADM_demuxers/MpegPS/ADM_psComputeTimeStamp.cpp	2009-02-15 13:48:10 UTC (rev 4596)
+++ branches/avidemux_2.6_branch_mean/plugins/ADM_demuxers/MpegPS/ADM_psComputeTimeStamp.cpp	2009-02-15 13:48:11 UTC (rev 4597)
@@ -0,0 +1,179 @@
+/**
+    \fn ComputeTimeStamp
+    \brief Compute and fill the missing PTS/DTS
+
+*/
+
+#include "ADM_default.h"
+#include "fourcc.h"
+#include "DIA_coreToolkit.h"
+#include "ADM_indexFile.h"
+#include "ADM_ps.h"
+
+#include <math.h>
+
+#define DMX_RECOMPUTE_PTS_DTS_MAX 20
+
+#if 1
+#define aprintf(...) {}
+#else
+#define aprintf printf
+#endif
+/**
+        \fn updatePtsDts
+        \brief Update the PTS/DTS
+
+TODO / FIXME : Handle wrap
+TODO / FIXME : Handle PTS reordering 
+*/
+
+bool psHeader::updatePtsDts(void)
+{
+        uint64_t lastDts=0,lastPts=0,dtsIncrement=0;
+
+
+        // For audio, The first packet in the seekpoints happens a bit after the action
+        // It means some audio may have been seen since we locked on video.
+        // So we compute the DTS of the first real packet
+        // by using the size field and byterate and arbitrarily make it begins
+        // at video
+        for(int i=0;i<listOfAudioTracks.size();i++)
+        {
+            vector          <ADM_psAudioSeekPoint > *seekPoints=&(listOfAudioTracks[i]->access->seekPoints);
+            uint64_t secondDts=(*seekPoints)[0].dts;
+            uint64_t secondSize=(*seekPoints)[0].size;
+            if(secondSize && listOfAudioTracks[i]->header.byterate)
+            {
+                    // it is actually an offset in time to the 2nd packet Dts
+                double  firstFloatDts=secondSize*1000*1000.; 
+                        firstFloatDts/=listOfAudioTracks[i]->header.byterate; // in us
+                uint64_t firstDts=(uint64_t)firstFloatDts;
+
+                        if(firstDts>secondDts) firstDts=0;
+                            else firstDts=secondDts-firstDts;
+
+                // Now add our seek point
+                ADM_psAudioSeekPoint sk;
+                sk.dts=firstDts;
+                sk.size=0;
+                sk.position=ListOfFrames[0]->startAt;
+                (*seekPoints).insert( (*seekPoints).begin(),sk);
+
+            }
+        }
+
+
+        // Make sure everyone starts at 0
+        // Search first timestamp (audio/video)
+
+        switch( _videostream.dwRate)
+        {
+            case 25000:   dtsIncrement=40000;break;
+            case 23976:   dtsIncrement=41708;break;
+            case 29970:   dtsIncrement=33367;break;
+            default : dtsIncrement=1;
+                    printf("[psDemux] Fps not handled for DTS increment\n");
+
+        }
+        uint64_t startDts=ListOfFrames[0]->dts;
+        uint64_t startPts=ListOfFrames[0]->pts;
+        // Special case when we dont have DTS but only PTS
+        if(startDts==ADM_NO_PTS) // Do we have DTS ?
+        {
+            if(startPts!=ADM_NO_PTS)
+            {
+                if(startPts>=2*dtsIncrement)
+                {
+                    startDts=startPts-2*dtsIncrement;
+                } else startDts=0;
+                ListOfFrames[0]->dts=startDts;
+            }
+        }
+        for(int i=0;i<listOfAudioTracks.size();i++)
+        {
+            uint64_t a=listOfAudioTracks[i]->access->seekPoints[0].dts;
+            if(a<startDts) startDts=a;
+        }
+        // Rescale all so that it starts ~ 0
+        // Video..
+        for(int i=0;i<ListOfFrames.size();i++)
+        {
+            dmxFrame *f=ListOfFrames[i];
+            if(f->pts!=ADM_NO_PTS) f->pts-=startDts;
+            if(f->dts!=ADM_NO_PTS) f->dts-=startDts;
+        }
+        // Audio start at 0 too
+        for(int i=0;i<listOfAudioTracks.size();i++)
+        {
+            ADM_psTrackDescriptor *track=listOfAudioTracks[i];
+            ADM_psAccess    *access=track->access;
+            access->setTimeOffset(startDts);
+        }
+
+        // Now fill in the missing timestamp and convert to us
+        // for video
+        // We are sure to have both PTS & DTS for 1st image
+        // Guess missing DTS/PTS for video
+        int noUpdate=0;
+        for(int i=0;i<ListOfFrames.size();i++)
+        {
+            dmxFrame *frame=ListOfFrames[i];
+            aprintf("[psUpdate] frame:%d raw DTS: %"LLD" PTS:%"LLD"\n",i,frame->dts,frame->pts);
+            if(frame->pts==ADM_NO_PTS || frame->dts==ADM_NO_PTS)
+            {
+                noUpdate++;
+                // We have PTS or DTS and it has been a long time we did not have both
+                if(noUpdate>DMX_RECOMPUTE_PTS_DTS_MAX && frame->type==1 && (frame->pts!=ADM_NO_PTS || frame->dts!=ADM_NO_PTS))
+                {
+                    if(frame->pts!=ADM_NO_PTS)
+                    {
+                        frame->dts=frame->pts-2*dtsIncrement;
+                    }else   
+                    {
+                        frame->pts=frame->dts+2*dtsIncrement;
+                    }
+                    if(frame->dts<lastDts) printf("[psRead] Warning DTS going backward old:%"LLD" new:%"LLD" delta=%"LLD"\n",
+                                                                                            lastDts/1000,frame->dts/1000,(lastDts-frame->dts)/1000);
+                    frame->dts=lastDts=timeConvert(frame->dts);
+                    frame->pts=lastPts=timeConvert(frame->pts);
+                }else
+                {
+                    lastDts+=dtsIncrement;
+                    lastPts+=dtsIncrement;
+                    frame->dts=lastDts;
+                    frame->pts=ADM_NO_PTS;
+                }
+            }else    // We got both, use them  
+            {
+                
+                frame->dts=lastDts=timeConvert(frame->dts);
+                frame->pts=lastPts=timeConvert(frame->pts);
+            }
+        }
+        // convert to us for Audio tracks (seek points)
+        for(int i=0;i<listOfAudioTracks.size();i++)
+        {
+            ADM_psTrackDescriptor *track=listOfAudioTracks[i];
+            ADM_psAccess    *access=track->access;
+            
+            for(int j=0;j<access->seekPoints.size();j++)
+            {
+                if( access->seekPoints[j].dts!=ADM_NO_PTS) 
+                    access->seekPoints[j].dts=access->timeConvert( access->seekPoints[j].dts);
+            }
+        }
+#if 0
+        for(int i=0;i<ListOfFrames.size();i++)
+        {
+            dmxFrame *frame=ListOfFrames[i];
+            int64_t pts,dts;
+            pts=frame->pts;
+            dts=frame->dts;
+            if(pts!=ADM_NO_PTS) pts/=1000;
+            if(dts!=ADM_NO_PTS) dts/=1000;
+            printf("[psVideo] Framex %d PTS:%"LLD" ms DTS:%"LLD" ms, delta %"LLD" ms\n",i,pts,dts,pts-dts);
+        }
+#endif
+        return 1;
+                    
+}



From mean at mail.berlios.de  Sun Feb 15 14:48:14 2009
From: mean at mail.berlios.de (mean at BerliOS)
Date: Sun, 15 Feb 2009 14:48:14 +0100
Subject: [Avidemux-svn-commit] r4599 -
	branches/avidemux_2.6_branch_mean/avidemux/ADM_editor
Message-ID: <200902151348.n1FDmEws020057@sheep.berlios.de>

Author: mean
Date: 2009-02-15 14:48:14 +0100 (Sun, 15 Feb 2009)
New Revision: 4599

Modified:
   branches/avidemux_2.6_branch_mean/avidemux/ADM_editor/ADM_edCache.cpp
Log:
[edCache] debug statement

Modified: branches/avidemux_2.6_branch_mean/avidemux/ADM_editor/ADM_edCache.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/ADM_editor/ADM_edCache.cpp	2009-02-15 13:48:13 UTC (rev 4598)
+++ branches/avidemux_2.6_branch_mean/avidemux/ADM_editor/ADM_edCache.cpp	2009-02-15 13:48:14 UTC (rev 4599)
@@ -16,7 +16,11 @@
 #define MODULE_NAME MODULE_EDITOR
 #include "ADM_osSupport/ADM_debug.h"
 #undef aprintf
+#if 1
 #define aprintf(...) {}
+#else
+#define aprintf printf
+#endif
 /**
     \fn EditorCache
     \brief Constructor
@@ -83,9 +87,12 @@
     {
         if(_elem[i].frameNum==ADM_INVALID_CACHE);
         found=i;
+        aprintf("[edCache] Buffer %d free\n",found);
     }
     // Then the older one/LRU
     if(found==-1)
+    {
+        aprintf("[edCache] looking for older cache entry\n");
         for(int i=0;i<_nbImage;i++)
         {
             delta=abs((int)(_counter-_elem[i].lastUse));
@@ -93,9 +100,10 @@
             {
                 min=delta;
                 found=i;
-
+                
             }
         }
+    }
     if(found==-1) ADM_assert("Could not get a free image\n");
 	_elem[found].lastUse=_counter+1;;
 	_elem[found].frameNum=ADM_IN_USE_CACHE;
@@ -110,7 +118,8 @@
 */
  void        EditorCache::flush(void)
 {
- for(int i=0;i<_nbImage;i++)
+    aprintf("[edCache] Flush\n");
+    for(int i=0;i<_nbImage;i++)
     {
         _elem[i].frameNum==ADM_INVALID_CACHE;
     }
@@ -121,13 +130,14 @@
 */
 void        EditorCache::invalidate(ADMImage *image)
 {
-   // First search for a really free image
+   
     for(int i=0;i<_nbImage;i++)
     {
         if(_elem[i].image==image);
             {
                    _elem[i].lastUse=ADM_INVALID_CACHE;;
                    _elem[i].frameNum=ADM_INVALID_CACHE;
+                    aprintf("[edCache] Invalidating %d\n",i);
                   return;
             }
     }
@@ -147,6 +157,7 @@
 			ADM_assert(_elem[i].frameNum==ADM_IN_USE_CACHE);
 			_elem[i].frameNum=frameno;
 			_elem[i].lastUse=_counter;
+            aprintf("[edCache] Updatding %d with framenum %"LU"\n",i,frameno);
 			_counter++;
 			return 1;
 
@@ -156,11 +167,23 @@
 	ADM_assert(0);
 
 }
+/**
+    \fn dump
+    \brief dump the content of cache in a human readable way (sort of)
+*/
 void EditorCache::dump( void)
 {
 	for(int i=0;i<_nbImage;i++)
 	{
-		aprintf("Edcache content:%d %lu\n",i,_elem[i].frameNum);
+        cacheElem *e=&(_elem[i]);
+        switch(e->frameNum)
+        {
+            case ADM_IN_USE_CACHE:  printf("Edcache content[%d] In use\n",i);break;
+            case ADM_INVALID_CACHE: printf("Edcache content[%d] Free\n",i);break;
+            default:
+                printf("Edcache content[%d]: Num:%"LU" PTS : %"LLU" us%"LLU" ms\n",i,e->frameNum,
+                                                                    e->image->Pts,e->image->Pts/1000);
+        }
 	}
 }
 /**



From mean at mail.berlios.de  Sun Feb 15 14:48:13 2009
From: mean at mail.berlios.de (mean at BerliOS)
Date: Sun, 15 Feb 2009 14:48:13 +0100
Subject: [Avidemux-svn-commit] r4598 -
	branches/avidemux_2.6_branch_mean/plugins/ADM_demuxers/MpegPS
Message-ID: <200902151348.n1FDmDnb020047@sheep.berlios.de>

Author: mean
Date: 2009-02-15 14:48:13 +0100 (Sun, 15 Feb 2009)
New Revision: 4598

Modified:
   branches/avidemux_2.6_branch_mean/plugins/ADM_demuxers/MpegPS/ADM_psReadIndex.cpp
   branches/avidemux_2.6_branch_mean/plugins/ADM_demuxers/MpegPS/CMakeLists.txt
Log:
[psRead] Move update pts/dts to its own file

Modified: branches/avidemux_2.6_branch_mean/plugins/ADM_demuxers/MpegPS/ADM_psReadIndex.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/plugins/ADM_demuxers/MpegPS/ADM_psReadIndex.cpp	2009-02-15 13:48:11 UTC (rev 4597)
+++ branches/avidemux_2.6_branch_mean/plugins/ADM_demuxers/MpegPS/ADM_psReadIndex.cpp	2009-02-15 13:48:13 UTC (rev 4598)
@@ -159,148 +159,7 @@
 
         return true;
 }
-/**
-        \fn updatePtsDts
-        \brief Update the PTS/DTS
 
-TODO / FIXME : Handle wrap
-TODO / FIXME : Handle PTS reordering 
-*/
-bool psHeader::updatePtsDts(void)
-{
-        uint64_t lastDts=0,lastPts=0,dtsIncrement=0;
-
-
-        // For audio, The first packet in the seekpoints happens a bit after the action
-        // It means some audio may have been seen since we locked on video.
-        // So we compute the DTS of the first real packet
-        // by using the size field and byterate and arbitrarily make it begins
-        // at video
-        for(int i=0;i<listOfAudioTracks.size();i++)
-        {
-            vector          <ADM_psAudioSeekPoint > *seekPoints=&(listOfAudioTracks[i]->access->seekPoints);
-            uint64_t secondDts=(*seekPoints)[0].dts;
-            uint64_t secondSize=(*seekPoints)[0].size;
-            if(secondSize && listOfAudioTracks[i]->header.byterate)
-            {
-                    // it is actually an offset in time to the 2nd packet Dts
-                double  firstFloatDts=secondSize*1000*1000.; 
-                        firstFloatDts/=listOfAudioTracks[i]->header.byterate; // in us
-                uint64_t firstDts=(uint64_t)firstFloatDts;
-
-                        if(firstDts>secondDts) firstDts=0;
-                            else firstDts=secondDts-firstDts;
-
-                // Now add our seek point
-                ADM_psAudioSeekPoint sk;
-                sk.dts=firstDts;
-                sk.size=0;
-                sk.position=ListOfFrames[0]->startAt;
-                (*seekPoints).insert( (*seekPoints).begin(),sk);
-
-            }
-        }
-
-
-        // Make sure everyone starts at 0
-        // Search first timestamp (audio/video)
-
-        switch( _videostream.dwRate)
-        {
-            case 25000:   dtsIncrement=40000;break;
-            case 23976:   dtsIncrement=41708;break;
-            case 29970:   dtsIncrement=33367;break;
-            default : dtsIncrement=1;
-                    printf("[psDemux] Fps not handled for DTS increment\n");
-
-        }
-        uint64_t startDts=ListOfFrames[0]->dts;
-        uint64_t startPts=ListOfFrames[0]->pts;
-        // Special case when we dont have DTS but only PTS
-        if(startDts==ADM_NO_PTS) // Do we have DTS ?
-        {
-            if(startPts!=ADM_NO_PTS)
-            {
-                if(startPts>=2*dtsIncrement)
-                {
-                    startDts=startPts-2*dtsIncrement;
-                } else startDts=0;
-                ListOfFrames[0]->dts=startDts;
-            }
-        }
-        for(int i=0;i<listOfAudioTracks.size();i++)
-        {
-            uint64_t a=listOfAudioTracks[i]->access->seekPoints[0].dts;
-            if(a<startDts) startDts=a;
-        }
-        // Rescale all so that it starts ~ 0
-        // Video..
-        for(int i=0;i<ListOfFrames.size();i++)
-        {
-            dmxFrame *f=ListOfFrames[i];
-            if(f->pts!=ADM_NO_PTS) f->pts-=startDts;
-            if(f->dts!=ADM_NO_PTS) f->dts-=startDts;
-        }
-        // Audio start at 0 too
-        for(int i=0;i<listOfAudioTracks.size();i++)
-        {
-            ADM_psTrackDescriptor *track=listOfAudioTracks[i];
-            ADM_psAccess    *access=track->access;
-            access->setTimeOffset(startDts);
-        }
-
-        // Now fill in the missing timestamp and convert to us
-        // for video
-        // We are sure to have both PTS & DTS for 1st image
-        // Guess missing DTS/PTS for video
-        for(int i=0;i<ListOfFrames.size();i++)
-        {
-            dmxFrame *frame=ListOfFrames[i];
-            printf("[psUpdate] raw DTS: %"LLU" PTS:%"LLU"\n",frame->dts,frame->pts);
-            if(frame->pts==ADM_NO_PTS || frame->dts==ADM_NO_PTS)
-            {
-                lastDts+=dtsIncrement;
-                lastPts+=dtsIncrement;
-                frame->dts=lastDts;
-                // If we have PTS keep it...
-                if(frame->pts!=ADM_NO_PTS)
-                    frame->pts=timeConvert(frame->pts);
-                //frame->pts=lastPts; // THIS IS WRONG NEED REORDERING
-
-            }else    // We got both, use them  
-            {
-                
-                frame->dts=lastDts=timeConvert(frame->dts);
-                frame->pts=lastPts=timeConvert(frame->pts);
-            }
-        }
-        // convert to us for Audio tracks (seek points)
-        for(int i=0;i<listOfAudioTracks.size();i++)
-        {
-            ADM_psTrackDescriptor *track=listOfAudioTracks[i];
-            ADM_psAccess    *access=track->access;
-            
-            for(int j=0;j<access->seekPoints.size();j++)
-            {
-                if( access->seekPoints[j].dts!=ADM_NO_PTS) 
-                    access->seekPoints[j].dts=access->timeConvert( access->seekPoints[j].dts);
-            }
-        }
-#if 1
-        for(int i=0;i<ListOfFrames.size();i++)
-        {
-            dmxFrame *frame=ListOfFrames[i];
-            int64_t pts,dts;
-            pts=frame->pts;
-            dts=frame->dts;
-            if(pts!=ADM_NO_PTS) pts/=1000;
-            if(dts!=ADM_NO_PTS) dts/=1000;
-            printf("[psVideo] Framex %d PTS:%"LLD" ms DTS:%"LLD" ms\n",i,pts,dts);
-        }
-#endif
-        return 1;
-                    
-}
 /**
         \fn readVideo
         \brief Read the [video] section of the index file

Modified: branches/avidemux_2.6_branch_mean/plugins/ADM_demuxers/MpegPS/CMakeLists.txt
===================================================================
--- branches/avidemux_2.6_branch_mean/plugins/ADM_demuxers/MpegPS/CMakeLists.txt	2009-02-15 13:48:11 UTC (rev 4597)
+++ branches/avidemux_2.6_branch_mean/plugins/ADM_demuxers/MpegPS/CMakeLists.txt	2009-02-15 13:48:13 UTC (rev 4598)
@@ -7,6 +7,7 @@
 	ADM_psAudio.cpp
 	ADM_psAudioProbe.cpp
 	ADM_psAudioProbe.h
+        ADM_psComputeTimeStamp.cpp
 )
 
 ADD_LIBRARY(ADM_dm_ps SHARED ${ADM_ps_SRCS})



From mean at mail.berlios.de  Sun Feb 15 14:48:16 2009
From: mean at mail.berlios.de (mean at BerliOS)
Date: Sun, 15 Feb 2009 14:48:16 +0100
Subject: [Avidemux-svn-commit] r4600 -
	branches/avidemux_2.6_branch_mean/avidemux/ADM_editor
Message-ID: <200902151348.n1FDmG2b020068@sheep.berlios.de>

Author: mean
Date: 2009-02-15 14:48:16 +0100 (Sun, 15 Feb 2009)
New Revision: 4600

Modified:
   branches/avidemux_2.6_branch_mean/avidemux/ADM_editor/ADM_edRender.cpp
Log:
[edRender] search deeper, print more infos

Modified: branches/avidemux_2.6_branch_mean/avidemux/ADM_editor/ADM_edRender.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/ADM_editor/ADM_edRender.cpp	2009-02-15 13:48:14 UTC (rev 4599)
+++ branches/avidemux_2.6_branch_mean/avidemux/ADM_editor/ADM_edRender.cpp	2009-02-15 13:48:16 UTC (rev 4600)
@@ -221,9 +221,9 @@
   ADMImage	*result;
   _VIDEOS *vid=&_videos[ref];
 
-   uint32_t loop=3;
+   uint32_t loop=20; // Try 20 frames ahead
 
-	// Try decoding 3 frames ahead, if not we can consider it fails
+	// Try decoding loop? rames ahead, if not we can consider it fails
     while(loop--)
     {
         // first decode a picture, cannot hurt...
@@ -244,9 +244,15 @@
                 currentFrame++;
             }
             return true;
+        }else   
+        {
+            printf("[getNextPic] Loop:%d, looking for pts :%"LLU"\n",loop,vid->lastReadPts/1000);
+            cache->dump();
         }
     }
     printf("[ADM_Composer::getPicture] Failed\n");
+    printf("[ADM_composer] while looking for %"LLU" us, %"LLU" ms\n",vid->lastReadPts,vid->lastReadPts/1000);
+    cache->dump();
     return false;
 }
 
@@ -308,7 +314,10 @@
         result->Pts=vid->lastDecodedPts;
     }else
         vid->lastDecodedPts=pts;
-
+    printf("Decoded frame %"LU" with pts=%"LLD" us, %"LLD" ms\n",
+            frame,
+            vid->lastDecodedPts,
+            vid->lastDecodedPts/1000);
     return true;
 }
 /**
@@ -542,7 +551,12 @@
   ADMImage	*result;
 
 //    static uint32_t lastlen=0;
-
+    printf("[getUncompressedFrame] *************** OBSOLETE FUNCTION CALLED **********************\n");
+    printf("[getUncompressedFrame] *************** OBSOLETE FUNCTION CALLED **********************\n");
+    printf("[getUncompressedFrame] *************** OBSOLETE FUNCTION CALLED **********************\n");
+    printf("[getUncompressedFrame] *************** OBSOLETE FUNCTION CALLED **********************\n");
+    printf("[getUncompressedFrame] *************** OBSOLETE FUNCTION CALLED **********************\n");
+    printf("[getUncompressedFrame] *************** OBSOLETE FUNCTION CALLED **********************\n");
 	if(flagz)
 			*flagz=0;
 
@@ -581,8 +595,6 @@
 //	Prepare the destination...
 	result=cache->getFreeImage();
 
-
-
 	cache->dump();
   // now we got segment and frame
   //*************************
@@ -590,19 +602,20 @@
   //*************************
   _videos[ref]._aviheader->getFlags (relframe, &flags);
 
-     if (flags & AVI_KEY_FRAME)
+    if (flags & AVI_KEY_FRAME)
     {
-    	aprintf("keyframe\n");     	if(!decodeCache(relframe,ref, result))
+    	aprintf("keyframe\n");     	
+        if(!decodeCache(relframe,ref, result))
 		{
-			printf("Editor: Cannot key frame %"LU"\n",relframe);
+			printf("[edRender]Editor: Cannot deccode keyframe %"LU"\n",relframe);
 			return 0;
 		}
-	  _lastseg = seg;
-	  _lastframe = relframe;
-	  if(flagz)
-	  	*flagz=result->flags;
-	  out->duplicate(result);
-	  return (1);
+        _lastseg = seg;
+        _lastframe = relframe;
+        if(flagz)
+            *flagz=result->flags;
+        out->duplicate(result);
+        return (1);
     }
 
     //*************************



From mean at mail.berlios.de  Sun Feb 15 14:48:17 2009
From: mean at mail.berlios.de (mean at BerliOS)
Date: Sun, 15 Feb 2009 14:48:17 +0100
Subject: [Avidemux-svn-commit] r4601 -
	branches/avidemux_2.6_branch_mean/avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui
Message-ID: <200902151348.n1FDmHnm020078@sheep.berlios.de>

Author: mean
Date: 2009-02-15 14:48:17 +0100 (Sun, 15 Feb 2009)
New Revision: 4601

Modified:
   branches/avidemux_2.6_branch_mean/avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/T_preview.cpp
Log:
[QT4/SDL] ugly crash fix

Modified: branches/avidemux_2.6_branch_mean/avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/T_preview.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/T_preview.cpp	2009-02-15 13:48:16 UTC (rev 4600)
+++ branches/avidemux_2.6_branch_mean/avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/T_preview.cpp	2009-02-15 13:48:17 UTC (rev 4601)
@@ -175,7 +175,8 @@
 #else
     const QX11Info &info=videoWindow->x11Info();
     xinfo->display=info.display();
-    xinfo->window=videoWindow->winId();
+   // xinfo->window=videoWindow->winId();
+    xinfo->window=videoWindow->window()->winId();
 #endif
 
 	xinfo->x = widget->x();



From mean at mail.berlios.de  Sun Feb 15 14:48:19 2009
From: mean at mail.berlios.de (mean at BerliOS)
Date: Sun, 15 Feb 2009 14:48:19 +0100
Subject: [Avidemux-svn-commit] r4602 -
	branches/avidemux_2.6_branch_mean/plugins/ADM_demuxers/MpegPS
Message-ID: <200902151348.n1FDmJtd020088@sheep.berlios.de>

Author: mean
Date: 2009-02-15 14:48:19 +0100 (Sun, 15 Feb 2009)
New Revision: 4602

Modified:
   branches/avidemux_2.6_branch_mean/plugins/ADM_demuxers/MpegPS/ADM_psComputeTimeStamp.cpp
Log:
[psRead) proper detect backward PTS

Modified: branches/avidemux_2.6_branch_mean/plugins/ADM_demuxers/MpegPS/ADM_psComputeTimeStamp.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/plugins/ADM_demuxers/MpegPS/ADM_psComputeTimeStamp.cpp	2009-02-15 13:48:17 UTC (rev 4601)
+++ branches/avidemux_2.6_branch_mean/plugins/ADM_demuxers/MpegPS/ADM_psComputeTimeStamp.cpp	2009-02-15 13:48:19 UTC (rev 4602)
@@ -132,10 +132,12 @@
                     {
                         frame->pts=frame->dts+2*dtsIncrement;
                     }
-                    if(frame->dts<lastDts) printf("[psRead] Warning DTS going backward old:%"LLD" new:%"LLD" delta=%"LLD"\n",
-                                                                                            lastDts/1000,frame->dts/1000,(lastDts-frame->dts)/1000);
+                    uint64_t oldDts=lastDts;
                     frame->dts=lastDts=timeConvert(frame->dts);
                     frame->pts=lastPts=timeConvert(frame->pts);
+                    if(oldDts>lastDts) printf("[psRead] Warning DTS going backward frame %d, old:%"LLD" new:%"LLD" delta=%"LLD"\n",
+                                                       i,oldDts/1000,lastDts/1000,(oldDts-lastDts)/1000);
+
                 }else
                 {
                     lastDts+=dtsIncrement;



From mean at mail.berlios.de  Sun Feb 15 14:48:21 2009
From: mean at mail.berlios.de (mean at BerliOS)
Date: Sun, 15 Feb 2009 14:48:21 +0100
Subject: [Avidemux-svn-commit] r4603 -
	branches/avidemux_2.6_branch_mean/avidemux/ADM_editor
Message-ID: <200902151348.n1FDmLL1020098@sheep.berlios.de>

Author: mean
Date: 2009-02-15 14:48:20 +0100 (Sun, 15 Feb 2009)
New Revision: 4603

Modified:
   branches/avidemux_2.6_branch_mean/avidemux/ADM_editor/ADM_edRender.cpp
Log:
[editor] Silence

Modified: branches/avidemux_2.6_branch_mean/avidemux/ADM_editor/ADM_edRender.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/ADM_editor/ADM_edRender.cpp	2009-02-15 13:48:19 UTC (rev 4602)
+++ branches/avidemux_2.6_branch_mean/avidemux/ADM_editor/ADM_edRender.cpp	2009-02-15 13:48:20 UTC (rev 4603)
@@ -314,7 +314,7 @@
         result->Pts=vid->lastDecodedPts;
     }else
         vid->lastDecodedPts=pts;
-    printf("Decoded frame %"LU" with pts=%"LLD" us, %"LLD" ms\n",
+    aprintf("Decoded frame %"LU" with pts=%"LLD" us, %"LLD" ms\n",
             frame,
             vid->lastDecodedPts,
             vid->lastDecodedPts/1000);



From mean at mail.berlios.de  Sun Feb 15 15:34:19 2009
From: mean at mail.berlios.de (mean at BerliOS)
Date: Sun, 15 Feb 2009 15:34:19 +0100
Subject: [Avidemux-svn-commit] r4604 -
	branches/avidemux_2.6_branch_mean/avidemux/ADM_editor
Message-ID: <200902151434.n1FEYJM7024156@sheep.berlios.de>

Author: mean
Date: 2009-02-15 15:34:18 +0100 (Sun, 15 Feb 2009)
New Revision: 4604

Modified:
   branches/avidemux_2.6_branch_mean/avidemux/ADM_editor/ADM_edRender.cpp
Log:
[Editor] Dont systematically flush cache

Modified: branches/avidemux_2.6_branch_mean/avidemux/ADM_editor/ADM_edRender.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/ADM_editor/ADM_edRender.cpp	2009-02-15 13:48:20 UTC (rev 4603)
+++ branches/avidemux_2.6_branch_mean/avidemux/ADM_editor/ADM_edRender.cpp	2009-02-15 14:34:18 UTC (rev 4604)
@@ -125,7 +125,7 @@
     bool found=false;
     vid->lastSentFrame=frame;
     uint32_t nbFrames=vid->_nb_video_frames;
-    cache->flush();
+    //cache->flush();
     // The PTS associated with our frame is the one we are looking for
     uint64_t wantedPts=vid->_aviheader->getTime(frame);
     uint32_t tries=8;
@@ -139,7 +139,7 @@
          if (!demuxer->getFrame (vid->lastSentFrame,&img))
          {
                 printf("[DecodePictureUpToIntra] getFrame failed for frame %"LU"\n",vid->lastSentFrame);
-                cache->flush();
+                //cache->flush();
                 return false;
          }
          // Now uncompress it...



From mean at mail.berlios.de  Sun Feb 15 15:34:22 2009
From: mean at mail.berlios.de (mean at BerliOS)
Date: Sun, 15 Feb 2009 15:34:22 +0100
Subject: [Avidemux-svn-commit] r4605 - in branches/avidemux_2.6_branch_mean:
	avidemux avidemux/ADM_audio avidemux/ADM_coreAudio/src
	avidemux/ADM_coreUI/include avidemux/ADM_coreUI/src
	avidemux/ADM_editor avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog
	avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog
	plugins/ADM_demuxers/MpegPS
Message-ID: <200902151434.n1FEYMce024168@sheep.berlios.de>

Author: mean
Date: 2009-02-15 15:34:21 +0100 (Sun, 15 Feb 2009)
New Revision: 4605

Modified:
   branches/avidemux_2.6_branch_mean/avidemux/ADM_audio/audiotimeline.cpp
   branches/avidemux_2.6_branch_mean/avidemux/ADM_coreAudio/src/ADM_audioStreamMP3.cpp
   branches/avidemux_2.6_branch_mean/avidemux/ADM_coreUI/include/DIA_working.h
   branches/avidemux_2.6_branch_mean/avidemux/ADM_coreUI/src/DIA_working.cpp
   branches/avidemux_2.6_branch_mean/avidemux/ADM_editor/ADM_edFrameType.cpp
   branches/avidemux_2.6_branch_mean/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp
   branches/avidemux_2.6_branch_mean/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_working.cpp
   branches/avidemux_2.6_branch_mean/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/toolkit_dialog.cpp
   branches/avidemux_2.6_branch_mean/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/CMakeLists.txt
   branches/avidemux_2.6_branch_mean/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_working.cpp
   branches/avidemux_2.6_branch_mean/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/alert_qt4.cpp
   branches/avidemux_2.6_branch_mean/avidemux/gtk_gui.cpp
   branches/avidemux_2.6_branch_mean/avidemux/gui_blackframes.cpp
   branches/avidemux_2.6_branch_mean/plugins/ADM_demuxers/MpegPS/ADM_psIndex.cpp
Log:
[QT4] Finish the DIA_working + call createWorking rather than using dummy middleman class

Modified: branches/avidemux_2.6_branch_mean/avidemux/ADM_audio/audiotimeline.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/ADM_audio/audiotimeline.cpp	2009-02-15 14:34:18 UTC (rev 4604)
+++ branches/avidemux_2.6_branch_mean/avidemux/ADM_audio/audiotimeline.cpp	2009-02-15 14:34:21 UTC (rev 4605)
@@ -73,9 +73,9 @@
 
       ADM_assert(_audioMap);
 
-      DIA_working *work;
+      DIA_workingBase *work;
 
-      work=new DIA_working(QT_TR_NOOP("Building VBR map"));
+      work=createWorking(QT_TR_NOOP("Building VBR map"));
 
       goTo(0);
       uint32_t Mul=2*_wavheader->channels;
@@ -86,7 +86,7 @@
 				if(!work->isAlive())
 				{
 					delete work;
-					work=new DIA_working(QT_TR_NOOP("Building VBR map"));
+					work=createWorking(QT_TR_NOOP("Building VBR map"));
 					work->update(offset,_length);
 				}
 

Modified: branches/avidemux_2.6_branch_mean/avidemux/ADM_coreAudio/src/ADM_audioStreamMP3.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/ADM_coreAudio/src/ADM_audioStreamMP3.cpp	2009-02-15 14:34:18 UTC (rev 4604)
+++ branches/avidemux_2.6_branch_mean/avidemux/ADM_coreAudio/src/ADM_audioStreamMP3.cpp	2009-02-15 14:34:21 UTC (rev 4605)
@@ -133,7 +133,7 @@
 {
 uint32_t size;
 uint64_t newDts,pos;
-DIA_working *work=new DIA_working("Building time map");
+DIA_workingBase *work=createWorking("Building time map");
     
     ADM_assert(access->canSeekOffset()==true);
     access->setPos(0);

Modified: branches/avidemux_2.6_branch_mean/avidemux/ADM_coreUI/include/DIA_working.h
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/ADM_coreUI/include/DIA_working.h	2009-02-15 14:34:18 UTC (rev 4604)
+++ branches/avidemux_2.6_branch_mean/avidemux/ADM_coreUI/include/DIA_working.h	2009-02-15 14:34:21 UTC (rev 4605)
@@ -1,12 +1,11 @@
 /***************************************************************************
-                          DIA_working.cpp  -  description
-                             -------------------
-    begin                : Thu Apr 21 2003
-    copyright            : (C) 2003 by mean
-    email                : fixounet at free.fr
+    \fn DIA_working.cpp 
+    \brief UI that handles working state with cancel & percent
 
-	This class deals with the working window
+    copyright            : (C) 2003/2009 by mean fixounet at free.fr
 
+
+
  ***************************************************************************/
 
 /***************************************************************************
@@ -21,38 +20,46 @@
 #ifndef __DIA_WK__
 #define __DIA_WK__
 #include "ADM_clock.h"
-	class DIA_workingBase
-	{
-		protected :
-				uint32_t 	lastper;
-				Clock	    _clock;
-				uint32_t	_nextUpdate;
-				uint32_t 	elapsed;
-				
-		public:
-				void 		*_priv;
-                            DIA_workingBase( const char *title=NULL ) {};
-				virtual		~DIA_workingBase(){};
-				// If returns 1 -> Means aborted
-				virtual uint8_t  	update(uint32_t percent) {ADM_assert(0);}
-				virtual uint8_t 	update(uint32_t current,uint32_t total){ADM_assert(0);};
-				virtual uint8_t  	isAlive (void ){ADM_assert(0);};
-				
-	};
-
-    class DIA_working : public DIA_workingBase
-    {
+/**
+    \class DIA_workingBase
+*/
+class DIA_workingBase
+{
+    protected :
+            uint32_t 	lastper;
+            Clock	    _clock;
+            uint32_t	_nextUpdate;
+            uint32_t 	elapsed;
+            
+    public:
+            void 		*_priv;
+                        DIA_workingBase( const char *title=NULL ) {};
+            virtual		~DIA_workingBase(){};
+            // If returns 1 -> Means aborted
+            virtual uint8_t  	update(uint32_t percent) {ADM_assert(0);}
+            virtual uint8_t 	update(uint32_t current,uint32_t total){ADM_assert(0);};
+            virtual uint8_t  	isAlive (void ){ADM_assert(0);};
+            
+};
+/**
+    \class DIA_working
+*/
+#if 0
+class DIA_working : public DIA_workingBase
+{
 protected:
-                    void        *son;
-            
+                void        *son;
+        
 public:
-                                DIA_working( const char *title=NULL );
-            virtual		        ~DIA_working();
-				// If returns 1 -> Means aborted
-			virtual uint8_t  	update(uint32_t percent);
-            virtual uint8_t 	update(uint32_t current,uint32_t total);
-            virtual uint8_t  	isAlive (void );
-            
-    };
+                            DIA_working( const char *title=NULL );
+        virtual		        ~DIA_working();
+            // If returns 1 -> Means aborted
+        virtual uint8_t  	update(uint32_t percent);
+        virtual uint8_t 	update(uint32_t current,uint32_t total);
+        virtual uint8_t  	isAlive (void );
+        
+};
+#endif
+DIA_workingBase *createWorking(const char *title);
 
 #endif

Modified: branches/avidemux_2.6_branch_mean/avidemux/ADM_coreUI/src/DIA_working.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/ADM_coreUI/src/DIA_working.cpp	2009-02-15 14:34:18 UTC (rev 4604)
+++ branches/avidemux_2.6_branch_mean/avidemux/ADM_coreUI/src/DIA_working.cpp	2009-02-15 14:34:21 UTC (rev 4605)
@@ -20,7 +20,7 @@
 
 #define SON ((DIA_workingBase *)son)
 #include "DIA_coreUI_internal.h"
-
+#if 0
 extern DIA_workingBase *createWorking(const char *title);
 /**
     \fn DIA_working
@@ -65,3 +65,4 @@
     if(son) return SON->isAlive();
     return 0;
 }
+#endif
\ No newline at end of file

Modified: branches/avidemux_2.6_branch_mean/avidemux/ADM_editor/ADM_edFrameType.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/ADM_editor/ADM_edFrameType.cpp	2009-02-15 14:34:18 UTC (rev 4604)
+++ branches/avidemux_2.6_branch_mean/avidemux/ADM_editor/ADM_edFrameType.cpp	2009-02-15 14:34:21 UTC (rev 4605)
@@ -86,9 +86,9 @@
 	{
 		frames+=_videos[i]._nb_video_frames;
 	}
-	DIA_working *work;
-        uint8_t nocopy;
-	work=new DIA_working(QT_TR_NOOP("Rebuilding Frames"));
+	DIA_workingBase *work;
+    uint8_t nocopy;
+	work=createWorking(QT_TR_NOOP("Rebuilding Frames"));
 
 
 	for(uint32_t vid=0;vid<_nb_video;vid++)

Modified: branches/avidemux_2.6_branch_mean/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp	2009-02-15 14:34:18 UTC (rev 4604)
+++ branches/avidemux_2.6_branch_mean/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_encoding.cpp	2009-02-15 14:34:21 UTC (rev 4605)
@@ -213,7 +213,7 @@
 
 	if (shutdownRequired && !stopReq)
 	{
-		DIA_working *work=new DIA_working(QT_TR_NOOP("Shutting down"));
+		DIA_workingBase *work=createWorking(QT_TR_NOOP("Shutting down"));
 		bool performShutdown=true;
 
 		for(int i = 0; i <= 30; i++)

Modified: branches/avidemux_2.6_branch_mean/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_working.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_working.cpp	2009-02-15 14:34:18 UTC (rev 4604)
+++ branches/avidemux_2.6_branch_mean/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_working.cpp	2009-02-15 14:34:21 UTC (rev 4605)
@@ -36,11 +36,11 @@
 
 void on_work_abort(GtkObject * object, gpointer user_data)
 {
-DIA_working *dial;
+DIA_workingBase *dial;
 GtkWidget *dialog;
 
 	UNUSED_ARG(object);
-	dial=(DIA_working *)user_data;
+	dial=(DIA_workingBase *)user_data;
 	dialog=(GtkWidget *)dial->_priv;
         gtk_unregister_dialog(dialog);
 	gtk_widget_destroy(dialog);

Modified: branches/avidemux_2.6_branch_mean/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/toolkit_dialog.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/toolkit_dialog.cpp	2009-02-15 14:34:18 UTC (rev 4604)
+++ branches/avidemux_2.6_branch_mean/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/toolkit_dialog.cpp	2009-02-15 14:34:21 UTC (rev 4605)
@@ -364,8 +364,8 @@
 		&ADM_GtkCoreUIToolkit::GUI_Verbose,
 		&ADM_GtkCoreUIToolkit::GUI_Quiet,
 		&ADM_GtkCoreUIToolkit::GUI_isQuiet,
-        &ADM_GtkCoreUIToolkit::createWorking,
-        &ADM_GtkCoreUIToolkit::createEncodingGtk
+        &ADM_GtkCoreUIToolkit::createWorking
+        // &ADM_GtkCoreUIToolkit::createEncodingQt4
 };
 
 void InitCoreToolkit(void )

Modified: branches/avidemux_2.6_branch_mean/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/CMakeLists.txt
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/CMakeLists.txt	2009-02-15 14:34:18 UTC (rev 4604)
+++ branches/avidemux_2.6_branch_mean/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/CMakeLists.txt	2009-02-15 14:34:21 UTC (rev 4605)
@@ -1,11 +1,14 @@
 SET(ADM_LIB ADM_dialogQt4)
 
-SET(uiFiles
-	about.ui  
+SET(    
+        uiFiles
+        about.ui  
         calculator.ui  
 #encoding.ui  
         license.ui
-	jobs.ui  props.ui  vobsub.ui  working.ui)
+        jobs.ui  
+        props.ui  vobsub.ui  
+        working.ui)
 
 SET(headers
 	Q_about.h  Q_calculator.h  
@@ -17,16 +20,20 @@
 QT4_ADD_RESOURCES(${ADM_LIB}_resource  about.qrc)
 
 SET(${ADM_LIB}_SRCS ${${ADM_LIB}_SRCS}
-	${${ADM_LIB}_headers}  ${${ADM_LIB}_source}  ${${ADM_LIB}_resource}  Q_about.cpp  
-#	Q_calculator.cpp  
-#Q_encoding.cpp  
+	${${ADM_LIB}_headers}  ${${ADM_LIB}_source}  ${${ADM_LIB}_resource}  
+        Q_about.cpp  
         Q_license.cpp
-	Q_jobs.cpp  Q_props.cpp   
-#Q_vobsub.cpp  
-#Q_working.cpp   
+        Q_jobs.cpp  Q_props.cpp   
+        Q_working.cpp   
         T_index_pg.cpp
-	alert_qt4.cpp  DIA_busy.cpp  DIA_none.cpp  
-#DIA_xvid4.cpp  OCR_none.cpp
+        alert_qt4.cpp  
+        DIA_busy.cpp  
+        DIA_none.cpp  
+#DIA_xvid4.cpp  OCR_none.cpp
+#Q_vobsub.cpp  
+#Q_calculator.cpp  
+#Q_encoding.cpp  
+
 )
 
 ADD_DEFINITIONS(-DADM_SUBVERSION=${ADM_SUBVERSION})

Modified: branches/avidemux_2.6_branch_mean/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_working.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_working.cpp	2009-02-15 14:34:18 UTC (rev 4604)
+++ branches/avidemux_2.6_branch_mean/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_working.cpp	2009-02-15 14:34:21 UTC (rev 4605)
@@ -26,29 +26,48 @@
  }
 //*******************************************
 
-DIA_working::DIA_working( void )
+namespace ADM_Qt4CoreUIToolkit
 {
-  workWindow *wind;
-  wind=new workWindow();
-  _priv=(void *)wind;
-  postCtor();
-}
-DIA_working::DIA_working( const char *title )
+
+class DIA_workingQt4 : public DIA_workingBase
 {
+protected:
+        virtual void 	    postCtor( void ) ;
+public:
+                            DIA_workingQt4( const char *title=NULL );
+        virtual		        ~DIA_workingQt4();
+            // If returns 1 -> Means aborted
+        virtual uint8_t  	update(uint32_t percent);
+        virtual uint8_t 	update(uint32_t current,uint32_t total);
+        virtual uint8_t  	isAlive (void );
+                void        closeDialog(void);
+        
+};
+
+
+
+
+
+
+/****************************************/
+//*******************************************
+
+DIA_workingQt4::DIA_workingQt4( const char *title ) : DIA_workingBase(title)
+{
   workWindow *wind;
   wind=new workWindow();
   _priv=(void *)wind;
   wind->setWindowTitle(title);
   postCtor();
 }
-void DIA_working :: postCtor( void )
+void DIA_workingQt4 :: postCtor( void )
 {
   workWindow *wind=(workWindow *)_priv; ADM_assert(wind);
       wind->show();
       lastper=0;
       _nextUpdate=0;
 }
-uint8_t DIA_working::update(uint32_t percent)
+uint8_t DIA_workingQt4::update(uint32_t percent)
 {
 		#define GUI_UPDATE_RATE 1000
 
@@ -86,7 +105,7 @@
         return 0;
 }
 
-uint8_t DIA_working::update(uint32_t cur, uint32_t total)
+uint8_t DIA_workingQt4::update(uint32_t cur, uint32_t total)
 {
         double d,n;
         uint32_t percent;
@@ -105,23 +124,32 @@
 
 }
 
-uint8_t DIA_working::isAlive (void )
+uint8_t DIA_workingQt4::isAlive (void )
 {
 	if(!_priv) return 0;
 	return 1;
 }
 
-DIA_working::~DIA_working()
+DIA_workingQt4::~DIA_workingQt4()
 {
     closeDialog();
 }
 
-void DIA_working::closeDialog( void )
+void DIA_workingQt4::closeDialog( void )
 {
   workWindow *wind=(workWindow *)_priv; ADM_assert(wind);
     if(wind) delete wind;
     wind=NULL;
 }
+/**
+    \fn createWorking
+*/
+DIA_workingBase *createWorking(const char *title)
+{
+    return new DIA_workingQt4(title);
+}   
 
+
+}
 //********************************************
 //EOF

Modified: branches/avidemux_2.6_branch_mean/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/alert_qt4.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/alert_qt4.cpp	2009-02-15 14:34:18 UTC (rev 4604)
+++ branches/avidemux_2.6_branch_mean/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/alert_qt4.cpp	2009-02-15 14:34:21 UTC (rev 4605)
@@ -226,6 +226,7 @@
   beQuiet=1;
 }
 //****************************************************************************************************
+extern DIA_workingBase *createWorking(const char *title);
 }
 
 static CoreToolkitDescriptor Qt4CoreToolkitDescriptor=
@@ -238,7 +239,9 @@
 		&ADM_Qt4CoreUIToolkit::GUI_Alternate,
 		&ADM_Qt4CoreUIToolkit::GUI_Verbose,
 		&ADM_Qt4CoreUIToolkit::GUI_Quiet,
-		&ADM_Qt4CoreUIToolkit::GUI_isQuiet
+		&ADM_Qt4CoreUIToolkit::GUI_isQuiet,
+        &ADM_Qt4CoreUIToolkit::createWorking,
+        //&ADM_Qt4CoreUIToolkit::createEncodingQt4
 };
 
 void InitCoreToolkit(void )

Modified: branches/avidemux_2.6_branch_mean/avidemux/gtk_gui.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/gtk_gui.cpp	2009-02-15 14:34:18 UTC (rev 4604)
+++ branches/avidemux_2.6_branch_mean/avidemux/gtk_gui.cpp	2009-02-15 14:34:21 UTC (rev 4605)
@@ -1167,7 +1167,7 @@
   uint32_t len2;
   uint32_t written, max;
   uint64_t dts;
-  DIA_working *work;
+  DIA_workingBase *work;
   FILE *out;
 
 #define ONE_STRIKE (64*1024)
@@ -1181,7 +1181,7 @@
   out = fopen (name, "wb");
   if (!out) return;
 
-  work=new DIA_working(QT_TR_NOOP("Saving audio"));
+  work=createWorking(QT_TR_NOOP("Saving audio"));
 
   uint32_t timeEnd,timeStart,sample,hold,len;
   uint64_t tgt_sample,cur_sample;
@@ -1291,7 +1291,7 @@
   uint32_t curImg;
   char	 fullName[2048],*ext;
   char *baseName;
-  DIA_working *working;
+  DIA_workingBase *working;
   uint8_t success=0;
 
         if(frameStart>frameEnd)
@@ -1305,7 +1305,7 @@
         src=new ADMImage(avifileinfo->width,avifileinfo->height);
         ADM_assert(src);
 
-        working=new DIA_working(QT_TR_NOOP("Saving as set of jpegs"));
+        working=createWorking(QT_TR_NOOP("Saving as set of jpegs"));
         for(curImg=frameStart;curImg<=frameEnd;curImg++)
         {
                 working->update(curImg-frameStart,frameEnd-frameStart);
@@ -1633,7 +1633,7 @@
   FILE *fd, *fi;
   uint8_t *buffer = new uint8_t[avifileinfo->width * avifileinfo->height * 3],ret=0;
   char *idx;
-  DIA_working *work;
+  DIA_workingBase *work;
   uint8_t seq;
   idx = new char[strlen (name) + 8];
   strcpy (idx, name);
@@ -1642,7 +1642,7 @@
   fi = fopen (idx, "wt");
   if (!fd)
     return 0;
-  work=new DIA_working(QT_TR_NOOP("Saving raw video stream"));
+  work=createWorking(QT_TR_NOOP("Saving raw video stream"));
   ADMCompressedImage image;
   image.data=buffer;
   image.dataLength=avifileinfo->width * avifileinfo->height * 3;
@@ -1788,10 +1788,10 @@
 //uint32_t buf[720*576*2];
 uint32_t error=0;
 ADMImage *aImage;
-DIA_working *work;
+DIA_workingBase *work;
 
 	nb = avifileinfo->nb_frames;
-	work=new DIA_working(QT_TR_NOOP("Checking video"));
+	work=createWorking(QT_TR_NOOP("Checking video"));
 	aImage=new ADMImage(avifileinfo->width,avifileinfo->height);
   for(uint32_t i=0;i<nb;i++)
   {

Modified: branches/avidemux_2.6_branch_mean/avidemux/gui_blackframes.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/gui_blackframes.cpp	2009-02-15 14:34:18 UTC (rev 4604)
+++ branches/avidemux_2.6_branch_mean/avidemux/gui_blackframes.cpp	2009-02-15 14:34:21 UTC (rev 4605)
@@ -157,7 +157,7 @@
 
    const int darkness=40;
 
-   DIA_working *work=new DIA_working(QT_TR_NOOP("Seeking"));
+   DIA_workingBase *work=createWorking(QT_TR_NOOP("Seeking"));
    orgFrame=curframe;
    int total;
     // Avoid it being 0
@@ -238,7 +238,7 @@
     const int darkness=40;
 
     startframe=curframe;
-    DIA_working *work=new DIA_working(QT_TR_NOOP("Finding black frames"));
+    DIA_workingBase *work=createWorking(QT_TR_NOOP("Finding black frames"));
     printf("\n** Listing all black frames **\n");
 
     for (f=0; f<avifileinfo->nb_frames; f++) {

Modified: branches/avidemux_2.6_branch_mean/plugins/ADM_demuxers/MpegPS/ADM_psIndex.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/plugins/ADM_demuxers/MpegPS/ADM_psIndex.cpp	2009-02-15 14:34:18 UTC (rev 4604)
+++ branches/avidemux_2.6_branch_mean/plugins/ADM_demuxers/MpegPS/ADM_psIndex.cpp	2009-02-15 14:34:21 UTC (rev 4605)
@@ -24,7 +24,7 @@
 #include "avidemutils.h"
 #include "ADM_quota.h"
 #include "ADM_psAudioProbe.h"
-#include "DIA_encoding.h"
+#include "DIA_working.h"
 
 static const char Type[5]={'X','I','P','B','P'};
 
@@ -88,7 +88,7 @@
         FILE *index;
         psPacketLinearTracker *pkt;
         listOfPsAudioTracks *audioTracks;
-        DIA_encodingBase  *ui;
+        DIA_workingBase  *ui;
 public:
                 PsIndexer(void);
                 ~PsIndexer();
@@ -120,7 +120,7 @@
     index=NULL;
     pkt=NULL;
     audioTracks=NULL;
-    ui=createEncoding (25000);
+    ui=createWorking ("Indexing");
 }
 
 /**
@@ -224,7 +224,7 @@
                                 float pos=data.startAt;
                                 pos=pos/(float)fullSize;
                                 pos*=100;
-                                ui->setPercent( (uint32_t)pos);
+                                ui->update( (uint32_t)pos);
 
                             }
 



From mean at mail.berlios.de  Sun Feb 15 15:51:50 2009
From: mean at mail.berlios.de (mean at BerliOS)
Date: Sun, 15 Feb 2009 15:51:50 +0100
Subject: [Avidemux-svn-commit] r4606 - in
	branches/avidemux_2.6_branch_mean/plugins/ADM_demuxers:
	Matroska OpenDml
Message-ID: <200902151451.n1FEpoVA025472@sheep.berlios.de>

Author: mean
Date: 2009-02-15 15:51:50 +0100 (Sun, 15 Feb 2009)
New Revision: 4606

Modified:
   branches/avidemux_2.6_branch_mean/plugins/ADM_demuxers/Matroska/ADM_mkvIndexer.cpp
   branches/avidemux_2.6_branch_mean/plugins/ADM_demuxers/OpenDml/ADM_openDMLDepack.cpp
Log:
[Plugins] Use createWorking in plugins also

Modified: branches/avidemux_2.6_branch_mean/plugins/ADM_demuxers/Matroska/ADM_mkvIndexer.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/plugins/ADM_demuxers/Matroska/ADM_mkvIndexer.cpp	2009-02-15 14:34:21 UTC (rev 4605)
+++ branches/avidemux_2.6_branch_mean/plugins/ADM_demuxers/Matroska/ADM_mkvIndexer.cpp	2009-02-15 14:51:50 UTC (rev 4606)
@@ -36,7 +36,7 @@
   const char *ss;
 
    parser->seek(0);
-   DIA_working *work=new DIA_working("Matroska Images");
+   DIA_workingBase *work=createWorking("Matroska Images");
    // Start with a small index, it will grow automatically afterward
    for(int i=0;i<_nbAudioTrack+1;i++)
    {
@@ -304,7 +304,7 @@
      return 0;
    }
    ADM_ebml_file segment(parser,vlen);
-   DIA_working *work=new DIA_working("Matroska clusters");
+   DIA_workingBase *work=createWorking("Matroska clusters");
    while(segment.simplefind(MKV_CLUSTER,&alen,0))
    {
 

Modified: branches/avidemux_2.6_branch_mean/plugins/ADM_demuxers/OpenDml/ADM_openDMLDepack.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/plugins/ADM_demuxers/OpenDml/ADM_openDMLDepack.cpp	2009-02-15 14:34:21 UTC (rev 4605)
+++ branches/avidemux_2.6_branch_mean/plugins/ADM_demuxers/OpenDml/ADM_openDMLDepack.cpp	2009-02-15 14:51:50 UTC (rev 4606)
@@ -97,7 +97,7 @@
 	setpriority(PRIO_PROCESS, 0, ADM_getNiceValue(priorityLevel));
 #endif
 	printf("Trying to unpack the stream\n");
-	DIA_working *working=new DIA_working(QT_TR_NOOP("Unpacking bitstream"));
+	DIA_workingBase *working=createWorking(QT_TR_NOOP("Unpacking bitstream"));
 	ADMCompressedImage image;
     image.data=buffer;
 	uint32_t img=0;



From gruntster at mail.berlios.de  Sun Feb 15 19:33:23 2009
From: gruntster at mail.berlios.de (gruntster at mail.berlios.de)
Date: Sun, 15 Feb 2009 19:33:23 +0100
Subject: [Avidemux-svn-commit] r4607 -
	branches/avidemux_2.5_branch_gruntster/cmake
Message-ID: <200902151833.n1FIXNpG012248@sheep.berlios.de>

Author: gruntster
Date: 2009-02-15 19:33:15 +0100 (Sun, 15 Feb 2009)
New Revision: 4607

Modified:
   branches/avidemux_2.5_branch_gruntster/cmake/admFFmpegBuild.cmake
Log:
[CMake] fix debug build

Modified: branches/avidemux_2.5_branch_gruntster/cmake/admFFmpegBuild.cmake
===================================================================
--- branches/avidemux_2.5_branch_gruntster/cmake/admFFmpegBuild.cmake	2009-02-15 14:51:50 UTC (rev 4606)
+++ branches/avidemux_2.5_branch_gruntster/cmake/admFFmpegBuild.cmake	2009-02-15 18:33:15 UTC (rev 4607)
@@ -1,4 +1,5 @@
 include(admFFmpegUtil)
+find_package(Subversion)
 
 set(FFMPEG_VERSION 16945)
 set(SWSCALE_VERSION 28447)



From gruntster at mail.berlios.de  Sun Feb 15 20:02:57 2009
From: gruntster at mail.berlios.de (gruntster at mail.berlios.de)
Date: Sun, 15 Feb 2009 20:02:57 +0100
Subject: [Avidemux-svn-commit] r4608 -
	branches/avidemux_2.5_branch_gruntster/cmake
Message-ID: <200902151902.n1FJ2v90004851@sheep.berlios.de>

Author: gruntster
Date: 2009-02-15 20:02:52 +0100 (Sun, 15 Feb 2009)
New Revision: 4608

Modified:
   branches/avidemux_2.5_branch_gruntster/cmake/admFFmpegBuild.cmake
Log:
[ffmpeg] fix install dir for Unix

Modified: branches/avidemux_2.5_branch_gruntster/cmake/admFFmpegBuild.cmake
===================================================================
--- branches/avidemux_2.5_branch_gruntster/cmake/admFFmpegBuild.cmake	2009-02-15 18:33:15 UTC (rev 4607)
+++ branches/avidemux_2.5_branch_gruntster/cmake/admFFmpegBuild.cmake	2009-02-15 19:02:52 UTC (rev 4608)
@@ -176,25 +176,31 @@
 # Add and install libraries
 getFfmpegLibNames("${FFMPEG_SOURCE_DIR}")
 
+if (WIN32)
+	set(FFMPEG_INSTALL_DIR ${BIN_DIR})
+else (WIN32)
+	set(FFMPEG_INSTALL_DIR lib)
+endif (WIN32)
+
 add_library(ADM_libswscale UNKNOWN IMPORTED)
 set_property(TARGET ADM_libswscale PROPERTY IMPORTED_LOCATION "${FFMPEG_BINARY_DIR}/libswscale/${LIBSWSCALE_LIB}")
-install(FILES "${FFMPEG_BINARY_DIR}/libswscale/${LIBSWSCALE_LIB}" DESTINATION "${BIN_DIR}")
+install(FILES "${FFMPEG_BINARY_DIR}/libswscale/${LIBSWSCALE_LIB}" DESTINATION "${FFMPEG_INSTALL_DIR}")
 
 add_library(ADM_libpostproc UNKNOWN IMPORTED)
 set_property(TARGET ADM_libpostproc PROPERTY IMPORTED_LOCATION "${FFMPEG_BINARY_DIR}/libpostproc/${LIBPOSTPROC_LIB}")
-install(FILES "${FFMPEG_BINARY_DIR}/libpostproc/${LIBPOSTPROC_LIB}" DESTINATION "${BIN_DIR}")
+install(FILES "${FFMPEG_BINARY_DIR}/libpostproc/${LIBPOSTPROC_LIB}" DESTINATION "${FFMPEG_INSTALL_DIR}")
 
 add_library(ADM_libavutil UNKNOWN IMPORTED)
 set_property(TARGET ADM_libavutil PROPERTY IMPORTED_LOCATION "${FFMPEG_BINARY_DIR}/libavutil/${LIBAVUTIL_LIB}")
-install(FILES "${FFMPEG_BINARY_DIR}/libavutil/${LIBAVUTIL_LIB}" DESTINATION "${BIN_DIR}")
+install(FILES "${FFMPEG_BINARY_DIR}/libavutil/${LIBAVUTIL_LIB}" DESTINATION "${FFMPEG_INSTALL_DIR}")
 
 add_library(ADM_libavcodec UNKNOWN IMPORTED)
 set_property(TARGET ADM_libavcodec PROPERTY IMPORTED_LOCATION "${FFMPEG_BINARY_DIR}/libavcodec/${LIBAVCODEC_LIB}")
-install(FILES "${FFMPEG_BINARY_DIR}/libavcodec/${LIBAVCODEC_LIB}" DESTINATION "${BIN_DIR}")
+install(FILES "${FFMPEG_BINARY_DIR}/libavcodec/${LIBAVCODEC_LIB}" DESTINATION "${FFMPEG_INSTALL_DIR}")
 
 add_library(ADM_libavformat UNKNOWN IMPORTED)
 set_property(TARGET ADM_libavformat PROPERTY IMPORTED_LOCATION "${FFMPEG_BINARY_DIR}/libavformat/${LIBAVFORMAT_LIB}")
-install(FILES "${FFMPEG_BINARY_DIR}/libavformat/${LIBAVFORMAT_LIB}" DESTINATION "${BIN_DIR}")
+install(FILES "${FFMPEG_BINARY_DIR}/libavformat/${LIBAVFORMAT_LIB}" DESTINATION "${FFMPEG_INSTALL_DIR}")
 
 include_directories("${FFMPEG_SOURCE_DIR}")
 include_directories("${FFMPEG_SOURCE_DIR}/libavutil")



From gruntster at mail.berlios.de  Sun Feb 15 20:15:41 2009
From: gruntster at mail.berlios.de (gruntster at mail.berlios.de)
Date: Sun, 15 Feb 2009 20:15:41 +0100
Subject: [Avidemux-svn-commit] r4609 - in
	branches/avidemux_2.5_branch_gruntster/plugins: .
	ADM_audioEncoders/lavcodec ADM_videoFilters/ForcedPP
	ADM_videoFilters/McDeint ADM_videoFilters/Mosaic
	ADM_videoFilters/MplayerResize ADM_videoFilters/lavDeinterlace
Message-ID: <200902151915.n1FJFflE006195@sheep.berlios.de>

Author: gruntster
Date: 2009-02-15 20:15:34 +0100 (Sun, 15 Feb 2009)
New Revision: 4609

Modified:
   branches/avidemux_2.5_branch_gruntster/plugins/ADM_audioEncoders/lavcodec/CMakeLists.txt
   branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/ForcedPP/CMakeLists.txt
   branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/McDeint/CMakeLists.txt
   branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/Mosaic/CMakeLists.txt
   branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/MplayerResize/CMakeLists.txt
   branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/lavDeinterlace/CMakeLists.txt
   branches/avidemux_2.5_branch_gruntster/plugins/CMakeLists.txt
Log:
[ffmpeg] fix install dir for Unix [part 2]

Modified: branches/avidemux_2.5_branch_gruntster/plugins/ADM_audioEncoders/lavcodec/CMakeLists.txt
===================================================================
--- branches/avidemux_2.5_branch_gruntster/plugins/ADM_audioEncoders/lavcodec/CMakeLists.txt	2009-02-15 19:02:52 UTC (rev 4608)
+++ branches/avidemux_2.5_branch_gruntster/plugins/ADM_audioEncoders/lavcodec/CMakeLists.txt	2009-02-15 19:15:34 UTC (rev 4609)
@@ -7,8 +7,8 @@
 
 	SET(ADM_ae_lav_mp2_SRCS audioencoder_lavcodec.cpp)
 	
-	add_library(ADM_libavcodec UNKNOWN IMPORTED)
-	set_property(TARGET ADM_libavcodec PROPERTY IMPORTED_LOCATION "${AVIDEMUX_BIN_DIR}/${LIBAVCODEC_LIB}")	
+	add_library(ADM_libavcodec UNKNOWN IMPORTED)
+	set_property(TARGET ADM_libavcodec PROPERTY IMPORTED_LOCATION "${FFMPEG_LIB_DIR}/${LIBAVCODEC_LIB}")	
 
 	ADD_LIBRARY(ADM_ae_lav_mp2 SHARED ${ADM_ae_lav_mp2_SRCS})
 	ADD_TARGET_CFLAGS(ADM_ae_lav_mp2 "-DADM_LAV_MP2")

Modified: branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/ForcedPP/CMakeLists.txt
===================================================================
--- branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/ForcedPP/CMakeLists.txt	2009-02-15 19:02:52 UTC (rev 4608)
+++ branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/ForcedPP/CMakeLists.txt	2009-02-15 19:15:34 UTC (rev 4609)
@@ -6,8 +6,8 @@
 
 SET(ADM_vf_forcedPP_SRCS ADM_vidForcedPP.cpp)
 
-add_library(ADM_libpostproc UNKNOWN IMPORTED)
-set_property(TARGET ADM_libpostproc PROPERTY IMPORTED_LOCATION "${AVIDEMUX_BIN_DIR}/${LIBPOSTPROC_LIB}")
+add_library(ADM_libpostproc UNKNOWN IMPORTED)
+set_property(TARGET ADM_libpostproc PROPERTY IMPORTED_LOCATION "${FFMPEG_LIB_DIR}/${LIBPOSTPROC_LIB}")
 
 ADD_LIBRARY(ADM_vf_forcedPP SHARED ${ADM_vf_forcedPP_SRCS})
 TARGET_LINK_LIBRARIES(ADM_vf_forcedPP ADM_libpostproc)

Modified: branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/McDeint/CMakeLists.txt
===================================================================
--- branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/McDeint/CMakeLists.txt	2009-02-15 19:02:52 UTC (rev 4608)
+++ branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/McDeint/CMakeLists.txt	2009-02-15 19:15:34 UTC (rev 4609)
@@ -6,8 +6,8 @@
 INCLUDE_DIRECTORIES("${AVIDEMUX_SOURCE_DIR}/avidemux/ADM_libraries/ffmpeg")
 SET(ADM_vf_mcdeint_SRCS ADM_vidMcDeint.cpp)
 
-add_library(ADM_libavcodec UNKNOWN IMPORTED)
-set_property(TARGET ADM_libavcodec PROPERTY IMPORTED_LOCATION "${AVIDEMUX_BIN_DIR}/${LIBAVCODEC_LIB}")
+add_library(ADM_libavcodec UNKNOWN IMPORTED)
+set_property(TARGET ADM_libavcodec PROPERTY IMPORTED_LOCATION "${FFMPEG_LIB_DIR}/${LIBAVCODEC_LIB}")
 
 ADD_LIBRARY(ADM_vf_mcdeint SHARED ${ADM_vf_mcdeint_SRCS})
 TARGET_LINK_LIBRARIES(ADM_vf_mcdeint ADM_libavcodec)

Modified: branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/Mosaic/CMakeLists.txt
===================================================================
--- branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/Mosaic/CMakeLists.txt	2009-02-15 19:02:52 UTC (rev 4608)
+++ branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/Mosaic/CMakeLists.txt	2009-02-15 19:15:34 UTC (rev 4609)
@@ -7,14 +7,14 @@
 INCLUDE_DIRECTORIES("${AVIDEMUX_SOURCE_DIR}/avidemux/")
 INCLUDE_DIRECTORIES("${AVIDEMUX_SOURCE_DIR}/avidemux/ADM_libraries/ffmpeg")
 
-add_library(ADM_libswscale UNKNOWN IMPORTED)
-set_property(TARGET ADM_libswscale PROPERTY IMPORTED_LOCATION "${AVIDEMUX_BIN_DIR}/${LIBSWSCALE_LIB}")
+add_library(ADM_libswscale UNKNOWN IMPORTED)
+set_property(TARGET ADM_libswscale PROPERTY IMPORTED_LOCATION "${FFMPEG_LIB_DIR}/${LIBSWSCALE_LIB}")
 
-add_library(ADM_libavcodec UNKNOWN IMPORTED)
-set_property(TARGET ADM_libavcodec PROPERTY IMPORTED_LOCATION "${AVIDEMUX_BIN_DIR}/${LIBAVCODEC_LIB}")
+add_library(ADM_libavcodec UNKNOWN IMPORTED)
+set_property(TARGET ADM_libavcodec PROPERTY IMPORTED_LOCATION "${FFMPEG_LIB_DIR}/${LIBAVCODEC_LIB}")
 
-add_library(ADM_libavutil UNKNOWN IMPORTED)
-set_property(TARGET ADM_libavutil PROPERTY IMPORTED_LOCATION "${AVIDEMUX_BIN_DIR}/${LIBAVUTIL_LIB}")
+add_library(ADM_libavutil UNKNOWN IMPORTED)
+set_property(TARGET ADM_libavutil PROPERTY IMPORTED_LOCATION "${FFMPEG_LIB_DIR}/${LIBAVUTIL_LIB}")
 
 ADD_LIBRARY(ADM_vf_Mosaic SHARED ${ADM_vf_Mosaic_SRCS})
 TARGET_LINK_LIBRARIES(ADM_vf_Mosaic ADM_libswscale ADM_libavcodec ADM_libavutil)

Modified: branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/MplayerResize/CMakeLists.txt
===================================================================
--- branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/MplayerResize/CMakeLists.txt	2009-02-15 19:02:52 UTC (rev 4608)
+++ branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/MplayerResize/CMakeLists.txt	2009-02-15 19:15:34 UTC (rev 4609)
@@ -11,14 +11,14 @@
 INCLUDE_DIRECTORIES("${AVIDEMUX_SOURCE_DIR}/avidemux/")
 INCLUDE_DIRECTORIES("${AVIDEMUX_SOURCE_DIR}/avidemux/ADM_libraries/ffmpeg")
 
-add_library(ADM_libswscale UNKNOWN IMPORTED)
-set_property(TARGET ADM_libswscale PROPERTY IMPORTED_LOCATION "${AVIDEMUX_BIN_DIR}/${LIBSWSCALE_LIB}")
+add_library(ADM_libswscale UNKNOWN IMPORTED)
+set_property(TARGET ADM_libswscale PROPERTY IMPORTED_LOCATION "${FFMPEG_LIB_DIR}/${LIBSWSCALE_LIB}")
 
-add_library(ADM_libavcodec UNKNOWN IMPORTED)
-set_property(TARGET ADM_libavcodec PROPERTY IMPORTED_LOCATION "${AVIDEMUX_BIN_DIR}/${LIBAVCODEC_LIB}")
+add_library(ADM_libavcodec UNKNOWN IMPORTED)
+set_property(TARGET ADM_libavcodec PROPERTY IMPORTED_LOCATION "${FFMPEG_LIB_DIR}/${LIBAVCODEC_LIB}")
 
-add_library(ADM_libavutil UNKNOWN IMPORTED)
-set_property(TARGET ADM_libavutil PROPERTY IMPORTED_LOCATION "${AVIDEMUX_BIN_DIR}/${LIBAVUTIL_LIB}")
+add_library(ADM_libavutil UNKNOWN IMPORTED)
+set_property(TARGET ADM_libavutil PROPERTY IMPORTED_LOCATION "${FFMPEG_LIB_DIR}/${LIBAVUTIL_LIB}")
 
 INCLUDE(vf_plugin_gtk)
 INIT_VIDEOFILTER_PLUGIN_GTK(ADM_vf_mplayerResize_gtk ${resizeCommonGtk_SRCS} ${resizeCommon_SRCS})

Modified: branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/lavDeinterlace/CMakeLists.txt
===================================================================
--- branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/lavDeinterlace/CMakeLists.txt	2009-02-15 19:02:52 UTC (rev 4608)
+++ branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/lavDeinterlace/CMakeLists.txt	2009-02-15 19:15:34 UTC (rev 4609)
@@ -7,11 +7,11 @@
 INCLUDE_DIRECTORIES("${AVIDEMUX_SOURCE_DIR}/avidemux/")
 INCLUDE_DIRECTORIES("${AVIDEMUX_SOURCE_DIR}/avidemux/ADM_libraries/ffmpeg")
 
-add_library(ADM_libswscale UNKNOWN IMPORTED)
-set_property(TARGET ADM_libswscale PROPERTY IMPORTED_LOCATION "${AVIDEMUX_BIN_DIR}/${LIBSWSCALE_LIB}")
+add_library(ADM_libswscale UNKNOWN IMPORTED)
+set_property(TARGET ADM_libswscale PROPERTY IMPORTED_LOCATION "${FFMPEG_LIB_DIR}/${LIBSWSCALE_LIB}")
 
-add_library(ADM_libpostproc UNKNOWN IMPORTED)
-set_property(TARGET ADM_libpostproc PROPERTY IMPORTED_LOCATION "${AVIDEMUX_BIN_DIR}/${LIBPOSTPROC_LIB}")
+add_library(ADM_libpostproc UNKNOWN IMPORTED)
+set_property(TARGET ADM_libpostproc PROPERTY IMPORTED_LOCATION "${FFMPEG_LIB_DIR}/${LIBPOSTPROC_LIB}")
 
 ADD_LIBRARY(ADM_vf_lavDeinterlace SHARED ${ADM_vf_lavDeinterlace_SRCS})
 TARGET_LINK_LIBRARIES(ADM_vf_lavDeinterlace ADM_libswscale ADM_libpostproc)

Modified: branches/avidemux_2.5_branch_gruntster/plugins/CMakeLists.txt
===================================================================
--- branches/avidemux_2.5_branch_gruntster/plugins/CMakeLists.txt	2009-02-15 19:02:52 UTC (rev 4608)
+++ branches/avidemux_2.5_branch_gruntster/plugins/CMakeLists.txt	2009-02-15 19:15:34 UTC (rev 4609)
@@ -39,7 +39,7 @@
 IF (NOT AVIDEMUX_INSTALL_PREFIX)
 	MESSAGE(FATAL_ERROR "Please add -DAVIDEMUX_INSTALL_PREFIX=path_to_avidemux_install")
 ELSE (NOT AVIDEMUX_INSTALL_PREFIX)
-	SET(AVIDEMUX_BIN_DIR "${AVIDEMUX_INSTALL_PREFIX}" CACHE STRING "")
+	SET(AVIDEMUX_INSTALL_PREFIX "${AVIDEMUX_INSTALL_PREFIX}" CACHE STRING "")
 ENDIF (NOT AVIDEMUX_INSTALL_PREFIX)
 
 LINK_DIRECTORIES(${AVIDEMUX_INSTALL_PREFIX}/lib)
@@ -89,7 +89,7 @@
 
 IF (WIN32)
 	SET(BIN_DIR .)
-	set(AVIDEMUX_BIN_DIR ${AVIDEMUX_INSTALL_PREFIX})
+	set(FFMPEG_LIB_DIR ${AVIDEMUX_INSTALL_PREFIX})
 	SET(CMAKE_SHARED_LINKER_FLAGS "${CMAKE_SHARED_LINKER_FLAGS} -Wl,-enable-auto-image-base -Wl,-enable-auto-import")
 
 	IF (CMAKE_BUILD_TYPE STREQUAL "Release")
@@ -97,7 +97,7 @@
 	ENDIF (CMAKE_BUILD_TYPE STREQUAL "Release")
 ELSE (WIN32)
 	SET(BIN_DIR bin)
-	set(AVIDEMUX_BIN_DIR ${AVIDEMUX_INSTALL_PREFIX}/bin)
+	set(FFMPEG_LIB_DIR ${AVIDEMUX_INSTALL_PREFIX}/lib)
 ENDIF (WIN32)
 
 ########################################



From mean at mail.berlios.de  Mon Feb 16 20:05:53 2009
From: mean at mail.berlios.de (mean at BerliOS)
Date: Mon, 16 Feb 2009 20:05:53 +0100
Subject: [Avidemux-svn-commit] r4610 -
	branches/avidemux_2.6_branch_mean/avidemux
Message-ID: <200902161905.n1GJ5roT031059@sheep.berlios.de>

Author: mean
Date: 2009-02-16 20:05:53 +0100 (Mon, 16 Feb 2009)
New Revision: 4610

Modified:
   branches/avidemux_2.6_branch_mean/avidemux/ADM_preview.cpp
Log:
[Preview] Return true on success (fix win32 playback)

Modified: branches/avidemux_2.6_branch_mean/avidemux/ADM_preview.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/ADM_preview.cpp	2009-02-15 19:15:34 UTC (rev 4609)
+++ branches/avidemux_2.6_branch_mean/avidemux/ADM_preview.cpp	2009-02-16 19:05:53 UTC (rev 4610)
@@ -517,6 +517,7 @@
 #endif
       default: ADM_assert(0);
     }
+    return true;
 }
 /**
       \fn previewBlit(ADMImage *from,ADMImage *to,uint32_t startx,uint32_t starty)



From mean at mail.berlios.de  Mon Feb 16 20:05:54 2009
From: mean at mail.berlios.de (mean at BerliOS)
Date: Mon, 16 Feb 2009 20:05:54 +0100
Subject: [Avidemux-svn-commit] r4611 -
	branches/avidemux_2.6_branch_mean/avidemux
Message-ID: <200902161905.n1GJ5s7j031069@sheep.berlios.de>

Author: mean
Date: 2009-02-16 20:05:54 +0100 (Mon, 16 Feb 2009)
New Revision: 4611

Modified:
   branches/avidemux_2.6_branch_mean/avidemux/guiplay.cpp
Log:
[Play] more verbose

Modified: branches/avidemux_2.6_branch_mean/avidemux/guiplay.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/guiplay.cpp	2009-02-16 19:05:53 UTC (rev 4610)
+++ branches/avidemux_2.6_branch_mean/avidemux/guiplay.cpp	2009-02-16 19:05:54 UTC (rev 4611)
@@ -119,7 +119,11 @@
         
         admPreview::displayNow();;
         GUI_setCurrentFrameAndTime();
-        if(false==admPreview::nextPicture()) break;
+        if(false==admPreview::nextPicture()) 
+        {
+            printf("[Play] Cancelling playback, nextPicture failed\n");
+            break;
+        }
         ADM_playFillAudio();
         lastPts=admPreview::getCurrentPts();
         systemTime = ticktock.getElapsedMS();



From mean at mail.berlios.de  Tue Feb 17 07:36:55 2009
From: mean at mail.berlios.de (mean at BerliOS)
Date: Tue, 17 Feb 2009 07:36:55 +0100
Subject: [Avidemux-svn-commit] r4612 -
	branches/avidemux_2.6_branch_mean/plugins/ADM_videoEncoder
Message-ID: <200902170636.n1H6atED023628@sheep.berlios.de>

Author: mean
Date: 2009-02-17 07:36:46 +0100 (Tue, 17 Feb 2009)
New Revision: 4612

Removed:
   branches/avidemux_2.6_branch_mean/plugins/ADM_videoEncoder/ADM_vidEnc_x264/
Log:




From mean at mail.berlios.de  Tue Feb 17 07:37:46 2009
From: mean at mail.berlios.de (mean at BerliOS)
Date: Tue, 17 Feb 2009 07:37:46 +0100
Subject: [Avidemux-svn-commit] r4613 -
	branches/avidemux_2.6_branch_mean/plugins/ADM_videoEncoder
Message-ID: <200902170637.n1H6bkVQ024387@sheep.berlios.de>

Author: mean
Date: 2009-02-17 07:37:46 +0100 (Tue, 17 Feb 2009)
New Revision: 4613

Added:
   branches/avidemux_2.6_branch_mean/plugins/ADM_videoEncoder/ADM_vidEnc_x264/
Log:


Copied: branches/avidemux_2.6_branch_mean/plugins/ADM_videoEncoder/ADM_vidEnc_x264 (from rev 4612, branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_x264)



From gruntster at mail.berlios.de  Thu Feb 19 18:07:44 2009
From: gruntster at mail.berlios.de (gruntster at mail.berlios.de)
Date: Thu, 19 Feb 2009 18:07:44 +0100
Subject: [Avidemux-svn-commit] r4614 - in
	branches/avidemux_2.5_branch_gruntster:
	platforms/windows/build_scripts/x264
	plugins/ADM_videoEncoder/ADM_vidEnc_x264
Message-ID: <200902191707.n1JH7ivF002201@sheep.berlios.de>

Author: gruntster
Date: 2009-02-19 18:07:39 +0100 (Thu, 19 Feb 2009)
New Revision: 4614

Modified:
   branches/avidemux_2.5_branch_gruntster/platforms/windows/build_scripts/x264/Perform Build.bat
   branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_x264/encoder.cpp
Log:
[x264] fix flushing using null frames

Modified: branches/avidemux_2.5_branch_gruntster/platforms/windows/build_scripts/x264/Perform Build.bat
===================================================================
--- branches/avidemux_2.5_branch_gruntster/platforms/windows/build_scripts/x264/Perform Build.bat	2009-02-17 06:37:46 UTC (rev 4613)
+++ branches/avidemux_2.5_branch_gruntster/platforms/windows/build_scripts/x264/Perform Build.bat	2009-02-19 17:07:39 UTC (rev 4614)
@@ -6,7 +6,8 @@
 
 set PATH=%PATH%;%devDir%\Git\bin
 
-rm "%usrLocalDir%/include/x264.h"
+del "%usrLocalDir%\bin\libx264-*.dll"
+del "%usrLocalDir%\include\x264.h"
 cd "%devDir%"
 
 rm -r -f x264
@@ -22,6 +23,7 @@
 make install
 if errorlevel 1 goto end
 
+del "%devDir%\avidemux_2.5_build\libx264-*.dll"
 copy "%usrLocalDir%/bin/libx264-*.dll" "%devDir%\avidemux_2.5_build"
 
 :end

Modified: branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_x264/encoder.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_x264/encoder.cpp	2009-02-17 06:37:46 UTC (rev 4613)
+++ branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_x264/encoder.cpp	2009-02-19 17:07:39 UTC (rev 4614)
@@ -302,9 +302,6 @@
 
 	memset(&_picture, 0, sizeof(x264_picture_t));
 
-	_picture.img.i_csp = X264_CSP_I420;
-	_picture.img.i_plane = 3;
-
 	if (encodeParams->frameData)
 	{
 		_picture.img.plane[0] = encodeParams->frameData;	// Y
@@ -315,9 +312,11 @@
 		_picture.img.i_stride[2] = _param.i_width >> 1;
 		_picture.i_type = X264_TYPE_AUTO;
 		_picture.i_pts = _currentFrame;
+		_picture.img.i_csp = X264_CSP_I420;
+		_picture.img.i_plane = 3;
 	}
 
-	if (x264_encoder_encode(_handle, &nal, &nalCount, &_picture, &picture_out) < 0)
+	if (x264_encoder_encode(_handle, &nal, &nalCount, encodeParams->frameData ? &_picture : NULL, &picture_out) < 0)
 	{
 		printf("[x264] Error encoding\n");
 		return ADM_VIDENC_ERR_FAILED;



From gruntster at mail.berlios.de  Fri Feb 20 10:16:09 2009
From: gruntster at mail.berlios.de (gruntster at mail.berlios.de)
Date: Fri, 20 Feb 2009 10:16:09 +0100
Subject: [Avidemux-svn-commit] r4615 -
	branches/avidemux_2.5_branch_gruntster/avidemux/ADM_outputs
Message-ID: <200902200916.n1K9G9Sl023898@sheep.berlios.de>

Author: gruntster
Date: 2009-02-20 10:15:56 +0100 (Fri, 20 Feb 2009)
New Revision: 4615

Modified:
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_outputs/ADM_lavformat.cpp
Log:
[mp4/mkv] fix mp4 and mkv muxing to work with ffmpeg update

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_outputs/ADM_lavformat.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_outputs/ADM_lavformat.cpp	2009-02-19 17:07:39 UTC (rev 4614)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_outputs/ADM_lavformat.cpp	2009-02-20 09:15:56 UTC (rev 4615)
@@ -196,8 +196,6 @@
                 case MUXER_MATROSKA:
                         strcpy(oc->title,"Avidemux");
                         strcpy(oc->author,"Avidemux");
-                        c->sample_aspect_ratio.num=1;
-                        c->sample_aspect_ratio.den=1;
                         if(isMpeg4Compatible(info->fcc))
                         {
                                 c->codec_id = CODEC_ID_MPEG4;
@@ -235,8 +233,6 @@
 
                         strcpy(oc->title,ADM_GetFileName(foo));
                         strcpy(oc->author,"Avidemux");
-                        c->sample_aspect_ratio.num=1;
-                        c->sample_aspect_ratio.den=1;
                         if(isMpeg4Compatible(info->fcc))
                         {
                                 c->codec_id = CODEC_ID_MPEG4;



From gruntster at mail.berlios.de  Sat Feb 21 15:39:59 2009
From: gruntster at mail.berlios.de (gruntster at mail.berlios.de)
Date: Sat, 21 Feb 2009 15:39:59 +0100
Subject: [Avidemux-svn-commit] r4616 - in
	branches/avidemux_2.5_branch_gruntster:
	platforms/windows/build_scripts/avidemux
	platforms/windows/installer plugins/ADM_audioEncoders
	plugins/ADM_audioEncoders/aften
Message-ID: <200902211439.n1LEdxvj021063@sheep.berlios.de>

Author: gruntster
Date: 2009-02-21 15:39:44 +0100 (Sat, 21 Feb 2009)
New Revision: 4616

Modified:
   branches/avidemux_2.5_branch_gruntster/platforms/windows/build_scripts/avidemux/2a. Update Notes.bat
   branches/avidemux_2.5_branch_gruntster/platforms/windows/installer/avidemux.nsi
   branches/avidemux_2.5_branch_gruntster/plugins/ADM_audioEncoders/CMakeLists.txt
   branches/avidemux_2.5_branch_gruntster/plugins/ADM_audioEncoders/aften/audioencoder_aften.cpp
Log:
[aften] activate Aften plugin

Modified: branches/avidemux_2.5_branch_gruntster/platforms/windows/build_scripts/avidemux/2a. Update Notes.bat
===================================================================
--- branches/avidemux_2.5_branch_gruntster/platforms/windows/build_scripts/avidemux/2a. Update Notes.bat	2009-02-20 09:15:56 UTC (rev 4615)
+++ branches/avidemux_2.5_branch_gruntster/platforms/windows/build_scripts/avidemux/2a. Update Notes.bat	2009-02-21 14:39:44 UTC (rev 4616)
@@ -21,6 +21,7 @@
 cd "%sourceDir%\po"
 sh update_pot.bash
 
+cd "%curDir%"
 goto end
 
 :error

Modified: branches/avidemux_2.5_branch_gruntster/platforms/windows/installer/avidemux.nsi
===================================================================
--- branches/avidemux_2.5_branch_gruntster/platforms/windows/installer/avidemux.nsi	2009-02-20 09:15:56 UTC (rev 4615)
+++ branches/avidemux_2.5_branch_gruntster/platforms/windows/installer/avidemux.nsi	2009-02-21 14:39:44 UTC (rev 4616)
@@ -399,6 +399,14 @@
 		${MementoSectionEnd}
 	SectionGroupEnd
 	SectionGroup "Audio Encoders" SecGrpAudioEncoder
+		${MementoSection} "Aften (AC-3)" SecAudDecAften
+			SectionIn 1 2
+			SetOverwrite on
+			SetOutPath $INSTDIR\plugins\audioEncoders
+			${File} plugins\audioEncoders\libADM_ae_aften.dll
+			SetOutPath $INSTDIR
+			${File} libaften.dll
+		${MementoSectionEnd}
 		${MementoSection} "FAAC (AAC)" SecAudEncFaac
 			SectionIn 1 2
 			SetOverwrite on

Modified: branches/avidemux_2.5_branch_gruntster/plugins/ADM_audioEncoders/CMakeLists.txt
===================================================================
--- branches/avidemux_2.5_branch_gruntster/plugins/ADM_audioEncoders/CMakeLists.txt	2009-02-20 09:15:56 UTC (rev 4615)
+++ branches/avidemux_2.5_branch_gruntster/plugins/ADM_audioEncoders/CMakeLists.txt	2009-02-21 14:39:44 UTC (rev 4616)
@@ -18,7 +18,7 @@
 endif(USE_LAME)
 
 if(USE_AFTEN)
-# not tested ADD_SUBDIRECTORY(aften)
+	ADD_SUBDIRECTORY(aften)
 endif(USE_AFTEN)
 
 if(USE_VORBIS)

Modified: branches/avidemux_2.5_branch_gruntster/plugins/ADM_audioEncoders/aften/audioencoder_aften.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/plugins/ADM_audioEncoders/aften/audioencoder_aften.cpp	2009-02-20 09:15:56 UTC (rev 4615)
+++ branches/avidemux_2.5_branch_gruntster/plugins/ADM_audioEncoders/aften/audioencoder_aften.cpp	2009-02-21 14:39:44 UTC (rev 4616)
@@ -36,11 +36,9 @@
 
 #define _HANDLE ((AftenContext *)_handle)
 
-static AFTEN_encoderParam aftenParam= {
-  128
-  
-};
+static AFTEN_encoderParam aftenParam = { 128 };
 static uint8_t configure (void);
+
 /********************* Declare Plugin *****************************************************/
 ADM_DECLARE_AUDIO_ENCODER_PREAMBLE(AUDMEncoder_Aften);
 
@@ -206,18 +204,18 @@
  int ret=0;
 
     diaMenuEntry bitrateM[]={
-                              BITRATE(56),
-                              BITRATE(64),
-                              BITRATE(80),
-                              BITRATE(96),
-                              BITRATE(112),
-                              BITRATE(128),
-                              BITRATE(160),
-                              BITRATE(192),
-                              BITRATE(224),
-                              BITRATE(384)
+							  {56, "56"},
+							  {64 ,"64"},
+							  {80, "80"},
+							  {96, "96"},
+							  {112, "112"},
+							  {128, "128"},
+							  {160, "160"},
+							  {192, "192"},
+							  {224, "224"},
+							  {384, "384"}
                           };
-    diaElemMenu bitrate(&(aftenParam.bitrate),   QT_TR_NOOP("_Bitrate:"), SZT(bitrateM),bitrateM);
+    diaElemMenu bitrate(&(aftenParam.bitrate), QT_TR_NOOP("_Bitrate:"), sizeof(bitrateM) / sizeof(diaMenuEntry), bitrateM);
   
     
 



From gruntster at mail.berlios.de  Sat Feb 21 17:02:22 2009
From: gruntster at mail.berlios.de (gruntster at mail.berlios.de)
Date: Sat, 21 Feb 2009 17:02:22 +0100
Subject: [Avidemux-svn-commit] r4617 - in
	branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_x264:
	. qt4
Message-ID: <200902211602.n1LG2McH031294@sheep.berlios.de>

Author: gruntster
Date: 2009-02-21 17:02:13 +0100 (Sat, 21 Feb 2009)
New Revision: 4617

Modified:
   branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_x264/options.cpp
   branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_x264/options.h
   branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_x264/qt4/x264ConfigDialog.cpp
   branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_x264/qt4/x264ConfigDialog.h
   branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_x264/qt4/x264ConfigDialog.ui
   branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_x264/x264Param.xsd
Log:
[x264] fix serialisation of idc level and direct prediction size options

Modified: branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_x264/options.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_x264/options.cpp	2009-02-21 14:39:44 UTC (rev 4616)
+++ branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_x264/options.cpp	2009-02-21 16:02:13 UTC (rev 4617)
@@ -134,15 +134,16 @@
 	_param.b_deterministic = deterministic;
 }
 
-unsigned int x264Options::getIdcLevel(void)
+int x264Options::getIdcLevel(void)
 {
 	return _param.i_level_idc;
 }
 
-void x264Options::setIdcLevel(unsigned int idcLevel)
+void x264Options::setIdcLevel(int idcLevel)
 {
 	switch (idcLevel)
 	{
+		case -1:
 		case 1:
 		case 11:
 		case 12:
@@ -1323,9 +1324,10 @@
 			strcpy((char*)xmlBuffer, "smallest");
 			break;
 	}
+
+	xmlNewChild(xmlNodeChild, NULL, (xmlChar*)"directPredictionSize", xmlBuffer);
 #endif
 
-	xmlNewChild(xmlNodeChild, NULL, (xmlChar*)"directPredictionSize", xmlBuffer);
 	xmlNewChild(xmlNodeChild, NULL, (xmlChar*)"chromaLumaQuantiserDifference", number2String(xmlBuffer, bufferSize, getChromaLumaQuantiserDifference()));
 
 	switch (getMotionEstimationMethod())
@@ -1832,6 +1834,7 @@
 
 				setDirectPredictionMode(directPredictionMode);
 			}
+#if X264_BUILD < 66
 			else if (strcmp((char*)xmlChild->name, "directPredictionSize") == 0)
 			{
 				int directPredictionSize = -1;
@@ -1843,8 +1846,9 @@
 				else if (strcmp(content, "smallest") == 0)
 					directPredictionSize = -1;
 
-				setDirectPredictionMode(directPredictionSize);
+				setDirectPredictionSize(directPredictionSize);
 			}
+#endif
 			else if (strcmp((char*)xmlChild->name, "chromaLumaQuantiserDifference") == 0)
 				setChromaLumaQuantiserDifference(atoi(content));
 			else if (strcmp((char*)xmlChild->name, "motionEstimationMethod") == 0)

Modified: branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_x264/options.h
===================================================================
--- branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_x264/options.h	2009-02-21 14:39:44 UTC (rev 4616)
+++ branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_x264/options.h	2009-02-21 16:02:13 UTC (rev 4617)
@@ -87,8 +87,8 @@
 	bool getDeterministic(void);
 	void setDeterministic(bool deterministic);
 
-	unsigned int getIdcLevel(void);
-	void setIdcLevel(unsigned int idcLevel);
+	int getIdcLevel(void);
+	void setIdcLevel(int idcLevel);
 
 	bool getSarAsInput(void);
 	void setSarAsInput(bool sarAsInput);

Modified: branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_x264/qt4/x264ConfigDialog.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_x264/qt4/x264ConfigDialog.cpp	2009-02-21 14:39:44 UTC (rev 4616)
+++ branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_x264/qt4/x264ConfigDialog.cpp	2009-02-21 16:02:13 UTC (rev 4617)
@@ -43,7 +43,7 @@
 	static const int _predefinedARs[aspectRatioCount][2] = {{16, 15}, {64, 45}, {8, 9}, {32, 27}};
 
 	// Mappings for x264 array index -> UI combobox index
-	static const uint8_t _idcLevel[idcLevelCount] = {1, 11, 12, 13, 2, 21, 22, 3, 31, 32, 4, 41, 42, 5, 51};
+	static const int _idcLevel[idcLevelCount] = {-1, 1, 11, 12, 13, 2, 21, 22, 3, 31, 32, 4, 41, 42, 5, 51};
 	static const uint8_t _videoFormat[videoFormatCount] = {5, 0, 1, 2, 3, 4};
 	static const uint8_t _colourPrimaries[colourPrimariesCount] = {2, 1, 4, 5, 6, 7, 8};
 	static const uint8_t _transferCharacteristics[transferCharacteristicsCount] = {2, 1, 4, 5, 8, 9, 10, 6, 7};

Modified: branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_x264/qt4/x264ConfigDialog.h
===================================================================
--- branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_x264/qt4/x264ConfigDialog.h	2009-02-21 14:39:44 UTC (rev 4616)
+++ branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_x264/qt4/x264ConfigDialog.h	2009-02-21 16:02:13 UTC (rev 4617)
@@ -24,7 +24,7 @@
 	static const int aspectRatioCount = 4;
 	int predefinedARs[aspectRatioCount][2];
 
-	static const int idcLevelCount = 15;
+	static const int idcLevelCount = 16;
 	uint8_t idcLevel[idcLevelCount];
 
 	static const int videoFormatCount = 6;

Modified: branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_x264/qt4/x264ConfigDialog.ui
===================================================================
--- branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_x264/qt4/x264ConfigDialog.ui	2009-02-21 14:39:44 UTC (rev 4616)
+++ branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_x264/qt4/x264ConfigDialog.ui	2009-02-21 16:02:13 UTC (rev 4617)
@@ -3428,10 +3428,15 @@
                 <item>
                  <widget class="QComboBox" name="idcLevelComboBox" >
                   <property name="currentIndex" >
-                   <number>14</number>
+                   <number>0</number>
                   </property>
                   <item>
                    <property name="text" >
+                    <string>Auto</string>
+                   </property>
+                  </item>
+                  <item>
+                   <property name="text" >
                     <string>1</string>
                    </property>
                   </item>

Modified: branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_x264/x264Param.xsd
===================================================================
--- branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_x264/x264Param.xsd	2009-02-21 14:39:44 UTC (rev 4616)
+++ branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_x264/x264Param.xsd	2009-02-21 16:02:13 UTC (rev 4617)
@@ -45,6 +45,7 @@
               <xs:element name="idcLevel">
                 <xs:simpleType>
                   <xs:restriction base="xs:integer">
+                    <xs:enumeration value="-1"/>
                     <xs:enumeration value="1"/>
                     <xs:enumeration value="11"/>
                     <xs:enumeration value="12"/>
@@ -292,7 +293,7 @@
                         </xs:restriction>
                       </xs:simpleType>
                     </xs:element>
-                    <xs:element name="directPredictionSize">
+                    <xs:element name="directPredictionSize" minOccurs="0">
                       <xs:simpleType>
                         <xs:restriction base="xs:string">
                           <xs:enumeration value="4x4"/>



From gruntster at mail.berlios.de  Sat Feb 21 18:26:51 2009
From: gruntster at mail.berlios.de (gruntster at mail.berlios.de)
Date: Sat, 21 Feb 2009 18:26:51 +0100
Subject: [Avidemux-svn-commit] r4618 - in
	branches/avidemux_2.5_branch_gruntster:
	avidemux/ADM_coreImage/include avidemux/ADM_coreImage/src
	cmake cmake/patches plugins
Message-ID: <200902211726.n1LHQpZU008699@sheep.berlios.de>

Author: gruntster
Date: 2009-02-21 18:26:30 +0100 (Sat, 21 Feb 2009)
New Revision: 4618

Modified:
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_coreImage/include/ADM_image.h
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_coreImage/src/ADM_imageResizer.cpp
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_coreImage/src/ADM_rgb.cpp
   branches/avidemux_2.5_branch_gruntster/cmake/admFFmpegBuild.cmake
   branches/avidemux_2.5_branch_gruntster/cmake/patches/libavcodec_avcodec.h.patch
   branches/avidemux_2.5_branch_gruntster/cmake/patches/libavcodec_h264.c.patch
   branches/avidemux_2.5_branch_gruntster/cmake/patches/libavcodec_mpeg12.c.patch
   branches/avidemux_2.5_branch_gruntster/cmake/patches/libavcodec_mpegvideo.c.patch
   branches/avidemux_2.5_branch_gruntster/cmake/patches/libavcodec_utils.c.patch
   branches/avidemux_2.5_branch_gruntster/cmake/patches/libavformat_matroskaenc.c.patch
   branches/avidemux_2.5_branch_gruntster/cmake/patches/libavformat_movenc.c.patch
   branches/avidemux_2.5_branch_gruntster/cmake/patches/libavutil_internal.h.patch
   branches/avidemux_2.5_branch_gruntster/plugins/CMakeLists.txt
Log:
[ffmpeg] update FFmpeg to r17480 & libswscale r28690

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_coreImage/include/ADM_image.h
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_coreImage/include/ADM_image.h	2009-02-21 16:02:13 UTC (rev 4617)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_coreImage/include/ADM_image.h	2009-02-21 17:26:30 UTC (rev 4618)
@@ -25,6 +25,10 @@
 #include "ADM_assert.h"
 #include "ADM_rgb.h"
 
+extern "C" {
+#include "libavutil/avutil.h"
+}
+
 typedef enum 
 {
 	ADM_ASPECT_4_3=1,
@@ -167,11 +171,11 @@
 		uint32_t orgWidth, orgHeight;
 		uint32_t destWidth, destHeight;
 
-		void init(uint32_t ow, uint32_t oh, uint32_t dw, uint32_t dh, int srcFormat, int dstFormat);
+		void init(uint32_t ow, uint32_t oh, uint32_t dw, uint32_t dh, PixelFormat srcFormat, PixelFormat dstFormat);
 		void getYuvPlanes(uint8_t *source, uint32_t width, uint32_t height, uint8_t*& yPlane, uint8_t*& uPlane, uint8_t*& vPlane);
 	public:
 		ADMImageResizer(uint32_t ow,uint32_t oh, uint32_t dw, uint32_t dh);
-		ADMImageResizer(uint32_t ow, uint32_t oh, uint32_t dw, uint32_t dh, int srcFormat, int dstFormat);
+		ADMImageResizer(uint32_t ow, uint32_t oh, uint32_t dw, uint32_t dh, PixelFormat srcFormat, PixelFormat dstFormat);
 		~ADMImageResizer();
 		
 		uint8_t resize(ADMImage *src, ADMImage *dest);

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_coreImage/src/ADM_imageResizer.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_coreImage/src/ADM_imageResizer.cpp	2009-02-21 16:02:13 UTC (rev 4617)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_coreImage/src/ADM_imageResizer.cpp	2009-02-21 17:26:30 UTC (rev 4618)
@@ -26,7 +26,7 @@
 	init(ow, oh, dw, dh, PIX_FMT_YUV420P, PIX_FMT_YUV420P);
 }
 
-ADMImageResizer::ADMImageResizer(uint32_t ow, uint32_t oh, uint32_t dw, uint32_t dh, int srcFormat, int destFormat)
+ADMImageResizer::ADMImageResizer(uint32_t ow, uint32_t oh, uint32_t dw, uint32_t dh, PixelFormat srcFormat, PixelFormat destFormat)
 {
 	init(ow, oh, dw, dh, srcFormat, destFormat);
 }
@@ -40,7 +40,7 @@
    }
 }
 
-void ADMImageResizer::init(uint32_t ow, uint32_t oh, uint32_t dw, uint32_t dh, int srcFormat, int dstFormat)
+void ADMImageResizer::init(uint32_t ow, uint32_t oh, uint32_t dw, uint32_t dh, PixelFormat srcFormat, PixelFormat dstFormat)
 {
     orgWidth = ow;
     orgHeight = oh;
@@ -67,7 +67,7 @@
 	_context = (void *)sws_getContext(orgWidth, orgHeight,
 									  srcFormat,
 									  destWidth, destHeight,
-									  destFormat,
+									  dstFormat,
 									  flags, NULL, NULL,NULL);
 }
 

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_coreImage/src/ADM_rgb.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_coreImage/src/ADM_rgb.cpp	2009-02-21 16:02:13 UTC (rev 4617)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_coreImage/src/ADM_rgb.cpp	2009-02-21 17:26:30 UTC (rev 4618)
@@ -326,7 +326,7 @@
  uint8_t ColRgbToYV12::reset(uint32_t ww, uint32_t hh)
  {
  int flags=0;
- int c;	
+ PixelFormat c;	
     clean();
     FLAGS();
     flags|=SWS_BILINEAR;
@@ -472,7 +472,7 @@
 COL_Generic2YV12::COL_Generic2YV12(uint32_t ww, uint32_t hh,ADM_colorspace col)
 {
 int flags=0;
-int c=0; 
+PixelFormat c; 
 
         FLAGS();
         flags|=SWS_BILINEAR;

Modified: branches/avidemux_2.5_branch_gruntster/cmake/admFFmpegBuild.cmake
===================================================================
--- branches/avidemux_2.5_branch_gruntster/cmake/admFFmpegBuild.cmake	2009-02-21 16:02:13 UTC (rev 4617)
+++ branches/avidemux_2.5_branch_gruntster/cmake/admFFmpegBuild.cmake	2009-02-21 17:26:30 UTC (rev 4618)
@@ -1,8 +1,8 @@
 include(admFFmpegUtil)
 find_package(Subversion)
 
-set(FFMPEG_VERSION 16945)
-set(SWSCALE_VERSION 28447)
+set(FFMPEG_VERSION 17480)
+set(SWSCALE_VERSION 28690)
 set(FFMPEG_SOURCE_DIR "${CMAKE_SOURCE_DIR}/avidemux/ADM_libraries/ffmpeg")
 set(FFMPEG_BINARY_DIR "${CMAKE_BINARY_DIR}/avidemux/ADM_libraries/ffmpeg")
 

Modified: branches/avidemux_2.5_branch_gruntster/cmake/patches/libavcodec_avcodec.h.patch
===================================================================
--- branches/avidemux_2.5_branch_gruntster/cmake/patches/libavcodec_avcodec.h.patch	2009-02-21 16:02:13 UTC (rev 4617)
+++ branches/avidemux_2.5_branch_gruntster/cmake/patches/libavcodec_avcodec.h.patch	2009-02-21 17:26:30 UTC (rev 4618)
@@ -1,8 +1,8 @@
-*** libavcodec/avcodec.h.old	Mon Feb  2 19:49:48 2009
---- libavcodec/avcodec.h	Mon Feb  2 19:49:47 2009
+*** libavcodec/avcodec.h.old	Sat Feb 21 16:10:58 2009
+--- libavcodec/avcodec.h	Sat Feb 21 16:10:57 2009
 ***************
-*** 500,505 ****
---- 500,507 ----
+*** 501,506 ****
+--- 501,508 ----
   #define CODEC_FLAG2_CHUNKS        0x00008000 ///< Input bitstream might be truncated at a packet boundaries instead of only at frame boundaries.
   #define CODEC_FLAG2_NON_LINEAR_QUANT 0x00010000 ///< Use MPEG-2 nonlinear quantizer.
   #define CODEC_FLAG2_BIT_RESERVOIR 0x00020000 ///< Use a bit reservoir when encoding if possible
@@ -12,8 +12,8 @@
   /* Unsupported options :
    *              Syntax Arithmetic coding (SAC)
 ***************
-*** 1281,1286 ****
---- 1283,1289 ----
+*** 1290,1295 ****
+--- 1292,1298 ----
        * - decoding: unused
        */
       int rc_max_rate;
@@ -22,8 +22,8 @@
       /**
        * minimum bitrate
 ***************
-*** 1295,1300 ****
---- 1298,1305 ----
+*** 1304,1309 ****
+--- 1307,1314 ----
        * - decoding: unused
        */
       int rc_buffer_size;

Modified: branches/avidemux_2.5_branch_gruntster/cmake/patches/libavcodec_h264.c.patch
===================================================================
--- branches/avidemux_2.5_branch_gruntster/cmake/patches/libavcodec_h264.c.patch	2009-02-21 16:02:13 UTC (rev 4617)
+++ branches/avidemux_2.5_branch_gruntster/cmake/patches/libavcodec_h264.c.patch	2009-02-21 17:26:30 UTC (rev 4618)
@@ -1,8 +1,8 @@
-*** libavcodec/h264.c.old	Mon Feb  2 19:49:51 2009
---- libavcodec/h264.c	Mon Feb  2 19:49:50 2009
+*** libavcodec/h264.c.old	Sat Feb 21 16:11:02 2009
+--- libavcodec/h264.c	Sat Feb 21 16:11:02 2009
 ***************
-*** 8010,8015 ****
---- 8010,8026 ----
+*** 8091,8096 ****
+--- 8091,8107 ----
       return 0;
   }
   

Modified: branches/avidemux_2.5_branch_gruntster/cmake/patches/libavcodec_mpeg12.c.patch
===================================================================
--- branches/avidemux_2.5_branch_gruntster/cmake/patches/libavcodec_mpeg12.c.patch	2009-02-21 16:02:13 UTC (rev 4617)
+++ branches/avidemux_2.5_branch_gruntster/cmake/patches/libavcodec_mpeg12.c.patch	2009-02-21 17:26:30 UTC (rev 4618)
@@ -1,8 +1,8 @@
-*** libavcodec/mpeg12.c.old	Mon Feb  2 19:49:52 2009
---- libavcodec/mpeg12.c	Mon Feb  2 19:49:51 2009
+*** libavcodec/mpeg12.c.old	Sat Feb 21 16:11:03 2009
+--- libavcodec/mpeg12.c	Sat Feb 21 16:11:03 2009
 ***************
-*** 1937,1942 ****
---- 1937,1947 ----
+*** 1922,1927 ****
+--- 1922,1932 ----
           ff_er_frame_end(s);
   
           MPV_frame_end(s);

Modified: branches/avidemux_2.5_branch_gruntster/cmake/patches/libavcodec_mpegvideo.c.patch
===================================================================
--- branches/avidemux_2.5_branch_gruntster/cmake/patches/libavcodec_mpegvideo.c.patch	2009-02-21 16:02:13 UTC (rev 4617)
+++ branches/avidemux_2.5_branch_gruntster/cmake/patches/libavcodec_mpegvideo.c.patch	2009-02-21 17:26:30 UTC (rev 4618)
@@ -1,7 +1,7 @@
-*** libavcodec/mpegvideo.c.old	Sun Jan 25 00:55:19 2009
---- libavcodec/mpegvideo.c	Sun Jan 25 00:55:19 2009
+*** libavcodec/mpegvideo.c.old	Sat Feb 21 16:11:05 2009
+--- libavcodec/mpegvideo.c	Sat Feb 21 16:11:05 2009
 ***************
-*** 561,567 ****
+*** 563,569 ****
       CHECKED_ALLOCZ(s->prev_pict_types, PREV_PICT_TYPES_BUFFER_SIZE);
   
       s->parse_context.state= -1;
@@ -9,7 +9,7 @@
          s->visualization_buffer[0] = av_malloc((s->mb_width*16 + 2*EDGE_WIDTH) * s->mb_height*16 + 2*EDGE_WIDTH);
          s->visualization_buffer[1] = av_malloc((s->mb_width*16 + 2*EDGE_WIDTH) * s->mb_height*16 + 2*EDGE_WIDTH);
          s->visualization_buffer[2] = av_malloc((s->mb_width*16 + 2*EDGE_WIDTH) * s->mb_height*16 + 2*EDGE_WIDTH);
---- 561,571 ----
+--- 563,573 ----
       CHECKED_ALLOCZ(s->prev_pict_types, PREV_PICT_TYPES_BUFFER_SIZE);
   
       s->parse_context.state= -1;

Modified: branches/avidemux_2.5_branch_gruntster/cmake/patches/libavcodec_utils.c.patch
===================================================================
--- branches/avidemux_2.5_branch_gruntster/cmake/patches/libavcodec_utils.c.patch	2009-02-21 16:02:13 UTC (rev 4617)
+++ branches/avidemux_2.5_branch_gruntster/cmake/patches/libavcodec_utils.c.patch	2009-02-21 17:26:30 UTC (rev 4618)
@@ -1,8 +1,8 @@
-*** libavcodec/utils.c.old	Mon Feb  2 19:49:56 2009
---- libavcodec/utils.c	Mon Feb  2 19:49:55 2009
+*** libavcodec/utils.c.old	Sat Feb 21 16:11:07 2009
+--- libavcodec/utils.c	Sat Feb 21 16:11:07 2009
 ***************
-*** 526,535 ****
---- 526,537 ----
+*** 543,552 ****
+--- 543,554 ----
   
       if((avctx->codec->capabilities & CODEC_CAP_DELAY) || buf_size){
           //FIXME remove the check below _after_ ensuring that all audio check that the available space is enough
@@ -16,7 +16,7 @@
           *frame_size_ptr < avctx->channels * avctx->frame_size * sizeof(int16_t)){
               av_log(avctx, AV_LOG_ERROR, "buffer %d too small\n", *frame_size_ptr);
 ***************
-*** 940,946 ****
+*** 957,963 ****
           return -1;
       }
   #if !HAVE_MKSTEMP
@@ -24,7 +24,7 @@
   #else
       snprintf(*filename, len, "/tmp/%sXXXXXX", prefix);
       fd = mkstemp(*filename);
---- 942,948 ----
+--- 959,965 ----
           return -1;
       }
   #if !HAVE_MKSTEMP

Modified: branches/avidemux_2.5_branch_gruntster/cmake/patches/libavformat_matroskaenc.c.patch
===================================================================
--- branches/avidemux_2.5_branch_gruntster/cmake/patches/libavformat_matroskaenc.c.patch	2009-02-21 16:02:13 UTC (rev 4617)
+++ branches/avidemux_2.5_branch_gruntster/cmake/patches/libavformat_matroskaenc.c.patch	2009-02-21 17:26:30 UTC (rev 4618)
@@ -1,5 +1,5 @@
-*** libavformat/matroskaenc.c.old	Mon Feb  2 19:50:00 2009
---- libavformat/matroskaenc.c	Mon Feb  2 19:49:59 2009
+*** libavformat/matroskaenc.c.old	Sat Feb 21 16:11:12 2009
+--- libavformat/matroskaenc.c	Sat Feb 21 16:11:12 2009
 ***************
 *** 394,399 ****
 --- 394,400 ----
@@ -42,8 +42,8 @@
   
   #define FLAC_STREAMINFO_SIZE 34
 ***************
-*** 554,559 ****
---- 577,599 ----
+*** 555,560 ****
+--- 578,600 ----
           put_ebml_uint (pb, MATROSKA_ID_TRACKNUMBER     , i + 1);
           put_ebml_uint (pb, MATROSKA_ID_TRACKUID        , i + 1);
           put_ebml_uint (pb, MATROSKA_ID_TRACKFLAGLACING , 0);    // no lacing (yet)
@@ -65,11 +65,11 @@
 +         
 + /**  MEANX : Add a default duration for video **/
   
-          if (st->language[0])
-              put_ebml_string(pb, MATROSKA_ID_TRACKLANGUAGE, st->language);
+          if ((tag = av_metadata_get(st->metadata, "description", NULL, 0)))
+              put_ebml_string(pb, MATROSKA_ID_TRACKNAME, tag->value);
 ***************
-*** 926,928 ****
---- 966,978 ----
+*** 928,930 ****
+--- 968,980 ----
       .flags = AVFMT_GLOBALHEADER,
       .codec_tag = (const AVCodecTag* const []){codec_wav_tags, 0},
   };

Modified: branches/avidemux_2.5_branch_gruntster/cmake/patches/libavformat_movenc.c.patch
===================================================================
--- branches/avidemux_2.5_branch_gruntster/cmake/patches/libavformat_movenc.c.patch	2009-02-21 16:02:13 UTC (rev 4617)
+++ branches/avidemux_2.5_branch_gruntster/cmake/patches/libavformat_movenc.c.patch	2009-02-21 17:26:30 UTC (rev 4618)
@@ -1,8 +1,8 @@
-*** libavformat/movenc.c.old	Mon Feb  2 19:50:01 2009
---- libavformat/movenc.c	Mon Feb  2 19:50:00 2009
+*** libavformat/movenc.c.old	Sat Feb 21 16:11:13 2009
+--- libavformat/movenc.c	Sat Feb 21 16:11:13 2009
 ***************
-*** 1913,1915 ****
---- 1913,1927 ----
+*** 1925,1927 ****
+--- 1925,1939 ----
       .codec_tag = (const AVCodecTag* const []){ff_mp4_obj_type, 0},
   };
   #endif

Modified: branches/avidemux_2.5_branch_gruntster/cmake/patches/libavutil_internal.h.patch
===================================================================
--- branches/avidemux_2.5_branch_gruntster/cmake/patches/libavutil_internal.h.patch	2009-02-21 16:02:13 UTC (rev 4617)
+++ branches/avidemux_2.5_branch_gruntster/cmake/patches/libavutil_internal.h.patch	2009-02-21 17:26:30 UTC (rev 4618)
@@ -1,8 +1,8 @@
-*** libavutil/internal.h.old	Mon Feb  2 19:50:03 2009
---- libavutil/internal.h	Mon Feb  2 19:50:02 2009
+*** libavutil/internal.h.old	Sat Feb 21 16:11:15 2009
+--- libavutil/internal.h	Sat Feb 21 16:11:15 2009
 ***************
-*** 219,230 ****
---- 219,232 ----
+*** 215,226 ****
+--- 215,228 ----
   #endif
   
   /* avoid usage of dangerous/inappropriate system functions */

Modified: branches/avidemux_2.5_branch_gruntster/plugins/CMakeLists.txt
===================================================================
--- branches/avidemux_2.5_branch_gruntster/plugins/CMakeLists.txt	2009-02-21 16:02:13 UTC (rev 4617)
+++ branches/avidemux_2.5_branch_gruntster/plugins/CMakeLists.txt	2009-02-21 17:26:30 UTC (rev 4618)
@@ -32,6 +32,7 @@
 ENDIF (NOT AVIDEMUX_SOURCE_DIR)
 
 INCLUDE_DIRECTORIES(${AVIDEMUX_SOURCE_DIR})
+INCLUDE_DIRECTORIES("${AVIDEMUX_SOURCE_DIR}/avidemux/ADM_libraries/ffmpeg")
 
 ########################################
 # Where are the libraries



From gruntster at mail.berlios.de  Sun Feb 22 12:24:28 2009
From: gruntster at mail.berlios.de (gruntster at mail.berlios.de)
Date: Sun, 22 Feb 2009 12:24:28 +0100
Subject: [Avidemux-svn-commit] r4619 -
	branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_x264
Message-ID: <200902221124.n1MBOSiT016076@sheep.berlios.de>

Author: gruntster
Date: 2009-02-22 12:24:22 +0100 (Sun, 22 Feb 2009)
New Revision: 4619

Modified:
   branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_x264/encoder.cpp
Log:
[x264] close encoder at end of pass, not end of encoding

Modified: branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_x264/encoder.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_x264/encoder.cpp	2009-02-21 17:26:30 UTC (rev 4618)
+++ branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_x264/encoder.cpp	2009-02-22 11:24:22 UTC (rev 4619)
@@ -507,6 +507,12 @@
 	if (!_opened)
 		return ADM_VIDENC_ERR_CLOSED;
 
+	if (_handle)
+	{
+		x264_encoder_close(_handle);
+		_handle = NULL;
+	}
+
 	if (_openPass)
 		_openPass = false;
 
@@ -532,12 +538,6 @@
 
 	_opened = false;
 
-	if (_handle)
-	{
-		x264_encoder_close(_handle);
-		_handle = NULL;
-	}
-
 	if (_buffer)
 	{
 		delete [] _buffer;



From gruntster at mail.berlios.de  Sun Feb 22 13:12:51 2009
From: gruntster at mail.berlios.de (gruntster at mail.berlios.de)
Date: Sun, 22 Feb 2009 13:12:51 +0100
Subject: [Avidemux-svn-commit] r4620 -
	branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_x264/qt4
Message-ID: <200902221212.n1MCCp6R025226@sheep.berlios.de>

Author: gruntster
Date: 2009-02-22 13:12:46 +0100 (Sun, 22 Feb 2009)
New Revision: 4620

Modified:
   branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_x264/qt4/x264ConfigDialog.cpp
   branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_x264/qt4/x264ConfigDialog.ui
Log:
[x264] support extra adaptive b-frame decision option

Modified: branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_x264/qt4/x264ConfigDialog.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_x264/qt4/x264ConfigDialog.cpp	2009-02-22 11:24:22 UTC (rev 4619)
+++ branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_x264/qt4/x264ConfigDialog.cpp	2009-02-22 12:12:46 UTC (rev 4620)
@@ -99,6 +99,12 @@
 	connect(ui.loopFilterCheckBox, SIGNAL(toggled(bool)), this, SLOT(loopFilterCheckBox_toggled(bool)));
 	connect(ui.cabacCheckBox, SIGNAL(toggled(bool)), this, SLOT(cabacCheckBox_toggled(bool)));
 
+#if X264_BUILD < 63
+	ui.adaptiveBFrameComboBox->clear();
+	ui.adaptiveBFrameComboBox->addItem(QT_TR_NOOP("Disabled"));
+	ui.adaptiveBFrameComboBox->addItem(QT_TR_NOOP("Enabled"));
+#endif
+
 	// Analysis tab
 	connect(ui.trellisCheckBox, SIGNAL(toggled(bool)), this, SLOT(trellisCheckBox_toggled(bool)));
 	connect(ui.matrixCustomEditButton, SIGNAL(pressed()), this, SLOT(matrixCustomEditButton_pressed()));
@@ -667,7 +673,7 @@
 	ui.BFrameBiasSpinBox->setValue(options->getBFrameBias());
 	ui.refFramesSpinBox->setValue(options->getReferenceFrames());
 	ui.bFrameRefCheckBox->setChecked(options->getBFrameReferences());
-	ui.adaptiveBFrameCheckBox->setChecked(options->getAdaptiveBFrameDecision());
+	ui.adaptiveBFrameComboBox->setCurrentIndex(options->getAdaptiveBFrameDecision());
 	ui.maxGopSizeSpinBox->setValue(options->getGopMaximumSize());
 	ui.minGopSizeSpinBox->setValue(options->getGopMaximumSize());
 	ui.IFrameThresholdSpinBox->setValue(options->getScenecutThreshold());
@@ -875,7 +881,7 @@
 	options->setBFrameBias(ui.BFrameBiasSpinBox->value());
 	options->setReferenceFrames(ui.refFramesSpinBox->value());
 	options->setBFrameReferences(ui.bFrameRefCheckBox->isChecked());
-	options->setAdaptiveBFrameDecision(ui.adaptiveBFrameCheckBox->isChecked());
+	options->setAdaptiveBFrameDecision(ui.adaptiveBFrameComboBox->currentIndex());
 	options->setGopMaximumSize(ui.maxGopSizeSpinBox->value());
 	options->setGopMaximumSize(ui.minGopSizeSpinBox->value());
 	options->setScenecutThreshold(ui.IFrameThresholdSpinBox->value());

Modified: branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_x264/qt4/x264ConfigDialog.ui
===================================================================
--- branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_x264/qt4/x264ConfigDialog.ui	2009-02-22 11:24:22 UTC (rev 4619)
+++ branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_x264/qt4/x264ConfigDialog.ui	2009-02-22 12:12:46 UTC (rev 4620)
@@ -101,7 +101,7 @@
      <property name="sizeHint" >
       <size>
        <width>491</width>
-       <height>16</height>
+       <height>10</height>
       </size>
      </property>
     </spacer>
@@ -1713,6 +1713,13 @@
               </property>
              </widget>
             </item>
+            <item row="2" column="0" >
+             <widget class="QLabel" name="label_4" >
+              <property name="text" >
+               <string>Adaptive B-frame Decision:</string>
+              </property>
+             </widget>
+            </item>
             <item row="1" column="0" >
              <widget class="QLabel" name="label_29" >
               <property name="text" >
@@ -1720,6 +1727,48 @@
               </property>
              </widget>
             </item>
+            <item row="2" column="1" >
+             <layout class="QHBoxLayout" >
+              <property name="margin" >
+               <number>0</number>
+              </property>
+              <property name="spacing" >
+               <number>6</number>
+              </property>
+              <item>
+               <widget class="QComboBox" name="adaptiveBFrameComboBox" >
+                <item>
+                 <property name="text" >
+                  <string>Disabled</string>
+                 </property>
+                </item>
+                <item>
+                 <property name="text" >
+                  <string>Fast</string>
+                 </property>
+                </item>
+                <item>
+                 <property name="text" >
+                  <string>Optimal</string>
+                 </property>
+                </item>
+               </widget>
+              </item>
+              <item>
+               <spacer>
+                <property name="orientation" >
+                 <enum>Qt::Horizontal</enum>
+                </property>
+                <property name="sizeHint" >
+                 <size>
+                  <width>40</width>
+                  <height>20</height>
+                 </size>
+                </property>
+               </spacer>
+              </item>
+             </layout>
+            </item>
             <item row="1" column="1" >
              <layout class="QHBoxLayout" >
               <property name="margin" >
@@ -1808,28 +1857,11 @@
            </spacer>
           </item>
           <item>
-           <layout class="QVBoxLayout" >
-            <property name="margin" >
-             <number>0</number>
+           <widget class="QCheckBox" name="bFrameRefCheckBox" >
+            <property name="text" >
+             <string>Use B-frames as References</string>
             </property>
-            <property name="spacing" >
-             <number>6</number>
-            </property>
-            <item>
-             <widget class="QCheckBox" name="bFrameRefCheckBox" >
-              <property name="text" >
-               <string>Use B-frames as References</string>
-              </property>
-             </widget>
-            </item>
-            <item>
-             <widget class="QCheckBox" name="adaptiveBFrameCheckBox" >
-              <property name="text" >
-               <string>Adaptive B-frame Decision</string>
-              </property>
-             </widget>
-            </item>
-           </layout>
+           </widget>
           </item>
          </layout>
         </widget>
@@ -4143,10 +4175,14 @@
   <tabstop>sarPredefinedRadioButton</tabstop>
   <tabstop>sarPredefinedComboBox</tabstop>
   <tabstop>sarAsInputRadioButton</tabstop>
+  <tabstop>threadDisableRadioButton</tabstop>
+  <tabstop>threadAutoDetectRadioButton</tabstop>
+  <tabstop>threadCustomRadioButton</tabstop>
+  <tabstop>threadCustomSpinBox</tabstop>
+  <tabstop>meMethodComboBox</tabstop>
   <tabstop>meSlider</tabstop>
   <tabstop>meSpinBox</tabstop>
   <tabstop>rdoCheckBox</tabstop>
-  <tabstop>meMethodComboBox</tabstop>
   <tabstop>mvRangeSpinBox</tabstop>
   <tabstop>mvLengthCheckBox</tabstop>
   <tabstop>mvLengthSpinBox</tabstop>
@@ -4155,16 +4191,22 @@
   <tabstop>predictModeComboBox</tabstop>
   <tabstop>predictSizeComboBox</tabstop>
   <tabstop>weightedPredictCheckBox</tabstop>
+  <tabstop>dct8x8CheckBox</tabstop>
+  <tabstop>p8x8CheckBox</tabstop>
+  <tabstop>b8x8CheckBox</tabstop>
+  <tabstop>p4x4CheckBox</tabstop>
+  <tabstop>i8x8CheckBox</tabstop>
+  <tabstop>i4x4CheckBox</tabstop>
   <tabstop>cabacCheckBox</tabstop>
   <tabstop>interlacedCheckBox</tabstop>
   <tabstop>loopFilterCheckBox</tabstop>
   <tabstop>alphaC0SpinBox</tabstop>
   <tabstop>betaSpinBox</tabstop>
+  <tabstop>refFramesSpinBox</tabstop>
   <tabstop>maxBFramesSpinBox</tabstop>
   <tabstop>BFrameBiasSpinBox</tabstop>
-  <tabstop>refFramesSpinBox</tabstop>
+  <tabstop>adaptiveBFrameComboBox</tabstop>
   <tabstop>bFrameRefCheckBox</tabstop>
-  <tabstop>adaptiveBFrameCheckBox</tabstop>
   <tabstop>maxGopSizeSpinBox</tabstop>
   <tabstop>minGopSizeSpinBox</tabstop>
   <tabstop>IFrameThresholdSpinBox</tabstop>
@@ -4186,12 +4228,19 @@
   <tabstop>quantiserMinSpinBox</tabstop>
   <tabstop>quantiserMaxSpinBox</tabstop>
   <tabstop>quantiserMaxStepSpinBox</tabstop>
+  <tabstop>avgBitrateToleranceSpinBox</tabstop>
   <tabstop>quantiserIpRatioSpinBox</tabstop>
   <tabstop>quantiserPbRatioSpinBox</tabstop>
   <tabstop>chromaLumaOffsetSpinBox</tabstop>
   <tabstop>quantiserCurveCompressSpinBox</tabstop>
   <tabstop>quantiserBeforeCompressSpinBox</tabstop>
   <tabstop>quantiserAfterCompressSpinBox</tabstop>
+  <tabstop>aqVarianceCheckBox</tabstop>
+  <tabstop>aqStrengthSpinBox</tabstop>
+  <tabstop>vbvMaxBitrateSpinBox</tabstop>
+  <tabstop>vbvBufferSizeSpinBox</tabstop>
+  <tabstop>vbvBufferOccupancySpinBox</tabstop>
+  <tabstop>zoneTableView</tabstop>
   <tabstop>zoneAddButton</tabstop>
   <tabstop>zoneEditButton</tabstop>
   <tabstop>zoneDeleteButton</tabstop>
@@ -4208,6 +4257,9 @@
   <tabstop>fullRangeSamplesCheckBox</tabstop>
   <tabstop>okButton</tabstop>
   <tabstop>cancelButton</tabstop>
+  <tabstop>configurationComboBox</tabstop>
+  <tabstop>saveAsButton</tabstop>
+  <tabstop>deleteButton</tabstop>
  </tabstops>
  <resources/>
  <connections>



From gruntster at mail.berlios.de  Sun Feb 22 14:14:54 2009
From: gruntster at mail.berlios.de (gruntster at mail.berlios.de)
Date: Sun, 22 Feb 2009 14:14:54 +0100
Subject: [Avidemux-svn-commit] r4621 - in
	branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters:
	Contrast/qt4 Eq2/qt4
Message-ID: <200902221314.n1MDEsjt012920@sheep.berlios.de>

Author: gruntster
Date: 2009-02-22 14:14:48 +0100 (Sun, 22 Feb 2009)
New Revision: 4621

Modified:
   branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/Contrast/qt4/contrast.ui
   branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/Eq2/qt4/eq2.ui
Log:
[filter] add spinboxes to Contrast and MPlayer eq2 configure windows for Qt

Modified: branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/Contrast/qt4/contrast.ui
===================================================================
--- branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/Contrast/qt4/contrast.ui	2009-02-22 12:12:46 UTC (rev 4620)
+++ branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/Contrast/qt4/contrast.ui	2009-02-22 13:14:48 UTC (rev 4621)
@@ -12,175 +12,315 @@
   <property name="windowTitle" >
    <string>Contrast</string>
   </property>
-  <layout class="QGridLayout" >
-   <property name="leftMargin" >
+  <layout class="QVBoxLayout" >
+   <property name="margin" >
     <number>9</number>
    </property>
-   <property name="topMargin" >
-    <number>9</number>
-   </property>
-   <property name="rightMargin" >
-    <number>9</number>
-   </property>
-   <property name="bottomMargin" >
-    <number>9</number>
-   </property>
-   <property name="horizontalSpacing" >
+   <property name="spacing" >
     <number>6</number>
    </property>
-   <property name="verticalSpacing" >
-    <number>6</number>
-   </property>
-   <item row="3" column="2" >
-    <spacer>
-     <property name="orientation" >
-      <enum>Qt::Vertical</enum>
+   <item>
+    <layout class="QHBoxLayout" >
+     <property name="margin" >
+      <number>0</number>
      </property>
-     <property name="sizeType" >
-      <enum>QSizePolicy::Ignored</enum>
-     </property>
-     <property name="sizeHint" >
-      <size>
-       <width>20</width>
-       <height>40</height>
-      </size>
-     </property>
-    </spacer>
-   </item>
-   <item row="2" column="0" colspan="3" >
-    <widget class="QGraphicsView" name="graphicsView" />
-   </item>
-   <item row="1" column="0" colspan="3" >
-    <widget class="QSlider" name="horizontalSlider" >
-     <property name="orientation" >
-      <enum>Qt::Horizontal</enum>
-     </property>
-    </widget>
-   </item>
-   <item row="4" column="0" colspan="3" >
-    <widget class="QDialogButtonBox" name="buttonBox" >
-     <property name="orientation" >
-      <enum>Qt::Horizontal</enum>
-     </property>
-     <property name="standardButtons" >
-      <set>QDialogButtonBox::Cancel|QDialogButtonBox::NoButton|QDialogButtonBox::Ok</set>
-     </property>
-    </widget>
-   </item>
-   <item row="0" column="1" >
-    <layout class="QVBoxLayout" >
      <property name="spacing" >
       <number>6</number>
      </property>
-     <property name="leftMargin" >
-      <number>0</number>
-     </property>
-     <property name="topMargin" >
-      <number>0</number>
-     </property>
-     <property name="rightMargin" >
-      <number>0</number>
-     </property>
-     <property name="bottomMargin" >
-      <number>0</number>
-     </property>
      <item>
-      <widget class="QCheckBox" name="checkBoxY" >
-       <property name="text" >
-        <string>Luma</string>
+      <layout class="QVBoxLayout" >
+       <property name="margin" >
+        <number>0</number>
        </property>
-      </widget>
-     </item>
-     <item>
-      <widget class="QCheckBox" name="checkBoxU" >
-       <property name="text" >
-        <string>ChromaU</string>
+       <property name="spacing" >
+        <number>6</number>
        </property>
-      </widget>
+       <item>
+        <widget class="QLabel" name="label" >
+         <property name="text" >
+          <string>Contrast:</string>
+         </property>
+        </widget>
+       </item>
+       <item>
+        <layout class="QHBoxLayout" >
+         <property name="margin" >
+          <number>0</number>
+         </property>
+         <property name="spacing" >
+          <number>6</number>
+         </property>
+         <item>
+          <widget class="QSlider" name="horizontalSliderContrast" >
+           <property name="minimum" >
+            <number>5</number>
+           </property>
+           <property name="maximum" >
+            <number>15</number>
+           </property>
+           <property name="orientation" >
+            <enum>Qt::Horizontal</enum>
+           </property>
+          </widget>
+         </item>
+         <item>
+          <spacer>
+           <property name="orientation" >
+            <enum>Qt::Horizontal</enum>
+           </property>
+           <property name="sizeType" >
+            <enum>QSizePolicy::Fixed</enum>
+           </property>
+           <property name="sizeHint" >
+            <size>
+             <width>2</width>
+             <height>20</height>
+            </size>
+           </property>
+          </spacer>
+         </item>
+         <item>
+          <widget class="QSpinBox" name="contrastSpinBox" >
+           <property name="maximum" >
+            <number>15</number>
+           </property>
+           <property name="minimum" >
+            <number>5</number>
+           </property>
+          </widget>
+         </item>
+        </layout>
+       </item>
+       <item>
+        <widget class="QLabel" name="label_2" >
+         <property name="text" >
+          <string>Brightness:</string>
+         </property>
+        </widget>
+       </item>
+       <item>
+        <layout class="QHBoxLayout" >
+         <property name="margin" >
+          <number>0</number>
+         </property>
+         <property name="spacing" >
+          <number>6</number>
+         </property>
+         <item>
+          <widget class="QSlider" name="horizontalSliderBrightness" >
+           <property name="minimum" >
+            <number>-127</number>
+           </property>
+           <property name="maximum" >
+            <number>127</number>
+           </property>
+           <property name="orientation" >
+            <enum>Qt::Horizontal</enum>
+           </property>
+          </widget>
+         </item>
+         <item>
+          <spacer>
+           <property name="orientation" >
+            <enum>Qt::Horizontal</enum>
+           </property>
+           <property name="sizeType" >
+            <enum>QSizePolicy::Fixed</enum>
+           </property>
+           <property name="sizeHint" >
+            <size>
+             <width>2</width>
+             <height>20</height>
+            </size>
+           </property>
+          </spacer>
+         </item>
+         <item>
+          <widget class="QSpinBox" name="brightnessSpinBox" >
+           <property name="maximum" >
+            <number>127</number>
+           </property>
+           <property name="minimum" >
+            <number>-127</number>
+           </property>
+          </widget>
+         </item>
+        </layout>
+       </item>
+       <item>
+        <spacer>
+         <property name="orientation" >
+          <enum>Qt::Vertical</enum>
+         </property>
+         <property name="sizeType" >
+          <enum>QSizePolicy::Expanding</enum>
+         </property>
+         <property name="sizeHint" >
+          <size>
+           <width>20</width>
+           <height>1</height>
+          </size>
+         </property>
+        </spacer>
+       </item>
+      </layout>
      </item>
      <item>
-      <widget class="QCheckBox" name="checkBoxV" >
-       <property name="text" >
-        <string>ChromaV</string>
+      <spacer>
+       <property name="orientation" >
+        <enum>Qt::Horizontal</enum>
        </property>
-      </widget>
-     </item>
-    </layout>
-   </item>
-   <item row="0" column="0" >
-    <layout class="QVBoxLayout" >
-     <property name="spacing" >
-      <number>6</number>
-     </property>
-     <property name="leftMargin" >
-      <number>0</number>
-     </property>
-     <property name="topMargin" >
-      <number>0</number>
-     </property>
-     <property name="rightMargin" >
-      <number>0</number>
-     </property>
-     <property name="bottomMargin" >
-      <number>0</number>
-     </property>
-     <item>
-      <widget class="QLabel" name="label" >
-       <property name="text" >
-        <string>Contrast</string>
+       <property name="sizeType" >
+        <enum>QSizePolicy::Fixed</enum>
        </property>
-      </widget>
+       <property name="sizeHint" >
+        <size>
+         <width>20</width>
+         <height>20</height>
+        </size>
+       </property>
+      </spacer>
      </item>
      <item>
-      <widget class="QSlider" name="horizontalSliderContrast" >
-       <property name="minimum" >
-        <number>5</number>
+      <layout class="QVBoxLayout" >
+       <property name="margin" >
+        <number>0</number>
        </property>
-       <property name="maximum" >
-        <number>15</number>
+       <property name="spacing" >
+        <number>6</number>
        </property>
-       <property name="orientation" >
-        <enum>Qt::Horizontal</enum>
-       </property>
-      </widget>
+       <item>
+        <widget class="QGroupBox" name="groupBox" >
+         <property name="title" >
+          <string>Colour Space</string>
+         </property>
+         <layout class="QVBoxLayout" >
+          <property name="margin" >
+           <number>9</number>
+          </property>
+          <property name="spacing" >
+           <number>6</number>
+          </property>
+          <item>
+           <widget class="QCheckBox" name="checkBoxY" >
+            <property name="text" >
+             <string>Luma</string>
+            </property>
+           </widget>
+          </item>
+          <item>
+           <widget class="QCheckBox" name="checkBoxU" >
+            <property name="text" >
+             <string>ChromaU</string>
+            </property>
+           </widget>
+          </item>
+          <item>
+           <widget class="QCheckBox" name="checkBoxV" >
+            <property name="text" >
+             <string>ChromaV</string>
+            </property>
+           </widget>
+          </item>
+         </layout>
+        </widget>
+       </item>
+       <item>
+        <spacer>
+         <property name="orientation" >
+          <enum>Qt::Vertical</enum>
+         </property>
+         <property name="sizeHint" >
+          <size>
+           <width>20</width>
+           <height>40</height>
+          </size>
+         </property>
+        </spacer>
+       </item>
+      </layout>
      </item>
      <item>
-      <widget class="QLabel" name="label_2" >
-       <property name="text" >
-        <string>Brightness</string>
-       </property>
-      </widget>
-     </item>
-     <item>
-      <widget class="QSlider" name="horizontalSliderBrightness" >
-       <property name="minimum" >
-        <number>-127</number>
-       </property>
-       <property name="maximum" >
-        <number>127</number>
-       </property>
+      <spacer>
        <property name="orientation" >
         <enum>Qt::Horizontal</enum>
        </property>
-      </widget>
+       <property name="sizeHint" >
+        <size>
+         <width>101</width>
+         <height>86</height>
+        </size>
+       </property>
+      </spacer>
      </item>
     </layout>
    </item>
-   <item row="0" column="2" >
-    <spacer>
+   <item>
+    <widget class="QSlider" name="horizontalSlider" >
      <property name="orientation" >
       <enum>Qt::Horizontal</enum>
      </property>
+    </widget>
+   </item>
+   <item>
+    <widget class="QGraphicsView" name="graphicsView" />
+   </item>
+   <item>
+    <spacer>
+     <property name="orientation" >
+      <enum>Qt::Vertical</enum>
+     </property>
+     <property name="sizeType" >
+      <enum>QSizePolicy::Fixed</enum>
+     </property>
      <property name="sizeHint" >
       <size>
-       <width>40</width>
-       <height>20</height>
+       <width>20</width>
+       <height>16</height>
       </size>
      </property>
     </spacer>
    </item>
+   <item>
+    <spacer>
+     <property name="orientation" >
+      <enum>Qt::Vertical</enum>
+     </property>
+     <property name="sizeType" >
+      <enum>QSizePolicy::Ignored</enum>
+     </property>
+     <property name="sizeHint" >
+      <size>
+       <width>20</width>
+       <height>16</height>
+      </size>
+     </property>
+    </spacer>
+   </item>
+   <item>
+    <widget class="QDialogButtonBox" name="buttonBox" >
+     <property name="orientation" >
+      <enum>Qt::Horizontal</enum>
+     </property>
+     <property name="standardButtons" >
+      <set>QDialogButtonBox::Cancel|QDialogButtonBox::NoButton|QDialogButtonBox::Ok</set>
+     </property>
+    </widget>
+   </item>
   </layout>
  </widget>
+ <tabstops>
+  <tabstop>horizontalSliderContrast</tabstop>
+  <tabstop>contrastSpinBox</tabstop>
+  <tabstop>horizontalSliderBrightness</tabstop>
+  <tabstop>brightnessSpinBox</tabstop>
+  <tabstop>checkBoxY</tabstop>
+  <tabstop>checkBoxU</tabstop>
+  <tabstop>checkBoxV</tabstop>
+  <tabstop>horizontalSlider</tabstop>
+  <tabstop>graphicsView</tabstop>
+  <tabstop>buttonBox</tabstop>
+ </tabstops>
  <resources/>
  <connections>
   <connection>
@@ -215,5 +355,69 @@
     </hint>
    </hints>
   </connection>
+  <connection>
+   <sender>horizontalSliderContrast</sender>
+   <signal>valueChanged(int)</signal>
+   <receiver>contrastSpinBox</receiver>
+   <slot>setValue(int)</slot>
+   <hints>
+    <hint type="sourcelabel" >
+     <x>87</x>
+     <y>69</y>
+    </hint>
+    <hint type="destinationlabel" >
+     <x>190</x>
+     <y>69</y>
+    </hint>
+   </hints>
+  </connection>
+  <connection>
+   <sender>horizontalSliderBrightness</sender>
+   <signal>valueChanged(int)</signal>
+   <receiver>brightnessSpinBox</receiver>
+   <slot>setValue(int)</slot>
+   <hints>
+    <hint type="sourcelabel" >
+     <x>87</x>
+     <y>117</y>
+    </hint>
+    <hint type="destinationlabel" >
+     <x>190</x>
+     <y>117</y>
+    </hint>
+   </hints>
+  </connection>
+  <connection>
+   <sender>contrastSpinBox</sender>
+   <signal>valueChanged(int)</signal>
+   <receiver>horizontalSliderContrast</receiver>
+   <slot>setValue(int)</slot>
+   <hints>
+    <hint type="sourcelabel" >
+     <x>190</x>
+     <y>69</y>
+    </hint>
+    <hint type="destinationlabel" >
+     <x>87</x>
+     <y>69</y>
+    </hint>
+   </hints>
+  </connection>
+  <connection>
+   <sender>brightnessSpinBox</sender>
+   <signal>valueChanged(int)</signal>
+   <receiver>horizontalSliderBrightness</receiver>
+   <slot>setValue(int)</slot>
+   <hints>
+    <hint type="sourcelabel" >
+     <x>190</x>
+     <y>117</y>
+    </hint>
+    <hint type="destinationlabel" >
+     <x>87</x>
+     <y>117</y>
+    </hint>
+   </hints>
+  </connection>
  </connections>
 </ui>

Modified: branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/Eq2/qt4/eq2.ui
===================================================================
--- branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/Eq2/qt4/eq2.ui	2009-02-22 12:12:46 UTC (rev 4620)
+++ branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/Eq2/qt4/eq2.ui	2009-02-22 13:14:48 UTC (rev 4621)
@@ -6,268 +6,596 @@
     <x>0</x>
     <y>0</y>
     <width>651</width>
-    <height>560</height>
+    <height>451</height>
    </rect>
   </property>
   <property name="windowTitle" >
-   <string>Contrast</string>
+   <string>MPlayer eq2</string>
   </property>
-  <layout class="QGridLayout" >
-   <property name="leftMargin" >
+  <layout class="QVBoxLayout" >
+   <property name="margin" >
     <number>9</number>
    </property>
-   <property name="topMargin" >
-    <number>9</number>
-   </property>
-   <property name="rightMargin" >
-    <number>9</number>
-   </property>
-   <property name="bottomMargin" >
-    <number>9</number>
-   </property>
-   <property name="horizontalSpacing" >
+   <property name="spacing" >
     <number>6</number>
    </property>
-   <property name="verticalSpacing" >
-    <number>6</number>
-   </property>
-   <item row="5" column="0" colspan="3" >
-    <widget class="QDialogButtonBox" name="buttonBox" >
-     <property name="orientation" >
-      <enum>Qt::Horizontal</enum>
+   <item>
+    <layout class="QHBoxLayout" >
+     <property name="margin" >
+      <number>0</number>
      </property>
-     <property name="standardButtons" >
-      <set>QDialogButtonBox::Cancel|QDialogButtonBox::NoButton|QDialogButtonBox::Ok</set>
+     <property name="spacing" >
+      <number>6</number>
      </property>
-    </widget>
+     <item>
+      <layout class="QVBoxLayout" >
+       <property name="margin" >
+        <number>0</number>
+       </property>
+       <property name="spacing" >
+        <number>6</number>
+       </property>
+       <item>
+        <widget class="QLabel" name="label" >
+         <property name="text" >
+          <string>Contrast:</string>
+         </property>
+        </widget>
+       </item>
+       <item>
+        <layout class="QHBoxLayout" >
+         <property name="margin" >
+          <number>0</number>
+         </property>
+         <property name="spacing" >
+          <number>6</number>
+         </property>
+         <item>
+          <widget class="QSlider" name="horizontalSliderContrast" >
+           <property name="minimum" >
+            <number>-200</number>
+           </property>
+           <property name="maximum" >
+            <number>200</number>
+           </property>
+           <property name="orientation" >
+            <enum>Qt::Horizontal</enum>
+           </property>
+          </widget>
+         </item>
+         <item>
+          <spacer>
+           <property name="orientation" >
+            <enum>Qt::Horizontal</enum>
+           </property>
+           <property name="sizeType" >
+            <enum>QSizePolicy::Fixed</enum>
+           </property>
+           <property name="sizeHint" >
+            <size>
+             <width>2</width>
+             <height>20</height>
+            </size>
+           </property>
+          </spacer>
+         </item>
+         <item>
+          <widget class="QSpinBox" name="contrastSpinBox" >
+           <property name="maximum" >
+            <number>200</number>
+           </property>
+           <property name="minimum" >
+            <number>-200</number>
+           </property>
+          </widget>
+         </item>
+        </layout>
+       </item>
+       <item>
+        <widget class="QLabel" name="label_2" >
+         <property name="text" >
+          <string>Brightness:</string>
+         </property>
+        </widget>
+       </item>
+       <item>
+        <layout class="QHBoxLayout" >
+         <property name="margin" >
+          <number>0</number>
+         </property>
+         <property name="spacing" >
+          <number>6</number>
+         </property>
+         <item>
+          <widget class="QSlider" name="horizontalSliderBrightness" >
+           <property name="minimum" >
+            <number>-100</number>
+           </property>
+           <property name="maximum" >
+            <number>100</number>
+           </property>
+           <property name="orientation" >
+            <enum>Qt::Horizontal</enum>
+           </property>
+          </widget>
+         </item>
+         <item>
+          <spacer>
+           <property name="orientation" >
+            <enum>Qt::Horizontal</enum>
+           </property>
+           <property name="sizeType" >
+            <enum>QSizePolicy::Fixed</enum>
+           </property>
+           <property name="sizeHint" >
+            <size>
+             <width>2</width>
+             <height>20</height>
+            </size>
+           </property>
+          </spacer>
+         </item>
+         <item>
+          <widget class="QSpinBox" name="brightnessSpinBox" >
+           <property name="maximum" >
+            <number>100</number>
+           </property>
+           <property name="minimum" >
+            <number>-100</number>
+           </property>
+          </widget>
+         </item>
+        </layout>
+       </item>
+       <item>
+        <widget class="QLabel" name="label_3" >
+         <property name="text" >
+          <string>Saturation:</string>
+         </property>
+        </widget>
+       </item>
+       <item>
+        <layout class="QHBoxLayout" >
+         <property name="margin" >
+          <number>0</number>
+         </property>
+         <property name="spacing" >
+          <number>6</number>
+         </property>
+         <item>
+          <widget class="QSlider" name="horizontalSliderSaturation" >
+           <property name="maximum" >
+            <number>300</number>
+           </property>
+           <property name="orientation" >
+            <enum>Qt::Horizontal</enum>
+           </property>
+           <property name="tickInterval" >
+            <number>1</number>
+           </property>
+          </widget>
+         </item>
+         <item>
+          <spacer>
+           <property name="orientation" >
+            <enum>Qt::Horizontal</enum>
+           </property>
+           <property name="sizeType" >
+            <enum>QSizePolicy::Fixed</enum>
+           </property>
+           <property name="sizeHint" >
+            <size>
+             <width>2</width>
+             <height>20</height>
+            </size>
+           </property>
+          </spacer>
+         </item>
+         <item>
+          <widget class="QSpinBox" name="saturationSpinBox" >
+           <property name="maximum" >
+            <number>300</number>
+           </property>
+          </widget>
+         </item>
+        </layout>
+       </item>
+       <item>
+        <spacer>
+         <property name="orientation" >
+          <enum>Qt::Vertical</enum>
+         </property>
+         <property name="sizeHint" >
+          <size>
+           <width>20</width>
+           <height>1</height>
+          </size>
+         </property>
+        </spacer>
+       </item>
+      </layout>
+     </item>
+     <item>
+      <spacer>
+       <property name="orientation" >
+        <enum>Qt::Horizontal</enum>
+       </property>
+       <property name="sizeType" >
+        <enum>QSizePolicy::Fixed</enum>
+       </property>
+       <property name="sizeHint" >
+        <size>
+         <width>20</width>
+         <height>20</height>
+        </size>
+       </property>
+      </spacer>
+     </item>
+     <item>
+      <layout class="QVBoxLayout" >
+       <property name="margin" >
+        <number>0</number>
+       </property>
+       <property name="spacing" >
+        <number>6</number>
+       </property>
+       <item>
+        <widget class="QGroupBox" name="groupBox" >
+         <property name="title" >
+          <string>Gamma</string>
+         </property>
+         <layout class="QGridLayout" >
+          <property name="margin" >
+           <number>9</number>
+          </property>
+          <property name="spacing" >
+           <number>6</number>
+          </property>
+          <item row="0" column="1" >
+           <layout class="QHBoxLayout" >
+            <property name="margin" >
+             <number>0</number>
+            </property>
+            <property name="spacing" >
+             <number>6</number>
+            </property>
+            <item>
+             <widget class="QSlider" name="horizontalSliderInitial" >
+              <property name="maximum" >
+               <number>300</number>
+              </property>
+              <property name="orientation" >
+               <enum>Qt::Horizontal</enum>
+              </property>
+             </widget>
+            </item>
+            <item>
+             <spacer>
+              <property name="orientation" >
+               <enum>Qt::Horizontal</enum>
+              </property>
+              <property name="sizeType" >
+               <enum>QSizePolicy::Fixed</enum>
+              </property>
+              <property name="sizeHint" >
+               <size>
+                <width>2</width>
+                <height>20</height>
+               </size>
+              </property>
+             </spacer>
+            </item>
+            <item>
+             <widget class="QSpinBox" name="initialSpinBox" >
+              <property name="maximum" >
+               <number>300</number>
+              </property>
+             </widget>
+            </item>
+           </layout>
+          </item>
+          <item row="1" column="1" >
+           <layout class="QHBoxLayout" >
+            <property name="margin" >
+             <number>0</number>
+            </property>
+            <property name="spacing" >
+             <number>6</number>
+            </property>
+            <item>
+             <widget class="QSlider" name="horizontalSliderRed" >
+              <property name="maximum" >
+               <number>300</number>
+              </property>
+              <property name="orientation" >
+               <enum>Qt::Horizontal</enum>
+              </property>
+             </widget>
+            </item>
+            <item>
+             <spacer>
+              <property name="orientation" >
+               <enum>Qt::Horizontal</enum>
+              </property>
+              <property name="sizeType" >
+               <enum>QSizePolicy::Fixed</enum>
+              </property>
+              <property name="sizeHint" >
+               <size>
+                <width>2</width>
+                <height>20</height>
+               </size>
+              </property>
+             </spacer>
+            </item>
+            <item>
+             <widget class="QSpinBox" name="redSpinBox" >
+              <property name="maximum" >
+               <number>300</number>
+              </property>
+             </widget>
+            </item>
+           </layout>
+          </item>
+          <item row="2" column="1" >
+           <layout class="QHBoxLayout" >
+            <property name="margin" >
+             <number>0</number>
+            </property>
+            <property name="spacing" >
+             <number>6</number>
+            </property>
+            <item>
+             <widget class="QSlider" name="horizontalSliderGreen" >
+              <property name="maximum" >
+               <number>300</number>
+              </property>
+              <property name="orientation" >
+               <enum>Qt::Horizontal</enum>
+              </property>
+             </widget>
+            </item>
+            <item>
+             <spacer>
+              <property name="orientation" >
+               <enum>Qt::Horizontal</enum>
+              </property>
+              <property name="sizeType" >
+               <enum>QSizePolicy::Fixed</enum>
+              </property>
+              <property name="sizeHint" >
+               <size>
+                <width>2</width>
+                <height>20</height>
+               </size>
+              </property>
+             </spacer>
+            </item>
+            <item>
+             <widget class="QSpinBox" name="greenSpinBox" >
+              <property name="maximum" >
+               <number>300</number>
+              </property>
+             </widget>
+            </item>
+           </layout>
+          </item>
+          <item row="4" column="1" >
+           <layout class="QHBoxLayout" >
+            <property name="margin" >
+             <number>0</number>
+            </property>
+            <property name="spacing" >
+             <number>6</number>
+            </property>
+            <item>
+             <widget class="QSlider" name="horizontalSliderWeight" >
+              <property name="maximum" >
+               <number>300</number>
+              </property>
+              <property name="orientation" >
+               <enum>Qt::Horizontal</enum>
+              </property>
+             </widget>
+            </item>
+            <item>
+             <spacer>
+              <property name="orientation" >
+               <enum>Qt::Horizontal</enum>
+              </property>
+              <property name="sizeType" >
+               <enum>QSizePolicy::Fixed</enum>
+              </property>
+              <property name="sizeHint" >
+               <size>
+                <width>2</width>
+                <height>20</height>
+               </size>
+              </property>
+             </spacer>
+            </item>
+            <item>
+             <widget class="QSpinBox" name="weightSpinBox" >
+              <property name="maximum" >
+               <number>300</number>
+              </property>
+             </widget>
+            </item>
+           </layout>
+          </item>
+          <item row="3" column="1" >
+           <layout class="QHBoxLayout" >
+            <property name="margin" >
+             <number>0</number>
+            </property>
+            <property name="spacing" >
+             <number>6</number>
+            </property>
+            <item>
+             <widget class="QSlider" name="horizontalSliderBlue" >
+              <property name="maximum" >
+               <number>300</number>
+              </property>
+              <property name="orientation" >
+               <enum>Qt::Horizontal</enum>
+              </property>
+             </widget>
+            </item>
+            <item>
+             <spacer>
+              <property name="orientation" >
+               <enum>Qt::Horizontal</enum>
+              </property>
+              <property name="sizeType" >
+               <enum>QSizePolicy::Fixed</enum>
+              </property>
+              <property name="sizeHint" >
+               <size>
+                <width>2</width>
+                <height>20</height>
+               </size>
+              </property>
+             </spacer>
+            </item>
+            <item>
+             <widget class="QSpinBox" name="blueSpinBox" >
+              <property name="maximum" >
+               <number>300</number>
+              </property>
+             </widget>
+            </item>
+           </layout>
+          </item>
+          <item row="2" column="0" >
+           <widget class="QLabel" name="label_8" >
+            <property name="text" >
+             <string>Green</string>
+            </property>
+           </widget>
+          </item>
+          <item row="1" column="0" >
+           <widget class="QLabel" name="label_6" >
+            <property name="text" >
+             <string>Red</string>
+            </property>
+           </widget>
+          </item>
+          <item row="3" column="0" >
+           <widget class="QLabel" name="label_9" >
+            <property name="text" >
+             <string>Blue</string>
+            </property>
+           </widget>
+          </item>
+          <item row="4" column="0" >
+           <widget class="QLabel" name="label_7" >
+            <property name="text" >
+             <string>Weight</string>
+            </property>
+           </widget>
+          </item>
+          <item row="0" column="0" >
+           <widget class="QLabel" name="label_5" >
+            <property name="text" >
+             <string>Initial</string>
+            </property>
+           </widget>
+          </item>
+         </layout>
+        </widget>
+       </item>
+       <item>
+        <spacer>
+         <property name="orientation" >
+          <enum>Qt::Vertical</enum>
+         </property>
+         <property name="sizeHint" >
+          <size>
+           <width>20</width>
+           <height>1</height>
+          </size>
+         </property>
+        </spacer>
+       </item>
+      </layout>
+     </item>
+    </layout>
    </item>
-   <item row="2" column="0" colspan="3" >
+   <item>
     <widget class="QSlider" name="horizontalSlider" >
      <property name="orientation" >
       <enum>Qt::Horizontal</enum>
      </property>
     </widget>
    </item>
-   <item row="3" column="0" colspan="3" >
+   <item>
     <widget class="QGraphicsView" name="graphicsView" />
    </item>
-   <item row="4" column="2" >
+   <item>
     <spacer>
      <property name="orientation" >
       <enum>Qt::Vertical</enum>
      </property>
      <property name="sizeType" >
-      <enum>QSizePolicy::Ignored</enum>
+      <enum>QSizePolicy::Fixed</enum>
      </property>
      <property name="sizeHint" >
       <size>
        <width>20</width>
-       <height>40</height>
+       <height>16</height>
       </size>
      </property>
     </spacer>
    </item>
-   <item row="0" column="1" >
-    <widget class="QLabel" name="label_4" >
-     <property name="text" >
-      <string>&lt;b>Gamma&lt;/b></string>
+   <item>
+    <spacer>
+     <property name="orientation" >
+      <enum>Qt::Vertical</enum>
      </property>
-     <property name="textFormat" >
-      <enum>Qt::RichText</enum>
+     <property name="sizeType" >
+      <enum>QSizePolicy::Ignored</enum>
      </property>
-    </widget>
-   </item>
-   <item row="1" column="0" >
-    <layout class="QGridLayout" >
-     <property name="leftMargin" >
-      <number>0</number>
+     <property name="sizeHint" >
+      <size>
+       <width>20</width>
+       <height>16</height>
+      </size>
      </property>
-     <property name="topMargin" >
-      <number>0</number>
-     </property>
-     <property name="rightMargin" >
-      <number>0</number>
-     </property>
-     <property name="bottomMargin" >
-      <number>0</number>
-     </property>
-     <property name="horizontalSpacing" >
-      <number>6</number>
-     </property>
-     <property name="verticalSpacing" >
-      <number>6</number>
-     </property>
-     <item row="4" column="0" >
-      <widget class="QLabel" name="label_3" >
-       <property name="text" >
-        <string>Saturation</string>
-       </property>
-      </widget>
-     </item>
-     <item row="2" column="0" >
-      <widget class="QLabel" name="label_2" >
-       <property name="text" >
-        <string>Brightness</string>
-       </property>
-      </widget>
-     </item>
-     <item row="0" column="0" >
-      <widget class="QLabel" name="label" >
-       <property name="text" >
-        <string>Contrast</string>
-       </property>
-      </widget>
-     </item>
-     <item row="1" column="0" >
-      <widget class="QSlider" name="horizontalSliderContrast" >
-       <property name="minimum" >
-        <number>-200</number>
-       </property>
-       <property name="maximum" >
-        <number>200</number>
-       </property>
-       <property name="orientation" >
-        <enum>Qt::Horizontal</enum>
-       </property>
-      </widget>
-     </item>
-     <item row="3" column="0" >
-      <widget class="QSlider" name="horizontalSliderBrightness" >
-       <property name="minimum" >
-        <number>-100</number>
-       </property>
-       <property name="maximum" >
-        <number>100</number>
-       </property>
-       <property name="orientation" >
-        <enum>Qt::Horizontal</enum>
-       </property>
-      </widget>
-     </item>
-     <item row="5" column="0" >
-      <widget class="QSlider" name="horizontalSliderSaturation" >
-       <property name="maximum" >
-        <number>300</number>
-       </property>
-       <property name="orientation" >
-        <enum>Qt::Horizontal</enum>
-       </property>
-       <property name="tickInterval" >
-        <number>1</number>
-       </property>
-      </widget>
-     </item>
-    </layout>
+    </spacer>
    </item>
-   <item row="1" column="1" >
-    <layout class="QGridLayout" >
-     <property name="leftMargin" >
-      <number>0</number>
+   <item>
+    <widget class="QDialogButtonBox" name="buttonBox" >
+     <property name="orientation" >
+      <enum>Qt::Horizontal</enum>
      </property>
-     <property name="topMargin" >
-      <number>0</number>
+     <property name="standardButtons" >
+      <set>QDialogButtonBox::Cancel|QDialogButtonBox::NoButton|QDialogButtonBox::Ok</set>
      </property>
-     <property name="rightMargin" >
-      <number>0</number>
-     </property>
-     <property name="bottomMargin" >
-      <number>0</number>
-     </property>
-     <property name="horizontalSpacing" >
-      <number>6</number>
-     </property>
-     <property name="verticalSpacing" >
-      <number>6</number>
-     </property>
-     <item row="2" column="1" >
-      <widget class="QSlider" name="horizontalSliderGreen" >
-       <property name="maximum" >
-        <number>300</number>
-       </property>
-       <property name="orientation" >
-        <enum>Qt::Horizontal</enum>
-       </property>
-      </widget>
-     </item>
-     <item row="3" column="1" >
-      <widget class="QSlider" name="horizontalSliderBlue" >
-       <property name="maximum" >
-        <number>300</number>
-       </property>
-       <property name="orientation" >
-        <enum>Qt::Horizontal</enum>
-       </property>
-      </widget>
-     </item>
-     <item row="3" column="0" >
-      <widget class="QLabel" name="label_9" >
-       <property name="text" >
-        <string>Blue</string>
-       </property>
-      </widget>
-     </item>
-     <item row="1" column="0" >
-      <widget class="QLabel" name="label_6" >
-       <property name="text" >
-        <string>Red</string>
-       </property>
-      </widget>
-     </item>
-     <item row="0" column="0" >
-      <widget class="QLabel" name="label_5" >
-       <property name="text" >
-        <string>Initial</string>
-       </property>
-      </widget>
-     </item>
-     <item row="4" column="0" >
-      <widget class="QLabel" name="label_7" >
-       <property name="text" >
-        <string>Weight</string>
-       </property>
-      </widget>
-     </item>
-     <item row="1" column="1" >
-      <widget class="QSlider" name="horizontalSliderRed" >
-       <property name="maximum" >
-        <number>300</number>
-       </property>
-       <property name="orientation" >
-        <enum>Qt::Horizontal</enum>
-       </property>
-      </widget>
-     </item>
-     <item row="2" column="0" >
-      <widget class="QLabel" name="label_8" >
-       <property name="text" >
-        <string>Green</string>
-       </property>
-      </widget>
-     </item>
-     <item row="0" column="1" >
-      <widget class="QSlider" name="horizontalSliderInitial" >
-       <property name="maximum" >
-        <number>300</number>
-       </property>
-       <property name="orientation" >
-        <enum>Qt::Horizontal</enum>
-       </property>
-      </widget>
-     </item>
-     <item row="4" column="1" >
-      <widget class="QSlider" name="horizontalSliderWeight" >
-       <property name="maximum" >
-        <number>300</number>
-       </property>
-       <property name="orientation" >
-        <enum>Qt::Horizontal</enum>
-       </property>
-      </widget>
-     </item>
-    </layout>
+    </widget>
    </item>
   </layout>
  </widget>
+ <tabstops>
+  <tabstop>horizontalSliderContrast</tabstop>
+  <tabstop>contrastSpinBox</tabstop>
+  <tabstop>horizontalSliderBrightness</tabstop>
+  <tabstop>brightnessSpinBox</tabstop>
+  <tabstop>horizontalSliderSaturation</tabstop>
+  <tabstop>saturationSpinBox</tabstop>
+  <tabstop>horizontalSliderInitial</tabstop>
+  <tabstop>initialSpinBox</tabstop>
+  <tabstop>horizontalSliderRed</tabstop>
+  <tabstop>redSpinBox</tabstop>
+  <tabstop>horizontalSliderGreen</tabstop>
+  <tabstop>greenSpinBox</tabstop>
+  <tabstop>horizontalSliderBlue</tabstop>
+  <tabstop>blueSpinBox</tabstop>
+  <tabstop>horizontalSliderWeight</tabstop>
+  <tabstop>weightSpinBox</tabstop>
+  <tabstop>horizontalSlider</tabstop>
+  <tabstop>graphicsView</tabstop>
+  <tabstop>buttonBox</tabstop>
+ </tabstops>
  <resources/>
  <connections>
   <connection>
@@ -302,5 +630,261 @@
     </hint>
    </hints>
   </connection>
+  <connection>
+   <sender>horizontalSliderContrast</sender>
+   <signal>valueChanged(int)</signal>
+   <receiver>contrastSpinBox</receiver>
+   <slot>setValue(int)</slot>
+   <hints>
+    <hint type="sourcelabel" >
+     <x>138</x>
+     <y>69</y>
+    </hint>
+    <hint type="destinationlabel" >
+     <x>293</x>
+     <y>69</y>
+    </hint>
+   </hints>
+  </connection>
+  <connection>
+   <sender>horizontalSliderBrightness</sender>
+   <signal>valueChanged(int)</signal>
+   <receiver>brightnessSpinBox</receiver>
+   <slot>setValue(int)</slot>
+   <hints>
+    <hint type="sourcelabel" >
+     <x>138</x>
+     <y>117</y>
+    </hint>
+    <hint type="destinationlabel" >
+     <x>293</x>
+     <y>117</y>
+    </hint>
+   </hints>
+  </connection>
+  <connection>
+   <sender>horizontalSliderSaturation</sender>
+   <signal>valueChanged(int)</signal>
+   <receiver>saturationSpinBox</receiver>
+   <slot>setValue(int)</slot>
+   <hints>
+    <hint type="sourcelabel" >
+     <x>138</x>
+     <y>165</y>
+    </hint>
+    <hint type="destinationlabel" >
+     <x>293</x>
+     <y>165</y>
+    </hint>
+   </hints>
+  </connection>
+  <connection>
+   <sender>horizontalSliderInitial</sender>
+   <signal>valueChanged(int)</signal>
+   <receiver>initialSpinBox</receiver>
+   <slot>setValue(int)</slot>
+   <hints>
+    <hint type="sourcelabel" >
+     <x>490</x>
+     <y>73</y>
+    </hint>
+    <hint type="destinationlabel" >
+     <x>614</x>
+     <y>73</y>
+    </hint>
+   </hints>
+  </connection>
+  <connection>
+   <sender>horizontalSliderRed</sender>
+   <signal>valueChanged(int)</signal>
+   <receiver>redSpinBox</receiver>
+   <slot>setValue(int)</slot>
+   <hints>
+    <hint type="sourcelabel" >
+     <x>490</x>
+     <y>101</y>
+    </hint>
+    <hint type="destinationlabel" >
+     <x>614</x>
+     <y>101</y>
+    </hint>
+   </hints>
+  </connection>
+  <connection>
+   <sender>horizontalSliderGreen</sender>
+   <signal>valueChanged(int)</signal>
+   <receiver>greenSpinBox</receiver>
+   <slot>setValue(int)</slot>
+   <hints>
+    <hint type="sourcelabel" >
+     <x>490</x>
+     <y>129</y>
+    </hint>
+    <hint type="destinationlabel" >
+     <x>614</x>
+     <y>129</y>
+    </hint>
+   </hints>
+  </connection>
+  <connection>
+   <sender>horizontalSliderBlue</sender>
+   <signal>valueChanged(int)</signal>
+   <receiver>blueSpinBox</receiver>
+   <slot>setValue(int)</slot>
+   <hints>
+    <hint type="sourcelabel" >
+     <x>490</x>
+     <y>157</y>
+    </hint>
+    <hint type="destinationlabel" >
+     <x>614</x>
+     <y>157</y>
+    </hint>
+   </hints>
+  </connection>
+  <connection>
+   <sender>horizontalSliderWeight</sender>
+   <signal>valueChanged(int)</signal>
+   <receiver>weightSpinBox</receiver>
+   <slot>setValue(int)</slot>
+   <hints>
+    <hint type="sourcelabel" >
+     <x>490</x>
+     <y>185</y>
+    </hint>
+    <hint type="destinationlabel" >
+     <x>614</x>
+     <y>185</y>
+    </hint>
+   </hints>
+  </connection>
+  <connection>
+   <sender>contrastSpinBox</sender>
+   <signal>valueChanged(int)</signal>
+   <receiver>horizontalSliderContrast</receiver>
+   <slot>setValue(int)</slot>
+   <hints>
+    <hint type="sourcelabel" >
+     <x>293</x>
+     <y>69</y>
+    </hint>
+    <hint type="destinationlabel" >
+     <x>138</x>
+     <y>69</y>
+    </hint>
+   </hints>
+  </connection>
+  <connection>
+   <sender>brightnessSpinBox</sender>
+   <signal>valueChanged(int)</signal>
+   <receiver>horizontalSliderBrightness</receiver>
+   <slot>setValue(int)</slot>
+   <hints>
+    <hint type="sourcelabel" >
+     <x>293</x>
+     <y>117</y>
+    </hint>
+    <hint type="destinationlabel" >
+     <x>138</x>
+     <y>117</y>
+    </hint>
+   </hints>
+  </connection>
+  <connection>
+   <sender>saturationSpinBox</sender>
+   <signal>valueChanged(int)</signal>
+   <receiver>horizontalSliderSaturation</receiver>
+   <slot>setValue(int)</slot>
+   <hints>
+    <hint type="sourcelabel" >
+     <x>293</x>
+     <y>165</y>
+    </hint>
+    <hint type="destinationlabel" >
+     <x>138</x>
+     <y>165</y>
+    </hint>
+   </hints>
+  </connection>
+  <connection>
+   <sender>initialSpinBox</sender>
+   <signal>valueChanged(int)</signal>
+   <receiver>horizontalSliderInitial</receiver>
+   <slot>setValue(int)</slot>
+   <hints>
+    <hint type="sourcelabel" >
+     <x>614</x>
+     <y>73</y>
+    </hint>
+    <hint type="destinationlabel" >
+     <x>490</x>
+     <y>73</y>
+    </hint>
+   </hints>
+  </connection>
+  <connection>
+   <sender>redSpinBox</sender>
+   <signal>valueChanged(int)</signal>
+   <receiver>horizontalSliderRed</receiver>
+   <slot>setValue(int)</slot>
+   <hints>
+    <hint type="sourcelabel" >
+     <x>614</x>
+     <y>101</y>
+    </hint>
+    <hint type="destinationlabel" >
+     <x>490</x>
+     <y>101</y>
+    </hint>
+   </hints>
+  </connection>
+  <connection>
+   <sender>greenSpinBox</sender>
+   <signal>valueChanged(int)</signal>
+   <receiver>horizontalSliderGreen</receiver>
+   <slot>setValue(int)</slot>
+   <hints>
+    <hint type="sourcelabel" >
+     <x>614</x>
+     <y>129</y>
+    </hint>
+    <hint type="destinationlabel" >
+     <x>490</x>
+     <y>129</y>
+    </hint>
+   </hints>
+  </connection>
+  <connection>
+   <sender>blueSpinBox</sender>
+   <signal>valueChanged(int)</signal>
+   <receiver>horizontalSliderBlue</receiver>
+   <slot>setValue(int)</slot>
+   <hints>
+    <hint type="sourcelabel" >
+     <x>614</x>
+     <y>157</y>
+    </hint>
+    <hint type="destinationlabel" >
+     <x>490</x>
+     <y>157</y>
+    </hint>
+   </hints>
+  </connection>
+  <connection>
+   <sender>weightSpinBox</sender>
+   <signal>valueChanged(int)</signal>
+   <receiver>horizontalSliderWeight</receiver>
+   <slot>setValue(int)</slot>
+   <hints>
+    <hint type="sourcelabel" >
+     <x>614</x>
+     <y>185</y>
+    </hint>
+    <hint type="destinationlabel" >
+     <x>490</x>
+     <y>185</y>
+    </hint>
+   </hints>
+  </connection>
  </connections>
 </ui>



From gruntster at mail.berlios.de  Sun Feb 22 14:36:09 2009
From: gruntster at mail.berlios.de (gruntster at mail.berlios.de)
Date: Sun, 22 Feb 2009 14:36:09 +0100
Subject: [Avidemux-svn-commit] r4622 - in
	branches/avidemux_2.5_branch_gruntster/avidemux: .
	ADM_libraries/ADM_utilities ADM_userInterfaces/ADM_commonUI
Message-ID: <200902221336.n1MDa9uN014992@sheep.berlios.de>

Author: gruntster
Date: 2009-02-22 14:36:02 +0100 (Sun, 22 Feb 2009)
New Revision: 4622

Removed:
   branches/avidemux_2.5_branch_gruntster/avidemux/prefs_gen.pl
Modified:
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_libraries/ADM_utilities/prefs.cpp
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp
   branches/avidemux_2.5_branch_gruntster/avidemux/prefs.h
   branches/avidemux_2.5_branch_gruntster/avidemux/prefs.in
Log:
[xvid/x264] remove threading options for x264 and Xvid from Preferences window

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_libraries/ADM_utilities/prefs.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_libraries/ADM_utilities/prefs.cpp	2009-02-22 13:14:48 UTC (rev 4621)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_libraries/ADM_utilities/prefs.cpp	2009-02-22 13:36:02 UTC (rev 4622)
@@ -128,8 +128,6 @@
 	{"feature.reuse_2pass_log",		UINT,	"0",	NULL,	"0",	"1"	},
 	{"feature.audiobar_uses_master",		UINT,	"0",	NULL,	"0",	"1"	},
 	{"feature.threading.lavc",		UINT,	"0",	NULL,	"0",	"32"	},
-	{"feature.threading.x264",		UINT,	"0",	NULL,	"0",	"32"	},
-	{"feature.threading.xvid",		UINT,	"0",	NULL,	"0",	"32"	},
 	{"feature.cpu_caps",		UINT,	"4294967295",NULL,	"0",	"4294967295"},
 	{"feature.mpeg_no_limit",		UINT,	"0",	NULL,	"0",	"1"	},
 	{"feature.auto_buildmap",		UINT,	"0",	NULL,	"0",	"1"	},
@@ -146,7 +144,7 @@
 	{"priority.playback",		UINT,	"0",	NULL,	"0",	"4"	}
 };
 
-int num_opts = 80;
+int num_opts = 78;
 // </prefs_gen>
 
 #ifdef USE_LIBXML2

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp	2009-02-22 13:14:48 UTC (rev 4621)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_prefs.cpp	2009-02-22 13:36:02 UTC (rev 4622)
@@ -50,7 +50,7 @@
 uint32_t useAutoIndex=0;
 uint32_t useSwap=0;
 uint32_t useNuv=0;
-uint32_t lavcThreads=0,x264Threads=0,xvidThreads=0;
+uint32_t lavcThreads=0;
 uint32_t encodePriority=2;
 uint32_t indexPriority=2;
 uint32_t playbackPriority=0;
@@ -127,8 +127,6 @@
 
         // Multithreads
         prefs->get(FEATURE_THREADING_LAVC, &lavcThreads);
-        prefs->get(FEATURE_THREADING_X264, &x264Threads);
-        prefs->get(FEATURE_THREADING_XVID, &xvidThreads);
 
 		// Encoding priority
 		if(!prefs->get(PRIORITY_ENCODING, &encodePriority))
@@ -217,13 +215,9 @@
 		frameSimd.swallow(&capsToggleSSSE3);
 
 		diaElemThreadCount lavcThreadCount(&lavcThreads, QT_TR_NOOP("_lavc threads:"));
-		diaElemThreadCount x264ThreadCount(&x264Threads, QT_TR_NOOP("_x264 threads:"));
-		diaElemThreadCount xvidThreadCount(&xvidThreads, QT_TR_NOOP("X_vid threads:"));
 
 		diaElemFrame frameThread(QT_TR_NOOP("Multi-threading"));
 		frameThread.swallow(&lavcThreadCount);
-		frameThread.swallow(&x264ThreadCount);
-		frameThread.swallow(&xvidThreadCount);
 
 		diaMenuEntry priorityEntries[] = {
                              {0,       QT_TR_NOOP("High"),NULL}
@@ -454,8 +448,6 @@
                 
                 // number of threads
                 prefs->set(FEATURE_THREADING_LAVC, lavcThreads);
-				prefs->set(FEATURE_THREADING_X264, x264Threads);
-				prefs->set(FEATURE_THREADING_XVID, xvidThreads);
 
 				// Encoding priority
 				prefs->set(PRIORITY_ENCODING, encodePriority);

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/prefs.h
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/prefs.h	2009-02-22 13:14:48 UTC (rev 4621)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/prefs.h	2009-02-22 13:36:02 UTC (rev 4622)
@@ -72,8 +72,6 @@
 	FEATURE_REUSE_2PASS_LOG,
 	FEATURE_AUDIOBAR_USES_MASTER,
 	FEATURE_THREADING_LAVC,
-	FEATURE_THREADING_X264,
-	FEATURE_THREADING_XVID,
 	FEATURE_CPU_CAPS,
 	FEATURE_MPEG_NO_LIMIT,
 	FEATURE_AUTO_BUILDMAP,

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/prefs.in
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/prefs.in	2009-02-22 13:14:48 UTC (rev 4621)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/prefs.in	2009-02-22 13:36:02 UTC (rev 4622)
@@ -89,8 +89,6 @@
 feature.reuse_2pass_log,                UINT,   0,      0,      1
 feature.audiobar_uses_master,           UINT,   0,      0,      1
 feature.threading.lavc,                 UINT,   0,      0,      32
-feature.threading.x264,                 UINT,   0,      0,      32
-feature.threading.xvid,                 UINT,   0,      0,      32
 feature.cpu_caps,  		                UINT,   4294967295,      0,      4294967295
 feature.mpeg_no_limit,                  UINT,   0,      0,      1
 feature.auto_buildmap,                  UINT,   0,      0,      1

Deleted: branches/avidemux_2.5_branch_gruntster/avidemux/prefs_gen.pl
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/prefs_gen.pl	2009-02-22 13:14:48 UTC (rev 4621)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/prefs_gen.pl	2009-02-22 13:36:02 UTC (rev 4622)
@@ -1,130 +0,0 @@
-#!/usr/bin/perl
-
-use strict;
-use IO::Handle;
-
-my $srcdir=".";
-my $in  = "$srcdir/prefs.in";
-my $h   = "$srcdir/prefs.h";
-my $cpp = "$srcdir/ADM_libraries/ADM_utilities/prefs.cpp";
-#print "In:$in\n";
-my $h_str = "typedef enum {\n";
-my $cpp_str = "typedef enum {\n".
-              "\tUINT,\n".
-              "\tINT,\n".
-              "\tULONG,\n".
-              "\tLONG,\n".
-              "\tFLOAT,\n".
-              "\tSTRING,\n".
-              "\tFILENAME\n".
-              "} types;\n".
-              "\n".
-              "typedef struct {\n".
-              "\tconst char *name;\n".
-              "\ttypes type;\n".
-              "\tconst char *default_val;\n".
-              "\tchar *current_val;\n".
-              "\tconst char *minimum;\n".
-              "\tconst char *maximum;\n".
-              "} opt_def;\n".
-              "\n".
-              "static opt_def opt_defs [] = {\n";
-
-my $fd = new IO::Handle;
-my @data;
-my $flag;
-my $num_opts = 0;
-
-open($fd,"< $in") or die;
-while(<$fd>){
-	chomp;
-	s/#.*$//;
-	next if( /^[ 	]*$/ );
-	#     optname       type           value  rest
-        if( /^([^,]+)\s*,\s*([A-Z]+)\s*,\s*([^,]+)(.*)$/ ){
-	   my ($N,$a,$b,$c,$d,$e) = ($1,uc($1),$2,$3,$4,$4);
-		$a       =~ s/\./_/g;
-		$h_str   .= "\t$a,\n";
-		$cpp_str .= "\t{\"$N\",";
-		$cpp_str .= "\t" if( length($c)%8 != 3 );
-		$cpp_str .= "\t$b,";
-		if(( $b eq "STRING" )||($b eq "FILENAME")){
-			$c =~ s/^"//;
-			$c =~ s/"$//;
-                        $c =~ s/@/,/; # Replace % by , needed by alsa stuff
-
-		}else{
-			$cpp_str .= "\t";
-		}
-		$cpp_str .= "\"$c\",";
-		$cpp_str .= "\t" if( length($c) < 5 );
-		$cpp_str .= "NULL,";
-		# max min processing
-		if(( $b eq "STRING" )||($b eq "FILENAME")){
-			$cpp_str .= " NULL, NULL },\n";
-		}else{
-			$d =~ s/^\s*,\s*//;
-			($d,$e) = split(",",$d);                        
-			$d =~ s/\s*$//;
-			$e =~ s/^\s*//;
-			$e =~ s/\s*$//;
-			$cpp_str .= "\t\"$d\",";
-			$cpp_str .= "\t" if( length($d) < 5 );
-			$cpp_str .= "\"$e\"";
-			$cpp_str .= "\t" if( length($e) < 5 );
-			$cpp_str .= "},\n";
-			die "value($a) < min : $c < $d\n" if( $c < $d );
-		}
-		$num_opts++;
-	}else{
-		die "parse error in \"$in\" line \"$_\".";
-	}
-}
-close($fd);
-
-$h_str    = substr($h_str,0,-2); # strip out ",\n"
-$h_str   .= "\n} options;\n";
-$cpp_str  = substr($cpp_str,0,-2); # strip out ",\n"
-$cpp_str .= "\n};\n\nint num_opts = $num_opts;\n";
-
- at data = ();
-$flag = 0;
-open($fd,"< $h") or die;
-while(<$fd>){
-	if( /^\/\/ <\/prefs_gen>/ ){
-		$flag = 2;
-	}
-	if( $flag == 0 || $flag == 2 ){
-		push @data,$_;
-	}
-	if( /^\/\/ <prefs_gen>/ ){
-		$flag = 1;
-		push @data,$h_str;
-	}
-}
-close($fd);
-open($fd,"> $h") or die;
-print $fd join("", at data);
-close($fd);
-
- at data = ();
-$flag = 0;
-open($fd,"< $cpp") or die($cpp);
-while(<$fd>){
-        if( /^\/\/ <\/prefs_gen>/ ){
-                $flag = 2;
-        }
-        if( $flag == 0 || $flag == 2 ){
-                push @data,$_;
-        }
-        if( /^\/\/ <prefs_gen>/ ){
-                $flag = 1;
-                push @data,$cpp_str;
-        }
-}
-close($fd);
-open($fd,"> $cpp") or die;
-print $fd join("", at data);
-close($fd);
-
-exit(0);



From mean at mail.berlios.de  Sun Feb 22 19:27:37 2009
From: mean at mail.berlios.de (mean at BerliOS)
Date: Sun, 22 Feb 2009 19:27:37 +0100
Subject: [Avidemux-svn-commit] r4623 -
	branches/avidemux_2.6_branch_mean/avidemux
Message-ID: <200902221827.n1MIRbHr012911@sheep.berlios.de>

Author: mean
Date: 2009-02-22 19:27:36 +0100 (Sun, 22 Feb 2009)
New Revision: 4623

Modified:
   branches/avidemux_2.6_branch_mean/avidemux/gui_navigate.cpp
Log:
[MainLoop] Split the big switch (1)

Modified: branches/avidemux_2.6_branch_mean/avidemux/gui_navigate.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/gui_navigate.cpp	2009-02-22 13:36:02 UTC (rev 4622)
+++ branches/avidemux_2.6_branch_mean/avidemux/gui_navigate.cpp	2009-02-22 18:27:36 UTC (rev 4623)
@@ -43,7 +43,129 @@
 #include "ADM_preview.h"
 
 extern void    UI_purge(void );
+/**
+    \fn HandleAction_Navigate
 
+*/
+void HandleAction_Navigate (Action action)
+{
+    switch(action)
+    {
+  case ACT_GotoMarkA:
+    case ACT_GotoMarkB:
+
+      if (action == ACT_GotoMarkA)
+	nf = frameStart;
+      else
+	nf = frameEnd;
+      GUI_GoToFrame (nf);
+      break;
+    case ACT_Goto:
+      uint32_t fn;
+      fn=video_body->getCurrentFrame();
+      if (DIA_GetIntegerValue ((int *)&fn,0,avifileinfo->nb_frames,QT_TR_NOOP("Go to Frame"),QT_TR_NOOP("_Go to frame:")))
+	{
+		if (fn < avifileinfo->nb_frames)
+			GUI_GoToFrame (fn);
+		else
+			GUI_Error_HIG (QT_TR_NOOP("Out of bounds"), NULL);
+	}
+      break;
+   case ACT_Back25Frames:
+    //  if (curframe >= 25)
+	{
+	  DIA_StartBusy ();
+	  //GUI_GoToFrame (curframe - 25);
+	  DIA_StopBusy ();
+
+	}
+      break;
+
+    case ACT_PreviousKFrame:
+      GUI_PreviousKeyFrame ();
+      break;
+   case ACT_PreviousFrame:
+        GUI_PrevFrame();
+      break;
+    case ACT_Forward100Frames:
+      //GUI_GoToKFrame (curframe + (avifileinfo->fps1000 / 1000 * 4));
+      break;
+
+    case ACT_Back100Frames:
+      //GUI_GoToKFrame (curframe - (avifileinfo->fps1000 / 1000 * 4));
+      break;
+
+
+    case ACT_Forward50Frames:
+      //GUI_GoToFrame (curframe + 50);
+      break;
+
+    case ACT_Forward25Frames:
+      //GUI_GoToFrame (curframe + 25);
+      break;
+
+    case ACT_Back50Frames:
+      //if (curframe >= 50)
+	{
+	  DIA_StartBusy ();
+	  //GUI_GoToFrame (curframe - 50);
+	  DIA_StopBusy ();
+	}
+      break;
+ case ACT_NextFrame:
+      GUI_NextFrame ();
+      break;
+    case ACT_NextKFrame:
+      GUI_NextKeyFrame ();
+      break;
+    case ACT_NextBlackFrame:
+      GUI_NextPrevBlackFrame(1);
+      break;
+    case ACT_PrevBlackFrame:
+      GUI_NextPrevBlackFrame(-1);
+      break;
+   case ACT_End:
+
+      nf = avifileinfo->nb_frames;
+      GUI_GoToFrame (nf - 1);
+
+      break;
+  case ACT_Begin:
+      GUI_GoToKFrame (0);
+
+      break;
+  case ACT_JumpToFrame:
+                // read value
+                nf=UI_readCurFrame();
+				if(nf< avifileinfo->nb_frames)
+					GUI_GoToFrame(nf);
+                UI_JumpDone();
+                break;
+	case ACT_JumpToTime:
+		{
+			uint16_t hh, mm, ss, ms;
+
+			if (UI_readCurTime(hh, mm, ss, ms))
+				A_jumpToTime(hh, mm, ss, ms);
+		}
+		break;
+    case ACT_GotoTime:
+                {
+#if 0
+                        uint16_t mm,hh,ss,ms;
+                             frame2time(curframe,avifileinfo->fps1000,&hh,&mm,&ss,&ms);
+                             if(DIA_gotoTime(&hh,&mm,&ss))
+                                {
+                                        A_jumpToTime(hh,mm,ss, 0);
+                                }
+#endif
+                }
+                break;
+    default:
+        ADM_assert(0);
+        break;
+    }
+}
 /**
     \fn GUI_NextFrame
     \brief next frame



From mean at mail.berlios.de  Sun Feb 22 19:27:39 2009
From: mean at mail.berlios.de (mean at BerliOS)
Date: Sun, 22 Feb 2009 19:27:39 +0100
Subject: [Avidemux-svn-commit] r4624 - in
	branches/avidemux_2.6_branch_mean/avidemux: . ADM_editor
Message-ID: <200902221827.n1MIRdvi012969@sheep.berlios.de>

Author: mean
Date: 2009-02-22 19:27:38 +0100 (Sun, 22 Feb 2009)
New Revision: 4624

Modified:
   branches/avidemux_2.6_branch_mean/avidemux/ADM_editor/ADM_edit.cpp
   branches/avidemux_2.6_branch_mean/avidemux/ADM_editor/ADM_edit.hxx
   branches/avidemux_2.6_branch_mean/avidemux/ADM_preview.h
   branches/avidemux_2.6_branch_mean/avidemux/gtk_gui.cpp
   branches/avidemux_2.6_branch_mean/avidemux/gtkgui.h
   branches/avidemux_2.6_branch_mean/avidemux/gui_action.names
   branches/avidemux_2.6_branch_mean/avidemux/gui_navigate.cpp
Log:
[UI] Split navigate related functions, re-enable go to time (need more work)

Modified: branches/avidemux_2.6_branch_mean/avidemux/ADM_editor/ADM_edit.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/ADM_editor/ADM_edit.cpp	2009-02-22 18:27:36 UTC (rev 4623)
+++ branches/avidemux_2.6_branch_mean/avidemux/ADM_editor/ADM_edit.cpp	2009-02-22 18:27:38 UTC (rev 4624)
@@ -1276,6 +1276,30 @@
 {
   return 1;
 }
-
+/**
+    \fn estimatePts
+    \brief Get or estimate PTS of given frame
+*/
+uint64_t    ADM_Composer::estimatePts(uint32_t frame)
+{
+    uint32_t flags;
+    _VIDEOS *vid=&_videos[0];
+    vidHeader *demuxer=vid->_aviheader;
+    int count=0;
+    uint64_t  wantedPts;
+	while(1)
+    {
+        demuxer->getFlags(frame,&flags);
+        wantedPts=vid->_aviheader->getTime(frame);
+        if((flags & AVI_KEY_FRAME)&&(wantedPts!=ADM_NO_PTS))
+        {
+                break;
+        }
+        count++;
+        frame--;
+    }
+    wantedPts+=vid->timeIncrementInUs*count;
+    return wantedPts;
+}
 //
 //

Modified: branches/avidemux_2.6_branch_mean/avidemux/ADM_editor/ADM_edit.hxx
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/ADM_editor/ADM_edit.hxx	2009-02-22 18:27:36 UTC (rev 4623)
+++ branches/avidemux_2.6_branch_mean/avidemux/ADM_editor/ADM_edit.hxx	2009-02-22 18:27:38 UTC (rev 4624)
@@ -218,6 +218,7 @@
                         bool        NextPicture(ADMImage *image);
                         bool        samePicture(ADMImage *image);
                         bool        getCompressedPicure(uint32_t framenum,ADMCompressedImage *img);
+                        uint64_t    estimatePts(uint32_t frame);
 /************************************ Internal ******************************/
 public:
                                     /// Decode frame and on until frame is popped out of decoders

Modified: branches/avidemux_2.6_branch_mean/avidemux/ADM_preview.h
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/ADM_preview.h	2009-02-22 18:27:36 UTC (rev 4623)
+++ branches/avidemux_2.6_branch_mean/avidemux/ADM_preview.h	2009-02-22 18:27:38 UTC (rev 4624)
@@ -5,6 +5,7 @@
 */
 #ifndef ADM_PREVIEW_H
 #define ADM_PREVIEW_H
+#include "ADM_userInterfaces/ADM_render/GUI_render.h"
 typedef enum 
 {
     ADM_PREVIEW_NONE, 

Modified: branches/avidemux_2.6_branch_mean/avidemux/gtk_gui.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/gtk_gui.cpp	2009-02-22 18:27:36 UTC (rev 4623)
+++ branches/avidemux_2.6_branch_mean/avidemux/gtk_gui.cpp	2009-02-22 18:27:38 UTC (rev 4624)
@@ -81,7 +81,7 @@
 int A_openAvi2 (const char *name, uint8_t mode);
 int A_appendAvi (const char *name);
 void A_externalAudioTrack( void );
-
+uint8_t GUI_getFrameContent(ADMImage *image, uint32_t frame);
 void HandleAction (Action action);
 uint8_t A_rebuildKeyFrame (void);
 extern int GUI_handleVFilter (void);
@@ -139,8 +139,8 @@
 extern void videoCodecChanged(int newcodec);
 extern void DIA_Calculator(uint32_t *sizeInMeg, uint32_t *avgBitrate );
 extern uint8_t A_autoDrive(Action action);
-int ignore_change;
 
+
 extern uint8_t DIA_ocrGen(void);
 extern uint8_t DIA_ocrDvb(void);
 uint8_t A_TimeShift(void);
@@ -156,8 +156,8 @@
 renderZoom currentZoom=ZOOM_1_1;
 uint8_t A_setSecondAudioTrack(const AudioSource nw,char *name);
 extern const char * GUI_getCustomScript(uint32_t nb);
-extern bool SliderIsShifted;
 
+
 void GUI_showCurrentFrameHex(void);
 void GUI_avsProxy(void);
 uint8_t GUI_close(void);
@@ -165,6 +165,7 @@
 extern void DIA_glyphEdit(void);
 extern uint8_t DIA_pluginsInfo(void);
 extern bool ADM_mux_configure(int index);
+void HandleAction_Navigate(Action action);
 //___________________________________________
 // serialization of user event through gui
 //
@@ -384,7 +385,11 @@
 
 //#define TEST_UNPACK
   // we have an AVI loaded
-  switch (action)
+  if(action>ACT_NAVIGATE_BEGIN && action < ACT_NAVIGATE_END)
+  {
+    HandleAction_Navigate(action);
+  }
+  else switch (action)
     {
        case ACT_JOG:
                 A_jog();
@@ -454,33 +459,7 @@
 		UI_refreshCustomMenu();
       }
       break;
-        case ACT_JumpToFrame:
-                // read value
-                nf=UI_readCurFrame();
-				if(nf< avifileinfo->nb_frames)
-					GUI_GoToFrame(nf);
-                UI_JumpDone();
-                break;
-	case ACT_JumpToTime:
-		{
-			uint16_t hh, mm, ss, ms;
-
-			if (UI_readCurTime(hh, mm, ss, ms))
-				A_jumpToTime(hh, mm, ss, ms);
-		}
-		break;
-    case ACT_GotoTime:
-                {
-#if 0
-                        uint16_t mm,hh,ss,ms;
-                             frame2time(curframe,avifileinfo->fps1000,&hh,&mm,&ss,&ms);
-                             if(DIA_gotoTime(&hh,&mm,&ss))
-                                {
-                                        A_jumpToTime(hh,mm,ss, 0);
-                                }
-#endif
-                }
-                break;
+      
     case ACT_SaveRaw:
       GUI_FileSelWrite (QT_TR_NOOP("Select Raw File to Save"), (SELFILE_CB *)ADM_saveRaw);
       break;
@@ -511,21 +490,13 @@
     case ACT_AviInfo:
       DIA_properties ();
       break;
-    case ACT_Begin:
-      GUI_GoToKFrame (0);
-
-      break;
+  
 	case ACT_BitRate:
 		 GUI_displayBitrate(  );
 	break;
 
-    case ACT_End:
+ 
 
-      nf = avifileinfo->nb_frames;
-      GUI_GoToFrame (nf - 1);
-
-      break;
-
     case ACT_PlayAvi:
       GUI_PlayAvi ();
       break;
@@ -547,18 +518,7 @@
       	//GUI_FileSelWrite ("Select Jpg to save ", A_saveJpg);
       	break;
 
-    case ACT_Scale:
-      if (!ignore_change)
-	{
-	  ignore_change++;
-	  nf = GUI_GetScale ();
-	  if (!SliderIsShifted) GUI_GoToKFrame (nf);
-	  else GUI_GoToFrame (nf);
-	  ignore_change--;
-
-	}
-//        printf("\n new frame : %lu",nf);
-      break;
+  
 #define TOGGLE_PREVIEW ADM_PREVIEW_OUTPUT
     case ACT_PreviewChanged:
     {
@@ -583,64 +543,14 @@
       A_setPostproc();
       break;
 
-    case ACT_NextFrame:
-      GUI_NextFrame ();
-      break;
-    case ACT_NextKFrame:
-      GUI_NextKeyFrame ();
-      break;
-    case ACT_NextBlackFrame:
-      GUI_NextPrevBlackFrame(1);
-      break;
-    case ACT_PrevBlackFrame:
-      GUI_NextPrevBlackFrame(-1);
-      break;
+   
     case ACT_AllBlackFrames:
       GUI_FileSelWrite (QT_TR_NOOP("Select File to Save"), (SELFILE_CB *)A_ListAllBlackFrames);
         break;
 
-    case ACT_PreviousFrame:
-        GUI_PrevFrame();
-      break;
-    case ACT_Forward100Frames:
-      //GUI_GoToKFrame (curframe + (avifileinfo->fps1000 / 1000 * 4));
-      break;
+ 
 
-    case ACT_Back100Frames:
-      //GUI_GoToKFrame (curframe - (avifileinfo->fps1000 / 1000 * 4));
-      break;
-
-
-    case ACT_Forward50Frames:
-      //GUI_GoToFrame (curframe + 50);
-      break;
-
-    case ACT_Forward25Frames:
-      //GUI_GoToFrame (curframe + 25);
-      break;
-
-    case ACT_Back50Frames:
-      //if (curframe >= 50)
-	{
-	  DIA_StartBusy ();
-	  //GUI_GoToFrame (curframe - 50);
-	  DIA_StopBusy ();
-	}
-      break;
-
-    case ACT_Back25Frames:
-    //  if (curframe >= 25)
-	{
-	  DIA_StartBusy ();
-	  //GUI_GoToFrame (curframe - 25);
-	  DIA_StopBusy ();
-
-	}
-      break;
-
-    case ACT_PreviousKFrame:
-      GUI_PreviousKeyFrame ();
-      break;
+ 
     case ACT_AudioSourceAvi:
       //currentaudiostream=aviaudiostream;
       A_changeAudioStream (aviaudiostream, AudioAvi,NULL);
@@ -680,26 +590,7 @@
 	}
       UI_setMarkers (frameStart, frameEnd);
       break;
-    case ACT_GotoMarkA:
-    case ACT_GotoMarkB:
-
-      if (action == ACT_GotoMarkA)
-	nf = frameStart;
-      else
-	nf = frameEnd;
-      GUI_GoToFrame (nf);
-      break;
-    case ACT_Goto:
-      uint32_t fn;
-      fn=video_body->getCurrentFrame();
-      if (DIA_GetIntegerValue ((int *)&fn,0,avifileinfo->nb_frames,QT_TR_NOOP("Go to Frame"),QT_TR_NOOP("_Go to frame:")))
-	{
-		if (fn < avifileinfo->nb_frames)
-			GUI_GoToFrame (fn);
-		else
-			GUI_Error_HIG (QT_TR_NOOP("Out of bounds"), NULL);
-	}
-      break;
+  
 //----------------------test-----------------------
     case ACT_SaveAvi:
       GUI_FileSelWrite (QT_TR_NOOP("Select File to Save"),(SELFILE_CB *)A_SaveWrapper); // A_SaveAudioNVideo);
@@ -1886,19 +1777,7 @@
 }
 extern int DIA_getMPParams( uint32_t *pplevel, uint32_t *ppstrength,uint32_t *swap);
 //
-uint8_t A_jumpToTime(uint32_t hh,uint32_t mm,uint32_t ss,uint32_t ms)
-{
-uint32_t frame;
-        time2frame(&frame,avifileinfo->fps1000,hh,mm,ss,ms);
-        if(frame>=avifileinfo->nb_frames)
-        {
-                printf("Frame is out of bound\n");
-                return 0;
-        }
-        return GUI_GoToFrame(frame);
 
-}
-
 //
 void	A_setPostproc( void )
 {

Modified: branches/avidemux_2.6_branch_mean/avidemux/gtkgui.h
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/gtkgui.h	2009-02-22 18:27:36 UTC (rev 4623)
+++ branches/avidemux_2.6_branch_mean/avidemux/gtkgui.h	2009-02-22 18:27:38 UTC (rev 4624)
@@ -36,7 +36,7 @@
 void GUI_detransient(void );
 void GUI_retransient(void );
 
-uint8_t GUI_getFrameContent(ADMImage *image, uint32_t frame);
+//
 
 //EOF
 

Modified: branches/avidemux_2.6_branch_mean/avidemux/gui_action.names
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/gui_action.names	2009-02-22 18:27:36 UTC (rev 4623)
+++ branches/avidemux_2.6_branch_mean/avidemux/gui_action.names	2009-02-22 18:27:38 UTC (rev 4624)
@@ -30,6 +30,8 @@
 ACT(XVCD)
 
 ACT(SetPostProcessing)
+//--- NAVIGATE----
+ACT(NAVIGATE_BEGIN)
 ACT(NextFrame)
 ACT(Back100Frames)
 ACT(Back50Frames)
@@ -42,16 +44,21 @@
 ACT(PreviousFrame)
 ACT(PrevBlackFrame)
 ACT(NextBlackFrame)
-ACT(AllBlackFrames)
-
-ACT(Scale)
-
 ACT(Goto)
 ACT(GotoTime)
-
 ACT(Begin)
 ACT(End)
+ACT(GotoMarkA)
+ACT(GotoMarkB)
+ACT(Scale)
+ACT(NAVIGATE_END)
+//--- NAVIGATE----
+ACT(AllBlackFrames)
 
+
+
+
+
 ACT(AudioSourceAvi)
 ACT(AudioSourceMP3)
 ACT(AudioSourceWAV)
@@ -60,8 +67,6 @@
 
 ACT(MarkA)
 ACT(MarkB)
-ACT(GotoMarkA)
-ACT(GotoMarkB)
 
 ACT(AudioModeProcess)
 ACT(AudioModeCopy)

Modified: branches/avidemux_2.6_branch_mean/avidemux/gui_navigate.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/gui_navigate.cpp	2009-02-22 18:27:36 UTC (rev 4623)
+++ branches/avidemux_2.6_branch_mean/avidemux/gui_navigate.cpp	2009-02-22 18:27:38 UTC (rev 4624)
@@ -18,153 +18,167 @@
  *                                                                         *
  ***************************************************************************/
 
-
+#include "ADM_default.h"
 #include "avi_vars.h"
 
 #include <math.h>
-
-#include "DIA_fileSel.h"
-#include "ADM_assert.h"
 #include "prototype.h"
-#include "audio_out.h"
-#include "ADM_audio/aviaudio.hxx"
-#include "ADM_audiofilter/audioprocess.hxx"
 #include "gui_action.hxx"
 #include "gtkgui.h"
+
 #include "DIA_coreToolkit.h"
-#include "ADM_userInterfaces/ADM_render/GUI_render.h"
-#include "DIA_working.h"
-#include "ADM_videoFilter.h"
-#include "ADM_videoFilter_internal.h"
 #include "ADM_userInterfaces/ADM_commonUI/DIA_busy.h"
 #include "ADM_userInterfaces/ADM_commonUI/GUI_ui.h"
+#include "DIA_enter.h"
 
 #include "ADM_video/ADM_vidMisc.h"
 #include "ADM_preview.h"
 
-extern void    UI_purge(void );
+extern void UI_purge(void);
+extern uint8_t DIA_gotoTime(uint16_t *hh, uint16_t *mm, uint16_t *ss);
+extern bool SliderIsShifted;
+
+uint8_t A_jumpToTime(uint32_t hh,uint32_t mm,uint32_t ss,uint32_t ms);
 /**
     \fn HandleAction_Navigate
 
 */
-void HandleAction_Navigate (Action action)
+void HandleAction_Navigate(Action action)
 {
-    switch(action)
-    {
-  case ACT_GotoMarkA:
-    case ACT_GotoMarkB:
+static int ignore_change=0;
+    switch (action)
+      {
+      case ACT_Scale:
+        if (!ignore_change)
+        {
+          uint32_t nf;
+          ignore_change++;
+          nf = GUI_GetScale ();
+          if (!SliderIsShifted) GUI_GoToKFrame (nf);
+          else GUI_GoToFrame (nf);
+          ignore_change--;
 
-      if (action == ACT_GotoMarkA)
-	nf = frameStart;
-      else
-	nf = frameEnd;
-      GUI_GoToFrame (nf);
-      break;
-    case ACT_Goto:
-      uint32_t fn;
-      fn=video_body->getCurrentFrame();
-      if (DIA_GetIntegerValue ((int *)&fn,0,avifileinfo->nb_frames,QT_TR_NOOP("Go to Frame"),QT_TR_NOOP("_Go to frame:")))
-	{
+        }
+        break;
+      case ACT_GotoMarkA:
+      case ACT_GotoMarkB:
+            {
+                uint32_t nf;
+                  if (action == ACT_GotoMarkA)
+                      nf = frameStart;
+                  else
+                      nf = frameEnd;
+                  GUI_GoToFrame(nf);
+            }
+	  break;
+      case ACT_Goto:
+	  uint32_t fn;
+	  fn = video_body->getCurrentFrame();
+	  if (DIA_GetIntegerValue
+	      ((int *) &fn, 0, avifileinfo->nb_frames,
+	       QT_TR_NOOP("Go to Frame"), QT_TR_NOOP("_Go to frame:")))
+	    {
 		if (fn < avifileinfo->nb_frames)
-			GUI_GoToFrame (fn);
+		    GUI_GoToFrame(fn);
 		else
-			GUI_Error_HIG (QT_TR_NOOP("Out of bounds"), NULL);
-	}
-      break;
-   case ACT_Back25Frames:
-    //  if (curframe >= 25)
-	{
-	  DIA_StartBusy ();
-	  //GUI_GoToFrame (curframe - 25);
-	  DIA_StopBusy ();
+		    GUI_Error_HIG(QT_TR_NOOP("Out of bounds"), NULL);
+	    }
+	  break;
+      case ACT_Back25Frames:
+          if (video_body->getCurrentFrame() >= 25)
+          {
+              DIA_StartBusy();
+              GUI_GoToFrame (video_body->getCurrentFrame() - 25);
+              DIA_StopBusy();
+          }
+	  break;
 
-	}
-      break;
-
-    case ACT_PreviousKFrame:
-      GUI_PreviousKeyFrame ();
-      break;
-   case ACT_PreviousFrame:
+      case ACT_PreviousKFrame:
+        GUI_PreviousKeyFrame();
+	  break;
+      case ACT_PreviousFrame:
         GUI_PrevFrame();
-      break;
-    case ACT_Forward100Frames:
-      //GUI_GoToKFrame (curframe + (avifileinfo->fps1000 / 1000 * 4));
-      break;
+	  break;
+      case ACT_Forward100Frames:
+        //GUI_GoToKFrame (curframe + (avifileinfo->fps1000 / 1000 * 4));
+	  break;
 
-    case ACT_Back100Frames:
-      //GUI_GoToKFrame (curframe - (avifileinfo->fps1000 / 1000 * 4));
-      break;
+      case ACT_Back100Frames:
+        //GUI_GoToKFrame (curframe - (avifileinfo->fps1000 / 1000 * 4));
+	  break;
 
 
-    case ACT_Forward50Frames:
-      //GUI_GoToFrame (curframe + 50);
-      break;
+      case ACT_Forward50Frames:
+	  // GUI_GoToFrame (curframe + 50);
+	  break;
 
-    case ACT_Forward25Frames:
-      //GUI_GoToFrame (curframe + 25);
-      break;
+      case ACT_Forward25Frames:
+	  // GUI_GoToFrame (curframe + 25);
+	  break;
 
-    case ACT_Back50Frames:
-      //if (curframe >= 50)
-	{
-	  DIA_StartBusy ();
-	  //GUI_GoToFrame (curframe - 50);
-	  DIA_StopBusy ();
-	}
-      break;
- case ACT_NextFrame:
-      GUI_NextFrame ();
-      break;
-    case ACT_NextKFrame:
-      GUI_NextKeyFrame ();
-      break;
-    case ACT_NextBlackFrame:
-      GUI_NextPrevBlackFrame(1);
-      break;
-    case ACT_PrevBlackFrame:
-      GUI_NextPrevBlackFrame(-1);
-      break;
-   case ACT_End:
+      case ACT_Back50Frames:
+	  // if (curframe >= 50)
+	  {
+	      DIA_StartBusy();
+	      // GUI_GoToFrame (curframe - 50);
+	      DIA_StopBusy();
+	  }
+	  break;
+      case ACT_NextFrame:
+        GUI_NextFrame();
+	  break;
+      case ACT_NextKFrame:
+        GUI_NextKeyFrame();
+	  break;
+      case ACT_NextBlackFrame:
+        GUI_NextPrevBlackFrame(1);
+	  break;
+      case ACT_PrevBlackFrame:
+        GUI_NextPrevBlackFrame(-1);
+	  break;
+      case ACT_End:
+            {
+                uint32_t nf = avifileinfo->nb_frames;
+                          GUI_GoToFrame(nf - 1);
+            }
+	  break;
+      case ACT_Begin:
+        GUI_GoToKFrame(0);
+	  break;
+      case ACT_JumpToFrame:
+        {
+              // read value
+              uint32_t nf = UI_readCurFrame();
+              if (nf < avifileinfo->nb_frames)
+                  GUI_GoToFrame(nf);
+              UI_JumpDone();
+        }
+	  break;
+      case ACT_JumpToTime:
+	  {
+	      uint16_t hh, mm, ss, ms;
 
-      nf = avifileinfo->nb_frames;
-      GUI_GoToFrame (nf - 1);
+	      if (UI_readCurTime(hh, mm, ss, ms))
+		  A_jumpToTime(hh, mm, ss, ms);
+	  }
+	  break;
+      case ACT_GotoTime:
+	  {
+           // Get current time
+            uint64_t pts=video_body->estimatePts(video_body->getCurrentFrame());
 
-      break;
-  case ACT_Begin:
-      GUI_GoToKFrame (0);
-
-      break;
-  case ACT_JumpToFrame:
-                // read value
-                nf=UI_readCurFrame();
-				if(nf< avifileinfo->nb_frames)
-					GUI_GoToFrame(nf);
-                UI_JumpDone();
-                break;
-	case ACT_JumpToTime:
-		{
-			uint16_t hh, mm, ss, ms;
-
-			if (UI_readCurTime(hh, mm, ss, ms))
-				A_jumpToTime(hh, mm, ss, ms);
-		}
-		break;
-    case ACT_GotoTime:
-                {
-#if 0
-                        uint16_t mm,hh,ss,ms;
-                             frame2time(curframe,avifileinfo->fps1000,&hh,&mm,&ss,&ms);
-                             if(DIA_gotoTime(&hh,&mm,&ss))
-                                {
-                                        A_jumpToTime(hh,mm,ss, 0);
-                                }
-#endif
-                }
-                break;
-    default:
-        ADM_assert(0);
-        break;
-    }
+	      uint16_t mm, hh, ss, ms;
+            ms2time((uint32_t)(pts/1000),&hh,&mm,&ss,&ms);
+	      if (DIA_gotoTime(&hh, &mm, &ss))
+          {
+		    A_jumpToTime(hh, mm, ss, 0);
+          }
+	  }
+	  break;
+      default:
+	  ADM_assert(0);
+	  break;
+      }
 }
 /**
     \fn GUI_NextFrame
@@ -172,14 +186,16 @@
 */
 void GUI_NextFrame(uint32_t frameCount)
 {
-//    uint8_t *ptr;
-uint32_t flags;
-    if (playing)	return;
-    if (!avifileinfo) return;
+    // uint8_t *ptr;
+    uint32_t flags;
+    if (playing)
+	return;
+    if (!avifileinfo)
+	return;
 
-      admPreview::nextPicture( ) ;
-      GUI_setCurrentFrameAndTime();
-      UI_purge();
+    admPreview::nextPicture();
+    GUI_setCurrentFrameAndTime();
+    UI_purge();
 }
 
 
@@ -190,15 +206,17 @@
 */
 void GUI_NextKeyFrame(void)
 {
- 
-    if (playing)	return;
-    if (!avifileinfo) return;
 
-    if(!admPreview::nextKeyFrame())
-    {
+    if (playing)
+	return;
+    if (!avifileinfo)
+	return;
+
+    if (!admPreview::nextKeyFrame())
+      {
         GUI_Error_HIG(QT_TR_NOOP("Error"),QT_TR_NOOP("Cannot go to next keyframe"));
         return;
-    }
+      }
     GUI_setCurrentFrameAndTime();
     UI_purge();
 }
@@ -210,21 +228,23 @@
 void GUI_GoToKFrame(uint32_t frame)
 {
 
-    if (playing)            return;
-    if(!avifileinfo) return;
+    if (playing)
+	return;
+    if (!avifileinfo)
+	return;
     uint32_t f;
-    video_body->getFlags(0,&f);
-    if(!frame && (f&AVI_KEY_FRAME))
-    {
+    video_body->getFlags(0, &f);
+    if (!frame && (f & AVI_KEY_FRAME))
+      {
 
-    }else
-    {
-        if(!video_body->getPKFrame(&frame))
-        {
-            printf("[GUI_GoToKFrame] failed for frame %u\n",frame);
-            return;
-        }
-    }
+    } else
+      {
+	  if (!video_body->getPKFrame(&frame))
+	    {
+		printf("[GUI_GoToKFrame] failed for frame %u\n", frame);
+		return;
+	    }
+      }
     admPreview::seekToIntra(frame);
     admPreview::samePicture();
     GUI_setCurrentFrameAndTime();
@@ -236,15 +256,21 @@
 */
 int GUI_GoToFrame(uint32_t frame)
 {
-uint32_t flags;
+    uint32_t flags;
 
-      if (playing)              return 0;
-      if (!avifileinfo)         return 0;
-      if(frame>=avifileinfo->nb_frames) return 0;
-    
-     if(! video_body->setCurrentFrame(frame)) return 0;
-     return admPreview::samePicture();
-    
+    if (playing)
+        return 0;
+    if (!avifileinfo)
+        return 0;
+    if (frame >= avifileinfo->nb_frames)
+        return 0;
+
+    if (!video_body->setCurrentFrame(frame))
+        return 0;    
+
+    if(!admPreview::samePicture()) return 0;
+    GUI_setAllFrameAndTime();
+    return 1;
 }
 
 /**
@@ -255,19 +281,22 @@
 void GUI_PreviousKeyFrame(void)
 {
 
- uint32_t f;
- uint32_t flags;
+    uint32_t f;
+    uint32_t flags;
 
 
-    if (playing)		return;
-    if (!avifileinfo)   return;
+    if (playing)
+	return;
+    if (!avifileinfo)
+	return;
 
 
-    if(!admPreview::previousKeyFrame())
-    {
-        GUI_Error_HIG(QT_TR_NOOP("Error"),QT_TR_NOOP("Cannot go to next keyframe"));
-        return;
-    }
+    if (!admPreview::previousKeyFrame())
+      {
+	  GUI_Error_HIG(QT_TR_NOOP("Error"),
+			QT_TR_NOOP("Cannot go to next keyframe"));
+	  return;
+      }
     GUI_setCurrentFrameAndTime();
     UI_purge();
 
@@ -276,25 +305,25 @@
 uint8_t A_rebuildKeyFrame(void)
 {
 
-        return video_body->rebuildFrameType();
+    return video_body->rebuildFrameType();
 }
 /**
     \fn GUI_PrevFrame
     \brief Go to current frame -1
 */
-void        GUI_PrevFrame(uint32_t frameCount)
+void GUI_PrevFrame(uint32_t frameCount)
 {
-      return; 
+    return;
 }
 /**
       \fn A_jogRead
       \brief read an average value of jog
 */
 #define NB_JOG_READ           3
-#define JOG_READ_PERIOD_US    5*1000 // 5ms
+#define JOG_READ_PERIOD_US    5*1000	// 5ms
 #define JOG_THRESH1           40
 #define JOG_THRESH2           80
-#define JOG_THRESH1_PERIOD    100*1000 //us
+#define JOG_THRESH1_PERIOD    100*1000	// us
 #define JOG_THRESH2_PERIOD    40*1000
 #define JOG_THRESH3_PERIOD    500
 /**
@@ -303,15 +332,16 @@
 */
 uint32_t A_jogRead(void)
 {
-  int32_t sum=0,v;
-    for(int i=0;i<NB_JOG_READ;i++)
-    {
-        v=UI_readJog();
-        if(abs(v)<10) v=0;
-        sum+=v;
-        ADM_usleep(JOG_READ_PERIOD_US);
-    } 
-    return sum/NB_JOG_READ;
+    int32_t sum = 0, v;
+    for (int i = 0; i < NB_JOG_READ; i++)
+      {
+	  v = UI_readJog();
+	  if (abs(v) < 10)
+	      v = 0;
+	  sum += v;
+	  ADM_usleep(JOG_READ_PERIOD_US);
+      }
+    return sum / NB_JOG_READ;
 }
 #define REFRESH 10000
 /**
@@ -320,60 +350,66 @@
 */
 void A_jog(void)
 {
-  int32_t r;
-  uint32_t a;
-  uint32_t slip;
-  static int jog=0;
-  if(jog) return;
-  jog++;
-  while(r=A_jogRead())
-  {
-      a=abs(r);
-      printf("%d \n",r);
-      if(a<JOG_THRESH1) slip=JOG_THRESH1_PERIOD;
-        else if(a<JOG_THRESH2) slip=JOG_THRESH2_PERIOD;
-          else slip=JOG_THRESH3_PERIOD;
-    
-      if(r>0) GUI_NextKeyFrame();
-      else GUI_PreviousKeyFrame();       
-      UI_purge();
-      for(int i=0;i<slip/REFRESH;i++)
+    int32_t r;
+    uint32_t a;
+    uint32_t slip;
+    static int jog = 0;
+    if (jog)
+	return;
+    jog++;
+    while (r = A_jogRead())
       {
-        UI_purge();
-        ADM_usleep(REFRESH);
-        UI_purge();
+	  a = abs(r);
+	  printf("%d \n", r);
+	  if (a < JOG_THRESH1)
+	      slip = JOG_THRESH1_PERIOD;
+	  else if (a < JOG_THRESH2)
+	      slip = JOG_THRESH2_PERIOD;
+	  else
+	      slip = JOG_THRESH3_PERIOD;
+
+	  if (r > 0)
+	      GUI_NextKeyFrame();
+	  else
+	      GUI_PreviousKeyFrame();
+	  UI_purge();
+	  for (int i = 0; i < slip / REFRESH; i++)
+	    {
+		UI_purge();
+		ADM_usleep(REFRESH);
+		UI_purge();
+	    }
       }
-  }
-  jog--;
+    jog--;
 }
 /**
     \fn     GUI_setAllFrameAndTime
     \brief  Update all  informations : current frame # and current time, total frame ...
 
 */
-void  GUI_setAllFrameAndTime(void)
+void GUI_setAllFrameAndTime(void)
 {
     char text[80];
     double len;
-//    int val;
+    // int val;
 
-    //    if(!guiReady) return ;
+    // if(!guiReady) return ;
     text[0] = 0;
- 
-	UI_updateFrameCount(video_body->getCurrentFrame());
+
+    UI_updateFrameCount(video_body->getCurrentFrame());
     UI_setCurrentTime(admPreview::getCurrentPts());
-	UI_setTotalTime(video_body->getVideoDuration());
-    
+    UI_setTotalTime(video_body->getVideoDuration());
+
     // progress bar
     len = 100;
-    if(avifileinfo->nb_frames>1)
-    	len=len / (double) (avifileinfo->nb_frames-1);
+    if (avifileinfo->nb_frames > 1)
+	len = len / (double) (avifileinfo->nb_frames - 1);
     len *= (double) video_body->getCurrentFrame();
 
-   
 
-     UI_setScale(len);
-   	
+
+    UI_setScale(len);
+
 }
 
 /**
@@ -384,22 +420,45 @@
 {
     char text[80];
     double len;
-//    int val;
+    // int val;
 
-    //    if(!guiReady) return ;
+    // if(!guiReady) return ;
     text[0] = 0;
- 
-	UI_setFrameCount( video_body->getCurrentFrame(), avifileinfo->nb_frames);
-	UI_setCurrentTime(admPreview::getCurrentPts());
-	
+
+    UI_setFrameCount(video_body->getCurrentFrame(),
+		     avifileinfo->nb_frames);
+    UI_setCurrentTime(admPreview::getCurrentPts());
+
     // progress bar
     len = 100;
-    if(avifileinfo->nb_frames>1)
-    	len=len / (double) (avifileinfo->nb_frames-1);
+    if (avifileinfo->nb_frames > 1)
+	len = len / (double) (avifileinfo->nb_frames - 1);
     len *= (double) video_body->getCurrentFrame();
 
 
 
-     UI_setScale(len);
+    UI_setScale(len);
 }
-//EOF
+/**
+    \fn A_jumpToTime
+    \brief Jump to a given time
+*/
+#warning CFR ASSUMED FIXME
+#warning CFR ASSUMED FIXME
+#warning CFR ASSUMED FIXME
+#warning CFR ASSUMED FIXME
+#warning CFR ASSUMED FIXME
+uint8_t A_jumpToTime(uint32_t hh,uint32_t mm,uint32_t ss,uint32_t ms)
+{
+uint32_t frame;
+        time2frame(&frame,avifileinfo->fps1000,hh,mm,ss,ms);
+        if(frame>=avifileinfo->nb_frames)
+        {
+                printf("Frame is out of bound\n");
+                return 0;
+        }
+        return GUI_GoToFrame(frame);
+
+}
+
+// EOF



From gruntster at mail.berlios.de  Mon Feb 23 10:22:58 2009
From: gruntster at mail.berlios.de (gruntster at mail.berlios.de)
Date: Mon, 23 Feb 2009 10:22:58 +0100
Subject: [Avidemux-svn-commit] r4625 -
	branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_x264/qt4
Message-ID: <200902230922.n1N9Mwxq024044@sheep.berlios.de>

Author: gruntster
Date: 2009-02-23 10:22:52 +0100 (Mon, 23 Feb 2009)
New Revision: 4625

Modified:
   branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_x264/qt4/x264ConfigDialog.cpp
Log:
[x264] fix setting of max GOP on x264 config window for Qt

Modified: branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_x264/qt4/x264ConfigDialog.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_x264/qt4/x264ConfigDialog.cpp	2009-02-22 18:27:38 UTC (rev 4624)
+++ branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_x264/qt4/x264ConfigDialog.cpp	2009-02-23 09:22:52 UTC (rev 4625)
@@ -675,7 +675,7 @@
 	ui.bFrameRefCheckBox->setChecked(options->getBFrameReferences());
 	ui.adaptiveBFrameComboBox->setCurrentIndex(options->getAdaptiveBFrameDecision());
 	ui.maxGopSizeSpinBox->setValue(options->getGopMaximumSize());
-	ui.minGopSizeSpinBox->setValue(options->getGopMaximumSize());
+	ui.minGopSizeSpinBox->setValue(options->getGopMinimumSize());
 	ui.IFrameThresholdSpinBox->setValue(options->getScenecutThreshold());
 	ui.scenecutDetectionCheckBox->setChecked(options->getPreScenecutDetection());
 
@@ -883,7 +883,7 @@
 	options->setBFrameReferences(ui.bFrameRefCheckBox->isChecked());
 	options->setAdaptiveBFrameDecision(ui.adaptiveBFrameComboBox->currentIndex());
 	options->setGopMaximumSize(ui.maxGopSizeSpinBox->value());
-	options->setGopMaximumSize(ui.minGopSizeSpinBox->value());
+	options->setGopMinimumSize(ui.minGopSizeSpinBox->value());
 	options->setScenecutThreshold(ui.IFrameThresholdSpinBox->value());
 	options->setPreScenecutDetection(ui.scenecutDetectionCheckBox->isChecked());
 



From gruntster at mail.berlios.de  Mon Feb 23 11:54:13 2009
From: gruntster at mail.berlios.de (gruntster at mail.berlios.de)
Date: Mon, 23 Feb 2009 11:54:13 +0100
Subject: [Avidemux-svn-commit] r4626 -
	branches/avidemux_2.5_branch_gruntster/avidemux
Message-ID: <200902231054.n1NAsDEf000390@sheep.berlios.de>

Author: gruntster
Date: 2009-02-23 11:54:08 +0100 (Mon, 23 Feb 2009)
New Revision: 4626

Modified:
   branches/avidemux_2.5_branch_gruntster/avidemux/CMakeLists.txt
Log:
[mac] CMake 2.6 support for Mac build (patch by surfer)

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/CMakeLists.txt
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/CMakeLists.txt	2009-02-23 09:22:52 UTC (rev 4625)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/CMakeLists.txt	2009-02-23 10:54:08 UTC (rev 4626)
@@ -83,6 +83,10 @@
 	SET(MACOSX_BUNDLE_LONG_VERSION_STRING "${ADM_OSX_VERSION}") 
 	SET(MACOSX_BUNDLE_SHORT_VERSION_STRING "${ADM_OSX_VERSION}")
 	SET(MACOSX_BUNDLE_VERSION "${ADM_OSX_VERSION}")
+	SET(MACOSX_BUNDLE_BUNDLE_NAME "Avidemux" )
+	SET(MACOSX_BUNDLE_COPYRIGHT "Copyright 2001-2009 Mean" )
+	SET(MACOSX_BUNDLE_SIGNATURE "Avdx" )
+	SET(MACOSX_BUNDLE_GUI_IDENTIFIER www.avidemux.org)
 
 	# include translation files in bundle
 	# this isn't the cleanest approach but there's not much we can do until the po directory is under the avidemux directory
@@ -456,4 +460,12 @@
 	SET(ADM_EXES ${ADM_EXES} avidemux2_qt4)
 ENDIF (ADM_UI_QT4)
 
-INSTALL(TARGETS ${ADM_EXES} RUNTIME DESTINATION ${BIN_DIR} LIBRARY DESTINATION lib)
+IF (APPLE)
+	IF (NOT MAC_BUNDLE_DIR)
+		INSTALL(TARGETS ${ADM_EXES} RUNTIME DESTINATION ${BIN_DIR} BUNDLE DESTINATION "/Applications" LIBRARY DESTINATION lib)
+	ELSE (NOT MAC_BUNDLE_DIR)
+		INSTALL(TARGETS ${ADM_EXES} RUNTIME DESTINATION ${BIN_DIR} BUNDLE DESTINATION ${MAC_BUNDLE_DIR} LIBRARY DESTINATION lib)
+	ENDIF (NOT MAC_BUNDLE_DIR)
+ELSE (APPLE)
+	INSTALL(TARGETS ${ADM_EXES} RUNTIME DESTINATION ${BIN_DIR} LIBRARY DESTINATION lib)
+ENDIF (APPLE)



From gruntster at mail.berlios.de  Mon Feb 23 19:40:41 2009
From: gruntster at mail.berlios.de (gruntster at mail.berlios.de)
Date: Mon, 23 Feb 2009 19:40:41 +0100
Subject: [Avidemux-svn-commit] r4627 -
	branches/avidemux_2.5_branch_gruntster/avidemux/ADM_core/include
Message-ID: <200902231840.n1NIefn7016256@sheep.berlios.de>

Author: gruntster
Date: 2009-02-23 19:40:36 +0100 (Mon, 23 Feb 2009)
New Revision: 4627

Modified:
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_core/include/ADM_mangle.h
Log:
[mac] fix name mangling for Mac

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_core/include/ADM_mangle.h
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_core/include/ADM_mangle.h	2009-02-23 10:54:08 UTC (rev 4626)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_core/include/ADM_mangle.h	2009-02-23 18:40:36 UTC (rev 4627)
@@ -17,7 +17,8 @@
 
 // Use rip-relative addressing if compiling PIC code on x86-64.
 #if defined(__MINGW32__) || defined(__CYGWIN__) || defined(__DJGPP__) || \
-    defined(__OS2__) || (defined (__OpenBSD__) && !defined(__ELF__))
+    defined(__OS2__) || (defined (__OpenBSD__) && !defined(__ELF__)) || \
+	defined(__APPLE__)
 #    if defined(ADM_CPU_X86_64) && defined(PIC) && !defined(__MINGW32__)
 #        define MANGLE(a) "_" #a"(%%rip)"
 #        define FUNNY_MANGLE(x) x asm(MANGLE(x))



From gruntster at mail.berlios.de  Mon Feb 23 21:21:13 2009
From: gruntster at mail.berlios.de (gruntster at mail.berlios.de)
Date: Mon, 23 Feb 2009 21:21:13 +0100
Subject: [Avidemux-svn-commit] r4628 -
	branches/avidemux_2.5_branch_gruntster/cmake
Message-ID: <200902232021.n1NKLDe2027124@sheep.berlios.de>

Author: gruntster
Date: 2009-02-23 21:21:07 +0100 (Mon, 23 Feb 2009)
New Revision: 4628

Modified:
   branches/avidemux_2.5_branch_gruntster/cmake/admFFmpegUtil.cmake
Log:
[mac] correctly reference ffmpeg libs on Mac

Modified: branches/avidemux_2.5_branch_gruntster/cmake/admFFmpegUtil.cmake
===================================================================
--- branches/avidemux_2.5_branch_gruntster/cmake/admFFmpegUtil.cmake	2009-02-23 18:40:36 UTC (rev 4627)
+++ branches/avidemux_2.5_branch_gruntster/cmake/admFFmpegUtil.cmake	2009-02-23 20:21:07 UTC (rev 4628)
@@ -17,6 +17,12 @@
 		set(LIBAVUTIL_LIB libavutil${CMAKE_SHARED_LIBRARY_SUFFIX}.${LIBAVUTIL_VERSION})
 		set(LIBPOSTPROC_LIB libpostproc${CMAKE_SHARED_LIBRARY_SUFFIX}.${LIBPOSTPROC_VERSION})
 		set(LIBSWSCALE_LIB libswscale${CMAKE_SHARED_LIBRARY_SUFFIX}.${LIBSWSCALE_VERSION})
+	elseif (APPLE)
+		set(LIBAVCODEC_LIB libavcodec.${LIBAVCODEC_VERSION}${CMAKE_SHARED_LIBRARY_SUFFIX})
+		set(LIBAVFORMAT_LIB libavformat.${LIBAVFORMAT_VERSION}${CMAKE_SHARED_LIBRARY_SUFFIX})
+		set(LIBAVUTIL_LIB libavutil.${LIBAVUTIL_VERSION}${CMAKE_SHARED_LIBRARY_SUFFIX})
+		set(LIBPOSTPROC_LIB libpostproc.${LIBPOSTPROC_VERSION}${CMAKE_SHARED_LIBRARY_SUFFIX})
+		set(LIBSWSCALE_LIB libswscale.${LIBSWSCALE_VERSION}${CMAKE_SHARED_LIBRARY_SUFFIX})
 	else (UNIX)	
 		set(LIBAVCODEC_LIB avcodec-${LIBAVCODEC_VERSION}${CMAKE_SHARED_LIBRARY_SUFFIX})
 		set(LIBAVFORMAT_LIB avformat-${LIBAVFORMAT_VERSION}${CMAKE_SHARED_LIBRARY_SUFFIX})



From gruntster at mail.berlios.de  Mon Feb 23 22:06:22 2009
From: gruntster at mail.berlios.de (gruntster at mail.berlios.de)
Date: Mon, 23 Feb 2009 22:06:22 +0100
Subject: [Avidemux-svn-commit] r4629 -
	branches/avidemux_2.5_branch_gruntster/cmake
Message-ID: <200902232106.n1NL6MjD031968@sheep.berlios.de>

Author: gruntster
Date: 2009-02-23 22:06:17 +0100 (Mon, 23 Feb 2009)
New Revision: 4629

Modified:
   branches/avidemux_2.5_branch_gruntster/cmake/admFFmpegUtil.cmake
Log:
[mac] fix referencing of ffmpeg libs on Mac

Modified: branches/avidemux_2.5_branch_gruntster/cmake/admFFmpegUtil.cmake
===================================================================
--- branches/avidemux_2.5_branch_gruntster/cmake/admFFmpegUtil.cmake	2009-02-23 20:21:07 UTC (rev 4628)
+++ branches/avidemux_2.5_branch_gruntster/cmake/admFFmpegUtil.cmake	2009-02-23 21:06:17 UTC (rev 4629)
@@ -11,23 +11,23 @@
 	getFfmpegVersionFromHeader("libpostproc" "${sourceDir}/libpostproc/postprocess.h" LIBPOSTPROC_VERSION_MAJOR LIBPOSTPROC_VERSION)
 	getFfmpegVersionFromHeader("libswscale" "${sourceDir}/libswscale/swscale.h" LIBSWSCALE_VERSION_MAJOR LIBSWSCALE_VERSION)
 
-	if (UNIX)
+	if (APPLE)
+		set(LIBAVCODEC_LIB libavcodec.${LIBAVCODEC_VERSION}${CMAKE_SHARED_LIBRARY_SUFFIX})
+		set(LIBAVFORMAT_LIB libavformat.${LIBAVFORMAT_VERSION}${CMAKE_SHARED_LIBRARY_SUFFIX})
+		set(LIBAVUTIL_LIB libavutil.${LIBAVUTIL_VERSION}${CMAKE_SHARED_LIBRARY_SUFFIX})
+		set(LIBPOSTPROC_LIB libpostproc.${LIBPOSTPROC_VERSION}${CMAKE_SHARED_LIBRARY_SUFFIX})
+		set(LIBSWSCALE_LIB libswscale.${LIBSWSCALE_VERSION}${CMAKE_SHARED_LIBRARY_SUFFIX})	
+	elseif (UNIX)
 		set(LIBAVCODEC_LIB libavcodec${CMAKE_SHARED_LIBRARY_SUFFIX}.${LIBAVCODEC_VERSION})
 		set(LIBAVFORMAT_LIB libavformat${CMAKE_SHARED_LIBRARY_SUFFIX}.${LIBAVFORMAT_VERSION})
 		set(LIBAVUTIL_LIB libavutil${CMAKE_SHARED_LIBRARY_SUFFIX}.${LIBAVUTIL_VERSION})
 		set(LIBPOSTPROC_LIB libpostproc${CMAKE_SHARED_LIBRARY_SUFFIX}.${LIBPOSTPROC_VERSION})
 		set(LIBSWSCALE_LIB libswscale${CMAKE_SHARED_LIBRARY_SUFFIX}.${LIBSWSCALE_VERSION})
-	elseif (APPLE)
-		set(LIBAVCODEC_LIB libavcodec.${LIBAVCODEC_VERSION}${CMAKE_SHARED_LIBRARY_SUFFIX})
-		set(LIBAVFORMAT_LIB libavformat.${LIBAVFORMAT_VERSION}${CMAKE_SHARED_LIBRARY_SUFFIX})
-		set(LIBAVUTIL_LIB libavutil.${LIBAVUTIL_VERSION}${CMAKE_SHARED_LIBRARY_SUFFIX})
-		set(LIBPOSTPROC_LIB libpostproc.${LIBPOSTPROC_VERSION}${CMAKE_SHARED_LIBRARY_SUFFIX})
-		set(LIBSWSCALE_LIB libswscale.${LIBSWSCALE_VERSION}${CMAKE_SHARED_LIBRARY_SUFFIX})
-	else (UNIX)	
+	else (APPLE)
 		set(LIBAVCODEC_LIB avcodec-${LIBAVCODEC_VERSION}${CMAKE_SHARED_LIBRARY_SUFFIX})
 		set(LIBAVFORMAT_LIB avformat-${LIBAVFORMAT_VERSION}${CMAKE_SHARED_LIBRARY_SUFFIX})
 		set(LIBAVUTIL_LIB avutil-${LIBAVUTIL_VERSION}${CMAKE_SHARED_LIBRARY_SUFFIX})
 		set(LIBPOSTPROC_LIB postproc-${LIBPOSTPROC_VERSION}${CMAKE_SHARED_LIBRARY_SUFFIX})
 		set(LIBSWSCALE_LIB swscale-${LIBSWSCALE_VERSION}${CMAKE_SHARED_LIBRARY_SUFFIX})
-	endif (UNIX)
+	endif (APPLE)
 ENDMACRO (getFfmpegLibNames)
\ No newline at end of file



From mean at mail.berlios.de  Tue Feb 24 20:09:03 2009
From: mean at mail.berlios.de (mean at BerliOS)
Date: Tue, 24 Feb 2009 20:09:03 +0100
Subject: [Avidemux-svn-commit] r4630 - in
	branches/avidemux_2.6_branch_mean/avidemux: . ADM_editor
Message-ID: <200902241909.n1OJ93nm000417@sheep.berlios.de>

Author: mean
Date: 2009-02-24 20:09:03 +0100 (Tue, 24 Feb 2009)
New Revision: 4630

Modified:
   branches/avidemux_2.6_branch_mean/avidemux/ADM_editor/ADM_edRender.cpp
   branches/avidemux_2.6_branch_mean/avidemux/ADM_editor/ADM_edit.hxx
   branches/avidemux_2.6_branch_mean/avidemux/gui_navigate.cpp
Log:
[UI] Fix properly go to time

Modified: branches/avidemux_2.6_branch_mean/avidemux/ADM_editor/ADM_edRender.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/ADM_editor/ADM_edRender.cpp	2009-02-23 21:06:17 UTC (rev 4629)
+++ branches/avidemux_2.6_branch_mean/avidemux/ADM_editor/ADM_edRender.cpp	2009-02-24 19:09:03 UTC (rev 4630)
@@ -1092,6 +1092,9 @@
 		aprintf("EdCache: Postproc done\n");
 		return 1;
 }
+/**
+        \fn dupe
+*/
 uint8_t ADM_Composer::dupe(ADMImage *src,ADMImage *dst,_VIDEOS *vid)
 {
                 if(src->_colorspace!=ADM_COLOR_YV12)
@@ -1114,7 +1117,9 @@
                         dst->duplicate(src);
                 return 1;
 }
-
+/**
+    \fn setPostProc
+*/
 uint8_t ADM_Composer::setPostProc( uint32_t type, uint32_t strength, uint32_t swapuv)
 {
 	if(!_nb_video) return 0;
@@ -1124,6 +1129,10 @@
 	updatePostProc(&_pp); // DeletePostproc/ini missing ?
 	return 1;
 }
+/**
+    \fn getPostProc
+*/
+
 uint8_t ADM_Composer::getPostProc( uint32_t *type, uint32_t *strength, uint32_t *swapuv)
 {
 	if(!_nb_video) return 0;
@@ -1227,4 +1236,28 @@
     }
     return true;
 }
+/**
+    \fn searchFrameBefore
+    \brief rEturn the frame number with pts just before pts
+*/
+uint32_t ADM_Composer::searchFrameBefore(uint64_t pts)
+{
+    _VIDEOS   *vid=&_videos[0];
+    vidHeader *demuxer=vid->_aviheader;
+    uint64_t  lastPts=demuxer->getTime(0);
+    uint32_t  nb=demuxer->getVideoStreamHeader()->dwLength;
+
+    if(lastPts>pts) return 0;
+
+	for(int i=1;i<nb-2;i++)
+    {
+        uint64_t cur,next;
+        cur=lastPts;
+        next=demuxer->getTime(i+1);
+        if(next==ADM_NO_PTS) next=cur+vid->timeIncrementInUs;
+        if(pts>=cur && pts<next) return i-1;
+        lastPts=next;
+    }
+    return nb-1;
+}
 //EOF

Modified: branches/avidemux_2.6_branch_mean/avidemux/ADM_editor/ADM_edit.hxx
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/ADM_editor/ADM_edit.hxx	2009-02-23 21:06:17 UTC (rev 4629)
+++ branches/avidemux_2.6_branch_mean/avidemux/ADM_editor/ADM_edit.hxx	2009-02-24 19:09:03 UTC (rev 4630)
@@ -219,6 +219,7 @@
                         bool        samePicture(ADMImage *image);
                         bool        getCompressedPicure(uint32_t framenum,ADMCompressedImage *img);
                         uint64_t    estimatePts(uint32_t frame);
+                        uint32_t    searchFrameBefore(uint64_t pts);
 /************************************ Internal ******************************/
 public:
                                     /// Decode frame and on until frame is popped out of decoders

Modified: branches/avidemux_2.6_branch_mean/avidemux/gui_navigate.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/gui_navigate.cpp	2009-02-23 21:06:17 UTC (rev 4629)
+++ branches/avidemux_2.6_branch_mean/avidemux/gui_navigate.cpp	2009-02-24 19:09:03 UTC (rev 4630)
@@ -443,20 +443,14 @@
     \fn A_jumpToTime
     \brief Jump to a given time
 */
-#warning CFR ASSUMED FIXME
-#warning CFR ASSUMED FIXME
-#warning CFR ASSUMED FIXME
-#warning CFR ASSUMED FIXME
-#warning CFR ASSUMED FIXME
 uint8_t A_jumpToTime(uint32_t hh,uint32_t mm,uint32_t ss,uint32_t ms)
 {
-uint32_t frame;
-        time2frame(&frame,avifileinfo->fps1000,hh,mm,ss,ms);
-        if(frame>=avifileinfo->nb_frames)
-        {
-                printf("Frame is out of bound\n");
-                return 0;
-        }
+uint64_t pts;
+        pts=hh*3600+mm*60+ss;
+        pts*=1000;
+        pts+=ms;
+        pts*=1000;
+        uint32_t frame=video_body->searchFrameBefore(pts);
         return GUI_GoToFrame(frame);
 
 }



From mean at mail.berlios.de  Tue Feb 24 20:09:05 2009
From: mean at mail.berlios.de (mean at BerliOS)
Date: Tue, 24 Feb 2009 20:09:05 +0100
Subject: [Avidemux-svn-commit] r4631 -
	branches/avidemux_2.6_branch_mean/avidemux/ADM_editor
Message-ID: <200902241909.n1OJ95Ij000428@sheep.berlios.de>

Author: mean
Date: 2009-02-24 20:09:05 +0100 (Tue, 24 Feb 2009)
New Revision: 4631

Modified:
   branches/avidemux_2.6_branch_mean/avidemux/ADM_editor/ADM_edCache.cpp
Log:
[Editor] Fix seeking in long file (4h) + fix usage of cache

Modified: branches/avidemux_2.6_branch_mean/avidemux/ADM_editor/ADM_edCache.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/ADM_editor/ADM_edCache.cpp	2009-02-24 19:09:03 UTC (rev 4630)
+++ branches/avidemux_2.6_branch_mean/avidemux/ADM_editor/ADM_edCache.cpp	2009-02-24 19:09:05 UTC (rev 4631)
@@ -85,8 +85,8 @@
     // First search for a really free image
     for(int i=0;i<_nbImage;i++)
     {
-        if(_elem[i].frameNum==ADM_INVALID_CACHE);
-        found=i;
+        if(_elem[i].frameNum==ADM_INVALID_CACHE)
+                found=i;
         aprintf("[edCache] Buffer %d free\n",found);
     }
     // Then the older one/LRU
@@ -104,7 +104,7 @@
             }
         }
     }
-    if(found==-1) ADM_assert("Could not get a free image\n");
+    if(found==-1) ADM_assert(0);
 	_elem[found].lastUse=_counter+1;;
 	_elem[found].frameNum=ADM_IN_USE_CACHE;
 
@@ -118,7 +118,7 @@
 */
  void        EditorCache::flush(void)
 {
-    aprintf("[edCache] Flush\n");
+    printf("[edCache] Flush\n");
     for(int i=0;i<_nbImage;i++)
     {
         _elem[i].frameNum==ADM_INVALID_CACHE;
@@ -194,7 +194,7 @@
 ADMImage    *EditorCache::findJustAfter(uint64_t pts)
 {
 int smallest=-1;
-uint64_t value=0x100000000LL;
+uint64_t value=0xF000000000000000LL;
 
     for(uint32_t i=0;i<_nbImage;i++)
 	{



From mean at mail.berlios.de  Tue Feb 24 20:09:10 2009
From: mean at mail.berlios.de (mean at BerliOS)
Date: Tue, 24 Feb 2009 20:09:10 +0100
Subject: [Avidemux-svn-commit] r4632 - in branches/avidemux_2.6_branch_mean:
	avidemux avidemux/ADM_coreDemuxerMpeg/include
	avidemux/ADM_coreDemuxerMpeg/src plugins/ADM_demuxers/MpegPS
Message-ID: <200902241909.n1OJ9ApO000439@sheep.berlios.de>

Author: mean
Date: 2009-02-24 20:09:10 +0100 (Tue, 24 Feb 2009)
New Revision: 4632

Added:
   branches/avidemux_2.6_branch_mean/avidemux/gui_save.cpp
Modified:
   branches/avidemux_2.6_branch_mean/avidemux/ADM_coreDemuxerMpeg/include/dmxPSPacket.h
   branches/avidemux_2.6_branch_mean/avidemux/ADM_coreDemuxerMpeg/include/dmxPacket.h
   branches/avidemux_2.6_branch_mean/avidemux/ADM_coreDemuxerMpeg/src/dmxPSPacket.cpp
   branches/avidemux_2.6_branch_mean/avidemux/CMakeLists.txt
   branches/avidemux_2.6_branch_mean/avidemux/gtk_gui.cpp
   branches/avidemux_2.6_branch_mean/avidemux/gui_action.names
   branches/avidemux_2.6_branch_mean/plugins/ADM_demuxers/MpegPS/ADM_ps.cpp
   branches/avidemux_2.6_branch_mean/plugins/ADM_demuxers/MpegPS/ADM_psAudio.cpp
   branches/avidemux_2.6_branch_mean/plugins/ADM_demuxers/MpegPS/ADM_psAudioProbe.cpp
   branches/avidemux_2.6_branch_mean/plugins/ADM_demuxers/MpegPS/ADM_psIndex.cpp
Log:
[Main] Move save oriented stuff in their own file, need cleanup

Modified: branches/avidemux_2.6_branch_mean/avidemux/ADM_coreDemuxerMpeg/include/dmxPSPacket.h
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/ADM_coreDemuxerMpeg/include/dmxPSPacket.h	2009-02-24 19:09:05 UTC (rev 4631)
+++ branches/avidemux_2.6_branch_mean/avidemux/ADM_coreDemuxerMpeg/include/dmxPSPacket.h	2009-02-24 19:09:10 UTC (rev 4632)
@@ -21,7 +21,7 @@
 public:
                         psPacket(void);
     virtual            ~psPacket();
-    virtual bool        open(const char *filenames,bool dontappend);
+    virtual bool        open(const char *filenames,FP_TYPE append);
     virtual bool        close(void);
     virtual bool        getPacket(uint32_t maxSize, uint8_t *pid, uint32_t *packetSize,uint64_t *pts,uint64_t *dts,uint8_t *buffer,uint64_t *startAt);
     virtual uint64_t    getPos(void);

Modified: branches/avidemux_2.6_branch_mean/avidemux/ADM_coreDemuxerMpeg/include/dmxPacket.h
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/ADM_coreDemuxerMpeg/include/dmxPacket.h	2009-02-24 19:09:05 UTC (rev 4631)
+++ branches/avidemux_2.6_branch_mean/avidemux/ADM_coreDemuxerMpeg/include/dmxPacket.h	2009-02-24 19:09:10 UTC (rev 4632)
@@ -37,7 +37,7 @@
 public:
                         ADMMpegPacket(void);
     virtual             ~ADMMpegPacket();
-    virtual bool        open(const char *filenames,bool dontappend)=0;
+    virtual bool        open(const char *filenames,FP_TYPE append)=0;
     virtual bool        close(void)=0;
     virtual bool        getPacket(uint32_t maxSize, uint8_t *pid, uint32_t *packetSize,uint64_t *pts,uint64_t *dts,uint8_t *buffer,uint64_t *startAt)=0;
     virtual bool        getPacketOfType(uint8_t pid,uint32_t maxSize, uint32_t *packetSize,uint64_t *pts,uint64_t *dts,uint8_t *buffer,uint64_t *startAt);

Modified: branches/avidemux_2.6_branch_mean/avidemux/ADM_coreDemuxerMpeg/src/dmxPSPacket.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/ADM_coreDemuxerMpeg/src/dmxPSPacket.cpp	2009-02-24 19:09:05 UTC (rev 4631)
+++ branches/avidemux_2.6_branch_mean/avidemux/ADM_coreDemuxerMpeg/src/dmxPSPacket.cpp	2009-02-24 19:09:10 UTC (rev 4632)
@@ -39,12 +39,10 @@
     \fn open
     \brief dtor
 */
-bool psPacket::open(const char *filenames,bool dontappend)
+bool psPacket::open(const char *filenames,FP_TYPE append)
 {
-FP_TYPE opentype=FP_APPEND;
-    if(dontappend) opentype=FP_DONT_APPEND;
     _file=new fileParser();
-    if(!_file->open(filenames,&opentype))
+    if(!_file->open(filenames,&append))
     {
         printf("[DmxPS] cannot open %s\n",filenames);
         delete _file;

Modified: branches/avidemux_2.6_branch_mean/avidemux/CMakeLists.txt
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/CMakeLists.txt	2009-02-24 19:09:05 UTC (rev 4631)
+++ branches/avidemux_2.6_branch_mean/avidemux/CMakeLists.txt	2009-02-24 19:09:10 UTC (rev 4632)
@@ -138,6 +138,7 @@
 GUI_jobs.cpp  
 gui_navigate.cpp  
 guiplay.cpp  
+gui_save.cpp  
 gui_savenew.cpp  
 main.cpp  
 gui_action.cpp

Modified: branches/avidemux_2.6_branch_mean/avidemux/gtk_gui.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/gtk_gui.cpp	2009-02-24 19:09:05 UTC (rev 4631)
+++ branches/avidemux_2.6_branch_mean/avidemux/gtk_gui.cpp	2009-02-24 19:09:10 UTC (rev 4632)
@@ -165,7 +165,9 @@
 extern void DIA_glyphEdit(void);
 extern uint8_t DIA_pluginsInfo(void);
 extern bool ADM_mux_configure(int index);
+//
 void HandleAction_Navigate(Action action);
+void HandleAction_Save(Action action);
 //___________________________________________
 // serialization of user event through gui
 //
@@ -389,6 +391,11 @@
   {
     HandleAction_Navigate(action);
   }
+  else if(action>ACT_SAVE_BEGIN && action < ACT_SAVE_END)
+  {
+    HandleAction_Save(action);
+  }
+
   else switch (action)
     {
        case ACT_JOG:
@@ -430,39 +437,11 @@
 //				DIA_Calculator(&a,&b );
 			}
     			break;
-    case ACT_SaveUnpackedMpeg4:
-      if(GUI_Question(QT_TR_NOOP("This is to be used to undo packed VOP on MPEG-4.\nContinue ?")))
-			{
-                          GUI_FileSelWrite (QT_TR_NOOP("Select AVI File to Write"), (SELFILE_CB *)A_SaveUnpackedVop);
 
-			}
-    			break;
-
-    case ACT_SaveOGM:
-//                        GUI_FileSelWrite (QT_TR_NOOP("Select OGM File to Write"), (SELFILE_CB *)ogmSave);
-    			break;
-
-    case ACT_SaveWork:
-      GUI_FileSelWrite (QT_TR_NOOP("Select Workbench to Save"), A_saveWorkbench);
-	  UI_refreshCustomMenu();
-      break;
     case ACT_ADD_JOB:
         A_addJob();
         break;
-    case ACT_SaveCurrentWork:
-      if( actual_workbench_file ){
-        char *tmp = ADM_strdup(actual_workbench_file);
-         A_saveWorkbench( tmp ); // will write "actual_workbench_file" itself
-         ADM_dealloc(tmp);
-      }else{
-        GUI_FileSelWrite (QT_TR_NOOP("Select Workbench to Save"), A_saveWorkbench);
-		UI_refreshCustomMenu();
-      }
-      break;
-      
-    case ACT_SaveRaw:
-      GUI_FileSelWrite (QT_TR_NOOP("Select Raw File to Save"), (SELFILE_CB *)ADM_saveRaw);
-      break;
+ 
     case ACT_CutWizard:
       ADM_cutWizard ();
       break;
@@ -479,14 +458,7 @@
     case ACT_AppendAvi:
       GUI_FileSelRead (QT_TR_NOOP("Select AVI File to Append..."),(SELFILE_CB *) A_appendAvi);
       break;
-    case ACT_SaveWave:
-      	{
-          GUI_FileSelWrite (QT_TR_NOOP("Select File to Save Audio"),(SELFILE_CB *)A_audioSave);
 
-	}
-      break;
-
-
     case ACT_AviInfo:
       DIA_properties ();
       break;
@@ -501,22 +473,7 @@
       GUI_PlayAvi ();
       break;
 
-    case ACT_SaveDualAudio:
-      //GUI_FileSelWrite ("Select AVI to save ",
-      A_SaveAudioDualAudio(NULL);
-      break;
 
-    case ACT_SaveBunchJPG:
-      GUI_FileSelWrite (QT_TR_NOOP("Select JPEG Sequence to Save"), A_saveBunchJpg);
-    	break;
-    case ACT_SaveImg:
-      GUI_FileSelWrite (QT_TR_NOOP("Select BMP to Save"), A_saveImg);
-      //GUI_FileSelWrite ("Select Jpg to save ", A_saveJpg);
-      break;
-    case ACT_SaveJPG :
-      GUI_FileSelWrite (QT_TR_NOOP("Select JPEG to Save"), (SELFILE_CB *)A_saveJpg);
-      	//GUI_FileSelWrite ("Select Jpg to save ", A_saveJpg);
-      	break;
 
   
 #define TOGGLE_PREVIEW ADM_PREVIEW_OUTPUT
@@ -591,11 +548,6 @@
       UI_setMarkers (frameStart, frameEnd);
       break;
   
-//----------------------test-----------------------
-    case ACT_SaveAvi:
-      GUI_FileSelWrite (QT_TR_NOOP("Select File to Save"),(SELFILE_CB *)A_SaveWrapper); // A_SaveAudioNVideo);
-      break;
-//---------------------------------------------------
     case ACT_Copy:
       		if( frameEnd < frameStart ){
                   GUI_Error_HIG(QT_TR_NOOP("Marker A > B"), QT_TR_NOOP("Cannot copy."));
@@ -1046,89 +998,10 @@
 
 }
 
-//_____________________________________________________________
-//    Save current stream (generally avi...)
-//     in raw mode
-//_____________________________________________________________
-void
-A_saveAudio (char *name)
-{
 
-// debug audio seek
-  uint32_t len2;
-  uint32_t written, max;
-  uint64_t dts;
-  DIA_workingBase *work;
-  FILE *out;
 
-#define ONE_STRIKE (64*1024)
-  uint8_t *buffer=NULL;
 
-  if (!currentaudiostream)
-    return;
 
-
-
-  out = fopen (name, "wb");
-  if (!out) return;
-
-  work=createWorking(QT_TR_NOOP("Saving audio"));
-
-  uint32_t timeEnd,timeStart,sample,hold,len;
-  uint64_t tgt_sample,cur_sample;
-  double   duration;
-
-  // compute start position and duration in samples
-
-   timeStart=video_body->getTime (frameStart);
-   timeEnd=video_body->getTime (frameEnd+1);
-
-   currentaudiostream->goToTime (timeStart);
-   duration=timeEnd-timeStart;
-   printf("Duration:%f ms\n",duration);
-   if(duration<0) duration=-duration;
-
-   duration/=1000;
-   duration*=currentaudiostream->getInfo()->frequency;
-
-   tgt_sample=(uint64_t)floor(duration);
-
-   cur_sample=0;
-   written = 0;
-   hold=0;
-   buffer=new uint8_t[ONE_STRIKE*2];
-   while (1)
-    {
-    	if(!currentaudiostream->getPacket(buffer+hold,&len,64*1024,&sample,&dts)) break;
-	hold+=len;
-	written+=len;
-	cur_sample+=sample;
-	if(hold>ONE_STRIKE)
-	{
-		fwrite(buffer,hold,1,out);
-		hold=0;
-	}
-	if(cur_sample>tgt_sample)
-		break;
-      work->update(cur_sample>>10, tgt_sample>>10);
-      if(!work->isAlive()) break;
-    };
-  if(hold)
-  {
-  	fwrite(buffer,hold,1,out);
-	hold=0;
-  }
-
-  fclose (out);
-  delete work;
-  delete[] buffer;
-  printf ("\n wanted %"LLU" samples, goto %"LLU" samples, written %"LU" bytes\n", tgt_sample,cur_sample, written);
-
-
-}
-
-
-
 //____________________________________________________________
 //
 //      Play AVI  + Audio if possible
@@ -1139,104 +1012,6 @@
 
 }
 
-#ifndef TEST_MP2
-/**________________________________________________________
- Save a Jpg image from current display buffer
-________________________________________________________*/
-int A_saveJpg (char *name)
-{
-  uint8_t fl;
-    ADMImage image(avifileinfo->width, avifileinfo->height);
-    if(!GUI_getFrameContent(&image, curframe))
-    {
-      GUI_Error_HIG(QT_TR_NOOP("Get Frame"),QT_TR_NOOP("Cannot get this frame to save"));
-      return 0;
-    }
-    return (int) image.saveAsJpg (name);
-}
-#else
-/**
-      \fn A_saveJpg
-      \brief Save current image as jpeg 95% qual
-
-*/
-int A_saveJpg (char *name)
-{
-static int b=1;
-         video_body->changeAudioStream(0,b);
-        b^=1;
-        return 1;
-
-}
-#endif
-
-
-/**
-      \fn A_saveBunchJpg
-      \brief Save the selection  as a bunch of jpeg 95% qual
-
-*/
-void A_saveBunchJpg(const char *name)
-{
-  ADMImage *src=NULL;
-  uint32_t curImg;
-  char	 fullName[2048],*ext;
-  char *baseName;
-  DIA_workingBase *working;
-  uint8_t success=0;
-
-        if(frameStart>frameEnd)
-                {
-                  GUI_Error_HIG(QT_TR_NOOP("Mark A > B"), QT_TR_NOOP("Set your markers correctly."));
-                        return;
-                }
-        // Split name into base + extension
-        ADM_PathSplit(name,&baseName,&ext);
-
-        src=new ADMImage(avifileinfo->width,avifileinfo->height);
-        ADM_assert(src);
-
-        working=createWorking(QT_TR_NOOP("Saving as set of jpegs"));
-        for(curImg=frameStart;curImg<=frameEnd;curImg++)
-        {
-                working->update(curImg-frameStart,frameEnd-frameStart);
-                if (!GUI_getFrameContent (src,curImg ))
-                {
-                  GUI_Error_HIG(QT_TR_NOOP("Cannot decode frame"), QT_TR_NOOP("Aborting."));
-                        goto _bunch_abort;
-                }
-                if(!working->isAlive()) goto _bunch_abort;
-                sprintf(fullName,"%s%04d.jpg",baseName,curImg-frameStart);
-                if(!src->saveAsJpg(fullName)) goto _bunch_abort;
-        }
-        success=1;
-
-_bunch_abort:
-        if(success)
-            GUI_Info_HIG(ADM_LOG_INFO,QT_TR_NOOP("Done"),QT_TR_NOOP( "Saved %d images."), curImg-frameStart);
-        else
-            GUI_Error_HIG(QT_TR_NOOP("Error"),QT_TR_NOOP( "Could not save all images."));
-        delete working	;
-        delete src;
-        return ;
-
-
-}
-/**
-      \fn A_saveImg
-      \brief Save current displayed image as a BMP file
-*/
-void A_saveImg (const char *name)
-{
-
-  ADMImage image(avifileinfo->width,avifileinfo->height);
-  GUI_getFrameContent(&image, video_body->getCurrentFrame());
-  if(image.saveAsBmp(name))
-        GUI_Info_HIG (ADM_LOG_INFO,QT_TR_NOOP("Done"),QT_TR_NOOP( "Saved \"%s\"."), ADM_GetFileName(name));
-  else
-        GUI_Error_HIG (QT_TR_NOOP("BMP op failed"),QT_TR_NOOP( "Saving %s as a BMP file failed."), ADM_GetFileName(name));
-}
-
 //_____________________________________________________________
 //
 //              Load AC3
@@ -1307,139 +1082,10 @@
   return 1;
 }
 
-//_____________________________________________________________
-//    Save current stream (generally avi...)
-//     in decoded mode (assuming MP3)
-//_____________________________________________________________
-void
-A_saveAudioDecodedTest (char *name)
-{
-#if 0
-// debug audio seek
-  uint32_t len, gauge = 0;
-  uint32_t written = 0;
-  FILE *out;
-  AVDMGenericAudioStream *saveFilter;
 
-  uint64_t sampleTarget,sampleCurrent;
 
-#undef BITT
-#define BITT 4*1152
-#define OUTCHUNK 1024*1024
-  uint8_t *outbuffer;
 
-  if (!currentaudiostream)
-    return;
 
-
-  if (!(out = fopen (name, "wb")))
-    {
-      GUI_Error_HIG (QT_TR_NOOP("File error"), QT_TR_NOOP("Cannot open \"%s\" for writing."), name);
-      return;
-    }
-
-  outbuffer = (uint8_t *) ADM_alloc (2 * OUTCHUNK);	// 1Meg cache;
-  if (!outbuffer)
-    {
-      GUI_Error_HIG (QT_TR_NOOP("Memory Error"), NULL);
-      return;
-    }
-
-
-
-// re-ignite first filter...
-
-
-
-
-  // Write Wav header
-
-  /* Sat Nov 09 06:11:52 CET 2002 Fixes from Maik Broemme <mbroemme at plusserver.de> */
-  /* If you set negative delay and save the audio stream, the saved stream was shorter than the video stream. */
-
-  /* Example: video stream is 10 minutes long, audio stream perhaps 20 minutes, you need the audio stream from */
-  /*          minute 1 until 11, so you setup an audio delay from -60 seconds, but this 60 seconds were removed */
-  /*          from begin and end of the audio stream. That was not good :) Now it runs correctly also if you use */
-  /*          audio stream with same length then video, therefore is premature ending :) */
-
-
-
-//        saveFilter =  buildAudioFilter (currentaudiostream,video_body->getTime (frameStart));
-
-		if (saveFilter == NULL)
-		{
-			fclose(out);
-			ADM_dealloc(outbuffer);
-			return;
-		}
-
-    	DIA_working *work=new DIA_working(QT_TR_NOOP("Saving audio"));
-
-
-//
-//  Create First filter that is null filter
-//
-  saveFilter->writeHeader (out);
-  uint32_t tstart,tend,samples;
-  double duration;
-  tstart=video_body->getTime(frameStart);
-  tend=video_body->getTime(frameEnd+1);
-  duration=(tend-tstart);
-  duration*=saveFilter->getInfo()->frequency;
-  duration/=1000.;
-
-  sampleTarget=(uint64_t)floor(duration);
-  sampleCurrent=0;
-  gauge=0;
-
-  if( frameStart == frameEnd ){
-     /* JSC: we will write some bytes, but nobody should expect useful data */
-    GUI_Error_HIG(QT_TR_NOOP("No frames to encode"),QT_TR_NOOP("Please check markers. Is \"A>\" == \">B\"?"));
-  }
-
-  while ((sampleCurrent<sampleTarget))
-    {
-      if(!saveFilter->getPacket(outbuffer + gauge,&len,&samples))
-      {
-        printf("Audio save:Read error\n");
-      	break;
-      }
-      //      printf("Got : %lu\n",len2);
-      gauge += len;
-      sampleCurrent+=samples;
-      // update GUI
-	// JSC: if "A>" == ">B" we will get >100% here => assert in work->update()
-	if (work->update ((sampleCurrent>>10 > sampleTarget>>10 ? sampleTarget>>10 : sampleCurrent>>10), sampleTarget>>10))	// abort request ?
-	    break;;
-      if (gauge > OUTCHUNK)	// either out buffer is full
-	{
-	  fwrite (outbuffer, 1, gauge, out);
-	  written += gauge;
-	  gauge = 0;
-	}
-    };
-// Clean up
-	if(gauge)
-	{
-		fwrite (outbuffer,  gauge,1, out);
-		written += gauge;
-		gauge = 0;
-	}
-  saveFilter->endWrite (out, written);
-  fclose (out);
-  ADM_dealloc (outbuffer);
-  delete work;
-//  deleteAudioFilter (saveFilter);
-//  currentaudiostream->endDecompress ();
-  printf ("AudioSave: actually written %u\n", written);
-  printf ("Audiosave: target sample:%llu, got :%llu\n",sampleTarget,sampleCurrent);
-
-#endif
-}
-
-
-
-
 //      Clean up
 //      free all pending stuff, make leakchecker happy
 //
@@ -1513,118 +1159,6 @@
 }
 
 
-/*
-	Save a raw video stream without any container
-	Usefull to cut mpeg stream or extract raw h263/mpeg4 stream
-
-*/
-uint8_t ADM_saveRaw (const char *name)
-{
-  uint32_t len, flags;
-  FILE *fd, *fi;
-  uint8_t *buffer = new uint8_t[avifileinfo->width * avifileinfo->height * 3],ret=0;
-  char *idx;
-  DIA_workingBase *work;
-  uint8_t seq;
-  idx = new char[strlen (name) + 8];
-  strcpy (idx, name);
-  strcat (idx, ".idx");
-  fd = fopen (name, "wb");
-  fi = fopen (idx, "wt");
-  if (!fd)
-    return 0;
-  work=createWorking(QT_TR_NOOP("Saving raw video stream"));
-  ADMCompressedImage image;
-  image.data=buffer;
-  image.dataLength=avifileinfo->width * avifileinfo->height * 3;
-  // preamble
-#if 0
-  video_body->getRawStart (frameStart, buffer, &len);
-  fwrite (buffer, len, 1, fd);
-#endif
-  for (uint32_t i = frameStart; i < frameEnd; i++)
-    {
-      work->update (i - frameStart, frameEnd - frameStart);
-      if(!work->isAlive())
-      {
-                 ret=0;
-                 goto _abt;
-      }
-      if(!video_body->getFlags (i, &flags))
-        {
-                if(i==frameEnd-1)
-                {
-                         ret=1;
-                         goto _abt;
-                }
-                ADM_assert (video_body->getFlags (i, &flags));
-        }
-
-      if (flags & AVI_B_FRAME)	// oops
-	{
-	  // se search for the next i /p
-	  uint32_t found = 0;
-
-	  for (uint32_t j = i + 1; j < frameEnd; j++)
-	    {
-	      ADM_assert (video_body->getFlags (j, &flags));
-	      if (!(flags & AVI_B_FRAME))
-		{
-		  found = j;
-		  break;
-		}
-
-	    }
-	  if (!found)
-          {
-            if(abs(i-frameEnd)>2)
-                ret=0;
-            else
-                ret=1;  // Good enough
-	    goto _abt;
-          }
-	  // Write the found frame
-
-	  video_body->getFrame (found, &image, &seq);
-	  fwrite (buffer, len, 1, fd);
-	  // and the B frames
-	  for (uint32_t j = i; j < found; j++)
-	    {
-	      video_body->getFrame (j, &image,&seq);
-	      fwrite (buffer, len, 1, fd);
-	    }
-	  i = found;		// Will be plussed by for
-	}
-      else			// P or I frame
-	{
-	  video_body->getFrame (i, &image, &seq);
-	  fwrite (buffer, len, 1, fd);
-	  fprintf (fi, "%u,\n", len);
-	}
-
-    }
-    ret=1;
-_abt:
-  fclose (fd);
-  fclose (fi);
-  delete work;
-  return ret;
-
-}
-
-void
-A_saveWorkbench (const char *name)
-{
-#if 0
-  video_body->saveWorbench (name);
-#else
-  video_body->saveAsScript(name,NULL);
-#endif
-  if( actual_workbench_file )
-     ADM_dealloc(actual_workbench_file);
-  actual_workbench_file = ADM_strdup(name);
-}
-
 void A_parseECMAScript(const char *name){
   bool ret;
   char *longname = ADM_PathCanonize(name);
@@ -1709,24 +1243,6 @@
 	GUI_GoToFrame(curframe);
 
 }
-//___________ save audio _____________
-int A_audioSave(char *name)
-{
-	if (!currentaudiostream)	// yes it is checked 2 times so what ?
-	return 0;
-	if (audioProcessMode())
-	{
-
-		// if we get here, either not compressed
-		// or decompressable
-		A_saveAudioDecodedTest(name);
-	    }
-	else			// copy mode...
-	    {
-	       A_saveAudio(name);
-	    }
-	return 1;
-}
 uint8_t A_pass(char *name)
 {
 //        mpeg_passthrough(name,ADM_PS);
@@ -2075,19 +1591,6 @@
         ADM_dealloc(name);
         ADM_dealloc(final);
 }
-int A_SaveWrapper(char *name)
-{
-
-        if(A_Save(name))
-        {
-          GUI_Info_HIG (ADM_LOG_INFO,QT_TR_NOOP("Done"),QT_TR_NOOP( "File %s has been successfully saved."),ADM_GetFileName(name));
-        }
-        else
-        {
-          GUI_Error_HIG (QT_TR_NOOP("Failed"), QT_TR_NOOP("File %s was NOT saved correctly."),ADM_GetFileName(name));
-        }
-        return 1;
-}
 uint8_t  DIA_v2v(char **vobname, char **ifoname,char **vobsubname);
 uint8_t ADM_vob2vobsub(char *nameVob, char *nameVobSub, char *nameIfo);
 #if BAZOOKA
@@ -2418,7 +1921,10 @@
 
         return render;
 }
-
+/**
+        \fn getStrFromAudioCodec
+        \brief Return a plain string from the codec_id
+*/
 const char *getStrFromAudioCodec( uint32_t codec)
 {
       switch(codec)

Modified: branches/avidemux_2.6_branch_mean/avidemux/gui_action.names
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/gui_action.names	2009-02-24 19:09:05 UTC (rev 4631)
+++ branches/avidemux_2.6_branch_mean/avidemux/gui_action.names	2009-02-24 19:09:10 UTC (rev 4632)
@@ -1,3 +1,4 @@
+// 
 ACT(OpenAvi)
 ACT(AppendAvi)
 ACT(BrokenAvi)
@@ -6,30 +7,28 @@
 ACT(Exit)
 ACT(PlayAvi)
 ACT(StopAvi)
+ACT(RecentFiles)
+
+ACT(SetPostProcessing)
+//----- SAVE -----
+ACT(SAVE_BEGIN)
 ACT(SaveImg)
 ACT(SaveOGM)
 ACT(SaveJPG)
 ACT(SaveBunchJPG)
 ACT(SaveDVDPS)
 ACT(SaveUnpackedMpeg4)
-ACT(RecentFiles)
-
+ACT(SAVE_END)
 ACT(SaveDualAudio)
 ACT(SaveAvi)
 ACT(SaveWave)
-ACT(Pipe2Lame)
-ACT(PipeLame)
-ACT(Pipe2Other)
-
 ACT(SaveMpeg1vcd)
 ACT(SaveMpeg2svcd)
 ACT(SaveMpeg2dvd)
-
 ACT(SaveRaw)
-
 ACT(XVCD)
+// /SAVE
 
-ACT(SetPostProcessing)
 //--- NAVIGATE----
 ACT(NAVIGATE_BEGIN)
 ACT(NextFrame)
@@ -52,13 +51,8 @@
 ACT(GotoMarkB)
 ACT(Scale)
 ACT(NAVIGATE_END)
-//--- NAVIGATE----
+//--- /NAVIGATE----
 ACT(AllBlackFrames)
-
-
-
-
-
 ACT(AudioSourceAvi)
 ACT(AudioSourceMP3)
 ACT(AudioSourceWAV)
@@ -97,11 +91,6 @@
 
 ACT(SecondAudioTrack)
 
-ACT(SelectDevOSS)
-ACT(SelectDevDummy)
-ACT(SelectDevArts)
-ACT(SelectDevALSA)
-
 ACT(CutWizard)
 
 ACT(MpegIndex)

Added: branches/avidemux_2.6_branch_mean/avidemux/gui_save.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/gui_save.cpp	2009-02-24 19:09:05 UTC (rev 4631)
+++ branches/avidemux_2.6_branch_mean/avidemux/gui_save.cpp	2009-02-24 19:09:10 UTC (rev 4632)
@@ -0,0 +1,580 @@
+/** *************************************************************************
+            \file gui_save.cpp
+            \brief handle all kind of sabe
+    
+    copyright            : (C) 2002/2009 by mean
+    email                : fixounet at free.fr
+ ***************************************************************************/
+
+/***************************************************************************
+ *                                                                         *
+ *   This program is free software; you can redistribute it and/or modify  *
+ *   it under the terms of the GNU General Public License as published by  *
+ *   the Free Software Foundation; either version 2 of the License, or     *
+ *   (at your option) any later version.                                   *
+ *                                                                         *
+ ***************************************************************************/
+
+#include "ADM_default.h"
+#include "avi_vars.h"
+
+#include <math.h>
+#include "prototype.h"
+#include "gui_action.hxx"
+#include "gtkgui.h"
+
+#include "DIA_coreToolkit.h"
+#include "ADM_userInterfaces/ADM_commonUI/GUI_ui.h"
+#include "DIA_enter.h"
+
+#include "ADM_video/ADM_vidMisc.h"
+#include "DIA_fileSel.h"
+#include "DIA_working.h"
+// Local prototypes
+void A_saveAudio (char *name);
+int  A_saveJpg (char *name);
+void A_saveBunchJpg(const char *name);
+void A_saveImg (const char *name);
+uint8_t ADM_saveRaw (const char *name);
+void A_saveWorkbench (const char *name);
+int  A_audioSave(char *name);
+int  A_SaveWrapper(char *name);
+void A_saveAudioDecodedTest (char *name);
+// Xternal prototypes
+int      A_SaveUnpackedVop(const char *name);
+uint8_t  A_SaveAudioDualAudio(const char *inname);
+int      A_Save(const char *name);
+uint8_t  GUI_getFrameContent(ADMImage *image, uint32_t frame);
+
+extern char * actual_workbench_file; // UGLY FIXME
+/**
+    \fn HandleAction_Navigate
+
+*/
+void HandleAction_Save(Action action)
+{
+    switch(action)
+    {
+    case ACT_SaveUnpackedMpeg4:
+      if(GUI_Question(QT_TR_NOOP("This is to be used to undo packed VOP on MPEG-4.\nContinue ?")))
+			{
+                          GUI_FileSelWrite (QT_TR_NOOP("Select AVI File to Write"), (SELFILE_CB *)A_SaveUnpackedVop);
+
+			}
+    			break;
+
+    case ACT_SaveOGM:
+//                        GUI_FileSelWrite (QT_TR_NOOP("Select OGM File to Write"), (SELFILE_CB *)ogmSave);
+    			break;
+
+    case ACT_SaveWork:
+      GUI_FileSelWrite (QT_TR_NOOP("Select Workbench to Save"), A_saveWorkbench);
+	  UI_refreshCustomMenu();
+      break;
+   case ACT_SaveCurrentWork:
+      if( actual_workbench_file ){
+        char *tmp = ADM_strdup(actual_workbench_file);
+         A_saveWorkbench( tmp ); // will write "actual_workbench_file" itself
+         ADM_dealloc(tmp);
+      }else{
+        GUI_FileSelWrite (QT_TR_NOOP("Select Workbench to Save"), A_saveWorkbench);
+		UI_refreshCustomMenu();
+      }
+      break;
+      
+    case ACT_SaveRaw:
+      GUI_FileSelWrite (QT_TR_NOOP("Select Raw File to Save"), (SELFILE_CB *)ADM_saveRaw);
+      break;
+    case ACT_SaveWave:
+      	{
+          GUI_FileSelWrite (QT_TR_NOOP("Select File to Save Audio"),(SELFILE_CB *)A_audioSave);
+
+	}
+      break;
+
+    case ACT_SaveDualAudio:
+      //GUI_FileSelWrite ("Select AVI to save ",
+      A_SaveAudioDualAudio(NULL);
+      break;
+
+    case ACT_SaveBunchJPG:
+      GUI_FileSelWrite (QT_TR_NOOP("Select JPEG Sequence to Save"), A_saveBunchJpg);
+    	break;
+    case ACT_SaveImg:
+      GUI_FileSelWrite (QT_TR_NOOP("Select BMP to Save"), A_saveImg);
+      //GUI_FileSelWrite ("Select Jpg to save ", A_saveJpg);
+      break;
+    case ACT_SaveJPG :
+      GUI_FileSelWrite (QT_TR_NOOP("Select JPEG to Save"), (SELFILE_CB *)A_saveJpg);
+      	//GUI_FileSelWrite ("Select Jpg to save ", A_saveJpg);
+      	break;
+//----------------------test-----------------------
+    case ACT_SaveAvi:
+      GUI_FileSelWrite (QT_TR_NOOP("Select File to Save"),(SELFILE_CB *)A_SaveWrapper); // A_SaveAudioNVideo);
+      break;
+//---------------------------------------------------
+
+    default:
+        ADM_assert(0);
+        break;
+    }
+}
+/**
+        \fn A_saveAudio
+        \brief Save current stream (generally avi...)     in raw mode
+*/
+void A_saveAudio (char *name)
+{
+
+// debug audio seek
+  uint32_t len2;
+  uint32_t written, max;
+  uint64_t dts;
+  DIA_workingBase *work;
+  FILE *out;
+
+#define ONE_STRIKE (64*1024)
+  uint8_t *buffer=NULL;
+
+  if (!currentaudiostream)
+    return;
+
+
+
+  out = fopen (name, "wb");
+  if (!out) return;
+
+  work=createWorking(QT_TR_NOOP("Saving audio"));
+
+  uint32_t timeEnd,timeStart,sample,hold,len;
+  uint64_t tgt_sample,cur_sample;
+  double   duration;
+
+  // compute start position and duration in samples
+
+   timeStart=video_body->getTime (frameStart);
+   timeEnd=video_body->getTime (frameEnd+1);
+
+   currentaudiostream->goToTime (timeStart);
+   duration=timeEnd-timeStart;
+   printf("Duration:%f ms\n",duration);
+   if(duration<0) duration=-duration;
+
+   duration/=1000;
+   duration*=currentaudiostream->getInfo()->frequency;
+
+   tgt_sample=(uint64_t)floor(duration);
+
+   cur_sample=0;
+   written = 0;
+   hold=0;
+   buffer=new uint8_t[ONE_STRIKE*2];
+   while (1)
+    {
+    	if(!currentaudiostream->getPacket(buffer+hold,&len,64*1024,&sample,&dts)) break;
+	hold+=len;
+	written+=len;
+	cur_sample+=sample;
+	if(hold>ONE_STRIKE)
+	{
+		fwrite(buffer,hold,1,out);
+		hold=0;
+	}
+	if(cur_sample>tgt_sample)
+		break;
+      work->update(cur_sample>>10, tgt_sample>>10);
+      if(!work->isAlive()) break;
+    };
+  if(hold)
+  {
+  	fwrite(buffer,hold,1,out);
+	hold=0;
+  }
+
+  fclose (out);
+  delete work;
+  delete[] buffer;
+  printf ("\n wanted %"LLU" samples, goto %"LLU" samples, written %"LU" bytes\n", tgt_sample,cur_sample, written);
+
+
+}
+
+#ifndef TEST_MP2
+/**
+        \fn A_saveJpg
+        \brief Save a Jpg image from current display buffer
+*/
+int A_saveJpg (char *name)
+{
+  uint8_t fl;
+    ADMImage image(avifileinfo->width, avifileinfo->height);
+    if(!GUI_getFrameContent(&image, curframe))
+    {
+      GUI_Error_HIG(QT_TR_NOOP("Get Frame"),QT_TR_NOOP("Cannot get this frame to save"));
+      return 0;
+    }
+    return (int) image.saveAsJpg (name);
+}
+#else
+/**
+      \fn A_saveJpg
+      \brief Save current image as jpeg 95% qual
+
+*/
+int A_saveJpg (char *name)
+{
+static int b=1;
+         video_body->changeAudioStream(0,b);
+        b^=1;
+        return 1;
+
+}
+#endif
+
+
+/**
+      \fn A_saveBunchJpg
+      \brief Save the selection  as a bunch of jpeg 95% qual
+
+*/
+void A_saveBunchJpg(const char *name)
+{
+  ADMImage *src=NULL;
+  uint32_t curImg;
+  char	 fullName[2048],*ext;
+  char *baseName;
+  DIA_workingBase *working;
+  uint8_t success=0;
+
+        if(frameStart>frameEnd)
+                {
+                  GUI_Error_HIG(QT_TR_NOOP("Mark A > B"), QT_TR_NOOP("Set your markers correctly."));
+                        return;
+                }
+        // Split name into base + extension
+        ADM_PathSplit(name,&baseName,&ext);
+
+        src=new ADMImage(avifileinfo->width,avifileinfo->height);
+        ADM_assert(src);
+
+        working=createWorking(QT_TR_NOOP("Saving as set of jpegs"));
+        for(curImg=frameStart;curImg<=frameEnd;curImg++)
+        {
+                working->update(curImg-frameStart,frameEnd-frameStart);
+                if (!GUI_getFrameContent (src,curImg ))
+                {
+                  GUI_Error_HIG(QT_TR_NOOP("Cannot decode frame"), QT_TR_NOOP("Aborting."));
+                        goto _bunch_abort;
+                }
+                if(!working->isAlive()) goto _bunch_abort;
+                sprintf(fullName,"%s%04d.jpg",baseName,curImg-frameStart);
+                if(!src->saveAsJpg(fullName)) goto _bunch_abort;
+        }
+        success=1;
+
+_bunch_abort:
+        if(success)
+            GUI_Info_HIG(ADM_LOG_INFO,QT_TR_NOOP("Done"),QT_TR_NOOP( "Saved %d images."), curImg-frameStart);
+        else
+            GUI_Error_HIG(QT_TR_NOOP("Error"),QT_TR_NOOP( "Could not save all images."));
+        delete working	;
+        delete src;
+        return ;
+
+
+}
+/**
+      \fn A_saveImg
+      \brief Save current displayed image as a BMP file
+*/
+void A_saveImg (const char *name)
+{
+
+  ADMImage image(avifileinfo->width,avifileinfo->height);
+  GUI_getFrameContent(&image, video_body->getCurrentFrame());
+  if(image.saveAsBmp(name))
+        GUI_Info_HIG (ADM_LOG_INFO,QT_TR_NOOP("Done"),QT_TR_NOOP( "Saved \"%s\"."), ADM_GetFileName(name));
+  else
+        GUI_Error_HIG (QT_TR_NOOP("BMP op failed"),QT_TR_NOOP( "Saving %s as a BMP file failed."), ADM_GetFileName(name));
+}
+
+/*
+	Save a raw video stream without any container
+	Usefull to cut mpeg stream or extract raw h263/mpeg4 stream
+
+*/
+uint8_t ADM_saveRaw (const char *name)
+{
+  uint32_t len, flags;
+  FILE *fd, *fi;
+  uint8_t *buffer = new uint8_t[avifileinfo->width * avifileinfo->height * 3],ret=0;
+  char *idx;
+  DIA_workingBase *work;
+  uint8_t seq;
+  idx = new char[strlen (name) + 8];
+  strcpy (idx, name);
+  strcat (idx, ".idx");
+  fd = fopen (name, "wb");
+  fi = fopen (idx, "wt");
+  if (!fd)
+    return 0;
+  work=createWorking(QT_TR_NOOP("Saving raw video stream"));
+  ADMCompressedImage image;
+  image.data=buffer;
+  image.dataLength=avifileinfo->width * avifileinfo->height * 3;
+  // preamble
+#if 0
+  video_body->getRawStart (frameStart, buffer, &len);
+  fwrite (buffer, len, 1, fd);
+#endif
+  for (uint32_t i = frameStart; i < frameEnd; i++)
+    {
+      work->update (i - frameStart, frameEnd - frameStart);
+      if(!work->isAlive())
+      {
+                 ret=0;
+                 goto _abt;
+      }
+      if(!video_body->getFlags (i, &flags))
+        {
+                if(i==frameEnd-1)
+                {
+                         ret=1;
+                         goto _abt;
+                }
+                ADM_assert (video_body->getFlags (i, &flags));
+        }
+
+      if (flags & AVI_B_FRAME)	// oops
+	{
+	  // se search for the next i /p
+	  uint32_t found = 0;
+
+	  for (uint32_t j = i + 1; j < frameEnd; j++)
+	    {
+	      ADM_assert (video_body->getFlags (j, &flags));
+	      if (!(flags & AVI_B_FRAME))
+		{
+		  found = j;
+		  break;
+		}
+
+	    }
+	  if (!found)
+          {
+            if(abs(i-frameEnd)>2)
+                ret=0;
+            else
+                ret=1;  // Good enough
+	    goto _abt;
+          }
+	  // Write the found frame
+
+	  video_body->getFrame (found, &image, &seq);
+	  fwrite (buffer, len, 1, fd);
+	  // and the B frames
+	  for (uint32_t j = i; j < found; j++)
+	    {
+	      video_body->getFrame (j, &image,&seq);
+	      fwrite (buffer, len, 1, fd);
+	    }
+	  i = found;		// Will be plussed by for
+	}
+      else			// P or I frame
+	{
+	  video_body->getFrame (i, &image, &seq);
+	  fwrite (buffer, len, 1, fd);
+	  fprintf (fi, "%u,\n", len);
+	}
+
+    }
+    ret=1;
+_abt:
+  fclose (fd);
+  fclose (fi);
+  delete work;
+  return ret;
+
+}
+/**
+    \fn A_saveWorkbench
+    \brief Save current workbench as ecmascript
+*/
+void A_saveWorkbench (const char *name)
+{
+#if 0
+  video_body->saveWorbench (name);
+#else
+  video_body->saveAsScript(name,NULL);
+#endif
+  if( actual_workbench_file )
+     ADM_dealloc(actual_workbench_file);
+  actual_workbench_file = ADM_strdup(name);
+}
+/**
+    \fn A_audioSave
+    \brief Save audio track
+*/
+
+int A_audioSave(char *name)
+{
+	if (!currentaudiostream)	// yes it is checked 2 times so what ?
+	return 0;
+	if (audioProcessMode())
+	{
+
+		// if we get here, either not compressed
+		// or decompressable
+		A_saveAudioDecodedTest(name);
+	    }
+	else			// copy mode...
+	    {
+	       A_saveAudio(name);
+	    }
+	return 1;
+}
+int A_SaveWrapper(char *name)
+{
+
+        if(A_Save(name))
+        {
+          GUI_Info_HIG (ADM_LOG_INFO,QT_TR_NOOP("Done"),QT_TR_NOOP( "File %s has been successfully saved."),ADM_GetFileName(name));
+        }
+        else
+        {
+          GUI_Error_HIG (QT_TR_NOOP("Failed"), QT_TR_NOOP("File %s was NOT saved correctly."),ADM_GetFileName(name));
+        }
+        return 1;
+}
+
+/**
+    \fn A_saveAudioDecodedTest
+    \brief Save current stream (generally avi...)
+     in decoded mode (assuming MP3)
+*/
+void A_saveAudioDecodedTest (char *name)
+{
+#if 0
+// debug audio seek
+  uint32_t len, gauge = 0;
+  uint32_t written = 0;
+  FILE *out;
+  AVDMGenericAudioStream *saveFilter;
+
+  uint64_t sampleTarget,sampleCurrent;
+
+#undef BITT
+#define BITT 4*1152
+#define OUTCHUNK 1024*1024
+  uint8_t *outbuffer;
+
+  if (!currentaudiostream)
+    return;
+
+
+  if (!(out = fopen (name, "wb")))
+    {
+      GUI_Error_HIG (QT_TR_NOOP("File error"), QT_TR_NOOP("Cannot open \"%s\" for writing."), name);
+      return;
+    }
+
+  outbuffer = (uint8_t *) ADM_alloc (2 * OUTCHUNK);	// 1Meg cache;
+  if (!outbuffer)
+    {
+      GUI_Error_HIG (QT_TR_NOOP("Memory Error"), NULL);
+      return;
+    }
+
+
+
+// re-ignite first filter...
+
+
+
+
+  // Write Wav header
+
+  /* Sat Nov 09 06:11:52 CET 2002 Fixes from Maik Broemme <mbroemme at plusserver.de> */
+  /* If you set negative delay and save the audio stream, the saved stream was shorter than the video stream. */
+
+  /* Example: video stream is 10 minutes long, audio stream perhaps 20 minutes, you need the audio stream from */
+  /*          minute 1 until 11, so you setup an audio delay from -60 seconds, but this 60 seconds were removed */
+  /*          from begin and end of the audio stream. That was not good :) Now it runs correctly also if you use */
+  /*          audio stream with same length then video, therefore is premature ending :) */
+
+
+
+//        saveFilter =  buildAudioFilter (currentaudiostream,video_body->getTime (frameStart));
+
+		if (saveFilter == NULL)
+		{
+			fclose(out);
+			ADM_dealloc(outbuffer);
+			return;
+		}
+
+    	DIA_working *work=new DIA_working(QT_TR_NOOP("Saving audio"));
+
+
+//
+//  Create First filter that is null filter
+//
+  saveFilter->writeHeader (out);
+  uint32_t tstart,tend,samples;
+  double duration;
+  tstart=video_body->getTime(frameStart);
+  tend=video_body->getTime(frameEnd+1);
+  duration=(tend-tstart);
+  duration*=saveFilter->getInfo()->frequency;
+  duration/=1000.;
+
+  sampleTarget=(uint64_t)floor(duration);
+  sampleCurrent=0;
+  gauge=0;
+
+  if( frameStart == frameEnd ){
+     /* JSC: we will write some bytes, but nobody should expect useful data */
+    GUI_Error_HIG(QT_TR_NOOP("No frames to encode"),QT_TR_NOOP("Please check markers. Is \"A>\" == \">B\"?"));
+  }
+
+  while ((sampleCurrent<sampleTarget))
+    {
+      if(!saveFilter->getPacket(outbuffer + gauge,&len,&samples))
+      {
+        printf("Audio save:Read error\n");
+      	break;
+      }
+      //      printf("Got : %lu\n",len2);
+      gauge += len;
+      sampleCurrent+=samples;
+      // update GUI
+	// JSC: if "A>" == ">B" we will get >100% here => assert in work->update()
+	if (work->update ((sampleCurrent>>10 > sampleTarget>>10 ? sampleTarget>>10 : sampleCurrent>>10), sampleTarget>>10))	// abort request ?
+	    break;;
+      if (gauge > OUTCHUNK)	// either out buffer is full
+	{
+	  fwrite (outbuffer, 1, gauge, out);
+	  written += gauge;
+	  gauge = 0;
+	}
+    };
+// Clean up
+	if(gauge)
+	{
+		fwrite (outbuffer,  gauge,1, out);
+		written += gauge;
+		gauge = 0;
+	}
+  saveFilter->endWrite (out, written);
+  fclose (out);
+  ADM_dealloc (outbuffer);
+  delete work;
+//  deleteAudioFilter (saveFilter);
+//  currentaudiostream->endDecompress ();
+  printf ("AudioSave: actually written %u\n", written);
+  printf ("Audiosave: target sample:%llu, got :%llu\n",sampleTarget,sampleCurrent);
+
+#endif
+}
+//EOF
+

Modified: branches/avidemux_2.6_branch_mean/plugins/ADM_demuxers/MpegPS/ADM_ps.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/plugins/ADM_demuxers/MpegPS/ADM_ps.cpp	2009-02-24 19:09:05 UTC (rev 4631)
+++ branches/avidemux_2.6_branch_mean/plugins/ADM_demuxers/MpegPS/ADM_ps.cpp	2009-02-24 19:09:10 UTC (rev 4632)
@@ -57,7 +57,7 @@
         goto abt;
     }
     append=index.getAsUint32("Append");
-
+    printf("[psDemux] Append=%"LU"\n",append);
     if(append) appendType=FP_APPEND;
     if(!parser.open(name,&appendType))
     {
@@ -85,7 +85,7 @@
 //***********
     
     psPacket=new psPacketLinear(0xE0);
-    if(psPacket->open(name,append)==false) 
+    if(psPacket->open(name,appendType)==false) 
     {
         printf("psDemux] Cannot psPacket open the file\n");
         goto abt;

Modified: branches/avidemux_2.6_branch_mean/plugins/ADM_demuxers/MpegPS/ADM_psAudio.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/plugins/ADM_demuxers/MpegPS/ADM_psAudio.cpp	2009-02-24 19:09:05 UTC (rev 4631)
+++ branches/avidemux_2.6_branch_mean/plugins/ADM_demuxers/MpegPS/ADM_psAudio.cpp	2009-02-24 19:09:10 UTC (rev 4632)
@@ -36,7 +36,7 @@
 FP_TYPE fp=FP_DONT_APPEND;
         if(append) fp=FP_APPEND;
         this->pid=pid;
-        if(!demuxer.open(name,&fp)) ADM_assert(0);
+        if(!demuxer.open(name,fp)) ADM_assert(0);
 }
 
 /**

Modified: branches/avidemux_2.6_branch_mean/plugins/ADM_demuxers/MpegPS/ADM_psAudioProbe.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/plugins/ADM_demuxers/MpegPS/ADM_psAudioProbe.cpp	2009-02-24 19:09:05 UTC (rev 4631)
+++ branches/avidemux_2.6_branch_mean/plugins/ADM_demuxers/MpegPS/ADM_psAudioProbe.cpp	2009-02-24 19:09:10 UTC (rev 4632)
@@ -54,7 +54,7 @@
 
     printf("[MpegPS] Probing audio for %s\n",fileName);
 
-    if(!packet->open(fileName,1)) goto end;
+    if(!packet->open(fileName,FP_APPEND)) goto end;
     fileSize=packet->getSize();
 
     packet->setPos(fileSize/2); // Jump in the middle of the stream

Modified: branches/avidemux_2.6_branch_mean/plugins/ADM_demuxers/MpegPS/ADM_psIndex.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/plugins/ADM_demuxers/MpegPS/ADM_psIndex.cpp	2009-02-24 19:09:05 UTC (rev 4631)
+++ branches/avidemux_2.6_branch_mean/plugins/ADM_demuxers/MpegPS/ADM_psIndex.cpp	2009-02-24 19:09:10 UTC (rev 4632)
@@ -175,7 +175,9 @@
         }
 
     }
-    pkt->open(file,false);
+
+    FP_TYPE append=FP_APPEND;
+    pkt->open(file,append);
     data.pkt=pkt;
     fullSize=pkt->getSize();
       while(1)



From gruntster at mail.berlios.de  Tue Feb 24 23:25:33 2009
From: gruntster at mail.berlios.de (gruntster at mail.berlios.de)
Date: Tue, 24 Feb 2009 23:25:33 +0100
Subject: [Avidemux-svn-commit] r4633 - in
	branches/avidemux_2.5_branch_gruntster/avidemux: .
	ADM_userInterfaces/ADM_render
Message-ID: <200902242225.n1OMPXO1017485@sheep.berlios.de>

Author: gruntster
Date: 2009-02-24 23:25:28 +0100 (Tue, 24 Feb 2009)
New Revision: 4633

Modified:
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_render/CMakeLists.txt
   branches/avidemux_2.5_branch_gruntster/avidemux/CMakeLists.txt
Log:
[mac] add Cocoa framework to ldflags for renderer

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_render/CMakeLists.txt
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_render/CMakeLists.txt	2009-02-24 19:09:10 UTC (rev 4632)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_render/CMakeLists.txt	2009-02-24 22:25:28 UTC (rev 4633)
@@ -14,6 +14,10 @@
 SDLify(GUI_sdlRender.cpp)
 ADM_TARGET_LINK_LIBARIES_ALL_TARGET(${ADM_LIB} ADM_core ADM_coreUI ADM_coreImage)
 
+IF (APPLE)
+	ADM_TARGET_LINK_LIBARIES_ALL_TARGET(${ADM_LIB} "-framework Cocoa")
+ENDIF (APPLE)
+
 IF (ADM_UI_GTK)
 	IF (GETTEXT_FOUND)
 		TARGET_LINK_LIBRARIES(${ADM_LIB}_gtk ${GETTEXT_LIBRARY_DIR})

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/CMakeLists.txt
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/CMakeLists.txt	2009-02-24 19:09:10 UTC (rev 4632)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/CMakeLists.txt	2009-02-24 22:25:28 UTC (rev 4633)
@@ -441,7 +441,7 @@
 ENDIF (WIN32)
 
 IF (APPLE)
-	ADD_LIB_ALL_TARGETS("-framework CoreServices -framework CoreAudio -framework AudioUnit -framework Carbon -framework Cocoa")
+	ADD_LIB_ALL_TARGETS("-framework CoreServices -framework CoreAudio -framework AudioUnit -framework Carbon")
 
 	# for Leopard but it doesn't hurt Tiger
 	ADD_LIB_ALL_TARGETS("-Wl,-dylib_file,/System/Library/Frameworks/OpenGL.framework/Versions/A/Libraries/libGL.dylib:/System/Library/Frameworks/OpenGL.framework/Versions/A/Libraries/libGL.dylib")



From gruntster at mail.berlios.de  Wed Feb 25 15:04:47 2009
From: gruntster at mail.berlios.de (gruntster at mail.berlios.de)
Date: Wed, 25 Feb 2009 15:04:47 +0100
Subject: [Avidemux-svn-commit] r4634 -
	branches/avidemux_2.5_branch_gruntster/avidemux/ADM_script
Message-ID: <200902251404.n1PE4l6W027982@sheep.berlios.de>

Author: gruntster
Date: 2009-02-25 15:04:40 +0100 (Wed, 25 Feb 2009)
New Revision: 4634

Added:
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_script/ADM_JSDFMenu.cpp
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_script/ADM_JSDFMenu.h
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_script/ADM_JSDialogFactory.cpp
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_script/ADM_JSDialogFactory.h
Modified:
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_script/ADM_JSGlobal.cpp
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_script/CMakeLists.txt
Log:
[script] add very basic dialogFactory class to ECMAScript engine

Added: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_script/ADM_JSDFMenu.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_script/ADM_JSDFMenu.cpp	2009-02-24 22:25:28 UTC (rev 4633)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_script/ADM_JSDFMenu.cpp	2009-02-25 14:04:40 UTC (rev 4634)
@@ -0,0 +1,177 @@
+#include "ADM_JSDFMenu.h"
+
+ADM_JSDFMenuHelper::ADM_JSDFMenuHelper(const char *title)
+{
+	_title = ADM_strdup(title);
+	_menuEntries = NULL;
+	_index = 0;
+}
+
+ADM_JSDFMenuHelper::~ADM_JSDFMenuHelper(void)
+{
+	if (_title)
+		delete _title;
+
+	_title = NULL;
+
+	std::vector<char*>::iterator it;
+
+	for (it = _items.begin(); it != _items.end(); it++)
+		delete *it;
+
+	_items.clear();
+
+	if (_menuEntries)
+		delete _menuEntries;
+
+	_menuEntries = NULL;
+}
+
+void ADM_JSDFMenuHelper::addItem(const char* item)
+{
+	_items.push_back(ADM_strdup(item));
+}
+
+diaElem* ADM_JSDFMenuHelper::getControl(void)
+{
+	if (_menuEntries)
+		delete _menuEntries;
+
+	std::vector<char*>::iterator it;
+	int i = 0;
+
+	_menuEntries = new diaMenuEntry[_items.size()];	
+
+	for (it = _items.begin(); it != _items.end(); it++)
+	{
+		_menuEntries[i].val = i;
+		_menuEntries[i].text = *it;
+		_menuEntries[i].desc = NULL;
+
+		i++;
+	}
+
+	return new diaElemMenu(&_index, _title, _items.size(), _menuEntries);
+}
+
+int ADM_JSDFMenuHelper::index(void)
+{
+	return _index;
+}
+
+void ADM_JSDFMenuHelper::setIndex(int index)
+{
+	_index = index;
+}
+
+JSPropertySpec ADM_JSDFMenu::properties[] = 
+{ 
+	{ "index", indexProperty, JSPROP_ENUMERATE },
+	{ 0 }
+};
+
+JSFunctionSpec ADM_JSDFMenu::methods[] =
+{
+	{ "addItem", addItem, 1, 0, 0 },
+	{ 0 }
+};
+
+JSClass ADM_JSDFMenu::m_dfMenuHelper =
+{
+	"DFMenu", JSCLASS_HAS_PRIVATE,
+	JS_PropertyStub, JS_PropertyStub,
+	ADM_JSDFMenu::JSGetProperty, ADM_JSDFMenu::JSSetProperty,
+	JS_EnumerateStub, JS_ResolveStub,
+	JS_ConvertStub, ADM_JSDFMenu::JSDestructor
+};
+
+JSObject *ADM_JSDFMenu::JSInit(JSContext *cx, JSObject *obj, JSObject *proto)
+{
+	return JS_InitClass(cx, obj, proto, &m_dfMenuHelper, 
+		ADM_JSDFMenu::JSConstructor, 1,
+		ADM_JSDFMenu::properties, ADM_JSDFMenu::methods,
+		NULL, NULL);
+}
+
+JSBool ADM_JSDFMenu::JSConstructor(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval)
+{
+	if (argc != 1)
+		return JS_FALSE;
+
+	if (!JSVAL_IS_STRING(argv[0]))
+		return JS_FALSE;
+
+	ADM_JSDFMenuHelper *pObject = new ADM_JSDFMenuHelper(JS_GetStringBytes(JSVAL_TO_STRING(argv[0])));
+
+	if (!JS_SetPrivate(cx, obj, pObject))
+		return JS_FALSE;
+
+	*rval = OBJECT_TO_JSVAL(obj);
+
+	return JS_TRUE;
+}
+
+void ADM_JSDFMenu::JSDestructor(JSContext *cx, JSObject *obj)
+{
+	ADM_JSDFMenuHelper *pObject = (ADM_JSDFMenuHelper*)JS_GetInstancePrivate(cx, obj, &m_dfMenuHelper, NULL);
+
+	if (pObject)
+		delete pObject;
+}
+
+JSBool ADM_JSDFMenu::addItem(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval)
+{
+	ADM_JSDFMenuHelper *pObject = (ADM_JSDFMenuHelper*)JS_GetInstancePrivate(cx, obj, &m_dfMenuHelper, NULL);
+
+	if (argc != 1)
+		return JS_FALSE;
+
+	if (!JSVAL_IS_STRING(argv[0]))
+		return JS_FALSE;
+
+	pObject->addItem(JS_GetStringBytes(JSVAL_TO_STRING(argv[0])));
+
+	return JS_TRUE;
+}
+
+JSBool ADM_JSDFMenu::JSGetProperty(JSContext *cx, JSObject *obj, jsval id, jsval *vp)
+{
+	if (JSVAL_IS_INT(id)) 
+	{
+		ADM_JSDFMenuHelper *pObject = (ADM_JSDFMenuHelper*)JS_GetInstancePrivate(cx, obj, &m_dfMenuHelper, NULL);
+
+		switch(JSVAL_TO_INT(id))
+		{
+			case indexProperty:
+			{
+				*vp = INT_TO_JSVAL(pObject->index());
+				break;
+			}
+		}
+	}
+
+	return JS_TRUE;
+}
+
+JSBool ADM_JSDFMenu::JSSetProperty(JSContext *cx, JSObject *obj, jsval id, jsval *vp)
+{
+	if (JSVAL_IS_INT(id)) 
+	{
+		ADM_JSDFMenuHelper *pObject = (ADM_JSDFMenuHelper*)JS_GetInstancePrivate(cx, obj, &m_dfMenuHelper, NULL);
+
+		switch(JSVAL_TO_INT(id))
+		{
+			case indexProperty:
+			{
+				if (JSVAL_IS_INT(*vp))
+					pObject->setIndex(JSVAL_TO_INT(*vp));
+
+				break;
+			}
+			default:
+				return JS_FALSE;
+		}
+	}
+
+	return JS_TRUE;
+}

Added: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_script/ADM_JSDFMenu.h
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_script/ADM_JSDFMenu.h	2009-02-24 22:25:28 UTC (rev 4633)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_script/ADM_JSDFMenu.h	2009-02-25 14:04:40 UTC (rev 4634)
@@ -0,0 +1,50 @@
+#ifndef _ADM_JSDFMenu_H
+#define _ADM_JSDFMenu_H
+
+#include "config.h"
+#include "ADM_libraries/ADM_smjs/jsapi.h"
+#include "DIA_factory.h"
+#include <vector>
+
+class ADM_JSDFMenuHelper
+{
+private:
+	char* _title;
+	uint32_t _index;
+	diaMenuEntry *_menuEntries;
+	std::vector <char*> _items;
+
+public:
+	ADM_JSDFMenuHelper(const char *title);
+	~ADM_JSDFMenuHelper(void);
+	void addItem(const char* item);
+	diaElem* getControl(void);
+	int index(void);
+	void setIndex(int index);
+};
+
+class ADM_JSDFMenu
+{
+public:
+	ADM_JSDFMenu(void) {}
+
+	static JSBool JSConstructor(JSContext *cx, JSObject *obj, uintN argc, 
+								jsval *argv, jsval *rval);
+	static void JSDestructor(JSContext *cx, JSObject *obj);
+	static JSObject *JSInit(JSContext *cx, JSObject *obj, JSObject *proto = NULL);
+	static JSBool JSGetProperty(JSContext *cx, JSObject *obj, jsval id, jsval *vp);
+	static JSBool JSSetProperty(JSContext *cx, JSObject *obj, jsval id, jsval *vp);
+
+	static JSBool addItem(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval);	
+
+	static JSPropertySpec properties[];
+	static JSFunctionSpec methods[];
+	static JSClass m_dfMenuHelper;
+
+	enum
+	{
+		indexProperty
+	};
+};
+
+#endif

Added: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_script/ADM_JSDialogFactory.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_script/ADM_JSDialogFactory.cpp	2009-02-24 22:25:28 UTC (rev 4633)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_script/ADM_JSDialogFactory.cpp	2009-02-25 14:04:40 UTC (rev 4634)
@@ -0,0 +1,123 @@
+#include "ADM_JSDialogFactory.h"
+
+ADM_JSDialogFactoryHelper::ADM_JSDialogFactoryHelper(const char *title)
+{
+	_title = ADM_strdup(title);
+}
+
+ADM_JSDialogFactoryHelper::~ADM_JSDialogFactoryHelper(void)
+{
+	if (_title)
+		delete _title;
+
+	_title = NULL;
+}
+
+void ADM_JSDialogFactoryHelper::addControl(ADM_JSDFMenuHelper* control)
+{
+	_controls.push_back(control);
+}
+
+diaElem** ADM_JSDialogFactoryHelper::getControls(int *controlCount)
+{
+	*controlCount = (int)_controls.size();
+
+	std::vector<ADM_JSDFMenuHelper*>::iterator it;
+	int i = 0;
+	diaElem **elems = new diaElem*[*controlCount];
+
+	for (it = _controls.begin(); it != _controls.end(); it++)
+	{
+		elems[i] = (*it)->getControl();
+		i++;
+	}
+
+	return elems;
+}
+
+const char* ADM_JSDialogFactoryHelper::title(void)
+{
+	return _title;
+}
+
+JSFunctionSpec ADM_JSDialogFactory::methods[] =
+{
+	{ "addControl", addControl, 1, 0, 0 },
+	{ "show", show, 0, 0, 0 },
+	{ 0 }
+};
+
+JSClass ADM_JSDialogFactory::m_dialogFactoryHelper =
+{
+	"DialogFactory", JSCLASS_HAS_PRIVATE,
+	JS_PropertyStub, JS_PropertyStub,
+	JS_PropertyStub, JS_PropertyStub,
+	JS_EnumerateStub, JS_ResolveStub,
+	JS_ConvertStub, ADM_JSDialogFactory::JSDestructor
+};
+
+JSObject *ADM_JSDialogFactory::JSInit(JSContext *cx, JSObject *obj, JSObject *proto)
+{
+	return JS_InitClass(cx, obj, proto, &m_dialogFactoryHelper, 
+		ADM_JSDialogFactory::JSConstructor, 1,
+		NULL, ADM_JSDialogFactory::methods,
+		NULL, NULL);
+}
+
+JSBool ADM_JSDialogFactory::JSConstructor(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval)
+{
+	if (argc != 1)
+		return JS_FALSE;
+
+	if (JSVAL_IS_STRING(argv[0]) == false)
+		return JS_FALSE;
+
+	ADM_JSDialogFactoryHelper *pObject = new ADM_JSDialogFactoryHelper(JS_GetStringBytes(JSVAL_TO_STRING(argv[0])));
+
+	if (!JS_SetPrivate(cx, obj, pObject))
+		return JS_FALSE;
+
+	*rval = OBJECT_TO_JSVAL(obj);
+
+	return JS_TRUE;
+}
+
+void ADM_JSDialogFactory::JSDestructor(JSContext *cx, JSObject *obj)
+{
+	ADM_JSDialogFactoryHelper *pObject = (ADM_JSDialogFactoryHelper*)JS_GetInstancePrivate(cx, obj, &m_dialogFactoryHelper, NULL);
+
+	if (pObject != NULL)
+		delete pObject;
+}
+
+JSBool ADM_JSDialogFactory::addControl(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval)
+{
+	ADM_JSDialogFactoryHelper *p = (ADM_JSDialogFactoryHelper*)JS_GetInstancePrivate(cx, obj, &m_dialogFactoryHelper, NULL);
+
+	if (argc != 1)
+		return JS_FALSE;
+
+	p->addControl((ADM_JSDFMenuHelper*)JS_GetPrivate(cx, JSVAL_TO_OBJECT(argv[0])));
+
+	return JS_TRUE;
+}
+
+JSBool ADM_JSDialogFactory::show(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval)
+{
+	ADM_JSDialogFactoryHelper *p = (ADM_JSDialogFactoryHelper*)JS_GetInstancePrivate(cx, obj, &m_dialogFactoryHelper, NULL);
+
+	if (argc != 0)
+		return JS_FALSE;
+
+	int controlCount;
+	diaElem **elems = p->getControls(&controlCount);
+
+	*rval = BOOLEAN_TO_JSVAL(diaFactoryRun(p->title(), controlCount, elems));
+
+	for (int i = 0; i < controlCount; i++)
+		delete elems[i];
+
+	delete elems;
+
+	return JS_TRUE;
+}

Added: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_script/ADM_JSDialogFactory.h
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_script/ADM_JSDialogFactory.h	2009-02-24 22:25:28 UTC (rev 4633)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_script/ADM_JSDialogFactory.h	2009-02-25 14:04:40 UTC (rev 4634)
@@ -0,0 +1,41 @@
+#ifndef _ADM_JSDialogFactory_H
+#define _ADM_JSDialogFactory_H
+
+#include "config.h"
+#include "ADM_libraries/ADM_smjs/jsapi.h"
+#include "DIA_factory.h"
+#include "ADM_JSDFMenu.h"
+#include <vector>
+
+class ADM_JSDialogFactoryHelper
+{
+private:
+	char* _title;
+	std::vector <ADM_JSDFMenuHelper*> _controls;
+
+public:
+	ADM_JSDialogFactoryHelper(const char *title);
+	~ADM_JSDialogFactoryHelper(void);
+	void addControl(ADM_JSDFMenuHelper* control);
+	diaElem** getControls(int *controlCount);
+	const char* title(void);
+};
+
+class ADM_JSDialogFactory
+{
+public:
+	ADM_JSDialogFactory(void) {}
+	virtual ~ADM_JSDialogFactory(void);
+
+	static JSBool JSConstructor(JSContext *cx, JSObject *obj, uintN argc, 
+								jsval *argv, jsval *rval);
+	static void JSDestructor(JSContext *cx, JSObject *obj);
+	static JSObject *JSInit(JSContext *cx, JSObject *obj, JSObject *proto = NULL);
+	static JSBool addControl(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval);
+	static JSBool show(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval);
+
+	static JSFunctionSpec methods[];
+	static JSClass m_dialogFactoryHelper;
+};
+
+#endif

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_script/ADM_JSGlobal.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_script/ADM_JSGlobal.cpp	2009-02-24 22:25:28 UTC (rev 4633)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_script/ADM_JSGlobal.cpp	2009-02-25 14:04:40 UTC (rev 4634)
@@ -18,6 +18,8 @@
 #include "ADM_JSGlobal.h"
 #include "ADM_JSAvidemux.h"
 #include "ADM_JSDirectorySearch.h"
+#include "ADM_JSDialogFactory.h"
+#include "ADM_JSDFMenu.h"
 
 extern uint8_t JS_AvidemuxFunction(JSContext *cx,JSObject *global);
 extern void A_Resync(void);
@@ -94,6 +96,9 @@
 			// load our custom JS class objects
 			JSObject *obj = ADM_JSAvidemux::JSInit(cx, global);
 			JSObject *dsObj = ADM_JSDirectorySearch::JSInit(cx, global);
+			JSObject *df = ADM_JSDialogFactory::JSInit(cx, global);
+			JSObject *dfmenu = ADM_JSDFMenu::JSInit(cx, global);
+
 			// register error handler
 			JS_SetErrorReporter(cx, printJSError);
                         JS_AvidemuxFunction(cx,global);

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_script/CMakeLists.txt
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_script/CMakeLists.txt	2009-02-24 22:25:28 UTC (rev 4633)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_script/CMakeLists.txt	2009-02-25 14:04:40 UTC (rev 4634)
@@ -1,6 +1,7 @@
 SET(ADM_script_SRCS
 	ADM_AvidemuxAudio.cpp  ADM_AvidemuxVideo.cpp    ADM_JSAvidemux.cpp       ADM_JSDirectorySearch.cpp  ADM_JSGlobal.cpp
-	ADM_Avidemux.cpp       ADM_JSAvidemuxAudio.cpp  ADM_JSAvidemuxVideo.cpp  ADM_JSFunctions.cpp        DirectorySearch.cpp)
+	ADM_Avidemux.cpp       ADM_JSAvidemuxAudio.cpp  ADM_JSAvidemuxVideo.cpp  ADM_JSFunctions.cpp        DirectorySearch.cpp
+	ADM_JSDialogFactory.cpp  ADM_JSDFMenu.cpp)
 
 ADD_ADM_LIB_ALL_TARGETS(ADM_script ${ADM_script_SRCS})
 



From gruntster at mail.berlios.de  Wed Feb 25 21:00:25 2009
From: gruntster at mail.berlios.de (gruntster at mail.berlios.de)
Date: Wed, 25 Feb 2009 21:00:25 +0100
Subject: [Avidemux-svn-commit] r4635 -
	branches/avidemux_2.5_branch_gruntster/avidemux/ADM_core/src
Message-ID: <200902252000.n1PK0PAj018597@sheep.berlios.de>

Author: gruntster
Date: 2009-02-25 21:00:12 +0100 (Wed, 25 Feb 2009)
New Revision: 4635

Modified:
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_core/src/ADM_dynamicLoading.cpp
Log:
[plugin] make plugin symbols local (not global) on Unix so functions with same name don't clash

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_core/src/ADM_dynamicLoading.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_core/src/ADM_dynamicLoading.cpp	2009-02-25 14:04:40 UTC (rev 4634)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_core/src/ADM_dynamicLoading.cpp	2009-02-25 20:00:12 UTC (rev 4635)
@@ -91,7 +91,7 @@
 		return true;
 	}
 #else
-	hinstLib = dlopen(path, RTLD_NOW | RTLD_GLOBAL);
+	hinstLib = dlopen(path, RTLD_NOW | RTLD_LOCAL);
 	
 	if (hinstLib == NULL)
 	{



From gruntster at mail.berlios.de  Wed Feb 25 22:38:48 2009
From: gruntster at mail.berlios.de (gruntster at mail.berlios.de)
Date: Wed, 25 Feb 2009 22:38:48 +0100
Subject: [Avidemux-svn-commit] r4636 -
	branches/avidemux_2.5_branch_gruntster/plugins/ADM_audioDevices/Esd
Message-ID: <200902252138.n1PLcmbM028992@sheep.berlios.de>

Author: gruntster
Date: 2009-02-25 22:38:44 +0100 (Wed, 25 Feb 2009)
New Revision: 4636

Modified:
   branches/avidemux_2.5_branch_gruntster/plugins/ADM_audioDevices/Esd/CMakeLists.txt
Log:
[esd] fix link libraries

Modified: branches/avidemux_2.5_branch_gruntster/plugins/ADM_audioDevices/Esd/CMakeLists.txt
===================================================================
--- branches/avidemux_2.5_branch_gruntster/plugins/ADM_audioDevices/Esd/CMakeLists.txt	2009-02-25 20:00:12 UTC (rev 4635)
+++ branches/avidemux_2.5_branch_gruntster/plugins/ADM_audioDevices/Esd/CMakeLists.txt	2009-02-25 21:38:44 UTC (rev 4636)
@@ -5,7 +5,7 @@
 
 ADD_LIBRARY(ADM_av_esd SHARED ${ADM_av_esd_SRCS})
 INCLUDE_DIRECTORIES(${ESD_INCLUDE_DIR})
-TARGET_LINK_LIBRARIES(ADM_av_esd ${ESD_LIBRARY_DIR})
+TARGET_LINK_LIBRARIES(ADM_av_esd ADM_coreAudio ${ESD_LIBRARY_DIR})
 
 
 INIT_AUDIO_DEVICE(ADM_av_esd)



From gruntster at mail.berlios.de  Wed Feb 25 22:41:02 2009
From: gruntster at mail.berlios.de (gruntster at mail.berlios.de)
Date: Wed, 25 Feb 2009 22:41:02 +0100
Subject: [Avidemux-svn-commit] r4637 -
	branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_x264/gtk
Message-ID: <200902252141.n1PLf2SI029356@sheep.berlios.de>

Author: gruntster
Date: 2009-02-25 22:40:58 +0100 (Wed, 25 Feb 2009)
New Revision: 4637

Modified:
   branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_x264/gtk/x264ConfigDialog.cpp
Log:
[x264] fix compilation error for GTK plugin when using a libx264 core version earlier than 65

Modified: branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_x264/gtk/x264ConfigDialog.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_x264/gtk/x264ConfigDialog.cpp	2009-02-25 21:38:44 UTC (rev 4636)
+++ branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_x264/gtk/x264ConfigDialog.cpp	2009-02-25 21:40:58 UTC (rev 4637)
@@ -95,15 +95,15 @@
 
 	gtk_widget_hide(WID(checkbuttonBidirME));
 #else
-	gtk_combo_box_append_text (GTK_COMBO_BOX (comboboxPartitionDecision), _("1  - Extremely Low (Fastest)"));
-	gtk_combo_box_append_text (GTK_COMBO_BOX (comboboxPartitionDecision), _("2  - Very Low"));
-	gtk_combo_box_append_text (GTK_COMBO_BOX (comboboxPartitionDecision), _("3  - Low"));
-	gtk_combo_box_append_text (GTK_COMBO_BOX (comboboxPartitionDecision), _("4  - Medium"));
-	gtk_combo_box_append_text (GTK_COMBO_BOX (comboboxPartitionDecision), _("5  - High (Default)"));
-	gtk_combo_box_append_text (GTK_COMBO_BOX (comboboxPartitionDecision), _("6  - Very High"));
-	gtk_combo_box_append_text (GTK_COMBO_BOX (comboboxPartitionDecision), _("6B - Very High (RDO on B-frames)"));
-	gtk_combo_box_append_text (GTK_COMBO_BOX (comboboxPartitionDecision), _("7  - Ultra High"));
-	gtk_combo_box_append_text (GTK_COMBO_BOX (comboboxPartitionDecision), _("7B - Ultra High (RDO on B-frames)"));
+	gtk_combo_box_append_text (GTK_COMBO_BOX(WID(comboboxPartitionDecision)), _("1  - Extremely Low (Fastest)"));
+	gtk_combo_box_append_text (GTK_COMBO_BOX(WID(comboboxPartitionDecision)), _("2  - Very Low"));
+	gtk_combo_box_append_text (GTK_COMBO_BOX(WID(comboboxPartitionDecision)), _("3  - Low"));
+	gtk_combo_box_append_text (GTK_COMBO_BOX(WID(comboboxPartitionDecision)), _("4  - Medium"));
+	gtk_combo_box_append_text (GTK_COMBO_BOX(WID(comboboxPartitionDecision)), _("5  - High (Default)"));
+	gtk_combo_box_append_text (GTK_COMBO_BOX(WID(comboboxPartitionDecision)), _("6  - Very High"));
+	gtk_combo_box_append_text (GTK_COMBO_BOX(WID(comboboxPartitionDecision)), _("6B - Very High (RDO on B-frames)"));
+	gtk_combo_box_append_text (GTK_COMBO_BOX(WID(comboboxPartitionDecision)), _("7  - Ultra High"));
+	gtk_combo_box_append_text (GTK_COMBO_BOX(WID(comboboxPartitionDecision)), _("7B - Ultra High (RDO on B-frames)"));
 #endif
 
 	loadOptions(dialog, options);



From gruntster at mail.berlios.de  Thu Feb 26 22:25:21 2009
From: gruntster at mail.berlios.de (gruntster at mail.berlios.de)
Date: Thu, 26 Feb 2009 22:25:21 +0100
Subject: [Avidemux-svn-commit] r4638 - in
	branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder:
	ADM_vidEnc_x264 ADM_vidEnc_xvid
Message-ID: <200902262125.n1QLPLDt004674@sheep.berlios.de>

Author: gruntster
Date: 2009-02-26 22:25:16 +0100 (Thu, 26 Feb 2009)
New Revision: 4638

Modified:
   branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_x264/options.cpp
   branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_xvid/options.cpp
Log:
[x264/xvid] employ a locale-agnostic output for numbers in settings XML

Modified: branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_x264/options.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_x264/options.cpp	2009-02-25 21:40:58 UTC (rev 4637)
+++ branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_x264/options.cpp	2009-02-26 21:25:16 UTC (rev 4638)
@@ -24,6 +24,8 @@
 #include <math.h>
 #include <libxml/parser.h>
 #include <libxml/xmlschemas.h>
+#include <sstream>
+#include <string>
 
 #include "config.h"
 #include "ADM_inttype.h"
@@ -2002,31 +2004,49 @@
 
 xmlChar* x264Options::number2String(xmlChar *buffer, size_t size, int number)
 {
-	snprintf((char*)buffer, size, "%d", number);
+	std::ostringstream stream;
 
+	stream.imbue(std::locale::classic());
+	stream << number;
+	std::string string = stream.str();
+
+	strncpy((char*)buffer, string.c_str(), size);
+
 	return buffer;
 }
 
 xmlChar* x264Options::number2String(xmlChar *buffer, size_t size, unsigned int number)
 {
-	snprintf((char*)buffer, size, "%d", number);
+	std::ostringstream stream;
 
+	stream.imbue(std::locale::classic());
+	stream << number;
+	std::string string = stream.str();
+
+	strncpy((char*)buffer, string.c_str(), size);
+
 	return buffer;
 }
 
 xmlChar* x264Options::number2String(xmlChar *buffer, size_t size, float number)
 {
-	snprintf((char*)buffer, size, "%f", number);
+	std::ostringstream stream;
 
+	stream.imbue(std::locale::classic());
+	stream << number;
+	std::string string = stream.str();
+
+	strncpy((char*)buffer, string.c_str(), size);
+
 	return buffer;
 }
 
 xmlChar* x264Options::boolean2String(xmlChar *buffer, size_t size, bool boolean)
 {
 	if (boolean)
-		strcpy((char*)buffer, "true");
+		strncpy((char*)buffer, "true", size);
 	else
-		strcpy((char*)buffer, "false");
+		strncpy((char*)buffer, "false", size);
 
 	return buffer;
 }

Modified: branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_xvid/options.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_xvid/options.cpp	2009-02-25 21:40:58 UTC (rev 4637)
+++ branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_xvid/options.cpp	2009-02-26 21:25:16 UTC (rev 4638)
@@ -21,10 +21,10 @@
  *                                                                         *
  ***************************************************************************/
 
-#include <stdlib.h>
-#include <string.h>
 #include <libxml/parser.h>
 #include <libxml/xmlschemas.h>
+#include <sstream>
+#include <string>
 
 #include "config.h"
 #include "ADM_inttype.h"
@@ -1311,22 +1311,40 @@
 
 xmlChar* XvidOptions::number2String(xmlChar *buffer, size_t size, int number)
 {
-	snprintf((char*)buffer, size, "%d", number);
+	std::ostringstream stream;
 
+	stream.imbue(std::locale::classic());
+	stream << number;
+	std::string string = stream.str();
+
+	strncpy((char*)buffer, string.c_str(), size);
+
 	return buffer;
 }
 
 xmlChar* XvidOptions::number2String(xmlChar *buffer, size_t size, unsigned int number)
 {
-	snprintf((char*)buffer, size, "%d", number);
+	std::ostringstream stream;
 
+	stream.imbue(std::locale::classic());
+	stream << number;
+	std::string string = stream.str();
+
+	strncpy((char*)buffer, string.c_str(), size);
+
 	return buffer;
 }
 
 xmlChar* XvidOptions::number2String(xmlChar *buffer, size_t size, float number)
 {
-	snprintf((char*)buffer, size, "%f", number);
+	std::ostringstream stream;
 
+	stream.imbue(std::locale::classic());
+	stream << number;
+	std::string string = stream.str();
+
+	strncpy((char*)buffer, string.c_str(), size);
+
 	return buffer;
 }
 



From gruntster at mail.berlios.de  Fri Feb 27 14:35:07 2009
From: gruntster at mail.berlios.de (gruntster at mail.berlios.de)
Date: Fri, 27 Feb 2009 14:35:07 +0100
Subject: [Avidemux-svn-commit] r4639 -
	branches/avidemux_2.5_branch_gruntster/avidemux/ADM_encoder
Message-ID: <200902271335.n1RDZ7xL030906@sheep.berlios.de>

Author: gruntster
Date: 2009-02-27 14:35:02 +0100 (Fri, 27 Feb 2009)
New Revision: 4639

Modified:
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_encoder/ADM_externalEncoder.cpp
Log:
[plugins] instruct plugin to prepare for first pass upon initialisation so extra header info can be determined earlier

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_encoder/ADM_externalEncoder.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_encoder/ADM_externalEncoder.cpp	2009-02-26 21:25:16 UTC (rev 4638)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_encoder/ADM_externalEncoder.cpp	2009-02-27 13:35:02 UTC (rev 4639)
@@ -67,12 +67,7 @@
 		properties.flags |= ADM_VIDENC_FLAG_GLOBAL_HEADER;
 
 	if (_plugin->open(_plugin->encoderId, &properties))
-	{
-		if (!isDualPass())
-			return (startPass() == ADM_VIDENC_ERR_SUCCESS);
-		else
-			return 1;
-	}
+		return (startPass() == ADM_VIDENC_ERR_SUCCESS);
 	else
 		return 0;
 }
@@ -191,7 +186,7 @@
 
 uint8_t externalEncoder::startPass1(void)
 {
-	return startPass();
+	return 1;
 }
 
 uint8_t externalEncoder::startPass2(void)



From gruntster at mail.berlios.de  Fri Feb 27 14:41:06 2009
From: gruntster at mail.berlios.de (gruntster at mail.berlios.de)
Date: Fri, 27 Feb 2009 14:41:06 +0100
Subject: [Avidemux-svn-commit] r4640 - in
	branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters:
	FluxSmooth ResampleFps
Message-ID: <200902271341.n1RDf6eR031422@sheep.berlios.de>

Author: gruntster
Date: 2009-02-27 14:41:01 +0100 (Fri, 27 Feb 2009)
New Revision: 4640

Modified:
   branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/FluxSmooth/CMakeLists.txt
   branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/ResampleFps/CMakeLists.txt
Log:
[plugins] fix Mac build for FluxSmooth and ResampleFps

Modified: branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/FluxSmooth/CMakeLists.txt
===================================================================
--- branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/FluxSmooth/CMakeLists.txt	2009-02-27 13:35:02 UTC (rev 4639)
+++ branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/FluxSmooth/CMakeLists.txt	2009-02-27 13:41:01 UTC (rev 4640)
@@ -5,5 +5,9 @@
 
 ADD_LIBRARY(ADM_vf_FluxSmooth SHARED ${ADM_vf_FluxSmooth_SRCS})
 
+IF (APPLE)
+	TARGET_LINK_LIBRARIES(ADM_vf_FluxSmooth -Wl,-read_only_relocs,suppress)
+ENDIF (APPLE)
+
 INIT_VIDEOFILTER_PLUGIN(ADM_vf_FluxSmooth)
 INSTALL_VIDEOFILTER(ADM_vf_FluxSmooth)

Modified: branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/ResampleFps/CMakeLists.txt
===================================================================
--- branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/ResampleFps/CMakeLists.txt	2009-02-27 13:35:02 UTC (rev 4639)
+++ branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoFilters/ResampleFps/CMakeLists.txt	2009-02-27 13:41:01 UTC (rev 4640)
@@ -5,5 +5,9 @@
 
 ADD_LIBRARY(ADM_vf_resampleFps SHARED ${ADM_vf_resampleFps_SRCS})
 
+IF (APPLE)
+	TARGET_LINK_LIBRARIES(ADM_vf_resampleFps -Wl,-read_only_relocs,suppress)
+ENDIF (APPLE)
+
 INIT_VIDEOFILTER_PLUGIN(ADM_vf_resampleFps)
 INSTALL_VIDEOFILTER(ADM_vf_resampleFps)



