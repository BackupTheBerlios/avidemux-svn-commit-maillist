From mean at mail.berlios.de  Sun May  2 16:32:12 2010
From: mean at mail.berlios.de (mean at BerliOS)
Date: Sun, 2 May 2010 16:32:12 +0200
Subject: [Avidemux-svn-commit] r6147 - in branches/avidemux_2.6_branch_mean:
	avidemux/qt4/ADM_userInterfaces
	avidemux/qt4/ADM_userInterfaces/ADM_gui cmake
Message-ID: <201005021432.o42EWCed015002@sheep.berlios.de>

Author: mean
Date: 2010-05-02 16:32:10 +0200 (Sun, 02 May 2010)
New Revision: 6147

Modified:
   branches/avidemux_2.6_branch_mean/avidemux/qt4/ADM_userInterfaces/ADM_gui/T_preview.cpp
   branches/avidemux_2.6_branch_mean/avidemux/qt4/ADM_userInterfaces/ui_support.cpp
   branches/avidemux_2.6_branch_mean/cmake/Ts.cmake
Log:
[i18n/qt] Resync with 2.5

Modified: branches/avidemux_2.6_branch_mean/avidemux/qt4/ADM_userInterfaces/ADM_gui/T_preview.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/qt4/ADM_userInterfaces/ADM_gui/T_preview.cpp	2010-04-30 16:30:20 UTC (rev 6146)
+++ branches/avidemux_2.6_branch_mean/avidemux/qt4/ADM_userInterfaces/ADM_gui/T_preview.cpp	2010-05-02 14:32:10 UTC (rev 6147)
@@ -18,6 +18,7 @@
 #include <QtGui/QFrame>
 #include <QtGui/QImage>
 #include <QtGui/QPainter>
+#include <QtGui/QPaintEngine>
 
 /* Probably on unix/X11 ..*/
 #ifdef __APPLE__
@@ -35,6 +36,7 @@
 static QFrame *hostFrame=NULL;
 static uint8_t *lastImage=NULL;
 extern QWidget *QuiMainWindows;
+int paintEngineType = -1;
 
 
 void DIA_previewInit(uint32_t width, uint32_t height) {}
@@ -68,6 +70,17 @@
 	if(!displayW || !displayH || !rgbDataBuffer )
 		return ;
 	{
+
+       if (paintEngineType == -1)
+       {
+               QPainter painter(this);
+
+               if (painter.isActive())
+                       paintEngineType = painter.paintEngine()->type();
+
+               painter.end();
+       }
+
         if(true==renderExposeEventFromUI())
         {
             QImage image(rgbDataBuffer,displayW,displayH,QImage::Format_RGB32);

Modified: branches/avidemux_2.6_branch_mean/avidemux/qt4/ADM_userInterfaces/ui_support.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/qt4/ADM_userInterfaces/ui_support.cpp	2010-04-30 16:30:20 UTC (rev 6146)
+++ branches/avidemux_2.6_branch_mean/avidemux/qt4/ADM_userInterfaces/ui_support.cpp	2010-05-02 14:32:10 UTC (rev 6147)
@@ -8,15 +8,18 @@
 #ifdef __APPLE__
 #include <Carbon/Carbon.h>
 #endif
+#include <QtGui/QPaintEngine>
 
 #include "ADM_inttype.h"
 #include "ADM_files.h"
-//#include "ADM_encoder/ADM_pluginLoad.h"
 #include "DIA_uiTypes.h"
 extern QWidget *QuiMainWindows;
 
+#define MAX_UNLOADED_MSG_LENGTH 400
 static QTranslator qtTranslator;
 static QTranslator avidemuxTranslator;
+static QMap<QString, char*> *map = NULL;
+static bool translatorLoaded = false;
 
 static void loadTranslation(QTranslator *qTranslator, QString translation)
 {
@@ -28,20 +31,36 @@
 		printf("succeeded\n");
 	}
 	else
-		printf("FAILED\n");		
+		printf("FAILED\n");
 }
 
 void initTranslator(void) {}
 
 const char* translate(const char *__domainname, const char *__msgid)
 {
-	static QMap<QString, QByteArray> map;
 	QString msgid = QString(__msgid);
 
-	if (!map.contains(msgid))
-		map[msgid] = QApplication::translate("", __msgid).toUtf8();
+	if (!map)
+		map = new QMap<QString, char*>;
 
-	return map.value(msgid).constData();
+	if (!map->contains(msgid))
+	{
+		QByteArray translatedMessage = QApplication::translate("", __msgid).toUtf8();
+		int copyLength = translatedMessage.length() + 1;
+		char* buffer = new char[translatorLoaded ? copyLength : MAX_UNLOADED_MSG_LENGTH + 1];
+
+		if (!translatorLoaded && copyLength > MAX_UNLOADED_MSG_LENGTH + 1)
+		{
+			copyLength = MAX_UNLOADED_MSG_LENGTH;
+			buffer[MAX_UNLOADED_MSG_LENGTH] = '\0';
+		}
+
+		memcpy(buffer, translatedMessage.constData(), copyLength);
+
+		(*map)[msgid] = buffer;
+	}
+
+	return map->value(msgid);
 }
 
 #define HIDE_STRING_FROM_QT(domainname, msgid)  QApplication::translate(domainname, msgid) // to hide string from lupdate so a true test can be conducted
@@ -52,34 +71,98 @@
 
 #ifdef __APPLE__
 	QString appdir = QCoreApplication::applicationDirPath() + "/../Resources/locale/";
-#else
-	QString appdir = QCoreApplication::applicationDirPath() + "/i18n/";
+#elif defined(__WIN32)
+	QString appdir = QCoreApplication::applicationDirPath() + "/i18n/";
+#else
+	QString appdir = ADM_getInstallRelativePath("share","avidemux","i18n");
 #endif
 
 	loadTranslation(&qtTranslator, appdir + "qt_" + QLocale::system().name());
 	loadTranslation(&avidemuxTranslator, appdir + "avidemux_" + QLocale::system().name());
+	translatorLoaded = true;
 
+	// Re-translate existing map (to take care of global strings already allocated)
+	QMapIterator<QString, char*> mapIterator(*map);
+
+	while (mapIterator.hasNext())
+	{
+		mapIterator.next();
+
+		QByteArray translatedMessage = QApplication::translate("", mapIterator.key().toAscii().constData()).toUtf8();		
+		char *buffer = mapIterator.value();
+		int copyLength = translatedMessage.length() + 1;
+
+		if (copyLength > MAX_UNLOADED_MSG_LENGTH + 1)
+		{
+			copyLength = MAX_UNLOADED_MSG_LENGTH;
+			buffer[MAX_UNLOADED_MSG_LENGTH] = '\0';
+		}
+
+		memcpy(buffer, translatedMessage.constData(), copyLength);
+	}
+
 	printf("[Locale] Test: &Edit -> %s\n\n", HIDE_STRING_FROM_QT("MainWindow", "&Edit").toUtf8().data());
 }
 
-void destroyTranslator(void) {}
+void destroyTranslator(void)
+{
+	if (map)
+	{
+		QMapIterator<QString, char*> mapIterator(*map);
 
+		while (mapIterator.hasNext())
+		{
+			mapIterator.next();
+			delete(mapIterator.value());
+		}
+
+		delete map;
+	}
+}
+
 void getUIDescription(char* desc)
 {
-	sprintf(desc, "Qt4 (%s)", qVersion());
+	sprintf(desc, "Qt (%s)", qVersion());
 }
 ADM_UI_TYPE UI_GetCurrentUI(void)
 {
   return ADM_UI_QT4;
 }
 
-void getMainWindowHandles(long int *handle, long int *nativeHandle)
+void getMainWindowHandles(intptr_t *handle, intptr_t *nativeHandle)
 {
-	*handle = (long int)QuiMainWindows;
+	*handle = (intptr_t)QuiMainWindows;
 
 #if defined(__APPLE__)
-	*nativeHandle = (long int)HIViewGetWindow(HIViewRef(QuiMainWindows->winId()));
+	*nativeHandle = (intptr_t)HIViewGetWindow(HIViewRef(QuiMainWindows->winId()));
 #else
-	*nativeHandle = (long int)QuiMainWindows->winId();
+	*nativeHandle = (intptr_t)QuiMainWindows->winId();
 #endif
 }
+
+extern int paintEngineType;
+
+const char* getNativeRendererDesc(void)
+{
+	switch (paintEngineType)
+	{
+		case QPaintEngine::X11:
+			return QT_TR_NOOP("Qt (X11)");
+		case QPaintEngine::Windows:
+			return QT_TR_NOOP("Qt (MS Windows GDI)");
+		case QPaintEngine::CoreGraphics:
+			return QT_TR_NOOP("Qt (Mac OS X Quartz 2D)");
+		case QPaintEngine::QuickDraw:
+			return QT_TR_NOOP("Qt (Mac OS X QuickDraw)");
+		case QPaintEngine::OpenGL:
+			return QT_TR_NOOP("Qt (OpenGL)");
+#if QT_VERSION >= 0x040400
+		case QPaintEngine::Direct3D:
+			return QT_TR_NOOP("Qt (MS Windows Direct3D)");
+#endif
+		case QPaintEngine::Raster:
+			return QT_TR_NOOP("Qt (Default Raster)");
+	}
+
+	return "Qt";
+}

Modified: branches/avidemux_2.6_branch_mean/cmake/Ts.cmake
===================================================================
--- branches/avidemux_2.6_branch_mean/cmake/Ts.cmake	2010-04-30 16:30:20 UTC (rev 6146)
+++ branches/avidemux_2.6_branch_mean/cmake/Ts.cmake	2010-05-02 14:32:10 UTC (rev 6147)
@@ -27,7 +27,20 @@
 
 	ENDIF(NOT LRELEASE_EXECUTABLE AND NOT LRELEASE_NOT_FOUND)
 ENDMACRO(FIND_LRELEASE)
-
+#
+#
+#
+MACRO(INSTALL_I18N _files)
+        IF(WIN32)
+                SET(i18dir "${CMAKE_INSTALL_PREFIX}/${BIN_DIR}/i18n")
+        ELSE(WIN32)
+                SET(i18dir "${CMAKE_INSTALL_PREFIX}/share/avidemux/i18n")
+        ENDIF(WIN32)
+        INSTALL(FILES ${_files} DESTINATION "${i18dir}")
+ENDMACRO(INSTALL_I18N _files)
+#
+#
+#
 MACRO(COMPILE_AVIDEMUX_TS_FILES ts_subdir _sources)
     IF(XSLTPROC_EXECUTABLE AND LRELEASE_EXECUTABLE)
         FILE(GLOB ts_files ${ts_subdir}/avidemux_*.ts)
@@ -59,12 +72,11 @@
                 COMMAND ${LRELEASE_EXECUTABLE}
                     ${_outXml}
                     -qm ${_out}
-                DEPENDS ${_in}
+                DEPENDS ${_in} ${_outXml}
             )
                 
             SET(qm_files ${qm_files} ${_outXml} ${_out})
-
-			INSTALL(FILES ${_out} DESTINATION "${CMAKE_INSTALL_PREFIX}/${BIN_DIR}/i18n")
+            INSTALL_I18N( ${_out})
         ENDFOREACH(ts_input ${ts_files})
 
         SET(${_sources} ${${_sources}} ${qm_files})
@@ -95,7 +107,7 @@
                 
             SET(qm_files ${qm_files} ${_out})
 
-			INSTALL(FILES ${_out} DESTINATION "${CMAKE_INSTALL_PREFIX}/${BIN_DIR}/i18n")
+            INSTALL_I18N( ${_out})
         ENDFOREACH(ts_input ${ts_files})
 
         SET(${_sources} ${${_sources}} ${qm_files})
@@ -106,6 +118,6 @@
 	FIND_XSLTPROC()
 	FIND_LRELEASE()
 	
-	#COMPILE_AVIDEMUX_TS_FILES(${ts_subdir} ${_sources})
-	#COMPILE_QT_TS_FILES(${ts_subdir} ${_sources})
+	COMPILE_AVIDEMUX_TS_FILES(${ts_subdir} ${_sources})
+	COMPILE_QT_TS_FILES(${ts_subdir} ${_sources})
 ENDMACRO(COMPILE_TS_FILES)



From mean at mail.berlios.de  Sun May  2 16:32:14 2010
From: mean at mail.berlios.de (mean at BerliOS)
Date: Sun, 2 May 2010 16:32:14 +0200
Subject: [Avidemux-svn-commit] r6148 -
	branches/avidemux_2.6_branch_mean/avidemux/qt4/ADM_userInterfaces
Message-ID: <201005021432.o42EWEWQ015013@sheep.berlios.de>

Author: mean
Date: 2010-05-02 16:32:13 +0200 (Sun, 02 May 2010)
New Revision: 6148

Modified:
   branches/avidemux_2.6_branch_mean/avidemux/qt4/ADM_userInterfaces/ui_support.cpp
Log:
[nit] use unix eol

Modified: branches/avidemux_2.6_branch_mean/avidemux/qt4/ADM_userInterfaces/ui_support.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/qt4/ADM_userInterfaces/ui_support.cpp	2010-05-02 14:32:10 UTC (rev 6147)
+++ branches/avidemux_2.6_branch_mean/avidemux/qt4/ADM_userInterfaces/ui_support.cpp	2010-05-02 14:32:13 UTC (rev 6148)
@@ -1,168 +1,168 @@
-#include <stdio.h>
-#include <QtCore/QMap>
-#include <QtCore/QLocale>
-#include <QtCore/QTranslator>
-#include <QtGui/QApplication>
-#include <QtGui/QWidget>
-
-#ifdef __APPLE__
-#include <Carbon/Carbon.h>
-#endif
-#include <QtGui/QPaintEngine>
-
-#include "ADM_inttype.h"
-#include "ADM_files.h"
-#include "DIA_uiTypes.h"
-extern QWidget *QuiMainWindows;
-
-#define MAX_UNLOADED_MSG_LENGTH 400
-static QTranslator qtTranslator;
-static QTranslator avidemuxTranslator;
-static QMap<QString, char*> *map = NULL;
-static bool translatorLoaded = false;
-
-static void loadTranslation(QTranslator *qTranslator, QString translation)
-{
-	printf("[Locale] Loading language file %s ", translation.toUtf8().constData());	
-
-	if (qTranslator->load(translation))
-	{
-		QApplication::installTranslator(qTranslator);
-		printf("succeeded\n");
-	}
-	else
-		printf("FAILED\n");
-}
-
-void initTranslator(void) {}
-
-const char* translate(const char *__domainname, const char *__msgid)
-{
-	QString msgid = QString(__msgid);
-
-	if (!map)
-		map = new QMap<QString, char*>;
-
-	if (!map->contains(msgid))
-	{
-		QByteArray translatedMessage = QApplication::translate("", __msgid).toUtf8();
-		int copyLength = translatedMessage.length() + 1;
-		char* buffer = new char[translatorLoaded ? copyLength : MAX_UNLOADED_MSG_LENGTH + 1];
-
-		if (!translatorLoaded && copyLength > MAX_UNLOADED_MSG_LENGTH + 1)
-		{
-			copyLength = MAX_UNLOADED_MSG_LENGTH;
-			buffer[MAX_UNLOADED_MSG_LENGTH] = '\0';
-		}
-
-		memcpy(buffer, translatedMessage.constData(), copyLength);
-
-		(*map)[msgid] = buffer;
-	}
-
-	return map->value(msgid);
-}
-
-#define HIDE_STRING_FROM_QT(domainname, msgid)  QApplication::translate(domainname, msgid) // to hide string from lupdate so a true test can be conducted
-
-void loadTranslator(void)
-{
-	printf("\n[Locale] Locale: %s\n", QLocale::system().name().toUtf8().constData());
-
-#ifdef __APPLE__
-	QString appdir = QCoreApplication::applicationDirPath() + "/../Resources/locale/";
-#elif defined(__WIN32)
+#include <stdio.h>
+#include <QtCore/QMap>
+#include <QtCore/QLocale>
+#include <QtCore/QTranslator>
+#include <QtGui/QApplication>
+#include <QtGui/QWidget>
+
+#ifdef __APPLE__
+#include <Carbon/Carbon.h>
+#endif
+#include <QtGui/QPaintEngine>
+
+#include "ADM_inttype.h"
+#include "ADM_files.h"
+#include "DIA_uiTypes.h"
+extern QWidget *QuiMainWindows;
+
+#define MAX_UNLOADED_MSG_LENGTH 400
+static QTranslator qtTranslator;
+static QTranslator avidemuxTranslator;
+static QMap<QString, char*> *map = NULL;
+static bool translatorLoaded = false;
+
+static void loadTranslation(QTranslator *qTranslator, QString translation)
+{
+	printf("[Locale] Loading language file %s ", translation.toUtf8().constData());	
+
+	if (qTranslator->load(translation))
+	{
+		QApplication::installTranslator(qTranslator);
+		printf("succeeded\n");
+	}
+	else
+		printf("FAILED\n");
+}
+
+void initTranslator(void) {}
+
+const char* translate(const char *__domainname, const char *__msgid)
+{
+	QString msgid = QString(__msgid);
+
+	if (!map)
+		map = new QMap<QString, char*>;
+
+	if (!map->contains(msgid))
+	{
+		QByteArray translatedMessage = QApplication::translate("", __msgid).toUtf8();
+		int copyLength = translatedMessage.length() + 1;
+		char* buffer = new char[translatorLoaded ? copyLength : MAX_UNLOADED_MSG_LENGTH + 1];
+
+		if (!translatorLoaded && copyLength > MAX_UNLOADED_MSG_LENGTH + 1)
+		{
+			copyLength = MAX_UNLOADED_MSG_LENGTH;
+			buffer[MAX_UNLOADED_MSG_LENGTH] = '\0';
+		}
+
+		memcpy(buffer, translatedMessage.constData(), copyLength);
+
+		(*map)[msgid] = buffer;
+	}
+
+	return map->value(msgid);
+}
+
+#define HIDE_STRING_FROM_QT(domainname, msgid)  QApplication::translate(domainname, msgid) // to hide string from lupdate so a true test can be conducted
+
+void loadTranslator(void)
+{
+	printf("\n[Locale] Locale: %s\n", QLocale::system().name().toUtf8().constData());
+
+#ifdef __APPLE__
+	QString appdir = QCoreApplication::applicationDirPath() + "/../Resources/locale/";
+#elif defined(__WIN32)
 	QString appdir = QCoreApplication::applicationDirPath() + "/i18n/";
 #else
-	QString appdir = ADM_getInstallRelativePath("share","avidemux","i18n");
-#endif
-
-	loadTranslation(&qtTranslator, appdir + "qt_" + QLocale::system().name());
-	loadTranslation(&avidemuxTranslator, appdir + "avidemux_" + QLocale::system().name());
-	translatorLoaded = true;
-
-	// Re-translate existing map (to take care of global strings already allocated)
-	QMapIterator<QString, char*> mapIterator(*map);
-
-	while (mapIterator.hasNext())
-	{
-		mapIterator.next();
-
-		QByteArray translatedMessage = QApplication::translate("", mapIterator.key().toAscii().constData()).toUtf8();		
-		char *buffer = mapIterator.value();
-		int copyLength = translatedMessage.length() + 1;
-
-		if (copyLength > MAX_UNLOADED_MSG_LENGTH + 1)
-		{
-			copyLength = MAX_UNLOADED_MSG_LENGTH;
-			buffer[MAX_UNLOADED_MSG_LENGTH] = '\0';
-		}
-
-		memcpy(buffer, translatedMessage.constData(), copyLength);
-	}
-
-	printf("[Locale] Test: &Edit -> %s\n\n", HIDE_STRING_FROM_QT("MainWindow", "&Edit").toUtf8().data());
-}
-
-void destroyTranslator(void)
-{
-	if (map)
-	{
-		QMapIterator<QString, char*> mapIterator(*map);
-
-		while (mapIterator.hasNext())
-		{
-			mapIterator.next();
-			delete(mapIterator.value());
-		}
-
-		delete map;
-	}
-}
-
-void getUIDescription(char* desc)
-{
-	sprintf(desc, "Qt (%s)", qVersion());
-}
-ADM_UI_TYPE UI_GetCurrentUI(void)
-{
-  return ADM_UI_QT4;
-}
-
-void getMainWindowHandles(intptr_t *handle, intptr_t *nativeHandle)
-{
-	*handle = (intptr_t)QuiMainWindows;
-
-#if defined(__APPLE__)
-	*nativeHandle = (intptr_t)HIViewGetWindow(HIViewRef(QuiMainWindows->winId()));
-#else
-	*nativeHandle = (intptr_t)QuiMainWindows->winId();
-#endif
-}
-
-extern int paintEngineType;
-
-const char* getNativeRendererDesc(void)
-{
-	switch (paintEngineType)
-	{
-		case QPaintEngine::X11:
-			return QT_TR_NOOP("Qt (X11)");
-		case QPaintEngine::Windows:
-			return QT_TR_NOOP("Qt (MS Windows GDI)");
-		case QPaintEngine::CoreGraphics:
-			return QT_TR_NOOP("Qt (Mac OS X Quartz 2D)");
-		case QPaintEngine::QuickDraw:
-			return QT_TR_NOOP("Qt (Mac OS X QuickDraw)");
-		case QPaintEngine::OpenGL:
-			return QT_TR_NOOP("Qt (OpenGL)");
-#if QT_VERSION >= 0x040400
-		case QPaintEngine::Direct3D:
-			return QT_TR_NOOP("Qt (MS Windows Direct3D)");
-#endif
-		case QPaintEngine::Raster:
-			return QT_TR_NOOP("Qt (Default Raster)");
-	}
-
-	return "Qt";
+	QString appdir = ADM_getInstallRelativePath("share","avidemux","i18n");
+#endif
+
+	loadTranslation(&qtTranslator, appdir + "qt_" + QLocale::system().name());
+	loadTranslation(&avidemuxTranslator, appdir + "avidemux_" + QLocale::system().name());
+	translatorLoaded = true;
+
+	// Re-translate existing map (to take care of global strings already allocated)
+	QMapIterator<QString, char*> mapIterator(*map);
+
+	while (mapIterator.hasNext())
+	{
+		mapIterator.next();
+
+		QByteArray translatedMessage = QApplication::translate("", mapIterator.key().toAscii().constData()).toUtf8();		
+		char *buffer = mapIterator.value();
+		int copyLength = translatedMessage.length() + 1;
+
+		if (copyLength > MAX_UNLOADED_MSG_LENGTH + 1)
+		{
+			copyLength = MAX_UNLOADED_MSG_LENGTH;
+			buffer[MAX_UNLOADED_MSG_LENGTH] = '\0';
+		}
+
+		memcpy(buffer, translatedMessage.constData(), copyLength);
+	}
+
+	printf("[Locale] Test: &Edit -> %s\n\n", HIDE_STRING_FROM_QT("MainWindow", "&Edit").toUtf8().data());
 }
+
+void destroyTranslator(void)
+{
+	if (map)
+	{
+		QMapIterator<QString, char*> mapIterator(*map);
+
+		while (mapIterator.hasNext())
+		{
+			mapIterator.next();
+			delete(mapIterator.value());
+		}
+
+		delete map;
+	}
+}
+
+void getUIDescription(char* desc)
+{
+	sprintf(desc, "Qt (%s)", qVersion());
+}
+ADM_UI_TYPE UI_GetCurrentUI(void)
+{
+  return ADM_UI_QT4;
+}
+
+void getMainWindowHandles(intptr_t *handle, intptr_t *nativeHandle)
+{
+	*handle = (intptr_t)QuiMainWindows;
+
+#if defined(__APPLE__)
+	*nativeHandle = (intptr_t)HIViewGetWindow(HIViewRef(QuiMainWindows->winId()));
+#else
+	*nativeHandle = (intptr_t)QuiMainWindows->winId();
+#endif
+}
+
+extern int paintEngineType;
+
+const char* getNativeRendererDesc(void)
+{
+	switch (paintEngineType)
+	{
+		case QPaintEngine::X11:
+			return QT_TR_NOOP("Qt (X11)");
+		case QPaintEngine::Windows:
+			return QT_TR_NOOP("Qt (MS Windows GDI)");
+		case QPaintEngine::CoreGraphics:
+			return QT_TR_NOOP("Qt (Mac OS X Quartz 2D)");
+		case QPaintEngine::QuickDraw:
+			return QT_TR_NOOP("Qt (Mac OS X QuickDraw)");
+		case QPaintEngine::OpenGL:
+			return QT_TR_NOOP("Qt (OpenGL)");
+#if QT_VERSION >= 0x040400
+		case QPaintEngine::Direct3D:
+			return QT_TR_NOOP("Qt (MS Windows Direct3D)");
+#endif
+		case QPaintEngine::Raster:
+			return QT_TR_NOOP("Qt (Default Raster)");
+	}
+
+	return "Qt";
+}



From mean at mail.berlios.de  Sun May  2 16:32:16 2010
From: mean at mail.berlios.de (mean at BerliOS)
Date: Sun, 2 May 2010 16:32:16 +0200
Subject: [Avidemux-svn-commit] r6149 -
	branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_demuxers/MpegTS
Message-ID: <201005021432.o42EWGn8015026@sheep.berlios.de>

Author: mean
Date: 2010-05-02 16:32:15 +0200 (Sun, 02 May 2010)
New Revision: 6149

Modified:
   branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_demuxers/MpegTS/ADM_tsIndex.cpp
   branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_demuxers/MpegTS/dmxTSPacket.cpp
   branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_demuxers/MpegTS/dmxTSPacket.h
Log:
[TsIndexer] Slightly faster indexing by inlining

Modified: branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_demuxers/MpegTS/ADM_tsIndex.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_demuxers/MpegTS/ADM_tsIndex.cpp	2010-05-02 14:32:13 UTC (rev 6148)
+++ branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_demuxers/MpegTS/ADM_tsIndex.cpp	2010-05-02 14:32:15 UTC (rev 6149)
@@ -532,17 +532,37 @@
     pkt->open(file,append);
     data.pkt=pkt;
     fullSize=pkt->getSize();
+    int startCode;
+#define likely(x) x
+#define unlikely(x) x
       while(1)
       {
-        uint32_t code=0xffff+0xffff0000;
-        while((code&0x00ffffff)!=1 && pkt->stillOk())
+        int last=0xffff,cur=0xffff;
+        
+        while(pkt->stillOk())
         {
-            code=(code<<8)+pkt->readi8();
+            last=cur;
+            cur=pkt->readi16();
+            if(likely(last&0xff)) continue;
+            if(unlikely(!last)) // 00 00 , need 01 xx
+            {
+                if((cur>>8)==1) 
+                {
+                        startCode=cur&0xff;
+                        break;
+                }
+            }
+            if(unlikely(!(last&0xff))) // xx 00 need 00 01
+            {
+                if(cur==1)
+                {
+                        startCode=pkt->readi8();
+                        break;
+                }
+            }
         }
         if(!pkt->stillOk()) break;
-        uint8_t startCode=pkt->readi8();
 
-
           switch(startCode)
                   {
                   case 0xB3: // sequence start

Modified: branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_demuxers/MpegTS/dmxTSPacket.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_demuxers/MpegTS/dmxTSPacket.cpp	2010-05-02 14:32:13 UTC (rev 6148)
+++ branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_demuxers/MpegTS/dmxTSPacket.cpp	2010-05-02 14:32:15 UTC (rev 6149)
@@ -578,6 +578,7 @@
         }
         return true;
 }
+#ifndef TS_PACKET_INLINE
 /**
     \fn readi8
 */
@@ -596,6 +597,7 @@
     return pesPacket->payload[pesPacket->offset++];
     
 }
+
 /**
     \fn readi16
 */
@@ -612,6 +614,7 @@
     }
     return (readi8()<<8)+readi8();
 }
+#endif
 /**
     \fn readi32
 */

Modified: branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_demuxers/MpegTS/dmxTSPacket.h
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_demuxers/MpegTS/dmxTSPacket.h	2010-05-02 14:32:13 UTC (rev 6148)
+++ branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_demuxers/MpegTS/dmxTSPacket.h	2010-05-02 14:32:15 UTC (rev 6149)
@@ -139,7 +139,7 @@
     \class tsPacketLinear
 */
 #define ADM_PACKET_LINEAR 10*1024
-
+#define TS_PACKET_INLINE
 class tsPacketLinear : public tsPacket
 {
 protected:
@@ -156,13 +156,54 @@
                 tsPacketLinear(uint32_t pid);
                 ~tsPacketLinear();
         uint32_t getConsumed(void);
+        bool     stillOk(void) {return !eof;};
+#ifndef TS_PACKET_INLINE
         uint8_t  readi8();
         uint16_t readi16();
+
+#else
+/**
+    \fn readi8
+*/
+uint8_t readi8(void)
+{
+    consumed++;
+    if(pesPacket->offset<pesPacket->payloadSize)
+    {
+        return pesPacket->payload[pesPacket->offset++];
+    }
+    if(false==refill()) 
+    {
+        eof=1;
+        return 0;
+    }
+    return pesPacket->payload[pesPacket->offset++];
+    
+}
+
+/**
+    \fn readi16
+*/
+uint16_t readi16(void)
+{
+    if(pesPacket->offset+1<pesPacket->payloadSize)
+    {
+        uint8_t *r=pesPacket->payload+pesPacket->offset;
+        uint16_t v=(r[0]<<8)+r[1];;
+        
+        pesPacket->offset+=2;
+        consumed+=2;
+        return v;
+    }
+    return (readi8()<<8)+readi8();
+}
+#endif
+
         uint32_t readi32();
         bool     sync(uint8_t *pid);
         bool    read(uint32_t len, uint8_t *buffer);
         bool    forward(uint32_t v);
-        bool    stillOk(void) {return !eof;};
+        
         bool    getInfo(dmxPacketInfo *info);
         bool    seek(uint64_t packetStart, uint32_t offset);
         bool    changePid(uint32_t pid) ;



From mean at mail.berlios.de  Sun May  2 16:32:21 2010
From: mean at mail.berlios.de (mean at BerliOS)
Date: Sun, 2 May 2010 16:32:21 +0200
Subject: [Avidemux-svn-commit] r6150 -
	branches/avidemux_2.6_branch_mean/avidemux/common
Message-ID: <201005021432.o42EWLv3015049@sheep.berlios.de>

Author: mean
Date: 2010-05-02 16:32:20 +0200 (Sun, 02 May 2010)
New Revision: 6150

Modified:
   branches/avidemux_2.6_branch_mean/avidemux/common/gtkgui.h
   branches/avidemux_2.6_branch_mean/avidemux/common/gui_navigate.cpp
   branches/avidemux_2.6_branch_mean/avidemux/common/gui_play.cpp
Log:
[ui] Take into account statTime and moving slider during playback

Modified: branches/avidemux_2.6_branch_mean/avidemux/common/gtkgui.h
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/gtkgui.h	2010-05-02 14:32:15 UTC (rev 6149)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/gtkgui.h	2010-05-02 14:32:20 UTC (rev 6150)
@@ -15,7 +15,7 @@
  *                                                                         *
  ***************************************************************************/
 
-void 			GUI_setCurrentFrameAndTime(void );
+void 			GUI_setCurrentFrameAndTime(uint64_t offset=0);
 void 			GUI_setAllFrameAndTime(void );
 
 

Modified: branches/avidemux_2.6_branch_mean/avidemux/common/gui_navigate.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/gui_navigate.cpp	2010-05-02 14:32:15 UTC (rev 6149)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/gui_navigate.cpp	2010-05-02 14:32:20 UTC (rev 6150)
@@ -431,9 +431,9 @@
     \fn GUI_setCurrentFrameAndTime
     \brief Update some informations : current frame # and current time
 */
-void GUI_setCurrentFrameAndTime(void)
+void GUI_setCurrentFrameAndTime(uint64_t offset)
 {
-    uint64_t pts=admPreview::getCurrentPts();
+    uint64_t pts=admPreview::getCurrentPts()+offset;
     double len;
    
     UI_setCurrentTime(pts);

Modified: branches/avidemux_2.6_branch_mean/avidemux/common/gui_play.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/gui_play.cpp	2010-05-02 14:32:15 UTC (rev 6149)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/gui_play.cpp	2010-05-02 14:32:20 UTC (rev 6150)
@@ -232,7 +232,7 @@
     {
 
         admPreview::displayNow();;
-        GUI_setCurrentFrameAndTime();
+        GUI_setCurrentFrameAndTime(firstPts);
         if(false==videoFilter->getNextFrame(&fn,previewBuffer))
         {
             printf("[Play] Cancelling playback, nextPicture failed\n");



From mean at mail.berlios.de  Sun May  2 16:32:23 2010
From: mean at mail.berlios.de (mean at BerliOS)
Date: Sun, 2 May 2010 16:32:23 +0200
Subject: [Avidemux-svn-commit] r6151 -
	branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_demuxers/MpegTS
Message-ID: <201005021432.o42EWNwr015061@sheep.berlios.de>

Author: mean
Date: 2010-05-02 16:32:23 +0200 (Sun, 02 May 2010)
New Revision: 6151

Modified:
   branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_demuxers/MpegTS/ADM_tsIndex.cpp
   branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_demuxers/MpegTS/dmxTSPacket.cpp
   branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_demuxers/MpegTS/dmxTSPacket.h
Log:
[mpegIndexer] Factorize findStartCode

Modified: branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_demuxers/MpegTS/ADM_tsIndex.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_demuxers/MpegTS/ADM_tsIndex.cpp	2010-05-02 14:32:20 UTC (rev 6150)
+++ branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_demuxers/MpegTS/ADM_tsIndex.cpp	2010-05-02 14:32:23 UTC (rev 6151)
@@ -101,7 +101,7 @@
     markNow
 }markType;
 
-#if 1
+#if 0
 #define aprintf printf
 #else
 #define aprintf(...) {}
@@ -318,14 +318,8 @@
 #define SPS_READ_AHEAD 32
       while(1)
       {
-        uint32_t code=0xffff+0xffff0000;
-        while(((code&0x00ffffff)!=1) && pkt->stillOk())
-        {
-            code=(code<<8)+pkt->readi8();
-        }
-        if(!pkt->stillOk()) break;
-        
-        uint8_t startCode=pkt->readi8(); // Read 5 bytes so far
+        int startCode=pkt->findStartCode();
+
         if(startCode&0x80) continue; // Marker missing
         startCode&=0x1f;
         if(startCode!=NAL_SPS) continue;
@@ -361,9 +355,11 @@
         {
             code=(code<<8)+pkt->readi8();
         }
+        // Cannot use pkt->findStartCode here!
 resume:
         if(!pkt->stillOk()) break;
         uint8_t startCode=pkt->readi8(); // Read 5 bytes so far
+
 //  1:0 2:Nal ref idc 5:Nal Type
         if(startCode&0x80) 
         {
@@ -537,30 +533,7 @@
 #define unlikely(x) x
       while(1)
       {
-        int last=0xffff,cur=0xffff;
-        
-        while(pkt->stillOk())
-        {
-            last=cur;
-            cur=pkt->readi16();
-            if(likely(last&0xff)) continue;
-            if(unlikely(!last)) // 00 00 , need 01 xx
-            {
-                if((cur>>8)==1) 
-                {
-                        startCode=cur&0xff;
-                        break;
-                }
-            }
-            if(unlikely(!(last&0xff))) // xx 00 need 00 01
-            {
-                if(cur==1)
-                {
-                        startCode=pkt->readi8();
-                        break;
-                }
-            }
-        }
+        startCode=pkt->findStartCode();
         if(!pkt->stillOk()) break;
 
           switch(startCode)

Modified: branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_demuxers/MpegTS/dmxTSPacket.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_demuxers/MpegTS/dmxTSPacket.cpp	2010-05-02 14:32:20 UTC (rev 6150)
+++ branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_demuxers/MpegTS/dmxTSPacket.cpp	2010-05-02 14:32:23 UTC (rev 6151)
@@ -787,6 +787,41 @@
     }
 }
 /**
+    \fn findStartCode
+    \brief Must check stillOk after calling this
+*/
+int tsPacketLinearTracker::findStartCode(void)
+{
+#define likely(x) x
+#define unlikely(x) x
+        unsigned int last=0xfffff;
+        unsigned int cur=0xffff;
+        int startCode=0;
+        while(this->stillOk())
+        {
+            last=cur;
+            cur=this->readi16();
+            if(likely(last&0xff)) continue;
+            if(unlikely(!last)) // 00 00 , need 01 xx
+            {
+                if((cur>>8)==1) 
+                {
+                        startCode=cur&0xff;
+                        break;
+                }
+            }
+            if(unlikely(!(last&0xff))) // xx 00 need 00 01
+            {
+                if(cur==1)
+                {
+                        startCode=this->readi8();
+                        break;
+                }
+            }
+        }
+        return startCode;
+}
+/**
     \fn ~tsPacketLinearTracker
 */
 tsPacketLinearTracker::~tsPacketLinearTracker()

Modified: branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_demuxers/MpegTS/dmxTSPacket.h
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_demuxers/MpegTS/dmxTSPacket.h	2010-05-02 14:32:20 UTC (rev 6150)
+++ branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_demuxers/MpegTS/dmxTSPacket.h	2010-05-02 14:32:23 UTC (rev 6151)
@@ -241,5 +241,6 @@
                 ~tsPacketLinearTracker();
         bool    getStats(uint32_t *nb,packetTSStats **stats);
 virtual bool    updateStats(uint8_t *data);
+        int     findStartCode(void);
 };
 #endif



From mean at mail.berlios.de  Sun May  2 16:32:25 2010
From: mean at mail.berlios.de (mean at BerliOS)
Date: Sun, 2 May 2010 16:32:25 +0200
Subject: [Avidemux-svn-commit] r6152 -
	branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_demuxers/MpegTS
Message-ID: <201005021432.o42EWP1r015072@sheep.berlios.de>

Author: mean
Date: 2010-05-02 16:32:25 +0200 (Sun, 02 May 2010)
New Revision: 6152

Modified:
   branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_demuxers/MpegTS/ADM_tsIndex.cpp
Log:
[TsIndexer] progress bar + refresh for both mpeg2 and h264

Modified: branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_demuxers/MpegTS/ADM_tsIndex.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_demuxers/MpegTS/ADM_tsIndex.cpp	2010-05-02 14:32:23 UTC (rev 6151)
+++ branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_demuxers/MpegTS/ADM_tsIndex.cpp	2010-05-02 14:32:25 UTC (rev 6152)
@@ -28,7 +28,7 @@
 #include "ADM_tsPatPmt.h"
 #include "ADM_videoInfoExtractor.h"
 #include "ADM_h264_tag.h"
-
+#include "ADM_clock.h"
 #include "ADM_getbits.h"
 #if 0
 extern "C"
@@ -116,14 +116,16 @@
         uint32_t        currentFrameType;
         uint32_t        beginConsuming;
         indexerState    currentIndexState;
+        uint64_t        fullSize;
+        Clock           ticktock;
 protected:
         FILE                    *index;
         tsPacketLinearTracker   *pkt;
         listOfTsAudioTracks     *audioTracks;
         DIA_workingBase         *ui;
+        void                    updateUI(void);
+        bool                    decodeSEI(uint32_t nalSize, uint8_t *org,uint32_t *recoveryLength);
 
-        bool    decodeSEI(uint32_t nalSize, uint8_t *org,uint32_t *recoveryLength);
-
 public:
                 TsIndexer(listOfTsAudioTracks *tr);
                 ~TsIndexer();
@@ -199,6 +201,7 @@
     audioTracks=NULL;
     ui=createWorking ("Indexing");
     audioTracks=trk;
+    ticktock.reset();
 }
 
 /**
@@ -212,6 +215,20 @@
     ui=NULL;
 }
 /**
+    \fn updateUI
+*/
+void TsIndexer::updateUI(void)
+{
+        if(ticktock.getElapsedMS()<1000) return;
+        ticktock.reset();
+        uint64_t p;
+        p=pkt->getPos();
+        float pos=p;
+        pos=pos/(float)fullSize;
+        pos*=100;
+        ui->update( (uint32_t)pos);
+}
+/**
 
 */
 static uint32_t unescapeH264(uint32_t len,uint8_t *in, uint8_t *out)
@@ -279,7 +296,6 @@
 
 PSVideo video;
 indexerData  data;    
-uint64_t fullSize;
 dmxPacketInfo info;
 TS_PESpacket SEI_nal(0);
 bool result=false;
@@ -349,16 +365,9 @@
     //******************
       while(1)
       {
-
-        uint32_t code=0xffff+0xffff0000;
-        while(((code&0x00ffffff)!=1) && pkt->stillOk())
-        {
-            code=(code<<8)+pkt->readi8();
-        }
-        // Cannot use pkt->findStartCode here!
+        int startCode=pkt->findStartCode();
 resume:
         if(!pkt->stillOk()) break;
-        uint8_t startCode=pkt->readi8(); // Read 5 bytes so far
 
 //  1:0 2:Nal ref idc 5:Nal Type
         if(startCode&0x80) 
@@ -379,14 +388,14 @@
            // aprintf("Still capturing, ignore\n");
             continue;
           }
-                     
+                
           switch(startCode)
                   {
                   case NAL_SEI:
                     {
                         // Load the whole NAL
                             SEI_nal.empty();
-                            code=0xffff+0xffff0000;
+                            uint32_t code=0xffff+0xffff0000;
                             while((code!=1) && pkt->stillOk())
                             {
                                 uint8_t r=pkt->readi8();
@@ -399,7 +408,7 @@
                                 decodeSEI(SEI_nal.payloadSize-4,SEI_nal.payload,&recoveryCount);
                             else printf("[SEI] Too short size+4=%d\n",*(SEI_nal.payload));
                         
-
+                            startCode=pkt->readi8();
                             goto resume;
                     }
                             break;
@@ -458,6 +467,7 @@
                       if(data.state==idx_startAtGopOrSeq) 
                       {
                               currentFrameType=data.frameType;;
+                              updateUI();
                               
                       }else
                       {
@@ -494,7 +504,6 @@
 bool TsIndexer::runMpeg2(const char *file,ADM_TS_TRACK *videoTrac)
 {
 uint32_t temporal_ref,val;
-uint64_t fullSize;
 uint8_t buffer[50*1024];
 bool seq_found=false;
 
@@ -571,12 +580,7 @@
                   case 0xb8: // GOP
                           // Update ui
                             {
-                                uint64_t p;
-                                p=pkt->getPos();
-                                float pos=p;
-                                pos=pos/(float)fullSize;
-                                pos*=100;
-                                ui->update( (uint32_t)pos);
+                               updateUI();
 
                             }
 



From mean at mail.berlios.de  Sun May  2 16:32:27 2010
From: mean at mail.berlios.de (mean at BerliOS)
Date: Sun, 2 May 2010 16:32:27 +0200
Subject: [Avidemux-svn-commit] r6153 -
	branches/avidemux_2.6_branch_mean/cmake
Message-ID: <201005021432.o42EWRej015084@sheep.berlios.de>

Author: mean
Date: 2010-05-02 16:32:26 +0200 (Sun, 02 May 2010)
New Revision: 6153

Modified:
   branches/avidemux_2.6_branch_mean/cmake/vf_plugin_cli.cmake
Log:
[Cli] Fix typo in video plugins cmake script (thx kuh3h3)

Modified: branches/avidemux_2.6_branch_mean/cmake/vf_plugin_cli.cmake
===================================================================
--- branches/avidemux_2.6_branch_mean/cmake/vf_plugin_cli.cmake	2010-05-02 14:32:25 UTC (rev 6152)
+++ branches/avidemux_2.6_branch_mean/cmake/vf_plugin_cli.cmake	2010-05-02 14:32:26 UTC (rev 6153)
@@ -9,7 +9,7 @@
 
         ADD_LIBRARY(${lib} SHARED ${ARGN} ${_srcsGtk})
         INCLUDE_DIRECTORIES(${AVIDEMUX_TOP_SOURCE_DIR}/avidemux/cli/ADM_UIs/include/)
-        TARGET_LINK_LIBRARIES( ${lib} ADM_UIc_Cli6 ADM_render6_cli)
+        TARGET_LINK_LIBRARIES( ${lib} ADM_UI_Cli6 ADM_render6_cli)
 
         IF (GETTEXT_FOUND)
             TARGET_LINK_LIBRARIES(${lib} ${GETTEXT_LIBRARY_DIR})



From mean at mail.berlios.de  Tue May  4 07:36:20 2010
From: mean at mail.berlios.de (mean at BerliOS)
Date: Tue, 4 May 2010 07:36:20 +0200
Subject: [Avidemux-svn-commit] r6154 - in
	branches/avidemux_2.6_branch_mean/avidemux_core:
	ADM_coreImage/include ADM_coreUI/include ADM_coreUI/src
Message-ID: <201005040536.o445aKdU022004@sheep.berlios.de>

Author: mean
Date: 2010-05-04 07:36:20 +0200 (Tue, 04 May 2010)
New Revision: 6154

Modified:
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreImage/include/ADM_image.h
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreUI/include/DIA_factory.h
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreUI/include/DIA_working.h
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreUI/src/DIA_factory.cpp
Log:
[clang] Remove warnings

Modified: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreImage/include/ADM_image.h
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreImage/include/ADM_image.h	2010-05-02 14:32:26 UTC (rev 6153)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreImage/include/ADM_image.h	2010-05-04 05:36:20 UTC (rev 6154)
@@ -88,6 +88,7 @@
                                                 case PLANAR_V:return _width>>1;break;
                                                 default: ADM_assert(0);
                                         }
+                                        return 0;
                                 };
         uint8_t         *GetWritePtr(ADM_PLANE plane)
                         {       
@@ -99,6 +100,7 @@
                                                 case PLANAR_V:return data+((plan*5)>>2);break;
                                                 default: ADM_assert(0);
                                         }
+                                return NULL;
                         };
    
         uint32_t GetHeight(ADM_PLANE plane)
@@ -110,6 +112,7 @@
                                                 case PLANAR_V:return _height>>1;break;
                                                 default: ADM_assert(0);
                                         }
+                                        return 0;
                                 };
         uint8_t duplicateMacro(ADMImage *src,uint32_t swap);       /// copy an image to ourself, including info
 public:

Modified: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreUI/include/DIA_factory.h
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreUI/include/DIA_factory.h	2010-05-02 14:32:26 UTC (rev 6153)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreUI/include/DIA_factory.h	2010-05-04 05:36:20 UTC (rev 6154)
@@ -136,7 +136,7 @@
 public:
 	                diaElemSliderBase() : diaElem(ELEM_SLIDER) {}
   virtual           ~diaElemSliderBase() {};
-  virtual uint8_t   setDigits(uint32_t digits) { this->digits = digits; }
+  virtual uint8_t   setDigits(uint32_t digits) { this->digits = digits; return 1;}
 };
 
 typedef diaElem *CREATE_USLIDER_T(uint32_t *value,const char *toggleTitle, uint32_t min,uint32_t max,uint32_t incr , const char *tip);
@@ -200,7 +200,7 @@
 };
 /*********************************************/
 typedef diaElem *CREATE_TOGGLE_UINT(uint32_t *toggleValue,const char *toggleTitle, uint32_t *uintval, 
-								const char *name,uint32_t min,uint32_t max,const char *tip=NULL);
+								const char *name,uint32_t min,uint32_t max,const char *tip);
 class diaElemToggleUint : public diaElem
 {
   protected:
@@ -220,7 +220,7 @@
   int getRequiredLayout(void);
 };
 typedef diaElem *CREATE_TOGGLE_INT(uint32_t *toggleValue,const char *toggleTitle, int32_t *intval, 
-									const char *name,int32_t min,int32_t max,const char *tip=NULL);
+									const char *name,int32_t min,int32_t max,const char *tip);
 class diaElemToggleInt : public diaElem
 {
   protected:
@@ -601,7 +601,7 @@
   int getRequiredLayout(void);
 };
 /**********************************************/
-typedef diaElem *(CREATE_THREADCOUNT_T)(uint32_t *value, const char *title, const char *tip = NULL);
+typedef diaElem *(CREATE_THREADCOUNT_T)(uint32_t *value, const char *title, const char *tip );
 class diaElemThreadCount : public diaElem
 {
 
@@ -614,7 +614,7 @@
   int getRequiredLayout(void);
 };
 /**********************************************/
-typedef diaElem *(CREATE_ASPECTRATIO_T)(uint32_t *value, const char *title, const char *tip = NULL);
+typedef diaElem *(CREATE_ASPECTRATIO_T)(uint32_t *value, const char *title, const char *tip );
 class diaElemAspectRatio : public diaElem
 {
 public:

Modified: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreUI/include/DIA_working.h
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreUI/include/DIA_working.h	2010-05-02 14:32:26 UTC (rev 6153)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreUI/include/DIA_working.h	2010-05-04 05:36:20 UTC (rev 6154)
@@ -36,9 +36,9 @@
                         DIA_workingBase( const char *title=NULL ) {};
             virtual		~DIA_workingBase(){};
             // If returns 1 -> Means aborted
-            virtual uint8_t  	update(uint32_t percent) {ADM_assert(0);}
-            virtual uint8_t 	update(uint32_t current,uint32_t total){ADM_assert(0);};
-            virtual uint8_t  	isAlive (void ){ADM_assert(0);};
+            virtual uint8_t  	update(uint32_t percent) {ADM_assert(0);return 1;}
+            virtual uint8_t 	update(uint32_t current,uint32_t total){ADM_assert(0);return 1;};
+            virtual uint8_t  	isAlive (void ){ADM_assert(0);return 1;};
             
 };
 /**

Modified: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreUI/src/DIA_factory.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreUI/src/DIA_factory.cpp	2010-05-02 14:32:26 UTC (rev 6153)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreUI/src/DIA_factory.cpp	2010-05-04 05:36:20 UTC (rev 6154)
@@ -259,6 +259,7 @@
 {
 	diaElemMenuBase *cast=(diaElemMenuBase *)internalPointer;
 	cast->link(entry,onoff,w);
+    return 1;
 }
 void      diaElemMenu::updateMe(void)
 {
@@ -293,6 +294,7 @@
 {
 	diaElemMenuDynamicBase *cast=(diaElemMenuDynamicBase *)internalPointer;
 	cast->link(entry,onoff,w);
+    return 1;
 }
 void   diaElemMenuDynamic::finalize(void)
 {
@@ -502,7 +504,8 @@
 uint8_t   diaElemToggle::link(uint32_t onoff,diaElem *w)
 {
 	diaElemToggleBase *cast=(diaElemToggleBase *)internalPointer;
-			cast->link(onoff,w);	
+    cast->link(onoff,w);	
+    return 1;
 }
 DIA_MKSTUBS(diaElemToggle)
 //
@@ -528,7 +531,8 @@
 uint8_t   diaElemUSlider::setDigits(uint32_t digits)
 {
 	diaElemSliderBase *cast=(diaElemSliderBase *)internalPointer;
-			cast->setDigits(digits);	
+    cast->setDigits(digits);	
+    return 1;
 }
 DIA_MKSTUBS(diaElemUSlider)
 // ****************** diaElemSlider ********************
@@ -553,7 +557,8 @@
 uint8_t   diaElemSlider::setDigits(uint32_t digits)
 {
 	diaElemSliderBase *cast=(diaElemSliderBase *)internalPointer;
-			cast->setDigits(digits);	
+    cast->setDigits(digits);	
+    return 1;
 }
 DIA_MKSTUBS(diaElemSlider)
 //



From mean at mail.berlios.de  Tue May  4 07:36:26 2010
From: mean at mail.berlios.de (mean at BerliOS)
Date: Tue, 4 May 2010 07:36:26 +0200
Subject: [Avidemux-svn-commit] r6155 - in branches/avidemux_2.6_branch_mean:
	avidemux/common avidemux/common/ADM_audioFilter/src
	avidemux/common/ADM_commonUI avidemux/common/ADM_editor
	avidemux/common/ADM_render avidemux/common/ADM_script2/src
	avidemux/common/ADM_videoFilter2/src avidemux/qt4/ADM_UIs/src
	avidemux/qt4/ADM_userInterfaces/ADM_dialog
	avidemux/qt4/ADM_userInterfaces/ADM_gui
	avidemux_core/ADM_coreAudioFilter/include
	avidemux_core/ADM_coreVideoFilter/include
Message-ID: <201005040536.o445aQsY022014@sheep.berlios.de>

Author: mean
Date: 2010-05-04 07:36:24 +0200 (Tue, 04 May 2010)
New Revision: 6155

Modified:
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_audioFilter/src/audiofilter_normalize.cpp
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_audioFilter/src/audiofilter_thread.cpp
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_commonUI/DIA_plugins.cpp
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_commonUI/DIA_prefs.cpp
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_editor/ADM_edCache.cpp
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_previewNavigate.cpp
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_render/GUI_render.cpp
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_render/GUI_sdlRender.cpp
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_render/GUI_xvRender.cpp
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src/ADM_jsAudio.cpp
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_videoFilter2/src/ADM_filterThread.cpp
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_videoFilter2/src/ADM_pluginLoad.cpp
   branches/avidemux_2.6_branch_mean/avidemux/common/gui_navigate.cpp
   branches/avidemux_2.6_branch_mean/avidemux/common/gui_play.cpp
   branches/avidemux_2.6_branch_mean/avidemux/qt4/ADM_UIs/src/T_menu.cpp
   branches/avidemux_2.6_branch_mean/avidemux/qt4/ADM_userInterfaces/ADM_dialog/Q_encoding.cpp
   branches/avidemux_2.6_branch_mean/avidemux/qt4/ADM_userInterfaces/ADM_gui/Q_gui2.cpp
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreAudioFilter/include/audiofilter_conf.h
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreVideoFilter/include/DIA_flyDialog.h
Log:
[Clang] Fix warnings

Modified: branches/avidemux_2.6_branch_mean/avidemux/common/ADM_audioFilter/src/audiofilter_normalize.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/ADM_audioFilter/src/audiofilter_normalize.cpp	2010-05-04 05:36:20 UTC (rev 6154)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/ADM_audioFilter/src/audiofilter_normalize.cpp	2010-05-04 05:36:24 UTC (rev 6155)
@@ -83,7 +83,7 @@
 
     uint32_t percent=0;
     uint32_t current=0,llength=0;
-    float max[_wavHeader.channels];
+    float *max=new float[_wavHeader.channels];
     _previous->rewind();
     DolbySkip(1);
     printf("\n Seeking for maximum value, that can take a while\n");
@@ -154,6 +154,7 @@
     _scanned = 1;
     DolbySkip(0);
     _previous->rewind();
+    delete [] max;
     return 1;
 }
 //

Modified: branches/avidemux_2.6_branch_mean/avidemux/common/ADM_audioFilter/src/audiofilter_thread.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/ADM_audioFilter/src/audiofilter_thread.cpp	2010-05-04 05:36:20 UTC (rev 6154)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/ADM_audioFilter/src/audiofilter_thread.cpp	2010-05-04 05:36:24 UTC (rev 6155)
@@ -26,6 +26,7 @@
 {
     ADM_audioAccess_thread *a=(ADM_audioAccess_thread *)x;
     a->run();
+    return NULL;
 }
 
 /**

Modified: branches/avidemux_2.6_branch_mean/avidemux/common/ADM_commonUI/DIA_plugins.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/ADM_commonUI/DIA_plugins.cpp	2010-05-04 05:36:20 UTC (rev 6154)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/ADM_commonUI/DIA_plugins.cpp	2010-05-04 05:36:24 UTC (rev 6155)
@@ -52,7 +52,7 @@
     // Audio Plugins
 
     printf("[Audio Plugins] Found %u plugins\n",aNbPlugin);
-    diaElemReadOnlyText *aText[aNbPlugin];
+    diaElemReadOnlyText **aText=new diaElemReadOnlyText *[aNbPlugin];
     diaElemFrame frameAudio(QT_TR_NOOP("Audio Plugins"));
         
        
@@ -81,7 +81,7 @@
 
     // Encoder
     printf("[VideoEncoder6 Plugins] Found %u plugins\n",ve6NbPlugin);
-    diaElemReadOnlyText *veText[ve6NbPlugin];
+    diaElemReadOnlyText **veText=new diaElemReadOnlyText *[ve6NbPlugin];
     diaElemFrame frameVE(QT_TR_NOOP("Video Encoder Plugins"));
         
        
@@ -110,7 +110,7 @@
 
     // Audio Device
     printf("[AudioDevice Plugins] Found %u plugins\n",avNbPlugin);
-    diaElemReadOnlyText *avText[avNbPlugin];
+    diaElemReadOnlyText **avText=new diaElemReadOnlyText *[avNbPlugin];
     diaElemFrame frameAV(QT_TR_NOOP("Audio Device Plugins"));
     
  for(int i=0;i<avNbPlugin;i++)
@@ -139,7 +139,7 @@
 
   // Audio Encoder
     printf("[AudioEncoder Plugins] Found %u plugins\n",aeNbPlugin);
-    diaElemReadOnlyText *aeText[aeNbPlugin];
+    diaElemReadOnlyText **aeText=new diaElemReadOnlyText*[aeNbPlugin];
     diaElemFrame frameAE(QT_TR_NOOP("Audio Encoder Plugins"));
     
  for(int i=0;i<aeNbPlugin;i++)
@@ -168,7 +168,7 @@
 
  // Demuxer Encoder
     printf("[Demuxers Plugins] Found %u plugins\n",dmNbPlugin);
-    diaElemReadOnlyText *dmText[dmNbPlugin];
+    diaElemReadOnlyText **dmText=new diaElemReadOnlyText*[dmNbPlugin];
     diaElemFrame frameDM(QT_TR_NOOP("Demuxer Plugins"));
     
  for(int i=0;i<dmNbPlugin;i++)
@@ -198,7 +198,7 @@
 
  // muxer Encoder
     printf("[Muxers Plugins] Found %u plugins\n",mxNbPlugin);
-    diaElemReadOnlyText *mxText[mxNbPlugin];
+    diaElemReadOnlyText **mxText=new diaElemReadOnlyText*[mxNbPlugin];
     diaElemFrame frameMX(QT_TR_NOOP("Muxer Plugins"));
     
  for(int i=0;i<mxNbPlugin;i++)
@@ -241,5 +241,11 @@
     for(int i=0;i<mxNbPlugin;i++)
         delete mxText[i];
 
+    delete [] aText;
+    delete [] veText;
+    delete [] avText;
+    delete [] aeText;
+    delete [] dmText;
+    delete [] mxText;
     return 1;
 }

Modified: branches/avidemux_2.6_branch_mean/avidemux/common/ADM_commonUI/DIA_prefs.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/ADM_commonUI/DIA_prefs.cpp	2010-05-04 05:36:20 UTC (rev 6154)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/ADM_commonUI/DIA_prefs.cpp	2010-05-04 05:36:24 UTC (rev 6155)
@@ -271,7 +271,7 @@
 		
 //***AV
         uint32_t nbAudioDevice=ADM_av_getNbDevices();
-        diaMenuEntryDynamic *audioDeviceItems[nbAudioDevice+1];
+        diaMenuEntryDynamic **audioDeviceItems=new diaMenuEntryDynamic *[nbAudioDevice+1];
         audioDeviceItems[0]=new diaMenuEntryDynamic(0,"Dummy","Dummy");
         for(int i=0;i<nbAudioDevice;i++)
         {
@@ -456,7 +456,7 @@
             
             delete audioDeviceItems[i];
         }
-
+        delete [] audioDeviceItems;
 	ADM_dealloc(filterPath);
 	ADM_dealloc(globalGlyphName);
 

Modified: branches/avidemux_2.6_branch_mean/avidemux/common/ADM_editor/ADM_edCache.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/ADM_editor/ADM_edCache.cpp	2010-05-04 05:36:20 UTC (rev 6154)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/ADM_editor/ADM_edCache.cpp	2010-05-04 05:36:24 UTC (rev 6155)
@@ -172,7 +172,7 @@
         cacheElem *e=&(_elem[i]);
         switch(e->pts)
         {
-            case ADM_NO_PTS:  printf("Not used\n",i);break;
+            case ADM_NO_PTS:  printf("Not used %d\n",i);break;
             default:
                 printf("Edcache content[%d]: PTS : %"LLU" us%"LLU" ms\n",i,
                                                                     e->image->Pts,e->image->Pts/1000);

Modified: branches/avidemux_2.6_branch_mean/avidemux/common/ADM_previewNavigate.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/ADM_previewNavigate.cpp	2010-05-04 05:36:20 UTC (rev 6154)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/ADM_previewNavigate.cpp	2010-05-04 05:36:24 UTC (rev 6155)
@@ -55,6 +55,7 @@
 uint64_t admPreview::getCurrentPts(void)
 {
         if(rdrImage) return rdrImage->Pts;
+        return 0LL;
 }
 /**
       \fn admPreview::seekToTime

Modified: branches/avidemux_2.6_branch_mean/avidemux/common/ADM_render/GUI_render.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/ADM_render/GUI_render.cpp	2010-05-04 05:36:20 UTC (rev 6154)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/ADM_render/GUI_render.cpp	2010-05-04 05:36:24 UTC (rev 6155)
@@ -129,11 +129,13 @@
 {
   ADM_assert(!_lock);
   _lock=1; 
+  return 1;
 }
 uint8_t renderUnlock(void)
 {
   ADM_assert(_lock);
   _lock=0; 
+  return 1;
 }
 
 /**
@@ -221,6 +223,7 @@
 uint8_t renderExpose(void)
 {
     renderRefresh();
+    return 1;
 }
 /**
     \fn spawnRenderer

Modified: branches/avidemux_2.6_branch_mean/avidemux/common/ADM_render/GUI_sdlRender.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/ADM_render/GUI_sdlRender.cpp	2010-05-04 05:36:20 UTC (rev 6154)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/ADM_render/GUI_sdlRender.cpp	2010-05-04 05:36:24 UTC (rev 6155)
@@ -83,7 +83,8 @@
         sdl_running=0;
         sdl_overlay=NULL;
         sdl_display=NULL;
-        ADM_info("[SDL] Video subsystem closed and destroyed\n");
+        ADM_info("[SDL] Video subsystem closed and destroyed\n");
+        return true;
 }
 /**
     \fn init

Modified: branches/avidemux_2.6_branch_mean/avidemux/common/ADM_render/GUI_xvRender.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/ADM_render/GUI_xvRender.cpp	2010-05-04 05:36:20 UTC (rev 6154)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/ADM_render/GUI_xvRender.cpp	2010-05-04 05:36:24 UTC (rev 6155)
@@ -411,6 +411,6 @@
 uint8_t GUI_XvRedraw( void )
 {
 	printf("Xv need redraw !\n");
-
+    return true;
 }
 #endif

Modified: branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src/ADM_jsAudio.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src/ADM_jsAudio.cpp	2010-05-04 05:36:20 UTC (rev 6154)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src/ADM_jsAudio.cpp	2010-05-04 05:36:24 UTC (rev 6155)
@@ -88,7 +88,7 @@
 */
 int32_t jsGetResample(void)
 {
-
+    return 0;
 }
 /**
     \fn jsSetResample

Modified: branches/avidemux_2.6_branch_mean/avidemux/common/ADM_videoFilter2/src/ADM_filterThread.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/ADM_videoFilter2/src/ADM_filterThread.cpp	2010-05-04 05:36:20 UTC (rev 6154)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/ADM_videoFilter2/src/ADM_filterThread.cpp	2010-05-04 05:36:24 UTC (rev 6155)
@@ -166,5 +166,6 @@
     }
 theEnd:
         ADM_info("Exiting video thread loop\n");
+        return true;
 }
 //EOF

Modified: branches/avidemux_2.6_branch_mean/avidemux/common/ADM_videoFilter2/src/ADM_pluginLoad.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/ADM_videoFilter2/src/ADM_pluginLoad.cpp	2010-05-04 05:36:20 UTC (rev 6154)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/ADM_videoFilter2/src/ADM_pluginLoad.cpp	2010-05-04 05:36:24 UTC (rev 6155)
@@ -246,6 +246,7 @@
     }
     ADM_error("Cannot get video filter from tag %"LU"\n",tag);
     ADM_assert(0);
+    return NULL;
 }
 /**
     \fn ADM_vf_getPluginFromTag
@@ -266,6 +267,7 @@
     }
     ADM_error("Cannot get video filter from name %s\n",name);
     ADM_assert(0);
+    return NULL;
 }
 /**
     \fn ADM_VideoFilters

Modified: branches/avidemux_2.6_branch_mean/avidemux/common/gui_navigate.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/gui_navigate.cpp	2010-05-04 05:36:20 UTC (rev 6154)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/gui_navigate.cpp	2010-05-04 05:36:24 UTC (rev 6155)
@@ -316,8 +316,8 @@
 
 uint8_t A_rebuildKeyFrame(void)
 {
-
 //    return video_body->rebuildFrameType();
+    return 1;
 }
 /**
     \fn GUI_PrevFrame

Modified: branches/avidemux_2.6_branch_mean/avidemux/common/gui_play.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/gui_play.cpp	2010-05-04 05:36:20 UTC (rev 6154)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/gui_play.cpp	2010-05-04 05:36:24 UTC (rev 6155)
@@ -424,6 +424,6 @@
         UI_setVUMeter(stat);
         vuMeterPts=time;
     }
-
+    return true;
 }
 // EOF

Modified: branches/avidemux_2.6_branch_mean/avidemux/qt4/ADM_UIs/src/T_menu.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/qt4/ADM_UIs/src/T_menu.cpp	2010-05-04 05:36:20 UTC (rev 6154)
+++ branches/avidemux_2.6_branch_mean/avidemux/qt4/ADM_UIs/src/T_menu.cpp	2010-05-04 05:36:24 UTC (rev 6155)
@@ -109,6 +109,7 @@
             return dyna->link(menus[i],onoff,w);
     }
     ADM_assert(0);
+    return 1;
 }
 void   diaElemMenu::enable(uint32_t onoff)
 {

Modified: branches/avidemux_2.6_branch_mean/avidemux/qt4/ADM_userInterfaces/ADM_dialog/Q_encoding.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/qt4/ADM_userInterfaces/ADM_dialog/Q_encoding.cpp	2010-05-04 05:36:20 UTC (rev 6154)
+++ branches/avidemux_2.6_branch_mean/avidemux/qt4/ADM_userInterfaces/ADM_dialog/Q_encoding.cpp	2010-05-04 05:36:24 UTC (rev 6155)
@@ -224,7 +224,7 @@
 void DIA_encodingQt4::setBitrate(uint32_t br,uint32_t globalbr)
 {
           ADM_assert(window);
-          snprintf(string,79,"%"LU" kB/s",br,globalbr);
+          snprintf(string,79,"%"LU" kB/s",br);
           WRITE(labelVidBitrate);
 
 }

Modified: branches/avidemux_2.6_branch_mean/avidemux/qt4/ADM_userInterfaces/ADM_gui/Q_gui2.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/qt4/ADM_userInterfaces/ADM_gui/Q_gui2.cpp	2010-05-04 05:36:20 UTC (rev 6154)
+++ branches/avidemux_2.6_branch_mean/avidemux/qt4/ADM_userInterfaces/ADM_gui/Q_gui2.cpp	2010-05-04 05:36:24 UTC (rev 6155)
@@ -413,6 +413,9 @@
 				if (!UI_readCurTime(hh, mm, ss, ms))
 					UI_updateTimeCount(currentFrame, currentFps);
 			}
+            break;
+        default:
+            break;
 	}
 
 	return QObject::eventFilter(watched, event);
@@ -649,7 +652,7 @@
 	destroyTranslator();
     delete myApplication;
     myApplication=NULL;
-    
+    return 1;
 }
 /**
     \fn searchTranslationTable(const char *name))
@@ -1013,6 +1016,7 @@
 uint8_t 	UI_SetCurrentFormat( uint32_t fmt )
 {
 	WIDGET(comboBoxFormat)->setCurrentIndex((int)fmt);
+    return 1;
 }
 
 /**

Modified: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreAudioFilter/include/audiofilter_conf.h
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreAudioFilter/include/audiofilter_conf.h	2010-05-04 05:36:20 UTC (rev 6154)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreAudioFilter/include/audiofilter_conf.h	2010-05-04 05:36:24 UTC (rev 6155)
@@ -41,6 +41,7 @@
                         resamplerEnabled=false;
                         resamplerFrequency=44100;
                         film2pal    =FILMCONV_NONE;
+                        return true;
                 }
 
     uint64_t     startTimeInUs;

Modified: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreVideoFilter/include/DIA_flyDialog.h
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreVideoFilter/include/DIA_flyDialog.h	2010-05-04 05:36:20 UTC (rev 6154)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreVideoFilter/include/DIA_flyDialog.h	2010-05-04 05:36:24 UTC (rev 6155)
@@ -110,7 +110,7 @@
           
           
   
-  virtual uint8_t  update(void) {};
+  virtual uint8_t  update(void) {return 1;};
             uint8_t  cleanup(void);
   
 



From mean at mail.berlios.de  Tue May  4 07:36:29 2010
From: mean at mail.berlios.de (mean at BerliOS)
Date: Tue, 4 May 2010 07:36:29 +0200
Subject: [Avidemux-svn-commit] r6156 - in branches/avidemux_2.6_branch_mean:
	avidemux/common/ADM_audiocodec avidemux_core/ADM_coreDemuxer/include
	avidemux_plugins/ADM_audioDecoders/ADM_ad_faad
	avidemux_plugins/ADM_audioDecoders/ADM_ad_mad/ADM_libMad
	avidemux_plugins/ADM_demuxers/Flv avidemux_plugins/ADM_demuxers/Mp4
	avidemux_plugins/ADM_videoEncoder/x264
Message-ID: <201005040536.o445aTeH022024@sheep.berlios.de>

Author: mean
Date: 2010-05-04 07:36:29 +0200 (Tue, 04 May 2010)
New Revision: 6156

Modified:
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_audiocodec/ADM_ad_plugin.h
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreDemuxer/include/ADM_demuxerInternal.h
   branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_audioDecoders/ADM_ad_faad/ADM_ad_faad.cpp
   branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_audioDecoders/ADM_ad_mad/ADM_libMad/timer.c
   branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_demuxers/Flv/ADM_flv.cpp
   branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_demuxers/Mp4/ADM_mp4Analyzer.cpp
   branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_demuxers/Mp4/ADM_mp4Indexer.cpp
   branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_videoEncoder/x264/ADM_x264.cpp
Log:
[clang] Warning fix (plugins)

Modified: branches/avidemux_2.6_branch_mean/avidemux/common/ADM_audiocodec/ADM_ad_plugin.h
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/ADM_audiocodec/ADM_ad_plugin.h	2010-05-04 05:36:24 UTC (rev 6155)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/ADM_audiocodec/ADM_ad_plugin.h	2010-05-04 05:36:29 UTC (rev 6156)
@@ -44,6 +44,7 @@
 	{ \
 		Class *a=(Class *)codec;\
 		delete a;\
+        return NULL;\
 	}\
 	int supportedFormat(uint32_t audioFourcc) \
 	{ \

Modified: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreDemuxer/include/ADM_demuxerInternal.h
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreDemuxer/include/ADM_demuxerInternal.h	2010-05-04 05:36:24 UTC (rev 6155)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreDemuxer/include/ADM_demuxerInternal.h	2010-05-04 05:36:29 UTC (rev 6156)
@@ -66,7 +66,7 @@
 extern "C" {\
 vidHeader   *create(void){ return new Class; } \
 void         destroy(vidHeader *h){ Class *z=(Class *)h;delete z;} \
-uint8_t      getVersion(uint32_t *major,uint32_t *minor,uint32_t *patch) {*major=maj;*minor=mn;*patch=pat;} \
+uint8_t      getVersion(uint32_t *major,uint32_t *minor,uint32_t *patch) {*major=maj;*minor=mn;*patch=pat;return 1;} \
 uint32_t     getApiVersion(void) {return ADM_DEMUXER_API_VERSION;} \
 const char  *getName(void) {return name;} \
 const char  *getDescriptor(void) {return desc;} \

Modified: branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_audioDecoders/ADM_ad_faad/ADM_ad_faad.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_audioDecoders/ADM_ad_faad/ADM_ad_faad.cpp	2010-05-04 05:36:24 UTC (rev 6155)
+++ branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_audioDecoders/ADM_ad_faad/ADM_ad_faad.cpp	2010-05-04 05:36:29 UTC (rev 6156)
@@ -79,10 +79,10 @@
 		{
 			_inited = 1;
 			faacDecInit2(_instance, d,l, &srate,&chan);
-			printf("[FAAD]Found :%"LU" rate %"LU" channels\n",srate,chan);
+			printf("[FAAD]Found :%"LU" rate %"LU" channels\n",(uint32_t)srate,(uint32_t)chan);
                         if(srate!=info->frequency)
                         {
-                            printf("[FAAD]Frequency mismatch!!! %d to %"LU" (SBR ?)\n",info->frequency,srate);
+                            printf("[FAAD]Frequency mismatch!!! %d to %"LU" (SBR ?)\n",info->frequency,(uint32_t)srate);
                             info->frequency=srate;
                         }
                         if(chan!=info->channels) // Ask for stereo !
@@ -137,11 +137,13 @@
 uint8_t ADM_faad:: beginDecompress( void )
 {
 	_inbuffer=0;
+    return 1;
 }
 uint8_t ADM_faad::endDecompress( void )
 {
 	_inbuffer=0;
 	 faacDecPostSeekReset(_instance, 0);
+     return 1;
 }
 uint8_t ADM_faad::run(uint8_t *inptr, uint32_t nbIn, float *outptr, uint32_t *nbOut)
 {
@@ -165,7 +167,7 @@
 		{
 			// Try
 			printf("Trying with %d bytes\n",nbIn);
-			res=faacDecInit(_instance,inptr,nbIn,&srate,&chan);
+			res=(long int)faacDecInit(_instance,inptr,nbIn,&srate,&chan);
 			if(res>=0)
 			{
 				printf("Faad Inited : rate:%"LU" chan:%"LU" off:%ld\n",srate,chan,res);

Modified: branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_audioDecoders/ADM_ad_mad/ADM_libMad/timer.c
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_audioDecoders/ADM_ad_mad/ADM_libMad/timer.c	2010-05-04 05:36:24 UTC (rev 6155)
+++ branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_audioDecoders/ADM_ad_mad/ADM_libMad/timer.c	2010-05-04 05:36:29 UTC (rev 6156)
@@ -32,7 +32,7 @@
 # endif
 
 # include "timer.h"
-
+#include <stdlib.h> // MEANX
 mad_timer_t const mad_timer_zero = { 0, 0 };
 
 /*

Modified: branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_demuxers/Flv/ADM_flv.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_demuxers/Flv/ADM_flv.cpp	2010-05-04 05:36:24 UTC (rev 6155)
+++ branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_demuxers/Flv/ADM_flv.cpp	2010-05-04 05:36:29 UTC (rev 6156)
@@ -515,7 +515,7 @@
   
       uint32_t pos=ftello(_fd);
       uint32_t len=*remaining,width,height;
-      uint8_t buffer[len];
+      uint8_t *buffer=new uint8_t[len];
       read(len,buffer);
       fseeko(_fd,pos,SEEK_SET);
        /* Decode header, from h263dec.c / lavcodec*/
@@ -524,6 +524,7 @@
          _video_bih.biHeight=_mainaviheader.dwHeight=height;
          _video_bih.biWidth=_mainaviheader.dwWidth=width;
       }
+      delete [] buffer;
     }
    return 1;
 }

Modified: branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_demuxers/Mp4/ADM_mp4Analyzer.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_demuxers/Mp4/ADM_mp4Analyzer.cpp	2010-05-04 05:36:24 UTC (rev 6155)
+++ branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_demuxers/Mp4/ADM_mp4Analyzer.cpp	2010-05-04 05:36:29 UTC (rev 6156)
@@ -1,5 +1,4 @@
 /***************************************************************************
-/*
 
     copyright            : (C) 2007 by mean
     email                : fixounet at free.fr
@@ -276,10 +275,11 @@
                         son.read32();
                         son.read32();
                         s=son.read();
-                        char str[s+1];
+                        char *str=new char[s+1];
                         son.readPayload((uint8_t *)str,s);
                         str[s]=0;
                         printf("Url : <%s>\n",str);
+                        delete [] str;
                       }
                       break;
 

Modified: branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_demuxers/Mp4/ADM_mp4Indexer.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_demuxers/Mp4/ADM_mp4Indexer.cpp	2010-05-04 05:36:24 UTC (rev 6155)
+++ branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_demuxers/Mp4/ADM_mp4Indexer.cpp	2010-05-04 05:36:29 UTC (rev 6156)
@@ -1,5 +1,4 @@
 /***************************************************************************
-/*
     
     copyright            : (C) 2007 by mean
     email                : fixounet at free.fr

Modified: branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_videoEncoder/x264/ADM_x264.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_videoEncoder/x264/ADM_x264.cpp	2010-05-04 05:36:24 UTC (rev 6155)
+++ branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_videoEncoder/x264/ADM_x264.cpp	2010-05-04 05:36:29 UTC (rev 6156)
@@ -275,7 +275,7 @@
               // Put our SEI front...
               // first a temp location...
               firstIdr=false;
-              uint8_t tmpBuffer[size];
+              uint8_t *tmpBuffer=new uint8_t[size];
               memcpy(tmpBuffer,out->data,size);
               uint8_t *dout=out->data;
               // Put back out SEI and add Size
@@ -287,6 +287,7 @@
               memcpy(dout+4+seiUserDataLen,tmpBuffer,size);
               size+=4+seiUserDataLen;
               out->len = size; // update total size
+              delete [] tmpBuffer;
           }
           break;
         case X264_TYPE_I:



From mean at mail.berlios.de  Tue May  4 07:36:34 2010
From: mean at mail.berlios.de (mean at BerliOS)
Date: Tue, 4 May 2010 07:36:34 +0200
Subject: [Avidemux-svn-commit] r6157 - in branches/avidemux_2.6_branch_mean:
	avidemux/common/ADM_audioFilter/src
	avidemux/common/ADM_audiocodec avidemux/common/ADM_editor
	avidemux/common/ADM_script2/include
	avidemux/common/ADM_script2/src avidemux/qt4/ADM_UIs/src
	avidemux_plugins/ADM_demuxers/Matroska
	avidemux_plugins/ADM_demuxers/Mp4
	avidemux_plugins/ADM_demuxers/MpegPS
	avidemux_plugins/ADM_demuxers/MpegTS
	avidemux_plugins/ADM_demuxers/OpenDml
Message-ID: <201005040536.o445aYP7022034@sheep.berlios.de>

Author: mean
Date: 2010-05-04 07:36:32 +0200 (Tue, 04 May 2010)
New Revision: 6157

Modified:
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_audioFilter/src/audiofilter_mixer.cpp
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_audiocodec/ADM_pluginLoad.cpp
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_editor/ADM_edit.cpp
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/include/ADM_jsDebug.h
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/include/ADM_jsTestFactory.h
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src/ADM_jsIf_js.c
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src/ADM_jsIf_js.idl
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src/ADM_jsTestFactory_js.c
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src/ADM_jsTestFactory_js.idl
   branches/avidemux_2.6_branch_mean/avidemux/qt4/ADM_UIs/src/toolkit.cpp
   branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_demuxers/Matroska/ADM_mkv.cpp
   branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_demuxers/Matroska/ADM_mkvEntries.cpp
   branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_demuxers/Matroska/ADM_mkvIndexer.cpp
   branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_demuxers/Mp4/ADM_mp4Indexer.cpp
   branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_demuxers/MpegPS/ADM_ps.cpp
   branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_demuxers/MpegPS/ADM_psIndex.cpp
   branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_demuxers/MpegPS/ADM_psPlugin.cpp
   branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_demuxers/MpegPS/ADM_psReadIndex.cpp
   branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_demuxers/MpegTS/ADM_ts.cpp
   branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_demuxers/MpegTS/ADM_tsPlugin.cpp
   branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_demuxers/OpenDml/ADM_odml_odml.cpp
Log:
[clang] Remove more warnings

Modified: branches/avidemux_2.6_branch_mean/avidemux/common/ADM_audioFilter/src/audiofilter_mixer.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/ADM_audioFilter/src/audiofilter_mixer.cpp	2010-05-04 05:36:29 UTC (rev 6156)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/ADM_audioFilter/src/audiofilter_mixer.cpp	2010-05-04 05:36:32 UTC (rev 6157)
@@ -93,6 +93,8 @@
 			outputChannelMapping[1] = ADM_CH_FRONT_RIGHT;
 //			DolbyInit();
 		break;
+        default:
+                break;
 	}
 
     d*=_wavHeader.channels;
@@ -163,6 +165,8 @@
 				case ADM_CH_SIDE_RIGHT:
 					out[1]  += *in;
 				break;
+                default:
+                    break;
 			}
 			in++;
 		}
@@ -208,6 +212,8 @@
 					out[1]  += *in * 0.707;
 					out[2]  += *in * 0.707;
 				break;
+                default:
+                    break;
 			}
 			in++;
 		}
@@ -244,6 +250,8 @@
 					out[1]  += *in * 0.595;
 					out[2]  += *in * 0.595;
 				break;
+                default:
+                    break;
 			}
 			in++;
 		}
@@ -289,6 +297,8 @@
 					out[1]  += *in * 0.707;
 					out[2]  += *in * 0.707;
 				break;
+                default:
+                    break;
 			}
 			in++;
 		}
@@ -340,6 +350,8 @@
 					out[1]  += *in * 0.707;
 					out[3]  += *in * 0.707;
 				break;
+                default:
+                    break;
 			}
 			in++;
 		}
@@ -391,6 +403,8 @@
 					out[1]  += *in * 0.707;
 					out[3]  += *in * 0.707;
 				break;
+                default:
+                    break;
 			}
 			in++;
 		}
@@ -438,6 +452,8 @@
 					out[1]  += *in * 0.707;
 					out[3]  += *in * 0.707;
 				break;
+                default:
+                    break;
 			}
 			in++;
 		}
@@ -482,6 +498,8 @@
 					out[0]  += DolbyShiftLeft(*in) * 0.707 * 0.707;
 					out[1]  += DolbyShiftRight(*in) * 0.707 * 0.707;
 				break;
+                default:
+                    break;
 			}
 			in++;
 		}
@@ -532,6 +550,8 @@
 					out[0]  += DolbyShiftLeft(*in) * 0.5774 * 0.707;
 					out[1]  += DolbyShiftRight(*in) * 0.8165 * 0.707;
 				break;
+                default:
+                    break;
 			}
 			in++;
 		}

Modified: branches/avidemux_2.6_branch_mean/avidemux/common/ADM_audiocodec/ADM_pluginLoad.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/ADM_audiocodec/ADM_pluginLoad.cpp	2010-05-04 05:36:29 UTC (rev 6156)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/ADM_audiocodec/ADM_pluginLoad.cpp	2010-05-04 05:36:32 UTC (rev 6157)
@@ -196,5 +196,6 @@
         ADM_audioPlugins[i]=NULL;
     }
     ADM_audioPlugins.clear();
+    return true;
 }   
 //EOF

Modified: branches/avidemux_2.6_branch_mean/avidemux/common/ADM_editor/ADM_edit.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/ADM_editor/ADM_edit.cpp	2010-05-04 05:36:29 UTC (rev 6156)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/ADM_editor/ADM_edit.cpp	2010-05-04 05:36:32 UTC (rev 6157)
@@ -183,7 +183,6 @@
      snprintf(str,512,QT_TR_NOOP("Attempt to open %s failed!"), name);
       str[512] = '\0';
       GUI_Error_HIG(str,NULL);
-      video._aviheader;
       video._aviheader=NULL;
       return false;
    }

Modified: branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/include/ADM_jsDebug.h
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/include/ADM_jsDebug.h	2010-05-04 05:36:29 UTC (rev 6156)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/include/ADM_jsDebug.h	2010-05-04 05:36:32 UTC (rev 6157)
@@ -16,14 +16,17 @@
 
 #ifndef ADMJS_DEBUG_H
 #define ADMJS_DEBUG_H
+#ifdef __cplusplus
 extern "C"
 {
+#endif
 void jsPopupError(const char *s);
 void jsPopupInfo(const char *s);
 void jsPrint(const char *s);
 void jsPrint2(const char *s);
 void jsHelp(const char *s);
+#ifdef __cplusplus
 };
+#endif
 
-
 #endif
\ No newline at end of file

Modified: branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/include/ADM_jsTestFactory.h
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/include/ADM_jsTestFactory.h	2010-05-04 05:36:29 UTC (rev 6156)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/include/ADM_jsTestFactory.h	2010-05-04 05:36:32 UTC (rev 6157)
@@ -16,8 +16,10 @@
 
 #ifndef ADMJS_FACTORY_H
 #define ADMJS_FACTORY_H
+#ifdef __cplusplus
 extern "C"
 {
+#endif
 int jsTestCrash(void);
 int jsTestAssert(void);
 int jsTestFacNotch(void);
@@ -40,7 +42,9 @@
 int jsTestFacFloat(void);
 int jsTestFacInt(void);
 int jsTestFacEncoding(void);
+#ifdef __cplusplus
 };
+#endif
 
 
 #endif

Modified: branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src/ADM_jsIf_js.c
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src/ADM_jsIf_js.c	2010-05-04 05:36:29 UTC (rev 6156)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src/ADM_jsIf_js.c	2010-05-04 05:36:32 UTC (rev 6157)
@@ -12,8 +12,20 @@
 please refer to the software package which it is part of.
 
 */
+
+#include "stdio.h"
+#include "ADM_jsAvidemux.h"
+#include "ADM_jsDebug.h"
+
+#ifdef HAVE_ALLOCA_H
+#include <alloca.h>
+static size_t jj_alloca_limit = 0;
+#endif
+#include <stdlib.h>
 #include <string.h>
 #include <wchar.h>
+#ifdef HAVE_ALLOCA_H
+#endif
 #include <jsapi.h>
 #ifndef JS_THREADSAFE
 #if JS_VERSION <= 170
@@ -30,34 +42,35 @@
 #ifndef JS_FS_END
 #define JS_FS_END {NULL, NULL, 0, 0, 0}
 #endif
+
 static JSBool
 jjadmPopupError(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval)
 {
-    JSObject *var2;
-    char *var7;
+    JSObject * var2;
     int var6;
+    char * var7;
     int var8;
     jsval var9;
-    JSString *var10;
-    jsval var81;
+    JSString * var10;
+    jsval var86;
     size_t var11;
     size_t var12;
     int var14;
-    jschar *var13;
-    jsval var82;
+    jschar * var15;
+    jsval var87;
     JSBool var1;
     var2 = NULL;
+    var6 = 0;
     var7 = NULL;
-    var6 = 0;
     var8 = 0;
     var9 = JSVAL_NULL;
     var10 = NULL;
-    var81 = JSVAL_NULL;
+    var86 = JSVAL_NULL;
     var11 = 0;
     var12 = 0;
     var14 = 0;
-    var13 = NULL;
-    var82 = JSVAL_NULL;
+    var15 = NULL;
+    var87 = JSVAL_NULL;
     var1 = JS_FALSE;
     var2 = obj;
     var6 = argc;
@@ -69,23 +82,32 @@
     if (!var10) {
         goto do_return;
     }
-    var81 = STRING_TO_JSVAL(var10);
-    argv[argc+0] = var81;
+    var86 = STRING_TO_JSVAL(var10);
+    argv[argc+0] = var86;
     var11 = JS_GetStringLength(var10);
     var12 = 1;
     var12 += var11;
-    var7 = JS_malloc(cx, var12);
-    if (!var7) {
-        goto do_return;
+#ifdef HAVE_ALLOCA
+    if (var12 < jj_alloca_limit) {
+        var7 = alloca(var12);
+    } else {
+#endif
+        var7 = malloc(var12);
+        if (!var7) {
+            goto do_return;
+        } else {
+            var14 = 1;
+        }
+#ifdef HAVE_ALLOCA
     }
-    var14 = 1;
-    var13 = JS_GetStringChars(var10);
-    var82 = STRING_TO_JSVAL(var10);
-    argv[argc+1] = var82;
+#endif
+    var15 = JS_GetStringChars(var10);
+    var87 = STRING_TO_JSVAL(var10);
+    argv[argc+1] = var87;
     {
         size_t i;
         for (i = 0; i < var11; ++i) {
-            var7[i] = wctob(var13[i]);
+            var7[i] = wctob(var15[i]);
         }
         var7[var11] = '\0';
     }
@@ -94,7 +116,7 @@
     var1 = JS_TRUE;
     do_return:
     if (var14) {
-        JS_free(cx, var7);
+        free(var7);
         var7 = NULL;
         var14 = 0;
     }
@@ -103,315 +125,351 @@
 static JSBool
 jjadmpPopupInfo(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval)
 {
-    JSObject *var16;
-    char *var21;
-    int var20;
-    int var22;
-    jsval var23;
-    JSString *var24;
-    jsval var83;
-    size_t var25;
+    JSObject * var17;
+    int var21;
+    char * var22;
+    int var23;
+    jsval var24;
+    JSString * var25;
+    jsval var88;
     size_t var26;
-    int var28;
-    jschar *var27;
-    jsval var84;
-    JSBool var15;
-    var16 = NULL;
-    var21 = NULL;
-    var20 = 0;
-    var22 = 0;
-    var23 = JSVAL_NULL;
-    var24 = NULL;
-    var83 = JSVAL_NULL;
-    var25 = 0;
+    size_t var27;
+    int var29;
+    jschar * var30;
+    jsval var89;
+    JSBool var16;
+    var17 = NULL;
+    var21 = 0;
+    var22 = NULL;
+    var23 = 0;
+    var24 = JSVAL_NULL;
+    var25 = NULL;
+    var88 = JSVAL_NULL;
     var26 = 0;
-    var28 = 0;
-    var27 = NULL;
-    var84 = JSVAL_NULL;
-    var15 = JS_FALSE;
-    var16 = obj;
-    var20 = argc;
-    var22 = 0;
-    var22 = var22 < var20;
-    if (var22) {
-    var23 = argv[0];
-    var24 = JS_ValueToString(cx, var23);
-    if (!var24) {
+    var27 = 0;
+    var29 = 0;
+    var30 = NULL;
+    var89 = JSVAL_NULL;
+    var16 = JS_FALSE;
+    var17 = obj;
+    var21 = argc;
+    var23 = 0;
+    var23 = var23 < var21;
+    if (var23) {
+    var24 = argv[0];
+    var25 = JS_ValueToString(cx, var24);
+    if (!var25) {
         goto do_return;
     }
-    var83 = STRING_TO_JSVAL(var24);
-    argv[argc+0] = var83;
-    var25 = JS_GetStringLength(var24);
-    var26 = 1;
-    var26 += var25;
-    var21 = JS_malloc(cx, var26);
-    if (!var21) {
-        goto do_return;
+    var88 = STRING_TO_JSVAL(var25);
+    argv[argc+0] = var88;
+    var26 = JS_GetStringLength(var25);
+    var27 = 1;
+    var27 += var26;
+#ifdef HAVE_ALLOCA
+    if (var27 < jj_alloca_limit) {
+        var22 = alloca(var27);
+    } else {
+#endif
+        var22 = malloc(var27);
+        if (!var22) {
+            goto do_return;
+        } else {
+            var29 = 1;
+        }
+#ifdef HAVE_ALLOCA
     }
-    var28 = 1;
-    var27 = JS_GetStringChars(var24);
-    var84 = STRING_TO_JSVAL(var24);
-    argv[argc+1] = var84;
+#endif
+    var30 = JS_GetStringChars(var25);
+    var89 = STRING_TO_JSVAL(var25);
+    argv[argc+1] = var89;
     {
         size_t i;
-        for (i = 0; i < var25; ++i) {
-            var21[i] = wctob(var27[i]);
+        for (i = 0; i < var26; ++i) {
+            var22[i] = wctob(var30[i]);
         }
-        var21[var25] = '\0';
+        var22[var26] = '\0';
     }
     }
-    jsPopupInfo(var21);
-    var15 = JS_TRUE;
+    jsPopupInfo(var22);
+    var16 = JS_TRUE;
     do_return:
-    if (var28) {
-        JS_free(cx, var21);
-        var21 = NULL;
-        var28 = 0;
+    if (var29) {
+        free(var22);
+        var22 = NULL;
+        var29 = 0;
     }
-    return var15;
+    return var16;
 }
 static JSBool
 jjadmPrint(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval)
 {
-    JSObject *var30;
-    char *var35;
-    int var34;
+    JSObject * var32;
     int var36;
-    jsval var37;
-    JSString *var38;
-    jsval var85;
-    size_t var39;
-    size_t var40;
-    int var42;
-    jschar *var41;
-    jsval var86;
-    JSBool var29;
-    var30 = NULL;
-    var35 = NULL;
-    var34 = 0;
+    char * var37;
+    int var38;
+    jsval var39;
+    JSString * var40;
+    jsval var90;
+    size_t var41;
+    size_t var42;
+    int var44;
+    jschar * var45;
+    jsval var91;
+    JSBool var31;
+    var32 = NULL;
     var36 = 0;
-    var37 = JSVAL_NULL;
-    var38 = NULL;
-    var85 = JSVAL_NULL;
-    var39 = 0;
-    var40 = 0;
+    var37 = NULL;
+    var38 = 0;
+    var39 = JSVAL_NULL;
+    var40 = NULL;
+    var90 = JSVAL_NULL;
+    var41 = 0;
     var42 = 0;
-    var41 = NULL;
-    var86 = JSVAL_NULL;
-    var29 = JS_FALSE;
-    var30 = obj;
-    var34 = argc;
-    var36 = 0;
-    var36 = var36 < var34;
-    if (var36) {
-    var37 = argv[0];
-    var38 = JS_ValueToString(cx, var37);
-    if (!var38) {
+    var44 = 0;
+    var45 = NULL;
+    var91 = JSVAL_NULL;
+    var31 = JS_FALSE;
+    var32 = obj;
+    var36 = argc;
+    var38 = 0;
+    var38 = var38 < var36;
+    if (var38) {
+    var39 = argv[0];
+    var40 = JS_ValueToString(cx, var39);
+    if (!var40) {
         goto do_return;
     }
-    var85 = STRING_TO_JSVAL(var38);
-    argv[argc+0] = var85;
-    var39 = JS_GetStringLength(var38);
-    var40 = 1;
-    var40 += var39;
-    var35 = JS_malloc(cx, var40);
-    if (!var35) {
-        goto do_return;
+    var90 = STRING_TO_JSVAL(var40);
+    argv[argc+0] = var90;
+    var41 = JS_GetStringLength(var40);
+    var42 = 1;
+    var42 += var41;
+#ifdef HAVE_ALLOCA
+    if (var42 < jj_alloca_limit) {
+        var37 = alloca(var42);
+    } else {
+#endif
+        var37 = malloc(var42);
+        if (!var37) {
+            goto do_return;
+        } else {
+            var44 = 1;
+        }
+#ifdef HAVE_ALLOCA
     }
-    var42 = 1;
-    var41 = JS_GetStringChars(var38);
-    var86 = STRING_TO_JSVAL(var38);
-    argv[argc+1] = var86;
+#endif
+    var45 = JS_GetStringChars(var40);
+    var91 = STRING_TO_JSVAL(var40);
+    argv[argc+1] = var91;
     {
         size_t i;
-        for (i = 0; i < var39; ++i) {
-            var35[i] = wctob(var41[i]);
+        for (i = 0; i < var41; ++i) {
+            var37[i] = wctob(var45[i]);
         }
-        var35[var39] = '\0';
+        var37[var41] = '\0';
     }
     }
-    jsPrint(var35);
-    var29 = JS_TRUE;
+    jsPrint(var37);
+    var31 = JS_TRUE;
     do_return:
-    if (var42) {
-        JS_free(cx, var35);
-        var35 = NULL;
-        var42 = 0;
+    if (var44) {
+        free(var37);
+        var37 = NULL;
+        var44 = 0;
     }
-    return var29;
+    return var31;
 }
 static JSBool
 jjprint(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval)
 {
-    JSObject *var44;
-    char *var49;
-    int var48;
-    int var50;
-    jsval var51;
-    JSString *var52;
-    jsval var87;
-    size_t var53;
-    size_t var54;
-    int var56;
-    jschar *var55;
-    jsval var88;
-    JSBool var43;
-    var44 = NULL;
-    var49 = NULL;
-    var48 = 0;
-    var50 = 0;
-    var51 = JSVAL_NULL;
+    JSObject * var47;
+    int var51;
+    char * var52;
+    int var53;
+    jsval var54;
+    JSString * var55;
+    jsval var92;
+    size_t var56;
+    size_t var57;
+    int var59;
+    jschar * var60;
+    jsval var93;
+    JSBool var46;
+    var47 = NULL;
+    var51 = 0;
     var52 = NULL;
-    var87 = JSVAL_NULL;
     var53 = 0;
-    var54 = 0;
+    var54 = JSVAL_NULL;
+    var55 = NULL;
+    var92 = JSVAL_NULL;
     var56 = 0;
-    var55 = NULL;
-    var88 = JSVAL_NULL;
-    var43 = JS_FALSE;
-    var44 = obj;
-    var48 = argc;
-    var50 = 0;
-    var50 = var50 < var48;
-    if (var50) {
-    var51 = argv[0];
-    var52 = JS_ValueToString(cx, var51);
-    if (!var52) {
+    var57 = 0;
+    var59 = 0;
+    var60 = NULL;
+    var93 = JSVAL_NULL;
+    var46 = JS_FALSE;
+    var47 = obj;
+    var51 = argc;
+    var53 = 0;
+    var53 = var53 < var51;
+    if (var53) {
+    var54 = argv[0];
+    var55 = JS_ValueToString(cx, var54);
+    if (!var55) {
         goto do_return;
     }
-    var87 = STRING_TO_JSVAL(var52);
-    argv[argc+0] = var87;
-    var53 = JS_GetStringLength(var52);
-    var54 = 1;
-    var54 += var53;
-    var49 = JS_malloc(cx, var54);
-    if (!var49) {
-        goto do_return;
+    var92 = STRING_TO_JSVAL(var55);
+    argv[argc+0] = var92;
+    var56 = JS_GetStringLength(var55);
+    var57 = 1;
+    var57 += var56;
+#ifdef HAVE_ALLOCA
+    if (var57 < jj_alloca_limit) {
+        var52 = alloca(var57);
+    } else {
+#endif
+        var52 = malloc(var57);
+        if (!var52) {
+            goto do_return;
+        } else {
+            var59 = 1;
+        }
+#ifdef HAVE_ALLOCA
     }
-    var56 = 1;
-    var55 = JS_GetStringChars(var52);
-    var88 = STRING_TO_JSVAL(var52);
-    argv[argc+1] = var88;
+#endif
+    var60 = JS_GetStringChars(var55);
+    var93 = STRING_TO_JSVAL(var55);
+    argv[argc+1] = var93;
     {
         size_t i;
-        for (i = 0; i < var53; ++i) {
-            var49[i] = wctob(var55[i]);
+        for (i = 0; i < var56; ++i) {
+            var52[i] = wctob(var60[i]);
         }
-        var49[var53] = '\0';
+        var52[var56] = '\0';
     }
     }
-    jsPrint2(var49);
-    var43 = JS_TRUE;
+    jsPrint2(var52);
+    var46 = JS_TRUE;
     do_return:
-    if (var56) {
-        JS_free(cx, var49);
-        var49 = NULL;
-        var56 = 0;
+    if (var59) {
+        free(var52);
+        var52 = NULL;
+        var59 = 0;
     }
-    return var43;
+    return var46;
 }
 static JSBool
 jjhelp(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval)
 {
-    JSObject *var58;
-    char *var63;
-    int var62;
-    int var64;
-    jsval var65;
-    JSString *var66;
-    jsval var89;
-    size_t var67;
-    size_t var68;
-    int var70;
-    jschar *var69;
-    jsval var90;
-    JSBool var57;
-    var58 = NULL;
-    var63 = NULL;
-    var62 = 0;
-    var64 = 0;
-    var65 = JSVAL_NULL;
-    var66 = NULL;
-    var89 = JSVAL_NULL;
-    var67 = 0;
+    JSObject * var62;
+    int var66;
+    char * var67;
+    int var68;
+    jsval var69;
+    JSString * var70;
+    jsval var94;
+    size_t var71;
+    size_t var72;
+    int var74;
+    jschar * var75;
+    jsval var95;
+    JSBool var61;
+    var62 = NULL;
+    var66 = 0;
+    var67 = NULL;
     var68 = 0;
-    var70 = 0;
-    var69 = NULL;
-    var90 = JSVAL_NULL;
-    var57 = JS_FALSE;
-    var58 = obj;
-    var62 = argc;
-    var64 = 0;
-    var64 = var64 < var62;
-    if (var64) {
-    var65 = argv[0];
-    var66 = JS_ValueToString(cx, var65);
-    if (!var66) {
+    var69 = JSVAL_NULL;
+    var70 = NULL;
+    var94 = JSVAL_NULL;
+    var71 = 0;
+    var72 = 0;
+    var74 = 0;
+    var75 = NULL;
+    var95 = JSVAL_NULL;
+    var61 = JS_FALSE;
+    var62 = obj;
+    var66 = argc;
+    var68 = 0;
+    var68 = var68 < var66;
+    if (var68) {
+    var69 = argv[0];
+    var70 = JS_ValueToString(cx, var69);
+    if (!var70) {
         goto do_return;
     }
-    var89 = STRING_TO_JSVAL(var66);
-    argv[argc+0] = var89;
-    var67 = JS_GetStringLength(var66);
-    var68 = 1;
-    var68 += var67;
-    var63 = JS_malloc(cx, var68);
-    if (!var63) {
-        goto do_return;
+    var94 = STRING_TO_JSVAL(var70);
+    argv[argc+0] = var94;
+    var71 = JS_GetStringLength(var70);
+    var72 = 1;
+    var72 += var71;
+#ifdef HAVE_ALLOCA
+    if (var72 < jj_alloca_limit) {
+        var67 = alloca(var72);
+    } else {
+#endif
+        var67 = malloc(var72);
+        if (!var67) {
+            goto do_return;
+        } else {
+            var74 = 1;
+        }
+#ifdef HAVE_ALLOCA
     }
-    var70 = 1;
-    var69 = JS_GetStringChars(var66);
-    var90 = STRING_TO_JSVAL(var66);
-    argv[argc+1] = var90;
+#endif
+    var75 = JS_GetStringChars(var70);
+    var95 = STRING_TO_JSVAL(var70);
+    argv[argc+1] = var95;
     {
         size_t i;
-        for (i = 0; i < var67; ++i) {
-            var63[i] = wctob(var69[i]);
+        for (i = 0; i < var71; ++i) {
+            var67[i] = wctob(var75[i]);
         }
-        var63[var67] = '\0';
+        var67[var71] = '\0';
     }
     }
-    jsHelp(var63);
-    var57 = JS_TRUE;
+    jsHelp(var67);
+    var61 = JS_TRUE;
     do_return:
-    if (var70) {
-        JS_free(cx, var63);
-        var63 = NULL;
-        var70 = 0;
+    if (var74) {
+        free(var67);
+        var67 = NULL;
+        var74 = 0;
     }
-    return var57;
+    return var61;
 }
 static JSBool
 jjsetSuccess(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval)
 {
-    JSObject *var72;
-    int var77;
-    int var76;
-    int var78;
-    jsval var79;
-    int32 var80;
-    JSBool var71;
-    var72 = NULL;
-    var77 = 0;
-    var76 = 0;
-    var78 = 0;
-    var79 = JSVAL_NULL;
-    var80 = 0;
-    var71 = JS_FALSE;
-    var72 = obj;
-    var76 = argc;
-    var78 = 0;
-    var78 = var78 < var76;
-    if (var78) {
-    var79 = argv[0];
-    if (JS_ValueToInt32(cx, var79, &var80) != JS_TRUE) {
+    JSObject * var77;
+    int var81;
+    int var82;
+    int var83;
+    jsval var84;
+    int32 var85;
+    JSBool var76;
+    var77 = NULL;
+    var81 = 0;
+    var82 = 0;
+    var83 = 0;
+    var84 = JSVAL_NULL;
+    var85 = 0;
+    var76 = JS_FALSE;
+    var77 = obj;
+    var81 = argc;
+    var83 = 0;
+    var83 = var83 < var81;
+    if (var83) {
+    var84 = argv[0];
+    if (JS_ValueToInt32(cx, var84, &var85) != JS_TRUE) {
         goto do_return;
     }
-    var77 = (int)var80;
+    var82 = (int)var85;
     }
-    jsSetSuccess(var77);
-    var71 = JS_TRUE;
+    jsSetSuccess(var82);
+    var76 = JS_TRUE;
     do_return:
-    return var71;
+    return var76;
 }
 static JSPropertySpec jj_static_ps[] = {
     {NULL, 0, 0, NULL, NULL}

Modified: branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src/ADM_jsIf_js.idl
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src/ADM_jsIf_js.idl	2010-05-04 05:36:29 UTC (rev 6156)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src/ADM_jsIf_js.idl	2010-05-04 05:36:32 UTC (rev 6157)
@@ -1,3 +1,9 @@
+%{
+#include "stdio.h"
+#include "ADM_jsAvidemux.h"
+#include "ADM_jsDebug.h"
+%}
+
 /*
 ###############################################################
        return JS function     CM Function  params

Modified: branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src/ADM_jsTestFactory_js.c
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src/ADM_jsTestFactory_js.c	2010-05-04 05:36:29 UTC (rev 6156)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src/ADM_jsTestFactory_js.c	2010-05-04 05:36:32 UTC (rev 6157)
@@ -12,8 +12,20 @@
 please refer to the software package which it is part of.
 
 */
+
+#include "stdio.h"
+#include "ADM_jsAvidemux.h"
+#include "ADM_jsTestFactory.h"
+
+#ifdef HAVE_ALLOCA_H
+#include <alloca.h>
+static size_t jj_alloca_limit = 0;
+#endif
+#include <stdlib.h>
 #include <string.h>
 #include <wchar.h>
+#ifdef HAVE_ALLOCA_H
+#endif
 #include <jsapi.h>
 #ifndef JS_THREADSAFE
 #if JS_VERSION <= 170
@@ -30,10 +42,11 @@
 #ifndef JS_FS_END
 #define JS_FS_END {NULL, NULL, 0, 0, 0}
 #endif
+
 static JSBool
 jjadmTestFacInt(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval)
 {
-    JSObject *var2;
+    JSObject * var2;
     int var3;
     int var6;
     jsval var7;
@@ -60,7 +73,7 @@
 static JSBool
 jjadmTestFacFloat(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval)
 {
-    JSObject *var9;
+    JSObject * var9;
     int var10;
     int var13;
     jsval var14;
@@ -87,7 +100,7 @@
 static JSBool
 jjadmTestFacToggle(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval)
 {
-    JSObject *var16;
+    JSObject * var16;
     int var17;
     int var20;
     jsval var21;
@@ -114,7 +127,7 @@
 static JSBool
 jjadmTestFacMenu(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval)
 {
-    JSObject *var23;
+    JSObject * var23;
     int var24;
     int var27;
     jsval var28;
@@ -141,7 +154,7 @@
 static JSBool
 jjadmTestFacFile(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval)
 {
-    JSObject *var30;
+    JSObject * var30;
     int var31;
     int var34;
     jsval var35;
@@ -168,7 +181,7 @@
 static JSBool
 jjadmTestFacBitrate(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval)
 {
-    JSObject *var37;
+    JSObject * var37;
     int var38;
     int var41;
     jsval var42;
@@ -195,7 +208,7 @@
 static JSBool
 jjadmTestFacBar(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval)
 {
-    JSObject *var44;
+    JSObject * var44;
     int var45;
     int var48;
     jsval var49;
@@ -222,7 +235,7 @@
 static JSBool
 jjadmTestFacRoText(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval)
 {
-    JSObject *var51;
+    JSObject * var51;
     int var52;
     int var55;
     jsval var56;
@@ -249,7 +262,7 @@
 static JSBool
 jjadmTestFacText(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval)
 {
-    JSObject *var58;
+    JSObject * var58;
     int var59;
     int var62;
     jsval var63;
@@ -276,7 +289,7 @@
 static JSBool
 jjadmTestFacTab(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval)
 {
-    JSObject *var65;
+    JSObject * var65;
     int var66;
     int var69;
     jsval var70;
@@ -303,7 +316,7 @@
 static JSBool
 jjadmTestFacFrame(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval)
 {
-    JSObject *var72;
+    JSObject * var72;
     int var73;
     int var76;
     jsval var77;
@@ -330,7 +343,7 @@
 static JSBool
 jjadmTestFacHex(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval)
 {
-    JSObject *var79;
+    JSObject * var79;
     int var80;
     int var83;
     jsval var84;
@@ -357,7 +370,7 @@
 static JSBool
 jjadmTestFacDirSel(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval)
 {
-    JSObject *var86;
+    JSObject * var86;
     int var87;
     int var90;
     jsval var91;
@@ -384,7 +397,7 @@
 static JSBool
 jjadmTestFacButton(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval)
 {
-    JSObject *var93;
+    JSObject * var93;
     int var94;
     int var97;
     jsval var98;
@@ -411,7 +424,7 @@
 static JSBool
 jjadmTestFacMatrix(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval)
 {
-    JSObject *var100;
+    JSObject * var100;
     int var101;
     int var104;
     jsval var105;
@@ -438,7 +451,7 @@
 static JSBool
 jjadmTestFacNotch(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval)
 {
-    JSObject *var107;
+    JSObject * var107;
     int var108;
     int var111;
     jsval var112;
@@ -465,7 +478,7 @@
 static JSBool
 jjadmTestFacThreadCount(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval)
 {
-    JSObject *var114;
+    JSObject * var114;
     int var115;
     int var118;
     jsval var119;
@@ -492,7 +505,7 @@
 static JSBool
 jjadmTestFacSlider(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval)
 {
-    JSObject *var121;
+    JSObject * var121;
     int var122;
     int var125;
     jsval var126;
@@ -519,7 +532,7 @@
 static JSBool
 jjadmTestEncoding(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval)
 {
-    JSObject *var128;
+    JSObject * var128;
     int var129;
     int var132;
     jsval var133;
@@ -546,7 +559,7 @@
 static JSBool
 jjadmTestCrash(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval)
 {
-    JSObject *var135;
+    JSObject * var135;
     int var139;
     JSBool var134;
     var135 = NULL;
@@ -561,7 +574,7 @@
 static JSBool
 jjadmTestAssert(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval)
 {
-    JSObject *var141;
+    JSObject * var141;
     int var145;
     JSBool var140;
     var141 = NULL;

Modified: branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src/ADM_jsTestFactory_js.idl
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src/ADM_jsTestFactory_js.idl	2010-05-04 05:36:29 UTC (rev 6156)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src/ADM_jsTestFactory_js.idl	2010-05-04 05:36:32 UTC (rev 6157)
@@ -1,3 +1,8 @@
+%{
+#include "stdio.h"
+#include "ADM_jsAvidemux.h"
+#include "ADM_jsTestFactory.h"
+%}
 /*
 ###############################################################
        return JS function     C Function  params

Modified: branches/avidemux_2.6_branch_mean/avidemux/qt4/ADM_UIs/src/toolkit.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/qt4/ADM_UIs/src/toolkit.cpp	2010-05-04 05:36:29 UTC (rev 6156)
+++ branches/avidemux_2.6_branch_mean/avidemux/qt4/ADM_UIs/src/toolkit.cpp	2010-05-04 05:36:32 UTC (rev 6157)
@@ -35,6 +35,7 @@
 
 	*w = (uint32_t)qrect.width();
 	*h = (uint32_t)qrect.height();
+    return 1;
 }
 
 // Calculate the zoom ratio required to fit the whole image on the screen.

Modified: branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_demuxers/Matroska/ADM_mkv.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_demuxers/Matroska/ADM_mkv.cpp	2010-05-04 05:36:29 UTC (rev 6156)
+++ branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_demuxers/Matroska/ADM_mkv.cpp	2010-05-04 05:36:32 UTC (rev 6157)
@@ -358,10 +358,11 @@
                   break;
         case ADM_MKV_TYPE_STRING:
         {
-                  char string[len+1];
+                  char *string=new char[len+1];
                   string[0]=0;
                   father->readString(string,len);
                   printf("%s:<%s>\n",ss,string);
+                  delete [] string;
                   break;
         }
         default:

Modified: branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_demuxers/Matroska/ADM_mkvEntries.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_demuxers/Matroska/ADM_mkvEntries.cpp	2010-05-04 05:36:29 UTC (rev 6156)
+++ branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_demuxers/Matroska/ADM_mkvEntries.cpp	2010-05-04 05:36:32 UTC (rev 6157)
@@ -230,10 +230,11 @@
                   break;
         case MKV_CODEC_ID:
             {
-            uint8_t codec[len+1];
+            uint8_t *codec=new uint8_t[len+1];
                   father.readBin(codec,len);
                   codec[len]=0;
                   entry->fcc=ADM_mkvCodecToFourcc((char *)codec);
+                  delete [] codec;
 
             }
                   break;

Modified: branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_demuxers/Matroska/ADM_mkvIndexer.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_demuxers/Matroska/ADM_mkvIndexer.cpp	2010-05-04 05:36:29 UTC (rev 6156)
+++ branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_demuxers/Matroska/ADM_mkvIndexer.cpp	2010-05-04 05:36:32 UTC (rev 6157)
@@ -171,7 +171,7 @@
   {
     if( isMpeg4Compatible(_videostream.fccHandler))
     {
-        uint8_t buffer[size];
+        uint8_t *buffer=(uint8_t *)alloca(size*sizeof(uint8_t));
         
             parser->readBin(buffer,size-3);
             // Search the frame type...
@@ -185,7 +185,7 @@
     }else
     if(isH264Compatible(_videostream.fccHandler))
     {
-            uint8_t buffer[size];
+                uint8_t *buffer=(uint8_t *)alloca(size);
                 uint32_t flags=AVI_KEY_FRAME;
                 parser->readBin(buffer,size-3);
                 extractH264FrameType(2,buffer,size-3,&flags); // Nal size is not used in that case

Modified: branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_demuxers/Mp4/ADM_mp4Indexer.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_demuxers/Mp4/ADM_mp4Indexer.cpp	2010-05-04 05:36:29 UTC (rev 6156)
+++ branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_demuxers/Mp4/ADM_mp4Indexer.cpp	2010-05-04 05:36:32 UTC (rev 6157)
@@ -71,7 +71,7 @@
           printf("All the same size: %u (total size %u bytes)\n",info->SzIndentical,totalBytes);
               //
               // Each chunk contains N samples=N bytes
-              int samplePerChunk[info->nbCo];
+              int *samplePerChunk=(int *)alloca(info->nbCo*sizeof(int));
               memset(samplePerChunk,0,info->nbCo*sizeof(int));
               int total=0;
               for( i=0;i<info->nbSc;i++)

Modified: branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_demuxers/MpegPS/ADM_ps.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_demuxers/MpegPS/ADM_ps.cpp	2010-05-04 05:36:29 UTC (rev 6156)
+++ branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_demuxers/MpegPS/ADM_ps.cpp	2010-05-04 05:36:32 UTC (rev 6157)
@@ -31,7 +31,7 @@
 
 uint8_t psHeader::open(const char *name)
 {
-    char idxName[strlen(name)+4];
+    char *idxName=(char *)alloca(strlen(name)+4);
     bool r=false;
     FP_TYPE appendType=FP_DONT_APPEND;
     uint32_t append;

Modified: branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_demuxers/MpegPS/ADM_psIndex.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_demuxers/MpegPS/ADM_psIndex.cpp	2010-05-04 05:36:29 UTC (rev 6156)
+++ branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_demuxers/MpegPS/ADM_psIndex.cpp	2010-05-04 05:36:32 UTC (rev 6157)
@@ -155,7 +155,7 @@
 dmxPacketInfo info;
     memset(&video,0,sizeof(video));
     memset(&data,0,sizeof(data));
-    char indexName[strlen(file)+5];
+    char *indexName=(char *)alloca(strlen(file)+5);
     sprintf(indexName,"%s.idx2",file);
     index=qfopen(indexName,"wt");
     if(!index)

Modified: branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_demuxers/MpegPS/ADM_psPlugin.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_demuxers/MpegPS/ADM_psPlugin.cpp	2010-05-04 05:36:29 UTC (rev 6156)
+++ branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_demuxers/MpegPS/ADM_psPlugin.cpp	2010-05-04 05:36:32 UTC (rev 6157)
@@ -33,7 +33,7 @@
 
 extern "C"  uint32_t         probe(uint32_t magic, const char *fileName)
 {
-char index[strlen(fileName)+4];
+char *index=(char *)alloca(strlen(fileName)+4);
 int count=0;
     if(!detectPs(fileName))
     {

Modified: branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_demuxers/MpegPS/ADM_psReadIndex.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_demuxers/MpegPS/ADM_psReadIndex.cpp	2010-05-04 05:36:29 UTC (rev 6156)
+++ branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_demuxers/MpegPS/ADM_psReadIndex.cpp	2010-05-04 05:36:32 UTC (rev 6157)
@@ -120,7 +120,7 @@
                     printf("[psDemux]  instead of : (%c %x %x):\n",*cur,*(cur-1),*cur);
                     break;
                 }
-                *cur++;
+                cur++;
                 next=strstr(start," ");
                 ADM_assert(1==sscanf(cur,"%"LX,&len));
                 

Modified: branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_demuxers/MpegTS/ADM_ts.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_demuxers/MpegTS/ADM_ts.cpp	2010-05-04 05:36:29 UTC (rev 6156)
+++ branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_demuxers/MpegTS/ADM_ts.cpp	2010-05-04 05:36:32 UTC (rev 6157)
@@ -31,7 +31,7 @@
 
 uint8_t tsHeader::open(const char *name)
 {
-    char idxName[strlen(name)+4];
+    char *idxName=(char *)alloca(strlen(name)+4);
     bool r=false;
     FP_TYPE appendType=FP_DONT_APPEND;
     uint32_t append;
@@ -62,7 +62,7 @@
     if(append) appendType=FP_APPEND;
     if(!parser.open(name,&appendType))
     {
-        printf("[tsDemux] Cannot open root file\n",name);
+        printf("[tsDemux] Cannot open root file (%s)\n",name);
         goto abt;
     }
     if(!readVideo(&index)) 
@@ -166,6 +166,7 @@
             }
         }
     }
+    return true;
 }
 /**
     \fn getAudioInfo
@@ -239,6 +240,7 @@
         delete tsPacket;
         tsPacket=NULL;
     }
+    return 1;
 }
 /**
     \fn tsHeader

Modified: branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_demuxers/MpegTS/ADM_tsPlugin.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_demuxers/MpegTS/ADM_tsPlugin.cpp	2010-05-04 05:36:29 UTC (rev 6156)
+++ branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_demuxers/MpegTS/ADM_tsPlugin.cpp	2010-05-04 05:36:32 UTC (rev 6157)
@@ -34,7 +34,7 @@
 
 extern "C"  uint32_t         probe(uint32_t magic, const char *fileName)
 {
-char index[strlen(fileName)+4];
+char *index=(char *)alloca(strlen(fileName)+4);
 int count=0;
     printf("[TS Demuxer] Probing...\n");
     if( !detectTs(fileName))

Modified: branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_demuxers/OpenDml/ADM_odml_odml.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_demuxers/OpenDml/ADM_odml_odml.cpp	2010-05-04 05:36:29 UTC (rev 6156)
+++ branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_demuxers/OpenDml/ADM_odml_odml.cpp	2010-05-04 05:36:32 UTC (rev 6157)
@@ -195,7 +195,7 @@
 
 
 
-	OPENDML_ENTRY superEntries[masterIndex.nbEntryInUse];
+	OPENDML_ENTRY *superEntries=(OPENDML_ENTRY *)alloca(masterIndex.nbEntryInUse*sizeof(OPENDML_ENTRY));
 	printf("[AVI]We have %"LU" indeces\n",masterIndex.nbEntryInUse);
         if(!readSuperEntries(superEntries,masterIndex.nbEntryInUse,_fd)) //if(1!=fread(superEntries,sizeof(OPENDML_ENTRY)*masterIndex.nbEntryInUse,1,_fd))
 	{



From mean at mail.berlios.de  Tue May  4 07:36:37 2010
From: mean at mail.berlios.de (mean at BerliOS)
Date: Tue, 4 May 2010 07:36:37 +0200
Subject: [Avidemux-svn-commit] r6158 - in branches/avidemux_2.6_branch_mean:
	avidemux_core/ADM_coreMuxer/include
	avidemux_core/ADM_coreVideoFilter/include
	avidemux_plugins/ADM_demuxers/Asf avidemux_plugins/ADM_demuxers/Flv
	avidemux_plugins/ADM_demuxers/Matroska
	avidemux_plugins/ADM_demuxers/MpegPS
	avidemux_plugins/ADM_demuxers/MpegTS
	avidemux_plugins/ADM_demuxers/OpenDml
	avidemux_plugins/ADM_videoFilters6/verticalFlip
Message-ID: <201005040536.o445abrG022044@sheep.berlios.de>

Author: mean
Date: 2010-05-04 07:36:36 +0200 (Tue, 04 May 2010)
New Revision: 6158

Modified:
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreMuxer/include/ADM_muxerInternal.h
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreVideoFilter/include/ADM_coreVideoFilterInternal.h
   branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_demuxers/Asf/ADM_asf.cpp
   branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_demuxers/Flv/ADM_flv.cpp
   branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_demuxers/Matroska/ADM_mkv.cpp
   branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_demuxers/Matroska/ebml.cpp
   branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_demuxers/MpegPS/ADM_ps.cpp
   branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_demuxers/MpegPS/ADM_psIndex.cpp
   branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_demuxers/MpegTS/ADM_tsIndex.cpp
   branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_demuxers/MpegTS/ADM_tsReadIndex.cpp
   branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_demuxers/MpegTS/dmxTSPacket.cpp
   branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_demuxers/OpenDml/ADM_odml_audio.h
   branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_demuxers/OpenDml/ADM_openDML.cpp
   branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_videoFilters6/verticalFlip/verticalFlip.cpp
Log:
[clang] Remove plugin warnings

Modified: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreMuxer/include/ADM_muxerInternal.h
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreMuxer/include/ADM_muxerInternal.h	2010-05-04 05:36:32 UTC (rev 6157)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreMuxer/include/ADM_muxerInternal.h	2010-05-04 05:36:36 UTC (rev 6158)
@@ -75,7 +75,7 @@
 extern "C" {\
 ADM_muxer   *create(void){ return new Class; } \
 void         destroy(ADM_muxer *h){ Class *z=(Class *)h;delete z;} \
-uint8_t      getVersion(uint32_t *major,uint32_t *minor,uint32_t *patch) {*major=maj;*minor=mn;*patch=pat;} \
+uint8_t      getVersion(uint32_t *major,uint32_t *minor,uint32_t *patch) {*major=maj;*minor=mn;*patch=pat;return 1;} \
 uint32_t     getApiVersion(void) {return ADM_MUXER_API_VERSION;} \
 const char  *getName(void) {return name;} \
 const char  *getDescriptor(void) {return desc;} \

Modified: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreVideoFilter/include/ADM_coreVideoFilterInternal.h
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreVideoFilter/include/ADM_coreVideoFilterInternal.h	2010-05-04 05:36:32 UTC (rev 6157)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreVideoFilter/include/ADM_coreVideoFilterInternal.h	2010-05-04 05:36:36 UTC (rev 6158)
@@ -32,6 +32,7 @@
 	{ \
 		Class *a=(Class *)codec;\
 		delete a;\
+        return NULL;\
 	}\
 	int supportedUI(void) \
 	{ \

Modified: branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_demuxers/Asf/ADM_asf.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_demuxers/Asf/ADM_asf.cpp	2010-05-04 05:36:32 UTC (rev 6157)
+++ branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_demuxers/Asf/ADM_asf.cpp	2010-05-04 05:36:36 UTC (rev 6158)
@@ -110,6 +110,7 @@
     delete _audioStreams[i];
     _audioStreams[i]=NULL;    
   }
+  return 1;
 }
 /**
     \fn asfHeader

Modified: branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_demuxers/Flv/ADM_flv.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_demuxers/Flv/ADM_flv.cpp	2010-05-04 05:36:32 UTC (rev 6157)
+++ branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_demuxers/Flv/ADM_flv.cpp	2010-05-04 05:36:36 UTC (rev 6158)
@@ -692,6 +692,7 @@
   audioTrack=NULL;
   _audioStream=NULL;
   access=NULL;
+  return 1;
 }
 /**
     \fn flvHeader

Modified: branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_demuxers/Matroska/ADM_mkv.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_demuxers/Matroska/ADM_mkv.cpp	2010-05-04 05:36:32 UTC (rev 6157)
+++ branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_demuxers/Matroska/ADM_mkv.cpp	2010-05-04 05:36:36 UTC (rev 6158)
@@ -423,7 +423,7 @@
         delete [] _access;
         _access=NULL;
     }
-
+    return 1;
 }
 /**
     \fn mkvHeader
@@ -666,7 +666,7 @@
     
     dx->Dts=dts; // FIXME
     dx->Pts=pts;
-    
+    return true;
 
 }
 

Modified: branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_demuxers/Matroska/ebml.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_demuxers/Matroska/ebml.cpp	2010-05-04 05:36:32 UTC (rev 6157)
+++ branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_demuxers/Matroska/ebml.cpp	2010-05-04 05:36:36 UTC (rev 6158)
@@ -209,6 +209,7 @@
     default:
         ADM_assert(0);
   }
+  return 0;
 }
 
 ADM_ebml::ADM_ebml(void)

Modified: branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_demuxers/MpegPS/ADM_ps.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_demuxers/MpegPS/ADM_ps.cpp	2010-05-04 05:36:32 UTC (rev 6157)
+++ branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_demuxers/MpegPS/ADM_ps.cpp	2010-05-04 05:36:36 UTC (rev 6158)
@@ -61,7 +61,7 @@
     if(append) appendType=FP_APPEND;
     if(!parser.open(name,&appendType))
     {
-        printf("[psDemux] Cannot open root file\n",name);
+        printf("[psDemux] Cannot open root file %s\n",name);
         goto abt;
     }
     if(!readVideo(&index)) 
@@ -187,6 +187,7 @@
         delete psPacket;
         psPacket=NULL;
     }
+    return 1;
 }
 /**
     \fn psHeader

Modified: branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_demuxers/MpegPS/ADM_psIndex.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_demuxers/MpegPS/ADM_psIndex.cpp	2010-05-04 05:36:32 UTC (rev 6157)
+++ branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_demuxers/MpegPS/ADM_psIndex.cpp	2010-05-04 05:36:36 UTC (rev 6158)
@@ -416,6 +416,7 @@
         data->startAt=info->startAt;
         data->offset=info->offset;
     }
+    return true;
 }
 
 /**

Modified: branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_demuxers/MpegTS/ADM_tsIndex.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_demuxers/MpegTS/ADM_tsIndex.cpp	2010-05-04 05:36:32 UTC (rev 6157)
+++ branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_demuxers/MpegTS/ADM_tsIndex.cpp	2010-05-04 05:36:36 UTC (rev 6158)
@@ -265,7 +265,7 @@
 bool TsIndexer::decodeSEI(uint32_t nalSize, uint8_t *org,uint32_t *recoveryLength)
 {
     GetBitContext s;
-    uint8_t payload[nalSize+16];
+    uint8_t *payload=(uint8_t *)alloca(nalSize+16);
     nalSize=unescapeH264(nalSize,org,payload);
     init_get_bits(&s, payload, nalSize*8);
     while( get_bits_count(&s)<(nalSize-4)*8)
@@ -311,7 +311,7 @@
     video.pid=videoTrac[0].trackPid;
 
     memset(&data,0,sizeof(data));
-    char indexName[strlen(file)+5];
+    char *indexName=(char *)alloca(strlen(file)+5);
     sprintf(indexName,"%s.idx2",file);
     index=qfopen(indexName,"wt");
     if(!index)
@@ -522,7 +522,7 @@
     memset(&data,0,sizeof(data));
 
 
-    char indexName[strlen(file)+5];
+    char *indexName=(char *)alloca(strlen(file)+5);
     sprintf(indexName,"%s.idx2",file);
     index=qfopen(indexName,"wt");
     if(!index)

Modified: branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_demuxers/MpegTS/ADM_tsReadIndex.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_demuxers/MpegTS/ADM_tsReadIndex.cpp	2010-05-04 05:36:32 UTC (rev 6157)
+++ branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_demuxers/MpegTS/ADM_tsReadIndex.cpp	2010-05-04 05:36:36 UTC (rev 6158)
@@ -122,7 +122,7 @@
                 {
                     printf("[TsDemuxer]  instead of : (%c %x %x):\n",*cur,*(cur-1),*cur);
                 }
-                *cur++;
+                cur++;
                 next=strstr(start," ");
                 int64_t ppts,ddts;
                 ADM_assert(3==sscanf(cur,"%"LX":%"LLD":%"LLD,&len,&ppts,&ddts));

Modified: branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_demuxers/MpegTS/dmxTSPacket.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_demuxers/MpegTS/dmxTSPacket.cpp	2010-05-04 05:36:32 UTC (rev 6157)
+++ branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_demuxers/MpegTS/dmxTSPacket.cpp	2010-05-04 05:36:36 UTC (rev 6158)
@@ -148,6 +148,7 @@
         printf("[tsPacket] Cannot seek to %"LLX"\n", pos);
         return false;
     }
+    return true;
 }
 /**
     \fn getSinglePacket

Modified: branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_demuxers/OpenDml/ADM_odml_audio.h
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_demuxers/OpenDml/ADM_odml_audio.h	2010-05-04 05:36:32 UTC (rev 6157)
+++ branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_demuxers/OpenDml/ADM_odml_audio.h	2010-05-04 05:36:36 UTC (rev 6158)
@@ -32,7 +32,7 @@
                 virtual bool      canGetDuration(void) {return false;};
                 virtual uint64_t  getDurationInUs(void) {return 0;};
                 virtual uint32_t  getLength(void) {return length;}
-                virtual bool      goToTime(uint64_t timeUs) {ADM_assert(0);}
+                virtual bool      goToTime(uint64_t timeUs) {ADM_assert(0);return true;}
                 virtual bool      isCBR(void) ;
                 virtual uint64_t  getPos(void);
                 

Modified: branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_demuxers/OpenDml/ADM_openDML.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_demuxers/OpenDml/ADM_openDML.cpp	2010-05-04 05:36:32 UTC (rev 6157)
+++ branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_demuxers/OpenDml/ADM_openDML.cpp	2010-05-04 05:36:36 UTC (rev 6158)
@@ -597,7 +597,7 @@
        idx->dts=frameToUs(i);
     }
     _idx[0].pts=0;
-  
+    return 1;
 }
 /**
     \fn mpegReorder

Modified: branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_videoFilters6/verticalFlip/verticalFlip.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_videoFilters6/verticalFlip/verticalFlip.cpp	2010-05-04 05:36:32 UTC (rev 6157)
+++ branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_videoFilters6/verticalFlip/verticalFlip.cpp	2010-05-04 05:36:36 UTC (rev 6158)
@@ -67,7 +67,7 @@
 
 static void flipMe(uint8_t *data, uint32_t w,uint32_t h)
 {
-    uint8_t scratch[w];
+    uint8_t *scratch=(uint8_t *)alloca(w);
     int count=h>>1;
     for(int i=0;i<count;i++)
     {



From mean at mail.berlios.de  Sat May  8 09:38:14 2010
From: mean at mail.berlios.de (mean at BerliOS)
Date: Sat, 8 May 2010 09:38:14 +0200
Subject: [Avidemux-svn-commit] r6159 - tags
Message-ID: <201005080738.o487cEY5031228@sheep.berlios.de>

Author: mean
Date: 2010-05-08 09:38:13 +0200 (Sat, 08 May 2010)
New Revision: 6159

Added:
   tags/avidemux_2.5.3/
Log:
Tag 2.5.3


Copied: tags/avidemux_2.5.3 (from rev 6158, branches/avidemux_2.5_branch_gruntster)



From mean at mail.berlios.de  Sat May  8 10:04:00 2010
From: mean at mail.berlios.de (mean at BerliOS)
Date: Sat, 8 May 2010 10:04:00 +0200
Subject: [Avidemux-svn-commit] r6160 -
	tags/avidemux_2.5.3/avidemux/ADM_libraries
Message-ID: <201005080804.o48840p2000304@sheep.berlios.de>

Author: mean
Date: 2010-05-08 10:03:18 +0200 (Sat, 08 May 2010)
New Revision: 6160

Added:
   tags/avidemux_2.5.3/avidemux/ADM_libraries/ffmpeg_r22831.tar.gz
   tags/avidemux_2.5.3/avidemux/ADM_libraries/libswscale_r31028.tar.gz
Removed:
   tags/avidemux_2.5.3/avidemux/ADM_libraries/ffmpeg_r20602.tar.gz
   tags/avidemux_2.5.3/avidemux/ADM_libraries/libswscale_r29964.tar.gz
Log:
[2.5.3] Bump ffmpeg and libswscale tarball

Deleted: tags/avidemux_2.5.3/avidemux/ADM_libraries/ffmpeg_r20602.tar.gz
===================================================================
(Binary files differ)

Added: tags/avidemux_2.5.3/avidemux/ADM_libraries/ffmpeg_r22831.tar.gz
===================================================================
(Binary files differ)


Property changes on: tags/avidemux_2.5.3/avidemux/ADM_libraries/ffmpeg_r22831.tar.gz
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Deleted: tags/avidemux_2.5.3/avidemux/ADM_libraries/libswscale_r29964.tar.gz
===================================================================
(Binary files differ)

Added: tags/avidemux_2.5.3/avidemux/ADM_libraries/libswscale_r31028.tar.gz
===================================================================
(Binary files differ)


Property changes on: tags/avidemux_2.5.3/avidemux/ADM_libraries/libswscale_r31028.tar.gz
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream



From mean at mail.berlios.de  Sat May  8 10:04:35 2010
From: mean at mail.berlios.de (mean at BerliOS)
Date: Sat, 8 May 2010 10:04:35 +0200
Subject: [Avidemux-svn-commit] r6161 - tags/avidemux_2.5.3
Message-ID: <201005080804.o4884ZJS000382@sheep.berlios.de>

Author: mean
Date: 2010-05-08 10:04:34 +0200 (Sat, 08 May 2010)
New Revision: 6161

Modified:
   tags/avidemux_2.5.3/CMakeLists.txt
Log:
[2.5.3] Bump version

Modified: tags/avidemux_2.5.3/CMakeLists.txt
===================================================================
--- tags/avidemux_2.5.3/CMakeLists.txt	2010-05-08 08:03:18 UTC (rev 6160)
+++ tags/avidemux_2.5.3/CMakeLists.txt	2010-05-08 08:04:34 UTC (rev 6161)
@@ -97,7 +97,7 @@
 ########################################
 # Standard Avidemux defines
 ########################################
-SET(VERSION 2.5.2)
+SET(VERSION 2.5.3)
 
 # Define internal flags for GTK+ and Qt4 builds.  These are turned off
 # if a showstopper is found.  CLI is automatically assumed as possible
@@ -118,18 +118,7 @@
 OPTION(SVN "" ON)
 SET(ADM_SUBVERSION 0)
 
-IF (SVN)
-	MESSAGE(STATUS "Checking for SCM Revision")
-	MESSAGE(STATUS "*************************")
 
-	SET(Subversion_FIND_REQUIRED OFF)
-	include(admGetRevision)
-	admGetRevision(${PROJECT_SOURCE_DIR} ADM_SUBVERSION)
-	MESSAGE(STATUS "  revision: ${ADM_SUBVERSION}")
-
-	MESSAGE("")
-ENDIF (SVN)
-
 ########################################
 # Check for libraries
 ########################################



From mean at mail.berlios.de  Sat May  8 18:15:00 2010
From: mean at mail.berlios.de (mean at BerliOS)
Date: Sat, 8 May 2010 18:15:00 +0200
Subject: [Avidemux-svn-commit] r6162 -
	branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src
Message-ID: <201005081615.o48GF00x013301@sheep.berlios.de>

Author: mean
Date: 2010-05-08 18:14:59 +0200 (Sat, 08 May 2010)
New Revision: 6162

Modified:
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src/ADM_jsAvidemux.cpp
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src/ADM_jsAvidemux_js.c
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src/ADM_jsEditor_js.c
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src/ADM_jsIf_js.c
Log:
[JS] Use patched jsapigen to be compatible with UTF8

Modified: branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src/ADM_jsAvidemux.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src/ADM_jsAvidemux.cpp	2010-05-08 08:04:34 UTC (rev 6161)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src/ADM_jsAvidemux.cpp	2010-05-08 16:14:59 UTC (rev 6162)
@@ -43,7 +43,7 @@
 int jsLoadVideo(const char *s)
 {
 int ret=0;
-        
+        jsLog(JS_LOG_NORMAL,"[Js] Loading video %s",s);
         if(A_openAvi(s)) 
         {
           ret=1;

Modified: branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src/ADM_jsAvidemux_js.c
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src/ADM_jsAvidemux_js.c	2010-05-08 08:04:34 UTC (rev 6161)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src/ADM_jsAvidemux_js.c	2010-05-08 16:14:59 UTC (rev 6162)
@@ -20,8 +20,15 @@
         printf("Constructor invoked\n");
 }
 
+#ifdef HAVE_ALLOCA_H
+#include <alloca.h>
+static size_t jj_alloca_limit = 0;
+#endif
+#include <stdlib.h>
 #include <string.h>
 #include <wchar.h>
+#ifdef HAVE_ALLOCA_H
+#endif
 #include <jsapi.h>
 #ifndef JS_THREADSAFE
 #if JS_VERSION <= 170
@@ -38,18 +45,7 @@
 #ifndef JS_FS_END
 #define JS_FS_END {NULL, NULL, 0, 0, 0}
 #endif
-static JSPropertySpec jj_static_ps[] = {
-    {NULL, 0, 0, NULL, NULL}
-};
-static JSPropertySpec jj_ps[] = {
-    {NULL, 0, 0, NULL, NULL}
-};
-static JSFunctionSpec jj_static_fs[] = {
-    JS_FS_END
-};
-static JSFunctionSpec jj_fs[] = {
-    JS_FS_END
-};
+
 static JSBool
 jjadmmarkerA_get(JSContext *cx, JSObject *obj, jsval id, jsval *val)
 {
@@ -200,35 +196,35 @@
 static JSBool
 jjadmloadVideo(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval)
 {
-    JSObject *var35;
-    char *var40;
+    JSObject * var35;
     int var36;
     int var39;
+    char * var40;
     int var41;
     jsval var42;
-    JSString *var43;
-    jsval var234;
+    JSString * var43;
+    jsval var241;
     size_t var44;
     size_t var45;
     int var47;
-    jschar *var46;
-    jsval var235;
-    jsval var48;
+    jschar * var48;
+    jsval var242;
+    jsval var49;
     JSBool var34;
     var35 = NULL;
-    var40 = NULL;
     var36 = 0;
     var39 = 0;
+    var40 = NULL;
     var41 = 0;
     var42 = JSVAL_NULL;
     var43 = NULL;
-    var234 = JSVAL_NULL;
+    var241 = JSVAL_NULL;
     var44 = 0;
     var45 = 0;
     var47 = 0;
-    var46 = NULL;
-    var235 = JSVAL_NULL;
-    var48 = JSVAL_NULL;
+    var48 = NULL;
+    var242 = JSVAL_NULL;
+    var49 = JSVAL_NULL;
     var34 = JS_FALSE;
     var35 = obj;
     var39 = argc;
@@ -240,39 +236,48 @@
     if (!var43) {
         goto do_return;
     }
-    var234 = STRING_TO_JSVAL(var43);
-    argv[argc+0] = var234;
+    var241 = STRING_TO_JSVAL(var43);
+    argv[argc+0] = var241;
     var44 = JS_GetStringLength(var43);
     var45 = 1;
     var45 += var44;
-    var40 = JS_malloc(cx, var45);
-    if (!var40) {
-        goto do_return;
+#ifdef HAVE_ALLOCA
+    if (var45 < jj_alloca_limit) {
+        var40 = alloca(var45);
+    } else {
+#endif
+        var40 = malloc(var45);
+        if (!var40) {
+            goto do_return;
+        } else {
+            var47 = 1;
+        }
+#ifdef HAVE_ALLOCA
     }
-    var47 = 1;
-    var46 = JS_GetStringChars(var43);
-    var235 = STRING_TO_JSVAL(var43);
-    argv[argc+1] = var235;
+#endif
+    var48 = JS_GetStringChars(var43);
+    var242 = STRING_TO_JSVAL(var43);
+    argv[argc+1] = var242;
     {
         size_t i;
         for (i = 0; i < var44; ++i) {
-            var40[i] = wctob(var46[i]);
+            var40[i] = var48[i];
         }
         var40[var44] = '\0';
     }
     }
     var36 = jsLoadVideo(var40);
-    if (JS_NewNumberValue(cx, var36, &var48) != JS_TRUE) {
+    if (JS_NewNumberValue(cx, var36, &var49) != JS_TRUE) {
         goto do_return;
     }
-    argv[argc+2] = var48;
+    argv[argc+2] = var49;
     if (rval) {
-        *rval = var48;
+        *rval = var49;
     }
     var34 = JS_TRUE;
     do_return:
     if (var47) {
-        JS_free(cx, var40);
+        free(var40);
         var40 = NULL;
         var47 = 0;
     }
@@ -281,870 +286,936 @@
 static JSBool
 jjadmclearSegments(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval)
 {
-    JSObject *var50;
-    int var51;
-    int var54;
-    jsval var55;
-    JSBool var49;
-    var50 = NULL;
-    var51 = 0;
-    var54 = 0;
-    var55 = JSVAL_NULL;
-    var49 = JS_FALSE;
-    var50 = obj;
-    var54 = argc;
-    var51 = jsClearSegments();
-    if (JS_NewNumberValue(cx, var51, &var55) != JS_TRUE) {
+    JSObject * var51;
+    int var52;
+    int var55;
+    jsval var56;
+    JSBool var50;
+    var51 = NULL;
+    var52 = 0;
+    var55 = 0;
+    var56 = JSVAL_NULL;
+    var50 = JS_FALSE;
+    var51 = obj;
+    var55 = argc;
+    var52 = jsClearSegments();
+    if (JS_NewNumberValue(cx, var52, &var56) != JS_TRUE) {
         goto do_return;
     }
-    argv[argc+0] = var55;
+    argv[argc+0] = var56;
     if (rval) {
-        *rval = var55;
+        *rval = var56;
     }
-    var49 = JS_TRUE;
+    var50 = JS_TRUE;
     do_return:
-    return var49;
+    return var50;
 }
 static JSBool
 jjadmappendVideo(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval)
 {
-    JSObject *var57;
-    char *var62;
-    int var58;
-    int var61;
-    int var63;
-    jsval var64;
-    JSString *var65;
-    jsval var238;
-    size_t var66;
+    JSObject * var58;
+    int var59;
+    int var62;
+    char * var63;
+    int var64;
+    jsval var65;
+    JSString * var66;
+    jsval var245;
     size_t var67;
-    int var69;
-    jschar *var68;
-    jsval var239;
-    jsval var70;
-    JSBool var56;
-    var57 = NULL;
-    var62 = NULL;
-    var58 = 0;
-    var61 = 0;
-    var63 = 0;
-    var64 = JSVAL_NULL;
-    var65 = NULL;
-    var238 = JSVAL_NULL;
-    var66 = 0;
+    size_t var68;
+    int var70;
+    jschar * var71;
+    jsval var246;
+    jsval var72;
+    JSBool var57;
+    var58 = NULL;
+    var59 = 0;
+    var62 = 0;
+    var63 = NULL;
+    var64 = 0;
+    var65 = JSVAL_NULL;
+    var66 = NULL;
+    var245 = JSVAL_NULL;
     var67 = 0;
-    var69 = 0;
-    var68 = NULL;
-    var239 = JSVAL_NULL;
-    var70 = JSVAL_NULL;
-    var56 = JS_FALSE;
-    var57 = obj;
-    var61 = argc;
-    var63 = 0;
-    var63 = var63 < var61;
-    if (var63) {
-    var64 = argv[0];
-    var65 = JS_ValueToString(cx, var64);
-    if (!var65) {
+    var68 = 0;
+    var70 = 0;
+    var71 = NULL;
+    var246 = JSVAL_NULL;
+    var72 = JSVAL_NULL;
+    var57 = JS_FALSE;
+    var58 = obj;
+    var62 = argc;
+    var64 = 0;
+    var64 = var64 < var62;
+    if (var64) {
+    var65 = argv[0];
+    var66 = JS_ValueToString(cx, var65);
+    if (!var66) {
         goto do_return;
     }
-    var238 = STRING_TO_JSVAL(var65);
-    argv[argc+0] = var238;
-    var66 = JS_GetStringLength(var65);
-    var67 = 1;
-    var67 += var66;
-    var62 = JS_malloc(cx, var67);
-    if (!var62) {
-        goto do_return;
+    var245 = STRING_TO_JSVAL(var66);
+    argv[argc+0] = var245;
+    var67 = JS_GetStringLength(var66);
+    var68 = 1;
+    var68 += var67;
+#ifdef HAVE_ALLOCA
+    if (var68 < jj_alloca_limit) {
+        var63 = alloca(var68);
+    } else {
+#endif
+        var63 = malloc(var68);
+        if (!var63) {
+            goto do_return;
+        } else {
+            var70 = 1;
+        }
+#ifdef HAVE_ALLOCA
     }
-    var69 = 1;
-    var68 = JS_GetStringChars(var65);
-    var239 = STRING_TO_JSVAL(var65);
-    argv[argc+1] = var239;
+#endif
+    var71 = JS_GetStringChars(var66);
+    var246 = STRING_TO_JSVAL(var66);
+    argv[argc+1] = var246;
     {
         size_t i;
-        for (i = 0; i < var66; ++i) {
-            var62[i] = wctob(var68[i]);
+        for (i = 0; i < var67; ++i) {
+            var63[i] = var71[i];
         }
-        var62[var66] = '\0';
+        var63[var67] = '\0';
     }
     }
-    var58 = jsAppendVideo(var62);
-    if (JS_NewNumberValue(cx, var58, &var70) != JS_TRUE) {
+    var59 = jsAppendVideo(var63);
+    if (JS_NewNumberValue(cx, var59, &var72) != JS_TRUE) {
         goto do_return;
     }
-    argv[argc+2] = var70;
+    argv[argc+2] = var72;
     if (rval) {
-        *rval = var70;
+        *rval = var72;
     }
-    var56 = JS_TRUE;
+    var57 = JS_TRUE;
     do_return:
-    if (var69) {
-        JS_free(cx, var62);
-        var62 = NULL;
-        var69 = 0;
+    if (var70) {
+        free(var63);
+        var63 = NULL;
+        var70 = 0;
     }
-    return var56;
+    return var57;
 }
 static JSBool
 jjadmaddSegment(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval)
 {
-    JSObject *var72;
-    int var77;
-    double var78;
-    double var79;
-    int var73;
-    int var76;
-    int var80;
-    jsval var81;
-    int32 var82;
-    int var83;
-    jsval var84;
-    jsdouble var85;
-    int var86;
-    jsval var87;
-    jsdouble var88;
+    JSObject * var74;
+    int var75;
+    int var78;
+    int var79;
+    int var82;
+    jsval var83;
+    int32 var84;
+    double var80;
+    int var85;
+    jsval var86;
+    jsdouble var87;
+    double var81;
+    int var88;
     jsval var89;
-    JSBool var71;
-    var72 = NULL;
-    var77 = 0;
-    var78 = 0.0;
-    var79 = 0.0;
-    var73 = 0;
-    var76 = 0;
-    var80 = 0;
-    var81 = JSVAL_NULL;
+    jsdouble var90;
+    jsval var91;
+    JSBool var73;
+    var74 = NULL;
+    var75 = 0;
+    var78 = 0;
+    var79 = 0;
     var82 = 0;
-    var83 = 0;
-    var84 = JSVAL_NULL;
-    var85 = 0.0;
-    var86 = 0;
-    var87 = JSVAL_NULL;
-    var88 = 0.0;
+    var83 = JSVAL_NULL;
+    var84 = 0;
+    var80 = 0.0;
+    var85 = 0;
+    var86 = JSVAL_NULL;
+    var87 = 0.0;
+    var81 = 0.0;
+    var88 = 0;
     var89 = JSVAL_NULL;
-    var71 = JS_FALSE;
-    var72 = obj;
-    var76 = argc;
-    var80 = 0;
-    var80 = var80 < var76;
-    if (var80) {
-    var81 = argv[0];
-    if (JS_ValueToInt32(cx, var81, &var82) != JS_TRUE) {
+    var90 = 0.0;
+    var91 = JSVAL_NULL;
+    var73 = JS_FALSE;
+    var74 = obj;
+    var78 = argc;
+    var82 = 0;
+    var82 = var82 < var78;
+    if (var82) {
+    var83 = argv[0];
+    if (JS_ValueToInt32(cx, var83, &var84) != JS_TRUE) {
         goto do_return;
     }
-    var77 = (int)var82;
+    var79 = (int)var84;
     }
-    var83 = 1;
-    var83 = var83 < var76;
-    if (var83) {
-    var84 = argv[1];
-    if (JS_ValueToNumber(cx, var84, &var85) != JS_TRUE) {
+    var85 = 1;
+    var85 = var85 < var78;
+    if (var85) {
+    var86 = argv[1];
+    if (JS_ValueToNumber(cx, var86, &var87) != JS_TRUE) {
         goto do_return;
     }
-    var78 = (double)var85;
+    var80 = (double)var87;
     }
-    var86 = 2;
-    var86 = var86 < var76;
-    if (var86) {
-    var87 = argv[2];
-    if (JS_ValueToNumber(cx, var87, &var88) != JS_TRUE) {
+    var88 = 2;
+    var88 = var88 < var78;
+    if (var88) {
+    var89 = argv[2];
+    if (JS_ValueToNumber(cx, var89, &var90) != JS_TRUE) {
         goto do_return;
     }
-    var79 = (double)var88;
+    var81 = (double)var90;
     }
-    var73 = jsAddSegment(var77, var78, var79);
-    if (JS_NewNumberValue(cx, var73, &var89) != JS_TRUE) {
+    var75 = jsAddSegment(var79, var80, var81);
+    if (JS_NewNumberValue(cx, var75, &var91) != JS_TRUE) {
         goto do_return;
     }
-    argv[argc+0] = var89;
+    argv[argc+0] = var91;
     if (rval) {
-        *rval = var89;
+        *rval = var91;
     }
-    var71 = JS_TRUE;
+    var73 = JS_TRUE;
     do_return:
-    return var71;
+    return var73;
 }
 static JSBool
 jjadmsetPostProc(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval)
 {
-    JSObject *var91;
-    int var96;
+    JSObject * var93;
+    int var94;
     int var97;
     int var98;
-    int var92;
-    int var95;
+    int var101;
+    jsval var102;
+    int32 var103;
     int var99;
-    jsval var100;
-    int32 var101;
-    int var102;
-    jsval var103;
-    int32 var104;
-    int var105;
-    jsval var106;
-    int32 var107;
+    int var104;
+    jsval var105;
+    int32 var106;
+    int var100;
+    int var107;
     jsval var108;
-    JSBool var90;
-    var91 = NULL;
-    var96 = 0;
+    int32 var109;
+    jsval var110;
+    JSBool var92;
+    var93 = NULL;
+    var94 = 0;
     var97 = 0;
     var98 = 0;
-    var92 = 0;
-    var95 = 0;
+    var101 = 0;
+    var102 = JSVAL_NULL;
+    var103 = 0;
     var99 = 0;
-    var100 = JSVAL_NULL;
-    var101 = 0;
-    var102 = 0;
-    var103 = JSVAL_NULL;
     var104 = 0;
-    var105 = 0;
-    var106 = JSVAL_NULL;
+    var105 = JSVAL_NULL;
+    var106 = 0;
+    var100 = 0;
     var107 = 0;
     var108 = JSVAL_NULL;
-    var90 = JS_FALSE;
-    var91 = obj;
-    var95 = argc;
-    var99 = 0;
-    var99 = var99 < var95;
-    if (var99) {
-    var100 = argv[0];
-    if (JS_ValueToInt32(cx, var100, &var101) != JS_TRUE) {
+    var109 = 0;
+    var110 = JSVAL_NULL;
+    var92 = JS_FALSE;
+    var93 = obj;
+    var97 = argc;
+    var101 = 0;
+    var101 = var101 < var97;
+    if (var101) {
+    var102 = argv[0];
+    if (JS_ValueToInt32(cx, var102, &var103) != JS_TRUE) {
         goto do_return;
     }
-    var96 = (int)var101;
+    var98 = (int)var103;
     }
-    var102 = 1;
-    var102 = var102 < var95;
-    if (var102) {
-    var103 = argv[1];
-    if (JS_ValueToInt32(cx, var103, &var104) != JS_TRUE) {
+    var104 = 1;
+    var104 = var104 < var97;
+    if (var104) {
+    var105 = argv[1];
+    if (JS_ValueToInt32(cx, var105, &var106) != JS_TRUE) {
         goto do_return;
     }
-    var97 = (int)var104;
+    var99 = (int)var106;
     }
-    var105 = 2;
-    var105 = var105 < var95;
-    if (var105) {
-    var106 = argv[2];
-    if (JS_ValueToInt32(cx, var106, &var107) != JS_TRUE) {
+    var107 = 2;
+    var107 = var107 < var97;
+    if (var107) {
+    var108 = argv[2];
+    if (JS_ValueToInt32(cx, var108, &var109) != JS_TRUE) {
         goto do_return;
     }
-    var98 = (int)var107;
+    var100 = (int)var109;
     }
-    var92 = jsSetPostProc(var96, var97, var98);
-    if (JS_NewNumberValue(cx, var92, &var108) != JS_TRUE) {
+    var94 = jsSetPostProc(var98, var99, var100);
+    if (JS_NewNumberValue(cx, var94, &var110) != JS_TRUE) {
         goto do_return;
     }
-    argv[argc+0] = var108;
+    argv[argc+0] = var110;
     if (rval) {
-        *rval = var108;
+        *rval = var110;
     }
-    var90 = JS_TRUE;
+    var92 = JS_TRUE;
     do_return:
-    return var90;
+    return var92;
 }
 static JSBool
 jjadmgetWidth(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval)
 {
-    JSObject *var110;
-    int var111;
-    int var114;
-    jsval var115;
-    JSBool var109;
-    var110 = NULL;
-    var111 = 0;
-    var114 = 0;
-    var115 = JSVAL_NULL;
-    var109 = JS_FALSE;
-    var110 = obj;
-    var114 = argc;
-    var111 = jsGetWidth();
-    if (JS_NewNumberValue(cx, var111, &var115) != JS_TRUE) {
+    JSObject * var112;
+    int var113;
+    int var116;
+    jsval var117;
+    JSBool var111;
+    var112 = NULL;
+    var113 = 0;
+    var116 = 0;
+    var117 = JSVAL_NULL;
+    var111 = JS_FALSE;
+    var112 = obj;
+    var116 = argc;
+    var113 = jsGetWidth();
+    if (JS_NewNumberValue(cx, var113, &var117) != JS_TRUE) {
         goto do_return;
     }
-    argv[argc+0] = var115;
+    argv[argc+0] = var117;
     if (rval) {
-        *rval = var115;
+        *rval = var117;
     }
-    var109 = JS_TRUE;
+    var111 = JS_TRUE;
     do_return:
-    return var109;
+    return var111;
 }
 static JSBool
 jjadmgetHeight(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval)
 {
-    JSObject *var117;
-    int var118;
-    int var121;
-    jsval var122;
-    JSBool var116;
-    var117 = NULL;
-    var118 = 0;
-    var121 = 0;
-    var122 = JSVAL_NULL;
-    var116 = JS_FALSE;
-    var117 = obj;
-    var121 = argc;
-    var118 = jsGetHeight();
-    if (JS_NewNumberValue(cx, var118, &var122) != JS_TRUE) {
+    JSObject * var119;
+    int var120;
+    int var123;
+    jsval var124;
+    JSBool var118;
+    var119 = NULL;
+    var120 = 0;
+    var123 = 0;
+    var124 = JSVAL_NULL;
+    var118 = JS_FALSE;
+    var119 = obj;
+    var123 = argc;
+    var120 = jsGetHeight();
+    if (JS_NewNumberValue(cx, var120, &var124) != JS_TRUE) {
         goto do_return;
     }
-    argv[argc+0] = var122;
+    argv[argc+0] = var124;
     if (rval) {
-        *rval = var122;
+        *rval = var124;
     }
-    var116 = JS_TRUE;
+    var118 = JS_TRUE;
     do_return:
-    return var116;
+    return var118;
 }
 static JSBool
 jjadmgetFps1000(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval)
 {
-    JSObject *var124;
-    int var125;
-    int var128;
-    jsval var129;
-    JSBool var123;
-    var124 = NULL;
-    var125 = 0;
-    var128 = 0;
-    var129 = JSVAL_NULL;
-    var123 = JS_FALSE;
-    var124 = obj;
-    var128 = argc;
-    var125 = jsGetFps1000();
-    if (JS_NewNumberValue(cx, var125, &var129) != JS_TRUE) {
+    JSObject * var126;
+    int var127;
+    int var130;
+    jsval var131;
+    JSBool var125;
+    var126 = NULL;
+    var127 = 0;
+    var130 = 0;
+    var131 = JSVAL_NULL;
+    var125 = JS_FALSE;
+    var126 = obj;
+    var130 = argc;
+    var127 = jsGetFps1000();
+    if (JS_NewNumberValue(cx, var127, &var131) != JS_TRUE) {
         goto do_return;
     }
-    argv[argc+0] = var129;
+    argv[argc+0] = var131;
     if (rval) {
-        *rval = var129;
+        *rval = var131;
     }
-    var123 = JS_TRUE;
+    var125 = JS_TRUE;
     do_return:
-    return var123;
+    return var125;
 }
 static JSBool
 jjadmgetVideoCodec(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval)
 {
-    JSObject *var131;
-    char *var132;
-    int var135;
-    jsval var136;
-    JSString *var137;
-    jsval var246;
-    char *var138;
-    jsval var247;
-    JSBool var130;
-    var131 = NULL;
-    var132 = NULL;
-    var135 = 0;
-    var136 = JSVAL_NULL;
-    var137 = NULL;
-    var246 = JSVAL_NULL;
-    var138 = NULL;
-    var247 = JSVAL_NULL;
-    var130 = JS_FALSE;
-    var131 = obj;
-    var135 = argc;
-    var132 = jsGetVideoCodec();
-    if (var132) {
-    var137 = JS_NewStringCopyZ(cx, var132);
-    if (!var137) {
+    JSObject * var133;
+    char * var134;
+    int var137;
+    jsval var138;
+    JSString * var139;
+    jsval var253;
+    char * var140;
+    jsval var254;
+    JSBool var132;
+    var133 = NULL;
+    var134 = NULL;
+    var137 = 0;
+    var138 = JSVAL_NULL;
+    var139 = NULL;
+    var253 = JSVAL_NULL;
+    var140 = NULL;
+    var254 = JSVAL_NULL;
+    var132 = JS_FALSE;
+    var133 = obj;
+    var137 = argc;
+    var134 = jsGetVideoCodec();
+    if (var134) {
+    var139 = JS_NewStringCopyZ(cx, var134);
+    if (!var139) {
         goto do_return;
     }
-    var246 = STRING_TO_JSVAL(var137);
-    argv[argc+0] = var246;
+    var253 = STRING_TO_JSVAL(var139);
+    argv[argc+0] = var253;
     } else {
-    var138 = "";
-    var137 = JS_InternString(cx, var138);
-    if (!var137) {
+    var140 = "";
+    var139 = JS_InternString(cx, var140);
+    if (!var139) {
         goto do_return;
     }
-    var247 = STRING_TO_JSVAL(var137);
-    argv[argc+1] = var247;
+    var254 = STRING_TO_JSVAL(var139);
+    argv[argc+1] = var254;
     }
-    var136 = STRING_TO_JSVAL(var137);
+    var138 = STRING_TO_JSVAL(var139);
     if (rval) {
-        *rval = var136;
+        *rval = var138;
     }
-    var130 = JS_TRUE;
+    var132 = JS_TRUE;
     do_return:
-    return var130;
+    return var132;
 }
 static JSBool
 jjadmaudioReset(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval)
 {
-    JSObject *var140;
-    int var141;
-    int var144;
-    jsval var145;
-    JSBool var139;
-    var140 = NULL;
-    var141 = 0;
-    var144 = 0;
-    var145 = JSVAL_NULL;
-    var139 = JS_FALSE;
-    var140 = obj;
-    var144 = argc;
-    var141 = jsAudioReset();
-    if (JS_NewNumberValue(cx, var141, &var145) != JS_TRUE) {
+    JSObject * var142;
+    int var143;
+    int var146;
+    jsval var147;
+    JSBool var141;
+    var142 = NULL;
+    var143 = 0;
+    var146 = 0;
+    var147 = JSVAL_NULL;
+    var141 = JS_FALSE;
+    var142 = obj;
+    var146 = argc;
+    var143 = jsAudioReset();
+    if (JS_NewNumberValue(cx, var143, &var147) != JS_TRUE) {
         goto do_return;
     }
-    argv[argc+0] = var145;
+    argv[argc+0] = var147;
     if (rval) {
-        *rval = var145;
+        *rval = var147;
     }
-    var139 = JS_TRUE;
+    var141 = JS_TRUE;
     do_return:
-    return var139;
+    return var141;
 }
 static JSBool
 jjadmaudioMixer(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval)
 {
-    JSObject *var147;
-    char *var152;
-    int var148;
-    int var151;
+    JSObject * var149;
+    int var150;
     int var153;
-    jsval var154;
-    JSString *var155;
-    jsval var249;
-    size_t var156;
-    size_t var157;
-    int var159;
-    jschar *var158;
-    jsval var250;
-    jsval var160;
-    JSBool var146;
-    var147 = NULL;
-    var152 = NULL;
-    var148 = 0;
-    var151 = 0;
+    char * var154;
+    int var155;
+    jsval var156;
+    JSString * var157;
+    jsval var256;
+    size_t var158;
+    size_t var159;
+    int var161;
+    jschar * var162;
+    jsval var257;
+    jsval var163;
+    JSBool var148;
+    var149 = NULL;
+    var150 = 0;
     var153 = 0;
-    var154 = JSVAL_NULL;
-    var155 = NULL;
-    var249 = JSVAL_NULL;
-    var156 = 0;
-    var157 = 0;
+    var154 = NULL;
+    var155 = 0;
+    var156 = JSVAL_NULL;
+    var157 = NULL;
+    var256 = JSVAL_NULL;
+    var158 = 0;
     var159 = 0;
-    var158 = NULL;
-    var250 = JSVAL_NULL;
-    var160 = JSVAL_NULL;
-    var146 = JS_FALSE;
-    var147 = obj;
-    var151 = argc;
-    var153 = 0;
-    var153 = var153 < var151;
-    if (var153) {
-    var154 = argv[0];
-    var155 = JS_ValueToString(cx, var154);
-    if (!var155) {
+    var161 = 0;
+    var162 = NULL;
+    var257 = JSVAL_NULL;
+    var163 = JSVAL_NULL;
+    var148 = JS_FALSE;
+    var149 = obj;
+    var153 = argc;
+    var155 = 0;
+    var155 = var155 < var153;
+    if (var155) {
+    var156 = argv[0];
+    var157 = JS_ValueToString(cx, var156);
+    if (!var157) {
         goto do_return;
     }
-    var249 = STRING_TO_JSVAL(var155);
-    argv[argc+0] = var249;
-    var156 = JS_GetStringLength(var155);
-    var157 = 1;
-    var157 += var156;
-    var152 = JS_malloc(cx, var157);
-    if (!var152) {
-        goto do_return;
+    var256 = STRING_TO_JSVAL(var157);
+    argv[argc+0] = var256;
+    var158 = JS_GetStringLength(var157);
+    var159 = 1;
+    var159 += var158;
+#ifdef HAVE_ALLOCA
+    if (var159 < jj_alloca_limit) {
+        var154 = alloca(var159);
+    } else {
+#endif
+        var154 = malloc(var159);
+        if (!var154) {
+            goto do_return;
+        } else {
+            var161 = 1;
+        }
+#ifdef HAVE_ALLOCA
     }
-    var159 = 1;
-    var158 = JS_GetStringChars(var155);
-    var250 = STRING_TO_JSVAL(var155);
-    argv[argc+1] = var250;
+#endif
+    var162 = JS_GetStringChars(var157);
+    var257 = STRING_TO_JSVAL(var157);
+    argv[argc+1] = var257;
     {
         size_t i;
-        for (i = 0; i < var156; ++i) {
-            var152[i] = wctob(var158[i]);
+        for (i = 0; i < var158; ++i) {
+            var154[i] = var162[i];
         }
-        var152[var156] = '\0';
+        var154[var158] = '\0';
     }
     }
-    var148 = jsAudioMixer(var152);
-    if (JS_NewNumberValue(cx, var148, &var160) != JS_TRUE) {
+    var150 = jsAudioMixer(var154);
+    if (JS_NewNumberValue(cx, var150, &var163) != JS_TRUE) {
         goto do_return;
     }
-    argv[argc+2] = var160;
+    argv[argc+2] = var163;
     if (rval) {
-        *rval = var160;
+        *rval = var163;
     }
-    var146 = JS_TRUE;
+    var148 = JS_TRUE;
     do_return:
-    if (var159) {
-        JS_free(cx, var152);
-        var152 = NULL;
-        var159 = 0;
+    if (var161) {
+        free(var154);
+        var154 = NULL;
+        var161 = 0;
     }
-    return var146;
+    return var148;
 }
 static JSBool
 jjadmclearVideoFilters(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval)
 {
-    JSObject *var162;
-    int var163;
+    JSObject * var165;
     int var166;
-    jsval var167;
-    JSBool var161;
-    var162 = NULL;
-    var163 = 0;
+    int var169;
+    jsval var170;
+    JSBool var164;
+    var165 = NULL;
     var166 = 0;
-    var167 = JSVAL_NULL;
-    var161 = JS_FALSE;
-    var162 = obj;
-    var166 = argc;
-    var163 = jsClearVideoFilters();
-    if (JS_NewNumberValue(cx, var163, &var167) != JS_TRUE) {
+    var169 = 0;
+    var170 = JSVAL_NULL;
+    var164 = JS_FALSE;
+    var165 = obj;
+    var169 = argc;
+    var166 = jsClearVideoFilters();
+    if (JS_NewNumberValue(cx, var166, &var170) != JS_TRUE) {
         goto do_return;
     }
-    argv[argc+0] = var167;
+    argv[argc+0] = var170;
     if (rval) {
-        *rval = var167;
+        *rval = var170;
     }
-    var161 = JS_TRUE;
+    var164 = JS_TRUE;
     do_return:
-    return var161;
+    return var164;
 }
 static JSBool
 jjadmvideoCodec_ignore(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval)
 {
-    JSObject *var169;
-    char *var174;
-    int var170;
+    JSObject * var172;
     int var173;
-    int var175;
-    jsval var176;
-    JSString *var177;
-    jsval var253;
-    size_t var178;
-    size_t var179;
-    int var181;
-    jschar *var180;
-    jsval var254;
-    jsval var182;
-    JSBool var168;
-    var169 = NULL;
-    var174 = NULL;
-    var170 = 0;
+    int var176;
+    char * var177;
+    int var178;
+    jsval var179;
+    JSString * var180;
+    jsval var260;
+    size_t var181;
+    size_t var182;
+    int var184;
+    jschar * var185;
+    jsval var261;
+    jsval var186;
+    JSBool var171;
+    var172 = NULL;
     var173 = 0;
-    var175 = 0;
-    var176 = JSVAL_NULL;
+    var176 = 0;
     var177 = NULL;
-    var253 = JSVAL_NULL;
     var178 = 0;
-    var179 = 0;
+    var179 = JSVAL_NULL;
+    var180 = NULL;
+    var260 = JSVAL_NULL;
     var181 = 0;
-    var180 = NULL;
-    var254 = JSVAL_NULL;
-    var182 = JSVAL_NULL;
-    var168 = JS_FALSE;
-    var169 = obj;
-    var173 = argc;
-    var175 = 0;
-    var175 = var175 < var173;
-    if (var175) {
-    var176 = argv[0];
-    var177 = JS_ValueToString(cx, var176);
-    if (!var177) {
+    var182 = 0;
+    var184 = 0;
+    var185 = NULL;
+    var261 = JSVAL_NULL;
+    var186 = JSVAL_NULL;
+    var171 = JS_FALSE;
+    var172 = obj;
+    var176 = argc;
+    var178 = 0;
+    var178 = var178 < var176;
+    if (var178) {
+    var179 = argv[0];
+    var180 = JS_ValueToString(cx, var179);
+    if (!var180) {
         goto do_return;
     }
-    var253 = STRING_TO_JSVAL(var177);
-    argv[argc+0] = var253;
-    var178 = JS_GetStringLength(var177);
-    var179 = 1;
-    var179 += var178;
-    var174 = JS_malloc(cx, var179);
-    if (!var174) {
-        goto do_return;
+    var260 = STRING_TO_JSVAL(var180);
+    argv[argc+0] = var260;
+    var181 = JS_GetStringLength(var180);
+    var182 = 1;
+    var182 += var181;
+#ifdef HAVE_ALLOCA
+    if (var182 < jj_alloca_limit) {
+        var177 = alloca(var182);
+    } else {
+#endif
+        var177 = malloc(var182);
+        if (!var177) {
+            goto do_return;
+        } else {
+            var184 = 1;
+        }
+#ifdef HAVE_ALLOCA
     }
-    var181 = 1;
-    var180 = JS_GetStringChars(var177);
-    var254 = STRING_TO_JSVAL(var177);
-    argv[argc+1] = var254;
+#endif
+    var185 = JS_GetStringChars(var180);
+    var261 = STRING_TO_JSVAL(var180);
+    argv[argc+1] = var261;
     {
         size_t i;
-        for (i = 0; i < var178; ++i) {
-            var174[i] = wctob(var180[i]);
+        for (i = 0; i < var181; ++i) {
+            var177[i] = var185[i];
         }
-        var174[var178] = '\0';
+        var177[var181] = '\0';
     }
     }
-    var170 = jsVideoCodec(var174);
-    if (JS_NewNumberValue(cx, var170, &var182) != JS_TRUE) {
+    var173 = jsVideoCodec(var177);
+    if (JS_NewNumberValue(cx, var173, &var186) != JS_TRUE) {
         goto do_return;
     }
-    argv[argc+2] = var182;
+    argv[argc+2] = var186;
     if (rval) {
-        *rval = var182;
+        *rval = var186;
     }
-    var168 = JS_TRUE;
+    var171 = JS_TRUE;
     do_return:
-    if (var181) {
-        JS_free(cx, var174);
-        var174 = NULL;
-        var181 = 0;
+    if (var184) {
+        free(var177);
+        var177 = NULL;
+        var184 = 0;
     }
-    return var168;
+    return var171;
 }
 static JSBool
 jjadmaddVideoFilter_ignore(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval)
 {
-    JSObject *var184;
-    char *var189;
-    int var185;
-    int var188;
-    int var190;
-    jsval var191;
-    JSString *var192;
-    jsval var256;
-    size_t var193;
-    size_t var194;
-    int var196;
-    jschar *var195;
-    jsval var257;
-    jsval var197;
-    JSBool var183;
-    var184 = NULL;
-    var189 = NULL;
-    var185 = 0;
-    var188 = 0;
-    var190 = 0;
-    var191 = JSVAL_NULL;
-    var192 = NULL;
-    var256 = JSVAL_NULL;
-    var193 = 0;
+    JSObject * var188;
+    int var189;
+    int var192;
+    char * var193;
+    int var194;
+    jsval var195;
+    JSString * var196;
+    jsval var263;
+    size_t var197;
+    size_t var198;
+    int var200;
+    jschar * var201;
+    jsval var264;
+    jsval var202;
+    JSBool var187;
+    var188 = NULL;
+    var189 = 0;
+    var192 = 0;
+    var193 = NULL;
     var194 = 0;
-    var196 = 0;
-    var195 = NULL;
-    var257 = JSVAL_NULL;
-    var197 = JSVAL_NULL;
-    var183 = JS_FALSE;
-    var184 = obj;
-    var188 = argc;
-    var190 = 0;
-    var190 = var190 < var188;
-    if (var190) {
-    var191 = argv[0];
-    var192 = JS_ValueToString(cx, var191);
-    if (!var192) {
+    var195 = JSVAL_NULL;
+    var196 = NULL;
+    var263 = JSVAL_NULL;
+    var197 = 0;
+    var198 = 0;
+    var200 = 0;
+    var201 = NULL;
+    var264 = JSVAL_NULL;
+    var202 = JSVAL_NULL;
+    var187 = JS_FALSE;
+    var188 = obj;
+    var192 = argc;
+    var194 = 0;
+    var194 = var194 < var192;
+    if (var194) {
+    var195 = argv[0];
+    var196 = JS_ValueToString(cx, var195);
+    if (!var196) {
         goto do_return;
     }
-    var256 = STRING_TO_JSVAL(var192);
-    argv[argc+0] = var256;
-    var193 = JS_GetStringLength(var192);
-    var194 = 1;
-    var194 += var193;
-    var189 = JS_malloc(cx, var194);
-    if (!var189) {
-        goto do_return;
+    var263 = STRING_TO_JSVAL(var196);
+    argv[argc+0] = var263;
+    var197 = JS_GetStringLength(var196);
+    var198 = 1;
+    var198 += var197;
+#ifdef HAVE_ALLOCA
+    if (var198 < jj_alloca_limit) {
+        var193 = alloca(var198);
+    } else {
+#endif
+        var193 = malloc(var198);
+        if (!var193) {
+            goto do_return;
+        } else {
+            var200 = 1;
+        }
+#ifdef HAVE_ALLOCA
     }
-    var196 = 1;
-    var195 = JS_GetStringChars(var192);
-    var257 = STRING_TO_JSVAL(var192);
-    argv[argc+1] = var257;
+#endif
+    var201 = JS_GetStringChars(var196);
+    var264 = STRING_TO_JSVAL(var196);
+    argv[argc+1] = var264;
     {
         size_t i;
-        for (i = 0; i < var193; ++i) {
-            var189[i] = wctob(var195[i]);
+        for (i = 0; i < var197; ++i) {
+            var193[i] = var201[i];
         }
-        var189[var193] = '\0';
+        var193[var197] = '\0';
     }
     }
-    var185 = jsVideoFilter(var189);
-    if (JS_NewNumberValue(cx, var185, &var197) != JS_TRUE) {
+    var189 = jsVideoFilter(var193);
+    if (JS_NewNumberValue(cx, var189, &var202) != JS_TRUE) {
         goto do_return;
     }
-    argv[argc+2] = var197;
+    argv[argc+2] = var202;
     if (rval) {
-        *rval = var197;
+        *rval = var202;
     }
-    var183 = JS_TRUE;
+    var187 = JS_TRUE;
     do_return:
-    if (var196) {
-        JS_free(cx, var189);
-        var189 = NULL;
-        var196 = 0;
+    if (var200) {
+        free(var193);
+        var193 = NULL;
+        var200 = 0;
     }
-    return var183;
+    return var187;
 }
 static JSBool
 jjadmaudioCodec_ignore(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval)
 {
-    JSObject *var199;
-    char *var204;
-    int var200;
-    int var203;
+    JSObject * var204;
     int var205;
-    jsval var206;
-    JSString *var207;
-    jsval var259;
-    size_t var208;
-    size_t var209;
-    int var211;
-    jschar *var210;
-    jsval var260;
-    jsval var212;
-    JSBool var198;
-    var199 = NULL;
+    int var208;
+    char * var209;
+    int var210;
+    jsval var211;
+    JSString * var212;
+    jsval var266;
+    size_t var213;
+    size_t var214;
+    int var216;
+    jschar * var217;
+    jsval var267;
+    jsval var218;
+    JSBool var203;
     var204 = NULL;
-    var200 = 0;
-    var203 = 0;
     var205 = 0;
-    var206 = JSVAL_NULL;
-    var207 = NULL;
-    var259 = JSVAL_NULL;
     var208 = 0;
-    var209 = 0;
-    var211 = 0;
-    var210 = NULL;
-    var260 = JSVAL_NULL;
-    var212 = JSVAL_NULL;
-    var198 = JS_FALSE;
-    var199 = obj;
-    var203 = argc;
-    var205 = 0;
-    var205 = var205 < var203;
-    if (var205) {
-    var206 = argv[0];
-    var207 = JS_ValueToString(cx, var206);
-    if (!var207) {
+    var209 = NULL;
+    var210 = 0;
+    var211 = JSVAL_NULL;
+    var212 = NULL;
+    var266 = JSVAL_NULL;
+    var213 = 0;
+    var214 = 0;
+    var216 = 0;
+    var217 = NULL;
+    var267 = JSVAL_NULL;
+    var218 = JSVAL_NULL;
+    var203 = JS_FALSE;
+    var204 = obj;
+    var208 = argc;
+    var210 = 0;
+    var210 = var210 < var208;
+    if (var210) {
+    var211 = argv[0];
+    var212 = JS_ValueToString(cx, var211);
+    if (!var212) {
         goto do_return;
     }
-    var259 = STRING_TO_JSVAL(var207);
-    argv[argc+0] = var259;
-    var208 = JS_GetStringLength(var207);
-    var209 = 1;
-    var209 += var208;
-    var204 = JS_malloc(cx, var209);
-    if (!var204) {
-        goto do_return;
+    var266 = STRING_TO_JSVAL(var212);
+    argv[argc+0] = var266;
+    var213 = JS_GetStringLength(var212);
+    var214 = 1;
+    var214 += var213;
+#ifdef HAVE_ALLOCA
+    if (var214 < jj_alloca_limit) {
+        var209 = alloca(var214);
+    } else {
+#endif
+        var209 = malloc(var214);
+        if (!var209) {
+            goto do_return;
+        } else {
+            var216 = 1;
+        }
+#ifdef HAVE_ALLOCA
     }
-    var211 = 1;
-    var210 = JS_GetStringChars(var207);
-    var260 = STRING_TO_JSVAL(var207);
-    argv[argc+1] = var260;
+#endif
+    var217 = JS_GetStringChars(var212);
+    var267 = STRING_TO_JSVAL(var212);
+    argv[argc+1] = var267;
     {
         size_t i;
-        for (i = 0; i < var208; ++i) {
-            var204[i] = wctob(var210[i]);
+        for (i = 0; i < var213; ++i) {
+            var209[i] = var217[i];
         }
-        var204[var208] = '\0';
+        var209[var213] = '\0';
     }
     }
-    var200 = jsAudioCodec(var204);
-    if (JS_NewNumberValue(cx, var200, &var212) != JS_TRUE) {
+    var205 = jsAudioCodec(var209);
+    if (JS_NewNumberValue(cx, var205, &var218) != JS_TRUE) {
         goto do_return;
     }
-    argv[argc+2] = var212;
+    argv[argc+2] = var218;
     if (rval) {
-        *rval = var212;
+        *rval = var218;
     }
-    var198 = JS_TRUE;
+    var203 = JS_TRUE;
     do_return:
-    if (var211) {
-        JS_free(cx, var204);
-        var204 = NULL;
-        var211 = 0;
+    if (var216) {
+        free(var209);
+        var209 = NULL;
+        var216 = 0;
     }
-    return var198;
+    return var203;
 }
 static JSBool
 jjadmsetContainer_ignore(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval)
 {
-    JSObject *var214;
-    char *var219;
-    int var215;
-    int var218;
-    int var220;
-    jsval var221;
-    JSString *var222;
-    jsval var262;
-    size_t var223;
-    size_t var224;
+    JSObject * var220;
+    int var221;
+    int var224;
+    char * var225;
     int var226;
-    jschar *var225;
-    jsval var263;
     jsval var227;
-    JSBool var213;
-    var214 = NULL;
-    var219 = NULL;
-    var215 = 0;
-    var218 = 0;
-    var220 = 0;
-    var221 = JSVAL_NULL;
-    var222 = NULL;
-    var262 = JSVAL_NULL;
-    var223 = 0;
+    JSString * var228;
+    jsval var269;
+    size_t var229;
+    size_t var230;
+    int var232;
+    jschar * var233;
+    jsval var270;
+    jsval var234;
+    JSBool var219;
+    var220 = NULL;
+    var221 = 0;
     var224 = 0;
+    var225 = NULL;
     var226 = 0;
-    var225 = NULL;
-    var263 = JSVAL_NULL;
     var227 = JSVAL_NULL;
-    var213 = JS_FALSE;
-    var214 = obj;
-    var218 = argc;
-    var220 = 0;
-    var220 = var220 < var218;
-    if (var220) {
-    var221 = argv[0];
-    var222 = JS_ValueToString(cx, var221);
-    if (!var222) {
+    var228 = NULL;
+    var269 = JSVAL_NULL;
+    var229 = 0;
+    var230 = 0;
+    var232 = 0;
+    var233 = NULL;
+    var270 = JSVAL_NULL;
+    var234 = JSVAL_NULL;
+    var219 = JS_FALSE;
+    var220 = obj;
+    var224 = argc;
+    var226 = 0;
+    var226 = var226 < var224;
+    if (var226) {
+    var227 = argv[0];
+    var228 = JS_ValueToString(cx, var227);
+    if (!var228) {
         goto do_return;
     }
-    var262 = STRING_TO_JSVAL(var222);
-    argv[argc+0] = var262;
-    var223 = JS_GetStringLength(var222);
-    var224 = 1;
-    var224 += var223;
-    var219 = JS_malloc(cx, var224);
-    if (!var219) {
-        goto do_return;
+    var269 = STRING_TO_JSVAL(var228);
+    argv[argc+0] = var269;
+    var229 = JS_GetStringLength(var228);
+    var230 = 1;
+    var230 += var229;
+#ifdef HAVE_ALLOCA
+    if (var230 < jj_alloca_limit) {
+        var225 = alloca(var230);
+    } else {
+#endif
+        var225 = malloc(var230);
+        if (!var225) {
+            goto do_return;
+        } else {
+            var232 = 1;
+        }
+#ifdef HAVE_ALLOCA
     }
-    var226 = 1;
-    var225 = JS_GetStringChars(var222);
-    var263 = STRING_TO_JSVAL(var222);
-    argv[argc+1] = var263;
+#endif
+    var233 = JS_GetStringChars(var228);
+    var270 = STRING_TO_JSVAL(var228);
+    argv[argc+1] = var270;
     {
         size_t i;
-        for (i = 0; i < var223; ++i) {
-            var219[i] = wctob(var225[i]);
+        for (i = 0; i < var229; ++i) {
+            var225[i] = var233[i];
         }
-        var219[var223] = '\0';
+        var225[var229] = '\0';
     }
     }
-    var215 = jsSetContainer(var219);
-    if (JS_NewNumberValue(cx, var215, &var227) != JS_TRUE) {
+    var221 = jsSetContainer(var225);
+    if (JS_NewNumberValue(cx, var221, &var234) != JS_TRUE) {
         goto do_return;
     }
-    argv[argc+2] = var227;
+    argv[argc+2] = var234;
     if (rval) {
-        *rval = var227;
+        *rval = var234;
     }
-    var213 = JS_TRUE;
+    var219 = JS_TRUE;
     do_return:
-    if (var226) {
-        JS_free(cx, var219);
-        var219 = NULL;
-        var226 = 0;
+    if (var232) {
+        free(var225);
+        var225 = NULL;
+        var232 = 0;
     }
-    return var213;
+    return var219;
 }
 static JSBool
 jjadm__construct__(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval)
 {
-    JSObject *var229;
-    int var233;
-    JSBool var228;
-    var229 = NULL;
-    var233 = 0;
-    var228 = JS_FALSE;
-    var229 = obj;
-    var233 = argc;
+    JSObject * var236;
+    int var240;
+    JSBool var235;
+    var236 = NULL;
+    var240 = 0;
+    var235 = JS_FALSE;
+    var236 = obj;
+    var240 = argc;
     jsAvidemux();
-    var228 = JS_TRUE;
-    return var228;
+    var235 = JS_TRUE;
+    return var235;
 }
+static JSPropertySpec jj_static_ps[] = {
+    {NULL, 0, 0, NULL, NULL}
+};
+static JSPropertySpec jj_ps[] = {
+    {NULL, 0, 0, NULL, NULL}
+};
+static JSFunctionSpec jj_static_fs[] = {
+    JS_FS_END
+};
+static JSFunctionSpec jj_fs[] = {
+    JS_FS_END
+};
 static JSPropertySpec jjadm_static_ps[] = {
     {"markerA", 0, 0|JSPROP_ENUMERATE, jjadmmarkerA_get, jjadmmarkerA_set},
     {"markerB", 0, 0|JSPROP_ENUMERATE, jjadmmarkerB_get, jjadmmarkerB_set},

Modified: branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src/ADM_jsEditor_js.c
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src/ADM_jsEditor_js.c	2010-05-08 08:04:34 UTC (rev 6161)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src/ADM_jsEditor_js.c	2010-05-08 16:14:59 UTC (rev 6162)
@@ -20,8 +20,15 @@
         printf("Constructor invoked\n");
 }
 
+#ifdef HAVE_ALLOCA_H
+#include <alloca.h>
+static size_t jj_alloca_limit = 0;
+#endif
+#include <stdlib.h>
 #include <string.h>
 #include <wchar.h>
+#ifdef HAVE_ALLOCA_H
+#endif
 #include <jsapi.h>
 #ifndef JS_THREADSAFE
 #if JS_VERSION <= 170
@@ -38,34 +45,23 @@
 #ifndef JS_FS_END
 #define JS_FS_END {NULL, NULL, 0, 0, 0}
 #endif
-static JSPropertySpec jj_static_ps[] = {
-    {NULL, 0, 0, NULL, NULL}
-};
-static JSPropertySpec jj_ps[] = {
-    {NULL, 0, 0, NULL, NULL}
-};
-static JSFunctionSpec jj_static_fs[] = {
-    JS_FS_END
-};
-static JSFunctionSpec jj_fs[] = {
-    JS_FS_END
-};
+
 static JSBool
 jjeditorprintTiming(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval)
 {
-    JSObject *var2;
-    int var7;
+    JSObject * var2;
     int var3;
     int var6;
+    int var7;
     int var8;
     jsval var9;
     int32 var10;
     jsval var11;
     JSBool var1;
     var2 = NULL;
-    var7 = 0;
     var3 = 0;
     var6 = 0;
+    var7 = 0;
     var8 = 0;
     var9 = JSVAL_NULL;
     var10 = 0;
@@ -97,7 +93,7 @@
 static JSBool
 jjeditordumpSegment(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval)
 {
-    JSObject *var13;
+    JSObject * var13;
     int var14;
     int var17;
     jsval var18;
@@ -124,7 +120,7 @@
 static JSBool
 jjeditor__construct__(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval)
 {
-    JSObject *var20;
+    JSObject * var20;
     int var24;
     JSBool var19;
     var20 = NULL;
@@ -136,6 +132,18 @@
     var19 = JS_TRUE;
     return var19;
 }
+static JSPropertySpec jj_static_ps[] = {
+    {NULL, 0, 0, NULL, NULL}
+};
+static JSPropertySpec jj_ps[] = {
+    {NULL, 0, 0, NULL, NULL}
+};
+static JSFunctionSpec jj_static_fs[] = {
+    JS_FS_END
+};
+static JSFunctionSpec jj_fs[] = {
+    JS_FS_END
+};
 static JSPropertySpec jjeditor_static_ps[] = {
     {NULL, 0, 0, NULL, NULL}
 };

Modified: branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src/ADM_jsIf_js.c
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src/ADM_jsIf_js.c	2010-05-08 08:04:34 UTC (rev 6161)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src/ADM_jsIf_js.c	2010-05-08 16:14:59 UTC (rev 6162)
@@ -107,7 +107,7 @@
     {
         size_t i;
         for (i = 0; i < var11; ++i) {
-            var7[i] = wctob(var15[i]);
+            var7[i] = var15[i];
         }
         var7[var11] = '\0';
     }
@@ -186,7 +186,7 @@
     {
         size_t i;
         for (i = 0; i < var26; ++i) {
-            var22[i] = wctob(var30[i]);
+            var22[i] = var30[i];
         }
         var22[var26] = '\0';
     }
@@ -265,7 +265,7 @@
     {
         size_t i;
         for (i = 0; i < var41; ++i) {
-            var37[i] = wctob(var45[i]);
+            var37[i] = var45[i];
         }
         var37[var41] = '\0';
     }
@@ -344,7 +344,7 @@
     {
         size_t i;
         for (i = 0; i < var56; ++i) {
-            var52[i] = wctob(var60[i]);
+            var52[i] = var60[i];
         }
         var52[var56] = '\0';
     }
@@ -423,7 +423,7 @@
     {
         size_t i;
         for (i = 0; i < var71; ++i) {
-            var67[i] = wctob(var75[i]);
+            var67[i] = var75[i];
         }
         var67[var71] = '\0';
     }



From mean at mail.berlios.de  Sat May  8 18:15:02 2010
From: mean at mail.berlios.de (mean at BerliOS)
Date: Sat, 8 May 2010 18:15:02 +0200
Subject: [Avidemux-svn-commit] r6163 -
	branches/avidemux_2.6_branch_mean/avidemux_core/ADM_smjs
Message-ID: <201005081615.o48GF2AT013336@sheep.berlios.de>

Author: mean
Date: 2010-05-08 18:15:01 +0200 (Sat, 08 May 2010)
New Revision: 6163

Modified:
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_smjs/CMakeLists.txt
Log:
[smjs] Enable utf8

Modified: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_smjs/CMakeLists.txt
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_smjs/CMakeLists.txt	2010-05-08 16:14:59 UTC (rev 6162)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_smjs/CMakeLists.txt	2010-05-08 16:15:01 UTC (rev 6163)
@@ -22,6 +22,7 @@
 ADD_TARGET_CFLAGS(${ADM_LIB} "-Dfree=ADM_dezalloc")
 ADD_TARGET_CFLAGS(${ADM_LIB} "-Dcalloc=ADM_calloc -I/usr/include/nspr")
 ADD_TARGET_CFLAGS(${ADM_LIB} "-Dfopen=ADM_fopen")
+ADD_TARGET_CFLAGS(${ADM_LIB} "-DJS_C_STRINGS_ARE_UTF8")
 
 TARGET_LINK_LIBRARIES(${ADM_LIB} ADM_core6)
 



From mean at mail.berlios.de  Sat May  8 18:15:03 2010
From: mean at mail.berlios.de (mean at BerliOS)
Date: Sat, 8 May 2010 18:15:03 +0200
Subject: [Avidemux-svn-commit] r6164 - in
	branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2:
	include src
Message-ID: <201005081615.o48GF3i2013364@sheep.berlios.de>

Author: mean
Date: 2010-05-08 18:15:03 +0200 (Sat, 08 May 2010)
New Revision: 6164

Modified:
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/include/ADM_jsEditor.h
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src/ADM_jsEditor.cpp
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src/ADM_jsEditor_js.c
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src/ADM_jsEditor_js.idl
Log:
[JS] Add dumpRefVideo command

Modified: branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/include/ADM_jsEditor.h
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/include/ADM_jsEditor.h	2010-05-08 16:15:01 UTC (rev 6163)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/include/ADM_jsEditor.h	2010-05-08 16:15:03 UTC (rev 6164)
@@ -21,6 +21,7 @@
 
 int jsPrintTiming(int framenumber );
 int jsDumpSegments (void);
+int jsDumpRefVideos (void);
 #ifdef __cplusplus
 };
 #endif

Modified: branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src/ADM_jsEditor.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src/ADM_jsEditor.cpp	2010-05-08 16:15:01 UTC (rev 6163)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src/ADM_jsEditor.cpp	2010-05-08 16:15:03 UTC (rev 6164)
@@ -45,11 +45,22 @@
 int jsDumpSegments (void)
 {// begin PostProcess
         enterLock();
-        video_body->dumpEditing();
+        video_body->dumpSegments();
         leaveLock(); 
         return 0;
 }// end PostProcess
 /**
+        \fn jsDumpRefVideos
+*/
+int jsDumpRefVideos (void)
+{
+        enterLock();
+        video_body->dumpRefVideos();
+        leaveLock(); 
+
+        return 0;
+}
+/**
     \fn dumpTiming
     \brief dump segment, video & all
 */

Modified: branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src/ADM_jsEditor_js.c
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src/ADM_jsEditor_js.c	2010-05-08 16:15:01 UTC (rev 6163)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src/ADM_jsEditor_js.c	2010-05-08 16:15:03 UTC (rev 6164)
@@ -118,20 +118,47 @@
     return var12;
 }
 static JSBool
-jjeditor__construct__(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval)
+jjeditordumpRefVideo(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval)
 {
     JSObject * var20;
+    int var21;
     int var24;
+    jsval var25;
     JSBool var19;
     var20 = NULL;
+    var21 = 0;
     var24 = 0;
+    var25 = JSVAL_NULL;
     var19 = JS_FALSE;
     var20 = obj;
     var24 = argc;
-    jsEditor();
+    var21 = jsDumpRefVideos();
+    if (JS_NewNumberValue(cx, var21, &var25) != JS_TRUE) {
+        goto do_return;
+    }
+    argv[argc+0] = var25;
+    if (rval) {
+        *rval = var25;
+    }
     var19 = JS_TRUE;
+    do_return:
     return var19;
 }
+static JSBool
+jjeditor__construct__(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval)
+{
+    JSObject * var27;
+    int var31;
+    JSBool var26;
+    var27 = NULL;
+    var31 = 0;
+    var26 = JS_FALSE;
+    var27 = obj;
+    var31 = argc;
+    jsEditor();
+    var26 = JS_TRUE;
+    return var26;
+}
 static JSPropertySpec jj_static_ps[] = {
     {NULL, 0, 0, NULL, NULL}
 };
@@ -153,6 +180,7 @@
 static JSFunctionSpec jjeditor_static_fs[] = {
     JS_FS("printTiming", jjeditorprintTiming, 1, 0, 1),
     JS_FS("dumpSegment", jjeditordumpSegment, 0, 0, 1),
+    JS_FS("dumpRefVideo", jjeditordumpRefVideo, 0, 0, 1),
     JS_FS_END
 };
 static JSFunctionSpec jjeditor_fs[] = {

Modified: branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src/ADM_jsEditor_js.idl
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src/ADM_jsEditor_js.idl	2010-05-08 16:15:01 UTC (rev 6163)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src/ADM_jsEditor_js.idl	2010-05-08 16:15:03 UTC (rev 6164)
@@ -12,6 +12,7 @@
         /*            JSFUNC                 C FUNC           PARAM     */
         function int printTiming     : jsPrintTiming(int ) <static>;
         function int dumpSegment     : jsDumpSegments()    <static>;
+        function int dumpRefVideo    : jsDumpRefVideos()   <static>;
         /*            JSFUNC                 C FUNC           PARAM     */
         
         construct                          : jsEditor  ( ) <static>     ; 



From mean at mail.berlios.de  Sat May  8 18:15:05 2010
From: mean at mail.berlios.de (mean at BerliOS)
Date: Sat, 8 May 2010 18:15:05 +0200
Subject: [Avidemux-svn-commit] r6165 -
	branches/avidemux_2.6_branch_mean/avidemux/common/ADM_editor
Message-ID: <201005081615.o48GF5FC013374@sheep.berlios.de>

Author: mean
Date: 2010-05-08 18:15:04 +0200 (Sat, 08 May 2010)
New Revision: 6165

Modified:
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_editor/ADM_edit.cpp
Log:
[editor] Add dumpRefVideo , rename dumpEditing to dumpSegment

Modified: branches/avidemux_2.6_branch_mean/avidemux/common/ADM_editor/ADM_edit.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/ADM_editor/ADM_edit.cpp	2010-05-08 16:15:03 UTC (rev 6164)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/ADM_editor/ADM_edit.cpp	2010-05-08 16:15:04 UTC (rev 6165)
@@ -330,7 +330,9 @@
                 ADM_info("[Editor] It is mpeg4-SP/ASP, try to guess all PTS\n");             
                 uint64_t delay;
                 ADM_computeMP124MissingPtsDts(video._aviheader,video.timeIncrementInUs,&delay);
-                _segments.updateRefVideo(&video);
+                _segments.updateRefVideo();
+                
+                
             }
         }
         else   
@@ -600,12 +602,20 @@
     \fn dumpEditing
     \brief Dump segment, video & al
 */
-bool            ADM_Composer::dumpEditing(void)
+bool            ADM_Composer::dumpSegments(void)
 {
     _segments.dump();
     return true;
 }
 /**
+
+*/
+bool ADM_Composer::dumpRefVideos(void)
+{
+    _segments.dumpRefVideos();
+    return true;
+}
+/**
     \fn dumpTiming
 */
 bool               ADM_Composer::dumpTiming(void)



From mean at mail.berlios.de  Sat May  8 18:15:08 2010
From: mean at mail.berlios.de (mean at BerliOS)
Date: Sat, 8 May 2010 18:15:08 +0200
Subject: [Avidemux-svn-commit] r6166 -
	branches/avidemux_2.6_branch_mean/avidemux/common/ADM_editor
Message-ID: <201005081615.o48GF8L1013384@sheep.berlios.de>

Author: mean
Date: 2010-05-08 18:15:05 +0200 (Sat, 08 May 2010)
New Revision: 6166

Modified:
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_editor/ADM_edit.hxx
Log:
[editor] Add dumpRefVideo , rename dumpEditing to dumpSegment

Modified: branches/avidemux_2.6_branch_mean/avidemux/common/ADM_editor/ADM_edit.hxx
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/ADM_editor/ADM_edit.hxx	2010-05-08 16:15:04 UTC (rev 6165)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/ADM_editor/ADM_edit.hxx	2010-05-08 16:15:05 UTC (rev 6166)
@@ -223,7 +223,8 @@
                                             return _segments.getNbSegments();
                                         }
 // For js
-                    bool                dumpEditing(void);
+                    bool                dumpRefVideos(void);
+                    bool                dumpSegments(void);
                     bool                dumpTiming(void);
                     bool                getVideoPtsDts(uint32_t frame, uint32_t *flags,uint64_t *pts, uint64_t *dts);
 /******************************* /Editing **********************************/										



From mean at mail.berlios.de  Sat May  8 18:15:09 2010
From: mean at mail.berlios.de (mean at BerliOS)
Date: Sat, 8 May 2010 18:15:09 +0200
Subject: [Avidemux-svn-commit] r6167 -
	branches/avidemux_2.6_branch_mean/avidemux/common/ADM_editor
Message-ID: <201005081615.o48GF91M013394@sheep.berlios.de>

Author: mean
Date: 2010-05-08 18:15:09 +0200 (Sat, 08 May 2010)
New Revision: 6167

Modified:
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_editor/ADM_segment.cpp
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_editor/ADM_segment.h
Log:
[editor] Update firstFramePTS, the real one, not the copy,

Modified: branches/avidemux_2.6_branch_mean/avidemux/common/ADM_editor/ADM_segment.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/ADM_editor/ADM_segment.cpp	2010-05-08 16:15:05 UTC (rev 6166)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/ADM_editor/ADM_segment.cpp	2010-05-08 16:15:09 UTC (rev 6167)
@@ -38,19 +38,16 @@
     \fn updateRefVideo
     \brief Update start time
 */
-bool        ADM_EditorSegment::updateRefVideo(_VIDEOS *ref)
+bool        ADM_EditorSegment::updateRefVideo(void)
 {
     int n=videos.size();
     ADM_assert(n);
-    vidHeader *demuxer=	ref->_aviheader;
-    vidHeader *demuxer2=	videos[n-1]._aviheader;
-    ADM_assert(demuxer==demuxer2);
-    
-    
+    _VIDEOS *ref=getRefVideo(n-1);
+    vidHeader *demuxer=ref->_aviheader;
     uint64_t pts,dts;
     
         demuxer->getPtsDts(0,&pts,&dts);
-        if(pts!=ADM_NO_PTS )
+        if(pts!=ADM_NO_PTS && pts >0)
         {
             ADM_warning("Updating firstFramePTS, The first frame has a PTS >0, adjusting to %"LLU" ms\n",pts/1000);
             ref->firstFramePts=pts;
@@ -493,10 +490,32 @@
         jsLog(JS_LOG_NORMAL,"\trefStartDts  :%08"LLU" %s",s->_refStartDts,ADM_us2plain(s->_refStartDts));
     }
 }
+/**
+    \fn dumpRefVideos
+    \brief Dump the refVideo content
+*/
+void ADM_EditorSegment::dumpRefVideos(void)
+{
 
+    int n=videos.size();
+    printf("We have %d reference videos\n",n);
+    for(int i=0;i<n;i++)
+    {
+        _VIDEOS *s=getRefVideo(i);
+
+        jsLog(JS_LOG_NORMAL,"Videos :%d/%d",i,n);
+        jsLog(JS_LOG_NORMAL,"\tfirstFramePts      :%08"LLU" %s",s->firstFramePts,ADM_us2plain(s->firstFramePts));
+        jsLog(JS_LOG_NORMAL,"\ttimeIncrementInUs  :%08"LLU" %s",s->timeIncrementInUs,ADM_us2plain(s->timeIncrementInUs));
+        jsLog(JS_LOG_NORMAL,"\tnb frames    :%08"LLU,s->_nb_video_frames);
+    }
+
+}
+
+
 /**
     \fn dtsFromPts
-    \brief guestimate DTS from PTS
+    \brief guestimate DTS from PTS. For the wanted frame, we go back until we find a valid DTS
+                then the wanted DTS=~ valid DTS + timeIncrement * number of frames in between
 */
  bool        ADM_EditorSegment::dtsFromPts(uint32_t refVideo,uint64_t pts,uint64_t *dts)
 {
@@ -508,9 +527,24 @@
             ADM_warning("Cannot get frame with pts=%"LLU" ms\n",pts/1000);
             return false;
     }
-    // No get DTS..
+    // Now get DTS..
+    uint64_t p,d;
+    if(!frame) // The very first frame
+    {
+        demuxer->getPtsDts(0,&p,&d);
+        if(d==ADM_NO_PTS)
+        {
+            ADM_warning("No DTS available for first frame, putting pts, probably incorrect\n");
+            *dts=pts;
+        }else       
+        {
+            *dts=d;
+        }
+        return true;
+    }
     int32_t deltaFrame=frame;
-    uint64_t p,d;
+    
+    
     while(deltaFrame>0)
     {
             demuxer->getPtsDts(deltaFrame,&p,&d);
@@ -520,6 +554,7 @@
     if(deltaFrame<0)    
     {
         ADM_warning("Cannot find a valid DTS for pts=%"LLU"ms\n",pts/1000);
+        *dts=pts;
         return false;
     }
     deltaFrame=frame-deltaFrame;

Modified: branches/avidemux_2.6_branch_mean/avidemux/common/ADM_editor/ADM_segment.h
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/ADM_editor/ADM_segment.h	2010-05-08 16:15:05 UTC (rev 6166)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/ADM_editor/ADM_segment.h	2010-05-08 16:15:09 UTC (rev 6167)
@@ -105,11 +105,12 @@
 
 public:
             void        dump(void);
+            void        dumpRefVideos(void);
                         ADM_EditorSegment(void);
                         ~ADM_EditorSegment();
 
             bool        addReferenceVideo(_VIDEOS *ref);
-            bool        updateRefVideo(_VIDEOS *ref);
+            bool        updateRefVideo(void);
             bool        deleteAll(void);
 
             bool        resetSegment(void);



From mean at mail.berlios.de  Mon May 10 19:48:06 2010
From: mean at mail.berlios.de (mean at BerliOS)
Date: Mon, 10 May 2010 19:48:06 +0200
Subject: [Avidemux-svn-commit] r6168 -
	branches/avidemux_2.5_branch_gruntster/avidemux/ADM_codecs
Message-ID: <201005101748.o4AHm69M027803@sheep.berlios.de>

Author: mean
Date: 2010-05-10 19:48:05 +0200 (Mon, 10 May 2010)
New Revision: 6168

Modified:
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_codecs/ADM_uyvy.cpp
Log:
[uyvy] Fixes #94

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_codecs/ADM_uyvy.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_codecs/ADM_uyvy.cpp	2010-05-08 16:15:09 UTC (rev 6167)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_codecs/ADM_uyvy.cpp	2010-05-10 17:48:05 UTC (rev 6168)
@@ -30,43 +30,36 @@
 uint8_t
   decoderUYVY::uncompress (ADMCompressedImage * in, ADMImage * out)
 {
-
-  if (in->dataLength < _w * _h * 2)
+ if (in->dataLength < _w * _h * 2)
     {
       printf ("in:%d expected%d\n", in->dataLength, _w * _h * 2);
       return 1;
     }
-  uint8_t *ptrY, *ptrU, *ptrV, *ptr;
-
+  uint8_t *ptrY, *ptrU, *ptrV, *ptr,*ptr2;
   ptr = in->data;
-  ptrY = out->data;
-  ptrU = out->data + _w * _h;
-  ptrV = ptrU + ((_w * _h) >> 2);
+  ptr2=ptr+2*_w;
+  ptrY = YPLANE(out);
+  ptrU = VPLANE(out);
+  ptrV = UPLANE(out);
 
   for (uint32_t y = 0; y < _h; y++)
-    for (uint32_t x = 0; x < (_w >> 2); x++)
+  {
+    for (uint32_t x = 0; x < (_w >> 1); x++)
       {
-	if (!(y & 1))
-	  {
-	    *ptrU++ = (*(ptr) + *(ptr + _w)) >> 1;
-	    ptr++;
-	    *ptrY++ = *ptr++;
-	    *ptrV++ = (*(ptr) + *(ptr + _w)) >> 1;
-	    ptr++;
-	    *ptrY++ = *ptr++;
-	  }
-	else
-	  {
-	    *ptrY++ = *(++ptr);
-	    *ptrY++ = *(ptr + 2);
-	    ptr++;
-	  }
+        if (!(y & 1))
+          {
+            *ptrU++ = ((unsigned int)(ptr[0])+(unsigned int)(ptr2[0]))>>1;
+            *ptrV++ = ((unsigned int)(ptr[2])+(unsigned int)(ptr2[2]))>>1;
+         }
+            *ptrY++ = ptr[1];
+            *ptrY++ = ptr[3];
+            ptr+=4;
+            ptr2+=4;
       }
+    }
+    out->flags = AVI_KEY_FRAME;
+    return 1;
 
-  
-  out->flags = AVI_KEY_FRAME;
-  return 1;
-
 }
 uint8_t
   decoderYUY2::uncompress  (ADMCompressedImage * in, ADMImage * out)



From mean at mail.berlios.de  Mon May 10 19:48:07 2010
From: mean at mail.berlios.de (mean at BerliOS)
Date: Mon, 10 May 2010 19:48:07 +0200
Subject: [Avidemux-svn-commit] r6169 - branches/avidemux_2.5_branch_gruntster
Message-ID: <201005101748.o4AHm7Ue027813@sheep.berlios.de>

Author: mean
Date: 2010-05-10 19:48:07 +0200 (Mon, 10 May 2010)
New Revision: 6169

Modified:
   branches/avidemux_2.5_branch_gruntster/CMakeLists.txt
Log:
[build] We are now post 2.5.3

Modified: branches/avidemux_2.5_branch_gruntster/CMakeLists.txt
===================================================================
--- branches/avidemux_2.5_branch_gruntster/CMakeLists.txt	2010-05-10 17:48:05 UTC (rev 6168)
+++ branches/avidemux_2.5_branch_gruntster/CMakeLists.txt	2010-05-10 17:48:07 UTC (rev 6169)
@@ -97,7 +97,7 @@
 ########################################
 # Standard Avidemux defines
 ########################################
-SET(VERSION 2.5.2)
+SET(VERSION 2.5.3)
 
 # Define internal flags for GTK+ and Qt4 builds.  These are turned off
 # if a showstopper is found.  CLI is automatically assumed as possible



From mean at mail.berlios.de  Tue May 11 19:40:45 2010
From: mean at mail.berlios.de (mean at BerliOS)
Date: Tue, 11 May 2010 19:40:45 +0200
Subject: [Avidemux-svn-commit] r6170 - in branches/avidemux_2.6_branch_mean:
	avidemux_core/ADM_coreDemuxerMpeg/include
	avidemux_core/ADM_coreDemuxerMpeg/src
	avidemux_plugins/ADM_demuxers/MpegPS
Message-ID: <201005111740.o4BHejOY008750@sheep.berlios.de>

Author: mean
Date: 2010-05-11 19:40:26 +0200 (Tue, 11 May 2010)
New Revision: 6170

Modified:
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreDemuxerMpeg/include/dmxPSPacket.h
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreDemuxerMpeg/src/dmxPSPacket.cpp
   branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_demuxers/MpegPS/ADM_psIndex.cpp
Log:
[PSdemuxer] inline read8i, use same startcode search than TS

Modified: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreDemuxerMpeg/include/dmxPSPacket.h
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreDemuxerMpeg/include/dmxPSPacket.h	2010-05-10 17:48:07 UTC (rev 6169)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreDemuxerMpeg/include/dmxPSPacket.h	2010-05-11 17:40:26 UTC (rev 6170)
@@ -9,6 +9,7 @@
 #include "dmxPacket.h"
 #include "ADM_Video.h"
 
+#define PS_PACKET_INLINE
 
 
 /**
@@ -54,9 +55,6 @@
                 psPacketLinear(uint8_t pid);
                 ~psPacketLinear();
         uint32_t getConsumed(void);
-        uint8_t  readi8();
-        uint16_t readi16();
-        uint32_t readi32();
         bool     sync(uint8_t *pid);
         bool    read(uint32_t len, uint8_t *buffer);
         bool    forward(uint32_t v);
@@ -64,6 +62,61 @@
         bool    getInfo(dmxPacketInfo *info);
         bool    seek(uint64_t packetStart, uint32_t offset);
         bool    changePid(uint32_t pid) ;
+#ifndef PS_PACKET_INLINE
+        uint8_t  readi8();
+        uint16_t readi16();
+        uint32_t readi32();
+#else
+        /**
+            \fn readi8
+        */
+        uint8_t readi8(void)
+        {
+            consumed++;
+            if(bufferIndex<bufferLen)
+            {
+                return buffer[bufferIndex++];
+            }
+            if(false==refill()) 
+            {
+                eof=1;
+                return 0;
+            }
+            ADM_assert(bufferLen);
+            bufferIndex=1;
+            return buffer[0];
+            
+        }
+        /**
+            \fn readi16
+        */
+        uint16_t readi16(void)
+        {
+            if(bufferIndex+1<bufferLen)
+            {
+                uint16_t v=(buffer[bufferIndex]<<8)+buffer[bufferIndex+1];;
+                bufferIndex+=2;
+                consumed+=2;
+                return v;
+            }
+            return (readi8()<<8)+readi8();
+        }
+        /**
+            \fn readi32
+        */
+        uint32_t readi32(void)
+        {
+            if(bufferIndex+3<bufferLen)
+            {
+                uint8_t *p=buffer+bufferIndex;
+                uint32_t v=(p[0]<<24)+(p[1]<<16)+(p[2]<<8)+p[3];
+                bufferIndex+=4;
+                consumed+=4;
+                return v;
+            }
+            return (readi16()<<16)+readi16();
+        }
+#endif
 };
 /**
     \class psPacketLinearTracker
@@ -90,6 +143,7 @@
          packetStats    *getStat(int intdex);
          bool           resetStats(void);
 virtual  bool           getPacketOfType(uint8_t pid,uint32_t maxSize, uint32_t *packetSize,uint64_t *pts,uint64_t *dts,uint8_t *buffer,uint64_t *startAt);
+         int            findStartCode(void);
 };
 
 

Modified: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreDemuxerMpeg/src/dmxPSPacket.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreDemuxerMpeg/src/dmxPSPacket.cpp	2010-05-10 17:48:07 UTC (rev 6169)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreDemuxerMpeg/src/dmxPSPacket.cpp	2010-05-11 17:40:26 UTC (rev 6170)
@@ -413,6 +413,7 @@
         bufferIndex=0;
         return true;
 }
+#ifndef PS_PACKET_INLINE
 /**
     \fn readi8
 */
@@ -462,6 +463,7 @@
     }
     return (readi16()<<16)+readi16();
 }
+#endif
 /**
     \fn forward
 */
@@ -651,4 +653,39 @@
         p->startDts=ADM_NO_PTS;
     }
 }
+/**
+    \fn findStartCode
+    \brief Must check stillOk after calling this
+*/
+int psPacketLinearTracker::findStartCode(void)
+{
+#define likely(x) x
+#define unlikely(x) x
+        unsigned int last=0xfffff;
+        unsigned int cur=0xffff;
+        int startCode=0;
+        while(this->stillOk())
+        {
+            last=cur;
+            cur=this->readi16();
+            if(likely(last&0xff)) continue;
+            if(unlikely(!last)) // 00 00 , need 01 xx
+            {
+                if((cur>>8)==1) 
+                {
+                        startCode=cur&0xff;
+                        break;
+                }
+            }
+            if(unlikely(!(last&0xff))) // xx 00 need 00 01
+            {
+                if(cur==1)
+                {
+                        startCode=this->readi8();
+                        break;
+                }
+            }
+        }
+        return startCode;
+}
 //EOF

Modified: branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_demuxers/MpegPS/ADM_psIndex.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_demuxers/MpegPS/ADM_psIndex.cpp	2010-05-10 17:48:07 UTC (rev 6169)
+++ branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_demuxers/MpegPS/ADM_psIndex.cpp	2010-05-11 17:40:26 UTC (rev 6170)
@@ -188,14 +188,9 @@
     fullSize=pkt->getSize();
       while(1)
       {
-        uint32_t code=0xffff+0xffff0000;
-        while((code&0x00ffffff)!=1 && pkt->stillOk())
-        {
-            code=(code<<8)+pkt->readi8();
-        }
+        
+        uint8_t startCode=pkt->findStartCode();
         if(!pkt->stillOk()) break;
-        uint8_t startCode=pkt->readi8();
-
         pkt->getInfo(&info);
         info.offset-=4;
 



From mean at mail.berlios.de  Tue May 11 19:40:53 2010
From: mean at mail.berlios.de (mean at BerliOS)
Date: Tue, 11 May 2010 19:40:53 +0200
Subject: [Avidemux-svn-commit] r6171 -
	branches/avidemux_2.6_branch_mean/avidemux/common/ADM_editor
Message-ID: <201005111740.o4BHerCJ008799@sheep.berlios.de>

Author: mean
Date: 2010-05-11 19:40:47 +0200 (Tue, 11 May 2010)
New Revision: 6171

Modified:
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_editor/ADM_edPtsDts.cpp
Log:
[editor] Simplify reordering

Modified: branches/avidemux_2.6_branch_mean/avidemux/common/ADM_editor/ADM_edPtsDts.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/ADM_editor/ADM_edPtsDts.cpp	2010-05-11 17:40:26 UTC (rev 6170)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/ADM_editor/ADM_edPtsDts.cpp	2010-05-11 17:40:47 UTC (rev 6171)
@@ -160,7 +160,6 @@
     int nbBframe=0;
     int maxBframe=0;
     uint32_t flags;
-    int nbB=0;
     uint64_t pts,dts;
 
     aviInfo info;
@@ -169,8 +168,6 @@
     for(int i=1;i<nbFrames;i++)
     {
         hdr->getFlags(i,&flags);
-        if(flags & AVI_B_FRAME)
-                nbB++;
         if(true!=hdr->getPtsDts(i,&pts,&dts))
         {
                     ADM_warning("Cannot get PTS/DTS\n");
@@ -183,7 +180,8 @@
                 nbBframe=0;
             }
     }
-
+    nbBframe=0;
+    // We have now maxBframe = max number of Bframes in sequence
     for(int i=1;i<nbFrames;i++)
     {
         hdr->getFlags(i,&flags);
@@ -199,11 +197,10 @@
             uint64_t oldPts,oldDts;
             uint64_t fwdPts,fwdDts;
               hdr->getPtsDts(last,&oldPts,&oldDts);
-              hdr->getPtsDts(nbBframe+last+1,&fwdPts,&fwdDts);
+              hdr->getPtsDts(i,&fwdPts,&fwdDts);
               oldPts=fwdDts;
               hdr->setPtsDts(last,oldPts,oldDts);
-            nbBframe=0;
-            last=i;
+              last=i;
         }
     }
     return 1;



From mean at mail.berlios.de  Tue May 11 19:40:58 2010
From: mean at mail.berlios.de (mean at BerliOS)
Date: Tue, 11 May 2010 19:40:58 +0200
Subject: [Avidemux-svn-commit] r6172 -
	branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreVideoCodec/src
Message-ID: <201005111740.o4BHewqP008836@sheep.berlios.de>

Author: mean
Date: 2010-05-11 19:40:54 +0200 (Tue, 11 May 2010)
New Revision: 6172

Modified:
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreVideoCodec/src/ADM_uyvy.cpp
Log:
[codec] Fix uyvy decoding, ref #94

Modified: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreVideoCodec/src/ADM_uyvy.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreVideoCodec/src/ADM_uyvy.cpp	2010-05-11 17:40:47 UTC (rev 6171)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreVideoCodec/src/ADM_uyvy.cpp	2010-05-11 17:40:54 UTC (rev 6172)
@@ -26,37 +26,31 @@
       printf ("in:%d expected%d\n", in->dataLength, _w * _h * 2);
       return 1;
     }
-  uint8_t *ptrY, *ptrU, *ptrV, *ptr;
-
+  uint8_t *ptrY, *ptrU, *ptrV, *ptr,*ptr2;
   ptr = in->data;
-  ptrY = out->data;
-  ptrU = out->data + _w * _h;
-  ptrV = ptrU + ((_w * _h) >> 2);
+  ptr2=ptr+2*_w;
+  ptrY = YPLANE(out);
+  ptrU = VPLANE(out);
+  ptrV = UPLANE(out);
 
   for (uint32_t y = 0; y < _h; y++)
-    for (uint32_t x = 0; x < (_w >> 2); x++)
+  {
+    for (uint32_t x = 0; x < (_w >> 1); x++)
       {
-	if (!(y & 1))
-	  {
-	    *ptrU++ = (*(ptr) + *(ptr + _w)) >> 1;
-	    ptr++;
-	    *ptrY++ = *ptr++;
-	    *ptrV++ = (*(ptr) + *(ptr + _w)) >> 1;
-	    ptr++;
-	    *ptrY++ = *ptr++;
-	  }
-	else
-	  {
-	    *ptrY++ = *(++ptr);
-	    *ptrY++ = *(ptr + 2);
-	    ptr++;
-	  }
+        if (!(y & 1))
+          {
+            *ptrU++ = ((unsigned int)(ptr[0])+(unsigned int)(ptr2[0]))>>1;
+            *ptrV++ = ((unsigned int)(ptr[2])+(unsigned int)(ptr2[2]))>>1;
+         }
+            *ptrY++ = ptr[1];
+            *ptrY++ = ptr[3];
+            ptr+=4;
+            ptr2+=4;
       }
+    }
+    out->flags = AVI_KEY_FRAME;
+    return 1;
 
-  
-  out->flags = AVI_KEY_FRAME;
-  return 1;
-
 }
 bool   decoderYUY2::uncompress  (ADMCompressedImage * in, ADMImage * out)
 {



From mean at mail.berlios.de  Tue May 11 19:41:01 2010
From: mean at mail.berlios.de (mean at BerliOS)
Date: Tue, 11 May 2010 19:41:01 +0200
Subject: [Avidemux-svn-commit] r6173 -
	branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_videoEncoder/x264
Message-ID: <201005111741.o4BHf1Bg008860@sheep.berlios.de>

Author: mean
Date: 2010-05-11 19:41:00 +0200 (Tue, 11 May 2010)
New Revision: 6173

Modified:
   branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_videoEncoder/x264/ADM_x264.cpp
   branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_videoEncoder/x264/ADM_x264Setup.cpp
Log:
[x264] Fix dts issue when there is a gap in pts, dts can be > pts for the last bframe(s) before the hole

Modified: branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_videoEncoder/x264/ADM_x264.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_videoEncoder/x264/ADM_x264.cpp	2010-05-11 17:40:54 UTC (rev 6172)
+++ branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_videoEncoder/x264/ADM_x264.cpp	2010-05-11 17:41:00 UTC (rev 6173)
@@ -180,6 +180,7 @@
         ADM_warning("[x264] Cannot get next image\n");
         return false;
     }
+    aprintf("x264 Incoming : %"LLU"us \n",image->Pts);
     queueOfDts.push_back(image->Pts);
     // 2-preamble
     if(false==preAmble(image))
@@ -265,6 +266,17 @@
         queueOfDts.erase(queueOfDts.begin());
         aprintf("pts = %"LLU", dts=%"LLU", pts+delay=%"LLU" delta=%"LLU"\n",picout->i_pts,out->dts,out->pts,
                     out->pts-out->dts);
+        if(out->dts>out->pts)
+        {
+            ADM_warning("DTS > PTS, that can happen when there are holes in the source (%"LLU"/%"LLU")\n",
+                        out->dts,out->pts);
+            if(picout->i_type!=X264_TYPE_B && picout->i_type!=X264_TYPE_BREF)
+            {
+                ADM_warning("It is not a bframe, expect problems\n");
+                ADM_warning("It is not a bframe, expect problems\n");
+            }
+            out->dts=out->pts;
+        }
         switch (picout->i_type)
         {
         case X264_TYPE_IDR:

Modified: branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_videoEncoder/x264/ADM_x264Setup.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_videoEncoder/x264/ADM_x264Setup.cpp	2010-05-11 17:40:54 UTC (rev 6172)
+++ branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_videoEncoder/x264/ADM_x264Setup.cpp	2010-05-11 17:41:00 UTC (rev 6173)
@@ -70,8 +70,13 @@
     usSecondsToFrac(f,&n,&d);
     param.i_fps_num = n;
     param.i_fps_den = d;
-    encoderDelay=f*x264Settings.MaxBFrame;
-
+    if(!x264Settings.MaxBFrame)  encoderDelay=0;
+    else    
+    {
+        if(2>=x264Settings.MaxRefFrames) encoderDelay=f*2;
+        else
+                encoderDelay=f*(x264Settings.MaxRefFrames-1);
+    }
 #define MKPARAM(x,y) {param.x = x264Settings.y;printf("[x264] "#x" = %d\n",param.x);}
 #define MKPARAMF(x,y) {param.x = (float)x264Settings.y / 100; printf("[x264] "#x" = %.2f\n",param.x);}
 



From mean at mail.berlios.de  Tue May 11 19:41:04 2010
From: mean at mail.berlios.de (mean at BerliOS)
Date: Tue, 11 May 2010 19:41:04 +0200
Subject: [Avidemux-svn-commit] r6174 -
	branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreVideoEncoder/src
Message-ID: <201005111741.o4BHf4IN008882@sheep.berlios.de>

Author: mean
Date: 2010-05-11 19:41:03 +0200 (Tue, 11 May 2010)
New Revision: 6174

Modified:
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreVideoEncoder/src/ADM_coreVideoEncoderFFmpeg.cpp
Log:
[dts/pts] Fix dts when there are hole for lavcodec based video encoders

Modified: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreVideoEncoder/src/ADM_coreVideoEncoderFFmpeg.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreVideoEncoder/src/ADM_coreVideoEncoderFFmpeg.cpp	2010-05-11 17:41:00 UTC (rev 6173)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreVideoEncoder/src/ADM_coreVideoEncoderFFmpeg.cpp	2010-05-11 17:41:03 UTC (rev 6174)
@@ -66,7 +66,10 @@
             inc*=2;
             ADM_warning("It is probably field encoded, doubling increment\n");
      }
-    encoderDelay=inc*LAVS(max_b_frames);
+     if(LAVS(max_b_frames))
+            encoderDelay=inc*2;
+     else
+            encoderDelay=0;
     ADM_info("[Lavcodec] Using a video encoder delay of %d ms\n",(int)(encoderDelay/1000));
     if(_globalHeader)
     {



From mean at mail.berlios.de  Tue May 11 19:41:05 2010
From: mean at mail.berlios.de (mean at BerliOS)
Date: Tue, 11 May 2010 19:41:05 +0200
Subject: [Avidemux-svn-commit] r6175 -
	branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreVideoEncoder/src
Message-ID: <201005111741.o4BHf5jU008902@sheep.berlios.de>

Author: mean
Date: 2010-05-11 19:41:05 +0200 (Tue, 11 May 2010)
New Revision: 6175

Modified:
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreVideoEncoder/src/ADM_coreVideoEncoder.cpp
Log:
[dts/pts] Fix dts>pts for last B frames when the next ref frame is far away

Modified: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreVideoEncoder/src/ADM_coreVideoEncoder.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreVideoEncoder/src/ADM_coreVideoEncoder.cpp	2010-05-11 17:41:03 UTC (rev 6174)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreVideoEncoder/src/ADM_coreVideoEncoder.cpp	2010-05-11 17:41:05 UTC (rev 6175)
@@ -98,6 +98,11 @@
             ADM_assert(queueOfDts.size());
             *dts=queueOfDts[0];
             queueOfDts.erase(queueOfDts.begin());
+            if(*dts>*pts)
+            {
+                ADM_warning("Dts>Pts, that can happen if there are holes in the source, fixating..\n");
+                *dts=*pts;
+            }
             return true;
         }
     }



From mean at mail.berlios.de  Tue May 11 19:41:12 2010
From: mean at mail.berlios.de (mean at BerliOS)
Date: Tue, 11 May 2010 19:41:12 +0200
Subject: [Avidemux-svn-commit] r6176 -
	branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_videoEncoder/xvid4
Message-ID: <201005111741.o4BHfCdI008951@sheep.berlios.de>

Author: mean
Date: 2010-05-11 19:41:07 +0200 (Tue, 11 May 2010)
New Revision: 6176

Modified:
   branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_videoEncoder/xvid4/ADM_xvid4.cpp
Log:
[xvid4] Fix encoderlay (untested)

Modified: branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_videoEncoder/xvid4/ADM_xvid4.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_videoEncoder/xvid4/ADM_xvid4.cpp	2010-05-11 17:41:05 UTC (rev 6175)
+++ branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_videoEncoder/xvid4/ADM_xvid4.cpp	2010-05-11 17:41:07 UTC (rev 6176)
@@ -247,7 +247,10 @@
             inc*=2;
             ADM_warning("It is probably field encoded, doubling increment\n");
      }
-    encoderDelay=inc*xvid4Settings.maxBFrame;
+    if(xvid4Settings.maxBFrame)
+        encoderDelay=inc*2;
+    else
+        encoderDelay=0;
     ADM_info("Xvid4, setup ok\n");
     return true;
 }



From mean at mail.berlios.de  Wed May 12 07:25:53 2010
From: mean at mail.berlios.de (mean at BerliOS)
Date: Wed, 12 May 2010 07:25:53 +0200
Subject: [Avidemux-svn-commit] r6177 -
	branches/avidemux_2.5_branch_gruntster/avidemux/ADM_inputs/ADM_matroska
Message-ID: <201005120525.o4C5PrnF019803@sheep.berlios.de>

Author: mean
Date: 2010-05-12 07:25:52 +0200 (Wed, 12 May 2010)
New Revision: 6177

Modified:
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_inputs/ADM_matroska/ADM_mkvTrackType.cpp
Log:
[mkv] Identified mpeg L1/L2 audio track in mkv, fixes #93

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_inputs/ADM_matroska/ADM_mkvTrackType.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_inputs/ADM_matroska/ADM_mkvTrackType.cpp	2010-05-11 17:41:07 UTC (rev 6176)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_inputs/ADM_matroska/ADM_mkvTrackType.cpp	2010-05-12 05:25:52 UTC (rev 6177)
@@ -50,6 +50,8 @@
   {"A_AAC",0,WAV_AAC,""},
   {"A_VORBIS",0,WAV_OGG,""},
   {"A_DTS",0,WAV_DTS,""},
+  {"A_MPEG/L2",0,WAV_MP2,""},
+  {"A_MPEG/L1",0,WAV_MP2,""},
   
   // Video
   {"V_MPEG2",1,0,"MPEG"}, // Mpeg2



From mean at mail.berlios.de  Wed May 12 19:32:29 2010
From: mean at mail.berlios.de (mean at BerliOS)
Date: Wed, 12 May 2010 19:32:29 +0200
Subject: [Avidemux-svn-commit] r6178 -
	branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_mpeg2enc/mpeg2enc
Message-ID: <201005121732.o4CHWTqB020562@sheep.berlios.de>

Author: mean
Date: 2010-05-12 19:32:29 +0200 (Wed, 12 May 2010)
New Revision: 6178

Modified:
   branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_mpeg2enc/mpeg2enc/CMakeLists.txt
Log:
[mpeg2enc] Fix double definition of mpeg_warn etc...

Modified: branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_mpeg2enc/mpeg2enc/CMakeLists.txt
===================================================================
--- branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_mpeg2enc/mpeg2enc/CMakeLists.txt	2010-05-12 05:25:52 UTC (rev 6177)
+++ branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_mpeg2enc/mpeg2enc/CMakeLists.txt	2010-05-12 17:32:29 UTC (rev 6178)
@@ -6,7 +6,8 @@
 build_sub44_mests.cc  find_best_one_pel.cc  mblock_sad_mmx.cc           mpeg2enc.cc      predict_mmx.cc    putvlc.cc        synchrolib.cc
 conform.cc            idct.cc               mblock_sad_mmxe.cc          mpeg2enc_if.cc   predict_ref.cc    quantize.cc      transfrm.cc
 cpu_accel.cc          idctdata.cc           mblock_sub44_sads_x86.cc    mpeg2param.cc    predict_x86.cc    quantize_ref.cc  transfrm_ref.cc
-fdctdata.cc           idct_mmx.cc           mjpeg_logging.c				mpeg2setup.cc    putbits.cc        quantize_x86.cc  transfrm_x86.cc
+fdctdata.cc           idct_mmx.cc           
+mpeg2setup.cc         putbits.cc            quantize_x86.cc             transfrm_x86.cc
 fdct_mmx.cc           ioio.c                mblock_sumsq_mmx.cc         mpegconsts.cc    puthdr.cc         quant_mmx2.cc    writepic.cc
 fdctref.cc            macroblock.cc         motion.cc                   predcomp_mmx.cc  putmpg.cc         ratectl.cc)
 
@@ -45,4 +46,5 @@
 
 if (UNIX)
 	add_target_cflags(mpeg2enc -fPIC)
-endif (UNIX)
\ No newline at end of file
+endif (UNIX)
+



From gruntster at mail.berlios.de  Thu May 13 22:01:45 2010
From: gruntster at mail.berlios.de (gruntster at mail.berlios.de)
Date: Thu, 13 May 2010 22:01:45 +0200
Subject: [Avidemux-svn-commit] r6179 - in
	branches/avidemux_2.5_branch_gruntster/cmake: . patches
Message-ID: <201005132001.o4DK1jsi011414@sheep.berlios.de>

Author: gruntster
Date: 2010-05-13 22:01:37 +0200 (Thu, 13 May 2010)
New Revision: 6179

Added:
   branches/avidemux_2.5_branch_gruntster/cmake/patches/config_macosx.mak.diff
Modified:
   branches/avidemux_2.5_branch_gruntster/cmake/admFFmpegBuild.cmake
   branches/avidemux_2.5_branch_gruntster/cmake/admFFmpegUtil.cmake
Log:
[apple] change prefix of FFmpeg libs on OS X so they don't conflict with system versions

Modified: branches/avidemux_2.5_branch_gruntster/cmake/admFFmpegBuild.cmake
===================================================================
--- branches/avidemux_2.5_branch_gruntster/cmake/admFFmpegBuild.cmake	2010-05-12 17:32:29 UTC (rev 6178)
+++ branches/avidemux_2.5_branch_gruntster/cmake/admFFmpegBuild.cmake	2010-05-13 20:01:37 UTC (rev 6179)
@@ -38,9 +38,9 @@
 		patch_file("${FFMPEG_SOURCE_DIR}" "${patchFile}")
 	endforeach(patchFile)
 
-	if (UNIX AND NOT APPLE)
+	if (UNIX)
 		patch_file("${FFMPEG_SOURCE_DIR}" "${CMAKE_SOURCE_DIR}/cmake/patches/common.mak.diff")
-	endif (UNIX AND NOT APPLE)
+	endif (UNIX)
 
 	message("")
 endif (FFMPEG_PERFORM_PATCH)
@@ -145,10 +145,13 @@
 	execute_process(COMMAND ${CMAKE_COMMAND} -E copy "./libavutil/avconfig.h" "${CMAKE_BINARY_DIR}/config/libavutil"
 					WORKING_DIRECTORY "${FFMPEG_BINARY_DIR}")
 
-	if (UNIX AND NOT APPLE)
+	if (UNIX)
 		find_patch()
 		patch_file("${FFMPEG_BINARY_DIR}" "${CMAKE_SOURCE_DIR}/cmake/patches/config.mak.diff")
-	endif (UNIX AND NOT APPLE)
+	elseif (APPLE)
+		find_patch()
+		patch_file("${FFMPEG_BINARY_DIR}" "${CMAKE_SOURCE_DIR}/cmake/patches/config_macosx.mak.diff")
+	endif (UNIX)
 
 	message("")
 endif (FFMPEG_PERFORM_BUILD)

Modified: branches/avidemux_2.5_branch_gruntster/cmake/admFFmpegUtil.cmake
===================================================================
--- branches/avidemux_2.5_branch_gruntster/cmake/admFFmpegUtil.cmake	2010-05-12 17:32:29 UTC (rev 6178)
+++ branches/avidemux_2.5_branch_gruntster/cmake/admFFmpegUtil.cmake	2010-05-13 20:01:37 UTC (rev 6179)
@@ -11,9 +11,9 @@
 	getFfmpegVersionFromHeader("libpostproc" "${sourceDir}/libpostproc/postprocess.h" LIBPOSTPROC_VERSION_MAJOR LIBPOSTPROC_VERSION)
 	getFfmpegVersionFromHeader("libswscale" "${sourceDir}/libswscale/swscale.h" LIBSWSCALE_VERSION_MAJOR LIBSWSCALE_VERSION)
 
-	if (UNIX AND NOT APPLE)
+	if (UNIX)
 		set(LIBAVCODEC_ADM ADM5)
-	endif (UNIX AND NOT APPLE)
+	endif (UNIX)
 
 	if (APPLE)
 		set(LIBAVCODEC_LIB lib${LIBAVCODEC_ADM}avcodec.${LIBAVCODEC_VERSION}${CMAKE_SHARED_LIBRARY_SUFFIX})

Added: branches/avidemux_2.5_branch_gruntster/cmake/patches/config_macosx.mak.diff
===================================================================
--- branches/avidemux_2.5_branch_gruntster/cmake/patches/config_macosx.mak.diff	2010-05-12 17:32:29 UTC (rev 6178)
+++ branches/avidemux_2.5_branch_gruntster/cmake/patches/config_macosx.mak.diff	2010-05-13 20:01:37 UTC (rev 6179)
@@ -0,0 +1,13 @@
+--- config.mak.old	2009-05-01 19:26:13.808782802 +0200
++++ config.mak	2009-05-01 18:10:25.000085291 +0200
+@@ -60,7 +60,7 @@
+ INSTALL=install
+ LIBTARGET=
+-SLIBNAME=$(SLIBPREF)$(FULLNAME)$(SLIBSUF)
+-SLIBNAME_WITH_VERSION=$(SLIBPREF)$(FULLNAME).$(LIBVERSION)$(SLIBSUF)
+-SLIBNAME_WITH_MAJOR=$(SLIBPREF)$(FULLNAME).$(LIBMAJOR)$(SLIBSUF)
++SLIBNAME=$(SLIBPREF)ADM5$(FULLNAME)$(SLIBSUF)
++SLIBNAME_WITH_VERSION=$(SLIBPREF)ADM5$(FULLNAME).$(LIBVERSION)$(SLIBSUF)
++SLIBNAME_WITH_MAJOR=$(SLIBPREF)ADM5$(FULLNAME).$(LIBMAJOR)$(SLIBSUF)
+ SLIB_CREATE_DEF_CMD=
+ SLIB_EXTRA_CMD=



From gruntster at mail.berlios.de  Thu May 13 22:26:38 2010
From: gruntster at mail.berlios.de (gruntster at mail.berlios.de)
Date: Thu, 13 May 2010 22:26:38 +0200
Subject: [Avidemux-svn-commit] r6180 -
	branches/avidemux_2.5_branch_gruntster/cmake
Message-ID: <201005132026.o4DKQc70013209@sheep.berlios.de>

Author: gruntster
Date: 2010-05-13 22:26:32 +0200 (Thu, 13 May 2010)
New Revision: 6180

Modified:
   branches/avidemux_2.5_branch_gruntster/cmake/admFFmpegBuild.cmake
Log:
[apple] fix logic of last commit

Modified: branches/avidemux_2.5_branch_gruntster/cmake/admFFmpegBuild.cmake
===================================================================
--- branches/avidemux_2.5_branch_gruntster/cmake/admFFmpegBuild.cmake	2010-05-13 20:01:37 UTC (rev 6179)
+++ branches/avidemux_2.5_branch_gruntster/cmake/admFFmpegBuild.cmake	2010-05-13 20:26:32 UTC (rev 6180)
@@ -145,13 +145,13 @@
 	execute_process(COMMAND ${CMAKE_COMMAND} -E copy "./libavutil/avconfig.h" "${CMAKE_BINARY_DIR}/config/libavutil"
 					WORKING_DIRECTORY "${FFMPEG_BINARY_DIR}")
 
-	if (UNIX)
+	if (APPLE)
 		find_patch()
+		patch_file("${FFMPEG_BINARY_DIR}" "${CMAKE_SOURCE_DIR}/cmake/patches/config_macosx.mak.diff")
+	elseif (UNIX)
+		find_patch()
 		patch_file("${FFMPEG_BINARY_DIR}" "${CMAKE_SOURCE_DIR}/cmake/patches/config.mak.diff")
-	elseif (APPLE)
-		find_patch()
-		patch_file("${FFMPEG_BINARY_DIR}" "${CMAKE_SOURCE_DIR}/cmake/patches/config_macosx.mak.diff")
-	endif (UNIX)
+	endif (APPLE)
 
 	message("")
 endif (FFMPEG_PERFORM_BUILD)



From mean at mail.berlios.de  Fri May 14 17:34:10 2010
From: mean at mail.berlios.de (mean at BerliOS)
Date: Fri, 14 May 2010 17:34:10 +0200
Subject: [Avidemux-svn-commit] r6181 -
	branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_demuxers/Matroska
Message-ID: <201005141534.o4EFYAGm026541@sheep.berlios.de>

Author: mean
Date: 2010-05-14 17:34:10 +0200 (Fri, 14 May 2010)
New Revision: 6181

Modified:
   branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_demuxers/Matroska/ADM_mkvTrackType.cpp
Log:
[mkv] Identity mpeg L1/L2, ref #93

Modified: branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_demuxers/Matroska/ADM_mkvTrackType.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_demuxers/Matroska/ADM_mkvTrackType.cpp	2010-05-13 20:26:32 UTC (rev 6180)
+++ branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_demuxers/Matroska/ADM_mkvTrackType.cpp	2010-05-14 15:34:10 UTC (rev 6181)
@@ -46,7 +46,8 @@
   {"A_AAC",0,WAV_AAC,""},
   {"A_VORBIS",0,WAV_OGG_VORBIS,""},
   {"A_DTS",0,WAV_DTS,""},
-  
+  {"A_MPEG/L2",0,WAV_MP2,""},
+  {"A_MPEG/L1",0,WAV_MP2,""},
   // Video
   {"V_MPEG2",1,0,"MPEG"}, // Mpeg2
   {"V_MPEG1",1,0,"MPEG"}, // Mpeg1



From mean at mail.berlios.de  Fri May 14 17:34:13 2010
From: mean at mail.berlios.de (mean at BerliOS)
Date: Fri, 14 May 2010 17:34:13 +0200
Subject: [Avidemux-svn-commit] r6182 - in branches/avidemux_2.6_branch_mean:
	avidemux/common/ADM_editor avidemux/common/ADM_videoCodec/src
	avidemux_core/ADM_coreImage/include avidemux_core/ADM_coreImage/src
	avidemux_core/ADM_coreImageLoader/include
	avidemux_core/ADM_coreImageLoader/src
	avidemux_core/ADM_coreVideoCodec/src
Message-ID: <201005141534.o4EFYDHh026553@sheep.berlios.de>

Author: mean
Date: 2010-05-14 17:34:12 +0200 (Fri, 14 May 2010)
New Revision: 6182

Modified:
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_editor/ADM_edRender.cpp
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_editor/ADM_edRenderInternal.cpp
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_videoCodec/src/ADM_ffmpeg_vdpau.cpp
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreImage/include/ADM_image.h
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreImage/src/ADM_image.cpp
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreImageLoader/include/ADM_imageLoader.h
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreImageLoader/src/ADM_imageLoader.cpp
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreVideoCodec/src/ADM_ffmp43.cpp
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreVideoCodec/src/ADM_png.cpp
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreVideoCodec/src/ADM_rgb16.cpp
Log:
[core] update ADMImage to be default, reference or vdpau

Modified: branches/avidemux_2.6_branch_mean/avidemux/common/ADM_editor/ADM_edRender.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/ADM_editor/ADM_edRender.cpp	2010-05-14 15:34:10 UTC (rev 6181)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/ADM_editor/ADM_edRender.cpp	2010-05-14 15:34:12 UTC (rev 6182)
@@ -486,7 +486,7 @@
                                                                  src->_colorspace,ADM_COLOR_YV12);
                         }
                         // Since it is not YV12 it MUST be a ref
-                        ADM_assert(src->_isRef);
+                        ADM_assert(src->isRef());
                         uint32_t strides[3]={src->_width,src->_width/2,src->_width/2};
                         uint8_t  *Planes[3]={YPLANE(dst),UPLANE(dst),VPLANE(dst)};
                         vid->color->convertPlanes(src->_planeStride,strides,src->_planes,Planes);

Modified: branches/avidemux_2.6_branch_mean/avidemux/common/ADM_editor/ADM_edRenderInternal.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/ADM_editor/ADM_edRenderInternal.cpp	2010-05-14 15:34:10 UTC (rev 6181)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/ADM_editor/ADM_edRenderInternal.cpp	2010-05-14 15:34:12 UTC (rev 6182)
@@ -290,7 +290,7 @@
                 }
                 if(!_scratch)
                 {
-                  _scratch=new ADMImage(_imageBuffer->_width,_imageBuffer->_height,1);
+                  _scratch=new ADMImage(_imageBuffer->_width,_imageBuffer->_height,ADM_IMAGE_REF);
                 }
                 tmpImage=_scratch;
                 ww=_imageBuffer->_width & 0xfffff0;

Modified: branches/avidemux_2.6_branch_mean/avidemux/common/ADM_videoCodec/src/ADM_ffmpeg_vdpau.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/ADM_videoCodec/src/ADM_ffmpeg_vdpau.cpp	2010-05-14 15:34:10 UTC (rev 6181)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/ADM_videoCodec/src/ADM_ffmpeg_vdpau.cpp	2010-05-14 15:34:12 UTC (rev 6182)
@@ -244,7 +244,7 @@
             }
             VDPAU->freeQueue.push_back(VDPAU->renders[i]);
         }
-        scratch=new ADMImage(w,h,1);
+        scratch=new ADMImage(w,h,ADM_IMAGE_REF);
         b_age = ip_age[0] = ip_age[1] = 256*256*256*64;
 
 }

Modified: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreImage/include/ADM_image.h
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreImage/include/ADM_image.h	2010-05-14 15:34:10 UTC (rev 6181)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreImage/include/ADM_image.h	2010-05-14 15:34:12 UTC (rev 6182)
@@ -47,6 +47,14 @@
         PLANAR_V=3
         
 } ADM_PLANE;
+
+typedef enum
+{
+    ADM_IMAGE_DEFAULT,
+    ADM_IMAGE_REF,
+    ADM_IMAGE_VDPAU
+}ADM_IMAGE_TYPE;
+
 /**
     \class ADMImage
     \brief Stores image
@@ -68,10 +76,10 @@
         ADM_ASPECT	_aspect;	/// Aspect ratio
         uint32_t	flags;		/// Flags for this image (AVI_KEY_FRAME/AVI_B_FRAME)
         uint64_t    Pts;        /// Presentation time in us
-
+        uint64_t    *_cookie;   /// Used whith vdpau & friends
 // This 3 fields are only used to convery container (reference to other datas)
 // Between codec & editor
-        uint8_t         _isRef;         /// If True means the datas are just a link to data we don't own!
+        ADM_IMAGE_TYPE  _imageType;     /// Plain image or reference or vdpau wrapper
         ADM_colorspace  _colorspace;    /// Colorspace we are moving, default is YV12
         uint8_t         _noPicture;     /// No picture to display
 
@@ -120,8 +128,8 @@
         uint8_t         *_planes[3];     /// In case of linked data store y/u/v pointers
         uint32_t        _planeStride[3]; /// Same story
 
-                ADMImage(uint32_t width, uint32_t height);
-                ADMImage(uint32_t width, uint32_t height,uint32_t dummy); /// To create linked datas image        
+                ADMImage(uint32_t width, uint32_t height,ADM_IMAGE_TYPE type=ADM_IMAGE_DEFAULT);
+                
 
         uint8_t   LumaReduceBy2(void);
                 ~ADMImage();
@@ -136,7 +144,7 @@
         uint8_t duplicateFull(ADMImage *src);	/// copy an image to ourself, including info
         uint8_t copyInfo(ADMImage *src);	/// copy all the flags, not the data themselves
         uint8_t copyQuantInfo(ADMImage *src);	/// copy quant table if any
-        uint8_t isRef(void) { return _isRef;};
+        bool    isRef(void) { if(_imageType==ADM_IMAGE_REF) return true;return false;};
         uint8_t setLinkInfos(uint8_t *y,        /// To fill in infos for linked image
                         uint8_t *u,uint8_t *v,uint32_t stridey,
                         uint32_t strideu, uint32_t stridev);

Modified: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreImage/src/ADM_image.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreImage/src/ADM_image.cpp	2010-05-14 15:34:10 UTC (rev 6181)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreImage/src/ADM_image.cpp	2010-05-14 15:34:12 UTC (rev 6182)
@@ -55,31 +55,41 @@
         Pts=0;
 
 }
-ADMImage::ADMImage(uint32_t width, uint32_t height)
+/**
+    \fn ADMImage
+    \brief ctor
+*/
+ADMImage::ADMImage(uint32_t width, uint32_t height,ADM_IMAGE_TYPE type)
 {
         commonInit(width,height);
-        _isRef=0;
-        data=new uint8_t [ ((width+15)&0xffffff0)*((height+15)&0xfffffff0)*2];
-        ADM_assert(data);
-        imgCurMem+=(width*height*3)>>1;
-        if(imgCurMem>imgMaxMem) imgMaxMem=imgCurMem;
-        if(imgCurNb>imgMaxNb) imgMaxNb=imgCurNb;
-
-};
-// Create a fake image with external datas
-ADMImage::ADMImage(uint32_t width, uint32_t height,uint32_t dummy)
-{
-        commonInit(width,height);
-        _isRef=1;
+        _imageType=type;
         data=NULL;
+        _cookie=NULL;
+        _planes[0]=_planes[1]=_planes[2]=NULL;
+        switch(_imageType)
+        {
+            case ADM_IMAGE_DEFAULT:
+                data=new uint8_t [ ((width+15)&0xffffff0)*((height+15)&0xfffffff0)*2];
+                ADM_assert(data);
+                imgCurMem+=(width*height*3)>>1;
+                if(imgCurMem>imgMaxMem) imgMaxMem=imgCurMem;
+                if(imgCurNb>imgMaxNb) imgMaxNb=imgCurNb;
+                break;
+            case ADM_IMAGE_REF:
+                break;
+            case ADM_IMAGE_VDPAU:
+                break;
+            default:
+                ADM_assert(0);
 
+        }
 };
 //
 //	Deallocate
 //
 ADMImage::~ADMImage()
 {
-    if(!_isRef)
+    if(_imageType==ADM_IMAGE_DEFAULT)
     {
        if(quant) delete [] quant;
        quant=NULL;
@@ -100,7 +110,7 @@
         ADM_assert(src->_width==_width);
         ADM_assert(src->_height==_height);
 
-        ADM_assert(!_isRef); // could not duplicate to a linked data image
+        ADM_assert(_imageType==ADM_IMAGE_DEFAULT); // could not duplicate to a linked data image
 
         // cleanup if needed
         if(quant) delete [] quant;
@@ -110,7 +120,7 @@
         _qSize=0;
 
         copyInfo(src);
-        if(!src->_isRef)
+        if(src->_imageType==ADM_IMAGE_DEFAULT)
         {
                memcpy(YPLANE(this),YPLANE(src),_width*_height);
                 if(swap)
@@ -126,6 +136,7 @@
         }
         else
         {
+                if(src->_imageType!=ADM_IMAGE_REF) ADM_assert(0);
                 if(src->_noPicture)
                 {
                         // no pic available, blacken it
@@ -225,7 +236,7 @@
 
 
 	copyInfo(src);
-        ADM_assert(!_isRef);
+    ADM_assert(_imageType==ADM_IMAGE_DEFAULT);
 
 	memcpy(YPLANE(this),YPLANE(src),_width*_height);
 	memcpy(UPLANE(this),UPLANE(src),(_width*_height)>>2);

Modified: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreImageLoader/include/ADM_imageLoader.h
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreImageLoader/include/ADM_imageLoader.h	2010-05-14 15:34:10 UTC (rev 6181)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreImageLoader/include/ADM_imageLoader.h	2010-05-14 15:34:12 UTC (rev 6182)
@@ -8,14 +8,14 @@
 #include "ADM_image.h"
 typedef enum 
 {
-		ADM_IMAGE_UNKNOWN=0,
-        ADM_IMAGE_JPG=1,
-        ADM_IMAGE_PNG=2,
-        ADM_IMAGE_BMP=3,
-        ADM_IMAGE_BMP2=4
+		ADM_PICTURE_UNKNOWN=0,
+        ADM_PICTURE_JPG=1,
+        ADM_PICTURE_PNG=2,
+        ADM_PICTURE_BMP=3,
+        ADM_PICTURE_BMP2=4
         
-} ADM_IMAGE_TYPE;
+} ADM_PICTURE_TYPE;
 
 ADMImage *createImageFromFile(const char *filename);
-ADM_IMAGE_TYPE ADM_identidyImageFile(const char *filename,uint32_t *w,uint32_t *h);
+ADM_PICTURE_TYPE ADM_identifyImageFile(const char *filename,uint32_t *w,uint32_t *h);
 #endif

Modified: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreImageLoader/src/ADM_imageLoader.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreImageLoader/src/ADM_imageLoader.cpp	2010-05-14 15:34:10 UTC (rev 6181)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreImageLoader/src/ADM_imageLoader.cpp	2010-05-14 15:34:12 UTC (rev 6182)
@@ -59,18 +59,18 @@
 ADMImage *createImageFromFile(const char *filename)
 {
 	uint32_t w,h;
-	switch(ADM_identidyImageFile(filename,&w,&h))
+	switch(ADM_identifyImageFile(filename,&w,&h))
 	{
-		case  ADM_IMAGE_UNKNOWN: 
+		case  ADM_PICTURE_UNKNOWN: 
 					ADM_warning("[imageLoader] Trouble identifying /loading %s\n",filename);
 					return NULL;
-		case ADM_IMAGE_JPG:
+		case ADM_PICTURE_JPG:
 					return createImageFromFile_jpeg(filename);
 					break;
-		case ADM_IMAGE_PNG:
+		case ADM_PICTURE_PNG:
 					return createImageFromFile_png(filename);
 					break;
-		case ADM_IMAGE_BMP2:
+		case ADM_PICTURE_BMP2:
 					return createImageFromFile_Bmp2(filename);
 					break;
 		default:
@@ -148,7 +148,7 @@
 		    fclose(fd);
 		  //
 		    
-		    ADMImage tmpImage(w,h,1); // It is a reference image
+		    ADMImage tmpImage(w,h,ADM_IMAGE_REF); // It is a reference image
 		    // Now unpack it ...
             decoders *dec=ADM_coreCodecGetDecoder (fourCC::get((uint8_t *)"MJPG"),   w,   h, 0 , NULL,0);
             if(!dec)
@@ -328,7 +328,7 @@
  	   uint8_t *data=new uint8_t[size];
  	   fread(data,size,1,fd);
  	   fclose(fd);
- 	   ADMImage tmpImage(w,h,1);
+ 	   ADMImage tmpImage(w,h,ADM_IMAGE_REF);
     	// Decode PNG
         decoders *dec=ADM_coreCodecGetDecoder (fourCC::get((uint8_t *)"PNG "),   w,   h, 0 , NULL,0);
     	if(!dec)
@@ -354,7 +354,7 @@
  * 		\fn ADM_identidyImageFile
  * 		\brief Identidy image type, returns type and width/height
  */
-ADM_IMAGE_TYPE ADM_identidyImageFile(const char *filename,uint32_t *w,uint32_t *h)
+ADM_PICTURE_TYPE ADM_identifyImageFile(const char *filename,uint32_t *w,uint32_t *h)
 {
 			uint32_t *fcc;
 		    uint8_t fcc_tab[4];
@@ -368,7 +368,7 @@
 		    if (!fd) 
 		    {
 		    	printf("[imageIdentify] Cannot open that file!\n");
-		    	return ADM_IMAGE_UNKNOWN;
+		    	return ADM_PICTURE_UNKNOWN;
 		    }
 		    fread(fcc_tab, 4, 1, fd);
 		    fcc = (uint32_t *) fcc_tab;
@@ -403,15 +403,15 @@
 		    			    		{
 		    			    			ADM_warning("[imageIdentify]Offset too short!\n");
 		    			    		    fclose(fd);
-		    			    		    return ADM_IMAGE_UNKNOWN;
+		    			    		    return ADM_PICTURE_UNKNOWN;
 		    			    		}
 		    			    		fseek(fd, off - 2, SEEK_CUR);
 		    			    	}
 		    				count++;
 		    			    }
 		    			    fclose(fd);
-		    			    if(count>=10) return ADM_IMAGE_UNKNOWN;
-		    			    return ADM_IMAGE_JPG;
+		    			    if(count>=10) return ADM_PICTURE_UNKNOWN;
+		    			    return ADM_PICTURE_JPG;
 		    }
 		    // PNG ?
 		    if (fcc_tab[1] == 'P' && fcc_tab[2] == 'N' && fcc_tab[3] == 'G') 
@@ -424,7 +424,7 @@
 		     	    *w=read32(fd);
 		     	    *h=read32(fd);	
 		     	    fclose(fd);
-		     	    return ADM_IMAGE_PNG;
+		     	    return ADM_PICTURE_PNG;
 			    }
 		    // BMP2?
 		    if (fcc_tab[0] == 'B' && fcc_tab[1] == 'M') 
@@ -442,15 +442,15 @@
 		     	    {
 		     	    	ADM_warning("[imageIdentify] BMP2:Cannot handle compressed bmp\n");
 		     	    	fclose(fd);
-		     	    	return ADM_IMAGE_UNKNOWN;
+		     	    	return ADM_PICTURE_UNKNOWN;
 		     	    }
 		     	    *w = bmph.biWidth;
 		     	    *h = bmph.biHeight;
 	     	    	fclose(fd);
-	     	    	return ADM_IMAGE_BMP2;
+	     	    	return ADM_PICTURE_BMP2;
 		    }
 		    // Unknown filetype...
 		    fclose(fd);
-		    return ADM_IMAGE_UNKNOWN;
+		    return ADM_PICTURE_UNKNOWN;
 }
 //EOF

Modified: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreVideoCodec/src/ADM_ffmp43.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreVideoCodec/src/ADM_ffmp43.cpp	2010-05-14 15:34:10 UTC (rev 6181)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreVideoCodec/src/ADM_ffmp43.cpp	2010-05-14 15:34:12 UTC (rev 6182)
@@ -69,7 +69,7 @@
 uint8_t decoderFF::clonePic (AVFrame * src, ADMImage * out)
 {
   uint32_t    u,v;
-  ADM_assert(out->_isRef);
+  ADM_assert(out->isRef());
   out->_planes[0] = (uint8_t *) src->data[0];
   out->_planeStride[0] = src->linesize[0];
   if (_swapUV)

Modified: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreVideoCodec/src/ADM_png.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreVideoCodec/src/ADM_png.cpp	2010-05-14 15:34:10 UTC (rev 6181)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreVideoCodec/src/ADM_png.cpp	2010-05-14 15:34:12 UTC (rev 6182)
@@ -145,7 +145,7 @@
       recalc ();
       goto gain2;
     }
-  ADM_assert (out->_isRef);
+  ADM_assert (out->isRef());
   out->_planes[0] = decoded;
   out->_planes[1] = NULL;
   out->_planes[2] = NULL;

Modified: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreVideoCodec/src/ADM_rgb16.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreVideoCodec/src/ADM_rgb16.cpp	2010-05-14 15:34:10 UTC (rev 6181)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreVideoCodec/src/ADM_rgb16.cpp	2010-05-14 15:34:12 UTC (rev 6182)
@@ -102,7 +102,7 @@
 		}
 	}
 
-	ADM_assert(out->_isRef);
+	ADM_assert(out->isRef());
 
 	out->flags = AVI_KEY_FRAME;
 	out->_colorspace = (ADM_colorspace)(colorspace | ADM_COLOR_BACKWARD);



From mean at mail.berlios.de  Fri May 14 17:34:20 2010
From: mean at mail.berlios.de (mean at BerliOS)
Date: Fri, 14 May 2010 17:34:20 +0200
Subject: [Avidemux-svn-commit] r6183 - in branches/avidemux_2.6_branch_mean:
	avidemux/common avidemux/common/ADM_editor
	avidemux/common/ADM_render avidemux/common/ADM_videoCodec/src
	avidemux/common/ADM_videoFilter2/src
	avidemux_core/ADM_coreImage/include avidemux_core/ADM_coreImage/src
	avidemux_core/ADM_coreImageLoader/src
	avidemux_core/ADM_coreVideoCodec/include
	avidemux_core/ADM_coreVideoCodec/src
	avidemux_core/ADM_coreVideoEncoder/include
	avidemux_core/ADM_coreVideoEncoder/src
	avidemux_core/ADM_coreVideoFilter/include
	avidemux_core/ADM_coreVideoFilter/src
Message-ID: <201005141534.o4EFYKj3026567@sheep.berlios.de>

Author: mean
Date: 2010-05-14 17:34:19 +0200 (Fri, 14 May 2010)
New Revision: 6183

Added:
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreImage/include/ADM_imageResizer.h
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreImage/src/ADM_imageOperation.cpp
Modified:
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_editor/ADM_edCache.cpp
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_editor/ADM_edRender.cpp
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_editor/ADM_edRenderInternal.cpp
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_editor/ADM_edit.cpp
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_preview.cpp
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_render/GUI_sdlRender.cpp
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_render/GUI_simpleRender.cpp
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_render/GUI_xvRender.cpp
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_videoCodec/src/ADM_ffmpeg_vdpau.cpp
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_videoFilter2/src/ADM_filterThread.cpp
   branches/avidemux_2.6_branch_mean/avidemux/common/gui_blackframes.cpp
   branches/avidemux_2.6_branch_mean/avidemux/common/gui_save.cpp
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreImage/include/ADM_colorspace.h
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreImage/include/ADM_image.h
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreImage/src/ADM_colorspace.cpp
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreImage/src/ADM_image.cpp
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreImage/src/ADM_imageResizer.cpp
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreImage/src/ADM_imageSave.cpp
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreImage/src/ADM_imageUtils.cpp
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreImage/src/CMakeLists.txt
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreImageLoader/src/ADM_imageLoader.cpp
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreVideoCodec/include/ADM_codecNull.h
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreVideoCodec/src/ADM_ffmp43.cpp
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreVideoCodec/src/ADM_png.cpp
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreVideoCodec/src/ADM_rgb16.cpp
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreVideoCodec/src/ADM_uyvy.cpp
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreVideoEncoder/include/ADM_coreVideoEncoderFFmpeg.h
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreVideoEncoder/src/ADM_coreVideoEncoderFFmpeg.cpp
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreVideoFilter/include/DIA_flyDialog.h
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreVideoFilter/src/ADM_videoFilterCache.cpp
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreVideoFilter/src/DIA_flyDialog.cpp
Log:
[core] Split coreImage into default, ref and later vdpau

Modified: branches/avidemux_2.6_branch_mean/avidemux/common/ADM_editor/ADM_edCache.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/ADM_editor/ADM_edCache.cpp	2010-05-14 15:34:12 UTC (rev 6182)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/ADM_editor/ADM_edCache.cpp	2010-05-14 15:34:19 UTC (rev 6183)
@@ -35,7 +35,7 @@
 	_elem=new cacheElem[size];
 	for(uint32_t i=0;i<size;i++)
 	{
-		_elem[i].image=new ADMImage(w,h);
+		_elem[i].image=new ADMImageDefault(w,h);
 		_elem[i].pts=ADM_NO_PTS;
 	}
 	_nbImage=size;

Modified: branches/avidemux_2.6_branch_mean/avidemux/common/ADM_editor/ADM_edRender.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/ADM_editor/ADM_edRender.cpp	2010-05-14 15:34:12 UTC (rev 6182)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/ADM_editor/ADM_edRender.cpp	2010-05-14 15:34:19 UTC (rev 6183)
@@ -487,16 +487,24 @@
                         }
                         // Since it is not YV12 it MUST be a ref
                         ADM_assert(src->isRef());
-                        uint32_t strides[3]={src->_width,src->_width/2,src->_width/2};
-                        uint8_t  *Planes[3]={YPLANE(dst),UPLANE(dst),VPLANE(dst)};
-                        vid->color->convertPlanes(src->_planeStride,strides,src->_planes,Planes);
+                        
+                        uint32_t srcStrides[3];
+                        uint8_t  *srcPlanes[3];
+                        uint32_t dstStrides[3];
+                        uint8_t  *dstPlanes[3];
+
+                        src->GetPitches(srcStrides);
+                        src->GetReadPlanes(srcPlanes);
+                        dst->GetPitches(dstStrides);
+                        dst->GetWritePlanes(dstPlanes);
+
+                        vid->color->convertPlanes(srcStrides,dstStrides,srcPlanes,dstPlanes);
                         return 1;
                 }
                 // nothing to do
-                if(_pp.swapuv)
-                      dst->duplicateSwapUV(src);
-                else
-                        dst->duplicate(src);
+//                if(_pp.swapuv)
+#warning handle swap uv
+                dst->duplicate(src);
                 return 1;
 }
 /**

Modified: branches/avidemux_2.6_branch_mean/avidemux/common/ADM_editor/ADM_edRenderInternal.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/ADM_editor/ADM_edRenderInternal.cpp	2010-05-14 15:34:12 UTC (rev 6182)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/ADM_editor/ADM_edRenderInternal.cpp	2010-05-14 15:34:19 UTC (rev 6183)
@@ -290,7 +290,7 @@
                 }
                 if(!_scratch)
                 {
-                  _scratch=new ADMImage(_imageBuffer->_width,_imageBuffer->_height,ADM_IMAGE_REF);
+                  _scratch=new ADMImageRef(_imageBuffer->_width,_imageBuffer->_height);
                 }
                 tmpImage=_scratch;
                 ww=_imageBuffer->_width & 0xfffff0;
@@ -370,54 +370,35 @@
 	// we do postproc !
 	// keep
 	uint8_t *oBuff[3];
-	const uint8_t *iBuff[3];
-	int	strideTab[3];
-	int	strideTab2[3];
+    const uint8_t *xBuff[3];
+	uint8_t *iBuff[3];
+	uint32_t	strideTab[3];
+	uint32_t	strideTab2[3];
 	aviInfo _info;
 
         getVideoInfo(&_info);
-        if(refOnly)
+        tmpImage->GetReadPlanes(iBuff);
+        tmpImage->GetPitches(strideTab);
+        out->GetPitches(strideTab2);
+        out->GetWritePlanes(oBuff);
+        if(_pp.swapuv)
         {
-                iBuff[0]= tmpImage->_planes[0];
-                iBuff[1]= tmpImage->_planes[1];
-                iBuff[2]= tmpImage->_planes[2];
-
-                strideTab2[0]=_info.width;
-                strideTab2[1]=_info.width>>1;
-                strideTab2[2]=_info.width>>1;
-
-                strideTab[0]=tmpImage->_planeStride[0];
-                strideTab[1]=tmpImage->_planeStride[1];
-                strideTab[2]=tmpImage->_planeStride[2];
-
+                uint8_t *s=oBuff[1];
+                oBuff[1]=oBuff[2];
+                oBuff[2]=s;
         }
-        else
+        int iStrideTab2[3],iStrideTab[3];
+        for(int i=0;i<3;i++) 
         {
-                iBuff[0]= YPLANE((tmpImage));
-                iBuff[1]= UPLANE((tmpImage));
-                iBuff[2]= VPLANE((tmpImage));
-
-                strideTab[0]=strideTab2[0]=_info.width;
-                strideTab[1]=strideTab2[1]=_info.width>>1;
-                strideTab[2]=strideTab2[2]=_info.width>>1;
+            iStrideTab[i]=strideTab[i];
+            iStrideTab2[i]=strideTab2[i];
+            xBuff[i]=iBuff[i];
         }
-        if(_pp.swapuv)
-        {
-                oBuff[0]= YPLANE(out);
-                oBuff[1]= VPLANE(out);
-                oBuff[2]= UPLANE(out);
-        }else
-        {
-
-                oBuff[0]= YPLANE(out);
-                oBuff[1]= UPLANE(out);
-                oBuff[2]= VPLANE(out);
-        }
         pp_postprocess(
-            iBuff,
-            strideTab,
+            xBuff,
+            iStrideTab,
             oBuff,
-            strideTab2,
+            iStrideTab2,
             ww,
             _info.height,
             (int8_t *)(tmpImage->quant),
@@ -438,8 +419,8 @@
                 right=_info.width-left;
                 // Luma
                 dst=YPLANE(out)+right;
-                src=tmpImage->_planes[0]+right;
-                stridein=tmpImage->_planeStride[0];
+                src=tmpImage->GetReadPtr(PLANAR_Y)+right;
+                stridein=tmpImage->GetPitch(PLANAR_Y);
                 strideout=_info.width;
                 for(uint32_t y=_info.height;y>0;y--)
                 {
@@ -452,8 +433,9 @@
                 right>>=1;
                 //
                 dst=UPLANE(out)+right;
-                src=tmpImage->_planes[1]+right;
-                stridein=tmpImage->_planeStride[1];
+                src=tmpImage->GetReadPtr(PLANAR_U)+right;
+                stridein=tmpImage->GetPitch(PLANAR_U);
+
                 strideout=_info.width>>1;
                 for(uint32_t y=_info.height>>1;y>0;y--)
                 {
@@ -463,8 +445,8 @@
                 }
                 //
                 dst=VPLANE(out)+right;
-                src=tmpImage->_planes[2]+right;
-                stridein=tmpImage->_planeStride[2];
+                src=tmpImage->GetReadPtr(PLANAR_V)+right;
+                stridein=tmpImage->GetPitch(PLANAR_V);
                 strideout=_info.width>>1;
                 for(uint32_t y=_info.height>>1;y>0;y--)
                 {

Modified: branches/avidemux_2.6_branch_mean/avidemux/common/ADM_editor/ADM_edit.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/ADM_editor/ADM_edit.cpp	2010-05-14 15:34:12 UTC (rev 6182)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/ADM_editor/ADM_edit.cpp	2010-05-14 15:34:19 UTC (rev 6183)
@@ -244,7 +244,7 @@
         updatePostProc(&_pp);
 
         if(_imageBuffer) delete _imageBuffer;
-        _imageBuffer=new ADMImage(info.width,info.height);
+        _imageBuffer=new ADMImageDefault(info.width,info.height);
         _imageBuffer->_qSize= ((info.width+15)>>4)*((info.height+15)>>4);
         _imageBuffer->quant=new uint8_t[_imageBuffer->_qSize];
         memset(_imageBuffer->quant,0,_imageBuffer->_qSize);

Modified: branches/avidemux_2.6_branch_mean/avidemux/common/ADM_preview.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/ADM_preview.cpp	2010-05-14 15:34:12 UTC (rev 6182)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/ADM_preview.cpp	2010-05-14 15:34:19 UTC (rev 6183)
@@ -38,7 +38,7 @@
 #include "ADM_render/GUI_render.h"
 #include "ADM_commonUI/GUI_ui.h"
 #include "ADM_preview.h"
-
+#include "ADM_imageResizer.h"
 #include "DIA_coreToolkit.h"
 
 
@@ -79,7 +79,7 @@
 {
   
   if(rdrImage) delete rdrImage;
-  rdrImage=new ADMImage(w,h);
+  rdrImage=new ADMImageDefault(w,h);
   rdrPhysicalW=w;
   rdrPhysicalH=h;
   renderDisplayResize(rdrPhysicalW,rdrPhysicalH,zoom);

Modified: branches/avidemux_2.6_branch_mean/avidemux/common/ADM_render/GUI_sdlRender.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/ADM_render/GUI_sdlRender.cpp	2010-05-14 15:34:12 UTC (rev 6182)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/ADM_render/GUI_sdlRender.cpp	2010-05-14 15:34:19 UTC (rev 6183)
@@ -284,7 +284,8 @@
 		}
 	}
 #endif
-
+#warning FIXME
+#if 0
 int pitch;
 int w=imageWidth;
 int h=imageHeight;
@@ -313,7 +314,8 @@
 	            memcpy(sdl_overlay->pixels[2],ptr+(page*5)/4,(w*h)>>2);
 	        else
 	            interleave(sdl_overlay->pixels[2],ptr+(page*5)/4,w>>1,pitch,h>>1);
-        }else
+        }else
+#endif
         {
 #if 0
 	        color->changeWidthHeight(w,h);

Modified: branches/avidemux_2.6_branch_mean/avidemux/common/ADM_render/GUI_simpleRender.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/ADM_render/GUI_simpleRender.cpp	2010-05-14 15:34:12 UTC (rev 6182)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/ADM_render/GUI_simpleRender.cpp	2010-05-14 15:34:19 UTC (rev 6183)
@@ -59,7 +59,7 @@
 */
 bool simpleRender::displayImage(ADMImage *pic)
 {
-    scaler->convert(pic->data,videoBuffer);
+    scaler->convertImage(pic,videoBuffer);
     // Display RGB data
     MUI_rgbDraw(MUI_getDrawWidget(),displayWidth,displayHeight,videoBuffer);
     return true;

Modified: branches/avidemux_2.6_branch_mean/avidemux/common/ADM_render/GUI_xvRender.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/ADM_render/GUI_xvRender.cpp	2010-05-14 15:34:12 UTC (rev 6182)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/ADM_render/GUI_xvRender.cpp	2010-05-14 15:34:19 UTC (rev 6183)
@@ -41,7 +41,7 @@
 static uint8_t 	GUI_XvList(Display * dis, uint32_t port, uint32_t * fmt);
 static uint8_t 	GUI_XvInit(GUI_WindowInfo * window, uint32_t w, uint32_t h);
 static void 	GUI_XvEnd( void );
-static uint8_t  GUI_XvDisplay(uint8_t * src, uint32_t w, uint32_t h,uint32_t destW,uint32_t destH);
+static uint8_t  GUI_XvDisplay(ADMImage *src, uint32_t w, uint32_t h,uint32_t destW,uint32_t destH);
 static uint8_t  GUI_XvRedraw( void );
 static uint8_t  getAtom(const char *string);
 //________________Wrapper around Xv_______________
@@ -76,7 +76,7 @@
 */
 bool XvRender::displayImage(ADMImage *pic)
 {
-	return GUI_XvDisplay(pic->data, imageWidth, imageHeight,displayWidth,displayHeight);
+	return GUI_XvDisplay(pic, imageWidth, imageHeight,displayWidth,displayHeight);
 }
 
 /**
@@ -136,7 +136,7 @@
 /**
     \fn GUI_XvList
 */
-uint8_t GUI_XvDisplay(uint8_t * src, uint32_t w, uint32_t h,uint32_t destW,uint32_t destH)
+uint8_t GUI_XvDisplay(ADMImage * src, uint32_t w, uint32_t h,uint32_t destW,uint32_t destH)
 {
     
     if (xvimage)
@@ -147,7 +147,12 @@
 	  // for YV12, 4 bits for Y 4 bits for u, 4 bits for v
 	  // total 1.5*
           XLockDisplay (xv_display);
-          memcpy(xvimage->data, src, (w*h*3)>>1);
+          // Pack src into xvimage->data
+            int plane=w*h;
+          BitBlit((uint8_t *)xvimage->data, w,src->GetReadPtr(PLANAR_Y),src->GetPitch(PLANAR_Y),w,h);
+          BitBlit((uint8_t *)xvimage->data+plane, w/2,src->GetReadPtr(PLANAR_U),src->GetPitch(PLANAR_U),w/2,h/2);
+          BitBlit((uint8_t *)xvimage->data+(plane*5)/4, w/2,src->GetReadPtr(PLANAR_V),src->GetPitch(PLANAR_V),w/2,h/2);
+          
         //printf("%u x %u => %u x %u\n",w,h,destW,destH);
         // And display it !
 #if 1

Modified: branches/avidemux_2.6_branch_mean/avidemux/common/ADM_videoCodec/src/ADM_ffmpeg_vdpau.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/ADM_videoCodec/src/ADM_ffmpeg_vdpau.cpp	2010-05-14 15:34:12 UTC (rev 6182)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/ADM_videoCodec/src/ADM_ffmpeg_vdpau.cpp	2010-05-14 15:34:19 UTC (rev 6183)
@@ -244,7 +244,7 @@
             }
             VDPAU->freeQueue.push_back(VDPAU->renders[i]);
         }
-        scratch=new ADMImage(w,h,ADM_IMAGE_REF);
+        scratch=new ADMImageRef(w,h);
         b_age = ip_age[0] = ip_age[1] = 256*256*256*64;
 
 }
@@ -295,7 +295,7 @@
         return 0;
     }
     // other part will be done in goOn
-  struct vdpau_render_state *rndr = (struct vdpau_render_state *)scratch->_planes[0];
+  struct vdpau_render_state *rndr = (struct vdpau_render_state *)scratch->GetWritePtr(PLANAR_Y);
    VdpVideoSurface  surface;
 
     surface=rndr->surface;

Modified: branches/avidemux_2.6_branch_mean/avidemux/common/ADM_videoFilter2/src/ADM_filterThread.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/ADM_videoFilter2/src/ADM_filterThread.cpp	2010-05-14 15:34:12 UTC (rev 6182)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/ADM_videoFilter2/src/ADM_filterThread.cpp	2010-05-14 15:34:19 UTC (rev 6183)
@@ -29,7 +29,7 @@
     for(int i=0;i<ADM_THREAD_QUEUE_SIZE;i++)
     {
         ADM_queuePacket item;
-        item.data=(uint8_t *)new ADMImage(info.width,info.height);
+        item.data=(uint8_t *)new ADMImageDefault(info.width,info.height);
         freeList.push_back(item);
     }
 }

Modified: branches/avidemux_2.6_branch_mean/avidemux/common/gui_blackframes.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/gui_blackframes.cpp	2010-05-14 15:34:12 UTC (rev 6182)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/gui_blackframes.cpp	2010-05-14 15:34:19 UTC (rev 6183)
@@ -96,7 +96,7 @@
 
     int cnt4=0;
 
-    start=img->data+ sz*sliceNum;
+    start=img->GetReadPtr(PLANAR_Y)+ sz*sliceNum;
     buff=start+sz;
 
     while(--buff>start)

Modified: branches/avidemux_2.6_branch_mean/avidemux/common/gui_save.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/gui_save.cpp	2010-05-14 15:34:12 UTC (rev 6182)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/gui_save.cpp	2010-05-14 15:34:19 UTC (rev 6183)
@@ -389,7 +389,7 @@
         // Split name into base + extension
         ADM_PathSplit(name,&baseName,&ext);
 
-        src=new ADMImage(avifileinfo->width,avifileinfo->height);
+        src=new ADMImageDefault(avifileinfo->width,avifileinfo->height);
         ADM_assert(src);
 
         working=createWorking(QT_TR_NOOP("Saving as set of jpegs"));

Modified: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreImage/include/ADM_colorspace.h
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreImage/include/ADM_colorspace.h	2010-05-14 15:34:12 UTC (rev 6182)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreImage/include/ADM_colorspace.h	2010-05-14 15:34:19 UTC (rev 6183)
@@ -12,10 +12,10 @@
  *   (at your option) any later version.                                   *
  *                                                                         *
  ***************************************************************************/
- #ifndef ADM_COLORSPACE_H
- #define ADM_COLORSPACE_H
+#ifndef ADM_COLORSPACE_H
+#define ADM_COLORSPACE_H
 #include "ADM_rgb.h" // To have colors
-
+class ADMImage;
 typedef enum 
 {
     ADM_CS_BILINEAR,
@@ -46,6 +46,7 @@
     
 
     bool            convert(uint8_t  *from, uint8_t *to);
+    bool            convertImage(ADMImage *img, uint8_t *to);
     bool            convertPlanes(uint32_t  sourceStride[3],uint32_t destStride[3],     
                                   uint8_t   *sourceData[3], uint8_t *destData[3]);
                     ~ADMColorScalerFull();
@@ -63,6 +64,7 @@
                      {
 
                      }
+                    
 };
 
 // Some misc functions

Modified: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreImage/include/ADM_image.h
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreImage/include/ADM_image.h	2010-05-14 15:34:12 UTC (rev 6182)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreImage/include/ADM_image.h	2010-05-14 15:34:19 UTC (rev 6183)
@@ -37,14 +37,14 @@
 
 //#define vi.num_frames _info.nb_frames
 //#define vi.IsYV12()   1
-#define GetReadPtr GetWritePtr
 #define GetRowSize GetPitch
 
 typedef enum 
 {
-        PLANAR_Y=1,
-        PLANAR_U=2,
-        PLANAR_V=3
+        PLANAR_Y=0,
+        PLANAR_U=1,
+        PLANAR_V=2,
+        PLANAR_LAST=3
         
 } ADM_PLANE;
 
@@ -54,7 +54,11 @@
     ADM_IMAGE_REF,
     ADM_IMAGE_VDPAU
 }ADM_IMAGE_TYPE;
-
+#define YPLANE(x) ((x)->GetReadPtr(PLANAR_Y))
+#define UPLANE(x) ((x)->GetReadPtr(PLANAR_U))
+#define VPLANE(x) ((x)->GetReadPtr(PLANAR_V))
+class ADMImageRef;
+class ADMImageDefault;
 /**
     \class ADMImage
     \brief Stores image
@@ -63,135 +67,106 @@
 class ADMImage
 {
 public:
-        uint32_t        demuxerFrameno;
-  
-        //*****************
-        uint8_t		*data;		/// Pointer to actual image data
-        uint32_t	_width;		/// Width of image
-        uint32_t	_height;	/// Height of image
-        uint32_t	_qStride;	/// Stride of Q infos, usually about width/8 <- ***if 0 means no quant usable***
-        uint8_t		*quant;		/// Byte representing quantize used for this block
-        uint32_t	_Qp;		/// Average quantizer for this image, Default=2
-        uint32_t	_qSize;		/// Size of the *quant field
-        ADM_ASPECT	_aspect;	/// Aspect ratio
-        uint32_t	flags;		/// Flags for this image (AVI_KEY_FRAME/AVI_B_FRAME)
-        uint64_t    Pts;        /// Presentation time in us
-        uint64_t    *_cookie;   /// Used whith vdpau & friends
-// This 3 fields are only used to convery container (reference to other datas)
-// Between codec & editor
+        uint32_t	    _width;		/// Width of image
+        uint32_t	    _height;	/// Height of image
+        uint32_t	    _Qp;		/// Average quantizer for this image, Default=2
+        uint32_t	    flags;		/// Flags for this image (AVI_KEY_FRAME/AVI_B_FRAME)
+        uint64_t        Pts;        /// Presentation time in us
         ADM_IMAGE_TYPE  _imageType;     /// Plain image or reference or vdpau wrapper
         ADM_colorspace  _colorspace;    /// Colorspace we are moving, default is YV12
         uint8_t         _noPicture;     /// No picture to display
+        ADM_ASPECT	    _aspect;	/// Aspect ratio
+        // Quant info
+        uint8_t         *quant;
+        int             _qStride;
+        int             _qSize;
+        bool            GetPitches(uint32_t *pitches) {pitches[0]=GetPitch(PLANAR_Y);
+                                                       pitches[1]=GetPitch(PLANAR_U);
+                                                       pitches[2]=GetPitch(PLANAR_V);}
+        bool            GetWritePlanes(uint8_t **planes) {planes[0]=GetWritePtr(PLANAR_Y);
+                                                        planes[1]=GetWritePtr(PLANAR_U);
+                                                        planes[2]=GetWritePtr(PLANAR_V);}
+        bool            GetReadPlanes(uint8_t **planes) {planes[0]=GetReadPtr(PLANAR_Y);
+                                                         planes[1]=GetReadPtr(PLANAR_U);
+                                                         planes[2]=GetReadPtr(PLANAR_V);}
 
-// End of section dedicated to codec/editor transfer
-
-        void            commonInit(uint32_t w,uint32_t h); /// sub constructor
+virtual                 ~ADMImage();        
         
-        uint32_t        GetPitch(ADM_PLANE plane)
-                                {
-                                        switch(plane)
-                                        {
-                                                case PLANAR_Y:return _width;break;
-                                                case PLANAR_U:
-                                                case PLANAR_V:return _width>>1;break;
-                                                default: ADM_assert(0);
-                                        }
-                                        return 0;
-                                };
-        uint8_t         *GetWritePtr(ADM_PLANE plane)
-                        {       
-                                uint32_t plan=_width*_height;
-                                switch(plane)
-                                        {
-                                                case PLANAR_Y:return data;break;
-                                                case PLANAR_U:return data+plan;break;
-                                                case PLANAR_V:return data+((plan*5)>>2);break;
-                                                default: ADM_assert(0);
-                                        }
-                                return NULL;
-                        };
-   
-        uint32_t GetHeight(ADM_PLANE plane)
-                                {
-                                        switch(plane)
-                                        {
-                                                case PLANAR_Y:return _height;break;
-                                                case PLANAR_U:
-                                                case PLANAR_V:return _height>>1;break;
-                                                default: ADM_assert(0);
-                                        }
-                                        return 0;
-                                };
-        uint8_t duplicateMacro(ADMImage *src,uint32_t swap);       /// copy an image to ourself, including info
+
+protected:
+        ADMImage(uint32_t width, uint32_t height,ADM_IMAGE_TYPE type);
 public:
+        virtual      uint32_t        GetPitch(ADM_PLANE plane)=0;
+        virtual      uint8_t        *GetWritePtr(ADM_PLANE plane)=0;
+        virtual      uint8_t        *GetReadPtr(ADM_PLANE plane)=0;
+        virtual      bool           isWrittable(void)=0;
+        virtual      ADMImageRef    *castToRef(void) {return NULL;};
+        
+        virtual      bool           duplicateMacro(ADMImage *src,bool swap);       /// copy an image to ourself, including info 
 
-        uint8_t         *_planes[3];     /// In case of linked data store y/u/v pointers
-        uint32_t        _planeStride[3]; /// Same story
-
-                ADMImage(uint32_t width, uint32_t height,ADM_IMAGE_TYPE type=ADM_IMAGE_DEFAULT);
-                
-
-        uint8_t   LumaReduceBy2(void);
-                ~ADMImage();
-        uint8_t getWidthHeight(uint32_t *w,uint32_t *h)
-                    {
-                          *w=_width;
-                          *h=_height;
-                          return 1;
-                    }
-        uint8_t duplicate(ADMImage *src);	/// copy an image to ourself, including info
-        uint8_t duplicateSwapUV(ADMImage *src); /// copy an image to ourself, including info
-        uint8_t duplicateFull(ADMImage *src);	/// copy an image to ourself, including info
-        uint8_t copyInfo(ADMImage *src);	/// copy all the flags, not the data themselves
-        uint8_t copyQuantInfo(ADMImage *src);	/// copy quant table if any
+                     uint8_t        getWidthHeight(uint32_t *w,uint32_t *h)
+                                    {
+                                          *w=_width;
+                                          *h=_height;
+                                          return 1;
+                                    }
+        bool    duplicate(ADMImage *src);	/// copy an image to ourself, including info
+        bool    duplicateFull(ADMImage *src);	/// copy an image to ourself, including info
+        bool    copyInfo(ADMImage *src);	/// copy all the flags, not the data themselves
+        bool    copyQuantInfo(ADMImage *src);	/// copy quant table if any
         bool    isRef(void) { if(_imageType==ADM_IMAGE_REF) return true;return false;};
-        uint8_t setLinkInfos(uint8_t *y,        /// To fill in infos for linked image
-                        uint8_t *u,uint8_t *v,uint32_t stridey,
-                        uint32_t strideu, uint32_t stridev);
-        uint8_t merge(ADMImage *src1,ADMImage *src2);
-        uint8_t substract(ADMImage *src1,ADMImage *src2);
-        uint8_t blacken(void);
-        uint8_t copyTo(ADMImage *target, uint32_t x, uint32_t y);
-        uint8_t copyToAlpha(ADMImage *target, uint32_t x, uint32_t y,uint32_t alpha);
-        uint8_t pack(uint8_t invertChroma);     /// Transfer data from planes to regular packed space
-        uint8_t copyLeftSideTo(ADMImage *dest);
+        bool    merge(ADMImage *src1,ADMImage *src2);
+        bool    substract(ADMImage *src1,ADMImage *src2);
+        bool    blacken(void);
+        bool    copyTo(ADMImage *target, uint32_t x, uint32_t y);
+        bool    copyToAlpha(ADMImage *target, uint32_t x, uint32_t y,uint32_t alpha);
+        bool    copyLeftSideTo(ADMImage *dest);
         /* Some utilitarian functions */
-        uint8_t  saveAsBmp(const char *filename);
-        uint8_t  saveAsJpg(const char *filename);
-        bool     printString(uint32_t x,uint32_t y, const char *strng);
+        bool    saveAsBmp(const char *filename);
+        bool    saveAsJpg(const char *filename);
+        bool    printString(uint32_t x,uint32_t y, const char *strng);
         
 static uint32_t lumaDiff(ADMImage *src1,ADMImage *src2,uint32_t noise);
 };
-void drawString(ADMImage *dst, int x, int y, const char *s) ;
-#define YPLANE(x) ((x)->data)
-#define UPLANE(x) ((x)->data+((x)->_width*(x)->_height))
-#define VPLANE(x) ((x)->data+(5*((x)->_width*(x)->_height)>>2))
 
 /**
-        \class ADMImageResizer
-        \brief Simple image resizer
+    \class ADMImageDefault
 */
-class ADMImageResizer
+class ADMImageDefault: public ADMImage
 {
-	private:
-		ADMColorScalerFull   *resizer;
-        ADM_colorspace orgFormat, destFormat;
-		uint32_t orgWidth, orgHeight;
-		uint32_t destWidth, destHeight;
-        void        init(uint32_t ow, uint32_t oh, uint32_t dw, uint32_t dh, ADM_colorspace srcFormat, ADM_colorspace dstFormat);
-	public:
-		ADMImageResizer(uint32_t ow,uint32_t oh, uint32_t dw, uint32_t dh);
-		ADMImageResizer(uint32_t ow, uint32_t oh, uint32_t dw, uint32_t dh, ADM_colorspace srcFormat, ADM_colorspace dstFormat);
-		~ADMImageResizer();
-		
-		uint8_t resize(ADMImage *src, ADMImage *dest);
-		uint8_t resize(uint8_t *src, ADMImage *dest);
-		uint8_t resize(ADMImage *src, uint8_t *dest);
-		uint8_t resize(uint8_t *src, uint8_t *dest);
+protected:
+                    uint8_t         *data;
+public:
+                                    ADMImageDefault(uint32_t w, uint32_t h);
+        virtual      ~ADMImageDefault();
+        virtual      uint32_t        GetPitch(ADM_PLANE plane);
+        virtual      uint8_t        *GetWritePtr(ADM_PLANE plane);
+        virtual      uint8_t        *GetReadPtr(ADM_PLANE plane);
+        virtual      bool           isWrittable(void);
 };
+/**
+    \class ADMImageRef
+*/
+class ADMImageRef: public ADMImage
+{
+public:
+        uint8_t         *_planes[3];     /// In case of linked data store y/u/v pointers
+        uint32_t        _planeStride[3]; /// Same story
 
+public:
+                        ADMImageRef(uint32_t w, uint32_t h);
+        virtual      ~ADMImageRef();
+        virtual      uint32_t        GetPitch(ADM_PLANE plane);
+        virtual      uint8_t        *GetWritePtr(ADM_PLANE plane);
+        virtual      uint8_t        *GetReadPtr(ADM_PLANE plane);
+        virtual      bool           isWrittable(void);
+        virtual      ADMImageRef    *castToRef(void) {return this;};
+};
+
+void drawString(ADMImage *dst, int x, int y, const char *s) ;
+
 // Misc utilities
-uint8_t BitBlit(uint8_t *dst, uint32_t pitchDest,uint8_t *src,uint32_t pitchSrc,uint32_t width, uint32_t height);
-uint8_t BitBlitAlpha(uint8_t *dst, uint32_t pitchDst,uint8_t *src,uint32_t pitchSrc,uint32_t width, uint32_t height,uint32_t alpha);
+bool BitBlit(uint8_t *dst, uint32_t pitchDest,uint8_t *src,uint32_t pitchSrc,uint32_t width, uint32_t height);
+bool BitBlitAlpha(uint8_t *dst, uint32_t pitchDst,uint8_t *src,uint32_t pitchSrc,uint32_t width, uint32_t height,uint32_t alpha);
 
 #endif

Added: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreImage/include/ADM_imageResizer.h
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreImage/include/ADM_imageResizer.h	2010-05-14 15:34:12 UTC (rev 6182)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreImage/include/ADM_imageResizer.h	2010-05-14 15:34:19 UTC (rev 6183)
@@ -0,0 +1,50 @@
+//
+// C++ Interface: %{MODULE}
+//
+// Description: 
+//
+//
+// Author: %{AUTHOR} <%{EMAIL}>, (C) %{YEAR}
+//
+// Copyright: See COPYING file that comes with this distribution
+//
+//
+//	This is the base time for image exchanged between codec/filters/...
+//
+//	We (optionnally) can carry extra informations
+//		- aspect ratio
+//		- frame type
+//		- quantizer for each macroblock (16x16 pixels)
+//      - PTS : Presentation time in us of the image
+//	For the latter 3 infos are used
+//		quant which leads to the int8 quant array
+//		qstride = stride of array. Usually width+15)/16. 0 MEANS NOT USABLE
+//		qsize = size of the array (needed to be able to copy it)
+//
+#ifndef ADM_IMAGE_RESIZER_H
+#define ADM_IMAGE_RESIZER_H
+#include "ADM_image.h"
+/**
+        \class ADMImageResizer
+        \brief Simple image resizer
+*/
+class ADMImageResizer
+{
+	private:
+		ADMColorScalerFull   *resizer;
+        ADM_colorspace orgFormat, destFormat;
+		uint32_t orgWidth, orgHeight;
+		uint32_t destWidth, destHeight;
+        void        init(uint32_t ow, uint32_t oh, uint32_t dw, uint32_t dh, ADM_colorspace srcFormat, ADM_colorspace dstFormat);
+	public:
+		ADMImageResizer(uint32_t ow,uint32_t oh, uint32_t dw, uint32_t dh);
+		ADMImageResizer(uint32_t ow, uint32_t oh, uint32_t dw, uint32_t dh, ADM_colorspace srcFormat, ADM_colorspace dstFormat);
+		~ADMImageResizer();
+		
+		uint8_t resize(ADMImage *src, ADMImage *dest);
+		uint8_t resize(uint8_t *src, ADMImage *dest);
+		uint8_t resize(ADMImage *src, uint8_t *dest);
+		uint8_t resize(uint8_t *src, uint8_t *dest);
+};
+
+#endif

Modified: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreImage/src/ADM_colorspace.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreImage/src/ADM_colorspace.cpp	2010-05-14 15:34:12 UTC (rev 6182)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreImage/src/ADM_colorspace.cpp	2010-05-14 15:34:19 UTC (rev 6183)
@@ -17,8 +17,8 @@
 
 #include "ADM_default.h"
 #include "ADM_colorspace.h"
+#include "ADM_image.h"
 
-
 extern "C" {
 #include "ADM_ffmpeg/libavcodec/avcodec.h"
 #include "ADM_ffmpeg/libavutil/avutil.h"
@@ -272,4 +272,26 @@
     return true;
 }
 
+/**
+    \fn convertColorSpace
+*/
+bool ADMColorScalerFull::convertImage(ADMImage *img, uint8_t *to)
+{
+    uint8_t *srcPlanes[3];
+    uint8_t *dstPlanes[3];
+    uint32_t srcPitch[3];
+    uint32_t dstPitch[3];
+    img->GetPitches(srcPitch);
+    img->GetReadPlanes(srcPlanes);
+    int w=img->_width;
+    int h=img->_height;
+    int plane=w*h;
+    dstPitch[0]=w;
+    dstPitch[1]=w/2;
+    dstPitch[2]=w/2;
+    dstPlanes[0]=to;
+    dstPlanes[1]=to+plane;
+    dstPlanes[2]=to+(plane*5)/4;;
+    return  convertPlanes(srcPitch,dstPitch,srcPlanes,dstPlanes);
+}
 //EOF

Modified: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreImage/src/ADM_image.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreImage/src/ADM_image.cpp	2010-05-14 15:34:12 UTC (rev 6182)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreImage/src/ADM_image.cpp	2010-05-14 15:34:19 UTC (rev 6183)
@@ -1,8 +1,6 @@
 /***************************************************************************
-    copyright            : (C) 2003-2005 by mean
-    email                : fixounet at free.fr
+    \author  MEan (C) 2003-20010 by mean fixounet at free.fr
  ***************************************************************************/
-
 /***************************************************************************
  *                                                                         *
  *   This program is free software; you can redistribute it and/or modify  *
@@ -34,345 +32,43 @@
 	printf("Cur image used               : %"LU"\n",imgCurNb);
 
 }
-//
-//	Allocate and initialize everything to default values
-//
-void    ADMImage::commonInit(uint32_t w,uint32_t h)
+/**
+    \fn ADMImage
+    \brief ctor
+*/
+ADMImage::ADMImage(uint32_t width, uint32_t height,ADM_IMAGE_TYPE type)
 {
-        _width=w;
-        _height=h;
-        quant=NULL;
-        _qStride=0;
+        _width=width;
+        _height=height;
         _Qp=2;
         flags=0;
-        _qSize=0;
         _aspect=ADM_ASPECT_1_1;
-
         imgCurNb++;
-        _planes[0]=_planes[1]=_planes[2]=NULL;
         _noPicture=0;
         _colorspace=ADM_COLOR_YV12;
         Pts=0;
-
-}
-/**
-    \fn ADMImage
-    \brief ctor
-*/
-ADMImage::ADMImage(uint32_t width, uint32_t height,ADM_IMAGE_TYPE type)
-{
-        commonInit(width,height);
         _imageType=type;
-        data=NULL;
-        _cookie=NULL;
-        _planes[0]=_planes[1]=_planes[2]=NULL;
-        switch(_imageType)
-        {
-            case ADM_IMAGE_DEFAULT:
-                data=new uint8_t [ ((width+15)&0xffffff0)*((height+15)&0xfffffff0)*2];
-                ADM_assert(data);
-                imgCurMem+=(width*height*3)>>1;
-                if(imgCurMem>imgMaxMem) imgMaxMem=imgCurMem;
-                if(imgCurNb>imgMaxNb) imgMaxNb=imgCurNb;
-                break;
-            case ADM_IMAGE_REF:
-                break;
-            case ADM_IMAGE_VDPAU:
-                break;
-            default:
-                ADM_assert(0);
-
-        }
-};
-//
-//	Deallocate
-//
-ADMImage::~ADMImage()
-{
-    if(_imageType==ADM_IMAGE_DEFAULT)
-    {
-       if(quant) delete [] quant;
-       quant=NULL;
-       if(data) delete [] data;
-       data=NULL;
-       imgCurMem-=(_width*_height*3)>>1;
-	}
-	imgCurNb--;
-
-}
-
-//
-//	Duplicate
-//
-uint8_t ADMImage::duplicateMacro(ADMImage *src,uint32_t swap)
-{
-        // Sanity check
-        ADM_assert(src->_width==_width);
-        ADM_assert(src->_height==_height);
-
-        ADM_assert(_imageType==ADM_IMAGE_DEFAULT); // could not duplicate to a linked data image
-
-        // cleanup if needed
-        if(quant) delete [] quant;
         quant=NULL;
-
-       _qStride=0;
+        _qStride=0;
         _qSize=0;
-
-        copyInfo(src);
-        if(src->_imageType==ADM_IMAGE_DEFAULT)
-        {
-               memcpy(YPLANE(this),YPLANE(src),_width*_height);
-                if(swap)
-                {
-                        memcpy(UPLANE(this),VPLANE(src),(_width*_height)>>2);
-                        memcpy(VPLANE(this),UPLANE(src),(_width*_height)>>2);
-                }
-                else
-                {
-                        memcpy(UPLANE(this),UPLANE(src),(_width*_height)>>2);
-                        memcpy(VPLANE(this),VPLANE(src),(_width*_height)>>2);
-                }
-        }
-        else
-        {
-                if(src->_imageType!=ADM_IMAGE_REF) ADM_assert(0);
-                if(src->_noPicture)
-                {
-                        // no pic available, blacken it
-                        memset(YPLANE(this),0,_width*_height);
-                        memset(UPLANE(this),128,(_width*_height)>>2);
-                        memset(VPLANE(this),128,(_width*_height)>>2);
-                        return 1;
-
-                }
-               // The source is a reference
-                // We have to use the alternate informations
-                // to copy & compact at the same time
-                //
-
-                ADM_assert(src->_planeStride[0]);
-                ADM_assert(src->_planeStride[1]);
-                ADM_assert(src->_planeStride[2]);
-
-                ADM_assert(src->_planes[0]);
-                ADM_assert(src->_planes[1]);
-                ADM_assert(src->_planes[2]);
-
-                uint8_t *in,*out;
-                uint32_t w,h,stride;
-
-                w=src->_width;
-                h=src->_height;
-                stride=src->_planeStride[0];
-                out=YPLANE(this);
-                in=src->_planes[0];
-#define PLANE_CPY(h) \
-                for(uint32_t y=0;y<h;y++)  \
-                { \
-                        memcpy(out,in,w); \
-                        in+=stride;       \
-                        out+=w;           \
-                }
-                PLANE_CPY(h);
-
-                w>>=1;
-                h>>=1;
-                in=src->_planes[1];
-                if(swap)
-                        out=VPLANE(this);
-                else
-                        out=UPLANE(this);
-                stride=src->_planeStride[1];
-                PLANE_CPY(h);
-
-                in=src->_planes[2];
-                if(swap)
-                        out=UPLANE(this);
-                else
-                        out=VPLANE(this);
-                stride=src->_planeStride[2];
-                PLANE_CPY(h);
-
-
-        }
-        return 1;
-}
-uint8_t ADMImage::duplicate(ADMImage *src)
-{
-	return duplicateMacro(src,0);
-}
-uint8_t ADMImage::duplicateSwapUV(ADMImage *src)
-{
-        return duplicateMacro(src,0);
-}
-uint8_t ADMImage::pack(uint8_t invertChroma)
-{
-int u=1,v=2;
-    if(invertChroma) {u=2;v=1;}
-    ADM_assert(_planeStride[0]>=_width);
-    // Pack luma
-    uint8_t *src,*dest;
-
-    src=_planes[0];
-    dest=YPLANE(this);
-    BitBlit(dest,_width,src,_planeStride[0],_width,_height);
-
-    src=_planes[u];
-    dest=UPLANE(this);
-    BitBlit(dest,_width>>1,src,_planeStride[u],_width>>1,_height>>1);
-
-    src=_planes[v];
-    dest=VPLANE(this);
-    BitBlit(dest,_width>>1,src,_planeStride[v],_width>>1,_height>>1);
-
-    return 1;
-}
-uint8_t ADMImage::duplicateFull(ADMImage *src)
-{
-	// Sanity check
-	ADM_assert(src->_width==_width);
-	ADM_assert(src->_height==_height);
-
-
-	copyInfo(src);
-    ADM_assert(_imageType==ADM_IMAGE_DEFAULT);
-
-	memcpy(YPLANE(this),YPLANE(src),_width*_height);
-	memcpy(UPLANE(this),UPLANE(src),(_width*_height)>>2);
-	memcpy(VPLANE(this),VPLANE(src),(_width*_height)>>2);
-	copyQuantInfo(src);
-
-	return 1;
-}
+};
 /**
-    \fn copyInfo
-    \brief Copy the additionnal infos attached to an image (flags/aspect ration/PTS)
-*/
-uint8_t ADMImage::copyInfo(ADMImage *src)
-{
-	_Qp=src->_Qp;
-	flags=src->flags;
-	_aspect=src->_aspect;
-    Pts=src->Pts;
-    return 1;
-}
-//
-//	By design the reallocation of quant should happen at startup
-//	but not in processing itself (reuse already allocated quant)
-//	It may seem shoddy, but it adds flexibility
-//
-uint8_t ADMImage::copyQuantInfo(ADMImage *src)
-{
-	if(!src->_qStride || !src->_qSize)  // No (usable) quant
-	{
-		_qStride=0;
-		return 1;
-	}
-	// Reuse Quant memory ?
-	if(!quant)
-	{	// need a new quant
-		quant=new uint8_t[src->_qSize];
-		_qSize=src->_qSize;
+    \fn ADMImage
+    \brief dtor
 
-	}
-
-	// Same size ?
-	ADM_assert(_qSize==src->_qSize);
-	_qStride=src->_qStride;
-	memcpy(quant,src->quant,_qSize);
-
-	return 1;
-}
-uint8_t ADMImage::blacken(void)
-{
-        memset(YPLANE(this),0,_width*_height);
-        memset(UPLANE(this),128,(_width*_height)>>2);
-        memset(VPLANE(this),128,(_width*_height)>>2);
-        return 1;
-
-}
-/*
-    Copy "this" image into dest image at x,y position
-
 */
-uint8_t ADMImage::copyTo(ADMImage *dest, uint32_t x,uint32_t y)
+ADMImage::~ADMImage()
 {
+	imgCurNb--;
 
-    uint32_t box_w=_width, box_h=_height;
-    // Clip if needed
-    if(y>dest->_height)
-    {
-        printf("Y out : %u %u\n",y,dest->_height);
-         return 1;
-    }
-    if(x>dest->_width)
-    {
-        printf("X out : %u %u\n",x,dest->_width);
-         return 1;
-    }
-
-    if(x+box_w>dest->_width) box_w=dest->_width-x;
-    if(y+box_h>dest->_height) box_h=dest->_height-y;
-
-    // do y
-    BitBlit(YPLANE(dest)+x+dest->_width*y,dest->_width,
-            data,_width,
-            box_w,box_h);
-    // Do u
-    BitBlit(UPLANE(dest)+x/2+(dest->_width*y)/4,dest->_width/2,
-            UPLANE(this),_width>>1,
-            box_w>>1,box_h>>1);
-
-    BitBlit(VPLANE(dest)+x/2+(dest->_width*y)/4,dest->_width/2,
-            VPLANE(this),_width>>1,
-            box_w>>1,box_h>>1);
-
-
-    return 1;
-
 }
-/*
-    \fn    copyToAlpha
-    \brief Copy "this" image into dest image at x,y position using alpha alpha
-    @param alpha alpha value (0--255)
 
-*/
-uint8_t ADMImage::copyToAlpha(ADMImage *dest, uint32_t x,uint32_t y,uint32_t alpha)
-{
 
-    uint32_t box_w=_width, box_h=_height;
-    // Clip if needed
-    if(y>dest->_height)
-    {
-        printf("Y out : %u %u\n",y,dest->_height);
-         return 1;
-    }
-    if(x>dest->_width)
-    {
-        printf("X out : %u %u\n",x,dest->_width);
-         return 1;
-    }
-
-    if(x+box_w>dest->_width) box_w=dest->_width-x;
-    if(y+box_h>dest->_height) box_h=dest->_height-y;
-
-    // do y
-    BitBlitAlpha(YPLANE(dest)+x+dest->_width*y,dest->_width,         data,_width,            box_w,box_h,alpha);
-    // Do u
-    BitBlitAlpha(UPLANE(dest)+x/2+(dest->_width*y)/4,dest->_width/2,   UPLANE(this),_width>>1,  box_w>>1,box_h>>1,alpha);
-    // and V
-    BitBlitAlpha(VPLANE(dest)+x/2+(dest->_width*y)/4,dest->_width/2, VPLANE(this),_width>>1, box_w>>1,box_h>>1,alpha);
-
-
-    return 1;
-
-}
 /**
  * 		\fn BitBlitAlpha
  * 		\brief Alpha blit from dst to src
  */
-uint8_t BitBlitAlpha(uint8_t *dst, uint32_t pitchDst,uint8_t *src,uint32_t pitchSrc,
+bool BitBlitAlpha(uint8_t *dst, uint32_t pitchDst,uint8_t *src,uint32_t pitchSrc,
 		uint32_t width, uint32_t height,uint32_t alpha)
 {
 
@@ -392,7 +88,7 @@
     return 1;
 }
 
-uint8_t BitBlit(uint8_t *dst, uint32_t pitchDst,uint8_t *src,uint32_t pitchSrc,uint32_t width, uint32_t height)
+bool BitBlit(uint8_t *dst, uint32_t pitchDst,uint8_t *src,uint32_t pitchSrc,uint32_t width, uint32_t height)
 {
 
     for(int y=0;y<height;y++)
@@ -403,4 +99,68 @@
     }
     return 1;
 }
+//****************************************
+/**
+    \fn ADMImageDefault
+    \brief ctor
+
+*/
+ADMImageDefault::ADMImageDefault(uint32_t w, uint32_t h) : ADMImage(w,h,ADM_IMAGE_DEFAULT)
+{
+    data=new uint8_t [(w*h*3)/2];
+}
+/**
+    \fn ADMImageDefault
+    \brief dtor
+*/
+ADMImageDefault::~ADMImageDefault()
+{
+    if(data) delete [] data;
+    data=NULL;
+}
+bool           ADMImageDefault::isWrittable(void) {return true;}
+uint32_t       ADMImageDefault::GetPitch(ADM_PLANE plane)
+                    {
+                            if(plane==PLANAR_Y) return _width;
+                            return _width/2;
+                        }
+uint8_t        *ADMImageDefault::GetWritePtr(ADM_PLANE plane) {return GetReadPtr(plane);}
+uint8_t        *ADMImageDefault::GetReadPtr(ADM_PLANE plane)
+{
+    int xplane=_width*_height;
+    switch(plane)
+    {
+        case PLANAR_Y: return data;
+        case PLANAR_U: return data+xplane;
+        case PLANAR_V: return data+(5*xplane)/4;
+    }
+}
+//****************************************
+/**
+    \fn ADMImageRef
+    \brief ctor
+
+*/
+ADMImageRef::ADMImageRef(uint32_t w, uint32_t h) : ADMImage(w,h,ADM_IMAGE_REF)
+{
+    _planes[0]=_planes[1]=_planes[2]=NULL;
+    _planeStride[0]=_planeStride[1]=_planeStride[2]=0;
+}
+/**
+    \fn ADMImageRef
+    \brief dtor
+*/
+ADMImageRef::~ADMImageRef()
+{
+}
+bool           ADMImageRef::isWrittable(void) {return false;}
+uint32_t       ADMImageRef::GetPitch(ADM_PLANE plane)
+                    {
+                          return _planeStride[plane];
+                        }
+uint8_t        *ADMImageRef::GetWritePtr(ADM_PLANE plane) {return NULL;}
+uint8_t        *ADMImageRef::GetReadPtr(ADM_PLANE plane)
+{
+    return _planes[plane];
+}
 //EOF

Added: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreImage/src/ADM_imageOperation.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreImage/src/ADM_imageOperation.cpp	2010-05-14 15:34:12 UTC (rev 6182)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreImage/src/ADM_imageOperation.cpp	2010-05-14 15:34:19 UTC (rev 6183)
@@ -0,0 +1,195 @@
+/***************************************************************************
+    copyright            : (C) 2003-2005 by mean
+    email                : fixounet at free.fr
+ ***************************************************************************/
+
+/***************************************************************************
+ *                                                                         *
+ *   This program is free software; you can redistribute it and/or modify  *
+ *   it under the terms of the GNU General Public License as published by  *
+ *   the Free Software Foundation; either version 2 of the License, or     *
+ *   (at your option) any later version.                                   *
+ *                                                                         *
+ ***************************************************************************/
+
+
+#include "ADM_default.h"
+#include "ADM_image.h"
+/**
+    \fn duplicateMacro
+    \brief copy src to this, swapping u&v possibly
+*/
+bool ADMImage::duplicateMacro(ADMImage *src,bool swap)
+{
+#warning handle swap
+        // Sanity check
+        ADM_assert(src->_width==_width);
+        ADM_assert(src->_height==_height);
+        ADM_assert(isWrittable()==true); // could not duplicate to a linked data image
+        copyInfo(src);
+        uint32_t sourceStride,destStride;
+        uint8_t  *source,*dest;
+
+        for(int plane=PLANAR_Y;plane<PLANAR_LAST;plane++)
+        {
+            source=src->GetReadPtr((ADM_PLANE)plane);
+            dest=this->GetWritePtr((ADM_PLANE)plane);
+            sourceStride=src->GetPitch((ADM_PLANE)plane);
+            destStride=this->GetPitch((ADM_PLANE)plane);
+            int opHeight=_height;
+            int opWidth=_width;
+            if(plane!=PLANAR_Y) 
+            {
+                opHeight>>=1;
+                opWidth>>=1;
+            }
+            BitBlit(dest, destStride,source,sourceStride,opWidth, opHeight);
+        }
+        return true;
+}
+/**
+    \fn duplicate
+*/
+bool ADMImage::duplicate(ADMImage *src)
+{
+	return duplicateMacro(src,false);
+}
+/**
+    \fn duplicateFull
+    \brief copy data + info (pts...)
+*/
+bool ADMImage::duplicateFull(ADMImage *src)
+{
+	// Sanity check
+	ADM_assert(src->_width==_width);
+	ADM_assert(src->_height==_height);
+
+
+	copyInfo(src);
+    duplicate(src);
+	return 1;
+}
+/**
+    \fn copyInfo
+    \brief Copy the additionnal infos attached to an image (flags/aspect ration/PTS)
+*/
+bool ADMImage::copyInfo(ADMImage *src)
+{
+	_Qp=src->_Qp;
+	flags=src->flags;
+	_aspect=src->_aspect;
+    Pts=src->Pts;
+    return 1;
+}
+/**
+    \fn blacken
+*/
+bool ADMImage::blacken(void)
+{
+        ADM_assert(isWrittable()==true); // could not duplicate to a linked data image
+        uint32_t sourceStride,destStride;
+        uint8_t  *source,*dest;
+
+        for(int plane=PLANAR_Y;plane<PLANAR_LAST;plane++)
+        {
+            dest=this->GetWritePtr((ADM_PLANE)plane);
+            destStride=this->GetPitch((ADM_PLANE)plane);
+            int opHeight=_height;
+            int opWidth=_width;
+            uint8_t color=0;
+            if(plane!=PLANAR_Y) 
+            {
+                opHeight>>=1;
+                opWidth>>=1;
+                color=128;
+            }
+            for(int y=0;y<opHeight;y++)
+            {
+                memset(dest,color,opWidth);
+                dest+=destStride;
+            }
+        }
+        return true;
+}
+/**
+    \fn copyTo
+    \brief  Copy "this" image into dest image at x,y position
+
+*/
+bool ADMImage::copyTo(ADMImage *dest, uint32_t x,uint32_t y)
+{
+    ADM_assert(0);
+#warning not implemented
+#if 0    
+    uint32_t box_w=_width, box_h=_height;
+    // Clip if needed
+    if(y>dest->_height)
+    {
+        printf("Y out : %u %u\n",y,dest->_height);
+         return 1;
+    }
+    if(x>dest->_width)
+    {
+        printf("X out : %u %u\n",x,dest->_width);
+         return 1;
+    }
+
+    if(x+box_w>dest->_width) box_w=dest->_width-x;
+    if(y+box_h>dest->_height) box_h=dest->_height-y;
+
+    // do y
+    BitBlit(YPLANE(dest)+x+dest->_width*y,dest->_width,
+            data,_width,
+            box_w,box_h);
+    // Do u
+    BitBlit(UPLANE(dest)+x/2+(dest->_width*y)/4,dest->_width/2,
+            UPLANE(this),_width>>1,
+            box_w>>1,box_h>>1);
+
+    BitBlit(VPLANE(dest)+x/2+(dest->_width*y)/4,dest->_width/2,
+            VPLANE(this),_width>>1,
+            box_w>>1,box_h>>1);
+
+#endif
+    return 1;
+
+}
+/**
+    \fn    copyToAlpha
+    \brief Copy "this" image into dest image at x,y position using alpha alpha
+    @param alpha alpha value (0--255)
+
+*/
+bool ADMImage::copyToAlpha(ADMImage *dest, uint32_t x,uint32_t y,uint32_t alpha)
+{
+#warning not implemented
+    ADM_assert(0);
+#if 0
+    uint32_t box_w=_width, box_h=_height;
+    // Clip if needed
+    if(y>dest->_height)
+    {
+        printf("Y out : %u %u\n",y,dest->_height);
+         return 1;
+    }
+    if(x>dest->_width)
+    {
+        printf("X out : %u %u\n",x,dest->_width);
+         return 1;
+    }
+
+    if(x+box_w>dest->_width) box_w=dest->_width-x;
+    if(y+box_h>dest->_height) box_h=dest->_height-y;
+
+    // do y
+    BitBlitAlpha(YPLANE(dest)+x+dest->_width*y,dest->_width,         data,_width,            box_w,box_h,alpha);
+    // Do u
+    BitBlitAlpha(UPLANE(dest)+x/2+(dest->_width*y)/4,dest->_width/2,   UPLANE(this),_width>>1,  box_w>>1,box_h>>1,alpha);
+    // and V
+    BitBlitAlpha(VPLANE(dest)+x/2+(dest->_width*y)/4,dest->_width/2, VPLANE(this),_width>>1, box_w>>1,box_h>>1,alpha);
+
+#endif
+    return 1;
+}
+
+//EOF

Modified: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreImage/src/ADM_imageResizer.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreImage/src/ADM_imageResizer.cpp	2010-05-14 15:34:12 UTC (rev 6182)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreImage/src/ADM_imageResizer.cpp	2010-05-14 15:34:19 UTC (rev 6183)
@@ -13,7 +13,7 @@
  ***************************************************************************/
 #include "ADM_default.h"
 
-#include "ADM_image.h"
+#include "ADM_imageResizer.h"
 
 extern "C" {
 #include "ADM_ffmpeg/libavcodec/avcodec.h"
@@ -59,24 +59,69 @@
     ADM_assert(source->_height == orgHeight);
     ADM_assert(dest->_width == destWidth);
     ADM_assert(dest->_height == destHeight);
+    ADM_assert(dest->isWrittable()==true)
+    uint32_t srcStride[3];
+    uint32_t dstStride[3];
+    uint8_t  *srcPtr[3];
+    uint8_t  *dstPtr[3];
+    for(int i=PLANAR_Y;i<PLANAR_LAST;i++)
+    {
+        srcStride[i]=source->GetPitch((ADM_PLANE)i);
+        dstStride[i]=dest->GetPitch((ADM_PLANE)i);
+        srcPtr[i]=source->GetReadPtr((ADM_PLANE)i);
+        dstPtr[i]=dest->GetWritePtr((ADM_PLANE)i);
+     }
 
-	return resizer->convert(source->data, dest->data);
+     return resizer->convertPlanes(srcStride,dstStride,srcPtr,dstPtr);
 }
 
 uint8_t ADMImageResizer::resize(ADMImage *source, uint8_t *dest)
 {
     ADM_assert(source->_width == orgWidth);
     ADM_assert(source->_height == orgHeight);
+    uint32_t srcStride[3];
+    uint32_t dstStride[3];
+    uint8_t  *srcPtr[3];
+    uint8_t  *dstPtr[3];
+    for(int i=PLANAR_Y;i<PLANAR_LAST;i++)
+    {
+        srcStride[i]=source->GetPitch((ADM_PLANE)i);
+        srcPtr[i]=source->GetReadPtr((ADM_PLANE)i);
+     }
+        dstStride[0]=destWidth;
+        dstStride[1]=destWidth>>1;
+        dstStride[2]=destWidth>>1;
+        uint32_t plane=destWidth*destHeight;
+        dstPtr[0]=dest;
+        dstPtr[1]=dest+plane;
+        dstPtr[2]=dest+((5*plane)>>2);
 
-	return resizer->convert(source->data, dest);
+	return resizer->convertPlanes(srcStride,dstStride,srcPtr,dstPtr);
 }
 
 uint8_t ADMImageResizer::resize(uint8_t *source, ADMImage *dest)
 {
     ADM_assert(dest->_width == destWidth);
     ADM_assert(dest->_height == destHeight);
+    ADM_assert(dest->isWrittable()==true)
+    uint32_t srcStride[3];
+    uint32_t dstStride[3];
+    uint8_t  *srcPtr[3];
+    uint8_t  *dstPtr[3];
+    for(int i=PLANAR_Y;i<PLANAR_LAST;i++)
+    {
+        dstStride[i]=dest->GetPitch((ADM_PLANE)i);
+        dstPtr[i]=dest->GetWritePtr((ADM_PLANE)i);
+     }
+        srcStride[0]=orgWidth;
+        srcStride[1]=orgWidth>>1;
+        srcStride[2]=orgWidth>>1;
+        uint32_t plane=orgWidth*orgHeight;
+        srcPtr[0]=source;
+        srcPtr[1]=source+plane;
+        srcPtr[2]=source+((5*plane)>>2);
 
-	return resizer->convert(source, dest->data);
+	return resizer->convertPlanes(srcStride,dstStride,srcPtr,dstPtr);
 }
 
 

Modified: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreImage/src/ADM_imageSave.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreImage/src/ADM_imageSave.cpp	2010-05-14 15:34:12 UTC (rev 6182)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreImage/src/ADM_imageSave.cpp	2010-05-14 15:34:19 UTC (rev 6183)
@@ -37,7 +37,7 @@
     \fn saveAsBmp
     \brief save current image into filename, into bmp format
 */
-uint8_t  ADMImage::saveAsBmp(const char *filename)
+bool  ADMImage::saveAsBmp(const char *filename)
 {
   ADM_BITMAPFILEHEADER bmfh;
   ADM_BITMAPINFOHEADER bmph;
@@ -68,7 +68,7 @@
 	bmph.colorEncoding=0;
 */
 
-  ADMImage image(_width,_height);
+  ADMImageDefault image(_width,_height);
 
 
   printf ("\n %u x %u=%u\n", bmph.biWidth, bmph.biHeight, sz);
@@ -142,7 +142,7 @@
     \fn saveAsJpg
     \brief save current image into filename, into jpg format
 */
-uint8_t  ADMImage::saveAsJpg(const char *filename)
+bool  ADMImage::saveAsJpg(const char *filename)
 {
 
 AVCodecContext   *context=NULL;   

Modified: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreImage/src/ADM_imageUtils.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreImage/src/ADM_imageUtils.cpp	2010-05-14 15:34:12 UTC (rev 6182)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreImage/src/ADM_imageUtils.cpp	2010-05-14 15:34:19 UTC (rev 6183)
@@ -112,7 +112,7 @@
 
 #endif
 
-uint8_t ADMImage::merge(ADMImage *src1,ADMImage *src2)
+bool ADMImage::merge(ADMImage *src1,ADMImage *src2)
 {
 #ifdef ADM_CPU_X86
         if(CpuCaps::hasMMX())
@@ -331,7 +331,7 @@
 }
 #endif
 
-uint8_t ADMImage::substract(ADMImage *src1,ADMImage *src2)
+bool ADMImage::substract(ADMImage *src1,ADMImage *src2)
 {
 
 #ifdef ADM_CPU_X86
@@ -344,39 +344,12 @@
         return tinySubstract(YPLANE(this),YPLANE(src1),YPLANE(src2),src1->_width*src1->_height);
 }
   
-/**
-      \fn LumaReduceBy2
-      \brief Very simple reduce by 2 both hz & vz for luma plane only.
-*/
- uint8_t   ADMImage::LumaReduceBy2(void)
-{
-  uint8_t *ptr1,*ptr2,*outptr;
-  for(int y=0;y<_height>>1;y++)
-  {
-    
-    ptr1=data+y*_width*2;
-    ptr2=ptr1+_width;
-    outptr=data+(_width>>1)*y;
-    for(int x=0;x<_width>>1;x++)
-    {
-      uint32_t a,b,c,d;  
-          a=ptr1[0]+ptr1[1];
-          b=ptr2[0]+ptr2[1];
-          ptr1+=2;
-          ptr2+=2;
-          a=(a+b)>>2;
-          *outptr++=a;
-    }
-  }
-  return 1;
-  
-}
  /**
   *		\fn  copyLeftSideTo
   * 	\brief Copy half the image (left part) to dest
   * 	@param dest : Image to copy to 
   */
- uint8_t ADMImage::copyLeftSideTo(ADMImage *dest)
+ bool ADMImage::copyLeftSideTo(ADMImage *dest)
  {
 		uint8_t *src,*dst;
 		uint32_t stride;

Modified: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreImage/src/CMakeLists.txt
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreImage/src/CMakeLists.txt	2010-05-14 15:34:12 UTC (rev 6182)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreImage/src/CMakeLists.txt	2010-05-14 15:34:19 UTC (rev 6183)
@@ -16,6 +16,7 @@
 #        ADM_interlaceUtil.cpp
 #        DIA_flyDialog.cpp
         ADM_imageSave.cpp
+        ADM_imageOperation.cpp
 )
 
 ADD_LIBRARY(ADM_coreImage6 SHARED ${ADM_coreImage_SRCS})

Modified: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreImageLoader/src/ADM_imageLoader.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreImageLoader/src/ADM_imageLoader.cpp	2010-05-14 15:34:12 UTC (rev 6182)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreImageLoader/src/ADM_imageLoader.cpp	2010-05-14 15:34:19 UTC (rev 6183)
@@ -148,7 +148,7 @@
 		    fclose(fd);
 		  //
 		    
-		    ADMImage tmpImage(w,h,ADM_IMAGE_REF); // It is a reference image
+		    ADMImageRef tmpImage(w,h); // It is a reference image
 		    // Now unpack it ...
             decoders *dec=ADM_coreCodecGetDecoder (fourCC::get((uint8_t *)"MJPG"),   w,   h, 0 , NULL,0);
             if(!dec)
@@ -168,14 +168,14 @@
 		    case ADM_COLOR_YV12:
 		    {
 		    	ADM_info("[imageLoader] YV12\n");
-	    		image=new ADMImage(w,h);
+	    		image=new ADMImageDefault(w,h);
 	    		image->duplicate(&tmpImage);
 	    		break;
 		    }
 		    case ADM_COLOR_YUV422:
 		    {
 		    	ADM_info("[imageLoader] YUY2\n");
-		    	image=new ADMImage(w,h);
+		    	image=new ADMImageDefault(w,h);
                 ADMColorScalerSimple convert(w,h,ADM_COLOR_YUV422,ADM_COLOR_YV12);
                 uint32_t dstStride[3]={w,w/2,w/2};
                 uint8_t  *dstData[3]={YPLANE(image),UPLANE(image),VPLANE(image)};
@@ -244,8 +244,8 @@
 		    
 		  // Colorconversion
 		    
-            ADMImage *image=new ADMImage(w,h);
-            ADM_ConvertRgb24ToYV12(false,w,h,data,image->data);
+            ADMImage *image=new ADMImageDefault(w,h);
+            ADM_ConvertRgb24ToYV12(false,w,h,data,YPLANE(image));
             
 		    
 		    delete [] data;
@@ -294,8 +294,8 @@
     
   // Colorconversion
     
-    	ADMImage *image=new ADMImage(w,h);
-        ADM_ConvertRgb24ToYV12(true,w,h,data,image->data);
+    	ADMImage *image=new ADMImageDefault(w,h);
+        ADM_ConvertRgb24ToYV12(true,w,h,data,YPLANE(image));
     	
     
     	delete [] data;
@@ -328,7 +328,7 @@
  	   uint8_t *data=new uint8_t[size];
  	   fread(data,size,1,fd);
  	   fclose(fd);
- 	   ADMImage tmpImage(w,h,ADM_IMAGE_REF);
+ 	   ADMImageRef tmpImage(w,h);
     	// Decode PNG
         decoders *dec=ADM_coreCodecGetDecoder (fourCC::get((uint8_t *)"PNG "),   w,   h, 0 , NULL,0);
     	if(!dec)
@@ -342,8 +342,8 @@
     			    
     	dec->uncompress (&bin, &tmpImage);
     	
-    	ADMImage *image=new ADMImage(w,h);
-        ADM_ConvertRgb24ToYV12(true,w,h,tmpImage._planes[0],image->data);
+    	ADMImage *image=new ADMImageDefault(w,h);
+        ADM_ConvertRgb24ToYV12(true,w,h,tmpImage._planes[0],YPLANE(image));
     
     	delete [] data;
         delete dec;

Modified: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreVideoCodec/include/ADM_codecNull.h
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreVideoCodec/include/ADM_codecNull.h	2010-05-14 15:34:12 UTC (rev 6182)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreVideoCodec/include/ADM_codecNull.h	2010-05-14 15:34:19 UTC (rev 6183)
@@ -28,7 +28,27 @@
   };
   virtual bool uncompress (ADMCompressedImage * in, ADMImage * out)
   {
-    memcpy (out->data, in->data, in->dataLength);
+    for(int i=PLANAR_Y;i<PLANAR_LAST;i++)
+    {
+        uint32_t pitch=out->GetPitch((ADM_PLANE)i);
+        uint32_t line=_w;
+        uint32_t colmn=_h;
+        uint8_t *dest=out->GetWritePtr((ADM_PLANE)i);
+        if(i!=PLANAR_Y)
+        {
+            line>>=1;
+            colmn>>=1;
+        }
+        uint8_t *src;
+        int plane=_w*_h;
+        switch(i)
+        {
+             case PLANAR_Y: src=in->data;break;
+             case PLANAR_U: src=in->data+plane;break;
+             case PLANAR_V: src=in->data+((plane*5)>>2);break;
+        }
+        BitBlit(dest, pitch,src,line,line,colmn);
+    }
     uint64_t pts,dts;
     pts=in->demuxerPts;
     dts=in->demuxerDts;

Modified: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreVideoCodec/src/ADM_ffmp43.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreVideoCodec/src/ADM_ffmp43.cpp	2010-05-14 15:34:12 UTC (rev 6182)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreVideoCodec/src/ADM_ffmp43.cpp	2010-05-14 15:34:19 UTC (rev 6183)
@@ -70,8 +70,9 @@
 {
   uint32_t    u,v;
   ADM_assert(out->isRef());
-  out->_planes[0] = (uint8_t *) src->data[0];
-  out->_planeStride[0] = src->linesize[0];
+  ADMImageRef *ref=out->castToRef();
+  ref->_planes[0] = (uint8_t *) src->data[0];
+  ref->_planeStride[0] = src->linesize[0];
   if (_swapUV)
     {
       u = 1;
@@ -82,11 +83,11 @@
       u = 2;
       v = 1;
     }
-  out->_planes[1] = (uint8_t *) src->data[u];
-  out->_planeStride[1] = src->linesize[u];
+  ref->_planes[1] = (uint8_t *) src->data[u];
+  ref->_planeStride[1] = src->linesize[u];
 
-  out->_planes[2] = (uint8_t *) src->data[v];
-  out->_planeStride[2] = src->linesize[v];
+  ref->_planes[2] = (uint8_t *) src->data[v];
+  ref->_planeStride[2] = src->linesize[v];
 
   _lastQ = 0;			//_context->quality;
   out->_Qp = (src->quality * 32) / FF_LAMBDA_MAX;
@@ -384,8 +385,7 @@
 	  out->flags = AVI_KEY_FRAME;
 	  if (!_refCopy)
 	    {
-	      memset (out->data, 0, _w * _h);
-	      memset (out->data + _w * _h, 128, (_w * _h) >> 1);
+            out->blacken();
 	    }
 	  else
 	    {

Modified: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreVideoCodec/src/ADM_png.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreVideoCodec/src/ADM_png.cpp	2010-05-14 15:34:12 UTC (rev 6182)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreVideoCodec/src/ADM_png.cpp	2010-05-14 15:34:19 UTC (rev 6183)
@@ -146,17 +146,18 @@
       goto gain2;
     }
   ADM_assert (out->isRef());
-  out->_planes[0] = decoded;
-  out->_planes[1] = NULL;
-  out->_planes[2] = NULL;
+  ADMImageRef *ref=out->castToRef();
+  ref->_planes[0] = decoded;
+  ref->_planes[1] = NULL;
+  ref->_planes[2] = NULL;
   if (colorspace == ADM_COLOR_RGB32A)
-    out->_planeStride[0] = _w * 4;
+    ref->_planeStride[0] = _w * 4;
 
   else
-    out->_planeStride[0] = _w * 3;
-  out->_planeStride[1] = 0;
-  out->_planeStride[2] = 0;
-  out->_colorspace = colorspace;
+    ref->_planeStride[0] = _w * 3;
+  ref->_planeStride[1] = 0;
+  ref->_planeStride[2] = 0;
+  ref->_colorspace = colorspace;
   Cleanup ();
   return true;
 }

Modified: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreVideoCodec/src/ADM_rgb16.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreVideoCodec/src/ADM_rgb16.cpp	2010-05-14 15:34:12 UTC (rev 6182)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreVideoCodec/src/ADM_rgb16.cpp	2010-05-14 15:34:19 UTC (rev 6183)
@@ -103,17 +103,17 @@
 	}
 
 	ADM_assert(out->isRef());
-
+    ADMImageRef *ref=out->castToRef();
 	out->flags = AVI_KEY_FRAME;
 	out->_colorspace = (ADM_colorspace)(colorspace | ADM_COLOR_BACKWARD);
 
-	out->_planes[0] = decoded;
-	out->_planes[1] = NULL;
-	out->_planes[2] = NULL;
+	ref->_planes[0] = decoded;
+	ref->_planes[1] = NULL;
+	ref->_planes[2] = NULL;
 
-	out->_planeStride[0] = (_bpp / 8) * _w;
-	out->_planeStride[1] = 0;
-	out->_planeStride[2] = 0;
+	ref->_planeStride[0] = (_bpp / 8) * _w;
+	ref->_planeStride[1] = 0;
+	ref->_planeStride[2] = 0;
 
 	return 1;
 }

Modified: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreVideoCodec/src/ADM_uyvy.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreVideoCodec/src/ADM_uyvy.cpp	2010-05-14 15:34:12 UTC (rev 6182)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreVideoCodec/src/ADM_uyvy.cpp	2010-05-14 15:34:19 UTC (rev 6183)
@@ -17,7 +17,9 @@
 #include "avifmt2.h"
 #include "fourcc.h"
 #include "ADM_uyvy.h"
-
+/**
+    \fn uncompress
+*/
 bool   decoderUYVY::uncompress (ADMCompressedImage * in, ADMImage * out)
 {
 
@@ -52,6 +54,9 @@
     return 1;
 
 }
+/**
+    \fn uncompress
+*/
 bool   decoderYUY2::uncompress  (ADMCompressedImage * in, ADMImage * out)
 {
 
@@ -61,13 +66,13 @@
       return 1;
     }
   uint8_t *ptrY, *ptrU, *ptrV, *ptr;
-
+  ADM_assert(out->_imageType=ADM_IMAGE_DEFAULT);
   ptr = in->data;
-  ptrY = out->data;
-  ptrV = out->data + _w * _h;
-  ptrU = out->data + ((_w * _h * 5) >> 2);
-
-
+  ptrY = YPLANE(out);
+  ptrV = VPLANE(out);
+  ptrU = UPLANE(out);
+  ADM_assert(_w==out->GetPitch(PLANAR_Y));
+  ADM_assert(_w/2==out->GetPitch(PLANAR_U));
   for (uint32_t y = 0; y < _h; y++)
     for (uint32_t x = 0; x < (_w >> 1); x++)
       {

Modified: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreVideoEncoder/include/ADM_coreVideoEncoderFFmpeg.h
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreVideoEncoder/include/ADM_coreVideoEncoderFFmpeg.h	2010-05-14 15:34:12 UTC (rev 6182)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreVideoEncoder/include/ADM_coreVideoEncoderFFmpeg.h	2010-05-14 15:34:19 UTC (rev 6183)
@@ -47,6 +47,7 @@
                float            timeScaler;
               
 protected:
+
     virtual               bool             prolog(void); 
     virtual               bool             preEncode(void); 
     virtual               bool             setup(CodecID codecId);

Modified: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreVideoEncoder/src/ADM_coreVideoEncoderFFmpeg.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreVideoEncoder/src/ADM_coreVideoEncoderFFmpeg.cpp	2010-05-14 15:34:12 UTC (rev 6182)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreVideoEncoder/src/ADM_coreVideoEncoderFFmpeg.cpp	2010-05-14 15:34:19 UTC (rev 6183)
@@ -44,7 +44,7 @@
     w=getWidth();
     h=getHeight();
 
-    image=new ADMImage(w,h);
+    image=new ADMImageDefault(w,h);
     _context = avcodec_alloc_context2 (CODEC_TYPE_VIDEO);
     ADM_assert (_context);
     memset (&_frame, 0, sizeof (_frame));
@@ -223,7 +223,7 @@
               int w=getWidth();
               int h=getHeight();
 
-                if(!colorSpace->convert(image->data,rgbBuffer))
+                if(!colorSpace->convertImage(image,rgbBuffer))
                 {
                     printf("[ADM_jpegEncoder::encode] Colorconversion failed\n");
                     return false;
@@ -234,7 +234,7 @@
                 break;
         }
         case ADM_COLOR_RGB32A:
-                if(!colorSpace->convert(image->data,rgbBuffer))
+                if(!colorSpace->convertImage(image,rgbBuffer))
                 {
                     printf("[ADM_jpegEncoder::encode] Colorconversion failed\n");
                     return false;

Modified: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreVideoFilter/include/DIA_flyDialog.h
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreVideoFilter/include/DIA_flyDialog.h	2010-05-14 15:34:12 UTC (rev 6182)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreVideoFilter/include/DIA_flyDialog.h	2010-05-14 15:34:19 UTC (rev 6183)
@@ -41,7 +41,7 @@
 #include "ADM_rgb.h"
 #include "ADM_colorspace.h"
 #include "ADM_coreVideoFilter.h"
-
+#include "ADM_imageResizer.h"
 #define ADM_FLY_SLIDER_MAX 1000
 
 enum ResizeMethod {

Modified: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreVideoFilter/src/ADM_videoFilterCache.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreVideoFilter/src/ADM_videoFilterCache.cpp	2010-05-14 15:34:12 UTC (rev 6182)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreVideoFilter/src/ADM_videoFilterCache.cpp	2010-05-14 15:34:19 UTC (rev 6183)
@@ -38,7 +38,7 @@
 	sz=(w*h*3)>>1;
 	for(uint32_t i=0;i<nbEntry;i++)
 	{
-		entry[i].image	=new ADMImage(w,h);	
+		entry[i].image	=new ADMImageDefault(w,h);	
 		entry[i].frameNum	=0xffff0000;
 		entry[i].frameLock	=0;
         entry[i].freeEntry=true;

Modified: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreVideoFilter/src/DIA_flyDialog.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreVideoFilter/src/DIA_flyDialog.cpp	2010-05-14 15:34:12 UTC (rev 6182)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreVideoFilter/src/DIA_flyDialog.cpp	2010-05-14 15:34:19 UTC (rev 6183)
@@ -48,11 +48,11 @@
 
 	_rgb=NULL;
 
-	_yuvBuffer=new ADMImage(_w,_h);
+	_yuvBuffer=new ADMImageDefault(_w,_h);
 
 	if(_isYuvProcessing)
 	{
-		_yuvBufferOut=new ADMImage(_w,_h);
+		_yuvBufferOut=new ADMImageDefault(_w,_h);
 		_rgbBuffer=NULL;
 	}
 	else
@@ -270,9 +270,9 @@
 void ADM_flyDialog::copyYuvFinalToRgb(void)
 {
 	if (_resizeMethod == RESIZE_AUTO || _resizeMethod == RESIZE_LAST)
-		_resizer->resize(_yuvBufferOut->data, _rgbBufferOut);
+		_resizer->resize(_yuvBufferOut, _rgbBufferOut);
 	else
-		_rgb->convert(_yuvBufferOut->data, _rgbBufferOut);
+		_rgb->convertImage(_yuvBufferOut, _rgbBufferOut);
 }
 /**
     \fn    copyYuvScratchToRgb
@@ -282,9 +282,9 @@
 void ADM_flyDialog::copyYuvScratchToRgb(void)
 {
 	if (_resizeMethod == RESIZE_AUTO)
-		_resizer->resize(_yuvBuffer->data,_rgbBuffer);
+		_resizer->resize(_yuvBuffer,_rgbBuffer);
 	else
-		_rgb->convert(_yuvBuffer->data,_rgbBuffer);
+		_rgb->convertImage(_yuvBuffer,_rgbBuffer);
 }
 /**
     \fn    copyRgbFinalToDisplay



From mean at mail.berlios.de  Fri May 14 17:34:23 2010
From: mean at mail.berlios.de (mean at BerliOS)
Date: Fri, 14 May 2010 17:34:23 +0200
Subject: [Avidemux-svn-commit] r6184 -
	branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreImage/src
Message-ID: <201005141534.o4EFYN4J026577@sheep.berlios.de>

Author: mean
Date: 2010-05-14 17:34:22 +0200 (Fri, 14 May 2010)
New Revision: 6184

Modified:
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreImage/src/ADM_image.cpp
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreImage/src/ADM_imageResizer.cpp
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreImage/src/ADM_print.cpp
Log:
[core] More ADMImage fixup

Modified: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreImage/src/ADM_image.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreImage/src/ADM_image.cpp	2010-05-14 15:34:19 UTC (rev 6183)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreImage/src/ADM_image.cpp	2010-05-14 15:34:22 UTC (rev 6184)
@@ -158,6 +158,7 @@
                     {
                           return _planeStride[plane];
                         }
+// Cannot write to a ref, the buffer does not belong to us...
 uint8_t        *ADMImageRef::GetWritePtr(ADM_PLANE plane) {return NULL;}
 uint8_t        *ADMImageRef::GetReadPtr(ADM_PLANE plane)
 {

Modified: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreImage/src/ADM_imageResizer.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreImage/src/ADM_imageResizer.cpp	2010-05-14 15:34:19 UTC (rev 6183)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreImage/src/ADM_imageResizer.cpp	2010-05-14 15:34:22 UTC (rev 6184)
@@ -64,15 +64,11 @@
     uint32_t dstStride[3];
     uint8_t  *srcPtr[3];
     uint8_t  *dstPtr[3];
-    for(int i=PLANAR_Y;i<PLANAR_LAST;i++)
-    {
-        srcStride[i]=source->GetPitch((ADM_PLANE)i);
-        dstStride[i]=dest->GetPitch((ADM_PLANE)i);
-        srcPtr[i]=source->GetReadPtr((ADM_PLANE)i);
-        dstPtr[i]=dest->GetWritePtr((ADM_PLANE)i);
-     }
-
-     return resizer->convertPlanes(srcStride,dstStride,srcPtr,dstPtr);
+    source->GetPitches(srcStride);
+    dest->GetPitches(dstStride);
+    source->GetReadPlanes(srcPtr);
+    dest->GetWritePlanes(dstPtr);
+    return resizer->convertPlanes(srcStride,dstStride,srcPtr,dstPtr);
 }
 
 uint8_t ADMImageResizer::resize(ADMImage *source, uint8_t *dest)
@@ -83,11 +79,8 @@
     uint32_t dstStride[3];
     uint8_t  *srcPtr[3];
     uint8_t  *dstPtr[3];
-    for(int i=PLANAR_Y;i<PLANAR_LAST;i++)
-    {
-        srcStride[i]=source->GetPitch((ADM_PLANE)i);
-        srcPtr[i]=source->GetReadPtr((ADM_PLANE)i);
-     }
+    source->GetPitches(srcStride);
+    source->GetReadPlanes(srcPtr);
         dstStride[0]=destWidth;
         dstStride[1]=destWidth>>1;
         dstStride[2]=destWidth>>1;
@@ -108,11 +101,8 @@
     uint32_t dstStride[3];
     uint8_t  *srcPtr[3];
     uint8_t  *dstPtr[3];
-    for(int i=PLANAR_Y;i<PLANAR_LAST;i++)
-    {
-        dstStride[i]=dest->GetPitch((ADM_PLANE)i);
-        dstPtr[i]=dest->GetWritePtr((ADM_PLANE)i);
-     }
+    dest->GetPitches(dstStride);
+    dest->GetWritePlanes(dstPtr);
         srcStride[0]=orgWidth;
         srcStride[1]=orgWidth>>1;
         srcStride[2]=orgWidth>>1;

Modified: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreImage/src/ADM_print.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreImage/src/ADM_print.cpp	2010-05-14 15:34:19 UTC (rev 6183)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreImage/src/ADM_print.cpp	2010-05-14 15:34:22 UTC (rev 6184)
@@ -26,7 +26,7 @@
 	x = x * 10;
 	y = y * 20;
 
-	int pitch = dst->_width;
+	int pitch = dst->GetPitch(PLANAR_Y);
 	for (int tx = 0; tx < 10; tx++) {
 		for (int ty = 0; ty < 20; ty++) {
 			unsigned char *dp = YPLANE(dst);
@@ -62,7 +62,7 @@
 	x = x * 6;
 	y = y * 20;
 
-	int pitch = dst->_width;
+	int pitch = dst->GetPitch(PLANAR_Y);
 	for (int tx = 0; tx < 10; tx++) {
 		for (int ty = 0; ty < 20; ty++) 
 		{



From mean at mail.berlios.de  Fri May 14 17:54:11 2010
From: mean at mail.berlios.de (mean at BerliOS)
Date: Fri, 14 May 2010 17:54:11 +0200
Subject: [Avidemux-svn-commit] r6185 - in branches/avidemux_2.6_branch_mean:
	avidemux_core/ADM_coreImage/include
	avidemux_plugins/ADM_videoEncoder/null
	avidemux_plugins/ADM_videoEncoder/png
	avidemux_plugins/ADM_videoEncoder/x264
	avidemux_plugins/ADM_videoEncoder/yv12
	avidemux_plugins/ADM_videoFilters6/yadif
Message-ID: <201005141554.o4EFsBDZ027614@sheep.berlios.de>

Author: mean
Date: 2010-05-14 17:54:11 +0200 (Fri, 14 May 2010)
New Revision: 6185

Modified:
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreImage/include/ADM_image.h
   branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_videoEncoder/null/nullEncoder.cpp
   branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_videoEncoder/png/ADM_pngEncoder.cpp
   branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_videoEncoder/x264/ADM_x264Setup.cpp
   branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_videoEncoder/yv12/ADM_yv12Encoder.cpp
   branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_videoFilters6/yadif/ADM_vidYadif.cpp
Log:
[Plugins] Update for new ADMImage

Modified: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreImage/include/ADM_image.h
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreImage/include/ADM_image.h	2010-05-14 15:34:22 UTC (rev 6184)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreImage/include/ADM_image.h	2010-05-14 15:54:11 UTC (rev 6185)
@@ -80,6 +80,7 @@
         uint8_t         *quant;
         int             _qStride;
         int             _qSize;
+        int             GetHeight(ADM_PLANE plane) {if(plane==PLANAR_Y) return _height; return _height/2;}
         bool            GetPitches(uint32_t *pitches) {pitches[0]=GetPitch(PLANAR_Y);
                                                        pitches[1]=GetPitch(PLANAR_U);
                                                        pitches[2]=GetPitch(PLANAR_V);}

Modified: branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_videoEncoder/null/nullEncoder.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_videoEncoder/null/nullEncoder.cpp	2010-05-14 15:34:22 UTC (rev 6184)
+++ branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_videoEncoder/null/nullEncoder.cpp	2010-05-14 15:54:11 UTC (rev 6185)
@@ -30,7 +30,7 @@
     FilterInfo *info=src->getInfo();
     w=info->width;
     h=info->height;
-    image=new ADMImage(w,h);
+    image=new ADMImageDefault(w,h);
    
 }
 /** 

Modified: branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_videoEncoder/png/ADM_pngEncoder.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_videoEncoder/png/ADM_pngEncoder.cpp	2010-05-14 15:34:22 UTC (rev 6184)
+++ branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_videoEncoder/png/ADM_pngEncoder.cpp	2010-05-14 15:54:11 UTC (rev 6185)
@@ -28,7 +28,7 @@
     FilterInfo *info=src->getInfo();
     w=info->width;
     h=info->height;
-    image=new ADMImage(w,h);
+    image=new ADMImageDefault(w,h);
     plane=(w*h*3)/2;
 }
 /** 
@@ -52,7 +52,7 @@
         return false;
     }
     ADM_assert(out->bufferSize>plane);
-    memcpy(out->data,image->data,plane);
+    memcpy(out->data,image->GetReadPtr(PLANAR_Y),plane); // We KNOW it is ok
     out->len=plane;
     out->pts=out->dts=image->Pts;
     out->flags=AVI_KEY_FRAME;

Modified: branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_videoEncoder/x264/ADM_x264Setup.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_videoEncoder/x264/ADM_x264Setup.cpp	2010-05-14 15:34:22 UTC (rev 6184)
+++ branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_videoEncoder/x264/ADM_x264Setup.cpp	2010-05-14 15:54:11 UTC (rev 6185)
@@ -50,7 +50,7 @@
   ADM_info("x264, setting up");
   
   firstIdr=true;
-  image=new ADMImage(getWidth(),getHeight());
+  image=new ADMImageDefault(getWidth(),getHeight());
   MMSET(param);
   x264_param_default( &param);
   param.pf_log=logger;

Modified: branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_videoEncoder/yv12/ADM_yv12Encoder.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_videoEncoder/yv12/ADM_yv12Encoder.cpp	2010-05-14 15:34:22 UTC (rev 6184)
+++ branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_videoEncoder/yv12/ADM_yv12Encoder.cpp	2010-05-14 15:54:11 UTC (rev 6185)
@@ -28,7 +28,7 @@
     FilterInfo *info=src->getInfo();
     w=info->width;
     h=info->height;
-    image=new ADMImage(w,h);
+    image=new ADMImageDefault(w,h);
     plane=(w*h*3)/2;
 }
 /** 
@@ -52,7 +52,7 @@
         return false;
     }
     ADM_assert(out->bufferSize>plane);
-    memcpy(out->data,image->data,plane);
+    memcpy(out->data,image->GetReadPtr(PLANAR_Y),plane); // We KNOW the y,u,v planes are contiguous and width=stride!
     out->len=plane;
     out->pts=out->dts=image->Pts;
     out->flags=AVI_KEY_FRAME;

Modified: branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_videoFilters6/yadif/ADM_vidYadif.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_videoFilters6/yadif/ADM_vidYadif.cpp	2010-05-14 15:34:22 UTC (rev 6184)
+++ branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_videoFilters6/yadif/ADM_vidYadif.cpp	2010-05-14 15:54:11 UTC (rev 6185)
@@ -86,7 +86,7 @@
 */
 yadifFilter::yadifFilter(ADM_coreVideoFilter *in, CONFcouple *setup): ADM_coreVideoFilter(in,setup)
 {
-    original=new ADMImage(in->getInfo()->width,in->getInfo()->height);
+    original=new ADMImageDefault(in->getInfo()->width,in->getInfo()->height);
     if(!setup || !ADM_paramLoad(setup,yadif_param,&configuration))
     {
         // Default value



From mean at mail.berlios.de  Fri May 14 17:55:33 2010
From: mean at mail.berlios.de (mean at BerliOS)
Date: Fri, 14 May 2010 17:55:33 +0200
Subject: [Avidemux-svn-commit] r6186 -
	branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_videoEncoder/xvid4
Message-ID: <201005141555.o4EFtXSh027674@sheep.berlios.de>

Author: mean
Date: 2010-05-14 17:55:33 +0200 (Fri, 14 May 2010)
New Revision: 6186

Modified:
   branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_videoEncoder/xvid4/ADM_xvid4.cpp
Log:
[Plugins] Update for new ADMImage (xvid4, not tested)

Modified: branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_videoEncoder/xvid4/ADM_xvid4.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_videoEncoder/xvid4/ADM_xvid4.cpp	2010-05-14 15:54:11 UTC (rev 6185)
+++ branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_videoEncoder/xvid4/ADM_xvid4.cpp	2010-05-14 15:55:33 UTC (rev 6186)
@@ -240,7 +240,7 @@
     }
 
     handle = xvid_enc_create.handle;
-    image=new ADMImage(getWidth(),getHeight());
+    image=new ADMImageDefault(getWidth(),getHeight());
     uint64_t inc=source->getInfo()->frameIncrement;
     if(inc<30000) // Less than 30 ms , fps > 30 fps it is probably field
      {



From mean at mail.berlios.de  Fri May 14 18:11:17 2010
From: mean at mail.berlios.de (mean at BerliOS)
Date: Fri, 14 May 2010 18:11:17 +0200
Subject: [Avidemux-svn-commit] r6187 - in
	branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_videoFilters6:
	crop resize
Message-ID: <201005141611.o4EGBHSG028749@sheep.berlios.de>

Author: mean
Date: 2010-05-14 18:11:16 +0200 (Fri, 14 May 2010)
New Revision: 6187

Modified:
   branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_videoFilters6/crop/ADM_vidCrop.cpp
   branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_videoFilters6/crop/DIA_flyCrop.cpp
   branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_videoFilters6/resize/swScaleResize.cpp
Log:
[Plugins] Fix plugins wrt ADMImage

Modified: branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_videoFilters6/crop/ADM_vidCrop.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_videoFilters6/crop/ADM_vidCrop.cpp	2010-05-14 15:55:33 UTC (rev 6186)
+++ branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_videoFilters6/crop/ADM_vidCrop.cpp	2010-05-14 16:11:16 UTC (rev 6187)
@@ -64,7 +64,7 @@
 CropFilter::CropFilter(ADM_coreVideoFilter *in,CONFcouple *couples) :ADM_coreVideoFilter(in,couples)
 {
 
-        original=new ADMImage(info.width,info.height);
+        original=new ADMImageDefault(info.width,info.height);
         if(!couples || !ADM_paramLoad(couples,crop_param,&configuration))
 		{
             // Default value

Modified: branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_videoFilters6/crop/DIA_flyCrop.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_videoFilters6/crop/DIA_flyCrop.cpp	2010-05-14 15:55:33 UTC (rev 6186)
+++ branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_videoFilters6/crop/DIA_flyCrop.cpp	2010-05-14 16:11:16 UTC (rev 6187)
@@ -105,7 +105,7 @@
 #define THRESH_AVG   30
 #define THRESH_EQT   50
         
-        in=_yuvBuffer->data;
+        in=_yuvBuffer->GetReadPtr(PLANAR_Y);
         for(y=0;y<((_h>>1)-2);y++)	
         {
                 Metrics(in,_w,&avg,&eqt);
@@ -120,7 +120,7 @@
         else 
                 top=0;
                 
-        in=_yuvBuffer->data+_w*(_h-1);
+        in=_yuvBuffer->GetReadPtr(PLANAR_Y)+_w*(_h-1);
         for(y=0;y<((_h>>1)-2);y++)	
         {
                 Metrics(in,_w,&avg,&eqt);
@@ -137,7 +137,7 @@
 
                 
 // Left
-        in=_yuvBuffer->data;
+        in=_yuvBuffer->GetReadPtr(PLANAR_Y);
         for(y=0;y<((_w>>1)-2);y++)	
         {
                 MetricsV(in,_w,_h,&avg,&eqt);
@@ -152,7 +152,7 @@
         else
                 left=0;		
 // Right
-        in=_yuvBuffer->data+_w-1;
+        in=_yuvBuffer->GetReadPtr(PLANAR_Y)+_w-1;
         for(y=0;y<((_w>>1)-2);y++)	
         {
                 MetricsV(in,_w,_h,&avg,&eqt);

Modified: branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_videoFilters6/resize/swScaleResize.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_videoFilters6/resize/swScaleResize.cpp	2010-05-14 15:55:33 UTC (rev 6186)
+++ branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_videoFilters6/resize/swScaleResize.cpp	2010-05-14 16:11:16 UTC (rev 6187)
@@ -86,7 +86,7 @@
 {
 UNUSED_ARG(setup);
 
-    original=new ADMImage(in->getInfo()->width,in->getInfo()->height);
+    original=new ADMImageDefault(in->getInfo()->width,in->getInfo()->height);
     if(!setup || !ADM_paramLoad(setup,swresize_param,&configuration))
     {
         // Default value



From mean at mail.berlios.de  Sat May 15 17:55:36 2010
From: mean at mail.berlios.de (mean at BerliOS)
Date: Sat, 15 May 2010 17:55:36 +0200
Subject: [Avidemux-svn-commit] r6188 -
	branches/avidemux_2.5_branch_gruntster/plugins/ADM_audioEncoders/twolame/ADM_libtwolame
Message-ID: <201005151555.o4FFtaIt019190@sheep.berlios.de>

Author: mean
Date: 2010-05-15 17:55:35 +0200 (Sat, 15 May 2010)
New Revision: 6188

Modified:
   branches/avidemux_2.5_branch_gruntster/plugins/ADM_audioEncoders/twolame/ADM_libtwolame/bitbuffer.c
   branches/avidemux_2.5_branch_gruntster/plugins/ADM_audioEncoders/twolame/ADM_libtwolame/bitbuffer.h
   branches/avidemux_2.5_branch_gruntster/plugins/ADM_audioEncoders/twolame/ADM_libtwolame/psycho_3.c
   branches/avidemux_2.5_branch_gruntster/plugins/ADM_audioEncoders/twolame/ADM_libtwolame/twolame.c
Log:
[twolame] Patch by DaCat

Modified: branches/avidemux_2.5_branch_gruntster/plugins/ADM_audioEncoders/twolame/ADM_libtwolame/bitbuffer.c
===================================================================
--- branches/avidemux_2.5_branch_gruntster/plugins/ADM_audioEncoders/twolame/ADM_libtwolame/bitbuffer.c	2010-05-14 16:11:16 UTC (rev 6187)
+++ branches/avidemux_2.5_branch_gruntster/plugins/ADM_audioEncoders/twolame/ADM_libtwolame/bitbuffer.c	2010-05-15 15:55:35 UTC (rev 6188)
@@ -31,10 +31,8 @@
 
 
 /*create bit buffer*/
-bit_stream* buffer_init( unsigned char *buffer, int buffer_size )
-{
-	bit_stream* bs = (bit_stream *)twolame_malloc(sizeof(bit_stream),"bit_stream");
-	
+void buffer_init( unsigned char *buffer, int buffer_size, bit_stream* bs )
+{	
 	bs->buf = buffer;
 	bs->buf_size = buffer_size;
 	bs->buf_byte_idx = 0;
@@ -42,15 +40,13 @@
 	bs->totbit = 0;
 	bs->eob = FALSE;
 	bs->eobs = FALSE;
-	
-	return bs;
 }
 
 /* Dellocate bit buffer */
-void buffer_deinit( bit_stream ** bs )
-{
-	twolame_free( (void**)bs );
-}
+//void buffer_deinit( bit_stream ** bs )
+//{
+//	twolame_free( (void**)bs );
+//}
 
 
 /*write 1 bit from the bit stream */

Modified: branches/avidemux_2.5_branch_gruntster/plugins/ADM_audioEncoders/twolame/ADM_libtwolame/bitbuffer.h
===================================================================
--- branches/avidemux_2.5_branch_gruntster/plugins/ADM_audioEncoders/twolame/ADM_libtwolame/bitbuffer.h	2010-05-14 16:11:16 UTC (rev 6187)
+++ branches/avidemux_2.5_branch_gruntster/plugins/ADM_audioEncoders/twolame/ADM_libtwolame/bitbuffer.h	2010-05-15 15:55:35 UTC (rev 6188)
@@ -36,8 +36,8 @@
 } bit_stream;
 
 
-bit_stream * buffer_init( unsigned char *buffer, int buffer_size );
-void buffer_deinit( bit_stream ** bs );
+void buffer_init( unsigned char *buffer, int buffer_size, bit_stream* bs );
+//void buffer_deinit( bit_stream ** bs );
 
 void buffer_put1bit (bit_stream *, int);
 inline void buffer_putbits (bit_stream *, unsigned int, int);

Modified: branches/avidemux_2.5_branch_gruntster/plugins/ADM_audioEncoders/twolame/ADM_libtwolame/psycho_3.c
===================================================================
--- branches/avidemux_2.5_branch_gruntster/plugins/ADM_audioEncoders/twolame/ADM_libtwolame/psycho_3.c	2010-05-14 16:11:16 UTC (rev 6187)
+++ branches/avidemux_2.5_branch_gruntster/plugins/ADM_audioEncoders/twolame/ADM_libtwolame/psycho_3.c	2010-05-15 15:55:35 UTC (rev 6188)
@@ -397,6 +397,9 @@
   int cbands=0;
   int *cbandindex;
 
+  memset(numlines,0,HBLKSIZE*sizeof(int));
+  memset(partition,0,HBLKSIZE*sizeof(int));
+
   mem = (psycho_3_mem *)twolame_malloc(sizeof(psycho_3_mem), "psycho_3_mem");
   mem->off[0]=mem->off[1]=256;
   freq_subset = mem->freq_subset;
@@ -544,10 +547,14 @@
 
     psycho_3_fft(sample, energy);
     //MEANX prevent valgrind complains
+    memset(sample,0,HBLKSIZE*sizeof(FLOAT));
+    memset(energy,0,HBLKSIZE*sizeof(FLOAT));
     memset(power,0,HBLKSIZE*sizeof(FLOAT));
+    memset(tonelabel,0,HBLKSIZE*sizeof(int));
     memset(noiselabel,0,HBLKSIZE*sizeof(int));
     memset(Xtm,0,HBLKSIZE*sizeof(FLOAT));
     memset(Xnm,0,HBLKSIZE*sizeof(FLOAT));
+    memset(Lsb,0,(SBLIMIT+1)*sizeof(FLOAT));
     // /MEANX
     psycho_3_powerdensityspectrum(energy, power);    
     psycho_3_spl(Lsb, power, &scale[k][0]);

Modified: branches/avidemux_2.5_branch_gruntster/plugins/ADM_audioEncoders/twolame/ADM_libtwolame/twolame.c
===================================================================
--- branches/avidemux_2.5_branch_gruntster/plugins/ADM_audioEncoders/twolame/ADM_libtwolame/twolame.c	2010-05-14 16:11:16 UTC (rev 6187)
+++ branches/avidemux_2.5_branch_gruntster/plugins/ADM_audioEncoders/twolame/ADM_libtwolame/twolame.c	2010-05-15 15:55:35 UTC (rev 6188)
@@ -702,15 +702,14 @@
 		int mp2buffer_size )
 {
 	int mp2_size=0;
-	bit_stream *mybs;
+    bit_stream mybs;
 	int i;
 
 	if (num_samples==0) return 0;
 
-
 	// now would be a great time to validate the size of the buffer.
 	// samples/1152 * sizeof(frame) < mp2buffer_size 
-	mybs = buffer_init( mp2buffer, mp2buffer_size );
+    buffer_init( mp2buffer, mp2buffer_size, &mybs );
 
 
 	// Use up all the samples in in_buffer
@@ -735,9 +734,8 @@
 		
 		// is there enough to encode a whole frame ?
 		if (glopts->samples_in_buffer >= 1152) {
-			int bytes = encode_frame( glopts, mybs );
+			int bytes = encode_frame( glopts, &mybs );
 			if (bytes<=0) {
-				buffer_deinit( &mybs );
 				return bytes;
 			}
 			mp2_size += bytes;
@@ -745,9 +743,6 @@
 		}
 	}
 
-	// free up the bit stream buffer structure
-	buffer_deinit( &mybs );
-
 	return(mp2_size);
 }
 
@@ -760,7 +755,7 @@
 		int mp2buffer_size )
 {
 	int mp2_size=0;
-	bit_stream *mybs;
+    bit_stream mybs;
 	int i;
 
 	if (num_samples==0) return 0;
@@ -768,7 +763,7 @@
 
 	// now would be a great time to validate the size of the buffer.
 	// samples/1152 * sizeof(frame) < mp2buffer_size 
-	mybs = buffer_init( mp2buffer, mp2buffer_size );
+    buffer_init( mp2buffer, mp2buffer_size, &mybs );
 
 	// Use up all the samples in in_buffer
 	while( num_samples ) {
@@ -792,26 +787,21 @@
 		
 		// is there enough to encode a whole frame ?
 		if (glopts->samples_in_buffer >= 1152) {
-			int bytes = encode_frame( glopts, mybs );
+			int bytes = encode_frame( glopts, &mybs );
 			if (bytes<=0) {
-				buffer_deinit( &mybs );
 				return bytes;
 			}
 			mp2_size += bytes;
 			glopts->samples_in_buffer -= 1152;
 		}
-	}
-
-	// free up the bit stream buffer structure
-	buffer_deinit( &mybs );
+	}	
 	
-	
 	return(mp2_size);
 }
 
 
 int twolame_encode_flush(twolame_options *glopts, unsigned char *mp2buffer, int mp2buffer_size) {
-	bit_stream *mybs = NULL;
+    bit_stream mybs;
 	int mp2_size = 0;
 	int i;
 
@@ -822,7 +812,7 @@
 
 
 	// Create bit stream structure
-	mybs = buffer_init( mp2buffer, mp2buffer_size );
+    buffer_init( mp2buffer, mp2buffer_size, &mybs );
 
 	// Pad out the PCM buffers with 0 and encode the frame
 	for (i=glopts->samples_in_buffer; i< 1152; i++) {
@@ -830,12 +820,9 @@
 	}
 
 	// Encode the frame 
-	mp2_size = encode_frame( glopts, mybs );
+	mp2_size = encode_frame( glopts, &mybs );
 	glopts->samples_in_buffer=0;
 
-	// free up the bit stream buffer structure
-	buffer_deinit( &mybs );
-
 	return mp2_size;
 }
 



From gruntster at mail.berlios.de  Sun May 16 16:15:51 2010
From: gruntster at mail.berlios.de (gruntster at mail.berlios.de)
Date: Sun, 16 May 2010 16:15:51 +0200
Subject: [Avidemux-svn-commit] r6189 -
	branches/avidemux_2.5_branch_gruntster/cmake
Message-ID: <201005161415.o4GEFp5p013825@sheep.berlios.de>

Author: gruntster
Date: 2010-05-16 16:15:46 +0200 (Sun, 16 May 2010)
New Revision: 6189

Modified:
   branches/avidemux_2.5_branch_gruntster/cmake/admFFmpegBuild.cmake
Log:
[ffmpeg] new CMake flag (FF_FLAGS) to pass flags to FFmpeg configure

Modified: branches/avidemux_2.5_branch_gruntster/cmake/admFFmpegBuild.cmake
===================================================================
--- branches/avidemux_2.5_branch_gruntster/cmake/admFFmpegBuild.cmake	2010-05-15 15:55:35 UTC (rev 6188)
+++ branches/avidemux_2.5_branch_gruntster/cmake/admFFmpegBuild.cmake	2010-05-16 14:15:46 UTC (rev 6189)
@@ -102,6 +102,11 @@
 	set(FFMPEG_FLAGS ${FFMPEG_FLAGS} --target-os=${CROSS_OS})
 endif (CROSS_OS)
 
+if (FF_FLAGS)
+	set(FF_FLAGS "${FF_FLAGS}" CACHE STRING "")
+	set(FFMPEG_FLAGS ${FFMPEG_FLAGS} ${FF_FLAGS})
+endif (FF_FLAGS)
+
 if (NOT "${LAST_FFMPEG_FLAGS}" STREQUAL "${FFMPEG_FLAGS}")
 	set(FFMPEG_PERFORM_BUILD 1)
 endif (NOT "${LAST_FFMPEG_FLAGS}" STREQUAL "${FFMPEG_FLAGS}")



From mean at mail.berlios.de  Sun May 16 19:16:18 2010
From: mean at mail.berlios.de (mean at BerliOS)
Date: Sun, 16 May 2010 19:16:18 +0200
Subject: [Avidemux-svn-commit] r6190 -
	branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreImage/src
Message-ID: <201005161716.o4GHGIHO003070@sheep.berlios.de>

Author: mean
Date: 2010-05-16 19:16:15 +0200 (Sun, 16 May 2010)
New Revision: 6190

Modified:
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreImage/src/ADM_imageSave.cpp
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreImage/src/ADM_imageUtils.cpp
Log:
[coreImage] More cleanup

Modified: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreImage/src/ADM_imageSave.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreImage/src/ADM_imageSave.cpp	2010-05-16 14:15:46 UTC (rev 6189)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreImage/src/ADM_imageSave.cpp	2010-05-16 17:16:15 UTC (rev 6190)
@@ -87,7 +87,6 @@
         uint32_t ww=bmph.biWidth;
         uint32_t hh=bmph.biHeight;
         uint8_t swap[ww*3];
-        
         uint8_t *up=out;
         uint8_t *down=out+(hh-1)*ww*3;
         
@@ -180,9 +179,9 @@
     // Setup our image & stuff....
         
 
-        frame.linesize[0] = _width; 
-        frame.linesize[1] = _width>>1; 
-        frame.linesize[2] = _width>>1; 
+        frame.linesize[0] = GetPitch(PLANAR_Y); 
+        frame.linesize[1] = GetPitch(PLANAR_U); 
+        frame.linesize[2] = GetPitch(PLANAR_V); 
         
         frame.data[0] = GetWritePtr(PLANAR_Y);
         frame.data[2] = GetWritePtr(PLANAR_U);

Modified: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreImage/src/ADM_imageUtils.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreImage/src/ADM_imageUtils.cpp	2010-05-16 14:15:46 UTC (rev 6189)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreImage/src/ADM_imageUtils.cpp	2010-05-16 17:16:15 UTC (rev 6190)
@@ -352,39 +352,46 @@
  bool ADMImage::copyLeftSideTo(ADMImage *dest)
  {
 		uint8_t *src,*dst;
-		uint32_t stride;
+		uint32_t srcStride,dstStride;
+        uint32_t len=this->_width;
  
 			ADM_assert(_width==dest->_width);
 			ADM_assert(_height==dest->_height);
 		
-	 		dst=YPLANE(dest);
-		    src=YPLANE(this);
-		    stride=_width;
+	 		dst=dest->GetWritePtr(PLANAR_Y);
+		    src=this->GetWritePtr(PLANAR_Y);
+		    srcStride=this->GetPitch(PLANAR_Y);
+            dstStride=dest->GetPitch(PLANAR_Y);
 		    for(uint32_t y=0;y<_height;y++)   // We do both u & v!
 		    {
-		        memcpy(dst,src,stride>>1);
-		        dst+=stride;
-		        src+=stride;
+		        memcpy(dst,src,len>>1);
+		        dst+=dstStride;
+		        src+=srcStride;
 		    }
+            len>>=1;
 		        // U
-		    dst=UPLANE(dest);
-		    src=UPLANE(this);
-		    stride=_width>>1;
+	 		dst=dest->GetWritePtr(PLANAR_U);
+		    src=this->GetWritePtr(PLANAR_U);
+		    srcStride=this->GetPitch(PLANAR_U);
+            dstStride=dest->GetPitch(PLANAR_U);
+		    
 		    uint32_t h2=_height>>1;
 		    for(uint32_t y=0;y<h2;y++)   // We do both u & v!
 		    {
-		        memcpy(dst,src,stride>>1);
-		        dst+=stride;
-		        src+=stride;
+		        memcpy(dst,src,len>>1);
+		        dst+=dstStride;
+		        src+=srcStride;
 		    }
 		        // V
-		    dst=VPLANE(dest);
-		    src=VPLANE(this);
+            dst=dest->GetWritePtr(PLANAR_V);
+		    src=this->GetWritePtr(PLANAR_V);
+		    srcStride=this->GetPitch(PLANAR_V);
+            dstStride=dest->GetPitch(PLANAR_V);
 		    for(uint32_t y=0;y<h2;y++)   // We do both u & v!
 		    {
-		        memcpy(dst,src,stride>>1);
-		        dst+=stride;
-		        src+=stride;
+		        memcpy(dst,src,len>>1);
+		        dst+=dstStride;
+		        src+=srcStride;
 		    }
 		    return 1;
  }



From mean at mail.berlios.de  Sun May 16 19:16:21 2010
From: mean at mail.berlios.de (mean at BerliOS)
Date: Sun, 16 May 2010 19:16:21 +0200
Subject: [Avidemux-svn-commit] r6191 - in
	branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_videoFilters6:
	. vdpauFilters
Message-ID: <201005161716.o4GHGLCA003523@sheep.berlios.de>

Author: mean
Date: 2010-05-16 19:16:21 +0200 (Sun, 16 May 2010)
New Revision: 6191

Added:
   branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_videoFilters6/vdpauFilters/
   branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_videoFilters6/vdpauFilters/ADM_vidVdpauFilter.cpp
   branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_videoFilters6/vdpauFilters/CMakeLists.txt
   branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_videoFilters6/vdpauFilters/vdpauFilter.conf
   branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_videoFilters6/vdpauFilters/vdpauFilter.h
   branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_videoFilters6/vdpauFilters/vdpauFilter_desc.cpp
Modified:
   branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_videoFilters6/CMakeLists.txt
Log:
[vdpau] Add dummy vdpau filter

Modified: branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_videoFilters6/CMakeLists.txt
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_videoFilters6/CMakeLists.txt	2010-05-16 17:16:15 UTC (rev 6190)
+++ branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_videoFilters6/CMakeLists.txt	2010-05-16 17:16:21 UTC (rev 6191)
@@ -5,3 +5,4 @@
 ADD_SUBDIRECTORY(yadif)
 ADD_SUBDIRECTORY(mplayerDenoise3D)
 ADD_SUBDIRECTORY(printInfo)
+ADD_SUBDIRECTORY(vdpauFilters)

Added: branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_videoFilters6/vdpauFilters/ADM_vidVdpauFilter.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_videoFilters6/vdpauFilters/ADM_vidVdpauFilter.cpp	2010-05-16 17:16:15 UTC (rev 6190)
+++ branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_videoFilters6/vdpauFilters/ADM_vidVdpauFilter.cpp	2010-05-16 17:16:21 UTC (rev 6191)
@@ -0,0 +1,134 @@
+/**
+    \brief VDPAU filters
+    \author mean (C) 2010
+    This is slow as we copy back and forth data to/from the video cards
+    Inspired a lot from mplayer vo_vdpau
+
+*/
+
+#include "ADM_default.h"
+#include "ADM_coreVideoFilterInternal.h"
+#include "ADM_videoFilterCache.h"
+#include "DIA_factory.h"
+#include "vdpauFilter.h"
+#include "vdpauFilter_desc.cpp"
+//
+/**
+    \class vdpauVideoFilter
+*/
+class vdpauVideoFilter : public  ADM_coreVideoFilter
+{
+protected:
+                    ADMImage    *original;
+                    vdpauFilter configuration;
+public:
+                    vdpauVideoFilter(ADM_coreVideoFilter *previous,CONFcouple *conf);
+                    ~vdpauVideoFilter();
+
+        virtual const char   *getConfiguration(void);                 /// Return  current configuration as a human readable string
+        virtual bool         getNextFrame(uint32_t *fn,ADMImage *image);           /// Return the next image
+        virtual bool         getCoupledConf(CONFcouple **couples) ;   /// Return the current filter configuration
+        virtual bool         configure(void) ;                        /// Start graphical user interface
+};
+
+// Add the hook to make it valid plugin
+DECLARE_VIDEO_FILTER(   vdpauVideoFilter,   // Class
+                        1,0,0,              // Version
+                        ADM_UI_ALL,         // UI
+                        VF_INTERLACING,            // Category
+                        "vdpau",            // internal name (must be uniq!)
+                        "vdpau",            // Display name
+                        "vdpau, vdpau filters, SLOW." // Description
+                    );
+
+//
+static void filter_plane(int mode, uint8_t *dst, int dst_stride, const uint8_t *prev0, const uint8_t *cur0, const uint8_t *next0, int refs, int w, int h, int parity, int tff, int mmx);
+
+
+/**
+    \fn constructor
+*/
+vdpauVideoFilter::vdpauVideoFilter(ADM_coreVideoFilter *in, CONFcouple *setup): ADM_coreVideoFilter(in,setup)
+{
+    original=new ADMImageDefault(in->getInfo()->width,in->getInfo()->height);
+    if(!setup || !ADM_paramLoad(setup,vdpauFilter_param,&configuration))
+    {
+        // Default value
+        configuration.mode=0;
+        configuration.order=1;
+    }
+    vidCache = new VideoCache (10, in);
+    myName="vdpau";
+}
+/**
+    \fn destructor
+*/
+vdpauVideoFilter::~vdpauVideoFilter()
+{
+        delete  original;
+        original=NULL;
+       
+        delete vidCache;
+        vidCache = NULL;
+}
+/**
+    \fn updateInfo
+*/
+bool vdpauVideoFilter::configure( void) 
+{
+    
+     diaMenuEntry tMode[]={
+                             {0,      QT_TR_NOOP("Temporal & spatial check"),NULL},
+                             {1,   QT_TR_NOOP("Bob, temporal & spatial check"),NULL},
+                             {2,      QT_TR_NOOP("Skip spatial temporal check"),NULL},
+                             {3,  QT_TR_NOOP("Bob, skip spatial temporal check"),NULL}
+          };
+     diaMenuEntry tOrder[]={
+                             {0,      QT_TR_NOOP("Bottom field first"),NULL},
+                             {1,   QT_TR_NOOP("Top field first"),NULL}
+          };
+  
+     diaElemMenu mMode(&(configuration.mode),   QT_TR_NOOP("_Mode:"), 4,tMode);
+     diaElemMenu morder(&(configuration.order),   QT_TR_NOOP("_Order:"), 2,tOrder);
+     
+     diaElem *elems[]={&mMode,&morder};
+     
+     if(diaFactoryRun(QT_TR_NOOP("vdpau"),sizeof(elems)/sizeof(diaElem *),elems))
+     {
+        return 1;
+     }
+     return 0;
+}
+/**
+    \fn getCoupledConf
+    \brief Return our current configuration as couple name=value
+*/
+bool         vdpauVideoFilter::getCoupledConf(CONFcouple **couples)
+{
+    return ADM_paramSave(couples, vdpauFilter_param,&configuration);
+}
+/**
+    \fn getConfiguration
+    \brief Return current setting as a string
+*/
+const char *vdpauVideoFilter::getConfiguration(void)
+{
+    static char conf[80];
+    conf[0]=0;
+    snprintf(conf,80,"vdpau : mode=%d, order=%d\n",
+                (int)configuration.mode, (int)configuration.order);
+    return conf;
+}
+
+/**
+    \fn getConfiguration
+    \brief Return current setting as a string
+*/
+bool vdpauVideoFilter::getNextFrame(uint32_t *fn,ADMImage *image)
+{
+
+        
+      return false;
+}
+//****************
+// EOF

Added: branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_videoFilters6/vdpauFilters/CMakeLists.txt
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_videoFilters6/vdpauFilters/CMakeLists.txt	2010-05-16 17:16:15 UTC (rev 6190)
+++ branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_videoFilters6/vdpauFilters/CMakeLists.txt	2010-05-16 17:16:21 UTC (rev 6191)
@@ -0,0 +1,9 @@
+INCLUDE(vf_plugin)
+IF(NOT WIN32 AND NOT APPLE)
+        SET(ADM_vf_vdpauFilter_SRCS ADM_vidVdpauFilter.cpp )
+
+        ADD_VIDEO_FILTER(ADM_vf_vdpauFilter ${ADM_vf_vdpauFilter_SRCS})
+
+        INIT_VIDEO_FILTER(ADM_vf_vdpauFilter)
+        INSTALL_VIDEO_FILTER(ADM_vf_vdpauFilter)
+ENDIF(NOT WIN32 AND NOT APPLE)

Added: branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_videoFilters6/vdpauFilters/vdpauFilter.conf
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_videoFilters6/vdpauFilters/vdpauFilter.conf	2010-05-16 17:16:15 UTC (rev 6190)
+++ branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_videoFilters6/vdpauFilters/vdpauFilter.conf	2010-05-16 17:16:21 UTC (rev 6191)
@@ -0,0 +1,2 @@
+uint32_t:mode
+uint32_t:order

Added: branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_videoFilters6/vdpauFilters/vdpauFilter.h
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_videoFilters6/vdpauFilters/vdpauFilter.h	2010-05-16 17:16:15 UTC (rev 6190)
+++ branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_videoFilters6/vdpauFilters/vdpauFilter.h	2010-05-16 17:16:21 UTC (rev 6191)
@@ -0,0 +1,9 @@
+// Automatically generated, do not edit!
+#ifndef ADM_vdpauFilter_CONF_H
+#define ADM_vdpauFilter_CONF_H
+typedef struct {
+   uint32_t mode;
+   uint32_t order;
+}vdpauFilter;
+#endif //vdpauFilter
+//EOF

Added: branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_videoFilters6/vdpauFilters/vdpauFilter_desc.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_videoFilters6/vdpauFilters/vdpauFilter_desc.cpp	2010-05-16 17:16:15 UTC (rev 6190)
+++ branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_videoFilters6/vdpauFilters/vdpauFilter_desc.cpp	2010-05-16 17:16:21 UTC (rev 6191)
@@ -0,0 +1,6 @@
+// Automatically generated, do not edit!
+const ADM_paramList vdpauFilter_param[]={
+ {"mode",offsetof( vdpauFilter,mode),"uint32_t",ADM_param_uint32_t},
+ {"order",offsetof( vdpauFilter,order),"uint32_t",ADM_param_uint32_t},
+{NULL,0,NULL}
+};



From mean at mail.berlios.de  Sun May 16 19:16:24 2010
From: mean at mail.berlios.de (mean at BerliOS)
Date: Sun, 16 May 2010 19:16:24 +0200
Subject: [Avidemux-svn-commit] r6192 -
	branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_audioEncoders/twolame/ADM_libtwolame
Message-ID: <201005161716.o4GHGOdM003708@sheep.berlios.de>

Author: mean
Date: 2010-05-16 19:16:23 +0200 (Sun, 16 May 2010)
New Revision: 6192

Modified:
   branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_audioEncoders/twolame/ADM_libtwolame/bitbuffer.c
   branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_audioEncoders/twolame/ADM_libtwolame/bitbuffer.h
   branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_audioEncoders/twolame/ADM_libtwolame/psycho_3.c
   branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_audioEncoders/twolame/ADM_libtwolame/twolame.c
Log:
[twolame] Merge DaCat patch

Modified: branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_audioEncoders/twolame/ADM_libtwolame/bitbuffer.c
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_audioEncoders/twolame/ADM_libtwolame/bitbuffer.c	2010-05-16 17:16:21 UTC (rev 6191)
+++ branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_audioEncoders/twolame/ADM_libtwolame/bitbuffer.c	2010-05-16 17:16:23 UTC (rev 6192)
@@ -31,10 +31,8 @@
 
 
 /*create bit buffer*/
-bit_stream* buffer_init( unsigned char *buffer, int buffer_size )
-{
-	bit_stream* bs = (bit_stream *)twolame_malloc(sizeof(bit_stream),"bit_stream");
-	
+void buffer_init( unsigned char *buffer, int buffer_size, bit_stream* bs )
+{	
 	bs->buf = buffer;
 	bs->buf_size = buffer_size;
 	bs->buf_byte_idx = 0;
@@ -42,15 +40,13 @@
 	bs->totbit = 0;
 	bs->eob = FALSE;
 	bs->eobs = FALSE;
-	
-	return bs;
 }
 
 /* Dellocate bit buffer */
-void buffer_deinit( bit_stream ** bs )
-{
-	twolame_free( (void**)bs );
-}
+//void buffer_deinit( bit_stream ** bs )
+//{
+//	twolame_free( (void**)bs );
+//}
 
 
 /*write 1 bit from the bit stream */

Modified: branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_audioEncoders/twolame/ADM_libtwolame/bitbuffer.h
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_audioEncoders/twolame/ADM_libtwolame/bitbuffer.h	2010-05-16 17:16:21 UTC (rev 6191)
+++ branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_audioEncoders/twolame/ADM_libtwolame/bitbuffer.h	2010-05-16 17:16:23 UTC (rev 6192)
@@ -36,8 +36,8 @@
 } bit_stream;
 
 
-bit_stream * buffer_init( unsigned char *buffer, int buffer_size );
-void buffer_deinit( bit_stream ** bs );
+void buffer_init( unsigned char *buffer, int buffer_size, bit_stream* bs );
+//void buffer_deinit( bit_stream ** bs );
 
 void buffer_put1bit (bit_stream *, int);
 inline void buffer_putbits (bit_stream *, unsigned int, int);

Modified: branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_audioEncoders/twolame/ADM_libtwolame/psycho_3.c
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_audioEncoders/twolame/ADM_libtwolame/psycho_3.c	2010-05-16 17:16:21 UTC (rev 6191)
+++ branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_audioEncoders/twolame/ADM_libtwolame/psycho_3.c	2010-05-16 17:16:23 UTC (rev 6192)
@@ -397,6 +397,9 @@
   int cbands=0;
   int *cbandindex;
 
+  memset(numlines,0,HBLKSIZE*sizeof(int));
+  memset(partition,0,HBLKSIZE*sizeof(int));
+
   mem = (psycho_3_mem *)twolame_malloc(sizeof(psycho_3_mem), "psycho_3_mem");
   mem->off[0]=mem->off[1]=256;
   freq_subset = mem->freq_subset;
@@ -544,10 +547,14 @@
 
     psycho_3_fft(sample, energy);
     //MEANX prevent valgrind complains
+    memset(sample,0,HBLKSIZE*sizeof(FLOAT));
+    memset(energy,0,HBLKSIZE*sizeof(FLOAT));
     memset(power,0,HBLKSIZE*sizeof(FLOAT));
+    memset(tonelabel,0,HBLKSIZE*sizeof(int));
     memset(noiselabel,0,HBLKSIZE*sizeof(int));
     memset(Xtm,0,HBLKSIZE*sizeof(FLOAT));
     memset(Xnm,0,HBLKSIZE*sizeof(FLOAT));
+    memset(Lsb,0,(SBLIMIT+1)*sizeof(FLOAT));
     // /MEANX
     psycho_3_powerdensityspectrum(energy, power);    
     psycho_3_spl(Lsb, power, &scale[k][0]);

Modified: branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_audioEncoders/twolame/ADM_libtwolame/twolame.c
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_audioEncoders/twolame/ADM_libtwolame/twolame.c	2010-05-16 17:16:21 UTC (rev 6191)
+++ branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_audioEncoders/twolame/ADM_libtwolame/twolame.c	2010-05-16 17:16:23 UTC (rev 6192)
@@ -702,15 +702,14 @@
 		int mp2buffer_size )
 {
 	int mp2_size=0;
-	bit_stream *mybs;
+    bit_stream mybs;
 	int i;
 
 	if (num_samples==0) return 0;
 
-
 	// now would be a great time to validate the size of the buffer.
 	// samples/1152 * sizeof(frame) < mp2buffer_size 
-	mybs = buffer_init( mp2buffer, mp2buffer_size );
+    buffer_init( mp2buffer, mp2buffer_size, &mybs );
 
 
 	// Use up all the samples in in_buffer
@@ -735,9 +734,8 @@
 		
 		// is there enough to encode a whole frame ?
 		if (glopts->samples_in_buffer >= 1152) {
-			int bytes = encode_frame( glopts, mybs );
+			int bytes = encode_frame( glopts, &mybs );
 			if (bytes<=0) {
-				buffer_deinit( &mybs );
 				return bytes;
 			}
 			mp2_size += bytes;
@@ -745,9 +743,6 @@
 		}
 	}
 
-	// free up the bit stream buffer structure
-	buffer_deinit( &mybs );
-
 	return(mp2_size);
 }
 
@@ -760,7 +755,7 @@
 		int mp2buffer_size )
 {
 	int mp2_size=0;
-	bit_stream *mybs;
+    bit_stream mybs;
 	int i;
 
 	if (num_samples==0) return 0;
@@ -768,7 +763,7 @@
 
 	// now would be a great time to validate the size of the buffer.
 	// samples/1152 * sizeof(frame) < mp2buffer_size 
-	mybs = buffer_init( mp2buffer, mp2buffer_size );
+    buffer_init( mp2buffer, mp2buffer_size, &mybs );
 
 	// Use up all the samples in in_buffer
 	while( num_samples ) {
@@ -792,26 +787,21 @@
 		
 		// is there enough to encode a whole frame ?
 		if (glopts->samples_in_buffer >= 1152) {
-			int bytes = encode_frame( glopts, mybs );
+			int bytes = encode_frame( glopts, &mybs );
 			if (bytes<=0) {
-				buffer_deinit( &mybs );
 				return bytes;
 			}
 			mp2_size += bytes;
 			glopts->samples_in_buffer -= 1152;
 		}
-	}
-
-	// free up the bit stream buffer structure
-	buffer_deinit( &mybs );
+	}	
 	
-	
 	return(mp2_size);
 }
 
 
 int twolame_encode_flush(twolame_options *glopts, unsigned char *mp2buffer, int mp2buffer_size) {
-	bit_stream *mybs = NULL;
+    bit_stream mybs;
 	int mp2_size = 0;
 	int i;
 
@@ -822,7 +812,7 @@
 
 
 	// Create bit stream structure
-	mybs = buffer_init( mp2buffer, mp2buffer_size );
+    buffer_init( mp2buffer, mp2buffer_size, &mybs );
 
 	// Pad out the PCM buffers with 0 and encode the frame
 	for (i=glopts->samples_in_buffer; i< 1152; i++) {
@@ -830,12 +820,9 @@
 	}
 
 	// Encode the frame 
-	mp2_size = encode_frame( glopts, mybs );
+	mp2_size = encode_frame( glopts, &mybs );
 	glopts->samples_in_buffer=0;
 
-	// free up the bit stream buffer structure
-	buffer_deinit( &mybs );
-
 	return mp2_size;
 }
 



From mean at mail.berlios.de  Sun May 16 19:16:26 2010
From: mean at mail.berlios.de (mean at BerliOS)
Date: Sun, 16 May 2010 19:16:26 +0200
Subject: [Avidemux-svn-commit] r6193 - in
	branches/avidemux_2.6_branch_mean/avidemux_core:
	ADM_coreImage/src ADM_coreVideoFilter/src
Message-ID: <201005161716.o4GHGQjK003864@sheep.berlios.de>

Author: mean
Date: 2010-05-16 19:16:26 +0200 (Sun, 16 May 2010)
New Revision: 6193

Modified:
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreImage/src/ADM_colorspace.cpp
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreVideoFilter/src/DIA_flyDialog.cpp
Log:
[ADM_Image] more update

Modified: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreImage/src/ADM_colorspace.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreImage/src/ADM_colorspace.cpp	2010-05-16 17:16:23 UTC (rev 6192)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreImage/src/ADM_colorspace.cpp	2010-05-16 17:16:26 UTC (rev 6193)
@@ -42,6 +42,24 @@
 #define CONTEXT (SwsContext *)context
 
 /**
+    \fn swapRGB
+*/
+static void swapRGB(uint32_t w,uint32_t h, uint8_t *to)
+{
+  uint32_t l=w*h;
+    uint8_t *d=(uint8_t *)to;
+    int r,b,g,a;
+    while(l--)
+    {
+        uint8_t s=d[0];
+        d[0]=d[2];
+        d[2]=s;
+        d+=4;
+        
+    }
+}
+
+/**
     \fn ADMColor2LAVColor
     \brief Convert ADM colorspace type swscale/lavcodec colorspace name
 
@@ -138,18 +156,7 @@
   sws_scale(CONTEXT,srcData,srcStride,0,srcHeight,dstData,dstStride);
   if(toColor==ADM_COLOR_BGR32A)
   {
-    // RGB32->BG32
-    uint32_t l=dstWidth*dstHeight;
-    uint8_t *d=(uint8_t *)to;
-    int r,b,g,a;
-    while(l--)
-    {
-        uint8_t s=d[0];
-        d[0]=d[2];
-        d[2]=s;
-        d+=4;
-        
-    }
+     swapRGB(dstWidth,dstHeight,to);
   }
   return true;
   
@@ -281,17 +288,18 @@
     uint8_t *dstPlanes[3];
     uint32_t srcPitch[3];
     uint32_t dstPitch[3];
+    int      idstPitch[3];
     img->GetPitches(srcPitch);
     img->GetReadPlanes(srcPlanes);
-    int w=img->_width;
-    int h=img->_height;
-    int plane=w*h;
-    dstPitch[0]=w;
-    dstPitch[1]=w/2;
-    dstPitch[2]=w/2;
-    dstPlanes[0]=to;
-    dstPlanes[1]=to+plane;
-    dstPlanes[2]=to+(plane*5)/4;;
-    return  convertPlanes(srcPitch,dstPitch,srcPlanes,dstPlanes);
+    getStrideAndPointers(true,to,toColor, dstPlanes,idstPitch);
+    dstPitch[0]=idstPitch[0];
+    dstPitch[1]=idstPitch[1];
+    dstPitch[2]=idstPitch[2];
+    if(false==convertPlanes(srcPitch,dstPitch,srcPlanes,dstPlanes)) return false;
+    if(toColor==ADM_COLOR_BGR32A)
+    {
+             swapRGB(dstWidth,dstHeight,to);
+    }
+    return true;
 }
 //EOF

Modified: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreVideoFilter/src/DIA_flyDialog.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreVideoFilter/src/DIA_flyDialog.cpp	2010-05-16 17:16:23 UTC (rev 6192)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreVideoFilter/src/DIA_flyDialog.cpp	2010-05-16 17:16:26 UTC (rev 6193)
@@ -42,9 +42,9 @@
 	_canvas = canvas;
 	_cookie = NULL;
 	_resizeMethod = resizeMethod;
-        _zoomChangeCount = 0;
-        _resizer=NULL;
-        _rgbBufferDisplay=NULL;
+    _zoomChangeCount = 0;
+    _resizer=NULL;
+    _rgbBufferDisplay=NULL;
 
 	_rgb=NULL;
 



From mean at mail.berlios.de  Sun May 16 19:16:28 2010
From: mean at mail.berlios.de (mean at BerliOS)
Date: Sun, 16 May 2010 19:16:28 +0200
Subject: [Avidemux-svn-commit] r6194 -
	branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_videoFilters6/vdpauFilters
Message-ID: <201005161716.o4GHGSBs004187@sheep.berlios.de>

Author: mean
Date: 2010-05-16 19:16:28 +0200 (Sun, 16 May 2010)
New Revision: 6194

Modified:
   branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_videoFilters6/vdpauFilters/ADM_vidVdpauFilter.cpp
Log:
[VDPAU] Dummy filter

Modified: branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_videoFilters6/vdpauFilters/ADM_vidVdpauFilter.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_videoFilters6/vdpauFilters/ADM_vidVdpauFilter.cpp	2010-05-16 17:16:26 UTC (rev 6193)
+++ branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_videoFilters6/vdpauFilters/ADM_vidVdpauFilter.cpp	2010-05-16 17:16:28 UTC (rev 6194)
@@ -34,7 +34,7 @@
 // Add the hook to make it valid plugin
 DECLARE_VIDEO_FILTER(   vdpauVideoFilter,   // Class
                         1,0,0,              // Version
-                        ADM_UI_ALL,         // UI
+                        ADM_UI_GTK+ADM_UI_QT4,         // We need a display for VDPAU; so no cli...
                         VF_INTERLACING,            // Category
                         "vdpau",            // internal name (must be uniq!)
                         "vdpau",            // Display name



From mean at mail.berlios.de  Sun May 16 19:16:31 2010
From: mean at mail.berlios.de (mean at BerliOS)
Date: Sun, 16 May 2010 19:16:31 +0200
Subject: [Avidemux-svn-commit] r6195 -
	branches/avidemux_2.6_branch_mean/avidemux/common/ADM_render
Message-ID: <201005161716.o4GHGVuD004461@sheep.berlios.de>

Author: mean
Date: 2010-05-16 19:16:31 +0200 (Sun, 16 May 2010)
New Revision: 6195

Modified:
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_render/GUI_render.cpp
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_render/GUI_sdlRender.cpp
Log:
[SDL] Update wrt to new render/new ADImage,  re-enable on linux

Modified: branches/avidemux_2.6_branch_mean/avidemux/common/ADM_render/GUI_render.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/ADM_render/GUI_render.cpp	2010-05-16 17:16:28 UTC (rev 6194)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/ADM_render/GUI_render.cpp	2010-05-16 17:16:31 UTC (rev 6195)
@@ -256,7 +256,7 @@
                 break;
 #endif
 
-#if (defined(WIN32) || defined(APPLE) )&&  defined(USE_SDL)
+#if  defined(USE_SDL)
 			case RENDER_SDL:
 #ifdef __WIN32
 			case RENDER_DIRECTX:

Modified: branches/avidemux_2.6_branch_mean/avidemux/common/ADM_render/GUI_sdlRender.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/ADM_render/GUI_sdlRender.cpp	2010-05-16 17:16:28 UTC (rev 6194)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/ADM_render/GUI_sdlRender.cpp	2010-05-16 17:16:31 UTC (rev 6195)
@@ -56,7 +56,8 @@
 */
 sdlRender::sdlRender( void)
 {
-        useYV12=true;
+        useYV12=true;
+        ADM_info("[SDL] Init rendered\n");
 }
 /**
     \fn stop
@@ -250,16 +251,7 @@
 
         return 1;
 }
-
-static void interleave(uint8_t *dst,uint8_t *src,int width, int stride, int lines)
-{
-    for(int y=0;y<lines;y++)
-    {
-        memcpy(dst,src,width);
-        src+=width;
-        dst+=stride;
-    }
-}
+
 /**
     \fn displayImage
 */
@@ -284,50 +276,44 @@
 		}
 	}
 #endif
-#warning FIXME
-#if 0
+#warning FIXME
 int pitch;
 int w=imageWidth;
 int h=imageHeight;
 int page=w*h;
-uint8_t *ptr=pic->data;
 
         ADM_assert(sdl_overlay);
         SDL_LockYUVOverlay(sdl_overlay);
         pitch=sdl_overlay->pitches[0];
 //	printf("SDL: new pitch :%d\n",pitch);
         if(useYV12)
-        {
-	        if(pitch==w)
-	            memcpy(sdl_overlay->pixels[0],ptr,w*h);
-	        else
-	            interleave(sdl_overlay->pixels[0],ptr,w,pitch,h);
+        {
+            uint32_t imagePitch[3];
+            uint8_t  *imagePtr[3];
+            pic->GetPitches(imagePitch);
+            pic->GetWritePlanes(imagePtr);
+            //
+            BitBlit(sdl_overlay->pixels[0],sdl_overlay->pitches[0],imagePtr[0],imagePitch[0],w, h);
+            BitBlit(sdl_overlay->pixels[1],sdl_overlay->pitches[1],imagePtr[1],imagePitch[1],w/2, h/2);
+            BitBlit(sdl_overlay->pixels[2],sdl_overlay->pitches[2],imagePtr[2],imagePitch[2],w/2, h/2);
 
-	        pitch=sdl_overlay->pitches[1];
-	        if(pitch==(w>>1))
-	            memcpy(sdl_overlay->pixels[1],ptr+page,(w*h)>>2);
-	        else
-	            interleave(sdl_overlay->pixels[1],ptr+page,w>>1,pitch,h>>1);
-
-	        pitch=sdl_overlay->pitches[2];
-	        if(pitch==(w>>1))
-	            memcpy(sdl_overlay->pixels[2],ptr+(page*5)/4,(w*h)>>2);
-	        else
-	            interleave(sdl_overlay->pixels[2],ptr+(page*5)/4,w>>1,pitch,h>>1);
         }else
-#endif
-        {
+
+        { // YUYV
 #if 0
-	        color->changeWidthHeight(w,h);
+	        scaler->changeWidthHeight(w,h);
 	        if(pitch==2*w)
 	        {
-	            color->convert(ptr,sdl_overlay->pixels[0]);
+	            scaler->convert(pic,sdl_overlay->pixels[0]);
 	        }
 	        else
 	        {
-	            color->convert(ptr,decoded);
-	            interleave(sdl_overlay->pixels[0],decoded,2*w,pitch,h);
+	            scaler->convert(pic,decoded);
+                BitBlit(sdl_overlay->pixels[0],sdl_overlay->pitches[0],decoded,2*w,h);
 	        }
+#else
+            ADM_warning("[SDL] YUYV disabled\n");
+            return false;
 #endif
         }
        



From mean at mail.berlios.de  Thu May 20 17:22:30 2010
From: mean at mail.berlios.de (mean at BerliOS)
Date: Thu, 20 May 2010 17:22:30 +0200
Subject: [Avidemux-svn-commit] r6198 -
	branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/ffmpeg_config
Message-ID: <201005201522.o4KFMUfZ014186@sheep.berlios.de>

Author: mean
Date: 2010-05-20 17:22:30 +0200 (Thu, 20 May 2010)
New Revision: 6198

Modified:
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/ffmpeg_config/config.h
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/ffmpeg_config/ffconf.c
Log:
[vdpau] Enable mpeg2,mpeg1, wmv3,vc1 decoding through vdpau

Modified: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/ffmpeg_config/config.h
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/ffmpeg_config/config.h	2010-05-20 10:56:51 UTC (rev 6197)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/ffmpeg_config/config.h	2010-05-20 15:22:30 UTC (rev 6198)
@@ -6,13 +6,17 @@
 #define CONFIG_WMV3_VAAPI_HWACCEL 0
 #ifdef USE_VDPAU
 #define CONFIG_H264_VDPAU_DECODER 1
+#define CONFIG_MPEG_VDPAU_DECODER 1
+#define CONFIG_MPEG1_VDPAU_DECODER 1
+#define CONFIG_VC1_VDPAU_DECODER 1
+#define CONFIG_WMV3_VDPAU_DECODER 1
 #else // USE_VDPAU
 #define CONFIG_H264_VDPAU_DECODER 0
-#endif // 
 #define CONFIG_MPEG_VDPAU_DECODER 0
 #define CONFIG_MPEG1_VDPAU_DECODER 0
 #define CONFIG_VC1_VDPAU_DECODER 0
 #define CONFIG_WMV3_VDPAU_DECODER 0
+#endif // 
 #define CONFIG_SVQ1_DECODER 1
 #define CONFIG_AAC_DECODER 1
 #define CONFIG_MPEG4AAC_DECODER 1

Modified: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/ffmpeg_config/ffconf.c
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/ffmpeg_config/ffconf.c	2010-05-20 10:56:51 UTC (rev 6197)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/ffmpeg_config/ffconf.c	2010-05-20 15:22:30 UTC (rev 6198)
@@ -20,17 +20,21 @@
 #define DECLARE_VDPAU(a,b); printf("#define CONFIG_"#a"_VDPAU_DECODER 1\n");
         printf("#ifdef USE_VDPAU\n");
         printf("#define CONFIG_H264_VDPAU_DECODER 1\n");
+        printf("#define CONFIG_MPEG_VDPAU_DECODER 1\n");
+        printf("#define CONFIG_MPEG1_VDPAU_DECODER 1\n");
+        printf("#define CONFIG_VC1_VDPAU_DECODER 1\n");
+        printf("#define CONFIG_WMV3_VDPAU_DECODER 1\n");
         printf("#else // USE_VDPAU\n");
         printf("#define CONFIG_H264_VDPAU_DECODER 0\n");
+        printf("#define CONFIG_MPEG_VDPAU_DECODER 0\n");
+        printf("#define CONFIG_MPEG1_VDPAU_DECODER 0\n");
+        printf("#define CONFIG_VC1_VDPAU_DECODER 0\n");
+        printf("#define CONFIG_WMV3_VDPAU_DECODER 0\n");
         printf("#endif // \n");
         
 
 #undef DECLARE_VDPAU
 #define DECLARE_VDPAU(a,b); printf("#define CONFIG_"#a"_VDPAU_DECODER 0\n");
-    DECLARE_VDPAU(MPEG,nellymoser);
-    DECLARE_VDPAU(MPEG1,nellymoser);
-    DECLARE_VDPAU(VC1,nellymoser);
-    DECLARE_VDPAU(WMV3,nellymoser);
 
 
 #define DECLARE_DECODER(a,b); printf("#define CONFIG_"#a"_DECODER 1\n");



From mean at mail.berlios.de  Thu May 20 17:22:32 2010
From: mean at mail.berlios.de (mean at BerliOS)
Date: Thu, 20 May 2010 17:22:32 +0200
Subject: [Avidemux-svn-commit] r6199 - in branches/avidemux_2.6_branch_mean:
	avidemux/common/ADM_videoCodec/src
	avidemux_core/ADM_coreVideoCodec/src
Message-ID: <201005201522.o4KFMWaE014197@sheep.berlios.de>

Author: mean
Date: 2010-05-20 17:22:32 +0200 (Thu, 20 May 2010)
New Revision: 6199

Modified:
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_videoCodec/src/ADM_ffmpeg_vdpau.cpp
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_videoCodec/src/ADM_videoCodec.cpp
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreVideoCodec/src/ADM_ffmp43.cpp
Log:
[vdpau] If vdpau is enabled, use vdpau to decode

Modified: branches/avidemux_2.6_branch_mean/avidemux/common/ADM_videoCodec/src/ADM_ffmpeg_vdpau.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/ADM_videoCodec/src/ADM_ffmpeg_vdpau.cpp	2010-05-20 15:22:30 UTC (rev 6198)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/ADM_videoCodec/src/ADM_ffmpeg_vdpau.cpp	2010-05-20 15:22:32 UTC (rev 6199)
@@ -52,6 +52,14 @@
 
 #define aprintf(...) {}
 
+typedef enum 
+{
+    ADM_VDPAU_INVALID=0,
+    ADM_VDPAU_H264=1,
+    ADM_VDPAU_MPEG2=2,
+    ADM_VDPAU_VC1=3
+}ADM_VDPAU_TYPE;
+
 /**
     \fn vdpauUsable
     \brief Return true if  vdpau can be used...
@@ -218,13 +226,32 @@
 
         vdpau=(void *)new vdpauContext;
         VDPAU->vdpDecoder=VDP_INVALID_HANDLE;
-        WRAP_OpenByName(h264_vdpau,CODEC_ID_H264);
+        ADM_VDPAU_TYPE vdpauType=ADM_VDPAU_INVALID;
+        if(isH264Compatible(fcc))
+        {
+            vdpauType=ADM_VDPAU_H264;
+        }else if(isMpeg12Compatible(fcc))
+        {
+            vdpauType=ADM_VDPAU_MPEG2;
+        }else ADM_assert(0);
+        int vdpDecoder;
+        switch(vdpauType)
+        {
+            case ADM_VDPAU_H264 : vdpDecoder=VDP_DECODER_PROFILE_H264_HIGH;
+                                  WRAP_OpenByName(h264_vdpau,CODEC_ID_H264);
+                                  break;
+            case ADM_VDPAU_MPEG2: 
+                                  vdpDecoder=VDP_DECODER_PROFILE_MPEG2_MAIN;
+                                  WRAP_OpenByName(mpegvideo_vdpau,CODEC_ID_MPEG2VIDEO);
+                                  break;
+            default: ADM_assert(0);
+        }
         ADM_info("[VDPAU] Decoder created \n");
         // Now instantiate our VDPAU surface & decoder
         for(int i=0;i<NB_SURFACE;i++)
             VDPAU->renders[i]=NULL;
-
-        if(VDP_STATUS_OK!=funcs.decoderCreate(vdpDevice,VDP_DECODER_PROFILE_H264_HIGH,
+        
+        if(VDP_STATUS_OK!=funcs.decoderCreate(vdpDevice,vdpDecoder,
                                 w,h,15,&(VDPAU->vdpDecoder)))
         {
             ADM_error("Cannot create VDPAU decoder\n");
@@ -295,7 +322,7 @@
         return 0;
     }
     // other part will be done in goOn
-  struct vdpau_render_state *rndr = (struct vdpau_render_state *)scratch->GetWritePtr(PLANAR_Y);
+  struct vdpau_render_state *rndr = (struct vdpau_render_state *)scratch->GetReadPtr(PLANAR_Y);
    VdpVideoSurface  surface;
 
     surface=rndr->surface;

Modified: branches/avidemux_2.6_branch_mean/avidemux/common/ADM_videoCodec/src/ADM_videoCodec.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/ADM_videoCodec/src/ADM_videoCodec.cpp	2010-05-20 15:22:30 UTC (rev 6198)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/ADM_videoCodec/src/ADM_videoCodec.cpp	2010-05-20 15:22:32 UTC (rev 6199)
@@ -37,7 +37,7 @@
 decoders *ADM_getDecoder (uint32_t fcc, uint32_t w, uint32_t h, uint32_t extraLen, uint8_t * extraData,uint32_t bpp)
 {
   ADM_info("Searching decoder in coreVideoCodec(%d x %d, extradataSize:%d)...\n",w,h,extraLen);
-  if (isH264Compatible (fcc))
+  if (isH264Compatible (fcc) || isMpeg12Compatible(fcc))
     {
 #if defined(USE_VDPAU) 
         if(vdpauUsable()==true)

Modified: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreVideoCodec/src/ADM_ffmp43.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreVideoCodec/src/ADM_ffmp43.cpp	2010-05-20 15:22:30 UTC (rev 6198)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreVideoCodec/src/ADM_ffmp43.cpp	2010-05-20 15:22:32 UTC (rev 6199)
@@ -439,6 +439,10 @@
     case PIX_FMT_RGB555:
       out->_colorspace = ADM_COLOR_RGB555;
       break;
+    case PIX_FMT_VDPAU_MPEG1:
+    case PIX_FMT_VDPAU_MPEG2:
+    case PIX_FMT_VDPAU_WMV3:
+    case PIX_FMT_VDPAU_VC1:
     case PIX_FMT_VDPAU_H264:
         out->_colorspace=ADM_COLOR_VDPAU;
         break;



From mean at mail.berlios.de  Thu May 20 17:22:33 2010
From: mean at mail.berlios.de (mean at BerliOS)
Date: Thu, 20 May 2010 17:22:33 +0200
Subject: [Avidemux-svn-commit] r6200 - in
	branches/avidemux_2.6_branch_mean/avidemux_core/ADM_core:
	include src
Message-ID: <201005201522.o4KFMXE3014208@sheep.berlios.de>

Author: mean
Date: 2010-05-20 17:22:33 +0200 (Thu, 20 May 2010)
New Revision: 6200

Modified:
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_core/include/ADM_assert.h
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_core/src/ADM_fileio.cpp
Log:
[core] fwrite takes const as 1st arg

Modified: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_core/include/ADM_assert.h
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_core/include/ADM_assert.h	2010-05-20 15:22:32 UTC (rev 6199)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_core/include/ADM_assert.h	2010-05-20 15:22:33 UTC (rev 6200)
@@ -35,7 +35,7 @@
 
 /* Replacement for fread & friends */
 size_t          ADM_fread (void *ptr, size_t size, size_t n, FILE *sstream);
-size_t          ADM_fwrite (void *ptr, size_t size, size_t n, FILE *sstream);
+size_t          ADM_fwrite (const void *ptr, size_t size, size_t n, FILE *sstream);
 FILE            *ADM_fopen (const char *file, const char *mode);
 int             ADM_fclose (FILE *file);
 uint8_t         ADM_fileExist(const char *name);

Modified: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_core/src/ADM_fileio.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_core/src/ADM_fileio.cpp	2010-05-20 15:22:32 UTC (rev 6199)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_core/src/ADM_fileio.cpp	2010-05-20 15:22:33 UTC (rev 6200)
@@ -62,7 +62,7 @@
 	return fread(ptr,size,n,sstream);
 }
 
-size_t ADM_fwrite(void *ptr, size_t size, size_t n, FILE *sstream)
+size_t ADM_fwrite(const void *ptr, size_t size, size_t n, FILE *sstream)
 {
 	return fwrite(ptr,size,n,sstream);
 }



From mean at mail.berlios.de  Thu May 20 17:22:35 2010
From: mean at mail.berlios.de (mean at BerliOS)
Date: Thu, 20 May 2010 17:22:35 +0200
Subject: [Avidemux-svn-commit] r6201 -
	branches/avidemux_2.6_branch_mean/avidemux/common/ADM_videoCodec/src
Message-ID: <201005201522.o4KFMZ7J014218@sheep.berlios.de>

Author: mean
Date: 2010-05-20 17:22:34 +0200 (Thu, 20 May 2010)
New Revision: 6201

Modified:
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_videoCodec/src/ADM_ffmpeg_vdpau.cpp
Log:
[vdpau] Simplify

Modified: branches/avidemux_2.6_branch_mean/avidemux/common/ADM_videoCodec/src/ADM_ffmpeg_vdpau.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/ADM_videoCodec/src/ADM_ffmpeg_vdpau.cpp	2010-05-20 15:22:33 UTC (rev 6200)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/ADM_videoCodec/src/ADM_ffmpeg_vdpau.cpp	2010-05-20 15:22:34 UTC (rev 6201)
@@ -322,18 +322,14 @@
         return 0;
     }
     // other part will be done in goOn
-  struct vdpau_render_state *rndr = (struct vdpau_render_state *)scratch->GetReadPtr(PLANAR_Y);
+   struct vdpau_render_state *rndr = (struct vdpau_render_state *)scratch->GetReadPtr(PLANAR_Y);
    VdpVideoSurface  surface;
 
     surface=rndr->surface;
- void *planes[3];
-            planes[0]=vdpau_copy->GetWritePtr(PLANAR_Y);
-            planes[1]=vdpau_copy->GetWritePtr(PLANAR_U);
-            planes[2]=vdpau_copy->GetWritePtr(PLANAR_V);
+    uint8_t *planes[3];
     uint32_t stride[3];
-            stride[0]=vdpau_copy->GetPitch(PLANAR_Y);
-            stride[1]=vdpau_copy->GetPitch(PLANAR_U);
-            stride[2]=vdpau_copy->GetPitch(PLANAR_V);
+             vdpau_copy->GetWritePlanes(planes);
+             vdpau_copy->GetPitches(stride);
 
     
    // Copy back the decoded image to our output ADM_image
@@ -341,7 +337,7 @@
     status=funcs.getDataSurface(
                 surface,
                 VDP_YCBCR_FORMAT_YV12, //VdpYCbCrFormat   destination_ycbcr_format,
-                planes, //void * const *   destination_data,
+                ( void * const *)planes, //void * const *   destination_data,
                 stride //destination_pitches
                 );
     if(VDP_STATUS_OK!=status)
@@ -351,9 +347,6 @@
         decode_status=false;
         return 0 ;
     }
-    
-
-    //
     out->Pts=scratch->Pts;
     out->flags=scratch->flags;
     return (uint8_t)decode_status;



From mean at mail.berlios.de  Thu May 20 17:22:40 2010
From: mean at mail.berlios.de (mean at BerliOS)
Date: Thu, 20 May 2010 17:22:40 +0200
Subject: [Avidemux-svn-commit] r6202 - in
	branches/avidemux_2.6_branch_mean/avidemux_core: .
	ADM_coreTinyPy ADM_coreTinyPy/include ADM_coreTinyPy/src
Message-ID: <201005201522.o4KFMeBa014234@sheep.berlios.de>

Author: mean
Date: 2010-05-20 17:22:36 +0200 (Thu, 20 May 2010)
New Revision: 6202

Added:
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreTinyPy/
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreTinyPy/CMakeLists.txt
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreTinyPy/include/
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreTinyPy/include/ADM_tinypy.h
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreTinyPy/include/tinypy.h
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreTinyPy/src/
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreTinyPy/src/ADM_tinypy.cpp
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreTinyPy/src/CMakeLists.txt
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreTinyPy/src/tinypy.c
Modified:
   branches/avidemux_2.6_branch_mean/avidemux_core/CMakeLists.txt
Log:
[tinypy] Base wrapper around tinypy

Added: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreTinyPy/CMakeLists.txt
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreTinyPy/CMakeLists.txt	2010-05-20 15:22:34 UTC (rev 6201)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreTinyPy/CMakeLists.txt	2010-05-20 15:22:36 UTC (rev 6202)
@@ -0,0 +1 @@
+ADD_SUBDIRECTORY(src)

Added: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreTinyPy/include/ADM_tinypy.h
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreTinyPy/include/ADM_tinypy.h	2010-05-20 15:22:34 UTC (rev 6201)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreTinyPy/include/ADM_tinypy.h	2010-05-20 15:22:36 UTC (rev 6202)
@@ -0,0 +1,32 @@
+/***************************************************************************
+    \file  ADM_tinypy.cpp
+    \brief Wrapper around tinypy
+    \author mean fixounet at free.fr (c) 2010
+
+ ***************************************************************************/
+
+/***************************************************************************
+ *                                                                         *
+ *   This program is free software; you can redistribute it and/or modify  *
+ *   it under the terms of the GNU General Public License as published by  *
+ *   the Free Software Foundation; either version 2 of the License, or     *
+ *   (at your option) any later version.                                   *
+ *                                                                         *
+ ***************************************************************************/
+#ifndef ADM_TINYPY_H
+#define ADM_TINYPY_H
+/**
+    \class tinyPy
+*/
+class tinyPy 
+{
+protected:
+        void *instance;
+        void *script;
+public:
+                tinyPy(void);
+        bool    init(void);
+                ~tinyPy(void);
+        bool    execString(const char *s);
+};
+#endif

Added: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreTinyPy/include/tinypy.h
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreTinyPy/include/tinypy.h	2010-05-20 15:22:34 UTC (rev 6201)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreTinyPy/include/tinypy.h	2010-05-20 15:22:36 UTC (rev 6202)
@@ -0,0 +1,611 @@
+/*
+================================================================================
+
+tinypy contains tinypy code licensed in a MIT format license.  It also
+contains some goodies grabbed from Python, so that license is included
+as well.
+
+================================================================================
+
+The tinypy License
+
+Copyright (c) 2008 Phil Hassey
+
+Permission is hereby granted, free of charge, to any person obtaining a copy
+of this software and associated documentation files (the "Software"), to deal
+in the Software without restriction, including without limitation the rights
+to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
+copies of the Software, and to permit persons to whom the Software is
+furnished to do so, subject to the following conditions:
+
+The above copyright notice and this permission notice shall be included in
+all copies or substantial portions of the Software.
+
+THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
+IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
+FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
+AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
+LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
+OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
+THE SOFTWARE.
+
+================================================================================
+
+PYTHON SOFTWARE FOUNDATION LICENSE VERSION 2
+--------------------------------------------
+
+1. This LICENSE AGREEMENT is between the Python Software Foundation
+("PSF"), and the Individual or Organization ("Licensee") accessing and
+otherwise using this software ("Python") in source or binary form and
+its associated documentation.
+
+2. Subject to the terms and conditions of this License Agreement, PSF
+hereby grants Licensee a nonexclusive, royalty-free, world-wide
+license to reproduce, analyze, test, perform and/or display publicly,
+prepare derivative works, distribute, and otherwise use Python
+alone or in any derivative version, provided, however, that PSF's
+License Agreement and PSF's notice of copyright, i.e., "Copyright (c)
+2001, 2002, 2003, 2004, 2005, 2006, 2007 Python Software Foundation;
+All Rights Reserved" are retained in Python alone or in any derivative
+version prepared by Licensee.
+
+3. In the event Licensee prepares a derivative work that is based on
+or incorporates Python or any part thereof, and wants to make
+the derivative work available to others as provided herein, then
+Licensee hereby agrees to include in any such work a brief summary of
+the changes made to Python.
+
+4. PSF is making Python available to Licensee on an "AS IS"
+basis.  PSF MAKES NO REPRESENTATIONS OR WARRANTIES, EXPRESS OR
+IMPLIED.  BY WAY OF EXAMPLE, BUT NOT LIMITATION, PSF MAKES NO AND
+DISCLAIMS ANY REPRESENTATION OR WARRANTY OF MERCHANTABILITY OR FITNESS
+FOR ANY PARTICULAR PURPOSE OR THAT THE USE OF PYTHON WILL NOT
+INFRINGE ANY THIRD PARTY RIGHTS.
+
+5. PSF SHALL NOT BE LIABLE TO LICENSEE OR ANY OTHER USERS OF PYTHON
+FOR ANY INCIDENTAL, SPECIAL, OR CONSEQUENTIAL DAMAGES OR LOSS AS
+A RESULT OF MODIFYING, DISTRIBUTING, OR OTHERWISE USING PYTHON,
+OR ANY DERIVATIVE THEREOF, EVEN IF ADVISED OF THE POSSIBILITY THEREOF.
+
+6. This License Agreement will automatically terminate upon a material
+breach of its terms and conditions.
+
+7. Nothing in this License Agreement shall be deemed to create any
+relationship of agency, partnership, or joint venture between PSF and
+Licensee.  This License Agreement does not grant permission to use PSF
+trademarks or trade name in a trademark sense to endorse or promote
+products or services of Licensee, or any third party.
+
+8. By copying, installing or otherwise using Python, Licensee
+agrees to be bound by the terms and conditions of this License
+Agreement.
+
+================================================================================
+*/
+
+#ifndef TINYPY_H
+#define TINYPY_H
+/* File: General
+ * Things defined in tp.h.
+ */
+#ifndef TP_H
+#define TP_H
+
+#include <setjmp.h>
+#include <sys/stat.h>
+#ifndef __USE_ISOC99
+#define __USE_ISOC99
+#endif
+#include <stdio.h>
+#include <stdlib.h>
+#include <string.h>
+#include <stdarg.h>
+#include <math.h>
+#include <time.h>
+
+#ifdef __GNUC__
+#define tp_inline __inline__
+#endif
+
+#ifdef _MSC_VER
+#ifdef NDEBUG
+#define tp_inline __inline
+#else
+/* don't inline in debug builds (for easier debugging) */
+#define tp_inline
+#endif
+#endif
+
+#ifndef tp_inline
+#error "Unsuported compiler"
+#endif
+
+/*  #define tp_malloc(x) calloc((x),1)
+    #define tp_realloc(x,y) realloc(x,y)
+    #define tp_free(x) free(x) */
+
+/* #include <gc/gc.h>
+   #define tp_malloc(x) GC_MALLOC(x)
+   #define tp_realloc(x,y) GC_REALLOC(x,y)
+   #define tp_free(x)*/
+
+enum {
+    TP_NONE,TP_NUMBER,TP_STRING,TP_DICT,
+    TP_LIST,TP_FNC,TP_DATA,
+};
+
+typedef double tp_num;
+
+typedef struct tp_number_ {
+    int type;
+    tp_num val;
+} tp_number_;
+typedef struct tp_string_ {
+    int type;
+    struct _tp_string *info;
+    char const *val;
+    int len;
+} tp_string_;
+typedef struct tp_list_ {
+    int type;
+    struct _tp_list *val;
+} tp_list_;
+typedef struct tp_dict_ {
+    int type;
+    struct _tp_dict *val;
+    int dtype;
+} tp_dict_;
+typedef struct tp_fnc_ {
+    int type;
+    struct _tp_fnc *info;
+    int ftype;
+    void *cfnc;
+} tp_fnc_;
+typedef struct tp_data_ {
+    int type;
+    struct _tp_data *info;
+    void *val;
+    int magic;
+} tp_data_;
+
+/* Type: tp_obj
+ * Tinypy's object representation.
+ *
+ * Every object in tinypy is of this type in the C API.
+ *
+ * Fields:
+ * type - This determines what kind of objects it is. It is either TP_NONE, in
+ *        which case this is the none type and no other fields can be accessed.
+ *        Or it has one of the values listed below, and the corresponding
+ *        fields can be accessed.
+ * number - TP_NUMBER
+ * number.val - A double value with the numeric value.
+ * string - TP_STRING
+ * string.val - A pointer to the string data.
+ * string.len - Length in bytes of the string data.
+ * dict - TP_DICT
+ * list - TP_LIST
+ * fnc - TP_FNC
+ * data - TP_DATA
+ * data.val - The user-provided data pointer.
+ * data.magic - The user-provided magic number for identifying the data type.
+ */
+typedef union tp_obj {
+    int type;
+    tp_number_ number;
+    struct { int type; int *data; } gci;
+    tp_string_ string;
+    tp_dict_ dict;
+    tp_list_ list;
+    tp_fnc_ fnc;
+    tp_data_ data;
+} tp_obj;
+
+typedef struct _tp_string {
+    int gci;
+    int len;
+    char s[1];
+} _tp_string;
+typedef struct _tp_list {
+    int gci;
+    tp_obj *items;
+    int len;
+    int alloc;
+} _tp_list;
+typedef struct tp_item {
+    int used;
+    int hash;
+    tp_obj key;
+    tp_obj val;
+} tp_item;
+typedef struct _tp_dict {
+    int gci;
+    tp_item *items;
+    int len;
+    int alloc;
+    int cur;
+    int mask;
+    int used;
+    tp_obj meta;
+} _tp_dict;
+typedef struct _tp_fnc {
+    int gci;
+    tp_obj self;
+    tp_obj globals;
+    tp_obj code;
+} _tp_fnc;
+
+
+typedef union tp_code {
+    unsigned char i;
+    struct { unsigned char i,a,b,c; } regs;
+    struct { char val[4]; } string;
+    struct { float val; } number;
+} tp_code;
+
+typedef struct tp_frame_ {
+/*    tp_code *codes; */
+    tp_obj code;
+    tp_code *cur;
+    tp_code *jmp;
+    tp_obj *regs;
+    tp_obj *ret_dest;
+    tp_obj fname;
+    tp_obj name;
+    tp_obj line;
+    tp_obj globals;
+    int lineno;
+    int cregs;
+} tp_frame_;
+
+#define TP_GCMAX 4096
+#define TP_FRAMES 256
+#define TP_REGS_EXTRA 2
+/* #define TP_REGS_PER_FRAME 256*/
+#define TP_REGS 16384
+
+/* Type: tp_vm
+ * Representation of a tinypy virtual machine instance.
+ *
+ * A new tp_vm struct is created with <tp_init>, and will be passed to most
+ * tinypy functions as first parameter. It contains all the data associated
+ * with an instance of a tinypy virtual machine - so it is easy to have
+ * multiple instances running at the same time. When you want to free up all
+ * memory used by an instance, call <tp_deinit>.
+ *
+ * Fields:
+ * These fields are currently documented:
+ *
+ * builtins - A dictionary containing all builtin objects.
+ * modules - A dictionary with all loaded modules.
+ * params - A list of parameters for the current function call.
+ * frames - A list of all call frames.
+ * cur - The index of the currently executing call frame.
+ * frames[n].globals - A dictionary of global sybmols in callframe n.
+ */
+typedef struct tp_vm {
+    tp_obj builtins;
+    tp_obj modules;
+    tp_frame_ frames[TP_FRAMES];
+    tp_obj _params;
+    tp_obj params;
+    tp_obj _regs;
+    tp_obj *regs;
+    tp_obj root;
+    jmp_buf buf;
+#ifdef CPYTHON_MOD
+    jmp_buf nextexpr;
+#endif
+    int jmp;
+    tp_obj ex;
+    char chars[256][2];
+    int cur;
+    /* gc */
+    _tp_list *white;
+    _tp_list *grey;
+    _tp_list *black;
+    int steps;
+    /* sandbox */
+    clock_t clocks;
+    double time_elapsed;
+    double time_limit;
+    unsigned long mem_limit;
+    unsigned long mem_used;
+    int mem_exceeded;
+} tp_vm;
+
+#define TP tp_vm *tp
+typedef struct _tp_data {
+    int gci;
+    void (*xfree)(TP,tp_obj); // MEANX
+} _tp_data;
+
+#define tp_True tp_number(1)
+#define tp_False tp_number(0)
+
+extern tp_obj tp_None;
+
+#ifdef TP_SANDBOX
+void *tp_malloc(TP, unsigned long);
+void *tp_realloc(TP, void *, unsigned long);
+void tp_free(TP, void *);
+#else
+#define tp_malloc(TP,x) calloc((x),1)
+#define tp_realloc(TP,x,y) realloc(x,y)
+#define tp_free(TP,x) free(x)
+#endif
+
+void tp_sandbox(TP, double, unsigned long);
+void tp_time_update(TP);
+void tp_mem_update(TP);
+
+void tp_run(TP,int cur);
+void tp_set(TP,tp_obj,tp_obj,tp_obj);
+tp_obj tp_get(TP,tp_obj,tp_obj);
+tp_obj tp_has(TP,tp_obj self, tp_obj k);
+tp_obj tp_len(TP,tp_obj);
+void tp_del(TP,tp_obj,tp_obj);
+tp_obj tp_str(TP,tp_obj);
+int tp_bool(TP,tp_obj);
+int tp_cmp(TP,tp_obj,tp_obj);
+void _tp_raise(TP,tp_obj);
+tp_obj tp_printf(TP,char const *fmt,...);
+tp_obj tp_track(TP,tp_obj);
+void tp_grey(TP,tp_obj);
+tp_obj tp_call(TP, tp_obj fnc, tp_obj params);
+tp_obj tp_add(TP,tp_obj a, tp_obj b) ;
+
+/* __func__ __VA_ARGS__ __FILE__ __LINE__ */
+
+/* Function: tp_raise
+ * Macro to raise an exception.
+ *
+ * This macro will return from the current function returning "r". The
+ * remaining parameters are used to format the exception message.
+ */
+/*
+#define tp_raise(r,fmt,...) { \
+    _tp_raise(tp,tp_printf(tp,fmt,__VA_ARGS__)); \
+    return r; \
+}
+*/
+#define tp_raise(r,v) { \
+    _tp_raise(tp,v); \
+    return r; \
+}
+
+/* Function: tp_string
+ * Creates a new string object from a C string.
+ *
+ * Given a pointer to a C string, creates a tinypy object representing the
+ * same string.
+ *
+ * *Note* Only a reference to the string will be kept by tinypy, so make sure
+ * it does not go out of scope, and don't de-allocate it. Also be aware that
+ * tinypy will not delete the string for you. In many cases, it is best to
+ * use <tp_string_t> or <tp_string_slice> to create a string where tinypy
+ * manages storage for you.
+ */
+tp_inline static tp_obj tp_string(char const *v) {
+    tp_obj val;
+    tp_string_ s = {TP_STRING, 0, v, 0};
+    s.len = strlen(v);
+    val.string = s;
+    return val;
+}
+
+#define TP_CSTR_LEN 256
+
+tp_inline static void tp_cstr(TP,tp_obj v, char *s, int l) {
+    if (v.type != TP_STRING) {
+        tp_raise(,tp_string("(tp_cstr) TypeError: value not a string"));
+    }
+    if (v.string.len >= l) {
+        tp_raise(,tp_string("(tp_cstr) TypeError: value too long"));
+    }
+    memset(s,0,l);
+    memcpy(s,v.string.val,v.string.len);
+}
+
+
+#define TP_OBJ() (tp_get(tp,tp->params,tp_None))
+tp_inline static tp_obj tp_type(TP,int t,tp_obj v) {
+    if (v.type != t) { tp_raise(tp_None,tp_string("(tp_type) TypeError: unexpected type")); }
+    return v;
+}
+
+
+
+#define TP_NO_LIMIT 0
+#define TP_TYPE(t) tp_type(tp,t,TP_OBJ())
+#define TP_NUM() (TP_TYPE(TP_NUMBER).number.val)
+/* #define TP_STR() (TP_CSTR(TP_TYPE(TP_STRING))) */
+#define TP_STR() (TP_TYPE(TP_STRING))
+#define TP_DEFAULT(d) (tp->params.list.val->len?tp_get(tp,tp->params,tp_None):(d))
+
+/* Macro: TP_LOOP
+ * Macro to iterate over all remaining arguments.
+ *
+ * If you have a function which takes a variable number of arguments, you can
+ * iterate through all remaining arguments for example like this:
+ *
+ * > tp_obj *my_func(tp_vm *tp)
+ * > {
+ * >     // We retrieve the first argument like normal.
+ * >     tp_obj first = TP_OBJ();
+ * >     // Then we iterate over the remaining arguments.
+ * >     tp_obj arg;
+ * >     TP_LOOP(arg)
+ * >         // do something with arg
+ * >     TP_END
+ * > }
+ */
+#define TP_LOOP(e) \
+    int __l = tp->params.list.val->len; \
+    int __i; for (__i=0; __i<__l; __i++) { \
+    (e) = _tp_list_get(tp,tp->params.list.val,__i,"TP_LOOP");
+#define TP_END \
+    }
+
+tp_inline static int _tp_min(int a, int b) { return (a<b?a:b); }
+tp_inline static int _tp_max(int a, int b) { return (a>b?a:b); }
+tp_inline static int _tp_sign(tp_num v) { return (v<0?-1:(v>0?1:0)); }
+
+/* Function: tp_number
+ * Creates a new numeric object.
+ */
+tp_inline static tp_obj tp_number(tp_num v) {
+    tp_obj val = {TP_NUMBER};
+    val.number.val = v;
+    return val;
+}
+
+tp_inline static void tp_echo(TP,tp_obj e) {
+    e = tp_str(tp,e);
+    fwrite(e.string.val,1,e.string.len,stdout);
+}
+
+/* Function: tp_string_n
+ * Creates a new string object from a partial C string.
+ *
+ * Like <tp_string>, but you specify how many bytes of the given C string to
+ * use for the string object. The *note* also applies for this function, as the
+ * string reference and length are kept, but no actual substring is stored.
+ */
+tp_inline static tp_obj tp_string_n(char const *v,int n) {
+    tp_obj val;
+    tp_string_ s = {TP_STRING, 0,v,n};
+    val.string = s;
+    return val;
+}
+
+#endif
+void _tp_list_realloc(TP, _tp_list *self,int len) ;
+void _tp_list_set(TP,_tp_list *self,int k, tp_obj v, const char *error) ;
+void _tp_list_free(TP, _tp_list *self) ;
+tp_obj _tp_list_get(TP,_tp_list *self,int k,const char *error) ;
+void _tp_list_insertx(TP,_tp_list *self, int n, tp_obj v) ;
+void _tp_list_appendx(TP,_tp_list *self, tp_obj v) ;
+void _tp_list_insert(TP,_tp_list *self, int n, tp_obj v) ;
+void _tp_list_append(TP,_tp_list *self, tp_obj v) ;
+tp_obj _tp_list_pop(TP,_tp_list *self, int n, const char *error) ;
+int _tp_list_find(TP,_tp_list *self, tp_obj v) ;
+tp_obj tp_index(TP) ;
+_tp_list *_tp_list_new(TP) ;
+tp_obj _tp_list_copy(TP, tp_obj rr) ;
+tp_obj tp_append(TP) ;
+tp_obj tp_pop(TP) ;
+tp_obj tp_insert(TP) ;
+tp_obj tp_extend(TP) ;
+tp_obj tp_list_nt(TP) ;
+tp_obj tp_list(TP) ;
+tp_obj tp_list_n(TP,int n,tp_obj *argv) ;
+int _tp_sort_cmp(tp_obj *a,tp_obj *b) ;
+tp_obj tp_sort(TP) ;
+int tp_lua_hash(void const *v,int l) ;
+void _tp_dict_free(TP, _tp_dict *self) ;
+int tp_hash(TP,tp_obj v) ;
+void _tp_dict_hash_set(TP,_tp_dict *self, int hash, tp_obj k, tp_obj v) ;
+void _tp_dict_tp_realloc(TP,_tp_dict *self,int len) ;
+int _tp_dict_hash_find(TP,_tp_dict *self, int hash, tp_obj k) ;
+int _tp_dict_find(TP,_tp_dict *self,tp_obj k) ;
+void _tp_dict_setx(TP,_tp_dict *self,tp_obj k, tp_obj v) ;
+void _tp_dict_set(TP,_tp_dict *self,tp_obj k, tp_obj v) ;
+tp_obj _tp_dict_get(TP,_tp_dict *self,tp_obj k, const char *error) ;
+void _tp_dict_del(TP,_tp_dict *self,tp_obj k, const char *error) ;
+_tp_dict *_tp_dict_new(TP) ;
+tp_obj _tp_dict_copy(TP,tp_obj rr) ;
+int _tp_dict_next(TP,_tp_dict *self) ;
+tp_obj tp_merge(TP) ;
+tp_obj tp_dict(TP) ;
+tp_obj tp_dict_n(TP,int n, tp_obj* argv) ;
+tp_obj _tp_dcall(TP,tp_obj fnc(TP)) ;
+tp_obj _tp_tcall(TP,tp_obj fnc) ;
+tp_obj tp_fnc_new(TP,int t, void *v, tp_obj c,tp_obj s, tp_obj g) ;
+tp_obj tp_def(TP,tp_obj code, tp_obj g) ;
+tp_obj tp_fnc(TP,tp_obj v(TP)) ;
+tp_obj tp_method(TP,tp_obj self,tp_obj v(TP)) ;
+tp_obj tp_data(TP,int magic,void *v) ;
+tp_obj tp_params(TP) ;
+tp_obj tp_params_n(TP,int n, tp_obj argv[]) ;
+tp_obj tp_params_v(TP,int n,...) ;
+tp_obj tp_string_t(TP, int n) ;
+tp_obj tp_string_copy(TP, const char *s, int n) ;
+tp_obj tp_string_sub(TP, tp_obj s, int a, int b) ;
+int _tp_str_index(tp_obj s, tp_obj k) ;
+tp_obj tp_join(TP) ;
+tp_obj tp_split(TP) ;
+tp_obj tp_find(TP) ;
+tp_obj tp_str_index(TP) ;
+tp_obj tp_str2(TP) ;
+tp_obj tp_chr(TP) ;
+tp_obj tp_ord(TP) ;
+tp_obj tp_strip(TP) ;
+tp_obj tp_replace(TP) ;
+tp_obj tp_print(TP) ;
+tp_obj tp_bind(TP) ;
+tp_obj tp_min(TP) ;
+tp_obj tp_max(TP) ;
+tp_obj tp_copy(TP) ;
+tp_obj tp_len_(TP) ;
+tp_obj tp_assert(TP) ;
+tp_obj tp_range(TP) ;
+tp_obj tp_system(TP) ;
+tp_obj tp_istype(TP) ;
+tp_obj tp_float(TP) ;
+tp_obj tp_save(TP) ;
+tp_obj tp_load(TP) ;
+tp_obj tp_fpack(TP) ;
+tp_obj tp_abs(TP) ;
+tp_obj tp_int(TP) ;
+tp_num _roundf(tp_num v) ;
+tp_obj tp_round(TP) ;
+tp_obj tp_exists(TP) ;
+tp_obj tp_mtime(TP) ;
+int _tp_lookup_(TP,tp_obj self, tp_obj k, tp_obj *meta, int depth) ;
+int _tp_lookup(TP,tp_obj self, tp_obj k, tp_obj *meta) ;
+tp_obj tp_setmeta(TP) ;
+tp_obj tp_getmeta(TP) ;
+tp_obj tp_object(TP) ;
+tp_obj tp_object_new(TP) ;
+tp_obj tp_object_call(TP) ;
+tp_obj tp_getraw(TP) ;
+tp_obj tp_class(TP) ;
+tp_obj tp_builtins_bool(TP) ;
+void tp_follow(TP,tp_obj v) ;
+void tp_reset(TP) ;
+void tp_gc_init(TP) ;
+void tp_gc_deinit(TP) ;
+void tp_delete(TP,tp_obj v) ;
+void tp_collect(TP) ;
+void _tp_gcinc(TP) ;
+void tp_full(TP) ;
+void tp_gcinc(TP) ;
+tp_obj tp_iter(TP,tp_obj self, tp_obj k) ;
+int tp_iget(TP,tp_obj *r, tp_obj self, tp_obj k) ;
+tp_obj tp_mul(TP,tp_obj a, tp_obj b) ;
+tp_obj tp_bitwise_not(TP, tp_obj a) ;
+tp_vm *_tp_init(void) ;
+void tp_deinit(TP) ;
+void tp_frame(TP,tp_obj globals,tp_obj code,tp_obj *ret_dest) ;
+void tp_print_stack(TP) ;
+void tp_handle(TP) ;
+void tp_return(TP, tp_obj v) ;
+int tp_step(TP) ;
+void _tp_run(TP,int cur) ;
+tp_obj tp_ez_call(TP, const char *mod, const char *fnc, tp_obj params) ;
+tp_obj _tp_import(TP, tp_obj fname, tp_obj name, tp_obj code) ;
+tp_obj tp_import(TP, const char * fname, const char * name, void *codes, int len) ;
+tp_obj tp_exec_(TP) ;
+tp_obj tp_import_(TP) ;
+void tp_builtins(TP) ;
+void tp_args(TP,int argc, char *argv[]) ;
+tp_obj tp_main(TP,char *fname, void *code, int len) ;
+tp_obj tp_compile(TP, tp_obj text, tp_obj fname) ;
+tp_obj tp_exec(TP, tp_obj code, tp_obj globals) ;
+tp_obj tp_eval(TP, const char *text, tp_obj globals) ;
+tp_vm *tp_init(int argc, char *argv[]) ;
+void tp_compiler(TP) ;
+tp_obj tp_sandbox_(TP) ;
+void tp_bounds(TP, tp_code *cur, int n) ;
+#endif

Added: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreTinyPy/src/ADM_tinypy.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreTinyPy/src/ADM_tinypy.cpp	2010-05-20 15:22:34 UTC (rev 6201)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreTinyPy/src/ADM_tinypy.cpp	2010-05-20 15:22:36 UTC (rev 6202)
@@ -0,0 +1,78 @@
+/***************************************************************************
+    \file  ADM_tinypy.cpp
+    \brief Wrapper around tinypy
+    \author mean fixounet at free.fr (c) 2010
+
+ ***************************************************************************/
+
+/***************************************************************************
+ *                                                                         *
+ *   This program is free software; you can redistribute it and/or modify  *
+ *   it under the terms of the GNU General Public License as published by  *
+ *   the Free Software Foundation; either version 2 of the License, or     *
+ *   (at your option) any later version.                                   *
+ *                                                                         *
+ ***************************************************************************/
+#include "ADM_default.h"
+#include "ADM_tinypy.h"
+#include "tinypy.h"
+#define INSTANCE ((tp_vm *)instance)
+#define SCRIPT   ((tp_obj *)script)
+
+/**
+    \fn tinypy
+    \brief ctor
+*/
+tinyPy::tinyPy(void)
+{
+    instance=NULL;
+    script=NULL;
+}
+/**
+    \fn tinypy
+    \brief dtor
+
+*/
+tinyPy::~tinyPy()
+{
+    if(INSTANCE)
+    {
+        tp_deinit(INSTANCE);
+        instance=NULL;
+    }
+    if(script) // dealloc tp_ob
+    {
+
+    }
+}
+/**
+    \fn tinypy
+    \brief init
+*/
+bool tinyPy::init(void)
+{
+    ADM_assert(!instance);
+    instance=(void *)tp_init(0,NULL);
+    if(instance) return true;   
+    ADM_error("Cannot initialize tinypy\n");
+    return false;
+}
+/**
+    \fn tinypy
+    \brief init
+*/
+bool tinyPy::execString(const char *s)
+{
+    if(!instance)
+    {
+        ADM_warning("No instance\n");
+        return false;
+    }
+    tp_obj name = tp_string("avidemux6");
+    tp_obj program = tp_string(s);
+    tp_obj c = tp_compile(INSTANCE, program, name);
+    tp_exec(INSTANCE, c,INSTANCE->builtins);
+    return true;
+}
+
+// EOF
\ No newline at end of file

Added: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreTinyPy/src/CMakeLists.txt
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreTinyPy/src/CMakeLists.txt	2010-05-20 15:22:34 UTC (rev 6201)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreTinyPy/src/CMakeLists.txt	2010-05-20 15:22:36 UTC (rev 6202)
@@ -0,0 +1,12 @@
+SET(ADM_coreTinyPy_SRCS 
+        tinypy.c
+        ADM_tinypy.cpp
+)
+
+ADD_LIBRARY(ADM_coreTinyPy6 SHARED ${ADM_coreTinyPy_SRCS})
+IF (APPLE)
+	TARGET_LINK_LIBRARIES(ADM_coreTinyPy6 -Wl,-read_only_relocs,suppress)
+ENDIF (APPLE)
+INCLUDE_DIRECTORIES(../include)
+TARGET_LINK_LIBRARIES(ADM_coreTinyPy6 ADM_core6 ADM_coreUI6  ADM_coreUtils6)
+ADM_INSTALL_LIB(ADM_coreTinyPy6)

Added: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreTinyPy/src/tinypy.c
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreTinyPy/src/tinypy.c	2010-05-20 15:22:34 UTC (rev 6201)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreTinyPy/src/tinypy.c	2010-05-20 15:22:36 UTC (rev 6202)
@@ -0,0 +1,9490 @@
+/*
+================================================================================
+
+tinypy contains tinypy code licensed in a MIT format license.  It also
+contains some goodies grabbed from Python, so that license is included
+as well.
+
+================================================================================
+
+The tinypy License
+
+Copyright (c) 2008 Phil Hassey
+
+Permission is hereby granted, free of charge, to any person obtaining a copy
+of this software and associated documentation files (the "Software"), to deal
+in the Software without restriction, including without limitation the rights
+to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
+copies of the Software, and to permit persons to whom the Software is
+furnished to do so, subject to the following conditions:
+
+The above copyright notice and this permission notice shall be included in
+all copies or substantial portions of the Software.
+
+THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
+IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
+FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
+AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
+LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
+OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
+THE SOFTWARE.
+
+================================================================================
+
+PYTHON SOFTWARE FOUNDATION LICENSE VERSION 2
+--------------------------------------------
+
+1. This LICENSE AGREEMENT is between the Python Software Foundation
+("PSF"), and the Individual or Organization ("Licensee") accessing and
+otherwise using this software ("Python") in source or binary form and
+its associated documentation.
+
+2. Subject to the terms and conditions of this License Agreement, PSF
+hereby grants Licensee a nonexclusive, royalty-free, world-wide
+license to reproduce, analyze, test, perform and/or display publicly,
+prepare derivative works, distribute, and otherwise use Python
+alone or in any derivative version, provided, however, that PSF's
+License Agreement and PSF's notice of copyright, i.e., "Copyright (c)
+2001, 2002, 2003, 2004, 2005, 2006, 2007 Python Software Foundation;
+All Rights Reserved" are retained in Python alone or in any derivative
+version prepared by Licensee.
+
+3. In the event Licensee prepares a derivative work that is based on
+or incorporates Python or any part thereof, and wants to make
+the derivative work available to others as provided herein, then
+Licensee hereby agrees to include in any such work a brief summary of
+the changes made to Python.
+
+4. PSF is making Python available to Licensee on an "AS IS"
+basis.  PSF MAKES NO REPRESENTATIONS OR WARRANTIES, EXPRESS OR
+IMPLIED.  BY WAY OF EXAMPLE, BUT NOT LIMITATION, PSF MAKES NO AND
+DISCLAIMS ANY REPRESENTATION OR WARRANTY OF MERCHANTABILITY OR FITNESS
+FOR ANY PARTICULAR PURPOSE OR THAT THE USE OF PYTHON WILL NOT
+INFRINGE ANY THIRD PARTY RIGHTS.
+
+5. PSF SHALL NOT BE LIABLE TO LICENSEE OR ANY OTHER USERS OF PYTHON
+FOR ANY INCIDENTAL, SPECIAL, OR CONSEQUENTIAL DAMAGES OR LOSS AS
+A RESULT OF MODIFYING, DISTRIBUTING, OR OTHERWISE USING PYTHON,
+OR ANY DERIVATIVE THEREOF, EVEN IF ADVISED OF THE POSSIBILITY THEREOF.
+
+6. This License Agreement will automatically terminate upon a material
+breach of its terms and conditions.
+
+7. Nothing in this License Agreement shall be deemed to create any
+relationship of agency, partnership, or joint venture between PSF and
+Licensee.  This License Agreement does not grant permission to use PSF
+trademarks or trade name in a trademark sense to endorse or promote
+products or services of Licensee, or any third party.
+
+8. By copying, installing or otherwise using Python, Licensee
+agrees to be bound by the terms and conditions of this License
+Agreement.
+
+================================================================================
+*/
+
+#ifndef TINYPY_H
+#define TINYPY_H
+/* File: General
+ * Things defined in tp.h.
+ */
+#ifndef TP_H
+#define TP_H
+
+#include <setjmp.h>
+#include <sys/stat.h>
+#ifndef __USE_ISOC99
+#define __USE_ISOC99
+#endif
+#include <stdio.h>
+#include <stdlib.h>
+#include <string.h>
+#include <stdarg.h>
+#include <math.h>
+#include <time.h>
+
+#ifdef __GNUC__
+#define tp_inline __inline__
+#endif
+
+#ifdef _MSC_VER
+#ifdef NDEBUG
+#define tp_inline __inline
+#else
+/* don't inline in debug builds (for easier debugging) */
+#define tp_inline
+#endif
+#endif
+
+#ifndef tp_inline
+#error "Unsuported compiler"
+#endif
+
+/*  #define tp_malloc(x) calloc((x),1)
+    #define tp_realloc(x,y) realloc(x,y)
+    #define tp_free(x) free(x) */
+
+/* #include <gc/gc.h>
+   #define tp_malloc(x) GC_MALLOC(x)
+   #define tp_realloc(x,y) GC_REALLOC(x,y)
+   #define tp_free(x)*/
+
+enum {
+    TP_NONE,TP_NUMBER,TP_STRING,TP_DICT,
+    TP_LIST,TP_FNC,TP_DATA,
+};
+
+typedef double tp_num;
+
+typedef struct tp_number_ {
+    int type;
+    tp_num val;
+} tp_number_;
+typedef struct tp_string_ {
+    int type;
+    struct _tp_string *info;
+    char const *val;
+    int len;
+} tp_string_;
+typedef struct tp_list_ {
+    int type;
+    struct _tp_list *val;
+} tp_list_;
+typedef struct tp_dict_ {
+    int type;
+    struct _tp_dict *val;
+    int dtype;
+} tp_dict_;
+typedef struct tp_fnc_ {
+    int type;
+    struct _tp_fnc *info;
+    int ftype;
+    void *cfnc;
+} tp_fnc_;
+typedef struct tp_data_ {
+    int type;
+    struct _tp_data *info;
+    void *val;
+    int magic;
+} tp_data_;
+
+/* Type: tp_obj
+ * Tinypy's object representation.
+ *
+ * Every object in tinypy is of this type in the C API.
+ *
+ * Fields:
+ * type - This determines what kind of objects it is. It is either TP_NONE, in
+ *        which case this is the none type and no other fields can be accessed.
+ *        Or it has one of the values listed below, and the corresponding
+ *        fields can be accessed.
+ * number - TP_NUMBER
+ * number.val - A double value with the numeric value.
+ * string - TP_STRING
+ * string.val - A pointer to the string data.
+ * string.len - Length in bytes of the string data.
+ * dict - TP_DICT
+ * list - TP_LIST
+ * fnc - TP_FNC
+ * data - TP_DATA
+ * data.val - The user-provided data pointer.
+ * data.magic - The user-provided magic number for identifying the data type.
+ */
+typedef union tp_obj {
+    int type;
+    tp_number_ number;
+    struct { int type; int *data; } gci;
+    tp_string_ string;
+    tp_dict_ dict;
+    tp_list_ list;
+    tp_fnc_ fnc;
+    tp_data_ data;
+} tp_obj;
+
+typedef struct _tp_string {
+    int gci;
+    int len;
+    char s[1];
+} _tp_string;
+typedef struct _tp_list {
+    int gci;
+    tp_obj *items;
+    int len;
+    int alloc;
+} _tp_list;
+typedef struct tp_item {
+    int used;
+    int hash;
+    tp_obj key;
+    tp_obj val;
+} tp_item;
+typedef struct _tp_dict {
+    int gci;
+    tp_item *items;
+    int len;
+    int alloc;
+    int cur;
+    int mask;
+    int used;
+    tp_obj meta;
+} _tp_dict;
+typedef struct _tp_fnc {
+    int gci;
+    tp_obj self;
+    tp_obj globals;
+    tp_obj code;
+} _tp_fnc;
+
+
+typedef union tp_code {
+    unsigned char i;
+    struct { unsigned char i,a,b,c; } regs;
+    struct { char val[4]; } string;
+    struct { float val; } number;
+} tp_code;
+
+typedef struct tp_frame_ {
+/*    tp_code *codes; */
+    tp_obj code;
+    tp_code *cur;
+    tp_code *jmp;
+    tp_obj *regs;
+    tp_obj *ret_dest;
+    tp_obj fname;
+    tp_obj name;
+    tp_obj line;
+    tp_obj globals;
+    int lineno;
+    int cregs;
+} tp_frame_;
+
+#define TP_GCMAX 4096
+#define TP_FRAMES 256
+#define TP_REGS_EXTRA 2
+/* #define TP_REGS_PER_FRAME 256*/
+#define TP_REGS 16384
+
+/* Type: tp_vm
+ * Representation of a tinypy virtual machine instance.
+ *
+ * A new tp_vm struct is created with <tp_init>, and will be passed to most
+ * tinypy functions as first parameter. It contains all the data associated
+ * with an instance of a tinypy virtual machine - so it is easy to have
+ * multiple instances running at the same time. When you want to free up all
+ * memory used by an instance, call <tp_deinit>.
+ *
+ * Fields:
+ * These fields are currently documented:
+ *
+ * builtins - A dictionary containing all builtin objects.
+ * modules - A dictionary with all loaded modules.
+ * params - A list of parameters for the current function call.
+ * frames - A list of all call frames.
+ * cur - The index of the currently executing call frame.
+ * frames[n].globals - A dictionary of global sybmols in callframe n.
+ */
+typedef struct tp_vm {
+    tp_obj builtins;
+    tp_obj modules;
+    tp_frame_ frames[TP_FRAMES];
+    tp_obj _params;
+    tp_obj params;
+    tp_obj _regs;
+    tp_obj *regs;
+    tp_obj root;
+    jmp_buf buf;
+#ifdef CPYTHON_MOD
+    jmp_buf nextexpr;
+#endif
+    int jmp;
+    tp_obj ex;
+    char chars[256][2];
+    int cur;
+    /* gc */
+    _tp_list *white;
+    _tp_list *grey;
+    _tp_list *black;
+    int steps;
+    /* sandbox */
+    clock_t clocks;
+    double time_elapsed;
+    double time_limit;
+    unsigned long mem_limit;
+    unsigned long mem_used;
+    int mem_exceeded;
+} tp_vm;
+
+#define TP tp_vm *tp
+typedef struct _tp_data {
+    int gci;
+    void (*free)(TP,tp_obj);
+} _tp_data;
+
+#define tp_True tp_number(1)
+#define tp_False tp_number(0)
+
+extern tp_obj tp_None;
+
+#ifdef TP_SANDBOX
+void *tp_malloc(TP, unsigned long);
+void *tp_realloc(TP, void *, unsigned long);
+void tp_free(TP, void *);
+#else
+#define tp_malloc(TP,x) calloc((x),1)
+#define tp_realloc(TP,x,y) realloc(x,y)
+#define tp_free(TP,x) free(x)
+#endif
+
+void tp_sandbox(TP, double, unsigned long);
+void tp_time_update(TP);
+void tp_mem_update(TP);
+
+void tp_run(TP,int cur);
+void tp_set(TP,tp_obj,tp_obj,tp_obj);
+tp_obj tp_get(TP,tp_obj,tp_obj);
+tp_obj tp_has(TP,tp_obj self, tp_obj k);
+tp_obj tp_len(TP,tp_obj);
+void tp_del(TP,tp_obj,tp_obj);
+tp_obj tp_str(TP,tp_obj);
+int tp_bool(TP,tp_obj);
+int tp_cmp(TP,tp_obj,tp_obj);
+void _tp_raise(TP,tp_obj);
+tp_obj tp_printf(TP,char const *fmt,...);
+tp_obj tp_track(TP,tp_obj);
+void tp_grey(TP,tp_obj);
+tp_obj tp_call(TP, tp_obj fnc, tp_obj params);
+tp_obj tp_add(TP,tp_obj a, tp_obj b) ;
+
+/* __func__ __VA_ARGS__ __FILE__ __LINE__ */
+
+/* Function: tp_raise
+ * Macro to raise an exception.
+ *
+ * This macro will return from the current function returning "r". The
+ * remaining parameters are used to format the exception message.
+ */
+/*
+#define tp_raise(r,fmt,...) { \
+    _tp_raise(tp,tp_printf(tp,fmt,__VA_ARGS__)); \
+    return r; \
+}
+*/
+#define tp_raise(r,v) { \
+    _tp_raise(tp,v); \
+    return r; \
+}
+
+/* Function: tp_string
+ * Creates a new string object from a C string.
+ *
+ * Given a pointer to a C string, creates a tinypy object representing the
+ * same string.
+ *
+ * *Note* Only a reference to the string will be kept by tinypy, so make sure
+ * it does not go out of scope, and don't de-allocate it. Also be aware that
+ * tinypy will not delete the string for you. In many cases, it is best to
+ * use <tp_string_t> or <tp_string_slice> to create a string where tinypy
+ * manages storage for you.
+ */
+tp_inline static tp_obj tp_string(char const *v) {
+    tp_obj val;
+    tp_string_ s = {TP_STRING, 0, v, 0};
+    s.len = strlen(v);
+    val.string = s;
+    return val;
+}
+
+#define TP_CSTR_LEN 256
+
+tp_inline static void tp_cstr(TP,tp_obj v, char *s, int l) {
+    if (v.type != TP_STRING) {
+        tp_raise(,tp_string("(tp_cstr) TypeError: value not a string"));
+    }
+    if (v.string.len >= l) {
+        tp_raise(,tp_string("(tp_cstr) TypeError: value too long"));
+    }
+    memset(s,0,l);
+    memcpy(s,v.string.val,v.string.len);
+}
+
+
+#define TP_OBJ() (tp_get(tp,tp->params,tp_None))
+tp_inline static tp_obj tp_type(TP,int t,tp_obj v) {
+    if (v.type != t) { tp_raise(tp_None,tp_string("(tp_type) TypeError: unexpected type")); }
+    return v;
+}
+
+
+
+#define TP_NO_LIMIT 0
+#define TP_TYPE(t) tp_type(tp,t,TP_OBJ())
+#define TP_NUM() (TP_TYPE(TP_NUMBER).number.val)
+/* #define TP_STR() (TP_CSTR(TP_TYPE(TP_STRING))) */
+#define TP_STR() (TP_TYPE(TP_STRING))
+#define TP_DEFAULT(d) (tp->params.list.val->len?tp_get(tp,tp->params,tp_None):(d))
+
+/* Macro: TP_LOOP
+ * Macro to iterate over all remaining arguments.
+ *
+ * If you have a function which takes a variable number of arguments, you can
+ * iterate through all remaining arguments for example like this:
+ *
+ * > tp_obj *my_func(tp_vm *tp)
+ * > {
+ * >     // We retrieve the first argument like normal.
+ * >     tp_obj first = TP_OBJ();
+ * >     // Then we iterate over the remaining arguments.
+ * >     tp_obj arg;
+ * >     TP_LOOP(arg)
+ * >         // do something with arg
+ * >     TP_END
+ * > }
+ */
+#define TP_LOOP(e) \
+    int __l = tp->params.list.val->len; \
+    int __i; for (__i=0; __i<__l; __i++) { \
+    (e) = _tp_list_get(tp,tp->params.list.val,__i,"TP_LOOP");
+#define TP_END \
+    }
+
+tp_inline static int _tp_min(int a, int b) { return (a<b?a:b); }
+tp_inline static int _tp_max(int a, int b) { return (a>b?a:b); }
+tp_inline static int _tp_sign(tp_num v) { return (v<0?-1:(v>0?1:0)); }
+
+/* Function: tp_number
+ * Creates a new numeric object.
+ */
+tp_inline static tp_obj tp_number(tp_num v) {
+    tp_obj val = {TP_NUMBER};
+    val.number.val = v;
+    return val;
+}
+
+tp_inline static void tp_echo(TP,tp_obj e) {
+    e = tp_str(tp,e);
+    fwrite(e.string.val,1,e.string.len,stdout);
+}
+
+/* Function: tp_string_n
+ * Creates a new string object from a partial C string.
+ *
+ * Like <tp_string>, but you specify how many bytes of the given C string to
+ * use for the string object. The *note* also applies for this function, as the
+ * string reference and length are kept, but no actual substring is stored.
+ */
+tp_inline static tp_obj tp_string_n(char const *v,int n) {
+    tp_obj val;
+    tp_string_ s = {TP_STRING, 0,v,n};
+    val.string = s;
+    return val;
+}
+
+#endif
+void _tp_list_realloc(TP, _tp_list *self,int len) ;
+void _tp_list_set(TP,_tp_list *self,int k, tp_obj v, const char *error) ;
+void _tp_list_free(TP, _tp_list *self) ;
+tp_obj _tp_list_get(TP,_tp_list *self,int k,const char *error) ;
+void _tp_list_insertx(TP,_tp_list *self, int n, tp_obj v) ;
+void _tp_list_appendx(TP,_tp_list *self, tp_obj v) ;
+void _tp_list_insert(TP,_tp_list *self, int n, tp_obj v) ;
+void _tp_list_append(TP,_tp_list *self, tp_obj v) ;
+tp_obj _tp_list_pop(TP,_tp_list *self, int n, const char *error) ;
+int _tp_list_find(TP,_tp_list *self, tp_obj v) ;
+tp_obj tp_index(TP) ;
+_tp_list *_tp_list_new(TP) ;
+tp_obj _tp_list_copy(TP, tp_obj rr) ;
+tp_obj tp_append(TP) ;
+tp_obj tp_pop(TP) ;
+tp_obj tp_insert(TP) ;
+tp_obj tp_extend(TP) ;
+tp_obj tp_list_nt(TP) ;
+tp_obj tp_list(TP) ;
+tp_obj tp_list_n(TP,int n,tp_obj *argv) ;
+int _tp_sort_cmp(tp_obj *a,tp_obj *b) ;
+tp_obj tp_sort(TP) ;
+int tp_lua_hash(void const *v,int l) ;
+void _tp_dict_free(TP, _tp_dict *self) ;
+int tp_hash(TP,tp_obj v) ;
+void _tp_dict_hash_set(TP,_tp_dict *self, int hash, tp_obj k, tp_obj v) ;
+void _tp_dict_tp_realloc(TP,_tp_dict *self,int len) ;
+int _tp_dict_hash_find(TP,_tp_dict *self, int hash, tp_obj k) ;
+int _tp_dict_find(TP,_tp_dict *self,tp_obj k) ;
+void _tp_dict_setx(TP,_tp_dict *self,tp_obj k, tp_obj v) ;
+void _tp_dict_set(TP,_tp_dict *self,tp_obj k, tp_obj v) ;
+tp_obj _tp_dict_get(TP,_tp_dict *self,tp_obj k, const char *error) ;
+void _tp_dict_del(TP,_tp_dict *self,tp_obj k, const char *error) ;
+_tp_dict *_tp_dict_new(TP) ;
+tp_obj _tp_dict_copy(TP,tp_obj rr) ;
+int _tp_dict_next(TP,_tp_dict *self) ;
+tp_obj tp_merge(TP) ;
+tp_obj tp_dict(TP) ;
+tp_obj tp_dict_n(TP,int n, tp_obj* argv) ;
+tp_obj _tp_dcall(TP,tp_obj fnc(TP)) ;
+tp_obj _tp_tcall(TP,tp_obj fnc) ;
+tp_obj tp_fnc_new(TP,int t, void *v, tp_obj c,tp_obj s, tp_obj g) ;
+tp_obj tp_def(TP,tp_obj code, tp_obj g) ;
+tp_obj tp_fnc(TP,tp_obj v(TP)) ;
+tp_obj tp_method(TP,tp_obj self,tp_obj v(TP)) ;
+tp_obj tp_data(TP,int magic,void *v) ;
+tp_obj tp_params(TP) ;
+tp_obj tp_params_n(TP,int n, tp_obj argv[]) ;
+tp_obj tp_params_v(TP,int n,...) ;
+tp_obj tp_string_t(TP, int n) ;
+tp_obj tp_string_copy(TP, const char *s, int n) ;
+tp_obj tp_string_sub(TP, tp_obj s, int a, int b) ;
+int _tp_str_index(tp_obj s, tp_obj k) ;
+tp_obj tp_join(TP) ;
+tp_obj tp_split(TP) ;
+tp_obj tp_find(TP) ;
+tp_obj tp_str_index(TP) ;
+tp_obj tp_str2(TP) ;
+tp_obj tp_chr(TP) ;
+tp_obj tp_ord(TP) ;
+tp_obj tp_strip(TP) ;
+tp_obj tp_replace(TP) ;
+tp_obj tp_print(TP) ;
+tp_obj tp_bind(TP) ;
+tp_obj tp_min(TP) ;
+tp_obj tp_max(TP) ;
+tp_obj tp_copy(TP) ;
+tp_obj tp_len_(TP) ;
+tp_obj tp_assert(TP) ;
+tp_obj tp_range(TP) ;
+tp_obj tp_system(TP) ;
+tp_obj tp_istype(TP) ;
+tp_obj tp_float(TP) ;
+tp_obj tp_save(TP) ;
+tp_obj tp_load(TP) ;
+tp_obj tp_fpack(TP) ;
+tp_obj tp_abs(TP) ;
+tp_obj tp_int(TP) ;
+tp_num _roundf(tp_num v) ;
+tp_obj tp_round(TP) ;
+tp_obj tp_exists(TP) ;
+tp_obj tp_mtime(TP) ;
+int _tp_lookup_(TP,tp_obj self, tp_obj k, tp_obj *meta, int depth) ;
+int _tp_lookup(TP,tp_obj self, tp_obj k, tp_obj *meta) ;
+tp_obj tp_setmeta(TP) ;
+tp_obj tp_getmeta(TP) ;
+tp_obj tp_object(TP) ;
+tp_obj tp_object_new(TP) ;
+tp_obj tp_object_call(TP) ;
+tp_obj tp_getraw(TP) ;
+tp_obj tp_class(TP) ;
+tp_obj tp_builtins_bool(TP) ;
+void tp_follow(TP,tp_obj v) ;
+void tp_reset(TP) ;
+void tp_gc_init(TP) ;
+void tp_gc_deinit(TP) ;
+void tp_delete(TP,tp_obj v) ;
+void tp_collect(TP) ;
+void _tp_gcinc(TP) ;
+void tp_full(TP) ;
+void tp_gcinc(TP) ;
+tp_obj tp_iter(TP,tp_obj self, tp_obj k) ;
+int tp_iget(TP,tp_obj *r, tp_obj self, tp_obj k) ;
+tp_obj tp_mul(TP,tp_obj a, tp_obj b) ;
+tp_obj tp_bitwise_not(TP, tp_obj a) ;
+tp_vm *_tp_init(void) ;
+void tp_deinit(TP) ;
+void tp_frame(TP,tp_obj globals,tp_obj code,tp_obj *ret_dest) ;
+void tp_print_stack(TP) ;
+void tp_handle(TP) ;
+void tp_return(TP, tp_obj v) ;
+int tp_step(TP) ;
+void _tp_run(TP,int cur) ;
+tp_obj tp_ez_call(TP, const char *mod, const char *fnc, tp_obj params) ;
+tp_obj _tp_import(TP, tp_obj fname, tp_obj name, tp_obj code) ;
+tp_obj tp_import(TP, const char * fname, const char * name, void *codes, int len) ;
+tp_obj tp_exec_(TP) ;
+tp_obj tp_import_(TP) ;
+void tp_builtins(TP) ;
+void tp_args(TP,int argc, char *argv[]) ;
+tp_obj tp_main(TP,char *fname, void *code, int len) ;
+tp_obj tp_compile(TP, tp_obj text, tp_obj fname) ;
+tp_obj tp_exec(TP, tp_obj code, tp_obj globals) ;
+tp_obj tp_eval(TP, const char *text, tp_obj globals) ;
+tp_vm *tp_init(int argc, char *argv[]) ;
+void tp_compiler(TP) ;
+tp_obj tp_sandbox_(TP) ;
+void tp_bounds(TP, tp_code *cur, int n) ;
+#endif
+
+void _tp_list_realloc(TP, _tp_list *self,int len) {
+    if (!len) { len=1; }
+    self->items = (tp_obj*)tp_realloc(tp, self->items,len*sizeof(tp_obj));
+    self->alloc = len;
+}
+
+void _tp_list_set(TP,_tp_list *self,int k, tp_obj v, const char *error) {
+    if (k >= self->len) {
+        tp_raise(,tp_string("(_tp_list_set) KeyError"));
+    }
+    self->items[k] = v;
+    tp_grey(tp,v);
+}
+void _tp_list_free(TP, _tp_list *self) {
+    tp_free(tp, self->items);
+    tp_free(tp, self);
+}
+
+tp_obj _tp_list_get(TP,_tp_list *self,int k,const char *error) {
+    if (k >= self->len) {
+        tp_raise(tp_None,tp_string("(_tp_list_set) KeyError"));
+    }
+    return self->items[k];
+}
+void _tp_list_insertx(TP,_tp_list *self, int n, tp_obj v) {
+    if (self->len >= self->alloc) {
+        _tp_list_realloc(tp, self,self->alloc*2);
+    }
+    if (n < self->len) { memmove(&self->items[n+1],&self->items[n],sizeof(tp_obj)*(self->len-n)); }
+    self->items[n] = v;
+    self->len += 1;
+}
+void _tp_list_appendx(TP,_tp_list *self, tp_obj v) {
+    _tp_list_insertx(tp,self,self->len,v);
+}
+void _tp_list_insert(TP,_tp_list *self, int n, tp_obj v) {
+    _tp_list_insertx(tp,self,n,v);
+    tp_grey(tp,v);
+}
+void _tp_list_append(TP,_tp_list *self, tp_obj v) {
+    _tp_list_insert(tp,self,self->len,v);
+}
+tp_obj _tp_list_pop(TP,_tp_list *self, int n, const char *error) {
+    tp_obj r = _tp_list_get(tp,self,n,error);
+    if (n != self->len-1) { memmove(&self->items[n],&self->items[n+1],sizeof(tp_obj)*(self->len-(n+1))); }
+    self->len -= 1;
+    return r;
+}
+
+int _tp_list_find(TP,_tp_list *self, tp_obj v) {
+    int n;
+    for (n=0; n<self->len; n++) {
+        if (tp_cmp(tp,v,self->items[n]) == 0) {
+            return n;
+        }
+    }
+    return -1;
+}
+
+tp_obj tp_index(TP) {
+    tp_obj self = TP_OBJ();
+    tp_obj v = TP_OBJ();
+    int i = _tp_list_find(tp,self.list.val,v);
+    if (i < 0) {
+        tp_raise(tp_None,tp_string("(tp_index) ValueError: list.index(x): x not in list"));
+    }
+    return tp_number(i);
+}
+
+_tp_list *_tp_list_new(TP) {
+    return (_tp_list*)tp_malloc(tp, sizeof(_tp_list));
+}
+
+tp_obj _tp_list_copy(TP, tp_obj rr) {
+    tp_obj val = {TP_LIST};
+    _tp_list *o = rr.list.val;
+    _tp_list *r = _tp_list_new(tp);
+    *r = *o; r->gci = 0;
+    r->items = (tp_obj*)tp_malloc(tp, sizeof(tp_obj)*o->len);
+    memcpy(r->items,o->items,sizeof(tp_obj)*o->len);
+    val.list.val = r;
+    return tp_track(tp,val);
+}
+
+tp_obj tp_append(TP) {
+    tp_obj self = TP_OBJ();
+    tp_obj v = TP_OBJ();
+    _tp_list_append(tp,self.list.val,v);
+    return tp_None;
+}
+
+tp_obj tp_pop(TP) {
+    tp_obj self = TP_OBJ();
+    return _tp_list_pop(tp,self.list.val,self.list.val->len-1,"pop");
+}
+
+tp_obj tp_insert(TP) {
+    tp_obj self = TP_OBJ();
+    int n = TP_NUM();
+    tp_obj v = TP_OBJ();
+    _tp_list_insert(tp,self.list.val,n,v);
+    return tp_None;
+}
+
+tp_obj tp_extend(TP) {
+    tp_obj self = TP_OBJ();
+    tp_obj v = TP_OBJ();
+    int i;
+    for (i=0; i<v.list.val->len; i++) {
+        _tp_list_append(tp,self.list.val,v.list.val->items[i]);
+    }
+    return tp_None;
+}
+
+tp_obj tp_list_nt(TP) {
+    tp_obj r = {TP_LIST};
+    r.list.val = _tp_list_new(tp);
+    return r;
+}
+
+tp_obj tp_list(TP) {
+    tp_obj r = {TP_LIST};
+    r.list.val = _tp_list_new(tp);
+    return tp_track(tp,r);
+}
+
+tp_obj tp_list_n(TP,int n,tp_obj *argv) {
+    int i;
+    tp_obj r = tp_list(tp); _tp_list_realloc(tp, r.list.val,n);
+    for (i=0; i<n; i++) {
+        _tp_list_append(tp,r.list.val,argv[i]);
+    }
+    return r;
+}
+
+int _tp_sort_cmp(tp_obj *a,tp_obj *b) {
+    return tp_cmp(0,*a,*b);
+}
+
+tp_obj tp_sort(TP) {
+    tp_obj self = TP_OBJ();
+    qsort(self.list.val->items, self.list.val->len, sizeof(tp_obj), (int(*)(const void*,const void*))_tp_sort_cmp);
+    return tp_None;
+}
+
+/* File: Dict
+ * Functions for dealing with dictionaries.
+ */
+int tp_lua_hash(void const *v,int l) {
+    int i,step = (l>>5)+1;
+    int h = l + (l >= 4?*(int*)v:0);
+    for (i=l; i>=step; i-=step) {
+        h = h^((h<<5)+(h>>2)+((unsigned char *)v)[i-1]);
+    }
+    return h;
+}
+void _tp_dict_free(TP, _tp_dict *self) {
+    tp_free(tp, self->items);
+    tp_free(tp, self);
+}
+
+/* void _tp_dict_reset(_tp_dict *self) {
+       memset(self->items,0,self->alloc*sizeof(tp_item));
+       self->len = 0;
+       self->used = 0;
+       self->cur = 0;
+   }*/
+
+int tp_hash(TP,tp_obj v) {
+    switch (v.type) {
+        case TP_NONE: return 0;
+        case TP_NUMBER: return tp_lua_hash(&v.number.val,sizeof(tp_num));
+        case TP_STRING: return tp_lua_hash(v.string.val,v.string.len);
+        case TP_DICT: return tp_lua_hash(&v.dict.val,sizeof(void*));
+        case TP_LIST: {
+            int r = v.list.val->len; int n; for(n=0; n<v.list.val->len; n++) {
+            tp_obj vv = v.list.val->items[n]; r += vv.type != TP_LIST?tp_hash(tp,v.list.val->items[n]):tp_lua_hash(&vv.list.val,sizeof(void*)); } return r;
+        }
+        case TP_FNC: return tp_lua_hash(&v.fnc.info,sizeof(void*));
+        case TP_DATA: return tp_lua_hash(&v.data.val,sizeof(void*));
+    }
+    tp_raise(0,tp_string("(tp_hash) TypeError: value unhashable"));
+}
+
+void _tp_dict_hash_set(TP,_tp_dict *self, int hash, tp_obj k, tp_obj v) {
+    tp_item item;
+    int i,idx = hash&self->mask;
+    for (i=idx; i<idx+self->alloc; i++) {
+        int n = i&self->mask;
+        if (self->items[n].used > 0) { continue; }
+        if (self->items[n].used == 0) { self->used += 1; }
+        item.used = 1;
+        item.hash = hash;
+        item.key = k;
+        item.val = v;
+        self->items[n] = item;
+        self->len += 1;
+        return;
+    }
+    tp_raise(,tp_string("(_tp_dict_hash_set) RuntimeError: ?"));
+}
+
+void _tp_dict_tp_realloc(TP,_tp_dict *self,int len) {
+    tp_item *items = self->items;
+    int i,alloc = self->alloc;
+    len = _tp_max(8,len);
+
+    self->items = (tp_item*)tp_malloc(tp, len*sizeof(tp_item));
+    self->alloc = len; self->mask = len-1;
+    self->len = 0; self->used = 0;
+
+    for (i=0; i<alloc; i++) {
+        if (items[i].used != 1) { continue; }
+        _tp_dict_hash_set(tp,self,items[i].hash,items[i].key,items[i].val);
+    }
+    tp_free(tp, items);
+}
+
+int _tp_dict_hash_find(TP,_tp_dict *self, int hash, tp_obj k) {
+    int i,idx = hash&self->mask;
+    for (i=idx; i<idx+self->alloc; i++) {
+        int n = i&self->mask;
+        if (self->items[n].used == 0) { break; }
+        if (self->items[n].used < 0) { continue; }
+        if (self->items[n].hash != hash) { continue; }
+        if (tp_cmp(tp,self->items[n].key,k) != 0) { continue; }
+        return n;
+    }
+    return -1;
+}
+int _tp_dict_find(TP,_tp_dict *self,tp_obj k) {
+    return _tp_dict_hash_find(tp,self,tp_hash(tp,k),k);
+}
+
+void _tp_dict_setx(TP,_tp_dict *self,tp_obj k, tp_obj v) {
+    int hash = tp_hash(tp,k); int n = _tp_dict_hash_find(tp,self,hash,k);
+    if (n == -1) {
+        if (self->len >= (self->alloc/2)) {
+            _tp_dict_tp_realloc(tp,self,self->alloc*2);
+        } else if (self->used >= (self->alloc*3/4)) {
+            _tp_dict_tp_realloc(tp,self,self->alloc);
+        }
+        _tp_dict_hash_set(tp,self,hash,k,v);
+    } else {
+        self->items[n].val = v;
+    }
+}
+
+void _tp_dict_set(TP,_tp_dict *self,tp_obj k, tp_obj v) {
+    _tp_dict_setx(tp,self,k,v);
+    tp_grey(tp,k); tp_grey(tp,v);
+}
+
+tp_obj _tp_dict_get(TP,_tp_dict *self,tp_obj k, const char *error) {
+    int n = _tp_dict_find(tp,self,k);
+    if (n < 0) {
+        tp_raise(tp_None,tp_add(tp,tp_string("(_tp_dict_get) KeyError: "),tp_str(tp,k)));
+    }
+    return self->items[n].val;
+}
+
+void _tp_dict_del(TP,_tp_dict *self,tp_obj k, const char *error) {
+    int n = _tp_dict_find(tp,self,k);
+    if (n < 0) {
+        tp_raise(,tp_add(tp,tp_string("(_tp_dict_del) KeyError: "),tp_str(tp,k)));
+    }
+    self->items[n].used = -1;
+    self->len -= 1;
+}
+
+_tp_dict *_tp_dict_new(TP) {
+    _tp_dict *self = (_tp_dict*)tp_malloc(tp, sizeof(_tp_dict));
+    return self;
+}
+tp_obj _tp_dict_copy(TP,tp_obj rr) {
+    tp_obj obj = {TP_DICT};
+    _tp_dict *o = rr.dict.val;
+    _tp_dict *r = _tp_dict_new(tp);
+    *r = *o; r->gci = 0;
+    r->items = (tp_item*)tp_malloc(tp, sizeof(tp_item)*o->alloc);
+    memcpy(r->items,o->items,sizeof(tp_item)*o->alloc);
+    obj.dict.val = r;
+    obj.dict.dtype = 1;
+    return tp_track(tp,obj);
+}
+
+int _tp_dict_next(TP,_tp_dict *self) {
+    if (!self->len) {
+        tp_raise(0,tp_string("(_tp_dict_next) RuntimeError"));
+    }
+    while (1) {
+        self->cur = ((self->cur + 1) & self->mask);
+        if (self->items[self->cur].used > 0) {
+            return self->cur;
+        }
+    }
+}
+
+tp_obj tp_merge(TP) {
+    tp_obj self = TP_OBJ();
+    tp_obj v = TP_OBJ();
+    int i; for (i=0; i<v.dict.val->len; i++) {
+        int n = _tp_dict_next(tp,v.dict.val);
+        _tp_dict_set(tp,self.dict.val,
+            v.dict.val->items[n].key,v.dict.val->items[n].val);
+    }
+    return tp_None;
+}
+
+/* Function: tp_dict
+ *
+ * Creates a new dictionary object.
+ *
+ * *Note* If you use <tp_setmeta> on the dictionary, you have to use <tp_getraw> to
+ * access the "raw" dictionary again.
+ *
+ * Returns:
+ * The newly created dictionary.
+ */
+tp_obj tp_dict(TP) {
+    tp_obj r = {TP_DICT};
+    r.dict.val = _tp_dict_new(tp);
+    r.dict.dtype = 1;
+    return tp ? tp_track(tp,r) : r;
+}
+
+tp_obj tp_dict_n(TP,int n, tp_obj* argv) {
+    tp_obj r = tp_dict(tp);
+    int i; for (i=0; i<n; i++) { tp_set(tp,r,argv[i*2],argv[i*2+1]); }
+    return r;
+}
+
+
+/* File: Miscellaneous
+ * Various functions to help interface tinypy.
+ */
+
+tp_obj _tp_dcall(TP,tp_obj fnc(TP)) {
+    return fnc(tp);
+}
+tp_obj _tp_tcall(TP,tp_obj fnc) {
+    if (fnc.fnc.ftype&2) {
+        _tp_list_insert(tp,tp->params.list.val,0,fnc.fnc.info->self);
+    }
+    return _tp_dcall(tp,(tp_obj (*)(tp_vm *))fnc.fnc.cfnc);
+}
+
+tp_obj tp_fnc_new(TP,int t, void *v, tp_obj c,tp_obj s, tp_obj g) {
+    tp_obj r = {TP_FNC};
+    _tp_fnc *info = (_tp_fnc*)tp_malloc(tp, sizeof(_tp_fnc));
+    info->code = c;
+    info->self = s;
+    info->globals = g;
+    r.fnc.ftype = t;
+    r.fnc.info = info;
+    r.fnc.cfnc = v;
+    return tp_track(tp,r);
+}
+
+tp_obj tp_def(TP,tp_obj code, tp_obj g) {
+    tp_obj r = tp_fnc_new(tp,1,0,code,tp_None,g);
+    return r;
+}
+
+/* Function: tp_fnc
+ * Creates a new tinypy function object.
+ *
+ * This is how you can create a tinypy function object which, when called in
+ * the script, calls the provided C function.
+ */
+tp_obj tp_fnc(TP,tp_obj v(TP)) {
+    return tp_fnc_new(tp,0,v,tp_None,tp_None,tp_None);
+}
+
+tp_obj tp_method(TP,tp_obj self,tp_obj v(TP)) {
+    return tp_fnc_new(tp,2,v,tp_None,self,tp_None);
+}
+
+/* Function: tp_data
+ * Creates a new data object.
+ *
+ * Parameters:
+ * magic - An integer number associated with the data type. This can be used
+ *         to check the type of data objects.
+ * v     - A pointer to user data. Only the pointer is stored in the object,
+ *         you keep all responsibility for the data it points to.
+ *
+ *
+ * Returns:
+ * The new data object.
+ *
+ * Public fields:
+ * The following fields can be access in a data object:
+ *
+ * magic      - An integer number stored in the object.
+ * val        - The data pointer of the object.
+ * info->free - If not NULL, a callback function called when the object gets
+ *              destroyed.
+ *
+ * Example:
+ * > void *__free__(TP, tp_obj self)
+ * > {
+ * >     free(self.data.val);
+ * > }
+ * >
+ * > tp_obj my_obj = tp_data(TP, 0, my_ptr);
+ * > my_obj.data.info->free = __free__;
+ */
+tp_obj tp_data(TP,int magic,void *v) {
+    tp_obj r = {TP_DATA};
+    r.data.info = (_tp_data*)tp_malloc(tp, sizeof(_tp_data));
+    r.data.val = v;
+    r.data.magic = magic;
+    return tp_track(tp,r);
+}
+
+/* Function: tp_params
+ * Initialize the tinypy parameters.
+ *
+ * When you are calling a tinypy function, you can use this to initialize the
+ * list of parameters getting passed to it. Usually, you may want to use
+ * <tp_params_n> or <tp_params_v>.
+ */
+tp_obj tp_params(TP) {
+    tp_obj r;
+    tp->params = tp->_params.list.val->items[tp->cur];
+    r = tp->_params.list.val->items[tp->cur];
+    r.list.val->len = 0;
+    return r;
+}
+
+/* Function: tp_params_n
+ * Specify a list of objects as function call parameters.
+ *
+ * See also: <tp_params>, <tp_params_v>
+ *
+ * Parameters:
+ * n - The number of parameters.
+ * argv - A list of n tinypy objects, which will be passed as parameters.
+ *
+ * Returns:
+ * The parameters list. You may modify it before performing the function call.
+ */
+tp_obj tp_params_n(TP,int n, tp_obj argv[]) {
+    tp_obj r = tp_params(tp);
+    int i; for (i=0; i<n; i++) { _tp_list_append(tp,r.list.val,argv[i]); }
+    return r;
+}
+
+/* Function: tp_params_v
+ * Pass parameters for a tinypy function call.
+ *
+ * When you want to call a tinypy method, then you use this to pass parameters
+ * to it.
+ *
+ * Parameters:
+ * n   - The number of variable arguments following.
+ * ... - Pass n tinypy objects, which a subsequently called tinypy method will
+ *       receive as parameters.
+ *
+ * Returns:
+ * A tinypy list object representing the current call parameters. You can modify
+ * the list before doing the function call.
+ */
+tp_obj tp_params_v(TP,int n,...) {
+    int i;
+    tp_obj r = tp_params(tp);
+    va_list a; va_start(a,n);
+    for (i=0; i<n; i++) {
+        _tp_list_append(tp,r.list.val,va_arg(a,tp_obj));
+    }
+    va_end(a);
+    return r;
+}
+/* File: String
+ * String handling functions.
+ */
+
+/*
+ * Create a new empty string of a certain size.
+ * Does not put it in for GC tracking, since contents should be
+ * filled after returning.
+ */
+tp_obj tp_string_t(TP, int n) {
+    tp_obj r = tp_string_n(0,n);
+    r.string.info = (_tp_string*)tp_malloc(tp, sizeof(_tp_string)+n);
+    r.string.info->len = n;
+    r.string.val = r.string.info->s;
+    return r;
+}
+
+/*
+ * Create a new string which is a copy of some memory.
+ * This is put into GC tracking for you.
+ */
+tp_obj tp_string_copy(TP, const char *s, int n) {
+    tp_obj r = tp_string_t(tp,n);
+    memcpy(r.string.info->s,s,n);
+    return tp_track(tp,r);
+}
+
+/*
+ * Create a new string which is a substring slice of another STRING.
+ * Does not need to be put into GC tracking, as its parent is
+ * already being tracked (supposedly).
+ */
+tp_obj tp_string_sub(TP, tp_obj s, int a, int b) {
+    int l = s.string.len;
+    a = _tp_max(0,(a<0?l+a:a)); b = _tp_min(l,(b<0?l+b:b));
+    tp_obj r = s;
+    r.string.val += a;
+    r.string.len = b-a;
+    return r;
+}
+
+tp_obj tp_printf(TP, char const *fmt,...) {
+    int l;
+    tp_obj r;
+    char *s;
+    va_list arg;
+    va_start(arg, fmt);
+    l = vsnprintf(NULL, 0, fmt,arg);
+    r = tp_string_t(tp,l);
+    s = r.string.info->s;
+    va_end(arg);
+    va_start(arg, fmt);
+    vsprintf(s,fmt,arg);
+    va_end(arg);
+    return tp_track(tp,r);
+}
+
+int _tp_str_index(tp_obj s, tp_obj k) {
+    int i=0;
+    while ((s.string.len - i) >= k.string.len) {
+        if (memcmp(s.string.val+i,k.string.val,k.string.len) == 0) {
+            return i;
+        }
+        i += 1;
+    }
+    return -1;
+}
+
+tp_obj tp_join(TP) {
+    tp_obj delim = TP_OBJ();
+    tp_obj val = TP_OBJ();
+    int l=0,i;
+    tp_obj r;
+    char *s;
+    for (i=0; i<val.list.val->len; i++) {
+        if (i!=0) { l += delim.string.len; }
+        l += tp_str(tp,val.list.val->items[i]).string.len;
+    }
+    r = tp_string_t(tp,l);
+    s = r.string.info->s;
+    l = 0;
+    for (i=0; i<val.list.val->len; i++) {
+        tp_obj e;
+        if (i!=0) {
+            memcpy(s+l,delim.string.val,delim.string.len); l += delim.string.len;
+        }
+        e = tp_str(tp,val.list.val->items[i]);
+        memcpy(s+l,e.string.val,e.string.len); l += e.string.len;
+    }
+    return tp_track(tp,r);
+}
+
+tp_obj tp_split(TP) {
+    tp_obj v = TP_OBJ();
+    tp_obj d = TP_OBJ();
+    tp_obj r = tp_list(tp);
+
+    int i;
+    while ((i=_tp_str_index(v,d))!=-1) {
+        _tp_list_append(tp,r.list.val,tp_string_sub(tp,v,0,i));
+        v.string.val += i + d.string.len; v.string.len -= i + d.string.len;
+    }
+    _tp_list_append(tp,r.list.val,tp_string_sub(tp,v,0,v.string.len));
+    return r;
+}
+
+
+tp_obj tp_find(TP) {
+    tp_obj s = TP_OBJ();
+    tp_obj v = TP_OBJ();
+    return tp_number(_tp_str_index(s,v));
+}
+
+tp_obj tp_str_index(TP) {
+    tp_obj s = TP_OBJ();
+    tp_obj v = TP_OBJ();
+    int n = _tp_str_index(s,v);
+    if (n >= 0) { return tp_number(n); }
+    tp_raise(tp_None,tp_string("(tp_str_index) ValueError: substring not found"));
+}
+
+tp_obj tp_str2(TP) {
+    tp_obj v = TP_OBJ();
+    return tp_str(tp,v);
+}
+
+tp_obj tp_chr(TP) {
+    int v = TP_NUM();
+    return tp_string_n(tp->chars[(unsigned char)v],1);
+}
+tp_obj tp_ord(TP) {
+    tp_obj s = TP_STR();
+    if (s.string.len != 1) {
+        tp_raise(tp_None,tp_string("(tp_ord) TypeError: ord() expected a character"));
+    }
+    return tp_number((unsigned char)s.string.val[0]);
+}
+
+tp_obj tp_strip(TP) {
+    tp_obj o = TP_TYPE(TP_STRING);
+    char const *v = o.string.val; int l = o.string.len;
+    int i; int a = l, b = 0;
+    tp_obj r;
+    char *s;
+    for (i=0; i<l; i++) {
+        if (v[i] != ' ' && v[i] != '\n' && v[i] != '\t' && v[i] != '\r') {
+            a = _tp_min(a,i); b = _tp_max(b,i+1);
+        }
+    }
+    if ((b-a) < 0) { return tp_string(""); }
+    r = tp_string_t(tp,b-a);
+    s = r.string.info->s;
+    memcpy(s,v+a,b-a);
+    return tp_track(tp,r);
+}
+
+tp_obj tp_replace(TP) {
+    tp_obj s = TP_OBJ();
+    tp_obj k = TP_OBJ();
+    tp_obj v = TP_OBJ();
+    tp_obj p = s;
+    int i,n = 0;
+    int c;
+    int l;
+    tp_obj rr;
+    char *r;
+    char *d;
+    tp_obj z;
+    while ((i = _tp_str_index(p,k)) != -1) {
+        n += 1;
+        p.string.val += i + k.string.len; p.string.len -= i + k.string.len;
+    }
+/*     fprintf(stderr,"ns: %d\n",n); */
+    l = s.string.len + n * (v.string.len-k.string.len);
+    rr = tp_string_t(tp,l);
+    r = rr.string.info->s;
+    d = r;
+    z = p = s;
+    while ((i = _tp_str_index(p,k)) != -1) {
+        p.string.val += i; p.string.len -= i;
+        memcpy(d,z.string.val,c=(p.string.val-z.string.val)); d += c;
+        p.string.val += k.string.len; p.string.len -= k.string.len;
+        memcpy(d,v.string.val,v.string.len); d += v.string.len;
+        z = p;
+    }
+    memcpy(d,z.string.val,(s.string.val + s.string.len) - z.string.val);
+
+    return tp_track(tp,rr);
+}
+
+/* File: Builtins
+ * Builtin tinypy functions.
+ */
+
+tp_obj tp_print(TP) {
+    int n = 0;
+    tp_obj e;
+    TP_LOOP(e)
+        if (n) { printf(" "); }
+        tp_echo(tp,e);
+        n += 1;
+    TP_END;
+    printf("\n");
+    return tp_None;
+}
+
+tp_obj tp_bind(TP) {
+    tp_obj r = TP_TYPE(TP_FNC);
+    tp_obj self = TP_OBJ();
+    return tp_fnc_new(tp,
+        r.fnc.ftype|2,r.fnc.cfnc,r.fnc.info->code,
+        self,r.fnc.info->globals);
+}
+
+tp_obj tp_min(TP) {
+    tp_obj r = TP_OBJ();
+    tp_obj e;
+    TP_LOOP(e)
+        if (tp_cmp(tp,r,e) > 0) { r = e; }
+    TP_END;
+    return r;
+}
+
+tp_obj tp_max(TP) {
+    tp_obj r = TP_OBJ();
+    tp_obj e;
+    TP_LOOP(e)
+        if (tp_cmp(tp,r,e) < 0) { r = e; }
+    TP_END;
+    return r;
+}
+
+tp_obj tp_copy(TP) {
+    tp_obj r = TP_OBJ();
+    int type = r.type;
+    if (type == TP_LIST) {
+        return _tp_list_copy(tp,r);
+    } else if (type == TP_DICT) {
+        return _tp_dict_copy(tp,r);
+    }
+    tp_raise(tp_None,tp_string("(tp_copy) TypeError: ?"));
+}
+
+
+tp_obj tp_len_(TP) {
+    tp_obj e = TP_OBJ();
+    return tp_len(tp,e);
+}
+
+tp_obj tp_assert(TP) {
+    int a = TP_NUM();
+    if (a) { return tp_None; }
+    tp_raise(tp_None,tp_string("(tp_assert) AssertionError"));
+}
+
+tp_obj tp_range(TP) {
+    int a,b,c,i;
+    tp_obj r = tp_list(tp);
+    switch (tp->params.list.val->len) {
+        case 1: a = 0; b = TP_NUM(); c = 1; break;
+        case 2:
+        case 3: a = TP_NUM(); b = TP_NUM(); c = TP_DEFAULT(tp_number(1)).number.val; break;
+        default: return r;
+    }
+    if (c != 0) {
+        for (i=a; (c>0) ? i<b : i>b; i+=c) {
+            _tp_list_append(tp,r.list.val,tp_number(i));
+        }
+    }
+    return r;
+}
+
+/* Function: tp_system
+ *
+ * The system builtin. A grave security flaw. If your version of tinypy
+ * enables this, you better remove it before deploying your app :P
+ */
+tp_obj tp_system(TP) {
+    char s[TP_CSTR_LEN]; tp_cstr(tp,TP_STR(),s,TP_CSTR_LEN);
+    int r = system(s);
+    return tp_number(r);
+}
+
+tp_obj tp_istype(TP) {
+    tp_obj v = TP_OBJ();
+    tp_obj t = TP_STR();
+    if (tp_cmp(tp,t,tp_string("string")) == 0) { return tp_number(v.type == TP_STRING); }
+    if (tp_cmp(tp,t,tp_string("list")) == 0) { return tp_number(v.type == TP_LIST); }
+    if (tp_cmp(tp,t,tp_string("dict")) == 0) { return tp_number(v.type == TP_DICT); }
+    if (tp_cmp(tp,t,tp_string("number")) == 0) { return tp_number(v.type == TP_NUMBER); }
+    if (tp_cmp(tp,t,tp_string("fnc")) == 0) { return tp_number(v.type == TP_FNC && (v.fnc.ftype&2) == 0); }
+    if (tp_cmp(tp,t,tp_string("method")) == 0) { return tp_number(v.type == TP_FNC && (v.fnc.ftype&2) != 0); }
+    tp_raise(tp_None,tp_string("(is_type) TypeError: ?"));
+}
+
+
+tp_obj tp_float(TP) {
+    tp_obj v = TP_OBJ();
+    int ord = TP_DEFAULT(tp_number(0)).number.val;
+    int type = v.type;
+    if (type == TP_NUMBER) { return v; }
+    if (type == TP_STRING && v.string.len < 32) {
+        char s[32]; memset(s,0,v.string.len+1);
+        memcpy(s,v.string.val,v.string.len);
+        if (strchr(s,'.')) { return tp_number(atof(s)); }
+        return(tp_number(strtol(s,0,ord)));
+    }
+    tp_raise(tp_None,tp_string("(tp_float) TypeError: ?"));
+}
+
+
+tp_obj tp_save(TP) {
+    char fname[256]; tp_cstr(tp,TP_STR(),fname,256);
+    tp_obj v = TP_OBJ();
+    FILE *f;
+    f = fopen(fname,"wb");
+    if (!f) { tp_raise(tp_None,tp_string("(tp_save) IOError: ?")); }
+    fwrite(v.string.val,v.string.len,1,f);
+    fclose(f);
+    return tp_None;
+}
+
+tp_obj tp_load(TP) {
+    FILE *f;
+    long l;
+    tp_obj r;
+    char *s;
+    char fname[256]; tp_cstr(tp,TP_STR(),fname,256);
+    struct stat stbuf;
+    stat(fname, &stbuf);
+    l = stbuf.st_size;
+    f = fopen(fname,"rb");
+    if (!f) {
+        tp_raise(tp_None,tp_string("(tp_load) IOError: ?"));
+    }
+    r = tp_string_t(tp,l);
+    s = r.string.info->s;
+    fread(s,1,l,f);
+/*    if (rr !=l) { printf("hmmn: %d %d\n",rr,(int)l); }*/
+    fclose(f);
+    return tp_track(tp,r);
+}
+
+
+tp_obj tp_fpack(TP) {
+    tp_num v = TP_NUM();
+    tp_obj r = tp_string_t(tp,sizeof(tp_num));
+    *(tp_num*)r.string.val = v;
+    return tp_track(tp,r);
+}
+
+tp_obj tp_abs(TP) {
+    return tp_number(fabs(tp_float(tp).number.val));
+}
+tp_obj tp_int(TP) {
+    return tp_number((long)tp_float(tp).number.val);
+}
+tp_num _roundf(tp_num v) {
+    tp_num av = fabs(v); tp_num iv = (long)av;
+    av = (av-iv < 0.5?iv:iv+1);
+    return (v<0?-av:av);
+}
+tp_obj tp_round(TP) {
+    return tp_number(_roundf(tp_float(tp).number.val));
+}
+
+tp_obj tp_exists(TP) {
+    char fname[TP_CSTR_LEN]; tp_cstr(tp,TP_STR(),fname,TP_CSTR_LEN);
+    struct stat stbuf;
+    return tp_number(!stat(fname,&stbuf));
+}
+tp_obj tp_mtime(TP) {
+    char fname[TP_CSTR_LEN]; tp_cstr(tp,TP_STR(),fname,TP_CSTR_LEN);
+    struct stat stbuf;
+    if (!stat(fname,&stbuf)) { return tp_number(stbuf.st_mtime); }
+    tp_raise(tp_None,tp_string("(tp_mtime) IOError: ?"));
+}
+
+int _tp_lookup_(TP,tp_obj self, tp_obj k, tp_obj *meta, int depth) {
+    int n = _tp_dict_find(tp,self.dict.val,k);
+    if (n != -1) {
+        *meta = self.dict.val->items[n].val;
+        return 1;
+    }
+    depth--; if (!depth) { tp_raise(0,tp_string("(tp_lookup) RuntimeError: maximum lookup depth exceeded")); }
+    if (self.dict.dtype && self.dict.val->meta.type == TP_DICT && _tp_lookup_(tp,self.dict.val->meta,k,meta,depth)) {
+        if (self.dict.dtype == 2 && meta->type == TP_FNC) {
+            *meta = tp_fnc_new(tp,meta->fnc.ftype|2,
+                meta->fnc.cfnc,meta->fnc.info->code,
+                self,meta->fnc.info->globals);
+        }
+        return 1;
+    }
+    return 0;
+}
+
+int _tp_lookup(TP,tp_obj self, tp_obj k, tp_obj *meta) {
+    return _tp_lookup_(tp,self,k,meta,8);
+}
+
+#define TP_META_BEGIN(self,name) \
+    if (self.dict.dtype == 2) { \
+        tp_obj meta; if (_tp_lookup(tp,self,tp_string(name),&meta)) {
+
+#define TP_META_END \
+        } \
+    }
+
+/* Function: tp_setmeta
+ * Set a "dict's meta".
+ *
+ * This is a builtin function, so you need to use <tp_params> to provide the
+ * parameters.
+ *
+ * In tinypy, each dictionary can have a so-called "meta" dictionary attached
+ * to it. When dictionary attributes are accessed, but not present in the
+ * dictionary, they instead are looked up in the meta dictionary. To get the
+ * raw dictionary, you can use <tp_getraw>.
+ *
+ * This function is particulary useful for objects and classes, which are just
+ * special dictionaries created with <tp_object> and <tp_class>. There you can
+ * use tp_setmeta to change the class of the object or parent class of a class.
+ *
+ * Parameters:
+ * self - The dictionary for which to set a meta.
+ * meta - The meta dictionary.
+ *
+ * Returns:
+ * None
+ */
+tp_obj tp_setmeta(TP) {
+    tp_obj self = TP_TYPE(TP_DICT);
+    tp_obj meta = TP_TYPE(TP_DICT);
+    self.dict.val->meta = meta;
+    return tp_None;
+}
+
+tp_obj tp_getmeta(TP) {
+    tp_obj self = TP_TYPE(TP_DICT);
+    return self.dict.val->meta;
+}
+
+/* Function: tp_object
+ * Creates a new object.
+ *
+ * Returns:
+ * The newly created object. The object initially has no parent class, use
+ * <tp_setmeta> to set a class. Also see <tp_object_new>.
+ */
+tp_obj tp_object(TP) {
+    tp_obj self = tp_dict(tp);
+    self.dict.dtype = 2;
+    return self;
+}
+
+tp_obj tp_object_new(TP) {
+    tp_obj klass = TP_TYPE(TP_DICT);
+    tp_obj self = tp_object(tp);
+    self.dict.val->meta = klass;
+    TP_META_BEGIN(self,"__init__");
+        tp_call(tp,meta,tp->params);
+    TP_META_END;
+    return self;
+}
+
+tp_obj tp_object_call(TP) {
+    tp_obj self;
+    if (tp->params.list.val->len) {
+        self = TP_TYPE(TP_DICT);
+        self.dict.dtype = 2;
+    } else {
+        self = tp_object(tp);
+    }
+    return self;
+}
+
+/* Function: tp_getraw
+ * Retrieve the raw dict of a dict.
+ *
+ * This builtin retrieves one dict parameter from tinypy, and returns its raw
+ * dict. This is very useful when implementing your own __get__ and __set__
+ * functions, as it allows you to directly access the attributes stored in the
+ * dict.
+ */
+tp_obj tp_getraw(TP) {
+    tp_obj self = TP_TYPE(TP_DICT);
+    self.dict.dtype = 0;
+    return self;
+}
+
+/* Function: tp_class
+ * Creates a new base class.
+ *
+ * Parameters:
+ * none
+ *
+ * Returns:
+ * A new, empty class (derived from tinypy's builtin "object" class).
+ */
+tp_obj tp_class(TP) {
+    tp_obj klass = tp_dict(tp);
+    klass.dict.val->meta = tp_get(tp,tp->builtins,tp_string("object"));
+    return klass;
+}
+
+/* Function: tp_builtins_bool
+ * Coerces any value to a boolean.
+ */
+tp_obj tp_builtins_bool(TP) {
+    tp_obj v = TP_OBJ();
+    return (tp_number(tp_bool(tp, v)));
+}
+/* tp_obj tp_track(TP,tp_obj v) { return v; }
+   void tp_grey(TP,tp_obj v) { }
+   void tp_full(TP) { }
+   void tp_gc_init(TP) { }
+   void tp_gc_deinit(TP) { }
+   void tp_delete(TP,tp_obj v) { }*/
+
+void tp_grey(TP,tp_obj v) {
+    if (v.type < TP_STRING || (!v.gci.data) || *v.gci.data) { return; }
+    *v.gci.data = 1;
+    if (v.type == TP_STRING || v.type == TP_DATA) {
+        _tp_list_appendx(tp,tp->black,v);
+        return;
+    }
+    _tp_list_appendx(tp,tp->grey,v);
+}
+
+void tp_follow(TP,tp_obj v) {
+    int type = v.type;
+    if (type == TP_LIST) {
+        int n;
+        for (n=0; n<v.list.val->len; n++) {
+            tp_grey(tp,v.list.val->items[n]);
+        }
+    }
+    if (type == TP_DICT) {
+        int i;
+        for (i=0; i<v.dict.val->len; i++) {
+            int n = _tp_dict_next(tp,v.dict.val);
+            tp_grey(tp,v.dict.val->items[n].key);
+            tp_grey(tp,v.dict.val->items[n].val);
+        }
+        tp_grey(tp,v.dict.val->meta);
+    }
+    if (type == TP_FNC) {
+        tp_grey(tp,v.fnc.info->self);
+        tp_grey(tp,v.fnc.info->globals);
+        tp_grey(tp,v.fnc.info->code);
+    }
+}
+
+void tp_reset(TP) {
+    int n;
+    _tp_list *tmp;
+    for (n=0; n<tp->black->len; n++) {
+        *tp->black->items[n].gci.data = 0;
+    }
+    tmp = tp->white;
+    tp->white = tp->black;
+    tp->black = tmp;
+}
+
+void tp_gc_init(TP) {
+    tp->white = _tp_list_new(tp);
+    tp->grey = _tp_list_new(tp);
+    tp->black = _tp_list_new(tp);
+    tp->steps = 0;
+}
+
+void tp_gc_deinit(TP) {
+    _tp_list_free(tp, tp->white);
+    _tp_list_free(tp, tp->grey);
+    _tp_list_free(tp, tp->black);
+}
+
+void tp_delete(TP,tp_obj v) {
+    int type = v.type;
+    if (type == TP_LIST) {
+        _tp_list_free(tp, v.list.val);
+        return;
+    } else if (type == TP_DICT) {
+        _tp_dict_free(tp, v.dict.val);
+        return;
+    } else if (type == TP_STRING) {
+        tp_free(tp, v.string.info);
+        return;
+    } else if (type == TP_DATA) {
+        if (v.data.info->free) {
+            v.data.info->free(tp,v);
+        }
+        tp_free(tp, v.data.info);
+        return;
+    } else if (type == TP_FNC) {
+        tp_free(tp, v.fnc.info);
+        return;
+    }
+    tp_raise(,tp_string("(tp_delete) TypeError: ?"));
+}
+
+void tp_collect(TP) {
+    int n;
+    for (n=0; n<tp->white->len; n++) {
+        tp_obj r = tp->white->items[n];
+        if (*r.gci.data) { continue; }
+        tp_delete(tp,r);
+    }
+    tp->white->len = 0;
+    tp_reset(tp);
+}
+
+void _tp_gcinc(TP) {
+    tp_obj v;
+    if (!tp->grey->len) {
+        return;
+    }
+    v = _tp_list_pop(tp,tp->grey,tp->grey->len-1,"_tp_gcinc");
+    tp_follow(tp,v);
+    _tp_list_appendx(tp,tp->black,v);
+}
+
+void tp_full(TP) {
+    while (tp->grey->len) {
+        _tp_gcinc(tp);
+    }
+    tp_collect(tp);
+    tp_follow(tp,tp->root);
+}
+
+void tp_gcinc(TP) {
+    tp->steps += 1;
+    if (tp->steps < TP_GCMAX || tp->grey->len > 0) {
+        _tp_gcinc(tp); _tp_gcinc(tp);
+    }
+    if (tp->steps < TP_GCMAX || tp->grey->len > 0) { return; }
+    tp->steps = 0;
+    tp_full(tp);
+    return;
+}
+
+tp_obj tp_track(TP,tp_obj v) {
+    tp_gcinc(tp);
+    tp_grey(tp,v);
+    return v;
+}
+
+/**/
+
+/* File: Operations
+ * Various tinypy operations.
+ */
+
+/* Function: tp_str
+ * String representation of an object.
+ *
+ * Returns a string object representating self.
+ */
+tp_obj tp_str(TP,tp_obj self) {
+    int type = self.type;
+    if (type == TP_STRING) { return self; }
+    if (type == TP_NUMBER) {
+        tp_num v = self.number.val;
+        if ((fabs(v)-fabs((long)v)) < 0.000001) { return tp_printf(tp,"%ld",(long)v); }
+        return tp_printf(tp,"%f",v);
+    } else if(type == TP_DICT) {
+        return tp_printf(tp,"<dict 0x%x>",self.dict.val);
+    } else if(type == TP_LIST) {
+        return tp_printf(tp,"<list 0x%x>",self.list.val);
+    } else if (type == TP_NONE) {
+        return tp_string("None");
+    } else if (type == TP_DATA) {
+        return tp_printf(tp,"<data 0x%x>",self.data.val);
+    } else if (type == TP_FNC) {
+        return tp_printf(tp,"<fnc 0x%x>",self.fnc.info);
+    }
+    return tp_string("<?>");
+}
+
+/* Function: tp_bool
+ * Check the truth value of an object
+ *
+ * Returns false if v is a numeric object with a value of exactly 0, v is of
+ * type None or v is a string list or dictionary with a length of 0. Else true
+ * is returned.
+ */
+int tp_bool(TP,tp_obj v) {
+    switch(v.type) {
+        case TP_NUMBER: return v.number.val != 0;
+        case TP_NONE: return 0;
+        case TP_STRING: return v.string.len != 0;
+        case TP_LIST: return v.list.val->len != 0;
+        case TP_DICT: return v.dict.val->len != 0;
+    }
+    return 1;
+}
+
+
+/* Function: tp_has
+ * Checks if an object contains a key.
+ *
+ * Returns tp_True if self[k] exists, tp_False otherwise.
+ */
+tp_obj tp_has(TP,tp_obj self, tp_obj k) {
+    int type = self.type;
+    if (type == TP_DICT) {
+        if (_tp_dict_find(tp,self.dict.val,k) != -1) { return tp_True; }
+        return tp_False;
+    } else if (type == TP_STRING && k.type == TP_STRING) {
+        return tp_number(_tp_str_index(self,k)!=-1);
+    } else if (type == TP_LIST) {
+        return tp_number(_tp_list_find(tp,self.list.val,k)!=-1);
+    }
+    tp_raise(tp_None,tp_string("(tp_has) TypeError: iterable argument required"));
+}
+
+/* Function: tp_del
+ * Remove a dictionary entry.
+ *
+ * Removes the key k from self. Also works on classes and objects.
+ *
+ * Note that unlike with Python, you cannot use this to remove list items.
+ */
+void tp_del(TP,tp_obj self, tp_obj k) {
+    int type = self.type;
+    if (type == TP_DICT) {
+        _tp_dict_del(tp,self.dict.val,k,"tp_del");
+        return;
+    }
+    tp_raise(,tp_string("(tp_del) TypeError: object does not support item deletion"));
+}
+
+
+/* Function: tp_iter
+ * Iterate through a list or dict.
+ *
+ * If self is a list/string/dictionary, this will iterate over the
+ * elements/characters/keys respectively, if k is an increasing index
+ * starting with 0 up to the length of the object-1.
+ *
+ * In the case of a list of string, the returned items will correspond to the
+ * item at index k. For a dictionary, no guarantees are made about the order.
+ * You also cannot call the function with a specific k to get a specific
+ * item -- it is only meant for iterating through all items, calling this
+ * function len(self) times. Use <tp_get> to retrieve a specific item, and
+ * <tp_len> to get the length.
+ *
+ * Parameters:
+ * self - The object over which to iterate.
+ * k - You must pass 0 on the first call, then increase it by 1 after each call,
+ *     and don't call the function with k >= len(self).
+ *
+ * Returns:
+ * The first (k = 0) or next (k = 1 .. len(self)-1) item in the iteration.
+ */
+tp_obj tp_iter(TP,tp_obj self, tp_obj k) {
+    int type = self.type;
+    if (type == TP_LIST || type == TP_STRING) { return tp_get(tp,self,k); }
+    if (type == TP_DICT && k.type == TP_NUMBER) {
+        return self.dict.val->items[_tp_dict_next(tp,self.dict.val)].key;
+    }
+    tp_raise(tp_None,tp_string("(tp_iter) TypeError: iteration over non-sequence"));
+}
+
+
+/* Function: tp_get
+ * Attribute lookup.
+ *
+ * This returns the result of using self[k] in actual code. It works for
+ * dictionaries (including classes and instantiated objects), lists and strings.
+ *
+ * As a special case, if self is a list, self[None] will return the first
+ * element in the list and subsequently remove it from the list.
+ */
+tp_obj tp_get(TP,tp_obj self, tp_obj k) {
+    int type = self.type;
+    tp_obj r;
+    if (type == TP_DICT) {
+        TP_META_BEGIN(self,"__get__");
+            return tp_call(tp,meta,tp_params_v(tp,1,k));
+        TP_META_END;
+        if (self.dict.dtype && _tp_lookup(tp,self,k,&r)) { return r; }
+        return _tp_dict_get(tp,self.dict.val,k,"tp_get");
+    } else if (type == TP_LIST) {
+        if (k.type == TP_NUMBER) {
+            int l = tp_len(tp,self).number.val;
+            int n = k.number.val;
+            n = (n<0?l+n:n);
+            return _tp_list_get(tp,self.list.val,n,"tp_get");
+        } else if (k.type == TP_STRING) {
+            if (tp_cmp(tp,tp_string("append"),k) == 0) {
+                return tp_method(tp,self,tp_append);
+            } else if (tp_cmp(tp,tp_string("pop"),k) == 0) {
+                return tp_method(tp,self,tp_pop);
+            } else if (tp_cmp(tp,tp_string("index"),k) == 0) {
+                return tp_method(tp,self,tp_index);
+            } else if (tp_cmp(tp,tp_string("sort"),k) == 0) {
+                return tp_method(tp,self,tp_sort);
+            } else if (tp_cmp(tp,tp_string("extend"),k) == 0) {
+                return tp_method(tp,self,tp_extend);
+            } else if (tp_cmp(tp,tp_string("*"),k) == 0) {
+                tp_params_v(tp,1,self);
+                r = tp_copy(tp);
+                self.list.val->len=0;
+                return r;
+            }
+        } else if (k.type == TP_NONE) {
+            return _tp_list_pop(tp,self.list.val,0,"tp_get");
+        }
+    } else if (type == TP_STRING) {
+        if (k.type == TP_NUMBER) {
+            int l = self.string.len;
+            int n = k.number.val;
+            n = (n<0?l+n:n);
+            if (n >= 0 && n < l) { return tp_string_n(tp->chars[(unsigned char)self.string.val[n]],1); }
+        } else if (k.type == TP_STRING) {
+            if (tp_cmp(tp,tp_string("join"),k) == 0) {
+                return tp_method(tp,self,tp_join);
+            } else if (tp_cmp(tp,tp_string("split"),k) == 0) {
+                return tp_method(tp,self,tp_split);
+            } else if (tp_cmp(tp,tp_string("index"),k) == 0) {
+                return tp_method(tp,self,tp_str_index);
+            } else if (tp_cmp(tp,tp_string("strip"),k) == 0) {
+                return tp_method(tp,self,tp_strip);
+            } else if (tp_cmp(tp,tp_string("replace"),k) == 0) {
+                return tp_method(tp,self,tp_replace);
+            }
+        }
+    }
+
+    if (k.type == TP_LIST) {
+        int a,b,l;
+        tp_obj tmp;
+        l = tp_len(tp,self).number.val;
+        tmp = tp_get(tp,k,tp_number(0));
+        if (tmp.type == TP_NUMBER) { a = tmp.number.val; }
+        else if(tmp.type == TP_NONE) { a = 0; }
+        else { tp_raise(tp_None,tp_string("(tp_get) TypeError: indices must be numbers")); }
+        tmp = tp_get(tp,k,tp_number(1));
+        if (tmp.type == TP_NUMBER) { b = tmp.number.val; }
+        else if(tmp.type == TP_NONE) { b = l; }
+        else { tp_raise(tp_None,tp_string("(tp_get) TypeError: indices must be numbers")); }
+        a = _tp_max(0,(a<0?l+a:a)); b = _tp_min(l,(b<0?l+b:b));
+        if (type == TP_LIST) {
+            return tp_list_n(tp,b-a,&self.list.val->items[a]);
+        } else if (type == TP_STRING) {
+            return tp_string_sub(tp,self,a,b);
+        }
+    }
+
+    tp_raise(tp_None,tp_string("(tp_get) TypeError: ?"));
+}
+
+/* Function: tp_iget
+ * Failsafe attribute lookup.
+ *
+ * This is like <tp_get>, except it will return false if the attribute lookup
+ * failed. Otherwise, it will return true, and the object will be returned
+ * over the reference parameter r.
+ */
+int tp_iget(TP,tp_obj *r, tp_obj self, tp_obj k) {
+    if (self.type == TP_DICT) {
+        int n = _tp_dict_find(tp,self.dict.val,k);
+        if (n == -1) { return 0; }
+        *r = self.dict.val->items[n].val;
+        tp_grey(tp,*r);
+        return 1;
+    }
+    if (self.type == TP_LIST && !self.list.val->len) { return 0; }
+    *r = tp_get(tp,self,k); tp_grey(tp,*r);
+    return 1;
+}
+
+/* Function: tp_set
+ * Attribute modification.
+ *
+ * This is the counterpart of tp_get, it does the same as self[k] = v would do
+ * in actual tinypy code.
+ */
+void tp_set(TP,tp_obj self, tp_obj k, tp_obj v) {
+    int type = self.type;
+
+    if (type == TP_DICT) {
+        TP_META_BEGIN(self,"__set__");
+            tp_call(tp,meta,tp_params_v(tp,2,k,v));
+            return;
+        TP_META_END;
+        _tp_dict_set(tp,self.dict.val,k,v);
+        return;
+    } else if (type == TP_LIST) {
+        if (k.type == TP_NUMBER) {
+            _tp_list_set(tp,self.list.val,k.number.val,v,"tp_set");
+            return;
+        } else if (k.type == TP_NONE) {
+            _tp_list_append(tp,self.list.val,v);
+            return;
+        } else if (k.type == TP_STRING) {
+            if (tp_cmp(tp,tp_string("*"),k) == 0) {
+                tp_params_v(tp,2,self,v); tp_extend(tp);
+                return;
+            }
+        }
+    }
+    tp_raise(,tp_string("(tp_set) TypeError: object does not support item assignment"));
+}
+
+tp_obj tp_add(TP,tp_obj a, tp_obj b) {
+    if (a.type == TP_NUMBER && a.type == b.type) {
+        return tp_number(a.number.val+b.number.val);
+    } else if (a.type == TP_STRING && a.type == b.type) {
+        int al = a.string.len, bl = b.string.len;
+        tp_obj r = tp_string_t(tp,al+bl);
+        char *s = r.string.info->s;
+        memcpy(s,a.string.val,al); memcpy(s+al,b.string.val,bl);
+        return tp_track(tp,r);
+    } else if (a.type == TP_LIST && a.type == b.type) {
+        tp_obj r;
+        tp_params_v(tp,1,a);
+        r = tp_copy(tp);
+        tp_params_v(tp,2,r,b);
+        tp_extend(tp);
+        return r;
+    }
+    tp_raise(tp_None,tp_string("(tp_add) TypeError: ?"));
+}
+
+tp_obj tp_mul(TP,tp_obj a, tp_obj b) {
+    if (a.type == TP_NUMBER && a.type == b.type) {
+        return tp_number(a.number.val*b.number.val);
+    } else if ((a.type == TP_STRING && b.type == TP_NUMBER) ||
+               (a.type == TP_NUMBER && b.type == TP_STRING)) {
+        if(a.type == TP_NUMBER) {
+            tp_obj c = a; a = b; b = c;
+        }
+        int al = a.string.len; int n = b.number.val;
+        if(n <= 0) {
+            tp_obj r = tp_string_t(tp,0);
+            return tp_track(tp,r);
+        }
+        tp_obj r = tp_string_t(tp,al*n);
+        char *s = r.string.info->s;
+        int i; for (i=0; i<n; i++) { memcpy(s+al*i,a.string.val,al); }
+        return tp_track(tp,r);
+    }
+    tp_raise(tp_None,tp_string("(tp_mul) TypeError: ?"));
+}
+
+/* Function: tp_len
+ * Returns the length of an object.
+ *
+ * Returns the number of items in a list or dict, or the length of a string.
+ */
+tp_obj tp_len(TP,tp_obj self) {
+    int type = self.type;
+    if (type == TP_STRING) {
+        return tp_number(self.string.len);
+    } else if (type == TP_DICT) {
+        return tp_number(self.dict.val->len);
+    } else if (type == TP_LIST) {
+        return tp_number(self.list.val->len);
+    }
+
+    tp_raise(tp_None,tp_string("(tp_len) TypeError: len() of unsized object"));
+}
+
+int tp_cmp(TP,tp_obj a, tp_obj b) {
+    if (a.type != b.type) { return a.type-b.type; }
+    switch(a.type) {
+        case TP_NONE: return 0;
+        case TP_NUMBER: return _tp_sign(a.number.val-b.number.val);
+        case TP_STRING: {
+            int l = _tp_min(a.string.len,b.string.len);
+            int v = memcmp(a.string.val,b.string.val,l);
+            if (v == 0) {
+                v = a.string.len-b.string.len;
+            }
+            return v;
+        }
+        case TP_LIST: {
+            int n,v; for(n=0;n<_tp_min(a.list.val->len,b.list.val->len);n++) {
+        tp_obj aa = a.list.val->items[n]; tp_obj bb = b.list.val->items[n];
+            if (aa.type == TP_LIST && bb.type == TP_LIST) { v = aa.list.val-bb.list.val; } else { v = tp_cmp(tp,aa,bb); }
+            if (v) { return v; } }
+            return a.list.val->len-b.list.val->len;
+        }
+        case TP_DICT: return a.dict.val - b.dict.val;
+        case TP_FNC: return a.fnc.info - b.fnc.info;
+        case TP_DATA: return (char*)a.data.val - (char*)b.data.val;
+    }
+    tp_raise(0,tp_string("(tp_cmp) TypeError: ?"));
+}
+
+#define TP_OP(name,expr) \
+    tp_obj name(TP,tp_obj _a,tp_obj _b) { \
+    if (_a.type == TP_NUMBER && _a.type == _b.type) { \
+        tp_num a = _a.number.val; tp_num b = _b.number.val; \
+        return tp_number(expr); \
+    } \
+    tp_raise(tp_None,tp_string("(" #name ") TypeError: unsupported operand type(s)")); \
+}
+
+TP_OP(tp_bitwise_and,((long)a)&((long)b));
+TP_OP(tp_bitwise_or,((long)a)|((long)b));
+TP_OP(tp_bitwise_xor,((long)a)^((long)b));
+TP_OP(tp_mod,((long)a)%((long)b));
+TP_OP(tp_lsh,((long)a)<<((long)b));
+TP_OP(tp_rsh,((long)a)>>((long)b));
+TP_OP(tp_sub,a-b);
+TP_OP(tp_div,a/b);
+TP_OP(tp_pow,pow(a,b));
+
+tp_obj tp_bitwise_not(TP, tp_obj a) {
+    if (a.type == TP_NUMBER) {
+        return tp_number(~(long)a.number.val);
+    }
+    tp_raise(tp_None,tp_string("(tp_bitwise_not) TypeError: unsupported operand type"));
+}
+
+/**/
+/* File: VM
+ * Functionality pertaining to the virtual machine.
+ */
+
+tp_vm *_tp_init(void) {
+    int i;
+    tp_vm *tp = (tp_vm*)calloc(sizeof(tp_vm),1);
+    tp->time_limit = TP_NO_LIMIT;
+    tp->clocks = clock();
+    tp->time_elapsed = 0.0;
+    tp->mem_limit = TP_NO_LIMIT;
+    tp->mem_exceeded = 0;
+    tp->mem_used = sizeof(tp_vm);
+    tp->cur = 0;
+    tp->jmp = 0;
+    tp->ex = tp_None;
+    tp->root = tp_list_nt(tp);
+    for (i=0; i<256; i++) { tp->chars[i][0]=i; }
+    tp_gc_init(tp);
+    tp->_regs = tp_list(tp);
+    for (i=0; i<TP_REGS; i++) { tp_set(tp,tp->_regs,tp_None,tp_None); }
+    tp->builtins = tp_dict(tp);
+    tp->modules = tp_dict(tp);
+    tp->_params = tp_list(tp);
+    for (i=0; i<TP_FRAMES; i++) { tp_set(tp,tp->_params,tp_None,tp_list(tp)); }
+    tp_set(tp,tp->root,tp_None,tp->builtins);
+    tp_set(tp,tp->root,tp_None,tp->modules);
+    tp_set(tp,tp->root,tp_None,tp->_regs);
+    tp_set(tp,tp->root,tp_None,tp->_params);
+    tp_set(tp,tp->builtins,tp_string("MODULES"),tp->modules);
+    tp_set(tp,tp->modules,tp_string("BUILTINS"),tp->builtins);
+    tp_set(tp,tp->builtins,tp_string("BUILTINS"),tp->builtins);
+    tp_obj sys = tp_dict(tp);
+    tp_set(tp, sys, tp_string("version"), tp_string("tinypy 1.2+SVN"));
+    tp_set(tp,tp->modules, tp_string("sys"), sys);
+    tp->regs = tp->_regs.list.val->items;
+    tp_full(tp);
+    return tp;
+}
+
+
+/* Function: tp_deinit
+ * Destroys a VM instance.
+ *
+ * When you no longer need an instance of tinypy, you can use this to free all
+ * memory used by it. Even when you are using only a single tinypy instance, it
+ * may be good practice to call this function on shutdown.
+ */
+void tp_deinit(TP) {
+    while (tp->root.list.val->len) {
+        _tp_list_pop(tp,tp->root.list.val,0,"tp_deinit");
+    }
+    tp_full(tp); tp_full(tp);
+    tp_delete(tp,tp->root);
+    tp_gc_deinit(tp);
+    tp->mem_used -= sizeof(tp_vm);
+    free(tp);
+}
+
+/* tp_frame_*/
+void tp_frame(TP,tp_obj globals,tp_obj code,tp_obj *ret_dest) {
+    tp_frame_ f;
+    f.globals = globals;
+    f.code = code;
+    f.cur = (tp_code*)f.code.string.val;
+    f.jmp = 0;
+/*     fprintf(stderr,"tp->cur: %d\n",tp->cur);*/
+    f.regs = (tp->cur <= 0?tp->regs:tp->frames[tp->cur].regs+tp->frames[tp->cur].cregs);
+
+    f.regs[0] = f.globals;
+    f.regs[1] = f.code;
+    f.regs += TP_REGS_EXTRA;
+
+    f.ret_dest = ret_dest;
+    f.lineno = 0;
+    f.line = tp_string("");
+    f.name = tp_string("?");
+    f.fname = tp_string("?");
+    f.cregs = 0;
+/*     return f;*/
+    if (f.regs+(256+TP_REGS_EXTRA) >= tp->regs+TP_REGS || tp->cur >= TP_FRAMES-1) {
+        tp_raise(,tp_string("(tp_frame) RuntimeError: stack overflow"));
+    }
+    tp->cur += 1;
+    tp->frames[tp->cur] = f;
+}
+
+void _tp_raise(TP,tp_obj e) {
+    /*char *x = 0; x[0]=0;*/
+    if (!tp || !tp->jmp) {
+#ifndef CPYTHON_MOD
+        printf("\nException:\n"); tp_echo(tp,e); printf("\n");
+        exit(-1);
+#else
+        tp->ex = e;
+        longjmp(tp->nextexpr,1);
+#endif
+    }
+    if (e.type != TP_NONE) { tp->ex = e; }
+    tp_grey(tp,e);
+    longjmp(tp->buf,1);
+}
+
+void tp_print_stack(TP) {
+    int i;
+    printf("\n");
+    for (i=0; i<=tp->cur; i++) {
+        if (!tp->frames[i].lineno) { continue; }
+        printf("File \""); tp_echo(tp,tp->frames[i].fname); printf("\", ");
+        printf("line %d, in ",tp->frames[i].lineno);
+        tp_echo(tp,tp->frames[i].name); printf("\n ");
+        tp_echo(tp,tp->frames[i].line); printf("\n");
+    }
+    printf("\nException:\n"); tp_echo(tp,tp->ex); printf("\n");
+}
+
+void tp_handle(TP) {
+    int i;
+    for (i=tp->cur; i>=0; i--) {
+        if (tp->frames[i].jmp) { break; }
+    }
+    if (i >= 0) {
+        tp->cur = i;
+        tp->frames[i].cur = tp->frames[i].jmp;
+        tp->frames[i].jmp = 0;
+        return;
+    }
+#ifndef CPYTHON_MOD
+    tp_print_stack(tp);
+    exit(-1);
+#else
+    longjmp(tp->nextexpr,1);
+#endif
+}
+
+/* Function: tp_call
+ * Calls a tinypy function.
+ *
+ * Use this to call a tinypy function.
+ *
+ * Parameters:
+ * tp - The VM instance.
+ * self - The object to call.
+ * params - Parameters to pass.
+ *
+ * Example:
+ * > tp_call(tp,
+ * >     tp_get(tp, tp->builtins, tp_string("foo")),
+ * >     tp_params_v(tp, tp_string("hello")))
+ * This will look for a global function named "foo", then call it with a single
+ * positional parameter containing the string "hello".
+ */
+tp_obj tp_call(TP,tp_obj self, tp_obj params) {
+    /* I'm not sure we should have to do this, but
+    just for giggles we will. */
+    tp->params = params;
+
+    if (self.type == TP_DICT) {
+        if (self.dict.dtype == 1) {
+            tp_obj meta; if (_tp_lookup(tp,self,tp_string("__new__"),&meta)) {
+                _tp_list_insert(tp,params.list.val,0,self);
+                return tp_call(tp,meta,params);
+            }
+        } else if (self.dict.dtype == 2) {
+            TP_META_BEGIN(self,"__call__");
+                return tp_call(tp,meta,params);
+            TP_META_END;
+        }
+    }
+    if (self.type == TP_FNC && !(self.fnc.ftype&1)) {
+        tp_obj r = _tp_tcall(tp,self);
+        tp_grey(tp,r);
+        return r;
+    }
+    if (self.type == TP_FNC) {
+        tp_obj dest = tp_None;
+        tp_frame(tp,self.fnc.info->globals,self.fnc.info->code,&dest);
+        if ((self.fnc.ftype&2)) {
+            tp->frames[tp->cur].regs[0] = params;
+            _tp_list_insert(tp,params.list.val,0,self.fnc.info->self);
+        } else {
+            tp->frames[tp->cur].regs[0] = params;
+        }
+        tp_run(tp,tp->cur);
+        return dest;
+    }
+    tp_params_v(tp,1,self); tp_print(tp);
+    tp_raise(tp_None,tp_string("(tp_call) TypeError: object is not callable"));
+}
+
+
+void tp_return(TP, tp_obj v) {
+    tp_obj *dest = tp->frames[tp->cur].ret_dest;
+    if (dest) { *dest = v; tp_grey(tp,v); }
+/*     memset(tp->frames[tp->cur].regs,0,TP_REGS_PER_FRAME*sizeof(tp_obj));
+       fprintf(stderr,"regs:%d\n",(tp->frames[tp->cur].cregs+1));*/
+    memset(tp->frames[tp->cur].regs-TP_REGS_EXTRA,0,(TP_REGS_EXTRA+tp->frames[tp->cur].cregs)*sizeof(tp_obj));
+    tp->cur -= 1;
+}
+
+enum {
+    TP_IEOF,TP_IADD,TP_ISUB,TP_IMUL,TP_IDIV,TP_IPOW,TP_IBITAND,TP_IBITOR,TP_ICMP,TP_IGET,TP_ISET,
+    TP_INUMBER,TP_ISTRING,TP_IGGET,TP_IGSET,TP_IMOVE,TP_IDEF,TP_IPASS,TP_IJUMP,TP_ICALL,
+    TP_IRETURN,TP_IIF,TP_IDEBUG,TP_IEQ,TP_ILE,TP_ILT,TP_IDICT,TP_ILIST,TP_INONE,TP_ILEN,
+    TP_ILINE,TP_IPARAMS,TP_IIGET,TP_IFILE,TP_INAME,TP_INE,TP_IHAS,TP_IRAISE,TP_ISETJMP,
+    TP_IMOD,TP_ILSH,TP_IRSH,TP_IITER,TP_IDEL,TP_IREGS,TP_IBITXOR, TP_IIFN,
+    TP_INOT, TP_IBITNOT,
+    TP_ITOTAL
+};
+
+/* char *tp_strings[TP_ITOTAL] = {
+       "EOF","ADD","SUB","MUL","DIV","POW","BITAND","BITOR","CMP","GET","SET","NUM",
+       "STR","GGET","GSET","MOVE","DEF","PASS","JUMP","CALL","RETURN","IF","DEBUG",
+       "EQ","LE","LT","DICT","LIST","NONE","LEN","LINE","PARAMS","IGET","FILE",
+       "NAME","NE","HAS","RAISE","SETJMP","MOD","LSH","RSH","ITER","DEL","REGS",
+       "BITXOR", "IFN", "NOT", "BITNOT",
+   };*/
+
+#define VA ((int)e.regs.a)
+#define VB ((int)e.regs.b)
+#define VC ((int)e.regs.c)
+#define RA regs[e.regs.a]
+#define RB regs[e.regs.b]
+#define RC regs[e.regs.c]
+#define UVBC (unsigned short)(((VB<<8)+VC))
+#define SVBC (short)(((VB<<8)+VC))
+#define GA tp_grey(tp,RA)
+#define SR(v) f->cur = cur; return(v);
+
+
+int tp_step(TP) {
+    tp_frame_ *f = &tp->frames[tp->cur];
+    tp_obj *regs = f->regs;
+    tp_code *cur = f->cur;
+    while(1) {
+    #ifdef TP_SANDBOX
+    tp_bounds(tp,cur,1);
+    #endif
+    tp_code e = *cur;
+    /*
+     fprintf(stderr,"%2d.%4d: %-6s %3d %3d %3d\n",tp->cur,cur - (tp_code*)f->code.string.val,tp_strings[e.i],VA,VB,VC);
+       int i; for(i=0;i<16;i++) { fprintf(stderr,"%d: %s\n",i,TP_xSTR(regs[i])); }
+    */
+    switch (e.i) {
+        case TP_IEOF: tp_return(tp,tp_None); SR(0); break;
+        case TP_IADD: RA = tp_add(tp,RB,RC); break;
+        case TP_ISUB: RA = tp_sub(tp,RB,RC); break;
+        case TP_IMUL: RA = tp_mul(tp,RB,RC); break;
+        case TP_IDIV: RA = tp_div(tp,RB,RC); break;
+        case TP_IPOW: RA = tp_pow(tp,RB,RC); break;
+        case TP_IBITAND: RA = tp_bitwise_and(tp,RB,RC); break;
+        case TP_IBITOR:  RA = tp_bitwise_or(tp,RB,RC); break;
+        case TP_IBITXOR:  RA = tp_bitwise_xor(tp,RB,RC); break;
+        case TP_IMOD:  RA = tp_mod(tp,RB,RC); break;
+        case TP_ILSH:  RA = tp_lsh(tp,RB,RC); break;
+        case TP_IRSH:  RA = tp_rsh(tp,RB,RC); break;
+        case TP_ICMP: RA = tp_number(tp_cmp(tp,RB,RC)); break;
+        case TP_INE: RA = tp_number(tp_cmp(tp,RB,RC)!=0); break;
+        case TP_IEQ: RA = tp_number(tp_cmp(tp,RB,RC)==0); break;
+        case TP_ILE: RA = tp_number(tp_cmp(tp,RB,RC)<=0); break;
+        case TP_ILT: RA = tp_number(tp_cmp(tp,RB,RC)<0); break;
+        case TP_IBITNOT:  RA = tp_bitwise_not(tp,RB); break;
+        case TP_INOT: RA = tp_number(!tp_bool(tp,RB)); break;
+        case TP_IPASS: break;
+        case TP_IIF: if (tp_bool(tp,RA)) { cur += 1; } break;
+        case TP_IIFN: if (!tp_bool(tp,RA)) { cur += 1; } break;
+        case TP_IGET: RA = tp_get(tp,RB,RC); GA; break;
+        case TP_IITER:
+            if (RC.number.val < tp_len(tp,RB).number.val) {
+                RA = tp_iter(tp,RB,RC); GA;
+                RC.number.val += 1;
+                #ifdef TP_SANDBOX
+                tp_bounds(tp,cur,1);
+                #endif
+                cur += 1;
+            }
+            break;
+        case TP_IHAS: RA = tp_has(tp,RB,RC); break;
+        case TP_IIGET: tp_iget(tp,&RA,RB,RC); break;
+        case TP_ISET: tp_set(tp,RA,RB,RC); break;
+        case TP_IDEL: tp_del(tp,RA,RB); break;
+        case TP_IMOVE: RA = RB; break;
+        case TP_INUMBER:
+            #ifdef TP_SANDBOX
+            tp_bounds(tp,cur,sizeof(tp_num)/4);
+            #endif
+            RA = tp_number(*(tp_num*)(*++cur).string.val);
+            cur += sizeof(tp_num)/4;
+            continue;
+        case TP_ISTRING: {
+            #ifdef TP_SANDBOX
+            tp_bounds(tp,cur,(UVBC/4)+1);
+            #endif
+            /* RA = tp_string_n((*(cur+1)).string.val,UVBC); */
+            int a = (*(cur+1)).string.val-f->code.string.val;
+            RA = tp_string_sub(tp,f->code,a,a+UVBC),
+            cur += (UVBC/4)+1;
+            }
+            break;
+        case TP_IDICT: RA = tp_dict_n(tp,VC/2,&RB); break;
+        case TP_ILIST: RA = tp_list_n(tp,VC,&RB); break;
+        case TP_IPARAMS: RA = tp_params_n(tp,VC,&RB); break;
+        case TP_ILEN: RA = tp_len(tp,RB); break;
+        case TP_IJUMP: cur += SVBC; continue; break;
+        case TP_ISETJMP: f->jmp = SVBC?cur+SVBC:0; break;
+        case TP_ICALL:
+            #ifdef TP_SANDBOX
+            tp_bounds(tp,cur,1);
+            #endif
+            f->cur = cur + 1;  RA = tp_call(tp,RB,RC); GA;
+            return 0; break;
+        case TP_IGGET:
+            if (!tp_iget(tp,&RA,f->globals,RB)) {
+                RA = tp_get(tp,tp->builtins,RB); GA;
+            }
+            break;
+        case TP_IGSET: tp_set(tp,f->globals,RA,RB); break;
+        case TP_IDEF: {
+/*            RA = tp_def(tp,(*(cur+1)).string.val,f->globals);*/
+            #ifdef TP_SANDBOX
+            tp_bounds(tp,cur,SVBC);
+            #endif
+            int a = (*(cur+1)).string.val-f->code.string.val;
+            RA = tp_def(tp,
+                /*tp_string_n((*(cur+1)).string.val,(SVBC-1)*4),*/
+                tp_string_sub(tp,f->code,a,a+(SVBC-1)*4),
+                f->globals);
+            cur += SVBC; continue;
+            }
+            break;
+
+        case TP_IRETURN: tp_return(tp,RA); SR(0); break;
+        case TP_IRAISE: _tp_raise(tp,RA); SR(0); break;
+        case TP_IDEBUG:
+            tp_params_v(tp,3,tp_string("DEBUG:"),tp_number(VA),RA); tp_print(tp);
+            break;
+        case TP_INONE: RA = tp_None; break;
+        case TP_ILINE:
+            #ifdef TP_SANDBOX
+            tp_bounds(tp,cur,VA);
+            #endif
+            ;
+            int a = (*(cur+1)).string.val-f->code.string.val;
+/*            f->line = tp_string_n((*(cur+1)).string.val,VA*4-1);*/
+            f->line = tp_string_sub(tp,f->code,a,a+VA*4-1);
+/*             fprintf(stderr,"%7d: %s\n",UVBC,f->line.string.val);*/
+            cur += VA; f->lineno = UVBC;
+            break;
+        case TP_IFILE: f->fname = RA; break;
+        case TP_INAME: f->name = RA; break;
+        case TP_IREGS: f->cregs = VA; break;
+        default:
+            tp_raise(0,tp_string("(tp_step) RuntimeError: invalid instruction"));
+            break;
+    }
+    #ifdef TP_SANDBOX
+    tp_time_update(tp);
+    tp_mem_update(tp);
+    tp_bounds(tp,cur,1);
+    #endif
+    cur += 1;
+    }
+    SR(0);
+}
+
+void _tp_run(TP,int cur) {
+    tp->jmp += 1; if (setjmp(tp->buf)) { tp_handle(tp); }
+    while (tp->cur >= cur && tp_step(tp) != -1);
+    tp->jmp -= 1;
+}
+
+void tp_run(TP,int cur) {
+    jmp_buf tmp;
+    memcpy(tmp,tp->buf,sizeof(jmp_buf));
+    _tp_run(tp,cur);
+    memcpy(tp->buf,tmp,sizeof(jmp_buf));
+}
+
+
+tp_obj tp_ez_call(TP, const char *mod, const char *fnc, tp_obj params) {
+    tp_obj tmp;
+    tmp = tp_get(tp,tp->modules,tp_string(mod));
+    tmp = tp_get(tp,tmp,tp_string(fnc));
+    return tp_call(tp,tmp,params);
+}
+
+tp_obj _tp_import(TP, tp_obj fname, tp_obj name, tp_obj code) {
+    tp_obj g;
+
+    if (!((fname.type != TP_NONE && _tp_str_index(fname,tp_string(".tpc"))!=-1) || code.type != TP_NONE)) {
+        return tp_ez_call(tp,"py2bc","import_fname",tp_params_v(tp,2,fname,name));
+    }
+
+    if (code.type == TP_NONE) {
+        tp_params_v(tp,1,fname);
+        code = tp_load(tp);
+    }
+
+    g = tp_dict(tp);
+    tp_set(tp,g,tp_string("__name__"),name);
+    tp_set(tp,g,tp_string("__code__"),code);
+    tp_set(tp,g,tp_string("__dict__"),g);
+    tp_frame(tp,g,code,0);
+    tp_set(tp,tp->modules,name,g);
+
+    if (!tp->jmp) { tp_run(tp,tp->cur); }
+
+    return g;
+}
+
+
+/* Function: tp_import
+ * Imports a module.
+ *
+ * Parameters:
+ * fname - The filename of a file containing the module's code.
+ * name - The name of the module.
+ * codes - The module's code.  If this is given, fname is ignored.
+ * len - The length of the bytecode.
+ *
+ * Returns:
+ * The module object.
+ */
+tp_obj tp_import(TP, const char * fname, const char * name, void *codes, int len) {
+    tp_obj f = fname?tp_string(fname):tp_None;
+    tp_obj bc = codes?tp_string_n((const char*)codes,len):tp_None;
+    return _tp_import(tp,f,tp_string(name),bc);
+}
+
+
+
+tp_obj tp_exec_(TP) {
+    tp_obj code = TP_OBJ();
+    tp_obj globals = TP_OBJ();
+    tp_obj r = tp_None;
+    tp_frame(tp,globals,code,&r);
+    tp_run(tp,tp->cur);
+    return r;
+}
+
+
+tp_obj tp_import_(TP) {
+    tp_obj mod = TP_OBJ();
+    tp_obj r;
+
+    if (tp_has(tp,tp->modules,mod).number.val) {
+        return tp_get(tp,tp->modules,mod);
+    }
+
+    r = _tp_import(tp,tp_add(tp,mod,tp_string(".tpc")),mod,tp_None);
+    return r;
+}
+
+void tp_builtins(TP) {
+    tp_obj o;
+    struct {const char *s;void *f;} b[] = {
+    {"print",tp_print}, {"range",tp_range}, {"min",tp_min},
+    {"max",tp_max}, {"bind",tp_bind}, {"copy",tp_copy},
+    {"import",tp_import_}, {"len",tp_len_}, {"assert",tp_assert},
+    {"str",tp_str2}, {"float",tp_float}, {"system",tp_system},
+    {"istype",tp_istype}, {"chr",tp_chr}, {"save",tp_save},
+    {"load",tp_load}, {"fpack",tp_fpack}, {"abs",tp_abs},
+    {"int",tp_int}, {"exec",tp_exec_}, {"exists",tp_exists},
+    {"mtime",tp_mtime}, {"number",tp_float}, {"round",tp_round},
+    {"ord",tp_ord}, {"merge",tp_merge}, {"getraw",tp_getraw},
+    {"setmeta",tp_setmeta}, {"getmeta",tp_getmeta},
+    {"bool", tp_builtins_bool},
+    #ifdef TP_SANDBOX
+    {"sandbox",tp_sandbox_},
+    #endif
+    {0,0},
+    };
+    int i; for(i=0; b[i].s; i++) {
+        tp_set(tp,tp->builtins,tp_string(b[i].s),tp_fnc(tp,(tp_obj (*)(tp_vm *))b[i].f));
+    }
+
+    o = tp_object(tp);
+    tp_set(tp,o,tp_string("__call__"),tp_fnc(tp,tp_object_call));
+    tp_set(tp,o,tp_string("__new__"),tp_fnc(tp,tp_object_new));
+    tp_set(tp,tp->builtins,tp_string("object"),o);
+}
+
+
+void tp_args(TP,int argc, char *argv[]) {
+    tp_obj self = tp_list(tp);
+    int i;
+    for (i=1; i<argc; i++) { _tp_list_append(tp,self.list.val,tp_string(argv[i])); }
+    tp_set(tp,tp->builtins,tp_string("ARGV"),self);
+}
+
+tp_obj tp_main(TP,char *fname, void *code, int len) {
+    return tp_import(tp,fname,"__main__",code, len);
+}
+
+/* Function: tp_compile
+ * Compile some tinypy code.
+ *
+ */
+tp_obj tp_compile(TP, tp_obj text, tp_obj fname) {
+    return tp_ez_call(tp,"BUILTINS","compile",tp_params_v(tp,2,text,fname));
+}
+
+/* Function: tp_exec
+ * Execute VM code.
+ */
+tp_obj tp_exec(TP, tp_obj code, tp_obj globals) {
+    tp_obj r=tp_None;
+    tp_frame(tp,globals,code,&r);
+    tp_run(tp,tp->cur);
+    return r;
+}
+
+tp_obj tp_eval(TP, const char *text, tp_obj globals) {
+    tp_obj code = tp_compile(tp,tp_string(text),tp_string("<eval>"));
+    return tp_exec(tp,code,globals);
+}
+
+/* Function: tp_init
+ * Initializes a new virtual machine.
+ *
+ * The given parameters have the same format as the parameters to main, and
+ * allow passing arguments to your tinypy scripts.
+ *
+ * Returns:
+ * The newly created tinypy instance.
+ */
+tp_vm *tp_init(int argc, char *argv[]) {
+    tp_vm *tp = _tp_init();
+    tp_builtins(tp);
+    tp_args(tp,argc,argv);
+    tp_compiler(tp);
+    return tp;
+}
+
+/**/
+unsigned char tp_tokenize[] = {
+44,67,0,0,30,4,0,1,99,108,97,115,115,32,84,111,
+107,101,110,58,0,0,0,0,12,0,0,11,116,111,107,101,
+110,105,122,101,46,112,121,0,33,0,0,0,12,0,0,1,
+63,0,0,0,34,0,0,0,26,0,0,0,12,1,0,5,
+84,111,107,101,110,0,0,0,14,1,0,0,12,3,0,7,
+115,101,116,109,101,116,97,0,13,2,3,0,15,3,0,0,
+12,5,0,6,111,98,106,101,99,116,0,0,13,4,5,0,
+31,1,3,2,19,1,2,1,16,1,0,89,44,11,0,0,
+30,17,0,2,32,32,32,32,100,101,102,32,95,95,105,110,
+105,116,95,95,40,115,101,108,102,44,112,111,115,61,40,48,
+44,48,41,44,116,121,112,101,61,39,115,121,109,98,111,108,
+39,44,118,97,108,61,78,111,110,101,44,105,116,101,109,115,
+61,78,111,110,101,41,58,0,12,1,0,11,116,111,107,101,
+110,105,122,101,46,112,121,0,33,1,0,0,12,1,0,8,
+95,95,105,110,105,116,95,95,0,0,0,0,34,1,0,0,
+28,2,0,0,9,1,0,2,11,3,0,0,0,0,0,0,
+0,0,0,0,11,4,0,0,0,0,0,0,0,0,0,0,
+27,2,3,2,28,3,0,0,32,2,0,3,12,3,0,6,
+115,121,109,98,111,108,0,0,28,4,0,0,32,3,0,4,
+28,4,0,0,28,5,0,0,32,4,0,5,28,5,0,0,
+28,6,0,0,32,5,0,6,30,17,0,3,32,32,32,32,
+32,32,32,32,115,101,108,102,46,112,111,115,44,115,101,108,
+102,46,116,121,112,101,44,115,101,108,102,46,118,97,108,44,
+115,101,108,102,46,105,116,101,109,115,61,112,111,115,44,116,
+121,112,101,44,118,97,108,44,105,116,101,109,115,0,0,0,
+15,6,2,0,15,7,3,0,15,8,4,0,15,9,5,0,
+12,10,0,3,112,111,115,0,10,1,10,6,12,6,0,4,
+116,121,112,101,0,0,0,0,10,1,6,7,12,6,0,3,
+118,97,108,0,10,1,6,8,12,6,0,5,105,116,101,109,
+115,0,0,0,10,1,6,9,0,0,0,0,12,2,0,8,
+95,95,105,110,105,116,95,95,0,0,0,0,10,0,2,1,
+30,6,0,5,100,101,102,32,117,95,101,114,114,111,114,40,
+99,116,120,44,115,44,105,41,58,0,0,0,16,0,0,175,
+44,12,0,0,30,6,0,5,100,101,102,32,117,95,101,114,
+114,111,114,40,99,116,120,44,115,44,105,41,58,0,0,0,
+12,1,0,11,116,111,107,101,110,105,122,101,46,112,121,0,
+33,1,0,0,12,1,0,7,117,95,101,114,114,111,114,0,
+34,1,0,0,28,2,0,0,9,1,0,2,28,3,0,0,
+9,2,0,3,28,4,0,0,9,3,0,4,30,3,0,6,
+32,32,32,32,121,44,120,32,61,32,105,0,11,6,0,0,
+0,0,0,0,0,0,0,0,9,5,3,6,15,4,5,0,
+11,7,0,0,0,0,0,0,0,0,240,63,9,6,3,7,
+15,5,6,0,30,8,0,7,32,32,32,32,108,105,110,101,
+32,61,32,115,46,115,112,108,105,116,40,39,92,110,39,41,
+91,121,45,49,93,0,0,0,12,8,0,5,115,112,108,105,
+116,0,0,0,9,7,2,8,12,8,0,1,10,0,0,0,
+31,6,8,1,19,6,7,6,11,8,0,0,0,0,0,0,
+0,0,240,63,2,7,4,8,9,6,6,7,15,3,6,0,
+30,3,0,8,32,32,32,32,112,32,61,32,39,39,0,0,
+12,7,0,0,0,0,0,0,15,6,7,0,30,6,0,9,
+32,32,32,32,105,102,32,121,32,60,32,49,48,58,32,112,
+32,43,61,32,39,32,39,0,11,8,0,0,0,0,0,0,
+0,0,36,64,25,7,4,8,21,7,0,0,18,0,0,6,
+12,8,0,1,32,0,0,0,1,7,6,8,15,6,7,0,
+18,0,0,1,30,7,0,10,32,32,32,32,105,102,32,121,
+32,60,32,49,48,48,58,32,112,32,43,61,32,39,32,32,
+39,0,0,0,11,8,0,0,0,0,0,0,0,0,89,64,
+25,7,4,8,21,7,0,0,18,0,0,6,12,8,0,2,
+32,32,0,0,1,7,6,8,15,6,7,0,18,0,0,1,
+30,10,0,11,32,32,32,32,114,32,61,32,112,32,43,32,
+115,116,114,40,121,41,32,43,32,34,58,32,34,32,43,32,
+108,105,110,101,32,43,32,34,92,110,34,0,12,11,0,3,
+115,116,114,0,13,10,11,0,15,11,4,0,31,9,11,1,
+19,9,10,9,1,8,6,9,12,9,0,2,58,32,0,0,
+1,8,8,9,1,8,8,3,12,9,0,1,10,0,0,0,
+1,8,8,9,15,7,8,0,30,9,0,12,32,32,32,32,
+114,32,43,61,32,34,32,32,32,32,32,34,43,34,32,34,
+42,120,43,34,94,34,32,43,39,92,110,39,0,0,0,0,
+12,9,0,5,32,32,32,32,32,0,0,0,12,10,0,1,
+32,0,0,0,3,10,10,5,1,9,9,10,12,10,0,1,
+94,0,0,0,1,9,9,10,12,10,0,1,10,0,0,0,
+1,9,9,10,1,8,7,9,15,7,8,0,30,8,0,13,
+32,32,32,32,114,97,105,115,101,32,39,101,114,114,111,114,
+58,32,39,43,99,116,120,43,39,92,110,39,43,114,0,0,
+12,8,0,7,101,114,114,111,114,58,32,0,1,8,8,1,
+12,9,0,1,10,0,0,0,1,8,8,9,1,8,8,7,
+37,8,0,0,0,0,0,0,12,2,0,7,117,95,101,114,
+114,111,114,0,14,2,0,0,30,11,0,15,73,83,89,77,
+66,79,76,83,32,61,32,39,96,45,61,91,93,59,44,46,
+47,126,33,64,36,37,94,38,42,40,41,43,123,125,58,60,
+62,63,124,39,0,0,0,0,12,2,0,8,73,83,89,77,
+66,79,76,83,0,0,0,0,12,3,0,27,96,45,61,91,
+93,59,44,46,47,126,33,64,36,37,94,38,42,40,41,43,
+123,125,58,60,62,63,124,0,14,2,3,0,30,3,0,16,
+83,89,77,66,79,76,83,32,61,32,91,0,12,2,0,7,
+83,89,77,66,79,76,83,0,30,19,0,17,32,32,32,32,
+39,100,101,102,39,44,39,99,108,97,115,115,39,44,39,121,
+105,101,108,100,39,44,39,114,101,116,117,114,110,39,44,39,
+112,97,115,115,39,44,39,97,110,100,39,44,39,111,114,39,
+44,39,110,111,116,39,44,39,105,110,39,44,39,105,109,112,
+111,114,116,39,44,0,0,0,12,4,0,3,100,101,102,0,
+12,5,0,5,99,108,97,115,115,0,0,0,12,6,0,5,
+121,105,101,108,100,0,0,0,12,7,0,6,114,101,116,117,
+114,110,0,0,12,8,0,4,112,97,115,115,0,0,0,0,
+12,9,0,3,97,110,100,0,12,10,0,2,111,114,0,0,
+12,11,0,3,110,111,116,0,12,12,0,2,105,110,0,0,
+12,13,0,6,105,109,112,111,114,116,0,0,30,17,0,18,
+32,32,32,32,39,105,115,39,44,39,119,104,105,108,101,39,
+44,39,98,114,101,97,107,39,44,39,102,111,114,39,44,39,
+99,111,110,116,105,110,117,101,39,44,39,105,102,39,44,39,
+101,108,115,101,39,44,39,101,108,105,102,39,44,39,116,114,
+121,39,44,0,12,14,0,2,105,115,0,0,12,15,0,5,
+119,104,105,108,101,0,0,0,12,16,0,5,98,114,101,97,
+107,0,0,0,12,17,0,3,102,111,114,0,12,18,0,8,
+99,111,110,116,105,110,117,101,0,0,0,0,12,19,0,2,
+105,102,0,0,12,20,0,4,101,108,115,101,0,0,0,0,
+12,21,0,4,101,108,105,102,0,0,0,0,12,22,0,3,
+116,114,121,0,30,17,0,19,32,32,32,32,39,101,120,99,
+101,112,116,39,44,39,114,97,105,115,101,39,44,39,84,114,
+117,101,39,44,39,70,97,108,115,101,39,44,39,78,111,110,
+101,39,44,39,103,108,111,98,97,108,39,44,39,100,101,108,
+39,44,39,102,114,111,109,39,44,0,0,0,12,23,0,6,
+101,120,99,101,112,116,0,0,12,24,0,5,114,97,105,115,
+101,0,0,0,12,25,0,4,84,114,117,101,0,0,0,0,
+12,26,0,5,70,97,108,115,101,0,0,0,12,27,0,4,
+78,111,110,101,0,0,0,0,12,28,0,6,103,108,111,98,
+97,108,0,0,12,29,0,3,100,101,108,0,12,30,0,4,
+102,114,111,109,0,0,0,0,30,10,0,20,32,32,32,32,
+39,45,39,44,39,43,39,44,39,42,39,44,39,42,42,39,
+44,39,47,39,44,39,37,39,44,39,60,60,39,44,39,62,
+62,39,44,0,12,31,0,1,45,0,0,0,12,32,0,1,
+43,0,0,0,12,33,0,1,42,0,0,0,12,34,0,2,
+42,42,0,0,12,35,0,1,47,0,0,0,12,36,0,1,
+37,0,0,0,12,37,0,2,60,60,0,0,12,38,0,2,
+62,62,0,0,30,17,0,21,32,32,32,32,39,45,61,39,
+44,39,43,61,39,44,39,42,61,39,44,39,47,61,39,44,
+39,61,39,44,39,61,61,39,44,39,33,61,39,44,39,60,
+39,44,39,62,39,44,32,39,124,61,39,44,32,39,38,61,
+39,44,32,39,94,61,39,44,0,0,0,0,12,39,0,2,
+45,61,0,0,12,40,0,2,43,61,0,0,12,41,0,2,
+42,61,0,0,12,42,0,2,47,61,0,0,12,43,0,1,
+61,0,0,0,12,44,0,2,61,61,0,0,12,45,0,2,
+33,61,0,0,12,46,0,1,60,0,0,0,12,47,0,1,
+62,0,0,0,12,48,0,2,124,61,0,0,12,49,0,2,
+38,61,0,0,12,50,0,2,94,61,0,0,30,18,0,22,
+32,32,32,32,39,60,61,39,44,39,62,61,39,44,39,91,
+39,44,39,93,39,44,39,123,39,44,39,125,39,44,39,40,
+39,44,39,41,39,44,39,46,39,44,39,58,39,44,39,44,
+39,44,39,59,39,44,39,38,39,44,39,124,39,44,39,33,
+39,44,32,39,94,39,0,0,12,51,0,2,60,61,0,0,
+12,52,0,2,62,61,0,0,12,53,0,1,91,0,0,0,
+12,54,0,1,93,0,0,0,12,55,0,1,123,0,0,0,
+12,56,0,1,125,0,0,0,12,57,0,1,40,0,0,0,
+12,58,0,1,41,0,0,0,12,59,0,1,46,0,0,0,
+12,60,0,1,58,0,0,0,12,61,0,1,44,0,0,0,
+12,62,0,1,59,0,0,0,12,63,0,1,38,0,0,0,
+12,64,0,1,124,0,0,0,12,65,0,1,33,0,0,0,
+12,66,0,1,94,0,0,0,27,3,4,63,14,2,3,0,
+30,11,0,24,66,95,66,69,71,73,78,44,66,95,69,78,
+68,32,61,32,91,39,91,39,44,39,40,39,44,39,123,39,
+93,44,91,39,93,39,44,39,41,39,44,39,125,39,93,0,
+12,4,0,1,91,0,0,0,12,5,0,1,40,0,0,0,
+12,6,0,1,123,0,0,0,27,3,4,3,15,2,3,0,
+12,5,0,1,93,0,0,0,12,6,0,1,41,0,0,0,
+12,7,0,1,125,0,0,0,27,4,5,3,15,3,4,0,
+12,4,0,7,66,95,66,69,71,73,78,0,14,4,2,0,
+12,2,0,5,66,95,69,78,68,0,0,0,14,2,3,0,
+30,4,0,26,99,108,97,115,115,32,84,68,97,116,97,58,
+0,0,0,0,26,2,0,0,12,3,0,5,84,68,97,116,
+97,0,0,0,14,3,2,0,12,5,0,7,115,101,116,109,
+101,116,97,0,13,4,5,0,15,5,2,0,12,7,0,6,
+111,98,106,101,99,116,0,0,13,6,7,0,31,3,5,2,
+19,3,4,3,16,3,0,91,44,6,0,0,30,6,0,27,
+32,32,32,32,100,101,102,32,95,95,105,110,105,116,95,95,
+40,115,101,108,102,41,58,0,12,1,0,11,116,111,107,101,
+110,105,122,101,46,112,121,0,33,1,0,0,12,1,0,8,
+95,95,105,110,105,116,95,95,0,0,0,0,34,1,0,0,
+28,2,0,0,9,1,0,2,30,11,0,28,32,32,32,32,
+32,32,32,32,115,101,108,102,46,121,44,115,101,108,102,46,
+121,105,44,115,101,108,102,46,110,108,32,61,32,49,44,48,
+44,84,114,117,101,0,0,0,11,3,0,0,0,0,0,0,
+0,0,240,63,15,2,3,0,11,4,0,0,0,0,0,0,
+0,0,0,0,15,3,4,0,11,5,0,0,0,0,0,0,
+0,0,240,63,15,4,5,0,12,5,0,1,121,0,0,0,
+10,1,5,2,12,2,0,2,121,105,0,0,10,1,2,3,
+12,2,0,2,110,108,0,0,10,1,2,4,30,13,0,29,
+32,32,32,32,32,32,32,32,115,101,108,102,46,114,101,115,
+44,115,101,108,102,46,105,110,100,101,110,116,44,115,101,108,
+102,46,98,114,97,99,101,115,32,61,32,91,93,44,91,48,
+93,44,48,0,27,3,0,0,15,2,3,0,11,5,0,0,
+0,0,0,0,0,0,0,0,27,4,5,1,15,3,4,0,
+11,5,0,0,0,0,0,0,0,0,0,0,15,4,5,0,
+12,5,0,3,114,101,115,0,10,1,5,2,12,2,0,6,
+105,110,100,101,110,116,0,0,10,1,2,3,12,2,0,6,
+98,114,97,99,101,115,0,0,10,1,2,4,0,0,0,0,
+12,4,0,8,95,95,105,110,105,116,95,95,0,0,0,0,
+10,2,4,3,16,4,0,53,44,12,0,0,30,15,0,30,
+32,32,32,32,100,101,102,32,97,100,100,40,115,101,108,102,
+44,116,44,118,41,58,32,115,101,108,102,46,114,101,115,46,
+97,112,112,101,110,100,40,84,111,107,101,110,40,115,101,108,
+102,46,102,44,116,44,118,41,41,0,0,0,12,1,0,11,
+116,111,107,101,110,105,122,101,46,112,121,0,33,1,0,0,
+12,1,0,3,97,100,100,0,34,1,0,0,28,2,0,0,
+9,1,0,2,28,3,0,0,9,2,0,3,28,4,0,0,
+9,3,0,4,12,6,0,3,114,101,115,0,9,5,1,6,
+12,6,0,6,97,112,112,101,110,100,0,0,9,5,5,6,
+12,8,0,5,84,111,107,101,110,0,0,0,13,7,8,0,
+12,11,0,1,102,0,0,0,9,8,1,11,15,9,2,0,
+15,10,3,0,31,6,8,3,19,6,7,6,31,4,6,1,
+19,4,5,4,0,0,0,0,12,5,0,3,97,100,100,0,
+10,2,5,4,30,4,0,32,100,101,102,32,99,108,101,97,
+110,40,115,41,58,0,0,0,16,2,0,65,44,6,0,0,
+30,4,0,32,100,101,102,32,99,108,101,97,110,40,115,41,
+58,0,0,0,12,1,0,11,116,111,107,101,110,105,122,101,
+46,112,121,0,33,1,0,0,12,1,0,5,99,108,101,97,
+110,0,0,0,34,1,0,0,28,2,0,0,9,1,0,2,
+30,8,0,33,32,32,32,32,115,32,61,32,115,46,114,101,
+112,108,97,99,101,40,39,92,114,92,110,39,44,39,92,110,
+39,41,0,0,12,4,0,7,114,101,112,108,97,99,101,0,
+9,3,1,4,12,4,0,2,13,10,0,0,12,5,0,1,
+10,0,0,0,31,2,4,2,19,2,3,2,15,1,2,0,
+30,8,0,34,32,32,32,32,115,32,61,32,115,46,114,101,
+112,108,97,99,101,40,39,92,114,39,44,39,92,110,39,41,
+0,0,0,0,12,4,0,7,114,101,112,108,97,99,101,0,
+9,3,1,4,12,4,0,1,13,0,0,0,12,5,0,1,
+10,0,0,0,31,2,4,2,19,2,3,2,15,1,2,0,
+30,4,0,35,32,32,32,32,114,101,116,117,114,110,32,115,
+0,0,0,0,20,1,0,0,0,0,0,0,12,5,0,5,
+99,108,101,97,110,0,0,0,14,5,2,0,30,5,0,37,
+100,101,102,32,116,111,107,101,110,105,122,101,40,115,41,58,
+0,0,0,0,16,5,0,124,44,10,0,0,30,5,0,37,
+100,101,102,32,116,111,107,101,110,105,122,101,40,115,41,58,
+0,0,0,0,12,1,0,11,116,111,107,101,110,105,122,101,
+46,112,121,0,33,1,0,0,12,1,0,8,116,111,107,101,
+110,105,122,101,0,0,0,0,34,1,0,0,28,2,0,0,
+9,1,0,2,30,4,0,38,32,32,32,32,103,108,111,98,
+97,108,32,84,0,0,0,0,30,5,0,39,32,32,32,32,
+115,32,61,32,99,108,101,97,110,40,115,41,0,0,0,0,
+12,4,0,5,99,108,101,97,110,0,0,0,13,3,4,0,
+15,4,1,0,31,2,4,1,19,2,3,2,15,1,2,0,
+30,8,0,40,32,32,32,32,84,44,105,44,108,32,61,32,
+84,68,97,116,97,40,41,44,48,44,108,101,110,40,115,41,
+0,0,0,0,12,5,0,5,84,68,97,116,97,0,0,0,
+13,4,5,0,31,3,0,0,19,3,4,3,15,2,3,0,
+11,4,0,0,0,0,0,0,0,0,0,0,15,3,4,0,
+12,7,0,3,108,101,110,0,13,6,7,0,15,7,1,0,
+31,5,7,1,19,5,6,5,15,4,5,0,12,5,0,1,
+84,0,0,0,14,5,2,0,15,2,3,0,15,3,4,0,
+30,9,0,41,32,32,32,32,116,114,121,58,32,114,101,116,
+117,114,110,32,100,111,95,116,111,107,101,110,105,122,101,40,
+115,44,105,44,108,41,0,0,38,0,0,14,12,6,0,11,
+100,111,95,116,111,107,101,110,105,122,101,0,13,5,6,0,
+15,6,1,0,15,7,2,0,15,8,3,0,31,4,6,3,
+19,4,5,4,20,4,0,0,38,0,0,0,18,0,0,29,
+30,10,0,42,32,32,32,32,101,120,99,101,112,116,58,32,
+117,95,101,114,114,111,114,40,39,116,111,107,101,110,105,122,
+101,39,44,115,44,84,46,102,41,0,0,0,12,6,0,7,
+117,95,101,114,114,111,114,0,13,5,6,0,12,6,0,8,
+116,111,107,101,110,105,122,101,0,0,0,0,15,7,1,0,
+12,9,0,1,84,0,0,0,13,8,9,0,12,9,0,1,
+102,0,0,0,9,8,8,9,31,4,6,3,19,4,5,4,
+0,0,0,0,12,6,0,8,116,111,107,101,110,105,122,101,
+0,0,0,0,14,6,5,0,30,6,0,44,100,101,102,32,
+100,111,95,116,111,107,101,110,105,122,101,40,115,44,105,44,
+108,41,58,0,16,6,2,55,44,11,0,0,30,6,0,44,
+100,101,102,32,100,111,95,116,111,107,101,110,105,122,101,40,
+115,44,105,44,108,41,58,0,12,1,0,11,116,111,107,101,
+110,105,122,101,46,112,121,0,33,1,0,0,12,1,0,11,
+100,111,95,116,111,107,101,110,105,122,101,0,34,1,0,0,
+28,2,0,0,9,1,0,2,28,3,0,0,9,2,0,3,
+28,4,0,0,9,3,0,4,30,4,0,45,32,32,32,32,
+103,108,111,98,97,108,32,84,0,0,0,0,30,7,0,46,
+32,32,32,32,84,46,102,32,61,32,40,84,46,121,44,105,
+45,84,46,121,105,43,49,41,0,0,0,0,12,5,0,1,
+84,0,0,0,13,4,5,0,12,8,0,1,84,0,0,0,
+13,6,8,0,12,8,0,1,121,0,0,0,9,6,6,8,
+12,9,0,1,84,0,0,0,13,8,9,0,12,9,0,2,
+121,105,0,0,9,8,8,9,2,7,2,8,11,8,0,0,
+0,0,0,0,0,0,240,63,1,7,7,8,27,5,6,2,
+12,6,0,1,102,0,0,0,10,4,6,5,30,5,0,47,
+32,32,32,32,119,104,105,108,101,32,105,32,60,32,108,58,
+0,0,0,0,25,4,2,3,21,4,0,0,18,0,1,202,
+30,10,0,48,32,32,32,32,32,32,32,32,99,32,61,32,
+115,91,105,93,59,32,84,46,102,32,61,32,40,84,46,121,
+44,105,45,84,46,121,105,43,49,41,0,0,9,5,1,2,
+15,4,5,0,12,6,0,1,84,0,0,0,13,5,6,0,
+12,9,0,1,84,0,0,0,13,7,9,0,12,9,0,1,
+121,0,0,0,9,7,7,9,12,10,0,1,84,0,0,0,
+13,9,10,0,12,10,0,2,121,105,0,0,9,9,9,10,
+2,8,2,9,11,9,0,0,0,0,0,0,0,0,240,63,
+1,8,8,9,27,6,7,2,12,7,0,1,102,0,0,0,
+10,5,7,6,30,13,0,49,32,32,32,32,32,32,32,32,
+105,102,32,84,46,110,108,58,32,84,46,110,108,32,61,32,
+70,97,108,115,101,59,32,105,32,61,32,100,111,95,105,110,
+100,101,110,116,40,115,44,105,44,108,41,0,12,6,0,1,
+84,0,0,0,13,5,6,0,12,6,0,2,110,108,0,0,
+9,5,5,6,21,5,0,0,18,0,0,22,12,6,0,1,
+84,0,0,0,13,5,6,0,11,6,0,0,0,0,0,0,
+0,0,0,0,12,7,0,2,110,108,0,0,10,5,7,6,
+12,7,0,9,100,111,95,105,110,100,101,110,116,0,0,0,
+13,6,7,0,15,7,1,0,15,8,2,0,15,9,3,0,
+31,5,7,3,19,5,6,5,15,2,5,0,18,0,1,121,
+30,11,0,50,32,32,32,32,32,32,32,32,101,108,105,102,
+32,99,32,61,61,32,39,92,110,39,58,32,105,32,61,32,
+100,111,95,110,108,40,115,44,105,44,108,41,0,0,0,0,
+12,6,0,1,10,0,0,0,23,5,4,6,21,5,0,0,
+18,0,0,12,12,7,0,5,100,111,95,110,108,0,0,0,
+13,6,7,0,15,7,1,0,15,8,2,0,15,9,3,0,
+31,5,7,3,19,5,6,5,15,2,5,0,18,0,1,93,
+30,13,0,51,32,32,32,32,32,32,32,32,101,108,105,102,
+32,99,32,105,110,32,73,83,89,77,66,79,76,83,58,32,
+105,32,61,32,100,111,95,115,121,109,98,111,108,40,115,44,
+105,44,108,41,0,0,0,0,12,6,0,8,73,83,89,77,
+66,79,76,83,0,0,0,0,13,5,6,0,36,5,5,4,
+21,5,0,0,18,0,0,13,12,7,0,9,100,111,95,115,
+121,109,98,111,108,0,0,0,13,6,7,0,15,7,1,0,
+15,8,2,0,15,9,3,0,31,5,7,3,19,5,6,5,
+15,2,5,0,18,0,1,59,30,15,0,52,32,32,32,32,
+32,32,32,32,101,108,105,102,32,99,32,62,61,32,39,48,
+39,32,97,110,100,32,99,32,60,61,32,39,57,39,58,32,
+105,32,61,32,100,111,95,110,117,109,98,101,114,40,115,44,
+105,44,108,41,0,0,0,0,12,5,0,1,48,0,0,0,
+24,5,5,4,21,5,0,0,18,0,0,4,12,6,0,1,
+57,0,0,0,24,5,4,6,21,5,0,0,18,0,0,13,
+12,7,0,9,100,111,95,110,117,109,98,101,114,0,0,0,
+13,6,7,0,15,7,1,0,15,8,2,0,15,9,3,0,
+31,5,7,3,19,5,6,5,15,2,5,0,18,0,1,21,
+30,18,0,54,32,32,32,32,32,32,32,32,32,32,32,32,
+40,99,32,62,61,32,39,65,39,32,97,110,100,32,99,32,
+60,61,32,39,90,39,41,32,111,114,32,99,32,61,61,32,
+39,95,39,58,32,32,105,32,61,32,100,111,95,110,97,109,
+101,40,115,44,105,44,108,41,0,0,0,0,30,11,0,53,
+32,32,32,32,32,32,32,32,101,108,105,102,32,40,99,32,
+62,61,32,39,97,39,32,97,110,100,32,99,32,60,61,32,
+39,122,39,41,32,111,114,32,92,0,0,0,12,5,0,1,
+97,0,0,0,24,5,5,4,21,5,0,0,18,0,0,4,
+12,6,0,1,122,0,0,0,24,5,4,6,46,5,0,0,
+18,0,0,28,30,18,0,54,32,32,32,32,32,32,32,32,
+32,32,32,32,40,99,32,62,61,32,39,65,39,32,97,110,
+100,32,99,32,60,61,32,39,90,39,41,32,111,114,32,99,
+32,61,61,32,39,95,39,58,32,32,105,32,61,32,100,111,
+95,110,97,109,101,40,115,44,105,44,108,41,0,0,0,0,
+12,5,0,1,65,0,0,0,24,5,5,4,21,5,0,0,
+18,0,0,4,12,6,0,1,90,0,0,0,24,5,4,6,
+46,5,0,0,18,0,0,4,12,6,0,1,95,0,0,0,
+23,5,4,6,21,5,0,0,18,0,0,12,12,7,0,7,
+100,111,95,110,97,109,101,0,13,6,7,0,15,7,1,0,
+15,8,2,0,15,9,3,0,31,5,7,3,19,5,6,5,
+15,2,5,0,18,0,0,191,30,13,0,55,32,32,32,32,
+32,32,32,32,101,108,105,102,32,99,61,61,39,34,39,32,
+111,114,32,99,61,61,34,39,34,58,32,105,32,61,32,100,
+111,95,115,116,114,105,110,103,40,115,44,105,44,108,41,0,
+12,6,0,1,34,0,0,0,23,5,4,6,46,5,0,0,
+18,0,0,4,12,6,0,1,39,0,0,0,23,5,4,6,
+21,5,0,0,18,0,0,13,12,7,0,9,100,111,95,115,
+116,114,105,110,103,0,0,0,13,6,7,0,15,7,1,0,
+15,8,2,0,15,9,3,0,31,5,7,3,19,5,6,5,
+15,2,5,0,18,0,0,155,30,11,0,56,32,32,32,32,
+32,32,32,32,101,108,105,102,32,99,61,61,39,35,39,58,
+32,105,32,61,32,100,111,95,99,111,109,109,101,110,116,40,
+115,44,105,44,108,41,0,0,12,6,0,1,35,0,0,0,
+23,5,4,6,21,5,0,0,18,0,0,13,12,7,0,10,
+100,111,95,99,111,109,109,101,110,116,0,0,13,6,7,0,
+15,7,1,0,15,8,2,0,15,9,3,0,31,5,7,3,
+19,5,6,5,15,2,5,0,18,0,0,126,30,11,0,57,
+32,32,32,32,32,32,32,32,101,108,105,102,32,99,32,61,
+61,32,39,92,92,39,32,97,110,100,32,115,91,105,43,49,
+93,32,61,61,32,39,92,110,39,58,0,0,12,6,0,1,
+92,0,0,0,23,5,4,6,21,5,0,0,18,0,0,9,
+11,7,0,0,0,0,0,0,0,0,240,63,1,6,2,7,
+9,5,1,6,12,6,0,1,10,0,0,0,23,5,5,6,
+21,5,0,0,18,0,0,42,30,10,0,58,32,32,32,32,
+32,32,32,32,32,32,32,32,105,32,43,61,32,50,59,32,
+84,46,121,44,84,46,121,105,32,61,32,84,46,121,43,49,
+44,105,0,0,11,6,0,0,0,0,0,0,0,0,0,64,
+1,5,2,6,15,2,5,0,12,7,0,1,84,0,0,0,
+13,6,7,0,12,7,0,1,121,0,0,0,9,6,6,7,
+11,7,0,0,0,0,0,0,0,0,240,63,1,6,6,7,
+15,5,6,0,15,6,2,0,12,8,0,1,84,0,0,0,
+13,7,8,0,12,8,0,1,121,0,0,0,10,7,8,5,
+12,7,0,1,84,0,0,0,13,5,7,0,12,7,0,2,
+121,105,0,0,10,5,7,6,18,0,0,58,30,11,0,59,
+32,32,32,32,32,32,32,32,101,108,105,102,32,99,32,61,
+61,32,39,32,39,32,111,114,32,99,32,61,61,32,39,92,
+116,39,58,32,105,32,43,61,32,49,0,0,12,6,0,1,
+32,0,0,0,23,5,4,6,46,5,0,0,18,0,0,4,
+12,6,0,1,9,0,0,0,23,5,4,6,21,5,0,0,
+18,0,0,7,11,6,0,0,0,0,0,0,0,0,240,63,
+1,5,2,6,15,2,5,0,18,0,0,30,30,10,0,60,
+32,32,32,32,32,32,32,32,101,108,115,101,58,32,117,95,
+101,114,114,111,114,40,39,116,111,107,101,110,105,122,101,39,
+44,115,44,84,46,102,41,0,12,7,0,7,117,95,101,114,
+114,111,114,0,13,6,7,0,12,7,0,8,116,111,107,101,
+110,105,122,101,0,0,0,0,15,8,1,0,12,10,0,1,
+84,0,0,0,13,9,10,0,12,10,0,1,102,0,0,0,
+9,9,9,10,31,5,7,3,19,5,6,5,18,0,0,1,
+18,0,254,53,30,4,0,61,32,32,32,32,105,110,100,101,
+110,116,40,48,41,0,0,0,12,7,0,6,105,110,100,101,
+110,116,0,0,13,6,7,0,11,7,0,0,0,0,0,0,
+0,0,0,0,31,5,7,1,19,5,6,5,30,6,0,62,
+32,32,32,32,114,32,61,32,84,46,114,101,115,59,32,84,
+32,61,32,78,111,110,101,0,12,7,0,1,84,0,0,0,
+13,6,7,0,12,7,0,3,114,101,115,0,9,6,6,7,
+15,5,6,0,12,6,0,1,84,0,0,0,28,7,0,0,
+14,6,7,0,30,4,0,65,32,32,32,32,114,101,116,117,
+114,110,32,114,0,0,0,0,20,5,0,0,0,0,0,0,
+12,7,0,11,100,111,95,116,111,107,101,110,105,122,101,0,
+14,7,6,0,30,5,0,67,100,101,102,32,100,111,95,110,
+108,40,115,44,105,44,108,41,58,0,0,0,16,7,0,121,
+44,8,0,0,30,5,0,67,100,101,102,32,100,111,95,110,
+108,40,115,44,105,44,108,41,58,0,0,0,12,1,0,11,
+116,111,107,101,110,105,122,101,46,112,121,0,33,1,0,0,
+12,1,0,5,100,111,95,110,108,0,0,0,34,1,0,0,
+28,2,0,0,9,1,0,2,28,3,0,0,9,2,0,3,
+28,4,0,0,9,3,0,4,30,6,0,68,32,32,32,32,
+105,102,32,110,111,116,32,84,46,98,114,97,99,101,115,58,
+0,0,0,0,12,6,0,1,84,0,0,0,13,5,6,0,
+12,6,0,6,98,114,97,99,101,115,0,0,9,5,5,6,
+47,4,5,0,21,4,0,0,18,0,0,21,30,7,0,69,
+32,32,32,32,32,32,32,32,84,46,97,100,100,40,39,110,
+108,39,44,78,111,110,101,41,0,0,0,0,12,6,0,1,
+84,0,0,0,13,5,6,0,12,6,0,3,97,100,100,0,
+9,5,5,6,12,6,0,2,110,108,0,0,28,7,0,0,
+31,4,6,2,19,4,5,4,18,0,0,1,30,6,0,70,
+32,32,32,32,105,44,84,46,110,108,32,61,32,105,43,49,
+44,84,114,117,101,0,0,0,11,6,0,0,0,0,0,0,
+0,0,240,63,1,5,2,6,15,4,5,0,11,6,0,0,
+0,0,0,0,0,0,240,63,15,5,6,0,15,2,4,0,
+12,6,0,1,84,0,0,0,13,4,6,0,12,6,0,2,
+110,108,0,0,10,4,6,5,30,6,0,71,32,32,32,32,
+84,46,121,44,84,46,121,105,32,61,32,84,46,121,43,49,
+44,105,0,0,12,6,0,1,84,0,0,0,13,5,6,0,
+12,6,0,1,121,0,0,0,9,5,5,6,11,6,0,0,
+0,0,0,0,0,0,240,63,1,5,5,6,15,4,5,0,
+15,5,2,0,12,7,0,1,84,0,0,0,13,6,7,0,
+12,7,0,1,121,0,0,0,10,6,7,4,12,6,0,1,
+84,0,0,0,13,4,6,0,12,6,0,2,121,105,0,0,
+10,4,6,5,30,4,0,72,32,32,32,32,114,101,116,117,
+114,110,32,105,0,0,0,0,20,2,0,0,0,0,0,0,
+12,8,0,5,100,111,95,110,108,0,0,0,14,8,7,0,
+30,6,0,74,100,101,102,32,100,111,95,105,110,100,101,110,
+116,40,115,44,105,44,108,41,58,0,0,0,16,8,0,144,
+44,10,0,0,30,6,0,74,100,101,102,32,100,111,95,105,
+110,100,101,110,116,40,115,44,105,44,108,41,58,0,0,0,
+12,1,0,11,116,111,107,101,110,105,122,101,46,112,121,0,
+33,1,0,0,12,1,0,9,100,111,95,105,110,100,101,110,
+116,0,0,0,34,1,0,0,28,2,0,0,9,1,0,2,
+28,3,0,0,9,2,0,3,28,4,0,0,9,3,0,4,
+30,3,0,75,32,32,32,32,118,32,61,32,48,0,0,0,
+11,5,0,0,0,0,0,0,0,0,0,0,15,4,5,0,
+30,4,0,76,32,32,32,32,119,104,105,108,101,32,105,60,
+108,58,0,0,25,5,2,3,21,5,0,0,18,0,0,53,
+30,5,0,77,32,32,32,32,32,32,32,32,99,32,61,32,
+115,91,105,93,0,0,0,0,9,6,1,2,15,5,6,0,
+30,11,0,78,32,32,32,32,32,32,32,32,105,102,32,99,
+32,33,61,32,39,32,39,32,97,110,100,32,99,32,33,61,
+32,39,92,116,39,58,32,98,114,101,97,107,0,0,0,0,
+12,7,0,1,32,0,0,0,35,6,5,7,21,6,0,0,
+18,0,0,4,12,7,0,1,9,0,0,0,35,6,5,7,
+21,6,0,0,18,0,0,3,18,0,0,22,18,0,0,1,
+30,6,0,79,32,32,32,32,32,32,32,32,105,44,118,32,
+61,32,105,43,49,44,118,43,49,0,0,0,11,8,0,0,
+0,0,0,0,0,0,240,63,1,7,2,8,15,6,7,0,
+11,9,0,0,0,0,0,0,0,0,240,63,1,8,4,9,
+15,7,8,0,15,2,6,0,15,4,7,0,18,0,255,202,
+30,15,0,80,32,32,32,32,105,102,32,99,32,33,61,32,
+39,92,110,39,32,97,110,100,32,99,32,33,61,32,39,35,
+39,32,97,110,100,32,110,111,116,32,84,46,98,114,97,99,
+101,115,58,32,105,110,100,101,110,116,40,118,41,0,0,0,
+12,7,0,1,10,0,0,0,35,6,5,7,21,6,0,0,
+18,0,0,4,12,7,0,1,35,0,0,0,35,6,5,7,
+21,6,0,0,18,0,0,9,12,8,0,1,84,0,0,0,
+13,7,8,0,12,8,0,6,98,114,97,99,101,115,0,0,
+9,7,7,8,47,6,7,0,21,6,0,0,18,0,0,9,
+12,8,0,6,105,110,100,101,110,116,0,0,13,7,8,0,
+15,8,4,0,31,6,8,1,19,6,7,6,18,0,0,1,
+30,4,0,81,32,32,32,32,114,101,116,117,114,110,32,105,
+0,0,0,0,20,2,0,0,0,0,0,0,12,9,0,9,
+100,111,95,105,110,100,101,110,116,0,0,0,14,9,8,0,
+30,4,0,83,100,101,102,32,105,110,100,101,110,116,40,118,
+41,58,0,0,16,9,0,229,44,8,0,0,30,4,0,83,
+100,101,102,32,105,110,100,101,110,116,40,118,41,58,0,0,
+12,1,0,11,116,111,107,101,110,105,122,101,46,112,121,0,
+33,1,0,0,12,1,0,6,105,110,100,101,110,116,0,0,
+34,1,0,0,28,2,0,0,9,1,0,2,30,8,0,84,
+32,32,32,32,105,102,32,118,32,61,61,32,84,46,105,110,
+100,101,110,116,91,45,49,93,58,32,112,97,115,115,0,0,
+12,4,0,1,84,0,0,0,13,3,4,0,12,4,0,6,
+105,110,100,101,110,116,0,0,9,3,3,4,11,4,0,0,
+0,0,0,0,0,0,240,191,9,3,3,4,23,2,1,3,
+21,2,0,0,18,0,0,3,17,0,0,0,18,0,0,186,
+30,7,0,85,32,32,32,32,101,108,105,102,32,118,32,62,
+32,84,46,105,110,100,101,110,116,91,45,49,93,58,0,0,
+12,3,0,1,84,0,0,0,13,2,3,0,12,3,0,6,
+105,110,100,101,110,116,0,0,9,2,2,3,11,3,0,0,
+0,0,0,0,0,0,240,191,9,2,2,3,25,2,2,1,
+21,2,0,0,18,0,0,44,30,7,0,86,32,32,32,32,
+32,32,32,32,84,46,105,110,100,101,110,116,46,97,112,112,
+101,110,100,40,118,41,0,0,12,4,0,1,84,0,0,0,
+13,3,4,0,12,4,0,6,105,110,100,101,110,116,0,0,
+9,3,3,4,12,4,0,6,97,112,112,101,110,100,0,0,
+9,3,3,4,15,4,1,0,31,2,4,1,19,2,3,2,
+30,7,0,87,32,32,32,32,32,32,32,32,84,46,97,100,
+100,40,39,105,110,100,101,110,116,39,44,118,41,0,0,0,
+12,4,0,1,84,0,0,0,13,3,4,0,12,4,0,3,
+97,100,100,0,9,3,3,4,12,4,0,6,105,110,100,101,
+110,116,0,0,15,5,1,0,31,2,4,2,19,2,3,2,
+18,0,0,121,30,7,0,88,32,32,32,32,101,108,105,102,
+32,118,32,60,32,84,46,105,110,100,101,110,116,91,45,49,
+93,58,0,0,12,4,0,1,84,0,0,0,13,3,4,0,
+12,4,0,6,105,110,100,101,110,116,0,0,9,3,3,4,
+11,4,0,0,0,0,0,0,0,0,240,191,9,3,3,4,
+25,2,1,3,21,2,0,0,18,0,0,99,30,8,0,89,
+32,32,32,32,32,32,32,32,110,32,61,32,84,46,105,110,
+100,101,110,116,46,105,110,100,101,120,40,118,41,0,0,0,
+12,5,0,1,84,0,0,0,13,4,5,0,12,5,0,6,
+105,110,100,101,110,116,0,0,9,4,4,5,12,5,0,5,
+105,110,100,101,120,0,0,0,9,4,4,5,15,5,1,0,
+31,3,5,1,19,3,4,3,15,2,3,0,30,9,0,90,
+32,32,32,32,32,32,32,32,119,104,105,108,101,32,108,101,
+110,40,84,46,105,110,100,101,110,116,41,32,62,32,110,43,
+49,58,0,0,11,4,0,0,0,0,0,0,0,0,240,63,
+1,3,2,4,12,6,0,3,108,101,110,0,13,5,6,0,
+12,7,0,1,84,0,0,0,13,6,7,0,12,7,0,6,
+105,110,100,101,110,116,0,0,9,6,6,7,31,4,6,1,
+19,4,5,4,25,3,3,4,21,3,0,0,18,0,0,45,
+30,8,0,91,32,32,32,32,32,32,32,32,32,32,32,32,
+118,32,61,32,84,46,105,110,100,101,110,116,46,112,111,112,
+40,41,0,0,12,5,0,1,84,0,0,0,13,4,5,0,
+12,5,0,6,105,110,100,101,110,116,0,0,9,4,4,5,
+12,5,0,3,112,111,112,0,9,4,4,5,31,3,0,0,
+19,3,4,3,15,1,3,0,30,8,0,92,32,32,32,32,
+32,32,32,32,32,32,32,32,84,46,97,100,100,40,39,100,
+101,100,101,110,116,39,44,118,41,0,0,0,12,5,0,1,
+84,0,0,0,13,4,5,0,12,5,0,3,97,100,100,0,
+9,4,4,5,12,5,0,6,100,101,100,101,110,116,0,0,
+15,6,1,0,31,3,5,2,19,3,4,3,18,0,255,194,
+18,0,0,1,0,0,0,0,12,10,0,6,105,110,100,101,
+110,116,0,0,14,10,9,0,30,6,0,94,100,101,102,32,
+100,111,95,115,121,109,98,111,108,40,115,44,105,44,108,41,
+58,0,0,0,16,10,1,27,44,13,0,0,30,6,0,94,
+100,101,102,32,100,111,95,115,121,109,98,111,108,40,115,44,
+105,44,108,41,58,0,0,0,12,1,0,11,116,111,107,101,
+110,105,122,101,46,112,121,0,33,1,0,0,12,1,0,9,
+100,111,95,115,121,109,98,111,108,0,0,0,34,1,0,0,
+28,2,0,0,9,1,0,2,28,3,0,0,9,2,0,3,
+28,4,0,0,9,3,0,4,30,5,0,95,32,32,32,32,
+115,121,109,98,111,108,115,32,61,32,91,93,0,0,0,0,
+27,5,0,0,15,4,5,0,30,6,0,96,32,32,32,32,
+118,44,102,44,105,32,61,32,115,91,105,93,44,105,44,105,
+43,49,0,0,9,6,1,2,15,5,6,0,15,6,2,0,
+11,9,0,0,0,0,0,0,0,0,240,63,1,8,2,9,
+15,7,8,0,15,8,5,0,15,5,6,0,15,2,7,0,
+30,10,0,97,32,32,32,32,105,102,32,118,32,105,110,32,
+83,89,77,66,79,76,83,58,32,115,121,109,98,111,108,115,
+46,97,112,112,101,110,100,40,118,41,0,0,12,7,0,7,
+83,89,77,66,79,76,83,0,13,6,7,0,36,6,6,8,
+21,6,0,0,18,0,0,9,12,9,0,6,97,112,112,101,
+110,100,0,0,9,7,4,9,15,9,8,0,31,6,9,1,
+19,6,7,6,18,0,0,1,30,4,0,98,32,32,32,32,
+119,104,105,108,101,32,105,60,108,58,0,0,25,6,2,3,
+21,6,0,0,18,0,0,74,30,5,0,99,32,32,32,32,
+32,32,32,32,99,32,61,32,115,91,105,93,0,0,0,0,
+9,7,1,2,15,6,7,0,30,9,0,100,32,32,32,32,
+32,32,32,32,105,102,32,110,111,116,32,99,32,105,110,32,
+73,83,89,77,66,79,76,83,58,32,98,114,101,97,107,0,
+12,10,0,8,73,83,89,77,66,79,76,83,0,0,0,0,
+13,9,10,0,36,9,9,6,47,7,9,0,21,7,0,0,
+18,0,0,3,18,0,0,46,18,0,0,1,30,6,0,101,
+32,32,32,32,32,32,32,32,118,44,105,32,61,32,118,43,
+99,44,105,43,49,0,0,0,1,9,8,6,15,7,9,0,
+11,11,0,0,0,0,0,0,0,0,240,63,1,10,2,11,
+15,9,10,0,15,8,7,0,15,2,9,0,30,11,0,102,
+32,32,32,32,32,32,32,32,105,102,32,118,32,105,110,32,
+83,89,77,66,79,76,83,58,32,115,121,109,98,111,108,115,
+46,97,112,112,101,110,100,40,118,41,0,0,12,9,0,7,
+83,89,77,66,79,76,83,0,13,7,9,0,36,7,7,8,
+21,7,0,0,18,0,0,9,12,10,0,6,97,112,112,101,
+110,100,0,0,9,9,4,10,15,10,8,0,31,7,10,1,
+19,7,9,7,18,0,0,1,18,0,255,181,30,11,0,103,
+32,32,32,32,118,32,61,32,115,121,109,98,111,108,115,46,
+112,111,112,40,41,59,32,110,32,61,32,108,101,110,40,118,
+41,59,32,105,32,61,32,102,43,110,0,0,12,10,0,3,
+112,111,112,0,9,9,4,10,31,7,0,0,19,7,9,7,
+15,8,7,0,12,11,0,3,108,101,110,0,13,10,11,0,
+15,11,8,0,31,9,11,1,19,9,10,9,15,7,9,0,
+1,9,5,7,15,2,9,0,30,6,0,104,32,32,32,32,
+84,46,97,100,100,40,39,115,121,109,98,111,108,39,44,118,
+41,0,0,0,12,11,0,1,84,0,0,0,13,10,11,0,
+12,11,0,3,97,100,100,0,9,10,10,11,12,11,0,6,
+115,121,109,98,111,108,0,0,15,12,8,0,31,9,11,2,
+19,9,10,9,30,9,0,105,32,32,32,32,105,102,32,118,
+32,105,110,32,66,95,66,69,71,73,78,58,32,84,46,98,
+114,97,99,101,115,32,43,61,32,49,0,0,12,10,0,7,
+66,95,66,69,71,73,78,0,13,9,10,0,36,9,9,8,
+21,9,0,0,18,0,0,20,12,10,0,1,84,0,0,0,
+13,9,10,0,12,11,0,1,84,0,0,0,13,10,11,0,
+12,11,0,6,98,114,97,99,101,115,0,0,9,10,10,11,
+11,11,0,0,0,0,0,0,0,0,240,63,1,10,10,11,
+12,11,0,6,98,114,97,99,101,115,0,0,10,9,11,10,
+18,0,0,1,30,9,0,106,32,32,32,32,105,102,32,118,
+32,105,110,32,66,95,69,78,68,58,32,84,46,98,114,97,
+99,101,115,32,45,61,32,49,0,0,0,0,12,10,0,5,
+66,95,69,78,68,0,0,0,13,9,10,0,36,9,9,8,
+21,9,0,0,18,0,0,20,12,10,0,1,84,0,0,0,
+13,9,10,0,12,11,0,1,84,0,0,0,13,10,11,0,
+12,11,0,6,98,114,97,99,101,115,0,0,9,10,10,11,
+11,11,0,0,0,0,0,0,0,0,240,63,2,10,10,11,
+12,11,0,6,98,114,97,99,101,115,0,0,10,9,11,10,
+18,0,0,1,30,4,0,107,32,32,32,32,114,101,116,117,
+114,110,32,105,0,0,0,0,20,2,0,0,0,0,0,0,
+12,11,0,9,100,111,95,115,121,109,98,111,108,0,0,0,
+14,11,10,0,30,6,0,109,100,101,102,32,100,111,95,110,
+117,109,98,101,114,40,115,44,105,44,108,41,58,0,0,0,
+16,11,0,240,44,10,0,0,30,6,0,109,100,101,102,32,
+100,111,95,110,117,109,98,101,114,40,115,44,105,44,108,41,
+58,0,0,0,12,1,0,11,116,111,107,101,110,105,122,101,
+46,112,121,0,33,1,0,0,12,1,0,9,100,111,95,110,
+117,109,98,101,114,0,0,0,34,1,0,0,28,2,0,0,
+9,1,0,2,28,3,0,0,9,2,0,3,28,4,0,0,
+9,3,0,4,30,7,0,110,32,32,32,32,118,44,105,44,
+99,32,61,115,91,105,93,44,105,43,49,44,115,91,105,93,
+0,0,0,0,9,5,1,2,15,4,5,0,11,7,0,0,
+0,0,0,0,0,0,240,63,1,6,2,7,15,5,6,0,
+9,7,1,2,15,6,7,0,15,7,4,0,15,2,5,0,
+15,4,6,0,30,4,0,111,32,32,32,32,119,104,105,108,
+101,32,105,60,108,58,0,0,25,5,2,3,21,5,0,0,
+18,0,0,74,30,5,0,112,32,32,32,32,32,32,32,32,
+99,32,61,32,115,91,105,93,0,0,0,0,9,5,1,2,
+15,4,5,0,30,20,0,113,32,32,32,32,32,32,32,32,
+105,102,32,40,99,32,60,32,39,48,39,32,111,114,32,99,
+32,62,32,39,57,39,41,32,97,110,100,32,40,99,32,60,
+32,39,97,39,32,111,114,32,99,32,62,32,39,102,39,41,
+32,97,110,100,32,99,32,33,61,32,39,120,39,58,32,98,
+114,101,97,107,0,0,0,0,12,6,0,1,48,0,0,0,
+25,5,4,6,46,5,0,0,18,0,0,4,12,5,0,1,
+57,0,0,0,25,5,5,4,21,5,0,0,18,0,0,9,
+12,6,0,1,97,0,0,0,25,5,4,6,46,5,0,0,
+18,0,0,4,12,5,0,1,102,0,0,0,25,5,5,4,
+21,5,0,0,18,0,0,4,12,6,0,1,120,0,0,0,
+35,5,4,6,21,5,0,0,18,0,0,3,18,0,0,19,
+18,0,0,1,30,6,0,114,32,32,32,32,32,32,32,32,
+118,44,105,32,61,32,118,43,99,44,105,43,49,0,0,0,
+1,6,7,4,15,5,6,0,11,9,0,0,0,0,0,0,
+0,0,240,63,1,8,2,9,15,6,8,0,15,7,5,0,
+15,2,6,0,18,0,255,181,30,5,0,115,32,32,32,32,
+105,102,32,99,32,61,61,32,39,46,39,58,0,0,0,0,
+12,6,0,1,46,0,0,0,23,5,4,6,21,5,0,0,
+18,0,0,78,30,6,0,116,32,32,32,32,32,32,32,32,
+118,44,105,32,61,32,118,43,99,44,105,43,49,0,0,0,
+1,6,7,4,15,5,6,0,11,9,0,0,0,0,0,0,
+0,0,240,63,1,8,2,9,15,6,8,0,15,7,5,0,
+15,2,6,0,30,5,0,117,32,32,32,32,32,32,32,32,
+119,104,105,108,101,32,105,60,108,58,0,0,25,5,2,3,
+21,5,0,0,18,0,0,52,30,6,0,118,32,32,32,32,
+32,32,32,32,32,32,32,32,99,32,61,32,115,91,105,93,
+0,0,0,0,9,5,1,2,15,4,5,0,30,11,0,119,
+32,32,32,32,32,32,32,32,32,32,32,32,105,102,32,99,
+32,60,32,39,48,39,32,111,114,32,99,32,62,32,39,57,
+39,58,32,98,114,101,97,107,0,0,0,0,12,6,0,1,
+48,0,0,0,25,5,4,6,46,5,0,0,18,0,0,4,
+12,5,0,1,57,0,0,0,25,5,5,4,21,5,0,0,
+18,0,0,3,18,0,0,20,18,0,0,1,30,7,0,120,
+32,32,32,32,32,32,32,32,32,32,32,32,118,44,105,32,
+61,32,118,43,99,44,105,43,49,0,0,0,1,6,7,4,
+15,5,6,0,11,9,0,0,0,0,0,0,0,0,240,63,
+1,8,2,9,15,6,8,0,15,7,5,0,15,2,6,0,
+18,0,255,203,18,0,0,1,30,6,0,121,32,32,32,32,
+84,46,97,100,100,40,39,110,117,109,98,101,114,39,44,118,
+41,0,0,0,12,8,0,1,84,0,0,0,13,6,8,0,
+12,8,0,3,97,100,100,0,9,6,6,8,12,8,0,6,
+110,117,109,98,101,114,0,0,15,9,7,0,31,5,8,2,
+19,5,6,5,30,4,0,122,32,32,32,32,114,101,116,117,
+114,110,32,105,0,0,0,0,20,2,0,0,0,0,0,0,
+12,12,0,9,100,111,95,110,117,109,98,101,114,0,0,0,
+14,12,11,0,30,5,0,124,100,101,102,32,100,111,95,110,
+97,109,101,40,115,44,105,44,108,41,58,0,16,12,0,194,
+44,10,0,0,30,5,0,124,100,101,102,32,100,111,95,110,
+97,109,101,40,115,44,105,44,108,41,58,0,12,1,0,11,
+116,111,107,101,110,105,122,101,46,112,121,0,33,1,0,0,
+12,1,0,7,100,111,95,110,97,109,101,0,34,1,0,0,
+28,2,0,0,9,1,0,2,28,3,0,0,9,2,0,3,
+28,4,0,0,9,3,0,4,30,5,0,125,32,32,32,32,
+118,44,105,32,61,115,91,105,93,44,105,43,49,0,0,0,
+9,5,1,2,15,4,5,0,11,7,0,0,0,0,0,0,
+0,0,240,63,1,6,2,7,15,5,6,0,15,6,4,0,
+15,2,5,0,30,4,0,126,32,32,32,32,119,104,105,108,
+101,32,105,60,108,58,0,0,25,4,2,3,21,4,0,0,
+18,0,0,90,30,5,0,127,32,32,32,32,32,32,32,32,
+99,32,61,32,115,91,105,93,0,0,0,0,9,5,1,2,
+15,4,5,0,30,26,0,128,32,32,32,32,32,32,32,32,
+105,102,32,40,99,32,60,32,39,97,39,32,111,114,32,99,
+32,62,32,39,122,39,41,32,97,110,100,32,40,99,32,60,
+32,39,65,39,32,111,114,32,99,32,62,32,39,90,39,41,
+32,97,110,100,32,40,99,32,60,32,39,48,39,32,111,114,
+32,99,32,62,32,39,57,39,41,32,97,110,100,32,99,32,
+33,61,32,39,95,39,58,32,98,114,101,97,107,0,0,0,
+12,7,0,1,97,0,0,0,25,5,4,7,46,5,0,0,
+18,0,0,4,12,5,0,1,122,0,0,0,25,5,5,4,
+21,5,0,0,18,0,0,9,12,7,0,1,65,0,0,0,
+25,5,4,7,46,5,0,0,18,0,0,4,12,5,0,1,
+90,0,0,0,25,5,5,4,21,5,0,0,18,0,0,9,
+12,7,0,1,48,0,0,0,25,5,4,7,46,5,0,0,
+18,0,0,4,12,5,0,1,57,0,0,0,25,5,5,4,
+21,5,0,0,18,0,0,4,12,7,0,1,95,0,0,0,
+35,5,4,7,21,5,0,0,18,0,0,3,18,0,0,19,
+18,0,0,1,30,6,0,129,32,32,32,32,32,32,32,32,
+118,44,105,32,61,32,118,43,99,44,105,43,49,0,0,0,
+1,7,6,4,15,5,7,0,11,9,0,0,0,0,0,0,
+0,0,240,63,1,8,2,9,15,7,8,0,15,6,5,0,
+15,2,7,0,18,0,255,165,30,10,0,130,32,32,32,32,
+105,102,32,118,32,105,110,32,83,89,77,66,79,76,83,58,
+32,84,46,97,100,100,40,39,115,121,109,98,111,108,39,44,
+118,41,0,0,12,7,0,7,83,89,77,66,79,76,83,0,
+13,5,7,0,36,5,5,6,21,5,0,0,18,0,0,14,
+12,8,0,1,84,0,0,0,13,7,8,0,12,8,0,3,
+97,100,100,0,9,7,7,8,12,8,0,6,115,121,109,98,
+111,108,0,0,15,9,6,0,31,5,8,2,19,5,7,5,
+18,0,0,22,30,7,0,131,32,32,32,32,101,108,115,101,
+58,32,84,46,97,100,100,40,39,110,97,109,101,39,44,118,
+41,0,0,0,12,8,0,1,84,0,0,0,13,7,8,0,
+12,8,0,3,97,100,100,0,9,7,7,8,12,8,0,4,
+110,97,109,101,0,0,0,0,15,9,6,0,31,5,8,2,
+19,5,7,5,18,0,0,1,30,4,0,132,32,32,32,32,
+114,101,116,117,114,110,32,105,0,0,0,0,20,2,0,0,
+0,0,0,0,12,13,0,7,100,111,95,110,97,109,101,0,
+14,13,12,0,30,6,0,134,100,101,102,32,100,111,95,115,
+116,114,105,110,103,40,115,44,105,44,108,41,58,0,0,0,
+16,13,1,240,44,11,0,0,30,6,0,134,100,101,102,32,
+100,111,95,115,116,114,105,110,103,40,115,44,105,44,108,41,
+58,0,0,0,12,1,0,11,116,111,107,101,110,105,122,101,
+46,112,121,0,33,1,0,0,12,1,0,9,100,111,95,115,
+116,114,105,110,103,0,0,0,34,1,0,0,28,2,0,0,
+9,1,0,2,28,3,0,0,9,2,0,3,28,4,0,0,
+9,3,0,4,30,6,0,135,32,32,32,32,118,44,113,44,
+105,32,61,32,39,39,44,115,91,105,93,44,105,43,49,0,
+12,5,0,0,0,0,0,0,15,4,5,0,9,6,1,2,
+15,5,6,0,11,8,0,0,0,0,0,0,0,0,240,63,
+1,7,2,8,15,6,7,0,15,7,4,0,15,4,5,0,
+15,2,6,0,30,14,0,136,32,32,32,32,105,102,32,40,
+108,45,105,41,32,62,61,32,53,32,97,110,100,32,115,91,
+105,93,32,61,61,32,113,32,97,110,100,32,115,91,105,43,
+49,93,32,61,61,32,113,58,32,35,32,34,34,34,0,0,
+11,5,0,0,0,0,0,0,0,0,20,64,2,6,3,2,
+24,5,5,6,21,5,0,0,18,0,0,3,9,5,1,2,
+23,5,5,4,21,5,0,0,18,0,0,7,11,8,0,0,
+0,0,0,0,0,0,240,63,1,6,2,8,9,5,1,6,
+23,5,5,4,21,5,0,0,18,0,0,182,30,4,0,137,
+32,32,32,32,32,32,32,32,105,32,43,61,32,50,0,0,
+11,6,0,0,0,0,0,0,0,0,0,64,1,5,2,6,
+15,2,5,0,30,6,0,138,32,32,32,32,32,32,32,32,
+119,104,105,108,101,32,105,60,108,45,50,58,0,0,0,0,
+11,8,0,0,0,0,0,0,0,0,0,64,2,6,3,8,
+25,5,2,6,21,5,0,0,18,0,0,157,30,6,0,139,
+32,32,32,32,32,32,32,32,32,32,32,32,99,32,61,32,
+115,91,105,93,0,0,0,0,9,6,1,2,15,5,6,0,
+30,14,0,140,32,32,32,32,32,32,32,32,32,32,32,32,
+105,102,32,99,32,61,61,32,113,32,97,110,100,32,115,91,
+105,43,49,93,32,61,61,32,113,32,97,110,100,32,115,91,
+105,43,50,93,32,61,61,32,113,58,0,0,23,6,5,4,
+21,6,0,0,18,0,0,7,11,9,0,0,0,0,0,0,
+0,0,240,63,1,8,2,9,9,6,1,8,23,6,6,4,
+21,6,0,0,18,0,0,7,11,9,0,0,0,0,0,0,
+0,0,0,64,1,8,2,9,9,6,1,8,23,6,6,4,
+21,6,0,0,18,0,0,44,30,6,0,141,32,32,32,32,
+32,32,32,32,32,32,32,32,32,32,32,32,105,32,43,61,
+32,51,0,0,11,8,0,0,0,0,0,0,0,0,8,64,
+1,6,2,8,15,2,6,0,30,9,0,142,32,32,32,32,
+32,32,32,32,32,32,32,32,32,32,32,32,84,46,97,100,
+100,40,39,115,116,114,105,110,103,39,44,118,41,0,0,0,
+12,9,0,1,84,0,0,0,13,8,9,0,12,9,0,3,
+97,100,100,0,9,8,8,9,12,9,0,6,115,116,114,105,
+110,103,0,0,15,10,7,0,31,6,9,2,19,6,8,6,
+30,6,0,143,32,32,32,32,32,32,32,32,32,32,32,32,
+32,32,32,32,98,114,101,97,107,0,0,0,18,0,0,72,
+18,0,0,70,30,5,0,144,32,32,32,32,32,32,32,32,
+32,32,32,32,101,108,115,101,58,0,0,0,30,8,0,145,
+32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,
+118,44,105,32,61,32,118,43,99,44,105,43,49,0,0,0,
+1,8,7,5,15,6,8,0,11,10,0,0,0,0,0,0,
+0,0,240,63,1,9,2,10,15,8,9,0,15,7,6,0,
+15,2,8,0,30,13,0,146,32,32,32,32,32,32,32,32,
+32,32,32,32,32,32,32,32,105,102,32,99,32,61,61,32,
+39,92,110,39,58,32,84,46,121,44,84,46,121,105,32,61,
+32,84,46,121,43,49,44,105,0,0,0,0,12,8,0,1,
+10,0,0,0,23,6,5,8,21,6,0,0,18,0,0,26,
+12,9,0,1,84,0,0,0,13,8,9,0,12,9,0,1,
+121,0,0,0,9,8,8,9,11,9,0,0,0,0,0,0,
+0,0,240,63,1,8,8,9,15,6,8,0,15,8,2,0,
+12,10,0,1,84,0,0,0,13,9,10,0,12,10,0,1,
+121,0,0,0,10,9,10,6,12,9,0,1,84,0,0,0,
+13,6,9,0,12,9,0,2,121,105,0,0,10,6,9,8,
+18,0,0,1,18,0,0,1,18,0,255,94,18,0,0,230,
+30,5,0,148,32,32,32,32,32,32,32,32,119,104,105,108,
+101,32,105,60,108,58,0,0,25,6,2,3,21,6,0,0,
+18,0,0,220,30,6,0,149,32,32,32,32,32,32,32,32,
+32,32,32,32,99,32,61,32,115,91,105,93,0,0,0,0,
+9,6,1,2,15,5,6,0,30,7,0,150,32,32,32,32,
+32,32,32,32,32,32,32,32,105,102,32,99,32,61,61,32,
+34,92,92,34,58,0,0,0,12,8,0,1,92,0,0,0,
+23,6,5,8,21,6,0,0,18,0,0,124,30,9,0,151,
+32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,
+105,32,61,32,105,43,49,59,32,99,32,61,32,115,91,105,
+93,0,0,0,11,8,0,0,0,0,0,0,0,0,240,63,
+1,6,2,8,15,2,6,0,9,6,1,2,15,5,6,0,
+30,10,0,152,32,32,32,32,32,32,32,32,32,32,32,32,
+32,32,32,32,105,102,32,99,32,61,61,32,34,110,34,58,
+32,99,32,61,32,39,92,110,39,0,0,0,12,8,0,1,
+110,0,0,0,23,6,5,8,21,6,0,0,18,0,0,5,
+12,6,0,1,10,0,0,0,15,5,6,0,18,0,0,1,
+30,11,0,153,32,32,32,32,32,32,32,32,32,32,32,32,
+32,32,32,32,105,102,32,99,32,61,61,32,34,114,34,58,
+32,99,32,61,32,99,104,114,40,49,51,41,0,0,0,0,
+12,8,0,1,114,0,0,0,23,6,5,8,21,6,0,0,
+18,0,0,11,12,9,0,3,99,104,114,0,13,8,9,0,
+11,9,0,0,0,0,0,0,0,0,42,64,31,6,9,1,
+19,6,8,6,15,5,6,0,18,0,0,1,30,10,0,154,
+32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,
+105,102,32,99,32,61,61,32,34,116,34,58,32,99,32,61,
+32,34,92,116,34,0,0,0,12,8,0,1,116,0,0,0,
+23,6,5,8,21,6,0,0,18,0,0,5,12,6,0,1,
+9,0,0,0,15,5,6,0,18,0,0,1,30,10,0,155,
+32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,
+105,102,32,99,32,61,61,32,34,48,34,58,32,99,32,61,
+32,34,92,48,34,0,0,0,12,8,0,1,48,0,0,0,
+23,6,5,8,21,6,0,0,18,0,0,5,12,6,0,1,
+0,0,0,0,15,5,6,0,18,0,0,1,30,8,0,156,
+32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,
+118,44,105,32,61,32,118,43,99,44,105,43,49,0,0,0,
+1,8,7,5,15,6,8,0,11,10,0,0,0,0,0,0,
+0,0,240,63,1,9,2,10,15,8,9,0,15,7,6,0,
+15,2,8,0,18,0,0,74,30,7,0,157,32,32,32,32,
+32,32,32,32,32,32,32,32,101,108,105,102,32,99,32,61,
+61,32,113,58,0,0,0,0,23,6,5,4,21,6,0,0,
+18,0,0,44,30,6,0,158,32,32,32,32,32,32,32,32,
+32,32,32,32,32,32,32,32,105,32,43,61,32,49,0,0,
+11,8,0,0,0,0,0,0,0,0,240,63,1,6,2,8,
+15,2,6,0,30,9,0,159,32,32,32,32,32,32,32,32,
+32,32,32,32,32,32,32,32,84,46,97,100,100,40,39,115,
+116,114,105,110,103,39,44,118,41,0,0,0,12,9,0,1,
+84,0,0,0,13,8,9,0,12,9,0,3,97,100,100,0,
+9,8,8,9,12,9,0,6,115,116,114,105,110,103,0,0,
+15,10,7,0,31,6,9,2,19,6,8,6,30,6,0,160,
+32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,
+98,114,101,97,107,0,0,0,18,0,0,22,18,0,0,20,
+30,8,0,162,32,32,32,32,32,32,32,32,32,32,32,32,
+32,32,32,32,118,44,105,32,61,32,118,43,99,44,105,43,
+49,0,0,0,1,8,7,5,15,6,8,0,11,10,0,0,
+0,0,0,0,0,0,240,63,1,9,2,10,15,8,9,0,
+15,7,6,0,15,2,8,0,18,0,0,1,18,0,255,35,
+18,0,0,1,30,4,0,163,32,32,32,32,114,101,116,117,
+114,110,32,105,0,0,0,0,20,2,0,0,0,0,0,0,
+12,14,0,9,100,111,95,115,116,114,105,110,103,0,0,0,
+14,14,13,0,30,6,0,165,100,101,102,32,100,111,95,99,
+111,109,109,101,110,116,40,115,44,105,44,108,41,58,0,0,
+16,14,0,83,44,7,0,0,30,6,0,165,100,101,102,32,
+100,111,95,99,111,109,109,101,110,116,40,115,44,105,44,108,
+41,58,0,0,12,1,0,11,116,111,107,101,110,105,122,101,
+46,112,121,0,33,1,0,0,12,1,0,10,100,111,95,99,
+111,109,109,101,110,116,0,0,34,1,0,0,28,2,0,0,
+9,1,0,2,28,3,0,0,9,2,0,3,28,4,0,0,
+9,3,0,4,30,3,0,166,32,32,32,32,105,32,43,61,
+32,49,0,0,11,5,0,0,0,0,0,0,0,0,240,63,
+1,4,2,5,15,2,4,0,30,4,0,167,32,32,32,32,
+119,104,105,108,101,32,105,60,108,58,0,0,25,4,2,3,
+21,4,0,0,18,0,0,35,30,5,0,168,32,32,32,32,
+32,32,32,32,99,32,61,32,115,91,105,93,0,0,0,0,
+9,5,1,2,15,4,5,0,30,7,0,169,32,32,32,32,
+32,32,32,32,105,102,32,99,32,61,61,32,39,92,110,39,
+58,32,98,114,101,97,107,0,12,6,0,1,10,0,0,0,
+23,5,4,6,21,5,0,0,18,0,0,3,18,0,0,13,
+18,0,0,1,30,4,0,170,32,32,32,32,32,32,32,32,
+105,32,43,61,32,49,0,0,11,6,0,0,0,0,0,0,
+0,0,240,63,1,5,2,6,15,2,5,0,18,0,255,220,
+30,4,0,171,32,32,32,32,114,101,116,117,114,110,32,105,
+0,0,0,0,20,2,0,0,0,0,0,0,12,15,0,10,
+100,111,95,99,111,109,109,101,110,116,0,0,14,15,14,0,
+0,0,0,0,
+};
+unsigned char tp_parse[] = {
+44,114,0,0,30,6,0,1,105,109,112,111,114,116,32,116,
+111,107,101,110,105,122,101,44,32,115,121,115,0,0,0,0,
+12,0,0,8,112,97,114,115,101,46,112,121,0,0,0,0,
+33,0,0,0,12,0,0,1,63,0,0,0,34,0,0,0,
+12,2,0,6,105,109,112,111,114,116,0,0,13,1,2,0,
+12,2,0,8,116,111,107,101,110,105,122,101,0,0,0,0,
+31,0,2,1,19,0,1,0,12,1,0,8,116,111,107,101,
+110,105,122,101,0,0,0,0,14,1,0,0,12,2,0,6,
+105,109,112,111,114,116,0,0,13,1,2,0,12,2,0,3,
+115,121,115,0,31,0,2,1,19,0,1,0,12,1,0,3,
+115,121,115,0,14,1,0,0,30,7,0,2,102,114,111,109,
+32,116,111,107,101,110,105,122,101,32,105,109,112,111,114,116,
+32,84,111,107,101,110,0,0,12,2,0,6,105,109,112,111,
+114,116,0,0,13,1,2,0,12,2,0,8,116,111,107,101,
+110,105,122,101,0,0,0,0,31,0,2,1,19,0,1,0,
+12,2,0,8,95,95,100,105,99,116,95,95,0,0,0,0,
+13,1,2,0,12,3,0,5,84,111,107,101,110,0,0,0,
+9,2,0,3,12,0,0,5,84,111,107,101,110,0,0,0,
+10,1,0,2,30,8,0,3,105,102,32,110,111,116,32,34,
+116,105,110,121,112,121,34,32,105,110,32,115,121,115,46,118,
+101,114,115,105,111,110,58,0,12,2,0,3,115,121,115,0,
+13,1,2,0,12,2,0,7,118,101,114,115,105,111,110,0,
+9,1,1,2,12,2,0,6,116,105,110,121,112,121,0,0,
+36,1,1,2,47,0,1,0,21,0,0,0,18,0,0,30,
+30,6,0,4,32,32,32,32,102,114,111,109,32,98,111,111,
+116,32,105,109,112,111,114,116,32,42,0,0,12,2,0,6,
+105,109,112,111,114,116,0,0,13,1,2,0,12,2,0,4,
+98,111,111,116,0,0,0,0,31,0,2,1,19,0,1,0,
+12,3,0,5,109,101,114,103,101,0,0,0,13,2,3,0,
+12,5,0,8,95,95,100,105,99,116,95,95,0,0,0,0,
+13,3,5,0,15,4,0,0,31,1,3,2,19,1,2,1,
+18,0,0,1,30,5,0,6,100,101,102,32,99,104,101,99,
+107,40,116,44,42,118,115,41,58,0,0,0,16,0,0,114,
+44,6,0,0,30,5,0,6,100,101,102,32,99,104,101,99,
+107,40,116,44,42,118,115,41,58,0,0,0,12,1,0,8,
+112,97,114,115,101,46,112,121,0,0,0,0,33,1,0,0,
+12,1,0,5,99,104,101,99,107,0,0,0,34,1,0,0,
+28,2,0,0,9,1,0,2,12,3,0,1,42,0,0,0,
+9,2,0,3,30,9,0,7,32,32,32,32,105,102,32,118,
+115,91,48,93,32,61,61,32,78,111,110,101,58,32,114,101,
+116,117,114,110,32,84,114,117,101,0,0,0,11,4,0,0,
+0,0,0,0,0,0,0,0,9,3,2,4,28,4,0,0,
+23,3,3,4,21,3,0,0,18,0,0,6,11,3,0,0,
+0,0,0,0,0,0,240,63,20,3,0,0,18,0,0,1,
+30,9,0,8,32,32,32,32,105,102,32,116,46,116,121,112,
+101,32,105,110,32,118,115,58,32,114,101,116,117,114,110,32,
+84,114,117,101,0,0,0,0,12,5,0,4,116,121,112,101,
+0,0,0,0,9,4,1,5,36,3,2,4,21,3,0,0,
+18,0,0,6,11,3,0,0,0,0,0,0,0,0,240,63,
+20,3,0,0,18,0,0,1,30,14,0,9,32,32,32,32,
+105,102,32,116,46,116,121,112,101,32,61,61,32,39,115,121,
+109,98,111,108,39,32,97,110,100,32,116,46,118,97,108,32,
+105,110,32,118,115,58,32,114,101,116,117,114,110,32,84,114,
+117,101,0,0,12,4,0,4,116,121,112,101,0,0,0,0,
+9,3,1,4,12,4,0,6,115,121,109,98,111,108,0,0,
+23,3,3,4,21,3,0,0,18,0,0,5,12,5,0,3,
+118,97,108,0,9,4,1,5,36,3,2,4,21,3,0,0,
+18,0,0,6,11,3,0,0,0,0,0,0,0,0,240,63,
+20,3,0,0,18,0,0,1,30,5,0,10,32,32,32,32,
+114,101,116,117,114,110,32,70,97,108,115,101,0,0,0,0,
+11,3,0,0,0,0,0,0,0,0,0,0,20,3,0,0,
+0,0,0,0,12,1,0,5,99,104,101,99,107,0,0,0,
+14,1,0,0,30,4,0,12,100,101,102,32,116,119,101,97,
+107,40,107,44,118,41,58,0,16,1,0,101,44,10,0,0,
+30,4,0,12,100,101,102,32,116,119,101,97,107,40,107,44,
+118,41,58,0,12,1,0,8,112,97,114,115,101,46,112,121,
+0,0,0,0,33,1,0,0,12,1,0,5,116,119,101,97,
+107,0,0,0,34,1,0,0,28,2,0,0,9,1,0,2,
+28,3,0,0,9,2,0,3,30,8,0,13,32,32,32,32,
+80,46,115,116,97,99,107,46,97,112,112,101,110,100,40,40,
+107,44,100,109,97,112,91,107,93,41,41,0,12,5,0,1,
+80,0,0,0,13,4,5,0,12,5,0,5,115,116,97,99,
+107,0,0,0,9,4,4,5,12,5,0,6,97,112,112,101,
+110,100,0,0,9,4,4,5,15,6,1,0,12,8,0,4,
+100,109,97,112,0,0,0,0,13,7,8,0,9,7,7,1,
+27,5,6,2,31,3,5,1,19,3,4,3,30,7,0,14,
+32,32,32,32,105,102,32,118,58,32,100,109,97,112,91,107,
+93,32,61,32,111,109,97,112,91,107,93,0,21,2,0,0,
+18,0,0,12,12,4,0,4,100,109,97,112,0,0,0,0,
+13,3,4,0,12,5,0,4,111,109,97,112,0,0,0,0,
+13,4,5,0,9,4,4,1,10,3,1,4,18,0,0,31,
+30,11,0,15,32,32,32,32,101,108,115,101,58,32,100,109,
+97,112,91,107,93,32,61,32,123,39,108,98,112,39,58,48,
+44,39,110,117,100,39,58,105,116,115,101,108,102,125,0,0,
+12,4,0,4,100,109,97,112,0,0,0,0,13,3,4,0,
+12,5,0,3,108,98,112,0,11,6,0,0,0,0,0,0,
+0,0,0,0,12,7,0,3,110,117,100,0,12,9,0,6,
+105,116,115,101,108,102,0,0,13,8,9,0,26,4,5,4,
+10,3,1,4,18,0,0,1,0,0,0,0,12,2,0,5,
+116,119,101,97,107,0,0,0,14,2,1,0,30,4,0,16,
+100,101,102,32,114,101,115,116,111,114,101,40,41,58,0,0,
+16,2,0,56,44,6,0,0,30,4,0,16,100,101,102,32,
+114,101,115,116,111,114,101,40,41,58,0,0,12,1,0,8,
+112,97,114,115,101,46,112,121,0,0,0,0,33,1,0,0,
+12,1,0,7,114,101,115,116,111,114,101,0,34,1,0,0,
+30,6,0,17,32,32,32,32,107,44,118,32,61,32,80,46,
+115,116,97,99,107,46,112,111,112,40,41,0,12,3,0,1,
+80,0,0,0,13,2,3,0,12,3,0,5,115,116,97,99,
+107,0,0,0,9,2,2,3,12,3,0,3,112,111,112,0,
+9,2,2,3,31,1,0,0,19,1,2,1,11,4,0,0,
+0,0,0,0,0,0,0,0,9,3,1,4,15,2,3,0,
+11,5,0,0,0,0,0,0,0,0,240,63,9,4,1,5,
+15,3,4,0,30,4,0,18,32,32,32,32,100,109,97,112,
+91,107,93,32,61,32,118,0,12,4,0,4,100,109,97,112,
+0,0,0,0,13,1,4,0,10,1,2,3,0,0,0,0,
+12,3,0,7,114,101,115,116,111,114,101,0,14,3,2,0,
+30,3,0,20,100,101,102,32,99,112,121,40,100,41,58,0,
+16,3,0,45,44,6,0,0,30,3,0,20,100,101,102,32,
+99,112,121,40,100,41,58,0,12,1,0,8,112,97,114,115,
+101,46,112,121,0,0,0,0,33,1,0,0,12,1,0,3,
+99,112,121,0,34,1,0,0,28,2,0,0,9,1,0,2,
+30,3,0,21,32,32,32,32,114,32,61,32,123,125,0,0,
+26,3,0,0,15,2,3,0,30,7,0,22,32,32,32,32,
+102,111,114,32,107,32,105,110,32,100,58,32,114,91,107,93,
+32,61,32,100,91,107,93,0,11,4,0,0,0,0,0,0,
+0,0,0,0,42,3,1,4,18,0,0,4,9,5,1,3,
+10,2,3,5,18,0,255,252,30,4,0,23,32,32,32,32,
+114,101,116,117,114,110,32,114,0,0,0,0,20,2,0,0,
+0,0,0,0,12,4,0,3,99,112,121,0,14,4,3,0,
+30,4,0,25,99,108,97,115,115,32,80,68,97,116,97,58,
+0,0,0,0,26,4,0,0,12,5,0,5,80,68,97,116,
+97,0,0,0,14,5,4,0,12,7,0,7,115,101,116,109,
+101,116,97,0,13,6,7,0,15,7,4,0,12,9,0,6,
+111,98,106,101,99,116,0,0,13,8,9,0,31,5,7,2,
+19,5,6,5,16,5,0,105,44,6,0,0,30,9,0,26,
+32,32,32,32,100,101,102,32,95,95,105,110,105,116,95,95,
+40,115,101,108,102,44,115,44,116,111,107,101,110,115,41,58,
+0,0,0,0,12,1,0,8,112,97,114,115,101,46,112,121,
+0,0,0,0,33,1,0,0,12,1,0,8,95,95,105,110,
+105,116,95,95,0,0,0,0,34,1,0,0,28,2,0,0,
+9,1,0,2,28,3,0,0,9,2,0,3,28,4,0,0,
+9,3,0,4,30,5,0,27,32,32,32,32,32,32,32,32,
+115,101,108,102,46,115,32,61,32,115,0,0,12,4,0,1,
+115,0,0,0,10,1,4,2,30,8,0,28,32,32,32,32,
+32,32,32,32,115,101,108,102,46,116,111,107,101,110,115,32,
+61,32,116,111,107,101,110,115,0,0,0,0,12,4,0,6,
+116,111,107,101,110,115,0,0,10,1,4,3,30,6,0,29,
+32,32,32,32,32,32,32,32,115,101,108,102,46,112,111,115,
+32,61,32,48,0,0,0,0,11,4,0,0,0,0,0,0,
+0,0,0,0,12,5,0,3,112,111,115,0,10,1,5,4,
+30,7,0,30,32,32,32,32,32,32,32,32,115,101,108,102,
+46,116,111,107,101,110,32,61,32,78,111,110,101,0,0,0,
+28,4,0,0,12,5,0,5,116,111,107,101,110,0,0,0,
+10,1,5,4,30,6,0,31,32,32,32,32,32,32,32,32,
+115,101,108,102,46,115,116,97,99,107,32,61,32,91,93,0,
+27,4,0,0,12,5,0,5,115,116,97,99,107,0,0,0,
+10,1,5,4,30,7,0,32,32,32,32,32,32,32,32,32,
+115,101,108,102,46,95,116,101,114,109,105,110,97,108,32,61,
+32,48,0,0,11,4,0,0,0,0,0,0,0,0,0,0,
+12,5,0,9,95,116,101,114,109,105,110,97,108,0,0,0,
+10,1,5,4,0,0,0,0,12,6,0,8,95,95,105,110,
+105,116,95,95,0,0,0,0,10,4,6,5,16,6,0,87,
+44,7,0,0,30,5,0,33,32,32,32,32,100,101,102,32,
+105,110,105,116,40,115,101,108,102,41,58,0,12,1,0,8,
+112,97,114,115,101,46,112,121,0,0,0,0,33,1,0,0,
+12,1,0,4,105,110,105,116,0,0,0,0,34,1,0,0,
+28,2,0,0,9,1,0,2,30,7,0,34,32,32,32,32,
+32,32,32,32,103,108,111,98,97,108,32,111,109,97,112,44,
+100,109,97,112,0,0,0,0,30,8,0,35,32,32,32,32,
+32,32,32,32,111,109,97,112,32,61,32,99,112,121,40,98,
+97,115,101,95,100,109,97,112,41,0,0,0,12,2,0,4,
+111,109,97,112,0,0,0,0,12,5,0,3,99,112,121,0,
+13,4,5,0,12,6,0,9,98,97,115,101,95,100,109,97,
+112,0,0,0,13,5,6,0,31,3,5,1,19,3,4,3,
+14,2,3,0,30,8,0,36,32,32,32,32,32,32,32,32,
+100,109,97,112,32,61,32,99,112,121,40,98,97,115,101,95,
+100,109,97,112,41,0,0,0,12,2,0,4,100,109,97,112,
+0,0,0,0,12,5,0,3,99,112,121,0,13,4,5,0,
+12,6,0,9,98,97,115,101,95,100,109,97,112,0,0,0,
+13,5,6,0,31,3,5,1,19,3,4,3,14,2,3,0,
+30,6,0,37,32,32,32,32,32,32,32,32,115,101,108,102,
+46,97,100,118,97,110,99,101,40,41,0,0,12,4,0,7,
+97,100,118,97,110,99,101,0,9,3,1,4,31,2,0,0,
+19,2,3,2,0,0,0,0,12,7,0,4,105,110,105,116,
+0,0,0,0,10,4,7,6,16,7,1,21,44,12,0,0,
+30,8,0,38,32,32,32,32,100,101,102,32,97,100,118,97,
+110,99,101,40,115,101,108,102,44,118,97,108,61,78,111,110,
+101,41,58,0,12,1,0,8,112,97,114,115,101,46,112,121,
+0,0,0,0,33,1,0,0,12,1,0,7,97,100,118,97,
+110,99,101,0,34,1,0,0,28,2,0,0,9,1,0,2,
+28,2,0,0,28,3,0,0,32,2,0,3,30,10,0,39,
+32,32,32,32,32,32,32,32,105,102,32,110,111,116,32,99,
+104,101,99,107,40,115,101,108,102,46,116,111,107,101,110,44,
+118,97,108,41,58,0,0,0,12,6,0,5,99,104,101,99,
+107,0,0,0,13,5,6,0,12,8,0,5,116,111,107,101,
+110,0,0,0,9,6,1,8,15,7,2,0,31,4,6,2,
+19,4,5,4,47,3,4,0,21,3,0,0,18,0,0,30,
+30,12,0,40,32,32,32,32,32,32,32,32,32,32,32,32,
+101,114,114,111,114,40,39,101,120,112,101,99,116,101,100,32,
+39,43,118,97,108,44,115,101,108,102,46,116,111,107,101,110,
+41,0,0,0,12,5,0,5,101,114,114,111,114,0,0,0,
+13,4,5,0,12,5,0,9,101,120,112,101,99,116,101,100,
+32,0,0,0,1,5,5,2,12,7,0,5,116,111,107,101,
+110,0,0,0,9,6,1,7,31,3,5,2,19,3,4,3,
+18,0,0,1,30,10,0,41,32,32,32,32,32,32,32,32,
+105,102,32,115,101,108,102,46,112,111,115,32,60,32,108,101,
+110,40,115,101,108,102,46,116,111,107,101,110,115,41,58,0,
+12,4,0,3,112,111,115,0,9,3,1,4,12,6,0,3,
+108,101,110,0,13,5,6,0,12,7,0,6,116,111,107,101,
+110,115,0,0,9,6,1,7,31,4,6,1,19,4,5,4,
+25,3,3,4,21,3,0,0,18,0,0,40,30,10,0,42,
+32,32,32,32,32,32,32,32,32,32,32,32,116,32,61,32,
+115,101,108,102,46,116,111,107,101,110,115,91,115,101,108,102,
+46,112,111,115,93,0,0,0,12,5,0,6,116,111,107,101,
+110,115,0,0,9,4,1,5,12,6,0,3,112,111,115,0,
+9,5,1,6,9,4,4,5,15,3,4,0,30,7,0,43,
+32,32,32,32,32,32,32,32,32,32,32,32,115,101,108,102,
+46,112,111,115,32,43,61,32,49,0,0,0,12,5,0,3,
+112,111,115,0,9,4,1,5,11,5,0,0,0,0,0,0,
+0,0,240,63,1,4,4,5,12,5,0,3,112,111,115,0,
+10,1,5,4,18,0,0,32,30,11,0,45,32,32,32,32,
+32,32,32,32,32,32,32,32,116,32,61,32,84,111,107,101,
+110,40,40,48,44,48,41,44,39,101,111,102,39,44,39,101,
+111,102,39,41,0,0,0,0,12,6,0,5,84,111,107,101,
+110,0,0,0,13,5,6,0,11,9,0,0,0,0,0,0,
+0,0,0,0,11,10,0,0,0,0,0,0,0,0,0,0,
+27,6,9,2,12,7,0,3,101,111,102,0,12,8,0,3,
+101,111,102,0,31,4,6,3,19,4,5,4,15,3,4,0,
+18,0,0,1,30,7,0,46,32,32,32,32,32,32,32,32,
+115,101,108,102,46,116,111,107,101,110,32,61,32,100,111,40,
+116,41,0,0,12,6,0,2,100,111,0,0,13,5,6,0,
+15,6,3,0,31,4,6,1,19,4,5,4,12,5,0,5,
+116,111,107,101,110,0,0,0,10,1,5,4,30,7,0,48,
+32,32,32,32,32,32,32,32,115,101,108,102,46,95,116,101,
+114,109,105,110,97,108,32,43,61,32,49,0,12,5,0,9,
+95,116,101,114,109,105,110,97,108,0,0,0,9,4,1,5,
+11,5,0,0,0,0,0,0,0,0,240,63,1,4,4,5,
+12,5,0,9,95,116,101,114,109,105,110,97,108,0,0,0,
+10,1,5,4,30,14,0,49,32,32,32,32,32,32,32,32,
+105,102,32,99,104,101,99,107,40,115,101,108,102,46,116,111,
+107,101,110,44,39,110,108,39,44,39,101,111,102,39,44,39,
+59,39,44,39,100,101,100,101,110,116,39,41,58,0,0,0,
+12,6,0,5,99,104,101,99,107,0,0,0,13,5,6,0,
+12,11,0,5,116,111,107,101,110,0,0,0,9,6,1,11,
+12,7,0,2,110,108,0,0,12,8,0,3,101,111,102,0,
+12,9,0,1,59,0,0,0,12,10,0,6,100,101,100,101,
+110,116,0,0,31,4,6,5,19,4,5,4,21,4,0,0,
+18,0,0,19,30,8,0,50,32,32,32,32,32,32,32,32,
+32,32,32,32,115,101,108,102,46,95,116,101,114,109,105,110,
+97,108,32,61,32,48,0,0,11,4,0,0,0,0,0,0,
+0,0,0,0,12,5,0,9,95,116,101,114,109,105,110,97,
+108,0,0,0,10,1,5,4,18,0,0,1,30,5,0,51,
+32,32,32,32,32,32,32,32,114,101,116,117,114,110,32,116,
+0,0,0,0,20,3,0,0,0,0,0,0,12,8,0,7,
+97,100,118,97,110,99,101,0,10,4,8,7,16,8,0,73,
+44,7,0,0,30,6,0,53,32,32,32,32,100,101,102,32,
+116,101,114,109,105,110,97,108,40,115,101,108,102,41,58,0,
+12,1,0,8,112,97,114,115,101,46,112,121,0,0,0,0,
+33,1,0,0,12,1,0,8,116,101,114,109,105,110,97,108,
+0,0,0,0,34,1,0,0,28,2,0,0,9,1,0,2,
+30,8,0,54,32,32,32,32,32,32,32,32,105,102,32,115,
+101,108,102,46,95,116,101,114,109,105,110,97,108,32,62,32,
+49,58,0,0,11,2,0,0,0,0,0,0,0,0,240,63,
+12,4,0,9,95,116,101,114,109,105,110,97,108,0,0,0,
+9,3,1,4,25,2,2,3,21,2,0,0,18,0,0,32,
+30,13,0,55,32,32,32,32,32,32,32,32,32,32,32,32,
+101,114,114,111,114,40,39,105,110,118,97,108,105,100,32,115,
+116,97,116,101,109,101,110,116,39,44,115,101,108,102,46,116,
+111,107,101,110,41,0,0,0,12,4,0,5,101,114,114,111,
+114,0,0,0,13,3,4,0,12,4,0,17,105,110,118,97,
+108,105,100,32,115,116,97,116,101,109,101,110,116,0,0,0,
+12,6,0,5,116,111,107,101,110,0,0,0,9,5,1,6,
+31,2,4,2,19,2,3,2,18,0,0,1,0,0,0,0,
+12,9,0,8,116,101,114,109,105,110,97,108,0,0,0,0,
+10,4,9,8,30,5,0,57,100,101,102,32,101,114,114,111,
+114,40,99,116,120,44,116,41,58,0,0,0,16,4,0,53,
+44,9,0,0,30,5,0,57,100,101,102,32,101,114,114,111,
+114,40,99,116,120,44,116,41,58,0,0,0,12,1,0,8,
+112,97,114,115,101,46,112,121,0,0,0,0,33,1,0,0,
+12,1,0,5,101,114,114,111,114,0,0,0,34,1,0,0,
+28,2,0,0,9,1,0,2,28,3,0,0,9,2,0,3,
+30,9,0,58,32,32,32,32,116,111,107,101,110,105,122,101,
+46,117,95,101,114,114,111,114,40,99,116,120,44,80,46,115,
+44,116,46,112,111,115,41,0,12,5,0,8,116,111,107,101,
+110,105,122,101,0,0,0,0,13,4,5,0,12,5,0,7,
+117,95,101,114,114,111,114,0,9,4,4,5,15,5,1,0,
+12,8,0,1,80,0,0,0,13,6,8,0,12,8,0,1,
+115,0,0,0,9,6,6,8,12,8,0,3,112,111,115,0,
+9,7,2,8,31,3,5,3,19,3,4,3,0,0,0,0,
+12,9,0,5,101,114,114,111,114,0,0,0,14,9,4,0,
+30,3,0,60,100,101,102,32,110,117,100,40,116,41,58,0,
+16,9,0,30,44,5,0,0,30,3,0,60,100,101,102,32,
+110,117,100,40,116,41,58,0,12,1,0,8,112,97,114,115,
+101,46,112,121,0,0,0,0,33,1,0,0,12,1,0,3,
+110,117,100,0,34,1,0,0,28,2,0,0,9,1,0,2,
+30,5,0,63,32,32,32,32,114,101,116,117,114,110,32,116,
+46,110,117,100,40,116,41,0,12,4,0,3,110,117,100,0,
+9,3,1,4,15,4,1,0,31,2,4,1,19,2,3,2,
+20,2,0,0,0,0,0,0,12,10,0,3,110,117,100,0,
+14,10,9,0,30,5,0,64,100,101,102,32,108,101,100,40,
+116,44,108,101,102,116,41,58,0,0,0,0,16,10,0,37,
+44,7,0,0,30,5,0,64,100,101,102,32,108,101,100,40,
+116,44,108,101,102,116,41,58,0,0,0,0,12,1,0,8,
+112,97,114,115,101,46,112,121,0,0,0,0,33,1,0,0,
+12,1,0,3,108,101,100,0,34,1,0,0,28,2,0,0,
+9,1,0,2,28,3,0,0,9,2,0,3,30,7,0,67,
+32,32,32,32,114,101,116,117,114,110,32,116,46,108,101,100,
+40,116,44,108,101,102,116,41,0,0,0,0,12,5,0,3,
+108,101,100,0,9,4,1,5,15,5,1,0,15,6,2,0,
+31,3,5,2,19,3,4,3,20,3,0,0,0,0,0,0,
+12,11,0,3,108,101,100,0,14,11,10,0,30,4,0,68,
+100,101,102,32,103,101,116,95,108,98,112,40,116,41,58,0,
+16,11,0,29,44,4,0,0,30,4,0,68,100,101,102,32,
+103,101,116,95,108,98,112,40,116,41,58,0,12,1,0,8,
+112,97,114,115,101,46,112,121,0,0,0,0,33,1,0,0,
+12,1,0,7,103,101,116,95,108,98,112,0,34,1,0,0,
+28,2,0,0,9,1,0,2,30,5,0,71,32,32,32,32,
+114,101,116,117,114,110,32,116,46,108,98,112,0,0,0,0,
+12,3,0,3,108,98,112,0,9,2,1,3,20,2,0,0,
+0,0,0,0,12,12,0,7,103,101,116,95,108,98,112,0,
+14,12,11,0,30,5,0,72,100,101,102,32,103,101,116,95,
+105,116,101,109,115,40,116,41,58,0,0,0,16,12,0,32,
+44,4,0,0,30,5,0,72,100,101,102,32,103,101,116,95,
+105,116,101,109,115,40,116,41,58,0,0,0,12,1,0,8,
+112,97,114,115,101,46,112,121,0,0,0,0,33,1,0,0,
+12,1,0,9,103,101,116,95,105,116,101,109,115,0,0,0,
+34,1,0,0,28,2,0,0,9,1,0,2,30,5,0,75,
+32,32,32,32,114,101,116,117,114,110,32,116,46,105,116,101,
+109,115,0,0,12,3,0,5,105,116,101,109,115,0,0,0,
+9,2,1,3,20,2,0,0,0,0,0,0,12,13,0,9,
+103,101,116,95,105,116,101,109,115,0,0,0,14,13,12,0,
+30,6,0,77,100,101,102,32,101,120,112,114,101,115,115,105,
+111,110,40,114,98,112,41,58,0,0,0,0,16,13,0,134,
+44,9,0,0,30,6,0,77,100,101,102,32,101,120,112,114,
+101,115,115,105,111,110,40,114,98,112,41,58,0,0,0,0,
+12,1,0,8,112,97,114,115,101,46,112,121,0,0,0,0,
+33,1,0,0,12,1,0,10,101,120,112,114,101,115,115,105,
+111,110,0,0,34,1,0,0,28,2,0,0,9,1,0,2,
+30,4,0,78,32,32,32,32,116,32,61,32,80,46,116,111,
+107,101,110,0,12,4,0,1,80,0,0,0,13,3,4,0,
+12,4,0,5,116,111,107,101,110,0,0,0,9,3,3,4,
+15,2,3,0,30,4,0,79,32,32,32,32,97,100,118,97,
+110,99,101,40,41,0,0,0,12,5,0,7,97,100,118,97,
+110,99,101,0,13,4,5,0,31,3,0,0,19,3,4,3,
+30,5,0,80,32,32,32,32,108,101,102,116,32,61,32,110,
+117,100,40,116,41,0,0,0,12,6,0,3,110,117,100,0,
+13,5,6,0,15,6,2,0,31,4,6,1,19,4,5,4,
+15,3,4,0,30,9,0,81,32,32,32,32,119,104,105,108,
+101,32,114,98,112,32,60,32,103,101,116,95,108,98,112,40,
+80,46,116,111,107,101,110,41,58,0,0,0,12,7,0,7,
+103,101,116,95,108,98,112,0,13,6,7,0,12,8,0,1,
+80,0,0,0,13,7,8,0,12,8,0,5,116,111,107,101,
+110,0,0,0,9,7,7,8,31,5,7,1,19,5,6,5,
+25,4,1,5,21,4,0,0,18,0,0,44,30,5,0,82,
+32,32,32,32,32,32,32,32,116,32,61,32,80,46,116,111,
+107,101,110,0,12,5,0,1,80,0,0,0,13,4,5,0,
+12,5,0,5,116,111,107,101,110,0,0,0,9,4,4,5,
+15,2,4,0,30,5,0,83,32,32,32,32,32,32,32,32,
+97,100,118,97,110,99,101,40,41,0,0,0,12,6,0,7,
+97,100,118,97,110,99,101,0,13,5,6,0,31,4,0,0,
+19,4,5,4,30,7,0,84,32,32,32,32,32,32,32,32,
+108,101,102,116,32,61,32,108,101,100,40,116,44,108,101,102,
+116,41,0,0,12,6,0,3,108,101,100,0,13,5,6,0,
+15,6,2,0,15,7,3,0,31,4,6,2,19,4,5,4,
+15,3,4,0,18,0,255,198,30,4,0,85,32,32,32,32,
+114,101,116,117,114,110,32,108,101,102,116,0,20,3,0,0,
+0,0,0,0,12,14,0,10,101,120,112,114,101,115,115,105,
+111,110,0,0,14,14,13,0,30,6,0,87,100,101,102,32,
+105,110,102,105,120,95,108,101,100,40,116,44,108,101,102,116,
+41,58,0,0,16,14,0,57,44,9,0,0,30,6,0,87,
+100,101,102,32,105,110,102,105,120,95,108,101,100,40,116,44,
+108,101,102,116,41,58,0,0,12,1,0,8,112,97,114,115,
+101,46,112,121,0,0,0,0,33,1,0,0,12,1,0,9,
+105,110,102,105,120,95,108,101,100,0,0,0,34,1,0,0,
+28,2,0,0,9,1,0,2,28,3,0,0,9,2,0,3,
+30,10,0,88,32,32,32,32,116,46,105,116,101,109,115,32,
+61,32,91,108,101,102,116,44,101,120,112,114,101,115,115,105,
+111,110,40,116,46,98,112,41,93,0,0,0,15,4,2,0,
+12,7,0,10,101,120,112,114,101,115,115,105,111,110,0,0,
+13,6,7,0,12,8,0,2,98,112,0,0,9,7,1,8,
+31,5,7,1,19,5,6,5,27,3,4,2,12,4,0,5,
+105,116,101,109,115,0,0,0,10,1,4,3,30,4,0,89,
+32,32,32,32,114,101,116,117,114,110,32,116,0,0,0,0,
+20,1,0,0,0,0,0,0,12,15,0,9,105,110,102,105,
+120,95,108,101,100,0,0,0,14,15,14,0,30,6,0,90,
+100,101,102,32,105,110,102,105,120,95,105,115,40,116,44,108,
+101,102,116,41,58,0,0,0,16,15,0,112,44,9,0,0,
+30,6,0,90,100,101,102,32,105,110,102,105,120,95,105,115,
+40,116,44,108,101,102,116,41,58,0,0,0,12,1,0,8,
+112,97,114,115,101,46,112,121,0,0,0,0,33,1,0,0,
+12,1,0,8,105,110,102,105,120,95,105,115,0,0,0,0,
+34,1,0,0,28,2,0,0,9,1,0,2,28,3,0,0,
+9,2,0,3,30,8,0,91,32,32,32,32,105,102,32,99,
+104,101,99,107,40,80,46,116,111,107,101,110,44,39,110,111,
+116,39,41,58,0,0,0,0,12,5,0,5,99,104,101,99,
+107,0,0,0,13,4,5,0,12,7,0,1,80,0,0,0,
+13,5,7,0,12,7,0,5,116,111,107,101,110,0,0,0,
+9,5,5,7,12,6,0,3,110,111,116,0,31,3,5,2,
+19,3,4,3,21,3,0,0,18,0,0,30,30,6,0,92,
+32,32,32,32,32,32,32,32,116,46,118,97,108,32,61,32,
+39,105,115,110,111,116,39,0,12,3,0,5,105,115,110,111,
+116,0,0,0,12,4,0,3,118,97,108,0,10,1,4,3,
+30,6,0,93,32,32,32,32,32,32,32,32,97,100,118,97,
+110,99,101,40,39,110,111,116,39,41,0,0,12,5,0,7,
+97,100,118,97,110,99,101,0,13,4,5,0,12,5,0,3,
+110,111,116,0,31,3,5,1,19,3,4,3,18,0,0,1,
+30,10,0,94,32,32,32,32,116,46,105,116,101,109,115,32,
+61,32,91,108,101,102,116,44,101,120,112,114,101,115,115,105,
+111,110,40,116,46,98,112,41,93,0,0,0,15,4,2,0,
+12,7,0,10,101,120,112,114,101,115,115,105,111,110,0,0,
+13,6,7,0,12,8,0,2,98,112,0,0,9,7,1,8,
+31,5,7,1,19,5,6,5,27,3,4,2,12,4,0,5,
+105,116,101,109,115,0,0,0,10,1,4,3,30,4,0,95,
+32,32,32,32,114,101,116,117,114,110,32,116,0,0,0,0,
+20,1,0,0,0,0,0,0,12,16,0,8,105,110,102,105,
+120,95,105,115,0,0,0,0,14,16,15,0,30,6,0,96,
+100,101,102,32,105,110,102,105,120,95,110,111,116,40,116,44,
+108,101,102,116,41,58,0,0,16,16,0,83,44,9,0,0,
+30,6,0,96,100,101,102,32,105,110,102,105,120,95,110,111,
+116,40,116,44,108,101,102,116,41,58,0,0,12,1,0,8,
+112,97,114,115,101,46,112,121,0,0,0,0,33,1,0,0,
+12,1,0,9,105,110,102,105,120,95,110,111,116,0,0,0,
+34,1,0,0,28,2,0,0,9,1,0,2,28,3,0,0,
+9,2,0,3,30,5,0,97,32,32,32,32,97,100,118,97,
+110,99,101,40,39,105,110,39,41,0,0,0,12,5,0,7,
+97,100,118,97,110,99,101,0,13,4,5,0,12,5,0,2,
+105,110,0,0,31,3,5,1,19,3,4,3,30,5,0,98,
+32,32,32,32,116,46,118,97,108,32,61,32,39,110,111,116,
+105,110,39,0,12,3,0,5,110,111,116,105,110,0,0,0,
+12,4,0,3,118,97,108,0,10,1,4,3,30,10,0,99,
+32,32,32,32,116,46,105,116,101,109,115,32,61,32,91,108,
+101,102,116,44,101,120,112,114,101,115,115,105,111,110,40,116,
+46,98,112,41,93,0,0,0,15,4,2,0,12,7,0,10,
+101,120,112,114,101,115,115,105,111,110,0,0,13,6,7,0,
+12,8,0,2,98,112,0,0,9,7,1,8,31,5,7,1,
+19,5,6,5,27,3,4,2,12,4,0,5,105,116,101,109,
+115,0,0,0,10,1,4,3,30,4,0,100,32,32,32,32,
+114,101,116,117,114,110,32,116,0,0,0,0,20,1,0,0,
+0,0,0,0,12,17,0,9,105,110,102,105,120,95,110,111,
+116,0,0,0,14,17,16,0,30,7,0,101,100,101,102,32,
+105,110,102,105,120,95,116,117,112,108,101,40,116,44,108,101,
+102,116,41,58,0,0,0,0,16,17,0,121,44,8,0,0,
+30,7,0,101,100,101,102,32,105,110,102,105,120,95,116,117,
+112,108,101,40,116,44,108,101,102,116,41,58,0,0,0,0,
+12,1,0,8,112,97,114,115,101,46,112,121,0,0,0,0,
+33,1,0,0,12,1,0,11,105,110,102,105,120,95,116,117,
+112,108,101,0,34,1,0,0,28,2,0,0,9,1,0,2,
+28,3,0,0,9,2,0,3,30,7,0,102,32,32,32,32,
+114,32,61,32,101,120,112,114,101,115,115,105,111,110,40,116,
+46,98,112,41,0,0,0,0,12,6,0,10,101,120,112,114,
+101,115,115,105,111,110,0,0,13,5,6,0,12,7,0,2,
+98,112,0,0,9,6,1,7,31,4,6,1,19,4,5,4,
+15,3,4,0,30,6,0,103,32,32,32,32,105,102,32,108,
+101,102,116,46,118,97,108,32,61,61,32,39,44,39,58,0,
+12,5,0,3,118,97,108,0,9,4,2,5,12,5,0,1,
+44,0,0,0,23,4,4,5,21,4,0,0,18,0,0,29,
+30,8,0,104,32,32,32,32,32,32,32,32,108,101,102,116,
+46,105,116,101,109,115,46,97,112,112,101,110,100,40,114,41,
+0,0,0,0,12,6,0,5,105,116,101,109,115,0,0,0,
+9,5,2,6,12,6,0,6,97,112,112,101,110,100,0,0,
+9,5,5,6,15,6,3,0,31,4,6,1,19,4,5,4,
+30,5,0,105,32,32,32,32,32,32,32,32,114,101,116,117,
+114,110,32,108,101,102,116,0,20,2,0,0,18,0,0,1,
+30,6,0,106,32,32,32,32,116,46,105,116,101,109,115,32,
+61,32,91,108,101,102,116,44,114,93,0,0,15,5,2,0,
+15,6,3,0,27,4,5,2,12,5,0,5,105,116,101,109,
+115,0,0,0,10,1,5,4,30,6,0,107,32,32,32,32,
+116,46,116,121,112,101,32,61,32,39,116,117,112,108,101,39,
+0,0,0,0,12,4,0,5,116,117,112,108,101,0,0,0,
+12,5,0,4,116,121,112,101,0,0,0,0,10,1,5,4,
+30,4,0,108,32,32,32,32,114,101,116,117,114,110,32,116,
+0,0,0,0,20,1,0,0,0,0,0,0,12,18,0,11,
+105,110,102,105,120,95,116,117,112,108,101,0,14,18,17,0,
+30,3,0,109,100,101,102,32,108,115,116,40,116,41,58,0,
+16,18,0,88,44,8,0,0,30,3,0,109,100,101,102,32,
+108,115,116,40,116,41,58,0,12,1,0,8,112,97,114,115,
+101,46,112,121,0,0,0,0,33,1,0,0,12,1,0,3,
+108,115,116,0,34,1,0,0,28,2,0,0,9,1,0,2,
+30,7,0,110,32,32,32,32,105,102,32,116,32,61,61,32,
+78,111,110,101,58,32,114,101,116,117,114,110,32,91,93,0,
+28,3,0,0,23,2,1,3,21,2,0,0,18,0,0,4,
+27,2,0,0,20,2,0,0,18,0,0,1,30,11,0,111,
+32,32,32,32,105,102,32,99,104,101,99,107,40,116,44,39,
+44,39,44,39,116,117,112,108,101,39,44,39,115,116,97,116,
+101,109,101,110,116,115,39,41,58,0,0,0,12,4,0,5,
+99,104,101,99,107,0,0,0,13,3,4,0,15,4,1,0,
+12,5,0,1,44,0,0,0,12,6,0,5,116,117,112,108,
+101,0,0,0,12,7,0,10,115,116,97,116,101,109,101,110,
+116,115,0,0,31,2,4,4,19,2,3,2,21,2,0,0,
+18,0,0,19,30,7,0,112,32,32,32,32,32,32,32,32,
+114,101,116,117,114,110,32,103,101,116,95,105,116,101,109,115,
+40,116,41,0,12,4,0,9,103,101,116,95,105,116,101,109,
+115,0,0,0,13,3,4,0,15,4,1,0,31,2,4,1,
+19,2,3,2,20,2,0,0,18,0,0,1,30,4,0,113,
+32,32,32,32,114,101,116,117,114,110,32,91,116,93,0,0,
+15,3,1,0,27,2,3,1,20,2,0,0,0,0,0,0,
+12,19,0,3,108,115,116,0,14,19,18,0,30,5,0,114,
+100,101,102,32,105,108,115,116,40,116,121,112,44,116,41,58,
+0,0,0,0,16,19,0,51,44,11,0,0,30,5,0,114,
+100,101,102,32,105,108,115,116,40,116,121,112,44,116,41,58,
+0,0,0,0,12,1,0,8,112,97,114,115,101,46,112,121,
+0,0,0,0,33,1,0,0,12,1,0,4,105,108,115,116,
+0,0,0,0,34,1,0,0,28,2,0,0,9,1,0,2,
+28,3,0,0,9,2,0,3,30,10,0,115,32,32,32,32,
+114,101,116,117,114,110,32,84,111,107,101,110,40,116,46,112,
+111,115,44,116,121,112,44,116,121,112,44,108,115,116,40,116,
+41,41,0,0,12,5,0,5,84,111,107,101,110,0,0,0,
+13,4,5,0,12,9,0,3,112,111,115,0,9,5,2,9,
+15,6,1,0,15,7,1,0,12,10,0,3,108,115,116,0,
+13,9,10,0,15,10,2,0,31,8,10,1,19,8,9,8,
+31,3,5,4,19,3,4,3,20,3,0,0,0,0,0,0,
+12,20,0,4,105,108,115,116,0,0,0,0,14,20,19,0,
+30,6,0,117,100,101,102,32,99,97,108,108,95,108,101,100,
+40,116,44,108,101,102,116,41,58,0,0,0,16,20,0,198,
+44,11,0,0,30,6,0,117,100,101,102,32,99,97,108,108,
+95,108,101,100,40,116,44,108,101,102,116,41,58,0,0,0,
+12,1,0,8,112,97,114,115,101,46,112,121,0,0,0,0,
+33,1,0,0,12,1,0,8,99,97,108,108,95,108,101,100,
+0,0,0,0,34,1,0,0,28,2,0,0,9,1,0,2,
+28,3,0,0,9,2,0,3,30,10,0,118,32,32,32,32,
+114,32,61,32,84,111,107,101,110,40,116,46,112,111,115,44,
+39,99,97,108,108,39,44,39,36,39,44,91,108,101,102,116,
+93,41,0,0,12,6,0,5,84,111,107,101,110,0,0,0,
+13,5,6,0,12,10,0,3,112,111,115,0,9,6,1,10,
+12,7,0,4,99,97,108,108,0,0,0,0,12,8,0,1,
+36,0,0,0,15,10,2,0,27,9,10,1,31,4,6,4,
+19,4,5,4,15,3,4,0,30,9,0,119,32,32,32,32,
+119,104,105,108,101,32,110,111,116,32,99,104,101,99,107,40,
+80,46,116,111,107,101,110,44,39,41,39,41,58,0,0,0,
+12,7,0,5,99,104,101,99,107,0,0,0,13,6,7,0,
+12,9,0,1,80,0,0,0,13,7,9,0,12,9,0,5,
+116,111,107,101,110,0,0,0,9,7,7,9,12,8,0,1,
+41,0,0,0,31,5,7,2,19,5,6,5,47,4,5,0,
+21,4,0,0,18,0,0,99,30,6,0,120,32,32,32,32,
+32,32,32,32,116,119,101,97,107,40,39,44,39,44,48,41,
+0,0,0,0,12,6,0,5,116,119,101,97,107,0,0,0,
+13,5,6,0,12,6,0,1,44,0,0,0,11,7,0,0,
+0,0,0,0,0,0,0,0,31,4,6,2,19,4,5,4,
+30,10,0,121,32,32,32,32,32,32,32,32,114,46,105,116,
+101,109,115,46,97,112,112,101,110,100,40,101,120,112,114,101,
+115,115,105,111,110,40,48,41,41,0,0,0,12,6,0,5,
+105,116,101,109,115,0,0,0,9,5,3,6,12,6,0,6,
+97,112,112,101,110,100,0,0,9,5,5,6,12,8,0,10,
+101,120,112,114,101,115,115,105,111,110,0,0,13,7,8,0,
+11,8,0,0,0,0,0,0,0,0,0,0,31,6,8,1,
+19,6,7,6,31,4,6,1,19,4,5,4,30,11,0,122,
+32,32,32,32,32,32,32,32,105,102,32,80,46,116,111,107,
+101,110,46,118,97,108,32,61,61,32,39,44,39,58,32,97,
+100,118,97,110,99,101,40,39,44,39,41,0,12,5,0,1,
+80,0,0,0,13,4,5,0,12,5,0,5,116,111,107,101,
+110,0,0,0,9,4,4,5,12,5,0,3,118,97,108,0,
+9,4,4,5,12,5,0,1,44,0,0,0,23,4,4,5,
+21,4,0,0,18,0,0,10,12,6,0,7,97,100,118,97,
+110,99,101,0,13,5,6,0,12,6,0,1,44,0,0,0,
+31,4,6,1,19,4,5,4,18,0,0,1,30,5,0,123,
+32,32,32,32,32,32,32,32,114,101,115,116,111,114,101,40,
+41,0,0,0,12,6,0,7,114,101,115,116,111,114,101,0,
+13,5,6,0,31,4,0,0,19,4,5,4,18,0,255,141,
+30,5,0,124,32,32,32,32,97,100,118,97,110,99,101,40,
+34,41,34,41,0,0,0,0,12,6,0,7,97,100,118,97,
+110,99,101,0,13,5,6,0,12,6,0,1,41,0,0,0,
+31,4,6,1,19,4,5,4,30,4,0,125,32,32,32,32,
+114,101,116,117,114,110,32,114,0,0,0,0,20,3,0,0,
+0,0,0,0,12,21,0,8,99,97,108,108,95,108,101,100,
+0,0,0,0,14,21,20,0,30,6,0,126,100,101,102,32,
+103,101,116,95,108,101,100,40,116,44,108,101,102,116,41,58,
+0,0,0,0,16,21,1,148,44,17,0,0,30,6,0,126,
+100,101,102,32,103,101,116,95,108,101,100,40,116,44,108,101,
+102,116,41,58,0,0,0,0,12,1,0,8,112,97,114,115,
+101,46,112,121,0,0,0,0,33,1,0,0,12,1,0,7,
+103,101,116,95,108,101,100,0,34,1,0,0,28,2,0,0,
+9,1,0,2,28,3,0,0,9,2,0,3,30,10,0,127,
+32,32,32,32,114,32,61,32,84,111,107,101,110,40,116,46,
+112,111,115,44,39,103,101,116,39,44,39,46,39,44,91,108,
+101,102,116,93,41,0,0,0,12,6,0,5,84,111,107,101,
+110,0,0,0,13,5,6,0,12,10,0,3,112,111,115,0,
+9,6,1,10,12,7,0,3,103,101,116,0,12,8,0,1,
+46,0,0,0,15,10,2,0,27,9,10,1,31,4,6,4,
+19,4,5,4,15,3,4,0,30,5,0,128,32,32,32,32,
+105,116,101,109,115,32,61,32,32,91,108,101,102,116,93,0,
+15,6,2,0,27,5,6,1,15,4,5,0,30,5,0,129,
+32,32,32,32,109,111,114,101,32,61,32,70,97,108,115,101,
+0,0,0,0,11,6,0,0,0,0,0,0,0,0,0,0,
+15,5,6,0,30,9,0,130,32,32,32,32,119,104,105,108,
+101,32,110,111,116,32,99,104,101,99,107,40,80,46,116,111,
+107,101,110,44,39,93,39,41,58,0,0,0,12,9,0,5,
+99,104,101,99,107,0,0,0,13,8,9,0,12,11,0,1,
+80,0,0,0,13,9,11,0,12,11,0,5,116,111,107,101,
+110,0,0,0,9,9,9,11,12,10,0,1,93,0,0,0,
+31,7,9,2,19,7,8,7,47,6,7,0,21,6,0,0,
+18,0,0,167,30,6,0,131,32,32,32,32,32,32,32,32,
+109,111,114,101,32,61,32,70,97,108,115,101,0,0,0,0,
+11,6,0,0,0,0,0,0,0,0,0,0,15,5,6,0,
+30,8,0,132,32,32,32,32,32,32,32,32,105,102,32,99,
+104,101,99,107,40,80,46,116,111,107,101,110,44,39,58,39,
+41,58,0,0,12,8,0,5,99,104,101,99,107,0,0,0,
+13,7,8,0,12,10,0,1,80,0,0,0,13,8,10,0,
+12,10,0,5,116,111,107,101,110,0,0,0,9,8,8,10,
+12,9,0,1,58,0,0,0,31,6,8,2,19,6,7,6,
+21,6,0,0,18,0,0,47,30,16,0,133,32,32,32,32,
+32,32,32,32,32,32,32,32,105,116,101,109,115,46,97,112,
+112,101,110,100,40,84,111,107,101,110,40,80,46,116,111,107,
+101,110,46,112,111,115,44,39,115,121,109,98,111,108,39,44,
+39,78,111,110,101,39,41,41,0,0,0,0,12,8,0,6,
+97,112,112,101,110,100,0,0,9,7,4,8,12,10,0,5,
+84,111,107,101,110,0,0,0,13,9,10,0,12,13,0,1,
+80,0,0,0,13,10,13,0,12,13,0,5,116,111,107,101,
+110,0,0,0,9,10,10,13,12,13,0,3,112,111,115,0,
+9,10,10,13,12,11,0,6,115,121,109,98,111,108,0,0,
+12,12,0,4,78,111,110,101,0,0,0,0,31,8,10,3,
+19,8,9,8,31,6,8,1,19,6,7,6,18,0,0,29,
+30,10,0,135,32,32,32,32,32,32,32,32,32,32,32,32,
+105,116,101,109,115,46,97,112,112,101,110,100,40,101,120,112,
+114,101,115,115,105,111,110,40,48,41,41,0,12,8,0,6,
+97,112,112,101,110,100,0,0,9,7,4,8,12,10,0,10,
+101,120,112,114,101,115,115,105,111,110,0,0,13,9,10,0,
+11,10,0,0,0,0,0,0,0,0,0,0,31,8,10,1,
+19,8,9,8,31,6,8,1,19,6,7,6,18,0,0,1,
+30,8,0,136,32,32,32,32,32,32,32,32,105,102,32,99,
+104,101,99,107,40,80,46,116,111,107,101,110,44,39,58,39,
+41,58,0,0,12,8,0,5,99,104,101,99,107,0,0,0,
+13,7,8,0,12,10,0,1,80,0,0,0,13,8,10,0,
+12,10,0,5,116,111,107,101,110,0,0,0,9,8,8,10,
+12,9,0,1,58,0,0,0,31,6,8,2,19,6,7,6,
+21,6,0,0,18,0,0,29,30,7,0,137,32,32,32,32,
+32,32,32,32,32,32,32,32,97,100,118,97,110,99,101,40,
+39,58,39,41,0,0,0,0,12,8,0,7,97,100,118,97,
+110,99,101,0,13,7,8,0,12,8,0,1,58,0,0,0,
+31,6,8,1,19,6,7,6,30,6,0,138,32,32,32,32,
+32,32,32,32,32,32,32,32,109,111,114,101,32,61,32,84,
+114,117,101,0,11,6,0,0,0,0,0,0,0,0,240,63,
+15,5,6,0,18,0,0,1,18,0,255,73,30,4,0,139,
+32,32,32,32,105,102,32,109,111,114,101,58,0,0,0,0,
+21,5,0,0,18,0,0,46,30,15,0,140,32,32,32,32,
+32,32,32,32,105,116,101,109,115,46,97,112,112,101,110,100,
+40,84,111,107,101,110,40,80,46,116,111,107,101,110,46,112,
+111,115,44,39,115,121,109,98,111,108,39,44,39,78,111,110,
+101,39,41,41,0,0,0,0,12,8,0,6,97,112,112,101,
+110,100,0,0,9,7,4,8,12,10,0,5,84,111,107,101,
+110,0,0,0,13,9,10,0,12,13,0,1,80,0,0,0,
+13,10,13,0,12,13,0,5,116,111,107,101,110,0,0,0,
+9,10,10,13,12,13,0,3,112,111,115,0,9,10,10,13,
+12,11,0,6,115,121,109,98,111,108,0,0,12,12,0,4,
+78,111,110,101,0,0,0,0,31,8,10,3,19,8,9,8,
+31,6,8,1,19,6,7,6,18,0,0,1,30,6,0,141,
+32,32,32,32,105,102,32,108,101,110,40,105,116,101,109,115,
+41,32,62,32,50,58,0,0,11,6,0,0,0,0,0,0,
+0,0,0,64,12,9,0,3,108,101,110,0,13,8,9,0,
+15,9,4,0,31,7,9,1,19,7,8,7,25,6,6,7,
+21,6,0,0,18,0,0,41,30,15,0,142,32,32,32,32,
+32,32,32,32,105,116,101,109,115,32,61,32,91,108,101,102,
+116,44,84,111,107,101,110,40,116,46,112,111,115,44,39,115,
+108,105,99,101,39,44,39,58,39,44,105,116,101,109,115,91,
+49,58,93,41,93,0,0,0,15,7,2,0,12,10,0,5,
+84,111,107,101,110,0,0,0,13,9,10,0,12,14,0,3,
+112,111,115,0,9,10,1,14,12,11,0,5,115,108,105,99,
+101,0,0,0,12,12,0,1,58,0,0,0,11,15,0,0,
+0,0,0,0,0,0,240,63,28,16,0,0,27,14,15,2,
+9,13,4,14,31,8,10,4,19,8,9,8,27,6,7,2,
+15,4,6,0,18,0,0,1,30,5,0,143,32,32,32,32,
+114,46,105,116,101,109,115,32,61,32,105,116,101,109,115,0,
+12,6,0,5,105,116,101,109,115,0,0,0,10,3,6,4,
+30,5,0,144,32,32,32,32,97,100,118,97,110,99,101,40,
+34,93,34,41,0,0,0,0,12,8,0,7,97,100,118,97,
+110,99,101,0,13,7,8,0,12,8,0,1,93,0,0,0,
+31,6,8,1,19,6,7,6,30,4,0,145,32,32,32,32,
+114,101,116,117,114,110,32,114,0,0,0,0,20,3,0,0,
+0,0,0,0,12,22,0,7,103,101,116,95,108,101,100,0,
+14,22,21,0,30,6,0,146,100,101,102,32,100,111,116,95,
+108,101,100,40,116,44,108,101,102,116,41,58,0,0,0,0,
+16,22,0,76,44,8,0,0,30,6,0,146,100,101,102,32,
+100,111,116,95,108,101,100,40,116,44,108,101,102,116,41,58,
+0,0,0,0,12,1,0,8,112,97,114,115,101,46,112,121,
+0,0,0,0,33,1,0,0,12,1,0,7,100,111,116,95,
+108,101,100,0,34,1,0,0,28,2,0,0,9,1,0,2,
+28,3,0,0,9,2,0,3,30,7,0,147,32,32,32,32,
+114,32,61,32,101,120,112,114,101,115,115,105,111,110,40,116,
+46,98,112,41,0,0,0,0,12,6,0,10,101,120,112,114,
+101,115,115,105,111,110,0,0,13,5,6,0,12,7,0,2,
+98,112,0,0,9,6,1,7,31,4,6,1,19,4,5,4,
+15,3,4,0,30,6,0,148,32,32,32,32,114,46,116,121,
+112,101,32,61,32,39,115,116,114,105,110,103,39,0,0,0,
+12,4,0,6,115,116,114,105,110,103,0,0,12,5,0,4,
+116,121,112,101,0,0,0,0,10,3,5,4,30,6,0,149,
+32,32,32,32,116,46,105,116,101,109,115,32,61,32,91,108,
+101,102,116,44,114,93,0,0,15,5,2,0,15,6,3,0,
+27,4,5,2,12,5,0,5,105,116,101,109,115,0,0,0,
+10,1,5,4,30,4,0,150,32,32,32,32,114,101,116,117,
+114,110,32,116,0,0,0,0,20,1,0,0,0,0,0,0,
+12,23,0,7,100,111,116,95,108,101,100,0,14,23,22,0,
+30,4,0,152,100,101,102,32,105,116,115,101,108,102,40,116,
+41,58,0,0,16,23,0,25,44,3,0,0,30,4,0,152,
+100,101,102,32,105,116,115,101,108,102,40,116,41,58,0,0,
+12,1,0,8,112,97,114,115,101,46,112,121,0,0,0,0,
+33,1,0,0,12,1,0,6,105,116,115,101,108,102,0,0,
+34,1,0,0,28,2,0,0,9,1,0,2,30,4,0,153,
+32,32,32,32,114,101,116,117,114,110,32,116,0,0,0,0,
+20,1,0,0,0,0,0,0,12,24,0,6,105,116,115,101,
+108,102,0,0,14,24,23,0,30,5,0,154,100,101,102,32,
+112,97,114,101,110,95,110,117,100,40,116,41,58,0,0,0,
+16,24,0,87,44,6,0,0,30,5,0,154,100,101,102,32,
+112,97,114,101,110,95,110,117,100,40,116,41,58,0,0,0,
+12,1,0,8,112,97,114,115,101,46,112,121,0,0,0,0,
+33,1,0,0,12,1,0,9,112,97,114,101,110,95,110,117,
+100,0,0,0,34,1,0,0,28,2,0,0,9,1,0,2,
+30,5,0,155,32,32,32,32,116,119,101,97,107,40,39,44,
+39,44,49,41,0,0,0,0,12,4,0,5,116,119,101,97,
+107,0,0,0,13,3,4,0,12,4,0,1,44,0,0,0,
+11,5,0,0,0,0,0,0,0,0,240,63,31,2,4,2,
+19,2,3,2,30,6,0,156,32,32,32,32,114,32,61,32,
+101,120,112,114,101,115,115,105,111,110,40,48,41,0,0,0,
+12,5,0,10,101,120,112,114,101,115,115,105,111,110,0,0,
+13,4,5,0,11,5,0,0,0,0,0,0,0,0,0,0,
+31,3,5,1,19,3,4,3,15,2,3,0,30,4,0,157,
+32,32,32,32,114,101,115,116,111,114,101,40,41,0,0,0,
+12,5,0,7,114,101,115,116,111,114,101,0,13,4,5,0,
+31,3,0,0,19,3,4,3,30,5,0,158,32,32,32,32,
+97,100,118,97,110,99,101,40,39,41,39,41,0,0,0,0,
+12,5,0,7,97,100,118,97,110,99,101,0,13,4,5,0,
+12,5,0,1,41,0,0,0,31,3,5,1,19,3,4,3,
+30,4,0,159,32,32,32,32,114,101,116,117,114,110,32,114,
+0,0,0,0,20,2,0,0,0,0,0,0,12,25,0,9,
+112,97,114,101,110,95,110,117,100,0,0,0,14,25,24,0,
+30,5,0,160,100,101,102,32,108,105,115,116,95,110,117,100,
+40,116,41,58,0,0,0,0,16,25,1,131,44,10,0,0,
+30,5,0,160,100,101,102,32,108,105,115,116,95,110,117,100,
+40,116,41,58,0,0,0,0,12,1,0,8,112,97,114,115,
+101,46,112,121,0,0,0,0,33,1,0,0,12,1,0,8,
+108,105,115,116,95,110,117,100,0,0,0,0,34,1,0,0,
+28,2,0,0,9,1,0,2,30,5,0,161,32,32,32,32,
+116,46,116,121,112,101,32,61,32,39,108,105,115,116,39,0,
+12,2,0,4,108,105,115,116,0,0,0,0,12,3,0,4,
+116,121,112,101,0,0,0,0,10,1,3,2,30,5,0,162,
+32,32,32,32,116,46,118,97,108,32,61,32,39,91,93,39,
+0,0,0,0,12,2,0,2,91,93,0,0,12,3,0,3,
+118,97,108,0,10,1,3,2,30,5,0,163,32,32,32,32,
+116,46,105,116,101,109,115,32,61,32,91,93,0,0,0,0,
+27,2,0,0,12,3,0,5,105,116,101,109,115,0,0,0,
+10,1,3,2,30,5,0,164,32,32,32,32,110,101,120,116,
+32,61,32,80,46,116,111,107,101,110,0,0,12,4,0,1,
+80,0,0,0,13,3,4,0,12,4,0,5,116,111,107,101,
+110,0,0,0,9,3,3,4,15,2,3,0,30,5,0,165,
+32,32,32,32,116,119,101,97,107,40,39,44,39,44,48,41,
+0,0,0,0,12,5,0,5,116,119,101,97,107,0,0,0,
+13,4,5,0,12,5,0,1,44,0,0,0,11,6,0,0,
+0,0,0,0,0,0,0,0,31,3,5,2,19,3,4,3,
+30,10,0,166,32,32,32,32,119,104,105,108,101,32,110,111,
+116,32,99,104,101,99,107,40,80,46,116,111,107,101,110,44,
+39,102,111,114,39,44,39,93,39,41,58,0,12,6,0,5,
+99,104,101,99,107,0,0,0,13,5,6,0,12,9,0,1,
+80,0,0,0,13,6,9,0,12,9,0,5,116,111,107,101,
+110,0,0,0,9,6,6,9,12,7,0,3,102,111,114,0,
+12,8,0,1,93,0,0,0,31,4,6,3,19,4,5,4,
+47,3,4,0,21,3,0,0,18,0,0,76,30,7,0,167,
+32,32,32,32,32,32,32,32,114,32,61,32,101,120,112,114,
+101,115,115,105,111,110,40,48,41,0,0,0,12,6,0,10,
+101,120,112,114,101,115,115,105,111,110,0,0,13,5,6,0,
+11,6,0,0,0,0,0,0,0,0,0,0,31,4,6,1,
+19,4,5,4,15,3,4,0,30,7,0,168,32,32,32,32,
+32,32,32,32,116,46,105,116,101,109,115,46,97,112,112,101,
+110,100,40,114,41,0,0,0,12,6,0,5,105,116,101,109,
+115,0,0,0,9,5,1,6,12,6,0,6,97,112,112,101,
+110,100,0,0,9,5,5,6,15,6,3,0,31,4,6,1,
+19,4,5,4,30,11,0,169,32,32,32,32,32,32,32,32,
+105,102,32,80,46,116,111,107,101,110,46,118,97,108,32,61,
+61,32,39,44,39,58,32,97,100,118,97,110,99,101,40,39,
+44,39,41,0,12,5,0,1,80,0,0,0,13,4,5,0,
+12,5,0,5,116,111,107,101,110,0,0,0,9,4,4,5,
+12,5,0,3,118,97,108,0,9,4,4,5,12,5,0,1,
+44,0,0,0,23,4,4,5,21,4,0,0,18,0,0,10,
+12,6,0,7,97,100,118,97,110,99,101,0,13,5,6,0,
+12,6,0,1,44,0,0,0,31,4,6,1,19,4,5,4,
+18,0,0,1,18,0,255,162,30,8,0,170,32,32,32,32,
+105,102,32,99,104,101,99,107,40,80,46,116,111,107,101,110,
+44,39,102,111,114,39,41,58,0,0,0,0,12,6,0,5,
+99,104,101,99,107,0,0,0,13,5,6,0,12,8,0,1,
+80,0,0,0,13,6,8,0,12,8,0,5,116,111,107,101,
+110,0,0,0,9,6,6,8,12,7,0,3,102,111,114,0,
+31,4,6,2,19,4,5,4,21,4,0,0,18,0,0,138,
+30,6,0,171,32,32,32,32,32,32,32,32,116,46,116,121,
+112,101,32,61,32,39,99,111,109,112,39,0,12,4,0,4,
+99,111,109,112,0,0,0,0,12,5,0,4,116,121,112,101,
+0,0,0,0,10,1,5,4,30,6,0,172,32,32,32,32,
+32,32,32,32,97,100,118,97,110,99,101,40,39,102,111,114,
+39,41,0,0,12,6,0,7,97,100,118,97,110,99,101,0,
+13,5,6,0,12,6,0,3,102,111,114,0,31,4,6,1,
+19,4,5,4,30,6,0,173,32,32,32,32,32,32,32,32,
+116,119,101,97,107,40,39,105,110,39,44,48,41,0,0,0,
+12,6,0,5,116,119,101,97,107,0,0,0,13,5,6,0,
+12,6,0,2,105,110,0,0,11,7,0,0,0,0,0,0,
+0,0,0,0,31,4,6,2,19,4,5,4,30,10,0,174,
+32,32,32,32,32,32,32,32,116,46,105,116,101,109,115,46,
+97,112,112,101,110,100,40,101,120,112,114,101,115,115,105,111,
+110,40,48,41,41,0,0,0,12,6,0,5,105,116,101,109,
+115,0,0,0,9,5,1,6,12,6,0,6,97,112,112,101,
+110,100,0,0,9,5,5,6,12,8,0,10,101,120,112,114,
+101,115,115,105,111,110,0,0,13,7,8,0,11,8,0,0,
+0,0,0,0,0,0,0,0,31,6,8,1,19,6,7,6,
+31,4,6,1,19,4,5,4,30,6,0,175,32,32,32,32,
+32,32,32,32,97,100,118,97,110,99,101,40,39,105,110,39,
+41,0,0,0,12,6,0,7,97,100,118,97,110,99,101,0,
+13,5,6,0,12,6,0,2,105,110,0,0,31,4,6,1,
+19,4,5,4,30,10,0,176,32,32,32,32,32,32,32,32,
+116,46,105,116,101,109,115,46,97,112,112,101,110,100,40,101,
+120,112,114,101,115,115,105,111,110,40,48,41,41,0,0,0,
+12,6,0,5,105,116,101,109,115,0,0,0,9,5,1,6,
+12,6,0,6,97,112,112,101,110,100,0,0,9,5,5,6,
+12,8,0,10,101,120,112,114,101,115,115,105,111,110,0,0,
+13,7,8,0,11,8,0,0,0,0,0,0,0,0,0,0,
+31,6,8,1,19,6,7,6,31,4,6,1,19,4,5,4,
+30,5,0,177,32,32,32,32,32,32,32,32,114,101,115,116,
+111,114,101,40,41,0,0,0,12,6,0,7,114,101,115,116,
+111,114,101,0,13,5,6,0,31,4,0,0,19,4,5,4,
+18,0,0,1,30,4,0,178,32,32,32,32,114,101,115,116,
+111,114,101,40,41,0,0,0,12,6,0,7,114,101,115,116,
+111,114,101,0,13,5,6,0,31,4,0,0,19,4,5,4,
+30,5,0,179,32,32,32,32,97,100,118,97,110,99,101,40,
+39,93,39,41,0,0,0,0,12,6,0,7,97,100,118,97,
+110,99,101,0,13,5,6,0,12,6,0,1,93,0,0,0,
+31,4,6,1,19,4,5,4,30,4,0,180,32,32,32,32,
+114,101,116,117,114,110,32,116,0,0,0,0,20,1,0,0,
+0,0,0,0,12,26,0,8,108,105,115,116,95,110,117,100,
+0,0,0,0,14,26,25,0,30,5,0,181,100,101,102,32,
+100,105,99,116,95,110,117,100,40,116,41,58,0,0,0,0,
+16,26,0,203,44,8,0,0,30,5,0,181,100,101,102,32,
+100,105,99,116,95,110,117,100,40,116,41,58,0,0,0,0,
+12,1,0,8,112,97,114,115,101,46,112,121,0,0,0,0,
+33,1,0,0,12,1,0,8,100,105,99,116,95,110,117,100,
+0,0,0,0,34,1,0,0,28,2,0,0,9,1,0,2,
+30,5,0,182,32,32,32,32,116,46,116,121,112,101,61,39,
+100,105,99,116,39,0,0,0,12,2,0,4,100,105,99,116,
+0,0,0,0,12,3,0,4,116,121,112,101,0,0,0,0,
+10,1,3,2,30,5,0,183,32,32,32,32,116,46,118,97,
+108,32,61,32,39,123,125,39,0,0,0,0,12,2,0,2,
+123,125,0,0,12,3,0,3,118,97,108,0,10,1,3,2,
+30,5,0,184,32,32,32,32,116,46,105,116,101,109,115,32,
+61,32,91,93,0,0,0,0,27,2,0,0,12,3,0,5,
+105,116,101,109,115,0,0,0,10,1,3,2,30,5,0,185,
+32,32,32,32,116,119,101,97,107,40,39,44,39,44,48,41,
+0,0,0,0,12,4,0,5,116,119,101,97,107,0,0,0,
+13,3,4,0,12,4,0,1,44,0,0,0,11,5,0,0,
+0,0,0,0,0,0,0,0,31,2,4,2,19,2,3,2,
+30,9,0,186,32,32,32,32,119,104,105,108,101,32,110,111,
+116,32,99,104,101,99,107,40,80,46,116,111,107,101,110,44,
+39,125,39,41,58,0,0,0,12,5,0,5,99,104,101,99,
+107,0,0,0,13,4,5,0,12,7,0,1,80,0,0,0,
+13,5,7,0,12,7,0,5,116,111,107,101,110,0,0,0,
+9,5,5,7,12,6,0,1,125,0,0,0,31,3,5,2,
+19,3,4,3,47,2,3,0,21,2,0,0,18,0,0,72,
+30,10,0,187,32,32,32,32,32,32,32,32,116,46,105,116,
+101,109,115,46,97,112,112,101,110,100,40,101,120,112,114,101,
+115,115,105,111,110,40,48,41,41,0,0,0,12,4,0,5,
+105,116,101,109,115,0,0,0,9,3,1,4,12,4,0,6,
+97,112,112,101,110,100,0,0,9,3,3,4,12,6,0,10,
+101,120,112,114,101,115,115,105,111,110,0,0,13,5,6,0,
+11,6,0,0,0,0,0,0,0,0,0,0,31,4,6,1,
+19,4,5,4,31,2,4,1,19,2,3,2,30,12,0,188,
+32,32,32,32,32,32,32,32,105,102,32,99,104,101,99,107,
+40,80,46,116,111,107,101,110,44,39,58,39,44,39,44,39,
+41,58,32,97,100,118,97,110,99,101,40,41,0,0,0,0,
+12,4,0,5,99,104,101,99,107,0,0,0,13,3,4,0,
+12,7,0,1,80,0,0,0,13,4,7,0,12,7,0,5,
+116,111,107,101,110,0,0,0,9,4,4,7,12,5,0,1,
+58,0,0,0,12,6,0,1,44,0,0,0,31,2,4,3,
+19,2,3,2,21,2,0,0,18,0,0,8,12,4,0,7,
+97,100,118,97,110,99,101,0,13,3,4,0,31,2,0,0,
+19,2,3,2,18,0,0,1,18,0,255,168,30,4,0,189,
+32,32,32,32,114,101,115,116,111,114,101,40,41,0,0,0,
+12,4,0,7,114,101,115,116,111,114,101,0,13,3,4,0,
+31,2,0,0,19,2,3,2,30,5,0,190,32,32,32,32,
+97,100,118,97,110,99,101,40,39,125,39,41,0,0,0,0,
+12,4,0,7,97,100,118,97,110,99,101,0,13,3,4,0,
+12,4,0,1,125,0,0,0,31,2,4,1,19,2,3,2,
+30,4,0,191,32,32,32,32,114,101,116,117,114,110,32,116,
+0,0,0,0,20,1,0,0,0,0,0,0,12,27,0,8,
+100,105,99,116,95,110,117,100,0,0,0,0,14,27,26,0,
+30,6,0,193,100,101,102,32,97,100,118,97,110,99,101,40,
+116,61,78,111,110,101,41,58,0,0,0,0,16,27,0,40,
+44,5,0,0,30,6,0,193,100,101,102,32,97,100,118,97,
+110,99,101,40,116,61,78,111,110,101,41,58,0,0,0,0,
+12,1,0,8,112,97,114,115,101,46,112,121,0,0,0,0,
+33,1,0,0,12,1,0,7,97,100,118,97,110,99,101,0,
+34,1,0,0,28,1,0,0,28,2,0,0,32,1,0,2,
+30,6,0,194,32,32,32,32,114,101,116,117,114,110,32,80,
+46,97,100,118,97,110,99,101,40,116,41,0,12,4,0,1,
+80,0,0,0,13,3,4,0,12,4,0,7,97,100,118,97,
+110,99,101,0,9,3,3,4,15,4,1,0,31,2,4,1,
+19,2,3,2,20,2,0,0,0,0,0,0,12,28,0,7,
+97,100,118,97,110,99,101,0,14,28,27,0,30,5,0,196,
+100,101,102,32,105,98,108,111,99,107,40,105,116,101,109,115,
+41,58,0,0,16,28,0,188,44,8,0,0,30,5,0,196,
+100,101,102,32,105,98,108,111,99,107,40,105,116,101,109,115,
+41,58,0,0,12,1,0,8,112,97,114,115,101,46,112,121,
+0,0,0,0,33,1,0,0,12,1,0,6,105,98,108,111,
+99,107,0,0,34,1,0,0,28,2,0,0,9,1,0,2,
+30,12,0,197,32,32,32,32,119,104,105,108,101,32,99,104,
+101,99,107,40,80,46,116,111,107,101,110,44,39,110,108,39,
+44,39,59,39,41,58,32,97,100,118,97,110,99,101,40,41,
+0,0,0,0,12,4,0,5,99,104,101,99,107,0,0,0,
+13,3,4,0,12,7,0,1,80,0,0,0,13,4,7,0,
+12,7,0,5,116,111,107,101,110,0,0,0,9,4,4,7,
+12,5,0,2,110,108,0,0,12,6,0,1,59,0,0,0,
+31,2,4,3,19,2,3,2,21,2,0,0,18,0,0,8,
+12,4,0,7,97,100,118,97,110,99,101,0,13,3,4,0,
+31,2,0,0,19,2,3,2,18,0,255,231,30,4,0,198,
+32,32,32,32,119,104,105,108,101,32,84,114,117,101,58,0,
+11,2,0,0,0,0,0,0,0,0,240,63,21,2,0,0,
+18,0,0,120,30,9,0,199,32,32,32,32,32,32,32,32,
+105,116,101,109,115,46,97,112,112,101,110,100,40,101,120,112,
+114,101,115,115,105,111,110,40,48,41,41,0,12,4,0,6,
+97,112,112,101,110,100,0,0,9,3,1,4,12,6,0,10,
+101,120,112,114,101,115,115,105,111,110,0,0,13,5,6,0,
+11,6,0,0,0,0,0,0,0,0,0,0,31,4,6,1,
+19,4,5,4,31,2,4,1,19,2,3,2,30,6,0,200,
+32,32,32,32,32,32,32,32,80,46,116,101,114,109,105,110,
+97,108,40,41,0,0,0,0,12,4,0,1,80,0,0,0,
+13,3,4,0,12,4,0,8,116,101,114,109,105,110,97,108,
+0,0,0,0,9,3,3,4,31,2,0,0,19,2,3,2,
+30,13,0,201,32,32,32,32,32,32,32,32,119,104,105,108,
+101,32,99,104,101,99,107,40,80,46,116,111,107,101,110,44,
+39,110,108,39,44,39,59,39,41,58,32,97,100,118,97,110,
+99,101,40,41,0,0,0,0,12,4,0,5,99,104,101,99,
+107,0,0,0,13,3,4,0,12,7,0,1,80,0,0,0,
+13,4,7,0,12,7,0,5,116,111,107,101,110,0,0,0,
+9,4,4,7,12,5,0,2,110,108,0,0,12,6,0,1,
+59,0,0,0,31,2,4,3,19,2,3,2,21,2,0,0,
+18,0,0,8,12,4,0,7,97,100,118,97,110,99,101,0,
+13,3,4,0,31,2,0,0,19,2,3,2,18,0,255,231,
+30,12,0,202,32,32,32,32,32,32,32,32,105,102,32,99,
+104,101,99,107,40,80,46,116,111,107,101,110,44,39,100,101,
+100,101,110,116,39,44,39,101,111,102,39,41,58,32,98,114,
+101,97,107,0,12,4,0,5,99,104,101,99,107,0,0,0,
+13,3,4,0,12,7,0,1,80,0,0,0,13,4,7,0,
+12,7,0,5,116,111,107,101,110,0,0,0,9,4,4,7,
+12,5,0,6,100,101,100,101,110,116,0,0,12,6,0,3,
+101,111,102,0,31,2,4,3,19,2,3,2,21,2,0,0,
+18,0,0,3,18,0,0,3,18,0,0,1,18,0,255,133,
+0,0,0,0,12,29,0,6,105,98,108,111,99,107,0,0,
+14,29,28,0,30,4,0,204,100,101,102,32,98,108,111,99,
+107,40,41,58,0,0,0,0,16,29,1,113,44,10,0,0,
+30,4,0,204,100,101,102,32,98,108,111,99,107,40,41,58,
+0,0,0,0,12,1,0,8,112,97,114,115,101,46,112,121,
+0,0,0,0,33,1,0,0,12,1,0,5,98,108,111,99,
+107,0,0,0,34,1,0,0,30,4,0,205,32,32,32,32,
+105,116,101,109,115,32,61,32,91,93,0,0,27,2,0,0,
+15,1,2,0,30,5,0,206,32,32,32,32,116,111,107,32,
+61,32,80,46,116,111,107,101,110,0,0,0,12,4,0,1,
+80,0,0,0,13,3,4,0,12,4,0,5,116,111,107,101,
+110,0,0,0,9,3,3,4,15,2,3,0,30,7,0,208,
+32,32,32,32,105,102,32,99,104,101,99,107,40,80,46,116,
+111,107,101,110,44,39,110,108,39,41,58,0,12,5,0,5,
+99,104,101,99,107,0,0,0,13,4,5,0,12,7,0,1,
+80,0,0,0,13,5,7,0,12,7,0,5,116,111,107,101,
+110,0,0,0,9,5,5,7,12,6,0,2,110,108,0,0,
+31,3,5,2,19,3,4,3,21,3,0,0,18,0,0,87,
+30,12,0,209,32,32,32,32,32,32,32,32,119,104,105,108,
+101,32,99,104,101,99,107,40,80,46,116,111,107,101,110,44,
+39,110,108,39,41,58,32,97,100,118,97,110,99,101,40,41,
+0,0,0,0,12,5,0,5,99,104,101,99,107,0,0,0,
+13,4,5,0,12,7,0,1,80,0,0,0,13,5,7,0,
+12,7,0,5,116,111,107,101,110,0,0,0,9,5,5,7,
+12,6,0,2,110,108,0,0,31,3,5,2,19,3,4,3,
+21,3,0,0,18,0,0,8,12,5,0,7,97,100,118,97,
+110,99,101,0,13,4,5,0,31,3,0,0,19,3,4,3,
+18,0,255,233,30,7,0,210,32,32,32,32,32,32,32,32,
+97,100,118,97,110,99,101,40,39,105,110,100,101,110,116,39,
+41,0,0,0,12,5,0,7,97,100,118,97,110,99,101,0,
+13,4,5,0,12,5,0,6,105,110,100,101,110,116,0,0,
+31,3,5,1,19,3,4,3,30,6,0,211,32,32,32,32,
+32,32,32,32,105,98,108,111,99,107,40,105,116,101,109,115,
+41,0,0,0,12,5,0,6,105,98,108,111,99,107,0,0,
+13,4,5,0,15,5,1,0,31,3,5,1,19,3,4,3,
+30,7,0,212,32,32,32,32,32,32,32,32,97,100,118,97,
+110,99,101,40,39,100,101,100,101,110,116,39,41,0,0,0,
+12,5,0,7,97,100,118,97,110,99,101,0,13,4,5,0,
+12,5,0,6,100,101,100,101,110,116,0,0,31,3,5,1,
+19,3,4,3,18,0,0,120,30,3,0,213,32,32,32,32,
+101,108,115,101,58,0,0,0,30,9,0,214,32,32,32,32,
+32,32,32,32,105,116,101,109,115,46,97,112,112,101,110,100,
+40,101,120,112,114,101,115,115,105,111,110,40,48,41,41,0,
+12,5,0,6,97,112,112,101,110,100,0,0,9,4,1,5,
+12,7,0,10,101,120,112,114,101,115,115,105,111,110,0,0,
+13,6,7,0,11,7,0,0,0,0,0,0,0,0,0,0,
+31,5,7,1,19,5,6,5,31,3,5,1,19,3,4,3,
+30,9,0,215,32,32,32,32,32,32,32,32,119,104,105,108,
+101,32,99,104,101,99,107,40,80,46,116,111,107,101,110,44,
+39,59,39,41,58,0,0,0,12,5,0,5,99,104,101,99,
+107,0,0,0,13,4,5,0,12,7,0,1,80,0,0,0,
+13,5,7,0,12,7,0,5,116,111,107,101,110,0,0,0,
+9,5,5,7,12,6,0,1,59,0,0,0,31,3,5,2,
+19,3,4,3,21,3,0,0,18,0,0,45,30,7,0,216,
+32,32,32,32,32,32,32,32,32,32,32,32,97,100,118,97,
+110,99,101,40,39,59,39,41,0,0,0,0,12,5,0,7,
+97,100,118,97,110,99,101,0,13,4,5,0,12,5,0,1,
+59,0,0,0,31,3,5,1,19,3,4,3,30,10,0,217,
+32,32,32,32,32,32,32,32,32,32,32,32,105,116,101,109,
+115,46,97,112,112,101,110,100,40,101,120,112,114,101,115,115,
+105,111,110,40,48,41,41,0,12,5,0,6,97,112,112,101,
+110,100,0,0,9,4,1,5,12,7,0,10,101,120,112,114,
+101,115,115,105,111,110,0,0,13,6,7,0,11,7,0,0,
+0,0,0,0,0,0,0,0,31,5,7,1,19,5,6,5,
+31,3,5,1,19,3,4,3,18,0,255,196,30,6,0,218,
+32,32,32,32,32,32,32,32,80,46,116,101,114,109,105,110,
+97,108,40,41,0,0,0,0,12,5,0,1,80,0,0,0,
+13,4,5,0,12,5,0,8,116,101,114,109,105,110,97,108,
+0,0,0,0,9,4,4,5,31,3,0,0,19,3,4,3,
+18,0,0,1,30,11,0,219,32,32,32,32,119,104,105,108,
+101,32,99,104,101,99,107,40,80,46,116,111,107,101,110,44,
+39,110,108,39,41,58,32,97,100,118,97,110,99,101,40,41,
+0,0,0,0,12,5,0,5,99,104,101,99,107,0,0,0,
+13,4,5,0,12,7,0,1,80,0,0,0,13,5,7,0,
+12,7,0,5,116,111,107,101,110,0,0,0,9,5,5,7,
+12,6,0,2,110,108,0,0,31,3,5,2,19,3,4,3,
+21,3,0,0,18,0,0,8,12,5,0,7,97,100,118,97,
+110,99,101,0,13,4,5,0,31,3,0,0,19,3,4,3,
+18,0,255,233,30,6,0,221,32,32,32,32,105,102,32,108,
+101,110,40,105,116,101,109,115,41,32,62,32,49,58,0,0,
+11,3,0,0,0,0,0,0,0,0,240,63,12,6,0,3,
+108,101,110,0,13,5,6,0,15,6,1,0,31,4,6,1,
+19,4,5,4,25,3,3,4,21,3,0,0,18,0,0,34,
+30,14,0,222,32,32,32,32,32,32,32,32,114,101,116,117,
+114,110,32,84,111,107,101,110,40,116,111,107,46,112,111,115,
+44,39,115,116,97,116,101,109,101,110,116,115,39,44,39,59,
+39,44,105,116,101,109,115,41,0,0,0,0,12,5,0,5,
+84,111,107,101,110,0,0,0,13,4,5,0,12,9,0,3,
+112,111,115,0,9,5,2,9,12,6,0,10,115,116,97,116,
+101,109,101,110,116,115,0,0,12,7,0,1,59,0,0,0,
+15,8,1,0,31,3,5,4,19,3,4,3,20,3,0,0,
+18,0,0,1,30,6,0,223,32,32,32,32,114,101,116,117,
+114,110,32,105,116,101,109,115,46,112,111,112,40,41,0,0,
+12,5,0,3,112,111,112,0,9,4,1,5,31,3,0,0,
+19,3,4,3,20,3,0,0,0,0,0,0,12,30,0,5,
+98,108,111,99,107,0,0,0,14,30,29,0,30,4,0,225,
+100,101,102,32,100,101,102,95,110,117,100,40,116,41,58,0,
+16,30,1,43,44,11,0,0,30,4,0,225,100,101,102,32,
+100,101,102,95,110,117,100,40,116,41,58,0,12,1,0,8,
+112,97,114,115,101,46,112,121,0,0,0,0,33,1,0,0,
+12,1,0,7,100,101,102,95,110,117,100,0,34,1,0,0,
+28,2,0,0,9,1,0,2,30,7,0,226,32,32,32,32,
+105,116,101,109,115,32,61,32,116,46,105,116,101,109,115,32,
+61,32,91,93,0,0,0,0,27,3,0,0,12,4,0,5,
+105,116,101,109,115,0,0,0,10,1,4,3,15,2,3,0,
+30,10,0,227,32,32,32,32,105,116,101,109,115,46,97,112,
+112,101,110,100,40,80,46,116,111,107,101,110,41,59,32,97,
+100,118,97,110,99,101,40,41,0,0,0,0,12,5,0,6,
+97,112,112,101,110,100,0,0,9,4,2,5,12,6,0,1,
+80,0,0,0,13,5,6,0,12,6,0,5,116,111,107,101,
+110,0,0,0,9,5,5,6,31,3,5,1,19,3,4,3,
+12,5,0,7,97,100,118,97,110,99,101,0,13,4,5,0,
+31,3,0,0,19,3,4,3,30,5,0,228,32,32,32,32,
+97,100,118,97,110,99,101,40,39,40,39,41,0,0,0,0,
+12,5,0,7,97,100,118,97,110,99,101,0,13,4,5,0,
+12,5,0,1,40,0,0,0,31,3,5,1,19,3,4,3,
+30,10,0,229,32,32,32,32,114,32,61,32,84,111,107,101,
+110,40,116,46,112,111,115,44,39,115,121,109,98,111,108,39,
+44,39,40,41,58,39,44,91,93,41,0,0,12,6,0,5,
+84,111,107,101,110,0,0,0,13,5,6,0,12,10,0,3,
+112,111,115,0,9,6,1,10,12,7,0,6,115,121,109,98,
+111,108,0,0,12,8,0,3,40,41,58,0,27,9,0,0,
+31,4,6,4,19,4,5,4,15,3,4,0,30,5,0,230,
+32,32,32,32,105,116,101,109,115,46,97,112,112,101,110,100,
+40,114,41,0,12,6,0,6,97,112,112,101,110,100,0,0,
+9,5,2,6,15,6,3,0,31,4,6,1,19,4,5,4,
+30,9,0,231,32,32,32,32,119,104,105,108,101,32,110,111,
+116,32,99,104,101,99,107,40,80,46,116,111,107,101,110,44,
+39,41,39,41,58,0,0,0,12,7,0,5,99,104,101,99,
+107,0,0,0,13,6,7,0,12,9,0,1,80,0,0,0,
+13,7,9,0,12,9,0,5,116,111,107,101,110,0,0,0,
+9,7,7,9,12,8,0,1,41,0,0,0,31,5,7,2,
+19,5,6,5,47,4,5,0,21,4,0,0,18,0,0,101,
+30,6,0,232,32,32,32,32,32,32,32,32,116,119,101,97,
+107,40,39,44,39,44,48,41,0,0,0,0,12,6,0,5,
+116,119,101,97,107,0,0,0,13,5,6,0,12,6,0,1,
+44,0,0,0,11,7,0,0,0,0,0,0,0,0,0,0,
+31,4,6,2,19,4,5,4,30,10,0,233,32,32,32,32,
+32,32,32,32,114,46,105,116,101,109,115,46,97,112,112,101,
+110,100,40,101,120,112,114,101,115,115,105,111,110,40,48,41,
+41,0,0,0,12,6,0,5,105,116,101,109,115,0,0,0,
+9,5,3,6,12,6,0,6,97,112,112,101,110,100,0,0,
+9,5,5,6,12,8,0,10,101,120,112,114,101,115,115,105,
+111,110,0,0,13,7,8,0,11,8,0,0,0,0,0,0,
+0,0,0,0,31,6,8,1,19,6,7,6,31,4,6,1,
+19,4,5,4,30,11,0,234,32,32,32,32,32,32,32,32,
+105,102,32,99,104,101,99,107,40,80,46,116,111,107,101,110,
+44,39,44,39,41,58,32,97,100,118,97,110,99,101,40,39,
+44,39,41,0,12,6,0,5,99,104,101,99,107,0,0,0,
+13,5,6,0,12,8,0,1,80,0,0,0,13,6,8,0,
+12,8,0,5,116,111,107,101,110,0,0,0,9,6,6,8,
+12,7,0,1,44,0,0,0,31,4,6,2,19,4,5,4,
+21,4,0,0,18,0,0,10,12,6,0,7,97,100,118,97,
+110,99,101,0,13,5,6,0,12,6,0,1,44,0,0,0,
+31,4,6,1,19,4,5,4,18,0,0,1,30,5,0,235,
+32,32,32,32,32,32,32,32,114,101,115,116,111,114,101,40,
+41,0,0,0,12,6,0,7,114,101,115,116,111,114,101,0,
+13,5,6,0,31,4,0,0,19,4,5,4,18,0,255,139,
+30,5,0,236,32,32,32,32,97,100,118,97,110,99,101,40,
+39,41,39,41,0,0,0,0,12,6,0,7,97,100,118,97,
+110,99,101,0,13,5,6,0,12,6,0,1,41,0,0,0,
+31,4,6,1,19,4,5,4,30,5,0,237,32,32,32,32,
+97,100,118,97,110,99,101,40,39,58,39,41,0,0,0,0,
+12,6,0,7,97,100,118,97,110,99,101,0,13,5,6,0,
+12,6,0,1,58,0,0,0,31,4,6,1,19,4,5,4,
+30,7,0,238,32,32,32,32,105,116,101,109,115,46,97,112,
+112,101,110,100,40,98,108,111,99,107,40,41,41,0,0,0,
+12,6,0,6,97,112,112,101,110,100,0,0,9,5,2,6,
+12,8,0,5,98,108,111,99,107,0,0,0,13,7,8,0,
+31,6,0,0,19,6,7,6,31,4,6,1,19,4,5,4,
+30,4,0,239,32,32,32,32,114,101,116,117,114,110,32,116,
+0,0,0,0,20,1,0,0,0,0,0,0,12,31,0,7,
+100,101,102,95,110,117,100,0,14,31,30,0,30,5,0,242,
+100,101,102,32,119,104,105,108,101,95,110,117,100,40,116,41,
+58,0,0,0,16,31,0,100,44,8,0,0,30,5,0,242,
+100,101,102,32,119,104,105,108,101,95,110,117,100,40,116,41,
+58,0,0,0,12,1,0,8,112,97,114,115,101,46,112,121,
+0,0,0,0,33,1,0,0,12,1,0,9,119,104,105,108,
+101,95,110,117,100,0,0,0,34,1,0,0,28,2,0,0,
+9,1,0,2,30,7,0,243,32,32,32,32,105,116,101,109,
+115,32,61,32,116,46,105,116,101,109,115,32,61,32,91,93,
+0,0,0,0,27,3,0,0,12,4,0,5,105,116,101,109,
+115,0,0,0,10,1,4,3,15,2,3,0,30,8,0,244,
+32,32,32,32,105,116,101,109,115,46,97,112,112,101,110,100,
+40,101,120,112,114,101,115,115,105,111,110,40,48,41,41,0,
+12,5,0,6,97,112,112,101,110,100,0,0,9,4,2,5,
+12,7,0,10,101,120,112,114,101,115,115,105,111,110,0,0,
+13,6,7,0,11,7,0,0,0,0,0,0,0,0,0,0,
+31,5,7,1,19,5,6,5,31,3,5,1,19,3,4,3,
+30,5,0,245,32,32,32,32,97,100,118,97,110,99,101,40,
+39,58,39,41,0,0,0,0,12,5,0,7,97,100,118,97,
+110,99,101,0,13,4,5,0,12,5,0,1,58,0,0,0,
+31,3,5,1,19,3,4,3,30,7,0,246,32,32,32,32,
+105,116,101,109,115,46,97,112,112,101,110,100,40,98,108,111,
+99,107,40,41,41,0,0,0,12,5,0,6,97,112,112,101,
+110,100,0,0,9,4,2,5,12,7,0,5,98,108,111,99,
+107,0,0,0,13,6,7,0,31,5,0,0,19,5,6,5,
+31,3,5,1,19,3,4,3,30,4,0,247,32,32,32,32,
+114,101,116,117,114,110,32,116,0,0,0,0,20,1,0,0,
+0,0,0,0,12,32,0,9,119,104,105,108,101,95,110,117,
+100,0,0,0,14,32,31,0,30,5,0,248,100,101,102,32,
+99,108,97,115,115,95,110,117,100,40,116,41,58,0,0,0,
+16,32,0,113,44,11,0,0,30,5,0,248,100,101,102,32,
+99,108,97,115,115,95,110,117,100,40,116,41,58,0,0,0,
+12,1,0,8,112,97,114,115,101,46,112,121,0,0,0,0,
+33,1,0,0,12,1,0,9,99,108,97,115,115,95,110,117,
+100,0,0,0,34,1,0,0,28,2,0,0,9,1,0,2,
+30,7,0,249,32,32,32,32,105,116,101,109,115,32,61,32,
+116,46,105,116,101,109,115,32,61,32,91,93,0,0,0,0,
+27,3,0,0,12,4,0,5,105,116,101,109,115,0,0,0,
+10,1,4,3,15,2,3,0,30,8,0,250,32,32,32,32,
+105,116,101,109,115,46,97,112,112,101,110,100,40,101,120,112,
+114,101,115,115,105,111,110,40,48,41,41,0,12,5,0,6,
+97,112,112,101,110,100,0,0,9,4,2,5,12,7,0,10,
+101,120,112,114,101,115,115,105,111,110,0,0,13,6,7,0,
+11,7,0,0,0,0,0,0,0,0,0,0,31,5,7,1,
+19,5,6,5,31,3,5,1,19,3,4,3,30,5,0,251,
+32,32,32,32,97,100,118,97,110,99,101,40,39,58,39,41,
+0,0,0,0,12,5,0,7,97,100,118,97,110,99,101,0,
+13,4,5,0,12,5,0,1,58,0,0,0,31,3,5,1,
+19,3,4,3,30,11,0,252,32,32,32,32,105,116,101,109,
+115,46,97,112,112,101,110,100,40,105,108,115,116,40,39,109,
+101,116,104,111,100,115,39,44,98,108,111,99,107,40,41,41,
+41,0,0,0,12,5,0,6,97,112,112,101,110,100,0,0,
+9,4,2,5,12,7,0,4,105,108,115,116,0,0,0,0,
+13,6,7,0,12,7,0,7,109,101,116,104,111,100,115,0,
+12,10,0,5,98,108,111,99,107,0,0,0,13,9,10,0,
+31,8,0,0,19,8,9,8,31,5,7,2,19,5,6,5,
+31,3,5,1,19,3,4,3,30,4,0,253,32,32,32,32,
+114,101,116,117,114,110,32,116,0,0,0,0,20,1,0,0,
+0,0,0,0,12,33,0,9,99,108,97,115,115,95,110,117,
+100,0,0,0,14,33,32,0,30,5,0,255,100,101,102,32,
+102,114,111,109,95,110,117,100,40,116,41,58,0,0,0,0,
+16,33,0,107,44,8,0,0,30,5,0,255,100,101,102,32,
+102,114,111,109,95,110,117,100,40,116,41,58,0,0,0,0,
+12,1,0,8,112,97,114,115,101,46,112,121,0,0,0,0,
+33,1,0,0,12,1,0,8,102,114,111,109,95,110,117,100,
+0,0,0,0,34,1,0,0,28,2,0,0,9,1,0,2,
+30,7,1,0,32,32,32,32,105,116,101,109,115,32,61,32,
+116,46,105,116,101,109,115,32,61,32,91,93,0,0,0,0,
+27,3,0,0,12,4,0,5,105,116,101,109,115,0,0,0,
+10,1,4,3,15,2,3,0,30,8,1,1,32,32,32,32,
+105,116,101,109,115,46,97,112,112,101,110,100,40,101,120,112,
+114,101,115,115,105,111,110,40,48,41,41,0,12,5,0,6,
+97,112,112,101,110,100,0,0,9,4,2,5,12,7,0,10,
+101,120,112,114,101,115,115,105,111,110,0,0,13,6,7,0,
+11,7,0,0,0,0,0,0,0,0,0,0,31,5,7,1,
+19,5,6,5,31,3,5,1,19,3,4,3,30,6,1,2,
+32,32,32,32,97,100,118,97,110,99,101,40,39,105,109,112,
+111,114,116,39,41,0,0,0,12,5,0,7,97,100,118,97,
+110,99,101,0,13,4,5,0,12,5,0,6,105,109,112,111,
+114,116,0,0,31,3,5,1,19,3,4,3,30,8,1,3,
+32,32,32,32,105,116,101,109,115,46,97,112,112,101,110,100,
+40,101,120,112,114,101,115,115,105,111,110,40,48,41,41,0,
+12,5,0,6,97,112,112,101,110,100,0,0,9,4,2,5,
+12,7,0,10,101,120,112,114,101,115,115,105,111,110,0,0,
+13,6,7,0,11,7,0,0,0,0,0,0,0,0,0,0,
+31,5,7,1,19,5,6,5,31,3,5,1,19,3,4,3,
+30,4,1,4,32,32,32,32,114,101,116,117,114,110,32,116,
+0,0,0,0,20,1,0,0,0,0,0,0,12,34,0,8,
+102,114,111,109,95,110,117,100,0,0,0,0,14,34,33,0,
+30,4,1,6,100,101,102,32,102,111,114,95,110,117,100,40,
+116,41,58,0,16,34,0,165,44,8,0,0,30,4,1,6,
+100,101,102,32,102,111,114,95,110,117,100,40,116,41,58,0,
+12,1,0,8,112,97,114,115,101,46,112,121,0,0,0,0,
+33,1,0,0,12,1,0,7,102,111,114,95,110,117,100,0,
+34,1,0,0,28,2,0,0,9,1,0,2,30,7,1,7,
+32,32,32,32,105,116,101,109,115,32,61,32,116,46,105,116,
+101,109,115,32,61,32,91,93,0,0,0,0,27,3,0,0,
+12,4,0,5,105,116,101,109,115,0,0,0,10,1,4,3,
+15,2,3,0,30,5,1,8,32,32,32,32,116,119,101,97,
+107,40,39,105,110,39,44,48,41,0,0,0,12,5,0,5,
+116,119,101,97,107,0,0,0,13,4,5,0,12,5,0,2,
+105,110,0,0,11,6,0,0,0,0,0,0,0,0,0,0,
+31,3,5,2,19,3,4,3,30,8,1,9,32,32,32,32,
+105,116,101,109,115,46,97,112,112,101,110,100,40,101,120,112,
+114,101,115,115,105,111,110,40,48,41,41,0,12,5,0,6,
+97,112,112,101,110,100,0,0,9,4,2,5,12,7,0,10,
+101,120,112,114,101,115,115,105,111,110,0,0,13,6,7,0,
+11,7,0,0,0,0,0,0,0,0,0,0,31,5,7,1,
+19,5,6,5,31,3,5,1,19,3,4,3,30,5,1,10,
+32,32,32,32,97,100,118,97,110,99,101,40,39,105,110,39,
+41,0,0,0,12,5,0,7,97,100,118,97,110,99,101,0,
+13,4,5,0,12,5,0,2,105,110,0,0,31,3,5,1,
+19,3,4,3,30,8,1,11,32,32,32,32,105,116,101,109,
+115,46,97,112,112,101,110,100,40,101,120,112,114,101,115,115,
+105,111,110,40,48,41,41,0,12,5,0,6,97,112,112,101,
+110,100,0,0,9,4,2,5,12,7,0,10,101,120,112,114,
+101,115,115,105,111,110,0,0,13,6,7,0,11,7,0,0,
+0,0,0,0,0,0,0,0,31,5,7,1,19,5,6,5,
+31,3,5,1,19,3,4,3,30,4,1,12,32,32,32,32,
+114,101,115,116,111,114,101,40,41,0,0,0,12,5,0,7,
+114,101,115,116,111,114,101,0,13,4,5,0,31,3,0,0,
+19,3,4,3,30,5,1,13,32,32,32,32,97,100,118,97,
+110,99,101,40,39,58,39,41,0,0,0,0,12,5,0,7,
+97,100,118,97,110,99,101,0,13,4,5,0,12,5,0,1,
+58,0,0,0,31,3,5,1,19,3,4,3,30,7,1,14,
+32,32,32,32,105,116,101,109,115,46,97,112,112,101,110,100,
+40,98,108,111,99,107,40,41,41,0,0,0,12,5,0,6,
+97,112,112,101,110,100,0,0,9,4,2,5,12,7,0,5,
+98,108,111,99,107,0,0,0,13,6,7,0,31,5,0,0,
+19,5,6,5,31,3,5,1,19,3,4,3,30,4,1,15,
+32,32,32,32,114,101,116,117,114,110,32,116,0,0,0,0,
+20,1,0,0,0,0,0,0,12,35,0,7,102,111,114,95,
+110,117,100,0,14,35,34,0,30,4,1,16,100,101,102,32,
+105,102,95,110,117,100,40,116,41,58,0,0,16,35,1,137,
+44,16,0,0,30,4,1,16,100,101,102,32,105,102,95,110,
+117,100,40,116,41,58,0,0,12,1,0,8,112,97,114,115,
+101,46,112,121,0,0,0,0,33,1,0,0,12,1,0,6,
+105,102,95,110,117,100,0,0,34,1,0,0,28,2,0,0,
+9,1,0,2,30,7,1,17,32,32,32,32,105,116,101,109,
+115,32,61,32,116,46,105,116,101,109,115,32,61,32,91,93,
+0,0,0,0,27,3,0,0,12,4,0,5,105,116,101,109,
+115,0,0,0,10,1,4,3,15,2,3,0,30,6,1,18,
+32,32,32,32,97,32,61,32,101,120,112,114,101,115,115,105,
+111,110,40,48,41,0,0,0,12,6,0,10,101,120,112,114,
+101,115,115,105,111,110,0,0,13,5,6,0,11,6,0,0,
+0,0,0,0,0,0,0,0,31,4,6,1,19,4,5,4,
+15,3,4,0,30,5,1,19,32,32,32,32,97,100,118,97,
+110,99,101,40,39,58,39,41,0,0,0,0,12,6,0,7,
+97,100,118,97,110,99,101,0,13,5,6,0,12,6,0,1,
+58,0,0,0,31,4,6,1,19,4,5,4,30,4,1,20,
+32,32,32,32,98,32,61,32,98,108,111,99,107,40,41,0,
+12,7,0,5,98,108,111,99,107,0,0,0,13,6,7,0,
+31,5,0,0,19,5,6,5,15,4,5,0,30,13,1,21,
+32,32,32,32,105,116,101,109,115,46,97,112,112,101,110,100,
+40,84,111,107,101,110,40,116,46,112,111,115,44,39,101,108,
+105,102,39,44,39,101,108,105,102,39,44,91,97,44,98,93,
+41,41,0,0,12,7,0,6,97,112,112,101,110,100,0,0,
+9,6,2,7,12,9,0,5,84,111,107,101,110,0,0,0,
+13,8,9,0,12,13,0,3,112,111,115,0,9,9,1,13,
+12,10,0,4,101,108,105,102,0,0,0,0,12,11,0,4,
+101,108,105,102,0,0,0,0,15,13,3,0,15,14,4,0,
+27,12,13,2,31,7,9,4,19,7,8,7,31,5,7,1,
+19,5,6,5,30,9,1,22,32,32,32,32,119,104,105,108,
+101,32,99,104,101,99,107,40,80,46,116,111,107,101,110,44,
+39,101,108,105,102,39,41,58,0,0,0,0,12,7,0,5,
+99,104,101,99,107,0,0,0,13,6,7,0,12,9,0,1,
+80,0,0,0,13,7,9,0,12,9,0,5,116,111,107,101,
+110,0,0,0,9,7,7,9,12,8,0,4,101,108,105,102,
+0,0,0,0,31,5,7,2,19,5,6,5,21,5,0,0,
+18,0,0,120,30,6,1,23,32,32,32,32,32,32,32,32,
+116,111,107,32,61,32,80,46,116,111,107,101,110,0,0,0,
+12,7,0,1,80,0,0,0,13,6,7,0,12,7,0,5,
+116,111,107,101,110,0,0,0,9,6,6,7,15,5,6,0,
+30,6,1,24,32,32,32,32,32,32,32,32,97,100,118,97,
+110,99,101,40,39,101,108,105,102,39,41,0,12,8,0,7,
+97,100,118,97,110,99,101,0,13,7,8,0,12,8,0,4,
+101,108,105,102,0,0,0,0,31,6,8,1,19,6,7,6,
+30,7,1,25,32,32,32,32,32,32,32,32,97,32,61,32,
+101,120,112,114,101,115,115,105,111,110,40,48,41,0,0,0,
+12,8,0,10,101,120,112,114,101,115,115,105,111,110,0,0,
+13,7,8,0,11,8,0,0,0,0,0,0,0,0,0,0,
+31,6,8,1,19,6,7,6,15,3,6,0,30,6,1,26,
+32,32,32,32,32,32,32,32,97,100,118,97,110,99,101,40,
+39,58,39,41,0,0,0,0,12,8,0,7,97,100,118,97,
+110,99,101,0,13,7,8,0,12,8,0,1,58,0,0,0,
+31,6,8,1,19,6,7,6,30,5,1,27,32,32,32,32,
+32,32,32,32,98,32,61,32,98,108,111,99,107,40,41,0,
+12,8,0,5,98,108,111,99,107,0,0,0,13,7,8,0,
+31,6,0,0,19,6,7,6,15,4,6,0,30,15,1,28,
+32,32,32,32,32,32,32,32,105,116,101,109,115,46,97,112,
+112,101,110,100,40,84,111,107,101,110,40,116,111,107,46,112,
+111,115,44,39,101,108,105,102,39,44,39,101,108,105,102,39,
+44,91,97,44,98,93,41,41,0,0,0,0,12,8,0,6,
+97,112,112,101,110,100,0,0,9,7,2,8,12,10,0,5,
+84,111,107,101,110,0,0,0,13,9,10,0,12,14,0,3,
+112,111,115,0,9,10,5,14,12,11,0,4,101,108,105,102,
+0,0,0,0,12,12,0,4,101,108,105,102,0,0,0,0,
+15,14,3,0,15,15,4,0,27,13,14,2,31,8,10,4,
+19,8,9,8,31,6,8,1,19,6,7,6,18,0,255,120,
+30,8,1,29,32,32,32,32,105,102,32,99,104,101,99,107,
+40,80,46,116,111,107,101,110,44,39,101,108,115,101,39,41,
+58,0,0,0,12,8,0,5,99,104,101,99,107,0,0,0,
+13,7,8,0,12,10,0,1,80,0,0,0,13,8,10,0,
+12,10,0,5,116,111,107,101,110,0,0,0,9,8,8,10,
+12,9,0,4,101,108,115,101,0,0,0,0,31,6,8,2,
+19,6,7,6,21,6,0,0,18,0,0,99,30,6,1,30,
+32,32,32,32,32,32,32,32,116,111,107,32,61,32,80,46,
+116,111,107,101,110,0,0,0,12,7,0,1,80,0,0,0,
+13,6,7,0,12,7,0,5,116,111,107,101,110,0,0,0,
+9,6,6,7,15,5,6,0,30,6,1,31,32,32,32,32,
+32,32,32,32,97,100,118,97,110,99,101,40,39,101,108,115,
+101,39,41,0,12,8,0,7,97,100,118,97,110,99,101,0,
+13,7,8,0,12,8,0,4,101,108,115,101,0,0,0,0,
+31,6,8,1,19,6,7,6,30,6,1,32,32,32,32,32,
+32,32,32,32,97,100,118,97,110,99,101,40,39,58,39,41,
+0,0,0,0,12,8,0,7,97,100,118,97,110,99,101,0,
+13,7,8,0,12,8,0,1,58,0,0,0,31,6,8,1,
+19,6,7,6,30,5,1,33,32,32,32,32,32,32,32,32,
+98,32,61,32,98,108,111,99,107,40,41,0,12,8,0,5,
+98,108,111,99,107,0,0,0,13,7,8,0,31,6,0,0,
+19,6,7,6,15,4,6,0,30,14,1,34,32,32,32,32,
+32,32,32,32,105,116,101,109,115,46,97,112,112,101,110,100,
+40,84,111,107,101,110,40,116,111,107,46,112,111,115,44,39,
+101,108,115,101,39,44,39,101,108,115,101,39,44,91,98,93,
+41,41,0,0,12,8,0,6,97,112,112,101,110,100,0,0,
+9,7,2,8,12,10,0,5,84,111,107,101,110,0,0,0,
+13,9,10,0,12,14,0,3,112,111,115,0,9,10,5,14,
+12,11,0,4,101,108,115,101,0,0,0,0,12,12,0,4,
+101,108,115,101,0,0,0,0,15,14,4,0,27,13,14,1,
+31,8,10,4,19,8,9,8,31,6,8,1,19,6,7,6,
+18,0,0,1,30,4,1,35,32,32,32,32,114,101,116,117,
+114,110,32,116,0,0,0,0,20,1,0,0,0,0,0,0,
+12,36,0,6,105,102,95,110,117,100,0,0,14,36,35,0,
+30,4,1,36,100,101,102,32,116,114,121,95,110,117,100,40,
+116,41,58,0,16,36,1,28,44,16,0,0,30,4,1,36,
+100,101,102,32,116,114,121,95,110,117,100,40,116,41,58,0,
+12,1,0,8,112,97,114,115,101,46,112,121,0,0,0,0,
+33,1,0,0,12,1,0,7,116,114,121,95,110,117,100,0,
+34,1,0,0,28,2,0,0,9,1,0,2,30,7,1,37,
+32,32,32,32,105,116,101,109,115,32,61,32,116,46,105,116,
+101,109,115,32,61,32,91,93,0,0,0,0,27,3,0,0,
+12,4,0,5,105,116,101,109,115,0,0,0,10,1,4,3,
+15,2,3,0,30,5,1,38,32,32,32,32,97,100,118,97,
+110,99,101,40,39,58,39,41,0,0,0,0,12,5,0,7,
+97,100,118,97,110,99,101,0,13,4,5,0,12,5,0,1,
+58,0,0,0,31,3,5,1,19,3,4,3,30,4,1,39,
+32,32,32,32,98,32,61,32,98,108,111,99,107,40,41,0,
+12,6,0,5,98,108,111,99,107,0,0,0,13,5,6,0,
+31,4,0,0,19,4,5,4,15,3,4,0,30,5,1,40,
+32,32,32,32,105,116,101,109,115,46,97,112,112,101,110,100,
+40,98,41,0,12,6,0,6,97,112,112,101,110,100,0,0,
+9,5,2,6,15,6,3,0,31,4,6,1,19,4,5,4,
+30,9,1,41,32,32,32,32,119,104,105,108,101,32,99,104,
+101,99,107,40,80,46,116,111,107,101,110,44,39,101,120,99,
+101,112,116,39,41,58,0,0,12,6,0,5,99,104,101,99,
+107,0,0,0,13,5,6,0,12,8,0,1,80,0,0,0,
+13,6,8,0,12,8,0,5,116,111,107,101,110,0,0,0,
+9,6,6,8,12,7,0,6,101,120,99,101,112,116,0,0,
+31,4,6,2,19,4,5,4,21,4,0,0,18,0,0,179,
+30,6,1,42,32,32,32,32,32,32,32,32,116,111,107,32,
+61,32,80,46,116,111,107,101,110,0,0,0,12,6,0,1,
+80,0,0,0,13,5,6,0,12,6,0,5,116,111,107,101,
+110,0,0,0,9,5,5,6,15,4,5,0,30,7,1,43,
+32,32,32,32,32,32,32,32,97,100,118,97,110,99,101,40,
+39,101,120,99,101,112,116,39,41,0,0,0,12,7,0,7,
+97,100,118,97,110,99,101,0,13,6,7,0,12,7,0,6,
+101,120,99,101,112,116,0,0,31,5,7,1,19,5,6,5,
+30,14,1,44,32,32,32,32,32,32,32,32,105,102,32,110,
+111,116,32,99,104,101,99,107,40,80,46,116,111,107,101,110,
+44,39,58,39,41,58,32,97,32,61,32,101,120,112,114,101,
+115,115,105,111,110,40,48,41,0,0,0,0,12,8,0,5,
+99,104,101,99,107,0,0,0,13,7,8,0,12,10,0,1,
+80,0,0,0,13,8,10,0,12,10,0,5,116,111,107,101,
+110,0,0,0,9,8,8,10,12,9,0,1,58,0,0,0,
+31,6,8,2,19,6,7,6,47,5,6,0,21,5,0,0,
+18,0,0,13,12,8,0,10,101,120,112,114,101,115,115,105,
+111,110,0,0,13,7,8,0,11,8,0,0,0,0,0,0,
+0,0,0,0,31,6,8,1,19,6,7,6,15,5,6,0,
+18,0,0,32,30,13,1,45,32,32,32,32,32,32,32,32,
+101,108,115,101,58,32,97,32,61,32,84,111,107,101,110,40,
+116,111,107,46,112,111,115,44,39,115,121,109,98,111,108,39,
+44,39,78,111,110,101,39,41,0,0,0,0,12,8,0,5,
+84,111,107,101,110,0,0,0,13,7,8,0,12,11,0,3,
+112,111,115,0,9,8,4,11,12,9,0,6,115,121,109,98,
+111,108,0,0,12,10,0,4,78,111,110,101,0,0,0,0,
+31,6,8,3,19,6,7,6,15,5,6,0,18,0,0,1,
+30,6,1,46,32,32,32,32,32,32,32,32,97,100,118,97,
+110,99,101,40,39,58,39,41,0,0,0,0,12,8,0,7,
+97,100,118,97,110,99,101,0,13,7,8,0,12,8,0,1,
+58,0,0,0,31,6,8,1,19,6,7,6,30,5,1,47,
+32,32,32,32,32,32,32,32,98,32,61,32,98,108,111,99,
+107,40,41,0,12,8,0,5,98,108,111,99,107,0,0,0,
+13,7,8,0,31,6,0,0,19,6,7,6,15,3,6,0,
+30,16,1,48,32,32,32,32,32,32,32,32,105,116,101,109,
+115,46,97,112,112,101,110,100,40,84,111,107,101,110,40,116,
+111,107,46,112,111,115,44,39,101,120,99,101,112,116,39,44,
+39,101,120,99,101,112,116,39,44,91,97,44,98,93,41,41,
+0,0,0,0,12,8,0,6,97,112,112,101,110,100,0,0,
+9,7,2,8,12,10,0,5,84,111,107,101,110,0,0,0,
+13,9,10,0,12,14,0,3,112,111,115,0,9,10,4,14,
+12,11,0,6,101,120,99,101,112,116,0,0,12,12,0,6,
+101,120,99,101,112,116,0,0,15,14,5,0,15,15,3,0,
+27,13,14,2,31,8,10,4,19,8,9,8,31,6,8,1,
+19,6,7,6,18,0,255,61,30,4,1,56,32,32,32,32,
+114,101,116,117,114,110,32,116,0,0,0,0,20,1,0,0,
+0,0,0,0,12,37,0,7,116,114,121,95,110,117,100,0,
+14,37,36,0,30,5,1,57,100,101,102,32,112,114,101,102,
+105,120,95,110,117,100,40,116,41,58,0,0,16,37,0,58,
+44,7,0,0,30,5,1,57,100,101,102,32,112,114,101,102,
+105,120,95,110,117,100,40,116,41,58,0,0,12,1,0,8,
+112,97,114,115,101,46,112,121,0,0,0,0,33,1,0,0,
+12,1,0,10,112,114,101,102,105,120,95,110,117,100,0,0,
+34,1,0,0,28,2,0,0,9,1,0,2,30,4,1,60,
+32,32,32,32,98,112,32,61,32,116,46,98,112,0,0,0,
+12,4,0,2,98,112,0,0,9,3,1,4,15,2,3,0,
+30,8,1,61,32,32,32,32,116,46,105,116,101,109,115,32,
+61,32,91,101,120,112,114,101,115,115,105,111,110,40,98,112,
+41,93,0,0,12,6,0,10,101,120,112,114,101,115,115,105,
+111,110,0,0,13,5,6,0,15,6,2,0,31,4,6,1,
+19,4,5,4,27,3,4,1,12,4,0,5,105,116,101,109,
+115,0,0,0,10,1,4,3,30,4,1,62,32,32,32,32,
+114,101,116,117,114,110,32,116,0,0,0,0,20,1,0,0,
+0,0,0,0,12,38,0,10,112,114,101,102,105,120,95,110,
+117,100,0,0,14,38,37,0,30,5,1,63,100,101,102,32,
+112,114,101,102,105,120,95,110,117,100,48,40,116,41,58,0,
+16,38,0,79,44,10,0,0,30,5,1,63,100,101,102,32,
+112,114,101,102,105,120,95,110,117,100,48,40,116,41,58,0,
+12,1,0,8,112,97,114,115,101,46,112,121,0,0,0,0,
+33,1,0,0,12,1,0,11,112,114,101,102,105,120,95,110,
+117,100,48,0,34,1,0,0,28,2,0,0,9,1,0,2,
+30,14,1,64,32,32,32,32,105,102,32,99,104,101,99,107,
+40,80,46,116,111,107,101,110,44,39,110,108,39,44,39,59,
+39,44,39,101,111,102,39,44,39,100,101,100,101,110,116,39,
+41,58,32,114,101,116,117,114,110,32,116,0,12,4,0,5,
+99,104,101,99,107,0,0,0,13,3,4,0,12,9,0,1,
+80,0,0,0,13,4,9,0,12,9,0,5,116,111,107,101,
+110,0,0,0,9,4,4,9,12,5,0,2,110,108,0,0,
+12,6,0,1,59,0,0,0,12,7,0,3,101,111,102,0,
+12,8,0,6,100,101,100,101,110,116,0,0,31,2,4,5,
+19,2,3,2,21,2,0,0,18,0,0,3,20,1,0,0,
+18,0,0,1,30,7,1,65,32,32,32,32,114,101,116,117,
+114,110,32,112,114,101,102,105,120,95,110,117,100,40,116,41,
+0,0,0,0,12,4,0,10,112,114,101,102,105,120,95,110,
+117,100,0,0,13,3,4,0,15,4,1,0,31,2,4,1,
+19,2,3,2,20,2,0,0,0,0,0,0,12,39,0,11,
+112,114,101,102,105,120,95,110,117,100,48,0,14,39,38,0,
+30,5,1,66,100,101,102,32,112,114,101,102,105,120,95,110,
+117,100,115,40,116,41,58,0,16,39,0,59,44,8,0,0,
+30,5,1,66,100,101,102,32,112,114,101,102,105,120,95,110,
+117,100,115,40,116,41,58,0,12,1,0,8,112,97,114,115,
+101,46,112,121,0,0,0,0,33,1,0,0,12,1,0,11,
+112,114,101,102,105,120,95,110,117,100,115,0,34,1,0,0,
+28,2,0,0,9,1,0,2,30,6,1,67,32,32,32,32,
+114,32,61,32,101,120,112,114,101,115,115,105,111,110,40,48,
+41,0,0,0,12,5,0,10,101,120,112,114,101,115,115,105,
+111,110,0,0,13,4,5,0,11,5,0,0,0,0,0,0,
+0,0,0,0,31,3,5,1,19,3,4,3,15,2,3,0,
+30,7,1,68,32,32,32,32,114,101,116,117,114,110,32,105,
+108,115,116,40,116,46,116,121,112,101,44,114,41,0,0,0,
+12,5,0,4,105,108,115,116,0,0,0,0,13,4,5,0,
+12,7,0,4,116,121,112,101,0,0,0,0,9,5,1,7,
+15,6,2,0,31,3,5,2,19,3,4,3,20,3,0,0,
+0,0,0,0,12,40,0,11,112,114,101,102,105,120,95,110,
+117,100,115,0,14,40,39,0,30,5,1,70,100,101,102,32,
+112,114,101,102,105,120,95,110,101,103,40,116,41,58,0,0,
+16,40,0,134,44,11,0,0,30,5,1,70,100,101,102,32,
+112,114,101,102,105,120,95,110,101,103,40,116,41,58,0,0,
+12,1,0,8,112,97,114,115,101,46,112,121,0,0,0,0,
+33,1,0,0,12,1,0,10,112,114,101,102,105,120,95,110,
+101,103,0,0,34,1,0,0,28,2,0,0,9,1,0,2,
+30,6,1,71,32,32,32,32,114,32,61,32,101,120,112,114,
+101,115,115,105,111,110,40,53,48,41,0,0,12,5,0,10,
+101,120,112,114,101,115,115,105,111,110,0,0,13,4,5,0,
+11,5,0,0,0,0,0,0,0,0,73,64,31,3,5,1,
+19,3,4,3,15,2,3,0,30,7,1,72,32,32,32,32,
+105,102,32,114,46,116,121,112,101,32,61,61,32,39,110,117,
+109,98,101,114,39,58,0,0,12,4,0,4,116,121,112,101,
+0,0,0,0,9,3,2,4,12,4,0,6,110,117,109,98,
+101,114,0,0,23,3,3,4,21,3,0,0,18,0,0,40,
+30,9,1,73,32,32,32,32,32,32,32,32,114,46,118,97,
+108,32,61,32,115,116,114,40,45,102,108,111,97,116,40,114,
+46,118,97,108,41,41,0,0,12,5,0,3,115,116,114,0,
+13,4,5,0,11,5,0,0,0,0,0,0,0,0,0,0,
+12,8,0,5,102,108,111,97,116,0,0,0,13,7,8,0,
+12,9,0,3,118,97,108,0,9,8,2,9,31,6,8,1,
+19,6,7,6,2,5,5,6,31,3,5,1,19,3,4,3,
+12,4,0,3,118,97,108,0,10,2,4,3,30,5,1,74,
+32,32,32,32,32,32,32,32,114,101,116,117,114,110,32,114,
+0,0,0,0,20,2,0,0,18,0,0,1,30,11,1,75,
+32,32,32,32,116,46,105,116,101,109,115,32,61,32,91,84,
+111,107,101,110,40,116,46,112,111,115,44,39,110,117,109,98,
+101,114,39,44,39,48,39,41,44,114,93,0,12,7,0,5,
+84,111,107,101,110,0,0,0,13,6,7,0,12,10,0,3,
+112,111,115,0,9,7,1,10,12,8,0,6,110,117,109,98,
+101,114,0,0,12,9,0,1,48,0,0,0,31,4,7,3,
+19,4,6,4,15,5,2,0,27,3,4,2,12,4,0,5,
+105,116,101,109,115,0,0,0,10,1,4,3,30,4,1,76,
+32,32,32,32,114,101,116,117,114,110,32,116,0,0,0,0,
+20,1,0,0,0,0,0,0,12,41,0,10,112,114,101,102,
+105,120,95,110,101,103,0,0,14,41,40,0,30,5,1,77,
+100,101,102,32,118,97,114,103,115,95,110,117,100,40,116,41,
+58,0,0,0,16,41,0,66,44,6,0,0,30,5,1,77,
+100,101,102,32,118,97,114,103,115,95,110,117,100,40,116,41,
+58,0,0,0,12,1,0,8,112,97,114,115,101,46,112,121,
+0,0,0,0,33,1,0,0,12,1,0,9,118,97,114,103,
+115,95,110,117,100,0,0,0,34,1,0,0,28,2,0,0,
+9,1,0,2,30,6,1,78,32,32,32,32,114,32,61,32,
+112,114,101,102,105,120,95,110,117,100,40,116,41,0,0,0,
+12,5,0,10,112,114,101,102,105,120,95,110,117,100,0,0,
+13,4,5,0,15,5,1,0,31,3,5,1,19,3,4,3,
+15,2,3,0,30,5,1,79,32,32,32,32,116,46,116,121,
+112,101,32,61,32,39,97,114,103,115,39,0,12,3,0,4,
+97,114,103,115,0,0,0,0,12,4,0,4,116,121,112,101,
+0,0,0,0,10,1,4,3,30,4,1,80,32,32,32,32,
+116,46,118,97,108,32,61,32,39,42,39,0,12,3,0,1,
+42,0,0,0,12,4,0,3,118,97,108,0,10,1,4,3,
+30,4,1,81,32,32,32,32,114,101,116,117,114,110,32,116,
+0,0,0,0,20,1,0,0,0,0,0,0,12,42,0,9,
+118,97,114,103,115,95,110,117,100,0,0,0,14,42,41,0,
+30,5,1,82,100,101,102,32,110,97,114,103,115,95,110,117,
+100,40,116,41,58,0,0,0,16,42,0,68,44,6,0,0,
+30,5,1,82,100,101,102,32,110,97,114,103,115,95,110,117,
+100,40,116,41,58,0,0,0,12,1,0,8,112,97,114,115,
+101,46,112,121,0,0,0,0,33,1,0,0,12,1,0,9,
+110,97,114,103,115,95,110,117,100,0,0,0,34,1,0,0,
+28,2,0,0,9,1,0,2,30,6,1,83,32,32,32,32,
+114,32,61,32,112,114,101,102,105,120,95,110,117,100,40,116,
+41,0,0,0,12,5,0,10,112,114,101,102,105,120,95,110,
+117,100,0,0,13,4,5,0,15,5,1,0,31,3,5,1,
+19,3,4,3,15,2,3,0,30,6,1,84,32,32,32,32,
+116,46,116,121,112,101,32,61,32,39,110,97,114,103,115,39,
+0,0,0,0,12,3,0,5,110,97,114,103,115,0,0,0,
+12,4,0,4,116,121,112,101,0,0,0,0,10,1,4,3,
+30,5,1,85,32,32,32,32,116,46,118,97,108,32,61,32,
+39,42,42,39,0,0,0,0,12,3,0,2,42,42,0,0,
+12,4,0,3,118,97,108,0,10,1,4,3,30,4,1,86,
+32,32,32,32,114,101,116,117,114,110,32,116,0,0,0,0,
+20,1,0,0,0,0,0,0,12,43,0,9,110,97,114,103,
+115,95,110,117,100,0,0,0,14,43,42,0,30,4,1,89,
+98,97,115,101,95,100,109,97,112,32,61,32,123,0,0,0,
+12,43,0,9,98,97,115,101,95,100,109,97,112,0,0,0,
+30,12,1,90,32,32,32,32,39,44,39,58,123,39,108,98,
+112,39,58,50,48,44,39,98,112,39,58,50,48,44,39,108,
+101,100,39,58,105,110,102,105,120,95,116,117,112,108,101,125,
+44,0,0,0,12,45,0,1,44,0,0,0,12,103,0,3,
+108,98,112,0,11,104,0,0,0,0,0,0,0,0,52,64,
+12,105,0,2,98,112,0,0,11,106,0,0,0,0,0,0,
+0,0,52,64,12,107,0,3,108,101,100,0,12,109,0,11,
+105,110,102,105,120,95,116,117,112,108,101,0,13,108,109,0,
+26,46,103,6,30,11,1,91,32,32,32,32,39,43,39,58,
+123,39,108,98,112,39,58,53,48,44,39,98,112,39,58,53,
+48,44,39,108,101,100,39,58,105,110,102,105,120,95,108,101,
+100,125,44,0,12,47,0,1,43,0,0,0,12,103,0,3,
+108,98,112,0,11,104,0,0,0,0,0,0,0,0,73,64,
+12,105,0,2,98,112,0,0,11,106,0,0,0,0,0,0,
+0,0,73,64,12,107,0,3,108,101,100,0,12,109,0,9,
+105,110,102,105,120,95,108,101,100,0,0,0,13,108,109,0,
+26,48,103,6,30,9,1,92,32,32,32,32,39,45,39,58,
+123,39,108,98,112,39,58,53,48,44,39,110,117,100,39,58,
+112,114,101,102,105,120,95,110,101,103,44,0,12,49,0,1,
+45,0,0,0,12,103,0,3,108,98,112,0,11,104,0,0,
+0,0,0,0,0,0,73,64,12,105,0,3,110,117,100,0,
+12,111,0,10,112,114,101,102,105,120,95,110,101,103,0,0,
+13,106,111,0,30,9,1,93,32,32,32,32,32,32,32,32,
+39,98,112,39,58,53,48,44,39,108,101,100,39,58,105,110,
+102,105,120,95,108,101,100,125,44,0,0,0,12,107,0,2,
+98,112,0,0,11,108,0,0,0,0,0,0,0,0,73,64,
+12,109,0,3,108,101,100,0,12,111,0,9,105,110,102,105,
+120,95,108,101,100,0,0,0,13,110,111,0,26,50,103,8,
+30,12,1,94,32,32,32,32,39,110,111,116,39,58,123,39,
+108,98,112,39,58,51,53,44,39,110,117,100,39,58,112,114,
+101,102,105,120,95,110,117,100,44,39,98,112,39,58,51,53,
+44,0,0,0,12,51,0,3,110,111,116,0,12,103,0,3,
+108,98,112,0,11,104,0,0,0,0,0,0,0,128,65,64,
+12,105,0,3,110,117,100,0,12,113,0,10,112,114,101,102,
+105,120,95,110,117,100,0,0,13,106,113,0,12,107,0,2,
+98,112,0,0,11,108,0,0,0,0,0,0,0,128,65,64,
+30,9,1,95,32,32,32,32,32,32,32,32,39,98,112,39,
+58,51,53,44,39,108,101,100,39,58,105,110,102,105,120,95,
+110,111,116,32,125,44,0,0,12,109,0,2,98,112,0,0,
+11,110,0,0,0,0,0,0,0,128,65,64,12,111,0,3,
+108,101,100,0,12,113,0,9,105,110,102,105,120,95,110,111,
+116,0,0,0,13,112,113,0,26,52,103,10,30,11,1,96,
+32,32,32,32,39,37,39,58,123,39,108,98,112,39,58,54,
+48,44,39,98,112,39,58,54,48,44,39,108,101,100,39,58,
+105,110,102,105,120,95,108,101,100,125,44,0,12,53,0,1,
+37,0,0,0,12,103,0,3,108,98,112,0,11,104,0,0,
+0,0,0,0,0,0,78,64,12,105,0,2,98,112,0,0,
+11,106,0,0,0,0,0,0,0,0,78,64,12,107,0,3,
+108,101,100,0,12,109,0,9,105,110,102,105,120,95,108,101,
+100,0,0,0,13,108,109,0,26,54,103,6,30,9,1,97,
+32,32,32,32,39,42,39,58,123,39,108,98,112,39,58,54,
+48,44,39,110,117,100,39,58,118,97,114,103,115,95,110,117,
+100,44,0,0,12,55,0,1,42,0,0,0,12,103,0,3,
+108,98,112,0,11,104,0,0,0,0,0,0,0,0,78,64,
+12,105,0,3,110,117,100,0,12,111,0,9,118,97,114,103,
+115,95,110,117,100,0,0,0,13,106,111,0,30,9,1,98,
+32,32,32,32,32,32,32,32,39,98,112,39,58,54,48,44,
+39,108,101,100,39,58,105,110,102,105,120,95,108,101,100,44,
+125,44,0,0,12,107,0,2,98,112,0,0,11,108,0,0,
+0,0,0,0,0,0,78,64,12,109,0,3,108,101,100,0,
+12,111,0,9,105,110,102,105,120,95,108,101,100,0,0,0,
+13,110,111,0,26,56,103,8,30,10,1,99,32,32,32,32,
+39,42,42,39,58,32,123,39,108,98,112,39,58,54,53,44,
+39,110,117,100,39,58,110,97,114,103,115,95,110,117,100,44,
+0,0,0,0,12,57,0,2,42,42,0,0,12,103,0,3,
+108,98,112,0,11,104,0,0,0,0,0,0,0,64,80,64,
+12,105,0,3,110,117,100,0,12,111,0,9,110,97,114,103,
+115,95,110,117,100,0,0,0,13,106,111,0,30,9,1,100,
+32,32,32,32,32,32,32,32,39,98,112,39,58,54,53,44,
+39,108,101,100,39,58,105,110,102,105,120,95,108,101,100,44,
+125,44,0,0,12,107,0,2,98,112,0,0,11,108,0,0,
+0,0,0,0,0,64,80,64,12,109,0,3,108,101,100,0,
+12,111,0,9,105,110,102,105,120,95,108,101,100,0,0,0,
+13,110,111,0,26,58,103,8,30,11,1,101,32,32,32,32,
+39,47,39,58,123,39,108,98,112,39,58,54,48,44,39,98,
+112,39,58,54,48,44,39,108,101,100,39,58,105,110,102,105,
+120,95,108,101,100,125,44,0,12,59,0,1,47,0,0,0,
+12,103,0,3,108,98,112,0,11,104,0,0,0,0,0,0,
+0,0,78,64,12,105,0,2,98,112,0,0,11,106,0,0,
+0,0,0,0,0,0,78,64,12,107,0,3,108,101,100,0,
+12,109,0,9,105,110,102,105,120,95,108,101,100,0,0,0,
+13,108,109,0,26,60,103,6,30,9,1,102,32,32,32,32,
+39,40,39,58,123,39,108,98,112,39,58,55,48,44,39,110,
+117,100,39,58,112,97,114,101,110,95,110,117,100,44,0,0,
+12,61,0,1,40,0,0,0,12,103,0,3,108,98,112,0,
+11,104,0,0,0,0,0,0,0,128,81,64,12,105,0,3,
+110,117,100,0,12,111,0,9,112,97,114,101,110,95,110,117,
+100,0,0,0,13,106,111,0,30,9,1,103,32,32,32,32,
+32,32,32,32,39,98,112,39,58,56,48,44,39,108,101,100,
+39,58,99,97,108,108,95,108,101,100,44,125,44,0,0,0,
+12,107,0,2,98,112,0,0,11,108,0,0,0,0,0,0,
+0,0,84,64,12,109,0,3,108,101,100,0,12,111,0,8,
+99,97,108,108,95,108,101,100,0,0,0,0,13,110,111,0,
+26,62,103,8,30,9,1,104,32,32,32,32,39,91,39,58,
+123,39,108,98,112,39,58,55,48,44,39,110,117,100,39,58,
+108,105,115,116,95,110,117,100,44,0,0,0,12,63,0,1,
+91,0,0,0,12,103,0,3,108,98,112,0,11,104,0,0,
+0,0,0,0,0,128,81,64,12,105,0,3,110,117,100,0,
+12,111,0,8,108,105,115,116,95,110,117,100,0,0,0,0,
+13,106,111,0,30,9,1,105,32,32,32,32,32,32,32,32,
+39,98,112,39,58,56,48,44,39,108,101,100,39,58,103,101,
+116,95,108,101,100,44,125,44,0,0,0,0,12,107,0,2,
+98,112,0,0,11,108,0,0,0,0,0,0,0,0,84,64,
+12,109,0,3,108,101,100,0,12,111,0,7,103,101,116,95,
+108,101,100,0,13,110,111,0,26,64,103,8,30,9,1,106,
+32,32,32,32,39,123,39,58,123,39,108,98,112,39,58,48,
+44,39,110,117,100,39,58,100,105,99,116,95,110,117,100,44,
+125,44,0,0,12,65,0,1,123,0,0,0,12,103,0,3,
+108,98,112,0,11,104,0,0,0,0,0,0,0,0,0,0,
+12,105,0,3,110,117,100,0,12,107,0,8,100,105,99,116,
+95,110,117,100,0,0,0,0,13,106,107,0,26,66,103,4,
+30,14,1,107,32,32,32,32,39,46,39,58,123,39,108,98,
+112,39,58,56,48,44,39,98,112,39,58,56,48,44,39,108,
+101,100,39,58,100,111,116,95,108,101,100,44,39,116,121,112,
+101,39,58,39,103,101,116,39,44,125,44,0,12,67,0,1,
+46,0,0,0,12,103,0,3,108,98,112,0,11,104,0,0,
+0,0,0,0,0,0,84,64,12,105,0,2,98,112,0,0,
+11,106,0,0,0,0,0,0,0,0,84,64,12,107,0,3,
+108,101,100,0,12,111,0,7,100,111,116,95,108,101,100,0,
+13,108,111,0,12,109,0,4,116,121,112,101,0,0,0,0,
+12,110,0,3,103,101,116,0,26,68,103,8,30,13,1,108,
+32,32,32,32,39,98,114,101,97,107,39,58,123,39,108,98,
+112,39,58,48,44,39,110,117,100,39,58,105,116,115,101,108,
+102,44,39,116,121,112,101,39,58,39,98,114,101,97,107,39,
+125,44,0,0,12,69,0,5,98,114,101,97,107,0,0,0,
+12,103,0,3,108,98,112,0,11,104,0,0,0,0,0,0,
+0,0,0,0,12,105,0,3,110,117,100,0,12,109,0,6,
+105,116,115,101,108,102,0,0,13,106,109,0,12,107,0,4,
+116,121,112,101,0,0,0,0,12,108,0,5,98,114,101,97,
+107,0,0,0,26,70,103,6,30,13,1,109,32,32,32,32,
+39,112,97,115,115,39,58,123,39,108,98,112,39,58,48,44,
+39,110,117,100,39,58,105,116,115,101,108,102,44,39,116,121,
+112,101,39,58,39,112,97,115,115,39,125,44,0,0,0,0,
+12,71,0,4,112,97,115,115,0,0,0,0,12,103,0,3,
+108,98,112,0,11,104,0,0,0,0,0,0,0,0,0,0,
+12,105,0,3,110,117,100,0,12,109,0,6,105,116,115,101,
+108,102,0,0,13,106,109,0,12,107,0,4,116,121,112,101,
+0,0,0,0,12,108,0,4,112,97,115,115,0,0,0,0,
+26,72,103,6,30,15,1,110,32,32,32,32,39,99,111,110,
+116,105,110,117,101,39,58,123,39,108,98,112,39,58,48,44,
+39,110,117,100,39,58,105,116,115,101,108,102,44,39,116,121,
+112,101,39,58,39,99,111,110,116,105,110,117,101,39,125,44,
+0,0,0,0,12,73,0,8,99,111,110,116,105,110,117,101,
+0,0,0,0,12,103,0,3,108,98,112,0,11,104,0,0,
+0,0,0,0,0,0,0,0,12,105,0,3,110,117,100,0,
+12,109,0,6,105,116,115,101,108,102,0,0,13,106,109,0,
+12,107,0,4,116,121,112,101,0,0,0,0,12,108,0,8,
+99,111,110,116,105,110,117,101,0,0,0,0,26,74,103,6,
+30,12,1,111,32,32,32,32,39,101,111,102,39,58,123,39,
+108,98,112,39,58,48,44,39,116,121,112,101,39,58,39,101,
+111,102,39,44,39,118,97,108,39,58,39,101,111,102,39,125,
+44,0,0,0,12,75,0,3,101,111,102,0,12,103,0,3,
+108,98,112,0,11,104,0,0,0,0,0,0,0,0,0,0,
+12,105,0,4,116,121,112,101,0,0,0,0,12,106,0,3,
+101,111,102,0,12,107,0,3,118,97,108,0,12,108,0,3,
+101,111,102,0,26,76,103,6,30,13,1,112,32,32,32,32,
+39,100,101,102,39,58,123,39,108,98,112,39,58,48,44,39,
+110,117,100,39,58,100,101,102,95,110,117,100,44,39,116,121,
+112,101,39,58,39,100,101,102,39,44,125,44,0,0,0,0,
+12,77,0,3,100,101,102,0,12,103,0,3,108,98,112,0,
+11,104,0,0,0,0,0,0,0,0,0,0,12,105,0,3,
+110,117,100,0,12,109,0,7,100,101,102,95,110,117,100,0,
+13,106,109,0,12,107,0,4,116,121,112,101,0,0,0,0,
+12,108,0,3,100,101,102,0,26,78,103,6,30,14,1,113,
+32,32,32,32,39,119,104,105,108,101,39,58,123,39,108,98,
+112,39,58,48,44,39,110,117,100,39,58,119,104,105,108,101,
+95,110,117,100,44,39,116,121,112,101,39,58,39,119,104,105,
+108,101,39,44,125,44,0,0,12,79,0,5,119,104,105,108,
+101,0,0,0,12,103,0,3,108,98,112,0,11,104,0,0,
+0,0,0,0,0,0,0,0,12,105,0,3,110,117,100,0,
+12,109,0,9,119,104,105,108,101,95,110,117,100,0,0,0,
+13,106,109,0,12,107,0,4,116,121,112,101,0,0,0,0,
+12,108,0,5,119,104,105,108,101,0,0,0,26,80,103,6,
+30,13,1,114,32,32,32,32,39,102,111,114,39,58,123,39,
+108,98,112,39,58,48,44,39,110,117,100,39,58,102,111,114,
+95,110,117,100,44,39,116,121,112,101,39,58,39,102,111,114,
+39,44,125,44,0,0,0,0,12,81,0,3,102,111,114,0,
+12,103,0,3,108,98,112,0,11,104,0,0,0,0,0,0,
+0,0,0,0,12,105,0,3,110,117,100,0,12,109,0,7,
+102,111,114,95,110,117,100,0,13,106,109,0,12,107,0,4,
+116,121,112,101,0,0,0,0,12,108,0,3,102,111,114,0,
+26,82,103,6,30,13,1,115,32,32,32,32,39,116,114,121,
+39,58,123,39,108,98,112,39,58,48,44,39,110,117,100,39,
+58,116,114,121,95,110,117,100,44,39,116,121,112,101,39,58,
+39,116,114,121,39,44,125,44,0,0,0,0,12,83,0,3,
+116,114,121,0,12,103,0,3,108,98,112,0,11,104,0,0,
+0,0,0,0,0,0,0,0,12,105,0,3,110,117,100,0,
+12,109,0,7,116,114,121,95,110,117,100,0,13,106,109,0,
+12,107,0,4,116,121,112,101,0,0,0,0,12,108,0,3,
+116,114,121,0,26,84,103,6,30,12,1,116,32,32,32,32,
+39,105,102,39,58,123,39,108,98,112,39,58,48,44,39,110,
+117,100,39,58,105,102,95,110,117,100,44,39,116,121,112,101,
+39,58,39,105,102,39,44,125,44,0,0,0,12,85,0,2,
+105,102,0,0,12,103,0,3,108,98,112,0,11,104,0,0,
+0,0,0,0,0,0,0,0,12,105,0,3,110,117,100,0,
+12,109,0,6,105,102,95,110,117,100,0,0,13,106,109,0,
+12,107,0,4,116,121,112,101,0,0,0,0,12,108,0,2,
+105,102,0,0,26,86,103,6,30,14,1,117,32,32,32,32,
+39,99,108,97,115,115,39,58,123,39,108,98,112,39,58,48,
+44,39,110,117,100,39,58,99,108,97,115,115,95,110,117,100,
+44,39,116,121,112,101,39,58,39,99,108,97,115,115,39,44,
+125,44,0,0,12,87,0,5,99,108,97,115,115,0,0,0,
+12,103,0,3,108,98,112,0,11,104,0,0,0,0,0,0,
+0,0,0,0,12,105,0,3,110,117,100,0,12,109,0,9,
+99,108,97,115,115,95,110,117,100,0,0,0,13,106,109,0,
+12,107,0,4,116,121,112,101,0,0,0,0,12,108,0,5,
+99,108,97,115,115,0,0,0,26,88,103,6,30,17,1,118,
+32,32,32,32,39,114,97,105,115,101,39,58,123,39,108,98,
+112,39,58,48,44,39,110,117,100,39,58,112,114,101,102,105,
+120,95,110,117,100,48,44,39,116,121,112,101,39,58,39,114,
+97,105,115,101,39,44,39,98,112,39,58,50,48,44,125,44,
+0,0,0,0,12,89,0,5,114,97,105,115,101,0,0,0,
+12,103,0,3,108,98,112,0,11,104,0,0,0,0,0,0,
+0,0,0,0,12,105,0,3,110,117,100,0,12,111,0,11,
+112,114,101,102,105,120,95,110,117,100,48,0,13,106,111,0,
+12,107,0,4,116,121,112,101,0,0,0,0,12,108,0,5,
+114,97,105,115,101,0,0,0,12,109,0,2,98,112,0,0,
+11,110,0,0,0,0,0,0,0,0,52,64,26,90,103,8,
+30,17,1,119,32,32,32,32,39,114,101,116,117,114,110,39,
+58,123,39,108,98,112,39,58,48,44,39,110,117,100,39,58,
+112,114,101,102,105,120,95,110,117,100,48,44,39,116,121,112,
+101,39,58,39,114,101,116,117,114,110,39,44,39,98,112,39,
+58,49,48,44,125,44,0,0,12,91,0,6,114,101,116,117,
+114,110,0,0,12,103,0,3,108,98,112,0,11,104,0,0,
+0,0,0,0,0,0,0,0,12,105,0,3,110,117,100,0,
+12,111,0,11,112,114,101,102,105,120,95,110,117,100,48,0,
+13,106,111,0,12,107,0,4,116,121,112,101,0,0,0,0,
+12,108,0,6,114,101,116,117,114,110,0,0,12,109,0,2,
+98,112,0,0,11,110,0,0,0,0,0,0,0,0,36,64,
+26,92,103,8,30,17,1,120,32,32,32,32,39,105,109,112,
+111,114,116,39,58,123,39,108,98,112,39,58,48,44,39,110,
+117,100,39,58,112,114,101,102,105,120,95,110,117,100,115,44,
+39,116,121,112,101,39,58,39,105,109,112,111,114,116,39,44,
+39,98,112,39,58,50,48,44,125,44,0,0,12,93,0,6,
+105,109,112,111,114,116,0,0,12,103,0,3,108,98,112,0,
+11,104,0,0,0,0,0,0,0,0,0,0,12,105,0,3,
+110,117,100,0,12,111,0,11,112,114,101,102,105,120,95,110,
+117,100,115,0,13,106,111,0,12,107,0,4,116,121,112,101,
+0,0,0,0,12,108,0,6,105,109,112,111,114,116,0,0,
+12,109,0,2,98,112,0,0,11,110,0,0,0,0,0,0,
+0,0,52,64,26,94,103,8,30,15,1,121,32,32,32,32,
+39,102,114,111,109,39,58,123,39,108,98,112,39,58,48,44,
+39,110,117,100,39,58,102,114,111,109,95,110,117,100,44,39,
+116,121,112,101,39,58,39,102,114,111,109,39,44,39,98,112,
+39,58,50,48,44,125,44,0,12,95,0,4,102,114,111,109,
+0,0,0,0,12,103,0,3,108,98,112,0,11,104,0,0,
+0,0,0,0,0,0,0,0,12,105,0,3,110,117,100,0,
+12,111,0,8,102,114,111,109,95,110,117,100,0,0,0,0,
+13,106,111,0,12,107,0,4,116,121,112,101,0,0,0,0,
+12,108,0,4,102,114,111,109,0,0,0,0,12,109,0,2,
+98,112,0,0,11,110,0,0,0,0,0,0,0,0,52,64,
+26,96,103,8,30,16,1,122,32,32,32,32,39,100,101,108,
+39,58,123,39,108,98,112,39,58,48,44,39,110,117,100,39,
+58,112,114,101,102,105,120,95,110,117,100,115,44,39,116,121,
+112,101,39,58,39,100,101,108,39,44,39,98,112,39,58,49,
+48,44,125,44,0,0,0,0,12,97,0,3,100,101,108,0,
+12,103,0,3,108,98,112,0,11,104,0,0,0,0,0,0,
+0,0,0,0,12,105,0,3,110,117,100,0,12,111,0,11,
+112,114,101,102,105,120,95,110,117,100,115,0,13,106,111,0,
+12,107,0,4,116,121,112,101,0,0,0,0,12,108,0,3,
+100,101,108,0,12,109,0,2,98,112,0,0,11,110,0,0,
+0,0,0,0,0,0,36,64,26,98,103,8,30,17,1,123,
+32,32,32,32,39,103,108,111,98,97,108,39,58,123,39,108,
+98,112,39,58,48,44,39,110,117,100,39,58,112,114,101,102,
+105,120,95,110,117,100,115,44,39,116,121,112,101,39,58,39,
+103,108,111,98,97,108,115,39,44,39,98,112,39,58,50,48,
+44,125,44,0,12,99,0,6,103,108,111,98,97,108,0,0,
+12,103,0,3,108,98,112,0,11,104,0,0,0,0,0,0,
+0,0,0,0,12,105,0,3,110,117,100,0,12,111,0,11,
+112,114,101,102,105,120,95,110,117,100,115,0,13,106,111,0,
+12,107,0,4,116,121,112,101,0,0,0,0,12,108,0,7,
+103,108,111,98,97,108,115,0,12,109,0,2,98,112,0,0,
+11,110,0,0,0,0,0,0,0,0,52,64,26,100,103,8,
+30,3,1,125,32,32,32,32,39,61,39,58,123,0,0,0,
+12,101,0,1,61,0,0,0,30,11,1,126,32,32,32,32,
+32,32,32,32,39,108,98,112,39,58,49,48,44,39,98,112,
+39,58,57,44,39,108,101,100,39,58,105,110,102,105,120,95,
+108,101,100,44,0,0,0,0,12,103,0,3,108,98,112,0,
+11,104,0,0,0,0,0,0,0,0,36,64,12,105,0,2,
+98,112,0,0,11,106,0,0,0,0,0,0,0,0,34,64,
+12,107,0,3,108,101,100,0,12,109,0,9,105,110,102,105,
+120,95,108,101,100,0,0,0,13,108,109,0,26,102,103,6,
+26,44,45,58,14,43,44,0,30,7,1,130,100,101,102,32,
+105,95,105,110,102,105,120,40,98,112,44,108,101,100,44,42,
+118,115,41,58,0,0,0,0,16,43,0,66,44,14,0,0,
+30,7,1,130,100,101,102,32,105,95,105,110,102,105,120,40,
+98,112,44,108,101,100,44,42,118,115,41,58,0,0,0,0,
+12,1,0,8,112,97,114,115,101,46,112,121,0,0,0,0,
+33,1,0,0,12,1,0,7,105,95,105,110,102,105,120,0,
+34,1,0,0,28,2,0,0,9,1,0,2,28,3,0,0,
+9,2,0,3,12,4,0,1,42,0,0,0,9,3,0,4,
+30,16,1,131,32,32,32,32,102,111,114,32,118,32,105,110,
+32,118,115,58,32,98,97,115,101,95,100,109,97,112,91,118,
+93,32,61,32,123,39,108,98,112,39,58,98,112,44,39,98,
+112,39,58,98,112,44,39,108,101,100,39,58,108,101,100,125,
+0,0,0,0,11,5,0,0,0,0,0,0,0,0,0,0,
+42,4,3,5,18,0,0,18,12,7,0,9,98,97,115,101,
+95,100,109,97,112,0,0,0,13,6,7,0,12,8,0,3,
+108,98,112,0,15,9,1,0,12,10,0,2,98,112,0,0,
+15,11,1,0,12,12,0,3,108,101,100,0,15,13,2,0,
+26,7,8,6,10,6,4,7,18,0,255,238,0,0,0,0,
+12,44,0,7,105,95,105,110,102,105,120,0,14,44,43,0,
+30,13,1,132,105,95,105,110,102,105,120,40,52,48,44,105,
+110,102,105,120,95,108,101,100,44,39,60,39,44,39,62,39,
+44,39,60,61,39,44,39,62,61,39,44,39,33,61,39,44,
+39,61,61,39,41,0,0,0,12,46,0,7,105,95,105,110,
+102,105,120,0,13,45,46,0,11,46,0,0,0,0,0,0,
+0,0,68,64,12,54,0,9,105,110,102,105,120,95,108,101,
+100,0,0,0,13,47,54,0,12,48,0,1,60,0,0,0,
+12,49,0,1,62,0,0,0,12,50,0,2,60,61,0,0,
+12,51,0,2,62,61,0,0,12,52,0,2,33,61,0,0,
+12,53,0,2,61,61,0,0,31,44,46,8,19,44,45,44,
+30,8,1,133,105,95,105,110,102,105,120,40,52,48,44,105,
+110,102,105,120,95,105,115,44,39,105,115,39,44,39,105,110,
+39,41,0,0,12,46,0,7,105,95,105,110,102,105,120,0,
+13,45,46,0,11,46,0,0,0,0,0,0,0,0,68,64,
+12,50,0,8,105,110,102,105,120,95,105,115,0,0,0,0,
+13,47,50,0,12,48,0,2,105,115,0,0,12,49,0,2,
+105,110,0,0,31,44,46,4,19,44,45,44,30,15,1,134,
+105,95,105,110,102,105,120,40,49,48,44,105,110,102,105,120,
+95,108,101,100,44,39,43,61,39,44,39,45,61,39,44,39,
+42,61,39,44,39,47,61,39,44,32,39,38,61,39,44,32,
+39,124,61,39,44,32,39,94,61,39,41,0,12,46,0,7,
+105,95,105,110,102,105,120,0,13,45,46,0,11,46,0,0,
+0,0,0,0,0,0,36,64,12,55,0,9,105,110,102,105,
+120,95,108,101,100,0,0,0,13,47,55,0,12,48,0,2,
+43,61,0,0,12,49,0,2,45,61,0,0,12,50,0,2,
+42,61,0,0,12,51,0,2,47,61,0,0,12,52,0,2,
+38,61,0,0,12,53,0,2,124,61,0,0,12,54,0,2,
+94,61,0,0,31,44,46,9,19,44,45,44,30,8,1,135,
+105,95,105,110,102,105,120,40,51,50,44,105,110,102,105,120,
+95,108,101,100,44,39,97,110,100,39,44,39,38,39,41,0,
+12,46,0,7,105,95,105,110,102,105,120,0,13,45,46,0,
+11,46,0,0,0,0,0,0,0,0,64,64,12,50,0,9,
+105,110,102,105,120,95,108,101,100,0,0,0,13,47,50,0,
+12,48,0,3,97,110,100,0,12,49,0,1,38,0,0,0,
+31,44,46,4,19,44,45,44,30,7,1,136,105,95,105,110,
+102,105,120,40,51,49,44,105,110,102,105,120,95,108,101,100,
+44,39,94,39,41,0,0,0,12,46,0,7,105,95,105,110,
+102,105,120,0,13,45,46,0,11,46,0,0,0,0,0,0,
+0,0,63,64,12,49,0,9,105,110,102,105,120,95,108,101,
+100,0,0,0,13,47,49,0,12,48,0,1,94,0,0,0,
+31,44,46,3,19,44,45,44,30,8,1,137,105,95,105,110,
+102,105,120,40,51,48,44,105,110,102,105,120,95,108,101,100,
+44,39,111,114,39,44,39,124,39,41,0,0,12,46,0,7,
+105,95,105,110,102,105,120,0,13,45,46,0,11,46,0,0,
+0,0,0,0,0,0,62,64,12,50,0,9,105,110,102,105,
+120,95,108,101,100,0,0,0,13,47,50,0,12,48,0,2,
+111,114,0,0,12,49,0,1,124,0,0,0,31,44,46,4,
+19,44,45,44,30,8,1,138,105,95,105,110,102,105,120,40,
+51,54,44,105,110,102,105,120,95,108,101,100,44,39,60,60,
+39,44,39,62,62,39,41,0,12,46,0,7,105,95,105,110,
+102,105,120,0,13,45,46,0,11,46,0,0,0,0,0,0,
+0,0,66,64,12,50,0,9,105,110,102,105,120,95,108,101,
+100,0,0,0,13,47,50,0,12,48,0,2,60,60,0,0,
+12,49,0,2,62,62,0,0,31,44,46,4,19,44,45,44,
+30,5,1,139,100,101,102,32,105,95,116,101,114,109,115,40,
+42,118,115,41,58,0,0,0,16,44,0,60,44,11,0,0,
+30,5,1,139,100,101,102,32,105,95,116,101,114,109,115,40,
+42,118,115,41,58,0,0,0,12,1,0,8,112,97,114,115,
+101,46,112,121,0,0,0,0,33,1,0,0,12,1,0,7,
+105,95,116,101,114,109,115,0,34,1,0,0,12,2,0,1,
+42,0,0,0,9,1,0,2,30,14,1,140,32,32,32,32,
+102,111,114,32,118,32,105,110,32,118,115,58,32,98,97,115,
+101,95,100,109,97,112,91,118,93,32,61,32,123,39,108,98,
+112,39,58,48,44,39,110,117,100,39,58,105,116,115,101,108,
+102,125,0,0,11,3,0,0,0,0,0,0,0,0,0,0,
+42,2,1,3,18,0,0,20,12,5,0,9,98,97,115,101,
+95,100,109,97,112,0,0,0,13,4,5,0,12,6,0,3,
+108,98,112,0,11,7,0,0,0,0,0,0,0,0,0,0,
+12,8,0,3,110,117,100,0,12,10,0,6,105,116,115,101,
+108,102,0,0,13,9,10,0,26,5,6,4,10,4,2,5,
+18,0,255,236,0,0,0,0,12,45,0,7,105,95,116,101,
+114,109,115,0,14,45,44,0,30,31,1,141,105,95,116,101,
+114,109,115,40,39,41,39,44,39,125,39,44,39,93,39,44,
+39,59,39,44,39,58,39,44,39,110,108,39,44,39,101,108,
+105,102,39,44,39,101,108,115,101,39,44,39,84,114,117,101,
+39,44,39,70,97,108,115,101,39,44,39,78,111,110,101,39,
+44,39,110,97,109,101,39,44,39,115,116,114,105,110,103,39,
+44,39,110,117,109,98,101,114,39,44,39,105,110,100,101,110,
+116,39,44,39,100,101,100,101,110,116,39,44,39,101,120,99,
+101,112,116,39,41,0,0,0,12,47,0,7,105,95,116,101,
+114,109,115,0,13,46,47,0,12,47,0,1,41,0,0,0,
+12,48,0,1,125,0,0,0,12,49,0,1,93,0,0,0,
+12,50,0,1,59,0,0,0,12,51,0,1,58,0,0,0,
+12,52,0,2,110,108,0,0,12,53,0,4,101,108,105,102,
+0,0,0,0,12,54,0,4,101,108,115,101,0,0,0,0,
+12,55,0,4,84,114,117,101,0,0,0,0,12,56,0,5,
+70,97,108,115,101,0,0,0,12,57,0,4,78,111,110,101,
+0,0,0,0,12,58,0,4,110,97,109,101,0,0,0,0,
+12,59,0,6,115,116,114,105,110,103,0,0,12,60,0,6,
+110,117,109,98,101,114,0,0,12,61,0,6,105,110,100,101,
+110,116,0,0,12,62,0,6,100,101,100,101,110,116,0,0,
+12,63,0,6,101,120,99,101,112,116,0,0,31,45,47,17,
+19,45,46,45,30,8,1,142,98,97,115,101,95,100,109,97,
+112,91,39,110,108,39,93,91,39,118,97,108,39,93,32,61,
+32,39,110,108,39,0,0,0,12,46,0,9,98,97,115,101,
+95,100,109,97,112,0,0,0,13,45,46,0,12,46,0,2,
+110,108,0,0,9,45,45,46,12,46,0,2,110,108,0,0,
+12,47,0,3,118,97,108,0,10,45,47,46,30,4,1,144,
+100,101,102,32,103,109,97,112,40,116,44,118,41,58,0,0,
+16,45,0,75,44,7,0,0,30,4,1,144,100,101,102,32,
+103,109,97,112,40,116,44,118,41,58,0,0,12,1,0,8,
+112,97,114,115,101,46,112,121,0,0,0,0,33,1,0,0,
+12,1,0,4,103,109,97,112,0,0,0,0,34,1,0,0,
+28,2,0,0,9,1,0,2,28,3,0,0,9,2,0,3,
+30,6,1,145,32,32,32,32,105,102,32,118,32,110,111,116,
+32,105,110,32,100,109,97,112,58,0,0,0,12,4,0,4,
+100,109,97,112,0,0,0,0,13,3,4,0,36,3,3,2,
+11,4,0,0,0,0,0,0,0,0,0,0,23,3,3,4,
+21,3,0,0,18,0,0,25,30,9,1,146,32,32,32,32,
+32,32,32,32,101,114,114,111,114,40,39,117,110,107,110,111,
+119,110,32,34,37,115,34,39,37,118,44,116,41,0,0,0,
+12,5,0,5,101,114,114,111,114,0,0,0,13,4,5,0,
+12,5,0,12,117,110,107,110,111,119,110,32,34,37,115,34,
+0,0,0,0,39,5,5,2,15,6,1,0,31,3,5,2,
+19,3,4,3,18,0,0,1,30,5,1,147,32,32,32,32,
+114,101,116,117,114,110,32,100,109,97,112,91,118,93,0,0,
+12,4,0,4,100,109,97,112,0,0,0,0,13,3,4,0,
+9,3,3,2,20,3,0,0,0,0,0,0,12,46,0,4,
+103,109,97,112,0,0,0,0,14,46,45,0,30,3,1,149,
+100,101,102,32,100,111,40,116,41,58,0,0,16,46,0,93,
+44,8,0,0,30,3,1,149,100,101,102,32,100,111,40,116,
+41,58,0,0,12,1,0,8,112,97,114,115,101,46,112,121,
+0,0,0,0,33,1,0,0,12,1,0,2,100,111,0,0,
+34,1,0,0,28,2,0,0,9,1,0,2,30,12,1,150,
+32,32,32,32,105,102,32,116,46,116,121,112,101,32,61,61,
+32,39,115,121,109,98,111,108,39,58,32,114,32,61,32,103,
+109,97,112,40,116,44,116,46,118,97,108,41,0,0,0,0,
+12,3,0,4,116,121,112,101,0,0,0,0,9,2,1,3,
+12,3,0,6,115,121,109,98,111,108,0,0,23,2,2,3,
+21,2,0,0,18,0,0,13,12,5,0,4,103,109,97,112,
+0,0,0,0,13,4,5,0,15,5,1,0,12,7,0,3,
+118,97,108,0,9,6,1,7,31,3,5,2,19,3,4,3,
+15,2,3,0,18,0,0,23,30,8,1,151,32,32,32,32,
+101,108,115,101,58,32,114,32,61,32,103,109,97,112,40,116,
+44,116,46,116,121,112,101,41,0,0,0,0,12,5,0,4,
+103,109,97,112,0,0,0,0,13,4,5,0,15,5,1,0,
+12,7,0,4,116,121,112,101,0,0,0,0,9,6,1,7,
+31,3,5,2,19,3,4,3,15,2,3,0,18,0,0,1,
+30,4,1,152,32,32,32,32,109,101,114,103,101,40,116,44,
+114,41,0,0,12,5,0,5,109,101,114,103,101,0,0,0,
+13,4,5,0,15,5,1,0,15,6,2,0,31,3,5,2,
+19,3,4,3,30,4,1,153,32,32,32,32,114,101,116,117,
+114,110,32,116,0,0,0,0,20,1,0,0,0,0,0,0,
+12,47,0,2,100,111,0,0,14,47,46,0,30,5,1,154,
+100,101,102,32,100,111,95,109,111,100,117,108,101,40,41,58,
+0,0,0,0,16,47,0,132,44,10,0,0,30,5,1,154,
+100,101,102,32,100,111,95,109,111,100,117,108,101,40,41,58,
+0,0,0,0,12,1,0,8,112,97,114,115,101,46,112,121,
+0,0,0,0,33,1,0,0,12,1,0,9,100,111,95,109,
+111,100,117,108,101,0,0,0,34,1,0,0,30,5,1,155,
+32,32,32,32,116,111,107,32,61,32,80,46,116,111,107,101,
+110,0,0,0,12,3,0,1,80,0,0,0,13,2,3,0,
+12,3,0,5,116,111,107,101,110,0,0,0,9,2,2,3,
+15,1,2,0,30,4,1,156,32,32,32,32,105,116,101,109,
+115,32,61,32,91,93,0,0,27,3,0,0,15,2,3,0,
+30,5,1,157,32,32,32,32,105,98,108,111,99,107,40,105,
+116,101,109,115,41,0,0,0,12,5,0,6,105,98,108,111,
+99,107,0,0,13,4,5,0,15,5,2,0,31,3,5,1,
+19,3,4,3,30,5,1,158,32,32,32,32,97,100,118,97,
+110,99,101,40,39,101,111,102,39,41,0,0,12,5,0,7,
+97,100,118,97,110,99,101,0,13,4,5,0,12,5,0,3,
+101,111,102,0,31,3,5,1,19,3,4,3,30,6,1,159,
+32,32,32,32,105,102,32,108,101,110,40,105,116,101,109,115,
+41,32,62,32,49,58,0,0,11,3,0,0,0,0,0,0,
+0,0,240,63,12,6,0,3,108,101,110,0,13,5,6,0,
+15,6,2,0,31,4,6,1,19,4,5,4,25,3,3,4,
+21,3,0,0,18,0,0,34,30,14,1,160,32,32,32,32,
+32,32,32,32,114,101,116,117,114,110,32,84,111,107,101,110,
+40,116,111,107,46,112,111,115,44,39,115,116,97,116,101,109,
+101,110,116,115,39,44,39,59,39,44,105,116,101,109,115,41,
+0,0,0,0,12,5,0,5,84,111,107,101,110,0,0,0,
+13,4,5,0,12,9,0,3,112,111,115,0,9,5,1,9,
+12,6,0,10,115,116,97,116,101,109,101,110,116,115,0,0,
+12,7,0,1,59,0,0,0,15,8,2,0,31,3,5,4,
+19,3,4,3,20,3,0,0,18,0,0,1,30,6,1,161,
+32,32,32,32,114,101,116,117,114,110,32,105,116,101,109,115,
+46,112,111,112,40,41,0,0,12,5,0,3,112,111,112,0,
+9,4,2,5,31,3,0,0,19,3,4,3,20,3,0,0,
+0,0,0,0,12,48,0,9,100,111,95,109,111,100,117,108,
+101,0,0,0,14,48,47,0,30,7,1,163,100,101,102,32,
+112,97,114,115,101,40,115,44,116,111,107,101,110,115,44,119,
+114,97,112,61,48,41,58,0,16,48,0,113,44,9,0,0,
+30,7,1,163,100,101,102,32,112,97,114,115,101,40,115,44,
+116,111,107,101,110,115,44,119,114,97,112,61,48,41,58,0,
+12,1,0,8,112,97,114,115,101,46,112,121,0,0,0,0,
+33,1,0,0,12,1,0,5,112,97,114,115,101,0,0,0,
+34,1,0,0,28,2,0,0,9,1,0,2,28,3,0,0,
+9,2,0,3,11,3,0,0,0,0,0,0,0,0,0,0,
+28,4,0,0,32,3,0,4,30,4,1,164,32,32,32,32,
+103,108,111,98,97,108,32,80,0,0,0,0,30,7,1,165,
+32,32,32,32,115,32,61,32,116,111,107,101,110,105,122,101,
+46,99,108,101,97,110,40,115,41,0,0,0,12,6,0,8,
+116,111,107,101,110,105,122,101,0,0,0,0,13,5,6,0,
+12,6,0,5,99,108,101,97,110,0,0,0,9,5,5,6,
+15,6,1,0,31,4,6,1,19,4,5,4,15,1,4,0,
+30,8,1,166,32,32,32,32,80,61,80,68,97,116,97,40,
+115,44,116,111,107,101,110,115,41,59,32,80,46,105,110,105,
+116,40,41,0,12,4,0,1,80,0,0,0,12,7,0,5,
+80,68,97,116,97,0,0,0,13,6,7,0,15,7,1,0,
+15,8,2,0,31,5,7,2,19,5,6,5,14,4,5,0,
+12,6,0,1,80,0,0,0,13,5,6,0,12,6,0,4,
+105,110,105,116,0,0,0,0,9,5,5,6,31,4,0,0,
+19,4,5,4,30,5,1,167,32,32,32,32,114,32,61,32,
+100,111,95,109,111,100,117,108,101,40,41,0,12,7,0,9,
+100,111,95,109,111,100,117,108,101,0,0,0,13,6,7,0,
+31,5,0,0,19,5,6,5,15,4,5,0,30,4,1,168,
+32,32,32,32,80,32,61,32,78,111,110,101,0,0,0,0,
+12,5,0,1,80,0,0,0,28,6,0,0,14,5,6,0,
+30,4,1,169,32,32,32,32,114,101,116,117,114,110,32,114,
+0,0,0,0,20,4,0,0,0,0,0,0,12,49,0,5,
+112,97,114,115,101,0,0,0,14,49,48,0,0,0,0,0,
+};
+unsigned char tp_encode[] = {
+44,104,0,0,30,6,0,1,105,109,112,111,114,116,32,116,
+111,107,101,110,105,122,101,44,32,115,121,115,0,0,0,0,
+12,0,0,9,101,110,99,111,100,101,46,112,121,0,0,0,
+33,0,0,0,12,0,0,1,63,0,0,0,34,0,0,0,
+12,2,0,6,105,109,112,111,114,116,0,0,13,1,2,0,
+12,2,0,8,116,111,107,101,110,105,122,101,0,0,0,0,
+31,0,2,1,19,0,1,0,12,1,0,8,116,111,107,101,
+110,105,122,101,0,0,0,0,14,1,0,0,12,2,0,6,
+105,109,112,111,114,116,0,0,13,1,2,0,12,2,0,3,
+115,121,115,0,31,0,2,1,19,0,1,0,12,1,0,3,
+115,121,115,0,14,1,0,0,30,7,0,2,102,114,111,109,
+32,116,111,107,101,110,105,122,101,32,105,109,112,111,114,116,
+32,84,111,107,101,110,0,0,12,2,0,6,105,109,112,111,
+114,116,0,0,13,1,2,0,12,2,0,8,116,111,107,101,
+110,105,122,101,0,0,0,0,31,0,2,1,19,0,1,0,
+12,2,0,8,95,95,100,105,99,116,95,95,0,0,0,0,
+13,1,2,0,12,3,0,5,84,111,107,101,110,0,0,0,
+9,2,0,3,12,0,0,5,84,111,107,101,110,0,0,0,
+10,1,0,2,30,8,0,3,105,102,32,110,111,116,32,34,
+116,105,110,121,112,121,34,32,105,110,32,115,121,115,46,118,
+101,114,115,105,111,110,58,0,12,2,0,3,115,121,115,0,
+13,1,2,0,12,2,0,7,118,101,114,115,105,111,110,0,
+9,1,1,2,12,2,0,6,116,105,110,121,112,121,0,0,
+36,1,1,2,47,0,1,0,21,0,0,0,18,0,0,30,
+30,6,0,4,32,32,32,32,102,114,111,109,32,98,111,111,
+116,32,105,109,112,111,114,116,32,42,0,0,12,2,0,6,
+105,109,112,111,114,116,0,0,13,1,2,0,12,2,0,4,
+98,111,111,116,0,0,0,0,31,0,2,1,19,0,1,0,
+12,3,0,5,109,101,114,103,101,0,0,0,13,2,3,0,
+12,5,0,8,95,95,100,105,99,116,95,95,0,0,0,0,
+13,3,5,0,15,4,0,0,31,1,3,2,19,1,2,1,
+18,0,0,1,30,94,0,6,69,79,70,44,65,68,68,44,
+83,85,66,44,77,85,76,44,68,73,86,44,80,79,87,44,
+66,73,84,65,78,68,44,66,73,84,79,82,44,67,77,80,
+44,71,69,84,44,83,69,84,44,78,85,77,66,69,82,44,
+83,84,82,73,78,71,44,71,71,69,84,44,71,83,69,84,
+44,77,79,86,69,44,68,69,70,44,80,65,83,83,44,74,
+85,77,80,44,67,65,76,76,44,82,69,84,85,82,78,44,
+73,70,44,68,69,66,85,71,44,69,81,44,76,69,44,76,
+84,44,68,73,67,84,44,76,73,83,84,44,78,79,78,69,
+44,76,69,78,44,80,79,83,44,80,65,82,65,77,83,44,
+73,71,69,84,44,70,73,76,69,44,78,65,77,69,44,78,
+69,44,72,65,83,44,82,65,73,83,69,44,83,69,84,74,
+77,80,44,77,79,68,44,76,83,72,44,82,83,72,44,73,
+84,69,82,44,68,69,76,44,82,69,71,83,44,66,73,84,
+88,79,82,44,73,70,78,44,78,79,84,44,66,73,84,78,
+79,84,32,61,32,48,44,49,44,50,44,51,44,52,44,53,
+44,54,44,55,44,56,44,57,44,49,48,44,49,49,44,49,
+50,44,49,51,44,49,52,44,49,53,44,49,54,44,49,55,
+44,49,56,44,49,57,44,50,48,44,50,49,44,50,50,44,
+50,51,44,50,52,44,50,53,44,50,54,44,50,55,44,50,
+56,44,50,57,44,51,48,44,51,49,44,51,50,44,51,51,
+44,51,52,44,51,53,44,51,54,44,51,55,44,51,56,44,
+51,57,44,52,48,44,52,49,44,52,50,44,52,51,44,52,
+52,44,52,53,44,52,54,44,52,55,44,52,56,0,0,0,
+11,1,0,0,0,0,0,0,0,0,0,0,15,0,1,0,
+11,2,0,0,0,0,0,0,0,0,240,63,15,1,2,0,
+11,3,0,0,0,0,0,0,0,0,0,64,15,2,3,0,
+11,4,0,0,0,0,0,0,0,0,8,64,15,3,4,0,
+11,5,0,0,0,0,0,0,0,0,16,64,15,4,5,0,
+11,6,0,0,0,0,0,0,0,0,20,64,15,5,6,0,
+11,7,0,0,0,0,0,0,0,0,24,64,15,6,7,0,
+11,8,0,0,0,0,0,0,0,0,28,64,15,7,8,0,
+11,9,0,0,0,0,0,0,0,0,32,64,15,8,9,0,
+11,10,0,0,0,0,0,0,0,0,34,64,15,9,10,0,
+11,11,0,0,0,0,0,0,0,0,36,64,15,10,11,0,
+11,12,0,0,0,0,0,0,0,0,38,64,15,11,12,0,
+11,13,0,0,0,0,0,0,0,0,40,64,15,12,13,0,
+11,14,0,0,0,0,0,0,0,0,42,64,15,13,14,0,
+11,15,0,0,0,0,0,0,0,0,44,64,15,14,15,0,
+11,16,0,0,0,0,0,0,0,0,46,64,15,15,16,0,
+11,17,0,0,0,0,0,0,0,0,48,64,15,16,17,0,
+11,18,0,0,0,0,0,0,0,0,49,64,15,17,18,0,
+11,19,0,0,0,0,0,0,0,0,50,64,15,18,19,0,
+11,20,0,0,0,0,0,0,0,0,51,64,15,19,20,0,
+11,21,0,0,0,0,0,0,0,0,52,64,15,20,21,0,
+11,22,0,0,0,0,0,0,0,0,53,64,15,21,22,0,
+11,23,0,0,0,0,0,0,0,0,54,64,15,22,23,0,
+11,24,0,0,0,0,0,0,0,0,55,64,15,23,24,0,
+11,25,0,0,0,0,0,0,0,0,56,64,15,24,25,0,
+11,26,0,0,0,0,0,0,0,0,57,64,15,25,26,0,
+11,27,0,0,0,0,0,0,0,0,58,64,15,26,27,0,
+11,28,0,0,0,0,0,0,0,0,59,64,15,27,28,0,
+11,29,0,0,0,0,0,0,0,0,60,64,15,28,29,0,
+11,30,0,0,0,0,0,0,0,0,61,64,15,29,30,0,
+11,31,0,0,0,0,0,0,0,0,62,64,15,30,31,0,
+11,32,0,0,0,0,0,0,0,0,63,64,15,31,32,0,
+11,33,0,0,0,0,0,0,0,0,64,64,15,32,33,0,
+11,34,0,0,0,0,0,0,0,128,64,64,15,33,34,0,
+11,35,0,0,0,0,0,0,0,0,65,64,15,34,35,0,
+11,36,0,0,0,0,0,0,0,128,65,64,15,35,36,0,
+11,37,0,0,0,0,0,0,0,0,66,64,15,36,37,0,
+11,38,0,0,0,0,0,0,0,128,66,64,15,37,38,0,
+11,39,0,0,0,0,0,0,0,0,67,64,15,38,39,0,
+11,40,0,0,0,0,0,0,0,128,67,64,15,39,40,0,
+11,41,0,0,0,0,0,0,0,0,68,64,15,40,41,0,
+11,42,0,0,0,0,0,0,0,128,68,64,15,41,42,0,
+11,43,0,0,0,0,0,0,0,0,69,64,15,42,43,0,
+11,44,0,0,0,0,0,0,0,128,69,64,15,43,44,0,
+11,45,0,0,0,0,0,0,0,0,70,64,15,44,45,0,
+11,46,0,0,0,0,0,0,0,128,70,64,15,45,46,0,
+11,47,0,0,0,0,0,0,0,0,71,64,15,46,47,0,
+11,48,0,0,0,0,0,0,0,128,71,64,15,47,48,0,
+11,49,0,0,0,0,0,0,0,0,72,64,15,48,49,0,
+12,49,0,3,69,79,70,0,14,49,0,0,12,0,0,3,
+65,68,68,0,14,0,1,0,12,0,0,3,83,85,66,0,
+14,0,2,0,12,0,0,3,77,85,76,0,14,0,3,0,
+12,0,0,3,68,73,86,0,14,0,4,0,12,0,0,3,
+80,79,87,0,14,0,5,0,12,0,0,6,66,73,84,65,
+78,68,0,0,14,0,6,0,12,0,0,5,66,73,84,79,
+82,0,0,0,14,0,7,0,12,0,0,3,67,77,80,0,
+14,0,8,0,12,0,0,3,71,69,84,0,14,0,9,0,
+12,0,0,3,83,69,84,0,14,0,10,0,12,0,0,6,
+78,85,77,66,69,82,0,0,14,0,11,0,12,0,0,6,
+83,84,82,73,78,71,0,0,14,0,12,0,12,0,0,4,
+71,71,69,84,0,0,0,0,14,0,13,0,12,0,0,4,
+71,83,69,84,0,0,0,0,14,0,14,0,12,0,0,4,
+77,79,86,69,0,0,0,0,14,0,15,0,12,0,0,3,
+68,69,70,0,14,0,16,0,12,0,0,4,80,65,83,83,
+0,0,0,0,14,0,17,0,12,0,0,4,74,85,77,80,
+0,0,0,0,14,0,18,0,12,0,0,4,67,65,76,76,
+0,0,0,0,14,0,19,0,12,0,0,6,82,69,84,85,
+82,78,0,0,14,0,20,0,12,0,0,2,73,70,0,0,
+14,0,21,0,12,0,0,5,68,69,66,85,71,0,0,0,
+14,0,22,0,12,0,0,2,69,81,0,0,14,0,23,0,
+12,0,0,2,76,69,0,0,14,0,24,0,12,0,0,2,
+76,84,0,0,14,0,25,0,12,0,0,4,68,73,67,84,
+0,0,0,0,14,0,26,0,12,0,0,4,76,73,83,84,
+0,0,0,0,14,0,27,0,12,0,0,4,78,79,78,69,
+0,0,0,0,14,0,28,0,12,0,0,3,76,69,78,0,
+14,0,29,0,12,0,0,3,80,79,83,0,14,0,30,0,
+12,0,0,6,80,65,82,65,77,83,0,0,14,0,31,0,
+12,0,0,4,73,71,69,84,0,0,0,0,14,0,32,0,
+12,0,0,4,70,73,76,69,0,0,0,0,14,0,33,0,
+12,0,0,4,78,65,77,69,0,0,0,0,14,0,34,0,
+12,0,0,2,78,69,0,0,14,0,35,0,12,0,0,3,
+72,65,83,0,14,0,36,0,12,0,0,5,82,65,73,83,
+69,0,0,0,14,0,37,0,12,0,0,6,83,69,84,74,
+77,80,0,0,14,0,38,0,12,0,0,3,77,79,68,0,
+14,0,39,0,12,0,0,3,76,83,72,0,14,0,40,0,
+12,0,0,3,82,83,72,0,14,0,41,0,12,0,0,4,
+73,84,69,82,0,0,0,0,14,0,42,0,12,0,0,3,
+68,69,76,0,14,0,43,0,12,0,0,4,82,69,71,83,
+0,0,0,0,14,0,44,0,12,0,0,6,66,73,84,88,
+79,82,0,0,14,0,45,0,12,0,0,3,73,70,78,0,
+14,0,46,0,12,0,0,3,78,79,84,0,14,0,47,0,
+12,0,0,6,66,73,84,78,79,84,0,0,14,0,48,0,
+30,4,0,8,99,108,97,115,115,32,68,83,116,97,116,101,
+58,0,0,0,26,0,0,0,12,1,0,6,68,83,116,97,
+116,101,0,0,14,1,0,0,12,3,0,7,115,101,116,109,
+101,116,97,0,13,2,3,0,15,3,0,0,12,5,0,6,
+111,98,106,101,99,116,0,0,13,4,5,0,31,1,3,2,
+19,1,2,1,16,1,0,166,44,11,0,0,30,9,0,9,
+32,32,32,32,100,101,102,32,95,95,105,110,105,116,95,95,
+40,115,101,108,102,44,99,111,100,101,44,102,110,97,109,101,
+41,58,0,0,12,1,0,9,101,110,99,111,100,101,46,112,
+121,0,0,0,33,1,0,0,12,1,0,8,95,95,105,110,
+105,116,95,95,0,0,0,0,34,1,0,0,28,2,0,0,
+9,1,0,2,28,3,0,0,9,2,0,3,28,4,0,0,
+9,3,0,4,30,11,0,10,32,32,32,32,32,32,32,32,
+115,101,108,102,46,99,111,100,101,44,32,115,101,108,102,46,
+102,110,97,109,101,32,61,32,99,111,100,101,44,102,110,97,
+109,101,0,0,15,4,2,0,15,5,3,0,12,6,0,4,
+99,111,100,101,0,0,0,0,10,1,6,4,12,4,0,5,
+102,110,97,109,101,0,0,0,10,1,4,5,30,11,0,11,
+32,32,32,32,32,32,32,32,115,101,108,102,46,108,105,110,
+101,115,32,61,32,115,101,108,102,46,99,111,100,101,46,115,
+112,108,105,116,40,39,92,110,39,41,0,0,12,6,0,4,
+99,111,100,101,0,0,0,0,9,5,1,6,12,6,0,5,
+115,112,108,105,116,0,0,0,9,5,5,6,12,6,0,1,
+10,0,0,0,31,4,6,1,19,4,5,4,12,5,0,5,
+108,105,110,101,115,0,0,0,10,1,5,4,30,27,0,13,
+32,32,32,32,32,32,32,32,115,101,108,102,46,115,116,97,
+99,107,44,115,101,108,102,46,111,117,116,44,115,101,108,102,
+46,95,115,99,111,112,101,105,44,115,101,108,102,46,116,115,
+116,97,99,107,44,115,101,108,102,46,95,116,97,103,105,44,
+115,101,108,102,46,100,97,116,97,32,61,32,91,93,44,91,
+40,39,116,97,103,39,44,39,69,79,70,39,41,93,44,48,
+44,91,93,44,48,44,123,125,0,0,0,0,27,5,0,0,
+15,4,5,0,12,8,0,3,116,97,103,0,12,9,0,3,
+69,79,70,0,27,7,8,2,27,6,7,1,15,5,6,0,
+11,7,0,0,0,0,0,0,0,0,0,0,15,6,7,0,
+27,8,0,0,15,7,8,0,11,9,0,0,0,0,0,0,
+0,0,0,0,15,8,9,0,26,10,0,0,15,9,10,0,
+12,10,0,5,115,116,97,99,107,0,0,0,10,1,10,4,
+12,4,0,3,111,117,116,0,10,1,4,5,12,4,0,7,
+95,115,99,111,112,101,105,0,10,1,4,6,12,4,0,6,
+116,115,116,97,99,107,0,0,10,1,4,7,12,4,0,5,
+95,116,97,103,105,0,0,0,10,1,4,8,12,4,0,4,
+100,97,116,97,0,0,0,0,10,1,4,9,30,7,0,14,
+32,32,32,32,32,32,32,32,115,101,108,102,46,101,114,114,
+111,114,32,61,32,70,97,108,115,101,0,0,11,4,0,0,
+0,0,0,0,0,0,0,0,12,5,0,5,101,114,114,111,
+114,0,0,0,10,1,5,4,0,0,0,0,12,2,0,8,
+95,95,105,110,105,116,95,95,0,0,0,0,10,0,2,1,
+16,2,1,92,44,19,0,0,30,8,0,15,32,32,32,32,
+100,101,102,32,98,101,103,105,110,40,115,101,108,102,44,103,
+98,108,61,70,97,108,115,101,41,58,0,0,12,1,0,9,
+101,110,99,111,100,101,46,112,121,0,0,0,33,1,0,0,
+12,1,0,5,98,101,103,105,110,0,0,0,34,1,0,0,
+28,2,0,0,9,1,0,2,11,2,0,0,0,0,0,0,
+0,0,0,0,28,3,0,0,32,2,0,3,30,46,0,16,
+32,32,32,32,32,32,32,32,105,102,32,108,101,110,40,115,
+101,108,102,46,115,116,97,99,107,41,58,32,115,101,108,102,
+46,115,116,97,99,107,46,97,112,112,101,110,100,40,40,115,
+101,108,102,46,118,97,114,115,44,115,101,108,102,46,114,50,
+110,44,115,101,108,102,46,110,50,114,44,115,101,108,102,46,
+95,116,109,112,105,44,115,101,108,102,46,109,114,101,103,44,
+115,101,108,102,46,115,110,117,109,44,115,101,108,102,46,95,
+103,108,111,98,97,108,115,44,115,101,108,102,46,108,105,110,
+101,110,111,44,115,101,108,102,46,103,108,111,98,97,108,115,
+44,115,101,108,102,46,114,103,108,111,98,97,108,115,44,115,
+101,108,102,46,99,114,101,103,115,44,115,101,108,102,46,116,
+109,112,99,41,41,0,0,0,12,5,0,3,108,101,110,0,
+13,4,5,0,12,6,0,5,115,116,97,99,107,0,0,0,
+9,5,1,6,31,3,5,1,19,3,4,3,21,3,0,0,
+18,0,0,61,12,5,0,5,115,116,97,99,107,0,0,0,
+9,4,1,5,12,5,0,6,97,112,112,101,110,100,0,0,
+9,4,4,5,12,18,0,4,118,97,114,115,0,0,0,0,
+9,6,1,18,12,18,0,3,114,50,110,0,9,7,1,18,
+12,18,0,3,110,50,114,0,9,8,1,18,12,18,0,5,
+95,116,109,112,105,0,0,0,9,9,1,18,12,18,0,4,
+109,114,101,103,0,0,0,0,9,10,1,18,12,18,0,4,
+115,110,117,109,0,0,0,0,9,11,1,18,12,18,0,8,
+95,103,108,111,98,97,108,115,0,0,0,0,9,12,1,18,
+12,18,0,6,108,105,110,101,110,111,0,0,9,13,1,18,
+12,18,0,7,103,108,111,98,97,108,115,0,9,14,1,18,
+12,18,0,8,114,103,108,111,98,97,108,115,0,0,0,0,
+9,15,1,18,12,18,0,5,99,114,101,103,115,0,0,0,
+9,16,1,18,12,18,0,4,116,109,112,99,0,0,0,0,
+9,17,1,18,27,5,6,12,31,3,5,1,19,3,4,3,
+18,0,0,24,30,10,0,17,32,32,32,32,32,32,32,32,
+101,108,115,101,58,32,115,101,108,102,46,115,116,97,99,107,
+46,97,112,112,101,110,100,40,78,111,110,101,41,0,0,0,
+12,5,0,5,115,116,97,99,107,0,0,0,9,4,1,5,
+12,5,0,6,97,112,112,101,110,100,0,0,9,4,4,5,
+28,5,0,0,31,3,5,1,19,3,4,3,18,0,0,1,
+30,50,0,18,32,32,32,32,32,32,32,32,115,101,108,102,
+46,118,97,114,115,44,115,101,108,102,46,114,50,110,44,115,
+101,108,102,46,110,50,114,44,115,101,108,102,46,95,116,109,
+112,105,44,115,101,108,102,46,109,114,101,103,44,115,101,108,
+102,46,115,110,117,109,44,115,101,108,102,46,95,103,108,111,
+98,97,108,115,44,115,101,108,102,46,108,105,110,101,110,111,
+44,115,101,108,102,46,103,108,111,98,97,108,115,44,115,101,
+108,102,46,114,103,108,111,98,97,108,115,44,115,101,108,102,
+46,99,114,101,103,115,44,115,101,108,102,46,116,109,112,99,
+32,61,32,91,93,44,123,125,44,123,125,44,48,44,48,44,
+115,116,114,40,115,101,108,102,46,95,115,99,111,112,101,105,
+41,44,103,98,108,44,45,49,44,91,93,44,91,93,44,91,
+39,114,101,103,115,39,93,44,48,0,0,0,27,4,0,0,
+15,3,4,0,26,5,0,0,15,4,5,0,26,6,0,0,
+15,5,6,0,11,7,0,0,0,0,0,0,0,0,0,0,
+15,6,7,0,11,8,0,0,0,0,0,0,0,0,0,0,
+15,7,8,0,12,11,0,3,115,116,114,0,13,10,11,0,
+12,12,0,7,95,115,99,111,112,101,105,0,9,11,1,12,
+31,9,11,1,19,9,10,9,15,8,9,0,15,9,2,0,
+11,11,0,0,0,0,0,0,0,0,240,191,15,10,11,0,
+27,12,0,0,15,11,12,0,27,13,0,0,15,12,13,0,
+12,15,0,4,114,101,103,115,0,0,0,0,27,14,15,1,
+15,13,14,0,11,15,0,0,0,0,0,0,0,0,0,0,
+15,14,15,0,12,15,0,4,118,97,114,115,0,0,0,0,
+10,1,15,3,12,3,0,3,114,50,110,0,10,1,3,4,
+12,3,0,3,110,50,114,0,10,1,3,5,12,3,0,5,
+95,116,109,112,105,0,0,0,10,1,3,6,12,3,0,4,
+109,114,101,103,0,0,0,0,10,1,3,7,12,3,0,4,
+115,110,117,109,0,0,0,0,10,1,3,8,12,3,0,8,
+95,103,108,111,98,97,108,115,0,0,0,0,10,1,3,9,
+12,3,0,6,108,105,110,101,110,111,0,0,10,1,3,10,
+12,3,0,7,103,108,111,98,97,108,115,0,10,1,3,11,
+12,3,0,8,114,103,108,111,98,97,108,115,0,0,0,0,
+10,1,3,12,12,3,0,5,99,114,101,103,115,0,0,0,
+10,1,3,13,12,3,0,4,116,109,112,99,0,0,0,0,
+10,1,3,14,30,7,0,19,32,32,32,32,32,32,32,32,
+115,101,108,102,46,95,115,99,111,112,101,105,32,43,61,32,
+49,0,0,0,12,4,0,7,95,115,99,111,112,101,105,0,
+9,3,1,4,11,4,0,0,0,0,0,0,0,0,240,63,
+1,3,3,4,12,4,0,7,95,115,99,111,112,101,105,0,
+10,1,4,3,30,7,0,20,32,32,32,32,32,32,32,32,
+105,110,115,101,114,116,40,115,101,108,102,46,99,114,101,103,
+115,41,0,0,12,5,0,6,105,110,115,101,114,116,0,0,
+13,4,5,0,12,6,0,5,99,114,101,103,115,0,0,0,
+9,5,1,6,31,3,5,1,19,3,4,3,0,0,0,0,
+12,3,0,5,98,101,103,105,110,0,0,0,10,0,3,2,
+16,3,1,50,44,7,0,0,30,5,0,21,32,32,32,32,
+100,101,102,32,101,110,100,40,115,101,108,102,41,58,0,0,
+12,1,0,9,101,110,99,111,100,101,46,112,121,0,0,0,
+33,1,0,0,12,1,0,3,101,110,100,0,34,1,0,0,
+28,2,0,0,9,1,0,2,30,10,0,22,32,32,32,32,
+32,32,32,32,115,101,108,102,46,99,114,101,103,115,46,97,
+112,112,101,110,100,40,115,101,108,102,46,109,114,101,103,41,
+0,0,0,0,12,4,0,5,99,114,101,103,115,0,0,0,
+9,3,1,4,12,4,0,6,97,112,112,101,110,100,0,0,
+9,3,3,4,12,5,0,4,109,114,101,103,0,0,0,0,
+9,4,1,5,31,2,4,1,19,2,3,2,30,5,0,23,
+32,32,32,32,32,32,32,32,99,111,100,101,40,69,79,70,
+41,0,0,0,12,4,0,4,99,111,100,101,0,0,0,0,
+13,3,4,0,12,5,0,3,69,79,70,0,13,4,5,0,
+31,2,4,1,19,2,3,2,30,7,0,29,32,32,32,32,
+32,32,32,32,105,102,32,115,101,108,102,46,116,109,112,99,
+32,33,61,32,48,58,0,0,12,3,0,4,116,109,112,99,
+0,0,0,0,9,2,1,3,11,3,0,0,0,0,0,0,
+0,0,0,0,35,2,2,3,21,2,0,0,18,0,0,39,
+30,17,0,30,32,32,32,32,32,32,32,32,32,32,32,32,
+112,114,105,110,116,40,34,87,97,114,110,105,110,103,58,92,
+110,101,110,99,111,100,101,46,112,121,32,99,111,110,116,97,
+105,110,115,32,97,32,114,101,103,105,115,116,101,114,32,108,
+101,97,107,92,110,34,41,0,12,4,0,5,112,114,105,110,
+116,0,0,0,13,3,4,0,12,4,0,44,87,97,114,110,
+105,110,103,58,10,101,110,99,111,100,101,46,112,121,32,99,
+111,110,116,97,105,110,115,32,97,32,114,101,103,105,115,116,
+101,114,32,108,101,97,107,10,0,0,0,0,31,2,4,1,
+19,2,3,2,18,0,0,1,30,8,0,32,32,32,32,32,
+32,32,32,32,105,102,32,108,101,110,40,115,101,108,102,46,
+115,116,97,99,107,41,32,62,32,49,58,0,11,2,0,0,
+0,0,0,0,0,0,240,63,12,5,0,3,108,101,110,0,
+13,4,5,0,12,6,0,5,115,116,97,99,107,0,0,0,
+9,5,1,6,31,3,5,1,19,3,4,3,25,2,2,3,
+21,2,0,0,18,0,0,149,30,41,0,33,32,32,32,32,
+32,32,32,32,32,32,32,32,115,101,108,102,46,118,97,114,
+115,44,115,101,108,102,46,114,50,110,44,115,101,108,102,46,
+110,50,114,44,115,101,108,102,46,95,116,109,112,105,44,115,
+101,108,102,46,109,114,101,103,44,115,101,108,102,46,115,110,
+117,109,44,115,101,108,102,46,95,103,108,111,98,97,108,115,
+44,115,101,108,102,46,108,105,110,101,110,111,44,115,101,108,
+102,46,103,108,111,98,97,108,115,44,115,101,108,102,46,114,
+103,108,111,98,97,108,115,44,115,101,108,102,46,99,114,101,
+103,115,44,115,101,108,102,46,116,109,112,99,32,61,32,115,
+101,108,102,46,115,116,97,99,107,46,112,111,112,40,41,0,
+12,4,0,5,115,116,97,99,107,0,0,0,9,3,1,4,
+12,4,0,3,112,111,112,0,9,3,3,4,31,2,0,0,
+19,2,3,2,11,4,0,0,0,0,0,0,0,0,0,0,
+9,3,2,4,12,4,0,4,118,97,114,115,0,0,0,0,
+10,1,4,3,11,4,0,0,0,0,0,0,0,0,240,63,
+9,3,2,4,12,4,0,3,114,50,110,0,10,1,4,3,
+11,4,0,0,0,0,0,0,0,0,0,64,9,3,2,4,
+12,4,0,3,110,50,114,0,10,1,4,3,11,4,0,0,
+0,0,0,0,0,0,8,64,9,3,2,4,12,4,0,5,
+95,116,109,112,105,0,0,0,10,1,4,3,11,4,0,0,
+0,0,0,0,0,0,16,64,9,3,2,4,12,4,0,4,
+109,114,101,103,0,0,0,0,10,1,4,3,11,4,0,0,
+0,0,0,0,0,0,20,64,9,3,2,4,12,4,0,4,
+115,110,117,109,0,0,0,0,10,1,4,3,11,4,0,0,
+0,0,0,0,0,0,24,64,9,3,2,4,12,4,0,8,
+95,103,108,111,98,97,108,115,0,0,0,0,10,1,4,3,
+11,4,0,0,0,0,0,0,0,0,28,64,9,3,2,4,
+12,4,0,6,108,105,110,101,110,111,0,0,10,1,4,3,
+11,4,0,0,0,0,0,0,0,0,32,64,9,3,2,4,
+12,4,0,7,103,108,111,98,97,108,115,0,10,1,4,3,
+11,4,0,0,0,0,0,0,0,0,34,64,9,3,2,4,
+12,4,0,8,114,103,108,111,98,97,108,115,0,0,0,0,
+10,1,4,3,11,4,0,0,0,0,0,0,0,0,36,64,
+9,3,2,4,12,4,0,5,99,114,101,103,115,0,0,0,
+10,1,4,3,11,4,0,0,0,0,0,0,0,0,38,64,
+9,3,2,4,12,4,0,4,116,109,112,99,0,0,0,0,
+10,1,4,3,18,0,0,20,30,8,0,34,32,32,32,32,
+32,32,32,32,101,108,115,101,58,32,115,101,108,102,46,115,
+116,97,99,107,46,112,111,112,40,41,0,0,12,4,0,5,
+115,116,97,99,107,0,0,0,9,3,1,4,12,4,0,3,
+112,111,112,0,9,3,3,4,31,2,0,0,19,2,3,2,
+18,0,0,1,0,0,0,0,12,4,0,3,101,110,100,0,
+10,0,4,3,30,8,0,37,100,101,102,32,105,110,115,101,
+114,116,40,118,41,58,32,68,46,111,117,116,46,97,112,112,
+101,110,100,40,118,41,0,0,16,0,0,36,44,5,0,0,
+30,8,0,37,100,101,102,32,105,110,115,101,114,116,40,118,
+41,58,32,68,46,111,117,116,46,97,112,112,101,110,100,40,
+118,41,0,0,12,1,0,9,101,110,99,111,100,101,46,112,
+121,0,0,0,33,1,0,0,12,1,0,6,105,110,115,101,
+114,116,0,0,34,1,0,0,28,2,0,0,9,1,0,2,
+12,4,0,1,68,0,0,0,13,3,4,0,12,4,0,3,
+111,117,116,0,9,3,3,4,12,4,0,6,97,112,112,101,
+110,100,0,0,9,3,3,4,15,4,1,0,31,2,4,1,
+19,2,3,2,0,0,0,0,12,4,0,6,105,110,115,101,
+114,116,0,0,14,4,0,0,30,4,0,38,100,101,102,32,
+119,114,105,116,101,40,118,41,58,0,0,0,16,4,0,120,
+44,14,0,0,30,4,0,38,100,101,102,32,119,114,105,116,
+101,40,118,41,58,0,0,0,12,1,0,9,101,110,99,111,
+100,101,46,112,121,0,0,0,33,1,0,0,12,1,0,5,
+119,114,105,116,101,0,0,0,34,1,0,0,28,2,0,0,
+9,1,0,2,30,7,0,39,32,32,32,32,105,102,32,105,
+115,116,121,112,101,40,118,44,39,108,105,115,116,39,41,58,
+0,0,0,0,12,4,0,6,105,115,116,121,112,101,0,0,
+13,3,4,0,15,4,1,0,12,5,0,4,108,105,115,116,
+0,0,0,0,31,2,4,2,19,2,3,2,21,2,0,0,
+18,0,0,22,30,5,0,40,32,32,32,32,32,32,32,32,
+105,110,115,101,114,116,40,118,41,0,0,0,12,4,0,6,
+105,110,115,101,114,116,0,0,13,3,4,0,15,4,1,0,
+31,2,4,1,19,2,3,2,30,4,0,41,32,32,32,32,
+32,32,32,32,114,101,116,117,114,110,0,0,28,2,0,0,
+20,2,0,0,18,0,0,1,30,8,0,42,32,32,32,32,
+102,111,114,32,110,32,105,110,32,114,97,110,103,101,40,48,
+44,108,101,110,40,118,41,44,52,41,58,0,12,5,0,5,
+114,97,110,103,101,0,0,0,13,4,5,0,11,5,0,0,
+0,0,0,0,0,0,0,0,12,9,0,3,108,101,110,0,
+13,8,9,0,15,9,1,0,31,6,9,1,19,6,8,6,
+11,7,0,0,0,0,0,0,0,0,16,64,31,3,5,3,
+19,3,4,3,11,4,0,0,0,0,0,0,0,0,0,0,
+42,2,3,4,18,0,0,29,30,9,0,43,32,32,32,32,
+32,32,32,32,105,110,115,101,114,116,40,40,39,100,97,116,
+97,39,44,118,91,110,58,110,43,52,93,41,41,0,0,0,
+12,7,0,6,105,110,115,101,114,116,0,0,13,6,7,0,
+12,8,0,4,100,97,116,97,0,0,0,0,15,11,2,0,
+11,13,0,0,0,0,0,0,0,0,16,64,1,12,2,13,
+27,10,11,2,9,9,1,10,27,7,8,2,31,5,7,1,
+19,5,6,5,18,0,255,227,0,0,0,0,12,5,0,5,
+119,114,105,116,101,0,0,0,14,5,4,0,30,4,0,44,
+100,101,102,32,115,101,116,112,111,115,40,118,41,58,0,0,
+16,5,0,184,44,12,0,0,30,4,0,44,100,101,102,32,
+115,101,116,112,111,115,40,118,41,58,0,0,12,1,0,9,
+101,110,99,111,100,101,46,112,121,0,0,0,33,1,0,0,
+12,1,0,6,115,101,116,112,111,115,0,0,34,1,0,0,
+28,2,0,0,9,1,0,2,30,8,0,45,32,32,32,32,
+105,102,32,39,45,110,111,112,111,115,39,32,105,110,32,65,
+82,71,86,58,32,114,101,116,117,114,110,0,12,3,0,4,
+65,82,71,86,0,0,0,0,13,2,3,0,12,3,0,6,
+45,110,111,112,111,115,0,0,36,2,2,3,21,2,0,0,
+18,0,0,4,28,2,0,0,20,2,0,0,18,0,0,1,
+30,4,0,46,32,32,32,32,108,105,110,101,44,120,32,61,
+32,118,0,0,11,4,0,0,0,0,0,0,0,0,0,0,
+9,3,1,4,15,2,3,0,11,5,0,0,0,0,0,0,
+0,0,240,63,9,4,1,5,15,3,4,0,30,8,0,47,
+32,32,32,32,105,102,32,108,105,110,101,32,61,61,32,68,
+46,108,105,110,101,110,111,58,32,114,101,116,117,114,110,0,
+12,5,0,1,68,0,0,0,13,4,5,0,12,5,0,6,
+108,105,110,101,110,111,0,0,9,4,4,5,23,1,2,4,
+21,1,0,0,18,0,0,4,28,1,0,0,20,1,0,0,
+18,0,0,1,30,7,0,48,32,32,32,32,116,101,120,116,
+32,61,32,68,46,108,105,110,101,115,91,108,105,110,101,45,
+49,93,0,0,12,5,0,1,68,0,0,0,13,4,5,0,
+12,5,0,5,108,105,110,101,115,0,0,0,9,4,4,5,
+11,6,0,0,0,0,0,0,0,0,240,63,2,5,2,6,
+9,4,4,5,15,1,4,0,30,5,0,49,32,32,32,32,
+68,46,108,105,110,101,110,111,32,61,32,108,105,110,101,0,
+12,5,0,1,68,0,0,0,13,4,5,0,12,5,0,6,
+108,105,110,101,110,111,0,0,10,4,5,2,30,10,0,50,
+32,32,32,32,118,97,108,32,61,32,116,101,120,116,32,43,
+32,34,92,48,34,42,40,52,45,108,101,110,40,116,101,120,
+116,41,37,52,41,0,0,0,12,6,0,1,0,0,0,0,
+11,7,0,0,0,0,0,0,0,0,16,64,12,10,0,3,
+108,101,110,0,13,9,10,0,15,10,1,0,31,8,10,1,
+19,8,9,8,11,9,0,0,0,0,0,0,0,0,16,64,
+39,8,8,9,2,7,7,8,3,6,6,7,1,5,1,6,
+15,4,5,0,30,9,0,51,32,32,32,32,99,111,100,101,
+95,49,54,40,80,79,83,44,108,101,110,40,118,97,108,41,
+47,52,44,108,105,110,101,41,0,0,0,0,12,7,0,7,
+99,111,100,101,95,49,54,0,13,6,7,0,12,10,0,3,
+80,79,83,0,13,7,10,0,12,11,0,3,108,101,110,0,
+13,10,11,0,15,11,4,0,31,8,11,1,19,8,10,8,
+11,10,0,0,0,0,0,0,0,0,16,64,4,8,8,10,
+15,9,2,0,31,5,7,3,19,5,6,5,30,4,0,52,
+32,32,32,32,119,114,105,116,101,40,118,97,108,41,0,0,
+12,7,0,5,119,114,105,116,101,0,0,0,13,6,7,0,
+15,7,4,0,31,5,7,1,19,5,6,5,0,0,0,0,
+12,6,0,6,115,101,116,112,111,115,0,0,14,6,5,0,
+30,7,0,53,100,101,102,32,99,111,100,101,40,105,44,97,
+61,48,44,98,61,48,44,99,61,48,41,58,0,0,0,0,
+16,6,0,167,44,13,0,0,30,7,0,53,100,101,102,32,
+99,111,100,101,40,105,44,97,61,48,44,98,61,48,44,99,
+61,48,41,58,0,0,0,0,12,1,0,9,101,110,99,111,
+100,101,46,112,121,0,0,0,33,1,0,0,12,1,0,4,
+99,111,100,101,0,0,0,0,34,1,0,0,28,2,0,0,
+9,1,0,2,11,2,0,0,0,0,0,0,0,0,0,0,
+28,3,0,0,32,2,0,3,11,3,0,0,0,0,0,0,
+0,0,0,0,28,4,0,0,32,3,0,4,11,4,0,0,
+0,0,0,0,0,0,0,0,28,5,0,0,32,4,0,5,
+30,10,0,54,32,32,32,32,105,102,32,110,111,116,32,105,
+115,116,121,112,101,40,105,44,39,110,117,109,98,101,114,39,
+41,58,32,114,97,105,115,101,0,0,0,0,12,8,0,6,
+105,115,116,121,112,101,0,0,13,7,8,0,15,8,1,0,
+12,9,0,6,110,117,109,98,101,114,0,0,31,6,8,2,
+19,6,7,6,47,5,6,0,21,5,0,0,18,0,0,4,
+28,5,0,0,37,5,0,0,18,0,0,1,30,10,0,55,
+32,32,32,32,105,102,32,110,111,116,32,105,115,116,121,112,
+101,40,97,44,39,110,117,109,98,101,114,39,41,58,32,114,
+97,105,115,101,0,0,0,0,12,8,0,6,105,115,116,121,
+112,101,0,0,13,7,8,0,15,8,2,0,12,9,0,6,
+110,117,109,98,101,114,0,0,31,6,8,2,19,6,7,6,
+47,5,6,0,21,5,0,0,18,0,0,4,28,5,0,0,
+37,5,0,0,18,0,0,1,30,10,0,56,32,32,32,32,
+105,102,32,110,111,116,32,105,115,116,121,112,101,40,98,44,
+39,110,117,109,98,101,114,39,41,58,32,114,97,105,115,101,
+0,0,0,0,12,8,0,6,105,115,116,121,112,101,0,0,
+13,7,8,0,15,8,3,0,12,9,0,6,110,117,109,98,
+101,114,0,0,31,6,8,2,19,6,7,6,47,5,6,0,
+21,5,0,0,18,0,0,4,28,5,0,0,37,5,0,0,
+18,0,0,1,30,10,0,57,32,32,32,32,105,102,32,110,
+111,116,32,105,115,116,121,112,101,40,99,44,39,110,117,109,
+98,101,114,39,41,58,32,114,97,105,115,101,0,0,0,0,
+12,8,0,6,105,115,116,121,112,101,0,0,13,7,8,0,
+15,8,4,0,12,9,0,6,110,117,109,98,101,114,0,0,
+31,6,8,2,19,6,7,6,47,5,6,0,21,5,0,0,
+18,0,0,4,28,5,0,0,37,5,0,0,18,0,0,1,
+30,7,0,58,32,32,32,32,119,114,105,116,101,40,40,39,
+99,111,100,101,39,44,105,44,97,44,98,44,99,41,41,0,
+12,7,0,5,119,114,105,116,101,0,0,0,13,6,7,0,
+12,8,0,4,99,111,100,101,0,0,0,0,15,9,1,0,
+15,10,2,0,15,11,3,0,15,12,4,0,27,7,8,5,
+31,5,7,1,19,5,6,5,0,0,0,0,12,7,0,4,
+99,111,100,101,0,0,0,0,14,7,6,0,30,5,0,59,
+100,101,102,32,99,111,100,101,95,49,54,40,105,44,97,44,
+98,41,58,0,16,7,0,79,44,11,0,0,30,5,0,59,
+100,101,102,32,99,111,100,101,95,49,54,40,105,44,97,44,
+98,41,58,0,12,1,0,9,101,110,99,111,100,101,46,112,
+121,0,0,0,33,1,0,0,12,1,0,7,99,111,100,101,
+95,49,54,0,34,1,0,0,28,2,0,0,9,1,0,2,
+28,3,0,0,9,2,0,3,28,4,0,0,9,3,0,4,
+30,7,0,60,32,32,32,32,105,102,32,98,32,60,32,48,
+58,32,98,32,43,61,32,48,120,56,48,48,48,0,0,0,
+11,5,0,0,0,0,0,0,0,0,0,0,25,4,3,5,
+21,4,0,0,18,0,0,7,11,5,0,0,0,0,0,0,
+0,0,224,64,1,4,3,5,15,3,4,0,18,0,0,1,
+30,10,0,61,32,32,32,32,99,111,100,101,40,105,44,97,
+44,40,98,38,48,120,102,102,48,48,41,62,62,56,44,40,
+98,38,48,120,102,102,41,62,62,48,41,0,12,6,0,4,
+99,111,100,101,0,0,0,0,13,5,6,0,15,6,1,0,
+15,7,2,0,11,10,0,0,0,0,0,0,0,224,239,64,
+6,8,3,10,11,10,0,0,0,0,0,0,0,0,32,64,
+41,8,8,10,11,10,0,0,0,0,0,0,0,224,111,64,
+6,9,3,10,11,10,0,0,0,0,0,0,0,0,0,0,
+41,9,9,10,31,4,6,4,19,4,5,4,0,0,0,0,
+12,8,0,7,99,111,100,101,95,49,54,0,14,8,7,0,
+30,6,0,62,100,101,102,32,103,101,116,95,99,111,100,101,
+49,54,40,105,44,97,44,98,41,58,0,0,16,8,0,63,
+44,11,0,0,30,6,0,62,100,101,102,32,103,101,116,95,
+99,111,100,101,49,54,40,105,44,97,44,98,41,58,0,0,
+12,1,0,9,101,110,99,111,100,101,46,112,121,0,0,0,
+33,1,0,0,12,1,0,10,103,101,116,95,99,111,100,101,
+49,54,0,0,34,1,0,0,28,2,0,0,9,1,0,2,
+28,3,0,0,9,2,0,3,28,4,0,0,9,3,0,4,
+30,13,0,63,32,32,32,32,114,101,116,117,114,110,32,40,
+39,99,111,100,101,39,44,105,44,97,44,40,98,38,48,120,
+102,102,48,48,41,62,62,56,44,40,98,38,48,120,102,102,
+41,62,62,48,41,0,0,0,12,5,0,4,99,111,100,101,
+0,0,0,0,15,6,1,0,15,7,2,0,11,10,0,0,
+0,0,0,0,0,224,239,64,6,8,3,10,11,10,0,0,
+0,0,0,0,0,0,32,64,41,8,8,10,11,10,0,0,
+0,0,0,0,0,224,111,64,6,9,3,10,11,10,0,0,
+0,0,0,0,0,0,0,0,41,9,9,10,27,4,5,5,
+20,4,0,0,0,0,0,0,12,9,0,10,103,101,116,95,
+99,111,100,101,49,54,0,0,14,9,8,0,30,7,0,65,
+100,101,102,32,95,100,111,95,115,116,114,105,110,103,40,118,
+44,114,61,78,111,110,101,41,58,0,0,0,16,9,0,112,
+44,11,0,0,30,7,0,65,100,101,102,32,95,100,111,95,
+115,116,114,105,110,103,40,118,44,114,61,78,111,110,101,41,
+58,0,0,0,12,1,0,9,101,110,99,111,100,101,46,112,
+121,0,0,0,33,1,0,0,12,1,0,10,95,100,111,95,
+115,116,114,105,110,103,0,0,34,1,0,0,28,2,0,0,
+9,1,0,2,28,2,0,0,28,3,0,0,32,2,0,3,
+30,5,0,66,32,32,32,32,114,32,61,32,103,101,116,95,
+116,109,112,40,114,41,0,0,12,5,0,7,103,101,116,95,
+116,109,112,0,13,4,5,0,15,5,2,0,31,3,5,1,
+19,3,4,3,15,2,3,0,30,8,0,67,32,32,32,32,
+118,97,108,32,61,32,118,32,43,32,34,92,48,34,42,40,
+52,45,108,101,110,40,118,41,37,52,41,0,12,5,0,1,
+0,0,0,0,11,6,0,0,0,0,0,0,0,0,16,64,
+12,9,0,3,108,101,110,0,13,8,9,0,15,9,1,0,
+31,7,9,1,19,7,8,7,11,8,0,0,0,0,0,0,
+0,0,16,64,39,7,7,8,2,6,6,7,3,5,5,6,
+1,4,1,5,15,3,4,0,30,8,0,68,32,32,32,32,
+99,111,100,101,95,49,54,40,83,84,82,73,78,71,44,114,
+44,108,101,110,40,118,41,41,0,0,0,0,12,6,0,7,
+99,111,100,101,95,49,54,0,13,5,6,0,12,9,0,6,
+83,84,82,73,78,71,0,0,13,6,9,0,15,7,2,0,
+12,10,0,3,108,101,110,0,13,9,10,0,15,10,1,0,
+31,8,10,1,19,8,9,8,31,4,6,3,19,4,5,4,
+30,4,0,69,32,32,32,32,119,114,105,116,101,40,118,97,
+108,41,0,0,12,6,0,5,119,114,105,116,101,0,0,0,
+13,5,6,0,15,6,3,0,31,4,6,1,19,4,5,4,
+30,4,0,70,32,32,32,32,114,101,116,117,114,110,32,114,
+0,0,0,0,20,2,0,0,0,0,0,0,12,10,0,10,
+95,100,111,95,115,116,114,105,110,103,0,0,14,10,9,0,
+30,7,0,71,100,101,102,32,100,111,95,115,116,114,105,110,
+103,40,116,44,114,61,78,111,110,101,41,58,0,0,0,0,
+16,10,0,47,44,8,0,0,30,7,0,71,100,101,102,32,
+100,111,95,115,116,114,105,110,103,40,116,44,114,61,78,111,
+110,101,41,58,0,0,0,0,12,1,0,9,101,110,99,111,
+100,101,46,112,121,0,0,0,33,1,0,0,12,1,0,9,
+100,111,95,115,116,114,105,110,103,0,0,0,34,1,0,0,
+28,2,0,0,9,1,0,2,28,2,0,0,28,3,0,0,
+32,2,0,3,30,8,0,72,32,32,32,32,114,101,116,117,
+114,110,32,95,100,111,95,115,116,114,105,110,103,40,116,46,
+118,97,108,44,114,41,0,0,12,5,0,10,95,100,111,95,
+115,116,114,105,110,103,0,0,13,4,5,0,12,7,0,3,
+118,97,108,0,9,5,1,7,15,6,2,0,31,3,5,2,
+19,3,4,3,20,3,0,0,0,0,0,0,12,11,0,9,
+100,111,95,115,116,114,105,110,103,0,0,0,14,11,10,0,
+30,7,0,74,100,101,102,32,95,100,111,95,110,117,109,98,
+101,114,40,118,44,114,61,78,111,110,101,41,58,0,0,0,
+16,11,0,97,44,10,0,0,30,7,0,74,100,101,102,32,
+95,100,111,95,110,117,109,98,101,114,40,118,44,114,61,78,
+111,110,101,41,58,0,0,0,12,1,0,9,101,110,99,111,
+100,101,46,112,121,0,0,0,33,1,0,0,12,1,0,10,
+95,100,111,95,110,117,109,98,101,114,0,0,34,1,0,0,
+28,2,0,0,9,1,0,2,28,2,0,0,28,3,0,0,
+32,2,0,3,30,5,0,75,32,32,32,32,114,32,61,32,
+103,101,116,95,116,109,112,40,114,41,0,0,12,5,0,7,
+103,101,116,95,116,109,112,0,13,4,5,0,15,5,2,0,
+31,3,5,1,19,3,4,3,15,2,3,0,30,6,0,76,
+32,32,32,32,99,111,100,101,40,78,85,77,66,69,82,44,
+114,44,48,44,48,41,0,0,12,5,0,4,99,111,100,101,
+0,0,0,0,13,4,5,0,12,9,0,6,78,85,77,66,
+69,82,0,0,13,5,9,0,15,6,2,0,11,7,0,0,
+0,0,0,0,0,0,0,0,11,8,0,0,0,0,0,0,
+0,0,0,0,31,3,5,4,19,3,4,3,30,7,0,77,
+32,32,32,32,119,114,105,116,101,40,102,112,97,99,107,40,
+110,117,109,98,101,114,40,118,41,41,41,0,12,5,0,5,
+119,114,105,116,101,0,0,0,13,4,5,0,12,7,0,5,
+102,112,97,99,107,0,0,0,13,6,7,0,12,9,0,6,
+110,117,109,98,101,114,0,0,13,8,9,0,15,9,1,0,
+31,7,9,1,19,7,8,7,31,5,7,1,19,5,6,5,
+31,3,5,1,19,3,4,3,30,4,0,78,32,32,32,32,
+114,101,116,117,114,110,32,114,0,0,0,0,20,2,0,0,
+0,0,0,0,12,12,0,10,95,100,111,95,110,117,109,98,
+101,114,0,0,14,12,11,0,30,7,0,79,100,101,102,32,
+100,111,95,110,117,109,98,101,114,40,116,44,114,61,78,111,
+110,101,41,58,0,0,0,0,16,12,0,47,44,8,0,0,
+30,7,0,79,100,101,102,32,100,111,95,110,117,109,98,101,
+114,40,116,44,114,61,78,111,110,101,41,58,0,0,0,0,
+12,1,0,9,101,110,99,111,100,101,46,112,121,0,0,0,
+33,1,0,0,12,1,0,9,100,111,95,110,117,109,98,101,
+114,0,0,0,34,1,0,0,28,2,0,0,9,1,0,2,
+28,2,0,0,28,3,0,0,32,2,0,3,30,8,0,80,
+32,32,32,32,114,101,116,117,114,110,32,95,100,111,95,110,
+117,109,98,101,114,40,116,46,118,97,108,44,114,41,0,0,
+12,5,0,10,95,100,111,95,110,117,109,98,101,114,0,0,
+13,4,5,0,12,7,0,3,118,97,108,0,9,5,1,7,
+15,6,2,0,31,3,5,2,19,3,4,3,20,3,0,0,
+0,0,0,0,12,13,0,9,100,111,95,110,117,109,98,101,
+114,0,0,0,14,13,12,0,30,4,0,82,100,101,102,32,
+103,101,116,95,116,97,103,40,41,58,0,0,16,13,0,67,
+44,6,0,0,30,4,0,82,100,101,102,32,103,101,116,95,
+116,97,103,40,41,58,0,0,12,1,0,9,101,110,99,111,
+100,101,46,112,121,0,0,0,33,1,0,0,12,1,0,7,
+103,101,116,95,116,97,103,0,34,1,0,0,30,6,0,83,
+32,32,32,32,107,32,61,32,115,116,114,40,68,46,95,116,
+97,103,105,41,0,0,0,0,12,4,0,3,115,116,114,0,
+13,3,4,0,12,5,0,1,68,0,0,0,13,4,5,0,
+12,5,0,5,95,116,97,103,105,0,0,0,9,4,4,5,
+31,2,4,1,19,2,3,2,15,1,2,0,30,5,0,84,
+32,32,32,32,68,46,95,116,97,103,105,32,43,61,32,49,
+0,0,0,0,12,3,0,1,68,0,0,0,13,2,3,0,
+12,4,0,1,68,0,0,0,13,3,4,0,12,4,0,5,
+95,116,97,103,105,0,0,0,9,3,3,4,11,4,0,0,
+0,0,0,0,0,0,240,63,1,3,3,4,12,4,0,5,
+95,116,97,103,105,0,0,0,10,2,4,3,30,4,0,85,
+32,32,32,32,114,101,116,117,114,110,32,107,0,0,0,0,
+20,1,0,0,0,0,0,0,12,14,0,7,103,101,116,95,
+116,97,103,0,14,14,13,0,30,5,0,86,100,101,102,32,
+115,116,97,99,107,95,116,97,103,40,41,58,0,0,0,0,
+16,14,0,59,44,5,0,0,30,5,0,86,100,101,102,32,
+115,116,97,99,107,95,116,97,103,40,41,58,0,0,0,0,
+12,1,0,9,101,110,99,111,100,101,46,112,121,0,0,0,
+33,1,0,0,12,1,0,9,115,116,97,99,107,95,116,97,
+103,0,0,0,34,1,0,0,30,5,0,87,32,32,32,32,
+107,32,61,32,103,101,116,95,116,97,103,40,41,0,0,0,
+12,4,0,7,103,101,116,95,116,97,103,0,13,3,4,0,
+31,2,0,0,19,2,3,2,15,1,2,0,30,6,0,88,
+32,32,32,32,68,46,116,115,116,97,99,107,46,97,112,112,
+101,110,100,40,107,41,0,0,12,4,0,1,68,0,0,0,
+13,3,4,0,12,4,0,6,116,115,116,97,99,107,0,0,
+9,3,3,4,12,4,0,6,97,112,112,101,110,100,0,0,
+9,3,3,4,15,4,1,0,31,2,4,1,19,2,3,2,
+30,4,0,89,32,32,32,32,114,101,116,117,114,110,32,107,
+0,0,0,0,20,1,0,0,0,0,0,0,12,15,0,9,
+115,116,97,99,107,95,116,97,103,0,0,0,14,15,14,0,
+30,4,0,90,100,101,102,32,112,111,112,95,116,97,103,40,
+41,58,0,0,16,15,0,35,44,4,0,0,30,4,0,90,
+100,101,102,32,112,111,112,95,116,97,103,40,41,58,0,0,
+12,1,0,9,101,110,99,111,100,101,46,112,121,0,0,0,
+33,1,0,0,12,1,0,7,112,111,112,95,116,97,103,0,
+34,1,0,0,30,5,0,91,32,32,32,32,68,46,116,115,
+116,97,99,107,46,112,111,112,40,41,0,0,12,3,0,1,
+68,0,0,0,13,2,3,0,12,3,0,6,116,115,116,97,
+99,107,0,0,9,2,2,3,12,3,0,3,112,111,112,0,
+9,2,2,3,31,1,0,0,19,1,2,1,0,0,0,0,
+12,16,0,7,112,111,112,95,116,97,103,0,14,16,15,0,
+30,4,0,93,100,101,102,32,116,97,103,40,42,116,41,58,
+0,0,0,0,16,16,0,86,44,12,0,0,30,4,0,93,
+100,101,102,32,116,97,103,40,42,116,41,58,0,0,0,0,
+12,1,0,9,101,110,99,111,100,101,46,112,121,0,0,0,
+33,1,0,0,12,1,0,3,116,97,103,0,34,1,0,0,
+12,2,0,1,42,0,0,0,9,1,0,2,30,13,0,94,
+32,32,32,32,116,32,61,32,68,46,115,110,117,109,43,39,
+58,39,43,39,58,39,46,106,111,105,110,40,91,115,116,114,
+40,118,41,32,102,111,114,32,118,32,105,110,32,116,93,41,
+0,0,0,0,12,3,0,1,68,0,0,0,13,2,3,0,
+12,3,0,4,115,110,117,109,0,0,0,0,9,2,2,3,
+12,3,0,1,58,0,0,0,1,2,2,3,12,4,0,1,
+58,0,0,0,12,5,0,4,106,111,105,110,0,0,0,0,
+9,4,4,5,27,6,0,0,11,8,0,0,0,0,0,0,
+0,0,0,0,42,7,1,8,18,0,0,10,12,11,0,3,
+115,116,114,0,13,10,11,0,15,11,7,0,31,9,11,1,
+19,9,10,9,28,10,0,0,10,6,10,9,18,0,255,246,
+15,5,6,0,31,3,5,1,19,3,4,3,1,2,2,3,
+15,1,2,0,30,6,0,95,32,32,32,32,105,110,115,101,
+114,116,40,40,39,116,97,103,39,44,116,41,41,0,0,0,
+12,4,0,6,105,110,115,101,114,116,0,0,13,3,4,0,
+12,8,0,3,116,97,103,0,15,9,1,0,27,4,8,2,
+31,2,4,1,19,2,3,2,0,0,0,0,12,17,0,3,
+116,97,103,0,14,17,16,0,30,4,0,96,100,101,102,32,
+106,117,109,112,40,42,116,41,58,0,0,0,16,17,0,88,
+44,12,0,0,30,4,0,96,100,101,102,32,106,117,109,112,
+40,42,116,41,58,0,0,0,12,1,0,9,101,110,99,111,
+100,101,46,112,121,0,0,0,33,1,0,0,12,1,0,4,
+106,117,109,112,0,0,0,0,34,1,0,0,12,2,0,1,
+42,0,0,0,9,1,0,2,30,13,0,97,32,32,32,32,
+116,32,61,32,68,46,115,110,117,109,43,39,58,39,43,39,
+58,39,46,106,111,105,110,40,91,115,116,114,40,118,41,32,
+102,111,114,32,118,32,105,110,32,116,93,41,0,0,0,0,
+12,3,0,1,68,0,0,0,13,2,3,0,12,3,0,4,
+115,110,117,109,0,0,0,0,9,2,2,3,12,3,0,1,
+58,0,0,0,1,2,2,3,12,4,0,1,58,0,0,0,
+12,5,0,4,106,111,105,110,0,0,0,0,9,4,4,5,
+27,6,0,0,11,8,0,0,0,0,0,0,0,0,0,0,
+42,7,1,8,18,0,0,10,12,11,0,3,115,116,114,0,
+13,10,11,0,15,11,7,0,31,9,11,1,19,9,10,9,
+28,10,0,0,10,6,10,9,18,0,255,246,15,5,6,0,
+31,3,5,1,19,3,4,3,1,2,2,3,15,1,2,0,
+30,6,0,98,32,32,32,32,105,110,115,101,114,116,40,40,
+39,106,117,109,112,39,44,116,41,41,0,0,12,4,0,6,
+105,110,115,101,114,116,0,0,13,3,4,0,12,8,0,4,
+106,117,109,112,0,0,0,0,15,9,1,0,27,4,8,2,
+31,2,4,1,19,2,3,2,0,0,0,0,12,18,0,4,
+106,117,109,112,0,0,0,0,14,18,17,0,30,4,0,99,
+100,101,102,32,115,101,116,106,109,112,40,42,116,41,58,0,
+16,18,0,89,44,12,0,0,30,4,0,99,100,101,102,32,
+115,101,116,106,109,112,40,42,116,41,58,0,12,1,0,9,
+101,110,99,111,100,101,46,112,121,0,0,0,33,1,0,0,
+12,1,0,6,115,101,116,106,109,112,0,0,34,1,0,0,
+12,2,0,1,42,0,0,0,9,1,0,2,30,13,0,100,
+32,32,32,32,116,32,61,32,68,46,115,110,117,109,43,39,
+58,39,43,39,58,39,46,106,111,105,110,40,91,115,116,114,
+40,118,41,32,102,111,114,32,118,32,105,110,32,116,93,41,
+0,0,0,0,12,3,0,1,68,0,0,0,13,2,3,0,
+12,3,0,4,115,110,117,109,0,0,0,0,9,2,2,3,
+12,3,0,1,58,0,0,0,1,2,2,3,12,4,0,1,
+58,0,0,0,12,5,0,4,106,111,105,110,0,0,0,0,
+9,4,4,5,27,6,0,0,11,8,0,0,0,0,0,0,
+0,0,0,0,42,7,1,8,18,0,0,10,12,11,0,3,
+115,116,114,0,13,10,11,0,15,11,7,0,31,9,11,1,
+19,9,10,9,28,10,0,0,10,6,10,9,18,0,255,246,
+15,5,6,0,31,3,5,1,19,3,4,3,1,2,2,3,
+15,1,2,0,30,7,0,101,32,32,32,32,105,110,115,101,
+114,116,40,40,39,115,101,116,106,109,112,39,44,116,41,41,
+0,0,0,0,12,4,0,6,105,110,115,101,114,116,0,0,
+13,3,4,0,12,8,0,6,115,101,116,106,109,112,0,0,
+15,9,1,0,27,4,8,2,31,2,4,1,19,2,3,2,
+0,0,0,0,12,19,0,6,115,101,116,106,109,112,0,0,
+14,19,18,0,30,4,0,102,100,101,102,32,102,110,99,40,
+42,116,41,58,0,0,0,0,16,19,0,107,44,12,0,0,
+30,4,0,102,100,101,102,32,102,110,99,40,42,116,41,58,
+0,0,0,0,12,1,0,9,101,110,99,111,100,101,46,112,
+121,0,0,0,33,1,0,0,12,1,0,3,102,110,99,0,
+34,1,0,0,12,2,0,1,42,0,0,0,9,1,0,2,
+30,13,0,103,32,32,32,32,116,32,61,32,68,46,115,110,
+117,109,43,39,58,39,43,39,58,39,46,106,111,105,110,40,
+91,115,116,114,40,118,41,32,102,111,114,32,118,32,105,110,
+32,116,93,41,0,0,0,0,12,3,0,1,68,0,0,0,
+13,2,3,0,12,3,0,4,115,110,117,109,0,0,0,0,
+9,2,2,3,12,3,0,1,58,0,0,0,1,2,2,3,
+12,4,0,1,58,0,0,0,12,5,0,4,106,111,105,110,
+0,0,0,0,9,4,4,5,27,6,0,0,11,8,0,0,
+0,0,0,0,0,0,0,0,42,7,1,8,18,0,0,10,
+12,11,0,3,115,116,114,0,13,10,11,0,15,11,7,0,
+31,9,11,1,19,9,10,9,28,10,0,0,10,6,10,9,
+18,0,255,246,15,5,6,0,31,3,5,1,19,3,4,3,
+1,2,2,3,15,1,2,0,30,5,0,104,32,32,32,32,
+114,32,61,32,103,101,116,95,114,101,103,40,116,41,0,0,
+12,5,0,7,103,101,116,95,114,101,103,0,13,4,5,0,
+15,5,1,0,31,3,5,1,19,3,4,3,15,2,3,0,
+30,6,0,105,32,32,32,32,105,110,115,101,114,116,40,40,
+39,102,110,99,39,44,114,44,116,41,41,0,12,5,0,6,
+105,110,115,101,114,116,0,0,13,4,5,0,12,8,0,3,
+102,110,99,0,15,9,2,0,15,10,1,0,27,5,8,3,
+31,3,5,1,19,3,4,3,30,4,0,106,32,32,32,32,
+114,101,116,117,114,110,32,114,0,0,0,0,20,2,0,0,
+0,0,0,0,12,20,0,3,102,110,99,0,14,20,19,0,
+30,4,0,108,100,101,102,32,109,97,112,95,116,97,103,115,
+40,41,58,0,16,20,2,175,44,17,0,0,30,4,0,108,
+100,101,102,32,109,97,112,95,116,97,103,115,40,41,58,0,
+12,1,0,9,101,110,99,111,100,101,46,112,121,0,0,0,
+33,1,0,0,12,1,0,8,109,97,112,95,116,97,103,115,
+0,0,0,0,34,1,0,0,30,4,0,109,32,32,32,32,
+116,97,103,115,32,61,32,123,125,0,0,0,26,2,0,0,
+15,1,2,0,30,4,0,110,32,32,32,32,111,117,116,32,
+61,32,91,93,0,0,0,0,27,3,0,0,15,2,3,0,
+30,3,0,111,32,32,32,32,110,32,61,32,48,0,0,0,
+11,4,0,0,0,0,0,0,0,0,0,0,15,3,4,0,
+30,6,0,112,32,32,32,32,102,111,114,32,105,116,101,109,
+32,105,110,32,68,46,111,117,116,58,0,0,12,6,0,1,
+68,0,0,0,13,5,6,0,12,6,0,3,111,117,116,0,
+9,5,5,6,11,6,0,0,0,0,0,0,0,0,0,0,
+42,4,5,6,18,0,0,145,30,8,0,113,32,32,32,32,
+32,32,32,32,105,102,32,105,116,101,109,91,48,93,32,61,
+61,32,39,116,97,103,39,58,0,0,0,0,11,8,0,0,
+0,0,0,0,0,0,0,0,9,7,4,8,12,8,0,3,
+116,97,103,0,23,7,7,8,21,7,0,0,18,0,0,24,
+30,8,0,114,32,32,32,32,32,32,32,32,32,32,32,32,
+116,97,103,115,91,105,116,101,109,91,49,93,93,32,61,32,
+110,0,0,0,11,8,0,0,0,0,0,0,0,0,240,63,
+9,7,4,8,10,1,7,3,30,6,0,115,32,32,32,32,
+32,32,32,32,32,32,32,32,99,111,110,116,105,110,117,101,
+0,0,0,0,18,0,255,215,18,0,0,1,30,8,0,116,
+32,32,32,32,32,32,32,32,105,102,32,105,116,101,109,91,
+48,93,32,61,61,32,39,114,101,103,115,39,58,0,0,0,
+11,8,0,0,0,0,0,0,0,0,0,0,9,7,4,8,
+12,8,0,4,114,101,103,115,0,0,0,0,23,7,7,8,
+21,7,0,0,18,0,0,59,30,13,0,117,32,32,32,32,
+32,32,32,32,32,32,32,32,111,117,116,46,97,112,112,101,
+110,100,40,103,101,116,95,99,111,100,101,49,54,40,82,69,
+71,83,44,105,116,101,109,91,49,93,44,48,41,41,0,0,
+12,9,0,6,97,112,112,101,110,100,0,0,9,8,2,9,
+12,11,0,10,103,101,116,95,99,111,100,101,49,54,0,0,
+13,10,11,0,12,14,0,4,82,69,71,83,0,0,0,0,
+13,11,14,0,11,14,0,0,0,0,0,0,0,0,240,63,
+9,12,4,14,11,13,0,0,0,0,0,0,0,0,0,0,
+31,9,11,3,19,9,10,9,31,7,9,1,19,7,8,7,
+30,5,0,118,32,32,32,32,32,32,32,32,32,32,32,32,
+110,32,43,61,32,49,0,0,11,8,0,0,0,0,0,0,
+0,0,240,63,1,7,3,8,15,3,7,0,30,6,0,119,
+32,32,32,32,32,32,32,32,32,32,32,32,99,111,110,116,
+105,110,117,101,0,0,0,0,18,0,255,138,18,0,0,1,
+30,7,0,120,32,32,32,32,32,32,32,32,111,117,116,46,
+97,112,112,101,110,100,40,105,116,101,109,41,0,0,0,0,
+12,9,0,6,97,112,112,101,110,100,0,0,9,8,2,9,
+15,9,4,0,31,7,9,1,19,7,8,7,30,4,0,121,
+32,32,32,32,32,32,32,32,110,32,43,61,32,49,0,0,
+11,8,0,0,0,0,0,0,0,0,240,63,1,7,3,8,
+15,3,7,0,18,0,255,111,30,8,0,122,32,32,32,32,
+102,111,114,32,110,32,105,110,32,114,97,110,103,101,40,48,
+44,108,101,110,40,111,117,116,41,41,58,0,12,7,0,5,
+114,97,110,103,101,0,0,0,13,6,7,0,11,7,0,0,
+0,0,0,0,0,0,0,0,12,10,0,3,108,101,110,0,
+13,9,10,0,15,10,2,0,31,8,10,1,19,8,9,8,
+31,5,7,2,19,5,6,5,11,6,0,0,0,0,0,0,
+0,0,0,0,42,3,5,6,18,0,0,182,30,6,0,123,
+32,32,32,32,32,32,32,32,105,116,101,109,32,61,32,111,
+117,116,91,110,93,0,0,0,9,7,2,3,15,4,7,0,
+30,8,0,124,32,32,32,32,32,32,32,32,105,102,32,105,
+116,101,109,91,48,93,32,61,61,32,39,106,117,109,112,39,
+58,0,0,0,11,8,0,0,0,0,0,0,0,0,0,0,
+9,7,4,8,12,8,0,4,106,117,109,112,0,0,0,0,
+23,7,7,8,21,7,0,0,18,0,0,38,30,14,0,125,
+32,32,32,32,32,32,32,32,32,32,32,32,111,117,116,91,
+110,93,32,61,32,103,101,116,95,99,111,100,101,49,54,40,
+74,85,77,80,44,48,44,116,97,103,115,91,105,116,101,109,
+91,49,93,93,45,110,41,0,12,9,0,10,103,101,116,95,
+99,111,100,101,49,54,0,0,13,8,9,0,12,12,0,4,
+74,85,77,80,0,0,0,0,13,9,12,0,11,10,0,0,
+0,0,0,0,0,0,0,0,11,13,0,0,0,0,0,0,
+0,0,240,63,9,12,4,13,9,11,1,12,2,11,11,3,
+31,7,9,3,19,7,8,7,10,2,3,7,18,0,0,116,
+30,9,0,126,32,32,32,32,32,32,32,32,101,108,105,102,
+32,105,116,101,109,91,48,93,32,61,61,32,39,115,101,116,
+106,109,112,39,58,0,0,0,11,8,0,0,0,0,0,0,
+0,0,0,0,9,7,4,8,12,8,0,6,115,101,116,106,
+109,112,0,0,23,7,7,8,21,7,0,0,18,0,0,39,
+30,15,0,127,32,32,32,32,32,32,32,32,32,32,32,32,
+111,117,116,91,110,93,32,61,32,103,101,116,95,99,111,100,
+101,49,54,40,83,69,84,74,77,80,44,48,44,116,97,103,
+115,91,105,116,101,109,91,49,93,93,45,110,41,0,0,0,
+12,9,0,10,103,101,116,95,99,111,100,101,49,54,0,0,
+13,8,9,0,12,12,0,6,83,69,84,74,77,80,0,0,
+13,9,12,0,11,10,0,0,0,0,0,0,0,0,0,0,
+11,13,0,0,0,0,0,0,0,0,240,63,9,12,4,13,
+9,11,1,12,2,11,11,3,31,7,9,3,19,7,8,7,
+10,2,3,7,18,0,0,58,30,8,0,128,32,32,32,32,
+32,32,32,32,101,108,105,102,32,105,116,101,109,91,48,93,
+32,61,61,32,39,102,110,99,39,58,0,0,11,8,0,0,
+0,0,0,0,0,0,0,0,9,7,4,8,12,8,0,3,
+102,110,99,0,23,7,7,8,21,7,0,0,18,0,0,40,
+30,16,0,129,32,32,32,32,32,32,32,32,32,32,32,32,
+111,117,116,91,110,93,32,61,32,103,101,116,95,99,111,100,
+101,49,54,40,68,69,70,44,105,116,101,109,91,49,93,44,
+116,97,103,115,91,105,116,101,109,91,50,93,93,45,110,41,
+0,0,0,0,12,9,0,10,103,101,116,95,99,111,100,101,
+49,54,0,0,13,8,9,0,12,12,0,3,68,69,70,0,
+13,9,12,0,11,12,0,0,0,0,0,0,0,0,240,63,
+9,10,4,12,11,13,0,0,0,0,0,0,0,0,0,64,
+9,12,4,13,9,11,1,12,2,11,11,3,31,7,9,3,
+19,7,8,7,10,2,3,7,18,0,0,1,18,0,255,74,
+30,8,0,130,32,32,32,32,102,111,114,32,110,32,105,110,
+32,114,97,110,103,101,40,48,44,108,101,110,40,111,117,116,
+41,41,58,0,12,7,0,5,114,97,110,103,101,0,0,0,
+13,6,7,0,11,7,0,0,0,0,0,0,0,0,0,0,
+12,10,0,3,108,101,110,0,13,9,10,0,15,10,2,0,
+31,8,10,1,19,8,9,8,31,5,7,2,19,5,6,5,
+11,6,0,0,0,0,0,0,0,0,0,0,42,3,5,6,
+18,0,0,236,30,6,0,131,32,32,32,32,32,32,32,32,
+105,116,101,109,32,61,32,111,117,116,91,110,93,0,0,0,
+9,7,2,3,15,4,7,0,30,8,0,132,32,32,32,32,
+32,32,32,32,105,102,32,105,116,101,109,91,48,93,32,61,
+61,32,39,100,97,116,97,39,58,0,0,0,11,8,0,0,
+0,0,0,0,0,0,0,0,9,7,4,8,12,8,0,4,
+100,97,116,97,0,0,0,0,23,7,7,8,21,7,0,0,
+18,0,0,16,30,8,0,133,32,32,32,32,32,32,32,32,
+32,32,32,32,111,117,116,91,110,93,32,61,32,105,116,101,
+109,91,49,93,0,0,0,0,11,8,0,0,0,0,0,0,
+0,0,240,63,9,7,4,8,10,2,3,7,18,0,0,121,
+30,8,0,134,32,32,32,32,32,32,32,32,101,108,105,102,
+32,105,116,101,109,91,48,93,32,61,61,32,39,99,111,100,
+101,39,58,0,11,8,0,0,0,0,0,0,0,0,0,0,
+9,7,4,8,12,8,0,4,99,111,100,101,0,0,0,0,
+23,7,7,8,21,7,0,0,18,0,0,79,30,8,0,135,
+32,32,32,32,32,32,32,32,32,32,32,32,105,44,97,44,
+98,44,99,32,61,32,105,116,101,109,91,49,58,93,0,0,
+11,9,0,0,0,0,0,0,0,0,240,63,28,10,0,0,
+27,8,9,2,9,7,4,8,11,10,0,0,0,0,0,0,
+0,0,0,0,9,9,7,10,15,8,9,0,11,11,0,0,
+0,0,0,0,0,0,240,63,9,10,7,11,15,9,10,0,
+11,12,0,0,0,0,0,0,0,0,0,64,9,11,7,12,
+15,10,11,0,11,13,0,0,0,0,0,0,0,0,8,64,
+9,12,7,13,15,11,12,0,30,13,0,136,32,32,32,32,
+32,32,32,32,32,32,32,32,111,117,116,91,110,93,32,61,
+32,99,104,114,40,105,41,43,99,104,114,40,97,41,43,99,
+104,114,40,98,41,43,99,104,114,40,99,41,0,0,0,0,
+12,13,0,3,99,104,114,0,13,12,13,0,15,13,8,0,
+31,7,13,1,19,7,12,7,12,14,0,3,99,104,114,0,
+13,13,14,0,15,14,9,0,31,12,14,1,19,12,13,12,
+1,7,7,12,12,14,0,3,99,104,114,0,13,13,14,0,
+15,14,10,0,31,12,14,1,19,12,13,12,1,7,7,12,
+12,14,0,3,99,104,114,0,13,13,14,0,15,14,11,0,
+31,12,14,1,19,12,13,12,1,7,7,12,10,2,3,7,
+18,0,0,24,30,10,0,138,32,32,32,32,32,32,32,32,
+32,32,32,32,114,97,105,115,101,32,115,116,114,40,40,39,
+104,117,104,63,39,44,105,116,101,109,41,41,0,0,0,0,
+12,13,0,3,115,116,114,0,13,12,13,0,12,14,0,4,
+104,117,104,63,0,0,0,0,15,15,4,0,27,13,14,2,
+31,7,13,1,19,7,12,7,37,7,0,0,18,0,0,1,
+30,8,0,139,32,32,32,32,32,32,32,32,105,102,32,108,
+101,110,40,111,117,116,91,110,93,41,32,33,61,32,52,58,
+0,0,0,0,12,13,0,3,108,101,110,0,13,12,13,0,
+9,13,2,3,31,7,13,1,19,7,12,7,11,12,0,0,
+0,0,0,0,0,0,16,64,35,7,7,12,21,7,0,0,
+18,0,0,51,30,18,0,140,32,32,32,32,32,32,32,32,
+32,32,32,32,114,97,105,115,101,32,40,39,99,111,100,101,
+32,39,43,115,116,114,40,110,41,43,39,32,105,115,32,119,
+114,111,110,103,32,108,101,110,103,116,104,32,39,43,115,116,
+114,40,108,101,110,40,111,117,116,91,110,93,41,41,41,0,
+12,7,0,5,99,111,100,101,32,0,0,0,12,14,0,3,
+115,116,114,0,13,13,14,0,15,14,3,0,31,12,14,1,
+19,12,13,12,1,7,7,12,12,12,0,17,32,105,115,32,
+119,114,111,110,103,32,108,101,110,103,116,104,32,0,0,0,
+1,7,7,12,12,14,0,3,115,116,114,0,13,13,14,0,
+12,16,0,3,108,101,110,0,13,15,16,0,9,16,2,3,
+31,14,16,1,19,14,15,14,31,12,14,1,19,12,13,12,
+1,7,7,12,37,7,0,0,18,0,0,1,18,0,255,20,
+30,4,0,141,32,32,32,32,68,46,111,117,116,32,61,32,
+111,117,116,0,12,6,0,1,68,0,0,0,13,5,6,0,
+12,6,0,3,111,117,116,0,10,5,6,2,0,0,0,0,
+12,21,0,8,109,97,112,95,116,97,103,115,0,0,0,0,
+14,21,20,0,30,6,0,143,100,101,102,32,103,101,116,95,
+116,109,112,40,114,61,78,111,110,101,41,58,0,0,0,0,
+16,21,0,59,44,5,0,0,30,6,0,143,100,101,102,32,
+103,101,116,95,116,109,112,40,114,61,78,111,110,101,41,58,
+0,0,0,0,12,1,0,9,101,110,99,111,100,101,46,112,
+121,0,0,0,33,1,0,0,12,1,0,7,103,101,116,95,
+116,109,112,0,34,1,0,0,28,1,0,0,28,2,0,0,
+32,1,0,2,30,7,0,144,32,32,32,32,105,102,32,114,
+32,33,61,32,78,111,110,101,58,32,114,101,116,117,114,110,
+32,114,0,0,28,3,0,0,35,2,1,3,21,2,0,0,
+18,0,0,3,20,1,0,0,18,0,0,1,30,7,0,145,
+32,32,32,32,114,101,116,117,114,110,32,103,101,116,95,116,
+109,112,115,40,49,41,91,48,93,0,0,0,12,4,0,8,
+103,101,116,95,116,109,112,115,0,0,0,0,13,3,4,0,
+11,4,0,0,0,0,0,0,0,0,240,63,31,2,4,1,
+19,2,3,2,11,3,0,0,0,0,0,0,0,0,0,0,
+9,2,2,3,20,2,0,0,0,0,0,0,12,22,0,7,
+103,101,116,95,116,109,112,0,14,22,21,0,30,5,0,146,
+100,101,102,32,103,101,116,95,116,109,112,115,40,116,41,58,
+0,0,0,0,16,22,0,149,44,14,0,0,30,5,0,146,
+100,101,102,32,103,101,116,95,116,109,112,115,40,116,41,58,
+0,0,0,0,12,1,0,9,101,110,99,111,100,101,46,112,
+121,0,0,0,33,1,0,0,12,1,0,8,103,101,116,95,
+116,109,112,115,0,0,0,0,34,1,0,0,28,2,0,0,
+9,1,0,2,30,5,0,147,32,32,32,32,114,115,32,61,
+32,97,108,108,111,99,40,116,41,0,0,0,12,5,0,5,
+97,108,108,111,99,0,0,0,13,4,5,0,15,5,1,0,
+31,3,5,1,19,3,4,3,15,2,3,0,30,7,0,148,
+32,32,32,32,114,101,103,115,32,61,32,114,97,110,103,101,
+40,114,115,44,114,115,43,116,41,0,0,0,12,6,0,5,
+114,97,110,103,101,0,0,0,13,5,6,0,15,6,2,0,
+1,7,2,1,31,4,6,2,19,4,5,4,15,3,4,0,
+30,5,0,149,32,32,32,32,102,111,114,32,114,32,105,110,
+32,114,101,103,115,58,0,0,11,5,0,0,0,0,0,0,
+0,0,0,0,42,4,3,5,18,0,0,59,30,9,0,150,
+32,32,32,32,32,32,32,32,115,101,116,95,114,101,103,40,
+114,44,34,36,34,43,115,116,114,40,68,46,95,116,109,112,
+105,41,41,0,12,8,0,7,115,101,116,95,114,101,103,0,
+13,7,8,0,15,8,4,0,12,9,0,1,36,0,0,0,
+12,12,0,3,115,116,114,0,13,11,12,0,12,13,0,1,
+68,0,0,0,13,12,13,0,12,13,0,5,95,116,109,112,
+105,0,0,0,9,12,12,13,31,10,12,1,19,10,11,10,
+1,9,9,10,31,6,8,2,19,6,7,6,30,6,0,151,
+32,32,32,32,32,32,32,32,68,46,95,116,109,112,105,32,
+43,61,32,49,0,0,0,0,12,7,0,1,68,0,0,0,
+13,6,7,0,12,8,0,1,68,0,0,0,13,7,8,0,
+12,8,0,5,95,116,109,112,105,0,0,0,9,7,7,8,
+11,8,0,0,0,0,0,0,0,0,240,63,1,7,7,8,
+12,8,0,5,95,116,109,112,105,0,0,0,10,6,8,7,
+18,0,255,197,30,6,0,152,32,32,32,32,68,46,116,109,
+112,99,32,43,61,32,116,32,35,82,69,71,0,0,0,0,
+12,6,0,1,68,0,0,0,13,5,6,0,12,7,0,1,
+68,0,0,0,13,6,7,0,12,7,0,4,116,109,112,99,
+0,0,0,0,9,6,6,7,1,6,6,1,12,7,0,4,
+116,109,112,99,0,0,0,0,10,5,7,6,30,4,0,153,
+32,32,32,32,114,101,116,117,114,110,32,114,101,103,115,0,
+20,3,0,0,0,0,0,0,12,23,0,8,103,101,116,95,
+116,109,112,115,0,0,0,0,14,23,22,0,30,4,0,154,
+100,101,102,32,97,108,108,111,99,40,116,41,58,0,0,0,
+16,23,0,110,44,16,0,0,30,4,0,154,100,101,102,32,
+97,108,108,111,99,40,116,41,58,0,0,0,12,1,0,9,
+101,110,99,111,100,101,46,112,121,0,0,0,33,1,0,0,
+12,1,0,5,97,108,108,111,99,0,0,0,34,1,0,0,
+28,2,0,0,9,1,0,2,30,18,0,155,32,32,32,32,
+115,32,61,32,39,39,46,106,111,105,110,40,91,34,48,49,
+34,91,114,32,105,110,32,68,46,114,50,110,93,32,102,111,
+114,32,114,32,105,110,32,114,97,110,103,101,40,48,44,109,
+105,110,40,50,53,54,44,68,46,109,114,101,103,43,116,41,
+41,93,41,0,12,4,0,0,0,0,0,0,12,5,0,4,
+106,111,105,110,0,0,0,0,9,4,4,5,27,6,0,0,
+12,10,0,5,114,97,110,103,101,0,0,0,13,9,10,0,
+11,10,0,0,0,0,0,0,0,0,0,0,12,13,0,3,
+109,105,110,0,13,12,13,0,11,13,0,0,0,0,0,0,
+0,0,112,64,12,15,0,1,68,0,0,0,13,14,15,0,
+12,15,0,4,109,114,101,103,0,0,0,0,9,14,14,15,
+1,14,14,1,31,11,13,2,19,11,12,11,31,8,10,2,
+19,8,9,8,11,9,0,0,0,0,0,0,0,0,0,0,
+42,7,8,9,18,0,0,14,12,10,0,2,48,49,0,0,
+12,12,0,1,68,0,0,0,13,11,12,0,12,12,0,3,
+114,50,110,0,9,11,11,12,36,11,11,7,9,10,10,11,
+28,11,0,0,10,6,11,10,18,0,255,242,15,5,6,0,
+31,3,5,1,19,3,4,3,15,2,3,0,30,7,0,156,
+32,32,32,32,114,101,116,117,114,110,32,115,46,105,110,100,
+101,120,40,39,48,39,42,116,41,0,0,0,12,5,0,5,
+105,110,100,101,120,0,0,0,9,4,2,5,12,5,0,1,
+48,0,0,0,3,5,5,1,31,3,5,1,19,3,4,3,
+20,3,0,0,0,0,0,0,12,24,0,5,97,108,108,111,
+99,0,0,0,14,24,23,0,30,4,0,157,100,101,102,32,
+105,115,95,116,109,112,40,114,41,58,0,0,16,24,0,61,
+44,4,0,0,30,4,0,157,100,101,102,32,105,115,95,116,
+109,112,40,114,41,58,0,0,12,1,0,9,101,110,99,111,
+100,101,46,112,121,0,0,0,33,1,0,0,12,1,0,6,
+105,115,95,116,109,112,0,0,34,1,0,0,28,2,0,0,
+9,1,0,2,30,8,0,158,32,32,32,32,105,102,32,114,
+32,105,115,32,78,111,110,101,58,32,114,101,116,117,114,110,
+32,70,97,108,115,101,0,0,28,3,0,0,23,2,1,3,
+21,2,0,0,18,0,0,6,11,2,0,0,0,0,0,0,
+0,0,0,0,20,2,0,0,18,0,0,1,30,8,0,159,
+32,32,32,32,114,101,116,117,114,110,32,40,68,46,114,50,
+110,91,114,93,91,48,93,32,61,61,32,39,36,39,41,0,
+12,3,0,1,68,0,0,0,13,2,3,0,12,3,0,3,
+114,50,110,0,9,2,2,3,9,2,2,1,11,3,0,0,
+0,0,0,0,0,0,0,0,9,2,2,3,12,3,0,1,
+36,0,0,0,23,2,2,3,20,2,0,0,0,0,0,0,
+12,25,0,6,105,115,95,116,109,112,0,0,14,25,24,0,
+30,4,0,160,100,101,102,32,117,110,95,116,109,112,40,114,
+41,58,0,0,16,25,0,63,44,7,0,0,30,4,0,160,
+100,101,102,32,117,110,95,116,109,112,40,114,41,58,0,0,
+12,1,0,9,101,110,99,111,100,101,46,112,121,0,0,0,
+33,1,0,0,12,1,0,6,117,110,95,116,109,112,0,0,
+34,1,0,0,28,2,0,0,9,1,0,2,30,5,0,161,
+32,32,32,32,110,32,61,32,68,46,114,50,110,91,114,93,
+0,0,0,0,12,4,0,1,68,0,0,0,13,3,4,0,
+12,4,0,3,114,50,110,0,9,3,3,4,9,3,3,1,
+15,2,3,0,30,4,0,162,32,32,32,32,102,114,101,101,
+95,114,101,103,40,114,41,0,12,5,0,8,102,114,101,101,
+95,114,101,103,0,0,0,0,13,4,5,0,15,5,1,0,
+31,3,5,1,19,3,4,3,30,6,0,163,32,32,32,32,
+115,101,116,95,114,101,103,40,114,44,39,42,39,43,110,41,
+0,0,0,0,12,5,0,7,115,101,116,95,114,101,103,0,
+13,4,5,0,15,5,1,0,12,6,0,1,42,0,0,0,
+1,6,6,2,31,3,5,2,19,3,4,3,0,0,0,0,
+12,26,0,6,117,110,95,116,109,112,0,0,14,26,25,0,
+30,5,0,164,100,101,102,32,102,114,101,101,95,116,109,112,
+40,114,41,58,0,0,0,0,16,26,0,54,44,5,0,0,
+30,5,0,164,100,101,102,32,102,114,101,101,95,116,109,112,
+40,114,41,58,0,0,0,0,12,1,0,9,101,110,99,111,
+100,101,46,112,121,0,0,0,33,1,0,0,12,1,0,8,
+102,114,101,101,95,116,109,112,0,0,0,0,34,1,0,0,
+28,2,0,0,9,1,0,2,30,8,0,165,32,32,32,32,
+105,102,32,105,115,95,116,109,112,40,114,41,58,32,102,114,
+101,101,95,114,101,103,40,114,41,0,0,0,12,4,0,6,
+105,115,95,116,109,112,0,0,13,3,4,0,15,4,1,0,
+31,2,4,1,19,2,3,2,21,2,0,0,18,0,0,10,
+12,4,0,8,102,114,101,101,95,114,101,103,0,0,0,0,
+13,3,4,0,15,4,1,0,31,2,4,1,19,2,3,2,
+18,0,0,1,30,4,0,166,32,32,32,32,114,101,116,117,
+114,110,32,114,0,0,0,0,20,1,0,0,0,0,0,0,
+12,27,0,8,102,114,101,101,95,116,109,112,0,0,0,0,
+14,27,26,0,30,5,0,167,100,101,102,32,102,114,101,101,
+95,116,109,112,115,40,114,41,58,0,0,0,16,27,0,43,
+44,7,0,0,30,5,0,167,100,101,102,32,102,114,101,101,
+95,116,109,112,115,40,114,41,58,0,0,0,12,1,0,9,
+101,110,99,111,100,101,46,112,121,0,0,0,33,1,0,0,
+12,1,0,9,102,114,101,101,95,116,109,112,115,0,0,0,
+34,1,0,0,28,2,0,0,9,1,0,2,30,7,0,168,
+32,32,32,32,102,111,114,32,107,32,105,110,32,114,58,32,
+102,114,101,101,95,116,109,112,40,107,41,0,11,3,0,0,
+0,0,0,0,0,0,0,0,42,2,1,3,18,0,0,10,
+12,6,0,8,102,114,101,101,95,116,109,112,0,0,0,0,
+13,5,6,0,15,6,2,0,31,4,6,1,19,4,5,4,
+18,0,255,246,0,0,0,0,12,28,0,9,102,114,101,101,
+95,116,109,112,115,0,0,0,14,28,27,0,30,4,0,169,
+100,101,102,32,103,101,116,95,114,101,103,40,110,41,58,0,
+16,28,0,78,44,8,0,0,30,4,0,169,100,101,102,32,
+103,101,116,95,114,101,103,40,110,41,58,0,12,1,0,9,
+101,110,99,111,100,101,46,112,121,0,0,0,33,1,0,0,
+12,1,0,7,103,101,116,95,114,101,103,0,34,1,0,0,
+28,2,0,0,9,1,0,2,30,6,0,170,32,32,32,32,
+105,102,32,110,32,110,111,116,32,105,110,32,68,46,110,50,
+114,58,0,0,12,3,0,1,68,0,0,0,13,2,3,0,
+12,3,0,3,110,50,114,0,9,2,2,3,36,2,2,1,
+11,3,0,0,0,0,0,0,0,0,0,0,23,2,2,3,
+21,2,0,0,18,0,0,26,30,7,0,171,32,32,32,32,
+32,32,32,32,115,101,116,95,114,101,103,40,97,108,108,111,
+99,40,49,41,44,110,41,0,12,4,0,7,115,101,116,95,
+114,101,103,0,13,3,4,0,12,7,0,5,97,108,108,111,
+99,0,0,0,13,6,7,0,11,7,0,0,0,0,0,0,
+0,0,240,63,31,4,7,1,19,4,6,4,15,5,1,0,
+31,2,4,2,19,2,3,2,18,0,0,1,30,5,0,172,
+32,32,32,32,114,101,116,117,114,110,32,68,46,110,50,114,
+91,110,93,0,12,3,0,1,68,0,0,0,13,2,3,0,
+12,3,0,3,110,50,114,0,9,2,2,3,9,2,2,1,
+20,2,0,0,0,0,0,0,12,29,0,7,103,101,116,95,
+114,101,103,0,14,29,28,0,30,5,0,177,100,101,102,32,
+115,101,116,95,114,101,103,40,114,44,110,41,58,0,0,0,
+16,29,0,77,44,9,0,0,30,5,0,177,100,101,102,32,
+115,101,116,95,114,101,103,40,114,44,110,41,58,0,0,0,
+12,1,0,9,101,110,99,111,100,101,46,112,121,0,0,0,
+33,1,0,0,12,1,0,7,115,101,116,95,114,101,103,0,
+34,1,0,0,28,2,0,0,9,1,0,2,28,3,0,0,
+9,2,0,3,30,8,0,178,32,32,32,32,68,46,110,50,
+114,91,110,93,32,61,32,114,59,32,68,46,114,50,110,91,
+114,93,32,61,32,110,0,0,12,4,0,1,68,0,0,0,
+13,3,4,0,12,4,0,3,110,50,114,0,9,3,3,4,
+10,3,2,1,12,4,0,1,68,0,0,0,13,3,4,0,
+12,4,0,3,114,50,110,0,9,3,3,4,10,3,1,2,
+30,8,0,179,32,32,32,32,68,46,109,114,101,103,32,61,
+32,109,97,120,40,68,46,109,114,101,103,44,114,43,49,41,
+0,0,0,0,12,4,0,1,68,0,0,0,13,3,4,0,
+12,6,0,3,109,97,120,0,13,5,6,0,12,8,0,1,
+68,0,0,0,13,6,8,0,12,8,0,4,109,114,101,103,
+0,0,0,0,9,6,6,8,11,8,0,0,0,0,0,0,
+0,0,240,63,1,7,1,8,31,4,6,2,19,4,5,4,
+12,5,0,4,109,114,101,103,0,0,0,0,10,3,5,4,
+0,0,0,0,12,30,0,7,115,101,116,95,114,101,103,0,
+14,30,29,0,30,5,0,180,100,101,102,32,102,114,101,101,
+95,114,101,103,40,114,41,58,0,0,0,0,16,30,0,93,
+44,5,0,0,30,5,0,180,100,101,102,32,102,114,101,101,
+95,114,101,103,40,114,41,58,0,0,0,0,12,1,0,9,
+101,110,99,111,100,101,46,112,121,0,0,0,33,1,0,0,
+12,1,0,8,102,114,101,101,95,114,101,103,0,0,0,0,
+34,1,0,0,28,2,0,0,9,1,0,2,30,8,0,181,
+32,32,32,32,105,102,32,105,115,95,116,109,112,40,114,41,
+58,32,68,46,116,109,112,99,32,45,61,32,49,0,0,0,
+12,4,0,6,105,115,95,116,109,112,0,0,13,3,4,0,
+15,4,1,0,31,2,4,1,19,2,3,2,21,2,0,0,
+18,0,0,20,12,3,0,1,68,0,0,0,13,2,3,0,
+12,4,0,1,68,0,0,0,13,3,4,0,12,4,0,4,
+116,109,112,99,0,0,0,0,9,3,3,4,11,4,0,0,
+0,0,0,0,0,0,240,63,2,3,3,4,12,4,0,4,
+116,109,112,99,0,0,0,0,10,2,4,3,18,0,0,1,
+30,12,0,182,32,32,32,32,110,32,61,32,68,46,114,50,
+110,91,114,93,59,32,100,101,108,32,68,46,114,50,110,91,
+114,93,59,32,100,101,108,32,68,46,110,50,114,91,110,93,
+0,0,0,0,12,4,0,1,68,0,0,0,13,3,4,0,
+12,4,0,3,114,50,110,0,9,3,3,4,9,3,3,1,
+15,2,3,0,12,4,0,1,68,0,0,0,13,3,4,0,
+12,4,0,3,114,50,110,0,9,3,3,4,43,3,1,0,
+12,4,0,1,68,0,0,0,13,3,4,0,12,4,0,3,
+110,50,114,0,9,3,3,4,43,3,2,0,0,0,0,0,
+12,31,0,8,102,114,101,101,95,114,101,103,0,0,0,0,
+14,31,30,0,30,6,0,184,100,101,102,32,105,109,97,110,
+97,103,101,40,111,114,105,103,44,102,110,99,41,58,0,0,
+16,31,0,102,44,14,0,0,30,6,0,184,100,101,102,32,
+105,109,97,110,97,103,101,40,111,114,105,103,44,102,110,99,
+41,58,0,0,12,1,0,9,101,110,99,111,100,101,46,112,
+121,0,0,0,33,1,0,0,12,1,0,7,105,109,97,110,
+97,103,101,0,34,1,0,0,28,2,0,0,9,1,0,2,
+28,3,0,0,9,2,0,3,30,6,0,185,32,32,32,32,
+105,116,101,109,115,32,61,32,111,114,105,103,46,105,116,101,
+109,115,0,0,12,5,0,5,105,116,101,109,115,0,0,0,
+9,4,1,5,15,3,4,0,30,8,0,186,32,32,32,32,
+111,114,105,103,46,118,97,108,32,61,32,111,114,105,103,46,
+118,97,108,91,58,45,49,93,0,0,0,0,12,5,0,3,
+118,97,108,0,9,4,1,5,28,6,0,0,11,7,0,0,
+0,0,0,0,0,0,240,191,27,5,6,2,9,4,4,5,
+12,5,0,3,118,97,108,0,10,1,5,4,30,14,0,187,
+32,32,32,32,116,32,61,32,84,111,107,101,110,40,111,114,
+105,103,46,112,111,115,44,39,115,121,109,98,111,108,39,44,
+39,61,39,44,91,105,116,101,109,115,91,48,93,44,111,114,
+105,103,93,41,0,0,0,0,12,7,0,5,84,111,107,101,
+110,0,0,0,13,6,7,0,12,11,0,3,112,111,115,0,
+9,7,1,11,12,8,0,6,115,121,109,98,111,108,0,0,
+12,9,0,1,61,0,0,0,11,13,0,0,0,0,0,0,
+0,0,0,0,9,11,3,13,15,12,1,0,27,10,11,2,
+31,5,7,4,19,5,6,5,15,4,5,0,30,5,0,188,
+32,32,32,32,114,101,116,117,114,110,32,102,110,99,40,116,
+41,0,0,0,15,6,4,0,31,5,6,1,19,5,2,5,
+20,5,0,0,0,0,0,0,12,32,0,7,105,109,97,110,
+97,103,101,0,14,32,31,0,30,6,0,190,100,101,102,32,
+117,110,97,114,121,40,105,44,116,98,44,114,61,78,111,110,
+101,41,58,0,16,32,0,92,44,10,0,0,30,6,0,190,
+100,101,102,32,117,110,97,114,121,40,105,44,116,98,44,114,
+61,78,111,110,101,41,58,0,12,1,0,9,101,110,99,111,
+100,101,46,112,121,0,0,0,33,1,0,0,12,1,0,5,
+117,110,97,114,121,0,0,0,34,1,0,0,28,2,0,0,
+9,1,0,2,28,3,0,0,9,2,0,3,28,3,0,0,
+28,4,0,0,32,3,0,4,30,5,0,191,32,32,32,32,
+114,32,61,32,103,101,116,95,116,109,112,40,114,41,0,0,
+12,6,0,7,103,101,116,95,116,109,112,0,13,5,6,0,
+15,6,3,0,31,4,6,1,19,4,5,4,15,3,4,0,
+30,4,0,192,32,32,32,32,98,32,61,32,100,111,40,116,
+98,41,0,0,12,7,0,2,100,111,0,0,13,6,7,0,
+15,7,2,0,31,5,7,1,19,5,6,5,15,4,5,0,
+30,4,0,193,32,32,32,32,99,111,100,101,40,105,44,114,
+44,98,41,0,12,7,0,4,99,111,100,101,0,0,0,0,
+13,6,7,0,15,7,1,0,15,8,3,0,15,9,4,0,
+31,5,7,3,19,5,6,5,30,7,0,194,32,32,32,32,
+105,102,32,114,32,33,61,32,98,58,32,102,114,101,101,95,
+116,109,112,40,98,41,0,0,35,5,3,4,21,5,0,0,
+18,0,0,10,12,7,0,8,102,114,101,101,95,116,109,112,
+0,0,0,0,13,6,7,0,15,7,4,0,31,5,7,1,
+19,5,6,5,18,0,0,1,30,4,0,195,32,32,32,32,
+114,101,116,117,114,110,32,114,0,0,0,0,20,3,0,0,
+0,0,0,0,12,33,0,5,117,110,97,114,121,0,0,0,
+14,33,32,0,30,7,0,196,100,101,102,32,105,110,102,105,
+120,40,105,44,116,98,44,116,99,44,114,61,78,111,110,101,
+41,58,0,0,16,33,0,123,44,13,0,0,30,7,0,196,
+100,101,102,32,105,110,102,105,120,40,105,44,116,98,44,116,
+99,44,114,61,78,111,110,101,41,58,0,0,12,1,0,9,
+101,110,99,111,100,101,46,112,121,0,0,0,33,1,0,0,
+12,1,0,5,105,110,102,105,120,0,0,0,34,1,0,0,
+28,2,0,0,9,1,0,2,28,3,0,0,9,2,0,3,
+28,4,0,0,9,3,0,4,28,4,0,0,28,5,0,0,
+32,4,0,5,30,5,0,197,32,32,32,32,114,32,61,32,
+103,101,116,95,116,109,112,40,114,41,0,0,12,7,0,7,
+103,101,116,95,116,109,112,0,13,6,7,0,15,7,4,0,
+31,5,7,1,19,5,6,5,15,4,5,0,30,7,0,198,
+32,32,32,32,98,44,99,32,61,32,100,111,40,116,98,44,
+114,41,44,100,111,40,116,99,41,0,0,0,12,8,0,2,
+100,111,0,0,13,7,8,0,15,8,2,0,15,9,4,0,
+31,6,8,2,19,6,7,6,15,5,6,0,12,9,0,2,
+100,111,0,0,13,8,9,0,15,9,3,0,31,7,9,1,
+19,7,8,7,15,6,7,0,15,7,5,0,15,5,6,0,
+30,5,0,199,32,32,32,32,99,111,100,101,40,105,44,114,
+44,98,44,99,41,0,0,0,12,9,0,4,99,111,100,101,
+0,0,0,0,13,8,9,0,15,9,1,0,15,10,4,0,
+15,11,7,0,15,12,5,0,31,6,9,4,19,6,8,6,
+30,7,0,200,32,32,32,32,105,102,32,114,32,33,61,32,
+98,58,32,102,114,101,101,95,116,109,112,40,98,41,0,0,
+35,6,4,7,21,6,0,0,18,0,0,10,12,9,0,8,
+102,114,101,101,95,116,109,112,0,0,0,0,13,8,9,0,
+15,9,7,0,31,6,9,1,19,6,8,6,18,0,0,1,
+30,4,0,201,32,32,32,32,102,114,101,101,95,116,109,112,
+40,99,41,0,12,9,0,8,102,114,101,101,95,116,109,112,
+0,0,0,0,13,8,9,0,15,9,5,0,31,6,9,1,
+19,6,8,6,30,4,0,202,32,32,32,32,114,101,116,117,
+114,110,32,114,0,0,0,0,20,4,0,0,0,0,0,0,
+12,34,0,5,105,110,102,105,120,0,0,0,14,34,33,0,
+30,10,0,203,100,101,102,32,108,111,103,105,99,95,105,110,
+102,105,120,40,111,112,44,32,116,98,44,32,116,99,44,32,
+95,114,61,78,111,110,101,41,58,0,0,0,16,34,0,210,
+44,12,0,0,30,10,0,203,100,101,102,32,108,111,103,105,
+99,95,105,110,102,105,120,40,111,112,44,32,116,98,44,32,
+116,99,44,32,95,114,61,78,111,110,101,41,58,0,0,0,
+12,1,0,9,101,110,99,111,100,101,46,112,121,0,0,0,
+33,1,0,0,12,1,0,11,108,111,103,105,99,95,105,110,
+102,105,120,0,34,1,0,0,28,2,0,0,9,1,0,2,
+28,3,0,0,9,2,0,3,28,4,0,0,9,3,0,4,
+28,4,0,0,28,5,0,0,32,4,0,5,30,5,0,204,
+32,32,32,32,116,32,61,32,103,101,116,95,116,97,103,40,
+41,32,0,0,12,8,0,7,103,101,116,95,116,97,103,0,
+13,7,8,0,31,6,0,0,19,6,7,6,15,5,6,0,
+30,5,0,205,32,32,32,32,114,32,61,32,100,111,40,116,
+98,44,32,95,114,41,0,0,12,9,0,2,100,111,0,0,
+13,8,9,0,15,9,2,0,15,10,4,0,31,7,9,2,
+19,7,8,7,15,6,7,0,30,9,0,206,32,32,32,32,
+105,102,32,95,114,32,33,61,32,114,58,32,102,114,101,101,
+95,116,109,112,40,95,114,41,32,35,82,69,71,0,0,0,
+35,7,4,6,21,7,0,0,18,0,0,10,12,9,0,8,
+102,114,101,101,95,116,109,112,0,0,0,0,13,8,9,0,
+15,9,4,0,31,7,9,1,19,7,8,7,18,0,0,1,
+30,9,0,207,32,32,32,32,105,102,32,111,112,32,61,61,
+32,39,97,110,100,39,58,32,32,32,99,111,100,101,40,73,
+70,44,32,114,41,0,0,0,12,8,0,3,97,110,100,0,
+23,7,1,8,21,7,0,0,18,0,0,12,12,9,0,4,
+99,111,100,101,0,0,0,0,13,8,9,0,12,11,0,2,
+73,70,0,0,13,9,11,0,15,10,6,0,31,7,9,2,
+19,7,8,7,18,0,0,27,30,9,0,208,32,32,32,32,
+101,108,105,102,32,111,112,32,61,61,32,39,111,114,39,58,
+32,32,99,111,100,101,40,73,70,78,44,32,114,41,0,0,
+12,8,0,2,111,114,0,0,23,7,1,8,21,7,0,0,
+18,0,0,12,12,9,0,4,99,111,100,101,0,0,0,0,
+13,8,9,0,12,11,0,3,73,70,78,0,13,9,11,0,
+15,10,6,0,31,7,9,2,19,7,8,7,18,0,0,1,
+30,5,0,209,32,32,32,32,106,117,109,112,40,116,44,32,
+39,101,110,100,39,41,0,0,12,9,0,4,106,117,109,112,
+0,0,0,0,13,8,9,0,15,9,5,0,12,10,0,3,
+101,110,100,0,31,7,9,2,19,7,8,7,30,3,0,210,
+32,32,32,32,95,114,32,61,32,114,0,0,15,4,6,0,
+30,5,0,211,32,32,32,32,114,32,61,32,100,111,40,116,
+99,44,32,95,114,41,0,0,12,9,0,2,100,111,0,0,
+13,8,9,0,15,9,3,0,15,10,4,0,31,7,9,2,
+19,7,8,7,15,6,7,0,30,9,0,212,32,32,32,32,
+105,102,32,95,114,32,33,61,32,114,58,32,102,114,101,101,
+95,116,109,112,40,95,114,41,32,35,82,69,71,0,0,0,
+35,7,4,6,21,7,0,0,18,0,0,10,12,9,0,8,
+102,114,101,101,95,116,109,112,0,0,0,0,13,8,9,0,
+15,9,4,0,31,7,9,1,19,7,8,7,18,0,0,1,
+30,5,0,213,32,32,32,32,116,97,103,40,116,44,32,39,
+101,110,100,39,41,0,0,0,12,9,0,3,116,97,103,0,
+13,8,9,0,15,9,5,0,12,10,0,3,101,110,100,0,
+31,7,9,2,19,7,8,7,30,4,0,214,32,32,32,32,
+114,101,116,117,114,110,32,114,0,0,0,0,20,6,0,0,
+0,0,0,0,12,35,0,11,108,111,103,105,99,95,105,110,
+102,105,120,0,14,35,34,0,30,6,0,216,100,101,102,32,
+95,100,111,95,110,111,110,101,40,114,61,78,111,110,101,41,
+58,0,0,0,16,35,0,60,44,7,0,0,30,6,0,216,
+100,101,102,32,95,100,111,95,110,111,110,101,40,114,61,78,
+111,110,101,41,58,0,0,0,12,1,0,9,101,110,99,111,
+100,101,46,112,121,0,0,0,33,1,0,0,12,1,0,8,
+95,100,111,95,110,111,110,101,0,0,0,0,34,1,0,0,
+28,1,0,0,28,2,0,0,32,1,0,2,30,5,0,217,
+32,32,32,32,114,32,61,32,103,101,116,95,116,109,112,40,
+114,41,0,0,12,4,0,7,103,101,116,95,116,109,112,0,
+13,3,4,0,15,4,1,0,31,2,4,1,19,2,3,2,
+15,1,2,0,30,5,0,218,32,32,32,32,99,111,100,101,
+40,78,79,78,69,44,114,41,0,0,0,0,12,4,0,4,
+99,111,100,101,0,0,0,0,13,3,4,0,12,6,0,4,
+78,79,78,69,0,0,0,0,13,4,6,0,15,5,1,0,
+31,2,4,2,19,2,3,2,30,4,0,219,32,32,32,32,
+114,101,116,117,114,110,32,114,0,0,0,0,20,1,0,0,
+0,0,0,0,12,36,0,8,95,100,111,95,110,111,110,101,
+0,0,0,0,14,36,35,0,30,7,0,221,100,101,102,32,
+100,111,95,115,121,109,98,111,108,40,116,44,114,61,78,111,
+110,101,41,58,0,0,0,0,16,36,3,191,44,31,0,0,
+30,7,0,221,100,101,102,32,100,111,95,115,121,109,98,111,
+108,40,116,44,114,61,78,111,110,101,41,58,0,0,0,0,
+12,1,0,9,101,110,99,111,100,101,46,112,121,0,0,0,
+33,1,0,0,12,1,0,9,100,111,95,115,121,109,98,111,
+108,0,0,0,34,1,0,0,28,2,0,0,9,1,0,2,
+28,2,0,0,28,3,0,0,32,2,0,3,30,5,0,222,
+32,32,32,32,115,101,116,115,32,61,32,91,39,61,39,93,
+0,0,0,0,12,5,0,1,61,0,0,0,27,4,5,1,
+15,3,4,0,30,13,0,223,32,32,32,32,105,115,101,116,
+115,32,61,32,91,39,43,61,39,44,39,45,61,39,44,39,
+42,61,39,44,39,47,61,39,44,32,39,124,61,39,44,32,
+39,38,61,39,44,32,39,94,61,39,93,0,12,6,0,2,
+43,61,0,0,12,7,0,2,45,61,0,0,12,8,0,2,
+42,61,0,0,12,9,0,2,47,61,0,0,12,10,0,2,
+124,61,0,0,12,11,0,2,38,61,0,0,12,12,0,2,
+94,61,0,0,27,5,6,7,15,4,5,0,30,11,0,224,
+32,32,32,32,99,109,112,115,32,61,32,91,39,60,39,44,
+39,62,39,44,39,60,61,39,44,39,62,61,39,44,39,61,
+61,39,44,39,33,61,39,93,0,0,0,0,12,7,0,1,
+60,0,0,0,12,8,0,1,62,0,0,0,12,9,0,2,
+60,61,0,0,12,10,0,2,62,61,0,0,12,11,0,2,
+61,61,0,0,12,12,0,2,33,61,0,0,27,6,7,6,
+15,5,6,0,30,4,0,225,32,32,32,32,109,101,116,97,
+115,32,61,32,123,0,0,0,30,11,0,226,32,32,32,32,
+32,32,32,32,39,43,39,58,65,68,68,44,39,42,39,58,
+77,85,76,44,39,47,39,58,68,73,86,44,39,42,42,39,
+58,80,79,87,44,0,0,0,12,8,0,1,43,0,0,0,
+12,30,0,3,65,68,68,0,13,9,30,0,12,10,0,1,
+42,0,0,0,12,30,0,3,77,85,76,0,13,11,30,0,
+12,12,0,1,47,0,0,0,12,30,0,3,68,73,86,0,
+13,13,30,0,12,14,0,2,42,42,0,0,12,30,0,3,
+80,79,87,0,13,15,30,0,30,5,0,227,32,32,32,32,
+32,32,32,32,39,45,39,58,83,85,66,44,0,0,0,0,
+12,16,0,1,45,0,0,0,12,30,0,3,83,85,66,0,
+13,17,30,0,30,9,0,228,32,32,32,32,32,32,32,32,
+39,37,39,58,77,79,68,44,39,62,62,39,58,82,83,72,
+44,39,60,60,39,58,76,83,72,44,0,0,12,18,0,1,
+37,0,0,0,12,30,0,3,77,79,68,0,13,19,30,0,
+12,20,0,2,62,62,0,0,12,30,0,3,82,83,72,0,
+13,21,30,0,12,22,0,2,60,60,0,0,12,30,0,3,
+76,83,72,0,13,23,30,0,30,11,0,229,32,32,32,32,
+32,32,32,32,39,38,39,58,66,73,84,65,78,68,44,39,
+124,39,58,66,73,84,79,82,44,39,94,39,58,66,73,84,
+88,79,82,44,0,0,0,0,12,24,0,1,38,0,0,0,
+12,30,0,6,66,73,84,65,78,68,0,0,13,25,30,0,
+12,26,0,1,124,0,0,0,12,30,0,5,66,73,84,79,
+82,0,0,0,13,27,30,0,12,28,0,1,94,0,0,0,
+12,30,0,6,66,73,84,88,79,82,0,0,13,29,30,0,
+26,7,8,22,15,6,7,0,30,11,0,231,32,32,32,32,
+105,102,32,116,46,118,97,108,32,61,61,32,39,78,111,110,
+101,39,58,32,114,101,116,117,114,110,32,95,100,111,95,110,
+111,110,101,40,114,41,0,0,12,8,0,3,118,97,108,0,
+9,7,1,8,12,8,0,4,78,111,110,101,0,0,0,0,
+23,7,7,8,21,7,0,0,18,0,0,11,12,9,0,8,
+95,100,111,95,110,111,110,101,0,0,0,0,13,8,9,0,
+15,9,2,0,31,7,9,1,19,7,8,7,20,7,0,0,
+18,0,0,1,30,6,0,232,32,32,32,32,105,102,32,116,
+46,118,97,108,32,61,61,32,39,84,114,117,101,39,58,0,
+12,8,0,3,118,97,108,0,9,7,1,8,12,8,0,4,
+84,114,117,101,0,0,0,0,23,7,7,8,21,7,0,0,
+18,0,0,23,30,9,0,233,32,32,32,32,32,32,32,32,
+114,101,116,117,114,110,32,95,100,111,95,110,117,109,98,101,
+114,40,39,49,39,44,114,41,0,0,0,0,12,9,0,10,
+95,100,111,95,110,117,109,98,101,114,0,0,13,8,9,0,
+12,9,0,1,49,0,0,0,15,10,2,0,31,7,9,2,
+19,7,8,7,20,7,0,0,18,0,0,1,30,7,0,234,
+32,32,32,32,105,102,32,116,46,118,97,108,32,61,61,32,
+39,70,97,108,115,101,39,58,0,0,0,0,12,8,0,3,
+118,97,108,0,9,7,1,8,12,8,0,5,70,97,108,115,
+101,0,0,0,23,7,7,8,21,7,0,0,18,0,0,23,
+30,9,0,235,32,32,32,32,32,32,32,32,114,101,116,117,
+114,110,32,95,100,111,95,110,117,109,98,101,114,40,39,48,
+39,44,114,41,0,0,0,0,12,9,0,10,95,100,111,95,
+110,117,109,98,101,114,0,0,13,8,9,0,12,9,0,1,
+48,0,0,0,15,10,2,0,31,7,9,2,19,7,8,7,
+20,7,0,0,18,0,0,1,30,5,0,236,32,32,32,32,
+105,116,101,109,115,32,61,32,116,46,105,116,101,109,115,0,
+12,9,0,5,105,116,101,109,115,0,0,0,9,8,1,9,
+15,7,8,0,30,8,0,238,32,32,32,32,105,102,32,116,
+46,118,97,108,32,105,110,32,91,39,97,110,100,39,44,39,
+111,114,39,93,58,0,0,0,12,9,0,3,97,110,100,0,
+12,10,0,2,111,114,0,0,27,8,9,2,12,10,0,3,
+118,97,108,0,9,9,1,10,36,8,8,9,21,8,0,0,
+18,0,0,38,30,15,0,239,32,32,32,32,32,32,32,32,
+114,101,116,117,114,110,32,108,111,103,105,99,95,105,110,102,
+105,120,40,116,46,118,97,108,44,32,105,116,101,109,115,91,
+48,93,44,32,105,116,101,109,115,91,49,93,44,32,114,41,
+0,0,0,0,12,10,0,11,108,111,103,105,99,95,105,110,
+102,105,120,0,13,9,10,0,12,14,0,3,118,97,108,0,
+9,10,1,14,11,14,0,0,0,0,0,0,0,0,0,0,
+9,11,7,14,11,14,0,0,0,0,0,0,0,0,240,63,
+9,12,7,14,15,13,2,0,31,8,10,4,19,8,9,8,
+20,8,0,0,18,0,0,1,30,6,0,240,32,32,32,32,
+105,102,32,116,46,118,97,108,32,105,110,32,105,115,101,116,
+115,58,0,0,12,10,0,3,118,97,108,0,9,9,1,10,
+36,8,4,9,21,8,0,0,18,0,0,25,30,9,0,241,
+32,32,32,32,32,32,32,32,114,101,116,117,114,110,32,105,
+109,97,110,97,103,101,40,116,44,100,111,95,115,121,109,98,
+111,108,41,0,12,10,0,7,105,109,97,110,97,103,101,0,
+13,9,10,0,15,10,1,0,12,12,0,9,100,111,95,115,
+121,109,98,111,108,0,0,0,13,11,12,0,31,8,10,2,
+19,8,9,8,20,8,0,0,18,0,0,1,30,6,0,242,
+32,32,32,32,105,102,32,116,46,118,97,108,32,61,61,32,
+39,105,115,39,58,0,0,0,12,9,0,3,118,97,108,0,
+9,8,1,9,12,9,0,2,105,115,0,0,23,8,8,9,
+21,8,0,0,18,0,0,34,30,12,0,243,32,32,32,32,
+32,32,32,32,114,101,116,117,114,110,32,105,110,102,105,120,
+40,69,81,44,105,116,101,109,115,91,48,93,44,105,116,101,
+109,115,91,49,93,44,114,41,0,0,0,0,12,10,0,5,
+105,110,102,105,120,0,0,0,13,9,10,0,12,14,0,2,
+69,81,0,0,13,10,14,0,11,14,0,0,0,0,0,0,
+0,0,0,0,9,11,7,14,11,14,0,0,0,0,0,0,
+0,0,240,63,9,12,7,14,15,13,2,0,31,8,10,4,
+19,8,9,8,20,8,0,0,18,0,0,1,30,7,0,244,
+32,32,32,32,105,102,32,116,46,118,97,108,32,61,61,32,
+39,105,115,110,111,116,39,58,0,0,0,0,12,9,0,3,
+118,97,108,0,9,8,1,9,12,9,0,5,105,115,110,111,
+116,0,0,0,23,8,8,9,21,8,0,0,18,0,0,34,
+30,12,0,245,32,32,32,32,32,32,32,32,114,101,116,117,
+114,110,32,105,110,102,105,120,40,67,77,80,44,105,116,101,
+109,115,91,48,93,44,105,116,101,109,115,91,49,93,44,114,
+41,0,0,0,12,10,0,5,105,110,102,105,120,0,0,0,
+13,9,10,0,12,14,0,3,67,77,80,0,13,10,14,0,
+11,14,0,0,0,0,0,0,0,0,0,0,9,11,7,14,
+11,14,0,0,0,0,0,0,0,0,240,63,9,12,7,14,
+15,13,2,0,31,8,10,4,19,8,9,8,20,8,0,0,
+18,0,0,1,30,6,0,246,32,32,32,32,105,102,32,116,
+46,118,97,108,32,61,61,32,39,110,111,116,39,58,0,0,
+12,9,0,3,118,97,108,0,9,8,1,9,12,9,0,3,
+110,111,116,0,23,8,8,9,21,8,0,0,18,0,0,28,
+30,10,0,247,32,32,32,32,32,32,32,32,114,101,116,117,
+114,110,32,117,110,97,114,121,40,78,79,84,44,32,105,116,
+101,109,115,91,48,93,44,32,114,41,0,0,12,10,0,5,
+117,110,97,114,121,0,0,0,13,9,10,0,12,13,0,3,
+78,79,84,0,13,10,13,0,11,13,0,0,0,0,0,0,
+0,0,0,0,9,11,7,13,15,12,2,0,31,8,10,3,
+19,8,9,8,20,8,0,0,18,0,0,1,30,6,0,248,
+32,32,32,32,105,102,32,116,46,118,97,108,32,61,61,32,
+39,105,110,39,58,0,0,0,12,9,0,3,118,97,108,0,
+9,8,1,9,12,9,0,2,105,110,0,0,23,8,8,9,
+21,8,0,0,18,0,0,34,30,12,0,249,32,32,32,32,
+32,32,32,32,114,101,116,117,114,110,32,105,110,102,105,120,
+40,72,65,83,44,105,116,101,109,115,91,49,93,44,105,116,
+101,109,115,91,48,93,44,114,41,0,0,0,12,10,0,5,
+105,110,102,105,120,0,0,0,13,9,10,0,12,14,0,3,
+72,65,83,0,13,10,14,0,11,14,0,0,0,0,0,0,
+0,0,240,63,9,11,7,14,11,14,0,0,0,0,0,0,
+0,0,0,0,9,12,7,14,15,13,2,0,31,8,10,4,
+19,8,9,8,20,8,0,0,18,0,0,1,30,7,0,250,
+32,32,32,32,105,102,32,116,46,118,97,108,32,61,61,32,
+39,110,111,116,105,110,39,58,0,0,0,0,12,9,0,3,
+118,97,108,0,9,8,1,9,12,9,0,5,110,111,116,105,
+110,0,0,0,23,8,8,9,21,8,0,0,18,0,0,88,
+30,11,0,251,32,32,32,32,32,32,32,32,114,32,61,32,
+105,110,102,105,120,40,72,65,83,44,105,116,101,109,115,91,
+49,93,44,105,116,101,109,115,91,48,93,44,114,41,0,0,
+12,10,0,5,105,110,102,105,120,0,0,0,13,9,10,0,
+12,14,0,3,72,65,83,0,13,10,14,0,11,14,0,0,
+0,0,0,0,0,0,240,63,9,11,7,14,11,14,0,0,
+0,0,0,0,0,0,0,0,9,12,7,14,15,13,2,0,
+31,8,10,4,19,8,9,8,15,2,8,0,30,8,0,252,
+32,32,32,32,32,32,32,32,122,101,114,111,32,61,32,95,
+100,111,95,110,117,109,98,101,114,40,39,48,39,41,0,0,
+12,11,0,10,95,100,111,95,110,117,109,98,101,114,0,0,
+13,10,11,0,12,11,0,1,48,0,0,0,31,9,11,1,
+19,9,10,9,15,8,9,0,30,9,0,253,32,32,32,32,
+32,32,32,32,99,111,100,101,40,69,81,44,114,44,114,44,
+102,114,101,101,95,116,109,112,40,122,101,114,111,41,41,0,
+12,11,0,4,99,111,100,101,0,0,0,0,13,10,11,0,
+12,15,0,2,69,81,0,0,13,11,15,0,15,12,2,0,
+15,13,2,0,12,16,0,8,102,114,101,101,95,116,109,112,
+0,0,0,0,13,15,16,0,15,16,8,0,31,14,16,1,
+19,14,15,14,31,9,11,4,19,9,10,9,30,5,0,254,
+32,32,32,32,32,32,32,32,114,101,116,117,114,110,32,114,
+0,0,0,0,20,2,0,0,18,0,0,1,30,6,0,255,
+32,32,32,32,105,102,32,116,46,118,97,108,32,105,110,32,
+115,101,116,115,58,0,0,0,12,11,0,3,118,97,108,0,
+9,10,1,11,36,9,3,10,21,9,0,0,18,0,0,31,
+30,12,1,0,32,32,32,32,32,32,32,32,114,101,116,117,
+114,110,32,100,111,95,115,101,116,95,99,116,120,40,105,116,
+101,109,115,91,48,93,44,105,116,101,109,115,91,49,93,41,
+59,0,0,0,12,11,0,10,100,111,95,115,101,116,95,99,
+116,120,0,0,13,10,11,0,11,13,0,0,0,0,0,0,
+0,0,0,0,9,11,7,13,11,13,0,0,0,0,0,0,
+0,0,240,63,9,12,7,13,31,9,11,2,19,9,10,9,
+20,9,0,0,18,0,0,215,30,6,1,1,32,32,32,32,
+101,108,105,102,32,116,46,118,97,108,32,105,110,32,99,109,
+112,115,58,0,12,11,0,3,118,97,108,0,9,10,1,11,
+36,9,5,10,21,9,0,0,18,0,0,166,30,8,1,2,
+32,32,32,32,32,32,32,32,98,44,99,32,61,32,105,116,
+101,109,115,91,48,93,44,105,116,101,109,115,91,49,93,0,
+11,11,0,0,0,0,0,0,0,0,0,0,9,10,7,11,
+15,9,10,0,11,12,0,0,0,0,0,0,0,0,240,63,
+9,11,7,12,15,10,11,0,15,11,9,0,15,9,10,0,
+30,5,1,3,32,32,32,32,32,32,32,32,118,32,61,32,
+116,46,118,97,108,0,0,0,12,13,0,3,118,97,108,0,
+9,12,1,13,15,10,12,0,30,8,1,4,32,32,32,32,
+32,32,32,32,105,102,32,118,91,48,93,32,105,110,32,40,
+39,62,39,44,39,62,61,39,41,58,0,0,12,13,0,1,
+62,0,0,0,12,14,0,2,62,61,0,0,27,12,13,2,
+11,14,0,0,0,0,0,0,0,0,0,0,9,13,10,14,
+36,12,12,13,21,12,0,0,18,0,0,27,30,9,1,5,
+32,32,32,32,32,32,32,32,32,32,32,32,98,44,99,44,
+118,32,61,32,99,44,98,44,39,60,39,43,118,91,49,58,
+93,0,0,0,15,12,9,0,15,13,11,0,12,15,0,1,
+60,0,0,0,11,18,0,0,0,0,0,0,0,0,240,63,
+28,19,0,0,27,17,18,2,9,16,10,17,1,15,15,16,
+15,14,15,0,15,11,12,0,15,9,13,0,15,10,14,0,
+18,0,0,1,30,4,1,6,32,32,32,32,32,32,32,32,
+99,100,32,61,32,69,81,0,12,14,0,2,69,81,0,0,
+13,13,14,0,15,12,13,0,30,8,1,7,32,32,32,32,
+32,32,32,32,105,102,32,118,32,61,61,32,39,60,39,58,
+32,99,100,32,61,32,76,84,0,0,0,0,12,14,0,1,
+60,0,0,0,23,13,10,14,21,13,0,0,18,0,0,6,
+12,14,0,2,76,84,0,0,13,13,14,0,15,12,13,0,
+18,0,0,1,30,8,1,8,32,32,32,32,32,32,32,32,
+105,102,32,118,32,61,61,32,39,60,61,39,58,32,99,100,
+32,61,32,76,69,0,0,0,12,14,0,2,60,61,0,0,
+23,13,10,14,21,13,0,0,18,0,0,6,12,14,0,2,
+76,69,0,0,13,13,14,0,15,12,13,0,18,0,0,1,
+30,8,1,9,32,32,32,32,32,32,32,32,105,102,32,118,
+32,61,61,32,39,33,61,39,58,32,99,100,32,61,32,78,
+69,0,0,0,12,14,0,2,33,61,0,0,23,13,10,14,
+21,13,0,0,18,0,0,6,12,14,0,2,78,69,0,0,
+13,13,14,0,15,12,13,0,18,0,0,1,30,8,1,10,
+32,32,32,32,32,32,32,32,114,101,116,117,114,110,32,105,
+110,102,105,120,40,99,100,44,98,44,99,44,114,41,0,0,
+12,15,0,5,105,110,102,105,120,0,0,0,13,14,15,0,
+15,15,12,0,15,16,11,0,15,17,9,0,15,18,2,0,
+31,13,15,4,19,13,14,13,20,13,0,0,18,0,0,37,
+30,14,1,12,32,32,32,32,32,32,32,32,114,101,116,117,
+114,110,32,105,110,102,105,120,40,109,101,116,97,115,91,116,
+46,118,97,108,93,44,105,116,101,109,115,91,48,93,44,105,
+116,101,109,115,91,49,93,44,114,41,0,0,12,15,0,5,
+105,110,102,105,120,0,0,0,13,14,15,0,12,20,0,3,
+118,97,108,0,9,19,1,20,9,15,6,19,11,19,0,0,
+0,0,0,0,0,0,0,0,9,16,7,19,11,19,0,0,
+0,0,0,0,0,0,240,63,9,17,7,19,15,18,2,0,
+31,13,15,4,19,13,14,13,20,13,0,0,18,0,0,1,
+0,0,0,0,12,37,0,9,100,111,95,115,121,109,98,111,
+108,0,0,0,14,37,36,0,30,6,1,14,100,101,102,32,
+100,111,95,115,101,116,95,99,116,120,40,107,44,118,41,58,
+0,0,0,0,16,37,3,102,44,34,0,0,30,6,1,14,
+100,101,102,32,100,111,95,115,101,116,95,99,116,120,40,107,
+44,118,41,58,0,0,0,0,12,1,0,9,101,110,99,111,
+100,101,46,112,121,0,0,0,33,1,0,0,12,1,0,10,
+100,111,95,115,101,116,95,99,116,120,0,0,34,1,0,0,
+28,2,0,0,9,1,0,2,28,3,0,0,9,2,0,3,
+30,7,1,15,32,32,32,32,105,102,32,107,46,116,121,112,
+101,32,61,61,32,39,110,97,109,101,39,58,0,0,0,0,
+12,4,0,4,116,121,112,101,0,0,0,0,9,3,1,4,
+12,4,0,4,110,97,109,101,0,0,0,0,23,3,3,4,
+21,3,0,0,18,0,0,222,30,19,1,16,32,32,32,32,
+32,32,32,32,105,102,32,40,68,46,95,103,108,111,98,97,
+108,115,32,97,110,100,32,107,46,118,97,108,32,110,111,116,
+32,105,110,32,68,46,118,97,114,115,41,32,111,114,32,40,
+107,46,118,97,108,32,105,110,32,68,46,103,108,111,98,97,
+108,115,41,58,0,0,0,0,12,4,0,1,68,0,0,0,
+13,3,4,0,12,4,0,8,95,103,108,111,98,97,108,115,
+0,0,0,0,9,3,3,4,21,3,0,0,18,0,0,16,
+12,4,0,1,68,0,0,0,13,3,4,0,12,4,0,4,
+118,97,114,115,0,0,0,0,9,3,3,4,12,5,0,3,
+118,97,108,0,9,4,1,5,36,3,3,4,11,4,0,0,
+0,0,0,0,0,0,0,0,23,3,3,4,46,3,0,0,
+18,0,0,12,12,4,0,1,68,0,0,0,13,3,4,0,
+12,4,0,7,103,108,111,98,97,108,115,0,9,3,3,4,
+12,5,0,3,118,97,108,0,9,4,1,5,36,3,3,4,
+21,3,0,0,18,0,0,92,30,8,1,17,32,32,32,32,
+32,32,32,32,32,32,32,32,99,32,61,32,100,111,95,115,
+116,114,105,110,103,40,107,41,0,0,0,0,12,6,0,9,
+100,111,95,115,116,114,105,110,103,0,0,0,13,5,6,0,
+15,6,1,0,31,4,6,1,19,4,5,4,15,3,4,0,
+30,6,1,18,32,32,32,32,32,32,32,32,32,32,32,32,
+98,32,61,32,100,111,40,118,41,0,0,0,12,7,0,2,
+100,111,0,0,13,6,7,0,15,7,2,0,31,5,7,1,
+19,5,6,5,15,4,5,0,30,7,1,19,32,32,32,32,
+32,32,32,32,32,32,32,32,99,111,100,101,40,71,83,69,
+84,44,99,44,98,41,0,0,12,7,0,4,99,111,100,101,
+0,0,0,0,13,6,7,0,12,10,0,4,71,83,69,84,
+0,0,0,0,13,7,10,0,15,8,3,0,15,9,4,0,
+31,5,7,3,19,5,6,5,30,6,1,20,32,32,32,32,
+32,32,32,32,32,32,32,32,102,114,101,101,95,116,109,112,
+40,99,41,0,12,7,0,8,102,114,101,101,95,116,109,112,
+0,0,0,0,13,6,7,0,15,7,3,0,31,5,7,1,
+19,5,6,5,30,6,1,21,32,32,32,32,32,32,32,32,
+32,32,32,32,102,114,101,101,95,116,109,112,40,98,41,0,
+12,7,0,8,102,114,101,101,95,116,109,112,0,0,0,0,
+13,6,7,0,15,7,4,0,31,5,7,1,19,5,6,5,
+30,5,1,22,32,32,32,32,32,32,32,32,32,32,32,32,
+114,101,116,117,114,110,0,0,28,5,0,0,20,5,0,0,
+18,0,0,1,30,6,1,23,32,32,32,32,32,32,32,32,
+97,32,61,32,100,111,95,108,111,99,97,108,40,107,41,0,
+12,8,0,8,100,111,95,108,111,99,97,108,0,0,0,0,
+13,7,8,0,15,8,1,0,31,6,8,1,19,6,7,6,
+15,5,6,0,30,5,1,24,32,32,32,32,32,32,32,32,
+98,32,61,32,100,111,40,118,41,0,0,0,12,8,0,2,
+100,111,0,0,13,7,8,0,15,8,2,0,31,6,8,1,
+19,6,7,6,15,4,6,0,30,6,1,25,32,32,32,32,
+32,32,32,32,99,111,100,101,40,77,79,86,69,44,97,44,
+98,41,0,0,12,8,0,4,99,111,100,101,0,0,0,0,
+13,7,8,0,12,11,0,4,77,79,86,69,0,0,0,0,
+13,8,11,0,15,9,5,0,15,10,4,0,31,6,8,3,
+19,6,7,6,30,5,1,26,32,32,32,32,32,32,32,32,
+102,114,101,101,95,116,109,112,40,98,41,0,12,8,0,8,
+102,114,101,101,95,116,109,112,0,0,0,0,13,7,8,0,
+15,8,4,0,31,6,8,1,19,6,7,6,30,5,1,27,
+32,32,32,32,32,32,32,32,114,101,116,117,114,110,32,97,
+0,0,0,0,20,5,0,0,18,0,1,242,30,10,1,28,
+32,32,32,32,101,108,105,102,32,107,46,116,121,112,101,32,
+105,110,32,40,39,116,117,112,108,101,39,44,39,108,105,115,
+116,39,41,58,0,0,0,0,12,7,0,5,116,117,112,108,
+101,0,0,0,12,8,0,4,108,105,115,116,0,0,0,0,
+27,6,7,2,12,8,0,4,116,121,112,101,0,0,0,0,
+9,7,1,8,36,6,6,7,21,6,0,0,18,0,1,217,
+30,10,1,29,32,32,32,32,32,32,32,32,105,102,32,118,
+46,116,121,112,101,32,105,110,32,40,39,116,117,112,108,101,
+39,44,39,108,105,115,116,39,41,58,0,0,12,7,0,5,
+116,117,112,108,101,0,0,0,12,8,0,4,108,105,115,116,
+0,0,0,0,27,6,7,2,12,8,0,4,116,121,112,101,
+0,0,0,0,9,7,2,8,36,6,6,7,21,6,0,0,
+18,0,1,12,30,7,1,30,32,32,32,32,32,32,32,32,
+32,32,32,32,110,44,116,109,112,115,32,61,32,48,44,91,
+93,0,0,0,11,7,0,0,0,0,0,0,0,0,0,0,
+15,6,7,0,27,8,0,0,15,7,8,0,15,8,6,0,
+15,6,7,0,30,8,1,31,32,32,32,32,32,32,32,32,
+32,32,32,32,102,111,114,32,107,107,32,105,110,32,107,46,
+105,116,101,109,115,58,0,0,12,10,0,5,105,116,101,109,
+115,0,0,0,9,9,1,10,11,10,0,0,0,0,0,0,
+0,0,0,0,42,7,9,10,18,0,0,112,30,8,1,32,
+32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,
+118,118,32,61,32,118,46,105,116,101,109,115,91,110,93,0,
+12,13,0,5,105,116,101,109,115,0,0,0,9,12,2,13,
+9,12,12,8,15,11,12,0,30,13,1,33,32,32,32,32,
+32,32,32,32,32,32,32,32,32,32,32,32,116,109,112,32,
+61,32,103,101,116,95,116,109,112,40,41,59,32,116,109,112,
+115,46,97,112,112,101,110,100,40,116,109,112,41,0,0,0,
+12,15,0,7,103,101,116,95,116,109,112,0,13,14,15,0,
+31,13,0,0,19,13,14,13,15,12,13,0,12,15,0,6,
+97,112,112,101,110,100,0,0,9,14,6,15,15,15,12,0,
+31,13,15,1,19,13,14,13,30,7,1,34,32,32,32,32,
+32,32,32,32,32,32,32,32,32,32,32,32,114,32,61,32,
+100,111,40,118,118,41,0,0,12,16,0,2,100,111,0,0,
+13,15,16,0,15,16,11,0,31,14,16,1,19,14,15,14,
+15,13,14,0,30,9,1,35,32,32,32,32,32,32,32,32,
+32,32,32,32,32,32,32,32,99,111,100,101,40,77,79,86,
+69,44,116,109,112,44,114,41,0,0,0,0,12,16,0,4,
+99,111,100,101,0,0,0,0,13,15,16,0,12,19,0,4,
+77,79,86,69,0,0,0,0,13,16,19,0,15,17,12,0,
+15,18,13,0,31,14,16,3,19,14,15,14,30,9,1,36,
+32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,
+102,114,101,101,95,116,109,112,40,114,41,32,35,82,69,71,
+0,0,0,0,12,16,0,8,102,114,101,101,95,116,109,112,
+0,0,0,0,13,15,16,0,15,16,13,0,31,14,16,1,
+19,14,15,14,30,6,1,37,32,32,32,32,32,32,32,32,
+32,32,32,32,32,32,32,32,110,43,61,49,0,0,0,0,
+11,15,0,0,0,0,0,0,0,0,240,63,1,14,8,15,
+15,8,14,0,18,0,255,144,30,5,1,38,32,32,32,32,
+32,32,32,32,32,32,32,32,110,32,61,32,48,0,0,0,
+11,9,0,0,0,0,0,0,0,0,0,0,15,8,9,0,
+30,8,1,39,32,32,32,32,32,32,32,32,32,32,32,32,
+102,111,114,32,107,107,32,105,110,32,107,46,105,116,101,109,
+115,58,0,0,12,10,0,5,105,116,101,109,115,0,0,0,
+9,9,1,10,11,10,0,0,0,0,0,0,0,0,0,0,
+42,7,9,10,18,0,0,86,30,8,1,40,32,32,32,32,
+32,32,32,32,32,32,32,32,32,32,32,32,118,118,32,61,
+32,118,46,105,116,101,109,115,91,110,93,0,12,15,0,5,
+105,116,101,109,115,0,0,0,9,14,2,15,9,14,14,8,
+15,11,14,0,30,8,1,41,32,32,32,32,32,32,32,32,
+32,32,32,32,32,32,32,32,116,109,112,32,61,32,116,109,
+112,115,91,110,93,0,0,0,9,14,6,8,15,12,14,0,
+30,18,1,42,32,32,32,32,32,32,32,32,32,32,32,32,
+32,32,32,32,102,114,101,101,95,116,109,112,40,100,111,95,
+115,101,116,95,99,116,120,40,107,107,44,84,111,107,101,110,
+40,118,118,46,112,111,115,44,39,114,101,103,39,44,116,109,
+112,41,41,41,32,35,82,69,71,0,0,0,12,16,0,8,
+102,114,101,101,95,116,109,112,0,0,0,0,13,15,16,0,
+12,18,0,10,100,111,95,115,101,116,95,99,116,120,0,0,
+13,17,18,0,15,18,7,0,12,21,0,5,84,111,107,101,
+110,0,0,0,13,20,21,0,12,24,0,3,112,111,115,0,
+9,21,11,24,12,22,0,3,114,101,103,0,15,23,12,0,
+31,19,21,3,19,19,20,19,31,16,18,2,19,16,17,16,
+31,14,16,1,19,14,15,14,30,6,1,43,32,32,32,32,
+32,32,32,32,32,32,32,32,32,32,32,32,110,32,43,61,
+32,49,0,0,11,15,0,0,0,0,0,0,0,0,240,63,
+1,14,8,15,15,8,14,0,18,0,255,170,30,5,1,44,
+32,32,32,32,32,32,32,32,32,32,32,32,114,101,116,117,
+114,110,0,0,28,9,0,0,20,9,0,0,18,0,0,1,
+30,8,1,46,32,32,32,32,32,32,32,32,114,32,61,32,
+100,111,40,118,41,59,32,117,110,95,116,109,112,40,114,41,
+0,0,0,0,12,14,0,2,100,111,0,0,13,10,14,0,
+15,14,2,0,31,9,14,1,19,9,10,9,15,13,9,0,
+12,14,0,6,117,110,95,116,109,112,0,0,13,10,14,0,
+15,14,13,0,31,9,14,1,19,9,10,9,30,11,1,47,
+32,32,32,32,32,32,32,32,110,44,32,116,109,112,32,61,
+32,48,44,32,84,111,107,101,110,40,118,46,112,111,115,44,
+39,114,101,103,39,44,114,41,0,0,0,0,11,10,0,0,
+0,0,0,0,0,0,0,0,15,9,10,0,12,16,0,5,
+84,111,107,101,110,0,0,0,13,15,16,0,12,19,0,3,
+112,111,115,0,9,16,2,19,12,17,0,3,114,101,103,0,
+15,18,13,0,31,14,16,3,19,14,15,14,15,10,14,0,
+15,8,9,0,15,12,10,0,30,7,1,48,32,32,32,32,
+32,32,32,32,102,111,114,32,116,116,32,105,110,32,107,46,
+105,116,101,109,115,58,0,0,12,14,0,5,105,116,101,109,
+115,0,0,0,9,10,1,14,11,14,0,0,0,0,0,0,
+0,0,0,0,42,9,10,14,18,0,0,88,30,27,1,49,
+32,32,32,32,32,32,32,32,32,32,32,32,102,114,101,101,
+95,116,109,112,40,100,111,95,115,101,116,95,99,116,120,40,
+116,116,44,84,111,107,101,110,40,116,109,112,46,112,111,115,
+44,39,103,101,116,39,44,78,111,110,101,44,91,116,109,112,
+44,84,111,107,101,110,40,116,109,112,46,112,111,115,44,39,
+110,117,109,98,101,114,39,44,115,116,114,40,110,41,41,93,
+41,41,41,32,35,82,69,71,0,0,0,0,12,17,0,8,
+102,114,101,101,95,116,109,112,0,0,0,0,13,16,17,0,
+12,19,0,10,100,111,95,115,101,116,95,99,116,120,0,0,
+13,18,19,0,15,19,9,0,12,22,0,5,84,111,107,101,
+110,0,0,0,13,21,22,0,12,26,0,3,112,111,115,0,
+9,22,12,26,12,23,0,3,103,101,116,0,28,24,0,0,
+15,26,12,0,12,29,0,5,84,111,107,101,110,0,0,0,
+13,28,29,0,12,32,0,3,112,111,115,0,9,29,12,32,
+12,30,0,6,110,117,109,98,101,114,0,0,12,33,0,3,
+115,116,114,0,13,32,33,0,15,33,8,0,31,31,33,1,
+19,31,32,31,31,27,29,3,19,27,28,27,27,25,26,2,
+31,20,22,4,19,20,21,20,31,17,19,2,19,17,18,17,
+31,15,17,1,19,15,16,15,30,5,1,50,32,32,32,32,
+32,32,32,32,32,32,32,32,110,32,43,61,32,49,0,0,
+11,16,0,0,0,0,0,0,0,0,240,63,1,15,8,16,
+15,8,15,0,18,0,255,168,30,5,1,51,32,32,32,32,
+32,32,32,32,102,114,101,101,95,114,101,103,40,114,41,0,
+12,15,0,8,102,114,101,101,95,114,101,103,0,0,0,0,
+13,14,15,0,15,15,13,0,31,10,15,1,19,10,14,10,
+30,4,1,52,32,32,32,32,32,32,32,32,114,101,116,117,
+114,110,0,0,28,10,0,0,20,10,0,0,18,0,0,1,
+30,6,1,53,32,32,32,32,114,32,61,32,100,111,40,107,
+46,105,116,101,109,115,91,48,93,41,0,0,12,15,0,2,
+100,111,0,0,13,14,15,0,12,16,0,5,105,116,101,109,
+115,0,0,0,9,15,1,16,11,16,0,0,0,0,0,0,
+0,0,0,0,9,15,15,16,31,10,15,1,19,10,14,10,
+15,13,10,0,30,4,1,54,32,32,32,32,114,114,32,61,
+32,100,111,40,118,41,0,0,12,16,0,2,100,111,0,0,
+13,15,16,0,15,16,2,0,31,14,16,1,19,14,15,14,
+15,10,14,0,30,7,1,55,32,32,32,32,116,109,112,32,
+61,32,100,111,40,107,46,105,116,101,109,115,91,49,93,41,
+0,0,0,0,12,16,0,2,100,111,0,0,13,15,16,0,
+12,17,0,5,105,116,101,109,115,0,0,0,9,16,1,17,
+11,17,0,0,0,0,0,0,0,0,240,63,9,16,16,17,
+31,14,16,1,19,14,15,14,15,12,14,0,30,6,1,56,
+32,32,32,32,99,111,100,101,40,83,69,84,44,114,44,116,
+109,112,44,114,114,41,0,0,12,16,0,4,99,111,100,101,
+0,0,0,0,13,15,16,0,12,20,0,3,83,69,84,0,
+13,16,20,0,15,17,13,0,15,18,12,0,15,19,10,0,
+31,14,16,4,19,14,15,14,30,6,1,57,32,32,32,32,
+102,114,101,101,95,116,109,112,40,114,41,32,35,82,69,71,
+0,0,0,0,12,16,0,8,102,114,101,101,95,116,109,112,
+0,0,0,0,13,15,16,0,15,16,13,0,31,14,16,1,
+19,14,15,14,30,6,1,58,32,32,32,32,102,114,101,101,
+95,116,109,112,40,116,109,112,41,32,35,82,69,71,0,0,
+12,16,0,8,102,114,101,101,95,116,109,112,0,0,0,0,
+13,15,16,0,15,16,12,0,31,14,16,1,19,14,15,14,
+30,4,1,59,32,32,32,32,114,101,116,117,114,110,32,114,
+114,0,0,0,20,10,0,0,0,0,0,0,12,38,0,10,
+100,111,95,115,101,116,95,99,116,120,0,0,14,38,37,0,
+30,9,1,61,100,101,102,32,109,97,110,97,103,101,95,115,
+101,113,40,105,44,97,44,105,116,101,109,115,44,115,97,118,
+61,48,41,58,0,0,0,0,16,38,1,19,44,19,0,0,
+30,9,1,61,100,101,102,32,109,97,110,97,103,101,95,115,
+101,113,40,105,44,97,44,105,116,101,109,115,44,115,97,118,
+61,48,41,58,0,0,0,0,12,1,0,9,101,110,99,111,
+100,101,46,112,121,0,0,0,33,1,0,0,12,1,0,10,
+109,97,110,97,103,101,95,115,101,113,0,0,34,1,0,0,
+28,2,0,0,9,1,0,2,28,3,0,0,9,2,0,3,
+28,4,0,0,9,3,0,4,11,4,0,0,0,0,0,0,
+0,0,0,0,28,5,0,0,32,4,0,5,30,7,1,62,
+32,32,32,32,108,32,61,32,109,97,120,40,115,97,118,44,
+108,101,110,40,105,116,101,109,115,41,41,0,12,8,0,3,
+109,97,120,0,13,7,8,0,15,8,4,0,12,11,0,3,
+108,101,110,0,13,10,11,0,15,11,3,0,31,9,11,1,
+19,9,10,9,31,6,8,2,19,6,7,6,15,5,6,0,
+30,7,1,63,32,32,32,32,110,44,116,109,112,115,32,61,
+32,48,44,103,101,116,95,116,109,112,115,40,108,41,0,0,
+11,7,0,0,0,0,0,0,0,0,0,0,15,6,7,0,
+12,10,0,8,103,101,116,95,116,109,112,115,0,0,0,0,
+13,9,10,0,15,10,5,0,31,8,10,1,19,8,9,8,
+15,7,8,0,15,8,6,0,15,6,7,0,30,6,1,64,
+32,32,32,32,102,111,114,32,116,116,32,105,110,32,105,116,
+101,109,115,58,0,0,0,0,11,9,0,0,0,0,0,0,
+0,0,0,0,42,7,3,9,18,0,0,80,30,5,1,65,
+32,32,32,32,32,32,32,32,114,32,61,32,116,109,112,115,
+91,110,93,0,9,11,6,8,15,10,11,0,30,6,1,66,
+32,32,32,32,32,32,32,32,98,32,61,32,100,111,40,116,
+116,44,114,41,0,0,0,0,12,14,0,2,100,111,0,0,
+13,13,14,0,15,14,7,0,15,15,10,0,31,12,14,2,
+19,12,13,12,15,11,12,0,30,5,1,67,32,32,32,32,
+32,32,32,32,105,102,32,114,32,33,61,32,98,58,0,0,
+35,12,10,11,21,12,0,0,18,0,0,37,30,7,1,68,
+32,32,32,32,32,32,32,32,32,32,32,32,99,111,100,101,
+40,77,79,86,69,44,114,44,98,41,0,0,12,14,0,4,
+99,111,100,101,0,0,0,0,13,13,14,0,12,17,0,4,
+77,79,86,69,0,0,0,0,13,14,17,0,15,15,10,0,
+15,16,11,0,31,12,14,3,19,12,13,12,30,6,1,69,
+32,32,32,32,32,32,32,32,32,32,32,32,102,114,101,101,
+95,116,109,112,40,98,41,0,12,14,0,8,102,114,101,101,
+95,116,109,112,0,0,0,0,13,13,14,0,15,14,11,0,
+31,12,14,1,19,12,13,12,18,0,0,1,30,4,1,70,
+32,32,32,32,32,32,32,32,110,32,43,61,49,0,0,0,
+11,13,0,0,0,0,0,0,0,0,240,63,1,12,8,13,
+15,8,12,0,18,0,255,176,30,6,1,71,32,32,32,32,
+105,102,32,110,111,116,32,108,101,110,40,116,109,112,115,41,
+58,0,0,0,12,14,0,3,108,101,110,0,13,13,14,0,
+15,14,6,0,31,12,14,1,19,12,13,12,47,9,12,0,
+21,9,0,0,18,0,0,33,30,6,1,72,32,32,32,32,
+32,32,32,32,99,111,100,101,40,105,44,97,44,48,44,48,
+41,0,0,0,12,13,0,4,99,111,100,101,0,0,0,0,
+13,12,13,0,15,13,1,0,15,14,2,0,11,15,0,0,
+0,0,0,0,0,0,0,0,11,16,0,0,0,0,0,0,
+0,0,0,0,31,9,13,4,19,9,12,9,30,5,1,73,
+32,32,32,32,32,32,32,32,114,101,116,117,114,110,32,48,
+0,0,0,0,11,9,0,0,0,0,0,0,0,0,0,0,
+20,9,0,0,18,0,0,1,30,9,1,74,32,32,32,32,
+99,111,100,101,40,105,44,97,44,116,109,112,115,91,48,93,
+44,108,101,110,40,105,116,101,109,115,41,41,0,0,0,0,
+12,13,0,4,99,111,100,101,0,0,0,0,13,12,13,0,
+15,13,1,0,15,14,2,0,11,17,0,0,0,0,0,0,
+0,0,0,0,9,15,6,17,12,18,0,3,108,101,110,0,
+13,17,18,0,15,18,3,0,31,16,18,1,19,16,17,16,
+31,9,13,4,19,9,12,9,30,7,1,75,32,32,32,32,
+102,114,101,101,95,116,109,112,115,40,116,109,112,115,91,115,
+97,118,58,93,41,0,0,0,12,13,0,9,102,114,101,101,
+95,116,109,112,115,0,0,0,13,12,13,0,15,15,4,0,
+28,16,0,0,27,14,15,2,9,13,6,14,31,9,13,1,
+19,9,12,9,30,5,1,76,32,32,32,32,114,101,116,117,
+114,110,32,116,109,112,115,91,48,93,0,0,11,12,0,0,
+0,0,0,0,0,0,0,0,9,9,6,12,20,9,0,0,
+0,0,0,0,12,39,0,10,109,97,110,97,103,101,95,115,
+101,113,0,0,14,39,38,0,30,6,1,78,100,101,102,32,
+112,95,102,105,108,116,101,114,40,105,116,101,109,115,41,58,
+0,0,0,0,16,39,0,171,44,12,0,0,30,6,1,78,
+100,101,102,32,112,95,102,105,108,116,101,114,40,105,116,101,
+109,115,41,58,0,0,0,0,12,1,0,9,101,110,99,111,
+100,101,46,112,121,0,0,0,33,1,0,0,12,1,0,8,
+112,95,102,105,108,116,101,114,0,0,0,0,34,1,0,0,
+28,2,0,0,9,1,0,2,30,8,1,79,32,32,32,32,
+97,44,98,44,99,44,100,32,61,32,91,93,44,91,93,44,
+78,111,110,101,44,78,111,110,101,0,0,0,27,3,0,0,
+15,2,3,0,27,4,0,0,15,3,4,0,28,5,0,0,
+15,4,5,0,28,6,0,0,15,5,6,0,15,6,2,0,
+15,2,3,0,15,3,4,0,15,4,5,0,30,5,1,80,
+32,32,32,32,102,111,114,32,116,32,105,110,32,105,116,101,
+109,115,58,0,11,7,0,0,0,0,0,0,0,0,0,0,
+42,5,1,7,18,0,0,106,30,15,1,81,32,32,32,32,
+32,32,32,32,105,102,32,116,46,116,121,112,101,32,61,61,
+32,39,115,121,109,98,111,108,39,32,97,110,100,32,116,46,
+118,97,108,32,61,61,32,39,61,39,58,32,98,46,97,112,
+112,101,110,100,40,116,41,0,12,9,0,4,116,121,112,101,
+0,0,0,0,9,8,5,9,12,9,0,6,115,121,109,98,
+111,108,0,0,23,8,8,9,21,8,0,0,18,0,0,7,
+12,9,0,3,118,97,108,0,9,8,5,9,12,9,0,1,
+61,0,0,0,23,8,8,9,21,8,0,0,18,0,0,9,
+12,10,0,6,97,112,112,101,110,100,0,0,9,9,2,10,
+15,10,5,0,31,8,10,1,19,8,9,8,18,0,0,63,
+30,10,1,82,32,32,32,32,32,32,32,32,101,108,105,102,
+32,116,46,116,121,112,101,32,61,61,32,39,97,114,103,115,
+39,58,32,99,32,61,32,116,0,0,0,0,12,9,0,4,
+116,121,112,101,0,0,0,0,9,8,5,9,12,9,0,4,
+97,114,103,115,0,0,0,0,23,8,8,9,21,8,0,0,
+18,0,0,3,15,3,5,0,18,0,0,40,30,10,1,83,
+32,32,32,32,32,32,32,32,101,108,105,102,32,116,46,116,
+121,112,101,32,61,61,32,39,110,97,114,103,115,39,58,32,
+100,32,61,32,116,0,0,0,12,9,0,4,116,121,112,101,
+0,0,0,0,9,8,5,9,12,9,0,5,110,97,114,103,
+115,0,0,0,23,8,8,9,21,8,0,0,18,0,0,3,
+15,4,5,0,18,0,0,17,30,7,1,84,32,32,32,32,
+32,32,32,32,101,108,115,101,58,32,97,46,97,112,112,101,
+110,100,40,116,41,0,0,0,12,10,0,6,97,112,112,101,
+110,100,0,0,9,9,6,10,15,10,5,0,31,8,10,1,
+19,8,9,8,18,0,0,1,18,0,255,150,30,5,1,85,
+32,32,32,32,114,101,116,117,114,110,32,97,44,98,44,99,
+44,100,0,0,15,8,6,0,15,9,2,0,15,10,3,0,
+15,11,4,0,27,7,8,4,20,7,0,0,0,0,0,0,
+12,40,0,8,112,95,102,105,108,116,101,114,0,0,0,0,
+14,40,39,0,30,5,1,87,100,101,102,32,100,111,95,105,
+109,112,111,114,116,40,116,41,58,0,0,0,16,40,0,169,
+44,21,0,0,30,5,1,87,100,101,102,32,100,111,95,105,
+109,112,111,114,116,40,116,41,58,0,0,0,12,1,0,9,
+101,110,99,111,100,101,46,112,121,0,0,0,33,1,0,0,
+12,1,0,9,100,111,95,105,109,112,111,114,116,0,0,0,
+34,1,0,0,28,2,0,0,9,1,0,2,30,6,1,88,
+32,32,32,32,102,111,114,32,109,111,100,32,105,110,32,116,
+46,105,116,101,109,115,58,0,12,4,0,5,105,116,101,109,
+115,0,0,0,9,3,1,4,11,4,0,0,0,0,0,0,
+0,0,0,0,42,2,3,4,18,0,0,133,30,7,1,89,
+32,32,32,32,32,32,32,32,109,111,100,46,116,121,112,101,
+32,61,32,39,115,116,114,105,110,103,39,0,12,5,0,6,
+115,116,114,105,110,103,0,0,12,6,0,4,116,121,112,101,
+0,0,0,0,10,2,6,5,30,12,1,90,32,32,32,32,
+32,32,32,32,118,32,61,32,100,111,95,99,97,108,108,40,
+84,111,107,101,110,40,116,46,112,111,115,44,39,99,97,108,
+108,39,44,78,111,110,101,44,91,0,0,0,12,8,0,7,
+100,111,95,99,97,108,108,0,13,7,8,0,12,10,0,5,
+84,111,107,101,110,0,0,0,13,9,10,0,12,14,0,3,
+112,111,115,0,9,10,1,14,12,11,0,4,99,97,108,108,
+0,0,0,0,28,12,0,0,30,11,1,91,32,32,32,32,
+32,32,32,32,32,32,32,32,84,111,107,101,110,40,116,46,
+112,111,115,44,39,110,97,109,101,39,44,39,105,109,112,111,
+114,116,39,41,44,0,0,0,12,17,0,5,84,111,107,101,
+110,0,0,0,13,16,17,0,12,20,0,3,112,111,115,0,
+9,17,1,20,12,18,0,4,110,97,109,101,0,0,0,0,
+12,19,0,6,105,109,112,111,114,116,0,0,31,14,17,3,
+19,14,16,14,30,5,1,92,32,32,32,32,32,32,32,32,
+32,32,32,32,109,111,100,93,41,41,0,0,15,15,2,0,
+27,13,14,2,31,8,10,4,19,8,9,8,31,6,8,1,
+19,6,7,6,15,5,6,0,30,7,1,93,32,32,32,32,
+32,32,32,32,109,111,100,46,116,121,112,101,32,61,32,39,
+110,97,109,101,39,0,0,0,12,6,0,4,110,97,109,101,
+0,0,0,0,12,7,0,4,116,121,112,101,0,0,0,0,
+10,2,7,6,30,12,1,94,32,32,32,32,32,32,32,32,
+100,111,95,115,101,116,95,99,116,120,40,109,111,100,44,84,
+111,107,101,110,40,116,46,112,111,115,44,39,114,101,103,39,
+44,118,41,41,0,0,0,0,12,8,0,10,100,111,95,115,
+101,116,95,99,116,120,0,0,13,7,8,0,15,8,2,0,
+12,11,0,5,84,111,107,101,110,0,0,0,13,10,11,0,
+12,14,0,3,112,111,115,0,9,11,1,14,12,12,0,3,
+114,101,103,0,15,13,5,0,31,9,11,3,19,9,10,9,
+31,6,8,2,19,6,7,6,18,0,255,123,0,0,0,0,
+12,41,0,9,100,111,95,105,109,112,111,114,116,0,0,0,
+14,41,40,0,30,4,1,95,100,101,102,32,100,111,95,102,
+114,111,109,40,116,41,58,0,16,41,1,144,44,23,0,0,
+30,4,1,95,100,101,102,32,100,111,95,102,114,111,109,40,
+116,41,58,0,12,1,0,9,101,110,99,111,100,101,46,112,
+121,0,0,0,33,1,0,0,12,1,0,7,100,111,95,102,
+114,111,109,0,34,1,0,0,28,2,0,0,9,1,0,2,
+30,6,1,96,32,32,32,32,109,111,100,32,61,32,116,46,
+105,116,101,109,115,91,48,93,0,0,0,0,12,4,0,5,
+105,116,101,109,115,0,0,0,9,3,1,4,11,4,0,0,
+0,0,0,0,0,0,0,0,9,3,3,4,15,2,3,0,
+30,6,1,97,32,32,32,32,109,111,100,46,116,121,112,101,
+32,61,32,39,115,116,114,105,110,103,39,0,12,3,0,6,
+115,116,114,105,110,103,0,0,12,4,0,4,116,121,112,101,
+0,0,0,0,10,2,4,3,30,10,1,98,32,32,32,32,
+118,32,61,32,100,111,40,84,111,107,101,110,40,116,46,112,
+111,115,44,39,99,97,108,108,39,44,78,111,110,101,44,91,
+0,0,0,0,12,6,0,2,100,111,0,0,13,5,6,0,
+12,8,0,5,84,111,107,101,110,0,0,0,13,7,8,0,
+12,12,0,3,112,111,115,0,9,8,1,12,12,9,0,4,
+99,97,108,108,0,0,0,0,28,10,0,0,30,10,1,99,
+32,32,32,32,32,32,32,32,84,111,107,101,110,40,116,46,
+112,111,115,44,39,110,97,109,101,39,44,39,105,109,112,111,
+114,116,39,41,44,0,0,0,12,15,0,5,84,111,107,101,
+110,0,0,0,13,14,15,0,12,18,0,3,112,111,115,0,
+9,15,1,18,12,16,0,4,110,97,109,101,0,0,0,0,
+12,17,0,6,105,109,112,111,114,116,0,0,31,12,15,3,
+19,12,14,12,30,4,1,100,32,32,32,32,32,32,32,32,
+109,111,100,93,41,41,0,0,15,13,2,0,27,11,12,2,
+31,6,8,4,19,6,7,6,31,4,6,1,19,4,5,4,
+15,3,4,0,30,6,1,101,32,32,32,32,105,116,101,109,
+32,61,32,116,46,105,116,101,109,115,91,49,93,0,0,0,
+12,6,0,5,105,116,101,109,115,0,0,0,9,5,1,6,
+11,6,0,0,0,0,0,0,0,0,240,63,9,5,5,6,
+15,4,5,0,30,6,1,102,32,32,32,32,105,102,32,105,
+116,101,109,46,118,97,108,32,61,61,32,39,42,39,58,0,
+12,6,0,3,118,97,108,0,9,5,4,6,12,6,0,1,
+42,0,0,0,23,5,5,6,21,5,0,0,18,0,0,120,
+30,12,1,103,32,32,32,32,32,32,32,32,102,114,101,101,
+95,116,109,112,40,100,111,40,84,111,107,101,110,40,116,46,
+112,111,115,44,39,99,97,108,108,39,44,78,111,110,101,44,
+91,0,0,0,12,7,0,8,102,114,101,101,95,116,109,112,
+0,0,0,0,13,6,7,0,12,9,0,2,100,111,0,0,
+13,8,9,0,12,11,0,5,84,111,107,101,110,0,0,0,
+13,10,11,0,12,15,0,3,112,111,115,0,9,11,1,15,
+12,12,0,4,99,97,108,108,0,0,0,0,28,13,0,0,
+30,11,1,104,32,32,32,32,32,32,32,32,32,32,32,32,
+84,111,107,101,110,40,116,46,112,111,115,44,39,110,97,109,
+101,39,44,39,109,101,114,103,101,39,41,44,0,0,0,0,
+12,19,0,5,84,111,107,101,110,0,0,0,13,18,19,0,
+12,22,0,3,112,111,115,0,9,19,1,22,12,20,0,4,
+110,97,109,101,0,0,0,0,12,21,0,5,109,101,114,103,
+101,0,0,0,31,15,19,3,19,15,18,15,30,11,1,105,
+32,32,32,32,32,32,32,32,32,32,32,32,84,111,107,101,
+110,40,116,46,112,111,115,44,39,110,97,109,101,39,44,39,
+95,95,100,105,99,116,95,95,39,41,44,0,12,19,0,5,
+84,111,107,101,110,0,0,0,13,18,19,0,12,22,0,3,
+112,111,115,0,9,19,1,22,12,20,0,4,110,97,109,101,
+0,0,0,0,12,21,0,8,95,95,100,105,99,116,95,95,
+0,0,0,0,31,16,19,3,19,16,18,16,30,11,1,106,
+32,32,32,32,32,32,32,32,32,32,32,32,84,111,107,101,
+110,40,116,46,112,111,115,44,39,114,101,103,39,44,118,41,
+93,41,41,41,32,35,82,69,71,0,0,0,12,19,0,5,
+84,111,107,101,110,0,0,0,13,18,19,0,12,22,0,3,
+112,111,115,0,9,19,1,22,12,20,0,3,114,101,103,0,
+15,21,3,0,31,17,19,3,19,17,18,17,27,14,15,3,
+31,9,11,4,19,9,10,9,31,7,9,1,19,7,8,7,
+31,5,7,1,19,5,6,5,18,0,0,139,30,3,1,107,
+32,32,32,32,101,108,115,101,58,0,0,0,30,8,1,108,
+32,32,32,32,32,32,32,32,105,116,101,109,46,116,121,112,
+101,32,61,32,39,115,116,114,105,110,103,39,0,0,0,0,
+12,5,0,6,115,116,114,105,110,103,0,0,12,6,0,4,
+116,121,112,101,0,0,0,0,10,4,6,5,30,8,1,109,
+32,32,32,32,32,32,32,32,102,114,101,101,95,116,109,112,
+40,100,111,95,115,101,116,95,99,116,120,40,0,0,0,0,
+12,7,0,8,102,114,101,101,95,116,109,112,0,0,0,0,
+13,6,7,0,12,9,0,10,100,111,95,115,101,116,95,99,
+116,120,0,0,13,8,9,0,30,19,1,110,32,32,32,32,
+32,32,32,32,32,32,32,32,84,111,107,101,110,40,116,46,
+112,111,115,44,39,103,101,116,39,44,78,111,110,101,44,91,
+32,84,111,107,101,110,40,116,46,112,111,115,44,39,110,97,
+109,101,39,44,39,95,95,100,105,99,116,95,95,39,41,44,
+105,116,101,109,93,41,44,0,12,12,0,5,84,111,107,101,
+110,0,0,0,13,11,12,0,12,16,0,3,112,111,115,0,
+9,12,1,16,12,13,0,3,103,101,116,0,28,14,0,0,
+12,19,0,5,84,111,107,101,110,0,0,0,13,18,19,0,
+12,22,0,3,112,111,115,0,9,19,1,22,12,20,0,4,
+110,97,109,101,0,0,0,0,12,21,0,8,95,95,100,105,
+99,116,95,95,0,0,0,0,31,16,19,3,19,16,18,16,
+15,17,4,0,27,15,16,2,31,9,12,4,19,9,11,9,
+30,17,1,111,32,32,32,32,32,32,32,32,32,32,32,32,
+84,111,107,101,110,40,116,46,112,111,115,44,39,103,101,116,
+39,44,78,111,110,101,44,91,32,84,111,107,101,110,40,116,
+46,112,111,115,44,39,114,101,103,39,44,118,41,44,105,116,
+101,109,93,41,0,0,0,0,12,12,0,5,84,111,107,101,
+110,0,0,0,13,11,12,0,12,16,0,3,112,111,115,0,
+9,12,1,16,12,13,0,3,103,101,116,0,28,14,0,0,
+12,19,0,5,84,111,107,101,110,0,0,0,13,18,19,0,
+12,22,0,3,112,111,115,0,9,19,1,22,12,20,0,3,
+114,101,103,0,15,21,3,0,31,16,19,3,19,16,18,16,
+15,17,4,0,27,15,16,2,31,10,12,4,19,10,11,10,
+31,7,9,2,19,7,8,7,31,5,7,1,19,5,6,5,
+18,0,0,1,0,0,0,0,12,42,0,7,100,111,95,102,
+114,111,109,0,14,42,41,0,30,5,1,115,100,101,102,32,
+100,111,95,103,108,111,98,97,108,115,40,116,41,58,0,0,
+16,42,0,92,44,8,0,0,30,5,1,115,100,101,102,32,
+100,111,95,103,108,111,98,97,108,115,40,116,41,58,0,0,
+12,1,0,9,101,110,99,111,100,101,46,112,121,0,0,0,
+33,1,0,0,12,1,0,10,100,111,95,103,108,111,98,97,
+108,115,0,0,34,1,0,0,28,2,0,0,9,1,0,2,
+30,6,1,116,32,32,32,32,102,111,114,32,116,32,105,110,
+32,116,46,105,116,101,109,115,58,0,0,0,12,3,0,5,
+105,116,101,109,115,0,0,0,9,2,1,3,11,3,0,0,
+0,0,0,0,0,0,0,0,42,1,2,3,18,0,0,56,
+30,9,1,117,32,32,32,32,32,32,32,32,105,102,32,116,
+46,118,97,108,32,110,111,116,32,105,110,32,68,46,103,108,
+111,98,97,108,115,58,0,0,12,5,0,1,68,0,0,0,
+13,4,5,0,12,5,0,7,103,108,111,98,97,108,115,0,
+9,4,4,5,12,6,0,3,118,97,108,0,9,5,1,6,
+36,4,4,5,11,5,0,0,0,0,0,0,0,0,0,0,
+23,4,4,5,21,4,0,0,18,0,0,28,30,9,1,118,
+32,32,32,32,32,32,32,32,32,32,32,32,68,46,103,108,
+111,98,97,108,115,46,97,112,112,101,110,100,40,116,46,118,
+97,108,41,0,12,6,0,1,68,0,0,0,13,5,6,0,
+12,6,0,7,103,108,111,98,97,108,115,0,9,5,5,6,
+12,6,0,6,97,112,112,101,110,100,0,0,9,5,5,6,
+12,7,0,3,118,97,108,0,9,6,1,7,31,4,6,1,
+19,4,5,4,18,0,0,1,18,0,255,200,0,0,0,0,
+12,43,0,10,100,111,95,103,108,111,98,97,108,115,0,0,
+14,43,42,0,30,4,1,119,100,101,102,32,100,111,95,100,
+101,108,40,116,116,41,58,0,16,43,0,125,44,13,0,0,
+30,4,1,119,100,101,102,32,100,111,95,100,101,108,40,116,
+116,41,58,0,12,1,0,9,101,110,99,111,100,101,46,112,
+121,0,0,0,33,1,0,0,12,1,0,6,100,111,95,100,
+101,108,0,0,34,1,0,0,28,2,0,0,9,1,0,2,
+30,6,1,120,32,32,32,32,102,111,114,32,116,32,105,110,
+32,116,116,46,105,116,101,109,115,58,0,0,12,4,0,5,
+105,116,101,109,115,0,0,0,9,3,1,4,11,4,0,0,
+0,0,0,0,0,0,0,0,42,2,3,4,18,0,0,91,
+30,7,1,121,32,32,32,32,32,32,32,32,114,32,61,32,
+100,111,40,116,46,105,116,101,109,115,91,48,93,41,0,0,
+12,8,0,2,100,111,0,0,13,7,8,0,12,9,0,5,
+105,116,101,109,115,0,0,0,9,8,2,9,11,9,0,0,
+0,0,0,0,0,0,0,0,9,8,8,9,31,6,8,1,
+19,6,7,6,15,5,6,0,30,7,1,122,32,32,32,32,
+32,32,32,32,114,50,32,61,32,100,111,40,116,46,105,116,
+101,109,115,91,49,93,41,0,12,9,0,2,100,111,0,0,
+13,8,9,0,12,10,0,5,105,116,101,109,115,0,0,0,
+9,9,2,10,11,10,0,0,0,0,0,0,0,0,240,63,
+9,9,9,10,31,7,9,1,19,7,8,7,15,6,7,0,
+30,6,1,123,32,32,32,32,32,32,32,32,99,111,100,101,
+40,68,69,76,44,114,44,114,50,41,0,0,12,9,0,4,
+99,111,100,101,0,0,0,0,13,8,9,0,12,12,0,3,
+68,69,76,0,13,9,12,0,15,10,5,0,15,11,6,0,
+31,7,9,3,19,7,8,7,30,10,1,124,32,32,32,32,
+32,32,32,32,102,114,101,101,95,116,109,112,40,114,41,59,
+32,102,114,101,101,95,116,109,112,40,114,50,41,32,35,82,
+69,71,0,0,12,9,0,8,102,114,101,101,95,116,109,112,
+0,0,0,0,13,8,9,0,15,9,5,0,31,7,9,1,
+19,7,8,7,12,9,0,8,102,114,101,101,95,116,109,112,
+0,0,0,0,13,8,9,0,15,9,6,0,31,7,9,1,
+19,7,8,7,18,0,255,165,0,0,0,0,12,44,0,6,
+100,111,95,100,101,108,0,0,14,44,43,0,30,6,1,126,
+100,101,102,32,100,111,95,99,97,108,108,40,116,44,114,61,
+78,111,110,101,41,58,0,0,16,44,2,124,44,31,0,0,
+30,6,1,126,100,101,102,32,100,111,95,99,97,108,108,40,
+116,44,114,61,78,111,110,101,41,58,0,0,12,1,0,9,
+101,110,99,111,100,101,46,112,121,0,0,0,33,1,0,0,
+12,1,0,7,100,111,95,99,97,108,108,0,34,1,0,0,
+28,2,0,0,9,1,0,2,28,2,0,0,28,3,0,0,
+32,2,0,3,30,5,1,127,32,32,32,32,114,32,61,32,
+103,101,116,95,116,109,112,40,114,41,0,0,12,5,0,7,
+103,101,116,95,116,109,112,0,13,4,5,0,15,5,2,0,
+31,3,5,1,19,3,4,3,15,2,3,0,30,5,1,128,
+32,32,32,32,105,116,101,109,115,32,61,32,116,46,105,116,
+101,109,115,0,12,5,0,5,105,116,101,109,115,0,0,0,
+9,4,1,5,15,3,4,0,30,6,1,129,32,32,32,32,
+102,110,99,32,61,32,100,111,40,105,116,101,109,115,91,48,
+93,41,0,0,12,7,0,2,100,111,0,0,13,6,7,0,
+11,8,0,0,0,0,0,0,0,0,0,0,9,7,3,8,
+31,5,7,1,19,5,6,5,15,4,5,0,30,9,1,130,
+32,32,32,32,97,44,98,44,99,44,100,32,61,32,112,95,
+102,105,108,116,101,114,40,116,46,105,116,101,109,115,91,49,
+58,93,41,0,12,7,0,8,112,95,102,105,108,116,101,114,
+0,0,0,0,13,6,7,0,12,8,0,5,105,116,101,109,
+115,0,0,0,9,7,1,8,11,9,0,0,0,0,0,0,
+0,0,240,63,28,10,0,0,27,8,9,2,9,7,7,8,
+31,5,7,1,19,5,6,5,11,8,0,0,0,0,0,0,
+0,0,0,0,9,7,5,8,15,6,7,0,11,9,0,0,
+0,0,0,0,0,0,240,63,9,8,5,9,15,7,8,0,
+11,10,0,0,0,0,0,0,0,0,0,64,9,9,5,10,
+15,8,9,0,11,11,0,0,0,0,0,0,0,0,8,64,
+9,10,5,11,15,9,10,0,30,4,1,131,32,32,32,32,
+101,32,61,32,78,111,110,101,0,0,0,0,28,10,0,0,
+15,5,10,0,30,9,1,132,32,32,32,32,105,102,32,108,
+101,110,40,98,41,32,33,61,32,48,32,111,114,32,100,32,
+33,61,32,78,111,110,101,58,0,0,0,0,12,12,0,3,
+108,101,110,0,13,11,12,0,15,12,7,0,31,10,12,1,
+19,10,11,10,11,11,0,0,0,0,0,0,0,0,0,0,
+35,10,10,11,46,10,0,0,18,0,0,3,28,11,0,0,
+35,10,9,11,21,10,0,0,18,0,1,14,30,14,1,133,
+32,32,32,32,32,32,32,32,101,32,61,32,100,111,40,84,
+111,107,101,110,40,116,46,112,111,115,44,39,100,105,99,116,
+39,44,78,111,110,101,44,91,93,41,41,59,32,117,110,95,
+116,109,112,40,101,41,59,0,12,12,0,2,100,111,0,0,
+13,11,12,0,12,14,0,5,84,111,107,101,110,0,0,0,
+13,13,14,0,12,18,0,3,112,111,115,0,9,14,1,18,
+12,15,0,4,100,105,99,116,0,0,0,0,28,16,0,0,
+27,17,0,0,31,12,14,4,19,12,13,12,31,10,12,1,
+19,10,11,10,15,5,10,0,12,12,0,6,117,110,95,116,
+109,112,0,0,13,11,12,0,15,12,5,0,31,10,12,1,
+19,10,11,10,30,5,1,134,32,32,32,32,32,32,32,32,
+102,111,114,32,112,32,105,110,32,98,58,0,11,11,0,0,
+0,0,0,0,0,0,0,0,42,10,7,11,18,0,0,121,
+30,10,1,135,32,32,32,32,32,32,32,32,32,32,32,32,
+112,46,105,116,101,109,115,91,48,93,46,116,121,112,101,32,
+61,32,39,115,116,114,105,110,103,39,0,0,12,13,0,5,
+105,116,101,109,115,0,0,0,9,12,10,13,11,13,0,0,
+0,0,0,0,0,0,0,0,9,12,12,13,12,13,0,6,
+115,116,114,105,110,103,0,0,12,14,0,4,116,121,112,101,
+0,0,0,0,10,12,14,13,30,13,1,136,32,32,32,32,
+32,32,32,32,32,32,32,32,116,49,44,116,50,32,61,32,
+100,111,40,112,46,105,116,101,109,115,91,48,93,41,44,100,
+111,40,112,46,105,116,101,109,115,91,49,93,41,0,0,0,
+12,15,0,2,100,111,0,0,13,14,15,0,12,16,0,5,
+105,116,101,109,115,0,0,0,9,15,10,16,11,16,0,0,
+0,0,0,0,0,0,0,0,9,15,15,16,31,13,15,1,
+19,13,14,13,15,12,13,0,12,16,0,2,100,111,0,0,
+13,15,16,0,12,17,0,5,105,116,101,109,115,0,0,0,
+9,16,10,17,11,17,0,0,0,0,0,0,0,0,240,63,
+9,16,16,17,31,14,16,1,19,14,15,14,15,13,14,0,
+15,14,12,0,15,12,13,0,30,8,1,137,32,32,32,32,
+32,32,32,32,32,32,32,32,99,111,100,101,40,83,69,84,
+44,101,44,116,49,44,116,50,41,0,0,0,12,16,0,4,
+99,111,100,101,0,0,0,0,13,15,16,0,12,20,0,3,
+83,69,84,0,13,16,20,0,15,17,5,0,15,18,14,0,
+15,19,12,0,31,13,16,4,19,13,15,13,30,11,1,138,
+32,32,32,32,32,32,32,32,32,32,32,32,102,114,101,101,
+95,116,109,112,40,116,49,41,59,32,102,114,101,101,95,116,
+109,112,40,116,50,41,32,35,82,69,71,0,12,16,0,8,
+102,114,101,101,95,116,109,112,0,0,0,0,13,15,16,0,
+15,16,14,0,31,13,16,1,19,13,15,13,12,16,0,8,
+102,114,101,101,95,116,109,112,0,0,0,0,13,15,16,0,
+15,16,12,0,31,13,16,1,19,13,15,13,18,0,255,135,
+30,30,1,139,32,32,32,32,32,32,32,32,105,102,32,100,
+58,32,102,114,101,101,95,116,109,112,40,100,111,40,84,111,
+107,101,110,40,116,46,112,111,115,44,39,99,97,108,108,39,
+44,78,111,110,101,44,91,84,111,107,101,110,40,116,46,112,
+111,115,44,39,110,97,109,101,39,44,39,109,101,114,103,101,
+39,41,44,84,111,107,101,110,40,116,46,112,111,115,44,39,
+114,101,103,39,44,101,41,44,100,46,105,116,101,109,115,91,
+48,93,93,41,41,41,32,35,82,69,71,0,21,9,0,0,
+18,0,0,63,12,15,0,8,102,114,101,101,95,116,109,112,
+0,0,0,0,13,13,15,0,12,17,0,2,100,111,0,0,
+13,16,17,0,12,19,0,5,84,111,107,101,110,0,0,0,
+13,18,19,0,12,23,0,3,112,111,115,0,9,19,1,23,
+12,20,0,4,99,97,108,108,0,0,0,0,28,21,0,0,
+12,27,0,5,84,111,107,101,110,0,0,0,13,26,27,0,
+12,30,0,3,112,111,115,0,9,27,1,30,12,28,0,4,
+110,97,109,101,0,0,0,0,12,29,0,5,109,101,114,103,
+101,0,0,0,31,23,27,3,19,23,26,23,12,27,0,5,
+84,111,107,101,110,0,0,0,13,26,27,0,12,30,0,3,
+112,111,115,0,9,27,1,30,12,28,0,3,114,101,103,0,
+15,29,5,0,31,24,27,3,19,24,26,24,12,26,0,5,
+105,116,101,109,115,0,0,0,9,25,9,26,11,26,0,0,
+0,0,0,0,0,0,0,0,9,25,25,26,27,22,23,3,
+31,17,19,4,19,17,18,17,31,15,17,1,19,15,16,15,
+31,11,15,1,19,11,13,11,18,0,0,1,18,0,0,1,
+30,7,1,140,32,32,32,32,109,97,110,97,103,101,95,115,
+101,113,40,80,65,82,65,77,83,44,114,44,97,41,0,0,
+12,15,0,10,109,97,110,97,103,101,95,115,101,113,0,0,
+13,13,15,0,12,18,0,6,80,65,82,65,77,83,0,0,
+13,15,18,0,15,16,2,0,15,17,6,0,31,11,15,3,
+19,11,13,11,30,5,1,141,32,32,32,32,105,102,32,99,
+32,33,61,32,78,111,110,101,58,0,0,0,28,13,0,0,
+35,11,8,13,21,11,0,0,18,0,0,88,30,12,1,142,
+32,32,32,32,32,32,32,32,116,49,44,116,50,32,61,32,
+95,100,111,95,115,116,114,105,110,103,40,39,42,39,41,44,
+100,111,40,99,46,105,116,101,109,115,91,48,93,41,0,0,
+12,16,0,10,95,100,111,95,115,116,114,105,110,103,0,0,
+13,15,16,0,12,16,0,1,42,0,0,0,31,13,16,1,
+19,13,15,13,15,11,13,0,12,17,0,2,100,111,0,0,
+13,16,17,0,12,18,0,5,105,116,101,109,115,0,0,0,
+9,17,8,18,11,18,0,0,0,0,0,0,0,0,0,0,
+9,17,17,18,31,15,17,1,19,15,16,15,15,13,15,0,
+15,14,11,0,15,12,13,0,30,7,1,143,32,32,32,32,
+32,32,32,32,99,111,100,101,40,83,69,84,44,114,44,116,
+49,44,116,50,41,0,0,0,12,15,0,4,99,111,100,101,
+0,0,0,0,13,13,15,0,12,19,0,3,83,69,84,0,
+13,15,19,0,15,16,2,0,15,17,14,0,15,18,12,0,
+31,11,15,4,19,11,13,11,30,10,1,144,32,32,32,32,
+32,32,32,32,102,114,101,101,95,116,109,112,40,116,49,41,
+59,32,102,114,101,101,95,116,109,112,40,116,50,41,32,35,
+82,69,71,0,12,15,0,8,102,114,101,101,95,116,109,112,
+0,0,0,0,13,13,15,0,15,15,14,0,31,11,15,1,
+19,11,13,11,12,15,0,8,102,114,101,101,95,116,109,112,
+0,0,0,0,13,13,15,0,15,15,12,0,31,11,15,1,
+19,11,13,11,18,0,0,1,30,5,1,145,32,32,32,32,
+105,102,32,101,32,33,61,32,78,111,110,101,58,0,0,0,
+28,13,0,0,35,11,5,13,21,11,0,0,18,0,0,53,
+30,6,1,146,32,32,32,32,32,32,32,32,116,49,32,61,
+32,95,100,111,95,110,111,110,101,40,41,0,12,15,0,8,
+95,100,111,95,110,111,110,101,0,0,0,0,13,13,15,0,
+31,11,0,0,19,11,13,11,15,14,11,0,30,7,1,147,
+32,32,32,32,32,32,32,32,99,111,100,101,40,83,69,84,
+44,114,44,116,49,44,101,41,0,0,0,0,12,15,0,4,
+99,111,100,101,0,0,0,0,13,13,15,0,12,19,0,3,
+83,69,84,0,13,15,19,0,15,16,2,0,15,17,14,0,
+15,18,5,0,31,11,15,4,19,11,13,11,30,7,1,148,
+32,32,32,32,32,32,32,32,102,114,101,101,95,116,109,112,
+40,116,49,41,32,35,82,69,71,0,0,0,12,15,0,8,
+102,114,101,101,95,116,109,112,0,0,0,0,13,13,15,0,
+15,15,14,0,31,11,15,1,19,11,13,11,18,0,0,1,
+30,6,1,149,32,32,32,32,99,111,100,101,40,67,65,76,
+76,44,114,44,102,110,99,44,114,41,0,0,12,15,0,4,
+99,111,100,101,0,0,0,0,13,13,15,0,12,19,0,4,
+67,65,76,76,0,0,0,0,13,15,19,0,15,16,2,0,
+15,17,4,0,15,18,2,0,31,11,15,4,19,11,13,11,
+30,6,1,150,32,32,32,32,102,114,101,101,95,116,109,112,
+40,102,110,99,41,32,35,82,69,71,0,0,12,15,0,8,
+102,114,101,101,95,116,109,112,0,0,0,0,13,13,15,0,
+15,15,4,0,31,11,15,1,19,11,13,11,30,4,1,151,
+32,32,32,32,114,101,116,117,114,110,32,114,0,0,0,0,
+20,2,0,0,0,0,0,0,12,45,0,7,100,111,95,99,
+97,108,108,0,14,45,44,0,30,6,1,153,100,101,102,32,
+100,111,95,110,97,109,101,40,116,44,114,61,78,111,110,101,
+41,58,0,0,16,45,0,186,44,10,0,0,30,6,1,153,
+100,101,102,32,100,111,95,110,97,109,101,40,116,44,114,61,
+78,111,110,101,41,58,0,0,12,1,0,9,101,110,99,111,
+100,101,46,112,121,0,0,0,33,1,0,0,12,1,0,7,
+100,111,95,110,97,109,101,0,34,1,0,0,28,2,0,0,
+9,1,0,2,28,2,0,0,28,3,0,0,32,2,0,3,
+30,6,1,154,32,32,32,32,105,102,32,116,46,118,97,108,
+32,105,110,32,68,46,118,97,114,115,58,0,12,4,0,1,
+68,0,0,0,13,3,4,0,12,4,0,4,118,97,114,115,
+0,0,0,0,9,3,3,4,12,5,0,3,118,97,108,0,
+9,4,1,5,36,3,3,4,21,3,0,0,18,0,0,21,
+30,8,1,155,32,32,32,32,32,32,32,32,114,101,116,117,
+114,110,32,100,111,95,108,111,99,97,108,40,116,44,114,41,
+0,0,0,0,12,5,0,8,100,111,95,108,111,99,97,108,
+0,0,0,0,13,4,5,0,15,5,1,0,15,6,2,0,
+31,3,5,2,19,3,4,3,20,3,0,0,18,0,0,1,
+30,8,1,156,32,32,32,32,105,102,32,116,46,118,97,108,
+32,110,111,116,32,105,110,32,68,46,114,103,108,111,98,97,
+108,115,58,0,12,4,0,1,68,0,0,0,13,3,4,0,
+12,4,0,8,114,103,108,111,98,97,108,115,0,0,0,0,
+9,3,3,4,12,5,0,3,118,97,108,0,9,4,1,5,
+36,3,3,4,11,4,0,0,0,0,0,0,0,0,0,0,
+23,3,3,4,21,3,0,0,18,0,0,29,30,9,1,157,
+32,32,32,32,32,32,32,32,68,46,114,103,108,111,98,97,
+108,115,46,97,112,112,101,110,100,40,116,46,118,97,108,41,
+0,0,0,0,12,5,0,1,68,0,0,0,13,4,5,0,
+12,5,0,8,114,103,108,111,98,97,108,115,0,0,0,0,
+9,4,4,5,12,5,0,6,97,112,112,101,110,100,0,0,
+9,4,4,5,12,6,0,3,118,97,108,0,9,5,1,6,
+31,3,5,1,19,3,4,3,18,0,0,1,30,5,1,158,
+32,32,32,32,114,32,61,32,103,101,116,95,116,109,112,40,
+114,41,0,0,12,5,0,7,103,101,116,95,116,109,112,0,
+13,4,5,0,15,5,2,0,31,3,5,1,19,3,4,3,
+15,2,3,0,30,6,1,159,32,32,32,32,99,32,61,32,
+100,111,95,115,116,114,105,110,103,40,116,41,0,0,0,0,
+12,6,0,9,100,111,95,115,116,114,105,110,103,0,0,0,
+13,5,6,0,15,6,1,0,31,4,6,1,19,4,5,4,
+15,3,4,0,30,5,1,160,32,32,32,32,99,111,100,101,
+40,71,71,69,84,44,114,44,99,41,0,0,12,6,0,4,
+99,111,100,101,0,0,0,0,13,5,6,0,12,9,0,4,
+71,71,69,84,0,0,0,0,13,6,9,0,15,7,2,0,
+15,8,3,0,31,4,6,3,19,4,5,4,30,4,1,161,
+32,32,32,32,102,114,101,101,95,116,109,112,40,99,41,0,
+12,6,0,8,102,114,101,101,95,116,109,112,0,0,0,0,
+13,5,6,0,15,6,3,0,31,4,6,1,19,4,5,4,
+30,4,1,162,32,32,32,32,114,101,116,117,114,110,32,114,
+0,0,0,0,20,2,0,0,0,0,0,0,12,46,0,7,
+100,111,95,110,97,109,101,0,14,46,45,0,30,6,1,164,
+100,101,102,32,100,111,95,108,111,99,97,108,40,116,44,114,
+61,78,111,110,101,41,58,0,16,46,0,177,44,9,0,0,
+30,6,1,164,100,101,102,32,100,111,95,108,111,99,97,108,
+40,116,44,114,61,78,111,110,101,41,58,0,12,1,0,9,
+101,110,99,111,100,101,46,112,121,0,0,0,33,1,0,0,
+12,1,0,8,100,111,95,108,111,99,97,108,0,0,0,0,
+34,1,0,0,28,2,0,0,9,1,0,2,28,2,0,0,
+28,3,0,0,32,2,0,3,30,7,1,165,32,32,32,32,
+105,102,32,116,46,118,97,108,32,105,110,32,68,46,114,103,
+108,111,98,97,108,115,58,0,12,4,0,1,68,0,0,0,
+13,3,4,0,12,4,0,8,114,103,108,111,98,97,108,115,
+0,0,0,0,9,3,3,4,12,5,0,3,118,97,108,0,
+9,4,1,5,36,3,3,4,21,3,0,0,18,0,0,62,
+30,6,1,166,32,32,32,32,32,32,32,32,68,46,101,114,
+114,111,114,32,61,32,84,114,117,101,0,0,12,4,0,1,
+68,0,0,0,13,3,4,0,11,4,0,0,0,0,0,0,
+0,0,240,63,12,5,0,5,101,114,114,111,114,0,0,0,
+10,3,5,4,30,15,1,167,32,32,32,32,32,32,32,32,
+116,111,107,101,110,105,122,101,46,117,95,101,114,114,111,114,
+40,39,85,110,98,111,117,110,100,76,111,99,97,108,69,114,
+114,111,114,39,44,68,46,99,111,100,101,44,116,46,112,111,
+115,41,0,0,12,5,0,8,116,111,107,101,110,105,122,101,
+0,0,0,0,13,4,5,0,12,5,0,7,117,95,101,114,
+114,111,114,0,9,4,4,5,12,5,0,17,85,110,98,111,
+117,110,100,76,111,99,97,108,69,114,114,111,114,0,0,0,
+12,8,0,1,68,0,0,0,13,6,8,0,12,8,0,4,
+99,111,100,101,0,0,0,0,9,6,6,8,12,8,0,3,
+112,111,115,0,9,7,1,8,31,3,5,3,19,3,4,3,
+18,0,0,1,30,7,1,168,32,32,32,32,105,102,32,116,
+46,118,97,108,32,110,111,116,32,105,110,32,68,46,118,97,
+114,115,58,0,12,4,0,1,68,0,0,0,13,3,4,0,
+12,4,0,4,118,97,114,115,0,0,0,0,9,3,3,4,
+12,5,0,3,118,97,108,0,9,4,1,5,36,3,3,4,
+11,4,0,0,0,0,0,0,0,0,0,0,23,3,3,4,
+21,3,0,0,18,0,0,27,30,8,1,169,32,32,32,32,
+32,32,32,32,68,46,118,97,114,115,46,97,112,112,101,110,
+100,40,116,46,118,97,108,41,0,0,0,0,12,5,0,1,
+68,0,0,0,13,4,5,0,12,5,0,4,118,97,114,115,
+0,0,0,0,9,4,4,5,12,5,0,6,97,112,112,101,
+110,100,0,0,9,4,4,5,12,6,0,3,118,97,108,0,
+9,5,1,6,31,3,5,1,19,3,4,3,18,0,0,1,
+30,7,1,170,32,32,32,32,114,101,116,117,114,110,32,103,
+101,116,95,114,101,103,40,116,46,118,97,108,41,0,0,0,
+12,5,0,7,103,101,116,95,114,101,103,0,13,4,5,0,
+12,6,0,3,118,97,108,0,9,5,1,6,31,3,5,1,
+19,3,4,3,20,3,0,0,0,0,0,0,12,47,0,8,
+100,111,95,108,111,99,97,108,0,0,0,0,14,47,46,0,
+30,7,1,172,100,101,102,32,100,111,95,100,101,102,40,116,
+111,107,44,107,108,115,61,78,111,110,101,41,58,0,0,0,
+16,47,3,64,44,25,0,0,30,7,1,172,100,101,102,32,
+100,111,95,100,101,102,40,116,111,107,44,107,108,115,61,78,
+111,110,101,41,58,0,0,0,12,1,0,9,101,110,99,111,
+100,101,46,112,121,0,0,0,33,1,0,0,12,1,0,6,
+100,111,95,100,101,102,0,0,34,1,0,0,28,2,0,0,
+9,1,0,2,28,2,0,0,28,3,0,0,32,2,0,3,
+30,6,1,173,32,32,32,32,105,116,101,109,115,32,61,32,
+116,111,107,46,105,116,101,109,115,0,0,0,12,5,0,5,
+105,116,101,109,115,0,0,0,9,4,1,5,15,3,4,0,
+30,5,1,175,32,32,32,32,116,32,61,32,103,101,116,95,
+116,97,103,40,41,0,0,0,12,7,0,7,103,101,116,95,
+116,97,103,0,13,6,7,0,31,5,0,0,19,5,6,5,
+15,4,5,0,30,6,1,176,32,32,32,32,114,102,32,61,
+32,102,110,99,40,116,44,39,101,110,100,39,41,0,0,0,
+12,8,0,3,102,110,99,0,13,7,8,0,15,8,4,0,
+12,9,0,3,101,110,100,0,31,6,8,2,19,6,7,6,
+15,5,6,0,30,4,1,178,32,32,32,32,68,46,98,101,
+103,105,110,40,41,0,0,0,12,8,0,1,68,0,0,0,
+13,7,8,0,12,8,0,5,98,101,103,105,110,0,0,0,
+9,7,7,8,31,6,0,0,19,6,7,6,30,5,1,179,
+32,32,32,32,115,101,116,112,111,115,40,116,111,107,46,112,
+111,115,41,0,12,8,0,6,115,101,116,112,111,115,0,0,
+13,7,8,0,12,9,0,3,112,111,115,0,9,8,1,9,
+31,6,8,1,19,6,7,6,30,13,1,180,32,32,32,32,
+114,32,61,32,100,111,95,108,111,99,97,108,40,84,111,107,
+101,110,40,116,111,107,46,112,111,115,44,39,110,97,109,101,
+39,44,39,95,95,112,97,114,97,109,115,39,41,41,0,0,
+12,9,0,8,100,111,95,108,111,99,97,108,0,0,0,0,
+13,8,9,0,12,11,0,5,84,111,107,101,110,0,0,0,
+13,10,11,0,12,14,0,3,112,111,115,0,9,11,1,14,
+12,12,0,4,110,97,109,101,0,0,0,0,12,13,0,8,
+95,95,112,97,114,97,109,115,0,0,0,0,31,9,11,3,
+19,9,10,9,31,7,9,1,19,7,8,7,15,6,7,0,
+30,7,1,181,32,32,32,32,100,111,95,105,110,102,111,40,
+105,116,101,109,115,91,48,93,46,118,97,108,41,0,0,0,
+12,9,0,7,100,111,95,105,110,102,111,0,13,8,9,0,
+11,10,0,0,0,0,0,0,0,0,0,0,9,9,3,10,
+12,10,0,3,118,97,108,0,9,9,9,10,31,7,9,1,
+19,7,8,7,30,10,1,182,32,32,32,32,97,44,98,44,
+99,44,100,32,61,32,112,95,102,105,108,116,101,114,40,105,
+116,101,109,115,91,49,93,46,105,116,101,109,115,41,0,0,
+12,9,0,8,112,95,102,105,108,116,101,114,0,0,0,0,
+13,8,9,0,11,10,0,0,0,0,0,0,0,0,240,63,
+9,9,3,10,12,10,0,5,105,116,101,109,115,0,0,0,
+9,9,9,10,31,7,9,1,19,7,8,7,11,10,0,0,
+0,0,0,0,0,0,0,0,9,9,7,10,15,8,9,0,
+11,11,0,0,0,0,0,0,0,0,240,63,9,10,7,11,
+15,9,10,0,11,12,0,0,0,0,0,0,0,0,0,64,
+9,11,7,12,15,10,11,0,11,13,0,0,0,0,0,0,
+0,0,8,64,9,12,7,13,15,11,12,0,30,4,1,183,
+32,32,32,32,102,111,114,32,112,32,105,110,32,97,58,0,
+11,12,0,0,0,0,0,0,0,0,0,0,42,7,8,12,
+18,0,0,70,30,6,1,184,32,32,32,32,32,32,32,32,
+118,32,61,32,100,111,95,108,111,99,97,108,40,112,41,0,
+12,16,0,8,100,111,95,108,111,99,97,108,0,0,0,0,
+13,15,16,0,15,16,7,0,31,14,16,1,19,14,15,14,
+15,13,14,0,30,7,1,185,32,32,32,32,32,32,32,32,
+116,109,112,32,61,32,95,100,111,95,110,111,110,101,40,41,
+0,0,0,0,12,17,0,8,95,100,111,95,110,111,110,101,
+0,0,0,0,13,16,17,0,31,15,0,0,19,15,16,15,
+15,14,15,0,30,7,1,186,32,32,32,32,32,32,32,32,
+99,111,100,101,40,71,69,84,44,118,44,114,44,116,109,112,
+41,0,0,0,12,17,0,4,99,111,100,101,0,0,0,0,
+13,16,17,0,12,21,0,3,71,69,84,0,13,17,21,0,
+15,18,13,0,15,19,6,0,15,20,14,0,31,15,17,4,
+19,15,16,15,30,7,1,187,32,32,32,32,32,32,32,32,
+102,114,101,101,95,116,109,112,40,116,109,112,41,32,35,82,
+69,71,0,0,12,17,0,8,102,114,101,101,95,116,109,112,
+0,0,0,0,13,16,17,0,15,17,14,0,31,15,17,1,
+19,15,16,15,18,0,255,186,30,4,1,188,32,32,32,32,
+102,111,114,32,112,32,105,110,32,98,58,0,11,12,0,0,
+0,0,0,0,0,0,0,0,42,7,9,12,18,0,0,103,
+30,9,1,189,32,32,32,32,32,32,32,32,118,32,61,32,
+100,111,95,108,111,99,97,108,40,112,46,105,116,101,109,115,
+91,48,93,41,0,0,0,0,12,17,0,8,100,111,95,108,
+111,99,97,108,0,0,0,0,13,16,17,0,12,18,0,5,
+105,116,101,109,115,0,0,0,9,17,7,18,11,18,0,0,
+0,0,0,0,0,0,0,0,9,17,17,18,31,15,17,1,
+19,15,16,15,15,13,15,0,30,7,1,190,32,32,32,32,
+32,32,32,32,100,111,40,112,46,105,116,101,109,115,91,49,
+93,44,118,41,0,0,0,0,12,17,0,2,100,111,0,0,
+13,16,17,0,12,19,0,5,105,116,101,109,115,0,0,0,
+9,17,7,19,11,19,0,0,0,0,0,0,0,0,240,63,
+9,17,17,19,15,18,13,0,31,15,17,2,19,15,16,15,
+30,7,1,191,32,32,32,32,32,32,32,32,116,109,112,32,
+61,32,95,100,111,95,110,111,110,101,40,41,0,0,0,0,
+12,17,0,8,95,100,111,95,110,111,110,101,0,0,0,0,
+13,16,17,0,31,15,0,0,19,15,16,15,15,14,15,0,
+30,7,1,192,32,32,32,32,32,32,32,32,99,111,100,101,
+40,73,71,69,84,44,118,44,114,44,116,109,112,41,0,0,
+12,17,0,4,99,111,100,101,0,0,0,0,13,16,17,0,
+12,21,0,4,73,71,69,84,0,0,0,0,13,17,21,0,
+15,18,13,0,15,19,6,0,15,20,14,0,31,15,17,4,
+19,15,16,15,30,7,1,193,32,32,32,32,32,32,32,32,
+102,114,101,101,95,116,109,112,40,116,109,112,41,32,35,82,
+69,71,0,0,12,17,0,8,102,114,101,101,95,116,109,112,
+0,0,0,0,13,16,17,0,15,17,14,0,31,15,17,1,
+19,15,16,15,18,0,255,153,30,5,1,194,32,32,32,32,
+105,102,32,99,32,33,61,32,78,111,110,101,58,0,0,0,
+28,15,0,0,35,12,10,15,21,12,0,0,18,0,0,83,
+30,9,1,195,32,32,32,32,32,32,32,32,118,32,61,32,
+100,111,95,108,111,99,97,108,40,99,46,105,116,101,109,115,
+91,48,93,41,0,0,0,0,12,16,0,8,100,111,95,108,
+111,99,97,108,0,0,0,0,13,15,16,0,12,17,0,5,
+105,116,101,109,115,0,0,0,9,16,10,17,11,17,0,0,
+0,0,0,0,0,0,0,0,9,16,16,17,31,12,16,1,
+19,12,15,12,15,13,12,0,30,8,1,196,32,32,32,32,
+32,32,32,32,116,109,112,32,61,32,95,100,111,95,115,116,
+114,105,110,103,40,39,42,39,41,0,0,0,12,16,0,10,
+95,100,111,95,115,116,114,105,110,103,0,0,13,15,16,0,
+12,16,0,1,42,0,0,0,31,12,16,1,19,12,15,12,
+15,14,12,0,30,7,1,197,32,32,32,32,32,32,32,32,
+99,111,100,101,40,71,69,84,44,118,44,114,44,116,109,112,
+41,0,0,0,12,16,0,4,99,111,100,101,0,0,0,0,
+13,15,16,0,12,20,0,3,71,69,84,0,13,16,20,0,
+15,17,13,0,15,18,6,0,15,19,14,0,31,12,16,4,
+19,12,15,12,30,7,1,198,32,32,32,32,32,32,32,32,
+102,114,101,101,95,116,109,112,40,116,109,112,41,32,35,82,
+69,71,0,0,12,16,0,8,102,114,101,101,95,116,109,112,
+0,0,0,0,13,15,16,0,15,16,14,0,31,12,16,1,
+19,12,15,12,18,0,0,1,30,5,1,199,32,32,32,32,
+105,102,32,100,32,33,61,32,78,111,110,101,58,0,0,0,
+28,15,0,0,35,12,11,15,21,12,0,0,18,0,0,106,
+30,9,1,200,32,32,32,32,32,32,32,32,101,32,61,32,
+100,111,95,108,111,99,97,108,40,100,46,105,116,101,109,115,
+91,48,93,41,0,0,0,0,12,17,0,8,100,111,95,108,
+111,99,97,108,0,0,0,0,13,16,17,0,12,18,0,5,
+105,116,101,109,115,0,0,0,9,17,11,18,11,18,0,0,
+0,0,0,0,0,0,0,0,9,17,17,18,31,15,17,1,
+19,15,16,15,15,12,15,0,30,7,1,201,32,32,32,32,
+32,32,32,32,99,111,100,101,40,68,73,67,84,44,101,44,
+48,44,48,41,0,0,0,0,12,17,0,4,99,111,100,101,
+0,0,0,0,13,16,17,0,12,21,0,4,68,73,67,84,
+0,0,0,0,13,17,21,0,15,18,12,0,11,19,0,0,
+0,0,0,0,0,0,0,0,11,20,0,0,0,0,0,0,
+0,0,0,0,31,15,17,4,19,15,16,15,30,7,1,202,
+32,32,32,32,32,32,32,32,116,109,112,32,61,32,95,100,
+111,95,110,111,110,101,40,41,0,0,0,0,12,17,0,8,
+95,100,111,95,110,111,110,101,0,0,0,0,13,16,17,0,
+31,15,0,0,19,15,16,15,15,14,15,0,30,7,1,203,
+32,32,32,32,32,32,32,32,99,111,100,101,40,73,71,69,
+84,44,101,44,114,44,116,109,112,41,0,0,12,17,0,4,
+99,111,100,101,0,0,0,0,13,16,17,0,12,21,0,4,
+73,71,69,84,0,0,0,0,13,17,21,0,15,18,12,0,
+15,19,6,0,15,20,14,0,31,15,17,4,19,15,16,15,
+30,7,1,204,32,32,32,32,32,32,32,32,102,114,101,101,
+95,116,109,112,40,116,109,112,41,32,35,82,69,71,0,0,
+12,17,0,8,102,114,101,101,95,116,109,112,0,0,0,0,
+13,16,17,0,15,17,14,0,31,15,17,1,19,15,16,15,
+18,0,0,1,30,8,1,205,32,32,32,32,102,114,101,101,
+95,116,109,112,40,100,111,40,105,116,101,109,115,91,50,93,
+41,41,32,35,82,69,71,0,12,17,0,8,102,114,101,101,
+95,116,109,112,0,0,0,0,13,16,17,0,12,19,0,2,
+100,111,0,0,13,18,19,0,11,20,0,0,0,0,0,0,
+0,0,0,64,9,19,3,20,31,17,19,1,19,17,18,17,
+31,15,17,1,19,15,16,15,30,3,1,206,32,32,32,32,
+68,46,101,110,100,40,41,0,12,17,0,1,68,0,0,0,
+13,16,17,0,12,17,0,3,101,110,100,0,9,16,16,17,
+31,15,0,0,19,15,16,15,30,5,1,208,32,32,32,32,
+116,97,103,40,116,44,39,101,110,100,39,41,0,0,0,0,
+12,17,0,3,116,97,103,0,13,16,17,0,15,17,4,0,
+12,18,0,3,101,110,100,0,31,15,17,2,19,15,16,15,
+30,5,1,210,32,32,32,32,105,102,32,107,108,115,32,61,
+61,32,78,111,110,101,58,0,28,16,0,0,23,15,2,16,
+21,15,0,0,18,0,0,98,30,17,1,211,32,32,32,32,
+32,32,32,32,105,102,32,68,46,95,103,108,111,98,97,108,
+115,58,32,100,111,95,103,108,111,98,97,108,115,40,84,111,
+107,101,110,40,116,111,107,46,112,111,115,44,48,44,48,44,
+91,105,116,101,109,115,91,48,93,93,41,41,0,0,0,0,
+12,16,0,1,68,0,0,0,13,15,16,0,12,16,0,8,
+95,103,108,111,98,97,108,115,0,0,0,0,9,15,15,16,
+21,15,0,0,18,0,0,29,12,17,0,10,100,111,95,103,
+108,111,98,97,108,115,0,0,13,16,17,0,12,19,0,5,
+84,111,107,101,110,0,0,0,13,18,19,0,12,23,0,3,
+112,111,115,0,9,19,1,23,11,20,0,0,0,0,0,0,
+0,0,0,0,11,21,0,0,0,0,0,0,0,0,0,0,
+11,24,0,0,0,0,0,0,0,0,0,0,9,23,3,24,
+27,22,23,1,31,17,19,4,19,17,18,17,31,15,17,1,
+19,15,16,15,18,0,0,1,30,15,1,212,32,32,32,32,
+32,32,32,32,114,32,61,32,100,111,95,115,101,116,95,99,
+116,120,40,105,116,101,109,115,91,48,93,44,84,111,107,101,
+110,40,116,111,107,46,112,111,115,44,39,114,101,103,39,44,
+114,102,41,41,0,0,0,0,12,17,0,10,100,111,95,115,
+101,116,95,99,116,120,0,0,13,16,17,0,11,19,0,0,
+0,0,0,0,0,0,0,0,9,17,3,19,12,20,0,5,
+84,111,107,101,110,0,0,0,13,19,20,0,12,23,0,3,
+112,111,115,0,9,20,1,23,12,21,0,3,114,101,103,0,
+15,22,5,0,31,18,20,3,19,18,19,18,31,15,17,2,
+19,15,16,15,15,6,15,0,18,0,0,63,30,3,1,213,
+32,32,32,32,101,108,115,101,58,0,0,0,30,9,1,214,
+32,32,32,32,32,32,32,32,114,110,32,61,32,100,111,95,
+115,116,114,105,110,103,40,105,116,101,109,115,91,48,93,41,
+0,0,0,0,12,18,0,9,100,111,95,115,116,114,105,110,
+103,0,0,0,13,17,18,0,11,19,0,0,0,0,0,0,
+0,0,0,0,9,18,3,19,31,16,18,1,19,16,17,16,
+15,15,16,0,30,7,1,215,32,32,32,32,32,32,32,32,
+99,111,100,101,40,83,69,84,44,107,108,115,44,114,110,44,
+114,102,41,0,12,18,0,4,99,111,100,101,0,0,0,0,
+13,17,18,0,12,22,0,3,83,69,84,0,13,18,22,0,
+15,19,2,0,15,20,15,0,15,21,5,0,31,16,18,4,
+19,16,17,16,30,6,1,216,32,32,32,32,32,32,32,32,
+102,114,101,101,95,116,109,112,40,114,110,41,0,0,0,0,
+12,18,0,8,102,114,101,101,95,116,109,112,0,0,0,0,
+13,17,18,0,15,18,15,0,31,16,18,1,19,16,17,16,
+18,0,0,1,30,5,1,218,32,32,32,32,102,114,101,101,
+95,116,109,112,40,114,102,41,0,0,0,0,12,18,0,8,
+102,114,101,101,95,116,109,112,0,0,0,0,13,17,18,0,
+15,18,5,0,31,16,18,1,19,16,17,16,0,0,0,0,
+12,48,0,6,100,111,95,100,101,102,0,0,14,48,47,0,
+30,5,1,220,100,101,102,32,100,111,95,99,108,97,115,115,
+40,116,41,58,0,0,0,0,16,48,1,233,44,26,0,0,
+30,5,1,220,100,101,102,32,100,111,95,99,108,97,115,115,
+40,116,41,58,0,0,0,0,12,1,0,9,101,110,99,111,
+100,101,46,112,121,0,0,0,33,1,0,0,12,1,0,8,
+100,111,95,99,108,97,115,115,0,0,0,0,34,1,0,0,
+28,2,0,0,9,1,0,2,30,3,1,221,32,32,32,32,
+116,111,107,32,61,32,116,0,15,2,1,0,30,5,1,222,
+32,32,32,32,105,116,101,109,115,32,61,32,116,46,105,116,
+101,109,115,0,12,5,0,5,105,116,101,109,115,0,0,0,
+9,4,1,5,15,3,4,0,30,5,1,223,32,32,32,32,
+112,97,114,101,110,116,32,61,32,78,111,110,101,0,0,0,
+28,5,0,0,15,4,5,0,30,8,1,224,32,32,32,32,
+105,102,32,105,116,101,109,115,91,48,93,46,116,121,112,101,
+32,61,61,32,39,110,97,109,101,39,58,0,11,6,0,0,
+0,0,0,0,0,0,0,0,9,5,3,6,12,6,0,4,
+116,121,112,101,0,0,0,0,9,5,5,6,12,6,0,4,
+110,97,109,101,0,0,0,0,23,5,5,6,21,5,0,0,
+18,0,0,47,30,7,1,225,32,32,32,32,32,32,32,32,
+110,97,109,101,32,61,32,105,116,101,109,115,91,48,93,46,
+118,97,108,0,11,7,0,0,0,0,0,0,0,0,0,0,
+9,6,3,7,12,7,0,3,118,97,108,0,9,6,6,7,
+15,5,6,0,30,12,1,226,32,32,32,32,32,32,32,32,
+112,97,114,101,110,116,32,61,32,84,111,107,101,110,40,116,
+111,107,46,112,111,115,44,39,110,97,109,101,39,44,39,111,
+98,106,101,99,116,39,41,0,12,8,0,5,84,111,107,101,
+110,0,0,0,13,7,8,0,12,11,0,3,112,111,115,0,
+9,8,2,11,12,9,0,4,110,97,109,101,0,0,0,0,
+12,10,0,6,111,98,106,101,99,116,0,0,31,6,8,3,
+19,6,7,6,15,4,6,0,18,0,0,56,30,3,1,227,
+32,32,32,32,101,108,115,101,58,0,0,0,30,10,1,228,
+32,32,32,32,32,32,32,32,110,97,109,101,32,61,32,105,
+116,101,109,115,91,48,93,46,105,116,101,109,115,91,48,93,
+46,118,97,108,0,0,0,0,11,7,0,0,0,0,0,0,
+0,0,0,0,9,6,3,7,12,7,0,5,105,116,101,109,
+115,0,0,0,9,6,6,7,11,7,0,0,0,0,0,0,
+0,0,0,0,9,6,6,7,12,7,0,3,118,97,108,0,
+9,6,6,7,15,5,6,0,30,9,1,229,32,32,32,32,
+32,32,32,32,112,97,114,101,110,116,32,61,32,105,116,101,
+109,115,91,48,93,46,105,116,101,109,115,91,49,93,0,0,
+11,7,0,0,0,0,0,0,0,0,0,0,9,6,3,7,
+12,7,0,5,105,116,101,109,115,0,0,0,9,6,6,7,
+11,7,0,0,0,0,0,0,0,0,240,63,9,6,6,7,
+15,4,6,0,18,0,0,1,30,10,1,231,32,32,32,32,
+107,108,115,32,61,32,100,111,40,84,111,107,101,110,40,116,
+46,112,111,115,44,39,100,105,99,116,39,44,48,44,91,93,
+41,41,0,0,12,9,0,2,100,111,0,0,13,8,9,0,
+12,11,0,5,84,111,107,101,110,0,0,0,13,10,11,0,
+12,15,0,3,112,111,115,0,9,11,1,15,12,12,0,4,
+100,105,99,116,0,0,0,0,11,13,0,0,0,0,0,0,
+0,0,0,0,27,14,0,0,31,9,11,4,19,9,10,9,
+31,7,9,1,19,7,8,7,15,6,7,0,30,4,1,232,
+32,32,32,32,117,110,95,116,109,112,40,107,108,115,41,0,
+12,9,0,6,117,110,95,116,109,112,0,0,13,8,9,0,
+15,9,6,0,31,7,9,1,19,7,8,7,30,7,1,233,
+32,32,32,32,116,115,32,61,32,95,100,111,95,115,116,114,
+105,110,103,40,110,97,109,101,41,0,0,0,12,10,0,10,
+95,100,111,95,115,116,114,105,110,103,0,0,13,9,10,0,
+15,10,5,0,31,8,10,1,19,8,9,8,15,7,8,0,
+30,6,1,234,32,32,32,32,99,111,100,101,40,71,83,69,
+84,44,116,115,44,107,108,115,41,0,0,0,12,10,0,4,
+99,111,100,101,0,0,0,0,13,9,10,0,12,13,0,4,
+71,83,69,84,0,0,0,0,13,10,13,0,15,11,7,0,
+15,12,6,0,31,8,10,3,19,8,9,8,30,6,1,235,
+32,32,32,32,102,114,101,101,95,116,109,112,40,116,115,41,
+32,35,82,69,71,0,0,0,12,10,0,8,102,114,101,101,
+95,116,109,112,0,0,0,0,13,9,10,0,15,10,7,0,
+31,8,10,1,19,8,9,8,30,11,1,237,32,32,32,32,
+102,114,101,101,95,116,109,112,40,100,111,40,84,111,107,101,
+110,40,116,111,107,46,112,111,115,44,39,99,97,108,108,39,
+44,78,111,110,101,44,91,0,12,10,0,8,102,114,101,101,
+95,116,109,112,0,0,0,0,13,9,10,0,12,12,0,2,
+100,111,0,0,13,11,12,0,12,14,0,5,84,111,107,101,
+110,0,0,0,13,13,14,0,12,18,0,3,112,111,115,0,
+9,14,2,18,12,15,0,4,99,97,108,108,0,0,0,0,
+28,16,0,0,30,11,1,238,32,32,32,32,32,32,32,32,
+84,111,107,101,110,40,116,111,107,46,112,111,115,44,39,110,
+97,109,101,39,44,39,115,101,116,109,101,116,97,39,41,44,
+0,0,0,0,12,22,0,5,84,111,107,101,110,0,0,0,
+13,21,22,0,12,25,0,3,112,111,115,0,9,22,2,25,
+12,23,0,4,110,97,109,101,0,0,0,0,12,24,0,7,
+115,101,116,109,101,116,97,0,31,18,22,3,19,18,21,18,
+30,9,1,239,32,32,32,32,32,32,32,32,84,111,107,101,
+110,40,116,111,107,46,112,111,115,44,39,114,101,103,39,44,
+107,108,115,41,44,0,0,0,12,22,0,5,84,111,107,101,
+110,0,0,0,13,21,22,0,12,25,0,3,112,111,115,0,
+9,22,2,25,12,23,0,3,114,101,103,0,15,24,6,0,
+31,19,22,3,19,19,21,19,30,5,1,240,32,32,32,32,
+32,32,32,32,112,97,114,101,110,116,93,41,41,41,0,0,
+15,20,4,0,27,17,18,3,31,12,14,4,19,12,13,12,
+31,10,12,1,19,10,11,10,31,8,10,1,19,8,9,8,
+30,9,1,242,32,32,32,32,102,111,114,32,109,101,109,98,
+101,114,32,105,110,32,105,116,101,109,115,91,49,93,46,105,
+116,101,109,115,58,0,0,0,11,10,0,0,0,0,0,0,
+0,0,240,63,9,9,3,10,12,10,0,5,105,116,101,109,
+115,0,0,0,9,9,9,10,11,10,0,0,0,0,0,0,
+0,0,0,0,42,8,9,10,18,0,0,93,30,13,1,243,
+32,32,32,32,32,32,32,32,105,102,32,109,101,109,98,101,
+114,46,116,121,112,101,32,61,61,32,39,100,101,102,39,58,
+32,100,111,95,100,101,102,40,109,101,109,98,101,114,44,107,
+108,115,41,0,12,12,0,4,116,121,112,101,0,0,0,0,
+9,11,8,12,12,12,0,3,100,101,102,0,23,11,11,12,
+21,11,0,0,18,0,0,10,12,13,0,6,100,111,95,100,
+101,102,0,0,13,12,13,0,15,13,8,0,15,14,6,0,
+31,11,13,2,19,11,12,11,18,0,0,60,30,21,1,244,
+32,32,32,32,32,32,32,32,101,108,105,102,32,109,101,109,
+98,101,114,46,116,121,112,101,32,61,61,32,39,115,121,109,
+98,111,108,39,32,97,110,100,32,109,101,109,98,101,114,46,
+118,97,108,32,61,61,32,39,61,39,58,32,100,111,95,99,
+108,97,115,115,118,97,114,40,109,101,109,98,101,114,44,107,
+108,115,41,0,12,12,0,4,116,121,112,101,0,0,0,0,
+9,11,8,12,12,12,0,6,115,121,109,98,111,108,0,0,
+23,11,11,12,21,11,0,0,18,0,0,7,12,12,0,3,
+118,97,108,0,9,11,8,12,12,12,0,1,61,0,0,0,
+23,11,11,12,21,11,0,0,18,0,0,11,12,13,0,11,
+100,111,95,99,108,97,115,115,118,97,114,0,13,12,13,0,
+15,13,8,0,15,14,6,0,31,11,13,2,19,11,12,11,
+18,0,0,10,30,6,1,245,32,32,32,32,32,32,32,32,
+101,108,115,101,58,32,99,111,110,116,105,110,117,101,0,0,
+18,0,255,165,18,0,0,1,18,0,255,163,30,6,1,247,
+32,32,32,32,102,114,101,101,95,114,101,103,40,107,108,115,
+41,32,35,82,69,71,0,0,12,11,0,8,102,114,101,101,
+95,114,101,103,0,0,0,0,13,10,11,0,15,11,6,0,
+31,9,11,1,19,9,10,9,0,0,0,0,12,49,0,8,
+100,111,95,99,108,97,115,115,0,0,0,0,14,49,48,0,
+30,6,1,249,100,101,102,32,100,111,95,99,108,97,115,115,
+118,97,114,40,116,44,114,41,58,0,0,0,16,49,0,118,
+44,12,0,0,30,6,1,249,100,101,102,32,100,111,95,99,
+108,97,115,115,118,97,114,40,116,44,114,41,58,0,0,0,
+12,1,0,9,101,110,99,111,100,101,46,112,121,0,0,0,
+33,1,0,0,12,1,0,11,100,111,95,99,108,97,115,115,
+118,97,114,0,34,1,0,0,28,2,0,0,9,1,0,2,
+28,3,0,0,9,2,0,3,30,8,1,250,32,32,32,32,
+118,97,114,32,61,32,100,111,95,115,116,114,105,110,103,40,
+116,46,105,116,101,109,115,91,48,93,41,0,12,6,0,9,
+100,111,95,115,116,114,105,110,103,0,0,0,13,5,6,0,
+12,7,0,5,105,116,101,109,115,0,0,0,9,6,1,7,
+11,7,0,0,0,0,0,0,0,0,0,0,9,6,6,7,
+31,4,6,1,19,4,5,4,15,3,4,0,30,7,1,251,
+32,32,32,32,118,97,108,32,61,32,100,111,40,116,46,105,
+116,101,109,115,91,49,93,41,0,0,0,0,12,7,0,2,
+100,111,0,0,13,6,7,0,12,8,0,5,105,116,101,109,
+115,0,0,0,9,7,1,8,11,8,0,0,0,0,0,0,
+0,0,240,63,9,7,7,8,31,5,7,1,19,5,6,5,
+15,4,5,0,30,6,1,252,32,32,32,32,99,111,100,101,
+40,83,69,84,44,114,44,118,97,114,44,118,97,108,41,0,
+12,7,0,4,99,111,100,101,0,0,0,0,13,6,7,0,
+12,11,0,3,83,69,84,0,13,7,11,0,15,8,2,0,
+15,9,3,0,15,10,4,0,31,5,7,4,19,5,6,5,
+30,5,1,253,32,32,32,32,102,114,101,101,95,114,101,103,
+40,118,97,114,41,0,0,0,12,7,0,8,102,114,101,101,
+95,114,101,103,0,0,0,0,13,6,7,0,15,7,3,0,
+31,5,7,1,19,5,6,5,30,5,1,254,32,32,32,32,
+102,114,101,101,95,114,101,103,40,118,97,108,41,0,0,0,
+12,7,0,8,102,114,101,101,95,114,101,103,0,0,0,0,
+13,6,7,0,15,7,4,0,31,5,7,1,19,5,6,5,
+0,0,0,0,12,50,0,11,100,111,95,99,108,97,115,115,
+118,97,114,0,14,50,49,0,30,5,2,0,100,101,102,32,
+100,111,95,119,104,105,108,101,40,116,41,58,0,0,0,0,
+16,50,0,221,44,10,0,0,30,5,2,0,100,101,102,32,
+100,111,95,119,104,105,108,101,40,116,41,58,0,0,0,0,
+12,1,0,9,101,110,99,111,100,101,46,112,121,0,0,0,
+33,1,0,0,12,1,0,8,100,111,95,119,104,105,108,101,
+0,0,0,0,34,1,0,0,28,2,0,0,9,1,0,2,
+30,5,2,1,32,32,32,32,105,116,101,109,115,32,61,32,
+116,46,105,116,101,109,115,0,12,4,0,5,105,116,101,109,
+115,0,0,0,9,3,1,4,15,2,3,0,30,5,2,2,
+32,32,32,32,116,32,61,32,115,116,97,99,107,95,116,97,
+103,40,41,0,12,5,0,9,115,116,97,99,107,95,116,97,
+103,0,0,0,13,4,5,0,31,3,0,0,19,3,4,3,
+15,1,3,0,30,5,2,3,32,32,32,32,116,97,103,40,
+116,44,39,98,101,103,105,110,39,41,0,0,12,5,0,3,
+116,97,103,0,13,4,5,0,15,5,1,0,12,6,0,5,
+98,101,103,105,110,0,0,0,31,3,5,2,19,3,4,3,
+30,6,2,4,32,32,32,32,116,97,103,40,116,44,39,99,
+111,110,116,105,110,117,101,39,41,0,0,0,12,5,0,3,
+116,97,103,0,13,4,5,0,15,5,1,0,12,6,0,8,
+99,111,110,116,105,110,117,101,0,0,0,0,31,3,5,2,
+19,3,4,3,30,6,2,5,32,32,32,32,114,32,61,32,
+100,111,40,105,116,101,109,115,91,48,93,41,0,0,0,0,
+12,6,0,2,100,111,0,0,13,5,6,0,11,7,0,0,
+0,0,0,0,0,0,0,0,9,6,2,7,31,4,6,1,
+19,4,5,4,15,3,4,0,30,4,2,6,32,32,32,32,
+99,111,100,101,40,73,70,44,114,41,0,0,12,6,0,4,
+99,111,100,101,0,0,0,0,13,5,6,0,12,8,0,2,
+73,70,0,0,13,6,8,0,15,7,3,0,31,4,6,2,
+19,4,5,4,30,6,2,7,32,32,32,32,102,114,101,101,
+95,116,109,112,40,114,41,32,35,82,69,71,0,0,0,0,
+12,6,0,8,102,114,101,101,95,116,109,112,0,0,0,0,
+13,5,6,0,15,6,3,0,31,4,6,1,19,4,5,4,
+30,5,2,8,32,32,32,32,106,117,109,112,40,116,44,39,
+101,110,100,39,41,0,0,0,12,6,0,4,106,117,109,112,
+0,0,0,0,13,5,6,0,15,6,1,0,12,7,0,3,
+101,110,100,0,31,4,6,2,19,4,5,4,30,8,2,9,
+32,32,32,32,102,114,101,101,95,116,109,112,40,100,111,40,
+105,116,101,109,115,91,49,93,41,41,32,35,82,69,71,0,
+12,6,0,8,102,114,101,101,95,116,109,112,0,0,0,0,
+13,5,6,0,12,8,0,2,100,111,0,0,13,7,8,0,
+11,9,0,0,0,0,0,0,0,0,240,63,9,8,2,9,
+31,6,8,1,19,6,7,6,31,4,6,1,19,4,5,4,
+30,5,2,10,32,32,32,32,106,117,109,112,40,116,44,39,
+98,101,103,105,110,39,41,0,12,6,0,4,106,117,109,112,
+0,0,0,0,13,5,6,0,15,6,1,0,12,7,0,5,
+98,101,103,105,110,0,0,0,31,4,6,2,19,4,5,4,
+30,5,2,11,32,32,32,32,116,97,103,40,116,44,39,98,
+114,101,97,107,39,41,0,0,12,6,0,3,116,97,103,0,
+13,5,6,0,15,6,1,0,12,7,0,5,98,114,101,97,
+107,0,0,0,31,4,6,2,19,4,5,4,30,5,2,12,
+32,32,32,32,116,97,103,40,116,44,39,101,110,100,39,41,
+0,0,0,0,12,6,0,3,116,97,103,0,13,5,6,0,
+15,6,1,0,12,7,0,3,101,110,100,0,31,4,6,2,
+19,4,5,4,30,4,2,13,32,32,32,32,112,111,112,95,
+116,97,103,40,41,0,0,0,12,6,0,7,112,111,112,95,
+116,97,103,0,13,5,6,0,31,4,0,0,19,4,5,4,
+0,0,0,0,12,51,0,8,100,111,95,119,104,105,108,101,
+0,0,0,0,14,51,50,0,30,5,2,15,100,101,102,32,
+100,111,95,102,111,114,40,116,111,107,41,58,0,0,0,0,
+16,51,1,10,44,14,0,0,30,5,2,15,100,101,102,32,
+100,111,95,102,111,114,40,116,111,107,41,58,0,0,0,0,
+12,1,0,9,101,110,99,111,100,101,46,112,121,0,0,0,
+33,1,0,0,12,1,0,6,100,111,95,102,111,114,0,0,
+34,1,0,0,28,2,0,0,9,1,0,2,30,6,2,16,
+32,32,32,32,105,116,101,109,115,32,61,32,116,111,107,46,
+105,116,101,109,115,0,0,0,12,4,0,5,105,116,101,109,
+115,0,0,0,9,3,1,4,15,2,3,0,30,8,2,18,
+32,32,32,32,114,101,103,32,61,32,100,111,95,108,111,99,
+97,108,40,105,116,101,109,115,91,48,93,41,0,0,0,0,
+12,6,0,8,100,111,95,108,111,99,97,108,0,0,0,0,
+13,5,6,0,11,7,0,0,0,0,0,0,0,0,0,0,
+9,6,2,7,31,4,6,1,19,4,5,4,15,3,4,0,
+30,6,2,19,32,32,32,32,105,116,114,32,61,32,100,111,
+40,105,116,101,109,115,91,49,93,41,0,0,12,7,0,2,
+100,111,0,0,13,6,7,0,11,8,0,0,0,0,0,0,
+0,0,240,63,9,7,2,8,31,5,7,1,19,5,6,5,
+15,4,5,0,30,6,2,20,32,32,32,32,105,32,61,32,
+95,100,111,95,110,117,109,98,101,114,40,39,48,39,41,0,
+12,8,0,10,95,100,111,95,110,117,109,98,101,114,0,0,
+13,7,8,0,12,8,0,1,48,0,0,0,31,6,8,1,
+19,6,7,6,15,5,6,0,30,14,2,22,32,32,32,32,
+116,32,61,32,115,116,97,99,107,95,116,97,103,40,41,59,
+32,116,97,103,40,116,44,39,108,111,111,112,39,41,59,32,
+116,97,103,40,116,44,39,99,111,110,116,105,110,117,101,39,
+41,0,0,0,12,9,0,9,115,116,97,99,107,95,116,97,
+103,0,0,0,13,8,9,0,31,7,0,0,19,7,8,7,
+15,6,7,0,12,9,0,3,116,97,103,0,13,8,9,0,
+15,9,6,0,12,10,0,4,108,111,111,112,0,0,0,0,
+31,7,9,2,19,7,8,7,12,9,0,3,116,97,103,0,
+13,8,9,0,15,9,6,0,12,10,0,8,99,111,110,116,
+105,110,117,101,0,0,0,0,31,7,9,2,19,7,8,7,
+30,10,2,23,32,32,32,32,99,111,100,101,40,73,84,69,
+82,44,114,101,103,44,105,116,114,44,105,41,59,32,106,117,
+109,112,40,116,44,39,101,110,100,39,41,0,12,9,0,4,
+99,111,100,101,0,0,0,0,13,8,9,0,12,13,0,4,
+73,84,69,82,0,0,0,0,13,9,13,0,15,10,3,0,
+15,11,4,0,15,12,5,0,31,7,9,4,19,7,8,7,
+12,9,0,4,106,117,109,112,0,0,0,0,13,8,9,0,
+15,9,6,0,12,10,0,3,101,110,100,0,31,7,9,2,
+19,7,8,7,30,8,2,24,32,32,32,32,102,114,101,101,
+95,116,109,112,40,100,111,40,105,116,101,109,115,91,50,93,
+41,41,32,35,82,69,71,0,12,9,0,8,102,114,101,101,
+95,116,109,112,0,0,0,0,13,8,9,0,12,11,0,2,
+100,111,0,0,13,10,11,0,11,12,0,0,0,0,0,0,
+0,0,0,64,9,11,2,12,31,9,11,1,19,9,10,9,
+31,7,9,1,19,7,8,7,30,5,2,25,32,32,32,32,
+106,117,109,112,40,116,44,39,108,111,111,112,39,41,0,0,
+12,9,0,4,106,117,109,112,0,0,0,0,13,8,9,0,
+15,9,6,0,12,10,0,4,108,111,111,112,0,0,0,0,
+31,7,9,2,19,7,8,7,30,11,2,26,32,32,32,32,
+116,97,103,40,116,44,39,98,114,101,97,107,39,41,59,32,
+116,97,103,40,116,44,39,101,110,100,39,41,59,32,112,111,
+112,95,116,97,103,40,41,0,12,9,0,3,116,97,103,0,
+13,8,9,0,15,9,6,0,12,10,0,5,98,114,101,97,
+107,0,0,0,31,7,9,2,19,7,8,7,12,9,0,3,
+116,97,103,0,13,8,9,0,15,9,6,0,12,10,0,3,
+101,110,100,0,31,7,9,2,19,7,8,7,12,9,0,7,
+112,111,112,95,116,97,103,0,13,8,9,0,31,7,0,0,
+19,7,8,7,30,6,2,28,32,32,32,32,102,114,101,101,
+95,116,109,112,40,105,116,114,41,32,35,82,69,71,0,0,
+12,9,0,8,102,114,101,101,95,116,109,112,0,0,0,0,
+13,8,9,0,15,9,4,0,31,7,9,1,19,7,8,7,
+30,4,2,29,32,32,32,32,102,114,101,101,95,116,109,112,
+40,105,41,0,12,9,0,8,102,114,101,101,95,116,109,112,
+0,0,0,0,13,8,9,0,15,9,5,0,31,7,9,1,
+19,7,8,7,0,0,0,0,12,52,0,6,100,111,95,102,
+111,114,0,0,14,52,51,0,30,6,2,31,100,101,102,32,
+100,111,95,99,111,109,112,40,116,44,114,61,78,111,110,101,
+41,58,0,0,16,52,1,14,44,18,0,0,30,6,2,31,
+100,101,102,32,100,111,95,99,111,109,112,40,116,44,114,61,
+78,111,110,101,41,58,0,0,12,1,0,9,101,110,99,111,
+100,101,46,112,121,0,0,0,33,1,0,0,12,1,0,7,
+100,111,95,99,111,109,112,0,34,1,0,0,28,2,0,0,
+9,1,0,2,28,2,0,0,28,3,0,0,32,2,0,3,
+30,8,2,32,32,32,32,32,110,97,109,101,32,61,32,39,
+99,111,109,112,58,39,43,103,101,116,95,116,97,103,40,41,
+0,0,0,0,12,4,0,5,99,111,109,112,58,0,0,0,
+12,7,0,7,103,101,116,95,116,97,103,0,13,6,7,0,
+31,5,0,0,19,5,6,5,1,4,4,5,15,3,4,0,
+30,11,2,33,32,32,32,32,114,32,61,32,100,111,95,108,
+111,99,97,108,40,84,111,107,101,110,40,116,46,112,111,115,
+44,39,110,97,109,101,39,44,110,97,109,101,41,41,0,0,
+12,6,0,8,100,111,95,108,111,99,97,108,0,0,0,0,
+13,5,6,0,12,8,0,5,84,111,107,101,110,0,0,0,
+13,7,8,0,12,11,0,3,112,111,115,0,9,8,1,11,
+12,9,0,4,110,97,109,101,0,0,0,0,15,10,3,0,
+31,6,8,3,19,6,7,6,31,4,6,1,19,4,5,4,
+15,2,4,0,30,6,2,34,32,32,32,32,99,111,100,101,
+40,76,73,83,84,44,114,44,48,44,48,41,0,0,0,0,
+12,6,0,4,99,111,100,101,0,0,0,0,13,5,6,0,
+12,10,0,4,76,73,83,84,0,0,0,0,13,6,10,0,
+15,7,2,0,11,8,0,0,0,0,0,0,0,0,0,0,
+11,9,0,0,0,0,0,0,0,0,0,0,31,4,6,4,
+19,4,5,4,30,9,2,35,32,32,32,32,107,101,121,32,
+61,32,84,111,107,101,110,40,116,46,112,111,115,44,39,103,
+101,116,39,44,78,111,110,101,44,91,0,0,12,7,0,5,
+84,111,107,101,110,0,0,0,13,6,7,0,12,11,0,3,
+112,111,115,0,9,7,1,11,12,8,0,3,103,101,116,0,
+28,9,0,0,30,9,2,36,32,32,32,32,32,32,32,32,
+32,32,32,32,84,111,107,101,110,40,116,46,112,111,115,44,
+39,114,101,103,39,44,114,41,44,0,0,0,12,14,0,5,
+84,111,107,101,110,0,0,0,13,13,14,0,12,17,0,3,
+112,111,115,0,9,14,1,17,12,15,0,3,114,101,103,0,
+15,16,2,0,31,11,14,3,19,11,13,11,30,11,2,37,
+32,32,32,32,32,32,32,32,32,32,32,32,84,111,107,101,
+110,40,116,46,112,111,115,44,39,115,121,109,98,111,108,39,
+44,39,78,111,110,101,39,41,93,41,0,0,12,14,0,5,
+84,111,107,101,110,0,0,0,13,13,14,0,12,17,0,3,
+112,111,115,0,9,14,1,17,12,15,0,6,115,121,109,98,
+111,108,0,0,12,16,0,4,78,111,110,101,0,0,0,0,
+31,12,14,3,19,12,13,12,27,10,11,2,31,5,7,4,
+19,5,6,5,15,4,5,0,30,13,2,38,32,32,32,32,
+97,112,32,61,32,84,111,107,101,110,40,116,46,112,111,115,
+44,39,115,121,109,98,111,108,39,44,39,61,39,44,91,107,
+101,121,44,116,46,105,116,101,109,115,91,48,93,93,41,0,
+12,8,0,5,84,111,107,101,110,0,0,0,13,7,8,0,
+12,12,0,3,112,111,115,0,9,8,1,12,12,9,0,6,
+115,121,109,98,111,108,0,0,12,10,0,1,61,0,0,0,
+15,12,4,0,12,14,0,5,105,116,101,109,115,0,0,0,
+9,13,1,14,11,14,0,0,0,0,0,0,0,0,0,0,
+9,13,13,14,27,11,12,2,31,6,8,4,19,6,7,6,
+15,5,6,0,30,15,2,39,32,32,32,32,100,111,40,84,
+111,107,101,110,40,116,46,112,111,115,44,39,102,111,114,39,
+44,78,111,110,101,44,91,116,46,105,116,101,109,115,91,49,
+93,44,116,46,105,116,101,109,115,91,50,93,44,97,112,93,
+41,41,0,0,12,8,0,2,100,111,0,0,13,7,8,0,
+12,10,0,5,84,111,107,101,110,0,0,0,13,9,10,0,
+12,14,0,3,112,111,115,0,9,10,1,14,12,11,0,3,
+102,111,114,0,28,12,0,0,12,17,0,5,105,116,101,109,
+115,0,0,0,9,14,1,17,11,17,0,0,0,0,0,0,
+0,0,240,63,9,14,14,17,12,17,0,5,105,116,101,109,
+115,0,0,0,9,15,1,17,11,17,0,0,0,0,0,0,
+0,0,0,64,9,15,15,17,15,16,5,0,27,13,14,3,
+31,8,10,4,19,8,9,8,31,6,8,1,19,6,7,6,
+30,4,2,40,32,32,32,32,114,101,116,117,114,110,32,114,
+0,0,0,0,20,2,0,0,0,0,0,0,12,53,0,7,
+100,111,95,99,111,109,112,0,14,53,52,0,30,4,2,42,
+100,101,102,32,100,111,95,105,102,40,116,41,58,0,0,0,
+16,53,1,52,44,13,0,0,30,4,2,42,100,101,102,32,
+100,111,95,105,102,40,116,41,58,0,0,0,12,1,0,9,
+101,110,99,111,100,101,46,112,121,0,0,0,33,1,0,0,
+12,1,0,5,100,111,95,105,102,0,0,0,34,1,0,0,
+28,2,0,0,9,1,0,2,30,5,2,43,32,32,32,32,
+105,116,101,109,115,32,61,32,116,46,105,116,101,109,115,0,
+12,4,0,5,105,116,101,109,115,0,0,0,9,3,1,4,
+15,2,3,0,30,5,2,44,32,32,32,32,116,32,61,32,
+103,101,116,95,116,97,103,40,41,0,0,0,12,5,0,7,
+103,101,116,95,116,97,103,0,13,4,5,0,31,3,0,0,
+19,3,4,3,15,1,3,0,30,3,2,45,32,32,32,32,
+110,32,61,32,48,0,0,0,11,4,0,0,0,0,0,0,
+0,0,0,0,15,3,4,0,30,6,2,46,32,32,32,32,
+102,111,114,32,116,116,32,105,110,32,105,116,101,109,115,58,
+0,0,0,0,11,5,0,0,0,0,0,0,0,0,0,0,
+42,4,2,5,18,0,0,220,30,5,2,47,32,32,32,32,
+32,32,32,32,116,97,103,40,116,44,110,41,0,0,0,0,
+12,8,0,3,116,97,103,0,13,7,8,0,15,8,1,0,
+15,9,3,0,31,6,8,2,19,6,7,6,30,8,2,48,
+32,32,32,32,32,32,32,32,105,102,32,116,116,46,116,121,
+112,101,32,61,61,32,39,101,108,105,102,39,58,0,0,0,
+12,7,0,4,116,121,112,101,0,0,0,0,9,6,4,7,
+12,7,0,4,101,108,105,102,0,0,0,0,23,6,6,7,
+21,6,0,0,18,0,0,100,30,15,2,49,32,32,32,32,
+32,32,32,32,32,32,32,32,97,32,61,32,100,111,40,116,
+116,46,105,116,101,109,115,91,48,93,41,59,32,99,111,100,
+101,40,73,70,44,97,41,59,32,102,114,101,101,95,116,109,
+112,40,97,41,59,0,0,0,12,9,0,2,100,111,0,0,
+13,8,9,0,12,10,0,5,105,116,101,109,115,0,0,0,
+9,9,4,10,11,10,0,0,0,0,0,0,0,0,0,0,
+9,9,9,10,31,7,9,1,19,7,8,7,15,6,7,0,
+12,9,0,4,99,111,100,101,0,0,0,0,13,8,9,0,
+12,11,0,2,73,70,0,0,13,9,11,0,15,10,6,0,
+31,7,9,2,19,7,8,7,12,9,0,8,102,114,101,101,
+95,116,109,112,0,0,0,0,13,8,9,0,15,9,6,0,
+31,7,9,1,19,7,8,7,30,6,2,50,32,32,32,32,
+32,32,32,32,32,32,32,32,106,117,109,112,40,116,44,110,
+43,49,41,0,12,9,0,4,106,117,109,112,0,0,0,0,
+13,8,9,0,15,9,1,0,11,11,0,0,0,0,0,0,
+0,0,240,63,1,10,3,11,31,7,9,2,19,7,8,7,
+30,11,2,51,32,32,32,32,32,32,32,32,32,32,32,32,
+102,114,101,101,95,116,109,112,40,100,111,40,116,116,46,105,
+116,101,109,115,91,49,93,41,41,32,35,82,69,71,0,0,
+12,9,0,8,102,114,101,101,95,116,109,112,0,0,0,0,
+13,8,9,0,12,11,0,2,100,111,0,0,13,10,11,0,
+12,12,0,5,105,116,101,109,115,0,0,0,9,11,4,12,
+11,12,0,0,0,0,0,0,0,0,240,63,9,11,11,12,
+31,9,11,1,19,9,10,9,31,7,9,1,19,7,8,7,
+18,0,0,62,30,8,2,52,32,32,32,32,32,32,32,32,
+101,108,105,102,32,116,116,46,116,121,112,101,32,61,61,32,
+39,101,108,115,101,39,58,0,12,8,0,4,116,121,112,101,
+0,0,0,0,9,7,4,8,12,8,0,4,101,108,115,101,
+0,0,0,0,23,7,7,8,21,7,0,0,18,0,0,34,
+30,11,2,53,32,32,32,32,32,32,32,32,32,32,32,32,
+102,114,101,101,95,116,109,112,40,100,111,40,116,116,46,105,
+116,101,109,115,91,48,93,41,41,32,35,82,69,71,0,0,
+12,9,0,8,102,114,101,101,95,116,109,112,0,0,0,0,
+13,8,9,0,12,11,0,2,100,111,0,0,13,10,11,0,
+12,12,0,5,105,116,101,109,115,0,0,0,9,11,4,12,
+11,12,0,0,0,0,0,0,0,0,0,0,9,11,11,12,
+31,9,11,1,19,9,10,9,31,7,9,1,19,7,8,7,
+18,0,0,10,30,5,2,55,32,32,32,32,32,32,32,32,
+32,32,32,32,114,97,105,115,101,0,0,0,28,7,0,0,
+37,7,0,0,18,0,0,1,30,6,2,56,32,32,32,32,
+32,32,32,32,106,117,109,112,40,116,44,39,101,110,100,39,
+41,0,0,0,12,9,0,4,106,117,109,112,0,0,0,0,
+13,8,9,0,15,9,1,0,12,10,0,3,101,110,100,0,
+31,7,9,2,19,7,8,7,30,4,2,57,32,32,32,32,
+32,32,32,32,110,32,43,61,32,49,0,0,11,8,0,0,
+0,0,0,0,0,0,240,63,1,7,3,8,15,3,7,0,
+18,0,255,36,30,4,2,58,32,32,32,32,116,97,103,40,
+116,44,110,41,0,0,0,0,12,8,0,3,116,97,103,0,
+13,7,8,0,15,8,1,0,15,9,3,0,31,5,8,2,
+19,5,7,5,30,5,2,59,32,32,32,32,116,97,103,40,
+116,44,39,101,110,100,39,41,0,0,0,0,12,8,0,3,
+116,97,103,0,13,7,8,0,15,8,1,0,12,9,0,3,
+101,110,100,0,31,5,8,2,19,5,7,5,0,0,0,0,
+12,54,0,5,100,111,95,105,102,0,0,0,14,54,53,0,
+30,4,2,61,100,101,102,32,100,111,95,116,114,121,40,116,
+41,58,0,0,16,54,0,184,44,9,0,0,30,4,2,61,
+100,101,102,32,100,111,95,116,114,121,40,116,41,58,0,0,
+12,1,0,9,101,110,99,111,100,101,46,112,121,0,0,0,
+33,1,0,0,12,1,0,6,100,111,95,116,114,121,0,0,
+34,1,0,0,28,2,0,0,9,1,0,2,30,5,2,62,
+32,32,32,32,105,116,101,109,115,32,61,32,116,46,105,116,
+101,109,115,0,12,4,0,5,105,116,101,109,115,0,0,0,
+9,3,1,4,15,2,3,0,30,5,2,63,32,32,32,32,
+116,32,61,32,103,101,116,95,116,97,103,40,41,0,0,0,
+12,5,0,7,103,101,116,95,116,97,103,0,13,4,5,0,
+31,3,0,0,19,3,4,3,15,1,3,0,30,6,2,64,
+32,32,32,32,115,101,116,106,109,112,40,116,44,39,101,120,
+99,101,112,116,39,41,0,0,12,5,0,6,115,101,116,106,
+109,112,0,0,13,4,5,0,15,5,1,0,12,6,0,6,
+101,120,99,101,112,116,0,0,31,3,5,2,19,3,4,3,
+30,8,2,65,32,32,32,32,102,114,101,101,95,116,109,112,
+40,100,111,40,105,116,101,109,115,91,48,93,41,41,32,35,
+82,69,71,0,12,5,0,8,102,114,101,101,95,116,109,112,
+0,0,0,0,13,4,5,0,12,7,0,2,100,111,0,0,
+13,6,7,0,11,8,0,0,0,0,0,0,0,0,0,0,
+9,7,2,8,31,5,7,1,19,5,6,5,31,3,5,1,
+19,3,4,3,30,5,2,66,32,32,32,32,99,111,100,101,
+40,83,69,84,74,77,80,44,48,41,0,0,12,5,0,4,
+99,111,100,101,0,0,0,0,13,4,5,0,12,7,0,6,
+83,69,84,74,77,80,0,0,13,5,7,0,11,6,0,0,
+0,0,0,0,0,0,0,0,31,3,5,2,19,3,4,3,
+30,5,2,67,32,32,32,32,106,117,109,112,40,116,44,39,
+101,110,100,39,41,0,0,0,12,5,0,4,106,117,109,112,
+0,0,0,0,13,4,5,0,15,5,1,0,12,6,0,3,
+101,110,100,0,31,3,5,2,19,3,4,3,30,5,2,68,
+32,32,32,32,116,97,103,40,116,44,39,101,120,99,101,112,
+116,39,41,0,12,5,0,3,116,97,103,0,13,4,5,0,
+15,5,1,0,12,6,0,6,101,120,99,101,112,116,0,0,
+31,3,5,2,19,3,4,3,30,11,2,69,32,32,32,32,
+102,114,101,101,95,116,109,112,40,100,111,40,105,116,101,109,
+115,91,49,93,46,105,116,101,109,115,91,49,93,41,41,32,
+35,82,69,71,0,0,0,0,12,5,0,8,102,114,101,101,
+95,116,109,112,0,0,0,0,13,4,5,0,12,7,0,2,
+100,111,0,0,13,6,7,0,11,8,0,0,0,0,0,0,
+0,0,240,63,9,7,2,8,12,8,0,5,105,116,101,109,
+115,0,0,0,9,7,7,8,11,8,0,0,0,0,0,0,
+0,0,240,63,9,7,7,8,31,5,7,1,19,5,6,5,
+31,3,5,1,19,3,4,3,30,5,2,70,32,32,32,32,
+116,97,103,40,116,44,39,101,110,100,39,41,0,0,0,0,
+12,5,0,3,116,97,103,0,13,4,5,0,15,5,1,0,
+12,6,0,3,101,110,100,0,31,3,5,2,19,3,4,3,
+0,0,0,0,12,55,0,6,100,111,95,116,114,121,0,0,
+14,55,54,0,30,5,2,72,100,101,102,32,100,111,95,114,
+101,116,117,114,110,40,116,41,58,0,0,0,16,55,0,105,
+44,8,0,0,30,5,2,72,100,101,102,32,100,111,95,114,
+101,116,117,114,110,40,116,41,58,0,0,0,12,1,0,9,
+101,110,99,111,100,101,46,112,121,0,0,0,33,1,0,0,
+12,1,0,9,100,111,95,114,101,116,117,114,110,0,0,0,
+34,1,0,0,28,2,0,0,9,1,0,2,30,9,2,73,
+32,32,32,32,105,102,32,116,46,105,116,101,109,115,58,32,
+114,32,61,32,100,111,40,116,46,105,116,101,109,115,91,48,
+93,41,0,0,12,3,0,5,105,116,101,109,115,0,0,0,
+9,2,1,3,21,2,0,0,18,0,0,16,12,5,0,2,
+100,111,0,0,13,4,5,0,12,6,0,5,105,116,101,109,
+115,0,0,0,9,5,1,6,11,6,0,0,0,0,0,0,
+0,0,0,0,9,5,5,6,31,3,5,1,19,3,4,3,
+15,2,3,0,18,0,0,18,30,7,2,74,32,32,32,32,
+101,108,115,101,58,32,114,32,61,32,95,100,111,95,110,111,
+110,101,40,41,0,0,0,0,12,5,0,8,95,100,111,95,
+110,111,110,101,0,0,0,0,13,4,5,0,31,3,0,0,
+19,3,4,3,15,2,3,0,18,0,0,1,30,5,2,75,
+32,32,32,32,99,111,100,101,40,82,69,84,85,82,78,44,
+114,41,0,0,12,5,0,4,99,111,100,101,0,0,0,0,
+13,4,5,0,12,7,0,6,82,69,84,85,82,78,0,0,
+13,5,7,0,15,6,2,0,31,3,5,2,19,3,4,3,
+30,4,2,76,32,32,32,32,102,114,101,101,95,116,109,112,
+40,114,41,0,12,5,0,8,102,114,101,101,95,116,109,112,
+0,0,0,0,13,4,5,0,15,5,2,0,31,3,5,1,
+19,3,4,3,30,3,2,77,32,32,32,32,114,101,116,117,
+114,110,0,0,28,3,0,0,20,3,0,0,0,0,0,0,
+12,56,0,9,100,111,95,114,101,116,117,114,110,0,0,0,
+14,56,55,0,30,5,2,78,100,101,102,32,100,111,95,114,
+97,105,115,101,40,116,41,58,0,0,0,0,16,56,0,105,
+44,8,0,0,30,5,2,78,100,101,102,32,100,111,95,114,
+97,105,115,101,40,116,41,58,0,0,0,0,12,1,0,9,
+101,110,99,111,100,101,46,112,121,0,0,0,33,1,0,0,
+12,1,0,8,100,111,95,114,97,105,115,101,0,0,0,0,
+34,1,0,0,28,2,0,0,9,1,0,2,30,9,2,79,
+32,32,32,32,105,102,32,116,46,105,116,101,109,115,58,32,
+114,32,61,32,100,111,40,116,46,105,116,101,109,115,91,48,
+93,41,0,0,12,3,0,5,105,116,101,109,115,0,0,0,
+9,2,1,3,21,2,0,0,18,0,0,16,12,5,0,2,
+100,111,0,0,13,4,5,0,12,6,0,5,105,116,101,109,
+115,0,0,0,9,5,1,6,11,6,0,0,0,0,0,0,
+0,0,0,0,9,5,5,6,31,3,5,1,19,3,4,3,
+15,2,3,0,18,0,0,18,30,7,2,80,32,32,32,32,
+101,108,115,101,58,32,114,32,61,32,95,100,111,95,110,111,
+110,101,40,41,0,0,0,0,12,5,0,8,95,100,111,95,
+110,111,110,101,0,0,0,0,13,4,5,0,31,3,0,0,
+19,3,4,3,15,2,3,0,18,0,0,1,30,5,2,81,
+32,32,32,32,99,111,100,101,40,82,65,73,83,69,44,114,
+41,0,0,0,12,5,0,4,99,111,100,101,0,0,0,0,
+13,4,5,0,12,7,0,5,82,65,73,83,69,0,0,0,
+13,5,7,0,15,6,2,0,31,3,5,2,19,3,4,3,
+30,4,2,82,32,32,32,32,102,114,101,101,95,116,109,112,
+40,114,41,0,12,5,0,8,102,114,101,101,95,116,109,112,
+0,0,0,0,13,4,5,0,15,5,2,0,31,3,5,1,
+19,3,4,3,30,3,2,83,32,32,32,32,114,101,116,117,
+114,110,0,0,28,3,0,0,20,3,0,0,0,0,0,0,
+12,57,0,8,100,111,95,114,97,105,115,101,0,0,0,0,
+14,57,56,0,30,6,2,85,100,101,102,32,100,111,95,115,
+116,97,116,101,109,101,110,116,115,40,116,41,58,0,0,0,
+16,57,0,57,44,10,0,0,30,6,2,85,100,101,102,32,
+100,111,95,115,116,97,116,101,109,101,110,116,115,40,116,41,
+58,0,0,0,12,1,0,9,101,110,99,111,100,101,46,112,
+121,0,0,0,33,1,0,0,12,1,0,13,100,111,95,115,
+116,97,116,101,109,101,110,116,115,0,0,0,34,1,0,0,
+28,2,0,0,9,1,0,2,30,10,2,86,32,32,32,32,
+102,111,114,32,116,116,32,105,110,32,116,46,105,116,101,109,
+115,58,32,102,114,101,101,95,116,109,112,40,100,111,40,116,
+116,41,41,0,12,4,0,5,105,116,101,109,115,0,0,0,
+9,3,1,4,11,4,0,0,0,0,0,0,0,0,0,0,
+42,2,3,4,18,0,0,15,12,7,0,8,102,114,101,101,
+95,116,109,112,0,0,0,0,13,6,7,0,12,9,0,2,
+100,111,0,0,13,8,9,0,15,9,2,0,31,7,9,1,
+19,7,8,7,31,5,7,1,19,5,6,5,18,0,255,241,
+0,0,0,0,12,58,0,13,100,111,95,115,116,97,116,101,
+109,101,110,116,115,0,0,0,14,58,57,0,30,6,2,88,
+100,101,102,32,100,111,95,108,105,115,116,40,116,44,114,61,
+78,111,110,101,41,58,0,0,16,58,0,69,44,9,0,0,
+30,6,2,88,100,101,102,32,100,111,95,108,105,115,116,40,
+116,44,114,61,78,111,110,101,41,58,0,0,12,1,0,9,
+101,110,99,111,100,101,46,112,121,0,0,0,33,1,0,0,
+12,1,0,7,100,111,95,108,105,115,116,0,34,1,0,0,
+28,2,0,0,9,1,0,2,28,2,0,0,28,3,0,0,
+32,2,0,3,30,5,2,89,32,32,32,32,114,32,61,32,
+103,101,116,95,116,109,112,40,114,41,0,0,12,5,0,7,
+103,101,116,95,116,109,112,0,13,4,5,0,15,5,2,0,
+31,3,5,1,19,3,4,3,15,2,3,0,30,8,2,90,
+32,32,32,32,109,97,110,97,103,101,95,115,101,113,40,76,
+73,83,84,44,114,44,116,46,105,116,101,109,115,41,0,0,
+12,5,0,10,109,97,110,97,103,101,95,115,101,113,0,0,
+13,4,5,0,12,8,0,4,76,73,83,84,0,0,0,0,
+13,5,8,0,15,6,2,0,12,8,0,5,105,116,101,109,
+115,0,0,0,9,7,1,8,31,3,5,3,19,3,4,3,
+30,4,2,91,32,32,32,32,114,101,116,117,114,110,32,114,
+0,0,0,0,20,2,0,0,0,0,0,0,12,59,0,7,
+100,111,95,108,105,115,116,0,14,59,58,0,30,6,2,93,
+100,101,102,32,100,111,95,100,105,99,116,40,116,44,114,61,
+78,111,110,101,41,58,0,0,16,59,0,69,44,9,0,0,
+30,6,2,93,100,101,102,32,100,111,95,100,105,99,116,40,
+116,44,114,61,78,111,110,101,41,58,0,0,12,1,0,9,
+101,110,99,111,100,101,46,112,121,0,0,0,33,1,0,0,
+12,1,0,7,100,111,95,100,105,99,116,0,34,1,0,0,
+28,2,0,0,9,1,0,2,28,2,0,0,28,3,0,0,
+32,2,0,3,30,5,2,94,32,32,32,32,114,32,61,32,
+103,101,116,95,116,109,112,40,114,41,0,0,12,5,0,7,
+103,101,116,95,116,109,112,0,13,4,5,0,15,5,2,0,
+31,3,5,1,19,3,4,3,15,2,3,0,30,8,2,95,
+32,32,32,32,109,97,110,97,103,101,95,115,101,113,40,68,
+73,67,84,44,114,44,116,46,105,116,101,109,115,41,0,0,
+12,5,0,10,109,97,110,97,103,101,95,115,101,113,0,0,
+13,4,5,0,12,8,0,4,68,73,67,84,0,0,0,0,
+13,5,8,0,15,6,2,0,12,8,0,5,105,116,101,109,
+115,0,0,0,9,7,1,8,31,3,5,3,19,3,4,3,
+30,4,2,96,32,32,32,32,114,101,116,117,114,110,32,114,
+0,0,0,0,20,2,0,0,0,0,0,0,12,60,0,7,
+100,111,95,100,105,99,116,0,14,60,59,0,30,6,2,98,
+100,101,102,32,100,111,95,103,101,116,40,116,44,114,61,78,
+111,110,101,41,58,0,0,0,16,60,0,66,44,11,0,0,
+30,6,2,98,100,101,102,32,100,111,95,103,101,116,40,116,
+44,114,61,78,111,110,101,41,58,0,0,0,12,1,0,9,
+101,110,99,111,100,101,46,112,121,0,0,0,33,1,0,0,
+12,1,0,6,100,111,95,103,101,116,0,0,34,1,0,0,
+28,2,0,0,9,1,0,2,28,2,0,0,28,3,0,0,
+32,2,0,3,30,5,2,99,32,32,32,32,105,116,101,109,
+115,32,61,32,116,46,105,116,101,109,115,0,12,5,0,5,
+105,116,101,109,115,0,0,0,9,4,1,5,15,3,4,0,
+30,11,2,100,32,32,32,32,114,101,116,117,114,110,32,105,
+110,102,105,120,40,71,69,84,44,105,116,101,109,115,91,48,
+93,44,105,116,101,109,115,91,49,93,44,114,41,0,0,0,
+12,6,0,5,105,110,102,105,120,0,0,0,13,5,6,0,
+12,10,0,3,71,69,84,0,13,6,10,0,11,10,0,0,
+0,0,0,0,0,0,0,0,9,7,3,10,11,10,0,0,
+0,0,0,0,0,0,240,63,9,8,3,10,15,9,2,0,
+31,4,6,4,19,4,5,4,20,4,0,0,0,0,0,0,
+12,61,0,6,100,111,95,103,101,116,0,0,14,61,60,0,
+30,11,2,102,100,101,102,32,100,111,95,98,114,101,97,107,
+40,116,41,58,32,106,117,109,112,40,68,46,116,115,116,97,
+99,107,91,45,49,93,44,39,98,114,101,97,107,39,41,0,
+16,61,0,47,44,7,0,0,30,11,2,102,100,101,102,32,
+100,111,95,98,114,101,97,107,40,116,41,58,32,106,117,109,
+112,40,68,46,116,115,116,97,99,107,91,45,49,93,44,39,
+98,114,101,97,107,39,41,0,12,1,0,9,101,110,99,111,
+100,101,46,112,121,0,0,0,33,1,0,0,12,1,0,8,
+100,111,95,98,114,101,97,107,0,0,0,0,34,1,0,0,
+28,2,0,0,9,1,0,2,12,4,0,4,106,117,109,112,
+0,0,0,0,13,3,4,0,12,6,0,1,68,0,0,0,
+13,4,6,0,12,6,0,6,116,115,116,97,99,107,0,0,
+9,4,4,6,11,6,0,0,0,0,0,0,0,0,240,191,
+9,4,4,6,12,5,0,5,98,114,101,97,107,0,0,0,
+31,2,4,2,19,2,3,2,0,0,0,0,12,62,0,8,
+100,111,95,98,114,101,97,107,0,0,0,0,14,62,61,0,
+30,13,2,103,100,101,102,32,100,111,95,99,111,110,116,105,
+110,117,101,40,116,41,58,32,106,117,109,112,40,68,46,116,
+115,116,97,99,107,91,45,49,93,44,39,99,111,110,116,105,
+110,117,101,39,41,0,0,0,16,62,0,50,44,7,0,0,
+30,13,2,103,100,101,102,32,100,111,95,99,111,110,116,105,
+110,117,101,40,116,41,58,32,106,117,109,112,40,68,46,116,
+115,116,97,99,107,91,45,49,93,44,39,99,111,110,116,105,
+110,117,101,39,41,0,0,0,12,1,0,9,101,110,99,111,
+100,101,46,112,121,0,0,0,33,1,0,0,12,1,0,11,
+100,111,95,99,111,110,116,105,110,117,101,0,34,1,0,0,
+28,2,0,0,9,1,0,2,12,4,0,4,106,117,109,112,
+0,0,0,0,13,3,4,0,12,6,0,1,68,0,0,0,
+13,4,6,0,12,6,0,6,116,115,116,97,99,107,0,0,
+9,4,4,6,11,6,0,0,0,0,0,0,0,0,240,191,
+9,4,4,6,12,5,0,8,99,111,110,116,105,110,117,101,
+0,0,0,0,31,2,4,2,19,2,3,2,0,0,0,0,
+12,63,0,11,100,111,95,99,111,110,116,105,110,117,101,0,
+14,63,62,0,30,7,2,104,100,101,102,32,100,111,95,112,
+97,115,115,40,116,41,58,32,99,111,100,101,40,80,65,83,
+83,41,0,0,16,63,0,32,44,6,0,0,30,7,2,104,
+100,101,102,32,100,111,95,112,97,115,115,40,116,41,58,32,
+99,111,100,101,40,80,65,83,83,41,0,0,12,1,0,9,
+101,110,99,111,100,101,46,112,121,0,0,0,33,1,0,0,
+12,1,0,7,100,111,95,112,97,115,115,0,34,1,0,0,
+28,2,0,0,9,1,0,2,12,4,0,4,99,111,100,101,
+0,0,0,0,13,3,4,0,12,5,0,4,80,65,83,83,
+0,0,0,0,13,4,5,0,31,2,4,1,19,2,3,2,
+0,0,0,0,12,64,0,7,100,111,95,112,97,115,115,0,
+14,64,63,0,30,6,2,106,100,101,102,32,100,111,95,105,
+110,102,111,40,110,97,109,101,61,39,63,39,41,58,0,0,
+16,64,0,126,44,11,0,0,30,6,2,106,100,101,102,32,
+100,111,95,105,110,102,111,40,110,97,109,101,61,39,63,39,
+41,58,0,0,12,1,0,9,101,110,99,111,100,101,46,112,
+121,0,0,0,33,1,0,0,12,1,0,7,100,111,95,105,
+110,102,111,0,34,1,0,0,12,1,0,1,63,0,0,0,
+28,2,0,0,32,1,0,2,30,8,2,107,32,32,32,32,
+105,102,32,39,45,110,111,112,111,115,39,32,105,110,32,65,
+82,71,86,58,32,114,101,116,117,114,110,0,12,3,0,4,
+65,82,71,86,0,0,0,0,13,2,3,0,12,3,0,6,
+45,110,111,112,111,115,0,0,36,2,2,3,21,2,0,0,
+18,0,0,4,28,2,0,0,20,2,0,0,18,0,0,1,
+30,12,2,108,32,32,32,32,99,111,100,101,40,70,73,76,
+69,44,102,114,101,101,95,116,109,112,40,95,100,111,95,115,
+116,114,105,110,103,40,68,46,102,110,97,109,101,41,41,41,
+0,0,0,0,12,4,0,4,99,111,100,101,0,0,0,0,
+13,3,4,0,12,6,0,4,70,73,76,69,0,0,0,0,
+13,4,6,0,12,7,0,8,102,114,101,101,95,116,109,112,
+0,0,0,0,13,6,7,0,12,9,0,10,95,100,111,95,
+115,116,114,105,110,103,0,0,13,8,9,0,12,10,0,1,
+68,0,0,0,13,9,10,0,12,10,0,5,102,110,97,109,
+101,0,0,0,9,9,9,10,31,7,9,1,19,7,8,7,
+31,5,7,1,19,5,6,5,31,2,4,2,19,2,3,2,
+30,11,2,109,32,32,32,32,99,111,100,101,40,78,65,77,
+69,44,102,114,101,101,95,116,109,112,40,95,100,111,95,115,
+116,114,105,110,103,40,110,97,109,101,41,41,41,0,0,0,
+12,4,0,4,99,111,100,101,0,0,0,0,13,3,4,0,
+12,6,0,4,78,65,77,69,0,0,0,0,13,4,6,0,
+12,7,0,8,102,114,101,101,95,116,109,112,0,0,0,0,
+13,6,7,0,12,9,0,10,95,100,111,95,115,116,114,105,
+110,103,0,0,13,8,9,0,15,9,1,0,31,7,9,1,
+19,7,8,7,31,5,7,1,19,5,6,5,31,2,4,2,
+19,2,3,2,0,0,0,0,12,65,0,7,100,111,95,105,
+110,102,111,0,14,65,64,0,30,5,2,110,100,101,102,32,
+100,111,95,109,111,100,117,108,101,40,116,41,58,0,0,0,
+16,65,0,62,44,8,0,0,30,5,2,110,100,101,102,32,
+100,111,95,109,111,100,117,108,101,40,116,41,58,0,0,0,
+12,1,0,9,101,110,99,111,100,101,46,112,121,0,0,0,
+33,1,0,0,12,1,0,9,100,111,95,109,111,100,117,108,
+101,0,0,0,34,1,0,0,28,2,0,0,9,1,0,2,
+30,4,2,111,32,32,32,32,100,111,95,105,110,102,111,40,
+41,0,0,0,12,4,0,7,100,111,95,105,110,102,111,0,
+13,3,4,0,31,2,0,0,19,2,3,2,30,9,2,112,
+32,32,32,32,102,114,101,101,95,116,109,112,40,100,111,40,
+116,46,105,116,101,109,115,91,48,93,41,41,32,35,82,69,
+71,0,0,0,12,4,0,8,102,114,101,101,95,116,109,112,
+0,0,0,0,13,3,4,0,12,6,0,2,100,111,0,0,
+13,5,6,0,12,7,0,5,105,116,101,109,115,0,0,0,
+9,6,1,7,11,7,0,0,0,0,0,0,0,0,0,0,
+9,6,6,7,31,4,6,1,19,4,5,4,31,2,4,1,
+19,2,3,2,0,0,0,0,12,66,0,9,100,111,95,109,
+111,100,117,108,101,0,0,0,14,66,65,0,30,9,2,113,
+100,101,102,32,100,111,95,114,101,103,40,116,44,114,61,78,
+111,110,101,41,58,32,114,101,116,117,114,110,32,116,46,118,
+97,108,0,0,16,66,0,31,44,5,0,0,30,9,2,113,
+100,101,102,32,100,111,95,114,101,103,40,116,44,114,61,78,
+111,110,101,41,58,32,114,101,116,117,114,110,32,116,46,118,
+97,108,0,0,12,1,0,9,101,110,99,111,100,101,46,112,
+121,0,0,0,33,1,0,0,12,1,0,6,100,111,95,114,
+101,103,0,0,34,1,0,0,28,2,0,0,9,1,0,2,
+28,2,0,0,28,3,0,0,32,2,0,3,12,4,0,3,
+118,97,108,0,9,3,1,4,20,3,0,0,0,0,0,0,
+12,67,0,6,100,111,95,114,101,103,0,0,14,67,66,0,
+30,3,2,115,102,109,97,112,32,61,32,123,0,0,0,0,
+12,67,0,4,102,109,97,112,0,0,0,0,30,16,2,116,
+32,32,32,32,39,109,111,100,117,108,101,39,58,100,111,95,
+109,111,100,117,108,101,44,39,115,116,97,116,101,109,101,110,
+116,115,39,58,100,111,95,115,116,97,116,101,109,101,110,116,
+115,44,39,100,101,102,39,58,100,111,95,100,101,102,44,0,
+12,69,0,6,109,111,100,117,108,101,0,0,12,103,0,9,
+100,111,95,109,111,100,117,108,101,0,0,0,13,70,103,0,
+12,71,0,10,115,116,97,116,101,109,101,110,116,115,0,0,
+12,103,0,13,100,111,95,115,116,97,116,101,109,101,110,116,
+115,0,0,0,13,72,103,0,12,73,0,3,100,101,102,0,
+12,103,0,6,100,111,95,100,101,102,0,0,13,74,103,0,
+30,13,2,117,32,32,32,32,39,114,101,116,117,114,110,39,
+58,100,111,95,114,101,116,117,114,110,44,39,119,104,105,108,
+101,39,58,100,111,95,119,104,105,108,101,44,39,105,102,39,
+58,100,111,95,105,102,44,0,12,75,0,6,114,101,116,117,
+114,110,0,0,12,103,0,9,100,111,95,114,101,116,117,114,
+110,0,0,0,13,76,103,0,12,77,0,5,119,104,105,108,
+101,0,0,0,12,103,0,8,100,111,95,119,104,105,108,101,
+0,0,0,0,13,78,103,0,12,79,0,2,105,102,0,0,
+12,103,0,5,100,111,95,105,102,0,0,0,13,80,103,0,
+30,19,2,118,32,32,32,32,39,98,114,101,97,107,39,58,
+100,111,95,98,114,101,97,107,44,39,112,97,115,115,39,58,
+100,111,95,112,97,115,115,44,39,99,111,110,116,105,110,117,
+101,39,58,100,111,95,99,111,110,116,105,110,117,101,44,39,
+102,111,114,39,58,100,111,95,102,111,114,44,0,0,0,0,
+12,81,0,5,98,114,101,97,107,0,0,0,12,103,0,8,
+100,111,95,98,114,101,97,107,0,0,0,0,13,82,103,0,
+12,83,0,4,112,97,115,115,0,0,0,0,12,103,0,7,
+100,111,95,112,97,115,115,0,13,84,103,0,12,85,0,8,
+99,111,110,116,105,110,117,101,0,0,0,0,12,103,0,11,
+100,111,95,99,111,110,116,105,110,117,101,0,13,86,103,0,
+12,87,0,3,102,111,114,0,12,103,0,6,100,111,95,102,
+111,114,0,0,13,88,103,0,30,18,2,119,32,32,32,32,
+39,99,108,97,115,115,39,58,100,111,95,99,108,97,115,115,
+44,39,114,97,105,115,101,39,58,100,111,95,114,97,105,115,
+101,44,39,116,114,121,39,58,100,111,95,116,114,121,44,39,
+105,109,112,111,114,116,39,58,100,111,95,105,109,112,111,114,
+116,44,0,0,12,89,0,5,99,108,97,115,115,0,0,0,
+12,103,0,8,100,111,95,99,108,97,115,115,0,0,0,0,
+13,90,103,0,12,91,0,5,114,97,105,115,101,0,0,0,
+12,103,0,8,100,111,95,114,97,105,115,101,0,0,0,0,
+13,92,103,0,12,93,0,3,116,114,121,0,12,103,0,6,
+100,111,95,116,114,121,0,0,13,94,103,0,12,95,0,6,
+105,109,112,111,114,116,0,0,12,103,0,9,100,111,95,105,
+109,112,111,114,116,0,0,0,13,96,103,0,30,14,2,120,
+32,32,32,32,39,103,108,111,98,97,108,115,39,58,100,111,
+95,103,108,111,98,97,108,115,44,39,100,101,108,39,58,100,
+111,95,100,101,108,44,39,102,114,111,109,39,58,100,111,95,
+102,114,111,109,44,0,0,0,12,97,0,7,103,108,111,98,
+97,108,115,0,12,103,0,10,100,111,95,103,108,111,98,97,
+108,115,0,0,13,98,103,0,12,99,0,3,100,101,108,0,
+12,103,0,6,100,111,95,100,101,108,0,0,13,100,103,0,
+12,101,0,4,102,114,111,109,0,0,0,0,12,103,0,7,
+100,111,95,102,114,111,109,0,13,102,103,0,26,68,69,34,
+14,67,68,0,30,3,2,122,114,109,97,112,32,61,32,123,
+0,0,0,0,12,67,0,4,114,109,97,112,0,0,0,0,
+30,18,2,123,32,32,32,32,39,108,105,115,116,39,58,100,
+111,95,108,105,115,116,44,32,39,116,117,112,108,101,39,58,
+100,111,95,108,105,115,116,44,32,39,100,105,99,116,39,58,
+100,111,95,100,105,99,116,44,32,39,115,108,105,99,101,39,
+58,100,111,95,108,105,115,116,44,0,0,0,12,69,0,4,
+108,105,115,116,0,0,0,0,12,93,0,7,100,111,95,108,
+105,115,116,0,13,70,93,0,12,71,0,5,116,117,112,108,
+101,0,0,0,12,93,0,7,100,111,95,108,105,115,116,0,
+13,72,93,0,12,73,0,4,100,105,99,116,0,0,0,0,
+12,93,0,7,100,111,95,100,105,99,116,0,13,74,93,0,
+12,75,0,5,115,108,105,99,101,0,0,0,12,93,0,7,
+100,111,95,108,105,115,116,0,13,76,93,0,30,19,2,124,
+32,32,32,32,39,99,111,109,112,39,58,100,111,95,99,111,
+109,112,44,32,39,110,97,109,101,39,58,100,111,95,110,97,
+109,101,44,39,115,121,109,98,111,108,39,58,100,111,95,115,
+121,109,98,111,108,44,39,110,117,109,98,101,114,39,58,100,
+111,95,110,117,109,98,101,114,44,0,0,0,12,77,0,4,
+99,111,109,112,0,0,0,0,12,93,0,7,100,111,95,99,
+111,109,112,0,13,78,93,0,12,79,0,4,110,97,109,101,
+0,0,0,0,12,93,0,7,100,111,95,110,97,109,101,0,
+13,80,93,0,12,81,0,6,115,121,109,98,111,108,0,0,
+12,93,0,9,100,111,95,115,121,109,98,111,108,0,0,0,
+13,82,93,0,12,83,0,6,110,117,109,98,101,114,0,0,
+12,93,0,9,100,111,95,110,117,109,98,101,114,0,0,0,
+13,84,93,0,30,17,2,125,32,32,32,32,39,115,116,114,
+105,110,103,39,58,100,111,95,115,116,114,105,110,103,44,39,
+103,101,116,39,58,100,111,95,103,101,116,44,32,39,99,97,
+108,108,39,58,100,111,95,99,97,108,108,44,32,39,114,101,
+103,39,58,100,111,95,114,101,103,44,0,0,12,85,0,6,
+115,116,114,105,110,103,0,0,12,93,0,9,100,111,95,115,
+116,114,105,110,103,0,0,0,13,86,93,0,12,87,0,3,
+103,101,116,0,12,93,0,6,100,111,95,103,101,116,0,0,
+13,88,93,0,12,89,0,4,99,97,108,108,0,0,0,0,
+12,93,0,7,100,111,95,99,97,108,108,0,13,90,93,0,
+12,91,0,3,114,101,103,0,12,93,0,6,100,111,95,114,
+101,103,0,0,13,92,93,0,26,68,69,24,14,67,68,0,
+30,5,2,128,100,101,102,32,100,111,40,116,44,114,61,78,
+111,110,101,41,58,0,0,0,16,67,0,197,44,9,0,0,
+30,5,2,128,100,101,102,32,100,111,40,116,44,114,61,78,
+111,110,101,41,58,0,0,0,12,1,0,9,101,110,99,111,
+100,101,46,112,121,0,0,0,33,1,0,0,12,1,0,2,
+100,111,0,0,34,1,0,0,28,2,0,0,9,1,0,2,
+28,2,0,0,28,3,0,0,32,2,0,3,30,7,2,129,
+32,32,32,32,105,102,32,116,46,112,111,115,58,32,115,101,
+116,112,111,115,40,116,46,112,111,115,41,0,12,4,0,3,
+112,111,115,0,9,3,1,4,21,3,0,0,18,0,0,11,
+12,5,0,6,115,101,116,112,111,115,0,0,13,4,5,0,
+12,6,0,3,112,111,115,0,9,5,1,6,31,3,5,1,
+19,3,4,3,18,0,0,1,30,3,2,130,32,32,32,32,
+116,114,121,58,0,0,0,0,38,0,0,70,30,7,2,131,
+32,32,32,32,32,32,32,32,105,102,32,116,46,116,121,112,
+101,32,105,110,32,114,109,97,112,58,0,0,12,4,0,4,
+114,109,97,112,0,0,0,0,13,3,4,0,12,5,0,4,
+116,121,112,101,0,0,0,0,9,4,1,5,36,3,3,4,
+21,3,0,0,18,0,0,27,30,10,2,132,32,32,32,32,
+32,32,32,32,32,32,32,32,114,101,116,117,114,110,32,114,
+109,97,112,91,116,46,116,121,112,101,93,40,116,44,114,41,
+0,0,0,0,12,5,0,4,114,109,97,112,0,0,0,0,
+13,4,5,0,12,6,0,4,116,121,112,101,0,0,0,0,
+9,5,1,6,9,4,4,5,15,5,1,0,15,6,2,0,
+31,3,5,2,19,3,4,3,20,3,0,0,18,0,0,1,
+30,8,2,134,32,32,32,32,32,32,32,32,114,101,116,117,
+114,110,32,102,109,97,112,91,116,46,116,121,112,101,93,40,
+116,41,0,0,12,5,0,4,102,109,97,112,0,0,0,0,
+13,4,5,0,12,6,0,4,116,121,112,101,0,0,0,0,
+9,5,1,6,9,4,4,5,15,5,1,0,31,3,5,1,
+19,3,4,3,20,3,0,0,38,0,0,0,18,0,0,79,
+30,3,2,135,32,32,32,32,101,120,99,101,112,116,58,0,
+30,7,2,136,32,32,32,32,32,32,32,32,105,102,32,68,
+46,101,114,114,111,114,58,32,114,97,105,115,101,0,0,0,
+12,4,0,1,68,0,0,0,13,3,4,0,12,4,0,5,
+101,114,114,111,114,0,0,0,9,3,3,4,21,3,0,0,
+18,0,0,4,28,3,0,0,37,3,0,0,18,0,0,1,
+30,6,2,137,32,32,32,32,32,32,32,32,68,46,101,114,
+114,111,114,32,61,32,84,114,117,101,0,0,12,4,0,1,
+68,0,0,0,13,3,4,0,11,4,0,0,0,0,0,0,
+0,0,240,63,12,5,0,5,101,114,114,111,114,0,0,0,
+10,3,5,4,30,12,2,138,32,32,32,32,32,32,32,32,
+116,111,107,101,110,105,122,101,46,117,95,101,114,114,111,114,
+40,39,101,110,99,111,100,101,39,44,68,46,99,111,100,101,
+44,116,46,112,111,115,41,0,12,5,0,8,116,111,107,101,
+110,105,122,101,0,0,0,0,13,4,5,0,12,5,0,7,
+117,95,101,114,114,111,114,0,9,4,4,5,12,5,0,6,
+101,110,99,111,100,101,0,0,12,8,0,1,68,0,0,0,
+13,6,8,0,12,8,0,4,99,111,100,101,0,0,0,0,
+9,6,6,8,12,8,0,3,112,111,115,0,9,7,1,8,
+31,3,5,3,19,3,4,3,0,0,0,0,12,68,0,2,
+100,111,0,0,14,68,67,0,30,6,2,140,100,101,102,32,
+101,110,99,111,100,101,40,102,110,97,109,101,44,115,44,116,
+41,58,0,0,16,68,0,191,44,12,0,0,30,6,2,140,
+100,101,102,32,101,110,99,111,100,101,40,102,110,97,109,101,
+44,115,44,116,41,58,0,0,12,1,0,9,101,110,99,111,
+100,101,46,112,121,0,0,0,33,1,0,0,12,1,0,6,
+101,110,99,111,100,101,0,0,34,1,0,0,28,2,0,0,
+9,1,0,2,28,3,0,0,9,2,0,3,28,4,0,0,
+9,3,0,4,30,11,2,141,32,32,32,32,116,32,61,32,
+84,111,107,101,110,40,40,49,44,49,41,44,39,109,111,100,
+117,108,101,39,44,39,109,111,100,117,108,101,39,44,91,116,
+93,41,0,0,12,6,0,5,84,111,107,101,110,0,0,0,
+13,5,6,0,11,10,0,0,0,0,0,0,0,0,240,63,
+11,11,0,0,0,0,0,0,0,0,240,63,27,6,10,2,
+12,7,0,6,109,111,100,117,108,101,0,0,12,8,0,6,
+109,111,100,117,108,101,0,0,15,10,3,0,27,9,10,1,
+31,4,6,4,19,4,5,4,15,3,4,0,30,4,2,142,
+32,32,32,32,103,108,111,98,97,108,32,68,0,0,0,0,
+30,7,2,143,32,32,32,32,115,32,61,32,116,111,107,101,
+110,105,122,101,46,99,108,101,97,110,40,115,41,0,0,0,
+12,6,0,8,116,111,107,101,110,105,122,101,0,0,0,0,
+13,5,6,0,12,6,0,5,99,108,101,97,110,0,0,0,
+9,5,5,6,15,6,2,0,31,4,6,1,19,4,5,4,
+15,2,4,0,30,6,2,144,32,32,32,32,68,32,61,32,
+68,83,116,97,116,101,40,115,44,102,110,97,109,101,41,0,
+12,4,0,1,68,0,0,0,12,7,0,6,68,83,116,97,
+116,101,0,0,13,6,7,0,15,7,2,0,15,8,1,0,
+31,5,7,2,19,5,6,5,14,4,5,0,30,5,2,145,
+32,32,32,32,68,46,98,101,103,105,110,40,84,114,117,101,
+41,0,0,0,12,6,0,1,68,0,0,0,13,5,6,0,
+12,6,0,5,98,101,103,105,110,0,0,0,9,5,5,6,
+11,6,0,0,0,0,0,0,0,0,240,63,31,4,6,1,
+19,4,5,4,30,3,2,146,32,32,32,32,100,111,40,116,
+41,0,0,0,12,6,0,2,100,111,0,0,13,5,6,0,
+15,6,3,0,31,4,6,1,19,4,5,4,30,3,2,147,
+32,32,32,32,68,46,101,110,100,40,41,0,12,6,0,1,
+68,0,0,0,13,5,6,0,12,6,0,3,101,110,100,0,
+9,5,5,6,31,4,0,0,19,4,5,4,30,4,2,148,
+32,32,32,32,109,97,112,95,116,97,103,115,40,41,0,0,
+12,6,0,8,109,97,112,95,116,97,103,115,0,0,0,0,
+13,5,6,0,31,4,0,0,19,4,5,4,30,7,2,149,
+32,32,32,32,111,117,116,32,61,32,68,46,111,117,116,59,
+32,68,32,61,32,78,111,110,101,0,0,0,12,6,0,1,
+68,0,0,0,13,5,6,0,12,6,0,3,111,117,116,0,
+9,5,5,6,15,4,5,0,12,5,0,1,68,0,0,0,
+28,6,0,0,14,5,6,0,30,6,2,150,32,32,32,32,
+114,101,116,117,114,110,32,39,39,46,106,111,105,110,40,111,
+117,116,41,0,12,6,0,0,0,0,0,0,12,7,0,4,
+106,111,105,110,0,0,0,0,9,6,6,7,15,7,4,0,
+31,5,7,1,19,5,6,5,20,5,0,0,0,0,0,0,
+12,69,0,6,101,110,99,111,100,101,0,0,14,69,68,0,
+0,0,0,0,
+};
+unsigned char tp_py2bc[] = {
+44,11,0,0,30,3,0,1,105,109,112,111,114,116,32,115,
+121,115,0,0,12,0,0,8,112,121,50,98,99,46,112,121,
+0,0,0,0,33,0,0,0,12,0,0,1,63,0,0,0,
+34,0,0,0,12,2,0,6,105,109,112,111,114,116,0,0,
+13,1,2,0,12,2,0,3,115,121,115,0,31,0,2,1,
+19,0,1,0,12,1,0,3,115,121,115,0,14,1,0,0,
+30,8,0,2,105,102,32,110,111,116,32,34,116,105,110,121,
+112,121,34,32,105,110,32,115,121,115,46,118,101,114,115,105,
+111,110,58,0,12,2,0,3,115,121,115,0,13,1,2,0,
+12,2,0,7,118,101,114,115,105,111,110,0,9,1,1,2,
+12,2,0,6,116,105,110,121,112,121,0,0,36,1,1,2,
+47,0,1,0,21,0,0,0,18,0,0,30,30,6,0,3,
+32,32,32,32,102,114,111,109,32,98,111,111,116,32,105,109,
+112,111,114,116,32,42,0,0,12,2,0,6,105,109,112,111,
+114,116,0,0,13,1,2,0,12,2,0,4,98,111,111,116,
+0,0,0,0,31,0,2,1,19,0,1,0,12,3,0,5,
+109,101,114,103,101,0,0,0,13,2,3,0,12,5,0,8,
+95,95,100,105,99,116,95,95,0,0,0,0,13,3,5,0,
+15,4,0,0,31,1,3,2,19,1,2,1,18,0,0,1,
+30,8,0,5,105,109,112,111,114,116,32,116,111,107,101,110,
+105,122,101,44,112,97,114,115,101,44,101,110,99,111,100,101,
+0,0,0,0,12,2,0,6,105,109,112,111,114,116,0,0,
+13,1,2,0,12,2,0,8,116,111,107,101,110,105,122,101,
+0,0,0,0,31,0,2,1,19,0,1,0,12,1,0,8,
+116,111,107,101,110,105,122,101,0,0,0,0,14,1,0,0,
+12,2,0,6,105,109,112,111,114,116,0,0,13,1,2,0,
+12,2,0,5,112,97,114,115,101,0,0,0,31,0,2,1,
+19,0,1,0,12,1,0,5,112,97,114,115,101,0,0,0,
+14,1,0,0,12,2,0,6,105,109,112,111,114,116,0,0,
+13,1,2,0,12,2,0,6,101,110,99,111,100,101,0,0,
+31,0,2,1,19,0,1,0,12,1,0,6,101,110,99,111,
+100,101,0,0,14,1,0,0,30,6,0,7,100,101,102,32,
+95,99,111,109,112,105,108,101,40,115,44,102,110,97,109,101,
+41,58,0,0,16,0,0,100,44,11,0,0,30,6,0,7,
+100,101,102,32,95,99,111,109,112,105,108,101,40,115,44,102,
+110,97,109,101,41,58,0,0,12,1,0,8,112,121,50,98,
+99,46,112,121,0,0,0,0,33,1,0,0,12,1,0,8,
+95,99,111,109,112,105,108,101,0,0,0,0,34,1,0,0,
+28,2,0,0,9,1,0,2,28,3,0,0,9,2,0,3,
+30,9,0,8,32,32,32,32,116,111,107,101,110,115,32,61,
+32,116,111,107,101,110,105,122,101,46,116,111,107,101,110,105,
+122,101,40,115,41,0,0,0,12,6,0,8,116,111,107,101,
+110,105,122,101,0,0,0,0,13,5,6,0,12,6,0,8,
+116,111,107,101,110,105,122,101,0,0,0,0,9,5,5,6,
+15,6,1,0,31,4,6,1,19,4,5,4,15,3,4,0,
+30,8,0,9,32,32,32,32,116,32,61,32,112,97,114,115,
+101,46,112,97,114,115,101,40,115,44,116,111,107,101,110,115,
+41,0,0,0,12,7,0,5,112,97,114,115,101,0,0,0,
+13,6,7,0,12,7,0,5,112,97,114,115,101,0,0,0,
+9,6,6,7,15,7,1,0,15,8,3,0,31,5,7,2,
+19,5,6,5,15,4,5,0,30,9,0,10,32,32,32,32,
+114,32,61,32,101,110,99,111,100,101,46,101,110,99,111,100,
+101,40,102,110,97,109,101,44,115,44,116,41,0,0,0,0,
+12,8,0,6,101,110,99,111,100,101,0,0,13,7,8,0,
+12,8,0,6,101,110,99,111,100,101,0,0,9,7,7,8,
+15,8,2,0,15,9,1,0,15,10,4,0,31,6,8,3,
+19,6,7,6,15,5,6,0,30,4,0,11,32,32,32,32,
+114,101,116,117,114,110,32,114,0,0,0,0,20,5,0,0,
+0,0,0,0,12,1,0,8,95,99,111,109,112,105,108,101,
+0,0,0,0,14,1,0,0,30,5,0,13,100,101,102,32,
+95,105,109,112,111,114,116,40,110,97,109,101,41,58,0,0,
+16,1,1,32,44,12,0,0,30,5,0,13,100,101,102,32,
+95,105,109,112,111,114,116,40,110,97,109,101,41,58,0,0,
+12,1,0,8,112,121,50,98,99,46,112,121,0,0,0,0,
+33,1,0,0,12,1,0,7,95,105,109,112,111,114,116,0,
+34,1,0,0,28,2,0,0,9,1,0,2,30,6,0,14,
+32,32,32,32,105,102,32,110,97,109,101,32,105,110,32,77,
+79,68,85,76,69,83,58,0,12,3,0,7,77,79,68,85,
+76,69,83,0,13,2,3,0,36,2,2,1,21,2,0,0,
+18,0,0,17,30,8,0,15,32,32,32,32,32,32,32,32,
+114,101,116,117,114,110,32,77,79,68,85,76,69,83,91,110,
+97,109,101,93,0,0,0,0,12,3,0,7,77,79,68,85,
+76,69,83,0,13,2,3,0,9,2,2,1,20,2,0,0,
+18,0,0,1,30,5,0,16,32,32,32,32,112,121,32,61,
+32,110,97,109,101,43,34,46,112,121,34,0,12,4,0,3,
+46,112,121,0,1,3,1,4,15,2,3,0,30,6,0,17,
+32,32,32,32,116,112,99,32,61,32,110,97,109,101,43,34,
+46,116,112,99,34,0,0,0,12,5,0,4,46,116,112,99,
+0,0,0,0,1,4,1,5,15,3,4,0,30,5,0,18,
+32,32,32,32,105,102,32,101,120,105,115,116,115,40,112,121,
+41,58,0,0,12,6,0,6,101,120,105,115,116,115,0,0,
+13,5,6,0,15,6,2,0,31,4,6,1,19,4,5,4,
+21,4,0,0,18,0,0,97,30,14,0,19,32,32,32,32,
+32,32,32,32,105,102,32,110,111,116,32,101,120,105,115,116,
+115,40,116,112,99,41,32,111,114,32,109,116,105,109,101,40,
+112,121,41,32,62,32,109,116,105,109,101,40,116,112,99,41,
+58,0,0,0,12,7,0,6,101,120,105,115,116,115,0,0,
+13,6,7,0,15,7,3,0,31,5,7,1,19,5,6,5,
+47,4,5,0,46,4,0,0,18,0,0,16,12,6,0,5,
+109,116,105,109,101,0,0,0,13,5,6,0,15,6,3,0,
+31,4,6,1,19,4,5,4,12,7,0,5,109,116,105,109,
+101,0,0,0,13,6,7,0,15,7,2,0,31,5,7,1,
+19,5,6,5,25,4,4,5,21,4,0,0,18,0,0,54,
+30,7,0,20,32,32,32,32,32,32,32,32,32,32,32,32,
+115,32,61,32,108,111,97,100,40,112,121,41,0,0,0,0,
+12,7,0,4,108,111,97,100,0,0,0,0,13,6,7,0,
+15,7,2,0,31,5,7,1,19,5,6,5,15,4,5,0,
+30,9,0,21,32,32,32,32,32,32,32,32,32,32,32,32,
+99,111,100,101,32,61,32,95,99,111,109,112,105,108,101,40,
+115,44,112,121,41,0,0,0,12,8,0,8,95,99,111,109,
+112,105,108,101,0,0,0,0,13,7,8,0,15,8,4,0,
+15,9,2,0,31,6,8,2,19,6,7,6,15,5,6,0,
+30,7,0,22,32,32,32,32,32,32,32,32,32,32,32,32,
+115,97,118,101,40,116,112,99,44,99,111,100,101,41,0,0,
+12,8,0,4,115,97,118,101,0,0,0,0,13,7,8,0,
+15,8,3,0,15,9,5,0,31,6,8,2,19,6,7,6,
+18,0,0,1,18,0,0,1,30,8,0,23,32,32,32,32,
+105,102,32,110,111,116,32,101,120,105,115,116,115,40,116,112,
+99,41,58,32,114,97,105,115,101,0,0,0,12,9,0,6,
+101,120,105,115,116,115,0,0,13,8,9,0,15,9,3,0,
+31,7,9,1,19,7,8,7,47,6,7,0,21,6,0,0,
+18,0,0,4,28,6,0,0,37,6,0,0,18,0,0,1,
+30,6,0,24,32,32,32,32,99,111,100,101,32,61,32,108,
+111,97,100,40,116,112,99,41,0,0,0,0,12,8,0,4,
+108,111,97,100,0,0,0,0,13,7,8,0,15,8,3,0,
+31,6,8,1,19,6,7,6,15,5,6,0,30,11,0,25,
+32,32,32,32,103,32,61,32,123,39,95,95,110,97,109,101,
+95,95,39,58,110,97,109,101,44,39,95,95,99,111,100,101,
+95,95,39,58,99,111,100,101,125,0,0,0,12,8,0,8,
+95,95,110,97,109,101,95,95,0,0,0,0,15,9,1,0,
+12,10,0,8,95,95,99,111,100,101,95,95,0,0,0,0,
+15,11,5,0,26,7,8,4,15,6,7,0,30,6,0,26,
+32,32,32,32,103,91,39,95,95,100,105,99,116,95,95,39,
+93,32,61,32,103,0,0,0,12,7,0,8,95,95,100,105,
+99,116,95,95,0,0,0,0,10,6,7,6,30,6,0,27,
+32,32,32,32,77,79,68,85,76,69,83,91,110,97,109,101,
+93,32,61,32,103,0,0,0,12,8,0,7,77,79,68,85,
+76,69,83,0,13,7,8,0,10,7,1,6,30,5,0,28,
+32,32,32,32,101,120,101,99,40,99,111,100,101,44,103,41,
+0,0,0,0,12,9,0,4,101,120,101,99,0,0,0,0,
+13,8,9,0,15,9,5,0,15,10,6,0,31,7,9,2,
+19,7,8,7,30,4,0,29,32,32,32,32,114,101,116,117,
+114,110,32,103,0,0,0,0,20,6,0,0,0,0,0,0,
+12,2,0,7,95,105,109,112,111,114,116,0,14,2,1,0,
+30,4,0,32,100,101,102,32,95,105,110,105,116,40,41,58,
+0,0,0,0,16,2,0,64,44,4,0,0,30,4,0,32,
+100,101,102,32,95,105,110,105,116,40,41,58,0,0,0,0,
+12,1,0,8,112,121,50,98,99,46,112,121,0,0,0,0,
+33,1,0,0,12,1,0,5,95,105,110,105,116,0,0,0,
+34,1,0,0,30,9,0,33,32,32,32,32,66,85,73,76,
+84,73,78,83,91,39,99,111,109,112,105,108,101,39,93,32,
+61,32,95,99,111,109,112,105,108,101,0,0,12,2,0,8,
+66,85,73,76,84,73,78,83,0,0,0,0,13,1,2,0,
+12,3,0,8,95,99,111,109,112,105,108,101,0,0,0,0,
+13,2,3,0,12,3,0,7,99,111,109,112,105,108,101,0,
+10,1,3,2,30,9,0,34,32,32,32,32,66,85,73,76,
+84,73,78,83,91,39,105,109,112,111,114,116,39,93,32,61,
+32,95,105,109,112,111,114,116,0,0,0,0,12,2,0,8,
+66,85,73,76,84,73,78,83,0,0,0,0,13,1,2,0,
+12,3,0,7,95,105,109,112,111,114,116,0,13,2,3,0,
+12,3,0,6,105,109,112,111,114,116,0,0,10,1,3,2,
+0,0,0,0,12,3,0,5,95,105,110,105,116,0,0,0,
+14,3,2,0,30,8,0,36,100,101,102,32,105,109,112,111,
+114,116,95,102,110,97,109,101,40,102,110,97,109,101,44,110,
+97,109,101,41,58,0,0,0,16,3,0,124,44,10,0,0,
+30,8,0,36,100,101,102,32,105,109,112,111,114,116,95,102,
+110,97,109,101,40,102,110,97,109,101,44,110,97,109,101,41,
+58,0,0,0,12,1,0,8,112,121,50,98,99,46,112,121,
+0,0,0,0,33,1,0,0,12,1,0,12,105,109,112,111,
+114,116,95,102,110,97,109,101,0,0,0,0,34,1,0,0,
+28,2,0,0,9,1,0,2,28,3,0,0,9,2,0,3,
+30,3,0,37,32,32,32,32,103,32,61,32,123,125,0,0,
+26,4,0,0,15,3,4,0,30,7,0,38,32,32,32,32,
+103,91,39,95,95,110,97,109,101,95,95,39,93,32,61,32,
+110,97,109,101,0,0,0,0,12,4,0,8,95,95,110,97,
+109,101,95,95,0,0,0,0,10,3,4,2,30,6,0,39,
+32,32,32,32,77,79,68,85,76,69,83,91,110,97,109,101,
+93,32,61,32,103,0,0,0,12,5,0,7,77,79,68,85,
+76,69,83,0,13,4,5,0,10,4,2,3,30,5,0,40,
+32,32,32,32,115,32,61,32,108,111,97,100,40,102,110,97,
+109,101,41,0,12,7,0,4,108,111,97,100,0,0,0,0,
+13,6,7,0,15,7,1,0,31,5,7,1,19,5,6,5,
+15,4,5,0,30,8,0,41,32,32,32,32,99,111,100,101,
+32,61,32,95,99,111,109,112,105,108,101,40,115,44,102,110,
+97,109,101,41,0,0,0,0,12,8,0,8,95,99,111,109,
+112,105,108,101,0,0,0,0,13,7,8,0,15,8,4,0,
+15,9,1,0,31,6,8,2,19,6,7,6,15,5,6,0,
+30,7,0,42,32,32,32,32,103,91,39,95,95,99,111,100,
+101,95,95,39,93,32,61,32,99,111,100,101,0,0,0,0,
+12,6,0,8,95,95,99,111,100,101,95,95,0,0,0,0,
+10,3,6,5,30,5,0,43,32,32,32,32,101,120,101,99,
+40,99,111,100,101,44,103,41,0,0,0,0,12,8,0,4,
+101,120,101,99,0,0,0,0,13,7,8,0,15,8,5,0,
+15,9,3,0,31,6,8,2,19,6,7,6,30,4,0,44,
+32,32,32,32,114,101,116,117,114,110,32,103,0,0,0,0,
+20,3,0,0,0,0,0,0,12,4,0,12,105,109,112,111,
+114,116,95,102,110,97,109,101,0,0,0,0,14,4,3,0,
+30,4,0,46,100,101,102,32,116,105,110,121,112,121,40,41,
+58,0,0,0,16,4,0,50,44,6,0,0,30,4,0,46,
+100,101,102,32,116,105,110,121,112,121,40,41,58,0,0,0,
+12,1,0,8,112,121,50,98,99,46,112,121,0,0,0,0,
+33,1,0,0,12,1,0,6,116,105,110,121,112,121,0,0,
+34,1,0,0,30,11,0,47,32,32,32,32,114,101,116,117,
+114,110,32,105,109,112,111,114,116,95,102,110,97,109,101,40,
+65,82,71,86,91,48,93,44,39,95,95,109,97,105,110,95,
+95,39,41,0,12,3,0,12,105,109,112,111,114,116,95,102,
+110,97,109,101,0,0,0,0,13,2,3,0,12,5,0,4,
+65,82,71,86,0,0,0,0,13,3,5,0,11,5,0,0,
+0,0,0,0,0,0,0,0,9,3,3,5,12,4,0,8,
+95,95,109,97,105,110,95,95,0,0,0,0,31,1,3,2,
+19,1,2,1,20,1,0,0,0,0,0,0,12,5,0,6,
+116,105,110,121,112,121,0,0,14,5,4,0,30,5,0,49,
+100,101,102,32,109,97,105,110,40,115,114,99,44,100,101,115,
+116,41,58,0,16,5,0,67,44,9,0,0,30,5,0,49,
+100,101,102,32,109,97,105,110,40,115,114,99,44,100,101,115,
+116,41,58,0,12,1,0,8,112,121,50,98,99,46,112,121,
+0,0,0,0,33,1,0,0,12,1,0,4,109,97,105,110,
+0,0,0,0,34,1,0,0,28,2,0,0,9,1,0,2,
+28,3,0,0,9,2,0,3,30,5,0,50,32,32,32,32,
+115,32,61,32,108,111,97,100,40,115,114,99,41,0,0,0,
+12,6,0,4,108,111,97,100,0,0,0,0,13,5,6,0,
+15,6,1,0,31,4,6,1,19,4,5,4,15,3,4,0,
+30,6,0,51,32,32,32,32,114,32,61,32,95,99,111,109,
+112,105,108,101,40,115,44,115,114,99,41,0,12,7,0,8,
+95,99,111,109,112,105,108,101,0,0,0,0,13,6,7,0,
+15,7,3,0,15,8,1,0,31,5,7,2,19,5,6,5,
+15,4,5,0,30,5,0,52,32,32,32,32,115,97,118,101,
+40,100,101,115,116,44,114,41,0,0,0,0,12,7,0,4,
+115,97,118,101,0,0,0,0,13,6,7,0,15,7,2,0,
+15,8,4,0,31,5,7,2,19,5,6,5,0,0,0,0,
+12,6,0,4,109,97,105,110,0,0,0,0,14,6,5,0,
+30,7,0,54,105,102,32,95,95,110,97,109,101,95,95,32,
+61,61,32,39,95,95,109,97,105,110,95,95,39,58,0,0,
+12,7,0,8,95,95,110,97,109,101,95,95,0,0,0,0,
+13,6,7,0,12,7,0,8,95,95,109,97,105,110,95,95,
+0,0,0,0,23,6,6,7,21,6,0,0,18,0,0,242,
+30,7,0,55,32,32,32,32,109,97,105,110,40,65,82,71,
+86,91,49,93,44,65,82,71,86,91,50,93,41,0,0,0,
+12,8,0,4,109,97,105,110,0,0,0,0,13,7,8,0,
+12,10,0,4,65,82,71,86,0,0,0,0,13,8,10,0,
+11,10,0,0,0,0,0,0,0,0,240,63,9,8,8,10,
+12,10,0,4,65,82,71,86,0,0,0,0,13,9,10,0,
+11,10,0,0,0,0,0,0,0,0,0,64,9,9,9,10,
+31,6,8,2,19,6,7,6,30,7,0,56,32,32,32,32,
+109,97,105,110,40,65,82,71,86,91,49,93,44,65,82,71,
+86,91,50,93,41,0,0,0,12,8,0,4,109,97,105,110,
+0,0,0,0,13,7,8,0,12,10,0,4,65,82,71,86,
+0,0,0,0,13,8,10,0,11,10,0,0,0,0,0,0,
+0,0,240,63,9,8,8,10,12,10,0,4,65,82,71,86,
+0,0,0,0,13,9,10,0,11,10,0,0,0,0,0,0,
+0,0,0,64,9,9,9,10,31,6,8,2,19,6,7,6,
+30,7,0,57,32,32,32,32,109,97,105,110,40,65,82,71,
+86,91,49,93,44,65,82,71,86,91,50,93,41,0,0,0,
+12,8,0,4,109,97,105,110,0,0,0,0,13,7,8,0,
+12,10,0,4,65,82,71,86,0,0,0,0,13,8,10,0,
+11,10,0,0,0,0,0,0,0,0,240,63,9,8,8,10,
+12,10,0,4,65,82,71,86,0,0,0,0,13,9,10,0,
+11,10,0,0,0,0,0,0,0,0,0,64,9,9,9,10,
+31,6,8,2,19,6,7,6,30,7,0,58,32,32,32,32,
+109,97,105,110,40,65,82,71,86,91,49,93,44,65,82,71,
+86,91,50,93,41,0,0,0,12,8,0,4,109,97,105,110,
+0,0,0,0,13,7,8,0,12,10,0,4,65,82,71,86,
+0,0,0,0,13,8,10,0,11,10,0,0,0,0,0,0,
+0,0,240,63,9,8,8,10,12,10,0,4,65,82,71,86,
+0,0,0,0,13,9,10,0,11,10,0,0,0,0,0,0,
+0,0,0,64,9,9,9,10,31,6,8,2,19,6,7,6,
+30,7,0,59,32,32,32,32,109,97,105,110,40,65,82,71,
+86,91,49,93,44,65,82,71,86,91,50,93,41,0,0,0,
+12,8,0,4,109,97,105,110,0,0,0,0,13,7,8,0,
+12,10,0,4,65,82,71,86,0,0,0,0,13,8,10,0,
+11,10,0,0,0,0,0,0,0,0,240,63,9,8,8,10,
+12,10,0,4,65,82,71,86,0,0,0,0,13,9,10,0,
+11,10,0,0,0,0,0,0,0,0,0,64,9,9,9,10,
+31,6,8,2,19,6,7,6,30,7,0,60,32,32,32,32,
+109,97,105,110,40,65,82,71,86,91,49,93,44,65,82,71,
+86,91,50,93,41,0,0,0,12,8,0,4,109,97,105,110,
+0,0,0,0,13,7,8,0,12,10,0,4,65,82,71,86,
+0,0,0,0,13,8,10,0,11,10,0,0,0,0,0,0,
+0,0,240,63,9,8,8,10,12,10,0,4,65,82,71,86,
+0,0,0,0,13,9,10,0,11,10,0,0,0,0,0,0,
+0,0,0,64,9,9,9,10,31,6,8,2,19,6,7,6,
+30,7,0,61,32,32,32,32,109,97,105,110,40,65,82,71,
+86,91,49,93,44,65,82,71,86,91,50,93,41,0,0,0,
+12,8,0,4,109,97,105,110,0,0,0,0,13,7,8,0,
+12,10,0,4,65,82,71,86,0,0,0,0,13,8,10,0,
+11,10,0,0,0,0,0,0,0,0,240,63,9,8,8,10,
+12,10,0,4,65,82,71,86,0,0,0,0,13,9,10,0,
+11,10,0,0,0,0,0,0,0,0,0,64,9,9,9,10,
+31,6,8,2,19,6,7,6,30,7,0,62,32,32,32,32,
+109,97,105,110,40,65,82,71,86,91,49,93,44,65,82,71,
+86,91,50,93,41,0,0,0,12,8,0,4,109,97,105,110,
+0,0,0,0,13,7,8,0,12,10,0,4,65,82,71,86,
+0,0,0,0,13,8,10,0,11,10,0,0,0,0,0,0,
+0,0,240,63,9,8,8,10,12,10,0,4,65,82,71,86,
+0,0,0,0,13,9,10,0,11,10,0,0,0,0,0,0,
+0,0,0,64,9,9,9,10,31,6,8,2,19,6,7,6,
+18,0,0,1,0,0,0,0,
+};
+#ifndef TP_COMPILER
+#define TP_COMPILER 1
+#endif
+
+#ifdef TP_SANDBOX
+#endif
+
+void tp_compiler(TP);
+
+tp_obj tp_None = {TP_NONE};
+
+#if TP_COMPILER
+void tp_compiler(TP) {
+    tp_import(tp,0,"tokenize",tp_tokenize,sizeof(tp_tokenize));
+    tp_import(tp,0,"parse",tp_parse,sizeof(tp_parse));
+    tp_import(tp,0,"encode",tp_encode,sizeof(tp_encode));
+    tp_import(tp,0,"py2bc",tp_py2bc,sizeof(tp_py2bc));
+    tp_ez_call(tp,"py2bc","_init",tp_None);
+}
+#else
+void tp_compiler(TP) { }
+#endif
+
+/**/
+
+void tp_sandbox(TP, double time_limit, unsigned long mem_limit) {
+    tp->time_limit = time_limit;
+    tp->mem_limit = mem_limit;
+}
+
+void tp_mem_update(TP) {
+/*    static long maxmem = 0;
+    if (tp->mem_used/1024 > maxmem) {
+        maxmem = tp->mem_used/1024;
+        fprintf(stderr,"%ld k\n",maxmem);
+    }*/
+    if((!tp->mem_exceeded) &&
+       (tp->mem_used > tp->mem_limit) &&
+       (tp->mem_limit != TP_NO_LIMIT)) {
+        tp->mem_exceeded = 1;
+        tp_raise(,tp_string("(tp_mem_update) SandboxError: memory limit exceeded"));
+    }
+}
+
+void tp_time_update(TP) {
+    clock_t tmp = tp->clocks;
+    if(tp->time_limit != TP_NO_LIMIT)
+    {
+        tp->clocks = clock();
+        tp->time_elapsed += ((double) (tp->clocks - tmp) / CLOCKS_PER_SEC) * 1000.0;
+        if(tp->time_elapsed >= tp->time_limit)
+            tp_raise(,tp_string("(tp_time_update) SandboxError: time limit exceeded"));
+    }
+}
+
+#ifdef TP_SANDBOX
+
+void *tp_malloc(TP, unsigned long bytes) {
+    unsigned long *ptr = (unsigned long *) calloc(bytes + sizeof(unsigned long), 1);
+    if(ptr) {
+        *ptr = bytes;
+        tp->mem_used += bytes + sizeof(unsigned long);
+    }
+    tp_mem_update(tp);
+    return ptr+1;
+}
+
+void tp_free(TP, void *ptr) {
+    unsigned long *temp = (unsigned long *) ptr;
+    if(temp) {
+        --temp;
+        tp->mem_used -= (*temp + sizeof(unsigned long));
+        free(temp);
+    }
+    tp_mem_update(tp);
+}
+
+void *tp_realloc(TP, void *ptr, unsigned long bytes) {
+    unsigned long *temp = (unsigned long *) ptr;
+    int diff;
+    if(temp && bytes) {
+        --temp;
+        diff = bytes - *temp;
+        *temp = bytes;
+        tp->mem_used += diff;
+        temp = (unsigned long *) realloc(temp, bytes+sizeof(unsigned long));
+        return temp+1;
+    }
+    else if(temp && !bytes) {
+        tp_free(tp, temp);
+        return NULL;
+    }
+    else if(!temp && bytes) {
+        return tp_malloc(tp, bytes);
+    }
+    else {
+        return NULL;
+    }
+}
+
+#endif
+
+tp_obj tp_sandbox_(TP) {
+    tp_num time = TP_NUM();
+    tp_num mem = TP_NUM();
+    tp_sandbox(tp, time, mem);
+    tp_del(tp, tp->builtins, tp_string("sandbox"));
+    tp_del(tp, tp->builtins, tp_string("mtime"));
+    tp_del(tp, tp->builtins, tp_string("load"));
+    tp_del(tp, tp->builtins, tp_string("save"));
+    tp_del(tp, tp->builtins, tp_string("system"));
+    return tp_None;
+}
+
+void tp_bounds(TP, tp_code *cur, int n) {
+    char *s = (char *)(cur + n);
+    tp_obj code = tp->frames[tp->cur].code;
+    if (s < code.string.val || s > (code.string.val+code.string.len)) {
+        tp_raise(,tp_string("(tp_bounds) SandboxError: bytecode bounds reached"));
+    }
+}

Modified: branches/avidemux_2.6_branch_mean/avidemux_core/CMakeLists.txt
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/CMakeLists.txt	2010-05-20 15:22:34 UTC (rev 6201)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/CMakeLists.txt	2010-05-20 15:22:36 UTC (rev 6202)
@@ -61,6 +61,7 @@
 ADD_SUBDIRECTORY(ADM_coreDemuxerMpeg)
 ADD_SUBDIRECTORY(ADM_coreVideoCodec)
 ADD_SUBDIRECTORY(ADM_coreImage)
+ADD_SUBDIRECTORY(ADM_coreTinyPy)
 ADD_SUBDIRECTORY(ADM_coreMuxer)
 ADD_SUBDIRECTORY(ADM_coreUI)
 ADD_SUBDIRECTORY(ADM_coreUtils)



From mean at mail.berlios.de  Thu May 20 17:22:46 2010
From: mean at mail.berlios.de (mean at BerliOS)
Date: Thu, 20 May 2010 17:22:46 +0200
Subject: [Avidemux-svn-commit] r6204 - in
	branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreTinyPy:
	. include src tst
Message-ID: <201005201522.o4KFMksX014262@sheep.berlios.de>

Author: mean
Date: 2010-05-20 17:22:46 +0200 (Thu, 20 May 2010)
New Revision: 6204

Added:
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreTinyPy/src/init_math.cpp
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreTinyPy/src/math.cpp
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreTinyPy/tst/
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreTinyPy/tst/Makefile
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreTinyPy/tst/hello.cpp
Modified:
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreTinyPy/include/ADM_tinypy.h
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreTinyPy/src/ADM_tinypy.cpp
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreTinyPy/src/tinypy.cpp
Log:
[tinypy] Add the math lib

Modified: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreTinyPy/include/ADM_tinypy.h
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreTinyPy/include/ADM_tinypy.h	2010-05-20 15:22:42 UTC (rev 6203)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreTinyPy/include/ADM_tinypy.h	2010-05-20 15:22:46 UTC (rev 6204)
@@ -27,5 +27,6 @@
         bool    init(void);
                 ~tinyPy(void);
         bool    execString(const char *s);
+        bool    dumpInternals(void);
 };
 #endif

Modified: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreTinyPy/src/ADM_tinypy.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreTinyPy/src/ADM_tinypy.cpp	2010-05-20 15:22:42 UTC (rev 6203)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreTinyPy/src/ADM_tinypy.cpp	2010-05-20 15:22:46 UTC (rev 6204)
@@ -18,6 +18,7 @@
 //extern "C"
 //{
 #include "tinypy.h"
+#include "init_math.cpp"
 //}
 #define INSTANCE ((tp_vm *)instance)
 #define SCRIPT   ((tp_obj *)script)
@@ -53,6 +54,7 @@
     ADM_assert(!instance);
     instance=(void *)tp_init(0,NULL);
     if(instance) return true;   
+    math_init(INSTANCE);
     ADM_error("Cannot initialize tinypy\n");
     return false;
 }
@@ -80,5 +82,13 @@
     }
     return true;
 }
+/**
+    \fn dumpInternals
+*/
+bool tinyPy::dumpInternals(void)
+{
+  
+    return true;
 
+}
 // EOF
\ No newline at end of file

Added: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreTinyPy/src/init_math.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreTinyPy/src/init_math.cpp	2010-05-20 15:22:42 UTC (rev 6203)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreTinyPy/src/init_math.cpp	2010-05-20 15:22:46 UTC (rev 6204)
@@ -0,0 +1,65 @@
+#include "math.cpp"
+
+/*
+ * init math module, namely, set its dictionary
+ */
+void math_init(TP)
+{
+    /*
+     * new a module dict for math
+     */
+    tp_obj math_mod = tp_dict(tp);
+
+    /*
+     * initialize pi and e
+     */
+    math_pi = tp_number(M_PI);
+    math_e  = tp_number(M_E);
+
+    /*
+     * bind math functions to math module
+     */
+    tp_set(tp, math_mod, tp_string("pi"), math_pi);
+    tp_set(tp, math_mod, tp_string("e"), math_e);
+    tp_set(tp, math_mod, tp_string("acos"), tp_fnc(tp, math_acos));
+    tp_set(tp, math_mod, tp_string("asin"), tp_fnc(tp, math_asin));
+    tp_set(tp, math_mod, tp_string("atan"), tp_fnc(tp, math_atan));
+    tp_set(tp, math_mod, tp_string("atan2"), tp_fnc(tp, math_atan2));
+    tp_set(tp, math_mod, tp_string("ceil"), tp_fnc(tp, math_ceil));
+    tp_set(tp, math_mod, tp_string("cos"), tp_fnc(tp, math_cos));
+    tp_set(tp, math_mod, tp_string("cosh"), tp_fnc(tp, math_cosh));
+    tp_set(tp, math_mod, tp_string("degrees"), tp_fnc(tp, math_degrees));
+    tp_set(tp, math_mod, tp_string("exp"), tp_fnc(tp, math_exp));
+    tp_set(tp, math_mod, tp_string("fabs"), tp_fnc(tp, math_fabs));
+    tp_set(tp, math_mod, tp_string("floor"), tp_fnc(tp, math_floor));
+    tp_set(tp, math_mod, tp_string("fmod"), tp_fnc(tp, math_fmod));
+    tp_set(tp, math_mod, tp_string("frexp"), tp_fnc(tp, math_frexp));
+    tp_set(tp, math_mod, tp_string("hypot"), tp_fnc(tp, math_hypot));
+    tp_set(tp, math_mod, tp_string("ldexp"), tp_fnc(tp, math_ldexp));
+    tp_set(tp, math_mod, tp_string("log"), tp_fnc(tp, math_log));
+    tp_set(tp, math_mod, tp_string("log10"), tp_fnc(tp, math_log10));
+    tp_set(tp, math_mod, tp_string("modf"), tp_fnc(tp, math_modf));
+    tp_set(tp, math_mod, tp_string("pow"), tp_fnc(tp, math_pow));
+    tp_set(tp, math_mod, tp_string("radians"), tp_fnc(tp, math_radians));
+    tp_set(tp, math_mod, tp_string("sin"), tp_fnc(tp, math_sin));
+    tp_set(tp, math_mod, tp_string("sinh"), tp_fnc(tp, math_sinh));
+    tp_set(tp, math_mod, tp_string("sqrt"), tp_fnc(tp, math_sqrt));
+    tp_set(tp, math_mod, tp_string("tan"), tp_fnc(tp, math_tan));
+    tp_set(tp, math_mod, tp_string("tanh"), tp_fnc(tp, math_tanh));
+
+    /*
+     * bind special attributes to math module
+     */
+    tp_set(tp, math_mod, tp_string("__doc__"), 
+            tp_string(
+                "This module is always available.  It provides access to the\n"
+                "mathematical functions defined by the C standard."));
+    tp_set(tp, math_mod, tp_string("__name__"), tp_string("math"));
+    tp_set(tp, math_mod, tp_string("__file__"), tp_string(__FILE__));
+
+    /*
+     * bind to tiny modules[]
+     */
+    tp_set(tp, tp->modules, tp_string("math"), math_mod);
+}
+

Added: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreTinyPy/src/math.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreTinyPy/src/math.cpp	2010-05-20 15:22:42 UTC (rev 6203)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreTinyPy/src/math.cpp	2010-05-20 15:22:46 UTC (rev 6204)
@@ -0,0 +1,364 @@
+#include <math.h>
+#ifndef M_E
+ #define M_E     2.7182818284590452354
+#endif
+#ifndef M_PI
+ #define M_PI    3.14159265358979323846
+#endif
+
+#include <errno.h>
+
+/*
+ * template for tinypy math functions
+ * with one parameter. 
+ *
+ * @cfunc is the coresponding function name in C
+ * math library.
+ */
+#define TP_MATH_FUNC1(cfunc)                        \
+    static tp_obj math_##cfunc(TP) {                \
+        double x = TP_NUM();                        \
+        double r = 0.0;                             \
+                                                    \
+        errno = 0;                                  \
+        r = cfunc(x);                               \
+        if (errno == EDOM || errno == ERANGE) {     \
+            tp_raise(tp_None, tp_printf(tp, "%s(x): x=%f "		\
+                                        "out of range", __func__, x));	\
+        }                                           \
+                                                    \
+        return (tp_number(r));                      \
+    }
+
+/*
+ * template for tinypy math functions
+ * with two parameters. 
+ *
+ * @cfunc is the coresponding function name in C
+ * math library.
+ */
+#define TP_MATH_FUNC2(cfunc)                        \
+    static tp_obj math_##cfunc(TP) {                \
+        double x = TP_NUM();                        \
+        double y = TP_NUM();                        \
+        double r = 0.0;                             \
+                                                    \
+        errno = 0;                                  \
+        r = cfunc(x, y);                            \
+        if (errno == EDOM || errno == ERANGE) {     \
+            tp_raise(tp_None, tp_printf(tp, "%s(x, y): x=%f,y=%f "	\
+                                        "out of range", __func__, x, y)); \
+        }                                           \
+                                                    \
+        return (tp_number(r));                      \
+    }
+
+
+/*
+ * PI definition: 3.1415926535897931
+ */
+static tp_obj   math_pi;
+
+/*
+ * E definition: 2.7182818284590451
+ */
+static tp_obj   math_e;
+
+/*
+ * acos(x)
+ *
+ * return arc cosine of x, return value is measured in radians.
+ * if x falls out -1 to 1, raise out-of-range exception.
+ */
+TP_MATH_FUNC1(acos)
+
+/*
+ * asin(x)
+ *
+ * return arc sine of x, measured in radians, actually [-PI/2, PI/2]
+ * if x falls out of -1 to 1, raise out-of-range exception
+ */
+TP_MATH_FUNC1(asin)
+
+/*
+ * atan(x)
+ *
+ * return arc tangent of x, measured in radians,
+ */
+TP_MATH_FUNC1(atan)
+
+/*
+ * atan2(x, y)
+ *
+ * return arc tangent of x/y, measured in radians.
+ * unlike atan(x/y), both the signs of x and y 
+ * are considered to determine the quaderant of 
+ * the result.
+ */
+TP_MATH_FUNC2(atan2)
+
+/*
+ * ceil(x)
+ *
+ * return the ceiling of x, i.e, the smallest
+ * integer >= x.
+ */
+TP_MATH_FUNC1(ceil)
+
+/*
+ * cos(x)
+ *
+ * return cosine of x. x is measured in radians.
+ */
+TP_MATH_FUNC1(cos)
+
+/*
+ * cosh(x)
+ *
+ * return hyperbolic cosine of x.
+ */
+TP_MATH_FUNC1(cosh)
+
+/*
+ * degrees(x)
+ *
+ * converts angle x from radians to degrees.
+ * NOTE: this function is introduced by python,
+ * so we cannot wrap it directly in TP_MATH_FUNC1(),
+ * here the solution is defining a new 
+ * C function - degrees().
+ */
+static const double degToRad = 
+                3.141592653589793238462643383 / 180.0;
+static double degrees(double x)
+{
+    return (x / degToRad);
+}
+
+TP_MATH_FUNC1(degrees)
+
+/*
+ * exp(x)
+ *
+ * return the value e raised to power of x.
+ * e is the base of natural logarithms.
+ */
+TP_MATH_FUNC1(exp)
+
+/*
+ * fabs(x)
+ *
+ * return the absolute value of x.
+ */
+TP_MATH_FUNC1(fabs)
+
+/*
+ * floor(x)
+ *
+ * return the floor of x, i.e, the largest integer <= x
+ */
+TP_MATH_FUNC1(floor)
+
+/*
+ * fmod(x, y)
+ *
+ * return the remainder of dividing x by y. that is,
+ * return x - n * y, where n is the quotient of x/y.
+ * NOTE: this function relies on the underlying platform.
+ */
+TP_MATH_FUNC2(fmod)
+
+/*
+ * frexp(x)
+ *
+ * return a pair (r, y), which satisfies:
+ * x = r * (2 ** y), and r is normalized fraction
+ * which is laid between 1/2 <= abs(r) < 1.
+ * if x = 0, the (r, y) = (0, 0).
+ */
+static tp_obj math_frexp(TP) {
+    double x = TP_NUM();
+    int    y = 0;   
+    double r = 0.0;
+    tp_obj rList = tp_list(tp);
+
+    errno = 0;
+    r = frexp(x, &y);
+    if (errno == EDOM || errno == ERANGE) {
+        tp_raise(tp_None, tp_printf(tp, "%s(x): x=%f, "
+                                    "out of range", __func__, x));
+    }
+
+    _tp_list_append(tp, rList.list.val, tp_number(r));
+    _tp_list_append(tp, rList.list.val, tp_number((tp_num)y));
+    return (rList);
+}
+
+
+/*
+ * hypot(x, y)
+ *
+ * return Euclidean distance, namely,
+ * sqrt(x*x + y*y)
+ */
+TP_MATH_FUNC2(hypot)
+
+
+/*
+ * ldexp(x, y)
+ *
+ * return the result of multiplying x by 2
+ * raised to y.
+ */
+TP_MATH_FUNC2(ldexp)
+
+/*
+ * log(x, [base])
+ *
+ * return logarithm of x to given base. If base is
+ * not given, return the natural logarithm of x.
+ * Note: common logarithm(log10) is used to compute 
+ * the denominator and numerator. based on fomula:
+ * log(x, base) = log10(x) / log10(base).
+ */
+static tp_obj math_log(TP) {
+    double x = TP_NUM();
+    tp_obj b = TP_DEFAULT(tp_None);
+    double y = 0.0;
+    double den = 0.0;   /* denominator */
+    double num = 0.0;   /* numinator */
+    double r = 0.0;     /* result */
+
+    if (b.type == TP_NONE)
+        y = M_E;
+    else if (b.type == TP_NUMBER)
+        y = (double)b.number.val;
+    else
+        tp_raise(tp_None, tp_printf(tp, "%s(x, [base]): base invalid", __func__));
+
+    errno = 0;
+    num = log10(x);
+    if (errno == EDOM || errno == ERANGE)
+        goto excep;
+
+    errno = 0;
+    den = log10(y);
+    if (errno == EDOM || errno == ERANGE)
+        goto excep;
+
+    r = num / den;
+
+    return (tp_number(r));
+
+excep:
+    tp_raise(tp_None, tp_printf(tp, "%s(x, y): x=%f,y=%f "
+                                "out of range", __func__, x, y));
+}
+
+/*
+ * log10(x)
+ *
+ * return 10-based logarithm of x.
+ */
+TP_MATH_FUNC1(log10)
+
+/*
+ * modf(x)
+ *
+ * return a pair (r, y). r is the integral part of
+ * x and y is the fractional part of x, both holds
+ * the same sign as x.
+ */
+static tp_obj math_modf(TP) {
+    double x = TP_NUM();
+    double y = 0.0; 
+    double r = 0.0;
+    tp_obj rList = tp_list(tp);
+
+    errno = 0;
+    r = modf(x, &y);
+    if (errno == EDOM || errno == ERANGE) {
+        tp_raise(tp_None, tp_printf(tp, "%s(x): x=%f, "
+                                    "out of range", __func__, x));
+    }
+
+    _tp_list_append(tp, rList.list.val, tp_number(r));
+    _tp_list_append(tp, rList.list.val, tp_number(y));
+    return (rList);
+}
+
+/*
+ * pow(x, y)
+ *
+ * return value of x raised to y. equivalence of x ** y.
+ * NOTE: conventionally, tp_pow() is the implementation
+ * of builtin function pow(); whilst, math_pow() is an
+ * alternative in math module.
+ */
+static tp_obj math_pow(TP) {
+    double x = TP_NUM();
+    double y = TP_NUM();
+    double r = 0.0;
+
+    errno = 0;
+    r = pow(x, y);
+    if (errno == EDOM || errno == ERANGE) {
+        tp_raise(tp_None, tp_printf(tp, "%s(x, y): x=%f,y=%f "
+                                    "out of range", __func__, x, y));
+    }
+
+    return (tp_number(r));
+}
+
+
+/*
+ * radians(x)
+ *
+ * converts angle x from degrees to radians.
+ * NOTE: this function is introduced by python,
+ * adopt same solution as degrees(x).
+ */
+static double radians(double x)
+{
+    return (x * degToRad);
+}
+
+TP_MATH_FUNC1(radians)
+
+/*
+ * sin(x)
+ *
+ * return sine of x, x is measured in radians.
+ */
+TP_MATH_FUNC1(sin)
+
+/*
+ * sinh(x)
+ *
+ * return hyperbolic sine of x.
+ * mathematically, sinh(x) = (exp(x) - exp(-x)) / 2.
+ */
+TP_MATH_FUNC1(sinh)
+
+/*
+ * sqrt(x)
+ *
+ * return square root of x.
+ * if x is negtive, raise out-of-range exception.
+ */
+TP_MATH_FUNC1(sqrt)
+
+/*
+ * tan(x)
+ *
+ * return tangent of x, x is measured in radians.
+ */
+TP_MATH_FUNC1(tan)
+
+/*
+ * tanh(x)
+ * 
+ * return hyperbolic tangent of x.
+ * mathematically, tanh(x) = sinh(x) / cosh(x).
+ */
+TP_MATH_FUNC1(tanh)

Modified: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreTinyPy/src/tinypy.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreTinyPy/src/tinypy.cpp	2010-05-20 15:22:42 UTC (rev 6203)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreTinyPy/src/tinypy.cpp	2010-05-20 15:22:46 UTC (rev 6204)
@@ -127,7 +127,7 @@
 }JS_LOG_TYPE;
 // MEANX
 bool jsLog(JS_LOG_TYPE type, const char *fmt,...);
-//#define printf(a...) jsLog(JS_LOG_NORMAL,a)
+#define printf(a...) jsLog(JS_LOG_NORMAL,a)
 
 /*  #define tp_malloc(x) calloc((x),1)
     #define tp_realloc(x,y) realloc(x,y)

Added: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreTinyPy/tst/Makefile
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreTinyPy/tst/Makefile	2010-05-20 15:22:42 UTC (rev 6203)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreTinyPy/tst/Makefile	2010-05-20 15:22:46 UTC (rev 6204)
@@ -0,0 +1,2 @@
+all:
+	g++ hello.cpp -o hello -lADM_coreTinyPy6 -lm -g

Added: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreTinyPy/tst/hello.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreTinyPy/tst/hello.cpp	2010-05-20 15:22:42 UTC (rev 6203)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreTinyPy/tst/hello.cpp	2010-05-20 15:22:46 UTC (rev 6204)
@@ -0,0 +1,41 @@
+#include <stdio.h>
+#include <stdarg.h>
+#include "../include/ADM_tinypy.h"
+
+typedef enum
+{
+    JS_LOG_NORMAL,
+    JS_LOG_ERROR
+}JS_LOG_TYPE;
+
+bool jsLog(JS_LOG_TYPE type, const char *prf,...)
+{
+         static char print_buffer[1024];
+
+                va_list         list;
+                va_start(list,  prf);
+                vsnprintf(print_buffer,1023,prf,list);
+                va_end(list);
+                print_buffer[1023]=0; // ensure the string is terminated
+                printf("%s",print_buffer);
+                return true;
+
+}
+
+void one(void)
+{
+        tinyPy py;
+        py.init();
+        py.execString("print('hi there')");
+        printf("The end\n");
+}
+int main(int argc, char **argv)
+{
+        one();
+        one();
+        one();
+        one();
+        printf("The REAL end\n");
+        return 0;
+
+}



From mean at mail.berlios.de  Thu May 20 17:22:48 2010
From: mean at mail.berlios.de (mean at BerliOS)
Date: Thu, 20 May 2010 17:22:48 +0200
Subject: [Avidemux-svn-commit] r6205 - in
	branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreTinyPy:
	include src tst
Message-ID: <201005201522.o4KFMmUo014291@sheep.berlios.de>

Author: mean
Date: 2010-05-20 17:22:47 +0200 (Thu, 20 May 2010)
New Revision: 6205

Modified:
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreTinyPy/include/ADM_tinypy.h
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreTinyPy/include/tinypy.h
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreTinyPy/src/ADM_tinypy.cpp
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreTinyPy/src/tinypy.cpp
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreTinyPy/tst/hello.cpp
Log:
[tinypy] Add hook to add our own functions

Modified: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreTinyPy/include/ADM_tinypy.h
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreTinyPy/include/ADM_tinypy.h	2010-05-20 15:22:46 UTC (rev 6204)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreTinyPy/include/ADM_tinypy.h	2010-05-20 15:22:47 UTC (rev 6205)
@@ -15,7 +15,16 @@
  ***************************************************************************/
 #ifndef ADM_TINYPY_H
 #define ADM_TINYPY_H
+#include "tinypy.h"
 /**
+    \struct tyFunc
+*/
+typedef struct
+{
+    const char *funcName;
+    tp_obj (*funcCall)(TP);
+}pyFuncs;
+/**
     \class tinyPy
 */
 class tinyPy 
@@ -25,8 +34,10 @@
 public:
                 tinyPy(void);
         bool    init(void);
+        bool    registerFuncs(const char *group,pyFuncs *funcs);
                 ~tinyPy(void);
         bool    execString(const char *s);
+        bool    execFile(const char *f);
         bool    dumpInternals(void);
 };
 #endif

Modified: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreTinyPy/include/tinypy.h
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreTinyPy/include/tinypy.h	2010-05-20 15:22:46 UTC (rev 6204)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreTinyPy/include/tinypy.h	2010-05-20 15:22:47 UTC (rev 6205)
@@ -120,6 +120,9 @@
 #error "Unsuported compiler"
 #endif
 
+// MEANX
+bool pyPrintf(const char *fmt,...);
+
 /*  #define tp_malloc(x) calloc((x),1)
     #define tp_realloc(x,y) realloc(x,y)
     #define tp_free(x) free(x) */
@@ -462,7 +465,8 @@
 
 tp_inline static void tp_echo(TP,tp_obj e) {
     e = tp_str(tp,e);
-    fwrite(e.string.val,1,e.string.len,stdout);
+    //fwrite(e.string.val,1,e.string.len,stdout);
+    pyPrintf("%s",e.string.val);
 }
 
 /* Function: tp_string_n

Modified: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreTinyPy/src/ADM_tinypy.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreTinyPy/src/ADM_tinypy.cpp	2010-05-20 15:22:46 UTC (rev 6204)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreTinyPy/src/ADM_tinypy.cpp	2010-05-20 15:22:47 UTC (rev 6205)
@@ -14,6 +14,7 @@
  *                                                                         *
  ***************************************************************************/
 #include "ADM_default.h"
+#include <stdarg.h>
 #include "ADM_tinypy.h"
 //extern "C"
 //{
@@ -23,6 +24,19 @@
 #define INSTANCE ((tp_vm *)instance)
 #define SCRIPT   ((tp_obj *)script)
 
+bool pyPrintf(const char *fmt,...)
+{
+        static char print_buffer[1024];
+  	
+		va_list 	list;
+		va_start(list,	fmt);
+		vsnprintf(print_buffer,1023,fmt,list);
+		va_end(list);
+		print_buffer[1023]=0; // ensure the string is terminated
+        printf("TP>%s",print_buffer);
+        return true;
+}
+
 /**
     \fn tinypy
     \brief ctor
@@ -59,8 +73,8 @@
     return false;
 }
 /**
-    \fn tinypy
-    \brief execString
+    \fn execString
+    \brief eval a python string
 */
 bool tinyPy::execString(const char *s)
 {
@@ -73,8 +87,7 @@
     tp_obj program = tp_string(s);
     if(!setjmp(INSTANCE->nextexpr))
     {
-        tp_obj c = tp_compile(INSTANCE, program, name);
-        tp_exec(INSTANCE, c,INSTANCE->builtins);
+        tp_obj c=tp_eval(INSTANCE,s,INSTANCE->builtins);
     }
     else     
     {
@@ -83,6 +96,27 @@
     return true;
 }
 /**
+    \fn execFile
+    \brief execute a python script
+*/
+bool tinyPy::execFile(const char *f)
+{
+    if(!instance)
+    {
+        ADM_warning("No instance\n");
+        return false;
+    }
+    if(!setjmp(INSTANCE->nextexpr))
+    {
+        tp_import(INSTANCE,f,"avidemux6",NULL,0);
+    }
+    else     
+    {
+        return false;
+    }
+    return true;
+}
+/**
     \fn dumpInternals
 */
 bool tinyPy::dumpInternals(void)
@@ -91,4 +125,20 @@
     return true;
 
 }
+/**
+    \fn registerFuncs
+*/
+bool    tinyPy::registerFuncs(const char *group,pyFuncs *funcs)
+{
+    printf("Registering group %s\n",group);
+    while(funcs->funcName)
+    {
+        printf("Registering :%s\n",funcs->funcName);
+        tp_set(INSTANCE, INSTANCE->builtins, 
+                tp_string(funcs->funcName), 
+                tp_fnc(INSTANCE, funcs->funcCall));
+        funcs++;
+    }
+    return true;
+}
 // EOF
\ No newline at end of file

Modified: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreTinyPy/src/tinypy.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreTinyPy/src/tinypy.cpp	2010-05-20 15:22:46 UTC (rev 6204)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreTinyPy/src/tinypy.cpp	2010-05-20 15:22:47 UTC (rev 6205)
@@ -119,16 +119,11 @@
 #ifndef tp_inline
 #error "Unsuported compiler"
 #endif
+// MEANX : Redirect printf
+bool pyPrintf(const char *fmt,...);
+#define printf pyPrintf
+// ************************
 
-typedef enum
-{
-    JS_LOG_NORMAL,
-    JS_LOG_ERROR
-}JS_LOG_TYPE;
-// MEANX
-bool jsLog(JS_LOG_TYPE type, const char *fmt,...);
-#define printf(a...) jsLog(JS_LOG_NORMAL,a)
-
 /*  #define tp_malloc(x) calloc((x),1)
     #define tp_realloc(x,y) realloc(x,y)
     #define tp_free(x) free(x) */
@@ -471,7 +466,8 @@
 
 tp_inline static void tp_echo(TP,tp_obj e) {
     e = tp_str(tp,e);
-    fwrite(e.string.val,1,e.string.len,stdout);
+    //fwrite(e.string.val,1,e.string.len,stdout); // MEANX
+    printf("%s",e.string.val);
 }
 
 /* Function: tp_string_n

Modified: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreTinyPy/tst/hello.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreTinyPy/tst/hello.cpp	2010-05-20 15:22:46 UTC (rev 6204)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreTinyPy/tst/hello.cpp	2010-05-20 15:22:47 UTC (rev 6205)
@@ -2,31 +2,20 @@
 #include <stdarg.h>
 #include "../include/ADM_tinypy.h"
 
-typedef enum
+tp_obj my_superfunc(TP)
 {
-    JS_LOG_NORMAL,
-    JS_LOG_ERROR
-}JS_LOG_TYPE;
-
-bool jsLog(JS_LOG_TYPE type, const char *prf,...)
-{
-         static char print_buffer[1024];
-
-                va_list         list;
-                va_start(list,  prf);
-                vsnprintf(print_buffer,1023,prf,list);
-                va_end(list);
-                print_buffer[1023]=0; // ensure the string is terminated
-                printf("%s",print_buffer);
-                return true;
-
+        printf("My super func!!!\n");
 }
-
 void one(void)
 {
         tinyPy py;
         py.init();
-        py.execString("print('hi there')");
+        pyFuncs myfuncs[]={{"myfunc",my_superfunc},{NULL,NULL}};
+        py.registerFuncs("myfuncs",myfuncs);
+        py.execString("print('starting')");
+        py.execString("myfunc()");
+        py.execString("print('ending')");
+        py.execString("i=30\nprint(i)");
         printf("The end\n");
 }
 int main(int argc, char **argv)



From mean at mail.berlios.de  Thu May 20 17:22:50 2010
From: mean at mail.berlios.de (mean at BerliOS)
Date: Thu, 20 May 2010 17:22:50 +0200
Subject: [Avidemux-svn-commit] r6206 - in branches/avidemux_2.6_branch_mean:
	avidemux avidemux/common avidemux/common/ADM_pyScript
	avidemux/common/ADM_pyScript/include
	avidemux/common/ADM_pyScript/src avidemux/common/ADM_script2/src
	avidemux/qt4/ADM_userInterfaces/ADM_gui cmake
Message-ID: <201005201522.o4KFMoq0014306@sheep.berlios.de>

Author: mean
Date: 2010-05-20 17:22:49 +0200 (Thu, 20 May 2010)
New Revision: 6206

Added:
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_pyScript/
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_pyScript/CMakeLists.txt
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_pyScript/include/
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_pyScript/include/ADM_pyIf.h
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_pyScript/src/
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_pyScript/src/ADM_pyAdm.cpp
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_pyScript/src/CMakeLists.txt
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_pyScript/src/adm.admPy
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_pyScript/src/adm_gen.cpp
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_pyScript/src/adm_gen.h
   branches/avidemux_2.6_branch_mean/cmake/admPy.pl
Modified:
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src/ADM_jsIf.cpp
   branches/avidemux_2.6_branch_mean/avidemux/common/A_functions.h
   branches/avidemux_2.6_branch_mean/avidemux/common/CMakeLists.txt
   branches/avidemux_2.6_branch_mean/avidemux/common/gtk_gui.cpp
   branches/avidemux_2.6_branch_mean/avidemux/common/gui_action.names
   branches/avidemux_2.6_branch_mean/avidemux/commonCmakeApplication.cmake
   branches/avidemux_2.6_branch_mean/avidemux/qt4/ADM_userInterfaces/ADM_gui/gui2.ui
   branches/avidemux_2.6_branch_mean/avidemux/qt4/ADM_userInterfaces/ADM_gui/translation_table.h
Log:
[tinypy]

Added: branches/avidemux_2.6_branch_mean/avidemux/common/ADM_pyScript/CMakeLists.txt
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/ADM_pyScript/CMakeLists.txt	2010-05-20 15:22:47 UTC (rev 6205)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/ADM_pyScript/CMakeLists.txt	2010-05-20 15:22:49 UTC (rev 6206)
@@ -0,0 +1,2 @@
+subdirs (src)
+#subdirs (src_dialogFactory)

Added: branches/avidemux_2.6_branch_mean/avidemux/common/ADM_pyScript/include/ADM_pyIf.h
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/ADM_pyScript/include/ADM_pyIf.h	2010-05-20 15:22:47 UTC (rev 6205)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/ADM_pyScript/include/ADM_pyIf.h	2010-05-20 15:22:49 UTC (rev 6206)
@@ -0,0 +1,21 @@
+/**
+    \file ADM_pyIf.h
+    \brief Interface for python script 
+    \author mean fixounet at free.fr 2010
+
+*/
+/***************************************************************************
+ *                                                                         *
+ *   This program is free software; you can redistribute it and/or modify  *
+ *   it under the terms of the GNU General Public License as published by  *
+ *   the Free Software Foundation; either version 2 of the License, or     *
+ *   (at your option) any later version.                                   *
+ *                                                                         *
+ ***************************************************************************/
+#ifndef ADM_PY_IF_H
+#define ADM_PY_IF_H
+
+bool parseTinyPyScript(const char *name);
+bool interactiveTinyPy(void);
+
+#endif
\ No newline at end of file

Added: branches/avidemux_2.6_branch_mean/avidemux/common/ADM_pyScript/src/ADM_pyAdm.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/ADM_pyScript/src/ADM_pyAdm.cpp	2010-05-20 15:22:47 UTC (rev 6205)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/ADM_pyScript/src/ADM_pyAdm.cpp	2010-05-20 15:22:49 UTC (rev 6206)
@@ -0,0 +1,130 @@
+/**
+    \file ADM_pyADM.cpp
+    \author mean fixounet at free.fr 2010
+
+*/
+/***************************************************************************
+ *                                                                         *
+ *   This program is free software; you can redistribute it and/or modify  *
+ *   it under the terms of the GNU General Public License as published by  *
+ *   the Free Software Foundation; either version 2 of the License, or     *
+ *   (at your option) any later version.                                   *
+ *                                                                         *
+ ***************************************************************************/
+
+#include "ADM_default.h"
+#include <stdarg.h>
+#include <vector>
+#include "ADM_editor/ADM_edit.hxx"
+#include "ADM_coreTinyPy/include/tinypy.h"
+#include "ADM_coreTinyPy/include/ADM_tinypy.h"
+#include "ADM_script2/include/ADM_jsShell.h"
+#include "A_functions.h"
+
+#include "adm_gen.h"
+
+#include "adm_gen.cpp"
+/**
+    \fn    parseTinyPyScript
+    \brief Execute a tinyPy script
+*/
+bool parseTinyPyScript(const char *name)
+{
+        tinyPy py;
+        py.init();
+        py.registerFuncs("adm",adm_functions);
+        return py.execFile(name);
+}
+
+/**
+    \fn jsEvaluate
+*/
+static tinyPy *myPy=NULL;
+static bool pyEvaluate(const char *str)
+{
+    ADM_assert(myPy);
+    return myPy->execString(str);
+}
+/**
+    \fn    interactiveTinyPy
+    \brief interprete & execute python script (interactive)
+*/
+bool interactiveTinyPy(void)
+{
+    myPy=new tinyPy;
+    myPy->init();
+    myPy->registerFuncs("adm",adm_functions);
+
+    ADM_startShell(pyEvaluate);
+    delete myPy;
+    myPy=NULL;
+	A_Resync();
+    ADM_info("Ending py shell...\n");
+	return true;
+}
+
+int  py_loadVideo (char *vid )
+{
+    printf("pyLoadVideo %s\n",vid);
+    return 0;
+}
+int  py_clearSegments (void)
+{
+    printf("py_clearSegments\n");
+    return 0;
+}
+
+int  py_appendVideo (char *vid )
+{
+    printf("py_appendVideo %s\n",vid);
+    return 0;
+}
+
+int  py_addSegment (int ,float , float )
+{
+    printf("py_addSegment\n");
+    return 0;
+}
+
+int  py_setPostProc (int a,int b, int c)
+{
+    printf("py_setPostProc\n");
+    return 0;
+}
+
+int  py_getWidth (void)
+{
+    printf("py_getWidth\n");
+    return 0;
+}
+
+int  py_getHeight (void)
+{
+    printf("py_getHeight\n");
+    return 0;
+}
+
+int  py_getFps1000 (void)
+{
+    printf("py_getFps1000\n");
+    return 0;
+}
+
+int  py_audioReset (void)
+{
+    printf("py_audioReset\n");
+    return 0;
+}
+
+int  py_audioMixer (char *mixer )
+{
+    printf("py_audioMixer\n");
+    return 0;
+}
+
+int  py_clearVideoFilters (void)
+{
+    printf("py_clearVideoFilters\n");
+    return 0;
+}
+

Added: branches/avidemux_2.6_branch_mean/avidemux/common/ADM_pyScript/src/CMakeLists.txt
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/ADM_pyScript/src/CMakeLists.txt	2010-05-20 15:22:47 UTC (rev 6205)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/ADM_pyScript/src/CMakeLists.txt	2010-05-20 15:22:49 UTC (rev 6206)
@@ -0,0 +1,7 @@
+SET(ADM_script_SRCS
+        ADM_pyAdm.cpp
+)
+
+ADD_LIBRARY(ADM_pyScript6 STATIC ${ADM_script_SRCS})
+include_directories(../include)
+include_directories(${AVIDEMUX_TOP_SOURCE_DIR}/avidemux_core/ADM_coreTinyPy/include)

Added: branches/avidemux_2.6_branch_mean/avidemux/common/ADM_pyScript/src/adm.admPy
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/ADM_pyScript/src/adm.admPy	2010-05-20 15:22:47 UTC (rev 6205)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/ADM_pyScript/src/adm.admPy	2010-05-20 15:22:49 UTC (rev 6206)
@@ -0,0 +1,13 @@
+/* FUNC */ int loadVideo      (char * ) 
+/* FUNC */ int clearSegments  (void) 
+/* FUNC */ int appendVideo    (char * ) 
+/* FUNC */ int addSegment     (int ,float , float ) 
+/* FUNC */ int setPostProc    (int ,int , int ) 
+/* FUNC */ int getWidth       (void) 
+/* FUNC */ int getHeight      (void) 
+/* FUNC */ int getFps1000     (void) 
+#/* FUNC */ char* getVideoCodec(void) 
+/* FUNC */ int audioReset     (void) 
+/* FUNC */ int audioMixer     (char * ) 
+/* FUNC */ int clearVideoFilters   (void) 
+

Added: branches/avidemux_2.6_branch_mean/avidemux/common/ADM_pyScript/src/adm_gen.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/ADM_pyScript/src/adm_gen.cpp	2010-05-20 15:22:47 UTC (rev 6205)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/ADM_pyScript/src/adm_gen.cpp	2010-05-20 15:22:49 UTC (rev 6206)
@@ -0,0 +1,89 @@
+//int  loadVideo <char * >
+tp_obj zzpy_loadVideo(TP)
+{
+char * p0=(char *)TP_STR().string.val;
+int r=py_loadVideo(p0); 
+return tp_number(r);
+}
+//int  clearSegments <void>
+tp_obj zzpy_clearSegments(TP)
+{
+int r=py_clearSegments(); 
+return tp_number(r);
+}
+//int  appendVideo <char * >
+tp_obj zzpy_appendVideo(TP)
+{
+char * p0=(char *)TP_STR().string.val;
+int r=py_appendVideo(p0); 
+return tp_number(r);
+}
+//int  addSegment <int  float   float >
+tp_obj zzpy_addSegment(TP)
+{
+int p0=TP_NUM();
+float p1=TP_NUM();
+float p2=TP_NUM();
+int r=py_addSegment(p0,p1,p2); 
+return tp_number(r);
+}
+//int  setPostProc <int  int   int >
+tp_obj zzpy_setPostProc(TP)
+{
+int p0=TP_NUM();
+int p1=TP_NUM();
+int p2=TP_NUM();
+int r=py_setPostProc(p0,p1,p2); 
+return tp_number(r);
+}
+//int  getWidth <void>
+tp_obj zzpy_getWidth(TP)
+{
+int r=py_getWidth(); 
+return tp_number(r);
+}
+//int  getHeight <void>
+tp_obj zzpy_getHeight(TP)
+{
+int r=py_getHeight(); 
+return tp_number(r);
+}
+//int  getFps1000 <void>
+tp_obj zzpy_getFps1000(TP)
+{
+int r=py_getFps1000(); 
+return tp_number(r);
+}
+//int  audioReset <void>
+tp_obj zzpy_audioReset(TP)
+{
+int r=py_audioReset(); 
+return tp_number(r);
+}
+//int  audioMixer <char * >
+tp_obj zzpy_audioMixer(TP)
+{
+char * p0=(char *)TP_STR().string.val;
+int r=py_audioMixer(p0); 
+return tp_number(r);
+}
+//int  clearVideoFilters <void>
+tp_obj zzpy_clearVideoFilters(TP)
+{
+int r=py_clearVideoFilters(); 
+return tp_number(r);
+}
+pyFuncs adm_functions[]={
+{"loadVideo",zzpy_loadVideo},
+{"clearSegments",zzpy_clearSegments},
+{"appendVideo",zzpy_appendVideo},
+{"addSegment",zzpy_addSegment},
+{"setPostProc",zzpy_setPostProc},
+{"getWidth",zzpy_getWidth},
+{"getHeight",zzpy_getHeight},
+{"getFps1000",zzpy_getFps1000},
+{"audioReset",zzpy_audioReset},
+{"audioMixer",zzpy_audioMixer},
+{"clearVideoFilters",zzpy_clearVideoFilters},
+{NULL,NULL}
+};

Added: branches/avidemux_2.6_branch_mean/avidemux/common/ADM_pyScript/src/adm_gen.h
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/ADM_pyScript/src/adm_gen.h	2010-05-20 15:22:47 UTC (rev 6205)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/ADM_pyScript/src/adm_gen.h	2010-05-20 15:22:49 UTC (rev 6206)
@@ -0,0 +1,11 @@
+int  py_loadVideo (char * );
+int  py_clearSegments (void);
+int  py_appendVideo (char * );
+int  py_addSegment (int ,float , float );
+int  py_setPostProc (int ,int , int );
+int  py_getWidth (void);
+int  py_getHeight (void);
+int  py_getFps1000 (void);
+int  py_audioReset (void);
+int  py_audioMixer (char * );
+int  py_clearVideoFilters (void);

Modified: branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src/ADM_jsIf.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src/ADM_jsIf.cpp	2010-05-20 15:22:47 UTC (rev 6205)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src/ADM_jsIf.cpp	2010-05-20 15:22:49 UTC (rev 6206)
@@ -16,7 +16,6 @@
 #include <stdarg.h>
 #include <vector>
 #include "ADM_editor/ADM_edit.hxx"
-#include "ADM_coreTinyPy/include/ADM_tinypy.h"
 void    A_Resync(void);
 
 /* our variables */
@@ -85,14 +84,7 @@
 static bool jsEvaluate(const char *str)
 {
 jsval rval;
-#if 1
-        tinyPy py;
-        py.init();
-        py.execString(str);
-
-#else
    JS_EvaluateScript(g_pCx,g_pObject,str,strlen(str),"dummy",1,&rval);
-#endif
    return true; 
 }
 /**

Modified: branches/avidemux_2.6_branch_mean/avidemux/common/A_functions.h
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/A_functions.h	2010-05-20 15:22:47 UTC (rev 6205)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/A_functions.h	2010-05-20 15:22:49 UTC (rev 6206)
@@ -20,6 +20,8 @@
 int     A_Save(const char *name);
 int     A_SaveWrapper( char *name);
 bool    A_parseECMAScript(const char *name);
+bool    A_parseTinyPyScript(const char *name);
+
 //uint8_t A_autoDrive(Action action);
 uint8_t A_TimeShift(void);
 void    A_ResetMarkers(void);

Modified: branches/avidemux_2.6_branch_mean/avidemux/common/CMakeLists.txt
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/CMakeLists.txt	2010-05-20 15:22:47 UTC (rev 6205)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/CMakeLists.txt	2010-05-20 15:22:49 UTC (rev 6206)
@@ -16,6 +16,7 @@
 ADD_SUBDIRECTORY(ADM_requant)
 #ADD_SUBDIRECTORY(ADM_script)
 ADD_SUBDIRECTORY(ADM_script2)
+ADD_SUBDIRECTORY(ADM_pyScript)
 ADD_SUBDIRECTORY(ADM_toolkit)
 #ADD_SUBDIRECTORY(ADM_video)
 #ADD_SUBDIRECTORY(ADM_videoFilter)

Modified: branches/avidemux_2.6_branch_mean/avidemux/common/gtk_gui.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/gtk_gui.cpp	2010-05-20 15:22:47 UTC (rev 6205)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/gtk_gui.cpp	2010-05-20 15:22:49 UTC (rev 6206)
@@ -41,6 +41,7 @@
 #include "avi_vars.h"
 #include "prototype.h" // FIXME
 #include "ADM_script2/include/ADM_jsIf.h"
+#include "ADM_pyScript/include/ADM_pyIf.h"
 renderZoom currentZoom=ZOOM_1_1;
 //***********************************
 //******** A Function ***************
@@ -119,6 +120,9 @@
   }
   switch (action)
     {
+        case ACT_PY_SHELL:
+                                interactiveTinyPy();
+                                return;
         case ACT_JS_SHELL:
                                 interactiveECMAScript("dummy");
                                 return;
@@ -163,6 +167,9 @@
     case ACT_PLUGIN_INFO:
             DIA_pluginsInfo();
             return;
+    case ACT_RunPyScript:
+            GUI_FileSelRead (QT_TR_NOOP("Select python script to Run"),(SELFILE_CB *) A_parseTinyPyScript);
+    		return;
     case ACT_RunScript:
             GUI_FileSelRead (QT_TR_NOOP("Select ECMAScript to Run"),(SELFILE_CB *) A_parseECMAScript);
     		return;
@@ -854,6 +861,26 @@
 
 
 
+/**
+    \fn A_parseTinyPyScript
+*/
+bool A_parseTinyPyScript(const char *name){
+  bool ret;
+  char *longname = ADM_PathCanonize(name);
+   if (playing){
+      GUI_PlayAvi();
+   }
+   ret = parseTinyPyScript(longname);
+   if( ret == true )
+   {
+      video_body->setProjectName(longname);
+   }
+   ADM_dealloc(longname);
+   return ret;
+}
+/**
+    \fn A_parseECMAScript
+*/
 bool A_parseECMAScript(const char *name){
   bool ret;
   char *longname = ADM_PathCanonize(name);

Modified: branches/avidemux_2.6_branch_mean/avidemux/common/gui_action.names
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/gui_action.names	2010-05-20 15:22:47 UTC (rev 6205)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/gui_action.names	2010-05-20 15:22:49 UTC (rev 6206)
@@ -112,6 +112,7 @@
 ACT(JumpToFrame)
 ACT(JumpToTime)
 ACT(RunScript)
+ACT(RunPyScript)
 ACT(AudioCodecChanged)
 ACT(VideoCodecChanged)
 ACT(PreviewChanged)
@@ -152,3 +153,4 @@
 ACT(GLYPHEDIT)
 ACT(PLUGIN_INFO)
 ACT(JS_SHELL)
+ACT(PY_SHELL)

Modified: branches/avidemux_2.6_branch_mean/avidemux/commonCmakeApplication.cmake
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/commonCmakeApplication.cmake	2010-05-20 15:22:47 UTC (rev 6205)
+++ branches/avidemux_2.6_branch_mean/avidemux/commonCmakeApplication.cmake	2010-05-20 15:22:49 UTC (rev 6206)
@@ -99,6 +99,7 @@
 ADM_requant6 
 #ADM_script6 
 ADM_script26 
+ADM_pyScript6 
 ADM_scriptDF
 ADM_videoEncoder6 
 ADM_internalVideoFilter6

Modified: branches/avidemux_2.6_branch_mean/avidemux/qt4/ADM_userInterfaces/ADM_gui/gui2.ui
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/qt4/ADM_userInterfaces/ADM_gui/gui2.ui	2010-05-20 15:22:47 UTC (rev 6205)
+++ branches/avidemux_2.6_branch_mean/avidemux/qt4/ADM_userInterfaces/ADM_gui/gui2.ui	2010-05-20 15:22:49 UTC (rev 6206)
@@ -1307,63 +1307,6 @@
     <addaction name="actionSave_2"/>
     <addaction name="actionFilters_2"/>
    </widget>
-   <widget class="QMenu" name="menuFile">
-    <property name="title">
-     <string>&amp;File</string>
-    </property>
-    <widget class="QMenu" name="menuRecent_Files">
-     <property name="title">
-      <string>&amp;Recent Files</string>
-     </property>
-     <addaction name="actionRecent0"/>
-     <addaction name="actionRecent1"/>
-     <addaction name="actionRecent2"/>
-     <addaction name="actionRecent3"/>
-    </widget>
-    <widget class="QMenu" name="menuSave">
-     <property name="title">
-      <string>&amp;Save</string>
-     </property>
-     <addaction name="actionSave_video"/>
-     <addaction name="separator"/>
-     <addaction name="actionSave_BMP"/>
-     <addaction name="actionSave_jpeg"/>
-    </widget>
-    <addaction name="actionOpen"/>
-    <addaction name="menuRecent_Files"/>
-    <addaction name="actionAppend"/>
-    <addaction name="menuSave"/>
-    <addaction name="actionClose"/>
-    <addaction name="separator"/>
-    <addaction name="actionProperties"/>
-    <addaction name="separator"/>
-    <addaction name="actionLoad_run_project"/>
-    <addaction name="actionSave_project"/>
-    <addaction name="actionSave_project_as"/>
-    <addaction name="separator"/>
-    <addaction name="actionAdd_to_joblist"/>
-    <addaction name="actionShow_Joblist"/>
-    <addaction name="separator"/>
-    <addaction name="actionConnect_to_AvsProxy"/>
-    <addaction name="separator"/>
-    <addaction name="actionQuit"/>
-   </widget>
-   <widget class="QMenu" name="menuTools">
-    <property name="title">
-     <string>&amp;Tools</string>
-    </property>
-    <addaction name="actionCalculator"/>
-    <addaction name="separator"/>
-    <addaction name="actionRebuild_I_B_Frames"/>
-    <addaction name="actionBitrate_histogram"/>
-    <addaction name="actionScan_for_black_frames"/>
-    <addaction name="separator"/>
-    <addaction name="actionVob_to_vobsub"/>
-    <addaction name="actionOCR"/>
-    <addaction name="actionOCR_DVB_T_TS_files"/>
-    <addaction name="actionGlyphs_Edit"/>
-    <addaction name="actionJavaScript_shell"/>
-   </widget>
    <widget class="QMenu" name="menuEdit">
     <property name="title">
      <string>&amp;Edit</string>
@@ -1437,6 +1380,65 @@
     <addaction name="actionJump_to_Frame"/>
     <addaction name="actionJump_to_Time"/>
    </widget>
+   <widget class="QMenu" name="menuFile">
+    <property name="title">
+     <string>&amp;File</string>
+    </property>
+    <widget class="QMenu" name="menuRecent_Files">
+     <property name="title">
+      <string>&amp;Recent Files</string>
+     </property>
+     <addaction name="actionRecent0"/>
+     <addaction name="actionRecent1"/>
+     <addaction name="actionRecent2"/>
+     <addaction name="actionRecent3"/>
+    </widget>
+    <widget class="QMenu" name="menuSave">
+     <property name="title">
+      <string>&amp;Save</string>
+     </property>
+     <addaction name="actionSave_video"/>
+     <addaction name="separator"/>
+     <addaction name="actionSave_BMP"/>
+     <addaction name="actionSave_jpeg"/>
+    </widget>
+    <addaction name="actionOpen"/>
+    <addaction name="menuRecent_Files"/>
+    <addaction name="actionAppend"/>
+    <addaction name="menuSave"/>
+    <addaction name="actionClose"/>
+    <addaction name="separator"/>
+    <addaction name="actionProperties"/>
+    <addaction name="separator"/>
+    <addaction name="actionLoad_run_project"/>
+    <addaction name="actionSave_project"/>
+    <addaction name="actionSave_project_as"/>
+    <addaction name="separator"/>
+    <addaction name="actionAdd_to_joblist"/>
+    <addaction name="actionShow_Joblist"/>
+    <addaction name="separator"/>
+    <addaction name="actionConnect_to_AvsProxy"/>
+    <addaction name="separator"/>
+    <addaction name="actionQuit"/>
+    <addaction name="actionRun_pyScript"/>
+   </widget>
+   <widget class="QMenu" name="menuTools">
+    <property name="title">
+     <string>&amp;Tools</string>
+    </property>
+    <addaction name="actionCalculator"/>
+    <addaction name="separator"/>
+    <addaction name="actionRebuild_I_B_Frames"/>
+    <addaction name="actionBitrate_histogram"/>
+    <addaction name="actionScan_for_black_frames"/>
+    <addaction name="separator"/>
+    <addaction name="actionVob_to_vobsub"/>
+    <addaction name="actionOCR"/>
+    <addaction name="actionOCR_DVB_T_TS_files"/>
+    <addaction name="actionGlyphs_Edit"/>
+    <addaction name="actionJavaScript_shell"/>
+    <addaction name="actionPython_Shell"/>
+   </widget>
    <addaction name="menuFile"/>
    <addaction name="menuEdit"/>
    <addaction name="menuView"/>
@@ -2398,6 +2400,16 @@
     <string>16:9</string>
    </property>
   </action>
+  <action name="actionRun_pyScript">
+   <property name="text">
+    <string>Run pyScript</string>
+   </property>
+  </action>
+  <action name="actionPython_Shell">
+   <property name="text">
+    <string>Python Shell</string>
+   </property>
+  </action>
  </widget>
  <customwidgets>
   <customwidget>

Modified: branches/avidemux_2.6_branch_mean/avidemux/qt4/ADM_userInterfaces/ADM_gui/translation_table.h
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/qt4/ADM_userInterfaces/ADM_gui/translation_table.h	2010-05-20 15:22:47 UTC (rev 6205)
+++ branches/avidemux_2.6_branch_mean/avidemux/qt4/ADM_userInterfaces/ADM_gui/translation_table.h	2010-05-20 15:22:49 UTC (rev 6206)
@@ -70,7 +70,9 @@
 PROCESS(actionAdd_to_joblist,ACT_ADD_JOB) \
 PROCESS(actionShow_Joblist,ACT_HANDLE_JOB)  \
 PROCESS(actionPlugins,ACT_PLUGIN_INFO) \
-PROCESS(actionJavaScript_shell,ACT_JS_SHELL) 
+PROCESS(actionJavaScript_shell,ACT_JS_SHELL) \
+PROCESS(actionRun_pyScript,ACT_RunPyScript) \
+PROCESS(actionPython_Shell,ACT_PY_SHELL) \
 
 #if 0
 PROCESS(actionPrevious_intra_frame,ACT_PreviousKFrame) \

Added: branches/avidemux_2.6_branch_mean/cmake/admPy.pl
===================================================================
--- branches/avidemux_2.6_branch_mean/cmake/admPy.pl	2010-05-20 15:22:47 UTC (rev 6205)
+++ branches/avidemux_2.6_branch_mean/cmake/admPy.pl	2010-05-20 15:22:49 UTC (rev 6206)
@@ -0,0 +1,190 @@
+use strict;
+my $input;
+my $output;
+my $headerFile;
+my $line;
+my $glueprefix="zzpy_";
+my $functionPrefix="py_";
+my @allFuncs;
+#
+#
+#
+sub genReturn
+{
+        my $retType=shift;
+        if($retType=~m/int/)
+        {
+                return "return tp_number(r);";
+        }
+        if($retType=~m/float/)
+        {
+                return "return tp_number(r);";
+        }
+        if($retType=~m/void/)
+        {
+                return "";
+        }
+        return "???? $retType";
+}
+#
+#
+#
+sub castFrom
+{
+        my $type=shift;
+        if($type=~m/^char/)
+        {
+                return "(char *)TP_STR().string.val";
+        }
+        if($type=~m/^int/)
+        {
+                return "TP_NUM()";
+        }
+        if($type=~m/^float/)
+        {
+                return "TP_NUM()";
+        }
+        return "????";
+
+}
+#
+# Generate the locals / wrapping for the parameters
+#
+sub genParam
+{
+        my $num=shift;
+        my $type=shift;
+        print OUTPUT "$type p".$num."=";
+        print OUTPUT castFrom($type);
+        print OUTPUT ";\n"; 
+}
+#
+# Process a function declaration and write the glue code to do tinypy<->function call
+#
+sub processFunc
+{
+        my $proto=shift;
+        my $args=$proto;
+        my @params;
+        my $retType=$proto;;
+        my $func=$proto;;
+        $args=~s/^.*\(//g;
+        $args=~s/\).*$//g;
+        #print "args => $args\n";
+        @params=split ",",$args;
+        #print "params -> @params\n";
+        # Get return type...
+        $retType=~s/^ *//g;
+        $retType=~s/ .*$//g;
+        # get functioName
+        $func=~s/ *\(.*$//g;
+        $func=~s/^.* //g;
+        print OUTPUT "//$retType  $func <@params>\n";
+        # Write glue code
+        print OUTPUT "tp_obj ".$glueprefix.$func."(TP)\n";
+        push(@allFuncs,$func);
+        print OUTPUT "{\n";
+        my $nb=scalar(@params);
+        my $i;
+        for($i=0;$i<$nb;$i++)
+        {
+                $params[$i]=~s/^ *//g; # Remove " " at the beginning if any
+                $params[$i]=~s/ *$//g; # Remove " " at the end if any
+        }
+        if($params[0]=~m/^void$/)
+        {
+                $nb=0;
+        }
+        print " New function : $retType,$func,<@params>\n";
+        
+        print HEADER "$retType  $functionPrefix".$func." ($args);\n";
+
+
+        for($i=0;$i<$nb;$i++)
+        {
+                genParam($i,$params[$i]);
+        }
+        # Call real function
+        if(!($retType=~m/^void$/))
+        {
+                print OUTPUT $retType." r=";
+        }
+        print OUTPUT $functionPrefix.$func."(";
+        for($i=0;$i<$nb;$i++)
+        {
+                if($i)
+                {
+                        print OUTPUT ",";
+                }
+                print OUTPUT "p".$i;
+        } 
+        print OUTPUT "); \n";
+        # Cast r to pyobj
+        print OUTPUT genReturn($retType);
+        print OUTPUT "\n}\n";
+
+
+}
+
+
+if(scalar(@ARGV)!=1)
+{
+        die("admPy inputfile\n");
+}
+$input=$ARGV[0];
+$output=$input;
+$output=~s/\..*$//g;
+my $thisfile=$output;
+$thisfile=~s/^.*\///g;
+$headerFile=$output."_gen.h";
+$output=$output."_gen.cpp";
+print "Processing $input=>$output\n";
+open(OUTPUT,">$output") or die("Cannot open $output");
+##
+## Main Loop
+##
+# 1 grab all functions
+open(INPUT,$input) or die("Cannot open $input");
+close(INPUT);
+# Process them
+open(INPUT,$input) or die("Cannot open $input");
+open(HEADER,">$headerFile") or die("Cannot open $headerFile");
+while($line=<INPUT>)
+{
+        chomp($line);
+        if($line=~m/^#/)
+        {
+        }
+        else
+        {
+            if($line=~m/\* FUNC \*/)
+            {
+                my $proto=$line;
+                # Remove header...
+                # Remove tail
+                $line=~s/^.*\*\///g;
+                $line=~s/\/\/.*$//g;
+                processFunc($line);
+
+            }
+        }
+}
+# gen init array
+my $nbFunc=scalar(@allFuncs);
+my $i;
+print OUTPUT "pyFuncs ".$thisfile."_functions[]={\n";
+for($i=0;$i<$nbFunc;$i++)
+{
+                my $line=$allFuncs[$i];
+                #print "Function : $line\n";
+                my $funcName;
+                my $funcProto;
+                $funcName="\"".$line."\"";
+                $funcProto=$glueprefix.$line;
+                print OUTPUT "{$funcName,$funcProto},\n";
+}
+print OUTPUT "{NULL,NULL}\n};\n";
+close(INPUT);
+close(OUTPUT);
+close(HEADER);
+print "done\n.";



From mean at mail.berlios.de  Thu May 20 17:22:53 2010
From: mean at mail.berlios.de (mean at BerliOS)
Date: Thu, 20 May 2010 17:22:53 +0200
Subject: [Avidemux-svn-commit] r6207 - in
	branches/avidemux_2.6_branch_mean/avidemux: . common
	common/ADM_pyScript common/ADM_pyScript/include
	common/ADM_pyScript/src common/ADM_script2
	common/ADM_script2/js common/ADM_script2/py
	common/ADM_script2/py/include common/ADM_script2/src
Message-ID: <201005201522.o4KFMrOw014324@sheep.berlios.de>

Author: mean
Date: 2010-05-20 17:22:52 +0200 (Thu, 20 May 2010)
New Revision: 6207

Added:
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/js/
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/js/ADM_jsAudio.cpp
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/js/ADM_jsAvidemux.cpp
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/js/ADM_jsAvidemuxInfo.cpp
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/js/ADM_jsAvidemux_js.c
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/js/ADM_jsAvidemux_js.idl
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/js/ADM_jsDebug.cpp
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/js/ADM_jsEditor.cpp
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/js/ADM_jsEditor_js.c
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/js/ADM_jsEditor_js.idl
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/js/ADM_jsIf.cpp
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/js/ADM_jsIf_js.c
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/js/ADM_jsIf_js.idl
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/js/ADM_jsTestFactory.cpp
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/js/ADM_jsTestFactory_js.c
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/js/ADM_jsTestFactory_js.idl
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/js/ADM_jsUtils.cpp
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/js/ADM_jsVideo.cpp
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/js/CMakeLists.txt
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/js/idl.make
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/js/updateIdl.sh
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/py/
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/py/ADM_pyAdm.cpp
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/py/CMakeLists.txt
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/py/adm.admPy
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/py/adm_gen.cpp
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/py/adm_gen.h
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/py/include/
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/py/include/ADM_pyIf.h
Removed:
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_pyScript/CMakeLists.txt
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_pyScript/include/ADM_pyIf.h
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_pyScript/src/ADM_pyAdm.cpp
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_pyScript/src/CMakeLists.txt
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_pyScript/src/adm.admPy
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_pyScript/src/adm_gen.cpp
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_pyScript/src/adm_gen.h
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src/ADM_jsAudio.cpp
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src/ADM_jsAvidemux.cpp
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src/ADM_jsAvidemuxInfo.cpp
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src/ADM_jsAvidemux_js.c
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src/ADM_jsAvidemux_js.idl
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src/ADM_jsDebug.cpp
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src/ADM_jsEditor.cpp
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src/ADM_jsEditor_js.c
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src/ADM_jsEditor_js.idl
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src/ADM_jsIf.cpp
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src/ADM_jsIf_js.c
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src/ADM_jsIf_js.idl
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src/ADM_jsTestFactory.cpp
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src/ADM_jsTestFactory_js.c
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src/ADM_jsTestFactory_js.idl
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src/ADM_jsUtils.cpp
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src/ADM_jsVideo.cpp
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src/CMakeLists.txt
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src/idl.make
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src/updateIdl.sh
Modified:
   branches/avidemux_2.6_branch_mean/avidemux/common/CMakeLists.txt
   branches/avidemux_2.6_branch_mean/avidemux/commonCmakeApplication.cmake
Log:
[script] restructure

Deleted: branches/avidemux_2.6_branch_mean/avidemux/common/ADM_pyScript/CMakeLists.txt
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/ADM_pyScript/CMakeLists.txt	2010-05-20 15:22:49 UTC (rev 6206)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/ADM_pyScript/CMakeLists.txt	2010-05-20 15:22:52 UTC (rev 6207)
@@ -1,2 +0,0 @@
-subdirs (src)
-#subdirs (src_dialogFactory)

Deleted: branches/avidemux_2.6_branch_mean/avidemux/common/ADM_pyScript/include/ADM_pyIf.h
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/ADM_pyScript/include/ADM_pyIf.h	2010-05-20 15:22:49 UTC (rev 6206)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/ADM_pyScript/include/ADM_pyIf.h	2010-05-20 15:22:52 UTC (rev 6207)
@@ -1,21 +0,0 @@
-/**
-    \file ADM_pyIf.h
-    \brief Interface for python script 
-    \author mean fixounet at free.fr 2010
-
-*/
-/***************************************************************************
- *                                                                         *
- *   This program is free software; you can redistribute it and/or modify  *
- *   it under the terms of the GNU General Public License as published by  *
- *   the Free Software Foundation; either version 2 of the License, or     *
- *   (at your option) any later version.                                   *
- *                                                                         *
- ***************************************************************************/
-#ifndef ADM_PY_IF_H
-#define ADM_PY_IF_H
-
-bool parseTinyPyScript(const char *name);
-bool interactiveTinyPy(void);
-
-#endif
\ No newline at end of file

Deleted: branches/avidemux_2.6_branch_mean/avidemux/common/ADM_pyScript/src/ADM_pyAdm.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/ADM_pyScript/src/ADM_pyAdm.cpp	2010-05-20 15:22:49 UTC (rev 6206)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/ADM_pyScript/src/ADM_pyAdm.cpp	2010-05-20 15:22:52 UTC (rev 6207)
@@ -1,130 +0,0 @@
-/**
-    \file ADM_pyADM.cpp
-    \author mean fixounet at free.fr 2010
-
-*/
-/***************************************************************************
- *                                                                         *
- *   This program is free software; you can redistribute it and/or modify  *
- *   it under the terms of the GNU General Public License as published by  *
- *   the Free Software Foundation; either version 2 of the License, or     *
- *   (at your option) any later version.                                   *
- *                                                                         *
- ***************************************************************************/
-
-#include "ADM_default.h"
-#include <stdarg.h>
-#include <vector>
-#include "ADM_editor/ADM_edit.hxx"
-#include "ADM_coreTinyPy/include/tinypy.h"
-#include "ADM_coreTinyPy/include/ADM_tinypy.h"
-#include "ADM_script2/include/ADM_jsShell.h"
-#include "A_functions.h"
-
-#include "adm_gen.h"
-
-#include "adm_gen.cpp"
-/**
-    \fn    parseTinyPyScript
-    \brief Execute a tinyPy script
-*/
-bool parseTinyPyScript(const char *name)
-{
-        tinyPy py;
-        py.init();
-        py.registerFuncs("adm",adm_functions);
-        return py.execFile(name);
-}
-
-/**
-    \fn jsEvaluate
-*/
-static tinyPy *myPy=NULL;
-static bool pyEvaluate(const char *str)
-{
-    ADM_assert(myPy);
-    return myPy->execString(str);
-}
-/**
-    \fn    interactiveTinyPy
-    \brief interprete & execute python script (interactive)
-*/
-bool interactiveTinyPy(void)
-{
-    myPy=new tinyPy;
-    myPy->init();
-    myPy->registerFuncs("adm",adm_functions);
-
-    ADM_startShell(pyEvaluate);
-    delete myPy;
-    myPy=NULL;
-	A_Resync();
-    ADM_info("Ending py shell...\n");
-	return true;
-}
-
-int  py_loadVideo (char *vid )
-{
-    printf("pyLoadVideo %s\n",vid);
-    return 0;
-}
-int  py_clearSegments (void)
-{
-    printf("py_clearSegments\n");
-    return 0;
-}
-
-int  py_appendVideo (char *vid )
-{
-    printf("py_appendVideo %s\n",vid);
-    return 0;
-}
-
-int  py_addSegment (int ,float , float )
-{
-    printf("py_addSegment\n");
-    return 0;
-}
-
-int  py_setPostProc (int a,int b, int c)
-{
-    printf("py_setPostProc\n");
-    return 0;
-}
-
-int  py_getWidth (void)
-{
-    printf("py_getWidth\n");
-    return 0;
-}
-
-int  py_getHeight (void)
-{
-    printf("py_getHeight\n");
-    return 0;
-}
-
-int  py_getFps1000 (void)
-{
-    printf("py_getFps1000\n");
-    return 0;
-}
-
-int  py_audioReset (void)
-{
-    printf("py_audioReset\n");
-    return 0;
-}
-
-int  py_audioMixer (char *mixer )
-{
-    printf("py_audioMixer\n");
-    return 0;
-}
-
-int  py_clearVideoFilters (void)
-{
-    printf("py_clearVideoFilters\n");
-    return 0;
-}
-

Deleted: branches/avidemux_2.6_branch_mean/avidemux/common/ADM_pyScript/src/CMakeLists.txt
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/ADM_pyScript/src/CMakeLists.txt	2010-05-20 15:22:49 UTC (rev 6206)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/ADM_pyScript/src/CMakeLists.txt	2010-05-20 15:22:52 UTC (rev 6207)
@@ -1,7 +0,0 @@
-SET(ADM_script_SRCS
-        ADM_pyAdm.cpp
-)
-
-ADD_LIBRARY(ADM_pyScript6 STATIC ${ADM_script_SRCS})
-include_directories(../include)
-include_directories(${AVIDEMUX_TOP_SOURCE_DIR}/avidemux_core/ADM_coreTinyPy/include)

Deleted: branches/avidemux_2.6_branch_mean/avidemux/common/ADM_pyScript/src/adm.admPy
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/ADM_pyScript/src/adm.admPy	2010-05-20 15:22:49 UTC (rev 6206)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/ADM_pyScript/src/adm.admPy	2010-05-20 15:22:52 UTC (rev 6207)
@@ -1,13 +0,0 @@
-/* FUNC */ int loadVideo      (char * ) 
-/* FUNC */ int clearSegments  (void) 
-/* FUNC */ int appendVideo    (char * ) 
-/* FUNC */ int addSegment     (int ,float , float ) 
-/* FUNC */ int setPostProc    (int ,int , int ) 
-/* FUNC */ int getWidth       (void) 
-/* FUNC */ int getHeight      (void) 
-/* FUNC */ int getFps1000     (void) 
-#/* FUNC */ char* getVideoCodec(void) 
-/* FUNC */ int audioReset     (void) 
-/* FUNC */ int audioMixer     (char * ) 
-/* FUNC */ int clearVideoFilters   (void) 
-

Deleted: branches/avidemux_2.6_branch_mean/avidemux/common/ADM_pyScript/src/adm_gen.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/ADM_pyScript/src/adm_gen.cpp	2010-05-20 15:22:49 UTC (rev 6206)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/ADM_pyScript/src/adm_gen.cpp	2010-05-20 15:22:52 UTC (rev 6207)
@@ -1,89 +0,0 @@
-//int  loadVideo <char * >
-tp_obj zzpy_loadVideo(TP)
-{
-char * p0=(char *)TP_STR().string.val;
-int r=py_loadVideo(p0); 
-return tp_number(r);
-}
-//int  clearSegments <void>
-tp_obj zzpy_clearSegments(TP)
-{
-int r=py_clearSegments(); 
-return tp_number(r);
-}
-//int  appendVideo <char * >
-tp_obj zzpy_appendVideo(TP)
-{
-char * p0=(char *)TP_STR().string.val;
-int r=py_appendVideo(p0); 
-return tp_number(r);
-}
-//int  addSegment <int  float   float >
-tp_obj zzpy_addSegment(TP)
-{
-int p0=TP_NUM();
-float p1=TP_NUM();
-float p2=TP_NUM();
-int r=py_addSegment(p0,p1,p2); 
-return tp_number(r);
-}
-//int  setPostProc <int  int   int >
-tp_obj zzpy_setPostProc(TP)
-{
-int p0=TP_NUM();
-int p1=TP_NUM();
-int p2=TP_NUM();
-int r=py_setPostProc(p0,p1,p2); 
-return tp_number(r);
-}
-//int  getWidth <void>
-tp_obj zzpy_getWidth(TP)
-{
-int r=py_getWidth(); 
-return tp_number(r);
-}
-//int  getHeight <void>
-tp_obj zzpy_getHeight(TP)
-{
-int r=py_getHeight(); 
-return tp_number(r);
-}
-//int  getFps1000 <void>
-tp_obj zzpy_getFps1000(TP)
-{
-int r=py_getFps1000(); 
-return tp_number(r);
-}
-//int  audioReset <void>
-tp_obj zzpy_audioReset(TP)
-{
-int r=py_audioReset(); 
-return tp_number(r);
-}
-//int  audioMixer <char * >
-tp_obj zzpy_audioMixer(TP)
-{
-char * p0=(char *)TP_STR().string.val;
-int r=py_audioMixer(p0); 
-return tp_number(r);
-}
-//int  clearVideoFilters <void>
-tp_obj zzpy_clearVideoFilters(TP)
-{
-int r=py_clearVideoFilters(); 
-return tp_number(r);
-}
-pyFuncs adm_functions[]={
-{"loadVideo",zzpy_loadVideo},
-{"clearSegments",zzpy_clearSegments},
-{"appendVideo",zzpy_appendVideo},
-{"addSegment",zzpy_addSegment},
-{"setPostProc",zzpy_setPostProc},
-{"getWidth",zzpy_getWidth},
-{"getHeight",zzpy_getHeight},
-{"getFps1000",zzpy_getFps1000},
-{"audioReset",zzpy_audioReset},
-{"audioMixer",zzpy_audioMixer},
-{"clearVideoFilters",zzpy_clearVideoFilters},
-{NULL,NULL}
-};

Deleted: branches/avidemux_2.6_branch_mean/avidemux/common/ADM_pyScript/src/adm_gen.h
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/ADM_pyScript/src/adm_gen.h	2010-05-20 15:22:49 UTC (rev 6206)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/ADM_pyScript/src/adm_gen.h	2010-05-20 15:22:52 UTC (rev 6207)
@@ -1,11 +0,0 @@
-int  py_loadVideo (char * );
-int  py_clearSegments (void);
-int  py_appendVideo (char * );
-int  py_addSegment (int ,float , float );
-int  py_setPostProc (int ,int , int );
-int  py_getWidth (void);
-int  py_getHeight (void);
-int  py_getFps1000 (void);
-int  py_audioReset (void);
-int  py_audioMixer (char * );
-int  py_clearVideoFilters (void);

Copied: branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/js/ADM_jsAudio.cpp (from rev 6206, branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src/ADM_jsAudio.cpp)
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src/ADM_jsAudio.cpp	2010-05-20 15:22:49 UTC (rev 6206)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/js/ADM_jsAudio.cpp	2010-05-20 15:22:52 UTC (rev 6207)
@@ -0,0 +1,100 @@
+/**
+    \file ADM_jsAudio.cpp
+    \brief Audio oriented functions
+    \author mean (c) 2009 fixounet at free.fr
+
+
+    jsapigen does not like much variable number of arguments
+    In that case, we patch the generated file to go back to native spidermonkey api
+
+
+*/
+/***************************************************************************
+ *                                                                         *
+ *   This program is free software; you can redistribute it and/or modify  *
+ *   it under the terms of the GNU General Public License as published by  *
+ *   the Free Software Foundation; either version 2 of the License, or     *
+ *   (at your option) any later version.                                   *
+ *                                                                         *
+ ***************************************************************************/
+#include "ADM_js.h"
+#include "ADM_editor/ADM_edit.hxx"
+#include "ADM_jsAvidemux.h"
+#include "A_functions.h"
+#include "GUI_ui.h"
+#include "ADM_audioFilterInterface.h"
+#include "audioEncoderApi.h"
+extern ADM_Composer *video_body;
+/**
+    \fn int jsAudioReset(void);
+*/
+int jsAudioReset (void)
+{
+    audioFilterReset();
+    return 1;
+}
+/**
+    \fn 
+*/  
+extern "C" int   jsAudioCodec(const char *a,const char **b) {return 0;}
+JSBool jsAdmaudioCodec(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval)
+{
+        // default return value
+        *rval = BOOLEAN_TO_JSVAL(false);
+        if(argc < 2)
+                return JS_FALSE;
+        if(JSVAL_IS_STRING(argv[0]) == false || JSVAL_IS_INT(argv[1]) == false )            return JS_FALSE;
+        for(int i=2;i<argc;i++)  if(JSVAL_IS_STRING(argv[i]) == false) return JS_FALSE;
+
+        // Get Codec...
+        char *name = JS_GetStringBytes(JSVAL_TO_STRING(argv[0]));
+        ADM_LowerCase(name);
+        
+        // First search the codec by its name
+        if(!audioCodecSetByName(name))
+        {
+                *rval = BOOLEAN_TO_JSVAL(false);
+                jsLog(JS_LOG_ERROR,"Cannot set audio codec %s\n",name);
+        }
+        else
+        {
+            // begin set bitrate
+            uint32_t bitrate=JSVAL_TO_INT(argv[1]);
+            // Construct couples
+            CONFcouple *c=NULL;
+            if(argc>2)
+            {
+                int nb=argc-2;
+                jsArgToConfCouple( nb,&c,  argv+2);
+            }
+            *rval = BOOLEAN_TO_JSVAL(setAudioExtraConf(bitrate,c));
+            if(c) delete c;
+        }
+
+        // end set bitrate
+        
+        return JS_TRUE;
+}
+/**
+    \fn jsAudioMixer
+*/
+int jsAudioMixer(const char *s)
+{
+    CHANNEL_CONF c=AudioMuxerStringToId(s);
+    return audioFilterSetMixer(c);
+}
+/**
+    \fn jsGetResample
+*/
+int32_t jsGetResample(void)
+{
+    return 0;
+}
+/**
+    \fn jsSetResample
+*/
+void    jsSetResample(int32_t fq)
+{
+
+}
+//EOF
\ No newline at end of file

Copied: branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/js/ADM_jsAvidemux.cpp (from rev 6206, branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src/ADM_jsAvidemux.cpp)
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src/ADM_jsAvidemux.cpp	2010-05-20 15:22:49 UTC (rev 6206)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/js/ADM_jsAvidemux.cpp	2010-05-20 15:22:52 UTC (rev 6207)
@@ -0,0 +1,135 @@
+/**
+    \file ADM_jsLoad.cpp
+    \brief Load oriented functions
+    \author mean (c) 2009 fixounet at free.fr
+
+
+*/
+/***************************************************************************
+ *                                                                         *
+ *   This program is free software; you can redistribute it and/or modify  *
+ *   it under the terms of the GNU General Public License as published by  *
+ *   the Free Software Foundation; either version 2 of the License, or     *
+ *   (at your option) any later version.                                   *
+ *                                                                         *
+ ***************************************************************************/
+#include "ADM_js.h"
+#include "ADM_editor/ADM_edit.hxx"
+#include "ADM_jsAvidemux.h"
+#include "A_functions.h"
+#include "ADM_muxerProto.h"
+#include "GUI_ui.h"
+extern ADM_Composer *video_body;
+/**
+    \fn ADM_JSAvidemux
+    \brief Select the current container from a string
+*/
+bool A_setContainer(const char *cont)
+{
+    int idx=ADM_MuxerIndexFromName(cont);
+    if(idx==-1)
+    {
+        ADM_error("Cannot find muxer for format=%s\n",cont);
+        return false;
+    }
+    ADM_info("setting container as index %d\n",idx);
+    UI_SetCurrentFormat(idx);
+    return true;
+}
+
+/**
+    \fn jsLoadFile
+*/
+int jsLoadVideo(const char *s)
+{
+int ret=0;
+        jsLog(JS_LOG_NORMAL,"[Js] Loading video %s",s);
+        if(A_openAvi(s)) 
+        {
+          ret=1;
+        }
+        
+    return ret;
+}
+
+/**
+    \fn jsAppendFile
+*/
+int jsAppendVideo(const char *s)
+{
+int ret=0;
+        
+        if(A_appendAvi(s)) 
+        {
+          ret=1;
+        }
+        
+    return ret;
+}
+
+/**
+    \fn jsClearSegments
+*/
+int jsClearSegments(void)
+{
+    video_body->clearSegment();
+    return 1;
+}
+/**
+    \fn jsAddSegment
+
+*/
+int  jsAddSegment(int ref, double start, double duration)
+{
+    if(true==video_body->addSegment(ref,(uint64_t)start,(uint64_t)duration)) 
+    {
+        if(1==video_body->getNbSegment()) // We just added our first seg...
+        {
+                ADM_info("First segment, refreshing screen\n");
+                A_Rewind();
+        }
+        return 1;
+    }
+    return 0;
+}
+
+
+/**
+    \fn Codec
+    
+*/
+extern "C" int   jsSetContainer(const char *a,const char **b) {return 0;}
+JSBool jsAdmsetContainer(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval)
+{// begin Codec
+        
+        // default return value
+        *rval = BOOLEAN_TO_JSVAL(false);
+        if(argc < 1)
+        {
+            jsLog(JS_LOG_NORMAL,"setContainer needs at least one arg\n");
+            return JS_FALSE;
+        }
+        
+        if(JSVAL_IS_STRING(argv[0]) == false)
+        {
+                jsLog(JS_LOG_NORMAL,"setContainer needs at string arg\n");
+                return JS_FALSE;
+        }
+        char *str = JS_GetStringBytes(JSVAL_TO_STRING(argv[0]));
+         jsLog(JS_LOG_NORMAL,"[JS] Selecting container :%s\n",str);
+        if(A_setContainer(str))
+        {
+            CONFcouple *c;
+            jsArgToConfCouple(argc-1,&c,argv+1);
+            int idx=ADM_MuxerIndexFromName(str);
+            if(idx!=-1)
+            {
+                *rval = BOOLEAN_TO_JSVAL( ADM_mx_setExtraConf(idx,c));
+            }
+            if(c) delete c;
+        }
+        return JS_TRUE;
+}// end Codec
+
+
+// EOF
\ No newline at end of file

Copied: branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/js/ADM_jsAvidemuxInfo.cpp (from rev 6206, branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src/ADM_jsAvidemuxInfo.cpp)
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src/ADM_jsAvidemuxInfo.cpp	2010-05-20 15:22:49 UTC (rev 6206)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/js/ADM_jsAvidemuxInfo.cpp	2010-05-20 15:22:52 UTC (rev 6207)
@@ -0,0 +1,59 @@
+/**
+    \file ADM_jsLoad.cpp
+    \brief Load oriented functions
+    \author mean (c) 2009 fixounet at free.fr
+
+
+*/
+/***************************************************************************
+ *                                                                         *
+ *   This program is free software; you can redistribute it and/or modify  *
+ *   it under the terms of the GNU General Public License as published by  *
+ *   the Free Software Foundation; either version 2 of the License, or     *
+ *   (at your option) any later version.                                   *
+ *                                                                         *
+ ***************************************************************************/
+#include "ADM_js.h"
+#include "ADM_editor/ADM_edit.hxx"
+#include "ADM_jsAvidemux.h"
+#include "fourcc.h"
+extern ADM_Composer *video_body;
+/**
+    \fn jsGetWidth
+*/
+int jsGetWidth ( void)
+{
+aviInfo info;
+        video_body->getVideoInfo(&info);
+        return info.width;
+}
+/**
+    \fn jsGetHeight
+*/
+int jsGetHeight ( void)
+{
+aviInfo info;
+        video_body->getVideoInfo(&info);
+        return info.height;
+}
+/**
+    \fn jsGetFps1000
+*/
+int jsGetFps1000 ( void)
+{
+aviInfo info;
+        video_body->getVideoInfo(&info);
+        return info.fps1000;
+}
+/**
+    \fn jsGetVideoCodec
+*/
+char *jsGetVideoCodec ( void)
+{
+uint32_t fcc;
+aviInfo info;
+        video_body->getVideoInfo(&info);
+        fcc=info.fcc;
+        return fourCC::tostring(fcc);
+}
+// EOF

Copied: branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/js/ADM_jsAvidemux_js.c (from rev 6206, branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src/ADM_jsAvidemux_js.c)
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src/ADM_jsAvidemux_js.c	2010-05-20 15:22:49 UTC (rev 6206)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/js/ADM_jsAvidemux_js.c	2010-05-20 15:22:52 UTC (rev 6207)
@@ -0,0 +1,1317 @@
+/*
+--- DO NOT EDIT THIS FILE !!! ---
+
+This file has been generated automatically with 'jsapigen'.
+
+jsapigen is a glue-code generator for SpiderMonkey. It is distributed
+under the conditions of version 3 of the GNU General Public License.
+Please have a look at http://jsapigen.sourceforge.net.
+
+This file is NOT part of jsapigen and is NOT necessarily covered by
+jsapigen's license. For licensing information regarding this file,
+please refer to the software package which it is part of.
+
+*/
+
+#include "stdio.h"
+#include "ADM_jsAvidemux.h"
+void jsAvidemux(void)
+{
+        printf("Constructor invoked\n");
+}
+
+#ifdef HAVE_ALLOCA_H
+#include <alloca.h>
+static size_t jj_alloca_limit = 0;
+#endif
+#include <stdlib.h>
+#include <string.h>
+#include <wchar.h>
+#ifdef HAVE_ALLOCA_H
+#endif
+#include <jsapi.h>
+#ifndef JS_THREADSAFE
+#if JS_VERSION <= 170
+#define jsrefcount int
+#define JS_BeginRequest(cx)
+#define JS_EndRequest(cx)
+#define JS_SuspendRequest(cx)
+#define JS_ResumeRequest(cx, saveDepth)
+#endif
+#endif
+#ifndef JS_FS
+#define JS_FS(name, call, nargs, flags, extra) {name, call, nargs, flags, extra}
+#endif
+#ifndef JS_FS_END
+#define JS_FS_END {NULL, NULL, 0, 0, 0}
+#endif
+
+static JSBool
+jjadmmarkerA_get(JSContext *cx, JSObject *obj, jsval id, jsval *val)
+{
+    double var2;
+    jsval var5;
+    JSBool var1;
+    var2 = 0.0;
+    var5 = JSVAL_NULL;
+    var1 = JS_FALSE;
+    if (!JS_EnterLocalRootScope(cx)) {
+        goto do_return;
+    }
+    var2 = jsGetMarkerA();
+    if (JS_NewNumberValue(cx, var2, &var5) != JS_TRUE) {
+        goto do_return;
+    }
+    if (val) {
+        *val = var5;
+    }
+    var1 = JS_TRUE;
+    do_return:
+    JS_LeaveLocalRootScope(cx);
+    return var1;
+}
+static JSBool
+jjadmmarkerA_set(JSContext *cx, JSObject *obj, jsval id, jsval *val)
+{
+    double var7;
+    jsval var10;
+    jsdouble var11;
+    JSBool var6;
+    var7 = 0.0;
+    var10 = JSVAL_NULL;
+    var11 = 0.0;
+    var6 = JS_FALSE;
+    if (!JS_EnterLocalRootScope(cx)) {
+        goto do_return;
+    }
+    var10 = *val;
+    if (JS_ValueToNumber(cx, var10, &var11) != JS_TRUE) {
+        goto do_return;
+    }
+    var7 = (double)var11;
+    jsSetMarkerA(var7);
+    var6 = JS_TRUE;
+    do_return:
+    JS_LeaveLocalRootScope(cx);
+    return var6;
+}
+static JSBool
+jjadmmarkerB_get(JSContext *cx, JSObject *obj, jsval id, jsval *val)
+{
+    double var13;
+    jsval var16;
+    JSBool var12;
+    var13 = 0.0;
+    var16 = JSVAL_NULL;
+    var12 = JS_FALSE;
+    if (!JS_EnterLocalRootScope(cx)) {
+        goto do_return;
+    }
+    var13 = jsGetMarkerB();
+    if (JS_NewNumberValue(cx, var13, &var16) != JS_TRUE) {
+        goto do_return;
+    }
+    if (val) {
+        *val = var16;
+    }
+    var12 = JS_TRUE;
+    do_return:
+    JS_LeaveLocalRootScope(cx);
+    return var12;
+}
+static JSBool
+jjadmmarkerB_set(JSContext *cx, JSObject *obj, jsval id, jsval *val)
+{
+    double var18;
+    jsval var21;
+    jsdouble var22;
+    JSBool var17;
+    var18 = 0.0;
+    var21 = JSVAL_NULL;
+    var22 = 0.0;
+    var17 = JS_FALSE;
+    if (!JS_EnterLocalRootScope(cx)) {
+        goto do_return;
+    }
+    var21 = *val;
+    if (JS_ValueToNumber(cx, var21, &var22) != JS_TRUE) {
+        goto do_return;
+    }
+    var18 = (double)var22;
+    jsSetMarkerB(var18);
+    var17 = JS_TRUE;
+    do_return:
+    JS_LeaveLocalRootScope(cx);
+    return var17;
+}
+static JSBool
+jjadmaudioResample_get(JSContext *cx, JSObject *obj, jsval id, jsval *val)
+{
+    int var24;
+    jsval var27;
+    JSBool var23;
+    var24 = 0;
+    var27 = JSVAL_NULL;
+    var23 = JS_FALSE;
+    if (!JS_EnterLocalRootScope(cx)) {
+        goto do_return;
+    }
+    var24 = jsGetResample();
+    if (JS_NewNumberValue(cx, var24, &var27) != JS_TRUE) {
+        goto do_return;
+    }
+    if (val) {
+        *val = var27;
+    }
+    var23 = JS_TRUE;
+    do_return:
+    JS_LeaveLocalRootScope(cx);
+    return var23;
+}
+static JSBool
+jjadmaudioResample_set(JSContext *cx, JSObject *obj, jsval id, jsval *val)
+{
+    int var29;
+    jsval var32;
+    int32 var33;
+    JSBool var28;
+    var29 = 0;
+    var32 = JSVAL_NULL;
+    var33 = 0;
+    var28 = JS_FALSE;
+    if (!JS_EnterLocalRootScope(cx)) {
+        goto do_return;
+    }
+    var32 = *val;
+    if (JS_ValueToInt32(cx, var32, &var33) != JS_TRUE) {
+        goto do_return;
+    }
+    var29 = (int)var33;
+    jsSetResample(var29);
+    var28 = JS_TRUE;
+    do_return:
+    JS_LeaveLocalRootScope(cx);
+    return var28;
+}
+static JSBool
+jjadmloadVideo(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval)
+{
+    JSObject * var35;
+    int var36;
+    int var39;
+    char * var40;
+    int var41;
+    jsval var42;
+    JSString * var43;
+    jsval var241;
+    size_t var44;
+    size_t var45;
+    int var47;
+    jschar * var48;
+    jsval var242;
+    jsval var49;
+    JSBool var34;
+    var35 = NULL;
+    var36 = 0;
+    var39 = 0;
+    var40 = NULL;
+    var41 = 0;
+    var42 = JSVAL_NULL;
+    var43 = NULL;
+    var241 = JSVAL_NULL;
+    var44 = 0;
+    var45 = 0;
+    var47 = 0;
+    var48 = NULL;
+    var242 = JSVAL_NULL;
+    var49 = JSVAL_NULL;
+    var34 = JS_FALSE;
+    var35 = obj;
+    var39 = argc;
+    var41 = 0;
+    var41 = var41 < var39;
+    if (var41) {
+    var42 = argv[0];
+    var43 = JS_ValueToString(cx, var42);
+    if (!var43) {
+        goto do_return;
+    }
+    var241 = STRING_TO_JSVAL(var43);
+    argv[argc+0] = var241;
+    var44 = JS_GetStringLength(var43);
+    var45 = 1;
+    var45 += var44;
+#ifdef HAVE_ALLOCA
+    if (var45 < jj_alloca_limit) {
+        var40 = alloca(var45);
+    } else {
+#endif
+        var40 = malloc(var45);
+        if (!var40) {
+            goto do_return;
+        } else {
+            var47 = 1;
+        }
+#ifdef HAVE_ALLOCA
+    }
+#endif
+    var48 = JS_GetStringChars(var43);
+    var242 = STRING_TO_JSVAL(var43);
+    argv[argc+1] = var242;
+    {
+        size_t i;
+        for (i = 0; i < var44; ++i) {
+            var40[i] = var48[i];
+        }
+        var40[var44] = '\0';
+    }
+    }
+    var36 = jsLoadVideo(var40);
+    if (JS_NewNumberValue(cx, var36, &var49) != JS_TRUE) {
+        goto do_return;
+    }
+    argv[argc+2] = var49;
+    if (rval) {
+        *rval = var49;
+    }
+    var34 = JS_TRUE;
+    do_return:
+    if (var47) {
+        free(var40);
+        var40 = NULL;
+        var47 = 0;
+    }
+    return var34;
+}
+static JSBool
+jjadmclearSegments(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval)
+{
+    JSObject * var51;
+    int var52;
+    int var55;
+    jsval var56;
+    JSBool var50;
+    var51 = NULL;
+    var52 = 0;
+    var55 = 0;
+    var56 = JSVAL_NULL;
+    var50 = JS_FALSE;
+    var51 = obj;
+    var55 = argc;
+    var52 = jsClearSegments();
+    if (JS_NewNumberValue(cx, var52, &var56) != JS_TRUE) {
+        goto do_return;
+    }
+    argv[argc+0] = var56;
+    if (rval) {
+        *rval = var56;
+    }
+    var50 = JS_TRUE;
+    do_return:
+    return var50;
+}
+static JSBool
+jjadmappendVideo(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval)
+{
+    JSObject * var58;
+    int var59;
+    int var62;
+    char * var63;
+    int var64;
+    jsval var65;
+    JSString * var66;
+    jsval var245;
+    size_t var67;
+    size_t var68;
+    int var70;
+    jschar * var71;
+    jsval var246;
+    jsval var72;
+    JSBool var57;
+    var58 = NULL;
+    var59 = 0;
+    var62 = 0;
+    var63 = NULL;
+    var64 = 0;
+    var65 = JSVAL_NULL;
+    var66 = NULL;
+    var245 = JSVAL_NULL;
+    var67 = 0;
+    var68 = 0;
+    var70 = 0;
+    var71 = NULL;
+    var246 = JSVAL_NULL;
+    var72 = JSVAL_NULL;
+    var57 = JS_FALSE;
+    var58 = obj;
+    var62 = argc;
+    var64 = 0;
+    var64 = var64 < var62;
+    if (var64) {
+    var65 = argv[0];
+    var66 = JS_ValueToString(cx, var65);
+    if (!var66) {
+        goto do_return;
+    }
+    var245 = STRING_TO_JSVAL(var66);
+    argv[argc+0] = var245;
+    var67 = JS_GetStringLength(var66);
+    var68 = 1;
+    var68 += var67;
+#ifdef HAVE_ALLOCA
+    if (var68 < jj_alloca_limit) {
+        var63 = alloca(var68);
+    } else {
+#endif
+        var63 = malloc(var68);
+        if (!var63) {
+            goto do_return;
+        } else {
+            var70 = 1;
+        }
+#ifdef HAVE_ALLOCA
+    }
+#endif
+    var71 = JS_GetStringChars(var66);
+    var246 = STRING_TO_JSVAL(var66);
+    argv[argc+1] = var246;
+    {
+        size_t i;
+        for (i = 0; i < var67; ++i) {
+            var63[i] = var71[i];
+        }
+        var63[var67] = '\0';
+    }
+    }
+    var59 = jsAppendVideo(var63);
+    if (JS_NewNumberValue(cx, var59, &var72) != JS_TRUE) {
+        goto do_return;
+    }
+    argv[argc+2] = var72;
+    if (rval) {
+        *rval = var72;
+    }
+    var57 = JS_TRUE;
+    do_return:
+    if (var70) {
+        free(var63);
+        var63 = NULL;
+        var70 = 0;
+    }
+    return var57;
+}
+static JSBool
+jjadmaddSegment(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval)
+{
+    JSObject * var74;
+    int var75;
+    int var78;
+    int var79;
+    int var82;
+    jsval var83;
+    int32 var84;
+    double var80;
+    int var85;
+    jsval var86;
+    jsdouble var87;
+    double var81;
+    int var88;
+    jsval var89;
+    jsdouble var90;
+    jsval var91;
+    JSBool var73;
+    var74 = NULL;
+    var75 = 0;
+    var78 = 0;
+    var79 = 0;
+    var82 = 0;
+    var83 = JSVAL_NULL;
+    var84 = 0;
+    var80 = 0.0;
+    var85 = 0;
+    var86 = JSVAL_NULL;
+    var87 = 0.0;
+    var81 = 0.0;
+    var88 = 0;
+    var89 = JSVAL_NULL;
+    var90 = 0.0;
+    var91 = JSVAL_NULL;
+    var73 = JS_FALSE;
+    var74 = obj;
+    var78 = argc;
+    var82 = 0;
+    var82 = var82 < var78;
+    if (var82) {
+    var83 = argv[0];
+    if (JS_ValueToInt32(cx, var83, &var84) != JS_TRUE) {
+        goto do_return;
+    }
+    var79 = (int)var84;
+    }
+    var85 = 1;
+    var85 = var85 < var78;
+    if (var85) {
+    var86 = argv[1];
+    if (JS_ValueToNumber(cx, var86, &var87) != JS_TRUE) {
+        goto do_return;
+    }
+    var80 = (double)var87;
+    }
+    var88 = 2;
+    var88 = var88 < var78;
+    if (var88) {
+    var89 = argv[2];
+    if (JS_ValueToNumber(cx, var89, &var90) != JS_TRUE) {
+        goto do_return;
+    }
+    var81 = (double)var90;
+    }
+    var75 = jsAddSegment(var79, var80, var81);
+    if (JS_NewNumberValue(cx, var75, &var91) != JS_TRUE) {
+        goto do_return;
+    }
+    argv[argc+0] = var91;
+    if (rval) {
+        *rval = var91;
+    }
+    var73 = JS_TRUE;
+    do_return:
+    return var73;
+}
+static JSBool
+jjadmsetPostProc(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval)
+{
+    JSObject * var93;
+    int var94;
+    int var97;
+    int var98;
+    int var101;
+    jsval var102;
+    int32 var103;
+    int var99;
+    int var104;
+    jsval var105;
+    int32 var106;
+    int var100;
+    int var107;
+    jsval var108;
+    int32 var109;
+    jsval var110;
+    JSBool var92;
+    var93 = NULL;
+    var94 = 0;
+    var97 = 0;
+    var98 = 0;
+    var101 = 0;
+    var102 = JSVAL_NULL;
+    var103 = 0;
+    var99 = 0;
+    var104 = 0;
+    var105 = JSVAL_NULL;
+    var106 = 0;
+    var100 = 0;
+    var107 = 0;
+    var108 = JSVAL_NULL;
+    var109 = 0;
+    var110 = JSVAL_NULL;
+    var92 = JS_FALSE;
+    var93 = obj;
+    var97 = argc;
+    var101 = 0;
+    var101 = var101 < var97;
+    if (var101) {
+    var102 = argv[0];
+    if (JS_ValueToInt32(cx, var102, &var103) != JS_TRUE) {
+        goto do_return;
+    }
+    var98 = (int)var103;
+    }
+    var104 = 1;
+    var104 = var104 < var97;
+    if (var104) {
+    var105 = argv[1];
+    if (JS_ValueToInt32(cx, var105, &var106) != JS_TRUE) {
+        goto do_return;
+    }
+    var99 = (int)var106;
+    }
+    var107 = 2;
+    var107 = var107 < var97;
+    if (var107) {
+    var108 = argv[2];
+    if (JS_ValueToInt32(cx, var108, &var109) != JS_TRUE) {
+        goto do_return;
+    }
+    var100 = (int)var109;
+    }
+    var94 = jsSetPostProc(var98, var99, var100);
+    if (JS_NewNumberValue(cx, var94, &var110) != JS_TRUE) {
+        goto do_return;
+    }
+    argv[argc+0] = var110;
+    if (rval) {
+        *rval = var110;
+    }
+    var92 = JS_TRUE;
+    do_return:
+    return var92;
+}
+static JSBool
+jjadmgetWidth(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval)
+{
+    JSObject * var112;
+    int var113;
+    int var116;
+    jsval var117;
+    JSBool var111;
+    var112 = NULL;
+    var113 = 0;
+    var116 = 0;
+    var117 = JSVAL_NULL;
+    var111 = JS_FALSE;
+    var112 = obj;
+    var116 = argc;
+    var113 = jsGetWidth();
+    if (JS_NewNumberValue(cx, var113, &var117) != JS_TRUE) {
+        goto do_return;
+    }
+    argv[argc+0] = var117;
+    if (rval) {
+        *rval = var117;
+    }
+    var111 = JS_TRUE;
+    do_return:
+    return var111;
+}
+static JSBool
+jjadmgetHeight(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval)
+{
+    JSObject * var119;
+    int var120;
+    int var123;
+    jsval var124;
+    JSBool var118;
+    var119 = NULL;
+    var120 = 0;
+    var123 = 0;
+    var124 = JSVAL_NULL;
+    var118 = JS_FALSE;
+    var119 = obj;
+    var123 = argc;
+    var120 = jsGetHeight();
+    if (JS_NewNumberValue(cx, var120, &var124) != JS_TRUE) {
+        goto do_return;
+    }
+    argv[argc+0] = var124;
+    if (rval) {
+        *rval = var124;
+    }
+    var118 = JS_TRUE;
+    do_return:
+    return var118;
+}
+static JSBool
+jjadmgetFps1000(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval)
+{
+    JSObject * var126;
+    int var127;
+    int var130;
+    jsval var131;
+    JSBool var125;
+    var126 = NULL;
+    var127 = 0;
+    var130 = 0;
+    var131 = JSVAL_NULL;
+    var125 = JS_FALSE;
+    var126 = obj;
+    var130 = argc;
+    var127 = jsGetFps1000();
+    if (JS_NewNumberValue(cx, var127, &var131) != JS_TRUE) {
+        goto do_return;
+    }
+    argv[argc+0] = var131;
+    if (rval) {
+        *rval = var131;
+    }
+    var125 = JS_TRUE;
+    do_return:
+    return var125;
+}
+static JSBool
+jjadmgetVideoCodec(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval)
+{
+    JSObject * var133;
+    char * var134;
+    int var137;
+    jsval var138;
+    JSString * var139;
+    jsval var253;
+    char * var140;
+    jsval var254;
+    JSBool var132;
+    var133 = NULL;
+    var134 = NULL;
+    var137 = 0;
+    var138 = JSVAL_NULL;
+    var139 = NULL;
+    var253 = JSVAL_NULL;
+    var140 = NULL;
+    var254 = JSVAL_NULL;
+    var132 = JS_FALSE;
+    var133 = obj;
+    var137 = argc;
+    var134 = jsGetVideoCodec();
+    if (var134) {
+    var139 = JS_NewStringCopyZ(cx, var134);
+    if (!var139) {
+        goto do_return;
+    }
+    var253 = STRING_TO_JSVAL(var139);
+    argv[argc+0] = var253;
+    } else {
+    var140 = "";
+    var139 = JS_InternString(cx, var140);
+    if (!var139) {
+        goto do_return;
+    }
+    var254 = STRING_TO_JSVAL(var139);
+    argv[argc+1] = var254;
+    }
+    var138 = STRING_TO_JSVAL(var139);
+    if (rval) {
+        *rval = var138;
+    }
+    var132 = JS_TRUE;
+    do_return:
+    return var132;
+}
+static JSBool
+jjadmaudioReset(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval)
+{
+    JSObject * var142;
+    int var143;
+    int var146;
+    jsval var147;
+    JSBool var141;
+    var142 = NULL;
+    var143 = 0;
+    var146 = 0;
+    var147 = JSVAL_NULL;
+    var141 = JS_FALSE;
+    var142 = obj;
+    var146 = argc;
+    var143 = jsAudioReset();
+    if (JS_NewNumberValue(cx, var143, &var147) != JS_TRUE) {
+        goto do_return;
+    }
+    argv[argc+0] = var147;
+    if (rval) {
+        *rval = var147;
+    }
+    var141 = JS_TRUE;
+    do_return:
+    return var141;
+}
+static JSBool
+jjadmaudioMixer(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval)
+{
+    JSObject * var149;
+    int var150;
+    int var153;
+    char * var154;
+    int var155;
+    jsval var156;
+    JSString * var157;
+    jsval var256;
+    size_t var158;
+    size_t var159;
+    int var161;
+    jschar * var162;
+    jsval var257;
+    jsval var163;
+    JSBool var148;
+    var149 = NULL;
+    var150 = 0;
+    var153 = 0;
+    var154 = NULL;
+    var155 = 0;
+    var156 = JSVAL_NULL;
+    var157 = NULL;
+    var256 = JSVAL_NULL;
+    var158 = 0;
+    var159 = 0;
+    var161 = 0;
+    var162 = NULL;
+    var257 = JSVAL_NULL;
+    var163 = JSVAL_NULL;
+    var148 = JS_FALSE;
+    var149 = obj;
+    var153 = argc;
+    var155 = 0;
+    var155 = var155 < var153;
+    if (var155) {
+    var156 = argv[0];
+    var157 = JS_ValueToString(cx, var156);
+    if (!var157) {
+        goto do_return;
+    }
+    var256 = STRING_TO_JSVAL(var157);
+    argv[argc+0] = var256;
+    var158 = JS_GetStringLength(var157);
+    var159 = 1;
+    var159 += var158;
+#ifdef HAVE_ALLOCA
+    if (var159 < jj_alloca_limit) {
+        var154 = alloca(var159);
+    } else {
+#endif
+        var154 = malloc(var159);
+        if (!var154) {
+            goto do_return;
+        } else {
+            var161 = 1;
+        }
+#ifdef HAVE_ALLOCA
+    }
+#endif
+    var162 = JS_GetStringChars(var157);
+    var257 = STRING_TO_JSVAL(var157);
+    argv[argc+1] = var257;
+    {
+        size_t i;
+        for (i = 0; i < var158; ++i) {
+            var154[i] = var162[i];
+        }
+        var154[var158] = '\0';
+    }
+    }
+    var150 = jsAudioMixer(var154);
+    if (JS_NewNumberValue(cx, var150, &var163) != JS_TRUE) {
+        goto do_return;
+    }
+    argv[argc+2] = var163;
+    if (rval) {
+        *rval = var163;
+    }
+    var148 = JS_TRUE;
+    do_return:
+    if (var161) {
+        free(var154);
+        var154 = NULL;
+        var161 = 0;
+    }
+    return var148;
+}
+static JSBool
+jjadmclearVideoFilters(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval)
+{
+    JSObject * var165;
+    int var166;
+    int var169;
+    jsval var170;
+    JSBool var164;
+    var165 = NULL;
+    var166 = 0;
+    var169 = 0;
+    var170 = JSVAL_NULL;
+    var164 = JS_FALSE;
+    var165 = obj;
+    var169 = argc;
+    var166 = jsClearVideoFilters();
+    if (JS_NewNumberValue(cx, var166, &var170) != JS_TRUE) {
+        goto do_return;
+    }
+    argv[argc+0] = var170;
+    if (rval) {
+        *rval = var170;
+    }
+    var164 = JS_TRUE;
+    do_return:
+    return var164;
+}
+static JSBool
+jjadmvideoCodec_ignore(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval)
+{
+    JSObject * var172;
+    int var173;
+    int var176;
+    char * var177;
+    int var178;
+    jsval var179;
+    JSString * var180;
+    jsval var260;
+    size_t var181;
+    size_t var182;
+    int var184;
+    jschar * var185;
+    jsval var261;
+    jsval var186;
+    JSBool var171;
+    var172 = NULL;
+    var173 = 0;
+    var176 = 0;
+    var177 = NULL;
+    var178 = 0;
+    var179 = JSVAL_NULL;
+    var180 = NULL;
+    var260 = JSVAL_NULL;
+    var181 = 0;
+    var182 = 0;
+    var184 = 0;
+    var185 = NULL;
+    var261 = JSVAL_NULL;
+    var186 = JSVAL_NULL;
+    var171 = JS_FALSE;
+    var172 = obj;
+    var176 = argc;
+    var178 = 0;
+    var178 = var178 < var176;
+    if (var178) {
+    var179 = argv[0];
+    var180 = JS_ValueToString(cx, var179);
+    if (!var180) {
+        goto do_return;
+    }
+    var260 = STRING_TO_JSVAL(var180);
+    argv[argc+0] = var260;
+    var181 = JS_GetStringLength(var180);
+    var182 = 1;
+    var182 += var181;
+#ifdef HAVE_ALLOCA
+    if (var182 < jj_alloca_limit) {
+        var177 = alloca(var182);
+    } else {
+#endif
+        var177 = malloc(var182);
+        if (!var177) {
+            goto do_return;
+        } else {
+            var184 = 1;
+        }
+#ifdef HAVE_ALLOCA
+    }
+#endif
+    var185 = JS_GetStringChars(var180);
+    var261 = STRING_TO_JSVAL(var180);
+    argv[argc+1] = var261;
+    {
+        size_t i;
+        for (i = 0; i < var181; ++i) {
+            var177[i] = var185[i];
+        }
+        var177[var181] = '\0';
+    }
+    }
+    var173 = jsVideoCodec(var177);
+    if (JS_NewNumberValue(cx, var173, &var186) != JS_TRUE) {
+        goto do_return;
+    }
+    argv[argc+2] = var186;
+    if (rval) {
+        *rval = var186;
+    }
+    var171 = JS_TRUE;
+    do_return:
+    if (var184) {
+        free(var177);
+        var177 = NULL;
+        var184 = 0;
+    }
+    return var171;
+}
+static JSBool
+jjadmaddVideoFilter_ignore(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval)
+{
+    JSObject * var188;
+    int var189;
+    int var192;
+    char * var193;
+    int var194;
+    jsval var195;
+    JSString * var196;
+    jsval var263;
+    size_t var197;
+    size_t var198;
+    int var200;
+    jschar * var201;
+    jsval var264;
+    jsval var202;
+    JSBool var187;
+    var188 = NULL;
+    var189 = 0;
+    var192 = 0;
+    var193 = NULL;
+    var194 = 0;
+    var195 = JSVAL_NULL;
+    var196 = NULL;
+    var263 = JSVAL_NULL;
+    var197 = 0;
+    var198 = 0;
+    var200 = 0;
+    var201 = NULL;
+    var264 = JSVAL_NULL;
+    var202 = JSVAL_NULL;
+    var187 = JS_FALSE;
+    var188 = obj;
+    var192 = argc;
+    var194 = 0;
+    var194 = var194 < var192;
+    if (var194) {
+    var195 = argv[0];
+    var196 = JS_ValueToString(cx, var195);
+    if (!var196) {
+        goto do_return;
+    }
+    var263 = STRING_TO_JSVAL(var196);
+    argv[argc+0] = var263;
+    var197 = JS_GetStringLength(var196);
+    var198 = 1;
+    var198 += var197;
+#ifdef HAVE_ALLOCA
+    if (var198 < jj_alloca_limit) {
+        var193 = alloca(var198);
+    } else {
+#endif
+        var193 = malloc(var198);
+        if (!var193) {
+            goto do_return;
+        } else {
+            var200 = 1;
+        }
+#ifdef HAVE_ALLOCA
+    }
+#endif
+    var201 = JS_GetStringChars(var196);
+    var264 = STRING_TO_JSVAL(var196);
+    argv[argc+1] = var264;
+    {
+        size_t i;
+        for (i = 0; i < var197; ++i) {
+            var193[i] = var201[i];
+        }
+        var193[var197] = '\0';
+    }
+    }
+    var189 = jsVideoFilter(var193);
+    if (JS_NewNumberValue(cx, var189, &var202) != JS_TRUE) {
+        goto do_return;
+    }
+    argv[argc+2] = var202;
+    if (rval) {
+        *rval = var202;
+    }
+    var187 = JS_TRUE;
+    do_return:
+    if (var200) {
+        free(var193);
+        var193 = NULL;
+        var200 = 0;
+    }
+    return var187;
+}
+static JSBool
+jjadmaudioCodec_ignore(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval)
+{
+    JSObject * var204;
+    int var205;
+    int var208;
+    char * var209;
+    int var210;
+    jsval var211;
+    JSString * var212;
+    jsval var266;
+    size_t var213;
+    size_t var214;
+    int var216;
+    jschar * var217;
+    jsval var267;
+    jsval var218;
+    JSBool var203;
+    var204 = NULL;
+    var205 = 0;
+    var208 = 0;
+    var209 = NULL;
+    var210 = 0;
+    var211 = JSVAL_NULL;
+    var212 = NULL;
+    var266 = JSVAL_NULL;
+    var213 = 0;
+    var214 = 0;
+    var216 = 0;
+    var217 = NULL;
+    var267 = JSVAL_NULL;
+    var218 = JSVAL_NULL;
+    var203 = JS_FALSE;
+    var204 = obj;
+    var208 = argc;
+    var210 = 0;
+    var210 = var210 < var208;
+    if (var210) {
+    var211 = argv[0];
+    var212 = JS_ValueToString(cx, var211);
+    if (!var212) {
+        goto do_return;
+    }
+    var266 = STRING_TO_JSVAL(var212);
+    argv[argc+0] = var266;
+    var213 = JS_GetStringLength(var212);
+    var214 = 1;
+    var214 += var213;
+#ifdef HAVE_ALLOCA
+    if (var214 < jj_alloca_limit) {
+        var209 = alloca(var214);
+    } else {
+#endif
+        var209 = malloc(var214);
+        if (!var209) {
+            goto do_return;
+        } else {
+            var216 = 1;
+        }
+#ifdef HAVE_ALLOCA
+    }
+#endif
+    var217 = JS_GetStringChars(var212);
+    var267 = STRING_TO_JSVAL(var212);
+    argv[argc+1] = var267;
+    {
+        size_t i;
+        for (i = 0; i < var213; ++i) {
+            var209[i] = var217[i];
+        }
+        var209[var213] = '\0';
+    }
+    }
+    var205 = jsAudioCodec(var209);
+    if (JS_NewNumberValue(cx, var205, &var218) != JS_TRUE) {
+        goto do_return;
+    }
+    argv[argc+2] = var218;
+    if (rval) {
+        *rval = var218;
+    }
+    var203 = JS_TRUE;
+    do_return:
+    if (var216) {
+        free(var209);
+        var209 = NULL;
+        var216 = 0;
+    }
+    return var203;
+}
+static JSBool
+jjadmsetContainer_ignore(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval)
+{
+    JSObject * var220;
+    int var221;
+    int var224;
+    char * var225;
+    int var226;
+    jsval var227;
+    JSString * var228;
+    jsval var269;
+    size_t var229;
+    size_t var230;
+    int var232;
+    jschar * var233;
+    jsval var270;
+    jsval var234;
+    JSBool var219;
+    var220 = NULL;
+    var221 = 0;
+    var224 = 0;
+    var225 = NULL;
+    var226 = 0;
+    var227 = JSVAL_NULL;
+    var228 = NULL;
+    var269 = JSVAL_NULL;
+    var229 = 0;
+    var230 = 0;
+    var232 = 0;
+    var233 = NULL;
+    var270 = JSVAL_NULL;
+    var234 = JSVAL_NULL;
+    var219 = JS_FALSE;
+    var220 = obj;
+    var224 = argc;
+    var226 = 0;
+    var226 = var226 < var224;
+    if (var226) {
+    var227 = argv[0];
+    var228 = JS_ValueToString(cx, var227);
+    if (!var228) {
+        goto do_return;
+    }
+    var269 = STRING_TO_JSVAL(var228);
+    argv[argc+0] = var269;
+    var229 = JS_GetStringLength(var228);
+    var230 = 1;
+    var230 += var229;
+#ifdef HAVE_ALLOCA
+    if (var230 < jj_alloca_limit) {
+        var225 = alloca(var230);
+    } else {
+#endif
+        var225 = malloc(var230);
+        if (!var225) {
+            goto do_return;
+        } else {
+            var232 = 1;
+        }
+#ifdef HAVE_ALLOCA
+    }
+#endif
+    var233 = JS_GetStringChars(var228);
+    var270 = STRING_TO_JSVAL(var228);
+    argv[argc+1] = var270;
+    {
+        size_t i;
+        for (i = 0; i < var229; ++i) {
+            var225[i] = var233[i];
+        }
+        var225[var229] = '\0';
+    }
+    }
+    var221 = jsSetContainer(var225);
+    if (JS_NewNumberValue(cx, var221, &var234) != JS_TRUE) {
+        goto do_return;
+    }
+    argv[argc+2] = var234;
+    if (rval) {
+        *rval = var234;
+    }
+    var219 = JS_TRUE;
+    do_return:
+    if (var232) {
+        free(var225);
+        var225 = NULL;
+        var232 = 0;
+    }
+    return var219;
+}
+static JSBool
+jjadm__construct__(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval)
+{
+    JSObject * var236;
+    int var240;
+    JSBool var235;
+    var236 = NULL;
+    var240 = 0;
+    var235 = JS_FALSE;
+    var236 = obj;
+    var240 = argc;
+    jsAvidemux();
+    var235 = JS_TRUE;
+    return var235;
+}
+static JSPropertySpec jj_static_ps[] = {
+    {NULL, 0, 0, NULL, NULL}
+};
+static JSPropertySpec jj_ps[] = {
+    {NULL, 0, 0, NULL, NULL}
+};
+static JSFunctionSpec jj_static_fs[] = {
+    JS_FS_END
+};
+static JSFunctionSpec jj_fs[] = {
+    JS_FS_END
+};
+static JSPropertySpec jjadm_static_ps[] = {
+    {"markerA", 0, 0|JSPROP_ENUMERATE, jjadmmarkerA_get, jjadmmarkerA_set},
+    {"markerB", 0, 0|JSPROP_ENUMERATE, jjadmmarkerB_get, jjadmmarkerB_set},
+    {"audioResample", 0, 0|JSPROP_ENUMERATE, jjadmaudioResample_get, jjadmaudioResample_set},
+    {NULL, 0, 0, NULL, NULL}
+};
+static JSPropertySpec jjadm_ps[] = {
+    {NULL, 0, 0, NULL, NULL}
+};
+static JSFunctionSpec jjadm_static_fs[] = {
+    JS_FS("loadVideo", jjadmloadVideo, 1, 0, 3),
+    JS_FS("clearSegments", jjadmclearSegments, 0, 0, 1),
+    JS_FS("appendVideo", jjadmappendVideo, 1, 0, 3),
+    JS_FS("addSegment", jjadmaddSegment, 3, 0, 1),
+    JS_FS("setPostProc", jjadmsetPostProc, 3, 0, 1),
+    JS_FS("getWidth", jjadmgetWidth, 0, 0, 1),
+    JS_FS("getHeight", jjadmgetHeight, 0, 0, 1),
+    JS_FS("getFps1000", jjadmgetFps1000, 0, 0, 1),
+    JS_FS("getVideoCodec", jjadmgetVideoCodec, 0, 0, 2),
+    JS_FS("audioReset", jjadmaudioReset, 0, 0, 1),
+    JS_FS("audioMixer", jjadmaudioMixer, 1, 0, 3),
+    JS_FS("clearVideoFilters", jjadmclearVideoFilters, 0, 0, 1),
+    JS_FS("videoCodec", jsAdmvideoCodec,  1, 0, 3),
+    JS_FS("addVideoFilter", jsAdmaddVideoFilter,  1, 0, 3),
+    JS_FS("audioCodec", jsAdmaudioCodec,  1, 0, 3),
+    JS_FS("setContainer", jsAdmsetContainer,  1, 0, 3),
+    JS_FS_END
+};
+static JSFunctionSpec jjadm_fs[] = {
+    JS_FS_END
+};
+static JSClass jjadm_class = {
+    "adm",
+    0,
+    JS_PropertyStub,
+    JS_PropertyStub,
+    JS_PropertyStub,
+    JS_PropertyStub,
+    JS_EnumerateStub,
+    JS_ResolveStub,
+    JS_ConvertStub,
+    JS_FinalizeStub,
+    NULL,
+    NULL,
+    NULL,
+    jjadm__construct__,
+    NULL,
+    NULL,
+    NULL,
+    NULL
+};
+static JSObject *
+jjadm_init(JSContext *cx, JSObject *obj)
+{
+    JSObject *parent_proto, *proto;
+    JSClass *class;
+    if (!cx || !obj) {
+        JS_ReportError(cx, "invalid parameter");
+        return NULL;
+    }
+    if (!JS_EnterLocalRootScope(cx)) {
+        JS_ReportError(cx, "JS_EnterLocalRootScope failed");
+        return NULL;
+    }
+    parent_proto = NULL;
+    proto = NULL;
+    parent_proto = JS_NewObject(cx, NULL, NULL, NULL);
+    if (!parent_proto) {
+        JS_LeaveLocalRootScope(cx);
+        JS_ReportError(cx, "failed to create prototype");
+        return NULL;
+    }
+    class = &jjadm_class;
+    proto = JS_InitClass(cx, obj, parent_proto, class, jjadm__construct__, 0, jjadm_ps, jjadm_fs, jjadm_static_ps, jjadm_static_fs);
+    if (!proto) {
+        JS_LeaveLocalRootScope(cx);
+        JS_ReportError(cx, "failed to init class");
+        return NULL;
+    }
+    JS_LeaveLocalRootScope(cx);
+    return proto;
+}
+
+
+JSObject *jsAvidemuxInit(JSContext *cx,JSObject *obj)
+{
+          if (JS_DefineFunctions(cx, obj, jj_static_fs) != JS_TRUE) 
+          {
+                return NULL;
+          }
+          return jjadm_init(cx,obj);
+}
+
+JSFunctionSpec  *jsGetAdmFunctions(void)
+{
+        return jjadm_static_fs;
+}
+
+

Copied: branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/js/ADM_jsAvidemux_js.idl (from rev 6206, branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src/ADM_jsAvidemux_js.idl)
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src/ADM_jsAvidemux_js.idl	2010-05-20 15:22:49 UTC (rev 6206)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/js/ADM_jsAvidemux_js.idl	2010-05-20 15:22:52 UTC (rev 6207)
@@ -0,0 +1,55 @@
+%{
+#include "stdio.h"
+#include "ADM_jsAvidemux.h"
+void jsAvidemux(void)
+{
+        printf("Constructor invoked\n");
+}
+%}
+        /*            JSFUNC      C FUNC  PARAM     */
+class adm
+{
+        function int loadVideo      : jsLoadVideo (cstring ) <static>;
+        function int clearSegments  : jsClearSegments () <static>;
+        function int appendVideo    : jsAppendVideo (cstring ) <static>;
+        function int addSegment     : jsAddSegment (int ,double , double ) <static>;
+        function int setPostProc    : jsSetPostProc (int ,int , int ) <static>;
+        function int getWidth       : jsGetWidth ( ) <static>;
+        function int getHeight      : jsGetHeight ( ) <static>;
+        function int getFps1000     : jsGetFps1000 ( ) <static>;
+     function cstring getVideoCodec : jsGetVideoCodec ( ) <static>;
+        /*            JSFUNC                 C FUNC           PARAM     */
+        function int audioReset     : jsAudioReset () <static>;
+        function int audioMixer     : jsAudioMixer (cstring ) <static>;
+        /*            JSFUNC                 C FUNC           PARAM     */
+        function int clearVideoFilters   : jsClearVideoFilters() <static>;
+        
+/* Override as jsapigen cannot handle multiple args the way we need it to */
+        function int videoCodec_ignore     : jsVideoCodec(cstring)     <static>;
+        function int addVideoFilter_ignore : jsVideoFilter(cstring)    <static>;
+        function int audioCodec_ignore     : jsAudioCodec(cstring)     <static>;
+        function int setContainer_ignore   : jsSetContainer(cstring)   <static>;
+/* Properties */
+        property double markerA            : jsGetMarkerA,jsSetMarkerA <static>;
+        property double markerB            : jsGetMarkerB,jsSetMarkerB <static>;
+        property int    audioResample      : jsGetResample,jsSetResample <static>;
+        construct                          : jsAvidemux  ( ) <static>     ; 
+};
+
+%<
+
+JSObject *jsAvidemuxInit(JSContext *cx,JSObject *obj)
+{
+          if (JS_DefineFunctions(cx, obj, jj_static_fs) != JS_TRUE) 
+          {
+                return NULL;
+          }
+          return jjadm_init(cx,obj);
+}
+
+JSFunctionSpec  *jsGetAdmFunctions(void)
+{
+        return jjadm_static_fs;
+}
+
+%>

Copied: branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/js/ADM_jsDebug.cpp (from rev 6206, branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src/ADM_jsDebug.cpp)
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src/ADM_jsDebug.cpp	2010-05-20 15:22:49 UTC (rev 6206)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/js/ADM_jsDebug.cpp	2010-05-20 15:22:52 UTC (rev 6207)
@@ -0,0 +1,106 @@
+/**
+    \file ADM_JSDebug.cpp
+    \brief Debug oriented functions for avidemux JS/JS shell
+    \author mean (c) 2009 fixounet at free.fr
+
+
+*/
+/***************************************************************************
+ *                                                                         *
+ *   This program is free software; you can redistribute it and/or modify  *
+ *   it under the terms of the GNU General Public License as published by  *
+ *   the Free Software Foundation; either version 2 of the License, or     *
+ *   (at your option) any later version.                                   *
+ *                                                                         *
+ ***************************************************************************/
+#include "ADM_js.h"
+#include "ADM_editor/ADM_edit.hxx"
+#include "ADM_jsDebug.h"
+#include <vector>
+/**/
+/**/
+extern ADM_Composer *video_body;
+void ADM_dumpJSHooks(void);
+extern vector <JSFunctionSpec *>listOfHooks;
+/**
+    \fn displayError
+    \brief error popup
+*/
+void jsPopupError(const char *s)
+{// begin displayError
+	
+	GUI_Verbose();
+	GUI_Error_HIG("Error",s);
+	GUI_Quiet();
+
+}// end displayError
+/**
+    \fn displayInfo
+    \brief info popup
+*/
+
+void jsPopupInfo(const char *s)
+{// begin displayInfo
+	
+	GUI_Verbose();
+	GUI_Info_HIG(ADM_LOG_IMPORTANT,"Info",s);
+	GUI_Quiet();
+	
+}// end displayInfo
+ /**
+    \fn print
+*/
+void jsPrint(const char *s)
+{// begin print
+        jsLog(JS_LOG_NORMAL,"%s",s);
+}// end print
+void jsPrint2(const char *s)
+{// begin print
+        jsLog(JS_LOG_NORMAL,"%s",s);
+}// end print
+
+
+static void dumpFunc(JSFunctionSpec *f)
+{
+    while(f->name)
+    {
+        jsLog(JS_LOG_NORMAL,"     %s(..)",f->name);
+        f++;
+    }
+}
+
+/**
+    \fn printJSError
+*/
+void  printJSError(JSContext *cx, const char *message, JSErrorReport *report)
+{// begin printJSError
+int quiet=GUI_isQuiet();
+char buf[4];
+FILE *fd = ADM_fopen(report->filename,"rb");
+    if(quiet)
+            GUI_Verbose();
+	if( fd )
+    {
+		fread(buf,1,4,fd);
+		fclose(fd);
+	}
+	if( strncmp(buf,"//AD",4) )
+    {
+            if (report->filename || report->lineno)
+                jsLog(JS_LOG_ERROR,"%s: line %d:\nMsg: %s\n",
+                              report->filename,
+                              report->lineno,
+                              message);
+            else
+                jsLog(JS_LOG_ERROR,"Error");
+    
+	}else
+    {
+            jsLog(JS_LOG_ERROR,"%s: line %d:\nMsg: %s\n",report->filename,report->lineno,message);
+	}
+       
+    if(quiet)
+            GUI_Quiet();
+
+}// end printJSError
+// EOF
\ No newline at end of file

Copied: branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/js/ADM_jsEditor.cpp (from rev 6206, branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src/ADM_jsEditor.cpp)
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src/ADM_jsEditor.cpp	2010-05-20 15:22:49 UTC (rev 6206)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/js/ADM_jsEditor.cpp	2010-05-20 15:22:52 UTC (rev 6207)
@@ -0,0 +1,77 @@
+/**
+    \file ADM_JSif.cpp
+    \brief interface to js
+*/
+
+/***************************************************************************
+ *                                                                         *
+ *   This program is free software; you can redistribute it and/or modify  *
+ *   it under the terms of the GNU General Public License as published by  *
+ *   the Free Software Foundation; either version 2 of the License, or     *
+ *   (at your option) any later version.                                   *
+ *                                                                         *
+ ***************************************************************************/
+
+#include "ADM_js.h"
+#include <stdarg.h>
+#include <vector>
+#include "ADM_jsEditor.h"
+#include "ADM_editor/ADM_edit.hxx"
+extern ADM_Composer *video_body;
+
+/**
+    \fn jsPrintTiming
+*/
+int jsPrintTiming(int framenumber )
+{
+    uint32_t flags;
+    uint64_t pts,dts;
+    if(true==video_body->getVideoPtsDts(framenumber, &flags,&pts,&dts))
+    {
+        int64_t delta=0;
+        if(pts!=ADM_NO_PTS && dts!=ADM_NO_PTS) delta=(int64_t)pts-(int64_t)dts;
+        jsLog(JS_LOG_NORMAL,"Frame %"LU" : Flags 0x%"LX" pts=%"LLD" dts=%"LLD" delta=%"LLD" ms",framenumber,flags,pts,dts,delta/1000LL);
+    }else
+    {
+        jsLog(JS_LOG_NORMAL,"Cannot get info for frame %"LU,framenumber);
+    }
+    return 0;
+}
+
+/**
+    \fn    jsDumpSegments
+    \brief dump segment, video & all
+*/
+int jsDumpSegments (void)
+{// begin PostProcess
+        enterLock();
+        video_body->dumpSegments();
+        leaveLock(); 
+        return 0;
+}// end PostProcess
+/**
+        \fn jsDumpRefVideos
+*/
+int jsDumpRefVideos (void)
+{
+        enterLock();
+        video_body->dumpRefVideos();
+        leaveLock(); 
+
+        return 0;
+}
+/**
+    \fn dumpTiming
+    \brief dump segment, video & all
+*/
+JSBool dumpTiming(void)
+{// begin PostProcess
+        
+  
+        enterLock();
+        video_body->dumpTiming();
+        leaveLock(); 
+        
+        return 0;
+}// end PostProcess
+// EOF

Copied: branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/js/ADM_jsEditor_js.c (from rev 6206, branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src/ADM_jsEditor_js.c)
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src/ADM_jsEditor_js.c	2010-05-20 15:22:49 UTC (rev 6206)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/js/ADM_jsEditor_js.c	2010-05-20 15:22:52 UTC (rev 6207)
@@ -0,0 +1,256 @@
+/*
+--- DO NOT EDIT THIS FILE !!! ---
+
+This file has been generated automatically with 'jsapigen'.
+
+jsapigen is a glue-code generator for SpiderMonkey. It is distributed
+under the conditions of version 3 of the GNU General Public License.
+Please have a look at http://jsapigen.sourceforge.net.
+
+This file is NOT part of jsapigen and is NOT necessarily covered by
+jsapigen's license. For licensing information regarding this file,
+please refer to the software package which it is part of.
+
+*/
+
+#include "stdio.h"
+#include "ADM_jsEditor.h"
+void jsEditor(void)
+{
+        printf("Constructor invoked\n");
+}
+
+#ifdef HAVE_ALLOCA_H
+#include <alloca.h>
+static size_t jj_alloca_limit = 0;
+#endif
+#include <stdlib.h>
+#include <string.h>
+#include <wchar.h>
+#ifdef HAVE_ALLOCA_H
+#endif
+#include <jsapi.h>
+#ifndef JS_THREADSAFE
+#if JS_VERSION <= 170
+#define jsrefcount int
+#define JS_BeginRequest(cx)
+#define JS_EndRequest(cx)
+#define JS_SuspendRequest(cx)
+#define JS_ResumeRequest(cx, saveDepth)
+#endif
+#endif
+#ifndef JS_FS
+#define JS_FS(name, call, nargs, flags, extra) {name, call, nargs, flags, extra}
+#endif
+#ifndef JS_FS_END
+#define JS_FS_END {NULL, NULL, 0, 0, 0}
+#endif
+
+static JSBool
+jjeditorprintTiming(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval)
+{
+    JSObject * var2;
+    int var3;
+    int var6;
+    int var7;
+    int var8;
+    jsval var9;
+    int32 var10;
+    jsval var11;
+    JSBool var1;
+    var2 = NULL;
+    var3 = 0;
+    var6 = 0;
+    var7 = 0;
+    var8 = 0;
+    var9 = JSVAL_NULL;
+    var10 = 0;
+    var11 = JSVAL_NULL;
+    var1 = JS_FALSE;
+    var2 = obj;
+    var6 = argc;
+    var8 = 0;
+    var8 = var8 < var6;
+    if (var8) {
+    var9 = argv[0];
+    if (JS_ValueToInt32(cx, var9, &var10) != JS_TRUE) {
+        goto do_return;
+    }
+    var7 = (int)var10;
+    }
+    var3 = jsPrintTiming(var7);
+    if (JS_NewNumberValue(cx, var3, &var11) != JS_TRUE) {
+        goto do_return;
+    }
+    argv[argc+0] = var11;
+    if (rval) {
+        *rval = var11;
+    }
+    var1 = JS_TRUE;
+    do_return:
+    return var1;
+}
+static JSBool
+jjeditordumpSegment(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval)
+{
+    JSObject * var13;
+    int var14;
+    int var17;
+    jsval var18;
+    JSBool var12;
+    var13 = NULL;
+    var14 = 0;
+    var17 = 0;
+    var18 = JSVAL_NULL;
+    var12 = JS_FALSE;
+    var13 = obj;
+    var17 = argc;
+    var14 = jsDumpSegments();
+    if (JS_NewNumberValue(cx, var14, &var18) != JS_TRUE) {
+        goto do_return;
+    }
+    argv[argc+0] = var18;
+    if (rval) {
+        *rval = var18;
+    }
+    var12 = JS_TRUE;
+    do_return:
+    return var12;
+}
+static JSBool
+jjeditordumpRefVideo(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval)
+{
+    JSObject * var20;
+    int var21;
+    int var24;
+    jsval var25;
+    JSBool var19;
+    var20 = NULL;
+    var21 = 0;
+    var24 = 0;
+    var25 = JSVAL_NULL;
+    var19 = JS_FALSE;
+    var20 = obj;
+    var24 = argc;
+    var21 = jsDumpRefVideos();
+    if (JS_NewNumberValue(cx, var21, &var25) != JS_TRUE) {
+        goto do_return;
+    }
+    argv[argc+0] = var25;
+    if (rval) {
+        *rval = var25;
+    }
+    var19 = JS_TRUE;
+    do_return:
+    return var19;
+}
+static JSBool
+jjeditor__construct__(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval)
+{
+    JSObject * var27;
+    int var31;
+    JSBool var26;
+    var27 = NULL;
+    var31 = 0;
+    var26 = JS_FALSE;
+    var27 = obj;
+    var31 = argc;
+    jsEditor();
+    var26 = JS_TRUE;
+    return var26;
+}
+static JSPropertySpec jj_static_ps[] = {
+    {NULL, 0, 0, NULL, NULL}
+};
+static JSPropertySpec jj_ps[] = {
+    {NULL, 0, 0, NULL, NULL}
+};
+static JSFunctionSpec jj_static_fs[] = {
+    JS_FS_END
+};
+static JSFunctionSpec jj_fs[] = {
+    JS_FS_END
+};
+static JSPropertySpec jjeditor_static_ps[] = {
+    {NULL, 0, 0, NULL, NULL}
+};
+static JSPropertySpec jjeditor_ps[] = {
+    {NULL, 0, 0, NULL, NULL}
+};
+static JSFunctionSpec jjeditor_static_fs[] = {
+    JS_FS("printTiming", jjeditorprintTiming, 1, 0, 1),
+    JS_FS("dumpSegment", jjeditordumpSegment, 0, 0, 1),
+    JS_FS("dumpRefVideo", jjeditordumpRefVideo, 0, 0, 1),
+    JS_FS_END
+};
+static JSFunctionSpec jjeditor_fs[] = {
+    JS_FS_END
+};
+static JSClass jjeditor_class = {
+    "editor",
+    0,
+    JS_PropertyStub,
+    JS_PropertyStub,
+    JS_PropertyStub,
+    JS_PropertyStub,
+    JS_EnumerateStub,
+    JS_ResolveStub,
+    JS_ConvertStub,
+    JS_FinalizeStub,
+    NULL,
+    NULL,
+    NULL,
+    jjeditor__construct__,
+    NULL,
+    NULL,
+    NULL,
+    NULL
+};
+static JSObject *
+jjeditor_init(JSContext *cx, JSObject *obj)
+{
+    JSObject *parent_proto, *proto;
+    JSClass *class;
+    if (!cx || !obj) {
+        JS_ReportError(cx, "invalid parameter");
+        return NULL;
+    }
+    if (!JS_EnterLocalRootScope(cx)) {
+        JS_ReportError(cx, "JS_EnterLocalRootScope failed");
+        return NULL;
+    }
+    parent_proto = NULL;
+    proto = NULL;
+    parent_proto = JS_NewObject(cx, NULL, NULL, NULL);
+    if (!parent_proto) {
+        JS_LeaveLocalRootScope(cx);
+        JS_ReportError(cx, "failed to create prototype");
+        return NULL;
+    }
+    class = &jjeditor_class;
+    proto = JS_InitClass(cx, obj, parent_proto, class, jjeditor__construct__, 0, jjeditor_ps, jjeditor_fs, jjeditor_static_ps, jjeditor_static_fs);
+    if (!proto) {
+        JS_LeaveLocalRootScope(cx);
+        JS_ReportError(cx, "failed to init class");
+        return NULL;
+    }
+    JS_LeaveLocalRootScope(cx);
+    return proto;
+}
+
+
+JSObject *jsEditorInit(JSContext *cx,JSObject *obj)
+{
+          if (JS_DefineFunctions(cx, obj, jj_static_fs) != JS_TRUE) 
+          {
+                return NULL;
+          }
+          return jjeditor_init(cx,obj);
+}
+
+JSFunctionSpec  *jsGetEditFunctions(void)
+{
+        return jjeditor_static_fs;
+}
+
+

Copied: branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/js/ADM_jsEditor_js.idl (from rev 6206, branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src/ADM_jsEditor_js.idl)
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src/ADM_jsEditor_js.idl	2010-05-20 15:22:49 UTC (rev 6206)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/js/ADM_jsEditor_js.idl	2010-05-20 15:22:52 UTC (rev 6207)
@@ -0,0 +1,37 @@
+%{
+#include "stdio.h"
+#include "ADM_jsEditor.h"
+void jsEditor(void)
+{
+        printf("Constructor invoked\n");
+}
+%}
+        /*            JSFUNC      C FUNC  PARAM     */
+class editor
+{
+        /*            JSFUNC                 C FUNC           PARAM     */
+        function int printTiming     : jsPrintTiming(int ) <static>;
+        function int dumpSegment     : jsDumpSegments()    <static>;
+        function int dumpRefVideo    : jsDumpRefVideos()   <static>;
+        /*            JSFUNC                 C FUNC           PARAM     */
+        
+        construct                          : jsEditor  ( ) <static>     ; 
+};
+
+%<
+
+JSObject *jsEditorInit(JSContext *cx,JSObject *obj)
+{
+          if (JS_DefineFunctions(cx, obj, jj_static_fs) != JS_TRUE) 
+          {
+                return NULL;
+          }
+          return jjeditor_init(cx,obj);
+}
+
+JSFunctionSpec  *jsGetEditFunctions(void)
+{
+        return jjeditor_static_fs;
+}
+
+%>

Copied: branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/js/ADM_jsIf.cpp (from rev 6206, branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src/ADM_jsIf.cpp)
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src/ADM_jsIf.cpp	2010-05-20 15:22:49 UTC (rev 6206)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/js/ADM_jsIf.cpp	2010-05-20 15:22:52 UTC (rev 6207)
@@ -0,0 +1,350 @@
+/**
+    \file ADM_JSif.cpp
+    \brief interface to js
+*/
+
+/***************************************************************************
+ *                                                                         *
+ *   This program is free software; you can redistribute it and/or modify  *
+ *   it under the terms of the GNU General Public License as published by  *
+ *   the Free Software Foundation; either version 2 of the License, or     *
+ *   (at your option) any later version.                                   *
+ *                                                                         *
+ ***************************************************************************/
+
+#include "ADM_js.h"
+#include <stdarg.h>
+#include <vector>
+#include "ADM_editor/ADM_edit.hxx"
+void    A_Resync(void);
+
+/* our variables */
+static jsLoggerFunc *jsLogger=NULL;
+static void *jsLoggerCookie=NULL;
+vector <ADM_JS_HOOK >jsHooks;
+extern ADM_Composer *video_body;
+extern bool ADM_JSDialogFactoryInit(JSContext *cx, JSObject *obj);
+#define JSVAR(a,b,c) a b=c
+
+#if defined( __MINGW32__) 
+ pthread_t g_pThreadSpidermonkey ;
+#else
+JSVAR( pthread_t, g_pThreadSpidermonkey , 0);
+#endif
+JSVAR( pthread_mutex_t, g_pSpiderMonkeyMutex , PTHREAD_MUTEX_INITIALIZER);
+// expose our main javascript context to the entire program
+static bool g_bJSSuccess=false;
+static JSObject   *g_pObject=NULL;
+static JSContext  *g_pCx=NULL;
+static JSRuntime  *g_pRt=NULL;
+
+static JSClass global_class = {
+            "global", JSCLASS_GLOBAL_FLAGS,
+            JS_PropertyStub, JS_PropertyStub, JS_PropertyStub, JS_PropertyStub,
+            JS_EnumerateStub, JS_ResolveStub, JS_ConvertStub, JS_FinalizeStub,
+            JSCLASS_NO_OPTIONAL_MEMBERS
+            };
+
+extern void  printJSError(JSContext *cx, const char *message, JSErrorReport *report);
+/**
+    \fn parseECMAScript
+    \brief Compile & execute ecma script
+*/
+bool parseECMAScript(const char *name)
+{// begin parseECMAScript
+	jsval rval;
+	uintN lineno = 0;
+	g_bJSSuccess = 0;
+	ADM_info("Spidermonkey compiling \"%s\"...",name);
+	JSScript *pJSScript = JS_CompileFile(g_pCx, g_pObject, name);
+	ADM_info("Done.\n");
+	if(pJSScript != NULL)
+	{// begin execute external file
+		printf("Spidermonkey executing \"%s\"...\n",name);
+		JSBool ok = JS_ExecuteScript(g_pCx, g_pObject, pJSScript, &rval);
+		JS_DestroyScript(g_pCx,pJSScript);
+		ADM_info("Done.\n");
+	}// end execute external file
+        // Run garbage collector now, it is safe
+    JS_GC(g_pCx);
+	A_Resync();
+	return g_bJSSuccess;
+}// end parseECMAScript
+/**
+    \fn jsLogger
+*/
+bool isJsLogRedirected(void)
+{
+    if(jsLogger) return true;
+    return false;
+}
+/**
+    \fn jsEvaluate
+*/
+static bool jsEvaluate(const char *str)
+{
+jsval rval;
+   JS_EvaluateScript(g_pCx,g_pObject,str,strlen(str),"dummy",1,&rval);
+   return true; 
+}
+/**
+    \fn    interactiveECMAScript
+    \brief interprete & execute ecma script (interactive)
+*/
+bool interactiveECMAScript(const char *name)
+{
+    ADM_startShell(jsEvaluate);
+    JS_GC(g_pCx);
+	A_Resync();
+    ADM_info("Ending JS shell...\n");
+	return true;
+}
+/**
+    \fn jsLog
+*/
+bool jsLog(JS_LOG_TYPE type, const char *prf,...)
+{
+ static char print_buffer[1024];
+  	
+		va_list 	list;
+		va_start(list,	prf);
+		vsnprintf(print_buffer,1023,prf,list);
+		va_end(list);
+		print_buffer[1023]=0; // ensure the string is terminated
+        if(true==isJsLogRedirected())
+            jsLogger(jsLoggerCookie,type,print_buffer);
+        else
+        {
+            if(type==JS_LOG_ERROR)
+                GUI_Error_HIG("Spidermonkey ECMAScript Error","%s",print_buffer);
+            else
+                ADM_warning("[JS]%s\n",print_buffer);
+        }
+
+        return true;
+}
+
+/**
+    \fn ADM_jsRegisterLogger
+*/
+bool ADM_jsRegisterLogger(void *cookie,jsLoggerFunc *fun)
+{
+    jsLoggerCookie=cookie;
+    jsLogger=fun;
+    return true;
+}
+/**
+    \fn ADM_jsUnregisterLogger
+*/
+bool ADM_jsUnregisterLogger(void)
+{
+    jsLogger=NULL;
+    return true;
+}
+/**
+    \fn jsRegisterAvidemux
+*/
+extern "C" JSFunctionSpec  *jsGetIfFunctions(void);
+extern "C" JSFunctionSpec  *jsGetTestFunctions(void);
+extern "C" JSFunctionSpec  *jsGetAdmFunctions(void);
+extern "C" JSFunctionSpec  *jsGetEditFunctions(void);
+extern "C" JSFunctionSpec  *jsGetDialogFactoryFunctions(void);
+extern "C" JSObject *jsEditorInit(JSContext *cx,JSObject *obj);
+extern "C" JSObject *jsAvidemuxInit(JSContext *cx,JSObject *obj);
+static bool registerOne(const char *name,const char *text,JSFunctionSpec *s,JSContext *cx,JSObject *obj)
+{
+    if (JS_DefineFunctions(cx, obj, s) != JS_TRUE) 
+    {
+            ADM_error("Cannot register %s functions\n",name);
+            return false;
+    }
+    ADM_info("Registered %s functions\n",name);
+    ADM_JS_HOOK h;
+    h.name=name;    
+    h.text=text;
+    h.jsFunctions=s;
+    jsHooks.push_back(h);
+    return true;
+}
+static void  dump(JSFunctionSpec *f)
+{
+    while(f->name)
+    {
+        jsLog(JS_LOG_NORMAL,"    %s",f->name);
+        f++;
+    }
+}
+/**
+    \fn jsHelp
+    \brief help command
+
+*/
+extern "C" 
+{
+void jsHelp(const char *s)
+{
+int n=jsHooks.size();
+    if(!s) goto none;
+    {
+    for(int i=0;i<n;i++)
+        if(!strcasecmp(s,jsHooks[i].name))
+        {
+            const char *t=jsHooks[i].text;
+            if(t)
+                jsLog(JS_LOG_NORMAL,"%s",t);
+            return dump(jsHooks[i].jsFunctions);
+        }
+    }
+//    if(!strcasecmp(s,"load")) return dump(jsGetAvidemuxFunctions());
+none:
+        jsLog(JS_LOG_NORMAL,"please use help(\"xxx\") with xx among");
+
+        for(int i=0;i<n;i++)
+            jsLog(JS_LOG_NORMAL,"    %s",jsHooks[i].name);
+
+}
+} // extern "C"
+/**
+    \fn jsRegisterAvidemux
+    \brief Register avidemux hookd
+*/
+static bool jsRegisterAvidemux(JSContext *cx,JSObject *obj)
+{
+ADM_JS_HOOK h;
+        registerOne("Debug","",   jsGetIfFunctions(),    cx,obj);
+        registerOne("Test","", jsGetTestFunctions(),  cx,obj);
+        
+        // Register also our class (for  help() )
+            h.name="adm";
+            h.text="Please prefix this with adm.";
+            h.jsFunctions=jsGetAdmFunctions();
+            jsHooks.push_back(h);
+            jsAvidemuxInit(cx,obj);
+        // Register also edit
+            h.name="editor";
+            h.text="Please prefix this with editor.";
+            h.jsFunctions=jsGetEditFunctions();
+            jsEditorInit(cx,obj);
+            jsHooks.push_back(h);
+        // Register dialogFactory functions
+#if 0
+            h.name="dialog";
+            h.text=".";
+            h.jsFunctions=jsGetDialogFactoryFunctions();
+            jsHooks.push_back(h);
+#endif
+            return ADM_JSDialogFactoryInit(cx,obj);
+}
+/**
+    \fn SpidermonkeyInit
+*/
+bool SpidermonkeyInit()
+{// begin SpidermonkeyInit
+	// setup JS
+	g_pCx = NULL;
+	g_pObject = NULL;
+	g_pRt = NULL;
+	JSRuntime *rt = JS_NewRuntime(1000000L);
+	g_pRt = rt;
+	if ( !rt  )
+	{
+		// Do some error reporting
+		ADM_error("Spidermonkey failed to initialize runtime!\n");
+        return false;
+	}
+	
+// begin runtime created
+    g_pCx = JS_NewContext(rt, 8192);
+    if ( !g_pCx  )
+    {
+        // Do some error reporting
+        ADM_error("Spidermonkey failed to initialize context!\n");
+        return false;
+    }
+   
+   // begin context created
+    g_pObject = JS_NewObject(g_pCx, &global_class, 0, 0);
+    if(!g_pObject)
+    {
+        ADM_error("Cannot initialize object\n");
+        return false;
+    }
+    if(JS_TRUE!=JS_InitStandardClasses(g_pCx, g_pObject))
+    {
+        ADM_error("Cannot initialize standard classes\n");
+        return false;
+    }
+    // register error handler
+    JS_SetErrorReporter(g_pCx, printJSError);
+        
+    //register our functions
+    jsRegisterAvidemux(g_pCx,g_pObject);
+    ADM_info("Spidermonkey initialized\n");
+    return true;
+
+}// end SpidermonkeyInit
+/**
+    \fn SpidermonkeyDestroy
+*/
+void SpidermonkeyDestroy()
+{// begin SpidermonkeyDestroy
+#ifdef ADM_JS_THREADSAFE
+	JS_SetContextThread(g_pCx);	
+#endif
+	JS_DestroyContext(g_pCx);
+	JS_DestroyRuntime(g_pRt);
+}// end SpidermonkeyDestroy
+/**
+    \fn StartThreadSpidermonkey
+*/
+void *StartThreadSpidermonkey(void *pData)
+{// begin StartThreadSpidermonkey
+        pthread_mutex_lock(&g_pSpiderMonkeyMutex);
+        /*
+        The following mailling list post describes how to CORRECTLY use
+        the threading API support with Spidermonkey
+        "Thread from SpiderMonkey newsgroup"
+        http://archive.gingerall.cz/archives/public/sablot2004/msg00117.html
+        */
+        // Notify the Spidermonkey that we'll be processing in a thread
+#ifdef ADM_JS_THREADSAFE
+        JS_SetContextThread(g_pCx);
+        JS_BeginRequest(g_pCx);
+#endif
+        bool ret = false;
+        const char *pScriptFile = static_cast<const char *>(pData);
+        ret = parseECMAScript(pScriptFile);
+        if(ret == true)
+        {
+                video_body->setProjectName(pScriptFile);
+        }
+        // Notify Spidermonkey that our thread processing has finished
+#ifdef ADM_JS_THREADSAFE
+        JS_EndRequest(g_pCx);
+        JS_ClearContextThread(g_pCx);
+#endif
+        pthread_mutex_unlock(&g_pSpiderMonkeyMutex);
+
+        return NULL;
+}// end StartThreadSpidermonkey
+/**
+    \fn JS_setSuccess
+*/
+extern "C" void jsSetSuccess(int bSuccess)
+{// begin JS_setSuccess
+	g_bJSSuccess = bSuccess;
+	jsLog(JS_LOG_NORMAL,"[ECMA] success : %d\n", g_bJSSuccess);
+}// end JS_setSuccess
+/**
+    \fn SpidermonkeyExit
+*/
+bool SpidermonkeyExit(void)
+{
+    ADM_info("Waiting for Spidermonkey to finish...\n");
+    pthread_mutex_lock(&g_pSpiderMonkeyMutex);
+    ADM_info("Cleaning up Spidermonkey.\n");
+    SpidermonkeyDestroy();
+    pthread_mutex_unlock(&g_pSpiderMonkeyMutex);
+    return true;
+}
+//EOF

Copied: branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/js/ADM_jsIf_js.c (from rev 6206, branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src/ADM_jsIf_js.c)
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src/ADM_jsIf_js.c	2010-05-20 15:22:49 UTC (rev 6206)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/js/ADM_jsIf_js.c	2010-05-20 15:22:52 UTC (rev 6207)
@@ -0,0 +1,504 @@
+/*
+--- DO NOT EDIT THIS FILE !!! ---
+
+This file has been generated automatically with 'jsapigen'.
+
+jsapigen is a glue-code generator for SpiderMonkey. It is distributed
+under the conditions of version 3 of the GNU General Public License.
+Please have a look at http://jsapigen.sourceforge.net.
+
+This file is NOT part of jsapigen and is NOT necessarily covered by
+jsapigen's license. For licensing information regarding this file,
+please refer to the software package which it is part of.
+
+*/
+
+#include "stdio.h"
+#include "ADM_jsAvidemux.h"
+#include "ADM_jsDebug.h"
+
+#ifdef HAVE_ALLOCA_H
+#include <alloca.h>
+static size_t jj_alloca_limit = 0;
+#endif
+#include <stdlib.h>
+#include <string.h>
+#include <wchar.h>
+#ifdef HAVE_ALLOCA_H
+#endif
+#include <jsapi.h>
+#ifndef JS_THREADSAFE
+#if JS_VERSION <= 170
+#define jsrefcount int
+#define JS_BeginRequest(cx)
+#define JS_EndRequest(cx)
+#define JS_SuspendRequest(cx)
+#define JS_ResumeRequest(cx, saveDepth)
+#endif
+#endif
+#ifndef JS_FS
+#define JS_FS(name, call, nargs, flags, extra) {name, call, nargs, flags, extra}
+#endif
+#ifndef JS_FS_END
+#define JS_FS_END {NULL, NULL, 0, 0, 0}
+#endif
+
+static JSBool
+jjadmPopupError(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval)
+{
+    JSObject * var2;
+    int var6;
+    char * var7;
+    int var8;
+    jsval var9;
+    JSString * var10;
+    jsval var86;
+    size_t var11;
+    size_t var12;
+    int var14;
+    jschar * var15;
+    jsval var87;
+    JSBool var1;
+    var2 = NULL;
+    var6 = 0;
+    var7 = NULL;
+    var8 = 0;
+    var9 = JSVAL_NULL;
+    var10 = NULL;
+    var86 = JSVAL_NULL;
+    var11 = 0;
+    var12 = 0;
+    var14 = 0;
+    var15 = NULL;
+    var87 = JSVAL_NULL;
+    var1 = JS_FALSE;
+    var2 = obj;
+    var6 = argc;
+    var8 = 0;
+    var8 = var8 < var6;
+    if (var8) {
+    var9 = argv[0];
+    var10 = JS_ValueToString(cx, var9);
+    if (!var10) {
+        goto do_return;
+    }
+    var86 = STRING_TO_JSVAL(var10);
+    argv[argc+0] = var86;
+    var11 = JS_GetStringLength(var10);
+    var12 = 1;
+    var12 += var11;
+#ifdef HAVE_ALLOCA
+    if (var12 < jj_alloca_limit) {
+        var7 = alloca(var12);
+    } else {
+#endif
+        var7 = malloc(var12);
+        if (!var7) {
+            goto do_return;
+        } else {
+            var14 = 1;
+        }
+#ifdef HAVE_ALLOCA
+    }
+#endif
+    var15 = JS_GetStringChars(var10);
+    var87 = STRING_TO_JSVAL(var10);
+    argv[argc+1] = var87;
+    {
+        size_t i;
+        for (i = 0; i < var11; ++i) {
+            var7[i] = var15[i];
+        }
+        var7[var11] = '\0';
+    }
+    }
+    jsPopupError(var7);
+    var1 = JS_TRUE;
+    do_return:
+    if (var14) {
+        free(var7);
+        var7 = NULL;
+        var14 = 0;
+    }
+    return var1;
+}
+static JSBool
+jjadmpPopupInfo(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval)
+{
+    JSObject * var17;
+    int var21;
+    char * var22;
+    int var23;
+    jsval var24;
+    JSString * var25;
+    jsval var88;
+    size_t var26;
+    size_t var27;
+    int var29;
+    jschar * var30;
+    jsval var89;
+    JSBool var16;
+    var17 = NULL;
+    var21 = 0;
+    var22 = NULL;
+    var23 = 0;
+    var24 = JSVAL_NULL;
+    var25 = NULL;
+    var88 = JSVAL_NULL;
+    var26 = 0;
+    var27 = 0;
+    var29 = 0;
+    var30 = NULL;
+    var89 = JSVAL_NULL;
+    var16 = JS_FALSE;
+    var17 = obj;
+    var21 = argc;
+    var23 = 0;
+    var23 = var23 < var21;
+    if (var23) {
+    var24 = argv[0];
+    var25 = JS_ValueToString(cx, var24);
+    if (!var25) {
+        goto do_return;
+    }
+    var88 = STRING_TO_JSVAL(var25);
+    argv[argc+0] = var88;
+    var26 = JS_GetStringLength(var25);
+    var27 = 1;
+    var27 += var26;
+#ifdef HAVE_ALLOCA
+    if (var27 < jj_alloca_limit) {
+        var22 = alloca(var27);
+    } else {
+#endif
+        var22 = malloc(var27);
+        if (!var22) {
+            goto do_return;
+        } else {
+            var29 = 1;
+        }
+#ifdef HAVE_ALLOCA
+    }
+#endif
+    var30 = JS_GetStringChars(var25);
+    var89 = STRING_TO_JSVAL(var25);
+    argv[argc+1] = var89;
+    {
+        size_t i;
+        for (i = 0; i < var26; ++i) {
+            var22[i] = var30[i];
+        }
+        var22[var26] = '\0';
+    }
+    }
+    jsPopupInfo(var22);
+    var16 = JS_TRUE;
+    do_return:
+    if (var29) {
+        free(var22);
+        var22 = NULL;
+        var29 = 0;
+    }
+    return var16;
+}
+static JSBool
+jjadmPrint(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval)
+{
+    JSObject * var32;
+    int var36;
+    char * var37;
+    int var38;
+    jsval var39;
+    JSString * var40;
+    jsval var90;
+    size_t var41;
+    size_t var42;
+    int var44;
+    jschar * var45;
+    jsval var91;
+    JSBool var31;
+    var32 = NULL;
+    var36 = 0;
+    var37 = NULL;
+    var38 = 0;
+    var39 = JSVAL_NULL;
+    var40 = NULL;
+    var90 = JSVAL_NULL;
+    var41 = 0;
+    var42 = 0;
+    var44 = 0;
+    var45 = NULL;
+    var91 = JSVAL_NULL;
+    var31 = JS_FALSE;
+    var32 = obj;
+    var36 = argc;
+    var38 = 0;
+    var38 = var38 < var36;
+    if (var38) {
+    var39 = argv[0];
+    var40 = JS_ValueToString(cx, var39);
+    if (!var40) {
+        goto do_return;
+    }
+    var90 = STRING_TO_JSVAL(var40);
+    argv[argc+0] = var90;
+    var41 = JS_GetStringLength(var40);
+    var42 = 1;
+    var42 += var41;
+#ifdef HAVE_ALLOCA
+    if (var42 < jj_alloca_limit) {
+        var37 = alloca(var42);
+    } else {
+#endif
+        var37 = malloc(var42);
+        if (!var37) {
+            goto do_return;
+        } else {
+            var44 = 1;
+        }
+#ifdef HAVE_ALLOCA
+    }
+#endif
+    var45 = JS_GetStringChars(var40);
+    var91 = STRING_TO_JSVAL(var40);
+    argv[argc+1] = var91;
+    {
+        size_t i;
+        for (i = 0; i < var41; ++i) {
+            var37[i] = var45[i];
+        }
+        var37[var41] = '\0';
+    }
+    }
+    jsPrint(var37);
+    var31 = JS_TRUE;
+    do_return:
+    if (var44) {
+        free(var37);
+        var37 = NULL;
+        var44 = 0;
+    }
+    return var31;
+}
+static JSBool
+jjprint(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval)
+{
+    JSObject * var47;
+    int var51;
+    char * var52;
+    int var53;
+    jsval var54;
+    JSString * var55;
+    jsval var92;
+    size_t var56;
+    size_t var57;
+    int var59;
+    jschar * var60;
+    jsval var93;
+    JSBool var46;
+    var47 = NULL;
+    var51 = 0;
+    var52 = NULL;
+    var53 = 0;
+    var54 = JSVAL_NULL;
+    var55 = NULL;
+    var92 = JSVAL_NULL;
+    var56 = 0;
+    var57 = 0;
+    var59 = 0;
+    var60 = NULL;
+    var93 = JSVAL_NULL;
+    var46 = JS_FALSE;
+    var47 = obj;
+    var51 = argc;
+    var53 = 0;
+    var53 = var53 < var51;
+    if (var53) {
+    var54 = argv[0];
+    var55 = JS_ValueToString(cx, var54);
+    if (!var55) {
+        goto do_return;
+    }
+    var92 = STRING_TO_JSVAL(var55);
+    argv[argc+0] = var92;
+    var56 = JS_GetStringLength(var55);
+    var57 = 1;
+    var57 += var56;
+#ifdef HAVE_ALLOCA
+    if (var57 < jj_alloca_limit) {
+        var52 = alloca(var57);
+    } else {
+#endif
+        var52 = malloc(var57);
+        if (!var52) {
+            goto do_return;
+        } else {
+            var59 = 1;
+        }
+#ifdef HAVE_ALLOCA
+    }
+#endif
+    var60 = JS_GetStringChars(var55);
+    var93 = STRING_TO_JSVAL(var55);
+    argv[argc+1] = var93;
+    {
+        size_t i;
+        for (i = 0; i < var56; ++i) {
+            var52[i] = var60[i];
+        }
+        var52[var56] = '\0';
+    }
+    }
+    jsPrint2(var52);
+    var46 = JS_TRUE;
+    do_return:
+    if (var59) {
+        free(var52);
+        var52 = NULL;
+        var59 = 0;
+    }
+    return var46;
+}
+static JSBool
+jjhelp(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval)
+{
+    JSObject * var62;
+    int var66;
+    char * var67;
+    int var68;
+    jsval var69;
+    JSString * var70;
+    jsval var94;
+    size_t var71;
+    size_t var72;
+    int var74;
+    jschar * var75;
+    jsval var95;
+    JSBool var61;
+    var62 = NULL;
+    var66 = 0;
+    var67 = NULL;
+    var68 = 0;
+    var69 = JSVAL_NULL;
+    var70 = NULL;
+    var94 = JSVAL_NULL;
+    var71 = 0;
+    var72 = 0;
+    var74 = 0;
+    var75 = NULL;
+    var95 = JSVAL_NULL;
+    var61 = JS_FALSE;
+    var62 = obj;
+    var66 = argc;
+    var68 = 0;
+    var68 = var68 < var66;
+    if (var68) {
+    var69 = argv[0];
+    var70 = JS_ValueToString(cx, var69);
+    if (!var70) {
+        goto do_return;
+    }
+    var94 = STRING_TO_JSVAL(var70);
+    argv[argc+0] = var94;
+    var71 = JS_GetStringLength(var70);
+    var72 = 1;
+    var72 += var71;
+#ifdef HAVE_ALLOCA
+    if (var72 < jj_alloca_limit) {
+        var67 = alloca(var72);
+    } else {
+#endif
+        var67 = malloc(var72);
+        if (!var67) {
+            goto do_return;
+        } else {
+            var74 = 1;
+        }
+#ifdef HAVE_ALLOCA
+    }
+#endif
+    var75 = JS_GetStringChars(var70);
+    var95 = STRING_TO_JSVAL(var70);
+    argv[argc+1] = var95;
+    {
+        size_t i;
+        for (i = 0; i < var71; ++i) {
+            var67[i] = var75[i];
+        }
+        var67[var71] = '\0';
+    }
+    }
+    jsHelp(var67);
+    var61 = JS_TRUE;
+    do_return:
+    if (var74) {
+        free(var67);
+        var67 = NULL;
+        var74 = 0;
+    }
+    return var61;
+}
+static JSBool
+jjsetSuccess(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval)
+{
+    JSObject * var77;
+    int var81;
+    int var82;
+    int var83;
+    jsval var84;
+    int32 var85;
+    JSBool var76;
+    var77 = NULL;
+    var81 = 0;
+    var82 = 0;
+    var83 = 0;
+    var84 = JSVAL_NULL;
+    var85 = 0;
+    var76 = JS_FALSE;
+    var77 = obj;
+    var81 = argc;
+    var83 = 0;
+    var83 = var83 < var81;
+    if (var83) {
+    var84 = argv[0];
+    if (JS_ValueToInt32(cx, var84, &var85) != JS_TRUE) {
+        goto do_return;
+    }
+    var82 = (int)var85;
+    }
+    jsSetSuccess(var82);
+    var76 = JS_TRUE;
+    do_return:
+    return var76;
+}
+static JSPropertySpec jj_static_ps[] = {
+    {NULL, 0, 0, NULL, NULL}
+};
+static JSPropertySpec jj_ps[] = {
+    {NULL, 0, 0, NULL, NULL}
+};
+static JSFunctionSpec jj_static_fs[] = {
+    JS_FS("admPopupError", jjadmPopupError, 1, 0, 2),
+    JS_FS("admpPopupInfo", jjadmpPopupInfo, 1, 0, 2),
+    JS_FS("admPrint", jjadmPrint, 1, 0, 2),
+    JS_FS("print", jjprint, 1, 0, 2),
+    JS_FS("help", jjhelp, 1, 0, 2),
+    JS_FS("setSuccess", jjsetSuccess, 1, 0, 0),
+    JS_FS_END
+};
+static JSFunctionSpec jj_fs[] = {
+    JS_FS("admPopupError", jjadmPopupError, 1, 0, 2),
+    JS_FS("admpPopupInfo", jjadmpPopupInfo, 1, 0, 2),
+    JS_FS("admPrint", jjadmPrint, 1, 0, 2),
+    JS_FS("print", jjprint, 1, 0, 2),
+    JS_FS("help", jjhelp, 1, 0, 2),
+    JS_FS("setSuccess", jjsetSuccess, 1, 0, 0),
+    JS_FS_END
+};
+
+JSFunctionSpec  *jsGetIfFunctions(void)
+{
+        return jj_static_fs;
+}
+
+

Copied: branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/js/ADM_jsIf_js.idl (from rev 6206, branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src/ADM_jsIf_js.idl)
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src/ADM_jsIf_js.idl	2010-05-20 15:22:49 UTC (rev 6206)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/js/ADM_jsIf_js.idl	2010-05-20 15:22:52 UTC (rev 6207)
@@ -0,0 +1,25 @@
+%{
+#include "stdio.h"
+#include "ADM_jsAvidemux.h"
+#include "ADM_jsDebug.h"
+%}
+
+/*
+###############################################################
+       return JS function     CM Function  params
+###############################################################
+*/
+function void admPopupError : jsPopupError   (cstring  ) <static>;
+function void admpPopupInfo : jsPopupInfo    (cstring  ) <static>;
+function void admPrint      : jsPrint        (cstring  ) <static>;
+function void print         : jsPrint2       (cstring  ) <static>;
+function void help          : jsHelp         (cstring  ) <static>;
+function void setSuccess    : jsSetSuccess   (int  )   <static>;
+
+%<
+JSFunctionSpec  *jsGetIfFunctions(void)
+{
+        return jj_static_fs;
+}
+
+%>

Copied: branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/js/ADM_jsTestFactory.cpp (from rev 6206, branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src/ADM_jsTestFactory.cpp)
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src/ADM_jsTestFactory.cpp	2010-05-20 15:22:49 UTC (rev 6206)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/js/ADM_jsTestFactory.cpp	2010-05-20 15:22:52 UTC (rev 6207)
@@ -0,0 +1,444 @@
+/**
+    \file ADM_JSif.cpp
+    \brief interface to js
+
+ Author: Anish Mistry/mean/gruntster
+*/
+
+/***************************************************************************
+ *                                                                         *
+ *   This program is free software; you can redistribute it and/or modify  *
+ *   it under the terms of the GNU General Public License as published by  *
+ *   the Free Software Foundation; either version 2 of the License, or     *
+ *   (at your option) any later version.                                   *
+ *                                                                         *
+ ***************************************************************************/
+#include "ADM_js.h"
+#include "ADM_editor/ADM_edit.hxx"
+#include "DIA_fileSel.h"
+#include "DIA_factory.h"
+#include "ADM_jsTestFactory.h"
+#include "DIA_encoding.h"
+
+/**
+    \fn crashTest
+    \brief Force a crash
+*/
+int jsTestCrash(void)
+{
+  
+  int *foobar=NULL;
+  *foobar=0; // CRASH!
+  return true;
+}
+/**
+    \fn assertTest
+    \brief Force a crash
+*/
+int jsTestAssert(void)
+{
+  
+  ADM_assert(0);
+  return true;
+}
+
+
+/**
+    \fn jsTestFacInt
+*/
+int jsTestFacInt(void)
+{
+  uint32_t tog=0;
+   diaElemUInteger blend(&tog,QT_TR_NOOP("Uinteger"),0,255);
+    diaElem *elems[]={&blend   };
+    
+  if(diaFactoryRun(QT_TR_NOOP("Test uinteger"),1,elems))
+  {
+    jsLog(JS_LOG_NORMAL,"Value : %u\n",tog);
+    return true;
+  }
+  return false;
+}
+
+/**
+    \fn jsTestFacFloat
+*/
+int jsTestFacFloat(void)
+{
+  ELEM_TYPE_FLOAT tog=0;
+   diaElemFloat blend(&tog,QT_TR_NOOP("Float"),0,255);
+    diaElem *elems[]={&blend   };
+    
+  if(diaFactoryRun("Test float",1,elems))
+  {
+    jsLog(JS_LOG_NORMAL,"Value : %f\n",(float)tog);
+    return true;
+  }
+  return false;
+}
+
+/**
+    \fn jsTestFacToggle
+*/
+int jsTestFacToggle(void)
+{
+  uint32_t tog=0;
+  uint32_t test=0;
+   diaElemToggle blend(&tog,QT_TR_NOOP("Toggle"));
+    diaElemUInteger     bt(&test,"Entry",0,10);
+    diaElemUInteger     bt2(&test,"Entry",0,10);
+    diaElem *elems[]={&blend,&bt,&bt2   };
+    blend.link(1,&bt);
+    blend.link(0,&bt2);
+    
+  if(diaFactoryRun("Test Toggle",3,elems))
+   {
+    jsLog(JS_LOG_NORMAL,"Value : %u\n",tog);
+    return true;
+  }
+  return false;
+}
+
+/**
+    \fn jsTestFacMenu
+*/
+int jsTestFacMenu(void)
+{
+   uint32_t tog=4;
+   ELEM_TYPE_FLOAT f=1; 
+   
+    diaMenuEntry menu[]={
+                             {2,   QT_TR_NOOP("No Strategy"),NULL},
+                             {4,     QT_TR_NOOP("3:2 Pulldown"),NULL},
+                             {6,     QT_TR_NOOP("Pal/Secam"),NULL},
+                             {7,  QT_TR_NOOP("NTSC converted from PAL"),NULL}
+                          };
+   diaElemMenu blend(&tog,QT_TR_NOOP("menu"),4,menu);
+    
+    // Link it to another
+    diaElemFloat toggle(&f,"Linked float",1,2);
+    blend.link(&(menu[1]),1,&toggle);
+    //
+diaElem *elems[]={&blend,&toggle   };
+  if(diaFactoryRun("Test Menu",2,elems))
+   {
+    jsLog(JS_LOG_NORMAL,"Value : %"LU"\n",tog);
+    return true;
+  }
+  return false;
+}
+
+/**
+    \fn jsTestFacFile
+*/
+int jsTestFacFile(void)
+{
+   uint32_t tog=0;
+   char *test=ADM_strdup("Entry test1");
+    
+      diaElemFile fread(0,&test,"Entry");
+      diaElem *elems[]={&fread   };
+  if(diaFactoryRun("Test FileRead",1,elems))
+   {
+    jsLog(JS_LOG_NORMAL,"Value : %s\n",test);
+    if(test) ADM_dealloc(test);
+    return true;
+  }
+ if(test) ADM_dealloc(test);
+  return false;
+}
+
+/**
+    \fn jsTestFacDirSel
+*/
+int jsTestFacDirSel(void)
+{
+   uint32_t tog=0;
+   char *test=ADM_strdup("Entry test1");
+    
+  diaElemDirSelect fread(&test,"Entry");
+  diaElem *elems[]={&fread   };
+  if(diaFactoryRun("Test DirSel",1,elems))
+  {
+    jsLog(JS_LOG_NORMAL,"Value : %s\n",test);
+    if(test) ADM_dealloc(test);
+    return true;
+  }
+ if(test) ADM_dealloc(test);
+  return false;
+}
+
+/**
+    \fn jsTestFacBitrate
+*/
+int jsTestFacBitrate(void)
+{
+
+   COMPRES_PARAMS test={
+  COMPRESS_CQ,
+  1,
+  1500,
+  700,
+  1000,
+  ADM_ENC_CAP_CQ+ADM_ENC_CAP_2PASS+ADM_ENC_CAP_CBR+ADM_ENC_CAP_SAME
+  };
+    
+      diaElemBitrate bt(&test,"Entry");
+      diaElem *elems[]={&bt   };
+  if(diaFactoryRun("Test BitRate",1,elems))
+   {
+    
+    return true;
+  }
+  return false;
+}
+
+/**
+    \fn jsTestFacInt
+*/
+int jsTestFacBar(void)
+{
+    
+      diaElemBar bar1(25,"25");
+      diaElemBar bar2(65,"65");
+      diaElem *elems[]={&bar1,&bar2   };
+  if(diaFactoryRun("Test FileRead",2,elems))
+  {
+   return true;
+  }
+  return false;
+}
+
+void clickMe(void *cookie)
+{
+  GUI_Error_HIG("Button","Button pressed!"); 
+}
+
+/**
+    \fn jsTestFacButton
+*/
+int jsTestFacButton(void)
+{
+    
+      diaElemButton bar1("Button",clickMe,NULL);
+      diaElem *elems[]={&bar1   };
+  if(diaFactoryRun("Test Button",1,elems))
+  {
+    return true;
+  }
+  return false;
+}
+
+/**
+    \fn jsTestFacSlider
+*/
+int jsTestFacSlider(void)
+{
+  int32_t val=4;
+      diaElemSlider slide(&val,"foo", 0,10);
+      
+      diaElem *elems[]={&slide   };
+  if(diaFactoryRun("Test Slider",1,elems))
+  {
+    jsLog(JS_LOG_NORMAL,"Value : %d\n",(int)val);
+    return true;
+  }
+  return false;
+}
+
+/**
+    \fn jsTestFacInt
+*/
+int jsTestFacRoText(void)
+
+{
+    
+      diaElemReadOnlyText txt("blah blah","Value:");
+      
+      diaElem *elems[]={&txt   };
+  if(diaFactoryRun("Test FileRead",1,elems))
+  {
+    return true;
+  }
+  return false;
+}
+
+/**
+    \fn jsTestFacText
+*/
+int jsTestFacText(void)
+{
+    
+      char *foo=ADM_strdup("blah");
+      diaElemText txt(&foo,"Text",NULL);
+      
+      diaElem *elems[]={&txt   };
+  if(diaFactoryRun("Test FileRead",1,elems))
+ {
+    jsLog(JS_LOG_NORMAL,"Out:%s",foo);
+    if(foo) ADM_dealloc(foo);
+    return true;
+  }
+  if(foo) ADM_dealloc(foo);
+  return false;
+}
+
+/**
+    \fn jsTestFacInt
+*/
+int jsTestFacTab(void)
+{
+    
+      uint32_t test,test2;
+      
+      diaElemReadOnlyText txt("blah blah","Value:");
+      diaElemUInteger     bt(&test,"Entry",0,10);
+      diaElemUInteger     bt2(&test2,"Entry",0,10);
+      
+      
+      diaElem *elems1[]={&txt   };
+      diaElem *elems2[]={&bt,&bt2   };
+      
+      diaElemTabs tab1("T1",1,(diaElem **)elems1);
+      diaElemTabs tab2("T2",2,(diaElem **)elems2);
+      
+      diaElemTabs *tabs[2]={&tab1,&tab2};
+          
+      
+  if(diaFactoryRunTabs("Test FileRead",2,tabs))
+ {
+    return true;
+  }
+  return false;
+}
+
+/**
+    \fn jsTestFacInt
+*/
+int jsTestFacFrame(void)
+{
+    
+      uint32_t test,test2;
+      
+      diaElemReadOnlyText align("*****","Value:");
+      diaElemReadOnlyText txt("blah blah","Value:");
+      diaElemUInteger     bt(&test,"Entry1",0,10);
+      diaElemUInteger     bt2(&test2,"Entry2",0,10);
+      diaElemFrame        frm("Frame1");
+      
+      frm.swallow(&txt);
+      frm.swallow(&bt);
+      frm.swallow(&bt2);
+      
+         diaElem *elems[]={&align,&frm   };
+  if(diaFactoryRun("Test frame",2,elems))
+ {
+    return true;
+  }
+  return false;
+}
+
+
+/**
+    \fn jsTestFacHex
+*/
+int jsTestFacHex(void)
+{
+    
+      uint8_t data[100];
+      for(int i=0;i<100;i++) data[i]=i;
+      
+      diaElemHex binhex("*****",100,data);
+      
+      
+         diaElem *elems[]={&binhex   };
+  if(diaFactoryRun("Test binHex",1,elems))
+  {
+    return true;
+  }
+  return false;
+      
+}
+
+/**
+    \fn jsTestFacMatrix
+*/
+int jsTestFacMatrix(void)
+{
+    
+      uint8_t data[16];
+      for(int i=0;i<100;i++) data[i]=i;
+      
+      diaElemMatrix Matrix(data,"Matrix",4);
+      
+      
+         diaElem *elems[]={&Matrix   };
+  if(diaFactoryRun("Test Matrix",1,elems))
+  {
+      for(int x=0;x<4*4;x++)
+      {
+          if(x && !(x&3)) printf("\n");
+          jsLog(JS_LOG_NORMAL,"%02x ",data[x]);
+          
+      }
+      return true;
+  }
+  return false;
+}
+
+/**
+    \fn jsTestFacThreadcount
+*/
+int jsTestFacThreadCount(void)
+{
+	uint32_t val=1;
+	diaElemThreadCount threadcount(&val,"ThreadCount");
+      
+    diaElem *elems[]={&threadcount   };
+    
+  if(diaFactoryRun("Test ThreadCount",1,elems))
+  {
+         jsLog(JS_LOG_NORMAL,"Thread: %u ",(unsigned int)val);
+        return true;
+  }
+  return false;
+}
+
+/**
+    \fn jsTestFacNotch
+*/
+int jsTestFacNotch(void)
+{
+    
+	diaElemNotch notch(1,"Notch");
+      
+         diaElem *elems[]={&notch   };
+  if(diaFactoryRun("Test Notch",1,elems))
+  {
+    return true;
+  }
+  return false;
+      
+}
+/**
+    \fn jsTestFacEncoding
+*/
+int jsTestFacEncoding(void)
+{
+    DIA_encodingBase *base=createEncoding(1000*1000LL);
+    base->setContainer("the container");
+    base->setAudioCodec("the audio codec");
+    base->setVideoCodec("the video codec");
+    for(int i=0;i<20;i++)
+    {
+        base->refresh();
+        base->pushVideoFrame(10000,1,50*1000LL*i);
+        base->refresh();
+        printf("%d / %d\n",i,20);
+        ADM_usleep(500*1000);
+    }
+    delete base;
+    base=NULL;
+    return true;
+}
+//EOF 

Copied: branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/js/ADM_jsTestFactory_js.c (from rev 6206, branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src/ADM_jsTestFactory_js.c)
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src/ADM_jsTestFactory_js.c	2010-05-20 15:22:49 UTC (rev 6206)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/js/ADM_jsTestFactory_js.c	2010-05-20 15:22:52 UTC (rev 6207)
@@ -0,0 +1,649 @@
+/*
+--- DO NOT EDIT THIS FILE !!! ---
+
+This file has been generated automatically with 'jsapigen'.
+
+jsapigen is a glue-code generator for SpiderMonkey. It is distributed
+under the conditions of version 3 of the GNU General Public License.
+Please have a look at http://jsapigen.sourceforge.net.
+
+This file is NOT part of jsapigen and is NOT necessarily covered by
+jsapigen's license. For licensing information regarding this file,
+please refer to the software package which it is part of.
+
+*/
+
+#include "stdio.h"
+#include "ADM_jsAvidemux.h"
+#include "ADM_jsTestFactory.h"
+
+#ifdef HAVE_ALLOCA_H
+#include <alloca.h>
+static size_t jj_alloca_limit = 0;
+#endif
+#include <stdlib.h>
+#include <string.h>
+#include <wchar.h>
+#ifdef HAVE_ALLOCA_H
+#endif
+#include <jsapi.h>
+#ifndef JS_THREADSAFE
+#if JS_VERSION <= 170
+#define jsrefcount int
+#define JS_BeginRequest(cx)
+#define JS_EndRequest(cx)
+#define JS_SuspendRequest(cx)
+#define JS_ResumeRequest(cx, saveDepth)
+#endif
+#endif
+#ifndef JS_FS
+#define JS_FS(name, call, nargs, flags, extra) {name, call, nargs, flags, extra}
+#endif
+#ifndef JS_FS_END
+#define JS_FS_END {NULL, NULL, 0, 0, 0}
+#endif
+
+static JSBool
+jjadmTestFacInt(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval)
+{
+    JSObject * var2;
+    int var3;
+    int var6;
+    jsval var7;
+    JSBool var1;
+    var2 = NULL;
+    var3 = 0;
+    var6 = 0;
+    var7 = JSVAL_NULL;
+    var1 = JS_FALSE;
+    var2 = obj;
+    var6 = argc;
+    var3 = jsTestFacInt();
+    if (JS_NewNumberValue(cx, var3, &var7) != JS_TRUE) {
+        goto do_return;
+    }
+    argv[argc+0] = var7;
+    if (rval) {
+        *rval = var7;
+    }
+    var1 = JS_TRUE;
+    do_return:
+    return var1;
+}
+static JSBool
+jjadmTestFacFloat(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval)
+{
+    JSObject * var9;
+    int var10;
+    int var13;
+    jsval var14;
+    JSBool var8;
+    var9 = NULL;
+    var10 = 0;
+    var13 = 0;
+    var14 = JSVAL_NULL;
+    var8 = JS_FALSE;
+    var9 = obj;
+    var13 = argc;
+    var10 = jsTestFacFloat();
+    if (JS_NewNumberValue(cx, var10, &var14) != JS_TRUE) {
+        goto do_return;
+    }
+    argv[argc+0] = var14;
+    if (rval) {
+        *rval = var14;
+    }
+    var8 = JS_TRUE;
+    do_return:
+    return var8;
+}
+static JSBool
+jjadmTestFacToggle(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval)
+{
+    JSObject * var16;
+    int var17;
+    int var20;
+    jsval var21;
+    JSBool var15;
+    var16 = NULL;
+    var17 = 0;
+    var20 = 0;
+    var21 = JSVAL_NULL;
+    var15 = JS_FALSE;
+    var16 = obj;
+    var20 = argc;
+    var17 = jsTestFacToggle();
+    if (JS_NewNumberValue(cx, var17, &var21) != JS_TRUE) {
+        goto do_return;
+    }
+    argv[argc+0] = var21;
+    if (rval) {
+        *rval = var21;
+    }
+    var15 = JS_TRUE;
+    do_return:
+    return var15;
+}
+static JSBool
+jjadmTestFacMenu(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval)
+{
+    JSObject * var23;
+    int var24;
+    int var27;
+    jsval var28;
+    JSBool var22;
+    var23 = NULL;
+    var24 = 0;
+    var27 = 0;
+    var28 = JSVAL_NULL;
+    var22 = JS_FALSE;
+    var23 = obj;
+    var27 = argc;
+    var24 = jsTestFacMenu();
+    if (JS_NewNumberValue(cx, var24, &var28) != JS_TRUE) {
+        goto do_return;
+    }
+    argv[argc+0] = var28;
+    if (rval) {
+        *rval = var28;
+    }
+    var22 = JS_TRUE;
+    do_return:
+    return var22;
+}
+static JSBool
+jjadmTestFacFile(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval)
+{
+    JSObject * var30;
+    int var31;
+    int var34;
+    jsval var35;
+    JSBool var29;
+    var30 = NULL;
+    var31 = 0;
+    var34 = 0;
+    var35 = JSVAL_NULL;
+    var29 = JS_FALSE;
+    var30 = obj;
+    var34 = argc;
+    var31 = jsTestFacFile();
+    if (JS_NewNumberValue(cx, var31, &var35) != JS_TRUE) {
+        goto do_return;
+    }
+    argv[argc+0] = var35;
+    if (rval) {
+        *rval = var35;
+    }
+    var29 = JS_TRUE;
+    do_return:
+    return var29;
+}
+static JSBool
+jjadmTestFacBitrate(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval)
+{
+    JSObject * var37;
+    int var38;
+    int var41;
+    jsval var42;
+    JSBool var36;
+    var37 = NULL;
+    var38 = 0;
+    var41 = 0;
+    var42 = JSVAL_NULL;
+    var36 = JS_FALSE;
+    var37 = obj;
+    var41 = argc;
+    var38 = jsTestFacBitrate();
+    if (JS_NewNumberValue(cx, var38, &var42) != JS_TRUE) {
+        goto do_return;
+    }
+    argv[argc+0] = var42;
+    if (rval) {
+        *rval = var42;
+    }
+    var36 = JS_TRUE;
+    do_return:
+    return var36;
+}
+static JSBool
+jjadmTestFacBar(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval)
+{
+    JSObject * var44;
+    int var45;
+    int var48;
+    jsval var49;
+    JSBool var43;
+    var44 = NULL;
+    var45 = 0;
+    var48 = 0;
+    var49 = JSVAL_NULL;
+    var43 = JS_FALSE;
+    var44 = obj;
+    var48 = argc;
+    var45 = jsTestFacBar();
+    if (JS_NewNumberValue(cx, var45, &var49) != JS_TRUE) {
+        goto do_return;
+    }
+    argv[argc+0] = var49;
+    if (rval) {
+        *rval = var49;
+    }
+    var43 = JS_TRUE;
+    do_return:
+    return var43;
+}
+static JSBool
+jjadmTestFacRoText(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval)
+{
+    JSObject * var51;
+    int var52;
+    int var55;
+    jsval var56;
+    JSBool var50;
+    var51 = NULL;
+    var52 = 0;
+    var55 = 0;
+    var56 = JSVAL_NULL;
+    var50 = JS_FALSE;
+    var51 = obj;
+    var55 = argc;
+    var52 = jsTestFacRoText();
+    if (JS_NewNumberValue(cx, var52, &var56) != JS_TRUE) {
+        goto do_return;
+    }
+    argv[argc+0] = var56;
+    if (rval) {
+        *rval = var56;
+    }
+    var50 = JS_TRUE;
+    do_return:
+    return var50;
+}
+static JSBool
+jjadmTestFacText(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval)
+{
+    JSObject * var58;
+    int var59;
+    int var62;
+    jsval var63;
+    JSBool var57;
+    var58 = NULL;
+    var59 = 0;
+    var62 = 0;
+    var63 = JSVAL_NULL;
+    var57 = JS_FALSE;
+    var58 = obj;
+    var62 = argc;
+    var59 = jsTestFacText();
+    if (JS_NewNumberValue(cx, var59, &var63) != JS_TRUE) {
+        goto do_return;
+    }
+    argv[argc+0] = var63;
+    if (rval) {
+        *rval = var63;
+    }
+    var57 = JS_TRUE;
+    do_return:
+    return var57;
+}
+static JSBool
+jjadmTestFacTab(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval)
+{
+    JSObject * var65;
+    int var66;
+    int var69;
+    jsval var70;
+    JSBool var64;
+    var65 = NULL;
+    var66 = 0;
+    var69 = 0;
+    var70 = JSVAL_NULL;
+    var64 = JS_FALSE;
+    var65 = obj;
+    var69 = argc;
+    var66 = jsTestFacTab();
+    if (JS_NewNumberValue(cx, var66, &var70) != JS_TRUE) {
+        goto do_return;
+    }
+    argv[argc+0] = var70;
+    if (rval) {
+        *rval = var70;
+    }
+    var64 = JS_TRUE;
+    do_return:
+    return var64;
+}
+static JSBool
+jjadmTestFacFrame(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval)
+{
+    JSObject * var72;
+    int var73;
+    int var76;
+    jsval var77;
+    JSBool var71;
+    var72 = NULL;
+    var73 = 0;
+    var76 = 0;
+    var77 = JSVAL_NULL;
+    var71 = JS_FALSE;
+    var72 = obj;
+    var76 = argc;
+    var73 = jsTestFacFrame();
+    if (JS_NewNumberValue(cx, var73, &var77) != JS_TRUE) {
+        goto do_return;
+    }
+    argv[argc+0] = var77;
+    if (rval) {
+        *rval = var77;
+    }
+    var71 = JS_TRUE;
+    do_return:
+    return var71;
+}
+static JSBool
+jjadmTestFacHex(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval)
+{
+    JSObject * var79;
+    int var80;
+    int var83;
+    jsval var84;
+    JSBool var78;
+    var79 = NULL;
+    var80 = 0;
+    var83 = 0;
+    var84 = JSVAL_NULL;
+    var78 = JS_FALSE;
+    var79 = obj;
+    var83 = argc;
+    var80 = jsTestFacHex();
+    if (JS_NewNumberValue(cx, var80, &var84) != JS_TRUE) {
+        goto do_return;
+    }
+    argv[argc+0] = var84;
+    if (rval) {
+        *rval = var84;
+    }
+    var78 = JS_TRUE;
+    do_return:
+    return var78;
+}
+static JSBool
+jjadmTestFacDirSel(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval)
+{
+    JSObject * var86;
+    int var87;
+    int var90;
+    jsval var91;
+    JSBool var85;
+    var86 = NULL;
+    var87 = 0;
+    var90 = 0;
+    var91 = JSVAL_NULL;
+    var85 = JS_FALSE;
+    var86 = obj;
+    var90 = argc;
+    var87 = jsTestFacDirSel();
+    if (JS_NewNumberValue(cx, var87, &var91) != JS_TRUE) {
+        goto do_return;
+    }
+    argv[argc+0] = var91;
+    if (rval) {
+        *rval = var91;
+    }
+    var85 = JS_TRUE;
+    do_return:
+    return var85;
+}
+static JSBool
+jjadmTestFacButton(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval)
+{
+    JSObject * var93;
+    int var94;
+    int var97;
+    jsval var98;
+    JSBool var92;
+    var93 = NULL;
+    var94 = 0;
+    var97 = 0;
+    var98 = JSVAL_NULL;
+    var92 = JS_FALSE;
+    var93 = obj;
+    var97 = argc;
+    var94 = jsTestFacButton();
+    if (JS_NewNumberValue(cx, var94, &var98) != JS_TRUE) {
+        goto do_return;
+    }
+    argv[argc+0] = var98;
+    if (rval) {
+        *rval = var98;
+    }
+    var92 = JS_TRUE;
+    do_return:
+    return var92;
+}
+static JSBool
+jjadmTestFacMatrix(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval)
+{
+    JSObject * var100;
+    int var101;
+    int var104;
+    jsval var105;
+    JSBool var99;
+    var100 = NULL;
+    var101 = 0;
+    var104 = 0;
+    var105 = JSVAL_NULL;
+    var99 = JS_FALSE;
+    var100 = obj;
+    var104 = argc;
+    var101 = jsTestFacMatrix();
+    if (JS_NewNumberValue(cx, var101, &var105) != JS_TRUE) {
+        goto do_return;
+    }
+    argv[argc+0] = var105;
+    if (rval) {
+        *rval = var105;
+    }
+    var99 = JS_TRUE;
+    do_return:
+    return var99;
+}
+static JSBool
+jjadmTestFacNotch(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval)
+{
+    JSObject * var107;
+    int var108;
+    int var111;
+    jsval var112;
+    JSBool var106;
+    var107 = NULL;
+    var108 = 0;
+    var111 = 0;
+    var112 = JSVAL_NULL;
+    var106 = JS_FALSE;
+    var107 = obj;
+    var111 = argc;
+    var108 = jsTestFacNotch();
+    if (JS_NewNumberValue(cx, var108, &var112) != JS_TRUE) {
+        goto do_return;
+    }
+    argv[argc+0] = var112;
+    if (rval) {
+        *rval = var112;
+    }
+    var106 = JS_TRUE;
+    do_return:
+    return var106;
+}
+static JSBool
+jjadmTestFacThreadCount(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval)
+{
+    JSObject * var114;
+    int var115;
+    int var118;
+    jsval var119;
+    JSBool var113;
+    var114 = NULL;
+    var115 = 0;
+    var118 = 0;
+    var119 = JSVAL_NULL;
+    var113 = JS_FALSE;
+    var114 = obj;
+    var118 = argc;
+    var115 = jsTestFacThreadCount();
+    if (JS_NewNumberValue(cx, var115, &var119) != JS_TRUE) {
+        goto do_return;
+    }
+    argv[argc+0] = var119;
+    if (rval) {
+        *rval = var119;
+    }
+    var113 = JS_TRUE;
+    do_return:
+    return var113;
+}
+static JSBool
+jjadmTestFacSlider(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval)
+{
+    JSObject * var121;
+    int var122;
+    int var125;
+    jsval var126;
+    JSBool var120;
+    var121 = NULL;
+    var122 = 0;
+    var125 = 0;
+    var126 = JSVAL_NULL;
+    var120 = JS_FALSE;
+    var121 = obj;
+    var125 = argc;
+    var122 = jsTestFacSlider();
+    if (JS_NewNumberValue(cx, var122, &var126) != JS_TRUE) {
+        goto do_return;
+    }
+    argv[argc+0] = var126;
+    if (rval) {
+        *rval = var126;
+    }
+    var120 = JS_TRUE;
+    do_return:
+    return var120;
+}
+static JSBool
+jjadmTestEncoding(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval)
+{
+    JSObject * var128;
+    int var129;
+    int var132;
+    jsval var133;
+    JSBool var127;
+    var128 = NULL;
+    var129 = 0;
+    var132 = 0;
+    var133 = JSVAL_NULL;
+    var127 = JS_FALSE;
+    var128 = obj;
+    var132 = argc;
+    var129 = jsTestFacEncoding();
+    if (JS_NewNumberValue(cx, var129, &var133) != JS_TRUE) {
+        goto do_return;
+    }
+    argv[argc+0] = var133;
+    if (rval) {
+        *rval = var133;
+    }
+    var127 = JS_TRUE;
+    do_return:
+    return var127;
+}
+static JSBool
+jjadmTestCrash(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval)
+{
+    JSObject * var135;
+    int var139;
+    JSBool var134;
+    var135 = NULL;
+    var139 = 0;
+    var134 = JS_FALSE;
+    var135 = obj;
+    var139 = argc;
+    jsTestCrash();
+    var134 = JS_TRUE;
+    return var134;
+}
+static JSBool
+jjadmTestAssert(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval)
+{
+    JSObject * var141;
+    int var145;
+    JSBool var140;
+    var141 = NULL;
+    var145 = 0;
+    var140 = JS_FALSE;
+    var141 = obj;
+    var145 = argc;
+    jsTestAssert();
+    var140 = JS_TRUE;
+    return var140;
+}
+static JSPropertySpec jj_static_ps[] = {
+    {NULL, 0, 0, NULL, NULL}
+};
+static JSPropertySpec jj_ps[] = {
+    {NULL, 0, 0, NULL, NULL}
+};
+static JSFunctionSpec jj_static_fs[] = {
+    JS_FS("admTestFacInt", jjadmTestFacInt, 0, 0, 1),
+    JS_FS("admTestFacFloat", jjadmTestFacFloat, 0, 0, 1),
+    JS_FS("admTestFacToggle", jjadmTestFacToggle, 0, 0, 1),
+    JS_FS("admTestFacMenu", jjadmTestFacMenu, 0, 0, 1),
+    JS_FS("admTestFacFile", jjadmTestFacFile, 0, 0, 1),
+    JS_FS("admTestFacBitrate", jjadmTestFacBitrate, 0, 0, 1),
+    JS_FS("admTestFacBar", jjadmTestFacBar, 0, 0, 1),
+    JS_FS("admTestFacRoText", jjadmTestFacRoText, 0, 0, 1),
+    JS_FS("admTestFacText", jjadmTestFacText, 0, 0, 1),
+    JS_FS("admTestFacTab", jjadmTestFacTab, 0, 0, 1),
+    JS_FS("admTestFacFrame", jjadmTestFacFrame, 0, 0, 1),
+    JS_FS("admTestFacHex", jjadmTestFacHex, 0, 0, 1),
+    JS_FS("admTestFacDirSel", jjadmTestFacDirSel, 0, 0, 1),
+    JS_FS("admTestFacButton", jjadmTestFacButton, 0, 0, 1),
+    JS_FS("admTestFacMatrix", jjadmTestFacMatrix, 0, 0, 1),
+    JS_FS("admTestFacNotch", jjadmTestFacNotch, 0, 0, 1),
+    JS_FS("admTestFacThreadCount", jjadmTestFacThreadCount, 0, 0, 1),
+    JS_FS("admTestFacSlider", jjadmTestFacSlider, 0, 0, 1),
+    JS_FS("admTestEncoding", jjadmTestEncoding, 0, 0, 1),
+    JS_FS("admTestCrash", jjadmTestCrash, 0, 0, 0),
+    JS_FS("admTestAssert", jjadmTestAssert, 0, 0, 0),
+    JS_FS_END
+};
+static JSFunctionSpec jj_fs[] = {
+    JS_FS("admTestFacInt", jjadmTestFacInt, 0, 0, 1),
+    JS_FS("admTestFacFloat", jjadmTestFacFloat, 0, 0, 1),
+    JS_FS("admTestFacToggle", jjadmTestFacToggle, 0, 0, 1),
+    JS_FS("admTestFacMenu", jjadmTestFacMenu, 0, 0, 1),
+    JS_FS("admTestFacFile", jjadmTestFacFile, 0, 0, 1),
+    JS_FS("admTestFacBitrate", jjadmTestFacBitrate, 0, 0, 1),
+    JS_FS("admTestFacBar", jjadmTestFacBar, 0, 0, 1),
+    JS_FS("admTestFacRoText", jjadmTestFacRoText, 0, 0, 1),
+    JS_FS("admTestFacText", jjadmTestFacText, 0, 0, 1),
+    JS_FS("admTestFacTab", jjadmTestFacTab, 0, 0, 1),
+    JS_FS("admTestFacFrame", jjadmTestFacFrame, 0, 0, 1),
+    JS_FS("admTestFacHex", jjadmTestFacHex, 0, 0, 1),
+    JS_FS("admTestFacDirSel", jjadmTestFacDirSel, 0, 0, 1),
+    JS_FS("admTestFacButton", jjadmTestFacButton, 0, 0, 1),
+    JS_FS("admTestFacMatrix", jjadmTestFacMatrix, 0, 0, 1),
+    JS_FS("admTestFacNotch", jjadmTestFacNotch, 0, 0, 1),
+    JS_FS("admTestFacThreadCount", jjadmTestFacThreadCount, 0, 0, 1),
+    JS_FS("admTestFacSlider", jjadmTestFacSlider, 0, 0, 1),
+    JS_FS("admTestEncoding", jjadmTestEncoding, 0, 0, 1),
+    JS_FS("admTestCrash", jjadmTestCrash, 0, 0, 0),
+    JS_FS("admTestAssert", jjadmTestAssert, 0, 0, 0),
+    JS_FS_END
+};
+
+JSFunctionSpec  *jsGetTestFunctions(void)
+{
+        return jj_fs;
+}
+
+

Copied: branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/js/ADM_jsTestFactory_js.idl (from rev 6206, branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src/ADM_jsTestFactory_js.idl)
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src/ADM_jsTestFactory_js.idl	2010-05-20 15:22:49 UTC (rev 6206)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/js/ADM_jsTestFactory_js.idl	2010-05-20 15:22:52 UTC (rev 6207)
@@ -0,0 +1,40 @@
+%{
+#include "stdio.h"
+#include "ADM_jsAvidemux.h"
+#include "ADM_jsTestFactory.h"
+%}
+/*
+###############################################################
+       return JS function     C Function  params
+###############################################################
+*/
+function int admTestFacInt     :  jsTestFacInt     (void  ) <static>;
+function int admTestFacFloat   :  jsTestFacFloat   (void  ) <static>;
+function int admTestFacToggle  :  jsTestFacToggle  (void  ) <static>;
+function int admTestFacMenu    :  jsTestFacMenu    (void  ) <static>;
+function int admTestFacFile    :  jsTestFacFile    (void  ) <static>;
+function int admTestFacBitrate :  jsTestFacBitrate (void  ) <static>;
+function int admTestFacBar     :  jsTestFacBar     (void  ) <static>;
+function int admTestFacRoText  :  jsTestFacRoText  (void  ) <static>;
+function int admTestFacText    :  jsTestFacText    (void  ) <static>;
+function int admTestFacTab     :  jsTestFacTab     (void  ) <static>;
+function int admTestFacFrame   :  jsTestFacFrame   (void  ) <static>;
+function int admTestFacHex     :  jsTestFacHex     (void  ) <static>;
+function int admTestFacDirSel  :  jsTestFacDirSel  (void  ) <static>;
+function int admTestFacButton  :  jsTestFacButton  (void  ) <static>;
+function int admTestFacMatrix  :  jsTestFacMatrix  (void  ) <static>;
+function int admTestFacNotch   :  jsTestFacNotch   (void  ) <static>;
+function int admTestFacThreadCount:  jsTestFacThreadCount   (void  ) <static>;
+function int admTestFacSlider  :  jsTestFacSlider  (void  ) <static>;
+function int admTestEncoding   :  jsTestFacEncoding  (void  ) <static>;
+function void admTestCrash     :  jsTestCrash      (void  ) <static>;
+function void admTestAssert    :  jsTestAssert     (void  ) <static>;
+
+%<
+JSFunctionSpec  *jsGetTestFunctions(void)
+{
+        return jj_fs;
+}
+
+%>
+

Copied: branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/js/ADM_jsUtils.cpp (from rev 6206, branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src/ADM_jsUtils.cpp)
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src/ADM_jsUtils.cpp	2010-05-20 15:22:49 UTC (rev 6206)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/js/ADM_jsUtils.cpp	2010-05-20 15:22:52 UTC (rev 6207)
@@ -0,0 +1,167 @@
+/**
+    \file ADM_jsUtils
+    \brief Simple param -> type utilities
+    \author mean fixounet at free.fr 2009
+*/
+/***************************************************************************
+ *                                                                         *
+ *   This program is free software; you can redistribute it and/or modify  *
+ *   it under the terms of the GNU General Public License as published by  *
+ *   the Free Software Foundation; either version 2 of the License, or     *
+ *   (at your option) any later version.                                   *
+ *                                                                         *
+ ***************************************************************************/
+#include "ADM_js.h"
+/**
+    \fn ADM_jsArg2Vars  
+    \brief convert jsvals to native type with checking
+*/
+bool ADM_jsArg2Vars(const char *caller, int argc, jsval *argv, int paramNumber, ADM_PARAM_LIST *param)
+{
+    if(paramNumber!=argc)
+    {
+        ADM_warning("[%s]Wrong number of parameters : %d vs %d\n",caller,argc,paramNumber);
+        return false;
+    }
+    for(int i=0;i<argc;i++)
+    {
+        jsval j=argv[i];
+        ADM_PARAM_LIST *p=param+i;
+        switch(p->type)
+        {
+            case ADM_JS_UINT64_T:
+            case ADM_JS_UINT32_T:
+            case ADM_JS_INT64_T:
+            case ADM_JS_INT32_T:
+                {
+                        if(!JSVAL_IS_NUMBER(j))
+                        {
+                            ADM_warning("[%s]Expected number and got %d\n",caller,j);
+                            return false;
+                        }
+                        // If it is an int...
+                        double v=0;
+                        if(JSVAL_IS_INT(j)) 
+                        {
+                            v=(int64_t)JSVAL_TO_INT(j);
+                            //ADM_warning("Value is int :%"LLD"\n",JSVAL_TO_INT(j));
+                        }
+                        if(JSVAL_IS_DOUBLE(j)) 
+                        {
+                            v=(int64_t)*(JSVAL_TO_DOUBLE(j));
+                            //ADM_warning("Value is float :%f\n",(float)*(JSVAL_TO_DOUBLE(j)));
+                        }
+                        // 
+                        //ADM_warning("%f\n",(float)v);
+                        // Affect
+                        switch(p->type)
+                        {
+                            case ADM_JS_UINT64_T: *(uint64_t *)p->value=(uint64_t)v;break;
+                            case ADM_JS_UINT32_T: *(uint32_t *)p->value=(uint32_t)v;break;
+                            case ADM_JS_INT64_T:  *(int64_t *)p->value=(int64_t)v;break;
+                            case ADM_JS_INT32_T:  *(int32_t *)p->value=(int32_t)v;break;
+                            default: ADM_assert(0);break;
+                        }
+                 }
+                        break;
+            case  ADM_JS_STRING:
+                {
+                        if(!JSVAL_IS_STRING(j))
+                        {
+                            ADM_warning("[%s]Expected string and got %d\n",caller,j);
+                            return false;
+                        }
+                        char *out=JS_GetStringBytes(JSVAL_TO_STRING(j));
+                        char **m=(char **)(p->value);
+                        *m=out;
+                }
+                        break;
+            case  ADM_JS_BOOL:
+                        if(!JSVAL_IS_BOOLEAN(j))
+                        {
+                            ADM_warning("[%s]Expected boolean and got %d\n",caller,j);
+                            return false;
+                        }
+                        *(bool *)p->value=JSVAL_TO_BOOLEAN(j);
+                        break;
+            default:
+                    ADM_assert(0);
+                    break;
+        }
+
+    }
+    return true;
+}
+/**
+    \fn stringsToConfCouple
+    \brief Convert js args to confcouple
+
+*/
+bool stringsToConfCouple(int nb,CONFcouple **conf,  const char **argv)
+{
+  *conf=NULL;
+  if(!nb) return true;
+  CONFcouple *c=new CONFcouple(nb);
+  *conf=c;
+    for(int i=0;i<nb;i++)
+    {
+        
+        char *dupe=   ADM_strdup(argv[i]);
+        char *name,*value;
+        // dupe is in the form name=value
+        name=dupe;
+        value=name;
+        char *tail=dupe+strlen(dupe);
+        while(value<tail)
+        {
+            if(*value=='=') 
+                {
+                    *value=0;
+                    value++;
+                    break;
+                }
+            value++;
+        }
+        c->setInternalName(name,value);
+        //printf("%s -> [%s,%s]\n",param,name,value);
+        ADM_dezalloc(dupe);
+    }
+    return true;
+}
+/**
+    \fn jsArgToConfCouple
+    \brief Convert js args to confcouple
+
+*/
+bool jsArgToConfCouple(int nb,CONFcouple **conf,  jsval *argv)
+{
+  *conf=NULL;
+  if(!nb) return true;
+  CONFcouple *c=new CONFcouple(nb);
+  *conf=c;
+    for(int i=0;i<nb;i++)
+    {
+        char *param = JS_GetStringBytes(JSVAL_TO_STRING(argv[i]));
+        char *dupe=   ADM_strdup(param);
+        char *name,*value;
+        // dupe is in the form name=value
+        name=dupe;
+        value=name;
+        char *tail=dupe+strlen(dupe);
+        while(value<tail)
+        {
+            if(*value=='=') 
+                {
+                    *value=0;
+                    value++;
+                    break;
+                }
+            value++;
+        }
+        c->setInternalName(name,value);
+        //printf("%s -> [%s,%s]\n",param,name,value);
+        ADM_dezalloc(dupe);
+    }
+    return true;
+}
+// EOF

Copied: branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/js/ADM_jsVideo.cpp (from rev 6206, branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src/ADM_jsVideo.cpp)
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src/ADM_jsVideo.cpp	2010-05-20 15:22:49 UTC (rev 6206)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/js/ADM_jsVideo.cpp	2010-05-20 15:22:52 UTC (rev 6207)
@@ -0,0 +1,149 @@
+/**
+    \file ADM_jsVideo.cpp
+    \brief Video oriented functions
+    \author mean (c) 2009 fixounet at free.fr
+
+
+    jsapigen does not like much variable number of arguments
+    In that case, we patch the generated file to go back to native spidermonkey api
+
+
+*/
+/***************************************************************************
+ *                                                                         *
+ *   This program is free software; you can redistribute it and/or modify  *
+ *   it under the terms of the GNU General Public License as published by  *
+ *   the Free Software Foundation; either version 2 of the License, or     *
+ *   (at your option) any later version.                                   *
+ *                                                                         *
+ ***************************************************************************/
+#include "ADM_js.h"
+#include "ADM_editor/ADM_edit.hxx"
+#include "ADM_jsAvidemux.h"
+#include "ADM_jsVideo.h"
+#include "A_functions.h"
+#include "ADM_videoEncoderApi.h"
+#include "ADM_videoFilterApi.h"
+#include "ADM_videoFilters.h"
+#include "GUI_ui.h"
+extern ADM_Composer *video_body;
+bool A_setVideoCodec(const char *nm);
+/**
+    \fn jsSetPostProc
+*/
+int jsSetPostProc (int a,int b, int c)
+{
+    return video_body->setPostProc(a,b,c);
+}
+
+
+/**
+    \fn Codec
+    
+*/
+extern "C" int   jsVideoCodec(const char *a,const char **b) {return 0;}
+JSBool jsAdmvideoCodec(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval)
+{// begin Codec
+        *rval = BOOLEAN_TO_JSVAL(false);
+        if(argc <1)
+                return JS_FALSE;
+        if(JSVAL_IS_STRING(argv[0]) == false )
+        {
+                jsLog(JS_LOG_ERROR,"Cannot set codec, first parameter is not a string\n");
+                return JS_FALSE;
+        }
+        char *codec=JS_GetStringBytes(JSVAL_TO_STRING(argv[0]));
+        // Set codec.
+        
+        if(A_setVideoCodec(codec)==false)
+        {
+            jsLog(JS_LOG_ERROR,"Could not select codec %s\n",codec);
+            return JS_FALSE;
+        }
+        CONFcouple *c;
+        jsArgToConfCouple(argc-1,&c,argv+1);
+        *rval = BOOLEAN_TO_JSVAL( videoEncoder6_SetConfiguration(c));
+        jsLog(JS_LOG_NORMAL,"Selected codec %s\n",codec);
+        if(c) delete c;
+        return JS_TRUE;
+}// end Codec
+
+/**
+    \fn Codec
+    
+*/
+extern "C" int   jsVideoFilter(const char *a,const char **b) {return 0;}
+JSBool jsAdmaddVideoFilter(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval)
+{// begin Codec
+   uint32_t filterTag;
+
+        // default return value
+        *rval = BOOLEAN_TO_JSVAL(false);
+        if(argc == 0)
+                return JS_FALSE;
+        char *filterName=JS_GetStringBytes(JSVAL_TO_STRING(argv[0]));
+        filterTag = ADM_vf_getTagFromInternalName(filterName);
+        jsLog(JS_LOG_NORMAL,"Adding Filter %s -> %"LU"... \n",filterName,filterTag);
+
+        
+        CONFcouple *c=NULL;
+        if(argc)
+            jsArgToConfCouple(argc-1,&c,argv+1);
+        *rval=BOOLEAN_TO_JSVAL(  ADM_vf_addFilterFromTag(filterTag,c,false));
+        if(c) delete c;
+        
+        return JS_TRUE;
+}// end Codec
+/**
+    \fn A_setVideoCodec
+*/
+bool A_setVideoCodec(const char *nm)
+{
+    int idx=videoEncoder6_GetIndexFromName(nm);
+    if(idx==-1)
+    {
+        ADM_error("No such encoder :%s\n",nm);
+    }
+    // Select by index
+    videoEncoder6_SetCurrentEncoder(idx);
+    UI_setVideoCodec(idx);
+    return true;
+}
+/**
+     \fn jsClearFilters
+*/
+int jsClearVideoFilters()
+{
+    return ADM_vf_clearFilters();
+}
+/**
+    \fn jsGetMarkerA
+*/
+double jsGetMarkerA(void)
+{
+    return (double)video_body->getMarkerAPts();
+
+}
+/**
+    \fn jsGetMarkerB
+*/
+double jsGetMarkerB(void)
+{
+    return (double)video_body->getMarkerBPts();
+}
+/**
+    \fn jsSetMarkerA
+*/
+void   jsSetMarkerA(double a)
+{
+    video_body->setMarkerAPts( (uint64_t)a);
+}
+/**
+    \fn jsGetMarkerB
+*/
+void   jsSetMarkerB(double b)
+{
+    video_body->setMarkerBPts( (uint64_t)b);
+}
+
+//EOF
\ No newline at end of file

Copied: branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/js/CMakeLists.txt (from rev 6206, branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src/CMakeLists.txt)
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src/CMakeLists.txt	2010-05-20 15:22:49 UTC (rev 6206)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/js/CMakeLists.txt	2010-05-20 15:22:52 UTC (rev 6207)
@@ -0,0 +1,27 @@
+SET(ADM_script_SRCS
+        ADM_jsIf.cpp
+        ADM_jsDebug.cpp
+        ADM_jsUtils.cpp
+# Wrapper code
+        ADM_jsIf_js.c
+# Factory test
+        ADM_jsTestFactory.cpp  
+        ADM_jsTestFactory_js.c
+# Load segment
+        ADM_jsAvidemux.cpp
+        ADM_jsAvidemuxInfo.cpp
+        ADM_jsAvidemux_js.c
+# Debug / editor class
+        ADM_jsEditor.cpp
+        ADM_jsEditor_js.c
+
+# 
+        ADM_jsVideo.cpp
+#
+        ADM_jsAudio.cpp
+)
+
+ADD_LIBRARY(ADM_script26 STATIC ${ADM_script_SRCS})
+ADD_DEFINITIONS("-DJS_THREADSAFE -DXP_UNIX")
+include_directories(${AVIDEMUX_TOP_SOURCE_DIR}/avidemux/common/ADM_script2/include)
+include_directories(${AVIDEMUX_TOP_SOURCE_DIR}/avidemux_core/ADM_smjs)

Copied: branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/js/idl.make (from rev 6206, branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src/idl.make)
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src/idl.make	2010-05-20 15:22:49 UTC (rev 6206)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/js/idl.make	2010-05-20 15:22:52 UTC (rev 6207)
@@ -0,0 +1,7 @@
+idls:=$(shell ls *.idl)
+cs:=$(subst .idl,.c,$(idls))
+%.c : %.idl
+	echo processing $@
+	jsapigen < $< > /tmp/xx
+	cat /tmp/xx   | sed 's/"\(.*\)_ignore"/"\1"/g'  | sed 's/, jjadm\(.*\)_ignore,/, jsAdm\1, /g' > $@
+all: $(cs)

Copied: branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/js/updateIdl.sh (from rev 6206, branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src/updateIdl.sh)
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src/updateIdl.sh	2010-05-20 15:22:49 UTC (rev 6206)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/js/updateIdl.sh	2010-05-20 15:22:52 UTC (rev 6207)
@@ -0,0 +1 @@
+jsapigen < ADM_jsIf_js.idl  > ADM_jsIf_js.c

Copied: branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/py/ADM_pyAdm.cpp (from rev 6206, branches/avidemux_2.6_branch_mean/avidemux/common/ADM_pyScript/src/ADM_pyAdm.cpp)
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/ADM_pyScript/src/ADM_pyAdm.cpp	2010-05-20 15:22:49 UTC (rev 6206)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/py/ADM_pyAdm.cpp	2010-05-20 15:22:52 UTC (rev 6207)
@@ -0,0 +1,130 @@
+/**
+    \file ADM_pyADM.cpp
+    \author mean fixounet at free.fr 2010
+
+*/
+/***************************************************************************
+ *                                                                         *
+ *   This program is free software; you can redistribute it and/or modify  *
+ *   it under the terms of the GNU General Public License as published by  *
+ *   the Free Software Foundation; either version 2 of the License, or     *
+ *   (at your option) any later version.                                   *
+ *                                                                         *
+ ***************************************************************************/
+
+#include "ADM_default.h"
+#include <stdarg.h>
+#include <vector>
+#include "ADM_editor/ADM_edit.hxx"
+#include "ADM_coreTinyPy/include/tinypy.h"
+#include "ADM_coreTinyPy/include/ADM_tinypy.h"
+#include "ADM_script2/include/ADM_jsShell.h"
+#include "A_functions.h"
+
+#include "adm_gen.h"
+
+#include "adm_gen.cpp"
+/**
+    \fn    parseTinyPyScript
+    \brief Execute a tinyPy script
+*/
+bool parseTinyPyScript(const char *name)
+{
+        tinyPy py;
+        py.init();
+        py.registerFuncs("adm",adm_functions);
+        return py.execFile(name);
+}
+
+/**
+    \fn jsEvaluate
+*/
+static tinyPy *myPy=NULL;
+static bool pyEvaluate(const char *str)
+{
+    ADM_assert(myPy);
+    return myPy->execString(str);
+}
+/**
+    \fn    interactiveTinyPy
+    \brief interprete & execute python script (interactive)
+*/
+bool interactiveTinyPy(void)
+{
+    myPy=new tinyPy;
+    myPy->init();
+    myPy->registerFuncs("adm",adm_functions);
+
+    ADM_startShell(pyEvaluate);
+    delete myPy;
+    myPy=NULL;
+	A_Resync();
+    ADM_info("Ending py shell...\n");
+	return true;
+}
+
+int  py_loadVideo (char *vid )
+{
+    printf("pyLoadVideo %s\n",vid);
+    return 0;
+}
+int  py_clearSegments (void)
+{
+    printf("py_clearSegments\n");
+    return 0;
+}
+
+int  py_appendVideo (char *vid )
+{
+    printf("py_appendVideo %s\n",vid);
+    return 0;
+}
+
+int  py_addSegment (int ,float , float )
+{
+    printf("py_addSegment\n");
+    return 0;
+}
+
+int  py_setPostProc (int a,int b, int c)
+{
+    printf("py_setPostProc\n");
+    return 0;
+}
+
+int  py_getWidth (void)
+{
+    printf("py_getWidth\n");
+    return 0;
+}
+
+int  py_getHeight (void)
+{
+    printf("py_getHeight\n");
+    return 0;
+}
+
+int  py_getFps1000 (void)
+{
+    printf("py_getFps1000\n");
+    return 0;
+}
+
+int  py_audioReset (void)
+{
+    printf("py_audioReset\n");
+    return 0;
+}
+
+int  py_audioMixer (char *mixer )
+{
+    printf("py_audioMixer\n");
+    return 0;
+}
+
+int  py_clearVideoFilters (void)
+{
+    printf("py_clearVideoFilters\n");
+    return 0;
+}
+

Copied: branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/py/CMakeLists.txt (from rev 6206, branches/avidemux_2.6_branch_mean/avidemux/common/ADM_pyScript/src/CMakeLists.txt)
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/ADM_pyScript/src/CMakeLists.txt	2010-05-20 15:22:49 UTC (rev 6206)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/py/CMakeLists.txt	2010-05-20 15:22:52 UTC (rev 6207)
@@ -0,0 +1,7 @@
+SET(ADM_script_SRCS
+        ADM_pyAdm.cpp
+)
+
+ADD_LIBRARY(ADM_pyScript6 STATIC ${ADM_script_SRCS})
+include_directories(../include)
+include_directories(${AVIDEMUX_TOP_SOURCE_DIR}/avidemux_core/ADM_coreTinyPy/include)

Copied: branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/py/adm.admPy (from rev 6206, branches/avidemux_2.6_branch_mean/avidemux/common/ADM_pyScript/src/adm.admPy)
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/ADM_pyScript/src/adm.admPy	2010-05-20 15:22:49 UTC (rev 6206)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/py/adm.admPy	2010-05-20 15:22:52 UTC (rev 6207)
@@ -0,0 +1,13 @@
+/* FUNC */ int loadVideo      (char * ) 
+/* FUNC */ int clearSegments  (void) 
+/* FUNC */ int appendVideo    (char * ) 
+/* FUNC */ int addSegment     (int ,float , float ) 
+/* FUNC */ int setPostProc    (int ,int , int ) 
+/* FUNC */ int getWidth       (void) 
+/* FUNC */ int getHeight      (void) 
+/* FUNC */ int getFps1000     (void) 
+#/* FUNC */ char* getVideoCodec(void) 
+/* FUNC */ int audioReset     (void) 
+/* FUNC */ int audioMixer     (char * ) 
+/* FUNC */ int clearVideoFilters   (void) 
+

Copied: branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/py/adm_gen.cpp (from rev 6206, branches/avidemux_2.6_branch_mean/avidemux/common/ADM_pyScript/src/adm_gen.cpp)
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/ADM_pyScript/src/adm_gen.cpp	2010-05-20 15:22:49 UTC (rev 6206)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/py/adm_gen.cpp	2010-05-20 15:22:52 UTC (rev 6207)
@@ -0,0 +1,89 @@
+//int  loadVideo <char * >
+tp_obj zzpy_loadVideo(TP)
+{
+char * p0=(char *)TP_STR().string.val;
+int r=py_loadVideo(p0); 
+return tp_number(r);
+}
+//int  clearSegments <void>
+tp_obj zzpy_clearSegments(TP)
+{
+int r=py_clearSegments(); 
+return tp_number(r);
+}
+//int  appendVideo <char * >
+tp_obj zzpy_appendVideo(TP)
+{
+char * p0=(char *)TP_STR().string.val;
+int r=py_appendVideo(p0); 
+return tp_number(r);
+}
+//int  addSegment <int  float   float >
+tp_obj zzpy_addSegment(TP)
+{
+int p0=TP_NUM();
+float p1=TP_NUM();
+float p2=TP_NUM();
+int r=py_addSegment(p0,p1,p2); 
+return tp_number(r);
+}
+//int  setPostProc <int  int   int >
+tp_obj zzpy_setPostProc(TP)
+{
+int p0=TP_NUM();
+int p1=TP_NUM();
+int p2=TP_NUM();
+int r=py_setPostProc(p0,p1,p2); 
+return tp_number(r);
+}
+//int  getWidth <void>
+tp_obj zzpy_getWidth(TP)
+{
+int r=py_getWidth(); 
+return tp_number(r);
+}
+//int  getHeight <void>
+tp_obj zzpy_getHeight(TP)
+{
+int r=py_getHeight(); 
+return tp_number(r);
+}
+//int  getFps1000 <void>
+tp_obj zzpy_getFps1000(TP)
+{
+int r=py_getFps1000(); 
+return tp_number(r);
+}
+//int  audioReset <void>
+tp_obj zzpy_audioReset(TP)
+{
+int r=py_audioReset(); 
+return tp_number(r);
+}
+//int  audioMixer <char * >
+tp_obj zzpy_audioMixer(TP)
+{
+char * p0=(char *)TP_STR().string.val;
+int r=py_audioMixer(p0); 
+return tp_number(r);
+}
+//int  clearVideoFilters <void>
+tp_obj zzpy_clearVideoFilters(TP)
+{
+int r=py_clearVideoFilters(); 
+return tp_number(r);
+}
+pyFuncs adm_functions[]={
+{"loadVideo",zzpy_loadVideo},
+{"clearSegments",zzpy_clearSegments},
+{"appendVideo",zzpy_appendVideo},
+{"addSegment",zzpy_addSegment},
+{"setPostProc",zzpy_setPostProc},
+{"getWidth",zzpy_getWidth},
+{"getHeight",zzpy_getHeight},
+{"getFps1000",zzpy_getFps1000},
+{"audioReset",zzpy_audioReset},
+{"audioMixer",zzpy_audioMixer},
+{"clearVideoFilters",zzpy_clearVideoFilters},
+{NULL,NULL}
+};

Copied: branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/py/adm_gen.h (from rev 6206, branches/avidemux_2.6_branch_mean/avidemux/common/ADM_pyScript/src/adm_gen.h)
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/ADM_pyScript/src/adm_gen.h	2010-05-20 15:22:49 UTC (rev 6206)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/py/adm_gen.h	2010-05-20 15:22:52 UTC (rev 6207)
@@ -0,0 +1,11 @@
+int  py_loadVideo (char * );
+int  py_clearSegments (void);
+int  py_appendVideo (char * );
+int  py_addSegment (int ,float , float );
+int  py_setPostProc (int ,int , int );
+int  py_getWidth (void);
+int  py_getHeight (void);
+int  py_getFps1000 (void);
+int  py_audioReset (void);
+int  py_audioMixer (char * );
+int  py_clearVideoFilters (void);

Copied: branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/py/include/ADM_pyIf.h (from rev 6206, branches/avidemux_2.6_branch_mean/avidemux/common/ADM_pyScript/include/ADM_pyIf.h)
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/ADM_pyScript/include/ADM_pyIf.h	2010-05-20 15:22:49 UTC (rev 6206)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/py/include/ADM_pyIf.h	2010-05-20 15:22:52 UTC (rev 6207)
@@ -0,0 +1,21 @@
+/**
+    \file ADM_pyIf.h
+    \brief Interface for python script 
+    \author mean fixounet at free.fr 2010
+
+*/
+/***************************************************************************
+ *                                                                         *
+ *   This program is free software; you can redistribute it and/or modify  *
+ *   it under the terms of the GNU General Public License as published by  *
+ *   the Free Software Foundation; either version 2 of the License, or     *
+ *   (at your option) any later version.                                   *
+ *                                                                         *
+ ***************************************************************************/
+#ifndef ADM_PY_IF_H
+#define ADM_PY_IF_H
+
+bool parseTinyPyScript(const char *name);
+bool interactiveTinyPy(void);
+
+#endif
\ No newline at end of file

Deleted: branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src/ADM_jsAudio.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src/ADM_jsAudio.cpp	2010-05-20 15:22:49 UTC (rev 6206)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src/ADM_jsAudio.cpp	2010-05-20 15:22:52 UTC (rev 6207)
@@ -1,100 +0,0 @@
-/**
-    \file ADM_jsAudio.cpp
-    \brief Audio oriented functions
-    \author mean (c) 2009 fixounet at free.fr
-
-
-    jsapigen does not like much variable number of arguments
-    In that case, we patch the generated file to go back to native spidermonkey api
-
-
-*/
-/***************************************************************************
- *                                                                         *
- *   This program is free software; you can redistribute it and/or modify  *
- *   it under the terms of the GNU General Public License as published by  *
- *   the Free Software Foundation; either version 2 of the License, or     *
- *   (at your option) any later version.                                   *
- *                                                                         *
- ***************************************************************************/
-#include "ADM_js.h"
-#include "ADM_editor/ADM_edit.hxx"
-#include "ADM_jsAvidemux.h"
-#include "A_functions.h"
-#include "GUI_ui.h"
-#include "ADM_audioFilterInterface.h"
-#include "audioEncoderApi.h"
-extern ADM_Composer *video_body;
-/**
-    \fn int jsAudioReset(void);
-*/
-int jsAudioReset (void)
-{
-    audioFilterReset();
-    return 1;
-}
-/**
-    \fn 
-*/  
-extern "C" int   jsAudioCodec(const char *a,const char **b) {return 0;}
-JSBool jsAdmaudioCodec(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval)
-{
-        // default return value
-        *rval = BOOLEAN_TO_JSVAL(false);
-        if(argc < 2)
-                return JS_FALSE;
-        if(JSVAL_IS_STRING(argv[0]) == false || JSVAL_IS_INT(argv[1]) == false )            return JS_FALSE;
-        for(int i=2;i<argc;i++)  if(JSVAL_IS_STRING(argv[i]) == false) return JS_FALSE;
-
-        // Get Codec...
-        char *name = JS_GetStringBytes(JSVAL_TO_STRING(argv[0]));
-        ADM_LowerCase(name);
-        
-        // First search the codec by its name
-        if(!audioCodecSetByName(name))
-        {
-                *rval = BOOLEAN_TO_JSVAL(false);
-                jsLog(JS_LOG_ERROR,"Cannot set audio codec %s\n",name);
-        }
-        else
-        {
-            // begin set bitrate
-            uint32_t bitrate=JSVAL_TO_INT(argv[1]);
-            // Construct couples
-            CONFcouple *c=NULL;
-            if(argc>2)
-            {
-                int nb=argc-2;
-                jsArgToConfCouple( nb,&c,  argv+2);
-            }
-            *rval = BOOLEAN_TO_JSVAL(setAudioExtraConf(bitrate,c));
-            if(c) delete c;
-        }
-
-        // end set bitrate
-        
-        return JS_TRUE;
-}
-/**
-    \fn jsAudioMixer
-*/
-int jsAudioMixer(const char *s)
-{
-    CHANNEL_CONF c=AudioMuxerStringToId(s);
-    return audioFilterSetMixer(c);
-}
-/**
-    \fn jsGetResample
-*/
-int32_t jsGetResample(void)
-{
-    return 0;
-}
-/**
-    \fn jsSetResample
-*/
-void    jsSetResample(int32_t fq)
-{
-
-}
-//EOF
\ No newline at end of file

Deleted: branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src/ADM_jsAvidemux.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src/ADM_jsAvidemux.cpp	2010-05-20 15:22:49 UTC (rev 6206)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src/ADM_jsAvidemux.cpp	2010-05-20 15:22:52 UTC (rev 6207)
@@ -1,135 +0,0 @@
-/**
-    \file ADM_jsLoad.cpp
-    \brief Load oriented functions
-    \author mean (c) 2009 fixounet at free.fr
-
-
-*/
-/***************************************************************************
- *                                                                         *
- *   This program is free software; you can redistribute it and/or modify  *
- *   it under the terms of the GNU General Public License as published by  *
- *   the Free Software Foundation; either version 2 of the License, or     *
- *   (at your option) any later version.                                   *
- *                                                                         *
- ***************************************************************************/
-#include "ADM_js.h"
-#include "ADM_editor/ADM_edit.hxx"
-#include "ADM_jsAvidemux.h"
-#include "A_functions.h"
-#include "ADM_muxerProto.h"
-#include "GUI_ui.h"
-extern ADM_Composer *video_body;
-/**
-    \fn ADM_JSAvidemux
-    \brief Select the current container from a string
-*/
-bool A_setContainer(const char *cont)
-{
-    int idx=ADM_MuxerIndexFromName(cont);
-    if(idx==-1)
-    {
-        ADM_error("Cannot find muxer for format=%s\n",cont);
-        return false;
-    }
-    ADM_info("setting container as index %d\n",idx);
-    UI_SetCurrentFormat(idx);
-    return true;
-}
-
-/**
-    \fn jsLoadFile
-*/
-int jsLoadVideo(const char *s)
-{
-int ret=0;
-        jsLog(JS_LOG_NORMAL,"[Js] Loading video %s",s);
-        if(A_openAvi(s)) 
-        {
-          ret=1;
-        }
-        
-    return ret;
-}
-
-/**
-    \fn jsAppendFile
-*/
-int jsAppendVideo(const char *s)
-{
-int ret=0;
-        
-        if(A_appendAvi(s)) 
-        {
-          ret=1;
-        }
-        
-    return ret;
-}
-
-/**
-    \fn jsClearSegments
-*/
-int jsClearSegments(void)
-{
-    video_body->clearSegment();
-    return 1;
-}
-/**
-    \fn jsAddSegment
-
-*/
-int  jsAddSegment(int ref, double start, double duration)
-{
-    if(true==video_body->addSegment(ref,(uint64_t)start,(uint64_t)duration)) 
-    {
-        if(1==video_body->getNbSegment()) // We just added our first seg...
-        {
-                ADM_info("First segment, refreshing screen\n");
-                A_Rewind();
-        }
-        return 1;
-    }
-    return 0;
-}
-
-
-/**
-    \fn Codec
-    
-*/
-extern "C" int   jsSetContainer(const char *a,const char **b) {return 0;}
-JSBool jsAdmsetContainer(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval)
-{// begin Codec
-        
-        // default return value
-        *rval = BOOLEAN_TO_JSVAL(false);
-        if(argc < 1)
-        {
-            jsLog(JS_LOG_NORMAL,"setContainer needs at least one arg\n");
-            return JS_FALSE;
-        }
-        
-        if(JSVAL_IS_STRING(argv[0]) == false)
-        {
-                jsLog(JS_LOG_NORMAL,"setContainer needs at string arg\n");
-                return JS_FALSE;
-        }
-        char *str = JS_GetStringBytes(JSVAL_TO_STRING(argv[0]));
-         jsLog(JS_LOG_NORMAL,"[JS] Selecting container :%s\n",str);
-        if(A_setContainer(str))
-        {
-            CONFcouple *c;
-            jsArgToConfCouple(argc-1,&c,argv+1);
-            int idx=ADM_MuxerIndexFromName(str);
-            if(idx!=-1)
-            {
-                *rval = BOOLEAN_TO_JSVAL( ADM_mx_setExtraConf(idx,c));
-            }
-            if(c) delete c;
-        }
-        return JS_TRUE;
-}// end Codec
-
-
-// EOF
\ No newline at end of file

Deleted: branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src/ADM_jsAvidemuxInfo.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src/ADM_jsAvidemuxInfo.cpp	2010-05-20 15:22:49 UTC (rev 6206)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src/ADM_jsAvidemuxInfo.cpp	2010-05-20 15:22:52 UTC (rev 6207)
@@ -1,59 +0,0 @@
-/**
-    \file ADM_jsLoad.cpp
-    \brief Load oriented functions
-    \author mean (c) 2009 fixounet at free.fr
-
-
-*/
-/***************************************************************************
- *                                                                         *
- *   This program is free software; you can redistribute it and/or modify  *
- *   it under the terms of the GNU General Public License as published by  *
- *   the Free Software Foundation; either version 2 of the License, or     *
- *   (at your option) any later version.                                   *
- *                                                                         *
- ***************************************************************************/
-#include "ADM_js.h"
-#include "ADM_editor/ADM_edit.hxx"
-#include "ADM_jsAvidemux.h"
-#include "fourcc.h"
-extern ADM_Composer *video_body;
-/**
-    \fn jsGetWidth
-*/
-int jsGetWidth ( void)
-{
-aviInfo info;
-        video_body->getVideoInfo(&info);
-        return info.width;
-}
-/**
-    \fn jsGetHeight
-*/
-int jsGetHeight ( void)
-{
-aviInfo info;
-        video_body->getVideoInfo(&info);
-        return info.height;
-}
-/**
-    \fn jsGetFps1000
-*/
-int jsGetFps1000 ( void)
-{
-aviInfo info;
-        video_body->getVideoInfo(&info);
-        return info.fps1000;
-}
-/**
-    \fn jsGetVideoCodec
-*/
-char *jsGetVideoCodec ( void)
-{
-uint32_t fcc;
-aviInfo info;
-        video_body->getVideoInfo(&info);
-        fcc=info.fcc;
-        return fourCC::tostring(fcc);
-}
-// EOF

Deleted: branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src/ADM_jsAvidemux_js.c
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src/ADM_jsAvidemux_js.c	2010-05-20 15:22:49 UTC (rev 6206)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src/ADM_jsAvidemux_js.c	2010-05-20 15:22:52 UTC (rev 6207)
@@ -1,1317 +0,0 @@
-/*
---- DO NOT EDIT THIS FILE !!! ---
-
-This file has been generated automatically with 'jsapigen'.
-
-jsapigen is a glue-code generator for SpiderMonkey. It is distributed
-under the conditions of version 3 of the GNU General Public License.
-Please have a look at http://jsapigen.sourceforge.net.
-
-This file is NOT part of jsapigen and is NOT necessarily covered by
-jsapigen's license. For licensing information regarding this file,
-please refer to the software package which it is part of.
-
-*/
-
-#include "stdio.h"
-#include "ADM_jsAvidemux.h"
-void jsAvidemux(void)
-{
-        printf("Constructor invoked\n");
-}
-
-#ifdef HAVE_ALLOCA_H
-#include <alloca.h>
-static size_t jj_alloca_limit = 0;
-#endif
-#include <stdlib.h>
-#include <string.h>
-#include <wchar.h>
-#ifdef HAVE_ALLOCA_H
-#endif
-#include <jsapi.h>
-#ifndef JS_THREADSAFE
-#if JS_VERSION <= 170
-#define jsrefcount int
-#define JS_BeginRequest(cx)
-#define JS_EndRequest(cx)
-#define JS_SuspendRequest(cx)
-#define JS_ResumeRequest(cx, saveDepth)
-#endif
-#endif
-#ifndef JS_FS
-#define JS_FS(name, call, nargs, flags, extra) {name, call, nargs, flags, extra}
-#endif
-#ifndef JS_FS_END
-#define JS_FS_END {NULL, NULL, 0, 0, 0}
-#endif
-
-static JSBool
-jjadmmarkerA_get(JSContext *cx, JSObject *obj, jsval id, jsval *val)
-{
-    double var2;
-    jsval var5;
-    JSBool var1;
-    var2 = 0.0;
-    var5 = JSVAL_NULL;
-    var1 = JS_FALSE;
-    if (!JS_EnterLocalRootScope(cx)) {
-        goto do_return;
-    }
-    var2 = jsGetMarkerA();
-    if (JS_NewNumberValue(cx, var2, &var5) != JS_TRUE) {
-        goto do_return;
-    }
-    if (val) {
-        *val = var5;
-    }
-    var1 = JS_TRUE;
-    do_return:
-    JS_LeaveLocalRootScope(cx);
-    return var1;
-}
-static JSBool
-jjadmmarkerA_set(JSContext *cx, JSObject *obj, jsval id, jsval *val)
-{
-    double var7;
-    jsval var10;
-    jsdouble var11;
-    JSBool var6;
-    var7 = 0.0;
-    var10 = JSVAL_NULL;
-    var11 = 0.0;
-    var6 = JS_FALSE;
-    if (!JS_EnterLocalRootScope(cx)) {
-        goto do_return;
-    }
-    var10 = *val;
-    if (JS_ValueToNumber(cx, var10, &var11) != JS_TRUE) {
-        goto do_return;
-    }
-    var7 = (double)var11;
-    jsSetMarkerA(var7);
-    var6 = JS_TRUE;
-    do_return:
-    JS_LeaveLocalRootScope(cx);
-    return var6;
-}
-static JSBool
-jjadmmarkerB_get(JSContext *cx, JSObject *obj, jsval id, jsval *val)
-{
-    double var13;
-    jsval var16;
-    JSBool var12;
-    var13 = 0.0;
-    var16 = JSVAL_NULL;
-    var12 = JS_FALSE;
-    if (!JS_EnterLocalRootScope(cx)) {
-        goto do_return;
-    }
-    var13 = jsGetMarkerB();
-    if (JS_NewNumberValue(cx, var13, &var16) != JS_TRUE) {
-        goto do_return;
-    }
-    if (val) {
-        *val = var16;
-    }
-    var12 = JS_TRUE;
-    do_return:
-    JS_LeaveLocalRootScope(cx);
-    return var12;
-}
-static JSBool
-jjadmmarkerB_set(JSContext *cx, JSObject *obj, jsval id, jsval *val)
-{
-    double var18;
-    jsval var21;
-    jsdouble var22;
-    JSBool var17;
-    var18 = 0.0;
-    var21 = JSVAL_NULL;
-    var22 = 0.0;
-    var17 = JS_FALSE;
-    if (!JS_EnterLocalRootScope(cx)) {
-        goto do_return;
-    }
-    var21 = *val;
-    if (JS_ValueToNumber(cx, var21, &var22) != JS_TRUE) {
-        goto do_return;
-    }
-    var18 = (double)var22;
-    jsSetMarkerB(var18);
-    var17 = JS_TRUE;
-    do_return:
-    JS_LeaveLocalRootScope(cx);
-    return var17;
-}
-static JSBool
-jjadmaudioResample_get(JSContext *cx, JSObject *obj, jsval id, jsval *val)
-{
-    int var24;
-    jsval var27;
-    JSBool var23;
-    var24 = 0;
-    var27 = JSVAL_NULL;
-    var23 = JS_FALSE;
-    if (!JS_EnterLocalRootScope(cx)) {
-        goto do_return;
-    }
-    var24 = jsGetResample();
-    if (JS_NewNumberValue(cx, var24, &var27) != JS_TRUE) {
-        goto do_return;
-    }
-    if (val) {
-        *val = var27;
-    }
-    var23 = JS_TRUE;
-    do_return:
-    JS_LeaveLocalRootScope(cx);
-    return var23;
-}
-static JSBool
-jjadmaudioResample_set(JSContext *cx, JSObject *obj, jsval id, jsval *val)
-{
-    int var29;
-    jsval var32;
-    int32 var33;
-    JSBool var28;
-    var29 = 0;
-    var32 = JSVAL_NULL;
-    var33 = 0;
-    var28 = JS_FALSE;
-    if (!JS_EnterLocalRootScope(cx)) {
-        goto do_return;
-    }
-    var32 = *val;
-    if (JS_ValueToInt32(cx, var32, &var33) != JS_TRUE) {
-        goto do_return;
-    }
-    var29 = (int)var33;
-    jsSetResample(var29);
-    var28 = JS_TRUE;
-    do_return:
-    JS_LeaveLocalRootScope(cx);
-    return var28;
-}
-static JSBool
-jjadmloadVideo(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval)
-{
-    JSObject * var35;
-    int var36;
-    int var39;
-    char * var40;
-    int var41;
-    jsval var42;
-    JSString * var43;
-    jsval var241;
-    size_t var44;
-    size_t var45;
-    int var47;
-    jschar * var48;
-    jsval var242;
-    jsval var49;
-    JSBool var34;
-    var35 = NULL;
-    var36 = 0;
-    var39 = 0;
-    var40 = NULL;
-    var41 = 0;
-    var42 = JSVAL_NULL;
-    var43 = NULL;
-    var241 = JSVAL_NULL;
-    var44 = 0;
-    var45 = 0;
-    var47 = 0;
-    var48 = NULL;
-    var242 = JSVAL_NULL;
-    var49 = JSVAL_NULL;
-    var34 = JS_FALSE;
-    var35 = obj;
-    var39 = argc;
-    var41 = 0;
-    var41 = var41 < var39;
-    if (var41) {
-    var42 = argv[0];
-    var43 = JS_ValueToString(cx, var42);
-    if (!var43) {
-        goto do_return;
-    }
-    var241 = STRING_TO_JSVAL(var43);
-    argv[argc+0] = var241;
-    var44 = JS_GetStringLength(var43);
-    var45 = 1;
-    var45 += var44;
-#ifdef HAVE_ALLOCA
-    if (var45 < jj_alloca_limit) {
-        var40 = alloca(var45);
-    } else {
-#endif
-        var40 = malloc(var45);
-        if (!var40) {
-            goto do_return;
-        } else {
-            var47 = 1;
-        }
-#ifdef HAVE_ALLOCA
-    }
-#endif
-    var48 = JS_GetStringChars(var43);
-    var242 = STRING_TO_JSVAL(var43);
-    argv[argc+1] = var242;
-    {
-        size_t i;
-        for (i = 0; i < var44; ++i) {
-            var40[i] = var48[i];
-        }
-        var40[var44] = '\0';
-    }
-    }
-    var36 = jsLoadVideo(var40);
-    if (JS_NewNumberValue(cx, var36, &var49) != JS_TRUE) {
-        goto do_return;
-    }
-    argv[argc+2] = var49;
-    if (rval) {
-        *rval = var49;
-    }
-    var34 = JS_TRUE;
-    do_return:
-    if (var47) {
-        free(var40);
-        var40 = NULL;
-        var47 = 0;
-    }
-    return var34;
-}
-static JSBool
-jjadmclearSegments(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval)
-{
-    JSObject * var51;
-    int var52;
-    int var55;
-    jsval var56;
-    JSBool var50;
-    var51 = NULL;
-    var52 = 0;
-    var55 = 0;
-    var56 = JSVAL_NULL;
-    var50 = JS_FALSE;
-    var51 = obj;
-    var55 = argc;
-    var52 = jsClearSegments();
-    if (JS_NewNumberValue(cx, var52, &var56) != JS_TRUE) {
-        goto do_return;
-    }
-    argv[argc+0] = var56;
-    if (rval) {
-        *rval = var56;
-    }
-    var50 = JS_TRUE;
-    do_return:
-    return var50;
-}
-static JSBool
-jjadmappendVideo(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval)
-{
-    JSObject * var58;
-    int var59;
-    int var62;
-    char * var63;
-    int var64;
-    jsval var65;
-    JSString * var66;
-    jsval var245;
-    size_t var67;
-    size_t var68;
-    int var70;
-    jschar * var71;
-    jsval var246;
-    jsval var72;
-    JSBool var57;
-    var58 = NULL;
-    var59 = 0;
-    var62 = 0;
-    var63 = NULL;
-    var64 = 0;
-    var65 = JSVAL_NULL;
-    var66 = NULL;
-    var245 = JSVAL_NULL;
-    var67 = 0;
-    var68 = 0;
-    var70 = 0;
-    var71 = NULL;
-    var246 = JSVAL_NULL;
-    var72 = JSVAL_NULL;
-    var57 = JS_FALSE;
-    var58 = obj;
-    var62 = argc;
-    var64 = 0;
-    var64 = var64 < var62;
-    if (var64) {
-    var65 = argv[0];
-    var66 = JS_ValueToString(cx, var65);
-    if (!var66) {
-        goto do_return;
-    }
-    var245 = STRING_TO_JSVAL(var66);
-    argv[argc+0] = var245;
-    var67 = JS_GetStringLength(var66);
-    var68 = 1;
-    var68 += var67;
-#ifdef HAVE_ALLOCA
-    if (var68 < jj_alloca_limit) {
-        var63 = alloca(var68);
-    } else {
-#endif
-        var63 = malloc(var68);
-        if (!var63) {
-            goto do_return;
-        } else {
-            var70 = 1;
-        }
-#ifdef HAVE_ALLOCA
-    }
-#endif
-    var71 = JS_GetStringChars(var66);
-    var246 = STRING_TO_JSVAL(var66);
-    argv[argc+1] = var246;
-    {
-        size_t i;
-        for (i = 0; i < var67; ++i) {
-            var63[i] = var71[i];
-        }
-        var63[var67] = '\0';
-    }
-    }
-    var59 = jsAppendVideo(var63);
-    if (JS_NewNumberValue(cx, var59, &var72) != JS_TRUE) {
-        goto do_return;
-    }
-    argv[argc+2] = var72;
-    if (rval) {
-        *rval = var72;
-    }
-    var57 = JS_TRUE;
-    do_return:
-    if (var70) {
-        free(var63);
-        var63 = NULL;
-        var70 = 0;
-    }
-    return var57;
-}
-static JSBool
-jjadmaddSegment(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval)
-{
-    JSObject * var74;
-    int var75;
-    int var78;
-    int var79;
-    int var82;
-    jsval var83;
-    int32 var84;
-    double var80;
-    int var85;
-    jsval var86;
-    jsdouble var87;
-    double var81;
-    int var88;
-    jsval var89;
-    jsdouble var90;
-    jsval var91;
-    JSBool var73;
-    var74 = NULL;
-    var75 = 0;
-    var78 = 0;
-    var79 = 0;
-    var82 = 0;
-    var83 = JSVAL_NULL;
-    var84 = 0;
-    var80 = 0.0;
-    var85 = 0;
-    var86 = JSVAL_NULL;
-    var87 = 0.0;
-    var81 = 0.0;
-    var88 = 0;
-    var89 = JSVAL_NULL;
-    var90 = 0.0;
-    var91 = JSVAL_NULL;
-    var73 = JS_FALSE;
-    var74 = obj;
-    var78 = argc;
-    var82 = 0;
-    var82 = var82 < var78;
-    if (var82) {
-    var83 = argv[0];
-    if (JS_ValueToInt32(cx, var83, &var84) != JS_TRUE) {
-        goto do_return;
-    }
-    var79 = (int)var84;
-    }
-    var85 = 1;
-    var85 = var85 < var78;
-    if (var85) {
-    var86 = argv[1];
-    if (JS_ValueToNumber(cx, var86, &var87) != JS_TRUE) {
-        goto do_return;
-    }
-    var80 = (double)var87;
-    }
-    var88 = 2;
-    var88 = var88 < var78;
-    if (var88) {
-    var89 = argv[2];
-    if (JS_ValueToNumber(cx, var89, &var90) != JS_TRUE) {
-        goto do_return;
-    }
-    var81 = (double)var90;
-    }
-    var75 = jsAddSegment(var79, var80, var81);
-    if (JS_NewNumberValue(cx, var75, &var91) != JS_TRUE) {
-        goto do_return;
-    }
-    argv[argc+0] = var91;
-    if (rval) {
-        *rval = var91;
-    }
-    var73 = JS_TRUE;
-    do_return:
-    return var73;
-}
-static JSBool
-jjadmsetPostProc(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval)
-{
-    JSObject * var93;
-    int var94;
-    int var97;
-    int var98;
-    int var101;
-    jsval var102;
-    int32 var103;
-    int var99;
-    int var104;
-    jsval var105;
-    int32 var106;
-    int var100;
-    int var107;
-    jsval var108;
-    int32 var109;
-    jsval var110;
-    JSBool var92;
-    var93 = NULL;
-    var94 = 0;
-    var97 = 0;
-    var98 = 0;
-    var101 = 0;
-    var102 = JSVAL_NULL;
-    var103 = 0;
-    var99 = 0;
-    var104 = 0;
-    var105 = JSVAL_NULL;
-    var106 = 0;
-    var100 = 0;
-    var107 = 0;
-    var108 = JSVAL_NULL;
-    var109 = 0;
-    var110 = JSVAL_NULL;
-    var92 = JS_FALSE;
-    var93 = obj;
-    var97 = argc;
-    var101 = 0;
-    var101 = var101 < var97;
-    if (var101) {
-    var102 = argv[0];
-    if (JS_ValueToInt32(cx, var102, &var103) != JS_TRUE) {
-        goto do_return;
-    }
-    var98 = (int)var103;
-    }
-    var104 = 1;
-    var104 = var104 < var97;
-    if (var104) {
-    var105 = argv[1];
-    if (JS_ValueToInt32(cx, var105, &var106) != JS_TRUE) {
-        goto do_return;
-    }
-    var99 = (int)var106;
-    }
-    var107 = 2;
-    var107 = var107 < var97;
-    if (var107) {
-    var108 = argv[2];
-    if (JS_ValueToInt32(cx, var108, &var109) != JS_TRUE) {
-        goto do_return;
-    }
-    var100 = (int)var109;
-    }
-    var94 = jsSetPostProc(var98, var99, var100);
-    if (JS_NewNumberValue(cx, var94, &var110) != JS_TRUE) {
-        goto do_return;
-    }
-    argv[argc+0] = var110;
-    if (rval) {
-        *rval = var110;
-    }
-    var92 = JS_TRUE;
-    do_return:
-    return var92;
-}
-static JSBool
-jjadmgetWidth(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval)
-{
-    JSObject * var112;
-    int var113;
-    int var116;
-    jsval var117;
-    JSBool var111;
-    var112 = NULL;
-    var113 = 0;
-    var116 = 0;
-    var117 = JSVAL_NULL;
-    var111 = JS_FALSE;
-    var112 = obj;
-    var116 = argc;
-    var113 = jsGetWidth();
-    if (JS_NewNumberValue(cx, var113, &var117) != JS_TRUE) {
-        goto do_return;
-    }
-    argv[argc+0] = var117;
-    if (rval) {
-        *rval = var117;
-    }
-    var111 = JS_TRUE;
-    do_return:
-    return var111;
-}
-static JSBool
-jjadmgetHeight(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval)
-{
-    JSObject * var119;
-    int var120;
-    int var123;
-    jsval var124;
-    JSBool var118;
-    var119 = NULL;
-    var120 = 0;
-    var123 = 0;
-    var124 = JSVAL_NULL;
-    var118 = JS_FALSE;
-    var119 = obj;
-    var123 = argc;
-    var120 = jsGetHeight();
-    if (JS_NewNumberValue(cx, var120, &var124) != JS_TRUE) {
-        goto do_return;
-    }
-    argv[argc+0] = var124;
-    if (rval) {
-        *rval = var124;
-    }
-    var118 = JS_TRUE;
-    do_return:
-    return var118;
-}
-static JSBool
-jjadmgetFps1000(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval)
-{
-    JSObject * var126;
-    int var127;
-    int var130;
-    jsval var131;
-    JSBool var125;
-    var126 = NULL;
-    var127 = 0;
-    var130 = 0;
-    var131 = JSVAL_NULL;
-    var125 = JS_FALSE;
-    var126 = obj;
-    var130 = argc;
-    var127 = jsGetFps1000();
-    if (JS_NewNumberValue(cx, var127, &var131) != JS_TRUE) {
-        goto do_return;
-    }
-    argv[argc+0] = var131;
-    if (rval) {
-        *rval = var131;
-    }
-    var125 = JS_TRUE;
-    do_return:
-    return var125;
-}
-static JSBool
-jjadmgetVideoCodec(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval)
-{
-    JSObject * var133;
-    char * var134;
-    int var137;
-    jsval var138;
-    JSString * var139;
-    jsval var253;
-    char * var140;
-    jsval var254;
-    JSBool var132;
-    var133 = NULL;
-    var134 = NULL;
-    var137 = 0;
-    var138 = JSVAL_NULL;
-    var139 = NULL;
-    var253 = JSVAL_NULL;
-    var140 = NULL;
-    var254 = JSVAL_NULL;
-    var132 = JS_FALSE;
-    var133 = obj;
-    var137 = argc;
-    var134 = jsGetVideoCodec();
-    if (var134) {
-    var139 = JS_NewStringCopyZ(cx, var134);
-    if (!var139) {
-        goto do_return;
-    }
-    var253 = STRING_TO_JSVAL(var139);
-    argv[argc+0] = var253;
-    } else {
-    var140 = "";
-    var139 = JS_InternString(cx, var140);
-    if (!var139) {
-        goto do_return;
-    }
-    var254 = STRING_TO_JSVAL(var139);
-    argv[argc+1] = var254;
-    }
-    var138 = STRING_TO_JSVAL(var139);
-    if (rval) {
-        *rval = var138;
-    }
-    var132 = JS_TRUE;
-    do_return:
-    return var132;
-}
-static JSBool
-jjadmaudioReset(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval)
-{
-    JSObject * var142;
-    int var143;
-    int var146;
-    jsval var147;
-    JSBool var141;
-    var142 = NULL;
-    var143 = 0;
-    var146 = 0;
-    var147 = JSVAL_NULL;
-    var141 = JS_FALSE;
-    var142 = obj;
-    var146 = argc;
-    var143 = jsAudioReset();
-    if (JS_NewNumberValue(cx, var143, &var147) != JS_TRUE) {
-        goto do_return;
-    }
-    argv[argc+0] = var147;
-    if (rval) {
-        *rval = var147;
-    }
-    var141 = JS_TRUE;
-    do_return:
-    return var141;
-}
-static JSBool
-jjadmaudioMixer(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval)
-{
-    JSObject * var149;
-    int var150;
-    int var153;
-    char * var154;
-    int var155;
-    jsval var156;
-    JSString * var157;
-    jsval var256;
-    size_t var158;
-    size_t var159;
-    int var161;
-    jschar * var162;
-    jsval var257;
-    jsval var163;
-    JSBool var148;
-    var149 = NULL;
-    var150 = 0;
-    var153 = 0;
-    var154 = NULL;
-    var155 = 0;
-    var156 = JSVAL_NULL;
-    var157 = NULL;
-    var256 = JSVAL_NULL;
-    var158 = 0;
-    var159 = 0;
-    var161 = 0;
-    var162 = NULL;
-    var257 = JSVAL_NULL;
-    var163 = JSVAL_NULL;
-    var148 = JS_FALSE;
-    var149 = obj;
-    var153 = argc;
-    var155 = 0;
-    var155 = var155 < var153;
-    if (var155) {
-    var156 = argv[0];
-    var157 = JS_ValueToString(cx, var156);
-    if (!var157) {
-        goto do_return;
-    }
-    var256 = STRING_TO_JSVAL(var157);
-    argv[argc+0] = var256;
-    var158 = JS_GetStringLength(var157);
-    var159 = 1;
-    var159 += var158;
-#ifdef HAVE_ALLOCA
-    if (var159 < jj_alloca_limit) {
-        var154 = alloca(var159);
-    } else {
-#endif
-        var154 = malloc(var159);
-        if (!var154) {
-            goto do_return;
-        } else {
-            var161 = 1;
-        }
-#ifdef HAVE_ALLOCA
-    }
-#endif
-    var162 = JS_GetStringChars(var157);
-    var257 = STRING_TO_JSVAL(var157);
-    argv[argc+1] = var257;
-    {
-        size_t i;
-        for (i = 0; i < var158; ++i) {
-            var154[i] = var162[i];
-        }
-        var154[var158] = '\0';
-    }
-    }
-    var150 = jsAudioMixer(var154);
-    if (JS_NewNumberValue(cx, var150, &var163) != JS_TRUE) {
-        goto do_return;
-    }
-    argv[argc+2] = var163;
-    if (rval) {
-        *rval = var163;
-    }
-    var148 = JS_TRUE;
-    do_return:
-    if (var161) {
-        free(var154);
-        var154 = NULL;
-        var161 = 0;
-    }
-    return var148;
-}
-static JSBool
-jjadmclearVideoFilters(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval)
-{
-    JSObject * var165;
-    int var166;
-    int var169;
-    jsval var170;
-    JSBool var164;
-    var165 = NULL;
-    var166 = 0;
-    var169 = 0;
-    var170 = JSVAL_NULL;
-    var164 = JS_FALSE;
-    var165 = obj;
-    var169 = argc;
-    var166 = jsClearVideoFilters();
-    if (JS_NewNumberValue(cx, var166, &var170) != JS_TRUE) {
-        goto do_return;
-    }
-    argv[argc+0] = var170;
-    if (rval) {
-        *rval = var170;
-    }
-    var164 = JS_TRUE;
-    do_return:
-    return var164;
-}
-static JSBool
-jjadmvideoCodec_ignore(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval)
-{
-    JSObject * var172;
-    int var173;
-    int var176;
-    char * var177;
-    int var178;
-    jsval var179;
-    JSString * var180;
-    jsval var260;
-    size_t var181;
-    size_t var182;
-    int var184;
-    jschar * var185;
-    jsval var261;
-    jsval var186;
-    JSBool var171;
-    var172 = NULL;
-    var173 = 0;
-    var176 = 0;
-    var177 = NULL;
-    var178 = 0;
-    var179 = JSVAL_NULL;
-    var180 = NULL;
-    var260 = JSVAL_NULL;
-    var181 = 0;
-    var182 = 0;
-    var184 = 0;
-    var185 = NULL;
-    var261 = JSVAL_NULL;
-    var186 = JSVAL_NULL;
-    var171 = JS_FALSE;
-    var172 = obj;
-    var176 = argc;
-    var178 = 0;
-    var178 = var178 < var176;
-    if (var178) {
-    var179 = argv[0];
-    var180 = JS_ValueToString(cx, var179);
-    if (!var180) {
-        goto do_return;
-    }
-    var260 = STRING_TO_JSVAL(var180);
-    argv[argc+0] = var260;
-    var181 = JS_GetStringLength(var180);
-    var182 = 1;
-    var182 += var181;
-#ifdef HAVE_ALLOCA
-    if (var182 < jj_alloca_limit) {
-        var177 = alloca(var182);
-    } else {
-#endif
-        var177 = malloc(var182);
-        if (!var177) {
-            goto do_return;
-        } else {
-            var184 = 1;
-        }
-#ifdef HAVE_ALLOCA
-    }
-#endif
-    var185 = JS_GetStringChars(var180);
-    var261 = STRING_TO_JSVAL(var180);
-    argv[argc+1] = var261;
-    {
-        size_t i;
-        for (i = 0; i < var181; ++i) {
-            var177[i] = var185[i];
-        }
-        var177[var181] = '\0';
-    }
-    }
-    var173 = jsVideoCodec(var177);
-    if (JS_NewNumberValue(cx, var173, &var186) != JS_TRUE) {
-        goto do_return;
-    }
-    argv[argc+2] = var186;
-    if (rval) {
-        *rval = var186;
-    }
-    var171 = JS_TRUE;
-    do_return:
-    if (var184) {
-        free(var177);
-        var177 = NULL;
-        var184 = 0;
-    }
-    return var171;
-}
-static JSBool
-jjadmaddVideoFilter_ignore(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval)
-{
-    JSObject * var188;
-    int var189;
-    int var192;
-    char * var193;
-    int var194;
-    jsval var195;
-    JSString * var196;
-    jsval var263;
-    size_t var197;
-    size_t var198;
-    int var200;
-    jschar * var201;
-    jsval var264;
-    jsval var202;
-    JSBool var187;
-    var188 = NULL;
-    var189 = 0;
-    var192 = 0;
-    var193 = NULL;
-    var194 = 0;
-    var195 = JSVAL_NULL;
-    var196 = NULL;
-    var263 = JSVAL_NULL;
-    var197 = 0;
-    var198 = 0;
-    var200 = 0;
-    var201 = NULL;
-    var264 = JSVAL_NULL;
-    var202 = JSVAL_NULL;
-    var187 = JS_FALSE;
-    var188 = obj;
-    var192 = argc;
-    var194 = 0;
-    var194 = var194 < var192;
-    if (var194) {
-    var195 = argv[0];
-    var196 = JS_ValueToString(cx, var195);
-    if (!var196) {
-        goto do_return;
-    }
-    var263 = STRING_TO_JSVAL(var196);
-    argv[argc+0] = var263;
-    var197 = JS_GetStringLength(var196);
-    var198 = 1;
-    var198 += var197;
-#ifdef HAVE_ALLOCA
-    if (var198 < jj_alloca_limit) {
-        var193 = alloca(var198);
-    } else {
-#endif
-        var193 = malloc(var198);
-        if (!var193) {
-            goto do_return;
-        } else {
-            var200 = 1;
-        }
-#ifdef HAVE_ALLOCA
-    }
-#endif
-    var201 = JS_GetStringChars(var196);
-    var264 = STRING_TO_JSVAL(var196);
-    argv[argc+1] = var264;
-    {
-        size_t i;
-        for (i = 0; i < var197; ++i) {
-            var193[i] = var201[i];
-        }
-        var193[var197] = '\0';
-    }
-    }
-    var189 = jsVideoFilter(var193);
-    if (JS_NewNumberValue(cx, var189, &var202) != JS_TRUE) {
-        goto do_return;
-    }
-    argv[argc+2] = var202;
-    if (rval) {
-        *rval = var202;
-    }
-    var187 = JS_TRUE;
-    do_return:
-    if (var200) {
-        free(var193);
-        var193 = NULL;
-        var200 = 0;
-    }
-    return var187;
-}
-static JSBool
-jjadmaudioCodec_ignore(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval)
-{
-    JSObject * var204;
-    int var205;
-    int var208;
-    char * var209;
-    int var210;
-    jsval var211;
-    JSString * var212;
-    jsval var266;
-    size_t var213;
-    size_t var214;
-    int var216;
-    jschar * var217;
-    jsval var267;
-    jsval var218;
-    JSBool var203;
-    var204 = NULL;
-    var205 = 0;
-    var208 = 0;
-    var209 = NULL;
-    var210 = 0;
-    var211 = JSVAL_NULL;
-    var212 = NULL;
-    var266 = JSVAL_NULL;
-    var213 = 0;
-    var214 = 0;
-    var216 = 0;
-    var217 = NULL;
-    var267 = JSVAL_NULL;
-    var218 = JSVAL_NULL;
-    var203 = JS_FALSE;
-    var204 = obj;
-    var208 = argc;
-    var210 = 0;
-    var210 = var210 < var208;
-    if (var210) {
-    var211 = argv[0];
-    var212 = JS_ValueToString(cx, var211);
-    if (!var212) {
-        goto do_return;
-    }
-    var266 = STRING_TO_JSVAL(var212);
-    argv[argc+0] = var266;
-    var213 = JS_GetStringLength(var212);
-    var214 = 1;
-    var214 += var213;
-#ifdef HAVE_ALLOCA
-    if (var214 < jj_alloca_limit) {
-        var209 = alloca(var214);
-    } else {
-#endif
-        var209 = malloc(var214);
-        if (!var209) {
-            goto do_return;
-        } else {
-            var216 = 1;
-        }
-#ifdef HAVE_ALLOCA
-    }
-#endif
-    var217 = JS_GetStringChars(var212);
-    var267 = STRING_TO_JSVAL(var212);
-    argv[argc+1] = var267;
-    {
-        size_t i;
-        for (i = 0; i < var213; ++i) {
-            var209[i] = var217[i];
-        }
-        var209[var213] = '\0';
-    }
-    }
-    var205 = jsAudioCodec(var209);
-    if (JS_NewNumberValue(cx, var205, &var218) != JS_TRUE) {
-        goto do_return;
-    }
-    argv[argc+2] = var218;
-    if (rval) {
-        *rval = var218;
-    }
-    var203 = JS_TRUE;
-    do_return:
-    if (var216) {
-        free(var209);
-        var209 = NULL;
-        var216 = 0;
-    }
-    return var203;
-}
-static JSBool
-jjadmsetContainer_ignore(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval)
-{
-    JSObject * var220;
-    int var221;
-    int var224;
-    char * var225;
-    int var226;
-    jsval var227;
-    JSString * var228;
-    jsval var269;
-    size_t var229;
-    size_t var230;
-    int var232;
-    jschar * var233;
-    jsval var270;
-    jsval var234;
-    JSBool var219;
-    var220 = NULL;
-    var221 = 0;
-    var224 = 0;
-    var225 = NULL;
-    var226 = 0;
-    var227 = JSVAL_NULL;
-    var228 = NULL;
-    var269 = JSVAL_NULL;
-    var229 = 0;
-    var230 = 0;
-    var232 = 0;
-    var233 = NULL;
-    var270 = JSVAL_NULL;
-    var234 = JSVAL_NULL;
-    var219 = JS_FALSE;
-    var220 = obj;
-    var224 = argc;
-    var226 = 0;
-    var226 = var226 < var224;
-    if (var226) {
-    var227 = argv[0];
-    var228 = JS_ValueToString(cx, var227);
-    if (!var228) {
-        goto do_return;
-    }
-    var269 = STRING_TO_JSVAL(var228);
-    argv[argc+0] = var269;
-    var229 = JS_GetStringLength(var228);
-    var230 = 1;
-    var230 += var229;
-#ifdef HAVE_ALLOCA
-    if (var230 < jj_alloca_limit) {
-        var225 = alloca(var230);
-    } else {
-#endif
-        var225 = malloc(var230);
-        if (!var225) {
-            goto do_return;
-        } else {
-            var232 = 1;
-        }
-#ifdef HAVE_ALLOCA
-    }
-#endif
-    var233 = JS_GetStringChars(var228);
-    var270 = STRING_TO_JSVAL(var228);
-    argv[argc+1] = var270;
-    {
-        size_t i;
-        for (i = 0; i < var229; ++i) {
-            var225[i] = var233[i];
-        }
-        var225[var229] = '\0';
-    }
-    }
-    var221 = jsSetContainer(var225);
-    if (JS_NewNumberValue(cx, var221, &var234) != JS_TRUE) {
-        goto do_return;
-    }
-    argv[argc+2] = var234;
-    if (rval) {
-        *rval = var234;
-    }
-    var219 = JS_TRUE;
-    do_return:
-    if (var232) {
-        free(var225);
-        var225 = NULL;
-        var232 = 0;
-    }
-    return var219;
-}
-static JSBool
-jjadm__construct__(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval)
-{
-    JSObject * var236;
-    int var240;
-    JSBool var235;
-    var236 = NULL;
-    var240 = 0;
-    var235 = JS_FALSE;
-    var236 = obj;
-    var240 = argc;
-    jsAvidemux();
-    var235 = JS_TRUE;
-    return var235;
-}
-static JSPropertySpec jj_static_ps[] = {
-    {NULL, 0, 0, NULL, NULL}
-};
-static JSPropertySpec jj_ps[] = {
-    {NULL, 0, 0, NULL, NULL}
-};
-static JSFunctionSpec jj_static_fs[] = {
-    JS_FS_END
-};
-static JSFunctionSpec jj_fs[] = {
-    JS_FS_END
-};
-static JSPropertySpec jjadm_static_ps[] = {
-    {"markerA", 0, 0|JSPROP_ENUMERATE, jjadmmarkerA_get, jjadmmarkerA_set},
-    {"markerB", 0, 0|JSPROP_ENUMERATE, jjadmmarkerB_get, jjadmmarkerB_set},
-    {"audioResample", 0, 0|JSPROP_ENUMERATE, jjadmaudioResample_get, jjadmaudioResample_set},
-    {NULL, 0, 0, NULL, NULL}
-};
-static JSPropertySpec jjadm_ps[] = {
-    {NULL, 0, 0, NULL, NULL}
-};
-static JSFunctionSpec jjadm_static_fs[] = {
-    JS_FS("loadVideo", jjadmloadVideo, 1, 0, 3),
-    JS_FS("clearSegments", jjadmclearSegments, 0, 0, 1),
-    JS_FS("appendVideo", jjadmappendVideo, 1, 0, 3),
-    JS_FS("addSegment", jjadmaddSegment, 3, 0, 1),
-    JS_FS("setPostProc", jjadmsetPostProc, 3, 0, 1),
-    JS_FS("getWidth", jjadmgetWidth, 0, 0, 1),
-    JS_FS("getHeight", jjadmgetHeight, 0, 0, 1),
-    JS_FS("getFps1000", jjadmgetFps1000, 0, 0, 1),
-    JS_FS("getVideoCodec", jjadmgetVideoCodec, 0, 0, 2),
-    JS_FS("audioReset", jjadmaudioReset, 0, 0, 1),
-    JS_FS("audioMixer", jjadmaudioMixer, 1, 0, 3),
-    JS_FS("clearVideoFilters", jjadmclearVideoFilters, 0, 0, 1),
-    JS_FS("videoCodec", jsAdmvideoCodec,  1, 0, 3),
-    JS_FS("addVideoFilter", jsAdmaddVideoFilter,  1, 0, 3),
-    JS_FS("audioCodec", jsAdmaudioCodec,  1, 0, 3),
-    JS_FS("setContainer", jsAdmsetContainer,  1, 0, 3),
-    JS_FS_END
-};
-static JSFunctionSpec jjadm_fs[] = {
-    JS_FS_END
-};
-static JSClass jjadm_class = {
-    "adm",
-    0,
-    JS_PropertyStub,
-    JS_PropertyStub,
-    JS_PropertyStub,
-    JS_PropertyStub,
-    JS_EnumerateStub,
-    JS_ResolveStub,
-    JS_ConvertStub,
-    JS_FinalizeStub,
-    NULL,
-    NULL,
-    NULL,
-    jjadm__construct__,
-    NULL,
-    NULL,
-    NULL,
-    NULL
-};
-static JSObject *
-jjadm_init(JSContext *cx, JSObject *obj)
-{
-    JSObject *parent_proto, *proto;
-    JSClass *class;
-    if (!cx || !obj) {
-        JS_ReportError(cx, "invalid parameter");
-        return NULL;
-    }
-    if (!JS_EnterLocalRootScope(cx)) {
-        JS_ReportError(cx, "JS_EnterLocalRootScope failed");
-        return NULL;
-    }
-    parent_proto = NULL;
-    proto = NULL;
-    parent_proto = JS_NewObject(cx, NULL, NULL, NULL);
-    if (!parent_proto) {
-        JS_LeaveLocalRootScope(cx);
-        JS_ReportError(cx, "failed to create prototype");
-        return NULL;
-    }
-    class = &jjadm_class;
-    proto = JS_InitClass(cx, obj, parent_proto, class, jjadm__construct__, 0, jjadm_ps, jjadm_fs, jjadm_static_ps, jjadm_static_fs);
-    if (!proto) {
-        JS_LeaveLocalRootScope(cx);
-        JS_ReportError(cx, "failed to init class");
-        return NULL;
-    }
-    JS_LeaveLocalRootScope(cx);
-    return proto;
-}
-
-
-JSObject *jsAvidemuxInit(JSContext *cx,JSObject *obj)
-{
-          if (JS_DefineFunctions(cx, obj, jj_static_fs) != JS_TRUE) 
-          {
-                return NULL;
-          }
-          return jjadm_init(cx,obj);
-}
-
-JSFunctionSpec  *jsGetAdmFunctions(void)
-{
-        return jjadm_static_fs;
-}
-
-

Deleted: branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src/ADM_jsAvidemux_js.idl
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src/ADM_jsAvidemux_js.idl	2010-05-20 15:22:49 UTC (rev 6206)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src/ADM_jsAvidemux_js.idl	2010-05-20 15:22:52 UTC (rev 6207)
@@ -1,55 +0,0 @@
-%{
-#include "stdio.h"
-#include "ADM_jsAvidemux.h"
-void jsAvidemux(void)
-{
-        printf("Constructor invoked\n");
-}
-%}
-        /*            JSFUNC      C FUNC  PARAM     */
-class adm
-{
-        function int loadVideo      : jsLoadVideo (cstring ) <static>;
-        function int clearSegments  : jsClearSegments () <static>;
-        function int appendVideo    : jsAppendVideo (cstring ) <static>;
-        function int addSegment     : jsAddSegment (int ,double , double ) <static>;
-        function int setPostProc    : jsSetPostProc (int ,int , int ) <static>;
-        function int getWidth       : jsGetWidth ( ) <static>;
-        function int getHeight      : jsGetHeight ( ) <static>;
-        function int getFps1000     : jsGetFps1000 ( ) <static>;
-     function cstring getVideoCodec : jsGetVideoCodec ( ) <static>;
-        /*            JSFUNC                 C FUNC           PARAM     */
-        function int audioReset     : jsAudioReset () <static>;
-        function int audioMixer     : jsAudioMixer (cstring ) <static>;
-        /*            JSFUNC                 C FUNC           PARAM     */
-        function int clearVideoFilters   : jsClearVideoFilters() <static>;
-        
-/* Override as jsapigen cannot handle multiple args the way we need it to */
-        function int videoCodec_ignore     : jsVideoCodec(cstring)     <static>;
-        function int addVideoFilter_ignore : jsVideoFilter(cstring)    <static>;
-        function int audioCodec_ignore     : jsAudioCodec(cstring)     <static>;
-        function int setContainer_ignore   : jsSetContainer(cstring)   <static>;
-/* Properties */
-        property double markerA            : jsGetMarkerA,jsSetMarkerA <static>;
-        property double markerB            : jsGetMarkerB,jsSetMarkerB <static>;
-        property int    audioResample      : jsGetResample,jsSetResample <static>;
-        construct                          : jsAvidemux  ( ) <static>     ; 
-};
-
-%<
-
-JSObject *jsAvidemuxInit(JSContext *cx,JSObject *obj)
-{
-          if (JS_DefineFunctions(cx, obj, jj_static_fs) != JS_TRUE) 
-          {
-                return NULL;
-          }
-          return jjadm_init(cx,obj);
-}
-
-JSFunctionSpec  *jsGetAdmFunctions(void)
-{
-        return jjadm_static_fs;
-}
-
-%>

Deleted: branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src/ADM_jsDebug.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src/ADM_jsDebug.cpp	2010-05-20 15:22:49 UTC (rev 6206)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src/ADM_jsDebug.cpp	2010-05-20 15:22:52 UTC (rev 6207)
@@ -1,106 +0,0 @@
-/**
-    \file ADM_JSDebug.cpp
-    \brief Debug oriented functions for avidemux JS/JS shell
-    \author mean (c) 2009 fixounet at free.fr
-
-
-*/
-/***************************************************************************
- *                                                                         *
- *   This program is free software; you can redistribute it and/or modify  *
- *   it under the terms of the GNU General Public License as published by  *
- *   the Free Software Foundation; either version 2 of the License, or     *
- *   (at your option) any later version.                                   *
- *                                                                         *
- ***************************************************************************/
-#include "ADM_js.h"
-#include "ADM_editor/ADM_edit.hxx"
-#include "ADM_jsDebug.h"
-#include <vector>
-/**/
-/**/
-extern ADM_Composer *video_body;
-void ADM_dumpJSHooks(void);
-extern vector <JSFunctionSpec *>listOfHooks;
-/**
-    \fn displayError
-    \brief error popup
-*/
-void jsPopupError(const char *s)
-{// begin displayError
-	
-	GUI_Verbose();
-	GUI_Error_HIG("Error",s);
-	GUI_Quiet();
-
-}// end displayError
-/**
-    \fn displayInfo
-    \brief info popup
-*/
-
-void jsPopupInfo(const char *s)
-{// begin displayInfo
-	
-	GUI_Verbose();
-	GUI_Info_HIG(ADM_LOG_IMPORTANT,"Info",s);
-	GUI_Quiet();
-	
-}// end displayInfo
- /**
-    \fn print
-*/
-void jsPrint(const char *s)
-{// begin print
-        jsLog(JS_LOG_NORMAL,"%s",s);
-}// end print
-void jsPrint2(const char *s)
-{// begin print
-        jsLog(JS_LOG_NORMAL,"%s",s);
-}// end print
-
-
-static void dumpFunc(JSFunctionSpec *f)
-{
-    while(f->name)
-    {
-        jsLog(JS_LOG_NORMAL,"     %s(..)",f->name);
-        f++;
-    }
-}
-
-/**
-    \fn printJSError
-*/
-void  printJSError(JSContext *cx, const char *message, JSErrorReport *report)
-{// begin printJSError
-int quiet=GUI_isQuiet();
-char buf[4];
-FILE *fd = ADM_fopen(report->filename,"rb");
-    if(quiet)
-            GUI_Verbose();
-	if( fd )
-    {
-		fread(buf,1,4,fd);
-		fclose(fd);
-	}
-	if( strncmp(buf,"//AD",4) )
-    {
-            if (report->filename || report->lineno)
-                jsLog(JS_LOG_ERROR,"%s: line %d:\nMsg: %s\n",
-                              report->filename,
-                              report->lineno,
-                              message);
-            else
-                jsLog(JS_LOG_ERROR,"Error");
-    
-	}else
-    {
-            jsLog(JS_LOG_ERROR,"%s: line %d:\nMsg: %s\n",report->filename,report->lineno,message);
-	}
-       
-    if(quiet)
-            GUI_Quiet();
-
-}// end printJSError
-// EOF
\ No newline at end of file

Deleted: branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src/ADM_jsEditor.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src/ADM_jsEditor.cpp	2010-05-20 15:22:49 UTC (rev 6206)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src/ADM_jsEditor.cpp	2010-05-20 15:22:52 UTC (rev 6207)
@@ -1,77 +0,0 @@
-/**
-    \file ADM_JSif.cpp
-    \brief interface to js
-*/
-
-/***************************************************************************
- *                                                                         *
- *   This program is free software; you can redistribute it and/or modify  *
- *   it under the terms of the GNU General Public License as published by  *
- *   the Free Software Foundation; either version 2 of the License, or     *
- *   (at your option) any later version.                                   *
- *                                                                         *
- ***************************************************************************/
-
-#include "ADM_js.h"
-#include <stdarg.h>
-#include <vector>
-#include "ADM_jsEditor.h"
-#include "ADM_editor/ADM_edit.hxx"
-extern ADM_Composer *video_body;
-
-/**
-    \fn jsPrintTiming
-*/
-int jsPrintTiming(int framenumber )
-{
-    uint32_t flags;
-    uint64_t pts,dts;
-    if(true==video_body->getVideoPtsDts(framenumber, &flags,&pts,&dts))
-    {
-        int64_t delta=0;
-        if(pts!=ADM_NO_PTS && dts!=ADM_NO_PTS) delta=(int64_t)pts-(int64_t)dts;
-        jsLog(JS_LOG_NORMAL,"Frame %"LU" : Flags 0x%"LX" pts=%"LLD" dts=%"LLD" delta=%"LLD" ms",framenumber,flags,pts,dts,delta/1000LL);
-    }else
-    {
-        jsLog(JS_LOG_NORMAL,"Cannot get info for frame %"LU,framenumber);
-    }
-    return 0;
-}
-
-/**
-    \fn    jsDumpSegments
-    \brief dump segment, video & all
-*/
-int jsDumpSegments (void)
-{// begin PostProcess
-        enterLock();
-        video_body->dumpSegments();
-        leaveLock(); 
-        return 0;
-}// end PostProcess
-/**
-        \fn jsDumpRefVideos
-*/
-int jsDumpRefVideos (void)
-{
-        enterLock();
-        video_body->dumpRefVideos();
-        leaveLock(); 
-
-        return 0;
-}
-/**
-    \fn dumpTiming
-    \brief dump segment, video & all
-*/
-JSBool dumpTiming(void)
-{// begin PostProcess
-        
-  
-        enterLock();
-        video_body->dumpTiming();
-        leaveLock(); 
-        
-        return 0;
-}// end PostProcess
-// EOF

Deleted: branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src/ADM_jsEditor_js.c
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src/ADM_jsEditor_js.c	2010-05-20 15:22:49 UTC (rev 6206)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src/ADM_jsEditor_js.c	2010-05-20 15:22:52 UTC (rev 6207)
@@ -1,256 +0,0 @@
-/*
---- DO NOT EDIT THIS FILE !!! ---
-
-This file has been generated automatically with 'jsapigen'.
-
-jsapigen is a glue-code generator for SpiderMonkey. It is distributed
-under the conditions of version 3 of the GNU General Public License.
-Please have a look at http://jsapigen.sourceforge.net.
-
-This file is NOT part of jsapigen and is NOT necessarily covered by
-jsapigen's license. For licensing information regarding this file,
-please refer to the software package which it is part of.
-
-*/
-
-#include "stdio.h"
-#include "ADM_jsEditor.h"
-void jsEditor(void)
-{
-        printf("Constructor invoked\n");
-}
-
-#ifdef HAVE_ALLOCA_H
-#include <alloca.h>
-static size_t jj_alloca_limit = 0;
-#endif
-#include <stdlib.h>
-#include <string.h>
-#include <wchar.h>
-#ifdef HAVE_ALLOCA_H
-#endif
-#include <jsapi.h>
-#ifndef JS_THREADSAFE
-#if JS_VERSION <= 170
-#define jsrefcount int
-#define JS_BeginRequest(cx)
-#define JS_EndRequest(cx)
-#define JS_SuspendRequest(cx)
-#define JS_ResumeRequest(cx, saveDepth)
-#endif
-#endif
-#ifndef JS_FS
-#define JS_FS(name, call, nargs, flags, extra) {name, call, nargs, flags, extra}
-#endif
-#ifndef JS_FS_END
-#define JS_FS_END {NULL, NULL, 0, 0, 0}
-#endif
-
-static JSBool
-jjeditorprintTiming(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval)
-{
-    JSObject * var2;
-    int var3;
-    int var6;
-    int var7;
-    int var8;
-    jsval var9;
-    int32 var10;
-    jsval var11;
-    JSBool var1;
-    var2 = NULL;
-    var3 = 0;
-    var6 = 0;
-    var7 = 0;
-    var8 = 0;
-    var9 = JSVAL_NULL;
-    var10 = 0;
-    var11 = JSVAL_NULL;
-    var1 = JS_FALSE;
-    var2 = obj;
-    var6 = argc;
-    var8 = 0;
-    var8 = var8 < var6;
-    if (var8) {
-    var9 = argv[0];
-    if (JS_ValueToInt32(cx, var9, &var10) != JS_TRUE) {
-        goto do_return;
-    }
-    var7 = (int)var10;
-    }
-    var3 = jsPrintTiming(var7);
-    if (JS_NewNumberValue(cx, var3, &var11) != JS_TRUE) {
-        goto do_return;
-    }
-    argv[argc+0] = var11;
-    if (rval) {
-        *rval = var11;
-    }
-    var1 = JS_TRUE;
-    do_return:
-    return var1;
-}
-static JSBool
-jjeditordumpSegment(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval)
-{
-    JSObject * var13;
-    int var14;
-    int var17;
-    jsval var18;
-    JSBool var12;
-    var13 = NULL;
-    var14 = 0;
-    var17 = 0;
-    var18 = JSVAL_NULL;
-    var12 = JS_FALSE;
-    var13 = obj;
-    var17 = argc;
-    var14 = jsDumpSegments();
-    if (JS_NewNumberValue(cx, var14, &var18) != JS_TRUE) {
-        goto do_return;
-    }
-    argv[argc+0] = var18;
-    if (rval) {
-        *rval = var18;
-    }
-    var12 = JS_TRUE;
-    do_return:
-    return var12;
-}
-static JSBool
-jjeditordumpRefVideo(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval)
-{
-    JSObject * var20;
-    int var21;
-    int var24;
-    jsval var25;
-    JSBool var19;
-    var20 = NULL;
-    var21 = 0;
-    var24 = 0;
-    var25 = JSVAL_NULL;
-    var19 = JS_FALSE;
-    var20 = obj;
-    var24 = argc;
-    var21 = jsDumpRefVideos();
-    if (JS_NewNumberValue(cx, var21, &var25) != JS_TRUE) {
-        goto do_return;
-    }
-    argv[argc+0] = var25;
-    if (rval) {
-        *rval = var25;
-    }
-    var19 = JS_TRUE;
-    do_return:
-    return var19;
-}
-static JSBool
-jjeditor__construct__(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval)
-{
-    JSObject * var27;
-    int var31;
-    JSBool var26;
-    var27 = NULL;
-    var31 = 0;
-    var26 = JS_FALSE;
-    var27 = obj;
-    var31 = argc;
-    jsEditor();
-    var26 = JS_TRUE;
-    return var26;
-}
-static JSPropertySpec jj_static_ps[] = {
-    {NULL, 0, 0, NULL, NULL}
-};
-static JSPropertySpec jj_ps[] = {
-    {NULL, 0, 0, NULL, NULL}
-};
-static JSFunctionSpec jj_static_fs[] = {
-    JS_FS_END
-};
-static JSFunctionSpec jj_fs[] = {
-    JS_FS_END
-};
-static JSPropertySpec jjeditor_static_ps[] = {
-    {NULL, 0, 0, NULL, NULL}
-};
-static JSPropertySpec jjeditor_ps[] = {
-    {NULL, 0, 0, NULL, NULL}
-};
-static JSFunctionSpec jjeditor_static_fs[] = {
-    JS_FS("printTiming", jjeditorprintTiming, 1, 0, 1),
-    JS_FS("dumpSegment", jjeditordumpSegment, 0, 0, 1),
-    JS_FS("dumpRefVideo", jjeditordumpRefVideo, 0, 0, 1),
-    JS_FS_END
-};
-static JSFunctionSpec jjeditor_fs[] = {
-    JS_FS_END
-};
-static JSClass jjeditor_class = {
-    "editor",
-    0,
-    JS_PropertyStub,
-    JS_PropertyStub,
-    JS_PropertyStub,
-    JS_PropertyStub,
-    JS_EnumerateStub,
-    JS_ResolveStub,
-    JS_ConvertStub,
-    JS_FinalizeStub,
-    NULL,
-    NULL,
-    NULL,
-    jjeditor__construct__,
-    NULL,
-    NULL,
-    NULL,
-    NULL
-};
-static JSObject *
-jjeditor_init(JSContext *cx, JSObject *obj)
-{
-    JSObject *parent_proto, *proto;
-    JSClass *class;
-    if (!cx || !obj) {
-        JS_ReportError(cx, "invalid parameter");
-        return NULL;
-    }
-    if (!JS_EnterLocalRootScope(cx)) {
-        JS_ReportError(cx, "JS_EnterLocalRootScope failed");
-        return NULL;
-    }
-    parent_proto = NULL;
-    proto = NULL;
-    parent_proto = JS_NewObject(cx, NULL, NULL, NULL);
-    if (!parent_proto) {
-        JS_LeaveLocalRootScope(cx);
-        JS_ReportError(cx, "failed to create prototype");
-        return NULL;
-    }
-    class = &jjeditor_class;
-    proto = JS_InitClass(cx, obj, parent_proto, class, jjeditor__construct__, 0, jjeditor_ps, jjeditor_fs, jjeditor_static_ps, jjeditor_static_fs);
-    if (!proto) {
-        JS_LeaveLocalRootScope(cx);
-        JS_ReportError(cx, "failed to init class");
-        return NULL;
-    }
-    JS_LeaveLocalRootScope(cx);
-    return proto;
-}
-
-
-JSObject *jsEditorInit(JSContext *cx,JSObject *obj)
-{
-          if (JS_DefineFunctions(cx, obj, jj_static_fs) != JS_TRUE) 
-          {
-                return NULL;
-          }
-          return jjeditor_init(cx,obj);
-}
-
-JSFunctionSpec  *jsGetEditFunctions(void)
-{
-        return jjeditor_static_fs;
-}
-
-

Deleted: branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src/ADM_jsEditor_js.idl
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src/ADM_jsEditor_js.idl	2010-05-20 15:22:49 UTC (rev 6206)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src/ADM_jsEditor_js.idl	2010-05-20 15:22:52 UTC (rev 6207)
@@ -1,37 +0,0 @@
-%{
-#include "stdio.h"
-#include "ADM_jsEditor.h"
-void jsEditor(void)
-{
-        printf("Constructor invoked\n");
-}
-%}
-        /*            JSFUNC      C FUNC  PARAM     */
-class editor
-{
-        /*            JSFUNC                 C FUNC           PARAM     */
-        function int printTiming     : jsPrintTiming(int ) <static>;
-        function int dumpSegment     : jsDumpSegments()    <static>;
-        function int dumpRefVideo    : jsDumpRefVideos()   <static>;
-        /*            JSFUNC                 C FUNC           PARAM     */
-        
-        construct                          : jsEditor  ( ) <static>     ; 
-};
-
-%<
-
-JSObject *jsEditorInit(JSContext *cx,JSObject *obj)
-{
-          if (JS_DefineFunctions(cx, obj, jj_static_fs) != JS_TRUE) 
-          {
-                return NULL;
-          }
-          return jjeditor_init(cx,obj);
-}
-
-JSFunctionSpec  *jsGetEditFunctions(void)
-{
-        return jjeditor_static_fs;
-}
-
-%>

Deleted: branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src/ADM_jsIf.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src/ADM_jsIf.cpp	2010-05-20 15:22:49 UTC (rev 6206)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src/ADM_jsIf.cpp	2010-05-20 15:22:52 UTC (rev 6207)
@@ -1,350 +0,0 @@
-/**
-    \file ADM_JSif.cpp
-    \brief interface to js
-*/
-
-/***************************************************************************
- *                                                                         *
- *   This program is free software; you can redistribute it and/or modify  *
- *   it under the terms of the GNU General Public License as published by  *
- *   the Free Software Foundation; either version 2 of the License, or     *
- *   (at your option) any later version.                                   *
- *                                                                         *
- ***************************************************************************/
-
-#include "ADM_js.h"
-#include <stdarg.h>
-#include <vector>
-#include "ADM_editor/ADM_edit.hxx"
-void    A_Resync(void);
-
-/* our variables */
-static jsLoggerFunc *jsLogger=NULL;
-static void *jsLoggerCookie=NULL;
-vector <ADM_JS_HOOK >jsHooks;
-extern ADM_Composer *video_body;
-extern bool ADM_JSDialogFactoryInit(JSContext *cx, JSObject *obj);
-#define JSVAR(a,b,c) a b=c
-
-#if defined( __MINGW32__) 
- pthread_t g_pThreadSpidermonkey ;
-#else
-JSVAR( pthread_t, g_pThreadSpidermonkey , 0);
-#endif
-JSVAR( pthread_mutex_t, g_pSpiderMonkeyMutex , PTHREAD_MUTEX_INITIALIZER);
-// expose our main javascript context to the entire program
-static bool g_bJSSuccess=false;
-static JSObject   *g_pObject=NULL;
-static JSContext  *g_pCx=NULL;
-static JSRuntime  *g_pRt=NULL;
-
-static JSClass global_class = {
-            "global", JSCLASS_GLOBAL_FLAGS,
-            JS_PropertyStub, JS_PropertyStub, JS_PropertyStub, JS_PropertyStub,
-            JS_EnumerateStub, JS_ResolveStub, JS_ConvertStub, JS_FinalizeStub,
-            JSCLASS_NO_OPTIONAL_MEMBERS
-            };
-
-extern void  printJSError(JSContext *cx, const char *message, JSErrorReport *report);
-/**
-    \fn parseECMAScript
-    \brief Compile & execute ecma script
-*/
-bool parseECMAScript(const char *name)
-{// begin parseECMAScript
-	jsval rval;
-	uintN lineno = 0;
-	g_bJSSuccess = 0;
-	ADM_info("Spidermonkey compiling \"%s\"...",name);
-	JSScript *pJSScript = JS_CompileFile(g_pCx, g_pObject, name);
-	ADM_info("Done.\n");
-	if(pJSScript != NULL)
-	{// begin execute external file
-		printf("Spidermonkey executing \"%s\"...\n",name);
-		JSBool ok = JS_ExecuteScript(g_pCx, g_pObject, pJSScript, &rval);
-		JS_DestroyScript(g_pCx,pJSScript);
-		ADM_info("Done.\n");
-	}// end execute external file
-        // Run garbage collector now, it is safe
-    JS_GC(g_pCx);
-	A_Resync();
-	return g_bJSSuccess;
-}// end parseECMAScript
-/**
-    \fn jsLogger
-*/
-bool isJsLogRedirected(void)
-{
-    if(jsLogger) return true;
-    return false;
-}
-/**
-    \fn jsEvaluate
-*/
-static bool jsEvaluate(const char *str)
-{
-jsval rval;
-   JS_EvaluateScript(g_pCx,g_pObject,str,strlen(str),"dummy",1,&rval);
-   return true; 
-}
-/**
-    \fn    interactiveECMAScript
-    \brief interprete & execute ecma script (interactive)
-*/
-bool interactiveECMAScript(const char *name)
-{
-    ADM_startShell(jsEvaluate);
-    JS_GC(g_pCx);
-	A_Resync();
-    ADM_info("Ending JS shell...\n");
-	return true;
-}
-/**
-    \fn jsLog
-*/
-bool jsLog(JS_LOG_TYPE type, const char *prf,...)
-{
- static char print_buffer[1024];
-  	
-		va_list 	list;
-		va_start(list,	prf);
-		vsnprintf(print_buffer,1023,prf,list);
-		va_end(list);
-		print_buffer[1023]=0; // ensure the string is terminated
-        if(true==isJsLogRedirected())
-            jsLogger(jsLoggerCookie,type,print_buffer);
-        else
-        {
-            if(type==JS_LOG_ERROR)
-                GUI_Error_HIG("Spidermonkey ECMAScript Error","%s",print_buffer);
-            else
-                ADM_warning("[JS]%s\n",print_buffer);
-        }
-
-        return true;
-}
-
-/**
-    \fn ADM_jsRegisterLogger
-*/
-bool ADM_jsRegisterLogger(void *cookie,jsLoggerFunc *fun)
-{
-    jsLoggerCookie=cookie;
-    jsLogger=fun;
-    return true;
-}
-/**
-    \fn ADM_jsUnregisterLogger
-*/
-bool ADM_jsUnregisterLogger(void)
-{
-    jsLogger=NULL;
-    return true;
-}
-/**
-    \fn jsRegisterAvidemux
-*/
-extern "C" JSFunctionSpec  *jsGetIfFunctions(void);
-extern "C" JSFunctionSpec  *jsGetTestFunctions(void);
-extern "C" JSFunctionSpec  *jsGetAdmFunctions(void);
-extern "C" JSFunctionSpec  *jsGetEditFunctions(void);
-extern "C" JSFunctionSpec  *jsGetDialogFactoryFunctions(void);
-extern "C" JSObject *jsEditorInit(JSContext *cx,JSObject *obj);
-extern "C" JSObject *jsAvidemuxInit(JSContext *cx,JSObject *obj);
-static bool registerOne(const char *name,const char *text,JSFunctionSpec *s,JSContext *cx,JSObject *obj)
-{
-    if (JS_DefineFunctions(cx, obj, s) != JS_TRUE) 
-    {
-            ADM_error("Cannot register %s functions\n",name);
-            return false;
-    }
-    ADM_info("Registered %s functions\n",name);
-    ADM_JS_HOOK h;
-    h.name=name;    
-    h.text=text;
-    h.jsFunctions=s;
-    jsHooks.push_back(h);
-    return true;
-}
-static void  dump(JSFunctionSpec *f)
-{
-    while(f->name)
-    {
-        jsLog(JS_LOG_NORMAL,"    %s",f->name);
-        f++;
-    }
-}
-/**
-    \fn jsHelp
-    \brief help command
-
-*/
-extern "C" 
-{
-void jsHelp(const char *s)
-{
-int n=jsHooks.size();
-    if(!s) goto none;
-    {
-    for(int i=0;i<n;i++)
-        if(!strcasecmp(s,jsHooks[i].name))
-        {
-            const char *t=jsHooks[i].text;
-            if(t)
-                jsLog(JS_LOG_NORMAL,"%s",t);
-            return dump(jsHooks[i].jsFunctions);
-        }
-    }
-//    if(!strcasecmp(s,"load")) return dump(jsGetAvidemuxFunctions());
-none:
-        jsLog(JS_LOG_NORMAL,"please use help(\"xxx\") with xx among");
-
-        for(int i=0;i<n;i++)
-            jsLog(JS_LOG_NORMAL,"    %s",jsHooks[i].name);
-
-}
-} // extern "C"
-/**
-    \fn jsRegisterAvidemux
-    \brief Register avidemux hookd
-*/
-static bool jsRegisterAvidemux(JSContext *cx,JSObject *obj)
-{
-ADM_JS_HOOK h;
-        registerOne("Debug","",   jsGetIfFunctions(),    cx,obj);
-        registerOne("Test","", jsGetTestFunctions(),  cx,obj);
-        
-        // Register also our class (for  help() )
-            h.name="adm";
-            h.text="Please prefix this with adm.";
-            h.jsFunctions=jsGetAdmFunctions();
-            jsHooks.push_back(h);
-            jsAvidemuxInit(cx,obj);
-        // Register also edit
-            h.name="editor";
-            h.text="Please prefix this with editor.";
-            h.jsFunctions=jsGetEditFunctions();
-            jsEditorInit(cx,obj);
-            jsHooks.push_back(h);
-        // Register dialogFactory functions
-#if 0
-            h.name="dialog";
-            h.text=".";
-            h.jsFunctions=jsGetDialogFactoryFunctions();
-            jsHooks.push_back(h);
-#endif
-            return ADM_JSDialogFactoryInit(cx,obj);
-}
-/**
-    \fn SpidermonkeyInit
-*/
-bool SpidermonkeyInit()
-{// begin SpidermonkeyInit
-	// setup JS
-	g_pCx = NULL;
-	g_pObject = NULL;
-	g_pRt = NULL;
-	JSRuntime *rt = JS_NewRuntime(1000000L);
-	g_pRt = rt;
-	if ( !rt  )
-	{
-		// Do some error reporting
-		ADM_error("Spidermonkey failed to initialize runtime!\n");
-        return false;
-	}
-	
-// begin runtime created
-    g_pCx = JS_NewContext(rt, 8192);
-    if ( !g_pCx  )
-    {
-        // Do some error reporting
-        ADM_error("Spidermonkey failed to initialize context!\n");
-        return false;
-    }
-   
-   // begin context created
-    g_pObject = JS_NewObject(g_pCx, &global_class, 0, 0);
-    if(!g_pObject)
-    {
-        ADM_error("Cannot initialize object\n");
-        return false;
-    }
-    if(JS_TRUE!=JS_InitStandardClasses(g_pCx, g_pObject))
-    {
-        ADM_error("Cannot initialize standard classes\n");
-        return false;
-    }
-    // register error handler
-    JS_SetErrorReporter(g_pCx, printJSError);
-        
-    //register our functions
-    jsRegisterAvidemux(g_pCx,g_pObject);
-    ADM_info("Spidermonkey initialized\n");
-    return true;
-
-}// end SpidermonkeyInit
-/**
-    \fn SpidermonkeyDestroy
-*/
-void SpidermonkeyDestroy()
-{// begin SpidermonkeyDestroy
-#ifdef ADM_JS_THREADSAFE
-	JS_SetContextThread(g_pCx);	
-#endif
-	JS_DestroyContext(g_pCx);
-	JS_DestroyRuntime(g_pRt);
-}// end SpidermonkeyDestroy
-/**
-    \fn StartThreadSpidermonkey
-*/
-void *StartThreadSpidermonkey(void *pData)
-{// begin StartThreadSpidermonkey
-        pthread_mutex_lock(&g_pSpiderMonkeyMutex);
-        /*
-        The following mailling list post describes how to CORRECTLY use
-        the threading API support with Spidermonkey
-        "Thread from SpiderMonkey newsgroup"
-        http://archive.gingerall.cz/archives/public/sablot2004/msg00117.html
-        */
-        // Notify the Spidermonkey that we'll be processing in a thread
-#ifdef ADM_JS_THREADSAFE
-        JS_SetContextThread(g_pCx);
-        JS_BeginRequest(g_pCx);
-#endif
-        bool ret = false;
-        const char *pScriptFile = static_cast<const char *>(pData);
-        ret = parseECMAScript(pScriptFile);
-        if(ret == true)
-        {
-                video_body->setProjectName(pScriptFile);
-        }
-        // Notify Spidermonkey that our thread processing has finished
-#ifdef ADM_JS_THREADSAFE
-        JS_EndRequest(g_pCx);
-        JS_ClearContextThread(g_pCx);
-#endif
-        pthread_mutex_unlock(&g_pSpiderMonkeyMutex);
-
-        return NULL;
-}// end StartThreadSpidermonkey
-/**
-    \fn JS_setSuccess
-*/
-extern "C" void jsSetSuccess(int bSuccess)
-{// begin JS_setSuccess
-	g_bJSSuccess = bSuccess;
-	jsLog(JS_LOG_NORMAL,"[ECMA] success : %d\n", g_bJSSuccess);
-}// end JS_setSuccess
-/**
-    \fn SpidermonkeyExit
-*/
-bool SpidermonkeyExit(void)
-{
-    ADM_info("Waiting for Spidermonkey to finish...\n");
-    pthread_mutex_lock(&g_pSpiderMonkeyMutex);
-    ADM_info("Cleaning up Spidermonkey.\n");
-    SpidermonkeyDestroy();
-    pthread_mutex_unlock(&g_pSpiderMonkeyMutex);
-    return true;
-}
-//EOF

Deleted: branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src/ADM_jsIf_js.c
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src/ADM_jsIf_js.c	2010-05-20 15:22:49 UTC (rev 6206)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src/ADM_jsIf_js.c	2010-05-20 15:22:52 UTC (rev 6207)
@@ -1,504 +0,0 @@
-/*
---- DO NOT EDIT THIS FILE !!! ---
-
-This file has been generated automatically with 'jsapigen'.
-
-jsapigen is a glue-code generator for SpiderMonkey. It is distributed
-under the conditions of version 3 of the GNU General Public License.
-Please have a look at http://jsapigen.sourceforge.net.
-
-This file is NOT part of jsapigen and is NOT necessarily covered by
-jsapigen's license. For licensing information regarding this file,
-please refer to the software package which it is part of.
-
-*/
-
-#include "stdio.h"
-#include "ADM_jsAvidemux.h"
-#include "ADM_jsDebug.h"
-
-#ifdef HAVE_ALLOCA_H
-#include <alloca.h>
-static size_t jj_alloca_limit = 0;
-#endif
-#include <stdlib.h>
-#include <string.h>
-#include <wchar.h>
-#ifdef HAVE_ALLOCA_H
-#endif
-#include <jsapi.h>
-#ifndef JS_THREADSAFE
-#if JS_VERSION <= 170
-#define jsrefcount int
-#define JS_BeginRequest(cx)
-#define JS_EndRequest(cx)
-#define JS_SuspendRequest(cx)
-#define JS_ResumeRequest(cx, saveDepth)
-#endif
-#endif
-#ifndef JS_FS
-#define JS_FS(name, call, nargs, flags, extra) {name, call, nargs, flags, extra}
-#endif
-#ifndef JS_FS_END
-#define JS_FS_END {NULL, NULL, 0, 0, 0}
-#endif
-
-static JSBool
-jjadmPopupError(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval)
-{
-    JSObject * var2;
-    int var6;
-    char * var7;
-    int var8;
-    jsval var9;
-    JSString * var10;
-    jsval var86;
-    size_t var11;
-    size_t var12;
-    int var14;
-    jschar * var15;
-    jsval var87;
-    JSBool var1;
-    var2 = NULL;
-    var6 = 0;
-    var7 = NULL;
-    var8 = 0;
-    var9 = JSVAL_NULL;
-    var10 = NULL;
-    var86 = JSVAL_NULL;
-    var11 = 0;
-    var12 = 0;
-    var14 = 0;
-    var15 = NULL;
-    var87 = JSVAL_NULL;
-    var1 = JS_FALSE;
-    var2 = obj;
-    var6 = argc;
-    var8 = 0;
-    var8 = var8 < var6;
-    if (var8) {
-    var9 = argv[0];
-    var10 = JS_ValueToString(cx, var9);
-    if (!var10) {
-        goto do_return;
-    }
-    var86 = STRING_TO_JSVAL(var10);
-    argv[argc+0] = var86;
-    var11 = JS_GetStringLength(var10);
-    var12 = 1;
-    var12 += var11;
-#ifdef HAVE_ALLOCA
-    if (var12 < jj_alloca_limit) {
-        var7 = alloca(var12);
-    } else {
-#endif
-        var7 = malloc(var12);
-        if (!var7) {
-            goto do_return;
-        } else {
-            var14 = 1;
-        }
-#ifdef HAVE_ALLOCA
-    }
-#endif
-    var15 = JS_GetStringChars(var10);
-    var87 = STRING_TO_JSVAL(var10);
-    argv[argc+1] = var87;
-    {
-        size_t i;
-        for (i = 0; i < var11; ++i) {
-            var7[i] = var15[i];
-        }
-        var7[var11] = '\0';
-    }
-    }
-    jsPopupError(var7);
-    var1 = JS_TRUE;
-    do_return:
-    if (var14) {
-        free(var7);
-        var7 = NULL;
-        var14 = 0;
-    }
-    return var1;
-}
-static JSBool
-jjadmpPopupInfo(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval)
-{
-    JSObject * var17;
-    int var21;
-    char * var22;
-    int var23;
-    jsval var24;
-    JSString * var25;
-    jsval var88;
-    size_t var26;
-    size_t var27;
-    int var29;
-    jschar * var30;
-    jsval var89;
-    JSBool var16;
-    var17 = NULL;
-    var21 = 0;
-    var22 = NULL;
-    var23 = 0;
-    var24 = JSVAL_NULL;
-    var25 = NULL;
-    var88 = JSVAL_NULL;
-    var26 = 0;
-    var27 = 0;
-    var29 = 0;
-    var30 = NULL;
-    var89 = JSVAL_NULL;
-    var16 = JS_FALSE;
-    var17 = obj;
-    var21 = argc;
-    var23 = 0;
-    var23 = var23 < var21;
-    if (var23) {
-    var24 = argv[0];
-    var25 = JS_ValueToString(cx, var24);
-    if (!var25) {
-        goto do_return;
-    }
-    var88 = STRING_TO_JSVAL(var25);
-    argv[argc+0] = var88;
-    var26 = JS_GetStringLength(var25);
-    var27 = 1;
-    var27 += var26;
-#ifdef HAVE_ALLOCA
-    if (var27 < jj_alloca_limit) {
-        var22 = alloca(var27);
-    } else {
-#endif
-        var22 = malloc(var27);
-        if (!var22) {
-            goto do_return;
-        } else {
-            var29 = 1;
-        }
-#ifdef HAVE_ALLOCA
-    }
-#endif
-    var30 = JS_GetStringChars(var25);
-    var89 = STRING_TO_JSVAL(var25);
-    argv[argc+1] = var89;
-    {
-        size_t i;
-        for (i = 0; i < var26; ++i) {
-            var22[i] = var30[i];
-        }
-        var22[var26] = '\0';
-    }
-    }
-    jsPopupInfo(var22);
-    var16 = JS_TRUE;
-    do_return:
-    if (var29) {
-        free(var22);
-        var22 = NULL;
-        var29 = 0;
-    }
-    return var16;
-}
-static JSBool
-jjadmPrint(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval)
-{
-    JSObject * var32;
-    int var36;
-    char * var37;
-    int var38;
-    jsval var39;
-    JSString * var40;
-    jsval var90;
-    size_t var41;
-    size_t var42;
-    int var44;
-    jschar * var45;
-    jsval var91;
-    JSBool var31;
-    var32 = NULL;
-    var36 = 0;
-    var37 = NULL;
-    var38 = 0;
-    var39 = JSVAL_NULL;
-    var40 = NULL;
-    var90 = JSVAL_NULL;
-    var41 = 0;
-    var42 = 0;
-    var44 = 0;
-    var45 = NULL;
-    var91 = JSVAL_NULL;
-    var31 = JS_FALSE;
-    var32 = obj;
-    var36 = argc;
-    var38 = 0;
-    var38 = var38 < var36;
-    if (var38) {
-    var39 = argv[0];
-    var40 = JS_ValueToString(cx, var39);
-    if (!var40) {
-        goto do_return;
-    }
-    var90 = STRING_TO_JSVAL(var40);
-    argv[argc+0] = var90;
-    var41 = JS_GetStringLength(var40);
-    var42 = 1;
-    var42 += var41;
-#ifdef HAVE_ALLOCA
-    if (var42 < jj_alloca_limit) {
-        var37 = alloca(var42);
-    } else {
-#endif
-        var37 = malloc(var42);
-        if (!var37) {
-            goto do_return;
-        } else {
-            var44 = 1;
-        }
-#ifdef HAVE_ALLOCA
-    }
-#endif
-    var45 = JS_GetStringChars(var40);
-    var91 = STRING_TO_JSVAL(var40);
-    argv[argc+1] = var91;
-    {
-        size_t i;
-        for (i = 0; i < var41; ++i) {
-            var37[i] = var45[i];
-        }
-        var37[var41] = '\0';
-    }
-    }
-    jsPrint(var37);
-    var31 = JS_TRUE;
-    do_return:
-    if (var44) {
-        free(var37);
-        var37 = NULL;
-        var44 = 0;
-    }
-    return var31;
-}
-static JSBool
-jjprint(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval)
-{
-    JSObject * var47;
-    int var51;
-    char * var52;
-    int var53;
-    jsval var54;
-    JSString * var55;
-    jsval var92;
-    size_t var56;
-    size_t var57;
-    int var59;
-    jschar * var60;
-    jsval var93;
-    JSBool var46;
-    var47 = NULL;
-    var51 = 0;
-    var52 = NULL;
-    var53 = 0;
-    var54 = JSVAL_NULL;
-    var55 = NULL;
-    var92 = JSVAL_NULL;
-    var56 = 0;
-    var57 = 0;
-    var59 = 0;
-    var60 = NULL;
-    var93 = JSVAL_NULL;
-    var46 = JS_FALSE;
-    var47 = obj;
-    var51 = argc;
-    var53 = 0;
-    var53 = var53 < var51;
-    if (var53) {
-    var54 = argv[0];
-    var55 = JS_ValueToString(cx, var54);
-    if (!var55) {
-        goto do_return;
-    }
-    var92 = STRING_TO_JSVAL(var55);
-    argv[argc+0] = var92;
-    var56 = JS_GetStringLength(var55);
-    var57 = 1;
-    var57 += var56;
-#ifdef HAVE_ALLOCA
-    if (var57 < jj_alloca_limit) {
-        var52 = alloca(var57);
-    } else {
-#endif
-        var52 = malloc(var57);
-        if (!var52) {
-            goto do_return;
-        } else {
-            var59 = 1;
-        }
-#ifdef HAVE_ALLOCA
-    }
-#endif
-    var60 = JS_GetStringChars(var55);
-    var93 = STRING_TO_JSVAL(var55);
-    argv[argc+1] = var93;
-    {
-        size_t i;
-        for (i = 0; i < var56; ++i) {
-            var52[i] = var60[i];
-        }
-        var52[var56] = '\0';
-    }
-    }
-    jsPrint2(var52);
-    var46 = JS_TRUE;
-    do_return:
-    if (var59) {
-        free(var52);
-        var52 = NULL;
-        var59 = 0;
-    }
-    return var46;
-}
-static JSBool
-jjhelp(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval)
-{
-    JSObject * var62;
-    int var66;
-    char * var67;
-    int var68;
-    jsval var69;
-    JSString * var70;
-    jsval var94;
-    size_t var71;
-    size_t var72;
-    int var74;
-    jschar * var75;
-    jsval var95;
-    JSBool var61;
-    var62 = NULL;
-    var66 = 0;
-    var67 = NULL;
-    var68 = 0;
-    var69 = JSVAL_NULL;
-    var70 = NULL;
-    var94 = JSVAL_NULL;
-    var71 = 0;
-    var72 = 0;
-    var74 = 0;
-    var75 = NULL;
-    var95 = JSVAL_NULL;
-    var61 = JS_FALSE;
-    var62 = obj;
-    var66 = argc;
-    var68 = 0;
-    var68 = var68 < var66;
-    if (var68) {
-    var69 = argv[0];
-    var70 = JS_ValueToString(cx, var69);
-    if (!var70) {
-        goto do_return;
-    }
-    var94 = STRING_TO_JSVAL(var70);
-    argv[argc+0] = var94;
-    var71 = JS_GetStringLength(var70);
-    var72 = 1;
-    var72 += var71;
-#ifdef HAVE_ALLOCA
-    if (var72 < jj_alloca_limit) {
-        var67 = alloca(var72);
-    } else {
-#endif
-        var67 = malloc(var72);
-        if (!var67) {
-            goto do_return;
-        } else {
-            var74 = 1;
-        }
-#ifdef HAVE_ALLOCA
-    }
-#endif
-    var75 = JS_GetStringChars(var70);
-    var95 = STRING_TO_JSVAL(var70);
-    argv[argc+1] = var95;
-    {
-        size_t i;
-        for (i = 0; i < var71; ++i) {
-            var67[i] = var75[i];
-        }
-        var67[var71] = '\0';
-    }
-    }
-    jsHelp(var67);
-    var61 = JS_TRUE;
-    do_return:
-    if (var74) {
-        free(var67);
-        var67 = NULL;
-        var74 = 0;
-    }
-    return var61;
-}
-static JSBool
-jjsetSuccess(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval)
-{
-    JSObject * var77;
-    int var81;
-    int var82;
-    int var83;
-    jsval var84;
-    int32 var85;
-    JSBool var76;
-    var77 = NULL;
-    var81 = 0;
-    var82 = 0;
-    var83 = 0;
-    var84 = JSVAL_NULL;
-    var85 = 0;
-    var76 = JS_FALSE;
-    var77 = obj;
-    var81 = argc;
-    var83 = 0;
-    var83 = var83 < var81;
-    if (var83) {
-    var84 = argv[0];
-    if (JS_ValueToInt32(cx, var84, &var85) != JS_TRUE) {
-        goto do_return;
-    }
-    var82 = (int)var85;
-    }
-    jsSetSuccess(var82);
-    var76 = JS_TRUE;
-    do_return:
-    return var76;
-}
-static JSPropertySpec jj_static_ps[] = {
-    {NULL, 0, 0, NULL, NULL}
-};
-static JSPropertySpec jj_ps[] = {
-    {NULL, 0, 0, NULL, NULL}
-};
-static JSFunctionSpec jj_static_fs[] = {
-    JS_FS("admPopupError", jjadmPopupError, 1, 0, 2),
-    JS_FS("admpPopupInfo", jjadmpPopupInfo, 1, 0, 2),
-    JS_FS("admPrint", jjadmPrint, 1, 0, 2),
-    JS_FS("print", jjprint, 1, 0, 2),
-    JS_FS("help", jjhelp, 1, 0, 2),
-    JS_FS("setSuccess", jjsetSuccess, 1, 0, 0),
-    JS_FS_END
-};
-static JSFunctionSpec jj_fs[] = {
-    JS_FS("admPopupError", jjadmPopupError, 1, 0, 2),
-    JS_FS("admpPopupInfo", jjadmpPopupInfo, 1, 0, 2),
-    JS_FS("admPrint", jjadmPrint, 1, 0, 2),
-    JS_FS("print", jjprint, 1, 0, 2),
-    JS_FS("help", jjhelp, 1, 0, 2),
-    JS_FS("setSuccess", jjsetSuccess, 1, 0, 0),
-    JS_FS_END
-};
-
-JSFunctionSpec  *jsGetIfFunctions(void)
-{
-        return jj_static_fs;
-}
-
-

Deleted: branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src/ADM_jsIf_js.idl
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src/ADM_jsIf_js.idl	2010-05-20 15:22:49 UTC (rev 6206)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src/ADM_jsIf_js.idl	2010-05-20 15:22:52 UTC (rev 6207)
@@ -1,25 +0,0 @@
-%{
-#include "stdio.h"
-#include "ADM_jsAvidemux.h"
-#include "ADM_jsDebug.h"
-%}
-
-/*
-###############################################################
-       return JS function     CM Function  params
-###############################################################
-*/
-function void admPopupError : jsPopupError   (cstring  ) <static>;
-function void admpPopupInfo : jsPopupInfo    (cstring  ) <static>;
-function void admPrint      : jsPrint        (cstring  ) <static>;
-function void print         : jsPrint2       (cstring  ) <static>;
-function void help          : jsHelp         (cstring  ) <static>;
-function void setSuccess    : jsSetSuccess   (int  )   <static>;
-
-%<
-JSFunctionSpec  *jsGetIfFunctions(void)
-{
-        return jj_static_fs;
-}
-
-%>

Deleted: branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src/ADM_jsTestFactory.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src/ADM_jsTestFactory.cpp	2010-05-20 15:22:49 UTC (rev 6206)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src/ADM_jsTestFactory.cpp	2010-05-20 15:22:52 UTC (rev 6207)
@@ -1,444 +0,0 @@
-/**
-    \file ADM_JSif.cpp
-    \brief interface to js
-
- Author: Anish Mistry/mean/gruntster
-*/
-
-/***************************************************************************
- *                                                                         *
- *   This program is free software; you can redistribute it and/or modify  *
- *   it under the terms of the GNU General Public License as published by  *
- *   the Free Software Foundation; either version 2 of the License, or     *
- *   (at your option) any later version.                                   *
- *                                                                         *
- ***************************************************************************/
-#include "ADM_js.h"
-#include "ADM_editor/ADM_edit.hxx"
-#include "DIA_fileSel.h"
-#include "DIA_factory.h"
-#include "ADM_jsTestFactory.h"
-#include "DIA_encoding.h"
-
-/**
-    \fn crashTest
-    \brief Force a crash
-*/
-int jsTestCrash(void)
-{
-  
-  int *foobar=NULL;
-  *foobar=0; // CRASH!
-  return true;
-}
-/**
-    \fn assertTest
-    \brief Force a crash
-*/
-int jsTestAssert(void)
-{
-  
-  ADM_assert(0);
-  return true;
-}
-
-
-/**
-    \fn jsTestFacInt
-*/
-int jsTestFacInt(void)
-{
-  uint32_t tog=0;
-   diaElemUInteger blend(&tog,QT_TR_NOOP("Uinteger"),0,255);
-    diaElem *elems[]={&blend   };
-    
-  if(diaFactoryRun(QT_TR_NOOP("Test uinteger"),1,elems))
-  {
-    jsLog(JS_LOG_NORMAL,"Value : %u\n",tog);
-    return true;
-  }
-  return false;
-}
-
-/**
-    \fn jsTestFacFloat
-*/
-int jsTestFacFloat(void)
-{
-  ELEM_TYPE_FLOAT tog=0;
-   diaElemFloat blend(&tog,QT_TR_NOOP("Float"),0,255);
-    diaElem *elems[]={&blend   };
-    
-  if(diaFactoryRun("Test float",1,elems))
-  {
-    jsLog(JS_LOG_NORMAL,"Value : %f\n",(float)tog);
-    return true;
-  }
-  return false;
-}
-
-/**
-    \fn jsTestFacToggle
-*/
-int jsTestFacToggle(void)
-{
-  uint32_t tog=0;
-  uint32_t test=0;
-   diaElemToggle blend(&tog,QT_TR_NOOP("Toggle"));
-    diaElemUInteger     bt(&test,"Entry",0,10);
-    diaElemUInteger     bt2(&test,"Entry",0,10);
-    diaElem *elems[]={&blend,&bt,&bt2   };
-    blend.link(1,&bt);
-    blend.link(0,&bt2);
-    
-  if(diaFactoryRun("Test Toggle",3,elems))
-   {
-    jsLog(JS_LOG_NORMAL,"Value : %u\n",tog);
-    return true;
-  }
-  return false;
-}
-
-/**
-    \fn jsTestFacMenu
-*/
-int jsTestFacMenu(void)
-{
-   uint32_t tog=4;
-   ELEM_TYPE_FLOAT f=1; 
-   
-    diaMenuEntry menu[]={
-                             {2,   QT_TR_NOOP("No Strategy"),NULL},
-                             {4,     QT_TR_NOOP("3:2 Pulldown"),NULL},
-                             {6,     QT_TR_NOOP("Pal/Secam"),NULL},
-                             {7,  QT_TR_NOOP("NTSC converted from PAL"),NULL}
-                          };
-   diaElemMenu blend(&tog,QT_TR_NOOP("menu"),4,menu);
-    
-    // Link it to another
-    diaElemFloat toggle(&f,"Linked float",1,2);
-    blend.link(&(menu[1]),1,&toggle);
-    //
-diaElem *elems[]={&blend,&toggle   };
-  if(diaFactoryRun("Test Menu",2,elems))
-   {
-    jsLog(JS_LOG_NORMAL,"Value : %"LU"\n",tog);
-    return true;
-  }
-  return false;
-}
-
-/**
-    \fn jsTestFacFile
-*/
-int jsTestFacFile(void)
-{
-   uint32_t tog=0;
-   char *test=ADM_strdup("Entry test1");
-    
-      diaElemFile fread(0,&test,"Entry");
-      diaElem *elems[]={&fread   };
-  if(diaFactoryRun("Test FileRead",1,elems))
-   {
-    jsLog(JS_LOG_NORMAL,"Value : %s\n",test);
-    if(test) ADM_dealloc(test);
-    return true;
-  }
- if(test) ADM_dealloc(test);
-  return false;
-}
-
-/**
-    \fn jsTestFacDirSel
-*/
-int jsTestFacDirSel(void)
-{
-   uint32_t tog=0;
-   char *test=ADM_strdup("Entry test1");
-    
-  diaElemDirSelect fread(&test,"Entry");
-  diaElem *elems[]={&fread   };
-  if(diaFactoryRun("Test DirSel",1,elems))
-  {
-    jsLog(JS_LOG_NORMAL,"Value : %s\n",test);
-    if(test) ADM_dealloc(test);
-    return true;
-  }
- if(test) ADM_dealloc(test);
-  return false;
-}
-
-/**
-    \fn jsTestFacBitrate
-*/
-int jsTestFacBitrate(void)
-{
-
-   COMPRES_PARAMS test={
-  COMPRESS_CQ,
-  1,
-  1500,
-  700,
-  1000,
-  ADM_ENC_CAP_CQ+ADM_ENC_CAP_2PASS+ADM_ENC_CAP_CBR+ADM_ENC_CAP_SAME
-  };
-    
-      diaElemBitrate bt(&test,"Entry");
-      diaElem *elems[]={&bt   };
-  if(diaFactoryRun("Test BitRate",1,elems))
-   {
-    
-    return true;
-  }
-  return false;
-}
-
-/**
-    \fn jsTestFacInt
-*/
-int jsTestFacBar(void)
-{
-    
-      diaElemBar bar1(25,"25");
-      diaElemBar bar2(65,"65");
-      diaElem *elems[]={&bar1,&bar2   };
-  if(diaFactoryRun("Test FileRead",2,elems))
-  {
-   return true;
-  }
-  return false;
-}
-
-void clickMe(void *cookie)
-{
-  GUI_Error_HIG("Button","Button pressed!"); 
-}
-
-/**
-    \fn jsTestFacButton
-*/
-int jsTestFacButton(void)
-{
-    
-      diaElemButton bar1("Button",clickMe,NULL);
-      diaElem *elems[]={&bar1   };
-  if(diaFactoryRun("Test Button",1,elems))
-  {
-    return true;
-  }
-  return false;
-}
-
-/**
-    \fn jsTestFacSlider
-*/
-int jsTestFacSlider(void)
-{
-  int32_t val=4;
-      diaElemSlider slide(&val,"foo", 0,10);
-      
-      diaElem *elems[]={&slide   };
-  if(diaFactoryRun("Test Slider",1,elems))
-  {
-    jsLog(JS_LOG_NORMAL,"Value : %d\n",(int)val);
-    return true;
-  }
-  return false;
-}
-
-/**
-    \fn jsTestFacInt
-*/
-int jsTestFacRoText(void)
-
-{
-    
-      diaElemReadOnlyText txt("blah blah","Value:");
-      
-      diaElem *elems[]={&txt   };
-  if(diaFactoryRun("Test FileRead",1,elems))
-  {
-    return true;
-  }
-  return false;
-}
-
-/**
-    \fn jsTestFacText
-*/
-int jsTestFacText(void)
-{
-    
-      char *foo=ADM_strdup("blah");
-      diaElemText txt(&foo,"Text",NULL);
-      
-      diaElem *elems[]={&txt   };
-  if(diaFactoryRun("Test FileRead",1,elems))
- {
-    jsLog(JS_LOG_NORMAL,"Out:%s",foo);
-    if(foo) ADM_dealloc(foo);
-    return true;
-  }
-  if(foo) ADM_dealloc(foo);
-  return false;
-}
-
-/**
-    \fn jsTestFacInt
-*/
-int jsTestFacTab(void)
-{
-    
-      uint32_t test,test2;
-      
-      diaElemReadOnlyText txt("blah blah","Value:");
-      diaElemUInteger     bt(&test,"Entry",0,10);
-      diaElemUInteger     bt2(&test2,"Entry",0,10);
-      
-      
-      diaElem *elems1[]={&txt   };
-      diaElem *elems2[]={&bt,&bt2   };
-      
-      diaElemTabs tab1("T1",1,(diaElem **)elems1);
-      diaElemTabs tab2("T2",2,(diaElem **)elems2);
-      
-      diaElemTabs *tabs[2]={&tab1,&tab2};
-          
-      
-  if(diaFactoryRunTabs("Test FileRead",2,tabs))
- {
-    return true;
-  }
-  return false;
-}
-
-/**
-    \fn jsTestFacInt
-*/
-int jsTestFacFrame(void)
-{
-    
-      uint32_t test,test2;
-      
-      diaElemReadOnlyText align("*****","Value:");
-      diaElemReadOnlyText txt("blah blah","Value:");
-      diaElemUInteger     bt(&test,"Entry1",0,10);
-      diaElemUInteger     bt2(&test2,"Entry2",0,10);
-      diaElemFrame        frm("Frame1");
-      
-      frm.swallow(&txt);
-      frm.swallow(&bt);
-      frm.swallow(&bt2);
-      
-         diaElem *elems[]={&align,&frm   };
-  if(diaFactoryRun("Test frame",2,elems))
- {
-    return true;
-  }
-  return false;
-}
-
-
-/**
-    \fn jsTestFacHex
-*/
-int jsTestFacHex(void)
-{
-    
-      uint8_t data[100];
-      for(int i=0;i<100;i++) data[i]=i;
-      
-      diaElemHex binhex("*****",100,data);
-      
-      
-         diaElem *elems[]={&binhex   };
-  if(diaFactoryRun("Test binHex",1,elems))
-  {
-    return true;
-  }
-  return false;
-      
-}
-
-/**
-    \fn jsTestFacMatrix
-*/
-int jsTestFacMatrix(void)
-{
-    
-      uint8_t data[16];
-      for(int i=0;i<100;i++) data[i]=i;
-      
-      diaElemMatrix Matrix(data,"Matrix",4);
-      
-      
-         diaElem *elems[]={&Matrix   };
-  if(diaFactoryRun("Test Matrix",1,elems))
-  {
-      for(int x=0;x<4*4;x++)
-      {
-          if(x && !(x&3)) printf("\n");
-          jsLog(JS_LOG_NORMAL,"%02x ",data[x]);
-          
-      }
-      return true;
-  }
-  return false;
-}
-
-/**
-    \fn jsTestFacThreadcount
-*/
-int jsTestFacThreadCount(void)
-{
-	uint32_t val=1;
-	diaElemThreadCount threadcount(&val,"ThreadCount");
-      
-    diaElem *elems[]={&threadcount   };
-    
-  if(diaFactoryRun("Test ThreadCount",1,elems))
-  {
-         jsLog(JS_LOG_NORMAL,"Thread: %u ",(unsigned int)val);
-        return true;
-  }
-  return false;
-}
-
-/**
-    \fn jsTestFacNotch
-*/
-int jsTestFacNotch(void)
-{
-    
-	diaElemNotch notch(1,"Notch");
-      
-         diaElem *elems[]={&notch   };
-  if(diaFactoryRun("Test Notch",1,elems))
-  {
-    return true;
-  }
-  return false;
-      
-}
-/**
-    \fn jsTestFacEncoding
-*/
-int jsTestFacEncoding(void)
-{
-    DIA_encodingBase *base=createEncoding(1000*1000LL);
-    base->setContainer("the container");
-    base->setAudioCodec("the audio codec");
-    base->setVideoCodec("the video codec");
-    for(int i=0;i<20;i++)
-    {
-        base->refresh();
-        base->pushVideoFrame(10000,1,50*1000LL*i);
-        base->refresh();
-        printf("%d / %d\n",i,20);
-        ADM_usleep(500*1000);
-    }
-    delete base;
-    base=NULL;
-    return true;
-}
-//EOF 

Deleted: branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src/ADM_jsTestFactory_js.c
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src/ADM_jsTestFactory_js.c	2010-05-20 15:22:49 UTC (rev 6206)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src/ADM_jsTestFactory_js.c	2010-05-20 15:22:52 UTC (rev 6207)
@@ -1,649 +0,0 @@
-/*
---- DO NOT EDIT THIS FILE !!! ---
-
-This file has been generated automatically with 'jsapigen'.
-
-jsapigen is a glue-code generator for SpiderMonkey. It is distributed
-under the conditions of version 3 of the GNU General Public License.
-Please have a look at http://jsapigen.sourceforge.net.
-
-This file is NOT part of jsapigen and is NOT necessarily covered by
-jsapigen's license. For licensing information regarding this file,
-please refer to the software package which it is part of.
-
-*/
-
-#include "stdio.h"
-#include "ADM_jsAvidemux.h"
-#include "ADM_jsTestFactory.h"
-
-#ifdef HAVE_ALLOCA_H
-#include <alloca.h>
-static size_t jj_alloca_limit = 0;
-#endif
-#include <stdlib.h>
-#include <string.h>
-#include <wchar.h>
-#ifdef HAVE_ALLOCA_H
-#endif
-#include <jsapi.h>
-#ifndef JS_THREADSAFE
-#if JS_VERSION <= 170
-#define jsrefcount int
-#define JS_BeginRequest(cx)
-#define JS_EndRequest(cx)
-#define JS_SuspendRequest(cx)
-#define JS_ResumeRequest(cx, saveDepth)
-#endif
-#endif
-#ifndef JS_FS
-#define JS_FS(name, call, nargs, flags, extra) {name, call, nargs, flags, extra}
-#endif
-#ifndef JS_FS_END
-#define JS_FS_END {NULL, NULL, 0, 0, 0}
-#endif
-
-static JSBool
-jjadmTestFacInt(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval)
-{
-    JSObject * var2;
-    int var3;
-    int var6;
-    jsval var7;
-    JSBool var1;
-    var2 = NULL;
-    var3 = 0;
-    var6 = 0;
-    var7 = JSVAL_NULL;
-    var1 = JS_FALSE;
-    var2 = obj;
-    var6 = argc;
-    var3 = jsTestFacInt();
-    if (JS_NewNumberValue(cx, var3, &var7) != JS_TRUE) {
-        goto do_return;
-    }
-    argv[argc+0] = var7;
-    if (rval) {
-        *rval = var7;
-    }
-    var1 = JS_TRUE;
-    do_return:
-    return var1;
-}
-static JSBool
-jjadmTestFacFloat(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval)
-{
-    JSObject * var9;
-    int var10;
-    int var13;
-    jsval var14;
-    JSBool var8;
-    var9 = NULL;
-    var10 = 0;
-    var13 = 0;
-    var14 = JSVAL_NULL;
-    var8 = JS_FALSE;
-    var9 = obj;
-    var13 = argc;
-    var10 = jsTestFacFloat();
-    if (JS_NewNumberValue(cx, var10, &var14) != JS_TRUE) {
-        goto do_return;
-    }
-    argv[argc+0] = var14;
-    if (rval) {
-        *rval = var14;
-    }
-    var8 = JS_TRUE;
-    do_return:
-    return var8;
-}
-static JSBool
-jjadmTestFacToggle(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval)
-{
-    JSObject * var16;
-    int var17;
-    int var20;
-    jsval var21;
-    JSBool var15;
-    var16 = NULL;
-    var17 = 0;
-    var20 = 0;
-    var21 = JSVAL_NULL;
-    var15 = JS_FALSE;
-    var16 = obj;
-    var20 = argc;
-    var17 = jsTestFacToggle();
-    if (JS_NewNumberValue(cx, var17, &var21) != JS_TRUE) {
-        goto do_return;
-    }
-    argv[argc+0] = var21;
-    if (rval) {
-        *rval = var21;
-    }
-    var15 = JS_TRUE;
-    do_return:
-    return var15;
-}
-static JSBool
-jjadmTestFacMenu(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval)
-{
-    JSObject * var23;
-    int var24;
-    int var27;
-    jsval var28;
-    JSBool var22;
-    var23 = NULL;
-    var24 = 0;
-    var27 = 0;
-    var28 = JSVAL_NULL;
-    var22 = JS_FALSE;
-    var23 = obj;
-    var27 = argc;
-    var24 = jsTestFacMenu();
-    if (JS_NewNumberValue(cx, var24, &var28) != JS_TRUE) {
-        goto do_return;
-    }
-    argv[argc+0] = var28;
-    if (rval) {
-        *rval = var28;
-    }
-    var22 = JS_TRUE;
-    do_return:
-    return var22;
-}
-static JSBool
-jjadmTestFacFile(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval)
-{
-    JSObject * var30;
-    int var31;
-    int var34;
-    jsval var35;
-    JSBool var29;
-    var30 = NULL;
-    var31 = 0;
-    var34 = 0;
-    var35 = JSVAL_NULL;
-    var29 = JS_FALSE;
-    var30 = obj;
-    var34 = argc;
-    var31 = jsTestFacFile();
-    if (JS_NewNumberValue(cx, var31, &var35) != JS_TRUE) {
-        goto do_return;
-    }
-    argv[argc+0] = var35;
-    if (rval) {
-        *rval = var35;
-    }
-    var29 = JS_TRUE;
-    do_return:
-    return var29;
-}
-static JSBool
-jjadmTestFacBitrate(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval)
-{
-    JSObject * var37;
-    int var38;
-    int var41;
-    jsval var42;
-    JSBool var36;
-    var37 = NULL;
-    var38 = 0;
-    var41 = 0;
-    var42 = JSVAL_NULL;
-    var36 = JS_FALSE;
-    var37 = obj;
-    var41 = argc;
-    var38 = jsTestFacBitrate();
-    if (JS_NewNumberValue(cx, var38, &var42) != JS_TRUE) {
-        goto do_return;
-    }
-    argv[argc+0] = var42;
-    if (rval) {
-        *rval = var42;
-    }
-    var36 = JS_TRUE;
-    do_return:
-    return var36;
-}
-static JSBool
-jjadmTestFacBar(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval)
-{
-    JSObject * var44;
-    int var45;
-    int var48;
-    jsval var49;
-    JSBool var43;
-    var44 = NULL;
-    var45 = 0;
-    var48 = 0;
-    var49 = JSVAL_NULL;
-    var43 = JS_FALSE;
-    var44 = obj;
-    var48 = argc;
-    var45 = jsTestFacBar();
-    if (JS_NewNumberValue(cx, var45, &var49) != JS_TRUE) {
-        goto do_return;
-    }
-    argv[argc+0] = var49;
-    if (rval) {
-        *rval = var49;
-    }
-    var43 = JS_TRUE;
-    do_return:
-    return var43;
-}
-static JSBool
-jjadmTestFacRoText(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval)
-{
-    JSObject * var51;
-    int var52;
-    int var55;
-    jsval var56;
-    JSBool var50;
-    var51 = NULL;
-    var52 = 0;
-    var55 = 0;
-    var56 = JSVAL_NULL;
-    var50 = JS_FALSE;
-    var51 = obj;
-    var55 = argc;
-    var52 = jsTestFacRoText();
-    if (JS_NewNumberValue(cx, var52, &var56) != JS_TRUE) {
-        goto do_return;
-    }
-    argv[argc+0] = var56;
-    if (rval) {
-        *rval = var56;
-    }
-    var50 = JS_TRUE;
-    do_return:
-    return var50;
-}
-static JSBool
-jjadmTestFacText(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval)
-{
-    JSObject * var58;
-    int var59;
-    int var62;
-    jsval var63;
-    JSBool var57;
-    var58 = NULL;
-    var59 = 0;
-    var62 = 0;
-    var63 = JSVAL_NULL;
-    var57 = JS_FALSE;
-    var58 = obj;
-    var62 = argc;
-    var59 = jsTestFacText();
-    if (JS_NewNumberValue(cx, var59, &var63) != JS_TRUE) {
-        goto do_return;
-    }
-    argv[argc+0] = var63;
-    if (rval) {
-        *rval = var63;
-    }
-    var57 = JS_TRUE;
-    do_return:
-    return var57;
-}
-static JSBool
-jjadmTestFacTab(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval)
-{
-    JSObject * var65;
-    int var66;
-    int var69;
-    jsval var70;
-    JSBool var64;
-    var65 = NULL;
-    var66 = 0;
-    var69 = 0;
-    var70 = JSVAL_NULL;
-    var64 = JS_FALSE;
-    var65 = obj;
-    var69 = argc;
-    var66 = jsTestFacTab();
-    if (JS_NewNumberValue(cx, var66, &var70) != JS_TRUE) {
-        goto do_return;
-    }
-    argv[argc+0] = var70;
-    if (rval) {
-        *rval = var70;
-    }
-    var64 = JS_TRUE;
-    do_return:
-    return var64;
-}
-static JSBool
-jjadmTestFacFrame(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval)
-{
-    JSObject * var72;
-    int var73;
-    int var76;
-    jsval var77;
-    JSBool var71;
-    var72 = NULL;
-    var73 = 0;
-    var76 = 0;
-    var77 = JSVAL_NULL;
-    var71 = JS_FALSE;
-    var72 = obj;
-    var76 = argc;
-    var73 = jsTestFacFrame();
-    if (JS_NewNumberValue(cx, var73, &var77) != JS_TRUE) {
-        goto do_return;
-    }
-    argv[argc+0] = var77;
-    if (rval) {
-        *rval = var77;
-    }
-    var71 = JS_TRUE;
-    do_return:
-    return var71;
-}
-static JSBool
-jjadmTestFacHex(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval)
-{
-    JSObject * var79;
-    int var80;
-    int var83;
-    jsval var84;
-    JSBool var78;
-    var79 = NULL;
-    var80 = 0;
-    var83 = 0;
-    var84 = JSVAL_NULL;
-    var78 = JS_FALSE;
-    var79 = obj;
-    var83 = argc;
-    var80 = jsTestFacHex();
-    if (JS_NewNumberValue(cx, var80, &var84) != JS_TRUE) {
-        goto do_return;
-    }
-    argv[argc+0] = var84;
-    if (rval) {
-        *rval = var84;
-    }
-    var78 = JS_TRUE;
-    do_return:
-    return var78;
-}
-static JSBool
-jjadmTestFacDirSel(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval)
-{
-    JSObject * var86;
-    int var87;
-    int var90;
-    jsval var91;
-    JSBool var85;
-    var86 = NULL;
-    var87 = 0;
-    var90 = 0;
-    var91 = JSVAL_NULL;
-    var85 = JS_FALSE;
-    var86 = obj;
-    var90 = argc;
-    var87 = jsTestFacDirSel();
-    if (JS_NewNumberValue(cx, var87, &var91) != JS_TRUE) {
-        goto do_return;
-    }
-    argv[argc+0] = var91;
-    if (rval) {
-        *rval = var91;
-    }
-    var85 = JS_TRUE;
-    do_return:
-    return var85;
-}
-static JSBool
-jjadmTestFacButton(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval)
-{
-    JSObject * var93;
-    int var94;
-    int var97;
-    jsval var98;
-    JSBool var92;
-    var93 = NULL;
-    var94 = 0;
-    var97 = 0;
-    var98 = JSVAL_NULL;
-    var92 = JS_FALSE;
-    var93 = obj;
-    var97 = argc;
-    var94 = jsTestFacButton();
-    if (JS_NewNumberValue(cx, var94, &var98) != JS_TRUE) {
-        goto do_return;
-    }
-    argv[argc+0] = var98;
-    if (rval) {
-        *rval = var98;
-    }
-    var92 = JS_TRUE;
-    do_return:
-    return var92;
-}
-static JSBool
-jjadmTestFacMatrix(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval)
-{
-    JSObject * var100;
-    int var101;
-    int var104;
-    jsval var105;
-    JSBool var99;
-    var100 = NULL;
-    var101 = 0;
-    var104 = 0;
-    var105 = JSVAL_NULL;
-    var99 = JS_FALSE;
-    var100 = obj;
-    var104 = argc;
-    var101 = jsTestFacMatrix();
-    if (JS_NewNumberValue(cx, var101, &var105) != JS_TRUE) {
-        goto do_return;
-    }
-    argv[argc+0] = var105;
-    if (rval) {
-        *rval = var105;
-    }
-    var99 = JS_TRUE;
-    do_return:
-    return var99;
-}
-static JSBool
-jjadmTestFacNotch(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval)
-{
-    JSObject * var107;
-    int var108;
-    int var111;
-    jsval var112;
-    JSBool var106;
-    var107 = NULL;
-    var108 = 0;
-    var111 = 0;
-    var112 = JSVAL_NULL;
-    var106 = JS_FALSE;
-    var107 = obj;
-    var111 = argc;
-    var108 = jsTestFacNotch();
-    if (JS_NewNumberValue(cx, var108, &var112) != JS_TRUE) {
-        goto do_return;
-    }
-    argv[argc+0] = var112;
-    if (rval) {
-        *rval = var112;
-    }
-    var106 = JS_TRUE;
-    do_return:
-    return var106;
-}
-static JSBool
-jjadmTestFacThreadCount(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval)
-{
-    JSObject * var114;
-    int var115;
-    int var118;
-    jsval var119;
-    JSBool var113;
-    var114 = NULL;
-    var115 = 0;
-    var118 = 0;
-    var119 = JSVAL_NULL;
-    var113 = JS_FALSE;
-    var114 = obj;
-    var118 = argc;
-    var115 = jsTestFacThreadCount();
-    if (JS_NewNumberValue(cx, var115, &var119) != JS_TRUE) {
-        goto do_return;
-    }
-    argv[argc+0] = var119;
-    if (rval) {
-        *rval = var119;
-    }
-    var113 = JS_TRUE;
-    do_return:
-    return var113;
-}
-static JSBool
-jjadmTestFacSlider(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval)
-{
-    JSObject * var121;
-    int var122;
-    int var125;
-    jsval var126;
-    JSBool var120;
-    var121 = NULL;
-    var122 = 0;
-    var125 = 0;
-    var126 = JSVAL_NULL;
-    var120 = JS_FALSE;
-    var121 = obj;
-    var125 = argc;
-    var122 = jsTestFacSlider();
-    if (JS_NewNumberValue(cx, var122, &var126) != JS_TRUE) {
-        goto do_return;
-    }
-    argv[argc+0] = var126;
-    if (rval) {
-        *rval = var126;
-    }
-    var120 = JS_TRUE;
-    do_return:
-    return var120;
-}
-static JSBool
-jjadmTestEncoding(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval)
-{
-    JSObject * var128;
-    int var129;
-    int var132;
-    jsval var133;
-    JSBool var127;
-    var128 = NULL;
-    var129 = 0;
-    var132 = 0;
-    var133 = JSVAL_NULL;
-    var127 = JS_FALSE;
-    var128 = obj;
-    var132 = argc;
-    var129 = jsTestFacEncoding();
-    if (JS_NewNumberValue(cx, var129, &var133) != JS_TRUE) {
-        goto do_return;
-    }
-    argv[argc+0] = var133;
-    if (rval) {
-        *rval = var133;
-    }
-    var127 = JS_TRUE;
-    do_return:
-    return var127;
-}
-static JSBool
-jjadmTestCrash(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval)
-{
-    JSObject * var135;
-    int var139;
-    JSBool var134;
-    var135 = NULL;
-    var139 = 0;
-    var134 = JS_FALSE;
-    var135 = obj;
-    var139 = argc;
-    jsTestCrash();
-    var134 = JS_TRUE;
-    return var134;
-}
-static JSBool
-jjadmTestAssert(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval)
-{
-    JSObject * var141;
-    int var145;
-    JSBool var140;
-    var141 = NULL;
-    var145 = 0;
-    var140 = JS_FALSE;
-    var141 = obj;
-    var145 = argc;
-    jsTestAssert();
-    var140 = JS_TRUE;
-    return var140;
-}
-static JSPropertySpec jj_static_ps[] = {
-    {NULL, 0, 0, NULL, NULL}
-};
-static JSPropertySpec jj_ps[] = {
-    {NULL, 0, 0, NULL, NULL}
-};
-static JSFunctionSpec jj_static_fs[] = {
-    JS_FS("admTestFacInt", jjadmTestFacInt, 0, 0, 1),
-    JS_FS("admTestFacFloat", jjadmTestFacFloat, 0, 0, 1),
-    JS_FS("admTestFacToggle", jjadmTestFacToggle, 0, 0, 1),
-    JS_FS("admTestFacMenu", jjadmTestFacMenu, 0, 0, 1),
-    JS_FS("admTestFacFile", jjadmTestFacFile, 0, 0, 1),
-    JS_FS("admTestFacBitrate", jjadmTestFacBitrate, 0, 0, 1),
-    JS_FS("admTestFacBar", jjadmTestFacBar, 0, 0, 1),
-    JS_FS("admTestFacRoText", jjadmTestFacRoText, 0, 0, 1),
-    JS_FS("admTestFacText", jjadmTestFacText, 0, 0, 1),
-    JS_FS("admTestFacTab", jjadmTestFacTab, 0, 0, 1),
-    JS_FS("admTestFacFrame", jjadmTestFacFrame, 0, 0, 1),
-    JS_FS("admTestFacHex", jjadmTestFacHex, 0, 0, 1),
-    JS_FS("admTestFacDirSel", jjadmTestFacDirSel, 0, 0, 1),
-    JS_FS("admTestFacButton", jjadmTestFacButton, 0, 0, 1),
-    JS_FS("admTestFacMatrix", jjadmTestFacMatrix, 0, 0, 1),
-    JS_FS("admTestFacNotch", jjadmTestFacNotch, 0, 0, 1),
-    JS_FS("admTestFacThreadCount", jjadmTestFacThreadCount, 0, 0, 1),
-    JS_FS("admTestFacSlider", jjadmTestFacSlider, 0, 0, 1),
-    JS_FS("admTestEncoding", jjadmTestEncoding, 0, 0, 1),
-    JS_FS("admTestCrash", jjadmTestCrash, 0, 0, 0),
-    JS_FS("admTestAssert", jjadmTestAssert, 0, 0, 0),
-    JS_FS_END
-};
-static JSFunctionSpec jj_fs[] = {
-    JS_FS("admTestFacInt", jjadmTestFacInt, 0, 0, 1),
-    JS_FS("admTestFacFloat", jjadmTestFacFloat, 0, 0, 1),
-    JS_FS("admTestFacToggle", jjadmTestFacToggle, 0, 0, 1),
-    JS_FS("admTestFacMenu", jjadmTestFacMenu, 0, 0, 1),
-    JS_FS("admTestFacFile", jjadmTestFacFile, 0, 0, 1),
-    JS_FS("admTestFacBitrate", jjadmTestFacBitrate, 0, 0, 1),
-    JS_FS("admTestFacBar", jjadmTestFacBar, 0, 0, 1),
-    JS_FS("admTestFacRoText", jjadmTestFacRoText, 0, 0, 1),
-    JS_FS("admTestFacText", jjadmTestFacText, 0, 0, 1),
-    JS_FS("admTestFacTab", jjadmTestFacTab, 0, 0, 1),
-    JS_FS("admTestFacFrame", jjadmTestFacFrame, 0, 0, 1),
-    JS_FS("admTestFacHex", jjadmTestFacHex, 0, 0, 1),
-    JS_FS("admTestFacDirSel", jjadmTestFacDirSel, 0, 0, 1),
-    JS_FS("admTestFacButton", jjadmTestFacButton, 0, 0, 1),
-    JS_FS("admTestFacMatrix", jjadmTestFacMatrix, 0, 0, 1),
-    JS_FS("admTestFacNotch", jjadmTestFacNotch, 0, 0, 1),
-    JS_FS("admTestFacThreadCount", jjadmTestFacThreadCount, 0, 0, 1),
-    JS_FS("admTestFacSlider", jjadmTestFacSlider, 0, 0, 1),
-    JS_FS("admTestEncoding", jjadmTestEncoding, 0, 0, 1),
-    JS_FS("admTestCrash", jjadmTestCrash, 0, 0, 0),
-    JS_FS("admTestAssert", jjadmTestAssert, 0, 0, 0),
-    JS_FS_END
-};
-
-JSFunctionSpec  *jsGetTestFunctions(void)
-{
-        return jj_fs;
-}
-
-

Deleted: branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src/ADM_jsTestFactory_js.idl
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src/ADM_jsTestFactory_js.idl	2010-05-20 15:22:49 UTC (rev 6206)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src/ADM_jsTestFactory_js.idl	2010-05-20 15:22:52 UTC (rev 6207)
@@ -1,40 +0,0 @@
-%{
-#include "stdio.h"
-#include "ADM_jsAvidemux.h"
-#include "ADM_jsTestFactory.h"
-%}
-/*
-###############################################################
-       return JS function     C Function  params
-###############################################################
-*/
-function int admTestFacInt     :  jsTestFacInt     (void  ) <static>;
-function int admTestFacFloat   :  jsTestFacFloat   (void  ) <static>;
-function int admTestFacToggle  :  jsTestFacToggle  (void  ) <static>;
-function int admTestFacMenu    :  jsTestFacMenu    (void  ) <static>;
-function int admTestFacFile    :  jsTestFacFile    (void  ) <static>;
-function int admTestFacBitrate :  jsTestFacBitrate (void  ) <static>;
-function int admTestFacBar     :  jsTestFacBar     (void  ) <static>;
-function int admTestFacRoText  :  jsTestFacRoText  (void  ) <static>;
-function int admTestFacText    :  jsTestFacText    (void  ) <static>;
-function int admTestFacTab     :  jsTestFacTab     (void  ) <static>;
-function int admTestFacFrame   :  jsTestFacFrame   (void  ) <static>;
-function int admTestFacHex     :  jsTestFacHex     (void  ) <static>;
-function int admTestFacDirSel  :  jsTestFacDirSel  (void  ) <static>;
-function int admTestFacButton  :  jsTestFacButton  (void  ) <static>;
-function int admTestFacMatrix  :  jsTestFacMatrix  (void  ) <static>;
-function int admTestFacNotch   :  jsTestFacNotch   (void  ) <static>;
-function int admTestFacThreadCount:  jsTestFacThreadCount   (void  ) <static>;
-function int admTestFacSlider  :  jsTestFacSlider  (void  ) <static>;
-function int admTestEncoding   :  jsTestFacEncoding  (void  ) <static>;
-function void admTestCrash     :  jsTestCrash      (void  ) <static>;
-function void admTestAssert    :  jsTestAssert     (void  ) <static>;
-
-%<
-JSFunctionSpec  *jsGetTestFunctions(void)
-{
-        return jj_fs;
-}
-
-%>
-

Deleted: branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src/ADM_jsUtils.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src/ADM_jsUtils.cpp	2010-05-20 15:22:49 UTC (rev 6206)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src/ADM_jsUtils.cpp	2010-05-20 15:22:52 UTC (rev 6207)
@@ -1,167 +0,0 @@
-/**
-    \file ADM_jsUtils
-    \brief Simple param -> type utilities
-    \author mean fixounet at free.fr 2009
-*/
-/***************************************************************************
- *                                                                         *
- *   This program is free software; you can redistribute it and/or modify  *
- *   it under the terms of the GNU General Public License as published by  *
- *   the Free Software Foundation; either version 2 of the License, or     *
- *   (at your option) any later version.                                   *
- *                                                                         *
- ***************************************************************************/
-#include "ADM_js.h"
-/**
-    \fn ADM_jsArg2Vars  
-    \brief convert jsvals to native type with checking
-*/
-bool ADM_jsArg2Vars(const char *caller, int argc, jsval *argv, int paramNumber, ADM_PARAM_LIST *param)
-{
-    if(paramNumber!=argc)
-    {
-        ADM_warning("[%s]Wrong number of parameters : %d vs %d\n",caller,argc,paramNumber);
-        return false;
-    }
-    for(int i=0;i<argc;i++)
-    {
-        jsval j=argv[i];
-        ADM_PARAM_LIST *p=param+i;
-        switch(p->type)
-        {
-            case ADM_JS_UINT64_T:
-            case ADM_JS_UINT32_T:
-            case ADM_JS_INT64_T:
-            case ADM_JS_INT32_T:
-                {
-                        if(!JSVAL_IS_NUMBER(j))
-                        {
-                            ADM_warning("[%s]Expected number and got %d\n",caller,j);
-                            return false;
-                        }
-                        // If it is an int...
-                        double v=0;
-                        if(JSVAL_IS_INT(j)) 
-                        {
-                            v=(int64_t)JSVAL_TO_INT(j);
-                            //ADM_warning("Value is int :%"LLD"\n",JSVAL_TO_INT(j));
-                        }
-                        if(JSVAL_IS_DOUBLE(j)) 
-                        {
-                            v=(int64_t)*(JSVAL_TO_DOUBLE(j));
-                            //ADM_warning("Value is float :%f\n",(float)*(JSVAL_TO_DOUBLE(j)));
-                        }
-                        // 
-                        //ADM_warning("%f\n",(float)v);
-                        // Affect
-                        switch(p->type)
-                        {
-                            case ADM_JS_UINT64_T: *(uint64_t *)p->value=(uint64_t)v;break;
-                            case ADM_JS_UINT32_T: *(uint32_t *)p->value=(uint32_t)v;break;
-                            case ADM_JS_INT64_T:  *(int64_t *)p->value=(int64_t)v;break;
-                            case ADM_JS_INT32_T:  *(int32_t *)p->value=(int32_t)v;break;
-                            default: ADM_assert(0);break;
-                        }
-                 }
-                        break;
-            case  ADM_JS_STRING:
-                {
-                        if(!JSVAL_IS_STRING(j))
-                        {
-                            ADM_warning("[%s]Expected string and got %d\n",caller,j);
-                            return false;
-                        }
-                        char *out=JS_GetStringBytes(JSVAL_TO_STRING(j));
-                        char **m=(char **)(p->value);
-                        *m=out;
-                }
-                        break;
-            case  ADM_JS_BOOL:
-                        if(!JSVAL_IS_BOOLEAN(j))
-                        {
-                            ADM_warning("[%s]Expected boolean and got %d\n",caller,j);
-                            return false;
-                        }
-                        *(bool *)p->value=JSVAL_TO_BOOLEAN(j);
-                        break;
-            default:
-                    ADM_assert(0);
-                    break;
-        }
-
-    }
-    return true;
-}
-/**
-    \fn stringsToConfCouple
-    \brief Convert js args to confcouple
-
-*/
-bool stringsToConfCouple(int nb,CONFcouple **conf,  const char **argv)
-{
-  *conf=NULL;
-  if(!nb) return true;
-  CONFcouple *c=new CONFcouple(nb);
-  *conf=c;
-    for(int i=0;i<nb;i++)
-    {
-        
-        char *dupe=   ADM_strdup(argv[i]);
-        char *name,*value;
-        // dupe is in the form name=value
-        name=dupe;
-        value=name;
-        char *tail=dupe+strlen(dupe);
-        while(value<tail)
-        {
-            if(*value=='=') 
-                {
-                    *value=0;
-                    value++;
-                    break;
-                }
-            value++;
-        }
-        c->setInternalName(name,value);
-        //printf("%s -> [%s,%s]\n",param,name,value);
-        ADM_dezalloc(dupe);
-    }
-    return true;
-}
-/**
-    \fn jsArgToConfCouple
-    \brief Convert js args to confcouple
-
-*/
-bool jsArgToConfCouple(int nb,CONFcouple **conf,  jsval *argv)
-{
-  *conf=NULL;
-  if(!nb) return true;
-  CONFcouple *c=new CONFcouple(nb);
-  *conf=c;
-    for(int i=0;i<nb;i++)
-    {
-        char *param = JS_GetStringBytes(JSVAL_TO_STRING(argv[i]));
-        char *dupe=   ADM_strdup(param);
-        char *name,*value;
-        // dupe is in the form name=value
-        name=dupe;
-        value=name;
-        char *tail=dupe+strlen(dupe);
-        while(value<tail)
-        {
-            if(*value=='=') 
-                {
-                    *value=0;
-                    value++;
-                    break;
-                }
-            value++;
-        }
-        c->setInternalName(name,value);
-        //printf("%s -> [%s,%s]\n",param,name,value);
-        ADM_dezalloc(dupe);
-    }
-    return true;
-}
-// EOF

Deleted: branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src/ADM_jsVideo.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src/ADM_jsVideo.cpp	2010-05-20 15:22:49 UTC (rev 6206)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src/ADM_jsVideo.cpp	2010-05-20 15:22:52 UTC (rev 6207)
@@ -1,149 +0,0 @@
-/**
-    \file ADM_jsVideo.cpp
-    \brief Video oriented functions
-    \author mean (c) 2009 fixounet at free.fr
-
-
-    jsapigen does not like much variable number of arguments
-    In that case, we patch the generated file to go back to native spidermonkey api
-
-
-*/
-/***************************************************************************
- *                                                                         *
- *   This program is free software; you can redistribute it and/or modify  *
- *   it under the terms of the GNU General Public License as published by  *
- *   the Free Software Foundation; either version 2 of the License, or     *
- *   (at your option) any later version.                                   *
- *                                                                         *
- ***************************************************************************/
-#include "ADM_js.h"
-#include "ADM_editor/ADM_edit.hxx"
-#include "ADM_jsAvidemux.h"
-#include "ADM_jsVideo.h"
-#include "A_functions.h"
-#include "ADM_videoEncoderApi.h"
-#include "ADM_videoFilterApi.h"
-#include "ADM_videoFilters.h"
-#include "GUI_ui.h"
-extern ADM_Composer *video_body;
-bool A_setVideoCodec(const char *nm);
-/**
-    \fn jsSetPostProc
-*/
-int jsSetPostProc (int a,int b, int c)
-{
-    return video_body->setPostProc(a,b,c);
-}
-
-
-/**
-    \fn Codec
-    
-*/
-extern "C" int   jsVideoCodec(const char *a,const char **b) {return 0;}
-JSBool jsAdmvideoCodec(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval)
-{// begin Codec
-        *rval = BOOLEAN_TO_JSVAL(false);
-        if(argc <1)
-                return JS_FALSE;
-        if(JSVAL_IS_STRING(argv[0]) == false )
-        {
-                jsLog(JS_LOG_ERROR,"Cannot set codec, first parameter is not a string\n");
-                return JS_FALSE;
-        }
-        char *codec=JS_GetStringBytes(JSVAL_TO_STRING(argv[0]));
-        // Set codec.
-        
-        if(A_setVideoCodec(codec)==false)
-        {
-            jsLog(JS_LOG_ERROR,"Could not select codec %s\n",codec);
-            return JS_FALSE;
-        }
-        CONFcouple *c;
-        jsArgToConfCouple(argc-1,&c,argv+1);
-        *rval = BOOLEAN_TO_JSVAL( videoEncoder6_SetConfiguration(c));
-        jsLog(JS_LOG_NORMAL,"Selected codec %s\n",codec);
-        if(c) delete c;
-        return JS_TRUE;
-}// end Codec
-
-/**
-    \fn Codec
-    
-*/
-extern "C" int   jsVideoFilter(const char *a,const char **b) {return 0;}
-JSBool jsAdmaddVideoFilter(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval)
-{// begin Codec
-   uint32_t filterTag;
-
-        // default return value
-        *rval = BOOLEAN_TO_JSVAL(false);
-        if(argc == 0)
-                return JS_FALSE;
-        char *filterName=JS_GetStringBytes(JSVAL_TO_STRING(argv[0]));
-        filterTag = ADM_vf_getTagFromInternalName(filterName);
-        jsLog(JS_LOG_NORMAL,"Adding Filter %s -> %"LU"... \n",filterName,filterTag);
-
-        
-        CONFcouple *c=NULL;
-        if(argc)
-            jsArgToConfCouple(argc-1,&c,argv+1);
-        *rval=BOOLEAN_TO_JSVAL(  ADM_vf_addFilterFromTag(filterTag,c,false));
-        if(c) delete c;
-        
-        return JS_TRUE;
-}// end Codec
-/**
-    \fn A_setVideoCodec
-*/
-bool A_setVideoCodec(const char *nm)
-{
-    int idx=videoEncoder6_GetIndexFromName(nm);
-    if(idx==-1)
-    {
-        ADM_error("No such encoder :%s\n",nm);
-    }
-    // Select by index
-    videoEncoder6_SetCurrentEncoder(idx);
-    UI_setVideoCodec(idx);
-    return true;
-}
-/**
-     \fn jsClearFilters
-*/
-int jsClearVideoFilters()
-{
-    return ADM_vf_clearFilters();
-}
-/**
-    \fn jsGetMarkerA
-*/
-double jsGetMarkerA(void)
-{
-    return (double)video_body->getMarkerAPts();
-
-}
-/**
-    \fn jsGetMarkerB
-*/
-double jsGetMarkerB(void)
-{
-    return (double)video_body->getMarkerBPts();
-}
-/**
-    \fn jsSetMarkerA
-*/
-void   jsSetMarkerA(double a)
-{
-    video_body->setMarkerAPts( (uint64_t)a);
-}
-/**
-    \fn jsGetMarkerB
-*/
-void   jsSetMarkerB(double b)
-{
-    video_body->setMarkerBPts( (uint64_t)b);
-}
-
-//EOF
\ No newline at end of file

Deleted: branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src/CMakeLists.txt
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src/CMakeLists.txt	2010-05-20 15:22:49 UTC (rev 6206)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src/CMakeLists.txt	2010-05-20 15:22:52 UTC (rev 6207)
@@ -1,27 +0,0 @@
-SET(ADM_script_SRCS
-        ADM_jsIf.cpp
-        ADM_jsDebug.cpp
-        ADM_jsUtils.cpp
-# Wrapper code
-        ADM_jsIf_js.c
-# Factory test
-        ADM_jsTestFactory.cpp  
-        ADM_jsTestFactory_js.c
-# Load segment
-        ADM_jsAvidemux.cpp
-        ADM_jsAvidemuxInfo.cpp
-        ADM_jsAvidemux_js.c
-# Debug / editor class
-        ADM_jsEditor.cpp
-        ADM_jsEditor_js.c
-
-# 
-        ADM_jsVideo.cpp
-#
-        ADM_jsAudio.cpp
-)
-
-ADD_LIBRARY(ADM_script26 STATIC ${ADM_script_SRCS})
-ADD_DEFINITIONS("-DJS_THREADSAFE -DXP_UNIX")
-include_directories(${AVIDEMUX_TOP_SOURCE_DIR}/avidemux/common/ADM_script2/include)
-include_directories(${AVIDEMUX_TOP_SOURCE_DIR}/avidemux_core/ADM_smjs)

Deleted: branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src/idl.make
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src/idl.make	2010-05-20 15:22:49 UTC (rev 6206)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src/idl.make	2010-05-20 15:22:52 UTC (rev 6207)
@@ -1,7 +0,0 @@
-idls:=$(shell ls *.idl)
-cs:=$(subst .idl,.c,$(idls))
-%.c : %.idl
-	echo processing $@
-	jsapigen < $< > /tmp/xx
-	cat /tmp/xx   | sed 's/"\(.*\)_ignore"/"\1"/g'  | sed 's/, jjadm\(.*\)_ignore,/, jsAdm\1, /g' > $@
-all: $(cs)

Deleted: branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src/updateIdl.sh
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src/updateIdl.sh	2010-05-20 15:22:49 UTC (rev 6206)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src/updateIdl.sh	2010-05-20 15:22:52 UTC (rev 6207)
@@ -1 +0,0 @@
-jsapigen < ADM_jsIf_js.idl  > ADM_jsIf_js.c

Modified: branches/avidemux_2.6_branch_mean/avidemux/common/CMakeLists.txt
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/CMakeLists.txt	2010-05-20 15:22:49 UTC (rev 6206)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/CMakeLists.txt	2010-05-20 15:22:52 UTC (rev 6207)
@@ -16,7 +16,6 @@
 ADD_SUBDIRECTORY(ADM_requant)
 #ADD_SUBDIRECTORY(ADM_script)
 ADD_SUBDIRECTORY(ADM_script2)
-ADD_SUBDIRECTORY(ADM_pyScript)
 ADD_SUBDIRECTORY(ADM_toolkit)
 #ADD_SUBDIRECTORY(ADM_video)
 #ADD_SUBDIRECTORY(ADM_videoFilter)

Modified: branches/avidemux_2.6_branch_mean/avidemux/commonCmakeApplication.cmake
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/commonCmakeApplication.cmake	2010-05-20 15:22:49 UTC (rev 6206)
+++ branches/avidemux_2.6_branch_mean/avidemux/commonCmakeApplication.cmake	2010-05-20 15:22:52 UTC (rev 6207)
@@ -99,7 +99,6 @@
 ADM_requant6 
 #ADM_script6 
 ADM_script26 
-ADM_pyScript6 
 ADM_scriptDF
 ADM_videoEncoder6 
 ADM_internalVideoFilter6



From mean at mail.berlios.de  Thu May 20 17:22:58 2010
From: mean at mail.berlios.de (mean at BerliOS)
Date: Thu, 20 May 2010 17:22:58 +0200
Subject: [Avidemux-svn-commit] r6208 - in
	branches/avidemux_2.6_branch_mean/avidemux: . common
	common/ADM_editor common/ADM_script2
	common/ADM_script2/include common/ADM_script2/js
	common/ADM_script2/js/src_dialogFactory common/ADM_script2/py
	common/ADM_script2/py/include common/ADM_script2/src
	common/ADM_script2/src_dialogFactory
	qt4/ADM_userInterfaces/ADM_shell
Message-ID: <201005201522.o4KFMwGa014359@sheep.berlios.de>

Author: mean
Date: 2010-05-20 17:22:57 +0200 (Thu, 20 May 2010)
New Revision: 6208

Added:
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/include/ADM_scriptAvidemux.h
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/include/ADM_scriptDebug.h
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/include/ADM_scriptEditor.h
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/include/ADM_scriptIf.h
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/include/ADM_scriptShell.h
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/include/ADM_scriptTestFactory.h
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/include/ADM_scriptVideo.h
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/js/ADM_js.h
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/js/ADM_jsAvidemux.h
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/js/ADM_jsDFactory.h
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/js/ADM_jsUtils.h
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/js/src_dialogFactory/
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/js/src_dialogFactory/ADM_JSDF.h
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/js/src_dialogFactory/ADM_JSDFInteger.cpp
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/js/src_dialogFactory/ADM_JSDFInteger.h
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/js/src_dialogFactory/ADM_JSDFMenu.cpp
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/js/src_dialogFactory/ADM_JSDFMenu.h
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/js/src_dialogFactory/ADM_JSDFToggle.cpp
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/js/src_dialogFactory/ADM_JSDFToggle.h
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/js/src_dialogFactory/ADM_JSDialogFactory.cpp
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/js/src_dialogFactory/ADM_JSDialogFactory.h
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/js/src_dialogFactory/ADM_JSDialogFactory_if.cpp
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/js/src_dialogFactory/CMakeLists.txt
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src/ADM_scriptIf.cpp
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src/ADM_scriptVideo.cpp
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src/CMakeLists.txt
Removed:
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/include/ADM_js.h
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/include/ADM_jsAvidemux.h
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/include/ADM_jsDFactory.h
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/include/ADM_jsDebug.h
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/include/ADM_jsEditor.h
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/include/ADM_jsIf.h
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/include/ADM_jsShell.h
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/include/ADM_jsTestFactory.h
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/include/ADM_jsUtils.h
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/include/ADM_jsVideo.h
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/include/adm_scanner.h
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/py/include/ADM_pyIf.h
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src_dialogFactory/ADM_JSDF.h
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src_dialogFactory/ADM_JSDFInteger.cpp
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src_dialogFactory/ADM_JSDFInteger.h
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src_dialogFactory/ADM_JSDFMenu.cpp
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src_dialogFactory/ADM_JSDFMenu.h
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src_dialogFactory/ADM_JSDFToggle.cpp
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src_dialogFactory/ADM_JSDFToggle.h
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src_dialogFactory/ADM_JSDialogFactory.cpp
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src_dialogFactory/ADM_JSDialogFactory.h
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src_dialogFactory/ADM_JSDialogFactory_if.cpp
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src_dialogFactory/CMakeLists.txt
Modified:
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_editor/ADM_segment.cpp
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/CMakeLists.txt
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/js/ADM_jsDebug.cpp
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/js/ADM_jsEditor.cpp
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/js/ADM_jsEditor_js.c
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/js/ADM_jsIf.cpp
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/js/ADM_jsIf_js.c
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/js/ADM_jsTestFactory.cpp
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/js/ADM_jsTestFactory_js.c
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/js/ADM_jsVideo.cpp
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/js/CMakeLists.txt
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/py/ADM_pyAdm.cpp
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/py/CMakeLists.txt
   branches/avidemux_2.6_branch_mean/avidemux/common/gtk_gui.cpp
   branches/avidemux_2.6_branch_mean/avidemux/common/main.cpp
   branches/avidemux_2.6_branch_mean/avidemux/commonCmakeApplication.cmake
   branches/avidemux_2.6_branch_mean/avidemux/qt4/ADM_userInterfaces/ADM_shell/Q_shell.h
Log:
[py/js] Factorize

Modified: branches/avidemux_2.6_branch_mean/avidemux/common/ADM_editor/ADM_segment.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/ADM_editor/ADM_segment.cpp	2010-05-20 15:22:52 UTC (rev 6207)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/ADM_editor/ADM_segment.cpp	2010-05-20 15:22:57 UTC (rev 6208)
@@ -23,7 +23,7 @@
 #include "ADM_colorspace.h"
 #include "ADM_vidMisc.h"
 #include "ADM_audiocodec/ADM_audiocodec.h"
-#include "ADM_script2/include/ADM_jsIf.h"
+#include "ADM_script2/include/ADM_scriptIf.h"
 #include "ADM_codec.h"
 
 ADM_EditorSegment::ADM_EditorSegment(void)

Modified: branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/CMakeLists.txt
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/CMakeLists.txt	2010-05-20 15:22:52 UTC (rev 6207)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/CMakeLists.txt	2010-05-20 15:22:57 UTC (rev 6208)
@@ -1,2 +1,3 @@
+subdirs (js)
+subdirs (py)
 subdirs (src)
-subdirs (src_dialogFactory)

Deleted: branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/include/ADM_js.h
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/include/ADM_js.h	2010-05-20 15:22:52 UTC (rev 6207)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/include/ADM_js.h	2010-05-20 15:22:57 UTC (rev 6208)
@@ -1,51 +0,0 @@
-/**
-    \file ADM_js
-    \brief Standard includes and defines
-*/
-
-/***************************************************************************
- *                                                                         *
- *   This program is free software; you can redistribute it and/or modify  *
- *   it under the terms of the GNU General Public License as published by  *
- *   the Free Software Foundation; either version 2 of the License, or     *
- *   (at your option) any later version.                                   *
- *                                                                         *
- ***************************************************************************/
-#ifndef ADM_JS_H
-#define ADM_JS_H
-
-
-#include "ADM_default.h"
-#include <string.h>
-#include <pthread.h>
-#include <vector>
-using std::vector;
-#include "DIA_coreToolkit.h"
-#include "jsapi.h"
-#include "ADM_jsUtils.h"
-#include "ADM_jsShell.h"
-#include "ADM_jsDebug.h"
-#include "ADM_jsDFactory.h"
-
-typedef JSBool JS_PROTOTYPE(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval);
-
-
-/**
-    \struct ADM_JS_HOOK
-*/
-typedef struct
-{
-    const char      *name;
-    const char      *text;
-    JSFunctionSpec  *jsFunctions;
-}ADM_JS_HOOK;
-extern vector <ADM_JS_HOOK >jsHooks;
-#if !defined(ADM_JS_THREADSAFE)
-    #define enterLock() {}
-    #define leaveLock() {}
-#else
-    #define enterLock() jsrefcount nRefCount = JS_SuspendRequest(cx)
-    #define leaveLock() {JS_ResumeRequest(cx,nRefCount); }
-#endif
-
-#endif

Deleted: branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/include/ADM_jsAvidemux.h
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/include/ADM_jsAvidemux.h	2010-05-20 15:22:52 UTC (rev 6207)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/include/ADM_jsAvidemux.h	2010-05-20 15:22:57 UTC (rev 6208)
@@ -1,53 +0,0 @@
-/**
-    \file ADM_jsAvidemux
-    \brief Standard includes and defines
-*/
-
-/***************************************************************************
- *                                                                         *
- *   This program is free software; you can redistribute it and/or modify  *
- *   it under the terms of the GNU General Public License as published by  *
- *   the Free Software Foundation; either version 2 of the License, or     *
- *   (at your option) any later version.                                   *
- *                                                                         *
- ***************************************************************************/
-#ifndef ADM_JS_AVIDEMUX_H
-#define ADM_JS_AVIDEMUX_H
-#include "ADM_inttype.h"
-#include "jsapi.h"
-#ifdef __cplusplus
-extern "C" {
-#endif
-
-int jsLoadVideo(const char *c);
-int jsAppendVideo(const char *c);
-int jsClearSegments(void);
-int jsAddSegment(int ref, double start, double duration);
-int jsAudioReset(void);
-int jsAudioMixer(const char *s);
-// Fq
-int32_t jsGetResample(void);
-void    jsSetResample(int32_t fq);
-// Markers
-double jsGetMarkerA(void);
-double jsGetMarkerB(void);
-void   jsSetMarkerA(double a);
-void   jsSetMarkerB(double b);
-//
-int    jsClearVideoFilters();
-// Info
-int jsGetWidth ( void) ;
-int jsGetHeight ( void) ;
-int jsGetFps1000 ( void) ;
-char *jsGetVideoCodec ( void) ;
-
-// non jsapigen function, variables number of args
-JSBool jsAdmaddVideoFilter(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval);
-JSBool jsAdmaudioCodec(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval);
-JSBool jsAdmsetContainer(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval);
-JSBool jsAdmvideoCodec(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval);
-#ifdef __cplusplus
-};
-#endif
-
-#endif

Deleted: branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/include/ADM_jsDFactory.h
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/include/ADM_jsDFactory.h	2010-05-20 15:22:52 UTC (rev 6207)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/include/ADM_jsDFactory.h	2010-05-20 15:22:57 UTC (rev 6208)
@@ -1,21 +0,0 @@
-/**
-    \file ADM_jsDialogFactory.h
-    \brief Base class for dialog factory mapping
-    \author mean, fixounet at free.fr
-*/
-
-/***************************************************************************
- *                                                                         *
- *   This program is free software; you can redistribute it and/or modify  *
- *   it under the terms of the GNU General Public License as published by  *
- *   the Free Software Foundation; either version 2 of the License, or     *
- *   (at your option) any later version.                                   *
- *                                                                         *
- ***************************************************************************/
-
-#ifndef ADM_JS_DIALOG_H
-#define ADM_JS_DIALOG_H
-#include "ADM_jsIf.h"
-extern "C"  JSObject *jsDialogFactoryInit(JSContext *cx,JSObject *obj);
-
-#endif // ADM_JS_SHELL_H

Deleted: branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/include/ADM_jsDebug.h
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/include/ADM_jsDebug.h	2010-05-20 15:22:52 UTC (rev 6207)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/include/ADM_jsDebug.h	2010-05-20 15:22:57 UTC (rev 6208)
@@ -1,32 +0,0 @@
-/**
-    \file ADM_JSDebug.h
-    \brief Debug oriented functions for avidemux JS/JS shell
-    \author mean (c) 2009 fixounet at free.fr
-
-
-*/
-/***************************************************************************
- *                                                                         *
- *   This program is free software; you can redistribute it and/or modify  *
- *   it under the terms of the GNU General Public License as published by  *
- *   the Free Software Foundation; either version 2 of the License, or     *
- *   (at your option) any later version.                                   *
- *                                                                         *
- ***************************************************************************/
-
-#ifndef ADMJS_DEBUG_H
-#define ADMJS_DEBUG_H
-#ifdef __cplusplus
-extern "C"
-{
-#endif
-void jsPopupError(const char *s);
-void jsPopupInfo(const char *s);
-void jsPrint(const char *s);
-void jsPrint2(const char *s);
-void jsHelp(const char *s);
-#ifdef __cplusplus
-};
-#endif
-
-#endif
\ No newline at end of file

Deleted: branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/include/ADM_jsEditor.h
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/include/ADM_jsEditor.h	2010-05-20 15:22:52 UTC (rev 6207)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/include/ADM_jsEditor.h	2010-05-20 15:22:57 UTC (rev 6208)
@@ -1,29 +0,0 @@
-/**
-    \file ADM_jsAvidemux
-    \brief Standard includes and defines
-*/
-
-/***************************************************************************
- *                                                                         *
- *   This program is free software; you can redistribute it and/or modify  *
- *   it under the terms of the GNU General Public License as published by  *
- *   the Free Software Foundation; either version 2 of the License, or     *
- *   (at your option) any later version.                                   *
- *                                                                         *
- ***************************************************************************/
-#ifndef ADM_JS_EDITOR_H
-#define ADM_JS_EDITOR_H
-#include "ADM_inttype.h"
-#include "jsapi.h"
-#ifdef __cplusplus
-extern "C" {
-#endif
-
-int jsPrintTiming(int framenumber );
-int jsDumpSegments (void);
-int jsDumpRefVideos (void);
-#ifdef __cplusplus
-};
-#endif
-
-#endif

Deleted: branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/include/ADM_jsIf.h
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/include/ADM_jsIf.h	2010-05-20 15:22:52 UTC (rev 6207)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/include/ADM_jsIf.h	2010-05-20 15:22:57 UTC (rev 6208)
@@ -1,64 +0,0 @@
-/**
-    \file ADM_JSif.cpp
-    \brief interface to js
-*/
-
-/***************************************************************************
- *                                                                         *
- *   This program is free software; you can redistribute it and/or modify  *
- *   it under the terms of the GNU General Public License as published by  *
- *   the Free Software Foundation; either version 2 of the License, or     *
- *   (at your option) any later version.                                   *
- *                                                                         *
- ***************************************************************************/
-#ifndef ADM_JS_IF_H
-#define ADM_JS_IF_H
-
-/**
-    \enum JS_LOG_TYPE
-*/
-typedef enum
-{
-    JS_LOG_NORMAL,
-    JS_LOG_ERROR
-}JS_LOG_TYPE;
-/**
-    \typedef jsLoggerFunc
-*/
-typedef bool (jsLoggerFunc)(void *cookie,JS_LOG_TYPE type,const char *);
-/*
-
-*/
-bool ADM_jsRegisterLogger(void *cookie,jsLoggerFunc *fun);
-bool ADM_jsUnregisterLogger(void);
-
-/**
-    \fn parseECMAScript
-    \brief Compile & execute ecma script
-*/
-bool parseECMAScript(const char *name);
-
-/**
-    \fn    interactiveECMAScript
-    \brief interprete & execute ecma script (interactive)
-*/
-bool interactiveECMAScript(const char *name);
-/**
-    \fn jsLog
-
-*/
-bool jsLog(JS_LOG_TYPE type, const char *fmt,...);
-
-/**
-    \fn SpidermonkeyInit
-*/
-bool SpidermonkeyInit(void);
-/**
-    \fn SpidermonkeyDestroy
-*/
-void SpidermonkeyDestroy(void);
-/**
-    \fn SpidermonkeyExit
-*/
-bool SpidermonkeyExit(void);
-#endif

Deleted: branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/include/ADM_jsShell.h
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/include/ADM_jsShell.h	2010-05-20 15:22:52 UTC (rev 6207)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/include/ADM_jsShell.h	2010-05-20 15:22:57 UTC (rev 6208)
@@ -1,23 +0,0 @@
-/**
-    \file ADM_jsShell.h
-    \brief Base class for js interactive shell
-    \author mean, fixounet at free.fr
-*/
-
-/***************************************************************************
- *                                                                         *
- *   This program is free software; you can redistribute it and/or modify  *
- *   it under the terms of the GNU General Public License as published by  *
- *   the Free Software Foundation; either version 2 of the License, or     *
- *   (at your option) any later version.                                   *
- *                                                                         *
- ***************************************************************************/
-
-#ifndef ADM_JS_SHELL_H
-#define ADM_JS_SHELL_H
-#include "ADM_jsIf.h"
-typedef bool (jsShellEvaluate)(const char *str);
-bool ADM_startShell(jsShellEvaluate *eval);
-
-
-#endif // ADM_JS_SHELL_H
\ No newline at end of file

Deleted: branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/include/ADM_jsTestFactory.h
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/include/ADM_jsTestFactory.h	2010-05-20 15:22:52 UTC (rev 6207)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/include/ADM_jsTestFactory.h	2010-05-20 15:22:57 UTC (rev 6208)
@@ -1,50 +0,0 @@
-/**
-    \file ADM_jsTestFactory.h
-    \brief  Simple js hook to test factory
-    \author mean (c) 2009 fixounet at free.fr
-
-
-*/
-/***************************************************************************
- *                                                                         *
- *   This program is free software; you can redistribute it and/or modify  *
- *   it under the terms of the GNU General Public License as published by  *
- *   the Free Software Foundation; either version 2 of the License, or     *
- *   (at your option) any later version.                                   *
- *                                                                         *
- ***************************************************************************/
-
-#ifndef ADMJS_FACTORY_H
-#define ADMJS_FACTORY_H
-#ifdef __cplusplus
-extern "C"
-{
-#endif
-int jsTestCrash(void);
-int jsTestAssert(void);
-int jsTestFacNotch(void);
-int jsTestFacThreadCount(void);
-int jsTestFacMatrix(void);
-int jsTestFacMatrix(void);
-int jsTestFacHex(void);
-int jsTestFacFrame(void);
-int jsTestFacTab(void);
-int jsTestFacText(void);
-int jsTestFacRoText(void);
-int jsTestFacSlider(void);
-int jsTestFacButton(void);
-int jsTestFacBar(void);
-int jsTestFacBitrate(void);
-int jsTestFacDirSel(void);
-int jsTestFacFile(void);
-int jsTestFacMenu(void);
-int jsTestFacToggle(void);
-int jsTestFacFloat(void);
-int jsTestFacInt(void);
-int jsTestFacEncoding(void);
-#ifdef __cplusplus
-};
-#endif
-
-
-#endif

Deleted: branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/include/ADM_jsUtils.h
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/include/ADM_jsUtils.h	2010-05-20 15:22:52 UTC (rev 6207)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/include/ADM_jsUtils.h	2010-05-20 15:22:57 UTC (rev 6208)
@@ -1,40 +0,0 @@
-/**
-    \file ADM_jsUtils
-    \brief Simple param -> type utilities
-    \author mean fixounet at free.fr 2009
-*/
-/***************************************************************************
- *                                                                         *
- *   This program is free software; you can redistribute it and/or modify  *
- *   it under the terms of the GNU General Public License as published by  *
- *   the Free Software Foundation; either version 2 of the License, or     *
- *   (at your option) any later version.                                   *
- *                                                                         *
- ***************************************************************************/
-#ifndef ADM_JS_UTILS_H
-#define ADM_JS_UTILS_H
-#include "ADM_confCouple.h"
-typedef enum
-{
-    ADM_JS_INVALID=0,
-    ADM_JS_UINT32_T=1,
-    ADM_JS_INT32_T,
-    ADM_JS_UINT64_T,
-    ADM_JS_INT64_T,
-    ADM_JS_STRING,
-    ADM_JS_BOOL,
-    ADM_JS_MAX
-}ADM_PARAM_TYPE;
-
-typedef struct
-{
-    ADM_PARAM_TYPE type;
-    void           *value;
-
-}ADM_PARAM_LIST;
-
-// since long int will be coded by js as double, we need a centralized version to convert
-bool ADM_jsArg2Vars(const char *caller, int argc, jsval *argv, int paramNumber, ADM_PARAM_LIST *param);
-bool stringsToConfCouple(int nb,CONFcouple **conf,  const char **argv);
-bool jsArgToConfCouple(int nb,CONFcouple **conf,  jsval *argv);
-#endif

Deleted: branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/include/ADM_jsVideo.h
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/include/ADM_jsVideo.h	2010-05-20 15:22:52 UTC (rev 6207)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/include/ADM_jsVideo.h	2010-05-20 15:22:57 UTC (rev 6208)
@@ -1,28 +0,0 @@
-/**
-    \file ADM_jsVideo
-    \brief Video codec etc..
-*/
-
-/***************************************************************************
- *                                                                         *
- *   This program is free software; you can redistribute it and/or modify  *
- *   it under the terms of the GNU General Public License as published by  *
- *   the Free Software Foundation; either version 2 of the License, or     *
- *   (at your option) any later version.                                   *
- *                                                                         *
- ***************************************************************************/
-#ifndef ADM_JS_VIDEO_H
-#define ADM_JS_VIDEO_H
-
-#ifdef __cplusplus
-extern "C" {
-#endif
-
-int jsVideoCodec(const char *codec,const char **p);
-int jsSetPostProc (int a,int b, int c);
-
-#ifdef __cplusplus
-};
-#endif
-
-#endif

Copied: branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/include/ADM_scriptAvidemux.h (from rev 6207, branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/include/ADM_jsAvidemux.h)
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/include/ADM_jsAvidemux.h	2010-05-20 15:22:52 UTC (rev 6207)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/include/ADM_scriptAvidemux.h	2010-05-20 15:22:57 UTC (rev 6208)
@@ -0,0 +1,47 @@
+/**
+    \file ADM_jsAvidemux
+    \brief Standard includes and defines
+*/
+
+/***************************************************************************
+ *                                                                         *
+ *   This program is free software; you can redistribute it and/or modify  *
+ *   it under the terms of the GNU General Public License as published by  *
+ *   the Free Software Foundation; either version 2 of the License, or     *
+ *   (at your option) any later version.                                   *
+ *                                                                         *
+ ***************************************************************************/
+#ifndef ADM_JS_AVIDEMUX_H
+#define ADM_JS_AVIDEMUX_H
+#include "ADM_inttype.h"
+#ifdef __cplusplus
+extern "C" {
+#endif
+
+int jsLoadVideo(const char *c);
+int jsAppendVideo(const char *c);
+int jsClearSegments(void);
+int jsAddSegment(int ref, double start, double duration);
+int jsAudioReset(void);
+int jsAudioMixer(const char *s);
+// Fq
+int32_t jsGetResample(void);
+void    jsSetResample(int32_t fq);
+// Markers
+double jsGetMarkerA(void);
+double jsGetMarkerB(void);
+void   jsSetMarkerA(double a);
+void   jsSetMarkerB(double b);
+//
+int    jsClearVideoFilters();
+// Info
+int jsGetWidth ( void) ;
+int jsGetHeight ( void) ;
+int jsGetFps1000 ( void) ;
+char *jsGetVideoCodec ( void) ;
+
+#ifdef __cplusplus
+};
+#endif
+
+#endif

Copied: branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/include/ADM_scriptDebug.h (from rev 6207, branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/include/ADM_jsDebug.h)
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/include/ADM_jsDebug.h	2010-05-20 15:22:52 UTC (rev 6207)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/include/ADM_scriptDebug.h	2010-05-20 15:22:57 UTC (rev 6208)
@@ -0,0 +1,32 @@
+/**
+    \file ADM_JSDebug.h
+    \brief Debug oriented functions for avidemux JS/JS shell
+    \author mean (c) 2009 fixounet at free.fr
+
+
+*/
+/***************************************************************************
+ *                                                                         *
+ *   This program is free software; you can redistribute it and/or modify  *
+ *   it under the terms of the GNU General Public License as published by  *
+ *   the Free Software Foundation; either version 2 of the License, or     *
+ *   (at your option) any later version.                                   *
+ *                                                                         *
+ ***************************************************************************/
+
+#ifndef ADMJS_DEBUG_H
+#define ADMJS_DEBUG_H
+#ifdef __cplusplus
+extern "C"
+{
+#endif
+void jsPopupError(const char *s);
+void jsPopupInfo(const char *s);
+void jsPrint(const char *s);
+void jsPrint2(const char *s);
+void jsHelp(const char *s);
+#ifdef __cplusplus
+};
+#endif
+
+#endif
\ No newline at end of file

Copied: branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/include/ADM_scriptEditor.h (from rev 6207, branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/include/ADM_jsEditor.h)
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/include/ADM_jsEditor.h	2010-05-20 15:22:52 UTC (rev 6207)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/include/ADM_scriptEditor.h	2010-05-20 15:22:57 UTC (rev 6208)
@@ -0,0 +1,29 @@
+/**
+    \file ADM_jsAvidemux
+    \brief Standard includes and defines
+*/
+
+/***************************************************************************
+ *                                                                         *
+ *   This program is free software; you can redistribute it and/or modify  *
+ *   it under the terms of the GNU General Public License as published by  *
+ *   the Free Software Foundation; either version 2 of the License, or     *
+ *   (at your option) any later version.                                   *
+ *                                                                         *
+ ***************************************************************************/
+#ifndef ADM_JS_EDITOR_H
+#define ADM_JS_EDITOR_H
+#include "ADM_inttype.h"
+//#include "jsapi.h"
+#ifdef __cplusplus
+extern "C" {
+#endif
+
+int jsPrintTiming(int framenumber );
+int jsDumpSegments (void);
+int jsDumpRefVideos (void);
+#ifdef __cplusplus
+};
+#endif
+
+#endif

Copied: branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/include/ADM_scriptIf.h (from rev 6207, branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/include/ADM_jsIf.h)
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/include/ADM_jsIf.h	2010-05-20 15:22:52 UTC (rev 6207)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/include/ADM_scriptIf.h	2010-05-20 15:22:57 UTC (rev 6208)
@@ -0,0 +1,75 @@
+/**
+    \file ADM_JSif.cpp
+    \brief interface to js
+*/
+
+/***************************************************************************
+ *                                                                         *
+ *   This program is free software; you can redistribute it and/or modify  *
+ *   it under the terms of the GNU General Public License as published by  *
+ *   the Free Software Foundation; either version 2 of the License, or     *
+ *   (at your option) any later version.                                   *
+ *                                                                         *
+ ***************************************************************************/
+#ifndef ADM_JS_IF_H
+#define ADM_JS_IF_H
+
+/**
+    \enum JS_LOG_TYPE
+*/
+typedef enum
+{
+    JS_LOG_NORMAL,
+    JS_LOG_ERROR
+}JS_LOG_TYPE;
+/**
+    \typedef jsLoggerFunc
+*/
+typedef bool (jsLoggerFunc)(void *cookie,JS_LOG_TYPE type,const char *);
+/*
+
+*/
+bool ADM_jsRegisterLogger(void *cookie,jsLoggerFunc *fun);
+bool ADM_jsUnregisterLogger(void);
+
+/**
+    \fn parseECMAScript
+    \brief Compile & execute ecma script
+*/
+bool parseECMAScript(const char *name);
+
+/**
+    \fn    interactiveECMAScript
+    \brief interprete & execute ecma script (interactive)
+*/
+bool interactiveECMAScript(const char *name);
+/**
+    \fn jsLog
+
+*/
+bool jsLog(JS_LOG_TYPE type, const char *fmt,...);
+
+/**
+    \fn SpidermonkeyInit
+*/
+bool SpidermonkeyInit(void);
+/**
+    \fn SpidermonkeyDestroy
+*/
+void SpidermonkeyDestroy(void);
+/**
+    \fn SpidermonkeyExit
+*/
+bool SpidermonkeyExit(void);
+
+/**
+    \fn parseTinyPyScript
+*/
+bool parseTinyPyScript(const char *name);
+/**
+    \fn interactiveTinyPy
+*/
+bool interactiveTinyPy(void);
+
+
+#endif

Copied: branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/include/ADM_scriptShell.h (from rev 6207, branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/include/ADM_jsShell.h)
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/include/ADM_jsShell.h	2010-05-20 15:22:52 UTC (rev 6207)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/include/ADM_scriptShell.h	2010-05-20 15:22:57 UTC (rev 6208)
@@ -0,0 +1,23 @@
+/**
+    \file ADM_jsShell.h
+    \brief Base class for js interactive shell
+    \author mean, fixounet at free.fr
+*/
+
+/***************************************************************************
+ *                                                                         *
+ *   This program is free software; you can redistribute it and/or modify  *
+ *   it under the terms of the GNU General Public License as published by  *
+ *   the Free Software Foundation; either version 2 of the License, or     *
+ *   (at your option) any later version.                                   *
+ *                                                                         *
+ ***************************************************************************/
+
+#ifndef ADM_JS_SHELL_H
+#define ADM_JS_SHELL_H
+#include "ADM_scriptIf.h"
+typedef bool (jsShellEvaluate)(const char *str);
+bool ADM_startShell(jsShellEvaluate *eval);
+
+
+#endif // ADM_JS_SHELL_H
\ No newline at end of file

Copied: branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/include/ADM_scriptTestFactory.h (from rev 6207, branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/include/ADM_jsTestFactory.h)
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/include/ADM_jsTestFactory.h	2010-05-20 15:22:52 UTC (rev 6207)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/include/ADM_scriptTestFactory.h	2010-05-20 15:22:57 UTC (rev 6208)
@@ -0,0 +1,50 @@
+/**
+    \file ADM_jsTestFactory.h
+    \brief  Simple js hook to test factory
+    \author mean (c) 2009 fixounet at free.fr
+
+
+*/
+/***************************************************************************
+ *                                                                         *
+ *   This program is free software; you can redistribute it and/or modify  *
+ *   it under the terms of the GNU General Public License as published by  *
+ *   the Free Software Foundation; either version 2 of the License, or     *
+ *   (at your option) any later version.                                   *
+ *                                                                         *
+ ***************************************************************************/
+
+#ifndef ADMJS_FACTORY_H
+#define ADMJS_FACTORY_H
+#ifdef __cplusplus
+extern "C"
+{
+#endif
+int jsTestCrash(void);
+int jsTestAssert(void);
+int jsTestFacNotch(void);
+int jsTestFacThreadCount(void);
+int jsTestFacMatrix(void);
+int jsTestFacMatrix(void);
+int jsTestFacHex(void);
+int jsTestFacFrame(void);
+int jsTestFacTab(void);
+int jsTestFacText(void);
+int jsTestFacRoText(void);
+int jsTestFacSlider(void);
+int jsTestFacButton(void);
+int jsTestFacBar(void);
+int jsTestFacBitrate(void);
+int jsTestFacDirSel(void);
+int jsTestFacFile(void);
+int jsTestFacMenu(void);
+int jsTestFacToggle(void);
+int jsTestFacFloat(void);
+int jsTestFacInt(void);
+int jsTestFacEncoding(void);
+#ifdef __cplusplus
+};
+#endif
+
+
+#endif

Copied: branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/include/ADM_scriptVideo.h (from rev 6207, branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/include/ADM_jsVideo.h)
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/include/ADM_jsVideo.h	2010-05-20 15:22:52 UTC (rev 6207)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/include/ADM_scriptVideo.h	2010-05-20 15:22:57 UTC (rev 6208)
@@ -0,0 +1,28 @@
+/**
+    \file ADM_jsVideo
+    \brief Video codec etc..
+*/
+
+/***************************************************************************
+ *                                                                         *
+ *   This program is free software; you can redistribute it and/or modify  *
+ *   it under the terms of the GNU General Public License as published by  *
+ *   the Free Software Foundation; either version 2 of the License, or     *
+ *   (at your option) any later version.                                   *
+ *                                                                         *
+ ***************************************************************************/
+#ifndef ADM_JS_VIDEO_H
+#define ADM_JS_VIDEO_H
+
+#ifdef __cplusplus
+extern "C" {
+#endif
+
+int jsVideoCodec(const char *codec,const char **p);
+int jsSetPostProc (int a,int b, int c);
+
+#ifdef __cplusplus
+};
+#endif
+
+#endif

Deleted: branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/include/adm_scanner.h
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/include/adm_scanner.h	2010-05-20 15:22:52 UTC (rev 6207)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/include/adm_scanner.h	2010-05-20 15:22:57 UTC (rev 6208)
@@ -1,26 +0,0 @@
-/*
-	Type used by scanner
-
-*/
-#ifndef ADMSCANNER
-#define ADMSCANNER
-
-#define ADM_MAX_VAR 50
-//#include "ADM_videoFilter_iface.h"
-
-typedef enum
-{
-	ASC_OK,
-	ASC_UNKNOWN_FUNC,
-	ASC_BAD_NUM_PARAM,
-	ASC_BAD_PARAM,
-	ASC_EXEC_FAILED
-}ASC_ERROR;
-
-//int PushParam(APM_TYPE, char *value);
-int Call(char *string);
-
-
-#endif
-//END
-

Copied: branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/js/ADM_js.h (from rev 6207, branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/include/ADM_js.h)
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/include/ADM_js.h	2010-05-20 15:22:52 UTC (rev 6207)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/js/ADM_js.h	2010-05-20 15:22:57 UTC (rev 6208)
@@ -0,0 +1,51 @@
+/**
+    \file ADM_js
+    \brief Standard includes and defines
+*/
+
+/***************************************************************************
+ *                                                                         *
+ *   This program is free software; you can redistribute it and/or modify  *
+ *   it under the terms of the GNU General Public License as published by  *
+ *   the Free Software Foundation; either version 2 of the License, or     *
+ *   (at your option) any later version.                                   *
+ *                                                                         *
+ ***************************************************************************/
+#ifndef ADM_JS_H
+#define ADM_JS_H
+
+
+#include "ADM_default.h"
+#include <string.h>
+#include <pthread.h>
+#include <vector>
+using std::vector;
+#include "DIA_coreToolkit.h"
+#include "jsapi.h"
+#include "ADM_jsUtils.h"
+#include "ADM_scriptShell.h"
+#include "ADM_scriptDebug.h"
+#include "ADM_jsDFactory.h"
+
+typedef JSBool JS_PROTOTYPE(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval);
+
+
+/**
+    \struct ADM_JS_HOOK
+*/
+typedef struct
+{
+    const char      *name;
+    const char      *text;
+    JSFunctionSpec  *jsFunctions;
+}ADM_JS_HOOK;
+extern vector <ADM_JS_HOOK >jsHooks;
+#if !defined(ADM_JS_THREADSAFE)
+    #define enterLock() {}
+    #define leaveLock() {}
+#else
+    #define enterLock() jsrefcount nRefCount = JS_SuspendRequest(cx)
+    #define leaveLock() {JS_ResumeRequest(cx,nRefCount); }
+#endif
+
+#endif

Copied: branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/js/ADM_jsAvidemux.h (from rev 6207, branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/include/ADM_jsAvidemux.h)
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/include/ADM_jsAvidemux.h	2010-05-20 15:22:52 UTC (rev 6207)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/js/ADM_jsAvidemux.h	2010-05-20 15:22:57 UTC (rev 6208)
@@ -0,0 +1,53 @@
+/**
+    \file ADM_jsAvidemux
+    \brief Standard includes and defines
+*/
+
+/***************************************************************************
+ *                                                                         *
+ *   This program is free software; you can redistribute it and/or modify  *
+ *   it under the terms of the GNU General Public License as published by  *
+ *   the Free Software Foundation; either version 2 of the License, or     *
+ *   (at your option) any later version.                                   *
+ *                                                                         *
+ ***************************************************************************/
+#ifndef ADM_JS_AVIDEMUX_H
+#define ADM_JS_AVIDEMUX_H
+#include "ADM_inttype.h"
+#include "jsapi.h"
+#ifdef __cplusplus
+extern "C" {
+#endif
+
+int jsLoadVideo(const char *c);
+int jsAppendVideo(const char *c);
+int jsClearSegments(void);
+int jsAddSegment(int ref, double start, double duration);
+int jsAudioReset(void);
+int jsAudioMixer(const char *s);
+// Fq
+int32_t jsGetResample(void);
+void    jsSetResample(int32_t fq);
+// Markers
+double jsGetMarkerA(void);
+double jsGetMarkerB(void);
+void   jsSetMarkerA(double a);
+void   jsSetMarkerB(double b);
+//
+int    jsClearVideoFilters();
+// Info
+int jsGetWidth ( void) ;
+int jsGetHeight ( void) ;
+int jsGetFps1000 ( void) ;
+char *jsGetVideoCodec ( void) ;
+
+// non jsapigen function, variables number of args
+JSBool jsAdmaddVideoFilter(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval);
+JSBool jsAdmaudioCodec(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval);
+JSBool jsAdmsetContainer(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval);
+JSBool jsAdmvideoCodec(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval);
+#ifdef __cplusplus
+};
+#endif
+
+#endif

Copied: branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/js/ADM_jsDFactory.h (from rev 6207, branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/include/ADM_jsDFactory.h)
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/include/ADM_jsDFactory.h	2010-05-20 15:22:52 UTC (rev 6207)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/js/ADM_jsDFactory.h	2010-05-20 15:22:57 UTC (rev 6208)
@@ -0,0 +1,21 @@
+/**
+    \file ADM_jsDialogFactory.h
+    \brief Base class for dialog factory mapping
+    \author mean, fixounet at free.fr
+*/
+
+/***************************************************************************
+ *                                                                         *
+ *   This program is free software; you can redistribute it and/or modify  *
+ *   it under the terms of the GNU General Public License as published by  *
+ *   the Free Software Foundation; either version 2 of the License, or     *
+ *   (at your option) any later version.                                   *
+ *                                                                         *
+ ***************************************************************************/
+
+#ifndef ADM_JS_DIALOG_H
+#define ADM_JS_DIALOG_H
+#include "ADM_scriptIf.h"
+extern "C"  JSObject *jsDialogFactoryInit(JSContext *cx,JSObject *obj);
+
+#endif // ADM_JS_SHELL_H

Modified: branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/js/ADM_jsDebug.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/js/ADM_jsDebug.cpp	2010-05-20 15:22:52 UTC (rev 6207)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/js/ADM_jsDebug.cpp	2010-05-20 15:22:57 UTC (rev 6208)
@@ -15,7 +15,7 @@
  ***************************************************************************/
 #include "ADM_js.h"
 #include "ADM_editor/ADM_edit.hxx"
-#include "ADM_jsDebug.h"
+#include "ADM_scriptDebug.h"
 #include <vector>
 /**/
 /**/

Modified: branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/js/ADM_jsEditor.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/js/ADM_jsEditor.cpp	2010-05-20 15:22:52 UTC (rev 6207)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/js/ADM_jsEditor.cpp	2010-05-20 15:22:57 UTC (rev 6208)
@@ -15,7 +15,7 @@
 #include "ADM_js.h"
 #include <stdarg.h>
 #include <vector>
-#include "ADM_jsEditor.h"
+#include "ADM_scriptEditor.h"
 #include "ADM_editor/ADM_edit.hxx"
 extern ADM_Composer *video_body;
 

Modified: branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/js/ADM_jsEditor_js.c
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/js/ADM_jsEditor_js.c	2010-05-20 15:22:52 UTC (rev 6207)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/js/ADM_jsEditor_js.c	2010-05-20 15:22:57 UTC (rev 6208)
@@ -14,7 +14,7 @@
 */
 
 #include "stdio.h"
-#include "ADM_jsEditor.h"
+#include "ADM_scriptEditor.h"
 void jsEditor(void)
 {
         printf("Constructor invoked\n");

Modified: branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/js/ADM_jsIf.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/js/ADM_jsIf.cpp	2010-05-20 15:22:52 UTC (rev 6207)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/js/ADM_jsIf.cpp	2010-05-20 15:22:57 UTC (rev 6208)
@@ -16,11 +16,10 @@
 #include <stdarg.h>
 #include <vector>
 #include "ADM_editor/ADM_edit.hxx"
+#include "DIA_coreToolkit.h"
 void    A_Resync(void);
 
 /* our variables */
-static jsLoggerFunc *jsLogger=NULL;
-static void *jsLoggerCookie=NULL;
 vector <ADM_JS_HOOK >jsHooks;
 extern ADM_Composer *video_body;
 extern bool ADM_JSDialogFactoryInit(JSContext *cx, JSObject *obj);
@@ -70,15 +69,8 @@
 	A_Resync();
 	return g_bJSSuccess;
 }// end parseECMAScript
+
 /**
-    \fn jsLogger
-*/
-bool isJsLogRedirected(void)
-{
-    if(jsLogger) return true;
-    return false;
-}
-/**
     \fn jsEvaluate
 */
 static bool jsEvaluate(const char *str)
@@ -100,48 +92,6 @@
 	return true;
 }
 /**
-    \fn jsLog
-*/
-bool jsLog(JS_LOG_TYPE type, const char *prf,...)
-{
- static char print_buffer[1024];
-  	
-		va_list 	list;
-		va_start(list,	prf);
-		vsnprintf(print_buffer,1023,prf,list);
-		va_end(list);
-		print_buffer[1023]=0; // ensure the string is terminated
-        if(true==isJsLogRedirected())
-            jsLogger(jsLoggerCookie,type,print_buffer);
-        else
-        {
-            if(type==JS_LOG_ERROR)
-                GUI_Error_HIG("Spidermonkey ECMAScript Error","%s",print_buffer);
-            else
-                ADM_warning("[JS]%s\n",print_buffer);
-        }
-
-        return true;
-}
-
-/**
-    \fn ADM_jsRegisterLogger
-*/
-bool ADM_jsRegisterLogger(void *cookie,jsLoggerFunc *fun)
-{
-    jsLoggerCookie=cookie;
-    jsLogger=fun;
-    return true;
-}
-/**
-    \fn ADM_jsUnregisterLogger
-*/
-bool ADM_jsUnregisterLogger(void)
-{
-    jsLogger=NULL;
-    return true;
-}
-/**
     \fn jsRegisterAvidemux
 */
 extern "C" JSFunctionSpec  *jsGetIfFunctions(void);

Modified: branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/js/ADM_jsIf_js.c
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/js/ADM_jsIf_js.c	2010-05-20 15:22:52 UTC (rev 6207)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/js/ADM_jsIf_js.c	2010-05-20 15:22:57 UTC (rev 6208)
@@ -15,7 +15,7 @@
 
 #include "stdio.h"
 #include "ADM_jsAvidemux.h"
-#include "ADM_jsDebug.h"
+#include "ADM_scriptDebug.h"
 
 #ifdef HAVE_ALLOCA_H
 #include <alloca.h>

Modified: branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/js/ADM_jsTestFactory.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/js/ADM_jsTestFactory.cpp	2010-05-20 15:22:52 UTC (rev 6207)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/js/ADM_jsTestFactory.cpp	2010-05-20 15:22:57 UTC (rev 6208)
@@ -17,7 +17,7 @@
 #include "ADM_editor/ADM_edit.hxx"
 #include "DIA_fileSel.h"
 #include "DIA_factory.h"
-#include "ADM_jsTestFactory.h"
+#include "ADM_scriptTestFactory.h"
 #include "DIA_encoding.h"
 
 /**

Modified: branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/js/ADM_jsTestFactory_js.c
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/js/ADM_jsTestFactory_js.c	2010-05-20 15:22:52 UTC (rev 6207)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/js/ADM_jsTestFactory_js.c	2010-05-20 15:22:57 UTC (rev 6208)
@@ -15,7 +15,7 @@
 
 #include "stdio.h"
 #include "ADM_jsAvidemux.h"
-#include "ADM_jsTestFactory.h"
+#include "ADM_scriptTestFactory.h"
 
 #ifdef HAVE_ALLOCA_H
 #include <alloca.h>

Copied: branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/js/ADM_jsUtils.h (from rev 6207, branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/include/ADM_jsUtils.h)
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/include/ADM_jsUtils.h	2010-05-20 15:22:52 UTC (rev 6207)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/js/ADM_jsUtils.h	2010-05-20 15:22:57 UTC (rev 6208)
@@ -0,0 +1,40 @@
+/**
+    \file ADM_jsUtils
+    \brief Simple param -> type utilities
+    \author mean fixounet at free.fr 2009
+*/
+/***************************************************************************
+ *                                                                         *
+ *   This program is free software; you can redistribute it and/or modify  *
+ *   it under the terms of the GNU General Public License as published by  *
+ *   the Free Software Foundation; either version 2 of the License, or     *
+ *   (at your option) any later version.                                   *
+ *                                                                         *
+ ***************************************************************************/
+#ifndef ADM_JS_UTILS_H
+#define ADM_JS_UTILS_H
+#include "ADM_confCouple.h"
+typedef enum
+{
+    ADM_JS_INVALID=0,
+    ADM_JS_UINT32_T=1,
+    ADM_JS_INT32_T,
+    ADM_JS_UINT64_T,
+    ADM_JS_INT64_T,
+    ADM_JS_STRING,
+    ADM_JS_BOOL,
+    ADM_JS_MAX
+}ADM_PARAM_TYPE;
+
+typedef struct
+{
+    ADM_PARAM_TYPE type;
+    void           *value;
+
+}ADM_PARAM_LIST;
+
+// since long int will be coded by js as double, we need a centralized version to convert
+bool ADM_jsArg2Vars(const char *caller, int argc, jsval *argv, int paramNumber, ADM_PARAM_LIST *param);
+bool stringsToConfCouple(int nb,CONFcouple **conf,  const char **argv);
+bool jsArgToConfCouple(int nb,CONFcouple **conf,  jsval *argv);
+#endif

Modified: branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/js/ADM_jsVideo.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/js/ADM_jsVideo.cpp	2010-05-20 15:22:52 UTC (rev 6207)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/js/ADM_jsVideo.cpp	2010-05-20 15:22:57 UTC (rev 6208)
@@ -20,7 +20,7 @@
 #include "ADM_js.h"
 #include "ADM_editor/ADM_edit.hxx"
 #include "ADM_jsAvidemux.h"
-#include "ADM_jsVideo.h"
+#include "ADM_scriptVideo.h"
 #include "A_functions.h"
 #include "ADM_videoEncoderApi.h"
 #include "ADM_videoFilterApi.h"
@@ -28,15 +28,7 @@
 #include "GUI_ui.h"
 extern ADM_Composer *video_body;
 bool A_setVideoCodec(const char *nm);
-/**
-    \fn jsSetPostProc
-*/
-int jsSetPostProc (int a,int b, int c)
-{
-    return video_body->setPostProc(a,b,c);
-}
 
-
 /**
     \fn Codec
     
@@ -94,56 +86,4 @@
         
         return JS_TRUE;
 }// end Codec
-/**
-    \fn A_setVideoCodec
-*/
-bool A_setVideoCodec(const char *nm)
-{
-    int idx=videoEncoder6_GetIndexFromName(nm);
-    if(idx==-1)
-    {
-        ADM_error("No such encoder :%s\n",nm);
-    }
-    // Select by index
-    videoEncoder6_SetCurrentEncoder(idx);
-    UI_setVideoCodec(idx);
-    return true;
-}
-/**
-     \fn jsClearFilters
-*/
-int jsClearVideoFilters()
-{
-    return ADM_vf_clearFilters();
-}
-/**
-    \fn jsGetMarkerA
-*/
-double jsGetMarkerA(void)
-{
-    return (double)video_body->getMarkerAPts();
-
-}
-/**
-    \fn jsGetMarkerB
-*/
-double jsGetMarkerB(void)
-{
-    return (double)video_body->getMarkerBPts();
-}
-/**
-    \fn jsSetMarkerA
-*/
-void   jsSetMarkerA(double a)
-{
-    video_body->setMarkerAPts( (uint64_t)a);
-}
-/**
-    \fn jsGetMarkerB
-*/
-void   jsSetMarkerB(double b)
-{
-    video_body->setMarkerBPts( (uint64_t)b);
-}
-
-//EOF
\ No newline at end of file
+//EOF

Modified: branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/js/CMakeLists.txt
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/js/CMakeLists.txt	2010-05-20 15:22:52 UTC (rev 6207)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/js/CMakeLists.txt	2010-05-20 15:22:57 UTC (rev 6208)
@@ -21,7 +21,9 @@
         ADM_jsAudio.cpp
 )
 
-ADD_LIBRARY(ADM_script26 STATIC ${ADM_script_SRCS})
+ADD_LIBRARY(ADM_jsScript6 STATIC ${ADM_script_SRCS})
 ADD_DEFINITIONS("-DJS_THREADSAFE -DXP_UNIX")
-include_directories(${AVIDEMUX_TOP_SOURCE_DIR}/avidemux/common/ADM_script2/include)
+include_directories(../include)
+include_directories(.)
 include_directories(${AVIDEMUX_TOP_SOURCE_DIR}/avidemux_core/ADM_smjs)
+SUBDIRS(src_dialogFactory)

Copied: branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/js/src_dialogFactory/ADM_JSDF.h (from rev 6207, branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src_dialogFactory/ADM_JSDF.h)
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src_dialogFactory/ADM_JSDF.h	2010-05-20 15:22:52 UTC (rev 6207)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/js/src_dialogFactory/ADM_JSDF.h	2010-05-20 15:22:57 UTC (rev 6208)
@@ -0,0 +1,31 @@
+/**
+    \file   ADM_JSDF.h
+    \brief  JS / DF binding
+    \author gruntster/Mean 2010
+
+
+*/
+/***************************************************************************
+ *                                                                         *
+ *   This program is free software; you can redistribute it and/or modify  *
+ *   it under the terms of the GNU General Public License as published by  *
+ *   the Free Software Foundation; either version 2 of the License, or     *
+ *   (at your option) any later version.                                   *
+ *                                                                         *
+ ***************************************************************************/
+
+#ifndef _ADM_JSDF_H
+#define _ADM_JSDF_H
+
+/**
+    \class ADM_JSBaseHelper
+*/
+class ADM_JSDFBaseHelper
+{
+public:
+                        ADM_JSDFBaseHelper() {};
+    virtual             ~ADM_JSDFBaseHelper() {};
+    virtual diaElem*    getControl(void)=0;
+};
+
+#endif

Copied: branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/js/src_dialogFactory/ADM_JSDFInteger.cpp (from rev 6207, branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src_dialogFactory/ADM_JSDFInteger.cpp)
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src_dialogFactory/ADM_JSDFInteger.cpp	2010-05-20 15:22:52 UTC (rev 6207)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/js/src_dialogFactory/ADM_JSDFInteger.cpp	2010-05-20 15:22:57 UTC (rev 6208)
@@ -0,0 +1,160 @@
+/**
+    \file   ADM_JSDFInteger.cpp
+    \brief  JS / DF binding
+    \author gruntster/mean 2010
+
+
+
+*/
+/***************************************************************************
+ *                                                                         *
+ *   This program is free software; you can redistribute it and/or modify  *
+ *   it under the terms of the GNU General Public License as published by  *
+ *   the Free Software Foundation; either version 2 of the License, or     *
+ *   (at your option) any later version.                                   *
+ *                                                                         *
+ ***************************************************************************/
+#include "ADM_JSDFInteger.h"
+
+ADM_JSDFIntegerHelper::ADM_JSDFIntegerHelper(const char *title,int32_t mn,int32_t mx)
+{
+	_title = ADM_strdup(title); 
+    _min=mn;
+    _max=mx;
+	_value = 0;
+}
+
+ADM_JSDFIntegerHelper::~ADM_JSDFIntegerHelper(void)
+{
+	if (_title)
+		delete _title;
+
+	_title = NULL;
+
+
+}
+
+
+diaElem* ADM_JSDFIntegerHelper::getControl(void)
+{
+    return new diaElemInteger(&_value,_title, _min,_max);
+}
+
+int32_t ADM_JSDFIntegerHelper::value(void)
+{
+	return _value;
+}
+
+void ADM_JSDFIntegerHelper::setValue(int32_t index)
+{
+	_value = index;
+}
+/*************************************************/
+JSPropertySpec ADM_JSDFInteger::properties[] = 
+{ 
+	{ "value", valueProperty, JSPROP_ENUMERATE },
+	{ 0 }
+};
+
+JSFunctionSpec ADM_JSDFInteger::methods[] =
+{
+	{ 0 }
+};
+
+JSClass ADM_JSDFInteger::m_dfIntegerHelper =
+{
+	"DFInteger", JSCLASS_HAS_PRIVATE,
+	JS_PropertyStub, JS_PropertyStub,
+	ADM_JSDFInteger::JSGetProperty, ADM_JSDFInteger::JSSetProperty,
+	JS_EnumerateStub, JS_ResolveStub,
+	JS_ConvertStub, ADM_JSDFInteger::JSDestructor
+};
+
+JSObject *ADM_JSDFInteger::JSInit(JSContext *cx, JSObject *obj, JSObject *proto)
+{
+	return JS_InitClass(cx, obj, proto, &m_dfIntegerHelper, 
+		ADM_JSDFInteger::JSConstructor, 1,
+		ADM_JSDFInteger::properties, ADM_JSDFInteger::methods,
+		NULL, NULL);
+}
+/**
+    \fn ctor
+*/
+JSBool ADM_JSDFInteger::JSConstructor(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval)
+{
+	if (argc != 3)
+		return JS_FALSE;
+
+	if (!JSVAL_IS_STRING(argv[0]))
+		return JS_FALSE;
+
+	if (!JSVAL_IS_INT(argv[1]))
+		return JS_FALSE;
+
+	if (!JSVAL_IS_INT(argv[2]))
+		return JS_FALSE;
+
+
+	ADM_JSDFIntegerHelper *pObject = new ADM_JSDFIntegerHelper(
+                                                    JS_GetStringBytes(JSVAL_TO_STRING(argv[0])),
+                                                    JSVAL_TO_INT(argv[1]),
+                                                    JSVAL_TO_INT(argv[2])
+                                                );
+
+	if (!JS_SetPrivate(cx, obj, pObject))
+		return JS_FALSE;
+
+	*rval = OBJECT_TO_JSVAL(obj);
+
+	return JS_TRUE;
+}
+
+void ADM_JSDFInteger::JSDestructor(JSContext *cx, JSObject *obj)
+{
+	ADM_JSDFIntegerHelper *pObject = (ADM_JSDFIntegerHelper*)JS_GetInstancePrivate(cx, obj, &m_dfIntegerHelper, NULL);
+
+	if (pObject)
+		delete pObject;
+}
+
+JSBool ADM_JSDFInteger::JSGetProperty(JSContext *cx, JSObject *obj, jsval id, jsval *vp)
+{
+	if (JSVAL_IS_INT(id)) 
+	{
+		ADM_JSDFIntegerHelper *pObject = (ADM_JSDFIntegerHelper*)JS_GetInstancePrivate(cx, obj, &m_dfIntegerHelper, NULL);
+
+		switch(JSVAL_TO_INT(id))
+		{
+			case valueProperty:
+			{
+				*vp = INT_TO_JSVAL(pObject->value());
+				break;
+			}
+		}
+	}
+
+	return JS_TRUE;
+}
+
+JSBool ADM_JSDFInteger::JSSetProperty(JSContext *cx, JSObject *obj, jsval id, jsval *vp)
+{
+	if (JSVAL_IS_INT(id)) 
+	{
+		ADM_JSDFIntegerHelper *pObject = (ADM_JSDFIntegerHelper*)JS_GetInstancePrivate(cx, obj, &m_dfIntegerHelper, NULL);
+
+		switch(JSVAL_TO_INT(id))
+		{
+			case valueProperty:
+			{
+				if (JSVAL_IS_INT(*vp))
+					pObject->setValue(JSVAL_TO_INT(*vp));
+
+				break;
+			}
+			default:
+				return JS_FALSE;
+		}
+	}
+
+	return JS_TRUE;
+}

Copied: branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/js/src_dialogFactory/ADM_JSDFInteger.h (from rev 6207, branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src_dialogFactory/ADM_JSDFInteger.h)
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src_dialogFactory/ADM_JSDFInteger.h	2010-05-20 15:22:52 UTC (rev 6207)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/js/src_dialogFactory/ADM_JSDFInteger.h	2010-05-20 15:22:57 UTC (rev 6208)
@@ -0,0 +1,66 @@
+/**
+    \file   ADM_JSDFInteger.h
+    \brief  JS / DF binding
+    \author gruntster/mean 2010
+
+
+*/
+/***************************************************************************
+ *                                                                         *
+ *   This program is free software; you can redistribute it and/or modify  *
+ *   it under the terms of the GNU General Public License as published by  *
+ *   the Free Software Foundation; either version 2 of the License, or     *
+ *   (at your option) any later version.                                   *
+ *                                                                         *
+ ***************************************************************************/
+
+#ifndef _ADM_JSDFInteger_H
+#define _ADM_JSDFInteger_H
+
+#include "jsapi.h"
+#include "DIA_factory.h"
+#include "ADM_JSDF.h"
+/**
+    \class ADM_JSDFIntegerHelper
+*/
+class ADM_JSDFIntegerHelper : public ADM_JSDFBaseHelper
+{
+private:
+	char                *_title;
+	int32_t             _value;
+    int32_t             _min,_max;
+
+public:
+                     ADM_JSDFIntegerHelper(const char *title,int32_t mn, int32_t mx);
+                     ~ADM_JSDFIntegerHelper(void);
+	virtual diaElem* getControl(void);
+            int32_t value(void);
+            void     setValue(int32_t value);
+};
+/**
+    \class ADM_JSDFInteger
+*/
+class ADM_JSDFInteger
+{
+protected:
+    int32_t   minimum,maximum;
+public:
+	ADM_JSDFInteger(int32_t mn,int32_t mx) {minimum=mn;maximum=mx;}
+
+	static JSBool         JSConstructor(JSContext *cx, JSObject *obj, uintN argc, 
+								jsval *argv, jsval *rval);
+	static void           JSDestructor(JSContext *cx, JSObject *obj);
+	static JSObject       *JSInit(JSContext *cx, JSObject *obj, JSObject *proto = NULL);
+	static JSBool         JSGetProperty(JSContext *cx, JSObject *obj, jsval id, jsval *vp);
+	static JSBool         JSSetProperty(JSContext *cx, JSObject *obj, jsval id, jsval *vp);
+	static JSPropertySpec properties[];
+	static JSFunctionSpec methods[];
+	static JSClass        m_dfIntegerHelper;
+
+	enum
+	{
+		valueProperty
+	};
+};
+
+#endif

Copied: branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/js/src_dialogFactory/ADM_JSDFMenu.cpp (from rev 6207, branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src_dialogFactory/ADM_JSDFMenu.cpp)
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src_dialogFactory/ADM_JSDFMenu.cpp	2010-05-20 15:22:52 UTC (rev 6207)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/js/src_dialogFactory/ADM_JSDFMenu.cpp	2010-05-20 15:22:57 UTC (rev 6208)
@@ -0,0 +1,193 @@
+/**
+    \file   ADM_JSDFMenu.cpp
+    \brief  JS / DF binding
+    \author gruntster 2010
+
+
+
+*/
+/***************************************************************************
+ *                                                                         *
+ *   This program is free software; you can redistribute it and/or modify  *
+ *   it under the terms of the GNU General Public License as published by  *
+ *   the Free Software Foundation; either version 2 of the License, or     *
+ *   (at your option) any later version.                                   *
+ *                                                                         *
+ ***************************************************************************/
+#include "ADM_JSDFMenu.h"
+
+ADM_JSDFMenuHelper::ADM_JSDFMenuHelper(const char *title)
+{
+	_title = ADM_strdup(title);
+	_menuEntries = NULL;
+	_index = 0;
+}
+
+ADM_JSDFMenuHelper::~ADM_JSDFMenuHelper(void)
+{
+	if (_title)
+		delete _title;
+
+	_title = NULL;
+
+	std::vector<char*>::iterator it;
+
+	for (it = _items.begin(); it != _items.end(); it++)
+		delete *it;
+
+	_items.clear();
+
+	if (_menuEntries)
+		delete _menuEntries;
+
+	_menuEntries = NULL;
+}
+
+void ADM_JSDFMenuHelper::addItem(const char* item)
+{
+	_items.push_back(ADM_strdup(item));
+}
+
+diaElem* ADM_JSDFMenuHelper::getControl(void)
+{
+	if (_menuEntries)
+		delete _menuEntries;
+
+	std::vector<char*>::iterator it;
+	int i = 0;
+
+	_menuEntries = new diaMenuEntry[_items.size()];	
+
+	for (it = _items.begin(); it != _items.end(); it++)
+	{
+		_menuEntries[i].val = i;
+		_menuEntries[i].text = *it;
+		_menuEntries[i].desc = NULL;
+
+		i++;
+	}
+
+	return new diaElemMenu(&_index, _title, _items.size(), _menuEntries);
+}
+
+int ADM_JSDFMenuHelper::index(void)
+{
+	return _index;
+}
+
+void ADM_JSDFMenuHelper::setIndex(int index)
+{
+	_index = index;
+}
+
+JSPropertySpec ADM_JSDFMenu::properties[] = 
+{ 
+	{ "index", indexProperty, JSPROP_ENUMERATE },
+	{ 0 }
+};
+
+JSFunctionSpec ADM_JSDFMenu::methods[] =
+{
+	{ "addItem", addItem, 1, 0, 0 },
+	{ 0 }
+};
+
+JSClass ADM_JSDFMenu::m_dfMenuHelper =
+{
+	"DFMenu", JSCLASS_HAS_PRIVATE,
+	JS_PropertyStub, JS_PropertyStub,
+	ADM_JSDFMenu::JSGetProperty, ADM_JSDFMenu::JSSetProperty,
+	JS_EnumerateStub, JS_ResolveStub,
+	JS_ConvertStub, ADM_JSDFMenu::JSDestructor
+};
+
+JSObject *ADM_JSDFMenu::JSInit(JSContext *cx, JSObject *obj, JSObject *proto)
+{
+	return JS_InitClass(cx, obj, proto, &m_dfMenuHelper, 
+		ADM_JSDFMenu::JSConstructor, 1,
+		ADM_JSDFMenu::properties, ADM_JSDFMenu::methods,
+		NULL, NULL);
+}
+
+JSBool ADM_JSDFMenu::JSConstructor(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval)
+{
+	if (argc != 1)
+		return JS_FALSE;
+
+	if (!JSVAL_IS_STRING(argv[0]))
+		return JS_FALSE;
+
+	ADM_JSDFMenuHelper *pObject = new ADM_JSDFMenuHelper(JS_GetStringBytes(JSVAL_TO_STRING(argv[0])));
+
+	if (!JS_SetPrivate(cx, obj, pObject))
+		return JS_FALSE;
+
+	*rval = OBJECT_TO_JSVAL(obj);
+
+	return JS_TRUE;
+}
+
+void ADM_JSDFMenu::JSDestructor(JSContext *cx, JSObject *obj)
+{
+	ADM_JSDFMenuHelper *pObject = (ADM_JSDFMenuHelper*)JS_GetInstancePrivate(cx, obj, &m_dfMenuHelper, NULL);
+
+	if (pObject)
+		delete pObject;
+}
+
+JSBool ADM_JSDFMenu::addItem(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval)
+{
+	ADM_JSDFMenuHelper *pObject = (ADM_JSDFMenuHelper*)JS_GetInstancePrivate(cx, obj, &m_dfMenuHelper, NULL);
+
+	if (argc != 1)
+		return JS_FALSE;
+
+	if (!JSVAL_IS_STRING(argv[0]))
+		return JS_FALSE;
+
+	pObject->addItem(JS_GetStringBytes(JSVAL_TO_STRING(argv[0])));
+
+	return JS_TRUE;
+}
+
+JSBool ADM_JSDFMenu::JSGetProperty(JSContext *cx, JSObject *obj, jsval id, jsval *vp)
+{
+	if (JSVAL_IS_INT(id)) 
+	{
+		ADM_JSDFMenuHelper *pObject = (ADM_JSDFMenuHelper*)JS_GetInstancePrivate(cx, obj, &m_dfMenuHelper, NULL);
+
+		switch(JSVAL_TO_INT(id))
+		{
+			case indexProperty:
+			{
+				*vp = INT_TO_JSVAL(pObject->index());
+				break;
+			}
+		}
+	}
+
+	return JS_TRUE;
+}
+
+JSBool ADM_JSDFMenu::JSSetProperty(JSContext *cx, JSObject *obj, jsval id, jsval *vp)
+{
+	if (JSVAL_IS_INT(id)) 
+	{
+		ADM_JSDFMenuHelper *pObject = (ADM_JSDFMenuHelper*)JS_GetInstancePrivate(cx, obj, &m_dfMenuHelper, NULL);
+
+		switch(JSVAL_TO_INT(id))
+		{
+			case indexProperty:
+			{
+				if (JSVAL_IS_INT(*vp))
+					pObject->setIndex(JSVAL_TO_INT(*vp));
+
+				break;
+			}
+			default:
+				return JS_FALSE;
+		}
+	}
+
+	return JS_TRUE;
+}

Copied: branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/js/src_dialogFactory/ADM_JSDFMenu.h (from rev 6207, branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src_dialogFactory/ADM_JSDFMenu.h)
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src_dialogFactory/ADM_JSDFMenu.h	2010-05-20 15:22:52 UTC (rev 6207)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/js/src_dialogFactory/ADM_JSDFMenu.h	2010-05-20 15:22:57 UTC (rev 6208)
@@ -0,0 +1,70 @@
+/**
+    \file   ADM_JSDFMenu.h
+    \brief  JS / DF binding
+    \author gruntster 2010
+
+
+*/
+/***************************************************************************
+ *                                                                         *
+ *   This program is free software; you can redistribute it and/or modify  *
+ *   it under the terms of the GNU General Public License as published by  *
+ *   the Free Software Foundation; either version 2 of the License, or     *
+ *   (at your option) any later version.                                   *
+ *                                                                         *
+ ***************************************************************************/
+
+#ifndef _ADM_JSDFMenu_H
+#define _ADM_JSDFMenu_H
+
+#include "jsapi.h"
+#include "DIA_factory.h"
+#include "ADM_JSDF.h"
+#include <vector>
+/**
+    \class ADM_JSDFMenuHelper
+*/
+class ADM_JSDFMenuHelper : public ADM_JSDFBaseHelper
+{
+private:
+	char                *_title;
+	uint32_t            _index;
+	diaMenuEntry        *_menuEntries;
+	std::vector <char*> _items;
+
+public:
+                     ADM_JSDFMenuHelper(const char *title);
+                     ~ADM_JSDFMenuHelper(void);
+            void     addItem(const char* item);
+	virtual diaElem* getControl(void);
+            int      index(void);
+            void     setIndex(int index);
+};
+/**
+    \class ADM_JSDFMenu
+*/
+class ADM_JSDFMenu
+{
+public:
+	ADM_JSDFMenu(void) {}
+
+	static JSBool   JSConstructor(JSContext *cx, JSObject *obj, uintN argc, 
+								jsval *argv, jsval *rval);
+	static void     JSDestructor(JSContext *cx, JSObject *obj);
+	static JSObject *JSInit(JSContext *cx, JSObject *obj, JSObject *proto = NULL);
+	static JSBool   JSGetProperty(JSContext *cx, JSObject *obj, jsval id, jsval *vp);
+	static JSBool   JSSetProperty(JSContext *cx, JSObject *obj, jsval id, jsval *vp);
+
+	static JSBool   addItem(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval);	
+
+	static JSPropertySpec properties[];
+	static JSFunctionSpec methods[];
+	static JSClass m_dfMenuHelper;
+
+	enum
+	{
+		indexProperty
+	};
+};
+
+#endif

Copied: branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/js/src_dialogFactory/ADM_JSDFToggle.cpp (from rev 6207, branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src_dialogFactory/ADM_JSDFToggle.cpp)
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src_dialogFactory/ADM_JSDFToggle.cpp	2010-05-20 15:22:52 UTC (rev 6207)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/js/src_dialogFactory/ADM_JSDFToggle.cpp	2010-05-20 15:22:57 UTC (rev 6208)
@@ -0,0 +1,147 @@
+/**
+    \file   ADM_JSDFToggle.cpp
+    \brief  JS / DF binding
+    \author gruntster/mean 2010
+
+
+
+*/
+/***************************************************************************
+ *                                                                         *
+ *   This program is free software; you can redistribute it and/or modify  *
+ *   it under the terms of the GNU General Public License as published by  *
+ *   the Free Software Foundation; either version 2 of the License, or     *
+ *   (at your option) any later version.                                   *
+ *                                                                         *
+ ***************************************************************************/
+#include "ADM_JSDFToggle.h"
+
+ADM_JSDFToggleHelper::ADM_JSDFToggleHelper(const char *title)
+{
+	_title = ADM_strdup(title);
+	_value = 0;
+}
+
+ADM_JSDFToggleHelper::~ADM_JSDFToggleHelper(void)
+{
+	if (_title)
+		delete _title;
+
+	_title = NULL;
+
+
+}
+
+
+diaElem* ADM_JSDFToggleHelper::getControl(void)
+{
+    return new   diaElemToggle(&_value,_title,NULL);
+}
+
+uint32_t ADM_JSDFToggleHelper::value(void)
+{
+	return _value;
+}
+
+void ADM_JSDFToggleHelper::setValue(uint32_t index)
+{
+	_value = index;
+}
+/*************************************************/
+JSPropertySpec ADM_JSDFToggle::properties[] = 
+{ 
+	{ "value", valueProperty, JSPROP_ENUMERATE },
+	{ 0 }
+};
+
+JSFunctionSpec ADM_JSDFToggle::methods[] =
+{
+	{ 0 }
+};
+
+JSClass ADM_JSDFToggle::m_dfToggleHelper =
+{
+	"DFToggle", JSCLASS_HAS_PRIVATE,
+	JS_PropertyStub, JS_PropertyStub,
+	ADM_JSDFToggle::JSGetProperty, ADM_JSDFToggle::JSSetProperty,
+	JS_EnumerateStub, JS_ResolveStub,
+	JS_ConvertStub, ADM_JSDFToggle::JSDestructor
+};
+
+JSObject *ADM_JSDFToggle::JSInit(JSContext *cx, JSObject *obj, JSObject *proto)
+{
+	return JS_InitClass(cx, obj, proto, &m_dfToggleHelper, 
+		ADM_JSDFToggle::JSConstructor, 1,
+		ADM_JSDFToggle::properties, ADM_JSDFToggle::methods,
+		NULL, NULL);
+}
+/**
+    \fn ctor
+*/
+JSBool ADM_JSDFToggle::JSConstructor(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval)
+{
+	if (argc != 1)
+		return JS_FALSE;
+
+	if (!JSVAL_IS_STRING(argv[0]))
+		return JS_FALSE;
+
+	ADM_JSDFToggleHelper *pObject = new ADM_JSDFToggleHelper(JS_GetStringBytes(JSVAL_TO_STRING(argv[0])));
+
+	if (!JS_SetPrivate(cx, obj, pObject))
+		return JS_FALSE;
+
+	*rval = OBJECT_TO_JSVAL(obj);
+
+	return JS_TRUE;
+}
+
+void ADM_JSDFToggle::JSDestructor(JSContext *cx, JSObject *obj)
+{
+	ADM_JSDFToggleHelper *pObject = (ADM_JSDFToggleHelper*)JS_GetInstancePrivate(cx, obj, &m_dfToggleHelper, NULL);
+
+	if (pObject)
+		delete pObject;
+}
+
+JSBool ADM_JSDFToggle::JSGetProperty(JSContext *cx, JSObject *obj, jsval id, jsval *vp)
+{
+	if (JSVAL_IS_INT(id)) 
+	{
+		ADM_JSDFToggleHelper *pObject = (ADM_JSDFToggleHelper*)JS_GetInstancePrivate(cx, obj, &m_dfToggleHelper, NULL);
+
+		switch(JSVAL_TO_INT(id))
+		{
+			case valueProperty:
+			{
+				*vp = INT_TO_JSVAL(pObject->value());
+				break;
+			}
+		}
+	}
+
+	return JS_TRUE;
+}
+
+JSBool ADM_JSDFToggle::JSSetProperty(JSContext *cx, JSObject *obj, jsval id, jsval *vp)
+{
+	if (JSVAL_IS_INT(id)) 
+	{
+		ADM_JSDFToggleHelper *pObject = (ADM_JSDFToggleHelper*)JS_GetInstancePrivate(cx, obj, &m_dfToggleHelper, NULL);
+
+		switch(JSVAL_TO_INT(id))
+		{
+			case valueProperty:
+			{
+				if (JSVAL_IS_INT(*vp))
+					pObject->setValue(JSVAL_TO_INT(*vp));
+
+				break;
+			}
+			default:
+				return JS_FALSE;
+		}
+	}
+
+	return JS_TRUE;
+}

Copied: branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/js/src_dialogFactory/ADM_JSDFToggle.h (from rev 6207, branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src_dialogFactory/ADM_JSDFToggle.h)
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src_dialogFactory/ADM_JSDFToggle.h	2010-05-20 15:22:52 UTC (rev 6207)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/js/src_dialogFactory/ADM_JSDFToggle.h	2010-05-20 15:22:57 UTC (rev 6208)
@@ -0,0 +1,63 @@
+/**
+    \file   ADM_JSDFToggle.h
+    \brief  JS / DF binding
+    \author gruntster/mean 2010
+
+
+*/
+/***************************************************************************
+ *                                                                         *
+ *   This program is free software; you can redistribute it and/or modify  *
+ *   it under the terms of the GNU General Public License as published by  *
+ *   the Free Software Foundation; either version 2 of the License, or     *
+ *   (at your option) any later version.                                   *
+ *                                                                         *
+ ***************************************************************************/
+
+#ifndef _ADM_JSDFToggle_H
+#define _ADM_JSDFToggle_H
+
+#include "jsapi.h"
+#include "DIA_factory.h"
+#include "ADM_JSDF.h"
+/**
+    \class ADM_JSDFToggleHelper
+*/
+class ADM_JSDFToggleHelper : public ADM_JSDFBaseHelper
+{
+private:
+	char                *_title;
+	uint32_t            _value;
+
+public:
+                     ADM_JSDFToggleHelper(const char *title);
+                     ~ADM_JSDFToggleHelper(void);
+	virtual diaElem* getControl(void);
+            uint32_t value(void);
+            void     setValue(uint32_t value);
+};
+/**
+    \class ADM_JSDFToggle
+*/
+class ADM_JSDFToggle
+{
+public:
+	ADM_JSDFToggle(void) {}
+
+	static JSBool         JSConstructor(JSContext *cx, JSObject *obj, uintN argc, 
+								jsval *argv, jsval *rval);
+	static void           JSDestructor(JSContext *cx, JSObject *obj);
+	static JSObject       *JSInit(JSContext *cx, JSObject *obj, JSObject *proto = NULL);
+	static JSBool         JSGetProperty(JSContext *cx, JSObject *obj, jsval id, jsval *vp);
+	static JSBool         JSSetProperty(JSContext *cx, JSObject *obj, jsval id, jsval *vp);
+	static JSPropertySpec properties[];
+	static JSFunctionSpec methods[];
+	static JSClass        m_dfToggleHelper;
+
+	enum
+	{
+		valueProperty
+	};
+};
+
+#endif

Copied: branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/js/src_dialogFactory/ADM_JSDialogFactory.cpp (from rev 6207, branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src_dialogFactory/ADM_JSDialogFactory.cpp)
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src_dialogFactory/ADM_JSDialogFactory.cpp	2010-05-20 15:22:52 UTC (rev 6207)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/js/src_dialogFactory/ADM_JSDialogFactory.cpp	2010-05-20 15:22:57 UTC (rev 6208)
@@ -0,0 +1,138 @@
+/**
+    \file   ADM_JSDialogFactory.cpp
+    \brief  JS / DF binding
+    \author gruntster 2010
+
+
+*/
+/***************************************************************************
+ *                                                                         *
+ *   This program is free software; you can redistribute it and/or modify  *
+ *   it under the terms of the GNU General Public License as published by  *
+ *   the Free Software Foundation; either version 2 of the License, or     *
+ *   (at your option) any later version.                                   *
+ *                                                                         *
+ ***************************************************************************/
+#include "ADM_JSDialogFactory.h"
+
+ADM_JSDialogFactoryHelper::ADM_JSDialogFactoryHelper(const char *title)
+{
+	_title = ADM_strdup(title);
+}
+
+ADM_JSDialogFactoryHelper::~ADM_JSDialogFactoryHelper(void)
+{
+	if (_title)
+		delete _title;
+
+	_title = NULL;
+}
+
+void ADM_JSDialogFactoryHelper::addControl(ADM_JSDFBaseHelper* control)
+{
+	_controls.push_back(control);
+}
+
+diaElem** ADM_JSDialogFactoryHelper::getControls(int *controlCount)
+{
+	*controlCount = (int)_controls.size();
+
+	std::vector<ADM_JSDFBaseHelper*>::iterator it;
+	int i = 0;
+	diaElem **elems = new diaElem*[*controlCount];
+
+	for (it = _controls.begin(); it != _controls.end(); it++)
+	{
+		elems[i] = (*it)->getControl();
+		i++;
+	}
+
+	return elems;
+}
+
+const char* ADM_JSDialogFactoryHelper::title(void)
+{
+	return _title;
+}
+
+JSFunctionSpec ADM_JSDialogFactory::methods[] =
+{
+	{ "addControl", addControl, 1, 0, 0 },
+	{ "show", show, 0, 0, 0 },
+	{ 0 }
+};
+
+JSClass ADM_JSDialogFactory::m_dialogFactoryHelper =
+{
+	"DialogFactory", JSCLASS_HAS_PRIVATE,
+	JS_PropertyStub, JS_PropertyStub,
+	JS_PropertyStub, JS_PropertyStub,
+	JS_EnumerateStub, JS_ResolveStub,
+	JS_ConvertStub, ADM_JSDialogFactory::JSDestructor
+};
+
+JSObject *ADM_JSDialogFactory::JSInit(JSContext *cx, JSObject *obj, JSObject *proto)
+{
+	return JS_InitClass(cx, obj, proto, &m_dialogFactoryHelper, 
+		ADM_JSDialogFactory::JSConstructor, 1,
+		NULL, ADM_JSDialogFactory::methods,
+		NULL, NULL);
+}
+
+JSBool ADM_JSDialogFactory::JSConstructor(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval)
+{
+	if (argc != 1)
+		return JS_FALSE;
+
+	if (JSVAL_IS_STRING(argv[0]) == false)
+		return JS_FALSE;
+
+	ADM_JSDialogFactoryHelper *pObject = new ADM_JSDialogFactoryHelper(JS_GetStringBytes(JSVAL_TO_STRING(argv[0])));
+
+	if (!JS_SetPrivate(cx, obj, pObject))
+		return JS_FALSE;
+
+	*rval = OBJECT_TO_JSVAL(obj);
+
+	return JS_TRUE;
+}
+
+void ADM_JSDialogFactory::JSDestructor(JSContext *cx, JSObject *obj)
+{
+	ADM_JSDialogFactoryHelper *pObject = (ADM_JSDialogFactoryHelper*)JS_GetInstancePrivate(cx, obj, &m_dialogFactoryHelper, NULL);
+
+	if (pObject != NULL)
+		delete pObject;
+}
+
+JSBool ADM_JSDialogFactory::addControl(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval)
+{
+	ADM_JSDialogFactoryHelper *p = (ADM_JSDialogFactoryHelper*)JS_GetInstancePrivate(cx, obj, &m_dialogFactoryHelper, NULL);
+
+	if (argc != 1)
+		return JS_FALSE;
+
+	p->addControl((ADM_JSDFMenuHelper*)JS_GetPrivate(cx, JSVAL_TO_OBJECT(argv[0])));
+
+	return JS_TRUE;
+}
+
+JSBool ADM_JSDialogFactory::show(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval)
+{
+	ADM_JSDialogFactoryHelper *p = (ADM_JSDialogFactoryHelper*)JS_GetInstancePrivate(cx, obj, &m_dialogFactoryHelper, NULL);
+
+	if (argc != 0)
+		return JS_FALSE;
+
+	int controlCount;
+	diaElem **elems = p->getControls(&controlCount);
+
+	*rval = BOOLEAN_TO_JSVAL(diaFactoryRun(p->title(), controlCount, elems));
+
+	for (int i = 0; i < controlCount; i++)
+		delete elems[i];
+
+	delete elems;
+
+	return JS_TRUE;
+}

Copied: branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/js/src_dialogFactory/ADM_JSDialogFactory.h (from rev 6207, branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src_dialogFactory/ADM_JSDialogFactory.h)
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src_dialogFactory/ADM_JSDialogFactory.h	2010-05-20 15:22:52 UTC (rev 6207)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/js/src_dialogFactory/ADM_JSDialogFactory.h	2010-05-20 15:22:57 UTC (rev 6208)
@@ -0,0 +1,61 @@
+/**
+    \file   ADM_JSDialogFactory.h
+    \brief  JS / DF binding
+    \author gruntster 2010
+
+
+*/
+/***************************************************************************
+ *                                                                         *
+ *   This program is free software; you can redistribute it and/or modify  *
+ *   it under the terms of the GNU General Public License as published by  *
+ *   the Free Software Foundation; either version 2 of the License, or     *
+ *   (at your option) any later version.                                   *
+ *                                                                         *
+ ***************************************************************************/
+
+#ifndef _ADM_JSDialogFactory_H
+#define _ADM_JSDialogFactory_H
+
+#include "jsapi.h"
+#include "DIA_factory.h"
+#include "ADM_JSDFMenu.h"
+#include <vector>
+/**
+    \class ADM_JSDialogFactoryHelper
+*/
+class ADM_JSDialogFactoryHelper
+{
+private:
+	char* _title;
+	std::vector <ADM_JSDFBaseHelper*> _controls;
+
+public:
+	ADM_JSDialogFactoryHelper(const char *title);
+	~ADM_JSDialogFactoryHelper(void);
+	void addControl(ADM_JSDFBaseHelper* control);
+	diaElem** getControls(int *controlCount);
+	const char* title(void);
+};
+/**
+    \class ADM_JSDialogFactory
+*/
+
+class ADM_JSDialogFactory
+{
+public:
+	ADM_JSDialogFactory(void) {}
+	virtual ~ADM_JSDialogFactory(void);
+
+	static JSBool JSConstructor(JSContext *cx, JSObject *obj, uintN argc, 
+								jsval *argv, jsval *rval);
+	static void JSDestructor(JSContext *cx, JSObject *obj);
+	static JSObject *JSInit(JSContext *cx, JSObject *obj, JSObject *proto = NULL);
+	static JSBool addControl(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval);
+	static JSBool show(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval);
+
+	static JSFunctionSpec methods[];
+	static JSClass m_dialogFactoryHelper;
+};
+
+#endif

Copied: branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/js/src_dialogFactory/ADM_JSDialogFactory_if.cpp (from rev 6207, branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src_dialogFactory/ADM_JSDialogFactory_if.cpp)
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src_dialogFactory/ADM_JSDialogFactory_if.cpp	2010-05-20 15:22:52 UTC (rev 6207)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/js/src_dialogFactory/ADM_JSDialogFactory_if.cpp	2010-05-20 15:22:57 UTC (rev 6208)
@@ -0,0 +1,56 @@
+/**
+    \file   ADM_JSDialogFactory_if.cpp
+    \brief  JS / DF binding
+    \author gruntster, mean (c) 2010
+
+
+    jsapigen does not like much variable number of arguments
+    In that case, we patch the generated file to go back to native spidermonkey api
+
+
+*/
+/***************************************************************************
+ *                                                                         *
+ *   This program is free software; you can redistribute it and/or modify  *
+ *   it under the terms of the GNU General Public License as published by  *
+ *   the Free Software Foundation; either version 2 of the License, or     *
+ *   (at your option) any later version.                                   *
+ *                                                                         *
+ ***************************************************************************/
+#include "ADM_default.h"
+#include "jsapi.h"
+#include "DIA_factory.h"
+#include "ADM_JSDFMenu.h"
+#include "ADM_JSDFToggle.h"
+#include "ADM_JSDFInteger.h"
+#include "ADM_JSDialogFactory.h"
+
+/**
+    \fn ADM_JSDialogFactoryInit()
+    \brief Hook classes to spidermonkey
+*/
+bool ADM_JSDialogFactoryInit(JSContext *cx, JSObject *obj)
+{
+    if(NULL==ADM_JSDialogFactory::JSInit(cx,obj))
+    {
+        ADM_error("Cannot register dialogFactory js class\n");
+        return false;
+    }
+    if(NULL==ADM_JSDFMenu::JSInit(cx,obj))
+    {
+        ADM_error("Cannot register  menu js class\n");
+        return false;
+    }
+    if(NULL==ADM_JSDFToggle::JSInit(cx,obj))
+    {
+        ADM_error("Cannot register toggle js class\n");
+        return false;
+    }
+    if(NULL==ADM_JSDFInteger::JSInit(cx,obj))
+    {
+        ADM_error("Cannot register integer js class\n");
+        return false;
+    }
+    ADM_info("Registered DialogFactory classes\n");
+    return true;
+}
\ No newline at end of file

Copied: branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/js/src_dialogFactory/CMakeLists.txt (from rev 6207, branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src_dialogFactory/CMakeLists.txt)
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src_dialogFactory/CMakeLists.txt	2010-05-20 15:22:52 UTC (rev 6207)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/js/src_dialogFactory/CMakeLists.txt	2010-05-20 15:22:57 UTC (rev 6208)
@@ -0,0 +1,14 @@
+SET(ADM_scriptDF_SRCS
+        ADM_JSDFMenu.cpp
+        ADM_JSDFToggle.cpp
+        ADM_JSDFInteger.cpp
+        ADM_JSDialogFactory.cpp
+        ADM_JSDialogFactory_if.cpp 
+        
+)
+
+ADD_DEFINITIONS("-DJS_THREADSAFE -DXP_UNIX")
+ADD_LIBRARY(ADM_scriptDF STATIC ${ADM_scriptDF_SRCS})
+include_directories(../include)
+include_directories(.)
+include_directories(${AVIDEMUX_TOP_SOURCE_DIR}/avidemux_core/ADM_smjs)

Modified: branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/py/ADM_pyAdm.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/py/ADM_pyAdm.cpp	2010-05-20 15:22:52 UTC (rev 6207)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/py/ADM_pyAdm.cpp	2010-05-20 15:22:57 UTC (rev 6208)
@@ -18,7 +18,7 @@
 #include "ADM_editor/ADM_edit.hxx"
 #include "ADM_coreTinyPy/include/tinypy.h"
 #include "ADM_coreTinyPy/include/ADM_tinypy.h"
-#include "ADM_script2/include/ADM_jsShell.h"
+#include "ADM_script2/include/ADM_scriptShell.h"
 #include "A_functions.h"
 
 #include "adm_gen.h"

Modified: branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/py/CMakeLists.txt
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/py/CMakeLists.txt	2010-05-20 15:22:52 UTC (rev 6207)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/py/CMakeLists.txt	2010-05-20 15:22:57 UTC (rev 6208)
@@ -3,5 +3,7 @@
 )
 
 ADD_LIBRARY(ADM_pyScript6 STATIC ${ADM_script_SRCS})
+ADD_DEFINITIONS(-DCPYTHON_MOD)
 include_directories(../include)
+include_directories(.)
 include_directories(${AVIDEMUX_TOP_SOURCE_DIR}/avidemux_core/ADM_coreTinyPy/include)

Deleted: branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/py/include/ADM_pyIf.h
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/py/include/ADM_pyIf.h	2010-05-20 15:22:52 UTC (rev 6207)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/py/include/ADM_pyIf.h	2010-05-20 15:22:57 UTC (rev 6208)
@@ -1,21 +0,0 @@
-/**
-    \file ADM_pyIf.h
-    \brief Interface for python script 
-    \author mean fixounet at free.fr 2010
-
-*/
-/***************************************************************************
- *                                                                         *
- *   This program is free software; you can redistribute it and/or modify  *
- *   it under the terms of the GNU General Public License as published by  *
- *   the Free Software Foundation; either version 2 of the License, or     *
- *   (at your option) any later version.                                   *
- *                                                                         *
- ***************************************************************************/
-#ifndef ADM_PY_IF_H
-#define ADM_PY_IF_H
-
-bool parseTinyPyScript(const char *name);
-bool interactiveTinyPy(void);
-
-#endif
\ No newline at end of file

Added: branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src/ADM_scriptIf.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src/ADM_scriptIf.cpp	2010-05-20 15:22:52 UTC (rev 6207)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src/ADM_scriptIf.cpp	2010-05-20 15:22:57 UTC (rev 6208)
@@ -0,0 +1,76 @@
+/**
+    \file ADM_JSif.cpp
+    \brief interface to js
+*/
+
+/***************************************************************************
+ *                                                                         *
+ *   This program is free software; you can redistribute it and/or modify  *
+ *   it under the terms of the GNU General Public License as published by  *
+ *   the Free Software Foundation; either version 2 of the License, or     *
+ *   (at your option) any later version.                                   *
+ *                                                                         *
+ ***************************************************************************/
+#include "ADM_default.h"
+#include "ADM_scriptIf.h"
+#include <stdarg.h>
+#include <vector>
+#include "ADM_editor/ADM_edit.hxx"
+#include "DIA_coreToolkit.h"
+void    A_Resync(void);
+
+/* our variables */
+static jsLoggerFunc *jsLogger=NULL;
+static void *jsLoggerCookie=NULL;
+/**
+    \fn jsLogger
+*/
+bool isJsLogRedirected(void)
+{
+    if(jsLogger) return true;
+    return false;
+}
+/**
+    \fn jsLog
+*/
+bool jsLog(JS_LOG_TYPE type, const char *prf,...)
+{
+ static char print_buffer[1024];
+  	
+		va_list 	list;
+		va_start(list,	prf);
+		vsnprintf(print_buffer,1023,prf,list);
+		va_end(list);
+		print_buffer[1023]=0; // ensure the string is terminated
+        if(true==isJsLogRedirected())
+            jsLogger(jsLoggerCookie,type,print_buffer);
+        else
+        {
+            if(type==JS_LOG_ERROR)
+                GUI_Error_HIG("Script Error","%s",print_buffer);
+            else
+                ADM_warning("[JS]%s\n",print_buffer);
+        }
+
+        return true;
+}
+
+/**
+    \fn ADM_jsRegisterLogger
+*/
+bool ADM_jsRegisterLogger(void *cookie,jsLoggerFunc *fun)
+{
+    jsLoggerCookie=cookie;
+    jsLogger=fun;
+    return true;
+}
+/**
+    \fn ADM_jsUnregisterLogger
+*/
+bool ADM_jsUnregisterLogger(void)
+{
+    jsLogger=NULL;
+    return true;
+}
+// EOF
+

Added: branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src/ADM_scriptVideo.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src/ADM_scriptVideo.cpp	2010-05-20 15:22:52 UTC (rev 6207)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src/ADM_scriptVideo.cpp	2010-05-20 15:22:57 UTC (rev 6208)
@@ -0,0 +1,92 @@
+/**
+    \file ADM_jsVideo.cpp
+    \brief Video oriented functions
+    \author mean (c) 2009 fixounet at free.fr
+
+
+    jsapigen does not like much variable number of arguments
+    In that case, we patch the generated file to go back to native spidermonkey api
+
+
+*/
+/***************************************************************************
+ *                                                                         *
+ *   This program is free software; you can redistribute it and/or modify  *
+ *   it under the terms of the GNU General Public License as published by  *
+ *   the Free Software Foundation; either version 2 of the License, or     *
+ *   (at your option) any later version.                                   *
+ *                                                                         *
+ ***************************************************************************/
+//#include "ADM_js.h"
+#include "ADM_editor/ADM_edit.hxx"
+#include "ADM_scriptAvidemux.h"
+#include "ADM_scriptVideo.h"
+#include "A_functions.h"
+#include "ADM_videoEncoderApi.h"
+#include "ADM_videoFilterApi.h"
+#include "ADM_videoFilters.h"
+#include "GUI_ui.h"
+extern ADM_Composer *video_body;
+bool A_setVideoCodec(const char *nm);
+/**
+    \fn jsSetPostProc
+*/
+int jsSetPostProc (int a,int b, int c)
+{
+    return video_body->setPostProc(a,b,c);
+}
+
+
+/**
+    \fn A_setVideoCodec
+*/
+bool A_setVideoCodec(const char *nm)
+{
+    int idx=videoEncoder6_GetIndexFromName(nm);
+    if(idx==-1)
+    {
+        ADM_error("No such encoder :%s\n",nm);
+    }
+    // Select by index
+    videoEncoder6_SetCurrentEncoder(idx);
+    UI_setVideoCodec(idx);
+    return true;
+}
+/**
+     \fn jsClearFilters
+*/
+int jsClearVideoFilters()
+{
+    return ADM_vf_clearFilters();
+}
+/**
+    \fn jsGetMarkerA
+*/
+double jsGetMarkerA(void)
+{
+    return (double)video_body->getMarkerAPts();
+
+}
+/**
+    \fn jsGetMarkerB
+*/
+double jsGetMarkerB(void)
+{
+    return (double)video_body->getMarkerBPts();
+}
+/**
+    \fn jsSetMarkerA
+*/
+void   jsSetMarkerA(double a)
+{
+    video_body->setMarkerAPts( (uint64_t)a);
+}
+/**
+    \fn jsGetMarkerB
+*/
+void   jsSetMarkerB(double b)
+{
+    video_body->setMarkerBPts( (uint64_t)b);
+}
+
+//EOF

Added: branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src/CMakeLists.txt
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src/CMakeLists.txt	2010-05-20 15:22:52 UTC (rev 6207)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src/CMakeLists.txt	2010-05-20 15:22:57 UTC (rev 6208)
@@ -0,0 +1,9 @@
+SET(ADM_script_SRCS
+        ADM_scriptIf.cpp
+        ADM_scriptVideo.cpp
+)
+
+ADD_LIBRARY(ADM_script6 STATIC ${ADM_script_SRCS})
+include_directories(../include)
+include_directories(.)
+include_directories(${AVIDEMUX_TOP_SOURCE_DIR}/avidemux_core/ADM_smjs)

Deleted: branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src_dialogFactory/ADM_JSDF.h
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src_dialogFactory/ADM_JSDF.h	2010-05-20 15:22:52 UTC (rev 6207)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src_dialogFactory/ADM_JSDF.h	2010-05-20 15:22:57 UTC (rev 6208)
@@ -1,31 +0,0 @@
-/**
-    \file   ADM_JSDF.h
-    \brief  JS / DF binding
-    \author gruntster/Mean 2010
-
-
-*/
-/***************************************************************************
- *                                                                         *
- *   This program is free software; you can redistribute it and/or modify  *
- *   it under the terms of the GNU General Public License as published by  *
- *   the Free Software Foundation; either version 2 of the License, or     *
- *   (at your option) any later version.                                   *
- *                                                                         *
- ***************************************************************************/
-
-#ifndef _ADM_JSDF_H
-#define _ADM_JSDF_H
-
-/**
-    \class ADM_JSBaseHelper
-*/
-class ADM_JSDFBaseHelper
-{
-public:
-                        ADM_JSDFBaseHelper() {};
-    virtual             ~ADM_JSDFBaseHelper() {};
-    virtual diaElem*    getControl(void)=0;
-};
-
-#endif

Deleted: branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src_dialogFactory/ADM_JSDFInteger.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src_dialogFactory/ADM_JSDFInteger.cpp	2010-05-20 15:22:52 UTC (rev 6207)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src_dialogFactory/ADM_JSDFInteger.cpp	2010-05-20 15:22:57 UTC (rev 6208)
@@ -1,160 +0,0 @@
-/**
-    \file   ADM_JSDFInteger.cpp
-    \brief  JS / DF binding
-    \author gruntster/mean 2010
-
-
-
-*/
-/***************************************************************************
- *                                                                         *
- *   This program is free software; you can redistribute it and/or modify  *
- *   it under the terms of the GNU General Public License as published by  *
- *   the Free Software Foundation; either version 2 of the License, or     *
- *   (at your option) any later version.                                   *
- *                                                                         *
- ***************************************************************************/
-#include "ADM_JSDFInteger.h"
-
-ADM_JSDFIntegerHelper::ADM_JSDFIntegerHelper(const char *title,int32_t mn,int32_t mx)
-{
-	_title = ADM_strdup(title); 
-    _min=mn;
-    _max=mx;
-	_value = 0;
-}
-
-ADM_JSDFIntegerHelper::~ADM_JSDFIntegerHelper(void)
-{
-	if (_title)
-		delete _title;
-
-	_title = NULL;
-
-
-}
-
-
-diaElem* ADM_JSDFIntegerHelper::getControl(void)
-{
-    return new diaElemInteger(&_value,_title, _min,_max);
-}
-
-int32_t ADM_JSDFIntegerHelper::value(void)
-{
-	return _value;
-}
-
-void ADM_JSDFIntegerHelper::setValue(int32_t index)
-{
-	_value = index;
-}
-/*************************************************/
-JSPropertySpec ADM_JSDFInteger::properties[] = 
-{ 
-	{ "value", valueProperty, JSPROP_ENUMERATE },
-	{ 0 }
-};
-
-JSFunctionSpec ADM_JSDFInteger::methods[] =
-{
-	{ 0 }
-};
-
-JSClass ADM_JSDFInteger::m_dfIntegerHelper =
-{
-	"DFInteger", JSCLASS_HAS_PRIVATE,
-	JS_PropertyStub, JS_PropertyStub,
-	ADM_JSDFInteger::JSGetProperty, ADM_JSDFInteger::JSSetProperty,
-	JS_EnumerateStub, JS_ResolveStub,
-	JS_ConvertStub, ADM_JSDFInteger::JSDestructor
-};
-
-JSObject *ADM_JSDFInteger::JSInit(JSContext *cx, JSObject *obj, JSObject *proto)
-{
-	return JS_InitClass(cx, obj, proto, &m_dfIntegerHelper, 
-		ADM_JSDFInteger::JSConstructor, 1,
-		ADM_JSDFInteger::properties, ADM_JSDFInteger::methods,
-		NULL, NULL);
-}
-/**
-    \fn ctor
-*/
-JSBool ADM_JSDFInteger::JSConstructor(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval)
-{
-	if (argc != 3)
-		return JS_FALSE;
-
-	if (!JSVAL_IS_STRING(argv[0]))
-		return JS_FALSE;
-
-	if (!JSVAL_IS_INT(argv[1]))
-		return JS_FALSE;
-
-	if (!JSVAL_IS_INT(argv[2]))
-		return JS_FALSE;
-
-
-	ADM_JSDFIntegerHelper *pObject = new ADM_JSDFIntegerHelper(
-                                                    JS_GetStringBytes(JSVAL_TO_STRING(argv[0])),
-                                                    JSVAL_TO_INT(argv[1]),
-                                                    JSVAL_TO_INT(argv[2])
-                                                );
-
-	if (!JS_SetPrivate(cx, obj, pObject))
-		return JS_FALSE;
-
-	*rval = OBJECT_TO_JSVAL(obj);
-
-	return JS_TRUE;
-}
-
-void ADM_JSDFInteger::JSDestructor(JSContext *cx, JSObject *obj)
-{
-	ADM_JSDFIntegerHelper *pObject = (ADM_JSDFIntegerHelper*)JS_GetInstancePrivate(cx, obj, &m_dfIntegerHelper, NULL);
-
-	if (pObject)
-		delete pObject;
-}
-
-JSBool ADM_JSDFInteger::JSGetProperty(JSContext *cx, JSObject *obj, jsval id, jsval *vp)
-{
-	if (JSVAL_IS_INT(id)) 
-	{
-		ADM_JSDFIntegerHelper *pObject = (ADM_JSDFIntegerHelper*)JS_GetInstancePrivate(cx, obj, &m_dfIntegerHelper, NULL);
-
-		switch(JSVAL_TO_INT(id))
-		{
-			case valueProperty:
-			{
-				*vp = INT_TO_JSVAL(pObject->value());
-				break;
-			}
-		}
-	}
-
-	return JS_TRUE;
-}
-
-JSBool ADM_JSDFInteger::JSSetProperty(JSContext *cx, JSObject *obj, jsval id, jsval *vp)
-{
-	if (JSVAL_IS_INT(id)) 
-	{
-		ADM_JSDFIntegerHelper *pObject = (ADM_JSDFIntegerHelper*)JS_GetInstancePrivate(cx, obj, &m_dfIntegerHelper, NULL);
-
-		switch(JSVAL_TO_INT(id))
-		{
-			case valueProperty:
-			{
-				if (JSVAL_IS_INT(*vp))
-					pObject->setValue(JSVAL_TO_INT(*vp));
-
-				break;
-			}
-			default:
-				return JS_FALSE;
-		}
-	}
-
-	return JS_TRUE;
-}

Deleted: branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src_dialogFactory/ADM_JSDFInteger.h
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src_dialogFactory/ADM_JSDFInteger.h	2010-05-20 15:22:52 UTC (rev 6207)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src_dialogFactory/ADM_JSDFInteger.h	2010-05-20 15:22:57 UTC (rev 6208)
@@ -1,66 +0,0 @@
-/**
-    \file   ADM_JSDFInteger.h
-    \brief  JS / DF binding
-    \author gruntster/mean 2010
-
-
-*/
-/***************************************************************************
- *                                                                         *
- *   This program is free software; you can redistribute it and/or modify  *
- *   it under the terms of the GNU General Public License as published by  *
- *   the Free Software Foundation; either version 2 of the License, or     *
- *   (at your option) any later version.                                   *
- *                                                                         *
- ***************************************************************************/
-
-#ifndef _ADM_JSDFInteger_H
-#define _ADM_JSDFInteger_H
-
-#include "jsapi.h"
-#include "DIA_factory.h"
-#include "ADM_JSDF.h"
-/**
-    \class ADM_JSDFIntegerHelper
-*/
-class ADM_JSDFIntegerHelper : public ADM_JSDFBaseHelper
-{
-private:
-	char                *_title;
-	int32_t             _value;
-    int32_t             _min,_max;
-
-public:
-                     ADM_JSDFIntegerHelper(const char *title,int32_t mn, int32_t mx);
-                     ~ADM_JSDFIntegerHelper(void);
-	virtual diaElem* getControl(void);
-            int32_t value(void);
-            void     setValue(int32_t value);
-};
-/**
-    \class ADM_JSDFInteger
-*/
-class ADM_JSDFInteger
-{
-protected:
-    int32_t   minimum,maximum;
-public:
-	ADM_JSDFInteger(int32_t mn,int32_t mx) {minimum=mn;maximum=mx;}
-
-	static JSBool         JSConstructor(JSContext *cx, JSObject *obj, uintN argc, 
-								jsval *argv, jsval *rval);
-	static void           JSDestructor(JSContext *cx, JSObject *obj);
-	static JSObject       *JSInit(JSContext *cx, JSObject *obj, JSObject *proto = NULL);
-	static JSBool         JSGetProperty(JSContext *cx, JSObject *obj, jsval id, jsval *vp);
-	static JSBool         JSSetProperty(JSContext *cx, JSObject *obj, jsval id, jsval *vp);
-	static JSPropertySpec properties[];
-	static JSFunctionSpec methods[];
-	static JSClass        m_dfIntegerHelper;
-
-	enum
-	{
-		valueProperty
-	};
-};
-
-#endif

Deleted: branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src_dialogFactory/ADM_JSDFMenu.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src_dialogFactory/ADM_JSDFMenu.cpp	2010-05-20 15:22:52 UTC (rev 6207)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src_dialogFactory/ADM_JSDFMenu.cpp	2010-05-20 15:22:57 UTC (rev 6208)
@@ -1,193 +0,0 @@
-/**
-    \file   ADM_JSDFMenu.cpp
-    \brief  JS / DF binding
-    \author gruntster 2010
-
-
-
-*/
-/***************************************************************************
- *                                                                         *
- *   This program is free software; you can redistribute it and/or modify  *
- *   it under the terms of the GNU General Public License as published by  *
- *   the Free Software Foundation; either version 2 of the License, or     *
- *   (at your option) any later version.                                   *
- *                                                                         *
- ***************************************************************************/
-#include "ADM_JSDFMenu.h"
-
-ADM_JSDFMenuHelper::ADM_JSDFMenuHelper(const char *title)
-{
-	_title = ADM_strdup(title);
-	_menuEntries = NULL;
-	_index = 0;
-}
-
-ADM_JSDFMenuHelper::~ADM_JSDFMenuHelper(void)
-{
-	if (_title)
-		delete _title;
-
-	_title = NULL;
-
-	std::vector<char*>::iterator it;
-
-	for (it = _items.begin(); it != _items.end(); it++)
-		delete *it;
-
-	_items.clear();
-
-	if (_menuEntries)
-		delete _menuEntries;
-
-	_menuEntries = NULL;
-}
-
-void ADM_JSDFMenuHelper::addItem(const char* item)
-{
-	_items.push_back(ADM_strdup(item));
-}
-
-diaElem* ADM_JSDFMenuHelper::getControl(void)
-{
-	if (_menuEntries)
-		delete _menuEntries;
-
-	std::vector<char*>::iterator it;
-	int i = 0;
-
-	_menuEntries = new diaMenuEntry[_items.size()];	
-
-	for (it = _items.begin(); it != _items.end(); it++)
-	{
-		_menuEntries[i].val = i;
-		_menuEntries[i].text = *it;
-		_menuEntries[i].desc = NULL;
-
-		i++;
-	}
-
-	return new diaElemMenu(&_index, _title, _items.size(), _menuEntries);
-}
-
-int ADM_JSDFMenuHelper::index(void)
-{
-	return _index;
-}
-
-void ADM_JSDFMenuHelper::setIndex(int index)
-{
-	_index = index;
-}
-
-JSPropertySpec ADM_JSDFMenu::properties[] = 
-{ 
-	{ "index", indexProperty, JSPROP_ENUMERATE },
-	{ 0 }
-};
-
-JSFunctionSpec ADM_JSDFMenu::methods[] =
-{
-	{ "addItem", addItem, 1, 0, 0 },
-	{ 0 }
-};
-
-JSClass ADM_JSDFMenu::m_dfMenuHelper =
-{
-	"DFMenu", JSCLASS_HAS_PRIVATE,
-	JS_PropertyStub, JS_PropertyStub,
-	ADM_JSDFMenu::JSGetProperty, ADM_JSDFMenu::JSSetProperty,
-	JS_EnumerateStub, JS_ResolveStub,
-	JS_ConvertStub, ADM_JSDFMenu::JSDestructor
-};
-
-JSObject *ADM_JSDFMenu::JSInit(JSContext *cx, JSObject *obj, JSObject *proto)
-{
-	return JS_InitClass(cx, obj, proto, &m_dfMenuHelper, 
-		ADM_JSDFMenu::JSConstructor, 1,
-		ADM_JSDFMenu::properties, ADM_JSDFMenu::methods,
-		NULL, NULL);
-}
-
-JSBool ADM_JSDFMenu::JSConstructor(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval)
-{
-	if (argc != 1)
-		return JS_FALSE;
-
-	if (!JSVAL_IS_STRING(argv[0]))
-		return JS_FALSE;
-
-	ADM_JSDFMenuHelper *pObject = new ADM_JSDFMenuHelper(JS_GetStringBytes(JSVAL_TO_STRING(argv[0])));
-
-	if (!JS_SetPrivate(cx, obj, pObject))
-		return JS_FALSE;
-
-	*rval = OBJECT_TO_JSVAL(obj);
-
-	return JS_TRUE;
-}
-
-void ADM_JSDFMenu::JSDestructor(JSContext *cx, JSObject *obj)
-{
-	ADM_JSDFMenuHelper *pObject = (ADM_JSDFMenuHelper*)JS_GetInstancePrivate(cx, obj, &m_dfMenuHelper, NULL);
-
-	if (pObject)
-		delete pObject;
-}
-
-JSBool ADM_JSDFMenu::addItem(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval)
-{
-	ADM_JSDFMenuHelper *pObject = (ADM_JSDFMenuHelper*)JS_GetInstancePrivate(cx, obj, &m_dfMenuHelper, NULL);
-
-	if (argc != 1)
-		return JS_FALSE;
-
-	if (!JSVAL_IS_STRING(argv[0]))
-		return JS_FALSE;
-
-	pObject->addItem(JS_GetStringBytes(JSVAL_TO_STRING(argv[0])));
-
-	return JS_TRUE;
-}
-
-JSBool ADM_JSDFMenu::JSGetProperty(JSContext *cx, JSObject *obj, jsval id, jsval *vp)
-{
-	if (JSVAL_IS_INT(id)) 
-	{
-		ADM_JSDFMenuHelper *pObject = (ADM_JSDFMenuHelper*)JS_GetInstancePrivate(cx, obj, &m_dfMenuHelper, NULL);
-
-		switch(JSVAL_TO_INT(id))
-		{
-			case indexProperty:
-			{
-				*vp = INT_TO_JSVAL(pObject->index());
-				break;
-			}
-		}
-	}
-
-	return JS_TRUE;
-}
-
-JSBool ADM_JSDFMenu::JSSetProperty(JSContext *cx, JSObject *obj, jsval id, jsval *vp)
-{
-	if (JSVAL_IS_INT(id)) 
-	{
-		ADM_JSDFMenuHelper *pObject = (ADM_JSDFMenuHelper*)JS_GetInstancePrivate(cx, obj, &m_dfMenuHelper, NULL);
-
-		switch(JSVAL_TO_INT(id))
-		{
-			case indexProperty:
-			{
-				if (JSVAL_IS_INT(*vp))
-					pObject->setIndex(JSVAL_TO_INT(*vp));
-
-				break;
-			}
-			default:
-				return JS_FALSE;
-		}
-	}
-
-	return JS_TRUE;
-}

Deleted: branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src_dialogFactory/ADM_JSDFMenu.h
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src_dialogFactory/ADM_JSDFMenu.h	2010-05-20 15:22:52 UTC (rev 6207)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src_dialogFactory/ADM_JSDFMenu.h	2010-05-20 15:22:57 UTC (rev 6208)
@@ -1,70 +0,0 @@
-/**
-    \file   ADM_JSDFMenu.h
-    \brief  JS / DF binding
-    \author gruntster 2010
-
-
-*/
-/***************************************************************************
- *                                                                         *
- *   This program is free software; you can redistribute it and/or modify  *
- *   it under the terms of the GNU General Public License as published by  *
- *   the Free Software Foundation; either version 2 of the License, or     *
- *   (at your option) any later version.                                   *
- *                                                                         *
- ***************************************************************************/
-
-#ifndef _ADM_JSDFMenu_H
-#define _ADM_JSDFMenu_H
-
-#include "jsapi.h"
-#include "DIA_factory.h"
-#include "ADM_JSDF.h"
-#include <vector>
-/**
-    \class ADM_JSDFMenuHelper
-*/
-class ADM_JSDFMenuHelper : public ADM_JSDFBaseHelper
-{
-private:
-	char                *_title;
-	uint32_t            _index;
-	diaMenuEntry        *_menuEntries;
-	std::vector <char*> _items;
-
-public:
-                     ADM_JSDFMenuHelper(const char *title);
-                     ~ADM_JSDFMenuHelper(void);
-            void     addItem(const char* item);
-	virtual diaElem* getControl(void);
-            int      index(void);
-            void     setIndex(int index);
-};
-/**
-    \class ADM_JSDFMenu
-*/
-class ADM_JSDFMenu
-{
-public:
-	ADM_JSDFMenu(void) {}
-
-	static JSBool   JSConstructor(JSContext *cx, JSObject *obj, uintN argc, 
-								jsval *argv, jsval *rval);
-	static void     JSDestructor(JSContext *cx, JSObject *obj);
-	static JSObject *JSInit(JSContext *cx, JSObject *obj, JSObject *proto = NULL);
-	static JSBool   JSGetProperty(JSContext *cx, JSObject *obj, jsval id, jsval *vp);
-	static JSBool   JSSetProperty(JSContext *cx, JSObject *obj, jsval id, jsval *vp);
-
-	static JSBool   addItem(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval);	
-
-	static JSPropertySpec properties[];
-	static JSFunctionSpec methods[];
-	static JSClass m_dfMenuHelper;
-
-	enum
-	{
-		indexProperty
-	};
-};
-
-#endif

Deleted: branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src_dialogFactory/ADM_JSDFToggle.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src_dialogFactory/ADM_JSDFToggle.cpp	2010-05-20 15:22:52 UTC (rev 6207)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src_dialogFactory/ADM_JSDFToggle.cpp	2010-05-20 15:22:57 UTC (rev 6208)
@@ -1,147 +0,0 @@
-/**
-    \file   ADM_JSDFToggle.cpp
-    \brief  JS / DF binding
-    \author gruntster/mean 2010
-
-
-
-*/
-/***************************************************************************
- *                                                                         *
- *   This program is free software; you can redistribute it and/or modify  *
- *   it under the terms of the GNU General Public License as published by  *
- *   the Free Software Foundation; either version 2 of the License, or     *
- *   (at your option) any later version.                                   *
- *                                                                         *
- ***************************************************************************/
-#include "ADM_JSDFToggle.h"
-
-ADM_JSDFToggleHelper::ADM_JSDFToggleHelper(const char *title)
-{
-	_title = ADM_strdup(title);
-	_value = 0;
-}
-
-ADM_JSDFToggleHelper::~ADM_JSDFToggleHelper(void)
-{
-	if (_title)
-		delete _title;
-
-	_title = NULL;
-
-
-}
-
-
-diaElem* ADM_JSDFToggleHelper::getControl(void)
-{
-    return new   diaElemToggle(&_value,_title,NULL);
-}
-
-uint32_t ADM_JSDFToggleHelper::value(void)
-{
-	return _value;
-}
-
-void ADM_JSDFToggleHelper::setValue(uint32_t index)
-{
-	_value = index;
-}
-/*************************************************/
-JSPropertySpec ADM_JSDFToggle::properties[] = 
-{ 
-	{ "value", valueProperty, JSPROP_ENUMERATE },
-	{ 0 }
-};
-
-JSFunctionSpec ADM_JSDFToggle::methods[] =
-{
-	{ 0 }
-};
-
-JSClass ADM_JSDFToggle::m_dfToggleHelper =
-{
-	"DFToggle", JSCLASS_HAS_PRIVATE,
-	JS_PropertyStub, JS_PropertyStub,
-	ADM_JSDFToggle::JSGetProperty, ADM_JSDFToggle::JSSetProperty,
-	JS_EnumerateStub, JS_ResolveStub,
-	JS_ConvertStub, ADM_JSDFToggle::JSDestructor
-};
-
-JSObject *ADM_JSDFToggle::JSInit(JSContext *cx, JSObject *obj, JSObject *proto)
-{
-	return JS_InitClass(cx, obj, proto, &m_dfToggleHelper, 
-		ADM_JSDFToggle::JSConstructor, 1,
-		ADM_JSDFToggle::properties, ADM_JSDFToggle::methods,
-		NULL, NULL);
-}
-/**
-    \fn ctor
-*/
-JSBool ADM_JSDFToggle::JSConstructor(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval)
-{
-	if (argc != 1)
-		return JS_FALSE;
-
-	if (!JSVAL_IS_STRING(argv[0]))
-		return JS_FALSE;
-
-	ADM_JSDFToggleHelper *pObject = new ADM_JSDFToggleHelper(JS_GetStringBytes(JSVAL_TO_STRING(argv[0])));
-
-	if (!JS_SetPrivate(cx, obj, pObject))
-		return JS_FALSE;
-
-	*rval = OBJECT_TO_JSVAL(obj);
-
-	return JS_TRUE;
-}
-
-void ADM_JSDFToggle::JSDestructor(JSContext *cx, JSObject *obj)
-{
-	ADM_JSDFToggleHelper *pObject = (ADM_JSDFToggleHelper*)JS_GetInstancePrivate(cx, obj, &m_dfToggleHelper, NULL);
-
-	if (pObject)
-		delete pObject;
-}
-
-JSBool ADM_JSDFToggle::JSGetProperty(JSContext *cx, JSObject *obj, jsval id, jsval *vp)
-{
-	if (JSVAL_IS_INT(id)) 
-	{
-		ADM_JSDFToggleHelper *pObject = (ADM_JSDFToggleHelper*)JS_GetInstancePrivate(cx, obj, &m_dfToggleHelper, NULL);
-
-		switch(JSVAL_TO_INT(id))
-		{
-			case valueProperty:
-			{
-				*vp = INT_TO_JSVAL(pObject->value());
-				break;
-			}
-		}
-	}
-
-	return JS_TRUE;
-}
-
-JSBool ADM_JSDFToggle::JSSetProperty(JSContext *cx, JSObject *obj, jsval id, jsval *vp)
-{
-	if (JSVAL_IS_INT(id)) 
-	{
-		ADM_JSDFToggleHelper *pObject = (ADM_JSDFToggleHelper*)JS_GetInstancePrivate(cx, obj, &m_dfToggleHelper, NULL);
-
-		switch(JSVAL_TO_INT(id))
-		{
-			case valueProperty:
-			{
-				if (JSVAL_IS_INT(*vp))
-					pObject->setValue(JSVAL_TO_INT(*vp));
-
-				break;
-			}
-			default:
-				return JS_FALSE;
-		}
-	}
-
-	return JS_TRUE;
-}

Deleted: branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src_dialogFactory/ADM_JSDFToggle.h
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src_dialogFactory/ADM_JSDFToggle.h	2010-05-20 15:22:52 UTC (rev 6207)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src_dialogFactory/ADM_JSDFToggle.h	2010-05-20 15:22:57 UTC (rev 6208)
@@ -1,63 +0,0 @@
-/**
-    \file   ADM_JSDFToggle.h
-    \brief  JS / DF binding
-    \author gruntster/mean 2010
-
-
-*/
-/***************************************************************************
- *                                                                         *
- *   This program is free software; you can redistribute it and/or modify  *
- *   it under the terms of the GNU General Public License as published by  *
- *   the Free Software Foundation; either version 2 of the License, or     *
- *   (at your option) any later version.                                   *
- *                                                                         *
- ***************************************************************************/
-
-#ifndef _ADM_JSDFToggle_H
-#define _ADM_JSDFToggle_H
-
-#include "jsapi.h"
-#include "DIA_factory.h"
-#include "ADM_JSDF.h"
-/**
-    \class ADM_JSDFToggleHelper
-*/
-class ADM_JSDFToggleHelper : public ADM_JSDFBaseHelper
-{
-private:
-	char                *_title;
-	uint32_t            _value;
-
-public:
-                     ADM_JSDFToggleHelper(const char *title);
-                     ~ADM_JSDFToggleHelper(void);
-	virtual diaElem* getControl(void);
-            uint32_t value(void);
-            void     setValue(uint32_t value);
-};
-/**
-    \class ADM_JSDFToggle
-*/
-class ADM_JSDFToggle
-{
-public:
-	ADM_JSDFToggle(void) {}
-
-	static JSBool         JSConstructor(JSContext *cx, JSObject *obj, uintN argc, 
-								jsval *argv, jsval *rval);
-	static void           JSDestructor(JSContext *cx, JSObject *obj);
-	static JSObject       *JSInit(JSContext *cx, JSObject *obj, JSObject *proto = NULL);
-	static JSBool         JSGetProperty(JSContext *cx, JSObject *obj, jsval id, jsval *vp);
-	static JSBool         JSSetProperty(JSContext *cx, JSObject *obj, jsval id, jsval *vp);
-	static JSPropertySpec properties[];
-	static JSFunctionSpec methods[];
-	static JSClass        m_dfToggleHelper;
-
-	enum
-	{
-		valueProperty
-	};
-};
-
-#endif

Deleted: branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src_dialogFactory/ADM_JSDialogFactory.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src_dialogFactory/ADM_JSDialogFactory.cpp	2010-05-20 15:22:52 UTC (rev 6207)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src_dialogFactory/ADM_JSDialogFactory.cpp	2010-05-20 15:22:57 UTC (rev 6208)
@@ -1,138 +0,0 @@
-/**
-    \file   ADM_JSDialogFactory.cpp
-    \brief  JS / DF binding
-    \author gruntster 2010
-
-
-*/
-/***************************************************************************
- *                                                                         *
- *   This program is free software; you can redistribute it and/or modify  *
- *   it under the terms of the GNU General Public License as published by  *
- *   the Free Software Foundation; either version 2 of the License, or     *
- *   (at your option) any later version.                                   *
- *                                                                         *
- ***************************************************************************/
-#include "ADM_JSDialogFactory.h"
-
-ADM_JSDialogFactoryHelper::ADM_JSDialogFactoryHelper(const char *title)
-{
-	_title = ADM_strdup(title);
-}
-
-ADM_JSDialogFactoryHelper::~ADM_JSDialogFactoryHelper(void)
-{
-	if (_title)
-		delete _title;
-
-	_title = NULL;
-}
-
-void ADM_JSDialogFactoryHelper::addControl(ADM_JSDFBaseHelper* control)
-{
-	_controls.push_back(control);
-}
-
-diaElem** ADM_JSDialogFactoryHelper::getControls(int *controlCount)
-{
-	*controlCount = (int)_controls.size();
-
-	std::vector<ADM_JSDFBaseHelper*>::iterator it;
-	int i = 0;
-	diaElem **elems = new diaElem*[*controlCount];
-
-	for (it = _controls.begin(); it != _controls.end(); it++)
-	{
-		elems[i] = (*it)->getControl();
-		i++;
-	}
-
-	return elems;
-}
-
-const char* ADM_JSDialogFactoryHelper::title(void)
-{
-	return _title;
-}
-
-JSFunctionSpec ADM_JSDialogFactory::methods[] =
-{
-	{ "addControl", addControl, 1, 0, 0 },
-	{ "show", show, 0, 0, 0 },
-	{ 0 }
-};
-
-JSClass ADM_JSDialogFactory::m_dialogFactoryHelper =
-{
-	"DialogFactory", JSCLASS_HAS_PRIVATE,
-	JS_PropertyStub, JS_PropertyStub,
-	JS_PropertyStub, JS_PropertyStub,
-	JS_EnumerateStub, JS_ResolveStub,
-	JS_ConvertStub, ADM_JSDialogFactory::JSDestructor
-};
-
-JSObject *ADM_JSDialogFactory::JSInit(JSContext *cx, JSObject *obj, JSObject *proto)
-{
-	return JS_InitClass(cx, obj, proto, &m_dialogFactoryHelper, 
-		ADM_JSDialogFactory::JSConstructor, 1,
-		NULL, ADM_JSDialogFactory::methods,
-		NULL, NULL);
-}
-
-JSBool ADM_JSDialogFactory::JSConstructor(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval)
-{
-	if (argc != 1)
-		return JS_FALSE;
-
-	if (JSVAL_IS_STRING(argv[0]) == false)
-		return JS_FALSE;
-
-	ADM_JSDialogFactoryHelper *pObject = new ADM_JSDialogFactoryHelper(JS_GetStringBytes(JSVAL_TO_STRING(argv[0])));
-
-	if (!JS_SetPrivate(cx, obj, pObject))
-		return JS_FALSE;
-
-	*rval = OBJECT_TO_JSVAL(obj);
-
-	return JS_TRUE;
-}
-
-void ADM_JSDialogFactory::JSDestructor(JSContext *cx, JSObject *obj)
-{
-	ADM_JSDialogFactoryHelper *pObject = (ADM_JSDialogFactoryHelper*)JS_GetInstancePrivate(cx, obj, &m_dialogFactoryHelper, NULL);
-
-	if (pObject != NULL)
-		delete pObject;
-}
-
-JSBool ADM_JSDialogFactory::addControl(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval)
-{
-	ADM_JSDialogFactoryHelper *p = (ADM_JSDialogFactoryHelper*)JS_GetInstancePrivate(cx, obj, &m_dialogFactoryHelper, NULL);
-
-	if (argc != 1)
-		return JS_FALSE;
-
-	p->addControl((ADM_JSDFMenuHelper*)JS_GetPrivate(cx, JSVAL_TO_OBJECT(argv[0])));
-
-	return JS_TRUE;
-}
-
-JSBool ADM_JSDialogFactory::show(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval)
-{
-	ADM_JSDialogFactoryHelper *p = (ADM_JSDialogFactoryHelper*)JS_GetInstancePrivate(cx, obj, &m_dialogFactoryHelper, NULL);
-
-	if (argc != 0)
-		return JS_FALSE;
-
-	int controlCount;
-	diaElem **elems = p->getControls(&controlCount);
-
-	*rval = BOOLEAN_TO_JSVAL(diaFactoryRun(p->title(), controlCount, elems));
-
-	for (int i = 0; i < controlCount; i++)
-		delete elems[i];
-
-	delete elems;
-
-	return JS_TRUE;
-}

Deleted: branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src_dialogFactory/ADM_JSDialogFactory.h
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src_dialogFactory/ADM_JSDialogFactory.h	2010-05-20 15:22:52 UTC (rev 6207)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src_dialogFactory/ADM_JSDialogFactory.h	2010-05-20 15:22:57 UTC (rev 6208)
@@ -1,61 +0,0 @@
-/**
-    \file   ADM_JSDialogFactory.h
-    \brief  JS / DF binding
-    \author gruntster 2010
-
-
-*/
-/***************************************************************************
- *                                                                         *
- *   This program is free software; you can redistribute it and/or modify  *
- *   it under the terms of the GNU General Public License as published by  *
- *   the Free Software Foundation; either version 2 of the License, or     *
- *   (at your option) any later version.                                   *
- *                                                                         *
- ***************************************************************************/
-
-#ifndef _ADM_JSDialogFactory_H
-#define _ADM_JSDialogFactory_H
-
-#include "jsapi.h"
-#include "DIA_factory.h"
-#include "ADM_JSDFMenu.h"
-#include <vector>
-/**
-    \class ADM_JSDialogFactoryHelper
-*/
-class ADM_JSDialogFactoryHelper
-{
-private:
-	char* _title;
-	std::vector <ADM_JSDFBaseHelper*> _controls;
-
-public:
-	ADM_JSDialogFactoryHelper(const char *title);
-	~ADM_JSDialogFactoryHelper(void);
-	void addControl(ADM_JSDFBaseHelper* control);
-	diaElem** getControls(int *controlCount);
-	const char* title(void);
-};
-/**
-    \class ADM_JSDialogFactory
-*/
-
-class ADM_JSDialogFactory
-{
-public:
-	ADM_JSDialogFactory(void) {}
-	virtual ~ADM_JSDialogFactory(void);
-
-	static JSBool JSConstructor(JSContext *cx, JSObject *obj, uintN argc, 
-								jsval *argv, jsval *rval);
-	static void JSDestructor(JSContext *cx, JSObject *obj);
-	static JSObject *JSInit(JSContext *cx, JSObject *obj, JSObject *proto = NULL);
-	static JSBool addControl(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval);
-	static JSBool show(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval);
-
-	static JSFunctionSpec methods[];
-	static JSClass m_dialogFactoryHelper;
-};
-
-#endif

Deleted: branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src_dialogFactory/ADM_JSDialogFactory_if.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src_dialogFactory/ADM_JSDialogFactory_if.cpp	2010-05-20 15:22:52 UTC (rev 6207)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src_dialogFactory/ADM_JSDialogFactory_if.cpp	2010-05-20 15:22:57 UTC (rev 6208)
@@ -1,56 +0,0 @@
-/**
-    \file   ADM_JSDialogFactory_if.cpp
-    \brief  JS / DF binding
-    \author gruntster, mean (c) 2010
-
-
-    jsapigen does not like much variable number of arguments
-    In that case, we patch the generated file to go back to native spidermonkey api
-
-
-*/
-/***************************************************************************
- *                                                                         *
- *   This program is free software; you can redistribute it and/or modify  *
- *   it under the terms of the GNU General Public License as published by  *
- *   the Free Software Foundation; either version 2 of the License, or     *
- *   (at your option) any later version.                                   *
- *                                                                         *
- ***************************************************************************/
-#include "ADM_default.h"
-#include "jsapi.h"
-#include "DIA_factory.h"
-#include "ADM_JSDFMenu.h"
-#include "ADM_JSDFToggle.h"
-#include "ADM_JSDFInteger.h"
-#include "ADM_JSDialogFactory.h"
-
-/**
-    \fn ADM_JSDialogFactoryInit()
-    \brief Hook classes to spidermonkey
-*/
-bool ADM_JSDialogFactoryInit(JSContext *cx, JSObject *obj)
-{
-    if(NULL==ADM_JSDialogFactory::JSInit(cx,obj))
-    {
-        ADM_error("Cannot register dialogFactory js class\n");
-        return false;
-    }
-    if(NULL==ADM_JSDFMenu::JSInit(cx,obj))
-    {
-        ADM_error("Cannot register  menu js class\n");
-        return false;
-    }
-    if(NULL==ADM_JSDFToggle::JSInit(cx,obj))
-    {
-        ADM_error("Cannot register toggle js class\n");
-        return false;
-    }
-    if(NULL==ADM_JSDFInteger::JSInit(cx,obj))
-    {
-        ADM_error("Cannot register integer js class\n");
-        return false;
-    }
-    ADM_info("Registered DialogFactory classes\n");
-    return true;
-}
\ No newline at end of file

Deleted: branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src_dialogFactory/CMakeLists.txt
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src_dialogFactory/CMakeLists.txt	2010-05-20 15:22:52 UTC (rev 6207)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src_dialogFactory/CMakeLists.txt	2010-05-20 15:22:57 UTC (rev 6208)
@@ -1,14 +0,0 @@
-SET(ADM_scriptDF_SRCS
-        ADM_JSDFMenu.cpp
-        ADM_JSDFToggle.cpp
-        ADM_JSDFInteger.cpp
-        ADM_JSDialogFactory.cpp
-        ADM_JSDialogFactory_if.cpp 
-        
-)
-
-ADD_DEFINITIONS("-DJS_THREADSAFE -DXP_UNIX")
-ADD_LIBRARY(ADM_scriptDF STATIC ${ADM_scriptDF_SRCS})
-include_directories(../include)
-include_directories(.)
-include_directories(${AVIDEMUX_TOP_SOURCE_DIR}/avidemux_core/ADM_smjs)

Modified: branches/avidemux_2.6_branch_mean/avidemux/common/gtk_gui.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/gtk_gui.cpp	2010-05-20 15:22:52 UTC (rev 6207)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/gtk_gui.cpp	2010-05-20 15:22:57 UTC (rev 6208)
@@ -40,8 +40,7 @@
 
 #include "avi_vars.h"
 #include "prototype.h" // FIXME
-#include "ADM_script2/include/ADM_jsIf.h"
-#include "ADM_pyScript/include/ADM_pyIf.h"
+#include "ADM_script2/include/ADM_scriptIf.h"
 renderZoom currentZoom=ZOOM_1_1;
 //***********************************
 //******** A Function ***************

Modified: branches/avidemux_2.6_branch_mean/avidemux/common/main.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/main.cpp	2010-05-20 15:22:52 UTC (rev 6207)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/main.cpp	2010-05-20 15:22:57 UTC (rev 6208)
@@ -49,7 +49,7 @@
 #include "ADM_render/GUI_sdlRender.h"
 #endif
 
-#include "ADM_script2/include/ADM_jsIf.h"
+#include "ADM_script2/include/ADM_scriptIf.h"
 void onexit( void );
 //extern void automation(int argc, char **argv);
 

Modified: branches/avidemux_2.6_branch_mean/avidemux/commonCmakeApplication.cmake
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/commonCmakeApplication.cmake	2010-05-20 15:22:52 UTC (rev 6207)
+++ branches/avidemux_2.6_branch_mean/avidemux/commonCmakeApplication.cmake	2010-05-20 15:22:57 UTC (rev 6208)
@@ -97,9 +97,10 @@
 #ADM_filter6 
 ADM_osSupport6 
 ADM_requant6 
-#ADM_script6 
-ADM_script26 
-ADM_scriptDF
+ADM_script6 
+ADM_pyScript6 
+ADM_jsScript6 
+#ADM_scriptDF
 ADM_videoEncoder6 
 ADM_internalVideoFilter6
 ADM_toolkit6

Modified: branches/avidemux_2.6_branch_mean/avidemux/qt4/ADM_userInterfaces/ADM_shell/Q_shell.h
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/qt4/ADM_userInterfaces/ADM_shell/Q_shell.h	2010-05-20 15:22:52 UTC (rev 6207)
+++ branches/avidemux_2.6_branch_mean/avidemux/qt4/ADM_userInterfaces/ADM_shell/Q_shell.h	2010-05-20 15:22:57 UTC (rev 6208)
@@ -6,7 +6,7 @@
 #include "ADM_inttype.h"
 #include <QtGui/QItemDelegate>
 #include "ui_shell.h"
-#include "ADM_jsShell.h"
+#include "ADM_scriptShell.h"
 /**
     \class ADM_jsQt4Shell
 */



From mean at mail.berlios.de  Thu May 20 17:23:02 2010
From: mean at mail.berlios.de (mean at BerliOS)
Date: Thu, 20 May 2010 17:23:02 +0200
Subject: [Avidemux-svn-commit] r6209 - in branches/avidemux_2.6_branch_mean:
	avidemux avidemux/common/ADM_script2/include
	avidemux/common/ADM_script2/js avidemux/common/ADM_script2/py
	avidemux/common/ADM_script2/src cmake
Message-ID: <201005201523.o4KFN2VR014370@sheep.berlios.de>

Author: mean
Date: 2010-05-20 17:23:01 +0200 (Thu, 20 May 2010)
New Revision: 6209

Added:
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/include/ADM_scriptCommon.h
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src/ADM_scriptAudio.cpp
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src/ADM_scriptAvidemux.cpp
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src/ADM_scriptAvidemuxInfo.cpp
Removed:
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/js/ADM_jsAvidemuxInfo.cpp
Modified:
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/js/ADM_jsAudio.cpp
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/js/ADM_jsAvidemux.cpp
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/js/ADM_jsAvidemux.h
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/js/CMakeLists.txt
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/py/ADM_pyAdm.cpp
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/py/adm.admPy
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/py/adm_gen.cpp
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/py/adm_gen.h
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src/ADM_scriptVideo.cpp
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src/CMakeLists.txt
   branches/avidemux_2.6_branch_mean/avidemux/commonCmakeApplication.cmake
   branches/avidemux_2.6_branch_mean/cmake/admPy.pl
Log:
[script] Unify js and py

Copied: branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/include/ADM_scriptCommon.h (from rev 6208, branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/js/ADM_jsAvidemux.h)
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/js/ADM_jsAvidemux.h	2010-05-20 15:22:57 UTC (rev 6208)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/include/ADM_scriptCommon.h	2010-05-20 15:23:01 UTC (rev 6209)
@@ -0,0 +1,42 @@
+/**
+    \file ADM_jsAvidemux
+    \brief Standard includes and defines
+*/
+
+/***************************************************************************
+ *                                                                         *
+ *   This program is free software; you can redistribute it and/or modify  *
+ *   it under the terms of the GNU General Public License as published by  *
+ *   the Free Software Foundation; either version 2 of the License, or     *
+ *   (at your option) any later version.                                   *
+ *                                                                         *
+ ***************************************************************************/
+#ifdef __cplusplus
+extern "C" {
+#endif
+
+int jsLoadVideo(const char *c);
+int jsAppendVideo(const char *c);
+int jsClearSegments(void);
+int jsAddSegment(int ref, double start, double duration);
+int jsAudioReset(void);
+int jsAudioMixer(const char *s);
+// Fq
+int32_t jsGetResample(void);
+void    jsSetResample(int32_t fq);
+// Markers
+double jsGetMarkerA(void);
+double jsGetMarkerB(void);
+void   jsSetMarkerA(double a);
+void   jsSetMarkerB(double b);
+//
+int    jsClearVideoFilters();
+// Info
+int jsGetWidth ( void) ;
+int jsGetHeight ( void) ;
+int jsGetFps1000 ( void) ;
+char *jsGetVideoCodec ( void) ;
+
+#ifdef __cplusplus
+};
+#endif 

Modified: branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/js/ADM_jsAudio.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/js/ADM_jsAudio.cpp	2010-05-20 15:22:57 UTC (rev 6208)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/js/ADM_jsAudio.cpp	2010-05-20 15:23:01 UTC (rev 6209)
@@ -25,15 +25,8 @@
 #include "ADM_audioFilterInterface.h"
 #include "audioEncoderApi.h"
 extern ADM_Composer *video_body;
+
 /**
-    \fn int jsAudioReset(void);
-*/
-int jsAudioReset (void)
-{
-    audioFilterReset();
-    return 1;
-}
-/**
     \fn 
 */  
 extern "C" int   jsAudioCodec(const char *a,const char **b) {return 0;}
@@ -75,26 +68,4 @@
         
         return JS_TRUE;
 }
-/**
-    \fn jsAudioMixer
-*/
-int jsAudioMixer(const char *s)
-{
-    CHANNEL_CONF c=AudioMuxerStringToId(s);
-    return audioFilterSetMixer(c);
-}
-/**
-    \fn jsGetResample
-*/
-int32_t jsGetResample(void)
-{
-    return 0;
-}
-/**
-    \fn jsSetResample
-*/
-void    jsSetResample(int32_t fq)
-{
-
-}
-//EOF
\ No newline at end of file
+//EOF

Modified: branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/js/ADM_jsAvidemux.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/js/ADM_jsAvidemux.cpp	2010-05-20 15:22:57 UTC (rev 6208)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/js/ADM_jsAvidemux.cpp	2010-05-20 15:23:01 UTC (rev 6209)
@@ -20,81 +20,8 @@
 #include "ADM_muxerProto.h"
 #include "GUI_ui.h"
 extern ADM_Composer *video_body;
+bool A_setContainer(const char *cont);
 /**
-    \fn ADM_JSAvidemux
-    \brief Select the current container from a string
-*/
-bool A_setContainer(const char *cont)
-{
-    int idx=ADM_MuxerIndexFromName(cont);
-    if(idx==-1)
-    {
-        ADM_error("Cannot find muxer for format=%s\n",cont);
-        return false;
-    }
-    ADM_info("setting container as index %d\n",idx);
-    UI_SetCurrentFormat(idx);
-    return true;
-}
-
-/**
-    \fn jsLoadFile
-*/
-int jsLoadVideo(const char *s)
-{
-int ret=0;
-        jsLog(JS_LOG_NORMAL,"[Js] Loading video %s",s);
-        if(A_openAvi(s)) 
-        {
-          ret=1;
-        }
-        
-    return ret;
-}
-
-/**
-    \fn jsAppendFile
-*/
-int jsAppendVideo(const char *s)
-{
-int ret=0;
-        
-        if(A_appendAvi(s)) 
-        {
-          ret=1;
-        }
-        
-    return ret;
-}
-
-/**
-    \fn jsClearSegments
-*/
-int jsClearSegments(void)
-{
-    video_body->clearSegment();
-    return 1;
-}
-/**
-    \fn jsAddSegment
-
-*/
-int  jsAddSegment(int ref, double start, double duration)
-{
-    if(true==video_body->addSegment(ref,(uint64_t)start,(uint64_t)duration)) 
-    {
-        if(1==video_body->getNbSegment()) // We just added our first seg...
-        {
-                ADM_info("First segment, refreshing screen\n");
-                A_Rewind();
-        }
-        return 1;
-    }
-    return 0;
-}
-
-
-/**
     \fn Codec
     
 */
@@ -132,4 +59,4 @@
 }// end Codec
 
 
-// EOF
\ No newline at end of file
+// EOF

Modified: branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/js/ADM_jsAvidemux.h
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/js/ADM_jsAvidemux.h	2010-05-20 15:22:57 UTC (rev 6208)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/js/ADM_jsAvidemux.h	2010-05-20 15:23:01 UTC (rev 6209)
@@ -18,29 +18,9 @@
 #ifdef __cplusplus
 extern "C" {
 #endif
+#include "ADM_scriptCommon.h"
+//char *jsGetVideoCodec ( void) ;
 
-int jsLoadVideo(const char *c);
-int jsAppendVideo(const char *c);
-int jsClearSegments(void);
-int jsAddSegment(int ref, double start, double duration);
-int jsAudioReset(void);
-int jsAudioMixer(const char *s);
-// Fq
-int32_t jsGetResample(void);
-void    jsSetResample(int32_t fq);
-// Markers
-double jsGetMarkerA(void);
-double jsGetMarkerB(void);
-void   jsSetMarkerA(double a);
-void   jsSetMarkerB(double b);
-//
-int    jsClearVideoFilters();
-// Info
-int jsGetWidth ( void) ;
-int jsGetHeight ( void) ;
-int jsGetFps1000 ( void) ;
-char *jsGetVideoCodec ( void) ;
-
 // non jsapigen function, variables number of args
 JSBool jsAdmaddVideoFilter(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval);
 JSBool jsAdmaudioCodec(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval);

Deleted: branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/js/ADM_jsAvidemuxInfo.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/js/ADM_jsAvidemuxInfo.cpp	2010-05-20 15:22:57 UTC (rev 6208)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/js/ADM_jsAvidemuxInfo.cpp	2010-05-20 15:23:01 UTC (rev 6209)
@@ -1,59 +0,0 @@
-/**
-    \file ADM_jsLoad.cpp
-    \brief Load oriented functions
-    \author mean (c) 2009 fixounet at free.fr
-
-
-*/
-/***************************************************************************
- *                                                                         *
- *   This program is free software; you can redistribute it and/or modify  *
- *   it under the terms of the GNU General Public License as published by  *
- *   the Free Software Foundation; either version 2 of the License, or     *
- *   (at your option) any later version.                                   *
- *                                                                         *
- ***************************************************************************/
-#include "ADM_js.h"
-#include "ADM_editor/ADM_edit.hxx"
-#include "ADM_jsAvidemux.h"
-#include "fourcc.h"
-extern ADM_Composer *video_body;
-/**
-    \fn jsGetWidth
-*/
-int jsGetWidth ( void)
-{
-aviInfo info;
-        video_body->getVideoInfo(&info);
-        return info.width;
-}
-/**
-    \fn jsGetHeight
-*/
-int jsGetHeight ( void)
-{
-aviInfo info;
-        video_body->getVideoInfo(&info);
-        return info.height;
-}
-/**
-    \fn jsGetFps1000
-*/
-int jsGetFps1000 ( void)
-{
-aviInfo info;
-        video_body->getVideoInfo(&info);
-        return info.fps1000;
-}
-/**
-    \fn jsGetVideoCodec
-*/
-char *jsGetVideoCodec ( void)
-{
-uint32_t fcc;
-aviInfo info;
-        video_body->getVideoInfo(&info);
-        fcc=info.fcc;
-        return fourCC::tostring(fcc);
-}
-// EOF

Modified: branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/js/CMakeLists.txt
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/js/CMakeLists.txt	2010-05-20 15:22:57 UTC (rev 6208)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/js/CMakeLists.txt	2010-05-20 15:23:01 UTC (rev 6209)
@@ -9,7 +9,6 @@
         ADM_jsTestFactory_js.c
 # Load segment
         ADM_jsAvidemux.cpp
-        ADM_jsAvidemuxInfo.cpp
         ADM_jsAvidemux_js.c
 # Debug / editor class
         ADM_jsEditor.cpp

Modified: branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/py/ADM_pyAdm.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/py/ADM_pyAdm.cpp	2010-05-20 15:22:57 UTC (rev 6208)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/py/ADM_pyAdm.cpp	2010-05-20 15:23:01 UTC (rev 6209)
@@ -20,7 +20,8 @@
 #include "ADM_coreTinyPy/include/ADM_tinypy.h"
 #include "ADM_script2/include/ADM_scriptShell.h"
 #include "A_functions.h"
-
+#include "ADM_scriptCommon.h"
+#include "ADM_scriptVideo.h"
 #include "adm_gen.h"
 
 #include "adm_gen.cpp"
@@ -63,68 +64,5 @@
 	return true;
 }
 
-int  py_loadVideo (char *vid )
-{
-    printf("pyLoadVideo %s\n",vid);
-    return 0;
-}
-int  py_clearSegments (void)
-{
-    printf("py_clearSegments\n");
-    return 0;
-}
+// EOF
 
-int  py_appendVideo (char *vid )
-{
-    printf("py_appendVideo %s\n",vid);
-    return 0;
-}
-
-int  py_addSegment (int ,float , float )
-{
-    printf("py_addSegment\n");
-    return 0;
-}
-
-int  py_setPostProc (int a,int b, int c)
-{
-    printf("py_setPostProc\n");
-    return 0;
-}
-
-int  py_getWidth (void)
-{
-    printf("py_getWidth\n");
-    return 0;
-}
-
-int  py_getHeight (void)
-{
-    printf("py_getHeight\n");
-    return 0;
-}
-
-int  py_getFps1000 (void)
-{
-    printf("py_getFps1000\n");
-    return 0;
-}
-
-int  py_audioReset (void)
-{
-    printf("py_audioReset\n");
-    return 0;
-}
-
-int  py_audioMixer (char *mixer )
-{
-    printf("py_audioMixer\n");
-    return 0;
-}
-
-int  py_clearVideoFilters (void)
-{
-    printf("py_clearVideoFilters\n");
-    return 0;
-}
-

Modified: branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/py/adm.admPy
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/py/adm.admPy	2010-05-20 15:22:57 UTC (rev 6208)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/py/adm.admPy	2010-05-20 15:23:01 UTC (rev 6209)
@@ -1,13 +1,15 @@
-/* FUNC */ int loadVideo      (char * ) 
-/* FUNC */ int clearSegments  (void) 
-/* FUNC */ int appendVideo    (char * ) 
-/* FUNC */ int addSegment     (int ,float , float ) 
-/* FUNC */ int setPostProc    (int ,int , int ) 
-/* FUNC */ int getWidth       (void) 
-/* FUNC */ int getHeight      (void) 
-/* FUNC */ int getFps1000     (void) 
+#              cname:pyname
+
+/* FUNC */ int jsLoadVideo:loadVideo          (char * ) 
+/* FUNC */ int jsClearSegments:clearSegments  (void) 
+/* FUNC */ int jsAppendVideo:appendVideo      (char * ) 
+/* FUNC */ int jsAddSegment:addSegment        (int ,float , float ) 
+/* FUNC */ int jsSetPostProc:setPostProc      (int ,int , int ) 
+/* FUNC */ int jsGetWidth:getWidth            (void) 
+/* FUNC */ int jsGetHeight:getHeight          (void) 
+/* FUNC */ int jsGetFps1000:getFps1000        (void) 
 #/* FUNC */ char* getVideoCodec(void) 
-/* FUNC */ int audioReset     (void) 
-/* FUNC */ int audioMixer     (char * ) 
-/* FUNC */ int clearVideoFilters   (void) 
+/* FUNC */ int jsAudioReset:audioReset        (void) 
+/* FUNC */ int jsAudioMixer:audioMixer        (char * ) 
+/* FUNC */ int jsClearVideoFilters:clearVideoFilters   (void) 
 

Modified: branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/py/adm_gen.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/py/adm_gen.cpp	2010-05-20 15:22:57 UTC (rev 6208)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/py/adm_gen.cpp	2010-05-20 15:23:01 UTC (rev 6209)
@@ -1,76 +1,76 @@
-//int  loadVideo <char * >
+//int  jsLoadVideo <char * >
 tp_obj zzpy_loadVideo(TP)
 {
 char * p0=(char *)TP_STR().string.val;
-int r=py_loadVideo(p0); 
+int r=jsLoadVideo(p0); 
 return tp_number(r);
 }
-//int  clearSegments <void>
+//int  jsClearSegments <void>
 tp_obj zzpy_clearSegments(TP)
 {
-int r=py_clearSegments(); 
+int r=jsClearSegments(); 
 return tp_number(r);
 }
-//int  appendVideo <char * >
+//int  jsAppendVideo <char * >
 tp_obj zzpy_appendVideo(TP)
 {
 char * p0=(char *)TP_STR().string.val;
-int r=py_appendVideo(p0); 
+int r=jsAppendVideo(p0); 
 return tp_number(r);
 }
-//int  addSegment <int  float   float >
+//int  jsAddSegment <int  float   float >
 tp_obj zzpy_addSegment(TP)
 {
 int p0=TP_NUM();
 float p1=TP_NUM();
 float p2=TP_NUM();
-int r=py_addSegment(p0,p1,p2); 
+int r=jsAddSegment(p0,p1,p2); 
 return tp_number(r);
 }
-//int  setPostProc <int  int   int >
+//int  jsSetPostProc <int  int   int >
 tp_obj zzpy_setPostProc(TP)
 {
 int p0=TP_NUM();
 int p1=TP_NUM();
 int p2=TP_NUM();
-int r=py_setPostProc(p0,p1,p2); 
+int r=jsSetPostProc(p0,p1,p2); 
 return tp_number(r);
 }
-//int  getWidth <void>
+//int  jsGetWidth <void>
 tp_obj zzpy_getWidth(TP)
 {
-int r=py_getWidth(); 
+int r=jsGetWidth(); 
 return tp_number(r);
 }
-//int  getHeight <void>
+//int  jsGetHeight <void>
 tp_obj zzpy_getHeight(TP)
 {
-int r=py_getHeight(); 
+int r=jsGetHeight(); 
 return tp_number(r);
 }
-//int  getFps1000 <void>
+//int  jsGetFps1000 <void>
 tp_obj zzpy_getFps1000(TP)
 {
-int r=py_getFps1000(); 
+int r=jsGetFps1000(); 
 return tp_number(r);
 }
-//int  audioReset <void>
+//int  jsAudioReset <void>
 tp_obj zzpy_audioReset(TP)
 {
-int r=py_audioReset(); 
+int r=jsAudioReset(); 
 return tp_number(r);
 }
-//int  audioMixer <char * >
+//int  jsAudioMixer <char * >
 tp_obj zzpy_audioMixer(TP)
 {
 char * p0=(char *)TP_STR().string.val;
-int r=py_audioMixer(p0); 
+int r=jsAudioMixer(p0); 
 return tp_number(r);
 }
-//int  clearVideoFilters <void>
+//int  jsClearVideoFilters <void>
 tp_obj zzpy_clearVideoFilters(TP)
 {
-int r=py_clearVideoFilters(); 
+int r=jsClearVideoFilters(); 
 return tp_number(r);
 }
 pyFuncs adm_functions[]={

Modified: branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/py/adm_gen.h
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/py/adm_gen.h	2010-05-20 15:22:57 UTC (rev 6208)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/py/adm_gen.h	2010-05-20 15:23:01 UTC (rev 6209)
@@ -1,11 +1,11 @@
-int  py_loadVideo (char * );
-int  py_clearSegments (void);
-int  py_appendVideo (char * );
-int  py_addSegment (int ,float , float );
-int  py_setPostProc (int ,int , int );
-int  py_getWidth (void);
-int  py_getHeight (void);
-int  py_getFps1000 (void);
-int  py_audioReset (void);
-int  py_audioMixer (char * );
-int  py_clearVideoFilters (void);
+int  loadVideo (char * );
+int  clearSegments (void);
+int  appendVideo (char * );
+int  addSegment (int ,float , float );
+int  setPostProc (int ,int , int );
+int  getWidth (void);
+int  getHeight (void);
+int  getFps1000 (void);
+int  audioReset (void);
+int  audioMixer (char * );
+int  clearVideoFilters (void);

Copied: branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src/ADM_scriptAudio.cpp (from rev 6208, branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/js/ADM_jsAvidemuxInfo.cpp)
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/js/ADM_jsAvidemuxInfo.cpp	2010-05-20 15:22:57 UTC (rev 6208)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src/ADM_scriptAudio.cpp	2010-05-20 15:23:01 UTC (rev 6209)
@@ -0,0 +1,58 @@
+/**
+    \file ADM_jsAudio.cpp
+    \brief Audio oriented functions
+    \author mean (c) 2009 fixounet at free.fr
+
+
+    jsapigen does not like much variable number of arguments
+    In that case, we patch the generated file to go back to native spidermonkey api
+
+
+*/
+/***************************************************************************
+ *                                                                         *
+ *   This program is free software; you can redistribute it and/or modify  *
+ *   it under the terms of the GNU General Public License as published by  *
+ *   the Free Software Foundation; either version 2 of the License, or     *
+ *   (at your option) any later version.                                   *
+ *                                                                         *
+ ***************************************************************************/
+#include "ADM_scriptIf.h"
+#include "ADM_editor/ADM_edit.hxx"
+#include "A_functions.h"
+#include "GUI_ui.h"
+#include "ADM_audioFilterInterface.h"
+#include "audioEncoderApi.h"
+#include "ADM_scriptCommon.h"
+extern ADM_Composer *video_body;
+/**
+    \fn int jsAudioReset(void);
+*/
+int jsAudioReset (void)
+{
+    audioFilterReset();
+    return 1;
+}
+/**
+    \fn jsAudioMixer
+*/
+int jsAudioMixer(const char *s)
+{
+    CHANNEL_CONF c=AudioMuxerStringToId(s);
+    return audioFilterSetMixer(c);
+}
+/**
+    \fn jsGetResample
+*/
+int32_t jsGetResample(void)
+{
+    return 0;
+}
+/**
+    \fn jsSetResample
+*/
+void    jsSetResample(int32_t fq)
+{
+
+}
+//EOF
\ No newline at end of file

Added: branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src/ADM_scriptAvidemux.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src/ADM_scriptAvidemux.cpp	2010-05-20 15:22:57 UTC (rev 6208)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src/ADM_scriptAvidemux.cpp	2010-05-20 15:23:01 UTC (rev 6209)
@@ -0,0 +1,98 @@
+/**
+    \file ADM_jsLoad.cpp
+    \brief Load oriented functions
+    \author mean (c) 2009 fixounet at free.fr
+
+
+*/
+/***************************************************************************
+ *                                                                         *
+ *   This program is free software; you can redistribute it and/or modify  *
+ *   it under the terms of the GNU General Public License as published by  *
+ *   the Free Software Foundation; either version 2 of the License, or     *
+ *   (at your option) any later version.                                   *
+ *                                                                         *
+ ***************************************************************************/
+
+#include "ADM_editor/ADM_edit.hxx"
+#include "A_functions.h"
+#include "ADM_muxerProto.h"
+#include "GUI_ui.h"
+#include "ADM_scriptIf.h"
+#include "ADM_scriptCommon.h"
+extern ADM_Composer *video_body;
+/**
+    \fn ADM_JSAvidemux
+    \brief Select the current container from a string
+*/
+bool A_setContainer(const char *cont)
+{
+    int idx=ADM_MuxerIndexFromName(cont);
+    if(idx==-1)
+    {
+        ADM_error("Cannot find muxer for format=%s\n",cont);
+        return false;
+    }
+    ADM_info("setting container as index %d\n",idx);
+    UI_SetCurrentFormat(idx);
+    return true;
+}
+
+/**
+    \fn jsLoadFile
+*/
+int jsLoadVideo(const char *s)
+{
+int ret=0;
+        jsLog(JS_LOG_NORMAL,"[Js] Loading video %s",s);
+        if(A_openAvi(s)) 
+        {
+          ret=1;
+        }
+        
+    return ret;
+}
+
+/**
+    \fn jsAppendFile
+*/
+int jsAppendVideo(const char *s)
+{
+int ret=0;
+        
+        if(A_appendAvi(s)) 
+        {
+          ret=1;
+        }
+        
+    return ret;
+}
+
+/**
+    \fn jsClearSegments
+*/
+int jsClearSegments(void)
+{
+    video_body->clearSegment();
+    return 1;
+}
+/**
+    \fn jsAddSegment
+
+*/
+int  jsAddSegment(int ref, double start, double duration)
+{
+    if(true==video_body->addSegment(ref,(uint64_t)start,(uint64_t)duration)) 
+    {
+        if(1==video_body->getNbSegment()) // We just added our first seg...
+        {
+                ADM_info("First segment, refreshing screen\n");
+                A_Rewind();
+        }
+        return 1;
+    }
+    return 0;
+}
+
+
+// EOF

Copied: branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src/ADM_scriptAvidemuxInfo.cpp (from rev 6208, branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/js/ADM_jsAvidemuxInfo.cpp)
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/js/ADM_jsAvidemuxInfo.cpp	2010-05-20 15:22:57 UTC (rev 6208)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src/ADM_scriptAvidemuxInfo.cpp	2010-05-20 15:23:01 UTC (rev 6209)
@@ -0,0 +1,59 @@
+/**
+    \file ADM_jsLoad.cpp
+    \brief Load oriented functions
+    \author mean (c) 2009 fixounet at free.fr
+
+
+*/
+/***************************************************************************
+ *                                                                         *
+ *   This program is free software; you can redistribute it and/or modify  *
+ *   it under the terms of the GNU General Public License as published by  *
+ *   the Free Software Foundation; either version 2 of the License, or     *
+ *   (at your option) any later version.                                   *
+ *                                                                         *
+ ***************************************************************************/
+#include "ADM_scriptIf.h"
+#include "ADM_editor/ADM_edit.hxx"
+#include "ADM_scriptCommon.h"
+#include "fourcc.h"
+extern ADM_Composer *video_body;
+/**
+    \fn jsGetWidth
+*/
+int jsGetWidth ( void)
+{
+aviInfo info;
+        video_body->getVideoInfo(&info);
+        return info.width;
+}
+/**
+    \fn jsGetHeight
+*/
+int jsGetHeight ( void)
+{
+aviInfo info;
+        video_body->getVideoInfo(&info);
+        return info.height;
+}
+/**
+    \fn jsGetFps1000
+*/
+int jsGetFps1000 ( void)
+{
+aviInfo info;
+        video_body->getVideoInfo(&info);
+        return info.fps1000;
+}
+/**
+    \fn jsGetVideoCodec
+*/
+char *jsGetVideoCodec ( void)
+{
+uint32_t fcc;
+aviInfo info;
+        video_body->getVideoInfo(&info);
+        fcc=info.fcc;
+        return fourCC::tostring(fcc);
+}
+// EOF

Modified: branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src/ADM_scriptVideo.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src/ADM_scriptVideo.cpp	2010-05-20 15:22:57 UTC (rev 6208)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src/ADM_scriptVideo.cpp	2010-05-20 15:23:01 UTC (rev 6209)
@@ -26,18 +26,10 @@
 #include "ADM_videoFilterApi.h"
 #include "ADM_videoFilters.h"
 #include "GUI_ui.h"
+#include "ADM_scriptCommon.h"
 extern ADM_Composer *video_body;
 bool A_setVideoCodec(const char *nm);
 /**
-    \fn jsSetPostProc
-*/
-int jsSetPostProc (int a,int b, int c)
-{
-    return video_body->setPostProc(a,b,c);
-}
-
-
-/**
     \fn A_setVideoCodec
 */
 bool A_setVideoCodec(const char *nm)
@@ -52,7 +44,17 @@
     UI_setVideoCodec(idx);
     return true;
 }
+
 /**
+    \fn jsSetPostProc
+*/
+int jsSetPostProc (int a,int b, int c)
+{
+    return video_body->setPostProc(a,b,c);
+}
+
+
+/**
      \fn jsClearFilters
 */
 int jsClearVideoFilters()

Modified: branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src/CMakeLists.txt
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src/CMakeLists.txt	2010-05-20 15:22:57 UTC (rev 6208)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src/CMakeLists.txt	2010-05-20 15:23:01 UTC (rev 6209)
@@ -1,8 +1,12 @@
 SET(ADM_script_SRCS
         ADM_scriptIf.cpp
         ADM_scriptVideo.cpp
+        ADM_scriptAvidemux.cpp
+        ADM_scriptAvidemuxInfo.cpp
+        ADM_scriptAudio.cpp
 )
 
+
 ADD_LIBRARY(ADM_script6 STATIC ${ADM_script_SRCS})
 include_directories(../include)
 include_directories(.)

Modified: branches/avidemux_2.6_branch_mean/avidemux/commonCmakeApplication.cmake
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/commonCmakeApplication.cmake	2010-05-20 15:22:57 UTC (rev 6208)
+++ branches/avidemux_2.6_branch_mean/avidemux/commonCmakeApplication.cmake	2010-05-20 15:23:01 UTC (rev 6209)
@@ -97,10 +97,10 @@
 #ADM_filter6 
 ADM_osSupport6 
 ADM_requant6 
-ADM_script6 
 ADM_pyScript6 
 ADM_jsScript6 
-#ADM_scriptDF
+ADM_scriptDF
+ADM_script6 
 ADM_videoEncoder6 
 ADM_internalVideoFilter6
 ADM_toolkit6

Modified: branches/avidemux_2.6_branch_mean/cmake/admPy.pl
===================================================================
--- branches/avidemux_2.6_branch_mean/cmake/admPy.pl	2010-05-20 15:22:57 UTC (rev 6208)
+++ branches/avidemux_2.6_branch_mean/cmake/admPy.pl	2010-05-20 15:23:01 UTC (rev 6209)
@@ -4,7 +4,7 @@
 my $headerFile;
 my $line;
 my $glueprefix="zzpy_";
-my $functionPrefix="py_";
+my $functionPrefix="";
 my @allFuncs;
 #
 #
@@ -68,6 +68,7 @@
         my @params;
         my $retType=$proto;;
         my $func=$proto;;
+        my $cfunc;
         $args=~s/^.*\(//g;
         $args=~s/\).*$//g;
         #print "args => $args\n";
@@ -79,7 +80,8 @@
         # get functioName
         $func=~s/ *\(.*$//g;
         $func=~s/^.* //g;
-        print OUTPUT "//$retType  $func <@params>\n";
+        ($cfunc,$func)=split ":",$func;
+        print OUTPUT "//$retType  $cfunc <@params>\n";
         # Write glue code
         print OUTPUT "tp_obj ".$glueprefix.$func."(TP)\n";
         push(@allFuncs,$func);
@@ -109,7 +111,7 @@
         {
                 print OUTPUT $retType." r=";
         }
-        print OUTPUT $functionPrefix.$func."(";
+        print OUTPUT $functionPrefix.$cfunc."(";
         for($i=0;$i<$nb;$i++)
         {
                 if($i)



From mean at mail.berlios.de  Thu May 20 17:52:25 2010
From: mean at mail.berlios.de (mean at BerliOS)
Date: Thu, 20 May 2010 17:52:25 +0200
Subject: [Avidemux-svn-commit] r6210 -
	branches/avidemux_2.6_branch_mean/avidemux/gtk/ADM_userInterfaces/ADM_shell
Message-ID: <201005201552.o4KFqPvD018022@sheep.berlios.de>

Author: mean
Date: 2010-05-20 17:52:25 +0200 (Thu, 20 May 2010)
New Revision: 6210

Modified:
   branches/avidemux_2.6_branch_mean/avidemux/gtk/ADM_userInterfaces/ADM_shell/gtkShell.cpp
Log:
[js/py] Fix gtk

Modified: branches/avidemux_2.6_branch_mean/avidemux/gtk/ADM_userInterfaces/ADM_shell/gtkShell.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/gtk/ADM_userInterfaces/ADM_shell/gtkShell.cpp	2010-05-20 15:23:01 UTC (rev 6209)
+++ branches/avidemux_2.6_branch_mean/avidemux/gtk/ADM_userInterfaces/ADM_shell/gtkShell.cpp	2010-05-20 15:52:25 UTC (rev 6210)
@@ -5,7 +5,7 @@
 
 
 #include "ADM_default.h"
-#include "ADM_jsShell.h"
+#include "ADM_scriptShell.h"
 /**
     \fn gtkShellLogger
     \brief Redirect output to the shell



From gruntster at mail.berlios.de  Thu May 20 20:24:12 2010
From: gruntster at mail.berlios.de (gruntster at mail.berlios.de)
Date: Thu, 20 May 2010 20:24:12 +0200
Subject: [Avidemux-svn-commit] r6211 -
	branches/avidemux_2.5_branch_gruntster/platforms/windows/installer
Message-ID: <201005201824.o4KIOC3P005293@sheep.berlios.de>

Author: gruntster
Date: 2010-05-20 20:22:40 +0200 (Thu, 20 May 2010)
New Revision: 6211

Modified:
   branches/avidemux_2.5_branch_gruntster/platforms/windows/installer/avidemux.nsi
Log:
[Win32] bump installer version

Modified: branches/avidemux_2.5_branch_gruntster/platforms/windows/installer/avidemux.nsi
===================================================================
--- branches/avidemux_2.5_branch_gruntster/platforms/windows/installer/avidemux.nsi	2010-05-20 15:52:25 UTC (rev 6210)
+++ branches/avidemux_2.5_branch_gruntster/platforms/windows/installer/avidemux.nsi	2010-05-20 18:22:40 UTC (rev 6211)
@@ -25,7 +25,7 @@
 
 !define REGKEY "SOFTWARE\${INTERNALNAME}"
 !define UNINST_REGKEY "SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall\${INTERNALNAME}"
-!define VERSION 2.5.2.${REVISION}
+!define VERSION 2.5.3.${REVISION}
 !define COMPANY "Free Software Foundation"
 !define URL "http://www.avidemux.org"
 
@@ -44,13 +44,13 @@
 
 !ifdef INST_BOTH
 OutFile ${EXEDIR}\avidemux_2.5_r${REVISION}_full_win${BUILD_BITS}.exe
-Name "Avidemux 2.5.2 Full beta r${REVISION}"
+Name "Avidemux 2.5.3 Full beta r${REVISION}"
 !else ifdef INST_QT
 OutFile ${EXEDIR}\avidemux_2.5_r${REVISION}_win${BUILD_BITS}.exe
-Name "Avidemux 2.5.2 beta r${REVISION}"
+Name "Avidemux 2.5.3 beta r${REVISION}"
 !else ifdef INST_GTK
 OutFile ${EXEDIR}\avidemux_2.5_r${REVISION}_gtk_win${BUILD_BITS}.exe
-Name "Avidemux 2.5.2 GTK+ beta r${REVISION}"
+Name "Avidemux 2.5.3 GTK+ beta r${REVISION}"
 !endif
 
 ##########################
@@ -142,7 +142,7 @@
 XPStyle on
 ShowInstDetails nevershow
 ShowUninstDetails nevershow
-VIProductVersion 2.5.2.${REVISION}
+VIProductVersion 2.5.3.${REVISION}
 VIAddVersionKey ProductName Avidemux
 VIAddVersionKey ProductVersion "${VERSION} (beta)"
 VIAddVersionKey FileVersion ""



From gruntster at mail.berlios.de  Thu May 20 20:37:28 2010
From: gruntster at mail.berlios.de (gruntster at mail.berlios.de)
Date: Thu, 20 May 2010 20:37:28 +0200
Subject: [Avidemux-svn-commit] r6212 - in
	branches/avidemux_2.5_branch_gruntster: cmake
	plugins/ADM_videoEncoder/ADM_vidEnc_x264
	plugins/ADM_videoEncoder/ADM_vidEnc_x264/qt4
Message-ID: <201005201837.o4KIbSPv007288@sheep.berlios.de>

Author: gruntster
Date: 2010-05-20 20:37:22 +0200 (Thu, 20 May 2010)
New Revision: 6212

Modified:
   branches/avidemux_2.5_branch_gruntster/cmake/admCheckX264.cmake
   branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_x264/encoder.cpp
   branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_x264/qt4/x264ConfigDialog.cpp
   branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_x264/qt4/x264ConfigDialog.h
   branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_x264/x264Options.cpp
   branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_x264/x264Options.h
Log:
[x264] increase minimum supported core to version 85

Modified: branches/avidemux_2.5_branch_gruntster/cmake/admCheckX264.cmake
===================================================================
--- branches/avidemux_2.5_branch_gruntster/cmake/admCheckX264.cmake	2010-05-20 18:22:40 UTC (rev 6211)
+++ branches/avidemux_2.5_branch_gruntster/cmake/admCheckX264.cmake	2010-05-20 18:37:22 UTC (rev 6212)
@@ -14,14 +14,12 @@
 				STRING(REGEX REPLACE ".*[ ]([0-9]+).*" "\\1" x264_version "${X264_H}")
 				MESSAGE(STATUS "  core version: ${x264_version}")
 				
-				IF (x264_version LESS 67)
-					MESSAGE("WARNING: x264 core version is too old.  At least version 67 is required.")
+				IF (x264_version LESS 85)
+					MESSAGE("WARNING: x264 core version is too old.  At least version 85 is required.")
 					SET(X264_FOUND 0)
-				ELSEIF (x264_version GREATER 73)
+				ELSE (x264_version LESS 85)
 					FIND_HEADER_AND_LIB(X264 x264.h x264 x264_encoder_open_${x264_version})
-				ELSE (x264_version LESS 67)
-					FIND_HEADER_AND_LIB(X264 x264.h x264 x264_encoder_open)
-				ENDIF (x264_version LESS 67)
+				ENDIF (x264_version LESS 85)
 			ELSE (_X264_FOUND)
 				SET(X264_FOUND 0)
 			ENDIF (_X264_FOUND)

Modified: branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_x264/encoder.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_x264/encoder.cpp	2010-05-20 18:22:40 UTC (rev 6211)
+++ branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_x264/encoder.cpp	2010-05-20 18:37:22 UTC (rev 6212)
@@ -327,7 +327,6 @@
 		_picture.img.i_plane = 3;
 	}
 
-#if X264_BUILD > 75
 	if (x264_encoder_encode(_handle, &nal, &nalCount, encodeParams->frameData[0] ? &_picture : NULL, &picture_out) < 0)
 	{
 		printf("[x264] Error encoding\n");
@@ -343,40 +342,7 @@
 	}
 
 	encodeParams->encodedDataSize = size;
-#else
-	if (x264_encoder_encode(_handle, &nal, &nalCount, encodeParams->frameData[0] ? &_picture : NULL, &picture_out) < 0)
-	{
-		printf("[x264] Error encoding\n");
-		return ADM_VIDENC_ERR_FAILED;
-	}
 
-	int size = 0;
-	int currentNal, sizemax;
-
-	for (int i = 0; i < nalCount; i++)
-	{
-		sizemax = 0xfffffff;
-
-		if (!_param.b_repeat_headers)
-			size += 4;
-
-		currentNal = x264_nal_encode(_buffer + size, &sizemax, _param.b_repeat_headers, &nal[i]);
-
-		if (!_param.b_repeat_headers)
-		{
-			// Need to put size (assuming nal_size=4)
-			_buffer[size + 0 - 4] = (currentNal >> 24) & 0xff;
-			_buffer[size + 1 - 4] = (currentNal >> 16) & 0xff;
-			_buffer[size + 2 - 4] = (currentNal >> 8) & 0xff;
-			_buffer[size + 3 - 4] = (currentNal >> 0) & 0xff;
-		}
-
-		size += currentNal;
-	}
-
-	encodeParams->encodedDataSize = size;
-#endif
-
 	_currentFrame++;
 	encodeParams->ptsFrame = picture_out.i_pts;	// In fact it is the picture number in out case
 
@@ -384,28 +350,6 @@
 	{
 		case X264_TYPE_IDR:
 			encodeParams->frameType = ADM_VIDENC_FRAMETYPE_IDR;
-#if X264_BUILD < 76
-			if(!_param.b_repeat_headers && _seiUserData && !picture_out.i_pts)
-			{
-				// Put our SEI front...
-				// first a temp location...
-				uint8_t tmpBuffer[size];
-				memcpy(tmpBuffer, _buffer, size);
-
-				// Put back out SEI and add Size
-				_buffer[0] = (_seiUserDataLen >> 24) & 0xff;
-				_buffer[1] = (_seiUserDataLen >> 16) & 0xff;
-				_buffer[2] = (_seiUserDataLen >> 8) & 0xff;
-				_buffer[3] = (_seiUserDataLen >> 0) & 0xff;
-
-				memcpy(_buffer + 4, _seiUserData, _seiUserDataLen);
-				memcpy(_buffer + 4 + _seiUserDataLen, tmpBuffer, size);
-
-				size += 4 + _seiUserDataLen;
-				encodeParams->encodedDataSize = size; // update total size
-			}
-#endif
-
 			break;
 		case X264_TYPE_I:
 		case X264_TYPE_P:
@@ -425,7 +369,6 @@
 	return ADM_VIDENC_ERR_SUCCESS;
 }
 
-#if X264_BUILD > 75
 int x264Encoder::encodeNals(uint8_t *buf, int size, x264_nal_t *nals, int nalCount, bool skipSei)
 {
     uint8_t *p = buf;
@@ -454,7 +397,6 @@
 
     return p - buf;
 }
-#endif
 
 bool x264Encoder::createHeader(void)
 {
@@ -467,99 +409,10 @@
 	if (_extraData)
 		delete _extraData;
 
-#if X264_BUILD > 75
 	_extraDataSize = x264_encoder_headers(_handle, &nal, &nalCount);
 	_extraData = new uint8_t[_extraDataSize];
 	_extraDataSize = encodeNals(_extraData, _extraDataSize, nal, nalCount, true);
-#else
-	uint32_t offset = 0;
-	uint8_t buffer[X264_MAX_HEADER_SIZE];
-	uint8_t picParam[X264_MAX_HEADER_SIZE];
-	uint8_t seqParam[X264_MAX_HEADER_SIZE];
-	uint8_t sei[X264_MAX_HEADER_SIZE];
-	int picParamLen = 0, seqParamLen = 0, seiParamLen = 0, len;
-	int sz;
 
-	_extraData = new uint8_t[X264_MAX_HEADER_SIZE];
-	_extraDataSize = 0;
-
-	x264_encoder_headers(_handle, &nal, &nalCount);
-
-	printf("[x264] Nal count: %d\n", nalCount);
-
-	// Now encode them
-	for (int i = 0; i < nalCount; i++)
-	{
-		switch (nal[i].i_type)
-		{
-		case H264_NAL_TYPE_SEQ_PARAM:
-			sz = x264_nal_encode(seqParam, &seqParamLen, 0, &nal[i]);
-			break;
-		case H264_NAL_TYPE_PIC_PARAM:
-			sz = x264_nal_encode(picParam, &picParamLen, 0, &nal[i]);
-			break;
-		case H264_NAL_TYPE_SEI:
-			sz = x264_nal_encode(sei, &seiParamLen, 0, &nal[i]);
-			break;
-		default:
-			printf("[x264] Unknown type %d in nal %d\n", nal[i].i_type, i);
-			sz = x264_nal_encode(buffer, &len, 0, &nal[i]);
-		}
-
-		if (sz <= 0)
-		{
-			printf("[x264] Cannot encode nal header %d\n", i);
-
-			return false;
-		}
-	}
-
-	// Now that we got all the nals encoded, time to build the avcC atom
-	// Check we have everything we want
-	if (!picParamLen || !seqParamLen)
-	{
-		printf("[x264] Seqparam or PicParam not found\n");
-		return false;
-	}
-
-	// Fill header
-	_extraData[0] = 1;		// Version
-	_extraData[1] = seqParam[1];	//0x42; // AVCProfileIndication
-	_extraData[2] = seqParam[2];	//0x00; // profile_compatibility
-	_extraData[3] = seqParam[3];	//0x0D; // AVCLevelIndication
-	_extraData[4] = 0xFC + 3;	// lengthSizeMinusOne 
-	_extraData[5] = 0xE0 + 1;	// nonReferenceDegredationPriorityLow
-
-	offset = 6;
-	_extraData[offset] = seqParamLen >> 8;
-	_extraData[offset + 1] = seqParamLen & 0xff;
-
-	offset += 2;
-	memcpy(_extraData + offset, seqParam, seqParamLen);
-
-	offset += seqParamLen;
-	_extraData[offset] = 1;	// numOfPictureParameterSets
-
-	offset++;
-	_extraData[offset] = picParamLen >> 8;
-	_extraData[offset + 1] = picParamLen & 0xff;
-
-	offset += 2;
-	memcpy(_extraData + offset, picParam, picParamLen);
-
-	offset += picParamLen;
-
-	// Where x264 stores all its header, save it for later use
-	if (seiParamLen)
-	{
-		_seiUserDataLen = seiParamLen;
-		_seiUserData = new uint8_t[_seiUserDataLen];
-		memcpy(_seiUserData, sei, _seiUserDataLen);
-	}
-
-	_extraDataSize = offset;
-#endif
-
 	printf("[x264] generated %d extra bytes for header\n", _extraDataSize);
 
 	return true;
@@ -646,11 +499,7 @@
 	printf("[x264] i_bframe = %d\n", x264Param->i_bframe);
 	printf("[x264] i_bframe_bias = %d\n", x264Param->i_bframe_bias);
 	printf("[x264] i_frame_reference = %d\n", x264Param->i_frame_reference);
-#if X264_BUILD >= 78
 	printf("[x264] i_bframe_pyramid = %d\n", x264Param->i_bframe_pyramid);
-#else
-	printf("[x264] b_bframe_pyramid = %d\n", x264Param->b_bframe_pyramid);
-#endif
 	printf("[x264] i_bframe_adaptive = %d\n", x264Param->i_bframe_adaptive);
 	printf("[x264] i_keyint_max = %d\n", x264Param->i_keyint_max);
 	printf("[x264] i_keyint_min = %d\n", x264Param->i_keyint_min);

Modified: branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_x264/qt4/x264ConfigDialog.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_x264/qt4/x264ConfigDialog.cpp	2010-05-20 18:22:40 UTC (rev 6211)
+++ branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_x264/qt4/x264ConfigDialog.cpp	2010-05-20 18:37:22 UTC (rev 6212)
@@ -69,22 +69,8 @@
 	connect(ui.quantiserSlider, SIGNAL(valueChanged(int)), this, SLOT(quantiserSlider_valueChanged(int)));
 	connect(ui.quantiserSpinBox, SIGNAL(valueChanged(int)), this, SLOT(quantiserSpinBox_valueChanged(int)));
 	connect(ui.targetRateControlSpinBox, SIGNAL(valueChanged(int)), this, SLOT(targetRateControlSpinBox_valueChanged(int)));
-
-#if X264_BUILD >= 69
 	connect(ui.mbTreeCheckBox, SIGNAL(toggled(bool)), this, SLOT(mbTreeCheckBox_toggled(bool)));
-#else
-	ui.mbTreeCheckBox->setVisible(false);
-	ui.lblLookahead->setVisible(false);
-	ui.lookaheadSpinBox->setVisible(false);
-	ui.lblLookaheadFrames->setVisible(false);
-#endif
 
-#if X264_BUILD < 75
-	ui.threadedLookaheadCheckBox->setVisible(false);
-	ui.threadedLookaheadSpinBox->setVisible(false);
-	ui.lblThreadedFrames->setVisible(false);
-#endif
-
 	ui.sarAsInputLabel->setText(QString("%1:%2").arg(properties->parWidth).arg(properties->parHeight));
 
 	// Motion Estimation tab
@@ -95,33 +81,16 @@
 
 	ui.scenecutDetectionCheckBox->setVisible(false);
 
-#if X264_BUILD < 79
-	ui.lblWeightedPPredict->setVisible(false);
-	ui.weightedPPredictComboBox->setVisible(false);
-#endif
-
 	// Frame tab
 	connect(ui.loopFilterCheckBox, SIGNAL(toggled(bool)), this, SLOT(loopFilterCheckBox_toggled(bool)));
 	connect(ui.cabacCheckBox, SIGNAL(toggled(bool)), this, SLOT(cabacCheckBox_toggled(bool)));
 
-#if X264_BUILD < 77
-	ui.constrainedIntraCheckBox->setVisible(false);
-#endif
-
-#if X264_BUILD < 78
-	ui.bFrameRefComboBox->clear();
-	ui.bFrameRefComboBox->addItem(QT_TR_NOOP("Disabled"));
-	ui.bFrameRefComboBox->addItem(QT_TR_NOOP("Enabled"));
-#endif
-
 	// Analysis tab
 	connect(ui.trellisCheckBox, SIGNAL(toggled(bool)), this, SLOT(trellisCheckBox_toggled(bool)));
 	connect(ui.matrixCustomEditButton, SIGNAL(pressed()), this, SLOT(matrixCustomEditButton_pressed()));
 
 	// Quantiser tab
-#if X264_BUILD >= 69
 	connect(ui.aqVarianceCheckBox, SIGNAL(toggled(bool)), this, SLOT(aqVarianceCheckBox_toggled(bool)));
-#endif
 
 	// Advanced tab
 	ui.zoneTableView->sortByColumn(0, Qt::AscendingOrder);
@@ -137,10 +106,6 @@
 	connect(ui.zoneEditButton, SIGNAL(pressed()), this, SLOT(zoneEditButton_pressed()));
 	connect(ui.zoneDeleteButton, SIGNAL(pressed()), this, SLOT(zoneDeleteButton_pressed()));
 
-#if X264_BUILD < 73
-	ui.slicingGroupBox->setEnabled(false);
-#endif
-
 	QWidgetList widgetList = QApplication::allWidgets();
 
 	for (int widgetIndex = 0; widgetIndex < widgetList.size(); widgetIndex++)
@@ -430,7 +395,6 @@
 		lastBitrate = value;
 }
 
-#if X264_BUILD >= 69
 void x264ConfigDialog::mbTreeCheckBox_toggled(bool checked)
 {
 	if (!disableGenericSlots && checked && !ui.aqVarianceCheckBox->isChecked())
@@ -441,7 +405,6 @@
 			ui.mbTreeCheckBox->setChecked(false);
 	}
 }
-#endif
 
 // Motion Estimation tab
 void x264ConfigDialog::meSlider_valueChanged(int value)
@@ -514,7 +477,6 @@
 }
 
 // Quantiser tab
-#if X264_BUILD >= 69
 void x264ConfigDialog::aqVarianceCheckBox_toggled(bool checked)
 {
 	if (!disableGenericSlots && !checked && ui.mbTreeCheckBox->isChecked())
@@ -525,7 +487,6 @@
 			ui.aqVarianceCheckBox->setChecked(true);
 	}
 }
-#endif
 
 // Advanced tab
 void x264ConfigDialog::zoneAddButton_pressed()
@@ -636,10 +597,8 @@
 			break;
 	}
 
-#if X264_BUILD >= 69
 	ui.mbTreeCheckBox->setChecked(options->getMbTree());
 	ui.lookaheadSpinBox->setValue(options->getFrametypeLookahead());
-#endif
 
 	if (options->getSarAsInput())
 		ui.sarAsInputRadioButton->setChecked(true);
@@ -679,14 +638,12 @@
 			ui.threadCustomSpinBox->setValue(options->getThreads());
 	}
 
-#if X264_BUILD >= 75
 	int threadedLookahead = options->getThreadedLookahead();
 
 	ui.threadedLookaheadCheckBox->setChecked(threadedLookahead > -1);
 
 	if (threadedLookahead > -1)
 		ui.threadedLookaheadSpinBox->setValue(threadedLookahead);
-#endif
 
 	// Motion Estimation tab
 	ui.meSpinBox->setValue(options->getSubpixelRefinement());
@@ -711,10 +668,7 @@
 
 	ui.predictModeComboBox->setCurrentIndex(options->getDirectPredictionMode());
 
-#if X264_BUILD >= 79
 	ui.weightedPPredictComboBox->setCurrentIndex(options->getWeightedPredictionPFrames());
-#endif
-
 	ui.weightedPredictCheckBox->setChecked(options->getWeightedPrediction());
 
 	// Partition tab
@@ -729,10 +683,7 @@
 	// Frame tab
 	ui.cabacCheckBox->setChecked(options->getCabac());
 	ui.interlacedCheckBox->setChecked(options->getInterlaced());
-
-#if X264_BUILD >= 77
 	ui.constrainedIntraCheckBox->setChecked(options->getConstrainedIntraPrediction());
-#endif
 
 	ui.loopFilterCheckBox->setChecked(options->getLoopFilter());
 	ui.alphaC0SpinBox->setValue(options->getLoopFilterAlphaC0());
@@ -805,11 +756,9 @@
 	ui.vbvBufferSizeSpinBox->setValue(options->getVbvBufferSize());
 	ui.vbvBufferOccupancySpinBox->setValue((int)floor(options->getVbvInitialOccupancy() * 100 + .5));
 
-#if X264_BUILD >= 73
 	ui.maxSliceSizeSpinBox->setValue(options->getSliceMaxSize());
 	ui.maxSliceMbSpinBox->setValue(options->getSliceMaxMacroblocks());
 	ui.slicesPerFrameSpinBox->setValue(options->getSliceCount());
-#endif
 
 	zoneTableModel.removeRows();
 
@@ -880,11 +829,8 @@
 
 	options->setPresetConfiguration(ui.configurationComboBox->currentText().toUtf8().constData(), configurationType);
 
-#if X264_BUILD >= 69
 	options->setMbTree(ui.mbTreeCheckBox->isChecked());
 	options->setFrametypeLookahead(ui.lookaheadSpinBox->value());
-#endif
-
 	options->setSarAsInput(ui.sarAsInputRadioButton->isChecked());
 
 	if (ui.sarCustomRadioButton->isChecked())
@@ -911,12 +857,10 @@
 	else
 		options->setThreads(ui.threadCustomSpinBox->value());
 
-#if X264_BUILD >= 75
 	if (ui.threadedLookaheadCheckBox->isChecked())
 		options->setThreadedLookahead(ui.threadedLookaheadSpinBox->value());
 	else
 		options->setThreadedLookahead(-1);
-#endif
 
 	// Motion Estimation tab
 	options->setSubpixelRefinement(ui.meSpinBox->value());
@@ -935,10 +879,7 @@
 
 	options->setDirectPredictionMode(ui.predictModeComboBox->currentIndex());
 
-#if X264_BUILD >= 79
 	options->setWeightedPredictionPFrames(ui.weightedPPredictComboBox->currentIndex());
-#endif
-
 	options->setWeightedPrediction(ui.weightedPredictCheckBox->isChecked());
 	options->setDct8x8(ui.dct8x8CheckBox->isChecked());
 	options->setPartitionP8x8(ui.p8x8CheckBox->isChecked());
@@ -951,10 +892,7 @@
 	options->setCabac(ui.cabacCheckBox->isChecked());
 	options->setInterlaced(ui.interlacedCheckBox->isChecked());
 
-#if X264_BUILD >= 77
 	options->setConstrainedIntraPrediction(ui.constrainedIntraCheckBox->isChecked());
-#endif
-
 	options->setLoopFilter(ui.loopFilterCheckBox->isChecked());
 	options->setLoopFilterAlphaC0(ui.alphaC0SpinBox->value());
 	options->setLoopFilterBeta(ui.betaSpinBox->value());
@@ -1022,12 +960,9 @@
 	options->setVbvMaximumBitrate(ui.vbvMaxBitrateSpinBox->value());
 	options->setVbvBufferSize(ui.vbvBufferSizeSpinBox->value());
 	options->setVbvInitialOccupancy((float)ui.vbvBufferOccupancySpinBox->value() / 100);
-
-#if X264_BUILD >= 73
 	options->setSliceMaxSize(ui.maxSliceSizeSpinBox->value());
 	options->setSliceMaxMacroblocks(ui.maxSliceMbSpinBox->value());
 	options->setSliceCount(ui.slicesPerFrameSpinBox->value());
-#endif
 
 	options->clearZones();
 

Modified: branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_x264/qt4/x264ConfigDialog.h
===================================================================
--- branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_x264/qt4/x264ConfigDialog.h	2010-05-20 18:22:40 UTC (rev 6211)
+++ branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_x264/qt4/x264ConfigDialog.h	2010-05-20 18:37:22 UTC (rev 6212)
@@ -72,9 +72,7 @@
 	void quantiserSlider_valueChanged(int value);
 	void quantiserSpinBox_valueChanged(int value);
 	void targetRateControlSpinBox_valueChanged(int value);
-#if X264_BUILD >= 69
 	void mbTreeCheckBox_toggled(bool checked);
-#endif
 
 	// Motion Estimation tab
 	void meSlider_valueChanged(int value);
@@ -91,9 +89,7 @@
 	void matrixCustomEditButton_pressed();
 
 	// Quantiser tab
-#if X264_BUILD >= 69
 	void aqVarianceCheckBox_toggled(bool checked);
-#endif
 
 	// Advanced Rate Control tab
 	void zoneAddButton_pressed();

Modified: branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_x264/x264Options.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_x264/x264Options.cpp	2010-05-20 18:22:40 UTC (rev 6211)
+++ branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_x264/x264Options.cpp	2010-05-20 18:37:22 UTC (rev 6212)
@@ -96,7 +96,6 @@
 	_param.b_deterministic = deterministic;
 }
 
-#if X264_BUILD >= 75
 int x264Options::getThreadedLookahead(void)
 {
 	return _param.i_sync_lookahead;
@@ -107,7 +106,6 @@
 	if (frames >= -1 && frames <= 250)
 		_param.i_sync_lookahead = frames;
 }
-#endif
 
 int x264Options::getIdcLevel(void)
 {
@@ -323,21 +321,13 @@
 
 unsigned int x264Options::getBFrameReferences(void)
 {
-#if X264_BUILD >= 78
 	return _param.i_bframe_pyramid;
-#else
-	return _param.b_bframe_pyramid;
-#endif
 }
 
 void x264Options::setBFrameReferences(unsigned int bFrameReferences)
 {
-#if X264_BUILD >= 78
 	if (bFrameReferences <= 2)
 		_param.i_bframe_pyramid = bFrameReferences;
-#else
-	_param.b_bframe_pyramid = !!bFrameReferences;
-#endif
 }
 
 bool x264Options::getLoopFilter(void)
@@ -392,7 +382,6 @@
 	_param.b_interlaced = interlaced;
 }
 
-#if X264_BUILD >= 77
 bool x264Options::getConstrainedIntraPrediction(void)
 {
 	return _param.b_constrained_intra;
@@ -402,7 +391,6 @@
 {
 	_param.b_constrained_intra = constrainedIntra;
 }
-#endif
 
 unsigned int x264Options::getCqmPreset(void)
 {
@@ -550,7 +538,6 @@
 	_param.analyse.b_transform_8x8 = dct8x8;
 }
 
-#if X264_BUILD >= 79
 unsigned int x264Options::getWeightedPredictionPFrames(void)
 {
 	return _param.analyse.i_weighted_pred;
@@ -560,7 +547,6 @@
 {
 	_param.analyse.i_weighted_pred = weightedPrediction;
 }
-#endif
 
 bool x264Options::getWeightedPrediction(void)
 {
@@ -863,7 +849,6 @@
 	_param.rc.f_aq_strength = adaptiveQuantiserStrength;
 }
 
-#if X264_BUILD >= 69
 bool x264Options::getMbTree(void)
 {
 	return _param.rc.b_mb_tree;
@@ -884,7 +869,6 @@
 	if (frames <= 250)
 		_param.rc.i_lookahead = frames;
 }
-#endif
 
 float x264Options::getQuantiserCurveCompression(void)
 {
@@ -979,7 +963,6 @@
 	}
 }
 
-#if X264_BUILD >= 73
 unsigned int x264Options::getSliceMaxSize(void)
 {
 	return _param.i_slice_max_size;
@@ -1009,7 +992,6 @@
 {
 	_param.i_slice_count = sliceCount;
 }
-#endif
 
 void x264Options::addOptionsToXml(xmlNodePtr xmlNodeRoot)
 {
@@ -1020,9 +1002,7 @@
 	xmlNodeRoot = xmlNewChild(xmlNodeRoot, NULL, (xmlChar*)getOptionsTagRoot(), NULL);
 	xmlNewChild(xmlNodeRoot, NULL, (xmlChar*)"threads", number2String(xmlBuffer, bufferSize, getThreads()));
 	xmlNewChild(xmlNodeRoot, NULL, (xmlChar*)"deterministic", boolean2String(xmlBuffer, bufferSize, getDeterministic()));
-#if X264_BUILD >= 75
 	xmlNewChild(xmlNodeRoot, NULL, (xmlChar*)"threadedLookahead", number2String(xmlBuffer, bufferSize, getThreadedLookahead()));
-#endif
 	xmlNewChild(xmlNodeRoot, NULL, (xmlChar*)"idcLevel", number2String(xmlBuffer, bufferSize, getIdcLevel()));
 
 	xmlNodeChild = xmlNewChild(xmlNodeRoot, NULL, (xmlChar*)"vui", NULL);
@@ -1168,7 +1148,6 @@
 	xmlNewChild(xmlNodeRoot, NULL, (xmlChar*)"adaptiveBframeDecision", number2String(xmlBuffer, bufferSize, getAdaptiveBFrameDecision()));
 	xmlNewChild(xmlNodeRoot, NULL, (xmlChar*)"bFrameBias", number2String(xmlBuffer, bufferSize, getBFrameBias()));
 
-#if X264_BUILD >= 78
 	switch (getBFrameReferences())
 	{
 		case 0:
@@ -1183,19 +1162,12 @@
 	}
 
 	xmlNewChild(xmlNodeRoot, NULL, (xmlChar*)"bFrameReferences", xmlBuffer);
-#else
-	xmlNewChild(xmlNodeRoot, NULL, (xmlChar*)"bFrameReferences", boolean2String(xmlBuffer, bufferSize, (bool)getBFrameReferences()));
-#endif
-
-
 	xmlNewChild(xmlNodeRoot, NULL, (xmlChar*)"loopFilter", boolean2String(xmlBuffer, bufferSize, getLoopFilter()));
 	xmlNewChild(xmlNodeRoot, NULL, (xmlChar*)"loopFilterAlphaC0", number2String(xmlBuffer, bufferSize, getLoopFilterAlphaC0()));
 	xmlNewChild(xmlNodeRoot, NULL, (xmlChar*)"loopFilterBeta", number2String(xmlBuffer, bufferSize, getLoopFilterBeta()));
 	xmlNewChild(xmlNodeRoot, NULL, (xmlChar*)"cabac", boolean2String(xmlBuffer, bufferSize, getCabac()));
 	xmlNewChild(xmlNodeRoot, NULL, (xmlChar*)"interlaced", boolean2String(xmlBuffer, bufferSize, getInterlaced()));
-#if X264_BUILD >= 77
 	xmlNewChild(xmlNodeRoot, NULL, (xmlChar*)"constrainedIntraPrediction", boolean2String(xmlBuffer, bufferSize, getConstrainedIntraPrediction()));
-#endif
 
 	switch (getCqmPreset())
 	{
@@ -1257,7 +1229,6 @@
 	xmlNewChild(xmlNodeChild, NULL, (xmlChar*)"partitionB8x8", boolean2String(xmlBuffer, bufferSize, getPartitionB8x8()));
 	xmlNewChild(xmlNodeChild, NULL, (xmlChar*)"dct8x8", boolean2String(xmlBuffer, bufferSize, getDct8x8()));
 
-#if X264_BUILD >= 79
 	switch (getWeightedPredictionPFrames())
 	{
 		case X264_WEIGHTP_NONE:
@@ -1272,8 +1243,6 @@
 	}
 
 	xmlNewChild(xmlNodeChild, NULL, (xmlChar*)"weightedPredictionPframes", xmlBuffer);
-#endif
-
 	xmlNewChild(xmlNodeChild, NULL, (xmlChar*)"weightedPrediction", boolean2String(xmlBuffer, bufferSize, getWeightedPrediction()));
 
 	switch (getDirectPredictionMode())
@@ -1367,12 +1336,8 @@
 
 	xmlNewChild(xmlNodeChild, NULL, (xmlChar*)"adaptiveQuantiserMode", xmlBuffer);
 	xmlNewChild(xmlNodeChild, NULL, (xmlChar*)"adaptiveQuantiserStrength", number2String(xmlBuffer, bufferSize, getAdaptiveQuantiserStrength()));
-
-#if X264_BUILD >= 69
 	xmlNewChild(xmlNodeChild, NULL, (xmlChar*)"mbTree", boolean2String(xmlBuffer, bufferSize, getMbTree()));
 	xmlNewChild(xmlNodeChild, NULL, (xmlChar*)"frametypeLookahead", number2String(xmlBuffer, bufferSize, getFrametypeLookahead()));
-#endif
-
 	xmlNewChild(xmlNodeChild, NULL, (xmlChar*)"quantiserCurveCompression", number2String(xmlBuffer, bufferSize, getQuantiserCurveCompression()));
 	xmlNewChild(xmlNodeChild, NULL, (xmlChar*)"reduceFluxBeforeCurveCompression", number2String(xmlBuffer, bufferSize, getReduceFluxBeforeCurveCompression()));
 	xmlNewChild(xmlNodeChild, NULL, (xmlChar*)"reduceFluxAfterCurveCompression", number2String(xmlBuffer, bufferSize, getReduceFluxAfterCurveCompression()));
@@ -1404,12 +1369,9 @@
 
 	xmlNewChild(xmlNodeRoot, NULL, (xmlChar*)"accessUnitDelimiters", boolean2String(xmlBuffer, bufferSize, getAccessUnitDelimiters()));
 	xmlNewChild(xmlNodeRoot, NULL, (xmlChar*)"spsIdentifier", number2String(xmlBuffer, bufferSize, getSpsIdentifier()));
-
-#if X264_BUILD >= 73
 	xmlNewChild(xmlNodeRoot, NULL, (xmlChar*)"sliceMaxSize", number2String(xmlBuffer, bufferSize, getSliceMaxSize()));
 	xmlNewChild(xmlNodeRoot, NULL, (xmlChar*)"sliceMaxMacroblocks", number2String(xmlBuffer, bufferSize, getSliceMaxMacroblocks()));
 	xmlNewChild(xmlNodeRoot, NULL, (xmlChar*)"sliceCount", number2String(xmlBuffer, bufferSize, getSliceCount()));
-#endif
 }
 
 int x264Options::fromXml(const char *xml, PluginXmlType xmlType)
@@ -1431,10 +1393,8 @@
 				setThreads(atoi(content));
 			else if (strcmp((char*)xmlChild->name, "deterministic") == 0)
 				setDeterministic(string2Boolean(content));
-#if X264_BUILD >= 75
 			else if (strcmp((char*)xmlChild->name, "threadedLookahead") == 0)
 				setThreadedLookahead(atoi(content));
-#endif
 			else if (strcmp((char*)xmlChild->name, "idcLevel") == 0)
 				setIdcLevel(atoi(content));
 			else if (strcmp((char*)xmlChild->name, "vui") == 0)
@@ -1460,11 +1420,7 @@
 				if (strcmp(content, "strict") == 0)
 					bFrameReferences = 1;
 				else if (strcmp(content, "normal") == 0 || strcmp(content, "1") == 0 || strcmp(content, "true") == 0)
-#if X264_BUILD >= 78
 					bFrameReferences = 2;
-#else
-					bFrameReferences = 1;
-#endif
 
 				setBFrameReferences(bFrameReferences);
 			}
@@ -1478,10 +1434,8 @@
 				setCabac(string2Boolean(content));
 			else if (strcmp((char*)xmlChild->name, "interlaced") == 0)
 				setInterlaced(string2Boolean(content));
-#if X264_BUILD >= 77
 			else if (strcmp((char*)xmlChild->name, "constrainedIntraPrediction") == 0)
 				setConstrainedIntraPrediction(string2Boolean(content));
-#endif
 			else if (strcmp((char*)xmlChild->name, "cqmPreset") == 0)
 			{
 				int cqmPreset = 0;
@@ -1545,14 +1499,12 @@
 				setAccessUnitDelimiters(string2Boolean(content));
 			else if (strcmp((char*)xmlChild->name, "spsIdentifier") == 0)
 				setSpsIdentifier(atoi(content));
-#if X264_BUILD >= 73
 			else if (strcmp((char*)xmlChild->name, "sliceMaxSize") == 0)
 				setSliceMaxSize(atoi(content));
 			else if (strcmp((char*)xmlChild->name, "sliceMaxMacroblocks") == 0)
 				setSliceMaxMacroblocks(atoi(content));
 			else if (strcmp((char*)xmlChild->name, "sliceCount") == 0)
 				setSliceCount(atoi(content));
-#endif
 
 			xmlFree(content);
 		}
@@ -1722,7 +1674,6 @@
 				setPartitionB8x8(string2Boolean(content));
 			else if (strcmp((char*)xmlChild->name, "dct8x8") == 0)
 				setDct8x8(string2Boolean(content));
-#if X264_BUILD >= 79
 			else if (strcmp((char*)xmlChild->name, "weightedPredictionPframes") == 0)
 			{
 				int weightedPredPFrames = X264_WEIGHTP_NONE;
@@ -1734,7 +1685,6 @@
 
 				setWeightedPredictionPFrames(weightedPredPFrames);
 			}
-#endif
 			else if (strcmp((char*)xmlChild->name, "weightedPrediction") == 0)
 				setWeightedPrediction(string2Boolean(content));
 			else if (strcmp((char*)xmlChild->name, "directPredictionMode") == 0)
@@ -1853,12 +1803,10 @@
 			}
 			else if (strcmp((char*)xmlChild->name, "adaptiveQuantiserStrength") == 0)
 				setAdaptiveQuantiserStrength(string2Float(content));
-#if X264_BUILD >= 69
 			else if (strcmp((char*)xmlChild->name, "mbTree") == 0)
 				setMbTree(string2Boolean(content));
 			else if (strcmp((char*)xmlChild->name, "frametypeLookahead") == 0)
 				setFrametypeLookahead(atoi(content));
-#endif
 			else if (strcmp((char*)xmlChild->name, "quantiserCurveCompression") == 0)
 				setQuantiserCurveCompression(string2Float(content));
 			else if (strcmp((char*)xmlChild->name, "reduceFluxBeforeCurveCompression") == 0)

Modified: branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_x264/x264Options.h
===================================================================
--- branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_x264/x264Options.h	2010-05-20 18:22:40 UTC (rev 6211)
+++ branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_x264/x264Options.h	2010-05-20 18:37:22 UTC (rev 6212)
@@ -64,10 +64,8 @@
 	bool getDeterministic(void);
 	void setDeterministic(bool deterministic);
 
-#if X264_BUILD >= 75
 	int getThreadedLookahead(void);
 	void setThreadedLookahead(int frames);
-#endif
 
 	int getIdcLevel(void);
 	void setIdcLevel(int idcLevel);
@@ -141,10 +139,8 @@
 	bool getInterlaced(void);
 	void setInterlaced(bool interlaced);
 
-#if X264_BUILD >= 77
 	bool getConstrainedIntraPrediction(void);
 	void setConstrainedIntraPrediction(bool constrainedIntra);
-#endif
 
 	unsigned int getCqmPreset(void);
 	void setCqmPreset(unsigned int cqmPreset);
@@ -185,10 +181,8 @@
 	bool getDct8x8(void);
 	void setDct8x8(bool dct8x8);
 
-#if X264_BUILD >= 79
 	unsigned int getWeightedPredictionPFrames(void);
 	void setWeightedPredictionPFrames(unsigned int weightedPrediction);
-#endif
 
 	bool getWeightedPrediction(void);
 	void setWeightedPrediction(bool weightedPrediction);
@@ -280,13 +274,11 @@
 	float getAdaptiveQuantiserStrength(void);
 	void setAdaptiveQuantiserStrength(float adaptiveQuantiserStrength);
 
-#if X264_BUILD >= 69
 	bool getMbTree(void);
 	void setMbTree(bool mbTree);
 
 	unsigned int getFrametypeLookahead(void);
 	void setFrametypeLookahead(unsigned int frames);
-#endif
 
 	float getQuantiserCurveCompression(void);
 	void setQuantiserCurveCompression(float quantiserCurveCompression);
@@ -308,7 +300,6 @@
 	unsigned int getSpsIdentifier(void);
 	void setSpsIdentifier(unsigned int spsIdentifier);
 
-#if X264_BUILD >= 73
 	unsigned int getSliceMaxSize(void);
 	void setSliceMaxSize(unsigned int maxSize);
 
@@ -317,7 +308,6 @@
 
 	unsigned int getSliceCount(void);
 	void setSliceCount(unsigned int sliceCount);
-#endif
 
 	int fromXml(const char *xml, PluginXmlType xmlType);
 };



From gruntster at mail.berlios.de  Thu May 20 21:10:19 2010
From: gruntster at mail.berlios.de (gruntster at mail.berlios.de)
Date: Thu, 20 May 2010 21:10:19 +0200
Subject: [Avidemux-svn-commit] r6213 - in
	branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_x264:
	. qt4
Message-ID: <201005201910.o4KJAJrs009893@sheep.berlios.de>

Author: gruntster
Date: 2010-05-20 21:10:12 +0200 (Thu, 20 May 2010)
New Revision: 6213

Modified:
   branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_x264/qt4/x264ConfigDialog.cpp
   branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_x264/qt4/x264ConfigDialog.ui
   branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_x264/x264Options.cpp
   branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_x264/x264Options.h
   branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_x264/x264Param.xsd
Log:
[x264] add support for slice-based threading

Modified: branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_x264/qt4/x264ConfigDialog.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_x264/qt4/x264ConfigDialog.cpp	2010-05-20 18:37:22 UTC (rev 6212)
+++ branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_x264/qt4/x264ConfigDialog.cpp	2010-05-20 19:10:12 UTC (rev 6213)
@@ -638,6 +638,9 @@
 			ui.threadCustomSpinBox->setValue(options->getThreads());
 	}
 
+	ui.repeatabilityCheckBox->setChecked(options->getDeterministic());
+	ui.sliceThreadingCheckBox->setChecked(options->getSliceThreading());
+
 	int threadedLookahead = options->getThreadedLookahead();
 
 	ui.threadedLookaheadCheckBox->setChecked(threadedLookahead > -1);
@@ -783,7 +786,6 @@
 
 	strSpsId.setNum(options->getSpsIdentifier());
 	ui.spsiComboBox->setCurrentIndex(ui.spsiComboBox->findText(strSpsId));
-	ui.repeatabilityCheckBox->setChecked(options->getDeterministic());
 	ui.accessUnitCheckBox->setChecked(options->getAccessUnitDelimiters());
 	ui.overscanComboBox->setCurrentIndex(options->getOverscan());
 	ui.videoFormatComboBox->setCurrentIndex(getValueIndexInArray(options->getVideoFormat(), videoFormat, videoFormatCount));
@@ -857,6 +859,9 @@
 	else
 		options->setThreads(ui.threadCustomSpinBox->value());
 
+	options->setSliceThreading(ui.sliceThreadingCheckBox->isChecked());
+	options->setDeterministic(ui.repeatabilityCheckBox->isChecked());
+
 	if (ui.threadedLookaheadCheckBox->isChecked())
 		options->setThreadedLookahead(ui.threadedLookaheadSpinBox->value());
 	else
@@ -974,7 +979,6 @@
 	// Output tab
 	options->setIdcLevel(idcLevel[ui.idcLevelComboBox->currentIndex()]);
 	options->setSpsIdentifier(ui.spsiComboBox->currentText().toInt());
-	options->setDeterministic(ui.repeatabilityCheckBox->isChecked());
 	options->setAccessUnitDelimiters(ui.accessUnitCheckBox->isChecked());
 	options->setOverscan(ui.overscanComboBox->currentIndex());
 	options->setVideoFormat(videoFormat[ui.videoFormatComboBox->currentIndex()]);

Modified: branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_x264/qt4/x264ConfigDialog.ui
===================================================================
--- branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_x264/qt4/x264ConfigDialog.ui	2010-05-20 18:37:22 UTC (rev 6212)
+++ branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_x264/qt4/x264ConfigDialog.ui	2010-05-20 19:10:12 UTC (rev 6213)
@@ -7,7 +7,7 @@
     <x>0</x>
     <y>0</y>
     <width>523</width>
-    <height>590</height>
+    <height>580</height>
    </rect>
   </property>
   <property name="windowTitle" >
@@ -566,6 +566,13 @@
            </widget>
           </item>
           <item>
+           <widget class="QCheckBox" name="sliceThreadingCheckBox" >
+            <property name="text" >
+             <string>Slice-based Threading</string>
+            </property>
+           </widget>
+          </item>
+          <item>
            <layout class="QHBoxLayout" >
             <property name="margin" >
              <number>0</number>
@@ -4237,6 +4244,7 @@
   <tabstop>threadCustomRadioButton</tabstop>
   <tabstop>threadCustomSpinBox</tabstop>
   <tabstop>repeatabilityCheckBox</tabstop>
+  <tabstop>sliceThreadingCheckBox</tabstop>
   <tabstop>threadedLookaheadCheckBox</tabstop>
   <tabstop>threadedLookaheadSpinBox</tabstop>
   <tabstop>meMethodComboBox</tabstop>

Modified: branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_x264/x264Options.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_x264/x264Options.cpp	2010-05-20 18:37:22 UTC (rev 6212)
+++ branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_x264/x264Options.cpp	2010-05-20 19:10:12 UTC (rev 6213)
@@ -96,6 +96,16 @@
 	_param.b_deterministic = deterministic;
 }
 
+bool x264Options::getSliceThreading(void)
+{
+	return _param.b_sliced_threads;
+}
+
+void x264Options::setSliceThreading(bool sliceThreading)
+{
+	_param.b_sliced_threads = sliceThreading;
+}
+
 int x264Options::getThreadedLookahead(void)
 {
 	return _param.i_sync_lookahead;
@@ -1002,6 +1012,7 @@
 	xmlNodeRoot = xmlNewChild(xmlNodeRoot, NULL, (xmlChar*)getOptionsTagRoot(), NULL);
 	xmlNewChild(xmlNodeRoot, NULL, (xmlChar*)"threads", number2String(xmlBuffer, bufferSize, getThreads()));
 	xmlNewChild(xmlNodeRoot, NULL, (xmlChar*)"deterministic", boolean2String(xmlBuffer, bufferSize, getDeterministic()));
+	xmlNewChild(xmlNodeRoot, NULL, (xmlChar*)"sliceThreading", boolean2String(xmlBuffer, bufferSize, getSliceThreading()));
 	xmlNewChild(xmlNodeRoot, NULL, (xmlChar*)"threadedLookahead", number2String(xmlBuffer, bufferSize, getThreadedLookahead()));
 	xmlNewChild(xmlNodeRoot, NULL, (xmlChar*)"idcLevel", number2String(xmlBuffer, bufferSize, getIdcLevel()));
 
@@ -1393,6 +1404,8 @@
 				setThreads(atoi(content));
 			else if (strcmp((char*)xmlChild->name, "deterministic") == 0)
 				setDeterministic(string2Boolean(content));
+			else if (strcmp((char*)xmlChild->name, "sliceThreading") == 0)
+				setSliceThreading(string2Boolean(content));
 			else if (strcmp((char*)xmlChild->name, "threadedLookahead") == 0)
 				setThreadedLookahead(atoi(content));
 			else if (strcmp((char*)xmlChild->name, "idcLevel") == 0)

Modified: branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_x264/x264Options.h
===================================================================
--- branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_x264/x264Options.h	2010-05-20 18:37:22 UTC (rev 6212)
+++ branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_x264/x264Options.h	2010-05-20 19:10:12 UTC (rev 6213)
@@ -64,6 +64,9 @@
 	bool getDeterministic(void);
 	void setDeterministic(bool deterministic);
 
+	bool getSliceThreading(void);
+	void setSliceThreading(bool sliceThreading);
+
 	int getThreadedLookahead(void);
 	void setThreadedLookahead(int frames);
 

Modified: branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_x264/x264Param.xsd
===================================================================
--- branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_x264/x264Param.xsd	2010-05-20 18:37:22 UTC (rev 6212)
+++ branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_x264/x264Param.xsd	2010-05-20 19:10:12 UTC (rev 6213)
@@ -42,6 +42,7 @@
             <xs:sequence>
               <xs:element name="threads" type="uint" minOccurs="0"/>
               <xs:element name="deterministic" type="xs:boolean" minOccurs="0"/>
+              <xs:element name="sliceThreading" type="xs:boolean" minOccurs="0"/>
               <xs:element name="threadedLookahead" minOccurs="0">
                 <xs:simpleType>
                   <xs:restriction base="xs:integer">



From mean at mail.berlios.de  Sun May 23 17:25:53 2010
From: mean at mail.berlios.de (mean at BerliOS)
Date: Sun, 23 May 2010 17:25:53 +0200
Subject: [Avidemux-svn-commit] r6214 - in branches/avidemux_2.6_branch_mean:
	avidemux/common/ADM_editor avidemux/common/ADM_script2/include
	avidemux/common/ADM_script2/js avidemux/common/ADM_script2/py
	avidemux/common/ADM_script2/src
	avidemux/qt4/ADM_userInterfaces/ADM_shell
	avidemux_core/ADM_coreTinyPy/include
	avidemux_core/ADM_coreTinyPy/src
Message-ID: <201005231525.o4NFPrBI008876@sheep.berlios.de>

Author: mean
Date: 2010-05-23 17:25:52 +0200 (Sun, 23 May 2010)
New Revision: 6214

Modified:
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_editor/ADM_segment.cpp
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/include/ADM_scriptIf.h
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/js/ADM_js.h
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/js/ADM_jsAudio.cpp
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/js/ADM_jsAvidemux.cpp
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/js/ADM_jsDebug.cpp
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/js/ADM_jsEditor.cpp
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/js/ADM_jsIf.cpp
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/js/ADM_jsTestFactory.cpp
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/js/ADM_jsVideo.cpp
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/py/ADM_pyAdm.cpp
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src/ADM_scriptAvidemux.cpp
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src/ADM_scriptIf.cpp
   branches/avidemux_2.6_branch_mean/avidemux/qt4/ADM_userInterfaces/ADM_shell/Q_shell.cpp
   branches/avidemux_2.6_branch_mean/avidemux/qt4/ADM_userInterfaces/ADM_shell/Q_shell.h
   branches/avidemux_2.6_branch_mean/avidemux/qt4/ADM_userInterfaces/ADM_shell/qt4Shell.cpp
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreTinyPy/include/ADM_tinypy.h
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreTinyPy/src/ADM_tinypy.cpp
Log:
[js/py] factorize logger + add help() python call

Modified: branches/avidemux_2.6_branch_mean/avidemux/common/ADM_editor/ADM_segment.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/ADM_editor/ADM_segment.cpp	2010-05-20 19:10:12 UTC (rev 6213)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/ADM_editor/ADM_segment.cpp	2010-05-23 15:25:52 UTC (rev 6214)
@@ -482,12 +482,12 @@
     {
         _SEGMENT *s=getSegment(i);
         
-        jsLog(JS_LOG_NORMAL,"Segment :%d/%d",i,n);
-        jsLog(JS_LOG_NORMAL,"\tReference    :%"LU,s->_reference,ADM_us2plain(s->_reference));
-        jsLog(JS_LOG_NORMAL,"\tstartLinear  :%08"LLU" %s",s->_startTimeUs,ADM_us2plain(s->_startTimeUs));
-        jsLog(JS_LOG_NORMAL,"\tduration     :%08"LLU" %s",s->_durationUs,ADM_us2plain(s->_durationUs));
-        jsLog(JS_LOG_NORMAL,"\trefStartPts  :%08"LLU" %s",s->_refStartTimeUs,ADM_us2plain(s->_refStartTimeUs));
-        jsLog(JS_LOG_NORMAL,"\trefStartDts  :%08"LLU" %s",s->_refStartDts,ADM_us2plain(s->_refStartDts));
+        jsLog("Segment :%d/%d",i,n);
+        jsLog( "\tReference    :%"LU,s->_reference,ADM_us2plain(s->_reference));
+        jsLog( "\tstartLinear  :%08"LLU" %s",s->_startTimeUs,ADM_us2plain(s->_startTimeUs));
+        jsLog( "\tduration     :%08"LLU" %s",s->_durationUs,ADM_us2plain(s->_durationUs));
+        jsLog( "\trefStartPts  :%08"LLU" %s",s->_refStartTimeUs,ADM_us2plain(s->_refStartTimeUs));
+        jsLog( "\trefStartDts  :%08"LLU" %s",s->_refStartDts,ADM_us2plain(s->_refStartDts));
     }
 }
 /**
@@ -503,10 +503,10 @@
     {
         _VIDEOS *s=getRefVideo(i);
 
-        jsLog(JS_LOG_NORMAL,"Videos :%d/%d",i,n);
-        jsLog(JS_LOG_NORMAL,"\tfirstFramePts      :%08"LLU" %s",s->firstFramePts,ADM_us2plain(s->firstFramePts));
-        jsLog(JS_LOG_NORMAL,"\ttimeIncrementInUs  :%08"LLU" %s",s->timeIncrementInUs,ADM_us2plain(s->timeIncrementInUs));
-        jsLog(JS_LOG_NORMAL,"\tnb frames    :%08"LLU,s->_nb_video_frames);
+        jsLog("Videos :%d/%d",i,n);
+        jsLog("\tfirstFramePts      :%08"LLU" %s",s->firstFramePts,ADM_us2plain(s->firstFramePts));
+        jsLog("\ttimeIncrementInUs  :%08"LLU" %s",s->timeIncrementInUs,ADM_us2plain(s->timeIncrementInUs));
+        jsLog("\tnb frames    :%08"LLU,s->_nb_video_frames);
     }
 
 }

Modified: branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/include/ADM_scriptIf.h
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/include/ADM_scriptIf.h	2010-05-20 19:10:12 UTC (rev 6213)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/include/ADM_scriptIf.h	2010-05-23 15:25:52 UTC (rev 6214)
@@ -19,19 +19,23 @@
 */
 typedef enum
 {
-    JS_LOG_NORMAL,
-    JS_LOG_ERROR
-}JS_LOG_TYPE;
+    SCRIPT_LOG_NORMAL,
+    SCRIPT_LOG_ERROR
+}SCRIPT_LOG_TYPE;
 /**
     \typedef jsLoggerFunc
 */
-typedef bool (jsLoggerFunc)(void *cookie,JS_LOG_TYPE type,const char *);
+typedef bool (scriptLoggerFunc)(void *cookie,SCRIPT_LOG_TYPE type,const char *);
 /*
+    Interface used by shell
+*/
+bool ADM_scriptRegisterLogger(void *cookie,scriptLoggerFunc *fun);
+bool ADM_scriptUnregisterLogger(void);
+/**
 
 */
-bool ADM_jsRegisterLogger(void *cookie,jsLoggerFunc *fun);
-bool ADM_jsUnregisterLogger(void);
-
+bool jsLog(const char *fmt,...);
+bool jsLogError(const char *fmt,...);
 /**
     \fn parseECMAScript
     \brief Compile & execute ecma script
@@ -47,7 +51,7 @@
     \fn jsLog
 
 */
-bool jsLog(JS_LOG_TYPE type, const char *fmt,...);
+bool scriptLog(SCRIPT_LOG_TYPE type, const char *fmt,...);
 
 /**
     \fn SpidermonkeyInit

Modified: branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/js/ADM_js.h
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/js/ADM_js.h	2010-05-20 19:10:12 UTC (rev 6213)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/js/ADM_js.h	2010-05-23 15:25:52 UTC (rev 6214)
@@ -29,7 +29,8 @@
 
 typedef JSBool JS_PROTOTYPE(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval);
 
-
+bool jsLog( const char *fmt,...);
+bool jsLogError( const char *fmt,...);
 /**
     \struct ADM_JS_HOOK
 */

Modified: branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/js/ADM_jsAudio.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/js/ADM_jsAudio.cpp	2010-05-20 19:10:12 UTC (rev 6213)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/js/ADM_jsAudio.cpp	2010-05-23 15:25:52 UTC (rev 6214)
@@ -47,7 +47,7 @@
         if(!audioCodecSetByName(name))
         {
                 *rval = BOOLEAN_TO_JSVAL(false);
-                jsLog(JS_LOG_ERROR,"Cannot set audio codec %s\n",name);
+                jsLogError("Cannot set audio codec %s\n",name);
         }
         else
         {

Modified: branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/js/ADM_jsAvidemux.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/js/ADM_jsAvidemux.cpp	2010-05-20 19:10:12 UTC (rev 6213)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/js/ADM_jsAvidemux.cpp	2010-05-23 15:25:52 UTC (rev 6214)
@@ -33,17 +33,17 @@
         *rval = BOOLEAN_TO_JSVAL(false);
         if(argc < 1)
         {
-            jsLog(JS_LOG_NORMAL,"setContainer needs at least one arg\n");
+            jsLog("setContainer needs at least one arg\n");
             return JS_FALSE;
         }
         
         if(JSVAL_IS_STRING(argv[0]) == false)
         {
-                jsLog(JS_LOG_NORMAL,"setContainer needs at string arg\n");
+                jsLog("setContainer needs at string arg\n");
                 return JS_FALSE;
         }
         char *str = JS_GetStringBytes(JSVAL_TO_STRING(argv[0]));
-         jsLog(JS_LOG_NORMAL,"[JS] Selecting container :%s\n",str);
+         jsLog("[JS] Selecting container :%s\n",str);
         if(A_setContainer(str))
         {
             CONFcouple *c;

Modified: branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/js/ADM_jsDebug.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/js/ADM_jsDebug.cpp	2010-05-20 19:10:12 UTC (rev 6213)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/js/ADM_jsDebug.cpp	2010-05-23 15:25:52 UTC (rev 6214)
@@ -52,11 +52,11 @@
 */
 void jsPrint(const char *s)
 {// begin print
-        jsLog(JS_LOG_NORMAL,"%s",s);
+        jsLog("%s",s);
 }// end print
 void jsPrint2(const char *s)
 {// begin print
-        jsLog(JS_LOG_NORMAL,"%s",s);
+        jsLog("%s",s);
 }// end print
 
 
@@ -64,7 +64,7 @@
 {
     while(f->name)
     {
-        jsLog(JS_LOG_NORMAL,"     %s(..)",f->name);
+        jsLog("     %s(..)",f->name);
         f++;
     }
 }
@@ -87,16 +87,16 @@
 	if( strncmp(buf,"//AD",4) )
     {
             if (report->filename || report->lineno)
-                jsLog(JS_LOG_ERROR,"%s: line %d:\nMsg: %s\n",
+                jsLogError("%s: line %d:\nMsg: %s\n",
                               report->filename,
                               report->lineno,
                               message);
             else
-                jsLog(JS_LOG_ERROR,"Error");
+                jsLogError("Error");
     
 	}else
     {
-            jsLog(JS_LOG_ERROR,"%s: line %d:\nMsg: %s\n",report->filename,report->lineno,message);
+            jsLogError("%s: line %d:\nMsg: %s\n",report->filename,report->lineno,message);
 	}
        
     if(quiet)

Modified: branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/js/ADM_jsEditor.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/js/ADM_jsEditor.cpp	2010-05-20 19:10:12 UTC (rev 6213)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/js/ADM_jsEditor.cpp	2010-05-23 15:25:52 UTC (rev 6214)
@@ -30,10 +30,10 @@
     {
         int64_t delta=0;
         if(pts!=ADM_NO_PTS && dts!=ADM_NO_PTS) delta=(int64_t)pts-(int64_t)dts;
-        jsLog(JS_LOG_NORMAL,"Frame %"LU" : Flags 0x%"LX" pts=%"LLD" dts=%"LLD" delta=%"LLD" ms",framenumber,flags,pts,dts,delta/1000LL);
+        jsLog("Frame %"LU" : Flags 0x%"LX" pts=%"LLD" dts=%"LLD" delta=%"LLD" ms",framenumber,flags,pts,dts,delta/1000LL);
     }else
     {
-        jsLog(JS_LOG_NORMAL,"Cannot get info for frame %"LU,framenumber);
+        jsLog("Cannot get info for frame %"LU,framenumber);
     }
     return 0;
 }

Modified: branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/js/ADM_jsIf.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/js/ADM_jsIf.cpp	2010-05-20 19:10:12 UTC (rev 6213)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/js/ADM_jsIf.cpp	2010-05-23 15:25:52 UTC (rev 6214)
@@ -120,7 +120,7 @@
 {
     while(f->name)
     {
-        jsLog(JS_LOG_NORMAL,"    %s",f->name);
+        jsLog("    %s",f->name);
         f++;
     }
 }
@@ -141,16 +141,16 @@
         {
             const char *t=jsHooks[i].text;
             if(t)
-                jsLog(JS_LOG_NORMAL,"%s",t);
+                jsLog("%s",t);
             return dump(jsHooks[i].jsFunctions);
         }
     }
 //    if(!strcasecmp(s,"load")) return dump(jsGetAvidemuxFunctions());
 none:
-        jsLog(JS_LOG_NORMAL,"please use help(\"xxx\") with xx among");
+        jsLog("please use help(\"xxx\") with xx among");
 
         for(int i=0;i<n;i++)
-            jsLog(JS_LOG_NORMAL,"    %s",jsHooks[i].name);
+            jsLog("    %s",jsHooks[i].name);
 
 }
 } // extern "C"
@@ -283,7 +283,7 @@
 extern "C" void jsSetSuccess(int bSuccess)
 {// begin JS_setSuccess
 	g_bJSSuccess = bSuccess;
-	jsLog(JS_LOG_NORMAL,"[ECMA] success : %d\n", g_bJSSuccess);
+	jsLog("[ECMA] success : %d\n", g_bJSSuccess);
 }// end JS_setSuccess
 /**
     \fn SpidermonkeyExit

Modified: branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/js/ADM_jsTestFactory.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/js/ADM_jsTestFactory.cpp	2010-05-20 19:10:12 UTC (rev 6213)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/js/ADM_jsTestFactory.cpp	2010-05-23 15:25:52 UTC (rev 6214)
@@ -54,7 +54,7 @@
     
   if(diaFactoryRun(QT_TR_NOOP("Test uinteger"),1,elems))
   {
-    jsLog(JS_LOG_NORMAL,"Value : %u\n",tog);
+    jsLog("Value : %u\n",tog);
     return true;
   }
   return false;
@@ -71,7 +71,7 @@
     
   if(diaFactoryRun("Test float",1,elems))
   {
-    jsLog(JS_LOG_NORMAL,"Value : %f\n",(float)tog);
+    jsLog("Value : %f\n",(float)tog);
     return true;
   }
   return false;
@@ -93,7 +93,7 @@
     
   if(diaFactoryRun("Test Toggle",3,elems))
    {
-    jsLog(JS_LOG_NORMAL,"Value : %u\n",tog);
+    jsLog("Value : %u\n",tog);
     return true;
   }
   return false;
@@ -122,7 +122,7 @@
 diaElem *elems[]={&blend,&toggle   };
   if(diaFactoryRun("Test Menu",2,elems))
    {
-    jsLog(JS_LOG_NORMAL,"Value : %"LU"\n",tog);
+    jsLog("Value : %"LU"\n",tog);
     return true;
   }
   return false;
@@ -140,7 +140,7 @@
       diaElem *elems[]={&fread   };
   if(diaFactoryRun("Test FileRead",1,elems))
    {
-    jsLog(JS_LOG_NORMAL,"Value : %s\n",test);
+    jsLog("Value : %s\n",test);
     if(test) ADM_dealloc(test);
     return true;
   }
@@ -160,7 +160,7 @@
   diaElem *elems[]={&fread   };
   if(diaFactoryRun("Test DirSel",1,elems))
   {
-    jsLog(JS_LOG_NORMAL,"Value : %s\n",test);
+    jsLog("Value : %s\n",test);
     if(test) ADM_dealloc(test);
     return true;
   }
@@ -240,7 +240,7 @@
       diaElem *elems[]={&slide   };
   if(diaFactoryRun("Test Slider",1,elems))
   {
-    jsLog(JS_LOG_NORMAL,"Value : %d\n",(int)val);
+    jsLog("Value : %d\n",(int)val);
     return true;
   }
   return false;
@@ -275,7 +275,7 @@
       diaElem *elems[]={&txt   };
   if(diaFactoryRun("Test FileRead",1,elems))
  {
-    jsLog(JS_LOG_NORMAL,"Out:%s",foo);
+    jsLog("Out:%s",foo);
     if(foo) ADM_dealloc(foo);
     return true;
   }
@@ -378,7 +378,7 @@
       for(int x=0;x<4*4;x++)
       {
           if(x && !(x&3)) printf("\n");
-          jsLog(JS_LOG_NORMAL,"%02x ",data[x]);
+          jsLog("%02x ",data[x]);
           
       }
       return true;
@@ -398,7 +398,7 @@
     
   if(diaFactoryRun("Test ThreadCount",1,elems))
   {
-         jsLog(JS_LOG_NORMAL,"Thread: %u ",(unsigned int)val);
+         jsLog("Thread: %u ",(unsigned int)val);
         return true;
   }
   return false;

Modified: branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/js/ADM_jsVideo.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/js/ADM_jsVideo.cpp	2010-05-20 19:10:12 UTC (rev 6213)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/js/ADM_jsVideo.cpp	2010-05-23 15:25:52 UTC (rev 6214)
@@ -41,7 +41,7 @@
                 return JS_FALSE;
         if(JSVAL_IS_STRING(argv[0]) == false )
         {
-                jsLog(JS_LOG_ERROR,"Cannot set codec, first parameter is not a string\n");
+                jsLog("Cannot set codec, first parameter is not a string\n");
                 return JS_FALSE;
         }
         char *codec=JS_GetStringBytes(JSVAL_TO_STRING(argv[0]));
@@ -49,13 +49,13 @@
         
         if(A_setVideoCodec(codec)==false)
         {
-            jsLog(JS_LOG_ERROR,"Could not select codec %s\n",codec);
+            jsLog("Could not select codec %s\n",codec);
             return JS_FALSE;
         }
         CONFcouple *c;
         jsArgToConfCouple(argc-1,&c,argv+1);
         *rval = BOOLEAN_TO_JSVAL( videoEncoder6_SetConfiguration(c));
-        jsLog(JS_LOG_NORMAL,"Selected codec %s\n",codec);
+        jsLog("Selected codec %s\n",codec);
         if(c) delete c;
         return JS_TRUE;
 }// end Codec
@@ -75,7 +75,7 @@
                 return JS_FALSE;
         char *filterName=JS_GetStringBytes(JSVAL_TO_STRING(argv[0]));
         filterTag = ADM_vf_getTagFromInternalName(filterName);
-        jsLog(JS_LOG_NORMAL,"Adding Filter %s -> %"LU"... \n",filterName,filterTag);
+        jsLog("Adding Filter %s -> %"LU"... \n",filterName,filterTag);
 
         
         CONFcouple *c=NULL;

Modified: branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/py/ADM_pyAdm.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/py/ADM_pyAdm.cpp	2010-05-20 19:10:12 UTC (rev 6213)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/py/ADM_pyAdm.cpp	2010-05-23 15:25:52 UTC (rev 6214)
@@ -26,15 +26,39 @@
 
 #include "adm_gen.cpp"
 /**
+
+*/
+static  bool pyLogger(const char *s)
+{
+    jsLog(s);
+    return true;
+}
+/**
+    \fn initPy
+*/  
+static bool initPy(tinyPy *py)
+{
+    py->init();
+    py->registerFuncs("adm",adm_functions);
+    tinyPy::registerLogger(pyLogger);
+    return true;
+}
+static bool deinitPy(tinyPy *py)
+{
+    tinyPy::unregisterLogger();
+    return true;
+}
+/**
     \fn    parseTinyPyScript
     \brief Execute a tinyPy script
 */
 bool parseTinyPyScript(const char *name)
 {
         tinyPy py;
-        py.init();
-        py.registerFuncs("adm",adm_functions);
-        return py.execFile(name);
+        initPy(&py);
+        bool r=py.execFile(name);
+        deinitPy(&py);
+        return r;
 }
 
 /**
@@ -53,10 +77,9 @@
 bool interactiveTinyPy(void)
 {
     myPy=new tinyPy;
-    myPy->init();
-    myPy->registerFuncs("adm",adm_functions);
-
+    initPy(myPy);
     ADM_startShell(pyEvaluate);
+    deinitPy(myPy);
     delete myPy;
     myPy=NULL;
 	A_Resync();

Modified: branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src/ADM_scriptAvidemux.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src/ADM_scriptAvidemux.cpp	2010-05-20 19:10:12 UTC (rev 6213)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src/ADM_scriptAvidemux.cpp	2010-05-23 15:25:52 UTC (rev 6214)
@@ -44,7 +44,7 @@
 int jsLoadVideo(const char *s)
 {
 int ret=0;
-        jsLog(JS_LOG_NORMAL,"[Js] Loading video %s",s);
+        jsLog("[Js] Loading video %s",s);
         if(A_openAvi(s)) 
         {
           ret=1;

Modified: branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src/ADM_scriptIf.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src/ADM_scriptIf.cpp	2010-05-20 19:10:12 UTC (rev 6213)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src/ADM_scriptIf.cpp	2010-05-23 15:25:52 UTC (rev 6214)
@@ -20,20 +20,20 @@
 void    A_Resync(void);
 
 /* our variables */
-static jsLoggerFunc *jsLogger=NULL;
-static void *jsLoggerCookie=NULL;
+static scriptLoggerFunc *scriptLogger=NULL;
+static void             *scriptLoggerCookie=NULL;
 /**
     \fn jsLogger
 */
 bool isJsLogRedirected(void)
 {
-    if(jsLogger) return true;
+    if(scriptLogger) return true;
     return false;
 }
 /**
     \fn jsLog
 */
-bool jsLog(JS_LOG_TYPE type, const char *prf,...)
+bool jsLog( const char *prf,...)
 {
  static char print_buffer[1024];
   	
@@ -43,12 +43,9 @@
 		va_end(list);
 		print_buffer[1023]=0; // ensure the string is terminated
         if(true==isJsLogRedirected())
-            jsLogger(jsLoggerCookie,type,print_buffer);
+            scriptLogger(scriptLoggerCookie,SCRIPT_LOG_NORMAL,print_buffer);
         else
         {
-            if(type==JS_LOG_ERROR)
-                GUI_Error_HIG("Script Error","%s",print_buffer);
-            else
                 ADM_warning("[JS]%s\n",print_buffer);
         }
 
@@ -56,20 +53,41 @@
 }
 
 /**
-    \fn ADM_jsRegisterLogger
+    \fn jsLogError
 */
-bool ADM_jsRegisterLogger(void *cookie,jsLoggerFunc *fun)
+bool jsLogError(const char *prf,...)
 {
-    jsLoggerCookie=cookie;
-    jsLogger=fun;
+ static char print_buffer[1024];
+  	
+		va_list 	list;
+		va_start(list,	prf);
+		vsnprintf(print_buffer,1023,prf,list);
+		va_end(list);
+		print_buffer[1023]=0; // ensure the string is terminated
+        if(true==isJsLogRedirected())
+            scriptLogger(scriptLoggerCookie,SCRIPT_LOG_ERROR,print_buffer);
+        else
+        {
+                GUI_Error_HIG("Script Error","%s",print_buffer);
+        }
+
+        return true;
+}
+/**
+    \fn ADM_scriptRegisterLogger
+*/
+bool ADM_scriptRegisterLogger(void *cookie,scriptLoggerFunc *fun)
+{
+    scriptLoggerCookie=cookie;
+    scriptLogger=fun;
     return true;
 }
 /**
-    \fn ADM_jsUnregisterLogger
+    \fn ADM_scriptUnregisterLogger
 */
-bool ADM_jsUnregisterLogger(void)
+bool ADM_scriptUnregisterLogger(void)
 {
-    jsLogger=NULL;
+    scriptLogger=NULL;
     return true;
 }
 // EOF

Modified: branches/avidemux_2.6_branch_mean/avidemux/qt4/ADM_userInterfaces/ADM_shell/Q_shell.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/qt4/ADM_userInterfaces/ADM_shell/Q_shell.cpp	2010-05-20 19:10:12 UTC (rev 6213)
+++ branches/avidemux_2.6_branch_mean/avidemux/qt4/ADM_userInterfaces/ADM_shell/Q_shell.cpp	2010-05-23 15:25:52 UTC (rev 6214)
@@ -38,8 +38,8 @@
     ui.textBrowser_2->installEventFilter(this);
     connect((ui.evalute),SIGNAL(clicked(bool)),this,SLOT(evaluate(bool)));
     connect((ui.clear),SIGNAL(clicked(bool)),this,SLOT(clear(bool)));
-    print(JS_LOG_NORMAL,"Enter your commands then press the evaluate button or CTRL+ENTER.\n");
-    print(JS_LOG_NORMAL,"You can use CTRL+PageUP and CTRL+Page Down to recall previous commands\nReady.\n");
+    print(SCRIPT_LOG_NORMAL,"Enter your commands then press the evaluate button or CTRL+ENTER.\n");
+    print(SCRIPT_LOG_NORMAL,"You can use CTRL+PageUP and CTRL+Page Down to recall previous commands\nReady.\n");
     indexRead=indexWrite=0;
 }
 /**
@@ -85,14 +85,14 @@
 /**
     \fn print
 */
-bool qShell::print(JS_LOG_TYPE type,const char *s)
+bool qShell::print(SCRIPT_LOG_TYPE type,const char *s)
 {
     QString string(s);
     //printf("**%s",s);
     switch(type)
     {
-        case JS_LOG_NORMAL: ui.textBrowser->setTextColor(QColor(0,0,0));break;
-        case JS_LOG_ERROR : ui.textBrowser->setTextColor(QColor(255,0,0));break;
+        case SCRIPT_LOG_NORMAL: ui.textBrowser->setTextColor(QColor(0,0,0));break;
+        case SCRIPT_LOG_ERROR : ui.textBrowser->setTextColor(QColor(255,0,0));break;
     }
     ui.textBrowser->append(string.toAscii());
     ui.textBrowser->setTextColor(QColor(0,0,0));

Modified: branches/avidemux_2.6_branch_mean/avidemux/qt4/ADM_userInterfaces/ADM_shell/Q_shell.h
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/qt4/ADM_userInterfaces/ADM_shell/Q_shell.h	2010-05-20 19:10:12 UTC (rev 6213)
+++ branches/avidemux_2.6_branch_mean/avidemux/qt4/ADM_userInterfaces/ADM_shell/Q_shell.h	2010-05-23 15:25:52 UTC (rev 6214)
@@ -27,7 +27,7 @@
                     qShell(jsShellEvaluate *s) ;
     virtual         ~qShell() ;
     bool            run(void);
-    bool            print(JS_LOG_TYPE type, const char *s);
+    bool            print(SCRIPT_LOG_TYPE type, const char *s);
 public slots:
     bool            evaluate(bool x);
     bool            clear(bool x);

Modified: branches/avidemux_2.6_branch_mean/avidemux/qt4/ADM_userInterfaces/ADM_shell/qt4Shell.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/qt4/ADM_userInterfaces/ADM_shell/qt4Shell.cpp	2010-05-20 19:10:12 UTC (rev 6213)
+++ branches/avidemux_2.6_branch_mean/avidemux/qt4/ADM_userInterfaces/ADM_shell/qt4Shell.cpp	2010-05-23 15:25:52 UTC (rev 6214)
@@ -9,7 +9,7 @@
     \fn qt4ShellLogger
     \brief Redirect output to the shell
 */
-static bool qt4ShellLogger(void *cookie,JS_LOG_TYPE type,const char *v)
+static bool qt4ShellLogger(void *cookie,SCRIPT_LOG_TYPE type,const char *v)
 {
     qShell *s=(qShell *)cookie;
     s->print(type,v);
@@ -23,9 +23,9 @@
 bool ADM_startShell(jsShellEvaluate eval)
 {
         qShell *s= new qShell(eval);
-        ADM_jsRegisterLogger((void *)s,qt4ShellLogger);
+        ADM_scriptRegisterLogger((void *)s,qt4ShellLogger);
         s->run();
-        ADM_jsUnregisterLogger();
+        ADM_scriptUnregisterLogger();
         delete s;
         return true;
 }

Modified: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreTinyPy/include/ADM_tinypy.h
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreTinyPy/include/ADM_tinypy.h	2010-05-20 19:10:12 UTC (rev 6213)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreTinyPy/include/ADM_tinypy.h	2010-05-23 15:25:52 UTC (rev 6214)
@@ -24,6 +24,7 @@
     const char *funcName;
     tp_obj (*funcCall)(TP);
 }pyFuncs;
+typedef bool (pyLoggerFunc)(const char *);
 /**
     \class tinyPy
 */
@@ -39,5 +40,8 @@
         bool    execString(const char *s);
         bool    execFile(const char *f);
         bool    dumpInternals(void);
+static  bool    registerLogger(pyLoggerFunc func);
+static  bool    unregisterLogger(void);
+        bool    dumpBuiltin(void);
 };
 #endif

Modified: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreTinyPy/src/ADM_tinypy.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreTinyPy/src/ADM_tinypy.cpp	2010-05-20 19:10:12 UTC (rev 6213)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreTinyPy/src/ADM_tinypy.cpp	2010-05-23 15:25:52 UTC (rev 6214)
@@ -24,6 +24,25 @@
 #define INSTANCE ((tp_vm *)instance)
 #define SCRIPT   ((tp_obj *)script)
 
+pyLoggerFunc *pyLog=NULL;
+static tp_obj    tinyPy_dumpBuiltin(tp_vm *vm);
+static pyFuncs addons[]={{"help",tinyPy_dumpBuiltin},{NULL,NULL}};
+/**
+
+*/
+bool    tinyPy::registerLogger(pyLoggerFunc func)
+{
+    pyLog=func;
+    return true;
+}
+bool    tinyPy::unregisterLogger(void)
+{
+    pyLog=NULL;
+    return true;
+}
+/**
+    \fn pyPrintfd
+*/
 bool pyPrintf(const char *fmt,...)
 {
         static char print_buffer[1024];
@@ -33,7 +52,10 @@
 		vsnprintf(print_buffer,1023,fmt,list);
 		va_end(list);
 		print_buffer[1023]=0; // ensure the string is terminated
-        printf("TP>%s",print_buffer);
+        //printf("%s",print_buffer);
+        //jsLog(JS_LOG_NORMAL,print_buffer);
+        if(!pyLog) printf("%s",print_buffer);
+            else pyLog(print_buffer);
         return true;
 }
 
@@ -67,10 +89,14 @@
     ADM_warning("Init tinypy\n");
     ADM_assert(!instance);
     instance=(void *)tp_init(0,NULL);
-    if(instance) return true;   
+    if(!instance)
+    {
+        ADM_error("Cannot initialize tinypy\n");
+        return false;   
+    }
     math_init(INSTANCE);
-    ADM_error("Cannot initialize tinypy\n");
-    return false;
+    registerFuncs("addons",addons);
+    return true;
 }
 /**
     \fn execString
@@ -130,10 +156,10 @@
 */
 bool    tinyPy::registerFuncs(const char *group,pyFuncs *funcs)
 {
-    printf("Registering group %s\n",group);
+    ADM_info("Registering group %s\n",group);
     while(funcs->funcName)
     {
-        printf("Registering :%s\n",funcs->funcName);
+        ADM_info("Registering :%s\n",funcs->funcName);
         tp_set(INSTANCE, INSTANCE->builtins, 
                 tp_string(funcs->funcName), 
                 tp_fnc(INSTANCE, funcs->funcCall));
@@ -141,4 +167,24 @@
     }
     return true;
 }
+
+/**
+    \fn dumpBuiltin
+*/
+tp_obj    tinyPy_dumpBuiltin(tp_vm *vm)
+{
+    ADM_info("Dumping builtins\n");
+    tp_obj builtins=vm->builtins;
+    // It is a dict..
+    _tp_dict *dict=builtins.dict.val;
+    ADM_info("%d elems\n",dict->len);
+    for( int i=0;i<dict->len;i++)
+    {
+        tp_item *item=&(dict->items[i]);
+        const char *str=item->key.string.val;
+        if(str)
+            pyPrintf("%s\n",str);
+    }
+    return tp_None;
+}
 // EOF
\ No newline at end of file



From mean at mail.berlios.de  Sun May 23 17:25:55 2010
From: mean at mail.berlios.de (mean at BerliOS)
Date: Sun, 23 May 2010 17:25:55 +0200
Subject: [Avidemux-svn-commit] r6215 -
	branches/avidemux_2.6_branch_mean/avidemux/cli/ADM_userInterfaces/ADM_shell
Message-ID: <201005231525.o4NFPt73008887@sheep.berlios.de>

Author: mean
Date: 2010-05-23 17:25:54 +0200 (Sun, 23 May 2010)
New Revision: 6215

Modified:
   branches/avidemux_2.6_branch_mean/avidemux/cli/ADM_userInterfaces/ADM_shell/cliShell.cpp
Log:
[shell py/js] Fix cli

Modified: branches/avidemux_2.6_branch_mean/avidemux/cli/ADM_userInterfaces/ADM_shell/cliShell.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/cli/ADM_userInterfaces/ADM_shell/cliShell.cpp	2010-05-23 15:25:52 UTC (rev 6214)
+++ branches/avidemux_2.6_branch_mean/avidemux/cli/ADM_userInterfaces/ADM_shell/cliShell.cpp	2010-05-23 15:25:54 UTC (rev 6215)
@@ -5,7 +5,7 @@
 
 
 #include "ADM_default.h"
-#include "ADM_jsShell.h"
+#include "ADM_scriptShell.h"
 /**
     \fn cliShellLogger
     \brief Redirect output to the shell
@@ -22,7 +22,7 @@
         \fn ADM_createJsShell
         \brief create the input for a js shell
 */
-bool ADM_startShell(jsShellEvaluate eval)
+bool ADM_startShell(jsShellEvaluate *eval)
 {
       /*  qShell *s= new qShell(eval);
         ADM_jsRegisterLogger((void *)s,cliShellLogger);



From mean at mail.berlios.de  Mon May 24 10:09:19 2010
From: mean at mail.berlios.de (mean at BerliOS)
Date: Mon, 24 May 2010 10:09:19 +0200
Subject: [Avidemux-svn-commit] r6216 - in
	branches/avidemux_2.5_branch_gruntster/scripts/auto: Apple
	Optical Disc
Message-ID: <201005240809.o4O89JjD028307@sheep.berlios.de>

Author: mean
Date: 2010-05-24 10:09:18 +0200 (Mon, 24 May 2010)
New Revision: 6216

Modified:
   branches/avidemux_2.5_branch_gruntster/scripts/auto/Apple/Apple iPhone.js
   branches/avidemux_2.5_branch_gruntster/scripts/auto/Apple/Apple iPod 5.5G.js
   branches/avidemux_2.5_branch_gruntster/scripts/auto/Apple/Apple iPod.js
   branches/avidemux_2.5_branch_gruntster/scripts/auto/Optical Disc/DVD.js
   branches/avidemux_2.5_branch_gruntster/scripts/auto/Optical Disc/Super Video CD.js
   branches/avidemux_2.5_branch_gruntster/scripts/auto/Optical Disc/Video CD.js
Log:
[js] Fix auto regarding audio copy, thanks Dmitry C. for pointing it

Modified: branches/avidemux_2.5_branch_gruntster/scripts/auto/Apple/Apple iPhone.js
===================================================================
--- branches/avidemux_2.5_branch_gruntster/scripts/auto/Apple/Apple iPhone.js	2010-05-23 15:25:54 UTC (rev 6215)
+++ branches/avidemux_2.5_branch_gruntster/scripts/auto/Apple/Apple iPhone.js	2010-05-24 08:09:18 UTC (rev 6216)
@@ -23,8 +23,8 @@
 
         if (app.audio.targetTrackInfo.length > 0)
         {
-            if (app.audio.targetTrackInfo[0].codec == "AAC" && app.audio.targetTrackInfo[0].channelCount == 2)
-                app.video.codec("Copy", "CQ=4", "0 ");
+            if (app.audio.targetTrackInfo[0].codec == "AAC" && app.audio.targetTrackInfo[0].channelCount == 2)A
+                app.audio.codec("copy",0,0,"");
             else
             {
                 app.audio.codec("Faac", 128, 4, "80 00 00 00 ");
@@ -38,4 +38,4 @@
 
         app.setContainer("MP4");
     }
-}
\ No newline at end of file
+}

Modified: branches/avidemux_2.5_branch_gruntster/scripts/auto/Apple/Apple iPod 5.5G.js
===================================================================
--- branches/avidemux_2.5_branch_gruntster/scripts/auto/Apple/Apple iPod 5.5G.js	2010-05-23 15:25:54 UTC (rev 6215)
+++ branches/avidemux_2.5_branch_gruntster/scripts/auto/Apple/Apple iPod 5.5G.js	2010-05-24 08:09:18 UTC (rev 6216)
@@ -24,7 +24,7 @@
         if (app.audio.targetTrackInfo.length > 0)
         {
             if (app.audio.targetTrackInfo[0].codec == "AAC" && app.audio.targetTrackInfo[0].channelCount == 2)
-                app.video.codec("Copy", "CQ=4", "0 ");
+                app.audio.codec("copy",0,0,"");
             else
             {
                 app.audio.codec("Faac", 128, 4, "80 00 00 00 ");
@@ -38,4 +38,4 @@
 
         app.setContainer("MP4");
     }
-}
\ No newline at end of file
+}

Modified: branches/avidemux_2.5_branch_gruntster/scripts/auto/Apple/Apple iPod.js
===================================================================
--- branches/avidemux_2.5_branch_gruntster/scripts/auto/Apple/Apple iPod.js	2010-05-23 15:25:54 UTC (rev 6215)
+++ branches/avidemux_2.5_branch_gruntster/scripts/auto/Apple/Apple iPod.js	2010-05-24 08:09:18 UTC (rev 6216)
@@ -24,7 +24,7 @@
         if (app.audio.targetTrackInfo.length > 0)
         {
             if (app.audio.targetTrackInfo[0].codec == "AAC" && app.audio.targetTrackInfo[0].channelCount == 2)
-                app.video.codec("Copy", "CQ=4", "0 ");
+                app.audio.codec("copy",0,0,"");
             else
             {
                 app.audio.codec("Faac", 128, 4, "80 00 00 00 ");
@@ -38,4 +38,4 @@
 
         app.setContainer("MP4");
     }
-}
\ No newline at end of file
+}

Modified: branches/avidemux_2.5_branch_gruntster/scripts/auto/Optical Disc/DVD.js
===================================================================
--- branches/avidemux_2.5_branch_gruntster/scripts/auto/Optical Disc/DVD.js	2010-05-23 15:25:54 UTC (rev 6215)
+++ branches/avidemux_2.5_branch_gruntster/scripts/auto/Optical Disc/DVD.js	2010-05-24 08:09:18 UTC (rev 6216)
@@ -32,7 +32,7 @@
         if (app.audio.targetTrackInfo.length > 0)
         {
             if ((app.audio.targetTrackInfo[0].codec == "MP2" || app.audio.targetTrackInfo[0].codec == "AC3" || app.audio.targetTrackInfo[0].codec == "LPCM") && app.audio.targetTrackInfo[0].frequency == 48000)
-                app.video.codec("Copy", "CQ=4", "0 ");
+                app.audio.codec("copy",0,0,"");
             else
             {
                 app.audio.codec("TwoLame", 160, 8, "a0 00 00 00 01 00 00 00 ");
@@ -49,4 +49,4 @@
 
         app.setContainer("PS", "00 00 00 00 00 00 00 00 ");
     }
-}
\ No newline at end of file
+}

Modified: branches/avidemux_2.5_branch_gruntster/scripts/auto/Optical Disc/Super Video CD.js
===================================================================
--- branches/avidemux_2.5_branch_gruntster/scripts/auto/Optical Disc/Super Video CD.js	2010-05-23 15:25:54 UTC (rev 6215)
+++ branches/avidemux_2.5_branch_gruntster/scripts/auto/Optical Disc/Super Video CD.js	2010-05-24 08:09:18 UTC (rev 6216)
@@ -32,7 +32,7 @@
         if (app.audio.targetTrackInfo.length > 0)
         {
             if (app.audio.targetTrackInfo[0].codec == "MP2" && app.audio.targetTrackInfo[0].frequency == 44100 && app.audio.targetTrackInfo[0].channelCount == 2)
-                app.video.codec("Copy", "CQ=4", "0 ");
+                app.audio.codec("copy",0,0,"");
             else
             {
                 app.audio.codec("TwoLame", 160, 8, "a0 00 00 00 01 00 00 00 ");
@@ -49,4 +49,4 @@
 
         app.setContainer("PS", "02 00 00 00 00 00 00 00 ");
     }
-}
\ No newline at end of file
+}

Modified: branches/avidemux_2.5_branch_gruntster/scripts/auto/Optical Disc/Video CD.js
===================================================================
--- branches/avidemux_2.5_branch_gruntster/scripts/auto/Optical Disc/Video CD.js	2010-05-23 15:25:54 UTC (rev 6215)
+++ branches/avidemux_2.5_branch_gruntster/scripts/auto/Optical Disc/Video CD.js	2010-05-24 08:09:18 UTC (rev 6216)
@@ -33,7 +33,7 @@
         if (app.audio.targetTrackInfo.length > 0)
         {
             if (app.audio.targetTrackInfo[0].codec == "MP2" && app.audio.targetTrackInfo[0].frequency == 44100 && app.audio.targetTrackInfo[0].channelCount == 2)
-                app.video.codec("Copy", "CQ=4", "0 ");
+                app.audio.codec("copy",0,0,"");
             else
             {
                 app.audio.codec("TwoLame", 224, 8, "e0 00 00 00 01 00 00 00 ");
@@ -50,4 +50,4 @@
 
         app.setContainer("PS", "01 00 00 00 00 00 00 00 ");
     }
-}
\ No newline at end of file
+}



From mean at mail.berlios.de  Mon May 24 10:17:41 2010
From: mean at mail.berlios.de (mean at BerliOS)
Date: Mon, 24 May 2010 10:17:41 +0200
Subject: [Avidemux-svn-commit] r6217 -
	branches/avidemux_2.5_branch_gruntster/scripts/auto/Apple
Message-ID: <201005240817.o4O8HfmX028670@sheep.berlios.de>

Author: mean
Date: 2010-05-24 10:17:35 +0200 (Mon, 24 May 2010)
New Revision: 6217

Modified:
   branches/avidemux_2.5_branch_gruntster/scripts/auto/Apple/Apple iPhone.js
Log:
[auto/js] Remove extra A

Modified: branches/avidemux_2.5_branch_gruntster/scripts/auto/Apple/Apple iPhone.js
===================================================================
--- branches/avidemux_2.5_branch_gruntster/scripts/auto/Apple/Apple iPhone.js	2010-05-24 08:09:18 UTC (rev 6216)
+++ branches/avidemux_2.5_branch_gruntster/scripts/auto/Apple/Apple iPhone.js	2010-05-24 08:17:35 UTC (rev 6217)
@@ -23,7 +23,7 @@
 
         if (app.audio.targetTrackInfo.length > 0)
         {
-            if (app.audio.targetTrackInfo[0].codec == "AAC" && app.audio.targetTrackInfo[0].channelCount == 2)A
+            if (app.audio.targetTrackInfo[0].codec == "AAC" && app.audio.targetTrackInfo[0].channelCount == 2)
                 app.audio.codec("copy",0,0,"");
             else
             {



From mean at mail.berlios.de  Mon May 24 11:49:35 2010
From: mean at mail.berlios.de (mean at BerliOS)
Date: Mon, 24 May 2010 11:49:35 +0200
Subject: [Avidemux-svn-commit] r6218 -
	branches/avidemux_2.5_branch_gruntster/avidemux/ADM_inputs/ADM_mpegdemuxer
Message-ID: <201005240949.o4O9nZWF001585@sheep.berlios.de>

Author: mean
Date: 2010-05-24 11:49:31 +0200 (Mon, 24 May 2010)
New Revision: 6218

Modified:
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_inputs/ADM_mpegdemuxer/dmx_indexer_h264.cpp
Log:
[264 indexder] Prevent random value in fps , ar,....

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_inputs/ADM_mpegdemuxer/dmx_indexer_h264.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_inputs/ADM_mpegdemuxer/dmx_indexer_h264.cpp	2010-05-24 08:17:35 UTC (rev 6217)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_inputs/ADM_mpegdemuxer/dmx_indexer_h264.cpp	2010-05-24 09:49:31 UTC (rev 6218)
@@ -141,12 +141,13 @@
               if(!seq_found && streamid!=NAL_SPS) continue;
               if(!seq_found)
               {
-                    // Our firt frame is here
+                    // Our first frame is here
                     // Important to initialize the mpeg decoder !
                       uint8_t buffer[60] ; // should be enough
                       uint64_t xA,xR;
                       _run->demuxer->getPos(&xA,&xR);
                       _run->demuxer->read(buffer,60);
+                      memset(&spsInfo,0,sizeof(spsInfo));
                       if (extractSPSInfo(buffer, 60, &spsInfo))
                       {
 						  _run->imageW = spsInfo.width;



From mean at mail.berlios.de  Mon May 24 12:51:28 2010
From: mean at mail.berlios.de (mean at BerliOS)
Date: Mon, 24 May 2010 12:51:28 +0200
Subject: [Avidemux-svn-commit] r6219 -
	branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreUtils/src
Message-ID: <201005241051.o4OApSdl032427@sheep.berlios.de>

Author: mean
Date: 2010-05-24 12:51:17 +0200 (Mon, 24 May 2010)
New Revision: 6219

Added:
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreUtils/src/ADM_infoExtractorH264.cpp
Modified:
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreUtils/src/ADM_infoExtractor.cpp
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreUtils/src/CMakeLists.txt
Log:
[infoExtractor] Try to decode scale matrix

Modified: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreUtils/src/ADM_infoExtractor.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreUtils/src/ADM_infoExtractor.cpp	2010-05-24 09:49:31 UTC (rev 6218)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreUtils/src/ADM_infoExtractor.cpp	2010-05-24 10:51:17 UTC (rev 6219)
@@ -24,8 +24,6 @@
 #include "ADM_videoInfoExtractor.h"
 #include "ADM_h264_tag.h"
 
-static void refineH264FrameType (uint8_t * head, uint8_t * tail,
-				 uint32_t * flags);
 bool ADM_findMpegStartCode (uint8_t * start, uint8_t * end,
 			    uint8_t * outstartcode, uint32_t * offset);
 /*
@@ -321,347 +319,6 @@
   return 0;
 }
 /**
-    \fn unescapeH264
-    \brief Remove escape stuff
-
-*/
-static uint32_t
-unescapeH264 (uint32_t len, uint8_t * in, uint8_t * out)
-{
-  uint32_t outlen = 0;
-  uint8_t *tail = in + len;
-  if (len < 3)
-    return 0;
-  while (in < tail - 3)
-    {
-      if (!in[0] && !in[1] && in[2] == 3)
-	{
-	  out[0] = 0;
-	  out[1] = 0;
-	  out += 2;
-	  outlen += 2;
-	  in += 3;
-	}
-      *out++ = *in++;
-      outlen++;
-    }
-  // copy last bytes
-  uint32_t left = tail - in;
-  memcpy (out, in, left);
-  outlen += left;
-  return outlen;
-
-}
-/**
-        \fn extractVUIInfo
-*/
-static uint8_t
-extractVUIInfo (GetBitContext * s, uint32_t * fps1000, uint32_t * darNum,
-		uint32_t * darDen)
-{
-  *fps1000 = *darNum = *darDen = 0;
-
-  if (get_bits1 (s))
-    {
-      unsigned int aspect_ratio_information = get_bits (s, 8);
-
-      if (aspect_ratio_information == 255)
-	{
-	  *darNum = get_bits_long (s, 16);
-	  *darDen = get_bits_long (s, 16);
-	}
-      else if (aspect_ratio_information <
-	       sizeof (pixel_aspect) / sizeof (*pixel_aspect))
-	{
-	  *darNum = pixel_aspect[aspect_ratio_information].num;
-	  *darDen = pixel_aspect[aspect_ratio_information].den;
-	}
-    }
-
-  if (get_bits1 (s))		// overscan
-    get_bits1 (s);
-
-  if (get_bits1 (s))		// vsp_color
-    {
-      get_bits (s, 4);
-
-      if (get_bits1 (s))
-	{
-	  get_bits (s, 8);
-	  get_bits (s, 8);
-	  get_bits (s, 8);
-	}
-    }
-
-  if (get_bits1 (s))		// chroma
-    {
-      get_ue_golomb (s);
-      get_ue_golomb (s);
-    }
-
-  if (get_bits1 (s))		// timing
-    {
-      uint32_t timeinc_unit = get_bits_long (s, 32);
-      uint32_t timeinc_resolution = get_bits_long (s, 32);
-      uint32_t fixed_fps = get_bits1 (s);
-
-      if (timeinc_unit > 0 && timeinc_resolution > 0)
-	*fps1000 =
-	  (uint32_t) (((float) timeinc_resolution / (float) timeinc_unit) *
-		      1000);
-/* No!
-      if (fixed_fps)
-	*fps1000 /= 2;
-*/
-    }
-
-  return 1;
-}
-
-/**
-    \fn extractSPSInfo
-    \brief Extract info from H264 SPS
-    See 7.3.2.1 of 14496-10
-*/
-uint8_t
-extractSPSInfo (uint8_t * data, uint32_t len, uint32_t * wwidth,
-		uint32_t * hheight, uint32_t * fps1000, uint32_t * darNum,
-		uint32_t * darDen)
-{
-  GetBitContext s;
-
-  uint32_t profile, constraint, level, pic_order_cnt_type, w, h, mbh,
-    frame_mbs_only;
-  uint8_t buf[len];
-  uint32_t outlen;
-  uint32_t id, dum;
-
-  outlen = unescapeH264 (len, data, buf);
-  init_get_bits (&s, buf, outlen * 8);
-
-  profile = get_bits (&s, 8);
-  constraint = get_bits (&s, 8) >> 5;
-  level = get_bits (&s, 8);
-  id = get_ue_golomb (&s);	// Seq parameter set id           
-  printf ("[H264]Profile : %u, Level :%u, SPSid:%u\n", profile, level, id);
-  if (profile >= 100)		// ?? Borrowed from H264.C/FFMPEG
-    {
-      printf ("[H264]Warning : High profile\n");
-      if (get_ue_golomb (&s) == 3)	//chroma_format_idc
-	get_bits1 (&s);		//residual_color_transform_flag
-      get_ue_golomb (&s);	//bit_depth_luma_minus8
-      get_ue_golomb (&s);	//bit_depth_chroma_minus8
-      get_bits1 (&s);		// Transform bypass
-      if (get_bits1 (&s))	// Scaling matrix
-	{
-	  printf ("[H264] Scaling matrix present\n");
-	  get_bits (&s, 8);
-	}
-    }
-
-
-  dum = get_ue_golomb (&s);	// log2_max_frame_num_minus4
-  printf ("[H264]Log2maxFrame-4:%u\n", dum);
-  pic_order_cnt_type = get_ue_golomb (&s);
-  printf ("[H264]Pic Order Cnt Type:%u\n", pic_order_cnt_type);
-  if (!pic_order_cnt_type)	// pic_order_cnt_type
-    {
-      dum = get_ue_golomb (&s);	//log2_max_pic_order_cnt_lsb_minus4
-      printf ("[H264]Log2maxPix-4:%u\n", dum);
-    }
-  else
-    {
-      if (pic_order_cnt_type == 1)
-	{
-	  get_bits1 (&s);	//delta_pic_order_always_zero_flag
-	  get_se_golomb (&s);	//offset_for_non_ref_pic
-	  get_se_golomb (&s);	// offset_for_top_to_bottom_field
-	  int i = get_ue_golomb (&s);	//num_ref_frames_in_pic_order_cnt_cycle
-
-	  for (int j = 0; j < i; j++)
-	    {
-	      get_se_golomb (&s);
-	    }
-	}
-      else if (pic_order_cnt_type != 2)
-	{
-	  printf ("Error in SPS\n");
-	  return 0;
-	}
-    }
-  dum = get_ue_golomb (&s);	//num_ref_frames
-  printf ("[H264] # of ref frames : %u\n", dum);
-  get_bits1 (&s);		// gaps_in_frame_num_value_allowed_flag
-  w = get_ue_golomb (&s) + 1;	//pic_width_in_mbs_minus1
-
-  mbh = get_ue_golomb (&s) + 1;
-  frame_mbs_only = get_bits1 (&s);
-  h = (2 - frame_mbs_only) * mbh;	//pic_height_in_mbs_minus1
-
-  printf ("[H264] Width in mb -1  :%d\n", w);
-  printf ("[H264] Height in mb -1 :%d\n", h);
-
-  *wwidth = w * 16;
-  *hheight = h * 16;
-
-  if (!frame_mbs_only)
-    get_bits1 (&s);
-
-  get_bits1 (&s);
-
-  if (get_bits1 (&s))
-    {
-      get_ue_golomb (&s);
-      get_ue_golomb (&s);
-      get_ue_golomb (&s);
-      get_ue_golomb (&s);
-    }
-
-  if (get_bits1 (&s))
-    {
-      extractVUIInfo (&s, fps1000, darNum, darDen);
-      printf ("[H264] Fps %" LU ", a.r. %" LU ",%" LU "\n", *fps1000, *darNum,
-	      *darDen);
-    }
-  else
-    {
-      printf ("[H264] Unknown FPS, setting 25\n");
-      *fps1000 = 25000;
-    }
-  return 1;
-}
-/**
-      \fn extractH264FrameType
-      \brief return frametype in flags (KEY_FRAME or 0). To be used only with  mkv/mp4 nal type (i.e. no startcode)
-      
-*/
-uint8_t
-extractH264FrameType (uint32_t nalSize, uint8_t * buffer, uint32_t len,
-		      uint32_t * flags)
-{
-  uint8_t *head = buffer, *tail = buffer + len;
-  uint8_t stream;
-
-  uint32_t val, hnt;
-
-// FIXME :  no startcode only !
-
-  while (head + 4 < tail)
-    {
-
-      uint32_t length =
-	(head[0] << 24) + (head[1] << 16) + (head[2] << 8) + (head[3]);
-      //printf("Block size : %"LU", available : %"LU"\n",length,len);
-      if (length > len || length < 6)
-	{
-	  printf ("Warning , incomplete nal (%u/%u),(%0x/%0x)\n", length, len,
-		  length, len);
-	  *flags = 0;
-	  return 0;
-	}
-      head += 4;		// Skip nal lenth
-      stream = *(head) & 0x1F;
-      switch (stream)
-	{
-	case NAL_IDR:
-	  *flags = AVI_KEY_FRAME;
-
-	  return 1;
-	  break;
-	case NAL_NON_IDR:
-	  refineH264FrameType (head + 1, tail, flags);
-	  return 1;
-	  break;
-	default:
-	  printf ("??0x%x\n", stream);
-	case NAL_SEI:
-	  head += length;
-	  continue;
-	}
-    }
-  printf ("No stream\n");
-  return 0;
-}
-
-/**
-      \fn extractH264FrameType_startCode
-      \brief return frametype in flags (KEY_FRAME or 0). To be used only with  avi / mpeg TS nal type (i.e. with startcode)
-      
-*/
-uint8_t
-extractH264FrameType_startCode (uint32_t nalSize, uint8_t * buffer,
-				uint32_t len, uint32_t * flags)
-{
-  uint8_t *head = buffer, *tail = buffer + len;
-  uint8_t stream;
-#define NAL_NON_IDR       1
-#define NAL_IDR           5
-#define NAL_SEI           6
-
-  uint32_t val, hnt;
-
-// FIXME :  no startcode only !
-
-  while (head + 4 < tail)
-    {
-      // Search startcode
-
-      hnt = (head[0] << 24) + (head[1] << 16) + (head[2] << 8) + (head[3]);
-      head += 4;
-      while ((hnt != 1) && head < tail)
-	{
-
-	  hnt <<= 8;
-	  val = *head++;
-	  hnt += val;
-	}
-      if (head >= tail)
-	break;
-      stream = *(head++) & 0x1f;
-      switch (stream)
-	{
-	case NAL_IDR:
-	  *flags = AVI_KEY_FRAME;
-	  // printf("IDR\n");
-	  return 1;
-	  break;
-	case NAL_NON_IDR:
-	  refineH264FrameType (head, tail, flags);
-	  return 1;
-	  break;
-	default:
-	  printf ("??0x%x\n", stream);
-	  continue;
-	}
-    }
-  printf ("No stream\n");
-  return 0;
-}
-/**
-    \fn refineH264FrameType
-    \brief Try to detect B slice, warning the stream is not escaped!
-*/
-void
-refineH264FrameType (uint8_t * head, uint8_t * tail, uint32_t * flags)
-{
-  GetBitContext s;
-  uint32_t sliceType;
-  *flags = 0;
-  init_get_bits (&s, head, (tail - head) * 8);
-  get_ue_golomb (&s);
-  sliceType = get_ue_golomb_31 (&s);
-  if (sliceType > 9)
-    {
-      printf ("Weird Slice %d\n", sliceType);
-      return;
-    }
-  if (sliceType > 4)
-    sliceType -= 5;
-  if (sliceType == 1)
-    *flags = AVI_B_FRAME;
-  //printf("[H264] Slice type : %"LU"\n",sliceType);
-}
-/**
     \fn ADM_searchVop
     \brief search vop header in a bitstream 
     Used for packed bitstream and also to identify the frametype

Added: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreUtils/src/ADM_infoExtractorH264.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreUtils/src/ADM_infoExtractorH264.cpp	2010-05-24 09:49:31 UTC (rev 6218)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreUtils/src/ADM_infoExtractorH264.cpp	2010-05-24 10:51:17 UTC (rev 6219)
@@ -0,0 +1,412 @@
+/***************************************************************************
+                          ADM_infoextractor
+                             -------------------
+           - extract additionnal info from header (mp4/h263)                  
+**************************************************************************/
+/***************************************************************************
+ *                                                                         *
+ *   This program is free software; you can redistribute it and/or modify  *
+ *   it under the terms of the GNU General Public License as published by  *
+ *   the Free Software Foundation; either version 2 of the License, or     *
+ *   (at your option) any later version.                                   *
+ *                                                                         *
+ ***************************************************************************/
+
+
+#include "ADM_default.h"
+#include "ADM_Video.h"
+
+#include "fourcc.h"
+//#include "ADM_mp4.h"
+
+#define aprintf(...) {}
+#include "ADM_getbits.h"
+#include "ADM_videoInfoExtractor.h"
+#include "ADM_h264_tag.h"
+
+static void refineH264FrameType (uint8_t * head, uint8_t * tail,
+				 uint32_t * flags);
+bool ADM_findMpegStartCode (uint8_t * start, uint8_t * end,
+			    uint8_t * outstartcode, uint32_t * offset);
+/**
+    \fn unescapeH264
+    \brief Remove escape stuff
+
+*/
+static uint32_t
+unescapeH264 (uint32_t len, uint8_t * in, uint8_t * out)
+{
+  uint32_t outlen = 0;
+  uint8_t *tail = in + len;
+  if (len < 3)
+    return 0;
+  while (in < tail - 3)
+    {
+      if (!in[0] && !in[1] && in[2] == 3)
+	{
+	  out[0] = 0;
+	  out[1] = 0;
+	  out += 2;
+	  outlen += 2;
+	  in += 3;
+	}
+      *out++ = *in++;
+      outlen++;
+    }
+  // copy last bytes
+  uint32_t left = tail - in;
+  memcpy (out, in, left);
+  outlen += left;
+  return outlen;
+
+}
+/**
+        \fn extractVUIInfo
+*/
+static uint8_t
+extractVUIInfo (GetBitContext * s, uint32_t * fps1000, uint32_t * darNum,
+		uint32_t * darDen)
+{
+  *fps1000 = *darNum = *darDen = 0;
+
+  if (get_bits1 (s))
+    {
+      unsigned int aspect_ratio_information = get_bits (s, 8);
+
+      if (aspect_ratio_information == 255)
+	{
+	  *darNum = get_bits_long (s, 16);
+	  *darDen = get_bits_long (s, 16);
+	}
+      else if (aspect_ratio_information <
+	       sizeof (pixel_aspect) / sizeof (*pixel_aspect))
+	{
+	  *darNum = pixel_aspect[aspect_ratio_information].num;
+	  *darDen = pixel_aspect[aspect_ratio_information].den;
+	}
+    }
+
+  if (get_bits1 (s))		// overscan
+    get_bits1 (s);
+
+  if (get_bits1 (s))		// vsp_color
+    {
+      get_bits (s, 4);
+
+      if (get_bits1 (s))
+	{
+	  get_bits (s, 8);
+	  get_bits (s, 8);
+	  get_bits (s, 8);
+	}
+    }
+
+  if (get_bits1 (s))		// chroma
+    {
+      get_ue_golomb (s);
+      get_ue_golomb (s);
+    }
+
+  if (get_bits1 (s))		// timing
+    {
+      uint32_t timeinc_unit = get_bits_long (s, 32);
+      uint32_t timeinc_resolution = get_bits_long (s, 32);
+      uint32_t fixed_fps = get_bits1 (s);
+      ADM_info("Time unit =%d/%d\n",(int)timeinc_unit,(int)timeinc_resolution);
+      if (timeinc_unit > 0 && timeinc_resolution > 0)
+	*fps1000 =
+	  (uint32_t) (((float) timeinc_resolution / (float) timeinc_unit) *
+		      1000);
+/* No!
+      if (fixed_fps)
+	*fps1000 /= 2;
+*/
+    }
+
+  return 1;
+}
+/**
+        \fn decodeOnMatrix
+        \brief borrowed from ffmpeg
+*/
+bool decodeOneMatrix(int count,GetBitContext *s)
+{
+        if(!get_bits1(s)) 
+        {
+                return true;
+        }
+        
+        int i, last = 8, next = 8;
+        for(i=0;i<count;i++)
+        {
+         if(next)
+            next = (last + get_se_golomb(s)) & 0xff;
+         if(!i && !next)
+         { /* matrix not written, we use the preset one */
+            return true;
+         }
+         //last = factors[scan[i]] = next ? next : last;
+    }
+    return true;
+
+}
+/**
+        \fn decodeScalingMatrices
+*/
+bool          decodeScalingMatrices(GetBitContext *s)
+{
+        decodeOneMatrix(16,s);
+        decodeOneMatrix(16,s);
+        decodeOneMatrix(16,s);
+        decodeOneMatrix(16,s);
+        decodeOneMatrix(16,s);
+        decodeOneMatrix(16,s);
+        decodeOneMatrix(64,s);
+        decodeOneMatrix(64,s);
+        return true;
+}
+
+/**
+    \fn extractSPSInfo
+    \brief Extract info from H264 SPS
+    See 7.3.2.1 of 14496-10
+*/
+uint8_t
+extractSPSInfo (uint8_t * data, uint32_t len, uint32_t * wwidth,
+		uint32_t * hheight, uint32_t * fps1000, uint32_t * darNum,
+		uint32_t * darDen)
+{
+  GetBitContext s;
+  *fps1000=0;
+  uint32_t profile, constraint, level, pic_order_cnt_type, w, h, mbh,
+    frame_mbs_only;
+  uint8_t buf[len];
+  uint32_t outlen;
+  uint32_t id, dum;
+
+  outlen = unescapeH264 (len, data, buf);
+  init_get_bits (&s, buf, outlen * 8);
+
+  profile = get_bits (&s, 8);
+  constraint = get_bits (&s, 8) >> 5;
+  level = get_bits (&s, 8);
+  id = get_ue_golomb (&s);	// Seq parameter set id           
+  printf ("[H264]Profile : %u, Level :%u, SPSid:%u\n", profile, level, id);
+  if (profile >= 100)		// ?? Borrowed from H264.C/FFMPEG
+    {
+      printf ("[H264]Warning : High profile\n");
+      if (get_ue_golomb (&s) == 3)	//chroma_format_idc
+	get_bits1 (&s);		//residual_color_transform_flag
+      get_ue_golomb (&s);	//bit_depth_luma_minus8
+      get_ue_golomb (&s);	//bit_depth_chroma_minus8
+      get_bits1 (&s);		// Transform bypass
+      if (get_bits1 (&s))	// Scaling matrix
+	{
+	  printf ("[H264] Scaling matrix present\n");
+          decodeScalingMatrices(&s);
+	}
+    }
+
+
+  dum = get_ue_golomb (&s);	// log2_max_frame_num_minus4
+  printf ("[H264]Log2maxFrame-4:%u\n", dum);
+  pic_order_cnt_type = get_ue_golomb (&s);
+  printf ("[H264]Pic Order Cnt Type:%u\n", pic_order_cnt_type);
+  if (!pic_order_cnt_type)	// pic_order_cnt_type
+    {
+      dum = get_ue_golomb (&s);	//log2_max_pic_order_cnt_lsb_minus4
+      printf ("[H264]Log2maxPix-4:%u\n", dum);
+    }
+  else
+    {
+      if (pic_order_cnt_type == 1)
+	{
+	  get_bits1 (&s);	//delta_pic_order_always_zero_flag
+	  get_se_golomb (&s);	//offset_for_non_ref_pic
+	  get_se_golomb (&s);	// offset_for_top_to_bottom_field
+	  int i = get_ue_golomb (&s);	//num_ref_frames_in_pic_order_cnt_cycle
+
+	  for (int j = 0; j < i; j++)
+	    {
+	      get_se_golomb (&s);
+	    }
+	}
+      else if (pic_order_cnt_type != 2)
+	{
+	  printf ("Error in SPS\n");
+	  return 0;
+	}
+    }
+  dum = get_ue_golomb (&s);	//num_ref_frames
+  printf ("[H264] # of ref frames : %u\n", dum);
+  get_bits1 (&s);		// gaps_in_frame_num_value_allowed_flag
+  w = get_ue_golomb (&s) + 1;	//pic_width_in_mbs_minus1
+
+  mbh = get_ue_golomb (&s) + 1;
+  frame_mbs_only = get_bits1 (&s);
+  h = (2 - frame_mbs_only) * mbh;	//pic_height_in_mbs_minus1
+
+  printf ("[H264] Width in mb -1  :%d\n", w);
+  printf ("[H264] Height in mb -1 :%d\n", h);
+
+  *wwidth = w * 16;
+  *hheight = h * 16;
+
+  if (!frame_mbs_only)
+    get_bits1 (&s);
+
+  get_bits1 (&s);
+
+  if (get_bits1 (&s))
+    {
+      get_ue_golomb (&s);
+      get_ue_golomb (&s);
+      get_ue_golomb (&s);
+      get_ue_golomb (&s);
+    }
+
+  if (get_bits1 (&s))
+    {
+      extractVUIInfo (&s, fps1000, darNum, darDen);
+      printf ("[H264] Fps %" LU ", a.r. %" LU ",%" LU "\n", *fps1000, *darNum,
+	      *darDen);
+    }
+  else
+    {
+      printf ("[H264] Unknown FPS, setting 25\n");
+      *fps1000 = 25000;
+    }
+  return 1;
+}
+/**
+      \fn extractH264FrameType
+      \brief return frametype in flags (KEY_FRAME or 0). To be used only with  mkv/mp4 nal type (i.e. no startcode)
+      
+*/
+uint8_t
+extractH264FrameType (uint32_t nalSize, uint8_t * buffer, uint32_t len,
+		      uint32_t * flags)
+{
+  uint8_t *head = buffer, *tail = buffer + len;
+  uint8_t stream;
+
+  uint32_t val, hnt;
+
+// FIXME :  no startcode only !
+
+  while (head + 4 < tail)
+    {
+
+      uint32_t length =
+	(head[0] << 24) + (head[1] << 16) + (head[2] << 8) + (head[3]);
+      //printf("Block size : %"LU", available : %"LU"\n",length,len);
+      if (length > len || length < 6)
+	{
+	  printf ("Warning , incomplete nal (%u/%u),(%0x/%0x)\n", length, len,
+		  length, len);
+	  *flags = 0;
+	  return 0;
+	}
+      head += 4;		// Skip nal lenth
+      stream = *(head) & 0x1F;
+      switch (stream)
+	{
+	case NAL_IDR:
+	  *flags = AVI_KEY_FRAME;
+
+	  return 1;
+	  break;
+	case NAL_NON_IDR:
+	  refineH264FrameType (head + 1, tail, flags);
+	  return 1;
+	  break;
+	default:
+	  printf ("??0x%x\n", stream);
+	case NAL_SEI:
+	  head += length;
+	  continue;
+	}
+    }
+  printf ("No stream\n");
+  return 0;
+}
+
+/**
+      \fn extractH264FrameType_startCode
+      \brief return frametype in flags (KEY_FRAME or 0). To be used only with  avi / mpeg TS nal type (i.e. with startcode)
+      
+*/
+uint8_t
+extractH264FrameType_startCode (uint32_t nalSize, uint8_t * buffer,
+				uint32_t len, uint32_t * flags)
+{
+  uint8_t *head = buffer, *tail = buffer + len;
+  uint8_t stream;
+#define NAL_NON_IDR       1
+#define NAL_IDR           5
+#define NAL_SEI           6
+
+  uint32_t val, hnt;
+
+// FIXME :  no startcode only !
+
+  while (head + 4 < tail)
+    {
+      // Search startcode
+
+      hnt = (head[0] << 24) + (head[1] << 16) + (head[2] << 8) + (head[3]);
+      head += 4;
+      while ((hnt != 1) && head < tail)
+	{
+
+	  hnt <<= 8;
+	  val = *head++;
+	  hnt += val;
+	}
+      if (head >= tail)
+	break;
+      stream = *(head++) & 0x1f;
+      switch (stream)
+	{
+	case NAL_IDR:
+	  *flags = AVI_KEY_FRAME;
+	  // printf("IDR\n");
+	  return 1;
+	  break;
+	case NAL_NON_IDR:
+	  refineH264FrameType (head, tail, flags);
+	  return 1;
+	  break;
+	default:
+	  printf ("??0x%x\n", stream);
+	  continue;
+	}
+    }
+  printf ("No stream\n");
+  return 0;
+}
+/**
+    \fn refineH264FrameType
+    \brief Try to detect B slice, warning the stream is not escaped!
+*/
+void
+refineH264FrameType (uint8_t * head, uint8_t * tail, uint32_t * flags)
+{
+  GetBitContext s;
+  uint32_t sliceType;
+  *flags = 0;
+  init_get_bits (&s, head, (tail - head) * 8);
+  get_ue_golomb (&s);
+  sliceType = get_ue_golomb_31 (&s);
+  if (sliceType > 9)
+    {
+      printf ("Weird Slice %d\n", sliceType);
+      return;
+    }
+  if (sliceType > 4)
+    sliceType -= 5;
+  if (sliceType == 1)
+    *flags = AVI_B_FRAME;
+  //printf("[H264] Slice type : %"LU"\n",sliceType);
+}
+//EOF

Modified: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreUtils/src/CMakeLists.txt
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreUtils/src/CMakeLists.txt	2010-05-24 09:49:31 UTC (rev 6218)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreUtils/src/CMakeLists.txt	2010-05-24 10:51:17 UTC (rev 6219)
@@ -5,6 +5,7 @@
 ADM_quota.cpp
 fourcc.cpp
 ADM_infoExtractor.cpp
+ADM_infoExtractorH264.cpp
 ADM_frameType.cpp
 ADM_codecType.cpp
 ADM_file.cpp



From mean at mail.berlios.de  Mon May 24 12:51:32 2010
From: mean at mail.berlios.de (mean at BerliOS)
Date: Mon, 24 May 2010 12:51:32 +0200
Subject: [Avidemux-svn-commit] r6220 -
	branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_demuxers/MpegTS
Message-ID: <201005241051.o4OApWfa032512@sheep.berlios.de>

Author: mean
Date: 2010-05-24 12:51:31 +0200 (Mon, 24 May 2010)
New Revision: 6220

Modified:
   branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_demuxers/MpegTS/ADM_tsAudioProbe.cpp
   branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_demuxers/MpegTS/ADM_tsIndex.cpp
   branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_demuxers/MpegTS/ADM_tsPlugin.cpp
Log:
[TsIndexer] Use TS as prefix, not PS

Modified: branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_demuxers/MpegTS/ADM_tsAudioProbe.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_demuxers/MpegTS/ADM_tsAudioProbe.cpp	2010-05-24 10:51:17 UTC (rev 6219)
+++ branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_demuxers/MpegTS/ADM_tsAudioProbe.cpp	2010-05-24 10:51:31 UTC (rev 6220)
@@ -27,7 +27,7 @@
 // Number of video packet seen to be enough to sample the audio tracks
 #define PROBE_PACKET_VIDEO_COUNT 500
 // Max size of a packet. Usually it is a bit more than 2300, so 10000 should be safe
-#define PACKET_PROBE_SIZE 10000
+#define PACKET_PROBE_SIZE (100*1024) // Damn tivo...
 // Minimum of packet seen to declare it valid
 #define PROBE_MIN_PACKET 5
 #define PROBE_MIN_SIZE   5000

Modified: branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_demuxers/MpegTS/ADM_tsIndex.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_demuxers/MpegTS/ADM_tsIndex.cpp	2010-05-24 10:51:17 UTC (rev 6219)
+++ branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_demuxers/MpegTS/ADM_tsIndex.cpp	2010-05-24 10:51:31 UTC (rev 6220)
@@ -65,15 +65,17 @@
                 0                       // 15
         };
 
-typedef struct
+class TSVideo
 {
+public:
+    TSVideo(void) {w=h=fps=interlaced=ar=pid=0;}
     uint32_t w;
     uint32_t h;
     uint32_t fps;
     uint32_t interlaced;
     uint32_t ar;
     uint32_t pid;
-}PSVideo;
+};
 
 typedef enum
 {
@@ -131,7 +133,7 @@
                 ~TsIndexer();
         bool    runMpeg2(const char *file,ADM_TS_TRACK *videoTrac);
         bool    runH264(const char *file,ADM_TS_TRACK *videoTrac);
-        bool    writeVideo(PSVideo *video,ADM_TS_TRACK_TYPE trkType);
+        bool    writeVideo(TSVideo *video,ADM_TS_TRACK_TYPE trkType);
         bool    writeAudio(void);
         bool    writeSystem(const char *filename,bool append);
         bool    Mark(indexerData *data,dmxPacketInfo *s,uint32_t overRead);
@@ -294,7 +296,7 @@
 bool    pic_started=false;
 bool    seq_found=false;
 
-PSVideo video;
+TSVideo video;
 indexerData  data;    
 dmxPacketInfo info;
 TS_PESpacket SEI_nal(0);
@@ -507,7 +509,7 @@
 uint8_t buffer[50*1024];
 bool seq_found=false;
 
-PSVideo video;
+TSVideo video;
 indexerData  data;    
 dmxPacketInfo info;
 
@@ -708,7 +710,7 @@
     \fn writeVideo
     \brief Write Video section of index file
 */
-bool TsIndexer::writeVideo(PSVideo *video,ADM_TS_TRACK_TYPE trkType)
+bool TsIndexer::writeVideo(TSVideo *video,ADM_TS_TRACK_TYPE trkType)
 {
     qfprintf(index,"[Video]\n");
     qfprintf(index,"Width=%d\n",video->w);

Modified: branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_demuxers/MpegTS/ADM_tsPlugin.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_demuxers/MpegTS/ADM_tsPlugin.cpp	2010-05-24 10:51:17 UTC (rev 6219)
+++ branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_demuxers/MpegTS/ADM_tsPlugin.cpp	2010-05-24 10:51:31 UTC (rev 6220)
@@ -110,16 +110,16 @@
     // Do a simple check by checking we have 0x47....0x47 several time in a raw
     if(true==checkMarker(buffer,bufferSize,TS_PACKET_LEN))
     {
-        printf("[TS Demuxer] 188 bytes packet detected\n");
+        ADM_info("[TS Demuxer] 188 bytes packet detected\n");
         return true;
     }
     // Do a simple check by checking we have 0x47....0x47 several time in a raw
     if(true==checkMarker(buffer,bufferSize,TS_PACKET_LEN+4))
     {
-        printf("[TS Demuxer] 192 bytes packet detected\n");
+        ADM_info("[TS Demuxer] 192 bytes packet detected\n");
         return true;
     }
-    printf("[TS Demuxer] Not a TS file\n");
+    ADM_info("[TS Demuxer] Not a TS file\n");
     return false;
 }
 
@@ -151,7 +151,7 @@
         }    
         buffer++;
     }
-    printf("[Ts Demuxer] Sync ok :%d Sync ko :%d\n",syncOk,syncKo);
+    ADM_info("[Ts Demuxer] Sync ok :%d Sync ko :%d\n",syncOk,syncKo);
 
     if(syncOk>5*syncKo) return true;
     return false;



From mean at mail.berlios.de  Mon May 24 12:51:34 2010
From: mean at mail.berlios.de (mean at BerliOS)
Date: Mon, 24 May 2010 12:51:34 +0200
Subject: [Avidemux-svn-commit] r6221 -
	branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreDemuxerMpeg/src
Message-ID: <201005241051.o4OApYSJ032522@sheep.berlios.de>

Author: mean
Date: 2010-05-24 12:51:33 +0200 (Mon, 24 May 2010)
New Revision: 6221

Modified:
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreDemuxerMpeg/src/dmxPSPacket.cpp
Log:
[TsDemux] dont double define ADM_PACKET_LINEAR

Modified: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreDemuxerMpeg/src/dmxPSPacket.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreDemuxerMpeg/src/dmxPSPacket.cpp	2010-05-24 10:51:31 UTC (rev 6220)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreDemuxerMpeg/src/dmxPSPacket.cpp	2010-05-24 10:51:33 UTC (rev 6221)
@@ -374,7 +374,6 @@
 }
 //************************************************************************************
 
-#define ADM_PACKET_LINEAR 10*1024
 /**
     \fn psPacket
 */



From mean at mail.berlios.de  Mon May 24 12:51:35 2010
From: mean at mail.berlios.de (mean at BerliOS)
Date: Mon, 24 May 2010 12:51:35 +0200
Subject: [Avidemux-svn-commit] r6222 -
	branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_demuxers/MpegTS
Message-ID: <201005241051.o4OApZGq032563@sheep.berlios.de>

Author: mean
Date: 2010-05-24 12:51:35 +0200 (Mon, 24 May 2010)
New Revision: 6222

Modified:
   branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_demuxers/MpegTS/dmxTSPacket.cpp
Log:
[TsDemux] dont double define ADM_PACKET_LINEAR

Modified: branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_demuxers/MpegTS/dmxTSPacket.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_demuxers/MpegTS/dmxTSPacket.cpp	2010-05-24 10:51:33 UTC (rev 6221)
+++ branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_demuxers/MpegTS/dmxTSPacket.cpp	2010-05-24 10:51:35 UTC (rev 6222)
@@ -542,7 +542,6 @@
        
 }
 
-#define ADM_PACKET_LINEAR 10*1024
 /**
     \fn tsPacket
 */



From mean at mail.berlios.de  Mon May 24 12:51:38 2010
From: mean at mail.berlios.de (mean at BerliOS)
Date: Mon, 24 May 2010 12:51:38 +0200
Subject: [Avidemux-svn-commit] r6223 -
	branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_demuxers/MpegPS
Message-ID: <201005241051.o4OApcP1032605@sheep.berlios.de>

Author: mean
Date: 2010-05-24 12:51:37 +0200 (Mon, 24 May 2010)
New Revision: 6223

Modified:
   branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_demuxers/MpegPS/ADM_psPlugin.cpp
Log:
[PsIndexer] Lower threshold to accept tivo large packet

Modified: branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_demuxers/MpegPS/ADM_psPlugin.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_demuxers/MpegPS/ADM_psPlugin.cpp	2010-05-24 10:51:35 UTC (rev 6222)
+++ branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_demuxers/MpegPS/ADM_psPlugin.cpp	2010-05-24 10:51:37 UTC (rev 6223)
@@ -114,7 +114,7 @@
         if(code==0xE0) nbMatch++;
     }
     printf(" match :%d / %d (probeSize:%d)\n",nbMatch,nbPacket,bufferSize);
-    if(nbMatch*10>nbPacket*4)
+    if(nbMatch*10>nbPacket*2)
         return true;
     return false;
 }



From mean at mail.berlios.de  Mon May 24 12:51:39 2010
From: mean at mail.berlios.de (mean at BerliOS)
Date: Mon, 24 May 2010 12:51:39 +0200
Subject: [Avidemux-svn-commit] r6224 -
	branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreDemuxerMpeg/include
Message-ID: <201005241051.o4OApdOR032637@sheep.berlios.de>

Author: mean
Date: 2010-05-24 12:51:39 +0200 (Mon, 24 May 2010)
New Revision: 6224

Modified:
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreDemuxerMpeg/include/dmxPSPacket.h
Log:
[PSDemux] Increase packet size to be compativble with tivo large PS packet

Modified: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreDemuxerMpeg/include/dmxPSPacket.h
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreDemuxerMpeg/include/dmxPSPacket.h	2010-05-24 10:51:37 UTC (rev 6223)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreDemuxerMpeg/include/dmxPSPacket.h	2010-05-24 10:51:39 UTC (rev 6224)
@@ -31,7 +31,7 @@
 /**
     \class psPacketLinear
 */
-#define ADM_PACKET_LINEAR 10*1024
+#define ADM_PACKET_LINEAR (300*1024) // TIVO
 
 class psPacketLinear : public psPacket
 {
@@ -147,4 +147,4 @@
 };
 
 
-#endif
\ No newline at end of file
+#endif



From mean at mail.berlios.de  Mon May 24 12:51:42 2010
From: mean at mail.berlios.de (mean at BerliOS)
Date: Mon, 24 May 2010 12:51:42 +0200
Subject: [Avidemux-svn-commit] r6225 -
	branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_demuxers/MpegPS
Message-ID: <201005241051.o4OApgnu032727@sheep.berlios.de>

Author: mean
Date: 2010-05-24 12:51:41 +0200 (Mon, 24 May 2010)
New Revision: 6225

Modified:
   branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_demuxers/MpegPS/ADM_psAudioProbe.cpp
Log:
[audioProbe/PSIndexer] Increase audio buffer to be compatible with tivo large PS packt

Modified: branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_demuxers/MpegPS/ADM_psAudioProbe.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_demuxers/MpegPS/ADM_psAudioProbe.cpp	2010-05-24 10:51:39 UTC (rev 6224)
+++ branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_demuxers/MpegPS/ADM_psAudioProbe.cpp	2010-05-24 10:51:41 UTC (rev 6225)
@@ -26,11 +26,11 @@
 // Number of video packet seen to be enough to sample the audio tracks
 #define PROBE_PACKET_VIDEO_COUNT 500
 // Max size of a packet. Usually it is a bit more than 2300, so 10000 should be safe
-#define PACKET_PROBE_SIZE 10000
+#define PACKET_PROBE_SIZE (100*1024)
 // Minimum of packet seen to declare it valid
 #define PROBE_MIN_PACKET 5
 #define PROBE_MIN_SIZE   5000
-
+#define PROBE_ANALYZE_SIZE (300*1024) // Should be enough in all cases (need ~ 2 blocks)
 #define MP2_AUDIO_VALUE 0xC0
 #define LPCM_AUDIO_VALUE 0xA0
 #define DTS_AC3_AUDIO_VALUE 0x00
@@ -100,7 +100,7 @@
 */
 bool addAudioTrack(int pid, listOfPsAudioTracks *list, psPacketLinearTracker *p)
 {
-#define PROBE_ANALYZE_SIZE 6000 // Should be enough in all cases (need ~ 2 blocks)
+
 uint8_t audioBuffer[PROBE_ANALYZE_SIZE];
         uint64_t pts,dts,startAt;
         uint32_t packetSize;



From gruntster at mail.berlios.de  Tue May 25 23:03:16 2010
From: gruntster at mail.berlios.de (gruntster at mail.berlios.de)
Date: Tue, 25 May 2010 23:03:16 +0200
Subject: [Avidemux-svn-commit] r6227 -
	branches/avidemux_2.5_branch_gruntster/po
Message-ID: <201005252103.o4PL3Gua013356@sheep.berlios.de>

Author: gruntster
Date: 2010-05-25 23:03:11 +0200 (Tue, 25 May 2010)
New Revision: 6227

Modified:
   branches/avidemux_2.5_branch_gruntster/po/qt_update_pro.sh
   branches/avidemux_2.5_branch_gruntster/po/update_pot.bash
Log:
[i18n] include plugins in generation of translation sources

Modified: branches/avidemux_2.5_branch_gruntster/po/qt_update_pro.sh
===================================================================
--- branches/avidemux_2.5_branch_gruntster/po/qt_update_pro.sh	2010-05-25 20:48:57 UTC (rev 6226)
+++ branches/avidemux_2.5_branch_gruntster/po/qt_update_pro.sh	2010-05-25 21:03:11 UTC (rev 6227)
@@ -6,16 +6,19 @@
 echo "Finding HEADERS..."
 echo "HEADERS = \\" > avidemux.pro
 find ../avidemux -iname '*.h' -not -iwholename '*ADM_GTK*' -not -iwholename '*ADM_NONE*' -printf "%p \\\ \n" >> avidemux.pro
+find ../plugins -iname '*.h' -not -iwholename '*gtk*' -printf "%p \\\ \n" >> avidemux.pro
 echo "" >> avidemux.pro
 
 echo "Finding SOURCES..."
 echo "SOURCES = \\" >> avidemux.pro
 find ../avidemux -iname '*.cpp' -not -iwholename '*ADM_GTK*' -not -iwholename '*ADM_NONE*' -printf "%p \\\ \n" >> avidemux.pro
+find ../plugins -iname '*.cpp' -not -iwholename '*gtk*' -printf "%p \\\ \n" >> avidemux.pro
 echo "" >> avidemux.pro
 
 echo "Finding FORMS..."
 echo "FORMS = \\" >> avidemux.pro
 find ../avidemux -iname '*.ui' -not -iwholename '*ADM_GTK*' -not -iwholename '*ADM_NONE*' -printf "%p \\\ \n" >> avidemux.pro
+find ../plugins -iname '*.ui' -not -iwholename '*gtk*' -printf "%p \\\ \n" >> avidemux.pro
 echo "" >> avidemux.pro
 
 echo "Finding TRANSLATIONS..."

Modified: branches/avidemux_2.5_branch_gruntster/po/update_pot.bash
===================================================================
--- branches/avidemux_2.5_branch_gruntster/po/update_pot.bash	2010-05-25 20:48:57 UTC (rev 6226)
+++ branches/avidemux_2.5_branch_gruntster/po/update_pot.bash	2010-05-25 21:03:11 UTC (rev 6227)
@@ -2,11 +2,11 @@
 cd .. 
 echo "Finding HEADERS..."
 find ./avidemux -iname '*.h' -not -iwholename '*ADM_QT4*' > po/POTFILES.in
-find ./plugins -iname '*.h' -not -iwholename '*ADM_QT4*' >> po/POTFILES.in
+find ./plugins -iname '*.h' -not -iwholename '*ADM_QT4*' -not -iwholename '*qt4*' >> po/POTFILES.in
 
 echo "Finding SOURCES..."
 find ./avidemux -iname '*.cpp' -not -iwholename '*ADM_QT4*' >> po/POTFILES.in
-find ./plugins -iname '*.cpp' -not -iwholename '*ADM_QT4*' >> po/POTFILES.in
+find ./plugins -iname '*.cpp' -not -iwholename '*ADM_QT4*' -not -iwholename '*qt4*' >> po/POTFILES.in
 
 cd po
 echo "Generating pot file..."



From gruntster at mail.berlios.de  Tue May 25 23:16:19 2010
From: gruntster at mail.berlios.de (gruntster at mail.berlios.de)
Date: Tue, 25 May 2010 23:16:19 +0200
Subject: [Avidemux-svn-commit] r6229 - in
	branches/avidemux_2.5_branch_gruntster: avidemux
	plugins/ADM_audioEncoders plugins/ADM_audioEncoders/aften
Message-ID: <201005252116.o4PLGJh4014453@sheep.berlios.de>

Author: gruntster
Date: 2010-05-25 23:16:13 +0200 (Tue, 25 May 2010)
New Revision: 6229

Removed:
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_audioEncoder/
Modified:
   branches/avidemux_2.5_branch_gruntster/avidemux/main.cpp
   branches/avidemux_2.5_branch_gruntster/plugins/ADM_audioEncoders/CMakeLists.txt
   branches/avidemux_2.5_branch_gruntster/plugins/ADM_audioEncoders/aften/audioencoder_aften_param.h
Log:
[misc] cosmetics

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/main.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/main.cpp	2010-05-25 21:04:46 UTC (rev 6228)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/main.cpp	2010-05-25 21:16:13 UTC (rev 6229)
@@ -123,13 +123,13 @@
 
     printf("\n*************************\n");
     printf(" http://www.avidemux.org\n");
-    printf(" Code      : Mean, JSC, Gruntster \n");
-    printf(" GFX       : Nestor Di , nestordi at augcyl.org\n");
+    printf(" Code      : Mean, JSC, Grant Pedersen\n");
+    printf(" GFX       : Nestor Di, nestordi at augcyl.org\n");
     printf(" Design    : Jakub Misak\n");
     printf(" FreeBSD   : Anish Mistry, amistry at am-productions.biz\n");
     printf(" Audio     : Mihail Zenkov\n");
-    printf(" MacOsX    : Kuisathaverat\n");
-    printf(" Win32     : Gruntster\n\n");
+    printf(" Mac OS X  : Kuisathaverat, Harry van der Wolf\n");
+    printf(" Win32     : Grant Pedersen\n\n");
 
 #ifdef __GNUC__
 	printf("Compiler: GCC %s\n", __VERSION__);
@@ -200,7 +200,6 @@
     InitCoreToolkit();
     initFileSelector();
 
-
 	// Load .avidemuxrc
     quotaInit();
 

Modified: branches/avidemux_2.5_branch_gruntster/plugins/ADM_audioEncoders/CMakeLists.txt
===================================================================
--- branches/avidemux_2.5_branch_gruntster/plugins/ADM_audioEncoders/CMakeLists.txt	2010-05-25 21:04:46 UTC (rev 6228)
+++ branches/avidemux_2.5_branch_gruntster/plugins/ADM_audioEncoders/CMakeLists.txt	2010-05-25 21:16:13 UTC (rev 6229)
@@ -7,7 +7,7 @@
 ADD_SUBDIRECTORY(lavcodec)
 
 if(USE_LAME)
-ADD_SUBDIRECTORY(lame)
+	ADD_SUBDIRECTORY(lame)
 endif(USE_LAME)
 
 if(USE_AFTEN)
@@ -15,9 +15,9 @@
 endif(USE_AFTEN)
 
 if(USE_VORBIS)
-ADD_SUBDIRECTORY(vorbis)
+	ADD_SUBDIRECTORY(vorbis)
 endif(USE_VORBIS)
 
 if(USE_FAAC)
-ADD_SUBDIRECTORY(faac)
+	ADD_SUBDIRECTORY(faac)
 endif(USE_FAAC)

Modified: branches/avidemux_2.5_branch_gruntster/plugins/ADM_audioEncoders/aften/audioencoder_aften_param.h
===================================================================
--- branches/avidemux_2.5_branch_gruntster/plugins/ADM_audioEncoders/aften/audioencoder_aften_param.h	2010-05-25 21:04:46 UTC (rev 6228)
+++ branches/avidemux_2.5_branch_gruntster/plugins/ADM_audioEncoders/aften/audioencoder_aften_param.h	2010-05-25 21:16:13 UTC (rev 6229)
@@ -2,7 +2,7 @@
 #define AUDM_AFTEN_PARAM_H
 
 
-typedef struct AFTEN_encoderParam
+struct AFTEN_encoderParam
 {
   uint32_t        bitrate;
   ADM_mode        mode;



From mean at mail.berlios.de  Wed May 26 07:26:26 2010
From: mean at mail.berlios.de (mean at BerliOS)
Date: Wed, 26 May 2010 07:26:26 +0200
Subject: [Avidemux-svn-commit] r6232 - in
	branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavutil:
	. arm sh4 tomi x86
Message-ID: <201005260526.o4Q5QPE9028071@sheep.berlios.de>

Author: mean
Date: 2010-05-26 07:26:23 +0200 (Wed, 26 May 2010)
New Revision: 6232

Added:
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavutil/attributes.h
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavutil/avconfig.h
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavutil/error.c
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavutil/error.h
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavutil/intmath.h
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavutil/libm.h
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavutil/pixdesc.c
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavutil/pixdesc.h
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavutil/tomi/
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavutil/tomi/intreadwrite.h
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavutil/x86/intmath.h
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavutil/x86/intreadwrite.h
Modified:
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavutil/adler32.c
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavutil/adler32.h
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavutil/arm/bswap.h
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavutil/arm/intreadwrite.h
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavutil/arm/timer.h
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavutil/avstring.c
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavutil/avstring.h
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavutil/avutil.h
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavutil/base64.c
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavutil/bswap.h
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavutil/common.h
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavutil/crc.c
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavutil/crc.h
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavutil/des.c
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavutil/fifo.c
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavutil/fifo.h
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavutil/integer.c
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavutil/integer.h
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavutil/internal.h
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavutil/intfloat_readwrite.c
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavutil/intfloat_readwrite.h
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavutil/intreadwrite.h
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavutil/lfg.c
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavutil/lfg.h
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavutil/lls.c
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavutil/log.c
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavutil/log.h
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavutil/mathematics.c
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavutil/mathematics.h
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavutil/md5.c
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavutil/mem.c
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavutil/mem.h
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavutil/pca.c
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavutil/pca.h
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavutil/pixfmt.h
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavutil/random_seed.c
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavutil/random_seed.h
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavutil/rational.c
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavutil/rational.h
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavutil/sh4/bswap.h
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavutil/sha.c
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavutil/timer.h
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavutil/tree.c
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavutil/tree.h
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavutil/utils.c
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavutil/x86/bswap.h
Log:
[import lavutil] 24 05 2010

Modified: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavutil/adler32.c
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavutil/adler32.c	2010-05-26 05:26:02 UTC (rev 6231)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavutil/adler32.c	2010-05-26 05:26:23 UTC (rev 6232)
@@ -21,7 +21,7 @@
  * 3. This notice may not be removed or altered from any source distribution.
  */
 
-#include "common.h"
+#include "config.h"
 #include "adler32.h"
 
 #define BASE 65521L /* largest prime smaller than 65536 */
@@ -53,6 +53,7 @@
 
 #ifdef TEST
 #include "log.h"
+#include "timer.h"
 #define LEN 7001
 volatile int checksum;
 int main(void){

Modified: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavutil/adler32.h
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavutil/adler32.h	2010-05-26 05:26:02 UTC (rev 6231)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavutil/adler32.h	2010-05-26 05:26:23 UTC (rev 6232)
@@ -22,7 +22,7 @@
 #define AVUTIL_ADLER32_H
 
 #include <stdint.h>
-#include "common.h"
+#include "attributes.h"
 
 unsigned long av_adler32_update(unsigned long adler, const uint8_t *buf,
                                 unsigned int len) av_pure;

Modified: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavutil/arm/bswap.h
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavutil/arm/bswap.h	2010-05-26 05:26:02 UTC (rev 6231)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavutil/arm/bswap.h	2010-05-26 05:26:23 UTC (rev 6232)
@@ -21,13 +21,13 @@
 
 #include <stdint.h>
 #include "config.h"
-#include "libavutil/common.h"
+#include "libavutil/attributes.h"
 
 #ifdef __ARMCC_VERSION
 
 #if HAVE_ARMV6
 #define bswap_16 bswap_16
-static av_always_inline av_const uint16_t bswap_16(uint16_t x)
+static av_always_inline av_const unsigned bswap_16(unsigned x)
 {
     __asm { rev16 x, x }
     return x;
@@ -44,7 +44,7 @@
 
 #if HAVE_ARMV6
 #define bswap_16 bswap_16
-static av_always_inline av_const uint16_t bswap_16(uint16_t x)
+static av_always_inline av_const unsigned bswap_16(unsigned x)
 {
     __asm__("rev16 %0, %0" : "+r"(x));
     return x;

Modified: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavutil/arm/intreadwrite.h
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavutil/arm/intreadwrite.h	2010-05-26 05:26:02 UTC (rev 6231)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavutil/arm/intreadwrite.h	2010-05-26 05:26:23 UTC (rev 6232)
@@ -25,7 +25,7 @@
 #if HAVE_FAST_UNALIGNED && HAVE_INLINE_ASM
 
 #define AV_RN16 AV_RN16
-static inline uint16_t AV_RN16(const void *p)
+static av_always_inline uint16_t AV_RN16(const void *p)
 {
     uint16_t v;
     __asm__ ("ldrh %0, %1" : "=r"(v) : "m"(*(const uint16_t *)p));
@@ -33,13 +33,13 @@
 }
 
 #define AV_WN16 AV_WN16
-static inline void AV_WN16(void *p, uint16_t v)
+static av_always_inline void AV_WN16(void *p, uint16_t v)
 {
     __asm__ ("strh %1, %0" : "=m"(*(uint16_t *)p) : "r"(v));
 }
 
 #define AV_RN32 AV_RN32
-static inline uint32_t AV_RN32(const void *p)
+static av_always_inline uint32_t AV_RN32(const void *p)
 {
     uint32_t v;
     __asm__ ("ldr  %0, %1" : "=r"(v) : "m"(*(const uint32_t *)p));
@@ -47,13 +47,13 @@
 }
 
 #define AV_WN32 AV_WN32
-static inline void AV_WN32(void *p, uint32_t v)
+static av_always_inline void AV_WN32(void *p, uint32_t v)
 {
     __asm__ ("str  %1, %0" : "=m"(*(uint32_t *)p) : "r"(v));
 }
 
 #define AV_RN64 AV_RN64
-static inline uint64_t AV_RN64(const void *p)
+static av_always_inline uint64_t AV_RN64(const void *p)
 {
     union { uint64_t v; uint32_t hl[2]; } v;
     __asm__ ("ldr   %0, %2  \n\t"
@@ -64,7 +64,7 @@
 }
 
 #define AV_WN64 AV_WN64
-static inline void AV_WN64(void *p, uint64_t v)
+static av_always_inline void AV_WN64(void *p, uint64_t v)
 {
     union { uint64_t v; uint32_t hl[2]; } vv = { v };
     __asm__ ("str  %2, %0  \n\t"

Modified: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavutil/arm/timer.h
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavutil/arm/timer.h	2010-05-26 05:26:02 UTC (rev 6231)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavutil/arm/timer.h	2010-05-26 05:26:23 UTC (rev 6232)
@@ -22,6 +22,7 @@
 #define AVUTIL_ARM_TIMER_H
 
 #include <stdint.h>
+#include "config.h"
 
 #if HAVE_INLINE_ASM && defined(__ARM_ARCH_7A__)
 

Added: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavutil/attributes.h
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavutil/attributes.h	2010-05-26 05:26:02 UTC (rev 6231)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavutil/attributes.h	2010-05-26 05:26:23 UTC (rev 6232)
@@ -0,0 +1,121 @@
+/*
+ * copyright (c) 2006 Michael Niedermayer <michaelni at gmx.at>
+ *
+ * This file is part of FFmpeg.
+ *
+ * FFmpeg is free software; you can redistribute it and/or
+ * modify it under the terms of the GNU Lesser General Public
+ * License as published by the Free Software Foundation; either
+ * version 2.1 of the License, or (at your option) any later version.
+ *
+ * FFmpeg is distributed in the hope that it will be useful,
+ * but WITHOUT ANY WARRANTY; without even the implied warranty of
+ * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ * Lesser General Public License for more details.
+ *
+ * You should have received a copy of the GNU Lesser General Public
+ * License along with FFmpeg; if not, write to the Free Software
+ * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA
+ */
+
+/**
+ * @file
+ * Macro definitions for various function/variable attributes
+ */
+
+#ifndef AVUTIL_ATTRIBUTES_H
+#define AVUTIL_ATTRIBUTES_H
+
+#ifdef __GNUC__
+#    define AV_GCC_VERSION_AT_LEAST(x,y) (__GNUC__ > x || __GNUC__ == x && __GNUC_MINOR__ >= y)
+#else
+#    define AV_GCC_VERSION_AT_LEAST(x,y) 0
+#endif
+
+#ifndef av_always_inline
+#if AV_GCC_VERSION_AT_LEAST(3,1)
+#    define av_always_inline __attribute__((always_inline)) inline
+#else
+#    define av_always_inline inline
+#endif
+#endif
+
+#ifndef av_noinline
+#if AV_GCC_VERSION_AT_LEAST(3,1)
+#    define av_noinline __attribute__((noinline))
+#else
+#    define av_noinline
+#endif
+#endif
+
+#ifndef av_pure
+#if AV_GCC_VERSION_AT_LEAST(3,1)
+#    define av_pure __attribute__((pure))
+#else
+#    define av_pure
+#endif
+#endif
+
+#ifndef av_const
+#if AV_GCC_VERSION_AT_LEAST(2,6)
+#    define av_const __attribute__((const))
+#else
+#    define av_const
+#endif
+#endif
+
+#ifndef av_cold
+#if (!defined(__ICC) || __ICC > 1110) && AV_GCC_VERSION_AT_LEAST(4,3)
+#    define av_cold __attribute__((cold))
+#else
+#    define av_cold
+#endif
+#endif
+
+#ifndef av_flatten
+#if (!defined(__ICC) || __ICC > 1110) && AV_GCC_VERSION_AT_LEAST(4,1)
+#    define av_flatten __attribute__((flatten))
+#else
+#    define av_flatten
+#endif
+#endif
+
+#ifndef attribute_deprecated
+#if AV_GCC_VERSION_AT_LEAST(3,1)
+#    define attribute_deprecated __attribute__((deprecated))
+#else
+#    define attribute_deprecated
+#endif
+#endif
+
+#ifndef av_unused
+#if defined(__GNUC__)
+#    define av_unused __attribute__((unused))
+#else
+#    define av_unused
+#endif
+#endif
+
+#ifndef av_alias
+#if (!defined(__ICC) || __ICC > 1110) && AV_GCC_VERSION_AT_LEAST(3,3)
+#   define av_alias __attribute__((may_alias))
+#else
+#   define av_alias
+#endif
+#endif
+
+#ifndef av_uninit
+#if defined(__GNUC__) && !defined(__ICC)
+#    define av_uninit(x) x=x
+#else
+#    define av_uninit(x) x
+#endif
+#endif
+
+#ifdef __GNUC__
+#    define av_builtin_constant_p __builtin_constant_p
+#else
+#    define av_builtin_constant_p(x) 0
+#endif
+
+#endif /* AVUTIL_ATTRIBUTES_H */

Added: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavutil/avconfig.h
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavutil/avconfig.h	2010-05-26 05:26:02 UTC (rev 6231)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavutil/avconfig.h	2010-05-26 05:26:23 UTC (rev 6232)
@@ -0,0 +1,5 @@
+/* Generated by ffconf */
+#ifndef AVUTIL_AVCONFIG_H
+#define AVUTIL_AVCONFIG_H
+#define AV_HAVE_BIGENDIAN 0
+#endif /* AVUTIL_AVCONFIG_H */

Modified: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavutil/avstring.c
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavutil/avstring.c	2010-05-26 05:26:02 UTC (rev 6231)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavutil/avstring.c	2010-05-26 05:26:23 UTC (rev 6232)
@@ -24,6 +24,7 @@
 #include <string.h>
 #include <ctype.h>
 #include "avstring.h"
+#include "mem.h"
 
 int av_strstart(const char *str, const char *pfx, const char **ptr)
 {
@@ -47,6 +48,19 @@
     return !*pfx;
 }
 
+char *av_stristr(const char *s1, const char *s2)
+{
+    if (!*s2)
+        return s1;
+
+    do {
+        if (av_stristart(s1, s2, NULL))
+            return s1;
+    } while (*s1++);
+
+    return NULL;
+}
+
 size_t av_strlcpy(char *dst, const char *src, size_t size)
 {
     size_t len = 0;
@@ -76,3 +90,10 @@
 
     return len;
 }
+
+char *av_d2str(double d)
+{
+    char *str= av_malloc(16);
+    if(str) snprintf(str, 16, "%f", d);
+    return str;
+}

Modified: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavutil/avstring.h
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavutil/avstring.h	2010-05-26 05:26:02 UTC (rev 6231)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavutil/avstring.h	2010-05-26 05:26:23 UTC (rev 6232)
@@ -47,6 +47,20 @@
 int av_stristart(const char *str, const char *pfx, const char **ptr);
 
 /**
+ * Locate the first case-independent occurrence in the string haystack
+ * of the string needle.  A zero-length string needle is considered to
+ * match at the start of haystack.
+ *
+ * This function is a case-insensitive version of the standard strstr().
+ *
+ * @param haystack string to search in
+ * @param needle   string to search for
+ * @return         pointer to the located match within haystack
+ *                 or a null pointer if no match
+ */
+char *av_stristr(const char *haystack, const char *needle);
+
+/**
  * Copy the string src to dst, but no more than size - 1 bytes, and
  * null-terminate dst.
  *
@@ -56,6 +70,10 @@
  * @param src source string
  * @param size size of destination buffer
  * @return the length of src
+ *
+ * WARNING: since the return value is the length of src, src absolutely
+ * _must_ be a properly 0-terminated string, otherwise this will read beyond
+ * the end of the buffer and possibly crash.
  */
 size_t av_strlcpy(char *dst, const char *src, size_t size);
 
@@ -70,12 +88,16 @@
  * @param src source string
  * @param size size of destination buffer
  * @return the total length of src and dst
+ *
+ * WARNING: since the return value use the length of src and dst, these absolutely
+ * _must_ be a properly 0-terminated strings, otherwise this will read beyond
+ * the end of the buffer and possibly crash.
  */
 size_t av_strlcat(char *dst, const char *src, size_t size);
 
 /**
  * Append output to a string, according to a format. Never write out of
- * the destination buffer, and and always put a terminating 0 within
+ * the destination buffer, and always put a terminating 0 within
  * the buffer.
  * @param dst destination buffer (string to which the output is
  *  appended)
@@ -87,4 +109,9 @@
  */
 size_t av_strlcatf(char *dst, size_t size, const char *fmt, ...);
 
+/**
+ * Convert a number to a av_malloced string.
+ */
+char *av_d2str(double d);
+
 #endif /* AVUTIL_AVSTRING_H */

Modified: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavutil/avutil.h
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavutil/avutil.h	2010-05-26 05:26:02 UTC (rev 6231)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavutil/avutil.h	2010-05-26 05:26:23 UTC (rev 6232)
@@ -22,27 +22,25 @@
 #define AVUTIL_AVUTIL_H
 
 /**
- * @file libavutil/avutil.h
+ * @file
  * external API header
  */
 
-/* MEANX
- * - */
-#define ASMALIGN(ZEROBITS) ".p2align " #ZEROBITS "\n\t"
-/* /MEANX
- */
 
-
-
 #define AV_STRINGIFY(s)         AV_TOSTRING(s)
 #define AV_TOSTRING(s) #s
 
+#define AV_GLUE(a, b) a ## b
+#define AV_JOIN(a, b) AV_GLUE(a, b)
+
+#define AV_PRAGMA(s) _Pragma(#s)
+
 #define AV_VERSION_INT(a, b, c) (a<<16 | b<<8 | c)
 #define AV_VERSION_DOT(a, b, c) a ##.## b ##.## c
 #define AV_VERSION(a, b, c) AV_VERSION_DOT(a, b, c)
 
 #define LIBAVUTIL_VERSION_MAJOR 50
-#define LIBAVUTIL_VERSION_MINOR  3
+#define LIBAVUTIL_VERSION_MINOR 16
 #define LIBAVUTIL_VERSION_MICRO  0
 
 #define LIBAVUTIL_VERSION_INT   AV_VERSION_INT(LIBAVUTIL_VERSION_MAJOR, \
@@ -60,7 +58,28 @@
  */
 unsigned avutil_version(void);
 
+/**
+ * Returns the libavutil build-time configuration.
+ */
+const char *avutil_configuration(void);
+
+/**
+ * Returns the libavutil license.
+ */
+const char *avutil_license(void);
+
+enum AVMediaType {
+    AVMEDIA_TYPE_UNKNOWN = -1,
+    AVMEDIA_TYPE_VIDEO,
+    AVMEDIA_TYPE_AUDIO,
+    AVMEDIA_TYPE_DATA,
+    AVMEDIA_TYPE_SUBTITLE,
+    AVMEDIA_TYPE_ATTACHMENT,
+    AVMEDIA_TYPE_NB
+};
+
 #include "common.h"
+#include "error.h"
 #include "mathematics.h"
 #include "rational.h"
 #include "intfloat_readwrite.h"

Modified: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavutil/base64.c
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavutil/base64.c	2010-05-26 05:26:02 UTC (rev 6231)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavutil/base64.c	2010-05-26 05:26:23 UTC (rev 6232)
@@ -19,7 +19,7 @@
  */
 
 /**
- * @file libavutil/base64.c
+ * @file
  * @brief Base64 encode/decode
  * @author Ryan Martell <rdm4 at martellventures.com> (with lots of Michael)
  */

Modified: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavutil/bswap.h
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavutil/bswap.h	2010-05-26 05:26:02 UTC (rev 6231)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavutil/bswap.h	2010-05-26 05:26:23 UTC (rev 6232)
@@ -19,7 +19,7 @@
  */
 
 /**
- * @file libavutil/bswap.h
+ * @file
  * byte swapping routines
  */
 
@@ -27,14 +27,9 @@
 #define AVUTIL_BSWAP_H
 
 #include <stdint.h>
-// MEANX
-#ifndef ADM_NO_CONFIG_H
 #include "config.h"
-#endif
-// MEANX
+#include "attributes.h"
 
-#include "common.h"
-
 #if   ARCH_ARM
 #   include "arm/bswap.h"
 #elif ARCH_AVR32
@@ -47,6 +42,12 @@
 #   include "x86/bswap.h"
 #endif
 
+#define AV_BSWAP16C(x) (((x) << 8 & 0xff00)  | ((x) >> 8 & 0x00ff))
+#define AV_BSWAP32C(x) (AV_BSWAP16C(x) << 16 | AV_BSWAP16C((x) >> 16))
+#define AV_BSWAP64C(x) (AV_BSWAP32C(x) << 32 | AV_BSWAP32C((x) >> 32))
+
+#define AV_BSWAPC(s, x) AV_BSWAP##s##C(x)
+
 #ifndef bswap_16
 static av_always_inline av_const uint16_t bswap_16(uint16_t x)
 {
@@ -94,6 +95,8 @@
 #define le2me_16(x) bswap_16(x)
 #define le2me_32(x) bswap_32(x)
 #define le2me_64(x) bswap_64(x)
+#define AV_BE2MEC(s, x) (x)
+#define AV_LE2MEC(s, x) AV_BSWAPC(s, x)
 #else
 #define be2me_16(x) bswap_16(x)
 #define be2me_32(x) bswap_32(x)
@@ -101,6 +104,15 @@
 #define le2me_16(x) (x)
 #define le2me_32(x) (x)
 #define le2me_64(x) (x)
+#define AV_BE2MEC(s, x) AV_BSWAPC(s, x)
+#define AV_LE2MEC(s, x) (x)
 #endif
 
+#define AV_BE2ME16C(x) AV_BE2MEC(16, x)
+#define AV_BE2ME32C(x) AV_BE2MEC(32, x)
+#define AV_BE2ME64C(x) AV_BE2MEC(64, x)
+#define AV_LE2ME16C(x) AV_LE2MEC(16, x)
+#define AV_LE2ME32C(x) AV_LE2MEC(32, x)
+#define AV_LE2ME64C(x) AV_LE2MEC(64, x)
+
 #endif /* AVUTIL_BSWAP_H */

Modified: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavutil/common.h
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavutil/common.h	2010-05-26 05:26:02 UTC (rev 6231)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavutil/common.h	2010-05-26 05:26:23 UTC (rev 6232)
@@ -19,7 +19,7 @@
  */
 
 /**
- * @file libavutil/common.h
+ * @file
  * common internal and external API header
  */
 
@@ -34,89 +34,8 @@
 #include <stdio.h>
 #include <stdlib.h>
 #include <string.h>
+#include "attributes.h"
 
-#ifdef HAVE_AV_CONFIG_H
-#include "config.h"
-#endif
-
-#ifdef __GNUC__
-#    define AV_GCC_VERSION_AT_LEAST(x,y) (__GNUC__ > x || __GNUC__ == x && __GNUC_MINOR__ >= y)
-#else
-#    define AV_GCC_VERSION_AT_LEAST(x,y) 0
-#endif
-
-#ifndef av_always_inline
-#if AV_GCC_VERSION_AT_LEAST(3,1)
-#    define av_always_inline __attribute__((always_inline)) inline
-#else
-#    define av_always_inline inline
-#endif
-#endif
-
-#ifndef av_noinline
-#if AV_GCC_VERSION_AT_LEAST(3,1)
-#    define av_noinline __attribute__((noinline))
-#else
-#    define av_noinline
-#endif
-#endif
-
-#ifndef av_pure
-#if AV_GCC_VERSION_AT_LEAST(3,1)
-#    define av_pure __attribute__((pure))
-#else
-#    define av_pure
-#endif
-#endif
-
-#ifndef av_const
-#if AV_GCC_VERSION_AT_LEAST(2,6)
-#    define av_const __attribute__((const))
-#else
-#    define av_const
-#endif
-#endif
-
-#ifndef av_cold
-#if (!defined(__ICC) || __ICC > 1110) && AV_GCC_VERSION_AT_LEAST(4,3)
-#    define av_cold __attribute__((cold))
-#else
-#    define av_cold
-#endif
-#endif
-
-#ifndef av_flatten
-#if (!defined(__ICC) || __ICC > 1110) && AV_GCC_VERSION_AT_LEAST(4,1)
-#    define av_flatten __attribute__((flatten))
-#else
-#    define av_flatten
-#endif
-#endif
-
-#ifndef attribute_deprecated
-#if AV_GCC_VERSION_AT_LEAST(3,1)
-#    define attribute_deprecated __attribute__((deprecated))
-#else
-#    define attribute_deprecated
-#endif
-#endif
-
-#ifndef av_unused
-#if defined(__GNUC__)
-#    define av_unused __attribute__((unused))
-#else
-#    define av_unused
-#endif
-#endif
-
-#ifndef av_uninit
-#if defined(__GNUC__) && !defined(__ICC)
-#    define av_uninit(x) x=x
-#else
-#    define av_uninit(x) x
-#endif
-#endif
-
 //rounded division & shift
 #define RSHIFT(a,b) ((a) > 0 ? ((a) + ((1<<(b))>>1))>>(b) : ((a) + ((1<<(b))>>1)-1)>>(b))
 /* assume b>0 */
@@ -136,7 +55,9 @@
 /* misc math functions */
 extern const uint8_t ff_log2_tab[256];
 
-static inline av_const int av_log2(unsigned int v)
+extern const uint8_t av_reverse[256];
+
+static inline av_const int av_log2_c(unsigned int v)
 {
     int n = 0;
     if (v & 0xffff0000) {
@@ -152,7 +73,7 @@
     return n;
 }
 
-static inline av_const int av_log2_16bit(unsigned int v)
+static inline av_const int av_log2_16bit_c(unsigned int v)
 {
     int n = 0;
     if (v & 0xff00) {
@@ -164,6 +85,18 @@
     return n;
 }
 
+#ifdef HAVE_AV_CONFIG_H
+#   include "config.h"
+#   include "intmath.h"
+#endif
+
+#ifndef av_log2
+#   define av_log2       av_log2_c
+#endif
+#ifndef av_log2_16bit
+#   define av_log2_16bit av_log2_16bit_c
+#endif
+
 /**
  * Clips a signed integer value into the amin-amax range.
  * @param a value to clip
@@ -185,8 +118,8 @@
  */
 static inline av_const uint8_t av_clip_uint8(int a)
 {
-    if (a&(~255)) return (-a)>>31;
-    else          return a;
+    if (a&(~0xFF)) return (-a)>>31;
+    else           return a;
 }
 
 /**
@@ -196,8 +129,8 @@
  */
 static inline av_const uint16_t av_clip_uint16(int a)
 {
-    if (a&(~65535)) return (-a)>>31;
-    else            return a;
+    if (a&(~0xFFFF)) return (-a)>>31;
+    else             return a;
 }
 
 /**
@@ -207,11 +140,22 @@
  */
 static inline av_const int16_t av_clip_int16(int a)
 {
-    if ((a+32768) & ~65535) return (a>>31) ^ 32767;
-    else                    return a;
+    if ((a+0x8000) & ~0xFFFF) return (a>>31) ^ 0x7FFF;
+    else                      return a;
 }
 
 /**
+ * Clips a signed 64-bit integer value into the -2147483648,2147483647 range.
+ * @param a value to clip
+ * @return clipped value
+ */
+static inline av_const int32_t av_clipl_int32(int64_t a)
+{
+    if ((a+0x80000000u) & ~UINT64_C(0xFFFFFFFF)) return (a>>63) ^ 0x7FFFFFFF;
+    else                                         return a;
+}
+
+/**
  * Clips a float value into the amin-amax range.
  * @param a value to clip
  * @param amin minimum value of the clip range
@@ -225,6 +169,15 @@
     else               return a;
 }
 
+/** Computes ceil(log2(x)).
+ * @param x value used to compute ceil(log2(x))
+ * @return computed ceiling of log2(x)
+ */
+static inline av_const int av_ceil_log2(int x)
+{
+    return av_log2((x - 1) << 1);
+}
+
 #define MKTAG(a,b,c,d) (a | (b << 8) | (c << 16) | (d << 24))
 #define MKBETAG(a,b,c,d) (d | (c << 8) | (b << 16) | (a << 24))
 
@@ -257,6 +210,30 @@
     }
 
 /*!
+ * \def GET_UTF16(val, GET_16BIT, ERROR)
+ * Converts a UTF-16 character (2 or 4 bytes) to its 32-bit UCS-4 encoded form
+ * \param val is the output and should be of type uint32_t. It holds the converted
+ * UCS-4 character and should be a left value.
+ * \param GET_16BIT gets two bytes of UTF-16 encoded data converted to native endianness.
+ * It can be a function or a statement whose return value or evaluated value is of type
+ * uint16_t. It will be executed up to 2 times.
+ * \param ERROR action that should be taken when an invalid UTF-16 surrogate is
+ * returned from GET_BYTE. It should be a statement that jumps out of the macro,
+ * like exit(), goto, return, break, or continue.
+ */
+#define GET_UTF16(val, GET_16BIT, ERROR)\
+    val = GET_16BIT;\
+    {\
+        unsigned int hi = val - 0xD800;\
+        if (hi < 0x800) {\
+            val = GET_16BIT - 0xDC00;\
+            if (val > 0x3FFU || hi > 0x3FFU)\
+                ERROR\
+            val += (hi<<10) + 0x10000;\
+        }\
+    }\
+
+/*!
  * \def PUT_UTF8(val, tmp, PUT_BYTE)
  * Converts a 32-bit Unicode character to its UTF-8 encoded form (up to 4 bytes long).
  * \param val is an input-only argument and should be of type uint32_t. It holds
@@ -292,6 +269,36 @@
         }\
     }
 
+/*!
+ * \def PUT_UTF16(val, tmp, PUT_16BIT)
+ * Converts a 32-bit Unicode character to its UTF-16 encoded form (2 or 4 bytes).
+ * \param val is an input-only argument and should be of type uint32_t. It holds
+ * a UCS-4 encoded Unicode character that is to be converted to UTF-16. If
+ * val is given as a function it is executed only once.
+ * \param tmp is a temporary variable and should be of type uint16_t. It
+ * represents an intermediate value during conversion that is to be
+ * output by PUT_16BIT.
+ * \param PUT_16BIT writes the converted UTF-16 data to any proper destination
+ * in desired endianness. It could be a function or a statement, and uses tmp
+ * as the input byte.  For example, PUT_BYTE could be "*output++ = tmp;"
+ * PUT_BYTE will be executed 1 or 2 times depending on input character.
+ */
+#define PUT_UTF16(val, tmp, PUT_16BIT)\
+    {\
+        uint32_t in = val;\
+        if (in < 0x10000) {\
+            tmp = in;\
+            PUT_16BIT\
+        } else {\
+            tmp = 0xD800 | ((in - 0x10000) >> 10);\
+            PUT_16BIT\
+            tmp = 0xDC00 | ((in - 0x10000) & 0x3FF);\
+            PUT_16BIT\
+        }\
+    }\
+
+
+
 #include "mem.h"
 
 #ifdef HAVE_AV_CONFIG_H

Modified: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavutil/crc.c
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavutil/crc.c	2010-05-26 05:26:02 UTC (rev 6231)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavutil/crc.c	2010-05-26 05:26:23 UTC (rev 6232)
@@ -19,6 +19,7 @@
  */
 
 #include "config.h"
+#include "common.h"
 #include "bswap.h"
 #include "crc.h"
 

Modified: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavutil/crc.h
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavutil/crc.h	2010-05-26 05:26:02 UTC (rev 6231)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavutil/crc.h	2010-05-26 05:26:23 UTC (rev 6232)
@@ -23,7 +23,7 @@
 
 #include <stdint.h>
 #include <stddef.h>
-#include "common.h"
+#include "attributes.h"
 
 typedef uint32_t AVCRC;
 

Modified: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavutil/des.c
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavutil/des.c	2010-05-26 05:26:02 UTC (rev 6231)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavutil/des.c	2010-05-26 05:26:23 UTC (rev 6232)
@@ -339,10 +339,10 @@
 }
 
 static const uint8_t test_key[] = {0x12, 0x34, 0x56, 0x78, 0x9a, 0xbc, 0xde, 0xf0};
-static const DECLARE_ALIGNED(8, uint8_t, plain[]) = {0xfe, 0xdc, 0xba, 0x98, 0x76, 0x54, 0x32, 0x10};
-static const DECLARE_ALIGNED(8, uint8_t, crypt[]) = {0x4a, 0xb6, 0x5b, 0x3d, 0x4b, 0x06, 0x15, 0x18};
-static DECLARE_ALIGNED(8, uint8_t, tmp[8]);
-static DECLARE_ALIGNED(8, uint8_t, large_buffer[10002][8]);
+static const DECLARE_ALIGNED(8, uint8_t, plain)[] = {0xfe, 0xdc, 0xba, 0x98, 0x76, 0x54, 0x32, 0x10};
+static const DECLARE_ALIGNED(8, uint8_t, crypt)[] = {0x4a, 0xb6, 0x5b, 0x3d, 0x4b, 0x06, 0x15, 0x18};
+static DECLARE_ALIGNED(8, uint8_t, tmp)[8];
+static DECLARE_ALIGNED(8, uint8_t, large_buffer)[10002][8];
 static const uint8_t cbc_key[] = {
     0x01, 0x23, 0x45, 0x67, 0x89, 0xab, 0xcd, 0xef,
     0x23, 0x45, 0x67, 0x89, 0xab, 0xcd, 0xef, 0x01,

Added: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavutil/error.c
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavutil/error.c	2010-05-26 05:26:02 UTC (rev 6231)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavutil/error.c	2010-05-26 05:26:23 UTC (rev 6232)
@@ -0,0 +1,47 @@
+/*
+ * This file is part of FFmpeg.
+ *
+ * FFmpeg is free software; you can redistribute it and/or
+ * modify it under the terms of the GNU Lesser General Public
+ * License as published by the Free Software Foundation; either
+ * version 2.1 of the License, or (at your option) any later version.
+ *
+ * FFmpeg is distributed in the hope that it will be useful,
+ * but WITHOUT ANY WARRANTY; without even the implied warranty of
+ * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ * Lesser General Public License for more details.
+ *
+ * You should have received a copy of the GNU Lesser General Public
+ * License along with FFmpeg; if not, write to the Free Software
+ * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA
+ */
+
+#include "avutil.h"
+#include "avstring.h"
+
+int av_strerror(int errnum, char *errbuf, size_t errbuf_size)
+{
+    int ret = 0;
+    const char *errstr = NULL;
+
+    switch (errnum) {
+    case AVERROR_EOF:               errstr = "End of file"; break;
+    case AVERROR_INVALIDDATA:       errstr = "Invalid data found when processing input"; break;
+    case AVERROR_NUMEXPECTED:       errstr = "Number syntax expected in filename"; break;
+    case AVERROR_PATCHWELCOME:      errstr = "Not yet implemented in FFmpeg, patches welcome"; break;
+    }
+
+    if (errstr) {
+        av_strlcpy(errbuf, errstr, errbuf_size);
+    } else {
+#if HAVE_STRERROR_R
+        ret = strerror_r(AVUNERROR(errnum), errbuf, errbuf_size);
+#else
+        ret = -1;
+#endif
+        if (ret < 0)
+            snprintf(errbuf, errbuf_size, "Error number %d occurred", errnum);
+    }
+
+    return ret;
+}

Added: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavutil/error.h
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavutil/error.h	2010-05-26 05:26:02 UTC (rev 6231)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavutil/error.h	2010-05-26 05:26:23 UTC (rev 6232)
@@ -0,0 +1,72 @@
+/*
+ * This file is part of FFmpeg.
+ *
+ * FFmpeg is free software; you can redistribute it and/or
+ * modify it under the terms of the GNU Lesser General Public
+ * License as published by the Free Software Foundation; either
+ * version 2.1 of the License, or (at your option) any later version.
+ *
+ * FFmpeg is distributed in the hope that it will be useful,
+ * but WITHOUT ANY WARRANTY; without even the implied warranty of
+ * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ * Lesser General Public License for more details.
+ *
+ * You should have received a copy of the GNU Lesser General Public
+ * License along with FFmpeg; if not, write to the Free Software
+ * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA
+ */
+
+/**
+ * @file
+ * error code definitions
+ */
+
+#ifndef AVUTIL_ERROR_H
+#define AVUTIL_ERROR_H
+
+#include <errno.h>
+#include "avutil.h"
+
+/* error handling */
+#if EDOM > 0
+#define AVERROR(e) (-(e))   ///< Returns a negative error code from a POSIX error code, to return from library functions.
+#define AVUNERROR(e) (-(e)) ///< Returns a POSIX error code from a library function error return value.
+#else
+/* Some platforms have E* and errno already negated. */
+#define AVERROR(e) (e)
+#define AVUNERROR(e) (e)
+#endif
+
+#if LIBAVUTIL_VERSION_MAJOR < 51
+#define AVERROR_INVALIDDATA AVERROR(EINVAL)  ///< Invalid data found when processing input
+#define AVERROR_IO          AVERROR(EIO)     ///< I/O error
+#define AVERROR_NOENT       AVERROR(ENOENT)  ///< No such file or directory
+#define AVERROR_NOFMT       AVERROR(EILSEQ)  ///< Unknown format
+#define AVERROR_NOMEM       AVERROR(ENOMEM)  ///< Not enough memory
+#define AVERROR_NOTSUPP     AVERROR(ENOSYS)  ///< Operation not supported
+#define AVERROR_NUMEXPECTED AVERROR(EDOM)    ///< Number syntax expected in filename
+#define AVERROR_UNKNOWN     AVERROR(EINVAL)  ///< Unknown error
+#endif
+
+#define AVERROR_EOF         AVERROR(EPIPE)   ///< End of file
+
+#define AVERROR_PATCHWELCOME    (-MKTAG('P','A','W','E')) ///< Not yet implemented in FFmpeg, patches welcome
+
+#if LIBAVUTIL_VERSION_MAJOR > 50
+#define AVERROR_INVALIDDATA     (-MKTAG('I','N','D','A')) ///< Invalid data found when processing input
+#define AVERROR_NUMEXPECTED     (-MKTAG('N','U','E','X')) ///< Number syntax expected in filename
+#endif
+
+/**
+ * Puts a description of the AVERROR code errnum in errbuf.
+ * In case of failure the global variable errno is set to indicate the
+ * error. Even in case of failure av_strerror() will print a generic
+ * error message indicating the errnum provided to errbuf.
+ *
+ * @param errbuf_size the size in bytes of errbuf
+ * @return 0 on success, a negative value if a description for errnum
+ * cannot be found
+ */
+int av_strerror(int errnum, char *errbuf, size_t errbuf_size);
+
+#endif /* AVUTIL_ERROR_H */

Modified: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavutil/fifo.c
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavutil/fifo.c	2010-05-26 05:26:02 UTC (rev 6231)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavutil/fifo.c	2010-05-26 05:26:23 UTC (rev 6232)
@@ -78,6 +78,7 @@
     return 0;
 }
 
+// src must NOT be const as it can be a context for func that may need updating (like a pointer or byte counter)
 int av_fifo_generic_write(AVFifoBuffer *f, void *src, int size, int (*func)(void*, void*, int))
 {
     int total = size;

Modified: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavutil/fifo.h
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavutil/fifo.h	2010-05-26 05:26:02 UTC (rev 6231)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavutil/fifo.h	2010-05-26 05:26:23 UTC (rev 6232)
@@ -17,7 +17,7 @@
  */
 
 /**
- * @file libavutil/fifo.h
+ * @file
  * a very simple circular buffer FIFO implementation
  */
 
@@ -25,8 +25,6 @@
 #define AVUTIL_FIFO_H
 
 #include <stdint.h>
-#include "avutil.h"
-#include "common.h"
 
 typedef struct AVFifoBuffer {
     uint8_t *buffer;
@@ -37,7 +35,7 @@
 /**
  * Initializes an AVFifoBuffer.
  * @param size of FIFO
- * @return AVFifoBuffer or NULL if mem allocation failure
+ * @return AVFifoBuffer or NULL in case of memory allocation failure
  */
 AVFifoBuffer *av_fifo_alloc(unsigned int size);
 
@@ -81,7 +79,8 @@
 /**
  * Feeds data from a user-supplied callback to an AVFifoBuffer.
  * @param *f AVFifoBuffer to write to
- * @param *src data source
+ * @param *src data source; non-const since it may be used as a
+ * modifiable context by the function defined in func
  * @param size number of bytes to write
  * @param *func generic write function; the first parameter is src,
  * the second is dest_buf, the third is dest_buf_size.

Modified: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavutil/integer.c
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavutil/integer.c	2010-05-26 05:26:02 UTC (rev 6231)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavutil/integer.c	2010-05-26 05:26:23 UTC (rev 6232)
@@ -20,7 +20,7 @@
  */
 
 /**
- * @file libavutil/integer.c
+ * @file
  * arbitrary precision integers
  * @author Michael Niedermayer <michaelni at gmx.at>
  */

Modified: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavutil/integer.h
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavutil/integer.h	2010-05-26 05:26:02 UTC (rev 6231)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavutil/integer.h	2010-05-26 05:26:23 UTC (rev 6232)
@@ -20,7 +20,7 @@
  */
 
 /**
- * @file libavutil/integer.h
+ * @file
  * arbitrary precision integers
  * @author Michael Niedermayer <michaelni at gmx.at>
  */

Modified: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavutil/internal.h
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavutil/internal.h	2010-05-26 05:26:02 UTC (rev 6231)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavutil/internal.h	2010-05-26 05:26:23 UTC (rev 6232)
@@ -19,7 +19,7 @@
  */
 
 /**
- * @file libavutil/internal.h
+ * @file
  * common internal API header
  */
 
@@ -34,13 +34,8 @@
 #include <stdint.h>
 #include <stddef.h>
 #include <assert.h>
-// MEANX
-#ifndef ADM_NO_CONFIG_H
 #include "config.h"
-#endif
-// MEANX
-#include "common.h"
-#include "mem.h"
+#include "attributes.h"
 #include "timer.h"
 
 #ifndef attribute_align_arg
@@ -60,7 +55,7 @@
 #endif
 
 #ifndef INT16_MIN
-#define INT16_MIN       (-0x7fff-1)
+#define INT16_MIN       (-0x7fff - 1)
 #endif
 
 #ifndef INT16_MAX
@@ -68,7 +63,7 @@
 #endif
 
 #ifndef INT32_MIN
-#define INT32_MIN       (-0x7fffffff-1)
+#define INT32_MIN       (-0x7fffffff - 1)
 #endif
 
 #ifndef INT32_MAX
@@ -80,7 +75,7 @@
 #endif
 
 #ifndef INT64_MIN
-#define INT64_MIN       (-0x7fffffffffffffffLL-1)
+#define INT64_MIN       (-0x7fffffffffffffffLL - 1)
 #endif
 
 #ifndef INT64_MAX
@@ -95,12 +90,8 @@
 #    define INT_BIT (CHAR_BIT * sizeof(int))
 #endif
 
-#if ( defined(__PIC__) || defined(__pic__) ) && ! defined(PIC)
-#    define PIC
-#endif
-
 #ifndef offsetof
-#    define offsetof(T,F) ((unsigned int)((char *)&((T *)0)->F))
+#    define offsetof(T, F) ((unsigned int)((char *)&((T *)0)->F))
 #endif
 
 /* Use to export labels from asm. */
@@ -128,67 +119,7 @@
 
 /* math */
 
-extern const uint32_t ff_inverse[256];
-
 #if ARCH_X86
-#    define FASTDIV(a,b) \
-    ({\
-        int ret,dmy;\
-        __asm__ volatile(\
-            "mull %3"\
-            :"=d"(ret),"=a"(dmy)\
-            :"1"(a),"g"(ff_inverse[b])\
-            );\
-        ret;\
-    })
-#elif HAVE_ARMV6 && HAVE_INLINE_ASM
-static inline av_const int FASTDIV(int a, int b)
-{
-    int r, t;
-    __asm__ volatile("cmp     %3, #2               \n\t"
-                     "ldr     %1, [%4, %3, lsl #2] \n\t"
-                     "lsrle   %0, %2, #1           \n\t"
-                     "smmulgt %0, %1, %2           \n\t"
-                     : "=&r"(r), "=&r"(t) : "r"(a), "r"(b), "r"(ff_inverse));
-    return r;
-}
-#elif ARCH_ARM && HAVE_INLINE_ASM
-static inline av_const int FASTDIV(int a, int b)
-{
-    int r, t;
-    __asm__ volatile ("umull %1, %0, %2, %3"
-                      : "=&r"(r), "=&r"(t) : "r"(a), "r"(ff_inverse[b]));
-    return r;
-}
-#elif CONFIG_FASTDIV
-#    define FASTDIV(a,b)   ((uint32_t)((((uint64_t)a)*ff_inverse[b])>>32))
-#else
-#    define FASTDIV(a,b)   ((a)/(b))
-#endif
-
-extern const uint8_t ff_sqrt_tab[256];
-
-static inline av_const unsigned int ff_sqrt(unsigned int a)
-{
-    unsigned int b;
-
-    if(a<255) return (ff_sqrt_tab[a+1]-1)>>4;
-    else if(a<(1<<12)) b= ff_sqrt_tab[a>>4 ]>>2;
-#if !CONFIG_SMALL
-    else if(a<(1<<14)) b= ff_sqrt_tab[a>>6 ]>>1;
-    else if(a<(1<<16)) b= ff_sqrt_tab[a>>8 ]   ;
-#endif
-    else{
-        int s= av_log2_16bit(a>>16)>>1;
-        unsigned int c= a>>(s+2);
-        b= ff_sqrt_tab[c>>(s+8)];
-        b= FASTDIV(c,b) + (b<<s);
-    }
-
-    return b - (a<b*b);
-}
-
-#if ARCH_X86
 #define MASK_ABS(mask, level)\
             __asm__ volatile(\
                 "cltd                   \n\t"\
@@ -198,38 +129,17 @@
             );
 #else
 #define MASK_ABS(mask, level)\
-            mask= level>>31;\
-            level= (level^mask)-mask;
+            mask  = level >> 31;\
+            level = (level ^ mask) - mask;
 #endif
 
-#if HAVE_CMOV
-#define COPY3_IF_LT(x,y,a,b,c,d)\
-__asm__ volatile (\
-    "cmpl %0, %3        \n\t"\
-    "cmovl %3, %0       \n\t"\
-    "cmovl %4, %1       \n\t"\
-    "cmovl %5, %2       \n\t"\
-    : "+&r" (x), "+&r" (a), "+r" (c)\
-    : "r" (y), "r" (b), "r" (d)\
-);
-#else
-#define COPY3_IF_LT(x,y,a,b,c,d)\
-if((y)<(x)){\
-     (x)=(y);\
-     (a)=(b);\
-     (c)=(d);\
-}
-#endif
-
 /* avoid usage of dangerous/inappropriate system functions */
-#if 0 //MEANX
 #undef  malloc
 #define malloc please_use_av_malloc
 #undef  free
 #define free please_use_av_free
 #undef  realloc
 #define realloc please_use_av_realloc
-#endif
 #undef  time
 #define time time_is_forbidden_due_to_security_issues
 #undef  rand
@@ -255,64 +165,26 @@
 #define perror please_use_av_log_instead_of_perror
 #endif
 
-#define CHECKED_ALLOCZ(p, size)\
+#define FF_ALLOC_OR_GOTO(ctx, p, size, label)\
 {\
-    p= av_mallocz(size);\
-    if(p==NULL && (size)!=0){\
-        av_log(NULL, AV_LOG_ERROR, "Cannot allocate memory.");\
-        goto fail;\
+    p = av_malloc(size);\
+    if (p == NULL && (size) != 0) {\
+        av_log(ctx, AV_LOG_ERROR, "Cannot allocate memory.\n");\
+        goto label;\
     }\
 }
 
-#if !HAVE_LLRINT
-static av_always_inline av_const long long llrint(double x)
-{
-    return rint(x);
+#define FF_ALLOCZ_OR_GOTO(ctx, p, size, label)\
+{\
+    p = av_mallocz(size);\
+    if (p == NULL && (size) != 0) {\
+        av_log(ctx, AV_LOG_ERROR, "Cannot allocate memory.\n");\
+        goto label;\
+    }\
 }
-#endif /* HAVE_LLRINT */
 
-#if !HAVE_LOG2
-static av_always_inline av_const double log2(double x)
-{
-    return log(x) * 1.44269504088896340736;
-}
-#endif /* HAVE_LOG2 */
+#include "libm.h"
 
-#if !HAVE_LRINT
-static av_always_inline av_const long int lrint(double x)
-{
-    return rint(x);
-}
-#endif /* HAVE_LRINT */
-
-#if !HAVE_LRINTF
-static av_always_inline av_const long int lrintf(float x)
-{
-    return (int)(rint(x));
-}
-#endif /* HAVE_LRINTF */
-
-#if !HAVE_ROUND
-static av_always_inline av_const double round(double x)
-{
-    return (x > 0) ? floor(x + 0.5) : ceil(x - 0.5);
-}
-#endif /* HAVE_ROUND */
-
-#if !HAVE_ROUNDF
-static av_always_inline av_const float roundf(float x)
-{
-    return (x > 0) ? floor(x + 0.5) : ceil(x - 0.5);
-}
-#endif /* HAVE_ROUNDF */
-
-#if !HAVE_TRUNCF
-static av_always_inline av_const float truncf(float x)
-{
-    return (x > 0) ? floor(x) : ceil(x);
-}
-#endif /* HAVE_TRUNCF */
-
 /**
  * Returns NULL if CONFIG_SMALL is true, otherwise the argument
  * without modification. Used to disable the definition of strings

Modified: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavutil/intfloat_readwrite.c
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavutil/intfloat_readwrite.c	2010-05-26 05:26:02 UTC (rev 6231)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavutil/intfloat_readwrite.c	2010-05-26 05:26:23 UTC (rev 6232)
@@ -21,11 +21,12 @@
  */
 
 /**
- * @file libavutil/intfloat_readwrite.c
+ * @file
  * portable IEEE float/double read/write functions
  */
 
-#include "common.h"
+#include <stdint.h>
+#include <math.h>
 #include "intfloat_readwrite.h"
 
 double av_int2dbl(int64_t v){

Modified: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavutil/intfloat_readwrite.h
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavutil/intfloat_readwrite.h	2010-05-26 05:26:02 UTC (rev 6231)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavutil/intfloat_readwrite.h	2010-05-26 05:26:23 UTC (rev 6232)
@@ -22,7 +22,7 @@
 #define AVUTIL_INTFLOAT_READWRITE_H
 
 #include <stdint.h>
-#include "common.h"
+#include "attributes.h"
 
 /* IEEE 80 bits extended float */
 typedef struct AVExtFloat  {

Added: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavutil/intmath.h
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavutil/intmath.h	2010-05-26 05:26:02 UTC (rev 6231)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavutil/intmath.h	2010-05-26 05:26:23 UTC (rev 6232)
@@ -0,0 +1,98 @@
+/*
+ * Copyright (c) 2010 Mans Rullgard <mans at mansr.com>
+ *
+ * This file is part of FFmpeg.
+ *
+ * FFmpeg is free software; you can redistribute it and/or
+ * modify it under the terms of the GNU Lesser General Public
+ * License as published by the Free Software Foundation; either
+ * version 2.1 of the License, or (at your option) any later version.
+ *
+ * FFmpeg is distributed in the hope that it will be useful,
+ * but WITHOUT ANY WARRANTY; without even the implied warranty of
+ * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ * Lesser General Public License for more details.
+ *
+ * You should have received a copy of the GNU Lesser General Public
+ * License along with FFmpeg; if not, write to the Free Software
+ * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA
+ */
+
+#ifndef AVUTIL_INTMATH_H
+#define AVUTIL_INTMATH_H
+
+#include <stdint.h>
+#include "config.h"
+#include "attributes.h"
+
+extern const uint32_t ff_inverse[257];
+
+#if   ARCH_ARM
+#   include "arm/intmath.h"
+#elif ARCH_X86
+#   include "x86/intmath.h"
+#endif
+
+#if HAVE_FAST_CLZ && AV_GCC_VERSION_AT_LEAST(3,4)
+
+#ifndef av_log2
+
+#define av_log2(x) (31 - __builtin_clz((x)|1))
+
+#ifndef av_log2_16bit
+#define av_log2_16bit av_log2
+#endif
+
+#endif /* av_log2 */
+
+#endif /* AV_GCC_VERSION_AT_LEAST(3,4) */
+
+#ifndef FASTDIV
+
+#if CONFIG_FASTDIV
+#    define FASTDIV(a,b)   ((uint32_t)((((uint64_t)a) * ff_inverse[b]) >> 32))
+#else
+#    define FASTDIV(a,b)   ((a) / (b))
+#endif
+
+#endif /* FASTDIV */
+
+/*
+ * Get definition of av_log2_c from common.h.  In the event we got
+ * here through common.h including this file, including it again will
+ * be a no-op due to multi-inclusion guards, so we must duplicate the
+ * fallback defines here.
+ */
+
+#include "common.h"
+
+#ifndef av_log2
+#   define av_log2       av_log2_c
+#endif
+#ifndef av_log2_16bit
+#   define av_log2_16bit av_log2_16bit_c
+#endif
+
+extern const uint8_t ff_sqrt_tab[256];
+
+static inline av_const unsigned int ff_sqrt(unsigned int a)
+{
+    unsigned int b;
+
+    if (a < 255) return (ff_sqrt_tab[a + 1] - 1) >> 4;
+    else if (a < (1 << 12)) b = ff_sqrt_tab[a >> 4] >> 2;
+#if !CONFIG_SMALL
+    else if (a < (1 << 14)) b = ff_sqrt_tab[a >> 6] >> 1;
+    else if (a < (1 << 16)) b = ff_sqrt_tab[a >> 8]   ;
+#endif
+    else {
+        int s = av_log2_16bit(a >> 16) >> 1;
+        unsigned int c = a >> (s + 2);
+        b = ff_sqrt_tab[c >> (s + 8)];
+        b = FASTDIV(c,b) + (b << s);
+    }
+
+    return b - (a < b * b);
+}
+
+#endif /* AVUTIL_INTMATH_H */

Modified: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavutil/intreadwrite.h
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavutil/intreadwrite.h	2010-05-26 05:26:02 UTC (rev 6231)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavutil/intreadwrite.h	2010-05-26 05:26:23 UTC (rev 6232)
@@ -20,18 +20,36 @@
 #define AVUTIL_INTREADWRITE_H
 
 #include <stdint.h>
-// MEANX
-#ifndef ADM_NO_CONFIG_H
 #include "config.h"
-#endif
-// MEANX
-
 #include "bswap.h"
+#include "common.h"
 
+typedef union {
+    uint64_t u64;
+    uint32_t u32[2];
+    uint16_t u16[4];
+    uint8_t  u8 [8];
+    double   f64;
+    float    f32[2];
+} av_alias av_alias64;
+
+typedef union {
+    uint32_t u32;
+    uint16_t u16[2];
+    uint8_t  u8 [4];
+    float    f32;
+} av_alias av_alias32;
+
+typedef union {
+    uint16_t u16;
+    uint8_t  u8 [2];
+} av_alias av_alias16;
+
 /*
  * Arch-specific headers can provide any combination of
- * AV_[RW][BLN](16|24|32|64) macros.  Preprocessor symbols must be
- * defined, even if these are implemented as inline functions.
+ * AV_[RW][BLN](16|24|32|64) and AV_(COPY|SWAP|ZERO)(64|128) macros.
+ * Preprocessor symbols must be defined, even if these are implemented
+ * as inline functions.
  */
 
 #if   ARCH_ARM
@@ -42,6 +60,10 @@
 #   include "mips/intreadwrite.h"
 #elif ARCH_PPC
 #   include "ppc/intreadwrite.h"
+#elif ARCH_TOMI
+#   include "tomi/intreadwrite.h"
+#elif ARCH_X86
+#   include "x86/intreadwrite.h"
 #endif
 
 /*
@@ -157,22 +179,22 @@
 
 #if   HAVE_ATTRIBUTE_PACKED
 
-struct unaligned_64 { uint64_t l; } __attribute__((packed));
-struct unaligned_32 { uint32_t l; } __attribute__((packed));
-struct unaligned_16 { uint16_t l; } __attribute__((packed));
+union unaligned_64 { uint64_t l; } __attribute__((packed)) av_alias;
+union unaligned_32 { uint32_t l; } __attribute__((packed)) av_alias;
+union unaligned_16 { uint16_t l; } __attribute__((packed)) av_alias;
 
-#   define AV_RN(s, p) (((const struct unaligned_##s *) (p))->l)
-#   define AV_WN(s, p, v) (((struct unaligned_##s *) (p))->l) = (v)
+#   define AV_RN(s, p) (((const union unaligned_##s *) (p))->l)
+#   define AV_WN(s, p, v) ((((union unaligned_##s *) (p))->l) = (v))
 
 #elif defined(__DECC)
 
 #   define AV_RN(s, p) (*((const __unaligned uint##s##_t*)(p)))
-#   define AV_WN(s, p, v) *((__unaligned uint##s##_t*)(p)) = (v)
+#   define AV_WN(s, p, v) (*((__unaligned uint##s##_t*)(p)) = (v))
 
 #elif HAVE_FAST_UNALIGNED
 
-#   define AV_RN(s, p) (*((const uint##s##_t*)(p)))
-#   define AV_WN(s, p, v) *((uint##s##_t*)(p)) = (v)
+#   define AV_RN(s, p) (((const av_alias##s*)(p))->u##s)
+#   define AV_WN(s, p, v) (((av_alias##s*)(p))->u##s = (v))
 
 #else
 
@@ -402,4 +424,93 @@
     } while(0)
 #endif
 
+/*
+ * The AV_[RW]NA macros access naturally aligned data
+ * in a type-safe way.
+ */
+
+#define AV_RNA(s, p)    (((const av_alias##s*)(p))->u##s)
+#define AV_WNA(s, p, v) (((av_alias##s*)(p))->u##s = (v))
+
+#ifndef AV_RN16A
+#   define AV_RN16A(p) AV_RNA(16, p)
+#endif
+
+#ifndef AV_RN32A
+#   define AV_RN32A(p) AV_RNA(32, p)
+#endif
+
+#ifndef AV_RN64A
+#   define AV_RN64A(p) AV_RNA(64, p)
+#endif
+
+#ifndef AV_WN16A
+#   define AV_WN16A(p, v) AV_WNA(16, p, v)
+#endif
+
+#ifndef AV_WN32A
+#   define AV_WN32A(p, v) AV_WNA(32, p, v)
+#endif
+
+#ifndef AV_WN64A
+#   define AV_WN64A(p, v) AV_WNA(64, p, v)
+#endif
+
+/* Parameters for AV_COPY*, AV_SWAP*, AV_ZERO* must be
+ * naturally aligned. They may be implemented using MMX,
+ * so emms_c() must be called before using any float code
+ * afterwards.
+ */
+
+#define AV_COPY(n, d, s) \
+    (((av_alias##n*)(d))->u##n = ((const av_alias##n*)(s))->u##n)
+
+#ifndef AV_COPY16
+#   define AV_COPY16(d, s) AV_COPY(16, d, s)
+#endif
+
+#ifndef AV_COPY32
+#   define AV_COPY32(d, s) AV_COPY(32, d, s)
+#endif
+
+#ifndef AV_COPY64
+#   define AV_COPY64(d, s) AV_COPY(64, d, s)
+#endif
+
+#ifndef AV_COPY128
+#   define AV_COPY128(d, s)                    \
+    do {                                       \
+        AV_COPY64(d, s);                       \
+        AV_COPY64((char*)(d)+8, (char*)(s)+8); \
+    } while(0)
+#endif
+
+#define AV_SWAP(n, a, b) FFSWAP(av_alias##n, *(av_alias##n*)(a), *(av_alias##n*)(b))
+
+#ifndef AV_SWAP64
+#   define AV_SWAP64(a, b) AV_SWAP(64, a, b)
+#endif
+
+#define AV_ZERO(n, d) (((av_alias##n*)(d))->u##n = 0)
+
+#ifndef AV_ZERO16
+#   define AV_ZERO16(d) AV_ZERO(16, d)
+#endif
+
+#ifndef AV_ZERO32
+#   define AV_ZERO32(d) AV_ZERO(32, d)
+#endif
+
+#ifndef AV_ZERO64
+#   define AV_ZERO64(d) AV_ZERO(64, d)
+#endif
+
+#ifndef AV_ZERO128
+#   define AV_ZERO128(d)         \
+    do {                         \
+        AV_ZERO64(d);            \
+        AV_ZERO64((char*)(d)+8); \
+    } while(0)
+#endif
+
 #endif /* AVUTIL_INTREADWRITE_H */

Modified: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavutil/lfg.c
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavutil/lfg.c	2010-05-26 05:26:02 UTC (rev 6231)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavutil/lfg.c	2010-05-26 05:26:23 UTC (rev 6232)
@@ -23,7 +23,8 @@
 #include "lfg.h"
 #include "md5.h"
 #include "intreadwrite.h"
-#undef index //MEANS
+#include "attributes.h"
+
 void av_cold av_lfg_init(AVLFG *c, unsigned int seed){
     uint8_t tmp[16]={0};
     int i;
@@ -39,9 +40,24 @@
     c->index=0;
 }
 
+void av_bmg_get(AVLFG *lfg, double out[2])
+{
+    double x1, x2, w;
+
+    do {
+        x1 = 2.0/UINT_MAX*av_lfg_get(lfg) - 1.0;
+        x2 = 2.0/UINT_MAX*av_lfg_get(lfg) - 1.0;
+        w = x1*x1 + x2*x2;
+    } while (w >= 1.0);
+
+    w = sqrt((-2.0 * log(w)) / w);
+    out[0] = x1 * w;
+    out[1] = x2 * w;
+}
+
 #ifdef TEST
 #include "log.h"
-#include "common.h"
+#include "timer.h"
 
 int main(void)
 {
@@ -59,6 +75,24 @@
         STOP_TIMER("624 calls of av_lfg_get");
     }
     av_log(NULL, AV_LOG_ERROR, "final value:%X\n", x);
+
+    /* BMG usage example */
+    {
+        double mean   = 1000;
+        double stddev = 53;
+
+        av_lfg_init(&state, 42);
+
+        for (i = 0; i < 1000; i += 2) {
+            double bmg_out[2];
+            av_bmg_get(&state, bmg_out);
+            av_log(NULL, AV_LOG_INFO,
+                   "%f\n%f\n",
+                   bmg_out[0] * stddev + mean,
+                   bmg_out[1] * stddev + mean);
+        }
+    }
+
     return 0;
 }
 #endif

Modified: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavutil/lfg.h
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavutil/lfg.h	2010-05-26 05:26:02 UTC (rev 6231)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavutil/lfg.h	2010-05-26 05:26:23 UTC (rev 6232)
@@ -51,4 +51,12 @@
     return c->state[c->index++ & 63] = 2*a*b+a+b;
 }
 
+/**
+ * Gets the next two numbers generated by a Box-Muller Gaussian
+ * generator using the random numbers issued by lfg.
+ *
+ * @param out[2] array where are placed the two generated numbers
+ */
+void av_bmg_get(AVLFG *lfg, double out[2]);
+
 #endif /* AVUTIL_LFG_H */

Added: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavutil/libm.h
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavutil/libm.h	2010-05-26 05:26:02 UTC (rev 6231)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavutil/libm.h	2010-05-26 05:26:23 UTC (rev 6232)
@@ -0,0 +1,96 @@
+/*
+ * This file is part of FFmpeg.
+ *
+ * FFmpeg is free software; you can redistribute it and/or
+ * modify it under the terms of the GNU Lesser General Public
+ * License as published by the Free Software Foundation; either
+ * version 2.1 of the License, or (at your option) any later version.
+ *
+ * FFmpeg is distributed in the hope that it will be useful,
+ * but WITHOUT ANY WARRANTY; without even the implied warranty of
+ * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ * Lesser General Public License for more details.
+ *
+ * You should have received a copy of the GNU Lesser General Public
+ * License along with FFmpeg; if not, write to the Free Software
+ * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA
+ */
+
+/**
+ * @file
+ * Replacements for frequently missing libm functions
+ */
+
+#ifndef AVUTIL_LIBM_H
+#define AVUTIL_LIBM_H
+
+#include <math.h>
+#include "config.h"
+#include "attributes.h"
+
+#if !HAVE_EXP2
+#undef exp2
+#define exp2(x) exp((x) * 0.693147180559945)
+#endif /* HAVE_EXP2 */
+
+#if !HAVE_EXP2F
+#undef exp2f
+#define exp2f(x) ((float)exp2(x))
+#endif /* HAVE_EXP2F */
+
+#if !HAVE_LLRINT
+#undef llrint
+#define llrint(x) ((long long)rint(x))
+#endif /* HAVE_LLRINT */
+
+#if !HAVE_LLRINTF
+#undef llrintf
+#define llrintf(x) ((long long)rint(x))
+#endif /* HAVE_LLRINT */
+
+#if !HAVE_LOG2
+#undef log2
+#define log2(x) (log(x) * 1.44269504088896340736)
+#endif /* HAVE_LOG2 */
+
+#if !HAVE_LOG2F
+#undef log2f
+#define log2f(x) ((float)log2(x))
+#endif /* HAVE_LOG2F */
+
+#if !HAVE_LRINT
+static av_always_inline av_const long int lrint(double x)
+{
+    return rint(x);
+}
+#endif /* HAVE_LRINT */
+
+#if !HAVE_LRINTF
+static av_always_inline av_const long int lrintf(float x)
+{
+    return (int)(rint(x));
+}
+#endif /* HAVE_LRINTF */
+
+#if !HAVE_ROUND
+static av_always_inline av_const double round(double x)
+{
+    return (x > 0) ? floor(x + 0.5) : ceil(x - 0.5);
+}
+#endif /* HAVE_ROUND */
+
+#if !HAVE_ROUNDF
+static av_always_inline av_const float roundf(float x)
+{
+    return (x > 0) ? floor(x + 0.5) : ceil(x - 0.5);
+}
+#endif /* HAVE_ROUNDF */
+
+#if !HAVE_TRUNCF
+static av_always_inline av_const float truncf(float x)
+{
+    return (x > 0) ? floor(x) : ceil(x);
+}
+#endif /* HAVE_TRUNCF */
+
+#endif /* AVUTIL_LIBM_H */

Modified: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavutil/lls.c
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavutil/lls.c	2010-05-26 05:26:02 UTC (rev 6231)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavutil/lls.c	2010-05-26 05:26:23 UTC (rev 6232)
@@ -21,7 +21,7 @@
  */
 
 /**
- * @file libavutil/lls.c
+ * @file
  * linear least squares model
  */
 

Modified: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavutil/log.c
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavutil/log.c	2010-05-26 05:26:02 UTC (rev 6231)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavutil/log.c	2010-05-26 05:26:23 UTC (rev 6232)
@@ -20,28 +20,65 @@
  */
 
 /**
- * @file libavutil/log.c
+ * @file
  * logging functions
  */
 
+#include <unistd.h>
+#include <stdlib.h>
 #include "avutil.h"
 #include "log.h"
 
+#if LIBAVUTIL_VERSION_MAJOR > 50
+static
+#endif
 int av_log_level = AV_LOG_INFO;
 
+static int use_ansi_color=-1;
+
+#undef fprintf
+static void colored_fputs(int color, const char *str){
+    if(use_ansi_color<0){
+#if HAVE_ISATTY && !defined(_WIN32)
+        use_ansi_color= getenv("TERM") && !getenv("NO_COLOR") && isatty(2);
+#else
+        use_ansi_color= 0;
+#endif
+    }
+
+    if(use_ansi_color){
+        fprintf(stderr, "\033[%d;3%dm", color>>4, color&15);
+    }
+    fputs(str, stderr);
+    if(use_ansi_color){
+        fprintf(stderr, "\033[0m");
+    }
+}
+
+const char* av_default_item_name(void* ptr){
+    return (*(AVClass**)ptr)->class_name;
+}
+
 void av_log_default_callback(void* ptr, int level, const char* fmt, va_list vl)
 {
     static int print_prefix=1;
     static int count;
     static char line[1024], prev[1024];
+    static const uint8_t color[]={0x41,0x41,0x11,0x03,9,9,9};
     AVClass* avc= ptr ? *(AVClass**)ptr : NULL;
     if(level>av_log_level)
         return;
+    line[0]=0;
 #undef fprintf
     if(print_prefix && avc) {
-        snprintf(line, sizeof(line), "[%s @ %p]", avc->item_name(ptr), ptr);
-    }else
-        line[0]=0;
+        if(avc->version >= (50<<16 | 15<<8 | 3) && avc->parent_log_context_offset){
+            AVClass** parent= *(AVClass***)(((uint8_t*)ptr) + avc->parent_log_context_offset);
+            if(parent && *parent){
+                snprintf(line, sizeof(line), "[%s @ %p]", (*parent)->item_name(parent), parent);
+            }
+        }
+        snprintf(line + strlen(line), sizeof(line) - strlen(line), "[%s @ %p]", avc->item_name(ptr), ptr);
+    }
 
     vsnprintf(line + strlen(line), sizeof(line) - strlen(line), fmt, vl);
 
@@ -54,7 +91,7 @@
         fprintf(stderr, "    Last message repeated %d times\n", count);
         count=0;
     }
-    fputs(line, stderr);
+    colored_fputs(color[av_clip(level>>3, 0, 6)], line);
     strcpy(prev, line);
 }
 
@@ -62,8 +99,11 @@
 
 void av_log(void* avcl, int level, const char *fmt, ...)
 {
+    AVClass* avc= avcl ? *(AVClass**)avcl : NULL;
     va_list vl;
     va_start(vl, fmt);
+    if(avc && avc->version >= (50<<16 | 15<<8 | 2) && avc->log_level_offset_offset && level>=AV_LOG_FATAL)
+        level += *(int*)(((uint8_t*)avcl) + avc->log_level_offset_offset);
     av_vlog(avcl, level, fmt, vl);
     va_end(vl);
 }

Modified: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavutil/log.h
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavutil/log.h	2010-05-26 05:26:02 UTC (rev 6231)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavutil/log.h	2010-05-26 05:26:23 UTC (rev 6232)
@@ -48,6 +48,28 @@
      * @see av_set_default_options()
      */
     const struct AVOption *option;
+
+    /**
+     * LIBAVUTIL_VERSION with which this structure was created.
+     * This is used to allow fields to be added without requiring major
+     * version bumps everywhere.
+     */
+
+    int version;
+
+    /**
+     * Offset in the structure where log_level_offset is stored.
+     * 0 means there is no such variable
+     */
+    int log_level_offset_offset;
+
+    /**
+     * Offset in the structure where a pointer to the parent context for loging is stored.
+     * for example a decoder that uses eval.c could pass its AVCodecContext to eval as such
+     * parent context. And a av_log() implementation could then display the parent context
+     * can be NULL of course
+     */
+    int parent_log_context_offset;
 } AVClass;
 
 /* av_log API */
@@ -111,5 +133,6 @@
 void av_log_set_level(int);
 void av_log_set_callback(void (*)(void*, int, const char*, va_list));
 void av_log_default_callback(void* ptr, int level, const char* fmt, va_list vl);
+const char* av_default_item_name(void* ctx);
 
 #endif /* AVUTIL_LOG_H */

Modified: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavutil/mathematics.c
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavutil/mathematics.c	2010-05-26 05:26:02 UTC (rev 6231)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavutil/mathematics.c	2010-05-26 05:26:23 UTC (rev 6232)
@@ -19,13 +19,13 @@
  */
 
 /**
- * @file libavutil/mathematics.c
+ * @file
  * miscellaneous math routines and tables
  */
 
 #include <assert.h>
-#include "avutil.h"
-#include "common.h"
+#include <stdint.h>
+#include <limits.h>
 #include "mathematics.h"
 
 const uint8_t ff_sqrt_tab[256]={
@@ -50,6 +50,25 @@
         7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7
 };
 
+const uint8_t av_reverse[256]={
+0x00,0x80,0x40,0xC0,0x20,0xA0,0x60,0xE0,0x10,0x90,0x50,0xD0,0x30,0xB0,0x70,0xF0,
+0x08,0x88,0x48,0xC8,0x28,0xA8,0x68,0xE8,0x18,0x98,0x58,0xD8,0x38,0xB8,0x78,0xF8,
+0x04,0x84,0x44,0xC4,0x24,0xA4,0x64,0xE4,0x14,0x94,0x54,0xD4,0x34,0xB4,0x74,0xF4,
+0x0C,0x8C,0x4C,0xCC,0x2C,0xAC,0x6C,0xEC,0x1C,0x9C,0x5C,0xDC,0x3C,0xBC,0x7C,0xFC,
+0x02,0x82,0x42,0xC2,0x22,0xA2,0x62,0xE2,0x12,0x92,0x52,0xD2,0x32,0xB2,0x72,0xF2,
+0x0A,0x8A,0x4A,0xCA,0x2A,0xAA,0x6A,0xEA,0x1A,0x9A,0x5A,0xDA,0x3A,0xBA,0x7A,0xFA,
+0x06,0x86,0x46,0xC6,0x26,0xA6,0x66,0xE6,0x16,0x96,0x56,0xD6,0x36,0xB6,0x76,0xF6,
+0x0E,0x8E,0x4E,0xCE,0x2E,0xAE,0x6E,0xEE,0x1E,0x9E,0x5E,0xDE,0x3E,0xBE,0x7E,0xFE,
+0x01,0x81,0x41,0xC1,0x21,0xA1,0x61,0xE1,0x11,0x91,0x51,0xD1,0x31,0xB1,0x71,0xF1,
+0x09,0x89,0x49,0xC9,0x29,0xA9,0x69,0xE9,0x19,0x99,0x59,0xD9,0x39,0xB9,0x79,0xF9,
+0x05,0x85,0x45,0xC5,0x25,0xA5,0x65,0xE5,0x15,0x95,0x55,0xD5,0x35,0xB5,0x75,0xF5,
+0x0D,0x8D,0x4D,0xCD,0x2D,0xAD,0x6D,0xED,0x1D,0x9D,0x5D,0xDD,0x3D,0xBD,0x7D,0xFD,
+0x03,0x83,0x43,0xC3,0x23,0xA3,0x63,0xE3,0x13,0x93,0x53,0xD3,0x33,0xB3,0x73,0xF3,
+0x0B,0x8B,0x4B,0xCB,0x2B,0xAB,0x6B,0xEB,0x1B,0x9B,0x5B,0xDB,0x3B,0xBB,0x7B,0xFB,
+0x07,0x87,0x47,0xC7,0x27,0xA7,0x67,0xE7,0x17,0x97,0x57,0xD7,0x37,0xB7,0x77,0xF7,
+0x0F,0x8F,0x4F,0xCF,0x2F,0xAF,0x6F,0xEF,0x1F,0x9F,0x5F,0xDF,0x3F,0xBF,0x7F,0xFF,
+};
+
 int64_t av_gcd(int64_t a, int64_t b){
     if(b) return av_gcd(b, a%b);
     else  return a;
@@ -117,6 +136,14 @@
     return av_rescale_rnd(a, b, c, AV_ROUND_NEAR_INF);
 }
 
+int av_compare_ts(int64_t ts_a, AVRational tb_a, int64_t ts_b, AVRational tb_b){
+    int64_t a= tb_a.num * (int64_t)tb_b.den;
+    int64_t b= tb_b.num * (int64_t)tb_a.den;
+    if (av_rescale_rnd(ts_a, a, b, AV_ROUND_DOWN) < ts_b) return -1;
+    if (av_rescale_rnd(ts_b, b, a, AV_ROUND_DOWN) < ts_a) return  1;
+    return 0;
+}
+
 #ifdef TEST
 #include "integer.h"
 #undef printf

Modified: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavutil/mathematics.h
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavutil/mathematics.h	2010-05-26 05:26:02 UTC (rev 6231)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavutil/mathematics.h	2010-05-26 05:26:23 UTC (rev 6232)
@@ -23,7 +23,7 @@
 
 #include <stdint.h>
 #include <math.h>
-#include "common.h"
+#include "attributes.h"
 #include "rational.h"
 
 #ifndef M_E
@@ -35,12 +35,18 @@
 #ifndef M_LN10
 #define M_LN10         2.30258509299404568402  /* log_e 10 */
 #endif
+#ifndef M_LOG2_10
+#define M_LOG2_10      3.32192809488736234787  /* log_2 10 */
+#endif
 #ifndef M_PI
 #define M_PI           3.14159265358979323846  /* pi */
 #endif
 #ifndef M_SQRT1_2
 #define M_SQRT1_2      0.70710678118654752440  /* 1/sqrt(2) */
 #endif
+#ifndef M_SQRT2
+#define M_SQRT2        1.41421356237309504880  /* sqrt(2) */
+#endif
 #ifndef NAN
 #define NAN            (0.0/0.0)
 #endif
@@ -56,6 +62,11 @@
     AV_ROUND_NEAR_INF = 5, ///< Round to nearest and halfway cases away from zero.
 };
 
+/**
+ * Returns the greatest common divisor of a and b.
+ * If both a and b are 0 or either or both are <0 then behavior is
+ * undefined.
+ */
 int64_t av_const av_gcd(int64_t a, int64_t b);
 
 /**
@@ -75,4 +86,13 @@
  */
 int64_t av_rescale_q(int64_t a, AVRational bq, AVRational cq) av_const;
 
+/**
+ * Compares 2 timestamps each in its own timebases.
+ * The result of the function is undefined if one of the timestamps
+ * is outside the int64_t range when represented in the others timebase.
+ * @return -1 if ts_a is before ts_b, 1 if ts_a is after ts_b or 0 if they represent the same position
+ */
+int av_compare_ts(int64_t ts_a, AVRational tb_a, int64_t ts_b, AVRational tb_b);
+
+
 #endif /* AVUTIL_MATHEMATICS_H */

Modified: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavutil/md5.c
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavutil/md5.c	2010-05-26 05:26:02 UTC (rev 6231)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavutil/md5.c	2010-05-26 05:26:23 UTC (rev 6232)
@@ -163,6 +163,7 @@
 
 #ifdef TEST
 #include <stdio.h>
+#include <inttypes.h>
 #undef printf
 int main(void){
     uint64_t md5val;

Modified: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavutil/mem.c
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavutil/mem.c	2010-05-26 05:26:02 UTC (rev 6231)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavutil/mem.c	2010-05-26 05:26:23 UTC (rev 6232)
@@ -20,7 +20,7 @@
  */
 
 /**
- * @file libavutil/mem.c
+ * @file
  * default memory allocator for libavutil
  */
 
@@ -29,10 +29,11 @@
 #include <limits.h>
 #include <stdlib.h>
 #include <string.h>
-#ifdef HAVE_MALLOC_H
+#if HAVE_MALLOC_H
 #include <malloc.h>
 #endif
 
+#include "avutil.h"
 #include "mem.h"
 
 /* here we can use OS-dependent allocation functions */
@@ -40,116 +41,109 @@
 #undef malloc
 #undef realloc
 
+#ifdef MALLOC_PREFIX
+
+#define malloc         AV_JOIN(MALLOC_PREFIX, malloc)
+#define memalign       AV_JOIN(MALLOC_PREFIX, memalign)
+#define posix_memalign AV_JOIN(MALLOC_PREFIX, posix_memalign)
+#define realloc        AV_JOIN(MALLOC_PREFIX, realloc)
+#define free           AV_JOIN(MALLOC_PREFIX, free)
+
+void *malloc(size_t size);
+void *memalign(size_t align, size_t size);
+int   posix_memalign(void **ptr, size_t align, size_t size);
+void *realloc(void *ptr, size_t size);
+void  free(void *ptr);
+
+#endif /* MALLOC_PREFIX */
+
 /* You can redefine av_malloc and av_free in your project to use your
    memory allocator. You do not need to suppress this file because the
    linker will do it automatically. */
 
 void *av_malloc(unsigned int size)
 {
-#ifdef __APPLE__
-	return malloc(size);
-#else
-	char *c;
+    void *ptr = NULL;
+#if CONFIG_MEMALIGN_HACK
+    long diff;
+#endif
 
-	uint64_t l, lorg;
-	uint32_t *backdoor;
+    /* let's disallow possible ambiguous cases */
+    if(size > (INT_MAX-16) )
+        return NULL;
 
-	l = (uint64_t)malloc(size + 32);
+#if CONFIG_MEMALIGN_HACK
+    ptr = malloc(size+16);
+    if(!ptr)
+        return ptr;
+    diff= ((-(long)ptr - 1)&15) + 1;
+    ptr = (char*)ptr + diff;
+    ((char*)ptr)[-1]= diff;
+#elif HAVE_POSIX_MEMALIGN
+    if (posix_memalign(&ptr,16,size))
+        ptr = NULL;
+#elif HAVE_MEMALIGN
+    ptr = memalign(16,size);
+    /* Why 64?
+       Indeed, we should align it:
+         on 4 for 386
+         on 16 for 486
+         on 32 for 586, PPro - K6-III
+         on 64 for K7 (maybe for P3 too).
+       Because L1 and L2 caches are aligned on those values.
+       But I don't want to code such logic here!
+     */
+     /* Why 16?
+        Because some CPUs need alignment, for example SSE2 on P4, & most RISC CPUs
+        it will just trigger an exception and the unaligned load will be done in the
+        exception handler or it will just segfault (SSE2 on P4).
+        Why not larger? Because I did not see a difference in benchmarks ...
+     */
+     /* benchmarks with P3
+        memalign(64)+1          3071,3051,3032
+        memalign(64)+2          3051,3032,3041
+        memalign(64)+4          2911,2896,2915
+        memalign(64)+8          2545,2554,2550
+        memalign(64)+16         2543,2572,2563
+        memalign(64)+32         2546,2545,2571
+        memalign(64)+64         2570,2533,2558
 
-	// Get next boundary
-	lorg = l;
-	l = (l + 15) & 0xfffffffffffffff0LL;
-	l += 16;
-	c = (char*)l;
-	backdoor = (uint32_t*)(c - 8);
-	*backdoor = (0xdead << 16) + l - lorg;
-	backdoor[1] = size;
-
-	return c;
+        BTW, malloc seems to do 8-byte alignment by default here.
+     */
+#else
+    ptr = malloc(size);
 #endif
+    return ptr;
 }
 
-void *av_realloc(void *ptr, unsigned int newsize)
+void *av_realloc(void *ptr, unsigned int size)
 {
-#ifdef __APPLE__
-	if (!ptr)
-		return av_malloc(newsize);
+#if CONFIG_MEMALIGN_HACK
+    int diff;
+#endif
 
-	if (!newsize)
-	{
-		av_free(ptr);
-		return NULL;
-	}
+    /* let's disallow possible ambiguous cases */
+    if(size > (INT_MAX-16) )
+        return NULL;
 
-	return realloc(ptr, newsize);
+#if CONFIG_MEMALIGN_HACK
+    //FIXME this isn't aligned correctly, though it probably isn't needed
+    if(!ptr) return av_malloc(size);
+    diff= ((char*)ptr)[-1];
+    return (char*)realloc((char*)ptr - diff, size + diff) + diff;
 #else
-	void *nalloc;
-
-	if (!ptr)
-		return av_malloc(newsize);
-
-	if (!newsize) 
-	{
-		av_free(ptr);
-		return NULL;
-	}
-
-	// now we either shrink them or expand them
-	// in case of shrink, we do nothing
-	// in case of expand we have to copy
-	// Do copy everytime (slower)
-	uint32_t *backdoor;
-	uint32_t size, offset;
-	char *c = (char*)ptr;
-
-	backdoor = (uint32_t*)ptr;
-	backdoor -= 2;
-
-	assert(((*backdoor) >> 16) == 0xdead);
-
-	offset = backdoor[0] & 0xffff;
-	size = backdoor[1];
-
-	if(size >= newsize) // do nothing
-		return ptr;
-
-	// Allocate a new one
-	nalloc = av_malloc(newsize);
-	memcpy(nalloc, ptr, size);
-	av_free(ptr);
-
-	return nalloc;
+    return realloc(ptr, size);
 #endif
 }
 
 void av_free(void *ptr)
 {
-#ifdef __APPLE__
-	if (!ptr)
-		return;
-
-	free(ptr);
+    /* XXX: this test should not be needed on most libcs */
+    if (ptr)
+#if CONFIG_MEMALIGN_HACK
+        free((char*)ptr - ((char*)ptr)[-1]);
 #else
-	uint32_t *backdoor;
-	uint32_t size, offset;
-	char *c = (char*)ptr;
-
-	if (!ptr)
-		return;
-
-	backdoor = (uint32_t*)ptr;
-	backdoor -= 2;
-
-	if (*backdoor == 0xbeefbeef)
-		assert(0);
-
-	assert(((*backdoor) >> 16) == 0xdead);
-
-	offset = backdoor[0] & 0xffff;
-	size = backdoor[1];
-	*backdoor = 0xbeefbeef; // Scratch sig
-
-	free(c - offset);
+        free(ptr);
 #endif
 }
 

Modified: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavutil/mem.h
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavutil/mem.h	2010-05-26 05:26:02 UTC (rev 6231)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavutil/mem.h	2010-05-26 05:26:23 UTC (rev 6232)
@@ -19,21 +19,28 @@
  */
 
 /**
- * @file libavutil/mem.h
+ * @file
  * memory handling functions
  */
 
 #ifndef AVUTIL_MEM_H
 #define AVUTIL_MEM_H
 
-#include "common.h"
+#include "attributes.h"
 
 #if defined(__ICC) || defined(__SUNPRO_C)
-    #define DECLARE_ALIGNED(n,t,v)      t v __attribute__ ((aligned (n)))
+    #define DECLARE_ALIGNED(n,t,v)      t __attribute__ ((aligned (n))) v
     #define DECLARE_ASM_CONST(n,t,v)    const t __attribute__ ((aligned (n))) v
+#elif defined(__TI_COMPILER_VERSION__)
+    #define DECLARE_ALIGNED(n,t,v)                      \
+        AV_PRAGMA(DATA_ALIGN(v,n))                      \
+        t __attribute__((aligned(n))) v
+    #define DECLARE_ASM_CONST(n,t,v)                    \
+        AV_PRAGMA(DATA_ALIGN(v,n))                      \
+        static const t __attribute__((aligned(n))) v
 #elif defined(__GNUC__)
-    #define DECLARE_ALIGNED(n,t,v)      t v __attribute__ ((aligned (n)))
-    #define DECLARE_ASM_CONST(n,t,v)    static const t v attribute_used __attribute__ ((aligned (n)))
+    #define DECLARE_ALIGNED(n,t,v)      t __attribute__ ((aligned (n))) v
+    #define DECLARE_ASM_CONST(n,t,v)    static const t attribute_used __attribute__ ((aligned (n))) v
 #elif defined(_MSC_VER)
     #define DECLARE_ALIGNED(n,t,v)      __declspec(align(n)) t v
     #define DECLARE_ASM_CONST(n,t,v)    __declspec(align(n)) static const t v
@@ -42,7 +49,6 @@
     #define DECLARE_ASM_CONST(n,t,v)    static const t v
 #endif
 
-
 #if AV_GCC_VERSION_AT_LEAST(3,1)
     #define av_malloc_attrib __attribute__((__malloc__))
 #else
@@ -67,7 +73,7 @@
 
 /**
  * Allocates or reallocates a block of memory.
- * If ptr is NULL and size > 0, allocates a new block. If \p
+ * If ptr is NULL and size > 0, allocates a new block. If
  * size is zero, frees the memory block pointed to by ptr.
  * @param size Size in bytes for the memory block to be allocated or
  * reallocated.

Modified: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavutil/pca.c
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavutil/pca.c	2010-05-26 05:26:02 UTC (rev 6231)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavutil/pca.c	2010-05-26 05:26:23 UTC (rev 6232)
@@ -20,7 +20,7 @@
  */
 
 /**
- * @file libavutil/pca.c
+ * @file
  * principal component analysis (PCA)
  */
 

Modified: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavutil/pca.h
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavutil/pca.h	2010-05-26 05:26:02 UTC (rev 6231)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavutil/pca.h	2010-05-26 05:26:23 UTC (rev 6232)
@@ -20,7 +20,7 @@
  */
 
 /**
- * @file libavutil/pca.h
+ * @file
  * principal component analysis (PCA)
  */
 

Added: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavutil/pixdesc.c
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavutil/pixdesc.c	2010-05-26 05:26:02 UTC (rev 6231)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavutil/pixdesc.c	2010-05-26 05:26:23 UTC (rev 6232)
@@ -0,0 +1,840 @@
+/*
+ * pixel format descriptor
+ * Copyright (c) 2009 Michael Niedermayer <michaelni at gmx.at>
+ *
+ * This file is part of FFmpeg.
+ *
+ * FFmpeg is free software; you can redistribute it and/or
+ * modify it under the terms of the GNU Lesser General Public
+ * License as published by the Free Software Foundation; either
+ * version 2.1 of the License, or (at your option) any later version.
+ *
+ * FFmpeg is distributed in the hope that it will be useful,
+ * but WITHOUT ANY WARRANTY; without even the implied warranty of
+ * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ * Lesser General Public License for more details.
+ *
+ * You should have received a copy of the GNU Lesser General Public
+ * License along with FFmpeg; if not, write to the Free Software
+ * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA
+ */
+
+#include "pixfmt.h"
+#include "pixdesc.h"
+
+#include "intreadwrite.h"
+
+void read_line(uint16_t *dst, const uint8_t *data[4], const int linesize[4],
+               const AVPixFmtDescriptor *desc, int x, int y, int c, int w, int read_pal_component)
+{
+    AVComponentDescriptor comp= desc->comp[c];
+    int plane= comp.plane;
+    int depth= comp.depth_minus1+1;
+    int mask = (1<<depth)-1;
+    int shift= comp.shift;
+    int step = comp.step_minus1+1;
+    int flags= desc->flags;
+
+    if (flags & PIX_FMT_BITSTREAM){
+        int skip = x*step + comp.offset_plus1-1;
+        const uint8_t *p = data[plane] + y*linesize[plane] + (skip>>3);
+        int shift = 8 - depth - (skip&7);
+
+        while(w--){
+            int val = (*p >> shift) & mask;
+            if(read_pal_component)
+                val= data[1][4*val + c];
+            shift -= step;
+            p -= shift>>3;
+            shift &= 7;
+            *dst++= val;
+        }
+    } else {
+        const uint8_t *p = data[plane]+ y*linesize[plane] + x*step + comp.offset_plus1-1;
+
+        while(w--){
+            int val;
+            if(flags & PIX_FMT_BE) val= AV_RB16(p);
+            else                   val= AV_RL16(p);
+            val = (val>>shift) & mask;
+            if(read_pal_component)
+                val= data[1][4*val + c];
+            p+= step;
+            *dst++= val;
+        }
+    }
+}
+
+void write_line(const uint16_t *src, uint8_t *data[4], const int linesize[4],
+                const AVPixFmtDescriptor *desc, int x, int y, int c, int w)
+{
+    AVComponentDescriptor comp = desc->comp[c];
+    int plane = comp.plane;
+    int depth = comp.depth_minus1+1;
+    int step  = comp.step_minus1+1;
+    int flags = desc->flags;
+
+    if (flags & PIX_FMT_BITSTREAM) {
+        int skip = x*step + comp.offset_plus1-1;
+        uint8_t *p = data[plane] + y*linesize[plane] + (skip>>3);
+        int shift = 8 - depth - (skip&7);
+
+        while (w--) {
+            *p |= *src++ << shift;
+            shift -= step;
+            p -= shift>>3;
+            shift &= 7;
+        }
+    } else {
+        int shift = comp.shift;
+        uint8_t *p = data[plane]+ y*linesize[plane] + x*step + comp.offset_plus1-1;
+
+        while (w--) {
+            if (flags & PIX_FMT_BE) {
+                uint16_t val = AV_RB16(p) | (*src++<<shift);
+                AV_WB16(p, val);
+            } else {
+                uint16_t val = AV_RL16(p) | (*src++<<shift);
+                AV_WL16(p, val);
+            }
+            p+= step;
+        }
+    }
+}
+
+const AVPixFmtDescriptor av_pix_fmt_descriptors[PIX_FMT_NB] = {
+    [PIX_FMT_YUV420P] = {
+        .name = "yuv420p",
+        .nb_components= 3,
+        .log2_chroma_w= 1,
+        .log2_chroma_h= 1,
+        .comp = {
+            {0,0,1,0,7},        /* Y */
+            {1,0,1,0,7},        /* U */
+            {2,0,1,0,7},        /* V */
+        },
+    },
+    [PIX_FMT_YUYV422] = {
+        .name = "yuyv422",
+        .nb_components= 3,
+        .log2_chroma_w= 1,
+        .log2_chroma_h= 0,
+        .comp = {
+            {0,1,1,0,7},        /* Y */
+            {0,3,2,0,7},        /* U */
+            {0,3,4,0,7},        /* V */
+        },
+    },
+    [PIX_FMT_RGB24] = {
+        .name = "rgb24",
+        .nb_components= 3,
+        .log2_chroma_w= 0,
+        .log2_chroma_h= 0,
+        .comp = {
+            {0,2,1,0,7},        /* R */
+            {0,2,2,0,7},        /* G */
+            {0,2,3,0,7},        /* B */
+        },
+    },
+    [PIX_FMT_BGR24] = {
+        .name = "bgr24",
+        .nb_components= 3,
+        .log2_chroma_w= 0,
+        .log2_chroma_h= 0,
+        .comp = {
+            {0,2,1,0,7},        /* B */
+            {0,2,2,0,7},        /* G */
+            {0,2,3,0,7},        /* R */
+        },
+    },
+    [PIX_FMT_YUV422P] = {
+        .name = "yuv422p",
+        .nb_components= 3,
+        .log2_chroma_w= 1,
+        .log2_chroma_h= 0,
+        .comp = {
+            {0,0,1,0,7},        /* Y */
+            {1,0,1,0,7},        /* U */
+            {2,0,1,0,7},        /* V */
+        },
+    },
+    [PIX_FMT_YUV444P] = {
+        .name = "yuv444p",
+        .nb_components= 3,
+        .log2_chroma_w= 0,
+        .log2_chroma_h= 0,
+        .comp = {
+            {0,0,1,0,7},        /* Y */
+            {1,0,1,0,7},        /* U */
+            {2,0,1,0,7},        /* V */
+        },
+    },
+    [PIX_FMT_YUV410P] = {
+        .name = "yuv410p",
+        .nb_components= 3,
+        .log2_chroma_w= 2,
+        .log2_chroma_h= 2,
+        .comp = {
+            {0,0,1,0,7},        /* Y */
+            {1,0,1,0,7},        /* U */
+            {2,0,1,0,7},        /* V */
+        },
+    },
+    [PIX_FMT_YUV411P] = {
+        .name = "yuv411p",
+        .nb_components= 3,
+        .log2_chroma_w= 2,
+        .log2_chroma_h= 0,
+        .comp = {
+            {0,0,1,0,7},        /* Y */
+            {1,0,1,0,7},        /* U */
+            {2,0,1,0,7},        /* V */
+        },
+    },
+    [PIX_FMT_GRAY8] = {
+        .name = "gray",
+        .nb_components= 1,
+        .log2_chroma_w= 0,
+        .log2_chroma_h= 0,
+        .comp = {
+            {0,0,1,0,7},        /* Y */
+        },
+        .flags = PIX_FMT_PAL,
+    },
+    [PIX_FMT_MONOWHITE] = {
+        .name = "monow",
+        .nb_components= 1,
+        .log2_chroma_w= 0,
+        .log2_chroma_h= 0,
+        .comp = {
+            {0,0,1,0,0},        /* Y */
+        },
+        .flags = PIX_FMT_BITSTREAM,
+    },
+    [PIX_FMT_MONOBLACK] = {
+        .name = "monob",
+        .nb_components= 1,
+        .log2_chroma_w= 0,
+        .log2_chroma_h= 0,
+        .comp = {
+            {0,0,1,7,0},        /* Y */
+        },
+        .flags = PIX_FMT_BITSTREAM,
+    },
+    [PIX_FMT_PAL8] = {
+        .name = "pal8",
+        .nb_components= 1,
+        .log2_chroma_w= 0,
+        .log2_chroma_h= 0,
+        .comp = {
+            {0,0,1,0,7},
+        },
+        .flags = PIX_FMT_PAL,
+    },
+    [PIX_FMT_YUVJ420P] = {
+        .name = "yuvj420p",
+        .nb_components= 3,
+        .log2_chroma_w= 1,
+        .log2_chroma_h= 1,
+        .comp = {
+            {0,0,1,0,7},        /* Y */
+            {1,0,1,0,7},        /* U */
+            {2,0,1,0,7},        /* V */
+        },
+    },
+    [PIX_FMT_YUVJ422P] = {
+        .name = "yuvj422p",
+        .nb_components= 3,
+        .log2_chroma_w= 1,
+        .log2_chroma_h= 0,
+        .comp = {
+            {0,0,1,0,7},        /* Y */
+            {1,0,1,0,7},        /* U */
+            {2,0,1,0,7},        /* V */
+        },
+    },
+    [PIX_FMT_YUVJ444P] = {
+        .name = "yuvj444p",
+        .nb_components= 3,
+        .log2_chroma_w= 0,
+        .log2_chroma_h= 0,
+        .comp = {
+            {0,0,1,0,7},        /* Y */
+            {1,0,1,0,7},        /* U */
+            {2,0,1,0,7},        /* V */
+        },
+    },
+    [PIX_FMT_XVMC_MPEG2_MC] = {
+        .name = "xvmcmc",
+        .flags = PIX_FMT_HWACCEL,
+    },
+    [PIX_FMT_XVMC_MPEG2_IDCT] = {
+        .name = "xvmcidct",
+        .flags = PIX_FMT_HWACCEL,
+    },
+    [PIX_FMT_UYVY422] = {
+        .name = "uyvy422",
+        .nb_components= 3,
+        .log2_chroma_w= 1,
+        .log2_chroma_h= 0,
+        .comp = {
+            {0,1,2,0,7},        /* Y */
+            {0,3,1,0,7},        /* U */
+            {0,3,3,0,7},        /* V */
+        },
+    },
+    [PIX_FMT_UYYVYY411] = {
+        .name = "uyyvyy411",
+        .nb_components= 3,
+        .log2_chroma_w= 2,
+        .log2_chroma_h= 0,
+        .comp = {
+            {0,3,2,0,7},        /* Y */
+            {0,5,1,0,7},        /* U */
+            {0,5,4,0,7},        /* V */
+        },
+    },
+    [PIX_FMT_BGR8] = {
+        .name = "bgr8",
+        .nb_components= 3,
+        .log2_chroma_w= 0,
+        .log2_chroma_h= 0,
+        .comp = {
+            {0,0,1,6,1},        /* B */
+            {0,0,1,3,2},        /* G */
+            {0,0,1,0,2},        /* R */
+        },
+        .flags = PIX_FMT_PAL,
+    },
+    [PIX_FMT_BGR4] = {
+        .name = "bgr4",
+        .nb_components= 3,
+        .log2_chroma_w= 0,
+        .log2_chroma_h= 0,
+        .comp = {
+            {0,3,1,0,0},        /* B */
+            {0,3,2,0,1},        /* G */
+            {0,3,4,0,0},        /* R */
+        },
+        .flags = PIX_FMT_BITSTREAM,
+    },
+    [PIX_FMT_BGR4_BYTE] = {
+        .name = "bgr4_byte",
+        .nb_components= 3,
+        .log2_chroma_w= 0,
+        .log2_chroma_h= 0,
+        .comp = {
+            {0,0,1,3,0},        /* B */
+            {0,0,1,1,1},        /* G */
+            {0,0,1,0,0},        /* R */
+        },
+        .flags = PIX_FMT_PAL,
+    },
+    [PIX_FMT_RGB8] = {
+        .name = "rgb8",
+        .nb_components= 3,
+        .log2_chroma_w= 0,
+        .log2_chroma_h= 0,
+        .comp = {
+            {0,0,1,6,1},        /* R */
+            {0,0,1,3,2},        /* G */
+            {0,0,1,0,2},        /* B */
+        },
+        .flags = PIX_FMT_PAL,
+    },
+    [PIX_FMT_RGB4] = {
+        .name = "rgb4",
+        .nb_components= 3,
+        .log2_chroma_w= 0,
+        .log2_chroma_h= 0,
+        .comp = {
+            {0,3,1,0,0},       /* R */
+            {0,3,2,0,1},       /* G */
+            {0,3,4,0,0},       /* B */
+        },
+        .flags = PIX_FMT_BITSTREAM,
+    },
+    [PIX_FMT_RGB4_BYTE] = {
+        .name = "rgb4_byte",
+        .nb_components= 3,
+        .log2_chroma_w= 0,
+        .log2_chroma_h= 0,
+        .comp = {
+            {0,0,1,3,0},        /* R */
+            {0,0,1,1,1},        /* G */
+            {0,0,1,0,0},        /* B */
+        },
+        .flags = PIX_FMT_PAL,
+    },
+    [PIX_FMT_NV12] = {
+        .name = "nv12",
+        .nb_components= 3,
+        .log2_chroma_w= 1,
+        .log2_chroma_h= 1,
+        .comp = {
+            {0,0,1,0,7},        /* Y */
+            {1,1,1,0,7},        /* U */
+            {1,1,2,0,7},        /* V */
+        },
+    },
+    [PIX_FMT_NV21] = {
+        .name = "nv21",
+        .nb_components= 3,
+        .log2_chroma_w= 1,
+        .log2_chroma_h= 1,
+        .comp = {
+            {0,0,1,0,7},        /* Y */
+            {1,1,1,0,7},        /* V */
+            {1,1,2,0,7},        /* U */
+        },
+    },
+    [PIX_FMT_ARGB] = {
+        .name = "argb",
+        .nb_components= 4,
+        .log2_chroma_w= 0,
+        .log2_chroma_h= 0,
+        .comp = {
+            {0,3,1,0,7},        /* A */
+            {0,3,2,0,7},        /* R */
+            {0,3,3,0,7},        /* G */
+            {0,3,4,0,7},        /* B */
+        },
+    },
+    [PIX_FMT_RGBA] = {
+        .name = "rgba",
+        .nb_components= 4,
+        .log2_chroma_w= 0,
+        .log2_chroma_h= 0,
+        .comp = {
+            {0,3,1,0,7},        /* R */
+            {0,3,2,0,7},        /* G */
+            {0,3,3,0,7},        /* B */
+            {0,3,4,0,7},        /* A */
+        },
+    },
+    [PIX_FMT_ABGR] = {
+        .name = "abgr",
+        .nb_components= 4,
+        .log2_chroma_w= 0,
+        .log2_chroma_h= 0,
+        .comp = {
+            {0,3,1,0,7},        /* A */
+            {0,3,2,0,7},        /* B */
+            {0,3,3,0,7},        /* G */
+            {0,3,4,0,7},        /* R */
+        },
+    },
+    [PIX_FMT_BGRA] = {
+        .name = "bgra",
+        .nb_components= 4,
+        .log2_chroma_w= 0,
+        .log2_chroma_h= 0,
+        .comp = {
+            {0,3,1,0,7},        /* B */
+            {0,3,2,0,7},        /* G */
+            {0,3,3,0,7},        /* R */
+            {0,3,4,0,7},        /* A */
+        },
+    },
+    [PIX_FMT_GRAY16BE] = {
+        .name = "gray16be",
+        .nb_components= 1,
+        .log2_chroma_w= 0,
+        .log2_chroma_h= 0,
+        .comp = {
+            {0,1,1,0,15},       /* Y */
+        },
+        .flags = PIX_FMT_BE,
+    },
+    [PIX_FMT_GRAY16LE] = {
+        .name = "gray16le",
+        .nb_components= 1,
+        .log2_chroma_w= 0,
+        .log2_chroma_h= 0,
+        .comp = {
+            {0,1,1,0,15},       /* Y */
+        },
+    },
+    [PIX_FMT_YUV440P] = {
+        .name = "yuv440p",
+        .nb_components= 3,
+        .log2_chroma_w= 0,
+        .log2_chroma_h= 1,
+        .comp = {
+            {0,0,1,0,7},        /* Y */
+            {1,0,1,0,7},        /* U */
+            {2,0,1,0,7},        /* V */
+        },
+    },
+    [PIX_FMT_YUVJ440P] = {
+        .name = "yuvj440p",
+        .nb_components= 3,
+        .log2_chroma_w= 0,
+        .log2_chroma_h= 1,
+        .comp = {
+            {0,0,1,0,7},        /* Y */
+            {1,0,1,0,7},        /* U */
+            {2,0,1,0,7},        /* V */
+        },
+    },
+    [PIX_FMT_YUVA420P] = {
+        .name = "yuva420p",
+        .nb_components= 4,
+        .log2_chroma_w= 1,
+        .log2_chroma_h= 1,
+        .comp = {
+            {0,0,1,0,7},        /* Y */
+            {1,0,1,0,7},        /* U */
+            {2,0,1,0,7},        /* V */
+            {3,0,1,0,7},        /* A */
+        },
+    },
+    [PIX_FMT_VDPAU_H264] = {
+        .name = "vdpau_h264",
+        .log2_chroma_w = 1,
+        .log2_chroma_h = 1,
+        .flags = PIX_FMT_HWACCEL,
+    },
+    [PIX_FMT_VDPAU_MPEG1] = {
+        .name = "vdpau_mpeg1",
+        .log2_chroma_w = 1,
+        .log2_chroma_h = 1,
+        .flags = PIX_FMT_HWACCEL,
+    },
+    [PIX_FMT_VDPAU_MPEG2] = {
+        .name = "vdpau_mpeg2",
+        .log2_chroma_w = 1,
+        .log2_chroma_h = 1,
+        .flags = PIX_FMT_HWACCEL,
+    },
+    [PIX_FMT_VDPAU_WMV3] = {
+        .name = "vdpau_wmv3",
+        .log2_chroma_w = 1,
+        .log2_chroma_h = 1,
+        .flags = PIX_FMT_HWACCEL,
+    },
+    [PIX_FMT_VDPAU_VC1] = {
+        .name = "vdpau_vc1",
+        .log2_chroma_w = 1,
+        .log2_chroma_h = 1,
+        .flags = PIX_FMT_HWACCEL,
+    },
+    [PIX_FMT_VDPAU_MPEG4] = {
+        .name = "vdpau_mpeg4",
+        .log2_chroma_w = 1,
+        .log2_chroma_h = 1,
+        .flags = PIX_FMT_HWACCEL,
+    },
+    [PIX_FMT_RGB48BE] = {
+        .name = "rgb48be",
+        .nb_components= 3,
+        .log2_chroma_w= 0,
+        .log2_chroma_h= 0,
+        .comp = {
+            {0,5,1,0,15},       /* R */
+            {0,5,3,0,15},       /* G */
+            {0,5,5,0,15},       /* B */
+        },
+        .flags = PIX_FMT_BE,
+    },
+    [PIX_FMT_RGB48LE] = {
+        .name = "rgb48le",
+        .nb_components= 3,
+        .log2_chroma_w= 0,
+        .log2_chroma_h= 0,
+        .comp = {
+            {0,5,1,0,15},       /* R */
+            {0,5,3,0,15},       /* G */
+            {0,5,5,0,15},       /* B */
+        },
+    },
+    [PIX_FMT_RGB565BE] = {
+        .name = "rgb565be",
+        .nb_components= 3,
+        .log2_chroma_w= 0,
+        .log2_chroma_h= 0,
+        .comp = {
+            {0,1,0,3,4},        /* R */
+            {0,1,1,5,5},        /* G */
+            {0,1,1,0,4},        /* B */
+        },
+        .flags = PIX_FMT_BE,
+    },
+    [PIX_FMT_RGB565LE] = {
+        .name = "rgb565le",
+        .nb_components= 3,
+        .log2_chroma_w= 0,
+        .log2_chroma_h= 0,
+        .comp = {
+            {0,1,2,3,4},        /* R */
+            {0,1,1,5,5},        /* G */
+            {0,1,1,0,4},        /* B */
+        },
+    },
+    [PIX_FMT_RGB555BE] = {
+        .name = "rgb555be",
+        .nb_components= 3,
+        .log2_chroma_w= 0,
+        .log2_chroma_h= 0,
+        .comp = {
+            {0,1,0,2,4},        /* R */
+            {0,1,1,5,4},        /* G */
+            {0,1,1,0,4},        /* B */
+        },
+        .flags = PIX_FMT_BE,
+    },
+    [PIX_FMT_RGB555LE] = {
+        .name = "rgb555le",
+        .nb_components= 3,
+        .log2_chroma_w= 0,
+        .log2_chroma_h= 0,
+        .comp = {
+            {0,1,2,2,4},        /* R */
+            {0,1,1,5,4},        /* G */
+            {0,1,1,0,4},        /* B */
+        },
+    },
+    [PIX_FMT_RGB444BE] = {
+        .name = "rgb444be",
+        .nb_components= 3,
+        .log2_chroma_w= 0,
+        .log2_chroma_h= 0,
+        .comp = {
+            {0,1,0,0,3},        /* R */
+            {0,1,1,4,3},        /* G */
+            {0,1,1,0,3},        /* B */
+        },
+        .flags = PIX_FMT_BE,
+    },
+    [PIX_FMT_RGB444LE] = {
+        .name = "rgb444le",
+        .nb_components= 3,
+        .log2_chroma_w= 0,
+        .log2_chroma_h= 0,
+        .comp = {
+            {0,1,2,0,3},        /* R */
+            {0,1,1,4,3},        /* G */
+            {0,1,1,0,3},        /* B */
+        },
+    },
+    [PIX_FMT_BGR565BE] = {
+        .name = "bgr565be",
+        .nb_components= 3,
+        .log2_chroma_w= 0,
+        .log2_chroma_h= 0,
+        .comp = {
+            {0,1,0,3,4},        /* B */
+            {0,1,1,5,5},        /* G */
+            {0,1,1,0,4},        /* R */
+        },
+        .flags = PIX_FMT_BE,
+    },
+    [PIX_FMT_BGR565LE] = {
+        .name = "bgr565le",
+        .nb_components= 3,
+        .log2_chroma_w= 0,
+        .log2_chroma_h= 0,
+        .comp = {
+            {0,1,2,3,4},        /* B */
+            {0,1,1,5,5},        /* G */
+            {0,1,1,0,4},        /* R */
+        },
+    },
+    [PIX_FMT_BGR555BE] = {
+        .name = "bgr555be",
+        .nb_components= 3,
+        .log2_chroma_w= 0,
+        .log2_chroma_h= 0,
+        .comp = {
+            {0,1,0,2,4},       /* B */
+            {0,1,1,5,4},       /* G */
+            {0,1,1,0,4},       /* R */
+        },
+        .flags = PIX_FMT_BE,
+     },
+    [PIX_FMT_BGR555LE] = {
+        .name = "bgr555le",
+        .nb_components= 3,
+        .log2_chroma_w= 0,
+        .log2_chroma_h= 0,
+        .comp = {
+            {0,1,2,2,4},        /* B */
+            {0,1,1,5,4},        /* G */
+            {0,1,1,0,4},        /* R */
+        },
+    },
+    [PIX_FMT_BGR444BE] = {
+        .name = "bgr444be",
+        .nb_components= 3,
+        .log2_chroma_w= 0,
+        .log2_chroma_h= 0,
+        .comp = {
+            {0,1,0,0,3},       /* B */
+            {0,1,1,4,3},       /* G */
+            {0,1,1,0,3},       /* R */
+        },
+        .flags = PIX_FMT_BE,
+     },
+    [PIX_FMT_BGR444LE] = {
+        .name = "bgr444le",
+        .nb_components= 3,
+        .log2_chroma_w= 0,
+        .log2_chroma_h= 0,
+        .comp = {
+            {0,1,2,0,3},        /* B */
+            {0,1,1,4,3},        /* G */
+            {0,1,1,0,3},        /* R */
+        },
+    },
+    [PIX_FMT_VAAPI_MOCO] = {
+        .name = "vaapi_moco",
+        .log2_chroma_w = 1,
+        .log2_chroma_h = 1,
+        .flags = PIX_FMT_HWACCEL,
+    },
+    [PIX_FMT_VAAPI_IDCT] = {
+        .name = "vaapi_idct",
+        .log2_chroma_w = 1,
+        .log2_chroma_h = 1,
+        .flags = PIX_FMT_HWACCEL,
+    },
+    [PIX_FMT_VAAPI_VLD] = {
+        .name = "vaapi_vld",
+        .log2_chroma_w = 1,
+        .log2_chroma_h = 1,
+        .flags = PIX_FMT_HWACCEL,
+    },
+    [PIX_FMT_YUV420P16LE] = {
+        .name = "yuv420p16le",
+        .nb_components= 3,
+        .log2_chroma_w= 1,
+        .log2_chroma_h= 1,
+        .comp = {
+            {0,1,1,0,15},        /* Y */
+            {1,1,1,0,15},        /* U */
+            {2,1,1,0,15},        /* V */
+        },
+    },
+    [PIX_FMT_YUV420P16BE] = {
+        .name = "yuv420p16be",
+        .nb_components= 3,
+        .log2_chroma_w= 1,
+        .log2_chroma_h= 1,
+        .comp = {
+            {0,1,1,0,15},        /* Y */
+            {1,1,1,0,15},        /* U */
+            {2,1,1,0,15},        /* V */
+        },
+        .flags = PIX_FMT_BE,
+    },
+    [PIX_FMT_YUV422P16LE] = {
+        .name = "yuv422p16le",
+        .nb_components= 3,
+        .log2_chroma_w= 1,
+        .log2_chroma_h= 0,
+        .comp = {
+            {0,1,1,0,15},        /* Y */
+            {1,1,1,0,15},        /* U */
+            {2,1,1,0,15},        /* V */
+        },
+    },
+    [PIX_FMT_YUV422P16BE] = {
+        .name = "yuv422p16be",
+        .nb_components= 3,
+        .log2_chroma_w= 1,
+        .log2_chroma_h= 0,
+        .comp = {
+            {0,1,1,0,15},        /* Y */
+            {1,1,1,0,15},        /* U */
+            {2,1,1,0,15},        /* V */
+        },
+        .flags = PIX_FMT_BE,
+    },
+    [PIX_FMT_YUV444P16LE] = {
+        .name = "yuv444p16le",
+        .nb_components= 3,
+        .log2_chroma_w= 0,
+        .log2_chroma_h= 0,
+        .comp = {
+            {0,1,1,0,15},        /* Y */
+            {1,1,1,0,15},        /* U */
+            {2,1,1,0,15},        /* V */
+        },
+    },
+    [PIX_FMT_YUV444P16BE] = {
+        .name = "yuv444p16be",
+        .nb_components= 3,
+        .log2_chroma_w= 0,
+        .log2_chroma_h= 0,
+        .comp = {
+            {0,1,1,0,15},        /* Y */
+            {1,1,1,0,15},        /* U */
+            {2,1,1,0,15},        /* V */
+        },
+        .flags = PIX_FMT_BE,
+    },
+    [PIX_FMT_DXVA2_VLD] = {
+        .name = "dxva2_vld",
+        .log2_chroma_w = 1,
+        .log2_chroma_h = 1,
+        .flags = PIX_FMT_HWACCEL,
+    },
+    [PIX_FMT_Y400A] = {
+        .name = "y400a",
+        .nb_components= 2,
+        .comp = {
+            {0,1,1,0,7},        /* Y */
+            {0,1,2,0,7},        /* A */
+        },
+    },
+};
+
+static enum PixelFormat get_pix_fmt_internal(const char *name)
+{
+    enum PixelFormat pix_fmt;
+
+    for (pix_fmt = 0; pix_fmt < PIX_FMT_NB; pix_fmt++)
+        if (av_pix_fmt_descriptors[pix_fmt].name &&
+            !strcmp(av_pix_fmt_descriptors[pix_fmt].name, name))
+            return pix_fmt;
+
+    return PIX_FMT_NONE;
+}
+
+#if HAVE_BIGENDIAN
+#   define X_NE(be, le) be
+#else
+#   define X_NE(be, le) le
+#endif
+
+enum PixelFormat av_get_pix_fmt(const char *name)
+{
+    enum PixelFormat pix_fmt;
+
+    if (!strcmp(name, "rgb32"))
+        name = X_NE("argb", "bgra");
+    else if (!strcmp(name, "bgr32"))
+        name = X_NE("abgr", "rgba");
+
+    pix_fmt = get_pix_fmt_internal(name);
+    if (pix_fmt == PIX_FMT_NONE) {
+        char name2[32];
+
+        snprintf(name2, sizeof(name2), "%s%s", name, X_NE("be", "le"));
+        pix_fmt = get_pix_fmt_internal(name2);
+    }
+    return pix_fmt;
+}
+
+int av_get_bits_per_pixel(const AVPixFmtDescriptor *pixdesc)
+{
+    int c, bits = 0;
+    int log2_pixels = pixdesc->log2_chroma_w + pixdesc->log2_chroma_h;
+
+    for (c = 0; c < pixdesc->nb_components; c++) {
+        int s = c==1 || c==2 ? 0 : log2_pixels;
+        bits += (pixdesc->comp[c].depth_minus1+1) << s;
+    }
+
+    return bits >> log2_pixels;
+}

Added: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavutil/pixdesc.h
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavutil/pixdesc.h	2010-05-26 05:26:02 UTC (rev 6231)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavutil/pixdesc.h	2010-05-26 05:26:23 UTC (rev 6232)
@@ -0,0 +1,154 @@
+/*
+ * pixel format descriptor
+ * Copyright (c) 2009 Michael Niedermayer <michaelni at gmx.at>
+ *
+ * This file is part of FFmpeg.
+ *
+ * FFmpeg is free software; you can redistribute it and/or
+ * modify it under the terms of the GNU Lesser General Public
+ * License as published by the Free Software Foundation; either
+ * version 2.1 of the License, or (at your option) any later version.
+ *
+ * FFmpeg is distributed in the hope that it will be useful,
+ * but WITHOUT ANY WARRANTY; without even the implied warranty of
+ * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ * Lesser General Public License for more details.
+ *
+ * You should have received a copy of the GNU Lesser General Public
+ * License along with FFmpeg; if not, write to the Free Software
+ * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA
+ */
+
+#ifndef AVUTIL_PIXDESC_H
+#define AVUTIL_PIXDESC_H
+
+#include <inttypes.h>
+
+typedef struct AVComponentDescriptor{
+    uint16_t plane        :2;            ///< which of the 4 planes contains the component
+
+    /**
+     * Number of elements between 2 horizontally consecutive pixels minus 1.
+     * Elements are bits for bitstream formats, bytes otherwise.
+     */
+    uint16_t step_minus1  :3;
+
+    /**
+     * Number of elements before the component of the first pixel plus 1.
+     * Elements are bits for bitstream formats, bytes otherwise.
+     */
+    uint16_t offset_plus1 :3;
+    uint16_t shift        :3;            ///< number of least significant bits that must be shifted away to get the value
+    uint16_t depth_minus1 :4;            ///< number of bits in the component minus 1
+}AVComponentDescriptor;
+
+/**
+ * Descriptor that unambiguously describes how the bits of a pixel are
+ * stored in the up to 4 data planes of an image. It also stores the
+ * subsampling factors and number of components.
+ *
+ * @note This is separate of the colorspace (RGB, YCbCr, YPbPr, JPEG-style YUV
+ *       and all the YUV variants) AVPixFmtDescriptor just stores how values
+ *       are stored not what these values represent.
+ */
+typedef struct AVPixFmtDescriptor{
+    const char *name;
+    uint8_t nb_components;      ///< The number of components each pixel has, (1-4)
+
+    /**
+     * Amount to shift the luma width right to find the chroma width.
+     * For YV12 this is 1 for example.
+     * chroma_width = -((-luma_width) >> log2_chroma_w)
+     * The note above is needed to ensure rounding up.
+     * This value only refers to the chroma components.
+     */
+    uint8_t log2_chroma_w;      ///< chroma_width = -((-luma_width )>>log2_chroma_w)
+
+    /**
+     * Amount to shift the luma height right to find the chroma height.
+     * For YV12 this is 1 for example.
+     * chroma_height= -((-luma_height) >> log2_chroma_h)
+     * The note above is needed to ensure rounding up.
+     * This value only refers to the chroma components.
+     */
+    uint8_t log2_chroma_h;
+    uint8_t flags;
+
+    /**
+     * Parameters that describe how pixels are packed. If the format
+     * has chroma components, they must be stored in comp[1] and
+     * comp[2].
+     */
+    AVComponentDescriptor comp[4];
+}AVPixFmtDescriptor;
+
+#define PIX_FMT_BE        1 ///< Pixel format is big-endian.
+#define PIX_FMT_PAL       2 ///< Pixel format has a palette in data[1], values are indexes in this palette.
+#define PIX_FMT_BITSTREAM 4 ///< All values of a component are bit-wise packed end to end.
+#define PIX_FMT_HWACCEL   8 ///< Pixel format is an HW accelerated format.
+
+/**
+ * The array of all the pixel format descriptors.
+ */
+extern const AVPixFmtDescriptor av_pix_fmt_descriptors[];
+
+/**
+ * Reads a line from an image, and writes the values of the
+ * pixel format component c to dst.
+ *
+ * @param data the array containing the pointers to the planes of the image
+ * @param linesizes the array containing the linesizes of the image
+ * @param desc the pixel format descriptor for the image
+ * @param x the horizontal coordinate of the first pixel to read
+ * @param y the vertical coordinate of the first pixel to read
+ * @param w the width of the line to read, that is the number of
+ * values to write to dst
+ * @param read_pal_component if not zero and the format is a paletted
+ * format writes the values corresponding to the palette
+ * component c in data[1] to dst, rather than the palette indexes in
+ * data[0]. The behavior is undefined if the format is not paletted.
+ */
+void read_line(uint16_t *dst, const uint8_t *data[4], const int linesize[4],
+               const AVPixFmtDescriptor *desc, int x, int y, int c, int w, int read_pal_component);
+
+/**
+ * Writes the values from src to the pixel format component c of an
+ * image line.
+ *
+ * @param src array containing the values to write
+ * @param data the array containing the pointers to the planes of the
+ * image to write into. It is supposed to be zeroed.
+ * @param linesizes the array containing the linesizes of the image
+ * @param desc the pixel format descriptor for the image
+ * @param x the horizontal coordinate of the first pixel to write
+ * @param y the vertical coordinate of the first pixel to write
+ * @param w the width of the line to write, that is the number of
+ * values to write to the image line
+ */
+void write_line(const uint16_t *src, uint8_t *data[4], const int linesize[4],
+                const AVPixFmtDescriptor *desc, int x, int y, int c, int w);
+
+/**
+ * Returns the pixel format corresponding to name.
+ *
+ * If there is no pixel format with name name, then looks for a
+ * pixel format with the name corresponding to the native endian
+ * format of name.
+ * For example in a little-endian system, first looks for "gray16",
+ * then for "gray16le".
+ *
+ * Finally if no pixel format has been found, returns PIX_FMT_NONE.
+ */
+enum PixelFormat av_get_pix_fmt(const char *name);
+
+/**
+ * Returns the number of bits per pixel used by the pixel format
+ * described by pixdesc.
+ *
+ * The returned number of bits refers to the number of bits actually
+ * used for storing the pixel information, that is padding bits are
+ * not counted.
+ */
+int av_get_bits_per_pixel(const AVPixFmtDescriptor *pixdesc);
+
+#endif /* AVUTIL_PIXDESC_H */

Modified: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavutil/pixfmt.h
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavutil/pixfmt.h	2010-05-26 05:26:02 UTC (rev 6231)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavutil/pixfmt.h	2010-05-26 05:26:23 UTC (rev 6232)
@@ -22,13 +22,15 @@
 #define AVUTIL_PIXFMT_H
 
 /**
- * @file libavutil/pixfmt.h
+ * @file
  * pixel format definitions
  *
  * @warning This file has to be considered an internal but installed
  * header, so it should not be directly included in your projects.
  */
 
+#include "libavutil/avconfig.h"
+
 /**
  * Pixel format. Notes:
  *
@@ -66,8 +68,8 @@
     PIX_FMT_YUV410P,   ///< planar YUV 4:1:0,  9bpp, (1 Cr & Cb sample per 4x4 Y samples)
     PIX_FMT_YUV411P,   ///< planar YUV 4:1:1, 12bpp, (1 Cr & Cb sample per 4x1 Y samples)
     PIX_FMT_GRAY8,     ///<        Y        ,  8bpp
-    PIX_FMT_MONOWHITE, ///<        Y        ,  1bpp, 0 is white, 1 is black
-    PIX_FMT_MONOBLACK, ///<        Y        ,  1bpp, 0 is black, 1 is white
+    PIX_FMT_MONOWHITE, ///<        Y        ,  1bpp, 0 is white, 1 is black, in each byte pixels are ordered from the msb to the lsb
+    PIX_FMT_MONOBLACK, ///<        Y        ,  1bpp, 0 is black, 1 is white, in each byte pixels are ordered from the msb to the lsb
     PIX_FMT_PAL8,      ///< 8 bit with PIX_FMT_RGB32 palette
     PIX_FMT_YUVJ420P,  ///< planar YUV 4:2:0, 12bpp, full scale (JPEG)
     PIX_FMT_YUVJ422P,  ///< planar YUV 4:2:2, 16bpp, full scale (JPEG)
@@ -77,12 +79,12 @@
     PIX_FMT_UYVY422,   ///< packed YUV 4:2:2, 16bpp, Cb Y0 Cr Y1
     PIX_FMT_UYYVYY411, ///< packed YUV 4:1:1, 12bpp, Cb Y0 Y1 Cr Y2 Y3
     PIX_FMT_BGR8,      ///< packed RGB 3:3:2,  8bpp, (msb)2B 3G 3R(lsb)
-    PIX_FMT_BGR4,      ///< packed RGB 1:2:1,  4bpp, (msb)1B 2G 1R(lsb)
+    PIX_FMT_BGR4,      ///< packed RGB 1:2:1 bitstream,  4bpp, (msb)1B 2G 1R(lsb), a byte contains two pixels, the first pixel in the byte is the one composed by the 4 msb bits
     PIX_FMT_BGR4_BYTE, ///< packed RGB 1:2:1,  8bpp, (msb)1B 2G 1R(lsb)
     PIX_FMT_RGB8,      ///< packed RGB 3:3:2,  8bpp, (msb)2R 3G 3B(lsb)
-    PIX_FMT_RGB4,      ///< packed RGB 1:2:1,  4bpp, (msb)1R 2G 1B(lsb)
+    PIX_FMT_RGB4,      ///< packed RGB 1:2:1 bitstream,  4bpp, (msb)1R 2G 1B(lsb), a byte contains two pixels, the first pixel in the byte is the one composed by the 4 msb bits
     PIX_FMT_RGB4_BYTE, ///< packed RGB 1:2:1,  8bpp, (msb)1R 2G 1B(lsb)
-    PIX_FMT_NV12,      ///< planar YUV 4:2:0, 12bpp, 1 plane for Y and 1 for UV
+    PIX_FMT_NV12,      ///< planar YUV 4:2:0, 12bpp, 1 plane for Y and 1 plane for the UV components, which are interleaved (first byte U and the following byte V)
     PIX_FMT_NV21,      ///< as above, but U and V bytes are swapped
 
     PIX_FMT_ARGB,      ///< packed ARGB 8:8:8:8, 32bpp, ARGBARGB...
@@ -100,8 +102,8 @@
     PIX_FMT_VDPAU_MPEG2,///< MPEG-2 HW decoding with VDPAU, data[0] contains a vdpau_render_state struct which contains the bitstream of the slices as well as various fields extracted from headers
     PIX_FMT_VDPAU_WMV3,///< WMV3 HW decoding with VDPAU, data[0] contains a vdpau_render_state struct which contains the bitstream of the slices as well as various fields extracted from headers
     PIX_FMT_VDPAU_VC1, ///< VC-1 HW decoding with VDPAU, data[0] contains a vdpau_render_state struct which contains the bitstream of the slices as well as various fields extracted from headers
-    PIX_FMT_RGB48BE,   ///< packed RGB 16:16:16, 48bpp, 16R, 16G, 16B, big-endian
-    PIX_FMT_RGB48LE,   ///< packed RGB 16:16:16, 48bpp, 16R, 16G, 16B, little-endian
+    PIX_FMT_RGB48BE,   ///< packed RGB 16:16:16, 48bpp, 16R, 16G, 16B, the 2-byte value for each R/G/B component is stored as big-endian
+    PIX_FMT_RGB48LE,   ///< packed RGB 16:16:16, 48bpp, 16R, 16G, 16B, the 2-byte value for each R/G/B component is stored as little-endian
 
     PIX_FMT_RGB565BE,  ///< packed RGB 5:6:5, 16bpp, (msb)   5R 6G 5B(lsb), big-endian
     PIX_FMT_RGB565LE,  ///< packed RGB 5:6:5, 16bpp, (msb)   5R 6G 5B(lsb), little-endian
@@ -117,16 +119,24 @@
     PIX_FMT_VAAPI_IDCT, ///< HW acceleration through VA API at IDCT entry-point, Picture.data[3] contains a vaapi_render_state struct which contains fields extracted from headers
     PIX_FMT_VAAPI_VLD,  ///< HW decoding through VA API, Picture.data[3] contains a vaapi_render_state struct which contains the bitstream of the slices as well as various fields extracted from headers
 
-    PIX_FMT_YUV420PLE,  ///< planar YUV 4:2:0, 24bpp, (1 Cr & Cb sample per 2x2 Y samples), little-endian
-    PIX_FMT_YUV420PBE,  ///< planar YUV 4:2:0, 24bpp, (1 Cr & Cb sample per 2x2 Y samples), big-endian
-    PIX_FMT_YUV422PLE,  ///< planar YUV 4:2:2, 32bpp, (1 Cr & Cb sample per 2x1 Y samples), little-endian
-    PIX_FMT_YUV422PBE,  ///< planar YUV 4:2:2, 32bpp, (1 Cr & Cb sample per 2x1 Y samples), big-endian
-    PIX_FMT_YUV444PLE,  ///< planar YUV 4:4:4, 48bpp, (1 Cr & Cb sample per 1x1 Y samples), little-endian
-    PIX_FMT_YUV444PBE,  ///< planar YUV 4:4:4, 48bpp, (1 Cr & Cb sample per 1x1 Y samples), big-endian
+    PIX_FMT_YUV420P16LE,  ///< planar YUV 4:2:0, 24bpp, (1 Cr & Cb sample per 2x2 Y samples), little-endian
+    PIX_FMT_YUV420P16BE,  ///< planar YUV 4:2:0, 24bpp, (1 Cr & Cb sample per 2x2 Y samples), big-endian
+    PIX_FMT_YUV422P16LE,  ///< planar YUV 4:2:2, 32bpp, (1 Cr & Cb sample per 2x1 Y samples), little-endian
+    PIX_FMT_YUV422P16BE,  ///< planar YUV 4:2:2, 32bpp, (1 Cr & Cb sample per 2x1 Y samples), big-endian
+    PIX_FMT_YUV444P16LE,  ///< planar YUV 4:4:4, 48bpp, (1 Cr & Cb sample per 1x1 Y samples), little-endian
+    PIX_FMT_YUV444P16BE,  ///< planar YUV 4:4:4, 48bpp, (1 Cr & Cb sample per 1x1 Y samples), big-endian
+    PIX_FMT_VDPAU_MPEG4,  ///< MPEG4 HW decoding with VDPAU, data[0] contains a vdpau_render_state struct which contains the bitstream of the slices as well as various fields extracted from headers
+    PIX_FMT_DXVA2_VLD,    ///< HW decoding through DXVA2, Picture.data[3] contains a LPDIRECT3DSURFACE9 pointer
+
+    PIX_FMT_RGB444BE,  ///< packed RGB 4:4:4, 16bpp, (msb)4A 4R 4G 4B(lsb), big-endian, most significant bits to 0
+    PIX_FMT_RGB444LE,  ///< packed RGB 4:4:4, 16bpp, (msb)4A 4R 4G 4B(lsb), little-endian, most significant bits to 0
+    PIX_FMT_BGR444BE,  ///< packed BGR 4:4:4, 16bpp, (msb)4A 4B 4G 4R(lsb), big-endian, most significant bits to 1
+    PIX_FMT_BGR444LE,  ///< packed BGR 4:4:4, 16bpp, (msb)4A 4B 4G 4R(lsb), little-endian, most significant bits to 1
+    PIX_FMT_Y400A,     ///< 8bit gray, 8bit alpha
     PIX_FMT_NB,        ///< number of pixel formats, DO NOT USE THIS if you want to link with shared libav* because the number of formats might differ between versions
 };
 
-#if HAVE_BIGENDIAN
+#if AV_HAVE_BIGENDIAN
 #   define PIX_FMT_NE(be, le) PIX_FMT_##be
 #else
 #   define PIX_FMT_NE(be, le) PIX_FMT_##le
@@ -141,11 +151,13 @@
 #define PIX_FMT_RGB48  PIX_FMT_NE(RGB48BE,  RGB48LE)
 #define PIX_FMT_RGB565 PIX_FMT_NE(RGB565BE, RGB565LE)
 #define PIX_FMT_RGB555 PIX_FMT_NE(RGB555BE, RGB555LE)
+#define PIX_FMT_RGB444 PIX_FMT_NE(RGB444BE, RGB444LE)
 #define PIX_FMT_BGR565 PIX_FMT_NE(BGR565BE, BGR565LE)
 #define PIX_FMT_BGR555 PIX_FMT_NE(BGR555BE, BGR555LE)
+#define PIX_FMT_BGR444 PIX_FMT_NE(BGR444BE, BGR444LE)
 
-#define PIX_FMT_YUV420P16 PIX_FMT_NE(YUV420PBE, YUV420PLE)
-#define PIX_FMT_YUV422P16 PIX_FMT_NE(YUV422PBE, YUV422PLE)
-#define PIX_FMT_YUV444P16 PIX_FMT_NE(YUV444PBE, YUV444PLE)
+#define PIX_FMT_YUV420P16 PIX_FMT_NE(YUV420P16BE, YUV420P16LE)
+#define PIX_FMT_YUV422P16 PIX_FMT_NE(YUV422P16BE, YUV422P16LE)
+#define PIX_FMT_YUV444P16 PIX_FMT_NE(YUV444P16BE, YUV444P16LE)
 
 #endif /* AVUTIL_PIXFMT_H */

Modified: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavutil/random_seed.c
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavutil/random_seed.c	2010-05-26 05:26:02 UTC (rev 6231)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavutil/random_seed.c	2010-05-26 05:26:23 UTC (rev 6232)
@@ -22,8 +22,9 @@
 #include <fcntl.h>
 #include "timer.h"
 #include "random_seed.h"
+#include "avutil.h"
 
-uint32_t ff_random_get_seed(void)
+uint32_t av_get_random_seed(void)
 {
     uint32_t seed;
     int fd;
@@ -31,9 +32,10 @@
     if ((fd = open("/dev/random", O_RDONLY)) == -1)
         fd = open("/dev/urandom", O_RDONLY);
     if (fd != -1){
-        read(fd, &seed, 4);
+        int err = read(fd, &seed, 4);
         close(fd);
-        return seed;
+        if (err == 4)
+            return seed;
     }
 #ifdef AV_READ_TIME
     seed = AV_READ_TIME();
@@ -41,3 +43,11 @@
     // XXX what to do ?
     return seed;
 }
+
+#if LIBAVUTIL_VERSION_MAJOR < 51
+attribute_deprecated uint32_t ff_random_get_seed(void);
+uint32_t ff_random_get_seed(void)
+{
+    return av_get_random_seed();
+}
+#endif

Modified: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavutil/random_seed.h
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavutil/random_seed.h	2010-05-26 05:26:02 UTC (rev 6231)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavutil/random_seed.h	2010-05-26 05:26:23 UTC (rev 6232)
@@ -26,6 +26,6 @@
 /**
  * Gets a seed to use in conjunction with random functions.
  */
-uint32_t ff_random_get_seed(void);
+uint32_t av_get_random_seed(void);
 
 #endif /* AVUTIL_RANDOM_SEED_H */

Modified: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavutil/rational.c
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavutil/rational.c	2010-05-26 05:26:02 UTC (rev 6231)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavutil/rational.c	2010-05-26 05:26:23 UTC (rev 6232)
@@ -20,7 +20,7 @@
  */
 
 /**
- * @file libavutil/rational.c
+ * @file
  * rational numbers
  * @author Michael Niedermayer <michaelni at gmx.at>
  */
@@ -98,6 +98,8 @@
 #define LOG2  0.69314718055994530941723212145817656807550013436025
     int exponent= FFMAX( (int)(log(fabs(d) + 1e-20)/LOG2), 0);
     int64_t den= 1LL << (61 - exponent);
+    if (isnan(d))
+        return (AVRational){0,0};
     av_reduce(&a.num, &a.den, (int64_t)(d * den + 0.5), den, max);
 
     return a;

Modified: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavutil/rational.h
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavutil/rational.h	2010-05-26 05:26:02 UTC (rev 6231)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavutil/rational.h	2010-05-26 05:26:23 UTC (rev 6232)
@@ -20,7 +20,7 @@
  */
 
 /**
- * @file libavutil/rational.h
+ * @file
  * rational numbers
  * @author Michael Niedermayer <michaelni at gmx.at>
  */
@@ -29,7 +29,7 @@
 #define AVUTIL_RATIONAL_H
 
 #include <stdint.h>
-#include "common.h"
+#include "attributes.h"
 
 /**
  * rational number numerator/denominator

Modified: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavutil/sh4/bswap.h
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavutil/sh4/bswap.h	2010-05-26 05:26:02 UTC (rev 6231)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavutil/sh4/bswap.h	2010-05-26 05:26:23 UTC (rev 6232)
@@ -17,7 +17,7 @@
  */
 
 /**
- * @file libavutil/sh4/bswap.h
+ * @file
  * byte swapping routines
  */
 
@@ -26,7 +26,7 @@
 
 #include <stdint.h>
 #include "config.h"
-#include "libavutil/common.h"
+#include "libavutil/attributes.h"
 
 #define bswap_16 bswap_16
 static av_always_inline av_const uint16_t bswap_16(uint16_t x)

Modified: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavutil/sha.c
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavutil/sha.c	2010-05-26 05:26:02 UTC (rev 6231)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavutil/sha.c	2010-05-26 05:26:23 UTC (rev 6232)
@@ -21,10 +21,12 @@
  * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA
  */
 
-#include "common.h"
+#include <string.h>
 #include "avutil.h"
 #include "bswap.h"
 #include "sha.h"
+#include "sha1.h"
+#include "intreadwrite.h"
 
 /** hash context */
 typedef struct AVSHA {
@@ -319,7 +321,7 @@
         av_sha_update(ctx, "", 1);
     av_sha_update(ctx, (uint8_t *)&finalcount, 8); /* Should cause a transform() */
     for (i = 0; i < ctx->digest_len; i++)
-        ((uint32_t*)digest)[i] = be2me_32(ctx->state[i]);
+        AV_WB32(digest + i*4, ctx->state[i]);
 }
 
 #if LIBAVUTIL_VERSION_MAJOR < 51

Modified: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavutil/timer.h
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavutil/timer.h	2010-05-26 05:26:02 UTC (rev 6231)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavutil/timer.h	2010-05-26 05:26:23 UTC (rev 6232)
@@ -1,5 +1,5 @@
 /**
- * @file libavutil/timer.h
+ * @file
  * high precision timer, useful to profile code
  *
  * copyright (c) 2006 Michael Niedermayer <michaelni at gmx.at>
@@ -26,13 +26,8 @@
 
 #include <stdlib.h>
 #include <stdint.h>
-// MEANX
-#ifndef ADM_NO_CONFIG_H
 #include "config.h"
-#endif
-// MEANX
 
-
 #if   ARCH_ARM
 #   include "arm/timer.h"
 #elif ARCH_BFIN

Added: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavutil/tomi/intreadwrite.h
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavutil/tomi/intreadwrite.h	2010-05-26 05:26:02 UTC (rev 6231)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavutil/tomi/intreadwrite.h	2010-05-26 05:26:23 UTC (rev 6232)
@@ -0,0 +1,148 @@
+/*
+ * Copyright (c) 2010 Mans Rullgard <mans at mansr.com>
+ *
+ * This file is part of FFmpeg.
+ *
+ * FFmpeg is free software; you can redistribute it and/or
+ * modify it under the terms of the GNU Lesser General Public
+ * License as published by the Free Software Foundation; either
+ * version 2.1 of the License, or (at your option) any later version.
+ *
+ * FFmpeg is distributed in the hope that it will be useful,
+ * but WITHOUT ANY WARRANTY; without even the implied warranty of
+ * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ * Lesser General Public License for more details.
+ *
+ * You should have received a copy of the GNU Lesser General Public
+ * License along with FFmpeg; if not, write to the Free Software
+ * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA
+ */
+
+#ifndef AVUTIL_TOMI_INTREADWRITE_H
+#define AVUTIL_TOMI_INTREADWRITE_H
+
+#include <stdint.h>
+#include "config.h"
+
+#define AV_RB16 AV_RB16
+static av_always_inline uint16_t AV_RB16(const void *p)
+{
+    uint16_t v;
+    __asm__ ("loadacc,   (%1+) \n\t"
+             "rol8             \n\t"
+             "storeacc,  %0    \n\t"
+             "loadacc,   (%1+) \n\t"
+             "add,       %0    \n\t"
+             : "=r"(v), "+a"(p));
+    return v;
+}
+
+#define AV_WB16 AV_WB16
+static av_always_inline void AV_WB16(void *p, uint16_t v)
+{
+    __asm__ volatile ("loadacc,   %1    \n\t"
+                      "lsr8             \n\t"
+                      "storeacc,  (%0+) \n\t"
+                      "loadacc,   %1    \n\t"
+                      "storeacc,  (%0+) \n\t"
+                      : "+&a"(p) : "r"(v));
+}
+
+#define AV_RL16 AV_RL16
+static av_always_inline uint16_t AV_RL16(const void *p)
+{
+    uint16_t v;
+    __asm__ ("loadacc,   (%1+) \n\t"
+             "storeacc,  %0    \n\t"
+             "loadacc,   (%1+) \n\t"
+             "rol8             \n\t"
+             "add,       %0    \n\t"
+             : "=r"(v), "+a"(p));
+    return v;
+}
+
+#define AV_WL16 AV_WL16
+static av_always_inline void AV_WL16(void *p, uint16_t v)
+{
+    __asm__ volatile ("loadacc,   %1    \n\t"
+                      "storeacc,  (%0+) \n\t"
+                      "lsr8             \n\t"
+                      "storeacc,  (%0+) \n\t"
+                      : "+&a"(p) : "r"(v));
+}
+
+#define AV_RB32 AV_RB32
+static av_always_inline uint32_t AV_RB32(const void *p)
+{
+    uint32_t v;
+    __asm__ ("loadacc,   (%1+) \n\t"
+             "rol8             \n\t"
+             "rol8             \n\t"
+             "rol8             \n\t"
+             "storeacc,  %0    \n\t"
+             "loadacc,   (%1+) \n\t"
+             "rol8             \n\t"
+             "rol8             \n\t"
+             "add,       %0    \n\t"
+             "loadacc,   (%1+) \n\t"
+             "rol8             \n\t"
+             "add,       %0    \n\t"
+             "loadacc,   (%1+) \n\t"
+             "add,       %0    \n\t"
+             : "=r"(v), "+a"(p));
+    return v;
+}
+
+#define AV_WB32 AV_WB32
+static av_always_inline void AV_WB32(void *p, uint32_t v)
+{
+    __asm__ volatile ("loadacc,   #4    \n\t"
+                      "add,       %0    \n\t"
+                      "loadacc,   %1    \n\t"
+                      "storeacc,  (-%0) \n\t"
+                      "lsr8             \n\t"
+                      "storeacc,  (-%0) \n\t"
+                      "lsr8             \n\t"
+                      "storeacc,  (-%0) \n\t"
+                      "lsr8             \n\t"
+                      "storeacc,  (-%0) \n\t"
+                      : "+&a"(p) : "r"(v));
+}
+
+#define AV_RL32 AV_RL32
+static av_always_inline uint32_t AV_RL32(const void *p)
+{
+    uint32_t v;
+    __asm__ ("loadacc,   (%1+) \n\t"
+             "storeacc,  %0    \n\t"
+             "loadacc,   (%1+) \n\t"
+             "rol8             \n\t"
+             "add,       %0    \n\t"
+             "loadacc,   (%1+) \n\t"
+             "rol8             \n\t"
+             "rol8             \n\t"
+             "add,       %0    \n\t"
+             "loadacc,   (%1+) \n\t"
+             "rol8             \n\t"
+             "rol8             \n\t"
+             "rol8             \n\t"
+             "add,       %0    \n\t"
+             : "=r"(v), "+a"(p));
+    return v;
+}
+
+#define AV_WL32 AV_WL32
+static av_always_inline void AV_WL32(void *p, uint32_t v)
+{
+    __asm__ volatile ("loadacc,   %1    \n\t"
+                      "storeacc,  (%0+) \n\t"
+                      "lsr8             \n\t"
+                      "storeacc,  (%0+) \n\t"
+                      "lsr8             \n\t"
+                      "storeacc,  (%0+) \n\t"
+                      "lsr8             \n\t"
+                      "storeacc,  (%0+) \n\t"
+                      : "+&a"(p) : "r"(v));
+}
+
+#endif /* AVUTIL_TOMI_INTREADWRITE_H */

Modified: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavutil/tree.c
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavutil/tree.c	2010-05-26 05:26:02 UTC (rev 6231)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavutil/tree.c	2010-05-26 05:26:23 UTC (rev 6232)
@@ -18,7 +18,6 @@
  * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA
  */
 
-#include "common.h"
 #include "log.h"
 #include "tree.h"
 
@@ -135,13 +134,14 @@
     }
 }
 
-#if 0
-void av_tree_enumerate(AVTreeNode *t, void *opaque, int (*f)(void *opaque, void *elem)){
-    int v= f(opaque, t->elem);
-    if(v>=0) av_tree_enumerate(t->child[0], opaque, f);
-    if(v<=0) av_tree_enumerate(t->child[1], opaque, f);
+void av_tree_enumerate(AVTreeNode *t, void *opaque, int (*cmp)(void *opaque, void *elem), int (*enu)(void *opaque, void *elem)){
+    if(t){
+        int v= cmp ? cmp(opaque, t->elem) : 0;
+        if(v>=0) av_tree_enumerate(t->child[0], opaque, cmp, enu);
+        if(v==0) enu(opaque, t->elem);
+        if(v<=0) av_tree_enumerate(t->child[1], opaque, cmp, enu);
+    }
 }
-#endif
 
 #ifdef TEST
 

Modified: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavutil/tree.h
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavutil/tree.h	2010-05-26 05:26:02 UTC (rev 6231)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavutil/tree.h	2010-05-26 05:26:23 UTC (rev 6232)
@@ -19,7 +19,7 @@
  */
 
 /**
- * @file libavutil/tree.h
+ * @file
  * A tree container.
  * Insertion, removal, finding equal, largest which is smaller than and
  * smallest which is larger than, all have O(log n) worst case complexity.
@@ -79,4 +79,17 @@
 void *av_tree_insert(struct AVTreeNode **rootp, void *key, int (*cmp)(void *key, const void *b), struct AVTreeNode **next);
 void av_tree_destroy(struct AVTreeNode *t);
 
+/**
+ * Applies enu(opaque, &elem) to all the elements in the tree in a given range.
+ *
+ * @param cmp a comparison function that returns < 0 for a element below the
+ *            range, > 0 for a element above the range and == 0 for a
+ *            element inside the range
+ *
+ * @note The cmp function should use the same ordering used to construct the
+ *       tree.
+ */
+void av_tree_enumerate(struct AVTreeNode *t, void *opaque, int (*cmp)(void *opaque, void *elem), int (*enu)(void *opaque, void *elem));
+
+
 #endif /* AVUTIL_TREE_H */

Modified: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavutil/utils.c
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavutil/utils.c	2010-05-26 05:26:02 UTC (rev 6231)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavutil/utils.c	2010-05-26 05:26:23 UTC (rev 6232)
@@ -16,10 +16,11 @@
  * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA
  */
 
+#include "config.h"
 #include "avutil.h"
 
 /**
- * @file libavutil/utils.c
+ * @file
  * various utility functions
  */
 
@@ -27,3 +28,14 @@
 {
     return LIBAVUTIL_VERSION_INT;
 }
+
+const char *avutil_configuration(void)
+{
+    return FFMPEG_CONFIGURATION;
+}
+
+const char *avutil_license(void)
+{
+#define LICENSE_PREFIX "libavutil license: "
+    return LICENSE_PREFIX FFMPEG_LICENSE + sizeof(LICENSE_PREFIX) - 1;
+}

Modified: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavutil/x86/bswap.h
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavutil/x86/bswap.h	2010-05-26 05:26:02 UTC (rev 6231)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavutil/x86/bswap.h	2010-05-26 05:26:23 UTC (rev 6232)
@@ -17,7 +17,7 @@
  */
 
 /**
- * @file libavutil/x86/bswap.h
+ * @file
  * byte swapping routines
  */
 
@@ -25,14 +25,9 @@
 #define AVUTIL_X86_BSWAP_H
 
 #include <stdint.h>
-// MEANX
-#ifndef ADM_NO_CONFIG_H
 #include "config.h"
-#endif
-// MEANX
+#include "libavutil/attributes.h"
 
-#include "libavutil/common.h"
-
 #define bswap_16 bswap_16
 static av_always_inline av_const uint16_t bswap_16(uint16_t x)
 {

Copied: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavutil/x86/intmath.h (from rev 6231, branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavutil/adler32.h)
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavutil/adler32.h	2010-05-26 05:26:02 UTC (rev 6231)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavutil/x86/intmath.h	2010-05-26 05:26:23 UTC (rev 6232)
@@ -0,0 +1,35 @@
+/*
+ * Copyright (c) 2010 Mans Rullgard <mans at mansr.com>
+ *
+ * This file is part of FFmpeg.
+ *
+ * FFmpeg is free software; you can redistribute it and/or
+ * modify it under the terms of the GNU Lesser General Public
+ * License as published by the Free Software Foundation; either
+ * version 2.1 of the License, or (at your option) any later version.
+ *
+ * FFmpeg is distributed in the hope that it will be useful,
+ * but WITHOUT ANY WARRANTY; without even the implied warranty of
+ * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ * Lesser General Public License for more details.
+ *
+ * You should have received a copy of the GNU Lesser General Public
+ * License along with FFmpeg; if not, write to the Free Software
+ * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA
+ */
+
+#ifndef AVUTIL_X86_INTMATH_H
+#define AVUTIL_X86_INTMATH_H
+
+#define FASTDIV(a,b) \
+    ({\
+        int ret, dmy;\
+        __asm__ volatile(\
+            "mull %3"\
+            :"=d"(ret), "=a"(dmy)\
+            :"1"(a), "g"(ff_inverse[b])\
+            );\
+        ret;\
+    })
+
+#endif /* AVUTIL_X86_INTMATH_H */

Added: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavutil/x86/intreadwrite.h
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavutil/x86/intreadwrite.h	2010-05-26 05:26:02 UTC (rev 6231)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavutil/x86/intreadwrite.h	2010-05-26 05:26:23 UTC (rev 6232)
@@ -0,0 +1,97 @@
+/*
+ * Copyright (c) 2010 Alexander Strange <astrange at ithinksw.com>
+ *
+ * This file is part of FFmpeg.
+ *
+ * FFmpeg is free software; you can redistribute it and/or
+ * modify it under the terms of the GNU Lesser General Public
+ * License as published by the Free Software Foundation; either
+ * version 2.1 of the License, or (at your option) any later version.
+ *
+ * FFmpeg is distributed in the hope that it will be useful,
+ * but WITHOUT ANY WARRANTY; without even the implied warranty of
+ * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ * Lesser General Public License for more details.
+ *
+ * You should have received a copy of the GNU Lesser General Public
+ * License along with FFmpeg; if not, write to the Free Software
+ * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA
+ */
+
+#ifndef AVUTIL_X86_INTREADWRITE_H
+#define AVUTIL_X86_INTREADWRITE_H
+
+#include <stdint.h>
+#include "config.h"
+#include "libavutil/attributes.h"
+
+#if HAVE_MMX
+
+#if !HAVE_FAST_64BIT && defined(__MMX__)
+
+#define AV_COPY64 AV_COPY64
+static av_always_inline void AV_COPY64(void *d, const void *s)
+{
+    __asm__("movq   %1, %%mm0  \n\t"
+            "movq   %%mm0, %0  \n\t"
+            : "=m"(*(uint64_t*)d)
+            : "m" (*(const uint64_t*)s)
+            : "mm0");
+}
+
+#define AV_SWAP64 AV_SWAP64
+static av_always_inline void AV_SWAP64(void *a, void *b)
+{
+    __asm__("movq   %1, %%mm0  \n\t"
+            "movq   %0, %%mm1  \n\t"
+            "movq   %%mm0, %0  \n\t"
+            "movq   %%mm1, %1  \n\t"
+            : "+m"(*(uint64_t*)a), "+m"(*(uint64_t*)b)
+            ::"mm0", "mm1");
+}
+
+#define AV_ZERO64 AV_ZERO64
+static av_always_inline void AV_ZERO64(void *d)
+{
+    __asm__("pxor %%mm0, %%mm0  \n\t"
+            "movq %%mm0, %0     \n\t"
+            : "=m"(*(uint64_t*)d)
+            :: "mm0");
+}
+
+#endif /* !HAVE_FAST_64BIT && defined(__MMX__) */
+
+#ifdef __SSE__
+
+#define AV_COPY128 AV_COPY128
+static av_always_inline void AV_COPY128(void *d, const void *s)
+{
+    struct v {uint64_t v[2];};
+
+    __asm__("movaps   %1, %%xmm0  \n\t"
+            "movaps   %%xmm0, %0  \n\t"
+            : "=m"(*(struct v*)d)
+            : "m" (*(const struct v*)s)
+            : "xmm0");
+}
+
+#endif /* __SSE__ */
+
+#ifdef __SSE2__
+
+#define AV_ZERO128 AV_ZERO128
+static av_always_inline void AV_ZERO128(void *d)
+{
+    struct v {uint64_t v[2];};
+
+    __asm__("pxor %%xmm0, %%xmm0  \n\t"
+            "movdqa   %%xmm0, %0  \n\t"
+            : "=m"(*(struct v*)d)
+            :: "xmm0");
+}
+
+#endif /* __SSE2__ */
+
+#endif /* HAVE_MMX */
+
+#endif /* AVUTIL_X86_INTREADWRITE_H */



From mean at mail.berlios.de  Wed May 26 07:26:30 2010
From: mean at mail.berlios.de (mean at BerliOS)
Date: Wed, 26 May 2010 07:26:30 +0200
Subject: [Avidemux-svn-commit] r6233 -
	branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavformat
Message-ID: <201005260526.o4Q5QU6L028278@sheep.berlios.de>

Author: mean
Date: 2010-05-26 07:26:29 +0200 (Wed, 26 May 2010)
New Revision: 6233

Modified:
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavformat/CMakeLists.txt
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavformat/file.c
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavformat/flvenc.c
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavformat/isom.c
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavformat/matroskaenc.c
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavformat/movenc.c
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavformat/movenc.c.orig
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavformat/mpegenc.c
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavformat/mpegtsenc.c
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavformat/utils.c
Log:
 [libavformat] Merge

Modified: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavformat/CMakeLists.txt
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavformat/CMakeLists.txt	2010-05-26 05:26:23 UTC (rev 6232)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavformat/CMakeLists.txt	2010-05-26 05:26:29 UTC (rev 6233)
@@ -2,11 +2,12 @@
 
 SET(${ADM_LIB}_SRCS 
 	mpeg.c  utils.c  avio.c  aviobuf.c  cutils.c  img2.c  file.c  mpegtsenc.c
-	movenc.c  avienc.c  wav.c  mov.c  matroska.c  isom.c  isom.h  
+	movenc.c  avi.c avienc.c  wav.c  mov.c  matroska.c  isom.c  isom.h  
 	flvenc.c  matroskaenc.c metadata.c metadata_compat.c options.c
         flacenc.c
 	avc.c raw.c  riff.c
         mpegenc.c
+        movenchint.c sdp.c adtsenc.c flacenc.c flacenc_header.c vorbiscomment.c
 )
 
 ADD_LIBRARY(${ADM_LIB} SHARED ${${ADM_LIB}_SRCS})

Modified: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavformat/file.c
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavformat/file.c	2010-05-26 05:26:23 UTC (rev 6232)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavformat/file.c	2010-05-26 05:26:29 UTC (rev 6233)
@@ -31,7 +31,73 @@
 #include <stdlib.h>
 #include "os_support.h"
 
+// GRUNTSTER start
+#ifdef __WIN32
+#include <windows.h>
 
+int utf8StringToWideChar(const char *utf8String, int utf8StringLength, wchar_t *wideCharString)
+{
+	int wideCharStringLength = MultiByteToWideChar(CP_UTF8, 0, utf8String, utf8StringLength, NULL, 0);
+
+	if (wideCharString)
+		MultiByteToWideChar(CP_UTF8, 0, utf8String, utf8StringLength, wideCharString, wideCharStringLength);
+
+	return wideCharStringLength;
+}
+
+int ADM_open(const char *path, int oflag, ...)
+{
+	int fileNameLength = utf8StringToWideChar(path, -1, NULL);
+	wchar_t wcFile[fileNameLength];
+	int creation = 0, access = 0;
+	HANDLE hFile;
+
+	utf8StringToWideChar(path, -1, wcFile);
+
+	if (oflag & O_WRONLY || oflag & O_RDWR)
+	{
+		access = GENERIC_WRITE;
+
+		if (oflag & O_RDWR)
+			access |= GENERIC_READ;
+
+		if (oflag & O_CREAT)
+		{
+			if (oflag & O_EXCL)
+				creation = CREATE_NEW;
+			else if (oflag & O_TRUNC)
+				creation = CREATE_ALWAYS;
+			else
+				creation = OPEN_ALWAYS;
+		}
+		else if (oflag & O_TRUNC)
+			creation = TRUNCATE_EXISTING;
+	}
+	else if (oflag & O_RDONLY)
+		creation = OPEN_EXISTING;
+
+	if (creation & GENERIC_WRITE)
+	{
+		hFile = CreateFileW(wcFile, access, 0, NULL, creation, 0, NULL);
+
+		if (hFile == INVALID_HANDLE_VALUE)
+			return -1;
+		else
+			CloseHandle(hFile);
+	}
+
+	hFile = CreateFileW(wcFile, access, FILE_SHARE_READ, NULL, creation, 0, NULL);
+
+	if (hFile == INVALID_HANDLE_VALUE)
+		return -1;
+	else
+		return _open_osfhandle((intptr_t)hFile, oflag);
+}
+
+#define open ADM_open
+#endif
+// GRUNTSTER end
+
 /* standard file protocol */
 
 static int file_open(URLContext *h, const char *filename, int flags)

Modified: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavformat/flvenc.c
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavformat/flvenc.c	2010-05-26 05:26:23 UTC (rev 6232)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavformat/flvenc.c	2010-05-26 05:26:29 UTC (rev 6233)
@@ -406,7 +406,8 @@
     "video/x-flv",
     "flv",
     sizeof(FLVContext),
-#if CONFIG_LIBMP3LAME
+//MEANX #if CONFIG_LIBMP3LAME
+#ifdef HAVE_LIBMP3LAME
     CODEC_ID_MP3,
 #else // CONFIG_LIBMP3LAME
     CODEC_ID_ADPCM_SWF,
@@ -418,3 +419,9 @@
     .codec_tag= (const AVCodecTag* const []){flv_video_codec_ids, flv_audio_codec_ids, 0},
     .flags= AVFMT_GLOBALHEADER | AVFMT_VARIABLE_FPS,
 };
+// MEANX
+int flvenc_init(void)
+{
+    av_register_output_format(&flv_muxer);
+    return 0;
+}
\ No newline at end of file

Modified: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavformat/isom.c
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavformat/isom.c	2010-05-26 05:26:23 UTC (rev 6232)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavformat/isom.c	2010-05-26 05:26:29 UTC (rev 6233)
@@ -205,7 +205,10 @@
     { CODEC_ID_MP1, MKTAG('.', 'm', 'p', '1') }, /* MPEG layer 1 */
     { CODEC_ID_MP2, MKTAG('.', 'm', 'p', '2') }, /* MPEG layer 2 */
 
-    { CODEC_ID_MP3, MKTAG('.', 'm', 'p', '3') }, /* MPEG layer 3 */ /* sample files at http://www.3ivx.com/showcase.html use this tag */
+    //MEANX { CODEC_ID_MP3, MKTAG('.', 'm', 'p', '3') }, /* MPEG layer 3 */ /* sample files at http://www.3ivx.com/showcase.html use this tag */
+     { CODEC_ID_MP3, MKTAG( 'm', 'p', '4','a') },
+     { CODEC_ID_MP2, MKTAG( 'm', 'p', '4', 'a') },
+    // /MEANX
     { CODEC_ID_MP3, 0x6D730055 }, /* MPEG layer 3 */
 
 /*  { CODEC_ID_OGG_VORBIS, MKTAG('O', 'g', 'g', 'S') }, *//* sample files at http://heroinewarrior.com/xmovie.php3 use this tag */

Modified: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavformat/matroskaenc.c
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavformat/matroskaenc.c	2010-05-26 05:26:23 UTC (rev 6232)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavformat/matroskaenc.c	2010-05-26 05:26:29 UTC (rev 6233)
@@ -403,6 +403,7 @@
 
 static int put_xiph_codecpriv(AVFormatContext *s, ByteIOContext *pb, AVCodecContext *codec)
 {
+#if 0 // MEANX avidemux does thing differently
     uint8_t *header_start[3];
     int header_len[3];
     int first_header_size;
@@ -427,6 +428,28 @@
         put_buffer(pb, header_start[j], header_len[j]);
 
     return 0;
+#else
+   // Not endian safe....
+      uint32_t packetLen[3],*ptr=(uint32_t *)codec->extradata;
+      uint8_t *data[3],i,j;
+      if( 3*4+ptr[0]+ptr[1]+ptr[2]!=codec->extradata_size)
+      {
+        av_log(s, AV_LOG_ERROR, "Broken avidemux xiph header.\n");
+        return -1;
+      }
+      data[0]=codec->extradata+3*4;
+      data[1]=data[0]+ptr[0];
+      data[2]=data[1]+ptr[1];
+      put_byte(pb, 2);                    // number packets - 1
+      for (j = 0; j < 2; j++) 
+      {
+          put_xiph_size(pb, ptr[j]);
+      }
+      for (j = 0; j < 3; j++)
+        put_buffer(pb, data[j], ptr[j]);
+      
+      return 0; // /MEANX
+#endif
 }
 
 static void get_aac_sample_rates(AVFormatContext *s, AVCodecContext *codec, int *sample_rate, int *output_sample_rate)
@@ -544,6 +567,23 @@
         put_ebml_uint (pb, MATROSKA_ID_TRACKNUMBER     , i + 1);
         put_ebml_uint (pb, MATROSKA_ID_TRACKUID        , i + 1);
         put_ebml_uint (pb, MATROSKA_ID_TRACKFLAGLACING , 0);    // no lacing (yet)
+/**  MEANX : Add a default duration for video **/
+        if(codec->codec_type==CODEC_TYPE_VIDEO)
+        {
+          if(codec->time_base.den && codec->time_base.num)
+          {
+            int num=codec->time_base.num;
+            int den=codec->time_base.den;
+            unsigned int default_duration;
+            float period=num;
+                  period/=den;
+                  period*=1000*1000*1000; // in ns
+                  default_duration=(unsigned int)floor(period);
+                  put_ebml_uint (pb, MATROSKA_ID_TRACKDEFAULTDURATION ,default_duration);
+          }
+        }
+        
+/**  MEANX : Add a default duration for video **/
 
         if ((tag = av_metadata_get(st->metadata, "title", NULL, 0)))
             put_ebml_string(pb, MATROSKA_ID_TRACKNAME, tag->value);
@@ -1004,3 +1044,13 @@
     .flags = AVFMT_GLOBALHEADER,
     .codec_tag = (const AVCodecTag* const []){ff_codec_wav_tags, 0},
 };
+// MEANX
+//
+int matroskaenc_init(void)
+{
+    av_register_output_format(&matroska_muxer);
+    return 0;
+}
+// /MEANX
+
+

Modified: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavformat/movenc.c
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavformat/movenc.c	2010-05-26 05:26:23 UTC (rev 6232)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavformat/movenc.c	2010-05-26 05:26:29 UTC (rev 6233)
@@ -2276,3 +2276,15 @@
     .codec_tag = (const AVCodecTag* const []){codec_ipod_tags, 0},
 };
 #endif
+/* MEANX */
+int movenc_init(void)
+{
+    av_register_output_format(&mov_muxer);
+    av_register_output_format(&tgp_muxer);
+    av_register_output_format(&mp4_muxer);
+    av_register_output_format(&psp_muxer);
+    av_register_output_format(&tg2_muxer);
+    av_register_output_format(&ipod_muxer);
+    return 0;
+}
+/* MEANX */

Modified: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavformat/movenc.c.orig
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavformat/movenc.c.orig	2010-05-26 05:26:23 UTC (rev 6232)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavformat/movenc.c.orig	2010-05-26 05:26:29 UTC (rev 6233)
@@ -21,6 +21,7 @@
  * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA
  */
 
+#include "movenc.h"
 #include "avformat.h"
 #include "riff.h"
 #include "avio.h"
@@ -28,67 +29,12 @@
 #include "avc.h"
 #include "libavcodec/get_bits.h"
 #include "libavcodec/put_bits.h"
+#include "internal.h"
+#include "libavutil/avstring.h"
 
 #undef NDEBUG
 #include <assert.h>
 
-#define MOV_INDEX_CLUSTER_SIZE 16384
-#define globalTimescale 1000
-
-#define MODE_MP4  0x01
-#define MODE_MOV  0x02
-#define MODE_3GP  0x04
-#define MODE_PSP  0x08 // example working PSP command line:
-// ffmpeg -i testinput.avi  -f psp -r 14.985 -s 320x240 -b 768 -ar 24000 -ab 32 M4V00001.MP4
-#define MODE_3G2  0x10
-#define MODE_IPOD 0x20
-
-typedef struct MOVIentry {
-    unsigned int size;
-    uint64_t     pos;
-    unsigned int samplesInChunk;
-    unsigned int entries;
-    int          cts;
-    int64_t      dts;
-#define MOV_SYNC_SAMPLE         0x0001
-#define MOV_PARTIAL_SYNC_SAMPLE 0x0002
-    uint32_t     flags;
-} MOVIentry;
-
-typedef struct MOVIndex {
-    int         mode;
-    int         entry;
-    long        timescale;
-    long        time;
-    int64_t     trackDuration;
-    long        sampleCount;
-    long        sampleSize;
-    int         hasKeyframes;
-#define MOV_TRACK_CTTS         0x0001
-#define MOV_TRACK_STPS         0x0002
-    uint32_t    flags;
-    int         language;
-    int         trackID;
-    int         tag; ///< stsd fourcc
-    AVCodecContext *enc;
-
-    int         vosLen;
-    uint8_t     *vosData;
-    MOVIentry   *cluster;
-    int         audio_vbr;
-    int         height; ///< active picture (w/o VBI) height for D-10/IMX
-} MOVTrack;
-
-typedef struct MOVMuxContext {
-    int     mode;
-    int64_t time;
-    int     nb_streams;
-    int64_t mdat_pos;
-    uint64_t mdat_size;
-    long    timescale;
-    MOVTrack *tracks;
-} MOVMuxContext;
-
 //FIXME support 64 bit variant with wide placeholders
 static int64_t updateSize(ByteIOContext *pb, int64_t pos)
 {
@@ -334,7 +280,7 @@
 
     // the following fields is made of 6 bits to identify the streamtype (4 for video, 5 for audio)
     // plus 1 bit to indicate upstream and 1 bit set to 1 (reserved)
-    if(track->enc->codec_type == CODEC_TYPE_AUDIO)
+    if(track->enc->codec_type == AVMEDIA_TYPE_AUDIO)
         put_byte(pb, 0x15); // flags (= Audiostream)
     else
         put_byte(pb, 0x11); // flags (= Visualstream)
@@ -360,6 +306,14 @@
     return updateSize(pb, pos);
 }
 
+static int mov_pcm_le_gt16(enum CodecID codec_id)
+{
+    return codec_id == CODEC_ID_PCM_S24LE ||
+           codec_id == CODEC_ID_PCM_S32LE ||
+           codec_id == CODEC_ID_PCM_F32LE ||
+           codec_id == CODEC_ID_PCM_F64LE;
+}
+
 static int mov_write_wave_tag(ByteIOContext *pb, MOVTrack *track)
 {
     int64_t pos = url_ftell(pb);
@@ -377,8 +331,7 @@
         put_tag(pb, "mp4a");
         put_be32(pb, 0);
         mov_write_esds_tag(pb, track);
-    } else if (track->enc->codec_id == CODEC_ID_PCM_S24LE ||
-               track->enc->codec_id == CODEC_ID_PCM_S32LE) {
+    } else if (mov_pcm_le_gt16(track->enc->codec_id)) {
         mov_write_enda_tag(pb);
     } else if (track->enc->codec_id == CODEC_ID_AMR_NB) {
         mov_write_amr_tag(pb, track);
@@ -402,16 +355,53 @@
     return 8+track->vosLen;
 }
 
+/**
+ * Compute flags for 'lpcm' tag.
+ * See CoreAudioTypes and AudioStreamBasicDescription at Apple.
+ */
+static int mov_get_lpcm_flags(enum CodecID codec_id)
+{
+    switch (codec_id) {
+    case CODEC_ID_PCM_F32BE:
+    case CODEC_ID_PCM_F64BE:
+        return 11;
+    case CODEC_ID_PCM_F32LE:
+    case CODEC_ID_PCM_F64LE:
+        return 9;
+    case CODEC_ID_PCM_U8:
+        return 10;
+    case CODEC_ID_PCM_S16BE:
+    case CODEC_ID_PCM_S24BE:
+    case CODEC_ID_PCM_S32BE:
+        return 14;
+    case CODEC_ID_PCM_S8:
+    case CODEC_ID_PCM_S16LE:
+    case CODEC_ID_PCM_S24LE:
+    case CODEC_ID_PCM_S32LE:
+        return 12;
+    default:
+        return 0;
+    }
+}
+
 static int mov_write_audio_tag(ByteIOContext *pb, MOVTrack *track)
 {
     int64_t pos = url_ftell(pb);
-    int version = track->mode == MODE_MOV &&
-        (track->audio_vbr ||
-         track->enc->codec_id == CODEC_ID_PCM_S32LE ||
-         track->enc->codec_id == CODEC_ID_PCM_S24LE);
+    int version = 0;
+    uint32_t tag = track->tag;
 
+    if (track->mode == MODE_MOV) {
+        if (track->timescale > UINT16_MAX) {
+            if (mov_get_lpcm_flags(track->enc->codec_id))
+                tag = AV_RL32("lpcm");
+            version = 2;
+        } else if (track->audio_vbr || mov_pcm_le_gt16(track->enc->codec_id)) {
+            version = 1;
+        }
+    }
+
     put_be32(pb, 0); /* size */
-    put_le32(pb, track->tag); // store it byteswapped
+    put_le32(pb, tag); // store it byteswapped
     put_be32(pb, 0); /* Reserved */
     put_be16(pb, 0); /* Reserved */
     put_be16(pb, 1); /* Data-reference index, XXX  == 1 */
@@ -421,24 +411,40 @@
     put_be16(pb, 0); /* Revision level */
     put_be32(pb, 0); /* Reserved */
 
-    if (track->mode == MODE_MOV) {
-        put_be16(pb, track->enc->channels);
-        if (track->enc->codec_id == CODEC_ID_PCM_U8 ||
-            track->enc->codec_id == CODEC_ID_PCM_S8)
-            put_be16(pb, 8); /* bits per sample */
-        else
-            put_be16(pb, 16);
-        put_be16(pb, track->audio_vbr ? -2 : 0); /* compression ID */
-    } else { /* reserved for mp4/3gp */
-        put_be16(pb, 2);
+    if (version == 2) {
+        put_be16(pb, 3);
         put_be16(pb, 16);
+        put_be16(pb, 0xfffe);
         put_be16(pb, 0);
+        put_be32(pb, 0x00010000);
+        put_be32(pb, 72);
+        put_be64(pb, av_dbl2int(track->timescale));
+        put_be32(pb, track->enc->channels);
+        put_be32(pb, 0x7F000000);
+        put_be32(pb, av_get_bits_per_sample(track->enc->codec_id));
+        put_be32(pb, mov_get_lpcm_flags(track->enc->codec_id));
+        put_be32(pb, track->sampleSize);
+        put_be32(pb, track->enc->frame_size);
+    } else {
+        if (track->mode == MODE_MOV) {
+            put_be16(pb, track->enc->channels);
+            if (track->enc->codec_id == CODEC_ID_PCM_U8 ||
+                track->enc->codec_id == CODEC_ID_PCM_S8)
+                put_be16(pb, 8); /* bits per sample */
+            else
+                put_be16(pb, 16);
+            put_be16(pb, track->audio_vbr ? -2 : 0); /* compression ID */
+        } else { /* reserved for mp4/3gp */
+            put_be16(pb, 2);
+            put_be16(pb, 16);
+            put_be16(pb, 0);
+        }
+
+        put_be16(pb, 0); /* packet size (= 0) */
+        put_be16(pb, track->timescale); /* Time scale */
+        put_be16(pb, 0); /* Reserved */
     }
 
-    put_be16(pb, 0); /* packet size (= 0) */
-    put_be16(pb, track->timescale); /* Time scale */
-    put_be16(pb, 0); /* Reserved */
-
     if(version == 1) { /* SoundDescription V1 extended info */
         put_be32(pb, track->enc->frame_size); /* Samples per packet */
         put_be32(pb, track->sampleSize / track->enc->channels); /* Bytes per packet */
@@ -450,9 +456,8 @@
        (track->enc->codec_id == CODEC_ID_AAC ||
         track->enc->codec_id == CODEC_ID_AC3 ||
         track->enc->codec_id == CODEC_ID_AMR_NB ||
-        track->enc->codec_id == CODEC_ID_PCM_S24LE ||
-        track->enc->codec_id == CODEC_ID_PCM_S32LE ||
-        track->enc->codec_id == CODEC_ID_ALAC))
+        track->enc->codec_id == CODEC_ID_ALAC ||
+        mov_pcm_le_gt16(track->enc->codec_id)))
         mov_write_wave_tag(pb, track);
     else if(track->tag == MKTAG('m','p','4','a'))
         mov_write_esds_tag(pb, track);
@@ -562,8 +567,8 @@
     else if (track->enc->codec_id == CODEC_ID_AC3)       tag = MKTAG('a','c','-','3');
     else if (track->enc->codec_id == CODEC_ID_DIRAC)     tag = MKTAG('d','r','a','c');
     else if (track->enc->codec_id == CODEC_ID_MOV_TEXT)  tag = MKTAG('t','x','3','g');
-    else if (track->enc->codec_type == CODEC_TYPE_VIDEO) tag = MKTAG('m','p','4','v');
-    else if (track->enc->codec_type == CODEC_TYPE_AUDIO) tag = MKTAG('m','p','4','a');
+    else if (track->enc->codec_type == AVMEDIA_TYPE_VIDEO) tag = MKTAG('m','p','4','v');
+    else if (track->enc->codec_type == AVMEDIA_TYPE_AUDIO) tag = MKTAG('m','p','4','a');
 
     return tag;
 }
@@ -584,12 +589,12 @@
     int tag = track->enc->codec_tag;
 
     // keep original tag for subs, ipod supports both formats
-    if (!(track->enc->codec_type == CODEC_TYPE_SUBTITLE &&
+    if (!(track->enc->codec_type == AVMEDIA_TYPE_SUBTITLE &&
         (tag == MKTAG('t','x','3','g') ||
          tag == MKTAG('t','e','x','t'))))
         tag = ff_codec_get_tag(codec_ipod_tags, track->enc->codec_id);
 
-    if (!match_ext(s->filename, "m4a") && !match_ext(s->filename, "m4v"))
+    if (!av_match_ext(s->filename, "m4a") && !av_match_ext(s->filename, "m4v"))
         av_log(s, AV_LOG_WARNING, "Warning, extension is not .m4a nor .m4v "
                "Quicktime/Ipod might not play the file\n");
 
@@ -656,7 +661,7 @@
             tag = mov_get_dv_codec_tag(s, track);
         else if (track->enc->codec_id == CODEC_ID_RAWVIDEO)
             tag = mov_get_rawvideo_codec_tag(s, track);
-        else if (track->enc->codec_type == CODEC_TYPE_VIDEO) {
+        else if (track->enc->codec_type == AVMEDIA_TYPE_VIDEO) {
             tag = ff_codec_get_tag(codec_movvideo_tags, track->enc->codec_id);
             if (!tag) { // if no mac fcc found, try with Microsoft tags
                 tag = ff_codec_get_tag(ff_codec_bmp_tags, track->enc->codec_id);
@@ -664,7 +669,7 @@
                     av_log(s, AV_LOG_INFO, "Warning, using MS style video codec tag, "
                            "the file may be unplayable!\n");
             }
-        } else if (track->enc->codec_type == CODEC_TYPE_AUDIO) {
+        } else if (track->enc->codec_type == AVMEDIA_TYPE_AUDIO) {
             tag = ff_codec_get_tag(codec_movaudio_tags, track->enc->codec_id);
             if (!tag) { // if no mac fcc found, try with Microsoft tags
                 int ms_tag = ff_codec_get_tag(ff_codec_wav_tags, track->enc->codec_id);
@@ -674,7 +679,7 @@
                            "the file may be unplayable!\n");
                 }
             }
-        } else if (track->enc->codec_type == CODEC_TYPE_SUBTITLE)
+        } else if (track->enc->codec_type == AVMEDIA_TYPE_SUBTITLE)
             tag = ff_codec_get_tag(ff_codec_movsubtitle_tags, track->enc->codec_id);
     }
 
@@ -803,6 +808,26 @@
     return updateSize(pb, pos);
 }
 
+static int mov_write_rtp_tag(ByteIOContext *pb, MOVTrack *track)
+{
+    int64_t pos = url_ftell(pb);
+    put_be32(pb, 0); /* size */
+    put_tag(pb, "rtp ");
+    put_be32(pb, 0); /* Reserved */
+    put_be16(pb, 0); /* Reserved */
+    put_be16(pb, 1); /* Data-reference index */
+
+    put_be16(pb, 1); /* Hint track version */
+    put_be16(pb, 1); /* Highest compatible version */
+    put_be32(pb, track->max_packet_size); /* Max packet size */
+
+    put_be32(pb, 12); /* size */
+    put_tag(pb, "tims");
+    put_be32(pb, track->timescale);
+
+    return updateSize(pb, pos);
+}
+
 static int mov_write_stsd_tag(ByteIOContext *pb, MOVTrack *track)
 {
     int64_t pos = url_ftell(pb);
@@ -810,12 +835,14 @@
     put_tag(pb, "stsd");
     put_be32(pb, 0); /* version & flags */
     put_be32(pb, 1); /* entry count */
-    if (track->enc->codec_type == CODEC_TYPE_VIDEO)
+    if (track->enc->codec_type == AVMEDIA_TYPE_VIDEO)
         mov_write_video_tag(pb, track);
-    else if (track->enc->codec_type == CODEC_TYPE_AUDIO)
+    else if (track->enc->codec_type == AVMEDIA_TYPE_AUDIO)
         mov_write_audio_tag(pb, track);
-    else if (track->enc->codec_type == CODEC_TYPE_SUBTITLE)
+    else if (track->enc->codec_type == AVMEDIA_TYPE_SUBTITLE)
         mov_write_subtitle_tag(pb, track);
+    else if (track->enc->codec_tag == MKTAG('r','t','p',' '))
+        mov_write_rtp_tag(pb, track);
     return updateSize(pb, pos);
 }
 
@@ -860,7 +887,7 @@
     uint32_t atom_size;
     int i;
 
-    if (track->enc->codec_type == CODEC_TYPE_AUDIO && !track->audio_vbr) {
+    if (track->enc->codec_type == AVMEDIA_TYPE_AUDIO && !track->audio_vbr) {
         stts_entries = av_malloc(sizeof(*stts_entries)); /* one entry */
         stts_entries[0].count = track->sampleCount;
         stts_entries[0].duration = 1;
@@ -915,12 +942,13 @@
     put_tag(pb, "stbl");
     mov_write_stsd_tag(pb, track);
     mov_write_stts_tag(pb, track);
-    if (track->enc->codec_type == CODEC_TYPE_VIDEO &&
+    if ((track->enc->codec_type == AVMEDIA_TYPE_VIDEO ||
+         track->enc->codec_tag == MKTAG('r','t','p',' ')) &&
         track->hasKeyframes && track->hasKeyframes < track->entry)
         mov_write_stss_tag(pb, track, MOV_SYNC_SAMPLE);
     if (track->mode == MODE_MOV && track->flags & MOV_TRACK_STPS)
         mov_write_stss_tag(pb, track, MOV_PARTIAL_SYNC_SAMPLE);
-    if (track->enc->codec_type == CODEC_TYPE_VIDEO &&
+    if (track->enc->codec_type == AVMEDIA_TYPE_VIDEO &&
         track->flags & MOV_TRACK_CTTS)
         mov_write_ctts_tag(pb, track);
     mov_write_stsc_tag(pb, track);
@@ -992,16 +1020,19 @@
         descr = "DataHandler";
     } else {
         hdlr = (track->mode == MODE_MOV) ? "mhlr" : "\0\0\0\0";
-        if (track->enc->codec_type == CODEC_TYPE_VIDEO) {
+        if (track->enc->codec_type == AVMEDIA_TYPE_VIDEO) {
             hdlr_type = "vide";
             descr = "VideoHandler";
-        } else if (track->enc->codec_type == CODEC_TYPE_AUDIO) {
+        } else if (track->enc->codec_type == AVMEDIA_TYPE_AUDIO) {
             hdlr_type = "soun";
             descr = "SoundHandler";
-        } else if (track->enc->codec_type == CODEC_TYPE_SUBTITLE) {
+        } else if (track->enc->codec_type == AVMEDIA_TYPE_SUBTITLE) {
             if (track->tag == MKTAG('t','x','3','g')) hdlr_type = "sbtl";
             else                                      hdlr_type = "text";
             descr = "SubtitleHandler";
+        } else if (track->enc->codec_tag == MKTAG('r','t','p',' ')) {
+            hdlr_type = "hint";
+            descr = "HintHandler";
         }
     }
 
@@ -1021,18 +1052,35 @@
     return updateSize(pb, pos);
 }
 
+static int mov_write_hmhd_tag(ByteIOContext *pb)
+{
+    /* This atom must be present, but leaving the values at zero
+     * seems harmless. */
+    put_be32(pb, 28); /* size */
+    put_tag(pb, "hmhd");
+    put_be32(pb, 0); /* version, flags */
+    put_be16(pb, 0); /* maxPDUsize */
+    put_be16(pb, 0); /* avgPDUsize */
+    put_be32(pb, 0); /* maxbitrate */
+    put_be32(pb, 0); /* avgbitrate */
+    put_be32(pb, 0); /* reserved */
+    return 28;
+}
+
 static int mov_write_minf_tag(ByteIOContext *pb, MOVTrack *track)
 {
     int64_t pos = url_ftell(pb);
     put_be32(pb, 0); /* size */
     put_tag(pb, "minf");
-    if(track->enc->codec_type == CODEC_TYPE_VIDEO)
+    if(track->enc->codec_type == AVMEDIA_TYPE_VIDEO)
         mov_write_vmhd_tag(pb);
-    else if (track->enc->codec_type == CODEC_TYPE_AUDIO)
+    else if (track->enc->codec_type == AVMEDIA_TYPE_AUDIO)
         mov_write_smhd_tag(pb);
-    else if (track->enc->codec_type == CODEC_TYPE_SUBTITLE) {
+    else if (track->enc->codec_type == AVMEDIA_TYPE_SUBTITLE) {
         if (track->tag == MKTAG('t','e','x','t')) mov_write_gmhd_tag(pb);
         else                                      mov_write_nmhd_tag(pb);
+    } else if (track->tag == MKTAG('r','t','p',' ')) {
+        mov_write_hmhd_tag(pb);
     }
     if (track->mode == MODE_MOV) /* FIXME: Why do it for MODE_MOV only ? */
         mov_write_hdlr_tag(pb, NULL);
@@ -1084,7 +1132,8 @@
 
 static int mov_write_tkhd_tag(ByteIOContext *pb, MOVTrack *track, AVStream *st)
 {
-    int64_t duration = av_rescale_rnd(track->trackDuration, globalTimescale, track->timescale, AV_ROUND_UP);
+    int64_t duration = av_rescale_rnd(track->trackDuration, MOV_TIMESCALE,
+                                      track->timescale, AV_ROUND_UP);
     int version = duration < INT32_MAX ? 0 : 1;
 
     (version == 1) ? put_be32(pb, 104) : put_be32(pb, 92); /* size */
@@ -1106,7 +1155,7 @@
     put_be32(pb, 0); /* reserved */
     put_be32(pb, 0x0); /* reserved (Layer & Alternate group) */
     /* Volume, only for audio */
-    if(track->enc->codec_type == CODEC_TYPE_AUDIO)
+    if(track->enc->codec_type == AVMEDIA_TYPE_AUDIO)
         put_be16(pb, 0x0100);
     else
         put_be16(pb, 0);
@@ -1124,8 +1173,8 @@
     put_be32(pb, 0x40000000); /* reserved */
 
     /* Track width and height, for visual only */
-    if(track->enc->codec_type == CODEC_TYPE_VIDEO ||
-       track->enc->codec_type == CODEC_TYPE_SUBTITLE) {
+    if(st && (track->enc->codec_type == AVMEDIA_TYPE_VIDEO ||
+              track->enc->codec_type == AVMEDIA_TYPE_SUBTITLE)) {
         double sample_aspect_ratio = av_q2d(st->sample_aspect_ratio);
         if(!sample_aspect_ratio || track->height != track->enc->height)
             sample_aspect_ratio = 1;
@@ -1149,13 +1198,25 @@
     put_be32(pb, 0x0);
     put_be32(pb, 0x1);
 
-    put_be32(pb, av_rescale_rnd(track->trackDuration, globalTimescale, track->timescale, AV_ROUND_UP)); /* duration   ... doesn't seem to effect psp */
+    /* duration   ... doesn't seem to effect psp */
+    put_be32(pb, av_rescale_rnd(track->trackDuration, MOV_TIMESCALE,
+                                track->timescale, AV_ROUND_UP));
 
     put_be32(pb, track->cluster[0].cts); /* first pts is cts since dts is 0 */
     put_be32(pb, 0x00010000);
     return 0x24;
 }
 
+static int mov_write_tref_tag(ByteIOContext *pb, MOVTrack *track)
+{
+    put_be32(pb, 20);   // size
+    put_tag(pb, "tref");
+    put_be32(pb, 12);   // size (subatom)
+    put_le32(pb, track->tref_tag);
+    put_be32(pb, track->tref_id);
+    return 20;
+}
+
 // goes at the end of each track!  ... Critical for PSP playback ("Incompatible data" without it)
 static int mov_write_uuid_tag_psp(ByteIOContext *pb, MOVTrack *mov)
 {
@@ -1175,6 +1236,25 @@
     return 0x34;
 }
 
+static int mov_write_udta_sdp(ByteIOContext *pb, AVCodecContext *ctx, int index)
+{
+    char buf[1000] = "";
+    int len;
+
+    ff_sdp_write_media(buf, sizeof(buf), ctx, NULL, 0, 0);
+    av_strlcatf(buf, sizeof(buf), "a=control:streamid=%d\r\n", index);
+    len = strlen(buf);
+
+    put_be32(pb, len + 24);
+    put_tag (pb, "udta");
+    put_be32(pb, len + 16);
+    put_tag (pb, "hnti");
+    put_be32(pb, len + 8);
+    put_tag (pb, "sdp ");
+    put_buffer(pb, buf, len);
+    return len + 24;
+}
+
 static int mov_write_trak_tag(ByteIOContext *pb, MOVTrack *track, AVStream *st)
 {
     int64_t pos = url_ftell(pb);
@@ -1183,9 +1263,13 @@
     mov_write_tkhd_tag(pb, track, st);
     if (track->mode == MODE_PSP || track->flags & MOV_TRACK_CTTS)
         mov_write_edts_tag(pb, track);  // PSP Movies require edts box
+    if (track->tref_tag)
+        mov_write_tref_tag(pb, track);
     mov_write_mdia_tag(pb, track);
     if (track->mode == MODE_PSP)
         mov_write_uuid_tag_psp(pb,track);  // PSP Movies require this uuid box
+    if (track->tag == MKTAG('r','t','p',' '))
+        mov_write_udta_sdp(pb, track->rtp_ctx->streams[0]->codec, track->trackID);
     return updateSize(pb, pos);
 }
 
@@ -1213,7 +1297,10 @@
 
     for (i=0; i<mov->nb_streams; i++) {
         if(mov->tracks[i].entry > 0) {
-            maxTrackLenTemp = av_rescale_rnd(mov->tracks[i].trackDuration, globalTimescale, mov->tracks[i].timescale, AV_ROUND_UP);
+            maxTrackLenTemp = av_rescale_rnd(mov->tracks[i].trackDuration,
+                                             MOV_TIMESCALE,
+                                             mov->tracks[i].timescale,
+                                             AV_ROUND_UP);
             if(maxTrackLen < maxTrackLenTemp)
                 maxTrackLen = maxTrackLenTemp;
             if(maxTrackID < mov->tracks[i].trackID)
@@ -1233,7 +1320,7 @@
         put_be32(pb, mov->time); /* creation time */
         put_be32(pb, mov->time); /* modification time */
     }
-    put_be32(pb, mov->timescale); /* timescale */
+    put_be32(pb, MOV_TIMESCALE);
     (version == 1) ? put_be64(pb, maxTrackLen) : put_be32(pb, maxTrackLen); /* duration of longest track */
 
     put_be32(pb, 0x00010000); /* reserved (preferred rate) 1.0 = normal */
@@ -1266,8 +1353,7 @@
 static int mov_write_itunes_hdlr_tag(ByteIOContext *pb, MOVMuxContext *mov,
                                      AVFormatContext *s)
 {
-    int64_t pos = url_ftell(pb);
-    put_be32(pb, 0); /* size */
+    put_be32(pb, 33); /* size */
     put_tag(pb, "hdlr");
     put_be32(pb, 0);
     put_be32(pb, 0);
@@ -1275,22 +1361,24 @@
     put_tag(pb, "appl");
     put_be32(pb, 0);
     put_be32(pb, 0);
-    put_be16(pb, 0);
-    return updateSize(pb, pos);
+    put_byte(pb, 0);
+    return 33;
 }
 
 /* helper function to write a data tag with the specified string as data */
 static int mov_write_string_data_tag(ByteIOContext *pb, const char *data, int lang, int long_style)
 {
     if(long_style){
-        int64_t pos = url_ftell(pb);
-        put_be32(pb, 0); /* size */
+        int size = 16 + strlen(data);
+        put_be32(pb, size); /* size */
         put_tag(pb, "data");
         put_be32(pb, 1);
         put_be32(pb, 0);
         put_buffer(pb, data, strlen(data));
-        return updateSize(pb, pos);
+        return size;
     }else{
+        if (!lang)
+            lang = ff_mov_iso639_to_lang("und", 1);
         put_be16(pb, strlen(data)); /* string length */
         put_be16(pb, lang);
         put_buffer(pb, data, strlen(data));
@@ -1326,7 +1414,7 @@
     while ((t2 = av_metadata_get(s->metadata, tag2, t2, AV_METADATA_IGNORE_SUFFIX))) {
         len2 = strlen(t2->key);
         if (len2 == len+4 && !strcmp(t->value, t2->value)
-            && (l=ff_mov_iso639_to_lang(&t2->key[len2-3], 0)) >= 0) {
+            && (l=ff_mov_iso639_to_lang(&t2->key[len2-3], 1)) >= 0) {
             lang = l;
             break;
         }
@@ -1341,12 +1429,9 @@
     AVMetadataTag *t = av_metadata_get(s->metadata, "track", NULL, 0);
     int size = 0, track = t ? atoi(t->value) : 0;
     if (track) {
-        int64_t pos = url_ftell(pb);
-        put_be32(pb, 0); /* size */
+        put_be32(pb, 32); /* size */
         put_tag(pb, "trkn");
-        {
-            int64_t pos = url_ftell(pb);
-            put_be32(pb, 0); /* size */
+            put_be32(pb, 24); /* size */
             put_tag(pb, "data");
             put_be32(pb, 0);        // 8 bytes empty
             put_be32(pb, 0);
@@ -1354,9 +1439,7 @@
             put_be16(pb, track);    // track number
             put_be16(pb, 0);        // total track number
             put_be16(pb, 0);        // empty
-            updateSize(pb, pos);
-        }
-        size = updateSize(pb, pos);
+        size = 32;
     }
     return size;
 }
@@ -1369,14 +1452,22 @@
     put_be32(pb, 0); /* size */
     put_tag(pb, "ilst");
     mov_write_string_metadata(s, pb, "\251nam", "title"    , 1);
-    mov_write_string_metadata(s, pb, "\251ART", "author"   , 1);
-    mov_write_string_metadata(s, pb, "\251wrt", "author"   , 1);
+    mov_write_string_metadata(s, pb, "\251ART", "artist"   , 1);
+    mov_write_string_metadata(s, pb, "aART", "album_artist", 1);
+    mov_write_string_metadata(s, pb, "\251wrt", "composer" , 1);
     mov_write_string_metadata(s, pb, "\251alb", "album"    , 1);
-    mov_write_string_metadata(s, pb, "\251day", "year"     , 1);
+    mov_write_string_metadata(s, pb, "\251day", "date"     , 1);
     mov_write_string_tag(pb, "\251too", LIBAVFORMAT_IDENT, 0, 1);
     mov_write_string_metadata(s, pb, "\251cmt", "comment"  , 1);
     mov_write_string_metadata(s, pb, "\251gen", "genre"    , 1);
     mov_write_string_metadata(s, pb, "\251cpy", "copyright", 1);
+    mov_write_string_metadata(s, pb, "\251grp", "grouping" , 1);
+    mov_write_string_metadata(s, pb, "\251lyr", "lyrics"   , 1);
+    mov_write_string_metadata(s, pb, "desc",    "description",1);
+    mov_write_string_metadata(s, pb, "ldes",    "synopsis" , 1);
+    mov_write_string_metadata(s, pb, "tvsh",    "show"     , 1);
+    mov_write_string_metadata(s, pb, "tven",    "episode_id",1);
+    mov_write_string_metadata(s, pb, "tvnn",    "network"  , 1);
     mov_write_trkn_tag(pb, mov, s);
     return updateSize(pb, pos);
 }
@@ -1439,12 +1530,38 @@
         put_be16(pb, language_code("eng")); /* language */
         put_buffer(pb, t->value, strlen(t->value)+1); /* UTF8 string value */
         if (!strcmp(tag, "albm") &&
-            (t = av_metadata_get(s->metadata, "year", NULL, 0)))
+            (t = av_metadata_get(s->metadata, "track", NULL, 0)))
             put_byte(pb, atoi(t->value));
     }
     return updateSize(pb, pos);
 }
 
+static int mov_write_chpl_tag(ByteIOContext *pb, AVFormatContext *s)
+{
+    int64_t pos = url_ftell(pb);
+    int i, nb_chapters = FFMIN(s->nb_chapters, 255);
+
+    put_be32(pb, 0);            // size
+    put_tag (pb, "chpl");
+    put_be32(pb, 0x01000000);   // version + flags
+    put_be32(pb, 0);            // unknown
+    put_byte(pb, nb_chapters);
+
+    for (i = 0; i < nb_chapters; i++) {
+        AVChapter *c = s->chapters[i];
+        AVMetadataTag *t;
+        put_be64(pb, av_rescale_q(c->start, c->time_base, (AVRational){1,10000000}));
+
+        if ((t = av_metadata_get(c->metadata, "title", NULL, 0))) {
+            int len = FFMIN(strlen(t->value), 255);
+            put_byte(pb, len);
+            put_buffer(pb, t->value, len);
+        } else
+            put_byte(pb, 0);
+    }
+    return updateSize(pb, pos);
+}
+
 static int mov_write_udta_tag(ByteIOContext *pb, MOVMuxContext *mov,
                               AVFormatContext *s)
 {
@@ -1462,18 +1579,19 @@
         return ret;
 
         if (mov->mode & MODE_3GP) {
+            mov_write_3gp_udta_tag(pb_buf, s, "perf", "artist");
             mov_write_3gp_udta_tag(pb_buf, s, "titl", "title");
             mov_write_3gp_udta_tag(pb_buf, s, "auth", "author");
             mov_write_3gp_udta_tag(pb_buf, s, "gnre", "genre");
             mov_write_3gp_udta_tag(pb_buf, s, "dscp", "comment");
             mov_write_3gp_udta_tag(pb_buf, s, "albm", "album");
             mov_write_3gp_udta_tag(pb_buf, s, "cprt", "copyright");
-            mov_write_3gp_udta_tag(pb_buf, s, "yrrc", "year");
+            mov_write_3gp_udta_tag(pb_buf, s, "yrrc", "date");
         } else if (mov->mode == MODE_MOV) { // the title field breaks gtkpod with mp4 and my suspicion is that stuff is not valid in mp4
             mov_write_string_metadata(s, pb_buf, "\251nam", "title"      , 0);
             mov_write_string_metadata(s, pb_buf, "\251aut", "author"     , 0);
             mov_write_string_metadata(s, pb_buf, "\251alb", "album"      , 0);
-            mov_write_string_metadata(s, pb_buf, "\251day", "year"       , 0);
+            mov_write_string_metadata(s, pb_buf, "\251day", "date"       , 0);
             mov_write_string_tag(pb_buf, "\251enc", LIBAVFORMAT_IDENT, 0, 0);
             mov_write_string_metadata(s, pb_buf, "\251des", "comment"    , 0);
             mov_write_string_metadata(s, pb_buf, "\251gen", "genre"      , 0);
@@ -1483,6 +1601,9 @@
             mov_write_meta_tag(pb_buf, mov, s);
         }
 
+        if (s->nb_chapters)
+            mov_write_chpl_tag(pb_buf, s);
+
     if ((size = url_close_dyn_buf(pb_buf, &buf)) > 0) {
         put_be32(pb, size+8);
         put_tag(pb, "udta");
@@ -1551,7 +1672,6 @@
     int64_t pos = url_ftell(pb);
     put_be32(pb, 0); /* size placeholder*/
     put_tag(pb, "moov");
-    mov->timescale = globalTimescale;
 
     for (i=0; i<mov->nb_streams; i++) {
         if(mov->tracks[i].entry <= 0) continue;
@@ -1560,11 +1680,24 @@
         mov->tracks[i].trackID = i+1;
     }
 
+    if (mov->chapter_track)
+        for (i=0; i<s->nb_streams; i++) {
+            mov->tracks[i].tref_tag = MKTAG('c','h','a','p');
+            mov->tracks[i].tref_id = mov->tracks[mov->chapter_track].trackID;
+        }
+    for (i = 0; i < mov->nb_streams; i++) {
+        if (mov->tracks[i].tag == MKTAG('r','t','p',' ')) {
+            mov->tracks[i].tref_tag = MKTAG('h','i','n','t');
+            mov->tracks[i].tref_id =
+                mov->tracks[mov->tracks[i].src_track].trackID;
+        }
+    }
+
     mov_write_mvhd_tag(pb, mov);
     //mov_write_iods_tag(pb, mov);
     for (i=0; i<mov->nb_streams; i++) {
         if(mov->tracks[i].entry > 0) {
-            mov_write_trak_tag(pb, &(mov->tracks[i]), s->streams[i]);
+            mov_write_trak_tag(pb, &(mov->tracks[i]), i < s->nb_streams ? s->streams[i] : NULL);
         }
     }
 
@@ -1598,7 +1731,7 @@
 
     for (i = 0; i < s->nb_streams; i++) {
         AVStream *st = s->streams[i];
-        if (st->codec->codec_type == CODEC_TYPE_VIDEO)
+        if (st->codec->codec_type == AVMEDIA_TYPE_VIDEO)
             has_video = 1;
         if (st->codec->codec_id == CODEC_ID_H264)
             has_h264 = 1;
@@ -1705,111 +1838,6 @@
     put_be32(pb, 0x010001); /* ? */
 }
 
-static int mov_write_header(AVFormatContext *s)
-{
-    ByteIOContext *pb = s->pb;
-    MOVMuxContext *mov = s->priv_data;
-    int i;
-
-    if (url_is_streamed(s->pb)) {
-        av_log(s, AV_LOG_ERROR, "muxer does not support non seekable output\n");
-        return -1;
-    }
-
-    /* Default mode == MP4 */
-    mov->mode = MODE_MP4;
-
-    if (s->oformat != NULL) {
-        if (!strcmp("3gp", s->oformat->name)) mov->mode = MODE_3GP;
-        else if (!strcmp("3g2", s->oformat->name)) mov->mode = MODE_3GP|MODE_3G2;
-        else if (!strcmp("mov", s->oformat->name)) mov->mode = MODE_MOV;
-        else if (!strcmp("psp", s->oformat->name)) mov->mode = MODE_PSP;
-        else if (!strcmp("ipod",s->oformat->name)) mov->mode = MODE_IPOD;
-
-        mov_write_ftyp_tag(pb,s);
-        if (mov->mode == MODE_PSP) {
-            if (s->nb_streams != 2) {
-                av_log(s, AV_LOG_ERROR, "PSP mode need one video and one audio stream\n");
-                return -1;
-            }
-            mov_write_uuidprof_tag(pb,s);
-        }
-    }
-
-    mov->tracks = av_mallocz(s->nb_streams*sizeof(*mov->tracks));
-    if (!mov->tracks)
-        return AVERROR(ENOMEM);
-
-    for(i=0; i<s->nb_streams; i++){
-        AVStream *st= s->streams[i];
-        MOVTrack *track= &mov->tracks[i];
-        AVMetadataTag *lang = av_metadata_get(st->metadata, "language", NULL,0);
-
-        track->enc = st->codec;
-        track->language = ff_mov_iso639_to_lang(lang?lang->value:"und", mov->mode!=MODE_MOV);
-        if (track->language < 0)
-            track->language = 0;
-        track->mode = mov->mode;
-        track->tag = mov_find_codec_tag(s, track);
-        if (!track->tag) {
-            av_log(s, AV_LOG_ERROR, "track %d: could not find tag, "
-                   "codec not currently supported in container\n", i);
-            goto error;
-        }
-        if(st->codec->codec_type == CODEC_TYPE_VIDEO){
-            if (track->tag == MKTAG('m','x','3','p') || track->tag == MKTAG('m','x','3','n') ||
-                track->tag == MKTAG('m','x','4','p') || track->tag == MKTAG('m','x','4','n') ||
-                track->tag == MKTAG('m','x','5','p') || track->tag == MKTAG('m','x','5','n')) {
-                if (st->codec->width != 720 || (st->codec->height != 608 && st->codec->height != 512)) {
-                    av_log(s, AV_LOG_ERROR, "D-10/IMX must use 720x608 or 720x512 video resolution\n");
-                    goto error;
-                }
-                track->height = track->tag>>24 == 'n' ? 486 : 576;
-            }
-            track->timescale = st->codec->time_base.den;
-            if (track->mode == MODE_MOV && track->timescale > 100000)
-                av_log(s, AV_LOG_WARNING,
-                       "WARNING codec timebase is very high. If duration is too long,\n"
-                       "file may not be playable by quicktime. Specify a shorter timebase\n"
-                       "or choose different container.\n");
-        }else if(st->codec->codec_type == CODEC_TYPE_AUDIO){
-            track->timescale = st->codec->sample_rate;
-            if(!st->codec->frame_size && !av_get_bits_per_sample(st->codec->codec_id)) {
-                av_log(s, AV_LOG_ERROR, "track %d: codec frame size is not set\n", i);
-                goto error;
-            }else if(st->codec->frame_size > 1){ /* assume compressed audio */
-                track->audio_vbr = 1;
-            }else{
-                st->codec->frame_size = 1;
-                track->sampleSize = (av_get_bits_per_sample(st->codec->codec_id) >> 3) * st->codec->channels;
-            }
-            if(track->mode != MODE_MOV &&
-               track->enc->codec_id == CODEC_ID_MP3 && track->enc->sample_rate < 16000){
-                av_log(s, AV_LOG_ERROR, "track %d: muxing mp3 at %dhz is not supported\n",
-                       i, track->enc->sample_rate);
-                goto error;
-            }
-        }else if(st->codec->codec_type == CODEC_TYPE_SUBTITLE){
-            track->timescale = st->codec->time_base.den;
-        }
-        if (!track->height)
-            track->height = st->codec->height;
-
-        av_set_pts_info(st, 64, 1, track->timescale);
-    }
-
-    mov_write_mdat_tag(pb, mov);
-    mov->time = s->timestamp + 0x7C25B080; //1970 based -> 1904 based
-    mov->nb_streams = s->nb_streams;
-
-    put_flush_packet(pb);
-
-    return 0;
- error:
-    av_freep(&mov->tracks);
-    return -1;
-}
-
 static int mov_parse_mpeg2_frame(AVPacket *pkt, uint32_t *flags)
 {
     uint32_t c = -1;
@@ -1831,7 +1859,7 @@
     return 0;
 }
 
-static int mov_write_packet(AVFormatContext *s, AVPacket *pkt)
+int ff_mov_write_packet(AVFormatContext *s, AVPacket *pkt)
 {
     MOVMuxContext *mov = s->priv_data;
     ByteIOContext *pb = s->pb;
@@ -1908,7 +1936,7 @@
         trk->flags |= MOV_TRACK_CTTS;
     trk->cluster[trk->entry].cts = pkt->pts - pkt->dts;
     trk->cluster[trk->entry].flags = 0;
-    if (pkt->flags & PKT_FLAG_KEY) {
+    if (pkt->flags & AV_PKT_FLAG_KEY) {
         if (mov->mode == MODE_MOV && enc->codec_id == CODEC_ID_MPEG2VIDEO) {
             mov_parse_mpeg2_frame(pkt, &trk->cluster[trk->entry].flags);
             if (trk->cluster[trk->entry].flags & MOV_PARTIAL_SYNC_SAMPLE)
@@ -1924,9 +1952,191 @@
     mov->mdat_size += size;
 
     put_flush_packet(pb);
+
+    if (trk->hint_track >= 0 && trk->hint_track < mov->nb_streams)
+        ff_mov_add_hinted_packet(s, pkt, trk->hint_track, trk->entry);
     return 0;
 }
 
+// QuickTime chapters involve an additional text track with the chapter names
+// as samples, and a tref pointing from the other tracks to the chapter one.
+static void mov_create_chapter_track(AVFormatContext *s, int tracknum)
+{
+    MOVMuxContext *mov = s->priv_data;
+    MOVTrack *track = &mov->tracks[tracknum];
+    AVPacket pkt = { .stream_index = tracknum, .flags = AV_PKT_FLAG_KEY };
+    int i, len;
+
+    track->mode = mov->mode;
+    track->tag = MKTAG('t','e','x','t');
+    track->timescale = MOV_TIMESCALE;
+    track->enc = avcodec_alloc_context();
+    track->enc->codec_type = AVMEDIA_TYPE_SUBTITLE;
+
+    for (i = 0; i < s->nb_chapters; i++) {
+        AVChapter *c = s->chapters[i];
+        AVMetadataTag *t;
+
+        int64_t end = av_rescale_q(c->end, c->time_base, (AVRational){1,MOV_TIMESCALE});
+        pkt.pts = pkt.dts = av_rescale_q(c->start, c->time_base, (AVRational){1,MOV_TIMESCALE});
+        pkt.duration = end - pkt.dts;
+
+        if ((t = av_metadata_get(c->metadata, "title", NULL, 0))) {
+            len = strlen(t->value);
+            pkt.size = len+2;
+            pkt.data = av_malloc(pkt.size);
+            AV_WB16(pkt.data, len);
+            memcpy(pkt.data+2, t->value, len);
+            ff_mov_write_packet(s, &pkt);
+            av_freep(&pkt.data);
+        }
+    }
+}
+
+static int mov_write_header(AVFormatContext *s)
+{
+    ByteIOContext *pb = s->pb;
+    MOVMuxContext *mov = s->priv_data;
+    int i, hint_track = 0;
+
+    if (url_is_streamed(s->pb)) {
+        av_log(s, AV_LOG_ERROR, "muxer does not support non seekable output\n");
+        return -1;
+    }
+
+    /* Default mode == MP4 */
+    mov->mode = MODE_MP4;
+
+    if (s->oformat != NULL) {
+        if (!strcmp("3gp", s->oformat->name)) mov->mode = MODE_3GP;
+        else if (!strcmp("3g2", s->oformat->name)) mov->mode = MODE_3GP|MODE_3G2;
+        else if (!strcmp("mov", s->oformat->name)) mov->mode = MODE_MOV;
+        else if (!strcmp("psp", s->oformat->name)) mov->mode = MODE_PSP;
+        else if (!strcmp("ipod",s->oformat->name)) mov->mode = MODE_IPOD;
+
+        mov_write_ftyp_tag(pb,s);
+        if (mov->mode == MODE_PSP) {
+            if (s->nb_streams != 2) {
+                av_log(s, AV_LOG_ERROR, "PSP mode need one video and one audio stream\n");
+                return -1;
+            }
+            mov_write_uuidprof_tag(pb,s);
+        }
+    }
+
+    mov->nb_streams = s->nb_streams;
+    if (mov->mode & (MODE_MOV|MODE_IPOD) && s->nb_chapters)
+        mov->chapter_track = mov->nb_streams++;
+
+    if (s->flags & AVFMT_FLAG_RTP_HINT) {
+        /* Add hint tracks for each audio and video stream */
+        hint_track = mov->nb_streams;
+        for (i = 0; i < s->nb_streams; i++) {
+            AVStream *st = s->streams[i];
+            if (st->codec->codec_type == AVMEDIA_TYPE_VIDEO ||
+                st->codec->codec_type == AVMEDIA_TYPE_AUDIO) {
+                mov->nb_streams++;
+            }
+        }
+    }
+
+    mov->tracks = av_mallocz(mov->nb_streams*sizeof(*mov->tracks));
+    if (!mov->tracks)
+        return AVERROR(ENOMEM);
+
+    for(i=0; i<s->nb_streams; i++){
+        AVStream *st= s->streams[i];
+        MOVTrack *track= &mov->tracks[i];
+        AVMetadataTag *lang = av_metadata_get(st->metadata, "language", NULL,0);
+
+        track->enc = st->codec;
+        track->language = ff_mov_iso639_to_lang(lang?lang->value:"und", mov->mode!=MODE_MOV);
+        if (track->language < 0)
+            track->language = 0;
+        track->mode = mov->mode;
+        track->tag = mov_find_codec_tag(s, track);
+        if (!track->tag) {
+            av_log(s, AV_LOG_ERROR, "track %d: could not find tag, "
+                   "codec not currently supported in container\n", i);
+            goto error;
+        }
+        /* If hinting of this track is enabled by a later hint track,
+         * this is updated. */
+        track->hint_track = -1;
+        if(st->codec->codec_type == AVMEDIA_TYPE_VIDEO){
+            if (track->tag == MKTAG('m','x','3','p') || track->tag == MKTAG('m','x','3','n') ||
+                track->tag == MKTAG('m','x','4','p') || track->tag == MKTAG('m','x','4','n') ||
+                track->tag == MKTAG('m','x','5','p') || track->tag == MKTAG('m','x','5','n')) {
+                if (st->codec->width != 720 || (st->codec->height != 608 && st->codec->height != 512)) {
+                    av_log(s, AV_LOG_ERROR, "D-10/IMX must use 720x608 or 720x512 video resolution\n");
+                    goto error;
+                }
+                track->height = track->tag>>24 == 'n' ? 486 : 576;
+            }
+            track->timescale = st->codec->time_base.den;
+            if (track->mode == MODE_MOV && track->timescale > 100000)
+                av_log(s, AV_LOG_WARNING,
+                       "WARNING codec timebase is very high. If duration is too long,\n"
+                       "file may not be playable by quicktime. Specify a shorter timebase\n"
+                       "or choose different container.\n");
+        }else if(st->codec->codec_type == AVMEDIA_TYPE_AUDIO){
+            track->timescale = st->codec->sample_rate;
+            if(!st->codec->frame_size && !av_get_bits_per_sample(st->codec->codec_id)) {
+                av_log(s, AV_LOG_ERROR, "track %d: codec frame size is not set\n", i);
+                goto error;
+            }else if(st->codec->frame_size > 1){ /* assume compressed audio */
+                track->audio_vbr = 1;
+            }else{
+                st->codec->frame_size = 1;
+                track->sampleSize = (av_get_bits_per_sample(st->codec->codec_id) >> 3) * st->codec->channels;
+            }
+            if (track->mode != MODE_MOV) {
+                if (track->timescale > UINT16_MAX) {
+                    av_log(s, AV_LOG_ERROR, "track %d: output format does not support "
+                           "sample rate %dhz\n", i, track->timescale);
+                    goto error;
+                }
+                if (track->enc->codec_id == CODEC_ID_MP3 && track->timescale < 16000) {
+                    av_log(s, AV_LOG_ERROR, "track %d: muxing mp3 at %dhz is not supported\n",
+                           i, track->enc->sample_rate);
+                    goto error;
+                }
+            }
+        }else if(st->codec->codec_type == AVMEDIA_TYPE_SUBTITLE){
+            track->timescale = st->codec->time_base.den;
+        }
+        if (!track->height)
+            track->height = st->codec->height;
+
+        av_set_pts_info(st, 64, 1, track->timescale);
+    }
+
+    mov_write_mdat_tag(pb, mov);
+    mov->time = s->timestamp + 0x7C25B080; //1970 based -> 1904 based
+
+    if (mov->chapter_track)
+        mov_create_chapter_track(s, mov->chapter_track);
+
+    if (s->flags & AVFMT_FLAG_RTP_HINT) {
+        /* Initialize the hint tracks for each audio and video stream */
+        for (i = 0; i < s->nb_streams; i++) {
+            AVStream *st = s->streams[i];
+            if (st->codec->codec_type == AVMEDIA_TYPE_VIDEO ||
+                st->codec->codec_type == AVMEDIA_TYPE_AUDIO) {
+                ff_mov_init_hinting(s, hint_track, i);
+                hint_track++;
+            }
+        }
+    }
+
+    put_flush_packet(pb);
+
+    return 0;
+ error:
+    av_freep(&mov->tracks);
+    return -1;
+}
+
 static int mov_write_trailer(AVFormatContext *s)
 {
     MOVMuxContext *mov = s->priv_data;
@@ -1951,7 +2161,12 @@
 
     mov_write_moov_tag(pb, mov, s);
 
+    if (mov->chapter_track)
+        av_freep(&mov->tracks[mov->chapter_track].enc);
+
     for (i=0; i<mov->nb_streams; i++) {
+        if (mov->tracks[i].tag == MKTAG('r','t','p',' '))
+            ff_mov_close_hinting(&mov->tracks[i]);
         av_freep(&mov->tracks[i].cluster);
 
         if(mov->tracks[i].vosLen) av_free(mov->tracks[i].vosData);
@@ -1975,7 +2190,7 @@
     CODEC_ID_AAC,
     CODEC_ID_MPEG4,
     mov_write_header,
-    mov_write_packet,
+    ff_mov_write_packet,
     mov_write_trailer,
     .flags = AVFMT_GLOBALHEADER | AVFMT_VARIABLE_FPS,
     .codec_tag = (const AVCodecTag* const []){codec_movvideo_tags, codec_movaudio_tags, 0},
@@ -1991,7 +2206,7 @@
     CODEC_ID_AMR_NB,
     CODEC_ID_H263,
     mov_write_header,
-    mov_write_packet,
+    ff_mov_write_packet,
     mov_write_trailer,
     .flags = AVFMT_GLOBALHEADER,
     .codec_tag = (const AVCodecTag* const []){codec_3gp_tags, 0},
@@ -2007,7 +2222,7 @@
     CODEC_ID_AAC,
     CODEC_ID_MPEG4,
     mov_write_header,
-    mov_write_packet,
+    ff_mov_write_packet,
     mov_write_trailer,
     .flags = AVFMT_GLOBALHEADER | AVFMT_VARIABLE_FPS,
     .codec_tag = (const AVCodecTag* const []){ff_mp4_obj_type, 0},
@@ -2023,7 +2238,7 @@
     CODEC_ID_AAC,
     CODEC_ID_MPEG4,
     mov_write_header,
-    mov_write_packet,
+    ff_mov_write_packet,
     mov_write_trailer,
     .flags = AVFMT_GLOBALHEADER,
     .codec_tag = (const AVCodecTag* const []){ff_mp4_obj_type, 0},
@@ -2039,7 +2254,7 @@
     CODEC_ID_AMR_NB,
     CODEC_ID_H263,
     mov_write_header,
-    mov_write_packet,
+    ff_mov_write_packet,
     mov_write_trailer,
     .flags = AVFMT_GLOBALHEADER,
     .codec_tag = (const AVCodecTag* const []){codec_3gp_tags, 0},
@@ -2055,7 +2270,7 @@
     CODEC_ID_AAC,
     CODEC_ID_H264,
     mov_write_header,
-    mov_write_packet,
+    ff_mov_write_packet,
     mov_write_trailer,
     .flags = AVFMT_GLOBALHEADER,
     .codec_tag = (const AVCodecTag* const []){codec_ipod_tags, 0},

Modified: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavformat/mpegenc.c
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavformat/mpegenc.c	2010-05-26 05:26:23 UTC (rev 6232)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavformat/mpegenc.c	2010-05-26 05:26:29 UTC (rev 6233)
@@ -1300,3 +1300,13 @@
     mpeg_mux_end,
 };
 #endif
+// MEANX
+//
+int mpegenc_init(void)
+{
+    av_register_output_format(&mpeg2dvd_muxer);
+    av_register_output_format(&mpeg2svcd_muxer);
+    av_register_output_format(&mpeg2vob_muxer);
+    av_register_output_format(&mpeg1vcd_muxer);
+    return 0;
+}
\ No newline at end of file

Modified: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavformat/mpegtsenc.c
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavformat/mpegtsenc.c	2010-05-26 05:26:23 UTC (rev 6232)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavformat/mpegtsenc.c	2010-05-26 05:26:29 UTC (rev 6233)
@@ -918,3 +918,8 @@
     mpegts_write_packet,
     mpegts_write_end,
 };
+int mpegtsenc_init(void)
+{
+    av_register_output_format(&mpegts_muxer);
+    return 0;
+}
\ No newline at end of file

Modified: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavformat/utils.c
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavformat/utils.c	2010-05-26 05:26:23 UTC (rev 6232)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavformat/utils.c	2010-05-26 05:26:29 UTC (rev 6233)
@@ -49,13 +49,14 @@
 
 const char *avformat_configuration(void)
 {
-    return FFMPEG_CONFIGURATION;
+    return "avidemux"; //FFMPEG_CONFIGURATION;
 }
 
 const char *avformat_license(void)
 {
 #define LICENSE_PREFIX "libavformat license: "
-    return LICENSE_PREFIX FFMPEG_LICENSE + sizeof(LICENSE_PREFIX) - 1;
+    //return LICENSE_PREFIX FFMPEG_LICENSE + sizeof(LICENSE_PREFIX) - 1;
+        return LICENSE_PREFIX "GPL";
 }
 
 /* fraction handling */



From mean at mail.berlios.de  Wed May 26 07:26:33 2010
From: mean at mail.berlios.de (mean at BerliOS)
Date: Wed, 26 May 2010 07:26:33 +0200
Subject: [Avidemux-svn-commit] r6234 - in
	branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavutil:
	. x86
Message-ID: <201005260526.o4Q5QXtV028405@sheep.berlios.de>

Author: mean
Date: 2010-05-26 07:26:32 +0200 (Wed, 26 May 2010)
New Revision: 6234

Modified:
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavutil/CMakeLists.txt
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavutil/avutil.h
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavutil/bswap.h
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavutil/internal.h
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavutil/intreadwrite.h
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavutil/libm.h
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavutil/mem.c
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavutil/timer.h
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavutil/x86/bswap.h
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavutil/x86/intreadwrite.h
Log:
[Merge] libavutil

Modified: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavutil/CMakeLists.txt
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavutil/CMakeLists.txt	2010-05-26 05:26:29 UTC (rev 6233)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavutil/CMakeLists.txt	2010-05-26 05:26:32 UTC (rev 6234)
@@ -24,6 +24,7 @@
 tree.c
 lfg.c
 mem.c
+pixdesc.c
 )
 
 ADD_LIBRARY(${ADM_LIB} SHARED ${${ADM_LIB}_SRCS})

Modified: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavutil/avutil.h
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavutil/avutil.h	2010-05-26 05:26:29 UTC (rev 6233)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavutil/avutil.h	2010-05-26 05:26:32 UTC (rev 6234)
@@ -26,7 +26,14 @@
  * external API header
  */
 
+/* MEANX
+ * - */
+#define ASMALIGN(ZEROBITS) ".p2align " #ZEROBITS "\n\t"
+/* /MEANX
+ */
 
+
+
 #define AV_STRINGIFY(s)         AV_TOSTRING(s)
 #define AV_TOSTRING(s) #s
 

Modified: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavutil/bswap.h
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavutil/bswap.h	2010-05-26 05:26:29 UTC (rev 6233)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavutil/bswap.h	2010-05-26 05:26:32 UTC (rev 6234)
@@ -27,7 +27,11 @@
 #define AVUTIL_BSWAP_H
 
 #include <stdint.h>
+// MEANX
+#ifndef ADM_NO_CONFIG_H
 #include "config.h"
+#endif
+// /MEANX
 #include "attributes.h"
 
 #if   ARCH_ARM

Modified: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavutil/internal.h
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavutil/internal.h	2010-05-26 05:26:29 UTC (rev 6233)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavutil/internal.h	2010-05-26 05:26:32 UTC (rev 6234)
@@ -34,7 +34,11 @@
 #include <stdint.h>
 #include <stddef.h>
 #include <assert.h>
+//MEANX
+#ifndef ADM_NO_CONFIG_H
 #include "config.h"
+#endif
+// /MEANX
 #include "attributes.h"
 #include "timer.h"
 
@@ -95,6 +99,8 @@
 #endif
 
 /* Use to export labels from asm. */
+#include "ADM_mangle.h"
+#if 0 // MEANX
 #define LABEL_MANGLE(a) EXTERN_PREFIX #a
 
 // Use rip-relative addressing if compiling PIC code on x86-64.
@@ -105,7 +111,7 @@
 #endif
 
 #define MANGLE(a) EXTERN_PREFIX LOCAL_MANGLE(a)
-
+#endif // MEANX
 /* debug stuff */
 
 /* dprintf macros */
@@ -134,12 +140,14 @@
 #endif
 
 /* avoid usage of dangerous/inappropriate system functions */
+#if 0 //MEANX
 #undef  malloc
 #define malloc please_use_av_malloc
 #undef  free
 #define free please_use_av_free
 #undef  realloc
 #define realloc please_use_av_realloc
+#endif
 #undef  time
 #define time time_is_forbidden_due_to_security_issues
 #undef  rand

Modified: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavutil/intreadwrite.h
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavutil/intreadwrite.h	2010-05-26 05:26:29 UTC (rev 6233)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavutil/intreadwrite.h	2010-05-26 05:26:32 UTC (rev 6234)
@@ -20,7 +20,12 @@
 #define AVUTIL_INTREADWRITE_H
 
 #include <stdint.h>
+// MEANX
+#ifndef ADM_NO_CONFIG_H
 #include "config.h"
+#endif
+// MEANX
+
 #include "bswap.h"
 #include "common.h"
 

Modified: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavutil/libm.h
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavutil/libm.h	2010-05-26 05:26:29 UTC (rev 6233)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavutil/libm.h	2010-05-26 05:26:32 UTC (rev 6234)
@@ -25,7 +25,11 @@
 #define AVUTIL_LIBM_H
 
 #include <math.h>
+//MEANX
+#ifndef ADM_NO_CONFIG_H
 #include "config.h"
+#endif
+///MEANX
 #include "attributes.h"
 
 #if !HAVE_EXP2

Modified: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavutil/mem.c
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavutil/mem.c	2010-05-26 05:26:29 UTC (rev 6233)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavutil/mem.c	2010-05-26 05:26:32 UTC (rev 6234)
@@ -63,87 +63,110 @@
 
 void *av_malloc(unsigned int size)
 {
-    void *ptr = NULL;
-#if CONFIG_MEMALIGN_HACK
-    long diff;
-#endif
+#ifdef __APPLE__
+	return malloc(size);
+#else
+	char *c;
 
-    /* let's disallow possible ambiguous cases */
-    if(size > (INT_MAX-16) )
-        return NULL;
+	uint64_t l, lorg;
+	uint32_t *backdoor;
 
-#if CONFIG_MEMALIGN_HACK
-    ptr = malloc(size+16);
-    if(!ptr)
-        return ptr;
-    diff= ((-(long)ptr - 1)&15) + 1;
-    ptr = (char*)ptr + diff;
-    ((char*)ptr)[-1]= diff;
-#elif HAVE_POSIX_MEMALIGN
-    if (posix_memalign(&ptr,16,size))
-        ptr = NULL;
-#elif HAVE_MEMALIGN
-    ptr = memalign(16,size);
-    /* Why 64?
-       Indeed, we should align it:
-         on 4 for 386
-         on 16 for 486
-         on 32 for 586, PPro - K6-III
-         on 64 for K7 (maybe for P3 too).
-       Because L1 and L2 caches are aligned on those values.
-       But I don't want to code such logic here!
-     */
-     /* Why 16?
-        Because some CPUs need alignment, for example SSE2 on P4, & most RISC CPUs
-        it will just trigger an exception and the unaligned load will be done in the
-        exception handler or it will just segfault (SSE2 on P4).
-        Why not larger? Because I did not see a difference in benchmarks ...
-     */
-     /* benchmarks with P3
-        memalign(64)+1          3071,3051,3032
-        memalign(64)+2          3051,3032,3041
-        memalign(64)+4          2911,2896,2915
-        memalign(64)+8          2545,2554,2550
-        memalign(64)+16         2543,2572,2563
-        memalign(64)+32         2546,2545,2571
-        memalign(64)+64         2570,2533,2558
+	l = (uint64_t)malloc(size + 32);
 
-        BTW, malloc seems to do 8-byte alignment by default here.
-     */
-#else
-    ptr = malloc(size);
+	// Get next boundary
+	lorg = l;
+	l = (l + 15) & 0xfffffffffffffff0LL;
+	l += 16;
+	c = (char*)l;
+	backdoor = (uint32_t*)(c - 8);
+	*backdoor = (0xdead << 16) + l - lorg;
+	backdoor[1] = size;
+
+	return c;
 #endif
-    return ptr;
 }
 
-void *av_realloc(void *ptr, unsigned int size)
+void *av_realloc(void *ptr, unsigned int newsize)
 {
-#if CONFIG_MEMALIGN_HACK
-    int diff;
-#endif
+#ifdef __APPLE__
+	if (!ptr)
+		return av_malloc(newsize);
 
-    /* let's disallow possible ambiguous cases */
-    if(size > (INT_MAX-16) )
-        return NULL;
+	if (!newsize)
+	{
+		av_free(ptr);
+		return NULL;
+	}
 
-#if CONFIG_MEMALIGN_HACK
-    //FIXME this isn't aligned correctly, though it probably isn't needed
-    if(!ptr) return av_malloc(size);
-    diff= ((char*)ptr)[-1];
-    return (char*)realloc((char*)ptr - diff, size + diff) + diff;
+	return realloc(ptr, newsize);
 #else
-    return realloc(ptr, size);
+	void *nalloc;
+
+	if (!ptr)
+		return av_malloc(newsize);
+
+	if (!newsize) 
+	{
+		av_free(ptr);
+		return NULL;
+	}
+
+	// now we either shrink them or expand them
+	// in case of shrink, we do nothing
+	// in case of expand we have to copy
+	// Do copy everytime (slower)
+	uint32_t *backdoor;
+	uint32_t size, offset;
+	char *c = (char*)ptr;
+
+	backdoor = (uint32_t*)ptr;
+	backdoor -= 2;
+
+	assert(((*backdoor) >> 16) == 0xdead);
+
+	offset = backdoor[0] & 0xffff;
+	size = backdoor[1];
+
+	if(size >= newsize) // do nothing
+		return ptr;
+
+	// Allocate a new one
+	nalloc = av_malloc(newsize);
+	memcpy(nalloc, ptr, size);
+	av_free(ptr);
+
+	return nalloc;
 #endif
 }
 
 void av_free(void *ptr)
 {
-    /* XXX: this test should not be needed on most libcs */
-    if (ptr)
-#if CONFIG_MEMALIGN_HACK
-        free((char*)ptr - ((char*)ptr)[-1]);
+#ifdef __APPLE__
+	if (!ptr)
+		return;
+
+	free(ptr);
 #else
-        free(ptr);
+	uint32_t *backdoor;
+	uint32_t size, offset;
+	char *c = (char*)ptr;
+
+	if (!ptr)
+		return;
+
+	backdoor = (uint32_t*)ptr;
+	backdoor -= 2;
+
+	if (*backdoor == 0xbeefbeef)
+		assert(0);
+
+	assert(((*backdoor) >> 16) == 0xdead);
+
+	offset = backdoor[0] & 0xffff;
+	size = backdoor[1];
+	*backdoor = 0xbeefbeef; // Scratch sig
+
+	free(c - offset);
 #endif
 }
 

Modified: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavutil/timer.h
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavutil/timer.h	2010-05-26 05:26:29 UTC (rev 6233)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavutil/timer.h	2010-05-26 05:26:32 UTC (rev 6234)
@@ -26,8 +26,13 @@
 
 #include <stdlib.h>
 #include <stdint.h>
+// MEANX
+#ifndef ADM_NO_CONFIG_H
 #include "config.h"
+#endif
+// MEANX
 
+
 #if   ARCH_ARM
 #   include "arm/timer.h"
 #elif ARCH_BFIN

Modified: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavutil/x86/bswap.h
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavutil/x86/bswap.h	2010-05-26 05:26:29 UTC (rev 6233)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavutil/x86/bswap.h	2010-05-26 05:26:32 UTC (rev 6234)
@@ -25,7 +25,11 @@
 #define AVUTIL_X86_BSWAP_H
 
 #include <stdint.h>
+// MEANX
+#ifndef ADM_NO_CONFIG_H
 #include "config.h"
+#endif
+// /MEANX
 #include "libavutil/attributes.h"
 
 #define bswap_16 bswap_16

Modified: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavutil/x86/intreadwrite.h
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavutil/x86/intreadwrite.h	2010-05-26 05:26:29 UTC (rev 6233)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavutil/x86/intreadwrite.h	2010-05-26 05:26:32 UTC (rev 6234)
@@ -22,7 +22,11 @@
 #define AVUTIL_X86_INTREADWRITE_H
 
 #include <stdint.h>
+// MEANX
+#ifndef ADM_NO_CONFIG_H
 #include "config.h"
+#endif
+/// MEANX
 #include "libavutil/attributes.h"
 
 #if HAVE_MMX



From mean at mail.berlios.de  Wed May 26 07:26:37 2010
From: mean at mail.berlios.de (mean at BerliOS)
Date: Wed, 26 May 2010 07:26:37 +0200
Subject: [Avidemux-svn-commit] r6235 - in
	branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavcodec:
	. x86
Message-ID: <201005260526.o4Q5QbdV028574@sheep.berlios.de>

Author: mean
Date: 2010-05-26 07:26:35 +0200 (Wed, 26 May 2010)
New Revision: 6235

Modified:
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavcodec/ADM_lavcodec.cpp
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavcodec/CMakeLists.txt
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavcodec/avcodec.h
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavcodec/fft.c
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavcodec/ffv1.c
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavcodec/h263dec.c
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavcodec/mpeg12.c
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavcodec/mpeg12enc.c
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavcodec/mpegvideo.c
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavcodec/mpegvideo_enc.c
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavcodec/png.c
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavcodec/pngdec.c
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavcodec/pngenc.c
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavcodec/utils.c
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavcodec/x86/mathops.h
Log:
[Merge] Libavcodec

Modified: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavcodec/ADM_lavcodec.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavcodec/ADM_lavcodec.cpp	2010-05-26 05:26:32 UTC (rev 6234)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavcodec/ADM_lavcodec.cpp	2010-05-26 05:26:35 UTC (rev 6235)
@@ -1,8 +1,6 @@
+#include "ADM_coreConfig.h"
+#include "ADM_lavcodec.h"
 #include "ADM_default.h"
-extern "C"
-{
-#include "avcodec.h"
-}
 /**
  * 		\fn lavcodec_mm_support
  * 		\brief Give lavcodec CPU supported ( FF_MM_MMX)

Modified: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavcodec/CMakeLists.txt
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavcodec/CMakeLists.txt	2010-05-26 05:26:32 UTC (rev 6234)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavcodec/CMakeLists.txt	2010-05-26 05:26:35 UTC (rev 6235)
@@ -32,7 +32,12 @@
 	ADM_lavcodec.cpp  pthread.c  huffman.c  wmv2dec.c  wmv2.c  h264pred.c  intrax8.c
 	intrax8dsp.c  dnxhddata.c  faanidct.c    aac_ac3_parser.c
         celp_math.c options.c aandcttab.c audioconvert.c mpeg4audio.c svq1dec.c celp_filters.c
-	aac_parser.c  mpegaudiodecheader.c)
+	aac_parser.c  mpegaudiodecheader.c
+        flvenc.c indeo5.c mpegaudiodec_float.c mpeg4video.c mpeg4videoenc.c dwt.c  h264_refs.c
+        ivi_common.c dcadsp.c h264_direct.c ivi_dsp.c ituh263dec.c dvdata.c ituh263enc.c aacsbr.c
+        synth_filter.c    mpeg4videodec.c h264_cabac.c h264_cavlc.c vp56dsp.c h264_loopfilter.c
+        h264_sei.c h264_ps.c svq3.c h264dsp.c flvdec.c
+        )
 
 if(USE_VDPAU)
 	SET(${ADM_LIB}_SRCS  ${${ADM_LIB}_SRCS} vdpau.c)

Modified: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavcodec/avcodec.h
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavcodec/avcodec.h	2010-05-26 05:26:32 UTC (rev 6234)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavcodec/avcodec.h	2010-05-26 05:26:35 UTC (rev 6235)
@@ -599,6 +599,8 @@
 #define CODEC_FLAG2_PSY           0x00080000 ///< Use psycho visual optimizations.
 #define CODEC_FLAG2_SSIM          0x00100000 ///< Compute SSIM during encoding, error[] values are undefined.
 #define CODEC_FLAG2_INTRA_REFRESH 0x00200000 ///< Use periodic insertion of intra blocks instead of keyframes.
+//MEANX: NEVER EVER USE CLOSED GOP ?
+#define CODEC_FLAG2_32_PULLDOWN   0x80000000 
 
 /* Unsupported options :
  *              Syntax Arithmetic coding (SAC)
@@ -1469,6 +1471,7 @@
      * - decoding: unused
      */
     int rc_max_rate;
+    int rc_max_rate_header; /*< That one is set in the header MEANX */
 
     /**
      * minimum bitrate
@@ -1483,6 +1486,8 @@
      * - decoding: unused
      */
     int rc_buffer_size;
+    int rc_buffer_size_header;  /*< That one is set in the header MEANX*/
+
     float rc_buffer_aggressivity;
 
     /**

Modified: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavcodec/fft.c
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavcodec/fft.c	2010-05-26 05:26:32 UTC (rev 6234)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavcodec/fft.c	2010-05-26 05:26:35 UTC (rev 6235)
@@ -112,7 +112,7 @@
 
     if (ARCH_ARM)     ff_fft_init_arm(s);
     if (HAVE_ALTIVEC) ff_fft_init_altivec(s);
-    if (HAVE_MMX)     ff_fft_init_mmx(s);
+    // MEANX if (HAVE_MMX)     ff_fft_init_mmx(s);
 
     if (s->split_radix) {
         for(j=4; j<=nbits; j++) {

Modified: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavcodec/ffv1.c
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavcodec/ffv1.c	2010-05-26 05:26:32 UTC (rev 6234)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavcodec/ffv1.c	2010-05-26 05:26:35 UTC (rev 6235)
@@ -1107,6 +1107,8 @@
         clear_state(f);
     }else{
         p->key_frame= 0;
+         p->pict_type= FF_P_TYPE; // MEANX : looks more like a P to me as user
+
     }
     if(f->ac>1){
         int i;

Modified: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavcodec/h263dec.c
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavcodec/h263dec.c	2010-05-26 05:26:32 UTC (rev 6234)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavcodec/h263dec.c	2010-05-26 05:26:35 UTC (rev 6235)
@@ -119,7 +119,24 @@
 
     return 0;
 }
+/* MeanX : Ugly patch to detect vo ppacked stuff ... */
+int av_is_voppacked(AVCodecContext *avctx, int *vop_packed, int *gmc, int *qpel)
+{
+    MpegEncContext *s = avctx->priv_data;
+    // set sane default
+    *vop_packed=0;
+    *gmc=0;
+    *qpel=0;
+    if(avctx->codec->id!=CODEC_ID_MPEG4) return 0;
+    	
+  	*vop_packed=(s->divx_packed);
+	*qpel=s->quarter_sample;
+	*gmc=0;	// FIXME
+	return 1;
 
+  }
+  /* MeanX */
+
 av_cold int ff_h263_decode_end(AVCodecContext *avctx)
 {
     MpegEncContext *s = avctx->priv_data;
@@ -414,6 +431,12 @@
     } else {
         ret = h263_decode_picture_header(s);
     }
+	//MEANX we need to do it here also for quicktime file / ctts atom 
+        // we need the correct frame type, and qt file may contain 
+        // vop not coded frame.
+        pict->pict_type=s->current_picture.pict_type= s->pict_type;
+        pict->key_frame=s->current_picture.key_frame= s->pict_type == FF_I_TYPE;
+        //MEANX
 
     if(ret==FRAME_SKIPPED) return get_consumed_bytes(s, buf_size);
 
@@ -707,6 +730,14 @@
 
 assert(s->current_picture.pict_type == s->current_picture_ptr->pict_type);
 assert(s->current_picture.pict_type == s->pict_type);
+/* MEANX */
+  if(s->current_picture_ptr)
+      s->current_picture_ptr->opaque=pict->opaque;
+/* MEANX */
+
+
+
+
     if (s->pict_type == FF_B_TYPE || s->low_delay) {
         *pict= *(AVFrame*)s->current_picture_ptr;
     } else if (s->last_picture_ptr != NULL) {

Modified: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavcodec/mpeg12.c
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavcodec/mpeg12.c	2010-05-26 05:26:32 UTC (rev 6234)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavcodec/mpeg12.c	2010-05-26 05:26:35 UTC (rev 6235)
@@ -1948,7 +1948,12 @@
         ff_er_frame_end(s);
 
         MPV_frame_end(s);
+/* MEANX */
+  if(s->current_picture_ptr)
+      s->current_picture_ptr->opaque=pict->opaque;
+/* MEANX */
 
+
         if (s->pict_type == FF_B_TYPE || s->low_delay) {
             *pict= *(AVFrame*)s->current_picture_ptr;
             ff_print_debug_info(s, pict);

Modified: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavcodec/mpeg12enc.c
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavcodec/mpeg12enc.c	2010-05-26 05:26:32 UTC (rev 6234)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavcodec/mpeg12enc.c	2010-05-26 05:26:35 UTC (rev 6235)
@@ -127,10 +127,19 @@
             s->frame_rate_index= i;
         }
     }
+ /* MEANX 
+
     if(dmin)
         return -1;
     else
         return 0;
+  */
+        if(dmin>4)
+   {
+        av_log(0,AV_LOG_ERROR,"We did a roundup ! Expect async!\n");
+   }
+        return 0; //MEANX
+
 }
 
 static av_cold int encode_init(AVCodecContext *avctx)
@@ -209,6 +218,7 @@
             put_sbits(&s->pb, 12, s->width );
             put_sbits(&s->pb, 12, s->height);
 
+#if 0 //MEANX
             for(i=1; i<15; i++){
                 float error= aspect_ratio;
                 if(s->codec_id == CODEC_ID_MPEG1VIDEO || i <=1)
@@ -223,20 +233,44 @@
                     s->aspect_ratio_info= i;
                 }
             }
+#endif // MEANX
+            //MEANX put_bits(&s->pb, 4, s->aspect_ratio_info);
+            //MEANX put_bits(&s->pb, 4, s->frame_rate_index);
+ // MEANX 4:3
+  if(s->avctx->sample_aspect_ratio.num==16 && s->avctx->sample_aspect_ratio.den==9)
+            {
+                //printf("FFmpeg : Wide\n");
+                put_bits(&s->pb,4,3); //16:9
+            }
+            else        //4:3
+            {
+              if(s->codec_id == CODEC_ID_MPEG2VIDEO)
+                put_bits(&s->pb, 4, 2);
+              else
+                put_bits(&s->pb, 4, 12); // MPEG1
+            }
+// /MEANX
 
-            put_bits(&s->pb, 4, s->aspect_ratio_info);
-            put_bits(&s->pb, 4, s->frame_rate_index);
+// //MEANX PULLDOWN            put_bits(&s->pb, 4, s->frame_rate_index);
+if((s->flags2 & CODEC_FLAG2_32_PULLDOWN) && (s->codec_id == CODEC_ID_MPEG2VIDEO))
+            {           
+                put_bits(&s->pb, 4,4);
+            }
+            else
+            {                                  
+                put_bits(&s->pb, 4, s->frame_rate_index);
+            } //MEANX pulldown
 
-            if(s->avctx->rc_max_rate){
-                v = (s->avctx->rc_max_rate + 399) / 400;
+            if(s->avctx->rc_max_rate_header){ //MEANX we use header
+                v = (s->avctx->rc_max_rate_header + 399) / 400;
                 if (v > 0x3ffff && s->codec_id == CODEC_ID_MPEG1VIDEO)
                     v = 0x3ffff;
             }else{
                 v= 0x3FFFF;
             }
 
-            if(s->avctx->rc_buffer_size)
-                vbv_buffer_size = s->avctx->rc_buffer_size;
+            if(s->avctx->rc_buffer_size_header) // MEANX we use header
+                vbv_buffer_size = s->avctx->rc_buffer_size_header;
             else
                 /* VBV calculation: Scaled so that a VCD has the proper VBV size of 40 kilobytes */
                 vbv_buffer_size = (( 20 * s->bit_rate) / (1151929 / 2)) * 8 * 1024;
@@ -269,8 +303,17 @@
 
                 put_bits(&s->pb, 3, s->avctx->profile); //profile
                 put_bits(&s->pb, 4, s->avctx->level); //level
+   // MEANX pulldown put_bits(&s->pb, 1, s->progressive_sequence);
+  // MEANX Pulldown
+ if(s->flags2 & CODEC_FLAG2_32_PULLDOWN) //MEANX
+                        put_bits(&s->pb, 1, 0);
+                else
+                        put_bits(&s->pb, 1, s->progressive_sequence);
 
-                put_bits(&s->pb, 1, s->progressive_sequence);
+
+// /MEANX
+
+
                 put_bits(&s->pb, 2, s->chroma_format);
                 put_bits(&s->pb, 2, s->width >>12);
                 put_bits(&s->pb, 2, s->height>>12);
@@ -339,6 +382,8 @@
 
 void mpeg1_encode_picture_header(MpegEncContext *s, int picture_number)
 {
+	int tff,rff; //MEANX
+
     mpeg1_encode_sequence_header(s);
 
     /* mpeg1 picture header */
@@ -375,6 +420,49 @@
 
     s->frame_pred_frame_dct = 1;
     if(s->codec_id == CODEC_ID_MPEG2VIDEO){
+ /* MEANX -- Pulldown */
+        if(s->flags2 & CODEC_FLAG2_32_PULLDOWN)
+        {
+        
+                switch((s->picture_number - 
+                          s->gop_picture_number)&3)
+                {
+                        case 0:
+                        default:
+                                rff=1;
+                                tff=1;
+                                break;
+                        case 1:
+                                rff=0;
+                                tff=0;
+                                break;
+                        case 2:
+                                rff=1;
+                                tff=0;
+                                break;
+                        case 3:
+                                rff=0;
+                                tff=1;
+                                break;
+                }               
+           }
+        else
+        {
+                if (s->progressive_sequence) 
+                {
+                        tff=0; /* no repeat */
+                } else 
+                {
+                        tff= s->current_picture_ptr->top_field_first;
+                }
+                rff=s->repeat_first_field;
+        
+        }
+
+//               /MEANX pulldown
+
+
+
         put_header(s, EXT_START_CODE);
         put_bits(&s->pb, 4, 8); //pic ext
         if (s->pict_type == FF_P_TYPE || s->pict_type == FF_B_TYPE) {
@@ -393,11 +481,16 @@
 
         assert(s->picture_structure == PICT_FRAME);
         put_bits(&s->pb, 2, s->picture_structure);
+#if 0 //MEANX
+
         if (s->progressive_sequence) {
             put_bits(&s->pb, 1, 0); /* no repeat */
         } else {
             put_bits(&s->pb, 1, s->current_picture_ptr->top_field_first);
         }
+#endif
+         put_bits(&s->pb, 1, tff);  //MEANX PULLDOWN
+
         /* XXX: optimize the generation of this flag with entropy
            measures */
         s->frame_pred_frame_dct = s->progressive_sequence;
@@ -407,7 +500,10 @@
         put_bits(&s->pb, 1, s->q_scale_type);
         put_bits(&s->pb, 1, s->intra_vlc_format);
         put_bits(&s->pb, 1, s->alternate_scan);
-        put_bits(&s->pb, 1, s->repeat_first_field);
+ // MEANX put_bits(&s->pb, 1, s->repeat_first_field);
+	put_bits(&s->pb, 1, rff);
+      // /MEANX
+
         s->progressive_frame = s->progressive_sequence;
         put_bits(&s->pb, 1, s->chroma_format == CHROMA_420 ? s->progressive_frame : 0); /* chroma_420_type */
         put_bits(&s->pb, 1, s->progressive_frame);

Modified: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavcodec/mpegvideo.c
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavcodec/mpegvideo.c	2010-05-26 05:26:32 UTC (rev 6234)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavcodec/mpegvideo.c	2010-05-26 05:26:35 UTC (rev 6235)
@@ -641,7 +641,11 @@
     FF_ALLOCZ_OR_GOTO(s->avctx, s->prev_pict_types, PREV_PICT_TYPES_BUFFER_SIZE, fail);
 
     s->parse_context.state= -1;
-    if((s->avctx->debug&(FF_DEBUG_VIS_QP|FF_DEBUG_VIS_MB_TYPE)) || (s->avctx->debug_mv)){
+ //MEANX: Allocate them always, as they may be free when we decode 1st image
+
+    // MEANXif((s->avctx->debug&(FF_DEBUG_VIS_QP|FF_DEBUG_VIS_MB_TYPE)) || (s->avctx->debug_mv)){
+if(1){ // MEANX
+
        s->visualization_buffer[0] = av_malloc((s->mb_width*16 + 2*EDGE_WIDTH) * s->mb_height*16 + 2*EDGE_WIDTH);
        s->visualization_buffer[1] = av_malloc((s->mb_width*16 + 2*EDGE_WIDTH) * s->mb_height*16 + 2*EDGE_WIDTH);
        s->visualization_buffer[2] = av_malloc((s->mb_width*16 + 2*EDGE_WIDTH) * s->mb_height*16 + 2*EDGE_WIDTH);

Modified: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavcodec/mpegvideo_enc.c
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavcodec/mpegvideo_enc.c	2010-05-26 05:26:32 UTC (rev 6234)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavcodec/mpegvideo_enc.c	2010-05-26 05:26:35 UTC (rev 6235)
@@ -367,12 +367,14 @@
 
         av_log(avctx, AV_LOG_INFO, "Warning vbv_delay will be set to 0xFFFF (=VBR) as the specified vbv buffer is too large for the given bitrate!\n");
     }
+#if 0 //MEANX
 
     if((s->flags & CODEC_FLAG_4MV) && s->codec_id != CODEC_ID_MPEG4
        && s->codec_id != CODEC_ID_H263 && s->codec_id != CODEC_ID_H263P && s->codec_id != CODEC_ID_FLV1){
         av_log(avctx, AV_LOG_ERROR, "4MV not supported by codec\n");
         return -1;
     }
+#endif
 
     if(s->obmc && s->avctx->mb_decision != FF_MB_DECISION_SIMPLE){
         av_log(avctx, AV_LOG_ERROR, "OBMC is only supported with simple mb decision\n");
@@ -413,10 +415,12 @@
         return -1;
     }
 
+#if 0 //MEANX
     if(s->mpeg_quant && s->codec_id != CODEC_ID_MPEG4){ //FIXME mpeg2 uses that too
         av_log(avctx, AV_LOG_ERROR, "mpeg2 style quantization not supported by codec\n");
         return -1;
     }
+#endif
 
     if((s->flags & CODEC_FLAG_CBP_RD) && !avctx->trellis){
         av_log(avctx, AV_LOG_ERROR, "CBP RD needs trellis quant\n");

Modified: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavcodec/png.c
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavcodec/png.c	2010-05-26 05:26:32 UTC (rev 6234)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavcodec/png.c	2010-05-26 05:26:35 UTC (rev 6235)
@@ -20,7 +20,7 @@
  */
 #include "avcodec.h"
 #include "bytestream.h"
-#include "png.h"
+#include "ffpng.h"
 
 const uint8_t ff_pngsig[8] = {137, 80, 78, 71, 13, 10, 26, 10};
 const uint8_t ff_mngsig[8] = {138, 77, 78, 71, 13, 10, 26, 10};

Modified: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavcodec/pngdec.c
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavcodec/pngdec.c	2010-05-26 05:26:32 UTC (rev 6234)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavcodec/pngdec.c	2010-05-26 05:26:35 UTC (rev 6235)
@@ -20,7 +20,7 @@
  */
 #include "avcodec.h"
 #include "bytestream.h"
-#include "png.h"
+#include "ffpng.h"
 #include "dsputil.h"
 
 /* TODO:

Modified: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavcodec/pngenc.c
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavcodec/pngenc.c	2010-05-26 05:26:32 UTC (rev 6234)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavcodec/pngenc.c	2010-05-26 05:26:35 UTC (rev 6235)
@@ -21,7 +21,7 @@
 #include "avcodec.h"
 #include "bytestream.h"
 #include "dsputil.h"
-#include "png.h"
+#include "ffpng.h"
 
 /* TODO:
  * - add 2, 4 and 16 bit depth support

Modified: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavcodec/utils.c
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavcodec/utils.c	2010-05-26 05:26:32 UTC (rev 6234)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavcodec/utils.c	2010-05-26 05:26:35 UTC (rev 6235)
@@ -643,10 +643,12 @@
 
     if((avctx->codec->capabilities & CODEC_CAP_DELAY) || avpkt->size){
         //FIXME remove the check below _after_ ensuring that all audio check that the available space is enough
+#if 0 // MEANX : Silence
         if(*frame_size_ptr < AVCODEC_MAX_AUDIO_FRAME_SIZE){
             av_log(avctx, AV_LOG_ERROR, "buffer smaller than AVCODEC_MAX_AUDIO_FRAME_SIZE\n");
             return -1;
         }
+#endif
         if(*frame_size_ptr < FF_MIN_BUFFER_SIZE ||
         *frame_size_ptr < avctx->channels * avctx->frame_size * sizeof(int16_t)){
             av_log(avctx, AV_LOG_ERROR, "buffer %d too small\n", *frame_size_ptr);
@@ -921,13 +923,13 @@
 
 const char *avcodec_configuration(void)
 {
-    return FFMPEG_CONFIGURATION;
+    return "avidemux"; //FFMPEG_CONFIGURATION;
 }
 
 const char *avcodec_license(void)
 {
 #define LICENSE_PREFIX "libavcodec license: "
-    return LICENSE_PREFIX FFMPEG_LICENSE + sizeof(LICENSE_PREFIX) - 1;
+    return LICENSE_PREFIX /*FFMPEG_LICENSE*/ "GPL" + sizeof(LICENSE_PREFIX) - 1;
 }
 
 void avcodec_init(void)
@@ -1080,7 +1082,7 @@
         return -1;
     }
 #if !HAVE_MKSTEMP
-    fd = open(*filename, O_RDWR | O_BINARY | O_CREAT, 0444);
+    fd = open(*filename, O_RDWR /* MEANX | O_BINARY*/ | O_CREAT, 0444);
 #else
     snprintf(*filename, len, "/tmp/%sXXXXXX", prefix);
     fd = mkstemp(*filename);

Modified: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavcodec/x86/mathops.h
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavcodec/x86/mathops.h	2010-05-26 05:26:32 UTC (rev 6234)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavcodec/x86/mathops.h	2010-05-26 05:26:35 UTC (rev 6235)
@@ -22,7 +22,12 @@
 #ifndef AVCODEC_X86_MATHOPS_H
 #define AVCODEC_X86_MATHOPS_H
 
+// MEANX
+#ifndef ADM_NO_CONFIG_H
 #include "config.h"
+#endif
+// MEANX
+
 #include "libavutil/common.h"
 
 #if ARCH_X86_32



From mean at mail.berlios.de  Wed May 26 07:26:40 2010
From: mean at mail.berlios.de (mean at BerliOS)
Date: Wed, 26 May 2010 07:26:40 +0200
Subject: [Avidemux-svn-commit] r6236 -
	branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavcodec
Message-ID: <201005260526.o4Q5Qebe028791@sheep.berlios.de>

Author: mean
Date: 2010-05-26 07:26:39 +0200 (Wed, 26 May 2010)
New Revision: 6236

Removed:
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavcodec/png.h
Modified:
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavcodec/ffpng.h
Log:
[Merge] Libavcodec II

Modified: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavcodec/ffpng.h
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavcodec/ffpng.h	2010-05-26 05:26:35 UTC (rev 6235)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavcodec/ffpng.h	2010-05-26 05:26:39 UTC (rev 6236)
@@ -73,4 +73,6 @@
 /* compute the row size of an interleaved pass */
 int ff_png_pass_row_size(int pass, int bits_per_pixel, int width);
 
+void ff_add_png_paeth_prediction(uint8_t *dst, uint8_t *src, uint8_t *top, int w, int bpp);
+
 #endif /* AVCODEC_PNG_H */

Deleted: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavcodec/png.h
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavcodec/png.h	2010-05-26 05:26:35 UTC (rev 6235)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavcodec/png.h	2010-05-26 05:26:39 UTC (rev 6236)
@@ -1,78 +0,0 @@
-/*
- * PNG image format
- * Copyright (c) 2003 Fabrice Bellard
- *
- * This file is part of FFmpeg.
- *
- * FFmpeg is free software; you can redistribute it and/or
- * modify it under the terms of the GNU Lesser General Public
- * License as published by the Free Software Foundation; either
- * version 2.1 of the License, or (at your option) any later version.
- *
- * FFmpeg is distributed in the hope that it will be useful,
- * but WITHOUT ANY WARRANTY; without even the implied warranty of
- * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
- * Lesser General Public License for more details.
- *
- * You should have received a copy of the GNU Lesser General Public
- * License along with FFmpeg; if not, write to the Free Software
- * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA
- */
-
-#ifndef AVCODEC_PNG_H
-#define AVCODEC_PNG_H
-
-#include <stdint.h>
-
-#define PNG_COLOR_MASK_PALETTE    1
-#define PNG_COLOR_MASK_COLOR      2
-#define PNG_COLOR_MASK_ALPHA      4
-
-#define PNG_COLOR_TYPE_GRAY 0
-#define PNG_COLOR_TYPE_PALETTE  (PNG_COLOR_MASK_COLOR | PNG_COLOR_MASK_PALETTE)
-#define PNG_COLOR_TYPE_RGB        (PNG_COLOR_MASK_COLOR)
-#define PNG_COLOR_TYPE_RGB_ALPHA  (PNG_COLOR_MASK_COLOR | PNG_COLOR_MASK_ALPHA)
-#define PNG_COLOR_TYPE_GRAY_ALPHA (PNG_COLOR_MASK_ALPHA)
-
-#define PNG_FILTER_TYPE_LOCO   64
-#define PNG_FILTER_VALUE_NONE  0
-#define PNG_FILTER_VALUE_SUB   1
-#define PNG_FILTER_VALUE_UP    2
-#define PNG_FILTER_VALUE_AVG   3
-#define PNG_FILTER_VALUE_PAETH 4
-#define PNG_FILTER_VALUE_MIXED 5
-
-#define PNG_IHDR      0x0001
-#define PNG_IDAT      0x0002
-#define PNG_ALLIMAGE  0x0004
-#define PNG_PLTE      0x0008
-
-#define NB_PASSES 7
-
-extern const uint8_t ff_pngsig[8];
-extern const uint8_t ff_mngsig[8];
-
-/* Mask to determine which y pixels are valid in a pass */
-extern const uint8_t ff_png_pass_ymask[NB_PASSES];
-
-/* minimum x value */
-extern const uint8_t ff_png_pass_xmin[NB_PASSES];
-
-/* x shift to get row width */
-extern const uint8_t ff_png_pass_xshift[NB_PASSES];
-
-/* Mask to determine which pixels are valid in a pass */
-extern const uint8_t ff_png_pass_mask[NB_PASSES];
-
-void *ff_png_zalloc(void *opaque, unsigned int items, unsigned int size);
-
-void ff_png_zfree(void *opaque, void *ptr);
-
-int ff_png_get_nb_channels(int color_type);
-
-/* compute the row size of an interleaved pass */
-int ff_png_pass_row_size(int pass, int bits_per_pixel, int width);
-
-void ff_add_png_paeth_prediction(uint8_t *dst, uint8_t *src, uint8_t *top, int w, int bpp);
-
-#endif /* AVCODEC_PNG_H */



From mean at mail.berlios.de  Wed May 26 07:26:44 2010
From: mean at mail.berlios.de (mean at BerliOS)
Date: Wed, 26 May 2010 07:26:44 +0200
Subject: [Avidemux-svn-commit] r6237 -
	branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches
Message-ID: <201005260526.o4Q5QiZ4028960@sheep.berlios.de>

Author: mean
Date: 2010-05-26 07:26:42 +0200 (Wed, 26 May 2010)
New Revision: 6237

Added:
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavcodec_fft.c.patch
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavcodec_pngdec.c.patch
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavcodec_pngenc.c.patch
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavcodec_x86_mathops.h
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavformat_utils.c.patch
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavutil_bswap.h.patch
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavutil_intreadwrite.h.patch
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavutil_libm.h.patch
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavutil_timer.h.patch
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavutil_x86_bswap.h
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavutil_x86_intreadwrite.h
Removed:
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/bswap_h.patch
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/internal_h.patch
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/intreadwrite_h.patch
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavutil_lfg.patch
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/timer_h.patch
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/x86_bswap_h.patch
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/x86_mathops_h.patch
Modified:
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavcodec_avcodec.h.patch
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavcodec_ffv1.c.patch
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavcodec_h263dec.c.patch
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavcodec_h264.c.patch
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavcodec_mpeg12.c.patch
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavcodec_mpeg12enc.c.patch
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavcodec_mpegvideo.c.patch
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavcodec_mpegvideo_enc.c.patch
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavcodec_png.patch
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavcodec_utils.c.patch
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavutil_avutil.h.patch
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavutil_internal.h.patch
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavutil_mem.c.patch
Log:
[libavcodec/libavutil/libavformat] Patches

Deleted: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/bswap_h.patch
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/bswap_h.patch	2010-05-26 05:26:39 UTC (rev 6236)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/bswap_h.patch	2010-05-26 05:26:42 UTC (rev 6237)
@@ -1,17 +0,0 @@
-diff --git a/avidemux/ADM_libraries/ADM_ffmpeg/libavutil/bswap.h b/avidemux/ADM_libraries/ADM_ffmpeg/libavutil/bswap.h
-index cf68c43..9b299a6 100644
---- libavutil/bswap.h
-+++ libavutil/bswap.h
-@@ -27,7 +27,12 @@
- #define AVUTIL_BSWAP_H
- 
- #include <stdint.h>
-+// MEANX
-+#ifndef ADM_NO_CONFIG_H
- #include "config.h"
-+#endif
-+// MEANX
-+
- #include "common.h"
- 
- #if   ARCH_ARM

Deleted: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/internal_h.patch
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/internal_h.patch	2010-05-26 05:26:39 UTC (rev 6236)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/internal_h.patch	2010-05-26 05:26:42 UTC (rev 6237)
@@ -1,16 +0,0 @@
-diff --git a/avidemux/ADM_libraries/ADM_ffmpeg/libavutil/internal.h b/avidemux/ADM_libraries/ADM_ffmpeg/libavutil/internal.h
-index 7a38fb1..bf845f8 100644
---- libavutil/internal.h
-+++ libavutil/internal.h
-@@ -34,7 +34,11 @@
- #include <stdint.h>
- #include <stddef.h>
- #include <assert.h>
-+// MEANX
-+#ifndef ADM_NO_CONFIG_H
- #include "config.h"
-+#endif
-+// MEANX
- #include "common.h"
- #include "mem.h"
- #include "timer.h"

Deleted: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/intreadwrite_h.patch
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/intreadwrite_h.patch	2010-05-26 05:26:39 UTC (rev 6236)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/intreadwrite_h.patch	2010-05-26 05:26:42 UTC (rev 6237)
@@ -1,17 +0,0 @@
-diff --git a/avidemux/ADM_libraries/ADM_ffmpeg/libavutil/intreadwrite.h b/avidemux/ADM_libraries/ADM_ffmpeg/libavutil/intreadwrite.h
-index 5e55327..2c5c68d 100644
---- libavutil/intreadwrite.h
-+++ libavutil/intreadwrite.h
-@@ -20,7 +20,12 @@
- #define AVUTIL_INTREADWRITE_H
- 
- #include <stdint.h>
-+// MEANX
-+#ifndef ADM_NO_CONFIG_H
- #include "config.h"
-+#endif
-+// MEANX
-+
- #include "bswap.h"
- 
- /*

Modified: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavcodec_avcodec.h.patch
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavcodec_avcodec.h.patch	2010-05-26 05:26:39 UTC (rev 6236)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavcodec_avcodec.h.patch	2010-05-26 05:26:42 UTC (rev 6237)
@@ -1,34 +1,30 @@
-*** libavcodec/avcodec.h.old	Wed Apr  1 18:35:35 2009
---- libavcodec/avcodec.h	Wed Apr  1 18:35:35 2009
-***************
-*** 505,510 ****
---- 505,512 ----
-  #define CODEC_FLAG2_CHUNKS        0x00008000 ///< Input bitstream might be truncated at a packet boundaries instead of only at frame boundaries.
-  #define CODEC_FLAG2_NON_LINEAR_QUANT 0x00010000 ///< Use MPEG-2 nonlinear quantizer.
-  #define CODEC_FLAG2_BIT_RESERVOIR 0x00020000 ///< Use a bit reservoir when encoding if possible
-+ //MEANX: NEVER EVER USE CLOSED GOP ?
-+ #define CODEC_FLAG2_32_PULLDOWN   0x80000000 
-  
-  /* Unsupported options :
-   *              Syntax Arithmetic coding (SAC)
-***************
-*** 1302,1307 ****
---- 1304,1310 ----
-       * - decoding: unused
-       */
-      int rc_max_rate;
-+     int rc_max_rate_header; /*< That one is set in the header MEANX */
-  
-      /**
-       * minimum bitrate
-***************
-*** 1316,1321 ****
---- 1319,1326 ----
-       * - decoding: unused
-       */
-      int rc_buffer_size;
-+     int rc_buffer_size_header;  /*< That one is set in the header MEANX*/
-+ 
-      float rc_buffer_aggressivity;
-  
-      /**
+diff --git a/avidemux_core/ADM_ffmpeg/libavcodec/avcodec.h b/avidemux_core/ADM_ffmpeg/libavcodec/avcodec.h
+index cd642ac..c90eac7 100644
+--- a/avidemux_core/ADM_ffmpeg/libavcodec/avcodec.h
++++ b/avidemux_core/ADM_ffmpeg/libavcodec/avcodec.h
+@@ -599,6 +599,8 @@ typedef struct RcOverride{
+ #define CODEC_FLAG2_PSY           0x00080000 ///< Use psycho visual optimizations.
+ #define CODEC_FLAG2_SSIM          0x00100000 ///< Compute SSIM during encoding, error[] values are undefined.
+ #define CODEC_FLAG2_INTRA_REFRESH 0x00200000 ///< Use periodic insertion of intra blocks instead of keyframes.
++//MEANX: NEVER EVER USE CLOSED GOP ?
++#define CODEC_FLAG2_32_PULLDOWN   0x80000000 
+ 
+ /* Unsupported options :
+  *              Syntax Arithmetic coding (SAC)
+@@ -1469,6 +1471,7 @@ typedef struct AVCodecContext {
+      * - decoding: unused
+      */
+     int rc_max_rate;
++    int rc_max_rate_header; /*< That one is set in the header MEANX */
+ 
+     /**
+      * minimum bitrate
+@@ -1483,6 +1486,8 @@ typedef struct AVCodecContext {
+      * - decoding: unused
+      */
+     int rc_buffer_size;
++    int rc_buffer_size_header;  /*< That one is set in the header MEANX*/
++
+     float rc_buffer_aggressivity;
+ 
+     /**

Added: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavcodec_fft.c.patch
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavcodec_fft.c.patch	2010-05-26 05:26:39 UTC (rev 6236)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavcodec_fft.c.patch	2010-05-26 05:26:42 UTC (rev 6237)
@@ -0,0 +1,13 @@
+diff --git a/avidemux_core/ADM_ffmpeg/libavcodec/fft.c b/avidemux_core/ADM_ffmpeg/libavcodec/fft.c
+index bf240bf..6199d91 100644
+--- a/avidemux_core/ADM_ffmpeg/libavcodec/fft.c
++++ b/avidemux_core/ADM_ffmpeg/libavcodec/fft.c
+@@ -112,7 +112,7 @@ av_cold int ff_fft_init(FFTContext *s, int nbits, int inverse)
+ 
+     if (ARCH_ARM)     ff_fft_init_arm(s);
+     if (HAVE_ALTIVEC) ff_fft_init_altivec(s);
+-    if (HAVE_MMX)     ff_fft_init_mmx(s);
++    // MEANX if (HAVE_MMX)     ff_fft_init_mmx(s);
+ 
+     if (s->split_radix) {
+         for(j=4; j<=nbits; j++) {

Modified: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavcodec_ffv1.c.patch
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavcodec_ffv1.c.patch	2010-05-26 05:26:39 UTC (rev 6236)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavcodec_ffv1.c.patch	2010-05-26 05:26:42 UTC (rev 6237)
@@ -1,13 +1,13 @@
-*** libavcodec/ffv1.c.old	Mon Feb  2 19:49:49 2009
---- libavcodec/ffv1.c	Mon Feb  2 19:49:48 2009
-***************
-*** 959,964 ****
---- 959,966 ----
-          clear_state(f);
-      }else{
-          p->key_frame= 0;
-+          p->pict_type= FF_P_TYPE; // MEANX : looks more like a P to me as user
-+ 
-      }
-      if(!f->plane[0].state && !f->plane[0].vlc_state)
-          return -1;
+diff --git a/avidemux_core/ADM_ffmpeg/libavcodec/ffv1.c b/avidemux_core/ADM_ffmpeg/libavcodec/ffv1.c
+index 12056e1..b2f3efe 100644
+--- a/avidemux_core/ADM_ffmpeg/libavcodec/ffv1.c
++++ b/avidemux_core/ADM_ffmpeg/libavcodec/ffv1.c
+@@ -1107,6 +1107,8 @@ static int decode_frame(AVCodecContext *avctx, void *data, int *data_size, AVPac
+         clear_state(f);
+     }else{
+         p->key_frame= 0;
++         p->pict_type= FF_P_TYPE; // MEANX : looks more like a P to me as user
++
+     }
+     if(f->ac>1){
+         int i;

Modified: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavcodec_h263dec.c.patch
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavcodec_h263dec.c.patch	2010-05-26 05:26:39 UTC (rev 6236)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavcodec_h263dec.c.patch	2010-05-26 05:26:42 UTC (rev 6237)
@@ -1,60 +1,56 @@
-*** libavcodec/h263dec.c.old	Wed Apr  1 18:35:37 2009
---- libavcodec/h263dec.c	Wed Apr  1 18:35:37 2009
-***************
-*** 120,125 ****
---- 120,142 ----
-  
-      return 0;
-  }
-+ /* MeanX : Ugly patch to detect vo ppacked stuff ... */
-+ int av_is_voppacked(AVCodecContext *avctx, int *vop_packed, int *gmc, int *qpel)
-+ {
-+     MpegEncContext *s = avctx->priv_data;
-+     // set sane default
-+     *vop_packed=0;
-+     *gmc=0;
-+     *qpel=0;
-+     if(avctx->codec->id!=CODEC_ID_MPEG4) return 0;
-+     	
-+   	*vop_packed=(s->divx_packed);
-+ 	*qpel=s->quarter_sample;
-+ 	*gmc=0;	// FIXME
-+ 	return 1;
-+ 
-+   }
-+   /* MeanX */
-  
-  av_cold int ff_h263_decode_end(AVCodecContext *avctx)
-  {
-***************
-*** 418,423 ****
---- 435,446 ----
-      } else {
-          ret = h263_decode_picture_header(s);
-      }
-+ 	//MEANX we need to do it here also for quicktime file / ctts atom 
-+         // we need the correct frame type, and qt file may contain 
-+         // vop not coded frame.
-+         pict->pict_type=s->current_picture.pict_type= s->pict_type;
-+         pict->key_frame=s->current_picture.key_frame= s->pict_type == FF_I_TYPE;
-+         //MEANX
-  
-      if(ret==FRAME_SKIPPED) return get_consumed_bytes(s, buf_size);
-  
-***************
-*** 706,711 ****
---- 729,742 ----
-  
-  assert(s->current_picture.pict_type == s->current_picture_ptr->pict_type);
-  assert(s->current_picture.pict_type == s->pict_type);
-+ /* MEANX */
-+   if(s->current_picture_ptr)
-+       s->current_picture_ptr->opaque=pict->opaque;
-+ /* MEANX */
-+ 
-+ 
-+ 
-+ 
-      if (s->pict_type == FF_B_TYPE || s->low_delay) {
-          *pict= *(AVFrame*)s->current_picture_ptr;
-      } else if (s->last_picture_ptr != NULL) {
+diff --git a/avidemux_core/ADM_ffmpeg/libavcodec/h263dec.c b/avidemux_core/ADM_ffmpeg/libavcodec/h263dec.c
+index f5df556..3bc37c0 100644
+--- a/avidemux_core/ADM_ffmpeg/libavcodec/h263dec.c
++++ b/avidemux_core/ADM_ffmpeg/libavcodec/h263dec.c
+@@ -119,6 +119,23 @@ av_cold int ff_h263_decode_init(AVCodecContext *avctx)
+ 
+     return 0;
+ }
++/* MeanX : Ugly patch to detect vo ppacked stuff ... */
++int av_is_voppacked(AVCodecContext *avctx, int *vop_packed, int *gmc, int *qpel)
++{
++    MpegEncContext *s = avctx->priv_data;
++    // set sane default
++    *vop_packed=0;
++    *gmc=0;
++    *qpel=0;
++    if(avctx->codec->id!=CODEC_ID_MPEG4) return 0;
++    	
++  	*vop_packed=(s->divx_packed);
++	*qpel=s->quarter_sample;
++	*gmc=0;	// FIXME
++	return 1;
++
++  }
++  /* MeanX */
+ 
+ av_cold int ff_h263_decode_end(AVCodecContext *avctx)
+ {
+@@ -414,6 +431,12 @@ retry:
+     } else {
+         ret = h263_decode_picture_header(s);
+     }
++	//MEANX we need to do it here also for quicktime file / ctts atom 
++        // we need the correct frame type, and qt file may contain 
++        // vop not coded frame.
++        pict->pict_type=s->current_picture.pict_type= s->pict_type;
++        pict->key_frame=s->current_picture.key_frame= s->pict_type == FF_I_TYPE;
++        //MEANX
+ 
+     if(ret==FRAME_SKIPPED) return get_consumed_bytes(s, buf_size);
+ 
+@@ -707,6 +730,14 @@ intrax8_decoded:
+ 
+ assert(s->current_picture.pict_type == s->current_picture_ptr->pict_type);
+ assert(s->current_picture.pict_type == s->pict_type);
++/* MEANX */
++  if(s->current_picture_ptr)
++      s->current_picture_ptr->opaque=pict->opaque;
++/* MEANX */
++
++
++
++
+     if (s->pict_type == FF_B_TYPE || s->low_delay) {
+         *pict= *(AVFrame*)s->current_picture_ptr;
+     } else if (s->last_picture_ptr != NULL) {

Modified: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavcodec_h264.c.patch
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavcodec_h264.c.patch	2010-05-26 05:26:39 UTC (rev 6236)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavcodec_h264.c.patch	2010-05-26 05:26:42 UTC (rev 6237)
@@ -1,22 +1,22 @@
-*** libavcodec/h264.c.old	Wed Apr  1 18:35:37 2009
---- libavcodec/h264.c	Wed Apr  1 18:35:37 2009
-***************
-*** 8104,8109 ****
---- 8104,8120 ----
-      return 0;
-  }
-  
-+ /* MEANX */
-+ int av_getAVCStreamInfo(AVCodecContext *avctx, uint32_t  *nalSize, uint32_t *isAvc)
-+ {
-+       H264Context *h = avctx->priv_data;
-+       assert(h);
-+       *nalSize=h->nal_length_size;
-+       *isAvc=h->is_avc;
-+ 	return 1;
-+ 
-+   }
-+ /* MeanX */
-  
-  AVCodec h264_decoder = {
-      "h264",
+diff --git a/avidemux_core/ADM_ffmpeg/libavcodec/h264.c b/avidemux_core/ADM_ffmpeg/libavcodec/h264.c
+index e4654f0..cfab425 100644
+--- a/avidemux_core/ADM_ffmpeg/libavcodec/h264.c
++++ b/avidemux_core/ADM_ffmpeg/libavcodec/h264.c
+@@ -3358,6 +3358,17 @@ av_cold int ff_h264_decode_end(AVCodecContext *avctx)
+     return 0;
+ }
+ 
++/* MEANX */
++int av_getAVCStreamInfo(AVCodecContext *avctx, uint32_t  *nalSize, uint32_t *isAvc)
++{
++      H264Context *h = avctx->priv_data;
++      assert(h);
++      *nalSize=h->nal_length_size;
++      *isAvc=h->is_avc;
++	return 1;
++
++  }
++/* MeanX */
+ 
+ AVCodec h264_decoder = {
+     "h264",

Modified: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavcodec_mpeg12.c.patch
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavcodec_mpeg12.c.patch	2010-05-26 05:26:39 UTC (rev 6236)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavcodec_mpeg12.c.patch	2010-05-26 05:26:42 UTC (rev 6237)
@@ -1,16 +1,16 @@
-*** libavcodec/mpeg12.c.old	Wed Apr  1 18:35:38 2009
---- libavcodec/mpeg12.c	Wed Apr  1 18:35:38 2009
-***************
-*** 1952,1957 ****
---- 1952,1962 ----
-          ff_er_frame_end(s);
-  
-          MPV_frame_end(s);
-+ /* MEANX */
-+   if(s->current_picture_ptr)
-+       s->current_picture_ptr->opaque=pict->opaque;
-+ /* MEANX */
-+ 
-  
-          if (s->pict_type == FF_B_TYPE || s->low_delay) {
-              *pict= *(AVFrame*)s->current_picture_ptr;
+diff --git a/avidemux_core/ADM_ffmpeg/libavcodec/mpeg12.c b/avidemux_core/ADM_ffmpeg/libavcodec/mpeg12.c
+index bc9ddcc..036b9ba 100644
+--- a/avidemux_core/ADM_ffmpeg/libavcodec/mpeg12.c
++++ b/avidemux_core/ADM_ffmpeg/libavcodec/mpeg12.c
+@@ -1948,6 +1948,11 @@ static int slice_end(AVCodecContext *avctx, AVFrame *pict)
+         ff_er_frame_end(s);
+ 
+         MPV_frame_end(s);
++/* MEANX */
++  if(s->current_picture_ptr)
++      s->current_picture_ptr->opaque=pict->opaque;
++/* MEANX */
++
+ 
+         if (s->pict_type == FF_B_TYPE || s->low_delay) {
+             *pict= *(AVFrame*)s->current_picture_ptr;

Modified: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavcodec_mpeg12enc.c.patch
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavcodec_mpeg12enc.c.patch	2010-05-26 05:26:39 UTC (rev 6236)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavcodec_mpeg12enc.c.patch	2010-05-26 05:26:42 UTC (rev 6237)
@@ -1,231 +1,190 @@
-*** libavcodec/mpeg12enc.c.old	Sat Jan 24 22:57:41 2009
---- libavcodec/mpeg12enc.c	Sat Jan 24 22:57:40 2009
-***************
-*** 127,136 ****
---- 127,145 ----
-              s->frame_rate_index= i;
-          }
-      }
-+  /* MEANX 
-+ 
-      if(dmin)
-          return -1;
-      else
-          return 0;
-+   */
-+         if(dmin>4)
-+    {
-+         av_log(0,AV_LOG_ERROR,"We did a roundup ! Expect async!\n");
-+    }
-+         return 0; //MEANX
-+ 
-  }
-  
-  static av_cold int encode_init(AVCodecContext *avctx)
-***************
-*** 209,214 ****
---- 218,224 ----
-              put_sbits(&s->pb, 12, s->width );
-              put_sbits(&s->pb, 12, s->height);
-  
-+ #if 0 //MEANX
-              for(i=1; i<15; i++){
-                  float error= aspect_ratio;
-                  if(s->codec_id == CODEC_ID_MPEG1VIDEO || i <=1)
-***************
-*** 223,242 ****
-                      s->aspect_ratio_info= i;
-                  }
-              }
-  
-!             put_bits(&s->pb, 4, s->aspect_ratio_info);
-!             put_bits(&s->pb, 4, s->frame_rate_index);
-! 
-!             if(s->avctx->rc_max_rate){
-!                 v = (s->avctx->rc_max_rate + 399) / 400;
-                  if (v > 0x3ffff && s->codec_id == CODEC_ID_MPEG1VIDEO)
-                      v = 0x3ffff;
-              }else{
-                  v= 0x3FFFF;
-              }
-  
-!             if(s->avctx->rc_buffer_size)
-!                 vbv_buffer_size = s->avctx->rc_buffer_size;
-              else
-                  /* VBV calculation: Scaled so that a VCD has the proper VBV size of 40 kilobytes */
-                  vbv_buffer_size = (( 20 * s->bit_rate) / (1151929 / 2)) * 8 * 1024;
---- 233,276 ----
-                      s->aspect_ratio_info= i;
-                  }
-              }
-+ #endif // MEANX
-+             //MEANX put_bits(&s->pb, 4, s->aspect_ratio_info);
-+             //MEANX put_bits(&s->pb, 4, s->frame_rate_index);
-+  // MEANX 4:3
-+   if(s->avctx->sample_aspect_ratio.num==16 && s->avctx->sample_aspect_ratio.den==9)
-+             {
-+                 //printf("FFmpeg : Wide\n");
-+                 put_bits(&s->pb,4,3); //16:9
-+             }
-+             else        //4:3
-+             {
-+               if(s->codec_id == CODEC_ID_MPEG2VIDEO)
-+                 put_bits(&s->pb, 4, 2);
-+               else
-+                 put_bits(&s->pb, 4, 12); // MPEG1
-+             }
-+ // /MEANX
-+ 
-+ // //MEANX PULLDOWN            put_bits(&s->pb, 4, s->frame_rate_index);
-+ if((s->flags2 & CODEC_FLAG2_32_PULLDOWN) && (s->codec_id == CODEC_ID_MPEG2VIDEO))
-+             {           
-+                 put_bits(&s->pb, 4,4);
-+             }
-+             else
-+             {                                  
-+                 put_bits(&s->pb, 4, s->frame_rate_index);
-+             } //MEANX pulldown
-  
-!             if(s->avctx->rc_max_rate_header){ //MEANX we use header
-!                 v = (s->avctx->rc_max_rate_header + 399) / 400;
-                  if (v > 0x3ffff && s->codec_id == CODEC_ID_MPEG1VIDEO)
-                      v = 0x3ffff;
-              }else{
-                  v= 0x3FFFF;
-              }
-  
-!             if(s->avctx->rc_buffer_size_header) // MEANX we use header
-!                 vbv_buffer_size = s->avctx->rc_buffer_size_header;
-              else
-                  /* VBV calculation: Scaled so that a VCD has the proper VBV size of 40 kilobytes */
-                  vbv_buffer_size = (( 20 * s->bit_rate) / (1151929 / 2)) * 8 * 1024;
-***************
-*** 269,276 ****
-  
-                  put_bits(&s->pb, 3, s->avctx->profile); //profile
-                  put_bits(&s->pb, 4, s->avctx->level); //level
-  
--                 put_bits(&s->pb, 1, s->progressive_sequence);
-                  put_bits(&s->pb, 2, s->chroma_format);
-                  put_bits(&s->pb, 2, s->width >>12);
-                  put_bits(&s->pb, 2, s->height>>12);
---- 303,319 ----
-  
-                  put_bits(&s->pb, 3, s->avctx->profile); //profile
-                  put_bits(&s->pb, 4, s->avctx->level); //level
-+    // MEANX pulldown put_bits(&s->pb, 1, s->progressive_sequence);
-+   // MEANX Pulldown
-+  if(s->flags2 & CODEC_FLAG2_32_PULLDOWN) //MEANX
-+                         put_bits(&s->pb, 1, 0);
-+                 else
-+                         put_bits(&s->pb, 1, s->progressive_sequence);
-+ 
-+ 
-+ // /MEANX
-+ 
-  
-                  put_bits(&s->pb, 2, s->chroma_format);
-                  put_bits(&s->pb, 2, s->width >>12);
-                  put_bits(&s->pb, 2, s->height>>12);
-***************
-*** 334,339 ****
---- 377,384 ----
-  
-  void mpeg1_encode_picture_header(MpegEncContext *s, int picture_number)
-  {
-+ 	int tff,rff; //MEANX
-+ 
-      mpeg1_encode_sequence_header(s);
-  
-      /* mpeg1 picture header */
-***************
-*** 370,375 ****
---- 415,463 ----
-  
-      s->frame_pred_frame_dct = 1;
-      if(s->codec_id == CODEC_ID_MPEG2VIDEO){
-+  /* MEANX -- Pulldown */
-+         if(s->flags2 & CODEC_FLAG2_32_PULLDOWN)
-+         {
-+         
-+                 switch((s->picture_number - 
-+                           s->gop_picture_number)&3)
-+                 {
-+                         case 0:
-+                         default:
-+                                 rff=1;
-+                                 tff=1;
-+                                 break;
-+                         case 1:
-+                                 rff=0;
-+                                 tff=0;
-+                                 break;
-+                         case 2:
-+                                 rff=1;
-+                                 tff=0;
-+                                 break;
-+                         case 3:
-+                                 rff=0;
-+                                 tff=1;
-+                                 break;
-+                 }               
+diff --git a/avidemux_core/ADM_ffmpeg/libavcodec/mpeg12enc.c b/avidemux_core/ADM_ffmpeg/libavcodec/mpeg12enc.c
+index bf36129..b4d6a1d 100644
+--- a/avidemux_core/ADM_ffmpeg/libavcodec/mpeg12enc.c
++++ b/avidemux_core/ADM_ffmpeg/libavcodec/mpeg12enc.c
+@@ -127,10 +127,19 @@ static int find_frame_rate_index(MpegEncContext *s){
+             s->frame_rate_index= i;
+         }
+     }
++ /* MEANX 
++
+     if(dmin)
+         return -1;
+     else
+         return 0;
++  */
++        if(dmin>4)
++   {
++        av_log(0,AV_LOG_ERROR,"We did a roundup ! Expect async!\n");
++   }
++        return 0; //MEANX
++
+ }
+ 
+ static av_cold int encode_init(AVCodecContext *avctx)
+@@ -209,6 +218,7 @@ static void mpeg1_encode_sequence_header(MpegEncContext *s)
+             put_sbits(&s->pb, 12, s->width );
+             put_sbits(&s->pb, 12, s->height);
+ 
++#if 0 //MEANX
+             for(i=1; i<15; i++){
+                 float error= aspect_ratio;
+                 if(s->codec_id == CODEC_ID_MPEG1VIDEO || i <=1)
+@@ -223,20 +233,44 @@ static void mpeg1_encode_sequence_header(MpegEncContext *s)
+                     s->aspect_ratio_info= i;
+                 }
+             }
++#endif // MEANX
++            //MEANX put_bits(&s->pb, 4, s->aspect_ratio_info);
++            //MEANX put_bits(&s->pb, 4, s->frame_rate_index);
++ // MEANX 4:3
++  if(s->avctx->sample_aspect_ratio.num==16 && s->avctx->sample_aspect_ratio.den==9)
++            {
++                //printf("FFmpeg : Wide\n");
++                put_bits(&s->pb,4,3); //16:9
 +            }
-+         else
-+         {
-+                 if (s->progressive_sequence) 
-+                 {
-+                         tff=0; /* no repeat */
-+                 } else 
-+                 {
-+                         tff= s->current_picture_ptr->top_field_first;
-+                 }
-+                 rff=s->repeat_first_field;
-+         
-+         }
-+ 
-+ //               /MEANX pulldown
-+ 
-+ 
-+ 
-          put_header(s, EXT_START_CODE);
-          put_bits(&s->pb, 4, 8); //pic ext
-          if (s->pict_type == FF_P_TYPE || s->pict_type == FF_B_TYPE) {
-***************
-*** 388,398 ****
---- 476,491 ----
-  
-          assert(s->picture_structure == PICT_FRAME);
-          put_bits(&s->pb, 2, s->picture_structure);
-+ #if 0 //MEANX
-+ 
-          if (s->progressive_sequence) {
-              put_bits(&s->pb, 1, 0); /* no repeat */
-          } else {
-              put_bits(&s->pb, 1, s->current_picture_ptr->top_field_first);
-          }
-+ #endif
-+          put_bits(&s->pb, 1, tff);  //MEANX PULLDOWN
-+ 
-          /* XXX: optimize the generation of this flag with entropy
-             measures */
-          s->frame_pred_frame_dct = s->progressive_sequence;
-***************
-*** 402,408 ****
-          put_bits(&s->pb, 1, s->q_scale_type);
-          put_bits(&s->pb, 1, s->intra_vlc_format);
-          put_bits(&s->pb, 1, s->alternate_scan);
-!         put_bits(&s->pb, 1, s->repeat_first_field);
-          s->progressive_frame = s->progressive_sequence;
-          put_bits(&s->pb, 1, s->chroma_format == CHROMA_420 ? s->progressive_frame : 0); /* chroma_420_type */
-          put_bits(&s->pb, 1, s->progressive_frame);
---- 495,504 ----
-          put_bits(&s->pb, 1, s->q_scale_type);
-          put_bits(&s->pb, 1, s->intra_vlc_format);
-          put_bits(&s->pb, 1, s->alternate_scan);
-!  // MEANX put_bits(&s->pb, 1, s->repeat_first_field);
-! 	put_bits(&s->pb, 1, rff);
-!       // /MEANX
-! 
-          s->progressive_frame = s->progressive_sequence;
-          put_bits(&s->pb, 1, s->chroma_format == CHROMA_420 ? s->progressive_frame : 0); /* chroma_420_type */
-          put_bits(&s->pb, 1, s->progressive_frame);
++            else        //4:3
++            {
++              if(s->codec_id == CODEC_ID_MPEG2VIDEO)
++                put_bits(&s->pb, 4, 2);
++              else
++                put_bits(&s->pb, 4, 12); // MPEG1
++            }
++// /MEANX
+ 
+-            put_bits(&s->pb, 4, s->aspect_ratio_info);
+-            put_bits(&s->pb, 4, s->frame_rate_index);
++// //MEANX PULLDOWN            put_bits(&s->pb, 4, s->frame_rate_index);
++if((s->flags2 & CODEC_FLAG2_32_PULLDOWN) && (s->codec_id == CODEC_ID_MPEG2VIDEO))
++            {           
++                put_bits(&s->pb, 4,4);
++            }
++            else
++            {                                  
++                put_bits(&s->pb, 4, s->frame_rate_index);
++            } //MEANX pulldown
+ 
+-            if(s->avctx->rc_max_rate){
+-                v = (s->avctx->rc_max_rate + 399) / 400;
++            if(s->avctx->rc_max_rate_header){ //MEANX we use header
++                v = (s->avctx->rc_max_rate_header + 399) / 400;
+                 if (v > 0x3ffff && s->codec_id == CODEC_ID_MPEG1VIDEO)
+                     v = 0x3ffff;
+             }else{
+                 v= 0x3FFFF;
+             }
+ 
+-            if(s->avctx->rc_buffer_size)
+-                vbv_buffer_size = s->avctx->rc_buffer_size;
++            if(s->avctx->rc_buffer_size_header) // MEANX we use header
++                vbv_buffer_size = s->avctx->rc_buffer_size_header;
+             else
+                 /* VBV calculation: Scaled so that a VCD has the proper VBV size of 40 kilobytes */
+                 vbv_buffer_size = (( 20 * s->bit_rate) / (1151929 / 2)) * 8 * 1024;
+@@ -269,8 +303,17 @@ static void mpeg1_encode_sequence_header(MpegEncContext *s)
+ 
+                 put_bits(&s->pb, 3, s->avctx->profile); //profile
+                 put_bits(&s->pb, 4, s->avctx->level); //level
++   // MEANX pulldown put_bits(&s->pb, 1, s->progressive_sequence);
++  // MEANX Pulldown
++ if(s->flags2 & CODEC_FLAG2_32_PULLDOWN) //MEANX
++                        put_bits(&s->pb, 1, 0);
++                else
++                        put_bits(&s->pb, 1, s->progressive_sequence);
++
++
++// /MEANX
++
+ 
+-                put_bits(&s->pb, 1, s->progressive_sequence);
+                 put_bits(&s->pb, 2, s->chroma_format);
+                 put_bits(&s->pb, 2, s->width >>12);
+                 put_bits(&s->pb, 2, s->height>>12);
+@@ -339,6 +382,8 @@ void ff_mpeg1_encode_slice_header(MpegEncContext *s){
+ 
+ void mpeg1_encode_picture_header(MpegEncContext *s, int picture_number)
+ {
++	int tff,rff; //MEANX
++
+     mpeg1_encode_sequence_header(s);
+ 
+     /* mpeg1 picture header */
+@@ -375,6 +420,49 @@ void mpeg1_encode_picture_header(MpegEncContext *s, int picture_number)
+ 
+     s->frame_pred_frame_dct = 1;
+     if(s->codec_id == CODEC_ID_MPEG2VIDEO){
++ /* MEANX -- Pulldown */
++        if(s->flags2 & CODEC_FLAG2_32_PULLDOWN)
++        {
++        
++                switch((s->picture_number - 
++                          s->gop_picture_number)&3)
++                {
++                        case 0:
++                        default:
++                                rff=1;
++                                tff=1;
++                                break;
++                        case 1:
++                                rff=0;
++                                tff=0;
++                                break;
++                        case 2:
++                                rff=1;
++                                tff=0;
++                                break;
++                        case 3:
++                                rff=0;
++                                tff=1;
++                                break;
++                }               
++           }
++        else
++        {
++                if (s->progressive_sequence) 
++                {
++                        tff=0; /* no repeat */
++                } else 
++                {
++                        tff= s->current_picture_ptr->top_field_first;
++                }
++                rff=s->repeat_first_field;
++        
++        }
++
++//               /MEANX pulldown
++
++
++
+         put_header(s, EXT_START_CODE);
+         put_bits(&s->pb, 4, 8); //pic ext
+         if (s->pict_type == FF_P_TYPE || s->pict_type == FF_B_TYPE) {
+@@ -393,11 +481,16 @@ void mpeg1_encode_picture_header(MpegEncContext *s, int picture_number)
+ 
+         assert(s->picture_structure == PICT_FRAME);
+         put_bits(&s->pb, 2, s->picture_structure);
++#if 0 //MEANX
++
+         if (s->progressive_sequence) {
+             put_bits(&s->pb, 1, 0); /* no repeat */
+         } else {
+             put_bits(&s->pb, 1, s->current_picture_ptr->top_field_first);
+         }
++#endif
++         put_bits(&s->pb, 1, tff);  //MEANX PULLDOWN
++
+         /* XXX: optimize the generation of this flag with entropy
+            measures */
+         s->frame_pred_frame_dct = s->progressive_sequence;
+@@ -407,7 +500,10 @@ void mpeg1_encode_picture_header(MpegEncContext *s, int picture_number)
+         put_bits(&s->pb, 1, s->q_scale_type);
+         put_bits(&s->pb, 1, s->intra_vlc_format);
+         put_bits(&s->pb, 1, s->alternate_scan);
+-        put_bits(&s->pb, 1, s->repeat_first_field);
++ // MEANX put_bits(&s->pb, 1, s->repeat_first_field);
++	put_bits(&s->pb, 1, rff);
++      // /MEANX
++
+         s->progressive_frame = s->progressive_sequence;
+         put_bits(&s->pb, 1, s->chroma_format == CHROMA_420 ? s->progressive_frame : 0); /* chroma_420_type */
+         put_bits(&s->pb, 1, s->progressive_frame);

Modified: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavcodec_mpegvideo.c.patch
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavcodec_mpegvideo.c.patch	2010-05-26 05:26:39 UTC (rev 6236)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavcodec_mpegvideo.c.patch	2010-05-26 05:26:42 UTC (rev 6237)
@@ -1,23 +1,17 @@
-*** libavcodec/mpegvideo.c.old	Wed Apr  1 18:35:39 2009
---- libavcodec/mpegvideo.c	Wed Apr  1 18:35:39 2009
-***************
-*** 606,612 ****
-      CHECKED_ALLOCZ(s->prev_pict_types, PREV_PICT_TYPES_BUFFER_SIZE);
-  
-      s->parse_context.state= -1;
-!     if((s->avctx->debug&(FF_DEBUG_VIS_QP|FF_DEBUG_VIS_MB_TYPE)) || (s->avctx->debug_mv)){
-         s->visualization_buffer[0] = av_malloc((s->mb_width*16 + 2*EDGE_WIDTH) * s->mb_height*16 + 2*EDGE_WIDTH);
-         s->visualization_buffer[1] = av_malloc((s->mb_width*16 + 2*EDGE_WIDTH) * s->mb_height*16 + 2*EDGE_WIDTH);
-         s->visualization_buffer[2] = av_malloc((s->mb_width*16 + 2*EDGE_WIDTH) * s->mb_height*16 + 2*EDGE_WIDTH);
---- 606,616 ----
-      CHECKED_ALLOCZ(s->prev_pict_types, PREV_PICT_TYPES_BUFFER_SIZE);
-  
-      s->parse_context.state= -1;
-!  //MEANX: Allocate them always, as they may be free when we decode 1st image
-! 
-!     // MEANXif((s->avctx->debug&(FF_DEBUG_VIS_QP|FF_DEBUG_VIS_MB_TYPE)) || (s->avctx->debug_mv)){
-! if(1){ // MEANX
-! 
-         s->visualization_buffer[0] = av_malloc((s->mb_width*16 + 2*EDGE_WIDTH) * s->mb_height*16 + 2*EDGE_WIDTH);
-         s->visualization_buffer[1] = av_malloc((s->mb_width*16 + 2*EDGE_WIDTH) * s->mb_height*16 + 2*EDGE_WIDTH);
-         s->visualization_buffer[2] = av_malloc((s->mb_width*16 + 2*EDGE_WIDTH) * s->mb_height*16 + 2*EDGE_WIDTH);
+diff --git a/avidemux_core/ADM_ffmpeg/libavcodec/mpegvideo.c b/avidemux_core/ADM_ffmpeg/libavcodec/mpegvideo.c
+index b5631cf..770fed5 100644
+--- a/avidemux_core/ADM_ffmpeg/libavcodec/mpegvideo.c
++++ b/avidemux_core/ADM_ffmpeg/libavcodec/mpegvideo.c
+@@ -641,7 +641,11 @@ av_cold int MPV_common_init(MpegEncContext *s)
+     FF_ALLOCZ_OR_GOTO(s->avctx, s->prev_pict_types, PREV_PICT_TYPES_BUFFER_SIZE, fail);
+ 
+     s->parse_context.state= -1;
+-    if((s->avctx->debug&(FF_DEBUG_VIS_QP|FF_DEBUG_VIS_MB_TYPE)) || (s->avctx->debug_mv)){
++ //MEANX: Allocate them always, as they may be free when we decode 1st image
++
++    // MEANXif((s->avctx->debug&(FF_DEBUG_VIS_QP|FF_DEBUG_VIS_MB_TYPE)) || (s->avctx->debug_mv)){
++if(1){ // MEANX
++
+        s->visualization_buffer[0] = av_malloc((s->mb_width*16 + 2*EDGE_WIDTH) * s->mb_height*16 + 2*EDGE_WIDTH);
+        s->visualization_buffer[1] = av_malloc((s->mb_width*16 + 2*EDGE_WIDTH) * s->mb_height*16 + 2*EDGE_WIDTH);
+        s->visualization_buffer[2] = av_malloc((s->mb_width*16 + 2*EDGE_WIDTH) * s->mb_height*16 + 2*EDGE_WIDTH);

Modified: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavcodec_mpegvideo_enc.c.patch
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavcodec_mpegvideo_enc.c.patch	2010-05-26 05:26:39 UTC (rev 6236)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavcodec_mpegvideo_enc.c.patch	2010-05-26 05:26:42 UTC (rev 6237)
@@ -1,34 +1,32 @@
-*** libavcodec/mpegvideo_enc.c.old	Sun Jan 25 00:55:20 2009
---- libavcodec/mpegvideo_enc.c	Sun Jan 25 00:55:19 2009
-***************
-*** 349,360 ****
---- 349,362 ----
-  
-          av_log(avctx, AV_LOG_INFO, "Warning vbv_delay will be set to 0xFFFF (=VBR) as the specified vbv buffer is too large for the given bitrate!\n");
-      }
-+ #if 0 //MEANX
-  
-      if((s->flags & CODEC_FLAG_4MV) && s->codec_id != CODEC_ID_MPEG4
-         && s->codec_id != CODEC_ID_H263 && s->codec_id != CODEC_ID_H263P && s->codec_id != CODEC_ID_FLV1){
-          av_log(avctx, AV_LOG_ERROR, "4MV not supported by codec\n");
-          return -1;
-      }
-+ #endif
-  
-      if(s->obmc && s->avctx->mb_decision != FF_MB_DECISION_SIMPLE){
-          av_log(avctx, AV_LOG_ERROR, "OBMC is only supported with simple mb decision\n");
-***************
-*** 387,396 ****
---- 389,400 ----
-          return -1;
-      }
-  
-+ #if 0 //MEANX
-      if(s->mpeg_quant && s->codec_id != CODEC_ID_MPEG4){ //FIXME mpeg2 uses that too
-          av_log(avctx, AV_LOG_ERROR, "mpeg2 style quantization not supported by codec\n");
-          return -1;
-      }
-+ #endif
-  
-      if((s->flags & CODEC_FLAG_CBP_RD) && !avctx->trellis){
-          av_log(avctx, AV_LOG_ERROR, "CBP RD needs trellis quant\n");
+diff --git a/avidemux_core/ADM_ffmpeg/libavcodec/mpegvideo_enc.c b/avidemux_core/ADM_ffmpeg/libavcodec/mpegvideo_enc.c
+index a8616d0..0b226d8 100644
+--- a/avidemux_core/ADM_ffmpeg/libavcodec/mpegvideo_enc.c
++++ b/avidemux_core/ADM_ffmpeg/libavcodec/mpegvideo_enc.c
+@@ -367,12 +367,14 @@ av_cold int MPV_encode_init(AVCodecContext *avctx)
+ 
+         av_log(avctx, AV_LOG_INFO, "Warning vbv_delay will be set to 0xFFFF (=VBR) as the specified vbv buffer is too large for the given bitrate!\n");
+     }
++#if 0 //MEANX
+ 
+     if((s->flags & CODEC_FLAG_4MV) && s->codec_id != CODEC_ID_MPEG4
+        && s->codec_id != CODEC_ID_H263 && s->codec_id != CODEC_ID_H263P && s->codec_id != CODEC_ID_FLV1){
+         av_log(avctx, AV_LOG_ERROR, "4MV not supported by codec\n");
+         return -1;
+     }
++#endif
+ 
+     if(s->obmc && s->avctx->mb_decision != FF_MB_DECISION_SIMPLE){
+         av_log(avctx, AV_LOG_ERROR, "OBMC is only supported with simple mb decision\n");
+@@ -413,10 +415,12 @@ av_cold int MPV_encode_init(AVCodecContext *avctx)
+         return -1;
+     }
+ 
++#if 0 //MEANX
+     if(s->mpeg_quant && s->codec_id != CODEC_ID_MPEG4){ //FIXME mpeg2 uses that too
+         av_log(avctx, AV_LOG_ERROR, "mpeg2 style quantization not supported by codec\n");
+         return -1;
+     }
++#endif
+ 
+     if((s->flags & CODEC_FLAG_CBP_RD) && !avctx->trellis){
+         av_log(avctx, AV_LOG_ERROR, "CBP RD needs trellis quant\n");

Modified: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavcodec_png.patch
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavcodec_png.patch	2010-05-26 05:26:39 UTC (rev 6236)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavcodec_png.patch	2010-05-26 05:26:42 UTC (rev 6237)
@@ -1,7 +1,7 @@
-diff --git a/avidemux/ADM_libraries/ADM_ffmpeg/libavcodec/png.c b/avidemux/ADM_libraries/ADM_ffmpeg/libavcodec/png.c
+diff --git a/avidemux_core/ADM_ffmpeg/libavcodec/png.c b/avidemux_core/ADM_ffmpeg/libavcodec/png.c
 index 534dc68..1a6e137 100644
---- libavcodec/png.c
-+++ libavcodec/png.c
+--- a/avidemux_core/ADM_ffmpeg/libavcodec/png.c
++++ b/avidemux_core/ADM_ffmpeg/libavcodec/png.c
 @@ -20,7 +20,7 @@
   */
  #include "avcodec.h"
@@ -11,29 +11,3 @@
  
  const uint8_t ff_pngsig[8] = {137, 80, 78, 71, 13, 10, 26, 10};
  const uint8_t ff_mngsig[8] = {138, 77, 78, 71, 13, 10, 26, 10};
-diff --git a/avidemux/ADM_libraries/ADM_ffmpeg/libavcodec/pngdec.c b/avidemux/ADM_libraries/ADM_ffmpeg/libavcodec/pngdec.c
-index bf719b2..d069d44 100644
---- libavcodec/pngdec.c
-+++ libavcodec/pngdec.c
-@@ -20,7 +20,7 @@
-  */
- #include "avcodec.h"
- #include "bytestream.h"
--#include "png.h"
-+#include "ffpng.h"
- #include "dsputil.h"
- 
- /* TODO:
-diff --git a/avidemux/ADM_libraries/ADM_ffmpeg/libavcodec/pngenc.c b/avidemux/ADM_libraries/ADM_ffmpeg/libavcodec/pngenc.c
-index 40dadc8..0204064 100644
---- libavcodec/pngenc.c
-+++ libavcodec/pngenc.c
-@@ -21,7 +21,7 @@
- #include "avcodec.h"
- #include "bytestream.h"
- #include "dsputil.h"
--#include "png.h"
-+#include "ffpng.h"
- 
- /* TODO:
-  * - add 2, 4 and 16 bit depth support

Added: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavcodec_pngdec.c.patch
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavcodec_pngdec.c.patch	2010-05-26 05:26:39 UTC (rev 6236)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavcodec_pngdec.c.patch	2010-05-26 05:26:42 UTC (rev 6237)
@@ -0,0 +1,13 @@
+diff --git a/avidemux_core/ADM_ffmpeg/libavcodec/pngdec.c b/avidemux_core/ADM_ffmpeg/libavcodec/pngdec.c
+index 03859a9..e1b6d6e 100644
+--- a/avidemux_core/ADM_ffmpeg/libavcodec/pngdec.c
++++ b/avidemux_core/ADM_ffmpeg/libavcodec/pngdec.c
+@@ -20,7 +20,7 @@
+  */
+ #include "avcodec.h"
+ #include "bytestream.h"
+-#include "png.h"
++#include "ffpng.h"
+ #include "dsputil.h"
+ 
+ /* TODO:

Added: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavcodec_pngenc.c.patch
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavcodec_pngenc.c.patch	2010-05-26 05:26:39 UTC (rev 6236)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavcodec_pngenc.c.patch	2010-05-26 05:26:42 UTC (rev 6237)
@@ -0,0 +1,13 @@
+diff --git a/avidemux_core/ADM_ffmpeg/libavcodec/pngenc.c b/avidemux_core/ADM_ffmpeg/libavcodec/pngenc.c
+index 615bcc4..4149234 100644
+--- a/avidemux_core/ADM_ffmpeg/libavcodec/pngenc.c
++++ b/avidemux_core/ADM_ffmpeg/libavcodec/pngenc.c
+@@ -21,7 +21,7 @@
+ #include "avcodec.h"
+ #include "bytestream.h"
+ #include "dsputil.h"
+-#include "png.h"
++#include "ffpng.h"
+ 
+ /* TODO:
+  * - add 2, 4 and 16 bit depth support

Modified: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavcodec_utils.c.patch
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavcodec_utils.c.patch	2010-05-26 05:26:39 UTC (rev 6236)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavcodec_utils.c.patch	2010-05-26 05:26:42 UTC (rev 6237)
@@ -1,34 +1,42 @@
-*** libavcodec/utils.c.old	Wed Apr  1 18:35:40 2009
---- libavcodec/utils.c	Wed Apr  1 18:35:40 2009
-***************
-*** 555,564 ****
---- 555,566 ----
-  
-      if((avctx->codec->capabilities & CODEC_CAP_DELAY) || buf_size){
-          //FIXME remove the check below _after_ ensuring that all audio check that the available space is enough
-+ #if 0 // MEANX : Silence
-          if(*frame_size_ptr < AVCODEC_MAX_AUDIO_FRAME_SIZE){
-              av_log(avctx, AV_LOG_ERROR, "buffer smaller than AVCODEC_MAX_AUDIO_FRAME_SIZE\n");
-              return -1;
-          }
-+ #endif
-          if(*frame_size_ptr < FF_MIN_BUFFER_SIZE ||
-          *frame_size_ptr < avctx->channels * avctx->frame_size * sizeof(int16_t)){
-              av_log(avctx, AV_LOG_ERROR, "buffer %d too small\n", *frame_size_ptr);
-***************
-*** 969,975 ****
-          return -1;
-      }
-  #if !HAVE_MKSTEMP
-!     fd = open(*filename, O_RDWR | O_BINARY | O_CREAT, 0444);
-  #else
-      snprintf(*filename, len, "/tmp/%sXXXXXX", prefix);
-      fd = mkstemp(*filename);
---- 971,977 ----
-          return -1;
-      }
-  #if !HAVE_MKSTEMP
-!     fd = open(*filename, O_RDWR /* MEANX | O_BINARY*/ | O_CREAT, 0444);
-  #else
-      snprintf(*filename, len, "/tmp/%sXXXXXX", prefix);
-      fd = mkstemp(*filename);
+diff --git a/avidemux_core/ADM_ffmpeg/libavcodec/utils.c b/avidemux_core/ADM_ffmpeg/libavcodec/utils.c
+index 56d4dbd..aad5a47 100644
+--- a/avidemux_core/ADM_ffmpeg/libavcodec/utils.c
++++ b/avidemux_core/ADM_ffmpeg/libavcodec/utils.c
+@@ -643,10 +643,12 @@ int attribute_align_arg avcodec_decode_audio3(AVCodecContext *avctx, int16_t *sa
+ 
+     if((avctx->codec->capabilities & CODEC_CAP_DELAY) || avpkt->size){
+         //FIXME remove the check below _after_ ensuring that all audio check that the available space is enough
++#if 0 // MEANX : Silence
+         if(*frame_size_ptr < AVCODEC_MAX_AUDIO_FRAME_SIZE){
+             av_log(avctx, AV_LOG_ERROR, "buffer smaller than AVCODEC_MAX_AUDIO_FRAME_SIZE\n");
+             return -1;
+         }
++#endif
+         if(*frame_size_ptr < FF_MIN_BUFFER_SIZE ||
+         *frame_size_ptr < avctx->channels * avctx->frame_size * sizeof(int16_t)){
+             av_log(avctx, AV_LOG_ERROR, "buffer %d too small\n", *frame_size_ptr);
+@@ -921,13 +923,13 @@ unsigned avcodec_version( void )
+ 
+ const char *avcodec_configuration(void)
+ {
+-    return FFMPEG_CONFIGURATION;
++    return "avidemux"; //FFMPEG_CONFIGURATION;
+ }
+ 
+ const char *avcodec_license(void)
+ {
+ #define LICENSE_PREFIX "libavcodec license: "
+-    return LICENSE_PREFIX FFMPEG_LICENSE + sizeof(LICENSE_PREFIX) - 1;
++    return LICENSE_PREFIX /*FFMPEG_LICENSE*/ "GPL" + sizeof(LICENSE_PREFIX) - 1;
+ }
+ 
+ void avcodec_init(void)
+@@ -1080,7 +1082,7 @@ int av_tempfile(char *prefix, char **filename) {
+         return -1;
+     }
+ #if !HAVE_MKSTEMP
+-    fd = open(*filename, O_RDWR | O_BINARY | O_CREAT, 0444);
++    fd = open(*filename, O_RDWR /* MEANX | O_BINARY*/ | O_CREAT, 0444);
+ #else
+     snprintf(*filename, len, "/tmp/%sXXXXXX", prefix);
+     fd = mkstemp(*filename);

Added: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavcodec_x86_mathops.h
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavcodec_x86_mathops.h	2010-05-26 05:26:39 UTC (rev 6236)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavcodec_x86_mathops.h	2010-05-26 05:26:42 UTC (rev 6237)
@@ -0,0 +1,17 @@
+diff --git a/avidemux_core/ADM_ffmpeg/libavcodec/x86/mathops.h b/avidemux_core/ADM_ffmpeg/libavcodec/x86/mathops.h
+index 5949dfe..c7f54c5 100644
+--- a/avidemux_core/ADM_ffmpeg/libavcodec/x86/mathops.h
++++ b/avidemux_core/ADM_ffmpeg/libavcodec/x86/mathops.h
+@@ -22,7 +22,12 @@
+ #ifndef AVCODEC_X86_MATHOPS_H
+ #define AVCODEC_X86_MATHOPS_H
+ 
++// MEANX
++#ifndef ADM_NO_CONFIG_H
+ #include "config.h"
++#endif
++// MEANX
++
+ #include "libavutil/common.h"
+ 
+ #if ARCH_X86_32

Added: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavformat_utils.c.patch
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavformat_utils.c.patch	2010-05-26 05:26:39 UTC (rev 6236)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavformat_utils.c.patch	2010-05-26 05:26:42 UTC (rev 6237)
@@ -0,0 +1,21 @@
+diff --git a/avidemux_core/ADM_ffmpeg/libavformat/utils.c b/avidemux_core/ADM_ffmpeg/libavformat/utils.c
+index 22c833d..e90b609 100644
+--- a/avidemux_core/ADM_ffmpeg/libavformat/utils.c
++++ b/avidemux_core/ADM_ffmpeg/libavformat/utils.c
+@@ -49,13 +49,14 @@ unsigned avformat_version(void)
+ 
+ const char *avformat_configuration(void)
+ {
+-    return FFMPEG_CONFIGURATION;
++    return "avidemux"; //FFMPEG_CONFIGURATION;
+ }
+ 
+ const char *avformat_license(void)
+ {
+ #define LICENSE_PREFIX "libavformat license: "
+-    return LICENSE_PREFIX FFMPEG_LICENSE + sizeof(LICENSE_PREFIX) - 1;
++    //return LICENSE_PREFIX FFMPEG_LICENSE + sizeof(LICENSE_PREFIX) - 1;
++        return LICENSE_PREFIX "GPL";
+ }
+ 
+ /* fraction handling */

Modified: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavutil_avutil.h.patch
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavutil_avutil.h.patch	2010-05-26 05:26:39 UTC (rev 6236)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavutil_avutil.h.patch	2010-05-26 05:26:42 UTC (rev 6237)
@@ -1,18 +1,18 @@
-*** libavutil/avutil.h.old	Sat Jan 24 22:57:50 2009
---- libavutil/avutil.h	Sat Jan 24 22:57:49 2009
-***************
-*** 26,31 ****
---- 26,38 ----
-   * external API header
-   */
-  
-+ /* MEANX
-+  * - */
-+ #define ASMALIGN(ZEROBITS) ".p2align " #ZEROBITS "\n\t"
-+ /* /MEANX
-+  */
-+ 
-+ 
-  
-  #define AV_STRINGIFY(s)         AV_TOSTRING(s)
-  #define AV_TOSTRING(s) #s
+diff --git a/avidemux_core/ADM_ffmpeg/libavutil/avutil.h b/avidemux_core/ADM_ffmpeg/libavutil/avutil.h
+index 72bd2c5..a81225f 100644
+--- a/avidemux_core/ADM_ffmpeg/libavutil/avutil.h
++++ b/avidemux_core/ADM_ffmpeg/libavutil/avutil.h
+@@ -26,6 +26,13 @@
+  * external API header
+  */
+ 
++/* MEANX
++ * - */
++#define ASMALIGN(ZEROBITS) ".p2align " #ZEROBITS "\n\t"
++/* /MEANX
++ */
++
++
+ 
+ #define AV_STRINGIFY(s)         AV_TOSTRING(s)
+ #define AV_TOSTRING(s) #s

Added: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavutil_bswap.h.patch
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavutil_bswap.h.patch	2010-05-26 05:26:39 UTC (rev 6236)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavutil_bswap.h.patch	2010-05-26 05:26:42 UTC (rev 6237)
@@ -0,0 +1,16 @@
+diff --git a/avidemux_core/ADM_ffmpeg/libavutil/bswap.h b/avidemux_core/ADM_ffmpeg/libavutil/bswap.h
+index 6dd2a35..f7a422c 100644
+--- a/avidemux_core/ADM_ffmpeg/libavutil/bswap.h
++++ b/avidemux_core/ADM_ffmpeg/libavutil/bswap.h
+@@ -27,7 +27,11 @@
+ #define AVUTIL_BSWAP_H
+ 
+ #include <stdint.h>
++// MEANX
++#ifndef ADM_NO_CONFIG_H
+ #include "config.h"
++#endif
++// /MEANX
+ #include "attributes.h"
+ 
+ #if   ARCH_ARM

Modified: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavutil_internal.h.patch
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavutil_internal.h.patch	2010-05-26 05:26:39 UTC (rev 6236)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavutil_internal.h.patch	2010-05-26 05:26:42 UTC (rev 6237)
@@ -1,19 +1,49 @@
-*** libavutil/internal.h.old	Sat Feb 21 16:11:15 2009
---- libavutil/internal.h	Sat Feb 21 16:11:15 2009
-***************
-*** 215,226 ****
---- 215,228 ----
-  #endif
-  
-  /* avoid usage of dangerous/inappropriate system functions */
-+ #if 0 //MEANX
-  #undef  malloc
-  #define malloc please_use_av_malloc
-  #undef  free
-  #define free please_use_av_free
-  #undef  realloc
-  #define realloc please_use_av_realloc
-+ #endif
-  #undef  time
-  #define time time_is_forbidden_due_to_security_issues
-  #undef  rand
+diff --git a/avidemux_core/ADM_ffmpeg/libavutil/internal.h b/avidemux_core/ADM_ffmpeg/libavutil/internal.h
+index 2faafc9..8516159 100644
+--- a/avidemux_core/ADM_ffmpeg/libavutil/internal.h
++++ b/avidemux_core/ADM_ffmpeg/libavutil/internal.h
+@@ -34,7 +34,11 @@
+ #include <stdint.h>
+ #include <stddef.h>
+ #include <assert.h>
++//MEANX
++#ifndef ADM_NO_CONFIG_H
+ #include "config.h"
++#endif
++// /MEANX
+ #include "attributes.h"
+ #include "timer.h"
+ 
+@@ -95,6 +99,8 @@
+ #endif
+ 
+ /* Use to export labels from asm. */
++#include "ADM_mangle.h"
++#if 0 // MEANX
+ #define LABEL_MANGLE(a) EXTERN_PREFIX #a
+ 
+ // Use rip-relative addressing if compiling PIC code on x86-64.
+@@ -105,7 +111,7 @@
+ #endif
+ 
+ #define MANGLE(a) EXTERN_PREFIX LOCAL_MANGLE(a)
+-
++#endif // MEANX
+ /* debug stuff */
+ 
+ /* dprintf macros */
+@@ -134,12 +140,14 @@
+ #endif
+ 
+ /* avoid usage of dangerous/inappropriate system functions */
++#if 0 //MEANX
+ #undef  malloc
+ #define malloc please_use_av_malloc
+ #undef  free
+ #define free please_use_av_free
+ #undef  realloc
+ #define realloc please_use_av_realloc
++#endif
+ #undef  time
+ #define time time_is_forbidden_due_to_security_issues
+ #undef  rand

Added: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavutil_intreadwrite.h.patch
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavutil_intreadwrite.h.patch	2010-05-26 05:26:39 UTC (rev 6236)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavutil_intreadwrite.h.patch	2010-05-26 05:26:42 UTC (rev 6237)
@@ -0,0 +1,17 @@
+diff --git a/avidemux_core/ADM_ffmpeg/libavutil/intreadwrite.h b/avidemux_core/ADM_ffmpeg/libavutil/intreadwrite.h
+index c8026f0..272a3b1 100644
+--- a/avidemux_core/ADM_ffmpeg/libavutil/intreadwrite.h
++++ b/avidemux_core/ADM_ffmpeg/libavutil/intreadwrite.h
+@@ -20,7 +20,12 @@
+ #define AVUTIL_INTREADWRITE_H
+ 
+ #include <stdint.h>
++// MEANX
++#ifndef ADM_NO_CONFIG_H
+ #include "config.h"
++#endif
++// MEANX
++
+ #include "bswap.h"
+ #include "common.h"
+ 

Deleted: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavutil_lfg.patch
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavutil_lfg.patch	2010-05-26 05:26:39 UTC (rev 6236)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavutil_lfg.patch	2010-05-26 05:26:42 UTC (rev 6237)
@@ -1,31 +0,0 @@
-diff --git a/avidemux_core/ADM_ffmpeg/libavutil/lfg.c b/avidemux_core/ADM_ffmpeg/libavutil/lfg.c
-index e876d18..8729bfc 100644
---- a/avidemux_core/ADM_ffmpeg/libavutil/lfg.c
-+++ b/avidemux_core/ADM_ffmpeg/libavutil/lfg.c
-@@ -23,7 +23,7 @@
- #include "lfg.h"
- #include "md5.h"
- #include "intreadwrite.h"
--
-+#undef index //MEANS
- void av_cold av_lfg_init(AVLFG *c, unsigned int seed){
-     uint8_t tmp[16]={0};
-     int i;
-diff --git a/avidemux_core/ADM_ffmpeg/patches/libavutil_lfg.patch b/avidemux_core/ADM_ffmpeg/patches/libavutil_lfg.patch
-index 0596b37..e69de29 100644
---- a/avidemux_core/ADM_ffmpeg/patches/libavutil_lfg.patch
-+++ b/avidemux_core/ADM_ffmpeg/patches/libavutil_lfg.patch
-@@ -1,13 +0,0 @@
--diff --git a/avidemux/ADM_libraries/ADM_ffmpeg/libavutil/lfg.c b/avidemux/ADM_libraries/ADM_ffmpeg/libavutil/lfg.c
--index e876d18..ff6a888 100644
----- a/avidemux/ADM_libraries/ADM_ffmpeg/libavutil/lfg.c
--+++ b/avidemux/ADM_libraries/ADM_ffmpeg/libavutil/lfg.c
--@@ -23,7 +23,7 @@
-- #include "lfg.h"
-- #include "md5.h"
-- #include "intreadwrite.h"
---
--+#undef index
-- void av_cold av_lfg_init(AVLFG *c, unsigned int seed){
--     uint8_t tmp[16]={0};
--     int i;

Added: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavutil_libm.h.patch
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavutil_libm.h.patch	2010-05-26 05:26:39 UTC (rev 6236)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavutil_libm.h.patch	2010-05-26 05:26:42 UTC (rev 6237)
@@ -0,0 +1,16 @@
+diff --git a/avidemux_core/ADM_ffmpeg/libavutil/libm.h b/avidemux_core/ADM_ffmpeg/libavutil/libm.h
+index c7c28ac..3f6ae07 100644
+--- a/avidemux_core/ADM_ffmpeg/libavutil/libm.h
++++ b/avidemux_core/ADM_ffmpeg/libavutil/libm.h
+@@ -25,7 +25,11 @@
+ #define AVUTIL_LIBM_H
+ 
+ #include <math.h>
++//MEANX
++#ifndef ADM_NO_CONFIG_H
+ #include "config.h"
++#endif
++///MEANX
+ #include "attributes.h"
+ 
+ #if !HAVE_EXP2

Modified: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavutil_mem.c.patch
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavutil_mem.c.patch	2010-05-26 05:26:39 UTC (rev 6236)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavutil_mem.c.patch	2010-05-26 05:26:42 UTC (rev 6237)
@@ -1,202 +1,182 @@
-*** libavutil/mem.c.old	Wed Apr  1 18:35:44 2009
---- libavutil/mem.c	Wed Apr  1 18:35:44 2009
-***************
-*** 46,132 ****
-  
-  void *av_malloc(unsigned int size)
-  {
-!     void *ptr = NULL;
-! #if CONFIG_MEMALIGN_HACK
-!     long diff;
-! #endif
-  
-!     /* let's disallow possible ambiguous cases */
-!     if(size > (INT_MAX-16) )
-!         return NULL;
-! 
-! #if CONFIG_MEMALIGN_HACK
-!     ptr = malloc(size+16);
-!     if(!ptr)
-!         return ptr;
-!     diff= ((-(long)ptr - 1)&15) + 1;
-!     ptr = (char*)ptr + diff;
-!     ((char*)ptr)[-1]= diff;
-! #elif HAVE_POSIX_MEMALIGN
-!     if (posix_memalign(&ptr,16,size))
-!         ptr = NULL;
-! #elif HAVE_MEMALIGN
-!     ptr = memalign(16,size);
-!     /* Why 64?
-!        Indeed, we should align it:
-!          on 4 for 386
-!          on 16 for 486
-!          on 32 for 586, PPro - K6-III
-!          on 64 for K7 (maybe for P3 too).
-!        Because L1 and L2 caches are aligned on those values.
-!        But I don't want to code such logic here!
-!      */
-!      /* Why 16?
-!         Because some CPUs need alignment, for example SSE2 on P4, & most RISC CPUs
-!         it will just trigger an exception and the unaligned load will be done in the
-!         exception handler or it will just segfault (SSE2 on P4).
-!         Why not larger? Because I did not see a difference in benchmarks ...
-!      */
-!      /* benchmarks with P3
-!         memalign(64)+1          3071,3051,3032
-!         memalign(64)+2          3051,3032,3041
-!         memalign(64)+4          2911,2896,2915
-!         memalign(64)+8          2545,2554,2550
-!         memalign(64)+16         2543,2572,2563
-!         memalign(64)+32         2546,2545,2571
-!         memalign(64)+64         2570,2533,2558
-  
-!         BTW, malloc seems to do 8-byte alignment by default here.
-!      */
-! #else
-!     ptr = malloc(size);
-  #endif
--     return ptr;
-  }
-  
-! void *av_realloc(void *ptr, unsigned int size)
-  {
-! #if CONFIG_MEMALIGN_HACK
-!     int diff;
-! #endif
-  
-!     /* let's disallow possible ambiguous cases */
-!     if(size > (INT_MAX-16) )
-!         return NULL;
-! 
-! #if CONFIG_MEMALIGN_HACK
-!     //FIXME this isn't aligned correctly, though it probably isn't needed
-!     if(!ptr) return av_malloc(size);
-!     diff= ((char*)ptr)[-1];
-!     return (char*)realloc((char*)ptr - diff, size + diff) + diff;
-  #else
-!     return realloc(ptr, size);
-  #endif
-  }
-  
-  void av_free(void *ptr)
-  {
-!     /* XXX: this test should not be needed on most libcs */
-!     if (ptr)
-! #if CONFIG_MEMALIGN_HACK
-!         free((char*)ptr - ((char*)ptr)[-1]);
-  #else
-!         free(ptr);
-  #endif
-  }
-  
---- 46,155 ----
-  
-  void *av_malloc(unsigned int size)
-  {
-! #ifdef __APPLE__
-! 	return malloc(size);
-! #else
-! 	char *c;
-  
-! 	uint64_t l, lorg;
-! 	uint32_t *backdoor;
-  
-! 	l = (uint64_t)malloc(size + 32);
-! 
-! 	// Get next boundary
-! 	lorg = l;
-! 	l = (l + 15) & 0xfffffffffffffff0LL;
-! 	l += 16;
-! 	c = (char*)l;
-! 	backdoor = (uint32_t*)(c - 8);
-! 	*backdoor = (0xdead << 16) + l - lorg;
-! 	backdoor[1] = size;
-! 
-! 	return c;
-  #endif
-  }
-  
-! void *av_realloc(void *ptr, unsigned int newsize)
-  {
-! #ifdef __APPLE__
-! 	if (!ptr)
-! 		return av_malloc(newsize);
-! 
-! 	if (!newsize)
-! 	{
-! 		av_free(ptr);
-! 		return NULL;
-! 	}
-  
-! 	return realloc(ptr, newsize);
-  #else
-! 	void *nalloc;
-! 
-! 	if (!ptr)
-! 		return av_malloc(newsize);
-! 
-! 	if (!newsize) 
-! 	{
-! 		av_free(ptr);
-! 		return NULL;
-! 	}
-! 
-! 	// now we either shrink them or expand them
-! 	// in case of shrink, we do nothing
-! 	// in case of expand we have to copy
-! 	// Do copy everytime (slower)
-! 	uint32_t *backdoor;
-! 	uint32_t size, offset;
-! 	char *c = (char*)ptr;
-! 
-! 	backdoor = (uint32_t*)ptr;
-! 	backdoor -= 2;
-! 
-! 	assert(((*backdoor) >> 16) == 0xdead);
-! 
-! 	offset = backdoor[0] & 0xffff;
-! 	size = backdoor[1];
-! 
-! 	if(size >= newsize) // do nothing
-! 		return ptr;
-! 
-! 	// Allocate a new one
-! 	nalloc = av_malloc(newsize);
-! 	memcpy(nalloc, ptr, size);
-! 	av_free(ptr);
-! 
-! 	return nalloc;
-  #endif
-  }
-  
-  void av_free(void *ptr)
-  {
-! #ifdef __APPLE__
-! 	if (!ptr)
-! 		return;
-! 
-! 	free(ptr);
-  #else
-! 	uint32_t *backdoor;
-! 	uint32_t size, offset;
-! 	char *c = (char*)ptr;
-! 
-! 	if (!ptr)
-! 		return;
-! 
-! 	backdoor = (uint32_t*)ptr;
-! 	backdoor -= 2;
-! 
-! 	if (*backdoor == 0xbeefbeef)
-! 		assert(0);
-! 
-! 	assert(((*backdoor) >> 16) == 0xdead);
-! 
-! 	offset = backdoor[0] & 0xffff;
-! 	size = backdoor[1];
-! 	*backdoor = 0xbeefbeef; // Scratch sig
-! 
-! 	free(c - offset);
-  #endif
-  }
-  
+diff --git a/avidemux_core/ADM_ffmpeg/libavutil/mem.c b/avidemux_core/ADM_ffmpeg/libavutil/mem.c
+index 8cad089..8e95a78 100644
+--- a/avidemux_core/ADM_ffmpeg/libavutil/mem.c
++++ b/avidemux_core/ADM_ffmpeg/libavutil/mem.c
+@@ -63,87 +63,110 @@ void  free(void *ptr);
+ 
+ void *av_malloc(unsigned int size)
+ {
+-    void *ptr = NULL;
+-#if CONFIG_MEMALIGN_HACK
+-    long diff;
+-#endif
+-
+-    /* let's disallow possible ambiguous cases */
+-    if(size > (INT_MAX-16) )
+-        return NULL;
+-
+-#if CONFIG_MEMALIGN_HACK
+-    ptr = malloc(size+16);
+-    if(!ptr)
+-        return ptr;
+-    diff= ((-(long)ptr - 1)&15) + 1;
+-    ptr = (char*)ptr + diff;
+-    ((char*)ptr)[-1]= diff;
+-#elif HAVE_POSIX_MEMALIGN
+-    if (posix_memalign(&ptr,16,size))
+-        ptr = NULL;
+-#elif HAVE_MEMALIGN
+-    ptr = memalign(16,size);
+-    /* Why 64?
+-       Indeed, we should align it:
+-         on 4 for 386
+-         on 16 for 486
+-         on 32 for 586, PPro - K6-III
+-         on 64 for K7 (maybe for P3 too).
+-       Because L1 and L2 caches are aligned on those values.
+-       But I don't want to code such logic here!
+-     */
+-     /* Why 16?
+-        Because some CPUs need alignment, for example SSE2 on P4, & most RISC CPUs
+-        it will just trigger an exception and the unaligned load will be done in the
+-        exception handler or it will just segfault (SSE2 on P4).
+-        Why not larger? Because I did not see a difference in benchmarks ...
+-     */
+-     /* benchmarks with P3
+-        memalign(64)+1          3071,3051,3032
+-        memalign(64)+2          3051,3032,3041
+-        memalign(64)+4          2911,2896,2915
+-        memalign(64)+8          2545,2554,2550
+-        memalign(64)+16         2543,2572,2563
+-        memalign(64)+32         2546,2545,2571
+-        memalign(64)+64         2570,2533,2558
+-
+-        BTW, malloc seems to do 8-byte alignment by default here.
+-     */
++#ifdef __APPLE__
++	return malloc(size);
+ #else
+-    ptr = malloc(size);
++	char *c;
++
++	uint64_t l, lorg;
++	uint32_t *backdoor;
++
++	l = (uint64_t)malloc(size + 32);
++
++	// Get next boundary
++	lorg = l;
++	l = (l + 15) & 0xfffffffffffffff0LL;
++	l += 16;
++	c = (char*)l;
++	backdoor = (uint32_t*)(c - 8);
++	*backdoor = (0xdead << 16) + l - lorg;
++	backdoor[1] = size;
++
++	return c;
+ #endif
+-    return ptr;
+ }
+ 
+-void *av_realloc(void *ptr, unsigned int size)
++void *av_realloc(void *ptr, unsigned int newsize)
+ {
+-#if CONFIG_MEMALIGN_HACK
+-    int diff;
+-#endif
++#ifdef __APPLE__
++	if (!ptr)
++		return av_malloc(newsize);
+ 
+-    /* let's disallow possible ambiguous cases */
+-    if(size > (INT_MAX-16) )
+-        return NULL;
++	if (!newsize)
++	{
++		av_free(ptr);
++		return NULL;
++	}
+ 
+-#if CONFIG_MEMALIGN_HACK
+-    //FIXME this isn't aligned correctly, though it probably isn't needed
+-    if(!ptr) return av_malloc(size);
+-    diff= ((char*)ptr)[-1];
+-    return (char*)realloc((char*)ptr - diff, size + diff) + diff;
++	return realloc(ptr, newsize);
+ #else
+-    return realloc(ptr, size);
++	void *nalloc;
++
++	if (!ptr)
++		return av_malloc(newsize);
++
++	if (!newsize) 
++	{
++		av_free(ptr);
++		return NULL;
++	}
++
++	// now we either shrink them or expand them
++	// in case of shrink, we do nothing
++	// in case of expand we have to copy
++	// Do copy everytime (slower)
++	uint32_t *backdoor;
++	uint32_t size, offset;
++	char *c = (char*)ptr;
++
++	backdoor = (uint32_t*)ptr;
++	backdoor -= 2;
++
++	assert(((*backdoor) >> 16) == 0xdead);
++
++	offset = backdoor[0] & 0xffff;
++	size = backdoor[1];
++
++	if(size >= newsize) // do nothing
++		return ptr;
++
++	// Allocate a new one
++	nalloc = av_malloc(newsize);
++	memcpy(nalloc, ptr, size);
++	av_free(ptr);
++
++	return nalloc;
+ #endif
+ }
+ 
+ void av_free(void *ptr)
+ {
+-    /* XXX: this test should not be needed on most libcs */
+-    if (ptr)
+-#if CONFIG_MEMALIGN_HACK
+-        free((char*)ptr - ((char*)ptr)[-1]);
++#ifdef __APPLE__
++	if (!ptr)
++		return;
++
++	free(ptr);
+ #else
+-        free(ptr);
++	uint32_t *backdoor;
++	uint32_t size, offset;
++	char *c = (char*)ptr;
++
++	if (!ptr)
++		return;
++
++	backdoor = (uint32_t*)ptr;
++	backdoor -= 2;
++
++	if (*backdoor == 0xbeefbeef)
++		assert(0);
++
++	assert(((*backdoor) >> 16) == 0xdead);
++
++	offset = backdoor[0] & 0xffff;
++	size = backdoor[1];
++	*backdoor = 0xbeefbeef; // Scratch sig
++
++	free(c - offset);
+ #endif
+ }
+ 

Added: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavutil_timer.h.patch
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavutil_timer.h.patch	2010-05-26 05:26:39 UTC (rev 6236)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavutil_timer.h.patch	2010-05-26 05:26:42 UTC (rev 6237)
@@ -0,0 +1,17 @@
+diff --git a/avidemux_core/ADM_ffmpeg/libavutil/timer.h b/avidemux_core/ADM_ffmpeg/libavutil/timer.h
+index cd8fba8..66be371 100644
+--- a/avidemux_core/ADM_ffmpeg/libavutil/timer.h
++++ b/avidemux_core/ADM_ffmpeg/libavutil/timer.h
+@@ -26,7 +26,12 @@
+ 
+ #include <stdlib.h>
+ #include <stdint.h>
++// MEANX
++#ifndef ADM_NO_CONFIG_H
+ #include "config.h"
++#endif
++// MEANX
++
+ 
+ #if   ARCH_ARM
+ #   include "arm/timer.h"

Added: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavutil_x86_bswap.h
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavutil_x86_bswap.h	2010-05-26 05:26:39 UTC (rev 6236)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavutil_x86_bswap.h	2010-05-26 05:26:42 UTC (rev 6237)
@@ -0,0 +1,16 @@
+diff --git a/avidemux_core/ADM_ffmpeg/libavutil/x86/bswap.h b/avidemux_core/ADM_ffmpeg/libavutil/x86/bswap.h
+index 26dc4e2..c7a87dd 100644
+--- a/avidemux_core/ADM_ffmpeg/libavutil/x86/bswap.h
++++ b/avidemux_core/ADM_ffmpeg/libavutil/x86/bswap.h
+@@ -25,7 +25,11 @@
+ #define AVUTIL_X86_BSWAP_H
+ 
+ #include <stdint.h>
++// MEANX
++#ifndef ADM_NO_CONFIG_H
+ #include "config.h"
++#endif
++// /MEANX
+ #include "libavutil/attributes.h"
+ 
+ #define bswap_16 bswap_16

Added: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavutil_x86_intreadwrite.h
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavutil_x86_intreadwrite.h	2010-05-26 05:26:39 UTC (rev 6236)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavutil_x86_intreadwrite.h	2010-05-26 05:26:42 UTC (rev 6237)
@@ -0,0 +1,16 @@
+diff --git a/avidemux_core/ADM_ffmpeg/libavutil/x86/intreadwrite.h b/avidemux_core/ADM_ffmpeg/libavutil/x86/intreadwrite.h
+index 4061d19..4740886 100644
+--- a/avidemux_core/ADM_ffmpeg/libavutil/x86/intreadwrite.h
++++ b/avidemux_core/ADM_ffmpeg/libavutil/x86/intreadwrite.h
+@@ -22,7 +22,11 @@
+ #define AVUTIL_X86_INTREADWRITE_H
+ 
+ #include <stdint.h>
++// MEANX
++#ifndef ADM_NO_CONFIG_H
+ #include "config.h"
++#endif
++/// MEANX
+ #include "libavutil/attributes.h"
+ 
+ #if HAVE_MMX

Deleted: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/timer_h.patch
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/timer_h.patch	2010-05-26 05:26:39 UTC (rev 6236)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/timer_h.patch	2010-05-26 05:26:42 UTC (rev 6237)
@@ -1,17 +0,0 @@
-diff --git a/avidemux/ADM_libraries/ADM_ffmpeg/libavutil/timer.h b/avidemux/ADM_libraries/ADM_ffmpeg/libavutil/timer.h
-index db0abae..6be1e88 100644
---- libavutil/timer.h
-+++ libavutil/timer.h
-@@ -26,7 +26,12 @@
- 
- #include <stdlib.h>
- #include <stdint.h>
-+// MEANX
-+#ifndef ADM_NO_CONFIG_H
- #include "config.h"
-+#endif
-+// MEANX
-+
- 
- #if   ARCH_ARM
- #   include "arm/timer.h"

Deleted: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/x86_bswap_h.patch
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/x86_bswap_h.patch	2010-05-26 05:26:39 UTC (rev 6236)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/x86_bswap_h.patch	2010-05-26 05:26:42 UTC (rev 6237)
@@ -1,17 +0,0 @@
-diff --git a/avidemux/ADM_libraries/ADM_ffmpeg/libavutil/x86/bswap.h b/avidemux/ADM_libraries/ADM_ffmpeg/libavutil/x86/bswap.h
-index 3eeb5a4..82626f2 100644
---- libavutil/x86/bswap.h
-+++ libavutil/x86/bswap.h
-@@ -25,7 +25,12 @@
- #define AVUTIL_X86_BSWAP_H
- 
- #include <stdint.h>
-+// MEANX
-+#ifndef ADM_NO_CONFIG_H
- #include "config.h"
-+#endif
-+// MEANX
-+
- #include "libavutil/common.h"
- 
- #define bswap_16 bswap_16

Deleted: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/x86_mathops_h.patch
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/x86_mathops_h.patch	2010-05-26 05:26:39 UTC (rev 6236)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/x86_mathops_h.patch	2010-05-26 05:26:42 UTC (rev 6237)
@@ -1,17 +0,0 @@
-diff --git a/avidemux/ADM_libraries/ADM_ffmpeg/libavcodec/x86/mathops.h b/avidemux/ADM_libraries/ADM_ffmpeg/libavcodec/x86/mathops.h
-index a66c601..d8257f0 100644
---- libavcodec/x86/mathops.h
-+++ libavcodec/x86/mathops.h
-@@ -22,7 +22,12 @@
- #ifndef AVCODEC_X86_MATHOPS_H
- #define AVCODEC_X86_MATHOPS_H
- 
-+// MEANX
-+#ifndef ADM_NO_CONFIG_H
- #include "config.h"
-+#endif
-+// MEANX
-+
- #include "libavutil/common.h"
- 
- #if ARCH_X86_32



From mean at mail.berlios.de  Wed May 26 07:26:49 2010
From: mean at mail.berlios.de (mean at BerliOS)
Date: Wed, 26 May 2010 07:26:49 +0200
Subject: [Avidemux-svn-commit] r6238 - in
	branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libswscale:
	. x86
Message-ID: <201005260526.o4Q5Qnsc029171@sheep.berlios.de>

Author: mean
Date: 2010-05-26 07:26:46 +0200 (Wed, 26 May 2010)
New Revision: 6238

Added:
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libswscale/utils.c
Modified:
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libswscale/ADM_mp.cpp
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libswscale/CMakeLists.txt
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libswscale/colorspace-test.c
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libswscale/rgb2rgb.c
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libswscale/rgb2rgb.h
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libswscale/rgb2rgb_template.c
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libswscale/swscale.c
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libswscale/swscale.h
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libswscale/swscale_internal.h
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libswscale/swscale_template.c
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libswscale/x86/yuv2rgb_mmx.c
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libswscale/x86/yuv2rgb_template.c
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libswscale/yuv2rgb.c
Log:
[swscale] Merge

Modified: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libswscale/ADM_mp.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libswscale/ADM_mp.cpp	2010-05-26 05:26:42 UTC (rev 6237)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libswscale/ADM_mp.cpp	2010-05-26 05:26:46 UTC (rev 6238)
@@ -18,12 +18,12 @@
 #include <string.h>
 #include <math.h>
 
-#include "config.h"
+#include "ADM_lavcodec.h"
+#include "ADM_mangle.h"
 #include "fourcc.h"
 
 
 extern "C" {
-#include "ADM_ffmpeg/libavcodec/avcodec.h"
 #include "ADM_ffmpeg/libavutil/avutil.h"
 #include "ADM_ffmpeg/libswscale/swscale.h"
 }

Modified: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libswscale/CMakeLists.txt
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libswscale/CMakeLists.txt	2010-05-26 05:26:42 UTC (rev 6237)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libswscale/CMakeLists.txt	2010-05-26 05:26:46 UTC (rev 6238)
@@ -1,6 +1,6 @@
 SET(ADM_LIB ADM_libswscale6)
 SET(${ADM_LIB}_SRCS 
-        swscale.c yuv2rgb.c rgb2rgb.c ADM_mp.cpp swscale_avoption.c
+        swscale.c yuv2rgb.c rgb2rgb.c ADM_mp.cpp swscale_avoption.c utils.c
 )
 
 IF(ADM_CPU_X86)

Modified: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libswscale/colorspace-test.c
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libswscale/colorspace-test.c	2010-05-26 05:26:42 UTC (rev 6237)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libswscale/colorspace-test.c	2010-05-26 05:26:46 UTC (rev 6238)
@@ -66,6 +66,9 @@
     int failedNum=0;
     int passedNum=0;
 
+    if (!srcBuffer || !dstBuffer)
+        return -1;
+
     av_log(NULL, AV_LOG_INFO, "memory corruption test ...\n");
     args_parse(argc, argv);
     av_log(NULL, AV_LOG_INFO, "CPU capabilities forced to %x\n", cpu_caps);

Modified: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libswscale/rgb2rgb.c
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libswscale/rgb2rgb.c	2010-05-26 05:26:42 UTC (rev 6237)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libswscale/rgb2rgb.c	2010-05-26 05:26:46 UTC (rev 6238)
@@ -74,7 +74,7 @@
                     long lumStride, long chromStride, long srcStride);
 void (*planar2x)(const uint8_t *src, uint8_t *dst, long width, long height,
                  long srcStride, long dstStride);
-void (*interleaveBytes)(uint8_t *src1, uint8_t *src2, uint8_t *dst,
+void (*interleaveBytes)(const uint8_t *src1, const uint8_t *src2, uint8_t *dst,
                         long width, long height, long src1Stride,
                         long src2Stride, long dstStride);
 void (*vu9_to_vu12)(const uint8_t *src1, const uint8_t *src2,
@@ -274,16 +274,16 @@
     long i;
     long num_pixels = src_size >> 2;
     for (i=0; i<num_pixels; i++) {
-        #if HAVE_BIGENDIAN
-            /* RGB32 (= A,B,G,R) -> BGR24 (= B,G,R) */
-            dst[3*i + 0] = src[4*i + 1];
-            dst[3*i + 1] = src[4*i + 2];
-            dst[3*i + 2] = src[4*i + 3];
-        #else
-            dst[3*i + 0] = src[4*i + 2];
-            dst[3*i + 1] = src[4*i + 1];
-            dst[3*i + 2] = src[4*i + 0];
-        #endif
+#if HAVE_BIGENDIAN
+        /* RGB32 (= A,B,G,R) -> BGR24 (= B,G,R) */
+        dst[3*i + 0] = src[4*i + 1];
+        dst[3*i + 1] = src[4*i + 2];
+        dst[3*i + 2] = src[4*i + 3];
+#else
+        dst[3*i + 0] = src[4*i + 2];
+        dst[3*i + 1] = src[4*i + 1];
+        dst[3*i + 2] = src[4*i + 0];
+#endif
     }
 }
 
@@ -291,18 +291,18 @@
 {
     long i;
     for (i=0; 3*i<src_size; i++) {
-        #if HAVE_BIGENDIAN
-            /* RGB24 (= R,G,B) -> BGR32 (= A,R,G,B) */
-            dst[4*i + 0] = 255;
-            dst[4*i + 1] = src[3*i + 0];
-            dst[4*i + 2] = src[3*i + 1];
-            dst[4*i + 3] = src[3*i + 2];
-        #else
-            dst[4*i + 0] = src[3*i + 2];
-            dst[4*i + 1] = src[3*i + 1];
-            dst[4*i + 2] = src[3*i + 0];
-            dst[4*i + 3] = 255;
-        #endif
+#if HAVE_BIGENDIAN
+        /* RGB24 (= R,G,B) -> BGR32 (= A,R,G,B) */
+        dst[4*i + 0] = 255;
+        dst[4*i + 1] = src[3*i + 0];
+        dst[4*i + 2] = src[3*i + 1];
+        dst[4*i + 3] = src[3*i + 2];
+#else
+        dst[4*i + 0] = src[3*i + 2];
+        dst[4*i + 1] = src[3*i + 1];
+        dst[4*i + 2] = src[3*i + 0];
+        dst[4*i + 3] = 255;
+#endif
     }
 }
 
@@ -315,17 +315,17 @@
     while (s < end) {
         register uint16_t bgr;
         bgr = *s++;
-        #if HAVE_BIGENDIAN
-            *d++ = 255;
-            *d++ = (bgr&0x1F)<<3;
-            *d++ = (bgr&0x7E0)>>3;
-            *d++ = (bgr&0xF800)>>8;
-        #else
-            *d++ = (bgr&0xF800)>>8;
-            *d++ = (bgr&0x7E0)>>3;
-            *d++ = (bgr&0x1F)<<3;
-            *d++ = 255;
-        #endif
+#if HAVE_BIGENDIAN
+        *d++ = 255;
+        *d++ = (bgr&0x1F)<<3;
+        *d++ = (bgr&0x7E0)>>3;
+        *d++ = (bgr&0xF800)>>8;
+#else
+        *d++ = (bgr&0xF800)>>8;
+        *d++ = (bgr&0x7E0)>>3;
+        *d++ = (bgr&0x1F)<<3;
+        *d++ = 255;
+#endif
     }
 }
 
@@ -375,17 +375,17 @@
     while (s < end) {
         register uint16_t bgr;
         bgr = *s++;
-        #if HAVE_BIGENDIAN
-            *d++ = 255;
-            *d++ = (bgr&0x1F)<<3;
-            *d++ = (bgr&0x3E0)>>2;
-            *d++ = (bgr&0x7C00)>>7;
-        #else
-            *d++ = (bgr&0x7C00)>>7;
-            *d++ = (bgr&0x3E0)>>2;
-            *d++ = (bgr&0x1F)<<3;
-            *d++ = 255;
-        #endif
+#if HAVE_BIGENDIAN
+        *d++ = 255;
+        *d++ = (bgr&0x1F)<<3;
+        *d++ = (bgr&0x3E0)>>2;
+        *d++ = (bgr&0x7C00)>>7;
+#else
+        *d++ = (bgr&0x7C00)>>7;
+        *d++ = (bgr&0x3E0)>>2;
+        *d++ = (bgr&0x1F)<<3;
+        *d++ = 255;
+#endif
     }
 }
 
@@ -442,3 +442,23 @@
         dst[i] = ((b<<1)&0x07) | ((g&0x07)<<3) | ((r&0x03)<<6);
     }
 }
+
+#define DEFINE_SHUFFLE_BYTES(a, b, c, d)                                \
+void shuffle_bytes_##a##b##c##d(const uint8_t *src, uint8_t *dst, long src_size) \
+{                                                                       \
+    long i;                                                             \
+                                                                        \
+    for (i = 0; i < src_size; i+=4) {                                   \
+        dst[i + 0] = src[i + a];                                        \
+        dst[i + 1] = src[i + b];                                        \
+        dst[i + 2] = src[i + c];                                        \
+        dst[i + 3] = src[i + d];                                        \
+    }                                                                   \
+}
+
+DEFINE_SHUFFLE_BYTES(0, 3, 2, 1);
+DEFINE_SHUFFLE_BYTES(1, 2, 3, 0);
+DEFINE_SHUFFLE_BYTES(2, 1, 0, 3);
+DEFINE_SHUFFLE_BYTES(3, 0, 1, 2);
+DEFINE_SHUFFLE_BYTES(3, 2, 1, 0);
+

Modified: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libswscale/rgb2rgb.h
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libswscale/rgb2rgb.h	2010-05-26 05:26:42 UTC (rev 6237)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libswscale/rgb2rgb.h	2010-05-26 05:26:46 UTC (rev 6238)
@@ -60,6 +60,11 @@
 void rgb15tobgr15(const uint8_t *src, uint8_t *dst, long src_size);
 void bgr8torgb8  (const uint8_t *src, uint8_t *dst, long src_size);
 
+void shuffle_bytes_0321(const uint8_t *src, uint8_t *dst, long src_size);
+void shuffle_bytes_1230(const uint8_t *src, uint8_t *dst, long src_size);
+void shuffle_bytes_2103(const uint8_t *src, uint8_t *dst, long src_size);
+void shuffle_bytes_3012(const uint8_t *src, uint8_t *dst, long src_size);
+void shuffle_bytes_3210(const uint8_t *src, uint8_t *dst, long src_size);
 
 void palette8topacked32(const uint8_t *src, uint8_t *dst, long num_pixels, const uint8_t *palette);
 void palette8topacked24(const uint8_t *src, uint8_t *dst, long num_pixels, const uint8_t *palette);
@@ -126,7 +131,7 @@
 extern void (*planar2x)(const uint8_t *src, uint8_t *dst, long width, long height,
                         long srcStride, long dstStride);
 
-extern void (*interleaveBytes)(uint8_t *src1, uint8_t *src2, uint8_t *dst,
+extern void (*interleaveBytes)(const uint8_t *src1, const uint8_t *src2, uint8_t *dst,
                                long width, long height, long src1Stride,
                                long src2Stride, long dstStride);
 

Modified: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libswscale/rgb2rgb_template.c
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libswscale/rgb2rgb_template.c	2010-05-26 05:26:42 UTC (rev 6237)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libswscale/rgb2rgb_template.c	2010-05-26 05:26:46 UTC (rev 6238)
@@ -34,7 +34,6 @@
 #undef EMMS
 #undef SFENCE
 #undef MMREG_SIZE
-#undef PREFETCHW
 #undef PAVGB
 
 #if HAVE_SSE2
@@ -45,15 +44,12 @@
 
 #if HAVE_AMD3DNOW
 #define PREFETCH  "prefetch"
-#define PREFETCHW "prefetchw"
 #define PAVGB     "pavgusb"
 #elif HAVE_MMX2
 #define PREFETCH "prefetchnta"
-#define PREFETCHW "prefetcht0"
 #define PAVGB     "pavgb"
 #else
 #define PREFETCH  " # nop"
-#define PREFETCHW " # nop"
 #endif
 
 #if HAVE_AMD3DNOW
@@ -76,11 +72,11 @@
     uint8_t *dest = dst;
     const uint8_t *s = src;
     const uint8_t *end;
-    #if HAVE_MMX
+#if HAVE_MMX
     const uint8_t *mm_end;
-    #endif
+#endif
     end = s + src_size;
-    #if HAVE_MMX
+#if HAVE_MMX
     __asm__ volatile(PREFETCH"    %0"::"m"(*s):"memory");
     mm_end = end - 23;
     __asm__ volatile("movq        %0, %%mm7"::"m"(mask32a):"memory");
@@ -111,21 +107,21 @@
     }
     __asm__ volatile(SFENCE:::"memory");
     __asm__ volatile(EMMS:::"memory");
-    #endif
+#endif
     while (s < end) {
-    #if HAVE_BIGENDIAN
+#if HAVE_BIGENDIAN
         /* RGB24 (= R,G,B) -> RGB32 (= A,B,G,R) */
         *dest++ = 255;
         *dest++ = s[2];
         *dest++ = s[1];
         *dest++ = s[0];
         s+=3;
-    #else
+#else
         *dest++ = *s++;
         *dest++ = *s++;
         *dest++ = *s++;
         *dest++ = 255;
-    #endif
+#endif
     }
 }
 
@@ -1436,7 +1432,7 @@
     const x86_reg chromWidth= width>>1;
     for (y=0; y<height; y++) {
 #if HAVE_MMX
-//FIXME handle 2 lines at once (fewer prefetches, reuse some chroma, but very likely memory-limited anyway)
+        //FIXME handle 2 lines at once (fewer prefetches, reuse some chroma, but very likely memory-limited anyway)
         __asm__ volatile(
             "xor                 %%"REG_a", %%"REG_a"   \n\t"
             ASMALIGN(4)
@@ -1586,7 +1582,7 @@
     const x86_reg chromWidth= width>>1;
     for (y=0; y<height; y++) {
 #if HAVE_MMX
-//FIXME handle 2 lines at once (fewer prefetches, reuse some chroma, but very likely memory-limited anyway)
+        //FIXME handle 2 lines at once (fewer prefetches, reuse some chroma, but very likely memory-limited anyway)
         __asm__ volatile(
             "xor                %%"REG_a", %%"REG_a"    \n\t"
             ASMALIGN(4)
@@ -2356,7 +2352,7 @@
     }
 }
 
-static void RENAME(interleaveBytes)(uint8_t *src1, uint8_t *src2, uint8_t *dest,
+static void RENAME(interleaveBytes)(const uint8_t *src1, const uint8_t *src2, uint8_t *dest,
                              long width, long height, long src1Stride,
                              long src2Stride, long dstStride)
 {

Modified: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libswscale/swscale.c
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libswscale/swscale.c	2010-05-26 05:26:42 UTC (rev 6237)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libswscale/swscale.c	2010-05-26 05:26:46 UTC (rev 6238)
@@ -54,35 +54,21 @@
   BGR24 -> YV12
 */
 
-#define _SVID_SOURCE //needed for MAP_ANONYMOUS
 #include <inttypes.h>
 #include <string.h>
 #include <math.h>
 #include <stdio.h>
 #include "config.h"
 #include <assert.h>
-#if HAVE_SYS_MMAN_H
-#include <sys/mman.h>
-#if defined(MAP_ANON) && !defined(MAP_ANONYMOUS)
-#define MAP_ANONYMOUS MAP_ANON
-#endif
-#endif
-#if HAVE_VIRTUALALLOC
-#define WIN32_LEAN_AND_MEAN
-#include <windows.h>
-#endif
 #include "swscale.h"
 #include "swscale_internal.h"
 #include "rgb2rgb.h"
 #include "libavutil/intreadwrite.h"
 #include "libavutil/x86_cpu.h"
+#include "libavutil/avutil.h"
 #include "libavutil/bswap.h"
+#include "libavutil/pixdesc.h"
 
-unsigned swscale_version(void)
-{
-    return LIBSWSCALE_VERSION_INT;
-}
-
 #undef MOVNTQ
 #undef PAVGB
 
@@ -94,92 +80,19 @@
 
 #define FAST_BGR2YV12 // use 7 bit coefficients instead of 15 bit
 
-#define RET 0xC3 //near return opcode for x86
-
 #ifdef M_PI
 #define PI M_PI
 #else
 #define PI 3.14159265358979323846
 #endif
 
-#define isSupportedIn(x)    (       \
-           (x)==PIX_FMT_YUV420P     \
-        || (x)==PIX_FMT_YUVA420P    \
-        || (x)==PIX_FMT_YUYV422     \
-        || (x)==PIX_FMT_UYVY422     \
-        || (x)==PIX_FMT_RGB48BE     \
-        || (x)==PIX_FMT_RGB48LE     \
-        || (x)==PIX_FMT_RGB32       \
-        || (x)==PIX_FMT_RGB32_1     \
-        || (x)==PIX_FMT_BGR24       \
-        || (x)==PIX_FMT_BGR565      \
-        || (x)==PIX_FMT_BGR555      \
-        || (x)==PIX_FMT_BGR32       \
-        || (x)==PIX_FMT_BGR32_1     \
-        || (x)==PIX_FMT_RGB24       \
-        || (x)==PIX_FMT_RGB565      \
-        || (x)==PIX_FMT_RGB555      \
-        || (x)==PIX_FMT_GRAY8       \
-        || (x)==PIX_FMT_YUV410P     \
-        || (x)==PIX_FMT_YUV440P     \
-        || (x)==PIX_FMT_GRAY16BE    \
-        || (x)==PIX_FMT_GRAY16LE    \
-        || (x)==PIX_FMT_YUV444P     \
-        || (x)==PIX_FMT_YUV422P     \
-        || (x)==PIX_FMT_YUV411P     \
-        || (x)==PIX_FMT_PAL8        \
-        || (x)==PIX_FMT_BGR8        \
-        || (x)==PIX_FMT_RGB8        \
-        || (x)==PIX_FMT_BGR4_BYTE   \
-        || (x)==PIX_FMT_RGB4_BYTE   \
-        || (x)==PIX_FMT_YUV440P     \
-        || (x)==PIX_FMT_MONOWHITE   \
-        || (x)==PIX_FMT_MONOBLACK   \
-        || (x)==PIX_FMT_YUV420PLE   \
-        || (x)==PIX_FMT_YUV422PLE   \
-        || (x)==PIX_FMT_YUV444PLE   \
-        || (x)==PIX_FMT_YUV420PBE   \
-        || (x)==PIX_FMT_YUV422PBE   \
-        || (x)==PIX_FMT_YUV444PBE   \
-    )
-#define isSupportedOut(x)   (       \
-           (x)==PIX_FMT_YUV420P     \
-        || (x)==PIX_FMT_YUVA420P    \
-        || (x)==PIX_FMT_YUYV422     \
-        || (x)==PIX_FMT_UYVY422     \
-        || (x)==PIX_FMT_YUV444P     \
-        || (x)==PIX_FMT_YUV422P     \
-        || (x)==PIX_FMT_YUV411P     \
-        || isRGB(x)                 \
-        || isBGR(x)                 \
-        || (x)==PIX_FMT_NV12        \
-        || (x)==PIX_FMT_NV21        \
-        || (x)==PIX_FMT_GRAY16BE    \
-        || (x)==PIX_FMT_GRAY16LE    \
-        || (x)==PIX_FMT_GRAY8       \
-        || (x)==PIX_FMT_YUV410P     \
-        || (x)==PIX_FMT_YUV440P     \
-        || (x)==PIX_FMT_YUV420PLE   \
-        || (x)==PIX_FMT_YUV422PLE   \
-        || (x)==PIX_FMT_YUV444PLE   \
-        || (x)==PIX_FMT_YUV420PBE   \
-        || (x)==PIX_FMT_YUV422PBE   \
-        || (x)==PIX_FMT_YUV444PBE   \
-    )
 #define isPacked(x)         (       \
            (x)==PIX_FMT_PAL8        \
         || (x)==PIX_FMT_YUYV422     \
         || (x)==PIX_FMT_UYVY422     \
-        || isRGB(x)                 \
-        || isBGR(x)                 \
+        || isAnyRGB(x)              \
     )
-#define usePal(x)           (       \
-           (x)==PIX_FMT_PAL8        \
-        || (x)==PIX_FMT_BGR4_BYTE   \
-        || (x)==PIX_FMT_RGB4_BYTE   \
-        || (x)==PIX_FMT_BGR8        \
-        || (x)==PIX_FMT_RGB8        \
-    )
+#define usePal(x) (av_pix_fmt_descriptors[x].flags & PIX_FMT_PAL)
 
 #define RGB2YUV_SHIFT 15
 #define BY ( (int)(0.114*219/255*(1<<RGB2YUV_SHIFT)+0.5))
@@ -192,8 +105,6 @@
 #define RV ( (int)(0.500*224/255*(1<<RGB2YUV_SHIFT)+0.5))
 #define RU (-(int)(0.169*224/255*(1<<RGB2YUV_SHIFT)+0.5))
 
-extern const int32_t ff_yuv2rgb_coeffs[8][4];
-
 static const double rgb2yuv_table[8][9]={
     {0.7152, 0.0722, 0.2126, -0.386, 0.5, -0.115, -0.454, -0.046, 0.5},
     {0.7152, 0.0722, 0.2126, -0.386, 0.5, -0.115, -0.454, -0.046, 0.5},
@@ -230,11 +141,11 @@
 DECLARE_ASM_CONST(8, uint64_t, bm11111000)=0xFFFFFFFFFF000000LL;
 DECLARE_ASM_CONST(8, uint64_t, bm01010101)=0x00FF00FF00FF00FFLL;
 
-const DECLARE_ALIGNED(8, uint64_t, ff_dither4[2]) = {
+const DECLARE_ALIGNED(8, uint64_t, ff_dither4)[2] = {
         0x0103010301030103LL,
         0x0200020002000200LL,};
 
-const DECLARE_ALIGNED(8, uint64_t, ff_dither8[2]) = {
+const DECLARE_ALIGNED(8, uint64_t, ff_dither8)[2] = {
         0x0602060206020602LL,
         0x0004000400040004LL,};
 
@@ -268,7 +179,7 @@
 DECLARE_ASM_CONST(8, uint64_t, ff_rgb24toY2Coeff) = 0x0C88408700000C88ULL;
 DECLARE_ASM_CONST(8, uint64_t, ff_bgr24toYOffset) = 0x0008400000084000ULL;
 
-DECLARE_ASM_CONST(8, uint64_t, ff_bgr24toUV[2][4]) = {
+DECLARE_ASM_CONST(8, uint64_t, ff_bgr24toUV)[2][4] = {
     {0x38380000DAC83838ULL, 0xECFFDAC80000ECFFULL, 0xF6E40000D0E3F6E4ULL, 0x3838D0E300003838ULL},
     {0xECFF0000DAC8ECFFULL, 0x3838DAC800003838ULL, 0x38380000D0E33838ULL, 0xF6E4D0E30000F6E4ULL},
 };
@@ -277,22 +188,17 @@
 
 #endif /* ARCH_X86 && CONFIG_GPL */
 
-// clipping helper table for C implementations:
-static unsigned char clip_table[768];
-
-static SwsVector *sws_getConvVec(SwsVector *a, SwsVector *b);
-
-DECLARE_ALIGNED(8, static const uint8_t, dither_2x2_4[2][8])={
+DECLARE_ALIGNED(8, static const uint8_t, dither_2x2_4)[2][8]={
 {  1,   3,   1,   3,   1,   3,   1,   3, },
 {  2,   0,   2,   0,   2,   0,   2,   0, },
 };
 
-DECLARE_ALIGNED(8, static const uint8_t, dither_2x2_8[2][8])={
+DECLARE_ALIGNED(8, static const uint8_t, dither_2x2_8)[2][8]={
 {  6,   2,   6,   2,   6,   2,   6,   2, },
 {  0,   4,   0,   4,   0,   4,   0,   4, },
 };
 
-DECLARE_ALIGNED(8, const uint8_t, dither_8x8_32[8][8])={
+DECLARE_ALIGNED(8, const uint8_t, dither_8x8_32)[8][8]={
 { 17,   9,  23,  15,  16,   8,  22,  14, },
 {  5,  29,   3,  27,   4,  28,   2,  26, },
 { 21,  13,  19,  11,  20,  12,  18,  10, },
@@ -303,7 +209,7 @@
 {  1,  25,   7,  31,   0,  24,   6,  30, },
 };
 
-DECLARE_ALIGNED(8, const uint8_t, dither_8x8_73[8][8])={
+DECLARE_ALIGNED(8, const uint8_t, dither_8x8_73)[8][8]={
 {  0,  55,  14,  68,   3,  58,  17,  72, },
 { 37,  18,  50,  32,  40,  22,  54,  35, },
 {  9,  64,   5,  59,  13,  67,   8,  63, },
@@ -315,7 +221,7 @@
 };
 
 #if 1
-DECLARE_ALIGNED(8, const uint8_t, dither_8x8_220[8][8])={
+DECLARE_ALIGNED(8, const uint8_t, dither_8x8_220)[8][8]={
 {117,  62, 158, 103, 113,  58, 155, 100, },
 { 34, 199,  21, 186,  31, 196,  17, 182, },
 {144,  89, 131,  76, 141,  86, 127,  72, },
@@ -327,7 +233,7 @@
 };
 #elif 1
 // tries to correct a gamma of 1.5
-DECLARE_ALIGNED(8, const uint8_t, dither_8x8_220[8][8])={
+DECLARE_ALIGNED(8, const uint8_t, dither_8x8_220)[8][8]={
 {  0, 143,  18, 200,   2, 156,  25, 215, },
 { 78,  28, 125,  64,  89,  36, 138,  74, },
 { 10, 180,   3, 161,  16, 195,   8, 175, },
@@ -339,7 +245,7 @@
 };
 #elif 1
 // tries to correct a gamma of 2.0
-DECLARE_ALIGNED(8, const uint8_t, dither_8x8_220[8][8])={
+DECLARE_ALIGNED(8, const uint8_t, dither_8x8_220)[8][8]={
 {  0, 124,   8, 193,   0, 140,  12, 213, },
 { 55,  14, 104,  42,  66,  19, 119,  52, },
 {  3, 168,   1, 145,   6, 187,   3, 162, },
@@ -351,7 +257,7 @@
 };
 #else
 // tries to correct a gamma of 2.5
-DECLARE_ALIGNED(8, const uint8_t, dither_8x8_220[8][8])={
+DECLARE_ALIGNED(8, const uint8_t, dither_8x8_220)[8][8]={
 {  0, 107,   3, 187,   0, 125,   6, 212, },
 { 39,   7,  86,  28,  49,  11, 102,  36, },
 {  1, 158,   0, 131,   3, 180,   1, 151, },
@@ -363,118 +269,6 @@
 };
 #endif
 
-const char *sws_format_name(enum PixelFormat format)
-{
-    switch (format) {
-    case PIX_FMT_YUV420P:
-        return "yuv420p";
-    case PIX_FMT_YUVA420P:
-        return "yuva420p";
-    case PIX_FMT_YUYV422:
-        return "yuyv422";
-    case PIX_FMT_RGB24:
-        return "rgb24";
-    case PIX_FMT_BGR24:
-        return "bgr24";
-    case PIX_FMT_YUV422P:
-        return "yuv422p";
-    case PIX_FMT_YUV444P:
-        return "yuv444p";
-    case PIX_FMT_RGB32:
-        return "rgb32";
-    case PIX_FMT_YUV410P:
-        return "yuv410p";
-    case PIX_FMT_YUV411P:
-        return "yuv411p";
-    case PIX_FMT_RGB565:
-        return "rgb565";
-    case PIX_FMT_RGB555:
-        return "rgb555";
-    case PIX_FMT_GRAY16BE:
-        return "gray16be";
-    case PIX_FMT_GRAY16LE:
-        return "gray16le";
-    case PIX_FMT_GRAY8:
-        return "gray8";
-    case PIX_FMT_MONOWHITE:
-        return "mono white";
-    case PIX_FMT_MONOBLACK:
-        return "mono black";
-    case PIX_FMT_PAL8:
-        return "Palette";
-    case PIX_FMT_YUVJ420P:
-        return "yuvj420p";
-    case PIX_FMT_YUVJ422P:
-        return "yuvj422p";
-    case PIX_FMT_YUVJ444P:
-        return "yuvj444p";
-    case PIX_FMT_XVMC_MPEG2_MC:
-        return "xvmc_mpeg2_mc";
-    case PIX_FMT_XVMC_MPEG2_IDCT:
-        return "xvmc_mpeg2_idct";
-    case PIX_FMT_UYVY422:
-        return "uyvy422";
-    case PIX_FMT_UYYVYY411:
-        return "uyyvyy411";
-    case PIX_FMT_RGB32_1:
-        return "rgb32x";
-    case PIX_FMT_BGR32_1:
-        return "bgr32x";
-    case PIX_FMT_BGR32:
-        return "bgr32";
-    case PIX_FMT_BGR565:
-        return "bgr565";
-    case PIX_FMT_BGR555:
-        return "bgr555";
-    case PIX_FMT_BGR8:
-        return "bgr8";
-    case PIX_FMT_BGR4:
-        return "bgr4";
-    case PIX_FMT_BGR4_BYTE:
-        return "bgr4 byte";
-    case PIX_FMT_RGB8:
-        return "rgb8";
-    case PIX_FMT_RGB4:
-        return "rgb4";
-    case PIX_FMT_RGB4_BYTE:
-        return "rgb4 byte";
-    case PIX_FMT_RGB48BE:
-        return "rgb48be";
-    case PIX_FMT_RGB48LE:
-        return "rgb48le";
-    case PIX_FMT_NV12:
-        return "nv12";
-    case PIX_FMT_NV21:
-        return "nv21";
-    case PIX_FMT_YUV440P:
-        return "yuv440p";
-    case PIX_FMT_VDPAU_H264:
-        return "vdpau_h264";
-    case PIX_FMT_VDPAU_MPEG1:
-        return "vdpau_mpeg1";
-    case PIX_FMT_VDPAU_MPEG2:
-        return "vdpau_mpeg2";
-    case PIX_FMT_VDPAU_WMV3:
-        return "vdpau_wmv3";
-    case PIX_FMT_VDPAU_VC1:
-        return "vdpau_vc1";
-    case PIX_FMT_YUV420PLE:
-        return "yuv420ple";
-    case PIX_FMT_YUV422PLE:
-        return "yuv422ple";
-    case PIX_FMT_YUV444PLE:
-        return "yuv444ple";
-    case PIX_FMT_YUV420PBE:
-        return "yuv420pbe";
-    case PIX_FMT_YUV422PBE:
-        return "yuv422pbe";
-    case PIX_FMT_YUV444PBE:
-        return "yuv444pbe";
-    default:
-        return "Unknown format";
-    }
-}
-
 static av_always_inline void yuv2yuvX16inC_template(const int16_t *lumFilter, const int16_t **lumSrc, int lumFilterSize,
                                                     const int16_t *chrFilter, const int16_t **chrSrc, int chrFilterSize,
                                                     const int16_t **alpSrc, uint16_t *dest, uint16_t *uDest, uint16_t *vDest, uint16_t *aDest,
@@ -674,7 +468,7 @@
             }\
             A1>>=19;\
             A2>>=19;\
-        }\
+        }
 
 #define YSCALE_YUV_2_PACKEDX_C(type,alpha) \
         YSCALE_YUV_2_PACKEDX_NOCLIP_C(type,alpha)\
@@ -719,7 +513,7 @@
             A >>=19;\
             if (A&256)\
                 A = av_clip_uint8(A);\
-        }\
+        }
 
 #define YSCALE_YUV_2_RGBX_FULL_C(rnd,alpha) \
     YSCALE_YUV_2_PACKEDX_FULL_C(rnd>>3,alpha)\
@@ -736,9 +530,8 @@
             else if (G<0)G=0;   \
             if (B>=(256<<22))   B=(256<<22)-1; \
             else if (B<0)B=0;   \
-        }\
+        }
 
-
 #define YSCALE_YUV_2_GRAY16_C \
     for (i=0; i<(dstW>>1); i++) {\
         int j;\
@@ -766,7 +559,7 @@
     YSCALE_YUV_2_PACKEDX_C(type,alpha)  /* FIXME fix tables so that clipping is not needed and then use _NOCLIP*/\
     r = (type *)c->table_rV[V];   \
     g = (type *)(c->table_gU[U] + c->table_gV[V]); \
-    b = (type *)c->table_bU[U];   \
+    b = (type *)c->table_bU[U];
 
 #define YSCALE_YUV_2_PACKED2_C(type,alpha)   \
     for (i=0; i<(dstW>>1); i++) { \
@@ -780,19 +573,19 @@
         if (alpha) {\
             A1= (abuf0[i2  ]*yalpha1+abuf1[i2  ]*yalpha)>>19;         \
             A2= (abuf0[i2+1]*yalpha1+abuf1[i2+1]*yalpha)>>19;         \
-        }\
+        }
 
 #define YSCALE_YUV_2_GRAY16_2_C   \
     for (i=0; i<(dstW>>1); i++) { \
         const int i2= 2*i;       \
         int Y1= (buf0[i2  ]*yalpha1+buf1[i2  ]*yalpha)>>11;           \
-        int Y2= (buf0[i2+1]*yalpha1+buf1[i2+1]*yalpha)>>11;           \
+        int Y2= (buf0[i2+1]*yalpha1+buf1[i2+1]*yalpha)>>11;
 
 #define YSCALE_YUV_2_RGB2_C(type,alpha) \
     YSCALE_YUV_2_PACKED2_C(type,alpha)\
     r = (type *)c->table_rV[V];\
     g = (type *)(c->table_gU[U] + c->table_gV[V]);\
-    b = (type *)c->table_bU[U];\
+    b = (type *)c->table_bU[U];
 
 #define YSCALE_YUV_2_PACKED1_C(type,alpha) \
     for (i=0; i<(dstW>>1); i++) {\
@@ -806,19 +599,19 @@
         if (alpha) {\
             A1= abuf0[i2  ]>>7;\
             A2= abuf0[i2+1]>>7;\
-        }\
+        }
 
 #define YSCALE_YUV_2_GRAY16_1_C \
     for (i=0; i<(dstW>>1); i++) {\
         const int i2= 2*i;\
         int Y1= buf0[i2  ]<<1;\
-        int Y2= buf0[i2+1]<<1;\
+        int Y2= buf0[i2+1]<<1;
 
 #define YSCALE_YUV_2_RGB1_C(type,alpha) \
     YSCALE_YUV_2_PACKED1_C(type,alpha)\
     r = (type *)c->table_rV[V];\
     g = (type *)(c->table_gU[U] + c->table_gV[V]);\
-    b = (type *)c->table_bU[U];\
+    b = (type *)c->table_bU[U];
 
 #define YSCALE_YUV_2_PACKED1B_C(type,alpha) \
     for (i=0; i<(dstW>>1); i++) {\
@@ -832,13 +625,13 @@
         if (alpha) {\
             A1= abuf0[i2  ]>>7;\
             A2= abuf0[i2+1]>>7;\
-        }\
+        }
 
 #define YSCALE_YUV_2_RGB1B_C(type,alpha) \
     YSCALE_YUV_2_PACKED1B_C(type,alpha)\
     r = (type *)c->table_rV[V];\
     g = (type *)(c->table_gU[U] + c->table_gV[V]);\
-    b = (type *)c->table_bU[U];\
+    b = (type *)c->table_bU[U];
 
 #define YSCALE_YUV_2_MONO2_C \
     const uint8_t * const d128=dither_8x8_220[y&7];\
@@ -855,9 +648,8 @@
         acc+= acc + g[((buf0[i+7]*yalpha1+buf1[i+7]*yalpha)>>19) + d128[7]];\
         ((uint8_t*)dest)[0]= c->dstFormat == PIX_FMT_MONOBLACK ? acc : ~acc;\
         dest++;\
-    }\
+    }
 
-
 #define YSCALE_YUV_2_MONOX_C \
     const uint8_t * const d128=dither_8x8_220[y&7];\
     uint8_t *g= c->table_gU[128] + c->table_gV[128];\
@@ -887,7 +679,6 @@
         }\
     }
 
-
 #define YSCALE_YUV_2_ANYRGB_C(func, func2, func_g16, func_monoblack)\
     switch(c->dstFormat) {\
     case PIX_FMT_RGB48BE:\
@@ -1075,9 +866,8 @@
             ((uint8_t*)dest)[2*i2+3]= Y2>>8;\
         }                \
         break;\
-    }\
+    }
 
-
 static inline void yuv2packedXinC(SwsContext *c, const int16_t *lumFilter, const int16_t **lumSrc, int lumFilterSize,
                                   const int16_t *chrFilter, const int16_t **chrSrc, int chrFilterSize,
                                   const int16_t **alpSrc, uint8_t *dest, int dstW, int y)
@@ -1091,7 +881,7 @@
                                     const int16_t **alpSrc, uint8_t *dest, int dstW, int y)
 {
     int i;
-    int step= fmt_depth(c->dstFormat)/8;
+    int step= c->dstFormatBpp/8;
     int aidx= 3;
 
     switch(c->dstFormat) {
@@ -1180,7 +970,8 @@
     }
 }
 
-static inline void rgb48ToY(uint8_t *dst, const uint8_t *src, int width)
+static inline void rgb48ToY(uint8_t *dst, const uint8_t *src, int width,
+                            uint32_t *unused)
 {
     int i;
     for (i = 0; i < width; i++) {
@@ -1193,7 +984,8 @@
 }
 
 static inline void rgb48ToUV(uint8_t *dstU, uint8_t *dstV,
-                             uint8_t *src1, uint8_t *src2, int width)
+                             const uint8_t *src1, const uint8_t *src2,
+                             int width, uint32_t *unused)
 {
     int i;
     assert(src1==src2);
@@ -1208,7 +1000,8 @@
 }
 
 static inline void rgb48ToUV_half(uint8_t *dstU, uint8_t *dstV,
-                                  uint8_t *src1, uint8_t *src2, int width)
+                                  const uint8_t *src1, const uint8_t *src2,
+                                  int width, uint32_t *unused)
 {
     int i;
     assert(src1==src2);
@@ -1332,7 +1125,6 @@
     }
 }
 
-
 //Note: we have C, MMX, MMX2, 3DNOW versions, there is no 3DNOW+MMX2 one
 //Plain C versions
 #if ((!HAVE_MMX || !CONFIG_GPL) && !HAVE_ALTIVEC) || CONFIG_RUNTIME_CPUDETECT
@@ -1421,521 +1213,8 @@
 
 #endif //ARCH_X86
 
-static double getSplineCoeff(double a, double b, double c, double d, double dist)
+SwsFunc ff_getSwsFunc(SwsContext *c)
 {
-//    printf("%f %f %f %f %f\n", a,b,c,d,dist);
-    if (dist<=1.0) return ((d*dist + c)*dist + b)*dist +a;
-    else           return getSplineCoeff(        0.0,
-                                          b+ 2.0*c + 3.0*d,
-                                                 c + 3.0*d,
-                                         -b- 3.0*c - 6.0*d,
-                                         dist-1.0);
-}
-
-static inline int initFilter(int16_t **outFilter, int16_t **filterPos, int *outFilterSize, int xInc,
-                             int srcW, int dstW, int filterAlign, int one, int flags,
-                             SwsVector *srcFilter, SwsVector *dstFilter, double param[2])
-{
-    int i;
-    int filterSize;
-    int filter2Size;
-    int minFilterSize;
-    int64_t *filter=NULL;
-    int64_t *filter2=NULL;
-    const int64_t fone= 1LL<<54;
-    int ret= -1;
-#if ARCH_X86
-    if (flags & SWS_CPU_CAPS_MMX)
-        __asm__ volatile("emms\n\t"::: "memory"); //FIXME this should not be required but it IS (even for non-MMX versions)
-#endif
-
-    // NOTE: the +1 is for the MMX scaler which reads over the end
-    *filterPos = av_malloc((dstW+1)*sizeof(int16_t));
-
-    if (FFABS(xInc - 0x10000) <10) { // unscaled
-        int i;
-        filterSize= 1;
-        filter= av_mallocz(dstW*sizeof(*filter)*filterSize);
-
-        for (i=0; i<dstW; i++) {
-            filter[i*filterSize]= fone;
-            (*filterPos)[i]=i;
-        }
-
-    } else if (flags&SWS_POINT) { // lame looking point sampling mode
-        int i;
-        int xDstInSrc;
-        filterSize= 1;
-        filter= av_malloc(dstW*sizeof(*filter)*filterSize);
-
-        xDstInSrc= xInc/2 - 0x8000;
-        for (i=0; i<dstW; i++) {
-            int xx= (xDstInSrc - ((filterSize-1)<<15) + (1<<15))>>16;
-
-            (*filterPos)[i]= xx;
-            filter[i]= fone;
-            xDstInSrc+= xInc;
-        }
-    } else if ((xInc <= (1<<16) && (flags&SWS_AREA)) || (flags&SWS_FAST_BILINEAR)) { // bilinear upscale
-        int i;
-        int xDstInSrc;
-        filterSize= 2;
-        filter= av_malloc(dstW*sizeof(*filter)*filterSize);
-
-        xDstInSrc= xInc/2 - 0x8000;
-        for (i=0; i<dstW; i++) {
-            int xx= (xDstInSrc - ((filterSize-1)<<15) + (1<<15))>>16;
-            int j;
-
-            (*filterPos)[i]= xx;
-            //bilinear upscale / linear interpolate / area averaging
-            for (j=0; j<filterSize; j++) {
-                int64_t coeff= fone - FFABS((xx<<16) - xDstInSrc)*(fone>>16);
-                if (coeff<0) coeff=0;
-                filter[i*filterSize + j]= coeff;
-                xx++;
-            }
-            xDstInSrc+= xInc;
-        }
-    } else {
-        int xDstInSrc;
-        int sizeFactor;
-
-        if      (flags&SWS_BICUBIC)      sizeFactor=  4;
-        else if (flags&SWS_X)            sizeFactor=  8;
-        else if (flags&SWS_AREA)         sizeFactor=  1; //downscale only, for upscale it is bilinear
-        else if (flags&SWS_GAUSS)        sizeFactor=  8;   // infinite ;)
-        else if (flags&SWS_LANCZOS)      sizeFactor= param[0] != SWS_PARAM_DEFAULT ? ceil(2*param[0]) : 6;
-        else if (flags&SWS_SINC)         sizeFactor= 20; // infinite ;)
-        else if (flags&SWS_SPLINE)       sizeFactor= 20;  // infinite ;)
-        else if (flags&SWS_BILINEAR)     sizeFactor=  2;
-        else {
-            sizeFactor= 0; //GCC warning killer
-            assert(0);
-        }
-
-        if (xInc <= 1<<16)      filterSize= 1 + sizeFactor; // upscale
-        else                    filterSize= 1 + (sizeFactor*srcW + dstW - 1)/ dstW;
-
-        if (filterSize > srcW-2) filterSize=srcW-2;
-
-        filter= av_malloc(dstW*sizeof(*filter)*filterSize);
-
-        xDstInSrc= xInc - 0x10000;
-        for (i=0; i<dstW; i++) {
-            int xx= (xDstInSrc - ((filterSize-2)<<16)) / (1<<17);
-            int j;
-            (*filterPos)[i]= xx;
-            for (j=0; j<filterSize; j++) {
-                int64_t d= ((int64_t)FFABS((xx<<17) - xDstInSrc))<<13;
-                double floatd;
-                int64_t coeff;
-
-                if (xInc > 1<<16)
-                    d= d*dstW/srcW;
-                floatd= d * (1.0/(1<<30));
-
-                if (flags & SWS_BICUBIC) {
-                    int64_t B= (param[0] != SWS_PARAM_DEFAULT ? param[0] :   0) * (1<<24);
-                    int64_t C= (param[1] != SWS_PARAM_DEFAULT ? param[1] : 0.6) * (1<<24);
-                    int64_t dd = ( d*d)>>30;
-                    int64_t ddd= (dd*d)>>30;
-
-                    if      (d < 1LL<<30)
-                        coeff = (12*(1<<24)-9*B-6*C)*ddd + (-18*(1<<24)+12*B+6*C)*dd + (6*(1<<24)-2*B)*(1<<30);
-                    else if (d < 1LL<<31)
-                        coeff = (-B-6*C)*ddd + (6*B+30*C)*dd + (-12*B-48*C)*d + (8*B+24*C)*(1<<30);
-                    else
-                        coeff=0.0;
-                    coeff *= fone>>(30+24);
-                }
-/*                else if (flags & SWS_X) {
-                    double p= param ? param*0.01 : 0.3;
-                    coeff = d ? sin(d*PI)/(d*PI) : 1.0;
-                    coeff*= pow(2.0, - p*d*d);
-                }*/
-                else if (flags & SWS_X) {
-                    double A= param[0] != SWS_PARAM_DEFAULT ? param[0] : 1.0;
-                    double c;
-
-                    if (floatd<1.0)
-                        c = cos(floatd*PI);
-                    else
-                        c=-1.0;
-                    if (c<0.0)      c= -pow(-c, A);
-                    else            c=  pow( c, A);
-                    coeff= (c*0.5 + 0.5)*fone;
-                } else if (flags & SWS_AREA) {
-                    int64_t d2= d - (1<<29);
-                    if      (d2*xInc < -(1LL<<(29+16))) coeff= 1.0 * (1LL<<(30+16));
-                    else if (d2*xInc <  (1LL<<(29+16))) coeff= -d2*xInc + (1LL<<(29+16));
-                    else coeff=0.0;
-                    coeff *= fone>>(30+16);
-                } else if (flags & SWS_GAUSS) {
-                    double p= param[0] != SWS_PARAM_DEFAULT ? param[0] : 3.0;
-                    coeff = (pow(2.0, - p*floatd*floatd))*fone;
-                } else if (flags & SWS_SINC) {
-                    coeff = (d ? sin(floatd*PI)/(floatd*PI) : 1.0)*fone;
-                } else if (flags & SWS_LANCZOS) {
-                    double p= param[0] != SWS_PARAM_DEFAULT ? param[0] : 3.0;
-                    coeff = (d ? sin(floatd*PI)*sin(floatd*PI/p)/(floatd*floatd*PI*PI/p) : 1.0)*fone;
-                    if (floatd>p) coeff=0;
-                } else if (flags & SWS_BILINEAR) {
-                    coeff= (1<<30) - d;
-                    if (coeff<0) coeff=0;
-                    coeff *= fone >> 30;
-                } else if (flags & SWS_SPLINE) {
-                    double p=-2.196152422706632;
-                    coeff = getSplineCoeff(1.0, 0.0, p, -p-1.0, floatd) * fone;
-                } else {
-                    coeff= 0.0; //GCC warning killer
-                    assert(0);
-                }
-
-                filter[i*filterSize + j]= coeff;
-                xx++;
-            }
-            xDstInSrc+= 2*xInc;
-        }
-    }
-
-    /* apply src & dst Filter to filter -> filter2
-       av_free(filter);
-    */
-    assert(filterSize>0);
-    filter2Size= filterSize;
-    if (srcFilter) filter2Size+= srcFilter->length - 1;
-    if (dstFilter) filter2Size+= dstFilter->length - 1;
-    assert(filter2Size>0);
-    filter2= av_mallocz(filter2Size*dstW*sizeof(*filter2));
-
-    for (i=0; i<dstW; i++) {
-        int j, k;
-
-        if(srcFilter) {
-            for (k=0; k<srcFilter->length; k++) {
-                for (j=0; j<filterSize; j++)
-                    filter2[i*filter2Size + k + j] += srcFilter->coeff[k]*filter[i*filterSize + j];
-            }
-        } else {
-            for (j=0; j<filterSize; j++)
-                filter2[i*filter2Size + j]= filter[i*filterSize + j];
-        }
-        //FIXME dstFilter
-
-        (*filterPos)[i]+= (filterSize-1)/2 - (filter2Size-1)/2;
-    }
-    av_freep(&filter);
-
-    /* try to reduce the filter-size (step1 find size and shift left) */
-    // Assume it is near normalized (*0.5 or *2.0 is OK but * 0.001 is not).
-    minFilterSize= 0;
-    for (i=dstW-1; i>=0; i--) {
-        int min= filter2Size;
-        int j;
-        int64_t cutOff=0.0;
-
-        /* get rid off near zero elements on the left by shifting left */
-        for (j=0; j<filter2Size; j++) {
-            int k;
-            cutOff += FFABS(filter2[i*filter2Size]);
-
-            if (cutOff > SWS_MAX_REDUCE_CUTOFF*fone) break;
-
-            /* preserve monotonicity because the core can't handle the filter otherwise */
-            if (i<dstW-1 && (*filterPos)[i] >= (*filterPos)[i+1]) break;
-
-            // move filter coefficients left
-            for (k=1; k<filter2Size; k++)
-                filter2[i*filter2Size + k - 1]= filter2[i*filter2Size + k];
-            filter2[i*filter2Size + k - 1]= 0;
-            (*filterPos)[i]++;
-        }
-
-        cutOff=0;
-        /* count near zeros on the right */
-        for (j=filter2Size-1; j>0; j--) {
-            cutOff += FFABS(filter2[i*filter2Size + j]);
-
-            if (cutOff > SWS_MAX_REDUCE_CUTOFF*fone) break;
-            min--;
-        }
-
-        if (min>minFilterSize) minFilterSize= min;
-    }
-
-    if (flags & SWS_CPU_CAPS_ALTIVEC) {
-        // we can handle the special case 4,
-        // so we don't want to go to the full 8
-        if (minFilterSize < 5)
-            filterAlign = 4;
-
-        // We really don't want to waste our time
-        // doing useless computation, so fall back on
-        // the scalar C code for very small filters.
-        // Vectorizing is worth it only if you have a
-        // decent-sized vector.
-        if (minFilterSize < 3)
-            filterAlign = 1;
-    }
-
-    if (flags & SWS_CPU_CAPS_MMX) {
-        // special case for unscaled vertical filtering
-        if (minFilterSize == 1 && filterAlign == 2)
-            filterAlign= 1;
-    }
-
-    assert(minFilterSize > 0);
-    filterSize= (minFilterSize +(filterAlign-1)) & (~(filterAlign-1));
-    assert(filterSize > 0);
-    filter= av_malloc(filterSize*dstW*sizeof(*filter));
-    if (filterSize >= MAX_FILTER_SIZE*16/((flags&SWS_ACCURATE_RND) ? APCK_SIZE : 16) || !filter)
-        goto error;
-    *outFilterSize= filterSize;
-
-    if (flags&SWS_PRINT_INFO)
-        av_log(NULL, AV_LOG_VERBOSE, "SwScaler: reducing / aligning filtersize %d -> %d\n", filter2Size, filterSize);
-    /* try to reduce the filter-size (step2 reduce it) */
-    for (i=0; i<dstW; i++) {
-        int j;
-
-        for (j=0; j<filterSize; j++) {
-            if (j>=filter2Size) filter[i*filterSize + j]= 0;
-            else               filter[i*filterSize + j]= filter2[i*filter2Size + j];
-            if((flags & SWS_BITEXACT) && j>=minFilterSize)
-                filter[i*filterSize + j]= 0;
-        }
-    }
-
-
-    //FIXME try to align filterPos if possible
-
-    //fix borders
-    for (i=0; i<dstW; i++) {
-        int j;
-        if ((*filterPos)[i] < 0) {
-            // move filter coefficients left to compensate for filterPos
-            for (j=1; j<filterSize; j++) {
-                int left= FFMAX(j + (*filterPos)[i], 0);
-                filter[i*filterSize + left] += filter[i*filterSize + j];
-                filter[i*filterSize + j]=0;
-            }
-            (*filterPos)[i]= 0;
-        }
-
-        if ((*filterPos)[i] + filterSize > srcW) {
-            int shift= (*filterPos)[i] + filterSize - srcW;
-            // move filter coefficients right to compensate for filterPos
-            for (j=filterSize-2; j>=0; j--) {
-                int right= FFMIN(j + shift, filterSize-1);
-                filter[i*filterSize +right] += filter[i*filterSize +j];
-                filter[i*filterSize +j]=0;
-            }
-            (*filterPos)[i]= srcW - filterSize;
-        }
-    }
-
-    // Note the +1 is for the MMX scaler which reads over the end
-    /* align at 16 for AltiVec (needed by hScale_altivec_real) */
-    *outFilter= av_mallocz(*outFilterSize*(dstW+1)*sizeof(int16_t));
-
-    /* normalize & store in outFilter */
-    for (i=0; i<dstW; i++) {
-        int j;
-        int64_t error=0;
-        int64_t sum=0;
-
-        for (j=0; j<filterSize; j++) {
-            sum+= filter[i*filterSize + j];
-        }
-        sum= (sum + one/2)/ one;
-        for (j=0; j<*outFilterSize; j++) {
-            int64_t v= filter[i*filterSize + j] + error;
-            int intV= ROUNDED_DIV(v, sum);
-            (*outFilter)[i*(*outFilterSize) + j]= intV;
-            error= v - intV*sum;
-        }
-    }
-
-    (*filterPos)[dstW]= (*filterPos)[dstW-1]; // the MMX scaler will read over the end
-    for (i=0; i<*outFilterSize; i++) {
-        int j= dstW*(*outFilterSize);
-        (*outFilter)[j + i]= (*outFilter)[j + i - (*outFilterSize)];
-    }
-
-    ret=0;
-error:
-    av_free(filter);
-    av_free(filter2);
-    return ret;
-}
-
-#ifdef COMPILE_MMX2
-static int initMMX2HScaler(int dstW, int xInc, uint8_t *filterCode, int16_t *filter, int32_t *filterPos, int numSplits)
-{
-    uint8_t *fragmentA;
-    x86_reg imm8OfPShufW1A;
-    x86_reg imm8OfPShufW2A;
-    x86_reg fragmentLengthA;
-    uint8_t *fragmentB;
-    x86_reg imm8OfPShufW1B;
-    x86_reg imm8OfPShufW2B;
-    x86_reg fragmentLengthB;
-    int fragmentPos;
-
-    int xpos, i;
-
-    // create an optimized horizontal scaling routine
-
-    //code fragment
-
-    __asm__ volatile(
-        "jmp                         9f                 \n\t"
-    // Begin
-        "0:                                             \n\t"
-        "movq    (%%"REG_d", %%"REG_a"), %%mm3          \n\t"
-        "movd    (%%"REG_c", %%"REG_S"), %%mm0          \n\t"
-        "movd   1(%%"REG_c", %%"REG_S"), %%mm1          \n\t"
-        "punpcklbw                %%mm7, %%mm1          \n\t"
-        "punpcklbw                %%mm7, %%mm0          \n\t"
-        "pshufw                   $0xFF, %%mm1, %%mm1   \n\t"
-        "1:                                             \n\t"
-        "pshufw                   $0xFF, %%mm0, %%mm0   \n\t"
-        "2:                                             \n\t"
-        "psubw                    %%mm1, %%mm0          \n\t"
-        "movl   8(%%"REG_b", %%"REG_a"), %%esi          \n\t"
-        "pmullw                   %%mm3, %%mm0          \n\t"
-        "psllw                       $7, %%mm1          \n\t"
-        "paddw                    %%mm1, %%mm0          \n\t"
-
-        "movq                     %%mm0, (%%"REG_D", %%"REG_a") \n\t"
-
-        "add                         $8, %%"REG_a"      \n\t"
-    // End
-        "9:                                             \n\t"
-//        "int $3                                         \n\t"
-        "lea                 " LOCAL_MANGLE(0b) ", %0   \n\t"
-        "lea                 " LOCAL_MANGLE(1b) ", %1   \n\t"
-        "lea                 " LOCAL_MANGLE(2b) ", %2   \n\t"
-        "dec                         %1                 \n\t"
-        "dec                         %2                 \n\t"
-        "sub                         %0, %1             \n\t"
-        "sub                         %0, %2             \n\t"
-        "lea                 " LOCAL_MANGLE(9b) ", %3   \n\t"
-        "sub                         %0, %3             \n\t"
-
-
-        :"=r" (fragmentA), "=r" (imm8OfPShufW1A), "=r" (imm8OfPShufW2A),
-        "=r" (fragmentLengthA)
-    );
-
-    __asm__ volatile(
-        "jmp                         9f                 \n\t"
-    // Begin
-        "0:                                             \n\t"
-        "movq    (%%"REG_d", %%"REG_a"), %%mm3          \n\t"
-        "movd    (%%"REG_c", %%"REG_S"), %%mm0          \n\t"
-        "punpcklbw                %%mm7, %%mm0          \n\t"
-        "pshufw                   $0xFF, %%mm0, %%mm1   \n\t"
-        "1:                                             \n\t"
-        "pshufw                   $0xFF, %%mm0, %%mm0   \n\t"
-        "2:                                             \n\t"
-        "psubw                    %%mm1, %%mm0          \n\t"
-        "movl   8(%%"REG_b", %%"REG_a"), %%esi          \n\t"
-        "pmullw                   %%mm3, %%mm0          \n\t"
-        "psllw                       $7, %%mm1          \n\t"
-        "paddw                    %%mm1, %%mm0          \n\t"
-
-        "movq                     %%mm0, (%%"REG_D", %%"REG_a") \n\t"
-
-        "add                         $8, %%"REG_a"      \n\t"
-    // End
-        "9:                                             \n\t"
-//        "int                       $3                   \n\t"
-        "lea                 " LOCAL_MANGLE(0b) ", %0   \n\t"
-        "lea                 " LOCAL_MANGLE(1b) ", %1   \n\t"
-        "lea                 " LOCAL_MANGLE(2b) ", %2   \n\t"
-        "dec                         %1                 \n\t"
-        "dec                         %2                 \n\t"
-        "sub                         %0, %1             \n\t"
-        "sub                         %0, %2             \n\t"
-        "lea                 " LOCAL_MANGLE(9b) ", %3   \n\t"
-        "sub                         %0, %3             \n\t"
-
-
-        :"=r" (fragmentB), "=r" (imm8OfPShufW1B), "=r" (imm8OfPShufW2B),
-        "=r" (fragmentLengthB)
-    );
-
-    xpos= 0; //lumXInc/2 - 0x8000; // difference between pixel centers
-    fragmentPos=0;
-
-    for (i=0; i<dstW/numSplits; i++) {
-        int xx=xpos>>16;
-
-        if ((i&3) == 0) {
-            int a=0;
-            int b=((xpos+xInc)>>16) - xx;
-            int c=((xpos+xInc*2)>>16) - xx;
-            int d=((xpos+xInc*3)>>16) - xx;
-            int inc                = (d+1<4);
-            uint8_t *fragment      = (d+1<4) ? fragmentB       : fragmentA;
-            x86_reg imm8OfPShufW1  = (d+1<4) ? imm8OfPShufW1B  : imm8OfPShufW1A;
-            x86_reg imm8OfPShufW2  = (d+1<4) ? imm8OfPShufW2B  : imm8OfPShufW2A;
-            x86_reg fragmentLength = (d+1<4) ? fragmentLengthB : fragmentLengthA;
-            int maxShift= 3-(d+inc);
-            int shift=0;
-
-            if (filterCode) {
-                filter[i  ] = (( xpos         & 0xFFFF) ^ 0xFFFF)>>9;
-                filter[i+1] = (((xpos+xInc  ) & 0xFFFF) ^ 0xFFFF)>>9;
-                filter[i+2] = (((xpos+xInc*2) & 0xFFFF) ^ 0xFFFF)>>9;
-                filter[i+3] = (((xpos+xInc*3) & 0xFFFF) ^ 0xFFFF)>>9;
-                filterPos[i/2]= xx;
-
-                memcpy(filterCode + fragmentPos, fragment, fragmentLength);
-
-                filterCode[fragmentPos + imm8OfPShufW1]=
-                    (a+inc) | ((b+inc)<<2) | ((c+inc)<<4) | ((d+inc)<<6);
-                filterCode[fragmentPos + imm8OfPShufW2]=
-                    a | (b<<2) | (c<<4) | (d<<6);
-
-                if (i+4-inc>=dstW) shift=maxShift; //avoid overread
-                else if ((filterPos[i/2]&3) <= maxShift) shift=filterPos[i/2]&3; //Align
-
-                if (shift && i>=shift) {
-                    filterCode[fragmentPos + imm8OfPShufW1]+= 0x55*shift;
-                    filterCode[fragmentPos + imm8OfPShufW2]+= 0x55*shift;
-                    filterPos[i/2]-=shift;
-                }
-            }
-
-            fragmentPos+= fragmentLength;
-
-            if (filterCode)
-                filterCode[fragmentPos]= RET;
-        }
-        xpos+=xInc;
-    }
-    if (filterCode)
-        filterPos[((i/2)+1)&(~1)]= xpos>>16; // needed to jump to the next part
-
-    return fragmentPos + 1;
-}
-#endif /* COMPILE_MMX2 */
-
-static void globalInit(void)
-{
-    // generating tables:
-    int i;
-    for (i=0; i<768; i++) {
-        int c= av_clip_uint8(i-256);
-        clip_table[i]=c;
-    }
-}
-
-static SwsFunc getSwsFunc(SwsContext *c)
-{
 #if CONFIG_RUNTIME_CPUDETECT
     int flags = c->flags;
 
@@ -1988,7 +1267,7 @@
 #endif //!CONFIG_RUNTIME_CPUDETECT
 }
 
-static int PlanarToNV12Wrapper(SwsContext *c, uint8_t* src[], int srcStride[], int srcSliceY,
+static int planarToNv12Wrapper(SwsContext *c, const uint8_t* src[], int srcStride[], int srcSliceY,
                                int srcSliceH, uint8_t* dstParam[], int dstStride[])
 {
     uint8_t *dst=dstParam[0] + dstStride[0]*srcSliceY;
@@ -2014,7 +1293,7 @@
     return srcSliceH;
 }
 
-static int PlanarToYuy2Wrapper(SwsContext *c, uint8_t* src[], int srcStride[], int srcSliceY,
+static int planarToYuy2Wrapper(SwsContext *c, const uint8_t* src[], int srcStride[], int srcSliceY,
                                int srcSliceH, uint8_t* dstParam[], int dstStride[])
 {
     uint8_t *dst=dstParam[0] + dstStride[0]*srcSliceY;
@@ -2024,7 +1303,7 @@
     return srcSliceH;
 }
 
-static int PlanarToUyvyWrapper(SwsContext *c, uint8_t* src[], int srcStride[], int srcSliceY,
+static int planarToUyvyWrapper(SwsContext *c, const uint8_t* src[], int srcStride[], int srcSliceY,
                                int srcSliceH, uint8_t* dstParam[], int dstStride[])
 {
     uint8_t *dst=dstParam[0] + dstStride[0]*srcSliceY;
@@ -2034,7 +1313,7 @@
     return srcSliceH;
 }
 
-static int YUV422PToYuy2Wrapper(SwsContext *c, uint8_t* src[], int srcStride[], int srcSliceY,
+static int yuv422pToYuy2Wrapper(SwsContext *c, const uint8_t* src[], int srcStride[], int srcSliceY,
                                 int srcSliceH, uint8_t* dstParam[], int dstStride[])
 {
     uint8_t *dst=dstParam[0] + dstStride[0]*srcSliceY;
@@ -2044,7 +1323,7 @@
     return srcSliceH;
 }
 
-static int YUV422PToUyvyWrapper(SwsContext *c, uint8_t* src[], int srcStride[], int srcSliceY,
+static int yuv422pToUyvyWrapper(SwsContext *c, const uint8_t* src[], int srcStride[], int srcSliceY,
                                 int srcSliceH, uint8_t* dstParam[], int dstStride[])
 {
     uint8_t *dst=dstParam[0] + dstStride[0]*srcSliceY;
@@ -2054,7 +1333,7 @@
     return srcSliceH;
 }
 
-static int YUYV2YUV420Wrapper(SwsContext *c, uint8_t* src[], int srcStride[], int srcSliceY,
+static int yuyvToYuv420Wrapper(SwsContext *c, const uint8_t* src[], int srcStride[], int srcSliceY,
                                int srcSliceH, uint8_t* dstParam[], int dstStride[])
 {
     uint8_t *ydst=dstParam[0] + dstStride[0]*srcSliceY;
@@ -2069,7 +1348,7 @@
     return srcSliceH;
 }
 
-static int YUYV2YUV422Wrapper(SwsContext *c, uint8_t* src[], int srcStride[], int srcSliceY,
+static int yuyvToYuv422Wrapper(SwsContext *c, const uint8_t* src[], int srcStride[], int srcSliceY,
                                int srcSliceH, uint8_t* dstParam[], int dstStride[])
 {
     uint8_t *ydst=dstParam[0] + dstStride[0]*srcSliceY;
@@ -2081,7 +1360,7 @@
     return srcSliceH;
 }
 
-static int UYVY2YUV420Wrapper(SwsContext *c, uint8_t* src[], int srcStride[], int srcSliceY,
+static int uyvyToYuv420Wrapper(SwsContext *c, const uint8_t* src[], int srcStride[], int srcSliceY,
                                int srcSliceH, uint8_t* dstParam[], int dstStride[])
 {
     uint8_t *ydst=dstParam[0] + dstStride[0]*srcSliceY;
@@ -2096,7 +1375,7 @@
     return srcSliceH;
 }
 
-static int UYVY2YUV422Wrapper(SwsContext *c, uint8_t* src[], int srcStride[], int srcSliceY,
+static int uyvyToYuv422Wrapper(SwsContext *c, const uint8_t* src[], int srcStride[], int srcSliceY,
                                int srcSliceH, uint8_t* dstParam[], int dstStride[])
 {
     uint8_t *ydst=dstParam[0] + dstStride[0]*srcSliceY;
@@ -2108,8 +1387,8 @@
     return srcSliceH;
 }
 
-static int pal2rgbWrapper(SwsContext *c, uint8_t* src[], int srcStride[], int srcSliceY,
-                          int srcSliceH, uint8_t* dst[], int dstStride[])
+static int palToRgbWrapper(SwsContext *c, const uint8_t* src[], int srcStride[], int srcSliceY,
+                           int srcSliceH, uint8_t* dst[], int dstStride[])
 {
     const enum PixelFormat srcFormat= c->srcFormat;
     const enum PixelFormat dstFormat= c->dstFormat;
@@ -2117,48 +1396,71 @@
                  const uint8_t *palette)=NULL;
     int i;
     uint8_t *dstPtr= dst[0] + dstStride[0]*srcSliceY;
-    uint8_t *srcPtr= src[0];
+    const uint8_t *srcPtr= src[0];
 
-    if (!usePal(srcFormat))
+    if (usePal(srcFormat)) {
+        switch (dstFormat) {
+        case PIX_FMT_RGB32  : conv = palette8topacked32; break;
+        case PIX_FMT_BGR32  : conv = palette8topacked32; break;
+        case PIX_FMT_BGR32_1: conv = palette8topacked32; break;
+        case PIX_FMT_RGB32_1: conv = palette8topacked32; break;
+        case PIX_FMT_RGB24  : conv = palette8topacked24; break;
+        case PIX_FMT_BGR24  : conv = palette8topacked24; break;
+        }
+    }
+
+    if (!conv)
         av_log(c, AV_LOG_ERROR, "internal error %s -> %s converter\n",
                sws_format_name(srcFormat), sws_format_name(dstFormat));
-
-    switch(dstFormat) {
-    case PIX_FMT_RGB32  : conv = palette8topacked32; break;
-    case PIX_FMT_BGR32  : conv = palette8topacked32; break;
-    case PIX_FMT_BGR32_1: conv = palette8topacked32; break;
-    case PIX_FMT_RGB32_1: conv = palette8topacked32; break;
-    case PIX_FMT_RGB24  : conv = palette8topacked24; break;
-    case PIX_FMT_BGR24  : conv = palette8topacked24; break;
-    default: av_log(c, AV_LOG_ERROR, "internal error %s -> %s converter\n",
-                    sws_format_name(srcFormat), sws_format_name(dstFormat)); break;
+    else {
+        for (i=0; i<srcSliceH; i++) {
+            conv(srcPtr, dstPtr, c->srcW, (uint8_t *) c->pal_rgb);
+            srcPtr+= srcStride[0];
+            dstPtr+= dstStride[0];
+        }
     }
 
-
-    for (i=0; i<srcSliceH; i++) {
-        conv(srcPtr, dstPtr, c->srcW, (uint8_t *) c->pal_rgb);
-        srcPtr+= srcStride[0];
-        dstPtr+= dstStride[0];
-    }
-
     return srcSliceH;
 }
 
+#define isRGBA32(x) (            \
+           (x) == PIX_FMT_ARGB   \
+        || (x) == PIX_FMT_RGBA   \
+        || (x) == PIX_FMT_BGRA   \
+        || (x) == PIX_FMT_ABGR   \
+        )
+
 /* {RGB,BGR}{15,16,24,32,32_1} -> {RGB,BGR}{15,16,24,32} */
-static int rgb2rgbWrapper(SwsContext *c, uint8_t* src[], int srcStride[], int srcSliceY,
-                          int srcSliceH, uint8_t* dst[], int dstStride[])
+static int rgbToRgbWrapper(SwsContext *c, const uint8_t* src[], int srcStride[], int srcSliceY,
+                           int srcSliceH, uint8_t* dst[], int dstStride[])
 {
     const enum PixelFormat srcFormat= c->srcFormat;
     const enum PixelFormat dstFormat= c->dstFormat;
-    const int srcBpp= (fmt_depth(srcFormat) + 7) >> 3;
-    const int dstBpp= (fmt_depth(dstFormat) + 7) >> 3;
-    const int srcId= fmt_depth(srcFormat) >> 2; /* 1:0, 4:1, 8:2, 15:3, 16:4, 24:6, 32:8 */
-    const int dstId= fmt_depth(dstFormat) >> 2;
+    const int srcBpp= (c->srcFormatBpp + 7) >> 3;
+    const int dstBpp= (c->dstFormatBpp + 7) >> 3;
+    const int srcId= c->srcFormatBpp >> 2; /* 1:0, 4:1, 8:2, 15:3, 16:4, 24:6, 32:8 */
+    const int dstId= c->dstFormatBpp >> 2;
     void (*conv)(const uint8_t *src, uint8_t *dst, long src_size)=NULL;
 
+#define CONV_IS(src, dst) (srcFormat == PIX_FMT_##src && dstFormat == PIX_FMT_##dst)
+
+    if (isRGBA32(srcFormat) && isRGBA32(dstFormat)) {
+        if (     CONV_IS(ABGR, RGBA)
+              || CONV_IS(ARGB, BGRA)
+              || CONV_IS(BGRA, ARGB)
+              || CONV_IS(RGBA, ABGR)) conv = shuffle_bytes_3210;
+        else if (CONV_IS(ABGR, ARGB)
+              || CONV_IS(ARGB, ABGR)) conv = shuffle_bytes_0321;
+        else if (CONV_IS(ABGR, BGRA)
+              || CONV_IS(ARGB, RGBA)) conv = shuffle_bytes_1230;
+        else if (CONV_IS(BGRA, RGBA)
+              || CONV_IS(RGBA, BGRA)) conv = shuffle_bytes_2103;
+        else if (CONV_IS(BGRA, ABGR)
+              || CONV_IS(RGBA, ARGB)) conv = shuffle_bytes_3012;
+    } else
     /* BGR -> BGR */
-    if (  (isBGR(srcFormat) && isBGR(dstFormat))
-       || (isRGB(srcFormat) && isRGB(dstFormat))) {
+    if (  (isBGRinInt(srcFormat) && isBGRinInt(dstFormat))
+       || (isRGBinInt(srcFormat) && isRGBinInt(dstFormat))) {
         switch(srcId | (dstId<<4)) {
         case 0x34: conv= rgb16to15; break;
         case 0x36: conv= rgb24to15; break;
@@ -2172,11 +1474,9 @@
         case 0x83: conv= rgb15to32; break;
         case 0x84: conv= rgb16to32; break;
         case 0x86: conv= rgb24to32; break;
-        default: av_log(c, AV_LOG_ERROR, "internal error %s -> %s converter\n",
-                        sws_format_name(srcFormat), sws_format_name(dstFormat)); break;
         }
-    } else if (  (isBGR(srcFormat) && isRGB(dstFormat))
-             || (isRGB(srcFormat) && isBGR(dstFormat))) {
+    } else if (  (isBGRinInt(srcFormat) && isRGBinInt(dstFormat))
+             || (isRGBinInt(srcFormat) && isBGRinInt(dstFormat))) {
         switch(srcId | (dstId<<4)) {
         case 0x33: conv= rgb15tobgr15; break;
         case 0x34: conv= rgb16tobgr15; break;
@@ -2193,25 +1493,26 @@
         case 0x83: conv= rgb15tobgr32; break;
         case 0x84: conv= rgb16tobgr32; break;
         case 0x86: conv= rgb24tobgr32; break;
-        case 0x88: conv= rgb32tobgr32; break;
-        default: av_log(c, AV_LOG_ERROR, "internal error %s -> %s converter\n",
-                        sws_format_name(srcFormat), sws_format_name(dstFormat)); break;
         }
-    } else {
-        av_log(c, AV_LOG_ERROR, "internal error %s -> %s converter\n",
-               sws_format_name(srcFormat), sws_format_name(dstFormat));
     }
 
-    if(conv) {
-        uint8_t *srcPtr= src[0];
-        if(srcFormat == PIX_FMT_RGB32_1 || srcFormat == PIX_FMT_BGR32_1)
+    if (!conv) {
+        av_log(c, AV_LOG_ERROR, "internal error %s -> %s converter\n",
+               sws_format_name(srcFormat), sws_format_name(dstFormat));
+    } else {
+        const uint8_t *srcPtr= src[0];
+              uint8_t *dstPtr= dst[0];
+        if ((srcFormat == PIX_FMT_RGB32_1 || srcFormat == PIX_FMT_BGR32_1) && !isRGBA32(dstFormat))
             srcPtr += ALT32_CORR;
 
+        if ((dstFormat == PIX_FMT_RGB32_1 || dstFormat == PIX_FMT_BGR32_1) && !isRGBA32(srcFormat))
+            dstPtr += ALT32_CORR;
+
         if (dstStride[0]*srcBpp == srcStride[0]*dstBpp && srcStride[0] > 0)
-            conv(srcPtr, dst[0] + dstStride[0]*srcSliceY, srcSliceH*srcStride[0]);
+            conv(srcPtr, dstPtr + dstStride[0]*srcSliceY, srcSliceH*srcStride[0]);
         else {
             int i;
-            uint8_t *dstPtr= dst[0] + dstStride[0]*srcSliceY;
+            dstPtr += dstStride[0]*srcSliceY;
 
             for (i=0; i<srcSliceH; i++) {
                 conv(srcPtr, dstPtr, c->srcW*srcBpp);
@@ -2223,10 +1524,9 @@
     return srcSliceH;
 }
 
-static int bgr24toyv12Wrapper(SwsContext *c, uint8_t* src[], int srcStride[], int srcSliceY,
+static int bgr24ToYv12Wrapper(SwsContext *c, const uint8_t* src[], int srcStride[], int srcSliceY,
                               int srcSliceH, uint8_t* dst[], int dstStride[])
 {
-
     rgb24toyv12(
         src[0],
         dst[0]+ srcSliceY    *dstStride[0],
@@ -2239,7 +1539,7 @@
     return srcSliceH;
 }
 
-static int yvu9toyv12Wrapper(SwsContext *c, uint8_t* src[], int srcStride[], int srcSliceY,
+static int yvu9ToYv12Wrapper(SwsContext *c, const uint8_t* src[], int srcStride[], int srcSliceY,
                              int srcSliceH, uint8_t* dst[], int dstStride[])
 {
     int i;
@@ -2248,7 +1548,7 @@
     if (srcStride[0]==dstStride[0] && srcStride[0] > 0)
         memcpy(dst[0]+ srcSliceY*dstStride[0], src[0], srcStride[0]*srcSliceH);
     else {
-        uint8_t *srcPtr= src[0];
+        const uint8_t *srcPtr= src[0];
         uint8_t *dstPtr= dst[0] + dstStride[0]*srcSliceY;
 
         for (i=0; i<srcSliceH; i++) {
@@ -2275,14 +1575,14 @@
 }
 
 /* unscaled copy like stuff (assumes nearly identical formats) */
-static int packedCopy(SwsContext *c, uint8_t* src[], int srcStride[], int srcSliceY,
-                      int srcSliceH, uint8_t* dst[], int dstStride[])
+static int packedCopyWrapper(SwsContext *c, const uint8_t* src[], int srcStride[], int srcSliceY,
+                             int srcSliceH, uint8_t* dst[], int dstStride[])
 {
     if (dstStride[0]==srcStride[0] && srcStride[0] > 0)
         memcpy(dst[0] + dstStride[0]*srcSliceY, src[0], srcSliceH*dstStride[0]);
     else {
         int i;
-        uint8_t *srcPtr= src[0];
+        const uint8_t *srcPtr= src[0];
         uint8_t *dstPtr= dst[0] + dstStride[0]*srcSliceY;
         int length=0;
 
@@ -2300,15 +1600,15 @@
     return srcSliceH;
 }
 
-static int planarCopy(SwsContext *c, uint8_t* src[], int srcStride[], int srcSliceY,
-                      int srcSliceH, uint8_t* dst[], int dstStride[])
+static int planarCopyWrapper(SwsContext *c, const uint8_t* src[], int srcStride[], int srcSliceY,
+                             int srcSliceH, uint8_t* dst[], int dstStride[])
 {
     int plane, i, j;
     for (plane=0; plane<4; plane++) {
         int length= (plane==0 || plane==3) ? c->srcW  : -((-c->srcW  )>>c->chrDstHSubSample);
         int y=      (plane==0 || plane==3) ? srcSliceY: -((-srcSliceY)>>c->chrDstVSubSample);
         int height= (plane==0 || plane==3) ? srcSliceH: -((-srcSliceH)>>c->chrDstVSubSample);
-        uint8_t *srcPtr= src[plane];
+        const uint8_t *srcPtr= src[plane];
         uint8_t *dstPtr= dst[plane] + dstStride[plane]*y;
 
         if (!dst[plane]) continue;
@@ -2340,7 +1640,7 @@
 
                 for (i=0; i<height; i++) {
                     for (j=0; j<length; j++)
-                        ((uint16_t*)dstPtr)[j] = bswap_16(((uint16_t*)srcPtr)[j]);
+                        ((uint16_t*)dstPtr)[j] = bswap_16(((const uint16_t*)srcPtr)[j]);
                     srcPtr+= srcStride[plane];
                     dstPtr+= dstStride[plane];
                 }
@@ -2360,182 +1660,9 @@
     return srcSliceH;
 }
 
-
-static void getSubSampleFactors(int *h, int *v, int format)
+int ff_hardcodedcpuflags(void)
 {
-    switch(format) {
-    case PIX_FMT_UYVY422:
-    case PIX_FMT_YUYV422:
-        *h=1;
-        *v=0;
-        break;
-    case PIX_FMT_YUV420P:
-    case PIX_FMT_YUV420PLE:
-    case PIX_FMT_YUV420PBE:
-    case PIX_FMT_YUVA420P:
-    case PIX_FMT_GRAY16BE:
-    case PIX_FMT_GRAY16LE:
-    case PIX_FMT_GRAY8: //FIXME remove after different subsamplings are fully implemented
-    case PIX_FMT_NV12:
-    case PIX_FMT_NV21:
-        *h=1;
-        *v=1;
-        break;
-    case PIX_FMT_YUV440P:
-        *h=0;
-        *v=1;
-        break;
-    case PIX_FMT_YUV410P:
-        *h=2;
-        *v=2;
-        break;
-    case PIX_FMT_YUV444P:
-    case PIX_FMT_YUV444PLE:
-    case PIX_FMT_YUV444PBE:
-        *h=0;
-        *v=0;
-        break;
-    case PIX_FMT_YUV422P:
-    case PIX_FMT_YUV422PLE:
-    case PIX_FMT_YUV422PBE:
-        *h=1;
-        *v=0;
-        break;
-    case PIX_FMT_YUV411P:
-        *h=2;
-        *v=0;
-        break;
-    default:
-        *h=0;
-        *v=0;
-        break;
-    }
-}
-
-static uint16_t roundToInt16(int64_t f)
-{
-    int r= (f + (1<<15))>>16;
-         if (r<-0x7FFF) return 0x8000;
-    else if (r> 0x7FFF) return 0x7FFF;
-    else                return r;
-}
-
-int sws_setColorspaceDetails(SwsContext *c, const int inv_table[4], int srcRange, const int table[4], int dstRange, int brightness, int contrast, int saturation)
-{
-    int64_t crv =  inv_table[0];
-    int64_t cbu =  inv_table[1];
-    int64_t cgu = -inv_table[2];
-    int64_t cgv = -inv_table[3];
-    int64_t cy  = 1<<16;
-    int64_t oy  = 0;
-
-    memcpy(c->srcColorspaceTable, inv_table, sizeof(int)*4);
-    memcpy(c->dstColorspaceTable,     table, sizeof(int)*4);
-
-    c->brightness= brightness;
-    c->contrast  = contrast;
-    c->saturation= saturation;
-    c->srcRange  = srcRange;
-    c->dstRange  = dstRange;
-    if (isYUV(c->dstFormat) || isGray(c->dstFormat)) return -1;
-
-    c->uOffset=   0x0400040004000400LL;
-    c->vOffset=   0x0400040004000400LL;
-
-    if (!srcRange) {
-        cy= (cy*255) / 219;
-        oy= 16<<16;
-    } else {
-        crv= (crv*224) / 255;
-        cbu= (cbu*224) / 255;
-        cgu= (cgu*224) / 255;
-        cgv= (cgv*224) / 255;
-    }
-
-    cy = (cy *contrast             )>>16;
-    crv= (crv*contrast * saturation)>>32;
-    cbu= (cbu*contrast * saturation)>>32;
-    cgu= (cgu*contrast * saturation)>>32;
-    cgv= (cgv*contrast * saturation)>>32;
-
-    oy -= 256*brightness;
-
-    c->yCoeff=    roundToInt16(cy *8192) * 0x0001000100010001ULL;
-    c->vrCoeff=   roundToInt16(crv*8192) * 0x0001000100010001ULL;
-    c->ubCoeff=   roundToInt16(cbu*8192) * 0x0001000100010001ULL;
-    c->vgCoeff=   roundToInt16(cgv*8192) * 0x0001000100010001ULL;
-    c->ugCoeff=   roundToInt16(cgu*8192) * 0x0001000100010001ULL;
-    c->yOffset=   roundToInt16(oy *   8) * 0x0001000100010001ULL;
-
-    c->yuv2rgb_y_coeff  = (int16_t)roundToInt16(cy <<13);
-    c->yuv2rgb_y_offset = (int16_t)roundToInt16(oy << 9);
-    c->yuv2rgb_v2r_coeff= (int16_t)roundToInt16(crv<<13);
-    c->yuv2rgb_v2g_coeff= (int16_t)roundToInt16(cgv<<13);
-    c->yuv2rgb_u2g_coeff= (int16_t)roundToInt16(cgu<<13);
-    c->yuv2rgb_u2b_coeff= (int16_t)roundToInt16(cbu<<13);
-
-    ff_yuv2rgb_c_init_tables(c, inv_table, srcRange, brightness, contrast, saturation);
-    //FIXME factorize
-
-#ifdef COMPILE_ALTIVEC
-    if (c->flags & SWS_CPU_CAPS_ALTIVEC)
-        ff_yuv2rgb_init_tables_altivec(c, inv_table, brightness, contrast, saturation);
-#endif
-    return 0;
-}
-
-int sws_getColorspaceDetails(SwsContext *c, int **inv_table, int *srcRange, int **table, int *dstRange, int *brightness, int *contrast, int *saturation)
-{
-    if (isYUV(c->dstFormat) || isGray(c->dstFormat)) return -1;
-
-    *inv_table = c->srcColorspaceTable;
-    *table     = c->dstColorspaceTable;
-    *srcRange  = c->srcRange;
-    *dstRange  = c->dstRange;
-    *brightness= c->brightness;
-    *contrast  = c->contrast;
-    *saturation= c->saturation;
-
-    return 0;
-}
-
-static int handle_jpeg(enum PixelFormat *format)
-{
-    switch (*format) {
-    case PIX_FMT_YUVJ420P:
-        *format = PIX_FMT_YUV420P;
-        return 1;
-    case PIX_FMT_YUVJ422P:
-        *format = PIX_FMT_YUV422P;
-        return 1;
-    case PIX_FMT_YUVJ444P:
-        *format = PIX_FMT_YUV444P;
-        return 1;
-    case PIX_FMT_YUVJ440P:
-        *format = PIX_FMT_YUV440P;
-        return 1;
-    default:
-        return 0;
-    }
-}
-
-SwsContext *sws_getContext(int srcW, int srcH, enum PixelFormat srcFormat, int dstW, int dstH, enum PixelFormat dstFormat, int flags,
-                           SwsFilter *srcFilter, SwsFilter *dstFilter, const double *param)
-{
-
-    SwsContext *c;
-    int i;
-    int usesVFilter, usesHFilter;
-    int unscaled, needsDither;
-    int srcRange, dstRange;
-    SwsFilter dummyFilter= {NULL, NULL, NULL, NULL};
-#if ARCH_X86
-    if (flags & SWS_CPU_CAPS_MMX)
-        __asm__ volatile("emms\n\t"::: "memory");
-#endif
-
-#if !CONFIG_RUNTIME_CPUDETECT //ensure that the flags match the compiled variant if cpudetect is off
-    flags &= ~(SWS_CPU_CAPS_MMX|SWS_CPU_CAPS_MMX2|SWS_CPU_CAPS_3DNOW|SWS_CPU_CAPS_ALTIVEC|SWS_CPU_CAPS_BFIN);
+    int flags = 0;
 #if   COMPILE_TEMPLATE_MMX2
     flags |= SWS_CPU_CAPS_MMX|SWS_CPU_CAPS_MMX2;
 #elif COMPILE_TEMPLATE_AMD3DNOW
@@ -2547,517 +1674,134 @@
 #elif ARCH_BFIN
     flags |= SWS_CPU_CAPS_BFIN;
 #endif
-#endif /* CONFIG_RUNTIME_CPUDETECT */
-    if (clip_table[512] != 255) globalInit();
-    if (!rgb15to16) sws_rgb2rgb_init(flags);
+    return flags;
+}
 
-    unscaled = (srcW == dstW && srcH == dstH);
-    needsDither= (isBGR(dstFormat) || isRGB(dstFormat))
-        && (fmt_depth(dstFormat))<24
-        && ((fmt_depth(dstFormat))<(fmt_depth(srcFormat)) || (!(isRGB(srcFormat) || isBGR(srcFormat))));
+void ff_get_unscaled_swscale(SwsContext *c)
+{
+    const enum PixelFormat srcFormat = c->srcFormat;
+    const enum PixelFormat dstFormat = c->dstFormat;
+    const int flags = c->flags;
+    const int dstH = c->dstH;
+    int needsDither;
 
-    srcRange = handle_jpeg(&srcFormat);
-    dstRange = handle_jpeg(&dstFormat);
+    needsDither= isAnyRGB(dstFormat)
+        &&  c->dstFormatBpp < 24
+        && (c->dstFormatBpp < c->srcFormatBpp || (!isAnyRGB(srcFormat)));
 
-    if (!isSupportedIn(srcFormat)) {
-        av_log(NULL, AV_LOG_ERROR, "swScaler: %s is not supported as input pixel format\n", sws_format_name(srcFormat));
-        return NULL;
+    /* yv12_to_nv12 */
+    if ((srcFormat == PIX_FMT_YUV420P || srcFormat == PIX_FMT_YUVA420P) && (dstFormat == PIX_FMT_NV12 || dstFormat == PIX_FMT_NV21)) {
+        c->swScale= planarToNv12Wrapper;
     }
-    if (!isSupportedOut(dstFormat)) {
-        av_log(NULL, AV_LOG_ERROR, "swScaler: %s is not supported as output pixel format\n", sws_format_name(dstFormat));
-        return NULL;
+    /* yuv2bgr */
+    if ((srcFormat==PIX_FMT_YUV420P || srcFormat==PIX_FMT_YUV422P || srcFormat==PIX_FMT_YUVA420P) && isAnyRGB(dstFormat)
+        && !(flags & SWS_ACCURATE_RND) && !(dstH&1)) {
+        c->swScale= ff_yuv2rgb_get_func_ptr(c);
     }
 
-    i= flags & ( SWS_POINT
-                |SWS_AREA
-                |SWS_BILINEAR
-                |SWS_FAST_BILINEAR
-                |SWS_BICUBIC
-                |SWS_X
-                |SWS_GAUSS
-                |SWS_LANCZOS
-                |SWS_SINC
-                |SWS_SPLINE
-                |SWS_BICUBLIN);
-    if(!i || (i & (i-1))) {
-        av_log(NULL, AV_LOG_ERROR, "swScaler: Exactly one scaler algorithm must be chosen\n");
-        return NULL;
+    if (srcFormat==PIX_FMT_YUV410P && (dstFormat==PIX_FMT_YUV420P || dstFormat==PIX_FMT_YUVA420P) && !(flags & SWS_BITEXACT)) {
+        c->swScale= yvu9ToYv12Wrapper;
     }
 
-    /* sanity check */
-    if (srcW<4 || srcH<1 || dstW<8 || dstH<1) { //FIXME check if these are enough and try to lowwer them after fixing the relevant parts of the code
-        av_log(NULL, AV_LOG_ERROR, "swScaler: %dx%d -> %dx%d is invalid scaling dimension\n",
-               srcW, srcH, dstW, dstH);
-        return NULL;
-    }
-    if(srcW > VOFW || dstW > VOFW) {
-        av_log(NULL, AV_LOG_ERROR, "swScaler: Compile-time maximum width is "AV_STRINGIFY(VOFW)" change VOF/VOFW and recompile\n");
-        return NULL;
-    }
+    /* bgr24toYV12 */
+    if (srcFormat==PIX_FMT_BGR24 && (dstFormat==PIX_FMT_YUV420P || dstFormat==PIX_FMT_YUVA420P) && !(flags & SWS_ACCURATE_RND))
+        c->swScale= bgr24ToYv12Wrapper;
 
-    if (!dstFilter) dstFilter= &dummyFilter;
-    if (!srcFilter) srcFilter= &dummyFilter;
+    /* RGB/BGR -> RGB/BGR (no dither needed forms) */
+    if (   isAnyRGB(srcFormat)
+        && isAnyRGB(dstFormat)
+        && srcFormat != PIX_FMT_BGR8      && dstFormat != PIX_FMT_BGR8
+        && srcFormat != PIX_FMT_RGB8      && dstFormat != PIX_FMT_RGB8
+        && srcFormat != PIX_FMT_BGR4      && dstFormat != PIX_FMT_BGR4
+        && srcFormat != PIX_FMT_RGB4      && dstFormat != PIX_FMT_RGB4
+        && srcFormat != PIX_FMT_BGR4_BYTE && dstFormat != PIX_FMT_BGR4_BYTE
+        && srcFormat != PIX_FMT_RGB4_BYTE && dstFormat != PIX_FMT_RGB4_BYTE
+        && srcFormat != PIX_FMT_MONOBLACK && dstFormat != PIX_FMT_MONOBLACK
+        && srcFormat != PIX_FMT_MONOWHITE && dstFormat != PIX_FMT_MONOWHITE
+        && srcFormat != PIX_FMT_RGB48LE   && dstFormat != PIX_FMT_RGB48LE
+        && srcFormat != PIX_FMT_RGB48BE   && dstFormat != PIX_FMT_RGB48BE
+        && (!needsDither || (c->flags&(SWS_FAST_BILINEAR|SWS_POINT))))
+        c->swScale= rgbToRgbWrapper;
 
-    c= av_mallocz(sizeof(SwsContext));
+    if ((usePal(srcFormat) && (
+        dstFormat == PIX_FMT_RGB32   ||
+        dstFormat == PIX_FMT_RGB32_1 ||
+        dstFormat == PIX_FMT_RGB24   ||
+        dstFormat == PIX_FMT_BGR32   ||
+        dstFormat == PIX_FMT_BGR32_1 ||
+        dstFormat == PIX_FMT_BGR24)))
+        c->swScale= palToRgbWrapper;
 
-    c->av_class = &sws_context_class;
-    c->srcW= srcW;
-    c->srcH= srcH;
-    c->dstW= dstW;
-    c->dstH= dstH;
-    c->lumXInc= ((srcW<<16) + (dstW>>1))/dstW;
-    c->lumYInc= ((srcH<<16) + (dstH>>1))/dstH;
-    c->flags= flags;
-    c->dstFormat= dstFormat;
-    c->srcFormat= srcFormat;
-    c->vRounder= 4* 0x0001000100010001ULL;
-
-    usesHFilter= usesVFilter= 0;
-    if (dstFilter->lumV && dstFilter->lumV->length>1) usesVFilter=1;
-    if (dstFilter->lumH && dstFilter->lumH->length>1) usesHFilter=1;
-    if (dstFilter->chrV && dstFilter->chrV->length>1) usesVFilter=1;
-    if (dstFilter->chrH && dstFilter->chrH->length>1) usesHFilter=1;
-    if (srcFilter->lumV && srcFilter->lumV->length>1) usesVFilter=1;
-    if (srcFilter->lumH && srcFilter->lumH->length>1) usesHFilter=1;
-    if (srcFilter->chrV && srcFilter->chrV->length>1) usesVFilter=1;
-    if (srcFilter->chrH && srcFilter->chrH->length>1) usesHFilter=1;
-
-    getSubSampleFactors(&c->chrSrcHSubSample, &c->chrSrcVSubSample, srcFormat);
-    getSubSampleFactors(&c->chrDstHSubSample, &c->chrDstVSubSample, dstFormat);
-
-    // reuse chroma for 2 pixels RGB/BGR unless user wants full chroma interpolation
-    if ((isBGR(dstFormat) || isRGB(dstFormat)) && !(flags&SWS_FULL_CHR_H_INT)) c->chrDstHSubSample=1;
-
-    // drop some chroma lines if the user wants it
-    c->vChrDrop= (flags&SWS_SRC_V_CHR_DROP_MASK)>>SWS_SRC_V_CHR_DROP_SHIFT;
-    c->chrSrcVSubSample+= c->vChrDrop;
-
-    // drop every other pixel for chroma calculation unless user wants full chroma
-    if ((isBGR(srcFormat) || isRGB(srcFormat)) && !(flags&SWS_FULL_CHR_H_INP)
-      && srcFormat!=PIX_FMT_RGB8      && srcFormat!=PIX_FMT_BGR8
-      && srcFormat!=PIX_FMT_RGB4      && srcFormat!=PIX_FMT_BGR4
-      && srcFormat!=PIX_FMT_RGB4_BYTE && srcFormat!=PIX_FMT_BGR4_BYTE
-      && ((dstW>>c->chrDstHSubSample) <= (srcW>>1) || (flags&(SWS_FAST_BILINEAR|SWS_POINT))))
-        c->chrSrcHSubSample=1;
-
-    if (param) {
-        c->param[0] = param[0];
-        c->param[1] = param[1];
-    } else {
-        c->param[0] =
-        c->param[1] = SWS_PARAM_DEFAULT;
+    if (srcFormat == PIX_FMT_YUV422P) {
+        if (dstFormat == PIX_FMT_YUYV422)
+            c->swScale= yuv422pToYuy2Wrapper;
+        else if (dstFormat == PIX_FMT_UYVY422)
+            c->swScale= yuv422pToUyvyWrapper;
     }
 
-    // Note the -((-x)>>y) is so that we always round toward +inf.
-    c->chrSrcW= -((-srcW) >> c->chrSrcHSubSample);
-    c->chrSrcH= -((-srcH) >> c->chrSrcVSubSample);
-    c->chrDstW= -((-dstW) >> c->chrDstHSubSample);
-    c->chrDstH= -((-dstH) >> c->chrDstVSubSample);
-
-    sws_setColorspaceDetails(c, ff_yuv2rgb_coeffs[SWS_CS_DEFAULT], srcRange, ff_yuv2rgb_coeffs[SWS_CS_DEFAULT] /* FIXME*/, dstRange, 0, 1<<16, 1<<16);
-
-    /* unscaled special cases */
-    if (unscaled && !usesHFilter && !usesVFilter && (srcRange == dstRange || isBGR(dstFormat) || isRGB(dstFormat))) {
-        /* yv12_to_nv12 */
-        if ((srcFormat == PIX_FMT_YUV420P || srcFormat == PIX_FMT_YUVA420P) && (dstFormat == PIX_FMT_NV12 || dstFormat == PIX_FMT_NV21)) {
-            c->swScale= PlanarToNV12Wrapper;
-        }
-        /* yuv2bgr */
-        if ((srcFormat==PIX_FMT_YUV420P || srcFormat==PIX_FMT_YUV422P || srcFormat==PIX_FMT_YUVA420P) && (isBGR(dstFormat) || isRGB(dstFormat))
-            && !(flags & SWS_ACCURATE_RND) && !(dstH&1)) {
-            c->swScale= ff_yuv2rgb_get_func_ptr(c);
-        }
-
-        if (srcFormat==PIX_FMT_YUV410P && (dstFormat==PIX_FMT_YUV420P || dstFormat==PIX_FMT_YUVA420P) && !(flags & SWS_BITEXACT)) {
-            c->swScale= yvu9toyv12Wrapper;
-        }
-
-        /* bgr24toYV12 */
-        if (srcFormat==PIX_FMT_BGR24 && (dstFormat==PIX_FMT_YUV420P || dstFormat==PIX_FMT_YUVA420P) && !(flags & SWS_ACCURATE_RND))
-            c->swScale= bgr24toyv12Wrapper;
-
-        /* RGB/BGR -> RGB/BGR (no dither needed forms) */
-        if (  (isBGR(srcFormat) || isRGB(srcFormat))
-           && (isBGR(dstFormat) || isRGB(dstFormat))
-           && srcFormat != PIX_FMT_BGR8      && dstFormat != PIX_FMT_BGR8
-           && srcFormat != PIX_FMT_RGB8      && dstFormat != PIX_FMT_RGB8
-           && srcFormat != PIX_FMT_BGR4      && dstFormat != PIX_FMT_BGR4
-           && srcFormat != PIX_FMT_RGB4      && dstFormat != PIX_FMT_RGB4
-           && srcFormat != PIX_FMT_BGR4_BYTE && dstFormat != PIX_FMT_BGR4_BYTE
-           && srcFormat != PIX_FMT_RGB4_BYTE && dstFormat != PIX_FMT_RGB4_BYTE
-           && srcFormat != PIX_FMT_MONOBLACK && dstFormat != PIX_FMT_MONOBLACK
-           && srcFormat != PIX_FMT_MONOWHITE && dstFormat != PIX_FMT_MONOWHITE
-                                             && dstFormat != PIX_FMT_RGB32_1
-                                             && dstFormat != PIX_FMT_BGR32_1
-           && srcFormat != PIX_FMT_RGB48LE   && dstFormat != PIX_FMT_RGB48LE
-           && srcFormat != PIX_FMT_RGB48BE   && dstFormat != PIX_FMT_RGB48BE
-           && (!needsDither || (c->flags&(SWS_FAST_BILINEAR|SWS_POINT))))
-             c->swScale= rgb2rgbWrapper;
-
-        if ((usePal(srcFormat) && (
-                 dstFormat == PIX_FMT_RGB32   ||
-                 dstFormat == PIX_FMT_RGB32_1 ||
-                 dstFormat == PIX_FMT_RGB24   ||
-                 dstFormat == PIX_FMT_BGR32   ||
-                 dstFormat == PIX_FMT_BGR32_1 ||
-                 dstFormat == PIX_FMT_BGR24)))
-             c->swScale= pal2rgbWrapper;
-
-        if (srcFormat == PIX_FMT_YUV422P) {
+    /* LQ converters if -sws 0 or -sws 4*/
+    if (c->flags&(SWS_FAST_BILINEAR|SWS_POINT)) {
+        /* yv12_to_yuy2 */
+        if (srcFormat == PIX_FMT_YUV420P || srcFormat == PIX_FMT_YUVA420P) {
             if (dstFormat == PIX_FMT_YUYV422)
-                c->swScale= YUV422PToYuy2Wrapper;
+                c->swScale= planarToYuy2Wrapper;
             else if (dstFormat == PIX_FMT_UYVY422)
-                c->swScale= YUV422PToUyvyWrapper;
+                c->swScale= planarToUyvyWrapper;
         }
+    }
+    if(srcFormat == PIX_FMT_YUYV422 && (dstFormat == PIX_FMT_YUV420P || dstFormat == PIX_FMT_YUVA420P))
+        c->swScale= yuyvToYuv420Wrapper;
+    if(srcFormat == PIX_FMT_UYVY422 && (dstFormat == PIX_FMT_YUV420P || dstFormat == PIX_FMT_YUVA420P))
+        c->swScale= uyvyToYuv420Wrapper;
+    if(srcFormat == PIX_FMT_YUYV422 && dstFormat == PIX_FMT_YUV422P)
+        c->swScale= yuyvToYuv422Wrapper;
+    if(srcFormat == PIX_FMT_UYVY422 && dstFormat == PIX_FMT_YUV422P)
+        c->swScale= uyvyToYuv422Wrapper;
 
-        /* LQ converters if -sws 0 or -sws 4*/
-        if (c->flags&(SWS_FAST_BILINEAR|SWS_POINT)) {
-            /* yv12_to_yuy2 */
-            if (srcFormat == PIX_FMT_YUV420P || srcFormat == PIX_FMT_YUVA420P) {
-                if (dstFormat == PIX_FMT_YUYV422)
-                    c->swScale= PlanarToYuy2Wrapper;
-                else if (dstFormat == PIX_FMT_UYVY422)
-                    c->swScale= PlanarToUyvyWrapper;
-            }
-        }
-        if(srcFormat == PIX_FMT_YUYV422 && (dstFormat == PIX_FMT_YUV420P || dstFormat == PIX_FMT_YUVA420P))
-            c->swScale= YUYV2YUV420Wrapper;
-        if(srcFormat == PIX_FMT_UYVY422 && (dstFormat == PIX_FMT_YUV420P || dstFormat == PIX_FMT_YUVA420P))
-            c->swScale= UYVY2YUV420Wrapper;
-        if(srcFormat == PIX_FMT_YUYV422 && dstFormat == PIX_FMT_YUV422P)
-            c->swScale= YUYV2YUV422Wrapper;
-        if(srcFormat == PIX_FMT_UYVY422 && dstFormat == PIX_FMT_YUV422P)
-            c->swScale= UYVY2YUV422Wrapper;
-
 #ifdef COMPILE_ALTIVEC
-        if ((c->flags & SWS_CPU_CAPS_ALTIVEC) &&
-            !(c->flags & SWS_BITEXACT) &&
-            srcFormat == PIX_FMT_YUV420P) {
-          // unscaled YV12 -> packed YUV, we want speed
-          if (dstFormat == PIX_FMT_YUYV422)
-              c->swScale= yv12toyuy2_unscaled_altivec;
-          else if (dstFormat == PIX_FMT_UYVY422)
-              c->swScale= yv12touyvy_unscaled_altivec;
-        }
-#endif
-
-        /* simple copy */
-        if (  srcFormat == dstFormat
-            || (srcFormat == PIX_FMT_YUVA420P && dstFormat == PIX_FMT_YUV420P)
-            || (srcFormat == PIX_FMT_YUV420P && dstFormat == PIX_FMT_YUVA420P)
-            || (isPlanarYUV(srcFormat) && isGray(dstFormat))
-            || (isPlanarYUV(dstFormat) && isGray(srcFormat))
-            || (isGray(dstFormat) && isGray(srcFormat))
-            || (isPlanarYUV(srcFormat) && isPlanarYUV(dstFormat)
-                && c->chrDstHSubSample == c->chrSrcHSubSample
-                && c->chrDstVSubSample == c->chrSrcVSubSample
-                && dstFormat != PIX_FMT_NV12 && dstFormat != PIX_FMT_NV21
-                && srcFormat != PIX_FMT_NV12 && srcFormat != PIX_FMT_NV21))
-        {
-            if (isPacked(c->srcFormat))
-                c->swScale= packedCopy;
-            else /* Planar YUV or gray */
-                c->swScale= planarCopy;
-        }
-#if ARCH_BFIN
-        if (flags & SWS_CPU_CAPS_BFIN)
-            ff_bfin_get_unscaled_swscale (c);
-#endif
-
-        if (c->swScale) {
-            if (flags&SWS_PRINT_INFO)
-                av_log(c, AV_LOG_INFO, "using unscaled %s -> %s special converter\n",
-                       sws_format_name(srcFormat), sws_format_name(dstFormat));
-            return c;
-        }
+    if ((c->flags & SWS_CPU_CAPS_ALTIVEC) &&
+        !(c->flags & SWS_BITEXACT) &&
+        srcFormat == PIX_FMT_YUV420P) {
+        // unscaled YV12 -> packed YUV, we want speed
+        if (dstFormat == PIX_FMT_YUYV422)
+            c->swScale= yv12toyuy2_unscaled_altivec;
+        else if (dstFormat == PIX_FMT_UYVY422)
+            c->swScale= yv12touyvy_unscaled_altivec;
     }
-
-    if (flags & SWS_CPU_CAPS_MMX2) {
-        c->canMMX2BeUsed= (dstW >=srcW && (dstW&31)==0 && (srcW&15)==0) ? 1 : 0;
-        if (!c->canMMX2BeUsed && dstW >=srcW && (srcW&15)==0 && (flags&SWS_FAST_BILINEAR)) {
-            if (flags&SWS_PRINT_INFO)
-                av_log(c, AV_LOG_INFO, "output width is not a multiple of 32 -> no MMX2 scaler\n");
-        }
-        if (usesHFilter) c->canMMX2BeUsed=0;
-    }
-    else
-        c->canMMX2BeUsed=0;
-
-    c->chrXInc= ((c->chrSrcW<<16) + (c->chrDstW>>1))/c->chrDstW;
-    c->chrYInc= ((c->chrSrcH<<16) + (c->chrDstH>>1))/c->chrDstH;
-
-    // match pixel 0 of the src to pixel 0 of dst and match pixel n-2 of src to pixel n-2 of dst
-    // but only for the FAST_BILINEAR mode otherwise do correct scaling
-    // n-2 is the last chrominance sample available
-    // this is not perfect, but no one should notice the difference, the more correct variant
-    // would be like the vertical one, but that would require some special code for the
-    // first and last pixel
-    if (flags&SWS_FAST_BILINEAR) {
-        if (c->canMMX2BeUsed) {
-            c->lumXInc+= 20;
-            c->chrXInc+= 20;
-        }
-        //we don't use the x86 asm scaler if MMX is available
-        else if (flags & SWS_CPU_CAPS_MMX) {
-            c->lumXInc = ((srcW-2)<<16)/(dstW-2) - 20;
-            c->chrXInc = ((c->chrSrcW-2)<<16)/(c->chrDstW-2) - 20;
-        }
-    }
-
-    /* precalculate horizontal scaler filter coefficients */
-    {
-        const int filterAlign=
-            (flags & SWS_CPU_CAPS_MMX) ? 4 :
-            (flags & SWS_CPU_CAPS_ALTIVEC) ? 8 :
-            1;
-
-        initFilter(&c->hLumFilter, &c->hLumFilterPos, &c->hLumFilterSize, c->lumXInc,
-                   srcW      ,       dstW, filterAlign, 1<<14,
-                   (flags&SWS_BICUBLIN) ? (flags|SWS_BICUBIC)  : flags,
-                   srcFilter->lumH, dstFilter->lumH, c->param);
-        initFilter(&c->hChrFilter, &c->hChrFilterPos, &c->hChrFilterSize, c->chrXInc,
-                   c->chrSrcW, c->chrDstW, filterAlign, 1<<14,
-                   (flags&SWS_BICUBLIN) ? (flags|SWS_BILINEAR) : flags,
-                   srcFilter->chrH, dstFilter->chrH, c->param);
-
-#if defined(COMPILE_MMX2)
-// can't downscale !!!
-        if (c->canMMX2BeUsed && (flags & SWS_FAST_BILINEAR)) {
-            c->lumMmx2FilterCodeSize = initMMX2HScaler(      dstW, c->lumXInc, NULL, NULL, NULL, 8);
-            c->chrMmx2FilterCodeSize = initMMX2HScaler(c->chrDstW, c->chrXInc, NULL, NULL, NULL, 4);
-
-#ifdef MAP_ANONYMOUS
-            c->lumMmx2FilterCode = mmap(NULL, c->lumMmx2FilterCodeSize, PROT_READ | PROT_WRITE, MAP_PRIVATE | MAP_ANONYMOUS, 0, 0);
-            c->chrMmx2FilterCode = mmap(NULL, c->chrMmx2FilterCodeSize, PROT_READ | PROT_WRITE, MAP_PRIVATE | MAP_ANONYMOUS, 0, 0);
-#elif HAVE_VIRTUALALLOC
-            c->lumMmx2FilterCode = VirtualAlloc(NULL, c->lumMmx2FilterCodeSize, MEM_COMMIT, PAGE_EXECUTE_READWRITE);
-            c->chrMmx2FilterCode = VirtualAlloc(NULL, c->chrMmx2FilterCodeSize, MEM_COMMIT, PAGE_EXECUTE_READWRITE);
-#else
-            c->lumMmx2FilterCode = av_malloc(c->lumMmx2FilterCodeSize);
-            c->chrMmx2FilterCode = av_malloc(c->chrMmx2FilterCodeSize);
 #endif
 
-            c->lumMmx2Filter   = av_malloc((dstW        /8+8)*sizeof(int16_t));
-            c->chrMmx2Filter   = av_malloc((c->chrDstW  /4+8)*sizeof(int16_t));
-            c->lumMmx2FilterPos= av_malloc((dstW      /2/8+8)*sizeof(int32_t));
-            c->chrMmx2FilterPos= av_malloc((c->chrDstW/2/4+8)*sizeof(int32_t));
-
-            initMMX2HScaler(      dstW, c->lumXInc, c->lumMmx2FilterCode, c->lumMmx2Filter, c->lumMmx2FilterPos, 8);
-            initMMX2HScaler(c->chrDstW, c->chrXInc, c->chrMmx2FilterCode, c->chrMmx2Filter, c->chrMmx2FilterPos, 4);
-
-#ifdef MAP_ANONYMOUS
-            mprotect(c->lumMmx2FilterCode, c->lumMmx2FilterCodeSize, PROT_EXEC | PROT_READ);
-            mprotect(c->chrMmx2FilterCode, c->chrMmx2FilterCodeSize, PROT_EXEC | PROT_READ);
-#endif
-        }
-#endif /* defined(COMPILE_MMX2) */
-    } // initialize horizontal stuff
-
-
-
-    /* precalculate vertical scaler filter coefficients */
+    /* simple copy */
+    if (  srcFormat == dstFormat
+        || (srcFormat == PIX_FMT_YUVA420P && dstFormat == PIX_FMT_YUV420P)
+        || (srcFormat == PIX_FMT_YUV420P && dstFormat == PIX_FMT_YUVA420P)
+        || (isPlanarYUV(srcFormat) && isGray(dstFormat))
+        || (isPlanarYUV(dstFormat) && isGray(srcFormat))
+        || (isGray(dstFormat) && isGray(srcFormat))
+        || (isPlanarYUV(srcFormat) && isPlanarYUV(dstFormat)
+            && c->chrDstHSubSample == c->chrSrcHSubSample
+            && c->chrDstVSubSample == c->chrSrcVSubSample
+            && dstFormat != PIX_FMT_NV12 && dstFormat != PIX_FMT_NV21
+            && srcFormat != PIX_FMT_NV12 && srcFormat != PIX_FMT_NV21))
     {
-        const int filterAlign=
-            (flags & SWS_CPU_CAPS_MMX) && (flags & SWS_ACCURATE_RND) ? 2 :
-            (flags & SWS_CPU_CAPS_ALTIVEC) ? 8 :
-            1;
-
-        initFilter(&c->vLumFilter, &c->vLumFilterPos, &c->vLumFilterSize, c->lumYInc,
-                   srcH      ,        dstH, filterAlign, (1<<12),
-                   (flags&SWS_BICUBLIN) ? (flags|SWS_BICUBIC)  : flags,
-                   srcFilter->lumV, dstFilter->lumV, c->param);
-        initFilter(&c->vChrFilter, &c->vChrFilterPos, &c->vChrFilterSize, c->chrYInc,
-                   c->chrSrcH, c->chrDstH, filterAlign, (1<<12),
-                   (flags&SWS_BICUBLIN) ? (flags|SWS_BILINEAR) : flags,
-                   srcFilter->chrV, dstFilter->chrV, c->param);
-
-#ifdef COMPILE_ALTIVEC
-        c->vYCoeffsBank = av_malloc(sizeof (vector signed short)*c->vLumFilterSize*c->dstH);
-        c->vCCoeffsBank = av_malloc(sizeof (vector signed short)*c->vChrFilterSize*c->chrDstH);
-
-        for (i=0;i<c->vLumFilterSize*c->dstH;i++) {
-            int j;
-            short *p = (short *)&c->vYCoeffsBank[i];
-            for (j=0;j<8;j++)
-                p[j] = c->vLumFilter[i];
-        }
-
-        for (i=0;i<c->vChrFilterSize*c->chrDstH;i++) {
-            int j;
-            short *p = (short *)&c->vCCoeffsBank[i];
-            for (j=0;j<8;j++)
-                p[j] = c->vChrFilter[i];
-        }
-#endif
+        if (isPacked(c->srcFormat))
+            c->swScale= packedCopyWrapper;
+        else /* Planar YUV or gray */
+            c->swScale= planarCopyWrapper;
     }
-
-    // calculate buffer sizes so that they won't run out while handling these damn slices
-    c->vLumBufSize= c->vLumFilterSize;
-    c->vChrBufSize= c->vChrFilterSize;
-    for (i=0; i<dstH; i++) {
-        int chrI= i*c->chrDstH / dstH;
-        int nextSlice= FFMAX(c->vLumFilterPos[i   ] + c->vLumFilterSize - 1,
-                           ((c->vChrFilterPos[chrI] + c->vChrFilterSize - 1)<<c->chrSrcVSubSample));
-
-        nextSlice>>= c->chrSrcVSubSample;
-        nextSlice<<= c->chrSrcVSubSample;
-        if (c->vLumFilterPos[i   ] + c->vLumBufSize < nextSlice)
-            c->vLumBufSize= nextSlice - c->vLumFilterPos[i];
-        if (c->vChrFilterPos[chrI] + c->vChrBufSize < (nextSlice>>c->chrSrcVSubSample))
-            c->vChrBufSize= (nextSlice>>c->chrSrcVSubSample) - c->vChrFilterPos[chrI];
-    }
-
-    // allocate pixbufs (we use dynamic allocation because otherwise we would need to
-    c->lumPixBuf= av_malloc(c->vLumBufSize*2*sizeof(int16_t*));
-    c->chrPixBuf= av_malloc(c->vChrBufSize*2*sizeof(int16_t*));
-    if (CONFIG_SWSCALE_ALPHA && isALPHA(c->srcFormat) && isALPHA(c->dstFormat))
-        c->alpPixBuf= av_malloc(c->vLumBufSize*2*sizeof(int16_t*));
-    //Note we need at least one pixel more at the end because of the MMX code (just in case someone wanna replace the 4000/8000)
-    /* align at 16 bytes for AltiVec */
-    for (i=0; i<c->vLumBufSize; i++)
-        c->lumPixBuf[i]= c->lumPixBuf[i+c->vLumBufSize]= av_mallocz(VOF+1);
-    for (i=0; i<c->vChrBufSize; i++)
-        c->chrPixBuf[i]= c->chrPixBuf[i+c->vChrBufSize]= av_malloc((VOF+1)*2);
-    if (CONFIG_SWSCALE_ALPHA && c->alpPixBuf)
-        for (i=0; i<c->vLumBufSize; i++)
-            c->alpPixBuf[i]= c->alpPixBuf[i+c->vLumBufSize]= av_mallocz(VOF+1);
-
-    //try to avoid drawing green stuff between the right end and the stride end
-    for (i=0; i<c->vChrBufSize; i++) memset(c->chrPixBuf[i], 64, (VOF+1)*2);
-
-    assert(2*VOFW == VOF);
-
-    assert(c->chrDstH <= dstH);
-
-    if (flags&SWS_PRINT_INFO) {
-#ifdef DITHER1XBPP
-        const char *dither= " dithered";
-#else
-        const char *dither= "";
+#if ARCH_BFIN
+    if (flags & SWS_CPU_CAPS_BFIN)
+        ff_bfin_get_unscaled_swscale (c);
 #endif
-        if (flags&SWS_FAST_BILINEAR)
-            av_log(c, AV_LOG_INFO, "FAST_BILINEAR scaler, ");
-        else if (flags&SWS_BILINEAR)
-            av_log(c, AV_LOG_INFO, "BILINEAR scaler, ");
-        else if (flags&SWS_BICUBIC)
-            av_log(c, AV_LOG_INFO, "BICUBIC scaler, ");
-        else if (flags&SWS_X)
-            av_log(c, AV_LOG_INFO, "Experimental scaler, ");
-        else if (flags&SWS_POINT)
-            av_log(c, AV_LOG_INFO, "Nearest Neighbor / POINT scaler, ");
-        else if (flags&SWS_AREA)
-            av_log(c, AV_LOG_INFO, "Area Averageing scaler, ");
-        else if (flags&SWS_BICUBLIN)
-            av_log(c, AV_LOG_INFO, "luma BICUBIC / chroma BILINEAR scaler, ");
-        else if (flags&SWS_GAUSS)
-            av_log(c, AV_LOG_INFO, "Gaussian scaler, ");
-        else if (flags&SWS_SINC)
-            av_log(c, AV_LOG_INFO, "Sinc scaler, ");
-        else if (flags&SWS_LANCZOS)
-            av_log(c, AV_LOG_INFO, "Lanczos scaler, ");
-        else if (flags&SWS_SPLINE)
-            av_log(c, AV_LOG_INFO, "Bicubic spline scaler, ");
-        else
-            av_log(c, AV_LOG_INFO, "ehh flags invalid?! ");
-
-        if (dstFormat==PIX_FMT_BGR555 || dstFormat==PIX_FMT_BGR565)
-            av_log(c, AV_LOG_INFO, "from %s to%s %s ",
-                   sws_format_name(srcFormat), dither, sws_format_name(dstFormat));
-        else
-            av_log(c, AV_LOG_INFO, "from %s to %s ",
-                   sws_format_name(srcFormat), sws_format_name(dstFormat));
-
-        if (flags & SWS_CPU_CAPS_MMX2)
-            av_log(c, AV_LOG_INFO, "using MMX2\n");
-        else if (flags & SWS_CPU_CAPS_3DNOW)
-            av_log(c, AV_LOG_INFO, "using 3DNOW\n");
-        else if (flags & SWS_CPU_CAPS_MMX)
-            av_log(c, AV_LOG_INFO, "using MMX\n");
-        else if (flags & SWS_CPU_CAPS_ALTIVEC)
-            av_log(c, AV_LOG_INFO, "using AltiVec\n");
-        else
-            av_log(c, AV_LOG_INFO, "using C\n");
-    }
-
-    if (flags & SWS_PRINT_INFO) {
-        if (flags & SWS_CPU_CAPS_MMX) {
-            if (c->canMMX2BeUsed && (flags&SWS_FAST_BILINEAR))
-                av_log(c, AV_LOG_VERBOSE, "using FAST_BILINEAR MMX2 scaler for horizontal scaling\n");
-            else {
-                if (c->hLumFilterSize==4)
-                    av_log(c, AV_LOG_VERBOSE, "using 4-tap MMX scaler for horizontal luminance scaling\n");
-                else if (c->hLumFilterSize==8)
-                    av_log(c, AV_LOG_VERBOSE, "using 8-tap MMX scaler for horizontal luminance scaling\n");
-                else
-                    av_log(c, AV_LOG_VERBOSE, "using n-tap MMX scaler for horizontal luminance scaling\n");
-
-                if (c->hChrFilterSize==4)
-                    av_log(c, AV_LOG_VERBOSE, "using 4-tap MMX scaler for horizontal chrominance scaling\n");
-                else if (c->hChrFilterSize==8)
-                    av_log(c, AV_LOG_VERBOSE, "using 8-tap MMX scaler for horizontal chrominance scaling\n");
-                else
-                    av_log(c, AV_LOG_VERBOSE, "using n-tap MMX scaler for horizontal chrominance scaling\n");
-            }
-        } else {
-#if ARCH_X86
-            av_log(c, AV_LOG_VERBOSE, "using x86 asm scaler for horizontal scaling\n");
-#else
-            if (flags & SWS_FAST_BILINEAR)
-                av_log(c, AV_LOG_VERBOSE, "using FAST_BILINEAR C scaler for horizontal scaling\n");
-            else
-                av_log(c, AV_LOG_VERBOSE, "using C scaler for horizontal scaling\n");
-#endif
-        }
-        if (isPlanarYUV(dstFormat)) {
-            if (c->vLumFilterSize==1)
-                av_log(c, AV_LOG_VERBOSE, "using 1-tap %s \"scaler\" for vertical scaling (YV12 like)\n", (flags & SWS_CPU_CAPS_MMX) ? "MMX" : "C");
-            else
-                av_log(c, AV_LOG_VERBOSE, "using n-tap %s scaler for vertical scaling (YV12 like)\n", (flags & SWS_CPU_CAPS_MMX) ? "MMX" : "C");
-        } else {
-            if (c->vLumFilterSize==1 && c->vChrFilterSize==2)
-                av_log(c, AV_LOG_VERBOSE, "using 1-tap %s \"scaler\" for vertical luminance scaling (BGR)\n"
-                       "      2-tap scaler for vertical chrominance scaling (BGR)\n", (flags & SWS_CPU_CAPS_MMX) ? "MMX" : "C");
-            else if (c->vLumFilterSize==2 && c->vChrFilterSize==2)
-                av_log(c, AV_LOG_VERBOSE, "using 2-tap linear %s scaler for vertical scaling (BGR)\n", (flags & SWS_CPU_CAPS_MMX) ? "MMX" : "C");
-            else
-                av_log(c, AV_LOG_VERBOSE, "using n-tap %s scaler for vertical scaling (BGR)\n", (flags & SWS_CPU_CAPS_MMX) ? "MMX" : "C");
-        }
-
-        if (dstFormat==PIX_FMT_BGR24)
-            av_log(c, AV_LOG_VERBOSE, "using %s YV12->BGR24 converter\n",
-                   (flags & SWS_CPU_CAPS_MMX2) ? "MMX2" : ((flags & SWS_CPU_CAPS_MMX) ? "MMX" : "C"));
-        else if (dstFormat==PIX_FMT_RGB32)
-            av_log(c, AV_LOG_VERBOSE, "using %s YV12->BGR32 converter\n", (flags & SWS_CPU_CAPS_MMX) ? "MMX" : "C");
-        else if (dstFormat==PIX_FMT_BGR565)
-            av_log(c, AV_LOG_VERBOSE, "using %s YV12->BGR16 converter\n", (flags & SWS_CPU_CAPS_MMX) ? "MMX" : "C");
-        else if (dstFormat==PIX_FMT_BGR555)
-            av_log(c, AV_LOG_VERBOSE, "using %s YV12->BGR15 converter\n", (flags & SWS_CPU_CAPS_MMX) ? "MMX" : "C");
-
-        av_log(c, AV_LOG_VERBOSE, "%dx%d -> %dx%d\n", srcW, srcH, dstW, dstH);
-    }
-    if (flags & SWS_PRINT_INFO) {
-        av_log(c, AV_LOG_DEBUG, "lum srcW=%d srcH=%d dstW=%d dstH=%d xInc=%d yInc=%d\n",
-               c->srcW, c->srcH, c->dstW, c->dstH, c->lumXInc, c->lumYInc);
-        av_log(c, AV_LOG_DEBUG, "chr srcW=%d srcH=%d dstW=%d dstH=%d xInc=%d yInc=%d\n",
-               c->chrSrcW, c->chrSrcH, c->chrDstW, c->chrDstH, c->chrXInc, c->chrYInc);
-    }
-
-    c->swScale= getSwsFunc(c);
-    return c;
 }
 
-static void reset_ptr(uint8_t* src[], int format)
+static void reset_ptr(const uint8_t* src[], int format)
 {
     if(!isALPHA(format))
         src[3]=NULL;
     if(!isPlanarYUV(format)) {
         src[3]=src[2]=NULL;
-        if(   format != PIX_FMT_PAL8
-           && format != PIX_FMT_RGB8
-           && format != PIX_FMT_BGR8
-           && format != PIX_FMT_RGB4_BYTE
-           && format != PIX_FMT_BGR4_BYTE
-          )
+
+        if (!usePal(format))
             src[1]= NULL;
     }
 }
@@ -3066,13 +1810,17 @@
  * swscale wrapper, so we don't need to export the SwsContext.
  * Assumes planar YUV to be in YUV order instead of YVU.
  */
-int sws_scale(SwsContext *c, uint8_t* src[], int srcStride[], int srcSliceY,
-              int srcSliceH, uint8_t* dst[], int dstStride[])
+int sws_scale(SwsContext *c, const uint8_t* const src[], const int srcStride[], int srcSliceY,
+              int srcSliceH, uint8_t* const dst[], const int dstStride[])
 {
     int i;
-    uint8_t* src2[4]= {src[0], src[1], src[2], src[3]};
+    const uint8_t* src2[4]= {src[0], src[1], src[2], src[3]};
     uint8_t* dst2[4]= {dst[0], dst[1], dst[2], dst[3]};
 
+    // do not mess up sliceDir if we have a "trailing" 0-size slice
+    if (srcSliceH == 0)
+        return 0;
+
     if (c->sliceDir == 0 && srcSliceY != 0 && srcSliceY + srcSliceH != c->srcH) {
         av_log(c, AV_LOG_ERROR, "Slices start in the middle!\n");
         return 0;
@@ -3085,7 +1833,7 @@
         for (i=0; i<256; i++) {
             int p, r, g, b,y,u,v;
             if(c->srcFormat == PIX_FMT_PAL8) {
-                p=((uint32_t*)(src[1]))[i];
+                p=((const uint32_t*)(src[1]))[i];
                 r= (p>>16)&0xFF;
                 g= (p>> 8)&0xFF;
                 b=  p     &0xFF;
@@ -3112,7 +1860,6 @@
             v= av_clip_uint8((RV*r + GV*g + BV*b + (257<<(RGB2YUV_SHIFT-1)))>>RGB2YUV_SHIFT);
             c->pal_yuv[i]= y + (u<<8) + (v<<16);
 
-
             switch(c->dstFormat) {
             case PIX_FMT_BGR32:
 #if !HAVE_BIGENDIAN
@@ -3149,8 +1896,12 @@
         int dstStride2[4]= {dstStride[0], dstStride[1], dstStride[2], dstStride[3]};
 
         reset_ptr(src2, c->srcFormat);
-        reset_ptr(dst2, c->dstFormat);
+        reset_ptr((const uint8_t**)dst2, c->dstFormat);
 
+        /* reset slice direction at end of frame */
+        if (srcSliceY + srcSliceH == c->srcH)
+            c->sliceDir = 0;
+
         return c->swScale(c, src2, srcStride2, srcSliceY, srcSliceH, dst2, dstStride2);
     } else {
         // slices go from bottom to top => we flip the image internally
@@ -3168,405 +1919,20 @@
         dst2[3] += ( c->dstH                      -1)*dstStride[3];
 
         reset_ptr(src2, c->srcFormat);
-        reset_ptr(dst2, c->dstFormat);
+        reset_ptr((const uint8_t**)dst2, c->dstFormat);
 
+        /* reset slice direction at end of frame */
+        if (!srcSliceY)
+            c->sliceDir = 0;
+
         return c->swScale(c, src2, srcStride2, c->srcH-srcSliceY-srcSliceH, srcSliceH, dst2, dstStride2);
     }
 }
 
 #if LIBSWSCALE_VERSION_MAJOR < 1
-int sws_scale_ordered(SwsContext *c, uint8_t* src[], int srcStride[], int srcSliceY,
+int sws_scale_ordered(SwsContext *c, const uint8_t* const src[], int srcStride[], int srcSliceY,
                       int srcSliceH, uint8_t* dst[], int dstStride[])
 {
     return sws_scale(c, src, srcStride, srcSliceY, srcSliceH, dst, dstStride);
 }
 #endif
-
-SwsFilter *sws_getDefaultFilter(float lumaGBlur, float chromaGBlur,
-                                float lumaSharpen, float chromaSharpen,
-                                float chromaHShift, float chromaVShift,
-                                int verbose)
-{
-    SwsFilter *filter= av_malloc(sizeof(SwsFilter));
-
-    if (lumaGBlur!=0.0) {
-        filter->lumH= sws_getGaussianVec(lumaGBlur, 3.0);
-        filter->lumV= sws_getGaussianVec(lumaGBlur, 3.0);
-    } else {
-        filter->lumH= sws_getIdentityVec();
-        filter->lumV= sws_getIdentityVec();
-    }
-
-    if (chromaGBlur!=0.0) {
-        filter->chrH= sws_getGaussianVec(chromaGBlur, 3.0);
-        filter->chrV= sws_getGaussianVec(chromaGBlur, 3.0);
-    } else {
-        filter->chrH= sws_getIdentityVec();
-        filter->chrV= sws_getIdentityVec();
-    }
-
-    if (chromaSharpen!=0.0) {
-        SwsVector *id= sws_getIdentityVec();
-        sws_scaleVec(filter->chrH, -chromaSharpen);
-        sws_scaleVec(filter->chrV, -chromaSharpen);
-        sws_addVec(filter->chrH, id);
-        sws_addVec(filter->chrV, id);
-        sws_freeVec(id);
-    }
-
-    if (lumaSharpen!=0.0) {
-        SwsVector *id= sws_getIdentityVec();
-        sws_scaleVec(filter->lumH, -lumaSharpen);
-        sws_scaleVec(filter->lumV, -lumaSharpen);
-        sws_addVec(filter->lumH, id);
-        sws_addVec(filter->lumV, id);
-        sws_freeVec(id);
-    }
-
-    if (chromaHShift != 0.0)
-        sws_shiftVec(filter->chrH, (int)(chromaHShift+0.5));
-
-    if (chromaVShift != 0.0)
-        sws_shiftVec(filter->chrV, (int)(chromaVShift+0.5));
-
-    sws_normalizeVec(filter->chrH, 1.0);
-    sws_normalizeVec(filter->chrV, 1.0);
-    sws_normalizeVec(filter->lumH, 1.0);
-    sws_normalizeVec(filter->lumV, 1.0);
-
-    if (verbose) sws_printVec2(filter->chrH, NULL, AV_LOG_DEBUG);
-    if (verbose) sws_printVec2(filter->lumH, NULL, AV_LOG_DEBUG);
-
-    return filter;
-}
-
-SwsVector *sws_allocVec(int length)
-{
-    SwsVector *vec = av_malloc(sizeof(SwsVector));
-    if (!vec)
-        return NULL;
-    vec->length = length;
-    vec->coeff  = av_malloc(sizeof(double) * length);
-    if (!vec->coeff)
-        av_freep(&vec);
-    return vec;
-}
-
-SwsVector *sws_getGaussianVec(double variance, double quality)
-{
-    const int length= (int)(variance*quality + 0.5) | 1;
-    int i;
-    double middle= (length-1)*0.5;
-    SwsVector *vec= sws_allocVec(length);
-
-    if (!vec)
-        return NULL;
-
-    for (i=0; i<length; i++) {
-        double dist= i-middle;
-        vec->coeff[i]= exp(-dist*dist/(2*variance*variance)) / sqrt(2*variance*PI);
-    }
-
-    sws_normalizeVec(vec, 1.0);
-
-    return vec;
-}
-
-SwsVector *sws_getConstVec(double c, int length)
-{
-    int i;
-    SwsVector *vec= sws_allocVec(length);
-
-    if (!vec)
-        return NULL;
-
-    for (i=0; i<length; i++)
-        vec->coeff[i]= c;
-
-    return vec;
-}
-
-
-SwsVector *sws_getIdentityVec(void)
-{
-    return sws_getConstVec(1.0, 1);
-}
-
-double sws_dcVec(SwsVector *a)
-{
-    int i;
-    double sum=0;
-
-    for (i=0; i<a->length; i++)
-        sum+= a->coeff[i];
-
-    return sum;
-}
-
-void sws_scaleVec(SwsVector *a, double scalar)
-{
-    int i;
-
-    for (i=0; i<a->length; i++)
-        a->coeff[i]*= scalar;
-}
-
-void sws_normalizeVec(SwsVector *a, double height)
-{
-    sws_scaleVec(a, height/sws_dcVec(a));
-}
-
-static SwsVector *sws_getConvVec(SwsVector *a, SwsVector *b)
-{
-    int length= a->length + b->length - 1;
-    int i, j;
-    SwsVector *vec= sws_getConstVec(0.0, length);
-
-    if (!vec)
-        return NULL;
-
-    for (i=0; i<a->length; i++) {
-        for (j=0; j<b->length; j++) {
-            vec->coeff[i+j]+= a->coeff[i]*b->coeff[j];
-        }
-    }
-
-    return vec;
-}
-
-static SwsVector *sws_sumVec(SwsVector *a, SwsVector *b)
-{
-    int length= FFMAX(a->length, b->length);
-    int i;
-    SwsVector *vec= sws_getConstVec(0.0, length);
-
-    if (!vec)
-        return NULL;
-
-    for (i=0; i<a->length; i++) vec->coeff[i + (length-1)/2 - (a->length-1)/2]+= a->coeff[i];
-    for (i=0; i<b->length; i++) vec->coeff[i + (length-1)/2 - (b->length-1)/2]+= b->coeff[i];
-
-    return vec;
-}
-
-static SwsVector *sws_diffVec(SwsVector *a, SwsVector *b)
-{
-    int length= FFMAX(a->length, b->length);
-    int i;
-    SwsVector *vec= sws_getConstVec(0.0, length);
-
-    if (!vec)
-        return NULL;
-
-    for (i=0; i<a->length; i++) vec->coeff[i + (length-1)/2 - (a->length-1)/2]+= a->coeff[i];
-    for (i=0; i<b->length; i++) vec->coeff[i + (length-1)/2 - (b->length-1)/2]-= b->coeff[i];
-
-    return vec;
-}
-
-/* shift left / or right if "shift" is negative */
-static SwsVector *sws_getShiftedVec(SwsVector *a, int shift)
-{
-    int length= a->length + FFABS(shift)*2;
-    int i;
-    SwsVector *vec= sws_getConstVec(0.0, length);
-
-    if (!vec)
-        return NULL;
-
-    for (i=0; i<a->length; i++) {
-        vec->coeff[i + (length-1)/2 - (a->length-1)/2 - shift]= a->coeff[i];
-    }
-
-    return vec;
-}
-
-void sws_shiftVec(SwsVector *a, int shift)
-{
-    SwsVector *shifted= sws_getShiftedVec(a, shift);
-    av_free(a->coeff);
-    a->coeff= shifted->coeff;
-    a->length= shifted->length;
-    av_free(shifted);
-}
-
-void sws_addVec(SwsVector *a, SwsVector *b)
-{
-    SwsVector *sum= sws_sumVec(a, b);
-    av_free(a->coeff);
-    a->coeff= sum->coeff;
-    a->length= sum->length;
-    av_free(sum);
-}
-
-void sws_subVec(SwsVector *a, SwsVector *b)
-{
-    SwsVector *diff= sws_diffVec(a, b);
-    av_free(a->coeff);
-    a->coeff= diff->coeff;
-    a->length= diff->length;
-    av_free(diff);
-}
-
-void sws_convVec(SwsVector *a, SwsVector *b)
-{
-    SwsVector *conv= sws_getConvVec(a, b);
-    av_free(a->coeff);
-    a->coeff= conv->coeff;
-    a->length= conv->length;
-    av_free(conv);
-}
-
-SwsVector *sws_cloneVec(SwsVector *a)
-{
-    int i;
-    SwsVector *vec= sws_allocVec(a->length);
-
-    if (!vec)
-        return NULL;
-
-    for (i=0; i<a->length; i++) vec->coeff[i]= a->coeff[i];
-
-    return vec;
-}
-
-void sws_printVec2(SwsVector *a, AVClass *log_ctx, int log_level)
-{
-    int i;
-    double max=0;
-    double min=0;
-    double range;
-
-    for (i=0; i<a->length; i++)
-        if (a->coeff[i]>max) max= a->coeff[i];
-
-    for (i=0; i<a->length; i++)
-        if (a->coeff[i]<min) min= a->coeff[i];
-
-    range= max - min;
-
-    for (i=0; i<a->length; i++) {
-        int x= (int)((a->coeff[i]-min)*60.0/range +0.5);
-        av_log(log_ctx, log_level, "%1.3f ", a->coeff[i]);
-        for (;x>0; x--) av_log(log_ctx, log_level, " ");
-        av_log(log_ctx, log_level, "|\n");
-    }
-}
-
-#if LIBSWSCALE_VERSION_MAJOR < 1
-void sws_printVec(SwsVector *a)
-{
-    sws_printVec2(a, NULL, AV_LOG_DEBUG);
-}
-#endif
-
-void sws_freeVec(SwsVector *a)
-{
-    if (!a) return;
-    av_freep(&a->coeff);
-    a->length=0;
-    av_free(a);
-}
-
-void sws_freeFilter(SwsFilter *filter)
-{
-    if (!filter) return;
-
-    if (filter->lumH) sws_freeVec(filter->lumH);
-    if (filter->lumV) sws_freeVec(filter->lumV);
-    if (filter->chrH) sws_freeVec(filter->chrH);
-    if (filter->chrV) sws_freeVec(filter->chrV);
-    av_free(filter);
-}
-
-
-void sws_freeContext(SwsContext *c)
-{
-    int i;
-    if (!c) return;
-
-    if (c->lumPixBuf) {
-        for (i=0; i<c->vLumBufSize; i++)
-            av_freep(&c->lumPixBuf[i]);
-        av_freep(&c->lumPixBuf);
-    }
-
-    if (c->chrPixBuf) {
-        for (i=0; i<c->vChrBufSize; i++)
-            av_freep(&c->chrPixBuf[i]);
-        av_freep(&c->chrPixBuf);
-    }
-
-    if (CONFIG_SWSCALE_ALPHA && c->alpPixBuf) {
-        for (i=0; i<c->vLumBufSize; i++)
-            av_freep(&c->alpPixBuf[i]);
-        av_freep(&c->alpPixBuf);
-    }
-
-    av_freep(&c->vLumFilter);
-    av_freep(&c->vChrFilter);
-    av_freep(&c->hLumFilter);
-    av_freep(&c->hChrFilter);
-#ifdef COMPILE_ALTIVEC
-    av_freep(&c->vYCoeffsBank);
-    av_freep(&c->vCCoeffsBank);
-#endif
-
-    av_freep(&c->vLumFilterPos);
-    av_freep(&c->vChrFilterPos);
-    av_freep(&c->hLumFilterPos);
-    av_freep(&c->hChrFilterPos);
-
-#if ARCH_X86 && CONFIG_GPL
-#ifdef MAP_ANONYMOUS
-    if (c->lumMmx2FilterCode) munmap(c->lumMmx2FilterCode, c->lumMmx2FilterCodeSize);
-    if (c->chrMmx2FilterCode) munmap(c->chrMmx2FilterCode, c->chrMmx2FilterCodeSize);
-#elif HAVE_VIRTUALALLOC
-    if (c->lumMmx2FilterCode) VirtualFree(c->lumMmx2FilterCode, c->lumMmx2FilterCodeSize, MEM_RELEASE);
-    if (c->chrMmx2FilterCode) VirtualFree(c->chrMmx2FilterCode, c->chrMmx2FilterCodeSize, MEM_RELEASE);
-#else
-    av_free(c->lumMmx2FilterCode);
-    av_free(c->chrMmx2FilterCode);
-#endif
-    c->lumMmx2FilterCode=NULL;
-    c->chrMmx2FilterCode=NULL;
-#endif /* ARCH_X86 && CONFIG_GPL */
-
-    av_freep(&c->lumMmx2Filter);
-    av_freep(&c->chrMmx2Filter);
-    av_freep(&c->lumMmx2FilterPos);
-    av_freep(&c->chrMmx2FilterPos);
-    av_freep(&c->yuvTable);
-
-    av_free(c);
-}
-
-struct SwsContext *sws_getCachedContext(struct SwsContext *context,
-                                        int srcW, int srcH, enum PixelFormat srcFormat,
-                                        int dstW, int dstH, enum PixelFormat dstFormat, int flags,
-                                        SwsFilter *srcFilter, SwsFilter *dstFilter, const double *param)
-{
-    static const double default_param[2] = {SWS_PARAM_DEFAULT, SWS_PARAM_DEFAULT};
-
-    if (!param)
-        param = default_param;
-
-    if (context) {
-        if (context->srcW != srcW || context->srcH != srcH ||
-            context->srcFormat != srcFormat ||
-            context->dstW != dstW || context->dstH != dstH ||
-            context->dstFormat != dstFormat || context->flags != flags ||
-            context->param[0] != param[0] || context->param[1] != param[1])
-        {
-            sws_freeContext(context);
-            context = NULL;
-        }
-    }
-    if (!context) {
-        return sws_getContext(srcW, srcH, srcFormat,
-                              dstW, dstH, dstFormat, flags,
-                              srcFilter, dstFilter, param);
-    }
-    return context;
-}
-

Modified: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libswscale/swscale.h
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libswscale/swscale.h	2010-05-26 05:26:42 UTC (rev 6237)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libswscale/swscale.h	2010-05-26 05:26:46 UTC (rev 6238)
@@ -30,8 +30,8 @@
 #include "libavutil/avutil.h"
 
 #define LIBSWSCALE_VERSION_MAJOR 0
-#define LIBSWSCALE_VERSION_MINOR 7
-#define LIBSWSCALE_VERSION_MICRO 1
+#define LIBSWSCALE_VERSION_MINOR 10
+#define LIBSWSCALE_VERSION_MICRO 0
 
 #define LIBSWSCALE_VERSION_INT  AV_VERSION_INT(LIBSWSCALE_VERSION_MAJOR, \
                                                LIBSWSCALE_VERSION_MINOR, \
@@ -48,6 +48,16 @@
  */
 unsigned swscale_version(void);
 
+/**
+ * Returns the libswscale build-time configuration.
+ */
+const char *swscale_configuration(void);
+
+/**
+ * Returns the libswscale license.
+ */
+const char *swscale_license(void);
+
 /* values for the flags, the stuff on the command line is different */
 #define SWS_FAST_BILINEAR     1
 #define SWS_BILINEAR          2
@@ -93,6 +103,14 @@
 #define SWS_CS_SMPTE240M      7
 #define SWS_CS_DEFAULT        5
 
+/**
+ * Returns a pointer to yuv<->rgb coefficients for the given colorspace
+ * suitable for sws_setColorspaceDetails().
+ *
+ * @param colorspace One of the SWS_CS_* macros. If invalid,
+ * SWS_CS_DEFAULT is used.
+ */
+const int *sws_getCoefficients(int colorspace);
 
 
 // when used for filters they must have an odd number of elements
@@ -112,6 +130,22 @@
 
 struct SwsContext;
 
+/**
+ * Returns a positive value if pix_fmt is a supported input format, 0
+ * otherwise.
+ */
+int sws_isSupportedInput(enum PixelFormat pix_fmt);
+
+/**
+ * Returns a positive value if pix_fmt is a supported output format, 0
+ * otherwise.
+ */
+int sws_isSupportedOutput(enum PixelFormat pix_fmt);
+
+/**
+ * Frees the swscaler context swsContext.
+ * If swsContext is NULL, then does nothing.
+ */
 void sws_freeContext(struct SwsContext *swsContext);
 
 /**
@@ -137,6 +171,10 @@
  * slice in the image in dst. A slice is a sequence of consecutive
  * rows in an image.
  *
+ * Slices have to be provided in sequential order, either in
+ * top-bottom or bottom-top order. If slices are provided in
+ * non-sequential order the behavior of the function is undefined.
+ *
  * @param context   the scaling context previously created with
  *                  sws_getContext()
  * @param srcSlice  the array containing the pointers to the planes of
@@ -154,13 +192,13 @@
  *                  the destination image
  * @return          the height of the output slice
  */
-int sws_scale(struct SwsContext *context, uint8_t* srcSlice[], int srcStride[],
-              int srcSliceY, int srcSliceH, uint8_t* dst[], int dstStride[]);
+int sws_scale(struct SwsContext *context, const uint8_t* const srcSlice[], const int srcStride[],
+              int srcSliceY, int srcSliceH, uint8_t* const dst[], const int dstStride[]);
 #if LIBSWSCALE_VERSION_MAJOR < 1
 /**
  * @deprecated Use sws_scale() instead.
  */
-int sws_scale_ordered(struct SwsContext *context, uint8_t* src[],
+int sws_scale_ordered(struct SwsContext *context, const uint8_t* const src[],
                       int srcStride[], int srcSliceY, int srcSliceH,
                       uint8_t* dst[], int dstStride[]) attribute_deprecated;
 #endif

Modified: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libswscale/swscale_internal.h
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libswscale/swscale_internal.h	2010-05-26 05:26:42 UTC (rev 6237)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libswscale/swscale_internal.h	2010-05-26 05:26:46 UTC (rev 6238)
@@ -59,7 +59,7 @@
 
 struct SwsContext;
 
-typedef int (*SwsFunc)(struct SwsContext *context, uint8_t* src[],
+typedef int (*SwsFunc)(struct SwsContext *context, const uint8_t* src[],
                        int srcStride[], int srcSliceY, int srcSliceH,
                        uint8_t* dst[], int dstStride[]);
 
@@ -75,59 +75,90 @@
      * sws_scale() wrapper so they can be freely modified here.
      */
     SwsFunc swScale;
-    int srcW, srcH, dstH;
-    int chrSrcW, chrSrcH, chrDstW, chrDstH;
+    int srcW;                     ///< Width  of source      luma/alpha planes.
+    int srcH;                     ///< Height of source      luma/alpha planes.
+    int dstH;                     ///< Height of destination luma/alpha planes.
+    int chrSrcW;                  ///< Width  of source      chroma     planes.
+    int chrSrcH;                  ///< Height of source      chroma     planes.
+    int chrDstW;                  ///< Width  of destination chroma     planes.
+    int chrDstH;                  ///< Height of destination chroma     planes.
     int lumXInc, chrXInc;
     int lumYInc, chrYInc;
-    enum PixelFormat dstFormat, srcFormat;  ///< format 4:2:0 type is always YV12
-    int origDstFormat, origSrcFormat;       ///< format
-    int chrSrcHSubSample, chrSrcVSubSample;
-    int chrDstHSubSample, chrDstVSubSample;
-    int vChrDrop;
-    int sliceDir;
-    double param[2];
+    enum PixelFormat dstFormat;   ///< Destination pixel format.
+    enum PixelFormat srcFormat;   ///< Source      pixel format.
+    int dstFormatBpp;             ///< Number of bits per pixel of the destination pixel format.
+    int srcFormatBpp;             ///< Number of bits per pixel of the source      pixel format.
+    int chrSrcHSubSample;         ///< Binary logarithm of horizontal subsampling factor between luma/alpha and chroma planes in source      image.
+    int chrSrcVSubSample;         ///< Binary logarithm of vertical   subsampling factor between luma/alpha and chroma planes in source      image.
+    int chrDstHSubSample;         ///< Binary logarithm of horizontal subsampling factor between luma/alpha and chroma planes in destination image.
+    int chrDstVSubSample;         ///< Binary logarithm of vertical   subsampling factor between luma/alpha and chroma planes in destination image.
+    int vChrDrop;                 ///< Binary logarithm of extra vertical subsampling factor in source image chroma planes specified by user.
+    int sliceDir;                 ///< Direction that slices are fed to the scaler (1 = top-to-bottom, -1 = bottom-to-top).
+    double param[2];              ///< Input parameters for scaling algorithms that need them.
 
     uint32_t pal_yuv[256];
     uint32_t pal_rgb[256];
 
-    int16_t **lumPixBuf;
-    int16_t **chrPixBuf;
-    int16_t **alpPixBuf;
-    int16_t *hLumFilter;
-    int16_t *hLumFilterPos;
-    int16_t *hChrFilter;
-    int16_t *hChrFilterPos;
-    int16_t *vLumFilter;
-    int16_t *vLumFilterPos;
-    int16_t *vChrFilter;
-    int16_t *vChrFilterPos;
+    /**
+     * @name Scaled horizontal lines ring buffer.
+     * The horizontal scaler keeps just enough scaled lines in a ring buffer
+     * so they may be passed to the vertical scaler. The pointers to the
+     * allocated buffers for each line are duplicated in sequence in the ring
+     * buffer to simplify indexing and avoid wrapping around between lines
+     * inside the vertical scaler code. The wrapping is done before the
+     * vertical scaler is called.
+     */
+    //@{
+    int16_t **lumPixBuf;          ///< Ring buffer for scaled horizontal luma   plane lines to be fed to the vertical scaler.
+    int16_t **chrPixBuf;          ///< Ring buffer for scaled horizontal chroma plane lines to be fed to the vertical scaler.
+    int16_t **alpPixBuf;          ///< Ring buffer for scaled horizontal alpha  plane lines to be fed to the vertical scaler.
+    int       vLumBufSize;        ///< Number of vertical luma/alpha lines allocated in the ring buffer.
+    int       vChrBufSize;        ///< Number of vertical chroma     lines allocated in the ring buffer.
+    int       lastInLumBuf;       ///< Last scaled horizontal luma/alpha line from source in the ring buffer.
+    int       lastInChrBuf;       ///< Last scaled horizontal chroma     line from source in the ring buffer.
+    int       lumBufIndex;        ///< Index in ring buffer of the last scaled horizontal luma/alpha line from source.
+    int       chrBufIndex;        ///< Index in ring buffer of the last scaled horizontal chroma     line from source.
+    //@}
 
     uint8_t formatConvBuffer[VOF]; //FIXME dynamic allocation, but we have to change a lot of code for this to be useful
 
-    int hLumFilterSize;
-    int hChrFilterSize;
-    int vLumFilterSize;
-    int vChrFilterSize;
-    int vLumBufSize;
-    int vChrBufSize;
+    /**
+     * @name Horizontal and vertical filters.
+     * To better understand the following fields, here is a pseudo-code of
+     * their usage in filtering a horizontal line:
+     * @code
+     * for (i = 0; i < width; i++) {
+     *     dst[i] = 0;
+     *     for (j = 0; j < filterSize; j++)
+     *         dst[i] += src[ filterPos[i] + j ] * filter[ filterSize * i + j ];
+     *     dst[i] >>= FRAC_BITS; // The actual implementation is fixed-point.
+     * }
+     * @endcode
+     */
+    //@{
+    int16_t *hLumFilter;          ///< Array of horizontal filter coefficients for luma/alpha planes.
+    int16_t *hChrFilter;          ///< Array of horizontal filter coefficients for chroma     planes.
+    int16_t *vLumFilter;          ///< Array of vertical   filter coefficients for luma/alpha planes.
+    int16_t *vChrFilter;          ///< Array of vertical   filter coefficients for chroma     planes.
+    int16_t *hLumFilterPos;       ///< Array of horizontal filter starting positions for each dst[i] for luma/alpha planes.
+    int16_t *hChrFilterPos;       ///< Array of horizontal filter starting positions for each dst[i] for chroma     planes.
+    int16_t *vLumFilterPos;       ///< Array of vertical   filter starting positions for each dst[i] for luma/alpha planes.
+    int16_t *vChrFilterPos;       ///< Array of vertical   filter starting positions for each dst[i] for chroma     planes.
+    int      hLumFilterSize;      ///< Horizontal filter size for luma/alpha pixels.
+    int      hChrFilterSize;      ///< Horizontal filter size for chroma     pixels.
+    int      vLumFilterSize;      ///< Vertical   filter size for luma/alpha pixels.
+    int      vChrFilterSize;      ///< Vertical   filter size for chroma     pixels.
+    //@}
 
-    int lumMmx2FilterCodeSize;
-    int chrMmx2FilterCodeSize;
-    uint8_t *lumMmx2FilterCode;
-    uint8_t *chrMmx2FilterCode;
-    int32_t *lumMmx2FilterPos;
-    int32_t *chrMmx2FilterPos;
-    int16_t *lumMmx2Filter;
-    int16_t *chrMmx2Filter;
+    int lumMmx2FilterCodeSize;    ///< Runtime-generated MMX2 horizontal fast bilinear scaler code size for luma/alpha planes.
+    int chrMmx2FilterCodeSize;    ///< Runtime-generated MMX2 horizontal fast bilinear scaler code size for chroma     planes.
+    uint8_t *lumMmx2FilterCode;   ///< Runtime-generated MMX2 horizontal fast bilinear scaler code for luma/alpha planes.
+    uint8_t *chrMmx2FilterCode;   ///< Runtime-generated MMX2 horizontal fast bilinear scaler code for chroma     planes.
 
     int canMMX2BeUsed;
 
-    int lastInLumBuf;
-    int lastInChrBuf;
-    int lumBufIndex;
-    int chrBufIndex;
-    int dstY;
-    int flags;
+    int dstY;                     ///< Last destination vertical line output from last slice.
+    int flags;                    ///< Flags passed by the user to select scaler algorithm, optimizations, subsampling, etc...
     void * yuvTable;            // pointer to the yuv->rgb table start so it can be freed()
     uint8_t * table_rV[256];
     uint8_t * table_gU[256];
@@ -138,7 +169,8 @@
     int contrast, brightness, saturation;    // for sws_getColorspaceDetails
     int srcColorspaceTable[4];
     int dstColorspaceTable[4];
-    int srcRange, dstRange;
+    int srcRange;                 ///< 0 = MPG YUV range, 1 = JPG YUV range (source      image).
+    int dstRange;                 ///< 0 = MPG YUV range, 1 = JPG YUV range (destination image).
     int yuv2rgb_y_offset;
     int yuv2rgb_y_coeff;
     int yuv2rgb_v2r_coeff;
@@ -181,7 +213,7 @@
     DECLARE_ALIGNED(8, uint64_t, vOffset);
     int32_t  lumMmxFilter[4*MAX_FILTER_SIZE];
     int32_t  chrMmxFilter[4*MAX_FILTER_SIZE];
-    int dstW;
+    int dstW;                     ///< Width  of destination luma/alpha planes.
     DECLARE_ALIGNED(8, uint64_t, esp);
     DECLARE_ALIGNED(8, uint64_t, vRounder);
     DECLARE_ALIGNED(8, uint64_t, u_temp);
@@ -190,14 +222,14 @@
     int32_t  alpMmxFilter[4*MAX_FILTER_SIZE];
 
 #if HAVE_ALTIVEC
-  vector signed short   CY;
-  vector signed short   CRV;
-  vector signed short   CBU;
-  vector signed short   CGU;
-  vector signed short   CGV;
-  vector signed short   OY;
-  vector unsigned short CSHIFT;
-  vector signed short   *vYCoeffsBank, *vCCoeffsBank;
+    vector signed short   CY;
+    vector signed short   CRV;
+    vector signed short   CBU;
+    vector signed short   CGU;
+    vector signed short   CGV;
+    vector signed short   OY;
+    vector unsigned short CSHIFT;
+    vector signed short   *vYCoeffsBank, *vCCoeffsBank;
 #endif
 
 #if ARCH_BFIN
@@ -215,7 +247,7 @@
 #endif
 
 #if HAVE_VIS
-    DECLARE_ALIGNED(8, uint64_t, sparc_coeffs[10]);
+    DECLARE_ALIGNED(8, uint64_t, sparc_coeffs)[10];
 #endif
 
     /* function pointers for swScale() */
@@ -254,18 +286,18 @@
                         const int16_t **alpSrc, uint8_t *dest,
                         long dstW, long dstY);
 
-    void (*hyscale_internal)(uint8_t *dst, const uint8_t *src,
-                             long width, uint32_t *pal);
-    void (*hascale_internal)(uint8_t *dst, const uint8_t *src,
-                             long width, uint32_t *pal);
-    void (*hcscale_internal)(uint8_t *dstU, uint8_t *dstV,
-                             const uint8_t *src1, const uint8_t *src2,
-                             long width, uint32_t *pal);
+    void (*lumToYV12)(uint8_t *dst, const uint8_t *src,
+                      long width, uint32_t *pal); ///< Unscaled conversion of luma plane to YV12 for horizontal scaler.
+    void (*alpToYV12)(uint8_t *dst, const uint8_t *src,
+                      long width, uint32_t *pal); ///< Unscaled conversion of alpha plane to YV12 for horizontal scaler.
+    void (*chrToYV12)(uint8_t *dstU, uint8_t *dstV,
+                      const uint8_t *src1, const uint8_t *src2,
+                      long width, uint32_t *pal); ///< Unscaled conversion of chroma planes to YV12 for horizontal scaler.
     void (*hyscale_fast)(struct SwsContext *c,
-                         int16_t *dst, int dstWidth,
+                         int16_t *dst, long dstWidth,
                          const uint8_t *src, int srcW, int xInc);
     void (*hcscale_fast)(struct SwsContext *c,
-                         int16_t *dst, int dstWidth,
+                         int16_t *dst, long dstWidth,
                          const uint8_t *src1, const uint8_t *src2,
                          int srcW, int xInc);
 
@@ -273,6 +305,15 @@
                    int xInc, const int16_t *filter, const int16_t *filterPos,
                    long filterSize);
 
+    void (*lumConvertRange)(uint16_t *dst, int width); ///< Color range conversion function for luma plane if needed.
+    void (*chrConvertRange)(uint16_t *dst, int width); ///< Color range conversion function for chroma planes if needed.
+
+    int lumSrcOffset; ///< Offset given to luma src pointers passed to horizontal input functions.
+    int chrSrcOffset; ///< Offset given to chroma src pointers passed to horizontal input functions.
+    int alpSrcOffset; ///< Offset given to alpha src pointers passed to horizontal input functions.
+
+    int needs_hcscale; ///< Set if there are chroma planes to be converted.
+
 } SwsContext;
 //FIXME check init (where 0)
 
@@ -302,12 +343,12 @@
         || (x)==PIX_FMT_GRAY16LE    \
         || (x)==PIX_FMT_RGB48BE     \
         || (x)==PIX_FMT_RGB48LE     \
-        || (x)==PIX_FMT_YUV420PLE   \
-        || (x)==PIX_FMT_YUV422PLE   \
-        || (x)==PIX_FMT_YUV444PLE   \
-        || (x)==PIX_FMT_YUV420PBE   \
-        || (x)==PIX_FMT_YUV422PBE   \
-        || (x)==PIX_FMT_YUV444PBE   \
+        || (x)==PIX_FMT_YUV420P16LE   \
+        || (x)==PIX_FMT_YUV422P16LE   \
+        || (x)==PIX_FMT_YUV444P16LE   \
+        || (x)==PIX_FMT_YUV420P16BE   \
+        || (x)==PIX_FMT_YUV422P16BE   \
+        || (x)==PIX_FMT_YUV444P16BE   \
     )
 #define isBE(x) ((x)&1)
 #define isPlanar8YUV(x) (           \
@@ -323,12 +364,12 @@
     )
 #define isPlanarYUV(x)  (           \
         isPlanar8YUV(x)             \
-        || (x)==PIX_FMT_YUV420PLE   \
-        || (x)==PIX_FMT_YUV422PLE   \
-        || (x)==PIX_FMT_YUV444PLE   \
-        || (x)==PIX_FMT_YUV420PBE   \
-        || (x)==PIX_FMT_YUV422PBE   \
-        || (x)==PIX_FMT_YUV444PBE   \
+        || (x)==PIX_FMT_YUV420P16LE   \
+        || (x)==PIX_FMT_YUV422P16LE   \
+        || (x)==PIX_FMT_YUV444P16LE   \
+        || (x)==PIX_FMT_YUV420P16BE   \
+        || (x)==PIX_FMT_YUV422P16BE   \
+        || (x)==PIX_FMT_YUV444P16BE   \
     )
 #define isYUV(x)        (           \
            (x)==PIX_FMT_UYVY422     \
@@ -344,7 +385,7 @@
            (x)==PIX_FMT_GRAY16BE    \
         || (x)==PIX_FMT_GRAY16LE    \
     )
-#define isRGB(x)        (           \
+#define isRGBinInt(x)   (           \
            (x)==PIX_FMT_RGB48BE     \
         || (x)==PIX_FMT_RGB48LE     \
         || (x)==PIX_FMT_RGB32       \
@@ -358,7 +399,7 @@
         || (x)==PIX_FMT_MONOBLACK   \
         || (x)==PIX_FMT_MONOWHITE   \
     )
-#define isBGR(x)        (           \
+#define isBGRinInt(x)   (           \
            (x)==PIX_FMT_BGR32       \
         || (x)==PIX_FMT_BGR32_1     \
         || (x)==PIX_FMT_BGR24       \
@@ -370,6 +411,22 @@
         || (x)==PIX_FMT_MONOBLACK   \
         || (x)==PIX_FMT_MONOWHITE   \
     )
+#define isRGBinBytes(x) (           \
+           (x)==PIX_FMT_RGB48BE     \
+        || (x)==PIX_FMT_RGB48LE     \
+        || (x)==PIX_FMT_RGBA        \
+        || (x)==PIX_FMT_ARGB        \
+        || (x)==PIX_FMT_RGB24       \
+    )
+#define isBGRinBytes(x) (           \
+           (x)==PIX_FMT_BGRA        \
+        || (x)==PIX_FMT_ABGR        \
+        || (x)==PIX_FMT_BGR24       \
+    )
+#define isAnyRGB(x)     (           \
+            isRGBinInt(x)           \
+        ||  isBGRinInt(x)           \
+    )
 #define isALPHA(x)      (           \
            (x)==PIX_FMT_BGR32       \
         || (x)==PIX_FMT_BGR32_1     \
@@ -378,47 +435,26 @@
         || (x)==PIX_FMT_YUVA420P    \
     )
 
-static inline int fmt_depth(int fmt)
-{
-    switch(fmt) {
-    case PIX_FMT_RGB48BE:
-    case PIX_FMT_RGB48LE:
-        return 48;
-    case PIX_FMT_BGRA:
-    case PIX_FMT_ABGR:
-    case PIX_FMT_RGBA:
-    case PIX_FMT_ARGB:
-        return 32;
-    case PIX_FMT_BGR24:
-    case PIX_FMT_RGB24:
-        return 24;
-    case PIX_FMT_BGR565:
-    case PIX_FMT_RGB565:
-    case PIX_FMT_GRAY16BE:
-    case PIX_FMT_GRAY16LE:
-        return 16;
-    case PIX_FMT_BGR555:
-    case PIX_FMT_RGB555:
-        return 15;
-    case PIX_FMT_BGR8:
-    case PIX_FMT_RGB8:
-        return 8;
-    case PIX_FMT_BGR4:
-    case PIX_FMT_RGB4:
-    case PIX_FMT_BGR4_BYTE:
-    case PIX_FMT_RGB4_BYTE:
-        return 4;
-    case PIX_FMT_MONOBLACK:
-    case PIX_FMT_MONOWHITE:
-        return 1;
-    default:
-        return 0;
-    }
-}
-
 extern const uint64_t ff_dither4[2];
 extern const uint64_t ff_dither8[2];
 
 extern const AVClass sws_context_class;
 
+/**
+ * Sets c->swScale to an unscaled converter if one exists for the specific
+ * source and destination formats, bit depths, flags, etc.
+ */
+void ff_get_unscaled_swscale(SwsContext *c);
+
+/**
+ * Returns the SWS_CPU_CAPS for the optimized code compiled into swscale.
+ */
+int ff_hardcodedcpuflags(void);
+
+/**
+ * Returns function pointer to fastest main scaler path function depending
+ * on architecture and available optimizations.
+ */
+SwsFunc ff_getSwsFunc(SwsContext *c);
+
 #endif /* SWSCALE_SWSCALE_INTERNAL_H */

Modified: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libswscale/swscale_template.c
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libswscale/swscale_template.c	2010-05-26 05:26:42 UTC (rev 6237)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libswscale/swscale_template.c	2010-05-26 05:26:46 UTC (rev 6238)
@@ -25,17 +25,13 @@
 #undef MOVNTQ
 #undef PAVGB
 #undef PREFETCH
-#undef PREFETCHW
 
 #if COMPILE_TEMPLATE_AMD3DNOW
 #define PREFETCH  "prefetch"
-#define PREFETCHW "prefetchw"
 #elif COMPILE_TEMPLATE_MMX2
 #define PREFETCH "prefetchnta"
-#define PREFETCHW "prefetcht0"
 #else
 #define PREFETCH  " # nop"
-#define PREFETCHW " # nop"
 #endif
 
 #if COMPILE_TEMPLATE_MMX2
@@ -944,7 +940,7 @@
 
 static inline void RENAME(yuv2nv12X)(SwsContext *c, const int16_t *lumFilter, const int16_t **lumSrc, int lumFilterSize,
                                      const int16_t *chrFilter, const int16_t **chrSrc, int chrFilterSize,
-                                     uint8_t *dest, uint8_t *uDest, int dstW, int chrDstW, int dstFormat)
+                                     uint8_t *dest, uint8_t *uDest, int dstW, int chrDstW, enum PixelFormat dstFormat)
 {
     yuv2nv12XinC(lumFilter, lumSrc, lumFilterSize,
                  chrFilter, chrSrc, chrFilterSize,
@@ -958,7 +954,7 @@
 #if COMPILE_TEMPLATE_MMX
     if(!(c->flags & SWS_BITEXACT)) {
         long p= 4;
-        uint8_t *src[4]= {alpSrc + dstW, lumSrc + dstW, chrSrc + chrDstW, chrSrc + VOFW + chrDstW};
+        const uint8_t *src[4]= {alpSrc + dstW, lumSrc + dstW, chrSrc + chrDstW, chrSrc + VOFW + chrDstW};
         uint8_t *dst[4]= {aDest, dest, uDest, vDest};
         x86_reg counter[4]= {dstW, dstW, chrDstW, chrDstW};
 
@@ -1226,21 +1222,21 @@
             if (CONFIG_SWSCALE_ALPHA && c->alpPixBuf) {
 #if ARCH_X86_64
                 __asm__ volatile(
-                    YSCALEYUV2RGB(%%REGBP, %5)
-                    YSCALEYUV2RGB_YA(%%REGBP, %5, %6, %7)
+                    YSCALEYUV2RGB(%%r8, %5)
+                    YSCALEYUV2RGB_YA(%%r8, %5, %6, %7)
                     "psraw                  $3, %%mm1       \n\t" /* abuf0[eax] - abuf1[eax] >>7*/
                     "psraw                  $3, %%mm7       \n\t" /* abuf0[eax] - abuf1[eax] >>7*/
                     "packuswb            %%mm7, %%mm1       \n\t"
-                    WRITEBGR32(%4, 8280(%5), %%REGBP, %%mm2, %%mm4, %%mm5, %%mm1, %%mm0, %%mm7, %%mm3, %%mm6)
+                    WRITEBGR32(%4, 8280(%5), %%r8, %%mm2, %%mm4, %%mm5, %%mm1, %%mm0, %%mm7, %%mm3, %%mm6)
 
                     :: "c" (buf0), "d" (buf1), "S" (uvbuf0), "D" (uvbuf1), "r" (dest),
                     "a" (&c->redDither)
                     ,"r" (abuf0), "r" (abuf1)
-                    : "%"REG_BP
+                    : "%r8"
                 );
 #else
-                *(uint16_t **)(&c->u_temp)=abuf0;
-                *(uint16_t **)(&c->v_temp)=abuf1;
+                *(const uint16_t **)(&c->u_temp)=abuf0;
+                *(const uint16_t **)(&c->v_temp)=abuf1;
                 __asm__ volatile(
                     "mov %%"REG_b", "ESP_OFFSET"(%5)        \n\t"
                     "mov        %4, %%"REG_b"               \n\t"
@@ -1361,7 +1357,7 @@
  * YV12 to RGB without scaling or interpolating
  */
 static inline void RENAME(yuv2packed1)(SwsContext *c, const uint16_t *buf0, const uint16_t *uvbuf0, const uint16_t *uvbuf1,
-                          const uint16_t *abuf0, uint8_t *dest, int dstW, int uvalpha, int dstFormat, int flags, int y)
+                          const uint16_t *abuf0, uint8_t *dest, int dstW, int uvalpha, enum PixelFormat dstFormat, int flags, int y)
 {
     const int yalpha1=0;
     int i;
@@ -1784,10 +1780,58 @@
 #endif
 }
 
+static inline void RENAME(nvXXtoUV)(uint8_t *dst1, uint8_t *dst2,
+                                    const uint8_t *src, long width)
+{
 #if COMPILE_TEMPLATE_MMX
-static inline void RENAME(bgr24ToY_mmx)(uint8_t *dst, const uint8_t *src, long width, int srcFormat)
+    __asm__ volatile(
+        "movq "MANGLE(bm01010101)", %%mm4           \n\t"
+        "mov                    %0, %%"REG_a"       \n\t"
+        "1:                                         \n\t"
+        "movq    (%1, %%"REG_a",2), %%mm0           \n\t"
+        "movq   8(%1, %%"REG_a",2), %%mm1           \n\t"
+        "movq                %%mm0, %%mm2           \n\t"
+        "movq                %%mm1, %%mm3           \n\t"
+        "pand                %%mm4, %%mm0           \n\t"
+        "pand                %%mm4, %%mm1           \n\t"
+        "psrlw                  $8, %%mm2           \n\t"
+        "psrlw                  $8, %%mm3           \n\t"
+        "packuswb            %%mm1, %%mm0           \n\t"
+        "packuswb            %%mm3, %%mm2           \n\t"
+        "movq                %%mm0, (%2, %%"REG_a") \n\t"
+        "movq                %%mm2, (%3, %%"REG_a") \n\t"
+        "add                    $8, %%"REG_a"       \n\t"
+        " js                    1b                  \n\t"
+        : : "g" ((x86_reg)-width), "r" (src+width*2), "r" (dst1+width), "r" (dst2+width)
+        : "%"REG_a
+    );
+#else
+    int i;
+    for (i = 0; i < width; i++) {
+        dst1[i] = src[2*i+0];
+        dst2[i] = src[2*i+1];
+    }
+#endif
+}
+
+static inline void RENAME(nv12ToUV)(uint8_t *dstU, uint8_t *dstV,
+                                    const uint8_t *src1, const uint8_t *src2,
+                                    long width, uint32_t *unused)
 {
+    RENAME(nvXXtoUV)(dstU, dstV, src1, width);
+}
 
+static inline void RENAME(nv21ToUV)(uint8_t *dstU, uint8_t *dstV,
+                                    const uint8_t *src1, const uint8_t *src2,
+                                    long width, uint32_t *unused)
+{
+    RENAME(nvXXtoUV)(dstV, dstU, src1, width);
+}
+
+#if COMPILE_TEMPLATE_MMX
+static inline void RENAME(bgr24ToY_mmx)(uint8_t *dst, const uint8_t *src, long width, enum PixelFormat srcFormat)
+{
+
     if(srcFormat == PIX_FMT_BGR24) {
         __asm__ volatile(
             "movq  "MANGLE(ff_bgr24toY1Coeff)", %%mm5       \n\t"
@@ -1838,7 +1882,7 @@
     );
 }
 
-static inline void RENAME(bgr24ToUV_mmx)(uint8_t *dstU, uint8_t *dstV, const uint8_t *src, long width, int srcFormat)
+static inline void RENAME(bgr24ToUV_mmx)(uint8_t *dstU, uint8_t *dstV, const uint8_t *src, long width, enum PixelFormat srcFormat)
 {
     __asm__ volatile(
         "movq                    24+%4, %%mm6       \n\t"
@@ -2101,7 +2145,7 @@
 #endif
         );
     } else {
-        uint8_t *offset = src+filterSize;
+        const uint8_t *offset = src+filterSize;
         x86_reg counter= -2*dstW;
         //filter-= counter*filterSize/2;
         filterPos-= counter/2;
@@ -2171,6 +2215,37 @@
 #endif /* COMPILE_MMX */
 }
 
+//FIXME all pal and rgb srcFormats could do this convertion as well
+//FIXME all scalers more complex than bilinear could do half of this transform
+static void RENAME(chrRangeToJpeg)(uint16_t *dst, int width)
+{
+    int i;
+    for (i = 0; i < width; i++) {
+        dst[i     ] = (FFMIN(dst[i     ],30775)*4663 - 9289992)>>12; //-264
+        dst[i+VOFW] = (FFMIN(dst[i+VOFW],30775)*4663 - 9289992)>>12; //-264
+    }
+}
+static void RENAME(chrRangeFromJpeg)(uint16_t *dst, int width)
+{
+    int i;
+    for (i = 0; i < width; i++) {
+        dst[i     ] = (dst[i     ]*1799 + 4081085)>>11; //1469
+        dst[i+VOFW] = (dst[i+VOFW]*1799 + 4081085)>>11; //1469
+    }
+}
+static void RENAME(lumRangeToJpeg)(uint16_t *dst, int width)
+{
+    int i;
+    for (i = 0; i < width; i++)
+        dst[i] = (FFMIN(dst[i],30189)*19077 - 39057361)>>14;
+}
+static void RENAME(lumRangeFromJpeg)(uint16_t *dst, int width)
+{
+    int i;
+    for (i = 0; i < width; i++)
+        dst[i] = (dst[i]*14071 + 33561947)>>14;
+}
+
 #define FAST_BILINEAR_X86 \
     "subl    %%edi, %%esi    \n\t" /*  src[xx+1] - src[xx] */                   \
     "imull   %%ecx, %%esi    \n\t" /* (src[xx+1] - src[xx])*xalpha */           \
@@ -2180,10 +2255,117 @@
     "shrl       $9, %%esi    \n\t"                                              \
 
 static inline void RENAME(hyscale_fast)(SwsContext *c, int16_t *dst,
-                                        int dstWidth, const uint8_t *src, int srcW,
+                                        long dstWidth, const uint8_t *src, int srcW,
                                         int xInc)
 {
+#if ARCH_X86 && CONFIG_GPL
+#if COMPILE_TEMPLATE_MMX2
+    int32_t *filterPos = c->hLumFilterPos;
+    int16_t *filter    = c->hLumFilter;
+    int     canMMX2BeUsed  = c->canMMX2BeUsed;
+    void    *mmx2FilterCode= c->lumMmx2FilterCode;
     int i;
+#if defined(PIC)
+    DECLARE_ALIGNED(8, uint64_t, ebxsave);
+#endif
+    if (canMMX2BeUsed) {
+        __asm__ volatile(
+#if defined(PIC)
+            "mov               %%"REG_b", %5        \n\t"
+#endif
+            "pxor                  %%mm7, %%mm7     \n\t"
+            "mov                      %0, %%"REG_c" \n\t"
+            "mov                      %1, %%"REG_D" \n\t"
+            "mov                      %2, %%"REG_d" \n\t"
+            "mov                      %3, %%"REG_b" \n\t"
+            "xor               %%"REG_a", %%"REG_a" \n\t" // i
+            PREFETCH"        (%%"REG_c")            \n\t"
+            PREFETCH"      32(%%"REG_c")            \n\t"
+            PREFETCH"      64(%%"REG_c")            \n\t"
+
+#if ARCH_X86_64
+
+#define CALL_MMX2_FILTER_CODE \
+            "movl            (%%"REG_b"), %%esi     \n\t"\
+            "call                    *%4            \n\t"\
+            "movl (%%"REG_b", %%"REG_a"), %%esi     \n\t"\
+            "add               %%"REG_S", %%"REG_c" \n\t"\
+            "add               %%"REG_a", %%"REG_D" \n\t"\
+            "xor               %%"REG_a", %%"REG_a" \n\t"\
+
+#else
+
+#define CALL_MMX2_FILTER_CODE \
+            "movl (%%"REG_b"), %%esi        \n\t"\
+            "call         *%4                       \n\t"\
+            "addl (%%"REG_b", %%"REG_a"), %%"REG_c" \n\t"\
+            "add               %%"REG_a", %%"REG_D" \n\t"\
+            "xor               %%"REG_a", %%"REG_a" \n\t"\
+
+#endif /* ARCH_X86_64 */
+
+            CALL_MMX2_FILTER_CODE
+            CALL_MMX2_FILTER_CODE
+            CALL_MMX2_FILTER_CODE
+            CALL_MMX2_FILTER_CODE
+            CALL_MMX2_FILTER_CODE
+            CALL_MMX2_FILTER_CODE
+            CALL_MMX2_FILTER_CODE
+            CALL_MMX2_FILTER_CODE
+
+#if defined(PIC)
+            "mov                      %5, %%"REG_b" \n\t"
+#endif
+            :: "m" (src), "m" (dst), "m" (filter), "m" (filterPos),
+            "m" (mmx2FilterCode)
+#if defined(PIC)
+            ,"m" (ebxsave)
+#endif
+            : "%"REG_a, "%"REG_c, "%"REG_d, "%"REG_S, "%"REG_D
+#if !defined(PIC)
+            ,"%"REG_b
+#endif
+        );
+        for (i=dstWidth-1; (i*xInc)>>16 >=srcW-1; i--) dst[i] = src[srcW-1]*128;
+    } else {
+#endif /* COMPILE_TEMPLATE_MMX2 */
+    x86_reg xInc_shr16 = xInc >> 16;
+    uint16_t xInc_mask = xInc & 0xffff;
+    //NO MMX just normal asm ...
+    __asm__ volatile(
+        "xor %%"REG_a", %%"REG_a"            \n\t" // i
+        "xor %%"REG_d", %%"REG_d"            \n\t" // xx
+        "xorl    %%ecx, %%ecx                \n\t" // xalpha
+        ASMALIGN(4)
+        "1:                                  \n\t"
+        "movzbl    (%0, %%"REG_d"), %%edi    \n\t" //src[xx]
+        "movzbl   1(%0, %%"REG_d"), %%esi    \n\t" //src[xx+1]
+        FAST_BILINEAR_X86
+        "movw     %%si, (%%"REG_D", %%"REG_a", 2)   \n\t"
+        "addw       %4, %%cx                 \n\t" //xalpha += xInc&0xFFFF
+        "adc        %3, %%"REG_d"            \n\t" //xx+= xInc>>16 + carry
+
+        "movzbl    (%0, %%"REG_d"), %%edi    \n\t" //src[xx]
+        "movzbl   1(%0, %%"REG_d"), %%esi    \n\t" //src[xx+1]
+        FAST_BILINEAR_X86
+        "movw     %%si, 2(%%"REG_D", %%"REG_a", 2)  \n\t"
+        "addw       %4, %%cx                 \n\t" //xalpha += xInc&0xFFFF
+        "adc        %3, %%"REG_d"            \n\t" //xx+= xInc>>16 + carry
+
+
+        "add        $2, %%"REG_a"            \n\t"
+        "cmp        %2, %%"REG_a"            \n\t"
+        " jb        1b                       \n\t"
+
+
+        :: "r" (src), "m" (dst), "m" (dstWidth), "m" (xInc_shr16), "m" (xInc_mask)
+        : "%"REG_a, "%"REG_d, "%ecx", "%"REG_D, "%esi"
+    );
+#if COMPILE_TEMPLATE_MMX2
+    } //if MMX2 can't be used
+#endif
+#else
+    int i;
     unsigned int xpos=0;
     for (i=0;i<dstWidth;i++) {
         register unsigned int xx=xpos>>16;
@@ -2191,171 +2373,141 @@
         dst[i]= (src[xx]<<7) + (src[xx+1] - src[xx])*xalpha;
         xpos+=xInc;
     }
+#endif /* ARCH_X86 */
 }
 
       // *** horizontal scale Y line to temp buffer
 static inline void RENAME(hyscale)(SwsContext *c, uint16_t *dst, long dstWidth, const uint8_t *src, int srcW, int xInc,
-                                   int flags, const int16_t *hLumFilter,
+                                   const int16_t *hLumFilter,
                                    const int16_t *hLumFilterPos, int hLumFilterSize,
-                                   int srcFormat, uint8_t *formatConvBuffer,
+                                   uint8_t *formatConvBuffer,
                                    uint32_t *pal, int isAlpha)
 {
-    int32_t av_unused *mmx2FilterPos = c->lumMmx2FilterPos;
-    int16_t av_unused *mmx2Filter    = c->lumMmx2Filter;
-    int     av_unused canMMX2BeUsed  = c->canMMX2BeUsed;
-    void    av_unused *mmx2FilterCode= c->lumMmx2FilterCode;
-    void (*internal_func)(uint8_t *, const uint8_t *, long, uint32_t *) = isAlpha ? c->hascale_internal : c->hyscale_internal;
+    void (*toYV12)(uint8_t *, const uint8_t *, long, uint32_t *) = isAlpha ? c->alpToYV12 : c->lumToYV12;
+    void (*convertRange)(uint16_t *, int) = isAlpha ? NULL : c->lumConvertRange;
 
-    if (isAlpha) {
-        if (srcFormat == PIX_FMT_RGB32   || srcFormat == PIX_FMT_BGR32  )
-            src += 3;
-    } else {
-        if (srcFormat == PIX_FMT_RGB32_1 || srcFormat == PIX_FMT_BGR32_1)
-            src += ALT32_CORR;
-    }
+    src += isAlpha ? c->alpSrcOffset : c->lumSrcOffset;
 
-    if (srcFormat == PIX_FMT_RGB48LE)
-        src++;
-
-    if (internal_func) {
-        internal_func(formatConvBuffer, src, srcW, pal);
+    if (toYV12) {
+        toYV12(formatConvBuffer, src, srcW, pal);
         src= formatConvBuffer;
     }
 
-#if COMPILE_TEMPLATE_MMX
-    // Use the new MMX scaler if the MMX2 one can't be used (it is faster than the x86 ASM one).
-    if (!(flags&SWS_FAST_BILINEAR) || (!canMMX2BeUsed))
-#else
-    if (!(flags&SWS_FAST_BILINEAR))
-#endif
-    {
+    if (!c->hyscale_fast) {
         c->hScale(dst, dstWidth, src, srcW, xInc, hLumFilter, hLumFilterPos, hLumFilterSize);
     } else { // fast bilinear upscale / crap downscale
+        c->hyscale_fast(c, dst, dstWidth, src, srcW, xInc);
+    }
+
+    if (convertRange)
+        convertRange(dst, dstWidth);
+}
+
+static inline void RENAME(hcscale_fast)(SwsContext *c, int16_t *dst,
+                                        long dstWidth, const uint8_t *src1,
+                                        const uint8_t *src2, int srcW, int xInc)
+{
 #if ARCH_X86 && CONFIG_GPL
 #if COMPILE_TEMPLATE_MMX2
-        int i;
+    int32_t *filterPos = c->hChrFilterPos;
+    int16_t *filter    = c->hChrFilter;
+    int     canMMX2BeUsed  = c->canMMX2BeUsed;
+    void    *mmx2FilterCode= c->chrMmx2FilterCode;
+    int i;
 #if defined(PIC)
-        DECLARE_ALIGNED(8, uint64_t, ebxsave);
+    DECLARE_ALIGNED(8, uint64_t, ebxsave);
 #endif
-        if (canMMX2BeUsed) {
-            __asm__ volatile(
+    if (canMMX2BeUsed) {
+        __asm__ volatile(
 #if defined(PIC)
-                "mov               %%"REG_b", %5        \n\t"
+            "mov          %%"REG_b", %6         \n\t"
 #endif
-                "pxor                  %%mm7, %%mm7     \n\t"
-                "mov                      %0, %%"REG_c" \n\t"
-                "mov                      %1, %%"REG_D" \n\t"
-                "mov                      %2, %%"REG_d" \n\t"
-                "mov                      %3, %%"REG_b" \n\t"
-                "xor               %%"REG_a", %%"REG_a" \n\t" // i
-                PREFETCH"        (%%"REG_c")            \n\t"
-                PREFETCH"      32(%%"REG_c")            \n\t"
-                PREFETCH"      64(%%"REG_c")            \n\t"
+            "pxor             %%mm7, %%mm7      \n\t"
+            "mov                 %0, %%"REG_c"  \n\t"
+            "mov                 %1, %%"REG_D"  \n\t"
+            "mov                 %2, %%"REG_d"  \n\t"
+            "mov                 %3, %%"REG_b"  \n\t"
+            "xor          %%"REG_a", %%"REG_a"  \n\t" // i
+            PREFETCH"   (%%"REG_c")             \n\t"
+            PREFETCH" 32(%%"REG_c")             \n\t"
+            PREFETCH" 64(%%"REG_c")             \n\t"
 
-#if ARCH_X86_64
+            CALL_MMX2_FILTER_CODE
+            CALL_MMX2_FILTER_CODE
+            CALL_MMX2_FILTER_CODE
+            CALL_MMX2_FILTER_CODE
+            "xor          %%"REG_a", %%"REG_a"  \n\t" // i
+            "mov                 %5, %%"REG_c"  \n\t" // src
+            "mov                 %1, %%"REG_D"  \n\t" // buf1
+            "add              $"AV_STRINGIFY(VOF)", %%"REG_D"  \n\t"
+            PREFETCH"   (%%"REG_c")             \n\t"
+            PREFETCH" 32(%%"REG_c")             \n\t"
+            PREFETCH" 64(%%"REG_c")             \n\t"
 
-#define CALL_MMX2_FILTER_CODE \
-                "movl            (%%"REG_b"), %%esi     \n\t"\
-                "call                    *%4            \n\t"\
-                "movl (%%"REG_b", %%"REG_a"), %%esi     \n\t"\
-                "add               %%"REG_S", %%"REG_c" \n\t"\
-                "add               %%"REG_a", %%"REG_D" \n\t"\
-                "xor               %%"REG_a", %%"REG_a" \n\t"\
+            CALL_MMX2_FILTER_CODE
+            CALL_MMX2_FILTER_CODE
+            CALL_MMX2_FILTER_CODE
+            CALL_MMX2_FILTER_CODE
 
-#else
-
-#define CALL_MMX2_FILTER_CODE \
-                "movl (%%"REG_b"), %%esi        \n\t"\
-                "call         *%4                       \n\t"\
-                "addl (%%"REG_b", %%"REG_a"), %%"REG_c" \n\t"\
-                "add               %%"REG_a", %%"REG_D" \n\t"\
-                "xor               %%"REG_a", %%"REG_a" \n\t"\
-
-#endif /* ARCH_X86_64 */
-
-                CALL_MMX2_FILTER_CODE
-                CALL_MMX2_FILTER_CODE
-                CALL_MMX2_FILTER_CODE
-                CALL_MMX2_FILTER_CODE
-                CALL_MMX2_FILTER_CODE
-                CALL_MMX2_FILTER_CODE
-                CALL_MMX2_FILTER_CODE
-                CALL_MMX2_FILTER_CODE
-
 #if defined(PIC)
-                "mov                      %5, %%"REG_b" \n\t"
+            "mov %6, %%"REG_b"    \n\t"
 #endif
-                :: "m" (src), "m" (dst), "m" (mmx2Filter), "m" (mmx2FilterPos),
-                "m" (mmx2FilterCode)
+            :: "m" (src1), "m" (dst), "m" (filter), "m" (filterPos),
+            "m" (mmx2FilterCode), "m" (src2)
 #if defined(PIC)
-                ,"m" (ebxsave)
+            ,"m" (ebxsave)
 #endif
-                : "%"REG_a, "%"REG_c, "%"REG_d, "%"REG_S, "%"REG_D
+            : "%"REG_a, "%"REG_c, "%"REG_d, "%"REG_S, "%"REG_D
 #if !defined(PIC)
-                ,"%"REG_b
+            ,"%"REG_b
 #endif
-            );
-            for (i=dstWidth-1; (i*xInc)>>16 >=srcW-1; i--) dst[i] = src[srcW-1]*128;
-        } else {
+        );
+        for (i=dstWidth-1; (i*xInc)>>16 >=srcW-1; i--) {
+            //printf("%d %d %d\n", dstWidth, i, srcW);
+            dst[i] = src1[srcW-1]*128;
+            dst[i+VOFW] = src2[srcW-1]*128;
+        }
+    } else {
 #endif /* COMPILE_TEMPLATE_MMX2 */
-        x86_reg xInc_shr16 = xInc >> 16;
+        x86_reg xInc_shr16 = (x86_reg) (xInc >> 16);
         uint16_t xInc_mask = xInc & 0xffff;
-        //NO MMX just normal asm ...
         __asm__ volatile(
-            "xor %%"REG_a", %%"REG_a"            \n\t" // i
-            "xor %%"REG_d", %%"REG_d"            \n\t" // xx
-            "xorl    %%ecx, %%ecx                \n\t" // xalpha
+            "xor %%"REG_a", %%"REG_a"               \n\t" // i
+            "xor %%"REG_d", %%"REG_d"               \n\t" // xx
+            "xorl    %%ecx, %%ecx                   \n\t" // xalpha
             ASMALIGN(4)
-            "1:                                  \n\t"
-            "movzbl    (%0, %%"REG_d"), %%edi    \n\t" //src[xx]
-            "movzbl   1(%0, %%"REG_d"), %%esi    \n\t" //src[xx+1]
+            "1:                                     \n\t"
+            "mov        %0, %%"REG_S"               \n\t"
+            "movzbl  (%%"REG_S", %%"REG_d"), %%edi  \n\t" //src[xx]
+            "movzbl 1(%%"REG_S", %%"REG_d"), %%esi  \n\t" //src[xx+1]
             FAST_BILINEAR_X86
             "movw     %%si, (%%"REG_D", %%"REG_a", 2)   \n\t"
-            "addw       %4, %%cx                 \n\t" //xalpha += xInc&0xFFFF
-            "adc        %3, %%"REG_d"            \n\t" //xx+= xInc>>16 + carry
 
-            "movzbl    (%0, %%"REG_d"), %%edi    \n\t" //src[xx]
-            "movzbl   1(%0, %%"REG_d"), %%esi    \n\t" //src[xx+1]
+            "movzbl    (%5, %%"REG_d"), %%edi       \n\t" //src[xx]
+            "movzbl   1(%5, %%"REG_d"), %%esi       \n\t" //src[xx+1]
             FAST_BILINEAR_X86
-            "movw     %%si, 2(%%"REG_D", %%"REG_a", 2)  \n\t"
-            "addw       %4, %%cx                 \n\t" //xalpha += xInc&0xFFFF
-            "adc        %3, %%"REG_d"            \n\t" //xx+= xInc>>16 + carry
+            "movw     %%si, "AV_STRINGIFY(VOF)"(%%"REG_D", %%"REG_a", 2)   \n\t"
 
+            "addw       %4, %%cx                    \n\t" //xalpha += xInc&0xFFFF
+            "adc        %3, %%"REG_d"               \n\t" //xx+= xInc>>16 + carry
+            "add        $1, %%"REG_a"               \n\t"
+            "cmp        %2, %%"REG_a"               \n\t"
+            " jb        1b                          \n\t"
 
-            "add        $2, %%"REG_a"            \n\t"
-            "cmp        %2, %%"REG_a"            \n\t"
-            " jb        1b                       \n\t"
-
-
-            :: "r" (src), "m" (dst), "m" (dstWidth), "m" (xInc_shr16), "m" (xInc_mask)
+/* GCC 3.3 makes MPlayer crash on IA-32 machines when using "g" operand here,
+which is needed to support GCC 4.0. */
+#if ARCH_X86_64 && AV_GCC_VERSION_AT_LEAST(3,4)
+            :: "m" (src1), "m" (dst), "g" (dstWidth), "m" (xInc_shr16), "m" (xInc_mask),
+#else
+            :: "m" (src1), "m" (dst), "m" (dstWidth), "m" (xInc_shr16), "m" (xInc_mask),
+#endif
+            "r" (src2)
             : "%"REG_a, "%"REG_d, "%ecx", "%"REG_D, "%esi"
         );
 #if COMPILE_TEMPLATE_MMX2
-        } //if MMX2 can't be used
+    } //if MMX2 can't be used
 #endif
 #else
-        c->hyscale_fast(c, dst, dstWidth, src, srcW, xInc);
-#endif /* ARCH_X86 */
-    }
-
-    if(!isAlpha && c->srcRange != c->dstRange && !(isRGB(c->dstFormat) || isBGR(c->dstFormat))) {
-        int i;
-        //FIXME all pal and rgb srcFormats could do this convertion as well
-        //FIXME all scalers more complex than bilinear could do half of this transform
-        if(c->srcRange) {
-            for (i=0; i<dstWidth; i++)
-                dst[i]= (dst[i]*14071 + 33561947)>>14;
-        } else {
-            for (i=0; i<dstWidth; i++)
-                dst[i]= (FFMIN(dst[i],30189)*19077 - 39057361)>>14;
-        }
-    }
-}
-
-static inline void RENAME(hcscale_fast)(SwsContext *c, int16_t *dst,
-                                        int dstWidth, const uint8_t *src1,
-                                        const uint8_t *src2, int srcW, int xInc)
-{
     int i;
     unsigned int xpos=0;
     for (i=0;i<dstWidth;i++) {
@@ -2369,167 +2521,40 @@
         */
         xpos+=xInc;
     }
+#endif /* ARCH_X86 */
 }
 
 inline static void RENAME(hcscale)(SwsContext *c, uint16_t *dst, long dstWidth, const uint8_t *src1, const uint8_t *src2,
-                                   int srcW, int xInc, int flags, const int16_t *hChrFilter,
+                                   int srcW, int xInc, const int16_t *hChrFilter,
                                    const int16_t *hChrFilterPos, int hChrFilterSize,
-                                   int srcFormat, uint8_t *formatConvBuffer,
+                                   uint8_t *formatConvBuffer,
                                    uint32_t *pal)
 {
-    int32_t av_unused *mmx2FilterPos = c->chrMmx2FilterPos;
-    int16_t av_unused *mmx2Filter    = c->chrMmx2Filter;
-    int     av_unused canMMX2BeUsed  = c->canMMX2BeUsed;
-    void    av_unused *mmx2FilterCode= c->chrMmx2FilterCode;
 
-    if (isGray(srcFormat) || srcFormat==PIX_FMT_MONOBLACK || srcFormat==PIX_FMT_MONOWHITE)
-        return;
+    src1 += c->chrSrcOffset;
+    src2 += c->chrSrcOffset;
 
-    if (srcFormat==PIX_FMT_RGB32_1 || srcFormat==PIX_FMT_BGR32_1) {
-        src1 += ALT32_CORR;
-        src2 += ALT32_CORR;
-    }
-
-    if (srcFormat==PIX_FMT_RGB48LE) {
-        src1++;
-        src2++;
-    }
-
-    if (c->hcscale_internal) {
-        c->hcscale_internal(formatConvBuffer, formatConvBuffer+VOFW, src1, src2, srcW, pal);
+    if (c->chrToYV12) {
+        c->chrToYV12(formatConvBuffer, formatConvBuffer+VOFW, src1, src2, srcW, pal);
         src1= formatConvBuffer;
         src2= formatConvBuffer+VOFW;
     }
 
-#if COMPILE_TEMPLATE_MMX
-    // Use the new MMX scaler if the MMX2 one can't be used (it is faster than the x86 ASM one).
-    if (!(flags&SWS_FAST_BILINEAR) || (!canMMX2BeUsed))
-#else
-    if (!(flags&SWS_FAST_BILINEAR))
-#endif
-    {
+    if (!c->hcscale_fast) {
         c->hScale(dst     , dstWidth, src1, srcW, xInc, hChrFilter, hChrFilterPos, hChrFilterSize);
         c->hScale(dst+VOFW, dstWidth, src2, srcW, xInc, hChrFilter, hChrFilterPos, hChrFilterSize);
     } else { // fast bilinear upscale / crap downscale
-#if ARCH_X86 && CONFIG_GPL
-#if COMPILE_TEMPLATE_MMX2
-        int i;
-#if defined(PIC)
-        DECLARE_ALIGNED(8, uint64_t, ebxsave);
-#endif
-        if (canMMX2BeUsed) {
-            __asm__ volatile(
-#if defined(PIC)
-                "mov          %%"REG_b", %6         \n\t"
-#endif
-                "pxor             %%mm7, %%mm7      \n\t"
-                "mov                 %0, %%"REG_c"  \n\t"
-                "mov                 %1, %%"REG_D"  \n\t"
-                "mov                 %2, %%"REG_d"  \n\t"
-                "mov                 %3, %%"REG_b"  \n\t"
-                "xor          %%"REG_a", %%"REG_a"  \n\t" // i
-                PREFETCH"   (%%"REG_c")             \n\t"
-                PREFETCH" 32(%%"REG_c")             \n\t"
-                PREFETCH" 64(%%"REG_c")             \n\t"
-
-                CALL_MMX2_FILTER_CODE
-                CALL_MMX2_FILTER_CODE
-                CALL_MMX2_FILTER_CODE
-                CALL_MMX2_FILTER_CODE
-                "xor          %%"REG_a", %%"REG_a"  \n\t" // i
-                "mov                 %5, %%"REG_c"  \n\t" // src
-                "mov                 %1, %%"REG_D"  \n\t" // buf1
-                "add              $"AV_STRINGIFY(VOF)", %%"REG_D"  \n\t"
-                PREFETCH"   (%%"REG_c")             \n\t"
-                PREFETCH" 32(%%"REG_c")             \n\t"
-                PREFETCH" 64(%%"REG_c")             \n\t"
-
-                CALL_MMX2_FILTER_CODE
-                CALL_MMX2_FILTER_CODE
-                CALL_MMX2_FILTER_CODE
-                CALL_MMX2_FILTER_CODE
-
-#if defined(PIC)
-                "mov %6, %%"REG_b"    \n\t"
-#endif
-                :: "m" (src1), "m" (dst), "m" (mmx2Filter), "m" (mmx2FilterPos),
-                "m" (mmx2FilterCode), "m" (src2)
-#if defined(PIC)
-                ,"m" (ebxsave)
-#endif
-                : "%"REG_a, "%"REG_c, "%"REG_d, "%"REG_S, "%"REG_D
-#if !defined(PIC)
-                ,"%"REG_b
-#endif
-            );
-            for (i=dstWidth-1; (i*xInc)>>16 >=srcW-1; i--) {
-                //printf("%d %d %d\n", dstWidth, i, srcW);
-                dst[i] = src1[srcW-1]*128;
-                dst[i+VOFW] = src2[srcW-1]*128;
-            }
-        } else {
-#endif /* COMPILE_TEMPLATE_MMX2 */
-            x86_reg xInc_shr16 = (x86_reg) (xInc >> 16);
-            uint16_t xInc_mask = xInc & 0xffff;
-            __asm__ volatile(
-                "xor %%"REG_a", %%"REG_a"               \n\t" // i
-                "xor %%"REG_d", %%"REG_d"               \n\t" // xx
-                "xorl    %%ecx, %%ecx                   \n\t" // xalpha
-                ASMALIGN(4)
-                "1:                                     \n\t"
-                "mov        %0, %%"REG_S"               \n\t"
-                "movzbl  (%%"REG_S", %%"REG_d"), %%edi  \n\t" //src[xx]
-                "movzbl 1(%%"REG_S", %%"REG_d"), %%esi  \n\t" //src[xx+1]
-                FAST_BILINEAR_X86
-                "movw     %%si, (%%"REG_D", %%"REG_a", 2)   \n\t"
-
-                "movzbl    (%5, %%"REG_d"), %%edi       \n\t" //src[xx]
-                "movzbl   1(%5, %%"REG_d"), %%esi       \n\t" //src[xx+1]
-                FAST_BILINEAR_X86
-                "movw     %%si, "AV_STRINGIFY(VOF)"(%%"REG_D", %%"REG_a", 2)   \n\t"
-
-                "addw       %4, %%cx                    \n\t" //xalpha += xInc&0xFFFF
-                "adc        %3, %%"REG_d"               \n\t" //xx+= xInc>>16 + carry
-                "add        $1, %%"REG_a"               \n\t"
-                "cmp        %2, %%"REG_a"               \n\t"
-                " jb        1b                          \n\t"
-
-/* GCC 3.3 makes MPlayer crash on IA-32 machines when using "g" operand here,
-   which is needed to support GCC 4.0. */
-#if ARCH_X86_64 && ((__GNUC__ > 3) || (__GNUC__ == 3 && __GNUC_MINOR__ >= 4))
-                :: "m" (src1), "m" (dst), "g" (dstWidth), "m" (xInc_shr16), "m" (xInc_mask),
-#else
-                :: "m" (src1), "m" (dst), "m" (dstWidth), "m" (xInc_shr16), "m" (xInc_mask),
-#endif
-                "r" (src2)
-                : "%"REG_a, "%"REG_d, "%ecx", "%"REG_D, "%esi"
-            );
-#if COMPILE_TEMPLATE_MMX2
-        } //if MMX2 can't be used
-#endif
-#else
         c->hcscale_fast(c, dst, dstWidth, src1, src2, srcW, xInc);
-#endif /* ARCH_X86 */
     }
-    if(c->srcRange != c->dstRange && !(isRGB(c->dstFormat) || isBGR(c->dstFormat))) {
-        int i;
-        //FIXME all pal and rgb srcFormats could do this convertion as well
-        //FIXME all scalers more complex than bilinear could do half of this transform
-        if(c->srcRange) {
-            for (i=0; i<dstWidth; i++) {
-                dst[i     ]= (dst[i     ]*1799 + 4081085)>>11; //1469
-                dst[i+VOFW]= (dst[i+VOFW]*1799 + 4081085)>>11; //1469
-            }
-        } else {
-            for (i=0; i<dstWidth; i++) {
-                dst[i     ]= (FFMIN(dst[i     ],30775)*4663 - 9289992)>>12; //-264
-                dst[i+VOFW]= (FFMIN(dst[i+VOFW],30775)*4663 - 9289992)>>12; //-264
-            }
-        }
-    }
+
+    if (c->chrConvertRange)
+        c->chrConvertRange(dst, dstWidth);
 }
 
-static int RENAME(swScale)(SwsContext *c, uint8_t* src[], int srcStride[], int srcSliceY,
+#define DEBUG_SWSCALE_BUFFERS 0
+#define DEBUG_BUFFERS(...) if (DEBUG_SWSCALE_BUFFERS) av_log(c, AV_LOG_DEBUG, __VA_ARGS__)
+
+static int RENAME(swScale)(SwsContext *c, const uint8_t* src[], int srcStride[], int srcSliceY,
                            int srcSliceH, uint8_t* dst[], int dstStride[])
 {
     /* load a few things into local vars to make the code more readable? and faster */
@@ -2540,8 +2565,7 @@
     const int chrSrcW= c->chrSrcW;
     const int lumXInc= c->lumXInc;
     const int chrXInc= c->chrXInc;
-    const int dstFormat= c->dstFormat;
-    const int srcFormat= c->srcFormat;
+    const enum PixelFormat dstFormat= c->dstFormat;
     const int flags= c->flags;
     int16_t *vLumFilterPos= c->vLumFilterPos;
     int16_t *vChrFilterPos= c->vChrFilterPos;
@@ -2553,7 +2577,7 @@
     int16_t *hChrFilter= c->hChrFilter;
     int32_t *lumMmxFilter= c->lumMmxFilter;
     int32_t *chrMmxFilter= c->chrMmxFilter;
-    int32_t *alpMmxFilter= c->alpMmxFilter;
+    int32_t av_unused *alpMmxFilter= c->alpMmxFilter;
     const int vLumFilterSize= c->vLumFilterSize;
     const int vChrFilterSize= c->vChrFilterSize;
     const int hLumFilterSize= c->hLumFilterSize;
@@ -2589,12 +2613,14 @@
     srcStride[1]<<= c->vChrDrop;
     srcStride[2]<<= c->vChrDrop;
 
-    //printf("swscale %X %X %X -> %X %X %X\n", (int)src[0], (int)src[1], (int)src[2],
-    //       (int)dst[0], (int)dst[1], (int)dst[2]);
+    DEBUG_BUFFERS("swScale() %p[%d] %p[%d] %p[%d] %p[%d] -> %p[%d] %p[%d] %p[%d] %p[%d]\n",
+                  src[0], srcStride[0], src[1], srcStride[1], src[2], srcStride[2], src[3], srcStride[3],
+                  dst[0], dstStride[0], dst[1], dstStride[1], dst[2], dstStride[2], dst[3], dstStride[3]);
+    DEBUG_BUFFERS("srcSliceY: %d srcSliceH: %d dstY: %d dstH: %d\n",
+                   srcSliceY,    srcSliceH,    dstY,    dstH);
+    DEBUG_BUFFERS("vLumFilterSize: %d vLumBufSize: %d vChrFilterSize: %d vChrBufSize: %d\n",
+                   vLumFilterSize,    vLumBufSize,    vChrFilterSize,    vChrBufSize);
 
-    //printf("sws Strides:%d %d %d -> %d %d %d\n", srcStride[0],srcStride[1],srcStride[2],
-    //dstStride[0],dstStride[1],dstStride[2]);
-
     if (dstStride[0]%8 !=0 || dstStride[1]%8 !=0 || dstStride[2]%8 !=0 || dstStride[3]%8 != 0) {
         static int warnedAlready=0; //FIXME move this into the context perhaps
         if (flags & SWS_PRINT_INFO && !warnedAlready) {
@@ -2608,8 +2634,8 @@
        will not get executed. This is not really intended but works
        currently, so people might do it. */
     if (srcSliceY ==0) {
-        lumBufIndex=0;
-        chrBufIndex=0;
+        lumBufIndex=-1;
+        chrBufIndex=-1;
         dstY=0;
         lastInLumBuf= -1;
         lastInChrBuf= -1;
@@ -2630,63 +2656,65 @@
         int lastChrSrcY= firstChrSrcY + vChrFilterSize -1; // Last line needed as input
         int enough_lines;
 
-        //printf("dstY:%d dstH:%d firstLumSrcY:%d lastInLumBuf:%d vLumBufSize: %d vChrBufSize: %d slice: %d %d vLumFilterSize: %d firstChrSrcY: %d vChrFilterSize: %d c->chrSrcVSubSample: %d\n",
-        // dstY, dstH, firstLumSrcY, lastInLumBuf, vLumBufSize, vChrBufSize, srcSliceY, srcSliceH, vLumFilterSize, firstChrSrcY, vChrFilterSize,  c->chrSrcVSubSample);
         //handle holes (FAST_BILINEAR & weird filters)
         if (firstLumSrcY > lastInLumBuf) lastInLumBuf= firstLumSrcY-1;
         if (firstChrSrcY > lastInChrBuf) lastInChrBuf= firstChrSrcY-1;
-        //printf("%d %d %d\n", firstChrSrcY, lastInChrBuf, vChrBufSize);
         assert(firstLumSrcY >= lastInLumBuf - vLumBufSize + 1);
         assert(firstChrSrcY >= lastInChrBuf - vChrBufSize + 1);
 
+        DEBUG_BUFFERS("dstY: %d\n", dstY);
+        DEBUG_BUFFERS("\tfirstLumSrcY: %d lastLumSrcY: %d lastInLumBuf: %d\n",
+                         firstLumSrcY,    lastLumSrcY,    lastInLumBuf);
+        DEBUG_BUFFERS("\tfirstChrSrcY: %d lastChrSrcY: %d lastInChrBuf: %d\n",
+                         firstChrSrcY,    lastChrSrcY,    lastInChrBuf);
+
         // Do we have enough lines in this slice to output the dstY line
         enough_lines = lastLumSrcY < srcSliceY + srcSliceH && lastChrSrcY < -((-srcSliceY - srcSliceH)>>c->chrSrcVSubSample);
         if (!enough_lines) {
             lastLumSrcY = srcSliceY + srcSliceH - 1;
             lastChrSrcY = chrSrcSliceY + chrSrcSliceH - 1;
+            DEBUG_BUFFERS("buffering slice: lastLumSrcY %d lastChrSrcY %d\n",
+                                            lastLumSrcY, lastChrSrcY);
         }
 
-        /* printf("%d %d Last:%d %d LastInBuf:%d %d Index:%d %d Y:%d FSize: %d %d BSize: %d %d\n",
-        firstChrSrcY,firstLumSrcY,lastChrSrcY,lastLumSrcY,
-        lastInChrBuf,lastInLumBuf,chrBufIndex,lumBufIndex,dstY,vChrFilterSize,vLumFilterSize,
-        vChrBufSize, vLumBufSize);*/
-
         //Do horizontal scaling
         while(lastInLumBuf < lastLumSrcY) {
-            uint8_t *src1= src[0]+(lastInLumBuf + 1 - srcSliceY)*srcStride[0];
-            uint8_t *src2= src[3]+(lastInLumBuf + 1 - srcSliceY)*srcStride[3];
+            const uint8_t *src1= src[0]+(lastInLumBuf + 1 - srcSliceY)*srcStride[0];
+            const uint8_t *src2= src[3]+(lastInLumBuf + 1 - srcSliceY)*srcStride[3];
             lumBufIndex++;
-            //printf("%d %d %d %d\n", lumBufIndex, vLumBufSize, lastInLumBuf,  lastLumSrcY);
             assert(lumBufIndex < 2*vLumBufSize);
             assert(lastInLumBuf + 1 - srcSliceY < srcSliceH);
             assert(lastInLumBuf + 1 - srcSliceY >= 0);
-            //printf("%d %d\n", lumBufIndex, vLumBufSize);
             RENAME(hyscale)(c, lumPixBuf[ lumBufIndex ], dstW, src1, srcW, lumXInc,
-                            flags, hLumFilter, hLumFilterPos, hLumFilterSize,
-                            c->srcFormat, formatConvBuffer,
+                            hLumFilter, hLumFilterPos, hLumFilterSize,
+                            formatConvBuffer,
                             pal, 0);
             if (CONFIG_SWSCALE_ALPHA && alpPixBuf)
                 RENAME(hyscale)(c, alpPixBuf[ lumBufIndex ], dstW, src2, srcW, lumXInc,
-                                flags, hLumFilter, hLumFilterPos, hLumFilterSize,
-                                c->srcFormat, formatConvBuffer,
+                                hLumFilter, hLumFilterPos, hLumFilterSize,
+                                formatConvBuffer,
                                 pal, 1);
             lastInLumBuf++;
+            DEBUG_BUFFERS("\t\tlumBufIndex %d: lastInLumBuf: %d\n",
+                               lumBufIndex,    lastInLumBuf);
         }
         while(lastInChrBuf < lastChrSrcY) {
-            uint8_t *src1= src[1]+(lastInChrBuf + 1 - chrSrcSliceY)*srcStride[1];
-            uint8_t *src2= src[2]+(lastInChrBuf + 1 - chrSrcSliceY)*srcStride[2];
+            const uint8_t *src1= src[1]+(lastInChrBuf + 1 - chrSrcSliceY)*srcStride[1];
+            const uint8_t *src2= src[2]+(lastInChrBuf + 1 - chrSrcSliceY)*srcStride[2];
             chrBufIndex++;
             assert(chrBufIndex < 2*vChrBufSize);
             assert(lastInChrBuf + 1 - chrSrcSliceY < (chrSrcSliceH));
             assert(lastInChrBuf + 1 - chrSrcSliceY >= 0);
             //FIXME replace parameters through context struct (some at least)
 
-            if (!(isGray(srcFormat) || isGray(dstFormat)))
+            if (c->needs_hcscale)
                 RENAME(hcscale)(c, chrPixBuf[ chrBufIndex ], chrDstW, src1, src2, chrSrcW, chrXInc,
-                                flags, hChrFilter, hChrFilterPos, hChrFilterSize,
-                                c->srcFormat, formatConvBuffer,
+                                hChrFilter, hChrFilterPos, hChrFilterSize,
+                                formatConvBuffer,
                                 pal);
             lastInChrBuf++;
+            DEBUG_BUFFERS("\t\tchrBufIndex %d: lastInChrBuf: %d\n",
+                               chrBufIndex,    lastInChrBuf);
         }
         //wrap buf index around to stay inside the ring buffer
         if (lumBufIndex >= vLumBufSize) lumBufIndex-= vLumBufSize;
@@ -2711,21 +2739,21 @@
             if (flags & SWS_ACCURATE_RND) {
                 int s= APCK_SIZE / 8;
                 for (i=0; i<vLumFilterSize; i+=2) {
-                    *(void**)&lumMmxFilter[s*i              ]= lumSrcPtr[i  ];
-                    *(void**)&lumMmxFilter[s*i+APCK_PTR2/4  ]= lumSrcPtr[i+(vLumFilterSize>1)];
+                    *(const void**)&lumMmxFilter[s*i              ]= lumSrcPtr[i  ];
+                    *(const void**)&lumMmxFilter[s*i+APCK_PTR2/4  ]= lumSrcPtr[i+(vLumFilterSize>1)];
                               lumMmxFilter[s*i+APCK_COEF/4  ]=
                               lumMmxFilter[s*i+APCK_COEF/4+1]= vLumFilter[dstY*vLumFilterSize + i    ]
                         + (vLumFilterSize>1 ? vLumFilter[dstY*vLumFilterSize + i + 1]<<16 : 0);
                     if (CONFIG_SWSCALE_ALPHA && alpPixBuf) {
-                        *(void**)&alpMmxFilter[s*i              ]= alpSrcPtr[i  ];
-                        *(void**)&alpMmxFilter[s*i+APCK_PTR2/4  ]= alpSrcPtr[i+(vLumFilterSize>1)];
+                        *(const void**)&alpMmxFilter[s*i              ]= alpSrcPtr[i  ];
+                        *(const void**)&alpMmxFilter[s*i+APCK_PTR2/4  ]= alpSrcPtr[i+(vLumFilterSize>1)];
                                   alpMmxFilter[s*i+APCK_COEF/4  ]=
                                   alpMmxFilter[s*i+APCK_COEF/4+1]= lumMmxFilter[s*i+APCK_COEF/4  ];
                     }
                 }
                 for (i=0; i<vChrFilterSize; i+=2) {
-                    *(void**)&chrMmxFilter[s*i              ]= chrSrcPtr[i  ];
-                    *(void**)&chrMmxFilter[s*i+APCK_PTR2/4  ]= chrSrcPtr[i+(vChrFilterSize>1)];
+                    *(const void**)&chrMmxFilter[s*i              ]= chrSrcPtr[i  ];
+                    *(const void**)&chrMmxFilter[s*i+APCK_PTR2/4  ]= chrSrcPtr[i+(vChrFilterSize>1)];
                               chrMmxFilter[s*i+APCK_COEF/4  ]=
                               chrMmxFilter[s*i+APCK_COEF/4+1]= vChrFilter[chrDstY*vChrFilterSize + i    ]
                         + (vChrFilterSize>1 ? vChrFilter[chrDstY*vChrFilterSize + i + 1]<<16 : 0);
@@ -2770,9 +2798,9 @@
                                   alpSrcPtr, (uint16_t *) dest, (uint16_t *) uDest, (uint16_t *) vDest, (uint16_t *) aDest, dstW, chrDstW,
                                   dstFormat);
                 } else if (vLumFilterSize == 1 && vChrFilterSize == 1) { // unscaled YV12
-                    int16_t *lumBuf = lumPixBuf[0];
-                    int16_t *chrBuf= chrPixBuf[0];
-                    int16_t *alpBuf= (CONFIG_SWSCALE_ALPHA && alpPixBuf) ? alpPixBuf[0] : NULL;
+                    const int16_t *lumBuf = lumSrcPtr[0];
+                    const int16_t *chrBuf= chrSrcPtr[0];
+                    const int16_t *alpBuf= (CONFIG_SWSCALE_ALPHA && alpPixBuf) ? alpSrcPtr[0] : NULL;
                     c->yuv2yuv1(c, lumBuf, chrBuf, alpBuf, dest, uDest, vDest, aDest, dstW, chrDstW);
                 } else { //General YV12
                     c->yuv2yuvX(c,
@@ -2902,96 +2930,137 @@
 
     c->hScale       = RENAME(hScale      );
 
-    c->hyscale_fast = RENAME(hyscale_fast);
-    c->hcscale_fast = RENAME(hcscale_fast);
+#if COMPILE_TEMPLATE_MMX
+    // Use the new MMX scaler if the MMX2 one can't be used (it is faster than the x86 ASM one).
+    if (c->flags & SWS_FAST_BILINEAR && c->canMMX2BeUsed)
+#else
+    if (c->flags & SWS_FAST_BILINEAR)
+#endif
+    {
+        c->hyscale_fast = RENAME(hyscale_fast);
+        c->hcscale_fast = RENAME(hcscale_fast);
+    }
 
-    c->hcscale_internal = NULL;
+    c->chrToYV12 = NULL;
     switch(srcFormat) {
-        case PIX_FMT_YUYV422  : c->hcscale_internal = RENAME(yuy2ToUV); break;
-        case PIX_FMT_UYVY422  : c->hcscale_internal = RENAME(uyvyToUV); break;
+        case PIX_FMT_YUYV422  : c->chrToYV12 = RENAME(yuy2ToUV); break;
+        case PIX_FMT_UYVY422  : c->chrToYV12 = RENAME(uyvyToUV); break;
+        case PIX_FMT_NV12     : c->chrToYV12 = RENAME(nv12ToUV); break;
+        case PIX_FMT_NV21     : c->chrToYV12 = RENAME(nv21ToUV); break;
         case PIX_FMT_RGB8     :
         case PIX_FMT_BGR8     :
         case PIX_FMT_PAL8     :
         case PIX_FMT_BGR4_BYTE:
-        case PIX_FMT_RGB4_BYTE: c->hcscale_internal = palToUV; break;
-        case PIX_FMT_YUV420PBE:
-        case PIX_FMT_YUV422PBE:
-        case PIX_FMT_YUV444PBE: c->hcscale_internal = RENAME(BEToUV); break;
-        case PIX_FMT_YUV420PLE:
-        case PIX_FMT_YUV422PLE:
-        case PIX_FMT_YUV444PLE: c->hcscale_internal = RENAME(LEToUV); break;
+        case PIX_FMT_RGB4_BYTE: c->chrToYV12 = palToUV; break;
+        case PIX_FMT_YUV420P16BE:
+        case PIX_FMT_YUV422P16BE:
+        case PIX_FMT_YUV444P16BE: c->chrToYV12 = RENAME(BEToUV); break;
+        case PIX_FMT_YUV420P16LE:
+        case PIX_FMT_YUV422P16LE:
+        case PIX_FMT_YUV444P16LE: c->chrToYV12 = RENAME(LEToUV); break;
     }
     if (c->chrSrcHSubSample) {
         switch(srcFormat) {
         case PIX_FMT_RGB48BE:
-        case PIX_FMT_RGB48LE: c->hcscale_internal = rgb48ToUV_half; break;
+        case PIX_FMT_RGB48LE: c->chrToYV12 = rgb48ToUV_half; break;
         case PIX_FMT_RGB32  :
-        case PIX_FMT_RGB32_1: c->hcscale_internal = bgr32ToUV_half; break;
-        case PIX_FMT_BGR24  : c->hcscale_internal = RENAME(bgr24ToUV_half); break;
-        case PIX_FMT_BGR565 : c->hcscale_internal = bgr16ToUV_half; break;
-        case PIX_FMT_BGR555 : c->hcscale_internal = bgr15ToUV_half; break;
+        case PIX_FMT_RGB32_1: c->chrToYV12 = bgr32ToUV_half; break;
+        case PIX_FMT_BGR24  : c->chrToYV12 = RENAME(bgr24ToUV_half); break;
+        case PIX_FMT_BGR565 : c->chrToYV12 = bgr16ToUV_half; break;
+        case PIX_FMT_BGR555 : c->chrToYV12 = bgr15ToUV_half; break;
         case PIX_FMT_BGR32  :
-        case PIX_FMT_BGR32_1: c->hcscale_internal = rgb32ToUV_half; break;
-        case PIX_FMT_RGB24  : c->hcscale_internal = RENAME(rgb24ToUV_half); break;
-        case PIX_FMT_RGB565 : c->hcscale_internal = rgb16ToUV_half; break;
-        case PIX_FMT_RGB555 : c->hcscale_internal = rgb15ToUV_half; break;
+        case PIX_FMT_BGR32_1: c->chrToYV12 = rgb32ToUV_half; break;
+        case PIX_FMT_RGB24  : c->chrToYV12 = RENAME(rgb24ToUV_half); break;
+        case PIX_FMT_RGB565 : c->chrToYV12 = rgb16ToUV_half; break;
+        case PIX_FMT_RGB555 : c->chrToYV12 = rgb15ToUV_half; break;
         }
     } else {
         switch(srcFormat) {
         case PIX_FMT_RGB48BE:
-        case PIX_FMT_RGB48LE: c->hcscale_internal = rgb48ToUV; break;
+        case PIX_FMT_RGB48LE: c->chrToYV12 = rgb48ToUV; break;
         case PIX_FMT_RGB32  :
-        case PIX_FMT_RGB32_1: c->hcscale_internal = bgr32ToUV; break;
-        case PIX_FMT_BGR24  : c->hcscale_internal = RENAME(bgr24ToUV); break;
-        case PIX_FMT_BGR565 : c->hcscale_internal = bgr16ToUV; break;
-        case PIX_FMT_BGR555 : c->hcscale_internal = bgr15ToUV; break;
+        case PIX_FMT_RGB32_1: c->chrToYV12 = bgr32ToUV; break;
+        case PIX_FMT_BGR24  : c->chrToYV12 = RENAME(bgr24ToUV); break;
+        case PIX_FMT_BGR565 : c->chrToYV12 = bgr16ToUV; break;
+        case PIX_FMT_BGR555 : c->chrToYV12 = bgr15ToUV; break;
         case PIX_FMT_BGR32  :
-        case PIX_FMT_BGR32_1: c->hcscale_internal = rgb32ToUV; break;
-        case PIX_FMT_RGB24  : c->hcscale_internal = RENAME(rgb24ToUV); break;
-        case PIX_FMT_RGB565 : c->hcscale_internal = rgb16ToUV; break;
-        case PIX_FMT_RGB555 : c->hcscale_internal = rgb15ToUV; break;
+        case PIX_FMT_BGR32_1: c->chrToYV12 = rgb32ToUV; break;
+        case PIX_FMT_RGB24  : c->chrToYV12 = RENAME(rgb24ToUV); break;
+        case PIX_FMT_RGB565 : c->chrToYV12 = rgb16ToUV; break;
+        case PIX_FMT_RGB555 : c->chrToYV12 = rgb15ToUV; break;
         }
     }
 
-    c->hyscale_internal = NULL;
-    c->hascale_internal = NULL;
+    c->lumToYV12 = NULL;
+    c->alpToYV12 = NULL;
     switch (srcFormat) {
     case PIX_FMT_YUYV422  :
-    case PIX_FMT_YUV420PBE:
-    case PIX_FMT_YUV422PBE:
-    case PIX_FMT_YUV444PBE:
-    case PIX_FMT_GRAY16BE : c->hyscale_internal = RENAME(yuy2ToY); break;
+    case PIX_FMT_YUV420P16BE:
+    case PIX_FMT_YUV422P16BE:
+    case PIX_FMT_YUV444P16BE:
+    case PIX_FMT_GRAY16BE : c->lumToYV12 = RENAME(yuy2ToY); break;
     case PIX_FMT_UYVY422  :
-    case PIX_FMT_YUV420PLE:
-    case PIX_FMT_YUV422PLE:
-    case PIX_FMT_YUV444PLE:
-    case PIX_FMT_GRAY16LE : c->hyscale_internal = RENAME(uyvyToY); break;
-    case PIX_FMT_BGR24    : c->hyscale_internal = RENAME(bgr24ToY); break;
-    case PIX_FMT_BGR565   : c->hyscale_internal = bgr16ToY; break;
-    case PIX_FMT_BGR555   : c->hyscale_internal = bgr15ToY; break;
-    case PIX_FMT_RGB24    : c->hyscale_internal = RENAME(rgb24ToY); break;
-    case PIX_FMT_RGB565   : c->hyscale_internal = rgb16ToY; break;
-    case PIX_FMT_RGB555   : c->hyscale_internal = rgb15ToY; break;
+    case PIX_FMT_YUV420P16LE:
+    case PIX_FMT_YUV422P16LE:
+    case PIX_FMT_YUV444P16LE:
+    case PIX_FMT_GRAY16LE : c->lumToYV12 = RENAME(uyvyToY); break;
+    case PIX_FMT_BGR24    : c->lumToYV12 = RENAME(bgr24ToY); break;
+    case PIX_FMT_BGR565   : c->lumToYV12 = bgr16ToY; break;
+    case PIX_FMT_BGR555   : c->lumToYV12 = bgr15ToY; break;
+    case PIX_FMT_RGB24    : c->lumToYV12 = RENAME(rgb24ToY); break;
+    case PIX_FMT_RGB565   : c->lumToYV12 = rgb16ToY; break;
+    case PIX_FMT_RGB555   : c->lumToYV12 = rgb15ToY; break;
     case PIX_FMT_RGB8     :
     case PIX_FMT_BGR8     :
     case PIX_FMT_PAL8     :
     case PIX_FMT_BGR4_BYTE:
-    case PIX_FMT_RGB4_BYTE: c->hyscale_internal = palToY; break;
-    case PIX_FMT_MONOBLACK: c->hyscale_internal = monoblack2Y; break;
-    case PIX_FMT_MONOWHITE: c->hyscale_internal = monowhite2Y; break;
+    case PIX_FMT_RGB4_BYTE: c->lumToYV12 = palToY; break;
+    case PIX_FMT_MONOBLACK: c->lumToYV12 = monoblack2Y; break;
+    case PIX_FMT_MONOWHITE: c->lumToYV12 = monowhite2Y; break;
     case PIX_FMT_RGB32  :
-    case PIX_FMT_RGB32_1: c->hyscale_internal = bgr32ToY; break;
+    case PIX_FMT_RGB32_1: c->lumToYV12 = bgr32ToY; break;
     case PIX_FMT_BGR32  :
-    case PIX_FMT_BGR32_1: c->hyscale_internal = rgb32ToY; break;
+    case PIX_FMT_BGR32_1: c->lumToYV12 = rgb32ToY; break;
     case PIX_FMT_RGB48BE:
-    case PIX_FMT_RGB48LE: c->hyscale_internal = rgb48ToY; break;
+    case PIX_FMT_RGB48LE: c->lumToYV12 = rgb48ToY; break;
     }
     if (c->alpPixBuf) {
         switch (srcFormat) {
         case PIX_FMT_RGB32  :
         case PIX_FMT_RGB32_1:
         case PIX_FMT_BGR32  :
-        case PIX_FMT_BGR32_1: c->hascale_internal = abgrToA; break;
+        case PIX_FMT_BGR32_1: c->alpToYV12 = abgrToA; break;
         }
     }
+
+    switch (srcFormat) {
+    case PIX_FMT_RGB32  :
+    case PIX_FMT_BGR32  :
+        c->alpSrcOffset = 3;
+        break;
+    case PIX_FMT_RGB32_1:
+    case PIX_FMT_BGR32_1:
+        c->lumSrcOffset = ALT32_CORR;
+        c->chrSrcOffset = ALT32_CORR;
+        break;
+    case PIX_FMT_RGB48LE:
+        c->lumSrcOffset = 1;
+        c->chrSrcOffset = 1;
+        c->alpSrcOffset = 1;
+        break;
+    }
+
+    if (c->srcRange != c->dstRange && !isAnyRGB(c->dstFormat)) {
+        if (c->srcRange) {
+            c->lumConvertRange = RENAME(lumRangeFromJpeg);
+            c->chrConvertRange = RENAME(chrRangeFromJpeg);
+        } else {
+            c->lumConvertRange = RENAME(lumRangeToJpeg);
+            c->chrConvertRange = RENAME(chrRangeToJpeg);
+        }
+    }
+
+    if (!(isGray(srcFormat) || isGray(c->dstFormat) ||
+          srcFormat == PIX_FMT_MONOBLACK || srcFormat == PIX_FMT_MONOWHITE))
+        c->needs_hcscale = 1;
 }

Added: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libswscale/utils.c
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libswscale/utils.c	2010-05-26 05:26:42 UTC (rev 6237)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libswscale/utils.c	2010-05-26 05:26:46 UTC (rev 6238)
@@ -0,0 +1,1590 @@
+/*
+ * Copyright (C) 2001-2003 Michael Niedermayer <michaelni at gmx.at>
+ *
+ * This file is part of FFmpeg.
+ *
+ * FFmpeg is free software; you can redistribute it and/or modify
+ * it under the terms of the GNU General Public License as published by
+ * the Free Software Foundation; either version 2 of the License, or
+ * (at your option) any later version.
+ *
+ * FFmpeg is distributed in the hope that it will be useful,
+ * but WITHOUT ANY WARRANTY; without even the implied warranty of
+ * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+ * GNU General Public License for more details.
+ *
+ * You should have received a copy of the GNU General Public License
+ * along with FFmpeg; if not, write to the Free Software
+ * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA
+ *
+ * the C code (not assembly, mmx, ...) of this file can be used
+ * under the LGPL license too
+ */
+
+#define _SVID_SOURCE //needed for MAP_ANONYMOUS
+#include <inttypes.h>
+#include <string.h>
+#include <math.h>
+#include <stdio.h>
+#include "config.h"
+#include <assert.h>
+#if HAVE_SYS_MMAN_H
+#include <sys/mman.h>
+#if defined(MAP_ANON) && !defined(MAP_ANONYMOUS)
+#define MAP_ANONYMOUS MAP_ANON
+#endif
+#endif
+#if HAVE_VIRTUALALLOC
+#define WIN32_LEAN_AND_MEAN
+#include <windows.h>
+#endif
+#include "swscale.h"
+#include "swscale_internal.h"
+#include "rgb2rgb.h"
+#include "libavutil/intreadwrite.h"
+#include "libavutil/x86_cpu.h"
+#include "libavutil/avutil.h"
+#include "libavutil/bswap.h"
+#include "libavutil/pixdesc.h"
+
+unsigned swscale_version(void)
+{
+    return LIBSWSCALE_VERSION_INT;
+}
+
+const char *swscale_configuration(void)
+{
+    return "avidemux";//FFMPEG_CONFIGURATION;
+}
+
+const char *swscale_license(void)
+{
+#define LICENSE_PREFIX "libswscale license: "
+    return LICENSE_PREFIX "GPL"; //FFMPEG_LICENSE + sizeof(LICENSE_PREFIX) - 1;
+}
+
+#define RET 0xC3 //near return opcode for x86
+
+#define isSupportedIn(x)    (       \
+           (x)==PIX_FMT_YUV420P     \
+        || (x)==PIX_FMT_YUVA420P    \
+        || (x)==PIX_FMT_YUYV422     \
+        || (x)==PIX_FMT_UYVY422     \
+        || (x)==PIX_FMT_RGB48BE     \
+        || (x)==PIX_FMT_RGB48LE     \
+        || (x)==PIX_FMT_RGB32       \
+        || (x)==PIX_FMT_RGB32_1     \
+        || (x)==PIX_FMT_BGR24       \
+        || (x)==PIX_FMT_BGR565      \
+        || (x)==PIX_FMT_BGR555      \
+        || (x)==PIX_FMT_BGR32       \
+        || (x)==PIX_FMT_BGR32_1     \
+        || (x)==PIX_FMT_RGB24       \
+        || (x)==PIX_FMT_RGB565      \
+        || (x)==PIX_FMT_RGB555      \
+        || (x)==PIX_FMT_GRAY8       \
+        || (x)==PIX_FMT_YUV410P     \
+        || (x)==PIX_FMT_YUV440P     \
+        || (x)==PIX_FMT_NV12        \
+        || (x)==PIX_FMT_NV21        \
+        || (x)==PIX_FMT_GRAY16BE    \
+        || (x)==PIX_FMT_GRAY16LE    \
+        || (x)==PIX_FMT_YUV444P     \
+        || (x)==PIX_FMT_YUV422P     \
+        || (x)==PIX_FMT_YUV411P     \
+        || (x)==PIX_FMT_YUVJ420P    \
+        || (x)==PIX_FMT_YUVJ422P    \
+        || (x)==PIX_FMT_YUVJ440P    \
+        || (x)==PIX_FMT_YUVJ444P    \
+        || (x)==PIX_FMT_PAL8        \
+        || (x)==PIX_FMT_BGR8        \
+        || (x)==PIX_FMT_RGB8        \
+        || (x)==PIX_FMT_BGR4_BYTE   \
+        || (x)==PIX_FMT_RGB4_BYTE   \
+        || (x)==PIX_FMT_YUV440P     \
+        || (x)==PIX_FMT_MONOWHITE   \
+        || (x)==PIX_FMT_MONOBLACK   \
+        || (x)==PIX_FMT_YUV420P16LE   \
+        || (x)==PIX_FMT_YUV422P16LE   \
+        || (x)==PIX_FMT_YUV444P16LE   \
+        || (x)==PIX_FMT_YUV420P16BE   \
+        || (x)==PIX_FMT_YUV422P16BE   \
+        || (x)==PIX_FMT_YUV444P16BE   \
+    )
+
+int sws_isSupportedInput(enum PixelFormat pix_fmt)
+{
+    return isSupportedIn(pix_fmt);
+}
+
+#define isSupportedOut(x)   (       \
+           (x)==PIX_FMT_YUV420P     \
+        || (x)==PIX_FMT_YUVA420P    \
+        || (x)==PIX_FMT_YUYV422     \
+        || (x)==PIX_FMT_UYVY422     \
+        || (x)==PIX_FMT_YUV444P     \
+        || (x)==PIX_FMT_YUV422P     \
+        || (x)==PIX_FMT_YUV411P     \
+        || (x)==PIX_FMT_YUVJ420P    \
+        || (x)==PIX_FMT_YUVJ422P    \
+        || (x)==PIX_FMT_YUVJ440P    \
+        || (x)==PIX_FMT_YUVJ444P    \
+        || isAnyRGB(x)              \
+        || (x)==PIX_FMT_NV12        \
+        || (x)==PIX_FMT_NV21        \
+        || (x)==PIX_FMT_GRAY16BE    \
+        || (x)==PIX_FMT_GRAY16LE    \
+        || (x)==PIX_FMT_GRAY8       \
+        || (x)==PIX_FMT_YUV410P     \
+        || (x)==PIX_FMT_YUV440P     \
+        || (x)==PIX_FMT_YUV420P16LE   \
+        || (x)==PIX_FMT_YUV422P16LE   \
+        || (x)==PIX_FMT_YUV444P16LE   \
+        || (x)==PIX_FMT_YUV420P16BE   \
+        || (x)==PIX_FMT_YUV422P16BE   \
+        || (x)==PIX_FMT_YUV444P16BE   \
+    )
+
+int sws_isSupportedOutput(enum PixelFormat pix_fmt)
+{
+    return isSupportedOut(pix_fmt);
+}
+
+#define usePal(x) (av_pix_fmt_descriptors[x].flags & PIX_FMT_PAL)
+
+extern const int32_t ff_yuv2rgb_coeffs[8][4];
+
+const char *sws_format_name(enum PixelFormat format)
+{
+    if ((unsigned)format < PIX_FMT_NB && av_pix_fmt_descriptors[format].name)
+        return av_pix_fmt_descriptors[format].name;
+    else
+        return "Unknown format";
+}
+
+static double getSplineCoeff(double a, double b, double c, double d, double dist)
+{
+//    printf("%f %f %f %f %f\n", a,b,c,d,dist);
+    if (dist<=1.0) return ((d*dist + c)*dist + b)*dist +a;
+    else           return getSplineCoeff(        0.0,
+                                          b+ 2.0*c + 3.0*d,
+                                                 c + 3.0*d,
+                                         -b- 3.0*c - 6.0*d,
+                                         dist-1.0);
+}
+
+static int initFilter(int16_t **outFilter, int16_t **filterPos, int *outFilterSize, int xInc,
+                      int srcW, int dstW, int filterAlign, int one, int flags,
+                      SwsVector *srcFilter, SwsVector *dstFilter, double param[2])
+{
+    int i;
+    int filterSize;
+    int filter2Size;
+    int minFilterSize;
+    int64_t *filter=NULL;
+    int64_t *filter2=NULL;
+    const int64_t fone= 1LL<<54;
+    int ret= -1;
+#if ARCH_X86
+    if (flags & SWS_CPU_CAPS_MMX)
+        __asm__ volatile("emms\n\t"::: "memory"); //FIXME this should not be required but it IS (even for non-MMX versions)
+#endif
+
+    // NOTE: the +1 is for the MMX scaler which reads over the end
+    FF_ALLOC_OR_GOTO(NULL, *filterPos, (dstW+1)*sizeof(int16_t), fail);
+
+    if (FFABS(xInc - 0x10000) <10) { // unscaled
+        int i;
+        filterSize= 1;
+        FF_ALLOCZ_OR_GOTO(NULL, filter, dstW*sizeof(*filter)*filterSize, fail);
+
+        for (i=0; i<dstW; i++) {
+            filter[i*filterSize]= fone;
+            (*filterPos)[i]=i;
+        }
+
+    } else if (flags&SWS_POINT) { // lame looking point sampling mode
+        int i;
+        int xDstInSrc;
+        filterSize= 1;
+        FF_ALLOC_OR_GOTO(NULL, filter, dstW*sizeof(*filter)*filterSize, fail);
+
+        xDstInSrc= xInc/2 - 0x8000;
+        for (i=0; i<dstW; i++) {
+            int xx= (xDstInSrc - ((filterSize-1)<<15) + (1<<15))>>16;
+
+            (*filterPos)[i]= xx;
+            filter[i]= fone;
+            xDstInSrc+= xInc;
+        }
+    } else if ((xInc <= (1<<16) && (flags&SWS_AREA)) || (flags&SWS_FAST_BILINEAR)) { // bilinear upscale
+        int i;
+        int xDstInSrc;
+        filterSize= 2;
+        FF_ALLOC_OR_GOTO(NULL, filter, dstW*sizeof(*filter)*filterSize, fail);
+
+        xDstInSrc= xInc/2 - 0x8000;
+        for (i=0; i<dstW; i++) {
+            int xx= (xDstInSrc - ((filterSize-1)<<15) + (1<<15))>>16;
+            int j;
+
+            (*filterPos)[i]= xx;
+            //bilinear upscale / linear interpolate / area averaging
+            for (j=0; j<filterSize; j++) {
+                int64_t coeff= fone - FFABS((xx<<16) - xDstInSrc)*(fone>>16);
+                if (coeff<0) coeff=0;
+                filter[i*filterSize + j]= coeff;
+                xx++;
+            }
+            xDstInSrc+= xInc;
+        }
+    } else {
+        int xDstInSrc;
+        int sizeFactor;
+
+        if      (flags&SWS_BICUBIC)      sizeFactor=  4;
+        else if (flags&SWS_X)            sizeFactor=  8;
+        else if (flags&SWS_AREA)         sizeFactor=  1; //downscale only, for upscale it is bilinear
+        else if (flags&SWS_GAUSS)        sizeFactor=  8;   // infinite ;)
+        else if (flags&SWS_LANCZOS)      sizeFactor= param[0] != SWS_PARAM_DEFAULT ? ceil(2*param[0]) : 6;
+        else if (flags&SWS_SINC)         sizeFactor= 20; // infinite ;)
+        else if (flags&SWS_SPLINE)       sizeFactor= 20;  // infinite ;)
+        else if (flags&SWS_BILINEAR)     sizeFactor=  2;
+        else {
+            sizeFactor= 0; //GCC warning killer
+            assert(0);
+        }
+
+        if (xInc <= 1<<16)      filterSize= 1 + sizeFactor; // upscale
+        else                    filterSize= 1 + (sizeFactor*srcW + dstW - 1)/ dstW;
+
+        if (filterSize > srcW-2) filterSize=srcW-2;
+
+        FF_ALLOC_OR_GOTO(NULL, filter, dstW*sizeof(*filter)*filterSize, fail);
+
+        xDstInSrc= xInc - 0x10000;
+        for (i=0; i<dstW; i++) {
+            int xx= (xDstInSrc - ((filterSize-2)<<16)) / (1<<17);
+            int j;
+            (*filterPos)[i]= xx;
+            for (j=0; j<filterSize; j++) {
+                int64_t d= ((int64_t)FFABS((xx<<17) - xDstInSrc))<<13;
+                double floatd;
+                int64_t coeff;
+
+                if (xInc > 1<<16)
+                    d= d*dstW/srcW;
+                floatd= d * (1.0/(1<<30));
+
+                if (flags & SWS_BICUBIC) {
+                    int64_t B= (param[0] != SWS_PARAM_DEFAULT ? param[0] :   0) * (1<<24);
+                    int64_t C= (param[1] != SWS_PARAM_DEFAULT ? param[1] : 0.6) * (1<<24);
+                    int64_t dd = ( d*d)>>30;
+                    int64_t ddd= (dd*d)>>30;
+
+                    if      (d < 1LL<<30)
+                        coeff = (12*(1<<24)-9*B-6*C)*ddd + (-18*(1<<24)+12*B+6*C)*dd + (6*(1<<24)-2*B)*(1<<30);
+                    else if (d < 1LL<<31)
+                        coeff = (-B-6*C)*ddd + (6*B+30*C)*dd + (-12*B-48*C)*d + (8*B+24*C)*(1<<30);
+                    else
+                        coeff=0.0;
+                    coeff *= fone>>(30+24);
+                }
+/*                else if (flags & SWS_X) {
+                    double p= param ? param*0.01 : 0.3;
+                    coeff = d ? sin(d*PI)/(d*PI) : 1.0;
+                    coeff*= pow(2.0, - p*d*d);
+                }*/
+                else if (flags & SWS_X) {
+                    double A= param[0] != SWS_PARAM_DEFAULT ? param[0] : 1.0;
+                    double c;
+
+                    if (floatd<1.0)
+                        c = cos(floatd*M_PI);
+                    else
+                        c=-1.0;
+                    if (c<0.0)      c= -pow(-c, A);
+                    else            c=  pow( c, A);
+                    coeff= (c*0.5 + 0.5)*fone;
+                } else if (flags & SWS_AREA) {
+                    int64_t d2= d - (1<<29);
+                    if      (d2*xInc < -(1LL<<(29+16))) coeff= 1.0 * (1LL<<(30+16));
+                    else if (d2*xInc <  (1LL<<(29+16))) coeff= -d2*xInc + (1LL<<(29+16));
+                    else coeff=0.0;
+                    coeff *= fone>>(30+16);
+                } else if (flags & SWS_GAUSS) {
+                    double p= param[0] != SWS_PARAM_DEFAULT ? param[0] : 3.0;
+                    coeff = (pow(2.0, - p*floatd*floatd))*fone;
+                } else if (flags & SWS_SINC) {
+                    coeff = (d ? sin(floatd*M_PI)/(floatd*M_PI) : 1.0)*fone;
+                } else if (flags & SWS_LANCZOS) {
+                    double p= param[0] != SWS_PARAM_DEFAULT ? param[0] : 3.0;
+                    coeff = (d ? sin(floatd*M_PI)*sin(floatd*M_PI/p)/(floatd*floatd*M_PI*M_PI/p) : 1.0)*fone;
+                    if (floatd>p) coeff=0;
+                } else if (flags & SWS_BILINEAR) {
+                    coeff= (1<<30) - d;
+                    if (coeff<0) coeff=0;
+                    coeff *= fone >> 30;
+                } else if (flags & SWS_SPLINE) {
+                    double p=-2.196152422706632;
+                    coeff = getSplineCoeff(1.0, 0.0, p, -p-1.0, floatd) * fone;
+                } else {
+                    coeff= 0.0; //GCC warning killer
+                    assert(0);
+                }
+
+                filter[i*filterSize + j]= coeff;
+                xx++;
+            }
+            xDstInSrc+= 2*xInc;
+        }
+    }
+
+    /* apply src & dst Filter to filter -> filter2
+       av_free(filter);
+    */
+    assert(filterSize>0);
+    filter2Size= filterSize;
+    if (srcFilter) filter2Size+= srcFilter->length - 1;
+    if (dstFilter) filter2Size+= dstFilter->length - 1;
+    assert(filter2Size>0);
+    FF_ALLOCZ_OR_GOTO(NULL, filter2, filter2Size*dstW*sizeof(*filter2), fail);
+
+    for (i=0; i<dstW; i++) {
+        int j, k;
+
+        if(srcFilter) {
+            for (k=0; k<srcFilter->length; k++) {
+                for (j=0; j<filterSize; j++)
+                    filter2[i*filter2Size + k + j] += srcFilter->coeff[k]*filter[i*filterSize + j];
+            }
+        } else {
+            for (j=0; j<filterSize; j++)
+                filter2[i*filter2Size + j]= filter[i*filterSize + j];
+        }
+        //FIXME dstFilter
+
+        (*filterPos)[i]+= (filterSize-1)/2 - (filter2Size-1)/2;
+    }
+    av_freep(&filter);
+
+    /* try to reduce the filter-size (step1 find size and shift left) */
+    // Assume it is near normalized (*0.5 or *2.0 is OK but * 0.001 is not).
+    minFilterSize= 0;
+    for (i=dstW-1; i>=0; i--) {
+        int min= filter2Size;
+        int j;
+        int64_t cutOff=0.0;
+
+        /* get rid of near zero elements on the left by shifting left */
+        for (j=0; j<filter2Size; j++) {
+            int k;
+            cutOff += FFABS(filter2[i*filter2Size]);
+
+            if (cutOff > SWS_MAX_REDUCE_CUTOFF*fone) break;
+
+            /* preserve monotonicity because the core can't handle the filter otherwise */
+            if (i<dstW-1 && (*filterPos)[i] >= (*filterPos)[i+1]) break;
+
+            // move filter coefficients left
+            for (k=1; k<filter2Size; k++)
+                filter2[i*filter2Size + k - 1]= filter2[i*filter2Size + k];
+            filter2[i*filter2Size + k - 1]= 0;
+            (*filterPos)[i]++;
+        }
+
+        cutOff=0;
+        /* count near zeros on the right */
+        for (j=filter2Size-1; j>0; j--) {
+            cutOff += FFABS(filter2[i*filter2Size + j]);
+
+            if (cutOff > SWS_MAX_REDUCE_CUTOFF*fone) break;
+            min--;
+        }
+
+        if (min>minFilterSize) minFilterSize= min;
+    }
+
+    if (flags & SWS_CPU_CAPS_ALTIVEC) {
+        // we can handle the special case 4,
+        // so we don't want to go to the full 8
+        if (minFilterSize < 5)
+            filterAlign = 4;
+
+        // We really don't want to waste our time
+        // doing useless computation, so fall back on
+        // the scalar C code for very small filters.
+        // Vectorizing is worth it only if you have a
+        // decent-sized vector.
+        if (minFilterSize < 3)
+            filterAlign = 1;
+    }
+
+    if (flags & SWS_CPU_CAPS_MMX) {
+        // special case for unscaled vertical filtering
+        if (minFilterSize == 1 && filterAlign == 2)
+            filterAlign= 1;
+    }
+
+    assert(minFilterSize > 0);
+    filterSize= (minFilterSize +(filterAlign-1)) & (~(filterAlign-1));
+    assert(filterSize > 0);
+    filter= av_malloc(filterSize*dstW*sizeof(*filter));
+    if (filterSize >= MAX_FILTER_SIZE*16/((flags&SWS_ACCURATE_RND) ? APCK_SIZE : 16) || !filter)
+        goto fail;
+    *outFilterSize= filterSize;
+
+    if (flags&SWS_PRINT_INFO)
+        av_log(NULL, AV_LOG_VERBOSE, "SwScaler: reducing / aligning filtersize %d -> %d\n", filter2Size, filterSize);
+    /* try to reduce the filter-size (step2 reduce it) */
+    for (i=0; i<dstW; i++) {
+        int j;
+
+        for (j=0; j<filterSize; j++) {
+            if (j>=filter2Size) filter[i*filterSize + j]= 0;
+            else               filter[i*filterSize + j]= filter2[i*filter2Size + j];
+            if((flags & SWS_BITEXACT) && j>=minFilterSize)
+                filter[i*filterSize + j]= 0;
+        }
+    }
+
+    //FIXME try to align filterPos if possible
+
+    //fix borders
+    for (i=0; i<dstW; i++) {
+        int j;
+        if ((*filterPos)[i] < 0) {
+            // move filter coefficients left to compensate for filterPos
+            for (j=1; j<filterSize; j++) {
+                int left= FFMAX(j + (*filterPos)[i], 0);
+                filter[i*filterSize + left] += filter[i*filterSize + j];
+                filter[i*filterSize + j]=0;
+            }
+            (*filterPos)[i]= 0;
+        }
+
+        if ((*filterPos)[i] + filterSize > srcW) {
+            int shift= (*filterPos)[i] + filterSize - srcW;
+            // move filter coefficients right to compensate for filterPos
+            for (j=filterSize-2; j>=0; j--) {
+                int right= FFMIN(j + shift, filterSize-1);
+                filter[i*filterSize +right] += filter[i*filterSize +j];
+                filter[i*filterSize +j]=0;
+            }
+            (*filterPos)[i]= srcW - filterSize;
+        }
+    }
+
+    // Note the +1 is for the MMX scaler which reads over the end
+    /* align at 16 for AltiVec (needed by hScale_altivec_real) */
+    FF_ALLOCZ_OR_GOTO(NULL, *outFilter, *outFilterSize*(dstW+1)*sizeof(int16_t), fail);
+
+    /* normalize & store in outFilter */
+    for (i=0; i<dstW; i++) {
+        int j;
+        int64_t error=0;
+        int64_t sum=0;
+
+        for (j=0; j<filterSize; j++) {
+            sum+= filter[i*filterSize + j];
+        }
+        sum= (sum + one/2)/ one;
+        for (j=0; j<*outFilterSize; j++) {
+            int64_t v= filter[i*filterSize + j] + error;
+            int intV= ROUNDED_DIV(v, sum);
+            (*outFilter)[i*(*outFilterSize) + j]= intV;
+            error= v - intV*sum;
+        }
+    }
+
+    (*filterPos)[dstW]= (*filterPos)[dstW-1]; // the MMX scaler will read over the end
+    for (i=0; i<*outFilterSize; i++) {
+        int j= dstW*(*outFilterSize);
+        (*outFilter)[j + i]= (*outFilter)[j + i - (*outFilterSize)];
+    }
+
+    ret=0;
+fail:
+    av_free(filter);
+    av_free(filter2);
+    return ret;
+}
+
+#if ARCH_X86 && (HAVE_MMX2 || CONFIG_RUNTIME_CPUDETECT) && CONFIG_GPL
+static int initMMX2HScaler(int dstW, int xInc, uint8_t *filterCode, int16_t *filter, int32_t *filterPos, int numSplits)
+{
+    uint8_t *fragmentA;
+    x86_reg imm8OfPShufW1A;
+    x86_reg imm8OfPShufW2A;
+    x86_reg fragmentLengthA;
+    uint8_t *fragmentB;
+    x86_reg imm8OfPShufW1B;
+    x86_reg imm8OfPShufW2B;
+    x86_reg fragmentLengthB;
+    int fragmentPos;
+
+    int xpos, i;
+
+    // create an optimized horizontal scaling routine
+    /* This scaler is made of runtime-generated MMX2 code using specially
+     * tuned pshufw instructions. For every four output pixels, if four
+     * input pixels are enough for the fast bilinear scaling, then a chunk
+     * of fragmentB is used. If five input pixels are needed, then a chunk
+     * of fragmentA is used.
+     */
+
+    //code fragment
+
+    __asm__ volatile(
+        "jmp                         9f                 \n\t"
+    // Begin
+        "0:                                             \n\t"
+        "movq    (%%"REG_d", %%"REG_a"), %%mm3          \n\t"
+        "movd    (%%"REG_c", %%"REG_S"), %%mm0          \n\t"
+        "movd   1(%%"REG_c", %%"REG_S"), %%mm1          \n\t"
+        "punpcklbw                %%mm7, %%mm1          \n\t"
+        "punpcklbw                %%mm7, %%mm0          \n\t"
+        "pshufw                   $0xFF, %%mm1, %%mm1   \n\t"
+        "1:                                             \n\t"
+        "pshufw                   $0xFF, %%mm0, %%mm0   \n\t"
+        "2:                                             \n\t"
+        "psubw                    %%mm1, %%mm0          \n\t"
+        "movl   8(%%"REG_b", %%"REG_a"), %%esi          \n\t"
+        "pmullw                   %%mm3, %%mm0          \n\t"
+        "psllw                       $7, %%mm1          \n\t"
+        "paddw                    %%mm1, %%mm0          \n\t"
+
+        "movq                     %%mm0, (%%"REG_D", %%"REG_a") \n\t"
+
+        "add                         $8, %%"REG_a"      \n\t"
+    // End
+        "9:                                             \n\t"
+//        "int $3                                         \n\t"
+        "lea                 " LOCAL_MANGLE(0b) ", %0   \n\t"
+        "lea                 " LOCAL_MANGLE(1b) ", %1   \n\t"
+        "lea                 " LOCAL_MANGLE(2b) ", %2   \n\t"
+        "dec                         %1                 \n\t"
+        "dec                         %2                 \n\t"
+        "sub                         %0, %1             \n\t"
+        "sub                         %0, %2             \n\t"
+        "lea                 " LOCAL_MANGLE(9b) ", %3   \n\t"
+        "sub                         %0, %3             \n\t"
+
+
+        :"=r" (fragmentA), "=r" (imm8OfPShufW1A), "=r" (imm8OfPShufW2A),
+        "=r" (fragmentLengthA)
+    );
+
+    __asm__ volatile(
+        "jmp                         9f                 \n\t"
+    // Begin
+        "0:                                             \n\t"
+        "movq    (%%"REG_d", %%"REG_a"), %%mm3          \n\t"
+        "movd    (%%"REG_c", %%"REG_S"), %%mm0          \n\t"
+        "punpcklbw                %%mm7, %%mm0          \n\t"
+        "pshufw                   $0xFF, %%mm0, %%mm1   \n\t"
+        "1:                                             \n\t"
+        "pshufw                   $0xFF, %%mm0, %%mm0   \n\t"
+        "2:                                             \n\t"
+        "psubw                    %%mm1, %%mm0          \n\t"
+        "movl   8(%%"REG_b", %%"REG_a"), %%esi          \n\t"
+        "pmullw                   %%mm3, %%mm0          \n\t"
+        "psllw                       $7, %%mm1          \n\t"
+        "paddw                    %%mm1, %%mm0          \n\t"
+
+        "movq                     %%mm0, (%%"REG_D", %%"REG_a") \n\t"
+
+        "add                         $8, %%"REG_a"      \n\t"
+    // End
+        "9:                                             \n\t"
+//        "int                       $3                   \n\t"
+        "lea                 " LOCAL_MANGLE(0b) ", %0   \n\t"
+        "lea                 " LOCAL_MANGLE(1b) ", %1   \n\t"
+        "lea                 " LOCAL_MANGLE(2b) ", %2   \n\t"
+        "dec                         %1                 \n\t"
+        "dec                         %2                 \n\t"
+        "sub                         %0, %1             \n\t"
+        "sub                         %0, %2             \n\t"
+        "lea                 " LOCAL_MANGLE(9b) ", %3   \n\t"
+        "sub                         %0, %3             \n\t"
+
+
+        :"=r" (fragmentB), "=r" (imm8OfPShufW1B), "=r" (imm8OfPShufW2B),
+        "=r" (fragmentLengthB)
+    );
+
+    xpos= 0; //lumXInc/2 - 0x8000; // difference between pixel centers
+    fragmentPos=0;
+
+    for (i=0; i<dstW/numSplits; i++) {
+        int xx=xpos>>16;
+
+        if ((i&3) == 0) {
+            int a=0;
+            int b=((xpos+xInc)>>16) - xx;
+            int c=((xpos+xInc*2)>>16) - xx;
+            int d=((xpos+xInc*3)>>16) - xx;
+            int inc                = (d+1<4);
+            uint8_t *fragment      = (d+1<4) ? fragmentB       : fragmentA;
+            x86_reg imm8OfPShufW1  = (d+1<4) ? imm8OfPShufW1B  : imm8OfPShufW1A;
+            x86_reg imm8OfPShufW2  = (d+1<4) ? imm8OfPShufW2B  : imm8OfPShufW2A;
+            x86_reg fragmentLength = (d+1<4) ? fragmentLengthB : fragmentLengthA;
+            int maxShift= 3-(d+inc);
+            int shift=0;
+
+            if (filterCode) {
+                filter[i  ] = (( xpos         & 0xFFFF) ^ 0xFFFF)>>9;
+                filter[i+1] = (((xpos+xInc  ) & 0xFFFF) ^ 0xFFFF)>>9;
+                filter[i+2] = (((xpos+xInc*2) & 0xFFFF) ^ 0xFFFF)>>9;
+                filter[i+3] = (((xpos+xInc*3) & 0xFFFF) ^ 0xFFFF)>>9;
+                filterPos[i/2]= xx;
+
+                memcpy(filterCode + fragmentPos, fragment, fragmentLength);
+
+                filterCode[fragmentPos + imm8OfPShufW1]=
+                    (a+inc) | ((b+inc)<<2) | ((c+inc)<<4) | ((d+inc)<<6);
+                filterCode[fragmentPos + imm8OfPShufW2]=
+                    a | (b<<2) | (c<<4) | (d<<6);
+
+                if (i+4-inc>=dstW) shift=maxShift; //avoid overread
+                else if ((filterPos[i/2]&3) <= maxShift) shift=filterPos[i/2]&3; //Align
+
+                if (shift && i>=shift) {
+                    filterCode[fragmentPos + imm8OfPShufW1]+= 0x55*shift;
+                    filterCode[fragmentPos + imm8OfPShufW2]+= 0x55*shift;
+                    filterPos[i/2]-=shift;
+                }
+            }
+
+            fragmentPos+= fragmentLength;
+
+            if (filterCode)
+                filterCode[fragmentPos]= RET;
+        }
+        xpos+=xInc;
+    }
+    if (filterCode)
+        filterPos[((i/2)+1)&(~1)]= xpos>>16; // needed to jump to the next part
+
+    return fragmentPos + 1;
+}
+#endif /* ARCH_X86 && (HAVE_MMX2 || CONFIG_RUNTIME_CPUDETECT) && CONFIG_GPL */
+
+static void getSubSampleFactors(int *h, int *v, enum PixelFormat format)
+{
+    *h = av_pix_fmt_descriptors[format].log2_chroma_w;
+    *v = av_pix_fmt_descriptors[format].log2_chroma_h;
+}
+
+static uint16_t roundToInt16(int64_t f)
+{
+    int r= (f + (1<<15))>>16;
+         if (r<-0x7FFF) return 0x8000;
+    else if (r> 0x7FFF) return 0x7FFF;
+    else                return r;
+}
+
+int sws_setColorspaceDetails(SwsContext *c, const int inv_table[4], int srcRange, const int table[4], int dstRange, int brightness, int contrast, int saturation)
+{
+    int64_t crv =  inv_table[0];
+    int64_t cbu =  inv_table[1];
+    int64_t cgu = -inv_table[2];
+    int64_t cgv = -inv_table[3];
+    int64_t cy  = 1<<16;
+    int64_t oy  = 0;
+
+    memcpy(c->srcColorspaceTable, inv_table, sizeof(int)*4);
+    memcpy(c->dstColorspaceTable,     table, sizeof(int)*4);
+
+    c->brightness= brightness;
+    c->contrast  = contrast;
+    c->saturation= saturation;
+    c->srcRange  = srcRange;
+    c->dstRange  = dstRange;
+    if (isYUV(c->dstFormat) || isGray(c->dstFormat)) return -1;
+
+    c->uOffset=   0x0400040004000400LL;
+    c->vOffset=   0x0400040004000400LL;
+
+    if (!srcRange) {
+        cy= (cy*255) / 219;
+        oy= 16<<16;
+    } else {
+        crv= (crv*224) / 255;
+        cbu= (cbu*224) / 255;
+        cgu= (cgu*224) / 255;
+        cgv= (cgv*224) / 255;
+    }
+
+    cy = (cy *contrast             )>>16;
+    crv= (crv*contrast * saturation)>>32;
+    cbu= (cbu*contrast * saturation)>>32;
+    cgu= (cgu*contrast * saturation)>>32;
+    cgv= (cgv*contrast * saturation)>>32;
+
+    oy -= 256*brightness;
+
+    c->yCoeff=    roundToInt16(cy *8192) * 0x0001000100010001ULL;
+    c->vrCoeff=   roundToInt16(crv*8192) * 0x0001000100010001ULL;
+    c->ubCoeff=   roundToInt16(cbu*8192) * 0x0001000100010001ULL;
+    c->vgCoeff=   roundToInt16(cgv*8192) * 0x0001000100010001ULL;
+    c->ugCoeff=   roundToInt16(cgu*8192) * 0x0001000100010001ULL;
+    c->yOffset=   roundToInt16(oy *   8) * 0x0001000100010001ULL;
+
+    c->yuv2rgb_y_coeff  = (int16_t)roundToInt16(cy <<13);
+    c->yuv2rgb_y_offset = (int16_t)roundToInt16(oy << 9);
+    c->yuv2rgb_v2r_coeff= (int16_t)roundToInt16(crv<<13);
+    c->yuv2rgb_v2g_coeff= (int16_t)roundToInt16(cgv<<13);
+    c->yuv2rgb_u2g_coeff= (int16_t)roundToInt16(cgu<<13);
+    c->yuv2rgb_u2b_coeff= (int16_t)roundToInt16(cbu<<13);
+
+    ff_yuv2rgb_c_init_tables(c, inv_table, srcRange, brightness, contrast, saturation);
+    //FIXME factorize
+
+#if ARCH_PPC && (HAVE_ALTIVEC || CONFIG_RUNTIME_CPUDETECT)
+    if (c->flags & SWS_CPU_CAPS_ALTIVEC)
+        ff_yuv2rgb_init_tables_altivec(c, inv_table, brightness, contrast, saturation);
+#endif
+    return 0;
+}
+
+int sws_getColorspaceDetails(SwsContext *c, int **inv_table, int *srcRange, int **table, int *dstRange, int *brightness, int *contrast, int *saturation)
+{
+    if (isYUV(c->dstFormat) || isGray(c->dstFormat)) return -1;
+
+    *inv_table = c->srcColorspaceTable;
+    *table     = c->dstColorspaceTable;
+    *srcRange  = c->srcRange;
+    *dstRange  = c->dstRange;
+    *brightness= c->brightness;
+    *contrast  = c->contrast;
+    *saturation= c->saturation;
+
+    return 0;
+}
+
+static int handle_jpeg(enum PixelFormat *format)
+{
+    switch (*format) {
+    case PIX_FMT_YUVJ420P:
+        *format = PIX_FMT_YUV420P;
+        return 1;
+    case PIX_FMT_YUVJ422P:
+        *format = PIX_FMT_YUV422P;
+        return 1;
+    case PIX_FMT_YUVJ444P:
+        *format = PIX_FMT_YUV444P;
+        return 1;
+    case PIX_FMT_YUVJ440P:
+        *format = PIX_FMT_YUV440P;
+        return 1;
+    default:
+        return 0;
+    }
+}
+
+SwsContext *sws_getContext(int srcW, int srcH, enum PixelFormat srcFormat,
+                           int dstW, int dstH, enum PixelFormat dstFormat, int flags,
+                           SwsFilter *srcFilter, SwsFilter *dstFilter, const double *param)
+{
+
+    SwsContext *c;
+    int i;
+    int usesVFilter, usesHFilter;
+    int unscaled;
+    int srcRange, dstRange;
+    SwsFilter dummyFilter= {NULL, NULL, NULL, NULL};
+#if ARCH_X86
+    if (flags & SWS_CPU_CAPS_MMX)
+        __asm__ volatile("emms\n\t"::: "memory");
+#endif
+
+#if !CONFIG_RUNTIME_CPUDETECT //ensure that the flags match the compiled variant if cpudetect is off
+    flags &= ~(SWS_CPU_CAPS_MMX|SWS_CPU_CAPS_MMX2|SWS_CPU_CAPS_3DNOW|SWS_CPU_CAPS_ALTIVEC|SWS_CPU_CAPS_BFIN);
+    flags |= ff_hardcodedcpuflags();
+#endif /* CONFIG_RUNTIME_CPUDETECT */
+    if (!rgb15to16) sws_rgb2rgb_init(flags);
+
+    unscaled = (srcW == dstW && srcH == dstH);
+
+    srcRange = handle_jpeg(&srcFormat);
+    dstRange = handle_jpeg(&dstFormat);
+
+    if (!isSupportedIn(srcFormat)) {
+        av_log(NULL, AV_LOG_ERROR, "swScaler: %s is not supported as input pixel format\n", sws_format_name(srcFormat));
+        return NULL;
+    }
+    if (!isSupportedOut(dstFormat)) {
+        av_log(NULL, AV_LOG_ERROR, "swScaler: %s is not supported as output pixel format\n", sws_format_name(dstFormat));
+        return NULL;
+    }
+
+    i= flags & ( SWS_POINT
+                |SWS_AREA
+                |SWS_BILINEAR
+                |SWS_FAST_BILINEAR
+                |SWS_BICUBIC
+                |SWS_X
+                |SWS_GAUSS
+                |SWS_LANCZOS
+                |SWS_SINC
+                |SWS_SPLINE
+                |SWS_BICUBLIN);
+    if(!i || (i & (i-1))) {
+        av_log(NULL, AV_LOG_ERROR, "swScaler: Exactly one scaler algorithm must be chosen\n");
+        return NULL;
+    }
+
+    /* sanity check */
+    if (srcW<4 || srcH<1 || dstW<8 || dstH<1) { //FIXME check if these are enough and try to lowwer them after fixing the relevant parts of the code
+        av_log(NULL, AV_LOG_ERROR, "swScaler: %dx%d -> %dx%d is invalid scaling dimension\n",
+               srcW, srcH, dstW, dstH);
+        return NULL;
+    }
+    if(srcW > VOFW || dstW > VOFW) {
+        av_log(NULL, AV_LOG_ERROR, "swScaler: Compile-time maximum width is "AV_STRINGIFY(VOFW)" change VOF/VOFW and recompile\n");
+        return NULL;
+    }
+
+    if (!dstFilter) dstFilter= &dummyFilter;
+    if (!srcFilter) srcFilter= &dummyFilter;
+
+    FF_ALLOCZ_OR_GOTO(NULL, c, sizeof(SwsContext), fail);
+
+    c->av_class = &sws_context_class;
+    c->srcW= srcW;
+    c->srcH= srcH;
+    c->dstW= dstW;
+    c->dstH= dstH;
+    c->lumXInc= ((srcW<<16) + (dstW>>1))/dstW;
+    c->lumYInc= ((srcH<<16) + (dstH>>1))/dstH;
+    c->flags= flags;
+    c->dstFormat= dstFormat;
+    c->srcFormat= srcFormat;
+    c->dstFormatBpp = av_get_bits_per_pixel(&av_pix_fmt_descriptors[dstFormat]);
+    c->srcFormatBpp = av_get_bits_per_pixel(&av_pix_fmt_descriptors[srcFormat]);
+    c->vRounder= 4* 0x0001000100010001ULL;
+
+    usesVFilter = (srcFilter->lumV && srcFilter->lumV->length>1) ||
+                  (srcFilter->chrV && srcFilter->chrV->length>1) ||
+                  (dstFilter->lumV && dstFilter->lumV->length>1) ||
+                  (dstFilter->chrV && dstFilter->chrV->length>1);
+    usesHFilter = (srcFilter->lumH && srcFilter->lumH->length>1) ||
+                  (srcFilter->chrH && srcFilter->chrH->length>1) ||
+                  (dstFilter->lumH && dstFilter->lumH->length>1) ||
+                  (dstFilter->chrH && dstFilter->chrH->length>1);
+
+    getSubSampleFactors(&c->chrSrcHSubSample, &c->chrSrcVSubSample, srcFormat);
+    getSubSampleFactors(&c->chrDstHSubSample, &c->chrDstVSubSample, dstFormat);
+
+    // reuse chroma for 2 pixels RGB/BGR unless user wants full chroma interpolation
+    if (isAnyRGB(dstFormat) && !(flags&SWS_FULL_CHR_H_INT)) c->chrDstHSubSample=1;
+
+    // drop some chroma lines if the user wants it
+    c->vChrDrop= (flags&SWS_SRC_V_CHR_DROP_MASK)>>SWS_SRC_V_CHR_DROP_SHIFT;
+    c->chrSrcVSubSample+= c->vChrDrop;
+
+    // drop every other pixel for chroma calculation unless user wants full chroma
+    if (isAnyRGB(srcFormat) && !(flags&SWS_FULL_CHR_H_INP)
+      && srcFormat!=PIX_FMT_RGB8      && srcFormat!=PIX_FMT_BGR8
+      && srcFormat!=PIX_FMT_RGB4      && srcFormat!=PIX_FMT_BGR4
+      && srcFormat!=PIX_FMT_RGB4_BYTE && srcFormat!=PIX_FMT_BGR4_BYTE
+      && ((dstW>>c->chrDstHSubSample) <= (srcW>>1) || (flags&(SWS_FAST_BILINEAR|SWS_POINT))))
+        c->chrSrcHSubSample=1;
+
+    if (param) {
+        c->param[0] = param[0];
+        c->param[1] = param[1];
+    } else {
+        c->param[0] =
+        c->param[1] = SWS_PARAM_DEFAULT;
+    }
+
+    // Note the -((-x)>>y) is so that we always round toward +inf.
+    c->chrSrcW= -((-srcW) >> c->chrSrcHSubSample);
+    c->chrSrcH= -((-srcH) >> c->chrSrcVSubSample);
+    c->chrDstW= -((-dstW) >> c->chrDstHSubSample);
+    c->chrDstH= -((-dstH) >> c->chrDstVSubSample);
+
+    sws_setColorspaceDetails(c, ff_yuv2rgb_coeffs[SWS_CS_DEFAULT], srcRange, ff_yuv2rgb_coeffs[SWS_CS_DEFAULT] /* FIXME*/, dstRange, 0, 1<<16, 1<<16);
+
+    /* unscaled special cases */
+    if (unscaled && !usesHFilter && !usesVFilter && (srcRange == dstRange || isAnyRGB(dstFormat))) {
+        ff_get_unscaled_swscale(c);
+
+        if (c->swScale) {
+            if (flags&SWS_PRINT_INFO)
+                av_log(c, AV_LOG_INFO, "using unscaled %s -> %s special converter\n",
+                       sws_format_name(srcFormat), sws_format_name(dstFormat));
+            return c;
+        }
+    }
+
+    if (flags & SWS_CPU_CAPS_MMX2) {
+        c->canMMX2BeUsed= (dstW >=srcW && (dstW&31)==0 && (srcW&15)==0) ? 1 : 0;
+        if (!c->canMMX2BeUsed && dstW >=srcW && (srcW&15)==0 && (flags&SWS_FAST_BILINEAR)) {
+            if (flags&SWS_PRINT_INFO)
+                av_log(c, AV_LOG_INFO, "output width is not a multiple of 32 -> no MMX2 scaler\n");
+        }
+        if (usesHFilter) c->canMMX2BeUsed=0;
+    }
+    else
+        c->canMMX2BeUsed=0;
+
+    c->chrXInc= ((c->chrSrcW<<16) + (c->chrDstW>>1))/c->chrDstW;
+    c->chrYInc= ((c->chrSrcH<<16) + (c->chrDstH>>1))/c->chrDstH;
+
+    // match pixel 0 of the src to pixel 0 of dst and match pixel n-2 of src to pixel n-2 of dst
+    // but only for the FAST_BILINEAR mode otherwise do correct scaling
+    // n-2 is the last chrominance sample available
+    // this is not perfect, but no one should notice the difference, the more correct variant
+    // would be like the vertical one, but that would require some special code for the
+    // first and last pixel
+    if (flags&SWS_FAST_BILINEAR) {
+        if (c->canMMX2BeUsed) {
+            c->lumXInc+= 20;
+            c->chrXInc+= 20;
+        }
+        //we don't use the x86 asm scaler if MMX is available
+        else if (flags & SWS_CPU_CAPS_MMX) {
+            c->lumXInc = ((srcW-2)<<16)/(dstW-2) - 20;
+            c->chrXInc = ((c->chrSrcW-2)<<16)/(c->chrDstW-2) - 20;
+        }
+    }
+
+    /* precalculate horizontal scaler filter coefficients */
+    {
+#if ARCH_X86 && (HAVE_MMX2 || CONFIG_RUNTIME_CPUDETECT) && CONFIG_GPL
+// can't downscale !!!
+        if (c->canMMX2BeUsed && (flags & SWS_FAST_BILINEAR)) {
+            c->lumMmx2FilterCodeSize = initMMX2HScaler(      dstW, c->lumXInc, NULL, NULL, NULL, 8);
+            c->chrMmx2FilterCodeSize = initMMX2HScaler(c->chrDstW, c->chrXInc, NULL, NULL, NULL, 4);
+
+#ifdef MAP_ANONYMOUS
+            c->lumMmx2FilterCode = mmap(NULL, c->lumMmx2FilterCodeSize, PROT_READ | PROT_WRITE, MAP_PRIVATE | MAP_ANONYMOUS, 0, 0);
+            c->chrMmx2FilterCode = mmap(NULL, c->chrMmx2FilterCodeSize, PROT_READ | PROT_WRITE, MAP_PRIVATE | MAP_ANONYMOUS, 0, 0);
+#elif HAVE_VIRTUALALLOC
+            c->lumMmx2FilterCode = VirtualAlloc(NULL, c->lumMmx2FilterCodeSize, MEM_COMMIT, PAGE_EXECUTE_READWRITE);
+            c->chrMmx2FilterCode = VirtualAlloc(NULL, c->chrMmx2FilterCodeSize, MEM_COMMIT, PAGE_EXECUTE_READWRITE);
+#else
+            c->lumMmx2FilterCode = av_malloc(c->lumMmx2FilterCodeSize);
+            c->chrMmx2FilterCode = av_malloc(c->chrMmx2FilterCodeSize);
+#endif
+
+            FF_ALLOCZ_OR_GOTO(c, c->hLumFilter   , (dstW        /8+8)*sizeof(int16_t), fail);
+            FF_ALLOCZ_OR_GOTO(c, c->hChrFilter   , (c->chrDstW  /4+8)*sizeof(int16_t), fail);
+            FF_ALLOCZ_OR_GOTO(c, c->hLumFilterPos, (dstW      /2/8+8)*sizeof(int32_t), fail);
+            FF_ALLOCZ_OR_GOTO(c, c->hChrFilterPos, (c->chrDstW/2/4+8)*sizeof(int32_t), fail);
+
+            initMMX2HScaler(      dstW, c->lumXInc, c->lumMmx2FilterCode, c->hLumFilter, c->hLumFilterPos, 8);
+            initMMX2HScaler(c->chrDstW, c->chrXInc, c->chrMmx2FilterCode, c->hChrFilter, c->hChrFilterPos, 4);
+
+#ifdef MAP_ANONYMOUS
+            mprotect(c->lumMmx2FilterCode, c->lumMmx2FilterCodeSize, PROT_EXEC | PROT_READ);
+            mprotect(c->chrMmx2FilterCode, c->chrMmx2FilterCodeSize, PROT_EXEC | PROT_READ);
+#endif
+        } else
+#endif /* ARCH_X86 && (HAVE_MMX2 || CONFIG_RUNTIME_CPUDETECT) && CONFIG_GPL */
+        {
+            const int filterAlign=
+                (flags & SWS_CPU_CAPS_MMX) ? 4 :
+                (flags & SWS_CPU_CAPS_ALTIVEC) ? 8 :
+                1;
+
+            if (initFilter(&c->hLumFilter, &c->hLumFilterPos, &c->hLumFilterSize, c->lumXInc,
+                           srcW      ,       dstW, filterAlign, 1<<14,
+                           (flags&SWS_BICUBLIN) ? (flags|SWS_BICUBIC)  : flags,
+                           srcFilter->lumH, dstFilter->lumH, c->param) < 0)
+                goto fail;
+            if (initFilter(&c->hChrFilter, &c->hChrFilterPos, &c->hChrFilterSize, c->chrXInc,
+                           c->chrSrcW, c->chrDstW, filterAlign, 1<<14,
+                           (flags&SWS_BICUBLIN) ? (flags|SWS_BILINEAR) : flags,
+                           srcFilter->chrH, dstFilter->chrH, c->param) < 0)
+                goto fail;
+        }
+    } // initialize horizontal stuff
+
+    /* precalculate vertical scaler filter coefficients */
+    {
+        const int filterAlign=
+            (flags & SWS_CPU_CAPS_MMX) && (flags & SWS_ACCURATE_RND) ? 2 :
+            (flags & SWS_CPU_CAPS_ALTIVEC) ? 8 :
+            1;
+
+        if (initFilter(&c->vLumFilter, &c->vLumFilterPos, &c->vLumFilterSize, c->lumYInc,
+                       srcH      ,        dstH, filterAlign, (1<<12),
+                       (flags&SWS_BICUBLIN) ? (flags|SWS_BICUBIC)  : flags,
+                       srcFilter->lumV, dstFilter->lumV, c->param) < 0)
+            goto fail;
+        if (initFilter(&c->vChrFilter, &c->vChrFilterPos, &c->vChrFilterSize, c->chrYInc,
+                       c->chrSrcH, c->chrDstH, filterAlign, (1<<12),
+                       (flags&SWS_BICUBLIN) ? (flags|SWS_BILINEAR) : flags,
+                       srcFilter->chrV, dstFilter->chrV, c->param) < 0)
+            goto fail;
+
+#if ARCH_PPC && (HAVE_ALTIVEC || CONFIG_RUNTIME_CPUDETECT)
+        FF_ALLOC_OR_GOTO(c, c->vYCoeffsBank, sizeof (vector signed short)*c->vLumFilterSize*c->dstH, fail);
+        FF_ALLOC_OR_GOTO(c, c->vCCoeffsBank, sizeof (vector signed short)*c->vChrFilterSize*c->chrDstH, fail);
+
+        for (i=0;i<c->vLumFilterSize*c->dstH;i++) {
+            int j;
+            short *p = (short *)&c->vYCoeffsBank[i];
+            for (j=0;j<8;j++)
+                p[j] = c->vLumFilter[i];
+        }
+
+        for (i=0;i<c->vChrFilterSize*c->chrDstH;i++) {
+            int j;
+            short *p = (short *)&c->vCCoeffsBank[i];
+            for (j=0;j<8;j++)
+                p[j] = c->vChrFilter[i];
+        }
+#endif
+    }
+
+    // calculate buffer sizes so that they won't run out while handling these damn slices
+    c->vLumBufSize= c->vLumFilterSize;
+    c->vChrBufSize= c->vChrFilterSize;
+    for (i=0; i<dstH; i++) {
+        int chrI= i*c->chrDstH / dstH;
+        int nextSlice= FFMAX(c->vLumFilterPos[i   ] + c->vLumFilterSize - 1,
+                           ((c->vChrFilterPos[chrI] + c->vChrFilterSize - 1)<<c->chrSrcVSubSample));
+
+        nextSlice>>= c->chrSrcVSubSample;
+        nextSlice<<= c->chrSrcVSubSample;
+        if (c->vLumFilterPos[i   ] + c->vLumBufSize < nextSlice)
+            c->vLumBufSize= nextSlice - c->vLumFilterPos[i];
+        if (c->vChrFilterPos[chrI] + c->vChrBufSize < (nextSlice>>c->chrSrcVSubSample))
+            c->vChrBufSize= (nextSlice>>c->chrSrcVSubSample) - c->vChrFilterPos[chrI];
+    }
+
+    // allocate pixbufs (we use dynamic allocation because otherwise we would need to
+    // allocate several megabytes to handle all possible cases)
+    FF_ALLOC_OR_GOTO(c, c->lumPixBuf, c->vLumBufSize*2*sizeof(int16_t*), fail);
+    FF_ALLOC_OR_GOTO(c, c->chrPixBuf, c->vChrBufSize*2*sizeof(int16_t*), fail);
+    if (CONFIG_SWSCALE_ALPHA && isALPHA(c->srcFormat) && isALPHA(c->dstFormat))
+        FF_ALLOCZ_OR_GOTO(c, c->alpPixBuf, c->vLumBufSize*2*sizeof(int16_t*), fail);
+    //Note we need at least one pixel more at the end because of the MMX code (just in case someone wanna replace the 4000/8000)
+    /* align at 16 bytes for AltiVec */
+    for (i=0; i<c->vLumBufSize; i++) {
+        FF_ALLOCZ_OR_GOTO(c, c->lumPixBuf[i+c->vLumBufSize], VOF+1, fail);
+        c->lumPixBuf[i] = c->lumPixBuf[i+c->vLumBufSize];
+    }
+    for (i=0; i<c->vChrBufSize; i++) {
+        FF_ALLOC_OR_GOTO(c, c->chrPixBuf[i+c->vChrBufSize], (VOF+1)*2, fail);
+        c->chrPixBuf[i] = c->chrPixBuf[i+c->vChrBufSize];
+    }
+    if (CONFIG_SWSCALE_ALPHA && c->alpPixBuf)
+        for (i=0; i<c->vLumBufSize; i++) {
+            FF_ALLOCZ_OR_GOTO(c, c->alpPixBuf[i+c->vLumBufSize], VOF+1, fail);
+            c->alpPixBuf[i] = c->alpPixBuf[i+c->vLumBufSize];
+        }
+
+    //try to avoid drawing green stuff between the right end and the stride end
+    for (i=0; i<c->vChrBufSize; i++) memset(c->chrPixBuf[i], 64, (VOF+1)*2);
+
+    assert(2*VOFW == VOF);
+
+    assert(c->chrDstH <= dstH);
+
+    if (flags&SWS_PRINT_INFO) {
+        if (flags&SWS_FAST_BILINEAR)
+            av_log(c, AV_LOG_INFO, "FAST_BILINEAR scaler, ");
+        else if (flags&SWS_BILINEAR)
+            av_log(c, AV_LOG_INFO, "BILINEAR scaler, ");
+        else if (flags&SWS_BICUBIC)
+            av_log(c, AV_LOG_INFO, "BICUBIC scaler, ");
+        else if (flags&SWS_X)
+            av_log(c, AV_LOG_INFO, "Experimental scaler, ");
+        else if (flags&SWS_POINT)
+            av_log(c, AV_LOG_INFO, "Nearest Neighbor / POINT scaler, ");
+        else if (flags&SWS_AREA)
+            av_log(c, AV_LOG_INFO, "Area Averaging scaler, ");
+        else if (flags&SWS_BICUBLIN)
+            av_log(c, AV_LOG_INFO, "luma BICUBIC / chroma BILINEAR scaler, ");
+        else if (flags&SWS_GAUSS)
+            av_log(c, AV_LOG_INFO, "Gaussian scaler, ");
+        else if (flags&SWS_SINC)
+            av_log(c, AV_LOG_INFO, "Sinc scaler, ");
+        else if (flags&SWS_LANCZOS)
+            av_log(c, AV_LOG_INFO, "Lanczos scaler, ");
+        else if (flags&SWS_SPLINE)
+            av_log(c, AV_LOG_INFO, "Bicubic spline scaler, ");
+        else
+            av_log(c, AV_LOG_INFO, "ehh flags invalid?! ");
+
+        av_log(c, AV_LOG_INFO, "from %s to %s%s ",
+               sws_format_name(srcFormat),
+#ifdef DITHER1XBPP
+               dstFormat == PIX_FMT_BGR555 || dstFormat == PIX_FMT_BGR565 ? "dithered " : "",
+#else
+               "",
+#endif
+               sws_format_name(dstFormat));
+
+        if (flags & SWS_CPU_CAPS_MMX2)
+            av_log(c, AV_LOG_INFO, "using MMX2\n");
+        else if (flags & SWS_CPU_CAPS_3DNOW)
+            av_log(c, AV_LOG_INFO, "using 3DNOW\n");
+        else if (flags & SWS_CPU_CAPS_MMX)
+            av_log(c, AV_LOG_INFO, "using MMX\n");
+        else if (flags & SWS_CPU_CAPS_ALTIVEC)
+            av_log(c, AV_LOG_INFO, "using AltiVec\n");
+        else
+            av_log(c, AV_LOG_INFO, "using C\n");
+
+        if (flags & SWS_CPU_CAPS_MMX) {
+            if (c->canMMX2BeUsed && (flags&SWS_FAST_BILINEAR))
+                av_log(c, AV_LOG_VERBOSE, "using FAST_BILINEAR MMX2 scaler for horizontal scaling\n");
+            else {
+                if (c->hLumFilterSize==4)
+                    av_log(c, AV_LOG_VERBOSE, "using 4-tap MMX scaler for horizontal luminance scaling\n");
+                else if (c->hLumFilterSize==8)
+                    av_log(c, AV_LOG_VERBOSE, "using 8-tap MMX scaler for horizontal luminance scaling\n");
+                else
+                    av_log(c, AV_LOG_VERBOSE, "using n-tap MMX scaler for horizontal luminance scaling\n");
+
+                if (c->hChrFilterSize==4)
+                    av_log(c, AV_LOG_VERBOSE, "using 4-tap MMX scaler for horizontal chrominance scaling\n");
+                else if (c->hChrFilterSize==8)
+                    av_log(c, AV_LOG_VERBOSE, "using 8-tap MMX scaler for horizontal chrominance scaling\n");
+                else
+                    av_log(c, AV_LOG_VERBOSE, "using n-tap MMX scaler for horizontal chrominance scaling\n");
+            }
+        } else {
+#if ARCH_X86
+            av_log(c, AV_LOG_VERBOSE, "using x86 asm scaler for horizontal scaling\n");
+#else
+            if (flags & SWS_FAST_BILINEAR)
+                av_log(c, AV_LOG_VERBOSE, "using FAST_BILINEAR C scaler for horizontal scaling\n");
+            else
+                av_log(c, AV_LOG_VERBOSE, "using C scaler for horizontal scaling\n");
+#endif
+        }
+        if (isPlanarYUV(dstFormat)) {
+            if (c->vLumFilterSize==1)
+                av_log(c, AV_LOG_VERBOSE, "using 1-tap %s \"scaler\" for vertical scaling (YV12 like)\n", (flags & SWS_CPU_CAPS_MMX) ? "MMX" : "C");
+            else
+                av_log(c, AV_LOG_VERBOSE, "using n-tap %s scaler for vertical scaling (YV12 like)\n", (flags & SWS_CPU_CAPS_MMX) ? "MMX" : "C");
+        } else {
+            if (c->vLumFilterSize==1 && c->vChrFilterSize==2)
+                av_log(c, AV_LOG_VERBOSE, "using 1-tap %s \"scaler\" for vertical luminance scaling (BGR)\n"
+                       "      2-tap scaler for vertical chrominance scaling (BGR)\n", (flags & SWS_CPU_CAPS_MMX) ? "MMX" : "C");
+            else if (c->vLumFilterSize==2 && c->vChrFilterSize==2)
+                av_log(c, AV_LOG_VERBOSE, "using 2-tap linear %s scaler for vertical scaling (BGR)\n", (flags & SWS_CPU_CAPS_MMX) ? "MMX" : "C");
+            else
+                av_log(c, AV_LOG_VERBOSE, "using n-tap %s scaler for vertical scaling (BGR)\n", (flags & SWS_CPU_CAPS_MMX) ? "MMX" : "C");
+        }
+
+        if (dstFormat==PIX_FMT_BGR24)
+            av_log(c, AV_LOG_VERBOSE, "using %s YV12->BGR24 converter\n",
+                   (flags & SWS_CPU_CAPS_MMX2) ? "MMX2" : ((flags & SWS_CPU_CAPS_MMX) ? "MMX" : "C"));
+        else if (dstFormat==PIX_FMT_RGB32)
+            av_log(c, AV_LOG_VERBOSE, "using %s YV12->BGR32 converter\n", (flags & SWS_CPU_CAPS_MMX) ? "MMX" : "C");
+        else if (dstFormat==PIX_FMT_BGR565)
+            av_log(c, AV_LOG_VERBOSE, "using %s YV12->BGR16 converter\n", (flags & SWS_CPU_CAPS_MMX) ? "MMX" : "C");
+        else if (dstFormat==PIX_FMT_BGR555)
+            av_log(c, AV_LOG_VERBOSE, "using %s YV12->BGR15 converter\n", (flags & SWS_CPU_CAPS_MMX) ? "MMX" : "C");
+
+        av_log(c, AV_LOG_VERBOSE, "%dx%d -> %dx%d\n", srcW, srcH, dstW, dstH);
+        av_log(c, AV_LOG_DEBUG, "lum srcW=%d srcH=%d dstW=%d dstH=%d xInc=%d yInc=%d\n",
+               c->srcW, c->srcH, c->dstW, c->dstH, c->lumXInc, c->lumYInc);
+        av_log(c, AV_LOG_DEBUG, "chr srcW=%d srcH=%d dstW=%d dstH=%d xInc=%d yInc=%d\n",
+               c->chrSrcW, c->chrSrcH, c->chrDstW, c->chrDstH, c->chrXInc, c->chrYInc);
+    }
+
+    c->swScale= ff_getSwsFunc(c);
+    return c;
+
+fail:
+    sws_freeContext(c);
+    return NULL;
+}
+
+SwsFilter *sws_getDefaultFilter(float lumaGBlur, float chromaGBlur,
+                                float lumaSharpen, float chromaSharpen,
+                                float chromaHShift, float chromaVShift,
+                                int verbose)
+{
+    SwsFilter *filter= av_malloc(sizeof(SwsFilter));
+    if (!filter)
+        return NULL;
+
+    if (lumaGBlur!=0.0) {
+        filter->lumH= sws_getGaussianVec(lumaGBlur, 3.0);
+        filter->lumV= sws_getGaussianVec(lumaGBlur, 3.0);
+    } else {
+        filter->lumH= sws_getIdentityVec();
+        filter->lumV= sws_getIdentityVec();
+    }
+
+    if (chromaGBlur!=0.0) {
+        filter->chrH= sws_getGaussianVec(chromaGBlur, 3.0);
+        filter->chrV= sws_getGaussianVec(chromaGBlur, 3.0);
+    } else {
+        filter->chrH= sws_getIdentityVec();
+        filter->chrV= sws_getIdentityVec();
+    }
+
+    if (chromaSharpen!=0.0) {
+        SwsVector *id= sws_getIdentityVec();
+        sws_scaleVec(filter->chrH, -chromaSharpen);
+        sws_scaleVec(filter->chrV, -chromaSharpen);
+        sws_addVec(filter->chrH, id);
+        sws_addVec(filter->chrV, id);
+        sws_freeVec(id);
+    }
+
+    if (lumaSharpen!=0.0) {
+        SwsVector *id= sws_getIdentityVec();
+        sws_scaleVec(filter->lumH, -lumaSharpen);
+        sws_scaleVec(filter->lumV, -lumaSharpen);
+        sws_addVec(filter->lumH, id);
+        sws_addVec(filter->lumV, id);
+        sws_freeVec(id);
+    }
+
+    if (chromaHShift != 0.0)
+        sws_shiftVec(filter->chrH, (int)(chromaHShift+0.5));
+
+    if (chromaVShift != 0.0)
+        sws_shiftVec(filter->chrV, (int)(chromaVShift+0.5));
+
+    sws_normalizeVec(filter->chrH, 1.0);
+    sws_normalizeVec(filter->chrV, 1.0);
+    sws_normalizeVec(filter->lumH, 1.0);
+    sws_normalizeVec(filter->lumV, 1.0);
+
+    if (verbose) sws_printVec2(filter->chrH, NULL, AV_LOG_DEBUG);
+    if (verbose) sws_printVec2(filter->lumH, NULL, AV_LOG_DEBUG);
+
+    return filter;
+}
+
+SwsVector *sws_allocVec(int length)
+{
+    SwsVector *vec = av_malloc(sizeof(SwsVector));
+    if (!vec)
+        return NULL;
+    vec->length = length;
+    vec->coeff  = av_malloc(sizeof(double) * length);
+    if (!vec->coeff)
+        av_freep(&vec);
+    return vec;
+}
+
+SwsVector *sws_getGaussianVec(double variance, double quality)
+{
+    const int length= (int)(variance*quality + 0.5) | 1;
+    int i;
+    double middle= (length-1)*0.5;
+    SwsVector *vec= sws_allocVec(length);
+
+    if (!vec)
+        return NULL;
+
+    for (i=0; i<length; i++) {
+        double dist= i-middle;
+        vec->coeff[i]= exp(-dist*dist/(2*variance*variance)) / sqrt(2*variance*M_PI);
+    }
+
+    sws_normalizeVec(vec, 1.0);
+
+    return vec;
+}
+
+SwsVector *sws_getConstVec(double c, int length)
+{
+    int i;
+    SwsVector *vec= sws_allocVec(length);
+
+    if (!vec)
+        return NULL;
+
+    for (i=0; i<length; i++)
+        vec->coeff[i]= c;
+
+    return vec;
+}
+
+SwsVector *sws_getIdentityVec(void)
+{
+    return sws_getConstVec(1.0, 1);
+}
+
+double sws_dcVec(SwsVector *a)
+{
+    int i;
+    double sum=0;
+
+    for (i=0; i<a->length; i++)
+        sum+= a->coeff[i];
+
+    return sum;
+}
+
+void sws_scaleVec(SwsVector *a, double scalar)
+{
+    int i;
+
+    for (i=0; i<a->length; i++)
+        a->coeff[i]*= scalar;
+}
+
+void sws_normalizeVec(SwsVector *a, double height)
+{
+    sws_scaleVec(a, height/sws_dcVec(a));
+}
+
+static SwsVector *sws_getConvVec(SwsVector *a, SwsVector *b)
+{
+    int length= a->length + b->length - 1;
+    int i, j;
+    SwsVector *vec= sws_getConstVec(0.0, length);
+
+    if (!vec)
+        return NULL;
+
+    for (i=0; i<a->length; i++) {
+        for (j=0; j<b->length; j++) {
+            vec->coeff[i+j]+= a->coeff[i]*b->coeff[j];
+        }
+    }
+
+    return vec;
+}
+
+static SwsVector *sws_sumVec(SwsVector *a, SwsVector *b)
+{
+    int length= FFMAX(a->length, b->length);
+    int i;
+    SwsVector *vec= sws_getConstVec(0.0, length);
+
+    if (!vec)
+        return NULL;
+
+    for (i=0; i<a->length; i++) vec->coeff[i + (length-1)/2 - (a->length-1)/2]+= a->coeff[i];
+    for (i=0; i<b->length; i++) vec->coeff[i + (length-1)/2 - (b->length-1)/2]+= b->coeff[i];
+
+    return vec;
+}
+
+static SwsVector *sws_diffVec(SwsVector *a, SwsVector *b)
+{
+    int length= FFMAX(a->length, b->length);
+    int i;
+    SwsVector *vec= sws_getConstVec(0.0, length);
+
+    if (!vec)
+        return NULL;
+
+    for (i=0; i<a->length; i++) vec->coeff[i + (length-1)/2 - (a->length-1)/2]+= a->coeff[i];
+    for (i=0; i<b->length; i++) vec->coeff[i + (length-1)/2 - (b->length-1)/2]-= b->coeff[i];
+
+    return vec;
+}
+
+/* shift left / or right if "shift" is negative */
+static SwsVector *sws_getShiftedVec(SwsVector *a, int shift)
+{
+    int length= a->length + FFABS(shift)*2;
+    int i;
+    SwsVector *vec= sws_getConstVec(0.0, length);
+
+    if (!vec)
+        return NULL;
+
+    for (i=0; i<a->length; i++) {
+        vec->coeff[i + (length-1)/2 - (a->length-1)/2 - shift]= a->coeff[i];
+    }
+
+    return vec;
+}
+
+void sws_shiftVec(SwsVector *a, int shift)
+{
+    SwsVector *shifted= sws_getShiftedVec(a, shift);
+    av_free(a->coeff);
+    a->coeff= shifted->coeff;
+    a->length= shifted->length;
+    av_free(shifted);
+}
+
+void sws_addVec(SwsVector *a, SwsVector *b)
+{
+    SwsVector *sum= sws_sumVec(a, b);
+    av_free(a->coeff);
+    a->coeff= sum->coeff;
+    a->length= sum->length;
+    av_free(sum);
+}
+
+void sws_subVec(SwsVector *a, SwsVector *b)
+{
+    SwsVector *diff= sws_diffVec(a, b);
+    av_free(a->coeff);
+    a->coeff= diff->coeff;
+    a->length= diff->length;
+    av_free(diff);
+}
+
+void sws_convVec(SwsVector *a, SwsVector *b)
+{
+    SwsVector *conv= sws_getConvVec(a, b);
+    av_free(a->coeff);
+    a->coeff= conv->coeff;
+    a->length= conv->length;
+    av_free(conv);
+}
+
+SwsVector *sws_cloneVec(SwsVector *a)
+{
+    int i;
+    SwsVector *vec= sws_allocVec(a->length);
+
+    if (!vec)
+        return NULL;
+
+    for (i=0; i<a->length; i++) vec->coeff[i]= a->coeff[i];
+
+    return vec;
+}
+
+void sws_printVec2(SwsVector *a, AVClass *log_ctx, int log_level)
+{
+    int i;
+    double max=0;
+    double min=0;
+    double range;
+
+    for (i=0; i<a->length; i++)
+        if (a->coeff[i]>max) max= a->coeff[i];
+
+    for (i=0; i<a->length; i++)
+        if (a->coeff[i]<min) min= a->coeff[i];
+
+    range= max - min;
+
+    for (i=0; i<a->length; i++) {
+        int x= (int)((a->coeff[i]-min)*60.0/range +0.5);
+        av_log(log_ctx, log_level, "%1.3f ", a->coeff[i]);
+        for (;x>0; x--) av_log(log_ctx, log_level, " ");
+        av_log(log_ctx, log_level, "|\n");
+    }
+}
+
+#if LIBSWSCALE_VERSION_MAJOR < 1
+void sws_printVec(SwsVector *a)
+{
+    sws_printVec2(a, NULL, AV_LOG_DEBUG);
+}
+#endif
+
+void sws_freeVec(SwsVector *a)
+{
+    if (!a) return;
+    av_freep(&a->coeff);
+    a->length=0;
+    av_free(a);
+}
+
+void sws_freeFilter(SwsFilter *filter)
+{
+    if (!filter) return;
+
+    if (filter->lumH) sws_freeVec(filter->lumH);
+    if (filter->lumV) sws_freeVec(filter->lumV);
+    if (filter->chrH) sws_freeVec(filter->chrH);
+    if (filter->chrV) sws_freeVec(filter->chrV);
+    av_free(filter);
+}
+
+void sws_freeContext(SwsContext *c)
+{
+    int i;
+    if (!c) return;
+
+    if (c->lumPixBuf) {
+        for (i=0; i<c->vLumBufSize; i++)
+            av_freep(&c->lumPixBuf[i]);
+        av_freep(&c->lumPixBuf);
+    }
+
+    if (c->chrPixBuf) {
+        for (i=0; i<c->vChrBufSize; i++)
+            av_freep(&c->chrPixBuf[i]);
+        av_freep(&c->chrPixBuf);
+    }
+
+    if (CONFIG_SWSCALE_ALPHA && c->alpPixBuf) {
+        for (i=0; i<c->vLumBufSize; i++)
+            av_freep(&c->alpPixBuf[i]);
+        av_freep(&c->alpPixBuf);
+    }
+
+    av_freep(&c->vLumFilter);
+    av_freep(&c->vChrFilter);
+    av_freep(&c->hLumFilter);
+    av_freep(&c->hChrFilter);
+#if ARCH_PPC && (HAVE_ALTIVEC || CONFIG_RUNTIME_CPUDETECT)
+    av_freep(&c->vYCoeffsBank);
+    av_freep(&c->vCCoeffsBank);
+#endif
+
+    av_freep(&c->vLumFilterPos);
+    av_freep(&c->vChrFilterPos);
+    av_freep(&c->hLumFilterPos);
+    av_freep(&c->hChrFilterPos);
+
+#if ARCH_X86 && CONFIG_GPL
+#ifdef MAP_ANONYMOUS
+    if (c->lumMmx2FilterCode) munmap(c->lumMmx2FilterCode, c->lumMmx2FilterCodeSize);
+    if (c->chrMmx2FilterCode) munmap(c->chrMmx2FilterCode, c->chrMmx2FilterCodeSize);
+#elif HAVE_VIRTUALALLOC
+    if (c->lumMmx2FilterCode) VirtualFree(c->lumMmx2FilterCode, c->lumMmx2FilterCodeSize, MEM_RELEASE);
+    if (c->chrMmx2FilterCode) VirtualFree(c->chrMmx2FilterCode, c->chrMmx2FilterCodeSize, MEM_RELEASE);
+#else
+    av_free(c->lumMmx2FilterCode);
+    av_free(c->chrMmx2FilterCode);
+#endif
+    c->lumMmx2FilterCode=NULL;
+    c->chrMmx2FilterCode=NULL;
+#endif /* ARCH_X86 && CONFIG_GPL */
+
+    av_freep(&c->yuvTable);
+
+    av_free(c);
+}
+
+struct SwsContext *sws_getCachedContext(struct SwsContext *context,
+                                        int srcW, int srcH, enum PixelFormat srcFormat,
+                                        int dstW, int dstH, enum PixelFormat dstFormat, int flags,
+                                        SwsFilter *srcFilter, SwsFilter *dstFilter, const double *param)
+{
+    static const double default_param[2] = {SWS_PARAM_DEFAULT, SWS_PARAM_DEFAULT};
+
+    if (!param)
+        param = default_param;
+
+    if (context &&
+        (context->srcW      != srcW      ||
+         context->srcH      != srcH      ||
+         context->srcFormat != srcFormat ||
+         context->dstW      != dstW      ||
+         context->dstH      != dstH      ||
+         context->dstFormat != dstFormat ||
+         context->flags     != flags     ||
+         context->param[0]  != param[0]  ||
+         context->param[1]  != param[1])) {
+        sws_freeContext(context);
+        context = NULL;
+    }
+
+    if (!context) {
+        return sws_getContext(srcW, srcH, srcFormat,
+                              dstW, dstH, dstFormat, flags,
+                              srcFilter, dstFilter, param);
+    }
+    return context;
+}
+

Modified: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libswscale/x86/yuv2rgb_mmx.c
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libswscale/x86/yuv2rgb_mmx.c	2010-05-26 05:26:42 UTC (rev 6237)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libswscale/x86/yuv2rgb_mmx.c	2010-05-26 05:26:46 UTC (rev 6238)
@@ -72,7 +72,8 @@
                 if (HAVE_7REGS) return yuva420_bgr32_MMX2;
                 break;
             } else return yuv420_bgr32_MMX2;
-        case PIX_FMT_BGR24:  return yuv420_rgb24_MMX2;
+        case PIX_FMT_RGB24:  return yuv420_rgb24_MMX2;
+        case PIX_FMT_BGR24:  return yuv420_bgr24_MMX2;
         case PIX_FMT_RGB565: return yuv420_rgb16_MMX2;
         case PIX_FMT_RGB555: return yuv420_rgb15_MMX2;
         }
@@ -89,7 +90,8 @@
                 if (HAVE_7REGS) return yuva420_bgr32_MMX;
                 break;
             } else return yuv420_bgr32_MMX;
-        case PIX_FMT_BGR24:  return yuv420_rgb24_MMX;
+        case PIX_FMT_RGB24:  return yuv420_rgb24_MMX;
+        case PIX_FMT_BGR24:  return yuv420_bgr24_MMX;
         case PIX_FMT_RGB565: return yuv420_rgb16_MMX;
         case PIX_FMT_RGB555: return yuv420_rgb15_MMX;
         }

Modified: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libswscale/x86/yuv2rgb_template.c
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libswscale/x86/yuv2rgb_template.c	2010-05-26 05:26:42 UTC (rev 6237)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libswscale/x86/yuv2rgb_template.c	2010-05-26 05:26:46 UTC (rev 6238)
@@ -42,7 +42,7 @@
 #define SFENCE "sfence"
 #else
 #define MOVNTQ "movq"
-#define SFENCE "/nop"
+#define SFENCE " # nop"
 #endif
 
 #define YUV2RGB \
@@ -134,9 +134,9 @@
     __asm__ volatile ("pxor %mm4, %mm4;" /* zero mm4 */ );    \
     for (y= 0; y<srcSliceH; y++ ) {                           \
         uint8_t *image = dst[0] + (y+srcSliceY)*dstStride[0]; \
-        uint8_t *py = src[0] + y*srcStride[0];                \
-        uint8_t *pu = src[1] + (y>>1)*srcStride[1];           \
-        uint8_t *pv = src[2] + (y>>1)*srcStride[2];           \
+        const uint8_t *py = src[0] + y*srcStride[0];          \
+        const uint8_t *pu = src[1] + (y>>1)*srcStride[1];     \
+        const uint8_t *pv = src[2] + (y>>1)*srcStride[2];     \
         x86_reg index= -h_size/2;                                \
 
 #define YUV2RGB_INIT                                                       \
@@ -168,7 +168,7 @@
         : "r" (pu - index), "r" (pv - index), "r"(&c->redDither), "r" (py - 2*index) \
         ); \
     } \
-    __asm__ volatile (EMMS); \
+    __asm__ volatile (SFENCE"\n\t"EMMS); \
     return srcSliceH; \
 
 #define YUV2RGB_OPERANDS_ALPHA \
@@ -176,10 +176,10 @@
         : "r" (pu - index), "r" (pv - index), "r"(&c->redDither), "r" (py - 2*index), "r" (pa - 2*index) \
         ); \
     } \
-    __asm__ volatile (EMMS); \
+    __asm__ volatile (SFENCE"\n\t"EMMS); \
     return srcSliceH; \
 
-static inline int RENAME(yuv420_rgb16)(SwsContext *c, uint8_t* src[], int srcStride[], int srcSliceY,
+static inline int RENAME(yuv420_rgb16)(SwsContext *c, const uint8_t* src[], int srcStride[], int srcSliceY,
                                        int srcSliceH, uint8_t* dst[], int dstStride[])
 {
     int y, h_size;
@@ -236,7 +236,7 @@
     YUV2RGB_OPERANDS
 }
 
-static inline int RENAME(yuv420_rgb15)(SwsContext *c, uint8_t* src[], int srcStride[], int srcSliceY,
+static inline int RENAME(yuv420_rgb15)(SwsContext *c, const uint8_t* src[], int srcStride[], int srcSliceY,
                                        int srcSliceH, uint8_t* dst[], int dstStride[])
 {
     int y, h_size;
@@ -295,7 +295,108 @@
     YUV2RGB_OPERANDS
 }
 
-static inline int RENAME(yuv420_rgb24)(SwsContext *c, uint8_t* src[], int srcStride[], int srcSliceY,
+#undef RGB_PLANAR2PACKED24
+#if HAVE_MMX2
+#define RGB_PLANAR2PACKED24(red, blue)\
+        "movq "MANGLE(ff_M24A)", %%mm4     \n\t"\
+        "movq "MANGLE(ff_M24C)", %%mm7     \n\t"\
+        "pshufw $0x50, %%mm"blue", %%mm5   \n\t" /* B3 B2 B3 B2  B1 B0 B1 B0 */\
+        "pshufw $0x50, %%mm2, %%mm3     \n\t" /* G3 G2 G3 G2  G1 G0 G1 G0 */\
+        "pshufw $0x00, %%mm"red", %%mm6 \n\t" /* R1 R0 R1 R0  R1 R0 R1 R0 */\
+\
+        "pand   %%mm4, %%mm5            \n\t" /*    B2        B1       B0 */\
+        "pand   %%mm4, %%mm3            \n\t" /*    G2        G1       G0 */\
+        "pand   %%mm7, %%mm6            \n\t" /*       R1        R0       */\
+\
+        "psllq     $8, %%mm3            \n\t" /* G2        G1       G0    */\
+        "por    %%mm5, %%mm6            \n\t"\
+        "por    %%mm3, %%mm6            \n\t"\
+        MOVNTQ" %%mm6, (%1)             \n\t"\
+\
+        "psrlq     $8, %%mm2            \n\t" /* 00 G7 G6 G5  G4 G3 G2 G1 */\
+        "pshufw $0xA5, %%mm"blue", %%mm5\n\t" /* B5 B4 B5 B4  B3 B2 B3 B2 */\
+        "pshufw $0x55, %%mm2, %%mm3     \n\t" /* G4 G3 G4 G3  G4 G3 G4 G3 */\
+        "pshufw $0xA5, %%mm"red", %%mm6 \n\t" /* R5 R4 R5 R4  R3 R2 R3 R2 */\
+\
+        "pand "MANGLE(ff_M24B)", %%mm5  \n\t" /* B5       B4        B3    */\
+        "pand          %%mm7, %%mm3     \n\t" /*       G4        G3       */\
+        "pand          %%mm4, %%mm6     \n\t" /*    R4        R3       R2 */\
+\
+        "por    %%mm5, %%mm3            \n\t" /* B5    G4 B4     G3 B3    */\
+        "por    %%mm3, %%mm6            \n\t"\
+        MOVNTQ" %%mm6, 8(%1)            \n\t"\
+\
+        "pshufw $0xFF, %%mm"blue", %%mm5\n\t" /* B7 B6 B7 B6  B7 B6 B6 B7 */\
+        "pshufw $0xFA, %%mm2, %%mm3     \n\t" /* 00 G7 00 G7  G6 G5 G6 G5 */\
+        "pshufw $0xFA, %%mm"red", %%mm6 \n\t" /* R7 R6 R7 R6  R5 R4 R5 R4 */\
+        "movd 4 (%2, %0), %%mm0;" /* Load 4 Cb 00 00 00 00 u3 u2 u1 u0 */\
+\
+        "pand          %%mm7, %%mm5     \n\t" /*       B7        B6       */\
+        "pand          %%mm4, %%mm3     \n\t" /*    G7        G6       G5 */\
+        "pand "MANGLE(ff_M24B)", %%mm6  \n\t" /* R7       R6        R5    */\
+        "movd 4 (%3, %0), %%mm1;" /* Load 4 Cr 00 00 00 00 v3 v2 v1 v0 */\
+\
+        "por          %%mm5, %%mm3      \n\t"\
+        "por          %%mm3, %%mm6      \n\t"\
+        MOVNTQ"       %%mm6, 16(%1)     \n\t"\
+        "movq 8 (%5, %0, 2), %%mm6;" /* Load 8 Y Y7 Y6 Y5 Y4 Y3 Y2 Y1 Y0 */\
+        "pxor         %%mm4, %%mm4      \n\t"
+#else
+#define RGB_PLANAR2PACKED24(red, blue)\
+        "pxor      %%mm4, %%mm4     \n\t"\
+        "movq      %%mm"blue", %%mm5\n\t" /* B */\
+        "movq      %%mm"red", %%mm6 \n\t" /* R */\
+        "punpcklbw %%mm2, %%mm"blue"\n\t" /* GBGBGBGB 0 */\
+        "punpcklbw %%mm4, %%mm"red" \n\t" /* 0R0R0R0R 0 */\
+        "punpckhbw %%mm2, %%mm5     \n\t" /* GBGBGBGB 2 */\
+        "punpckhbw %%mm4, %%mm6     \n\t" /* 0R0R0R0R 2 */\
+        "movq      %%mm"blue", %%mm7\n\t" /* GBGBGBGB 0 */\
+        "movq      %%mm5, %%mm3     \n\t" /* GBGBGBGB 2 */\
+        "punpcklwd %%mm"red", %%mm7 \n\t" /* 0RGB0RGB 0 */\
+        "punpckhwd %%mm"red", %%mm"blue"\n\t" /* 0RGB0RGB 1 */\
+        "punpcklwd %%mm6, %%mm5     \n\t" /* 0RGB0RGB 2 */\
+        "punpckhwd %%mm6, %%mm3     \n\t" /* 0RGB0RGB 3 */\
+\
+        "movq      %%mm7, %%mm2     \n\t" /* 0RGB0RGB 0 */\
+        "movq      %%mm"blue", %%mm6\n\t" /* 0RGB0RGB 1 */\
+        "movq      %%mm5, %%mm"red" \n\t" /* 0RGB0RGB 2 */\
+        "movq      %%mm3, %%mm4     \n\t" /* 0RGB0RGB 3 */\
+\
+        "psllq       $40, %%mm7     \n\t" /* RGB00000 0 */\
+        "psllq       $40, %%mm"blue"\n\t" /* RGB00000 1 */\
+        "psllq       $40, %%mm5     \n\t" /* RGB00000 2 */\
+        "psllq       $40, %%mm3     \n\t" /* RGB00000 3 */\
+\
+        "punpckhdq %%mm2, %%mm7     \n\t" /* 0RGBRGB0 0 */\
+        "punpckhdq %%mm6, %%mm"blue"\n\t" /* 0RGBRGB0 1 */\
+        "punpckhdq %%mm"red", %%mm5 \n\t" /* 0RGBRGB0 2 */\
+        "punpckhdq %%mm4, %%mm3     \n\t" /* 0RGBRGB0 3 */\
+\
+        "psrlq        $8, %%mm7     \n\t" /* 00RGBRGB 0 */\
+        "movq      %%mm"blue", %%mm6\n\t" /* 0RGBRGB0 1 */\
+        "psllq       $40, %%mm"blue"\n\t" /* GB000000 1 */\
+        "por       %%mm"blue", %%mm7\n\t" /* GBRGBRGB 0 */\
+        MOVNTQ"    %%mm7, (%1)      \n\t"\
+\
+        "psrlq       $24, %%mm6     \n\t" /* 0000RGBR 1 */\
+        "movq      %%mm5, %%mm"red" \n\t" /* 0RGBRGB0 2 */\
+        "psllq       $24, %%mm5     \n\t" /* BRGB0000 2 */\
+        "por       %%mm5, %%mm6     \n\t" /* BRGBRGBR 1 */\
+        MOVNTQ"    %%mm6, 8(%1)     \n\t"\
+\
+        "movq 8 (%5, %0, 2), %%mm6;" /* Load 8 Y Y7 Y6 Y5 Y4 Y3 Y2 Y1 Y0 */\
+\
+        "psrlq       $40, %%mm"red" \n\t" /* 000000RG 2 */\
+        "psllq        $8, %%mm3     \n\t" /* RGBRGB00 3 */\
+        "por       %%mm3, %%mm"red" \n\t" /* RGBRGBRG 2 */\
+        MOVNTQ"    %%mm"red", 16(%1)\n\t"\
+\
+        "movd 4 (%3, %0), %%mm1;" /* Load 4 Cr 00 00 00 00 v3 v2 v1 v0 */\
+        "movd 4 (%2, %0), %%mm0;" /* Load 4 Cb 00 00 00 00 u3 u2 u1 u0 */\
+        "pxor      %%mm4, %%mm4     \n\t"
+#endif
+
+static inline int RENAME(yuv420_rgb24)(SwsContext *c, const uint8_t* src[], int srcStride[], int srcSliceY,
                                        int srcSliceH, uint8_t* dst[], int dstStride[])
 {
     int y, h_size;
@@ -306,107 +407,25 @@
         YUV2RGB_INIT
         YUV2RGB
         /* mm0=B, %%mm2=G, %%mm1=R */
-#if HAVE_MMX2
-        "movq "MANGLE(ff_M24A)", %%mm4     \n\t"
-        "movq "MANGLE(ff_M24C)", %%mm7     \n\t"
-        "pshufw $0x50, %%mm0, %%mm5     \n\t" /* B3 B2 B3 B2  B1 B0 B1 B0 */
-        "pshufw $0x50, %%mm2, %%mm3     \n\t" /* G3 G2 G3 G2  G1 G0 G1 G0 */
-        "pshufw $0x00, %%mm1, %%mm6     \n\t" /* R1 R0 R1 R0  R1 R0 R1 R0 */
+        RGB_PLANAR2PACKED24("0", "1")
 
-        "pand   %%mm4, %%mm5            \n\t" /*    B2        B1       B0 */
-        "pand   %%mm4, %%mm3            \n\t" /*    G2        G1       G0 */
-        "pand   %%mm7, %%mm6            \n\t" /*       R1        R0       */
+    YUV2RGB_ENDLOOP(3)
+    YUV2RGB_OPERANDS
+}
 
-        "psllq     $8, %%mm3            \n\t" /* G2        G1       G0    */
-        "por    %%mm5, %%mm6            \n\t"
-        "por    %%mm3, %%mm6            \n\t"
-        MOVNTQ" %%mm6, (%1)             \n\t"
+static inline int RENAME(yuv420_bgr24)(SwsContext *c, const uint8_t* src[], int srcStride[], int srcSliceY,
+                                       int srcSliceH, uint8_t* dst[], int dstStride[])
+{
+    int y, h_size;
 
-        "psrlq     $8, %%mm2            \n\t" /* 00 G7 G6 G5  G4 G3 G2 G1 */
-        "pshufw $0xA5, %%mm0, %%mm5     \n\t" /* B5 B4 B5 B4  B3 B2 B3 B2 */
-        "pshufw $0x55, %%mm2, %%mm3     \n\t" /* G4 G3 G4 G3  G4 G3 G4 G3 */
-        "pshufw $0xA5, %%mm1, %%mm6     \n\t" /* R5 R4 R5 R4  R3 R2 R3 R2 */
+    YUV422_UNSHIFT
+    YUV2RGB_LOOP(3)
 
-        "pand "MANGLE(ff_M24B)", %%mm5     \n\t" /* B5       B4        B3    */
-        "pand          %%mm7, %%mm3     \n\t" /*       G4        G3       */
-        "pand          %%mm4, %%mm6     \n\t" /*    R4        R3       R2 */
+        YUV2RGB_INIT
+        YUV2RGB
+        /* mm0=B, %%mm2=G, %%mm1=R */
+        RGB_PLANAR2PACKED24("1", "0")
 
-        "por    %%mm5, %%mm3            \n\t" /* B5    G4 B4     G3 B3    */
-        "por    %%mm3, %%mm6            \n\t"
-        MOVNTQ" %%mm6, 8(%1)            \n\t"
-
-        "pshufw $0xFF, %%mm0, %%mm5     \n\t" /* B7 B6 B7 B6  B7 B6 B6 B7 */
-        "pshufw $0xFA, %%mm2, %%mm3     \n\t" /* 00 G7 00 G7  G6 G5 G6 G5 */
-        "pshufw $0xFA, %%mm1, %%mm6     \n\t" /* R7 R6 R7 R6  R5 R4 R5 R4 */
-        "movd 4 (%2, %0), %%mm0;" /* Load 4 Cb 00 00 00 00 u3 u2 u1 u0 */
-
-        "pand          %%mm7, %%mm5     \n\t" /*       B7        B6       */
-        "pand          %%mm4, %%mm3     \n\t" /*    G7        G6       G5 */
-        "pand "MANGLE(ff_M24B)", %%mm6     \n\t" /* R7       R6        R5    */
-        "movd 4 (%3, %0), %%mm1;" /* Load 4 Cr 00 00 00 00 v3 v2 v1 v0 */
-\
-        "por          %%mm5, %%mm3      \n\t"
-        "por          %%mm3, %%mm6      \n\t"
-        MOVNTQ"       %%mm6, 16(%1)     \n\t"
-        "movq 8 (%5, %0, 2), %%mm6;" /* Load 8 Y Y7 Y6 Y5 Y4 Y3 Y2 Y1 Y0 */
-        "pxor         %%mm4, %%mm4      \n\t"
-
-#else
-
-        "pxor      %%mm4, %%mm4     \n\t"
-        "movq      %%mm0, %%mm5     \n\t" /* B */
-        "movq      %%mm1, %%mm6     \n\t" /* R */
-        "punpcklbw %%mm2, %%mm0     \n\t" /* GBGBGBGB 0 */
-        "punpcklbw %%mm4, %%mm1     \n\t" /* 0R0R0R0R 0 */
-        "punpckhbw %%mm2, %%mm5     \n\t" /* GBGBGBGB 2 */
-        "punpckhbw %%mm4, %%mm6     \n\t" /* 0R0R0R0R 2 */
-        "movq      %%mm0, %%mm7     \n\t" /* GBGBGBGB 0 */
-        "movq      %%mm5, %%mm3     \n\t" /* GBGBGBGB 2 */
-        "punpcklwd %%mm1, %%mm7     \n\t" /* 0RGB0RGB 0 */
-        "punpckhwd %%mm1, %%mm0     \n\t" /* 0RGB0RGB 1 */
-        "punpcklwd %%mm6, %%mm5     \n\t" /* 0RGB0RGB 2 */
-        "punpckhwd %%mm6, %%mm3     \n\t" /* 0RGB0RGB 3 */
-
-        "movq      %%mm7, %%mm2     \n\t" /* 0RGB0RGB 0 */
-        "movq      %%mm0, %%mm6     \n\t" /* 0RGB0RGB 1 */
-        "movq      %%mm5, %%mm1     \n\t" /* 0RGB0RGB 2 */
-        "movq      %%mm3, %%mm4     \n\t" /* 0RGB0RGB 3 */
-
-        "psllq       $40, %%mm7     \n\t" /* RGB00000 0 */
-        "psllq       $40, %%mm0     \n\t" /* RGB00000 1 */
-        "psllq       $40, %%mm5     \n\t" /* RGB00000 2 */
-        "psllq       $40, %%mm3     \n\t" /* RGB00000 3 */
-
-        "punpckhdq %%mm2, %%mm7     \n\t" /* 0RGBRGB0 0 */
-        "punpckhdq %%mm6, %%mm0     \n\t" /* 0RGBRGB0 1 */
-        "punpckhdq %%mm1, %%mm5     \n\t" /* 0RGBRGB0 2 */
-        "punpckhdq %%mm4, %%mm3     \n\t" /* 0RGBRGB0 3 */
-
-        "psrlq        $8, %%mm7     \n\t" /* 00RGBRGB 0 */
-        "movq      %%mm0, %%mm6     \n\t" /* 0RGBRGB0 1 */
-        "psllq       $40, %%mm0     \n\t" /* GB000000 1 */
-        "por       %%mm0, %%mm7     \n\t" /* GBRGBRGB 0 */
-        MOVNTQ"    %%mm7, (%1)      \n\t"
-
-        "movd 4 (%2, %0), %%mm0;" /* Load 4 Cb 00 00 00 00 u3 u2 u1 u0 */
-
-        "psrlq       $24, %%mm6     \n\t" /* 0000RGBR 1 */
-        "movq      %%mm5, %%mm1     \n\t" /* 0RGBRGB0 2 */
-        "psllq       $24, %%mm5     \n\t" /* BRGB0000 2 */
-        "por       %%mm5, %%mm6     \n\t" /* BRGBRGBR 1 */
-        MOVNTQ"    %%mm6, 8(%1)     \n\t"
-
-        "movq 8 (%5, %0, 2), %%mm6;" /* Load 8 Y Y7 Y6 Y5 Y4 Y3 Y2 Y1 Y0 */
-
-        "psrlq       $40, %%mm1     \n\t" /* 000000RG 2 */
-        "psllq        $8, %%mm3     \n\t" /* RGBRGB00 3 */
-        "por       %%mm3, %%mm1     \n\t" /* RGBRGBRG 2 */
-        MOVNTQ"    %%mm1, 16(%1)    \n\t"
-
-        "movd 4 (%3, %0), %%mm1;" /* Load 4 Cr 00 00 00 00 v3 v2 v1 v0 */
-        "pxor      %%mm4, %%mm4     \n\t"
-#endif
-
     YUV2RGB_ENDLOOP(3)
     YUV2RGB_OPERANDS
 }
@@ -472,7 +491,7 @@
     "pxor         %%mm4, %%mm4;" /* zero mm4 */                         \
     "movq 8 (%5, %0, 2), %%mm6;" /* Load 8 Y Y7 Y6 Y5 Y4 Y3 Y2 Y1 Y0 */ \
 
-static inline int RENAME(yuv420_rgb32)(SwsContext *c, uint8_t* src[], int srcStride[], int srcSliceY,
+static inline int RENAME(yuv420_rgb32)(SwsContext *c, const uint8_t* src[], int srcStride[], int srcSliceY,
                                        int srcSliceH, uint8_t* dst[], int dstStride[])
 {
     int y, h_size;
@@ -489,7 +508,7 @@
     YUV2RGB_OPERANDS
 }
 
-static inline int RENAME(yuva420_rgb32)(SwsContext *c, uint8_t* src[], int srcStride[], int srcSliceY,
+static inline int RENAME(yuva420_rgb32)(SwsContext *c, const uint8_t* src[], int srcStride[], int srcSliceY,
                                         int srcSliceH, uint8_t* dst[], int dstStride[])
 {
 #if HAVE_7REGS
@@ -497,7 +516,7 @@
 
     YUV2RGB_LOOP(4)
 
-        uint8_t *pa = src[3] + y*srcStride[3];
+        const uint8_t *pa = src[3] + y*srcStride[3];
         YUV2RGB_INIT
         YUV2RGB
         "movq     (%6, %0, 2), %%mm3;"            /* Load 8 A A7 A6 A5 A4 A3 A2 A1 A0 */
@@ -533,7 +552,7 @@
 
     YUV2RGB_LOOP(4)
 
-        uint8_t *pa = src[3] + y*srcStride[3];
+        const uint8_t *pa = src[3] + y*srcStride[3];
         YUV2RGB_INIT
         YUV2RGB
         "movq     (%6, %0, 2), %%mm3;"            /* Load 8 A A7 A6 A5 A4 A3 A2 A1 A0 */

Modified: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libswscale/yuv2rgb.c
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libswscale/yuv2rgb.c	2010-05-26 05:26:42 UTC (rev 6237)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libswscale/yuv2rgb.c	2010-05-26 05:26:46 UTC (rev 6238)
@@ -49,6 +49,13 @@
     {117579, 136230, 16907, 35559}  /* SMPTE 240M (1987) */
 };
 
+const int * sws_getCoefficients(int colorspace)
+{
+    if (colorspace > 7 || colorspace < 0)
+        colorspace = SWS_CS_DEFAULT;
+    return ff_yuv2rgb_coeffs[colorspace];
+}
+
 #define LOADCHROMA(i)                               \
     U = pu[i];                                      \
     V = pv[i];                                      \
@@ -91,7 +98,7 @@
     dst[12*i+10] = dst[12*i+11] = b[Y];
 
 #define YUV2RGBFUNC(func_name, dst_type, alpha) \
-static int func_name(SwsContext *c, uint8_t* src[], int srcStride[], int srcSliceY, \
+static int func_name(SwsContext *c, const uint8_t* src[], int srcStride[], int srcSliceY, \
                      int srcSliceH, uint8_t* dst[], int dstStride[]) \
 {\
     int y;\
@@ -105,11 +112,11 @@
         dst_type *dst_2 = (dst_type*)(dst[0] + (y+srcSliceY+1)*dstStride[0]);\
         dst_type av_unused *r, *b;\
         dst_type *g;\
-        uint8_t *py_1 = src[0] + y*srcStride[0];\
-        uint8_t *py_2 = py_1 + srcStride[0];\
-        uint8_t *pu = src[1] + (y>>1)*srcStride[1];\
-        uint8_t *pv = src[2] + (y>>1)*srcStride[2];\
-        uint8_t av_unused *pa_1, *pa_2;\
+        const uint8_t *py_1 = src[0] + y*srcStride[0];\
+        const uint8_t *py_2 = py_1 + srcStride[0];\
+        const uint8_t *pu = src[1] + (y>>1)*srcStride[1];\
+        const uint8_t *pv = src[2] + (y>>1)*srcStride[2];\
+        const uint8_t av_unused *pa_1, *pa_2;\
         unsigned int h_size = c->dstW>>3;\
         if (alpha) {\
             pa_1 = src[3] + y*srcStride[3];\
@@ -321,6 +328,7 @@
     PUTRGB(dst_1,py_1,3);
 CLOSEYUV2RGBFUNC(8)
 
+#if 0 // Currently unused
 // This is exactly the same code as yuv2rgb_c_32 except for the types of
 // r, g, b, dst_1, dst_2
 YUV2RGBFUNC(yuv2rgb_c_8, uint8_t, 0)
@@ -340,6 +348,7 @@
     PUTRGB(dst_2,py_2,3);
     PUTRGB(dst_1,py_1,3);
 CLOSEYUV2RGBFUNC(8)
+#endif
 
 // r, g, b, dst_1, dst_2
 YUV2RGBFUNC(yuv2rgb_c_8_ordered_dither, uint8_t, 0)
@@ -368,7 +377,7 @@
     PUTRGB8(dst_1,py_1,3,6);
 CLOSEYUV2RGBFUNC(8)
 
-
+#if 0 // Currently unused
 // This is exactly the same code as yuv2rgb_c_32 except for the types of
 // r, g, b, dst_1, dst_2
 YUV2RGBFUNC(yuv2rgb_c_4, uint8_t, 0)
@@ -396,6 +405,7 @@
     PUTRGB4(dst_2,py_2,3);
     PUTRGB4(dst_1,py_1,3);
 CLOSEYUV2RGBFUNC(4)
+#endif
 
 YUV2RGBFUNC(yuv2rgb_c_4_ordered_dither, uint8_t, 0)
     const uint8_t *d64 =  dither_8x8_73[y&7];
@@ -426,6 +436,7 @@
     PUTRGB4D(dst_1,py_1,3,6);
 CLOSEYUV2RGBFUNC(4)
 
+#if 0 // Currently unused
 // This is exactly the same code as yuv2rgb_c_32 except for the types of
 // r, g, b, dst_1, dst_2
 YUV2RGBFUNC(yuv2rgb_c_4b, uint8_t, 0)
@@ -445,6 +456,7 @@
     PUTRGB(dst_2,py_2,3);
     PUTRGB(dst_1,py_1,3);
 CLOSEYUV2RGBFUNC(8)
+#endif
 
 YUV2RGBFUNC(yuv2rgb_c_4b_ordered_dither, uint8_t, 0)
     const uint8_t *d64 =  dither_8x8_73[y&7];
@@ -525,7 +537,7 @@
     if (t)
         return t;
 
-    av_log(c, AV_LOG_WARNING, "No accelerated colorspace conversion found.\n");
+    av_log(c, AV_LOG_WARNING, "No accelerated colorspace conversion found from %s to %s.\n", sws_format_name(c->srcFormat), sws_format_name(c->dstFormat));
 
     switch (c->dstFormat) {
     case PIX_FMT_RGB48BE:
@@ -590,7 +602,7 @@
                         || c->dstFormat==PIX_FMT_RGB4
                         || c->dstFormat==PIX_FMT_RGB4_BYTE
                         || c->dstFormat==PIX_FMT_MONOBLACK;
-    const int bpp = fmt_depth(c->dstFormat);
+    const int bpp = c->dstFormatBpp;
     uint8_t *y_table;
     uint16_t *y_table16;
     uint32_t *y_table32;



From mean at mail.berlios.de  Wed May 26 07:26:52 2010
From: mean at mail.berlios.de (mean at BerliOS)
Date: Wed, 26 May 2010 07:26:52 +0200
Subject: [Avidemux-svn-commit] r6239 - in
	branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg: .
	ffmpeg_config
Message-ID: <201005260526.o4Q5QqAu029351@sheep.berlios.de>

Author: mean
Date: 2010-05-26 07:26:51 +0200 (Wed, 26 May 2010)
New Revision: 6239

Modified:
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/ADM_lavcodec.h
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/ffmpeg_config/config.h
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/ffmpeg_config/ffconf.c
Log:
[ffmpeg] Merge

Modified: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/ADM_lavcodec.h
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/ADM_lavcodec.h	2010-05-26 05:26:46 UTC (rev 6238)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/ADM_lavcodec.h	2010-05-26 05:26:51 UTC (rev 6239)
@@ -18,7 +18,8 @@
   #define  __ADM_LAVC
   extern "C"
   {  
-  #define __STDC_CONSTANT_MACROS // Lavcodec crap
+  #define __STDC_CONSTANT_MACROS  1 // Lavcodec crap
+  #define __STDC_LIMIT_MACROS 1
   #include "ADM_ffmpeg/libavcodec/avcodec.h"
   };
 #endif

Modified: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/ffmpeg_config/config.h
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/ffmpeg_config/config.h	2010-05-26 05:26:46 UTC (rev 6238)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/ffmpeg_config/config.h	2010-05-26 05:26:51 UTC (rev 6239)
@@ -4,6 +4,11 @@
 #define CONFIG_MPEG4_VAAPI_HWACCEL 0
 #define CONFIG_VC1_VAAPI_HWACCEL 0
 #define CONFIG_WMV3_VAAPI_HWACCEL 0
+#define CONFIG_H264_DXVA2_HWACCEL 0
+#define CONFIG_H264_VAAPI_HWACCEL 0
+#define CONFIG_VC1_DXVA2_HWACCEL 0
+#define CONFIG_VC1_DXVA2_HWACCEL 0
+#define CONFIG_WMV3_DXVA2_HWACCEL 0
 #ifdef USE_VDPAU
 #define CONFIG_H264_VDPAU_DECODER 1
 #define CONFIG_MPEG_VDPAU_DECODER 1
@@ -17,6 +22,13 @@
 #define CONFIG_VC1_VDPAU_DECODER 0
 #define CONFIG_WMV3_VDPAU_DECODER 0
 #endif // 
+#define CONFIG_MPEG4_VDPAU_DECODER 0
+#ifdef HAVE_MALLOC_H
+#undef HAVE_MALLOC_H 
+#define HAVE_MALLOC_H 1
+#else // HAVE_MALLOC_H
+#define HAVE_MALLOC_H 0
+#endif// HAVE_MALLOC_H
 #define CONFIG_SVQ1_DECODER 1
 #define CONFIG_AAC_DECODER 1
 #define CONFIG_MPEG4AAC_DECODER 1
@@ -70,6 +82,38 @@
 #define CONFIG_FLV_DECODER 1
 #define CONFIG_SNOW_DECODER 1
 #define CONFIG_AMV_DECODER 1
+#define CONFIG_INDEO5_DECODER 1
+#define CONFIG_MP1FLOAT_DECODER 1
+#define CONFIG_MP2FLOAT_DECODER 1
+#define CONFIG_MP3FLOAT_DECODER 1
+#define CONFIG_INDEO5_DECODER 1
+#define CONFIG_INDEO5_DECODER 1
+#define CONFIG_MP3ADUFLOAT_DECODER 0
+#define CONFIG_MP3ON4FLOAT_DECODER 0
+#define CONFIG_CDGRAPHICS_DECODER 0
+#define CONFIG_ANM_DECODER 0
+#define CONFIG_AURA_DECODER 0
+#define CONFIG_AURA2_DECODER 0
+#define CONFIG_BINK_DECODER 0
+#define CONFIG_FRWU_DECODER 0
+#define CONFIG_IFF_BYTERUN1_DECODER 0
+#define CONFIG_IFF_ILBM_DECODER 0
+#define CONFIG_KGV1_DECODER 0
+#define CONFIG_R210_DECODER 0
+#define CONFIG_YOP_DECODER 0
+#define CONFIG_KGV1_DECODER 0
+#define CONFIG_ALS_DECODER 0
+#define CONFIG_AMRNB_DECODER 0
+#define CONFIG_ATRAC1_DECODER 0
+#define CONFIG_BINKAUDIO_DCT_DECODER 0
+#define CONFIG_BINKAUDIO_RDFT_DECODER 0
+#define CONFIG_ATRAC1_DECODER 0
+#define CONFIG_SIPR_DECODER 0
+#define CONFIG_TWINVQ_DECODER 0
+#define CONFIG_WMAPRO_DECODER 0
+#define CONFIG_WMAVOICE_DECODER 0
+#define CONFIG_PCM_BLURAY_DECODER 0
+#define CONFIG_PGSSUB_DECODER 0
 #define CONFIG_DPX_DECODER 0
 #define CONFIG_EAMAD_DECODER 0
 #define CONFIG_TMV_DECODER 0
@@ -387,6 +431,7 @@
 #define CONFIG_ADPCM_YAMAHA_ENCODER 0
 #define CONFIG_DVDSUB_ENCODER 0
 #define CONFIG_LIBVORBIS_ENCODER 0
+#define CONFIG_CHOMP_BSF 0
 #define CONFIG_AAC_ADTSTOASC_BSF 0
 #define CONFIG_MP3_HEADER_COMPRESS_BSF 0
 #define CONFIG_IMX_DUMP_HEADER_BSF 0
@@ -451,9 +496,11 @@
 #	define ARCH_X86 1
 #	define ARCH_X86_32 1
 #	define ARCH_X86_64 0
+#	define HAVE_ALTIVEC 0
 #elif defined(ADM_CPU_X86_64)
 #	define ARCH_X86 1
 #	define ARCH_X86_64 1
+#	define HAVE_ALTIVEC 0
 #elif defined(ADM_CPU_PPC)
 #	define ARCH_POWERPC 1
 #ifdef ADM_CPU_ALTIVEC

Modified: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/ffmpeg_config/ffconf.c
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/ffmpeg_config/ffconf.c	2010-05-26 05:26:46 UTC (rev 6238)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/ffmpeg_config/ffconf.c	2010-05-26 05:26:51 UTC (rev 6239)
@@ -16,6 +16,12 @@
     DECLARE_HW(MPEG4_VAAPI,nellymoser);
     DECLARE_HW(VC1_VAAPI,nellymoser);
     DECLARE_HW(WMV3_VAAPI,nellymoser);
+//
+    DECLARE_HW(H264_DXVA2,nellymoser);
+    DECLARE_HW(H264_VAAPI,nellymoser);
+    DECLARE_HW(VC1_DXVA2,nellymoser);
+    DECLARE_HW(VC1_DXVA2,nellymoser);
+    DECLARE_HW(WMV3_DXVA2,nellymoser);
 
 #define DECLARE_VDPAU(a,b); printf("#define CONFIG_"#a"_VDPAU_DECODER 1\n");
         printf("#ifdef USE_VDPAU\n");
@@ -31,7 +37,14 @@
         printf("#define CONFIG_VC1_VDPAU_DECODER 0\n");
         printf("#define CONFIG_WMV3_VDPAU_DECODER 0\n");
         printf("#endif // \n");
+        printf("#define CONFIG_MPEG4_VDPAU_DECODER 0\n");
         
+        printf("#ifdef HAVE_MALLOC_H\n");
+        printf("#undef HAVE_MALLOC_H \n");
+        printf("#define HAVE_MALLOC_H 1\n");
+        printf("#else // HAVE_MALLOC_H\n");
+        printf("#define HAVE_MALLOC_H 0\n");
+        printf("#endif// HAVE_MALLOC_H\n");
 
 #undef DECLARE_VDPAU
 #define DECLARE_VDPAU(a,b); printf("#define CONFIG_"#a"_VDPAU_DECODER 0\n");
@@ -92,9 +105,42 @@
     DECLARE_DECODER (FLV, flv);
     DECLARE_DECODER (SNOW, snow);
     DECLARE_DECODER (AMV, amv);
+    DECLARE_DECODER (INDEO5, indeo5);
+    DECLARE_DECODER (MP1FLOAT, indeo5);
+    DECLARE_DECODER (MP2FLOAT, indeo5);
+    DECLARE_DECODER (MP3FLOAT, indeo5);
+    DECLARE_DECODER (INDEO5, indeo5);
+    DECLARE_DECODER (INDEO5, indeo5);
 #undef DECLARE_DECODER
 #define DECLARE_DECODER(a,b); printf("#define CONFIG_"#a"_DECODER 0\n"); 
 
+    DECLARE_DECODER (MP3ADUFLOAT, indeo5);
+    DECLARE_DECODER (MP3ON4FLOAT, indeo5);
+    DECLARE_DECODER(CDGRAPHICS, eatgq);
+    DECLARE_DECODER(ANM, eatgq);
+    DECLARE_DECODER(AURA, eatgq);
+    DECLARE_DECODER(AURA2, eatgq);
+    DECLARE_DECODER(BINK, eatgq);
+    DECLARE_DECODER(FRWU, eatgq);
+    DECLARE_DECODER(IFF_BYTERUN1, eatgq);
+    DECLARE_DECODER(IFF_ILBM, eatgq);
+    DECLARE_DECODER(KGV1, eatgq);
+    DECLARE_DECODER(R210, eatgq);
+    DECLARE_DECODER(YOP, eatgq);
+    DECLARE_DECODER(KGV1, eatgq);
+    DECLARE_DECODER(ALS, eatgq);
+    DECLARE_DECODER(AMRNB, eatgq);
+    DECLARE_DECODER(ATRAC1, eatgq);
+    DECLARE_DECODER(BINKAUDIO_DCT, eatgq);
+    DECLARE_DECODER(BINKAUDIO_RDFT, eatgq);
+    DECLARE_DECODER(ATRAC1, eatgq);
+    DECLARE_DECODER(SIPR, eatgq);
+    DECLARE_DECODER(TWINVQ, eatgq);
+    DECLARE_DECODER(WMAPRO, eatgq);
+    DECLARE_DECODER(WMAVOICE, eatgq);
+    DECLARE_DECODER(PCM_BLURAY, eatgq);
+    DECLARE_DECODER(PGSSUB, eatgq);
+//
     DECLARE_DECODER(DPX, eatgq);
     DECLARE_DECODER(EAMAD, eatgq);
     DECLARE_DECODER(TMV, eatgq);
@@ -438,6 +484,7 @@
 
 #define DECLARE_BSF(a,b); printf("#define CONFIG_"#a"_BSF 0\n");
 
+	DECLARE_BSF(CHOMP, mp3_header_compress);
 	DECLARE_BSF(AAC_ADTSTOASC, mp3_header_compress);
 	DECLARE_BSF(MP3_HEADER_COMPRESS, mp3_header_compress);
 	DECLARE_BSF(IMX_DUMP_HEADER, imx_dump_header);
@@ -519,9 +566,11 @@
 	printf("#	define ARCH_X86 1\n");
 	printf("#	define ARCH_X86_32 1\n");
 	printf("#	define ARCH_X86_64 0\n");
+	printf("#	define HAVE_ALTIVEC 0\n");
 	printf("#elif defined(ADM_CPU_X86_64)\n");
 	printf("#	define ARCH_X86 1\n");
 	printf("#	define ARCH_X86_64 1\n");
+	printf("#	define HAVE_ALTIVEC 0\n");
 	printf("#elif defined(ADM_CPU_PPC)\n");
 	printf("#	define ARCH_POWERPC 1\n");
 	printf("#ifdef ADM_CPU_ALTIVEC\n");



From mean at mail.berlios.de  Wed May 26 07:26:54 2010
From: mean at mail.berlios.de (mean at BerliOS)
Date: Wed, 26 May 2010 07:26:54 +0200
Subject: [Avidemux-svn-commit] r6240 - in
	branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg:
	libavcodec patches
Message-ID: <201005260526.o4Q5Qsan029551@sheep.berlios.de>

Author: mean
Date: 2010-05-26 07:26:53 +0200 (Wed, 26 May 2010)
New Revision: 6240

Modified:
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavcodec/h264.c
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavcodec_h264.c.patch
Log:
[merge] Lavcodec

Modified: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavcodec/h264.c
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavcodec/h264.c	2010-05-26 05:26:51 UTC (rev 6239)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavcodec/h264.c	2010-05-26 05:26:53 UTC (rev 6240)
@@ -3358,7 +3358,18 @@
     return 0;
 }
 
+/* MEANX */
+int av_getAVCStreamInfo(AVCodecContext *avctx, uint32_t  *nalSize, uint32_t *isAvc)
+{
+      H264Context *h = avctx->priv_data;
+      assert(h);
+      *nalSize=h->nal_length_size;
+      *isAvc=h->is_avc;
+	return 1;
 
+  }
+/* MeanX */
+
 AVCodec h264_decoder = {
     "h264",
     AVMEDIA_TYPE_VIDEO,

Modified: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavcodec_h264.c.patch
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavcodec_h264.c.patch	2010-05-26 05:26:51 UTC (rev 6239)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavcodec_h264.c.patch	2010-05-26 05:26:53 UTC (rev 6240)
@@ -1,22 +1,22 @@
-diff --git a/avidemux_core/ADM_ffmpeg/libavcodec/h264.c b/avidemux_core/ADM_ffmpeg/libavcodec/h264.c
-index e4654f0..cfab425 100644
---- a/avidemux_core/ADM_ffmpeg/libavcodec/h264.c
-+++ b/avidemux_core/ADM_ffmpeg/libavcodec/h264.c
-@@ -3358,6 +3358,17 @@ av_cold int ff_h264_decode_end(AVCodecContext *avctx)
-     return 0;
- }
- 
-+/* MEANX */
-+int av_getAVCStreamInfo(AVCodecContext *avctx, uint32_t  *nalSize, uint32_t *isAvc)
-+{
-+      H264Context *h = avctx->priv_data;
-+      assert(h);
-+      *nalSize=h->nal_length_size;
-+      *isAvc=h->is_avc;
-+	return 1;
-+
-+  }
-+/* MeanX */
- 
- AVCodec h264_decoder = {
-     "h264",
+[1mdiff --git a/avidemux_core/ADM_ffmpeg/libavcodec/h264.c b/avidemux_core/ADM_ffmpeg/libavcodec/h264.c[m
+[1mindex e4654f0..cfab425 100644[m
+[1m--- a/avidemux_core/ADM_ffmpeg/libavcodec/h264.c[m
+[1m+++ b/avidemux_core/ADM_ffmpeg/libavcodec/h264.c[m
+[36m@@ -3358,6 +3358,17 @@[m [mav_cold int ff_h264_decode_end(AVCodecContext *avctx)[m
+     return 0;[m
+ }[m
+ [m
+[32m+[m[32m/* MEANX */[m
+[32m+[m[32mint av_getAVCStreamInfo(AVCodecContext *avctx, uint32_t  *nalSize, uint32_t *isAvc)[m
+[32m+[m[32m{[m
+[32m+[m[32m      H264Context *h = avctx->priv_data;[m
+[32m+[m[32m      assert(h);[m
+[32m+[m[32m      *nalSize=h->nal_length_size;[m
+[32m+[m[32m      *isAvc=h->is_avc;[m
+[32m+[m	[32mreturn 1;[m
+[32m+[m
+[32m+[m[32m  }[m
+[32m+[m[32m/* MeanX */[m
+ [m
+ AVCodec h264_decoder = {[m
+     "h264",[m



From mean at mail.berlios.de  Wed May 26 07:26:57 2010
From: mean at mail.berlios.de (mean at BerliOS)
Date: Wed, 26 May 2010 07:26:57 +0200
Subject: [Avidemux-svn-commit] r6241 - in
	branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg:
	libavcodec patches
Message-ID: <201005260526.o4Q5Qvrc029639@sheep.berlios.de>

Author: mean
Date: 2010-05-26 07:26:56 +0200 (Wed, 26 May 2010)
New Revision: 6241

Added:
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavcodec_h264dsp.c.patch
Modified:
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavcodec/h264dsp.c
Log:
[merge] Lavcodec

Modified: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavcodec/h264dsp.c
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavcodec/h264dsp.c	2010-05-26 05:26:53 UTC (rev 6240)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavcodec/h264dsp.c	2010-05-26 05:26:56 UTC (rev 6241)
@@ -316,5 +316,7 @@
 
     if (ARCH_ARM) ff_h264dsp_init_arm(c);
     if (HAVE_ALTIVEC) ff_h264dsp_init_ppc(c);
+#if CONFIG_H264DSP //MEANX
     if (HAVE_MMX) ff_h264dsp_init_x86(c);
+#endif
 }

Added: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavcodec_h264dsp.c.patch
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavcodec_h264dsp.c.patch	2010-05-26 05:26:53 UTC (rev 6240)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavcodec_h264dsp.c.patch	2010-05-26 05:26:56 UTC (rev 6241)
@@ -0,0 +1,12 @@
+diff --git a/avidemux_core/ADM_ffmpeg/libavcodec/h264dsp.c b/avidemux_core/ADM_ffmpeg/libavcodec/h264dsp.c
+index c01fc77..0fe9f40 100644
+--- a/avidemux_core/ADM_ffmpeg/libavcodec/h264dsp.c
++++ b/avidemux_core/ADM_ffmpeg/libavcodec/h264dsp.c
+@@ -316,5 +316,7 @@ void ff_h264dsp_init(H264DSPContext *c)
+ 
+     if (ARCH_ARM) ff_h264dsp_init_arm(c);
+     if (HAVE_ALTIVEC) ff_h264dsp_init_ppc(c);
++#if CONFIG_H264DSP //MEANX
+     if (HAVE_MMX) ff_h264dsp_init_x86(c);
++#endif
+ }



From mean at mail.berlios.de  Wed May 26 07:27:06 2010
From: mean at mail.berlios.de (mean at BerliOS)
Date: Wed, 26 May 2010 07:27:06 +0200
Subject: [Avidemux-svn-commit] r6243 - in
	branches/avidemux_2.6_branch_mean/avidemux/common: . ADM_editor
Message-ID: <201005260527.o4Q5R6HB029897@sheep.berlios.de>

Author: mean
Date: 2010-05-26 07:27:05 +0200 (Wed, 26 May 2010)
New Revision: 6243

Modified:
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_editor/ADM_edLoadSave.cpp
   branches/avidemux_2.6_branch_mean/avidemux/common/main.cpp
Log:
[main] Merge effect

Modified: branches/avidemux_2.6_branch_mean/avidemux/common/ADM_editor/ADM_edLoadSave.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/ADM_editor/ADM_edLoadSave.cpp	2010-05-26 05:26:59 UTC (rev 6242)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/ADM_editor/ADM_edLoadSave.cpp	2010-05-26 05:27:05 UTC (rev 6243)
@@ -34,6 +34,7 @@
 #include "GUI_ui.h"
 #include "ADM_videoFilters.h"
 #include "ADM_videoFilterApi.h"
+#include "errno.h"
 /**
     \fn dumpConf
     \brief dump configuration as name=value pairs

Modified: branches/avidemux_2.6_branch_mean/avidemux/common/main.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/main.cpp	2010-05-26 05:26:59 UTC (rev 6242)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/main.cpp	2010-05-26 05:27:05 UTC (rev 6243)
@@ -32,6 +32,7 @@
 
 #include "prefs.h"
 #include "audio_out.h"
+#include "ADM_assert.h"
 
 extern void  ADM_lavInit();
 extern void  ADM_lavDestroy();



From mean at mail.berlios.de  Wed May 26 07:27:11 2010
From: mean at mail.berlios.de (mean at BerliOS)
Date: Wed, 26 May 2010 07:27:11 +0200
Subject: [Avidemux-svn-commit] r6244 - in
	branches/avidemux_2.6_branch_mean/avidemux_core:
	ADM_core/include ADM_core/src ADM_coreAudioParser/src
	ADM_coreImage/include ADM_coreImage/src ADM_coreMuxer/src
	ADM_coreUtils/src ADM_coreVideoEncoder/src ADM_coreVideoFilter/src
Message-ID: <201005260527.o4Q5RBnK030381@sheep.berlios.de>

Author: mean
Date: 2010-05-26 07:27:08 +0200 (Wed, 26 May 2010)
New Revision: 6244

Modified:
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_core/include/ADM_mangle.h
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_core/src/ADM_cpuCap.cpp
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_core/src/ADM_memcpy.cpp
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreAudioParser/src/ADM_dcainfo.cpp
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreAudioParser/src/ADM_eac3info.cpp
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreImage/include/ADM_pp.h
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreImage/src/ADM_colorspace.cpp
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreImage/src/ADM_imageResizer.cpp
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreImage/src/ADM_imageSave.cpp
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreImage/src/ADM_pp.cpp
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreMuxer/src/ADM_coreMuxerFfmpeg.cpp
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreMuxer/src/ADM_dynaMuxer.cpp
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreMuxer/src/ADM_muxerUtils.cpp
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreUtils/src/ADM_coreCodecMapping.cpp
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreUtils/src/ADM_infoExtractor.cpp
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreUtils/src/ADM_infoExtractorH264.cpp
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreUtils/src/ADM_paramList.cpp
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreVideoEncoder/src/ADM_coreVideoEncoder.cpp
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreVideoFilter/src/DIA_flyDialog.cpp
Log:
[ffmpeg merge] Effect on core

Modified: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_core/include/ADM_mangle.h
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_core/include/ADM_mangle.h	2010-05-26 05:27:05 UTC (rev 6243)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_core/include/ADM_mangle.h	2010-05-26 05:27:08 UTC (rev 6244)
@@ -20,9 +20,11 @@
     defined(__OS2__) || (defined (__OpenBSD__) && !defined(__ELF__))
 #    if defined(ADM_CPU_X86_64) && defined(PIC) && !defined(__MINGW32__)
 #        define MANGLE(a) "_" #a"(%%rip)"
+#        define LOCAL_MANGLE(a) #a"(%%rip)"
 #        define FUNNY_MANGLE(x) x asm(MANGLE(x))
 #        define FUNNY_MANGLE_ARRAY(x, y) x[y] asm(MANGLE(x))
 #    else
+#        define LOCAL_MANGLE(a) #a
 #        define MANGLE(a) "_" #a
 #        define FUNNY_MANGLE(x) x asm(MANGLE(x))
 #        define FUNNY_MANGLE_ARRAY(x, y) x[y] asm(MANGLE(x))
@@ -30,10 +32,12 @@
 #else
 #    if defined(ADM_CPU_X86_64) && defined(PIC)
 #        define MANGLE(a) #a"(%%rip)"
+#        define LOCAL_MANGLE(a) #a"(%%rip)"
 #        define FUNNY_MANGLE(x) x asm(#x)
 #        define FUNNY_MANGLE_ARRAY(x, y)  x[y] asm(#x)
 #    elif defined(__APPLE__)
 #        define MANGLE(a) "_" #a
+#        define LOCAL_MANGLE(a) #a"(%%rip)"
 #        define FUNNY_MANGLE(x) x asm(MANGLE(x))
 #        define FUNNY_MANGLE_ARRAY(x, y) x[y] asm(MANGLE(x))
 #    else

Modified: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_core/src/ADM_cpuCap.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_core/src/ADM_cpuCap.cpp	2010-05-26 05:27:05 UTC (rev 6243)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_core/src/ADM_cpuCap.cpp	2010-05-26 05:27:08 UTC (rev 6244)
@@ -9,6 +9,10 @@
 // Copyright: See COPYING file that comes with this distribution
 //
 //
+#include "ADM_coreConfig.h"
+#ifdef ADM_CPU_X86
+#include "ADM_lavcodec.h"
+#endif
 #include "ADM_default.h"
 
 #if defined(__MINGW32__)
@@ -34,12 +38,6 @@
 }
 
 
-#ifdef ADM_CPU_X86
-extern "C" 
-{
-#include "ADM_ffmpeg/libavcodec/avcodec.h"
-}
-#endif
 
 #define cpuid(index,eax,ebx,ecx,edx)\
     __asm __volatile\

Modified: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_core/src/ADM_memcpy.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_core/src/ADM_memcpy.cpp	2010-05-26 05:27:05 UTC (rev 6243)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_core/src/ADM_memcpy.cpp	2010-05-26 05:27:08 UTC (rev 6244)
@@ -33,13 +33,10 @@
 #include <stdio.h>
 #include <stdlib.h>
 #include <string.h>
-
+#include "ADM_coreConfig.h"
+#include "ADM_lavcodec.h"
 #include "ADM_default.h"
 
-extern "C"
-{
-	#include "ADM_ffmpeg/libavcodec/avcodec.h"
-
 adm_fast_memcpy myAdmMemcpy=NULL;
 /* Original comments from mplayer (file: aclib.c)
  This part of code was taken by me from Linux-2.4.3 and slightly modified
@@ -436,7 +433,7 @@
 	stop=rdtsc();
 	ADM_dealloc(src);
 	ADM_dealloc(dst);
-	printf("Method :%s \tTime:%"LLU"\n",name,stop-start);
+	printf("Method :%s \tTime:%lu\n",name,(unsigned long int)name,stop-start);
 	return 1;
 
 }
@@ -445,7 +442,7 @@
 	It seems MMX gives the best result most of the times
 	Don't bother benchmarking
 */
-uint8_t ADM_InitMemcpy(void)
+extern "C" uint8_t ADM_InitMemcpy(void)
 {
   uint64_t          t;
   char             *buf1, *buf2;
@@ -468,4 +465,3 @@
 #endif
 	return 1;
 }
-}

Modified: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreAudioParser/src/ADM_dcainfo.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreAudioParser/src/ADM_dcainfo.cpp	2010-05-26 05:27:05 UTC (rev 6243)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreAudioParser/src/ADM_dcainfo.cpp	2010-05-26 05:27:08 UTC (rev 6244)
@@ -14,7 +14,7 @@
  *   (at your option) any later version.                                   *
  *                                                                         *
  ***************************************************************************/
-
+#include "ADM_includeFfmpeg.h"
 #include "ADM_default.h"
 #include "ADM_dcainfo.h"
 #define ADM_NO_CONFIG_H

Modified: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreAudioParser/src/ADM_eac3info.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreAudioParser/src/ADM_eac3info.cpp	2010-05-26 05:27:05 UTC (rev 6243)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreAudioParser/src/ADM_eac3info.cpp	2010-05-26 05:27:08 UTC (rev 6244)
@@ -7,6 +7,7 @@
 
 */
 
+#include "ADM_includeFfmpeg.h"
 #include "ADM_default.h"
 
 #include "ADM_eac3info.h"

Modified: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreImage/include/ADM_pp.h
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreImage/include/ADM_pp.h	2010-05-26 05:27:05 UTC (rev 6243)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreImage/include/ADM_pp.h	2010-05-26 05:27:08 UTC (rev 6244)
@@ -11,13 +11,10 @@
 //
 #ifndef ADMPP
 #define ADMPP
-extern "C" {
-#include "ADM_ffmpeg/libpostproc/postprocess.h"
-}
 typedef struct ADM_PP
 {
-	pp_context_t			*ppContext;
-	pp_mode_t			*ppMode;
+	void    			*ppContext; // pp_context_t
+	void    			*ppMode;    // pp_mode_t
  	uint32_t			postProcType;
 	uint32_t			postProcStrength;
         uint32_t                        swapuv;

Modified: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreImage/src/ADM_colorspace.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreImage/src/ADM_colorspace.cpp	2010-05-26 05:27:05 UTC (rev 6243)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreImage/src/ADM_colorspace.cpp	2010-05-26 05:27:08 UTC (rev 6244)
@@ -15,6 +15,7 @@
  ***************************************************************************/
 
 
+#include "ADM_includeFfmpeg.h"
 #include "ADM_default.h"
 #include "ADM_colorspace.h"
 #include "ADM_image.h"

Modified: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreImage/src/ADM_imageResizer.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreImage/src/ADM_imageResizer.cpp	2010-05-26 05:27:05 UTC (rev 6243)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreImage/src/ADM_imageResizer.cpp	2010-05-26 05:27:08 UTC (rev 6244)
@@ -11,6 +11,7 @@
  *   (at your option) any later version.                                   *
  *                                                                         *
  ***************************************************************************/
+#include "ADM_includeFfmpeg.h"
 #include "ADM_default.h"
 
 #include "ADM_imageResizer.h"

Modified: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreImage/src/ADM_imageSave.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreImage/src/ADM_imageSave.cpp	2010-05-26 05:27:05 UTC (rev 6243)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreImage/src/ADM_imageSave.cpp	2010-05-26 05:27:08 UTC (rev 6244)
@@ -2,15 +2,13 @@
       \file A
       \brief 2nd part of ADMImage, put here to avoid weird dependancies
 */
+#include "ADM_includeFfmpeg.h"
 #include "ADM_default.h"
 #include "ADM_image.h"
 #include "ADM_bitmap.h"
 #include "DIA_coreToolkit.h"
 #include "ADM_colorspace.h"
-extern "C" 
-{
 #include "ADM_lavcodec.h"
-}
 /**
     \fn SwapMe
 */
@@ -221,4 +219,4 @@
     }
     context=NULL;
     return result;
-}
\ No newline at end of file
+}

Modified: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreImage/src/ADM_pp.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreImage/src/ADM_pp.cpp	2010-05-26 05:27:05 UTC (rev 6243)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreImage/src/ADM_pp.cpp	2010-05-26 05:27:08 UTC (rev 6244)
@@ -16,8 +16,11 @@
 //             4 Dering
 // strength between 0 and 5
 
-
+#include "ADM_includeFfmpeg.h"
 #include "ADM_lavcodec.h"
+extern "C" {
+#include "ADM_ffmpeg/libpostproc/postprocess.h"
+}
 #include "ADM_default.h"
 #include "ADM_pp.h"
 

Modified: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreMuxer/src/ADM_coreMuxerFfmpeg.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreMuxer/src/ADM_coreMuxerFfmpeg.cpp	2010-05-26 05:27:05 UTC (rev 6243)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreMuxer/src/ADM_coreMuxerFfmpeg.cpp	2010-05-26 05:27:08 UTC (rev 6244)
@@ -16,6 +16,7 @@
  *   (at your option) any later version.                                   *
  *                                                                         *
  ***************************************************************************/
+#include "ADM_includeFfmpeg.h"
 #include "ADM_default.h"
 #include "fourcc.h"
 #include "ADM_coreMuxerFfmpeg.h"

Modified: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreMuxer/src/ADM_dynaMuxer.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreMuxer/src/ADM_dynaMuxer.cpp	2010-05-26 05:27:05 UTC (rev 6243)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreMuxer/src/ADM_dynaMuxer.cpp	2010-05-26 05:27:08 UTC (rev 6244)
@@ -13,6 +13,7 @@
  *   (at your option) any later version.                                   *
  *                                                                         *
  ***************************************************************************/
+#include "ADM_includeFfmpeg.h"
 #include <vector>
 #include "ADM_default.h"
 #include "ADM_muxerInternal.h"

Modified: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreMuxer/src/ADM_muxerUtils.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreMuxer/src/ADM_muxerUtils.cpp	2010-05-26 05:27:05 UTC (rev 6243)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreMuxer/src/ADM_muxerUtils.cpp	2010-05-26 05:27:08 UTC (rev 6244)
@@ -13,6 +13,8 @@
  *   (at your option) any later version.                                   *
  *                                                                         *
  ***************************************************************************/
+#define __STDC_CONSTANT_MACROS  1 // Lavcodec crap
+#define __STDC_LIMIT_MACROS 1
 #include "ADM_default.h"
 #include "ADM_muxerInternal.h"
 #include "ADM_muxerUtils.h"

Modified: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreUtils/src/ADM_coreCodecMapping.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreUtils/src/ADM_coreCodecMapping.cpp	2010-05-26 05:27:05 UTC (rev 6243)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreUtils/src/ADM_coreCodecMapping.cpp	2010-05-26 05:27:08 UTC (rev 6244)
@@ -15,6 +15,7 @@
  *   (at your option) any later version.                                   *
  *                                                                         *
  ***************************************************************************/
+#include "ADM_includeFfmpeg.h"
 
 #include "ADM_default.h"
 #include "ADM_coreCodecMapping.h"

Modified: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreUtils/src/ADM_infoExtractor.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreUtils/src/ADM_infoExtractor.cpp	2010-05-26 05:27:05 UTC (rev 6243)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreUtils/src/ADM_infoExtractor.cpp	2010-05-26 05:27:08 UTC (rev 6244)
@@ -12,6 +12,7 @@
  *                                                                         *
  ***************************************************************************/
 
+#include "ADM_includeFfmpeg.h"
 
 #include "ADM_default.h"
 #include "ADM_Video.h"

Modified: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreUtils/src/ADM_infoExtractorH264.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreUtils/src/ADM_infoExtractorH264.cpp	2010-05-26 05:27:05 UTC (rev 6243)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreUtils/src/ADM_infoExtractorH264.cpp	2010-05-26 05:27:08 UTC (rev 6244)
@@ -13,6 +13,7 @@
  ***************************************************************************/
 
 
+#include "ADM_includeFfmpeg.h"
 #include "ADM_default.h"
 #include "ADM_Video.h"
 

Modified: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreUtils/src/ADM_paramList.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreUtils/src/ADM_paramList.cpp	2010-05-26 05:27:05 UTC (rev 6243)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreUtils/src/ADM_paramList.cpp	2010-05-26 05:27:08 UTC (rev 6244)
@@ -17,6 +17,7 @@
  *   the Free Software Foundation; either version 2 of the License, or     *
  *   (at your option) any later version.                                   *
  ***************************************************************************/
+#include "ADM_includeFfmpeg.h"
 #include "ADM_default.h"
 #include "ADM_paramList.h"
 #include <stddef.h>

Modified: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreVideoEncoder/src/ADM_coreVideoEncoder.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreVideoEncoder/src/ADM_coreVideoEncoder.cpp	2010-05-26 05:27:05 UTC (rev 6243)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreVideoEncoder/src/ADM_coreVideoEncoder.cpp	2010-05-26 05:27:08 UTC (rev 6244)
@@ -15,6 +15,7 @@
  *   (at your option) any later version.                                   *
  *                                                                         *
  ***************************************************************************/
+#include "ADM_includeFfmpeg.h"
 #include "ADM_default.h"
 #include "ADM_coreVideoEncoder.h"
 extern "C" 
@@ -112,4 +113,4 @@
     return false;
 
 }
-// EOF
\ No newline at end of file
+// EOF

Modified: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreVideoFilter/src/DIA_flyDialog.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreVideoFilter/src/DIA_flyDialog.cpp	2010-05-26 05:27:05 UTC (rev 6243)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreVideoFilter/src/DIA_flyDialog.cpp	2010-05-26 05:27:08 UTC (rev 6244)
@@ -12,6 +12,7 @@
 *                                                                         *
 ***************************************************************************///
 
+#include "ADM_includeFfmpeg.h"
 #include "ADM_default.h"
 
 #include "ADM_coreVideoFilter.h"



From mean at mail.berlios.de  Wed May 26 07:27:13 2010
From: mean at mail.berlios.de (mean at BerliOS)
Date: Wed, 26 May 2010 07:27:13 +0200
Subject: [Avidemux-svn-commit] r6245 -
	branches/avidemux_2.6_branch_mean/avidemux_core/ADM_core/include
Message-ID: <201005260527.o4Q5RDk2030502@sheep.berlios.de>

Author: mean
Date: 2010-05-26 07:27:12 +0200 (Wed, 26 May 2010)
New Revision: 6245

Added:
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_core/include/ADM_includeFfmpeg.h
Log:
[ffmpeg merge] Effect on core

Added: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_core/include/ADM_includeFfmpeg.h
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_core/include/ADM_includeFfmpeg.h	2010-05-26 05:27:08 UTC (rev 6244)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_core/include/ADM_includeFfmpeg.h	2010-05-26 05:27:12 UTC (rev 6245)
@@ -0,0 +1,4 @@
+#define __STDC_CONSTANT_MACROS  1 // Lavcodec crap
+#define __STDC_LIMIT_MACROS 1
+#define ADM_NO_CONFIG_H
+



From mean at mail.berlios.de  Wed May 26 07:27:14 2010
From: mean at mail.berlios.de (mean at BerliOS)
Date: Wed, 26 May 2010 07:27:14 +0200
Subject: [Avidemux-svn-commit] r6246 -
	branches/avidemux_2.6_branch_mean/avidemux/common/ADM_editor
Message-ID: <201005260527.o4Q5REQm030512@sheep.berlios.de>

Author: mean
Date: 2010-05-26 07:27:14 +0200 (Wed, 26 May 2010)
New Revision: 6246

Modified:
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_editor/ADM_edRenderInternal.cpp
Log:
[ffmpeg merge] impact on editor

Modified: branches/avidemux_2.6_branch_mean/avidemux/common/ADM_editor/ADM_edRenderInternal.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/ADM_editor/ADM_edRenderInternal.cpp	2010-05-26 05:27:12 UTC (rev 6245)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/ADM_editor/ADM_edRenderInternal.cpp	2010-05-26 05:27:14 UTC (rev 6246)
@@ -15,6 +15,7 @@
  *   (at your option) any later version.                                   *
  *                                                                         *
  ***************************************************************************/
+#include "ADM_includeFfmpeg.h"
 #include <math.h>
 #include "ADM_default.h"
 #include "ADM_editor/ADM_edit.hxx"
@@ -26,7 +27,9 @@
 #endif
 
 #include "ADM_pp.h"
-
+extern "C" {
+#include "ADM_ffmpeg/libpostproc/postprocess.h"
+}
 // FIXME BADLY !!!
 // This should be in a context somewhere
 static uint8_t compBuffer[MAXIMUM_SIZE * MAXIMUM_SIZE * 3];
@@ -394,6 +397,11 @@
             iStrideTab2[i]=strideTab2[i];
             xBuff[i]=iBuff[i];
         }
+#warning FIXME
+#warning FIXME
+#warning FIXME
+#warning FIXME
+#warning FIXME
         pp_postprocess(
             xBuff,
             iStrideTab,



From mean at mail.berlios.de  Wed May 26 07:27:19 2010
From: mean at mail.berlios.de (mean at BerliOS)
Date: Wed, 26 May 2010 07:27:19 +0200
Subject: [Avidemux-svn-commit] r6247 - in
	branches/avidemux_2.6_branch_mean/avidemux_plugins:
	ADM_audioEncoders/lavcodec ADM_demuxers/MpegTS
	ADM_muxers/muxerFlv ADM_muxers/muxerMkv ADM_muxers/muxerMp4
	ADM_muxers/muxerffPS ADM_muxers/muxerffTS
	ADM_videoEncoder/ffFlv1 ADM_videoEncoder/ffMpeg2
	ADM_videoEncoder/ffMpeg4 ADM_videoEncoder/ffMsMpeg4
	ADM_videoEncoder/huff ADM_videoEncoder/jpeg
Message-ID: <201005260527.o4Q5RJnR030522@sheep.berlios.de>

Author: mean
Date: 2010-05-26 07:27:17 +0200 (Wed, 26 May 2010)
New Revision: 6247

Modified:
   branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_audioEncoders/lavcodec/audioencoder_lavcodec.cpp
   branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_demuxers/MpegTS/ADM_tsIndex.cpp
   branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_demuxers/MpegTS/dmxTSPacket.cpp
   branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_muxers/muxerFlv/muxerFlv.cpp
   branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_muxers/muxerFlv/muxerFlvConfig.cpp
   branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_muxers/muxerFlv/muxerFlvPlugin.cpp
   branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_muxers/muxerMkv/muxerMkv.cpp
   branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_muxers/muxerMkv/muxerMkvConfig.cpp
   branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_muxers/muxerMkv/muxerMkvPlugin.cpp
   branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_muxers/muxerMp4/muxerMP4.cpp
   branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_muxers/muxerMp4/muxerMP4Config.cpp
   branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_muxers/muxerMp4/muxerMP4Plugin.cpp
   branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_muxers/muxerffPS/muxerffPS.cpp
   branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_muxers/muxerffPS/muxerffPSConfig.cpp
   branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_muxers/muxerffPS/muxerffPSPlugin.cpp
   branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_muxers/muxerffTS/muxerffTS.cpp
   branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_muxers/muxerffTS/muxerffTSConfig.cpp
   branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_muxers/muxerffTS/muxerffTSPlugin.cpp
   branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_videoEncoder/ffFlv1/ffFlv1Plugin.cpp
   branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_videoEncoder/ffMpeg2/ffMpeg2Plugin.cpp
   branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_videoEncoder/ffMpeg4/ffMpeg4Plugin.cpp
   branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_videoEncoder/ffMsMpeg4/ffMsMp4Plugin.cpp
   branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_videoEncoder/huff/huffPlugin.cpp
   branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_videoEncoder/jpeg/jpegPlugin.cpp
Log:
[ffmpeg merge] Impact on plugins

Modified: branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_audioEncoders/lavcodec/audioencoder_lavcodec.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_audioEncoders/lavcodec/audioencoder_lavcodec.cpp	2010-05-26 05:27:14 UTC (rev 6246)
+++ branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_audioEncoders/lavcodec/audioencoder_lavcodec.cpp	2010-05-26 05:27:17 UTC (rev 6247)
@@ -16,6 +16,7 @@
  *                                                                         *
  ***************************************************************************/
 
+#include "ADM_includeFfmpeg.h"
 #include "ADM_default.h"
 #include "DIA_factory.h"
 #include "DIA_coreToolkit.h"

Modified: branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_demuxers/MpegTS/ADM_tsIndex.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_demuxers/MpegTS/ADM_tsIndex.cpp	2010-05-26 05:27:14 UTC (rev 6246)
+++ branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_demuxers/MpegTS/ADM_tsIndex.cpp	2010-05-26 05:27:17 UTC (rev 6247)
@@ -15,6 +15,7 @@
  *                                                                         *
  ***************************************************************************/
 
+#include "ADM_includeFfmpeg.h"
 #include "ADM_default.h"
 #include "ADM_demuxerInternal.h"
 #include "fourcc.h"
@@ -30,17 +31,6 @@
 #include "ADM_h264_tag.h"
 #include "ADM_clock.h"
 #include "ADM_getbits.h"
-#if 0
-extern "C"
-{
-#define ADM_NO_CONFIG_H
-#include "libavutil/common.h"
-#include "libavutil/bswap.h"
-#define INT_MAX (0x7FFFFFFF)
-#include "ADM_lavcodec/bitstream.h"
-#include "ADM_lavcodec/golomb.h"
-}
-#endif
 
 #define zprintf(...) {}
 

Modified: branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_demuxers/MpegTS/dmxTSPacket.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_demuxers/MpegTS/dmxTSPacket.cpp	2010-05-26 05:27:14 UTC (rev 6246)
+++ branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_demuxers/MpegTS/dmxTSPacket.cpp	2010-05-26 05:27:17 UTC (rev 6247)
@@ -18,6 +18,7 @@
  *   (at your option) any later version.                                   *
  *                                                                         *
  ***************************************************************************/
+#include "ADM_includeFfmpeg.h"
 #include "ADM_default.h"
 
 #include "dmxTSPacket.h"

Modified: branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_muxers/muxerFlv/muxerFlv.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_muxers/muxerFlv/muxerFlv.cpp	2010-05-26 05:27:14 UTC (rev 6246)
+++ branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_muxers/muxerFlv/muxerFlv.cpp	2010-05-26 05:27:17 UTC (rev 6247)
@@ -16,6 +16,7 @@
  *   (at your option) any later version.                                   *
  *                                                                         *
  ***************************************************************************/
+#include "ADM_includeFfmpeg.h"
 #include "ADM_default.h"
 #include "fourcc.h"
 #include "muxerFlv.h"

Modified: branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_muxers/muxerFlv/muxerFlvConfig.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_muxers/muxerFlv/muxerFlvConfig.cpp	2010-05-26 05:27:14 UTC (rev 6246)
+++ branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_muxers/muxerFlv/muxerFlvConfig.cpp	2010-05-26 05:27:17 UTC (rev 6247)
@@ -12,6 +12,7 @@
  *   (at your option) any later version.                                   *
  *                                                                         *
  ***************************************************************************/
+#include "ADM_includeFfmpeg.h"
 #include "ADM_default.h"
 #include "ADM_muxerInternal.h"
 #include "muxerFlv.h"

Modified: branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_muxers/muxerFlv/muxerFlvPlugin.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_muxers/muxerFlv/muxerFlvPlugin.cpp	2010-05-26 05:27:14 UTC (rev 6246)
+++ branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_muxers/muxerFlv/muxerFlvPlugin.cpp	2010-05-26 05:27:17 UTC (rev 6247)
@@ -13,6 +13,7 @@
  *   (at your option) any later version.                                   *
  *                                                                         *
  ***************************************************************************/
+#include "ADM_includeFfmpeg.h"
 #include "ADM_default.h"
 #include "ADM_muxerInternal.h"
 #include "muxerFlv.h"

Modified: branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_muxers/muxerMkv/muxerMkv.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_muxers/muxerMkv/muxerMkv.cpp	2010-05-26 05:27:14 UTC (rev 6246)
+++ branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_muxers/muxerMkv/muxerMkv.cpp	2010-05-26 05:27:17 UTC (rev 6247)
@@ -16,6 +16,7 @@
  *   (at your option) any later version.                                   *
  *                                                                         *
  ***************************************************************************/
+#include "ADM_includeFfmpeg.h"
 #include "ADM_default.h"
 #include "fourcc.h"
 #include "muxerMkv.h"

Modified: branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_muxers/muxerMkv/muxerMkvConfig.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_muxers/muxerMkv/muxerMkvConfig.cpp	2010-05-26 05:27:14 UTC (rev 6246)
+++ branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_muxers/muxerMkv/muxerMkvConfig.cpp	2010-05-26 05:27:17 UTC (rev 6247)
@@ -12,6 +12,7 @@
  *   (at your option) any later version.                                   *
  *                                                                         *
  ***************************************************************************/
+#include "ADM_includeFfmpeg.h"
 #include "ADM_default.h"
 #include "ADM_muxerInternal.h"
 #include "muxerMkv.h"

Modified: branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_muxers/muxerMkv/muxerMkvPlugin.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_muxers/muxerMkv/muxerMkvPlugin.cpp	2010-05-26 05:27:14 UTC (rev 6246)
+++ branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_muxers/muxerMkv/muxerMkvPlugin.cpp	2010-05-26 05:27:17 UTC (rev 6247)
@@ -13,6 +13,7 @@
  *   (at your option) any later version.                                   *
  *                                                                         *
  ***************************************************************************/
+#include "ADM_includeFfmpeg.h"
 #include "ADM_default.h"
 #include "ADM_muxerInternal.h"
 #include "muxerMkv.h"

Modified: branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_muxers/muxerMp4/muxerMP4.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_muxers/muxerMp4/muxerMP4.cpp	2010-05-26 05:27:14 UTC (rev 6246)
+++ branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_muxers/muxerMp4/muxerMP4.cpp	2010-05-26 05:27:17 UTC (rev 6247)
@@ -16,6 +16,7 @@
  *   (at your option) any later version.                                   *
  *                                                                         *
  ***************************************************************************/
+#include "ADM_includeFfmpeg.h"
 #include "ADM_default.h"
 #include "fourcc.h"
 #include "muxerMP4.h"

Modified: branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_muxers/muxerMp4/muxerMP4Config.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_muxers/muxerMp4/muxerMP4Config.cpp	2010-05-26 05:27:14 UTC (rev 6246)
+++ branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_muxers/muxerMp4/muxerMP4Config.cpp	2010-05-26 05:27:17 UTC (rev 6247)
@@ -12,6 +12,7 @@
  *   (at your option) any later version.                                   *
  *                                                                         *
  ***************************************************************************/
+#include "ADM_includeFfmpeg.h"
 #include "ADM_default.h"
 #include "ADM_muxerInternal.h"
 #include "muxerMP4.h"

Modified: branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_muxers/muxerMp4/muxerMP4Plugin.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_muxers/muxerMp4/muxerMP4Plugin.cpp	2010-05-26 05:27:14 UTC (rev 6246)
+++ branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_muxers/muxerMp4/muxerMP4Plugin.cpp	2010-05-26 05:27:17 UTC (rev 6247)
@@ -13,6 +13,7 @@
  *   (at your option) any later version.                                   *
  *                                                                         *
  ***************************************************************************/
+#include "ADM_includeFfmpeg.h"
 #include "ADM_default.h"
 #include "ADM_muxerInternal.h"
 #include "muxerMP4.h"

Modified: branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_muxers/muxerffPS/muxerffPS.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_muxers/muxerffPS/muxerffPS.cpp	2010-05-26 05:27:14 UTC (rev 6246)
+++ branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_muxers/muxerffPS/muxerffPS.cpp	2010-05-26 05:27:17 UTC (rev 6247)
@@ -16,6 +16,7 @@
  *   (at your option) any later version.                                   *
  *                                                                         *
  ***************************************************************************/
+#include "ADM_includeFfmpeg.h"
 #include "ADM_default.h"
 #include "fourcc.h"
 #include "muxerffPS.h"

Modified: branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_muxers/muxerffPS/muxerffPSConfig.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_muxers/muxerffPS/muxerffPSConfig.cpp	2010-05-26 05:27:14 UTC (rev 6246)
+++ branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_muxers/muxerffPS/muxerffPSConfig.cpp	2010-05-26 05:27:17 UTC (rev 6247)
@@ -12,6 +12,7 @@
  *   (at your option) any later version.                                   *
  *                                                                         *
  ***************************************************************************/
+#include "ADM_includeFfmpeg.h"
 #include "ADM_default.h"
 #include "ADM_muxerInternal.h"
 #include "muxerffPS.h"

Modified: branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_muxers/muxerffPS/muxerffPSPlugin.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_muxers/muxerffPS/muxerffPSPlugin.cpp	2010-05-26 05:27:14 UTC (rev 6246)
+++ branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_muxers/muxerffPS/muxerffPSPlugin.cpp	2010-05-26 05:27:17 UTC (rev 6247)
@@ -13,6 +13,7 @@
  *   (at your option) any later version.                                   *
  *                                                                         *
  ***************************************************************************/
+#include "ADM_includeFfmpeg.h"
 #include "ADM_default.h"
 #include "ADM_muxerInternal.h"
 #include "muxerffPS.h"

Modified: branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_muxers/muxerffTS/muxerffTS.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_muxers/muxerffTS/muxerffTS.cpp	2010-05-26 05:27:14 UTC (rev 6246)
+++ branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_muxers/muxerffTS/muxerffTS.cpp	2010-05-26 05:27:17 UTC (rev 6247)
@@ -16,6 +16,7 @@
  *   (at your option) any later version.                                   *
  *                                                                         *
  ***************************************************************************/
+#include "ADM_includeFfmpeg.h"
 #include "ADM_default.h"
 #include "fourcc.h"
 #include "muxerffTS.h"

Modified: branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_muxers/muxerffTS/muxerffTSConfig.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_muxers/muxerffTS/muxerffTSConfig.cpp	2010-05-26 05:27:14 UTC (rev 6246)
+++ branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_muxers/muxerffTS/muxerffTSConfig.cpp	2010-05-26 05:27:17 UTC (rev 6247)
@@ -12,6 +12,7 @@
  *   (at your option) any later version.                                   *
  *                                                                         *
  ***************************************************************************/
+#include "ADM_includeFfmpeg.h"
 #include "ADM_default.h"
 #include "ADM_muxerInternal.h"
 #include "muxerffTS.h"

Modified: branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_muxers/muxerffTS/muxerffTSPlugin.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_muxers/muxerffTS/muxerffTSPlugin.cpp	2010-05-26 05:27:14 UTC (rev 6246)
+++ branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_muxers/muxerffTS/muxerffTSPlugin.cpp	2010-05-26 05:27:17 UTC (rev 6247)
@@ -13,6 +13,7 @@
  *   (at your option) any later version.                                   *
  *                                                                         *
  ***************************************************************************/
+#include "ADM_includeFfmpeg.h"
 #include "ADM_default.h"
 #include "ADM_muxerInternal.h"
 #include "muxerffTS.h"

Modified: branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_videoEncoder/ffFlv1/ffFlv1Plugin.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_videoEncoder/ffFlv1/ffFlv1Plugin.cpp	2010-05-26 05:27:14 UTC (rev 6246)
+++ branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_videoEncoder/ffFlv1/ffFlv1Plugin.cpp	2010-05-26 05:27:17 UTC (rev 6247)
@@ -15,6 +15,7 @@
  *   (at your option) any later version.                                   *
  *                                                                         *
  ***************************************************************************/
+#include "ADM_includeFfmpeg.h"
 #include "ADM_default.h"
 #include "ADM_ffFlv1.h"
 #include "ADM_coreVideoEncoderInternal.h"

Modified: branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_videoEncoder/ffMpeg2/ffMpeg2Plugin.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_videoEncoder/ffMpeg2/ffMpeg2Plugin.cpp	2010-05-26 05:27:14 UTC (rev 6246)
+++ branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_videoEncoder/ffMpeg2/ffMpeg2Plugin.cpp	2010-05-26 05:27:17 UTC (rev 6247)
@@ -15,6 +15,7 @@
  *   (at your option) any later version.                                   *
  *                                                                         *
  ***************************************************************************/
+#include "ADM_includeFfmpeg.h"
 #include "ADM_default.h"
 #include "ADM_ffMpeg2.h"
 #include "ADM_coreVideoEncoderInternal.h"

Modified: branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_videoEncoder/ffMpeg4/ffMpeg4Plugin.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_videoEncoder/ffMpeg4/ffMpeg4Plugin.cpp	2010-05-26 05:27:14 UTC (rev 6246)
+++ branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_videoEncoder/ffMpeg4/ffMpeg4Plugin.cpp	2010-05-26 05:27:17 UTC (rev 6247)
@@ -15,6 +15,7 @@
  *   (at your option) any later version.                                   *
  *                                                                         *
  ***************************************************************************/
+#include "ADM_includeFfmpeg.h"
 #include "ADM_default.h"
 #include "ADM_ffMpeg4.h"
 #include "ADM_coreVideoEncoderInternal.h"

Modified: branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_videoEncoder/ffMsMpeg4/ffMsMp4Plugin.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_videoEncoder/ffMsMpeg4/ffMsMp4Plugin.cpp	2010-05-26 05:27:14 UTC (rev 6246)
+++ branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_videoEncoder/ffMsMpeg4/ffMsMp4Plugin.cpp	2010-05-26 05:27:17 UTC (rev 6247)
@@ -15,6 +15,7 @@
  *   (at your option) any later version.                                   *
  *                                                                         *
  ***************************************************************************/
+#include "ADM_includeFfmpeg.h"
 #include "ADM_default.h"
 #include "ADM_ffMsMp4.h"
 #include "ADM_coreVideoEncoderInternal.h"

Modified: branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_videoEncoder/huff/huffPlugin.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_videoEncoder/huff/huffPlugin.cpp	2010-05-26 05:27:14 UTC (rev 6246)
+++ branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_videoEncoder/huff/huffPlugin.cpp	2010-05-26 05:27:17 UTC (rev 6247)
@@ -15,6 +15,7 @@
  *   (at your option) any later version.                                   *
  *                                                                         *
  ***************************************************************************/
+#include "ADM_includeFfmpeg.h"
 #include "ADM_default.h"
 #include "ADM_huffEncoder.h"
 #include "ADM_coreVideoEncoderInternal.h"

Modified: branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_videoEncoder/jpeg/jpegPlugin.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_videoEncoder/jpeg/jpegPlugin.cpp	2010-05-26 05:27:14 UTC (rev 6246)
+++ branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_videoEncoder/jpeg/jpegPlugin.cpp	2010-05-26 05:27:17 UTC (rev 6247)
@@ -15,6 +15,7 @@
  *   (at your option) any later version.                                   *
  *                                                                         *
  ***************************************************************************/
+#include "ADM_includeFfmpeg.h"
 #include "ADM_default.h"
 #include "ADM_coreVideoEncoderInternal.h"
 #include "ADM_jpegEncoder.h"



From mean at mail.berlios.de  Wed May 26 07:27:23 2010
From: mean at mail.berlios.de (mean at BerliOS)
Date: Wed, 26 May 2010 07:27:23 +0200
Subject: [Avidemux-svn-commit] r6248 -
	branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreUtils/src
Message-ID: <201005260527.o4Q5RNob030610@sheep.berlios.de>

Author: mean
Date: 2010-05-26 07:27:21 +0200 (Wed, 26 May 2010)
New Revision: 6248

Removed:
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreUtils/src/ADM_infoExtractor.cpp.orig
Log:
[] rmed

Deleted: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreUtils/src/ADM_infoExtractor.cpp.orig
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreUtils/src/ADM_infoExtractor.cpp.orig	2010-05-26 05:27:17 UTC (rev 6247)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreUtils/src/ADM_infoExtractor.cpp.orig	2010-05-26 05:27:21 UTC (rev 6248)
@@ -1,592 +0,0 @@
-/***************************************************************************
-                          ADM_infoextractor
-                             -------------------
-           - extract additionnal info from header (mp4/h263)                  
-**************************************************************************/
-/***************************************************************************
- *                                                                         *
- *   This program is free software; you can redistribute it and/or modify  *
- *   it under the terms of the GNU General Public License as published by  *
- *   the Free Software Foundation; either version 2 of the License, or     *
- *   (at your option) any later version.                                   *
- *                                                                         *
- ***************************************************************************/
-
-
-#include "ADM_default.h"
-#include "ADM_Video.h"
-
-#include "fourcc.h"
-//#include "ADM_mp4.h"
-
-#define aprintf(...) {}
-extern "C"
-{
-#define ADM_NO_CONFIG_H
-#include "common.h"
-#include "bswap.h"
-#define INT_MAX (0x7FFFFFFF)
-#include "ADM_libraries/ADM_ffmpeg/ADM_lavcodec/bitstream.h"
-#include "ADM_libraries/ADM_ffmpeg/ADM_lavcodec/golomb.h"
-}
-
-#include "ADM_h264_tag.h"
-
-static void refineH264FrameType(uint8_t *head,uint8_t *tail,uint32_t *flags);
-/*
-    Extract width & height from vol header passed as arg
-
-
-*/
-uint8_t extractMpeg4Info(uint8_t *data,uint32_t dataSize,uint32_t *w,uint32_t *h,uint32_t *time_inc)
-{
-    // Search startcode
-    uint8_t b;
-    uint32_t idx=0;
-    uint32_t mw,mh;
-    uint32_t timeVal;
-    
-    //mixDump(data,dataSize);
-    //printf("\n");
-    while(1)
-    {
-        uint32_t startcode=0xffffffff;
-        while(dataSize>2)
-        {
-            startcode=(startcode<<8)+data[idx];
-            idx++;
-            dataSize--;
-            if((startcode&0xffffff)==1) break;
-        }
-        if(dataSize>2)
-        {
-            //printf("Startcodec:%x\n",data[idx]);
-            if((data[idx]&0xF0)==0x20) //VOL start
-            {
-                dataSize--;
-                idx++;
-#if 0
-                printf("VOL Header:\n");
-
-                if(dataSize<16)
-                {
-                  mixDump(data+idx,dataSize);printf("\n");
-                }
-                else
-                {
-                  mixDump(data+idx,16);printf("\n");
-                }
-#endif
-                // Here we go !
-                GetBitContext s;
-                init_get_bits( &s,data+idx, dataSize*8);
-                //
-                skip_bits1(&s); // Random access
-                skip_bits(&s,8); // Obj type indication
-                if(get_bits(&s,1)) // VO od 
-                {
-                      skip_bits(&s,4); // Ver
-                      skip_bits(&s,3);  // Priority
-                }
-                if(get_bits(&s,4)==15) // custom A/R
-                {
-                      skip_bits(&s,8);
-                      skip_bits(&s,8);
-                }
-                if(get_bits(&s,1)) // Vol control param
-                {
-                      skip_bits(&s,2);   //Chroma
-                      skip_bits(&s,1);   // Low delay
-                      if(get_bits(&s,1)) // VBV Info
-                      {
-                        skip_bits(&s,16);
-                        skip_bits(&s,16);
-                        skip_bits(&s,16);
-                        skip_bits(&s,15);
-                        skip_bits(&s,16);
-                      }
-                  }
-                 skip_bits(&s,2); //  Shape
-                 skip_bits(&s,1); //  Marker
-                 timeVal=get_bits(&s,16); // Time increment
-                 *time_inc = av_log2(timeVal - 1) + 1;
-                 if (*time_inc < 1)
-                    *time_inc = 1;
-                 skip_bits(&s,1); //  Marker
-                 if(get_bits(&s,1)) // Fixed vop rate, compute how much bits needed
-                 {
-                     get_bits(&s, *time_inc);
-                 }
-                  skip_bits(&s,1); //  Marker
-                  mw=get_bits(&s,13);
-                  skip_bits(&s,1); //  Marker
-                  mh=get_bits(&s,13);
-                // /Here we go
-                //printf("%d x %d \n",mw,mh);
-                *h=mh;
-                *w=mw;
-                return 1;;
-                // Free get bits ?
-                // WTF ?
-            }
-            continue;
-        }
-        else
-        {
-            printf("No more startcode\n");
-            // Free get bits ?
-            return 0;
-            
-        }
-    }
-    
-    return 0;
-}
-/**
-    \fn extractVopInfo
-    \brief extract info from vop : Vop type, module time base, time inc
-    
-    Warning this function expects data to start AFTER startcode, contrarily to other functions here!
-*/
-
-uint8_t extractVopInfo(uint8_t *data, uint32_t len,uint32_t timeincbits,uint32_t *vopType,uint32_t *modulo, uint32_t *time_inc,uint32_t *vopcoded)
-{
-   GetBitContext s;
-   int vop;
-   uint32_t vp,tinc;
-           init_get_bits( &s,data, len*8);
-           vop=get_bits(&s,2);
-           switch(vop)
-           {
-             case 0: vp=AVI_KEY_FRAME;break;
-             case 1: vp=0;break;
-             case 2: vp=AVI_B_FRAME;break;
-             case 3: vp=0;break;  // D FRAME ????
-             default:
-                printf("Unknown vop type :%d\n",vop);
-                return 0;
-           }
-           /* Read modulo */
-           int imodulo=0;
-           while (get_bits1(&s) != 0)
-                  imodulo++;
-           if(!get_bits1(&s))
-           {
-              printf("Wrong marker1\n");
-              return 0; 
-           }
-           
-           /* Read time */
-           tinc=get_bits(&s,timeincbits);
-           /* Marker */
-            if(!get_bits1(&s))
-           {
-              printf("Wrong marker2\n");
-              return 0; 
-           }
-           /* Vop coded */
-           *modulo=imodulo;
-           *vopcoded=get_bits1(&s);
-           *vopType=vp;
-           *time_inc=tinc;
-           return 1;
-}
-/**
-      \brief extractH263FLVInfo
-      \fn Extract width/height from FLV header
-*/
-uint8_t extractH263FLVInfo(uint8_t *buffer,uint32_t len,uint32_t *w,uint32_t *h)
-{
-        GetBitContext gb;
-        int format;
-        init_get_bits( &gb,buffer, len*8);
-        if (get_bits_long(&gb, 17) != 1) {
-            printf("[FLV]Wrong FLV1 header\n");
-            return 0;
-        }
-        format = get_bits(&gb, 5);
-        if (format != 0 && format != 1) {
-            printf("[FLV]Wrong FLV1 header format\n");
-            return 0;        }
-        
-        get_bits(&gb, 8); /* picture timestamp */
-        format = get_bits(&gb, 3);
-        switch (format) {
-        case 0:
-            *w = get_bits(&gb, 8);
-            *h = get_bits(&gb, 8);
-            break;
-        case 1:
-            *w = get_bits(&gb, 16);
-            *h = get_bits(&gb, 16);
-            break;
-        case 2:
-            *w = 352;
-            *h = 288;
-            break;
-        case 3:
-            *w = 176;
-            *h = 144;
-            break;
-        case 4:
-            *w = 128;
-            *h = 96;
-            break;
-        case 5:
-            *w = 320;
-            *h = 240;
-            break;
-        case 6:
-            *w = 160;
-            *h = 120;
-            break;
-        default:
-             printf("[FLV]Wrong width format\n");
-             return 0;
-            break;
-        }
-        return 1;
-}
-/*
-        Extract H263 width & height from header
-
-*/
-uint8_t extractH263Info(uint8_t *data,uint32_t dataSize,uint32_t *w,uint32_t *h)
-{
-uint32_t val;
-                GetBitContext s;
-                init_get_bits( &s,data, dataSize*8);
-                
-                 mixDump(data,10);
-                 val=get_bits(&s,16);
-                 if(val)
-                 {
-                    printf("incorrect H263 header sync\n");
-                    return 0;
-                 }
-                 val=get_bits(&s,6);
-                 if(val!=0x20)
-                 {
-                    printf("incorrect H263 header sync (2)\n");
-                    return 0;
-                 }
-                 //
-                 skip_bits(&s,8); // timestamps in 30 fps tick
-                 skip_bits(&s,1); // Marker
-                 skip_bits(&s,1); // Id
-                 skip_bits(&s,1); // Split
-                 skip_bits(&s,1); // Document Camera indicator
-                 skip_bits(&s,1); // Full Picture Freeze Release
-                 val=get_bits(&s,3);
-                 switch(val)
-                 {
-                   
-                    case 1: *w=128;*h=96;return 1;break;
-                    case 2: *w=176;*h=144;return 1;break;
-                    case 6:
-                    case 7:
-                            printf("H263+:Todo\n");
-                    default:
-                        printf("Invalid format\n");return 0;break;
-                 }
-                 return 0;
-}
-/**
-    \fn unescapeH264
-    \brief Remove escape stuff
-
-*/
-static uint32_t unescapeH264(uint32_t len,uint8_t *in, uint8_t *out)
-{
-  uint32_t outlen=0;
-  uint8_t *tail=in+len;
-    if(len<3) return 0;
-    while(in<tail-3)
-    {
-      if(!in[0]  && !in[1] && in[2]==3)
-      {
-        out[0]=0;
-        out[1]=0;
-        out+=2;
-        outlen+=2;
-        in+=3; 
-      }
-      *out++=*in++;
-      outlen++;
-    }
-    // copy last bytes
-    uint32_t left=tail-in;
-    memcpy(out,in,left);
-    outlen+=left;
-    return outlen;
-    
-}
-
-static uint8_t extractVUIInfo(GetBitContext *s, uint32_t *fps1000)
-{
-	*fps1000 = 0;
-
-	if (get_bits1(s))
-	{
-		unsigned int aspect_ratio_information = get_bits(s, 8);
-
-		if (aspect_ratio_information == 255)
-		{
-			get_bits(s, 16);
-			get_bits(s, 16);
-		}
-	}
-
-	if (get_bits1(s))	// overscan
-		get_bits1(s);
-
-	if (get_bits1(s))	// vsp_color
-	{
-		get_bits(s, 4);
-
-		if (get_bits1(s))
-		{
-			get_bits(s, 8);
-			get_bits(s, 8);
-			get_bits(s, 8);
-		}
-	}
-
-	if (get_bits1(s))	// chroma
-	{
-		get_ue_golomb(s);
-		get_ue_golomb(s);
-	}
-
-	if (get_bits1(s))	// timing
-	{
-		uint32_t timeinc_unit = get_bits_long(s, 32);
-		uint32_t timeinc_resolution = get_bits_long(s, 32);
-		uint32_t fixed_fps = get_bits1(s);
-
-		if (timeinc_unit > 0 && timeinc_resolution > 0)
-			*fps1000 = (uint32_t)(((float)timeinc_resolution / (float)timeinc_unit) * 1000);
-
-		if (fixed_fps)
-			*fps1000 /= 2;
-	}
-
-	return 1;
-}
-
-/**
-    \fn extractSPSInfo
-    \brief Extract info from H264 SPS
-    See 7.3.2.1 of 14496-10
-*/
-uint8_t extractSPSInfo(uint8_t *data, uint32_t len,uint32_t *wwidth,uint32_t *hheight, uint32_t *fps1000)
-{
-   GetBitContext s;
-   
-   uint32_t profile,constraint,level,pic_order_cnt_type,w,h, mbh, frame_mbs_only;
-   uint8_t buf[len];
-   uint32_t outlen;
-   uint32_t id,dum;
-   
-           outlen=unescapeH264(len,data,buf);
-           init_get_bits( &s,buf, outlen*8);
-            
-           profile=get_bits(&s,8);
-           constraint=get_bits(&s,8)>>5;
-           level=get_bits(&s,8);
-           id=get_ue_golomb(&s); // Seq parameter set id           
-           printf("[H264]Profile : %u, Level :%u, SPSid:%u\n",profile,level,id);
-           if(profile>=100) // ?? Borrowed from H264.C/FFMPEG
-           {
-              printf("[H264]Warning : High profile\n");
-              if(get_ue_golomb(&s) == 3) //chroma_format_idc
-                get_bits1(&s);  //residual_color_transform_flag
-            get_ue_golomb(&s);  //bit_depth_luma_minus8
-            get_ue_golomb(&s);  //bit_depth_chroma_minus8
-            get_bits1(&s);
-			if (get_bits1(&s))
-				get_bits(&s, 8);
-           }
-           
-
-           dum=get_ue_golomb(&s); // log2_max_frame_num_minus4
-           printf("[H264]Log2maxFrame-4:%u\n",dum);
-           pic_order_cnt_type=get_ue_golomb(&s);
-           printf("[H264]Pic Order Cnt Type:%u\n",pic_order_cnt_type);
-           if(!pic_order_cnt_type) // pic_order_cnt_type
-           {
-              dum=get_ue_golomb(&s); //log2_max_pic_order_cnt_lsb_minus4
-              printf("[H264]Log2maxPix-4:%u\n",dum);
-           }else
-           {
-             if(pic_order_cnt_type==1)
-             {
-                 get_bits1(&s);   //delta_pic_order_always_zero_flag
-                 get_se_golomb(&s);   //offset_for_non_ref_pic
-                 get_se_golomb(&s);  // offset_for_top_to_bottom_field
-                 int i=get_ue_golomb(&s);  //num_ref_frames_in_pic_order_cnt_cycle
-
-                 for(int j=0;j<i;j++)
-                 {
-                      get_se_golomb(&s);
-                 }
-             }else 
-             {
-               printf("Error in SPS\n");
-               return 0;
-             }
-           }
-           dum=get_ue_golomb(&s);     //num_ref_frames
-           printf("[H264] # of ref frames : %u\n",dum);
-           get_bits1(&s);         // gaps_in_frame_num_value_allowed_flag
-		   w = get_ue_golomb(&s) + 1;   //pic_width_in_mbs_minus1
-
-		   mbh = get_ue_golomb(&s) + 1;
-		   frame_mbs_only = get_bits1(&s);
-		   h = (2 - frame_mbs_only) * mbh;   //pic_height_in_mbs_minus1
-
-           printf("[H264] Width in mb -1  :%d\n",w); 
-           printf("[H264] Height in mb -1 :%d\n", h);
-
-		   *wwidth = w * 16;
-		   *hheight= h * 16;
-           
-		   if (!frame_mbs_only)
-			   get_bits1(&s);
-
-		   get_bits1(&s);
-
-		   if(get_bits1(&s))
-		   {
-			   get_ue_golomb(&s);
-			   get_ue_golomb(&s);
-			   get_ue_golomb(&s);
-			   get_ue_golomb(&s);
-		   }
-
-		   if(get_bits1(&s))
-			   extractVUIInfo(&s, fps1000);
-
-           return 1;
-}
-/**
-      \fn extractH264FrameType
-      \brief return frametype in flags (KEY_FRAME or 0). To be used only with  mkv/mp4 nal type (i.e. no startcode)
-      
-*/
-uint8_t extractH264FrameType(uint32_t nalSize,uint8_t *buffer,uint32_t len,uint32_t *flags)
-{
-  uint8_t *head=buffer, *tail=buffer+len;
-  uint8_t stream;
-  
-  uint32_t val,hnt;  
-  
-// FIXME :  no startcode only !
-  
-  while(head+4<tail)
-  {
-    
-              uint32_t length=(head[0]<<24) + (head[1]<<16) +(head[2]<<8)+(head[3]);
-              if(length>len||length<6)
-              {
-                printf("Warning , incomplete nal (%u/%u),(%0x/%0x)\n",length,len,length,len);
-                *flags=0;
-                return 0;
-              }
-              head+=4; // Skip nal lenth
-              length-=4;
-              stream=*(head++)&0x1F;
-                switch(stream)
-                {
-                  case NAL_IDR: 
-                                  *flags=AVI_KEY_FRAME;
-                                  
-                                  return 1;
-                                  break; 
-                  case NAL_NON_IDR: 
-                                  refineH264FrameType(head,tail,flags);
-                                  return 1;
-                                  break;
-                  default:
-                          printf("??0x%x\n",stream);
-                          head+=length-5;
-                          continue;
-                }
-  }
-  printf("No stream\n");
-  return 0;
-}
-
-/**
-      \fn extractH264FrameType_startCode
-      \brief return frametype in flags (KEY_FRAME or 0). To be used only with  avi / mpeg TS nal type (i.e. with startcode)
-      
-*/
-uint8_t extractH264FrameType_startCode(uint32_t nalSize,uint8_t *buffer,uint32_t len,uint32_t *flags)
-{
-  uint8_t *head=buffer, *tail=buffer+len;
-  uint8_t stream;
-#define NAL_NON_IDR       1
-#define NAL_IDR           5
-#define NAL_SEI           6
-
-  uint32_t val,hnt;  
-  
-// FIXME :  no startcode only !
-  
-  while(head+4<tail)
-  {
-          // Search startcode
-      
-                hnt=(head[0]<<24) + (head[1]<<16) +(head[2]<<8)+(head[3]);
-                head+=4;
-                while((hnt!=1) && head<tail)
-                {
-
-                        hnt<<=8;
-                        val=*head++;
-                        hnt+=val;
-                }
-                if(head>=tail) break;
-                stream=*(head++) &0x1f;
-                switch(stream)
-                {
-                  case NAL_IDR: 
-                                  *flags=AVI_KEY_FRAME;
-                                 // printf("IDR\n");
-                                  return 1;
-                                  break; 
-                  case NAL_NON_IDR: 
-                                  refineH264FrameType(head,tail,flags);
-                                  return 1;
-                                  break;
-                  default:
-                          printf("??0x%x\n",stream);
-                          continue;
-                }
-  }
-  printf("No stream\n");
-  return 0;
-}
-/**
-    \fn refineH264FrameType
-    \brief Try to detect B slice, warning the stream is not escaped!
-*/
-void refineH264FrameType(uint8_t *head,uint8_t *tail,uint32_t *flags)
-{
-GetBitContext s;
-uint32_t sliceType;
-            *flags=0;
-            init_get_bits(&s,head, (tail-head)*8);
-            get_ue_golomb(&s);
-            sliceType= get_ue_golomb(&s);
-            if(sliceType > 9) 
-            {
-              printf("Weird Slice %d\n",sliceType);
-              return ;
-            }
-            if(sliceType > 4)
-                sliceType -= 5;
-            if(sliceType==3) *flags=AVI_B_FRAME;  
-}
-//EOF



From mean at mail.berlios.de  Wed May 26 07:27:24 2010
From: mean at mail.berlios.de (mean at BerliOS)
Date: Wed, 26 May 2010 07:27:24 +0200
Subject: [Avidemux-svn-commit] r6249 -
	branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreAudioParser/src
Message-ID: <201005260527.o4Q5ROgA030737@sheep.berlios.de>

Author: mean
Date: 2010-05-26 07:27:24 +0200 (Wed, 26 May 2010)
New Revision: 6249

Modified:
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreAudioParser/src/ADM_dcainfo.cpp
Log:
[dcainfo] simplify

Modified: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreAudioParser/src/ADM_dcainfo.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreAudioParser/src/ADM_dcainfo.cpp	2010-05-26 05:27:21 UTC (rev 6248)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreAudioParser/src/ADM_dcainfo.cpp	2010-05-26 05:27:24 UTC (rev 6249)
@@ -17,16 +17,7 @@
 #include "ADM_includeFfmpeg.h"
 #include "ADM_default.h"
 #include "ADM_dcainfo.h"
-#define ADM_NO_CONFIG_H
-extern "C"
-{
-#include "ADM_ffmpeg/ffmpeg_config/config.h"
-#include "ADM_ffmpeg/libavutil/internal.h"
-#include "ADM_ffmpeg/libavutil/common.h"
-#include "ADM_ffmpeg/libavutil/bswap.h"
-#include "ADM_ffmpeg/libavcodec/get_bits.h"
-
-}
+#include "ADM_getbits.h"
 #undef printf
 /*
         Borrowed from libdca



From mean at mail.berlios.de  Wed May 26 07:27:26 2010
From: mean at mail.berlios.de (mean at BerliOS)
Date: Wed, 26 May 2010 07:27:26 +0200
Subject: [Avidemux-svn-commit] r6250 -
	branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/py
Message-ID: <201005260527.o4Q5RQQL030879@sheep.berlios.de>

Author: mean
Date: 2010-05-26 07:27:25 +0200 (Wed, 26 May 2010)
New Revision: 6250

Added:
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/py/adm.admPyClass
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/py/adm.admPyFunc
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/py/editor.admPyClass
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/py/update.make
Removed:
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/py/adm.admPy
Modified:
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/py/ADM_pyAdm.cpp
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/py/adm_gen.cpp
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/py/adm_gen.h
Log:
[py binding]

Modified: branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/py/ADM_pyAdm.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/py/ADM_pyAdm.cpp	2010-05-26 05:27:24 UTC (rev 6249)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/py/ADM_pyAdm.cpp	2010-05-26 05:27:25 UTC (rev 6250)
@@ -22,9 +22,9 @@
 #include "A_functions.h"
 #include "ADM_scriptCommon.h"
 #include "ADM_scriptVideo.h"
-#include "adm_gen.h"
 
 #include "adm_gen.cpp"
+extern pyRegisterClass initClasspyAdm;
 /**
 
 */
@@ -39,7 +39,8 @@
 static bool initPy(tinyPy *py)
 {
     py->init();
-    py->registerFuncs("adm",adm_functions);
+    //py->registerFuncs("adm",adm_functions);
+    py->registerClass("Avidemux",initClasspyAdm);
     tinyPy::registerLogger(pyLogger);
     return true;
 }

Deleted: branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/py/adm.admPy
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/py/adm.admPy	2010-05-26 05:27:24 UTC (rev 6249)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/py/adm.admPy	2010-05-26 05:27:25 UTC (rev 6250)
@@ -1,15 +0,0 @@
-#              cname:pyname
-
-/* FUNC */ int jsLoadVideo:loadVideo          (char * ) 
-/* FUNC */ int jsClearSegments:clearSegments  (void) 
-/* FUNC */ int jsAppendVideo:appendVideo      (char * ) 
-/* FUNC */ int jsAddSegment:addSegment        (int ,float , float ) 
-/* FUNC */ int jsSetPostProc:setPostProc      (int ,int , int ) 
-/* FUNC */ int jsGetWidth:getWidth            (void) 
-/* FUNC */ int jsGetHeight:getHeight          (void) 
-/* FUNC */ int jsGetFps1000:getFps1000        (void) 
-#/* FUNC */ char* getVideoCodec(void) 
-/* FUNC */ int jsAudioReset:audioReset        (void) 
-/* FUNC */ int jsAudioMixer:audioMixer        (char * ) 
-/* FUNC */ int jsClearVideoFilters:clearVideoFilters   (void) 
-

Copied: branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/py/adm.admPyClass (from rev 6249, branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/py/adm.admPy)
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/py/adm.admPy	2010-05-26 05:27:24 UTC (rev 6249)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/py/adm.admPyClass	2010-05-26 05:27:25 UTC (rev 6250)
@@ -0,0 +1,15 @@
+#              cname:pyname
+/* CLASS */ pyAdm : void
+/* FUNC */ int jsLoadVideo:loadVideo          (char * ) 
+/* FUNC */ int jsClearSegments:clearSegments  (void) 
+/* FUNC */ int jsAppendVideo:appendVideo      (char * ) 
+/* FUNC */ int jsAddSegment:addSegment        (int ,float , float ) 
+/* FUNC */ int jsSetPostProc:setPostProc      (int ,int , int ) 
+/* FUNC */ int jsGetWidth:getWidth            (void) 
+/* FUNC */ int jsGetHeight:getHeight          (void) 
+/* FUNC */ int jsGetFps1000:getFps1000        (void) 
+/* FUNC */ str jsGetVideoCodec:getVideoCodec(void) 
+/* FUNC */ int jsAudioReset:audioReset        (void) 
+/* FUNC */ int jsAudioMixer:audioMixer        (char * ) 
+/* FUNC */ int jsClearVideoFilters:clearVideoFilters   (void) 
+

Copied: branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/py/adm.admPyFunc (from rev 6249, branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/py/adm.admPy)
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/py/adm.admPy	2010-05-26 05:27:24 UTC (rev 6249)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/py/adm.admPyFunc	2010-05-26 05:27:25 UTC (rev 6250)
@@ -0,0 +1,15 @@
+#              cname:pyname
+
+/* FUNC */ int jsLoadVideo:loadVideo          (char * ) 
+/* FUNC */ int jsClearSegments:clearSegments  (void) 
+/* FUNC */ int jsAppendVideo:appendVideo      (char * ) 
+/* FUNC */ int jsAddSegment:addSegment        (int ,float , float ) 
+/* FUNC */ int jsSetPostProc:setPostProc      (int ,int , int ) 
+/* FUNC */ int jsGetWidth:getWidth            (void) 
+/* FUNC */ int jsGetHeight:getHeight          (void) 
+/* FUNC */ int jsGetFps1000:getFps1000        (void) 
+#/* FUNC */ char* getVideoCodec(void) 
+/* FUNC */ int jsAudioReset:audioReset        (void) 
+/* FUNC */ int jsAudioMixer:audioMixer        (char * ) 
+/* FUNC */ int jsClearVideoFilters:clearVideoFilters   (void) 
+

Modified: branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/py/adm_gen.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/py/adm_gen.cpp	2010-05-26 05:27:24 UTC (rev 6249)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/py/adm_gen.cpp	2010-05-26 05:27:25 UTC (rev 6250)
@@ -54,6 +54,12 @@
 int r=jsGetFps1000(); 
 return tp_number(r);
 }
+//str  jsGetVideoCodec <void>
+tp_obj zzpy_getVideoCodec(TP)
+{
+char *r=jsGetVideoCodec(); 
+return tp_string(r);
+}
 //int  jsAudioReset <void>
 tp_obj zzpy_audioReset(TP)
 {
@@ -73,17 +79,24 @@
 int r=jsClearVideoFilters(); 
 return tp_number(r);
 }
-pyFuncs adm_functions[]={
-{"loadVideo",zzpy_loadVideo},
-{"clearSegments",zzpy_clearSegments},
-{"appendVideo",zzpy_appendVideo},
-{"addSegment",zzpy_addSegment},
-{"setPostProc",zzpy_setPostProc},
-{"getWidth",zzpy_getWidth},
-{"getHeight",zzpy_getHeight},
-{"getFps1000",zzpy_getFps1000},
-{"audioReset",zzpy_audioReset},
-{"audioMixer",zzpy_audioMixer},
-{"clearVideoFilters",zzpy_clearVideoFilters},
-{NULL,NULL}
-};
+static tp_obj myCtor(tp_vm *vm)
+{
+}
+tp_obj initClasspyAdm(tp_vm *vm)
+{
+ tp_obj myClass=tp_class(vm);
+ tp_set(vm,myClass,tp_string("__init__"),tp_fnc(vm,myCtor));
+ tp_set(vm,myClass,tp_string("loadVideo"),tp_fnc(vm,zzpy_loadVideo));
+ tp_set(vm,myClass,tp_string("clearSegments"),tp_fnc(vm,zzpy_clearSegments));
+ tp_set(vm,myClass,tp_string("appendVideo"),tp_fnc(vm,zzpy_appendVideo));
+ tp_set(vm,myClass,tp_string("addSegment"),tp_fnc(vm,zzpy_addSegment));
+ tp_set(vm,myClass,tp_string("setPostProc"),tp_fnc(vm,zzpy_setPostProc));
+ tp_set(vm,myClass,tp_string("getWidth"),tp_fnc(vm,zzpy_getWidth));
+ tp_set(vm,myClass,tp_string("getHeight"),tp_fnc(vm,zzpy_getHeight));
+ tp_set(vm,myClass,tp_string("getFps1000"),tp_fnc(vm,zzpy_getFps1000));
+ tp_set(vm,myClass,tp_string("getVideoCodec"),tp_fnc(vm,zzpy_getVideoCodec));
+ tp_set(vm,myClass,tp_string("audioReset"),tp_fnc(vm,zzpy_audioReset));
+ tp_set(vm,myClass,tp_string("audioMixer"),tp_fnc(vm,zzpy_audioMixer));
+ tp_set(vm,myClass,tp_string("clearVideoFilters"),tp_fnc(vm,zzpy_clearVideoFilters));
+ return myClass;
+}

Modified: branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/py/adm_gen.h
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/py/adm_gen.h	2010-05-26 05:27:24 UTC (rev 6249)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/py/adm_gen.h	2010-05-26 05:27:25 UTC (rev 6250)
@@ -6,6 +6,7 @@
 int  getWidth (void);
 int  getHeight (void);
 int  getFps1000 (void);
+str  getVideoCodec (void);
 int  audioReset (void);
 int  audioMixer (char * );
 int  clearVideoFilters (void);

Added: branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/py/editor.admPyClass
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/py/editor.admPyClass	2010-05-26 05:27:24 UTC (rev 6249)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/py/editor.admPyClass	2010-05-26 05:27:25 UTC (rev 6250)
@@ -0,0 +1,6 @@
+#              cname:pyname
+/* CLASS */ pyEditor : void
+/* FUNC */ int jsPrintTiming:printTiming      (int ) 
+/* FUNC */ int jsDumpSegments:dumpSegment     (void) 
+/* FUNC */ int jsDumpRefVideos:dumpRefVideo   (void) 
+

Added: branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/py/update.make
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/py/update.make	2010-05-26 05:27:24 UTC (rev 6249)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/py/update.make	2010-05-26 05:27:25 UTC (rev 6250)
@@ -0,0 +1,4 @@
+OBJS=adm_gen.cpp editor_gen.cpp
+%_gen.cpp:%.idl
+        perl ../../../../cmake/admPyClass $%.idl
+all: $(OBJS)



From mean at mail.berlios.de  Wed May 26 07:27:28 2010
From: mean at mail.berlios.de (mean at BerliOS)
Date: Wed, 26 May 2010 07:27:28 +0200
Subject: [Avidemux-svn-commit] r6251 -
	branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/py
Message-ID: <201005260527.o4Q5RSpw030913@sheep.berlios.de>

Author: mean
Date: 2010-05-26 07:27:27 +0200 (Wed, 26 May 2010)
New Revision: 6251

Modified:
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/py/ADM_pyAdm.cpp
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/py/adm_gen.cpp
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/py/update.make
Log:
[qt4] Editor binding to python

Modified: branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/py/ADM_pyAdm.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/py/ADM_pyAdm.cpp	2010-05-26 05:27:25 UTC (rev 6250)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/py/ADM_pyAdm.cpp	2010-05-26 05:27:27 UTC (rev 6251)
@@ -22,9 +22,12 @@
 #include "A_functions.h"
 #include "ADM_scriptCommon.h"
 #include "ADM_scriptVideo.h"
+#include "ADM_scriptEditor.h"
 
 #include "adm_gen.cpp"
+#include "editor_gen.cpp"
 extern pyRegisterClass initClasspyAdm;
+extern pyRegisterClass initClasspyEditor;
 /**
 
 */
@@ -41,6 +44,7 @@
     py->init();
     //py->registerFuncs("adm",adm_functions);
     py->registerClass("Avidemux",initClasspyAdm);
+    py->registerClass("Editor",initClasspyEditor);
     tinyPy::registerLogger(pyLogger);
     return true;
 }

Modified: branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/py/adm_gen.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/py/adm_gen.cpp	2010-05-26 05:27:25 UTC (rev 6250)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/py/adm_gen.cpp	2010-05-26 05:27:27 UTC (rev 6251)
@@ -1,3 +1,4 @@
+// Generated by admPyClass.pl do not edit !
 //int  jsLoadVideo <char * >
 tp_obj zzpy_loadVideo(TP)
 {
@@ -79,13 +80,13 @@
 int r=jsClearVideoFilters(); 
 return tp_number(r);
 }
-static tp_obj myCtor(tp_vm *vm)
+static tp_obj myCtorpyAdm(tp_vm *vm)
 {
 }
 tp_obj initClasspyAdm(tp_vm *vm)
 {
  tp_obj myClass=tp_class(vm);
- tp_set(vm,myClass,tp_string("__init__"),tp_fnc(vm,myCtor));
+ tp_set(vm,myClass,tp_string("__init__"),tp_fnc(vm,myCtorpyAdm));
  tp_set(vm,myClass,tp_string("loadVideo"),tp_fnc(vm,zzpy_loadVideo));
  tp_set(vm,myClass,tp_string("clearSegments"),tp_fnc(vm,zzpy_clearSegments));
  tp_set(vm,myClass,tp_string("appendVideo"),tp_fnc(vm,zzpy_appendVideo));

Modified: branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/py/update.make
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/py/update.make	2010-05-26 05:27:25 UTC (rev 6250)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/py/update.make	2010-05-26 05:27:27 UTC (rev 6251)
@@ -1,4 +1,7 @@
 OBJS=adm_gen.cpp editor_gen.cpp
-%_gen.cpp:%.idl
-        perl ../../../../cmake/admPyClass $%.idl
+%_gen.cpp:%.admPyClass
+	perl ../../../../cmake/admPyClass.pl  $<
 all: $(OBJS)
+
+clean:
+	rm -f $(OBJS)



From mean at mail.berlios.de  Wed May 26 07:27:29 2010
From: mean at mail.berlios.de (mean at BerliOS)
Date: Wed, 26 May 2010 07:27:29 +0200
Subject: [Avidemux-svn-commit] r6252 - in
	branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreTinyPy:
	include src
Message-ID: <201005260527.o4Q5RTBo030965@sheep.berlios.de>

Author: mean
Date: 2010-05-26 07:27:29 +0200 (Wed, 26 May 2010)
New Revision: 6252

Modified:
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreTinyPy/include/ADM_tinypy.h
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreTinyPy/src/ADM_tinypy.cpp
Log:
[tinypy] Add register class

Modified: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreTinyPy/include/ADM_tinypy.h
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreTinyPy/include/ADM_tinypy.h	2010-05-26 05:27:27 UTC (rev 6251)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreTinyPy/include/ADM_tinypy.h	2010-05-26 05:27:29 UTC (rev 6252)
@@ -25,6 +25,8 @@
     tp_obj (*funcCall)(TP);
 }pyFuncs;
 typedef bool (pyLoggerFunc)(const char *);
+
+typedef tp_obj (pyRegisterClass)(tp_vm *vm);
 /**
     \class tinyPy
 */
@@ -36,6 +38,7 @@
                 tinyPy(void);
         bool    init(void);
         bool    registerFuncs(const char *group,pyFuncs *funcs);
+        bool    registerClass(const char *className,pyRegisterClass *pyclass);
                 ~tinyPy(void);
         bool    execString(const char *s);
         bool    execFile(const char *f);

Modified: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreTinyPy/src/ADM_tinypy.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreTinyPy/src/ADM_tinypy.cpp	2010-05-26 05:27:27 UTC (rev 6251)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreTinyPy/src/ADM_tinypy.cpp	2010-05-26 05:27:29 UTC (rev 6252)
@@ -167,7 +167,16 @@
     }
     return true;
 }
+/**
+    \fn registerClass
+*/
+bool    tinyPy::registerClass(const char *className,pyRegisterClass classPy)
+{
+    ADM_info("Registering class:%s\n",className);
+    tp_set(INSTANCE, INSTANCE->builtins, tp_string(className), classPy(INSTANCE));
+    return true;
 
+}
 /**
     \fn dumpBuiltin
 */



From mean at mail.berlios.de  Wed May 26 07:27:31 2010
From: mean at mail.berlios.de (mean at BerliOS)
Date: Wed, 26 May 2010 07:27:31 +0200
Subject: [Avidemux-svn-commit] r6253 -
	branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/py
Message-ID: <201005260527.o4Q5RVf4031092@sheep.berlios.de>

Author: mean
Date: 2010-05-26 07:27:30 +0200 (Wed, 26 May 2010)
New Revision: 6253

Added:
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/py/editor_gen.cpp
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/py/editor_gen.h
Log:
[py] Add editor generated glue

Added: branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/py/editor_gen.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/py/editor_gen.cpp	2010-05-26 05:27:29 UTC (rev 6252)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/py/editor_gen.cpp	2010-05-26 05:27:30 UTC (rev 6253)
@@ -0,0 +1,32 @@
+// Generated by admPyClass.pl do not edit !
+//int  jsPrintTiming <int >
+tp_obj zzpy_printTiming(TP)
+{
+int p0=TP_NUM();
+int r=jsPrintTiming(p0); 
+return tp_number(r);
+}
+//int  jsDumpSegments <void>
+tp_obj zzpy_dumpSegment(TP)
+{
+int r=jsDumpSegments(); 
+return tp_number(r);
+}
+//int  jsDumpRefVideos <void>
+tp_obj zzpy_dumpRefVideo(TP)
+{
+int r=jsDumpRefVideos(); 
+return tp_number(r);
+}
+static tp_obj myCtorpyEditor(tp_vm *vm)
+{
+}
+tp_obj initClasspyEditor(tp_vm *vm)
+{
+ tp_obj myClass=tp_class(vm);
+ tp_set(vm,myClass,tp_string("__init__"),tp_fnc(vm,myCtorpyEditor));
+ tp_set(vm,myClass,tp_string("printTiming"),tp_fnc(vm,zzpy_printTiming));
+ tp_set(vm,myClass,tp_string("dumpSegment"),tp_fnc(vm,zzpy_dumpSegment));
+ tp_set(vm,myClass,tp_string("dumpRefVideo"),tp_fnc(vm,zzpy_dumpRefVideo));
+ return myClass;
+}

Added: branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/py/editor_gen.h
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/py/editor_gen.h	2010-05-26 05:27:29 UTC (rev 6252)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/py/editor_gen.h	2010-05-26 05:27:30 UTC (rev 6253)
@@ -0,0 +1,3 @@
+int  printTiming (int );
+int  dumpSegment (void);
+int  dumpRefVideo (void);



From mean at mail.berlios.de  Wed May 26 07:27:32 2010
From: mean at mail.berlios.de (mean at BerliOS)
Date: Wed, 26 May 2010 07:27:32 +0200
Subject: [Avidemux-svn-commit] r6254 -
	branches/avidemux_2.6_branch_mean/cmake
Message-ID: <201005260527.o4Q5RWBT031211@sheep.berlios.de>

Author: mean
Date: 2010-05-26 07:27:31 +0200 (Wed, 26 May 2010)
New Revision: 6254

Added:
   branches/avidemux_2.6_branch_mean/cmake/admPyFunc.pl
Log:
[build] rename

Added: branches/avidemux_2.6_branch_mean/cmake/admPyFunc.pl
===================================================================
--- branches/avidemux_2.6_branch_mean/cmake/admPyFunc.pl	2010-05-26 05:27:30 UTC (rev 6253)
+++ branches/avidemux_2.6_branch_mean/cmake/admPyFunc.pl	2010-05-26 05:27:31 UTC (rev 6254)
@@ -0,0 +1,192 @@
+use strict;
+my $input;
+my $output;
+my $headerFile;
+my $line;
+my $glueprefix="zzpy_";
+my $functionPrefix="";
+my @allFuncs;
+#
+#
+#
+sub genReturn
+{
+        my $retType=shift;
+        if($retType=~m/int/)
+        {
+                return "return tp_number(r);";
+        }
+        if($retType=~m/float/)
+        {
+                return "return tp_number(r);";
+        }
+        if($retType=~m/void/)
+        {
+                return "";
+        }
+        return "???? $retType";
+}
+#
+#
+#
+sub castFrom
+{
+        my $type=shift;
+        if($type=~m/^char/)
+        {
+                return "(char *)TP_STR().string.val";
+        }
+        if($type=~m/^int/)
+        {
+                return "TP_NUM()";
+        }
+        if($type=~m/^float/)
+        {
+                return "TP_NUM()";
+        }
+        return "????";
+
+}
+#
+# Generate the locals / wrapping for the parameters
+#
+sub genParam
+{
+        my $num=shift;
+        my $type=shift;
+        print OUTPUT "$type p".$num."=";
+        print OUTPUT castFrom($type);
+        print OUTPUT ";\n"; 
+}
+#
+# Process a function declaration and write the glue code to do tinypy<->function call
+#
+sub processFunc
+{
+        my $proto=shift;
+        my $args=$proto;
+        my @params;
+        my $retType=$proto;;
+        my $func=$proto;;
+        my $cfunc;
+        $args=~s/^.*\(//g;
+        $args=~s/\).*$//g;
+        #print "args => $args\n";
+        @params=split ",",$args;
+        #print "params -> @params\n";
+        # Get return type...
+        $retType=~s/^ *//g;
+        $retType=~s/ .*$//g;
+        # get functioName
+        $func=~s/ *\(.*$//g;
+        $func=~s/^.* //g;
+        ($cfunc,$func)=split ":",$func;
+        print OUTPUT "//$retType  $cfunc <@params>\n";
+        # Write glue code
+        print OUTPUT "tp_obj ".$glueprefix.$func."(TP)\n";
+        push(@allFuncs,$func);
+        print OUTPUT "{\n";
+        my $nb=scalar(@params);
+        my $i;
+        for($i=0;$i<$nb;$i++)
+        {
+                $params[$i]=~s/^ *//g; # Remove " " at the beginning if any
+                $params[$i]=~s/ *$//g; # Remove " " at the end if any
+        }
+        if($params[0]=~m/^void$/)
+        {
+                $nb=0;
+        }
+        print " New function : $retType,$func,<@params>\n";
+        
+        print HEADER "$retType  $functionPrefix".$func." ($args);\n";
+
+
+        for($i=0;$i<$nb;$i++)
+        {
+                genParam($i,$params[$i]);
+        }
+        # Call real function
+        if(!($retType=~m/^void$/))
+        {
+                print OUTPUT $retType." r=";
+        }
+        print OUTPUT $functionPrefix.$cfunc."(";
+        for($i=0;$i<$nb;$i++)
+        {
+                if($i)
+                {
+                        print OUTPUT ",";
+                }
+                print OUTPUT "p".$i;
+        } 
+        print OUTPUT "); \n";
+        # Cast r to pyobj
+        print OUTPUT genReturn($retType);
+        print OUTPUT "\n}\n";
+
+
+}
+
+
+if(scalar(@ARGV)!=1)
+{
+        die("admPy inputfile\n");
+}
+$input=$ARGV[0];
+$output=$input;
+$output=~s/\..*$//g;
+my $thisfile=$output;
+$thisfile=~s/^.*\///g;
+$headerFile=$output."_gen.h";
+$output=$output."_gen.cpp";
+print "Processing $input=>$output\n";
+open(OUTPUT,">$output") or die("Cannot open $output");
+##
+## Main Loop
+##
+# 1 grab all functions
+open(INPUT,$input) or die("Cannot open $input");
+close(INPUT);
+# Process them
+open(INPUT,$input) or die("Cannot open $input");
+open(HEADER,">$headerFile") or die("Cannot open $headerFile");
+while($line=<INPUT>)
+{
+        chomp($line);
+        if($line=~m/^#/)
+        {
+        }
+        else
+        {
+            if($line=~m/\* FUNC \*/)
+            {
+                my $proto=$line;
+                # Remove header...
+                # Remove tail
+                $line=~s/^.*\*\///g;
+                $line=~s/\/\/.*$//g;
+                processFunc($line);
+
+            }
+        }
+}
+# gen init array
+my $nbFunc=scalar(@allFuncs);
+my $i;
+print OUTPUT "pyFuncs ".$thisfile."_functions[]={\n";
+for($i=0;$i<$nbFunc;$i++)
+{
+                my $line=$allFuncs[$i];
+                #print "Function : $line\n";
+                my $funcName;
+                my $funcProto;
+                $funcName="\"".$line."\"";
+                $funcProto=$glueprefix.$line;
+                print OUTPUT "{$funcName,$funcProto},\n";
+}
+print OUTPUT "{NULL,NULL}\n};\n";
+close(INPUT);
+close(OUTPUT);
+close(HEADER);
+print "done\n.";



From mean at mail.berlios.de  Wed May 26 07:27:33 2010
From: mean at mail.berlios.de (mean at BerliOS)
Date: Wed, 26 May 2010 07:27:33 +0200
Subject: [Avidemux-svn-commit] r6255 -
	branches/avidemux_2.6_branch_mean/cmake
Message-ID: <201005260527.o4Q5RX4j031331@sheep.berlios.de>

Author: mean
Date: 2010-05-26 07:27:33 +0200 (Wed, 26 May 2010)
New Revision: 6255

Removed:
   branches/avidemux_2.6_branch_mean/cmake/admPy.pl
Log:
[build] Remove old admPy.pl

Deleted: branches/avidemux_2.6_branch_mean/cmake/admPy.pl
===================================================================
--- branches/avidemux_2.6_branch_mean/cmake/admPy.pl	2010-05-26 05:27:31 UTC (rev 6254)
+++ branches/avidemux_2.6_branch_mean/cmake/admPy.pl	2010-05-26 05:27:33 UTC (rev 6255)
@@ -1,192 +0,0 @@
-use strict;
-my $input;
-my $output;
-my $headerFile;
-my $line;
-my $glueprefix="zzpy_";
-my $functionPrefix="";
-my @allFuncs;
-#
-#
-#
-sub genReturn
-{
-        my $retType=shift;
-        if($retType=~m/int/)
-        {
-                return "return tp_number(r);";
-        }
-        if($retType=~m/float/)
-        {
-                return "return tp_number(r);";
-        }
-        if($retType=~m/void/)
-        {
-                return "";
-        }
-        return "???? $retType";
-}
-#
-#
-#
-sub castFrom
-{
-        my $type=shift;
-        if($type=~m/^char/)
-        {
-                return "(char *)TP_STR().string.val";
-        }
-        if($type=~m/^int/)
-        {
-                return "TP_NUM()";
-        }
-        if($type=~m/^float/)
-        {
-                return "TP_NUM()";
-        }
-        return "????";
-
-}
-#
-# Generate the locals / wrapping for the parameters
-#
-sub genParam
-{
-        my $num=shift;
-        my $type=shift;
-        print OUTPUT "$type p".$num."=";
-        print OUTPUT castFrom($type);
-        print OUTPUT ";\n"; 
-}
-#
-# Process a function declaration and write the glue code to do tinypy<->function call
-#
-sub processFunc
-{
-        my $proto=shift;
-        my $args=$proto;
-        my @params;
-        my $retType=$proto;;
-        my $func=$proto;;
-        my $cfunc;
-        $args=~s/^.*\(//g;
-        $args=~s/\).*$//g;
-        #print "args => $args\n";
-        @params=split ",",$args;
-        #print "params -> @params\n";
-        # Get return type...
-        $retType=~s/^ *//g;
-        $retType=~s/ .*$//g;
-        # get functioName
-        $func=~s/ *\(.*$//g;
-        $func=~s/^.* //g;
-        ($cfunc,$func)=split ":",$func;
-        print OUTPUT "//$retType  $cfunc <@params>\n";
-        # Write glue code
-        print OUTPUT "tp_obj ".$glueprefix.$func."(TP)\n";
-        push(@allFuncs,$func);
-        print OUTPUT "{\n";
-        my $nb=scalar(@params);
-        my $i;
-        for($i=0;$i<$nb;$i++)
-        {
-                $params[$i]=~s/^ *//g; # Remove " " at the beginning if any
-                $params[$i]=~s/ *$//g; # Remove " " at the end if any
-        }
-        if($params[0]=~m/^void$/)
-        {
-                $nb=0;
-        }
-        print " New function : $retType,$func,<@params>\n";
-        
-        print HEADER "$retType  $functionPrefix".$func." ($args);\n";
-
-
-        for($i=0;$i<$nb;$i++)
-        {
-                genParam($i,$params[$i]);
-        }
-        # Call real function
-        if(!($retType=~m/^void$/))
-        {
-                print OUTPUT $retType." r=";
-        }
-        print OUTPUT $functionPrefix.$cfunc."(";
-        for($i=0;$i<$nb;$i++)
-        {
-                if($i)
-                {
-                        print OUTPUT ",";
-                }
-                print OUTPUT "p".$i;
-        } 
-        print OUTPUT "); \n";
-        # Cast r to pyobj
-        print OUTPUT genReturn($retType);
-        print OUTPUT "\n}\n";
-
-
-}
-
-
-if(scalar(@ARGV)!=1)
-{
-        die("admPy inputfile\n");
-}
-$input=$ARGV[0];
-$output=$input;
-$output=~s/\..*$//g;
-my $thisfile=$output;
-$thisfile=~s/^.*\///g;
-$headerFile=$output."_gen.h";
-$output=$output."_gen.cpp";
-print "Processing $input=>$output\n";
-open(OUTPUT,">$output") or die("Cannot open $output");
-##
-## Main Loop
-##
-# 1 grab all functions
-open(INPUT,$input) or die("Cannot open $input");
-close(INPUT);
-# Process them
-open(INPUT,$input) or die("Cannot open $input");
-open(HEADER,">$headerFile") or die("Cannot open $headerFile");
-while($line=<INPUT>)
-{
-        chomp($line);
-        if($line=~m/^#/)
-        {
-        }
-        else
-        {
-            if($line=~m/\* FUNC \*/)
-            {
-                my $proto=$line;
-                # Remove header...
-                # Remove tail
-                $line=~s/^.*\*\///g;
-                $line=~s/\/\/.*$//g;
-                processFunc($line);
-
-            }
-        }
-}
-# gen init array
-my $nbFunc=scalar(@allFuncs);
-my $i;
-print OUTPUT "pyFuncs ".$thisfile."_functions[]={\n";
-for($i=0;$i<$nbFunc;$i++)
-{
-                my $line=$allFuncs[$i];
-                #print "Function : $line\n";
-                my $funcName;
-                my $funcProto;
-                $funcName="\"".$line."\"";
-                $funcProto=$glueprefix.$line;
-                print OUTPUT "{$funcName,$funcProto},\n";
-}
-print OUTPUT "{NULL,NULL}\n};\n";
-close(INPUT);
-close(OUTPUT);
-close(HEADER);
-print "done\n.";



From mean at mail.berlios.de  Wed May 26 07:36:48 2010
From: mean at mail.berlios.de (mean at BerliOS)
Date: Wed, 26 May 2010 07:36:48 +0200
Subject: [Avidemux-svn-commit] r6256 - in
	branches/avidemux_2.6_branch_mean/avidemux:
	cli/ADM_userInterfaces/ADM_dialog gtk/ADM_userInterfaces/ADM_dialog
Message-ID: <201005260536.o4Q5amIP016684@sheep.berlios.de>

Author: mean
Date: 2010-05-26 07:36:46 +0200 (Wed, 26 May 2010)
New Revision: 6256

Modified:
   branches/avidemux_2.6_branch_mean/avidemux/cli/ADM_userInterfaces/ADM_dialog/DIA_none.cpp
   branches/avidemux_2.6_branch_mean/avidemux/gtk/ADM_userInterfaces/ADM_dialog/DIA_xvid.cpp
Log:
[cli/gtk] Fix build with new ffmpeg

Modified: branches/avidemux_2.6_branch_mean/avidemux/cli/ADM_userInterfaces/ADM_dialog/DIA_none.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/cli/ADM_userInterfaces/ADM_dialog/DIA_none.cpp	2010-05-26 05:27:33 UTC (rev 6255)
+++ branches/avidemux_2.6_branch_mean/avidemux/cli/ADM_userInterfaces/ADM_dialog/DIA_none.cpp	2010-05-26 05:36:46 UTC (rev 6256)
@@ -13,7 +13,7 @@
  *   (at your option) any later version.                                   *
  *                                                                         *
  ***************************************************************************/
-
+#include "ADM_includeFfmpeg.h"
 #include "config.h"
 
 #include <string.h>

Modified: branches/avidemux_2.6_branch_mean/avidemux/gtk/ADM_userInterfaces/ADM_dialog/DIA_xvid.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/gtk/ADM_userInterfaces/ADM_dialog/DIA_xvid.cpp	2010-05-26 05:27:33 UTC (rev 6255)
+++ branches/avidemux_2.6_branch_mean/avidemux/gtk/ADM_userInterfaces/ADM_dialog/DIA_xvid.cpp	2010-05-26 05:36:46 UTC (rev 6256)
@@ -1,3 +1,4 @@
+#if 0
 #include "ADM_toolkitGtk.h"
 #include "ADM_lavcodec.h"
 
@@ -2,3 +3,2 @@
 
-#if 0
 //#include "ADM_encoder/ADM_vidEncode.hxx"



From mean at mail.berlios.de  Wed May 26 19:49:39 2010
From: mean at mail.berlios.de (mean at BerliOS)
Date: Wed, 26 May 2010 19:49:39 +0200
Subject: [Avidemux-svn-commit] r6257 - in branches/avidemux_2.6_branch_mean:
	cmake cmake_compile_check
Message-ID: <201005261749.o4QHndgQ029556@sheep.berlios.de>

Author: mean
Date: 2010-05-26 19:49:37 +0200 (Wed, 26 May 2010)
New Revision: 6257

Added:
   branches/avidemux_2.6_branch_mean/cmake_compile_check/check_vdpau.cpp
Modified:
   branches/avidemux_2.6_branch_mean/cmake/admCheckVDPAU.cmake
Log:
[vdpau] Check that the version has support for mpeg4 part2 so that libavcodec compiles

Modified: branches/avidemux_2.6_branch_mean/cmake/admCheckVDPAU.cmake
===================================================================
--- branches/avidemux_2.6_branch_mean/cmake/admCheckVDPAU.cmake	2010-05-26 05:36:46 UTC (rev 6256)
+++ branches/avidemux_2.6_branch_mean/cmake/admCheckVDPAU.cmake	2010-05-26 17:49:37 UTC (rev 6257)
@@ -15,10 +15,17 @@
 			FIND_HEADER_AND_LIB(VDPAU vdpau/vdpau.h )
 		
 			IF (VDPAU_FOUND)
-				SET(VDPAU_FOUND 1)
-				SET(USE_VDPAU 1)
-				SET(VDPAU_INCLUDE_DIR "${VDPAU_INCLUDE_DIR}")
-				SET(VDPAU_LIBRARY_DIR "${VDPAU_LIBRARY_DIR}")
+                                # CHECK That it has 
+                                ADM_COMPILE(check_vdpau.cpp "" "${VDPAU_INCLUDE_DIR}" "${VDPAU_LIBRARY_DIR}" VDPAU_COMPILE VDPAU_OUTPUT)
+                                IF(VDPAU_COMPILE)
+				        SET(VDPAU_FOUND 1)
+				        SET(USE_VDPAU 1)
+				        SET(VDPAU_INCLUDE_DIR "${VDPAU_INCLUDE_DIR}")
+				        SET(VDPAU_LIBRARY_DIR "${VDPAU_LIBRARY_DIR}")
+                                ELSE(VDPAU_COMPILE)
+                                        MESSAGE(STATUS "The vdpau found does not compile, probably too old ${VDPAU_OUTPUT}.")
+                                ENDIF(VDPAU_COMPILE)
+                                
 			ENDIF (VDPAU_FOUND)
 
 			PRINT_LIBRARY_INFO("VDPAU" VDPAU_FOUND "${VDPAU_INCLUDE_DIR}" "${VDPAU_LIBRARY_DIR}")

Added: branches/avidemux_2.6_branch_mean/cmake_compile_check/check_vdpau.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/cmake_compile_check/check_vdpau.cpp	2010-05-26 05:36:46 UTC (rev 6256)
+++ branches/avidemux_2.6_branch_mean/cmake_compile_check/check_vdpau.cpp	2010-05-26 17:49:37 UTC (rev 6257)
@@ -0,0 +1,9 @@
+#include <stdio.h>
+#include <stdlib.h>
+#include "vdpau/vdpau.h"
+#include "vdpau/vdpau_x11.h"
+int main(int argc, char **argv)
+{
+        VdpPictureInfoMPEG4Part2 m4;
+        return 0;
+}



From mean at mail.berlios.de  Wed May 26 20:16:16 2010
From: mean at mail.berlios.de (mean at BerliOS)
Date: Wed, 26 May 2010 20:16:16 +0200
Subject: [Avidemux-svn-commit] r6258 -
	branches/avidemux_2.6_branch_mean/avidemux_core/ADM_core/include
Message-ID: <201005261816.o4QIGG25009502@sheep.berlios.de>

Author: mean
Date: 2010-05-26 20:16:15 +0200 (Wed, 26 May 2010)
New Revision: 6258

Modified:
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_core/include/ADM_mangle.h
Log:
[build] Add LOCAL_MANGLE

Modified: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_core/include/ADM_mangle.h
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_core/include/ADM_mangle.h	2010-05-26 17:49:37 UTC (rev 6257)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_core/include/ADM_mangle.h	2010-05-26 18:16:15 UTC (rev 6258)
@@ -29,21 +29,22 @@
 #        define FUNNY_MANGLE(x) x asm(MANGLE(x))
 #        define FUNNY_MANGLE_ARRAY(x, y) x[y] asm(MANGLE(x))
 #    endif
-#else
+#else /////////////////  64 BITS UNICES
 #    if defined(ADM_CPU_X86_64) && defined(PIC)
 #        define MANGLE(a) #a"(%%rip)"
 #        define LOCAL_MANGLE(a) #a"(%%rip)"
 #        define FUNNY_MANGLE(x) x asm(#x)
 #        define FUNNY_MANGLE_ARRAY(x, y)  x[y] asm(#x)
-#    elif defined(__APPLE__)
+#    elif defined(__APPLE__) /////////////// MACOSX
 #        define MANGLE(a) "_" #a
 #        define LOCAL_MANGLE(a) #a"(%%rip)"
 #        define FUNNY_MANGLE(x) x asm(MANGLE(x))
 #        define FUNNY_MANGLE_ARRAY(x, y) x[y] asm(MANGLE(x))
-#    else
-#        define MANGLE(a) #a
-#        define FUNNY_MANGLE(x) x asm(MANGLE(x))
-#        define FUNNY_MANGLE_ARRAY(x, y) x[y] asm(MANGLE(x))
+#                else /////////////// LINUX //////////////
+#                   define MANGLE(a) #a
+#                   define LOCAL_MANGLE(a) #a
+#                   define FUNNY_MANGLE(x) x asm(MANGLE(x))
+#                   define FUNNY_MANGLE_ARRAY(x, y) x[y] asm(MANGLE(x))
 #    endif
 #endif
 



From mean at mail.berlios.de  Wed May 26 20:16:19 2010
From: mean at mail.berlios.de (mean at BerliOS)
Date: Wed, 26 May 2010 20:16:19 +0200
Subject: [Avidemux-svn-commit] r6259 - in
	branches/avidemux_2.6_branch_mean/avidemux: common
	qt4/ADM_userInterfaces/ADM_gui
Message-ID: <201005261816.o4QIGJKn009535@sheep.berlios.de>

Author: mean
Date: 2010-05-26 20:16:18 +0200 (Wed, 26 May 2010)
New Revision: 6259

Modified:
   branches/avidemux_2.6_branch_mean/avidemux/common/gui_action.names
   branches/avidemux_2.6_branch_mean/avidemux/common/gui_save.cpp
   branches/avidemux_2.6_branch_mean/avidemux/qt4/ADM_userInterfaces/ADM_gui/gui2.ui
   branches/avidemux_2.6_branch_mean/avidemux/qt4/ADM_userInterfaces/ADM_gui/translation_table.h
Log:
[UI] add hookd for pyScript

Modified: branches/avidemux_2.6_branch_mean/avidemux/common/gui_action.names
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/gui_action.names	2010-05-26 18:16:15 UTC (rev 6258)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/gui_action.names	2010-05-26 18:16:18 UTC (rev 6259)
@@ -19,6 +19,7 @@
 ACT(SaveWave)
 ACT(SaveRaw)
 ACT(SaveWork)
+ACT(SavePyWork)
 ACT(SaveCurrentWork)
 
 ACT(SAVE_END)

Modified: branches/avidemux_2.6_branch_mean/avidemux/common/gui_save.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/gui_save.cpp	2010-05-26 18:16:15 UTC (rev 6258)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/gui_save.cpp	2010-05-26 18:16:18 UTC (rev 6259)
@@ -53,7 +53,9 @@
 {
     switch(action)
     {
-
+    case ACT_SavePyWork:
+            GUI_Error_HIG("Py","Not implemented yet\n");
+            break;
     case ACT_SaveWork:
       GUI_FileSelWrite (QT_TR_NOOP("Select Project to Save"), A_saveWorkbench);
 	  UI_refreshCustomMenu();

Modified: branches/avidemux_2.6_branch_mean/avidemux/qt4/ADM_userInterfaces/ADM_gui/gui2.ui
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/qt4/ADM_userInterfaces/ADM_gui/gui2.ui	2010-05-26 18:16:15 UTC (rev 6258)
+++ branches/avidemux_2.6_branch_mean/avidemux/qt4/ADM_userInterfaces/ADM_gui/gui2.ui	2010-05-26 18:16:18 UTC (rev 6259)
@@ -1380,6 +1380,23 @@
     <addaction name="actionJump_to_Frame"/>
     <addaction name="actionJump_to_Time"/>
    </widget>
+   <widget class="QMenu" name="menuTools">
+    <property name="title">
+     <string>&amp;Tools</string>
+    </property>
+    <addaction name="actionCalculator"/>
+    <addaction name="separator"/>
+    <addaction name="actionRebuild_I_B_Frames"/>
+    <addaction name="actionBitrate_histogram"/>
+    <addaction name="actionScan_for_black_frames"/>
+    <addaction name="separator"/>
+    <addaction name="actionVob_to_vobsub"/>
+    <addaction name="actionOCR"/>
+    <addaction name="actionOCR_DVB_T_TS_files"/>
+    <addaction name="actionGlyphs_Edit"/>
+    <addaction name="actionJavaScript_shell"/>
+    <addaction name="actionPython_Shell"/>
+   </widget>
    <widget class="QMenu" name="menuFile">
     <property name="title">
      <string>&amp;File</string>
@@ -1411,8 +1428,10 @@
     <addaction name="actionProperties"/>
     <addaction name="separator"/>
     <addaction name="actionLoad_run_project"/>
+    <addaction name="actionLoad_run_pyProject"/>
     <addaction name="actionSave_project"/>
     <addaction name="actionSave_project_as"/>
+    <addaction name="actionSave_pyScript"/>
     <addaction name="separator"/>
     <addaction name="actionAdd_to_joblist"/>
     <addaction name="actionShow_Joblist"/>
@@ -1420,25 +1439,7 @@
     <addaction name="actionConnect_to_AvsProxy"/>
     <addaction name="separator"/>
     <addaction name="actionQuit"/>
-    <addaction name="actionRun_pyScript"/>
    </widget>
-   <widget class="QMenu" name="menuTools">
-    <property name="title">
-     <string>&amp;Tools</string>
-    </property>
-    <addaction name="actionCalculator"/>
-    <addaction name="separator"/>
-    <addaction name="actionRebuild_I_B_Frames"/>
-    <addaction name="actionBitrate_histogram"/>
-    <addaction name="actionScan_for_black_frames"/>
-    <addaction name="separator"/>
-    <addaction name="actionVob_to_vobsub"/>
-    <addaction name="actionOCR"/>
-    <addaction name="actionOCR_DVB_T_TS_files"/>
-    <addaction name="actionGlyphs_Edit"/>
-    <addaction name="actionJavaScript_shell"/>
-    <addaction name="actionPython_Shell"/>
-   </widget>
    <addaction name="menuFile"/>
    <addaction name="menuEdit"/>
    <addaction name="menuView"/>
@@ -2400,9 +2401,9 @@
     <string>16:9</string>
    </property>
   </action>
-  <action name="actionRun_pyScript">
+  <action name="actionSave_pyScript">
    <property name="text">
-    <string>Run pyScript</string>
+    <string>Save Project as pyScript</string>
    </property>
   </action>
   <action name="actionPython_Shell">
@@ -2410,6 +2411,16 @@
     <string>Python Shell</string>
    </property>
   </action>
+  <action name="actionSave_python_project_as">
+   <property name="text">
+    <string>Save python project as..</string>
+   </property>
+  </action>
+  <action name="actionLoad_run_pyProject">
+   <property name="text">
+    <string>Load/run pyProject</string>
+   </property>
+  </action>
  </widget>
  <customwidgets>
   <customwidget>

Modified: branches/avidemux_2.6_branch_mean/avidemux/qt4/ADM_userInterfaces/ADM_gui/translation_table.h
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/qt4/ADM_userInterfaces/ADM_gui/translation_table.h	2010-05-26 18:16:15 UTC (rev 6258)
+++ branches/avidemux_2.6_branch_mean/avidemux/qt4/ADM_userInterfaces/ADM_gui/translation_table.h	2010-05-26 18:16:18 UTC (rev 6259)
@@ -71,8 +71,9 @@
 PROCESS(actionShow_Joblist,ACT_HANDLE_JOB)  \
 PROCESS(actionPlugins,ACT_PLUGIN_INFO) \
 PROCESS(actionJavaScript_shell,ACT_JS_SHELL) \
-PROCESS(actionRun_pyScript,ACT_RunPyScript) \
+PROCESS(actionLoad_run_pyProject,ACT_RunPyScript) \
 PROCESS(actionPython_Shell,ACT_PY_SHELL) \
+PROCESS(actionSave_pyScript,ACT_SavePyWork) \
 
 #if 0
 PROCESS(actionPrevious_intra_frame,ACT_PreviousKFrame) \



From mean at mail.berlios.de  Wed May 26 21:04:58 2010
From: mean at mail.berlios.de (mean at BerliOS)
Date: Wed, 26 May 2010 21:04:58 +0200
Subject: [Avidemux-svn-commit] r6260 -
	branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_videoFilters6/resize
Message-ID: <201005261904.o4QJ4wUY023667@sheep.berlios.de>

Author: mean
Date: 2010-05-26 21:04:57 +0200 (Wed, 26 May 2010)
New Revision: 6260

Modified:
   branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_videoFilters6/resize/swScaleResize.cpp
Log:
[plugins] Fix swresize with new lavcodec

Modified: branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_videoFilters6/resize/swScaleResize.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_videoFilters6/resize/swScaleResize.cpp	2010-05-26 18:16:18 UTC (rev 6259)
+++ branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_videoFilters6/resize/swScaleResize.cpp	2010-05-26 19:04:57 UTC (rev 6260)
@@ -14,7 +14,7 @@
  *   (at your option) any later version.                                   *
  *                                                                         *
  ***************************************************************************/
-
+#include "ADM_includeFfmpeg.h"
 #include "ADM_default.h"
 #include "ADM_coreVideoFilterInternal.h"
 #include "DIA_factory.h"



From gruntster at mail.berlios.de  Thu May 27 21:20:34 2010
From: gruntster at mail.berlios.de (gruntster at mail.berlios.de)
Date: Thu, 27 May 2010 21:20:34 +0200
Subject: [Avidemux-svn-commit] r6261 - in
	branches/avidemux_2.5_branch_gruntster:
	platforms/windows/build_scripts
	platforms/windows/build_scripts/avidemux po
Message-ID: <201005271920.o4RJKYxx015674@sheep.berlios.de>

Author: gruntster
Date: 2010-05-27 21:20:29 +0200 (Thu, 27 May 2010)
New Revision: 6261

Modified:
   branches/avidemux_2.5_branch_gruntster/platforms/windows/build_scripts/Set Common Environment Variables.bat
   branches/avidemux_2.5_branch_gruntster/platforms/windows/build_scripts/avidemux/1c. Post-build.bat
   branches/avidemux_2.5_branch_gruntster/po/qt_update_pro.sh
Log:
[win32] bundle i18n files in sdk

Modified: branches/avidemux_2.5_branch_gruntster/platforms/windows/build_scripts/Set Common Environment Variables.bat
===================================================================
--- branches/avidemux_2.5_branch_gruntster/platforms/windows/build_scripts/Set Common Environment Variables.bat	2010-05-26 19:04:57 UTC (rev 6260)
+++ branches/avidemux_2.5_branch_gruntster/platforms/windows/build_scripts/Set Common Environment Variables.bat	2010-05-27 19:20:29 UTC (rev 6261)
@@ -79,7 +79,7 @@
 	goto error
 )
 
-set PATH=%PATH%;%cmakeDir%;%mingwDir%\bin;%usrLocalDir%\bin;%msysDir%\bin;%msysDir%\local32\bin;%qtDir%\bin
+set PATH=%cmakeDir%;%mingwDir%\bin;%usrLocalDir%\bin;%msysDir%\bin;%msysDir%\local32\bin;%qtDir%\bin;%PATH%
 
 goto end
 

Modified: branches/avidemux_2.5_branch_gruntster/platforms/windows/build_scripts/avidemux/1c. Post-build.bat
===================================================================
--- branches/avidemux_2.5_branch_gruntster/platforms/windows/build_scripts/avidemux/1c. Post-build.bat	2010-05-26 19:04:57 UTC (rev 6260)
+++ branches/avidemux_2.5_branch_gruntster/platforms/windows/build_scripts/avidemux/1c. Post-build.bat	2010-05-27 19:20:29 UTC (rev 6261)
@@ -74,4 +74,23 @@
 copy "%sourceDir%\avidemux\ADM_coreUI\include\DIA_uiTypes.h"
 copy "%sourceDir%\avidemux\ADM_encoder\ADM_vidEncode.hxx" ADM_encoder
 copy "%sourceDir%\avidemux\ADM_libraries\ffmpeg\libavutil\pixfmt.h" libavutil
-copy "%sourceDir%\avidemux\ADM_plugin\ADM_vidEnc_plugin.h"
\ No newline at end of file
+copy "%sourceDir%\avidemux\ADM_plugin\ADM_vidEnc_plugin.h"
+
+cd "%sourceDir%\po"
+svn revert -R .
+sh qt_update_pro.sh
+echo ./avidemux_blank.ts >> avidemux.pro
+lupdate avidemux.pro
+
+mkdir "%sdkBuildDir%\i18n"
+mkdir "%sdkBuildDir%\i18n\qt4"
+mkdir "%sdkBuildDir%\i18n\gtk"
+
+copy *.ts "%sdkBuildDir%\i18n\qt4"
+del avidemux_blank.ts
+
+sh update_pot.bash
+copy avidemux.pot "%sdkBuildDir%\i18n\gtk"
+for %%A in (*.po) do msgmerge %%A avidemux.pot -o "%sdkBuildDir%\i18n\gtk\%%A"
+
+svn revert -R .
\ No newline at end of file

Modified: branches/avidemux_2.5_branch_gruntster/po/qt_update_pro.sh
===================================================================
--- branches/avidemux_2.5_branch_gruntster/po/qt_update_pro.sh	2010-05-26 19:04:57 UTC (rev 6260)
+++ branches/avidemux_2.5_branch_gruntster/po/qt_update_pro.sh	2010-05-27 19:20:29 UTC (rev 6261)
@@ -24,6 +24,5 @@
 echo "Finding TRANSLATIONS..."
 echo "TRANSLATIONS = \\" >> avidemux.pro
 find . -iname 'avidemux_*.ts' -printf "%p \\\ \n" >> avidemux.pro
-echo "" >> avidemux.pro
 
 echo "DONE."



From mean at mail.berlios.de  Fri May 28 19:12:01 2010
From: mean at mail.berlios.de (mean at BerliOS)
Date: Fri, 28 May 2010 19:12:01 +0200
Subject: [Avidemux-svn-commit] r6262 - in
	branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg:
	libavutil patches
Message-ID: <201005281712.o4SHC1gF006633@sheep.berlios.de>

Author: mean
Date: 2010-05-28 19:11:59 +0200 (Fri, 28 May 2010)
New Revision: 6262

Added:
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavutil_lfg.h
Modified:
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavutil/lfg.h
Log:
[lfg] patch for win32

Modified: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavutil/lfg.h
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavutil/lfg.h	2010-05-27 19:20:29 UTC (rev 6261)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavutil/lfg.h	2010-05-28 17:11:59 UTC (rev 6262)
@@ -21,7 +21,7 @@
 
 #ifndef AVUTIL_LFG_H
 #define AVUTIL_LFG_H
-
+#define index xindex // MEANX
 typedef struct {
     unsigned int state[64];
     int index;

Added: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavutil_lfg.h
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavutil_lfg.h	2010-05-27 19:20:29 UTC (rev 6261)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavutil_lfg.h	2010-05-28 17:11:59 UTC (rev 6262)
@@ -0,0 +1,13 @@
+diff --git a/avidemux_core/ADM_ffmpeg/libavutil/lfg.h b/avidemux_core/ADM_ffmpeg/libavutil/lfg.h
+index ac89d12..56e86a1 100644
+--- a/avidemux_core/ADM_ffmpeg/libavutil/lfg.h
++++ b/avidemux_core/ADM_ffmpeg/libavutil/lfg.h
+@@ -21,7 +21,7 @@
+ 
+ #ifndef AVUTIL_LFG_H
+ #define AVUTIL_LFG_H
+-
++#define index xindex // MEANX
+ typedef struct {
+     unsigned int state[64];
+     int index;



From mean at mail.berlios.de  Fri May 28 19:12:06 2010
From: mean at mail.berlios.de (mean at BerliOS)
Date: Fri, 28 May 2010 19:12:06 +0200
Subject: [Avidemux-svn-commit] r6263 - in
	branches/avidemux_2.6_branch_mean/avidemux/common: . ADM_editor
Message-ID: <201005281712.o4SHC60F006768@sheep.berlios.de>

Author: mean
Date: 2010-05-28 19:12:04 +0200 (Fri, 28 May 2010)
New Revision: 6263

Added:
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_editor/ADM_edPySave.cpp
Modified:
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_editor/ADM_edit.hxx
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_editor/CMakeLists.txt
   branches/avidemux_2.6_branch_mean/avidemux/common/gui_save.cpp
Log:
[editor] PyProject

Added: branches/avidemux_2.6_branch_mean/avidemux/common/ADM_editor/ADM_edPySave.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/ADM_editor/ADM_edPySave.cpp	2010-05-28 17:11:59 UTC (rev 6262)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/ADM_editor/ADM_edPySave.cpp	2010-05-28 17:12:04 UTC (rev 6263)
@@ -0,0 +1,246 @@
+/***************************************************************************
+                          ADM_edLoadSave.cpp  -  description
+                             -------------------
+
+	Save / load workbench
+
+    begin                : Thu Feb 28 2002
+    copyright            : (C) 2002 by mean
+    email                : fixounet at free.fr
+ ***************************************************************************/
+
+/***************************************************************************
+ *                                                                         *
+ *   This program is free software; you can redistribute it and/or modify  *
+ *   it under the terms of the GNU General Public License as published by  *
+ *   the Free Software Foundation; either version 2 of the License, or     *
+ *   (at your option) any later version.                                   *
+ *                                                                         *
+ ***************************************************************************/
+#include "ADM_default.h"
+#include "fourcc.h"
+#include "ADM_quota.h"
+#include "ADM_editor/ADM_edit.hxx"
+
+#include "audioEncoderApi.h"
+#include "DIA_coreToolkit.h"
+#include "ADM_editor/ADM_edit.hxx"
+#include "ADM_videoEncoderApi.h"
+#include "ADM_paramList.h"
+#include "prefs.h"
+#include "avi_vars.h"
+#include "ADM_muxerProto.h"
+#include "ADM_audioFilterInterface.h"
+#include "GUI_ui.h"
+#include "ADM_videoFilters.h"
+#include "ADM_videoFilterApi.h"
+#include "errno.h"
+/**
+    \fn dumpConf
+    \brief dump configuration as name=value pairs
+*/
+static void dumpConf(FILE *fd,CONFcouple *c)
+{
+ if(!c) return;
+        
+    uint32_t n=c->getSize();
+    for(int j=0;j<n;j++)
+    {
+        char *name,*value;
+        c->getInternalName(j,&name,&value);
+        qfprintf(fd,",\"%s=%s\"",name,value);
+    }
+    delete c;
+    c=NULL;
+}
+/**
+    \fn        saveAsPyScript
+    \brief     Save the project as a python script
+*/
+bool ADM_Composer::saveAsPyScript (const char *name)
+{
+    const char *truefalse[]={"false","true"};
+    ADM_info(" **Saving pyScript project %s**\n",name);
+    char *    tmp;
+
+    if (!_segments.getNbSegments())
+        return 1;
+
+    FILE *fd=NULL;
+
+    if( !(fd = qfopen (name, "wt")) )
+    {
+        ADM_error("Cannot save python script file %s for writing (er:%d %s)\n",
+                   name, errno, strerror(errno));
+        return false;
+    }
+
+// Save source and segment
+//______________________________________________
+  qfprintf( fd, "#PY  <- Needed to identify");
+  qfprintf (fd, "#\n");
+  qfprintf (fd, "#--automatically built--\n");
+  qfprintf (fd, "#--Project: %s\n\n",name);
+
+  qfprintf (fd,"#** Video **\n");
+  qfprintf (fd,"# %02ld videos source \n", _segments.getNbRefVideos());
+  qfprintf (fd,"adm=Avidemux();\n");
+
+  char *nm;
+  
+
+  for (uint32_t i = 0; i < _segments.getNbRefVideos(); i++)
+    {
+        nm=ADM_cleanupPath(_segments.getRefVideo(i)->_aviheader->getMyName() );
+        if(!i)
+        {
+                qfprintf (fd, "adm.loadVideo(\"%s\");\n", nm);
+        }
+        else
+        {
+                qfprintf (fd, "adm.appendVideo(\"%s\");\n", nm);
+        }
+        ADM_dealloc(nm);
+    }
+
+  qfprintf (fd,"#%02ld segments\n", _segments.getNbSegments());
+  qfprintf (fd,"adm.clearSegments();\n");
+  
+ 
+
+    for (uint32_t i = 0; i < _segments.getNbSegments(); i++)
+    {
+        _SEGMENT *seg=_segments.getSegment(i);
+        qfprintf (fd, "adm.addSegment(%"LU",%"LLU",%"LLU");\n",seg->_reference,seg->_refStartTimeUs,seg->_durationUs);
+    }
+
+// Markers
+//
+
+        qfprintf(fd,"adm.markerA=%"LLU";\n",getMarkerAPts());
+        qfprintf(fd,"adm.markerB=%"LLU";\n",getMarkerBPts());
+
+// postproc
+//___________________________
+
+uint32_t pptype, ppstrength,ppswap;
+        video_body->getPostProc( &pptype, &ppstrength, &ppswap);
+        qfprintf(fd,"\n#** Postproc **\n");
+        qfprintf(fd,"adm.setPostProc(%d,%d,%d);\n",pptype,ppstrength,ppswap);
+
+// Video codec
+//___________________________
+        
+		qfprintf(fd, "\n#** Video Codec conf **\n");
+        CONFcouple *couples=NULL;
+    
+        qfprintf(fd, "adm.videoCodec(\"%s\"", videoEncoder6_GetCurrentEncoderName());
+        videoEncoder6_GetConfiguration(&couples);
+        dumpConf(fd,couples);
+        qfprintf(fd,");\n");
+
+// Video filters....
+//______________________________________________
+    qfprintf(fd,"\n#** Filters **\n");
+    int nbFilter=ADM_vf_getSize();
+    for(int i=0;i<nbFilter;i++)
+    {
+        // Grab its name...
+        uint32_t tag=ADM_vf_getTag(i);
+        qfprintf(fd, "adm.addVideoFilter(\"%s\"", ADM_vf_getInternalNameFromTag(tag));
+        // Now get the filter settings (if any)
+        CONFcouple *c=NULL;
+        ADM_vf_getConfigurationFromIndex(i,&c);
+        dumpConf(fd,c);
+        qfprintf(fd, ");\n");
+    }
+
+
+// Audio Source
+//______________________________________________
+
+// Audio
+//______________________________________________
+
+   uint32_t delay,bitrate;
+   
+   qfprintf(fd,"\n#** Audio **\n");
+   qfprintf(fd,"adm.audioReset();\n");
+#if 0
+   // External audio ?
+        char *audioName;
+        AudioSource  source;
+
+        source=getCurrentAudioSource(&audioName);
+        if(!audioName) audioName="";
+
+        if(source!=AudioAvi)
+        {
+                char *nm=ADM_cleanupPath(audioName);
+                qfprintf(fd,"app.audio.load(\"%s\",\"%s\");\n", audioSourceFromEnum(source),nm); 
+                ADM_dealloc(nm);
+        }
+        else 
+        { // Maybe not the 1st track
+          int source;
+               source=video_body->getCurrentAudioStreamNumber(0);
+               if(source)
+                        qfprintf(fd,"app.audio.setTrack(%d);\n", source); 
+                        
+        }
+#endif
+   couples=NULL;
+   getAudioExtraConf(&bitrate,&couples);
+    qfprintf(fd,"adm.audioCodec(\"%s\",%d",audioCodecGetName(),bitrate); 
+    dumpConf(fd,couples);
+    qfprintf(fd,");\n");
+
+
+    uint32_t x=audioFilterGetResample();
+    if(x) qfprintf(fd,"adm.audioResample=%u;\n",audioFilterGetResample());
+
+    
+//   qfprintf(fd,"app.audio.normalizeMode=%d;\n",audioGetNormalizeMode());
+//   qfprintf(fd,"app.audio.normalizeValue=%d;\n",audioGetNormalizeValue());
+//   qfprintf(fd,"app.audio.delay=%d;\n",audioGetDelay());
+// if (audioGetDrc()) qfprintf(fd,"app.audio.drc=true;\n");
+   if(CHANNEL_INVALID!=audioFilterGetMixer())
+        qfprintf(fd,"adm.audioMixer(\"%s\");\n",AudioMixerIdToString(audioFilterGetMixer()));
+
+   
+
+   // Change fps ?
+        switch(audioFilterGetFrameRate())
+        {
+                case FILMCONV_NONE:      ;break;
+                case FILMCONV_PAL2FILM:  qfprintf(fd,"adm.audioPal2film=1;\n");break;
+                case FILMCONV_FILM2PAL:  qfprintf(fd,"adm.audioFilm2pal=1;\n");break;
+                default:ADM_assert(0);
+        }
+   
+       
+        
+  
+  // -------- Muxer -----------------------
+        qfprintf(fd,"\n#** Muxer **\n");
+        CONFcouple *containerConf=NULL;
+        uint32_t index=UI_GetCurrentFormat();
+        const char *containerName=ADM_mx_getName(index);
+        ADM_mx_getExtraConf( index,&containerConf);
+        
+        qfprintf(fd,"adm.setContainer(\"%s\"",containerName); 
+        dumpConf(fd,containerConf);
+        qfprintf(fd,");\n");
+  // -------- /Muxer -----------------------
+        qfprintf(fd,"setSuccess(%d);\n",1);
+        qfprintf(fd,"#adm.Exit();\n");
+        qfprintf(fd,"\n#End of script\n");
+        // All done
+        qfclose (fd);
+  
+  return 1;
+
+
+}
+
+//EOF

Modified: branches/avidemux_2.6_branch_mean/avidemux/common/ADM_editor/ADM_edit.hxx
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/ADM_editor/ADM_edit.hxx	2010-05-28 17:11:59 UTC (rev 6262)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/ADM_editor/ADM_edit.hxx	2010-05-28 17:12:04 UTC (rev 6263)
@@ -135,6 +135,7 @@
 virtual                         ~ADM_Composer();
                     void        clean( void );
                     uint8_t     saveAsScript (const char *name, const char *out);
+                    bool        saveAsPyScript(const char *name);
                     uint8_t     resetSeg( void );
                     bool     	addFile (const char *name);
                     uint8_t 	cleanup( void);

Modified: branches/avidemux_2.6_branch_mean/avidemux/common/ADM_editor/CMakeLists.txt
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/ADM_editor/CMakeLists.txt	2010-05-28 17:11:59 UTC (rev 6262)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/ADM_editor/CMakeLists.txt	2010-05-28 17:12:04 UTC (rev 6263)
@@ -13,6 +13,7 @@
 ADM_edPtsDts.cpp
 ADM_edVideoCopy.cpp
 ADM_segment.cpp
+ADM_edPySave.cpp
 )
 
 ADD_LIBRARY(ADM_editor6 STATIC ${ADM_editor_SRCS})

Modified: branches/avidemux_2.6_branch_mean/avidemux/common/gui_save.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/gui_save.cpp	2010-05-28 17:11:59 UTC (rev 6262)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/gui_save.cpp	2010-05-28 17:12:04 UTC (rev 6263)
@@ -38,6 +38,7 @@
 void A_saveImg (const char *name);
 uint8_t ADM_saveRaw (const char *name);
 void A_saveWorkbench (const char *name);
+void A_savePyProject (const char *name);
 int  A_audioSave(char *name);
 int  A_SaveWrapper(char *name);
 void A_saveAudioProcessed (char *name);
@@ -54,7 +55,8 @@
     switch(action)
     {
     case ACT_SavePyWork:
-            GUI_Error_HIG("Py","Not implemented yet\n");
+            GUI_FileSelWrite (QT_TR_NOOP("Select pyProject to Save"), A_savePyProject);
+            UI_refreshCustomMenu();
             break;
     case ACT_SaveWork:
       GUI_FileSelWrite (QT_TR_NOOP("Select Project to Save"), A_saveWorkbench);
@@ -446,7 +448,16 @@
   video_body->saveAsScript(name,NULL);
   video_body->setProjectName(name);
 }
+
 /**
+    \fn A_savePyProject
+    \brief Save workbench as pyscript
+*/
+void A_savePyProject (const char *name)
+{
+  video_body->saveAsPyScript(name);
+}
+/**
     \fn A_SaveWrapper
 
 */



From mean at mail.berlios.de  Fri May 28 19:12:09 2010
From: mean at mail.berlios.de (mean at BerliOS)
Date: Fri, 28 May 2010 19:12:09 +0200
Subject: [Avidemux-svn-commit] r6264 - in branches/avidemux_2.6_branch_mean:
	avidemux/common/ADM_editor avidemux/common/ADM_script2/py
	avidemux/common/ADM_script2/src avidemux/common/ADM_toolkit
	avidemux_core/ADM_coreTinyPy/include
	avidemux_core/ADM_coreTinyPy/src
Message-ID: <201005281712.o4SHC9J2006863@sheep.berlios.de>

Author: mean
Date: 2010-05-28 19:12:08 +0200 (Fri, 28 May 2010)
New Revision: 6264

Modified:
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_editor/ADM_edPySave.cpp
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/py/ADM_pyAdm.cpp
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/py/adm.admPyClass
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/py/adm_gen.cpp
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/py/adm_gen.h
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src/ADM_scriptIf.cpp
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_toolkit/automation.cpp
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreTinyPy/include/ADM_tinypy.h
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreTinyPy/src/ADM_tinypy.cpp
Log:
[py] tweak pyScript read/write, add --runpy cli command

Modified: branches/avidemux_2.6_branch_mean/avidemux/common/ADM_editor/ADM_edPySave.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/ADM_editor/ADM_edPySave.cpp	2010-05-28 17:12:04 UTC (rev 6263)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/ADM_editor/ADM_edPySave.cpp	2010-05-28 17:12:08 UTC (rev 6264)
@@ -84,7 +84,7 @@
 
   qfprintf (fd,"#** Video **\n");
   qfprintf (fd,"# %02ld videos source \n", _segments.getNbRefVideos());
-  qfprintf (fd,"adm=Avidemux();\n");
+ 
 
   char *nm;
   
@@ -94,31 +94,31 @@
         nm=ADM_cleanupPath(_segments.getRefVideo(i)->_aviheader->getMyName() );
         if(!i)
         {
-                qfprintf (fd, "adm.loadVideo(\"%s\");\n", nm);
+                qfprintf (fd, "adm.loadVideo(\"%s\")\n", nm);
         }
         else
         {
-                qfprintf (fd, "adm.appendVideo(\"%s\");\n", nm);
+                qfprintf (fd, "adm.appendVideo(\"%s\")\n", nm);
         }
         ADM_dealloc(nm);
     }
 
   qfprintf (fd,"#%02ld segments\n", _segments.getNbSegments());
-  qfprintf (fd,"adm.clearSegments();\n");
+  qfprintf (fd,"adm.clearSegments()\n");
   
  
 
     for (uint32_t i = 0; i < _segments.getNbSegments(); i++)
     {
         _SEGMENT *seg=_segments.getSegment(i);
-        qfprintf (fd, "adm.addSegment(%"LU",%"LLU",%"LLU");\n",seg->_reference,seg->_refStartTimeUs,seg->_durationUs);
+        qfprintf (fd, "adm.addSegment(%"LU",%"LLU",%"LLU")\n",seg->_reference,seg->_refStartTimeUs,seg->_durationUs);
     }
 
 // Markers
 //
 
-        qfprintf(fd,"adm.markerA=%"LLU";\n",getMarkerAPts());
-        qfprintf(fd,"adm.markerB=%"LLU";\n",getMarkerBPts());
+        qfprintf(fd,"adm.markerA=%"LLU"\n",getMarkerAPts());
+        qfprintf(fd,"adm.markerB=%"LLU"\n",getMarkerBPts());
 
 // postproc
 //___________________________
@@ -126,7 +126,7 @@
 uint32_t pptype, ppstrength,ppswap;
         video_body->getPostProc( &pptype, &ppstrength, &ppswap);
         qfprintf(fd,"\n#** Postproc **\n");
-        qfprintf(fd,"adm.setPostProc(%d,%d,%d);\n",pptype,ppstrength,ppswap);
+        qfprintf(fd,"adm.setPostProc(%d,%d,%d)\n",pptype,ppstrength,ppswap);
 
 // Video codec
 //___________________________
@@ -137,7 +137,7 @@
         qfprintf(fd, "adm.videoCodec(\"%s\"", videoEncoder6_GetCurrentEncoderName());
         videoEncoder6_GetConfiguration(&couples);
         dumpConf(fd,couples);
-        qfprintf(fd,");\n");
+        qfprintf(fd,")\n");
 
 // Video filters....
 //______________________________________________
@@ -152,7 +152,7 @@
         CONFcouple *c=NULL;
         ADM_vf_getConfigurationFromIndex(i,&c);
         dumpConf(fd,c);
-        qfprintf(fd, ");\n");
+        qfprintf(fd, ")\n");
     }
 
 
@@ -165,7 +165,7 @@
    uint32_t delay,bitrate;
    
    qfprintf(fd,"\n#** Audio **\n");
-   qfprintf(fd,"adm.audioReset();\n");
+   qfprintf(fd,"adm.audioReset()\n");
 #if 0
    // External audio ?
         char *audioName;
@@ -177,7 +177,7 @@
         if(source!=AudioAvi)
         {
                 char *nm=ADM_cleanupPath(audioName);
-                qfprintf(fd,"app.audio.load(\"%s\",\"%s\");\n", audioSourceFromEnum(source),nm); 
+                qfprintf(fd,"app.audio.load(\"%s\",\"%s\")\n", audioSourceFromEnum(source),nm); 
                 ADM_dealloc(nm);
         }
         else 
@@ -185,7 +185,7 @@
           int source;
                source=video_body->getCurrentAudioStreamNumber(0);
                if(source)
-                        qfprintf(fd,"app.audio.setTrack(%d);\n", source); 
+                        qfprintf(fd,"app.audio.setTrack(%d)\n", source); 
                         
         }
 #endif
@@ -193,11 +193,11 @@
    getAudioExtraConf(&bitrate,&couples);
     qfprintf(fd,"adm.audioCodec(\"%s\",%d",audioCodecGetName(),bitrate); 
     dumpConf(fd,couples);
-    qfprintf(fd,");\n");
+    qfprintf(fd,")\n");
 
 
     uint32_t x=audioFilterGetResample();
-    if(x) qfprintf(fd,"adm.audioResample=%u;\n",audioFilterGetResample());
+    if(x) qfprintf(fd,"adm.audioResample=%u\n",audioFilterGetResample());
 
     
 //   qfprintf(fd,"app.audio.normalizeMode=%d;\n",audioGetNormalizeMode());
@@ -205,7 +205,7 @@
 //   qfprintf(fd,"app.audio.delay=%d;\n",audioGetDelay());
 // if (audioGetDrc()) qfprintf(fd,"app.audio.drc=true;\n");
    if(CHANNEL_INVALID!=audioFilterGetMixer())
-        qfprintf(fd,"adm.audioMixer(\"%s\");\n",AudioMixerIdToString(audioFilterGetMixer()));
+        qfprintf(fd,"adm.audioMixer(\"%s\")\n",AudioMixerIdToString(audioFilterGetMixer()));
 
    
 
@@ -213,8 +213,8 @@
         switch(audioFilterGetFrameRate())
         {
                 case FILMCONV_NONE:      ;break;
-                case FILMCONV_PAL2FILM:  qfprintf(fd,"adm.audioPal2film=1;\n");break;
-                case FILMCONV_FILM2PAL:  qfprintf(fd,"adm.audioFilm2pal=1;\n");break;
+                case FILMCONV_PAL2FILM:  qfprintf(fd,"adm.audioPal2film=1\n");break;
+                case FILMCONV_FILM2PAL:  qfprintf(fd,"adm.audioFilm2pal=1\n");break;
                 default:ADM_assert(0);
         }
    
@@ -230,10 +230,8 @@
         
         qfprintf(fd,"adm.setContainer(\"%s\"",containerName); 
         dumpConf(fd,containerConf);
-        qfprintf(fd,");\n");
+        qfprintf(fd,")\n");
   // -------- /Muxer -----------------------
-        qfprintf(fd,"setSuccess(%d);\n",1);
-        qfprintf(fd,"#adm.Exit();\n");
         qfprintf(fd,"\n#End of script\n");
         // All done
         qfclose (fd);

Modified: branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/py/ADM_pyAdm.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/py/ADM_pyAdm.cpp	2010-05-28 17:12:04 UTC (rev 6263)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/py/ADM_pyAdm.cpp	2010-05-28 17:12:08 UTC (rev 6264)
@@ -43,7 +43,7 @@
 {
     py->init();
     //py->registerFuncs("adm",adm_functions);
-    py->registerClass("Avidemux",initClasspyAdm);
+    py->registerClass("adm",initClasspyAdm);
     py->registerClass("Editor",initClasspyEditor);
     tinyPy::registerLogger(pyLogger);
     return true;

Modified: branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/py/adm.admPyClass
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/py/adm.admPyClass	2010-05-28 17:12:04 UTC (rev 6263)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/py/adm.admPyClass	2010-05-28 17:12:08 UTC (rev 6264)
@@ -1,8 +1,8 @@
 #              cname:pyname
 /* CLASS */ pyAdm : void
-/* FUNC */ int jsLoadVideo:loadVideo          (char * ) 
+/* FUNC */ int jsLoadVideo:loadVideo          (const char * ) 
 /* FUNC */ int jsClearSegments:clearSegments  (void) 
-/* FUNC */ int jsAppendVideo:appendVideo      (char * ) 
+/* FUNC */ int jsAppendVideo:appendVideo      (const char * ) 
 /* FUNC */ int jsAddSegment:addSegment        (int ,float , float ) 
 /* FUNC */ int jsSetPostProc:setPostProc      (int ,int , int ) 
 /* FUNC */ int jsGetWidth:getWidth            (void) 
@@ -10,6 +10,6 @@
 /* FUNC */ int jsGetFps1000:getFps1000        (void) 
 /* FUNC */ str jsGetVideoCodec:getVideoCodec(void) 
 /* FUNC */ int jsAudioReset:audioReset        (void) 
-/* FUNC */ int jsAudioMixer:audioMixer        (char * ) 
+/* FUNC */ int jsAudioMixer:audioMixer        (const char * ) 
 /* FUNC */ int jsClearVideoFilters:clearVideoFilters   (void) 
 

Modified: branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/py/adm_gen.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/py/adm_gen.cpp	2010-05-28 17:12:04 UTC (rev 6263)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/py/adm_gen.cpp	2010-05-28 17:12:08 UTC (rev 6264)
@@ -1,8 +1,9 @@
 // Generated by admPyClass.pl do not edit !
-//int  jsLoadVideo <char * >
+//int  jsLoadVideo <const char * >
 tp_obj zzpy_loadVideo(TP)
 {
-char * p0=(char *)TP_STR().string.val;
+tinyParams pm(tp);
+const char * p0=pm.asString();
 int r=jsLoadVideo(p0); 
 return tp_number(r);
 }
@@ -12,28 +13,31 @@
 int r=jsClearSegments(); 
 return tp_number(r);
 }
-//int  jsAppendVideo <char * >
+//int  jsAppendVideo <const char * >
 tp_obj zzpy_appendVideo(TP)
 {
-char * p0=(char *)TP_STR().string.val;
+tinyParams pm(tp);
+const char * p0=pm.asString();
 int r=jsAppendVideo(p0); 
 return tp_number(r);
 }
 //int  jsAddSegment <int  float   float >
 tp_obj zzpy_addSegment(TP)
 {
-int p0=TP_NUM();
-float p1=TP_NUM();
-float p2=TP_NUM();
+tinyParams pm(tp);
+int p0=pm.asDouble();
+float p1=pm.asDouble();
+float p2=pm.asDouble();
 int r=jsAddSegment(p0,p1,p2); 
 return tp_number(r);
 }
 //int  jsSetPostProc <int  int   int >
 tp_obj zzpy_setPostProc(TP)
 {
-int p0=TP_NUM();
-int p1=TP_NUM();
-int p2=TP_NUM();
+tinyParams pm(tp);
+int p0=pm.asDouble();
+int p1=pm.asDouble();
+int p2=pm.asDouble();
 int r=jsSetPostProc(p0,p1,p2); 
 return tp_number(r);
 }
@@ -67,10 +71,11 @@
 int r=jsAudioReset(); 
 return tp_number(r);
 }
-//int  jsAudioMixer <char * >
+//int  jsAudioMixer <const char * >
 tp_obj zzpy_audioMixer(TP)
 {
-char * p0=(char *)TP_STR().string.val;
+tinyParams pm(tp);
+const char * p0=pm.asString();
 int r=jsAudioMixer(p0); 
 return tp_number(r);
 }

Modified: branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/py/adm_gen.h
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/py/adm_gen.h	2010-05-28 17:12:04 UTC (rev 6263)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/py/adm_gen.h	2010-05-28 17:12:08 UTC (rev 6264)
@@ -1,6 +1,6 @@
-int  loadVideo (char * );
+int  loadVideo (const char * );
 int  clearSegments (void);
-int  appendVideo (char * );
+int  appendVideo (const char * );
 int  addSegment (int ,float , float );
 int  setPostProc (int ,int , int );
 int  getWidth (void);
@@ -8,5 +8,5 @@
 int  getFps1000 (void);
 str  getVideoCodec (void);
 int  audioReset (void);
-int  audioMixer (char * );
+int  audioMixer (const char * );
 int  clearVideoFilters (void);

Modified: branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src/ADM_scriptIf.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src/ADM_scriptIf.cpp	2010-05-28 17:12:04 UTC (rev 6263)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src/ADM_scriptIf.cpp	2010-05-28 17:12:08 UTC (rev 6264)
@@ -46,7 +46,7 @@
             scriptLogger(scriptLoggerCookie,SCRIPT_LOG_NORMAL,print_buffer);
         else
         {
-                ADM_warning("[JS]%s\n",print_buffer);
+                printf("%s",print_buffer);
         }
 
         return true;

Modified: branches/avidemux_2.6_branch_mean/avidemux/common/ADM_toolkit/automation.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/ADM_toolkit/automation.cpp	2010-05-28 17:12:04 UTC (rev 6263)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/ADM_toolkit/automation.cpp	2010-05-28 17:12:08 UTC (rev 6264)
@@ -141,6 +141,7 @@
         {"nogui",               0,"Run in silent mode",		(one_arg_type)GUI_Quiet}   ,
 //        {"listfilters",		0,"list all filters by name",		(one_arg_type)filterListAll}   ,
         {"run",			1,"load and run a script",		(one_arg_type)A_parseECMAScript},
+        {"runpy",			1,"load and run a pyScript",		(one_arg_type)A_parseTinyPyScript},
         {"audio-normalize",	1,"activate normalization",		call_normalize},
         {"audio-resample",	1,"resample to x hz",			call_resample},
 //        {"filters",		1,"load a filter preset",		(one_arg_type)filterLoadXml}   ,

Modified: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreTinyPy/include/ADM_tinypy.h
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreTinyPy/include/ADM_tinypy.h	2010-05-28 17:12:04 UTC (rev 6263)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreTinyPy/include/ADM_tinypy.h	2010-05-28 17:12:08 UTC (rev 6264)
@@ -47,4 +47,22 @@
 static  bool    unregisterLogger(void);
         bool    dumpBuiltin(void);
 };
+
+/**
+    \class tinyParams
+*/
+class tinyParams
+{
+protected:
+        tp_vm *tp;
+public:
+        tinyParams(tp_vm *i) {tp=i;}
+        int    asInt(void);
+        float  asFloat(void);
+        double asDouble(void);
+const   char  *asString(void);
+        int    nbParam(void);
+        void   raise(const char *fmt,...);
+        const char *typeAsString(int type);
+};
 #endif

Modified: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreTinyPy/src/ADM_tinypy.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreTinyPy/src/ADM_tinypy.cpp	2010-05-28 17:12:04 UTC (rev 6263)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreTinyPy/src/ADM_tinypy.cpp	2010-05-28 17:12:08 UTC (rev 6264)
@@ -196,4 +196,76 @@
     }
     return tp_None;
 }
+//*********************************************
+#define preamble(xtype) tp_obj obj=TP_OBJ();\
+                       if(obj.type!=xtype) \
+                        { \
+                            raise("Expected %s, got %s\n",typeAsString(xtype),typeAsString(obj.type)); \
+                        }
+/**
+   \fn  asInt
+*/
+ int    tinyParams::asInt(void)
+{
+    preamble(TP_NUMBER);
+    return (int)obj.number.val;
+}
+/**
+   \fn  asInt
+*/
+float    tinyParams::asFloat(void)
+{
+    preamble(TP_NUMBER);
+    return (float)obj.number.val;
+}
+/**
+   \fn  asInt
+*/
+
+double tinyParams::asDouble(void)
+{
+    preamble(TP_NUMBER);
+    return (double)obj.number.val;
+}
+/**
+   \fn  asInt
+*/
+
+const char *tinyParams::asString(void)
+{
+    preamble(TP_STRING);
+    return obj.string.val;
+}
+/**
+   \fn  asInt
+*/
+
+const char *tinyParams::typeAsString(int type)
+{
+    switch(type)
+    {
+        case TP_NUMBER: return "Number";break;
+        case TP_STRING: return "String";break;
+        case TP_LIST:   return "List";break;
+        case TP_DICT:   return "Dict";break;
+        case TP_FNC:    return "Function";break;
+        case TP_DATA:   return "Data";break;
+    }
+    return "???";
+}
+/**
+
+*/
+void tinyParams::raise(const char *fmt,...)
+{
+char print_buffer[1024];
+    va_list         list;
+    va_start(list,  fmt);
+    vsnprintf(print_buffer,1023,fmt,list);
+    va_end(list);
+    print_buffer[1023]=0; // ensure the string is terminated
+    ADM_error("%s",print_buffer);
+    _tp_raise(tp,tp_None);
+}
+
 // EOF
\ No newline at end of file



From mean at mail.berlios.de  Fri May 28 19:12:12 2010
From: mean at mail.berlios.de (mean at BerliOS)
Date: Fri, 28 May 2010 19:12:12 +0200
Subject: [Avidemux-svn-commit] r6265 -
	branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavutil
Message-ID: <201005281712.o4SHCCSp006963@sheep.berlios.de>

Author: mean
Date: 2010-05-28 19:12:11 +0200 (Fri, 28 May 2010)
New Revision: 6265

Modified:
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavutil/lfg.h
Log:
[ffmpeg] Revert lfg patch

Modified: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavutil/lfg.h
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavutil/lfg.h	2010-05-28 17:12:08 UTC (rev 6264)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavutil/lfg.h	2010-05-28 17:12:11 UTC (rev 6265)
@@ -21,7 +21,6 @@
 
 #ifndef AVUTIL_LFG_H
 #define AVUTIL_LFG_H
-#define index xindex // MEANX
 typedef struct {
     unsigned int state[64];
     int index;



From mean at mail.berlios.de  Fri May 28 19:12:15 2010
From: mean at mail.berlios.de (mean at BerliOS)
Date: Fri, 28 May 2010 19:12:15 +0200
Subject: [Avidemux-svn-commit] r6266 - in
	branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg:
	ffmpeg_config libavutil patches
Message-ID: <201005281712.o4SHCFEF007282@sheep.berlios.de>

Author: mean
Date: 2010-05-28 19:12:14 +0200 (Fri, 28 May 2010)
New Revision: 6266

Modified:
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/ffmpeg_config/config.h
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/ffmpeg_config/ffconf.c
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavutil/lfg.c
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavutil/lfg.h
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavutil_lfg.h
Log:
[ffmpeg] Lfg fix for win32

Modified: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/ffmpeg_config/config.h
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/ffmpeg_config/config.h	2010-05-28 17:12:11 UTC (rev 6265)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/ffmpeg_config/config.h	2010-05-28 17:12:14 UTC (rev 6266)
@@ -555,7 +555,7 @@
 #define HAVE_YASM      1
 #else // USE_YASM
 #define ENABLE_YASM      0
-#undef HAVE_YASM      
+#undef HAVE_YASM         0
 #endif // USE_YASM
 #define CONFIG_H264DSP  1
 #define ENABLE_ARM      0

Modified: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/ffmpeg_config/ffconf.c
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/ffmpeg_config/ffconf.c	2010-05-28 17:12:11 UTC (rev 6265)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/ffmpeg_config/ffconf.c	2010-05-28 17:12:14 UTC (rev 6266)
@@ -632,7 +632,7 @@
         printf("#define HAVE_YASM      1\n");
         printf("#else // USE_YASM\n");
         printf("#define ENABLE_YASM      0\n");
-        printf("#undef HAVE_YASM      \n");
+        printf("#undef HAVE_YASM         0\n");
         printf("#endif // USE_YASM\n");
 
 	printf("#define CONFIG_H264DSP  1\n");

Modified: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavutil/lfg.c
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavutil/lfg.c	2010-05-28 17:12:11 UTC (rev 6265)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavutil/lfg.c	2010-05-28 17:12:14 UTC (rev 6266)
@@ -37,7 +37,7 @@
         c->state[i+2]= AV_RL32(tmp+8);
         c->state[i+3]= AV_RL32(tmp+12);
     }
-    c->index=0;
+    c->xindex=0;
 }
 
 void av_bmg_get(AVLFG *lfg, double out[2])

Modified: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavutil/lfg.h
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavutil/lfg.h	2010-05-28 17:12:11 UTC (rev 6265)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavutil/lfg.h	2010-05-28 17:12:14 UTC (rev 6266)
@@ -23,7 +23,7 @@
 #define AVUTIL_LFG_H
 typedef struct {
     unsigned int state[64];
-    int index;
+    int xindex;
 } AVLFG;
 
 void av_lfg_init(AVLFG *c, unsigned int seed);
@@ -35,8 +35,8 @@
  * it may be good enough and faster for your specific use case.
  */
 static inline unsigned int av_lfg_get(AVLFG *c){
-    c->state[c->index & 63] = c->state[(c->index-24) & 63] + c->state[(c->index-55) & 63];
-    return c->state[c->index++ & 63];
+    c->state[c->xindex & 63] = c->state[(c->xindex-24) & 63] + c->state[(c->xindex-55) & 63];
+    return c->state[c->xindex++ & 63];
 }
 
 /**
@@ -45,9 +45,9 @@
  * Please also consider av_lfg_get() above, it is faster.
  */
 static inline unsigned int av_mlfg_get(AVLFG *c){
-    unsigned int a= c->state[(c->index-55) & 63];
-    unsigned int b= c->state[(c->index-24) & 63];
-    return c->state[c->index++ & 63] = 2*a*b+a+b;
+    unsigned int a= c->state[(c->xindex-55) & 63];
+    unsigned int b= c->state[(c->xindex-24) & 63];
+    return c->state[c->xindex++ & 63] = 2*a*b+a+b;
 }
 
 /**

Modified: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavutil_lfg.h
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavutil_lfg.h	2010-05-28 17:12:11 UTC (rev 6265)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavutil_lfg.h	2010-05-28 17:12:14 UTC (rev 6266)
@@ -1,13 +1,50 @@
+diff --git a/avidemux_core/ADM_ffmpeg/libavutil/lfg.c b/avidemux_core/ADM_ffmpeg/libavutil/lfg.c
+index 1dad4e4..9b1db67 100644
+--- a/avidemux_core/ADM_ffmpeg/libavutil/lfg.c
++++ b/avidemux_core/ADM_ffmpeg/libavutil/lfg.c
+@@ -37,7 +37,7 @@ void av_cold av_lfg_init(AVLFG *c, unsigned int seed){
+         c->state[i+2]= AV_RL32(tmp+8);
+         c->state[i+3]= AV_RL32(tmp+12);
+     }
+-    c->index=0;
++    c->xindex=0;
+ }
+ 
+ void av_bmg_get(AVLFG *lfg, double out[2])
 diff --git a/avidemux_core/ADM_ffmpeg/libavutil/lfg.h b/avidemux_core/ADM_ffmpeg/libavutil/lfg.h
-index ac89d12..56e86a1 100644
+index c952fc8..9648fce 100644
 --- a/avidemux_core/ADM_ffmpeg/libavutil/lfg.h
 +++ b/avidemux_core/ADM_ffmpeg/libavutil/lfg.h
-@@ -21,7 +21,7 @@
- 
- #ifndef AVUTIL_LFG_H
+@@ -23,7 +23,7 @@
  #define AVUTIL_LFG_H
--
-+#define index xindex // MEANX
  typedef struct {
      unsigned int state[64];
-     int index;
+-    int index;
++    int xindex;
+ } AVLFG;
+ 
+ void av_lfg_init(AVLFG *c, unsigned int seed);
+@@ -35,8 +35,8 @@ void av_lfg_init(AVLFG *c, unsigned int seed);
+  * it may be good enough and faster for your specific use case.
+  */
+ static inline unsigned int av_lfg_get(AVLFG *c){
+-    c->state[c->index & 63] = c->state[(c->index-24) & 63] + c->state[(c->index-55) & 63];
+-    return c->state[c->index++ & 63];
++    c->state[c->xindex & 63] = c->state[(c->xindex-24) & 63] + c->state[(c->xindex-55) & 63];
++    return c->state[c->xindex++ & 63];
+ }
+ 
+ /**
+@@ -45,9 +45,9 @@ static inline unsigned int av_lfg_get(AVLFG *c){
+  * Please also consider av_lfg_get() above, it is faster.
+  */
+ static inline unsigned int av_mlfg_get(AVLFG *c){
+-    unsigned int a= c->state[(c->index-55) & 63];
+-    unsigned int b= c->state[(c->index-24) & 63];
+-    return c->state[c->index++ & 63] = 2*a*b+a+b;
++    unsigned int a= c->state[(c->xindex-55) & 63];
++    unsigned int b= c->state[(c->xindex-24) & 63];
++    return c->state[c->xindex++ & 63] = 2*a*b+a+b;
+ }
+ 
+ /**



From mean at mail.berlios.de  Fri May 28 19:32:58 2010
From: mean at mail.berlios.de (mean at BerliOS)
Date: Fri, 28 May 2010 19:32:58 +0200
Subject: [Avidemux-svn-commit] r6267 -
	branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/ffmpeg_config
Message-ID: <201005281732.o4SHWwta005564@sheep.berlios.de>

Author: mean
Date: 2010-05-28 19:32:56 +0200 (Fri, 28 May 2010)
New Revision: 6267

Modified:
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/ffmpeg_config/config.h
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/ffmpeg_config/ffconf.c
Log:
[lfg] part 2

Modified: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/ffmpeg_config/config.h
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/ffmpeg_config/config.h	2010-05-28 17:12:14 UTC (rev 6266)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/ffmpeg_config/config.h	2010-05-28 17:32:56 UTC (rev 6267)
@@ -552,10 +552,10 @@
 #endif
 #ifdef USE_YASM
 #define ENABLE_YASM      1
-#define HAVE_YASM      1
+#define HAVE_YASM        1
 #else // USE_YASM
 #define ENABLE_YASM      0
-#undef HAVE_YASM         0
+#define HAVE_YASM        0
 #endif // USE_YASM
 #define CONFIG_H264DSP  1
 #define ENABLE_ARM      0

Modified: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/ffmpeg_config/ffconf.c
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/ffmpeg_config/ffconf.c	2010-05-28 17:12:14 UTC (rev 6266)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/ffmpeg_config/ffconf.c	2010-05-28 17:32:56 UTC (rev 6267)
@@ -629,10 +629,10 @@
 
         printf("#ifdef USE_YASM\n");
         printf("#define ENABLE_YASM      1\n");
-        printf("#define HAVE_YASM      1\n");
+        printf("#define HAVE_YASM        1\n");
         printf("#else // USE_YASM\n");
         printf("#define ENABLE_YASM      0\n");
-        printf("#undef HAVE_YASM         0\n");
+        printf("#define HAVE_YASM        0\n");
         printf("#endif // USE_YASM\n");
 
 	printf("#define CONFIG_H264DSP  1\n");



From mean at mail.berlios.de  Sat May 29 17:42:37 2010
From: mean at mail.berlios.de (mean at BerliOS)
Date: Sat, 29 May 2010 17:42:37 +0200
Subject: [Avidemux-svn-commit] r6268 - in branches/avidemux_2.6_branch_mean:
	avidemux/common/ADM_script2/include
	avidemux/common/ADM_script2/js avidemux/common/ADM_script2/py
	avidemux/common/ADM_script2/src avidemux_core/ADM_coreTinyPy/include
	avidemux_core/ADM_coreTinyPy/src avidemux_core/ADM_coreUtils/include
	avidemux_core/ADM_coreUtils/src cmake
Message-ID: <201005291542.o4TFgbZn019498@sheep.berlios.de>

Author: mean
Date: 2010-05-29 17:42:36 +0200 (Sat, 29 May 2010)
New Revision: 6268

Added:
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/include/ADM_scriptAudio.h
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/include/ADM_scriptUtils.h
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src/ADM_scriptUtils.cpp
   branches/avidemux_2.6_branch_mean/cmake/admPyClass.pl
Modified:
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/include/ADM_scriptVideo.h
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/js/ADM_jsAudio.cpp
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/js/ADM_jsUtils.cpp
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/js/ADM_jsVideo.cpp
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/py/ADM_pyAdm.cpp
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/py/adm.admPyClass
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/py/adm_gen.cpp
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/py/adm_gen.h
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src/ADM_scriptAudio.cpp
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src/ADM_scriptVideo.cpp
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src/CMakeLists.txt
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreTinyPy/include/ADM_tinypy.h
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreTinyPy/src/ADM_tinypy.cpp
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreUtils/include/ADM_confCouple.h
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreUtils/src/ADM_confCouple.cpp
Log:
[py] Add video and audio codec, merge it with js

Copied: branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/include/ADM_scriptAudio.h (from rev 6267, branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/include/ADM_scriptVideo.h)
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/include/ADM_scriptVideo.h	2010-05-28 17:32:56 UTC (rev 6267)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/include/ADM_scriptAudio.h	2010-05-29 15:42:36 UTC (rev 6268)
@@ -0,0 +1,27 @@
+
+/**
+    \file  ADM_scriptAudio
+    \brief Audio codec etc..
+*/
+
+/***************************************************************************
+ *                                                                         *
+ *   This program is free software; you can redistribute it and/or modify  *
+ *   it under the terms of the GNU General Public License as published by  *
+ *   the Free Software Foundation; either version 2 of the License, or     *
+ *   (at your option) any later version.                                   *
+ *                                                                         *
+ ***************************************************************************/
+#ifndef ADM_SCRIPT_AUDIO_H
+#define ADM_SCRIPT_AUDIO_H
+
+#include "ADM_confCouple.h"
+#ifdef __cplusplus
+extern "C" {
+#endif
+int     scriptSetAudioCodec(const char *codec,int bitrate,CONFcouple *c);
+#ifdef __cplusplus
+};
+#endif
+
+#endif

Added: branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/include/ADM_scriptUtils.h
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/include/ADM_scriptUtils.h	2010-05-28 17:32:56 UTC (rev 6267)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/include/ADM_scriptUtils.h	2010-05-29 15:42:36 UTC (rev 6268)
@@ -0,0 +1,4 @@
+/**
+
+*/
+

Modified: branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/include/ADM_scriptVideo.h
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/include/ADM_scriptVideo.h	2010-05-28 17:32:56 UTC (rev 6267)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/include/ADM_scriptVideo.h	2010-05-29 15:42:36 UTC (rev 6268)
@@ -13,14 +13,15 @@
  ***************************************************************************/
 #ifndef ADM_JS_VIDEO_H
 #define ADM_JS_VIDEO_H
-
+#include "ADM_confCouple.h"
 #ifdef __cplusplus
 extern "C" {
 #endif
 
-int jsVideoCodec(const char *codec,const char **p);
-int jsSetPostProc (int a,int b, int c);
 
+int     jsSetPostProc (int a,int b, int c);
+int     scriptSetVideoCodec(const char *codec,CONFcouple *c);
+
 #ifdef __cplusplus
 };
 #endif

Modified: branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/js/ADM_jsAudio.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/js/ADM_jsAudio.cpp	2010-05-28 17:32:56 UTC (rev 6267)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/js/ADM_jsAudio.cpp	2010-05-29 15:42:36 UTC (rev 6268)
@@ -24,10 +24,10 @@
 #include "GUI_ui.h"
 #include "ADM_audioFilterInterface.h"
 #include "audioEncoderApi.h"
-extern ADM_Composer *video_body;
+#include "ADM_scriptAudio.h"
 
 /**
-    \fn 
+    \fn jsAudioCodec
 */  
 extern "C" int   jsAudioCodec(const char *a,const char **b) {return 0;}
 JSBool jsAdmaudioCodec(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval)
@@ -40,32 +40,17 @@
         for(int i=2;i<argc;i++)  if(JSVAL_IS_STRING(argv[i]) == false) return JS_FALSE;
 
         // Get Codec...
-        char *name = JS_GetStringBytes(JSVAL_TO_STRING(argv[0]));
-        ADM_LowerCase(name);
-        
-        // First search the codec by its name
-        if(!audioCodecSetByName(name))
-        {
-                *rval = BOOLEAN_TO_JSVAL(false);
-                jsLogError("Cannot set audio codec %s\n",name);
-        }
-        else
-        {
-            // begin set bitrate
-            uint32_t bitrate=JSVAL_TO_INT(argv[1]);
-            // Construct couples
-            CONFcouple *c=NULL;
-            if(argc>2)
+        char *name = JS_GetStringBytes(JSVAL_TO_STRING(argv[0]));     
+        // begin set bitrate
+        uint32_t bitrate=JSVAL_TO_INT(argv[1]);
+        // Construct couples
+        CONFcouple *c=NULL;
+        if(argc>2)
             {
                 int nb=argc-2;
                 jsArgToConfCouple( nb,&c,  argv+2);
             }
-            *rval = BOOLEAN_TO_JSVAL(setAudioExtraConf(bitrate,c));
-            if(c) delete c;
-        }
-
-        // end set bitrate
-        
+        *rval = BOOLEAN_TO_JSVAL(scriptSetAudioCodec(name,bitrate,c));        
         return JS_TRUE;
 }
 //EOF

Modified: branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/js/ADM_jsUtils.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/js/ADM_jsUtils.cpp	2010-05-28 17:32:56 UTC (rev 6267)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/js/ADM_jsUtils.cpp	2010-05-29 15:42:36 UTC (rev 6268)
@@ -93,42 +93,6 @@
     return true;
 }
 /**
-    \fn stringsToConfCouple
-    \brief Convert js args to confcouple
-
-*/
-bool stringsToConfCouple(int nb,CONFcouple **conf,  const char **argv)
-{
-  *conf=NULL;
-  if(!nb) return true;
-  CONFcouple *c=new CONFcouple(nb);
-  *conf=c;
-    for(int i=0;i<nb;i++)
-    {
-        
-        char *dupe=   ADM_strdup(argv[i]);
-        char *name,*value;
-        // dupe is in the form name=value
-        name=dupe;
-        value=name;
-        char *tail=dupe+strlen(dupe);
-        while(value<tail)
-        {
-            if(*value=='=') 
-                {
-                    *value=0;
-                    value++;
-                    break;
-                }
-            value++;
-        }
-        c->setInternalName(name,value);
-        //printf("%s -> [%s,%s]\n",param,name,value);
-        ADM_dezalloc(dupe);
-    }
-    return true;
-}
-/**
     \fn jsArgToConfCouple
     \brief Convert js args to confcouple
 

Modified: branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/js/ADM_jsVideo.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/js/ADM_jsVideo.cpp	2010-05-28 17:32:56 UTC (rev 6267)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/js/ADM_jsVideo.cpp	2010-05-29 15:42:36 UTC (rev 6268)
@@ -45,18 +45,9 @@
                 return JS_FALSE;
         }
         char *codec=JS_GetStringBytes(JSVAL_TO_STRING(argv[0]));
-        // Set codec.
-        
-        if(A_setVideoCodec(codec)==false)
-        {
-            jsLog("Could not select codec %s\n",codec);
-            return JS_FALSE;
-        }
         CONFcouple *c;
         jsArgToConfCouple(argc-1,&c,argv+1);
-        *rval = BOOLEAN_TO_JSVAL( videoEncoder6_SetConfiguration(c));
-        jsLog("Selected codec %s\n",codec);
-        if(c) delete c;
+        *rval = BOOLEAN_TO_JSVAL( scriptSetVideoCodec(codec,c));
         return JS_TRUE;
 }// end Codec
 

Modified: branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/py/ADM_pyAdm.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/py/ADM_pyAdm.cpp	2010-05-28 17:32:56 UTC (rev 6267)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/py/ADM_pyAdm.cpp	2010-05-29 15:42:36 UTC (rev 6268)
@@ -22,6 +22,7 @@
 #include "A_functions.h"
 #include "ADM_scriptCommon.h"
 #include "ADM_scriptVideo.h"
+#include "ADM_scriptAudio.h"
 #include "ADM_scriptEditor.h"
 
 #include "adm_gen.cpp"

Modified: branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/py/adm.admPyClass
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/py/adm.admPyClass	2010-05-28 17:32:56 UTC (rev 6267)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/py/adm.admPyClass	2010-05-29 15:42:36 UTC (rev 6268)
@@ -12,4 +12,8 @@
 /* FUNC */ int jsAudioReset:audioReset        (void) 
 /* FUNC */ int jsAudioMixer:audioMixer        (const char * ) 
 /* FUNC */ int jsClearVideoFilters:clearVideoFilters   (void) 
-
+#
+#
+#              cname:pyname
+/* FUNC */ int scriptSetVideoCodec:videoCodec(const char *,couples) 
+/* FUNC */ int scriptSetAudioCodec:audioCodec(const char *,int,couples) 

Modified: branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/py/adm_gen.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/py/adm_gen.cpp	2010-05-28 17:32:56 UTC (rev 6267)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/py/adm_gen.cpp	2010-05-29 15:42:36 UTC (rev 6268)
@@ -85,6 +85,27 @@
 int r=jsClearVideoFilters(); 
 return tp_number(r);
 }
+//int  scriptSetVideoCodec <const char * couples>
+tp_obj zzpy_videoCodec(TP)
+{
+tinyParams pm(tp);
+const char * p0=pm.asString();
+CONFcouple *p1=NULL;
+pm.makeCouples(&p1);
+int r=scriptSetVideoCodec(p0,p1); 
+return tp_number(r);
+}
+//int  scriptSetAudioCodec <const char * int couples>
+tp_obj zzpy_audioCodec(TP)
+{
+tinyParams pm(tp);
+const char * p0=pm.asString();
+int p1=pm.asDouble();
+CONFcouple *p2=NULL;
+pm.makeCouples(&p2);
+int r=scriptSetAudioCodec(p0,p1,p2); 
+return tp_number(r);
+}
 static tp_obj myCtorpyAdm(tp_vm *vm)
 {
 }
@@ -104,5 +125,7 @@
  tp_set(vm,myClass,tp_string("audioReset"),tp_fnc(vm,zzpy_audioReset));
  tp_set(vm,myClass,tp_string("audioMixer"),tp_fnc(vm,zzpy_audioMixer));
  tp_set(vm,myClass,tp_string("clearVideoFilters"),tp_fnc(vm,zzpy_clearVideoFilters));
+ tp_set(vm,myClass,tp_string("videoCodec"),tp_fnc(vm,zzpy_videoCodec));
+ tp_set(vm,myClass,tp_string("audioCodec"),tp_fnc(vm,zzpy_audioCodec));
  return myClass;
 }

Modified: branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/py/adm_gen.h
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/py/adm_gen.h	2010-05-28 17:32:56 UTC (rev 6267)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/py/adm_gen.h	2010-05-29 15:42:36 UTC (rev 6268)
@@ -10,3 +10,5 @@
 int  audioReset (void);
 int  audioMixer (const char * );
 int  clearVideoFilters (void);
+int  videoCodec (const char *,couples);
+int  audioCodec (const char *,int,couples);

Modified: branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src/ADM_scriptAudio.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src/ADM_scriptAudio.cpp	2010-05-28 17:32:56 UTC (rev 6267)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src/ADM_scriptAudio.cpp	2010-05-29 15:42:36 UTC (rev 6268)
@@ -24,7 +24,7 @@
 #include "ADM_audioFilterInterface.h"
 #include "audioEncoderApi.h"
 #include "ADM_scriptCommon.h"
-extern ADM_Composer *video_body;
+#include "ADM_scriptAudio.h"
 /**
     \fn int jsAudioReset(void);
 */
@@ -55,4 +55,27 @@
 {
 
 }
+/**
+
+*/
+/**
+    \fn scriptSetAudioCodec
+*/
+int     scriptSetAudioCodec(const char *codec,int bitrate,CONFcouple *c)
+{ 
+        int r=true;        
+        // First search the codec by its name
+        if(!audioCodecSetByName(codec))
+        {
+                r=false;
+                jsLogError("Cannot set audio codec %s\n",codec);
+        }
+        else
+        {
+            r=setAudioExtraConf(bitrate,c);
+            
+        }
+        if(c) delete c;
+        return r;
+}
 //EOF
\ No newline at end of file

Added: branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src/ADM_scriptUtils.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src/ADM_scriptUtils.cpp	2010-05-28 17:32:56 UTC (rev 6267)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src/ADM_scriptUtils.cpp	2010-05-29 15:42:36 UTC (rev 6268)
@@ -0,0 +1,3 @@
+/**
+
+*/
\ No newline at end of file

Modified: branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src/ADM_scriptVideo.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src/ADM_scriptVideo.cpp	2010-05-28 17:32:56 UTC (rev 6267)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src/ADM_scriptVideo.cpp	2010-05-29 15:42:36 UTC (rev 6268)
@@ -27,6 +27,7 @@
 #include "ADM_videoFilters.h"
 #include "GUI_ui.h"
 #include "ADM_scriptCommon.h"
+#include "ADM_scriptIf.h"
 extern ADM_Composer *video_body;
 bool A_setVideoCodec(const char *nm);
 /**
@@ -44,8 +45,28 @@
     UI_setVideoCodec(idx);
     return true;
 }
-
 /**
+    \fn scriptSetVideoCodec
+*/
+int     scriptSetVideoCodec(const char *codec,CONFcouple *c)
+{       
+        bool r=true;
+        if(A_setVideoCodec(codec)==false)
+        {
+            jsLog("Could not select codec %s\n",codec);
+            r=false;
+        }else
+        {        
+            if(c)
+            {
+                r=videoEncoder6_SetConfiguration(c);
+            }
+        }
+        if(c)
+            delete c;
+        return r;
+}
+/**
     \fn jsSetPostProc
 */
 int jsSetPostProc (int a,int b, int c)

Modified: branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src/CMakeLists.txt
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src/CMakeLists.txt	2010-05-28 17:32:56 UTC (rev 6267)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src/CMakeLists.txt	2010-05-29 15:42:36 UTC (rev 6268)
@@ -4,6 +4,7 @@
         ADM_scriptAvidemux.cpp
         ADM_scriptAvidemuxInfo.cpp
         ADM_scriptAudio.cpp
+        ADM_scriptUtils.cpp
 )
 
 

Modified: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreTinyPy/include/ADM_tinypy.h
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreTinyPy/include/ADM_tinypy.h	2010-05-28 17:32:56 UTC (rev 6267)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreTinyPy/include/ADM_tinypy.h	2010-05-29 15:42:36 UTC (rev 6268)
@@ -16,6 +16,7 @@
 #ifndef ADM_TINYPY_H
 #define ADM_TINYPY_H
 #include "tinypy.h"
+#include "ADM_confCouple.h"
 /**
     \struct tyFunc
 */
@@ -33,7 +34,8 @@
 class tinyPy 
 {
 protected:
-        void *instance;
+        void    *instance;
+        
 public:
                 tinyPy(void);
         bool    init(void);
@@ -46,6 +48,8 @@
 static  bool    registerLogger(pyLoggerFunc func);
 static  bool    unregisterLogger(void);
         bool    dumpBuiltin(void);
+       
+        
 };
 
 /**
@@ -55,6 +59,7 @@
 {
 protected:
         tp_vm *tp;
+        int     nbParamsLeft(void) {return tp->params.list.val->len;}
 public:
         tinyParams(tp_vm *i) {tp=i;}
         int    asInt(void);
@@ -64,5 +69,6 @@
         int    nbParam(void);
         void   raise(const char *fmt,...);
         const char *typeAsString(int type);
+        bool   makeCouples(CONFcouple **c);
 };
 #endif

Modified: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreTinyPy/src/ADM_tinypy.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreTinyPy/src/ADM_tinypy.cpp	2010-05-28 17:32:56 UTC (rev 6267)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreTinyPy/src/ADM_tinypy.cpp	2010-05-29 15:42:36 UTC (rev 6268)
@@ -211,7 +211,7 @@
     return (int)obj.number.val;
 }
 /**
-   \fn  asInt
+   \fn  asFloat
 */
 float    tinyParams::asFloat(void)
 {
@@ -219,7 +219,7 @@
     return (float)obj.number.val;
 }
 /**
-   \fn  asInt
+   \fn  asDouble
 */
 
 double tinyParams::asDouble(void)
@@ -228,7 +228,7 @@
     return (double)obj.number.val;
 }
 /**
-   \fn  asInt
+   \fn  asString
 */
 
 const char *tinyParams::asString(void)
@@ -237,7 +237,8 @@
     return obj.string.val;
 }
 /**
-   \fn  asInt
+   \fn  typeAsString
+    \brief return the type given as a string
 */
 
 const char *tinyParams::typeAsString(int type)
@@ -254,7 +255,8 @@
     return "???";
 }
 /**
-
+    \fn raise
+    \brief raise an exception
 */
 void tinyParams::raise(const char *fmt,...)
 {
@@ -267,5 +269,20 @@
     ADM_error("%s",print_buffer);
     _tp_raise(tp,tp_None);
 }
-
+/**
+    \fn makeCouples
+    \brief convert couples into char *first and *couples c, c can be null
+*/
+bool    tinyParams::makeCouples(CONFcouple **c)
+{
+    int nb=nbParamsLeft();
+    if(!nb)
+    {
+        *c=NULL;
+        return true;
+    }
+    const char *s[nb];
+    for(int i=0;i<nb;i++) s[i]=asString();
+    return stringsToConfCouple(nb,c,s);
+}
 // EOF
\ No newline at end of file

Modified: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreUtils/include/ADM_confCouple.h
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreUtils/include/ADM_confCouple.h	2010-05-28 17:32:56 UTC (rev 6267)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreUtils/include/ADM_confCouple.h	2010-05-29 15:42:36 UTC (rev 6268)
@@ -54,4 +54,5 @@
 			void dump(void );
 
 };
+bool stringsToConfCouple(int nb,CONFcouple **conf,  const char **argv);
 #endif

Modified: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreUtils/src/ADM_confCouple.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreUtils/src/ADM_confCouple.cpp	2010-05-28 17:32:56 UTC (rev 6267)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreUtils/src/ADM_confCouple.cpp	2010-05-29 15:42:36 UTC (rev 6268)
@@ -195,4 +195,41 @@
     *nm=name[n];
     *val=value[n];
     return true;
-};
\ No newline at end of file
+};
+
+/**
+    \fn stringsToConfCouple
+    \brief Convert js args to confcouple
+
+*/
+bool stringsToConfCouple(int nb,CONFcouple **conf,  const char **argv)
+{
+  *conf=NULL;
+  if(!nb) return true;
+  CONFcouple *c=new CONFcouple(nb);
+  *conf=c;
+    for(int i=0;i<nb;i++)
+    {
+        
+        char *dupe=   ADM_strdup(argv[i]);
+        char *name,*value;
+        // dupe is in the form name=value
+        name=dupe;
+        value=name;
+        char *tail=dupe+strlen(dupe);
+        while(value<tail)
+        {
+            if(*value=='=') 
+                {
+                    *value=0;
+                    value++;
+                    break;
+                }
+            value++;
+        }
+        c->setInternalName(name,value);
+        //printf("%s -> [%s,%s]\n",param,name,value);
+        ADM_dezalloc(dupe);
+    }
+    return true;
+}

Added: branches/avidemux_2.6_branch_mean/cmake/admPyClass.pl
===================================================================
--- branches/avidemux_2.6_branch_mean/cmake/admPyClass.pl	2010-05-28 17:32:56 UTC (rev 6267)
+++ branches/avidemux_2.6_branch_mean/cmake/admPyClass.pl	2010-05-29 15:42:36 UTC (rev 6268)
@@ -0,0 +1,278 @@
+#
+# Generate glue to hook C functions to tinyPy static classes
+# returnvalue FUNC param
+#       param [int, float, void, str, couples]
+#                        str = const char *
+#                        couples =  confCouple *c
+#
+
+
+use strict;
+my $input;
+my $output;
+my $headerFile;
+my $line;
+my $glueprefix="zzpy_";
+my $functionPrefix="";
+my @allFuncs;
+my $className;
+my $cookieName;
+my $staticClass=0;
+my $nbCouples=0;
+#
+#
+#
+sub genReturn
+{
+        my $retType=shift;
+        if($retType=~m/int/)
+        {
+                return "return tp_number(r);";
+        }
+        if($retType=~m/float/)
+        {
+                return "return tp_number(r);";
+        }
+        if($retType=~m/void/)
+        {
+                return "";
+        }
+         if($retType=~m/str/)
+        {
+                return "return tp_string(r);";
+        }
+return "???? $retType";
+}
+#
+#
+#
+sub castFrom
+{
+        my $type=shift;
+        if($type=~m/^const char/)
+        {
+                return "pm.asString()";
+        }
+        if($type=~m/^int/)
+        {
+                return "pm.asDouble()";
+        }
+        if($type=~m/^float/)
+        {
+                return "pm.asFloat()";
+        }
+        print ">>>>>>>>>> <$type> unknown\n";
+        return "????";
+
+}
+#
+# Generate the locals / wrapping for the parameters
+#
+sub genParam
+{
+        my $num=shift;
+        my $type=shift;
+        my $r=1;
+        if($type=~m/couples/)
+        {
+                print OUTPUT "CONFcouple *p".$num."=NULL;\n";
+                print OUTPUT "pm.makeCouples(&p".$num.");\n";
+                $r=0;
+        }else
+        {
+                print OUTPUT "$type p".$num."=";
+                print OUTPUT castFrom($type);
+                print OUTPUT ";\n"; 
+        } 
+        return $r;
+}
+sub processClass
+{
+        my $proto=shift;
+        
+        $proto=~s%.*\*/%%g;
+        $proto=~s/ //g;
+        #print "**$proto**\n";
+        ($className,$cookieName)=split ":",$proto; 
+        print "Processing class $className (with cookie=$cookieName)\n"; 
+        if($cookieName=~m/void/)
+        {
+                $staticClass=1;
+        }
+        else
+        {
+                $staticClass=0;
+        }
+
+}
+#
+# Process a function declaration and write the glue code to do tinypy<->function call
+#
+sub processFunc
+{
+        my $proto=shift;
+        my $args=$proto;
+        my @params;
+        my $retType=$proto;;
+        my $func=$proto;;
+        my $cfunc;
+        $args=~s/^.*\(//g;
+        $args=~s/\).*$//g;
+        #print "args => $args\n";
+        @params=split ",",$args;
+        #print "params -> @params\n";
+        # Get return type...
+        $retType=~s/^ *//g;
+        $retType=~s/ .*$//g;
+        # get functioName
+        $func=~s/ *\(.*$//g;
+        $func=~s/^.* //g;
+        ($cfunc,$func)=split ":",$func;
+        print OUTPUT "//$retType  $cfunc <@params>\n";
+        # Write glue code
+        print OUTPUT "tp_obj ".$glueprefix.$func."(TP)\n";
+        push(@allFuncs,$func);
+        print OUTPUT "{\n";
+        my $nb=scalar(@params);
+        my $i;
+
+
+        for($i=0;$i<$nb;$i++)
+        {
+                $params[$i]=~s/^ *//g; # Remove " " at the beginning if any
+                $params[$i]=~s/ *$//g; # Remove " " at the end if any
+        }
+        if($params[0]=~m/^void$/)
+        {
+                $nb=0;
+        }
+        print " New function : $retType,$func,<@params>\n";
+        print HEADER "$retType  $functionPrefix".$func." ($args);\n";
+        #
+        if($nb)
+        {
+                print OUTPUT "tinyParams pm(tp);\n";
+                #print OUTPUT "if(pm.getNbParams()!=$nb) pm.raise(\"".$func."Bad number of parameters, wanted ".$nb." and got %d\",pm.getNbParams());\n";
+        }
+
+        for($i=0;$i<$nb;$i++)
+        {
+                if(!genParam($i,$params[$i]))  # all params consumed
+                {
+                        #$i=$nb;
+                }
+        }
+        # Call real function
+        if(!($retType=~m/^void$/))
+        {
+                if($retType=~m/str/)
+                {
+                print OUTPUT "char *r=";
+                }else
+                {
+                print OUTPUT $retType." r=";
+                }
+        }
+        print OUTPUT $functionPrefix.$cfunc."(";
+        for($i=0;$i<$nb;$i++)
+        {
+                if($i)
+                {
+                        print OUTPUT ",";
+                }
+                print OUTPUT "p".$i;
+        } 
+        print OUTPUT "); \n";
+        # Cast r to pyobj
+        print OUTPUT genReturn($retType);
+        print OUTPUT "\n}\n";
+
+
+}
+
+
+if(scalar(@ARGV)!=1)
+{
+        die("admPy inputfile\n");
+}
+$input=$ARGV[0];
+$output=$input;
+$output=~s/\..*$//g;
+my $thisfile=$output;
+$thisfile=~s/^.*\///g;
+$headerFile=$output."_gen.h";
+$output=$output."_gen.cpp";
+print "Processing $input=>$output\n";
+open(OUTPUT,">$output") or die("Cannot open $output");
+print OUTPUT "// Generated by admPyClass.pl do not edit !\n";
+##
+## Main Loop
+##
+# 1 grab all functions
+open(INPUT,$input) or die("Cannot open $input");
+close(INPUT);
+# Process them
+open(INPUT,$input) or die("Cannot open $input");
+open(HEADER,">$headerFile") or die("Cannot open $headerFile");
+while($line=<INPUT>)
+{
+        chomp($line);
+        if($line=~m/^#/)
+        {
+        }
+        else
+        {
+            if($line=~m/\* FUNC \*/)
+            {
+                my $proto=$line;
+                # Remove header...
+                # Remove tail
+                $line=~s/^.*\*\///g;
+                $line=~s/\/\/.*$//g;
+                processFunc($line);
+
+            } elsif($line =~m/\/* CLASS \*/)
+                {
+                        processClass($line);
+                }
+        }
+}
+# gen class array
+
+
+# gen class xctor
+        print OUTPUT "static tp_obj myCtor".$className."(tp_vm *vm)\n";
+        print OUTPUT "{\n";
+        if($staticClass==0)
+        {
+                #todo allocate cookie
+        }
+        print OUTPUT "}\n";
+  
+#
+my $nbFunc=scalar(@allFuncs);
+my $i;
+        print OUTPUT "tp_obj initClass".$className."(tp_vm *vm)\n";
+        print OUTPUT "{\n";
+        print OUTPUT " tp_obj myClass=tp_class(vm);\n";
+        print OUTPUT " tp_set(vm,myClass,tp_string(\"__init__\"),tp_fnc(vm,myCtor".$className."));\n";
+        for($i=0;$i<$nbFunc;$i++)
+        {
+                my $line=$allFuncs[$i];
+                #print "Function : $line\n";
+                my $funcName;
+                my $funcProto;
+                $funcName="\"".$line."\"";
+                $funcProto=$glueprefix.$line;
+
+                print OUTPUT " tp_set(vm,myClass,tp_string($funcName),tp_fnc(vm,$funcProto));\n";
+        }
+        print OUTPUT " return myClass;\n";
+        print OUTPUT "}\n";
+        #print OUTPUT "{$funcName,$funcProto},\n";
+
+
+close(INPUT);
+close(OUTPUT);
+close(HEADER);
+print "done\n.";



From mean at mail.berlios.de  Sat May 29 17:42:40 2010
From: mean at mail.berlios.de (mean at BerliOS)
Date: Sat, 29 May 2010 17:42:40 +0200
Subject: [Avidemux-svn-commit] r6269 - in
	branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2:
	include js py src
Message-ID: <201005291542.o4TFgeZS019508@sheep.berlios.de>

Author: mean
Date: 2010-05-29 17:42:39 +0200 (Sat, 29 May 2010)
New Revision: 6269

Modified:
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/include/ADM_scriptUtils.h
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/include/ADM_scriptVideo.h
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/js/ADM_jsVideo.cpp
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/py/ADM_pyAdm.cpp
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/py/adm.admPyClass
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/py/adm_gen.cpp
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/py/adm_gen.h
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src/ADM_scriptUtils.cpp
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src/ADM_scriptVideo.cpp
Log:
[py] Hook container

Modified: branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/include/ADM_scriptUtils.h
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/include/ADM_scriptUtils.h	2010-05-29 15:42:36 UTC (rev 6268)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/include/ADM_scriptUtils.h	2010-05-29 15:42:39 UTC (rev 6269)
@@ -1,4 +1,18 @@
 /**
-
+    \file ADM_scriptUtil
+    \brief Standard includes and defines
 */
 
+/***************************************************************************
+ *                                                                         *
+ *   This program is free software; you can redistribute it and/or modify  *
+ *   it under the terms of the GNU General Public License as published by  *
+ *   the Free Software Foundation; either version 2 of the License, or     *
+ *   (at your option) any later version.                                   *
+ *                                                                         *
+ ***************************************************************************/
+#ifndef ADM_SCRIPT_UTIL_H
+#define ADM_SCRIPT_UTIL_H
+int scriptSetContainer(const char *container, CONFcouple *conf);
+
+#endif
\ No newline at end of file

Modified: branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/include/ADM_scriptVideo.h
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/include/ADM_scriptVideo.h	2010-05-29 15:42:36 UTC (rev 6268)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/include/ADM_scriptVideo.h	2010-05-29 15:42:39 UTC (rev 6269)
@@ -21,6 +21,7 @@
 
 int     jsSetPostProc (int a,int b, int c);
 int     scriptSetVideoCodec(const char *codec,CONFcouple *c);
+int     scriptAddVideoFilter(const char *filter,CONFcouple *c);
 
 #ifdef __cplusplus
 };

Modified: branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/js/ADM_jsVideo.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/js/ADM_jsVideo.cpp	2010-05-29 15:42:36 UTC (rev 6268)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/js/ADM_jsVideo.cpp	2010-05-29 15:42:39 UTC (rev 6269)
@@ -65,16 +65,12 @@
         if(argc == 0)
                 return JS_FALSE;
         char *filterName=JS_GetStringBytes(JSVAL_TO_STRING(argv[0]));
-        filterTag = ADM_vf_getTagFromInternalName(filterName);
-        jsLog("Adding Filter %s -> %"LU"... \n",filterName,filterTag);
-
-        
         CONFcouple *c=NULL;
         if(argc)
             jsArgToConfCouple(argc-1,&c,argv+1);
-        *rval=BOOLEAN_TO_JSVAL(  ADM_vf_addFilterFromTag(filterTag,c,false));
-        if(c) delete c;
-        
+        bool r=scriptAddVideoFilter(filterName,c);
+
+        *rval=BOOLEAN_TO_JSVAL( r);
         return JS_TRUE;
 }// end Codec
 //EOF

Modified: branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/py/ADM_pyAdm.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/py/ADM_pyAdm.cpp	2010-05-29 15:42:36 UTC (rev 6268)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/py/ADM_pyAdm.cpp	2010-05-29 15:42:39 UTC (rev 6269)
@@ -24,6 +24,7 @@
 #include "ADM_scriptVideo.h"
 #include "ADM_scriptAudio.h"
 #include "ADM_scriptEditor.h"
+#include "ADM_scriptUtils.h"
 
 #include "adm_gen.cpp"
 #include "editor_gen.cpp"

Modified: branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/py/adm.admPyClass
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/py/adm.admPyClass	2010-05-29 15:42:36 UTC (rev 6268)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/py/adm.admPyClass	2010-05-29 15:42:39 UTC (rev 6269)
@@ -17,3 +17,5 @@
 #              cname:pyname
 /* FUNC */ int scriptSetVideoCodec:videoCodec(const char *,couples) 
 /* FUNC */ int scriptSetAudioCodec:audioCodec(const char *,int,couples) 
+/* FUNC */ int scriptSetContainer:setContainer(const char *,couples) 
+/* FUNC */ int scriptAddVideoFilter:addVideoFilter(const char *,couples) 

Modified: branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/py/adm_gen.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/py/adm_gen.cpp	2010-05-29 15:42:36 UTC (rev 6268)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/py/adm_gen.cpp	2010-05-29 15:42:39 UTC (rev 6269)
@@ -26,8 +26,8 @@
 {
 tinyParams pm(tp);
 int p0=pm.asDouble();
-float p1=pm.asDouble();
-float p2=pm.asDouble();
+float p1=pm.asFloat();
+float p2=pm.asFloat();
 int r=jsAddSegment(p0,p1,p2); 
 return tp_number(r);
 }
@@ -106,6 +106,26 @@
 int r=scriptSetAudioCodec(p0,p1,p2); 
 return tp_number(r);
 }
+//int  scriptSetContainer <const char * couples>
+tp_obj zzpy_setContainer(TP)
+{
+tinyParams pm(tp);
+const char * p0=pm.asString();
+CONFcouple *p1=NULL;
+pm.makeCouples(&p1);
+int r=scriptSetContainer(p0,p1); 
+return tp_number(r);
+}
+//int  scriptAddVideoFilter <const char * couples>
+tp_obj zzpy_addVideoFilter(TP)
+{
+tinyParams pm(tp);
+const char * p0=pm.asString();
+CONFcouple *p1=NULL;
+pm.makeCouples(&p1);
+int r=scriptAddVideoFilter(p0,p1); 
+return tp_number(r);
+}
 static tp_obj myCtorpyAdm(tp_vm *vm)
 {
 }
@@ -127,5 +147,7 @@
  tp_set(vm,myClass,tp_string("clearVideoFilters"),tp_fnc(vm,zzpy_clearVideoFilters));
  tp_set(vm,myClass,tp_string("videoCodec"),tp_fnc(vm,zzpy_videoCodec));
  tp_set(vm,myClass,tp_string("audioCodec"),tp_fnc(vm,zzpy_audioCodec));
+ tp_set(vm,myClass,tp_string("setContainer"),tp_fnc(vm,zzpy_setContainer));
+ tp_set(vm,myClass,tp_string("addVideoFilter"),tp_fnc(vm,zzpy_addVideoFilter));
  return myClass;
 }

Modified: branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/py/adm_gen.h
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/py/adm_gen.h	2010-05-29 15:42:36 UTC (rev 6268)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/py/adm_gen.h	2010-05-29 15:42:39 UTC (rev 6269)
@@ -12,3 +12,5 @@
 int  clearVideoFilters (void);
 int  videoCodec (const char *,couples);
 int  audioCodec (const char *,int,couples);
+int  setContainer (const char *,couples);
+int  addVideoFilter (const char *,couples);

Modified: branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src/ADM_scriptUtils.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src/ADM_scriptUtils.cpp	2010-05-29 15:42:36 UTC (rev 6268)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src/ADM_scriptUtils.cpp	2010-05-29 15:42:39 UTC (rev 6269)
@@ -1,3 +1,38 @@
 /**
-
-*/
\ No newline at end of file
+    \file ADM_scriptUtils.cpp
+*/
+/***************************************************************************
+ *                                                                         *
+ *   This program is free software; you can redistribute it and/or modify  *
+ *   it under the terms of the GNU General Public License as published by  *
+ *   the Free Software Foundation; either version 2 of the License, or     *
+ *   (at your option) any later version.                                   *
+ *                                                                         *
+ ***************************************************************************/
+#include "ADM_scriptIf.h"
+#include "ADM_editor/ADM_edit.hxx"
+#include "GUI_ui.h"
+#include "ADM_scriptCommon.h"
+#include "ADM_confCouple.h"
+#include "ADM_scriptUtils.h"
+#include "ADM_muxerProto.h"
+bool A_setContainer(const char *cont);
+/**
+    \fn scriptSetContainer
+*/
+int scriptSetContainer(const char *container, CONFcouple *conf)
+{
+    bool r=true;
+    if(A_setContainer(container))
+    {
+        int idx=ADM_MuxerIndexFromName(container);
+        if(idx!=-1)
+        {
+            r = ADM_mx_setExtraConf(idx,conf);
+        }else
+           r=false;
+    } else r=false;
+    if(conf) delete conf;
+    return r;
+}
+//EOF

Modified: branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src/ADM_scriptVideo.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src/ADM_scriptVideo.cpp	2010-05-29 15:42:36 UTC (rev 6268)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src/ADM_scriptVideo.cpp	2010-05-29 15:42:39 UTC (rev 6269)
@@ -111,5 +111,21 @@
 {
     video_body->setMarkerBPts( (uint64_t)b);
 }
-
+/**
+     \fn scriptAddVideoFilter
+*/
+int     scriptAddVideoFilter(const char *filter,CONFcouple *c)
+{
+   uint32_t filterTag;     
+   bool r=true;
+        filterTag = ADM_vf_getTagFromInternalName(filter);
+        jsLog("Adding Filter %s -> %"LU"... \n",filter,filterTag);
+        if(c)
+        {
+            r=ADM_vf_addFilterFromTag(filterTag,c,false);
+        }
+        if(c) delete c;
+        
+        return r;
+}
 //EOF



From mean at mail.berlios.de  Sat May 29 17:42:41 2010
From: mean at mail.berlios.de (mean at BerliOS)
Date: Sat, 29 May 2010 17:42:41 +0200
Subject: [Avidemux-svn-commit] r6270 - in
	branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2:
	include js py src
Message-ID: <201005291542.o4TFgf1j019518@sheep.berlios.de>

Author: mean
Date: 2010-05-29 17:42:41 +0200 (Sat, 29 May 2010)
New Revision: 6270

Modified:
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/include/ADM_scriptAvidemux.h
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/include/ADM_scriptCommon.h
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/include/ADM_scriptVideo.h
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/js/ADM_jsAvidemux.h
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/js/ADM_jsAvidemux_js.c
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/js/ADM_jsAvidemux_js.idl
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/js/ADM_jsUtils.h
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/py/adm.admPyClass
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/py/adm_gen.cpp
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src/ADM_scriptAudio.cpp
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src/ADM_scriptAvidemux.cpp
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src/ADM_scriptAvidemuxInfo.cpp
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src/ADM_scriptVideo.cpp
Log:
[py] More binding

Modified: branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/include/ADM_scriptAvidemux.h
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/include/ADM_scriptAvidemux.h	2010-05-29 15:42:39 UTC (rev 6269)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/include/ADM_scriptAvidemux.h	2010-05-29 15:42:41 UTC (rev 6270)
@@ -18,27 +18,6 @@
 extern "C" {
 #endif
 
-int jsLoadVideo(const char *c);
-int jsAppendVideo(const char *c);
-int jsClearSegments(void);
-int jsAddSegment(int ref, double start, double duration);
-int jsAudioReset(void);
-int jsAudioMixer(const char *s);
-// Fq
-int32_t jsGetResample(void);
-void    jsSetResample(int32_t fq);
-// Markers
-double jsGetMarkerA(void);
-double jsGetMarkerB(void);
-void   jsSetMarkerA(double a);
-void   jsSetMarkerB(double b);
-//
-int    jsClearVideoFilters();
-// Info
-int jsGetWidth ( void) ;
-int jsGetHeight ( void) ;
-int jsGetFps1000 ( void) ;
-char *jsGetVideoCodec ( void) ;
 
 #ifdef __cplusplus
 };

Modified: branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/include/ADM_scriptCommon.h
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/include/ADM_scriptCommon.h	2010-05-29 15:42:39 UTC (rev 6269)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/include/ADM_scriptCommon.h	2010-05-29 15:42:41 UTC (rev 6270)
@@ -11,32 +11,39 @@
  *   (at your option) any later version.                                   *
  *                                                                         *
  ***************************************************************************/
+#ifndef ADM_SCRIPT_COMMON
+#define ADM_SCRIPT_COMMON
+#include "ADM_inttype.h"
 #ifdef __cplusplus
 extern "C" {
 #endif
 
-int jsLoadVideo(const char *c);
-int jsAppendVideo(const char *c);
-int jsClearSegments(void);
-int jsAddSegment(int ref, double start, double duration);
-int jsAudioReset(void);
-int jsAudioMixer(const char *s);
+int scriptLoadVideo(const char *c);
+int scriptAppendVideo(const char *c);
+int scriptClearSegments(void);
+int scriptAddSegment(int ref, double start, double duration);
+int scriptAudioReset(void);
+int scriptAudioMixer(const char *s);
 // Fq
-int32_t jsGetResample(void);
-void    jsSetResample(int32_t fq);
+int32_t scriptGetResample(void);
+void    scriptSetResample(int32_t fq);
 // Markers
-double jsGetMarkerA(void);
-double jsGetMarkerB(void);
-void   jsSetMarkerA(double a);
-void   jsSetMarkerB(double b);
+double scriptGetMarkerA(void);
+double scriptGetMarkerB(void);
+void   scriptSetMarkerA(double a);
+void   scriptSetMarkerB(double b);
 //
-int    jsClearVideoFilters();
+int    scriptClearVideoFilters();
 // Info
-int jsGetWidth ( void) ;
-int jsGetHeight ( void) ;
-int jsGetFps1000 ( void) ;
+int scriptGetWidth ( void) ;
+int scriptGetHeight ( void) ;
+int scriptGetFps1000 ( void) ;
 char *jsGetVideoCodec ( void) ;
+// Misc
+int scriptSetPostProc (int a,int b, int c);
+char *scriptGetVideoCodec ( void);
 
 #ifdef __cplusplus
 };
 #endif 
+#endif

Modified: branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/include/ADM_scriptVideo.h
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/include/ADM_scriptVideo.h	2010-05-29 15:42:39 UTC (rev 6269)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/include/ADM_scriptVideo.h	2010-05-29 15:42:41 UTC (rev 6270)
@@ -13,16 +13,18 @@
  ***************************************************************************/
 #ifndef ADM_JS_VIDEO_H
 #define ADM_JS_VIDEO_H
+#ifdef __cplusplus
 #include "ADM_confCouple.h"
-#ifdef __cplusplus
 extern "C" {
+#else
 #endif
 
 
-int     jsSetPostProc (int a,int b, int c);
+int     scriptSetPostProc (int a,int b, int c);
+#ifdef __cplusplus
 int     scriptSetVideoCodec(const char *codec,CONFcouple *c);
 int     scriptAddVideoFilter(const char *filter,CONFcouple *c);
-
+#endif
 #ifdef __cplusplus
 };
 #endif

Modified: branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/js/ADM_jsAvidemux.h
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/js/ADM_jsAvidemux.h	2010-05-29 15:42:39 UTC (rev 6269)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/js/ADM_jsAvidemux.h	2010-05-29 15:42:41 UTC (rev 6270)
@@ -19,7 +19,7 @@
 extern "C" {
 #endif
 #include "ADM_scriptCommon.h"
-//char *jsGetVideoCodec ( void) ;
+#include "ADM_scriptVideo.h"
 
 // non jsapigen function, variables number of args
 JSBool jsAdmaddVideoFilter(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval);

Modified: branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/js/ADM_jsAvidemux_js.c
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/js/ADM_jsAvidemux_js.c	2010-05-29 15:42:39 UTC (rev 6269)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/js/ADM_jsAvidemux_js.c	2010-05-29 15:42:41 UTC (rev 6270)
@@ -19,6 +19,10 @@
 {
         printf("Constructor invoked\n");
 }
+static int dummy_scriptVideoCodec(char *a) {return 0;}
+static int dummy_scriptVideoFilter(char *a) {return 0;}
+static int dummy_scriptAudioCodec(char *a) {return 0;}
+static int dummy_scriptSetContainer(char *a) {return 0;}
 
 #ifdef HAVE_ALLOCA_H
 #include <alloca.h>
@@ -58,7 +62,7 @@
     if (!JS_EnterLocalRootScope(cx)) {
         goto do_return;
     }
-    var2 = jsGetMarkerA();
+    var2 = scriptGetMarkerA();
     if (JS_NewNumberValue(cx, var2, &var5) != JS_TRUE) {
         goto do_return;
     }
@@ -89,7 +93,7 @@
         goto do_return;
     }
     var7 = (double)var11;
-    jsSetMarkerA(var7);
+    scriptSetMarkerA(var7);
     var6 = JS_TRUE;
     do_return:
     JS_LeaveLocalRootScope(cx);
@@ -107,7 +111,7 @@
     if (!JS_EnterLocalRootScope(cx)) {
         goto do_return;
     }
-    var13 = jsGetMarkerB();
+    var13 = scriptGetMarkerB();
     if (JS_NewNumberValue(cx, var13, &var16) != JS_TRUE) {
         goto do_return;
     }
@@ -138,7 +142,7 @@
         goto do_return;
     }
     var18 = (double)var22;
-    jsSetMarkerB(var18);
+    scriptSetMarkerB(var18);
     var17 = JS_TRUE;
     do_return:
     JS_LeaveLocalRootScope(cx);
@@ -156,7 +160,7 @@
     if (!JS_EnterLocalRootScope(cx)) {
         goto do_return;
     }
-    var24 = jsGetResample();
+    var24 = scriptGetResample();
     if (JS_NewNumberValue(cx, var24, &var27) != JS_TRUE) {
         goto do_return;
     }
@@ -187,7 +191,7 @@
         goto do_return;
     }
     var29 = (int)var33;
-    jsSetResample(var29);
+    scriptSetResample(var29);
     var28 = JS_TRUE;
     do_return:
     JS_LeaveLocalRootScope(cx);
@@ -266,7 +270,7 @@
         var40[var44] = '\0';
     }
     }
-    var36 = jsLoadVideo(var40);
+    var36 = scriptLoadVideo(var40);
     if (JS_NewNumberValue(cx, var36, &var49) != JS_TRUE) {
         goto do_return;
     }
@@ -298,7 +302,7 @@
     var50 = JS_FALSE;
     var51 = obj;
     var55 = argc;
-    var52 = jsClearSegments();
+    var52 = scriptClearSegments();
     if (JS_NewNumberValue(cx, var52, &var56) != JS_TRUE) {
         goto do_return;
     }
@@ -383,7 +387,7 @@
         var63[var67] = '\0';
     }
     }
-    var59 = jsAppendVideo(var63);
+    var59 = scriptAppendVideo(var63);
     if (JS_NewNumberValue(cx, var59, &var72) != JS_TRUE) {
         goto do_return;
     }
@@ -466,7 +470,7 @@
     }
     var81 = (double)var90;
     }
-    var75 = jsAddSegment(var79, var80, var81);
+    var75 = scriptAddSegment(var79, var80, var81);
     if (JS_NewNumberValue(cx, var75, &var91) != JS_TRUE) {
         goto do_return;
     }
@@ -544,7 +548,7 @@
     }
     var100 = (int)var109;
     }
-    var94 = jsSetPostProc(var98, var99, var100);
+    var94 = scriptSetPostProc(var98, var99, var100);
     if (JS_NewNumberValue(cx, var94, &var110) != JS_TRUE) {
         goto do_return;
     }
@@ -571,7 +575,7 @@
     var111 = JS_FALSE;
     var112 = obj;
     var116 = argc;
-    var113 = jsGetWidth();
+    var113 = scriptGetWidth();
     if (JS_NewNumberValue(cx, var113, &var117) != JS_TRUE) {
         goto do_return;
     }
@@ -598,7 +602,7 @@
     var118 = JS_FALSE;
     var119 = obj;
     var123 = argc;
-    var120 = jsGetHeight();
+    var120 = scriptGetHeight();
     if (JS_NewNumberValue(cx, var120, &var124) != JS_TRUE) {
         goto do_return;
     }
@@ -625,7 +629,7 @@
     var125 = JS_FALSE;
     var126 = obj;
     var130 = argc;
-    var127 = jsGetFps1000();
+    var127 = scriptGetFps1000();
     if (JS_NewNumberValue(cx, var127, &var131) != JS_TRUE) {
         goto do_return;
     }
@@ -660,7 +664,7 @@
     var132 = JS_FALSE;
     var133 = obj;
     var137 = argc;
-    var134 = jsGetVideoCodec();
+    var134 = scriptGetVideoCodec();
     if (var134) {
     var139 = JS_NewStringCopyZ(cx, var134);
     if (!var139) {
@@ -700,7 +704,7 @@
     var141 = JS_FALSE;
     var142 = obj;
     var146 = argc;
-    var143 = jsAudioReset();
+    var143 = scriptAudioReset();
     if (JS_NewNumberValue(cx, var143, &var147) != JS_TRUE) {
         goto do_return;
     }
@@ -785,7 +789,7 @@
         var154[var158] = '\0';
     }
     }
-    var150 = jsAudioMixer(var154);
+    var150 = scriptAudioMixer(var154);
     if (JS_NewNumberValue(cx, var150, &var163) != JS_TRUE) {
         goto do_return;
     }
@@ -817,7 +821,7 @@
     var164 = JS_FALSE;
     var165 = obj;
     var169 = argc;
-    var166 = jsClearVideoFilters();
+    var166 = scriptClearVideoFilters();
     if (JS_NewNumberValue(cx, var166, &var170) != JS_TRUE) {
         goto do_return;
     }
@@ -902,7 +906,7 @@
         var177[var181] = '\0';
     }
     }
-    var173 = jsVideoCodec(var177);
+    var173 = dummy_scriptVideoCodec(var177);
     if (JS_NewNumberValue(cx, var173, &var186) != JS_TRUE) {
         goto do_return;
     }
@@ -992,7 +996,7 @@
         var193[var197] = '\0';
     }
     }
-    var189 = jsVideoFilter(var193);
+    var189 = dummy_scriptVideoFilter(var193);
     if (JS_NewNumberValue(cx, var189, &var202) != JS_TRUE) {
         goto do_return;
     }
@@ -1082,7 +1086,7 @@
         var209[var213] = '\0';
     }
     }
-    var205 = jsAudioCodec(var209);
+    var205 = dummy_scriptAudioCodec(var209);
     if (JS_NewNumberValue(cx, var205, &var218) != JS_TRUE) {
         goto do_return;
     }
@@ -1172,7 +1176,7 @@
         var225[var229] = '\0';
     }
     }
-    var221 = jsSetContainer(var225);
+    var221 = dummy_scriptSetContainer(var225);
     if (JS_NewNumberValue(cx, var221, &var234) != JS_TRUE) {
         goto do_return;
     }

Modified: branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/js/ADM_jsAvidemux_js.idl
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/js/ADM_jsAvidemux_js.idl	2010-05-29 15:42:39 UTC (rev 6269)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/js/ADM_jsAvidemux_js.idl	2010-05-29 15:42:41 UTC (rev 6270)
@@ -5,34 +5,38 @@
 {
         printf("Constructor invoked\n");
 }
+static int dummy_scriptVideoCodec(char *a) {return 0;}
+static int dummy_scriptVideoFilter(char *a) {return 0;}
+static int dummy_scriptAudioCodec(char *a) {return 0;}
+static int dummy_scriptSetContainer(char *a) {return 0;}
 %}
         /*            JSFUNC      C FUNC  PARAM     */
 class adm
 {
-        function int loadVideo      : jsLoadVideo (cstring ) <static>;
-        function int clearSegments  : jsClearSegments () <static>;
-        function int appendVideo    : jsAppendVideo (cstring ) <static>;
-        function int addSegment     : jsAddSegment (int ,double , double ) <static>;
-        function int setPostProc    : jsSetPostProc (int ,int , int ) <static>;
-        function int getWidth       : jsGetWidth ( ) <static>;
-        function int getHeight      : jsGetHeight ( ) <static>;
-        function int getFps1000     : jsGetFps1000 ( ) <static>;
-     function cstring getVideoCodec : jsGetVideoCodec ( ) <static>;
+        function int loadVideo      : scriptLoadVideo (cstring ) <static>;
+        function int clearSegments  : scriptClearSegments () <static>;
+        function int appendVideo    : scriptAppendVideo (cstring ) <static>;
+        function int addSegment     : scriptAddSegment (int ,double , double ) <static>;
+        function int setPostProc    : scriptSetPostProc (int ,int , int ) <static>;
+        function int getWidth       : scriptGetWidth ( ) <static>;
+        function int getHeight      : scriptGetHeight ( ) <static>;
+        function int getFps1000     : scriptGetFps1000 ( ) <static>;
+     function cstring getVideoCodec : scriptGetVideoCodec ( ) <static>;
         /*            JSFUNC                 C FUNC           PARAM     */
-        function int audioReset     : jsAudioReset () <static>;
-        function int audioMixer     : jsAudioMixer (cstring ) <static>;
+        function int audioReset     : scriptAudioReset () <static>;
+        function int audioMixer     : scriptAudioMixer (cstring ) <static>;
         /*            JSFUNC                 C FUNC           PARAM     */
-        function int clearVideoFilters   : jsClearVideoFilters() <static>;
+        function int clearVideoFilters   : scriptClearVideoFilters() <static>;
         
 /* Override as jsapigen cannot handle multiple args the way we need it to */
-        function int videoCodec_ignore     : jsVideoCodec(cstring)     <static>;
-        function int addVideoFilter_ignore : jsVideoFilter(cstring)    <static>;
-        function int audioCodec_ignore     : jsAudioCodec(cstring)     <static>;
-        function int setContainer_ignore   : jsSetContainer(cstring)   <static>;
+        function int videoCodec_ignore     : dummy_scriptVideoCodec(cstring)     <static>;
+        function int addVideoFilter_ignore : dummy_scriptVideoFilter(cstring)    <static>;
+        function int audioCodec_ignore     : dummy_scriptAudioCodec(cstring)     <static>;
+        function int setContainer_ignore   : dummy_scriptSetContainer(cstring)   <static>;
 /* Properties */
-        property double markerA            : jsGetMarkerA,jsSetMarkerA <static>;
-        property double markerB            : jsGetMarkerB,jsSetMarkerB <static>;
-        property int    audioResample      : jsGetResample,jsSetResample <static>;
+        property double markerA            : scriptGetMarkerA,scriptSetMarkerA <static>;
+        property double markerB            : scriptGetMarkerB,scriptSetMarkerB <static>;
+        property int    audioResample      : scriptGetResample,scriptSetResample <static>;
         construct                          : jsAvidemux  ( ) <static>     ; 
 };
 

Modified: branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/js/ADM_jsUtils.h
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/js/ADM_jsUtils.h	2010-05-29 15:42:39 UTC (rev 6269)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/js/ADM_jsUtils.h	2010-05-29 15:42:41 UTC (rev 6270)
@@ -35,6 +35,5 @@
 
 // since long int will be coded by js as double, we need a centralized version to convert
 bool ADM_jsArg2Vars(const char *caller, int argc, jsval *argv, int paramNumber, ADM_PARAM_LIST *param);
-bool stringsToConfCouple(int nb,CONFcouple **conf,  const char **argv);
 bool jsArgToConfCouple(int nb,CONFcouple **conf,  jsval *argv);
 #endif

Modified: branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/py/adm.admPyClass
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/py/adm.admPyClass	2010-05-29 15:42:39 UTC (rev 6269)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/py/adm.admPyClass	2010-05-29 15:42:41 UTC (rev 6270)
@@ -1,17 +1,17 @@
 #              cname:pyname
 /* CLASS */ pyAdm : void
-/* FUNC */ int jsLoadVideo:loadVideo          (const char * ) 
-/* FUNC */ int jsClearSegments:clearSegments  (void) 
-/* FUNC */ int jsAppendVideo:appendVideo      (const char * ) 
-/* FUNC */ int jsAddSegment:addSegment        (int ,float , float ) 
-/* FUNC */ int jsSetPostProc:setPostProc      (int ,int , int ) 
-/* FUNC */ int jsGetWidth:getWidth            (void) 
-/* FUNC */ int jsGetHeight:getHeight          (void) 
-/* FUNC */ int jsGetFps1000:getFps1000        (void) 
-/* FUNC */ str jsGetVideoCodec:getVideoCodec(void) 
-/* FUNC */ int jsAudioReset:audioReset        (void) 
-/* FUNC */ int jsAudioMixer:audioMixer        (const char * ) 
-/* FUNC */ int jsClearVideoFilters:clearVideoFilters   (void) 
+/* FUNC */ int scriptLoadVideo:loadVideo          (const char * ) 
+/* FUNC */ int scriptClearSegments:clearSegments  (void) 
+/* FUNC */ int scriptAppendVideo:appendVideo      (const char * ) 
+/* FUNC */ int scriptAddSegment:addSegment        (int ,float , float ) 
+/* FUNC */ int scriptSetPostProc:setPostProc      (int ,int , int ) 
+/* FUNC */ int scriptGetWidth:getWidth            (void) 
+/* FUNC */ int scriptGetHeight:getHeight          (void) 
+/* FUNC */ int scriptGetFps1000:getFps1000        (void) 
+/* FUNC */ str scriptGetVideoCodec:getVideoCodec(void) 
+/* FUNC */ int scriptAudioReset:audioReset        (void) 
+/* FUNC */ int scriptAudioMixer:audioMixer        (const char * ) 
+/* FUNC */ int scriptClearVideoFilters:clearVideoFilters   (void) 
 #
 #
 #              cname:pyname

Modified: branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/py/adm_gen.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/py/adm_gen.cpp	2010-05-29 15:42:39 UTC (rev 6269)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/py/adm_gen.cpp	2010-05-29 15:42:41 UTC (rev 6270)
@@ -1,88 +1,88 @@
 // Generated by admPyClass.pl do not edit !
-//int  jsLoadVideo <const char * >
+//int  scriptLoadVideo <const char * >
 tp_obj zzpy_loadVideo(TP)
 {
 tinyParams pm(tp);
 const char * p0=pm.asString();
-int r=jsLoadVideo(p0); 
+int r=scriptLoadVideo(p0); 
 return tp_number(r);
 }
-//int  jsClearSegments <void>
+//int  scriptClearSegments <void>
 tp_obj zzpy_clearSegments(TP)
 {
-int r=jsClearSegments(); 
+int r=scriptClearSegments(); 
 return tp_number(r);
 }
-//int  jsAppendVideo <const char * >
+//int  scriptAppendVideo <const char * >
 tp_obj zzpy_appendVideo(TP)
 {
 tinyParams pm(tp);
 const char * p0=pm.asString();
-int r=jsAppendVideo(p0); 
+int r=scriptAppendVideo(p0); 
 return tp_number(r);
 }
-//int  jsAddSegment <int  float   float >
+//int  scriptAddSegment <int  float   float >
 tp_obj zzpy_addSegment(TP)
 {
 tinyParams pm(tp);
 int p0=pm.asDouble();
 float p1=pm.asFloat();
 float p2=pm.asFloat();
-int r=jsAddSegment(p0,p1,p2); 
+int r=scriptAddSegment(p0,p1,p2); 
 return tp_number(r);
 }
-//int  jsSetPostProc <int  int   int >
+//int  scriptSetPostProc <int  int   int >
 tp_obj zzpy_setPostProc(TP)
 {
 tinyParams pm(tp);
 int p0=pm.asDouble();
 int p1=pm.asDouble();
 int p2=pm.asDouble();
-int r=jsSetPostProc(p0,p1,p2); 
+int r=scriptSetPostProc(p0,p1,p2); 
 return tp_number(r);
 }
-//int  jsGetWidth <void>
+//int  scriptGetWidth <void>
 tp_obj zzpy_getWidth(TP)
 {
-int r=jsGetWidth(); 
+int r=scriptGetWidth(); 
 return tp_number(r);
 }
-//int  jsGetHeight <void>
+//int  scriptGetHeight <void>
 tp_obj zzpy_getHeight(TP)
 {
-int r=jsGetHeight(); 
+int r=scriptGetHeight(); 
 return tp_number(r);
 }
-//int  jsGetFps1000 <void>
+//int  scriptGetFps1000 <void>
 tp_obj zzpy_getFps1000(TP)
 {
-int r=jsGetFps1000(); 
+int r=scriptGetFps1000(); 
 return tp_number(r);
 }
-//str  jsGetVideoCodec <void>
+//str  scriptGetVideoCodec <void>
 tp_obj zzpy_getVideoCodec(TP)
 {
-char *r=jsGetVideoCodec(); 
+char *r=scriptGetVideoCodec(); 
 return tp_string(r);
 }
-//int  jsAudioReset <void>
+//int  scriptAudioReset <void>
 tp_obj zzpy_audioReset(TP)
 {
-int r=jsAudioReset(); 
+int r=scriptAudioReset(); 
 return tp_number(r);
 }
-//int  jsAudioMixer <const char * >
+//int  scriptAudioMixer <const char * >
 tp_obj zzpy_audioMixer(TP)
 {
 tinyParams pm(tp);
 const char * p0=pm.asString();
-int r=jsAudioMixer(p0); 
+int r=scriptAudioMixer(p0); 
 return tp_number(r);
 }
-//int  jsClearVideoFilters <void>
+//int  scriptClearVideoFilters <void>
 tp_obj zzpy_clearVideoFilters(TP)
 {
-int r=jsClearVideoFilters(); 
+int r=scriptClearVideoFilters(); 
 return tp_number(r);
 }
 //int  scriptSetVideoCodec <const char * couples>

Modified: branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src/ADM_scriptAudio.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src/ADM_scriptAudio.cpp	2010-05-29 15:42:39 UTC (rev 6269)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src/ADM_scriptAudio.cpp	2010-05-29 15:42:41 UTC (rev 6270)
@@ -28,7 +28,7 @@
 /**
     \fn int jsAudioReset(void);
 */
-int jsAudioReset (void)
+int scriptAudioReset (void)
 {
     audioFilterReset();
     return 1;
@@ -36,7 +36,7 @@
 /**
     \fn jsAudioMixer
 */
-int jsAudioMixer(const char *s)
+int scriptAudioMixer(const char *s)
 {
     CHANNEL_CONF c=AudioMuxerStringToId(s);
     return audioFilterSetMixer(c);
@@ -44,14 +44,14 @@
 /**
     \fn jsGetResample
 */
-int32_t jsGetResample(void)
+int32_t scriptGetResample(void)
 {
     return 0;
 }
 /**
     \fn jsSetResample
 */
-void    jsSetResample(int32_t fq)
+void    scriptSetResample(int32_t fq)
 {
 
 }

Modified: branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src/ADM_scriptAvidemux.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src/ADM_scriptAvidemux.cpp	2010-05-29 15:42:39 UTC (rev 6269)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src/ADM_scriptAvidemux.cpp	2010-05-29 15:42:41 UTC (rev 6270)
@@ -41,7 +41,7 @@
 /**
     \fn jsLoadFile
 */
-int jsLoadVideo(const char *s)
+int scriptLoadVideo(const char *s)
 {
 int ret=0;
         jsLog("[Js] Loading video %s",s);
@@ -56,7 +56,7 @@
 /**
     \fn jsAppendFile
 */
-int jsAppendVideo(const char *s)
+int scriptAppendVideo(const char *s)
 {
 int ret=0;
         
@@ -71,7 +71,7 @@
 /**
     \fn jsClearSegments
 */
-int jsClearSegments(void)
+int scriptClearSegments(void)
 {
     video_body->clearSegment();
     return 1;
@@ -80,7 +80,7 @@
     \fn jsAddSegment
 
 */
-int  jsAddSegment(int ref, double start, double duration)
+int  scriptAddSegment(int ref, double start, double duration)
 {
     if(true==video_body->addSegment(ref,(uint64_t)start,(uint64_t)duration)) 
     {

Modified: branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src/ADM_scriptAvidemuxInfo.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src/ADM_scriptAvidemuxInfo.cpp	2010-05-29 15:42:39 UTC (rev 6269)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src/ADM_scriptAvidemuxInfo.cpp	2010-05-29 15:42:41 UTC (rev 6270)
@@ -21,7 +21,7 @@
 /**
     \fn jsGetWidth
 */
-int jsGetWidth ( void)
+int scriptGetWidth ( void)
 {
 aviInfo info;
         video_body->getVideoInfo(&info);
@@ -30,7 +30,7 @@
 /**
     \fn jsGetHeight
 */
-int jsGetHeight ( void)
+int scriptGetHeight ( void)
 {
 aviInfo info;
         video_body->getVideoInfo(&info);
@@ -39,7 +39,7 @@
 /**
     \fn jsGetFps1000
 */
-int jsGetFps1000 ( void)
+int scriptGetFps1000 ( void)
 {
 aviInfo info;
         video_body->getVideoInfo(&info);
@@ -48,7 +48,7 @@
 /**
     \fn jsGetVideoCodec
 */
-char *jsGetVideoCodec ( void)
+char *scriptGetVideoCodec ( void)
 {
 uint32_t fcc;
 aviInfo info;

Modified: branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src/ADM_scriptVideo.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src/ADM_scriptVideo.cpp	2010-05-29 15:42:39 UTC (rev 6269)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src/ADM_scriptVideo.cpp	2010-05-29 15:42:41 UTC (rev 6270)
@@ -69,7 +69,7 @@
 /**
     \fn jsSetPostProc
 */
-int jsSetPostProc (int a,int b, int c)
+int scriptSetPostProc (int a,int b, int c)
 {
     return video_body->setPostProc(a,b,c);
 }
@@ -78,14 +78,14 @@
 /**
      \fn jsClearFilters
 */
-int jsClearVideoFilters()
+int scriptClearVideoFilters()
 {
     return ADM_vf_clearFilters();
 }
 /**
     \fn jsGetMarkerA
 */
-double jsGetMarkerA(void)
+double scriptGetMarkerA(void)
 {
     return (double)video_body->getMarkerAPts();
 
@@ -93,21 +93,21 @@
 /**
     \fn jsGetMarkerB
 */
-double jsGetMarkerB(void)
+double scriptGetMarkerB(void)
 {
     return (double)video_body->getMarkerBPts();
 }
 /**
     \fn jsSetMarkerA
 */
-void   jsSetMarkerA(double a)
+void   scriptSetMarkerA(double a)
 {
     video_body->setMarkerAPts( (uint64_t)a);
 }
 /**
     \fn jsGetMarkerB
 */
-void   jsSetMarkerB(double b)
+void   scriptSetMarkerB(double b)
 {
     video_body->setMarkerBPts( (uint64_t)b);
 }



From mean at mail.berlios.de  Sat May 29 17:42:43 2010
From: mean at mail.berlios.de (mean at BerliOS)
Date: Sat, 29 May 2010 17:42:43 +0200
Subject: [Avidemux-svn-commit] r6271 -
	branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavformat
Message-ID: <201005291542.o4TFghcF019528@sheep.berlios.de>

Author: mean
Date: 2010-05-29 17:42:43 +0200 (Sat, 29 May 2010)
New Revision: 6271

Modified:
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavformat/file.c
Log:
[libavformat] Remove open->ADM_open to see if that helps for writing on win32 (???)

Modified: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavformat/file.c
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavformat/file.c	2010-05-29 15:42:41 UTC (rev 6270)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavformat/file.c	2010-05-29 15:42:43 UTC (rev 6271)
@@ -94,7 +94,7 @@
 		return _open_osfhandle((intptr_t)hFile, oflag);
 }
 
-#define open ADM_open
+/* MEANX : ???? #define open ADM_open */
 #endif
 // GRUNTSTER end
 



From mean at mail.berlios.de  Sat May 29 18:10:29 2010
From: mean at mail.berlios.de (mean at BerliOS)
Date: Sat, 29 May 2010 18:10:29 +0200
Subject: [Avidemux-svn-commit] r6272 -
	branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavformat
Message-ID: <201005291610.o4TGAT4x021017@sheep.berlios.de>

Author: mean
Date: 2010-05-29 18:10:28 +0200 (Sat, 29 May 2010)
New Revision: 6272

Modified:
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavformat/file.c
Log:
[libavformat] revert previous change

Modified: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavformat/file.c
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavformat/file.c	2010-05-29 15:42:43 UTC (rev 6271)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavformat/file.c	2010-05-29 16:10:28 UTC (rev 6272)
@@ -94,7 +94,7 @@
 		return _open_osfhandle((intptr_t)hFile, oflag);
 }
 
-/* MEANX : ???? #define open ADM_open */
+#define open ADM_open
 #endif
 // GRUNTSTER end
 



From gruntster at mail.berlios.de  Mon May 31 20:54:54 2010
From: gruntster at mail.berlios.de (gruntster at mail.berlios.de)
Date: Mon, 31 May 2010 20:54:54 +0200
Subject: [Avidemux-svn-commit] r6273 -
	branches/avidemux_2.5_branch_gruntster/cmake
Message-ID: <201005311854.o4VIss9U008150@sheep.berlios.de>

Author: gruntster
Date: 2010-05-31 20:54:50 +0200 (Mon, 31 May 2010)
New Revision: 6273

Modified:
   branches/avidemux_2.5_branch_gruntster/cmake/Ts.cmake
Log:
[i18n] mark XSLT file as a CMake dependency so it triggers a recompile of TS files when it changes

Modified: branches/avidemux_2.5_branch_gruntster/cmake/Ts.cmake
===================================================================
--- branches/avidemux_2.5_branch_gruntster/cmake/Ts.cmake	2010-05-29 16:10:28 UTC (rev 6272)
+++ branches/avidemux_2.5_branch_gruntster/cmake/Ts.cmake	2010-05-31 18:54:50 UTC (rev 6273)
@@ -61,7 +61,7 @@
                 COMMAND ${XSLTPROC_EXECUTABLE}
                     ${ts_subdir}/qt_filter_context.xslt ${_in}
                     > ${_outXml}
-                DEPENDS ${_in}
+                DEPENDS ${_in} "${ts_subdir}/qt_filter_context.xslt"
             )
             
             ADD_CUSTOM_COMMAND(



From gruntster at mail.berlios.de  Mon May 31 21:09:35 2010
From: gruntster at mail.berlios.de (gruntster at mail.berlios.de)
Date: Mon, 31 May 2010 21:09:35 +0200
Subject: [Avidemux-svn-commit] r6274 -
	branches/avidemux_2.5_branch_gruntster/po
Message-ID: <201005311909.o4VJ9Z2O010136@sheep.berlios.de>

Author: gruntster
Date: 2010-05-31 21:09:19 +0200 (Mon, 31 May 2010)
New Revision: 6274

Added:
   branches/avidemux_2.5_branch_gruntster/po/qt_de.ts
Modified:
   branches/avidemux_2.5_branch_gruntster/po/avidemux_de.ts
Log:
[i18n] German translation update for Qt by Lance

Modified: branches/avidemux_2.5_branch_gruntster/po/avidemux_de.ts
===================================================================
--- branches/avidemux_2.5_branch_gruntster/po/avidemux_de.ts	2010-05-31 18:54:50 UTC (rev 6273)
+++ branches/avidemux_2.5_branch_gruntster/po/avidemux_de.ts	2010-05-31 19:09:19 UTC (rev 6274)
@@ -1,6 +1,6 @@
 <?xml version="1.0" encoding="utf-8"?>
 <!DOCTYPE TS>
-<TS version="2.0">
+<TS version="2.0" language="de_DE">
 <context>
     <name></name>
     <message>
@@ -6197,37 +6197,37 @@
     <message>
         <location filename="../avidemux/gtk_gui.cpp" line="2587"/>
         <source>Memory error</source>
-        <translation type="unfinished">Speicherfehler</translation>
+        <translation>Speicherfehler</translation>
     </message>
     <message>
         <location filename="../avidemux/gtk_gui.cpp" line="2594"/>
         <source>Error converting to BMP</source>
-        <translation type="unfinished">Fehler beim Konvertieren nach BMP</translation>
+        <translation>Fehler beim Konvertieren nach BMP</translation>
     </message>
     <message>
         <location filename="../avidemux/gtk_gui.cpp" line="2601"/>
         <source>Something bad happened</source>
-        <translation type="unfinished">Irgendwas Schlimmes ist passiert</translation>
+        <translation>Irgendwas Schlimmes ist passiert</translation>
     </message>
     <message>
         <location filename="../avidemux/gtk_gui.cpp" line="2691"/>
         <source>Cannot encode the frame</source>
-        <translation type="unfinished">Kann Bild nicht kodieren</translation>
+        <translation>Kann Bild nicht kodieren</translation>
     </message>
     <message>
         <location filename="../avidemux/gtk_gui.cpp" line="2698"/>
         <source>Cannot initialise JPEG encoder</source>
-        <translation type="unfinished"></translation>
+        <translation></translation>
     </message>
     <message>
         <location filename="../avidemux/gtk_gui.cpp" line="2688"/>
         <source>File error</source>
-        <translation type="unfinished">Dateifehler</translation>
+        <translation>Dateifehler</translation>
     </message>
     <message>
         <location filename="../avidemux/gtk_gui.cpp" line="2688"/>
         <source>Cannot open &quot;%s&quot; for writing.</source>
-        <translation type="unfinished">Kann &quot;%s&quot; nicht zum Schreiben ?ffnen.</translation>
+        <translation>Kann &quot;%s&quot; nicht zum Schreiben ?ffnen.</translation>
     </message>
 </context>
 <context>
@@ -6367,87 +6367,87 @@
     <message>
         <location filename="../avidemux/ADM_videoFilter/ADM_vidEraser.cpp" line="187"/>
         <source>Erase</source>
-        <translation type="unfinished">Radieren</translation>
+        <translation>Radieren</translation>
     </message>
     <message>
         <location filename="../avidemux/ADM_videoFilter/ADM_vidEraser.cpp" line="188"/>
         <source>Un-Erase</source>
-        <translation type="unfinished">Nicht-Radieren</translation>
+        <translation>Nicht-Radieren</translation>
     </message>
     <message>
         <location filename="../avidemux/ADM_videoFilter/ADM_vidEraser.cpp" line="192"/>
         <source>1x1</source>
-        <translation type="unfinished">1x1</translation>
+        <translation>1x1</translation>
     </message>
     <message>
         <location filename="../avidemux/ADM_videoFilter/ADM_vidEraser.cpp" line="193"/>
         <source>3x3</source>
-        <translation type="unfinished">3x3</translation>
+        <translation>3x3</translation>
     </message>
     <message>
         <location filename="../avidemux/ADM_videoFilter/ADM_vidEraser.cpp" line="194"/>
         <source>5x5</source>
-        <translation type="unfinished">5x5</translation>
+        <translation>5x5</translation>
     </message>
     <message>
         <location filename="../avidemux/ADM_videoFilter/ADM_vidEraser.cpp" line="195"/>
         <source>7x7</source>
-        <translation type="unfinished">7x7</translation>
+        <translation>7x7</translation>
     </message>
     <message>
         <location filename="../avidemux/ADM_videoFilter/ADM_vidEraser.cpp" line="196"/>
         <source>9x9</source>
-        <translation type="unfinished">9x9</translation>
+        <translation>9x9</translation>
     </message>
     <message>
         <location filename="../avidemux/ADM_videoFilter/ADM_vidEraser.cpp" line="197"/>
         <source>11x11</source>
-        <translation type="unfinished">11x11</translation>
+        <translation>11x11</translation>
     </message>
     <message>
         <location filename="../avidemux/ADM_videoFilter/ADM_vidEraser.cpp" line="198"/>
         <source>15x15</source>
-        <translation type="unfinished">15x15</translation>
+        <translation>15x15</translation>
     </message>
     <message>
         <location filename="../avidemux/ADM_videoFilter/ADM_vidEraser.cpp" line="199"/>
         <source>21x21</source>
-        <translation type="unfinished">21x21</translation>
+        <translation>21x21</translation>
     </message>
     <message>
         <location filename="../avidemux/ADM_videoFilter/ADM_vidEraser.cpp" line="203"/>
         <source>Brush _Mode:</source>
-        <translation type="unfinished">Pinsel _Modus:</translation>
+        <translation>Pinsel _Modus:</translation>
     </message>
     <message>
         <location filename="../avidemux/ADM_videoFilter/ADM_vidEraser.cpp" line="207"/>
         <source>Brush _Size:</source>
-        <translation type="unfinished">Pinsel _Gr??e:</translation>
+        <translation>Pinsel _Gr??e:</translation>
     </message>
     <message>
         <location filename="../avidemux/ADM_videoFilter/ADM_vidEraser.cpp" line="240"/>
         <source>Output &quot;_Color&quot; for all masked pixels:</source>
-        <translation type="unfinished">Augangs-&quot;_Farbe&quot; f?r alle maskierten Pixel:</translation>
+        <translation>Augangs-&quot;_Farbe&quot; f?r alle maskierten Pixel:</translation>
     </message>
     <message>
         <location filename="../avidemux/ADM_videoFilter/ADM_vidEraser.cpp" line="246"/>
         <source>Eraser _Data File:</source>
-        <translation type="unfinished">Radierer _Daten-Datei:</translation>
+        <translation>Radierer _Daten-Datei:</translation>
     </message>
     <message>
         <location filename="../avidemux/ADM_videoFilter/ADM_vidEraser.cpp" line="246"/>
         <source>Select data file</source>
-        <translation type="unfinished">Daten-Datei ausw?hlen</translation>
+        <translation>Daten-Datei ausw?hlen</translation>
     </message>
     <message>
         <location filename="../avidemux/ADM_videoFilter/ADM_vidEraser.cpp" line="251"/>
         <source>_Debugging settings (bits):</source>
-        <translation type="unfinished">_Fehlersuche Einstellungen (bits):</translation>
+        <translation>_Fehlersuche Einstellungen (bits):</translation>
     </message>
     <message>
         <location filename="../avidemux/ADM_videoFilter/ADM_vidEraser.cpp" line="257"/>
         <source>Eraser Configuration</source>
-        <translation type="unfinished">Radierer Konfiguration</translation>
+        <translation>Radierer Konfiguration</translation>
     </message>
 </context>
 <context>
@@ -7739,12 +7739,12 @@
     <message>
         <location filename="../avidemux/ADM_outputs/oplug_ogm/op_ogsavecopy.cpp" line="55"/>
         <source>Copy</source>
-        <translation type="unfinished">Kopie</translation>
+        <translation>Kopie</translation>
     </message>
     <message>
         <location filename="../avidemux/ADM_outputs/oplug_ogm/op_ogsavecopy.cpp" line="56"/>
         <source>Saving...</source>
-        <translation type="unfinished">Speichern...</translation>
+        <translation>Speichern...</translation>
     </message>
 </context>
 <context>
@@ -7985,7 +7985,7 @@
     <message>
         <location filename="../plugins/ADM_videoFilters/TemporalCleaner/ADM_vidVlad.cpp" line="91"/>
         <source>Ch_roma temporal threshold:</source>
-        <translation type="unfinished">Tempor?re Farb_intensit?ts-Schwelle</translation>
+        <translation type="unfinished">Schwellen-Konfiguration</translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoFilters/TemporalCleaner/ADM_vidVlad.cpp" line="95"/>
@@ -8056,12 +8056,12 @@
     <message>
         <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/calculator.ui" line="13"/>
         <source>Calculator</source>
-        <translation type="unfinished">Taschenrechner</translation>
+        <translation>Video-Kalkulator</translation>
     </message>
     <message>
         <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/calculator.ui" line="25"/>
         <source>Target</source>
-        <translation type="unfinished"></translation>
+        <translation>Format und Gr??e des Ausgabedatei</translation>
     </message>
     <message>
         <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/calculator.ui" line="53"/>
@@ -8096,27 +8096,27 @@
     <message>
         <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/calculator.ui" line="93"/>
         <source>Duration:</source>
-        <translation type="unfinished">Dauer:</translation>
+        <translation>Dauer:</translation>
     </message>
     <message>
         <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/calculator.ui" line="101"/>
         <source>1 x 80 minute CD</source>
-        <translation type="unfinished"></translation>
+        <translation>1 x 80 Min. CD</translation>
     </message>
     <message>
         <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/calculator.ui" line="106"/>
         <source>2 x 80 minute CD</source>
-        <translation type="unfinished"></translation>
+        <translation>2 x 80 Min. CD</translation>
     </message>
     <message>
         <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/calculator.ui" line="111"/>
         <source>1 x 74 minute CD</source>
-        <translation type="unfinished"></translation>
+        <translation>1 x 74 Min. CD</translation>
     </message>
     <message>
         <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/calculator.ui" line="116"/>
         <source>2 x 74 minute CD</source>
-        <translation type="unfinished"></translation>
+        <translation>2 x 74 Min. CD</translation>
     </message>
     <message>
         <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/calculator.ui" line="121"/>
@@ -8126,12 +8126,12 @@
     <message>
         <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/calculator.ui" line="126"/>
         <source>Custom</source>
-        <translation type="unfinished">Individuell</translation>
+        <translation>individuell</translation>
     </message>
     <message>
         <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/calculator.ui" line="184"/>
         <source>Custom Size:</source>
-        <translation type="unfinished"></translation>
+        <translation>Gr??e:</translation>
     </message>
     <message>
         <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/calculator.ui" line="207"/>
@@ -8149,7 +8149,7 @@
     <message>
         <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/calculator.ui" line="269"/>
         <source>Track 1:</source>
-        <translation type="unfinished"></translation>
+        <translation>Spur 1:</translation>
     </message>
     <message>
         <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/calculator.ui" line="283"/>
@@ -8161,22 +8161,22 @@
     <message>
         <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/calculator.ui" line="306"/>
         <source>Track 2:</source>
-        <translation type="unfinished"></translation>
+        <translation>Spur 2:</translation>
     </message>
     <message>
         <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/calculator.ui" line="345"/>
         <source>Result</source>
-        <translation type="unfinished"></translation>
+        <translation>Ergebnis</translation>
     </message>
     <message>
         <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/calculator.ui" line="373"/>
         <source>Audio Size:</source>
-        <translation type="unfinished"></translation>
+        <translation>Audio Gr??e:</translation>
     </message>
     <message>
         <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/calculator.ui" line="380"/>
         <source>Video Size:</source>
-        <translation type="unfinished"></translation>
+        <translation>Video Gr??e:</translation>
     </message>
     <message>
         <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/calculator.ui" line="395"/>
@@ -8190,12 +8190,12 @@
     <message>
         <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/calculator.ui" line="441"/>
         <source>Total Size:</source>
-        <translation type="unfinished"></translation>
+        <translation>Gesamtgr??e:</translation>
     </message>
     <message>
         <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/calculator.ui" line="561"/>
         <source>Bits Per Pixel:</source>
-        <translation type="unfinished"></translation>
+        <translation>Bits je Pixels:</translation>
     </message>
     <message>
         <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/calculator.ui" line="568"/>
@@ -8208,42 +8208,49 @@
     <message>
         <location filename="../plugins/ADM_videoFilters/CNR2/qt4/cnr2.ui" line="13"/>
         <location filename="../plugins/build/ADM_videoFilters/CNR2/ui_cnr2.h" line="333"/>
+        <location filename="../plugins/build64/ADM_videoFilters/CNR2/ui_cnr2.h" line="333"/>
         <source>Chroma Noise Reducer 2</source>
         <translation type="unfinished"></translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoFilters/CNR2/qt4/cnr2.ui" line="25"/>
         <location filename="../plugins/build/ADM_videoFilters/CNR2/ui_cnr2.h" line="334"/>
+        <location filename="../plugins/build64/ADM_videoFilters/CNR2/ui_cnr2.h" line="334"/>
         <source>Scene Change</source>
         <translation type="unfinished"></translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoFilters/CNR2/qt4/cnr2.ui" line="61"/>
         <location filename="../plugins/build/ADM_videoFilters/CNR2/ui_cnr2.h" line="335"/>
+        <location filename="../plugins/build64/ADM_videoFilters/CNR2/ui_cnr2.h" line="335"/>
         <source>0%</source>
         <translation type="unfinished">0%</translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoFilters/CNR2/qt4/cnr2.ui" line="81"/>
         <location filename="../plugins/build/ADM_videoFilters/CNR2/ui_cnr2.h" line="336"/>
+        <location filename="../plugins/build64/ADM_videoFilters/CNR2/ui_cnr2.h" line="336"/>
         <source>Scene Change Threshold</source>
         <translation type="unfinished"></translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoFilters/CNR2/qt4/cnr2.ui" line="101"/>
         <location filename="../plugins/build/ADM_videoFilters/CNR2/ui_cnr2.h" line="337"/>
+        <location filename="../plugins/build64/ADM_videoFilters/CNR2/ui_cnr2.h" line="337"/>
         <source>100%</source>
         <translation type="unfinished">100%</translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoFilters/CNR2/qt4/cnr2.ui" line="140"/>
         <location filename="../plugins/build/ADM_videoFilters/CNR2/ui_cnr2.h" line="338"/>
+        <location filename="../plugins/build64/ADM_videoFilters/CNR2/ui_cnr2.h" line="338"/>
         <source>Use chroma to also detect scene change</source>
         <translation type="unfinished"></translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoFilters/CNR2/qt4/cnr2.ui" line="150"/>
         <location filename="../plugins/build/ADM_videoFilters/CNR2/ui_cnr2.h" line="339"/>
+        <location filename="../plugins/build64/ADM_videoFilters/CNR2/ui_cnr2.h" line="339"/>
         <source>Settings</source>
         <translation type="unfinished"></translation>
     </message>
@@ -8254,6 +8261,9 @@
         <location filename="../plugins/build/ADM_videoFilters/CNR2/ui_cnr2.h" line="342"/>
         <location filename="../plugins/build/ADM_videoFilters/CNR2/ui_cnr2.h" line="350"/>
         <location filename="../plugins/build/ADM_videoFilters/CNR2/ui_cnr2.h" line="357"/>
+        <location filename="../plugins/build64/ADM_videoFilters/CNR2/ui_cnr2.h" line="342"/>
+        <location filename="../plugins/build64/ADM_videoFilters/CNR2/ui_cnr2.h" line="350"/>
+        <location filename="../plugins/build64/ADM_videoFilters/CNR2/ui_cnr2.h" line="357"/>
         <source>Wide</source>
         <translation type="unfinished"></translation>
     </message>
@@ -8264,42 +8274,51 @@
         <location filename="../plugins/build/ADM_videoFilters/CNR2/ui_cnr2.h" line="343"/>
         <location filename="../plugins/build/ADM_videoFilters/CNR2/ui_cnr2.h" line="351"/>
         <location filename="../plugins/build/ADM_videoFilters/CNR2/ui_cnr2.h" line="358"/>
+        <location filename="../plugins/build64/ADM_videoFilters/CNR2/ui_cnr2.h" line="343"/>
+        <location filename="../plugins/build64/ADM_videoFilters/CNR2/ui_cnr2.h" line="351"/>
+        <location filename="../plugins/build64/ADM_videoFilters/CNR2/ui_cnr2.h" line="358"/>
         <source>Narrow</source>
         <translation type="unfinished">N?he</translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoFilters/CNR2/qt4/cnr2.ui" line="197"/>
         <location filename="../plugins/build/ADM_videoFilters/CNR2/ui_cnr2.h" line="345"/>
+        <location filename="../plugins/build64/ADM_videoFilters/CNR2/ui_cnr2.h" line="345"/>
         <source>Mode</source>
         <translation type="unfinished"></translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoFilters/CNR2/qt4/cnr2.ui" line="211"/>
         <location filename="../plugins/build/ADM_videoFilters/CNR2/ui_cnr2.h" line="346"/>
+        <location filename="../plugins/build64/ADM_videoFilters/CNR2/ui_cnr2.h" line="346"/>
         <source>Luma Y:</source>
         <translation type="unfinished"></translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoFilters/CNR2/qt4/cnr2.ui" line="231"/>
         <location filename="../plugins/build/ADM_videoFilters/CNR2/ui_cnr2.h" line="347"/>
+        <location filename="../plugins/build64/ADM_videoFilters/CNR2/ui_cnr2.h" line="347"/>
         <source>Chroma V:</source>
         <translation type="unfinished"></translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoFilters/CNR2/qt4/cnr2.ui" line="285"/>
         <location filename="../plugins/build/ADM_videoFilters/CNR2/ui_cnr2.h" line="353"/>
+        <location filename="../plugins/build64/ADM_videoFilters/CNR2/ui_cnr2.h" line="353"/>
         <source>Maximum</source>
         <translation type="unfinished"></translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoFilters/CNR2/qt4/cnr2.ui" line="292"/>
         <location filename="../plugins/build/ADM_videoFilters/CNR2/ui_cnr2.h" line="354"/>
+        <location filename="../plugins/build64/ADM_videoFilters/CNR2/ui_cnr2.h" line="354"/>
         <source>Chroma U:</source>
         <translation type="unfinished"></translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoFilters/CNR2/qt4/cnr2.ui" line="334"/>
         <location filename="../plugins/build/ADM_videoFilters/CNR2/ui_cnr2.h" line="360"/>
+        <location filename="../plugins/build64/ADM_videoFilters/CNR2/ui_cnr2.h" line="360"/>
         <source>Sensibility</source>
         <translation type="unfinished">Empfindlichkeit</translation>
     </message>
@@ -8309,72 +8328,84 @@
     <message>
         <location filename="../plugins/ADM_videoFilters/colorYUV/qt4/coloryuv.ui" line="13"/>
         <location filename="../plugins/build/ADM_videoFilters/colorYUV/ui_coloryuv.h" line="377"/>
+        <location filename="../plugins/build64/ADM_videoFilters/colorYUV/ui_coloryuv.h" line="377"/>
         <source>Avisynth ColorYUV</source>
         <translation type="unfinished">Avisynth ColorYUV</translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoFilters/colorYUV/qt4/coloryuv.ui" line="25"/>
         <location filename="../plugins/build/ADM_videoFilters/colorYUV/ui_coloryuv.h" line="378"/>
+        <location filename="../plugins/build64/ADM_videoFilters/colorYUV/ui_coloryuv.h" line="378"/>
         <source>Colour Correction Matrix</source>
         <translation type="unfinished"></translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoFilters/colorYUV/qt4/coloryuv.ui" line="55"/>
         <location filename="../plugins/build/ADM_videoFilters/colorYUV/ui_coloryuv.h" line="379"/>
+        <location filename="../plugins/build64/ADM_videoFilters/colorYUV/ui_coloryuv.h" line="379"/>
         <source>Contrast</source>
         <translation type="unfinished">Kontrast</translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoFilters/colorYUV/qt4/coloryuv.ui" line="92"/>
         <location filename="../plugins/build/ADM_videoFilters/colorYUV/ui_coloryuv.h" line="380"/>
+        <location filename="../plugins/build64/ADM_videoFilters/colorYUV/ui_coloryuv.h" line="380"/>
         <source>Chroma U:</source>
         <translation type="unfinished"></translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoFilters/colorYUV/qt4/coloryuv.ui" line="119"/>
         <location filename="../plugins/build/ADM_videoFilters/colorYUV/ui_coloryuv.h" line="381"/>
+        <location filename="../plugins/build64/ADM_videoFilters/colorYUV/ui_coloryuv.h" line="381"/>
         <source>Chroma V:</source>
         <translation type="unfinished"></translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoFilters/colorYUV/qt4/coloryuv.ui" line="176"/>
         <location filename="../plugins/build/ADM_videoFilters/colorYUV/ui_coloryuv.h" line="382"/>
+        <location filename="../plugins/build64/ADM_videoFilters/colorYUV/ui_coloryuv.h" line="382"/>
         <source>Luma Y:</source>
         <translation type="unfinished"></translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoFilters/colorYUV/qt4/coloryuv.ui" line="183"/>
         <location filename="../plugins/build/ADM_videoFilters/colorYUV/ui_coloryuv.h" line="383"/>
+        <location filename="../plugins/build64/ADM_videoFilters/colorYUV/ui_coloryuv.h" line="383"/>
         <source>Brightness</source>
         <translation type="unfinished">Helligkeit</translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoFilters/colorYUV/qt4/coloryuv.ui" line="200"/>
         <location filename="../plugins/build/ADM_videoFilters/colorYUV/ui_coloryuv.h" line="384"/>
+        <location filename="../plugins/build64/ADM_videoFilters/colorYUV/ui_coloryuv.h" line="384"/>
         <source>Gain</source>
         <translation type="unfinished">Verst?rkung</translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoFilters/colorYUV/qt4/coloryuv.ui" line="207"/>
         <location filename="../plugins/build/ADM_videoFilters/colorYUV/ui_coloryuv.h" line="385"/>
+        <location filename="../plugins/build64/ADM_videoFilters/colorYUV/ui_coloryuv.h" line="385"/>
         <source>Gamma</source>
         <translation type="unfinished">Gamma</translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoFilters/colorYUV/qt4/coloryuv.ui" line="268"/>
         <location filename="../plugins/build/ADM_videoFilters/colorYUV/ui_coloryuv.h" line="386"/>
+        <location filename="../plugins/build64/ADM_videoFilters/colorYUV/ui_coloryuv.h" line="386"/>
         <source>Note: all values are normalised to 256</source>
         <translation type="unfinished"></translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoFilters/colorYUV/qt4/coloryuv.ui" line="278"/>
         <location filename="../plugins/build/ADM_videoFilters/colorYUV/ui_coloryuv.h" line="387"/>
+        <location filename="../plugins/build64/ADM_videoFilters/colorYUV/ui_coloryuv.h" line="387"/>
         <source>Parameters</source>
         <translation type="unfinished"></translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoFilters/colorYUV/qt4/coloryuv.ui" line="298"/>
         <location filename="../plugins/build/ADM_videoFilters/colorYUV/ui_coloryuv.h" line="388"/>
+        <location filename="../plugins/build64/ADM_videoFilters/colorYUV/ui_coloryuv.h" line="388"/>
         <source>Matrix:</source>
         <translation type="unfinished"></translation>
     </message>
@@ -8385,66 +8416,79 @@
         <location filename="../plugins/build/ADM_videoFilters/colorYUV/ui_coloryuv.h" line="391"/>
         <location filename="../plugins/build/ADM_videoFilters/colorYUV/ui_coloryuv.h" line="399"/>
         <location filename="../plugins/build/ADM_videoFilters/colorYUV/ui_coloryuv.h" line="404"/>
+        <location filename="../plugins/build64/ADM_videoFilters/colorYUV/ui_coloryuv.h" line="391"/>
+        <location filename="../plugins/build64/ADM_videoFilters/colorYUV/ui_coloryuv.h" line="399"/>
+        <location filename="../plugins/build64/ADM_videoFilters/colorYUV/ui_coloryuv.h" line="404"/>
         <source>None</source>
         <translation type="unfinished">Keine</translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoFilters/colorYUV/qt4/coloryuv.ui" line="311"/>
         <location filename="../plugins/build/ADM_videoFilters/colorYUV/ui_coloryuv.h" line="392"/>
+        <location filename="../plugins/build64/ADM_videoFilters/colorYUV/ui_coloryuv.h" line="392"/>
         <source>TV -&gt; PC</source>
         <translation type="unfinished"></translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoFilters/colorYUV/qt4/coloryuv.ui" line="316"/>
         <location filename="../plugins/build/ADM_videoFilters/colorYUV/ui_coloryuv.h" line="393"/>
+        <location filename="../plugins/build64/ADM_videoFilters/colorYUV/ui_coloryuv.h" line="393"/>
         <source>PC -&gt; TV</source>
         <translation type="unfinished"></translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoFilters/colorYUV/qt4/coloryuv.ui" line="321"/>
         <location filename="../plugins/build/ADM_videoFilters/colorYUV/ui_coloryuv.h" line="394"/>
+        <location filename="../plugins/build64/ADM_videoFilters/colorYUV/ui_coloryuv.h" line="394"/>
         <source>PC -&gt; TV.Y</source>
         <translation type="unfinished"></translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoFilters/colorYUV/qt4/coloryuv.ui" line="329"/>
         <location filename="../plugins/build/ADM_videoFilters/colorYUV/ui_coloryuv.h" line="396"/>
+        <location filename="../plugins/build64/ADM_videoFilters/colorYUV/ui_coloryuv.h" line="396"/>
         <source>Level:</source>
         <translation type="unfinished"></translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoFilters/colorYUV/qt4/coloryuv.ui" line="342"/>
         <location filename="../plugins/build/ADM_videoFilters/colorYUV/ui_coloryuv.h" line="400"/>
+        <location filename="../plugins/build64/ADM_videoFilters/colorYUV/ui_coloryuv.h" line="400"/>
         <source>Rec.709</source>
         <translation type="unfinished">Rec.709</translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoFilters/colorYUV/qt4/coloryuv.ui" line="356"/>
         <location filename="../plugins/build/ADM_videoFilters/colorYUV/ui_coloryuv.h" line="405"/>
+        <location filename="../plugins/build64/ADM_videoFilters/colorYUV/ui_coloryuv.h" line="405"/>
         <source>Coring</source>
         <translation type="unfinished">Kern</translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoFilters/colorYUV/qt4/coloryuv.ui" line="364"/>
         <location filename="../plugins/build/ADM_videoFilters/colorYUV/ui_coloryuv.h" line="407"/>
+        <location filename="../plugins/build64/ADM_videoFilters/colorYUV/ui_coloryuv.h" line="407"/>
         <source>Opt:</source>
         <translation type="unfinished"></translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoFilters/colorYUV/qt4/coloryuv.ui" line="412"/>
         <location filename="../plugins/build/ADM_videoFilters/colorYUV/ui_coloryuv.h" line="408"/>
+        <location filename="../plugins/build64/ADM_videoFilters/colorYUV/ui_coloryuv.h" line="408"/>
         <source>Auto Gain</source>
         <translation type="unfinished"></translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoFilters/colorYUV/qt4/coloryuv.ui" line="419"/>
         <location filename="../plugins/build/ADM_videoFilters/colorYUV/ui_coloryuv.h" line="409"/>
+        <location filename="../plugins/build64/ADM_videoFilters/colorYUV/ui_coloryuv.h" line="409"/>
         <source>Display Colour Statistics</source>
         <translation type="unfinished"></translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoFilters/colorYUV/qt4/coloryuv.ui" line="426"/>
         <location filename="../plugins/build/ADM_videoFilters/colorYUV/ui_coloryuv.h" line="410"/>
+        <location filename="../plugins/build64/ADM_videoFilters/colorYUV/ui_coloryuv.h" line="410"/>
         <source>Centre Colour Offsets</source>
         <translation type="unfinished"></translation>
     </message>
@@ -8454,48 +8498,56 @@
     <message>
         <location filename="../plugins/ADM_videoFilters/CurveEditor/qt4/CurveDialog.ui" line="19"/>
         <location filename="../plugins/build/ADM_videoFilters/CurveEditor/ui_CurveDialog.h" line="107"/>
+        <location filename="../plugins/build64/ADM_videoFilters/CurveEditor/ui_CurveDialog.h" line="107"/>
         <source>Curve Editor</source>
         <translation type="unfinished"></translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoFilters/CurveEditor/qt4/CurveDialog.ui" line="27"/>
         <location filename="../plugins/build/ADM_videoFilters/CurveEditor/ui_CurveDialog.h" line="115"/>
+        <location filename="../plugins/build64/ADM_videoFilters/CurveEditor/ui_CurveDialog.h" line="115"/>
         <source>Choose channel for editing</source>
         <translation type="unfinished"></translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoFilters/CurveEditor/qt4/CurveDialog.ui" line="37"/>
         <location filename="../plugins/build/ADM_videoFilters/CurveEditor/ui_CurveDialog.h" line="110"/>
+        <location filename="../plugins/build64/ADM_videoFilters/CurveEditor/ui_CurveDialog.h" line="110"/>
         <source>Luma (Y)</source>
         <translation type="unfinished"></translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoFilters/CurveEditor/qt4/CurveDialog.ui" line="42"/>
         <location filename="../plugins/build/ADM_videoFilters/CurveEditor/ui_CurveDialog.h" line="111"/>
+        <location filename="../plugins/build64/ADM_videoFilters/CurveEditor/ui_CurveDialog.h" line="111"/>
         <source>Chroma (U)</source>
         <translation type="unfinished"></translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoFilters/CurveEditor/qt4/CurveDialog.ui" line="47"/>
         <location filename="../plugins/build/ADM_videoFilters/CurveEditor/ui_CurveDialog.h" line="112"/>
+        <location filename="../plugins/build64/ADM_videoFilters/CurveEditor/ui_CurveDialog.h" line="112"/>
         <source>Chroma (V)</source>
         <translation type="unfinished"></translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoFilters/CurveEditor/qt4/CurveDialog.ui" line="61"/>
         <location filename="../plugins/build/ADM_videoFilters/CurveEditor/ui_CurveDialog.h" line="118"/>
+        <location filename="../plugins/build64/ADM_videoFilters/CurveEditor/ui_CurveDialog.h" line="118"/>
         <source>Sets default curve</source>
         <translation type="unfinished"></translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoFilters/CurveEditor/qt4/CurveDialog.ui" line="64"/>
         <location filename="../plugins/build/ADM_videoFilters/CurveEditor/ui_CurveDialog.h" line="120"/>
+        <location filename="../plugins/build64/ADM_videoFilters/CurveEditor/ui_CurveDialog.h" line="120"/>
         <source>Refresh</source>
         <translation type="unfinished"></translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoFilters/CurveEditor/qt4/CurveDialog.ui" line="93"/>
         <location filename="../plugins/build/ADM_videoFilters/CurveEditor/ui_CurveDialog.h" line="121"/>
+        <location filename="../plugins/build64/ADM_videoFilters/CurveEditor/ui_CurveDialog.h" line="121"/>
         <source>Help</source>
         <translation type="unfinished"></translation>
     </message>
@@ -9031,7 +9083,7 @@
     <message>
         <location filename="../avidemux/ADM_encoder/adm_encCopy.cpp" line="85"/>
         <source>Copy</source>
-        <translation type="unfinished">Kopie</translation>
+        <translation>Kopie</translation>
     </message>
 </context>
 <context>
@@ -9078,7 +9130,7 @@
     <message>
         <location filename="../avidemux/ADM_encoder/adm_encRequant.cpp" line="93"/>
         <source>Requant</source>
-        <translation type="unfinished">Requantisieren</translation>
+        <translation>Requantisieren</translation>
     </message>
 </context>
 <context>
@@ -9107,7 +9159,7 @@
     <message>
         <location filename="../avidemux/ADM_encoder/adm_encyv12.h" line="70"/>
         <source>YV12</source>
-        <translation type="unfinished">YV12</translation>
+        <translation>YV12</translation>
     </message>
 </context>
 <context>
@@ -9115,18 +9167,21 @@
     <message>
         <location filename="../plugins/ADM_videoFilters/Equalizer/qt4/equaliser.ui" line="21"/>
         <location filename="../plugins/build/ADM_videoFilters/Equalizer/ui_equaliser.h" line="348"/>
+        <location filename="../plugins/build64/ADM_videoFilters/Equalizer/ui_equaliser.h" line="348"/>
         <source>Equaliser</source>
         <translation type="unfinished"></translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoFilters/Equalizer/qt4/equaliser.ui" line="41"/>
         <location filename="../plugins/build/ADM_videoFilters/Equalizer/ui_equaliser.h" line="349"/>
+        <location filename="../plugins/build64/ADM_videoFilters/Equalizer/ui_equaliser.h" line="349"/>
         <source>Settings</source>
         <translation type="unfinished"></translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoFilters/Equalizer/qt4/equaliser.ui" line="255"/>
         <location filename="../plugins/build/ADM_videoFilters/Equalizer/ui_equaliser.h" line="350"/>
+        <location filename="../plugins/build64/ADM_videoFilters/Equalizer/ui_equaliser.h" line="350"/>
         <source>Histogram</source>
         <translation type="unfinished"></translation>
     </message>
@@ -9159,23 +9214,23 @@
     <message>
         <location filename="../avidemux/ADM_outputs/oplug_avi/op_avisave.cpp" line="178"/>
         <source>Error initalizing audio filters</source>
-        <translation type="unfinished">Fehler beim Initialisieren der Audiofilter</translation>
+        <translation>Fehler beim Initialisieren der Audiofilter</translation>
     </message>
     <message>
         <location filename="../avidemux/ADM_outputs/oplug_avi/op_avisave.cpp" line="187"/>
         <source>Error initalizing video filters</source>
-        <translation type="unfinished">Fehler beim Initialisieren der Videofilter</translation>
+        <translation>Fehler beim Initialisieren der Videofilter</translation>
     </message>
     <message>
         <location filename="../avidemux/ADM_outputs/oplug_avi/op_avisave.cpp" line="256"/>
         <source>None</source>
-        <translation type="unfinished">Keine</translation>
+        <translation>Keine</translation>
     </message>
     <message>
         <location filename="../avidemux/ADM_outputs/oplug_avi/op_avisave.cpp" line="271"/>
         <location filename="../avidemux/ADM_outputs/oplug_avi/op_avisave.cpp" line="367"/>
         <source>Copy</source>
-        <translation type="unfinished">Kopie</translation>
+        <translation>Kopie</translation>
     </message>
     <message>
         <location filename="../avidemux/ADM_outputs/oplug_avi/op_avisave.cpp" line="369"/>
@@ -9193,12 +9248,12 @@
     <message>
         <location filename="../avidemux/ADM_outputs/oplug_avi/op_avisavecopy.cpp" line="89"/>
         <source>Cannot initiate save</source>
-        <translation type="unfinished">Kann das Speichern nicht beginnen</translation>
+        <translation>Kann das Speichern nicht beginnen</translation>
     </message>
     <message>
         <location filename="../avidemux/ADM_outputs/oplug_avi/op_avisavecopy.cpp" line="102"/>
         <source>Saving</source>
-        <translation type="unfinished">Speichern</translation>
+        <translation>Speichern</translation>
     </message>
 </context>
 <context>
@@ -9206,12 +9261,12 @@
     <message>
         <location filename="../avidemux/ADM_outputs/oplug_avi/op_avisavecopy_pack.cpp" line="127"/>
         <source>Cannot initiate save</source>
-        <translation type="unfinished">Kann das Speichern nicht beginnen</translation>
+        <translation>Kann das Speichern nicht beginnen</translation>
     </message>
     <message>
         <location filename="../avidemux/ADM_outputs/oplug_avi/op_avisavecopy_pack.cpp" line="140"/>
         <source>Saving</source>
-        <translation type="unfinished">Speichern</translation>
+        <translation>Speichern</translation>
     </message>
 </context>
 <context>
@@ -9219,12 +9274,12 @@
     <message>
         <location filename="../avidemux/ADM_outputs/oplug_avi/op_avisavecopy_unpack.cpp" line="91"/>
         <source>Cannot initiate save</source>
-        <translation type="unfinished">Kann das Speichern nicht beginnen</translation>
+        <translation>Kann das Speichern nicht beginnen</translation>
     </message>
     <message>
         <location filename="../avidemux/ADM_outputs/oplug_avi/op_avisavecopy_unpack.cpp" line="104"/>
         <source>Saving</source>
-        <translation type="unfinished">Speichern</translation>
+        <translation>Speichern</translation>
     </message>
 </context>
 <context>
@@ -9233,18 +9288,18 @@
         <location filename="../avidemux/ADM_outputs/oplug_avi/op_saveprocess.cpp" line="66"/>
         <source>Width is not a multiple of 8
  continue anyway ?</source>
-        <translation type="unfinished">Breite ist nicht ein Vielfaches von 8
+        <translation>Breite ist kein Vielfaches von 8
  irgendwie fortfahren ?</translation>
     </message>
     <message>
         <location filename="../avidemux/ADM_outputs/oplug_avi/op_saveprocess.cpp" line="91"/>
         <source>Reuse the existing log file?</source>
-        <translation type="unfinished"></translation>
+        <translation>Die bereits existierende Logdatei wiederverwenden?</translation>
     </message>
     <message>
         <location filename="../avidemux/ADM_outputs/oplug_avi/op_saveprocess.cpp" line="100"/>
         <source>Filter init failed</source>
-        <translation type="unfinished">Filterinitialisierung misslungen</translation>
+        <translation>Filterinitialisierung misslungen</translation>
     </message>
     <message>
         <source>
@@ -9255,22 +9310,22 @@
     <message>
         <location filename="../avidemux/ADM_outputs/oplug_avi/op_saveprocess.cpp" line="131"/>
         <source>1st Pass</source>
-        <translation type="unfinished">1. Durchlauf</translation>
+        <translation>1. Durchlauf</translation>
     </message>
     <message>
         <location filename="../avidemux/ADM_outputs/oplug_avi/op_saveprocess.cpp" line="146"/>
         <source>Aborting</source>
-        <translation type="unfinished">Abbruch</translation>
+        <translation>Abbruch</translation>
     </message>
     <message>
         <location filename="../avidemux/ADM_outputs/oplug_avi/op_saveprocess.cpp" line="261"/>
         <source>Encoding</source>
-        <translation type="unfinished">Kodieren</translation>
+        <translation>Kodieren</translation>
     </message>
     <message>
         <location filename="../avidemux/ADM_outputs/oplug_avi/op_saveprocess.cpp" line="263"/>
         <source>2nd Pass</source>
-        <translation type="unfinished">2. Durchlauf</translation>
+        <translation>2. Durchlauf</translation>
     </message>
 </context>
 <context>
@@ -9278,7 +9333,7 @@
     <message>
         <location filename="../avidemux/ADM_outputs/oplug_avi/op_savesmart.cpp" line="91"/>
         <source>Smart Copy</source>
-        <translation type="unfinished">Sanftes Kopieren</translation>
+        <translation>Sanftes Kopieren</translation>
     </message>
 </context>
 <context>
@@ -9532,36 +9587,42 @@
     <message>
         <location filename="../plugins/ADM_videoFilters/MPDelogo/qt4/mpdelogo.ui" line="13"/>
         <location filename="../plugins/build/ADM_videoFilters/MPDelogo/ui_mpdelogo.h" line="188"/>
+        <location filename="../plugins/build64/ADM_videoFilters/MPDelogo/ui_mpdelogo.h" line="188"/>
         <source>MPlayer Delogo</source>
         <translation type="unfinished"></translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoFilters/MPDelogo/qt4/mpdelogo.ui" line="40"/>
         <location filename="../plugins/build/ADM_videoFilters/MPDelogo/ui_mpdelogo.h" line="189"/>
+        <location filename="../plugins/build64/ADM_videoFilters/MPDelogo/ui_mpdelogo.h" line="189"/>
         <source>Band:</source>
         <translation type="unfinished"></translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoFilters/MPDelogo/qt4/mpdelogo.ui" line="47"/>
         <location filename="../plugins/build/ADM_videoFilters/MPDelogo/ui_mpdelogo.h" line="190"/>
+        <location filename="../plugins/build64/ADM_videoFilters/MPDelogo/ui_mpdelogo.h" line="190"/>
         <source>Height:</source>
         <translation type="unfinished"></translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoFilters/MPDelogo/qt4/mpdelogo.ui" line="54"/>
         <location filename="../plugins/build/ADM_videoFilters/MPDelogo/ui_mpdelogo.h" line="191"/>
+        <location filename="../plugins/build64/ADM_videoFilters/MPDelogo/ui_mpdelogo.h" line="191"/>
         <source>Width:</source>
         <translation type="unfinished"></translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoFilters/MPDelogo/qt4/mpdelogo.ui" line="114"/>
         <location filename="../plugins/build/ADM_videoFilters/MPDelogo/ui_mpdelogo.h" line="192"/>
+        <location filename="../plugins/build64/ADM_videoFilters/MPDelogo/ui_mpdelogo.h" line="192"/>
         <source>Y:</source>
         <translation type="unfinished"></translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoFilters/MPDelogo/qt4/mpdelogo.ui" line="144"/>
         <location filename="../plugins/build/ADM_videoFilters/MPDelogo/ui_mpdelogo.h" line="193"/>
+        <location filename="../plugins/build64/ADM_videoFilters/MPDelogo/ui_mpdelogo.h" line="193"/>
         <source>X:</source>
         <translation type="unfinished"></translation>
     </message>
@@ -9582,14 +9643,14 @@
         <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="167"/>
         <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="295"/>
         <source>Copy</source>
-        <translation type="unfinished">Kopie</translation>
+        <translation>Kopie</translation>
     </message>
     <message>
         <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="175"/>
         <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="303"/>
         <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="481"/>
         <source>Configure</source>
-        <translation type="unfinished">Konfigurieren</translation>
+        <translation>Konfigurieren</translation>
     </message>
     <message>
         <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="182"/>
@@ -9597,7 +9658,7 @@
         <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1779"/>
         <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1782"/>
         <source>Filters</source>
-        <translation type="unfinished">Filter</translation>
+        <translation>Videofilter</translation>
     </message>
     <message>
         <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="215"/>
@@ -9607,7 +9668,7 @@
     <message>
         <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="334"/>
         <source>&amp;Shift:</source>
-        <translation type="unfinished"></translation>
+        <translation>&amp;schieben:</translation>
     </message>
     <message>
         <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="398"/>
@@ -9633,7 +9694,7 @@
     <message>
         <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="921"/>
         <source>Frame:</source>
-        <translation type="unfinished"></translation>
+        <translation>Bild:</translation>
     </message>
     <message>
         <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="946"/>
@@ -9648,7 +9709,7 @@
     <message>
         <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1003"/>
         <source>Time:</source>
-        <translation type="unfinished"></translation>
+        <translation>Zeit:</translation>
     </message>
     <message>
         <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1022"/>
@@ -9663,7 +9724,7 @@
     <message>
         <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1067"/>
         <source>Frame Type:</source>
-        <translation type="unfinished"></translation>
+        <translation>Bild Type:</translation>
     </message>
     <message>
         <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1080"/>
@@ -9673,7 +9734,7 @@
     <message>
         <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1134"/>
         <source>Selection</source>
-        <translation type="unfinished"></translation>
+        <translation>Auswahlbereich</translation>
     </message>
     <message>
         <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1150"/>
@@ -9684,7 +9745,7 @@
     <message>
         <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1398"/>
         <source>&amp;Help</source>
-        <translation type="unfinished"></translation>
+        <translation>&amp;Hilfe</translation>
     </message>
     <message>
         <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1260"/>
@@ -9699,119 +9760,119 @@
     <message>
         <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1341"/>
         <source>&amp;File</source>
-        <translation type="unfinished"></translation>
+        <translation>&amp;Datei</translation>
     </message>
     <message>
         <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1345"/>
         <source>&amp;Recent Files</source>
-        <translation type="unfinished"></translation>
+        <translation>&amp;k?rzlich verwendete Dateien</translation>
     </message>
     <message>
         <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1356"/>
         <source>&amp;Save</source>
-        <translation type="unfinished"></translation>
+        <translation>&amp;Speichern</translation>
     </message>
     <message>
         <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1412"/>
         <source>&amp;Tools</source>
-        <translation type="unfinished"></translation>
+        <translation>&amp;Werkzeuge</translation>
     </message>
     <message>
         <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1281"/>
         <source>&amp;Edit</source>
-        <translation type="unfinished"></translation>
+        <translation>&amp;Bearbeiten</translation>
     </message>
     <message>
         <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1295"/>
         <source>&amp;View</source>
-        <translation type="unfinished"></translation>
+        <translation>&amp;Ansicht</translation>
     </message>
     <message>
         <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1299"/>
         <source>&amp;Preview Mode</source>
-        <translation type="unfinished"></translation>
+        <translation>&amp;Vorschau-Modus</translation>
     </message>
     <message>
         <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1316"/>
         <source>&amp;Custom</source>
-        <translation type="unfinished"></translation>
+        <translation>&amp;Gehe zu</translation>
     </message>
     <message>
         <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1321"/>
         <source>&amp;Go</source>
-        <translation type="unfinished"></translation>
+        <translation>&amp;Gehe zu</translation>
     </message>
     <message>
         <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1407"/>
         <source>A&amp;uto</source>
-        <translation type="unfinished"></translation>
+        <translation>&amp;Vorlagen</translation>
     </message>
     <message>
         <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1480"/>
         <source>&amp;Open...</source>
-        <translation type="unfinished"></translation>
+        <translation>&amp;?ffnen...</translation>
     </message>
     <message>
         <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1483"/>
         <source>Ctrl+O</source>
-        <translation type="unfinished"></translation>
+        <translation>Strg+O</translation>
     </message>
     <message>
         <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1488"/>
         <source>&amp;Append...</source>
-        <translation type="unfinished"></translation>
+        <translation>&amp;Hinzuf?gen...</translation>
     </message>
     <message>
         <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1491"/>
         <source>Ctrl+Alt+A</source>
-        <translation type="unfinished"></translation>
+        <translation>Strg+Alt+A</translation>
     </message>
     <message>
         <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1501"/>
         <source>Cu&amp;t</source>
-        <translation type="unfinished"></translation>
+        <translation>&amp;Ausschneiden</translation>
     </message>
     <message>
         <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1504"/>
         <source>Ctrl+X</source>
-        <translation type="unfinished"></translation>
+        <translation>Strg+X</translation>
     </message>
     <message>
         <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1509"/>
         <source>&amp;Copy</source>
-        <translation type="unfinished"></translation>
+        <translation>&amp;Kopieren</translation>
     </message>
     <message>
         <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1512"/>
         <source>Ctrl+C</source>
-        <translation type="unfinished"></translation>
+        <translation>Strg+C</translation>
     </message>
     <message>
         <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1517"/>
         <source>&amp;Paste</source>
-        <translation type="unfinished"></translation>
+        <translation>&amp;Einf?gen</translation>
     </message>
     <message>
         <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1520"/>
         <source>Ctrl+V</source>
-        <translation type="unfinished"></translation>
+        <translation>Strg+V</translation>
     </message>
     <message>
         <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1525"/>
         <source>&amp;Delete</source>
-        <translation type="unfinished"></translation>
+        <translation>&amp;L?schen</translation>
     </message>
     <message>
         <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1528"/>
         <source>Del</source>
-        <translation type="unfinished"></translation>
+        <translation>Entf</translation>
     </message>
     <message>
         <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1536"/>
         <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1539"/>
         <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1542"/>
         <source>Set Marker A</source>
-        <translation type="unfinished"></translation>
+        <translation>Setze Markierung A</translation>
     </message>
     <message>
         <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1545"/>
@@ -9823,7 +9884,7 @@
         <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1556"/>
         <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1559"/>
         <source>Set Marker B</source>
-        <translation type="unfinished"></translation>
+        <translation>Setze Markierung B</translation>
     </message>
     <message>
         <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1562"/>
@@ -9833,23 +9894,23 @@
     <message>
         <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1570"/>
         <source>&amp;Information...</source>
-        <translation type="unfinished"></translation>
+        <translation>Datei-&amp;Informationen...</translation>
     </message>
     <message>
         <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1573"/>
         <source>Alt+Return</source>
-        <translation type="unfinished"></translation>
+        <translation>Alt+Eingabetaste</translation>
     </message>
     <message>
         <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1581"/>
         <source>Save &amp;Video...</source>
-        <translation type="unfinished"></translation>
+        <translation>&amp;Video speichern...</translation>
     </message>
     <message>
         <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1584"/>
         <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1587"/>
         <source>Save Video</source>
-        <translation type="unfinished"></translation>
+        <translation>Video speichern</translation>
     </message>
     <message>
         <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1590"/>
@@ -9859,57 +9920,57 @@
     <message>
         <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1595"/>
         <source>Save &amp;BMP Image...</source>
-        <translation type="unfinished"></translation>
+        <translation>Als &amp;BMP-Bild speichern...</translation>
     </message>
     <message>
         <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1598"/>
         <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1601"/>
         <source>Save BMP Image</source>
-        <translation type="unfinished"></translation>
+        <translation>Als BMP-Bild speichern</translation>
     </message>
     <message>
         <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1606"/>
         <source>Save &amp;JPEG Image...</source>
-        <translation type="unfinished"></translation>
+        <translation>Als &amp;JPG-Bild speichern...</translation>
     </message>
     <message>
         <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1609"/>
         <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1612"/>
         <source>Save JPEG Image</source>
-        <translation type="unfinished"></translation>
+        <translation>Als JPG-Bild speichern</translation>
     </message>
     <message>
         <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1620"/>
         <source>&amp;Load/Run Project...</source>
-        <translation type="unfinished"></translation>
+        <translation>&amp;Lade/Starte Projekt...</translation>
     </message>
     <message>
         <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1623"/>
         <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1626"/>
         <source>Load/Run Project</source>
-        <translation type="unfinished"></translation>
+        <translation>Lade/Starte Projekt</translation>
     </message>
     <message>
         <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1634"/>
         <source>Save &amp;Project</source>
-        <translation type="unfinished"></translation>
+        <translation>&amp;Projekt speichern</translation>
     </message>
     <message>
         <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1637"/>
         <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1640"/>
         <source>Save Project</source>
-        <translation type="unfinished"></translation>
+        <translation>Projekt speichern</translation>
     </message>
     <message>
         <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1648"/>
         <source>Save P&amp;roject As...</source>
-        <translation type="unfinished"></translation>
+        <translation>P&amp;rojekt speichern unter...</translation>
     </message>
     <message>
         <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1651"/>
         <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1654"/>
         <source>Save Project As</source>
-        <translation type="unfinished"></translation>
+        <translation>Projekt speichern unter</translation>
     </message>
     <message>
         <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1662"/>
@@ -9954,13 +10015,13 @@
     <message>
         <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1706"/>
         <source>&amp;Decoder Options...</source>
-        <translation type="unfinished"></translation>
+        <translation>&amp;Dekoder Optionen...</translation>
     </message>
     <message>
         <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1709"/>
         <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1712"/>
         <source>Decoder Options</source>
-        <translation type="unfinished">Dekodierer Optionen</translation>
+        <translation>Dekoder Optionen</translation>
     </message>
     <message>
         <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1715"/>
@@ -9970,7 +10031,7 @@
     <message>
         <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1720"/>
         <source>&amp;Postprocessing...</source>
-        <translation type="unfinished"></translation>
+        <translation>&amp;Nachbearbeitung...</translation>
     </message>
     <message>
         <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1723"/>
@@ -9980,18 +10041,18 @@
     <message>
         <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1728"/>
         <source>&amp;Frame Rate...</source>
-        <translation type="unfinished"></translation>
+        <translation>&amp;Bildwiederholrate...</translation>
     </message>
     <message>
         <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1731"/>
         <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1734"/>
         <source>Frame Rate</source>
-        <translation type="unfinished">Bildrate</translation>
+        <translation>Bildwiederholrate</translation>
     </message>
     <message>
         <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1739"/>
         <source>Fil&amp;ters...</source>
-        <translation type="unfinished"></translation>
+        <translation>Videofil&amp;ter...</translation>
     </message>
     <message>
         <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1742"/>
@@ -10001,24 +10062,24 @@
     <message>
         <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1747"/>
         <source>&amp;Main Track...</source>
-        <translation type="unfinished"></translation>
+        <translation>&amp;Hauptspur...</translation>
     </message>
     <message>
         <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1752"/>
         <source>&amp;Secondary Track...</source>
-        <translation type="unfinished"></translation>
+        <translation>&amp;Zweite Spur...</translation>
     </message>
     <message>
         <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1757"/>
         <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1760"/>
         <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1763"/>
         <source>Build VBR Time Map</source>
-        <translation type="unfinished"></translation>
+        <translation>erstelle VBR Zeitkarte</translation>
     </message>
     <message>
         <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1768"/>
         <source>S&amp;ave...</source>
-        <translation type="unfinished"></translation>
+        <translation>Audio&amp;spur speichern...</translation>
     </message>
     <message>
         <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1771"/>
@@ -10028,12 +10089,12 @@
     <message>
         <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1776"/>
         <source>&amp;Filters</source>
-        <translation type="unfinished"></translation>
+        <translation>&amp;Audiofilter</translation>
     </message>
     <message>
         <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1793"/>
         <source>&amp;Calculator...</source>
-        <translation type="unfinished"></translation>
+        <translation>Video-&amp;Kalkulation...</translation>
     </message>
     <message>
         <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1796"/>
@@ -10043,35 +10104,35 @@
     <message>
         <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1801"/>
         <source>&amp;Rebuild I &amp;&amp; B Frames</source>
-        <translation type="unfinished"></translation>
+        <translation>&amp;I &amp;&amp; B-Frames neu aufbauen</translation>
     </message>
     <message>
         <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1804"/>
         <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1807"/>
         <source>Rebuild I &amp; B Frames</source>
-        <translation type="unfinished"></translation>
+        <translation>Baue I &amp; B-Frames neu auf</translation>
     </message>
     <message>
         <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1812"/>
         <source>&amp;Bitrate Histogram...</source>
-        <translation type="unfinished"></translation>
+        <translation>&amp;Bitrate Histogramm...</translation>
     </message>
     <message>
         <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1815"/>
         <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1818"/>
         <source>Bitrate Histogram</source>
-        <translation type="unfinished">Bitrate Histogramm</translation>
+        <translation>Bitrate Histogramm</translation>
     </message>
     <message>
         <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1823"/>
         <source>&amp;Scan for Black Frames...</source>
-        <translation type="unfinished"></translation>
+        <translation>&amp;Suchlauf nach schwarzen Bildern...</translation>
     </message>
     <message>
         <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1826"/>
         <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1829"/>
         <source>Scan for Black Frames</source>
-        <translation type="unfinished"></translation>
+        <translation>Suche nach schwarzen Bildern</translation>
     </message>
     <message>
         <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1834"/>
@@ -10107,12 +10168,12 @@
     <message>
         <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1859"/>
         <source>P&amp;revious Frame</source>
-        <translation type="unfinished"></translation>
+        <translation>Bild zu&amp;r?ck</translation>
     </message>
     <message>
         <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="363"/>
         <source>ms</source>
-        <translation type="unfinished"></translation>
+        <translation>ms</translation>
     </message>
     <message>
         <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1143"/>
@@ -10127,22 +10188,22 @@
     <message>
         <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1366"/>
         <source>Recent Projects</source>
-        <translation type="unfinished"></translation>
+        <translation>k?rzlich verwendete Projekte</translation>
     </message>
     <message>
         <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1496"/>
         <source>E&amp;xit</source>
-        <translation type="unfinished"></translation>
+        <translation>&amp;Beenden</translation>
     </message>
     <message>
         <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1862"/>
         <source>Left</source>
-        <translation type="unfinished"></translation>
+        <translation>links</translation>
     </message>
     <message>
         <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1870"/>
         <source>&amp;Next Frame</source>
-        <translation type="unfinished"></translation>
+        <translation>&amp;n?chstes Bild</translation>
     </message>
     <message>
         <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1873"/>
@@ -10152,13 +10213,13 @@
     <message>
         <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1881"/>
         <source>Pr&amp;evious Intra Frame</source>
-        <translation type="unfinished"></translation>
+        <translation>&amp;Intra Frame zur?ck</translation>
     </message>
     <message>
         <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1884"/>
         <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1887"/>
         <source>Previous Intra Frame</source>
-        <translation type="unfinished"></translation>
+        <translation>Intra Frame zur?ck</translation>
     </message>
     <message>
         <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1890"/>
@@ -10168,13 +10229,13 @@
     <message>
         <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1898"/>
         <source>Next &amp;Intra Frame</source>
-        <translation type="unfinished"></translation>
+        <translation>n?chster &amp;i-Frame</translation>
     </message>
     <message>
         <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1901"/>
         <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1904"/>
         <source>Next Intra Frame</source>
-        <translation type="unfinished"></translation>
+        <translation>n?chster i-Frame</translation>
     </message>
     <message>
         <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1907"/>
@@ -10184,29 +10245,29 @@
     <message>
         <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1915"/>
         <source>Previou&amp;s Black Frame</source>
-        <translation type="unfinished"></translation>
+        <translation>&amp;vorheriges schwarzes Bild</translation>
     </message>
     <message>
         <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1918"/>
         <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1921"/>
         <source>Previous Black Frame</source>
-        <translation type="unfinished"></translation>
+        <translation>vorheriges schwarzes Bild</translation>
     </message>
     <message>
         <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1929"/>
         <source>Ne&amp;xt Black Frame</source>
-        <translation type="unfinished"></translation>
+        <translation>n&amp;?chstes schwarzes Bild</translation>
     </message>
     <message>
         <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1932"/>
         <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1935"/>
         <source>Next Black Frame</source>
-        <translation type="unfinished"></translation>
+        <translation>n?chstes schwarzes Bild</translation>
     </message>
     <message>
         <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1943"/>
         <source>&amp;First Frame</source>
-        <translation type="unfinished"></translation>
+        <translation>&amp;erstes Bild</translation>
     </message>
     <message>
         <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1946"/>
@@ -10216,7 +10277,7 @@
     <message>
         <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1954"/>
         <source>&amp;Last Frame</source>
-        <translation type="unfinished"></translation>
+        <translation>&amp;letztes Bild</translation>
     </message>
     <message>
         <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1957"/>
@@ -10226,13 +10287,13 @@
     <message>
         <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1965"/>
         <source>Jump to Marker &amp;A</source>
-        <translation type="unfinished"></translation>
+        <translation>Springe zu Markierung &amp;A</translation>
     </message>
     <message>
         <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1968"/>
         <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1971"/>
         <source>Jump to Marker A</source>
-        <translation type="unfinished"></translation>
+        <translation>Springe zu Markierung A</translation>
     </message>
     <message>
         <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1974"/>
@@ -10242,13 +10303,13 @@
     <message>
         <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1982"/>
         <source>Jump to Marker &amp;B</source>
-        <translation type="unfinished"></translation>
+        <translation>Springe zu Markierung &amp;B</translation>
     </message>
     <message>
         <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1985"/>
         <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1988"/>
         <source>Jump to Marker B</source>
-        <translation type="unfinished"></translation>
+        <translation>Springe zu Markierung B</translation>
     </message>
     <message>
         <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1991"/>
@@ -10258,7 +10319,7 @@
     <message>
         <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1996"/>
         <source>Jump to Fra&amp;me...</source>
-        <translation type="unfinished"></translation>
+        <translation>Springe zu &amp;Bild...</translation>
     </message>
     <message>
         <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="1999"/>
@@ -10268,7 +10329,7 @@
     <message>
         <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="2004"/>
         <source>Jump to &amp;Time...</source>
-        <translation type="unfinished"></translation>
+        <translation>Springe zum &amp;Zeitindex...</translation>
     </message>
     <message>
         <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="2007"/>
@@ -10278,35 +10339,35 @@
     <message>
         <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="2012"/>
         <source>&amp;Built-in Support...</source>
-        <translation type="unfinished"></translation>
+        <translation>&amp;Eingebaute Unterst?tzung...</translation>
     </message>
     <message>
         <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="2015"/>
         <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="2018"/>
         <source>Built-in Support</source>
-        <translation type="unfinished">Eingebauter Support</translation>
+        <translation>Eingebaute Unterst?tzung</translation>
     </message>
     <message>
         <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="2023"/>
         <source>&amp;About Avidemux...</source>
-        <translation type="unfinished"></translation>
+        <translation>&amp;?ber Avidemux...</translation>
     </message>
     <message>
         <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="2026"/>
         <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="2029"/>
         <source>About Avidemux</source>
-        <translation type="unfinished"></translation>
+        <translation>?ber Avidemux</translation>
     </message>
     <message>
         <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="2037"/>
         <source>&amp;Play/Stop</source>
-        <translation type="unfinished"></translation>
+        <translation>Start/Sto&amp;p</translation>
     </message>
     <message>
         <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="2040"/>
         <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="2043"/>
         <source>Play/Stop</source>
-        <translation type="unfinished"></translation>
+        <translation>Start/Stop</translation>
     </message>
     <message>
         <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="2051"/>
@@ -10331,7 +10392,7 @@
     <message>
         <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="2192"/>
         <source>&amp;Close</source>
-        <translation type="unfinished"></translation>
+        <translation>&amp;Schlie?en</translation>
     </message>
     <message>
         <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="2195"/>
@@ -10341,17 +10402,17 @@
     <message>
         <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="2200"/>
         <source>Save Selection as JPEG Images...</source>
-        <translation type="unfinished"></translation>
+        <translation>Speichere Auswahl als JPG-Bilderserie...</translation>
     </message>
     <message>
         <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="2205"/>
         <source>&amp;Preferences...</source>
-        <translation type="unfinished"></translation>
+        <translation>&amp;Einstellungen...</translation>
     </message>
     <message>
         <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="2210"/>
         <source>&amp;Plugins...</source>
-        <translation type="unfinished"></translation>
+        <translation>eingebaute &amp;Plugins...</translation>
     </message>
     <message>
         <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="2215"/>
@@ -10396,24 +10457,24 @@
     <message>
         <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="2071"/>
         <source>Add to &amp;Joblist...</source>
-        <translation type="unfinished"></translation>
+        <translation>Zur &amp;Jobliste hinzuf?gen...</translation>
     </message>
     <message>
         <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="2074"/>
         <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="2077"/>
         <source>Add to Joblist</source>
-        <translation type="unfinished"></translation>
+        <translation>Zur Jobliste hinzuf?gen</translation>
     </message>
     <message>
         <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="2082"/>
         <source>View &amp;Joblist...</source>
-        <translation type="unfinished"></translation>
+        <translation>&amp;Jobliste anzeigen...</translation>
     </message>
     <message>
         <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="2085"/>
         <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="2088"/>
         <source>View Joblist</source>
-        <translation type="unfinished"></translation>
+        <translation>Jobliste anzeigen</translation>
     </message>
     <message>
         <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="2091"/>
@@ -10423,18 +10484,18 @@
     <message>
         <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="2096"/>
         <source>Co&amp;nnect to avsproxy</source>
-        <translation type="unfinished"></translation>
+        <translation>Verbi&amp;nde mit avsproxy</translation>
     </message>
     <message>
         <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="2099"/>
         <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="2102"/>
         <source>Connect to avsproxy</source>
-        <translation type="unfinished"></translation>
+        <translation>Verbinde mit avsproxy</translation>
     </message>
     <message>
         <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="2107"/>
         <source>&amp;Reset Edits</source>
-        <translation type="unfinished"></translation>
+        <translation>?nderungen &amp;r?ckg?ngig machen</translation>
     </message>
     <message>
         <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="2112"/>
@@ -10450,38 +10511,38 @@
     <message>
         <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="2123"/>
         <source>Edit &amp;Glyphs...</source>
-        <translation type="unfinished"></translation>
+        <translation>bearbeite &amp;Glyphs...</translation>
     </message>
     <message>
         <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="2126"/>
         <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="2129"/>
         <source>Edit Glyphs</source>
-        <translation type="unfinished"></translation>
+        <translation>bearbeite Glyphs</translation>
     </message>
     <message>
         <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="2143"/>
         <source>&amp;Input</source>
-        <translation type="unfinished"></translation>
+        <translation>&amp;Original</translation>
     </message>
     <message>
         <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="2154"/>
         <source>&amp;Output</source>
-        <translation type="unfinished"></translation>
+        <translation>&amp;Vorschau</translation>
     </message>
     <message>
         <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="2165"/>
         <source>Si&amp;de</source>
-        <translation type="unfinished"></translation>
+        <translation>&amp;nebeneinander</translation>
     </message>
     <message>
         <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="2176"/>
         <source>&amp;Top</source>
-        <translation type="unfinished"></translation>
+        <translation>&amp;?bereinander</translation>
     </message>
     <message>
         <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui" line="2187"/>
         <source>&amp;Separate</source>
-        <translation type="unfinished"></translation>
+        <translation>&amp;eigenst?ndig</translation>
     </message>
     <message>
         <source>FLV</source>
@@ -11152,12 +11213,14 @@
     <message>
         <location filename="../plugins/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/xvidConfigDialog.ui" line="14"/>
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/ui_xvidConfigDialog.h" line="1966"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/ui_xvidConfigDialog.h" line="1979"/>
         <source>Xvid Configuraton</source>
         <translation type="unfinished"></translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/xvidConfigDialog.ui" line="50"/>
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/ui_xvidConfigDialog.h" line="1967"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/ui_xvidConfigDialog.h" line="1980"/>
         <source>Configuration:</source>
         <translation type="unfinished"></translation>
     </message>
@@ -11165,24 +11228,28 @@
         <location filename="../plugins/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/xvidConfigDialog.ui" line="67"/>
         <location filename="../plugins/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/xvidConfigDialog.cpp" line="216"/>
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/ui_xvidConfigDialog.h" line="1968"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/ui_xvidConfigDialog.h" line="1981"/>
         <source>Save As</source>
         <translation type="unfinished"></translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/xvidConfigDialog.ui" line="74"/>
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/ui_xvidConfigDialog.h" line="1969"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/ui_xvidConfigDialog.h" line="1982"/>
         <source>Delete</source>
         <translation type="unfinished"></translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/xvidConfigDialog.ui" line="116"/>
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/ui_xvidConfigDialog.h" line="2002"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/ui_xvidConfigDialog.h" line="2015"/>
         <source>General</source>
         <translation type="unfinished"></translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/xvidConfigDialog.ui" line="128"/>
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/ui_xvidConfigDialog.h" line="1970"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/ui_xvidConfigDialog.h" line="1983"/>
         <source>Rate Control</source>
         <translation type="unfinished">Bitraten-Kontrolle</translation>
     </message>
@@ -11190,36 +11257,42 @@
         <location filename="../plugins/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/xvidConfigDialog.ui" line="148"/>
         <location filename="../plugins/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/xvidConfigDialog.cpp" line="284"/>
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/ui_xvidConfigDialog.h" line="1971"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/ui_xvidConfigDialog.h" line="1984"/>
         <source>Target Video Size:</source>
         <translation type="unfinished"></translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/xvidConfigDialog.ui" line="167"/>
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/ui_xvidConfigDialog.h" line="1974"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/ui_xvidConfigDialog.h" line="1987"/>
         <source>Constant Bitrate (Single Pass)</source>
         <translation type="unfinished"></translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/xvidConfigDialog.ui" line="172"/>
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/ui_xvidConfigDialog.h" line="1975"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/ui_xvidConfigDialog.h" line="1988"/>
         <source>Constant Quantiser (Single Pass)</source>
         <translation type="unfinished"></translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/xvidConfigDialog.ui" line="177"/>
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/ui_xvidConfigDialog.h" line="1976"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/ui_xvidConfigDialog.h" line="1989"/>
         <source>Video Size (Two Pass)</source>
         <translation type="unfinished"></translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/xvidConfigDialog.ui" line="182"/>
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/ui_xvidConfigDialog.h" line="1977"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/ui_xvidConfigDialog.h" line="1990"/>
         <source>Average Bitrate (Two Pass)</source>
         <translation type="unfinished"></translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/xvidConfigDialog.ui" line="205"/>
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/ui_xvidConfigDialog.h" line="1979"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/ui_xvidConfigDialog.h" line="1992"/>
         <source>Encoding Mode:</source>
         <translation type="unfinished"></translation>
     </message>
@@ -11227,12 +11300,14 @@
         <location filename="../plugins/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/xvidConfigDialog.ui" line="233"/>
         <location filename="../plugins/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/xvidConfigDialog.cpp" line="285"/>
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/ui_xvidConfigDialog.h" line="1981"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/ui_xvidConfigDialog.h" line="1994"/>
         <source>MB</source>
         <translation type="unfinished"></translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/xvidConfigDialog.ui" line="308"/>
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/ui_xvidConfigDialog.h" line="1982"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/ui_xvidConfigDialog.h" line="1995"/>
         <source>1 (High Quality)</source>
         <translation type="unfinished"></translation>
     </message>
@@ -11241,18 +11316,22 @@
         <location filename="../plugins/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/xvidConfigDialog.ui" line="1268"/>
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/ui_xvidConfigDialog.h" line="1983"/>
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/ui_xvidConfigDialog.h" line="2059"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/ui_xvidConfigDialog.h" line="1996"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/ui_xvidConfigDialog.h" line="2072"/>
         <source>Quantiser</source>
         <translation type="unfinished"></translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/xvidConfigDialog.ui" line="354"/>
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/ui_xvidConfigDialog.h" line="1984"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/ui_xvidConfigDialog.h" line="1997"/>
         <source>31 (Low Quality)</source>
         <translation type="unfinished"></translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/xvidConfigDialog.ui" line="432"/>
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/ui_xvidConfigDialog.h" line="1985"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/ui_xvidConfigDialog.h" line="1998"/>
         <source>Pixel Aspect Ratio</source>
         <translation type="unfinished">Pixel Seitenverh?ltnis (PAR)</translation>
     </message>
@@ -11261,348 +11340,407 @@
         <location filename="../plugins/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/xvidConfigDialog.ui" line="665"/>
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/ui_xvidConfigDialog.h" line="1986"/>
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/ui_xvidConfigDialog.h" line="2001"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/ui_xvidConfigDialog.h" line="1999"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/ui_xvidConfigDialog.h" line="2014"/>
         <source>Custom:</source>
         <translation type="unfinished"></translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/xvidConfigDialog.ui" line="462"/>
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/ui_xvidConfigDialog.h" line="1987"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/ui_xvidConfigDialog.h" line="2000"/>
         <source>As Input</source>
         <translation type="unfinished">Wie Eingang</translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/xvidConfigDialog.ui" line="523"/>
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/ui_xvidConfigDialog.h" line="1989"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/ui_xvidConfigDialog.h" line="2002"/>
         <source>:</source>
         <translation type="unfinished">:</translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/xvidConfigDialog.ui" line="558"/>
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/ui_xvidConfigDialog.h" line="1990"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/ui_xvidConfigDialog.h" line="2003"/>
         <source>Predefined Aspect Ratio:</source>
         <translation type="unfinished"></translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/xvidConfigDialog.ui" line="577"/>
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/ui_xvidConfigDialog.h" line="1993"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/ui_xvidConfigDialog.h" line="2006"/>
         <source>16:15 (PAL 4:3)</source>
         <translation type="unfinished"></translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/xvidConfigDialog.ui" line="582"/>
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/ui_xvidConfigDialog.h" line="1994"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/ui_xvidConfigDialog.h" line="2007"/>
         <source>64:45 (PAL 16:9)</source>
         <translation type="unfinished"></translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/xvidConfigDialog.ui" line="587"/>
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/ui_xvidConfigDialog.h" line="1995"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/ui_xvidConfigDialog.h" line="2008"/>
         <source>8:9 (NTSC 4:3)</source>
         <translation type="unfinished"></translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/xvidConfigDialog.ui" line="592"/>
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/ui_xvidConfigDialog.h" line="1996"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/ui_xvidConfigDialog.h" line="2009"/>
         <source>32:27 (NTSC 16:9)</source>
         <translation type="unfinished"></translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/xvidConfigDialog.ui" line="620"/>
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/ui_xvidConfigDialog.h" line="1998"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/ui_xvidConfigDialog.h" line="2011"/>
         <source>Multithreading</source>
         <translation type="unfinished"></translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/xvidConfigDialog.ui" line="640"/>
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/ui_xvidConfigDialog.h" line="1999"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/ui_xvidConfigDialog.h" line="2012"/>
         <source>Disable</source>
         <translation type="unfinished">Deaktivieren</translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/xvidConfigDialog.ui" line="647"/>
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/ui_xvidConfigDialog.h" line="2000"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/ui_xvidConfigDialog.h" line="2013"/>
         <source>Auto-detect</source>
         <translation type="unfinished">Auto-Erkennung</translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/xvidConfigDialog.ui" line="719"/>
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/ui_xvidConfigDialog.h" line="2024"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/ui_xvidConfigDialog.h" line="2037"/>
         <source>Motion</source>
         <translation type="unfinished"></translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/xvidConfigDialog.ui" line="731"/>
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/ui_xvidConfigDialog.h" line="2003"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/ui_xvidConfigDialog.h" line="2016"/>
         <source>Motion Estimation</source>
         <translation type="unfinished">Absch?tzung der Bewegung</translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/xvidConfigDialog.ui" line="751"/>
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/ui_xvidConfigDialog.h" line="2004"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/ui_xvidConfigDialog.h" line="2017"/>
         <source>Motion Estimation:</source>
         <translation type="unfinished"></translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/xvidConfigDialog.ui" line="773"/>
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/ui_xvidConfigDialog.h" line="2007"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/ui_xvidConfigDialog.h" line="2020"/>
         <source>Low</source>
         <translation type="unfinished">Niedrig</translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/xvidConfigDialog.ui" line="778"/>
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/ui_xvidConfigDialog.h" line="2008"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/ui_xvidConfigDialog.h" line="2021"/>
         <source>Medium</source>
         <translation type="unfinished">Mittel</translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/xvidConfigDialog.ui" line="783"/>
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/ui_xvidConfigDialog.h" line="2009"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/ui_xvidConfigDialog.h" line="2022"/>
         <source>High</source>
         <translation type="unfinished">Hoch</translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/xvidConfigDialog.ui" line="816"/>
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/ui_xvidConfigDialog.h" line="2011"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/ui_xvidConfigDialog.h" line="2024"/>
         <source>Rate Distortion Optimisation:</source>
         <translation type="unfinished"></translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/xvidConfigDialog.ui" line="838"/>
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/ui_xvidConfigDialog.h" line="2014"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/ui_xvidConfigDialog.h" line="2027"/>
         <source>No Search (DCT only)</source>
         <translation type="unfinished"></translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/xvidConfigDialog.ui" line="843"/>
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/ui_xvidConfigDialog.h" line="2015"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/ui_xvidConfigDialog.h" line="2028"/>
         <source>Limited Search</source>
         <translation type="unfinished"></translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/xvidConfigDialog.ui" line="848"/>
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/ui_xvidConfigDialog.h" line="2016"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/ui_xvidConfigDialog.h" line="2029"/>
         <source>Medium Search</source>
         <translation type="unfinished"></translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/xvidConfigDialog.ui" line="853"/>
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/ui_xvidConfigDialog.h" line="2017"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/ui_xvidConfigDialog.h" line="2030"/>
         <source>Wide Search</source>
         <translation type="unfinished"></translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/xvidConfigDialog.ui" line="878"/>
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/ui_xvidConfigDialog.h" line="2019"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/ui_xvidConfigDialog.h" line="2032"/>
         <source>Rate Distortion Optimisation for B-frames</source>
         <translation type="unfinished"></translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/xvidConfigDialog.ui" line="888"/>
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/ui_xvidConfigDialog.h" line="2020"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/ui_xvidConfigDialog.h" line="2033"/>
         <source>Chroma Motion Estimation</source>
         <translation type="unfinished"></translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/xvidConfigDialog.ui" line="898"/>
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/ui_xvidConfigDialog.h" line="2021"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/ui_xvidConfigDialog.h" line="2034"/>
         <source>Quarter Pixel Motion Estimation</source>
         <translation type="unfinished"></translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/xvidConfigDialog.ui" line="905"/>
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/ui_xvidConfigDialog.h" line="2022"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/ui_xvidConfigDialog.h" line="2035"/>
         <source>Global Motion Compensation</source>
         <translation type="unfinished"></translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/xvidConfigDialog.ui" line="912"/>
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/ui_xvidConfigDialog.h" line="2023"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/ui_xvidConfigDialog.h" line="2036"/>
         <source>Turbo Mode</source>
         <translation type="unfinished">Turbo Modus</translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/xvidConfigDialog.ui" line="936"/>
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/ui_xvidConfigDialog.h" line="2043"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/ui_xvidConfigDialog.h" line="2056"/>
         <source>Frame</source>
         <translation type="unfinished"></translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/xvidConfigDialog.ui" line="948"/>
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/ui_xvidConfigDialog.h" line="2025"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/ui_xvidConfigDialog.h" line="2038"/>
         <source>Frame Encoding</source>
         <translation type="unfinished"></translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/xvidConfigDialog.ui" line="960"/>
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/ui_xvidConfigDialog.h" line="2026"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/ui_xvidConfigDialog.h" line="2039"/>
         <source>Chroma Optimiser</source>
         <translation type="unfinished"></translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/xvidConfigDialog.ui" line="967"/>
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/ui_xvidConfigDialog.h" line="2027"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/ui_xvidConfigDialog.h" line="2040"/>
         <source>Four Motion Vectors per Macroblock</source>
         <translation type="unfinished"></translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/xvidConfigDialog.ui" line="974"/>
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/ui_xvidConfigDialog.h" line="2028"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/ui_xvidConfigDialog.h" line="2041"/>
         <source>Cartoon</source>
         <translation type="unfinished"></translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/xvidConfigDialog.ui" line="981"/>
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/ui_xvidConfigDialog.h" line="2029"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/ui_xvidConfigDialog.h" line="2042"/>
         <source>Greyscale</source>
         <translation type="unfinished"></translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/xvidConfigDialog.ui" line="996"/>
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/ui_xvidConfigDialog.h" line="2030"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/ui_xvidConfigDialog.h" line="2043"/>
         <source>Interlaced:</source>
         <translation type="unfinished"></translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/xvidConfigDialog.ui" line="1015"/>
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/ui_xvidConfigDialog.h" line="2033"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/ui_xvidConfigDialog.h" line="2046"/>
         <source>Bottom Field First</source>
         <translation type="unfinished"></translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/xvidConfigDialog.ui" line="1020"/>
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/ui_xvidConfigDialog.h" line="2034"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/ui_xvidConfigDialog.h" line="2047"/>
         <source>Top Field First</source>
         <translation type="unfinished"></translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/xvidConfigDialog.ui" line="1056"/>
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/ui_xvidConfigDialog.h" line="2036"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/ui_xvidConfigDialog.h" line="2049"/>
         <source>Maximum I-frame Interval:</source>
         <translation type="unfinished"></translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/xvidConfigDialog.ui" line="1093"/>
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/ui_xvidConfigDialog.h" line="2037"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/ui_xvidConfigDialog.h" line="2050"/>
         <source>Frame Drop Ratio:</source>
         <translation type="unfinished"></translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/xvidConfigDialog.ui" line="1135"/>
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/ui_xvidConfigDialog.h" line="2038"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/ui_xvidConfigDialog.h" line="2051"/>
         <source>B-frames</source>
         <translation type="unfinished"></translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/xvidConfigDialog.ui" line="1188"/>
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/ui_xvidConfigDialog.h" line="2039"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/ui_xvidConfigDialog.h" line="2052"/>
         <source>B-frame Sensitivity:</source>
         <translation type="unfinished"></translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/xvidConfigDialog.ui" line="1228"/>
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/ui_xvidConfigDialog.h" line="2040"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/ui_xvidConfigDialog.h" line="2053"/>
         <source>Maximum Consecutive B-frames:</source>
         <translation type="unfinished"></translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/xvidConfigDialog.ui" line="1237"/>
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/ui_xvidConfigDialog.h" line="2041"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/ui_xvidConfigDialog.h" line="2054"/>
         <source>Closed GOP</source>
         <translation type="unfinished"></translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/xvidConfigDialog.ui" line="1244"/>
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/ui_xvidConfigDialog.h" line="2042"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/ui_xvidConfigDialog.h" line="2055"/>
         <source>Packed Bitstream</source>
         <translation type="unfinished"></translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/xvidConfigDialog.ui" line="1280"/>
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/ui_xvidConfigDialog.h" line="2044"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/ui_xvidConfigDialog.h" line="2057"/>
         <source>Quantiser Control</source>
         <translation type="unfinished"></translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/xvidConfigDialog.ui" line="1300"/>
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/ui_xvidConfigDialog.h" line="2045"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/ui_xvidConfigDialog.h" line="2058"/>
         <source>Maximum B-frame Quantiser:</source>
         <translation type="unfinished"></translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/xvidConfigDialog.ui" line="1379"/>
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/ui_xvidConfigDialog.h" line="2046"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/ui_xvidConfigDialog.h" line="2059"/>
         <source>B-frame Quantiser Offset:</source>
         <translation type="unfinished"></translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/xvidConfigDialog.ui" line="1422"/>
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/ui_xvidConfigDialog.h" line="2047"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/ui_xvidConfigDialog.h" line="2060"/>
         <source>Minimum P-frame Quantiser:</source>
         <translation type="unfinished"></translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/xvidConfigDialog.ui" line="1429"/>
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/ui_xvidConfigDialog.h" line="2048"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/ui_xvidConfigDialog.h" line="2061"/>
         <source>B-frame Quantiser Ratio:</source>
         <translation type="unfinished"></translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/xvidConfigDialog.ui" line="1436"/>
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/ui_xvidConfigDialog.h" line="2049"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/ui_xvidConfigDialog.h" line="2062"/>
         <source>Minimum I-frame Quantiser:</source>
         <translation type="unfinished"></translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/xvidConfigDialog.ui" line="1515"/>
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/ui_xvidConfigDialog.h" line="2050"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/ui_xvidConfigDialog.h" line="2063"/>
         <source>Minimum B-frame Quantiser:</source>
         <translation type="unfinished"></translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/xvidConfigDialog.ui" line="1522"/>
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/ui_xvidConfigDialog.h" line="2051"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/ui_xvidConfigDialog.h" line="2064"/>
         <source>Maximum P-frame Quantiser:</source>
         <translation type="unfinished"></translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/xvidConfigDialog.ui" line="1643"/>
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/ui_xvidConfigDialog.h" line="2052"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/ui_xvidConfigDialog.h" line="2065"/>
         <source>Maximum I-frame Quantiser:</source>
         <translation type="unfinished"></translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/xvidConfigDialog.ui" line="1652"/>
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/ui_xvidConfigDialog.h" line="2053"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/ui_xvidConfigDialog.h" line="2066"/>
         <source>Trellis Quantisation</source>
         <translation type="unfinished"></translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/xvidConfigDialog.ui" line="1662"/>
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/ui_xvidConfigDialog.h" line="2054"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/ui_xvidConfigDialog.h" line="2067"/>
         <source>Quantisation Matrix</source>
         <translation type="unfinished"></translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/xvidConfigDialog.ui" line="1674"/>
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/ui_xvidConfigDialog.h" line="2055"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/ui_xvidConfigDialog.h" line="2068"/>
         <source>H.263 Matrix</source>
         <translation type="unfinished"></translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/xvidConfigDialog.ui" line="1684"/>
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/ui_xvidConfigDialog.h" line="2056"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/ui_xvidConfigDialog.h" line="2069"/>
         <source>MPEG Matrix</source>
         <translation type="unfinished"></translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/xvidConfigDialog.ui" line="1699"/>
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/ui_xvidConfigDialog.h" line="2057"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/ui_xvidConfigDialog.h" line="2070"/>
         <source>Custom Matrix</source>
         <translation type="unfinished">Individuelle Matrix</translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/xvidConfigDialog.ui" line="1709"/>
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/ui_xvidConfigDialog.h" line="2058"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/ui_xvidConfigDialog.h" line="2071"/>
         <source>Edit</source>
         <translation type="unfinished"></translation>
     </message>
@@ -11611,42 +11749,50 @@
         <location filename="../plugins/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/xvidConfigDialog.ui" line="1760"/>
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/ui_xvidConfigDialog.h" line="2060"/>
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/ui_xvidConfigDialog.h" line="2064"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/ui_xvidConfigDialog.h" line="2073"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/ui_xvidConfigDialog.h" line="2077"/>
         <source>Single Pass</source>
         <translation type="unfinished"></translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/xvidConfigDialog.ui" line="1772"/>
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/ui_xvidConfigDialog.h" line="2061"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/ui_xvidConfigDialog.h" line="2074"/>
         <source>Smoother:</source>
         <translation type="unfinished"></translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/xvidConfigDialog.ui" line="1779"/>
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/ui_xvidConfigDialog.h" line="2062"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/ui_xvidConfigDialog.h" line="2075"/>
         <source>Averaging Quantiser Period:</source>
         <translation type="unfinished"></translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/xvidConfigDialog.ui" line="1786"/>
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/ui_xvidConfigDialog.h" line="2063"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/ui_xvidConfigDialog.h" line="2076"/>
         <source>Reaction Delay Factor:</source>
         <translation type="unfinished"></translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/xvidConfigDialog.ui" line="1900"/>
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/ui_xvidConfigDialog.h" line="2091"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/ui_xvidConfigDialog.h" line="2104"/>
         <source>Two Pass</source>
         <translation type="unfinished"></translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/xvidConfigDialog.ui" line="1912"/>
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/ui_xvidConfigDialog.h" line="2065"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/ui_xvidConfigDialog.h" line="2078"/>
         <source>I-frames</source>
         <translation type="unfinished"></translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/xvidConfigDialog.ui" line="1924"/>
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/ui_xvidConfigDialog.h" line="2066"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/ui_xvidConfigDialog.h" line="2079"/>
         <source>I-frame Boost:</source>
         <translation type="unfinished"></translation>
     </message>
@@ -11665,72 +11811,90 @@
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/ui_xvidConfigDialog.h" line="2076"/>
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/ui_xvidConfigDialog.h" line="2081"/>
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/ui_xvidConfigDialog.h" line="2083"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/ui_xvidConfigDialog.h" line="2080"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/ui_xvidConfigDialog.h" line="2081"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/ui_xvidConfigDialog.h" line="2086"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/ui_xvidConfigDialog.h" line="2088"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/ui_xvidConfigDialog.h" line="2089"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/ui_xvidConfigDialog.h" line="2094"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/ui_xvidConfigDialog.h" line="2096"/>
         <source>%</source>
         <translation type="unfinished"></translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/xvidConfigDialog.ui" line="2011"/>
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/ui_xvidConfigDialog.h" line="2069"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/ui_xvidConfigDialog.h" line="2082"/>
         <source>I-frame Bitrate Reduction Threshold:</source>
         <translation type="unfinished"></translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/xvidConfigDialog.ui" line="2018"/>
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/ui_xvidConfigDialog.h" line="2070"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/ui_xvidConfigDialog.h" line="2083"/>
         <source>Maximum I-frame Bitrate Reduction:</source>
         <translation type="unfinished"></translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/xvidConfigDialog.ui" line="2043"/>
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/ui_xvidConfigDialog.h" line="2071"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/ui_xvidConfigDialog.h" line="2084"/>
         <source>frame(s)</source>
         <translation type="unfinished"></translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/xvidConfigDialog.ui" line="2068"/>
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/ui_xvidConfigDialog.h" line="2072"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/ui_xvidConfigDialog.h" line="2085"/>
         <source>Overflow Control</source>
         <translation type="unfinished"></translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/xvidConfigDialog.ui" line="2120"/>
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/ui_xvidConfigDialog.h" line="2074"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/ui_xvidConfigDialog.h" line="2087"/>
         <source>Maximum Overflow Degradation:</source>
         <translation type="unfinished"></translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/xvidConfigDialog.ui" line="2213"/>
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/ui_xvidConfigDialog.h" line="2077"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/ui_xvidConfigDialog.h" line="2090"/>
         <source>Maximum Overflow Improvement:</source>
         <translation type="unfinished"></translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/xvidConfigDialog.ui" line="2220"/>
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/ui_xvidConfigDialog.h" line="2078"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/ui_xvidConfigDialog.h" line="2091"/>
         <source>Overflow Control Strength:</source>
         <translation type="unfinished"></translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/xvidConfigDialog.ui" line="2230"/>
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/ui_xvidConfigDialog.h" line="2079"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/ui_xvidConfigDialog.h" line="2092"/>
         <source>Curve Compression</source>
         <translation type="unfinished"></translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/xvidConfigDialog.ui" line="2242"/>
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/ui_xvidConfigDialog.h" line="2080"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/ui_xvidConfigDialog.h" line="2093"/>
         <source>Above Average Curve Compression:</source>
         <translation type="unfinished"></translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/xvidConfigDialog.ui" line="2286"/>
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/ui_xvidConfigDialog.h" line="2082"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/ui_xvidConfigDialog.h" line="2095"/>
         <source>Below Average Curve Compression:</source>
         <translation type="unfinished"></translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/xvidConfigDialog.ui" line="2333"/>
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/ui_xvidConfigDialog.h" line="2084"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/ui_xvidConfigDialog.h" line="2097"/>
         <source>Video Buffer Verifier</source>
         <translation type="unfinished"></translation>
     </message>
@@ -11739,30 +11903,36 @@
         <location filename="../plugins/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/xvidConfigDialog.ui" line="2455"/>
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/ui_xvidConfigDialog.h" line="2085"/>
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/ui_xvidConfigDialog.h" line="2090"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/ui_xvidConfigDialog.h" line="2098"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/ui_xvidConfigDialog.h" line="2103"/>
         <source>bit/s</source>
         <translation type="unfinished"></translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/xvidConfigDialog.ui" line="2397"/>
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/ui_xvidConfigDialog.h" line="2086"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/ui_xvidConfigDialog.h" line="2099"/>
         <source>bit(s)</source>
         <translation type="unfinished"></translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/xvidConfigDialog.ui" line="2419"/>
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/ui_xvidConfigDialog.h" line="2087"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/ui_xvidConfigDialog.h" line="2100"/>
         <source>VBV Buffer Size:</source>
         <translation type="unfinished"></translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/xvidConfigDialog.ui" line="2426"/>
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/ui_xvidConfigDialog.h" line="2088"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/ui_xvidConfigDialog.h" line="2101"/>
         <source>Maximum VBV Bitrate:</source>
         <translation type="unfinished"></translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/xvidConfigDialog.ui" line="2433"/>
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/ui_xvidConfigDialog.h" line="2089"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/ui_xvidConfigDialog.h" line="2102"/>
         <source>Peak Bitrate Over 1 Second:</source>
         <translation type="unfinished"></translation>
     </message>
@@ -11813,12 +11983,14 @@
     <message>
         <location filename="../plugins/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/xvidCustomMatrixDialog.ui" line="13"/>
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/ui_xvidCustomMatrixDialog.h" line="1378"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/ui_xvidCustomMatrixDialog.h" line="1378"/>
         <source>Xvid Custom Matrix</source>
         <translation type="unfinished"></translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/xvidCustomMatrixDialog.ui" line="29"/>
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/ui_xvidCustomMatrixDialog.h" line="1380"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/ui_xvidCustomMatrixDialog.h" line="1380"/>
         <source>Intra 8x8</source>
         <translation type="unfinished"></translation>
     </message>
@@ -11827,30 +11999,36 @@
         <location filename="../plugins/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/xvidCustomMatrixDialog.ui" line="760"/>
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/ui_xvidCustomMatrixDialog.h" line="1379"/>
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/ui_xvidCustomMatrixDialog.h" line="1381"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/ui_xvidCustomMatrixDialog.h" line="1379"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/ui_xvidCustomMatrixDialog.h" line="1381"/>
         <source>Luma:</source>
         <translation type="unfinished"></translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/xvidCustomMatrixDialog.ui" line="732"/>
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/ui_xvidCustomMatrixDialog.h" line="1382"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/ui_xvidCustomMatrixDialog.h" line="1382"/>
         <source>Inter 8x8</source>
         <translation type="unfinished"></translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/xvidCustomMatrixDialog.ui" line="1459"/>
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/ui_xvidCustomMatrixDialog.h" line="1383"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/ui_xvidCustomMatrixDialog.h" line="1383"/>
         <source>Load File</source>
         <translation type="unfinished"></translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/xvidCustomMatrixDialog.ui" line="1479"/>
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/ui_xvidCustomMatrixDialog.h" line="1384"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/ui_xvidCustomMatrixDialog.h" line="1384"/>
         <source>OK</source>
         <translation type="unfinished"></translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/xvidCustomMatrixDialog.ui" line="1489"/>
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/ui_xvidCustomMatrixDialog.h" line="1385"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/ui_xvidCustomMatrixDialog.h" line="1385"/>
         <source>Cancel</source>
         <translation type="unfinished"></translation>
     </message>
@@ -11908,30 +12086,35 @@
     <message>
         <location filename="../plugins/ADM_videoFilters/ASharp/qt4/asharp.ui" line="13"/>
         <location filename="../plugins/build/ADM_videoFilters/ASharp/ui_asharp.h" line="139"/>
+        <location filename="../plugins/build64/ADM_videoFilters/ASharp/ui_asharp.h" line="139"/>
         <source>ASharp</source>
         <translation type="unfinished"></translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoFilters/ASharp/qt4/asharp.ui" line="109"/>
         <location filename="../plugins/build/ADM_videoFilters/ASharp/ui_asharp.h" line="140"/>
+        <location filename="../plugins/build64/ADM_videoFilters/ASharp/ui_asharp.h" line="140"/>
         <source>Strength</source>
         <translation type="unfinished">St?rke</translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoFilters/ASharp/qt4/asharp.ui" line="116"/>
         <location filename="../plugins/build/ADM_videoFilters/ASharp/ui_asharp.h" line="141"/>
+        <location filename="../plugins/build64/ADM_videoFilters/ASharp/ui_asharp.h" line="141"/>
         <source>Threshold</source>
         <translation type="unfinished">Schwelle</translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoFilters/ASharp/qt4/asharp.ui" line="123"/>
         <location filename="../plugins/build/ADM_videoFilters/ASharp/ui_asharp.h" line="142"/>
+        <location filename="../plugins/build64/ADM_videoFilters/ASharp/ui_asharp.h" line="142"/>
         <source>Block Adaptative</source>
         <translation type="unfinished"></translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoFilters/ASharp/qt4/asharp.ui" line="130"/>
         <location filename="../plugins/build/ADM_videoFilters/ASharp/ui_asharp.h" line="143"/>
+        <location filename="../plugins/build64/ADM_videoFilters/ASharp/ui_asharp.h" line="143"/>
         <source>High Quality Block Filtering</source>
         <translation type="unfinished"></translation>
     </message>
@@ -11941,18 +12124,21 @@
     <message>
         <location filename="../plugins/ADM_videoFilters/ChromaShift/qt4/chromashift.ui" line="13"/>
         <location filename="../plugins/build/ADM_videoFilters/ChromaShift/ui_chromashift.h" line="114"/>
+        <location filename="../plugins/build64/ADM_videoFilters/ChromaShift/ui_chromashift.h" line="114"/>
         <source>ChromaShift</source>
         <translation type="unfinished">Farbintensit?ts-Verschiebung</translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoFilters/ChromaShift/qt4/chromashift.ui" line="37"/>
         <location filename="../plugins/build/ADM_videoFilters/ChromaShift/ui_chromashift.h" line="115"/>
+        <location filename="../plugins/build64/ADM_videoFilters/ChromaShift/ui_chromashift.h" line="115"/>
         <source>V Shift</source>
         <translation type="unfinished"></translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoFilters/ChromaShift/qt4/chromashift.ui" line="44"/>
         <location filename="../plugins/build/ADM_videoFilters/ChromaShift/ui_chromashift.h" line="116"/>
+        <location filename="../plugins/build64/ADM_videoFilters/ChromaShift/ui_chromashift.h" line="116"/>
         <source>U Shift</source>
         <translation type="unfinished"></translation>
     </message>
@@ -11962,42 +12148,49 @@
     <message>
         <location filename="../plugins/ADM_videoFilters/Contrast/qt4/contrast.ui" line="13"/>
         <location filename="../plugins/build/ADM_videoFilters/Contrast/ui_contrast.h" line="267"/>
+        <location filename="../plugins/build64/ADM_videoFilters/Contrast/ui_contrast.h" line="267"/>
         <source>Contrast</source>
         <translation type="unfinished">Kontrast</translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoFilters/Contrast/qt4/contrast.ui" line="41"/>
         <location filename="../plugins/build/ADM_videoFilters/Contrast/ui_contrast.h" line="268"/>
+        <location filename="../plugins/build64/ADM_videoFilters/Contrast/ui_contrast.h" line="268"/>
         <source>Contrast:</source>
         <translation type="unfinished"></translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoFilters/Contrast/qt4/contrast.ui" line="97"/>
         <location filename="../plugins/build/ADM_videoFilters/Contrast/ui_contrast.h" line="269"/>
+        <location filename="../plugins/build64/ADM_videoFilters/Contrast/ui_contrast.h" line="269"/>
         <source>Brightness:</source>
         <translation type="unfinished"></translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoFilters/Contrast/qt4/contrast.ui" line="195"/>
         <location filename="../plugins/build/ADM_videoFilters/Contrast/ui_contrast.h" line="270"/>
+        <location filename="../plugins/build64/ADM_videoFilters/Contrast/ui_contrast.h" line="270"/>
         <source>Colour Space</source>
         <translation type="unfinished"></translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoFilters/Contrast/qt4/contrast.ui" line="207"/>
         <location filename="../plugins/build/ADM_videoFilters/Contrast/ui_contrast.h" line="271"/>
+        <location filename="../plugins/build64/ADM_videoFilters/Contrast/ui_contrast.h" line="271"/>
         <source>Luma</source>
         <translation type="unfinished">Brillianz</translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoFilters/Contrast/qt4/contrast.ui" line="214"/>
         <location filename="../plugins/build/ADM_videoFilters/Contrast/ui_contrast.h" line="272"/>
+        <location filename="../plugins/build64/ADM_videoFilters/Contrast/ui_contrast.h" line="272"/>
         <source>ChromaU</source>
         <translation type="unfinished"></translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoFilters/Contrast/qt4/contrast.ui" line="221"/>
         <location filename="../plugins/build/ADM_videoFilters/Contrast/ui_contrast.h" line="273"/>
+        <location filename="../plugins/build64/ADM_videoFilters/Contrast/ui_contrast.h" line="273"/>
         <source>ChromaV</source>
         <translation type="unfinished"></translation>
     </message>
@@ -12007,42 +12200,49 @@
     <message>
         <location filename="../plugins/ADM_videoFilters/Crop/qt4/crop.ui" line="13"/>
         <location filename="../plugins/build/ADM_videoFilters/Crop/ui_crop.h" line="184"/>
+        <location filename="../plugins/build64/ADM_videoFilters/Crop/ui_crop.h" line="184"/>
         <source>Crop</source>
         <translation type="unfinished">Zuschneiden</translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoFilters/Crop/qt4/crop.ui" line="33"/>
         <location filename="../plugins/build/ADM_videoFilters/Crop/ui_crop.h" line="185"/>
+        <location filename="../plugins/build64/ADM_videoFilters/Crop/ui_crop.h" line="185"/>
         <source>Right:</source>
         <translation type="unfinished"></translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoFilters/Crop/qt4/crop.ui" line="40"/>
         <location filename="../plugins/build/ADM_videoFilters/Crop/ui_crop.h" line="186"/>
+        <location filename="../plugins/build64/ADM_videoFilters/Crop/ui_crop.h" line="186"/>
         <source>Top:</source>
         <translation type="unfinished"></translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoFilters/Crop/qt4/crop.ui" line="83"/>
         <location filename="../plugins/build/ADM_videoFilters/Crop/ui_crop.h" line="187"/>
+        <location filename="../plugins/build64/ADM_videoFilters/Crop/ui_crop.h" line="187"/>
         <source>Reset</source>
         <translation type="unfinished">Zur?ck setzen</translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoFilters/Crop/qt4/crop.ui" line="104"/>
         <location filename="../plugins/build/ADM_videoFilters/Crop/ui_crop.h" line="188"/>
+        <location filename="../plugins/build64/ADM_videoFilters/Crop/ui_crop.h" line="188"/>
         <source>Bottom:</source>
         <translation type="unfinished"></translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoFilters/Crop/qt4/crop.ui" line="111"/>
         <location filename="../plugins/build/ADM_videoFilters/Crop/ui_crop.h" line="189"/>
+        <location filename="../plugins/build64/ADM_videoFilters/Crop/ui_crop.h" line="189"/>
         <source>Left:</source>
         <translation type="unfinished"></translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoFilters/Crop/qt4/crop.ui" line="141"/>
         <location filename="../plugins/build/ADM_videoFilters/Crop/ui_crop.h" line="190"/>
+        <location filename="../plugins/build64/ADM_videoFilters/Crop/ui_crop.h" line="190"/>
         <source>Auto Crop</source>
         <translation type="unfinished"></translation>
     </message>
@@ -12182,7 +12382,7 @@
         <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/encoding.ui" line="140"/>
         <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/encoding.ui" line="167"/>
         <source>None</source>
-        <translation type="unfinished">Keine</translation>
+        <translation>Keine</translation>
     </message>
     <message>
         <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/encoding.ui" line="147"/>
@@ -12221,12 +12421,12 @@
     <message>
         <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/encoding.ui" line="266"/>
         <source>Time Remaining:</source>
-        <translation type="unfinished"></translation>
+        <translation>verbleibende Zeit:</translation>
     </message>
     <message>
         <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/encoding.ui" line="279"/>
         <source>Frames/sec:</source>
-        <translation type="unfinished"></translation>
+        <translation>Bilder je Sekunde:</translation>
     </message>
     <message>
         <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/encoding.ui" line="325"/>
@@ -12238,22 +12438,22 @@
     <message>
         <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/encoding.ui" line="338"/>
         <source>Total Size:</source>
-        <translation type="unfinished"></translation>
+        <translation>Gr??e gesamt:</translation>
     </message>
     <message>
         <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/encoding.ui" line="358"/>
         <source>Audio Size:</source>
-        <translation type="unfinished"></translation>
+        <translation>Gr??e Audiospur:</translation>
     </message>
     <message>
         <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/encoding.ui" line="381"/>
         <source>Video Size:</source>
-        <translation type="unfinished"></translation>
+        <translation>Gr??e Videospur:</translation>
     </message>
     <message>
         <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/encoding.ui" line="433"/>
         <source>Processed Frames:</source>
-        <translation type="unfinished"></translation>
+        <translation>bearbeitete Bilder:</translation>
     </message>
     <message>
         <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/encoding.ui" line="446"/>
@@ -12268,7 +12468,7 @@
     <message>
         <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/encoding.ui" line="476"/>
         <source>Average Bitrate:</source>
-        <translation type="unfinished"></translation>
+        <translation>durchschnittliche Bitrate:</translation>
     </message>
     <message>
         <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/encoding.ui" line="496"/>
@@ -12278,7 +12478,7 @@
     <message>
         <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/encoding.ui" line="568"/>
         <source>Shut down computer when finished</source>
-        <translation type="unfinished">Danach Rechner herunter fahren</translation>
+        <translation>Danach Rechner herunter fahren</translation>
     </message>
     <message>
         <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/encoding.ui" line="588"/>
@@ -12288,27 +12488,27 @@
     <message>
         <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/encoding.ui" line="599"/>
         <source>High</source>
-        <translation type="unfinished">Hoch</translation>
+        <translation>Hoch</translation>
     </message>
     <message>
         <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/encoding.ui" line="604"/>
         <source>Above Normal</source>
-        <translation type="unfinished">?ber Normal</translation>
+        <translation>?ber Normal</translation>
     </message>
     <message>
         <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/encoding.ui" line="609"/>
         <source>Normal</source>
-        <translation type="unfinished">Normal</translation>
+        <translation>Normal</translation>
     </message>
     <message>
         <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/encoding.ui" line="614"/>
         <source>Below Normal</source>
-        <translation type="unfinished">Unter Normal</translation>
+        <translation>Unter Normal</translation>
     </message>
     <message>
         <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/encoding.ui" line="619"/>
         <source>Low</source>
-        <translation type="unfinished">Niedrig</translation>
+        <translation>Niedrig</translation>
     </message>
 </context>
 <context>
@@ -12336,60 +12536,70 @@
     <message>
         <location filename="../plugins/ADM_videoFilters/Eq2/qt4/eq2.ui" line="13"/>
         <location filename="../plugins/build/ADM_videoFilters/Eq2/ui_eq2.h" line="484"/>
+        <location filename="../plugins/build64/ADM_videoFilters/Eq2/ui_eq2.h" line="484"/>
         <source>MPlayer eq2</source>
         <translation type="unfinished">MPlayer eq2</translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoFilters/Eq2/qt4/eq2.ui" line="41"/>
         <location filename="../plugins/build/ADM_videoFilters/Eq2/ui_eq2.h" line="485"/>
+        <location filename="../plugins/build64/ADM_videoFilters/Eq2/ui_eq2.h" line="485"/>
         <source>Contrast:</source>
         <translation type="unfinished"></translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoFilters/Eq2/qt4/eq2.ui" line="97"/>
         <location filename="../plugins/build/ADM_videoFilters/Eq2/ui_eq2.h" line="486"/>
+        <location filename="../plugins/build64/ADM_videoFilters/Eq2/ui_eq2.h" line="486"/>
         <source>Brightness:</source>
         <translation type="unfinished"></translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoFilters/Eq2/qt4/eq2.ui" line="153"/>
         <location filename="../plugins/build/ADM_videoFilters/Eq2/ui_eq2.h" line="487"/>
+        <location filename="../plugins/build64/ADM_videoFilters/Eq2/ui_eq2.h" line="487"/>
         <source>Saturation:</source>
         <translation type="unfinished"></translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoFilters/Eq2/qt4/eq2.ui" line="245"/>
         <location filename="../plugins/build/ADM_videoFilters/Eq2/ui_eq2.h" line="488"/>
+        <location filename="../plugins/build64/ADM_videoFilters/Eq2/ui_eq2.h" line="488"/>
         <source>Gamma</source>
         <translation type="unfinished">Gamma</translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoFilters/Eq2/qt4/eq2.ui" line="472"/>
         <location filename="../plugins/build/ADM_videoFilters/Eq2/ui_eq2.h" line="489"/>
+        <location filename="../plugins/build64/ADM_videoFilters/Eq2/ui_eq2.h" line="489"/>
         <source>Green</source>
         <translation type="unfinished"></translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoFilters/Eq2/qt4/eq2.ui" line="479"/>
         <location filename="../plugins/build/ADM_videoFilters/Eq2/ui_eq2.h" line="490"/>
+        <location filename="../plugins/build64/ADM_videoFilters/Eq2/ui_eq2.h" line="490"/>
         <source>Red</source>
         <translation type="unfinished"></translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoFilters/Eq2/qt4/eq2.ui" line="486"/>
         <location filename="../plugins/build/ADM_videoFilters/Eq2/ui_eq2.h" line="491"/>
+        <location filename="../plugins/build64/ADM_videoFilters/Eq2/ui_eq2.h" line="491"/>
         <source>Blue</source>
         <translation type="unfinished"></translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoFilters/Eq2/qt4/eq2.ui" line="493"/>
         <location filename="../plugins/build/ADM_videoFilters/Eq2/ui_eq2.h" line="492"/>
+        <location filename="../plugins/build64/ADM_videoFilters/Eq2/ui_eq2.h" line="492"/>
         <source>Weight</source>
         <translation type="unfinished"></translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoFilters/Eq2/qt4/eq2.ui" line="500"/>
         <location filename="../plugins/build/ADM_videoFilters/Eq2/ui_eq2.h" line="493"/>
+        <location filename="../plugins/build64/ADM_videoFilters/Eq2/ui_eq2.h" line="493"/>
         <source>Initial</source>
         <translation type="unfinished"></translation>
     </message>
@@ -12432,12 +12642,15 @@
         <location filename="../plugins/ADM_videoFilters/Hue/qt4/hue.ui" line="103"/>
         <location filename="../plugins/build/ADM_videoFilters/Hue/ui_hue.h" line="123"/>
         <location filename="../plugins/build/ADM_videoFilters/Hue/ui_hue.h" line="124"/>
+        <location filename="../plugins/build64/ADM_videoFilters/Hue/ui_hue.h" line="123"/>
+        <location filename="../plugins/build64/ADM_videoFilters/Hue/ui_hue.h" line="124"/>
         <source>Hue</source>
         <translation type="unfinished">Farbton</translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoFilters/Hue/qt4/hue.ui" line="123"/>
         <location filename="../plugins/build/ADM_videoFilters/Hue/ui_hue.h" line="125"/>
+        <location filename="../plugins/build64/ADM_videoFilters/Hue/ui_hue.h" line="125"/>
         <source>Saturation</source>
         <translation type="unfinished"></translation>
     </message>
@@ -12452,22 +12665,22 @@
     <message>
         <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/jobs.ui" line="50"/>
         <source>Delete Sel. Job</source>
-        <translation type="unfinished"></translation>
+        <translation>l?sche Job</translation>
     </message>
     <message>
         <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/jobs.ui" line="57"/>
         <source>Delete All Jobs</source>
-        <translation type="unfinished">Alle Jobs l?schen</translation>
+        <translation>Alle Jobs l?schen</translation>
     </message>
     <message>
         <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/jobs.ui" line="64"/>
         <source>Run All Jobs</source>
-        <translation type="unfinished"></translation>
+        <translation>Alle Jobs starten</translation>
     </message>
     <message>
         <location filename="../avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/jobs.ui" line="71"/>
         <source>Run Selected Job</source>
-        <translation type="unfinished"></translation>
+        <translation>gew?hlten Job starten</translation>
     </message>
 </context>
 <context>
@@ -12912,6 +13125,8 @@
         <location filename="../plugins/ADM_videoFilters/MplayerResize/qt4/resizing.ui" line="13"/>
         <location filename="../plugins/build/ADM_videoFilters/AvisynthResize/ui_resizing.h" line="387"/>
         <location filename="../plugins/build/ADM_videoFilters/MplayerResize/ui_resizing.h" line="387"/>
+        <location filename="../plugins/build64/ADM_videoFilters/AvisynthResize/ui_resizing.h" line="387"/>
+        <location filename="../plugins/build64/ADM_videoFilters/MplayerResize/ui_resizing.h" line="387"/>
         <source>Resize</source>
         <translation type="unfinished">Gr??e ?ndern</translation>
     </message>
@@ -12920,6 +13135,8 @@
         <location filename="../plugins/ADM_videoFilters/MplayerResize/qt4/resizing.ui" line="25"/>
         <location filename="../plugins/build/ADM_videoFilters/AvisynthResize/ui_resizing.h" line="388"/>
         <location filename="../plugins/build/ADM_videoFilters/MplayerResize/ui_resizing.h" line="388"/>
+        <location filename="../plugins/build64/ADM_videoFilters/AvisynthResize/ui_resizing.h" line="388"/>
+        <location filename="../plugins/build64/ADM_videoFilters/MplayerResize/ui_resizing.h" line="388"/>
         <source>Aspect Ratio</source>
         <translation type="unfinished"></translation>
     </message>
@@ -12928,6 +13145,8 @@
         <location filename="../plugins/ADM_videoFilters/MplayerResize/qt4/resizing.ui" line="37"/>
         <location filename="../plugins/build/ADM_videoFilters/AvisynthResize/ui_resizing.h" line="389"/>
         <location filename="../plugins/build/ADM_videoFilters/MplayerResize/ui_resizing.h" line="389"/>
+        <location filename="../plugins/build64/ADM_videoFilters/AvisynthResize/ui_resizing.h" line="389"/>
+        <location filename="../plugins/build64/ADM_videoFilters/MplayerResize/ui_resizing.h" line="389"/>
         <source>Lock Aspect Ratio</source>
         <translation type="unfinished"></translation>
     </message>
@@ -12936,6 +13155,8 @@
         <location filename="../plugins/ADM_videoFilters/MplayerResize/qt4/resizing.ui" line="55"/>
         <location filename="../plugins/build/ADM_videoFilters/AvisynthResize/ui_resizing.h" line="390"/>
         <location filename="../plugins/build/ADM_videoFilters/MplayerResize/ui_resizing.h" line="390"/>
+        <location filename="../plugins/build64/ADM_videoFilters/AvisynthResize/ui_resizing.h" line="390"/>
+        <location filename="../plugins/build64/ADM_videoFilters/MplayerResize/ui_resizing.h" line="390"/>
         <source>Source:</source>
         <translation type="unfinished"></translation>
     </message>
@@ -12948,6 +13169,10 @@
         <location filename="../plugins/build/ADM_videoFilters/AvisynthResize/ui_resizing.h" line="400"/>
         <location filename="../plugins/build/ADM_videoFilters/MplayerResize/ui_resizing.h" line="393"/>
         <location filename="../plugins/build/ADM_videoFilters/MplayerResize/ui_resizing.h" line="400"/>
+        <location filename="../plugins/build64/ADM_videoFilters/AvisynthResize/ui_resizing.h" line="393"/>
+        <location filename="../plugins/build64/ADM_videoFilters/AvisynthResize/ui_resizing.h" line="400"/>
+        <location filename="../plugins/build64/ADM_videoFilters/MplayerResize/ui_resizing.h" line="393"/>
+        <location filename="../plugins/build64/ADM_videoFilters/MplayerResize/ui_resizing.h" line="400"/>
         <source>1:1</source>
         <translation type="unfinished">1:1</translation>
     </message>
@@ -12960,6 +13185,10 @@
         <location filename="../plugins/build/ADM_videoFilters/AvisynthResize/ui_resizing.h" line="401"/>
         <location filename="../plugins/build/ADM_videoFilters/MplayerResize/ui_resizing.h" line="394"/>
         <location filename="../plugins/build/ADM_videoFilters/MplayerResize/ui_resizing.h" line="401"/>
+        <location filename="../plugins/build64/ADM_videoFilters/AvisynthResize/ui_resizing.h" line="394"/>
+        <location filename="../plugins/build64/ADM_videoFilters/AvisynthResize/ui_resizing.h" line="401"/>
+        <location filename="../plugins/build64/ADM_videoFilters/MplayerResize/ui_resizing.h" line="394"/>
+        <location filename="../plugins/build64/ADM_videoFilters/MplayerResize/ui_resizing.h" line="401"/>
         <source>4:3</source>
         <translation type="unfinished">4:3</translation>
     </message>
@@ -12972,6 +13201,10 @@
         <location filename="../plugins/build/ADM_videoFilters/AvisynthResize/ui_resizing.h" line="402"/>
         <location filename="../plugins/build/ADM_videoFilters/MplayerResize/ui_resizing.h" line="395"/>
         <location filename="../plugins/build/ADM_videoFilters/MplayerResize/ui_resizing.h" line="402"/>
+        <location filename="../plugins/build64/ADM_videoFilters/AvisynthResize/ui_resizing.h" line="395"/>
+        <location filename="../plugins/build64/ADM_videoFilters/AvisynthResize/ui_resizing.h" line="402"/>
+        <location filename="../plugins/build64/ADM_videoFilters/MplayerResize/ui_resizing.h" line="395"/>
+        <location filename="../plugins/build64/ADM_videoFilters/MplayerResize/ui_resizing.h" line="402"/>
         <source>16:9</source>
         <translation type="unfinished">16:9</translation>
     </message>
@@ -12980,6 +13213,8 @@
         <location filename="../plugins/ADM_videoFilters/MplayerResize/qt4/resizing.ui" line="97"/>
         <location filename="../plugins/build/ADM_videoFilters/AvisynthResize/ui_resizing.h" line="397"/>
         <location filename="../plugins/build/ADM_videoFilters/MplayerResize/ui_resizing.h" line="397"/>
+        <location filename="../plugins/build64/ADM_videoFilters/AvisynthResize/ui_resizing.h" line="397"/>
+        <location filename="../plugins/build64/ADM_videoFilters/MplayerResize/ui_resizing.h" line="397"/>
         <source>Destination:</source>
         <translation type="unfinished"></translation>
     </message>
@@ -12988,6 +13223,8 @@
         <location filename="../plugins/ADM_videoFilters/MplayerResize/qt4/resizing.ui" line="141"/>
         <location filename="../plugins/build/ADM_videoFilters/AvisynthResize/ui_resizing.h" line="404"/>
         <location filename="../plugins/build/ADM_videoFilters/MplayerResize/ui_resizing.h" line="404"/>
+        <location filename="../plugins/build64/ADM_videoFilters/AvisynthResize/ui_resizing.h" line="404"/>
+        <location filename="../plugins/build64/ADM_videoFilters/MplayerResize/ui_resizing.h" line="404"/>
         <source>Resize Dimensions</source>
         <translation type="unfinished"></translation>
     </message>
@@ -12996,6 +13233,8 @@
         <location filename="../plugins/ADM_videoFilters/MplayerResize/qt4/resizing.ui" line="161"/>
         <location filename="../plugins/build/ADM_videoFilters/AvisynthResize/ui_resizing.h" line="405"/>
         <location filename="../plugins/build/ADM_videoFilters/MplayerResize/ui_resizing.h" line="405"/>
+        <location filename="../plugins/build64/ADM_videoFilters/AvisynthResize/ui_resizing.h" line="405"/>
+        <location filename="../plugins/build64/ADM_videoFilters/MplayerResize/ui_resizing.h" line="405"/>
         <source>Width:</source>
         <translation type="unfinished"></translation>
     </message>
@@ -13004,6 +13243,8 @@
         <location filename="../plugins/ADM_videoFilters/MplayerResize/qt4/resizing.ui" line="197"/>
         <location filename="../plugins/build/ADM_videoFilters/AvisynthResize/ui_resizing.h" line="406"/>
         <location filename="../plugins/build/ADM_videoFilters/MplayerResize/ui_resizing.h" line="406"/>
+        <location filename="../plugins/build64/ADM_videoFilters/AvisynthResize/ui_resizing.h" line="406"/>
+        <location filename="../plugins/build64/ADM_videoFilters/MplayerResize/ui_resizing.h" line="406"/>
         <source>Height:</source>
         <translation type="unfinished"></translation>
     </message>
@@ -13012,6 +13253,8 @@
         <location filename="../plugins/ADM_videoFilters/MplayerResize/qt4/resizing.ui" line="232"/>
         <location filename="../plugins/build/ADM_videoFilters/AvisynthResize/ui_resizing.h" line="407"/>
         <location filename="../plugins/build/ADM_videoFilters/MplayerResize/ui_resizing.h" line="407"/>
+        <location filename="../plugins/build64/ADM_videoFilters/AvisynthResize/ui_resizing.h" line="407"/>
+        <location filename="../plugins/build64/ADM_videoFilters/MplayerResize/ui_resizing.h" line="407"/>
         <source>Round to the Nearest Multiple of 16</source>
         <translation type="unfinished"></translation>
     </message>
@@ -13020,6 +13263,8 @@
         <location filename="../plugins/ADM_videoFilters/MplayerResize/qt4/resizing.ui" line="287"/>
         <location filename="../plugins/build/ADM_videoFilters/AvisynthResize/ui_resizing.h" line="408"/>
         <location filename="../plugins/build/ADM_videoFilters/MplayerResize/ui_resizing.h" line="408"/>
+        <location filename="../plugins/build64/ADM_videoFilters/AvisynthResize/ui_resizing.h" line="408"/>
+        <location filename="../plugins/build64/ADM_videoFilters/MplayerResize/ui_resizing.h" line="408"/>
         <source>1%</source>
         <translation type="unfinished">1%</translation>
     </message>
@@ -13028,6 +13273,8 @@
         <location filename="../plugins/ADM_videoFilters/MplayerResize/qt4/resizing.ui" line="307"/>
         <location filename="../plugins/build/ADM_videoFilters/AvisynthResize/ui_resizing.h" line="409"/>
         <location filename="../plugins/build/ADM_videoFilters/MplayerResize/ui_resizing.h" line="409"/>
+        <location filename="../plugins/build64/ADM_videoFilters/AvisynthResize/ui_resizing.h" line="409"/>
+        <location filename="../plugins/build64/ADM_videoFilters/MplayerResize/ui_resizing.h" line="409"/>
         <source>Percent</source>
         <translation type="unfinished"></translation>
     </message>
@@ -13036,6 +13283,8 @@
         <location filename="../plugins/ADM_videoFilters/MplayerResize/qt4/resizing.ui" line="327"/>
         <location filename="../plugins/build/ADM_videoFilters/AvisynthResize/ui_resizing.h" line="410"/>
         <location filename="../plugins/build/ADM_videoFilters/MplayerResize/ui_resizing.h" line="410"/>
+        <location filename="../plugins/build64/ADM_videoFilters/AvisynthResize/ui_resizing.h" line="410"/>
+        <location filename="../plugins/build64/ADM_videoFilters/MplayerResize/ui_resizing.h" line="410"/>
         <source>200%</source>
         <translation type="unfinished">200%</translation>
     </message>
@@ -13044,6 +13293,8 @@
         <location filename="../plugins/ADM_videoFilters/MplayerResize/qt4/resizing.ui" line="377"/>
         <location filename="../plugins/build/ADM_videoFilters/AvisynthResize/ui_resizing.h" line="411"/>
         <location filename="../plugins/build/ADM_videoFilters/MplayerResize/ui_resizing.h" line="411"/>
+        <location filename="../plugins/build64/ADM_videoFilters/AvisynthResize/ui_resizing.h" line="411"/>
+        <location filename="../plugins/build64/ADM_videoFilters/MplayerResize/ui_resizing.h" line="411"/>
         <source>Error X / Y:</source>
         <translation type="unfinished"></translation>
     </message>
@@ -13052,6 +13303,8 @@
         <location filename="../plugins/ADM_videoFilters/MplayerResize/qt4/resizing.ui" line="384"/>
         <location filename="../plugins/build/ADM_videoFilters/AvisynthResize/ui_resizing.h" line="412"/>
         <location filename="../plugins/build/ADM_videoFilters/MplayerResize/ui_resizing.h" line="412"/>
+        <location filename="../plugins/build64/ADM_videoFilters/AvisynthResize/ui_resizing.h" line="412"/>
+        <location filename="../plugins/build64/ADM_videoFilters/MplayerResize/ui_resizing.h" line="412"/>
         <source>0.00 / 0.00</source>
         <translation type="unfinished"></translation>
     </message>
@@ -13060,6 +13313,8 @@
         <location filename="../plugins/ADM_videoFilters/MplayerResize/qt4/resizing.ui" line="435"/>
         <location filename="../plugins/build/ADM_videoFilters/AvisynthResize/ui_resizing.h" line="413"/>
         <location filename="../plugins/build/ADM_videoFilters/MplayerResize/ui_resizing.h" line="413"/>
+        <location filename="../plugins/build64/ADM_videoFilters/AvisynthResize/ui_resizing.h" line="413"/>
+        <location filename="../plugins/build64/ADM_videoFilters/MplayerResize/ui_resizing.h" line="413"/>
         <source>Resize Method:</source>
         <translation type="unfinished"></translation>
     </message>
@@ -13068,6 +13323,8 @@
         <location filename="../plugins/ADM_videoFilters/MplayerResize/qt4/resizing.ui" line="443"/>
         <location filename="../plugins/build/ADM_videoFilters/AvisynthResize/ui_resizing.h" line="416"/>
         <location filename="../plugins/build/ADM_videoFilters/MplayerResize/ui_resizing.h" line="416"/>
+        <location filename="../plugins/build64/ADM_videoFilters/AvisynthResize/ui_resizing.h" line="416"/>
+        <location filename="../plugins/build64/ADM_videoFilters/MplayerResize/ui_resizing.h" line="416"/>
         <source>Bilinear</source>
         <translation type="unfinished">Bi-linear</translation>
     </message>
@@ -13076,6 +13333,8 @@
         <location filename="../plugins/ADM_videoFilters/MplayerResize/qt4/resizing.ui" line="448"/>
         <location filename="../plugins/build/ADM_videoFilters/AvisynthResize/ui_resizing.h" line="417"/>
         <location filename="../plugins/build/ADM_videoFilters/MplayerResize/ui_resizing.h" line="417"/>
+        <location filename="../plugins/build64/ADM_videoFilters/AvisynthResize/ui_resizing.h" line="417"/>
+        <location filename="../plugins/build64/ADM_videoFilters/MplayerResize/ui_resizing.h" line="417"/>
         <source>Bicubic</source>
         <translation type="unfinished">Bi-kubisch</translation>
     </message>
@@ -13084,6 +13343,8 @@
         <location filename="../plugins/ADM_videoFilters/MplayerResize/qt4/resizing.ui" line="453"/>
         <location filename="../plugins/build/ADM_videoFilters/AvisynthResize/ui_resizing.h" line="418"/>
         <location filename="../plugins/build/ADM_videoFilters/MplayerResize/ui_resizing.h" line="418"/>
+        <location filename="../plugins/build64/ADM_videoFilters/AvisynthResize/ui_resizing.h" line="418"/>
+        <location filename="../plugins/build64/ADM_videoFilters/MplayerResize/ui_resizing.h" line="418"/>
         <source>Lanzcos3</source>
         <translation type="unfinished"></translation>
     </message>
@@ -13110,12 +13371,14 @@
     <message>
         <location filename="../plugins/ADM_videoFilters/Srt/qt4/srt.ui" line="13"/>
         <location filename="../plugins/build/ADM_videoFilters/Srt/ui_srt.h" line="106"/>
+        <location filename="../plugins/build64/ADM_videoFilters/Srt/ui_srt.h" line="106"/>
         <source>Subtitle Font Size and Position</source>
         <translation type="unfinished"></translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoFilters/Srt/qt4/srt.ui" line="89"/>
         <location filename="../plugins/build/ADM_videoFilters/Srt/ui_srt.h" line="107"/>
+        <location filename="../plugins/build64/ADM_videoFilters/Srt/ui_srt.h" line="107"/>
         <source>Font Size :</source>
         <translation type="unfinished"></translation>
     </message>
@@ -13277,12 +13540,14 @@
     <message>
         <location filename="../plugins/ADM_videoEncoder/ADM_vidEnc_x264/qt4/x264ConfigDialog.ui" line="14"/>
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3079"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3094"/>
         <source>x264 Configuraton</source>
         <translation type="unfinished"></translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoEncoder/ADM_vidEnc_x264/qt4/x264ConfigDialog.ui" line="50"/>
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3080"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3095"/>
         <source>Configuration:</source>
         <translation type="unfinished"></translation>
     </message>
@@ -13290,6 +13555,7 @@
         <location filename="../plugins/ADM_videoEncoder/ADM_vidEnc_x264/qt4/x264ConfigDialog.ui" line="67"/>
         <location filename="../plugins/ADM_videoEncoder/ADM_vidEnc_x264/qt4/x264ConfigDialog.cpp" line="292"/>
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3081"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3096"/>
         <source>Save As</source>
         <translation type="unfinished"></translation>
     </message>
@@ -13298,18 +13564,22 @@
         <location filename="../plugins/ADM_videoEncoder/ADM_vidEnc_x264/qt4/x264ConfigDialog.ui" line="3311"/>
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3082"/>
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3240"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3097"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3254"/>
         <source>Delete</source>
         <translation type="unfinished"></translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoEncoder/ADM_vidEnc_x264/qt4/x264ConfigDialog.ui" line="116"/>
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3110"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3124"/>
         <source>General</source>
         <translation type="unfinished"></translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoEncoder/ADM_vidEnc_x264/qt4/x264ConfigDialog.ui" line="128"/>
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3083"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3098"/>
         <source>Rate Control</source>
         <translation type="unfinished">Bitraten-Kontrolle</translation>
     </message>
@@ -13317,42 +13587,49 @@
         <location filename="../plugins/ADM_videoEncoder/ADM_vidEnc_x264/qt4/x264ConfigDialog.ui" line="148"/>
         <location filename="../plugins/ADM_videoEncoder/ADM_vidEnc_x264/qt4/x264ConfigDialog.cpp" line="358"/>
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3084"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3099"/>
         <source>Target Video Size:</source>
         <translation type="unfinished"></translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoEncoder/ADM_vidEnc_x264/qt4/x264ConfigDialog.ui" line="167"/>
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3087"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3102"/>
         <source>Constant Bitrate (Single Pass)</source>
         <translation type="unfinished"></translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoEncoder/ADM_vidEnc_x264/qt4/x264ConfigDialog.ui" line="172"/>
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3088"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3103"/>
         <source>Constant Quantiser (Single Pass)</source>
         <translation type="unfinished"></translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoEncoder/ADM_vidEnc_x264/qt4/x264ConfigDialog.ui" line="177"/>
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3089"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3104"/>
         <source>Constant Rate Factor (Single Pass)</source>
         <translation type="unfinished"></translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoEncoder/ADM_vidEnc_x264/qt4/x264ConfigDialog.ui" line="182"/>
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3090"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3105"/>
         <source>Video Size (Two Pass)</source>
         <translation type="unfinished"></translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoEncoder/ADM_vidEnc_x264/qt4/x264ConfigDialog.ui" line="187"/>
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3091"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3106"/>
         <source>Average Bitrate (Two Pass)</source>
         <translation type="unfinished"></translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoEncoder/ADM_vidEnc_x264/qt4/x264ConfigDialog.ui" line="210"/>
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3093"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3108"/>
         <source>Encoding Mode:</source>
         <translation type="unfinished"></translation>
     </message>
@@ -13360,12 +13637,14 @@
         <location filename="../plugins/ADM_videoEncoder/ADM_vidEnc_x264/qt4/x264ConfigDialog.ui" line="238"/>
         <location filename="../plugins/ADM_videoEncoder/ADM_vidEnc_x264/qt4/x264ConfigDialog.cpp" line="359"/>
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3095"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3110"/>
         <source>MB</source>
         <translation type="unfinished"></translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoEncoder/ADM_vidEnc_x264/qt4/x264ConfigDialog.ui" line="313"/>
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3096"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3111"/>
         <source>0 (High Quality)</source>
         <translation type="unfinished"></translation>
     </message>
@@ -13374,24 +13653,29 @@
         <location filename="../plugins/ADM_videoEncoder/ADM_vidEnc_x264/qt4/x264ConfigDialog.ui" line="2323"/>
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3097"/>
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3224"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3112"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3238"/>
         <source>Quantiser</source>
         <translation type="unfinished"></translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoEncoder/ADM_vidEnc_x264/qt4/x264ConfigDialog.ui" line="359"/>
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3098"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3113"/>
         <source>51 (Low Quality)</source>
         <translation type="unfinished"></translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoEncoder/ADM_vidEnc_x264/qt4/x264ConfigDialog.ui" line="428"/>
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3099"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3114"/>
         <source>Macroblock-Tree Rate Control</source>
         <translation type="unfinished"></translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoEncoder/ADM_vidEnc_x264/qt4/x264ConfigDialog.ui" line="443"/>
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3100"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3115"/>
         <source>Frametype Lookahead:</source>
         <translation type="unfinished"></translation>
     </message>
@@ -13400,24 +13684,29 @@
         <location filename="../plugins/ADM_videoEncoder/ADM_vidEnc_x264/qt4/x264ConfigDialog.ui" line="606"/>
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3101"/>
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3109"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3116"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3123"/>
         <source>frames</source>
         <translation type="unfinished"></translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoEncoder/ADM_vidEnc_x264/qt4/x264ConfigDialog.ui" line="482"/>
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3102"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3117"/>
         <source>Multithreading</source>
         <translation type="unfinished"></translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoEncoder/ADM_vidEnc_x264/qt4/x264ConfigDialog.ui" line="502"/>
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3103"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3118"/>
         <source>Disable</source>
         <translation type="unfinished">Deaktivieren</translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoEncoder/ADM_vidEnc_x264/qt4/x264ConfigDialog.ui" line="509"/>
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3104"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3119"/>
         <source>Auto-detect</source>
         <translation type="unfinished">Auto-Erkennung</translation>
     </message>
@@ -13426,12 +13715,15 @@
         <location filename="../plugins/ADM_videoEncoder/ADM_vidEnc_x264/qt4/x264ConfigDialog.ui" line="3584"/>
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3105"/>
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3275"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3120"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3289"/>
         <source>Custom:</source>
         <translation type="unfinished"></translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoEncoder/ADM_vidEnc_x264/qt4/x264ConfigDialog.ui" line="564"/>
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3106"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3121"/>
         <source>Enforce Repeatability</source>
         <translation type="unfinished"></translation>
     </message>
@@ -13444,102 +13736,119 @@
     <message>
         <location filename="../plugins/ADM_videoEncoder/ADM_vidEnc_x264/qt4/x264ConfigDialog.ui" line="586"/>
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3108"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3122"/>
         <source>Custom Threaded Lookahead Buffer:</source>
         <translation type="unfinished"></translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoEncoder/ADM_vidEnc_x264/qt4/x264ConfigDialog.ui" line="645"/>
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3146"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3160"/>
         <source>Motion</source>
         <translation type="unfinished"></translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoEncoder/ADM_vidEnc_x264/qt4/x264ConfigDialog.ui" line="657"/>
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3111"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3125"/>
         <source>Motion Estimation</source>
         <translation type="unfinished">Absch?tzung der Bewegung</translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoEncoder/ADM_vidEnc_x264/qt4/x264ConfigDialog.ui" line="677"/>
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3112"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3126"/>
         <source>Motion Estimation Method:</source>
         <translation type="unfinished"></translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoEncoder/ADM_vidEnc_x264/qt4/x264ConfigDialog.ui" line="696"/>
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3115"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3129"/>
         <source>Diamond Search</source>
         <translation type="unfinished">Sternf?rmig suchen</translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoEncoder/ADM_vidEnc_x264/qt4/x264ConfigDialog.ui" line="701"/>
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3116"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3130"/>
         <source>Hexagonal Search</source>
         <translation type="unfinished">Hexagonal suchen</translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoEncoder/ADM_vidEnc_x264/qt4/x264ConfigDialog.ui" line="706"/>
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3117"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3131"/>
         <source>Uneven Multi-hexagonal Search</source>
         <translation type="unfinished"></translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoEncoder/ADM_vidEnc_x264/qt4/x264ConfigDialog.ui" line="711"/>
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3118"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3132"/>
         <source>Exhaustive Search</source>
         <translation type="unfinished">Vollst?ndige Suche</translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoEncoder/ADM_vidEnc_x264/qt4/x264ConfigDialog.ui" line="716"/>
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3119"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3133"/>
         <source>Hadamard Exhaustive Search</source>
         <translation type="unfinished">&quot;Hadamard&quot; vollst?ndige Suche</translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoEncoder/ADM_vidEnc_x264/qt4/x264ConfigDialog.ui" line="773"/>
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3121"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3135"/>
         <source>1 (Fast)</source>
         <translation type="unfinished"></translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoEncoder/ADM_vidEnc_x264/qt4/x264ConfigDialog.ui" line="793"/>
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3122"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3136"/>
         <source>Subpixel Refinement</source>
         <translation type="unfinished"></translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoEncoder/ADM_vidEnc_x264/qt4/x264ConfigDialog.ui" line="813"/>
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3123"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3137"/>
         <source>9 (Best)</source>
         <translation type="unfinished"></translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoEncoder/ADM_vidEnc_x264/qt4/x264ConfigDialog.ui" line="893"/>
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3124"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3138"/>
         <source>Motion Vector</source>
         <translation type="unfinished"></translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoEncoder/ADM_vidEnc_x264/qt4/x264ConfigDialog.ui" line="949"/>
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3125"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3139"/>
         <source>Maximum Motion Vector Length:</source>
         <translation type="unfinished"></translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoEncoder/ADM_vidEnc_x264/qt4/x264ConfigDialog.ui" line="1031"/>
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3126"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3140"/>
         <source>Minimum Buffer Between Threads:</source>
         <translation type="unfinished"></translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoEncoder/ADM_vidEnc_x264/qt4/x264ConfigDialog.ui" line="1038"/>
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3127"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3141"/>
         <source>Maximum Motion Vector Search Range:</source>
         <translation type="unfinished"></translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoEncoder/ADM_vidEnc_x264/qt4/x264ConfigDialog.ui" line="1050"/>
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3128"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3142"/>
         <source>Prediction</source>
         <translation type="unfinished"></translation>
     </message>
@@ -13550,48 +13859,58 @@
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3131"/>
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3166"/>
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3172"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3145"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3180"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3186"/>
         <source>Disabled</source>
         <translation type="unfinished"></translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoEncoder/ADM_vidEnc_x264/qt4/x264ConfigDialog.ui" line="1084"/>
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3132"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3146"/>
         <source>Blind Offset</source>
         <translation type="unfinished"></translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoEncoder/ADM_vidEnc_x264/qt4/x264ConfigDialog.ui" line="1089"/>
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3133"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3147"/>
         <source>Smart Analysis</source>
         <translation type="unfinished"></translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoEncoder/ADM_vidEnc_x264/qt4/x264ConfigDialog.ui" line="1112"/>
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3135"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3149"/>
         <source>Direct Prediction Mode:</source>
         <translation type="unfinished"></translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoEncoder/ADM_vidEnc_x264/qt4/x264ConfigDialog.ui" line="1119"/>
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3136"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3150"/>
         <source>Weighted Prediction for P-frames:</source>
         <translation type="unfinished"></translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoEncoder/ADM_vidEnc_x264/qt4/x264ConfigDialog.ui" line="1138"/>
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3139"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3153"/>
         <source>None</source>
         <translation type="unfinished">Keine</translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoEncoder/ADM_vidEnc_x264/qt4/x264ConfigDialog.ui" line="1143"/>
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3140"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3154"/>
         <source>Spatial</source>
         <translation type="unfinished">r?umlich</translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoEncoder/ADM_vidEnc_x264/qt4/x264ConfigDialog.ui" line="1148"/>
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3141"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3155"/>
         <source>Temporal</source>
         <translation type="unfinished">zeitlich</translation>
     </message>
@@ -13600,96 +13919,113 @@
         <location filename="../plugins/ADM_videoEncoder/ADM_vidEnc_x264/qt4/x264ConfigDialog.ui" line="3383"/>
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3142"/>
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3245"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3156"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3259"/>
         <source>Auto</source>
         <translation type="unfinished">Auto</translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoEncoder/ADM_vidEnc_x264/qt4/x264ConfigDialog.ui" line="1178"/>
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3144"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3158"/>
         <source>Weighted Prediction for B-frames</source>
         <translation type="unfinished"></translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoEncoder/ADM_vidEnc_x264/qt4/x264ConfigDialog.ui" line="1185"/>
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3145"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3159"/>
         <source>Constrained Intra Prediction</source>
         <translation type="unfinished"></translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoEncoder/ADM_vidEnc_x264/qt4/x264ConfigDialog.ui" line="1209"/>
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3154"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3168"/>
         <source>Partition</source>
         <translation type="unfinished"></translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoEncoder/ADM_vidEnc_x264/qt4/x264ConfigDialog.ui" line="1221"/>
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3147"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3161"/>
         <source>Partition Search</source>
         <translation type="unfinished"></translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoEncoder/ADM_vidEnc_x264/qt4/x264ConfigDialog.ui" line="1241"/>
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3148"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3162"/>
         <source>8x8 DCT Spatial Transform</source>
         <translation type="unfinished"></translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoEncoder/ADM_vidEnc_x264/qt4/x264ConfigDialog.ui" line="1248"/>
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3149"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3163"/>
         <source>8x8, 8x16 and 16x8 P-frame Intra-predicted Blocks</source>
         <translation type="unfinished"></translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoEncoder/ADM_vidEnc_x264/qt4/x264ConfigDialog.ui" line="1255"/>
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3150"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3164"/>
         <source>8x8, 8x16 and 16x8 B-frame Intra-predicted Blocks</source>
         <translation type="unfinished"></translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoEncoder/ADM_vidEnc_x264/qt4/x264ConfigDialog.ui" line="1262"/>
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3151"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3165"/>
         <source>4x4, 4x8 and 8x4 P-frame Intra-predicted Blocks</source>
         <translation type="unfinished"></translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoEncoder/ADM_vidEnc_x264/qt4/x264ConfigDialog.ui" line="1269"/>
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3152"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3166"/>
         <source>8x8 Intra-predicted Blocks</source>
         <translation type="unfinished"></translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoEncoder/ADM_vidEnc_x264/qt4/x264ConfigDialog.ui" line="1276"/>
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3153"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3167"/>
         <source>4x4 Intra-predicted Blocks</source>
         <translation type="unfinished"></translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoEncoder/ADM_vidEnc_x264/qt4/x264ConfigDialog.ui" line="1302"/>
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3184"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3198"/>
         <source>Frame</source>
         <translation type="unfinished"></translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoEncoder/ADM_vidEnc_x264/qt4/x264ConfigDialog.ui" line="1314"/>
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3155"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3169"/>
         <source>Frame Encoding</source>
         <translation type="unfinished"></translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoEncoder/ADM_vidEnc_x264/qt4/x264ConfigDialog.ui" line="1326"/>
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3156"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3170"/>
         <source>CABAC</source>
         <translation type="unfinished">CABAC</translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoEncoder/ADM_vidEnc_x264/qt4/x264ConfigDialog.ui" line="1333"/>
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3157"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3171"/>
         <source>Pure Interlaced Mode</source>
         <translation type="unfinished"></translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoEncoder/ADM_vidEnc_x264/qt4/x264ConfigDialog.ui" line="1348"/>
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3158"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3172"/>
         <source>Loop Filter</source>
         <translation type="unfinished"></translation>
     </message>
@@ -13698,102 +14034,120 @@
         <location filename="../plugins/ADM_videoEncoder/ADM_vidEnc_x264/qt4/x264ConfigDialog.ui" line="2888"/>
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3159"/>
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3223"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3173"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3237"/>
         <source>Strength:</source>
         <translation type="unfinished"></translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoEncoder/ADM_vidEnc_x264/qt4/x264ConfigDialog.ui" line="1429"/>
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3160"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3174"/>
         <source>Threshold:</source>
         <translation type="unfinished"></translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoEncoder/ADM_vidEnc_x264/qt4/x264ConfigDialog.ui" line="1495"/>
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3161"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3175"/>
         <source>Maximum Reference Frames:</source>
         <translation type="unfinished"></translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoEncoder/ADM_vidEnc_x264/qt4/x264ConfigDialog.ui" line="1543"/>
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3162"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3176"/>
         <source>B-frames</source>
         <translation type="unfinished"></translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoEncoder/ADM_vidEnc_x264/qt4/x264ConfigDialog.ui" line="1555"/>
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3163"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3177"/>
         <source>B-frames as References:</source>
         <translation type="unfinished"></translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoEncoder/ADM_vidEnc_x264/qt4/x264ConfigDialog.ui" line="1576"/>
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3167"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3181"/>
         <source>Strictly Hierarchical Pyramid</source>
         <translation type="unfinished"></translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoEncoder/ADM_vidEnc_x264/qt4/x264ConfigDialog.ui" line="1581"/>
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3168"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3182"/>
         <source>Non-strict (Not Blu-ray Compatible)</source>
         <translation type="unfinished"></translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoEncoder/ADM_vidEnc_x264/qt4/x264ConfigDialog.ui" line="1618"/>
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3173"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3187"/>
         <source>Fast</source>
         <translation type="unfinished">Schnell</translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoEncoder/ADM_vidEnc_x264/qt4/x264ConfigDialog.ui" line="1623"/>
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3174"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3188"/>
         <source>Optimal</source>
         <translation type="unfinished"></translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoEncoder/ADM_vidEnc_x264/qt4/x264ConfigDialog.ui" line="1715"/>
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3176"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3190"/>
         <source>B-frame Bias:</source>
         <translation type="unfinished"></translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoEncoder/ADM_vidEnc_x264/qt4/x264ConfigDialog.ui" line="1722"/>
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3177"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3191"/>
         <source>Maximum Consecutive B-frames:</source>
         <translation type="unfinished"></translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoEncoder/ADM_vidEnc_x264/qt4/x264ConfigDialog.ui" line="1729"/>
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3178"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3192"/>
         <source>Adaptive B-frame Decision:</source>
         <translation type="unfinished"></translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoEncoder/ADM_vidEnc_x264/qt4/x264ConfigDialog.ui" line="1739"/>
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3179"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3193"/>
         <source>I-frames</source>
         <translation type="unfinished"></translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoEncoder/ADM_vidEnc_x264/qt4/x264ConfigDialog.ui" line="1803"/>
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3180"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3194"/>
         <source>Maximum GOP Size:</source>
         <translation type="unfinished"></translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoEncoder/ADM_vidEnc_x264/qt4/x264ConfigDialog.ui" line="1810"/>
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3181"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3195"/>
         <source>I-frame Threshold:</source>
         <translation type="unfinished"></translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoEncoder/ADM_vidEnc_x264/qt4/x264ConfigDialog.ui" line="1856"/>
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3182"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3196"/>
         <source>Minimum GOP Size:</source>
         <translation type="unfinished"></translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoEncoder/ADM_vidEnc_x264/qt4/x264ConfigDialog.ui" line="1917"/>
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3183"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3197"/>
         <source>Pre-scenecut Detection</source>
         <translation type="unfinished"></translation>
     </message>
@@ -13802,102 +14156,120 @@
         <location filename="../plugins/ADM_videoEncoder/ADM_vidEnc_x264/qt4/x264ConfigDialog.ui" line="1955"/>
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3185"/>
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3206"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3199"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3220"/>
         <source>Analysis</source>
         <translation type="unfinished"></translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoEncoder/ADM_vidEnc_x264/qt4/x264ConfigDialog.ui" line="1967"/>
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3186"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3200"/>
         <source>Mixed References</source>
         <translation type="unfinished"></translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoEncoder/ADM_vidEnc_x264/qt4/x264ConfigDialog.ui" line="1974"/>
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3187"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3201"/>
         <source>Chroma Motion Estimation</source>
         <translation type="unfinished"></translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoEncoder/ADM_vidEnc_x264/qt4/x264ConfigDialog.ui" line="1989"/>
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3188"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3202"/>
         <source>Trellis Quantization:</source>
         <translation type="unfinished"></translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoEncoder/ADM_vidEnc_x264/qt4/x264ConfigDialog.ui" line="2000"/>
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3191"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3205"/>
         <source>Final Macroblock Only</source>
         <translation type="unfinished"></translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoEncoder/ADM_vidEnc_x264/qt4/x264ConfigDialog.ui" line="2005"/>
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3192"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3206"/>
         <source>Always On</source>
         <translation type="unfinished"></translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoEncoder/ADM_vidEnc_x264/qt4/x264ConfigDialog.ui" line="2028"/>
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3194"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3208"/>
         <source>Fast Skip Detection on P-frames</source>
         <translation type="unfinished"></translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoEncoder/ADM_vidEnc_x264/qt4/x264ConfigDialog.ui" line="2035"/>
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3195"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3209"/>
         <source>DCT Decimation on P-frames</source>
         <translation type="unfinished"></translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoEncoder/ADM_vidEnc_x264/qt4/x264ConfigDialog.ui" line="2050"/>
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3196"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3210"/>
         <source>Psychovisual Rate Distortion Optimisation:</source>
         <translation type="unfinished"></translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoEncoder/ADM_vidEnc_x264/qt4/x264ConfigDialog.ui" line="2090"/>
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3197"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3211"/>
         <source>Noise Reduction:</source>
         <translation type="unfinished"></translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoEncoder/ADM_vidEnc_x264/qt4/x264ConfigDialog.ui" line="2122"/>
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3198"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3212"/>
         <source>Luma Quantisation Deadzone</source>
         <translation type="unfinished"></translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoEncoder/ADM_vidEnc_x264/qt4/x264ConfigDialog.ui" line="2142"/>
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3199"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3213"/>
         <source>Intra Luma Quantisation Deadzone:</source>
         <translation type="unfinished"></translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoEncoder/ADM_vidEnc_x264/qt4/x264ConfigDialog.ui" line="2149"/>
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3200"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3214"/>
         <source>Inter Luma Quantisation Deadzone:</source>
         <translation type="unfinished"></translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoEncoder/ADM_vidEnc_x264/qt4/x264ConfigDialog.ui" line="2227"/>
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3201"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3215"/>
         <source>Quantisation Matrix</source>
         <translation type="unfinished"></translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoEncoder/ADM_vidEnc_x264/qt4/x264ConfigDialog.ui" line="2247"/>
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3202"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3216"/>
         <source>Flat Matrix</source>
         <translation type="unfinished">breite Matrix</translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoEncoder/ADM_vidEnc_x264/qt4/x264ConfigDialog.ui" line="2257"/>
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3203"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3217"/>
         <source>JVT Matrix</source>
         <translation type="unfinished">JVT Matrix</translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoEncoder/ADM_vidEnc_x264/qt4/x264ConfigDialog.ui" line="2272"/>
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3204"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3218"/>
         <source>Custom Matrix</source>
         <translation type="unfinished">Individuelle Matrix</translation>
     </message>
@@ -13906,24 +14278,29 @@
         <location filename="../plugins/ADM_videoEncoder/ADM_vidEnc_x264/qt4/x264ConfigDialog.ui" line="3304"/>
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3205"/>
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3239"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3219"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3253"/>
         <source>Edit</source>
         <translation type="unfinished"></translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoEncoder/ADM_vidEnc_x264/qt4/x264ConfigDialog.ui" line="2335"/>
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3207"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3221"/>
         <source>Quantiser Control</source>
         <translation type="unfinished"></translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoEncoder/ADM_vidEnc_x264/qt4/x264ConfigDialog.ui" line="2388"/>
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3208"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3222"/>
         <source>Maximum Quantiser:</source>
         <translation type="unfinished"></translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoEncoder/ADM_vidEnc_x264/qt4/x264ConfigDialog.ui" line="2395"/>
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3209"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3223"/>
         <source>I and P-frame Quantiser Ratio:</source>
         <translation type="unfinished"></translation>
     </message>
@@ -13934,102 +14311,121 @@
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3210"/>
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3218"/>
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3229"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3224"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3232"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3243"/>
         <source>%</source>
         <translation type="unfinished"></translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoEncoder/ADM_vidEnc_x264/qt4/x264ConfigDialog.ui" line="2520"/>
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3211"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3225"/>
         <source>Maximum Quantiser Step:</source>
         <translation type="unfinished"></translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoEncoder/ADM_vidEnc_x264/qt4/x264ConfigDialog.ui" line="2560"/>
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3212"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3226"/>
         <source>P and B-frame Quantiser Ratio:</source>
         <translation type="unfinished"></translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoEncoder/ADM_vidEnc_x264/qt4/x264ConfigDialog.ui" line="2567"/>
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3213"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3227"/>
         <source>Average Bitrate Tolerance:</source>
         <translation type="unfinished"></translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoEncoder/ADM_vidEnc_x264/qt4/x264ConfigDialog.ui" line="2574"/>
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3214"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3228"/>
         <source>Chroma to Luma Quantiser Offset:</source>
         <translation type="unfinished"></translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoEncoder/ADM_vidEnc_x264/qt4/x264ConfigDialog.ui" line="2617"/>
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3215"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3229"/>
         <source>Minimum Quantiser:</source>
         <translation type="unfinished"></translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoEncoder/ADM_vidEnc_x264/qt4/x264ConfigDialog.ui" line="2671"/>
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3216"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3230"/>
         <source>Quantiser Curve Compression</source>
         <translation type="unfinished"></translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoEncoder/ADM_vidEnc_x264/qt4/x264ConfigDialog.ui" line="2691"/>
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3217"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3231"/>
         <source>Quantiser Curve Compression:</source>
         <translation type="unfinished"></translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoEncoder/ADM_vidEnc_x264/qt4/x264ConfigDialog.ui" line="2748"/>
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3219"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3233"/>
         <source>Reduce Fluctuation Before Curve Compression:</source>
         <translation type="unfinished"></translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoEncoder/ADM_vidEnc_x264/qt4/x264ConfigDialog.ui" line="2830"/>
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3220"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3234"/>
         <source>Reduce Fluctuation After Curve Compression:</source>
         <translation type="unfinished"></translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoEncoder/ADM_vidEnc_x264/qt4/x264ConfigDialog.ui" line="2842"/>
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3221"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3235"/>
         <source>Adaptive Quantisation</source>
         <translation type="unfinished"></translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoEncoder/ADM_vidEnc_x264/qt4/x264ConfigDialog.ui" line="2862"/>
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3222"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3236"/>
         <source>Variance AQ</source>
         <translation type="unfinished"></translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoEncoder/ADM_vidEnc_x264/qt4/x264ConfigDialog.ui" line="2946"/>
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3241"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3255"/>
         <source>Advanced</source>
         <translation type="unfinished">Fortgeschritten</translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoEncoder/ADM_vidEnc_x264/qt4/x264ConfigDialog.ui" line="2966"/>
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3225"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3239"/>
         <source>Video Buffer Verifier</source>
         <translation type="unfinished"></translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoEncoder/ADM_vidEnc_x264/qt4/x264ConfigDialog.ui" line="2986"/>
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3226"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3240"/>
         <source>Maximum VBV Bitrate:</source>
         <translation type="unfinished"></translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoEncoder/ADM_vidEnc_x264/qt4/x264ConfigDialog.ui" line="2993"/>
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3227"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3241"/>
         <source>Initial VBV Buffer Occupancy:</source>
         <translation type="unfinished"></translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoEncoder/ADM_vidEnc_x264/qt4/x264ConfigDialog.ui" line="3015"/>
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3228"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3242"/>
         <source>kbit</source>
         <translation type="unfinished"></translation>
     </message>
@@ -14038,54 +14434,63 @@
         <location filename="../plugins/ADM_videoEncoder/ADM_vidEnc_x264/qt4/x264ConfigDialog.cpp" line="346"/>
         <location filename="../plugins/ADM_videoEncoder/ADM_vidEnc_x264/qt4/x264ConfigDialog.cpp" line="364"/>
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3230"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3244"/>
         <source>kbit/s</source>
         <translation type="unfinished"></translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoEncoder/ADM_vidEnc_x264/qt4/x264ConfigDialog.ui" line="3114"/>
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3231"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3245"/>
         <source>VBV Buffer Size:</source>
         <translation type="unfinished"></translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoEncoder/ADM_vidEnc_x264/qt4/x264ConfigDialog.ui" line="3126"/>
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3232"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3246"/>
         <source>Slicing</source>
         <translation type="unfinished"></translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoEncoder/ADM_vidEnc_x264/qt4/x264ConfigDialog.ui" line="3138"/>
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3233"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3247"/>
         <source>Slices per Frame:</source>
         <translation type="unfinished"></translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoEncoder/ADM_vidEnc_x264/qt4/x264ConfigDialog.ui" line="3145"/>
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3234"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3248"/>
         <source>Maximum Size per Slice:</source>
         <translation type="unfinished"></translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoEncoder/ADM_vidEnc_x264/qt4/x264ConfigDialog.ui" line="3167"/>
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3235"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3249"/>
         <source>bytes</source>
         <translation type="unfinished"></translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoEncoder/ADM_vidEnc_x264/qt4/x264ConfigDialog.ui" line="3189"/>
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3236"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3250"/>
         <source>Maximum Macroblocks per Slice:</source>
         <translation type="unfinished"></translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoEncoder/ADM_vidEnc_x264/qt4/x264ConfigDialog.ui" line="3259"/>
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3237"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3251"/>
         <source>Zones</source>
         <translation type="unfinished"></translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoEncoder/ADM_vidEnc_x264/qt4/x264ConfigDialog.ui" line="3297"/>
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3238"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3252"/>
         <source>Add</source>
         <translation type="unfinished"></translation>
     </message>
@@ -14094,6 +14499,8 @@
         <location filename="../plugins/ADM_videoEncoder/ADM_vidEnc_x264/qt4/x264ConfigDialog.ui" line="3351"/>
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3242"/>
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3344"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3256"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3358"/>
         <source>Output</source>
         <translation type="unfinished">Ausgabe</translation>
     </message>
@@ -14102,42 +14509,50 @@
         <location filename="../plugins/ADM_videoEncoder/ADM_vidEnc_x264/qt4/x264ConfigDialog.ui" line="3509"/>
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3246"/>
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3267"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3260"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3281"/>
         <source>1</source>
         <translation type="unfinished">1</translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoEncoder/ADM_vidEnc_x264/qt4/x264ConfigDialog.ui" line="3393"/>
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3247"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3261"/>
         <source>1.1</source>
         <translation type="unfinished">1.1</translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoEncoder/ADM_vidEnc_x264/qt4/x264ConfigDialog.ui" line="3398"/>
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3248"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3262"/>
         <source>1.2</source>
         <translation type="unfinished">1.2</translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoEncoder/ADM_vidEnc_x264/qt4/x264ConfigDialog.ui" line="3403"/>
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3249"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3263"/>
         <source>1.3</source>
         <translation type="unfinished">1.3</translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoEncoder/ADM_vidEnc_x264/qt4/x264ConfigDialog.ui" line="3408"/>
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3250"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3264"/>
         <source>2</source>
         <translation type="unfinished">2</translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoEncoder/ADM_vidEnc_x264/qt4/x264ConfigDialog.ui" line="3413"/>
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3251"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3265"/>
         <source>2.1</source>
         <translation type="unfinished">2.1</translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoEncoder/ADM_vidEnc_x264/qt4/x264ConfigDialog.ui" line="3418"/>
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3252"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3266"/>
         <source>2.2</source>
         <translation type="unfinished">2.2</translation>
     </message>
@@ -14146,150 +14561,176 @@
         <location filename="../plugins/ADM_videoEncoder/ADM_vidEnc_x264/qt4/x264ConfigDialog.ui" line="3514"/>
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3253"/>
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3268"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3267"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3282"/>
         <source>3</source>
         <translation type="unfinished">3</translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoEncoder/ADM_vidEnc_x264/qt4/x264ConfigDialog.ui" line="3428"/>
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3254"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3268"/>
         <source>3.1</source>
         <translation type="unfinished">3.1</translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoEncoder/ADM_vidEnc_x264/qt4/x264ConfigDialog.ui" line="3433"/>
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3255"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3269"/>
         <source>3.2</source>
         <translation type="unfinished">3.2</translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoEncoder/ADM_vidEnc_x264/qt4/x264ConfigDialog.ui" line="3438"/>
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3256"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3270"/>
         <source>4</source>
         <translation type="unfinished">4</translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoEncoder/ADM_vidEnc_x264/qt4/x264ConfigDialog.ui" line="3443"/>
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3257"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3271"/>
         <source>4.1</source>
         <translation type="unfinished">4.1</translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoEncoder/ADM_vidEnc_x264/qt4/x264ConfigDialog.ui" line="3448"/>
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3258"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3272"/>
         <source>4.2</source>
         <translation type="unfinished">4.2</translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoEncoder/ADM_vidEnc_x264/qt4/x264ConfigDialog.ui" line="3453"/>
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3259"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3273"/>
         <source>5</source>
         <translation type="unfinished">5</translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoEncoder/ADM_vidEnc_x264/qt4/x264ConfigDialog.ui" line="3458"/>
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3260"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3274"/>
         <source>5.1</source>
         <translation type="unfinished">5.1 Kan?le</translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoEncoder/ADM_vidEnc_x264/qt4/x264ConfigDialog.ui" line="3481"/>
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3262"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3276"/>
         <source>Sequence Parameter Set Identifer:</source>
         <translation type="unfinished"></translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoEncoder/ADM_vidEnc_x264/qt4/x264ConfigDialog.ui" line="3488"/>
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3263"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3277"/>
         <source>IDC Level:</source>
         <translation type="unfinished"></translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoEncoder/ADM_vidEnc_x264/qt4/x264ConfigDialog.ui" line="3504"/>
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3266"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3280"/>
         <source>0</source>
         <translation type="unfinished">0</translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoEncoder/ADM_vidEnc_x264/qt4/x264ConfigDialog.ui" line="3519"/>
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3269"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3283"/>
         <source>7</source>
         <translation type="unfinished">7</translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoEncoder/ADM_vidEnc_x264/qt4/x264ConfigDialog.ui" line="3524"/>
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3270"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3284"/>
         <source>15</source>
         <translation type="unfinished">15</translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoEncoder/ADM_vidEnc_x264/qt4/x264ConfigDialog.ui" line="3529"/>
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3271"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3285"/>
         <source>31</source>
         <translation type="unfinished">31</translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoEncoder/ADM_vidEnc_x264/qt4/x264ConfigDialog.ui" line="3554"/>
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3273"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3287"/>
         <source>Generate Access Unit Delimiters</source>
         <translation type="unfinished"></translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoEncoder/ADM_vidEnc_x264/qt4/x264ConfigDialog.ui" line="3564"/>
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3274"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3288"/>
         <source>Pixel Aspect Ratio</source>
         <translation type="unfinished">Pixel Seitenverh?ltnis (PAR)</translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoEncoder/ADM_vidEnc_x264/qt4/x264ConfigDialog.ui" line="3594"/>
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3276"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3290"/>
         <source>As Input</source>
         <translation type="unfinished">Wie Eingang</translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoEncoder/ADM_vidEnc_x264/qt4/x264ConfigDialog.ui" line="3655"/>
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3278"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3292"/>
         <source>:</source>
         <translation type="unfinished">:</translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoEncoder/ADM_vidEnc_x264/qt4/x264ConfigDialog.ui" line="3690"/>
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3279"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3293"/>
         <source>Predefined Aspect Ratio:</source>
         <translation type="unfinished"></translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoEncoder/ADM_vidEnc_x264/qt4/x264ConfigDialog.ui" line="3709"/>
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3282"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3296"/>
         <source>16:15 (PAL 4:3)</source>
         <translation type="unfinished"></translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoEncoder/ADM_vidEnc_x264/qt4/x264ConfigDialog.ui" line="3714"/>
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3283"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3297"/>
         <source>64:45 (PAL 16:9)</source>
         <translation type="unfinished"></translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoEncoder/ADM_vidEnc_x264/qt4/x264ConfigDialog.ui" line="3719"/>
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3284"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3298"/>
         <source>8:9 (NTSC 4:3)</source>
         <translation type="unfinished"></translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoEncoder/ADM_vidEnc_x264/qt4/x264ConfigDialog.ui" line="3724"/>
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3285"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3299"/>
         <source>32:27 (NTSC 16:9)</source>
         <translation type="unfinished"></translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoEncoder/ADM_vidEnc_x264/qt4/x264ConfigDialog.ui" line="3752"/>
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3287"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3301"/>
         <source>Video Usability Information</source>
         <translation type="unfinished"></translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoEncoder/ADM_vidEnc_x264/qt4/x264ConfigDialog.ui" line="3764"/>
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3288"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3302"/>
         <source>These settings are only suggestions for the playback equipment.  Use at your own risk.</source>
         <translation type="unfinished"></translation>
     </message>
@@ -14304,6 +14745,11 @@
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3310"/>
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3322"/>
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3331"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3305"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3318"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3324"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3336"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3345"/>
         <source>Undefined</source>
         <translation type="unfinished"></translation>
     </message>
@@ -14314,6 +14760,9 @@
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3292"/>
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3311"/>
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3332"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3306"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3325"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3346"/>
         <source>BT709</source>
         <translation type="unfinished"></translation>
     </message>
@@ -14322,6 +14771,8 @@
         <location filename="../plugins/ADM_videoEncoder/ADM_vidEnc_x264/qt4/x264ConfigDialog.ui" line="4080"/>
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3293"/>
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3333"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3307"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3347"/>
         <source>BT470M</source>
         <translation type="unfinished"></translation>
     </message>
@@ -14332,30 +14783,37 @@
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3294"/>
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3313"/>
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3334"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3308"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3327"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3348"/>
         <source>BT470BG</source>
         <translation type="unfinished"></translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoEncoder/ADM_vidEnc_x264/qt4/x264ConfigDialog.ui" line="3835"/>
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3295"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3309"/>
         <source>Linear</source>
         <translation type="unfinished"></translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoEncoder/ADM_vidEnc_x264/qt4/x264ConfigDialog.ui" line="3840"/>
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3296"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3310"/>
         <source>LOG100</source>
         <translation type="unfinished"></translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoEncoder/ADM_vidEnc_x264/qt4/x264ConfigDialog.ui" line="3845"/>
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3297"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3311"/>
         <source>LOG316</source>
         <translation type="unfinished"></translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoEncoder/ADM_vidEnc_x264/qt4/x264ConfigDialog.ui" line="3850"/>
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3298"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3312"/>
         <source>SMPTEL170M</source>
         <translation type="unfinished"></translation>
     </message>
@@ -14366,30 +14824,37 @@
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3299"/>
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3315"/>
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3336"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3313"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3329"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3350"/>
         <source>SMPTE240M</source>
         <translation type="unfinished"></translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoEncoder/ADM_vidEnc_x264/qt4/x264ConfigDialog.ui" line="3878"/>
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3301"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3315"/>
         <source>Colour Primaries:</source>
         <translation type="unfinished"></translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoEncoder/ADM_vidEnc_x264/qt4/x264ConfigDialog.ui" line="3899"/>
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3305"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3319"/>
         <source>Show</source>
         <translation type="unfinished"></translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoEncoder/ADM_vidEnc_x264/qt4/x264ConfigDialog.ui" line="3904"/>
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3306"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3320"/>
         <source>Crop</source>
         <translation type="unfinished">Zuschneiden</translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoEncoder/ADM_vidEnc_x264/qt4/x264ConfigDialog.ui" line="3946"/>
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3312"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3326"/>
         <source>FCC</source>
         <translation type="unfinished"></translation>
     </message>
@@ -14398,90 +14863,106 @@
         <location filename="../plugins/ADM_videoEncoder/ADM_vidEnc_x264/qt4/x264ConfigDialog.ui" line="4090"/>
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3314"/>
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3335"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3328"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3349"/>
         <source>SMPTE170M</source>
         <translation type="unfinished"></translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoEncoder/ADM_vidEnc_x264/qt4/x264ConfigDialog.ui" line="3966"/>
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3316"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3330"/>
         <source>GBR</source>
         <translation type="unfinished"></translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoEncoder/ADM_vidEnc_x264/qt4/x264ConfigDialog.ui" line="3971"/>
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3317"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3331"/>
         <source>YCgCo</source>
         <translation type="unfinished"></translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoEncoder/ADM_vidEnc_x264/qt4/x264ConfigDialog.ui" line="3994"/>
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3319"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3333"/>
         <source>Colour Matrix:</source>
         <translation type="unfinished"></translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoEncoder/ADM_vidEnc_x264/qt4/x264ConfigDialog.ui" line="4018"/>
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3323"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3337"/>
         <source>Component</source>
         <translation type="unfinished"></translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoEncoder/ADM_vidEnc_x264/qt4/x264ConfigDialog.ui" line="4023"/>
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3324"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3338"/>
         <source>PAL</source>
         <translation type="unfinished"></translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoEncoder/ADM_vidEnc_x264/qt4/x264ConfigDialog.ui" line="4028"/>
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3325"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3339"/>
         <source>NTSC</source>
         <translation type="unfinished"></translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoEncoder/ADM_vidEnc_x264/qt4/x264ConfigDialog.ui" line="4033"/>
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3326"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3340"/>
         <source>SECAM</source>
         <translation type="unfinished"></translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoEncoder/ADM_vidEnc_x264/qt4/x264ConfigDialog.ui" line="4038"/>
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3327"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3341"/>
         <source>MAC</source>
         <translation type="unfinished"></translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoEncoder/ADM_vidEnc_x264/qt4/x264ConfigDialog.ui" line="4100"/>
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3337"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3351"/>
         <source>Film</source>
         <translation type="unfinished"></translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoEncoder/ADM_vidEnc_x264/qt4/x264ConfigDialog.ui" line="4123"/>
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3339"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3353"/>
         <source>Transfer Characteristics:</source>
         <translation type="unfinished"></translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoEncoder/ADM_vidEnc_x264/qt4/x264ConfigDialog.ui" line="4130"/>
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3340"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3354"/>
         <source>Chroma Sample Location:</source>
         <translation type="unfinished"></translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoEncoder/ADM_vidEnc_x264/qt4/x264ConfigDialog.ui" line="4167"/>
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3341"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3355"/>
         <source>Video Format:</source>
         <translation type="unfinished"></translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoEncoder/ADM_vidEnc_x264/qt4/x264ConfigDialog.ui" line="4174"/>
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3342"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3356"/>
         <source>Overscan:</source>
         <translation type="unfinished"></translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoEncoder/ADM_vidEnc_x264/qt4/x264ConfigDialog.ui" line="4183"/>
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3343"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264ConfigDialog.h" line="3357"/>
         <source>Full Range Samples</source>
         <translation type="unfinished"></translation>
     </message>
@@ -14564,12 +15045,14 @@
     <message>
         <location filename="../plugins/ADM_videoEncoder/ADM_vidEnc_x264/qt4/x264CustomMatrixDialog.ui" line="16"/>
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264CustomMatrixDialog.h" line="2166"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264CustomMatrixDialog.h" line="2166"/>
         <source>x264 Custom Matrix</source>
         <translation type="unfinished"></translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoEncoder/ADM_vidEnc_x264/qt4/x264CustomMatrixDialog.ui" line="32"/>
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264CustomMatrixDialog.h" line="2169"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264CustomMatrixDialog.h" line="2169"/>
         <source>Intra 4x4</source>
         <translation type="unfinished"></translation>
     </message>
@@ -14582,6 +15065,10 @@
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264CustomMatrixDialog.h" line="2170"/>
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264CustomMatrixDialog.h" line="2173"/>
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264CustomMatrixDialog.h" line="2175"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264CustomMatrixDialog.h" line="2167"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264CustomMatrixDialog.h" line="2170"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264CustomMatrixDialog.h" line="2173"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264CustomMatrixDialog.h" line="2175"/>
         <source>Luma:</source>
         <translation type="unfinished"></translation>
     </message>
@@ -14590,42 +15077,50 @@
         <location filename="../plugins/ADM_videoEncoder/ADM_vidEnc_x264/qt4/x264CustomMatrixDialog.ui" line="716"/>
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264CustomMatrixDialog.h" line="2168"/>
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264CustomMatrixDialog.h" line="2171"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264CustomMatrixDialog.h" line="2168"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264CustomMatrixDialog.h" line="2171"/>
         <source>Chroma U/V:</source>
         <translation type="unfinished"></translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoEncoder/ADM_vidEnc_x264/qt4/x264CustomMatrixDialog.ui" line="478"/>
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264CustomMatrixDialog.h" line="2172"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264CustomMatrixDialog.h" line="2172"/>
         <source>Inter 4x4</source>
         <translation type="unfinished"></translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoEncoder/ADM_vidEnc_x264/qt4/x264CustomMatrixDialog.ui" line="924"/>
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264CustomMatrixDialog.h" line="2174"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264CustomMatrixDialog.h" line="2174"/>
         <source>Intra 8x8</source>
         <translation type="unfinished"></translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoEncoder/ADM_vidEnc_x264/qt4/x264CustomMatrixDialog.ui" line="1627"/>
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264CustomMatrixDialog.h" line="2176"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264CustomMatrixDialog.h" line="2176"/>
         <source>Inter 8x8</source>
         <translation type="unfinished"></translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoEncoder/ADM_vidEnc_x264/qt4/x264CustomMatrixDialog.ui" line="2354"/>
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264CustomMatrixDialog.h" line="2177"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264CustomMatrixDialog.h" line="2177"/>
         <source>Load File</source>
         <translation type="unfinished"></translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoEncoder/ADM_vidEnc_x264/qt4/x264CustomMatrixDialog.ui" line="2374"/>
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264CustomMatrixDialog.h" line="2178"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264CustomMatrixDialog.h" line="2178"/>
         <source>OK</source>
         <translation type="unfinished"></translation>
     </message>
     <message>
         <location filename="../plugins/ADM_videoEncoder/ADM_vidEnc_x264/qt4/x264CustomMatrixDialog.ui" line="2384"/>
         <location filename="../plugins/build/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264CustomMatrixDialog.h" line="2179"/>
+        <location filename="../plugins/build64/ADM_videoEncoder/ADM_vidEnc_x264/qt4/ui_x264CustomMatrixDialog.h" line="2179"/>
         <source>Cancel</source>
         <translation type="unfinished"></translation>
     </message>

Added: branches/avidemux_2.5_branch_gruntster/po/qt_de.ts
===================================================================
--- branches/avidemux_2.5_branch_gruntster/po/qt_de.ts	2010-05-31 18:54:50 UTC (rev 6273)
+++ branches/avidemux_2.5_branch_gruntster/po/qt_de.ts	2010-05-31 19:09:19 UTC (rev 6274)
@@ -0,0 +1,4424 @@
+<?xml version="1.0" encoding="utf-8"?>
+<!DOCTYPE TS>
+<TS version="2.0" language="de_DE" sourcelanguage="en_GB">
+<context>
+    <name>PPDOptionsModel</name>
+    <message>
+        <location filename="../src/gui/dialogs/qprintdialog_unix.cpp" line="1595"/>
+        <source>Name</source>
+        <translation type="unfinished">Name</translation>
+    </message>
+    <message>
+        <location filename="../src/gui/dialogs/qprintdialog_unix.cpp" line="1597"/>
+        <source>Value</source>
+        <translation>Wert</translation>
+    </message>
+</context>
+<context>
+    <name>Q3Accel</name>
+    <message>
+        <location filename="../src/qt3support/other/q3accel.cpp" line="462"/>
+        <source>%1, %2 not defined</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/qt3support/other/q3accel.cpp" line="497"/>
+        <source>Ambiguous %1 not handled</source>
+        <translation type="unfinished"></translation>
+    </message>
+</context>
+<context>
+    <name>Q3DataTable</name>
+    <message>
+        <location filename="../src/qt3support/sql/q3datatable.cpp" line="253"/>
+        <source>True</source>
+        <translation>wahr</translation>
+    </message>
+    <message>
+        <location filename="../src/qt3support/sql/q3datatable.cpp" line="254"/>
+        <source>False</source>
+        <translation>falsch</translation>
+    </message>
+    <message>
+        <location filename="../src/qt3support/sql/q3datatable.cpp" line="766"/>
+        <source>Insert</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/qt3support/sql/q3datatable.cpp" line="767"/>
+        <source>Update</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/qt3support/sql/q3datatable.cpp" line="768"/>
+        <source>Delete</source>
+        <translation>l?schen</translation>
+    </message>
+</context>
+<context>
+    <name>Q3FileDialog</name>
+    <message>
+        <location filename="../src/qt3support/dialogs/q3filedialog.cpp" line="834"/>
+        <source>Copy or Move a File</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/qt3support/dialogs/q3filedialog.cpp" line="842"/>
+        <source>Read: %1</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/qt3support/dialogs/q3filedialog.cpp" line="878"/>
+        <source>Write: %1</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/qt3support/dialogs/q3filedialog.cpp" line="2470"/>
+        <source>Cancel</source>
+        <translation>abbrechen</translation>
+    </message>
+    <message>
+        <location filename="../src/qt3support/dialogs/q3filedialog_mac.cpp" line="80"/>
+        <source>All Files (*)</source>
+        <translation>Alle Dateien (*)</translation>
+    </message>
+    <message>
+        <location filename="../src/qt3support/dialogs/q3filedialog.cpp" line="2426"/>
+        <source>Name</source>
+        <translation>Name</translation>
+    </message>
+    <message>
+        <location filename="../src/qt3support/dialogs/q3filedialog.cpp" line="2427"/>
+        <source>Size</source>
+        <translation>Gr??e</translation>
+    </message>
+    <message>
+        <location filename="../src/qt3support/dialogs/q3filedialog.cpp" line="2429"/>
+        <source>Type</source>
+        <translation>Typ</translation>
+    </message>
+    <message>
+        <location filename="../src/qt3support/dialogs/q3filedialog.cpp" line="2430"/>
+        <source>Date</source>
+        <translation>Datum</translation>
+    </message>
+    <message>
+        <location filename="../src/qt3support/dialogs/q3filedialog.cpp" line="2431"/>
+        <source>Attributes</source>
+        <translation>Attribute</translation>
+    </message>
+    <message>
+        <location filename="../src/qt3support/dialogs/q3filedialog.cpp" line="4530"/>
+        <source>&amp;OK</source>
+        <translation>&amp;OK</translation>
+    </message>
+    <message>
+        <location filename="../src/qt3support/dialogs/q3filedialog.cpp" line="2506"/>
+        <source>Look &amp;in:</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/qt3support/dialogs/q3filedialog.cpp" line="4537"/>
+        <source>File &amp;name:</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/qt3support/dialogs/q3filedialog.cpp" line="2508"/>
+        <source>File &amp;type:</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/qt3support/dialogs/q3filedialog.cpp" line="2515"/>
+        <source>Back</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/qt3support/dialogs/q3filedialog.cpp" line="2522"/>
+        <source>One directory up</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/qt3support/dialogs/q3filedialog.cpp" line="2531"/>
+        <source>Create New Folder</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/qt3support/dialogs/q3filedialog.cpp" line="2549"/>
+        <source>List View</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/qt3support/dialogs/q3filedialog.cpp" line="2557"/>
+        <source>Detail View</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/qt3support/dialogs/q3filedialog.cpp" line="2566"/>
+        <source>Preview File Info</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/qt3support/dialogs/q3filedialog.cpp" line="2589"/>
+        <source>Preview File Contents</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/qt3support/dialogs/q3filedialog.cpp" line="2677"/>
+        <source>Read-write</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/qt3support/dialogs/q3filedialog.cpp" line="2678"/>
+        <source>Read-only</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/qt3support/dialogs/q3filedialog.cpp" line="2679"/>
+        <source>Write-only</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/qt3support/dialogs/q3filedialog.cpp" line="2680"/>
+        <source>Inaccessible</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/qt3support/dialogs/q3filedialog.cpp" line="2682"/>
+        <source>Symlink to File</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/qt3support/dialogs/q3filedialog.cpp" line="2683"/>
+        <source>Symlink to Directory</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/qt3support/dialogs/q3filedialog.cpp" line="2684"/>
+        <source>Symlink to Special</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/qt3support/dialogs/q3filedialog.cpp" line="2685"/>
+        <source>File</source>
+        <translation>Datei</translation>
+    </message>
+    <message>
+        <location filename="../src/qt3support/dialogs/q3filedialog.cpp" line="2686"/>
+        <source>Dir</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/qt3support/dialogs/q3filedialog.cpp" line="2687"/>
+        <source>Special</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/qt3support/dialogs/q3filedialog_win.cpp" line="478"/>
+        <source>Open</source>
+        <translation>?ffnen</translation>
+    </message>
+    <message>
+        <location filename="../src/qt3support/dialogs/q3filedialog_win.cpp" line="392"/>
+        <source>Save As</source>
+        <translation>Speichern als</translation>
+    </message>
+    <message>
+        <location filename="../src/qt3support/dialogs/q3filedialog.cpp" line="4536"/>
+        <source>&amp;Open</source>
+        <translation>&amp;?ffnen</translation>
+    </message>
+    <message>
+        <location filename="../src/qt3support/dialogs/q3filedialog.cpp" line="4520"/>
+        <source>&amp;Save</source>
+        <translation>&amp;Speichern</translation>
+    </message>
+    <message>
+        <location filename="../src/qt3support/dialogs/q3filedialog.cpp" line="4179"/>
+        <source>&amp;Rename</source>
+        <translation>&amp;Umbenennen</translation>
+    </message>
+    <message>
+        <location filename="../src/qt3support/dialogs/q3filedialog.cpp" line="4180"/>
+        <source>&amp;Delete</source>
+        <translation>&amp;L?schen</translation>
+    </message>
+    <message>
+        <location filename="../src/qt3support/dialogs/q3filedialog.cpp" line="4200"/>
+        <source>R&amp;eload</source>
+        <translation>&amp;Neu laden</translation>
+    </message>
+    <message>
+        <location filename="../src/qt3support/dialogs/q3filedialog.cpp" line="4204"/>
+        <source>Sort by &amp;Name</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/qt3support/dialogs/q3filedialog.cpp" line="4206"/>
+        <source>Sort by &amp;Size</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/qt3support/dialogs/q3filedialog.cpp" line="4207"/>
+        <source>Sort by &amp;Date</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/qt3support/dialogs/q3filedialog.cpp" line="4209"/>
+        <source>&amp;Unsorted</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/qt3support/dialogs/q3filedialog.cpp" line="4224"/>
+        <source>Sort</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/qt3support/dialogs/q3filedialog.cpp" line="4228"/>
+        <source>Show &amp;hidden files</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/qt3support/dialogs/q3filedialog.cpp" line="4259"/>
+        <source>the file</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/qt3support/dialogs/q3filedialog.cpp" line="4261"/>
+        <source>the directory</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/qt3support/dialogs/q3filedialog.cpp" line="4263"/>
+        <source>the symlink</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/qt3support/dialogs/q3filedialog.cpp" line="4266"/>
+        <source>Delete %1</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/qt3support/dialogs/q3filedialog.cpp" line="4268"/>
+        <source>&lt;qt&gt;Are you sure you wish to delete %1 &quot;%2&quot;?&lt;/qt&gt;</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/qt3support/dialogs/q3filedialog.cpp" line="4269"/>
+        <source>&amp;Yes</source>
+        <translation>&amp;Ja</translation>
+    </message>
+    <message>
+        <location filename="../src/qt3support/dialogs/q3filedialog.cpp" line="4269"/>
+        <source>&amp;No</source>
+        <translation>&amp;Nein</translation>
+    </message>
+    <message>
+        <location filename="../src/qt3support/dialogs/q3filedialog.cpp" line="4305"/>
+        <source>New Folder 1</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/qt3support/dialogs/q3filedialog.cpp" line="4310"/>
+        <source>New Folder</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/qt3support/dialogs/q3filedialog.cpp" line="4315"/>
+        <source>New Folder %1</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/qt3support/dialogs/q3filedialog.cpp" line="4420"/>
+        <source>Find Directory</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/qt3support/dialogs/q3filedialog.cpp" line="4533"/>
+        <source>Directories</source>
+        <translation>Verzeichnisse</translation>
+    </message>
+    <message>
+        <location filename="../src/qt3support/dialogs/q3filedialog.cpp" line="4531"/>
+        <source>Directory:</source>
+        <translation>Verzeichnis:</translation>
+    </message>
+    <message>
+        <location filename="../src/qt3support/dialogs/q3filedialog.cpp" line="5716"/>
+        <source>Error</source>
+        <translation>Fehler</translation>
+    </message>
+    <message>
+        <location filename="../src/qt3support/dialogs/q3filedialog.cpp" line="4572"/>
+        <source>%1
+File not found.
+Check path and filename.</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/qt3support/dialogs/q3filedialog_win.cpp" line="103"/>
+        <source>All Files (*.*)</source>
+        <translation>Alle Dateien (*.*)</translation>
+    </message>
+    <message>
+        <location filename="../src/qt3support/dialogs/q3filedialog_win.cpp" line="633"/>
+        <source>Select a Directory</source>
+        <translation type="unfinished"></translation>
+    </message>
+</context>
+<context>
+    <name>Q3LocalFs</name>
+    <message>
+        <location filename="../src/qt3support/network/q3localfs.cpp" line="113"/>
+        <source>Could not read directory
+%1</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/qt3support/network/q3localfs.cpp" line="158"/>
+        <source>Could not create directory
+%1</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/qt3support/network/q3localfs.cpp" line="192"/>
+        <source>Could not remove file or directory
+%1</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/qt3support/network/q3localfs.cpp" line="219"/>
+        <source>Could not rename
+%1
+to
+%2</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/qt3support/network/q3localfs.cpp" line="244"/>
+        <source>Could not open
+%1</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/qt3support/network/q3localfs.cpp" line="312"/>
+        <source>Could not write
+%1</source>
+        <translation type="unfinished"></translation>
+    </message>
+</context>
+<context>
+    <name>Q3MainWindow</name>
+    <message>
+        <location filename="../src/qt3support/widgets/q3mainwindow.cpp" line="2050"/>
+        <source>Line up</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/qt3support/widgets/q3mainwindow.cpp" line="2052"/>
+        <source>Customize...</source>
+        <translation type="unfinished"></translation>
+    </message>
+</context>
+<context>
+    <name>Q3NetworkProtocol</name>
+    <message>
+        <location filename="../src/qt3support/network/q3networkprotocol.cpp" line="827"/>
+        <source>Operation stopped by the user</source>
+        <translation type="unfinished"></translation>
+    </message>
+</context>
+<context>
+    <name>Q3ProgressDialog</name>
+    <message>
+        <location filename="../src/qt3support/dialogs/q3progressdialog.cpp" line="292"/>
+        <source>Cancel</source>
+        <translation>abbrechen</translation>
+    </message>
+</context>
+<context>
+    <name>Q3TabDialog</name>
+    <message>
+        <location filename="../src/qt3support/dialogs/q3tabdialog.cpp" line="973"/>
+        <source>OK</source>
+        <translation>OK</translation>
+    </message>
+    <message>
+        <location filename="../src/qt3support/dialogs/q3tabdialog.cpp" line="617"/>
+        <source>Apply</source>
+        <translation>?bernehmen</translation>
+    </message>
+    <message>
+        <location filename="../src/qt3support/dialogs/q3tabdialog.cpp" line="660"/>
+        <source>Help</source>
+        <translation>Hilfe</translation>
+    </message>
+    <message>
+        <location filename="../src/qt3support/dialogs/q3tabdialog.cpp" line="705"/>
+        <source>Defaults</source>
+        <translation>Standard</translation>
+    </message>
+    <message>
+        <location filename="../src/qt3support/dialogs/q3tabdialog.cpp" line="755"/>
+        <source>Cancel</source>
+        <translation>abbrechen</translation>
+    </message>
+</context>
+<context>
+    <name>Q3TextEdit</name>
+    <message>
+        <location filename="../src/qt3support/text/q3textedit.cpp" line="5424"/>
+        <source>&amp;Undo</source>
+        <translation>&amp;R?ckg?ngig</translation>
+    </message>
+    <message>
+        <location filename="../src/qt3support/text/q3textedit.cpp" line="5425"/>
+        <source>&amp;Redo</source>
+        <translation>&amp;Wiederholen</translation>
+    </message>
+    <message>
+        <location filename="../src/qt3support/text/q3textedit.cpp" line="5430"/>
+        <source>Cu&amp;t</source>
+        <translation>&amp;Ausschneiden</translation>
+    </message>
+    <message>
+        <location filename="../src/qt3support/text/q3textedit.cpp" line="5431"/>
+        <source>&amp;Copy</source>
+        <translation>&amp;Kopieren</translation>
+    </message>
+    <message>
+        <location filename="../src/qt3support/text/q3textedit.cpp" line="5433"/>
+        <source>&amp;Paste</source>
+        <translation>&amp;Einf?gen</translation>
+    </message>
+    <message>
+        <location filename="../src/qt3support/text/q3textedit.cpp" line="5436"/>
+        <source>Clear</source>
+        <translation>Leeren</translation>
+    </message>
+    <message>
+        <location filename="../src/qt3support/text/q3textedit.cpp" line="5442"/>
+        <source>Select All</source>
+        <translation>Alles ausw?hlen</translation>
+    </message>
+</context>
+<context>
+    <name>Q3TitleBar</name>
+    <message>
+        <location filename="../src/plugins/accessible/compat/q3complexwidgets.cpp" line="216"/>
+        <source>System</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/plugins/accessible/compat/q3complexwidgets.cpp" line="219"/>
+        <source>Restore up</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/plugins/accessible/compat/q3complexwidgets.cpp" line="220"/>
+        <source>Minimize</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/plugins/accessible/compat/q3complexwidgets.cpp" line="223"/>
+        <source>Restore down</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/plugins/accessible/compat/q3complexwidgets.cpp" line="224"/>
+        <source>Maximize</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/plugins/accessible/compat/q3complexwidgets.cpp" line="226"/>
+        <source>Close</source>
+        <translation>schlie?en</translation>
+    </message>
+    <message>
+        <location filename="../src/plugins/accessible/compat/q3complexwidgets.cpp" line="244"/>
+        <source>Contains commands to manipulate the window</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/plugins/accessible/compat/q3complexwidgets.cpp" line="247"/>
+        <source>Puts a minimized back to normal</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/plugins/accessible/compat/q3complexwidgets.cpp" line="248"/>
+        <source>Moves the window out of the way</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/plugins/accessible/compat/q3complexwidgets.cpp" line="251"/>
+        <source>Puts a maximized window back to normal</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/plugins/accessible/compat/q3complexwidgets.cpp" line="252"/>
+        <source>Makes the window full screen</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/plugins/accessible/compat/q3complexwidgets.cpp" line="254"/>
+        <source>Closes the window</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/plugins/accessible/compat/q3complexwidgets.cpp" line="256"/>
+        <source>Displays the name of the window and contains controls to manipulate it</source>
+        <translation type="unfinished"></translation>
+    </message>
+</context>
+<context>
+    <name>Q3ToolBar</name>
+    <message>
+        <location filename="../src/qt3support/widgets/q3toolbar.cpp" line="656"/>
+        <source>More...</source>
+        <translation type="unfinished"></translation>
+    </message>
+</context>
+<context>
+    <name>Q3UrlOperator</name>
+    <message>
+        <location filename="../src/qt3support/network/q3urloperator.cpp" line="624"/>
+        <source>The protocol `%1&apos; is not supported</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/qt3support/network/q3urloperator.cpp" line="364"/>
+        <source>The protocol `%1&apos; does not support listing directories</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/qt3support/network/q3urloperator.cpp" line="367"/>
+        <source>The protocol `%1&apos; does not support creating new directories</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/qt3support/network/q3urloperator.cpp" line="370"/>
+        <source>The protocol `%1&apos; does not support removing files or directories</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/qt3support/network/q3urloperator.cpp" line="373"/>
+        <source>The protocol `%1&apos; does not support renaming files or directories</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/qt3support/network/q3urloperator.cpp" line="376"/>
+        <source>The protocol `%1&apos; does not support getting files</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/qt3support/network/q3urloperator.cpp" line="379"/>
+        <source>The protocol `%1&apos; does not support putting files</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/qt3support/network/q3urloperator.cpp" line="626"/>
+        <source>The protocol `%1&apos; does not support copying or moving files or directories</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/qt3support/network/q3urloperator.cpp" line="881"/>
+        <source>(unknown)</source>
+        <translation type="unfinished"></translation>
+    </message>
+</context>
+<context>
+    <name>Q3Wizard</name>
+    <message>
+        <location filename="../src/qt3support/dialogs/q3wizard.cpp" line="145"/>
+        <source>&amp;Cancel</source>
+        <translation>&amp;abbrechen</translation>
+    </message>
+    <message>
+        <location filename="../src/qt3support/dialogs/q3wizard.cpp" line="146"/>
+        <source>&lt; &amp;Back</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/qt3support/dialogs/q3wizard.cpp" line="147"/>
+        <source>&amp;Next &gt;</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/qt3support/dialogs/q3wizard.cpp" line="148"/>
+        <source>&amp;Finish</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/qt3support/dialogs/q3wizard.cpp" line="149"/>
+        <source>&amp;Help</source>
+        <translation>&amp;Hilfe</translation>
+    </message>
+</context>
+<context>
+    <name>QAbstractSocket</name>
+    <message>
+        <location filename="../src/network/qabstractsocket.cpp" line="703"/>
+        <source>Host not found</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/network/qhttpsocketengine.cpp" line="479"/>
+        <source>Connection refused</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/network/qabstractsocket.cpp" line="1449"/>
+        <source>Socket operation timed out</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/network/qabstractsocket.cpp" line="1831"/>
+        <source>Socket is not connected</source>
+        <translation type="unfinished"></translation>
+    </message>
+</context>
+<context>
+    <name>QAbstractSpinBox</name>
+    <message>
+        <location filename="../src/gui/widgets/qabstractspinbox.cpp" line="1148"/>
+        <source>&amp;Step up</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/gui/widgets/qabstractspinbox.cpp" line="1150"/>
+        <source>Step &amp;down</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/gui/widgets/qabstractspinbox.cpp" line="1142"/>
+        <source>&amp;Select All</source>
+        <translation type="unfinished"></translation>
+    </message>
+</context>
+<context>
+    <name>QApplication</name>
+    <message>
+        <location filename="../src/gui/accessible/qaccessibleobject.cpp" line="346"/>
+        <source>Activate</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/gui/dialogs/qmessagebox.h" line="308"/>
+        <source>Executable &apos;%1&apos; requires Qt %2, found Qt %3.</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/gui/dialogs/qmessagebox.h" line="310"/>
+        <source>Incompatible Qt Library Error</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/gui/kernel/qapplication.cpp" line="2012"/>
+        <source>QT_LAYOUT_DIRECTION</source>
+        <comment>Translate this string to the string &apos;LTR&apos; in left-to-right languages or to &apos;RTL&apos; in right-to-left languages (such as Hebrew and Arabic) to get proper widget layout.</comment>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/gui/accessible/qaccessibleobject.cpp" line="348"/>
+        <source>Activates the program&apos;s main window</source>
+        <translation type="unfinished"></translation>
+    </message>
+</context>
+<context>
+    <name>QAxSelect</name>
+    <message>
+        <location filename="../src/activeqt/container/ui_qaxselect.h" line="123"/>
+        <source>Select ActiveX Control</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/activeqt/container/ui_qaxselect.h" line="124"/>
+        <source>OK</source>
+        <translation>OK</translation>
+    </message>
+    <message>
+        <location filename="../src/activeqt/container/ui_qaxselect.h" line="125"/>
+        <source>&amp;Cancel</source>
+        <translation>&amp;abbrechen</translation>
+    </message>
+    <message>
+        <location filename="../src/activeqt/container/ui_qaxselect.h" line="126"/>
+        <source>COM &amp;Object:</source>
+        <translation type="unfinished"></translation>
+    </message>
+</context>
+<context>
+    <name>QCheckBox</name>
+    <message>
+        <location filename="../src/plugins/accessible/widgets/simplewidgets.cpp" line="84"/>
+        <source>Uncheck</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/plugins/accessible/widgets/simplewidgets.cpp" line="87"/>
+        <source>Check</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/plugins/accessible/widgets/simplewidgets.cpp" line="88"/>
+        <source>Toggle</source>
+        <translation type="unfinished"></translation>
+    </message>
+</context>
+<context>
+    <name>QColorDialog</name>
+    <message>
+        <location filename="../src/gui/dialogs/qcolordialog.cpp" line="1204"/>
+        <source>Hu&amp;e:</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/gui/dialogs/qcolordialog.cpp" line="1205"/>
+        <source>&amp;Sat:</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/gui/dialogs/qcolordialog.cpp" line="1206"/>
+        <source>&amp;Val:</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/gui/dialogs/qcolordialog.cpp" line="1207"/>
+        <source>&amp;Red:</source>
+        <translation>&amp;Rot :</translation>
+    </message>
+    <message>
+        <location filename="../src/gui/dialogs/qcolordialog.cpp" line="1208"/>
+        <source>&amp;Green:</source>
+        <translation>&amp;Gr?n :</translation>
+    </message>
+    <message>
+        <location filename="../src/gui/dialogs/qcolordialog.cpp" line="1209"/>
+        <source>Bl&amp;ue:</source>
+        <translation>Bla&amp;u :</translation>
+    </message>
+    <message>
+        <location filename="../src/gui/dialogs/qcolordialog.cpp" line="1210"/>
+        <source>A&amp;lpha channel:</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/gui/dialogs/qcolordialog.cpp" line="1410"/>
+        <source>&amp;Basic colors</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/gui/dialogs/qcolordialog.cpp" line="1411"/>
+        <source>&amp;Custom colors</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/gui/dialogs/qcolordialog.cpp" line="1412"/>
+        <source>&amp;Define Custom Colors &gt;&gt;</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/gui/dialogs/qcolordialog.cpp" line="1415"/>
+        <source>OK</source>
+        <translation>OK</translation>
+    </message>
+    <message>
+        <location filename="../src/gui/dialogs/qcolordialog.cpp" line="1416"/>
+        <source>Cancel</source>
+        <translation>Abbrechen</translation>
+    </message>
+    <message>
+        <location filename="../src/gui/dialogs/qcolordialog.cpp" line="1413"/>
+        <source>&amp;Add to Custom Colors</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/gui/dialogs/qcolordialog.cpp" line="1539"/>
+        <source>Select color</source>
+        <translation type="unfinished"></translation>
+    </message>
+</context>
+<context>
+    <name>QComboBox</name>
+    <message>
+        <location filename="../src/plugins/accessible/widgets/complexwidgets.cpp" line="1394"/>
+        <source>Open</source>
+        <translation>?ffne</translation>
+    </message>
+    <message>
+        <location filename="../src/gui/itemviews/qitemeditorfactory.cpp" line="515"/>
+        <source>False</source>
+        <translation>falsch</translation>
+    </message>
+    <message>
+        <location filename="../src/gui/itemviews/qitemeditorfactory.cpp" line="516"/>
+        <source>True</source>
+        <translation>wahr</translation>
+    </message>
+    <message>
+        <location filename="../src/plugins/accessible/widgets/complexwidgets.cpp" line="1394"/>
+        <source>Close</source>
+        <translation>schlie?en</translation>
+    </message>
+</context>
+<context>
+    <name>QDB2Driver</name>
+    <message>
+        <location filename="../src/sql/drivers/db2/qsql_db2.cpp" line="1153"/>
+        <source>Unable to connect</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/sql/drivers/db2/qsql_db2.cpp" line="1414"/>
+        <source>Unable to commit transaction</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/sql/drivers/db2/qsql_db2.cpp" line="1431"/>
+        <source>Unable to rollback transaction</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/sql/drivers/db2/qsql_db2.cpp" line="1446"/>
+        <source>Unable to set autocommit</source>
+        <translation type="unfinished"></translation>
+    </message>
+</context>
+<context>
+    <name>QDB2Result</name>
+    <message>
+        <location filename="../src/sql/drivers/db2/qsql_db2.cpp" line="768"/>
+        <source>Unable to execute statement</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/sql/drivers/db2/qsql_db2.cpp" line="562"/>
+        <source>Unable to prepare statement</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/sql/drivers/db2/qsql_db2.cpp" line="758"/>
+        <source>Unable to bind variable</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/sql/drivers/db2/qsql_db2.cpp" line="849"/>
+        <source>Unable to fetch record %1</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/sql/drivers/db2/qsql_db2.cpp" line="866"/>
+        <source>Unable to fetch next</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/sql/drivers/db2/qsql_db2.cpp" line="885"/>
+        <source>Unable to fetch first</source>
+        <translation type="unfinished"></translation>
+    </message>
+</context>
+<context>
+    <name>QDateTimeEdit</name>
+    <message>
+        <location filename="../src/gui/widgets/qdatetimeedit.cpp" line="2061"/>
+        <source>AM</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/gui/widgets/qdatetimeedit.cpp" line="2061"/>
+        <source>am</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/gui/widgets/qdatetimeedit.cpp" line="2063"/>
+        <source>PM</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/gui/widgets/qdatetimeedit.cpp" line="2063"/>
+        <source>pm</source>
+        <translation type="unfinished"></translation>
+    </message>
+</context>
+<context>
+    <name>QDial</name>
+    <message>
+        <location filename="../src/plugins/accessible/widgets/rangecontrols.cpp" line="920"/>
+        <source>QDial</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/plugins/accessible/widgets/rangecontrols.cpp" line="922"/>
+        <source>SpeedoMeter</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/plugins/accessible/widgets/rangecontrols.cpp" line="924"/>
+        <source>SliderHandle</source>
+        <translation type="unfinished"></translation>
+    </message>
+</context>
+<context>
+    <name>QDialog</name>
+    <message>
+        <location filename="../src/gui/dialogs/qdialog.cpp" line="490"/>
+        <source>What&apos;s This?</source>
+        <translation type="unfinished"></translation>
+    </message>
+</context>
+<context>
+    <name>QDialogButtonBox</name>
+    <message>
+        <location filename="../src/gui/widgets/qdialogbuttonbox.cpp" line="525"/>
+        <source>OK</source>
+        <translation>OK</translation>
+    </message>
+    <message>
+        <location filename="../src/gui/widgets/qdialogbuttonbox.cpp" line="528"/>
+        <source>Save</source>
+        <translation>Speichern</translation>
+    </message>
+    <message>
+        <location filename="../src/gui/widgets/qdialogbuttonbox.cpp" line="531"/>
+        <source>Open</source>
+        <translation>?ffnen</translation>
+    </message>
+    <message>
+        <location filename="../src/gui/widgets/qdialogbuttonbox.cpp" line="534"/>
+        <source>Cancel</source>
+        <translation>Abbrechen</translation>
+    </message>
+    <message>
+        <location filename="../src/gui/widgets/qdialogbuttonbox.cpp" line="537"/>
+        <source>Close</source>
+        <translation>Schlie?en</translation>
+    </message>
+    <message>
+        <location filename="../src/gui/widgets/qdialogbuttonbox.cpp" line="540"/>
+        <source>Apply</source>
+        <translation>?bernehmen</translation>
+    </message>
+    <message>
+        <location filename="../src/gui/widgets/qdialogbuttonbox.cpp" line="543"/>
+        <source>Reset</source>
+        <translation>Zur?cksetzen</translation>
+    </message>
+    <message>
+        <location filename="../src/gui/widgets/qdialogbuttonbox.cpp" line="546"/>
+        <source>Help</source>
+        <translation>Hilfe</translation>
+    </message>
+    <message>
+        <location filename="../src/gui/widgets/qdialogbuttonbox.cpp" line="550"/>
+        <source>Don&apos;t Save</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/gui/widgets/qdialogbuttonbox.cpp" line="554"/>
+        <source>Discard</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/gui/widgets/qdialogbuttonbox.cpp" line="557"/>
+        <source>&amp;Yes</source>
+        <translation>&amp;Ja</translation>
+    </message>
+    <message>
+        <location filename="../src/gui/widgets/qdialogbuttonbox.cpp" line="560"/>
+        <source>Yes to &amp;All</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/gui/widgets/qdialogbuttonbox.cpp" line="563"/>
+        <source>&amp;No</source>
+        <translation>&amp;Nein</translation>
+    </message>
+    <message>
+        <location filename="../src/gui/widgets/qdialogbuttonbox.cpp" line="566"/>
+        <source>N&amp;o to All</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/gui/widgets/qdialogbuttonbox.cpp" line="569"/>
+        <source>Save All</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/gui/widgets/qdialogbuttonbox.cpp" line="572"/>
+        <source>Abort</source>
+        <translation>Abbrechen</translation>
+    </message>
+    <message>
+        <location filename="../src/gui/widgets/qdialogbuttonbox.cpp" line="575"/>
+        <source>Retry</source>
+        <translation>Wiederholen</translation>
+    </message>
+    <message>
+        <location filename="../src/gui/widgets/qdialogbuttonbox.cpp" line="578"/>
+        <source>Ignore</source>
+        <translation>Ignorieren</translation>
+    </message>
+    <message>
+        <location filename="../src/gui/widgets/qdialogbuttonbox.cpp" line="581"/>
+        <source>Restore Defaults</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/gui/widgets/qdialogbuttonbox.cpp" line="552"/>
+        <source>Close without Saving</source>
+        <translation type="unfinished"></translation>
+    </message>
+</context>
+<context>
+    <name>QDirModel</name>
+    <message>
+        <location filename="../src/gui/itemviews/qdirmodel.cpp" line="419"/>
+        <source>Name</source>
+        <translation>Name</translation>
+    </message>
+    <message>
+        <location filename="../src/gui/itemviews/qdirmodel.cpp" line="420"/>
+        <source>Size</source>
+        <translation>Gr??e</translation>
+    </message>
+    <message>
+        <location filename="../src/gui/itemviews/qdirmodel.cpp" line="423"/>
+        <source>Kind</source>
+        <comment>Match OS X Finder</comment>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/gui/itemviews/qdirmodel.cpp" line="425"/>
+        <source>Type</source>
+        <comment>All other platforms</comment>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/gui/itemviews/qdirmodel.cpp" line="431"/>
+        <source>Date Modified</source>
+        <translation type="unfinished"></translation>
+    </message>
+</context>
+<context>
+    <name>QDockWidget</name>
+    <message>
+        <location filename="../src/plugins/accessible/widgets/qaccessiblewidgets.cpp" line="1198"/>
+        <source>Close</source>
+        <translation>Schlie?en</translation>
+    </message>
+    <message>
+        <location filename="../src/plugins/accessible/widgets/qaccessiblewidgets.cpp" line="1201"/>
+        <source>Dock</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/plugins/accessible/widgets/qaccessiblewidgets.cpp" line="1201"/>
+        <source>Float</source>
+        <translation type="unfinished"></translation>
+    </message>
+</context>
+<context>
+    <name>QDoubleSpinBox</name>
+    <message>
+        <location filename="../src/plugins/accessible/widgets/rangecontrols.cpp" line="387"/>
+        <source>More</source>
+        <translation>Mehr</translation>
+    </message>
+    <message>
+        <location filename="../src/plugins/accessible/widgets/rangecontrols.cpp" line="389"/>
+        <source>Less</source>
+        <translation type="unfinished"></translation>
+    </message>
+</context>
+<context>
+    <name>QErrorMessage</name>
+    <message>
+        <location filename="../src/gui/dialogs/qerrormessage.cpp" line="131"/>
+        <source>Debug Message:</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/gui/dialogs/qerrormessage.cpp" line="134"/>
+        <source>Warning:</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/gui/dialogs/qerrormessage.cpp" line="137"/>
+        <source>Fatal Error:</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/gui/dialogs/qerrormessage.cpp" line="287"/>
+        <source>&amp;Show this message again</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/gui/dialogs/qerrormessage.cpp" line="288"/>
+        <source>&amp;OK</source>
+        <translation>&amp;OK</translation>
+    </message>
+</context>
+<context>
+    <name>QFileDialog</name>
+    <message>
+        <location filename="../src/gui/dialogs/qfiledialog_mac.cpp" line="84"/>
+        <source>All Files (*)</source>
+        <translation>Alle Dateien (*.*)</translation>
+    </message>
+    <message>
+        <location filename="../src/gui/dialogs/qfiledialog.cpp" line="747"/>
+        <source>Directories</source>
+        <translation>Verzeichnisse</translation>
+    </message>
+    <message>
+        <location filename="../src/gui/dialogs/qfiledialog.cpp" line="784"/>
+        <source>&amp;Open</source>
+        <translation>&amp;?ffnen</translation>
+    </message>
+    <message>
+        <location filename="../src/gui/dialogs/qfiledialog.cpp" line="784"/>
+        <source>&amp;Save</source>
+        <translation>&amp;Speichern</translation>
+    </message>
+    <message>
+        <location filename="../src/gui/dialogs/qfiledialog.cpp" line="416"/>
+        <source>Open</source>
+        <translation>?ffnen</translation>
+    </message>
+    <message>
+        <location filename="../src/gui/dialogs/qfiledialog.cpp" line="1557"/>
+        <source>%1 already exists.
+Do you want to replace it?</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/gui/dialogs/qfiledialog.cpp" line="1575"/>
+        <source>%1
+File not found.
+Please verify the correct file name was given.</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/gui/itemviews/qdirmodel.cpp" line="823"/>
+        <source>My Computer</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/gui/dialogs/qfiledialog.cpp" line="442"/>
+        <source>&amp;Rename</source>
+        <translation>&amp;Umbenennen</translation>
+    </message>
+    <message>
+        <location filename="../src/gui/dialogs/qfiledialog.cpp" line="443"/>
+        <source>&amp;Delete</source>
+        <translation>&amp;L?schen</translation>
+    </message>
+    <message>
+        <location filename="../src/gui/dialogs/qfiledialog.cpp" line="444"/>
+        <source>Show &amp;hidden files</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/gui/ui_qfiledialog.h" line="257"/>
+        <source>Back</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/gui/ui_qfiledialog.h" line="259"/>
+        <source>Parent Directory</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/gui/ui_qfiledialog.h" line="261"/>
+        <source>List View</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/gui/ui_qfiledialog.h" line="262"/>
+        <source>Detail View</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/gui/ui_qfiledialog.h" line="263"/>
+        <source>Files of type:</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/gui/dialogs/qfiledialog.cpp" line="749"/>
+        <source>Directory:</source>
+        <translation>Verzeichnis:</translation>
+    </message>
+    <message>
+        <location filename="../src/gui/dialogs/qfiledialog.cpp" line="1518"/>
+        <source>File not found.
+Please verify the correct file name was given</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/gui/dialogs/qfiledialog.cpp" line="2269"/>
+        <source>%1
+Directory not found.
+Please verify the correct directory name was given.</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/gui/dialogs/qfiledialog.cpp" line="2104"/>
+        <source>&apos;%1&apos; is write protected.
+Do you want to delete it anyway?</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/gui/dialogs/qfiledialog.cpp" line="2109"/>
+        <source>Are sure you want to delete &apos;%1&apos;?</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/gui/dialogs/qfiledialog.cpp" line="2120"/>
+        <source>Could not delete directory.</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/gui/dialogs/qfiledialog_win.cpp" line="105"/>
+        <source>All Files (*.*)</source>
+        <translation>Alle Dateien (*.*)</translation>
+    </message>
+    <message>
+        <location filename="../src/gui/dialogs/qfiledialog.cpp" line="418"/>
+        <source>Save As</source>
+        <translation>Speichern unter</translation>
+    </message>
+    <message>
+        <location filename="../src/gui/itemviews/qfileiconprovider.cpp" line="332"/>
+        <source>Drive</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/gui/itemviews/qfileiconprovider.cpp" line="336"/>
+        <source>File</source>
+        <translation>Datei</translation>
+    </message>
+    <message>
+        <location filename="../src/gui/itemviews/qfileiconprovider.cpp" line="365"/>
+        <source>Unknown</source>
+        <translation>unbekannt</translation>
+    </message>
+    <message>
+        <location filename="../src/gui/dialogs/qfiledialog.cpp" line="420"/>
+        <source>Find Directory</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/gui/dialogs/qfiledialog.cpp" line="438"/>
+        <source>Show</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/gui/ui_qfiledialog.h" line="258"/>
+        <source>Forward</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/gui/dialogs/qfiledialog.cpp" line="1997"/>
+        <source>New Folder</source>
+        <translation>Neuer Ordner</translation>
+    </message>
+    <message>
+        <location filename="../src/gui/dialogs/qfiledialog.cpp" line="445"/>
+        <source>&amp;New Folder</source>
+        <translation>&amp;Neuer Ordner</translation>
+    </message>
+    <message>
+        <location filename="../src/gui/dialogs/qfiledialog.cpp" line="782"/>
+        <source>&amp;Choose</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/gui/dialogs/qsidebar.cpp" line="376"/>
+        <source>Remove</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/gui/dialogs/qfiledialog.cpp" line="752"/>
+        <source>File &amp;name:</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/gui/ui_qfiledialog.h" line="256"/>
+        <source>Look in:</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/gui/ui_qfiledialog.h" line="260"/>
+        <source>Create New Folder</source>
+        <translation type="unfinished"></translation>
+    </message>
+</context>
+<context>
+    <name>QFileSystemModel</name>
+    <message>
+        <location filename="../src/gui/dialogs/qfilesystemmodel.cpp" line="560"/>
+        <source>Invalid filename</source>
+        <translation>ung?ltiger Dateiname</translation>
+    </message>
+    <message>
+        <location filename="../src/gui/dialogs/qfilesystemmodel.cpp" line="562"/>
+        <source>&lt;b&gt;The name &quot;%1&quot; can not be used.&lt;/b&gt;&lt;p&gt;Try using another name, with fewer characters or no punctuations marks.</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/gui/dialogs/qfilesystemmodel.cpp" line="607"/>
+        <source>Name</source>
+        <translation>Name</translation>
+    </message>
+    <message>
+        <location filename="../src/gui/dialogs/qfilesystemmodel.cpp" line="609"/>
+        <source>Size</source>
+        <translation>Gr??e</translation>
+    </message>
+    <message>
+        <location filename="../src/gui/dialogs/qfilesystemmodel.cpp" line="613"/>
+        <source>Kind</source>
+        <comment>Match OS X Finder</comment>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/gui/dialogs/qfilesystemmodel.cpp" line="615"/>
+        <source>Type</source>
+        <comment>All other platforms</comment>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/gui/dialogs/qfilesystemmodel.cpp" line="622"/>
+        <source>Date Modified</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/gui/dialogs/qfilesystemmodel_p.h" line="261"/>
+        <source>My Computer</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/gui/dialogs/qfilesystemmodel_p.h" line="263"/>
+        <source>Computer</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/gui/dialogs/qfilesystemmodel.cpp" line="479"/>
+        <source>%1 TB</source>
+        <translation>%1 TB</translation>
+    </message>
+    <message>
+        <location filename="../src/gui/dialogs/qfilesystemmodel.cpp" line="481"/>
+        <source>%1 GB</source>
+        <translation>%1 GB</translation>
+    </message>
+    <message>
+        <location filename="../src/gui/dialogs/qfilesystemmodel.cpp" line="483"/>
+        <source>%1 MB</source>
+        <translation>%1 MB</translation>
+    </message>
+    <message>
+        <location filename="../src/gui/dialogs/qfilesystemmodel.cpp" line="485"/>
+        <source>%1 KB</source>
+        <translation>%1 KB</translation>
+    </message>
+    <message>
+        <location filename="../src/gui/dialogs/qfilesystemmodel.cpp" line="486"/>
+        <source>%1 bytes</source>
+        <translation type="unfinished"></translation>
+    </message>
+</context>
+<context>
+    <name>QFontDialog</name>
+    <message>
+        <location filename="../src/gui/dialogs/qfontdialog.cpp" line="786"/>
+        <source>&amp;Font</source>
+        <translation>&amp;Schriftart</translation>
+    </message>
+    <message>
+        <location filename="../src/gui/dialogs/qfontdialog.cpp" line="787"/>
+        <source>Font st&amp;yle</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/gui/dialogs/qfontdialog.cpp" line="788"/>
+        <source>&amp;Size</source>
+        <translation>&amp;Gr??e</translation>
+    </message>
+    <message>
+        <location filename="../src/gui/dialogs/qfontdialog.cpp" line="789"/>
+        <source>Effects</source>
+        <translation>Effekte</translation>
+    </message>
+    <message>
+        <location filename="../src/gui/dialogs/qfontdialog.cpp" line="790"/>
+        <source>Stri&amp;keout</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/gui/dialogs/qfontdialog.cpp" line="791"/>
+        <source>&amp;Underline</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/gui/dialogs/qfontdialog.cpp" line="792"/>
+        <source>Sample</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/gui/dialogs/qfontdialog.cpp" line="793"/>
+        <source>Wr&amp;iting System</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/gui/dialogs/qfontdialog.cpp" line="449"/>
+        <source>Select Font</source>
+        <translation type="unfinished"></translation>
+    </message>
+</context>
+<context>
+    <name>QFtp</name>
+    <message>
+        <location filename="../src/qt3support/network/q3ftp.cpp" line="653"/>
+        <source>Not connected</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/qt3support/network/q3ftp.cpp" line="718"/>
+        <source>Host %1 not found</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/qt3support/network/q3ftp.cpp" line="722"/>
+        <source>Connection refused to host %1</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/qt3support/network/q3ftp.cpp" line="2327"/>
+        <source>Connected to host %1</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/qt3support/network/q3ftp.cpp" line="985"/>
+        <source>Connection refused for data connection</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/qt3support/network/q3ftp.cpp" line="1960"/>
+        <source>Unknown error</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/qt3support/network/q3ftp.cpp" line="2037"/>
+        <source>Connecting to host failed:
+%1</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/qt3support/network/q3ftp.cpp" line="2040"/>
+        <source>Login failed:
+%1</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/qt3support/network/q3ftp.cpp" line="2043"/>
+        <source>Listing directory failed:
+%1</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/qt3support/network/q3ftp.cpp" line="2046"/>
+        <source>Changing directory failed:
+%1</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/qt3support/network/q3ftp.cpp" line="2049"/>
+        <source>Downloading file failed:
+%1</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/qt3support/network/q3ftp.cpp" line="2052"/>
+        <source>Uploading file failed:
+%1</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/qt3support/network/q3ftp.cpp" line="2055"/>
+        <source>Removing file failed:
+%1</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/qt3support/network/q3ftp.cpp" line="2058"/>
+        <source>Creating directory failed:
+%1</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/qt3support/network/q3ftp.cpp" line="2061"/>
+        <source>Removing directory failed:
+%1</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/qt3support/network/q3ftp.cpp" line="2336"/>
+        <source>Connection closed</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/qt3support/network/q3ftp.cpp" line="2325"/>
+        <source>Host %1 found</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/qt3support/network/q3ftp.cpp" line="2329"/>
+        <source>Connection to %1 closed</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/qt3support/network/q3ftp.cpp" line="2332"/>
+        <source>Host found</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/qt3support/network/q3ftp.cpp" line="2334"/>
+        <source>Connected to host</source>
+        <translation type="unfinished"></translation>
+    </message>
+</context>
+<context>
+    <name>QHostInfo</name>
+    <message>
+        <location filename="../src/network/qhostinfo_p.h" line="136"/>
+        <source>Unknown error</source>
+        <translation type="unfinished"></translation>
+    </message>
+</context>
+<context>
+    <name>QHostInfoAgent</name>
+    <message>
+        <location filename="../src/network/qhostinfo_win.cpp" line="207"/>
+        <source>Host not found</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/network/qhostinfo_win.cpp" line="202"/>
+        <source>Unknown address type</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/network/qhostinfo_win.cpp" line="210"/>
+        <source>Unknown error</source>
+        <translation type="unfinished"></translation>
+    </message>
+</context>
+<context>
+    <name>QHttp</name>
+    <message>
+        <location filename="../src/qt3support/network/q3http.cpp" line="1749"/>
+        <source>Unknown error</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/qt3support/network/q3http.cpp" line="1379"/>
+        <source>Request aborted</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/qt3support/network/q3http.cpp" line="1760"/>
+        <source>No server set to connect to</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/qt3support/network/q3http.cpp" line="1816"/>
+        <source>Wrong content length</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/qt3support/network/q3http.cpp" line="1820"/>
+        <source>Server closed connection unexpectedly</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/qt3support/network/q3http.cpp" line="1858"/>
+        <source>Connection refused</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/qt3support/network/q3http.cpp" line="1861"/>
+        <source>Host %1 not found</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/qt3support/network/q3http.cpp" line="1864"/>
+        <source>HTTP request failed</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/qt3support/network/q3http.cpp" line="1933"/>
+        <source>Invalid HTTP response header</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/qt3support/network/q3http.cpp" line="2020"/>
+        <source>Invalid HTTP chunked body</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/qt3support/network/q3http.cpp" line="2314"/>
+        <source>Host %1 found</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/qt3support/network/q3http.cpp" line="2317"/>
+        <source>Connected to host %1</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/qt3support/network/q3http.cpp" line="2320"/>
+        <source>Connection to %1 closed</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/qt3support/network/q3http.cpp" line="2328"/>
+        <source>Host found</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/qt3support/network/q3http.cpp" line="2331"/>
+        <source>Connected to host</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/qt3support/network/q3http.cpp" line="2334"/>
+        <source>Connection closed</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/network/qhttp.cpp" line="2652"/>
+        <source>Proxy authentication required</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/network/qhttp.cpp" line="2656"/>
+        <source>Authentication required</source>
+        <translation type="unfinished"></translation>
+    </message>
+</context>
+<context>
+    <name>QHttpSocketEngine</name>
+    <message>
+        <location filename="../src/network/qhttpsocketengine.cpp" line="492"/>
+        <source>Authentication required</source>
+        <translation type="unfinished"></translation>
+    </message>
+</context>
+<context>
+    <name>QIBaseDriver</name>
+    <message>
+        <location filename="../src/sql/drivers/ibase/qsql_ibase.cpp" line="1344"/>
+        <source>Error opening database</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/sql/drivers/ibase/qsql_ibase.cpp" line="1377"/>
+        <source>Could not start transaction</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/sql/drivers/ibase/qsql_ibase.cpp" line="1390"/>
+        <source>Unable to commit transaction</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/sql/drivers/ibase/qsql_ibase.cpp" line="1403"/>
+        <source>Unable to rollback transaction</source>
+        <translation type="unfinished"></translation>
+    </message>
+</context>
+<context>
+    <name>QIBaseResult</name>
+    <message>
+        <location filename="../src/sql/drivers/ibase/qsql_ibase.cpp" line="353"/>
+        <source>Unable to create BLOB</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/sql/drivers/ibase/qsql_ibase.cpp" line="359"/>
+        <source>Unable to write BLOB</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/sql/drivers/ibase/qsql_ibase.cpp" line="373"/>
+        <source>Unable to open BLOB</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/sql/drivers/ibase/qsql_ibase.cpp" line="391"/>
+        <source>Unable to read BLOB</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/sql/drivers/ibase/qsql_ibase.cpp" line="703"/>
+        <source>Could not find array</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/sql/drivers/ibase/qsql_ibase.cpp" line="546"/>
+        <source>Could not get array data</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/sql/drivers/ibase/qsql_ibase.cpp" line="758"/>
+        <source>Could not get query info</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/sql/drivers/ibase/qsql_ibase.cpp" line="778"/>
+        <source>Could not start transaction</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/sql/drivers/ibase/qsql_ibase.cpp" line="797"/>
+        <source>Unable to commit transaction</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/sql/drivers/ibase/qsql_ibase.cpp" line="830"/>
+        <source>Could not allocate statement</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/sql/drivers/ibase/qsql_ibase.cpp" line="835"/>
+        <source>Could not prepare statement</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/sql/drivers/ibase/qsql_ibase.cpp" line="848"/>
+        <source>Could not describe input statement</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/sql/drivers/ibase/qsql_ibase.cpp" line="857"/>
+        <source>Could not describe statement</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/sql/drivers/ibase/qsql_ibase.cpp" line="972"/>
+        <source>Unable to close statement</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/sql/drivers/ibase/qsql_ibase.cpp" line="980"/>
+        <source>Unable to execute query</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/sql/drivers/ibase/qsql_ibase.cpp" line="1022"/>
+        <source>Could not fetch next item</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/sql/drivers/ibase/qsql_ibase.cpp" line="1182"/>
+        <source>Could not get statement info</source>
+        <translation type="unfinished"></translation>
+    </message>
+</context>
+<context>
+    <name>QIODevice</name>
+    <message>
+        <location filename="../src/corelib/global/qglobal.cpp" line="1982"/>
+        <source>Permission denied</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/corelib/global/qglobal.cpp" line="1985"/>
+        <source>Too many open files</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/corelib/global/qglobal.cpp" line="1988"/>
+        <source>No such file or directory</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/corelib/global/qglobal.cpp" line="1991"/>
+        <source>No space left on device</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/corelib/io/qiodevice.cpp" line="1484"/>
+        <source>Unknown error</source>
+        <translation type="unfinished"></translation>
+    </message>
+</context>
+<context>
+    <name>QInputContext</name>
+    <message>
+        <location filename="../src/gui/inputmethod/qinputcontextfactory.cpp" line="202"/>
+        <source>XIM</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/gui/inputmethod/qinputcontextfactory.cpp" line="225"/>
+        <source>XIM input method</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/gui/inputmethod/qinputcontextfactory.cpp" line="229"/>
+        <source>Windows input method</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/gui/inputmethod/qinputcontextfactory.cpp" line="233"/>
+        <source>Mac OS X input method</source>
+        <translation type="unfinished"></translation>
+    </message>
+</context>
+<context>
+    <name>QLibrary</name>
+    <message>
+        <location filename="../src/corelib/plugin/qlibrary_win.cpp" line="50"/>
+        <source>QLibrary::load_sys: Cannot load %1 (%2)</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/corelib/plugin/qlibrary_win.cpp" line="76"/>
+        <source>QLibrary::unload_sys: Cannot unload %1 (%2)</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/corelib/plugin/qlibrary_win.cpp" line="91"/>
+        <source>QLibrary::resolve_sys: Symbol &quot;%1&quot; undefined in %2 (%3)</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/corelib/plugin/qlibrary.cpp" line="355"/>
+        <source>Could not mmap &apos;%1&apos;: %2</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/corelib/plugin/qlibrary.cpp" line="376"/>
+        <source>Plugin verification data mismatch in &apos;%1&apos;</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/corelib/plugin/qlibrary.cpp" line="383"/>
+        <source>Could not unmap &apos;%1&apos;: %2</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/corelib/plugin/qlibrary.cpp" line="620"/>
+        <source>The plugin &apos;%1&apos; uses incompatible Qt library. (%2.%3.%4) [%5]</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/corelib/plugin/qlibrary.cpp" line="636"/>
+        <source>The plugin &apos;%1&apos; uses incompatible Qt library. Expected build key &quot;%2&quot;, got &quot;%3&quot;</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/corelib/plugin/qlibrary.cpp" line="928"/>
+        <source>Unknown error</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/corelib/plugin/qlibrary.cpp" line="602"/>
+        <source>The shared library was not found.</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/corelib/plugin/qlibrary.cpp" line="604"/>
+        <source>The file &apos;%1&apos; is not a valid Qt plugin.</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/corelib/plugin/qlibrary.cpp" line="643"/>
+        <source>The plugin &apos;%1&apos; uses incompatible Qt library. (Cannot mix debug and release libraries.)</source>
+        <translation type="unfinished"></translation>
+    </message>
+</context>
+<context>
+    <name>QLineEdit</name>
+    <message>
+        <location filename="../src/gui/widgets/qlineedit.cpp" line="2489"/>
+        <source>&amp;Undo</source>
+        <translation>&amp;R?ckg?ngig</translation>
+    </message>
+    <message>
+        <location filename="../src/gui/widgets/qlineedit.cpp" line="2491"/>
+        <source>&amp;Redo</source>
+        <translation>&amp;Wiederholen</translation>
+    </message>
+    <message>
+        <location filename="../src/gui/widgets/qlineedit.cpp" line="2495"/>
+        <source>Cu&amp;t</source>
+        <translation>&amp;Ausschneiden</translation>
+    </message>
+    <message>
+        <location filename="../src/gui/widgets/qlineedit.cpp" line="2497"/>
+        <source>&amp;Copy</source>
+        <translation>&amp;Kopieren</translation>
+    </message>
+    <message>
+        <location filename="../src/gui/widgets/qlineedit.cpp" line="2499"/>
+        <source>&amp;Paste</source>
+        <translation>&amp;Einf?gen</translation>
+    </message>
+    <message>
+        <location filename="../src/gui/widgets/qlineedit.cpp" line="2502"/>
+        <source>Delete</source>
+        <translation>L?schen</translation>
+    </message>
+    <message>
+        <location filename="../src/gui/widgets/qlineedit.cpp" line="2506"/>
+        <source>Select All</source>
+        <translation>Alles ausw?hlen</translation>
+    </message>
+</context>
+<context>
+    <name>QMYSQLDriver</name>
+    <message>
+        <location filename="../src/sql/drivers/mysql/qsql_mysql.cpp" line="1077"/>
+        <source>Unable to open database &apos;</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/sql/drivers/mysql/qsql_mysql.cpp" line="1084"/>
+        <source>Unable to connect</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/sql/drivers/mysql/qsql_mysql.cpp" line="1204"/>
+        <source>Unable to begin transaction</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/sql/drivers/mysql/qsql_mysql.cpp" line="1221"/>
+        <source>Unable to commit transaction</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/sql/drivers/mysql/qsql_mysql.cpp" line="1238"/>
+        <source>Unable to rollback transaction</source>
+        <translation type="unfinished"></translation>
+    </message>
+</context>
+<context>
+    <name>QMYSQLResult</name>
+    <message>
+        <location filename="../src/sql/drivers/mysql/qsql_mysql.cpp" line="444"/>
+        <source>Unable to fetch data</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/sql/drivers/mysql/qsql_mysql.cpp" line="594"/>
+        <source>Unable to execute query</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/sql/drivers/mysql/qsql_mysql.cpp" line="600"/>
+        <source>Unable to store result</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/sql/drivers/mysql/qsql_mysql.cpp" line="731"/>
+        <source>Unable to prepare statement</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/sql/drivers/mysql/qsql_mysql.cpp" line="762"/>
+        <source>Unable to reset statement</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/sql/drivers/mysql/qsql_mysql.cpp" line="849"/>
+        <source>Unable to bind value</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/sql/drivers/mysql/qsql_mysql.cpp" line="860"/>
+        <source>Unable to execute statement</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/sql/drivers/mysql/qsql_mysql.cpp" line="895"/>
+        <source>Unable to bind outvalues</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/sql/drivers/mysql/qsql_mysql.cpp" line="883"/>
+        <source>Unable to store statement results</source>
+        <translation type="unfinished"></translation>
+    </message>
+</context>
+<context>
+    <name>QMdiSubWindow</name>
+    <message>
+        <location filename="../src/gui/widgets/qmdisubwindow.cpp" line="255"/>
+        <source>%1 - [%2]</source>
+        <translation>%1 - [%2]</translation>
+    </message>
+    <message>
+        <location filename="../src/gui/widgets/qmdisubwindow.cpp" line="547"/>
+        <source>Close</source>
+        <translation>Schlie?en</translation>
+    </message>
+    <message>
+        <location filename="../src/gui/widgets/qmdisubwindow.cpp" line="550"/>
+        <source>Minimize</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/gui/widgets/qmdisubwindow.cpp" line="553"/>
+        <source>Restore Down</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/gui/widgets/qmdisubwindow.cpp" line="893"/>
+        <source>&amp;Restore</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/gui/widgets/qmdisubwindow.cpp" line="896"/>
+        <source>&amp;Move</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/gui/widgets/qmdisubwindow.cpp" line="897"/>
+        <source>&amp;Size</source>
+        <translation>&amp;Gr??e</translation>
+    </message>
+    <message>
+        <location filename="../src/gui/widgets/qmdisubwindow.cpp" line="898"/>
+        <source>Mi&amp;nimize</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/gui/widgets/qmdisubwindow.cpp" line="900"/>
+        <source>Ma&amp;ximize</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/gui/widgets/qmdisubwindow.cpp" line="902"/>
+        <source>Stay on &amp;Top</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/gui/widgets/qmdisubwindow.cpp" line="905"/>
+        <source>&amp;Close</source>
+        <translation>Sch&amp;lie?en</translation>
+    </message>
+</context>
+<context>
+    <name>QMenu</name>
+    <message>
+        <location filename="../src/plugins/accessible/widgets/qaccessiblemenu.cpp" line="345"/>
+        <source>Close</source>
+        <translation>Schlie?en</translation>
+    </message>
+    <message>
+        <location filename="../src/plugins/accessible/widgets/qaccessiblemenu.cpp" line="346"/>
+        <source>Open</source>
+        <translation>?ffnen</translation>
+    </message>
+    <message>
+        <location filename="../src/plugins/accessible/widgets/qaccessiblemenu.cpp" line="399"/>
+        <source>Execute</source>
+        <translation type="unfinished"></translation>
+    </message>
+</context>
+<context>
+    <name>QMenuBar</name>
+    <message>
+        <location filename="../src/gui/widgets/qmenu_mac.cpp" line="308"/>
+        <source>About</source>
+        <translation>?ber</translation>
+    </message>
+    <message>
+        <location filename="../src/gui/widgets/qmenu_mac.cpp" line="314"/>
+        <source>Config</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/gui/widgets/qmenu_mac.cpp" line="315"/>
+        <source>Preference</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/gui/widgets/qmenu_mac.cpp" line="316"/>
+        <source>Options</source>
+        <translation>Optionen</translation>
+    </message>
+    <message>
+        <location filename="../src/gui/widgets/qmenu_mac.cpp" line="317"/>
+        <source>Setting</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/gui/widgets/qmenu_mac.cpp" line="318"/>
+        <source>Setup</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/gui/widgets/qmenu_mac.cpp" line="320"/>
+        <source>Quit</source>
+        <translation>Beenden</translation>
+    </message>
+    <message>
+        <location filename="../src/gui/widgets/qmenu_mac.cpp" line="321"/>
+        <source>Exit</source>
+        <translation>Beenden</translation>
+    </message>
+    <message>
+        <location filename="../src/gui/widgets/qmenu_mac.cpp" line="356"/>
+        <source>About %1</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/gui/widgets/qmenu_mac.cpp" line="358"/>
+        <source>About Qt</source>
+        <translation>?ber Qt</translation>
+    </message>
+    <message>
+        <location filename="../src/gui/widgets/qmenu_mac.cpp" line="360"/>
+        <source>Preferences</source>
+        <translation>Einstellungen</translation>
+    </message>
+    <message>
+        <location filename="../src/gui/widgets/qmenu_mac.cpp" line="362"/>
+        <source>Quit %1</source>
+        <translation>Beenden %1</translation>
+    </message>
+</context>
+<context>
+    <name>QMessageBox</name>
+    <message>
+        <location filename="../src/gui/dialogs/qdialog.cpp" line="585"/>
+        <source>Help</source>
+        <translation>Hilfe</translation>
+    </message>
+    <message>
+        <location filename="../src/gui/dialogs/qmessagebox.h" line="274"/>
+        <source>OK</source>
+        <translation>OK</translation>
+    </message>
+    <message>
+        <location filename="../src/gui/dialogs/qmessagebox.cpp" line="1456"/>
+        <source>About Qt</source>
+        <translation>?ber Qt</translation>
+    </message>
+    <message>
+        <location filename="../src/gui/dialogs/qmessagebox.cpp" line="1636"/>
+        <source>&lt;p&gt;This program uses Qt version %1.&lt;/p&gt;</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/gui/dialogs/qmessagebox.cpp" line="1635"/>
+        <source>&lt;h3&gt;About Qt&lt;/h3&gt;%1&lt;p&gt;Qt is a C++ toolkit for cross-platform application development.&lt;/p&gt;&lt;p&gt;Qt provides single-source portability across MS&amp;nbsp;Windows, Mac&amp;nbsp;OS&amp;nbsp;X, Linux, and all major commercial Unix variants. Qt is also available for embedded devices as Qtopia Core.&lt;/p&gt;&lt;p&gt;Qt is a Trolltech product. See &lt;a href=&quot;http://www.trolltech.com/qt/&quot;&gt;www.trolltech.com/qt/&lt;/a&gt; for more information.&lt;/p&gt;</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/gui/dialogs/qmessagebox.cpp" line="83"/>
+        <source>Show Details...</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/gui/dialogs/qmessagebox.cpp" line="83"/>
+        <source>Hide Details...</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/gui/dialogs/qmessagebox.cpp" line="1644"/>
+        <source>&lt;p&gt;This program uses Qt Open Source Edition version %1.&lt;/p&gt;&lt;p&gt;Qt Open Source Edition is intended for the development of Open Source applications. You need a commercial Qt license for development of proprietary (closed source) applications.&lt;/p&gt;&lt;p&gt;Please see &lt;a href=&quot;http://www.trolltech.com/company/model/&quot;&gt;www.trolltech.com/company/model/&lt;/a&gt; for an overview of Qt licensing.&lt;/p&gt;</source>
+        <translation type="unfinished"></translation>
+    </message>
+</context>
+<context>
+    <name>QMultiInputContext</name>
+    <message>
+        <location filename="../src/plugins/inputmethods/imsw-multi/qmultiinputcontext.cpp" line="55"/>
+        <source>Select IM</source>
+        <translation type="unfinished"></translation>
+    </message>
+</context>
+<context>
+    <name>QMultiInputContextPlugin</name>
+    <message>
+        <location filename="../src/plugins/inputmethods/imsw-multi/qmultiinputcontextplugin.cpp" line="66"/>
+        <source>Multiple input method switcher</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/plugins/inputmethods/imsw-multi/qmultiinputcontextplugin.cpp" line="73"/>
+        <source>Multiple input method switcher that uses the context menu of the text widgets</source>
+        <translation type="unfinished"></translation>
+    </message>
+</context>
+<context>
+    <name>QNativeSocketEngine</name>
+    <message>
+        <location filename="../src/network/qnativesocketengine.cpp" line="169"/>
+        <source>The remote host closed the connection</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/network/qnativesocketengine.cpp" line="172"/>
+        <source>Network operation timed out</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/network/qnativesocketengine.cpp" line="175"/>
+        <source>Out of resources</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/network/qnativesocketengine.cpp" line="178"/>
+        <source>Unsupported socket operation</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/network/qnativesocketengine.cpp" line="181"/>
+        <source>Protocol type not supported</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/network/qnativesocketengine.cpp" line="184"/>
+        <source>Invalid socket descriptor</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/network/qnativesocketengine.cpp" line="190"/>
+        <source>Network unreachable</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/network/qnativesocketengine.cpp" line="193"/>
+        <source>Permission denied</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/network/qnativesocketengine.cpp" line="196"/>
+        <source>Connection timed out</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/network/qnativesocketengine.cpp" line="199"/>
+        <source>Connection refused</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/network/qnativesocketengine.cpp" line="202"/>
+        <source>The bound address is already in use</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/network/qnativesocketengine.cpp" line="205"/>
+        <source>The address is not available</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/network/qnativesocketengine.cpp" line="208"/>
+        <source>The address is protected</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/network/qnativesocketengine.cpp" line="214"/>
+        <source>Unable to send a message</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/network/qnativesocketengine.cpp" line="217"/>
+        <source>Unable to receive a message</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/network/qnativesocketengine.cpp" line="220"/>
+        <source>Unable to write</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/network/qnativesocketengine.cpp" line="223"/>
+        <source>Network error</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/network/qnativesocketengine.cpp" line="226"/>
+        <source>Another socket is already listening on the same port</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/network/qnativesocketengine.cpp" line="160"/>
+        <source>Unable to initialize non-blocking socket</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/network/qnativesocketengine.cpp" line="163"/>
+        <source>Unable to initialize broadcast socket</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/network/qnativesocketengine.cpp" line="166"/>
+        <source>Attempt to use IPv6 socket on a platform with no IPv6 support</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/network/qnativesocketengine.cpp" line="187"/>
+        <source>Host unreachable</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/network/qnativesocketengine.cpp" line="211"/>
+        <source>Datagram was too large to send</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/network/qnativesocketengine.cpp" line="229"/>
+        <source>Operation on non-socket</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/network/qnativesocketengine.cpp" line="232"/>
+        <source>Unknown error</source>
+        <translation type="unfinished"></translation>
+    </message>
+</context>
+<context>
+    <name>QOCIDriver</name>
+    <message>
+        <location filename="../src/sql/drivers/oci/qsql_oci.cpp" line="1919"/>
+        <source>Unable to logon</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/sql/drivers/oci/qsql_oci.cpp" line="1783"/>
+        <source>Unable to initialize</source>
+        <comment>QOCIDriver</comment>
+        <translation type="unfinished"></translation>
+    </message>
+</context>
+<context>
+    <name>QOCIResult</name>
+    <message>
+        <location filename="../src/sql/drivers/oci/qsql_oci.cpp" line="1283"/>
+        <source>Unable to bind column for batch execute</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/sql/drivers/oci/qsql_oci.cpp" line="1297"/>
+        <source>Unable to execute batch statement</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/sql/drivers/oci/qsql_oci.cpp" line="1574"/>
+        <source>Unable to goto next</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/sql/drivers/oci/qsql_oci.cpp" line="1631"/>
+        <source>Unable to alloc statement</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/sql/drivers/oci/qsql_oci.cpp" line="1646"/>
+        <source>Unable to prepare statement</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/sql/drivers/oci/qsql_oci.cpp" line="1664"/>
+        <source>Unable to bind value</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/sql/drivers/oci/qsql_oci.cpp" line="1689"/>
+        <source>Unable to execute select statement</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/sql/drivers/oci/qsql_oci.cpp" line="1706"/>
+        <source>Unable to execute statement</source>
+        <translation type="unfinished"></translation>
+    </message>
+</context>
+<context>
+    <name>QODBCDriver</name>
+    <message>
+        <location filename="../src/sql/drivers/odbc/qsql_odbc.cpp" line="1518"/>
+        <source>Unable to connect</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/sql/drivers/odbc/qsql_odbc.cpp" line="1525"/>
+        <source>Unable to connect - Driver doesn&apos;t support all needed functionality</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/sql/drivers/odbc/qsql_odbc.cpp" line="1708"/>
+        <source>Unable to disable autocommit</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/sql/drivers/odbc/qsql_odbc.cpp" line="1725"/>
+        <source>Unable to commit transaction</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/sql/drivers/odbc/qsql_odbc.cpp" line="1742"/>
+        <source>Unable to rollback transaction</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/sql/drivers/odbc/qsql_odbc.cpp" line="1757"/>
+        <source>Unable to enable autocommit</source>
+        <translation type="unfinished"></translation>
+    </message>
+</context>
+<context>
+    <name>QODBCResult</name>
+    <message>
+        <location filename="../src/sql/drivers/odbc/qsql_odbc.cpp" line="1056"/>
+        <source>QODBCResult::reset: Unable to set &apos;SQL_CURSOR_STATIC&apos; as statement attribute. Please check your ODBC driver configuration</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/sql/drivers/odbc/qsql_odbc.cpp" line="1317"/>
+        <source>Unable to execute statement</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/sql/drivers/odbc/qsql_odbc.cpp" line="820"/>
+        <source>Unable to fetch next</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/sql/drivers/odbc/qsql_odbc.cpp" line="1073"/>
+        <source>Unable to prepare statement</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/sql/drivers/odbc/qsql_odbc.cpp" line="1308"/>
+        <source>Unable to bind variable</source>
+        <translation type="unfinished"></translation>
+    </message>
+</context>
+<context>
+    <name>QObject</name>
+    <message>
+        <location filename="../src/gui/util/qdesktopservices_mac.cpp" line="147"/>
+        <source>Home</source>
+        <translation type="unfinished"></translation>
+    </message>
+</context>
+<context>
+    <name>QPSQLDriver</name>
+    <message>
+        <location filename="../src/sql/drivers/psql/qsql_psql.cpp" line="548"/>
+        <source>Unable to connect</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/sql/drivers/psql/qsql_psql.cpp" line="587"/>
+        <source>Could not begin transaction</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/sql/drivers/psql/qsql_psql.cpp" line="604"/>
+        <source>Could not commit transaction</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/sql/drivers/psql/qsql_psql.cpp" line="620"/>
+        <source>Could not rollback transaction</source>
+        <translation type="unfinished"></translation>
+    </message>
+</context>
+<context>
+    <name>QPSQLResult</name>
+    <message>
+        <location filename="../src/sql/drivers/psql/qsql_psql.cpp" line="140"/>
+        <source>Unable to create query</source>
+        <translation type="unfinished"></translation>
+    </message>
+</context>
+<context>
+    <name>QPluginLoader</name>
+    <message>
+        <location filename="../src/corelib/plugin/qpluginloader.cpp" line="251"/>
+        <source>Unknown error</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/corelib/plugin/qpluginloader.cpp" line="194"/>
+        <source>The plugin was not loaded.</source>
+        <translation type="unfinished"></translation>
+    </message>
+</context>
+<context>
+    <name>QPrintDialog</name>
+    <message>
+        <location filename="../src/gui/dialogs/qprintdialog_unix.cpp" line="186"/>
+        <source>locally connected</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/gui/dialogs/qprintdialog_unix.cpp" line="411"/>
+        <source>Aliases: %1</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/gui/dialogs/qprintdialog_unix.cpp" line="854"/>
+        <source>unknown</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/gui/dialogs/qprintdialog_unix.cpp" line="947"/>
+        <source>Portrait</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/gui/dialogs/qprintdialog_unix.cpp" line="948"/>
+        <source>Landscape</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/gui/dialogs/qprintdialog_unix.cpp" line="776"/>
+        <source>A0 (841 x 1189 mm)</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/gui/dialogs/qprintdialog_unix.cpp" line="777"/>
+        <source>A1 (594 x 841 mm)</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/gui/dialogs/qprintdialog_unix.cpp" line="778"/>
+        <source>A2 (420 x 594 mm)</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/gui/dialogs/qprintdialog_unix.cpp" line="779"/>
+        <source>A3 (297 x 420 mm)</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/gui/dialogs/qprintdialog_unix.cpp" line="780"/>
+        <source>A4 (210 x 297 mm, 8.26 x 11.7 inches)</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/gui/dialogs/qprintdialog_unix.cpp" line="781"/>
+        <source>A5 (148 x 210 mm)</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/gui/dialogs/qprintdialog_unix.cpp" line="782"/>
+        <source>A6 (105 x 148 mm)</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/gui/dialogs/qprintdialog_unix.cpp" line="783"/>
+        <source>A7 (74 x 105 mm)</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/gui/dialogs/qprintdialog_unix.cpp" line="784"/>
+        <source>A8 (52 x 74 mm)</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/gui/dialogs/qprintdialog_unix.cpp" line="785"/>
+        <source>A9 (37 x 52 mm)</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/gui/dialogs/qprintdialog_unix.cpp" line="786"/>
+        <source>B0 (1000 x 1414 mm)</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/gui/dialogs/qprintdialog_unix.cpp" line="787"/>
+        <source>B1 (707 x 1000 mm)</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/gui/dialogs/qprintdialog_unix.cpp" line="788"/>
+        <source>B2 (500 x 707 mm)</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/gui/dialogs/qprintdialog_unix.cpp" line="789"/>
+        <source>B3 (353 x 500 mm)</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/gui/dialogs/qprintdialog_unix.cpp" line="790"/>
+        <source>B4 (250 x 353 mm)</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/gui/dialogs/qprintdialog_unix.cpp" line="791"/>
+        <source>B5 (176 x 250 mm, 6.93 x 9.84 inches)</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/gui/dialogs/qprintdialog_unix.cpp" line="792"/>
+        <source>B6 (125 x 176 mm)</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/gui/dialogs/qprintdialog_unix.cpp" line="793"/>
+        <source>B7 (88 x 125 mm)</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/gui/dialogs/qprintdialog_unix.cpp" line="794"/>
+        <source>B8 (62 x 88 mm)</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/gui/dialogs/qprintdialog_unix.cpp" line="795"/>
+        <source>B9 (44 x 62 mm)</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/gui/dialogs/qprintdialog_unix.cpp" line="796"/>
+        <source>B10 (31 x 44 mm)</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/gui/dialogs/qprintdialog_unix.cpp" line="797"/>
+        <source>C5E (163 x 229 mm)</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/gui/dialogs/qprintdialog_unix.cpp" line="798"/>
+        <source>DLE (110 x 220 mm)</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/gui/dialogs/qprintdialog_unix.cpp" line="799"/>
+        <source>Executive (7.5 x 10 inches, 191 x 254 mm)</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/gui/dialogs/qprintdialog_unix.cpp" line="800"/>
+        <source>Folio (210 x 330 mm)</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/gui/dialogs/qprintdialog_unix.cpp" line="801"/>
+        <source>Ledger (432 x 279 mm)</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/gui/dialogs/qprintdialog_unix.cpp" line="802"/>
+        <source>Legal (8.5 x 14 inches, 216 x 356 mm)</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/gui/dialogs/qprintdialog_unix.cpp" line="803"/>
+        <source>Letter (8.5 x 11 inches, 216 x 279 mm)</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/gui/dialogs/qprintdialog_unix.cpp" line="804"/>
+        <source>Tabloid (279 x 432 mm)</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/gui/dialogs/qprintdialog_unix.cpp" line="805"/>
+        <source>US Common #10 Envelope (105 x 241 mm)</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/gui/dialogs/qpagesetupdialog_unix.cpp" line="155"/>
+        <source>OK</source>
+        <translation>OK</translation>
+    </message>
+    <message>
+        <location filename="../src/gui/dialogs/qpagesetupdialog_unix.cpp" line="156"/>
+        <source>Cancel</source>
+        <translation>Abbrechen</translation>
+    </message>
+    <message>
+        <location filename="../src/gui/dialogs/qpagesetupdialog_unix.cpp" line="130"/>
+        <source>Page size:</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/gui/dialogs/qprintdialog.ui" line="56"/>
+        <source>Orientation:</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/gui/dialogs/qpagesetupdialog_unix.cpp" line="141"/>
+        <source>Paper source:</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/gui/dialogs/qprintdialog_unix.cpp" line="951"/>
+        <source>Print</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/gui/dialogs/qprintdialog_unix.cpp" line="1025"/>
+        <source>File</source>
+        <translation>Datei</translation>
+    </message>
+    <message>
+        <location filename="../src/gui/dialogs/qprintdialog_unix.cpp" line="1050"/>
+        <source>Printer</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/gui/dialogs/qprintdialog_unix.cpp" line="1136"/>
+        <source>Print To File ...</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/gui/dialogs/qprintdialog.ui" line="25"/>
+        <source>Print dialog</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/gui/dialogs/qprintdialog.ui" line="37"/>
+        <source>Paper format</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/gui/dialogs/qprintdialog.ui" line="49"/>
+        <source>Size:</source>
+        <translation>Gr??e:</translation>
+    </message>
+    <message>
+        <location filename="../src/gui/dialogs/qprintdialog.ui" line="162"/>
+        <source>Properties</source>
+        <translation>Einstellungen</translation>
+    </message>
+    <message>
+        <location filename="../src/gui/dialogs/qprintdialog.ui" line="179"/>
+        <source>Printer info:</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/gui/dialogs/qprintdialog.ui" line="239"/>
+        <source>Browse</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/gui/dialogs/qprintdialog.ui" line="259"/>
+        <source>Print to file</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/gui/dialogs/qprintdialog_qws.cpp" line="347"/>
+        <source>Print range</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/gui/dialogs/qprintdialog_qws.cpp" line="345"/>
+        <source>Print all</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/gui/dialogs/qprintdialog.ui" line="307"/>
+        <source>Pages from</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/gui/dialogs/qprintdialog.ui" line="321"/>
+        <source>to</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/gui/dialogs/qprintdialog.ui" line="350"/>
+        <source>Selection</source>
+        <translation>Auswahl</translation>
+    </message>
+    <message>
+        <location filename="../src/gui/dialogs/qprintdialog.ui" line="368"/>
+        <source>Copies</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/gui/dialogs/qprintdialog.ui" line="388"/>
+        <source>Number of copies:</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/gui/dialogs/qprintdialog.ui" line="423"/>
+        <source>Collate</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/gui/dialogs/qprintdialog.ui" line="430"/>
+        <source>Print last page first</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/gui/dialogs/qprintdialog.ui" line="448"/>
+        <source>Other</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/gui/dialogs/qprintdialog.ui" line="460"/>
+        <source>Print in color if available</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/gui/dialogs/qprintdialog.ui" line="470"/>
+        <source>Double side printing</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/gui/dialogs/qprintdialog_unix.cpp" line="1178"/>
+        <source>File %1 is not writable.
+Please choose a different file name.</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/gui/dialogs/qprintdialog_unix.cpp" line="1182"/>
+        <source>%1 already exists.
+Do you want to overwrite it?</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/gui/dialogs/qprintdialog_qws.cpp" line="118"/>
+        <source>File exists</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/gui/dialogs/qprintdialog_qws.cpp" line="119"/>
+        <source>&lt;qt&gt;Do you want to overwrite it?&lt;/qt&gt;</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/gui/dialogs/qprintdialog_qws.cpp" line="346"/>
+        <source>Print selection</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/gui/dialogs/qprintdialog_unix.cpp" line="1174"/>
+        <source>%1 is a directory.
+Please choose a different file name.</source>
+        <translation type="unfinished"></translation>
+    </message>
+</context>
+<context>
+    <name>QPrintPropertiesDialog</name>
+    <message>
+        <location filename="../src/gui/dialogs/qprintpropertiesdialog.ui" line="27"/>
+        <source>PPD Properties</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/gui/dialogs/qprintpropertiesdialog.ui" line="54"/>
+        <source>Save</source>
+        <translation>Speichern</translation>
+    </message>
+    <message>
+        <location filename="../src/gui/dialogs/qprintpropertiesdialog.ui" line="74"/>
+        <source>OK</source>
+        <translation>OK</translation>
+    </message>
+</context>
+<context>
+    <name>QProgressDialog</name>
+    <message>
+        <location filename="../src/gui/dialogs/qprogressdialog.cpp" line="147"/>
+        <source>Cancel</source>
+        <translation>abbrechen</translation>
+    </message>
+</context>
+<context>
+    <name>QPushButton</name>
+    <message>
+        <location filename="../src/plugins/accessible/widgets/simplewidgets.cpp" line="80"/>
+        <source>Open</source>
+        <translation>?ffnen</translation>
+    </message>
+</context>
+<context>
+    <name>QRadioButton</name>
+    <message>
+        <location filename="../src/plugins/accessible/widgets/simplewidgets.cpp" line="92"/>
+        <source>Check</source>
+        <translation type="unfinished"></translation>
+    </message>
+</context>
+<context>
+    <name>QRegExp</name>
+    <message>
+        <location filename="../src/corelib/tools/qregexp.cpp" line="31"/>
+        <source>no error occurred</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/corelib/tools/qregexp.cpp" line="32"/>
+        <source>disabled feature used</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/corelib/tools/qregexp.cpp" line="33"/>
+        <source>bad char class syntax</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/corelib/tools/qregexp.cpp" line="34"/>
+        <source>bad lookahead syntax</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/corelib/tools/qregexp.cpp" line="35"/>
+        <source>bad repetition syntax</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/corelib/tools/qregexp.cpp" line="36"/>
+        <source>invalid octal value</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/corelib/tools/qregexp.cpp" line="37"/>
+        <source>missing left delim</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/corelib/tools/qregexp.cpp" line="38"/>
+        <source>unexpected end</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/corelib/tools/qregexp.cpp" line="40"/>
+        <source>met internal limit</source>
+        <translation type="unfinished"></translation>
+    </message>
+</context>
+<context>
+    <name>QSQLite2Driver</name>
+    <message>
+        <location filename="../src/sql/drivers/sqlite2/qsql_sqlite2.cpp" line="346"/>
+        <source>Error to open database</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/sql/drivers/sqlite2/qsql_sqlite2.cpp" line="387"/>
+        <source>Unable to begin transaction</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/sql/drivers/sqlite2/qsql_sqlite2.cpp" line="404"/>
+        <source>Unable to commit transaction</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/sql/drivers/sqlite2/qsql_sqlite2.cpp" line="421"/>
+        <source>Unable to rollback Transaction</source>
+        <translation type="unfinished"></translation>
+    </message>
+</context>
+<context>
+    <name>QSQLite2Result</name>
+    <message>
+        <location filename="../src/sql/drivers/sqlite2/qsql_sqlite2.cpp" line="118"/>
+        <source>Unable to fetch results</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/sql/drivers/sqlite2/qsql_sqlite2.cpp" line="251"/>
+        <source>Unable to execute statement</source>
+        <translation type="unfinished"></translation>
+    </message>
+</context>
+<context>
+    <name>QSQLiteDriver</name>
+    <message>
+        <location filename="../src/sql/drivers/sqlite/qsql_sqlite.cpp" line="461"/>
+        <source>Error opening database</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/sql/drivers/sqlite/qsql_sqlite.cpp" line="472"/>
+        <source>Error closing database</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/sql/drivers/sqlite/qsql_sqlite.cpp" line="492"/>
+        <source>Unable to begin transaction</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/sql/drivers/sqlite/qsql_sqlite.cpp" line="507"/>
+        <source>Unable to commit transaction</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/sql/drivers/sqlite/qsql_sqlite.cpp" line="522"/>
+        <source>Unable to roll back transaction</source>
+        <translation type="unfinished"></translation>
+    </message>
+</context>
+<context>
+    <name>QSQLiteResult</name>
+    <message>
+        <location filename="../src/sql/drivers/sqlite/qsql_sqlite.cpp" line="213"/>
+        <source>Unable to fetch row</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/sql/drivers/sqlite/qsql_sqlite.cpp" line="265"/>
+        <source>Unable to execute statement</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/sql/drivers/sqlite/qsql_sqlite.cpp" line="284"/>
+        <source>Unable to reset statement</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/sql/drivers/sqlite/qsql_sqlite.cpp" line="328"/>
+        <source>Unable to bind parameters</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/sql/drivers/sqlite/qsql_sqlite.cpp" line="335"/>
+        <source>Parameter count mismatch</source>
+        <translation type="unfinished"></translation>
+    </message>
+</context>
+<context>
+    <name>QScrollBar</name>
+    <message>
+        <location filename="../src/gui/widgets/qscrollbar.cpp" line="396"/>
+        <source>Scroll here</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/gui/widgets/qscrollbar.cpp" line="399"/>
+        <source>Left edge</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/gui/widgets/qscrollbar.cpp" line="399"/>
+        <source>Top</source>
+        <translation>open</translation>
+    </message>
+    <message>
+        <location filename="../src/gui/widgets/qscrollbar.cpp" line="401"/>
+        <source>Right edge</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/gui/widgets/qscrollbar.cpp" line="401"/>
+        <source>Bottom</source>
+        <translation>unten</translation>
+    </message>
+    <message>
+        <location filename="../src/gui/widgets/qscrollbar.cpp" line="404"/>
+        <source>Page left</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/plugins/accessible/widgets/rangecontrols.cpp" line="532"/>
+        <source>Page up</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/gui/widgets/qscrollbar.cpp" line="406"/>
+        <source>Page right</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/plugins/accessible/widgets/rangecontrols.cpp" line="536"/>
+        <source>Page down</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/gui/widgets/qscrollbar.cpp" line="409"/>
+        <source>Scroll left</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/gui/widgets/qscrollbar.cpp" line="409"/>
+        <source>Scroll up</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/gui/widgets/qscrollbar.cpp" line="411"/>
+        <source>Scroll right</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/gui/widgets/qscrollbar.cpp" line="411"/>
+        <source>Scroll down</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/plugins/accessible/widgets/rangecontrols.cpp" line="530"/>
+        <source>Line up</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/plugins/accessible/widgets/rangecontrols.cpp" line="534"/>
+        <source>Position</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/plugins/accessible/widgets/rangecontrols.cpp" line="538"/>
+        <source>Line down</source>
+        <translation type="unfinished"></translation>
+    </message>
+</context>
+<context>
+    <name>QShortcut</name>
+    <message>
+        <location filename="../src/gui/kernel/qkeysequence.cpp" line="288"/>
+        <source>Space</source>
+        <translation>Leerzeichen</translation>
+    </message>
+    <message>
+        <location filename="../src/gui/kernel/qkeysequence.cpp" line="289"/>
+        <source>Esc</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/gui/kernel/qkeysequence.cpp" line="290"/>
+        <source>Tab</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/gui/kernel/qkeysequence.cpp" line="291"/>
+        <source>Backtab</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/gui/kernel/qkeysequence.cpp" line="292"/>
+        <source>Backspace</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/gui/kernel/qkeysequence.cpp" line="293"/>
+        <source>Return</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/gui/kernel/qkeysequence.cpp" line="294"/>
+        <source>Enter</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/gui/kernel/qkeysequence.cpp" line="295"/>
+        <source>Ins</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/gui/kernel/qkeysequence.cpp" line="296"/>
+        <source>Del</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/gui/kernel/qkeysequence.cpp" line="297"/>
+        <source>Pause</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/gui/kernel/qkeysequence.cpp" line="298"/>
+        <source>Print</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/gui/kernel/qkeysequence.cpp" line="299"/>
+        <source>SysReq</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/gui/kernel/qkeysequence.cpp" line="300"/>
+        <source>Home</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/gui/kernel/qkeysequence.cpp" line="301"/>
+        <source>End</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/gui/kernel/qkeysequence.cpp" line="302"/>
+        <source>Left</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/gui/kernel/qkeysequence.cpp" line="303"/>
+        <source>Up</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/gui/kernel/qkeysequence.cpp" line="304"/>
+        <source>Right</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/gui/kernel/qkeysequence.cpp" line="305"/>
+        <source>Down</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/gui/kernel/qkeysequence.cpp" line="306"/>
+        <source>PgUp</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/gui/kernel/qkeysequence.cpp" line="307"/>
+        <source>PgDown</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/gui/kernel/qkeysequence.cpp" line="308"/>
+        <source>CapsLock</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/gui/kernel/qkeysequence.cpp" line="309"/>
+        <source>NumLock</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/gui/kernel/qkeysequence.cpp" line="310"/>
+        <source>ScrollLock</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/gui/kernel/qkeysequence.cpp" line="311"/>
+        <source>Menu</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/gui/kernel/qkeysequence.cpp" line="312"/>
+        <source>Help</source>
+        <translation>Hilfe</translation>
+    </message>
+    <message>
+        <location filename="../src/gui/kernel/qkeysequence.cpp" line="315"/>
+        <source>Back</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/gui/kernel/qkeysequence.cpp" line="316"/>
+        <source>Forward</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/gui/kernel/qkeysequence.cpp" line="317"/>
+        <source>Stop</source>
+        <translation>Stop</translation>
+    </message>
+    <message>
+        <location filename="../src/gui/kernel/qkeysequence.cpp" line="318"/>
+        <source>Refresh</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/gui/kernel/qkeysequence.cpp" line="319"/>
+        <source>Volume Down</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/gui/kernel/qkeysequence.cpp" line="320"/>
+        <source>Volume Mute</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/gui/kernel/qkeysequence.cpp" line="321"/>
+        <source>Volume Up</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/gui/kernel/qkeysequence.cpp" line="322"/>
+        <source>Bass Boost</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/gui/kernel/qkeysequence.cpp" line="323"/>
+        <source>Bass Up</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/gui/kernel/qkeysequence.cpp" line="324"/>
+        <source>Bass Down</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/gui/kernel/qkeysequence.cpp" line="325"/>
+        <source>Treble Up</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/gui/kernel/qkeysequence.cpp" line="326"/>
+        <source>Treble Down</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/gui/kernel/qkeysequence.cpp" line="327"/>
+        <source>Media Play</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/gui/kernel/qkeysequence.cpp" line="328"/>
+        <source>Media Stop</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/gui/kernel/qkeysequence.cpp" line="329"/>
+        <source>Media Previous</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/gui/kernel/qkeysequence.cpp" line="330"/>
+        <source>Media Next</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/gui/kernel/qkeysequence.cpp" line="331"/>
+        <source>Media Record</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/gui/kernel/qkeysequence.cpp" line="333"/>
+        <source>Favorites</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/gui/kernel/qkeysequence.cpp" line="334"/>
+        <source>Search</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/gui/kernel/qkeysequence.cpp" line="335"/>
+        <source>Standby</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/gui/kernel/qkeysequence.cpp" line="336"/>
+        <source>Open URL</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/gui/kernel/qkeysequence.cpp" line="337"/>
+        <source>Launch Mail</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/gui/kernel/qkeysequence.cpp" line="338"/>
+        <source>Launch Media</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/gui/kernel/qkeysequence.cpp" line="339"/>
+        <source>Launch (0)</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/gui/kernel/qkeysequence.cpp" line="340"/>
+        <source>Launch (1)</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/gui/kernel/qkeysequence.cpp" line="341"/>
+        <source>Launch (2)</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/gui/kernel/qkeysequence.cpp" line="342"/>
+        <source>Launch (3)</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/gui/kernel/qkeysequence.cpp" line="343"/>
+        <source>Launch (4)</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/gui/kernel/qkeysequence.cpp" line="344"/>
+        <source>Launch (5)</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/gui/kernel/qkeysequence.cpp" line="345"/>
+        <source>Launch (6)</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/gui/kernel/qkeysequence.cpp" line="346"/>
+        <source>Launch (7)</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/gui/kernel/qkeysequence.cpp" line="347"/>
+        <source>Launch (8)</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/gui/kernel/qkeysequence.cpp" line="348"/>
+        <source>Launch (9)</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/gui/kernel/qkeysequence.cpp" line="349"/>
+        <source>Launch (A)</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/gui/kernel/qkeysequence.cpp" line="350"/>
+        <source>Launch (B)</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/gui/kernel/qkeysequence.cpp" line="351"/>
+        <source>Launch (C)</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/gui/kernel/qkeysequence.cpp" line="352"/>
+        <source>Launch (D)</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/gui/kernel/qkeysequence.cpp" line="353"/>
+        <source>Launch (E)</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/gui/kernel/qkeysequence.cpp" line="354"/>
+        <source>Launch (F)</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/gui/kernel/qkeysequence.cpp" line="358"/>
+        <source>Print Screen</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/gui/kernel/qkeysequence.cpp" line="359"/>
+        <source>Page Up</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/gui/kernel/qkeysequence.cpp" line="360"/>
+        <source>Page Down</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/gui/kernel/qkeysequence.cpp" line="361"/>
+        <source>Caps Lock</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/gui/kernel/qkeysequence.cpp" line="362"/>
+        <source>Num Lock</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/gui/kernel/qkeysequence.cpp" line="363"/>
+        <source>Number Lock</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/gui/kernel/qkeysequence.cpp" line="364"/>
+        <source>Scroll Lock</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/gui/kernel/qkeysequence.cpp" line="365"/>
+        <source>Insert</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/gui/kernel/qkeysequence.cpp" line="366"/>
+        <source>Delete</source>
+        <translation>L?schen</translation>
+    </message>
+    <message>
+        <location filename="../src/gui/kernel/qkeysequence.cpp" line="367"/>
+        <source>Escape</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/gui/kernel/qkeysequence.cpp" line="368"/>
+        <source>System Request</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/gui/kernel/qkeysequence.cpp" line="372"/>
+        <source>Select</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/gui/kernel/qkeysequence.cpp" line="373"/>
+        <source>Yes</source>
+        <translation>Ja</translation>
+    </message>
+    <message>
+        <location filename="../src/gui/kernel/qkeysequence.cpp" line="374"/>
+        <source>No</source>
+        <translation>Nein</translation>
+    </message>
+    <message>
+        <location filename="../src/gui/kernel/qkeysequence.cpp" line="378"/>
+        <source>Context1</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/gui/kernel/qkeysequence.cpp" line="379"/>
+        <source>Context2</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/gui/kernel/qkeysequence.cpp" line="380"/>
+        <source>Context3</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/gui/kernel/qkeysequence.cpp" line="381"/>
+        <source>Context4</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/gui/kernel/qkeysequence.cpp" line="382"/>
+        <source>Call</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/gui/kernel/qkeysequence.cpp" line="383"/>
+        <source>Hangup</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/gui/kernel/qkeysequence.cpp" line="384"/>
+        <source>Flip</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/gui/kernel/qkeysequence.cpp" line="1020"/>
+        <source>Ctrl</source>
+        <translation>Strg</translation>
+    </message>
+    <message>
+        <location filename="../src/gui/kernel/qkeysequence.cpp" line="1024"/>
+        <source>Shift</source>
+        <translation>Shift</translation>
+    </message>
+    <message>
+        <location filename="../src/gui/kernel/qkeysequence.cpp" line="1022"/>
+        <source>Alt</source>
+        <translation>Alt</translation>
+    </message>
+    <message>
+        <location filename="../src/gui/kernel/qkeysequence.cpp" line="1018"/>
+        <source>Meta</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/gui/kernel/qkeysequence.cpp" line="994"/>
+        <source>+</source>
+        <translation>+</translation>
+    </message>
+    <message>
+        <location filename="../src/gui/kernel/qkeysequence.cpp" line="1039"/>
+        <source>F%1</source>
+        <translation>F%1</translation>
+    </message>
+    <message>
+        <location filename="../src/gui/kernel/qkeysequence.cpp" line="332"/>
+        <source>Home Page</source>
+        <translation type="unfinished"></translation>
+    </message>
+</context>
+<context>
+    <name>QSlider</name>
+    <message>
+        <location filename="../src/plugins/accessible/widgets/rangecontrols.cpp" line="689"/>
+        <source>Page left</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/plugins/accessible/widgets/rangecontrols.cpp" line="689"/>
+        <source>Page up</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/plugins/accessible/widgets/rangecontrols.cpp" line="691"/>
+        <source>Position</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/plugins/accessible/widgets/rangecontrols.cpp" line="694"/>
+        <source>Page right</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/plugins/accessible/widgets/rangecontrols.cpp" line="694"/>
+        <source>Page down</source>
+        <translation type="unfinished"></translation>
+    </message>
+</context>
+<context>
+    <name>QSocks5SocketEngine</name>
+    <message>
+        <location filename="../src/network/qsocks5socketengine.cpp" line="1187"/>
+        <source>Socks5 timeout error connecting to socks server</source>
+        <translation type="unfinished"></translation>
+    </message>
+</context>
+<context>
+    <name>QSpinBox</name>
+    <message>
+        <location filename="../src/plugins/accessible/widgets/rangecontrols.cpp" line="120"/>
+        <source>More</source>
+        <translation>Mehr</translation>
+    </message>
+    <message>
+        <location filename="../src/plugins/accessible/widgets/rangecontrols.cpp" line="122"/>
+        <source>Less</source>
+        <translation type="unfinished"></translation>
+    </message>
+</context>
+<context>
+    <name>QSql</name>
+    <message>
+        <location filename="../src/qt3support/sql/q3sqlmanager_p.cpp" line="870"/>
+        <source>Delete</source>
+        <translation>L?schen</translation>
+    </message>
+    <message>
+        <location filename="../src/qt3support/sql/q3sqlmanager_p.cpp" line="871"/>
+        <source>Delete this record?</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/qt3support/sql/q3sqlmanager_p.cpp" line="924"/>
+        <source>Yes</source>
+        <translation>Ja</translation>
+    </message>
+    <message>
+        <location filename="../src/qt3support/sql/q3sqlmanager_p.cpp" line="925"/>
+        <source>No</source>
+        <translation>Nein</translation>
+    </message>
+    <message>
+        <location filename="../src/qt3support/sql/q3sqlmanager_p.cpp" line="881"/>
+        <source>Insert</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/qt3support/sql/q3sqlmanager_p.cpp" line="883"/>
+        <source>Update</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/qt3support/sql/q3sqlmanager_p.cpp" line="887"/>
+        <source>Save edits?</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/qt3support/sql/q3sqlmanager_p.cpp" line="890"/>
+        <source>Cancel</source>
+        <translation>Abbrechen</translation>
+    </message>
+    <message>
+        <location filename="../src/qt3support/sql/q3sqlmanager_p.cpp" line="922"/>
+        <source>Confirm</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/qt3support/sql/q3sqlmanager_p.cpp" line="923"/>
+        <source>Cancel your edits?</source>
+        <translation type="unfinished"></translation>
+    </message>
+</context>
+<context>
+    <name>QSslSocket</name>
+    <message>
+        <location filename="../src/network/qsslsocket_openssl.cpp" line="483"/>
+        <source>Unable to write data: %1</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/network/qsslsocket_openssl.cpp" line="552"/>
+        <source>Error while reading: %1</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/network/qsslsocket_openssl.cpp" line="582"/>
+        <source>Error during SSL handshake: %1</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/network/qsslsocket_openssl.cpp" line="218"/>
+        <source>Error creating SSL context (%1)</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/network/qsslsocket_openssl.cpp" line="240"/>
+        <source>Invalid or empty cipher list (%1)</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/network/qsslsocket_openssl.cpp" line="291"/>
+        <source>Error creating SSL session, %1</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/network/qsslsocket_openssl.cpp" line="305"/>
+        <source>Error creating SSL session: %1</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/network/qsslsocket_openssl.cpp" line="256"/>
+        <source>Cannot provide a certificate with no key, %1</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/network/qsslsocket_openssl.cpp" line="263"/>
+        <source>Error loading local certificate, %1</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/network/qsslsocket_openssl.cpp" line="275"/>
+        <source>Error loading private key, %1</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/network/qsslsocket_openssl.cpp" line="282"/>
+        <source>Private key do not certificate public key, %1</source>
+        <translation type="unfinished"></translation>
+    </message>
+</context>
+<context>
+    <name>QTDSDriver</name>
+    <message>
+        <location filename="../src/sql/drivers/tds/qsql_tds.cpp" line="550"/>
+        <source>Unable to open connection</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/sql/drivers/tds/qsql_tds.cpp" line="555"/>
+        <source>Unable to use database</source>
+        <translation type="unfinished"></translation>
+    </message>
+</context>
+<context>
+    <name>QTabBar</name>
+    <message>
+        <location filename="../src/plugins/accessible/widgets/complexwidgets.cpp" line="1068"/>
+        <source>Scroll Left</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/plugins/accessible/widgets/complexwidgets.cpp" line="1068"/>
+        <source>Scroll Right</source>
+        <translation type="unfinished"></translation>
+    </message>
+</context>
+<context>
+    <name>QTcpServer</name>
+    <message>
+        <location filename="../src/network/qtcpserver.cpp" line="216"/>
+        <source>Socket operation unsupported</source>
+        <translation type="unfinished"></translation>
+    </message>
+</context>
+<context>
+    <name>QTextControl</name>
+    <message>
+        <location filename="../src/gui/text/qtextcontrol.cpp" line="1861"/>
+        <source>&amp;Undo</source>
+        <translation>&amp;R?ckg?ngig</translation>
+    </message>
+    <message>
+        <location filename="../src/gui/text/qtextcontrol.cpp" line="1863"/>
+        <source>&amp;Redo</source>
+        <translation>&amp;Wiederholen</translation>
+    </message>
+    <message>
+        <location filename="../src/gui/text/qtextcontrol.cpp" line="1867"/>
+        <source>Cu&amp;t</source>
+        <translation>&amp;Ausschneiden</translation>
+    </message>
+    <message>
+        <location filename="../src/gui/text/qtextcontrol.cpp" line="1872"/>
+        <source>&amp;Copy</source>
+        <translation>&amp;Kopieren</translation>
+    </message>
+    <message>
+        <location filename="../src/gui/text/qtextcontrol.cpp" line="1879"/>
+        <source>Copy &amp;Link Location</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/gui/text/qtextcontrol.cpp" line="1885"/>
+        <source>&amp;Paste</source>
+        <translation>&amp;Einf?gen</translation>
+    </message>
+    <message>
+        <location filename="../src/gui/text/qtextcontrol.cpp" line="1888"/>
+        <source>Delete</source>
+        <translation>L?schen</translation>
+    </message>
+    <message>
+        <location filename="../src/gui/text/qtextcontrol.cpp" line="1895"/>
+        <source>Select All</source>
+        <translation type="unfinished"></translation>
+    </message>
+</context>
+<context>
+    <name>QToolButton</name>
+    <message>
+        <location filename="../src/plugins/accessible/widgets/simplewidgets.cpp" line="352"/>
+        <source>Press</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/plugins/accessible/widgets/simplewidgets.cpp" line="356"/>
+        <source>Open</source>
+        <translation>?ffnen</translation>
+    </message>
+</context>
+<context>
+    <name>QUdpSocket</name>
+    <message>
+        <location filename="../src/network/qudpsocket.cpp" line="132"/>
+        <source>This platform does not support IPv6</source>
+        <translation type="unfinished"></translation>
+    </message>
+</context>
+<context>
+    <name>QUndoGroup</name>
+    <message>
+        <location filename="../src/gui/util/qundogroup.cpp" line="341"/>
+        <source>Undo</source>
+        <translation>R?ckg?ngig</translation>
+    </message>
+    <message>
+        <location filename="../src/gui/util/qundogroup.cpp" line="369"/>
+        <source>Redo</source>
+        <translation>Wiederholen</translation>
+    </message>
+</context>
+<context>
+    <name>QUndoModel</name>
+    <message>
+        <location filename="../src/gui/util/qundoview.cpp" line="71"/>
+        <source>&lt;empty&gt;</source>
+        <translation type="unfinished"></translation>
+    </message>
+</context>
+<context>
+    <name>QUndoStack</name>
+    <message>
+        <location filename="../src/gui/util/qundostack.cpp" line="816"/>
+        <source>Undo</source>
+        <translation>R?ckg?ngig</translation>
+    </message>
+    <message>
+        <location filename="../src/gui/util/qundostack.cpp" line="843"/>
+        <source>Redo</source>
+        <translation>Wiederholen</translation>
+    </message>
+</context>
+<context>
+    <name>QUnicodeControlCharacterMenu</name>
+    <message>
+        <location filename="../src/gui/widgets/qtextedit.cpp" line="2586"/>
+        <source>LRM Left-to-right mark</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/gui/widgets/qtextedit.cpp" line="2587"/>
+        <source>RLM Right-to-left mark</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/gui/widgets/qtextedit.cpp" line="2588"/>
+        <source>ZWJ Zero width joiner</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/gui/widgets/qtextedit.cpp" line="2589"/>
+        <source>ZWNJ Zero width non-joiner</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/gui/widgets/qtextedit.cpp" line="2590"/>
+        <source>ZWSP Zero width space</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/gui/widgets/qtextedit.cpp" line="2591"/>
+        <source>LRE Start of left-to-right embedding</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/gui/widgets/qtextedit.cpp" line="2592"/>
+        <source>RLE Start of right-to-left embedding</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/gui/widgets/qtextedit.cpp" line="2593"/>
+        <source>LRO Start of left-to-right override</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/gui/widgets/qtextedit.cpp" line="2594"/>
+        <source>RLO Start of right-to-left override</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/gui/widgets/qtextedit.cpp" line="2595"/>
+        <source>PDF Pop directional formatting</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/gui/widgets/qtextedit.cpp" line="2601"/>
+        <source>Insert Unicode control character</source>
+        <translation type="unfinished"></translation>
+    </message>
+</context>
+<context>
+    <name>QWhatsThisAction</name>
+    <message>
+        <location filename="../src/gui/kernel/qwhatsthis.cpp" line="486"/>
+        <source>What&apos;s This?</source>
+        <translation type="unfinished"></translation>
+    </message>
+</context>
+<context>
+    <name>QWidget</name>
+    <message>
+        <location filename="../src/gui/kernel/qwidget.cpp" line="4131"/>
+        <source>*</source>
+        <translation>*</translation>
+    </message>
+</context>
+<context>
+    <name>QWizard</name>
+    <message>
+        <location filename="../src/gui/dialogs/qwizard.cpp" line="554"/>
+        <source>Go Back</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/gui/dialogs/qwizard.cpp" line="555"/>
+        <source>Continue</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/gui/dialogs/qwizard.cpp" line="565"/>
+        <source>Commit</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/gui/dialogs/qwizard.cpp" line="557"/>
+        <source>Done</source>
+        <translation>Fertig</translation>
+    </message>
+    <message>
+        <location filename="../src/gui/dialogs/qwizard.cpp" line="558"/>
+        <source>Quit</source>
+        <translation>Beenden</translation>
+    </message>
+    <message>
+        <location filename="../src/gui/dialogs/qwizard.cpp" line="559"/>
+        <source>Help</source>
+        <translation>Hilfe</translation>
+    </message>
+    <message>
+        <location filename="../src/gui/dialogs/qwizard.cpp" line="561"/>
+        <source>&lt; &amp;Back</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/gui/dialogs/qwizard.cpp" line="566"/>
+        <source>&amp;Finish</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/gui/dialogs/qwizard.cpp" line="567"/>
+        <source>Cancel</source>
+        <translation>Abbrechen</translation>
+    </message>
+    <message>
+        <location filename="../src/gui/dialogs/qwizard.cpp" line="568"/>
+        <source>&amp;Help</source>
+        <translation>&amp;Hilfe</translation>
+    </message>
+</context>
+<context>
+    <name>QWorkspace</name>
+    <message>
+        <location filename="../src/gui/widgets/qworkspace.cpp" line="1061"/>
+        <source>&amp;Restore</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/gui/widgets/qworkspace.cpp" line="1062"/>
+        <source>&amp;Move</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/gui/widgets/qworkspace.cpp" line="1063"/>
+        <source>&amp;Size</source>
+        <translation>&amp;Gr??e</translation>
+    </message>
+    <message>
+        <location filename="../src/gui/widgets/qworkspace.cpp" line="1065"/>
+        <source>Mi&amp;nimize</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/gui/widgets/qworkspace.cpp" line="1067"/>
+        <source>Ma&amp;ximize</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/gui/widgets/qworkspace.cpp" line="1070"/>
+        <source>&amp;Close</source>
+        <translation>Sch&amp;lie?en</translation>
+    </message>
+    <message>
+        <location filename="../src/gui/widgets/qworkspace.cpp" line="1075"/>
+        <source>Stay on &amp;Top</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/gui/widgets/qworkspace.cpp" line="2137"/>
+        <source>Sh&amp;ade</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/gui/widgets/qworkspace.cpp" line="1919"/>
+        <source>%1 - [%2]</source>
+        <translation>%1 - [%2]</translation>
+    </message>
+    <message>
+        <location filename="../src/gui/widgets/qworkspace.cpp" line="85"/>
+        <source>Minimize</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/gui/widgets/qworkspace.cpp" line="87"/>
+        <source>Restore Down</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/gui/widgets/qworkspace.cpp" line="83"/>
+        <source>Close</source>
+        <translation>Schlie?en</translation>
+    </message>
+    <message>
+        <location filename="../src/gui/widgets/qworkspace.cpp" line="2133"/>
+        <source>&amp;Unshade</source>
+        <translation type="unfinished"></translation>
+    </message>
+</context>
+<context>
+    <name>QXml</name>
+    <message>
+        <location filename="../src/xml/qxml.cpp" line="31"/>
+        <source>no error occurred</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/xml/qxml.cpp" line="32"/>
+        <source>error triggered by consumer</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/xml/qxml.cpp" line="33"/>
+        <source>unexpected end of file</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/xml/qxml.cpp" line="34"/>
+        <source>more than one document type definition</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/xml/qxml.cpp" line="35"/>
+        <source>error occurred while parsing element</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/xml/qxml.cpp" line="36"/>
+        <source>tag mismatch</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/xml/qxml.cpp" line="37"/>
+        <source>error occurred while parsing content</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/xml/qxml.cpp" line="38"/>
+        <source>unexpected character</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/xml/qxml.cpp" line="39"/>
+        <source>invalid name for processing instruction</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/xml/qxml.cpp" line="40"/>
+        <source>version expected while reading the XML declaration</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/xml/qxml.cpp" line="41"/>
+        <source>wrong value for standalone declaration</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/xml/qxml.cpp" line="42"/>
+        <source>encoding declaration or standalone declaration expected while reading the XML declaration</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/xml/qxml.cpp" line="43"/>
+        <source>standalone declaration expected while reading the XML declaration</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/xml/qxml.cpp" line="44"/>
+        <source>error occurred while parsing document type definition</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/xml/qxml.cpp" line="45"/>
+        <source>letter is expected</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/xml/qxml.cpp" line="46"/>
+        <source>error occurred while parsing comment</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/xml/qxml.cpp" line="47"/>
+        <source>error occurred while parsing reference</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/xml/qxml.cpp" line="48"/>
+        <source>internal general entity reference not allowed in DTD</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/xml/qxml.cpp" line="49"/>
+        <source>external parsed general entity reference not allowed in attribute value</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/xml/qxml.cpp" line="50"/>
+        <source>external parsed general entity reference not allowed in DTD</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/xml/qxml.cpp" line="51"/>
+        <source>unparsed entity reference in wrong context</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/xml/qxml.cpp" line="52"/>
+        <source>recursive entities</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/xml/qxml.cpp" line="55"/>
+        <source>error in the text declaration of an external entity</source>
+        <translation type="unfinished"></translation>
+    </message>
+</context>
+<context>
+    <name>QXmlStream</name>
+    <message>
+        <location filename="../src/xml/qxmlstream_p.h" line="1687"/>
+        <source>Extra content at end of document.</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/xml/qxmlstream.cpp" line="613"/>
+        <source>Invalid entity value.</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/xml/qxmlstream.cpp" line="720"/>
+        <source>Invalid XML character.</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/xml/qxmlstream.cpp" line="978"/>
+        <source>Sequence &apos;]]&gt;&apos; not allowed in content.</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/xml/qxmlstream.cpp" line="1286"/>
+        <source>Namespace prefix &apos;%1&apos; not declared</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/xml/qxmlstream.cpp" line="1324"/>
+        <source>Attribute redefined.</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/xml/qxmlstream.cpp" line="1436"/>
+        <source>Unexpected character &apos;%1&apos; in public id literal.</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/xml/qxmlstream.cpp" line="1464"/>
+        <source>Invalid XML version string.</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/xml/qxmlstream.cpp" line="1466"/>
+        <source>Unsupported XML version.</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/xml/qxmlstream.cpp" line="1489"/>
+        <source>%1 is an invalid encoding name.</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/xml/qxmlstream.cpp" line="1496"/>
+        <source>Encoding %1 is unsupported</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/xml/qxmlstream.cpp" line="1498"/>
+        <source>Invalid XML encoding name.</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/xml/qxmlstream.cpp" line="1514"/>
+        <source>Standalone accepts only yes or no.</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/xml/qxmlstream.cpp" line="1516"/>
+        <source>Invalid attribute in XML declaration.</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/xml/qxmlstream.cpp" line="1532"/>
+        <source>Premature end of document.</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/xml/qxmlstream.cpp" line="1534"/>
+        <source>Invalid document.</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/xml/qxmlstream.cpp" line="1574"/>
+        <source>Expected</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/xml/qxmlstream.cpp" line="1585"/>
+        <source>, but got &apos;</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/xml/qxmlstream.cpp" line="1589"/>
+        <source>Unexpected &apos;</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/xml/qxmlstream.cpp" line="1719"/>
+        <source>Expected character data.</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/xml/qxmlstream_p.h" line="718"/>
+        <source>Recursive entity detected.</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/xml/qxmlstream_p.h" line="1223"/>
+        <source>Start tag expected.</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/xml/qxmlstream_p.h" line="1434"/>
+        <source>XML declaration not at start of document.</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/xml/qxmlstream_p.h" line="1403"/>
+        <source>NDATA in parameter entity declaration.</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/xml/qxmlstream_p.h" line="1437"/>
+        <source>%1 is an invalid processing instruction name.</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/xml/qxmlstream_p.h" line="1448"/>
+        <source>Invalid processing instruction name.</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/xml/qxmlstream_p.h" line="1661"/>
+        <source>Illegal namespace declaration.</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/xml/qxmlstream_p.h" line="1676"/>
+        <source>Invalid XML name.</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/xml/qxmlstream_p.h" line="1699"/>
+        <source>Opening and ending tag mismatch.</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/xml/qxmlstream_p.h" line="1708"/>
+        <source>Reference to unparsed entity &apos;%1&apos;.</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/xml/qxmlstream_p.h" line="1774"/>
+        <source>Entity &apos;%1&apos; not declared.</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/xml/qxmlstream_p.h" line="1760"/>
+        <source>Reference to external entity &apos;%1&apos; in attribute value.</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/xml/qxmlstream_p.h" line="1788"/>
+        <source>Invalid character reference.</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/xml/qxmlstream_p.h" line="1011"/>
+        <source>Encountered incorrectly encoded content.</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/xml/qxmlstream.cpp" line="1487"/>
+        <source>The standalone pseudo attribute must appear after the encoding.</source>
+        <translation type="unfinished"></translation>
+    </message>
+    <message>
+        <location filename="../src/xml/qxmlstream_p.h" line="1558"/>
+        <source>%1 is an invalid PUBLIC identifier.</source>
+        <translation type="unfinished"></translation>
+    </message>
+</context>
+</TS>



From gruntster at mail.berlios.de  Mon May 31 21:24:16 2010
From: gruntster at mail.berlios.de (gruntster at mail.berlios.de)
Date: Mon, 31 May 2010 21:24:16 +0200
Subject: [Avidemux-svn-commit] r6276 -
	branches/avidemux_2.5_branch_gruntster/po
Message-ID: <201005311924.o4VJOGM6011770@sheep.berlios.de>

Author: gruntster
Date: 2010-05-31 21:24:10 +0200 (Mon, 31 May 2010)
New Revision: 6276

Modified:
   branches/avidemux_2.5_branch_gruntster/po/qt_filter_context.xslt
Log:
[i18n] don't filter out duplicates from Qt UI strings since they have their own translation context

Modified: branches/avidemux_2.5_branch_gruntster/po/qt_filter_context.xslt
===================================================================
--- branches/avidemux_2.5_branch_gruntster/po/qt_filter_context.xslt	2010-05-31 19:17:06 UTC (rev 6275)
+++ branches/avidemux_2.5_branch_gruntster/po/qt_filter_context.xslt	2010-05-31 19:24:10 UTC (rev 6276)
@@ -1,29 +1,34 @@
-<?xml version="1.0" encoding="utf-8"?>
-
-<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
-	<xsl:output method="xml" encoding="utf-8" />
-	
-	<xsl:template match="TS">
-		<xsl:text disable-output-escaping="yes"><![CDATA[<!DOCTYPE TS>]]></xsl:text>
-		
-		<TS>
-			<xsl:copy-of select="@*" />
-
-			<xsl:for-each select="context/message[not(source = preceding::message/source)]">
-				<xsl:variable name="location" select="location/@filename" />
-
-				<context>
-					<name>
-						<xsl:if test ="substring($location, string-length($location) - 2) = '.ui'">
-							<xsl:value-of select="../name" />
-						</xsl:if>
-					</name>
-
-					<message>
-						<xsl:copy-of select="*" />
-					</message>
-				</context>
-			</xsl:for-each>
-		</TS>
-	</xsl:template>
-</xsl:stylesheet>
\ No newline at end of file
+<?xml version="1.0" encoding="utf-8" ?>
+<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
+  <xsl:output method="xml" encoding="utf-8" indent="yes"/>
+  <xsl:template match="TS">
+    <xsl:text disable-output-escaping="yes"><![CDATA[<!DOCTYPE TS>]]></xsl:text>
+    <TS>
+      <xsl:copy-of select="@*"/>
+      <xsl:for-each select="context">
+        <xsl:call-template name="processContext"/>
+      </xsl:for-each>
+    </TS>
+  </xsl:template>
+
+  <xsl:template name="processContext">
+    <xsl:variable name="filename" select="message[1]/location[1]/@filename"/>
+    <xsl:variable name="ext" select="substring($filename, string-length($filename) - 2)"/>
+
+    <context>
+      <xsl:for-each select="name">
+        <name>
+          <xsl:if test="$ext = '.ui'">
+            <xsl:value-of select="../name"/>
+          </xsl:if>
+        </name>
+      </xsl:for-each>
+
+      <xsl:for-each select="message[not(source = preceding::message/source and $ext != '.ui')]">
+        <message>
+          <xsl:copy-of select="*"/>
+        </message>
+      </xsl:for-each>
+    </context>
+  </xsl:template>
+</xsl:stylesheet>



From gruntster at mail.berlios.de  Mon May 31 21:55:00 2010
From: gruntster at mail.berlios.de (gruntster at mail.berlios.de)
Date: Mon, 31 May 2010 21:55:00 +0200
Subject: [Avidemux-svn-commit] r6277 -
	branches/avidemux_2.5_branch_gruntster/platforms/windows/installer
Message-ID: <201005311955.o4VJt0sG014291@sheep.berlios.de>

Author: gruntster
Date: 2010-05-31 21:54:55 +0200 (Mon, 31 May 2010)
New Revision: 6277

Modified:
   branches/avidemux_2.5_branch_gruntster/platforms/windows/installer/avidemux.nsi
Log:
[win32] add German translation for Qt to Win32 installer

Modified: branches/avidemux_2.5_branch_gruntster/platforms/windows/installer/avidemux.nsi
===================================================================
--- branches/avidemux_2.5_branch_gruntster/platforms/windows/installer/avidemux.nsi	2010-05-31 19:24:10 UTC (rev 6276)
+++ branches/avidemux_2.5_branch_gruntster/platforms/windows/installer/avidemux.nsi	2010-05-31 19:54:55 UTC (rev 6277)
@@ -1214,16 +1214,11 @@
         !insertmacro InstallQtLanguage French fr
     ${MementoSectionEnd}
 
-!ifdef INST_BOTH | INST_GTK
-!ifdef INST_BOTH
-    ${MementoUnselectedSection} "German (GTK+ only)" SecLangGerman
-!else ifdef INST_GTK
 	${MementoUnselectedSection} "German" SecLangGerman
-!endif
         SectionIn 2
         !insertmacro InstallGtkLanguage German de
+		!insertmacro InstallQtLanguage German de
     ${MementoSectionEnd}
-!endif
 
 !ifdef INST_BOTH | INST_GTK
 !ifdef INST_BOTH



From gruntster at mail.berlios.de  Mon May 31 22:14:30 2010
From: gruntster at mail.berlios.de (gruntster at mail.berlios.de)
Date: Mon, 31 May 2010 22:14:30 +0200
Subject: [Avidemux-svn-commit] r6278 - in
	branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_x264:
	. qt4
Message-ID: <201005312014.o4VKEUBS015708@sheep.berlios.de>

Author: gruntster
Date: 2010-05-31 22:14:23 +0200 (Mon, 31 May 2010)
New Revision: 6278

Modified:
   branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_x264/encoder.cpp
   branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_x264/qt4/x264ConfigDialog.cpp
   branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_x264/qt4/x264ConfigDialog.ui
   branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_x264/x264Options.cpp
   branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_x264/x264Options.h
   branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_x264/x264Param.xsd
Log:
[x264] add support for periodic intra refresh

Modified: branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_x264/encoder.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_x264/encoder.cpp	2010-05-31 19:54:55 UTC (rev 6277)
+++ branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_x264/encoder.cpp	2010-05-31 20:14:23 UTC (rev 6278)
@@ -504,6 +504,7 @@
 	printf("[x264] i_keyint_max = %d\n", x264Param->i_keyint_max);
 	printf("[x264] i_keyint_min = %d\n", x264Param->i_keyint_min);
 	printf("[x264] i_scenecut_threshold = %d\n", x264Param->i_scenecut_threshold);
+	printf("[x264] b_intra_refresh = %d\n", x264Param->b_intra_refresh);
 	printf("[x264] analyse.b_mixed_references = %d\n", x264Param->analyse.b_mixed_references);
 	printf("[x264] analyse.b_chroma_me = %d\n", x264Param->analyse.b_chroma_me);
 	printf("[x264] analyse.i_trellis = %d\n", x264Param->analyse.i_trellis);

Modified: branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_x264/qt4/x264ConfigDialog.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_x264/qt4/x264ConfigDialog.cpp	2010-05-31 19:54:55 UTC (rev 6277)
+++ branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_x264/qt4/x264ConfigDialog.cpp	2010-05-31 20:14:23 UTC (rev 6278)
@@ -79,8 +79,6 @@
 	connect(ui.dct8x8CheckBox, SIGNAL(toggled(bool)), this, SLOT(dct8x8CheckBox_toggled(bool)));
 	connect(ui.p8x8CheckBox, SIGNAL(toggled(bool)), this, SLOT(p8x8CheckBox_toggled(bool)));
 
-	ui.scenecutDetectionCheckBox->setVisible(false);
-
 	// Frame tab
 	connect(ui.loopFilterCheckBox, SIGNAL(toggled(bool)), this, SLOT(loopFilterCheckBox_toggled(bool)));
 	connect(ui.cabacCheckBox, SIGNAL(toggled(bool)), this, SLOT(cabacCheckBox_toggled(bool)));
@@ -699,6 +697,7 @@
 	ui.maxGopSizeSpinBox->setValue(options->getGopMaximumSize());
 	ui.minGopSizeSpinBox->setValue(options->getGopMinimumSize());
 	ui.IFrameThresholdSpinBox->setValue(options->getScenecutThreshold());
+	ui.intraRefreshCheckBox->setChecked(options->getIntraRefresh());
 
 	// Analysis tab
 	ui.mixedRefsCheckBox->setChecked(options->getMixedReferences());
@@ -909,6 +908,7 @@
 	options->setGopMaximumSize(ui.maxGopSizeSpinBox->value());
 	options->setGopMinimumSize(ui.minGopSizeSpinBox->value());
 	options->setScenecutThreshold(ui.IFrameThresholdSpinBox->value());
+	options->setIntraRefresh(ui.intraRefreshCheckBox->isChecked());
 
 	// Analysis tab
 	options->setMixedReferences(ui.mixedRefsCheckBox->isChecked());

Modified: branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_x264/qt4/x264ConfigDialog.ui
===================================================================
--- branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_x264/qt4/x264ConfigDialog.ui	2010-05-31 19:54:55 UTC (rev 6277)
+++ branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_x264/qt4/x264ConfigDialog.ui	2010-05-31 20:14:23 UTC (rev 6278)
@@ -1912,9 +1912,9 @@
              </spacer>
             </item>
             <item>
-             <widget class="QCheckBox" name="scenecutDetectionCheckBox" >
+             <widget class="QCheckBox" name="intraRefreshCheckBox" >
               <property name="text" >
-               <string>Pre-scenecut Detection</string>
+               <string>Periodic Intra Refresh</string>
               </property>
              </widget>
             </item>
@@ -4278,7 +4278,7 @@
   <tabstop>minGopSizeSpinBox</tabstop>
   <tabstop>maxGopSizeSpinBox</tabstop>
   <tabstop>IFrameThresholdSpinBox</tabstop>
-  <tabstop>scenecutDetectionCheckBox</tabstop>
+  <tabstop>intraRefreshCheckBox</tabstop>
   <tabstop>mixedRefsCheckBox</tabstop>
   <tabstop>chromaMotionEstCheckBox</tabstop>
   <tabstop>trellisCheckBox</tabstop>

Modified: branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_x264/x264Options.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_x264/x264Options.cpp	2010-05-31 19:54:55 UTC (rev 6277)
+++ branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_x264/x264Options.cpp	2010-05-31 20:14:23 UTC (rev 6278)
@@ -296,6 +296,16 @@
 		_param.i_scenecut_threshold = scenecutThreshold;
 }
 
+bool x264Options::getIntraRefresh(void)
+{
+	return _param.b_intra_refresh;
+}
+
+void x264Options::setIntraRefresh(bool intraRefresh)
+{
+	_param.b_intra_refresh = intraRefresh;
+}
+
 unsigned int x264Options::getBFrames(void)
 {
 	return _param.i_bframe;
@@ -1155,6 +1165,7 @@
 	xmlNewChild(xmlNodeRoot, NULL, (xmlChar*)"gopMaximumSize", number2String(xmlBuffer, bufferSize, getGopMaximumSize()));
 	xmlNewChild(xmlNodeRoot, NULL, (xmlChar*)"gopMinimumSize", number2String(xmlBuffer, bufferSize, getGopMinimumSize()));
 	xmlNewChild(xmlNodeRoot, NULL, (xmlChar*)"scenecutThreshold", number2String(xmlBuffer, bufferSize, getScenecutThreshold()));
+	xmlNewChild(xmlNodeRoot, NULL, (xmlChar*)"periodicIntraRefresh", boolean2String(xmlBuffer, bufferSize, getIntraRefresh()));
 	xmlNewChild(xmlNodeRoot, NULL, (xmlChar*)"bFrames", number2String(xmlBuffer, bufferSize, getBFrames()));
 	xmlNewChild(xmlNodeRoot, NULL, (xmlChar*)"adaptiveBframeDecision", number2String(xmlBuffer, bufferSize, getAdaptiveBFrameDecision()));
 	xmlNewChild(xmlNodeRoot, NULL, (xmlChar*)"bFrameBias", number2String(xmlBuffer, bufferSize, getBFrameBias()));
@@ -1420,6 +1431,8 @@
 				setGopMinimumSize(atoi(content));
 			else if (strcmp((char*)xmlChild->name, "scenecutThreshold") == 0)
 				setScenecutThreshold(atoi(content));
+			else if (strcmp((char*)xmlChild->name, "periodicIntraRefresh") == 0)
+				setIntraRefresh(string2Boolean(content));
 			else if (strcmp((char*)xmlChild->name, "bFrames") == 0)
 				setBFrames(atoi(content));
 			else if (strcmp((char*)xmlChild->name, "adaptiveBframeDecision") == 0)

Modified: branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_x264/x264Options.h
===================================================================
--- branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_x264/x264Options.h	2010-05-31 19:54:55 UTC (rev 6277)
+++ branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_x264/x264Options.h	2010-05-31 20:14:23 UTC (rev 6278)
@@ -115,6 +115,9 @@
 	unsigned int getScenecutThreshold(void);
 	void setScenecutThreshold(unsigned int scenecutThreshold);
 
+	bool getIntraRefresh(void);
+	void setIntraRefresh(bool intraRefresh);
+
 	unsigned int getBFrames(void);
 	void setBFrames(unsigned int bFrames);
 

Modified: branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_x264/x264Param.xsd
===================================================================
--- branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_x264/x264Param.xsd	2010-05-31 19:54:55 UTC (rev 6277)
+++ branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_x264/x264Param.xsd	2010-05-31 20:14:23 UTC (rev 6278)
@@ -186,6 +186,7 @@
                   </xs:restriction>
                 </xs:simpleType>
               </xs:element>
+              <xs:element name="periodicIntraRefresh" type="xs:boolean" minOccurs="0"/>
               <!-- preScenecutDetection deprecated core 67 -->
               <xs:element name="preScenecutDetection" type="xs:boolean" minOccurs="0"/>
               <xs:element name="bFrames" minOccurs="0">



