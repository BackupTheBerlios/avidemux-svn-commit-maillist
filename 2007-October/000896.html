<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Avidemux-svn-commit] r3624 - in	branches/avidemux_2.4_branch/avidemux: ADM_audio	ADM_audiocodec ADM_codecs ADM_inputs/ADM_amv	ADM_libraries/ADM_lavcodec ADM_libraries/ADM_lavutil
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/avidemux-svn-commit/2007-October/index.html" >
   <LINK REL="made" HREF="mailto:avidemux-svn-commit%40lists.berlios.de?Subject=Re%3A%20%5BAvidemux-svn-commit%5D%20r3624%20-%20in%0A%09branches/avidemux_2.4_branch/avidemux%3A%20ADM_audio%0A%09ADM_audiocodec%20ADM_codecs%20ADM_inputs/ADM_amv%0A%09ADM_libraries/ADM_lavcodec%20ADM_libraries/ADM_lavutil&In-Reply-To=%3C200710061727.l96HR3dx000638%40sheep.berlios.de%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000895.html">
   <LINK REL="Next"  HREF="000897.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Avidemux-svn-commit] r3624 - in	branches/avidemux_2.4_branch/avidemux: ADM_audio	ADM_audiocodec ADM_codecs ADM_inputs/ADM_amv	ADM_libraries/ADM_lavcodec ADM_libraries/ADM_lavutil</H1>
    <B>mean at BerliOS</B> 
    <A HREF="mailto:avidemux-svn-commit%40lists.berlios.de?Subject=Re%3A%20%5BAvidemux-svn-commit%5D%20r3624%20-%20in%0A%09branches/avidemux_2.4_branch/avidemux%3A%20ADM_audio%0A%09ADM_audiocodec%20ADM_codecs%20ADM_inputs/ADM_amv%0A%09ADM_libraries/ADM_lavcodec%20ADM_libraries/ADM_lavutil&In-Reply-To=%3C200710061727.l96HR3dx000638%40sheep.berlios.de%3E"
       TITLE="[Avidemux-svn-commit] r3624 - in	branches/avidemux_2.4_branch/avidemux: ADM_audio	ADM_audiocodec ADM_codecs ADM_inputs/ADM_amv	ADM_libraries/ADM_lavcodec ADM_libraries/ADM_lavutil">mean at mail.berlios.de
       </A><BR>
    <I>Sat Oct  6 19:27:03 CEST 2007</I>
    <P><UL>
        <LI>Previous message: <A HREF="000895.html">[Avidemux-svn-commit] r3623 -	branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_toolkit_gtk
</A></li>
        <LI>Next message: <A HREF="000897.html">[Avidemux-svn-commit] r3625 - branches/avidemux_2.4_branch
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#896">[ date ]</a>
              <a href="thread.html#896">[ thread ]</a>
              <a href="subject.html#896">[ subject ]</a>
              <a href="author.html#896">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Author: mean
Date: 2007-10-06 19:27:01 +0200 (Sat, 06 Oct 2007)
New Revision: 3624

Added:
   branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec/sp5xdec.c
Modified:
   branches/avidemux_2.4_branch/avidemux/ADM_audio/audio_packetizer.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_audio/aviaudio.hxx
   branches/avidemux_2.4_branch/avidemux/ADM_audiocodec/ADM_audiocodec.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_audiocodec/ADM_codecwma.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_codecs/ADM_codecs.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_codecs/ADM_ffmp43.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_codecs/ADM_ffmp43.h
   branches/avidemux_2.4_branch/avidemux/ADM_inputs/ADM_amv/ADM_amv.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec/CMakeLists.txt
   branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec/Makefile.am
   branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec/adpcm.c
   branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec/allcodecs.c
   branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec/allcodecs.h
   branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec/avcodec.h
   branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec/ffconf.c
   branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec/ffconf.h
   branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec/mjpegdec.c
   branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavutil/avutil.h
Log:
[AMV] Mostly working amv reading + decoding, except sound

Modified: branches/avidemux_2.4_branch/avidemux/ADM_audio/audio_packetizer.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_audio/audio_packetizer.cpp	2007-10-05 20:42:10 UTC (rev 3623)
+++ branches/avidemux_2.4_branch/avidemux/ADM_audio/audio_packetizer.cpp	2007-10-06 17:27:01 UTC (rev 3624)
@@ -100,6 +100,7 @@
                 case WAV_8BITS_UNSIGNED:
 		case WAV_ULAW:
                 case WAV_MSADPCM:
+                case WAV_AMV_ADPCM:
 				return getPacketPCM(dest,len,samples);
 				break;
 		case WAV_AC3:
@@ -110,7 +111,7 @@
 				return getPacketWMA(dest,len,samples);
 				break;
 		default:
-				printf(&quot;Unsupported!\n&quot;);
+				printf(&quot;*** PACKETIZER : Unsupported!\n&quot;);
 				return 0;
 	}
 	return 0;

Modified: branches/avidemux_2.4_branch/avidemux/ADM_audio/aviaudio.hxx
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_audio/aviaudio.hxx	2007-10-05 20:42:10 UTC (rev 3623)
+++ branches/avidemux_2.4_branch/avidemux/ADM_audio/aviaudio.hxx	2007-10-06 17:27:01 UTC (rev 3624)
@@ -66,6 +66,7 @@
 #define WAV_ULAW	57 // dummy id
 #define WAV_QDM2 	58
 #define WAV_IMAADPCM    17
+#define WAV_AMV_ADPCM    9900
 #define WAV_UNKNOWN     9999
 #include &quot;../ADM_audiocodec/ADM_audiocodec.h&quot;
 #include &quot;ADM_fileio.h&quot;

Modified: branches/avidemux_2.4_branch/avidemux/ADM_audiocodec/ADM_audiocodec.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_audiocodec/ADM_audiocodec.cpp	2007-10-05 20:42:10 UTC (rev 3623)
+++ branches/avidemux_2.4_branch/avidemux/ADM_audiocodec/ADM_audiocodec.cpp	2007-10-06 17:27:01 UTC (rev 3624)
@@ -137,6 +137,11 @@
 						printf(&quot;\n ULAW codec\n&quot;);
 						out=(ADM_Audiocodec *) new ADM_AudiocodecUlaw(fourcc,info);
 						break;
+            case WAV_AMV_ADPCM:
+                printf(&quot;\n Audio codec:  ffAMV\n&quot;);
+                out= (ADM_Audiocodec *) new ADM_AudiocodecWMA(fourcc,info,extra,extraData);
+                break;
+
             case WAV_WMA:
                 printf(&quot;\n Audio codec:  ffWMA\n&quot;);
                 out= (ADM_Audiocodec *) new ADM_AudiocodecWMA(fourcc,info,extra,extraData);

Modified: branches/avidemux_2.4_branch/avidemux/ADM_audiocodec/ADM_codecwma.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_audiocodec/ADM_codecwma.cpp	2007-10-05 20:42:10 UTC (rev 3623)
+++ branches/avidemux_2.4_branch/avidemux/ADM_audiocodec/ADM_codecwma.cpp	2007-10-06 17:27:01 UTC (rev 3624)
@@ -51,7 +51,7 @@
        :  ADM_Audiocodec(fourcc)
  {
     _tail=_head=0;
-    ADM_assert(fourcc==WAV_WMA || fourcc==WAV_QDM2);	
+    ADM_assert(fourcc==WAV_WMA || fourcc==WAV_QDM2 || fourcc==WAV_AMV_ADPCM);	
     _contextVoid=(void *)avcodec_alloc_context();
     ADM_assert(_contextVoid);
     // Fills in some values...
@@ -59,13 +59,20 @@
     _context-&gt;channels = info-&gt;channels;
     _blockalign=_context-&gt;block_align = info-&gt;blockalign;
     _context-&gt;bit_rate = info-&gt;byterate*8;
-    if(fourcc==WAV_WMA)
+    switch(fourcc)
+    {
+      case WAV_WMA:
         _context-&gt;codec_id = CODEC_ID_WMAV2;
-    else
-        if(fourcc==WAV_QDM2)
+        break;
+      case WAV_QDM2:
         _context-&gt;codec_id = CODEC_ID_QDM2;
-            else ADM_assert(0);
-
+        break;
+      case WAV_AMV_ADPCM:
+        _context-&gt;codec_id = CODEC_ID_ADPCM_IMA_AMV;
+        break;
+      default:
+             ADM_assert(0);
+    }
     _context-&gt;extradata=(uint8_t *)d;
     _context-&gt;extradata_size=(int)l;
     printf(&quot; Using %ld bytes of extra header data\n&quot;,l);
@@ -75,7 +82,7 @@
    if(!codec) {GUI_Error_HIG(QT_TR_NOOP(&quot;Internal error&quot;), QT_TR_NOOP(&quot;Cannot open WMA2 codec.&quot;));ADM_assert(0);} 
     if (avcodec_open(_context, codec) &lt; 0)
     {
-        printf(&quot;\n WMA decoder init failed !\n&quot;);
+        printf(&quot;\n Lavc audio decoder init failed !\n&quot;);
         ADM_assert(0);
     }
     if(!_blockalign)

Modified: branches/avidemux_2.4_branch/avidemux/ADM_codecs/ADM_codecs.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_codecs/ADM_codecs.cpp	2007-10-05 20:42:10 UTC (rev 3623)
+++ branches/avidemux_2.4_branch/avidemux/ADM_codecs/ADM_codecs.cpp	2007-10-06 17:27:01 UTC (rev 3624)
@@ -352,7 +352,13 @@
       printf (&quot;\n using YUY2 codec\n&quot;);
       return (decoders *) (new decoderYUY2 (w, h));
     }
+  if (fourCC::check (fcc, (uint8_t *) &quot;AMV &quot;))
+    {
+      printf (&quot;\n using AMV codec\n&quot;);
+      return (decoders *) (new decoderFFAMV (w, h,extraLen,extraData));
+    }
 
+    
   if (fourCC::check (fcc, (uint8_t *) &quot;VP6F&quot;))
     {
       printf (&quot;\n using VP6F codec\n&quot;);

Modified: branches/avidemux_2.4_branch/avidemux/ADM_codecs/ADM_ffmp43.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_codecs/ADM_ffmp43.cpp	2007-10-05 20:42:10 UTC (rev 3623)
+++ branches/avidemux_2.4_branch/avidemux/ADM_codecs/ADM_ffmp43.cpp	2007-10-06 17:27:01 UTC (rev 3624)
@@ -639,7 +639,11 @@
 {
   WRAP_Open (CODEC_ID_FLV1);
 }
-
+decoderFFAMV::decoderFFAMV (uint32_t w, uint32_t h, uint32_t l, uint8_t * d):decoderFF (w,   h)
+{
+  WRAP_Open (CODEC_ID_AMV);
+  //_context-&gt;codec_id=CODEC_ID_AMV;
+}
 decoderFFDVBSub::decoderFFDVBSub (uint32_t w, uint32_t h, uint32_t l, uint8_t * d):decoderFF (w,	   h)
 {
   _context-&gt;sub_id=1;

Modified: branches/avidemux_2.4_branch/avidemux/ADM_codecs/ADM_ffmp43.h
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_codecs/ADM_ffmp43.h	2007-10-05 20:42:10 UTC (rev 3623)
+++ branches/avidemux_2.4_branch/avidemux/ADM_codecs/ADM_ffmp43.h	2007-10-06 17:27:01 UTC (rev 3624)
@@ -321,5 +321,11 @@
 public:
   decoderFFDVBSub (uint32_t w, uint32_t h, uint32_t l, uint8_t * d);
 };
+class decoderFFAMV:public decoderFF
+{
+protected:
+public:
+  decoderFFAMV (uint32_t w, uint32_t h, uint32_t l, uint8_t * d);
+};
 
 #endif

Modified: branches/avidemux_2.4_branch/avidemux/ADM_inputs/ADM_amv/ADM_amv.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_inputs/ADM_amv/ADM_amv.cpp	2007-10-05 20:42:10 UTC (rev 3623)
+++ branches/avidemux_2.4_branch/avidemux/ADM_inputs/ADM_amv/ADM_amv.cpp	2007-10-06 17:27:01 UTC (rev 3624)
@@ -162,7 +162,7 @@
   _isvideopresent=1;
   // Build a fake stream/bih bih
 #define ENTRY(x,y) _videostream.x=y
-  uint32_t codec=MKFCC('M','J','P','G');
+  uint32_t codec=MKFCC('A','M','V',' ');
     ENTRY(	fccType,MKFCC('v','i','d','s'));
     ENTRY(	fccHandler,codec);
     ENTRY(	dwInitialFrames,0);
@@ -181,12 +181,6 @@
     // If audio...
     if(audioTrack.index)
     {
-      wavHeader. 	encoding=WAV_ULAW;
-      wavHeader. 	channels=1;					/* 1 = mono, 2 = stereo */
-      wavHeader. 	frequency=8000;				/* One of 11025, 22050, or 44100 48000 Hz */
-      wavHeader. 	byterate=8000;					/* Average bytes per second */
-      wavHeader. 	blockalign=1;				/* Bytes per sample block */
-      wavHeader. 	bitspersample=16;	 
       _isaudiopresent=1;
       _audio=new amvAudio(name,&amp;audioTrack,&amp;wavHeader);
     }
@@ -316,9 +310,20 @@
     return 0;
   }
   sz=read32();
-  
+  uint32_t pos=ftell(_fd);
   printf(&quot;\t\t[AMV] strf size : %u,sizeof :%u\n&quot;,sz,sizeof(AVIStreamHeader));
-  fseeko(_fd,sz,SEEK_CUR);
+  if(nb==1) // Second track=Audio
+  {
+                                   read16(); // Tag
+      wavHeader. 	channels  =read16();
+      wavHeader. 	frequency =read32();
+      wavHeader. 	byterate  =read32();
+      wavHeader. 	blockalign=read16();
+      wavHeader. 	encoding  =WAV_AMV_ADPCM;       
+      wavHeader. 	bitspersample=16;	 
+ 
+  }
+  fseeko(_fd,sz+pos,SEEK_SET);
   
   return 1;
 }
@@ -433,66 +438,8 @@
  if(frame&gt;=_mainaviheader.dwTotalFrames) return 0;
  amvIndex *idx=&amp;(videoTrack.index[frame]);
  fseeko(_fd,idx-&gt;pos,SEEK_SET);
- 
- uint8_t buffer[idx-&gt;size];
- 
- fread(buffer,idx-&gt;size,1,_fd);
- // Now create a fake jpg header...
- uint8_t *head,*tail;
- 
- tail=&amp;(buffer[idx-&gt;size-2]);// Remove ff D9 EOI
- head=buffer;
- // Search SOI
- while(  (head[0]!=0xff || head[1]!=0xD8) &amp;&amp; head&lt;tail-2) head++;
- if(head&gt;=tail-2) return 0;
- head+=2;
- // Build fake jpg header
- // NB: It might not be jpg after all ...
- uint8_t *m=img-&gt;data;
- *m++=0xFF;
- *m++=0xD8;
- 
-  *m++=0xFF;
-  *m++=0xC0; // SOF0
-  
-  *m++=0x0; // Lf
-  *m++=0x8+3*2; // Lf
-  
-  
-  *m++=0x8; // P: Bits /channel
-  
-  
-  *m++=_video_bih.biHeight &gt;&gt;8;
-  *m++=_video_bih.biHeight &amp;0xFF;
-
-  
-  *m++=_video_bih.biWidth &gt;&gt;8;
-  *m++=_video_bih.biWidth &amp;0xFF;
-
- //
-  *m++=3; // Nf
-  
-  *m++=1; // NCi
-  *m++=1*16+1; // Hvi/VZi
-  *m++=0; // Tqi
-  
-  *m++=2; // NCi
-  *m++=2*16+1; // Hvi/VZi
-  *m++=0; // Tqi
-  
-  *m++=3; // NCi
-  *m++=2*16+1; // Hvi/VZi
-  *m++=0; // Tqi
-  
-  *m++=0xFF; // 
-  *m++=0xDA; // Start of scan
-  
-  memcpy(m,head,tail-head);
-  m+=tail-head;
-  *m++=0xff;
-  *m++=0xD9; // end of image
-  
-  img-&gt;dataLength=m-img-&gt;data;
+ fread(img-&gt;data,idx-&gt;size,1,_fd);
+  img-&gt;dataLength=idx-&gt;size;
   img-&gt;flags=AVI_KEY_FRAME;
  return 1;
 }

Modified: branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec/CMakeLists.txt
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec/CMakeLists.txt	2007-10-05 20:42:10 UTC (rev 3623)
+++ branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec/CMakeLists.txt	2007-10-06 17:27:01 UTC (rev 3624)
@@ -31,6 +31,7 @@
                 dvbsub_parser.c
                 dvbsubdec.c
                 dvbsub.c xiph.c
+                sp5xdec.c
 )
 # ADD x86 ones
 

Modified: branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec/Makefile.am
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec/Makefile.am	2007-10-05 20:42:10 UTC (rev 3623)
+++ branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec/Makefile.am	2007-10-06 17:27:01 UTC (rev 3624)
@@ -69,7 +69,7 @@
                 wma.c \
                 dvbsub_parser.c \
                 dvbsubdec.c \
-                dvbsub.c xiph.c
+                dvbsub.c xiph.c sp5xdec.c
 
 	
 

Modified: branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec/adpcm.c
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec/adpcm.c	2007-10-05 20:42:10 UTC (rev 3623)
+++ branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec/adpcm.c	2007-10-06 17:27:01 UTC (rev 3624)
@@ -50,12 +50,6 @@
 
 #define BLKSIZE 1024
 
-#define CLAMP_TO_SHORT(value) \
-if (value &gt; 32767) \
-    value = 32767; \
-else if (value &lt; -32768) \
-    value = -32768; \
-
 /* step_table[] and index_table[] are from the ADPCM reference source */
 /* This is the index table: */
 static const int index_table[16] = {
@@ -155,7 +149,13 @@
 } ADPCMContext;
 
 /* XXX: implement encoding */
-
+/* MEANX backport from lavcodec/... svn */
+static inline int16_t av_clip_int16(int a)
+{
+    if ((a+32768) &amp; ~65535) return (a&gt;&gt;31) ^ 32767;
+    else                    return a;
+}
+/* MEANX backport from lavcodec/... svn */
 #ifdef CONFIG_ENCODERS
 static int adpcm_encode_init(AVCodecContext *avctx)
 {
@@ -183,7 +183,13 @@
         avctx-&gt;block_align = BLKSIZE;
         break;
     case CODEC_ID_ADPCM_SWF:
-        avctx-&gt;frame_size = 4*BLKSIZE * avctx-&gt;channels;
+        if (avctx-&gt;sample_rate != 11025 &amp;&amp;
+            avctx-&gt;sample_rate != 22050 &amp;&amp;
+            avctx-&gt;sample_rate != 44100) {
+            av_log(avctx, AV_LOG_ERROR, &quot;Sample rate must be 11025, 22050 or 44100\n&quot;);
+            return -1;
+        }
+        avctx-&gt;frame_size = 512 * (avctx-&gt;sample_rate / 11025);
         break;
     default:
         return -1;
@@ -208,8 +214,8 @@
 {
     int delta = sample - c-&gt;prev_sample;
     int nibble = FFMIN(7, abs(delta)*4/step_table[c-&gt;step_index]) + (delta&lt;0)*8;
-    c-&gt;prev_sample = c-&gt;prev_sample + ((step_table[c-&gt;step_index] * yamaha_difflookup[nibble]) / 8);
-    CLAMP_TO_SHORT(c-&gt;prev_sample);
+    c-&gt;prev_sample += ((step_table[c-&gt;step_index] * yamaha_difflookup[nibble]) / 8);
+    c-&gt;prev_sample = av_clip_int16(c-&gt;prev_sample);
     c-&gt;step_index = av_clip(c-&gt;step_index + index_table[nibble], 0, 88);
     return nibble;
 }
@@ -228,10 +234,9 @@
     nibble= av_clip(nibble, -8, 7)&amp;0x0F;
 
     predictor += (signed)((nibble &amp; 0x08)?(nibble - 0x10):(nibble)) * c-&gt;idelta;
-    CLAMP_TO_SHORT(predictor);
 
     c-&gt;sample2 = c-&gt;sample1;
-    c-&gt;sample1 = predictor;
+    c-&gt;sample1 = av_clip_int16(predictor);
 
     c-&gt;idelta = (AdaptationTable[(int)nibble] * c-&gt;idelta) &gt;&gt; 8;
     if (c-&gt;idelta &lt; 16) c-&gt;idelta = 16;
@@ -252,8 +257,8 @@
 
     nibble = FFMIN(7, abs(delta)*4/c-&gt;step) + (delta&lt;0)*8;
 
-    c-&gt;predictor = c-&gt;predictor + ((c-&gt;step * yamaha_difflookup[nibble]) / 8);
-    CLAMP_TO_SHORT(c-&gt;predictor);
+    c-&gt;predictor += ((c-&gt;step * yamaha_difflookup[nibble]) / 8);
+    c-&gt;predictor = av_clip_int16(c-&gt;predictor);
     c-&gt;step = (c-&gt;step * yamaha_indexscale[nibble]) &gt;&gt; 8;
     c-&gt;step = av_clip(c-&gt;step, 127, 24567);
 
@@ -298,7 +303,7 @@
     nodes[0]-&gt;step = c-&gt;step_index;
     nodes[0]-&gt;sample1 = c-&gt;sample1;
     nodes[0]-&gt;sample2 = c-&gt;sample2;
-    if(version == CODEC_ID_ADPCM_IMA_WAV)
+    if((version == CODEC_ID_ADPCM_IMA_WAV) || (version == CODEC_ID_ADPCM_SWF))
         nodes[0]-&gt;sample1 = c-&gt;prev_sample;
     if(version == CODEC_ID_ADPCM_MS)
         nodes[0]-&gt;step = c-&gt;idelta;
@@ -333,7 +338,7 @@
 #define STORE_NODE(NAME, STEP_INDEX)\
                     int d;\
                     uint32_t ssd;\
-                    CLAMP_TO_SHORT(dec_sample);\
+                    dec_sample = av_clip_int16(dec_sample);\
                     d = sample - dec_sample;\
                     ssd = nodes[j]-&gt;ssd + d*d;\
                     if(nodes_next[frontier-1] &amp;&amp; ssd &gt;= nodes_next[frontier-1]-&gt;ssd)\
@@ -369,7 +374,7 @@
                     next_##NAME:;
                     STORE_NODE(ms, FFMAX(16, (AdaptationTable[nibble] * step) &gt;&gt; 8));
                 }
-            } else if(version == CODEC_ID_ADPCM_IMA_WAV) {
+            } else if((version == CODEC_ID_ADPCM_IMA_WAV)|| (version == CODEC_ID_ADPCM_SWF)) {
 #define LOOP_NODES(NAME, STEP_TABLE, STEP_INDEX)\
                 const int predictor = nodes[j]-&gt;sample1;\
                 const int div = (sample - predictor) * 4 / STEP_TABLE;\
@@ -520,23 +525,38 @@
         PutBitContext pb;
         init_put_bits(&amp;pb, dst, buf_size*8);
 
+        n = avctx-&gt;frame_size-1;
+
         //Store AdpcmCodeSize
         put_bits(&amp;pb, 2, 2);                //Set 4bits flash adpcm format
 
         //Init the encoder state
         for(i=0; i&lt;avctx-&gt;channels; i++){
+            c-&gt;status[i].step_index = av_clip(c-&gt;status[i].step_index, 0, 63); // clip step so it fits 6 bits
             put_bits(&amp;pb, 16, samples[i] &amp; 0xFFFF);
-            put_bits(&amp;pb, 6, c-&gt;status[i].step_index &amp; 0x3F);
+            put_bits(&amp;pb, 6, c-&gt;status[i].step_index);
             c-&gt;status[i].prev_sample = (signed short)samples[i];
         }
 
-        for (i=0 ; i&lt;4096 ; i++) {
-            put_bits(&amp;pb, 4, adpcm_ima_compress_sample(&amp;c-&gt;status[0], samples[avctx-&gt;channels*i]) &amp; 0xF);
+        if(avctx-&gt;trellis &gt; 0) {
+            uint8_t buf[2][n];
+            adpcm_compress_trellis(avctx, samples+2, buf[0], &amp;c-&gt;status[0], n);
             if (avctx-&gt;channels == 2)
-                put_bits(&amp;pb, 4, adpcm_ima_compress_sample(&amp;c-&gt;status[1], samples[2*i+1]) &amp; 0xF);
+                adpcm_compress_trellis(avctx, samples+3, buf[1], &amp;c-&gt;status[1], n);
+            for(i=0; i&lt;n; i++) {
+                put_bits(&amp;pb, 4, buf[0][i]);
+                if (avctx-&gt;channels == 2)
+                    put_bits(&amp;pb, 4, buf[1][i]);
+            }
+        } else {
+            for (i=1; i&lt;avctx-&gt;frame_size; i++) {
+                put_bits(&amp;pb, 4, adpcm_ima_compress_sample(&amp;c-&gt;status[0], samples[avctx-&gt;channels*i]) &amp; 0xF);
+                if (avctx-&gt;channels == 2)
+                    put_bits(&amp;pb, 4, adpcm_ima_compress_sample(&amp;c-&gt;status[1], samples[2*i+1]) &amp; 0xF);
+            }
         }
-
-        dst += (3 + 2048) * avctx-&gt;channels;
+        flush_put_bits(&amp;pb);
+        dst += put_bits_count(&amp;pb)&gt;&gt;3;
         break;
     }
     case CODEC_ID_ADPCM_MS:
@@ -669,11 +689,10 @@
     if (sign) predictor -= diff;
     else predictor += diff;
 
-    CLAMP_TO_SHORT(predictor);
-    c-&gt;predictor = predictor;
+    c-&gt;predictor = av_clip_int16(predictor);
     c-&gt;step_index = step_index;
 
-    return (short)predictor;
+    return (short)c-&gt;predictor;
 }
 
 static inline short adpcm_ms_expand_nibble(ADPCMChannelStatus *c, char nibble)
@@ -682,19 +701,17 @@
 
     predictor = (((c-&gt;sample1) * (c-&gt;coeff1)) + ((c-&gt;sample2) * (c-&gt;coeff2))) / 256;
     predictor += (signed)((nibble &amp; 0x08)?(nibble - 0x10):(nibble)) * c-&gt;idelta;
-    CLAMP_TO_SHORT(predictor);
 
     c-&gt;sample2 = c-&gt;sample1;
-    c-&gt;sample1 = predictor;
+    c-&gt;sample1 = av_clip_int16(predictor);
     c-&gt;idelta = (AdaptationTable[(int)nibble] * c-&gt;idelta) &gt;&gt; 8;
     if (c-&gt;idelta &lt; 16) c-&gt;idelta = 16;
 
-    return (short)predictor;
+    return c-&gt;sample1;
 }
 
 static inline short adpcm_ct_expand_nibble(ADPCMChannelStatus *c, char nibble)
 {
-    int predictor;
     int sign, delta, diff;
     int new_step;
 
@@ -704,23 +721,14 @@
      * the reference ADPCM implementation since modern CPUs can do the mults
      * quickly enough */
     diff = ((2 * delta + 1) * c-&gt;step) &gt;&gt; 3;
-    predictor = c-&gt;predictor;
     /* predictor update is not so trivial: predictor is multiplied on 254/256 before updating */
-    if(sign)
-        predictor = ((predictor * 254) &gt;&gt; 8) - diff;
-    else
-            predictor = ((predictor * 254) &gt;&gt; 8) + diff;
+    c-&gt;predictor = ((c-&gt;predictor * 254) &gt;&gt; 8) + (sign ? -diff : diff);
+    c-&gt;predictor = av_clip_int16(c-&gt;predictor);
     /* calculate new step and clamp it to range 511..32767 */
     new_step = (ct_adpcm_table[nibble &amp; 7] * c-&gt;step) &gt;&gt; 8;
-    c-&gt;step = new_step;
-    if(c-&gt;step &lt; 511)
-        c-&gt;step = 511;
-    if(c-&gt;step &gt; 32767)
-        c-&gt;step = 32767;
+    c-&gt;step = av_clip(new_step, 511, 32767);
 
-    CLAMP_TO_SHORT(predictor);
-    c-&gt;predictor = predictor;
-    return (short)predictor;
+    return (short)c-&gt;predictor;
 }
 
 static inline short adpcm_sbpro_expand_nibble(ADPCMChannelStatus *c, char nibble, int size, int shift)
@@ -731,16 +739,8 @@
     delta = nibble &amp; ((1&lt;&lt;(size-1))-1);
     diff = delta &lt;&lt; (7 + c-&gt;step + shift);
 
-    if (sign)
-        c-&gt;predictor -= diff;
-    else
-        c-&gt;predictor += diff;
-
     /* clamp result */
-    if (c-&gt;predictor &gt; 16256)
-        c-&gt;predictor = 16256;
-    else if (c-&gt;predictor &lt; -16384)
-        c-&gt;predictor = -16384;
+    c-&gt;predictor = av_clip(c-&gt;predictor + (sign ? -diff : diff), -16384,16256);
 
     /* calculate new step */
     if (delta &gt;= (2*size - 3) &amp;&amp; c-&gt;step &lt; 3)
@@ -759,7 +759,7 @@
     }
 
     c-&gt;predictor += (c-&gt;step * yamaha_difflookup[nibble]) / 8;
-    CLAMP_TO_SHORT(c-&gt;predictor);
+    c-&gt;predictor = av_clip_int16(c-&gt;predictor);
     c-&gt;step = (c-&gt;step * yamaha_indexscale[nibble]) &gt;&gt; 8;
     c-&gt;step = av_clip(c-&gt;step, 127, 24567);
     return c-&gt;predictor;
@@ -788,11 +788,10 @@
 
             t = (signed char)(d&lt;&lt;4)&gt;&gt;4;
             s = ( t&lt;&lt;shift ) + ((s_1*f0 + s_2*f1+32)&gt;&gt;6);
-            CLAMP_TO_SHORT(s);
-            *out = s;
+            s_2 = s_1;
+            s_1 = av_clip_int16(s);
+            *out = s_1;
             out += inc;
-            s_2 = s_1;
-            s_1 = s;
         }
 
         if (inc==2) { /* stereo */
@@ -814,11 +813,10 @@
 
             t = (signed char)d &gt;&gt; 4;
             s = ( t&lt;&lt;shift ) + ((s_1*f0 + s_2*f1+32)&gt;&gt;6);
-            CLAMP_TO_SHORT(s);
-            *out = s;
+            s_2 = s_1;
+            s_1 = av_clip_int16(s);
+            *out = s_1;
             out += inc;
-            s_2 = s_1;
-            s_1 = s;
         }
 
         if (inc==2) { /* stereo */
@@ -908,7 +906,7 @@
         if(cs-&gt;predictor &amp; 0x8000)
             cs-&gt;predictor -= 0x10000;
 
-        CLAMP_TO_SHORT(cs-&gt;predictor);
+        cs-&gt;predictor = av_clip_int16(cs-&gt;predictor);
 
         cs-&gt;step_index = (*src++) &amp; 0x7F;
 
@@ -1180,28 +1178,36 @@
                 next_right_sample = (next_right_sample +
                     (current_right_sample * coeff1r) +
                     (previous_right_sample * coeff2r) + 0x80) &gt;&gt; 8;
-                CLAMP_TO_SHORT(next_left_sample);
-                CLAMP_TO_SHORT(next_right_sample);
 
                 previous_left_sample = current_left_sample;
-                current_left_sample = next_left_sample;
+                current_left_sample = av_clip_int16(next_left_sample);
                 previous_right_sample = current_right_sample;
-                current_right_sample = next_right_sample;
+                current_right_sample = av_clip_int16(next_right_sample);
                 *samples++ = (unsigned short)current_left_sample;
                 *samples++ = (unsigned short)current_right_sample;
             }
         }
         break;
+    case CODEC_ID_ADPCM_IMA_AMV:
     case CODEC_ID_ADPCM_IMA_SMJPEG:
-        c-&gt;status[0].predictor = *src;
-        src += 2;
-        c-&gt;status[0].step_index = *src++;
-        src++;  /* skip another byte before getting to the meat */
+        c-&gt;status[0].predictor = (int16_t)bytestream_get_le16(&amp;src);
+        c-&gt;status[0].step_index = bytestream_get_le16(&amp;src);
+
+        if (avctx-&gt;codec-&gt;id == CODEC_ID_ADPCM_IMA_AMV)
+            src+=4;
+
         while (src &lt; buf + buf_size) {
+            char hi, lo;
+            lo = *src &amp; 0x0F;
+            hi = (*src &gt;&gt; 4) &amp; 0x0F;
+
+            if (avctx-&gt;codec-&gt;id == CODEC_ID_ADPCM_IMA_AMV)
+                FFSWAP(char, hi, lo);
+
             *samples++ = adpcm_ima_expand_nibble(&amp;c-&gt;status[0],
-                *src &amp; 0x0F, 3);
+                lo, 3);
             *samples++ = adpcm_ima_expand_nibble(&amp;c-&gt;status[0],
-                (*src &gt;&gt; 4) &amp; 0x0F, 3);
+                hi, 3);
             src++;
         }
         break;
@@ -1267,7 +1273,7 @@
     {
         GetBitContext gb;
         const int *table;
-        int k0, signmask, nb_bits;
+        int k0, signmask, nb_bits, count;
         int size = buf_size*8;
 
         init_get_bits(&amp;gb, buf, size);
@@ -1279,44 +1285,45 @@
         k0 = 1 &lt;&lt; (nb_bits-2);
         signmask = 1 &lt;&lt; (nb_bits-1);
 
-        for (i = 0; i &lt; avctx-&gt;channels; i++) {
-            *samples++ = c-&gt;status[i].predictor = get_sbits(&amp;gb, 16);
-            c-&gt;status[i].step_index = get_bits(&amp;gb, 6);
-        }
+        while (get_bits_count(&amp;gb) &lt;= size - 22*avctx-&gt;channels) {
+            for (i = 0; i &lt; avctx-&gt;channels; i++) {
+                *samples++ = c-&gt;status[i].predictor = get_sbits(&amp;gb, 16);
+                c-&gt;status[i].step_index = get_bits(&amp;gb, 6);
+            }
 
-        while (get_bits_count(&amp;gb) &lt; size)
-        {
-            int i;
+            for (count = 0; get_bits_count(&amp;gb) &lt;= size - nb_bits*avctx-&gt;channels &amp;&amp; count &lt; 4095; count++) {
+                int i;
 
-            for (i = 0; i &lt; avctx-&gt;channels; i++) {
-                // similar to IMA adpcm
-                int delta = get_bits(&amp;gb, nb_bits);
-                int step = step_table[c-&gt;status[i].step_index];
-                long vpdiff = 0; // vpdiff = (delta+0.5)*step/4
-                int k = k0;
+                for (i = 0; i &lt; avctx-&gt;channels; i++) {
+                    // similar to IMA adpcm
+                    int delta = get_bits(&amp;gb, nb_bits);
+                    int step = step_table[c-&gt;status[i].step_index];
+                    long vpdiff = 0; // vpdiff = (delta+0.5)*step/4
+                    int k = k0;
 
-                do {
-                    if (delta &amp; k)
-                        vpdiff += step;
-                    step &gt;&gt;= 1;
-                    k &gt;&gt;= 1;
-                } while(k);
-                vpdiff += step;
+                    do {
+                        if (delta &amp; k)
+                            vpdiff += step;
+                        step &gt;&gt;= 1;
+                        k &gt;&gt;= 1;
+                    } while(k);
+                    vpdiff += step;
 
-                if (delta &amp; signmask)
-                    c-&gt;status[i].predictor -= vpdiff;
-                else
-                    c-&gt;status[i].predictor += vpdiff;
+                    if (delta &amp; signmask)
+                        c-&gt;status[i].predictor -= vpdiff;
+                    else
+                        c-&gt;status[i].predictor += vpdiff;
 
-                c-&gt;status[i].step_index += table[delta &amp; (~signmask)];
+                    c-&gt;status[i].step_index += table[delta &amp; (~signmask)];
 
-                c-&gt;status[i].step_index = av_clip(c-&gt;status[i].step_index, 0, 88);
-                c-&gt;status[i].predictor = av_clip(c-&gt;status[i].predictor, -32768, 32767);
+                    c-&gt;status[i].step_index = av_clip(c-&gt;status[i].step_index, 0, 88);
+                    c-&gt;status[i].predictor = av_clip_int16(c-&gt;status[i].predictor);
 
-                *samples++ = c-&gt;status[i].predictor;
-                if (samples &gt;= samples_end) {
-                    av_log(avctx, AV_LOG_ERROR, &quot;allocated output buffer is too small\n&quot;);
-                    return -1;
+                    *samples++ = c-&gt;status[i].predictor;
+                    if (samples &gt;= samples_end) {
+                        av_log(avctx, AV_LOG_ERROR, &quot;allocated output buffer is too small\n&quot;);
+                        return -1;
+                    }
                 }
             }
         }
@@ -1384,8 +1391,7 @@
 
                     sampledat = ((prev[ch][0]*factor1
                                 + prev[ch][1]*factor2) &gt;&gt; 11) + (sampledat&gt;&gt;exp);
-                    CLAMP_TO_SHORT(sampledat);
-                    *samples = sampledat;
+                    *samples = av_clip_int16(sampledat);
                     prev[ch][1] = prev[ch][0];
                     prev[ch][0] = *samples++;
 
@@ -1446,22 +1452,23 @@
 #define ADPCM_CODEC(id, name)                   \
 ADPCM_ENCODER(id,name) ADPCM_DECODER(id,name)
 
+ADPCM_CODEC(CODEC_ID_ADPCM_4XM, adpcm_4xm);
+ADPCM_CODEC(CODEC_ID_ADPCM_CT, adpcm_ct);
+ADPCM_CODEC(CODEC_ID_ADPCM_EA, adpcm_ea);
+ADPCM_CODEC(CODEC_ID_ADPCM_IMA_AMV, adpcm_ima_amv);
+ADPCM_CODEC(CODEC_ID_ADPCM_IMA_DK3, adpcm_ima_dk3);
+ADPCM_CODEC(CODEC_ID_ADPCM_IMA_DK4, adpcm_ima_dk4);
 ADPCM_CODEC(CODEC_ID_ADPCM_IMA_QT, adpcm_ima_qt);
+ADPCM_CODEC(CODEC_ID_ADPCM_IMA_SMJPEG, adpcm_ima_smjpeg);
 ADPCM_CODEC(CODEC_ID_ADPCM_IMA_WAV, adpcm_ima_wav);
-ADPCM_CODEC(CODEC_ID_ADPCM_IMA_DK3, adpcm_ima_dk3);
-ADPCM_CODEC(CODEC_ID_ADPCM_IMA_DK4, adpcm_ima_dk4);
 ADPCM_CODEC(CODEC_ID_ADPCM_IMA_WS, adpcm_ima_ws);
-ADPCM_CODEC(CODEC_ID_ADPCM_IMA_SMJPEG, adpcm_ima_smjpeg);
 ADPCM_CODEC(CODEC_ID_ADPCM_MS, adpcm_ms);
-ADPCM_CODEC(CODEC_ID_ADPCM_4XM, adpcm_4xm);
-ADPCM_CODEC(CODEC_ID_ADPCM_XA, adpcm_xa);
-ADPCM_CODEC(CODEC_ID_ADPCM_EA, adpcm_ea);
-ADPCM_CODEC(CODEC_ID_ADPCM_CT, adpcm_ct);
-ADPCM_CODEC(CODEC_ID_ADPCM_SWF, adpcm_swf);
-ADPCM_CODEC(CODEC_ID_ADPCM_YAMAHA, adpcm_yamaha);
 ADPCM_CODEC(CODEC_ID_ADPCM_SBPRO_4, adpcm_sbpro_4);
 ADPCM_CODEC(CODEC_ID_ADPCM_SBPRO_3, adpcm_sbpro_3);
 ADPCM_CODEC(CODEC_ID_ADPCM_SBPRO_2, adpcm_sbpro_2);
+ADPCM_CODEC(CODEC_ID_ADPCM_SWF, adpcm_swf);
 ADPCM_CODEC(CODEC_ID_ADPCM_THP, adpcm_thp);
+ADPCM_CODEC(CODEC_ID_ADPCM_XA, adpcm_xa);
+ADPCM_CODEC(CODEC_ID_ADPCM_YAMAHA, adpcm_yamaha);
 
 #undef ADPCM_CODEC

Modified: branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec/allcodecs.c
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec/allcodecs.c	2007-10-05 20:42:10 UTC (rev 3623)
+++ branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec/allcodecs.c	2007-10-06 17:27:01 UTC (rev 3624)
@@ -98,6 +98,7 @@
     REGISTER_ENCODER(LJPEG, ljpeg);
     REGISTER_DECODER(LOCO, loco);
     REGISTER_DECODER(MDEC, mdec);
+    REGISTER_DECODER(AMV, amv); // MEANX
     REGISTER_ENCDEC (MJPEG, mjpeg);
     REGISTER_DECODER(MJPEGB, mjpegb);
     REGISTER_DECODER(MMVIDEO, mmvideo);
@@ -233,6 +234,7 @@
     REGISTER_DECODER(XAN_DPCM, xan_dpcm);
 
     /* adpcm codecs */
+    REGISTER_ENCDEC (ADPCM_IMA_AMV, adpcm_ima_amv); //meanx
     REGISTER_ENCDEC (ADPCM_4XM, adpcm_4xm);
     REGISTER_ENCDEC (ADPCM_ADX, adpcm_adx);
     REGISTER_ENCDEC (ADPCM_CT, adpcm_ct);

Modified: branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec/allcodecs.h
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec/allcodecs.h	2007-10-05 20:42:10 UTC (rev 3623)
+++ branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec/allcodecs.h	2007-10-06 17:27:01 UTC (rev 3624)
@@ -23,6 +23,8 @@
 
 #include &quot;avcodec.h&quot;
 
+extern AVCodec adpcm_ima_amv_encoder;
+extern AVCodec adpcm_ima_amv_decoder;
 extern AVCodec ac3_encoder;
 extern AVCodec asv1_encoder;
 extern AVCodec asv2_encoder;
@@ -168,6 +170,7 @@
 extern AVCodec sol_dpcm_decoder;
 extern AVCodec sonic_decoder;
 extern AVCodec sp5x_decoder;
+extern AVCodec amv_decoder; // MEANX
 extern AVCodec svq1_decoder;
 extern AVCodec svq3_decoder;
 extern AVCodec targa_decoder;

Modified: branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec/avcodec.h
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec/avcodec.h	2007-10-05 20:42:10 UTC (rev 3623)
+++ branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec/avcodec.h	2007-10-06 17:27:01 UTC (rev 3624)
@@ -152,6 +152,7 @@
     CODEC_ID_VP5,
     CODEC_ID_VP6,
     CODEC_ID_VP6F,
+    CODEC_ID_AMV,
     CODEC_ID_TARGA,
     CODEC_ID_DSICINVIDEO,
     CODEC_ID_TIERTEXSEQVIDEO,
@@ -206,7 +207,7 @@
     CODEC_ID_ADPCM_SBPRO_3,
     CODEC_ID_ADPCM_SBPRO_2,
     CODEC_ID_ADPCM_THP,
-
+    CODEC_ID_ADPCM_IMA_AMV, /* MEANX */
     /* AMR */
     CODEC_ID_AMR_NB= 0x12000,
     CODEC_ID_AMR_WB,

Modified: branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec/ffconf.c
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec/ffconf.c	2007-10-05 20:42:10 UTC (rev 3623)
+++ branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec/ffconf.c	2007-10-06 17:27:01 UTC (rev 3624)
@@ -7,6 +7,8 @@
 int main(void)
 {
 #define DECLARE_DECODER(a,b); printf(&quot;#define ENABLE_&quot;#a&quot;_DECODER 1\n&quot;); 
+  
+    DECLARE_DECODER(ADPCM_IMA_AMV, amv);
     DECLARE_DECODER(CINEPAK, cinepak);
     DECLARE_DECODER(DNXHD, dnxhd);
     DECLARE_DECODER(FOURXM, fourxm);
@@ -47,8 +49,8 @@
     DECLARE_DECODER (RV20, rv20);
     DECLARE_DECODER (DVBSUB, dvbsub);
     DECLARE_DECODER (FLV, flv);
-	DECLARE_DECODER (SNOW, snow);
-
+    DECLARE_DECODER (SNOW, snow);
+    DECLARE_DECODER (AMV, amv);
 #undef DECLARE_DECODER
 #define DECLARE_DECODER(a,b); printf(&quot;#define ENABLE_&quot;#a&quot;_DECODER 0\n&quot;); 
 
@@ -227,7 +229,7 @@
 
 #undef DECLARE_ENCODER
 #define DECLARE_ENCODER(a,b); printf(&quot;#define ENABLE_&quot;#a&quot;_ENCODER 0\n&quot;); 
-
+    DECLARE_ENCODER(ADPCM_IMA_AMV, amv);
     DECLARE_ENCODER(LIBX264, libx264);
     DECLARE_ENCODER(LIBXVID, libxvid);
     DECLARE_ENCODER(LJPEG, ljpeg);

Modified: branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec/ffconf.h
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec/ffconf.h	2007-10-05 20:42:10 UTC (rev 3623)
+++ branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec/ffconf.h	2007-10-06 17:27:01 UTC (rev 3624)
@@ -1,305 +1,308 @@
-#define ENABLE_CINEPAK_DECODER 1
-#define ENABLE_DNXHD_DECODER 1
-#define ENABLE_FOURXM_DECODER 1
-#define ENABLE_FRAPS_DECODER 1
-#define ENABLE_H263I_DECODER 1
-#define ENABLE_H264_DECODER 1
-#define ENABLE_INDEO2_DECODER 1
-#define ENABLE_INDEO3_DECODER 1
-#define ENABLE_INTERPLAY_VIDEO_DECODER 1
-#define ENABLE_MPEGVIDEO_DECODER 1
-#define ENABLE_MSVIDEO1_DECODER 1
-#define ENABLE_VC1_DECODER 1
-#define ENABLE_VCR1_DECODER 1
-#define ENABLE_VP5_DECODER 1
-#define ENABLE_VP6_DECODER 1
-#define ENABLE_VP6F_DECODER 1
-#define ENABLE_WMV3_DECODER 1
-#define ENABLE_WMV1_DECODER 1
-#define ENABLE_WMV2_DECODER 1
-#define ENABLE_VP3_DECODER 1
-#define ENABLE_MPEG4_DECODER 1
-#define ENABLE_MSMPEG4V1_DECODER 1
-#define ENABLE_MSMPEG4V2_DECODER 1
-#define ENABLE_MSMPEG4V3_DECODER 1
-#define ENABLE_MJPEGB_DECODER 1
-#define ENABLE_MJPEG_DECODER 1
-#define ENABLE_WMAV2_DECODER 1
-#define ENABLE_DVVIDEO_DECODER 1
-#define ENABLE_HUFFYUV_DECODER 1
-#define ENABLE_FFVHUFF_DECODER 1
-#define ENABLE_SVQ3_DECODER 1
-#define ENABLE_TSCC_DECODER 1
-#define ENABLE_QDM2_DECODER 1
-#define ENABLE_FFV1_DECODER 1
-#define ENABLE_MPEG1VIDEO_DECODER 1
-#define ENABLE_MPEG2VIDEO_DECODER 1
-#define ENABLE_RV10_DECODER 1
-#define ENABLE_RV20_DECODER 1
-#define ENABLE_DVBSUB_DECODER 1
-#define ENABLE_FLV_DECODER 1
-#define ENABLE_SNOW_DECODER 1
-#define ENABLE_AASC_DECODER 0
-#define ENABLE_AVS_DECODER 0
-#define ENABLE_BETHSOFTVID_DECODER 0
-#define ENABLE_C93_DECODER 0
-#define ENABLE_CAVS_DECODER 0
-#define ENABLE_CLJR_DECODER 0
-#define ENABLE_CSCD_DECODER 0
-#define ENABLE_CYUV_DECODER 0
-#define ENABLE_DSICINVIDEO_DECODER 0
-#define ENABLE_DXA_DECODER 0
-#define ENABLE_EIGHTBPS_DECODER 0
-#define ENABLE_FLIC_DECODER 0
-#define ENABLE_IDCIN_DECODER 0
-#define ENABLE_KMVC_DECODER 0
-#define ENABLE_LOCO_DECODER 0
-#define ENABLE_MDEC_DECODER 0
-#define ENABLE_MMVIDEO_DECODER 0
-#define ENABLE_MPEG_XVMC_DECODER 0
-#define ENABLE_MSRLE_DECODER 0
-#define ENABLE_MSZH_DECODER 0
-#define ENABLE_NUV_DECODER 0
-#define ENABLE_PTX_DECODER 0
-#define ENABLE_QDRAW_DECODER 0
-#define ENABLE_QPEG_DECODER 0
-#define ENABLE_RPZA_DECODER 0
-#define ENABLE_SMACKER_DECODER 0
-#define ENABLE_SMC_DECODER 0
-#define ENABLE_SP5X_DECODER 0
-#define ENABLE_THEORA_DECODER 0
-#define ENABLE_THP_DECODER 0
-#define ENABLE_TIERTEXSEQVIDEO_DECODER 0
-#define ENABLE_TRUEMOTION1_DECODER 0
-#define ENABLE_TRUEMOTION2_DECODER 0
-#define ENABLE_TXD_DECODER 0
-#define ENABLE_ULTI_DECODER 0
-#define ENABLE_VMDVIDEO_DECODER 0
-#define ENABLE_VMNC_DECODER 0
-#define ENABLE_VQA_DECODER 0
-#define ENABLE_WNV1_DECODER 0
-#define ENABLE_XAN_WC3_DECODER 0
-#define ENABLE_XL_DECODER 0
-#define ENABLE_MPEG4AAC_DECODER 0
-#define ENABLE_ALAC_DECODER 0
-#define ENABLE_ATRAC3_DECODER 0
-#define ENABLE_COOK_DECODER 0
-#define ENABLE_DCA_DECODER 0
-#define ENABLE_DSICINAUDIO_DECODER 0
-#define ENABLE_IMC_DECODER 0
-#define ENABLE_LIBA52_DECODER 0
-#define ENABLE_LIBFAAD_DECODER 0
-#define ENABLE_MACE3_DECODER 0
-#define ENABLE_MACE6_DECODER 0
-#define ENABLE_MP3_DECODER 0
-#define ENABLE_MP3ADU_DECODER 0
-#define ENABLE_MP3ON4_DECODER 0
-#define ENABLE_MPC7_DECODER 0
-#define ENABLE_RA_144_DECODER 0
-#define ENABLE_RA_288_DECODER 0
-#define ENABLE_SHORTEN_DECODER 0
-#define ENABLE_SMACKAUD_DECODER 0
-#define ENABLE_TRUESPEECH_DECODER 0
-#define ENABLE_TTA_DECODER 0
-#define ENABLE_VMDAUDIO_DECODER 0
-#define ENABLE_WAVPACK_DECODER 0
-#define ENABLE_WS_SND1_DECODER 0
-#define ENABLE_INTERPLAY_DPCM_DECODER 0
-#define ENABLE_SOL_DPCM_DECODER 0
-#define ENABLE_XAN_DPCM_DECODER 0
-#define ENABLE_ADPCM_THP_DECODER 0
-#define ENABLE_ASV1_DECODER 0
-#define ENABLE_ASV2_DECODER 0
-#define ENABLE_BMP_DECODER 0
-#define ENABLE_FLASHSV_DECODER 0
-#define ENABLE_GIF_DECODER 0
-#define ENABLE_H261_DECODER 0
-#define ENABLE_H263_DECODER 0
-#define ENABLE_JPEGLS_DECODER 0
-#define ENABLE_PNG_DECODER 0
-#define ENABLE_QTRLE_DECODER 0
-#define ENABLE_RAWVIDEO_DECODER 0
-#define ENABLE_ROQ_DECODER 0
-#define ENABLE_SGI_DECODER 0
-#define ENABLE_SVQ1_DECODER 0
-#define ENABLE_TARGA_DECODER 0
-#define ENABLE_TIFF_DECODER 0
-#define ENABLE_ZLIB_DECODER 0
-#define ENABLE_ZMBV_DECODER 0
-#define ENABLE_FLAC_DECODER 0
-#define ENABLE_LIBAMR_NB_DECODER 0
-#define ENABLE_LIBAMR_WB_DECODER 0
-#define ENABLE_LIBGSM_DECODER 0
-#define ENABLE_LIBGSM_MS_DECODER 0
-#define ENABLE_MP2_DECODER 0
-#define ENABLE_SONIC_DECODER 0
-#define ENABLE_VORBIS_DECODER 0
-#define ENABLE_WMAV1_DECODER 0
-#define ENABLE_PCM_ALAW_DECODER 0
-#define ENABLE_PCM_MULAW_DECODER 0
-#define ENABLE_PCM_S8_DECODER 0
-#define ENABLE_PCM_S16BE_DECODER 0
-#define ENABLE_PCM_S16LE_DECODER 0
-#define ENABLE_PCM_S24BE_DECODER 0
-#define ENABLE_PCM_S24DAUD_DECODER 0
-#define ENABLE_PCM_S24LE_DECODER 0
-#define ENABLE_PCM_S32BE_DECODER 0
-#define ENABLE_PCM_S32LE_DECODER 0
-#define ENABLE_PCM_U8_DECODER 0
-#define ENABLE_PCM_U16BE_DECODER 0
-#define ENABLE_PCM_U16LE_DECODER 0
-#define ENABLE_PCM_U24BE_DECODER 0
-#define ENABLE_PCM_U24LE_DECODER 0
-#define ENABLE_PCM_U32BE_DECODER 0
-#define ENABLE_PCM_U32LE_DECODER 0
-#define ENABLE_ROQ_DPCM_DECODER 0
-#define ENABLE_ADPCM_4XM_DECODER 0
-#define ENABLE_ADPCM_ADX_DECODER 0
-#define ENABLE_ADPCM_CT_DECODER 0
-#define ENABLE_ADPCM_EA_DECODER 0
-#define ENABLE_ADPCM_G726_DECODER 0
-#define ENABLE_ADPCM_IMA_DK3_DECODER 0
-#define ENABLE_ADPCM_IMA_DK4_DECODER 0
-#define ENABLE_ADPCM_IMA_QT_DECODER 0
-#define ENABLE_ADPCM_IMA_SMJPEG_DECODER 0
-#define ENABLE_ADPCM_IMA_WAV_DECODER 0
-#define ENABLE_ADPCM_IMA_WS_DECODER 0
-#define ENABLE_ADPCM_MS_DECODER 0
-#define ENABLE_ADPCM_SBPRO_2_DECODER 0
-#define ENABLE_ADPCM_SBPRO_3_DECODER 0
-#define ENABLE_ADPCM_SBPRO_4_DECODER 0
-#define ENABLE_ADPCM_SWF_DECODER 0
-#define ENABLE_ADPCM_XA_DECODER 0
-#define ENABLE_ADPCM_YAMAHA_DECODER 0
-#define ENABLE_DVDSUB_DECODER 0
-#define ENABLE_H263_PARSER 1
-#define ENABLE_H264_PARSER 1
-#define ENABLE_MPEG4VIDEO_PARSER 1
-#define ENABLE_AAC_PARSER 0
-#define ENABLE_AC3_PARSER 0
-#define ENABLE_CAVSVIDEO_PARSER 0
-#define ENABLE_DCA_PARSER 0
-#define ENABLE_DVBSUB_PARSER 0
-#define ENABLE_DVDSUB_PARSER 0
-#define ENABLE_H261_PARSER 0
-#define ENABLE_MJPEG_PARSER 0
-#define ENABLE_MPEGAUDIO_PARSER 0
-#define ENABLE_MPEGVIDEO_PARSER 0
-#define ENABLE_PNM_PARSER 0
-#define ENABLE_VC1_PARSER 0
-#define ENABLE_MJPEG_ENCODER 1
-#define ENABLE_MSMPEG4V3_ENCODER 1
-#define ENABLE_H263P_ENCODER 1
-#define ENABLE_AC3_ENCODER 1
-#define ENABLE_FFV1_ENCODER 1
-#define ENABLE_FLV1_ENCODER 1
-#define ENABLE_FFVHUFF_ENCODER 1
-#define ENABLE_H263_ENCODER 1
-#define ENABLE_MPEG1VIDEO_ENCODER 1
-#define ENABLE_MPEG2VIDEO_ENCODER 1
-#define ENABLE_MPEG4_ENCODER 1
-#define ENABLE_FLV_ENCODER 1
-#define ENABLE_MP2_ENCODER 1
-#define ENABLE_DVVIDEO_ENCODER 1
-#define ENABLE_HUFFYUV_ENCODER 1
-#define ENABLE_DVBSUB_ENCODER 1
-#define ENABLE_LIBX264_ENCODER 0
-#define ENABLE_LIBXVID_ENCODER 0
-#define ENABLE_LJPEG_ENCODER 0
-#define ENABLE_PAM_ENCODER 0
-#define ENABLE_PBM_ENCODER 0
-#define ENABLE_PGM_ENCODER 0
-#define ENABLE_PGMYUV_ENCODER 0
-#define ENABLE_PPM_ENCODER 0
-#define ENABLE_LIBFAAC_ENCODER 0
-#define ENABLE_LIBMP3LAME_ENCODER 0
-#define ENABLE_LIBTHEORA_ENCODER 0
-#define ENABLE_SONIC_LS_ENCODER 0
-#define ENABLE_ASV1_ENCODER 0
-#define ENABLE_ASV2_ENCODER 0
-#define ENABLE_BMP_ENCODER 0
-#define ENABLE_FLASHSV_ENCODER 0
-#define ENABLE_GIF_ENCODER 0
-#define ENABLE_H261_ENCODER 0
-#define ENABLE_JPEGLS_ENCODER 0
-#define ENABLE_MSMPEG4V1_ENCODER 0
-#define ENABLE_MSMPEG4V2_ENCODER 0
-#define ENABLE_PNG_ENCODER 0
-#define ENABLE_QTRLE_ENCODER 0
-#define ENABLE_RAWVIDEO_ENCODER 0
-#define ENABLE_ROQ_ENCODER 0
-#define ENABLE_RV10_ENCODER 0
-#define ENABLE_RV20_ENCODER 0
-#define ENABLE_SGI_ENCODER 0
-#define ENABLE_SVQ1_ENCODER 0
-#define ENABLE_TARGA_ENCODER 0
-#define ENABLE_TIFF_ENCODER 0
-#define ENABLE_WMV1_ENCODER 0
-#define ENABLE_WMV2_ENCODER 0
-#define ENABLE_ZLIB_ENCODER 0
-#define ENABLE_ZMBV_ENCODER 0
-#define ENABLE_FLAC_ENCODER 0
-#define ENABLE_LIBAMR_NB_ENCODER 0
-#define ENABLE_LIBAMR_WB_ENCODER 0
-#define ENABLE_LIBGSM_ENCODER 0
-#define ENABLE_LIBGSM_MS_ENCODER 0
-#define ENABLE_SONIC_ENCODER 0
-#define ENABLE_VORBIS_ENCODER 0
-#define ENABLE_WMAV1_ENCODER 0
-#define ENABLE_WMAV2_ENCODER 0
-#define ENABLE_PCM_ALAW_ENCODER 0
-#define ENABLE_PCM_MULAW_ENCODER 0
-#define ENABLE_PCM_S8_ENCODER 0
-#define ENABLE_PCM_S16BE_ENCODER 0
-#define ENABLE_PCM_S16LE_ENCODER 0
-#define ENABLE_PCM_S24BE_ENCODER 0
-#define ENABLE_PCM_S24DAUD_ENCODER 0
-#define ENABLE_PCM_S24LE_ENCODER 0
-#define ENABLE_PCM_S32BE_ENCODER 0
-#define ENABLE_PCM_S32LE_ENCODER 0
-#define ENABLE_PCM_U8_ENCODER 0
-#define ENABLE_PCM_U16BE_ENCODER 0
-#define ENABLE_PCM_U16LE_ENCODER 0
-#define ENABLE_PCM_U24BE_ENCODER 0
-#define ENABLE_PCM_U24LE_ENCODER 0
-#define ENABLE_PCM_U32BE_ENCODER 0
-#define ENABLE_PCM_U32LE_ENCODER 0
-#define ENABLE_ROQ_DPCM_ENCODER 0
-#define ENABLE_ADPCM_4XM_ENCODER 0
-#define ENABLE_ADPCM_ADX_ENCODER 0
-#define ENABLE_ADPCM_CT_ENCODER 0
-#define ENABLE_ADPCM_EA_ENCODER 0
-#define ENABLE_ADPCM_G726_ENCODER 0
-#define ENABLE_ADPCM_IMA_DK3_ENCODER 0
-#define ENABLE_ADPCM_IMA_DK4_ENCODER 0
-#define ENABLE_ADPCM_IMA_QT_ENCODER 0
-#define ENABLE_ADPCM_IMA_SMJPEG_ENCODER 0
-#define ENABLE_ADPCM_IMA_WAV_ENCODER 0
-#define ENABLE_ADPCM_IMA_WS_ENCODER 0
-#define ENABLE_ADPCM_MS_ENCODER 0
-#define ENABLE_ADPCM_SBPRO_2_ENCODER 0
-#define ENABLE_ADPCM_SBPRO_3_ENCODER 0
-#define ENABLE_ADPCM_SBPRO_4_ENCODER 0
-#define ENABLE_ADPCM_SWF_ENCODER 0
-#define ENABLE_ADPCM_XA_ENCODER 0
-#define ENABLE_ADPCM_YAMAHA_ENCODER 0
-#define ENABLE_DVDSUB_ENCODER 0
-#define ENABLE_LIBVORBIS_ENCODER        0
-#define ENABLE_LIBVORBIS_DECODER        0
-#define ENABLE_MP3_HEADER_COMPRESS_BSF  0
-#define ENABLE_IMX_DUMP_HEADER_BSF      0
-#define ENABLE_DUMP_EXTRADATA_BSF       0
-#define ENABLE_REMOVE_EXTRADATA_BSF     0
-#define ENABLE_NOISE_BSF                0
-#define ENABLE_MP3_HEADER_DECOMPRESS_BSF 0
-#define ENABLE_MJPEGA_DUMP_HEADER_BSF   0
-#define ENABLE_IMX_DUMP_HEADER_BSF      0
-#define ENABLE_ARMV4L      0
-#define ENABLE_MLIB      0
-#define ENABLE_SPARC      0
-#define ENABLE_ALPHA      0
-#define ENABLE_POWERPC      0
-#define ENABLE_MMI      0
-#define ENABLE_SH4      0
-#define ENABLE_BFIN      0
-#define ENABLE_SMALL      0
+#define ENABLE_ADPCM_IMA_AMV_DECODER 1
+#define ENABLE_CINEPAK_DECODER 1
+#define ENABLE_DNXHD_DECODER 1
+#define ENABLE_FOURXM_DECODER 1
+#define ENABLE_FRAPS_DECODER 1
+#define ENABLE_H263I_DECODER 1
+#define ENABLE_H264_DECODER 1
+#define ENABLE_INDEO2_DECODER 1
+#define ENABLE_INDEO3_DECODER 1
+#define ENABLE_INTERPLAY_VIDEO_DECODER 1
+#define ENABLE_MPEGVIDEO_DECODER 1
+#define ENABLE_MSVIDEO1_DECODER 1
+#define ENABLE_VC1_DECODER 1
+#define ENABLE_VCR1_DECODER 1
+#define ENABLE_VP5_DECODER 1
+#define ENABLE_VP6_DECODER 1
+#define ENABLE_VP6F_DECODER 1
+#define ENABLE_WMV3_DECODER 1
+#define ENABLE_WMV1_DECODER 1
+#define ENABLE_WMV2_DECODER 1
+#define ENABLE_VP3_DECODER 1
+#define ENABLE_MPEG4_DECODER 1
+#define ENABLE_MSMPEG4V1_DECODER 1
+#define ENABLE_MSMPEG4V2_DECODER 1
+#define ENABLE_MSMPEG4V3_DECODER 1
+#define ENABLE_MJPEGB_DECODER 1
+#define ENABLE_MJPEG_DECODER 1
+#define ENABLE_WMAV2_DECODER 1
+#define ENABLE_DVVIDEO_DECODER 1
+#define ENABLE_HUFFYUV_DECODER 1
+#define ENABLE_FFVHUFF_DECODER 1
+#define ENABLE_SVQ3_DECODER 1
+#define ENABLE_TSCC_DECODER 1
+#define ENABLE_QDM2_DECODER 1
+#define ENABLE_FFV1_DECODER 1
+#define ENABLE_MPEG1VIDEO_DECODER 1
+#define ENABLE_MPEG2VIDEO_DECODER 1
+#define ENABLE_RV10_DECODER 1
+#define ENABLE_RV20_DECODER 1
+#define ENABLE_DVBSUB_DECODER 1
+#define ENABLE_FLV_DECODER 1
+#define ENABLE_SNOW_DECODER 1
+#define ENABLE_AMV_DECODER 1
+#define ENABLE_AASC_DECODER 0
+#define ENABLE_AVS_DECODER 0
+#define ENABLE_BETHSOFTVID_DECODER 0
+#define ENABLE_C93_DECODER 0
+#define ENABLE_CAVS_DECODER 0
+#define ENABLE_CLJR_DECODER 0
+#define ENABLE_CSCD_DECODER 0
+#define ENABLE_CYUV_DECODER 0
+#define ENABLE_DSICINVIDEO_DECODER 0
+#define ENABLE_DXA_DECODER 0
+#define ENABLE_EIGHTBPS_DECODER 0
+#define ENABLE_FLIC_DECODER 0
+#define ENABLE_IDCIN_DECODER 0
+#define ENABLE_KMVC_DECODER 0
+#define ENABLE_LOCO_DECODER 0
+#define ENABLE_MDEC_DECODER 0
+#define ENABLE_MMVIDEO_DECODER 0
+#define ENABLE_MPEG_XVMC_DECODER 0
+#define ENABLE_MSRLE_DECODER 0
+#define ENABLE_MSZH_DECODER 0
+#define ENABLE_NUV_DECODER 0
+#define ENABLE_PTX_DECODER 0
+#define ENABLE_QDRAW_DECODER 0
+#define ENABLE_QPEG_DECODER 0
+#define ENABLE_RPZA_DECODER 0
+#define ENABLE_SMACKER_DECODER 0
+#define ENABLE_SMC_DECODER 0
+#define ENABLE_SP5X_DECODER 0
+#define ENABLE_THEORA_DECODER 0
+#define ENABLE_THP_DECODER 0
+#define ENABLE_TIERTEXSEQVIDEO_DECODER 0
+#define ENABLE_TRUEMOTION1_DECODER 0
+#define ENABLE_TRUEMOTION2_DECODER 0
+#define ENABLE_TXD_DECODER 0
+#define ENABLE_ULTI_DECODER 0
+#define ENABLE_VMDVIDEO_DECODER 0
+#define ENABLE_VMNC_DECODER 0
+#define ENABLE_VQA_DECODER 0
+#define ENABLE_WNV1_DECODER 0
+#define ENABLE_XAN_WC3_DECODER 0
+#define ENABLE_XL_DECODER 0
+#define ENABLE_MPEG4AAC_DECODER 0
+#define ENABLE_ALAC_DECODER 0
+#define ENABLE_ATRAC3_DECODER 0
+#define ENABLE_COOK_DECODER 0
+#define ENABLE_DCA_DECODER 0
+#define ENABLE_DSICINAUDIO_DECODER 0
+#define ENABLE_IMC_DECODER 0
+#define ENABLE_LIBA52_DECODER 0
+#define ENABLE_LIBFAAD_DECODER 0
+#define ENABLE_MACE3_DECODER 0
+#define ENABLE_MACE6_DECODER 0
+#define ENABLE_MP3_DECODER 0
+#define ENABLE_MP3ADU_DECODER 0
+#define ENABLE_MP3ON4_DECODER 0
+#define ENABLE_MPC7_DECODER 0
+#define ENABLE_RA_144_DECODER 0
+#define ENABLE_RA_288_DECODER 0
+#define ENABLE_SHORTEN_DECODER 0
+#define ENABLE_SMACKAUD_DECODER 0
+#define ENABLE_TRUESPEECH_DECODER 0
+#define ENABLE_TTA_DECODER 0
+#define ENABLE_VMDAUDIO_DECODER 0
+#define ENABLE_WAVPACK_DECODER 0
+#define ENABLE_WS_SND1_DECODER 0
+#define ENABLE_INTERPLAY_DPCM_DECODER 0
+#define ENABLE_SOL_DPCM_DECODER 0
+#define ENABLE_XAN_DPCM_DECODER 0
+#define ENABLE_ADPCM_THP_DECODER 0
+#define ENABLE_ASV1_DECODER 0
+#define ENABLE_ASV2_DECODER 0
+#define ENABLE_BMP_DECODER 0
+#define ENABLE_FLASHSV_DECODER 0
+#define ENABLE_GIF_DECODER 0
+#define ENABLE_H261_DECODER 0
+#define ENABLE_H263_DECODER 0
+#define ENABLE_JPEGLS_DECODER 0
+#define ENABLE_PNG_DECODER 0
+#define ENABLE_QTRLE_DECODER 0
+#define ENABLE_RAWVIDEO_DECODER 0
+#define ENABLE_ROQ_DECODER 0
+#define ENABLE_SGI_DECODER 0
+#define ENABLE_SVQ1_DECODER 0
+#define ENABLE_TARGA_DECODER 0
+#define ENABLE_TIFF_DECODER 0
+#define ENABLE_ZLIB_DECODER 0
+#define ENABLE_ZMBV_DECODER 0
+#define ENABLE_FLAC_DECODER 0
+#define ENABLE_LIBAMR_NB_DECODER 0
+#define ENABLE_LIBAMR_WB_DECODER 0
+#define ENABLE_LIBGSM_DECODER 0
+#define ENABLE_LIBGSM_MS_DECODER 0
+#define ENABLE_MP2_DECODER 0
+#define ENABLE_SONIC_DECODER 0
+#define ENABLE_VORBIS_DECODER 0
+#define ENABLE_WMAV1_DECODER 0
+#define ENABLE_PCM_ALAW_DECODER 0
+#define ENABLE_PCM_MULAW_DECODER 0
+#define ENABLE_PCM_S8_DECODER 0
+#define ENABLE_PCM_S16BE_DECODER 0
+#define ENABLE_PCM_S16LE_DECODER 0
+#define ENABLE_PCM_S24BE_DECODER 0
+#define ENABLE_PCM_S24DAUD_DECODER 0
+#define ENABLE_PCM_S24LE_DECODER 0
+#define ENABLE_PCM_S32BE_DECODER 0
+#define ENABLE_PCM_S32LE_DECODER 0
+#define ENABLE_PCM_U8_DECODER 0
+#define ENABLE_PCM_U16BE_DECODER 0
+#define ENABLE_PCM_U16LE_DECODER 0
+#define ENABLE_PCM_U24BE_DECODER 0
+#define ENABLE_PCM_U24LE_DECODER 0
+#define ENABLE_PCM_U32BE_DECODER 0
+#define ENABLE_PCM_U32LE_DECODER 0
+#define ENABLE_ROQ_DPCM_DECODER 0
+#define ENABLE_ADPCM_4XM_DECODER 0
+#define ENABLE_ADPCM_ADX_DECODER 0
+#define ENABLE_ADPCM_CT_DECODER 0
+#define ENABLE_ADPCM_EA_DECODER 0
+#define ENABLE_ADPCM_G726_DECODER 0
+#define ENABLE_ADPCM_IMA_DK3_DECODER 0
+#define ENABLE_ADPCM_IMA_DK4_DECODER 0
+#define ENABLE_ADPCM_IMA_QT_DECODER 0
+#define ENABLE_ADPCM_IMA_SMJPEG_DECODER 0
+#define ENABLE_ADPCM_IMA_WAV_DECODER 0
+#define ENABLE_ADPCM_IMA_WS_DECODER 0
+#define ENABLE_ADPCM_MS_DECODER 0
+#define ENABLE_ADPCM_SBPRO_2_DECODER 0
+#define ENABLE_ADPCM_SBPRO_3_DECODER 0
+#define ENABLE_ADPCM_SBPRO_4_DECODER 0
+#define ENABLE_ADPCM_SWF_DECODER 0
+#define ENABLE_ADPCM_XA_DECODER 0
+#define ENABLE_ADPCM_YAMAHA_DECODER 0
+#define ENABLE_DVDSUB_DECODER 0
+#define ENABLE_H263_PARSER 1
+#define ENABLE_H264_PARSER 1
+#define ENABLE_MPEG4VIDEO_PARSER 1
+#define ENABLE_AAC_PARSER 0
+#define ENABLE_AC3_PARSER 0
+#define ENABLE_CAVSVIDEO_PARSER 0
+#define ENABLE_DCA_PARSER 0
+#define ENABLE_DVBSUB_PARSER 0
+#define ENABLE_DVDSUB_PARSER 0
+#define ENABLE_H261_PARSER 0
+#define ENABLE_MJPEG_PARSER 0
+#define ENABLE_MPEGAUDIO_PARSER 0
+#define ENABLE_MPEGVIDEO_PARSER 0
+#define ENABLE_PNM_PARSER 0
+#define ENABLE_VC1_PARSER 0
+#define ENABLE_MJPEG_ENCODER 1
+#define ENABLE_MSMPEG4V3_ENCODER 1
+#define ENABLE_H263P_ENCODER 1
+#define ENABLE_AC3_ENCODER 1
+#define ENABLE_FFV1_ENCODER 1
+#define ENABLE_FLV1_ENCODER 1
+#define ENABLE_FFVHUFF_ENCODER 1
+#define ENABLE_H263_ENCODER 1
+#define ENABLE_MPEG1VIDEO_ENCODER 1
+#define ENABLE_MPEG2VIDEO_ENCODER 1
+#define ENABLE_MPEG4_ENCODER 1
+#define ENABLE_FLV_ENCODER 1
+#define ENABLE_MP2_ENCODER 1
+#define ENABLE_DVVIDEO_ENCODER 1
+#define ENABLE_HUFFYUV_ENCODER 1
+#define ENABLE_DVBSUB_ENCODER 1
+#define ENABLE_ADPCM_IMA_AMV_ENCODER 0
+#define ENABLE_LIBX264_ENCODER 0
+#define ENABLE_LIBXVID_ENCODER 0
+#define ENABLE_LJPEG_ENCODER 0
+#define ENABLE_PAM_ENCODER 0
+#define ENABLE_PBM_ENCODER 0
+#define ENABLE_PGM_ENCODER 0
+#define ENABLE_PGMYUV_ENCODER 0
+#define ENABLE_PPM_ENCODER 0
+#define ENABLE_LIBFAAC_ENCODER 0
+#define ENABLE_LIBMP3LAME_ENCODER 0
+#define ENABLE_LIBTHEORA_ENCODER 0
+#define ENABLE_SONIC_LS_ENCODER 0
+#define ENABLE_ASV1_ENCODER 0
+#define ENABLE_ASV2_ENCODER 0
+#define ENABLE_BMP_ENCODER 0
+#define ENABLE_FLASHSV_ENCODER 0
+#define ENABLE_GIF_ENCODER 0
+#define ENABLE_H261_ENCODER 0
+#define ENABLE_JPEGLS_ENCODER 0
+#define ENABLE_MSMPEG4V1_ENCODER 0
+#define ENABLE_MSMPEG4V2_ENCODER 0
+#define ENABLE_PNG_ENCODER 0
+#define ENABLE_QTRLE_ENCODER 0
+#define ENABLE_RAWVIDEO_ENCODER 0
+#define ENABLE_ROQ_ENCODER 0
+#define ENABLE_RV10_ENCODER 0
+#define ENABLE_RV20_ENCODER 0
+#define ENABLE_SGI_ENCODER 0
+#define ENABLE_SVQ1_ENCODER 0
+#define ENABLE_TARGA_ENCODER 0
+#define ENABLE_TIFF_ENCODER 0
+#define ENABLE_WMV1_ENCODER 0
+#define ENABLE_WMV2_ENCODER 0
+#define ENABLE_ZLIB_ENCODER 0
+#define ENABLE_ZMBV_ENCODER 0
+#define ENABLE_FLAC_ENCODER 0
+#define ENABLE_LIBAMR_NB_ENCODER 0
+#define ENABLE_LIBAMR_WB_ENCODER 0
+#define ENABLE_LIBGSM_ENCODER 0
+#define ENABLE_LIBGSM_MS_ENCODER 0
+#define ENABLE_SONIC_ENCODER 0
+#define ENABLE_VORBIS_ENCODER 0
+#define ENABLE_WMAV1_ENCODER 0
+#define ENABLE_WMAV2_ENCODER 0
+#define ENABLE_PCM_ALAW_ENCODER 0
+#define ENABLE_PCM_MULAW_ENCODER 0
+#define ENABLE_PCM_S8_ENCODER 0
+#define ENABLE_PCM_S16BE_ENCODER 0
+#define ENABLE_PCM_S16LE_ENCODER 0
+#define ENABLE_PCM_S24BE_ENCODER 0
+#define ENABLE_PCM_S24DAUD_ENCODER 0
+#define ENABLE_PCM_S24LE_ENCODER 0
+#define ENABLE_PCM_S32BE_ENCODER 0
+#define ENABLE_PCM_S32LE_ENCODER 0
+#define ENABLE_PCM_U8_ENCODER 0
+#define ENABLE_PCM_U16BE_ENCODER 0
+#define ENABLE_PCM_U16LE_ENCODER 0
+#define ENABLE_PCM_U24BE_ENCODER 0
+#define ENABLE_PCM_U24LE_ENCODER 0
+#define ENABLE_PCM_U32BE_ENCODER 0
+#define ENABLE_PCM_U32LE_ENCODER 0
+#define ENABLE_ROQ_DPCM_ENCODER 0
+#define ENABLE_ADPCM_4XM_ENCODER 0
+#define ENABLE_ADPCM_ADX_ENCODER 0
+#define ENABLE_ADPCM_CT_ENCODER 0
+#define ENABLE_ADPCM_EA_ENCODER 0
+#define ENABLE_ADPCM_G726_ENCODER 0
+#define ENABLE_ADPCM_IMA_DK3_ENCODER 0
+#define ENABLE_ADPCM_IMA_DK4_ENCODER 0
+#define ENABLE_ADPCM_IMA_QT_ENCODER 0
+#define ENABLE_ADPCM_IMA_SMJPEG_ENCODER 0
+#define ENABLE_ADPCM_IMA_WAV_ENCODER 0
+#define ENABLE_ADPCM_IMA_WS_ENCODER 0
+#define ENABLE_ADPCM_MS_ENCODER 0
+#define ENABLE_ADPCM_SBPRO_2_ENCODER 0
+#define ENABLE_ADPCM_SBPRO_3_ENCODER 0
+#define ENABLE_ADPCM_SBPRO_4_ENCODER 0
+#define ENABLE_ADPCM_SWF_ENCODER 0
+#define ENABLE_ADPCM_XA_ENCODER 0
+#define ENABLE_ADPCM_YAMAHA_ENCODER 0
+#define ENABLE_DVDSUB_ENCODER 0
+#define ENABLE_LIBVORBIS_ENCODER        0
+#define ENABLE_LIBVORBIS_DECODER        0
+#define ENABLE_MP3_HEADER_COMPRESS_BSF  0
+#define ENABLE_IMX_DUMP_HEADER_BSF      0
+#define ENABLE_DUMP_EXTRADATA_BSF       0
+#define ENABLE_REMOVE_EXTRADATA_BSF     0
+#define ENABLE_NOISE_BSF                0
+#define ENABLE_MP3_HEADER_DECOMPRESS_BSF 0
+#define ENABLE_MJPEGA_DUMP_HEADER_BSF   0
+#define ENABLE_IMX_DUMP_HEADER_BSF      0
+#define ENABLE_ARMV4L      0
+#define ENABLE_MLIB      0
+#define ENABLE_SPARC      0
+#define ENABLE_ALPHA      0
+#define ENABLE_POWERPC      0
+#define ENABLE_MMI      0
+#define ENABLE_SH4      0
+#define ENABLE_BFIN      0
+#define ENABLE_SMALL      0

Modified: branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec/mjpegdec.c
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec/mjpegdec.c	2007-10-05 20:42:10 UTC (rev 3623)
+++ branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec/mjpegdec.c	2007-10-06 17:27:01 UTC (rev 3624)
@@ -298,14 +298,22 @@
         else
             s-&gt;avctx-&gt;pix_fmt = PIX_FMT_GRAY8;
         break;
+    case 0x110000:
+        s-&gt;avctx-&gt;pix_fmt = PIX_FMT_GRAY8;
+        break;
+    case 0x121111:
+        s-&gt;avctx-&gt;pix_fmt = s-&gt;cs_itu601 ? PIX_FMT_YUV440P : PIX_FMT_YUVJ440P;
+        break;
     case 0x211111:
     case 0x221212:
         s-&gt;avctx-&gt;pix_fmt = s-&gt;cs_itu601 ? PIX_FMT_YUV422P : PIX_FMT_YUVJ422P;
         break;
-    default:
     case 0x221111:
         s-&gt;avctx-&gt;pix_fmt = s-&gt;cs_itu601 ? PIX_FMT_YUV420P : PIX_FMT_YUVJ420P;
         break;
+    default:
+        av_log(s-&gt;avctx, AV_LOG_ERROR, &quot;Unhandled pixel format 0x%x\n&quot;, pix_fmt_id);
+        return -1;
     }
     if(s-&gt;ls){
         if(s-&gt;nb_components &gt; 1)
@@ -652,8 +660,22 @@
 static int mjpeg_decode_scan(MJpegDecodeContext *s, int nb_components, int ss, int se, int Ah, int Al){
     int i, mb_x, mb_y;
     int EOBRUN = 0;
+    uint8_t* data[MAX_COMPONENTS];
+    int linesize[MAX_COMPONENTS];
 
     if(Ah) return 0; /* TODO decode refinement planes too */
+
+    for(i=0; i &lt; nb_components; i++) {
+        int c = s-&gt;comp_index[i];
+        data[c] = s-&gt;picture.data[c];
+        linesize[c]=s-&gt;linesize[c];
+        if(s-&gt;avctx-&gt;codec-&gt;id==CODEC_ID_AMV) {
+            //picture should be flipped upside-down for this codec
+            data[c] += (linesize[c] * (s-&gt;v_scount[i] * 8 * s-&gt;mb_height - 1));
+            linesize[c] *= -1;
+        }
+    }
+
     for(mb_y = 0; mb_y &lt; s-&gt;mb_height; mb_y++) {
         for(mb_x = 0; mb_x &lt; s-&gt;mb_width; mb_x++) {
             if (s-&gt;restart_interval &amp;&amp; !s-&gt;restart_count)
@@ -683,16 +705,16 @@
                         return -1;
                     }
 //                    av_log(s-&gt;avctx, AV_LOG_DEBUG, &quot;mb: %d %d processed\n&quot;, mb_y, mb_x);
-                    ptr = s-&gt;picture.data[c] +
-                        (((s-&gt;linesize[c] * (v * mb_y + y) * 8) +
+                    ptr = data[c] +
+                        (((linesize[c] * (v * mb_y + y) * 8) +
                         (h * mb_x + x) * 8) &gt;&gt; s-&gt;avctx-&gt;lowres);
                     if (s-&gt;interlaced &amp;&amp; s-&gt;bottom_field)
-                        ptr += s-&gt;linesize[c] &gt;&gt; 1;
+                        ptr += linesize[c] &gt;&gt; 1;
 //av_log(NULL, AV_LOG_DEBUG, &quot;%d %d %d %d %d %d %d %d \n&quot;, mb_x, mb_y, x, y, c, s-&gt;bottom_field, (v * mb_y + y) * 8, (h * mb_x + x) * 8);
                     if(!s-&gt;progressive)
-                        s-&gt;dsp.idct_put(ptr, s-&gt;linesize[c], s-&gt;block);
+                        s-&gt;dsp.idct_put(ptr, linesize[c], s-&gt;block);
                     else
-                        s-&gt;dsp.idct_add(ptr, s-&gt;linesize[c], s-&gt;block);
+                        s-&gt;dsp.idct_add(ptr, linesize[c], s-&gt;block);
                     if (++x == h) {
                         x = 0;
                         y++;

Added: branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec/sp5xdec.c
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec/sp5xdec.c	2007-10-05 20:42:10 UTC (rev 3623)
+++ branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec/sp5xdec.c	2007-10-06 17:27:01 UTC (rev 3624)
@@ -0,0 +1,212 @@
+/*
+ * Sunplus JPEG decoder (SP5X)
+ * Copyright (c) 2003 Alex Beregszaszi
+ *
+ * This file is part of FFmpeg.
+ *
+ * FFmpeg is free software; you can redistribute it and/or
+ * modify it under the terms of the GNU Lesser General Public
+ * License as published by the Free Software Foundation; either
+ * version 2.1 of the License, or (at your option) any later version.
+ *
+ * FFmpeg is distributed in the hope that it will be useful,
+ * but WITHOUT ANY WARRANTY; without even the implied warranty of
+ * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ * Lesser General Public License for more details.
+ *
+ * You should have received a copy of the GNU Lesser General Public
+ * License along with FFmpeg; if not, write to the Free Software
+ * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA
+ */
+
+/**
+ * @file sp5xdec.c
+ * Sunplus JPEG decoder (SP5X).
+ */
+
+#include &quot;avcodec.h&quot;
+#include &quot;mjpeg.h&quot;
+#include &quot;mjpegdec.h&quot;
+#include &quot;sp5x.h&quot;
+
+
+static int sp5x_decode_frame(AVCodecContext *avctx,
+                              void *data, int *data_size,
+                              uint8_t *buf, int buf_size)
+{
+#if 0
+    MJpegDecodeContext *s = avctx-&gt;priv_data;
+#endif
+    const int qscale = 5;
+    uint8_t *buf_ptr, *buf_end, *recoded;
+    int i = 0, j = 0;
+
+    if (!avctx-&gt;width || !avctx-&gt;height)
+        return -1;
+
+    buf_ptr = buf;
+    buf_end = buf + buf_size;
+
+#if 1
+    recoded = av_mallocz(buf_size + 1024);
+    if (!recoded)
+        return -1;
+
+    /* SOI */
+    recoded[j++] = 0xFF;
+    recoded[j++] = 0xD8;
+
+    memcpy(recoded+j, &amp;sp5x_data_dqt[0], sizeof(sp5x_data_dqt));
+    memcpy(recoded+j+5, &amp;sp5x_quant_table[qscale * 2], 64);
+    memcpy(recoded+j+70, &amp;sp5x_quant_table[(qscale * 2) + 1], 64);
+    j += sizeof(sp5x_data_dqt);
+
+    memcpy(recoded+j, &amp;sp5x_data_dht[0], sizeof(sp5x_data_dht));
+    j += sizeof(sp5x_data_dht);
+
+    memcpy(recoded+j, &amp;sp5x_data_sof[0], sizeof(sp5x_data_sof));
+    AV_WB16(recoded+j+5, avctx-&gt;coded_height);
+    AV_WB16(recoded+j+7, avctx-&gt;coded_width);
+    j += sizeof(sp5x_data_sof);
+
+    memcpy(recoded+j, &amp;sp5x_data_sos[0], sizeof(sp5x_data_sos));
+    j += sizeof(sp5x_data_sos);
+
+    if(avctx-&gt;codec_id==CODEC_ID_AMV)
+        for (i = 2; i &lt; buf_size-2 &amp;&amp; j &lt; buf_size+1024-2; i++)
+            recoded[j++] = buf[i];
+    else
+    for (i = 14; i &lt; buf_size &amp;&amp; j &lt; buf_size+1024-2; i++)
+    {
+        recoded[j++] = buf[i];
+        if (buf[i] == 0xff)
+            recoded[j++] = 0;
+    }
+
+    /* EOI */
+    recoded[j++] = 0xFF;
+    recoded[j++] = 0xD9;
+
+    i = ff_mjpeg_decode_frame(avctx, data, data_size, recoded, j);
+
+    av_free(recoded);
+
+#else
+    /* SOF */
+    s-&gt;bits = 8;
+    s-&gt;width  = avctx-&gt;coded_width;
+    s-&gt;height = avctx-&gt;coded_height;
+    s-&gt;nb_components = 3;
+    s-&gt;component_id[0] = 0;
+    s-&gt;h_count[0] = 2;
+    s-&gt;v_count[0] = 2;
+    s-&gt;quant_index[0] = 0;
+    s-&gt;component_id[1] = 1;
+    s-&gt;h_count[1] = 1;
+    s-&gt;v_count[1] = 1;
+    s-&gt;quant_index[1] = 1;
+    s-&gt;component_id[2] = 2;
+    s-&gt;h_count[2] = 1;
+    s-&gt;v_count[2] = 1;
+    s-&gt;quant_index[2] = 1;
+    s-&gt;h_max = 2;
+    s-&gt;v_max = 2;
+
+    s-&gt;qscale_table = av_mallocz((s-&gt;width+15)/16);
+    avctx-&gt;pix_fmt = s-&gt;cs_itu601 ? PIX_FMT_YUV420P : PIX_FMT_YUVJ420;
+    s-&gt;interlaced = 0;
+
+    s-&gt;picture.reference = 0;
+    if (avctx-&gt;get_buffer(avctx, &amp;s-&gt;picture) &lt; 0)
+    {
+        av_log(avctx, AV_LOG_ERROR, &quot;get_buffer() failed\n&quot;);
+        return -1;
+    }
+
+    s-&gt;picture.pict_type = I_TYPE;
+    s-&gt;picture.key_frame = 1;
+
+    for (i = 0; i &lt; 3; i++)
+        s-&gt;linesize[i] = s-&gt;picture.linesize[i] &lt;&lt; s-&gt;interlaced;
+
+    /* DQT */
+    for (i = 0; i &lt; 64; i++)
+    {
+        j = s-&gt;scantable.permutated[i];
+        s-&gt;quant_matrixes[0][j] = sp5x_quant_table[(qscale * 2) + i];
+    }
+    s-&gt;qscale[0] = FFMAX(
+        s-&gt;quant_matrixes[0][s-&gt;scantable.permutated[1]],
+        s-&gt;quant_matrixes[0][s-&gt;scantable.permutated[8]]) &gt;&gt; 1;
+
+    for (i = 0; i &lt; 64; i++)
+    {
+        j = s-&gt;scantable.permutated[i];
+        s-&gt;quant_matrixes[1][j] = sp5x_quant_table[(qscale * 2) + 1 + i];
+    }
+    s-&gt;qscale[1] = FFMAX(
+        s-&gt;quant_matrixes[1][s-&gt;scantable.permutated[1]],
+        s-&gt;quant_matrixes[1][s-&gt;scantable.permutated[8]]) &gt;&gt; 1;
+
+    /* DHT */
+
+    /* SOS */
+    s-&gt;comp_index[0] = 0;
+    s-&gt;nb_blocks[0] = s-&gt;h_count[0] * s-&gt;v_count[0];
+    s-&gt;h_scount[0] = s-&gt;h_count[0];
+    s-&gt;v_scount[0] = s-&gt;v_count[0];
+    s-&gt;dc_index[0] = 0;
+    s-&gt;ac_index[0] = 0;
+
+    s-&gt;comp_index[1] = 1;
+    s-&gt;nb_blocks[1] = s-&gt;h_count[1] * s-&gt;v_count[1];
+    s-&gt;h_scount[1] = s-&gt;h_count[1];
+    s-&gt;v_scount[1] = s-&gt;v_count[1];
+    s-&gt;dc_index[1] = 1;
+    s-&gt;ac_index[1] = 1;
+
+    s-&gt;comp_index[2] = 2;
+    s-&gt;nb_blocks[2] = s-&gt;h_count[2] * s-&gt;v_count[2];
+    s-&gt;h_scount[2] = s-&gt;h_count[2];
+    s-&gt;v_scount[2] = s-&gt;v_count[2];
+    s-&gt;dc_index[2] = 1;
+    s-&gt;ac_index[2] = 1;
+
+    for (i = 0; i &lt; 3; i++)
+        s-&gt;last_dc[i] = 1024;
+
+    s-&gt;mb_width = (s-&gt;width * s-&gt;h_max * 8 -1) / (s-&gt;h_max * 8);
+    s-&gt;mb_height = (s-&gt;height * s-&gt;v_max * 8 -1) / (s-&gt;v_max * 8);
+
+    init_get_bits(&amp;s-&gt;gb, buf+14, (buf_size-14)*8);
+
+    return mjpeg_decode_scan(s);
+#endif
+
+    return i;
+}
+
+AVCodec sp5x_decoder = {
+    &quot;sp5x&quot;,
+    CODEC_TYPE_VIDEO,
+    CODEC_ID_SP5X,
+    sizeof(MJpegDecodeContext),
+    ff_mjpeg_decode_init,
+    NULL,
+    ff_mjpeg_decode_end,
+    sp5x_decode_frame,
+    CODEC_CAP_DR1,
+    NULL
+};
+
+AVCodec amv_decoder = {
+    &quot;amv&quot;,
+    CODEC_TYPE_VIDEO,
+    CODEC_ID_AMV,
+    sizeof(MJpegDecodeContext),
+    ff_mjpeg_decode_init,
+    NULL,
+    ff_mjpeg_decode_end,
+    sp5x_decode_frame,
+    CODEC_CAP_DR1
+};

Modified: branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavutil/avutil.h
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavutil/avutil.h	2007-10-05 20:42:10 UTC (rev 3623)
+++ branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavutil/avutil.h	2007-10-06 17:27:01 UTC (rev 3624)
@@ -30,14 +30,15 @@
 #define AV_STRINGIFY(s)         AV_TOSTRING(s)
 #define AV_TOSTRING(s) #s
 
-#define LIBAVUTIL_VERSION_INT   ((49&lt;&lt;16)+(4&lt;&lt;8)+1)
-#define LIBAVUTIL_VERSION       49.4.1
+#define LIBAVUTIL_VERSION_INT   ((49&lt;&lt;16)+(5&lt;&lt;8)+0)
+#define LIBAVUTIL_VERSION       49.5.0
 #define LIBAVUTIL_BUILD         LIBAVUTIL_VERSION_INT
 
 #define LIBAVUTIL_IDENT         &quot;Lavu&quot; AV_STRINGIFY(LIBAVUTIL_VERSION)
+
 /* MEANX
- */
-	#define ASMALIGN(ZEROBITS) &quot;.p2align &quot; #ZEROBITS &quot;\n\t&quot; 
+ * - */
+#define ASMALIGN(ZEROBITS) &quot;.p2align &quot; #ZEROBITS &quot;\n\t&quot;
 /* /MEANX
  */
 
@@ -108,6 +109,9 @@
 
     PIX_FMT_GRAY16BE,  ///&lt;        Y        , 16bpp, big-endian
     PIX_FMT_GRAY16LE,  ///&lt;        Y        , 16bpp, little-endian
+    PIX_FMT_YUV440P,   ///&lt; Planar YUV 4:4:0 (1 Cr &amp; Cb sample per 1x2 Y samples)
+    PIX_FMT_YUVJ440P,  ///&lt; Planar YUV 4:4:0 full scale (jpeg)
+    PIX_FMT_YUVA420P,  ///&lt; Planar YUV 4:2:0, 20bpp, (1 Cr &amp; Cb sample per 2x2 Y &amp; A samples)
     PIX_FMT_NB,        ///&lt; number of pixel formats, DO NOT USE THIS if you want to link with shared libav* because the number of formats might differ between versions
 };
 


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000895.html">[Avidemux-svn-commit] r3623 -	branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_toolkit_gtk
</A></li>
	<LI>Next message: <A HREF="000897.html">[Avidemux-svn-commit] r3625 - branches/avidemux_2.4_branch
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#896">[ date ]</a>
              <a href="thread.html#896">[ thread ]</a>
              <a href="subject.html#896">[ subject ]</a>
              <a href="author.html#896">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/avidemux-svn-commit">More information about the Avidemux-svn-commit
mailing list</a><br>
</body></html>
