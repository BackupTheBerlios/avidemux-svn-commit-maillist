<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Avidemux-svn-commit] r6137 - in branches/avidemux_2.6_branch_mean:	autononreg/dialogFactory autononreg/dialogFactory/unit	avidemux/common/ADM_script2/src	avidemux/common/ADM_script2/src_dialogFactory
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/avidemux-svn-commit/2010-April/index.html" >
   <LINK REL="made" HREF="mailto:avidemux-svn-commit%40lists.berlios.de?Subject=Re%3A%20%5BAvidemux-svn-commit%5D%20r6137%20-%20in%20branches/avidemux_2.6_branch_mean%3A%0A%09autononreg/dialogFactory%20autononreg/dialogFactory/unit%0A%09avidemux/common/ADM_script2/src%0A%09avidemux/common/ADM_script2/src_dialogFactory&In-Reply-To=%3C201004251430.o3PEUh0J015005%40sheep.berlios.de%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="003340.html">
   <LINK REL="Next"  HREF="003342.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Avidemux-svn-commit] r6137 - in branches/avidemux_2.6_branch_mean:	autononreg/dialogFactory autononreg/dialogFactory/unit	avidemux/common/ADM_script2/src	avidemux/common/ADM_script2/src_dialogFactory</H1>
    <B>mean at BerliOS</B> 
    <A HREF="mailto:avidemux-svn-commit%40lists.berlios.de?Subject=Re%3A%20%5BAvidemux-svn-commit%5D%20r6137%20-%20in%20branches/avidemux_2.6_branch_mean%3A%0A%09autononreg/dialogFactory%20autononreg/dialogFactory/unit%0A%09avidemux/common/ADM_script2/src%0A%09avidemux/common/ADM_script2/src_dialogFactory&In-Reply-To=%3C201004251430.o3PEUh0J015005%40sheep.berlios.de%3E"
       TITLE="[Avidemux-svn-commit] r6137 - in branches/avidemux_2.6_branch_mean:	autononreg/dialogFactory autononreg/dialogFactory/unit	avidemux/common/ADM_script2/src	avidemux/common/ADM_script2/src_dialogFactory">mean at mail.berlios.de
       </A><BR>
    <I>Sun Apr 25 16:30:43 CEST 2010</I>
    <P><UL>
        <LI>Previous message: <A HREF="003340.html">[Avidemux-svn-commit] r6136 -	branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src_dialogFactory
</A></li>
        <LI>Next message: <A HREF="003342.html">[Avidemux-svn-commit] r6138 - in branches/avidemux_2.6_branch_mean:	autononreg/dialogFactory	avidemux/common/ADM_script2/src_dialogFactory
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#3341">[ date ]</a>
              <a href="thread.html#3341">[ thread ]</a>
              <a href="subject.html#3341">[ subject ]</a>
              <a href="author.html#3341">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Author: mean
Date: 2010-04-25 16:30:41 +0200 (Sun, 25 Apr 2010)
New Revision: 6137

Added:
   branches/avidemux_2.6_branch_mean/autononreg/dialogFactory/unit/
   branches/avidemux_2.6_branch_mean/autononreg/dialogFactory/unit/bar.js
   branches/avidemux_2.6_branch_mean/autononreg/dialogFactory/unit/binhex.js
   branches/avidemux_2.6_branch_mean/autononreg/dialogFactory/unit/bitrate.js
   branches/avidemux_2.6_branch_mean/autononreg/dialogFactory/unit/button.js
   branches/avidemux_2.6_branch_mean/autononreg/dialogFactory/unit/dirsel.js
   branches/avidemux_2.6_branch_mean/autononreg/dialogFactory/unit/encoding.js
   branches/avidemux_2.6_branch_mean/autononreg/dialogFactory/unit/fileread.js
   branches/avidemux_2.6_branch_mean/autononreg/dialogFactory/unit/float.js
   branches/avidemux_2.6_branch_mean/autononreg/dialogFactory/unit/frame.js
   branches/avidemux_2.6_branch_mean/autononreg/dialogFactory/unit/hex.js
   branches/avidemux_2.6_branch_mean/autononreg/dialogFactory/unit/integer.js
   branches/avidemux_2.6_branch_mean/autononreg/dialogFactory/unit/matrix.js
   branches/avidemux_2.6_branch_mean/autononreg/dialogFactory/unit/menu.js
   branches/avidemux_2.6_branch_mean/autononreg/dialogFactory/unit/notch.js
   branches/avidemux_2.6_branch_mean/autononreg/dialogFactory/unit/readonlytext.js
   branches/avidemux_2.6_branch_mean/autononreg/dialogFactory/unit/run_non_reg.sh
   branches/avidemux_2.6_branch_mean/autononreg/dialogFactory/unit/slider.js
   branches/avidemux_2.6_branch_mean/autononreg/dialogFactory/unit/tabs.js
   branches/avidemux_2.6_branch_mean/autononreg/dialogFactory/unit/text.js
   branches/avidemux_2.6_branch_mean/autononreg/dialogFactory/unit/threadcount.js
   branches/avidemux_2.6_branch_mean/autononreg/dialogFactory/unit/toggle.js
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src_dialogFactory/ADM_JSDF.h
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src_dialogFactory/ADM_JSDFToggle.cpp
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src_dialogFactory/ADM_JSDFToggle.h
Removed:
   branches/avidemux_2.6_branch_mean/autononreg/dialogFactory/bar.js
   branches/avidemux_2.6_branch_mean/autononreg/dialogFactory/binhex.js
   branches/avidemux_2.6_branch_mean/autononreg/dialogFactory/bitrate.js
   branches/avidemux_2.6_branch_mean/autononreg/dialogFactory/button.js
   branches/avidemux_2.6_branch_mean/autononreg/dialogFactory/dirsel.js
   branches/avidemux_2.6_branch_mean/autononreg/dialogFactory/encoding.js
   branches/avidemux_2.6_branch_mean/autononreg/dialogFactory/fileread.js
   branches/avidemux_2.6_branch_mean/autononreg/dialogFactory/float.js
   branches/avidemux_2.6_branch_mean/autononreg/dialogFactory/frame.js
   branches/avidemux_2.6_branch_mean/autononreg/dialogFactory/hex.js
   branches/avidemux_2.6_branch_mean/autononreg/dialogFactory/integer.js
   branches/avidemux_2.6_branch_mean/autononreg/dialogFactory/matrix.js
   branches/avidemux_2.6_branch_mean/autononreg/dialogFactory/notch.js
   branches/avidemux_2.6_branch_mean/autononreg/dialogFactory/readonlytext.js
   branches/avidemux_2.6_branch_mean/autononreg/dialogFactory/run_non_reg.sh
   branches/avidemux_2.6_branch_mean/autononreg/dialogFactory/slider.js
   branches/avidemux_2.6_branch_mean/autononreg/dialogFactory/tabs.js
   branches/avidemux_2.6_branch_mean/autononreg/dialogFactory/text.js
   branches/avidemux_2.6_branch_mean/autononreg/dialogFactory/threadcount.js
Modified:
   branches/avidemux_2.6_branch_mean/autononreg/dialogFactory/menu.js
   branches/avidemux_2.6_branch_mean/autononreg/dialogFactory/toggle.js
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src/ADM_jsIf.cpp
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src_dialogFactory/ADM_JSDFMenu.h
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src_dialogFactory/ADM_JSDialogFactory.cpp
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src_dialogFactory/ADM_JSDialogFactory.h
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src_dialogFactory/ADM_JSDialogFactory_if.cpp
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src_dialogFactory/CMakeLists.txt
Log:
[JS/DF] Add toggle, cleanup

Deleted: branches/avidemux_2.6_branch_mean/autononreg/dialogFactory/bar.js
===================================================================
--- branches/avidemux_2.6_branch_mean/autononreg/dialogFactory/bar.js	2010-04-25 14:30:40 UTC (rev 6136)
+++ branches/avidemux_2.6_branch_mean/autononreg/dialogFactory/bar.js	2010-04-25 14:30:41 UTC (rev 6137)
@@ -1,7 +0,0 @@
-//AD  &lt;- These first 4 characters need to be the first 4 characters to identify the ECMAScript file to Avidemux
-print(&quot;Testing factory bar&quot;);
-	admTestFacBar();
-print(&quot;/Testing factory bar&quot;);
-
-/* End of test
-*/

Deleted: branches/avidemux_2.6_branch_mean/autononreg/dialogFactory/binhex.js
===================================================================
--- branches/avidemux_2.6_branch_mean/autononreg/dialogFactory/binhex.js	2010-04-25 14:30:40 UTC (rev 6136)
+++ branches/avidemux_2.6_branch_mean/autononreg/dialogFactory/binhex.js	2010-04-25 14:30:41 UTC (rev 6137)
@@ -1,6 +0,0 @@
-//AD  &lt;- These first 4 characters need to be the first 4 characters to identify the ECMAScript file to Avidemux
-print(&quot;Testing factory Hex&quot;);
-	admTestFacHex();
-print(&quot;Testing factory Hex&quot;);
-/* End of test
-*/

Deleted: branches/avidemux_2.6_branch_mean/autononreg/dialogFactory/bitrate.js
===================================================================
--- branches/avidemux_2.6_branch_mean/autononreg/dialogFactory/bitrate.js	2010-04-25 14:30:40 UTC (rev 6136)
+++ branches/avidemux_2.6_branch_mean/autononreg/dialogFactory/bitrate.js	2010-04-25 14:30:41 UTC (rev 6137)
@@ -1,6 +0,0 @@
-//AD  &lt;- These first 4 characters need to be the first 4 characters to identify the ECMAScript file to Avidemux
-print(&quot;Testing factory Bitrate&quot;);
-	admTestFacBitrate();
-print(&quot;Testing factory Bitrate&quot;);
-/* End of test
-*/

Deleted: branches/avidemux_2.6_branch_mean/autononreg/dialogFactory/button.js
===================================================================
--- branches/avidemux_2.6_branch_mean/autononreg/dialogFactory/button.js	2010-04-25 14:30:40 UTC (rev 6136)
+++ branches/avidemux_2.6_branch_mean/autononreg/dialogFactory/button.js	2010-04-25 14:30:41 UTC (rev 6137)
@@ -1,4 +0,0 @@
-//AD  &lt;- These first 4 characters need to be the first 4 characters to identify the ECMAScript file to Avidemux
-print(&quot;Testing factory Button&quot;);
-	admTestFacButton();
-print(&quot;Testing factory Button&quot;);

Deleted: branches/avidemux_2.6_branch_mean/autononreg/dialogFactory/dirsel.js
===================================================================
--- branches/avidemux_2.6_branch_mean/autononreg/dialogFactory/dirsel.js	2010-04-25 14:30:40 UTC (rev 6136)
+++ branches/avidemux_2.6_branch_mean/autononreg/dialogFactory/dirsel.js	2010-04-25 14:30:41 UTC (rev 6137)
@@ -1,7 +0,0 @@
-//AD  &lt;- These first 4 characters need to be the first 4 characters to identify the ECMAScript file to Avidemux
-print(&quot;Testing factory DirSel&quot;);
-	admTestFacDirSel();
-print(&quot;Testing factory DirSel&quot;);
-
-/* End of test
-*/

Deleted: branches/avidemux_2.6_branch_mean/autononreg/dialogFactory/encoding.js
===================================================================
--- branches/avidemux_2.6_branch_mean/autononreg/dialogFactory/encoding.js	2010-04-25 14:30:40 UTC (rev 6136)
+++ branches/avidemux_2.6_branch_mean/autononreg/dialogFactory/encoding.js	2010-04-25 14:30:41 UTC (rev 6137)
@@ -1,6 +0,0 @@
-//AD  &lt;- These first 4 characters need to be the first 4 characters to identify the ECMAScript file to Avidemux
-print(&quot;Testing factory FileSel&quot;);
-admTestEncoding();
-print(&quot;Testing factory FileSel&quot;);
-/* End of test
-*/

Deleted: branches/avidemux_2.6_branch_mean/autononreg/dialogFactory/fileread.js
===================================================================
--- branches/avidemux_2.6_branch_mean/autononreg/dialogFactory/fileread.js	2010-04-25 14:30:40 UTC (rev 6136)
+++ branches/avidemux_2.6_branch_mean/autononreg/dialogFactory/fileread.js	2010-04-25 14:30:41 UTC (rev 6137)
@@ -1,6 +0,0 @@
-//AD  &lt;- These first 4 characters need to be the first 4 characters to identify the ECMAScript file to Avidemux
-print(&quot;Testing factory FileSel&quot;);
-	admTestFacFile();
-print(&quot;Testing factory FileSel&quot;);
-/* End of test
-*/

Deleted: branches/avidemux_2.6_branch_mean/autononreg/dialogFactory/float.js
===================================================================
--- branches/avidemux_2.6_branch_mean/autononreg/dialogFactory/float.js	2010-04-25 14:30:40 UTC (rev 6136)
+++ branches/avidemux_2.6_branch_mean/autononreg/dialogFactory/float.js	2010-04-25 14:30:41 UTC (rev 6137)
@@ -1,6 +0,0 @@
-//AD  &lt;- These first 4 characters need to be the first 4 characters to identify the ECMAScript file to Avidemux
-print(&quot;Testing factory Float&quot;);
-	admTestFacFloat();
-print(&quot;Testing factory Float&quot;);
-/* End of test
-*/

Deleted: branches/avidemux_2.6_branch_mean/autononreg/dialogFactory/frame.js
===================================================================
--- branches/avidemux_2.6_branch_mean/autononreg/dialogFactory/frame.js	2010-04-25 14:30:40 UTC (rev 6136)
+++ branches/avidemux_2.6_branch_mean/autononreg/dialogFactory/frame.js	2010-04-25 14:30:41 UTC (rev 6137)
@@ -1,4 +0,0 @@
-//AD  &lt;- These first 4 characters need to be the first 4 characters to identify the ECMAScript file to Avidemux
-print(&quot;Testing factory Frame&quot;);
-	admTestFacFrame();
-print(&quot;Testing factory Frame&quot;);

Deleted: branches/avidemux_2.6_branch_mean/autononreg/dialogFactory/hex.js
===================================================================
--- branches/avidemux_2.6_branch_mean/autononreg/dialogFactory/hex.js	2010-04-25 14:30:40 UTC (rev 6136)
+++ branches/avidemux_2.6_branch_mean/autononreg/dialogFactory/hex.js	2010-04-25 14:30:41 UTC (rev 6137)
@@ -1,4 +0,0 @@
-//AD  &lt;- These first 4 characters need to be the first 4 characters to identify the ECMAScript file to Avidemux
-print(&quot;Testing factory hex&quot;);
-	admTestFacHex();
-print(&quot;Testing factory hex&quot;);

Deleted: branches/avidemux_2.6_branch_mean/autononreg/dialogFactory/integer.js
===================================================================
--- branches/avidemux_2.6_branch_mean/autononreg/dialogFactory/integer.js	2010-04-25 14:30:40 UTC (rev 6136)
+++ branches/avidemux_2.6_branch_mean/autononreg/dialogFactory/integer.js	2010-04-25 14:30:41 UTC (rev 6137)
@@ -1,6 +0,0 @@
-//AD  &lt;- These first 4 characters need to be the first 4 characters to identify the ECMAScript file to Avidemux
-print(&quot;Testing factory int&quot;);
-	admTestFacInt();
-print(&quot;Testing factory int&quot;);
-/* End of test
-*/

Deleted: branches/avidemux_2.6_branch_mean/autononreg/dialogFactory/matrix.js
===================================================================
--- branches/avidemux_2.6_branch_mean/autononreg/dialogFactory/matrix.js	2010-04-25 14:30:40 UTC (rev 6136)
+++ branches/avidemux_2.6_branch_mean/autononreg/dialogFactory/matrix.js	2010-04-25 14:30:41 UTC (rev 6137)
@@ -1,4 +0,0 @@
-//AD  &lt;- These first 4 characters need to be the first 4 characters to identify the ECMAScript file to Avidemux
-print(&quot;Testing factory Matrix&quot;);
-	admTestFacMatrix();
-print(&quot;Testing factory Matrix&quot;);

Modified: branches/avidemux_2.6_branch_mean/autononreg/dialogFactory/menu.js
===================================================================
--- branches/avidemux_2.6_branch_mean/autononreg/dialogFactory/menu.js	2010-04-25 14:30:40 UTC (rev 6136)
+++ branches/avidemux_2.6_branch_mean/autononreg/dialogFactory/menu.js	2010-04-25 14:30:41 UTC (rev 6137)
@@ -1,6 +1,22 @@
-//AD  &lt;- These first 4 characters need to be the first 4 characters to identify the ECMAScript file to Avidemux
-print(&quot;Testing factory Menu&quot;);
-	admTestFacMenu();
-print(&quot;Testing factory Menu&quot;);
-/* End of test
-*/
+    var aspectRatios = [[1, 1], [4, 3], [16, 9]];
+    var mnuResolution = new DFMenu(&quot;Resolution:&quot;);
+    var mnuSourceRatio = new DFMenu(&quot;Source Aspect Ratio:&quot;);
+    var mnuDestinationRatio = new DFMenu(&quot;Destination Aspect Ratio:&quot;);
+    var dlgWizard = new DialogFactory(&quot;Dialog Factory menu&quot;);
+    var i;
+
+    for (i = 0; i &lt; aspectRatios.length; i++)
+    {
+        mnuSourceRatio.addItem(aspectRatios[i][0].toString() + &quot;:&quot; + aspectRatios[i][1].toString());
+        mnuDestinationRatio.addItem(aspectRatios[i][0].toString() + &quot;:&quot; + aspectRatios[i][1].toString());
+    }
+    
+
+    dlgWizard.addControl(mnuSourceRatio);
+    dlgWizard.addControl(mnuDestinationRatio);
+
+    if (dlgWizard.show())
+    {
+                var out=&quot;source index&quot;+mnuSourceRatio.index+&quot;, dest index=&quot;+mnuDestinationRatio.index;
+                print(out);
+    }

Deleted: branches/avidemux_2.6_branch_mean/autononreg/dialogFactory/notch.js
===================================================================
--- branches/avidemux_2.6_branch_mean/autononreg/dialogFactory/notch.js	2010-04-25 14:30:40 UTC (rev 6136)
+++ branches/avidemux_2.6_branch_mean/autononreg/dialogFactory/notch.js	2010-04-25 14:30:41 UTC (rev 6137)
@@ -1,6 +0,0 @@
-//AD  &lt;- These first 4 characters need to be the first 4 characters to identify the ECMAScript file to Avidemux
-print(&quot;Testing factory Notch&quot;);
-	admTestFacNotch();
-print(&quot;Testing factory Notch&quot;);
-/* End of test
-*/

Deleted: branches/avidemux_2.6_branch_mean/autononreg/dialogFactory/readonlytext.js
===================================================================
--- branches/avidemux_2.6_branch_mean/autononreg/dialogFactory/readonlytext.js	2010-04-25 14:30:40 UTC (rev 6136)
+++ branches/avidemux_2.6_branch_mean/autononreg/dialogFactory/readonlytext.js	2010-04-25 14:30:41 UTC (rev 6137)
@@ -1,6 +0,0 @@
-//AD  &lt;- These first 4 characters need to be the first 4 characters to identify the ECMAScript file to Avidemux
-print(&quot;Testing factory RoTexy&quot;);
-	admTestFacRoText();
-print(&quot;Testing factory RoText&quot;);
-/* End of test
-*/

Deleted: branches/avidemux_2.6_branch_mean/autononreg/dialogFactory/run_non_reg.sh
===================================================================
--- branches/avidemux_2.6_branch_mean/autononreg/dialogFactory/run_non_reg.sh	2010-04-25 14:30:40 UTC (rev 6136)
+++ branches/avidemux_2.6_branch_mean/autononreg/dialogFactory/run_non_reg.sh	2010-04-25 14:30:41 UTC (rev 6137)
@@ -1,11 +0,0 @@
-#!/bin/bash
-export PRG=~/workspace/qt4/avidemux3_qt4
-export SRC=.
-echo &quot;Running tests...&quot;
-#*****************
-cd functiontest
-perl ../foreach.pl $SRC/*.js &quot;echo %f &amp;&amp;  $PRG    --run %f --quit &gt; /dev/null&quot;
-cd ..
-#*****************
-echo &quot;## ALL done checking...##&quot;
-		

Deleted: branches/avidemux_2.6_branch_mean/autononreg/dialogFactory/slider.js
===================================================================
--- branches/avidemux_2.6_branch_mean/autononreg/dialogFactory/slider.js	2010-04-25 14:30:40 UTC (rev 6136)
+++ branches/avidemux_2.6_branch_mean/autononreg/dialogFactory/slider.js	2010-04-25 14:30:41 UTC (rev 6137)
@@ -1,4 +0,0 @@
-//AD  &lt;- These first 4 characters need to be the first 4 characters to identify the ECMAScript file to Avidemux
-print(&quot;Testing factory Slider&quot;);
-	admTestFacSlider();
-print(&quot;Testing factory Slider&quot;);

Deleted: branches/avidemux_2.6_branch_mean/autononreg/dialogFactory/tabs.js
===================================================================
--- branches/avidemux_2.6_branch_mean/autononreg/dialogFactory/tabs.js	2010-04-25 14:30:40 UTC (rev 6136)
+++ branches/avidemux_2.6_branch_mean/autononreg/dialogFactory/tabs.js	2010-04-25 14:30:41 UTC (rev 6137)
@@ -1,6 +0,0 @@
-//AD  &lt;- These first 4 characters need to be the first 4 characters to identify the ECMAScript file to Avidemux
-print(&quot;Testing factory Tabs&quot;);
-	admTestFacTab();
-print(&quot;Testing factory Tabs&quot;);
-/* End of test
-*/

Deleted: branches/avidemux_2.6_branch_mean/autononreg/dialogFactory/text.js
===================================================================
--- branches/avidemux_2.6_branch_mean/autononreg/dialogFactory/text.js	2010-04-25 14:30:40 UTC (rev 6136)
+++ branches/avidemux_2.6_branch_mean/autononreg/dialogFactory/text.js	2010-04-25 14:30:41 UTC (rev 6137)
@@ -1,6 +0,0 @@
-//AD  &lt;- These first 4 characters need to be the first 4 characters to identify the ECMAScript file to Avidemux
-print(&quot;Testing factory Text&quot;);
-	admTestFacText();
-print(&quot;Testing factory Text&quot;);
-/* End of test
-*/

Deleted: branches/avidemux_2.6_branch_mean/autononreg/dialogFactory/threadcount.js
===================================================================
--- branches/avidemux_2.6_branch_mean/autononreg/dialogFactory/threadcount.js	2010-04-25 14:30:40 UTC (rev 6136)
+++ branches/avidemux_2.6_branch_mean/autononreg/dialogFactory/threadcount.js	2010-04-25 14:30:41 UTC (rev 6137)
@@ -1,4 +0,0 @@
-//AD  &lt;- These first 4 characters need to be the first 4 characters to identify the ECMAScript file to Avidemux
-print(&quot;Testing factory ThreadCount&quot;);
-	admTestFacThreadCount();
-print(&quot;Testing factory ThreadCount&quot;);

Modified: branches/avidemux_2.6_branch_mean/autononreg/dialogFactory/toggle.js
===================================================================
--- branches/avidemux_2.6_branch_mean/autononreg/dialogFactory/toggle.js	2010-04-25 14:30:40 UTC (rev 6136)
+++ branches/avidemux_2.6_branch_mean/autononreg/dialogFactory/toggle.js	2010-04-25 14:30:41 UTC (rev 6137)
@@ -1,4 +1,12 @@
-//AD  &lt;- These first 4 characters need to be the first 4 characters to identify the ECMAScript file to Avidemux
-print(&quot;Testing factory Toggle&quot;);
-	admTestFacToggle();
-print(&quot;Testing factory Toggle&quot;);
+    var toggle = new DFToggle(&quot;Toggle:&quot;);
+    var dlgWizard = new DialogFactory(&quot;Dialog Factory toggle&quot;);
+
+    
+    toggle.value=0;
+    dlgWizard.addControl(toggle);
+
+    if (dlgWizard.show())
+    {
+                var out=&quot;toggle &quot;+toggle.value;
+                print(out);
+    }

Copied: branches/avidemux_2.6_branch_mean/autononreg/dialogFactory/unit/bar.js (from rev 6136, branches/avidemux_2.6_branch_mean/autononreg/dialogFactory/bar.js)
===================================================================
--- branches/avidemux_2.6_branch_mean/autononreg/dialogFactory/bar.js	2010-04-25 14:30:40 UTC (rev 6136)
+++ branches/avidemux_2.6_branch_mean/autononreg/dialogFactory/unit/bar.js	2010-04-25 14:30:41 UTC (rev 6137)
@@ -0,0 +1,7 @@
+//AD  &lt;- These first 4 characters need to be the first 4 characters to identify the ECMAScript file to Avidemux
+print(&quot;Testing factory bar&quot;);
+	admTestFacBar();
+print(&quot;/Testing factory bar&quot;);
+
+/* End of test
+*/

Copied: branches/avidemux_2.6_branch_mean/autononreg/dialogFactory/unit/binhex.js (from rev 6136, branches/avidemux_2.6_branch_mean/autononreg/dialogFactory/binhex.js)
===================================================================
--- branches/avidemux_2.6_branch_mean/autononreg/dialogFactory/binhex.js	2010-04-25 14:30:40 UTC (rev 6136)
+++ branches/avidemux_2.6_branch_mean/autononreg/dialogFactory/unit/binhex.js	2010-04-25 14:30:41 UTC (rev 6137)
@@ -0,0 +1,6 @@
+//AD  &lt;- These first 4 characters need to be the first 4 characters to identify the ECMAScript file to Avidemux
+print(&quot;Testing factory Hex&quot;);
+	admTestFacHex();
+print(&quot;Testing factory Hex&quot;);
+/* End of test
+*/

Copied: branches/avidemux_2.6_branch_mean/autononreg/dialogFactory/unit/bitrate.js (from rev 6136, branches/avidemux_2.6_branch_mean/autononreg/dialogFactory/bitrate.js)
===================================================================
--- branches/avidemux_2.6_branch_mean/autononreg/dialogFactory/bitrate.js	2010-04-25 14:30:40 UTC (rev 6136)
+++ branches/avidemux_2.6_branch_mean/autononreg/dialogFactory/unit/bitrate.js	2010-04-25 14:30:41 UTC (rev 6137)
@@ -0,0 +1,6 @@
+//AD  &lt;- These first 4 characters need to be the first 4 characters to identify the ECMAScript file to Avidemux
+print(&quot;Testing factory Bitrate&quot;);
+	admTestFacBitrate();
+print(&quot;Testing factory Bitrate&quot;);
+/* End of test
+*/

Copied: branches/avidemux_2.6_branch_mean/autononreg/dialogFactory/unit/button.js (from rev 6136, branches/avidemux_2.6_branch_mean/autononreg/dialogFactory/button.js)
===================================================================
--- branches/avidemux_2.6_branch_mean/autononreg/dialogFactory/button.js	2010-04-25 14:30:40 UTC (rev 6136)
+++ branches/avidemux_2.6_branch_mean/autononreg/dialogFactory/unit/button.js	2010-04-25 14:30:41 UTC (rev 6137)
@@ -0,0 +1,4 @@
+//AD  &lt;- These first 4 characters need to be the first 4 characters to identify the ECMAScript file to Avidemux
+print(&quot;Testing factory Button&quot;);
+	admTestFacButton();
+print(&quot;Testing factory Button&quot;);

Copied: branches/avidemux_2.6_branch_mean/autononreg/dialogFactory/unit/dirsel.js (from rev 6136, branches/avidemux_2.6_branch_mean/autononreg/dialogFactory/dirsel.js)
===================================================================
--- branches/avidemux_2.6_branch_mean/autononreg/dialogFactory/dirsel.js	2010-04-25 14:30:40 UTC (rev 6136)
+++ branches/avidemux_2.6_branch_mean/autononreg/dialogFactory/unit/dirsel.js	2010-04-25 14:30:41 UTC (rev 6137)
@@ -0,0 +1,7 @@
+//AD  &lt;- These first 4 characters need to be the first 4 characters to identify the ECMAScript file to Avidemux
+print(&quot;Testing factory DirSel&quot;);
+	admTestFacDirSel();
+print(&quot;Testing factory DirSel&quot;);
+
+/* End of test
+*/

Copied: branches/avidemux_2.6_branch_mean/autononreg/dialogFactory/unit/encoding.js (from rev 6136, branches/avidemux_2.6_branch_mean/autononreg/dialogFactory/encoding.js)
===================================================================
--- branches/avidemux_2.6_branch_mean/autononreg/dialogFactory/encoding.js	2010-04-25 14:30:40 UTC (rev 6136)
+++ branches/avidemux_2.6_branch_mean/autononreg/dialogFactory/unit/encoding.js	2010-04-25 14:30:41 UTC (rev 6137)
@@ -0,0 +1,6 @@
+//AD  &lt;- These first 4 characters need to be the first 4 characters to identify the ECMAScript file to Avidemux
+print(&quot;Testing factory FileSel&quot;);
+admTestEncoding();
+print(&quot;Testing factory FileSel&quot;);
+/* End of test
+*/

Copied: branches/avidemux_2.6_branch_mean/autononreg/dialogFactory/unit/fileread.js (from rev 6136, branches/avidemux_2.6_branch_mean/autononreg/dialogFactory/fileread.js)
===================================================================
--- branches/avidemux_2.6_branch_mean/autononreg/dialogFactory/fileread.js	2010-04-25 14:30:40 UTC (rev 6136)
+++ branches/avidemux_2.6_branch_mean/autononreg/dialogFactory/unit/fileread.js	2010-04-25 14:30:41 UTC (rev 6137)
@@ -0,0 +1,6 @@
+//AD  &lt;- These first 4 characters need to be the first 4 characters to identify the ECMAScript file to Avidemux
+print(&quot;Testing factory FileSel&quot;);
+	admTestFacFile();
+print(&quot;Testing factory FileSel&quot;);
+/* End of test
+*/

Copied: branches/avidemux_2.6_branch_mean/autononreg/dialogFactory/unit/float.js (from rev 6136, branches/avidemux_2.6_branch_mean/autononreg/dialogFactory/float.js)
===================================================================
--- branches/avidemux_2.6_branch_mean/autononreg/dialogFactory/float.js	2010-04-25 14:30:40 UTC (rev 6136)
+++ branches/avidemux_2.6_branch_mean/autononreg/dialogFactory/unit/float.js	2010-04-25 14:30:41 UTC (rev 6137)
@@ -0,0 +1,6 @@
+//AD  &lt;- These first 4 characters need to be the first 4 characters to identify the ECMAScript file to Avidemux
+print(&quot;Testing factory Float&quot;);
+	admTestFacFloat();
+print(&quot;Testing factory Float&quot;);
+/* End of test
+*/

Copied: branches/avidemux_2.6_branch_mean/autononreg/dialogFactory/unit/frame.js (from rev 6136, branches/avidemux_2.6_branch_mean/autononreg/dialogFactory/frame.js)
===================================================================
--- branches/avidemux_2.6_branch_mean/autononreg/dialogFactory/frame.js	2010-04-25 14:30:40 UTC (rev 6136)
+++ branches/avidemux_2.6_branch_mean/autononreg/dialogFactory/unit/frame.js	2010-04-25 14:30:41 UTC (rev 6137)
@@ -0,0 +1,4 @@
+//AD  &lt;- These first 4 characters need to be the first 4 characters to identify the ECMAScript file to Avidemux
+print(&quot;Testing factory Frame&quot;);
+	admTestFacFrame();
+print(&quot;Testing factory Frame&quot;);

Copied: branches/avidemux_2.6_branch_mean/autononreg/dialogFactory/unit/hex.js (from rev 6136, branches/avidemux_2.6_branch_mean/autononreg/dialogFactory/hex.js)
===================================================================
--- branches/avidemux_2.6_branch_mean/autononreg/dialogFactory/hex.js	2010-04-25 14:30:40 UTC (rev 6136)
+++ branches/avidemux_2.6_branch_mean/autononreg/dialogFactory/unit/hex.js	2010-04-25 14:30:41 UTC (rev 6137)
@@ -0,0 +1,4 @@
+//AD  &lt;- These first 4 characters need to be the first 4 characters to identify the ECMAScript file to Avidemux
+print(&quot;Testing factory hex&quot;);
+	admTestFacHex();
+print(&quot;Testing factory hex&quot;);

Copied: branches/avidemux_2.6_branch_mean/autononreg/dialogFactory/unit/integer.js (from rev 6136, branches/avidemux_2.6_branch_mean/autononreg/dialogFactory/integer.js)
===================================================================
--- branches/avidemux_2.6_branch_mean/autononreg/dialogFactory/integer.js	2010-04-25 14:30:40 UTC (rev 6136)
+++ branches/avidemux_2.6_branch_mean/autononreg/dialogFactory/unit/integer.js	2010-04-25 14:30:41 UTC (rev 6137)
@@ -0,0 +1,6 @@
+//AD  &lt;- These first 4 characters need to be the first 4 characters to identify the ECMAScript file to Avidemux
+print(&quot;Testing factory int&quot;);
+	admTestFacInt();
+print(&quot;Testing factory int&quot;);
+/* End of test
+*/

Copied: branches/avidemux_2.6_branch_mean/autononreg/dialogFactory/unit/matrix.js (from rev 6136, branches/avidemux_2.6_branch_mean/autononreg/dialogFactory/matrix.js)
===================================================================
--- branches/avidemux_2.6_branch_mean/autononreg/dialogFactory/matrix.js	2010-04-25 14:30:40 UTC (rev 6136)
+++ branches/avidemux_2.6_branch_mean/autononreg/dialogFactory/unit/matrix.js	2010-04-25 14:30:41 UTC (rev 6137)
@@ -0,0 +1,4 @@
+//AD  &lt;- These first 4 characters need to be the first 4 characters to identify the ECMAScript file to Avidemux
+print(&quot;Testing factory Matrix&quot;);
+	admTestFacMatrix();
+print(&quot;Testing factory Matrix&quot;);

Copied: branches/avidemux_2.6_branch_mean/autononreg/dialogFactory/unit/menu.js (from rev 6136, branches/avidemux_2.6_branch_mean/autononreg/dialogFactory/menu.js)
===================================================================
--- branches/avidemux_2.6_branch_mean/autononreg/dialogFactory/menu.js	2010-04-25 14:30:40 UTC (rev 6136)
+++ branches/avidemux_2.6_branch_mean/autononreg/dialogFactory/unit/menu.js	2010-04-25 14:30:41 UTC (rev 6137)
@@ -0,0 +1,6 @@
+//AD  &lt;- These first 4 characters need to be the first 4 characters to identify the ECMAScript file to Avidemux
+print(&quot;Testing factory Menu&quot;);
+	admTestFacMenu();
+print(&quot;Testing factory Menu&quot;);
+/* End of test
+*/

Copied: branches/avidemux_2.6_branch_mean/autononreg/dialogFactory/unit/notch.js (from rev 6136, branches/avidemux_2.6_branch_mean/autononreg/dialogFactory/notch.js)
===================================================================
--- branches/avidemux_2.6_branch_mean/autononreg/dialogFactory/notch.js	2010-04-25 14:30:40 UTC (rev 6136)
+++ branches/avidemux_2.6_branch_mean/autononreg/dialogFactory/unit/notch.js	2010-04-25 14:30:41 UTC (rev 6137)
@@ -0,0 +1,6 @@
+//AD  &lt;- These first 4 characters need to be the first 4 characters to identify the ECMAScript file to Avidemux
+print(&quot;Testing factory Notch&quot;);
+	admTestFacNotch();
+print(&quot;Testing factory Notch&quot;);
+/* End of test
+*/

Copied: branches/avidemux_2.6_branch_mean/autononreg/dialogFactory/unit/readonlytext.js (from rev 6136, branches/avidemux_2.6_branch_mean/autononreg/dialogFactory/readonlytext.js)
===================================================================
--- branches/avidemux_2.6_branch_mean/autononreg/dialogFactory/readonlytext.js	2010-04-25 14:30:40 UTC (rev 6136)
+++ branches/avidemux_2.6_branch_mean/autononreg/dialogFactory/unit/readonlytext.js	2010-04-25 14:30:41 UTC (rev 6137)
@@ -0,0 +1,6 @@
+//AD  &lt;- These first 4 characters need to be the first 4 characters to identify the ECMAScript file to Avidemux
+print(&quot;Testing factory RoTexy&quot;);
+	admTestFacRoText();
+print(&quot;Testing factory RoText&quot;);
+/* End of test
+*/

Copied: branches/avidemux_2.6_branch_mean/autononreg/dialogFactory/unit/run_non_reg.sh (from rev 6136, branches/avidemux_2.6_branch_mean/autononreg/dialogFactory/run_non_reg.sh)
===================================================================
--- branches/avidemux_2.6_branch_mean/autononreg/dialogFactory/run_non_reg.sh	2010-04-25 14:30:40 UTC (rev 6136)
+++ branches/avidemux_2.6_branch_mean/autononreg/dialogFactory/unit/run_non_reg.sh	2010-04-25 14:30:41 UTC (rev 6137)
@@ -0,0 +1,11 @@
+#!/bin/bash
+export PRG=~/workspace/qt4/avidemux3_qt4
+export SRC=.
+echo &quot;Running tests...&quot;
+#*****************
+cd functiontest
+perl ../foreach.pl $SRC/*.js &quot;echo %f &amp;&amp;  $PRG    --run %f --quit &gt; /dev/null&quot;
+cd ..
+#*****************
+echo &quot;## ALL done checking...##&quot;
+		

Copied: branches/avidemux_2.6_branch_mean/autononreg/dialogFactory/unit/slider.js (from rev 6136, branches/avidemux_2.6_branch_mean/autononreg/dialogFactory/slider.js)
===================================================================
--- branches/avidemux_2.6_branch_mean/autononreg/dialogFactory/slider.js	2010-04-25 14:30:40 UTC (rev 6136)
+++ branches/avidemux_2.6_branch_mean/autononreg/dialogFactory/unit/slider.js	2010-04-25 14:30:41 UTC (rev 6137)
@@ -0,0 +1,4 @@
+//AD  &lt;- These first 4 characters need to be the first 4 characters to identify the ECMAScript file to Avidemux
+print(&quot;Testing factory Slider&quot;);
+	admTestFacSlider();
+print(&quot;Testing factory Slider&quot;);

Copied: branches/avidemux_2.6_branch_mean/autononreg/dialogFactory/unit/tabs.js (from rev 6136, branches/avidemux_2.6_branch_mean/autononreg/dialogFactory/tabs.js)
===================================================================
--- branches/avidemux_2.6_branch_mean/autononreg/dialogFactory/tabs.js	2010-04-25 14:30:40 UTC (rev 6136)
+++ branches/avidemux_2.6_branch_mean/autononreg/dialogFactory/unit/tabs.js	2010-04-25 14:30:41 UTC (rev 6137)
@@ -0,0 +1,6 @@
+//AD  &lt;- These first 4 characters need to be the first 4 characters to identify the ECMAScript file to Avidemux
+print(&quot;Testing factory Tabs&quot;);
+	admTestFacTab();
+print(&quot;Testing factory Tabs&quot;);
+/* End of test
+*/

Copied: branches/avidemux_2.6_branch_mean/autononreg/dialogFactory/unit/text.js (from rev 6136, branches/avidemux_2.6_branch_mean/autononreg/dialogFactory/text.js)
===================================================================
--- branches/avidemux_2.6_branch_mean/autononreg/dialogFactory/text.js	2010-04-25 14:30:40 UTC (rev 6136)
+++ branches/avidemux_2.6_branch_mean/autononreg/dialogFactory/unit/text.js	2010-04-25 14:30:41 UTC (rev 6137)
@@ -0,0 +1,6 @@
+//AD  &lt;- These first 4 characters need to be the first 4 characters to identify the ECMAScript file to Avidemux
+print(&quot;Testing factory Text&quot;);
+	admTestFacText();
+print(&quot;Testing factory Text&quot;);
+/* End of test
+*/

Copied: branches/avidemux_2.6_branch_mean/autononreg/dialogFactory/unit/threadcount.js (from rev 6136, branches/avidemux_2.6_branch_mean/autononreg/dialogFactory/threadcount.js)
===================================================================
--- branches/avidemux_2.6_branch_mean/autononreg/dialogFactory/threadcount.js	2010-04-25 14:30:40 UTC (rev 6136)
+++ branches/avidemux_2.6_branch_mean/autononreg/dialogFactory/unit/threadcount.js	2010-04-25 14:30:41 UTC (rev 6137)
@@ -0,0 +1,4 @@
+//AD  &lt;- These first 4 characters need to be the first 4 characters to identify the ECMAScript file to Avidemux
+print(&quot;Testing factory ThreadCount&quot;);
+	admTestFacThreadCount();
+print(&quot;Testing factory ThreadCount&quot;);

Copied: branches/avidemux_2.6_branch_mean/autononreg/dialogFactory/unit/toggle.js (from rev 6136, branches/avidemux_2.6_branch_mean/autononreg/dialogFactory/toggle.js)
===================================================================
--- branches/avidemux_2.6_branch_mean/autononreg/dialogFactory/toggle.js	2010-04-25 14:30:40 UTC (rev 6136)
+++ branches/avidemux_2.6_branch_mean/autononreg/dialogFactory/unit/toggle.js	2010-04-25 14:30:41 UTC (rev 6137)
@@ -0,0 +1,4 @@
+//AD  &lt;- These first 4 characters need to be the first 4 characters to identify the ECMAScript file to Avidemux
+print(&quot;Testing factory Toggle&quot;);
+	admTestFacToggle();
+print(&quot;Testing factory Toggle&quot;);

Modified: branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src/ADM_jsIf.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src/ADM_jsIf.cpp	2010-04-25 14:30:40 UTC (rev 6136)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src/ADM_jsIf.cpp	2010-04-25 14:30:41 UTC (rev 6137)
@@ -60,7 +60,7 @@
 	ADM_info(&quot;Done.\n&quot;);
 	if(pJSScript != NULL)
 	{// begin execute external file
-		printf(&quot;Spidermonkey executing \&quot;%s\&quot;...&quot;,name);
+		printf(&quot;Spidermonkey executing \&quot;%s\&quot;...\n&quot;,name);
 		JSBool ok = JS_ExecuteScript(g_pCx, g_pObject, pJSScript, &amp;rval);
 		JS_DestroyScript(g_pCx,pJSScript);
 		ADM_info(&quot;Done.\n&quot;);

Added: branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src_dialogFactory/ADM_JSDF.h
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src_dialogFactory/ADM_JSDF.h	2010-04-25 14:30:40 UTC (rev 6136)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src_dialogFactory/ADM_JSDF.h	2010-04-25 14:30:41 UTC (rev 6137)
@@ -0,0 +1,31 @@
+/**
+    \file   ADM_JSDF.h
+    \brief  JS / DF binding
+    \author gruntster/Mean 2010
+
+
+*/
+/***************************************************************************
+ *                                                                         *
+ *   This program is free software; you can redistribute it and/or modify  *
+ *   it under the terms of the GNU General Public License as published by  *
+ *   the Free Software Foundation; either version 2 of the License, or     *
+ *   (at your option) any later version.                                   *
+ *                                                                         *
+ ***************************************************************************/
+
+#ifndef _ADM_JSDF_H
+#define _ADM_JSDF_H
+
+/**
+    \class ADM_JSBaseHelper
+*/
+class ADM_JSDFBaseHelper
+{
+public:
+                        ADM_JSDFBaseHelper() {};
+    virtual             ~ADM_JSDFBaseHelper() {};
+    virtual diaElem*    getControl(void)=0;
+};
+
+#endif

Modified: branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src_dialogFactory/ADM_JSDFMenu.h
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src_dialogFactory/ADM_JSDFMenu.h	2010-04-25 14:30:40 UTC (rev 6136)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src_dialogFactory/ADM_JSDFMenu.h	2010-04-25 14:30:41 UTC (rev 6137)
@@ -18,39 +18,44 @@
 #define _ADM_JSDFMenu_H
 
 #include &quot;jsapi.h&quot;
-#include &quot;DIA_factory.h&quot;
-#include &lt;vector&gt;
-
-class ADM_JSDFMenuHelper
+#include &quot;DIA_factory.h&quot;
+#include &quot;ADM_JSDF.h&quot;
+#include &lt;vector&gt;
+/**
+    \class ADM_JSDFMenuHelper
+*/
+class ADM_JSDFMenuHelper : public ADM_JSDFBaseHelper
 {
 private:
-	char* _title;
-	uint32_t _index;
-	diaMenuEntry *_menuEntries;
+	char                *_title;
+	uint32_t            _index;
+	diaMenuEntry        *_menuEntries;
 	std::vector &lt;char*&gt; _items;
 
 public:
-	ADM_JSDFMenuHelper(const char *title);
-	~ADM_JSDFMenuHelper(void);
-	void addItem(const char* item);
-	diaElem* getControl(void);
-	int index(void);
-	void setIndex(int index);
+                     ADM_JSDFMenuHelper(const char *title);
+                     ~ADM_JSDFMenuHelper(void);
+            void     addItem(const char* item);
+	virtual diaElem* getControl(void);
+            int      index(void);
+            void     setIndex(int index);
 };
-
+/**
+    \class ADM_JSDFMenu
+*/
 class ADM_JSDFMenu
 {
 public:
 	ADM_JSDFMenu(void) {}
 
-	static JSBool JSConstructor(JSContext *cx, JSObject *obj, uintN argc, 
+	static JSBool   JSConstructor(JSContext *cx, JSObject *obj, uintN argc, 
 								jsval *argv, jsval *rval);
-	static void JSDestructor(JSContext *cx, JSObject *obj);
+	static void     JSDestructor(JSContext *cx, JSObject *obj);
 	static JSObject *JSInit(JSContext *cx, JSObject *obj, JSObject *proto = NULL);
-	static JSBool JSGetProperty(JSContext *cx, JSObject *obj, jsval id, jsval *vp);
-	static JSBool JSSetProperty(JSContext *cx, JSObject *obj, jsval id, jsval *vp);
+	static JSBool   JSGetProperty(JSContext *cx, JSObject *obj, jsval id, jsval *vp);
+	static JSBool   JSSetProperty(JSContext *cx, JSObject *obj, jsval id, jsval *vp);
 
-	static JSBool addItem(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval);	
+	static JSBool   addItem(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval);	
 
 	static JSPropertySpec properties[];
 	static JSFunctionSpec methods[];

Added: branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src_dialogFactory/ADM_JSDFToggle.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src_dialogFactory/ADM_JSDFToggle.cpp	2010-04-25 14:30:40 UTC (rev 6136)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src_dialogFactory/ADM_JSDFToggle.cpp	2010-04-25 14:30:41 UTC (rev 6137)
@@ -0,0 +1,147 @@
+/**
+    \file   ADM_JSDFToggle.cpp
+    \brief  JS / DF binding
+    \author gruntster/mean 2010
+
+
+
+*/
+/***************************************************************************
+ *                                                                         *
+ *   This program is free software; you can redistribute it and/or modify  *
+ *   it under the terms of the GNU General Public License as published by  *
+ *   the Free Software Foundation; either version 2 of the License, or     *
+ *   (at your option) any later version.                                   *
+ *                                                                         *
+ ***************************************************************************/
+#include &quot;ADM_JSDFToggle.h&quot;
+
+ADM_JSDFToggleHelper::ADM_JSDFToggleHelper(const char *title)
+{
+	_title = ADM_strdup(title);
+	_value = 0;
+}
+
+ADM_JSDFToggleHelper::~ADM_JSDFToggleHelper(void)
+{
+	if (_title)
+		delete _title;
+
+	_title = NULL;
+
+
+}
+
+
+diaElem* ADM_JSDFToggleHelper::getControl(void)
+{
+    return new   diaElemToggle(&amp;_value,_title,NULL);
+}
+
+uint32_t ADM_JSDFToggleHelper::value(void)
+{
+	return _value;
+}
+
+void ADM_JSDFToggleHelper::setValue(uint32_t index)
+{
+	_value = index;
+}
+/*************************************************/
+JSPropertySpec ADM_JSDFToggle::properties[] = 
+{ 
+	{ &quot;value&quot;, valueProperty, JSPROP_ENUMERATE },
+	{ 0 }
+};
+
+JSFunctionSpec ADM_JSDFToggle::methods[] =
+{
+	{ 0 }
+};
+
+JSClass ADM_JSDFToggle::m_dfToggleHelper =
+{
+	&quot;DFToggle&quot;, JSCLASS_HAS_PRIVATE,
+	JS_PropertyStub, JS_PropertyStub,
+	ADM_JSDFToggle::JSGetProperty, ADM_JSDFToggle::JSSetProperty,
+	JS_EnumerateStub, JS_ResolveStub,
+	JS_ConvertStub, ADM_JSDFToggle::JSDestructor
+};
+
+JSObject *ADM_JSDFToggle::JSInit(JSContext *cx, JSObject *obj, JSObject *proto)
+{
+	return JS_InitClass(cx, obj, proto, &amp;m_dfToggleHelper, 
+		ADM_JSDFToggle::JSConstructor, 1,
+		ADM_JSDFToggle::properties, ADM_JSDFToggle::methods,
+		NULL, NULL);
+}
+/**
+    \fn ctor
+*/
+JSBool ADM_JSDFToggle::JSConstructor(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval)
+{
+	if (argc != 1)
+		return JS_FALSE;
+
+	if (!JSVAL_IS_STRING(argv[0]))
+		return JS_FALSE;
+
+	ADM_JSDFToggleHelper *pObject = new ADM_JSDFToggleHelper(JS_GetStringBytes(JSVAL_TO_STRING(argv[0])));
+
+	if (!JS_SetPrivate(cx, obj, pObject))
+		return JS_FALSE;
+
+	*rval = OBJECT_TO_JSVAL(obj);
+
+	return JS_TRUE;
+}
+
+void ADM_JSDFToggle::JSDestructor(JSContext *cx, JSObject *obj)
+{
+	ADM_JSDFToggleHelper *pObject = (ADM_JSDFToggleHelper*)JS_GetInstancePrivate(cx, obj, &amp;m_dfToggleHelper, NULL);
+
+	if (pObject)
+		delete pObject;
+}
+
+JSBool ADM_JSDFToggle::JSGetProperty(JSContext *cx, JSObject *obj, jsval id, jsval *vp)
+{
+	if (JSVAL_IS_INT(id)) 
+	{
+		ADM_JSDFToggleHelper *pObject = (ADM_JSDFToggleHelper*)JS_GetInstancePrivate(cx, obj, &amp;m_dfToggleHelper, NULL);
+
+		switch(JSVAL_TO_INT(id))
+		{
+			case valueProperty:
+			{
+				*vp = INT_TO_JSVAL(pObject-&gt;value());
+				break;
+			}
+		}
+	}
+
+	return JS_TRUE;
+}
+
+JSBool ADM_JSDFToggle::JSSetProperty(JSContext *cx, JSObject *obj, jsval id, jsval *vp)
+{
+	if (JSVAL_IS_INT(id)) 
+	{
+		ADM_JSDFToggleHelper *pObject = (ADM_JSDFToggleHelper*)JS_GetInstancePrivate(cx, obj, &amp;m_dfToggleHelper, NULL);
+
+		switch(JSVAL_TO_INT(id))
+		{
+			case valueProperty:
+			{
+				if (JSVAL_IS_INT(*vp))
+					pObject-&gt;setValue(JSVAL_TO_INT(*vp));
+
+				break;
+			}
+			default:
+				return JS_FALSE;
+		}
+	}
+
+	return JS_TRUE;
+}

Added: branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src_dialogFactory/ADM_JSDFToggle.h
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src_dialogFactory/ADM_JSDFToggle.h	2010-04-25 14:30:40 UTC (rev 6136)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src_dialogFactory/ADM_JSDFToggle.h	2010-04-25 14:30:41 UTC (rev 6137)
@@ -0,0 +1,63 @@
+/**
+    \file   ADM_JSDFToggle.h
+    \brief  JS / DF binding
+    \author gruntster/mean 2010
+
+
+*/
+/***************************************************************************
+ *                                                                         *
+ *   This program is free software; you can redistribute it and/or modify  *
+ *   it under the terms of the GNU General Public License as published by  *
+ *   the Free Software Foundation; either version 2 of the License, or     *
+ *   (at your option) any later version.                                   *
+ *                                                                         *
+ ***************************************************************************/
+
+#ifndef _ADM_JSDFToggle_H
+#define _ADM_JSDFToggle_H
+
+#include &quot;jsapi.h&quot;
+#include &quot;DIA_factory.h&quot;
+#include &quot;ADM_JSDF.h&quot;
+/**
+    \class ADM_JSDFToggleHelper
+*/
+class ADM_JSDFToggleHelper : public ADM_JSDFBaseHelper
+{
+private:
+	char                *_title;
+	uint32_t            _value;
+
+public:
+                     ADM_JSDFToggleHelper(const char *title);
+                     ~ADM_JSDFToggleHelper(void);
+	virtual diaElem* getControl(void);
+            uint32_t value(void);
+            void     setValue(uint32_t value);
+};
+/**
+    \class ADM_JSDFToggle
+*/
+class ADM_JSDFToggle
+{
+public:
+	ADM_JSDFToggle(void) {}
+
+	static JSBool         JSConstructor(JSContext *cx, JSObject *obj, uintN argc, 
+								jsval *argv, jsval *rval);
+	static void           JSDestructor(JSContext *cx, JSObject *obj);
+	static JSObject       *JSInit(JSContext *cx, JSObject *obj, JSObject *proto = NULL);
+	static JSBool         JSGetProperty(JSContext *cx, JSObject *obj, jsval id, jsval *vp);
+	static JSBool         JSSetProperty(JSContext *cx, JSObject *obj, jsval id, jsval *vp);
+	static JSPropertySpec properties[];
+	static JSFunctionSpec methods[];
+	static JSClass        m_dfToggleHelper;
+
+	enum
+	{
+		valueProperty
+	};
+};
+
+#endif

Modified: branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src_dialogFactory/ADM_JSDialogFactory.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src_dialogFactory/ADM_JSDialogFactory.cpp	2010-04-25 14:30:40 UTC (rev 6136)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src_dialogFactory/ADM_JSDialogFactory.cpp	2010-04-25 14:30:41 UTC (rev 6137)
@@ -28,7 +28,7 @@
 	_title = NULL;
 }
 
-void ADM_JSDialogFactoryHelper::addControl(ADM_JSDFMenuHelper* control)
+void ADM_JSDialogFactoryHelper::addControl(ADM_JSDFBaseHelper* control)
 {
 	_controls.push_back(control);
 }
@@ -37,7 +37,7 @@
 {
 	*controlCount = (int)_controls.size();
 
-	std::vector&lt;ADM_JSDFMenuHelper*&gt;::iterator it;
+	std::vector&lt;ADM_JSDFBaseHelper*&gt;::iterator it;
 	int i = 0;
 	diaElem **elems = new diaElem*[*controlCount];
 

Modified: branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src_dialogFactory/ADM_JSDialogFactory.h
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src_dialogFactory/ADM_JSDialogFactory.h	2010-04-25 14:30:40 UTC (rev 6136)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src_dialogFactory/ADM_JSDialogFactory.h	2010-04-25 14:30:41 UTC (rev 6137)
@@ -28,12 +28,12 @@
 {
 private:
 	char* _title;
-	std::vector &lt;ADM_JSDFMenuHelper*&gt; _controls;
+	std::vector &lt;ADM_JSDFBaseHelper*&gt; _controls;
 
 public:
 	ADM_JSDialogFactoryHelper(const char *title);
 	~ADM_JSDialogFactoryHelper(void);
-	void addControl(ADM_JSDFMenuHelper* control);
+	void addControl(ADM_JSDFBaseHelper* control);
 	diaElem** getControls(int *controlCount);
 	const char* title(void);
 };

Modified: branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src_dialogFactory/ADM_JSDialogFactory_if.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src_dialogFactory/ADM_JSDialogFactory_if.cpp	2010-04-25 14:30:40 UTC (rev 6136)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src_dialogFactory/ADM_JSDialogFactory_if.cpp	2010-04-25 14:30:41 UTC (rev 6137)
@@ -21,6 +21,7 @@
 #include &quot;jsapi.h&quot;
 #include &quot;DIA_factory.h&quot;
 #include &quot;ADM_JSDFMenu.h&quot;
+#include &quot;ADM_JSDFToggle.h&quot;
 #include &quot;ADM_JSDialogFactory.h&quot;
 
 /**
@@ -36,9 +37,14 @@
     }
     if(NULL==ADM_JSDFMenu::JSInit(cx,obj))
     {
-        ADM_error(&quot;Cannot register dialogFactory js class\n&quot;);
+        ADM_error(&quot;Cannot register  menu js class\n&quot;);
         return false;
     }
+    if(NULL==ADM_JSDFToggle::JSInit(cx,obj))
+    {
+        ADM_error(&quot;Cannot register toggle js class\n&quot;);
+        return false;
+    }
     ADM_info(&quot;Registered DialogFactory classes\n&quot;);
     return true;
 }
\ No newline at end of file

Modified: branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src_dialogFactory/CMakeLists.txt
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src_dialogFactory/CMakeLists.txt	2010-04-25 14:30:40 UTC (rev 6136)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src_dialogFactory/CMakeLists.txt	2010-04-25 14:30:41 UTC (rev 6137)
@@ -1,7 +1,9 @@
 SET(ADM_scriptDF_SRCS
         ADM_JSDFMenu.cpp
+        ADM_JSDFToggle.cpp
         ADM_JSDialogFactory.cpp
         ADM_JSDialogFactory_if.cpp 
+        
 )
 
 ADD_DEFINITIONS(&quot;-DJS_THREADSAFE -DXP_UNIX&quot;)


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="003340.html">[Avidemux-svn-commit] r6136 -	branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src_dialogFactory
</A></li>
	<LI>Next message: <A HREF="003342.html">[Avidemux-svn-commit] r6138 - in branches/avidemux_2.6_branch_mean:	autononreg/dialogFactory	avidemux/common/ADM_script2/src_dialogFactory
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#3341">[ date ]</a>
              <a href="thread.html#3341">[ thread ]</a>
              <a href="subject.html#3341">[ subject ]</a>
              <a href="author.html#3341">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/avidemux-svn-commit">More information about the Avidemux-svn-commit
mailing list</a><br>
</body></html>
