<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Avidemux-svn-commit] r4516 - in	branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_xvid:	. qt4
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/avidemux-svn-commit/2009-January/index.html" >
   <LINK REL="made" HREF="mailto:avidemux-svn-commit%40lists.berlios.de?Subject=Re%3A%20%5BAvidemux-svn-commit%5D%20r4516%20-%20in%0A%09branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_xvid%3A%0A%09.%20qt4&In-Reply-To=%3C200901032057.n03KvjRJ028533%40sheep.berlios.de%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="001748.html">
   <LINK REL="Next"  HREF="001750.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Avidemux-svn-commit] r4516 - in	branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_xvid:	. qt4</H1>
    <B>gruntster at mail.berlios.de</B> 
    <A HREF="mailto:avidemux-svn-commit%40lists.berlios.de?Subject=Re%3A%20%5BAvidemux-svn-commit%5D%20r4516%20-%20in%0A%09branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_xvid%3A%0A%09.%20qt4&In-Reply-To=%3C200901032057.n03KvjRJ028533%40sheep.berlios.de%3E"
       TITLE="[Avidemux-svn-commit] r4516 - in	branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_xvid:	. qt4">gruntster at mail.berlios.de
       </A><BR>
    <I>Sat Jan  3 21:57:45 CET 2009</I>
    <P><UL>
        <LI>Previous message: <A HREF="001748.html">[Avidemux-svn-commit] r4515 - in	branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_xvid:	. gtk qt4
</A></li>
        <LI>Next message: <A HREF="001750.html">[Avidemux-svn-commit] r4517 -	branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1749">[ date ]</a>
              <a href="thread.html#1749">[ thread ]</a>
              <a href="subject.html#1749">[ subject ]</a>
              <a href="author.html#1749">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Author: gruntster
Date: 2009-01-03 21:57:37 +0100 (Sat, 03 Jan 2009)
New Revision: 4516

Added:
   branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_xvid/XvidParam.xsd
   branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_xvid/presetOptions.cpp
   branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_xvid/presetOptions.h
Modified:
   branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_xvid/CMakeLists.txt
   branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_xvid/encoder.cpp
   branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_xvid/encoder.h
   branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_xvid/options.cpp
   branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_xvid/options.h
   branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/xvidConfigDialog.cpp
   branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/xvidConfigDialog.h
   branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/xvidConfigDialog.ui
Log:
[xvid] beginnings of xml settings and hooking up Qt options window

Modified: branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_xvid/CMakeLists.txt
===================================================================
--- branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_xvid/CMakeLists.txt	2009-01-03 18:38:28 UTC (rev 4515)
+++ branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_xvid/CMakeLists.txt	2009-01-03 20:57:37 UTC (rev 4516)
@@ -4,20 +4,26 @@
 checkXvid()
 
 IF (XVID_FOUND)
-	INCLUDE_DIRECTORIES(${CMAKE_CURRENT_BINARY_DIR} ${XVID_INCLUDE_DIR})
+	checkLibxml2()
 
-	SET(QT_PLUGIN_NAME &quot;ADM_vidEnc_Xvid_Qt&quot;)
-	SET(GTK_PLUGIN_NAME &quot;ADM_vidEnc_Xvid_Gtk&quot;)
-	SET(PLUGIN_SUBDIR &quot;xvid&quot;)
-	SET(ADM_vidEnc_xvid_SRCS interface.c  encoder.cpp  options.cpp  configGuiLoader.cpp)
+	IF (LIBXML2_FOUND)
+		INCLUDE_DIRECTORIES(${CMAKE_CURRENT_BINARY_DIR} ${XVID_INCLUDE_DIR} ${LIBXML2_INCLUDE_DIR})
+		ADD_DEFINITIONS(${LIBXML2_DEFINITIONS})
 
-	CONFIGURE_FILE(&quot;${CMAKE_CURRENT_SOURCE_DIR}/config.h.cmake&quot; &quot;${CMAKE_CURRENT_BINARY_DIR}/config.h&quot;)
+		SET(QT_PLUGIN_NAME &quot;ADM_vidEnc_Xvid_Qt&quot;)
+		SET(GTK_PLUGIN_NAME &quot;ADM_vidEnc_Xvid_Gtk&quot;)
+		SET(PLUGIN_SUBDIR &quot;xvid&quot;)
+		SET(ADM_vidEnc_xvid_SRCS interface.c  encoder.cpp  options.cpp  configGuiLoader.cpp  presetOptions.cpp)
 
-	ADD_SUBDIRECTORY(gtk)
-	ADD_SUBDIRECTORY(qt4)
-	ADD_LIBRARY(ADM_vidEnc_xvid SHARED ${ADM_vidEnc_xvid_SRCS})
-	TARGET_LINK_LIBRARIES(ADM_vidEnc_xvid ADM_core ${XVID_LIBRARY_DIR})
+		CONFIGURE_FILE(&quot;${CMAKE_CURRENT_SOURCE_DIR}/config.h.cmake&quot; &quot;${CMAKE_CURRENT_BINARY_DIR}/config.h&quot;)
 
-	INIT_VIDEO_ENCODER_PLUGIN(ADM_vidEnc_xvid)
-	INSTALL_VIDEO_ENCODER(ADM_vidEnc_xvid)
+		ADD_SUBDIRECTORY(gtk)
+		ADD_SUBDIRECTORY(qt4)
+		ADD_LIBRARY(ADM_vidEnc_xvid SHARED ${ADM_vidEnc_xvid_SRCS})
+		TARGET_LINK_LIBRARIES(ADM_vidEnc_xvid ADM_core ${XVID_LIBRARY_DIR} ${LIBXML2_LIBRARIES})
+
+		INIT_VIDEO_ENCODER_PLUGIN(ADM_vidEnc_xvid)
+		INSTALL_VIDEO_ENCODER(ADM_vidEnc_xvid)
+		INSTALL(FILES XvidParam.xsd DESTINATION &quot;${CMAKE_INSTALL_PREFIX}/lib/ADM_plugins/videoEncoder/${PLUGIN_SUBDIR}&quot;)
+	ENDIF (LIBXML2_FOUND)
 ENDIF (XVID_FOUND)
\ No newline at end of file

Added: branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_xvid/XvidParam.xsd
===================================================================
--- branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_xvid/XvidParam.xsd	2009-01-03 18:38:28 UTC (rev 4515)
+++ branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_xvid/XvidParam.xsd	2009-01-03 20:57:37 UTC (rev 4516)
@@ -0,0 +1,77 @@
+&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;
+&lt;xs:schema xmlns:xs=&quot;<A HREF="http://www.w3.org/2001/XMLSchema">http://www.w3.org/2001/XMLSchema</A>&quot; elementFormDefault=&quot;qualified&quot;&gt;
+  &lt;xs:element name=&quot;XvidConfig&quot;&gt;
+    &lt;xs:complexType&gt;
+      &lt;xs:sequence&gt;
+        &lt;xs:element name=&quot;presetConfiguration&quot; minOccurs=&quot;0&quot;&gt;
+          &lt;xs:complexType&gt;
+            &lt;xs:sequence&gt;
+              &lt;xs:element name=&quot;name&quot; type=&quot;xs:string&quot;/&gt;
+              &lt;xs:element name=&quot;type&quot;&gt;
+                &lt;xs:simpleType&gt;
+                  &lt;xs:restriction base=&quot;xs:string&quot;&gt;
+                    &lt;xs:enumeration value=&quot;default&quot;/&gt;
+                    &lt;xs:enumeration value=&quot;user&quot;/&gt;
+                    &lt;xs:enumeration value=&quot;system&quot;/&gt;
+                  &lt;/xs:restriction&gt;
+                &lt;/xs:simpleType&gt;
+              &lt;/xs:element&gt;
+            &lt;/xs:sequence&gt;
+          &lt;/xs:complexType&gt;
+        &lt;/xs:element&gt;
+        &lt;xs:element name=&quot;encodeOptions&quot; minOccurs=&quot;0&quot;&gt;
+          &lt;xs:complexType&gt;
+            &lt;xs:sequence&gt;
+              &lt;xs:element name=&quot;mode&quot;&gt;
+                &lt;xs:simpleType&gt;
+                  &lt;xs:restriction base=&quot;xs:string&quot;&gt;
+                    &lt;xs:enumeration value=&quot;CBR&quot;/&gt;
+                    &lt;xs:enumeration value=&quot;CQP&quot;/&gt;
+                    &lt;xs:enumeration value=&quot;AQP&quot;/&gt;
+                    &lt;xs:enumeration value=&quot;2PASS SIZE&quot;/&gt;
+                    &lt;xs:enumeration value=&quot;2PASS ABR&quot;/&gt;
+                  &lt;/xs:restriction&gt;
+                &lt;/xs:simpleType&gt;
+              &lt;/xs:element&gt;
+              &lt;xs:element name=&quot;parameter&quot; type=&quot;uint&quot;/&gt;
+            &lt;/xs:sequence&gt;
+          &lt;/xs:complexType&gt;
+        &lt;/xs:element&gt;
+        &lt;xs:element name=&quot;XvidOptions&quot;&gt;
+          &lt;xs:complexType&gt;
+            &lt;xs:sequence&gt;
+              &lt;xs:element name=&quot;threads&quot; type=&quot;uint&quot;/&gt;
+              &lt;xs:element name=&quot;vui&quot;&gt;
+                &lt;xs:complexType&gt;
+                  &lt;xs:sequence&gt;
+                    &lt;xs:element name=&quot;sarAsInput&quot; type=&quot;xs:boolean&quot;/&gt;
+                    &lt;xs:element name=&quot;sarHeight&quot; type=&quot;uint&quot;/&gt;
+                    &lt;xs:element name=&quot;sarWidth&quot; type=&quot;uint&quot;/&gt;
+                  &lt;/xs:sequence&gt;
+                &lt;/xs:complexType&gt;
+              &lt;/xs:element&gt;
+            &lt;/xs:sequence&gt;
+          &lt;/xs:complexType&gt;
+        &lt;/xs:element&gt;
+      &lt;/xs:sequence&gt;
+    &lt;/xs:complexType&gt;
+  &lt;/xs:element&gt;
+
+  &lt;xs:simpleType name=&quot;uint&quot;&gt;
+    &lt;xs:restriction base=&quot;xs:integer&quot;&gt;
+      &lt;xs:minInclusive value=&quot;0&quot;/&gt;
+    &lt;/xs:restriction&gt;
+  &lt;/xs:simpleType&gt;
+  &lt;xs:simpleType name=&quot;uint8&quot;&gt;
+    &lt;xs:restriction base=&quot;xs:integer&quot;&gt;
+      &lt;xs:minInclusive value=&quot;0&quot;/&gt;
+      &lt;xs:maxInclusive value=&quot;255&quot;/&gt;
+    &lt;/xs:restriction&gt;
+  &lt;/xs:simpleType&gt;
+  &lt;xs:simpleType name=&quot;quantiser&quot;&gt;
+    &lt;xs:restriction base=&quot;xs:integer&quot;&gt;
+      &lt;xs:minInclusive value=&quot;1&quot;/&gt;
+      &lt;xs:maxInclusive value=&quot;31&quot;/&gt;
+    &lt;/xs:restriction&gt;
+  &lt;/xs:simpleType&gt;
+&lt;/xs:schema&gt;

Modified: branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_xvid/encoder.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_xvid/encoder.cpp	2009-01-03 18:38:28 UTC (rev 4515)
+++ branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_xvid/encoder.cpp	2009-01-03 20:57:37 UTC (rev 4516)
@@ -42,7 +42,15 @@
 
 xvidEncoder::xvidEncoder(void)
 {
+	_loader = NULL;
+	_opened = false;
 
+	_passCount = 1;
+	_currentPass = 0;
+
+	_encodeOptions.structSize = sizeof(vidEncOptions);
+	_encodeOptions.encodeMode = DEFAULT_ENCODE_MODE;
+	_encodeOptions.encodeModeParameter = DEFAULT_ENCODE_MODE_PARAMETER;
 }
 
 xvidEncoder::~xvidEncoder(void)
@@ -95,12 +103,39 @@
 
 int xvidEncoder::getOptions(vidEncOptions *encodeOptions, char *pluginOptions, int bufferSize)
 {
+	char* xml = _options.toXml();
+	int xmlLength = strlen(xml);
 
+	if (bufferSize &gt;= xmlLength)
+	{
+		memcpy(pluginOptions, xml, xmlLength);
+		memcpy(encodeOptions, &amp;_encodeOptions, sizeof(vidEncOptions));
+	}
+	else if (bufferSize != 0)
+		xmlLength = 0;
+
+	delete [] xml;
+
+	return xmlLength;
 }
 
 int xvidEncoder::setOptions(vidEncOptions *encodeOptions, char *pluginOptions)
 {
+	if (_opened)
+		return ADM_VIDENC_ERR_ALREADY_OPEN;
 
+	bool success = true;
+
+	if (pluginOptions)
+		success = _options.fromXml(pluginOptions);
+
+	if (encodeOptions &amp;&amp; success)
+		memcpy(&amp;_encodeOptions, encodeOptions, sizeof(vidEncOptions));
+
+	if (success)
+		return ADM_VIDENC_ERR_SUCCESS;
+	else
+		return ADM_VIDENC_ERR_FAILED;
 }
 
 int xvidEncoder::getCurrentPass(void)

Modified: branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_xvid/encoder.h
===================================================================
--- branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_xvid/encoder.h	2009-01-03 18:38:28 UTC (rev 4515)
+++ branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_xvid/encoder.h	2009-01-03 20:57:37 UTC (rev 4516)
@@ -35,6 +35,7 @@
 		vidEncOptions _encodeOptions;
 
 		int _currentPass, _passCount;
+		bool _opened;
 
 	public:
 		xvidEncoder(void);

Modified: branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_xvid/options.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_xvid/options.cpp	2009-01-03 18:38:28 UTC (rev 4515)
+++ branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_xvid/options.cpp	2009-01-03 20:57:37 UTC (rev 4516)
@@ -21,11 +21,41 @@
  *                                                                         *
  ***************************************************************************/
 
+#include &lt;stdlib.h&gt;
 #include &lt;string.h&gt;
+#include &lt;libxml/parser.h&gt;
+#include &lt;libxml/xmlschemas.h&gt;
+
+#include &quot;config.h&quot;
+#include &quot;ADM_inttype.h&quot;
+#include &quot;ADM_files.h&quot;
 #include &quot;options.h&quot;
 
 XvidOptions::XvidOptions(void)
 {
+	_configurationName = NULL;
+
+	reset();
+}
+
+XvidOptions::~XvidOptions(void)
+{
+	cleanUp();
+}
+
+void XvidOptions::cleanUp(void)
+{
+	if (_configurationName)
+	{
+		free(_configurationName);
+		_configurationName = NULL;
+	}
+}
+
+void XvidOptions::reset(void)
+{
+	cleanUp();
+
 	memset(&amp;xvid_enc_create, 0, sizeof(xvid_enc_create_t));
 	memset(&amp;xvid_enc_frame, 0, sizeof(xvid_enc_frame_t));
 
@@ -35,13 +65,79 @@
 	setMinQuantiser(2, 2, 2);
 	setMaxQuantiser(31, 31, 31);
 	setPar(1, 1);
+
+	_parAsInput = false;
+
+	setPresetConfiguration(&quot;&lt;default&gt;&quot;, CONFIG_DEFAULT);
 }
 
-XvidOptions::~XvidOptions(void)
+void XvidOptions::getPresetConfiguration(char** configurationName, ConfigType *configurationType)
 {
+	if (_configurationName)
+		*configurationName = strdup(_configurationName);
+	else
+		*configurationName = NULL;
 
+	*configurationType = _configurationType;
 }
 
+void XvidOptions::setPresetConfiguration(const char* configurationName, ConfigType configurationType)
+{
+	clearPresetConfiguration();
+
+	_configurationName = strdup(configurationName);
+	_configurationType = configurationType;
+}
+
+void XvidOptions::clearPresetConfiguration(void)
+{
+	if (_configurationName)
+		free(_configurationName);
+
+	_configurationName = strdup(&quot;&lt;custom&gt;&quot;);
+	_configurationType = CONFIG_CUSTOM;
+}
+
+unsigned int XvidOptions::getThreads(void)
+{
+	return xvid_enc_create.num_threads;
+}
+
+void XvidOptions::setThreads(unsigned int threads)
+{
+	xvid_enc_create.num_threads = threads;
+}
+
+bool XvidOptions::getParAsInput(void)
+{
+	return _parAsInput;
+}
+
+void XvidOptions::setParAsInput(bool parAsInput)
+{
+	_parAsInput = parAsInput;
+}
+
+void XvidOptions::getPar(unsigned int *width, unsigned int *height)
+{
+	*width = xvid_enc_frame.par_width;
+	*height = xvid_enc_frame.par_height;
+}
+
+void XvidOptions::setPar(unsigned int width, unsigned int height)
+{
+	if (width &gt; 0)
+		xvid_enc_frame.par_width = width;
+
+	if (height &gt; 0)
+		xvid_enc_frame.par_height = height;
+
+	  if (xvid_enc_frame.par_width == xvid_enc_frame.par_height)
+		  xvid_enc_frame.par = XVID_PAR_11_VGA;
+	  else
+		  xvid_enc_frame.par = XVID_PAR_EXT;
+}
+
 MotionEstimationMode XvidOptions::getMotionEstimation(void)
 {
 	if (xvid_enc_frame.motion &amp; ME_HIGH == ME_HIGH)
@@ -63,6 +159,11 @@
 		xvid_enc_frame.motion &amp;= ~ME_MEDIUM;
 		xvid_enc_frame.motion &amp;= ~ME_HIGH;
 		xvid_enc_frame.motion |= motionEstimation;
+
+		if (motionEstimation == ME_NONE)
+			xvid_enc_frame.type = XVID_TYPE_IVOP;
+		else
+			xvid_enc_frame.type = XVID_TYPE_AUTO;
 	}
 }
 
@@ -290,26 +391,6 @@
 		xvid_enc_create.max_quant[2] = b;
 }
 
-void XvidOptions::getPar(unsigned int *width, unsigned int *height)
-{
-	*width = xvid_enc_frame.par_width;
-	*height = xvid_enc_frame.par_height;
-}
-
-void XvidOptions::setPar(unsigned int width, unsigned int height)
-{
-	if (width &gt; 0)
-		xvid_enc_frame.par_width = width;
-
-	if (height &gt; 0)
-		xvid_enc_frame.par_height = height;
-
-	  if (xvid_enc_frame.par_width != xvid_enc_frame.par_height)
-		  xvid_enc_frame.par = XVID_PAR_EXT;
-	  else
-		  xvid_enc_frame.par = XVID_PAR_11_VGA;
-}
-
 RateDistortionMode XvidOptions::getRateDistortion(RateDistortionMode rateDistortion)
 {
 	if (xvid_enc_frame.motion &amp; RD_SQUARE == RD_SQUARE)
@@ -364,3 +445,273 @@
 		xvid_enc_create.global &amp;= ~XVID_GLOBAL_CLOSED_GOP;
 }
 
+char* XvidOptions::toXml(void)
+{
+	xmlDocPtr xmlDoc = xmlNewDoc((const xmlChar*)&quot;1.0&quot;);
+	xmlNodePtr xmlNodeRoot, xmlNodeChild;
+	const int bufferSize = 100;
+	xmlChar xmlBuffer[bufferSize + 1];
+	char *xml = NULL;
+
+	while (true)
+	{
+		if (!xmlDoc)
+			break;
+
+		if (!(xmlNodeRoot = xmlNewDocNode(xmlDoc, NULL, (xmlChar*)&quot;XvidConfig&quot;, NULL)))
+			break;
+
+		xmlDocSetRootElement(xmlDoc, xmlNodeRoot);
+
+		if (_configurationType != CONFIG_CUSTOM)
+		{
+			xmlNodeChild = xmlNewChild(xmlNodeRoot, NULL, (xmlChar*)&quot;presetConfiguration&quot;, NULL);
+
+			xmlNewChild(xmlNodeChild, NULL, (xmlChar*)&quot;name&quot;, (xmlChar*)_configurationName);
+
+			if (_configurationType == CONFIG_USER)
+				strcpy((char*)xmlBuffer, &quot;user&quot;);
+			else if (_configurationType == CONFIG_SYSTEM)
+				strcpy((char*)xmlBuffer, &quot;system&quot;);
+			else
+				strcpy((char*)xmlBuffer, &quot;default&quot;);
+
+			xmlNewChild(xmlNodeChild, NULL, (xmlChar*)&quot;type&quot;, xmlBuffer);
+		}
+
+		addXvidOptionsToXml(xmlNodeRoot);
+		xml = dumpXmlDocToMemory(xmlDoc);
+		xmlFreeDoc(xmlDoc);
+
+		break;
+	}
+
+	return xml;
+}
+
+char* XvidOptions::dumpXmlDocToMemory(xmlDocPtr xmlDoc)
+{
+	xmlChar *tempBuffer;
+	int tempBufferSize;
+	char *xml = NULL;
+
+	xmlDocDumpMemory(xmlDoc, &amp;tempBuffer, &amp;tempBufferSize);
+
+	// remove carriage returns (even though libxml was instructed not to format the XML)
+	xmlChar* bufferChar = tempBuffer;
+	int bufferCharIndex = 0;
+
+	while (*bufferChar != '\0')
+	{
+		if (*bufferChar == '\n')
+		{
+			memmove(bufferChar, bufferChar + 1, tempBufferSize - bufferCharIndex);
+			tempBufferSize--;
+		}
+		else if (*bufferChar == '\&quot;')
+			*bufferChar = '\'';
+
+		bufferChar++;
+		bufferCharIndex++;
+	}
+
+	xml = new char[tempBufferSize + 1];
+	memcpy(xml, tempBuffer, tempBufferSize);
+	xml[tempBufferSize] = 0;
+
+	return xml;
+}
+
+void XvidOptions::addXvidOptionsToXml(xmlNodePtr xmlNodeRoot)
+{
+	const int bufferSize = 100;
+	xmlChar xmlBuffer[bufferSize + 1];
+	xmlNodePtr xmlNodeChild, xmlNodeChild2;
+
+	xmlNodeRoot = xmlNewChild(xmlNodeRoot, NULL, (xmlChar*)&quot;XvidOptions&quot;, NULL);
+	xmlNewChild(xmlNodeRoot, NULL, (xmlChar*)&quot;threads&quot;, number2String(xmlBuffer, bufferSize, getThreads()));
+
+	xmlNodeChild = xmlNewChild(xmlNodeRoot, NULL, (xmlChar*)&quot;vui&quot;, NULL);
+	xmlNewChild(xmlNodeChild, NULL, (xmlChar*)&quot;sarAsInput&quot;, boolean2String(xmlBuffer, bufferSize, getParAsInput()));
+
+	unsigned int width, height;
+
+	getPar(&amp;width, &amp;height);
+
+	xmlNewChild(xmlNodeChild, NULL, (xmlChar*)&quot;sarHeight&quot;, number2String(xmlBuffer, bufferSize, height));
+	xmlNewChild(xmlNodeChild, NULL, (xmlChar*)&quot;sarWidth&quot;, number2String(xmlBuffer, bufferSize, width));
+}
+
+bool XvidOptions::validateXml(xmlDocPtr doc)
+{
+	const char *schemaFile = &quot;XvidParam.xsd&quot;;
+	char *pluginDir = ADM_getPluginPath();
+	char schemaPath[strlen(pluginDir) + strlen(PLUGIN_SUBDIR) + 1 + strlen(schemaFile) + 1];
+	bool success = false;
+
+	strcpy(schemaPath, pluginDir);
+	strcat(schemaPath, PLUGIN_SUBDIR);
+	strcat(schemaPath, &quot;/&quot;);
+	strcat(schemaPath, schemaFile);
+	delete [] pluginDir;
+
+	xmlSchemaParserCtxtPtr xmlSchemaParserCtxt = xmlSchemaNewParserCtxt(schemaPath);
+	xmlSchemaPtr xmlSchema = xmlSchemaParse(xmlSchemaParserCtxt);
+
+ 	xmlSchemaFreeParserCtxt(xmlSchemaParserCtxt);
+
+ 	xmlSchemaValidCtxtPtr xmlSchemaValidCtxt = xmlSchemaNewValidCtxt(xmlSchema);
+
+ 	if (xmlSchemaValidCtxt)
+	{
+ 		success = !xmlSchemaValidateDoc(xmlSchemaValidCtxt, doc);
+	 	xmlSchemaFree(xmlSchema);
+		xmlSchemaFreeValidCtxt(xmlSchemaValidCtxt);
+ 	}
+	else
+ 		xmlSchemaFree(xmlSchema);
+
+	return success;
+}
+
+int XvidOptions::fromXml(const char *xml)
+{
+	bool success = false;
+
+	clearPresetConfiguration();
+
+	xmlDocPtr doc = xmlReadMemory(xml, strlen(xml), &quot;Xvid.xml&quot;, NULL, 0);
+
+	if (success = validateXml(doc))
+	{
+		xmlNode *xmlNodeRoot = xmlDocGetRootElement(doc);
+
+		for (xmlNode *xmlChild = xmlNodeRoot-&gt;children; xmlChild; xmlChild = xmlChild-&gt;next)
+		{
+			if (xmlChild-&gt;type == XML_ELEMENT_NODE)
+			{
+				char *content = (char*)xmlNodeGetContent(xmlChild);
+
+				if (strcmp((char*)xmlChild-&gt;name, &quot;presetConfiguration&quot;) == 0)
+					parsePresetConfiguration(xmlChild);
+				else if (strcmp((char*)xmlChild-&gt;name, &quot;XvidOptions&quot;) == 0)
+					parseXvidOptions(xmlChild);
+
+				xmlFree(content);
+			}
+		}
+	}
+
+	xmlFreeDoc(doc);
+
+	return success;
+}
+
+void XvidOptions::parsePresetConfiguration(xmlNode *node)
+{
+	char* name = NULL;
+	ConfigType type = CONFIG_CUSTOM;
+
+	for (xmlNode *xmlChild = node-&gt;children; xmlChild; xmlChild = xmlChild-&gt;next)
+	{
+		if (xmlChild-&gt;type == XML_ELEMENT_NODE)
+		{
+			char *content = (char*)xmlNodeGetContent(xmlChild);
+
+			if (strcmp((char*)xmlChild-&gt;name, &quot;name&quot;) == 0)
+				name = strdup((char*)content);
+			else if (strcmp((char*)xmlChild-&gt;name, &quot;type&quot;) == 0)
+			{
+				if (strcmp(content, &quot;user&quot;) == 0)
+					type = CONFIG_USER;
+				else if (strcmp(content, &quot;system&quot;) == 0)
+					type = CONFIG_SYSTEM;
+				else
+					type = CONFIG_DEFAULT;
+			}
+
+			xmlFree(content);
+		}
+	}
+
+	setPresetConfiguration(name, type);
+	free(name);
+}
+
+void XvidOptions::parseXvidOptions(xmlNode *node)
+{
+	for (xmlNode *xmlChild = node-&gt;children; xmlChild; xmlChild = xmlChild-&gt;next)
+	{
+		if (xmlChild-&gt;type == XML_ELEMENT_NODE)
+		{
+			char *content = (char*)xmlNodeGetContent(xmlChild);
+
+			if (strcmp((char*)xmlChild-&gt;name, &quot;threads&quot;) == 0)
+				setThreads(atoi(content));
+			else if (strcmp((char*)xmlChild-&gt;name, &quot;vui&quot;) == 0)
+				parseVuiOptions(xmlChild);
+
+			xmlFree(content);
+		}
+	}
+}
+
+void XvidOptions::parseVuiOptions(xmlNode *node)
+{
+	unsigned int width = 0, height = 0;
+
+	for (xmlNode *xmlChild = node-&gt;children; xmlChild; xmlChild = xmlChild-&gt;next)
+	{
+		if (xmlChild-&gt;type == XML_ELEMENT_NODE)
+		{
+			char *content = (char*)xmlNodeGetContent(xmlChild);
+
+			if (strcmp((char*)xmlChild-&gt;name, &quot;sarAsInput&quot;) == 0)
+				setParAsInput(string2Boolean(content));
+			else if (strcmp((char*)xmlChild-&gt;name, &quot;sarHeight&quot;) == 0)
+				height = atoi(content);
+			else if (strcmp((char*)xmlChild-&gt;name, &quot;sarWidth&quot;) == 0)
+				width = atoi(content);
+
+			xmlFree(content);
+		}
+	}
+
+	setPar(width, height);
+}
+
+xmlChar* XvidOptions::number2String(xmlChar *buffer, size_t size, int number)
+{
+	snprintf((char*)buffer, size, &quot;%d&quot;, number);
+
+	return buffer;
+}
+
+xmlChar* XvidOptions::number2String(xmlChar *buffer, size_t size, unsigned int number)
+{
+	snprintf((char*)buffer, size, &quot;%d&quot;, number);
+
+	return buffer;
+}
+
+xmlChar* XvidOptions::number2String(xmlChar *buffer, size_t size, float number)
+{
+	snprintf((char*)buffer, size, &quot;%f&quot;, number);
+
+	return buffer;
+}
+
+xmlChar* XvidOptions::boolean2String(xmlChar *buffer, size_t size, bool boolean)
+{
+	if (boolean)
+		strcpy((char*)buffer, &quot;true&quot;);
+	else
+		strcpy((char*)buffer, &quot;false&quot;);
+
+	return buffer;
+}
+
+bool XvidOptions::string2Boolean(char *buffer)
+{
+	return (strcmp(buffer, &quot;true&quot;) == 0);
+}

Modified: branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_xvid/options.h
===================================================================
--- branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_xvid/options.h	2009-01-03 18:38:28 UTC (rev 4515)
+++ branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_xvid/options.h	2009-01-03 20:57:37 UTC (rev 4516)
@@ -17,24 +17,41 @@
 #ifndef options_h
 #define options_h
 
+#include &lt;libxml/tree.h&gt;
 #include &quot;xvid.h&quot;
 
-enum MotionEstimationMode
+extern &quot;C&quot;
 {
+#include &quot;ADM_vidEnc_plugin.h&quot;
+}
+
+#define DEFAULT_ENCODE_MODE ADM_VIDENC_MODE_CQP
+#define DEFAULT_ENCODE_MODE_PARAMETER 4
+
+typedef enum
+{
+	CONFIG_CUSTOM,
+	CONFIG_DEFAULT,
+	CONFIG_USER,
+	CONFIG_SYSTEM
+} ConfigType;
+
+typedef enum
+{
 	ME_NONE = 0,
 	ME_LOW = XVID_ME_HALFPELREFINE16,	
 	ME_MEDIUM = XVID_ME_HALFPELREFINE16 | XVID_ME_ADVANCEDDIAMOND16,	
 	ME_HIGH = XVID_ME_HALFPELREFINE16 | XVID_ME_EXTSEARCH16 | XVID_ME_HALFPELREFINE8 | XVID_ME_USESQUARES16
-};
+} MotionEstimationMode;
 
-enum RateDistortionMode
+typedef enum
 {
 	RD_NONE = 0,
 	RD_DCT_ME = XVID_VOP_MODEDECISION_RD,
 	RD_HPEL_QPEL_16 = RD_DCT_ME | XVID_ME_HALFPELREFINE16_RD | XVID_ME_QUARTERPELREFINE16_RD,
 	RD_HPEL_QPEL_8 = RD_HPEL_QPEL_16 | XVID_ME_HALFPELREFINE8_RD | XVID_ME_QUARTERPELREFINE8_RD | XVID_ME_CHECKPREDICTION_RD,
 	RD_SQUARE = RD_HPEL_QPEL_8 | XVID_ME_EXTSEARCH_RD
-};
+} RateDistortionMode;
 
 class XvidOptions
 {
@@ -42,10 +59,44 @@
 	xvid_enc_create_t xvid_enc_create;
 	xvid_enc_frame_t xvid_enc_frame;
 
+	char* _configurationName;
+	ConfigType _configurationType;
+
+	bool _parAsInput;
+
+	void cleanUp(void);
+	xmlChar* number2String(xmlChar *buffer, size_t size, int number);
+	xmlChar* number2String(xmlChar *buffer, size_t size, unsigned int number);
+	xmlChar* number2String(xmlChar *buffer, size_t size, float number);
+	xmlChar* boolean2String(xmlChar *buffer, size_t size, bool boolean);
+	bool string2Boolean(char *buffer);
+
+	void addXvidOptionsToXml(xmlNodePtr xmlNodeRoot);
+	char* dumpXmlDocToMemory(xmlDocPtr xmlDoc);
+	bool validateXml(xmlDocPtr doc);
+	void parsePresetConfiguration(xmlNode *node);
+	void parseXvidOptions(xmlNode *node);
+	void parseVuiOptions(xmlNode *node);
+
 public:
 	XvidOptions(void);
 	~XvidOptions(void);
 
+	void reset(void);
+
+	void getPresetConfiguration(char** configurationName, ConfigType *configurationType);
+	void setPresetConfiguration(const char* configurationName, ConfigType configurationType);
+	void clearPresetConfiguration(void);
+
+	unsigned int getThreads(void);
+	void setThreads(unsigned int threads);
+
+	bool getParAsInput(void);
+	void setParAsInput(bool parAsInput);
+
+	void getPar(unsigned int *width, unsigned int *height);
+	void setPar(unsigned int width, unsigned int height);
+
 	MotionEstimationMode getMotionEstimation(void);
 	void setMotionEstimation(MotionEstimationMode motionEstimation);
 
@@ -94,9 +145,6 @@
 	void getMaxQuantiser(unsigned int *i, unsigned int *p, unsigned int *b);
 	void setMaxQuantiser(unsigned int i, unsigned int p, unsigned int b);
 
-	void getPar(unsigned int *width, unsigned int *height);
-	void setPar(unsigned int width, unsigned int height);
-
 	RateDistortionMode getRateDistortion(RateDistortionMode rateDistortion);
 	void setRateDistortion(RateDistortionMode rateDistortion);
 
@@ -105,6 +153,9 @@
 
 	bool getClosedGop(void);
 	void setClosedGop(bool closedGop);
+
+	virtual char* toXml(void);
+	virtual int fromXml(const char *xml);
 };
 
 #endif	// options_h

Added: branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_xvid/presetOptions.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_xvid/presetOptions.cpp	2009-01-03 18:38:28 UTC (rev 4515)
+++ branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_xvid/presetOptions.cpp	2009-01-03 20:57:37 UTC (rev 4516)
@@ -0,0 +1,157 @@
+ /***************************************************************************
+                             presetOptions.cpp
+
+	These settings are intended for external configuration files and don't
+	contain a Preset Configuration block but may contain an Encode Options
+	block.
+
+    begin                : Fri May 23 2008
+    copyright            : (C) 2008 by gruntster
+ ***************************************************************************/
+
+/***************************************************************************
+ *                                                                         *
+ *   This program is free software; you can redistribute it and/or modify  *
+ *   it under the terms of the GNU General Public License as published by  *
+ *   the Free Software Foundation; either version 2 of the License, or     *
+ *   (at your option) any later version.                                   *
+ *                                                                         *
+ ***************************************************************************/
+#include &lt;libxml/parser.h&gt;
+#include &quot;ADM_default.h&quot;
+#include &quot;presetOptions.h&quot;
+
+XvidPresetOptions::XvidPresetOptions(void) : XvidOptions()
+{
+	setEncodeOptionsToDefaults();
+}
+
+vidEncOptions* XvidPresetOptions::getEncodeOptions(void)
+{
+	vidEncOptions *encodeOptions = new vidEncOptions;
+
+	memcpy(encodeOptions, &amp;_encodeOptions, sizeof(vidEncOptions));
+
+	return encodeOptions;
+}
+
+void XvidPresetOptions::setEncodeOptions(vidEncOptions* encodeOptions)
+{
+	memcpy(&amp;_encodeOptions, encodeOptions, sizeof(vidEncOptions));
+}
+
+char* XvidPresetOptions::toXml(void)
+{
+	xmlDocPtr xmlDoc = xmlNewDoc((const xmlChar*)&quot;1.0&quot;);
+	xmlNodePtr xmlNodeRoot, xmlNodeChild;
+	const int bufferSize = 100;
+	xmlChar xmlBuffer[bufferSize + 1];
+	char *xml = NULL;
+
+	while (true)
+	{
+		if (!xmlDoc)
+			break;
+
+		if (!(xmlNodeRoot = xmlNewDocNode(xmlDoc, NULL, (xmlChar*)&quot;XvidConfig&quot;, NULL)))
+			break;
+
+		xmlDocSetRootElement(xmlDoc, xmlNodeRoot);
+
+		xmlNodeChild = xmlNewChild(xmlNodeRoot, NULL, (xmlChar*)&quot;encodeOptions&quot;, NULL);
+
+		switch (_encodeOptions.encodeMode)
+		{
+			case ADM_VIDENC_MODE_CBR:
+				strcpy((char*)xmlBuffer, &quot;CBR&quot;);
+				break;
+			case ADM_VIDENC_MODE_CQP:
+				strcpy((char*)xmlBuffer, &quot;CQP&quot;);
+				break;
+			case ADM_VIDENC_MODE_2PASS_SIZE:
+				strcpy((char*)xmlBuffer, &quot;2PASS SIZE&quot;);
+				break;
+			case ADM_VIDENC_MODE_2PASS_ABR:
+				strcpy((char*)xmlBuffer, &quot;2PASS ABR&quot;);
+				break;
+		}
+
+		xmlNewChild(xmlNodeChild, NULL, (xmlChar*)&quot;mode&quot;, xmlBuffer);
+		xmlNewChild(xmlNodeChild, NULL, (xmlChar*)&quot;parameter&quot;, number2String(xmlBuffer, bufferSize, _encodeOptions.encodeModeParameter));
+
+		addXvidOptionsToXml(xmlNodeRoot);
+		xml = dumpXmlDocToMemory(xmlDoc);
+		xmlFreeDoc(xmlDoc);
+
+		break;
+	}
+
+	return xml;
+}
+
+int XvidPresetOptions::fromXml(const char *xml)
+{
+	bool success = false;
+
+	clearPresetConfiguration();
+	setEncodeOptionsToDefaults();
+
+	xmlDocPtr doc = xmlReadMemory(xml, strlen(xml), &quot;Xvid.xml&quot;, NULL, 0);
+
+	if (success = validateXml(doc))
+	{
+		xmlNode *xmlNodeRoot = xmlDocGetRootElement(doc);
+
+		for (xmlNode *xmlChild = xmlNodeRoot-&gt;children; xmlChild; xmlChild = xmlChild-&gt;next)
+		{
+			if (xmlChild-&gt;type == XML_ELEMENT_NODE)
+			{
+				char *content = (char*)xmlNodeGetContent(xmlChild);
+
+				if (strcmp((char*)xmlChild-&gt;name, &quot;encodeOptions&quot;) == 0)
+					parseEncodeOptions(xmlChild, &amp;_encodeOptions);
+				else if (strcmp((char*)xmlChild-&gt;name, &quot;XvidOptions&quot;) == 0)
+					parseXvidOptions(xmlChild);
+
+				xmlFree(content);
+			}
+		}
+	}
+
+	xmlFreeDoc(doc);
+
+	return success;
+}
+
+void XvidPresetOptions::parseEncodeOptions(xmlNode *node, vidEncOptions *encodeOptions)
+{
+	for (xmlNode *xmlChild = node-&gt;children; xmlChild; xmlChild = xmlChild-&gt;next)
+	{
+		if (xmlChild-&gt;type == XML_ELEMENT_NODE)
+		{
+			char *content = (char*)xmlNodeGetContent(xmlChild);
+
+			if (strcmp((char*)xmlChild-&gt;name, &quot;mode&quot;) == 0)
+			{
+				if (strcmp(content, &quot;CBR&quot;) == 0)
+					encodeOptions-&gt;encodeMode = ADM_VIDENC_MODE_CBR;
+				else if (strcmp(content, &quot;CQP&quot;) == 0)
+					encodeOptions-&gt;encodeMode = ADM_VIDENC_MODE_CQP;
+				else if (strcmp(content, &quot;2PASS SIZE&quot;) == 0)
+					encodeOptions-&gt;encodeMode = ADM_VIDENC_MODE_2PASS_SIZE;
+				else if (strcmp(content, &quot;2PASS ABR&quot;) == 0)
+					encodeOptions-&gt;encodeMode = ADM_VIDENC_MODE_2PASS_ABR;
+			}
+			else if (strcmp((char*)xmlChild-&gt;name, &quot;parameter&quot;) == 0)
+				encodeOptions-&gt;encodeModeParameter = atoi(content);
+
+			xmlFree(content);
+		}
+	}
+}
+
+void XvidPresetOptions::setEncodeOptionsToDefaults(void)
+{
+	_encodeOptions.encodeMode = DEFAULT_ENCODE_MODE;
+	_encodeOptions.encodeModeParameter = DEFAULT_ENCODE_MODE_PARAMETER;
+}

Added: branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_xvid/presetOptions.h
===================================================================
--- branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_xvid/presetOptions.h	2009-01-03 18:38:28 UTC (rev 4515)
+++ branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_xvid/presetOptions.h	2009-01-03 20:57:37 UTC (rev 4516)
@@ -0,0 +1,39 @@
+/***************************************************************************
+                              presetOptions.h
+
+    begin                : Fri May 23 2008
+    copyright            : (C) 2008 by gruntster
+ ***************************************************************************/
+
+/***************************************************************************
+ *                                                                         *
+ *   This program is free software; you can redistribute it and/or modify  *
+ *   it under the terms of the GNU General Public License as published by  *
+ *   the Free Software Foundation; either version 2 of the License, or     *
+ *   (at your option) any later version.                                   *
+ *                                                                         *
+ ***************************************************************************/
+
+#ifndef presetOptions_h
+#define presetOptions_h
+
+#include &quot;options.h&quot;
+
+class XvidPresetOptions : public XvidOptions
+{
+private:
+	vidEncOptions _encodeOptions;
+
+	void parseEncodeOptions(xmlNode *node, vidEncOptions *encodeOptions);
+	void setEncodeOptionsToDefaults(void);
+
+public:
+	XvidPresetOptions(void);
+
+	vidEncOptions* getEncodeOptions(void);
+	void setEncodeOptions(vidEncOptions* encodeOptions);
+	char* toXml(void);
+	int fromXml(const char *xml);
+};
+
+#endif	// presetOptions_h

Modified: branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/xvidConfigDialog.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/xvidConfigDialog.cpp	2009-01-03 18:38:28 UTC (rev 4515)
+++ branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/xvidConfigDialog.cpp	2009-01-03 20:57:37 UTC (rev 4516)
@@ -16,21 +16,488 @@
  *   (at your option) any later version.                                   *
  *                                                                         *
 ***************************************************************************/
+#include &lt;QtGui/QFileDialog&gt;
+
+#include &quot;../config.h&quot;
+#include &quot;../presetOptions.h&quot;
 #include &quot;xvidConfigDialog.h&quot;
 
+#include &quot;ADM_files.h&quot;
+#include &quot;DIA_coreToolkit.h&quot;
+
+// Stay away from ADM_assert.h since it hacks memory functions.
+// Duplicating ADM_mkdir declaration here instead.
+extern &quot;C&quot; {
+	extern uint8_t ADM_mkdir(const char *name);
+}
+
 XvidConfigDialog::XvidConfigDialog(vidEncConfigParameters *configParameters, vidEncVideoProperties *properties, vidEncOptions *encodeOptions, XvidOptions *options) :
 	QDialog((QWidget*)configParameters-&gt;parent, Qt::Dialog)
 {
+	disableGenericSlots = false;
+	static const int _predefinedARs[aspectRatioCount][2] = {{16, 15}, {64, 45}, {8, 9}, {32, 27}};
+
+	memcpy(predefinedARs, _predefinedARs, sizeof(predefinedARs));
+
 	ui.setupUi(this);
+
+	connect(ui.configurationComboBox, SIGNAL(currentIndexChanged(int)), this, SLOT(configurationComboBox_currentIndexChanged(int)));
+	connect(ui.saveAsButton, SIGNAL(pressed()), this, SLOT(saveAsButton_pressed()));
+	connect(ui.deleteButton, SIGNAL(pressed()), this, SLOT(deleteButton_pressed()));
+
+	// General tab
+	lastBitrate = 1500;
+	lastVideoSize = 700;
+
+	connect(ui.encodingModeComboBox, SIGNAL(currentIndexChanged(int)), this, SLOT(encodingModeComboBox_currentIndexChanged(int)));
+	connect(ui.quantiserSlider, SIGNAL(valueChanged(int)), this, SLOT(quantiserSlider_valueChanged(int)));
+	connect(ui.quantiserSpinBox, SIGNAL(valueChanged(int)), this, SLOT(quantiserSpinBox_valueChanged(int)));
+	connect(ui.targetRateControlSpinBox, SIGNAL(valueChanged(int)), this, SLOT(targetRateControlSpinBox_valueChanged(int)));
+
+	ui.sarAsInputLabel-&gt;setText(QString(&quot;%1:%2&quot;).arg(properties-&gt;parWidth).arg(properties-&gt;parHeight));
+
+	QWidgetList widgetList = QApplication::allWidgets();
+
+	for (int widgetIndex = 0; widgetIndex &lt; widgetList.size(); widgetIndex++)
+	{
+		QWidget *widget = widgetList.at(widgetIndex);
+
+		if (widget-&gt;parentWidget() != NULL &amp;&amp; widget-&gt;parentWidget()-&gt;parentWidget() != NULL &amp;&amp; 
+			widget-&gt;parentWidget()-&gt;parentWidget()-&gt;parentWidget() != NULL &amp;&amp;
+			widget-&gt;parentWidget()-&gt;parentWidget()-&gt;parentWidget()-&gt;parentWidget() == ui.tabWidget)
+		{
+			if (widget-&gt;inherits(&quot;QComboBox&quot;))
+				connect(widget, SIGNAL(currentIndexChanged(int)), this, SLOT(generic_currentIndexChanged(int)));
+			else if (widget-&gt;inherits(&quot;QSpinBox&quot;))
+				connect(widget, SIGNAL(valueChanged(int)), this, SLOT(generic_valueChanged(int)));
+			else if (widget-&gt;inherits(&quot;QAbstractButton&quot;))
+				connect(widget, SIGNAL(pressed()), this, SLOT(generic_pressed()));
+			else if (widget-&gt;inherits(&quot;QLineEdit&quot;))
+				connect(widget, SIGNAL(textEdited(QString)), this, SLOT(generic_textEdited(QString)));
+		}
+	}
+
+	fillConfigurationComboBox();
+
+	if (!loadPresetSettings(encodeOptions, options))
+		loadSettings(encodeOptions, options);
 }
 
+void XvidConfigDialog::fillConfigurationComboBox(void)
+{
+	bool origDisableGenericSlots = disableGenericSlots;
+	QMap&lt;QString, int&gt; configs;
+	QStringList filter(&quot;*.xml&quot;);
+	QStringList list = QDir(getUserConfigDirectory()).entryList(filter, QDir::Files | QDir::Readable);
+
+	disableGenericSlots = true;
+
+	for (int item = 0; item &lt; list.size(); item++)
+		configs.insert(QFileInfo(list[item]).baseName(), CONFIG_USER);
+
+	list = QDir(getSystemConfigDirectory()).entryList(filter, QDir::Files | QDir::Readable);
+
+	for (int item = 0; item &lt; list.size(); item++)
+		configs.insert(QFileInfo(list[item]).baseName(), CONFIG_SYSTEM);
+
+	ui.configurationComboBox-&gt;clear();
+	ui.configurationComboBox-&gt;addItem(QT_TR_NOOP(&quot;&lt;default&gt;&quot;), CONFIG_DEFAULT);
+	ui.configurationComboBox-&gt;addItem(QT_TR_NOOP(&quot;&lt;custom&gt;&quot;), CONFIG_CUSTOM);
+
+	QMap&lt;QString, int&gt;::const_iterator mapIterator = configs.constBegin();
+
+	while (mapIterator != configs.constEnd())
+	{
+		ui.configurationComboBox-&gt;addItem(mapIterator.key(), mapIterator.value());
+		mapIterator++;
+	}
+
+	disableGenericSlots = origDisableGenericSlots;
+}
+
+bool XvidConfigDialog::selectConfiguration(QString *selectFile, ConfigType configurationType)
+{
+	bool success = false;
+	bool origDisableGenericSlots = disableGenericSlots;
+
+	disableGenericSlots = true;
+
+	if (configurationType == CONFIG_DEFAULT)
+	{
+		ui.configurationComboBox-&gt;setCurrentIndex(0);
+		success = true;
+	}
+	else
+	{
+		for (int index = 0; index &lt; ui.configurationComboBox-&gt;count(); index++)
+		{
+			if (ui.configurationComboBox-&gt;itemText(index) == selectFile &amp;&amp; ui.configurationComboBox-&gt;itemData(index).toInt() == configurationType)
+			{
+				ui.configurationComboBox-&gt;setCurrentIndex(index);
+				success = true;
+				break;
+			}
+		}
+
+		if (!success)
+			ui.configurationComboBox-&gt;setCurrentIndex(1);
+	}
+
+	disableGenericSlots = origDisableGenericSlots;
+
+	return success;
+}
+
+void XvidConfigDialog::configurationComboBox_currentIndexChanged(int index)
+{
+	bool origDisableGenericSlots = disableGenericSlots;
+
+	disableGenericSlots = true;
+
+	if (index == 0)		// default
+	{
+		ui.deleteButton-&gt;setEnabled(false);
+
+		XvidPresetOptions defaultOptions;
+		vidEncOptions *defaultEncodeOptions = defaultOptions.getEncodeOptions();
+
+		loadSettings(defaultEncodeOptions, &amp;defaultOptions);
+
+		delete defaultEncodeOptions;
+	}
+	else if (index == 1)	// custom
+		ui.deleteButton-&gt;setEnabled(false);
+	else
+	{
+		int configType = ui.configurationComboBox-&gt;itemData(index).toInt();
+		QString configFileName;
+
+		ui.deleteButton-&gt;setEnabled(configType == CONFIG_USER);
+
+		if (configType == CONFIG_SYSTEM)
+			configFileName = QFileInfo(getSystemConfigDirectory(), ui.configurationComboBox-&gt;itemText(index) + &quot;.xml&quot;).filePath();
+		else	// CONFIG_USER
+			configFileName = QFileInfo(getUserConfigDirectory(), ui.configurationComboBox-&gt;itemText(index) + &quot;.xml&quot;).filePath();
+
+		QFile configFile(configFileName);
+
+		if (configFile.exists())
+		{
+			configFile.open(QIODevice::ReadOnly | QIODevice::Text);
+
+			QByteArray fileContents = configFile.readAll();
+			XvidPresetOptions options;
+			vidEncOptions *encodeOptions;
+
+			configFile.close();
+			options.fromXml(fileContents.constData());
+			encodeOptions = options.getEncodeOptions();
+
+			loadSettings(encodeOptions, &amp;options);
+
+			delete encodeOptions;
+		}
+		else
+			ui.configurationComboBox-&gt;setCurrentIndex(0);
+	}
+
+	disableGenericSlots = origDisableGenericSlots;
+}
+
+void XvidConfigDialog::saveAsButton_pressed(void)
+{
+	char *configDirectory = ADM_getHomeRelativePath(&quot;xvid&quot;);
+
+	ADM_mkdir(configDirectory);
+
+	QString configFileName = QFileDialog::getSaveFileName(this, QT_TR_NOOP(&quot;Save As&quot;), configDirectory, QT_TR_NOOP(&quot;Xvid Configuration File (*.xml)&quot;));
+
+	if (!configFileName.isNull())
+	{
+		QFile configFile(configFileName);
+		vidEncOptions encodeOptions;
+		XvidPresetOptions presetOptions;
+
+		configFile.open(QIODevice::WriteOnly | QIODevice::Truncate | QIODevice::Text);
+		saveSettings(&amp;encodeOptions, &amp;presetOptions);
+		presetOptions.setEncodeOptions(&amp;encodeOptions);
+
+		char* xml = presetOptions.toXml();
+
+		configFile.write(xml, strlen(xml));
+		configFile.close();
+
+		delete [] xml;
+
+		fillConfigurationComboBox();
+		selectConfiguration(&amp;QFileInfo(configFileName).baseName(), CONFIG_USER);
+	}
+
+	delete [] configDirectory;
+}
+
+void XvidConfigDialog::deleteButton_pressed(void)
+{
+	QString configFileName = QFileInfo(getUserConfigDirectory(), ui.configurationComboBox-&gt;currentText() + &quot;.xml&quot;).filePath();
+	QFile configFile(configFileName);
+
+	if (GUI_Question(QT_TR_NOOP(&quot;Are you sure you wish to delete the selected configuration?&quot;)) &amp;&amp; configFile.exists())
+	{
+		disableGenericSlots = true;
+		configFile.remove();
+		ui.configurationComboBox-&gt;removeItem(ui.configurationComboBox-&gt;currentIndex());
+		disableGenericSlots = false;
+		ui.configurationComboBox-&gt;setCurrentIndex(0);	// default
+	}
+}
+
+// General tab
+void XvidConfigDialog::encodingModeComboBox_currentIndexChanged(int index)
+{
+	bool enable = false;
+
+	switch (index)
+	{
+		case 0:
+			ui.targetRateControlLabel1-&gt;setText(QT_TR_NOOP(&quot;Target Bitrate:&quot;));
+			ui.targetRateControlLabel2-&gt;setText(QT_TR_NOOP(&quot;kbit/s&quot;));
+			ui.targetRateControlSpinBox-&gt;setValue(lastBitrate);
+			break;
+		case 1: // Constant Quality - 1 pass
+			ui.quantiserLabel2-&gt;setText(QT_TR_NOOP(&quot;Quantiser:&quot;));
+			enable = true;
+			break;
+		case 2: // Video Size - 2 pass
+			ui.targetRateControlLabel1-&gt;setText(QT_TR_NOOP(&quot;Target Video Size:&quot;));
+			ui.targetRateControlLabel2-&gt;setText(QT_TR_NOOP(&quot;MB&quot;));
+			ui.targetRateControlSpinBox-&gt;setValue(lastVideoSize);
+			break;
+		case 3: // Average Bitrate - 2 pass
+			ui.targetRateControlLabel1-&gt;setText(QT_TR_NOOP(&quot;Average Bitrate:&quot;));
+			ui.targetRateControlLabel2-&gt;setText(QT_TR_NOOP(&quot;kbit/s&quot;));
+			ui.targetRateControlSpinBox-&gt;setValue(lastBitrate);
+			break;
+	}
+
+	ui.quantiserLabel1-&gt;setEnabled(enable);
+	ui.quantiserLabel2-&gt;setEnabled(enable);
+	ui.quantiserLabel3-&gt;setEnabled(enable);
+	ui.quantiserSlider-&gt;setEnabled(enable);
+	ui.quantiserSpinBox-&gt;setEnabled(enable);
+
+	ui.targetRateControlLabel1-&gt;setEnabled(!enable);
+	ui.targetRateControlLabel2-&gt;setEnabled(!enable);
+	ui.targetRateControlSpinBox-&gt;setEnabled(!enable);
+}
+
+void XvidConfigDialog::quantiserSlider_valueChanged(int value)
+{
+	ui.quantiserSpinBox-&gt;setValue(value);
+}
+
+void XvidConfigDialog::quantiserSpinBox_valueChanged(int value)
+{
+	ui.quantiserSlider-&gt;setValue(value);
+}
+
+void XvidConfigDialog::targetRateControlSpinBox_valueChanged(int value)
+{
+	if (ui.encodingModeComboBox-&gt;currentIndex() == 2)	// Video Size - 2 pass
+		lastVideoSize = value;
+	else
+		lastBitrate = value;
+}
+
+void XvidConfigDialog::generic_currentIndexChanged(int index)
+{
+	if (!disableGenericSlots)
+		ui.configurationComboBox-&gt;setCurrentIndex(1);
+}
+
+void XvidConfigDialog::generic_valueChanged(int value)
+{
+	if (!disableGenericSlots)
+		ui.configurationComboBox-&gt;setCurrentIndex(1);
+}
+
+void XvidConfigDialog::generic_pressed(void)
+{
+	if (!disableGenericSlots)
+		ui.configurationComboBox-&gt;setCurrentIndex(1);
+}
+
+void XvidConfigDialog::generic_textEdited(QString text)
+{
+	if (!disableGenericSlots)
+		ui.configurationComboBox-&gt;setCurrentIndex(1);
+}
+
+bool XvidConfigDialog::loadPresetSettings(vidEncOptions *encodeOptions, XvidOptions *options)
+{
+	bool origDisableGenericSlots = disableGenericSlots;
+	char *configurationName;
+	ConfigType configurationType;
+
+	disableGenericSlots = true;
+	options-&gt;getPresetConfiguration(&amp;configurationName, &amp;configurationType);		
+
+	bool foundConfig = selectConfiguration(&amp;QString(configurationName), configurationType);
+
+	if (!foundConfig)
+		printf(&quot;Configuration %s (type %d) could not be found.  Using snapshot.\n&quot;, configurationName, configurationType);
+
+	if (configurationName)
+		free(configurationName);
+
+	disableGenericSlots = origDisableGenericSlots;
+
+	return (foundConfig &amp;&amp; configurationType != CONFIG_CUSTOM);
+}
+
+void XvidConfigDialog::loadSettings(vidEncOptions *encodeOptions, XvidOptions *options)
+{
+	bool origDisableGenericSlots = disableGenericSlots;
+
+	disableGenericSlots = true;
+
+	// General tab
+	switch (encodeOptions-&gt;encodeMode)
+	{
+		case ADM_VIDENC_MODE_CBR:	// Constant Bitrate (Single Pass)
+			ui.encodingModeComboBox-&gt;setCurrentIndex(0);
+			ui.targetRateControlSpinBox-&gt;setValue(encodeOptions-&gt;encodeModeParameter);
+			break;
+		case ADM_VIDENC_MODE_CQP:	// Constant Quality (Single Pass)
+			ui.encodingModeComboBox-&gt;setCurrentIndex(1);
+			ui.quantiserSpinBox-&gt;setValue(encodeOptions-&gt;encodeModeParameter);
+			break;
+		case ADM_VIDENC_MODE_2PASS_SIZE:	// Video Size (Two Pass)
+			ui.encodingModeComboBox-&gt;setCurrentIndex(2);
+			ui.targetRateControlSpinBox-&gt;setValue(encodeOptions-&gt;encodeModeParameter);
+			break;
+		case ADM_VIDENC_MODE_2PASS_ABR:	// Average Bitrate (Two Pass)
+			ui.encodingModeComboBox-&gt;setCurrentIndex(3);
+			ui.targetRateControlSpinBox-&gt;setValue(encodeOptions-&gt;encodeModeParameter);
+			break;
+	}
+
+	if (options-&gt;getParAsInput())
+		ui.sarAsInputRadioButton-&gt;setChecked(true);
+	else
+	{
+		bool predefined = false;
+		unsigned int width, height;
+
+		options-&gt;getPar(&amp;width, &amp;height);
+
+		for (int ratioIndex = 0; ratioIndex &lt; aspectRatioCount; ratioIndex++)
+		{
+			if (width == predefinedARs[ratioIndex][0] &amp;&amp; height == predefinedARs[ratioIndex][1])
+			{
+				ui.sarPredefinedRadioButton-&gt;setChecked(true);
+				ui.sarPredefinedComboBox-&gt;setCurrentIndex(ratioIndex);
+				predefined = true;
+				break;
+			}
+		}
+
+		if (!predefined)
+		{
+			ui.sarCustomRadioButton-&gt;setChecked(true);
+			ui.sarCustomSpinBox1-&gt;setValue(width);
+			ui.sarCustomSpinBox2-&gt;setValue(height);
+		}
+	}
+
+	switch (options-&gt;getThreads())
+	{
+		case 0:
+			ui.threadAutoDetectRadioButton-&gt;setChecked(true);
+			break;
+		case 1:
+			ui.threadDisableRadioButton-&gt;setChecked(true);
+			break;
+		default:
+			ui.threadCustomRadioButton-&gt;setChecked(true);
+			ui.threadCustomSpinBox-&gt;setValue(options-&gt;getThreads());
+	}
+
+	disableGenericSlots = origDisableGenericSlots;
+}
+
+void XvidConfigDialog::saveSettings(vidEncOptions *encodeOptions, XvidOptions *options)
+{
+	encodeOptions-&gt;structSize = sizeof(vidEncOptions);
+
+	// General tab
+	switch (ui.encodingModeComboBox-&gt;currentIndex())
+	{
+		case 0:	// Constant Bitrate (Single Pass)
+			encodeOptions-&gt;encodeMode = ADM_VIDENC_MODE_CBR;
+			encodeOptions-&gt;encodeModeParameter = ui.targetRateControlSpinBox-&gt;value();
+			break;
+		case 1: // Constant Quality (Single Pass)
+			encodeOptions-&gt;encodeMode = ADM_VIDENC_MODE_CQP;
+			encodeOptions-&gt;encodeModeParameter = ui.quantiserSpinBox-&gt;value();
+			break;
+		case 2: // Video Size (Two Pass)
+			encodeOptions-&gt;encodeMode = ADM_VIDENC_MODE_2PASS_SIZE;
+			encodeOptions-&gt;encodeModeParameter = ui.targetRateControlSpinBox-&gt;value();
+			break;
+		case 3: // Average Bitrate (Two Pass)
+			encodeOptions-&gt;encodeMode = ADM_VIDENC_MODE_2PASS_ABR;
+			encodeOptions-&gt;encodeModeParameter = ui.targetRateControlSpinBox-&gt;value();
+			break;
+	}
+
+	ConfigType configurationType = (ConfigType)ui.configurationComboBox-&gt;itemData(ui.configurationComboBox-&gt;currentIndex()).toInt();
+
+	options-&gt;setPresetConfiguration(ui.configurationComboBox-&gt;currentText().toUtf8().constData(), configurationType);
+	options-&gt;setParAsInput(ui.sarAsInputRadioButton-&gt;isChecked());
+
+	if (ui.sarCustomRadioButton-&gt;isChecked())
+		options-&gt;setPar(ui.sarCustomSpinBox1-&gt;value(), ui.sarCustomSpinBox2-&gt;value());
+	else if (ui.sarPredefinedRadioButton-&gt;isChecked())
+		options-&gt;setPar(predefinedARs[ui.sarPredefinedComboBox-&gt;currentIndex()][0], predefinedARs[ui.sarPredefinedComboBox-&gt;currentIndex()][1]);
+	else
+		// clear variables
+		options-&gt;setPar(1, 1);
+
+	if (ui.threadAutoDetectRadioButton-&gt;isChecked())
+		options-&gt;setThreads(0);
+	else if (ui.threadDisableRadioButton-&gt;isChecked())
+		options-&gt;setThreads(1);
+	else
+		options-&gt;setThreads(ui.threadCustomSpinBox-&gt;value());
+}
+
+QString XvidConfigDialog::getUserConfigDirectory(void)
+{
+	char *userConfigDirectory = ADM_getHomeRelativePath(&quot;xvid&quot;);
+	QString qstring = QString(userConfigDirectory);
+
+	delete [] userConfigDirectory;
+
+	return qstring;
+}
+
+QString XvidConfigDialog::getSystemConfigDirectory(void)
+{
+	char* pluginPath = ADM_getPluginPath();
+	QString qstring = QString(pluginPath).append(&quot;/&quot;).append(PLUGIN_SUBDIR);
+
+	delete [] pluginPath;
+
+	return qstring;
+}
+
 extern &quot;C&quot; int showXvidConfigDialog(vidEncConfigParameters *configParameters, vidEncVideoProperties *properties, vidEncOptions *encodeOptions, XvidOptions *options)
 {
 	XvidConfigDialog dialog(configParameters, properties, encodeOptions, options);
 
 	if (dialog.exec() == QDialog::Accepted)
 	{
-		//dialog.saveSettings(encodeOptions, options);
+		dialog.saveSettings(encodeOptions, options);
 
 		return 1;
 	}

Modified: branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/xvidConfigDialog.h
===================================================================
--- branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/xvidConfigDialog.h	2009-01-03 18:38:28 UTC (rev 4515)
+++ branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/xvidConfigDialog.h	2009-01-03 20:57:37 UTC (rev 4516)
@@ -15,8 +15,38 @@
 
 private:
 	Ui_XvidConfigDialog ui;
+	bool disableGenericSlots;
 
+	static const int aspectRatioCount = 4;
+	int predefinedARs[aspectRatioCount][2];
+
+	int lastBitrate, lastVideoSize;
+
+	void fillConfigurationComboBox(void);
+	bool selectConfiguration(QString *selectFile, ConfigType configurationType);
+	bool loadPresetSettings(vidEncOptions *encodeOptions, XvidOptions *options);
+	void loadSettings(vidEncOptions *encodeOptions, XvidOptions *options);
+	QString getUserConfigDirectory(void);
+	QString getSystemConfigDirectory(void);
+
 public:
 	XvidConfigDialog(vidEncConfigParameters *configParameters, vidEncVideoProperties *properties, vidEncOptions *encodeOptions, XvidOptions *options);
+	void saveSettings(vidEncOptions *encodeOptions, XvidOptions *options);
+
+private slots:
+	void generic_currentIndexChanged(int index);
+	void generic_valueChanged(int value);
+	void generic_pressed(void);
+	void generic_textEdited(QString text);
+
+	void configurationComboBox_currentIndexChanged(int index);
+	void saveAsButton_pressed(void);
+	void deleteButton_pressed(void);
+
+	// General tab
+	void encodingModeComboBox_currentIndexChanged(int index);
+	void quantiserSlider_valueChanged(int value);
+	void quantiserSpinBox_valueChanged(int value);
+	void targetRateControlSpinBox_valueChanged(int value);
 };
 #endif	// XvidConfigDialog_h

Modified: branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/xvidConfigDialog.ui
===================================================================
--- branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/xvidConfigDialog.ui	2009-01-03 18:38:28 UTC (rev 4515)
+++ branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_xvid/qt4/xvidConfigDialog.ui	2009-01-03 20:57:37 UTC (rev 4516)
@@ -360,7 +360,7 @@
                      &lt;bool&gt;false&lt;/bool&gt;
                     &lt;/property&gt;
                     &lt;property name=&quot;text&quot; &gt;
-                     &lt;string&gt;0 (High Quality)&lt;/string&gt;
+                     &lt;string&gt;1 (High Quality)&lt;/string&gt;
                     &lt;/property&gt;
                    &lt;/widget&gt;
                   &lt;/item&gt;
@@ -406,7 +406,7 @@
                      &lt;bool&gt;false&lt;/bool&gt;
                     &lt;/property&gt;
                     &lt;property name=&quot;text&quot; &gt;
-                     &lt;string&gt;51 (Low Quality)&lt;/string&gt;
+                     &lt;string&gt;31 (Low Quality)&lt;/string&gt;
                     &lt;/property&gt;
                    &lt;/widget&gt;
                   &lt;/item&gt;
@@ -424,14 +424,17 @@
                    &lt;/size&gt;
                   &lt;/property&gt;
                   &lt;property name=&quot;maximum&quot; &gt;
-                   &lt;number&gt;51&lt;/number&gt;
+                   &lt;number&gt;31&lt;/number&gt;
                   &lt;/property&gt;
                   &lt;property name=&quot;pageStep&quot; &gt;
                    &lt;number&gt;5&lt;/number&gt;
                   &lt;/property&gt;
                   &lt;property name=&quot;value&quot; &gt;
-                   &lt;number&gt;26&lt;/number&gt;
+                   &lt;number&gt;4&lt;/number&gt;
                   &lt;/property&gt;
+                  &lt;property name=&quot;sliderPosition&quot; &gt;
+                   &lt;number&gt;4&lt;/number&gt;
+                  &lt;/property&gt;
                   &lt;property name=&quot;orientation&quot; &gt;
                    &lt;enum&gt;Qt::Horizontal&lt;/enum&gt;
                   &lt;/property&gt;
@@ -448,10 +451,13 @@
                  &lt;bool&gt;false&lt;/bool&gt;
                 &lt;/property&gt;
                 &lt;property name=&quot;maximum&quot; &gt;
-                 &lt;number&gt;51&lt;/number&gt;
+                 &lt;number&gt;31&lt;/number&gt;
                 &lt;/property&gt;
+                &lt;property name=&quot;minimum&quot; &gt;
+                 &lt;number&gt;1&lt;/number&gt;
+                &lt;/property&gt;
                 &lt;property name=&quot;value&quot; &gt;
-                 &lt;number&gt;26&lt;/number&gt;
+                 &lt;number&gt;4&lt;/number&gt;
                 &lt;/property&gt;
                &lt;/widget&gt;
               &lt;/item&gt;


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="001748.html">[Avidemux-svn-commit] r4515 - in	branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_xvid:	. gtk qt4
</A></li>
	<LI>Next message: <A HREF="001750.html">[Avidemux-svn-commit] r4517 -	branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1749">[ date ]</a>
              <a href="thread.html#1749">[ thread ]</a>
              <a href="subject.html#1749">[ subject ]</a>
              <a href="author.html#1749">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/avidemux-svn-commit">More information about the Avidemux-svn-commit
mailing list</a><br>
</body></html>
