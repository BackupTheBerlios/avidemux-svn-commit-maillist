<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Avidemux-svn-commit] r4539 - in	branches/avidemux_2.5_branch_gruntster/cmake: . patches
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/avidemux-svn-commit/2009-January/index.html" >
   <LINK REL="made" HREF="mailto:avidemux-svn-commit%40lists.berlios.de?Subject=Re%3A%20%5BAvidemux-svn-commit%5D%20r4539%20-%20in%0A%09branches/avidemux_2.5_branch_gruntster/cmake%3A%20.%20patches&In-Reply-To=%3C200901211951.n0LJpJas031882%40sheep.berlios.de%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="001771.html">
   <LINK REL="Next"  HREF="001773.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Avidemux-svn-commit] r4539 - in	branches/avidemux_2.5_branch_gruntster/cmake: . patches</H1>
    <B>gruntster at mail.berlios.de</B> 
    <A HREF="mailto:avidemux-svn-commit%40lists.berlios.de?Subject=Re%3A%20%5BAvidemux-svn-commit%5D%20r4539%20-%20in%0A%09branches/avidemux_2.5_branch_gruntster/cmake%3A%20.%20patches&In-Reply-To=%3C200901211951.n0LJpJas031882%40sheep.berlios.de%3E"
       TITLE="[Avidemux-svn-commit] r4539 - in	branches/avidemux_2.5_branch_gruntster/cmake: . patches">gruntster at mail.berlios.de
       </A><BR>
    <I>Wed Jan 21 20:51:19 CET 2009</I>
    <P><UL>
        <LI>Previous message: <A HREF="001771.html">[Avidemux-svn-commit] r4538 - in	branches/avidemux_2.5_branch_gruntster: . avidemux	avidemux/ADM_audio avidemux/ADM_core/src avidemux/ADM_coreAudio/src	avidemux/ADM_coreAudio/src/ADM_libsamplerate	avidemux/ADM_coreImage/include avidemux/ADM_coreImage/src	avidemux/ADM_infoExtractor avidemux/ADM_inputs/ADM_flv	avidemux/ADM_libraries avidemux/ADM_outputs	avidemux/ADM_outputs/oplug_avi	avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2	avidemux/ADM_videoFilter cmake cmake/patches plugins	plugins/ADM_audioEncoders/lavcodec	plugins/ADM_videoFilters/Equalizer	plugins/ADM_videoFilters/Equalizer/gtk	plugins/ADM_videoFilters/ForcedPP plugins/ADM_videoFilters/McDeint	plugins/ADM_videoFilters/Mosaic	plugins/ADM_videoFilters/MplayerResize	plugins/ADM_videoFilters/lavDeinterlace
</A></li>
        <LI>Next message: <A HREF="001773.html">[Avidemux-svn-commit] r4541 -	branches/avidemux_2.5_branch_gruntster/cmake/patches
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1772">[ date ]</a>
              <a href="thread.html#1772">[ thread ]</a>
              <a href="subject.html#1772">[ subject ]</a>
              <a href="author.html#1772">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Author: gruntster
Date: 2009-01-21 20:51:01 +0100 (Wed, 21 Jan 2009)
New Revision: 4539

Added:
   branches/avidemux_2.5_branch_gruntster/cmake/FindUnix2Dos.cmake
Modified:
   branches/avidemux_2.5_branch_gruntster/cmake/admFFmpegBuild.cmake
   branches/avidemux_2.5_branch_gruntster/cmake/admFFmpegUtil.cmake
   branches/avidemux_2.5_branch_gruntster/cmake/patches/libavcodec_avcodec.h.patch
   branches/avidemux_2.5_branch_gruntster/cmake/patches/libavcodec_ffv1.c.patch
   branches/avidemux_2.5_branch_gruntster/cmake/patches/libavcodec_h263dec.c.patch
   branches/avidemux_2.5_branch_gruntster/cmake/patches/libavcodec_h264.c.patch
   branches/avidemux_2.5_branch_gruntster/cmake/patches/libavcodec_mpeg12.c.patch
   branches/avidemux_2.5_branch_gruntster/cmake/patches/libavcodec_mpeg12enc.c.patch
   branches/avidemux_2.5_branch_gruntster/cmake/patches/libavcodec_mpegvideo.c.patch
   branches/avidemux_2.5_branch_gruntster/cmake/patches/libavcodec_mpegvideo_enc.c.patch
   branches/avidemux_2.5_branch_gruntster/cmake/patches/libavcodec_utils.c.patch
   branches/avidemux_2.5_branch_gruntster/cmake/patches/libavformat_file.c.patch
   branches/avidemux_2.5_branch_gruntster/cmake/patches/libavformat_flvenc.c.patch
   branches/avidemux_2.5_branch_gruntster/cmake/patches/libavformat_movenc.c.patch
   branches/avidemux_2.5_branch_gruntster/cmake/patches/libavutil_avutil.h.patch
   branches/avidemux_2.5_branch_gruntster/cmake/patches/libavutil_internal.h.patch
Log:
[[ffmpeg] fix bootstrapping for Unix

Added: branches/avidemux_2.5_branch_gruntster/cmake/FindUnix2Dos.cmake
===================================================================
--- branches/avidemux_2.5_branch_gruntster/cmake/FindUnix2Dos.cmake	2009-01-19 22:53:34 UTC (rev 4538)
+++ branches/avidemux_2.5_branch_gruntster/cmake/FindUnix2Dos.cmake	2009-01-21 19:51:01 UTC (rev 4539)
@@ -0,0 +1,19 @@
+if (NOT UNIX2DOS_EXECUTABLE)
+	message(STATUS &quot;Checking for unix2dos&quot;)
+	message(STATUS &quot;*********************&quot;)
+
+	find_program(UNIX2DOS_EXECUTABLE unix2dos)
+	set(UNIX2DOS_EXECUTABLE ${UNIX2DOS_EXECUTABLE} CACHE STRING &quot;&quot;)
+
+	if (UNIX2DOS_EXECUTABLE)
+		message(STATUS &quot;Found unix2dos&quot;)
+		
+		if (VERBOSE)
+			message(STATUS &quot;Path: ${UNIX2DOS_EXECUTABLE}&quot;)
+		endif (VERBOSE)
+	else (UNIX2DOS_EXECUTABLE)
+		message(FATAL_ERROR &quot;unix2dos not found&quot;)
+	endif (UNIX2DOS_EXECUTABLE)
+
+	message(&quot;&quot;)
+endif (NOT UNIX2DOS_EXECUTABLE)
\ No newline at end of file

Modified: branches/avidemux_2.5_branch_gruntster/cmake/admFFmpegBuild.cmake
===================================================================
--- branches/avidemux_2.5_branch_gruntster/cmake/admFFmpegBuild.cmake	2009-01-19 22:53:34 UTC (rev 4538)
+++ branches/avidemux_2.5_branch_gruntster/cmake/admFFmpegBuild.cmake	2009-01-21 19:51:01 UTC (rev 4539)
@@ -20,12 +20,17 @@
 	set(ffmpegSvnOutput OUTPUT_VARIABLE FFMPEG_SVN_OUTPUT)
 	set(swscaleSvnOutput OUTPUT_VARIABLE SWSCALE_SVN_OUTPUT)
 	set(ffmpegBuildOutput OUTPUT_VARIABLE FFMPEG_CONFIGURE_OUTPUT)
+	set(unix2dosOutput OUTPUT_VARIABLE UNIX2DOS_OUTPUT)
 endif (NOT VERBOSE)
 
 # Checkout FFmpeg source and patch it
 if (NOT IS_DIRECTORY &quot;${FFMPEG_SOURCE_DIR}/.svn&quot;)
 	find_package(Patch)
 
+	if (WIN32)
+		find_package(Unix2Dos)
+	endif (WIN32)
+
 	message(STATUS &quot;Checking out FFmpeg&quot;)
 	execute_process(COMMAND ${Subversion_SVN_EXECUTABLE} co <A HREF="svn://svn.ffmpeg.org/ffmpeg/trunk">svn://svn.ffmpeg.org/ffmpeg/trunk</A> -r ${FFMPEG_VERSION} --ignore-externals &quot;${FFMPEG_SOURCE_DIR}&quot;
 					${ffmpegSvnOutput})
@@ -34,6 +39,8 @@
 	execute_process(COMMAND ${Subversion_SVN_EXECUTABLE} co <A HREF="svn://svn.ffmpeg.org/mplayer/trunk/libswscale">svn://svn.ffmpeg.org/mplayer/trunk/libswscale</A> -r ${SWSCALE_VERSION} &quot;${FFMPEG_SOURCE_DIR}/libswscale&quot;
 					${swscaleSvnOutput})
 
+	message(&quot;&quot;)
+
 	set(FFMPEG_PERFORM_PATCH 1)
 endif (NOT IS_DIRECTORY &quot;${FFMPEG_SOURCE_DIR}/.svn&quot;)
 
@@ -45,9 +52,13 @@
 	MESSAGE(STATUS &quot;Updating to revision ${FFMPEG_VERSION}&quot;)
 	set(FFMPEG_PERFORM_BUILD 1)
 	set(FFMPEG_PERFORM_PATCH 1)
-	
+
 	find_package(Patch)
 
+	if (WIN32)
+		find_package(Unix2Dos)
+	endif (WIN32)
+
 	execute_process(COMMAND ${Subversion_SVN_EXECUTABLE} up -r ${FFMPEG_VERSION} --ignore-externals &quot;${FFMPEG_SOURCE_DIR}&quot;
 					${ffmpegSvnOutput})	
 endif (NOT ${ffmpeg_WC_REVISION} EQUAL ${FFMPEG_VERSION})
@@ -61,9 +72,13 @@
 	message(STATUS &quot;Updating to revision ${SWSCALE_VERSION}&quot;)
 	set(FFMPEG_PERFORM_BUILD 1)
 	set(FFMPEG_PERFORM_PATCH 1)
-	
+
 	find_package(Patch)
 
+	if (WIN32)
+		find_package(Unix2Dos)
+	endif (WIN32)
+
 	execute_process(COMMAND ${Subversion_SVN_EXECUTABLE} up -r ${SWSCALE_VERSION} &quot;${FFMPEG_SOURCE_DIR}/libswscale&quot;
 					${swscaleSvnOutput})
 endif (NOT ${swscale_WC_REVISION} EQUAL ${SWSCALE_VERSION})
@@ -79,7 +94,16 @@
 	file(GLOB patchFiles &quot;${CMAKE_SOURCE_DIR}/cmake/patches/*.patch&quot;)
 
 	foreach(patchFile ${patchFiles})
-		execute_process(COMMAND ${PATCH_EXECUTABLE} -p0 -i ${patchFile}
+		if (WIN32)
+			file(MAKE_DIRECTORY &quot;${FFMPEG_BINARY_DIR}/patches&quot;)
+			get_filename_component(fileName &quot;${patchFile}&quot; NAME)
+			execute_process(COMMAND ${UNIX2DOS_EXECUTABLE} -n ${patchFile} ${FFMPEG_BINARY_DIR}/patches/${fileName}
+							${unix2dosOutput})
+
+			set(patchFile &quot;${FFMPEG_BINARY_DIR}/patches/${fileName}&quot;)
+		endif (WIN32)
+
+		execute_process(COMMAND ${PATCH_EXECUTABLE} -p0 -i &quot;${patchFile}&quot;
 						WORKING_DIRECTORY &quot;${FFMPEG_SOURCE_DIR}&quot;)
 	endforeach(patchFile)
 

Modified: branches/avidemux_2.5_branch_gruntster/cmake/admFFmpegUtil.cmake
===================================================================
--- branches/avidemux_2.5_branch_gruntster/cmake/admFFmpegUtil.cmake	2009-01-19 22:53:34 UTC (rev 4538)
+++ branches/avidemux_2.5_branch_gruntster/cmake/admFFmpegUtil.cmake	2009-01-21 19:51:01 UTC (rev 4539)
@@ -10,10 +10,18 @@
 	getFfmpegVersionFromHeader(&quot;libavutil&quot; &quot;${sourceDir}/libavutil/avutil.h&quot; LIBAVUTIL_VERSION_MAJOR LIBAVUTIL_VERSION)
 	getFfmpegVersionFromHeader(&quot;libpostproc&quot; &quot;${sourceDir}/libpostproc/postprocess.h&quot; LIBPOSTPROC_VERSION_MAJOR LIBPOSTPROC_VERSION)
 	getFfmpegVersionFromHeader(&quot;libswscale&quot; &quot;${sourceDir}/libswscale/swscale.h&quot; LIBSWSCALE_VERSION_MAJOR LIBSWSCALE_VERSION)
-	
-	set(LIBAVCODEC_LIB avcodec-${LIBAVCODEC_VERSION}${CMAKE_SHARED_LIBRARY_SUFFIX})
-	set(LIBAVFORMAT_LIB avformat-${LIBAVFORMAT_VERSION}${CMAKE_SHARED_LIBRARY_SUFFIX})
-	set(LIBAVUTIL_LIB avutil-${LIBAVUTIL_VERSION}${CMAKE_SHARED_LIBRARY_SUFFIX})
-	set(LIBPOSTPROC_LIB postproc-${LIBPOSTPROC_VERSION}${CMAKE_SHARED_LIBRARY_SUFFIX})
-	set(LIBSWSCALE_LIB swscale-${LIBSWSCALE_VERSION}${CMAKE_SHARED_LIBRARY_SUFFIX})
+
+	if (UNIX)
+		set(LIBAVCODEC_LIB libavcodec${CMAKE_SHARED_LIBRARY_SUFFIX}.${LIBAVCODEC_VERSION})
+		set(LIBAVFORMAT_LIB libavformat${CMAKE_SHARED_LIBRARY_SUFFIX}.${LIBAVFORMAT_VERSION})
+		set(LIBAVUTIL_LIB libavutil${CMAKE_SHARED_LIBRARY_SUFFIX}.${LIBAVUTIL_VERSION})
+		set(LIBPOSTPROC_LIB libpostproc${CMAKE_SHARED_LIBRARY_SUFFIX}.${LIBPOSTPROC_VERSION})
+		set(LIBSWSCALE_LIB libswscale${CMAKE_SHARED_LIBRARY_SUFFIX}.${LIBSWSCALE_VERSION})
+	else (UNIX)	
+		set(LIBAVCODEC_LIB avcodec-${LIBAVCODEC_VERSION}${CMAKE_SHARED_LIBRARY_SUFFIX})
+		set(LIBAVFORMAT_LIB avformat-${LIBAVFORMAT_VERSION}${CMAKE_SHARED_LIBRARY_SUFFIX})
+		set(LIBAVUTIL_LIB avutil-${LIBAVUTIL_VERSION}${CMAKE_SHARED_LIBRARY_SUFFIX})
+		set(LIBPOSTPROC_LIB postproc-${LIBPOSTPROC_VERSION}${CMAKE_SHARED_LIBRARY_SUFFIX})
+		set(LIBSWSCALE_LIB swscale-${LIBSWSCALE_VERSION}${CMAKE_SHARED_LIBRARY_SUFFIX})
+	endif (UNIX)
 ENDMACRO (getFfmpegLibNames)
\ No newline at end of file

Modified: branches/avidemux_2.5_branch_gruntster/cmake/patches/libavcodec_avcodec.h.patch
===================================================================
--- branches/avidemux_2.5_branch_gruntster/cmake/patches/libavcodec_avcodec.h.patch	2009-01-19 22:53:34 UTC (rev 4538)
+++ branches/avidemux_2.5_branch_gruntster/cmake/patches/libavcodec_avcodec.h.patch	2009-01-21 19:51:01 UTC (rev 4539)
@@ -3,76 +3,76 @@
 ***************
 *** 177,182 ****
 --- 177,183 ----
-      CODEC_ID_SUNRAST,
-      CODEC_ID_INDEO4,
-      CODEC_ID_INDEO5,
-+     CODEC_ID_DIRAC,
-  
-      /* various PCM &quot;codecs&quot; */
-      CODEC_ID_PCM_S16LE= 0x10000,
+      CODEC_ID_SUNRAST,
+      CODEC_ID_INDEO4,
+      CODEC_ID_INDEO5,
++     CODEC_ID_DIRAC,
+  
+      /* various PCM &quot;codecs&quot; */
+      CODEC_ID_PCM_S16LE= 0x10000,
 ***************
 *** 449,454 ****
 --- 450,457 ----
-  #define CODEC_FLAG2_CHUNKS        0x00008000 ///&lt; Input bitstream might be truncated at a packet boundaries instead of only at frame boundaries.
-  #define CODEC_FLAG2_NON_LINEAR_QUANT 0x00010000 ///&lt; Use MPEG-2 nonlinear quantizer.
-  #define CODEC_FLAG2_BIT_RESERVOIR 0x00020000 ///&lt; Use a bit reservoir when encoding if possible
-+ //MEANX: NEVER EVER USE CLOSED GOP ?
-+ #define CODEC_FLAG2_32_PULLDOWN   0x80000000 
-  
-  /* Unsupported options :
-   *              Syntax Arithmetic coding (SAC)
+  #define CODEC_FLAG2_CHUNKS        0x00008000 ///&lt; Input bitstream might be truncated at a packet boundaries instead of only at frame boundaries.
+  #define CODEC_FLAG2_NON_LINEAR_QUANT 0x00010000 ///&lt; Use MPEG-2 nonlinear quantizer.
+  #define CODEC_FLAG2_BIT_RESERVOIR 0x00020000 ///&lt; Use a bit reservoir when encoding if possible
++ //MEANX: NEVER EVER USE CLOSED GOP ?
++ #define CODEC_FLAG2_32_PULLDOWN   0x80000000 
+  
+  /* Unsupported options :
+   *              Syntax Arithmetic coding (SAC)
 ***************
 *** 1215,1220 ****
 --- 1218,1224 ----
-       * - decoding: unused
-       */
-      int rc_max_rate;
-+     int rc_max_rate_header; /*&lt; That one is set in the header MEANX */
-  
-      /**
-       * minimum bitrate
+       * - decoding: unused
+       */
+      int rc_max_rate;
++     int rc_max_rate_header; /*&lt; That one is set in the header MEANX */
+  
+      /**
+       * minimum bitrate
 ***************
 *** 1229,1234 ****
 --- 1233,1240 ----
-       * - decoding: unused
-       */
-      int rc_buffer_size;
-+     int rc_buffer_size_header;  /*&lt; That one is set in the header MEANX*/
-+ 
-      float rc_buffer_aggressivity;
-  
-      /**
+       * - decoding: unused
+       */
+      int rc_buffer_size;
++     int rc_buffer_size_header;  /*&lt; That one is set in the header MEANX*/
++ 
+      float rc_buffer_aggressivity;
+  
+      /**
 ***************
 *** 2293,2299 ****
-  
-  #if LIBAVCODEC_VERSION_INT &lt; ((52&lt;&lt;16)+(0&lt;&lt;8)+0)
-  /* YUV420 format is assumed ! */
-! 
-  /**
-   * @deprecated Use the software scaler (swscale) instead.
-   */
+  
+  #if LIBAVCODEC_VERSION_INT &lt; ((52&lt;&lt;16)+(0&lt;&lt;8)+0)
+  /* YUV420 format is assumed ! */
+! 
+  /**
+   * @deprecated Use the software scaler (swscale) instead.
+   */
 --- 2299,2305 ----
-  
-  #if LIBAVCODEC_VERSION_INT &lt; ((52&lt;&lt;16)+(0&lt;&lt;8)+0)
-  /* YUV420 format is assumed ! */
-! #if 0 // MEANX
-  /**
-   * @deprecated Use the software scaler (swscale) instead.
-   */
+  
+  #if LIBAVCODEC_VERSION_INT &lt; ((52&lt;&lt;16)+(0&lt;&lt;8)+0)
+  /* YUV420 format is assumed ! */
+! #if 0 // MEANX
+  /**
+   * @deprecated Use the software scaler (swscale) instead.
+   */
 ***************
 *** 2325,2331 ****
-   * @deprecated Use the software scaler (swscale) instead.
-   */
-  attribute_deprecated void img_resample_close(struct ImgReSampleContext *s);
-! 
-  #endif
-  
-  /**
+   * @deprecated Use the software scaler (swscale) instead.
+   */
+  attribute_deprecated void img_resample_close(struct ImgReSampleContext *s);
+! 
+  #endif
+  
+  /**
 --- 2331,2337 ----
-   * @deprecated Use the software scaler (swscale) instead.
-   */
-  attribute_deprecated void img_resample_close(struct ImgReSampleContext *s);
-! #endif //MEANX
-  #endif
-  
-  /**
+   * @deprecated Use the software scaler (swscale) instead.
+   */
+  attribute_deprecated void img_resample_close(struct ImgReSampleContext *s);
+! #endif //MEANX
+  #endif
+  
+  /**

Modified: branches/avidemux_2.5_branch_gruntster/cmake/patches/libavcodec_ffv1.c.patch
===================================================================
--- branches/avidemux_2.5_branch_gruntster/cmake/patches/libavcodec_ffv1.c.patch	2009-01-19 22:53:34 UTC (rev 4538)
+++ branches/avidemux_2.5_branch_gruntster/cmake/patches/libavcodec_ffv1.c.patch	2009-01-21 19:51:01 UTC (rev 4539)
@@ -3,11 +3,11 @@
 ***************
 *** 959,964 ****
 --- 959,966 ----
-          clear_state(f);
-      }else{
-          p-&gt;key_frame= 0;
-+          p-&gt;pict_type= FF_P_TYPE; // MEANX : looks more like a P to me as user
-+ 
-      }
-      if(!f-&gt;plane[0].state &amp;&amp; !f-&gt;plane[0].vlc_state)
-          return -1;
+          clear_state(f);
+      }else{
+          p-&gt;key_frame= 0;
++          p-&gt;pict_type= FF_P_TYPE; // MEANX : looks more like a P to me as user
++ 
+      }
+      if(!f-&gt;plane[0].state &amp;&amp; !f-&gt;plane[0].vlc_state)
+          return -1;

Modified: branches/avidemux_2.5_branch_gruntster/cmake/patches/libavcodec_h263dec.c.patch
===================================================================
--- branches/avidemux_2.5_branch_gruntster/cmake/patches/libavcodec_h263dec.c.patch	2009-01-19 22:53:34 UTC (rev 4538)
+++ branches/avidemux_2.5_branch_gruntster/cmake/patches/libavcodec_h263dec.c.patch	2009-01-21 19:51:01 UTC (rev 4539)
@@ -3,58 +3,58 @@
 ***************
 *** 118,123 ****
 --- 118,140 ----
-  
-      return 0;
-  }
-+ /* MeanX : Ugly patch to detect vo ppacked stuff ... */
-+ int av_is_voppacked(AVCodecContext *avctx, int *vop_packed, int *gmc, int *qpel)
-+ {
-+     MpegEncContext *s = avctx-&gt;priv_data;
-+     // set sane default
-+     *vop_packed=0;
-+     *gmc=0;
-+     *qpel=0;
-+     if(avctx-&gt;codec-&gt;id!=CODEC_ID_MPEG4) return 0;
-+     	
-+   	*vop_packed=(s-&gt;divx_packed);
-+ 	*qpel=s-&gt;quarter_sample;
-+ 	*gmc=0;	// FIXME
-+ 	return 1;
-+ 
-+   }
-+   /* MeanX */
-  
-  int ff_h263_decode_end(AVCodecContext *avctx)
-  {
+  
+      return 0;
+  }
++ /* MeanX : Ugly patch to detect vo ppacked stuff ... */
++ int av_is_voppacked(AVCodecContext *avctx, int *vop_packed, int *gmc, int *qpel)
++ {
++     MpegEncContext *s = avctx-&gt;priv_data;
++     // set sane default
++     *vop_packed=0;
++     *gmc=0;
++     *qpel=0;
++     if(avctx-&gt;codec-&gt;id!=CODEC_ID_MPEG4) return 0;
++     	
++   	*vop_packed=(s-&gt;divx_packed);
++ 	*qpel=s-&gt;quarter_sample;
++ 	*gmc=0;	// FIXME
++ 	return 1;
++ 
++   }
++   /* MeanX */
+  
+  int ff_h263_decode_end(AVCodecContext *avctx)
+  {
 ***************
 *** 412,417 ****
 --- 429,440 ----
-      } else {
-          ret = h263_decode_picture_header(s);
-      }
-+ 	//MEANX we need to do it here also for quicktime file / ctts atom 
-+         // we need the correct frame type, and qt file may contain 
-+         // vop not coded frame.
-+         pict-&gt;pict_type=s-&gt;current_picture.pict_type= s-&gt;pict_type;
-+         pict-&gt;key_frame=s-&gt;current_picture.key_frame= s-&gt;pict_type == FF_I_TYPE;
-+         //MEANX
-  
-      if(ret==FRAME_SKIPPED) return get_consumed_bytes(s, buf_size);
-  
+      } else {
+          ret = h263_decode_picture_header(s);
+      }
++ 	//MEANX we need to do it here also for quicktime file / ctts atom 
++         // we need the correct frame type, and qt file may contain 
++         // vop not coded frame.
++         pict-&gt;pict_type=s-&gt;current_picture.pict_type= s-&gt;pict_type;
++         pict-&gt;key_frame=s-&gt;current_picture.key_frame= s-&gt;pict_type == FF_I_TYPE;
++         //MEANX
+  
+      if(ret==FRAME_SKIPPED) return get_consumed_bytes(s, buf_size);
+  
 ***************
 *** 690,695 ****
 --- 713,726 ----
-  
-  assert(s-&gt;current_picture.pict_type == s-&gt;current_picture_ptr-&gt;pict_type);
-  assert(s-&gt;current_picture.pict_type == s-&gt;pict_type);
-+ /* MEANX */
-+   if(s-&gt;current_picture_ptr)
-+       s-&gt;current_picture_ptr-&gt;opaque=pict-&gt;opaque;
-+ /* MEANX */
-+ 
-+ 
-+ 
-+ 
-      if (s-&gt;pict_type == FF_B_TYPE || s-&gt;low_delay) {
-          *pict= *(AVFrame*)s-&gt;current_picture_ptr;
-      } else if (s-&gt;last_picture_ptr != NULL) {
+  
+  assert(s-&gt;current_picture.pict_type == s-&gt;current_picture_ptr-&gt;pict_type);
+  assert(s-&gt;current_picture.pict_type == s-&gt;pict_type);
++ /* MEANX */
++   if(s-&gt;current_picture_ptr)
++       s-&gt;current_picture_ptr-&gt;opaque=pict-&gt;opaque;
++ /* MEANX */
++ 
++ 
++ 
++ 
+      if (s-&gt;pict_type == FF_B_TYPE || s-&gt;low_delay) {
+          *pict= *(AVFrame*)s-&gt;current_picture_ptr;
+      } else if (s-&gt;last_picture_ptr != NULL) {

Modified: branches/avidemux_2.5_branch_gruntster/cmake/patches/libavcodec_h264.c.patch
===================================================================
--- branches/avidemux_2.5_branch_gruntster/cmake/patches/libavcodec_h264.c.patch	2009-01-19 22:53:34 UTC (rev 4538)
+++ branches/avidemux_2.5_branch_gruntster/cmake/patches/libavcodec_h264.c.patch	2009-01-21 19:51:01 UTC (rev 4539)
@@ -3,20 +3,20 @@
 ***************
 *** 75,80 ****
 --- 75,91 ----
-  0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 2, 2, 2, 2, 2, 2, 3, 3, 3, 3, 3, 3, 4, 4, 4, 4, 4, 4, 5, 5, 5, 5, 5, 5, 6, 6, 6, 6, 6, 6, 7, 7, 7, 7, 7, 7, 8, 8, 8, 8,
-  };
-  
-+ /* MEANX */
-+ int av_getAVCStreamInfo(AVCodecContext *avctx, uint32_t  *nalSize, uint32_t *isAvc)
-+ {
-+       H264Context *h = avctx-&gt;priv_data;
-+       assert(h);
-+       *nalSize=h-&gt;nal_length_size;
-+       *isAvc=h-&gt;is_avc;
-+ 	return 1;
-+ 
-+   }
-+ /* MeanX */
-  
-  static void fill_caches(H264Context *h, int mb_type, int for_deblock){
-      MpegEncContext * const s = &amp;h-&gt;s;
+  0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 2, 2, 2, 2, 2, 2, 3, 3, 3, 3, 3, 3, 4, 4, 4, 4, 4, 4, 5, 5, 5, 5, 5, 5, 6, 6, 6, 6, 6, 6, 7, 7, 7, 7, 7, 7, 8, 8, 8, 8,
+  };
+  
++ /* MEANX */
++ int av_getAVCStreamInfo(AVCodecContext *avctx, uint32_t  *nalSize, uint32_t *isAvc)
++ {
++       H264Context *h = avctx-&gt;priv_data;
++       assert(h);
++       *nalSize=h-&gt;nal_length_size;
++       *isAvc=h-&gt;is_avc;
++ 	return 1;
++ 
++   }
++ /* MeanX */
+  
+  static void fill_caches(H264Context *h, int mb_type, int for_deblock){
+      MpegEncContext * const s = &amp;h-&gt;s;

Modified: branches/avidemux_2.5_branch_gruntster/cmake/patches/libavcodec_mpeg12.c.patch
===================================================================
--- branches/avidemux_2.5_branch_gruntster/cmake/patches/libavcodec_mpeg12.c.patch	2009-01-19 22:53:34 UTC (rev 4538)
+++ branches/avidemux_2.5_branch_gruntster/cmake/patches/libavcodec_mpeg12.c.patch	2009-01-21 19:51:01 UTC (rev 4539)
@@ -3,14 +3,14 @@
 ***************
 *** 1934,1939 ****
 --- 1934,1944 ----
-          ff_er_frame_end(s);
-  
-          MPV_frame_end(s);
-+ /* MEANX */
-+   if(s-&gt;current_picture_ptr)
-+       s-&gt;current_picture_ptr-&gt;opaque=pict-&gt;opaque;
-+ /* MEANX */
-+ 
-  
-          if (s-&gt;pict_type == FF_B_TYPE || s-&gt;low_delay) {
-              *pict= *(AVFrame*)s-&gt;current_picture_ptr;
+          ff_er_frame_end(s);
+  
+          MPV_frame_end(s);
++ /* MEANX */
++   if(s-&gt;current_picture_ptr)
++       s-&gt;current_picture_ptr-&gt;opaque=pict-&gt;opaque;
++ /* MEANX */
++ 
+  
+          if (s-&gt;pict_type == FF_B_TYPE || s-&gt;low_delay) {
+              *pict= *(AVFrame*)s-&gt;current_picture_ptr;

Modified: branches/avidemux_2.5_branch_gruntster/cmake/patches/libavcodec_mpeg12enc.c.patch
===================================================================
--- branches/avidemux_2.5_branch_gruntster/cmake/patches/libavcodec_mpeg12enc.c.patch	2009-01-19 22:53:34 UTC (rev 4538)
+++ branches/avidemux_2.5_branch_gruntster/cmake/patches/libavcodec_mpeg12enc.c.patch	2009-01-21 19:51:01 UTC (rev 4539)
@@ -3,229 +3,229 @@
 ***************
 *** 127,136 ****
 --- 127,145 ----
-              s-&gt;frame_rate_index= i;
-          }
-      }
-+  /* MEANX 
-+ 
-      if(dmin)
-          return -1;
-      else
-          return 0;
-+   */
-+         if(dmin&gt;4)
-+    {
-+         av_log(0,AV_LOG_ERROR,&quot;We did a roundup ! Expect async!\n&quot;);
-+    }
-+         return 0; //MEANX
-+ 
-  }
-  
-  static int encode_init(AVCodecContext *avctx)
+              s-&gt;frame_rate_index= i;
+          }
+      }
++  /* MEANX 
++ 
+      if(dmin)
+          return -1;
+      else
+          return 0;
++   */
++         if(dmin&gt;4)
++    {
++         av_log(0,AV_LOG_ERROR,&quot;We did a roundup ! Expect async!\n&quot;);
++    }
++         return 0; //MEANX
++ 
+  }
+  
+  static int encode_init(AVCodecContext *avctx)
 ***************
 *** 208,213 ****
 --- 217,223 ----
-  
-              put_bits(&amp;s-&gt;pb, 12, s-&gt;width);
-              put_bits(&amp;s-&gt;pb, 12, s-&gt;height);
-+ #if 0 //MEANX
-  
-              for(i=1; i&lt;15; i++){
-                  float error= aspect_ratio;
+  
+              put_bits(&amp;s-&gt;pb, 12, s-&gt;width);
+              put_bits(&amp;s-&gt;pb, 12, s-&gt;height);
++ #if 0 //MEANX
+  
+              for(i=1; i&lt;15; i++){
+                  float error= aspect_ratio;
 ***************
 *** 223,242 ****
-                      s-&gt;aspect_ratio_info= i;
-                  }
-              }
-  
-!             put_bits(&amp;s-&gt;pb, 4, s-&gt;aspect_ratio_info);
-!             put_bits(&amp;s-&gt;pb, 4, s-&gt;frame_rate_index);
-! 
-!             if(s-&gt;avctx-&gt;rc_max_rate){
-!                 v = (s-&gt;avctx-&gt;rc_max_rate + 399) / 400;
-                  if (v &gt; 0x3ffff &amp;&amp; s-&gt;codec_id == CODEC_ID_MPEG1VIDEO)
-                      v = 0x3ffff;
-              }else{
-                  v= 0x3FFFF;
-              }
-  
-!             if(s-&gt;avctx-&gt;rc_buffer_size)
-!                 vbv_buffer_size = s-&gt;avctx-&gt;rc_buffer_size;
-              else
-                  /* VBV calculation: Scaled so that a VCD has the proper VBV size of 40 kilobytes */
-                  vbv_buffer_size = (( 20 * s-&gt;bit_rate) / (1151929 / 2)) * 8 * 1024;
+                      s-&gt;aspect_ratio_info= i;
+                  }
+              }
+  
+!             put_bits(&amp;s-&gt;pb, 4, s-&gt;aspect_ratio_info);
+!             put_bits(&amp;s-&gt;pb, 4, s-&gt;frame_rate_index);
+! 
+!             if(s-&gt;avctx-&gt;rc_max_rate){
+!                 v = (s-&gt;avctx-&gt;rc_max_rate + 399) / 400;
+                  if (v &gt; 0x3ffff &amp;&amp; s-&gt;codec_id == CODEC_ID_MPEG1VIDEO)
+                      v = 0x3ffff;
+              }else{
+                  v= 0x3FFFF;
+              }
+  
+!             if(s-&gt;avctx-&gt;rc_buffer_size)
+!                 vbv_buffer_size = s-&gt;avctx-&gt;rc_buffer_size;
+              else
+                  /* VBV calculation: Scaled so that a VCD has the proper VBV size of 40 kilobytes */
+                  vbv_buffer_size = (( 20 * s-&gt;bit_rate) / (1151929 / 2)) * 8 * 1024;
 --- 233,276 ----
-                      s-&gt;aspect_ratio_info= i;
-                  }
-              }
-+ #endif // MEANX
-+             //MEANX put_bits(&amp;s-&gt;pb, 4, s-&gt;aspect_ratio_info);
-+             //MEANX put_bits(&amp;s-&gt;pb, 4, s-&gt;frame_rate_index);
-+  // MEANX 4:3
-+   if(s-&gt;avctx-&gt;sample_aspect_ratio.num==16 &amp;&amp; s-&gt;avctx-&gt;sample_aspect_ratio.den==9)
-+             {
-+                 //printf(&quot;FFmpeg : Wide\n&quot;);
-+                 put_bits(&amp;s-&gt;pb,4,3); //16:9
-+             }
-+             else        //4:3
-+             {
-+               if(s-&gt;codec_id == CODEC_ID_MPEG2VIDEO)
-+                 put_bits(&amp;s-&gt;pb, 4, 2);
-+               else
-+                 put_bits(&amp;s-&gt;pb, 4, 12); // MPEG1
-+             }
-+ // /MEANX
-+ 
-+ // //MEANX PULLDOWN            put_bits(&amp;s-&gt;pb, 4, s-&gt;frame_rate_index);
-+ if((s-&gt;flags2 &amp; CODEC_FLAG2_32_PULLDOWN) &amp;&amp; (s-&gt;codec_id == CODEC_ID_MPEG2VIDEO))
-+             {           
-+                 put_bits(&amp;s-&gt;pb, 4,4);
-+             }
-+             else
-+             {                                  
-+                 put_bits(&amp;s-&gt;pb, 4, s-&gt;frame_rate_index);
-+             } //MEANX pulldown
-  
-!             if(s-&gt;avctx-&gt;rc_max_rate_header){ //MEANX we use header
-!                 v = (s-&gt;avctx-&gt;rc_max_rate_header + 399) / 400;
-                  if (v &gt; 0x3ffff &amp;&amp; s-&gt;codec_id == CODEC_ID_MPEG1VIDEO)
-                      v = 0x3ffff;
-              }else{
-                  v= 0x3FFFF;
-              }
-  
-!             if(s-&gt;avctx-&gt;rc_buffer_size_header) // MEANX we use header
-!                 vbv_buffer_size = s-&gt;avctx-&gt;rc_buffer_size_header;
-              else
-                  /* VBV calculation: Scaled so that a VCD has the proper VBV size of 40 kilobytes */
-                  vbv_buffer_size = (( 20 * s-&gt;bit_rate) / (1151929 / 2)) * 8 * 1024;
+                      s-&gt;aspect_ratio_info= i;
+                  }
+              }
++ #endif // MEANX
++             //MEANX put_bits(&amp;s-&gt;pb, 4, s-&gt;aspect_ratio_info);
++             //MEANX put_bits(&amp;s-&gt;pb, 4, s-&gt;frame_rate_index);
++  // MEANX 4:3
++   if(s-&gt;avctx-&gt;sample_aspect_ratio.num==16 &amp;&amp; s-&gt;avctx-&gt;sample_aspect_ratio.den==9)
++             {
++                 //printf(&quot;FFmpeg : Wide\n&quot;);
++                 put_bits(&amp;s-&gt;pb,4,3); //16:9
++             }
++             else        //4:3
++             {
++               if(s-&gt;codec_id == CODEC_ID_MPEG2VIDEO)
++                 put_bits(&amp;s-&gt;pb, 4, 2);
++               else
++                 put_bits(&amp;s-&gt;pb, 4, 12); // MPEG1
++             }
++ // /MEANX
++ 
++ // //MEANX PULLDOWN            put_bits(&amp;s-&gt;pb, 4, s-&gt;frame_rate_index);
++ if((s-&gt;flags2 &amp; CODEC_FLAG2_32_PULLDOWN) &amp;&amp; (s-&gt;codec_id == CODEC_ID_MPEG2VIDEO))
++             {           
++                 put_bits(&amp;s-&gt;pb, 4,4);
++             }
++             else
++             {                                  
++                 put_bits(&amp;s-&gt;pb, 4, s-&gt;frame_rate_index);
++             } //MEANX pulldown
+  
+!             if(s-&gt;avctx-&gt;rc_max_rate_header){ //MEANX we use header
+!                 v = (s-&gt;avctx-&gt;rc_max_rate_header + 399) / 400;
+                  if (v &gt; 0x3ffff &amp;&amp; s-&gt;codec_id == CODEC_ID_MPEG1VIDEO)
+                      v = 0x3ffff;
+              }else{
+                  v= 0x3FFFF;
+              }
+  
+!             if(s-&gt;avctx-&gt;rc_buffer_size_header) // MEANX we use header
+!                 vbv_buffer_size = s-&gt;avctx-&gt;rc_buffer_size_header;
+              else
+                  /* VBV calculation: Scaled so that a VCD has the proper VBV size of 40 kilobytes */
+                  vbv_buffer_size = (( 20 * s-&gt;bit_rate) / (1151929 / 2)) * 8 * 1024;
 ***************
 *** 269,276 ****
-  
-                  put_bits(&amp;s-&gt;pb, 3, s-&gt;avctx-&gt;profile); //profile
-                  put_bits(&amp;s-&gt;pb, 4, s-&gt;avctx-&gt;level); //level
-  
--                 put_bits(&amp;s-&gt;pb, 1, s-&gt;progressive_sequence);
-                  put_bits(&amp;s-&gt;pb, 2, s-&gt;chroma_format);
-                  put_bits(&amp;s-&gt;pb, 2, 0); //horizontal size ext
-                  put_bits(&amp;s-&gt;pb, 2, 0); //vertical size ext
+  
+                  put_bits(&amp;s-&gt;pb, 3, s-&gt;avctx-&gt;profile); //profile
+                  put_bits(&amp;s-&gt;pb, 4, s-&gt;avctx-&gt;level); //level
+  
+-                 put_bits(&amp;s-&gt;pb, 1, s-&gt;progressive_sequence);
+                  put_bits(&amp;s-&gt;pb, 2, s-&gt;chroma_format);
+                  put_bits(&amp;s-&gt;pb, 2, 0); //horizontal size ext
+                  put_bits(&amp;s-&gt;pb, 2, 0); //vertical size ext
 --- 303,319 ----
-  
-                  put_bits(&amp;s-&gt;pb, 3, s-&gt;avctx-&gt;profile); //profile
-                  put_bits(&amp;s-&gt;pb, 4, s-&gt;avctx-&gt;level); //level
-+    // MEANX pulldown put_bits(&amp;s-&gt;pb, 1, s-&gt;progressive_sequence);
-+   // MEANX Pulldown
-+  if(s-&gt;flags2 &amp; CODEC_FLAG2_32_PULLDOWN) //MEANX
-+                         put_bits(&amp;s-&gt;pb, 1, 0);
-+                 else
-+                         put_bits(&amp;s-&gt;pb, 1, s-&gt;progressive_sequence);
-+ 
-+ 
-+ // /MEANX
-+ 
-  
-                  put_bits(&amp;s-&gt;pb, 2, s-&gt;chroma_format);
-                  put_bits(&amp;s-&gt;pb, 2, 0); //horizontal size ext
-                  put_bits(&amp;s-&gt;pb, 2, 0); //vertical size ext
+  
+                  put_bits(&amp;s-&gt;pb, 3, s-&gt;avctx-&gt;profile); //profile
+                  put_bits(&amp;s-&gt;pb, 4, s-&gt;avctx-&gt;level); //level
++    // MEANX pulldown put_bits(&amp;s-&gt;pb, 1, s-&gt;progressive_sequence);
++   // MEANX Pulldown
++  if(s-&gt;flags2 &amp; CODEC_FLAG2_32_PULLDOWN) //MEANX
++                         put_bits(&amp;s-&gt;pb, 1, 0);
++                 else
++                         put_bits(&amp;s-&gt;pb, 1, s-&gt;progressive_sequence);
++ 
++ 
++ // /MEANX
++ 
+  
+                  put_bits(&amp;s-&gt;pb, 2, s-&gt;chroma_format);
+                  put_bits(&amp;s-&gt;pb, 2, 0); //horizontal size ext
+                  put_bits(&amp;s-&gt;pb, 2, 0); //vertical size ext
 ***************
 *** 334,339 ****
 --- 377,384 ----
-  
-  void mpeg1_encode_picture_header(MpegEncContext *s, int picture_number)
-  {
-+ 	int tff,rff; //MEANX
-+ 
-      mpeg1_encode_sequence_header(s);
-  
-      /* mpeg1 picture header */
+  
+  void mpeg1_encode_picture_header(MpegEncContext *s, int picture_number)
+  {
++ 	int tff,rff; //MEANX
++ 
+      mpeg1_encode_sequence_header(s);
+  
+      /* mpeg1 picture header */
 ***************
 *** 370,375 ****
 --- 415,463 ----
-  
-      s-&gt;frame_pred_frame_dct = 1;
-      if(s-&gt;codec_id == CODEC_ID_MPEG2VIDEO){
-+  /* MEANX -- Pulldown */
-+         if(s-&gt;flags2 &amp; CODEC_FLAG2_32_PULLDOWN)
-+         {
-+         
-+                 switch((s-&gt;picture_number - 
-+                           s-&gt;gop_picture_number)&amp;3)
-+                 {
-+                         case 0:
-+                         default:
-+                                 rff=1;
-+                                 tff=1;
-+                                 break;
-+                         case 1:
-+                                 rff=0;
-+                                 tff=0;
-+                                 break;
-+                         case 2:
-+                                 rff=1;
-+                                 tff=0;
-+                                 break;
-+                         case 3:
-+                                 rff=0;
-+                                 tff=1;
-+                                 break;
-+                 }               
-+            }
-+         else
-+         {
-+                 if (s-&gt;progressive_sequence) 
-+                 {
-+                         tff=0; /* no repeat */
-+                 } else 
-+                 {
-+                         tff= s-&gt;current_picture_ptr-&gt;top_field_first;
-+                 }
-+                 rff=s-&gt;repeat_first_field;
-+         
-+         }
-+ 
-+ //               /MEANX pulldown
-+ 
-+ 
-+ 
-          put_header(s, EXT_START_CODE);
-          put_bits(&amp;s-&gt;pb, 4, 8); //pic ext
-          if (s-&gt;pict_type == FF_P_TYPE || s-&gt;pict_type == FF_B_TYPE) {
+  
+      s-&gt;frame_pred_frame_dct = 1;
+      if(s-&gt;codec_id == CODEC_ID_MPEG2VIDEO){
++  /* MEANX -- Pulldown */
++         if(s-&gt;flags2 &amp; CODEC_FLAG2_32_PULLDOWN)
++         {
++         
++                 switch((s-&gt;picture_number - 
++                           s-&gt;gop_picture_number)&amp;3)
++                 {
++                         case 0:
++                         default:
++                                 rff=1;
++                                 tff=1;
++                                 break;
++                         case 1:
++                                 rff=0;
++                                 tff=0;
++                                 break;
++                         case 2:
++                                 rff=1;
++                                 tff=0;
++                                 break;
++                         case 3:
++                                 rff=0;
++                                 tff=1;
++                                 break;
++                 }               
++            }
++         else
++         {
++                 if (s-&gt;progressive_sequence) 
++                 {
++                         tff=0; /* no repeat */
++                 } else 
++                 {
++                         tff= s-&gt;current_picture_ptr-&gt;top_field_first;
++                 }
++                 rff=s-&gt;repeat_first_field;
++         
++         }
++ 
++ //               /MEANX pulldown
++ 
++ 
++ 
+          put_header(s, EXT_START_CODE);
+          put_bits(&amp;s-&gt;pb, 4, 8); //pic ext
+          if (s-&gt;pict_type == FF_P_TYPE || s-&gt;pict_type == FF_B_TYPE) {
 ***************
 *** 388,398 ****
 --- 476,491 ----
-  
-          assert(s-&gt;picture_structure == PICT_FRAME);
-          put_bits(&amp;s-&gt;pb, 2, s-&gt;picture_structure);
-+ #if 0 //MEANX
-+ 
-          if (s-&gt;progressive_sequence) {
-              put_bits(&amp;s-&gt;pb, 1, 0); /* no repeat */
-          } else {
-              put_bits(&amp;s-&gt;pb, 1, s-&gt;current_picture_ptr-&gt;top_field_first);
-          }
-+ #endif
-+          put_bits(&amp;s-&gt;pb, 1, tff);  //MEANX PULLDOWN
-+ 
-          /* XXX: optimize the generation of this flag with entropy
-             measures */
-          s-&gt;frame_pred_frame_dct = s-&gt;progressive_sequence;
+  
+          assert(s-&gt;picture_structure == PICT_FRAME);
+          put_bits(&amp;s-&gt;pb, 2, s-&gt;picture_structure);
++ #if 0 //MEANX
++ 
+          if (s-&gt;progressive_sequence) {
+              put_bits(&amp;s-&gt;pb, 1, 0); /* no repeat */
+          } else {
+              put_bits(&amp;s-&gt;pb, 1, s-&gt;current_picture_ptr-&gt;top_field_first);
+          }
++ #endif
++          put_bits(&amp;s-&gt;pb, 1, tff);  //MEANX PULLDOWN
++ 
+          /* XXX: optimize the generation of this flag with entropy
+             measures */
+          s-&gt;frame_pred_frame_dct = s-&gt;progressive_sequence;
 ***************
 *** 402,408 ****
-          put_bits(&amp;s-&gt;pb, 1, s-&gt;q_scale_type);
-          put_bits(&amp;s-&gt;pb, 1, s-&gt;intra_vlc_format);
-          put_bits(&amp;s-&gt;pb, 1, s-&gt;alternate_scan);
-!         put_bits(&amp;s-&gt;pb, 1, s-&gt;repeat_first_field);
-          s-&gt;progressive_frame = s-&gt;progressive_sequence;
-          put_bits(&amp;s-&gt;pb, 1, s-&gt;chroma_format == CHROMA_420 ? s-&gt;progressive_frame : 0); /* chroma_420_type */
-          put_bits(&amp;s-&gt;pb, 1, s-&gt;progressive_frame);
+          put_bits(&amp;s-&gt;pb, 1, s-&gt;q_scale_type);
+          put_bits(&amp;s-&gt;pb, 1, s-&gt;intra_vlc_format);
+          put_bits(&amp;s-&gt;pb, 1, s-&gt;alternate_scan);
+!         put_bits(&amp;s-&gt;pb, 1, s-&gt;repeat_first_field);
+          s-&gt;progressive_frame = s-&gt;progressive_sequence;
+          put_bits(&amp;s-&gt;pb, 1, s-&gt;chroma_format == CHROMA_420 ? s-&gt;progressive_frame : 0); /* chroma_420_type */
+          put_bits(&amp;s-&gt;pb, 1, s-&gt;progressive_frame);
 --- 495,504 ----
-          put_bits(&amp;s-&gt;pb, 1, s-&gt;q_scale_type);
-          put_bits(&amp;s-&gt;pb, 1, s-&gt;intra_vlc_format);
-          put_bits(&amp;s-&gt;pb, 1, s-&gt;alternate_scan);
-!  // MEANX put_bits(&amp;s-&gt;pb, 1, s-&gt;repeat_first_field);
-! 	put_bits(&amp;s-&gt;pb, 1, rff);
-!       // /MEANX
-! 
-          s-&gt;progressive_frame = s-&gt;progressive_sequence;
-          put_bits(&amp;s-&gt;pb, 1, s-&gt;chroma_format == CHROMA_420 ? s-&gt;progressive_frame : 0); /* chroma_420_type */
-          put_bits(&amp;s-&gt;pb, 1, s-&gt;progressive_frame);
+          put_bits(&amp;s-&gt;pb, 1, s-&gt;q_scale_type);
+          put_bits(&amp;s-&gt;pb, 1, s-&gt;intra_vlc_format);
+          put_bits(&amp;s-&gt;pb, 1, s-&gt;alternate_scan);
+!  // MEANX put_bits(&amp;s-&gt;pb, 1, s-&gt;repeat_first_field);
+! 	put_bits(&amp;s-&gt;pb, 1, rff);
+!       // /MEANX
+! 
+          s-&gt;progressive_frame = s-&gt;progressive_sequence;
+          put_bits(&amp;s-&gt;pb, 1, s-&gt;chroma_format == CHROMA_420 ? s-&gt;progressive_frame : 0); /* chroma_420_type */
+          put_bits(&amp;s-&gt;pb, 1, s-&gt;progressive_frame);

Modified: branches/avidemux_2.5_branch_gruntster/cmake/patches/libavcodec_mpegvideo.c.patch
===================================================================
--- branches/avidemux_2.5_branch_gruntster/cmake/patches/libavcodec_mpegvideo.c.patch	2009-01-19 22:53:34 UTC (rev 4538)
+++ branches/avidemux_2.5_branch_gruntster/cmake/patches/libavcodec_mpegvideo.c.patch	2009-01-21 19:51:01 UTC (rev 4539)
@@ -2,22 +2,22 @@
 --- libavcodec/mpegvideo.c	Tue Jan 13 19:57:29 2009
 ***************
 *** 558,564 ****
-      CHECKED_ALLOCZ(s-&gt;prev_pict_types, PREV_PICT_TYPES_BUFFER_SIZE);
-  
-      s-&gt;parse_context.state= -1;
-!     if((s-&gt;avctx-&gt;debug&amp;(FF_DEBUG_VIS_QP|FF_DEBUG_VIS_MB_TYPE)) || (s-&gt;avctx-&gt;debug_mv)){
-         s-&gt;visualization_buffer[0] = av_malloc((s-&gt;mb_width*16 + 2*EDGE_WIDTH) * s-&gt;mb_height*16 + 2*EDGE_WIDTH);
-         s-&gt;visualization_buffer[1] = av_malloc((s-&gt;mb_width*8 + EDGE_WIDTH) * s-&gt;mb_height*8 + EDGE_WIDTH);
-         s-&gt;visualization_buffer[2] = av_malloc((s-&gt;mb_width*8 + EDGE_WIDTH) * s-&gt;mb_height*8 + EDGE_WIDTH);
+      CHECKED_ALLOCZ(s-&gt;prev_pict_types, PREV_PICT_TYPES_BUFFER_SIZE);
+  
+      s-&gt;parse_context.state= -1;
+!     if((s-&gt;avctx-&gt;debug&amp;(FF_DEBUG_VIS_QP|FF_DEBUG_VIS_MB_TYPE)) || (s-&gt;avctx-&gt;debug_mv)){
+         s-&gt;visualization_buffer[0] = av_malloc((s-&gt;mb_width*16 + 2*EDGE_WIDTH) * s-&gt;mb_height*16 + 2*EDGE_WIDTH);
+         s-&gt;visualization_buffer[1] = av_malloc((s-&gt;mb_width*8 + EDGE_WIDTH) * s-&gt;mb_height*8 + EDGE_WIDTH);
+         s-&gt;visualization_buffer[2] = av_malloc((s-&gt;mb_width*8 + EDGE_WIDTH) * s-&gt;mb_height*8 + EDGE_WIDTH);
 --- 558,568 ----
-      CHECKED_ALLOCZ(s-&gt;prev_pict_types, PREV_PICT_TYPES_BUFFER_SIZE);
-  
-      s-&gt;parse_context.state= -1;
-!  //MEANX: Allocate them always, as they may be free when we decode 1st image
-! 
-!     // MEANXif((s-&gt;avctx-&gt;debug&amp;(FF_DEBUG_VIS_QP|FF_DEBUG_VIS_MB_TYPE)) || (s-&gt;avctx-&gt;debug_mv)){
-! if(1){ // MEANX
-! 
-         s-&gt;visualization_buffer[0] = av_malloc((s-&gt;mb_width*16 + 2*EDGE_WIDTH) * s-&gt;mb_height*16 + 2*EDGE_WIDTH);
-         s-&gt;visualization_buffer[1] = av_malloc((s-&gt;mb_width*8 + EDGE_WIDTH) * s-&gt;mb_height*8 + EDGE_WIDTH);
-         s-&gt;visualization_buffer[2] = av_malloc((s-&gt;mb_width*8 + EDGE_WIDTH) * s-&gt;mb_height*8 + EDGE_WIDTH);
+      CHECKED_ALLOCZ(s-&gt;prev_pict_types, PREV_PICT_TYPES_BUFFER_SIZE);
+  
+      s-&gt;parse_context.state= -1;
+!  //MEANX: Allocate them always, as they may be free when we decode 1st image
+! 
+!     // MEANXif((s-&gt;avctx-&gt;debug&amp;(FF_DEBUG_VIS_QP|FF_DEBUG_VIS_MB_TYPE)) || (s-&gt;avctx-&gt;debug_mv)){
+! if(1){ // MEANX
+! 
+         s-&gt;visualization_buffer[0] = av_malloc((s-&gt;mb_width*16 + 2*EDGE_WIDTH) * s-&gt;mb_height*16 + 2*EDGE_WIDTH);
+         s-&gt;visualization_buffer[1] = av_malloc((s-&gt;mb_width*8 + EDGE_WIDTH) * s-&gt;mb_height*8 + EDGE_WIDTH);
+         s-&gt;visualization_buffer[2] = av_malloc((s-&gt;mb_width*8 + EDGE_WIDTH) * s-&gt;mb_height*8 + EDGE_WIDTH);

Modified: branches/avidemux_2.5_branch_gruntster/cmake/patches/libavcodec_mpegvideo_enc.c.patch
===================================================================
--- branches/avidemux_2.5_branch_gruntster/cmake/patches/libavcodec_mpegvideo_enc.c.patch	2009-01-19 22:53:34 UTC (rev 4538)
+++ branches/avidemux_2.5_branch_gruntster/cmake/patches/libavcodec_mpegvideo_enc.c.patch	2009-01-21 19:51:01 UTC (rev 4539)
@@ -3,45 +3,45 @@
 ***************
 *** 371,382 ****
 --- 371,384 ----
-  
-          av_log(avctx, AV_LOG_INFO, &quot;Warning vbv_delay will be set to 0xFFFF (=VBR) as the specified vbv buffer is too large for the given bitrate!\n&quot;);
-      }
-+ #if 0 //MEANX
-  
-      if((s-&gt;flags &amp; CODEC_FLAG_4MV) &amp;&amp; s-&gt;codec_id != CODEC_ID_MPEG4
-         &amp;&amp; s-&gt;codec_id != CODEC_ID_H263 &amp;&amp; s-&gt;codec_id != CODEC_ID_H263P &amp;&amp; s-&gt;codec_id != CODEC_ID_FLV1){
-          av_log(avctx, AV_LOG_ERROR, &quot;4MV not supported by codec\n&quot;);
-          return -1;
-      }
-+ #endif
-  
-      if(s-&gt;obmc &amp;&amp; s-&gt;avctx-&gt;mb_decision != FF_MB_DECISION_SIMPLE){
-          av_log(avctx, AV_LOG_ERROR, &quot;OBMC is only supported with simple mb decision\n&quot;);
+  
+          av_log(avctx, AV_LOG_INFO, &quot;Warning vbv_delay will be set to 0xFFFF (=VBR) as the specified vbv buffer is too large for the given bitrate!\n&quot;);
+      }
++ #if 0 //MEANX
+  
+      if((s-&gt;flags &amp; CODEC_FLAG_4MV) &amp;&amp; s-&gt;codec_id != CODEC_ID_MPEG4
+         &amp;&amp; s-&gt;codec_id != CODEC_ID_H263 &amp;&amp; s-&gt;codec_id != CODEC_ID_H263P &amp;&amp; s-&gt;codec_id != CODEC_ID_FLV1){
+          av_log(avctx, AV_LOG_ERROR, &quot;4MV not supported by codec\n&quot;);
+          return -1;
+      }
++ #endif
+  
+      if(s-&gt;obmc &amp;&amp; s-&gt;avctx-&gt;mb_decision != FF_MB_DECISION_SIMPLE){
+          av_log(avctx, AV_LOG_ERROR, &quot;OBMC is only supported with simple mb decision\n&quot;);
 ***************
 *** 408,419 ****
-          av_log(avctx, AV_LOG_ERROR, &quot;interlacing not supported by codec\n&quot;);
-          return -1;
-      }
-  
-      if(s-&gt;mpeg_quant &amp;&amp; s-&gt;codec_id != CODEC_ID_MPEG4){ //FIXME mpeg2 uses that too
-          av_log(avctx, AV_LOG_ERROR, &quot;mpeg2 style quantization not supported by codec\n&quot;);
-          return -1;
-      }
-! 
-      if((s-&gt;flags &amp; CODEC_FLAG_CBP_RD) &amp;&amp; !(s-&gt;flags &amp; CODEC_FLAG_TRELLIS_QUANT)){
-          av_log(avctx, AV_LOG_ERROR, &quot;CBP RD needs trellis quant\n&quot;);
-          return -1;
+          av_log(avctx, AV_LOG_ERROR, &quot;interlacing not supported by codec\n&quot;);
+          return -1;
+      }
+  
+      if(s-&gt;mpeg_quant &amp;&amp; s-&gt;codec_id != CODEC_ID_MPEG4){ //FIXME mpeg2 uses that too
+          av_log(avctx, AV_LOG_ERROR, &quot;mpeg2 style quantization not supported by codec\n&quot;);
+          return -1;
+      }
+! 
+      if((s-&gt;flags &amp; CODEC_FLAG_CBP_RD) &amp;&amp; !(s-&gt;flags &amp; CODEC_FLAG_TRELLIS_QUANT)){
+          av_log(avctx, AV_LOG_ERROR, &quot;CBP RD needs trellis quant\n&quot;);
+          return -1;
 --- 410,422 ----
-          av_log(avctx, AV_LOG_ERROR, &quot;interlacing not supported by codec\n&quot;);
-          return -1;
-      }
-+ #if 0 //MEANX
-  
-      if(s-&gt;mpeg_quant &amp;&amp; s-&gt;codec_id != CODEC_ID_MPEG4){ //FIXME mpeg2 uses that too
-          av_log(avctx, AV_LOG_ERROR, &quot;mpeg2 style quantization not supported by codec\n&quot;);
-          return -1;
-      }
-! #endif
-      if((s-&gt;flags &amp; CODEC_FLAG_CBP_RD) &amp;&amp; !(s-&gt;flags &amp; CODEC_FLAG_TRELLIS_QUANT)){
-          av_log(avctx, AV_LOG_ERROR, &quot;CBP RD needs trellis quant\n&quot;);
-          return -1;
+          av_log(avctx, AV_LOG_ERROR, &quot;interlacing not supported by codec\n&quot;);
+          return -1;
+      }
++ #if 0 //MEANX
+  
+      if(s-&gt;mpeg_quant &amp;&amp; s-&gt;codec_id != CODEC_ID_MPEG4){ //FIXME mpeg2 uses that too
+          av_log(avctx, AV_LOG_ERROR, &quot;mpeg2 style quantization not supported by codec\n&quot;);
+          return -1;
+      }
+! #endif
+      if((s-&gt;flags &amp; CODEC_FLAG_CBP_RD) &amp;&amp; !(s-&gt;flags &amp; CODEC_FLAG_TRELLIS_QUANT)){
+          av_log(avctx, AV_LOG_ERROR, &quot;CBP RD needs trellis quant\n&quot;);
+          return -1;

Modified: branches/avidemux_2.5_branch_gruntster/cmake/patches/libavcodec_utils.c.patch
===================================================================
--- branches/avidemux_2.5_branch_gruntster/cmake/patches/libavcodec_utils.c.patch	2009-01-19 22:53:34 UTC (rev 4538)
+++ branches/avidemux_2.5_branch_gruntster/cmake/patches/libavcodec_utils.c.patch	2009-01-21 19:51:01 UTC (rev 4539)
@@ -3,32 +3,32 @@
 ***************
 *** 959,968 ****
 --- 959,970 ----
-  
-      if((avctx-&gt;codec-&gt;capabilities &amp; CODEC_CAP_DELAY) || buf_size){
-          //FIXME remove the check below _after_ ensuring that all audio check that the available space is enough
-+ #if 0 // MEANX : Silence
-          if(*frame_size_ptr &lt; AVCODEC_MAX_AUDIO_FRAME_SIZE){
-              av_log(avctx, AV_LOG_ERROR, &quot;buffer smaller than AVCODEC_MAX_AUDIO_FRAME_SIZE\n&quot;);
-              return -1;
-          }
-+ #endif
-          if(*frame_size_ptr &lt; FF_MIN_BUFFER_SIZE ||
-          *frame_size_ptr &lt; avctx-&gt;channels * avctx-&gt;frame_size * sizeof(int16_t)){
-              av_log(avctx, AV_LOG_ERROR, &quot;buffer %d too small\n&quot;, *frame_size_ptr);
+  
+      if((avctx-&gt;codec-&gt;capabilities &amp; CODEC_CAP_DELAY) || buf_size){
+          //FIXME remove the check below _after_ ensuring that all audio check that the available space is enough
++ #if 0 // MEANX : Silence
+          if(*frame_size_ptr &lt; AVCODEC_MAX_AUDIO_FRAME_SIZE){
+              av_log(avctx, AV_LOG_ERROR, &quot;buffer smaller than AVCODEC_MAX_AUDIO_FRAME_SIZE\n&quot;);
+              return -1;
+          }
++ #endif
+          if(*frame_size_ptr &lt; FF_MIN_BUFFER_SIZE ||
+          *frame_size_ptr &lt; avctx-&gt;channels * avctx-&gt;frame_size * sizeof(int16_t)){
+              av_log(avctx, AV_LOG_ERROR, &quot;buffer %d too small\n&quot;, *frame_size_ptr);
 ***************
 *** 1387,1393 ****
-          return -1;
-      }
-  #if !defined(HAVE_MKSTEMP)
-!     fd = open(*filename, O_RDWR | O_BINARY | O_CREAT, 0444);
-  #else
-      snprintf(*filename, len, &quot;/tmp/%sXXXXXX&quot;, prefix);
-      fd = mkstemp(*filename);
+          return -1;
+      }
+  #if !defined(HAVE_MKSTEMP)
+!     fd = open(*filename, O_RDWR | O_BINARY | O_CREAT, 0444);
+  #else
+      snprintf(*filename, len, &quot;/tmp/%sXXXXXX&quot;, prefix);
+      fd = mkstemp(*filename);
 --- 1389,1395 ----
-          return -1;
-      }
-  #if !defined(HAVE_MKSTEMP)
-!     fd = open(*filename, O_RDWR /* MEANX | O_BINARY*/ | O_CREAT, 0444);
-  #else
-      snprintf(*filename, len, &quot;/tmp/%sXXXXXX&quot;, prefix);
-      fd = mkstemp(*filename);
+          return -1;
+      }
+  #if !defined(HAVE_MKSTEMP)
+!     fd = open(*filename, O_RDWR /* MEANX | O_BINARY*/ | O_CREAT, 0444);
+  #else
+      snprintf(*filename, len, &quot;/tmp/%sXXXXXX&quot;, prefix);
+      fd = mkstemp(*filename);

Modified: branches/avidemux_2.5_branch_gruntster/cmake/patches/libavformat_file.c.patch
===================================================================
--- branches/avidemux_2.5_branch_gruntster/cmake/patches/libavformat_file.c.patch	2009-01-19 22:53:34 UTC (rev 4538)
+++ branches/avidemux_2.5_branch_gruntster/cmake/patches/libavformat_file.c.patch	2009-01-21 19:51:01 UTC (rev 4539)
@@ -3,73 +3,73 @@
 ***************
 *** 26,31 ****
 --- 26,95 ----
-  #include &lt;stdlib.h&gt;
-  #include &quot;os_support.h&quot;
-  
-+ // GRUNTSTER start
-+ #ifdef __WIN32
-+ int utf8StringToWideChar(const char *utf8String, int utf8StringLength, wchar_t *wideCharString)
-+ {
-+ 	int wideCharStringLength = MultiByteToWideChar(CP_UTF8, 0, utf8String, utf8StringLength, NULL, 0);
-+ 
-+ 	if (wideCharString)
-+ 		MultiByteToWideChar(CP_UTF8, 0, utf8String, utf8StringLength, wideCharString, wideCharStringLength);
-+ 
-+ 	return wideCharStringLength;
-+ }
-+ 
-+ int ADM_open(const char *path, int oflag, ...)
-+ {
-+ 	int fileNameLength = utf8StringToWideChar(path, -1, NULL);
-+ 	wchar_t wcFile[fileNameLength];
-+ 	int creation = 0, access = 0;
-+ 	HANDLE hFile;
-+ 
-+ 	utf8StringToWideChar(path, -1, wcFile);
-+ 
-+ 	if (oflag &amp; O_WRONLY || oflag &amp; O_RDWR)
-+ 	{
-+ 		access = GENERIC_WRITE;
-+ 
-+ 		if (oflag &amp; O_RDWR)
-+ 			access |= GENERIC_READ;
-+ 
-+ 		if (oflag &amp; O_CREAT)
-+ 		{
-+ 			if (oflag &amp; O_EXCL)
-+ 				creation = CREATE_NEW;
-+ 			else if (oflag &amp; O_TRUNC)
-+ 				creation = CREATE_ALWAYS;
-+ 			else
-+ 				creation = OPEN_ALWAYS;
-+ 		}
-+ 		else if (oflag &amp; O_TRUNC)
-+ 			creation = TRUNCATE_EXISTING;
-+ 	}
-+ 	else if (oflag &amp; O_RDONLY)
-+ 		creation = OPEN_EXISTING;
-+ 
-+ 	if (creation &amp; GENERIC_WRITE)
-+ 	{
-+ 		hFile = CreateFileW(wcFile, access, 0, NULL, creation, 0, NULL);
-+ 
-+ 		if (hFile == INVALID_HANDLE_VALUE)
-+ 			return -1;
-+ 		else
-+ 			CloseHandle(hFile);
-+ 	}
-+ 
-+ 	hFile = CreateFileW(wcFile, access, FILE_SHARE_READ, NULL, creation, 0, NULL);
-+ 
-+ 	if (hFile == INVALID_HANDLE_VALUE)
-+ 		return -1;
-+ 	else
-+ 		return _open_osfhandle((intptr_t)hFile, oflag);
-+ }
-+ 
-+ #define open ADM_open
-+ #endif
-+ // GRUNTSTER end
-  
-  /* standard file protocol */
-  
+  #include &lt;stdlib.h&gt;
+  #include &quot;os_support.h&quot;
+  
++ // GRUNTSTER start
++ #ifdef __WIN32
++ int utf8StringToWideChar(const char *utf8String, int utf8StringLength, wchar_t *wideCharString)
++ {
++ 	int wideCharStringLength = MultiByteToWideChar(CP_UTF8, 0, utf8String, utf8StringLength, NULL, 0);
++ 
++ 	if (wideCharString)
++ 		MultiByteToWideChar(CP_UTF8, 0, utf8String, utf8StringLength, wideCharString, wideCharStringLength);
++ 
++ 	return wideCharStringLength;
++ }
++ 
++ int ADM_open(const char *path, int oflag, ...)
++ {
++ 	int fileNameLength = utf8StringToWideChar(path, -1, NULL);
++ 	wchar_t wcFile[fileNameLength];
++ 	int creation = 0, access = 0;
++ 	HANDLE hFile;
++ 
++ 	utf8StringToWideChar(path, -1, wcFile);
++ 
++ 	if (oflag &amp; O_WRONLY || oflag &amp; O_RDWR)
++ 	{
++ 		access = GENERIC_WRITE;
++ 
++ 		if (oflag &amp; O_RDWR)
++ 			access |= GENERIC_READ;
++ 
++ 		if (oflag &amp; O_CREAT)
++ 		{
++ 			if (oflag &amp; O_EXCL)
++ 				creation = CREATE_NEW;
++ 			else if (oflag &amp; O_TRUNC)
++ 				creation = CREATE_ALWAYS;
++ 			else
++ 				creation = OPEN_ALWAYS;
++ 		}
++ 		else if (oflag &amp; O_TRUNC)
++ 			creation = TRUNCATE_EXISTING;
++ 	}
++ 	else if (oflag &amp; O_RDONLY)
++ 		creation = OPEN_EXISTING;
++ 
++ 	if (creation &amp; GENERIC_WRITE)
++ 	{
++ 		hFile = CreateFileW(wcFile, access, 0, NULL, creation, 0, NULL);
++ 
++ 		if (hFile == INVALID_HANDLE_VALUE)
++ 			return -1;
++ 		else
++ 			CloseHandle(hFile);
++ 	}
++ 
++ 	hFile = CreateFileW(wcFile, access, FILE_SHARE_READ, NULL, creation, 0, NULL);
++ 
++ 	if (hFile == INVALID_HANDLE_VALUE)
++ 		return -1;
++ 	else
++ 		return _open_osfhandle((intptr_t)hFile, oflag);
++ }
++ 
++ #define open ADM_open
++ #endif
++ // GRUNTSTER end
+  
+  /* standard file protocol */
+  

Modified: branches/avidemux_2.5_branch_gruntster/cmake/patches/libavformat_flvenc.c.patch
===================================================================
--- branches/avidemux_2.5_branch_gruntster/cmake/patches/libavformat_flvenc.c.patch	2009-01-19 22:53:34 UTC (rev 4538)
+++ branches/avidemux_2.5_branch_gruntster/cmake/patches/libavformat_flvenc.c.patch	2009-01-21 19:51:01 UTC (rev 4539)
@@ -2,32 +2,32 @@
 --- libavformat/flvenc.c	Sat Jan 17 21:39:38 2009
 ***************
 *** 328,334 ****
-      &quot;video/x-flv&quot;,
-      &quot;flv&quot;,
-      sizeof(FLVContext),
-! #ifdef CONFIG_LIBMP3LAME
-      CODEC_ID_MP3,
-  #else // CONFIG_LIBMP3LAME
-      CODEC_ID_ADPCM_SWF,
+      &quot;video/x-flv&quot;,
+      &quot;flv&quot;,
+      sizeof(FLVContext),
+! #ifdef CONFIG_LIBMP3LAME
+      CODEC_ID_MP3,
+  #else // CONFIG_LIBMP3LAME
+      CODEC_ID_ADPCM_SWF,
 --- 328,335 ----
-      &quot;video/x-flv&quot;,
-      &quot;flv&quot;,
-      sizeof(FLVContext),
-! //MEANX #ifdef CONFIG_LIBMP3LAME
-! #ifdef HAVE_LIBMP3LAME  
-      CODEC_ID_MP3,
-  #else // CONFIG_LIBMP3LAME
-      CODEC_ID_ADPCM_SWF,
+      &quot;video/x-flv&quot;,
+      &quot;flv&quot;,
+      sizeof(FLVContext),
+! //MEANX #ifdef CONFIG_LIBMP3LAME
+! #ifdef HAVE_LIBMP3LAME  
+      CODEC_ID_MP3,
+  #else // CONFIG_LIBMP3LAME
+      CODEC_ID_ADPCM_SWF,
 ***************
 *** 339,341 ****
 --- 340,348 ----
-      flv_write_trailer,
-      .codec_tag= (const AVCodecTag*[]){flv_video_codec_ids, flv_audio_codec_ids, 0},
-  };
-+ // MEANX
-+ int flvenc_init(void)
-+ {
-+     av_register_output_format(&amp;flv_muxer);
-+     return 0;
+      flv_write_trailer,
+      .codec_tag= (const AVCodecTag*[]){flv_video_codec_ids, flv_audio_codec_ids, 0},
+  };
++ // MEANX
++ int flvenc_init(void)
++ {
++     av_register_output_format(&amp;flv_muxer);
++     return 0;
 + }
 \ No newline at end of file

Modified: branches/avidemux_2.5_branch_gruntster/cmake/patches/libavformat_movenc.c.patch
===================================================================
--- branches/avidemux_2.5_branch_gruntster/cmake/patches/libavformat_movenc.c.patch	2009-01-19 22:53:34 UTC (rev 4538)
+++ branches/avidemux_2.5_branch_gruntster/cmake/patches/libavformat_movenc.c.patch	2009-01-21 19:51:01 UTC (rev 4539)
@@ -3,18 +3,18 @@
 ***************
 *** 1747,1749 ****
 --- 1747,1761 ----
-      .codec_tag = (const AVCodecTag*[]){ff_mp4_obj_type, 0},
-  };
-  #endif
-+ /* MEANX */
-+ int movenc_init(void)
-+ {
-+     av_register_output_format(&amp;mov_muxer);
-+     av_register_output_format(&amp;tgp_muxer);
-+     av_register_output_format(&amp;mp4_muxer);
-+     av_register_output_format(&amp;psp_muxer);
-+     av_register_output_format(&amp;tg2_muxer);
-+     av_register_output_format(&amp;ipod_muxer);
-+     return 0;
-+ }
-+ /* MEANX */
+      .codec_tag = (const AVCodecTag*[]){ff_mp4_obj_type, 0},
+  };
+  #endif
++ /* MEANX */
++ int movenc_init(void)
++ {
++     av_register_output_format(&amp;mov_muxer);
++     av_register_output_format(&amp;tgp_muxer);
++     av_register_output_format(&amp;mp4_muxer);
++     av_register_output_format(&amp;psp_muxer);
++     av_register_output_format(&amp;tg2_muxer);
++     av_register_output_format(&amp;ipod_muxer);
++     return 0;
++ }
++ /* MEANX */

Modified: branches/avidemux_2.5_branch_gruntster/cmake/patches/libavutil_avutil.h.patch
===================================================================
--- branches/avidemux_2.5_branch_gruntster/cmake/patches/libavutil_avutil.h.patch	2009-01-19 22:53:34 UTC (rev 4538)
+++ branches/avidemux_2.5_branch_gruntster/cmake/patches/libavutil_avutil.h.patch	2009-01-21 19:51:01 UTC (rev 4539)
@@ -3,16 +3,16 @@
 ***************
 *** 48,53 ****
 --- 48,60 ----
-  
-  #define LIBAVUTIL_IDENT         &quot;Lavu&quot; AV_STRINGIFY(LIBAVUTIL_VERSION)
-  
-+ /* MEANX
-+  * - */
-+ #define ASMALIGN(ZEROBITS) &quot;.p2align &quot; #ZEROBITS &quot;\n\t&quot;
-+ /* /MEANX
-+  */
-+ 
-+ 
-  
-  #include &quot;common.h&quot;
-  #include &quot;mathematics.h&quot;
+  
+  #define LIBAVUTIL_IDENT         &quot;Lavu&quot; AV_STRINGIFY(LIBAVUTIL_VERSION)
+  
++ /* MEANX
++  * - */
++ #define ASMALIGN(ZEROBITS) &quot;.p2align &quot; #ZEROBITS &quot;\n\t&quot;
++ /* /MEANX
++  */
++ 
++ 
+  
+  #include &quot;common.h&quot;
+  #include &quot;mathematics.h&quot;

Modified: branches/avidemux_2.5_branch_gruntster/cmake/patches/libavutil_internal.h.patch
===================================================================
--- branches/avidemux_2.5_branch_gruntster/cmake/patches/libavutil_internal.h.patch	2009-01-19 22:53:34 UTC (rev 4538)
+++ branches/avidemux_2.5_branch_gruntster/cmake/patches/libavutil_internal.h.patch	2009-01-21 19:51:01 UTC (rev 4539)
@@ -3,17 +3,17 @@
 ***************
 *** 234,245 ****
 --- 234,247 ----
-  #endif
-  
-  /* avoid usage of various functions */
-+ #if 0 //MEANX
-  #undef  malloc
-  #define malloc please_use_av_malloc
-  #undef  free
-  #define free please_use_av_free
-  #undef  realloc
-  #define realloc please_use_av_realloc
-+ #endif
-  #undef  time
-  #define time time_is_forbidden_due_to_security_issues
-  #undef  rand
+  #endif
+  
+  /* avoid usage of various functions */
++ #if 0 //MEANX
+  #undef  malloc
+  #define malloc please_use_av_malloc
+  #undef  free
+  #define free please_use_av_free
+  #undef  realloc
+  #define realloc please_use_av_realloc
++ #endif
+  #undef  time
+  #define time time_is_forbidden_due_to_security_issues
+  #undef  rand


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="001771.html">[Avidemux-svn-commit] r4538 - in	branches/avidemux_2.5_branch_gruntster: . avidemux	avidemux/ADM_audio avidemux/ADM_core/src avidemux/ADM_coreAudio/src	avidemux/ADM_coreAudio/src/ADM_libsamplerate	avidemux/ADM_coreImage/include avidemux/ADM_coreImage/src	avidemux/ADM_infoExtractor avidemux/ADM_inputs/ADM_flv	avidemux/ADM_libraries avidemux/ADM_outputs	avidemux/ADM_outputs/oplug_avi	avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2	avidemux/ADM_videoFilter cmake cmake/patches plugins	plugins/ADM_audioEncoders/lavcodec	plugins/ADM_videoFilters/Equalizer	plugins/ADM_videoFilters/Equalizer/gtk	plugins/ADM_videoFilters/ForcedPP plugins/ADM_videoFilters/McDeint	plugins/ADM_videoFilters/Mosaic	plugins/ADM_videoFilters/MplayerResize	plugins/ADM_videoFilters/lavDeinterlace
</A></li>
	<LI>Next message: <A HREF="001773.html">[Avidemux-svn-commit] r4541 -	branches/avidemux_2.5_branch_gruntster/cmake/patches
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1772">[ date ]</a>
              <a href="thread.html#1772">[ thread ]</a>
              <a href="subject.html#1772">[ subject ]</a>
              <a href="author.html#1772">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/avidemux-svn-commit">More information about the Avidemux-svn-commit
mailing list</a><br>
</body></html>
