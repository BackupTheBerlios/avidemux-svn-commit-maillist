<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Avidemux-svn-commit] r4687 - in	branches/avidemux_2.5_branch_gruntster: avidemux/ADM_script	scripts/auto
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/avidemux-svn-commit/2009-March/index.html" >
   <LINK REL="made" HREF="mailto:avidemux-svn-commit%40lists.berlios.de?Subject=Re%3A%20%5BAvidemux-svn-commit%5D%20r4687%20-%20in%0A%09branches/avidemux_2.5_branch_gruntster%3A%20avidemux/ADM_script%0A%09scripts/auto&In-Reply-To=%3C200903141833.n2EIXKuk014546%40sheep.berlios.de%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="001916.html">
   <LINK REL="Next"  HREF="001918.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Avidemux-svn-commit] r4687 - in	branches/avidemux_2.5_branch_gruntster: avidemux/ADM_script	scripts/auto</H1>
    <B>gruntster at mail.berlios.de</B> 
    <A HREF="mailto:avidemux-svn-commit%40lists.berlios.de?Subject=Re%3A%20%5BAvidemux-svn-commit%5D%20r4687%20-%20in%0A%09branches/avidemux_2.5_branch_gruntster%3A%20avidemux/ADM_script%0A%09scripts/auto&In-Reply-To=%3C200903141833.n2EIXKuk014546%40sheep.berlios.de%3E"
       TITLE="[Avidemux-svn-commit] r4687 - in	branches/avidemux_2.5_branch_gruntster: avidemux/ADM_script	scripts/auto">gruntster at mail.berlios.de
       </A><BR>
    <I>Sat Mar 14 19:33:20 CET 2009</I>
    <P><UL>
        <LI>Previous message: <A HREF="001916.html">[Avidemux-svn-commit] r4686 - in	branches/avidemux_2.5_branch_gruntster: avidemux/ADM_script	scripts/auto
</A></li>
        <LI>Next message: <A HREF="001918.html">[Avidemux-svn-commit] r4688 -	branches/avidemux_2.5_branch_gruntster/scripts/video
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1917">[ date ]</a>
              <a href="thread.html#1917">[ thread ]</a>
              <a href="subject.html#1917">[ subject ]</a>
              <a href="author.html#1917">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Author: gruntster
Date: 2009-03-14 19:33:12 +0100 (Sat, 14 Mar 2009)
New Revision: 4687

Modified:
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_script/ADM_JSAvidemuxAudio.cpp
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_script/ADM_JSAvidemuxAudio.h
   branches/avidemux_2.5_branch_gruntster/scripts/auto/Sony PlayStation Portable.js
Log:
[script] clean up naming of methods &amp; props for audio object

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_script/ADM_JSAvidemuxAudio.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_script/ADM_JSAvidemuxAudio.cpp	2009-03-14 14:13:50 UTC (rev 4686)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_script/ADM_JSAvidemuxAudio.cpp	2009-03-14 18:33:12 UTC (rev 4687)
@@ -32,25 +32,25 @@
         { &quot;process&quot;, audioprocess_prop, JSPROP_ENUMERATE },        // process audio when saving
         { &quot;resample&quot;, resample_prop, JSPROP_ENUMERATE },	// resample
         { &quot;delay&quot;, delay_prop, JSPROP_ENUMERATE },	// set audio delay
-        { &quot;film2pal&quot;, film2pal_prop, JSPROP_ENUMERATE },	// convert film to pal
-        { &quot;pal2film&quot;, pal2film_prop, JSPROP_ENUMERATE },	// convert pal to film
+        { &quot;film2Pal&quot;, film2pal_prop, JSPROP_ENUMERATE },	// convert film to pal
+        { &quot;pal2Film&quot;, pal2film_prop, JSPROP_ENUMERATE },	// convert pal to film
         { &quot;normalizeMode&quot;, normalizemode_prop, JSPROP_ENUMERATE },	//
         { &quot;drc&quot;, drc_prop, JSPROP_ENUMERATE },	//
         { &quot;normalizeValue&quot;, normalizevalue_prop, JSPROP_ENUMERATE },	//
+		{ &quot;mixer&quot;, mixerProperty, JSPROP_ENUMERATE },	//
         { 0 }
 };
 
 JSFunctionSpec ADM_JSAvidemuxAudio::methods[] = {
-        { &quot;scanVBR&quot;, ScanVBR, 0, 0, 0 },	// scan variable bit rate audio
+        { &quot;scanVbr&quot;, ScanVBR, 0, 0, 0 },	// scan variable bit rate audio
         { &quot;save&quot;, Save, 1, 0, 0 },	// save audio stream
         { &quot;load&quot;, Load, 2, 0, 0 },	// load audio stream
         { &quot;reset&quot;, Reset, 0, 0, 0 },	// reset audio stream
         { &quot;codec&quot;, Codec, 4, 0, 0 },	// set output codec
-        { &quot;getNbTracks&quot;, getNbTracks, 0, 0, 0 },    // set output codec
+        { &quot;getTrackCount&quot;, getNbTracks, 0, 0, 0 },    // set output codec
         { &quot;setTrack&quot;, setTrack, 1, 0, 0 },    // set output codec
         { &quot;secondAudioTrack&quot;, secondAudioTrack, 2, 0, 0 },    // set audio track
-        { &quot;mixer&quot;, mixer, 1, 0, 0 },    // set mixer configuration
-        { &quot;getNbChannels&quot;, getNbChannels, 1, 0, 0 },
+        { &quot;getChannelCount&quot;, getNbChannels, 1, 0, 0 },
         { &quot;getBitrate&quot;, getBitrate, 1, 0, 0 },
         { 0 }
 };
@@ -132,11 +132,9 @@
                         case drc_prop:
                             *vp = BOOLEAN_TO_JSVAL(priv-&gt;getObject()-&gt;m_bDRC);
                             break;
-/*
-                        case audio_prop:
-                                *vp = OBJECT_TO_JSVAL(priv-&gt;getObject()-&gt;m_pAudio);
-                                break;
-*/
+						case mixerProperty:
+							*vp = STRING_TO_JSVAL(JS_NewStringCopyZ(cx, getCurrentMixerString()));
+							break;
                 }
         }
         return JS_TRUE;
@@ -227,6 +225,13 @@
                                   leaveLock();
                                   break;
                         }
+						case mixerProperty:
+						{
+							const char *mixer = JS_GetStringBytes(JSVAL_TO_STRING(*vp));
+
+							setCurrentMixerFromString(mixer);
+							break;
+						}
                         default : printf(&quot;UNKNOWN AUDIO PROP\n&quot;);
                         return JS_FALSE;
                 }
@@ -447,29 +452,7 @@
         leaveLock();
       return JS_FALSE;
 }
-JSBool ADM_JSAvidemuxAudio::mixer(JSContext *cx, JSObject *obj, uintN argc, 
-                                      jsval *argv, jsval *rval)
-{
-uint32_t nb=0,nw=0;
-uint32_t *infos=NULL;
-        // default return value
-        ADM_JSAvidemuxAudio *p = (ADM_JSAvidemuxAudio *)JS_GetPrivate(cx, obj);
 
-        // default return value
-      if(argc != 1)
-                return JS_FALSE;
-        char *pArg0 = JS_GetStringBytes(JSVAL_TO_STRING(argv[0]));
-        enterLock();
-
-        if(setCurrentMixerFromString(pArg0))
-                *rval=BOOLEAN_TO_JSVAL(true);
-        else
-                *rval=BOOLEAN_TO_JSVAL(false);
-        leaveLock();
-        return JS_TRUE;
-
-}// end Codec
-
 JSBool ADM_JSAvidemuxAudio::getNbChannels(JSContext *cx, JSObject *obj, uintN argc, 
                                       jsval *argv, jsval *rval)
 {

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_script/ADM_JSAvidemuxAudio.h
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_script/ADM_JSAvidemuxAudio.h	2009-03-14 14:13:50 UTC (rev 4686)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_script/ADM_JSAvidemuxAudio.h	2009-03-14 18:33:12 UTC (rev 4687)
@@ -24,7 +24,8 @@
 		pal2film_prop,
 		normalizemode_prop,
 		normalizevalue_prop,
-		drc_prop
+		drc_prop,
+		mixerProperty
 	};
 
 private:
@@ -47,8 +48,6 @@
 	static JSBool Codec(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval);
 	static JSBool getNbTracks(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval);
 	static JSBool setTrack(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval);
-	static JSBool lamePreset(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval);
-	static JSBool mixer(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval);
 	static JSBool secondAudioTrack(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval);
 	static JSBool getNbChannels(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval);
 	static JSBool getBitrate(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval);

Modified: branches/avidemux_2.5_branch_gruntster/scripts/auto/Sony PlayStation Portable.js
===================================================================
--- branches/avidemux_2.5_branch_gruntster/scripts/auto/Sony PlayStation Portable.js	2009-03-14 14:13:50 UTC (rev 4686)
+++ branches/avidemux_2.5_branch_gruntster/scripts/auto/Sony PlayStation Portable.js	2009-03-14 18:33:12 UTC (rev 4687)
@@ -22,8 +22,8 @@
         app.video.codecPlugin(&quot;32BCB447-21C9-4210-AE9A-4FCE6C8588AE&quot;, &quot;x264&quot;, &quot;2PASSBITRATE=1000&quot;, &quot;&lt;?xml version='1.0'?&gt;&lt;x264Config&gt;&lt;presetConfiguration&gt;&lt;name&gt;Sony PlayStation Portable&lt;/name&gt;&lt;type&gt;system&lt;/type&gt;&lt;/presetConfiguration&gt;&lt;x264Options&gt;&lt;/x264Options&gt;&lt;/x264Config&gt;&quot;);
         app.audio.codec(&quot;Faac&quot;, 128, 4, &quot;80 00 00 00 &quot;);
 
-        if (app.audio.getNbChannels(0) != 2)
-            app.audio.mixer(&quot;STEREO&quot;);
+        if (app.audio.getChannelCount(0) != 2)
+            app.audio.mixer = &quot;STEREO&quot;;
 
         app.setContainer(&quot;PSP&quot;);
     }


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="001916.html">[Avidemux-svn-commit] r4686 - in	branches/avidemux_2.5_branch_gruntster: avidemux/ADM_script	scripts/auto
</A></li>
	<LI>Next message: <A HREF="001918.html">[Avidemux-svn-commit] r4688 -	branches/avidemux_2.5_branch_gruntster/scripts/video
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1917">[ date ]</a>
              <a href="thread.html#1917">[ thread ]</a>
              <a href="subject.html#1917">[ subject ]</a>
              <a href="author.html#1917">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/avidemux-svn-commit">More information about the Avidemux-svn-commit
mailing list</a><br>
</body></html>
