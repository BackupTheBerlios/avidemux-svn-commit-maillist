<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Avidemux-svn-commit] r5939 - in	branches/avidemux_2.6_branch_mean/avidemux: common	common/ADM_editor common/ADM_script	common/ADM_script2/include common/ADM_script2/src	qt4/ADM_userInterfaces/ADM_shell
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/avidemux-svn-commit/2010-February/index.html" >
   <LINK REL="made" HREF="mailto:avidemux-svn-commit%40lists.berlios.de?Subject=Re%3A%20%5BAvidemux-svn-commit%5D%20r5939%20-%20in%0A%09branches/avidemux_2.6_branch_mean/avidemux%3A%20common%0A%09common/ADM_editor%20common/ADM_script%0A%09common/ADM_script2/include%20common/ADM_script2/src%0A%09qt4/ADM_userInterfaces/ADM_shell&In-Reply-To=%3C201002200752.o1K7qNLT017316%40sheep.berlios.de%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="003143.html">
   <LINK REL="Next"  HREF="003145.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Avidemux-svn-commit] r5939 - in	branches/avidemux_2.6_branch_mean/avidemux: common	common/ADM_editor common/ADM_script	common/ADM_script2/include common/ADM_script2/src	qt4/ADM_userInterfaces/ADM_shell</H1>
    <B>mean at BerliOS</B> 
    <A HREF="mailto:avidemux-svn-commit%40lists.berlios.de?Subject=Re%3A%20%5BAvidemux-svn-commit%5D%20r5939%20-%20in%0A%09branches/avidemux_2.6_branch_mean/avidemux%3A%20common%0A%09common/ADM_editor%20common/ADM_script%0A%09common/ADM_script2/include%20common/ADM_script2/src%0A%09qt4/ADM_userInterfaces/ADM_shell&In-Reply-To=%3C201002200752.o1K7qNLT017316%40sheep.berlios.de%3E"
       TITLE="[Avidemux-svn-commit] r5939 - in	branches/avidemux_2.6_branch_mean/avidemux: common	common/ADM_editor common/ADM_script	common/ADM_script2/include common/ADM_script2/src	qt4/ADM_userInterfaces/ADM_shell">mean at mail.berlios.de
       </A><BR>
    <I>Sat Feb 20 08:52:23 CET 2010</I>
    <P><UL>
        <LI>Previous message: <A HREF="003143.html">[Avidemux-svn-commit] r5938 - in	branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreVideoEncoder:	include src
</A></li>
        <LI>Next message: <A HREF="003145.html">[Avidemux-svn-commit] r5940 - in	branches/avidemux_2.6_branch_mean/avidemux:	cli/ADM_userInterfaces/ADM_shell gtk/ADM_userInterfaces/ADM_shell
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#3144">[ date ]</a>
              <a href="thread.html#3144">[ thread ]</a>
              <a href="subject.html#3144">[ subject ]</a>
              <a href="author.html#3144">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Author: mean
Date: 2010-02-20 08:52:21 +0100 (Sat, 20 Feb 2010)
New Revision: 5939

Added:
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/include/ADM_JSif.h
Removed:
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script/ADM_Avidemux.cpp
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script/ADM_Avidemux.h
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script/ADM_AvidemuxAudio.cpp
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script/ADM_AvidemuxAudio.h
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script/ADM_AvidemuxVideo.cpp
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script/ADM_AvidemuxVideo.h
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script/ADM_JSAvidemux.cpp
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script/ADM_JSAvidemux.h
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script/ADM_JSAvidemuxAudio.cpp
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script/ADM_JSAvidemuxAudio.h
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script/ADM_JSAvidemuxVideo.cpp
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script/ADM_JSAvidemuxVideo.h
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script/ADM_JSDebug.cpp
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script/ADM_JSDebug.h
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script/ADM_JSDirectorySearch.cpp
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script/ADM_JSDirectorySearch.h
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script/ADM_JSDirectorySearch.h.orig
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script/ADM_JSFunctions.cpp
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script/ADM_JSFunctions.cpp.orig
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script/ADM_JSFunctionsNonRegFactory.cpp
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script/ADM_JSGlobal.cpp
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script/ADM_JSGlobal.h
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script/ADM_JSif.cpp
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script/ADM_JSif.h
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script/ADM_container.h
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script/ADM_jsShell.h
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script/ADM_jsUtils.cpp
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script/ADM_jsUtils.h
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script/CMakeLists.txt
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script/DirectorySearch.cpp
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script/DirectorySearch.cpp.orig
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script/DirectorySearch.h
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script/StdFile.h
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script/adm_scanner.h
Modified:
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_editor/ADM_segment.cpp
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src/CMakeLists.txt
   branches/avidemux_2.6_branch_mean/avidemux/common/CMakeLists.txt
   branches/avidemux_2.6_branch_mean/avidemux/common/gtk_gui.cpp
   branches/avidemux_2.6_branch_mean/avidemux/qt4/ADM_userInterfaces/ADM_shell/CMakeLists.txt
Log:
[script] Remove old ADM_script folder, replaced by ADM_script2 using jsapigen

Modified: branches/avidemux_2.6_branch_mean/avidemux/common/ADM_editor/ADM_segment.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/ADM_editor/ADM_segment.cpp	2010-02-18 06:18:53 UTC (rev 5938)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/ADM_editor/ADM_segment.cpp	2010-02-20 07:52:21 UTC (rev 5939)
@@ -23,7 +23,7 @@
 #include &quot;ADM_colorspace.h&quot;
 #include &quot;ADM_vidMisc.h&quot;
 #include &quot;ADM_audiocodec/ADM_audiocodec.h&quot;
-#include &quot;ADM_script/ADM_JSif.h&quot;
+#include &quot;ADM_script2/include/ADM_JSif.h&quot;
 #include &quot;ADM_codec.h&quot;
 
 ADM_EditorSegment::ADM_EditorSegment(void)

Deleted: branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script/ADM_Avidemux.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script/ADM_Avidemux.cpp	2010-02-18 06:18:53 UTC (rev 5938)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script/ADM_Avidemux.cpp	2010-02-20 07:52:21 UTC (rev 5939)
@@ -1,82 +0,0 @@
-/***************************************************************************
- *                                                                         *
- *   This program is free software; you can redistribute it and/or modify  *
- *   it under the terms of the GNU General Public License as published by  *
- *   the Free Software Foundation; either version 2 of the License, or     *
- *   (at your option) any later version.                                   *
- *                                                                         *
- ***************************************************************************/
-
-#define JSDECLARE
-#include &quot;ADM_Avidemux.h&quot;
-
-ADM_Avidemux::ADM_Avidemux(void) :  m_pAudio(NULL), m_pVideo(NULL), m_pContainer(NULL), m_nCurrentFrame(0), m_dFPS(0)
-{// begin ADM_Avidemux
-
-	// initialize audio property
-	JSObject *pTempObject = ADM_JSAvidemuxAudio::JSInit(g_pCx,g_pObject);
-	ADM_JSAvidemuxAudio *pAudio = new ADM_JSAvidemuxAudio();
-	pAudio-&gt;setObject(new ADM_AvidemuxAudio());
-	JS_SetPrivate(g_pCx,pTempObject,pAudio);
-	m_pAudio = pTempObject;
-
-	// initialize video property
-	pTempObject = ADM_JSAvidemuxVideo::JSInit(g_pCx,g_pObject);
-	ADM_JSAvidemuxVideo *pVideo = new ADM_JSAvidemuxVideo();
-	pVideo-&gt;setObject(new ADM_AvidemuxVideo());
-	JS_SetPrivate(g_pCx,pTempObject,pVideo);
-	m_pVideo = pTempObject;
-}// end ADM_Avidemux
-
-ADM_Avidemux::~ADM_Avidemux()
-{// begin ~ADM_Avidemux
-
-}// end ~ADM_Avidemux
-/******************************************/
-JSPropertySpec *ADM_JsAudioGetProperties(void);
-JSFunctionSpec *ADM_JsAudioGetFunctions(void);
-JSPropertySpec *ADM_JsVideoGetProperties(void);
-JSFunctionSpec *ADM_JsVideoGetFunctions(void);
-JSPropertySpec *ADM_JsClassGetProperties(void);
-JSFunctionSpec *ADM_JsClassGetFunctions(void);
-JSFunctionSpec *ADM_JsDebugGetFunctions(void);
-
-static void dumpFunc(JSFunctionSpec *f)
-{
-    while(f-&gt;name)
-    {
-        jsLog(JS_LOG_NORMAL,&quot;     %s(..)&quot;,f-&gt;name);
-        f++;
-    }
-}
-static void dumpProps(JSPropertySpec *f)
-{
-    while(f-&gt;name)
-    {
-        jsLog(JS_LOG_NORMAL,&quot;     %s=xxx&quot;,f-&gt;name);
-        f++;
-    }
-}
-/**
-    \fn ADM_dumpJSHooks
-    \brief Printf the additional avidemux functions/properties
-*/
-void ADM_dumpJSHooks(void)
-{
-    jsLog(JS_LOG_NORMAL,&quot;Dumping JS interface&quot;);
-    jsLog(JS_LOG_NORMAL,&quot;********************&quot;);
-    jsLog(JS_LOG_NORMAL,&quot;Debug functions :&quot;);
-    dumpFunc(ADM_JsDebugGetFunctions());
-    jsLog(JS_LOG_NORMAL,&quot;app.&quot;);
-    dumpFunc(ADM_JsClassGetFunctions());
-    dumpProps(ADM_JsClassGetProperties());
-    jsLog(JS_LOG_NORMAL,&quot;app.video&quot;);
-    dumpFunc(ADM_JsVideoGetFunctions());
-    dumpProps(ADM_JsVideoGetProperties());
-    jsLog(JS_LOG_NORMAL,&quot;app.audio&quot;);
-    dumpFunc(ADM_JsAudioGetFunctions());
-    dumpProps(ADM_JsAudioGetProperties());
-    jsLog(JS_LOG_NORMAL,&quot;Done&quot;);
-    jsLog(JS_LOG_NORMAL,&quot;****&quot;);
-
-}
\ No newline at end of file

Deleted: branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script/ADM_Avidemux.h
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script/ADM_Avidemux.h	2010-02-18 06:18:53 UTC (rev 5938)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script/ADM_Avidemux.h	2010-02-20 07:52:21 UTC (rev 5939)
@@ -1,31 +0,0 @@
-/***************************************************************************
- *                                                                         *
- *   This program is free software; you can redistribute it and/or modify  *
- *   it under the terms of the GNU General Public License as published by  *
- *   the Free Software Foundation; either version 2 of the License, or     *
- *   (at your option) any later version.                                   *
- *                                                                         *
- ***************************************************************************/
-
-#ifndef _ADM_AVIDEMUX_H
-#define _ADM_AVIDEMUX_H
-#include &quot;ADM_JSGlobal.h&quot;
-#include &quot;ADM_JSAvidemuxAudio.h&quot;
-#include &quot;ADM_JSAvidemuxVideo.h&quot;
-
-class ADM_Avidemux
-{
-public:
-	ADM_Avidemux(void);
-	virtual ~ADM_Avidemux(void);
-
-	// member variables
-	JSObject *m_pAudio;
-	JSObject *m_pVideo;
-	JSString *m_pContainer;
-	int m_nCurrentFrame;
-	double m_dFPS;
-
-};
-
-#endif

Deleted: branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script/ADM_AvidemuxAudio.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script/ADM_AvidemuxAudio.cpp	2010-02-18 06:18:53 UTC (rev 5938)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script/ADM_AvidemuxAudio.cpp	2010-02-20 07:52:21 UTC (rev 5939)
@@ -1,6 +0,0 @@
-#include &quot;ADM_AvidemuxAudio.h&quot;
-
-ADM_AvidemuxAudio::~ADM_AvidemuxAudio()
-{// begin ~ADM_AvidemuxAudio
-
-}// end ~ADM_AvidemuxAudio

Deleted: branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script/ADM_AvidemuxAudio.h
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script/ADM_AvidemuxAudio.h	2010-02-18 06:18:53 UTC (rev 5938)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script/ADM_AvidemuxAudio.h	2010-02-20 07:52:21 UTC (rev 5939)
@@ -1,12 +0,0 @@
-#ifndef _ADM_AVIDEMUXAUDIO_H
-#define _ADM_AVIDEMUXAUDIO_H
-
-
-class ADM_AvidemuxAudio
-{
-public:
-	ADM_AvidemuxAudio(void){}
-	virtual ~ADM_AvidemuxAudio(void);
-};
-
-#endif

Deleted: branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script/ADM_AvidemuxVideo.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script/ADM_AvidemuxVideo.cpp	2010-02-18 06:18:53 UTC (rev 5938)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script/ADM_AvidemuxVideo.cpp	2010-02-20 07:52:21 UTC (rev 5939)
@@ -1,6 +0,0 @@
-#include &quot;ADM_AvidemuxVideo.h&quot;
-
-ADM_AvidemuxVideo::~ADM_AvidemuxVideo()
-{// begin ~ADM_AvidemuxVideo
-
-}// end ~ADM_AvidemuxVideo

Deleted: branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script/ADM_AvidemuxVideo.h
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script/ADM_AvidemuxVideo.h	2010-02-18 06:18:53 UTC (rev 5938)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script/ADM_AvidemuxVideo.h	2010-02-20 07:52:21 UTC (rev 5939)
@@ -1,14 +0,0 @@
-#ifndef _ADM_AVIDEMUXVIDEO_H
-#define _ADM_AVIDEMUXVIDEO_H
-
-class ADM_AvidemuxVideo
-{
-public:
-	ADM_AvidemuxVideo(void) {}
-	virtual ~ADM_AvidemuxVideo(void);
-
-	// member variables
-        bool m_bVideoProcess;
-};
-
-#endif

Deleted: branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script/ADM_JSAvidemux.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script/ADM_JSAvidemux.cpp	2010-02-18 06:18:53 UTC (rev 5938)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script/ADM_JSAvidemux.cpp	2010-02-20 07:52:21 UTC (rev 5939)
@@ -1,588 +0,0 @@
-/**
-    \file ADM_JSAvidemux
-    \brief SpiderMonkey&lt;-&gt;Avidemux interface for avidemux class
-    \author Anish Mistry, modified by mean &amp; gruntster also
-
-*/
-
-/***************************************************************************
- *                                                                         *
- *   This program is free software; you can redistribute it and/or modify  *
- *   it under the terms of the GNU General Public License as published by  *
- *   the Free Software Foundation; either version 2 of the License, or     *
- *   (at your option) any later version.                                   *
- *                                                                         *
- ***************************************************************************/
-#include &lt;math.h&gt;
-
-#include &quot;ADM_default.h&quot;
-#include &quot;ADM_JSAvidemux.h&quot;
-#include &quot;avi_vars.h&quot;
-#include &quot;DIA_coreToolkit.h&quot;
-#include &quot;ADM_commonUI/GUI_ui.h&quot;
-#include &quot;ADM_muxerProto.h&quot;
-#include &quot;ADM_confCouple.h&quot;
-#include &quot;ADM_debugID.h&quot;
-#define MODULE_NAME MODULE_SCRIPT
-#include &quot;ADM_debug.h&quot;
-#include &quot;ADM_JSDebug.h&quot;
-#include &quot;ADM_jsUtils.h&quot;
-
-extern int A_openAvi (const char *name);
-extern int A_Save (const char *name);
-extern int A_appendAvi (const char *name);
-extern uint8_t ogmSave(char *name);
-extern int GUI_GoToFrame(uint32_t frame);
-extern int filterLoadXml(const char *docname,uint8_t silent);
-extern int A_delete(uint32_t start, uint32_t end);
-
-extern uint8_t A_ListAllBlackFrames( char *file );
-extern uint8_t A_jumpToTime(uint32_t hh,uint32_t mm,uint32_t ss,uint32_t ms);
-extern uint8_t addFile(char *name);
-
-bool           A_setContainer(const char *cont);
-
-
-bool jsArgToConfCouple(int nb,CONFcouple **conf,  jsval *argv);
-
-JSPropertySpec ADM_JSAvidemux::avidemux_properties[] = 
-{ 
-
-	{ &quot;markerA&quot;, markerA_prop, JSPROP_ENUMERATE },	// set marker A
-	{ &quot;markerB&quot;, markerB_prop, JSPROP_ENUMERATE },	// set marker B
-	{ &quot;audio&quot;, audio_prop, JSPROP_ENUMERATE },	// audio object
-	{ &quot;video&quot;, video_prop, JSPROP_ENUMERATE },	// video object
-	{ &quot;container&quot;, container_prop, JSPROP_ENUMERATE },	// set container type
-	{ &quot;currentFrame&quot;, currentframe_prop, JSPROP_ENUMERATE },	// set current frame
-	{ &quot;fps&quot;, fps_prop, JSPROP_ENUMERATE },	// set movie frame rate
-	{ 0 }
-};
-
-JSFunctionSpec ADM_JSAvidemux::avidemux_methods[] = 
-{
-	{ &quot;append&quot;, Append, 1, 0, 0 },	// append video
-	{ &quot;delete&quot;, Delete, 2, 0, 0 },	// delete section
-	{ &quot;exit&quot;, Exit, 0, 0, 0 },	// exit Avidemux
-	{ &quot;load&quot;, Load, 1, 0, 0 },	// Load movie
-	{ &quot;loadFilters&quot;, LoadFilters, 1, 0, 0 },	// Load filters from file
-	{ &quot;save&quot;, Save, 1, 0, 0 },	// Save movie
-    { &quot;clearSegments&quot;, ClearSegments ,0,0,0}, // Clear all segments
-    { &quot;addSegment&quot;, AddSegment ,3,0,0}, // Clear all segments
-	{ &quot;goToTime&quot;, GoToTime, 3, 0, 0 },	// more current frame to time index
-	{ &quot;forceUnpack&quot;, forceUnpack, 0, 0, 0 },
-    { &quot;smartCopyMode&quot;, smartcopyMode, 0, 0, 0 },
-    { &quot;setContainer&quot;, setContainer, 1, 0, 0 },
-    { &quot;rebuildIndex&quot;, rebuildIndex, 0, 0, 0 },
-
-	{ 0 }
-};
-/*******************************************/
-JSPropertySpec *ADM_JsClassGetProperties(void)
-{
-    return ADM_JSAvidemux::avidemux_properties;
-}
-JSFunctionSpec *ADM_JsClassGetFunctions(void)
-{
-    return ADM_JSAvidemux::avidemux_methods;
-}
-/*******************************************/
-JSClass ADM_JSAvidemux::m_classAvidemux = 
-{
-	&quot;Avidemux&quot;, JSCLASS_HAS_PRIVATE,
-	JS_PropertyStub, JS_PropertyStub,
-	ADM_JSAvidemux::JSGetProperty, ADM_JSAvidemux::JSSetProperty,
-	JS_EnumerateStub, JS_ResolveStub, 
-	JS_ConvertStub, ADM_JSAvidemux::JSDestructor
-};
-
-ADM_JSAvidemux::~ADM_JSAvidemux(void)
-{
-	if(m_pObject != NULL)
-		delete m_pObject;
-	m_pObject = NULL;
-}
-
-void ADM_JSAvidemux::setObject(ADM_Avidemux *pObject)
-{
-	m_pObject = pObject; 
-}
-	
-ADM_Avidemux *ADM_JSAvidemux::getObject()
-{
-	return m_pObject; 
-}
-
-JSObject *ADM_JSAvidemux::JSInit(JSContext *cx, JSObject *obj, JSObject *proto)
-{
-	JSObject *newObj = JS_InitClass(cx, obj, proto, &amp;m_classAvidemux, 
-									ADM_JSAvidemux::JSConstructor, 0,
-									ADM_JSAvidemux::avidemux_properties, ADM_JSAvidemux::avidemux_methods,
-									NULL, NULL);
-	return newObj;
-}
-
-JSBool ADM_JSAvidemux::JSConstructor(JSContext *cx, JSObject *obj, uintN argc, 
-								 jsval *argv, jsval *rval)
-{
-	if(argc != 0)
-		return JS_FALSE;
-	ADM_JSAvidemux *p = new ADM_JSAvidemux();
-	ADM_Avidemux *pObject = new ADM_Avidemux();
-	p-&gt;setObject(pObject);
-	if ( ! JS_SetPrivate(cx, obj, p) )
-		return JS_FALSE;
-	*rval = OBJECT_TO_JSVAL(obj);
-	return JS_TRUE;
-}
-
-void ADM_JSAvidemux::JSDestructor(JSContext *cx, JSObject *obj)
-{
-	ADM_JSAvidemux *p = (ADM_JSAvidemux *)JS_GetPrivate(cx, obj);
-	if(p != NULL)
-		delete p;
-	p = NULL;
-}
-
-JSBool ADM_JSAvidemux::JSGetProperty(JSContext *cx, JSObject *obj, jsval id, jsval *vp)
-{
-        if (JSVAL_IS_INT(id)) 
-        {
-                ADM_JSAvidemux *priv = (ADM_JSAvidemux *) JS_GetPrivate(cx, obj);
-                switch(JSVAL_TO_INT(id))
-                {
-
-                        case markerA_prop:
-                                *vp = INT_TO_JSVAL(video_body-&gt;getMarkerAPts());
-                                break;
-                        case markerB_prop:
-                                *vp = INT_TO_JSVAL(video_body-&gt;getMarkerBPts());
-                                break;
-                        case audio_prop:
-                                *vp = OBJECT_TO_JSVAL(priv-&gt;getObject()-&gt;m_pAudio);
-                                break;
-                        case video_prop:
-                                *vp = OBJECT_TO_JSVAL(priv-&gt;getObject()-&gt;m_pVideo);
-                                break;
-                        case container_prop:
-                                *vp = STRING_TO_JSVAL(priv-&gt;getObject()-&gt;m_pContainer);
-                                break;
-                        case currentframe_prop:
-                                *vp = INT_TO_JSVAL(priv-&gt;getObject()-&gt;m_nCurrentFrame);
-                                break;
-                        case fps_prop:
-                                {
-                                        aviInfo info;
-
-                                        if (avifileinfo)
-                                        {
-                                                enterLock();
-                                                video_body-&gt;getVideoInfo(&amp;info);
-                                                priv-&gt;getObject()-&gt;m_dFPS = info.fps1000/1000.0; 
-                                                video_body-&gt;updateVideoInfo (&amp;info);
-                                                video_body-&gt;getVideoInfo (avifileinfo);
-                                                leaveLock();
-                                        } 
-                                        else 
-                                        {
-                                                return JS_FALSE;
-                                        }
-                                        *vp = DOUBLE_TO_JSVAL(priv-&gt;getObject()-&gt;m_dFPS);
-                                }
-                                break;
-                }
-        }
-        return JS_TRUE;
-}
-
-JSBool ADM_JSAvidemux::JSSetProperty(JSContext *cx, JSObject *obj, jsval id, jsval *vp)
-{
-	if (JSVAL_IS_INT(id)) 
-	{
-		ADM_JSAvidemux *priv = (ADM_JSAvidemux *) JS_GetPrivate(cx, obj);
-		switch(JSVAL_TO_INT(id))
-		{
-			case markerA_prop:
-				if(JSVAL_IS_INT(*vp) == false)
-					break;
-				{
-					int f=JSVAL_TO_INT(*vp);
-					if (!avifileinfo)
-					{
-						return JS_FALSE;
-					} 
-                    video_body-&gt;setMarkerAPts(f);
-				}
-				break;
-			case markerB_prop:
-				if(JSVAL_IS_INT(*vp) == false)
-					break;
-				{
-					int f=JSVAL_TO_INT(*vp);
-					if (!avifileinfo)
-					{
-						return JS_FALSE;
-					} 
-                    video_body-&gt;setMarkerBPts(f);
-				}
-				break;
-			case audio_prop:
-				return JS_FALSE;
-				break;
-			case video_prop:
-				return JS_FALSE;
-				break;
-			case container_prop:
-				if(JSVAL_IS_STRING(*vp) == false)
-					break;
-				{
-					priv-&gt;getObject()-&gt;m_pContainer = JSVAL_TO_STRING(*vp);
-					char *pContainer = JS_GetStringBytes(priv-&gt;getObject()-&gt;m_pContainer);
-					aprintf(&quot;Setting container format \&quot;%s\&quot;\n&quot;,pContainer);
-                                        if(A_setContainer(pContainer))
-                                                return JS_TRUE;
-                                        return JS_FALSE;
-					return JS_FALSE;
-				}
-				break;
-			case currentframe_prop:
-				if(JSVAL_IS_INT(*vp) == false)
-					break;
-				{
-					int frameno;
-					if (!avifileinfo)
-						return JS_FALSE;
-					
-					frameno = JSVAL_TO_INT(*vp);
-					if( frameno&lt;0)
-					{
-						aviInfo info;
-						video_body-&gt;getVideoInfo(&amp;info);
-						frameno=-frameno;
-						if(frameno&gt;info.nb_frames)
-							return JS_FALSE;
-						
-						frameno = info.nb_frames-frameno;
-					}
-                                        enterLock();
-					if(GUI_GoToFrame( frameno ))
-					{
-						leaveLock();
-						return JS_TRUE;
-					}
-					leaveLock();
-					return JS_FALSE;
-				}
-				break;
-			case fps_prop:
-				if(JSVAL_IS_DOUBLE(*vp) == false)
-					break;
-				{
-					priv-&gt;getObject()-&gt;m_dFPS = *JSVAL_TO_DOUBLE(*vp);
-					aviInfo info;
-
-					if (avifileinfo)
-					{
-						video_body-&gt;getVideoInfo(&amp;info);				
-						info.fps1000 = (uint32_t)floor(priv-&gt;getObject()-&gt;m_dFPS*1000.f);
-						video_body-&gt;updateVideoInfo (&amp;info);
-						video_body-&gt;getVideoInfo (avifileinfo);
-						return JS_TRUE;
-					} else 
-					{
-						return JS_FALSE;
-					}
-				}
-				break;
-		}
-	}
-	return JS_TRUE;
-}
-
-JSBool ADM_JSAvidemux::Load(JSContext *cx, JSObject *obj, uintN argc, 
-                                       jsval *argv, jsval *rval)
-{// begin Load
-        JSBool ret=JS_FALSE;
-        ADM_JSAvidemux *p = (ADM_JSAvidemux *)JS_GetPrivate(cx, obj);
-        // default return value
-        *rval = BOOLEAN_TO_JSVAL(false);
-        if(argc != 1)
-                return JS_FALSE;
-        if(JSVAL_IS_STRING(argv[0]) == false)
-                return JS_FALSE;
-        char *pTempStr = JS_GetStringBytes(JSVAL_TO_STRING(argv[0]));
-        printf(&quot;Loading \&quot;%s\&quot;\n&quot;,pTempStr);
-        // Do a failure instead of returing ko
-        *rval = BOOLEAN_TO_JSVAL(JS_TRUE);
-        enterLock();
-        if(!A_openAvi(pTempStr)) 
-        {
-          ret= JS_FALSE;	
-        }else 
-        {
-          ret=JS_TRUE;
-        }
-        leaveLock();
-	return ret;
-}// end Load
-
-JSBool ADM_JSAvidemux::LoadFilters(JSContext *cx, JSObject *obj, uintN argc, 
-                                       jsval *argv, jsval *rval)
-{// begin LoadFilters
-#if 0
-        ADM_JSAvidemux *p = (ADM_JSAvidemux *)JS_GetPrivate(cx, obj);
-        // default return value
-        *rval = BOOLEAN_TO_JSVAL(false);
-        if(argc != 1)
-                return JS_FALSE;
-        if(JSVAL_IS_STRING(argv[0]) == false)
-                return JS_FALSE;
-        char *pTempStr = JS_GetStringBytes(JSVAL_TO_STRING(argv[0]));
-        printf(&quot;Loading Filters \&quot;%s\&quot;\n&quot;,pTempStr);
-        enterLock();
-        *rval = BOOLEAN_TO_JSVAL(filterLoadXml(pTempStr,0));
-        leaveLock();
-#endif
-	return JS_TRUE;
-}// end LoadFilters
-
-
-JSBool ADM_JSAvidemux::Append(JSContext *cx, JSObject *obj, uintN argc, 
-                                       jsval *argv, jsval *rval)
-{// begin Append
-        ADM_JSAvidemux *p = (ADM_JSAvidemux *)JS_GetPrivate(cx, obj);
-        // default return value
-        *rval = BOOLEAN_TO_JSVAL(false);
-        if(argc != 1)
-                return JS_FALSE;
-        if(JSVAL_IS_STRING(argv[0]) == false)
-                return JS_FALSE;
-        char *pTempStr = JS_GetStringBytes(JSVAL_TO_STRING(argv[0]));
-        printf(&quot;Appending \&quot;%s\&quot;\n&quot;,pTempStr);
-        enterLock();
-        *rval = BOOLEAN_TO_JSVAL(A_appendAvi(pTempStr));
-        leaveLock();
-	return JS_TRUE;
-}// end Append
-
-JSBool ADM_JSAvidemux::Delete(JSContext *cx, JSObject *obj, uintN argc, 
-                                       jsval *argv, jsval *rval)
-{// begin Delete
-        ADM_JSAvidemux *p = (ADM_JSAvidemux *)JS_GetPrivate(cx, obj);
-        // default return value
-        *rval = BOOLEAN_TO_JSVAL(false);
-        if(argc != 2)
-                return JS_FALSE;
-        if(JSVAL_IS_INT(argv[0]) == false || JSVAL_IS_INT(argv[1]) == false)
-                return JS_FALSE;
-        int a = JSVAL_TO_INT(argv[0]);
-        int b = JSVAL_TO_INT(argv[1]);
-        aprintf(&quot;Deleting %d-%d\n&quot;,a,b);
-        enterLock();
-        *rval = BOOLEAN_TO_JSVAL(A_delete(a,b));
-        leaveLock();
-        return JS_TRUE;
-}// end Delete
-
-JSBool ADM_JSAvidemux::Save(JSContext *cx, JSObject *obj, uintN argc, 
-                                       jsval *argv, jsval *rval)
-{// begin Save
-        ADM_JSAvidemux *p = (ADM_JSAvidemux *)JS_GetPrivate(cx, obj);
-        // default return value
-        *rval = BOOLEAN_TO_JSVAL(false);
-        if(argc != 1)
-                return JS_FALSE;
-        if(JSVAL_IS_STRING(argv[0]) == false)
-                return JS_FALSE;
-        char *pTempStr = JS_GetStringBytes(JSVAL_TO_STRING(argv[0]));
-        printf(&quot;Saving \&quot;%s\&quot;\n&quot;,pTempStr);
-        enterLock();
-        *rval = BOOLEAN_TO_JSVAL(A_Save(pTempStr));
-        leaveLock();
-        return JS_TRUE;
-}// end Save
-
-static void updateAll(void)
-{
-        if(!avifileinfo) return;
-        if (!video_body-&gt;updateVideoInfo (avifileinfo))
-        {
-                GUI_Error_HIG (&quot;OOPS&quot;,&quot;Something bad happened when executing that script&quot;);
-        }
-        frameStart=0;
-        if(avifileinfo-&gt;nb_frames)
-                frameEnd=avifileinfo-&gt;nb_frames-1;
-        else
-                frameEnd=0;
-}
-/**
-    \fn ClearSegments
-    \brief empty the segment list
-*/
-JSBool ADM_JSAvidemux::ClearSegments(JSContext *cx, JSObject *obj, uintN argc, 
-                                       jsval *argv, jsval *rval)
-{// begin ClearSegments
-        ADM_JSAvidemux *p = (ADM_JSAvidemux *)JS_GetPrivate(cx, obj);
-        // default return value
-        *rval = BOOLEAN_TO_JSVAL(false);
-        if(argc != 0)
-                return JS_FALSE;
-        printf(&quot;clearing segments \n&quot;);
-        enterLock();
-        *rval = BOOLEAN_TO_JSVAL(video_body-&gt;clearSegment());
-        leaveLock();
-        updateAll();
-        return JS_TRUE;
-}// end ClearSegments
-/**
-    \fn AddSegment
-    \brief add a segment. addsegment(ref video,refStartTime, duration) 
-    
-*/
-JSBool ADM_JSAvidemux::AddSegment(JSContext *cx, JSObject *obj, uintN argc, 
-                                       jsval *argv, jsval *rval)
-{// begin AddSegment
-        ADM_JSAvidemux *p = (ADM_JSAvidemux *)JS_GetPrivate(cx, obj);
-        //
-        uint32_t ref=0;
-        uint64_t duration=0,start=0;
-        ADM_PARAM_LIST params[3]={{ADM_JS_UINT32_T,&amp;ref},{ADM_JS_UINT64_T,&amp;start},{ADM_JS_UINT64_T,&amp;duration}};
-        // default return value
-        *rval = BOOLEAN_TO_JSVAL(false);
-        if(false==ADM_jsArg2Vars(cx, obj, argc, argv, 3, params))
-        {
-            jsLog(JS_LOG_ERROR,&quot;wrong arguments to AddSegment&quot;);
-            return JS_FALSE;
-        }
-        ADM_info(&quot;adding segment :%d %d %d\n&quot;,ref,start,duration);
-        enterLock();
-        *rval = BOOLEAN_TO_JSVAL( video_body-&gt;addSegment(ref,start,duration));
-        leaveLock();
-        updateAll();
-        return JS_TRUE;
-}// end AddSegment
-
-
-JSBool ADM_JSAvidemux::Exit(JSContext *cx, JSObject *obj, uintN argc, 
-                                       jsval *argv, jsval *rval)
-{// begin Exit
-	ADM_JSAvidemux *p = (ADM_JSAvidemux *)JS_GetPrivate(cx, obj);
-	// default return value
-	*rval = BOOLEAN_TO_JSVAL(false);
-	if(argc != 0)
-		return JS_FALSE;
-	exit(0);
-	*rval = INT_TO_JSVAL(1);
-	return JS_TRUE;
-}// end Exit
-
-JSBool ADM_JSAvidemux::GoToTime(JSContext *cx, JSObject *obj, uintN argc, 
-                                       jsval *argv, jsval *rval)
-{// begin GoToTime
-	ADM_JSAvidemux *p = (ADM_JSAvidemux *)JS_GetPrivate(cx, obj);
-	// default return value
-	*rval = BOOLEAN_TO_JSVAL(false);
-	if(argc != 3)
-		return JS_FALSE;
-	if(JSVAL_IS_INT(argv[0]) == false || JSVAL_IS_INT(argv[1]) == false || JSVAL_IS_INT(argv[2]) == false)
-		return JS_FALSE;
-        enterLock();
-	*rval = INT_TO_JSVAL(A_jumpToTime(JSVAL_TO_INT(argv[0]),JSVAL_TO_INT(argv[1]),JSVAL_TO_INT(argv[2]), 0));
-	leaveLock();
-	return JS_TRUE;
-}// end GoToTime
-
-JSBool ADM_JSAvidemux::forceUnpack(JSContext *cx, JSObject *obj, uintN argc, 
-                                       jsval *argv, jsval *rval)
-{// begin GoToTime
-        ADM_JSAvidemux *p = (ADM_JSAvidemux *)JS_GetPrivate(cx, obj);
-        // default return value
-        *rval = BOOLEAN_TO_JSVAL(false);
-        if(argc != 0)
-                return JS_FALSE;
-        enterLock();
-        video_body-&gt;setEnv(ENV_EDITOR_PVOP);
-        leaveLock();
-        *rval = INT_TO_JSVAL(1);
-        return JS_TRUE;
-}// end GoToTime
-JSBool ADM_JSAvidemux::rebuildIndex(JSContext *cx, JSObject *obj, uintN argc, 
-                                       jsval *argv, jsval *rval)
-{// begin GoToTime
-        ADM_JSAvidemux *p = (ADM_JSAvidemux *)JS_GetPrivate(cx, obj);
-        // default return value
-        *rval = BOOLEAN_TO_JSVAL(false);
-        if(argc != 0)
-                return JS_FALSE;
-        enterLock();
-//        if(!video_body-&gt;isReordered(0)) // already done
-        {
-          //video_body-&gt;rebuildFrameType();
-        }
- 	leaveLock();
-       return JS_TRUE;
-}// end GoToTime
-
-JSBool ADM_JSAvidemux::smartcopyMode(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval)
-{
-
-ADM_JSAvidemux *p = (ADM_JSAvidemux *)JS_GetPrivate(cx, obj);
-        // default return value
-        printf(&quot;[JS]Setting smart copy mode(1)\n&quot;);
-        *rval = BOOLEAN_TO_JSVAL(false);
-        if(argc != 0)
-                return JS_FALSE;
-        printf(&quot;[JS]Setting smart copy mode (2)\n&quot;);
-        enterLock();
-        video_body-&gt;setEnv(ENV_EDITOR_SMART);
-        *rval = BOOLEAN_TO_JSVAL( true);
-        leaveLock();
-        return JS_TRUE;
-}
-/**
-    \fn setContainer
-bool jsArgToConfCouple(int nb,CONFcouple **conf,  jsval *argv);
-*/
-JSBool ADM_JSAvidemux::setContainer(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval)
-{
-
-        ADM_JSAvidemux *p = (ADM_JSAvidemux *)JS_GetPrivate(cx, obj);
-        // default return value
-        *rval = BOOLEAN_TO_JSVAL(false);
-        if(argc &lt; 1)
-                return JS_FALSE;
-        if(JSVAL_IS_STRING(argv[0]) == false)
-                return JS_FALSE;
-        char *str = JS_GetStringBytes(JSVAL_TO_STRING(argv[0]));
-        enterLock();
-        if(A_setContainer(str))
-        {
-            CONFcouple *c;
-            jsArgToConfCouple(argc-1,&amp;c,argv+1);
-            int idx=ADM_MuxerIndexFromName(str);
-            if(idx!=-1)
-            {
-                *rval = BOOLEAN_TO_JSVAL( ADM_mx_setExtraConf(idx,c));
-            }
-            if(c) delete c;
-        }
-        /* Now lockup extra params....*/
-        
-        leaveLock();
-        return JS_TRUE;
-}
-/**
-    \fn ADM_JSAvidemux
-    \brief Select the current container from a string
-*/
-bool A_setContainer(const char *cont)
-{
-    int idx=ADM_MuxerIndexFromName(cont);
-    if(idx==-1)
-    {
-        ADM_error(&quot;Cannot find muxer for format=%s\n&quot;,cont);
-        return false;
-    }
-    UI_SetCurrentFormat(idx);
-    return true;
-}
-//EOF

Deleted: branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script/ADM_JSAvidemux.h
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script/ADM_JSAvidemux.h	2010-02-18 06:18:53 UTC (rev 5938)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script/ADM_JSAvidemux.h	2010-02-20 07:52:21 UTC (rev 5939)
@@ -1,63 +0,0 @@
-#ifndef _ADM_JSAVIDEMUX_H
-#define _ADM_JSAVIDEMUX_H
-
-#pragma once
-
-
-// Spidermonkey
-#include &quot;ADM_smjs/jsapi.h&quot;
-#include &quot;ADM_Avidemux.h&quot;
-class ADM_JSAvidemux
-{
-public:
-	ADM_JSAvidemux(void) : m_pObject(NULL) {}
-	virtual ~ADM_JSAvidemux(void);
-
-	static JSBool JSGetProperty(JSContext *cx, JSObject *obj, jsval id, jsval *vp);
-	static JSBool JSSetProperty(JSContext *cx, JSObject *obj, jsval id, jsval *vp);
-	static JSBool JSConstructor(JSContext *cx, JSObject *obj, uintN argc, 
-								jsval *argv, jsval *rval);
-	static void JSDestructor(JSContext *cx, JSObject *obj);
-	static JSObject *JSInit(JSContext *cx, JSObject *obj, JSObject *proto = NULL);
-	static JSBool Load(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval);
-	static JSBool Append(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval);
-	static JSBool Delete(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval);
-	static JSBool Save(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval);
-	static JSBool Exit(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval);
-/*	static JSBool SaveDVD(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval);
-	static JSBool SaveOGM(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval);*/
-	static JSBool GoToTime(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval);
-	static JSBool LoadFilters(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval);
-        static JSBool ClearSegments(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval);
-        static JSBool AddSegment(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval);
-        static JSBool forceUnpack(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval);
-        static JSBool setContainer(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval);
-        static JSBool rebuildIndex(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval);
-        static JSBool smartcopyMode(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval);
-
-        
-
-	static JSPropertySpec avidemux_properties[];
-	static JSFunctionSpec avidemux_methods[];
-	enum
-	{
-		markerA_prop,
-		markerB_prop,
-		video_prop,
-		audio_prop,
-		container_prop,
-		currentframe_prop,
-		fps_prop
-	};
-	static JSClass m_classAvidemux;
-
-//protected:
-	void setObject(ADM_Avidemux *pObject);
-	ADM_Avidemux *getObject();
-
-private:
-	ADM_Avidemux *m_pObject;
-
-};
-
-#endif

Deleted: branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script/ADM_JSAvidemuxAudio.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script/ADM_JSAvidemuxAudio.cpp	2010-02-18 06:18:53 UTC (rev 5938)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script/ADM_JSAvidemuxAudio.cpp	2010-02-20 07:52:21 UTC (rev 5939)
@@ -1,588 +0,0 @@
-// C++ Interface: Spider Monkey interface
-//
-// Description: 
-//
-//
-// Author: Anish Mistry
-//      Some modification by mean
-//
-// Copyright: See COPYING file that comes with this distribution
-//
-//
-
-#include &quot;ADM_default.h&quot;
-
-#include &quot;ADM_JSGlobal.h&quot;
-#include &quot;ADM_JSAvidemuxAudio.h&quot;
-
-#include &quot;ADM_commonUI/GUI_ui.h&quot;
-#include &quot;avi_vars.h&quot;
-#include &quot;gui_action.hxx&quot;
-
-#include &quot;ADM_editor/ADM_outputfmt.h&quot;
-#include &quot;ADM_script/ADM_container.h&quot;
-#include &quot;ADM_audioFilter/include/ADM_audioFilterInterface.h&quot;
-#include &quot;audioEncoderApi.h&quot;
-
-
-
-extern int A_audioSave(char *name);
-extern int A_loadAC3 (char *name);
-extern int A_loadMP3 (char *name);
-extern int A_loadWave (char *name);
-extern void HandleAction(Action act);
-
-bool jsArgToConfCouple(int nb,CONFcouple **conf,  jsval *argv);
-
-JSPropertySpec ADM_JSAvidemuxAudio::avidemuxaudio_properties[] = 
-{ 
-
-        { &quot;resample&quot;, resample_prop, JSPROP_ENUMERATE },	// resample
-        { &quot;delay&quot;, delay_prop, JSPROP_ENUMERATE },	// set audio delay
-        { &quot;film2pal&quot;, film2pal_prop, JSPROP_ENUMERATE },	// convert film to pal
-        { &quot;pal2film&quot;, pal2film_prop, JSPROP_ENUMERATE },	// convert pal to film
-        { &quot;normalizeMode&quot;, normalizemode_prop, JSPROP_ENUMERATE },	//
-        { &quot;drc&quot;, drc_prop, JSPROP_ENUMERATE },	//
-        { &quot;normalizeValue&quot;, normalizevalue_prop, JSPROP_ENUMERATE },	//
-        { 0 }
-};
-
-JSFunctionSpec ADM_JSAvidemuxAudio::avidemuxaudio_methods[] = 
-{
-        { &quot;save&quot;, Save, 1, 0, 0 },	// save audio stream
-        { &quot;load&quot;, Load, 2, 0, 0 },	// load audio stream
-        { &quot;reset&quot;, Reset, 0, 0, 0 },	// reset audio stream
-        { &quot;codec&quot;, Codec, 4, 0, 0 },	// set output codec
-        { &quot;getNbTracks&quot;, getNbTracks, 0, 0, 0 },    // set output codec
-        { &quot;setTrack&quot;, setTrack, 1, 0, 0 },    // set output codec
-        { &quot;secondAudioTrack&quot;, secondAudioTrack, 2, 0, 0 },    // set audio track
-        { &quot;mixer&quot;, mixer, 1, 0, 0 },    // set mixer configuration
-        { &quot;getNbChannels&quot;, getNbChannels, 1, 0, 0 },
-        { &quot;getBitrate&quot;, getBitrate, 1, 0, 0 },
-        { 0 }
-};
-//*******************************
-JSPropertySpec *ADM_JsAudioGetProperties(void)
-{
-    return ADM_JSAvidemuxAudio::avidemuxaudio_properties;
-}
-JSFunctionSpec *ADM_JsAudioGetFunctions(void)
-{
-    return ADM_JSAvidemuxAudio::avidemuxaudio_methods;
-}
-//*******************************
-JSClass ADM_JSAvidemuxAudio::m_classAvidemuxAudio = 
-{
-        &quot;AvidemuxAudio&quot;, JSCLASS_HAS_PRIVATE,
-        JS_PropertyStub, JS_PropertyStub,
-        ADM_JSAvidemuxAudio::JSGetProperty, ADM_JSAvidemuxAudio::JSSetProperty,
-        JS_EnumerateStub, JS_ResolveStub, 
-        JS_ConvertStub, ADM_JSAvidemuxAudio::JSDestructor
-};
-
-ADM_JSAvidemuxAudio::~ADM_JSAvidemuxAudio(void)
-{
-        if(m_pObject != NULL)
-                delete m_pObject;
-        m_pObject = NULL;
-}
-
-void ADM_JSAvidemuxAudio::setObject(ADM_AvidemuxAudio *pObject)
-{
-        m_pObject = pObject; 
-}
-        
-ADM_AvidemuxAudio *ADM_JSAvidemuxAudio::getObject()
-{
-        return m_pObject; 
-}
-
-JSObject *ADM_JSAvidemuxAudio::JSInit(JSContext *cx, JSObject *obj, JSObject *proto)
-{
-        JSObject *newObj = JS_InitClass(cx, obj, proto, &amp;m_classAvidemuxAudio, 
-                                                                        ADM_JSAvidemuxAudio::JSConstructor, 0,
-                                                                        ADM_JSAvidemuxAudio::avidemuxaudio_properties, ADM_JSAvidemuxAudio::avidemuxaudio_methods,
-                                                                        NULL, NULL);
-        return newObj;
-}
-
-JSBool ADM_JSAvidemuxAudio::JSConstructor(JSContext *cx, JSObject *obj, uintN argc, 
-                                                                jsval *argv, jsval *rval)
-{
-        if(argc != 0)
-                return JS_FALSE;
-        ADM_JSAvidemuxAudio *p = new ADM_JSAvidemuxAudio();
-        ADM_AvidemuxAudio *pObject = new ADM_AvidemuxAudio();
-        p-&gt;setObject(pObject);
-        if ( ! JS_SetPrivate(cx, obj, p) )
-                return JS_FALSE;
-        *rval = OBJECT_TO_JSVAL(obj);
-        return JS_TRUE;
-}
-
-void ADM_JSAvidemuxAudio::JSDestructor(JSContext *cx, JSObject *obj)
-{
-        ADM_JSAvidemuxAudio *p = (ADM_JSAvidemuxAudio *)JS_GetPrivate(cx, obj);
-        if(p != NULL)
-                delete p;
-        p = NULL;
-}
-
-JSBool ADM_JSAvidemuxAudio::JSGetProperty(JSContext *cx, JSObject *obj, jsval id, jsval *vp)
-{
-        if (JSVAL_IS_INT(id)) 
-        {
-                ADM_JSAvidemuxAudio *priv = (ADM_JSAvidemuxAudio *) JS_GetPrivate(cx, obj);
-                switch(JSVAL_TO_INT(id))
-                {
-                        case resample_prop:
-                                *vp=INT_TO_JSVAL(audioFilterGetResample());
-                                break;
-                        case delay_prop:
-//                                *vp = INT_TO_JSVAL(priv-&gt;getObject()-&gt;m_nDelay);
-                                break;
-                        case film2pal_prop:
-//                                *vp = BOOLEAN_TO_JSVAL(priv-&gt;getObject()-&gt;m_bFilm2PAL);
-                                break;
-                        case pal2film_prop:
-//                                *vp = BOOLEAN_TO_JSVAL(priv-&gt;getObject()-&gt;m_bPAL2Film);
-                                break;
-                        case normalizemode_prop:
-//                              *vp = BOOLEAN_TO_JSVAL(priv-&gt;getObject()-&gt;m_nNormalizeMode);
-                              break;
-                        case normalizevalue_prop:
-//                          *vp = BOOLEAN_TO_JSVAL(priv-&gt;getObject()-&gt;m_nNormalizeValue);
-                          break;
-                        case drc_prop:
-//                            *vp = BOOLEAN_TO_JSVAL(priv-&gt;getObject()-&gt;m_bDRC);
-                            break;
-/*
-                        case audio_prop:
-                                *vp = OBJECT_TO_JSVAL(priv-&gt;getObject()-&gt;m_pAudio);
-                                break;
-*/
-                }
-        }
-        return JS_TRUE;
-}
-
-JSBool ADM_JSAvidemuxAudio::JSSetProperty(JSContext *cx, JSObject *obj, jsval id, jsval *vp)
-{
-        if (JSVAL_IS_INT(id)) 
-        {
-                
-                ADM_JSAvidemuxAudio *priv = (ADM_JSAvidemuxAudio *) JS_GetPrivate(cx, obj);
-                switch(JSVAL_TO_INT(id))
-                {
-#if 0                     
-                        case drc_prop:
-                        {
-                                if(JSVAL_IS_BOOLEAN(*vp) == false)
-                                        break;
-                                priv-&gt;getObject()-&gt;m_bDRC = JSVAL_TO_BOOLEAN(*vp);
-                                enterLock();
-                                audioFilterDrc(priv-&gt;getObject()-&gt;m_bDRC);
-                                leaveLock();
-                                break;
-                        }
-                       
-                        case delay_prop:
-                        {
-                                if(JSVAL_IS_INT(*vp) == false)
-                                        break;
-                                priv-&gt;getObject()-&gt;m_nDelay = JSVAL_TO_INT(*vp);
-                                //audioFilterDelay(priv-&gt;getObject()-&gt;m_nDelay);
-                                enterLock();
-                                //UI_setTimeShift(1, priv-&gt;getObject()-&gt;m_nDelay); 
-                                leaveLock();
-                                break;
-                        }
-                        case film2pal_prop:
-                        {
-                                if(JSVAL_IS_BOOLEAN(*vp) == false)
-                                        break;
-                                priv-&gt;getObject()-&gt;m_bFilm2PAL = JSVAL_TO_BOOLEAN(*vp);
-                                enterLock();
-                                audioFilterFilm2Pal(priv-&gt;getObject()-&gt;m_bFilm2PAL);
-                                leaveLock();
-                                break;
-                        }
-                        case pal2film_prop:
-                        {
-                                if(JSVAL_IS_BOOLEAN(*vp) == false)
-                                        break;
-                                priv-&gt;getObject()-&gt;m_bPAL2Film = JSVAL_TO_BOOLEAN(*vp);
-                                enterLock();
-                                audioFilterPal2Film(priv-&gt;getObject()-&gt;m_bPAL2Film);
-                                leaveLock();
-                                break;
-                        }
-                        case normalizemode_prop:
-                        {
-                                  enterLock();
-                                  priv-&gt;getObject()-&gt;m_nNormalizeMode = JSVAL_TO_INT(*vp);
-                                  audioFilterNormalizeMode(priv-&gt;getObject()-&gt;m_nNormalizeMode);
-                                  leaveLock();
-                                  break;
-                        }
-                        case normalizevalue_prop:
-                        {
-                                  priv-&gt;getObject()-&gt;m_nNormalizeValue = JSVAL_TO_INT(*vp);
-                                  enterLock();
-                                  audioFilterNormalizeValue(priv-&gt;getObject()-&gt;m_nNormalizeValue);
-                                  leaveLock();
-                                  break;
-                        }
-#endif
-
-                        case film2pal_prop:
-                        {
-                                if(JSVAL_IS_BOOLEAN(*vp) == false)
-                                        break;
-                                enterLock();
-                                if(JSVAL_TO_BOOLEAN(*vp)) 
-                                    audioFilterSetFrameRate(FILMCONV_FILM2PAL);
-                                else
-                                    audioFilterSetFrameRate(FILMCONV_NONE);
-                                leaveLock();
-                                break;
-                        }
-                        case pal2film_prop:
-                        {
-                                if(JSVAL_IS_BOOLEAN(*vp) == false)
-                                        break;
-                                enterLock();
-                                if(JSVAL_TO_BOOLEAN(*vp)) 
-                                    audioFilterSetFrameRate(FILMCONV_PAL2FILM);
-                                else
-                                    audioFilterSetFrameRate(FILMCONV_NONE);
-                                leaveLock();
-                                break;
-                        }
-                    case resample_prop:
-                        {
-                                if(JSVAL_IS_INT(*vp) == false)
-                                        break;
-                                enterLock();
-                                audioFilterSetResample(JSVAL_TO_INT(*vp));
-                                leaveLock();
-                                break;
-                        }
-                        default : printf(&quot;UNKNOWN AUDIO PROP\n&quot;);
-                        return JS_FALSE;
-                }
-        }
-
-        return JS_TRUE;
-}
-
-
-JSBool ADM_JSAvidemuxAudio::Save(JSContext *cx, JSObject *obj, uintN argc, 
-                                      jsval *argv, jsval *rval)
-{// begin Save
-        ADM_JSAvidemuxAudio *p = (ADM_JSAvidemuxAudio *)JS_GetPrivate(cx, obj);
-        // default return value
-        *rval = BOOLEAN_TO_JSVAL(false);
-        if(argc != 1)
-                return JS_FALSE;
-        if(JSVAL_IS_STRING(argv[0]) == false)
-                return JS_FALSE;
-        char *pTempStr = JS_GetStringBytes(JSVAL_TO_STRING(argv[0]));
-        printf(&quot;Saving Audio \&quot;%s\&quot;\n&quot;,pTempStr);
-        enterLock();
-        *rval = INT_TO_JSVAL(A_audioSave(pTempStr));
-        leaveLock();
-        return JS_TRUE;
-}// end Save
-
-JSBool ADM_JSAvidemuxAudio::Load(JSContext *cx, JSObject *obj, uintN argc, 
-                                      jsval *argv, jsval *rval)
-{// begin Load
-#if 0
-        ADM_JSAvidemuxAudio *p = (ADM_JSAvidemuxAudio *)JS_GetPrivate(cx, obj);
-        // default return value
-        *rval = BOOLEAN_TO_JSVAL(false);
-        if(argc != 2)
-                return JS_FALSE;
-        if(JSVAL_IS_STRING(argv[0]) == false || JSVAL_IS_STRING(argv[1]) == false)
-                return JS_FALSE;
-        char *pTempStr = JS_GetStringBytes(JSVAL_TO_STRING(argv[1]));
-        char *pArg0 = JS_GetStringBytes(JSVAL_TO_STRING(argv[0]));
-        printf(&quot;Loading Audio \&quot;%s\&quot;\n&quot;,pTempStr);
-
-        // 1st arg is type
-        AudioSource src;
-        int result=0;
-        
-        src=audioSourceFromString(pArg0);
-        if(!src) {printf(&quot;[Script]Invalid audiosource type\n&quot;);return JS_FALSE;}
-        enterLock();
-        switch(src)
-        {
-                case AudioAvi:
-                        result = A_changeAudioStream (aviaudiostream, AudioAvi,NULL);
-                        break;
-                case AudioMP3:
-                        result = A_loadMP3(pTempStr);
-                        break;
-                case AudioWav:
-                        result = A_loadWave(pTempStr);
-                        break;
-                case AudioAC3:
-                        result = A_loadAC3(pTempStr);
-                        break;
-                case AudioNone:
-                        result = A_changeAudioStream(NULL,AudioNone,NULL);
-                        break;
-                default:
-                        ADM_assert(0);
-                        break;
-        }
-        leaveLock()
-        printf(&quot;[script] &quot;);
-        
-        if(!result)
-                printf(&quot;failed :&quot;);
-        else
-                printf(&quot;succeed :&quot;);
-        printf(&quot; external source %d (%s) \n&quot;, src,pTempStr);
-
-        *rval = INT_TO_JSVAL(result);
-#endif
-        return JS_TRUE;
-}// end Load
-
-JSBool ADM_JSAvidemuxAudio::Reset(JSContext *cx, JSObject *obj, uintN argc, 
-                                      jsval *argv, jsval *rval)
-{// begin Reset
-        ADM_JSAvidemuxAudio *p = (ADM_JSAvidemuxAudio *)JS_GetPrivate(cx, obj);
-        // default return value
-        *rval = BOOLEAN_TO_JSVAL(false);
-        if(argc != 0)
-                return JS_FALSE;
-        enterLock();
-        audioFilterReset();
-        leaveLock()
-        *rval = BOOLEAN_TO_JSVAL(true);
-        return JS_TRUE;
-}// end Reset
-// app.audio.codec(&quot;lame&quot;,128,8,&quot;00 00 00 00 01 00 00 00 &quot;);
-extern uint8_t mk_hex (uint8_t a, uint8_t b);
-/**
-    \fn Codec
-*/
-JSBool ADM_JSAvidemuxAudio::Codec(JSContext *cx, JSObject *obj, uintN argc, 
-                                      jsval *argv, jsval *rval)
-{// begin Codec
-        ADM_JSAvidemuxAudio *p = (ADM_JSAvidemuxAudio *)JS_GetPrivate(cx, obj);
-        // default return value
-        *rval = BOOLEAN_TO_JSVAL(false);
-        if(argc &lt; 2)
-                return JS_FALSE;
-        if(JSVAL_IS_STRING(argv[0]) == false || JSVAL_IS_INT(argv[1]) == false )            return JS_FALSE;
-        for(int i=2;i&lt;argc;i++)  if(JSVAL_IS_STRING(argv[i]) == false) return JS_FALSE;
-
-        // Get Codec...
-        char *name = JS_GetStringBytes(JSVAL_TO_STRING(argv[0]));
-        ADM_LowerCase(name);
-        enterLock();
-        // First search the codec by its name
-        if(!audioCodecSetByName(name))
-        {
-                *rval = BOOLEAN_TO_JSVAL(false);
-                ADM_error(&quot;Cannot set audio codec %s\n&quot;,name);
-        }
-        else
-        {
-            // begin set bitrate
-            uint32_t bitrate=JSVAL_TO_INT(argv[1]);
-            // Construct couples
-            CONFcouple *c=NULL;
-            if(argc&gt;2)
-            {
-                int nb=argc-2;
-                jsArgToConfCouple( nb,&amp;c,  argv+2);
-            }
-            *rval = BOOLEAN_TO_JSVAL(setAudioExtraConf(bitrate,c));
-            if(c) delete c;
-        }
-
-        // end set bitrate
-        leaveLock();
-        return JS_TRUE;
-}// end Codec
-/**
-    \fn jsArgToConfCouple
-    \brief Convert js args to confcouple
-
-*/
-bool jsArgToConfCouple(int nb,CONFcouple **conf,  jsval *argv)
-{
-  *conf=NULL;
-  if(!nb) return true;
-  CONFcouple *c=new CONFcouple(nb);
-  *conf=c;
-    for(int i=0;i&lt;nb;i++)
-    {
-        char *param = JS_GetStringBytes(JSVAL_TO_STRING(argv[i]));
-        char *dupe=   ADM_strdup(param);
-        char *name,*value;
-        // dupe is in the form name=value
-        name=dupe;
-        value=name;
-        char *tail=dupe+strlen(dupe);
-        while(value&lt;tail)
-        {
-            if(*value=='=') 
-                {
-                    *value=0;
-                    value++;
-                    break;
-                }
-            value++;
-        }
-        c-&gt;setInternalName(name,value);
-        //printf(&quot;%s -&gt; [%s,%s]\n&quot;,param,name,value);
-        ADM_dezalloc(dupe);
-    }
-    return true;
-}
-
-JSBool ADM_JSAvidemuxAudio::getNbTracks(JSContext *cx, JSObject *obj, uintN argc, 
-                                      jsval *argv, jsval *rval)
-{
-uint32_t nb=0;
-audioInfo *infos=NULL;
-        // default return value
-        ADM_JSAvidemuxAudio *p = (ADM_JSAvidemuxAudio *)JS_GetPrivate(cx, obj);
-        if(argc != 0)
-                return JS_FALSE;
-        // default return value
-      
-        enterLock();
-        video_body-&gt;getAudioStreamsInfo(0,&amp;nb, &amp;infos);
-        leaveLock();
-        if(infos)
-                delete [] infos;
-        *rval = INT_TO_JSVAL(nb);
-        return JS_TRUE;
-}// end Codec
-JSBool ADM_JSAvidemuxAudio::setTrack(JSContext *cx, JSObject *obj, uintN argc, 
-                                      jsval *argv, jsval *rval)
-{
-uint32_t nb=0,nw=0;
-audioInfo *infos=NULL;
-        // default return value
-        ADM_JSAvidemuxAudio *p = (ADM_JSAvidemuxAudio *)JS_GetPrivate(cx, obj);
-
-        // default return value
-      if(argc != 1)
-                return JS_FALSE;
-        if(JSVAL_IS_INT(argv[0]) == false)
-                return JS_FALSE;
-        video_body-&gt;getAudioStreamsInfo(0,&amp;nb, &amp;infos);
-        delete [] infos;
-        nw=(JSVAL_TO_INT(argv[0]));
-        if(nw&gt;nb) return JS_FALSE;
-        enterLock();
-        video_body-&gt;changeAudioStream(0,nw);
-        leaveLock();
-        return JS_TRUE;
-}// end Codec
-JSBool ADM_JSAvidemuxAudio::secondAudioTrack(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval)
-{
-#if 0
-        ADM_JSAvidemuxAudio *p = (ADM_JSAvidemuxAudio *)JS_GetPrivate(cx, obj);
-        if(argc != 2)
-                return JS_FALSE;
-        if(JSVAL_IS_STRING(argv[0]) == false || JSVAL_IS_STRING(argv[1]) == false)
-                return JS_FALSE;
-        // First arg is MP3 etc...
-        char *name = JS_GetStringBytes(JSVAL_TO_STRING(argv[0]));
-        ADM_LowerCase(name);
-        // First search the codec by its name
-        AudioSource source;
-        if(AudioInvalid==(source=audioSourceFromString(name)))
-                return JS_FALSE;
-        // Now get the name
-        name = JS_GetStringBytes(JSVAL_TO_STRING(argv[1]));
-        enterLock();
-        if(A_setSecondAudioTrack(source,name))
-        {
-                leaveLock();
-                return JS_TRUE;
-        }
-        leaveLock();
-#endif
-      return JS_FALSE;
-}
-JSBool ADM_JSAvidemuxAudio::mixer(JSContext *cx, JSObject *obj, uintN argc, 
-                                      jsval *argv, jsval *rval)
-{
-uint32_t nb=0,nw=0;
-uint32_t *infos=NULL;
-        // default return value
-        ADM_JSAvidemuxAudio *p = (ADM_JSAvidemuxAudio *)JS_GetPrivate(cx, obj);
-
-        // default return value
-        if(argc != 1)
-                return JS_FALSE;
-        if(JSVAL_IS_STRING(argv[0]) == false) 
-                return JS_FALSE;
-        char *pArg0 = JS_GetStringBytes(JSVAL_TO_STRING(argv[0]));
-        enterLock();
-        CHANNEL_CONF c=AudioMuxerStringToId(pArg0);
-        *rval=BOOLEAN_TO_JSVAL(audioFilterSetMixer(c));
-        leaveLock();
-        return JS_TRUE;
-
-}// end Codec
-
-JSBool ADM_JSAvidemuxAudio::getNbChannels(JSContext *cx, JSObject *obj, uintN argc, 
-                                      jsval *argv, jsval *rval)
-{
-uint32_t nb=0, nw=0;
-audioInfo *infos=NULL;
-        // default return value
-        ADM_JSAvidemuxAudio *p = (ADM_JSAvidemuxAudio *)JS_GetPrivate(cx, obj);
-        if(argc != 1)
-                return JS_FALSE;
-        // default return value
-      
-        if(JSVAL_IS_INT(argv[0]) == false)
-                return JS_FALSE;
-        enterLock();
-        video_body-&gt;getAudioStreamsInfo(0,&amp;nb, &amp;infos);
-        leaveLock()
-        nw=(JSVAL_TO_INT(argv[0]));
-        if(nw&gt;nb)
-                return JS_FALSE;
-        *rval = INT_TO_JSVAL(infos[nw].channels);
-        delete [] infos;
-        return JS_TRUE;
-}// end Codec
-
-JSBool ADM_JSAvidemuxAudio::getBitrate(JSContext *cx, JSObject *obj, uintN argc, 
-                                      jsval *argv, jsval *rval)
-{
-uint32_t nb=0, nw=0;
-audioInfo *infos=NULL;
-        // default return value
-        ADM_JSAvidemuxAudio *p = (ADM_JSAvidemuxAudio *)JS_GetPrivate(cx, obj);
-        if(argc != 1)
-                return JS_FALSE;
-        // default return value
-      
-        if(JSVAL_IS_INT(argv[0]) == false)
-                return JS_FALSE;
-        enterLock();
-        video_body-&gt;getAudioStreamsInfo(0,&amp;nb, &amp;infos);
-        leaveLock()
-        nw=(JSVAL_TO_INT(argv[0]));
-        if(nw&gt;nb)
-                return JS_FALSE;
-        *rval = INT_TO_JSVAL(infos[nw].bitrate);
-        delete [] infos;
-        return JS_TRUE;
-}// end Codec
-

Deleted: branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script/ADM_JSAvidemuxAudio.h
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script/ADM_JSAvidemuxAudio.h	2010-02-18 06:18:53 UTC (rev 5938)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script/ADM_JSAvidemuxAudio.h	2010-02-20 07:52:21 UTC (rev 5939)
@@ -1,62 +0,0 @@
-#ifndef _ADM_JSAVIDEMUXAUDIO_H
-#define _ADM_JSAVIDEMUXAUDIO_H
-
-#pragma once
-
-
-
-// Spidermonkey
-#include &quot;ADM_smjs/jsapi.h&quot;
-#include &quot;ADM_AvidemuxAudio.h&quot;
-
-class ADM_JSAvidemuxAudio
-{
-public:
-	ADM_JSAvidemuxAudio(void) : m_pObject(NULL) {}
-	virtual ~ADM_JSAvidemuxAudio(void);
-
-	static JSBool JSGetProperty(JSContext *cx, JSObject *obj, jsval id, jsval *vp);
-	static JSBool JSSetProperty(JSContext *cx, JSObject *obj, jsval id, jsval *vp);
-	static JSBool JSConstructor(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval);
-	static void JSDestructor(JSContext *cx, JSObject *obj);
-	static JSObject *JSInit(JSContext *cx, JSObject *obj, JSObject *proto = NULL);
-	static JSBool ScanVBR(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval);
-	static JSBool Save(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval);
-	static JSBool Load(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval);
-	static JSBool Reset(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval);
-	static JSBool Codec(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval);
-    static JSBool getNbTracks(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval);
-    static JSBool setTrack(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval);
-    static JSBool lamePreset(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval);
-    static JSBool mixer(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval);
-    static JSBool secondAudioTrack(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval);
-    static JSBool getNbChannels(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval);
-    static JSBool getBitrate(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval);
-
-	static JSPropertySpec avidemuxaudio_properties[];
-	static JSFunctionSpec avidemuxaudio_methods[];
-	enum
-	{
-        audioprocess_prop,
-		resample_prop,
-		delay_prop,
-		film2pal_prop,
-		pal2film_prop,
-        normalizemode_prop,
-        normalizevalue_prop,
-        drc_prop
-	};
-	static JSClass m_classAvidemuxAudio;
-        
-
-
-//protected:
-	void setObject(ADM_AvidemuxAudio *pObject);
-	ADM_AvidemuxAudio *getObject();
-
-private:
-	ADM_AvidemuxAudio *m_pObject;
-
-};
-
-#endif

Deleted: branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script/ADM_JSAvidemuxVideo.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script/ADM_JSAvidemuxVideo.cpp	2010-02-18 06:18:53 UTC (rev 5938)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script/ADM_JSAvidemuxVideo.cpp	2010-02-20 07:52:21 UTC (rev 5939)
@@ -1,579 +0,0 @@
-//
-// C++ Interface: Spider Monkey interface
-//
-// Description: 
-//
-//
-// Author: Anish Mistry
-//      Some modification by mean
-//
-// Copyright: See COPYING file that comes with this distribution
-//
-//
-#include &quot;ADM_default.h&quot;
-
-#include &quot;ADM_JSAvidemuxVideo.h&quot;
-#include &quot;ADM_JSGlobal.h&quot;
-
-
-#include &quot;ADM_commonUI/GUI_ui.h&quot;
-#include &quot;avi_vars.h&quot;
-#include &quot;gui_action.hxx&quot;
-
-
-#include &quot;ADM_editor/ADM_outputfmt.h&quot;
-#include &quot;ADM_commonUI/GUI_ui.h&quot;
-#include &quot;ADM_script/ADM_container.h&quot;
-#include &quot;ADM_videoEncoderApi.h&quot;
-#include &quot;ADM_videoFilterApi.h&quot;
-#include &quot;ADM_videoFilters.h&quot;
-#include &quot;ADM_confCouple.h&quot;
-extern uint8_t A_ListAllBlackFrames( char *file );
-extern uint8_t ADM_saveRaw (const char *name);
-extern int A_saveJpg (char *name);
-extern void filterCleanUp( void );
-extern bool jsArgToConfCouple(int nb,CONFcouple **conf,  jsval *argv);
-bool A_setVideoCodec(const char *nm);
-
-
-JSPropertySpec ADM_JSAvidemuxVideo::avidemuxvideo_properties[] = 
-{ 
-       
-	{ 0 }
-};
-
-JSFunctionSpec ADM_JSAvidemuxVideo::avidemuxvideo_methods[] = 
-{
-	{ &quot;clear&quot;, Clear, 0, 0, 0 },	// clear
-    { &quot;clearFilters&quot;, ClearFilters, 0, 0, 0 }, // Delete all filters
-	{ &quot;addFilter&quot;, AddFilter, 10, 0, 0 },	// Add filter to filter chain
-	{ &quot;codec&quot;, Codec, 1, 0, 0 },	// Set the video codec
-	{ &quot;save&quot;, Save, 1, 0, 0 },	// save video portion of the stream
-	{ &quot;saveJpeg&quot;, SaveJPEG, 1, 0, 0 },	// save the current frame as a JPEG
-	{ &quot;listBlackFrames&quot;, ListBlackFrames, 1, 0, 0 },	// output a list of the black frame to a file
-	{ &quot;setPostProc&quot;, PostProcess, 3, 0, 0 },	// Postprocess
-    { &quot;setFps1000&quot;, SetFps1000, 1, 0, 0 },        // Postprocess
-    { &quot;getFps1000&quot;, GetFps1000, 0, 0, 0 },        // Postprocess
-    { &quot;getNbFrames&quot;, GetNbFrames, 0, 0, 0 },        // Postprocess
-    { &quot;getWidth&quot;, GetWidth, 0, 0, 0 },        // Postprocess
-    { &quot;getHeight&quot;, GetHeight, 0, 0, 0 },        // Postprocess
-    { &quot;getFCC&quot;, GetFCC, 0, 0, 0 },        // Postprocess
-    { &quot;isVopPacked&quot;, isVopPacked, 0, 0, 0 },        // Postprocess
-    { &quot;hasQpel&quot;, hasQpel, 0, 0, 0 },        // Postprocess
-    { &quot;hasGmc&quot;, hasGmc, 0, 0, 0 },        // Postprocess
-    { &quot;frameSize&quot;, getFrameSize, 1, 0, 0 },        // FrameSize
-    { &quot;frameType&quot;, getFrameType, 1, 0, 0 },        // Postprocess
-	{ 0 }
-};
-/*********************************/
-JSPropertySpec *ADM_JsVideoGetProperties(void)
-{
-    return ADM_JSAvidemuxVideo::avidemuxvideo_properties;
-}
-JSFunctionSpec *ADM_JsVideoGetFunctions(void)
-{
-    return ADM_JSAvidemuxVideo::avidemuxvideo_methods;
-}
-/*********************************/
-JSClass ADM_JSAvidemuxVideo::m_classAvidemuxVideo = 
-{
-	&quot;AvidemuxVideo&quot;, JSCLASS_HAS_PRIVATE,
-	JS_PropertyStub, JS_PropertyStub,
-	ADM_JSAvidemuxVideo::JSGetProperty, ADM_JSAvidemuxVideo::JSSetProperty,
-	JS_EnumerateStub, JS_ResolveStub, 
-	JS_ConvertStub, ADM_JSAvidemuxVideo::JSDestructor
-};
-
-ADM_JSAvidemuxVideo::~ADM_JSAvidemuxVideo(void)
-{
-	if(m_pObject != NULL)
-		delete m_pObject;
-	m_pObject = NULL;
-}
-
-void ADM_JSAvidemuxVideo::setObject(ADM_AvidemuxVideo *pObject)
-{
-	m_pObject = pObject; 
-}
-	
-ADM_AvidemuxVideo *ADM_JSAvidemuxVideo::getObject()
-{
-	return m_pObject; 
-}
-
-JSObject *ADM_JSAvidemuxVideo::JSInit(JSContext *cx, JSObject *obj, JSObject *proto)
-{
-        JSObject *newObj = JS_InitClass(cx, obj, proto, &amp;m_classAvidemuxVideo, 
-                                        ADM_JSAvidemuxVideo::JSConstructor, 0,
-                                        ADM_JSAvidemuxVideo::avidemuxvideo_properties, ADM_JSAvidemuxVideo::avidemuxvideo_methods,
-                                        NULL, NULL);
-	return newObj;
-}
-
-JSBool ADM_JSAvidemuxVideo::JSConstructor(JSContext *cx, JSObject *obj, uintN argc, 
-								 jsval *argv, jsval *rval)
-{
-        if(argc != 0)
-                return JS_FALSE;
-        ADM_JSAvidemuxVideo *p = new ADM_JSAvidemuxVideo();
-        ADM_AvidemuxVideo *pObject = new ADM_AvidemuxVideo();
-        p-&gt;setObject(pObject);
-        if ( ! JS_SetPrivate(cx, obj, p) )
-                return JS_FALSE;
-        *rval = OBJECT_TO_JSVAL(obj);
-        return JS_TRUE;
-}
-
-void ADM_JSAvidemuxVideo::JSDestructor(JSContext *cx, JSObject *obj)
-{
-        ADM_JSAvidemuxVideo *p = (ADM_JSAvidemuxVideo *)JS_GetPrivate(cx, obj);
-        if(p != NULL)
-                delete p;
-        p = NULL;
-}
-
-JSBool ADM_JSAvidemuxVideo::JSGetProperty(JSContext *cx, JSObject *obj, jsval id, jsval *vp)
-{
-        if (JSVAL_IS_INT(id)) 
-        {
-                ADM_JSAvidemuxVideo *priv = (ADM_JSAvidemuxVideo *) JS_GetPrivate(cx, obj);
-                switch(JSVAL_TO_INT(id))
-                {
-                        case videoprocess_prop:
-                                *vp = BOOLEAN_TO_JSVAL(priv-&gt;getObject()-&gt;m_bVideoProcess);
-                                break;
-                }
-        }
-        return JS_TRUE;
-}
-
-JSBool ADM_JSAvidemuxVideo::JSSetProperty(JSContext *cx, JSObject *obj, jsval id, jsval *vp)
-{
-        if (JSVAL_IS_INT(id)) 
-        {
-                ADM_JSAvidemuxVideo *priv = (ADM_JSAvidemuxVideo *) JS_GetPrivate(cx, obj);
-                switch(JSVAL_TO_INT(id))
-                {
-                        case videoprocess_prop:
-                                if(JSVAL_IS_BOOLEAN(*vp) == false)
-                                        break;
-                                priv-&gt;getObject()-&gt;m_bVideoProcess = JSVAL_TO_BOOLEAN(*vp);
-                                UI_setVProcessToggleStatus(priv-&gt;getObject()-&gt;m_bVideoProcess);
-                                break;
-                }
-        }
-        return JS_TRUE;
-}
-
-JSBool ADM_JSAvidemuxVideo::Clear(JSContext *cx, JSObject *obj, uintN argc, 
-                                       jsval *argv, jsval *rval)
-{// begin Clear
-        ADM_JSAvidemuxVideo *p = (ADM_JSAvidemuxVideo *)JS_GetPrivate(cx, obj);
-        // default return value
-        *rval = BOOLEAN_TO_JSVAL(false);
-        if(argc != 0)
-                return JS_FALSE;
-        printf(&quot;Clearing Video... \n&quot;);
-        enterLock();
-//        *rval = BOOLEAN_TO_JSVAL(video_body-&gt;deleteAllSegments());
-        leaveLock();
-        return JS_TRUE;
-}// end Clear
-
-
-JSBool ADM_JSAvidemuxVideo::ClearFilters(JSContext *cx, JSObject *obj, uintN argc,
-                                       jsval *argv, jsval *rval)
-{// begin Clear
-//	filterCleanUp();
-        return JS_TRUE;
-}// end Clear
-
-/**
-    \fn AddFilter
-*/
-JSBool ADM_JSAvidemuxVideo::AddFilter(JSContext *cx, JSObject *obj, uintN argc, 
-                                       jsval *argv, jsval *rval)
-{// begin AddFilter
-
-        uint32_t filterTag;
-
-        // default return value
-        *rval = BOOLEAN_TO_JSVAL(false);
-        if(argc == 0)
-                return JS_FALSE;
-        char *filterName=JS_GetStringBytes(JSVAL_TO_STRING(argv[0]));
-        filterTag = ADM_vf_getTagFromInternalName(filterName);
-        ADM_info(&quot;Adding Filter %s -&gt; %&quot;LU&quot;... \n&quot;,filterName,filterTag);
-
-        enterLock();
-        CONFcouple *c=NULL;
-        if(argc)
-            jsArgToConfCouple(argc-1,&amp;c,argv+1);
-        *rval=BOOLEAN_TO_JSVAL(  ADM_vf_addFilterFromTag(filterTag,c,false));
-        if(c) delete c;
-        leaveLock();
-        return JS_TRUE;
-}// end AddFilter
-/**
-    \fn Codec
-*/
-JSBool ADM_JSAvidemuxVideo::Codec(JSContext *cx, JSObject *obj, uintN argc, 
-                                       jsval *argv, jsval *rval)
-{// begin Codec
-        *rval = BOOLEAN_TO_JSVAL(false);
-        if(argc &lt;1)
-                return JS_FALSE;
-        if(JSVAL_IS_STRING(argv[0]) == false )
-        {
-                ADM_error(&quot;Cannot set codec\n&quot;);
-                return JS_FALSE;
-        }
-        char *codec=JS_GetStringBytes(JSVAL_TO_STRING(argv[0]));
-        // Set codec.
-        enterLock();
-        if(A_setVideoCodec(codec)==false)
-        {
-            ADM_error(&quot;Could not select codec %s\n&quot;,codec);
-            leaveLock();
-            return JS_FALSE;
-        }
-        CONFcouple *c;
-        jsArgToConfCouple(argc-1,&amp;c,argv+1);
-        *rval = BOOLEAN_TO_JSVAL( videoEncoder6_SetConfiguration(c));
-        ADM_info(&quot;Selected codec %s\n&quot;,codec);
-        if(c) delete c;
-        leaveLock();
-
-        return JS_TRUE;
-}// end Codec
-
-/**
-    \fn Save
-*/
-JSBool ADM_JSAvidemuxVideo::Save(JSContext *cx, JSObject *obj, uintN argc, 
-                                       jsval *argv, jsval *rval)
-{// begin Save
-        // default return value
-        *rval = BOOLEAN_TO_JSVAL(false);
-#if 0
-        if(argc != 1)
-                return JS_FALSE;
-        if(JSVAL_IS_STRING(argv[0]) == false)
-                return JS_FALSE;
-        char *pTempStr = JS_GetStringBytes(JSVAL_TO_STRING(argv[0]));
-        printf(&quot;Saving Video \&quot;%s\&quot;\n&quot;,pTempStr);
-        enterLock();
-        *rval = INT_TO_JSVAL(ADM_saveRaw(pTempStr));
-        leaveLock();
-#endif
-        return JS_TRUE;
-}// end Save
-/**
-    \fn saveJpeg
-*/
-JSBool ADM_JSAvidemuxVideo::SaveJPEG(JSContext *cx, JSObject *obj, uintN argc, 
-                                       jsval *argv, jsval *rval)
-{// begin SaveJPG
-        // default return value
-        *rval = BOOLEAN_TO_JSVAL(false);
-#if 0
-        if(argc != 1)
-                return JS_FALSE;
-        if(JSVAL_IS_STRING(argv[0]) == false)
-                return JS_FALSE;
-        char *pTempStr = JS_GetStringBytes(JSVAL_TO_STRING(argv[0]));
-        printf(&quot;Saving JPEG \&quot;%s\&quot;\n&quot;,pTempStr);
-        enterLock();
-        *rval = INT_TO_JSVAL(A_saveJpg(pTempStr));
-        leaveLock();
-#endif
-        return JS_TRUE;
-}// end SaveJPG
-/**
-    \fn ListBlackFrames
-*/
-JSBool ADM_JSAvidemuxVideo::ListBlackFrames(JSContext *cx, JSObject *obj, uintN argc, 
-                                       jsval *argv, jsval *rval)
-{// begin ListBlackFrames
-        
-        // default return value
-        *rval = BOOLEAN_TO_JSVAL(false);
-#if 0
-        if(argc != 1)
-          return JS_FALSE;
-        if(JSVAL_IS_STRING(argv[0]) == false)
-          return JS_FALSE;
-        
-        enterLock();
-        A_ListAllBlackFrames(JS_GetStringBytes(JSVAL_TO_STRING(argv[0])));
-        leaveLock();
-        *rval = BOOLEAN_TO_JSVAL(true);
-#endif
-        return JS_TRUE;
-}// end ListBlackFrames
-/**
-    \fn PostProcess
-*/
-JSBool ADM_JSAvidemuxVideo::PostProcess(JSContext *cx, JSObject *obj, uintN argc, 
-                                       jsval *argv, jsval *rval)
-{// begin PostProcess
-        // default return value
-        *rval = BOOLEAN_TO_JSVAL(false);
-        if(argc != 3)
-                return JS_FALSE;
-        if(JSVAL_IS_INT(argv[0]) == false || JSVAL_IS_INT(argv[1]) == false || JSVAL_IS_INT(argv[2]) == false)
-                return JS_FALSE;
-        
-        enterLock();
-        int rtn =video_body-&gt;setPostProc(
-            JSVAL_TO_INT(argv[0]),JSVAL_TO_INT(argv[1]),JSVAL_TO_INT(argv[2]));
-        leaveLock();
-        *rval = BOOLEAN_TO_JSVAL(rtn);
-        return JS_TRUE;
-}// end PostProcess
-/**
-    \fn GetFps1000
-*/
-JSBool ADM_JSAvidemuxVideo::GetFps1000(JSContext *cx, JSObject *obj, uintN argc, 
-                                       jsval *argv, jsval *rval)
-{// begin PostProcess
-aviInfo info;
-        if(argc != 0)
-          return JS_FALSE;
-        
-        enterLock();
-        video_body-&gt;getVideoInfo(&amp;info);
-        leaveLock();
-        
-        *rval = INT_TO_JSVAL(info.fps1000);
-        return JS_TRUE;
-}// end PostProcess
-/**
-    \fn GetNbFrames
-*/
-JSBool ADM_JSAvidemuxVideo::GetNbFrames(JSContext *cx, JSObject *obj, uintN argc, 
-                                       jsval *argv, jsval *rval)
-{// begin PostProcess
-aviInfo info;
-        if(argc != 0)
-          return JS_FALSE;
-        
-        enterLock();
-        video_body-&gt;getVideoInfo(&amp;info);
-        leaveLock();
-        
-        *rval = INT_TO_JSVAL(info.nb_frames);
-        return JS_TRUE;
-}// end PostProcess
-/**
-    \fn SetFps1000
-*/
-JSBool ADM_JSAvidemuxVideo::SetFps1000(JSContext *cx, JSObject *obj, uintN argc, 
-                                       jsval *argv, jsval *rval)
-{// begin PostProcess
-int fps;
-aviInfo info;
-
-        if(argc != 1)
-          return JS_FALSE;
-        if(JSVAL_IS_INT(argv[0]) == false)
-          return JS_FALSE;
-
-        enterLock();
-        video_body-&gt;getVideoInfo(&amp;info);
-        video_body-&gt;getVideoInfo (avifileinfo);
-
-
-        // default return value
-        fps=JSVAL_TO_INT(argv[0]);
-        if(fps&gt;100000 || fps&lt;2000)
-        {      
-                printf(&quot;Fps too low\n&quot;);
-                leaveLock();
-                return JS_FALSE;
-        }       
- 	
-       info.fps1000=fps;
-        video_body-&gt;updateVideoInfo(&amp;info);
-        video_body-&gt;getVideoInfo (avifileinfo);
-        
-	leaveLock();
-        return JS_TRUE;
-}// end PostProcess
-
-/**
-    \fn GetWidth
-*/
-JSBool ADM_JSAvidemuxVideo::GetWidth(JSContext *cx, JSObject *obj, uintN argc, 
-                                       jsval *argv, jsval *rval)
-{// begin PostProcess
-aviInfo info;
-        if(argc != 0)
-          return JS_FALSE;
-
-
-        enterLock();
-        video_body-&gt;getVideoInfo(&amp;info);
-        leaveLock();
-        
-        *rval = INT_TO_JSVAL(info.width);
-        return JS_TRUE;
-}// end PostProcess
-/**
-    \fn SetFps1000
-*/
-JSBool ADM_JSAvidemuxVideo::GetHeight(JSContext *cx, JSObject *obj, uintN argc, 
-                                       jsval *argv, jsval *rval)
-{// begin PostProcess
-aviInfo info;
-        if(argc != 0)
-          return JS_FALSE;
-
-        enterLock();
-        video_body-&gt;getVideoInfo(&amp;info);
-        leaveLock();
-        
-        *rval = INT_TO_JSVAL(info.height);
-        return JS_TRUE;
-}// end PostProcess
-/**
-    \fn GetFCC
-*/
-
-JSBool ADM_JSAvidemuxVideo::GetFCC(JSContext *cx, JSObject *obj, uintN argc, 
-                                       jsval *argv, jsval *rval)
-{// begin PostProcess
-aviInfo info;
-
-        if(argc != 0)
-          return JS_FALSE;
-
-        enterLock();
-        video_body-&gt;getVideoInfo(&amp;info);
-        leaveLock();
-        
-        *rval = STRING_TO_JSVAL(JS_NewStringCopyZ(cx, fourCC::tostring(info.fcc)));
-        return JS_TRUE;
-}// end PostProcess
-/**
-    \fn SetFps1000
-*/
-
-JSBool ADM_JSAvidemuxVideo::isVopPacked(JSContext *cx, JSObject *obj, uintN argc, 
-                                       jsval *argv, jsval *rval)
-{// begin PostProcess
-int32_t info;
-        if(argc != 0)
-          return JS_FALSE;
-
-      enterLock();
-       info=video_body-&gt;getSpecificMpeg4Info();
-       leaveLock();
-         
-        // default return value
-        *rval=JS_FALSE;
-        //if(info &amp; ADM_VOP_ON) *rval=JS_TRUE;
-        return JS_TRUE;
-}// end PostProcess
-/**
-    \fn hasGmc
-*/
-
-JSBool ADM_JSAvidemuxVideo::hasGmc(JSContext *cx, JSObject *obj, uintN argc, 
-                                       jsval *argv, jsval *rval)
-{// begin PostProcess
-uint32_t info;
-        if(argc != 0)
-          return JS_FALSE;
-
-       enterLock();
-       info=video_body-&gt;getSpecificMpeg4Info();
-       leaveLock(); 
-        
-        // default return value
-        *rval=JS_FALSE;
-        //if(info &amp; ADM_GMC_ON) *rval=JS_TRUE;
-        return JS_TRUE;
-}// end PostProcess
-/**
-    \fn hasQpel
-*/
-
-JSBool ADM_JSAvidemuxVideo::hasQpel(JSContext *cx, JSObject *obj, uintN argc, 
-                                       jsval *argv, jsval *rval)
-{// begin PostProcess
-uint32_t info;
-        if(argc != 0)
-          return JS_FALSE;
-        
-        enterLock();
-        info=video_body-&gt;getSpecificMpeg4Info();
-        leaveLock(); 
-        
-        *rval=JS_FALSE;
-        //if(info &amp; ADM_QPEL_ON) *rval=JS_TRUE;
-        return JS_TRUE;
-}// end PostProcess
-
-/**
-    \fn getFrameSize
-*/
-
-JSBool ADM_JSAvidemuxVideo::getFrameSize(JSContext *cx, JSObject *obj, uintN argc, 
-                                       jsval *argv, jsval *rval)
-{// begin PostProcess
-uint32_t info;
-uint32_t frame;
-uint32_t sz;
-        if(argc != 1)
-          return JS_FALSE;
-#if 0        
-        enterLock();
-        frame=JSVAL_TO_INT(argv[0]);
-        if(!video_body-&gt;getFrameSize(frame,&amp;sz)) return JS_FALSE;
-        leaveLock(); 
-        
-        *rval=INT_TO_JSVAL(sz);
-#endif
-        return JS_TRUE;
-}// end PostProcess
-/**
-    \fn getFrameType
-*/
-
-JSBool ADM_JSAvidemuxVideo::getFrameType(JSContext *cx, JSObject *obj, uintN argc, 
-                                       jsval *argv, jsval *rval)
-{// begin PostProcess
-uint32_t info;
-uint32_t frame;
-uint32_t sz;
-        if(argc != 1)
-          return JS_FALSE;
-#if 0        
-        enterLock();
-        frame=JSVAL_TO_INT(argv[0]);
-        if(!video_body-&gt;getFlags(frame,&amp;sz)) return JS_FALSE;
-        leaveLock(); 
-        
-        *rval=INT_TO_JSVAL(sz);
-#endif
-        return JS_TRUE;
-}// end PostProcess
-
-/**
-    \fn A_setVideoCodec
-*/
-bool A_setVideoCodec(const char *nm)
-{
-    int idx=videoEncoder6_GetIndexFromName(nm);
-    if(idx==-1)
-    {
-        ADM_error(&quot;No such encoder :%s\n&quot;,nm);
-    }
-    // Select by index
-    videoEncoder6_SetCurrentEncoder(idx);
-    UI_setVideoCodec(idx);
-    return true;
-}
-
-/* EOF */

Deleted: branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script/ADM_JSAvidemuxVideo.h
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script/ADM_JSAvidemuxVideo.h	2010-02-18 06:18:53 UTC (rev 5938)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script/ADM_JSAvidemuxVideo.h	2010-02-20 07:52:21 UTC (rev 5939)
@@ -1,68 +0,0 @@
-#ifndef _ADM_JSAVIDEMUXVIDEO_H
-#define _ADM_JSAVIDEMUXVIDEO_H
-
-#pragma once
-
-// Spidermonkey
-#include &quot;ADM_smjs/jsapi.h&quot;
-#include &quot;ADM_AvidemuxVideo.h&quot;
-
-class ADM_JSAvidemuxVideo
-{
-public:
-	ADM_JSAvidemuxVideo(void) : m_pObject(NULL) {}
-	virtual ~ADM_JSAvidemuxVideo(void);
-
-	static JSBool JSGetProperty(JSContext *cx, JSObject *obj, jsval id, jsval *vp);
-	static JSBool JSSetProperty(JSContext *cx, JSObject *obj, jsval id, jsval *vp);
-	static JSBool JSConstructor(JSContext *cx, JSObject *obj, uintN argc, 
-								jsval *argv, jsval *rval);
-	static void JSDestructor(JSContext *cx, JSObject *obj);
-	static JSObject *JSInit(JSContext *cx, JSObject *obj, JSObject *proto = NULL);
-	static JSBool Clear(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval);
-	static JSBool ClearFilters(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval);
-	static JSBool AddFilter(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval);
-	static JSBool IndexMPEG(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval);
-	static JSBool Codec(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval);
-	static JSBool codecPlugin(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval);
-	static JSBool CodecConf(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval);
-	static JSBool Save(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval);
-	static JSBool SaveJPEG(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval);
-	static JSBool ListBlackFrames(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval);
-	static JSBool PostProcess(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval);
-	static JSBool RebuildIBFrames(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval);
-
-	static JSBool SetFps1000(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval);
-	static JSBool GetFps1000(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval);
-        static JSBool GetNbFrames(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval);
-	static JSBool GetWidth(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval);
-	static JSBool GetHeight(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval);
-	static JSBool GetFCC(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval);
-
-	static JSBool isVopPacked(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval);
-	static JSBool hasGmc(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval);
-	static JSBool hasQpel(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval);
-        static JSBool getFrameSize(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval);
-	static JSBool getFrameType(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval);
-	static JSBool dumpEditing(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval);
-	static JSBool dumpTiming(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval);
-
-
-	static JSPropertySpec avidemuxvideo_properties[];
-	static JSFunctionSpec avidemuxvideo_methods[];
-	enum
-	{
-                videoprocess_prop,
-	};
-	static JSClass m_classAvidemuxVideo;
-
-//protected:
-	void setObject(ADM_AvidemuxVideo *pObject);
-	ADM_AvidemuxVideo *getObject();
-
-private:
-	ADM_AvidemuxVideo *m_pObject;
-
-};
-
-#endif

Deleted: branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script/ADM_JSDebug.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script/ADM_JSDebug.cpp	2010-02-18 06:18:53 UTC (rev 5938)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script/ADM_JSDebug.cpp	2010-02-20 07:52:21 UTC (rev 5939)
@@ -1,231 +0,0 @@
-/**
-    \file ADM_JSDebug.cpp
-    \brief Debug oriented functions for avidemux JS/JS shell
-    \author mean (c) 2009 <A HREF="https://lists.berlios.de/mailman/listinfo/avidemux-svn-commit">fixounet at free.fr</A>
-
-
-*/
-/***************************************************************************
- *                                                                         *
- *   This program is free software; you can redistribute it and/or modify  *
- *   it under the terms of the GNU General Public License as published by  *
- *   the Free Software Foundation; either version 2 of the License, or     *
- *   (at your option) any later version.                                   *
- *                                                                         *
- ***************************************************************************/
-#include &quot;ADM_default.h&quot;
-#include &lt;string.h&gt;
-#include &lt;pthread.h&gt;
-#include &quot;DIA_coreToolkit.h&quot;
-
-#include &quot;ADM_JSGlobal.h&quot;
-#include &quot;ADM_JSDebug.h&quot;
-#include &quot;ADM_JSif.h&quot;
-#include &quot;ADM_editor/ADM_edit.hxx&quot;
-/**/
-
-JS_PROTOTYPE displayError;
-JS_PROTOTYPE displayInfo;
-JS_PROTOTYPE print;
-JS_PROTOTYPE displayInfo;
-JS_PROTOTYPE assertTest;
-JS_PROTOTYPE crashTest;
-JS_PROTOTYPE help;
-JS_PROTOTYPE dumpEditing;
-JS_PROTOTYPE dumpTiming;
-/**/
-
-extern JSFunctionSpec *ADM_JsAudioGetFunctions(void);
-extern JSFunctionSpec *ADM_JsVideoGetFunctions(void);
-extern JSFunctionSpec *ADM_JsClassGetFunctions(void);
-extern JSFunctionSpec *ADM_JsDebugGetFunctions(void);
-extern JSFunctionSpec *ADM_JsFunctionGetFunctions(void);
-
-/**/
-static JSFunctionSpec adm_debug_functions[] = {
-  /*    name          native          nargs    */
-  {&quot;displayError&quot;,  displayError,       1},
-  {&quot;displayInfo&quot;,   displayInfo,        1},
-  {&quot;print&quot;,         print,              1},
-  {&quot;assert&quot;,        assertTest,         0},
-  {&quot;crashTest&quot;,     crashTest,          0},
-  {&quot;help&quot;,          help,               0},
-  {&quot;dumpEditing&quot;,   dumpEditing,        0},
-  {&quot;dumpTiming&quot;,    dumpTiming,         0},
-  {0}
-};
-extern ADM_Composer *video_body;
-void ADM_dumpJSHooks(void);
-/**
-    \fn JS_AvidemuxRegisterDebugFunction
-*/
-bool JS_AvidemuxRegisterDebugFunction(JSContext *cx,JSObject *global)
-{
-	if(JS_DefineFunctions(cx, global, adm_debug_functions) == true)
-		return true;
-
-	ADM_warning(&quot;Unable to define functions\n&quot;);
-	return false;
-}
-/**
-    \fn ADM_JsDebugGetFunctions
-
-*/
-JSFunctionSpec *ADM_JsDebugGetFunctions(void)
-{
-    return adm_debug_functions;
-}
-
-/**
-    \fn displayError
-    \brief error popup
-*/
-JSBool displayError(JSContext *cx, JSObject *obj, uintN argc, 
-                                       jsval *argv, jsval *rval)
-{// begin displayError
-	// default return value
-	if(argc != 1)
-		return JS_FALSE;
-	if(JSVAL_IS_STRING(argv[0]) == false)
-		return JS_FALSE;
-	char  *stringa = JS_GetStringBytes(JSVAL_TO_STRING(argv[0]));
-	GUI_Verbose();
-	GUI_Error_HIG(&quot;Error&quot;,stringa);
-	GUI_Quiet();
-
-	return JS_TRUE;
-}// end displayError
-/**
-    \fn displayInfo
-    \brief info popup
-*/
-
-JSBool displayInfo(JSContext *cx, JSObject *obj, uintN argc, 
-                                       jsval *argv, jsval *rval)
-{// begin displayInfo
-	// default return value
-	if(argc != 1)
-		return JS_FALSE;
-	if(JSVAL_IS_STRING(argv[0]) == false)
-		return JS_FALSE;
-	char  *stringa = JS_GetStringBytes(JSVAL_TO_STRING(argv[0]));
-	GUI_Verbose();
-	GUI_Info_HIG(ADM_LOG_IMPORTANT,&quot;Info&quot;,stringa);
-	GUI_Quiet();
-	return JS_TRUE;
-}// end displayInfo
- /**
-    \fn print
-*/
-JSBool print(JSContext *cx, JSObject *obj, uintN argc, 
-                                       jsval *argv, jsval *rval)
-{// begin print
-        if(argc != 1)
-                return JS_FALSE;
-        char *out=JS_GetStringBytes(JS_ValueToString(cx, argv[0]));
-        jsLog(JS_LOG_NORMAL,&quot;%s&quot;,out);
-        return JS_TRUE;
-}// end print
-/**
-    \fn crashTest
-    \brief Force a crash
-*/
-JSBool crashTest(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval)
-{
-  
-  int *foobar=NULL;
-  *foobar=0; // CRASH!
-  return JS_TRUE;
-}
-/**
-    \fn assertTest
-    \brief Force a crash
-*/
-JSBool assertTest(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval)
-{
-  
-  ADM_assert(0);
-  return JS_TRUE;
-}
-
-static void dumpFunc(JSFunctionSpec *f)
-{
-    while(f-&gt;name)
-    {
-        jsLog(JS_LOG_NORMAL,&quot;     %s(..)&quot;,f-&gt;name);
-        f++;
-    }
-}
-/**
-    \fn help
-    \brief dump avidemux specific functions
-*/
-JSBool help(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval)
-{
-        if(!argc)
-        {
-            jsLog(JS_LOG_NORMAL,&quot;help(\&quot;class\&quot;); or help(\&quot;video\&quot;); or help(\&quot;audio\&quot;); or help(\&quot;debug\&quot;); or debug(\&quot;functions\&quot;&quot;);
-            return JS_TRUE;
-        }
-        if(argc != 1)
-        {
-          jsLog(JS_LOG_ERROR,&quot;help accepts only one arg, type help() to get them\n&quot;);
-          return JS_FALSE;
-        } 
-        JSFunctionSpec *table=NULL;
-        char *f=JS_GetStringBytes(JSVAL_TO_STRING(argv[0]));
-        
-#define DUMPTABLE(x,y) if(!strcasecmp(f,#x)) table=y();
-        if(f)
-        {
-            DUMPTABLE(audio,ADM_JsAudioGetFunctions);
-            DUMPTABLE(video,ADM_JsVideoGetFunctions);
-            DUMPTABLE(debug,ADM_JsDebugGetFunctions);
-            DUMPTABLE(functions,ADM_JsFunctionGetFunctions);
-            DUMPTABLE(class,ADM_JsClassGetFunctions);
-        }
-        if(table) dumpFunc(table);
-        else jsLog(JS_LOG_ERROR,&quot;%s not found&quot;,f);
-  
-  return JS_TRUE;
-}
-/**
-    \fn dumpEditing
-    \brief dump segment, video &amp; all
-*/
-JSBool dumpEditing(JSContext *cx, JSObject *obj, uintN argc, 
-                                       jsval *argv, jsval *rval)
-{// begin PostProcess
-uint32_t info;
-uint32_t frame;
-uint32_t sz;
-        if(argc)
-        {
-            return JS_FALSE;
-        }
-        enterLock();
-        video_body-&gt;dumpEditing();
-        leaveLock(); 
-        
-        return JS_TRUE;
-}// end PostProcess
-/**
-    \fn dumpTiming
-    \brief dump segment, video &amp; all
-*/
-JSBool dumpTiming(JSContext *cx, JSObject *obj, uintN argc, 
-                                       jsval *argv, jsval *rval)
-{// begin PostProcess
-uint32_t info;
-uint32_t frame;
-uint32_t sz;
-        if(argc != 0)
-          return JS_FALSE;
-  
-        enterLock();
-        video_body-&gt;dumpTiming();
-        leaveLock(); 
-        
-        return JS_TRUE;
-}// end PostProcess
-// EOF
\ No newline at end of file

Deleted: branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script/ADM_JSDebug.h
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script/ADM_JSDebug.h	2010-02-18 06:18:53 UTC (rev 5938)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script/ADM_JSDebug.h	2010-02-20 07:52:21 UTC (rev 5939)
@@ -1,22 +0,0 @@
-/**
-    \file ADM_JSDebug.h
-    \brief Debug oriented functions for avidemux JS/JS shell
-    \author mean (c) 2009 <A HREF="https://lists.berlios.de/mailman/listinfo/avidemux-svn-commit">fixounet at free.fr</A>
-
-
-*/
-/***************************************************************************
- *                                                                         *
- *   This program is free software; you can redistribute it and/or modify  *
- *   it under the terms of the GNU General Public License as published by  *
- *   the Free Software Foundation; either version 2 of the License, or     *
- *   (at your option) any later version.                                   *
- *                                                                         *
- ***************************************************************************/
-
-#ifndef ADMJS_DEBUG_H
-#define ADMJS_DEBUG_H
-
-
-
-#endif
\ No newline at end of file

Deleted: branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script/ADM_JSDirectorySearch.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script/ADM_JSDirectorySearch.cpp	2010-02-18 06:18:53 UTC (rev 5938)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script/ADM_JSDirectorySearch.cpp	2010-02-20 07:52:21 UTC (rev 5939)
@@ -1,249 +0,0 @@
-// C++ Interface: Spider Monkey interface
-//
-// Description: 
-//
-//
-// Author: Anish Mistry
-//
-// Copyright: See COPYING file that comes with this distribution
-//
-//
-
-#include &quot;ADM_JSDirectorySearch.h&quot;
-#include &quot;DirectorySearch.h&quot;
-
-JSPropertySpec ADM_JSDirectorySearch::directorysearch_properties[] = 
-{ 
-	{ &quot;isDoubleDot&quot;, is_double_dot_prop, JSPROP_ENUMERATE },	// .
-	{ &quot;isSingleDot&quot;, is_single_dot_prop, JSPROP_ENUMERATE },	// ..
-	{ &quot;isHidden&quot;, is_hidden_prop, JSPROP_ENUMERATE },	// hidden file
-	{ &quot;isArchive&quot;, is_archive_prop, JSPROP_ENUMERATE },	// archived file
-	{ &quot;isDirectory&quot;, is_directory_prop, JSPROP_ENUMERATE },	// directory
-	{ &quot;isNotFile&quot;, is_not_file_prop, JSPROP_ENUMERATE },	// not a file
-	{ 0 }
-};
-
-JSFunctionSpec ADM_JSDirectorySearch::directorysearch_methods[] =
-{
-	{ &quot;Init&quot;, Init, 1, 0, 0 },	// Initialize search
-	{ &quot;Close&quot;, Close, 0, 0, 0 },	// Close the search
-	{ &quot;GetFileName&quot;, GetFileName, 0, 0, 0 },	// return the current file name
-	{ &quot;GetFileDirectory&quot;, GetFileDirectory, 0, 0, 0 },	// returns the directory of the file
-	{ &quot;GetFilePath&quot;, GetFilePath, 0, 0, 0 },	// returns the full path of the file
-	{ &quot;NextFile&quot;, NextFile, 0, 0, 0 },	// Advance search to the next file
-	{ &quot;GetFileSize&quot;, GetFileSize, 0, 0, 0 },	// Returns the size of the file in bytes
-	{ &quot;GetExtension&quot;, GetExtension, 0, 0, 0 },	// Returns the extension of the current file
-	{ &quot;IsExtension&quot;, IsExtension, 1, 0, 0 },	// Compares the first argument string with the current extension and returns true on a match, false otherwise
-	{ 0 }
-};
-
-JSClass ADM_JSDirectorySearch::m_classDirectorySearch =
-{
-	&quot;DirectorySearch&quot;, JSCLASS_HAS_PRIVATE,
-	JS_PropertyStub, JS_PropertyStub,
-	ADM_JSDirectorySearch::JSGetProperty, ADM_JSDirectorySearch::JSSetProperty,
-	JS_EnumerateStub, JS_ResolveStub,
-	JS_ConvertStub, ADM_JSDirectorySearch::JSDestructor
-};
-
-ADM_JSDirectorySearch::~ADM_JSDirectorySearch(void)
-{
-	if(m_pObject != NULL)
-		delete m_pObject;
-	m_pObject = NULL;
-}
-
-void ADM_JSDirectorySearch::setObject(CDirectorySearch *pObject)
-{
-	m_pObject = pObject; 
-}
-	
-CDirectorySearch *ADM_JSDirectorySearch::getObject()
-{
-	return m_pObject; 
-}
-
-JSObject *ADM_JSDirectorySearch::JSInit(JSContext *cx, JSObject *obj, JSObject *proto)
-{
-	JSObject *newObj = JS_InitClass(cx, obj, proto, &amp;m_classDirectorySearch, 
-									ADM_JSDirectorySearch::JSConstructor, 0,
-									ADM_JSDirectorySearch::directorysearch_properties, ADM_JSDirectorySearch::directorysearch_methods,
-									NULL, NULL);
-	return newObj;
-}
-
-JSBool ADM_JSDirectorySearch::JSConstructor(JSContext *cx, JSObject *obj, uintN argc, 
-								 jsval *argv, jsval *rval)
-{
-	if(argc != 0)
-		return JS_FALSE;
-	ADM_JSDirectorySearch *p = new ADM_JSDirectorySearch();
-	CDirectorySearch *pObject = new CDirectorySearch();
-	p-&gt;setObject(pObject);
-	if ( ! JS_SetPrivate(cx, obj, p) )
-		return JS_FALSE;
-	*rval = OBJECT_TO_JSVAL(obj);
-	return JS_TRUE;
-}
-
-void ADM_JSDirectorySearch::JSDestructor(JSContext *cx, JSObject *obj)
-{
-	ADM_JSDirectorySearch *p = (ADM_JSDirectorySearch *)JS_GetPrivate(cx, obj);
-	if(p != NULL)
-		delete p;
-	p = NULL;
-}
-
-JSBool ADM_JSDirectorySearch::JSGetProperty(JSContext *cx, JSObject *obj, jsval id, jsval *vp)
-{
-	if (JSVAL_IS_INT(id)) 
-	{
-		ADM_JSDirectorySearch *priv = (ADM_JSDirectorySearch *) JS_GetPrivate(cx, obj);
-		switch(JSVAL_TO_INT(id))
-		{
-			case is_double_dot_prop:
-				*vp = INT_TO_JSVAL(priv-&gt;getObject()-&gt;IsDoubleDot());
-				break;
-			case is_single_dot_prop:
-				*vp = INT_TO_JSVAL(priv-&gt;getObject()-&gt;IsSingleDot());
-				break;
-			case is_hidden_prop:
-				*vp = INT_TO_JSVAL(priv-&gt;getObject()-&gt;IsHidden());
-				break;
-			case is_archive_prop:
-				*vp = INT_TO_JSVAL(priv-&gt;getObject()-&gt;IsArchive());
-				break;
-			case is_directory_prop:
-				*vp = INT_TO_JSVAL(priv-&gt;getObject()-&gt;IsDirectory());
-				break;
-			case is_not_file_prop:
-				*vp = INT_TO_JSVAL(priv-&gt;getObject()-&gt;IsNotFile());
-				break;
-		}
-	}
-	return JS_TRUE;
-}
-
-JSBool ADM_JSDirectorySearch::JSSetProperty(JSContext *cx, JSObject *obj, jsval id, jsval *vp)
-{
-	if (JSVAL_IS_INT(id)) 
-	{
-		ADM_JSDirectorySearch *priv = (ADM_JSDirectorySearch *) JS_GetPrivate(cx, obj);
-		switch(JSVAL_TO_INT(id))
-		{
-			case is_double_dot_prop:
-			case is_single_dot_prop:
-			case is_hidden_prop:
-			case is_archive_prop:
-			case is_directory_prop:
-			case is_not_file_prop:
-				return JS_FALSE;
-				break;
-		}
-	}
-	return JS_TRUE;
-}
-
-JSBool ADM_JSDirectorySearch::GetExtension(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval)
-{// begin GetExtension
-	ADM_JSDirectorySearch *p = (ADM_JSDirectorySearch *)JS_GetPrivate(cx, obj);
-	// default return value
-	*rval = BOOLEAN_TO_JSVAL(false);
-	if(argc != 0)
-		return JS_FALSE;
-	*rval = STRING_TO_JSVAL(JS_NewStringCopyZ(cx,p-&gt;getObject()-&gt;GetExtension()));
-	return JS_TRUE;
-}// end GetExtension
-
-JSBool ADM_JSDirectorySearch::IsExtension(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval)
-{// begin IsExtension
-	ADM_JSDirectorySearch *p = (ADM_JSDirectorySearch *)JS_GetPrivate(cx, obj);
-	// default return value
-	*rval = BOOLEAN_TO_JSVAL(false);
-	if(argc != 1)
-		return JS_FALSE;
-	if(JSVAL_IS_STRING(argv[0]) == false)
-		return JS_FALSE;
-	*rval = BOOLEAN_TO_JSVAL(p-&gt;getObject()-&gt;IsExtension(JS_GetStringBytes(JSVAL_TO_STRING(argv[0]))));
-	return JS_TRUE;
-}// end IsExtension
-
-JSBool ADM_JSDirectorySearch::NextFile(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval)
-{// begin NextFile
-	ADM_JSDirectorySearch *p = (ADM_JSDirectorySearch *)JS_GetPrivate(cx, obj);
-	// default return value
-	*rval = BOOLEAN_TO_JSVAL(false);
-	if(argc != 0)
-		return JS_FALSE;
-	*rval = BOOLEAN_TO_JSVAL(p-&gt;getObject()-&gt;NextFile());
-	return JS_TRUE;
-}// end NextFile
-
-JSBool ADM_JSDirectorySearch::Init(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval)
-{// begin Init
-	ADM_JSDirectorySearch *p = (ADM_JSDirectorySearch *)JS_GetPrivate(cx, obj);
-	// default return value
-	*rval = BOOLEAN_TO_JSVAL(false);
-	if(argc != 1)
-		return JS_FALSE;
-	if(JSVAL_IS_STRING(argv[0]) == false)
-		return JS_FALSE;
-	*rval = BOOLEAN_TO_JSVAL(p-&gt;getObject()-&gt;Init(JS_GetStringBytes(JSVAL_TO_STRING(argv[0]))));
-	return JS_TRUE;
-}// end Init
-
-
-JSBool ADM_JSDirectorySearch::GetFileSize(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval)
-{// begin GetFileSize
-	ADM_JSDirectorySearch *p = (ADM_JSDirectorySearch *)JS_GetPrivate(cx, obj);
-	// default return value
-	*rval = INT_TO_JSVAL(0);
-	if(argc != 0)
-		return JS_FALSE;
-	*rval = INT_TO_JSVAL(p-&gt;getObject()-&gt;GetFileSize());
-	return JS_TRUE;
-}// end GetFileSize
-
-JSBool ADM_JSDirectorySearch::GetFileDirectory(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval)
-{// begin GetFileDirectory
-	ADM_JSDirectorySearch *p = (ADM_JSDirectorySearch *)JS_GetPrivate(cx, obj);
-	// default return value
-	*rval = BOOLEAN_TO_JSVAL(false);
-	if(argc != 0)
-		return JS_FALSE;
-	*rval = STRING_TO_JSVAL(JS_NewStringCopyZ(cx,p-&gt;getObject()-&gt;GetFileDirectory().c_str()));
-	return JS_TRUE;
-}// end GetFileDirectory
-
-JSBool ADM_JSDirectorySearch::GetFilePath(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval)
-{// begin GetFilePath
-	ADM_JSDirectorySearch *p = (ADM_JSDirectorySearch *)JS_GetPrivate(cx, obj);
-	// default return value
-	*rval = BOOLEAN_TO_JSVAL(false);
-	if(argc != 0)
-		return JS_FALSE;
-	*rval = STRING_TO_JSVAL(JS_NewStringCopyZ(cx,p-&gt;getObject()-&gt;GetFilePath().c_str()));
-	return JS_TRUE;
-}// end GetFilePath
-
-JSBool ADM_JSDirectorySearch::GetFileName(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval)
-{// begin GetFileName
-	ADM_JSDirectorySearch *p = (ADM_JSDirectorySearch *)JS_GetPrivate(cx, obj);
-	// default return value
-	*rval = BOOLEAN_TO_JSVAL(false);
-	if(argc != 0)
-		return JS_FALSE;
-	*rval = STRING_TO_JSVAL(JS_NewStringCopyZ(cx,p-&gt;getObject()-&gt;GetFileName()));
-	return JS_TRUE;
-}// end GetFileName
-
-JSBool ADM_JSDirectorySearch::Close(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval)
-{// begin Close
-	ADM_JSDirectorySearch *p = (ADM_JSDirectorySearch *)JS_GetPrivate(cx, obj);
-	// default return value
-	*rval = BOOLEAN_TO_JSVAL(false);
-	if(argc != 0)
-		return JS_FALSE;
-	*rval = BOOLEAN_TO_JSVAL(p-&gt;getObject()-&gt;Close());
-	return JS_TRUE;
-}// end Close

Deleted: branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script/ADM_JSDirectorySearch.h
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script/ADM_JSDirectorySearch.h	2010-02-18 06:18:53 UTC (rev 5938)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script/ADM_JSDirectorySearch.h	2010-02-20 07:52:21 UTC (rev 5939)
@@ -1,57 +0,0 @@
-#ifndef _ADM_JSDIRECTORYSEARCH_H
-#define _ADM_JSDIRECTORYSEARCH_H
-
-#pragma once
-
-
-
-// Spidermonkey
-#include &quot;ADM_smjs/jsapi.h&quot;
-#include &lt;string.h&gt;
-#include &quot;DirectorySearch.h&quot;
-
-class ADM_JSDirectorySearch
-{
-public:
-	ADM_JSDirectorySearch(void) : m_pObject(NULL) {}
-	virtual ~ADM_JSDirectorySearch(void);
-
-	static JSBool JSGetProperty(JSContext *cx, JSObject *obj, jsval id, jsval *vp);
-	static JSBool JSSetProperty(JSContext *cx, JSObject *obj, jsval id, jsval *vp);
-	static JSBool JSConstructor(JSContext *cx, JSObject *obj, uintN argc, 
-								jsval *argv, jsval *rval);
-	static void JSDestructor(JSContext *cx, JSObject *obj);
-	static JSObject *JSInit(JSContext *cx, JSObject *obj, JSObject *proto = NULL);
-	static JSBool GetExtension(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval);
-	static JSBool IsExtension(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval);
-	static JSBool NextFile(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval);
-	static JSBool Init(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval);
-	static JSBool GetFileSize(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval);
-	static JSBool GetFileDirectory(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval);
-	static JSBool GetFilePath(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval);
-	static JSBool GetFileName(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval);
-	static JSBool Close(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval);
-
-
-	static JSPropertySpec directorysearch_properties[];
-	static JSFunctionSpec directorysearch_methods[];
-	enum
-	{
-		is_double_dot_prop,
-		is_single_dot_prop,
-		is_hidden_prop,
-		is_archive_prop,
-		is_directory_prop,
-		is_not_file_prop
-	};
-	static JSClass m_classDirectorySearch;
-
-	void setObject(CDirectorySearch *pObject);
-	CDirectorySearch *getObject();
-
-private:
-	CDirectorySearch *m_pObject;
-
-};
-
-#endif

Deleted: branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script/ADM_JSDirectorySearch.h.orig
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script/ADM_JSDirectorySearch.h.orig	2010-02-18 06:18:53 UTC (rev 5938)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script/ADM_JSDirectorySearch.h.orig	2010-02-20 07:52:21 UTC (rev 5939)
@@ -1,56 +0,0 @@
-#ifndef _ADM_JSDIRECTORYSEARCH_H
-#define _ADM_JSDIRECTORYSEARCH_H
-
-#pragma once
-
-#include &quot;config.h&quot;
-
-// Spidermonkey
-#include &quot;ADM_libraries/ADM_smjs/jsapi.h&quot;
-#include &lt;string.h&gt;
-#include &quot;DirectorySearch.h&quot;
-
-class ADM_JSDirectorySearch
-{
-public:
-	ADM_JSDirectorySearch(void) : m_pObject(NULL) {}
-	virtual ~ADM_JSDirectorySearch(void);
-
-	static JSBool JSGetProperty(JSContext *cx, JSObject *obj, jsval id, jsval *vp);
-	static JSBool JSSetProperty(JSContext *cx, JSObject *obj, jsval id, jsval *vp);
-	static JSBool JSConstructor(JSContext *cx, JSObject *obj, uintN argc, 
-								jsval *argv, jsval *rval);
-	static void JSDestructor(JSContext *cx, JSObject *obj);
-	static JSObject *JSInit(JSContext *cx, JSObject *obj, JSObject *proto = NULL);
-	static JSBool GetExtension(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval);
-	static JSBool IsExtension(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval);
-	static JSBool NextFile(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval);
-	static JSBool Init(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval);
-	static JSBool GetFileSize(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval);
-	static JSBool GetFileDirectory(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval);
-	static JSBool GetFileName(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval);
-	static JSBool Close(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval);
-
-
-	static JSPropertySpec directorysearch_properties[];
-	static JSFunctionSpec directorysearch_methods[];
-	enum
-	{
-		is_double_dot_prop,
-		is_single_dot_prop,
-		is_hidden_prop,
-		is_archive_prop,
-		is_directory_prop,
-		is_not_file_prop
-	};
-	static JSClass m_classDirectorySearch;
-
-	void setObject(CDirectorySearch *pObject);
-	CDirectorySearch *getObject();
-
-private:
-	CDirectorySearch *m_pObject;
-
-};
-
-#endif

Deleted: branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script/ADM_JSFunctions.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script/ADM_JSFunctions.cpp	2010-02-18 06:18:53 UTC (rev 5938)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script/ADM_JSFunctions.cpp	2010-02-20 07:52:21 UTC (rev 5939)
@@ -1,459 +0,0 @@
-// C++ Interface: Spider Monkey interface
-//
-// Description: 
-//
-//
-// Author: Anish Mistry
-//      Some modification by mean
-//
-// Copyright: See COPYING file that comes with this distribution
-//
-//
-#include &lt;string&gt;
-#include &quot;ADM_default.h&quot;
-#include &lt;sys/types.h&gt;
-#include &lt;sys/stat.h&gt;
-#if defined( ADM_WIN32 ) || defined(__MINGW32__)
-#define ADM_JS_WIN32
-#endif
-
-#ifndef ADM_JS_WIN32
-#include &lt;sys/wait.h&gt;
-#include &lt;sys/param.h&gt;
-#endif
-#include &lt;errno.h&gt;
-#include &lt;dirent.h&gt;
-#include &lt;limits.h&gt;
-#include &lt;math.h&gt;
-#include &lt;vector&gt;
-#include &quot;ADM_JSAvidemux.h&quot;
-#include &quot;ADM_JSGlobal.h&quot;
-#include &quot;ADM_default.h&quot;
-#include &quot;DIA_coreToolkit.h&quot;
-#include &quot;ADM_editor/ADM_outputfmt.h&quot;
-#include &quot;adm_scanner.h&quot; 
-#include &quot;avi_vars.h&quot;
-#include &quot;gui_action.hxx&quot;
-//#include &quot;ADM_videoFilter.h&quot;
-#include &quot;ADM_editor/ADM_outputfmt.h&quot;
-
-#include &quot;ADM_script/ADM_container.h&quot;
-
-#include &quot;ADM_JSGlobal.h&quot;
-#include &quot;DIA_fileSel.h&quot;
-
-#include &quot;DIA_factory.h&quot;
-
-std::vector &lt;std::string&gt; g_vIncludes;
-extern char **environ;
-extern char *script_getVar(char *in, int *r);
-
-
-JSBool fileWriteSelect(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval);
-JSBool dirSelect(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval);
-JSBool fileReadSelect(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval);
-
-JSBool allFilesFrom(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval);
-JSBool nextFile(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval);
-JSBool setSuccess(JSContext *cx, JSObject *obj, uintN argc, 
-                                       jsval *argv, jsval *rval);
-JSBool getVar(JSContext *cx, JSObject *obj, uintN argc, 
-                                       jsval *argv, jsval *rval);
-JSBool systemExecute(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval);
-JSBool systemInclude(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval);
-JSBool pathOnly(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval);
-
-JSBool facInt(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval);
-JSBool facFloat(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval);
-JSBool facToggle(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval);
-JSBool facMenu(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval);
-JSBool facFile(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval);
-JSBool facBitrate(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval);
-JSBool facBar(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval);
-JSBool facRoText(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval);
-JSBool facText(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval);
-JSBool facTab(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval);
-JSBool facFrame(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval);
-JSBool facHex(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval);
-JSBool facDirSel(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval);
-JSBool facButton(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval);
-JSBool facMatrix(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval);
-JSBool facNotch(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval);
-JSBool facThreadCount(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval);
-JSBool facSlider(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval);
-
-
-static JSFunctionSpec adm_functions[] = {
-  /*    name          native          nargs    */
-  {&quot;fileReadSelect&quot;,    fileReadSelect,        0},
-  {&quot;fileWriteSelect&quot;,   fileWriteSelect,        0},
-  {&quot;dirSelect&quot;,         dirSelect,        0},
-  {&quot;allFilesFrom&quot;,      allFilesFrom,        0},
-  {&quot;nextFile&quot;,          nextFile,        0},
-  {&quot;setSuccess&quot;,          setSuccess,        1},
-  {&quot;getVar&quot;,          getVar,        1},
-  {&quot;exec&quot;,          systemExecute,        3},
-  {&quot;include&quot;,          systemInclude,        1},
-  {&quot;pathOnly&quot;,          pathOnly,        1},
-  {&quot;dialogFactoryInt&quot;,          facInt,           0},
-  {&quot;dialogFactoryFloat&quot;,        facFloat,         0},
-  {&quot;dialogFactoryToggle&quot;,       facToggle,        0},
-  {&quot;dialogFactoryMenu&quot;,         facMenu,          0},
-  {&quot;dialogFactoryFileSel&quot;,      facFile,          0},
-  {&quot;dialogFactoryBitrate&quot;,      facBitrate,       0},
-  {&quot;dialogFactoryBar&quot;,        facBar,             0},
-  {&quot;dialogFactoryRoText&quot;,     facRoText,          0},
-  {&quot;dialogFactoryText&quot;,       facText,            0},
-  {&quot;dialogFactoryTabs&quot;,       facTab,             0},
-  {&quot;dialogFactoryDirSel&quot;,       facDirSel,        0},
-  {&quot;dialogFactoryFrame&quot;,       facFrame,          0},
-  {&quot;dialogFactoryHex&quot;,       facHex,              0},
-  {&quot;dialogFactoryButton&quot;,       facButton,        0},
-  {&quot;dialogFactorySlider&quot;,       facSlider,        0},
-  {&quot;dialogFactoryMatrix&quot;,       facMatrix,        0},
-  {&quot;dialogFactoryNotch&quot;,       facNotch,		  0},
-  {&quot;dialogFactoryThreadCount&quot;, facThreadCount,		  0},
-  {0}
-};
-JSFunctionSpec *ADM_JsFunctionGetFunctions(void)
-{
-    return adm_functions;
-}
-
-uint8_t JS_AvidemuxFunction(JSContext *cx,JSObject *global)
-{
-	if(JS_DefineFunctions(cx, global, adm_functions) == true)
-		return 1;
-
-	printf(&quot;JSAvidemuxFunction: Unable to define functions\n&quot;);
-	return 0;
-}
-
-JSBool getVar(JSContext *cx, JSObject *obj, uintN argc, 
-                                       jsval *argv, jsval *rval)
-{// begin getVar
-        int out=0;
-        char *dupe=NULL;
-
-        // default return value
-        if(argc != 1)
-                return JS_FALSE;
-	if(JSVAL_IS_STRING(argv[0]) == false)
-		return JS_FALSE;
-	char  *stringa = JS_GetStringBytes(JSVAL_TO_STRING(argv[0]));
-	dupe=script_getVar(stringa ,&amp;out);
-
-	if(!dupe)
-		return JS_FALSE;
-	// if out=1 it is a string else a number
-	if(out)
-		*rval = STRING_TO_JSVAL(JS_NewStringCopyZ(cx,dupe));
-	else
-		*rval = INT_TO_JSVAL(atoi(dupe));
-	return JS_TRUE;
-}// end getVar
-
-JSBool setSuccess(JSContext *cx, JSObject *obj, uintN argc, 
-                                       jsval *argv, jsval *rval)
-{// begin setSuccess
-	bool Jscript_succeed = false;
-	// default return value
-	if(argc != 1)
-		return JS_FALSE;
-	if(JSVAL_IS_BOOLEAN(argv[0]) == false)
-		return JS_FALSE;
-	Jscript_succeed = JSVAL_TO_BOOLEAN(argv[0]);
-	JS_setSuccess(Jscript_succeed);
-
-	return JS_TRUE;
-}// end setSuccess
-
-JSBool fileReadSelect(JSContext *cx, JSObject *obj, uintN argc, 
-                                       jsval *argv, jsval *rval)
-{// begin fileReadSelect
-        char *name;
-        // default return value
-        if(argc != 0)
-                return JS_FALSE;
-        if(!name) return JS_FALSE;
-        GUI_FileSelRead(&quot;Open file (Read mode)&quot;, &amp;name);
-        *rval=STRING_TO_JSVAL(JS_NewStringCopyZ(cx,name));
-        ADM_dealloc(name);
-        return JS_TRUE;
-}// end fileReadSelect
-
-JSBool fileWriteSelect(JSContext *cx, JSObject *obj, uintN argc, 
-                                       jsval *argv, jsval *rval)
-{// begin fileWriteSelect
-        char *name;
-        // default return value
-        if(argc != 0)
-                return JS_FALSE;
-        GUI_FileSelWrite(&quot;Open file (Write mode)&quot;, &amp;name);
-        if(!name) return JS_FALSE;
-        *rval=STRING_TO_JSVAL(JS_NewStringCopyZ(cx,name));
-        ADM_dealloc(name);
-        return JS_TRUE;
-}// end fileWriteSelect
-JSBool dirSelect(JSContext *cx, JSObject *obj, uintN argc, 
-                                       jsval *argv, jsval *rval)
-{
-        char name[1024];
-        // default return value
-        if(argc != 0)
-                return JS_FALSE;
-        if(!FileSel_SelectDir(QT_TR_NOOP(&quot;Select a directory&quot;),name,1023, NULL))
-         return JS_FALSE;
-        *rval=STRING_TO_JSVAL(JS_NewStringCopyZ(cx,name));
-        return JS_TRUE;
-}
-/*****************************************************
-        To process a whole directiry at a time
-*******************************************************/
-#define ADM_MAX_DIR 1024
-static char *dirs[ADM_MAX_DIR];
-static int dirmax=0;
-static int curdir=0;
-static void cleanup( void );
-void cleanup( void )
-{
-        for(int i=0;i&lt;dirmax;i++)
-                ADM_dealloc(dirs[i]);
-        dirmax=0;
-        curdir=0;
-}
-JSBool allFilesFrom(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval)
-{
-char *str;
-DIR *dir;
-struct dirent *direntry;
-       // ADM_JSAvidemux *p = (ADM_JSAvidemux *)JS_GetPrivate(cx, obj);
-        cleanup();
-        // default return value
-        if(argc != 1)
-                return JS_FALSE;
-	if(JSVAL_IS_STRING(argv[0]) == false)
-		return JS_FALSE;
-
-        str=JS_GetStringBytes(JSVAL_TO_STRING(argv[0]));
-        dir=opendir(str);
-        if(!dir)
-        {
-                *rval=INT_TO_JSVAL(0); // No files
-                return JS_TRUE;
-        }
-        while((direntry=readdir(dir)) &amp;&amp; dirmax&lt;ADM_MAX_DIR-1)
-        {
-                dirs[dirmax]=(char *)ADM_alloc(strlen(str)+strlen(direntry-&gt;d_name)+2);
-                strcpy(dirs[dirmax],str);
-                strcat(dirs[dirmax],direntry-&gt;d_name);
-                //printf(&quot;File:&lt;%s&gt;\n&quot;,dirs[dirmax]);
-                dirmax++;
-        }
-        closedir(dir);
-        *rval=INT_TO_JSVAL(dirmax);
-        return JS_TRUE;
-}
-
-JSBool nextFile(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval)
-{
-char *n;
-        if(argc != 0)
-                return JS_FALSE;
-
-        if(curdir==dirmax)
-        {
-                n=&quot;&quot;;
-        }
-        else
-        {
-                n=dirs[curdir++];
-        }
-        *rval=STRING_TO_JSVAL(JS_NewStringCopyZ(cx,n));
-        return JS_TRUE;
-}
-
-JSBool systemExecute(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval)
-{// begin systemExecute
-	// default return value
-	*rval = INT_TO_JSVAL(-1);
-
-	if(argc != 3)
-		return JS_FALSE;
-	if(JSVAL_IS_STRING(argv[0]) == false || JSVAL_IS_OBJECT(argv[1]) == false || JSVAL_IS_BOOLEAN(argv[2]) == false)
-		return JS_FALSE;
-
-	char *pExecutable = JS_GetStringBytes(JSVAL_TO_STRING(argv[0]));
-	JSObject *pArgs = JSVAL_TO_OBJECT(argv[1]);
-	bool bWait = JSVAL_TO_BOOLEAN(argv[2]);
-	int status = 0;
-	jsuint nArgsLength = 0;
-	jsval jsValue;
-	struct stat sbFileInfo;
-
-	if(JS_IsArrayObject(cx, pArgs) == false)
-		return JS_FALSE;
-
-	JS_GetArrayLength(cx,pArgs,&amp;nArgsLength);
-	char **args = new char *[nArgsLength + 2];
-	args[0] = pExecutable;
-	args[nArgsLength + 1] = NULL;
-
-	for(int i = 0; i &lt; nArgsLength; i++)
-	{
-		if(JS_GetElement(cx, pArgs, i, &amp;jsValue) == JS_FALSE)
-		{// begin failure to get item
-			JS_ReportError(cx, &quot;exec() JS_GetElement failed to get an array item.&quot;);
-			return JS_FALSE;
-		}// end failure to get item
-		args[i + 1] = JS_GetStringBytes(JSVAL_TO_STRING(jsValue));
-	}
-
-#ifndef ADM_JS_WIN32
-	if(getuid() == 0)
-	{// begin running as root
-		JS_ReportError(cx, &quot;exec() disallowed while running as root.&quot;);
-		return JS_FALSE;
-	}// end running as root
-	if(stat(pExecutable , &amp;sbFileInfo) != 0)
-	{// begin can't stat file
-		JS_ReportError(cx, &quot;exec() Can't stat \&quot;%s\&quot; errno(%i).&quot;, pExecutable, errno);
-		return JS_FALSE;
-	}// end can't stat file
-	if((sbFileInfo.st_mode &amp; S_ISUID) == S_ISUID || (sbFileInfo.st_mode &amp; S_ISGID) == S_ISGID)
-	{// begin setuid/setgid files disallowed
-		JS_ReportError(cx, &quot;exec() disallowed execution of \&quot;%s\&quot; since it is a setuid/setgid file.&quot;, pExecutable);
-		return JS_FALSE;
-	}// end setuid/setgid files disallowed
-#endif
-
-        enterLock();
-	// clear file descriptor table of forked process and fork
-#if defined( __linux__) || defined(__macosx__) || defined(__APPLE__) || defined(__CYGWIN__)
-	pid_t pidRtn = fork();
-#elif defined(__FreeBSD__) || defined(__OpenBSD__)
-	pid_t pidRtn = rfork(RFPROC|RFCFDG);
-#endif
-
-#ifdef ADM_JS_WIN32
-	intptr_t pidRtn = spawnvpe(bWait ? P_WAIT : P_NOWAIT, pExecutable, args, environ);
-	#define WEXITSTATUS
-#else
-	if(pidRtn == 0)
-	{// begin child process
-#if defined( __linux__) || defined(__macosx__) || defined(__APPLE__) || defined(__CYGWIN__)
-		close(STDIN_FILENO);
-		close(STDOUT_FILENO);
-		close(STDERR_FILENO);
-#endif
-		char **pEnv = environ;
-		//char *pEnv[] = {NULL};
-		execve(pExecutable,args,pEnv);
-		printf(&quot;Error: execve failure errno(%d)\n&quot;,errno);
-		_exit(errno);
-	}// end child process
-	else if(bWait &amp;&amp; pidRtn != -1)
-	{// begin wait for execution to finish
-		printf(&quot;Waiting on pid %d...&quot;,pidRtn);
-		do
-		{// begin wait for child
-			waitpid(pidRtn,&amp;status,WUNTRACED);
-		}// end wait for child
-		while(WIFEXITED(status) == false &amp;&amp; WIFSIGNALED(status) == false);
-		printf(&quot;Done...\n&quot;);
-	}// end wait for execution to finish
-	else if(pidRtn == -1)
-	{// begin rfork failure
-		printf(&quot;Error: execve failure errno(%d)\n&quot;,errno);
-	}// end rfork failure
-#endif
-
-        leaveLock();
-
-	// cleanup
-	delete []args;
-	if(pidRtn != -1)
-		*rval = INT_TO_JSVAL(WEXITSTATUS(status));	// success return child's exit status
-	else
-		*rval = INT_TO_JSVAL(-1);	// failure
-	return JS_TRUE;
-}// end systemExecute
-JSBool systemInclude(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval)
-{// begin systemInclude
-	// default return value
-	*rval = BOOLEAN_TO_JSVAL(false);
-	if(argc != 1)
-		return JS_FALSE;
-	if(JSVAL_IS_STRING(argv[0]) == false)
-		return JS_FALSE;
-
-	struct stat sbFileInfo;
-	const char *pIncludeFile = JS_GetStringBytes(JSVAL_TO_STRING(argv[0]));
-	// make sure we haven't included this already to avoid a recursive
-	// dependency loop
-	char *pTempStr = new char[PATH_MAX+1];
- #ifdef __MINGW32__
- 	if(_fullpath(pTempStr,pIncludeFile,PATH_MAX) == NULL)
- #else
-	if(realpath(pIncludeFile,pTempStr) == NULL)
-#endif
-	{// begin can't resolve path
-		JS_ReportError(cx, &quot;include() can't resolve the path of \&quot;%s\&quot;.&quot;, pIncludeFile);
-		return JS_FALSE;
-	}// end can't resolve path
-
-	std::string sRealPath = pTempStr;
-	if(stat(sRealPath.c_str() , &amp;sbFileInfo) != 0)
-	{// begin can't stat file
-		JS_ReportError(cx, &quot;include() Can't stat \&quot;%s\&quot; errno(%i).&quot;, sRealPath.c_str(), errno);
-		return JS_FALSE;
-	}// end can't stat file
-
-	for(int i = 0;i &lt; g_vIncludes.size();i++)
-	{// begin check previous includes
-		if(g_vIncludes[i] == sRealPath)
-		{// begin found
-			printf(&quot;include() Warning: Duplicated include of \&quot;%s\&quot;...ignoring.\n&quot;,sRealPath.c_str());
-			return JS_TRUE;
-		}// end found
-	}// end check previous includes
-	g_vIncludes.push_back(sRealPath);
-
-	JSScript *pJSScript = JS_CompileFile(cx, obj, sRealPath.c_str());
-	jsval lastRval;
-	if(pJSScript != NULL)
-	{// begin execute external file
-		JSBool ok = JS_ExecuteScript(cx, obj, pJSScript, &amp;lastRval);
-		JS_DestroyScript(cx,pJSScript);
-		*rval = BOOLEAN_TO_JSVAL(ok);
-	}// end execute external file
-	else
-	{// begin error including
-		JS_ReportError(cx, &quot;include() Cannot compile file \&quot;%s\&quot;&quot;, pIncludeFile);
-		return JS_FALSE;
-	}// end error including
-	return JS_TRUE;
-}// end systemInclude
-
-/********************** Extract Path from a filename **************/
-JSBool pathOnly(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval)
-{// begin systemExecute
-	// default return value
-  *rval = INT_TO_JSVAL(-1);
-
-  if(argc != 1)
-    return JS_FALSE;
-  if(JSVAL_IS_STRING(argv[0]) == false )
-    return JS_FALSE;
-  char *name=NULL;
-  char *orgName = JS_GetStringBytes(JSVAL_TO_STRING(argv[0]));
-  ADM_PathStripName(orgName);
-  /* Remove last / or last \ */
-  int l=strlen(orgName);
-  if(l) orgName[l-1]=0;
-  *rval=STRING_TO_JSVAL(JS_NewStringCopyZ(cx,orgName));
-  return JS_TRUE;
-}// end systemExecute
-
-
-//EOF 

Deleted: branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script/ADM_JSFunctions.cpp.orig
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script/ADM_JSFunctions.cpp.orig	2010-02-18 06:18:53 UTC (rev 5938)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script/ADM_JSFunctions.cpp.orig	2010-02-20 07:52:21 UTC (rev 5939)
@@ -1,882 +0,0 @@
-// C++ Interface: Spider Monkey interface
-//
-// Description: 
-//
-//
-// Author: Anish Mistry
-//      Some modification by mean
-//
-// Copyright: See COPYING file that comes with this distribution
-//
-//
-#include &quot;config.h&quot;
-#include &lt;stdlib.h&gt;
-#include &lt;unistd.h&gt;
-#include &lt;sys/types.h&gt;
-#include &lt;sys/stat.h&gt;
-#ifndef ADM_WIN32
-#include &lt;sys/wait.h&gt;
-#include &lt;sys/param.h&gt;
-#endif
-#include &lt;errno.h&gt;
-#include &lt;dirent.h&gt;
-#include &lt;limits.h&gt;
-#include &lt;math.h&gt;
-#include &lt;vector&gt;
-#include &lt;string&gt;
-#include &quot;ADM_JSAvidemux.h&quot;
-#include &quot;ADM_JSGlobal.h&quot;
-#include &quot;ADM_default.h&quot;
-#include &quot;DIA_coreToolkit.h&quot;
-#include &quot;ADM_editor/ADM_outputfmt.h&quot;
-#include &quot;audioeng_buildfilters.h&quot;
-#include &quot;adm_scanner.h&quot; 
-#include &quot;avi_vars.h&quot;
-#include &quot;gui_action.hxx&quot;
-#include &quot;ADM_encoder/ADM_vidEncode.hxx&quot;
-#include &quot;ADM_videoFilter.h&quot;
-#include &quot;ADM_encoder/adm_encoder.h&quot;
-#include &quot;ADM_encoder/adm_encConfig.h&quot;
-#include &quot;ADM_editor/ADM_outputfmt.h&quot;
-
-#include &quot;ADM_script/ADM_container.h&quot;
-
-#include &quot;ADM_JSGlobal.h&quot;
-#include &quot;DIA_fileSel.h&quot;
-
-#include &quot;DIA_factory.h&quot;
-
-std::vector &lt;std::string&gt; g_vIncludes;
-extern char **environ;
-extern char *script_getVar(char *in, int *r);
-
-JSBool displayError(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval);
-JSBool displayInfo(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval);
-JSBool fileWriteSelect(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval);
-JSBool dirSelect(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval);
-JSBool fileReadSelect(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval);
-JSBool print(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval);
-
-JSBool allFilesFrom(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval);
-JSBool nextFile(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval);
-JSBool setSuccess(JSContext *cx, JSObject *obj, uintN argc, 
-                                       jsval *argv, jsval *rval);
-JSBool getVar(JSContext *cx, JSObject *obj, uintN argc, 
-                                       jsval *argv, jsval *rval);
-JSBool systemExecute(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval);
-JSBool systemInclude(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval);
-JSBool pathOnly(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval);
-
-JSBool facInt(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval);
-JSBool facFloat(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval);
-JSBool facToggle(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval);
-JSBool facMenu(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval);
-JSBool facFile(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval);
-JSBool facBitrate(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval);
-JSBool facBar(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval);
-JSBool facRoText(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval);
-JSBool facText(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval);
-JSBool facTab(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval);
-JSBool facFrame(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval);
-JSBool facHex(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval);
-JSBool facDirSel(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval);
-JSBool facButton(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval);
-JSBool facMatrix(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval);
-JSBool facNotch(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval);
-JSBool facThreadCount(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval);
-JSBool facSlider(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval);
-JSBool crashTest(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval);
-JSBool assertTest(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval);
-
-
-static JSFunctionSpec adm_functions[] = {
-  /*    name          native          nargs    */
-  {&quot;displayError&quot;,      displayError,         1},
-  {&quot;displayInfo&quot;,       displayInfo,        1},
-  {&quot;fileReadSelect&quot;,    fileReadSelect,        0},
-  {&quot;fileWriteSelect&quot;,   fileWriteSelect,        0},
-  {&quot;dirSelect&quot;,         dirSelect,        0},
-  {&quot;print&quot;,             print,        1},
-  {&quot;allFilesFrom&quot;,      allFilesFrom,        0},
-  {&quot;nextFile&quot;,          nextFile,        0},
-  {&quot;setSuccess&quot;,          setSuccess,        1},
-  {&quot;getVar&quot;,          getVar,        1},
-  {&quot;exec&quot;,          systemExecute,        3},
-  {&quot;include&quot;,          systemInclude,        1},
-  {&quot;pathOnly&quot;,          pathOnly,        1},
-  {&quot;dialogFactoryInt&quot;,          facInt,           0},
-  {&quot;dialogFactoryFloat&quot;,        facFloat,         0},
-  {&quot;dialogFactoryToggle&quot;,       facToggle,        0},
-  {&quot;dialogFactoryMenu&quot;,         facMenu,          0},
-  {&quot;dialogFactoryFileSel&quot;,      facFile,          0},
-  {&quot;dialogFactoryBitrate&quot;,      facBitrate,       0},
-  {&quot;dialogFactoryBar&quot;,        facBar,             0},
-  {&quot;dialogFactoryRoText&quot;,     facRoText,          0},
-  {&quot;dialogFactoryText&quot;,       facText,            0},
-  {&quot;dialogFactoryTabs&quot;,       facTab,             0},
-  {&quot;dialogFactoryDirSel&quot;,       facDirSel,        0},
-  {&quot;dialogFactoryFrame&quot;,       facFrame,          0},
-  {&quot;dialogFactoryHex&quot;,       facHex,              0},
-  {&quot;dialogFactoryButton&quot;,       facButton,        0},
-  {&quot;dialogFactorySlider&quot;,       facSlider,        0},
-  {&quot;dialogFactoryMatrix&quot;,       facMatrix,        0},
-  {&quot;dialogFactoryNotch&quot;,       facNotch,		  0},
-  {&quot;dialogFactoryThreadCount&quot;, facThreadCount,		  0},
-  {&quot;crashTest&quot;,               crashTest,          0},
-  {&quot;assertTest&quot;,               assertTest,        0},
-  {0}
-};
-
-uint8_t JS_AvidemuxFunction(JSContext *cx,JSObject *global)
-{
-	if(JS_DefineFunctions(cx, global, adm_functions) == true)
-		return 1;
-
-	printf(&quot;JSAvidemuxFunction: Unable to define functions\n&quot;);
-	return 0;
-}
-
-JSBool getVar(JSContext *cx, JSObject *obj, uintN argc, 
-                                       jsval *argv, jsval *rval)
-{// begin getVar
-        int out=0;
-        char *dupe=NULL;
-
-        // default return value
-        if(argc != 1)
-                return JS_FALSE;
-	if(JSVAL_IS_STRING(argv[0]) == false)
-		return JS_FALSE;
-	char  *stringa = JS_GetStringBytes(JSVAL_TO_STRING(argv[0]));
-	dupe=script_getVar(stringa ,&amp;out);
-
-	if(!dupe)
-		return JS_FALSE;
-	// if out=1 it is a string else a number
-	if(out)
-		*rval = STRING_TO_JSVAL(JS_NewStringCopyZ(cx,dupe));
-	else
-		*rval = INT_TO_JSVAL(atoi(dupe));
-	return JS_TRUE;
-}// end getVar
-
-JSBool setSuccess(JSContext *cx, JSObject *obj, uintN argc, 
-                                       jsval *argv, jsval *rval)
-{// begin setSuccess
-	bool Jscript_succeed = false;
-	// default return value
-	if(argc != 1)
-		return JS_FALSE;
-	if(JSVAL_IS_BOOLEAN(argv[0]) == false)
-		return JS_FALSE;
-	Jscript_succeed = JSVAL_TO_BOOLEAN(argv[0]);
-	JS_setSuccess(Jscript_succeed);
-
-	return JS_TRUE;
-}// end setSuccess
-
-JSBool displayError(JSContext *cx, JSObject *obj, uintN argc, 
-                                       jsval *argv, jsval *rval)
-{// begin displayError
-	// default return value
-	if(argc != 1)
-		return JS_FALSE;
-	if(JSVAL_IS_STRING(argv[0]) == false)
-		return JS_FALSE;
-	char  *stringa = JS_GetStringBytes(JSVAL_TO_STRING(argv[0]));
-	GUI_Verbose();
-	GUI_Error_HIG(&quot;Error&quot;,stringa);
-	GUI_Quiet();
-
-	return JS_TRUE;
-}// end displayError
-JSBool displayInfo(JSContext *cx, JSObject *obj, uintN argc, 
-                                       jsval *argv, jsval *rval)
-{// begin displayInfo
-	// default return value
-	if(argc != 1)
-		return JS_FALSE;
-	if(JSVAL_IS_STRING(argv[0]) == false)
-		return JS_FALSE;
-	char  *stringa = JS_GetStringBytes(JSVAL_TO_STRING(argv[0]));
-	GUI_Verbose();
-	GUI_Info_HIG(ADM_LOG_IMPORTANT,&quot;Info&quot;,stringa);
-	GUI_Quiet();
-	return JS_TRUE;
-}// end displayInfo
-
-JSBool fileReadSelect(JSContext *cx, JSObject *obj, uintN argc, 
-                                       jsval *argv, jsval *rval)
-{// begin fileReadSelect
-        char *name;
-        // default return value
-        if(argc != 0)
-                return JS_FALSE;
-        if(!name) return JS_FALSE;
-        GUI_FileSelRead(&quot;Open file (Read mode)&quot;, &amp;name);
-        *rval=STRING_TO_JSVAL(JS_NewStringCopyZ(cx,name));
-        ADM_dealloc(name);
-        return JS_TRUE;
-}// end fileReadSelect
-
-JSBool fileWriteSelect(JSContext *cx, JSObject *obj, uintN argc, 
-                                       jsval *argv, jsval *rval)
-{// begin fileWriteSelect
-        char *name;
-        // default return value
-        if(argc != 0)
-                return JS_FALSE;
-        GUI_FileSelWrite(&quot;Open file (Write mode)&quot;, &amp;name);
-        if(!name) return JS_FALSE;
-        *rval=STRING_TO_JSVAL(JS_NewStringCopyZ(cx,name));
-        ADM_dealloc(name);
-        return JS_TRUE;
-}// end fileWriteSelect
-JSBool dirSelect(JSContext *cx, JSObject *obj, uintN argc, 
-                                       jsval *argv, jsval *rval)
-{
-        char name[1024];
-        // default return value
-        if(argc != 0)
-                return JS_FALSE;
-        if(!FileSel_SelectDir(QT_TR_NOOP(&quot;Select a directory&quot;),name,1023, NULL))
-         return JS_FALSE;
-        *rval=STRING_TO_JSVAL(JS_NewStringCopyZ(cx,name));
-        return JS_TRUE;
-}
-JSBool print(JSContext *cx, JSObject *obj, uintN argc, 
-                                       jsval *argv, jsval *rval)
-{// begin print
-        if(argc != 1)
-                return JS_FALSE;
-	fprintf(stderr,&quot;JSConsole: %s\n&quot;, JS_GetStringBytes(JS_ValueToString(cx, argv[0])));
-        return JS_TRUE;
-}// end print
-/*****************************************************
-        To process a whole directiry at a time
-*******************************************************/
-#define ADM_MAX_DIR 1024
-static char *dirs[ADM_MAX_DIR];
-static int dirmax=0;
-static int curdir=0;
-static void cleanup( void );
-void cleanup( void )
-{
-        for(int i=0;i&lt;dirmax;i++)
-                ADM_dealloc(dirs[i]);
-        dirmax=0;
-        curdir=0;
-}
-JSBool allFilesFrom(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval)
-{
-char *str;
-DIR *dir;
-struct dirent *direntry;
-       // ADM_JSAvidemux *p = (ADM_JSAvidemux *)JS_GetPrivate(cx, obj);
-        cleanup();
-        // default return value
-        if(argc != 1)
-                return JS_FALSE;
-	if(JSVAL_IS_STRING(argv[0]) == false)
-		return JS_FALSE;
-
-        str=JS_GetStringBytes(JSVAL_TO_STRING(argv[0]));
-        dir=opendir(str);
-        if(!dir)
-        {
-                *rval=INT_TO_JSVAL(0); // No files
-                return JS_TRUE;
-        }
-        while((direntry=readdir(dir)) &amp;&amp; dirmax&lt;ADM_MAX_DIR-1)
-        {
-                dirs[dirmax]=(char *)ADM_alloc(strlen(str)+strlen(direntry-&gt;d_name)+2);
-                strcpy(dirs[dirmax],str);
-                strcat(dirs[dirmax],direntry-&gt;d_name);
-                //printf(&quot;File:&lt;%s&gt;\n&quot;,dirs[dirmax]);
-                dirmax++;
-        }
-        closedir(dir);
-        *rval=INT_TO_JSVAL(dirmax);
-        return JS_TRUE;
-}
-
-JSBool nextFile(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval)
-{
-char *n;
-        if(argc != 0)
-                return JS_FALSE;
-
-        if(curdir==dirmax)
-        {
-                n=&quot;&quot;;
-        }
-        else
-        {
-                n=dirs[curdir++];
-        }
-        *rval=STRING_TO_JSVAL(JS_NewStringCopyZ(cx,n));
-        return JS_TRUE;
-}
-
-JSBool systemExecute(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval)
-{// begin systemExecute
-	// default return value
-	*rval = INT_TO_JSVAL(-1);
-
-	if(argc != 3)
-		return JS_FALSE;
-	if(JSVAL_IS_STRING(argv[0]) == false || JSVAL_IS_OBJECT(argv[1]) == false || JSVAL_IS_BOOLEAN(argv[2]) == false)
-		return JS_FALSE;
-
-	char *pExecutable = JS_GetStringBytes(JSVAL_TO_STRING(argv[0]));
-	JSObject *pArgs = JSVAL_TO_OBJECT(argv[1]);
-	bool bWait = JSVAL_TO_BOOLEAN(argv[2]);
-	int status = 0;
-	jsuint nArgsLength = 0;
-	jsval jsValue;
-	struct stat sbFileInfo;
-
-	if(JS_IsArrayObject(cx, pArgs) == false)
-		return JS_FALSE;
-
-	JS_GetArrayLength(cx,pArgs,&amp;nArgsLength);
-	char **args = new char *[JSVAL_TO_INT(nArgsLength)+2];
-	args[0] = pExecutable;
-	args[JSVAL_TO_INT(nArgsLength)+1] = NULL;
-
-	for(jsuint i = 1;i &lt;= nArgsLength;i++)
-	{
-		if(JS_GetElement(cx, pArgs, i, &amp;jsValue) == JS_FALSE)
-		{// begin failure to get item
-			JS_ReportError(cx, &quot;exec() JS_GetElement failed to get an array item.&quot;);
-			return JS_FALSE;
-		}// end failure to get item
-		args[JSVAL_TO_INT(i)] = JS_GetStringBytes(JSVAL_TO_STRING(jsValue));
-	}
-
-#ifndef ADM_WIN32
-	if(getuid() == 0)
-	{// begin running as root
-		JS_ReportError(cx, &quot;exec() disallowed while running as root.&quot;);
-		return JS_FALSE;
-	}// end running as root
-	if(stat(pExecutable , &amp;sbFileInfo) != 0)
-	{// begin can't stat file
-		JS_ReportError(cx, &quot;exec() Can't stat \&quot;%s\&quot; errno(%i).&quot;, pExecutable, errno);
-		return JS_FALSE;
-	}// end can't stat file
-	if((sbFileInfo.st_mode &amp; S_ISUID) == S_ISUID || (sbFileInfo.st_mode &amp; S_ISGID) == S_ISGID)
-	{// begin setuid/setgid files disallowed
-		JS_ReportError(cx, &quot;exec() disallowed execution of \&quot;%s\&quot; since it is a setuid/setgid file.&quot;, pExecutable);
-		return JS_FALSE;
-	}// end setuid/setgid files disallowed
-#endif
-
-        enterLock();
-	// clear file descriptor table of forked process and fork
-#if defined( __linux__) || defined(__macosx__) || defined(__APPLE__) || defined(__CYGWIN__)
-	pid_t pidRtn = fork();
-#elif defined(__FreeBSD__) || defined(__OpenBSD__)
-	pid_t pidRtn = rfork(RFPROC|RFCFDG);
-#endif
-
-#ifdef ADM_WIN32
-	intptr_t pidRtn = spawnvpe(bWait ? P_WAIT : P_NOWAIT, pExecutable, args, environ);
-	#define WEXITSTATUS
-#else
-	if(pidRtn == 0)
-	{// begin child process
-#if defined( __linux__) || defined(__macosx__) || defined(__APPLE__) || defined(__CYGWIN__)
-		close(STDIN_FILENO);
-		close(STDOUT_FILENO);
-		close(STDERR_FILENO);
-#endif
-		char **pEnv = environ;
-		//char *pEnv[] = {NULL};
-		execve(pExecutable,args,pEnv);
-		printf(&quot;Error: execve failure errno(%d)\n&quot;,errno);
-		_exit(errno);
-	}// end child process
-	else if(bWait &amp;&amp; pidRtn != -1)
-	{// begin wait for execution to finish
-		printf(&quot;Waiting on pid %d...&quot;,pidRtn);
-		do
-		{// begin wait for child
-			waitpid(pidRtn,&amp;status,WUNTRACED);
-		}// end wait for child
-		while(WIFEXITED(status) == false &amp;&amp; WIFSIGNALED(status) == false);
-		printf(&quot;Done...\n&quot;);
-	}// end wait for execution to finish
-	else if(pidRtn == -1)
-	{// begin rfork failure
-		printf(&quot;Error: execve failure errno(%d)\n&quot;,errno);
-	}// end rfork failure
-#endif
-
-        leaveLock();
-
-	// cleanup
-	delete []args;
-	if(pidRtn != -1)
-		*rval = INT_TO_JSVAL(WEXITSTATUS(status));	// success return child's exit status
-	else
-		*rval = INT_TO_JSVAL(-1);	// failure
-	return JS_TRUE;
-}// end systemExecute
-#ifdef ADM_WIN32
-
-JSBool systemInclude(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval)
-{
-		return JS_FALSE;
-}
-#else
-
-JSBool systemInclude(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval)
-{// begin systemInclude
-	// default return value
-	*rval = BOOLEAN_TO_JSVAL(false);
-	if(argc != 1)
-		return JS_FALSE;
-	if(JSVAL_IS_STRING(argv[0]) == false)
-		return JS_FALSE;
-
-	struct stat sbFileInfo;
-	const char *pIncludeFile = JS_GetStringBytes(JSVAL_TO_STRING(argv[0]));
-	// make sure we haven't included this already to avoid a recursive
-	// dependency loop
-	char *pTempStr = new char[PATH_MAX+1];
-	if(realpath(pIncludeFile,pTempStr) == NULL)
-	{// begin can't resolve path
-		JS_ReportError(cx, &quot;include() can't resolve the path of \&quot;%s\&quot;.&quot;, pIncludeFile);
-		return JS_FALSE;
-	}// end can't resolve path
-
-	std::string sRealPath = pTempStr;
-	if(stat(sRealPath.c_str() , &amp;sbFileInfo) != 0)
-	{// begin can't stat file
-		JS_ReportError(cx, &quot;include() Can't stat \&quot;%s\&quot; errno(%i).&quot;, sRealPath.c_str(), errno);
-		return JS_FALSE;
-	}// end can't stat file
-
-	for(int i = 0;i &lt; g_vIncludes.size();i++)
-	{// begin check previous includes
-		if(g_vIncludes[i] == sRealPath)
-		{// begin found
-			printf(&quot;include() Warning: Duplicated include of \&quot;%s\&quot;...ignoring.\n&quot;,sRealPath.c_str());
-			return JS_TRUE;
-		}// end found
-	}// end check previous includes
-	g_vIncludes.push_back(sRealPath);
-
-	JSScript *pJSScript = JS_CompileFile(cx, obj, sRealPath.c_str());
-	jsval lastRval;
-	if(pJSScript != NULL)
-	{// begin execute external file
-		JSBool ok = JS_ExecuteScript(cx, obj, pJSScript, &amp;lastRval);
-		JS_DestroyScript(cx,pJSScript);
-		*rval = BOOLEAN_TO_JSVAL(ok);
-	}// end execute external file
-	else
-	{// begin error including
-		JS_ReportError(cx, &quot;include() Cannot compile file \&quot;%s\&quot;&quot;, pIncludeFile);
-		return JS_FALSE;
-	}// end error including
-	return JS_TRUE;
-}// end systemInclude
-#endif
-
-/********************** Extract Path from a filename **************/
-JSBool pathOnly(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval)
-{// begin systemExecute
-	// default return value
-  *rval = INT_TO_JSVAL(-1);
-
-  if(argc != 1)
-    return JS_FALSE;
-  if(JSVAL_IS_STRING(argv[0]) == false )
-    return JS_FALSE;
-  char *name=NULL;
-  char *orgName = JS_GetStringBytes(JSVAL_TO_STRING(argv[0]));
-  ADM_PathStripName(orgName);
-  /* Remove last / or last \ */
-  int l=strlen(orgName);
-  if(l) orgName[l-1]=0;
-  *rval=STRING_TO_JSVAL(JS_NewStringCopyZ(cx,orgName));
-  return JS_TRUE;
-}// end systemExecute
-
-JSBool facInt(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval)
-{
-  uint32_t tog=0;
-   diaElemUInteger blend(&amp;tog,QT_TR_NOOP(&quot;Uinteger&quot;),0,255);
-    diaElem *elems[]={&amp;blend   };
-    
-  if(diaFactoryRun(QT_TR_NOOP(&quot;Test uinteger&quot;),1,elems))
-  {
-    *rval = BOOLEAN_TO_JSVAL(1);
-    printf(&quot;Value : %u\n&quot;,tog);
-  }else
-    *rval = BOOLEAN_TO_JSVAL(0);
-  
-  return JS_TRUE;
-}
-JSBool facFloat(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval)
-{
-  ELEM_TYPE_FLOAT tog=0;
-   diaElemFloat blend(&amp;tog,QT_TR_NOOP(&quot;Float&quot;),0,255);
-    diaElem *elems[]={&amp;blend   };
-    
-  if(diaFactoryRun(&quot;Test float&quot;,1,elems))
-  {
-    *rval = BOOLEAN_TO_JSVAL(1);
-    printf(&quot;Value : %f\n&quot;,(float)tog);
-  }else
-    *rval = BOOLEAN_TO_JSVAL(0);
-  
-  
-  return JS_TRUE;
-}
-
-JSBool facToggle(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval)
-{
-  uint32_t tog=0;
-  uint32_t test=0;
-   diaElemToggle blend(&amp;tog,QT_TR_NOOP(&quot;Toggle&quot;));
-    diaElemUInteger     bt(&amp;test,&quot;Entry&quot;,0,10);
-    diaElemUInteger     bt2(&amp;test,&quot;Entry&quot;,0,10);
-    diaElem *elems[]={&amp;blend,&amp;bt,&amp;bt2   };
-    blend.link(1,&amp;bt);
-    blend.link(0,&amp;bt2);
-    
-  if(diaFactoryRun(&quot;Test Toggle&quot;,3,elems))
-  {
-    *rval = BOOLEAN_TO_JSVAL(1);
-    printf(&quot;Value : %u\n&quot;,tog);
-  }else
-    *rval = BOOLEAN_TO_JSVAL(0);
-  return JS_TRUE;
-}
-
-JSBool facMenu(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval)
-{
-   uint32_t tog=4;
-   ELEM_TYPE_FLOAT f=1; 
-   
-    diaMenuEntry menu[]={
-                             {2,   QT_TR_NOOP(&quot;No Strategy&quot;),NULL},
-                             {4,     QT_TR_NOOP(&quot;3:2 Pulldown&quot;),NULL},
-                             {6,     QT_TR_NOOP(&quot;Pal/Secam&quot;),NULL},
-                             {7,  QT_TR_NOOP(&quot;NTSC converted from PAL&quot;),NULL}
-                          };
-   diaElemMenu blend(&amp;tog,QT_TR_NOOP(&quot;menu&quot;),4,menu);
-    
-    // Link it to another
-    diaElemFloat toggle(&amp;f,&quot;Linked float&quot;,1,2);
-    blend.link(&amp;(menu[1]),1,&amp;toggle);
-    //
-diaElem *elems[]={&amp;blend,&amp;toggle   };
-  if(diaFactoryRun(&quot;Test Menu&quot;,2,elems))
-  {
-    *rval = BOOLEAN_TO_JSVAL(1);
-    printf(&quot;Value : %u\n&quot;,tog);
-  }else
-    *rval = BOOLEAN_TO_JSVAL(0);
-  return JS_TRUE;
-}
-JSBool facFile(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval)
-{
-   uint32_t tog=0;
-   char *test=ADM_strdup(&quot;Entry test1&quot;);
-    
-      diaElemFile fread(0,&amp;test,&quot;Entry&quot;);
-      diaElem *elems[]={&amp;fread   };
-  if(diaFactoryRun(&quot;Test FileRead&quot;,1,elems))
-  {
-    *rval = BOOLEAN_TO_JSVAL(1);
-    printf(&quot;Value : &lt;%s&gt;\n&quot;,test);
-  }else
-    *rval = BOOLEAN_TO_JSVAL(0);
-  if(test) ADM_dealloc(test);
-  return JS_TRUE;
-}
-JSBool facDirSel(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval)
-{
-   uint32_t tog=0;
-   char *test=ADM_strdup(&quot;Entry test1&quot;);
-    
-      diaElemDirSelect fread(&amp;test,&quot;Entry&quot;);
-      diaElem *elems[]={&amp;fread   };
-  if(diaFactoryRun(&quot;Test DirSel&quot;,1,elems))
-  {
-    *rval = BOOLEAN_TO_JSVAL(1);
-    printf(&quot;Value : &lt;%s&gt;\n&quot;,test);
-  }else
-    *rval = BOOLEAN_TO_JSVAL(0);
-  if(test) ADM_dealloc(test);
-  return JS_TRUE;
-}
-
-JSBool facBitrate(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval)
-{
-   COMPRES_PARAMS test={
-  CodecYV12,
-  &quot;YV12 (raw)&quot;,
-  &quot;YV12&quot;,
-  &quot;YV12&quot;,
-  COMPRESS_CQ,
-  1,
-  1500,
-  700,
-  1000,
-  ADM_ENC_CAP_CQ,
-  0,
-  NULL,
-  0,
-  NULL
-};
-    
-      diaElemBitrate bt(&amp;test,&quot;Entry&quot;);
-      diaElem *elems[]={&amp;bt   };
-  if(diaFactoryRun(&quot;Test FileRead&quot;,1,elems))
-  {
-    *rval = BOOLEAN_TO_JSVAL(1);
-    
-  }else
-    *rval = BOOLEAN_TO_JSVAL(0);
-  
-  return JS_TRUE;
-}
-JSBool facBar(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval)
-{
-    
-      diaElemBar bar1(25,&quot;25&quot;);
-      diaElemBar bar2(65,&quot;65&quot;);
-      diaElem *elems[]={&amp;bar1,&amp;bar2   };
-  if(diaFactoryRun(&quot;Test FileRead&quot;,2,elems))
-  {
-    *rval = BOOLEAN_TO_JSVAL(1);
-    
-  }else
-    *rval = BOOLEAN_TO_JSVAL(0);
-  
-  return JS_TRUE;
-}
-void clickMe(void *cookie)
-{
-  GUI_Error_HIG(&quot;Button&quot;,&quot;Button pressed!&quot;); 
-}
-JSBool facButton(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval)
-{
-    
-      diaElemButton bar1(&quot;Button&quot;,clickMe,NULL);
-      diaElem *elems[]={&amp;bar1   };
-  if(diaFactoryRun(&quot;Test Button&quot;,1,elems))
-  {
-    *rval = BOOLEAN_TO_JSVAL(1);
-    
-  }else
-    *rval = BOOLEAN_TO_JSVAL(0);
-  
-  return JS_TRUE;
-}
-JSBool facSlider(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval)
-{
-  int32_t val=4;
-      diaElemSlider slide(&amp;val,&quot;foo&quot;, 0,10);
-      
-      diaElem *elems[]={&amp;slide   };
-  if(diaFactoryRun(&quot;Test Slider&quot;,1,elems))
-  {
-    *rval = BOOLEAN_TO_JSVAL(1);
-    
-  }else
-    *rval = BOOLEAN_TO_JSVAL(0);
-  
-  return JS_TRUE;
-}
-JSBool facRoText(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval)
-{
-    
-      diaElemReadOnlyText txt(&quot;blah blah&quot;,&quot;Value:&quot;);
-      
-      diaElem *elems[]={&amp;txt   };
-  if(diaFactoryRun(&quot;Test FileRead&quot;,1,elems))
-  {
-    *rval = BOOLEAN_TO_JSVAL(1);
-    
-  }else
-    *rval = BOOLEAN_TO_JSVAL(0);
-  
-  return JS_TRUE;
-}
-JSBool facText(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval)
-{
-    
-      char *foo=ADM_strdup(&quot;blah&quot;);
-      diaElemText txt(&amp;foo,&quot;Text&quot;,NULL);
-      
-      diaElem *elems[]={&amp;txt   };
-  if(diaFactoryRun(&quot;Test FileRead&quot;,1,elems))
-  {
-    *rval = BOOLEAN_TO_JSVAL(1);
-    
-  }else
-    *rval = BOOLEAN_TO_JSVAL(0);
-  
-  return JS_TRUE;
-}
-
-JSBool facTab(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval)
-{
-    
-      uint32_t test,test2;
-      
-      diaElemReadOnlyText txt(&quot;blah blah&quot;,&quot;Value:&quot;);
-      diaElemUInteger     bt(&amp;test,&quot;Entry&quot;,0,10);
-      diaElemUInteger     bt2(&amp;test2,&quot;Entry&quot;,0,10);
-      
-      
-      diaElem *elems1[]={&amp;txt   };
-      diaElem *elems2[]={&amp;bt,&amp;bt2   };
-      
-      diaElemTabs tab1(&quot;T1&quot;,1,(diaElem **)elems1);
-      diaElemTabs tab2(&quot;T2&quot;,2,(diaElem **)elems2);
-      
-      diaElemTabs *tabs[2]={&amp;tab1,&amp;tab2};
-          
-      
-  if(diaFactoryRunTabs(&quot;Test FileRead&quot;,2,tabs))
-  {
-    *rval = BOOLEAN_TO_JSVAL(1);
-    
-  }else
-    *rval = BOOLEAN_TO_JSVAL(0);
-  
-  return JS_TRUE;
-}
-JSBool facFrame(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval)
-{
-    
-      uint32_t test,test2;
-      
-      diaElemReadOnlyText align(&quot;*****&quot;,&quot;Value:&quot;);
-      diaElemReadOnlyText txt(&quot;blah blah&quot;,&quot;Value:&quot;);
-      diaElemUInteger     bt(&amp;test,&quot;Entry1&quot;,0,10);
-      diaElemUInteger     bt2(&amp;test2,&quot;Entry2&quot;,0,10);
-      diaElemFrame        frm(&quot;Frame1&quot;);
-      
-      frm.swallow(&amp;txt);
-      frm.swallow(&amp;bt);
-      frm.swallow(&amp;bt2);
-      
-         diaElem *elems[]={&amp;align,&amp;frm   };
-  if(diaFactoryRun(&quot;Test frame&quot;,2,elems))
-  {
-    *rval = BOOLEAN_TO_JSVAL(1);
-    
-  }else
-    *rval = BOOLEAN_TO_JSVAL(0);
-  
-  return JS_TRUE;
-      
-      
-}
-
-
-JSBool facHex(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval)
-{
-    
-      uint8_t data[100];
-      for(int i=0;i&lt;100;i++) data[i]=i;
-      
-      diaElemHex binhex(&quot;*****&quot;,100,data);
-      
-      
-         diaElem *elems[]={&amp;binhex   };
-  if(diaFactoryRun(&quot;Test binHex&quot;,1,elems))
-  {
-    *rval = BOOLEAN_TO_JSVAL(1);
-    
-  }else
-    *rval = BOOLEAN_TO_JSVAL(0);
-  
-  return JS_TRUE;
-      
-      
-}
-JSBool facMatrix(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval)
-{
-    
-      uint8_t data[16];
-      for(int i=0;i&lt;100;i++) data[i]=i;
-      
-      diaElemMatrix Matrix(data,&quot;Matrix&quot;,4);
-      
-      
-         diaElem *elems[]={&amp;Matrix   };
-  if(diaFactoryRun(&quot;Test Matrix&quot;,1,elems))
-  {
-    *rval = BOOLEAN_TO_JSVAL(1);
-    
-  }else
-    *rval = BOOLEAN_TO_JSVAL(0);
-  
-  for(int x=0;x&lt;4*4;x++)
-  {
-	  if(x &amp;&amp; !(x&amp;3)) printf(&quot;\n&quot;);
-	  printf(&quot;%02x &quot;,data[x]);
-	  
-  }
-  
-  return JS_TRUE;
-      
-      
-}
-JSBool facThreadCount(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval)
-{
-	uint32_t val=1;
-	diaElemThreadCount threadcount(&amp;val,&quot;ThreadCount&quot;);
-      
-    diaElem *elems[]={&amp;threadcount   };
-    
-  if(diaFactoryRun(&quot;Test ThreadCount&quot;,1,elems))
-  {
-    *rval = BOOLEAN_TO_JSVAL(1);
-    
-  }else
-    *rval = BOOLEAN_TO_JSVAL(0);
-  return JS_TRUE;
-      
-}
-JSBool facNotch(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval)
-{
-    
-	diaElemNotch notch(1,&quot;Notch&quot;);
-      
-         diaElem *elems[]={&amp;notch   };
-  if(diaFactoryRun(&quot;Test Notch&quot;,1,elems))
-  {
-    *rval = BOOLEAN_TO_JSVAL(1);
-    
-  }else
-    *rval = BOOLEAN_TO_JSVAL(0);
-  return JS_TRUE;
-      
-      
-}
-
-JSBool crashTest(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval)
-{
-  
-  int *foobar=NULL;
-  *foobar=0; // CRASH!
-  return JS_TRUE;
-}
-JSBool assertTest(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval)
-{
-  
-  ADM_assert(0);
-  return JS_TRUE;
-}
-
-//EOF 

Deleted: branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script/ADM_JSFunctionsNonRegFactory.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script/ADM_JSFunctionsNonRegFactory.cpp	2010-02-18 06:18:53 UTC (rev 5938)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script/ADM_JSFunctionsNonRegFactory.cpp	2010-02-20 07:52:21 UTC (rev 5939)
@@ -1,427 +0,0 @@
-// C++ Interface: Spider Monkey interface
-//
-// Description: 
-//
-//
-// Author: Anish Mistry
-//      Some modification by mean
-//
-// Copyright: See COPYING file that comes with this distribution
-//
-//
-#include &lt;string&gt;
-#include &quot;ADM_default.h&quot;
-#include &lt;sys/types.h&gt;
-#include &lt;sys/stat.h&gt;
-#if defined( ADM_WIN32 ) || defined(__MINGW32__)
-#define ADM_JS_WIN32
-#endif
-
-#ifndef ADM_JS_WIN32
-#include &lt;sys/wait.h&gt;
-#include &lt;sys/param.h&gt;
-#endif
-#include &lt;errno.h&gt;
-#include &lt;dirent.h&gt;
-#include &lt;limits.h&gt;
-#include &lt;math.h&gt;
-#include &lt;vector&gt;
-#include &quot;ADM_JSAvidemux.h&quot;
-#include &quot;ADM_JSGlobal.h&quot;
-#include &quot;ADM_default.h&quot;
-#include &quot;DIA_coreToolkit.h&quot;
-#include &quot;ADM_editor/ADM_outputfmt.h&quot;
-#include &quot;adm_scanner.h&quot; 
-#include &quot;avi_vars.h&quot;
-#include &quot;gui_action.hxx&quot;
-
-//#include &quot;ADM_videoFilter.h&quot;
-#include &quot;ADM_editor/ADM_outputfmt.h&quot;
-
-#include &quot;ADM_script/ADM_container.h&quot;
-
-#include &quot;ADM_JSGlobal.h&quot;
-#include &quot;DIA_fileSel.h&quot;
-
-#include &quot;DIA_factory.h&quot;
-
-
-extern char **environ;
-extern char *script_getVar(char *in, int *r);
-
-JSBool facInt(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval);
-JSBool facFloat(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval);
-JSBool facToggle(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval);
-JSBool facMenu(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval);
-JSBool facFile(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval);
-JSBool facBitrate(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval);
-JSBool facBar(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval);
-JSBool facRoText(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval);
-JSBool facText(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval);
-JSBool facTab(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval);
-JSBool facFrame(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval);
-JSBool facHex(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval);
-JSBool facDirSel(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval);
-JSBool facButton(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval);
-JSBool facMatrix(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval);
-JSBool facNotch(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval);
-JSBool facThreadCount(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval);
-JSBool facSlider(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval);
-JSBool crashTest(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval);
-JSBool assertTest(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval);
-
-JSBool facInt(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval)
-{
-  uint32_t tog=0;
-   diaElemUInteger blend(&amp;tog,QT_TR_NOOP(&quot;Uinteger&quot;),0,255);
-    diaElem *elems[]={&amp;blend   };
-    
-  if(diaFactoryRun(QT_TR_NOOP(&quot;Test uinteger&quot;),1,elems))
-  {
-    *rval = BOOLEAN_TO_JSVAL(1);
-    printf(&quot;Value : %u\n&quot;,tog);
-  }else
-    *rval = BOOLEAN_TO_JSVAL(0);
-  
-  return JS_TRUE;
-}
-JSBool facFloat(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval)
-{
-  ELEM_TYPE_FLOAT tog=0;
-   diaElemFloat blend(&amp;tog,QT_TR_NOOP(&quot;Float&quot;),0,255);
-    diaElem *elems[]={&amp;blend   };
-    
-  if(diaFactoryRun(&quot;Test float&quot;,1,elems))
-  {
-    *rval = BOOLEAN_TO_JSVAL(1);
-    printf(&quot;Value : %f\n&quot;,(float)tog);
-  }else
-    *rval = BOOLEAN_TO_JSVAL(0);
-  
-  
-  return JS_TRUE;
-}
-
-JSBool facToggle(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval)
-{
-  uint32_t tog=0;
-  uint32_t test=0;
-   diaElemToggle blend(&amp;tog,QT_TR_NOOP(&quot;Toggle&quot;));
-    diaElemUInteger     bt(&amp;test,&quot;Entry&quot;,0,10);
-    diaElemUInteger     bt2(&amp;test,&quot;Entry&quot;,0,10);
-    diaElem *elems[]={&amp;blend,&amp;bt,&amp;bt2   };
-    blend.link(1,&amp;bt);
-    blend.link(0,&amp;bt2);
-    
-  if(diaFactoryRun(&quot;Test Toggle&quot;,3,elems))
-  {
-    *rval = BOOLEAN_TO_JSVAL(1);
-    printf(&quot;Value : %u\n&quot;,tog);
-  }else
-    *rval = BOOLEAN_TO_JSVAL(0);
-  return JS_TRUE;
-}
-
-JSBool facMenu(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval)
-{
-   uint32_t tog=4;
-   ELEM_TYPE_FLOAT f=1; 
-   
-    diaMenuEntry menu[]={
-                             {2,   QT_TR_NOOP(&quot;No Strategy&quot;),NULL},
-                             {4,     QT_TR_NOOP(&quot;3:2 Pulldown&quot;),NULL},
-                             {6,     QT_TR_NOOP(&quot;Pal/Secam&quot;),NULL},
-                             {7,  QT_TR_NOOP(&quot;NTSC converted from PAL&quot;),NULL}
-                          };
-   diaElemMenu blend(&amp;tog,QT_TR_NOOP(&quot;menu&quot;),4,menu);
-    
-    // Link it to another
-    diaElemFloat toggle(&amp;f,&quot;Linked float&quot;,1,2);
-    blend.link(&amp;(menu[1]),1,&amp;toggle);
-    //
-diaElem *elems[]={&amp;blend,&amp;toggle   };
-  if(diaFactoryRun(&quot;Test Menu&quot;,2,elems))
-  {
-    *rval = BOOLEAN_TO_JSVAL(1);
-    printf(&quot;Value : %u\n&quot;,tog);
-  }else
-    *rval = BOOLEAN_TO_JSVAL(0);
-  return JS_TRUE;
-}
-JSBool facFile(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval)
-{
-   uint32_t tog=0;
-   char *test=ADM_strdup(&quot;Entry test1&quot;);
-    
-      diaElemFile fread(0,&amp;test,&quot;Entry&quot;);
-      diaElem *elems[]={&amp;fread   };
-  if(diaFactoryRun(&quot;Test FileRead&quot;,1,elems))
-  {
-    *rval = BOOLEAN_TO_JSVAL(1);
-    printf(&quot;Value : &lt;%s&gt;\n&quot;,test);
-  }else
-    *rval = BOOLEAN_TO_JSVAL(0);
-  if(test) ADM_dealloc(test);
-  return JS_TRUE;
-}
-JSBool facDirSel(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval)
-{
-   uint32_t tog=0;
-   char *test=ADM_strdup(&quot;Entry test1&quot;);
-    
-      diaElemDirSelect fread(&amp;test,&quot;Entry&quot;);
-      diaElem *elems[]={&amp;fread   };
-  if(diaFactoryRun(&quot;Test DirSel&quot;,1,elems))
-  {
-    *rval = BOOLEAN_TO_JSVAL(1);
-    printf(&quot;Value : &lt;%s&gt;\n&quot;,test);
-  }else
-    *rval = BOOLEAN_TO_JSVAL(0);
-  if(test) ADM_dealloc(test);
-  return JS_TRUE;
-}
-
-JSBool facBitrate(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval)
-{
-
-   COMPRES_PARAMS test={
-  COMPRESS_CQ,
-  1,
-  1500,
-  700,
-  1000,
-  ADM_ENC_CAP_CQ+ADM_ENC_CAP_2PASS+ADM_ENC_CAP_CBR+ADM_ENC_CAP_SAME
-  };
-    
-      diaElemBitrate bt(&amp;test,&quot;Entry&quot;);
-      diaElem *elems[]={&amp;bt   };
-  if(diaFactoryRun(&quot;Test BitRate&quot;,1,elems))
-  {
-    *rval = BOOLEAN_TO_JSVAL(1);
-    
-  }else
-    *rval = BOOLEAN_TO_JSVAL(0);
-  return JS_TRUE;
-}
-
-JSBool facBar(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval)
-{
-    
-      diaElemBar bar1(25,&quot;25&quot;);
-      diaElemBar bar2(65,&quot;65&quot;);
-      diaElem *elems[]={&amp;bar1,&amp;bar2   };
-  if(diaFactoryRun(&quot;Test FileRead&quot;,2,elems))
-  {
-    *rval = BOOLEAN_TO_JSVAL(1);
-    
-  }else
-    *rval = BOOLEAN_TO_JSVAL(0);
-  
-  return JS_TRUE;
-}
-
-void clickMe(void *cookie)
-{
-  GUI_Error_HIG(&quot;Button&quot;,&quot;Button pressed!&quot;); 
-}
-JSBool facButton(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval)
-{
-    
-      diaElemButton bar1(&quot;Button&quot;,clickMe,NULL);
-      diaElem *elems[]={&amp;bar1   };
-  if(diaFactoryRun(&quot;Test Button&quot;,1,elems))
-  {
-    *rval = BOOLEAN_TO_JSVAL(1);
-    
-  }else
-    *rval = BOOLEAN_TO_JSVAL(0);
-  
-  return JS_TRUE;
-}
-JSBool facSlider(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval)
-{
-  int32_t val=4;
-      diaElemSlider slide(&amp;val,&quot;foo&quot;, 0,10);
-      
-      diaElem *elems[]={&amp;slide   };
-  if(diaFactoryRun(&quot;Test Slider&quot;,1,elems))
-  {
-    *rval = BOOLEAN_TO_JSVAL(1);
-    
-  }else
-    *rval = BOOLEAN_TO_JSVAL(0);
-  
-  return JS_TRUE;
-}
-JSBool facRoText(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval)
-{
-    
-      diaElemReadOnlyText txt(&quot;blah blah&quot;,&quot;Value:&quot;);
-      
-      diaElem *elems[]={&amp;txt   };
-  if(diaFactoryRun(&quot;Test FileRead&quot;,1,elems))
-  {
-    *rval = BOOLEAN_TO_JSVAL(1);
-    
-  }else
-    *rval = BOOLEAN_TO_JSVAL(0);
-  
-  return JS_TRUE;
-}
-JSBool facText(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval)
-{
-    
-      char *foo=ADM_strdup(&quot;blah&quot;);
-      diaElemText txt(&amp;foo,&quot;Text&quot;,NULL);
-      
-      diaElem *elems[]={&amp;txt   };
-  if(diaFactoryRun(&quot;Test FileRead&quot;,1,elems))
-  {
-    *rval = BOOLEAN_TO_JSVAL(1);
-    
-  }else
-    *rval = BOOLEAN_TO_JSVAL(0);
-  
-  return JS_TRUE;
-}
-
-JSBool facTab(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval)
-{
-    
-      uint32_t test,test2;
-      
-      diaElemReadOnlyText txt(&quot;blah blah&quot;,&quot;Value:&quot;);
-      diaElemUInteger     bt(&amp;test,&quot;Entry&quot;,0,10);
-      diaElemUInteger     bt2(&amp;test2,&quot;Entry&quot;,0,10);
-      
-      
-      diaElem *elems1[]={&amp;txt   };
-      diaElem *elems2[]={&amp;bt,&amp;bt2   };
-      
-      diaElemTabs tab1(&quot;T1&quot;,1,(diaElem **)elems1);
-      diaElemTabs tab2(&quot;T2&quot;,2,(diaElem **)elems2);
-      
-      diaElemTabs *tabs[2]={&amp;tab1,&amp;tab2};
-          
-      
-  if(diaFactoryRunTabs(&quot;Test FileRead&quot;,2,tabs))
-  {
-    *rval = BOOLEAN_TO_JSVAL(1);
-    
-  }else
-    *rval = BOOLEAN_TO_JSVAL(0);
-  
-  return JS_TRUE;
-}
-JSBool facFrame(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval)
-{
-    
-      uint32_t test,test2;
-      
-      diaElemReadOnlyText align(&quot;*****&quot;,&quot;Value:&quot;);
-      diaElemReadOnlyText txt(&quot;blah blah&quot;,&quot;Value:&quot;);
-      diaElemUInteger     bt(&amp;test,&quot;Entry1&quot;,0,10);
-      diaElemUInteger     bt2(&amp;test2,&quot;Entry2&quot;,0,10);
-      diaElemFrame        frm(&quot;Frame1&quot;);
-      
-      frm.swallow(&amp;txt);
-      frm.swallow(&amp;bt);
-      frm.swallow(&amp;bt2);
-      
-         diaElem *elems[]={&amp;align,&amp;frm   };
-  if(diaFactoryRun(&quot;Test frame&quot;,2,elems))
-  {
-    *rval = BOOLEAN_TO_JSVAL(1);
-    
-  }else
-    *rval = BOOLEAN_TO_JSVAL(0);
-  
-  return JS_TRUE;
-      
-      
-}
-
-
-JSBool facHex(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval)
-{
-    
-      uint8_t data[100];
-      for(int i=0;i&lt;100;i++) data[i]=i;
-      
-      diaElemHex binhex(&quot;*****&quot;,100,data);
-      
-      
-         diaElem *elems[]={&amp;binhex   };
-  if(diaFactoryRun(&quot;Test binHex&quot;,1,elems))
-  {
-    *rval = BOOLEAN_TO_JSVAL(1);
-    
-  }else
-    *rval = BOOLEAN_TO_JSVAL(0);
-  
-  return JS_TRUE;
-      
-      
-}
-JSBool facMatrix(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval)
-{
-    
-      uint8_t data[16];
-      for(int i=0;i&lt;100;i++) data[i]=i;
-      
-      diaElemMatrix Matrix(data,&quot;Matrix&quot;,4);
-      
-      
-         diaElem *elems[]={&amp;Matrix   };
-  if(diaFactoryRun(&quot;Test Matrix&quot;,1,elems))
-  {
-    *rval = BOOLEAN_TO_JSVAL(1);
-    
-  }else
-    *rval = BOOLEAN_TO_JSVAL(0);
-  
-  for(int x=0;x&lt;4*4;x++)
-  {
-	  if(x &amp;&amp; !(x&amp;3)) printf(&quot;\n&quot;);
-	  printf(&quot;%02x &quot;,data[x]);
-	  
-  }
-  
-  return JS_TRUE;
-      
-      
-}
-JSBool facThreadCount(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval)
-{
-	uint32_t val=1;
-	diaElemThreadCount threadcount(&amp;val,&quot;ThreadCount&quot;);
-      
-    diaElem *elems[]={&amp;threadcount   };
-    
-  if(diaFactoryRun(&quot;Test ThreadCount&quot;,1,elems))
-  {
-    *rval = BOOLEAN_TO_JSVAL(1);
-    
-  }else
-    *rval = BOOLEAN_TO_JSVAL(0);
-  return JS_TRUE;
-      
-}
-JSBool facNotch(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval)
-{
-    
-	diaElemNotch notch(1,&quot;Notch&quot;);
-      
-         diaElem *elems[]={&amp;notch   };
-  if(diaFactoryRun(&quot;Test Notch&quot;,1,elems))
-  {
-    *rval = BOOLEAN_TO_JSVAL(1);
-    
-  }else
-    *rval = BOOLEAN_TO_JSVAL(0);
-  return JS_TRUE;
-      
-      
-}
-
-//EOF 

Deleted: branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script/ADM_JSGlobal.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script/ADM_JSGlobal.cpp	2010-02-18 06:18:53 UTC (rev 5938)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script/ADM_JSGlobal.cpp	2010-02-20 07:52:21 UTC (rev 5939)
@@ -1,153 +0,0 @@
-/**
- * 
- * 
- */
-
-/***************************************************************************
- *                                                                         *
- *   This program is free software; you can redistribute it and/or modify  *
- *   it under the terms of the GNU General Public License as published by  *
- *   the Free Software Foundation; either version 2 of the License, or     *
- *   (at your option) any later version.                                   *
- *                                                                         *
- ***************************************************************************/
-#include &quot;ADM_default.h&quot;
-#include &lt;string.h&gt;
-#include &lt;pthread.h&gt;
-#include &quot;DIA_coreToolkit.h&quot;
-#include &quot;ADM_JSGlobal.h&quot;
-#include &quot;ADM_JSAvidemux.h&quot;
-#include &quot;ADM_JSDirectorySearch.h&quot;
-#include &quot;ADM_jsShell.h&quot;
-#include &lt;stdarg.h&gt;
-extern uint8_t JS_AvidemuxFunction(JSContext *cx,JSObject *global);
-extern bool JS_AvidemuxRegisterDebugFunction(JSContext *cx,JSObject *global);
-extern void A_Resync(void);
-extern bool isJsLogRedirected(void);
-extern char * actual_workbench_file;
-/**
-    \fn printJSError
-*/
-void  printJSError(JSContext *cx, const char *message, JSErrorReport *report)
-{// begin printJSError
-int quiet=GUI_isQuiet();
-char buf[4];
-FILE *fd = ADM_fopen(report-&gt;filename,&quot;rb&quot;);
-    if(quiet)
-            GUI_Verbose();
-	if( fd )
-    {
-		fread(buf,1,4,fd);
-		fclose(fd);
-	}
-	if( strncmp(buf,&quot;//AD&quot;,4) )
-    {
-            if (report-&gt;filename || report-&gt;lineno)
-                jsLog(JS_LOG_ERROR,&quot;%s: line %d:\nMsg: %s\n&quot;
-                              &quot;Not an ECMAScript file. Try open it with 'File' -&gt; 'Open...'&quot;,
-                              report-&gt;filename,
-                              report-&gt;lineno,
-                              message);
-            else
-                jsLog(JS_LOG_ERROR,&quot;Not an ECMAScript file. Try open it with 'File' -&gt; 'Open...'&quot;);
-    
-	}else
-    {
-            jsLog(JS_LOG_ERROR,&quot;%s: line %d:\nMsg: %s\n&quot;,report-&gt;filename,report-&gt;lineno,message);
-	}
-       
-    if(quiet)
-            GUI_Quiet();
-
-}// end printJSError
-
-bool SpidermonkeyInit()
-{// begin SpidermonkeyInit
-	// setup JS
-	g_pCx = NULL;
-	g_pObject = NULL;
-	g_pRt = NULL;
-	JSRuntime *rt = JS_NewRuntime(1000000L);
-	g_pRt = rt;
-	if ( rt == NULL )
-	{
-		// Do some error reporting
-		printf(&quot;Spidermonkey failed to initialize runtime!\n&quot;);
-	}
-	else
-	{// begin runtime created
-		JSContext *cx = JS_NewContext(rt, 8192);
-		g_pCx = cx;
-		if ( cx == NULL )
-		{
-			// Do some error reporting
-			printf(&quot;Spidermonkey failed to initialize context!\n&quot;);
-		}
-		else
-		{// begin context created
-
-			JSObject *global = JS_NewObject(cx, &amp;g_globalClass, 0, 0);
-			g_pObject = global;
-			JS_InitStandardClasses(cx, global);
-			// load our custom JS class objects
-			JSObject *obj = ADM_JSAvidemux::JSInit(cx, global);
-			JSObject *dsObj = ADM_JSDirectorySearch::JSInit(cx, global);
-			// register error handler
-			JS_SetErrorReporter(cx, printJSError);
-            JS_AvidemuxFunction(cx,global);
-            JS_AvidemuxRegisterDebugFunction(cx,global);
-			return true;
-		}// end context created
-	}// end runtime created
-	return false;
-}// end SpidermonkeyInit
-
-void SpidermonkeyDestroy()
-{// begin SpidermonkeyDestroy
-#ifdef ADM_JS_THREADSAFE
-	JS_SetContextThread(g_pCx);	
-#endif
-	JS_DestroyContext(g_pCx);
-	JS_DestroyRuntime(g_pRt);
-}// end SpidermonkeyDestroy
-
-void *StartThreadSpidermonkey(void *pData)
-{// begin StartThreadSpidermonkey
-        pthread_mutex_lock(&amp;g_pSpiderMonkeyMutex);
-        /*
-        The following mailling list post describes how to CORRECTLY use
-        the threading API support with Spidermonkey
-        &quot;Thread from SpiderMonkey newsgroup&quot;
-        <A HREF="http://archive.gingerall.cz/archives/public/sablot2004/msg00117.html">http://archive.gingerall.cz/archives/public/sablot2004/msg00117.html</A>
-        */
-        // Notify the Spidermonkey that we'll be processing in a thread
-#ifdef ADM_JS_THREADSAFE
-        JS_SetContextThread(g_pCx);
-        JS_BeginRequest(g_pCx);
-#endif
-        bool ret = false;
-        const char *pScriptFile = static_cast&lt;const char *&gt;(pData);
-        ret = parseECMAScript(pScriptFile);
-        if(ret == false)
-        {
-                if( actual_workbench_file )
-                        ADM_dealloc(actual_workbench_file);
-                actual_workbench_file = ADM_strdup(pScriptFile);
-        }
-        // Notify Spidermonkey that our thread processing has finished
-#ifdef ADM_JS_THREADSAFE
-        JS_EndRequest(g_pCx);
-        JS_ClearContextThread(g_pCx);
-#endif
-        pthread_mutex_unlock(&amp;g_pSpiderMonkeyMutex);
-
-        return NULL;
-}// end StartThreadSpidermonkey
-
-void JS_setSuccess(bool bSuccess)
-{// begin JS_setSuccess
-	g_bJSSuccess = bSuccess;
-	printf(&quot;[ECMA] success : %d\n&quot;, g_bJSSuccess);
-}// end JS_setSuccess
-
-

Deleted: branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script/ADM_JSGlobal.h
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script/ADM_JSGlobal.h	2010-02-18 06:18:53 UTC (rev 5938)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script/ADM_JSGlobal.h	2010-02-20 07:52:21 UTC (rev 5939)
@@ -1,59 +0,0 @@
-#ifndef _ADM_JSGLOBAL_H
-#define _ADM_JSGLOBAL_H
-
-// Spidermonkey
-
-#include &quot;ADM_smjs/jsapi.h&quot;
-#include &lt;pthread.h&gt;
-#include &quot;ADM_JSif.h&quot;
-bool jsLog(JS_LOG_TYPE type, const char *fmt,...);
-
-// javscript debugging helper
-void printJSError(JSContext *cx, const char *message, JSErrorReport *report);
-bool SpidermonkeyInit();
-void SpidermonkeyDestroy();
-void JS_setSuccess(bool bSuccess);
-void *StartThreadSpidermonkey(void *pData);
-
-
-typedef JSBool JS_PROTOTYPE(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval);
-
-#ifdef JSDECLARE
-#define JSVAR(a,b,c) a b=c
-#else
-#define JSVAR(a,b,c) extern a b
-#endif
-#if defined( __MINGW32__) &amp;&amp; defined(JSDECLARE)
- pthread_t g_pThreadSpidermonkey ;
-#else
-JSVAR( pthread_t, g_pThreadSpidermonkey , 0);
-#endif
-JSVAR( pthread_mutex_t, g_pSpiderMonkeyMutex , PTHREAD_MUTEX_INITIALIZER);
-// expose our main javascript context to the entire program
-JSVAR( bool, g_bJSSuccess , 0);
-JSVAR( JSObject, *g_pObject,NULL);
-JSVAR( JSContext, *g_pCx,NULL);
-JSVAR( JSRuntime, *g_pRt,NULL);
-
-
-JSVAR( JSClass, g_globalClass,)
-#ifdef JSDECLARE
-{ 
-        &quot;Global&quot;, 0, 
-        JS_PropertyStub,  JS_PropertyStub, 
-        JS_PropertyStub, JS_PropertyStub, 
-        JS_EnumerateStub, JS_ResolveStub, 
-        JS_ConvertStub,  JS_FinalizeStub }
-#endif
-        ;
-#if !defined(ADM_JS_THREADSAFE)
-#define enterLock() {}
-#define leaveLock() {}
-#else
-#define enterLock() jsrefcount nRefCount = JS_SuspendRequest(cx)
-#define leaveLock() {JS_ResumeRequest(cx,nRefCount); }
-
-#endif
-#endif
-//EOF
-

Deleted: branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script/ADM_JSif.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script/ADM_JSif.cpp	2010-02-18 06:18:53 UTC (rev 5938)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script/ADM_JSif.cpp	2010-02-20 07:52:21 UTC (rev 5939)
@@ -1,120 +0,0 @@
-/**
-    \file ADM_JSif.cpp
-    \brief interface to js
-*/
-
-/***************************************************************************
- *                                                                         *
- *   This program is free software; you can redistribute it and/or modify  *
- *   it under the terms of the GNU General Public License as published by  *
- *   the Free Software Foundation; either version 2 of the License, or     *
- *   (at your option) any later version.                                   *
- *                                                                         *
- ***************************************************************************/
-#include &quot;ADM_default.h&quot;
-#include &lt;string.h&gt;
-#include &lt;pthread.h&gt;
-#include &quot;DIA_coreToolkit.h&quot;
-#include &quot;ADM_JSGlobal.h&quot;
-#include &quot;ADM_JSAvidemux.h&quot;
-#include &quot;ADM_jsShell.h&quot;
-#include &quot;ADM_JSif.h&quot;
-#include &lt;stdarg.h&gt;
-
-void    A_Resync(void);
-static jsLoggerFunc *jsLogger=NULL;
-static void *jsLoggerCookie=NULL;
-
-/**
-    \fn parseECMAScript
-    \brief Compile &amp; execute ecma script
-*/
-bool parseECMAScript(const char *name)
-{// begin parseECMAScript
-	jsval rval;
-	uintN lineno = 0;
-	g_bJSSuccess = 0;
-	printf(&quot;Spidermonkey compiling \&quot;%s\&quot;...&quot;,name);
-	JSScript *pJSScript = JS_CompileFile(g_pCx, g_pObject, name);
-	printf(&quot;Done.\n&quot;);
-	if(pJSScript != NULL)
-	{// begin execute external file
-		printf(&quot;Spidermonkey executing \&quot;%s\&quot;...&quot;,name);
-		JSBool ok = JS_ExecuteScript(g_pCx, g_pObject, pJSScript, &amp;rval);
-		JS_DestroyScript(g_pCx,pJSScript);
-		printf(&quot;Done.\n&quot;);
-	}// end execute external file
-        // Run garbage collector now, it is safe
-    JS_GC(g_pCx);
-	A_Resync();
-	return g_bJSSuccess;
-}// end parseECMAScript
-/**
-    \fn jsLogger
-*/
-bool isJsLogRedirected(void)
-{
-    if(jsLogger) return true;
-    return false;
-}
-/**
-    \fn jsEvaluate
-*/
-static bool jsEvaluate(const char *str)
-{
-jsval rval;
-   JS_EvaluateScript(g_pCx,g_pObject,str,strlen(str),&quot;dummy&quot;,1,&amp;rval);
-   return true; 
-}
-/**
-    \fn    interactiveECMAScript
-    \brief interprete &amp; execute ecma script (interactive)
-*/
-bool interactiveECMAScript(const char *name)
-{
-    ADM_startShell(jsEvaluate);
-    JS_GC(g_pCx);
-	A_Resync();
-    ADM_info(&quot;Ending JS shell...\n&quot;);
-	return true;
-}
-/**
-    \fn jsLog
-*/
-bool jsLog(JS_LOG_TYPE type, const char *prf,...)
-{
- static char print_buffer[1024];
-  	
-		va_list 	list;
-		va_start(list,	prf);
-		vsnprintf(print_buffer,1023,prf,list);
-		va_end(list);
-		print_buffer[1023]=0; // ensure the string is terminated
-        if(true==isJsLogRedirected())
-            jsLogger(jsLoggerCookie,type,print_buffer);
-        else
-        {
-            if(type==JS_LOG_ERROR)
-                GUI_Error_HIG(&quot;Spidermonkey ECMAScript Error&quot;,&quot;%s&quot;,print_buffer);
-            else
-                ADM_warning(&quot;[JS]%s\n&quot;,print_buffer);
-        }
-        return true;
-}
-/**
-    \fn ADM_jsRegisterLogger
-*/
-bool ADM_jsRegisterLogger(void *cookie,jsLoggerFunc *fun)
-{
-    jsLoggerCookie=cookie;
-    jsLogger=fun;
-    return true;
-}
-/**
-    \fn ADM_jsUnregisterLogger
-*/
-bool ADM_jsUnregisterLogger(void)
-{
-    jsLogger=NULL;
-    return true;
-}

Deleted: branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script/ADM_JSif.h
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script/ADM_JSif.h	2010-02-18 06:18:53 UTC (rev 5938)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script/ADM_JSif.h	2010-02-20 07:52:21 UTC (rev 5939)
@@ -1,51 +0,0 @@
-/**
-    \file ADM_JSif.cpp
-    \brief interface to js
-*/
-
-/***************************************************************************
- *                                                                         *
- *   This program is free software; you can redistribute it and/or modify  *
- *   it under the terms of the GNU General Public License as published by  *
- *   the Free Software Foundation; either version 2 of the License, or     *
- *   (at your option) any later version.                                   *
- *                                                                         *
- ***************************************************************************/
-#ifndef ADM_JS_IF_H
-#define ADM_JS_IF_H
-
-/**
-    \enum JS_LOG_TYPE
-*/
-typedef enum
-{
-    JS_LOG_NORMAL,
-    JS_LOG_ERROR
-}JS_LOG_TYPE;
-/**
-    \typedef jsLoggerFunc
-*/
-typedef bool (jsLoggerFunc)(void *cookie,JS_LOG_TYPE type,const char *);
-/*
-
-*/
-bool ADM_jsRegisterLogger(void *cookie,jsLoggerFunc *fun);
-bool ADM_jsUnregisterLogger(void);
-
-/**
-    \fn parseECMAScript
-    \brief Compile &amp; execute ecma script
-*/
-bool parseECMAScript(const char *name);
-
-/**
-    \fn    interactiveECMAScript
-    \brief interprete &amp; execute ecma script (interactive)
-*/
-bool interactiveECMAScript(const char *name);
-/**
-    \fn jsLog
-
-*/
-bool jsLog(JS_LOG_TYPE type, const char *fmt,...);
-#endif

Deleted: branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script/ADM_container.h
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script/ADM_container.h	2010-02-18 06:18:53 UTC (rev 5938)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script/ADM_container.h	2010-02-20 07:52:21 UTC (rev 5939)
@@ -1,35 +0,0 @@
-//____________________________________________________________________
-//
-//
-// Author: mean &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/avidemux-svn-commit">fixounet at free.fr</A>&gt;, (C) 2003-2005
-//
-// Copyright: See COPYING file that comes with this distribution
-//
-//
-//____________________________________________________________________
-#ifndef ADM_CTNER_
-#define ADM_CTNER_
-typedef struct ADM_CONTAINER
-{
-    ADM_OUT_FORMAT type;
-    const char     *name;
-}ADM_CONTAINER;
-#define MK_CONT(x) {ADM_##x,#x}
-
-const ADM_CONTAINER container[]=
-{
-  MK_CONT(AVI),
-  MK_CONT(OGM),
-  MK_CONT(ES),
-  MK_CONT(PS),
-  MK_CONT(TS),
-  MK_CONT(AVI_DUAL),
-  MK_CONT(AVI_UNP),
-  MK_CONT(MP4),
-  MK_CONT(PSP),
-  MK_CONT(FLV),
-  MK_CONT(DUMMY),
-  MK_CONT(MATROSKA)  
-};
-#define NB_CONT (sizeof(container)/sizeof(ADM_CONTAINER))
-#endif

Deleted: branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script/ADM_jsShell.h
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script/ADM_jsShell.h	2010-02-18 06:18:53 UTC (rev 5938)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script/ADM_jsShell.h	2010-02-20 07:52:21 UTC (rev 5939)
@@ -1,23 +0,0 @@
-/**
-    \file ADM_jsShell.h
-    \brief Base class for js interactive shell
-    \author mean, <A HREF="https://lists.berlios.de/mailman/listinfo/avidemux-svn-commit">fixounet at free.fr</A>
-*/
-
-/***************************************************************************
- *                                                                         *
- *   This program is free software; you can redistribute it and/or modify  *
- *   it under the terms of the GNU General Public License as published by  *
- *   the Free Software Foundation; either version 2 of the License, or     *
- *   (at your option) any later version.                                   *
- *                                                                         *
- ***************************************************************************/
-
-#ifndef ADM_JS_SHELL_H
-#define ADM_JS_SHELL_H
-#include &quot;ADM_JSif.h&quot;
-typedef bool (jsShellEvaluate)(const char *str);
-bool ADM_startShell(jsShellEvaluate *eval);
-
-
-#endif // ADM_JS_SHELL_H
\ No newline at end of file

Deleted: branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script/ADM_jsUtils.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script/ADM_jsUtils.cpp	2010-02-18 06:18:53 UTC (rev 5938)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script/ADM_jsUtils.cpp	2010-02-20 07:52:21 UTC (rev 5939)
@@ -1,99 +0,0 @@
-/**
-    \file ADM_jsUtils
-    \brief Simple param -&gt; type utilities
-    \author mean <A HREF="https://lists.berlios.de/mailman/listinfo/avidemux-svn-commit">fixounet at free.fr</A> 2009
-*/
-/***************************************************************************
- *                                                                         *
- *   This program is free software; you can redistribute it and/or modify  *
- *   it under the terms of the GNU General Public License as published by  *
- *   the Free Software Foundation; either version 2 of the License, or     *
- *   (at your option) any later version.                                   *
- *                                                                         *
- ***************************************************************************/
-#include &quot;ADM_default.h&quot;
-#include &lt;string.h&gt;
-#include &lt;pthread.h&gt;
-#include &quot;DIA_coreToolkit.h&quot;
-
-#include &quot;ADM_JSGlobal.h&quot;
-#include &quot;ADM_JSDebug.h&quot;
-#include &quot;ADM_JSif.h&quot;
-#include &quot;ADM_jsUtils.h&quot;
-/**
-    \fn ADM_jsArg2Vars  
-    \brief convert jsvals to native type with checking
-*/
-bool ADM_jsArg2Vars(JSContext *cx, JSObject *obj, int argc, jsval *argv, int paramNumber, ADM_PARAM_LIST *param)
-{
-    if(paramNumber!=argc)
-    {
-        ADM_warning(&quot;Wrong number of parameters : %d vs %d\n&quot;,argc,paramNumber);
-        return false;
-    }
-    for(int i=0;i&lt;argc;i++)
-    {
-        jsval j=argv[i];
-        ADM_PARAM_LIST *p=param+i;
-        switch(p-&gt;type)
-        {
-            case ADM_JS_UINT64_T:
-            case ADM_JS_UINT32_T:
-            case ADM_JS_INT64_T:
-            case ADM_JS_INT32_T:
-                {
-                        if(!JSVAL_IS_NUMBER(j))
-                        {
-                            ADM_warning(&quot;Expected number and got %d\n&quot;,j);
-                            return false;
-                        }
-                        // If it is an int...
-                        double v=0;
-                        if(JSVAL_IS_INT(j)) 
-                        {
-                            v=(int64_t)JSVAL_TO_INT(j);
-                            //ADM_warning(&quot;Value is int :%&quot;LLD&quot;\n&quot;,JSVAL_TO_INT(j));
-                        }
-                        if(JSVAL_IS_DOUBLE(j)) 
-                        {
-                            v=(int64_t)*(JSVAL_TO_DOUBLE(j));
-                            //ADM_warning(&quot;Value is float :%f\n&quot;,(float)*(JSVAL_TO_DOUBLE(j)));
-                        }
-                        // 
-                        //ADM_warning(&quot;%f\n&quot;,(float)v);
-                        // Affect
-                        switch(p-&gt;type)
-                        {
-                            case ADM_JS_UINT64_T: *(uint64_t *)p-&gt;value=(uint64_t)v;break;
-                            case ADM_JS_UINT32_T: *(uint32_t *)p-&gt;value=(uint32_t)v;break;
-                            case ADM_JS_INT64_T:  *(int64_t *)p-&gt;value=(int64_t)v;break;
-                            case ADM_JS_INT32_T:  *(int32_t *)p-&gt;value=(int32_t)v;break;
-                            default: ADM_assert(0);break;
-                        }
-                 }
-                        break;
-            case  ADM_JS_STRING:
-                        if(!JSVAL_IS_STRING(j))
-                        {
-                            ADM_warning(&quot;Expected string and got %d\n&quot;,j);
-                            return false;
-                        }
-                        p-&gt;value=(void *)(JSVAL_TO_STRING(j));
-                        break;
-            case  ADM_JS_BOOL:
-                        if(!JSVAL_IS_BOOLEAN(j))
-                        {
-                            ADM_warning(&quot;Expected boolean and got %d\n&quot;,j);
-                            return false;
-                        }
-                        *(bool *)p-&gt;value=JSVAL_TO_BOOLEAN(j);
-                        break;
-            default:
-                    ADM_assert(0);
-                    break;
-        }
-
-    }
-    return true;
-}
-// EOF

Deleted: branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script/ADM_jsUtils.h
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script/ADM_jsUtils.h	2010-02-18 06:18:53 UTC (rev 5938)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script/ADM_jsUtils.h	2010-02-20 07:52:21 UTC (rev 5939)
@@ -1,39 +0,0 @@
-/**
-    \file ADM_jsUtils
-    \brief Simple param -&gt; type utilities
-    \author mean <A HREF="https://lists.berlios.de/mailman/listinfo/avidemux-svn-commit">fixounet at free.fr</A> 2009
-*/
-/***************************************************************************
- *                                                                         *
- *   This program is free software; you can redistribute it and/or modify  *
- *   it under the terms of the GNU General Public License as published by  *
- *   the Free Software Foundation; either version 2 of the License, or     *
- *   (at your option) any later version.                                   *
- *                                                                         *
- ***************************************************************************/
-#ifndef ADM_JS_UTILS_H
-#define ADM_JS_UTILS_H
-
-typedef enum
-{
-    ADM_JS_INVALID=0,
-    ADM_JS_UINT32_T=1,
-    ADM_JS_INT32_T,
-    ADM_JS_UINT64_T,
-    ADM_JS_INT64_T,
-    ADM_JS_STRING,
-    ADM_JS_BOOL,
-    ADM_JS_MAX
-}ADM_PARAM_TYPE;
-
-typedef struct
-{
-    ADM_PARAM_TYPE type;
-    void           *value;
-
-}ADM_PARAM_LIST;
-
-bool ADM_jsArg2Vars(JSContext *cx, JSObject *obj, int argc, jsval *argv, int paramNumber, ADM_PARAM_LIST *param);
-
-
-#endif

Deleted: branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script/CMakeLists.txt
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script/CMakeLists.txt	2010-02-18 06:18:53 UTC (rev 5938)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script/CMakeLists.txt	2010-02-20 07:52:21 UTC (rev 5939)
@@ -1,10 +0,0 @@
-SET(ADM_script_SRCS
-	ADM_AvidemuxAudio.cpp  ADM_AvidemuxVideo.cpp    ADM_JSAvidemux.cpp       ADM_JSDirectorySearch.cpp  ADM_JSGlobal.cpp
-	ADM_Avidemux.cpp       ADM_JSAvidemuxAudio.cpp  ADM_JSAvidemuxVideo.cpp  ADM_JSFunctions.cpp        DirectorySearch.cpp
-        ADM_JSFunctionsNonRegFactory.cpp
-        ADM_JSif.cpp ADM_JSDebug.cpp
-        ADM_jsUtils.cpp
-)
-
-ADD_LIBRARY(ADM_script6 STATIC ${ADM_script_SRCS})
-ADD_TARGET_CFLAGS(ADM_script6 &quot;-DJS_THREADSAFE -DXP_UNIX&quot;)

Deleted: branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script/DirectorySearch.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script/DirectorySearch.cpp	2010-02-18 06:18:53 UTC (rev 5938)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script/DirectorySearch.cpp	2010-02-20 07:52:21 UTC (rev 5939)
@@ -1,224 +0,0 @@
-// DirectorySearch.cpp: implementation of the CDirectorySearch class.
-//
-//////////////////////////////////////////////////////////////////////
-/*
-Copyright 2001-2005 Anish Mistry. All rights reserved.
-
-Note:  This file is available under a BSD license.  Contact the author
-at <A HREF="https://lists.berlios.de/mailman/listinfo/avidemux-svn-commit">amistry at am-productions.biz</A>
-*/
-#include &lt;string.h&gt;
-#include &quot;ADM_default.h&quot;
-#include &quot;DirectorySearch.h&quot;
-
-//////////////////////////////////////////////////////////////////////
-// Construction/Destruction
-//////////////////////////////////////////////////////////////////////
-
-#if defined(__unix__) || defined(__APPLE__)
-int CDirectorySearch::_findnext(unsigned long int hDir,_finddata_t *pfdData)
-{// begin _findnext
-	if(!hDir || hDir == 0xFFFFFFFF)
-		return -1; // need to call opendir first
-	struct stat stInfo;
-	struct dirent *pEntry;
-	pEntry = readdir((DIR *)hDir);
-	if(!pEntry)
-		return -1;
-	std::string sFilePath = &quot;&quot;;
-#if defined( __linux__) || defined(__macosx__) || defined(__MINGW32__)
-	strncpy(pfdData-&gt;name,pEntry-&gt;d_name,pEntry-&gt;d_reclen);
-	// append NULL terminator
-	pfdData-&gt;name[pEntry-&gt;d_reclen] = '\0';
-#elif defined(__FreeBSD__) || defined(__OpenBSD__)
-	strncpy(pfdData-&gt;name,pEntry-&gt;d_name,pEntry-&gt;d_namlen);
-	// append NULL terminator
-	pfdData-&gt;name[pEntry-&gt;d_namlen] = '\0';
-#endif
-	sFilePath += m_sDirectory;
-	sFilePath += DIRECTORY_DELIMITOR;
-	sFilePath += pfdData-&gt;name;
-	stat(sFilePath.c_str(),&amp;stInfo);
-	pfdData-&gt;time_access = stInfo.st_atime;
-	pfdData-&gt;time_create = stInfo.st_ctime;
-	pfdData-&gt;time_write = stInfo.st_mtime;
-	pfdData-&gt;size = stInfo.st_size;
-	// assign the modes
-	pfdData-&gt;attrib = 0;
-	if(S_ISREG(stInfo.st_mode))
-		pfdData-&gt;attrib = _A_NORMAL;
-	if(S_ISDIR(stInfo.st_mode))
-		pfdData-&gt;attrib |= _A_SUBDIR;
-	if(S_ISCHR(stInfo.st_mode) ||
-	S_ISBLK(stInfo.st_mode) ||
-#if !defined(__WIN32)	
-	S_ISLNK(stInfo.st_mode) ||
-	S_ISSOCK(stInfo.st_mode) ||
-#endif
-	S_ISFIFO(stInfo.st_mode))
-		pfdData-&gt;attrib = _A_NONFILE;
-	return 0;
-}// end _findnext
-
-int CDirectorySearch::_findfirst(const char *path,_finddata_t *pfdData)
-{// begin _findfirst
-	unsigned long int hDir = (unsigned long int)opendir(path);
-	if(!hDir)
-		return -1;
-	if(_findnext(hDir,pfdData) == -1)
-		return -1;
-	return hDir;
-}// end _findfirst
-
-int CDirectorySearch::_findclose(unsigned long int hDir)
-{// begin _findclose
-	if(hDir == 0xFFFFFFFF)
-		return -1;
-	return closedir((DIR *)hDir);
-}// end _findclose
-#endif
-
-CDirectorySearch::CDirectorySearch()
-{
-	m_hSearch = 0;
-	m_sDirectory.clear();
-}
-
-CDirectorySearch::~CDirectorySearch()
-{
-	Close();
-}
-
-bool CDirectorySearch::Init(std::string sDirectory)
-{// begin Init
-char *s;
-	// check for no search query
-	if(sDirectory[sDirectory.length()-1] == DIRECTORY_DELIMITOR)
-	{
-		printf(&quot;End with directory delimitor\n&quot;);
-		return false;
-	}
-	const char *old=sDirectory.c_str();
-	s=new char[strlen(old)+10];
-	strcpy(s,old);
-#ifdef __WIN32	
-	strcat(s,&quot;\\*&quot;);
-#endif
-	
-	printf(&quot;&gt;%s&lt;\n&quot;,s);
-	m_hSearch = _findfirst(s,&amp;m_fdData);
-	delete [] s;	
-	if(m_hSearch == -1)
-	{
-		printf(&quot;Find first failed\n&quot;);
-		return false;
-	}
-	m_sDirectory = sDirectory;
-	return true;
-}// end Init
-
-bool CDirectorySearch::Close()
-{// begin Close
-	bool bRtn = false;
-	// clean up directory string
-	m_sDirectory.clear();
-	if(m_hSearch != 0)
-	{
-		bRtn = (bool)_findclose(m_hSearch);
-		m_hSearch = 0;
-	}
-	return bRtn;
-}// end Close
-
-std::string CDirectorySearch::GetFilePath()
-{// begin GetFilePath
-	std::string sBuffer = &quot;&quot;;
-	sBuffer = m_sDirectory;
-	if(sBuffer[sBuffer.length()-1] != DIRECTORY_DELIMITOR &amp;&amp; m_fdData.name[0] != DIRECTORY_DELIMITOR)
-		sBuffer += DIRECTORY_DELIMITOR;
-	sBuffer += m_fdData.name;
-	return sBuffer;
-}// end GetFilePath
-
-std::string CDirectorySearch::GetFileDirectory(std::string sFilePath) const
-{// begin GetFileDirectory
-	std::string sCurrentDirectory = &quot;&quot;;
-	for(int i = sFilePath.length()-1;i &gt;= 0;i--)
-		if(sFilePath[i] == DIRECTORY_DELIMITOR)
-		{// begin copy directory name into buffer
-#ifdef __WIN32
-			if(sFilePath[0] == DIRECTORY_DELIMITOR)
-			{
-				sFilePath.erase(0,1);
-				i--;
-			}
-#endif
-			sCurrentDirectory = sFilePath.substr(0,i+1);
-			break;
-		}// end copy directory name into buffer
-	return sCurrentDirectory;
-}// end GetFileDirectory
-
-std::string CDirectorySearch::GetFileDirectory()
-{// begin GetFileDirectory
-	return m_sDirectory;
-}// end GetFileDirectory
-
-bool CDirectorySearch::IsSingleDot()
-{// begin IsSingleDot
-	if(IsDirectory())
-		if(strcmp(&quot;.&quot;,m_fdData.name) == 0)
-			return true;
-	return false;
-}// end IsSingleDot
-
-bool CDirectorySearch::IsDoubleDot()
-{// begin IsDoubleDot
-	if(IsDirectory())
-		if(strcmp(&quot;..&quot;,m_fdData.name) == 0)
-			return true;
-	return false;
-}// end IsDoubleDot
-
-bool CDirectorySearch::IsExtension(const char *pExtension)
-{// begin IsExtension
-	int nExtLen = strlen(pExtension);
-	char *pTempBuffer = new char[nExtLen+1];
-	const char *pFileExt = GetExtension();
-	strcpy(pTempBuffer,pExtension);
-	for(int i = 0,nCurrExtLen = 0;i &lt; nExtLen;i++,nCurrExtLen++)
-	{
-		if(pTempBuffer[i+1] == '\0')
-		{
-			nCurrExtLen++;
-			i++;
-			pTempBuffer[i] = ';';
-		}
-		if(pTempBuffer[i] == ';' &amp;&amp; nCurrExtLen)
-		{
-			pTempBuffer[i] = '\0';
-			if(pTempBuffer[i-nCurrExtLen] == '*' || pTempBuffer[i-nCurrExtLen] == '?' 
-				|| (pFileExt &amp;&amp; strcmp(&amp;pTempBuffer[i-nCurrExtLen],pFileExt) == 0))
-			{
-				// free the buffer
-				delete []pTempBuffer;
-				return true;
-			}
-			nCurrExtLen = -1;
-		}
-	}
-	// free the buffer
-	delete []pTempBuffer;
-	return false;
-}// end IsExtension
-
-const char * CDirectorySearch::GetExtension()
-{// begin GetExtension
-	for(int i = strlen(m_fdData.name)-1;i &gt;= 0;i--)
-	{// begin search
-		if(m_fdData.name[i] == '.')
-			return &amp;m_fdData.name[i+1];
-	}// end search
-	return NULL;
-}// end GetExtension
-

Deleted: branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script/DirectorySearch.cpp.orig
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script/DirectorySearch.cpp.orig	2010-02-18 06:18:53 UTC (rev 5938)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script/DirectorySearch.cpp.orig	2010-02-20 07:52:21 UTC (rev 5939)
@@ -1,228 +0,0 @@
-// DirectorySearch.cpp: implementation of the CDirectorySearch class.
-//
-//////////////////////////////////////////////////////////////////////
-/*
-Copyright 2001-2005 Anish Mistry. All rights reserved.
-
-Note:  This file is available under a BSD license.  Contact the author
-at <A HREF="https://lists.berlios.de/mailman/listinfo/avidemux-svn-commit">amistry at am-productions.biz</A>
-*/
-#include &lt;string.h&gt;
-#include &quot;config.h&quot;
-#include &quot;DirectorySearch.h&quot;
-
-//////////////////////////////////////////////////////////////////////
-// Construction/Destruction
-//////////////////////////////////////////////////////////////////////
-
-#if defined(__unix__) || defined(__APPLE__)
-int CDirectorySearch::_findnext(unsigned long int hDir,_finddata_t *pfdData)
-{// begin _findnext
-	if(!hDir || hDir == 0xFFFFFFFF)
-		return -1; // need to call opendir first
-	struct stat stInfo;
-	struct dirent *pEntry;
-	pEntry = readdir((DIR *)hDir);
-	if(!pEntry)
-		return -1;
-	std::string sFilePath = &quot;&quot;;
-#if defined( __linux__) || defined(__macosx__) || defined(__MINGW32__)
-	strncpy(pfdData-&gt;name,pEntry-&gt;d_name,pEntry-&gt;d_reclen);
-	// append NULL terminator
-	pfdData-&gt;name[pEntry-&gt;d_reclen] = '\0';
-#elif defined(__FreeBSD__) || defined(__OpenBSD__)
-	strncpy(pfdData-&gt;name,pEntry-&gt;d_name,pEntry-&gt;d_namlen);
-	// append NULL terminator
-	pfdData-&gt;name[pEntry-&gt;d_namlen] = '\0';
-#endif
-	sFilePath += m_sDirectory;
-	sFilePath += DIRECTORY_DELIMITOR;
-	sFilePath += pfdData-&gt;name;
-	stat(sFilePath.c_str(),&amp;stInfo);
-	pfdData-&gt;time_access = stInfo.st_atime;
-	pfdData-&gt;time_create = stInfo.st_ctime;
-	pfdData-&gt;time_write = stInfo.st_mtime;
-	pfdData-&gt;size = stInfo.st_size;
-	// assign the modes
-	pfdData-&gt;attrib = 0;
-	if(S_ISREG(stInfo.st_mode))
-		pfdData-&gt;attrib = _A_NORMAL;
-	if(S_ISDIR(stInfo.st_mode))
-		pfdData-&gt;attrib |= _A_SUBDIR;
-	if(S_ISCHR(stInfo.st_mode) ||
-	S_ISBLK(stInfo.st_mode) ||
-#if !defined(__WIN32)	
-	S_ISLNK(stInfo.st_mode) ||
-	S_ISSOCK(stInfo.st_mode) ||
-#endif
-	S_ISFIFO(stInfo.st_mode))
-		pfdData-&gt;attrib = _A_NONFILE;
-	return 0;
-}// end _findnext
-
-int CDirectorySearch::_findfirst(const char *path,_finddata_t *pfdData)
-{// begin _findfirst
-	unsigned long int hDir = (unsigned long int)opendir(path);
-	if(!hDir)
-		return -1;
-	if(_findnext(hDir,pfdData) == -1)
-		return -1;
-	return hDir;
-}// end _findfirst
-
-int CDirectorySearch::_findclose(unsigned long int hDir)
-{// begin _findclose
-	if(hDir == 0xFFFFFFFF)
-		return -1;
-	return closedir((DIR *)hDir);
-}// end _findclose
-#endif
-
-CDirectorySearch::CDirectorySearch()
-{
-	m_hSearch = 0;
-	m_sDirectory.clear();
-}
-
-CDirectorySearch::~CDirectorySearch()
-{
-	Close();
-}
-
-bool CDirectorySearch::Init(std::string sDirectory)
-{// begin Init
-char *s;
-	// check for no search query
-	if(sDirectory[sDirectory.length()-1] == DIRECTORY_DELIMITOR)
-	{
-		printf(&quot;End with directory delimitor\n&quot;);
-		return false;
-	}
-	const char *old=sDirectory.c_str();
-	s=new char[strlen(old)+10];
-	strcpy(s,old);
-#ifdef __WIN32	
-	strcat(s,&quot;\\*&quot;);
-#endif
-	
-	printf(&quot;&gt;%s&lt;\n&quot;,s);
-	m_hSearch = _findfirst(s,&amp;m_fdData);
-	delete [] s;	
-	if(m_hSearch == -1)
-	{
-		printf(&quot;Find first failed\n&quot;);
-		return false;
-	}
-#ifdef __WIN32   //ndef __unix__
-	m_sDirectory = GetFileDirectory(sDirectory);
-#else
-	m_sDirectory = sDirectory;
-#endif
-	return true;
-}// end Init
-
-bool CDirectorySearch::Close()
-{// begin Close
-	bool bRtn = false;
-	// clean up directory string
-	m_sDirectory.clear();
-	if(m_hSearch != 0)
-	{
-		bRtn = (bool)_findclose(m_hSearch);
-		m_hSearch = 0;
-	}
-	return bRtn;
-}// end Close
-
-std::string CDirectorySearch::GetFilePath()
-{// begin GetFilePath
-	std::string sBuffer = &quot;&quot;;
-	sBuffer = m_sDirectory;
-	if(sBuffer[sBuffer.length()-1] != DIRECTORY_DELIMITOR &amp;&amp; m_fdData.name[0] != DIRECTORY_DELIMITOR)
-		sBuffer += DIRECTORY_DELIMITOR;
-	sBuffer += m_fdData.name;
-	return sBuffer;
-}// end GetFilePath
-
-std::string CDirectorySearch::GetFileDirectory(std::string sFilePath) const
-{// begin GetFileDirectory
-	std::string sCurrentDirectory = &quot;&quot;;
-	for(int i = sFilePath.length()-1;i &gt;= 0;i--)
-		if(sFilePath[i] == DIRECTORY_DELIMITOR)
-		{// begin copy directory name into buffer
-#ifdef __WIN32
-			if(sFilePath[0] == DIRECTORY_DELIMITOR)
-			{
-				sFilePath.erase(0,1);
-				i--;
-			}
-#endif
-			sCurrentDirectory = sFilePath.substr(0,i+1);
-			break;
-		}// end copy directory name into buffer
-	return sCurrentDirectory;
-}// end GetFileDirectory
-
-std::string CDirectorySearch::GetFileDirectory()
-{// begin GetFileDirectory
-	return m_sDirectory;
-}// end GetFileDirectory
-
-bool CDirectorySearch::IsSingleDot()
-{// begin IsSingleDot
-	if(IsDirectory())
-		if(strcmp(&quot;.&quot;,m_fdData.name) == 0)
-			return true;
-	return false;
-}// end IsSingleDot
-
-bool CDirectorySearch::IsDoubleDot()
-{// begin IsDoubleDot
-	if(IsDirectory())
-		if(strcmp(&quot;..&quot;,m_fdData.name) == 0)
-			return true;
-	return false;
-}// end IsDoubleDot
-
-bool CDirectorySearch::IsExtension(const char *pExtension)
-{// begin IsExtension
-	int nExtLen = strlen(pExtension);
-	char *pTempBuffer = new char[nExtLen+1];
-	const char *pFileExt = GetExtension();
-	strcpy(pTempBuffer,pExtension);
-	for(int i = 0,nCurrExtLen = 0;i &lt; nExtLen;i++,nCurrExtLen++)
-	{
-		if(pTempBuffer[i+1] == '\0')
-		{
-			nCurrExtLen++;
-			i++;
-			pTempBuffer[i] = ';';
-		}
-		if(pTempBuffer[i] == ';' &amp;&amp; nCurrExtLen)
-		{
-			pTempBuffer[i] = '\0';
-			if(pTempBuffer[i-nCurrExtLen] == '*' || pTempBuffer[i-nCurrExtLen] == '?' 
-				|| (pFileExt &amp;&amp; strcmp(&amp;pTempBuffer[i-nCurrExtLen],pFileExt) == 0))
-			{
-				// free the buffer
-				delete []pTempBuffer;
-				return true;
-			}
-			nCurrExtLen = -1;
-		}
-	}
-	// free the buffer
-	delete []pTempBuffer;
-	return false;
-}// end IsExtension
-
-const char * CDirectorySearch::GetExtension()
-{// begin GetExtension
-	for(int i = strlen(m_fdData.name)-1;i &gt;= 0;i--)
-	{// begin search
-		if(m_fdData.name[i] == '.')
-			return &amp;m_fdData.name[i+1];
-	}// end search
-	return NULL;
-}// end GetExtension
-

Deleted: branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script/DirectorySearch.h
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script/DirectorySearch.h	2010-02-18 06:18:53 UTC (rev 5938)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script/DirectorySearch.h	2010-02-20 07:52:21 UTC (rev 5939)
@@ -1,117 +0,0 @@
-// DirectorySearch.h: interface for the CDirectorySearch class.
-//
-//////////////////////////////////////////////////////////////////////
-/*
-Copyright 2001-2005 Anish Mistry. All rights reserved.
-
-Note:  This file is available under a BSD license.  Contact the author
-at <A HREF="https://lists.berlios.de/mailman/listinfo/avidemux-svn-commit">amistry at am-productions.biz</A>
-*/
-
-#ifndef _DIRECTORYSEARCH_H
-#define _DIRECTORYSEARCH_H
-
-#if _MSC_VER &gt; 1000
-#pragma once
-#endif // _MSC_VER &gt; 1000
-#ifdef __MINGW32__
-#include &lt;io.h&gt;
-#include &lt;sys/stat.h&gt;
-#else
-#include &lt;sys/types.h&gt;
-#include &lt;sys/stat.h&gt;
-#include &lt;dirent.h&gt;
-#include &lt;string.h&gt;
-#endif
-#include &lt;cstring&gt;
-#include &quot;StdFile.h&quot;
-
-// create a non file bit for unix
-#define _A_NONFILE	0x03
-
-#if defined( __unix__) || defined(__APPLE__)
-
-// wrap the file mode bits
-#define _A_NORMAL	0x00
-#define _A_HIDDEN	0x02
-#define _A_ARCH		0x20
-#define _A_SUBDIR	0x10
-
-// we need to emulate the windows style directory searching
-struct _finddata_t {
-	unsigned    attrib;
-	time_t      time_create;    /* -1 for FAT file systems */
-	time_t      time_access;    /* -1 for FAT file systems */
-	time_t      time_write;
-	int64_t     size;
-	char        name[260];
-	_finddata_t() : attrib(0), time_create(0), time_access(0), time_write(0), size(0) {name[0] = 0;}
-};
-
-#endif
-
-
-class CDirectorySearch
-{
-public:
-	const char * GetExtension();
-	bool IsExtension(const char *pExtension);
-	inline bool NextFile()
-	{// begin NextFile
-		if(_findnext(m_hSearch,&amp;m_fdData) == -1)
-			return false;
-		return true;
-	}// end NextFile
-	bool Init(std::string sDirectory);
-	bool IsDoubleDot();
-	bool IsSingleDot();
-	inline unsigned long int GetFileSize()
-	// returns the file size in bytes
-	{// begin GetFileSize
-		return m_fdData.size;
-	}// end GetFileSize
-	inline bool IsHidden()
-	{// begin IsHidden
-		return (bool)(m_fdData.attrib &amp; _A_HIDDEN);
-	}// end IsHidden
-	inline bool IsArchive()
-	{// begin IsArchive
-		return (bool)(m_fdData.attrib &amp; _A_ARCH);
-	}// end IsArchive
-	inline bool IsDirectory()
-	{// begin IsDirectory
-		return (bool)(m_fdData.attrib &amp; _A_SUBDIR);
-	}// end IsDirectory
-	inline bool IsNotFile()
-	{// begin IsNotFile
-		return (bool)(m_fdData.attrib &amp; _A_NONFILE);
-	}// end IsNotFile
-	std::string GetFileDirectory();
-	inline char * GetFileName(char *pBuffer)
-	{// begin GetFileName
-		return strcpy(pBuffer,m_fdData.name);
-	}// end GetFileName
-	inline const char * GetFileName()
-	{// begin GetFileName
-		return (const char *)m_fdData.name;
-	}// end GetFileName
-	std::string GetFilePath();
-	bool Close();
-	CDirectorySearch();
-	virtual ~CDirectorySearch();
-
-protected:
-	std::string GetFileDirectory(std::string sFilePath) const;
-	long m_hSearch;
-	_finddata_t m_fdData;
-	std::string m_sDirectory;
-private:
-#if defined(__unix__) || defined(__APPLE__)
-	// prototypes
-	int _findfirst(const char *path,_finddata_t *pfdData);
-	int _findnext(unsigned long int hDir,_finddata_t *pfdData);
-	int _findclose(unsigned long int hDir);
-#endif
-};
-
-#endif // !defined(_DIRECTORYSEARCH_H)

Deleted: branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script/StdFile.h
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script/StdFile.h	2010-02-18 06:18:53 UTC (rev 5938)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script/StdFile.h	2010-02-20 07:52:21 UTC (rev 5939)
@@ -1,63 +0,0 @@
-// StdFile.h: interface for the CStdFile class.
-//
-//////////////////////////////////////////////////////////////////////
-/*
-Copyright 2001-2005 Anish Mistry. All rights reserved.
-
-Note:  This file is available under a BSD license.  Contact the author
-at <A HREF="https://lists.berlios.de/mailman/listinfo/avidemux-svn-commit">amistry at am-productions.biz</A>
-*/
-
-#if !defined(AFX_STDFILE_H__44214218_8F1A_4792_8D4D_8147F50E168D__INCLUDED_)
-#define AFX_STDFILE_H__44214218_8F1A_4792_8D4D_8147F50E168D__INCLUDED_
-
-#if _MSC_VER &gt; 1000
-#pragma once
-#endif // _MSC_VER &gt; 1000
-
-#include &lt;iostream&gt;
-#include &lt;iomanip&gt;
-#include &lt;fstream&gt;
-#include &lt;stdlib.h&gt;
-#include &lt;string&gt;
-
-using namespace std;
-
-#ifdef __WIN32
-	const char DIRECTORY_DELIMITOR = '\\';
-#else
-	const char DIRECTORY_DELIMITOR = '/';
-	#define _MAX_PATH 1024
-#endif
-
-class CStdFile
-{
-public:
-	char Peek();
-	int WriteString(const char *pBuffer);
-	char * ReadString(char *pBuffer, int nMaxLen,char cDelim = ' ');
-	unsigned long int GetPos();
-	unsigned long int Seek(unsigned long int pos,ios::seekdir start);
-	unsigned long int GetLength();
-	unsigned long int Write(const char *buffer, unsigned long int bytesToWrite);
-	unsigned long int Read(char *buffer, unsigned long int bytesToRead);
-	const char * GetFilePath();
-	const char * GetFileName();
-	CStdFile(void);
-	virtual ~CStdFile(void);
-//	static bool Copy(const char *source,const char *dest, bool bOverwrite);
-	static int Rename(const char *source,const char *dest);
-	static int Delete(const char *fileName);
-	virtual bool Open(const char *filename, ios::openmode accessFlags);
-	unsigned long int WriteLine(const char *);
-	unsigned long int ReadLine(char *bufferOut);
-	virtual bool Close();
-
-protected:
-	void GetName(const char *fileString,char *fileBufferOut);
-	char *m_pPath;
-	char *m_pName;
-	fstream m_fsFile;
-};
-
-#endif // !defined(AFX_STDFILE_H__44214218_8F1A_4792_8D4D_8147F50E168D__INCLUDED_)

Deleted: branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script/adm_scanner.h
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script/adm_scanner.h	2010-02-18 06:18:53 UTC (rev 5938)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script/adm_scanner.h	2010-02-20 07:52:21 UTC (rev 5939)
@@ -1,26 +0,0 @@
-/*
-	Type used by scanner
-
-*/
-#ifndef ADMSCANNER
-#define ADMSCANNER
-
-#define ADM_MAX_VAR 50
-//#include &quot;ADM_videoFilter_iface.h&quot;
-
-typedef enum
-{
-	ASC_OK,
-	ASC_UNKNOWN_FUNC,
-	ASC_BAD_NUM_PARAM,
-	ASC_BAD_PARAM,
-	ASC_EXEC_FAILED
-}ASC_ERROR;
-
-//int PushParam(APM_TYPE, char *value);
-int Call(char *string);
-
-
-#endif
-//END
-

Copied: branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/include/ADM_JSif.h (from rev 5938, branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script/ADM_JSif.h)
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script/ADM_JSif.h	2010-02-18 06:18:53 UTC (rev 5938)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/include/ADM_JSif.h	2010-02-20 07:52:21 UTC (rev 5939)
@@ -0,0 +1,51 @@
+/**
+    \file ADM_JSif.cpp
+    \brief interface to js
+*/
+
+/***************************************************************************
+ *                                                                         *
+ *   This program is free software; you can redistribute it and/or modify  *
+ *   it under the terms of the GNU General Public License as published by  *
+ *   the Free Software Foundation; either version 2 of the License, or     *
+ *   (at your option) any later version.                                   *
+ *                                                                         *
+ ***************************************************************************/
+#ifndef ADM_JS_IF_H
+#define ADM_JS_IF_H
+
+/**
+    \enum JS_LOG_TYPE
+*/
+typedef enum
+{
+    JS_LOG_NORMAL,
+    JS_LOG_ERROR
+}JS_LOG_TYPE;
+/**
+    \typedef jsLoggerFunc
+*/
+typedef bool (jsLoggerFunc)(void *cookie,JS_LOG_TYPE type,const char *);
+/*
+
+*/
+bool ADM_jsRegisterLogger(void *cookie,jsLoggerFunc *fun);
+bool ADM_jsUnregisterLogger(void);
+
+/**
+    \fn parseECMAScript
+    \brief Compile &amp; execute ecma script
+*/
+bool parseECMAScript(const char *name);
+
+/**
+    \fn    interactiveECMAScript
+    \brief interprete &amp; execute ecma script (interactive)
+*/
+bool interactiveECMAScript(const char *name);
+/**
+    \fn jsLog
+
+*/
+bool jsLog(JS_LOG_TYPE type, const char *fmt,...);
+#endif

Modified: branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src/CMakeLists.txt
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src/CMakeLists.txt	2010-02-18 06:18:53 UTC (rev 5938)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/ADM_script2/src/CMakeLists.txt	2010-02-20 07:52:21 UTC (rev 5939)
@@ -23,5 +23,5 @@
 
 ADD_LIBRARY(ADM_script26 STATIC ${ADM_script_SRCS})
 ADD_DEFINITIONS(&quot;-DJS_THREADSAFE -DXP_UNIX&quot;)
-include_directories(${CMAKE_CURRENT_SOURCE_DIR}/../include)
+include_directories(${AVIDEMUX_TOP_SOURCE_DIR}/avidemux/common/ADM_script2/include)
 include_directories(${AVIDEMUX_TOP_SOURCE_DIR}/avidemux_core/ADM_smjs)

Modified: branches/avidemux_2.6_branch_mean/avidemux/common/CMakeLists.txt
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/CMakeLists.txt	2010-02-18 06:18:53 UTC (rev 5938)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/CMakeLists.txt	2010-02-20 07:52:21 UTC (rev 5939)
@@ -14,7 +14,7 @@
 #ADD_SUBDIRECTORY(ADM_plugin)
 ADD_SUBDIRECTORY(ADM_render)
 ADD_SUBDIRECTORY(ADM_requant)
-ADD_SUBDIRECTORY(ADM_script)
+#ADD_SUBDIRECTORY(ADM_script)
 ADD_SUBDIRECTORY(ADM_script2)
 ADD_SUBDIRECTORY(ADM_toolkit)
 #ADD_SUBDIRECTORY(ADM_video)

Modified: branches/avidemux_2.6_branch_mean/avidemux/common/gtk_gui.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/gtk_gui.cpp	2010-02-18 06:18:53 UTC (rev 5938)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/gtk_gui.cpp	2010-02-20 07:52:21 UTC (rev 5939)
@@ -40,7 +40,7 @@
 
 #include &quot;avi_vars.h&quot;
 #include &quot;prototype.h&quot; // FIXME
-#include &quot;ADM_script/ADM_JSif.h&quot;
+#include &quot;ADM_script2/include/ADM_JSif.h&quot;
 char * actual_workbench_file;
 renderZoom currentZoom=ZOOM_1_1;
 //***********************************

Modified: branches/avidemux_2.6_branch_mean/avidemux/qt4/ADM_userInterfaces/ADM_shell/CMakeLists.txt
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/qt4/ADM_userInterfaces/ADM_shell/CMakeLists.txt	2010-02-18 06:18:53 UTC (rev 5938)
+++ branches/avidemux_2.6_branch_mean/avidemux/qt4/ADM_userInterfaces/ADM_shell/CMakeLists.txt	2010-02-20 07:52:21 UTC (rev 5939)
@@ -18,5 +18,5 @@
 
 INCLUDE_DIRECTORIES(${CMAKE_CURRENT_BINARY_DIR})
 INCLUDE_DIRECTORIES(&quot;${CMAKE_SOURCE_DIR}/avidemux/ADM_UIs/ADM_QT4/include&quot;)
-INCLUDE_DIRECTORIES(&quot;${AVIDEMUX_TOP_SOURCE_DIR}/avidemux/common/ADM_script/&quot;)
+INCLUDE_DIRECTORIES(&quot;${AVIDEMUX_TOP_SOURCE_DIR}/avidemux/common/ADM_script2/include/&quot;)
 ADD_LIBRARY(${ADM_LIB} STATIC ${${ADM_LIB}_SRCS})


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="003143.html">[Avidemux-svn-commit] r5938 - in	branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreVideoEncoder:	include src
</A></li>
	<LI>Next message: <A HREF="003145.html">[Avidemux-svn-commit] r5940 - in	branches/avidemux_2.6_branch_mean/avidemux:	cli/ADM_userInterfaces/ADM_shell gtk/ADM_userInterfaces/ADM_shell
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#3144">[ date ]</a>
              <a href="thread.html#3144">[ thread ]</a>
              <a href="subject.html#3144">[ subject ]</a>
              <a href="author.html#3144">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/avidemux-svn-commit">More information about the Avidemux-svn-commit
mailing list</a><br>
</body></html>
