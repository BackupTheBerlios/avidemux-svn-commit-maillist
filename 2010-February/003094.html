<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Avidemux-svn-commit] r5889 - in branches/avidemux_2.6_branch_mean: avidemux/common avidemux/common/ADM_audioFilter/src avidemux/common/ADM_videoEncoder/include avidemux/common/ADM_videoEncoder/src avidemux_core/ADM_coreAudioEncoder/include avidemux_core/ADM_coreAudioFilter/include avidemux_core/ADM_coreMuxer/include avidemux_core/ADM_coreVideoEncoder/include avidemux_core/ADM_coreVideoEncoder/src avidemux_plugins/ADM_audioEncoders/aften avidemux_plugins/ADM_audioEncoders/faac avidemux_plugins/ADM_audioEncoders/lame avidemux_plugins/ADM_audioEncoders/lavcodec avidemux_plugins/ADM_audioEncoders/pcm avidemux_plugins/ADM_audioEncoders/twolame avidemux_plugins/ADM_audioEncoders/vorbis avidemux_plugins/ADM_muxers/muxerMp4 avidemux_plugins/ADM_videoEncoder/ffFlv1 avidemux_plugins/ADM_videoEncoder/ffMpeg4 avidemux_plugins/ADM_videoEncoder/ffMsMpeg4 avidemux_plugins/ADM_videoEncoder/huff avidemux_plugins/ADM_videoEncoder/jpeg avidemux_plugins/ADM_videoEncoder/png avidemux_plugins/ADM_videoEncode! r/yv12
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/avidemux-svn-commit/2010-February/index.html" >
   <LINK REL="made" HREF="mailto:avidemux-svn-commit%40lists.berlios.de?Subject=Re%3A%20%5BAvidemux-svn-commit%5D%20r5889%20-%20in%20branches/avidemux_2.6_branch_mean%3A%0A%20avidemux/common%20avidemux/common/ADM_audioFilter/src%0A%20avidemux/common/ADM_videoEncoder/include%0A%20avidemux/common/ADM_videoEncoder/src%0A%20avidemux_core/ADM_coreAudioEncoder/include%0A%20avidemux_core/ADM_coreAudioFilter/include%0A%20avidemux_core/ADM_coreMuxer/include%0A%20avidemux_core/ADM_coreVideoEncoder/include%0A%20avidemux_core/ADM_coreVideoEncoder/src%0A%20avidemux_plugins/ADM_audioEncoders/aften%0A%20avidemux_plugins/ADM_audioEncoders/faac%0A%20avidemux_plugins/ADM_audioEncoders/lame%0A%20avidemux_plugins/ADM_audioEncoders/lavcodec%0A%20avidemux_plugins/ADM_audioEncoders/pcm%0A%20avidemux_plugins/ADM_audioEncoders/twolame%0A%20avidemux_plugins/ADM_audioEncoders/vorbis%0A%20avidemux_plugins/ADM_muxers/muxerMp4%0A%20avidemux_plugins/ADM_videoEncoder/ffFlv1%0A%20avidemux_plugins/ADM_videoEncoder/ffMpeg4%0A%20avidemux_plugins/ADM_videoEncoder/ffMsMpeg4%0A%20avidemux_plugins/ADM_videoEncoder/huff%0A%20avidemux_plugins/ADM_videoEncoder/jpeg%0A%20avidemux_plugins/ADM_videoEncoder/png%20avidemux_plugins/ADM_videoEncode%21%0A%20r/yv12&In-Reply-To=%3C201002040642.o146gAwU007702%40sheep.berlios.de%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="003093.html">
   <LINK REL="Next"  HREF="003095.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Avidemux-svn-commit] r5889 - in branches/avidemux_2.6_branch_mean: avidemux/common avidemux/common/ADM_audioFilter/src avidemux/common/ADM_videoEncoder/include avidemux/common/ADM_videoEncoder/src avidemux_core/ADM_coreAudioEncoder/include avidemux_core/ADM_coreAudioFilter/include avidemux_core/ADM_coreMuxer/include avidemux_core/ADM_coreVideoEncoder/include avidemux_core/ADM_coreVideoEncoder/src avidemux_plugins/ADM_audioEncoders/aften avidemux_plugins/ADM_audioEncoders/faac avidemux_plugins/ADM_audioEncoders/lame avidemux_plugins/ADM_audioEncoders/lavcodec avidemux_plugins/ADM_audioEncoders/pcm avidemux_plugins/ADM_audioEncoders/twolame avidemux_plugins/ADM_audioEncoders/vorbis avidemux_plugins/ADM_muxers/muxerMp4 avidemux_plugins/ADM_videoEncoder/ffFlv1 avidemux_plugins/ADM_videoEncoder/ffMpeg4 avidemux_plugins/ADM_videoEncoder/ffMsMpeg4 avidemux_plugins/ADM_videoEncoder/huff avidemux_plugins/ADM_videoEncoder/jpeg avidemux_plugins/ADM_videoEncoder/png avidemux_plugins/ADM_videoEncode! r/yv12</H1>
    <B>mean at BerliOS</B> 
    <A HREF="mailto:avidemux-svn-commit%40lists.berlios.de?Subject=Re%3A%20%5BAvidemux-svn-commit%5D%20r5889%20-%20in%20branches/avidemux_2.6_branch_mean%3A%0A%20avidemux/common%20avidemux/common/ADM_audioFilter/src%0A%20avidemux/common/ADM_videoEncoder/include%0A%20avidemux/common/ADM_videoEncoder/src%0A%20avidemux_core/ADM_coreAudioEncoder/include%0A%20avidemux_core/ADM_coreAudioFilter/include%0A%20avidemux_core/ADM_coreMuxer/include%0A%20avidemux_core/ADM_coreVideoEncoder/include%0A%20avidemux_core/ADM_coreVideoEncoder/src%0A%20avidemux_plugins/ADM_audioEncoders/aften%0A%20avidemux_plugins/ADM_audioEncoders/faac%0A%20avidemux_plugins/ADM_audioEncoders/lame%0A%20avidemux_plugins/ADM_audioEncoders/lavcodec%0A%20avidemux_plugins/ADM_audioEncoders/pcm%0A%20avidemux_plugins/ADM_audioEncoders/twolame%0A%20avidemux_plugins/ADM_audioEncoders/vorbis%0A%20avidemux_plugins/ADM_muxers/muxerMp4%0A%20avidemux_plugins/ADM_videoEncoder/ffFlv1%0A%20avidemux_plugins/ADM_videoEncoder/ffMpeg4%0A%20avidemux_plugins/ADM_videoEncoder/ffMsMpeg4%0A%20avidemux_plugins/ADM_videoEncoder/huff%0A%20avidemux_plugins/ADM_videoEncoder/jpeg%0A%20avidemux_plugins/ADM_videoEncoder/png%20avidemux_plugins/ADM_videoEncode%21%0A%20r/yv12&In-Reply-To=%3C201002040642.o146gAwU007702%40sheep.berlios.de%3E"
       TITLE="[Avidemux-svn-commit] r5889 - in branches/avidemux_2.6_branch_mean: avidemux/common avidemux/common/ADM_audioFilter/src avidemux/common/ADM_videoEncoder/include avidemux/common/ADM_videoEncoder/src avidemux_core/ADM_coreAudioEncoder/include avidemux_core/ADM_coreAudioFilter/include avidemux_core/ADM_coreMuxer/include avidemux_core/ADM_coreVideoEncoder/include avidemux_core/ADM_coreVideoEncoder/src avidemux_plugins/ADM_audioEncoders/aften avidemux_plugins/ADM_audioEncoders/faac avidemux_plugins/ADM_audioEncoders/lame avidemux_plugins/ADM_audioEncoders/lavcodec avidemux_plugins/ADM_audioEncoders/pcm avidemux_plugins/ADM_audioEncoders/twolame avidemux_plugins/ADM_audioEncoders/vorbis avidemux_plugins/ADM_muxers/muxerMp4 avidemux_plugins/ADM_videoEncoder/ffFlv1 avidemux_plugins/ADM_videoEncoder/ffMpeg4 avidemux_plugins/ADM_videoEncoder/ffMsMpeg4 avidemux_plugins/ADM_videoEncoder/huff avidemux_plugins/ADM_videoEncoder/jpeg avidemux_plugins/ADM_videoEncoder/png avidemux_plugins/ADM_videoEncode! r/yv12">mean at mail.berlios.de
       </A><BR>
    <I>Thu Feb  4 07:42:10 CET 2010</I>
    <P><UL>
        <LI>Previous message: <A HREF="003093.html">[Avidemux-svn-commit] r5888 - in branches/avidemux_2.6_branch_mean:	avidemux/common/ADM_audioFilter/include	avidemux/common/ADM_audioFilter/src	avidemux_core/ADM_coreAudioFilter/include
</A></li>
        <LI>Next message: <A HREF="003095.html">[Avidemux-svn-commit] r5890 - in branches/avidemux_2.6_branch_mean:	avidemux_core/ADM_coreMuxer/src	avidemux_core/ADM_coreVideoEncoder/src	avidemux_plugins/ADM_audioEncoders/lavcodec
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#3094">[ date ]</a>
              <a href="thread.html#3094">[ thread ]</a>
              <a href="subject.html#3094">[ subject ]</a>
              <a href="author.html#3094">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Author: mean
Date: 2010-02-04 07:42:04 +0100 (Thu, 04 Feb 2010)
New Revision: 5889

Modified:
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_audioFilter/src/audio_encoderPlugin.cpp
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_audioFilter/src/audiofilter_encoder.cpp
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_videoEncoder/include/ADM_videoEncoderApi.h
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_videoEncoder/src/ADM_dynVideoEncoder.cpp
   branches/avidemux_2.6_branch_mean/avidemux/common/gui_savenew.cpp
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreAudioEncoder/include/audioencoderInternal.h
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreAudioFilter/include/audioEncoderApi.h
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreMuxer/include/ADM_muxer.h
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreMuxer/include/ADM_muxerInternal.h
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreVideoEncoder/include/ADM_coreVideoEncoderFFmpeg.h
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreVideoEncoder/include/ADM_coreVideoEncoderInternal.h
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreVideoEncoder/src/ADM_coreVideoEncoderFFmpeg.cpp
   branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_audioEncoders/aften/audioencoder_aften.cpp
   branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_audioEncoders/aften/audioencoder_aften.h
   branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_audioEncoders/faac/audioencoder_faac.cpp
   branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_audioEncoders/faac/audioencoder_faac.h
   branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_audioEncoders/lame/audioencoder_lame.cpp
   branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_audioEncoders/lame/audioencoder_lame.h
   branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_audioEncoders/lavcodec/audioencoder_lavcodec.cpp
   branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_audioEncoders/lavcodec/audioencoder_lavcodec.h
   branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_audioEncoders/pcm/audioencoder_pcm.cpp
   branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_audioEncoders/pcm/audioencoder_pcm.h
   branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_audioEncoders/twolame/audioencoder_twolame.cpp
   branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_audioEncoders/twolame/audioencoder_twolame.h
   branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_audioEncoders/vorbis/audioencoder_vorbis.cpp
   branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_audioEncoders/vorbis/audioencoder_vorbis.h
   branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_muxers/muxerMp4/muxerMP4.h
   branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_videoEncoder/ffFlv1/ADM_ffFlv1.cpp
   branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_videoEncoder/ffFlv1/ADM_ffFlv1.h
   branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_videoEncoder/ffMpeg4/ADM_ffMpeg4.cpp
   branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_videoEncoder/ffMpeg4/ADM_ffMpeg4.h
   branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_videoEncoder/ffMsMpeg4/ADM_ffMsMp4.cpp
   branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_videoEncoder/ffMsMpeg4/ADM_ffMsMp4.h
   branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_videoEncoder/huff/ADM_huffEncoder.cpp
   branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_videoEncoder/huff/ADM_huffEncoder.h
   branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_videoEncoder/jpeg/ADM_jpegEncoder.cpp
   branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_videoEncoder/jpeg/ADM_jpegEncoder.h
   branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_videoEncoder/png/ADM_pngEncoder.cpp
   branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_videoEncoder/png/ADM_pngEncoder.h
   branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_videoEncoder/yv12/ADM_yv12Encoder.cpp
   branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_videoEncoder/yv12/ADM_yv12Encoder.h
Log:
[encoder] New flag to check if the muxer needs global headers

Modified: branches/avidemux_2.6_branch_mean/avidemux/common/ADM_audioFilter/src/audio_encoderPlugin.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/ADM_audioFilter/src/audio_encoderPlugin.cpp	2010-02-03 06:43:50 UTC (rev 5888)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/ADM_audioFilter/src/audio_encoderPlugin.cpp	2010-02-04 06:42:04 UTC (rev 5889)
@@ -336,11 +336,11 @@
         \fn audioEncoderCreate
         \brief Spawn an audio encoder
 */
-ADM_AudioEncoder *audioEncoderCreate(AUDMAudioFilter *filter)
+ADM_AudioEncoder *audioEncoderCreate(AUDMAudioFilter *filter,bool globalHeader)
 {
       ADM_assert(currentEncoder&lt;ListOfAudioEncoder.size());
       ADM_audioEncoder *enc=ListOfAudioEncoder[currentEncoder];
-     return enc-&gt;create(filter);
+     return enc-&gt;create(filter,globalHeader);
 }
 /**
         \fn getAudioExtraConf

Modified: branches/avidemux_2.6_branch_mean/avidemux/common/ADM_audioFilter/src/audiofilter_encoder.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/ADM_audioFilter/src/audiofilter_encoder.cpp	2010-02-03 06:43:50 UTC (rev 5888)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/ADM_audioFilter/src/audiofilter_encoder.cpp	2010-02-04 06:42:04 UTC (rev 5889)
@@ -66,7 +66,7 @@
 /**
     \fn createEncodingAccess
 */
-ADM_audioStream *audioCreateEncodingStream(uint64_t startTime,int32_t shift)
+ADM_audioStream *audioCreateEncodingStream(bool globalHeader,uint64_t startTime,int32_t shift)
 {
     printf(&quot;[AccessFilter] Creating access filter\n&quot;);
     // 1-Create access filter
@@ -78,7 +78,7 @@
     }
 
     // 2- spawn encoder
-    ADM_AudioEncoder *encoder=audioEncoderCreate(filter);
+    ADM_AudioEncoder *encoder=audioEncoderCreate(filter,globalHeader);
     if(!encoder) 
     {
         printf(&quot;[Access] Cannot create audio encoder\n&quot;);

Modified: branches/avidemux_2.6_branch_mean/avidemux/common/ADM_videoEncoder/include/ADM_videoEncoderApi.h
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/ADM_videoEncoder/include/ADM_videoEncoderApi.h	2010-02-03 06:43:50 UTC (rev 5888)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/ADM_videoEncoder/include/ADM_videoEncoderApi.h	2010-02-04 06:42:04 UTC (rev 5889)
@@ -21,7 +21,7 @@
 class ADM_coreVideoFilter;
 class CONFcouple;
 // Spawn a new encoder using the index from the menu = the index in the vector
-ADM_coreVideoEncoder *createVideoEncoderFromIndex(ADM_coreVideoFilter *chain,int index);
+//ADM_coreVideoEncoder *createVideoEncoderFromIndex(ADM_coreVideoFilter *chain,int index);
 
 bool                  videoEncoder6SelectByName(const char *name);
 bool                  videoEncoder6Configure(void);
@@ -35,6 +35,6 @@
 bool                  videoEncoder6_SetConfiguration(CONFcouple *c);
 bool                  videoEncoder6_GetConfiguration(CONFcouple **c);
 
-ADM_coreVideoEncoder *createVideoEncoderFromIndex(ADM_coreVideoFilter *chain,int index);
+ADM_coreVideoEncoder *createVideoEncoderFromIndex(ADM_coreVideoFilter *chain,int index,bool globalHeader);
 
 #endif

Modified: branches/avidemux_2.6_branch_mean/avidemux/common/ADM_videoEncoder/src/ADM_dynVideoEncoder.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/ADM_videoEncoder/src/ADM_dynVideoEncoder.cpp	2010-02-03 06:43:50 UTC (rev 5888)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/ADM_videoEncoder/src/ADM_dynVideoEncoder.cpp	2010-02-04 06:42:04 UTC (rev 5889)
@@ -191,14 +191,14 @@
 /**
     \fn createVideoEncoder
 */
-ADM_coreVideoEncoder *createVideoEncoderFromIndex(ADM_coreVideoFilter *chain,int index)
+ADM_coreVideoEncoder *createVideoEncoderFromIndex(ADM_coreVideoFilter *chain,int index,bool globalHeader)
 {
     int nb=ListOfEncoders.size();
 	ADM_assert(index &lt; nb);
     ADM_assert(index); // 0 is for copy, should not get it through here
     ADM_videoEncoder6 *plugin=ListOfEncoders[index];
 
-    ADM_coreVideoEncoder *enc=plugin-&gt;desc-&gt;create(chain);
+    ADM_coreVideoEncoder *enc=plugin-&gt;desc-&gt;create(chain,globalHeader);
     return enc;
 }
 /**

Modified: branches/avidemux_2.6_branch_mean/avidemux/common/gui_savenew.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/gui_savenew.cpp	2010-02-03 06:43:50 UTC (rev 5888)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/gui_savenew.cpp	2010-02-04 06:42:04 UTC (rev 5889)
@@ -41,7 +41,7 @@
 
 */
 ADM_muxer               *ADM_MuxerSpawnFromIndex(int index);
-extern ADM_audioStream  *audioCreateEncodingStream(uint64_t startTime,int32_t shift);
+extern ADM_audioStream  *audioCreateEncodingStream(bool globalHeader,uint64_t startTime,int32_t shift);
 extern ADM_audioStream  *audioCreateCopyStream(uint64_t startTime,int32_t shift,ADM_audioStream *input);
 extern ADM_videoStream  *createVideoStream(ADM_coreVideoEncoder *encoder);
 extern int              ADM_MuxerIndexFromName(const char *name);
@@ -196,7 +196,7 @@
                 int sz=chain-&gt;size();
                 ADM_assert(sz);
                 last=(*chain)[sz-1]; // Grab last filter
-                ADM_coreVideoEncoder *pass2=createVideoEncoderFromIndex(last,videoEncoderIndex);
+                ADM_coreVideoEncoder *pass2=createVideoEncoderFromIndex(last,videoEncoderIndex,muxer-&gt;useGlobalHeader()); 
                 if(!pass2)
                 {
                     printf(&quot;[Save] Cannot create encoder for pass 2\n&quot;);
@@ -281,7 +281,7 @@
         ADM_assert(sz);
         ADM_coreVideoFilter  *last;
         last=(*chain)[sz-1]; // Grab last filter
-        ADM_coreVideoEncoder *encoder=createVideoEncoderFromIndex(last,videoEncoderIndex);
+        ADM_coreVideoEncoder *encoder=createVideoEncoderFromIndex(last,videoEncoderIndex,muxer-&gt;useGlobalHeader()); // FIXME GLOBAL HEADERS
         if(!encoder)
         {
            GUI_Error_HIG(&quot;Video&quot;,&quot;Cannot create encoder&quot;);
@@ -324,7 +324,7 @@
         if(audio)   // Process
         {
             // Access..
-            ADM_audioStream *access=audioCreateEncodingStream(startAudioTime,0); // FIXME LEAK
+            ADM_audioStream *access=audioCreateEncodingStream(startAudioTime,0,muxer-&gt;useGlobalHeader()); // FIXME LEAK FIXME 
             astreams[0]=access;
             if(!access)
             {

Modified: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreAudioEncoder/include/audioencoderInternal.h
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreAudioEncoder/include/audioencoderInternal.h	2010-02-03 06:43:50 UTC (rev 5888)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreAudioEncoder/include/audioencoderInternal.h	2010-02-04 06:42:04 UTC (rev 5889)
@@ -15,7 +15,7 @@
 #ifndef AUDIOENCODERINTERNAL_H
 #define AUDIOENCODERINTERNAL_H
 
-#define ADM_AUDIO_ENCODER_API_VERSION 3
+#define ADM_AUDIO_ENCODER_API_VERSION 4
 #include &quot;stddef.h&quot;
 #include &quot;audioencoder.h&quot;
 #include &quot;ADM_paramList.h&quot;
@@ -34,7 +34,7 @@
 typedef struct
 {
     uint32_t     apiVersion;            // const
-    ADM_AudioEncoder *(*create)(AUDMAudioFilter *head);  
+    ADM_AudioEncoder *(*create)(AUDMAudioFilter *head, bool globalHeader);
     void         (*destroy)(ADM_AudioEncoder *codec);
     bool         (*configure)(void);    
     const char   *codecName;        // Internal name (tag)
@@ -63,9 +63,9 @@
 static uint32_t     getBitrate(void); \
 static void         setBitrate(uint32_t br); \
 \
-static ADM_AudioEncoder * create (AUDMAudioFilter * head) \
+static ADM_AudioEncoder * create (AUDMAudioFilter * head,bool globalHeader) \
 { \
-  return new Class (head); \
+  return new Class (head,globalHeader); \
 } \
 static void destroy (ADM_AudioEncoder * in) \
 {\

Modified: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreAudioFilter/include/audioEncoderApi.h
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreAudioFilter/include/audioEncoderApi.h	2010-02-03 06:43:50 UTC (rev 5888)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreAudioFilter/include/audioEncoderApi.h	2010-02-04 06:42:04 UTC (rev 5889)
@@ -17,7 +17,7 @@
 /// Directly set the codec, *only to be used
 uint8_t audioCodecSetByIndex(int i);
 /// Spawn a new encoder
-ADM_AudioEncoder *audioEncoderCreate(AUDMAudioFilter *filter);
+ADM_AudioEncoder *audioEncoderCreate(AUDMAudioFilter *filter,bool globalHeader);
 /// Select a encoder by its name e.g. &quot;lame&quot;, used only by JS. Update UI as well
 uint8_t audioCodecSetByName( const char *name);
 /// Returns the name of the currently selected codec

Modified: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreMuxer/include/ADM_muxer.h
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreMuxer/include/ADM_muxer.h	2010-02-03 06:43:50 UTC (rev 5888)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreMuxer/include/ADM_muxer.h	2010-02-04 06:42:04 UTC (rev 5889)
@@ -70,6 +70,7 @@
         virtual  bool     initUI(const char *title);
         virtual  bool     updateUI(uint64_t time);
         virtual  bool     closeUI(void);
+        virtual  bool     useGlobalHeader(void) {return false;}
 
 };
 #endif

Modified: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreMuxer/include/ADM_muxerInternal.h
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreMuxer/include/ADM_muxerInternal.h	2010-02-03 06:43:50 UTC (rev 5888)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreMuxer/include/ADM_muxerInternal.h	2010-02-04 06:42:04 UTC (rev 5889)
@@ -16,7 +16,7 @@
 #ifndef  ADM_muxerInternal_H
 #define  ADM_muxerInternal_H
 
-#define ADM_MUXER_API_VERSION 3
+#define ADM_MUXER_API_VERSION 4
 #include &lt;stddef.h&gt;
 #include &quot;ADM_dynamicLoading.h&quot;
 #include &quot;ADM_muxer.h&quot;

Modified: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreVideoEncoder/include/ADM_coreVideoEncoderFFmpeg.h
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreVideoEncoder/include/ADM_coreVideoEncoderFFmpeg.h	2010-02-03 06:43:50 UTC (rev 5888)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreVideoEncoder/include/ADM_coreVideoEncoderFFmpeg.h	2010-02-04 06:42:04 UTC (rev 5889)
@@ -42,6 +42,7 @@
                int              pass;   // Pass number = 1 or 2, valid only if we use 2 pass mode
                bool             _isMT; // True if multithreaded
                uint64_t         nextDts;
+               bool             _globalHeader;
 protected:
     virtual               bool             prolog(void); 
     virtual               bool             preEncode(void); 
@@ -53,7 +54,7 @@
                           bool             setupPass(void);  
                           bool             encoderMT (void);
 public:
-                                            ADM_coreVideoEncoderFFmpeg(ADM_coreVideoFilter *src,FFcodecSettings *settings=NULL);
+                                            ADM_coreVideoEncoderFFmpeg(ADM_coreVideoFilter *src,FFcodecSettings *settings=NULL,bool globalHeader=false);
 virtual                                     ~ADM_coreVideoEncoderFFmpeg();
 
 };

Modified: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreVideoEncoder/include/ADM_coreVideoEncoderInternal.h
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreVideoEncoder/include/ADM_coreVideoEncoderInternal.h	2010-02-03 06:43:50 UTC (rev 5888)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreVideoEncoder/include/ADM_coreVideoEncoderInternal.h	2010-02-04 06:42:04 UTC (rev 5889)
@@ -15,7 +15,7 @@
 #ifndef VIDEOENCODERINTERNAL_H
 #define VIDEOENCODERINTERNAL_H
 
-#define ADM_VIDEO_ENCODER_API_VERSION 3
+#define ADM_VIDEO_ENCODER_API_VERSION 4
 #include &quot;ADM_coreVideoEncoder.h&quot;
 #include &quot;DIA_uiTypes.h&quot;
 #include &quot;ADM_paramList.h&quot;
@@ -34,7 +34,7 @@
     const char   *description;      // Short description
 
     uint32_t     apiVersion;            // const
-    ADM_coreVideoEncoder *(*create)(ADM_coreVideoFilter *head);  
+    ADM_coreVideoEncoder *(*create)(ADM_coreVideoFilter *head,bool globalHeader);  
     void         (*destroy)(ADM_coreVideoEncoder *codec);
     bool         (*configure)(void);                                // Call UI to set it up
     bool         (*getConfigurationData)(CONFcouple **c); // Get the encoder private conf
@@ -52,9 +52,9 @@
 static bool getConfigurationData (CONFcouple **c); \
 static bool setConfigurationData (CONFcouple *c);\
 \
-static ADM_coreVideoEncoder * create (ADM_coreVideoFilter * head) \
+static ADM_coreVideoEncoder * create (ADM_coreVideoFilter * head,bool globalHeader) \
 { \
-  return new Class (head); \
+  return new Class (head,globalHeader); \
 } \
 static void destroy (ADM_coreVideoEncoder * in) \
 {\

Modified: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreVideoEncoder/src/ADM_coreVideoEncoderFFmpeg.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreVideoEncoder/src/ADM_coreVideoEncoderFFmpeg.cpp	2010-02-03 06:43:50 UTC (rev 5888)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreVideoEncoder/src/ADM_coreVideoEncoderFFmpeg.cpp	2010-02-04 06:42:04 UTC (rev 5889)
@@ -89,7 +89,7 @@
 
 */
 
-ADM_coreVideoEncoderFFmpeg::ADM_coreVideoEncoderFFmpeg(ADM_coreVideoFilter *src,FFcodecSettings *set) 
+ADM_coreVideoEncoderFFmpeg::ADM_coreVideoEncoderFFmpeg(ADM_coreVideoFilter *src,FFcodecSettings *set,bool globalHeader) 
                     : ADM_coreVideoEncoder(src)
 {
 uint32_t w,h;
@@ -111,6 +111,7 @@
     pass=0;
     statFileName=NULL;
     statFile=NULL;
+    _globalHeader=globalHeader;
     _isMT=false;
     encoderDelay=source-&gt;getInfo()-&gt;frameIncrement*LAVS(max_b_frames);
     ADM_info(&quot;[Lavcodec] Using a video encoder delay of %d ms\n&quot;,(int)(encoderDelay/1000));

Modified: branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_audioEncoders/aften/audioencoder_aften.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_audioEncoders/aften/audioencoder_aften.cpp	2010-02-03 06:43:50 UTC (rev 5888)
+++ branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_audioEncoders/aften/audioencoder_aften.cpp	2010-02-04 06:42:04 UTC (rev 5889)
@@ -76,7 +76,7 @@
 
 */
 
-AUDMEncoder_Aften::AUDMEncoder_Aften(AUDMAudioFilter * instream)  :ADM_AudioEncoder    (instream)
+AUDMEncoder_Aften::AUDMEncoder_Aften(AUDMAudioFilter * instream,bool globalHeader)  :ADM_AudioEncoder    (instream)
 {
   uint32_t channels;
   ADM_info(&quot;[Aften] Creating aften\n&quot;);
@@ -86,6 +86,7 @@
   aften_set_defaults(_HANDLE);
   wavheader.encoding=WAV_AC3;
   _HANDLE-&gt;system.n_threads=1;
+  _globalHeader= globalHeader;
 
 
   switch(channels)

Modified: branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_audioEncoders/aften/audioencoder_aften.h
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_audioEncoders/aften/audioencoder_aften.h	2010-02-03 06:43:50 UTC (rev 5888)
+++ branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_audioEncoders/aften/audioencoder_aften.h	2010-02-04 06:42:04 UTC (rev 5889)
@@ -24,12 +24,13 @@
 protected:
          void           *_handle;
          uint32_t       _chunk;
+         bool           _globalHeader;
 
 public:
                 bool    initialize(void);
     virtual     bool    encode(uint8_t *dest, uint32_t *len, uint32_t *samples);
     virtual             ~AUDMEncoder_Aften();
-                        AUDMEncoder_Aften(AUDMAudioFilter *instream);
+                        AUDMEncoder_Aften(AUDMAudioFilter *instream,bool globalHeader);
 };
 #endif
 

Modified: branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_audioEncoders/faac/audioencoder_faac.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_audioEncoders/faac/audioencoder_faac.cpp	2010-02-03 06:43:50 UTC (rev 5888)
+++ branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_audioEncoders/faac/audioencoder_faac.cpp	2010-02-04 06:42:04 UTC (rev 5889)
@@ -59,10 +59,11 @@
 
 /******************* / Declare plugin*******************************************************/
 
-AUDMEncoder_Faac::AUDMEncoder_Faac(AUDMAudioFilter * instream)  :ADM_AudioEncoder    (instream)
+AUDMEncoder_Faac::AUDMEncoder_Faac(AUDMAudioFilter * instream,bool globalHeader)  :ADM_AudioEncoder    (instream)
 {
   uint32_t channels;
   channels=instream-&gt;getInfo()-&gt;channels;
+  _globalHeader=globalHeader;
   switch(channels)
   {
     case 1:outputChannelMapping[1] = ADM_CH_FRONT_LEFT;break;

Modified: branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_audioEncoders/faac/audioencoder_faac.h
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_audioEncoders/faac/audioencoder_faac.h	2010-02-03 06:43:50 UTC (rev 5888)
+++ branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_audioEncoders/faac/audioencoder_faac.h	2010-02-04 06:42:04 UTC (rev 5889)
@@ -22,10 +22,11 @@
          void           *_handle;
          uint32_t        _chunk;
          uint8_t        refillBuffer(int minimum);
+         bool           _globalHeader;
 public:
                  bool   initialize(void);
     virtual             ~AUDMEncoder_Faac();
-                        AUDMEncoder_Faac(AUDMAudioFilter *instream);	
+                        AUDMEncoder_Faac(AUDMAudioFilter *instream,bool globalHeader);
     virtual bool	    encode(uint8_t *dest, uint32_t *len, uint32_t *samples);
 };
 

Modified: branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_audioEncoders/lame/audioencoder_lame.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_audioEncoders/lame/audioencoder_lame.cpp	2010-02-03 06:43:50 UTC (rev 5888)
+++ branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_audioEncoders/lame/audioencoder_lame.cpp	2010-02-04 06:42:04 UTC (rev 5889)
@@ -67,7 +67,7 @@
     \fn AUDMEncoder_Lame Constructor
     \brief
 */
-AUDMEncoder_Lame::AUDMEncoder_Lame (AUDMAudioFilter * instream):ADM_AudioEncoder  (instream)
+AUDMEncoder_Lame::AUDMEncoder_Lame (AUDMAudioFilter * instream,bool globalHeader):ADM_AudioEncoder  (instream)
 {
   printf (&quot;[Lame] Creating lame\n&quot;);
   lameFlags = NULL;

Modified: branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_audioEncoders/lame/audioencoder_lame.h
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_audioEncoders/lame/audioencoder_lame.h	2010-02-03 06:43:50 UTC (rev 5888)
+++ branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_audioEncoders/lame/audioencoder_lame.h	2010-02-04 06:42:04 UTC (rev 5889)
@@ -29,7 +29,7 @@
          
   public:
     virtual             ~AUDMEncoder_Lame();
-                        AUDMEncoder_Lame(AUDMAudioFilter *instream);	
+                        AUDMEncoder_Lame(AUDMAudioFilter *instream,bool globalHeader);	
             bool	    isVBR(void );
             
    virtual bool         encode(uint8_t *dest, uint32_t *len, uint32_t *samples);

Modified: branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_audioEncoders/lavcodec/audioencoder_lavcodec.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_audioEncoders/lavcodec/audioencoder_lavcodec.cpp	2010-02-03 06:43:50 UTC (rev 5888)
+++ branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_audioEncoders/lavcodec/audioencoder_lavcodec.cpp	2010-02-04 06:42:04 UTC (rev 5889)
@@ -67,10 +67,11 @@
 /**
     \fn AUDMEncoder_Lavcodec
 */
-AUDMEncoder_Lavcodec::AUDMEncoder_Lavcodec(AUDMAudioFilter * instream)  :ADM_AudioEncoder    (instream)
+AUDMEncoder_Lavcodec::AUDMEncoder_Lavcodec(AUDMAudioFilter * instream,bool globalHeader)  :ADM_AudioEncoder    (instream)
 {
   
   _context=NULL;
+  _globalHeader=globalHeader;
    printf(&quot;[Lavcodec] Creating Lavcodec audio encoder (0x%x)\n&quot;,makeName(WAV));
 
   wavheader.encoding=makeName(WAV);

Modified: branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_audioEncoders/lavcodec/audioencoder_lavcodec.h
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_audioEncoders/lavcodec/audioencoder_lavcodec.h	2010-02-03 06:43:50 UTC (rev 5888)
+++ branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_audioEncoders/lavcodec/audioencoder_lavcodec.h	2010-02-04 06:42:04 UTC (rev 5889)
@@ -21,12 +21,13 @@
    
     void              *_context;
     uint32_t            _chunk;
+    bool               _globalHeader;
     
          
   public:
             bool        initialize(void);
    virtual             ~AUDMEncoder_Lavcodec();
-                        AUDMEncoder_Lavcodec(AUDMAudioFilter *instream);	
+                        AUDMEncoder_Lavcodec(AUDMAudioFilter *instream,bool globalHeader);
    virtual bool  	    encode(uint8_t *dest, uint32_t *len, uint32_t *samples);
 };
 

Modified: branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_audioEncoders/pcm/audioencoder_pcm.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_audioEncoders/pcm/audioencoder_pcm.cpp	2010-02-03 06:43:50 UTC (rev 5888)
+++ branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_audioEncoders/pcm/audioencoder_pcm.cpp	2010-02-04 06:42:04 UTC (rev 5889)
@@ -61,7 +61,7 @@
 // Ctor: Duplicate
 //__________
 
-AUDMEncoder_PCM::AUDMEncoder_PCM(AUDMAudioFilter * instream)  :ADM_AudioEncoder    (instream)
+AUDMEncoder_PCM::AUDMEncoder_PCM(AUDMAudioFilter * instream,bool globalHeader)  :ADM_AudioEncoder    (instream)
 {
   printf(&quot;[PCM] Creating PCM\n&quot;);
   wavheader.encoding=WAV_PCM;

Modified: branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_audioEncoders/pcm/audioencoder_pcm.h
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_audioEncoders/pcm/audioencoder_pcm.h	2010-02-03 06:43:50 UTC (rev 5888)
+++ branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_audioEncoders/pcm/audioencoder_pcm.h	2010-02-04 06:42:04 UTC (rev 5889)
@@ -29,7 +29,7 @@
                         /*! \param reverted : Should the endianness be reverted compared to system  
                             \param fourCC   : FourCC to use (WAV_PCM/WAV_LPCM)
                         */
-                         AUDMEncoder_PCM(AUDMAudioFilter * instream);
+                         AUDMEncoder_PCM(AUDMAudioFilter * instream,bool globalHeader);
    virtual bool         encode(uint8_t *dest, uint32_t *len, uint32_t *samples);
    virtual bool         initialize(void);
 };

Modified: branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_audioEncoders/twolame/audioencoder_twolame.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_audioEncoders/twolame/audioencoder_twolame.cpp	2010-02-03 06:43:50 UTC (rev 5888)
+++ branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_audioEncoders/twolame/audioencoder_twolame.cpp	2010-02-04 06:42:04 UTC (rev 5889)
@@ -62,7 +62,7 @@
 /**
 
 */
-AUDMEncoder_Twolame::AUDMEncoder_Twolame(AUDMAudioFilter * instream)  :ADM_AudioEncoder    (instream)
+AUDMEncoder_Twolame::AUDMEncoder_Twolame(AUDMAudioFilter * instream,bool globalHeader)  :ADM_AudioEncoder    (instream)
 {
   printf(&quot;[TwoLame] Creating Twolame\n&quot;);
   _twolameOptions=NULL;

Modified: branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_audioEncoders/twolame/audioencoder_twolame.h
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_audioEncoders/twolame/audioencoder_twolame.h	2010-02-03 06:43:50 UTC (rev 5888)
+++ branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_audioEncoders/twolame/audioencoder_twolame.h	2010-02-04 06:42:04 UTC (rev 5889)
@@ -25,7 +25,7 @@
   public:
             bool     initialize(void);
     virtual             ~AUDMEncoder_Twolame();
-                        AUDMEncoder_Twolame(AUDMAudioFilter *instream);	
+                        AUDMEncoder_Twolame(AUDMAudioFilter *instream,bool globalHeader);
     virtual bool    encode(uint8_t *dest, uint32_t *len, uint32_t *samples);
     virtual bool    isVBR(void) {return false;}
 };

Modified: branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_audioEncoders/vorbis/audioencoder_vorbis.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_audioEncoders/vorbis/audioencoder_vorbis.cpp	2010-02-03 06:43:50 UTC (rev 5888)
+++ branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_audioEncoders/vorbis/audioencoder_vorbis.cpp	2010-02-04 06:42:04 UTC (rev 5889)
@@ -92,7 +92,7 @@
 
 //__________
 
-AUDMEncoder_Vorbis::AUDMEncoder_Vorbis(AUDMAudioFilter * instream)  :ADM_AudioEncoder    (instream)
+AUDMEncoder_Vorbis::AUDMEncoder_Vorbis(AUDMAudioFilter * instream,bool globalHeader)  :ADM_AudioEncoder    (instream)
 {
   printf(&quot;[Vorbis] Creating Vorbis\n&quot;);
   _handle=NULL;

Modified: branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_audioEncoders/vorbis/audioencoder_vorbis.h
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_audioEncoders/vorbis/audioencoder_vorbis.h	2010-02-03 06:43:50 UTC (rev 5888)
+++ branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_audioEncoders/vorbis/audioencoder_vorbis.h	2010-02-04 06:42:04 UTC (rev 5889)
@@ -31,7 +31,7 @@
   public:
                     bool     initialize(void);
         virtual     ~AUDMEncoder_Vorbis();
-                    AUDMEncoder_Vorbis(AUDMAudioFilter *instream);	
+                    AUDMEncoder_Vorbis(AUDMAudioFilter *instream,bool globalHeader);
             
         virtual bool	encode(uint8_t *dest, uint32_t *len, uint32_t *samples);
 };

Modified: branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_muxers/muxerMp4/muxerMP4.h
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_muxers/muxerMp4/muxerMP4.h	2010-02-03 06:43:50 UTC (rev 5888)
+++ branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_muxers/muxerMp4/muxerMP4.h	2010-02-04 06:42:04 UTC (rev 5889)
@@ -37,6 +37,7 @@
         virtual bool open(const char *file, ADM_videoStream *s,uint32_t nbAudioTrack,ADM_audioStream **a);
         virtual bool save(void) ;
         virtual bool close(void) ;
+        virtual     bool     useGlobalHeader(void) {return true;}
 
 };
 

Modified: branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_videoEncoder/ffFlv1/ADM_ffFlv1.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_videoEncoder/ffFlv1/ADM_ffFlv1.cpp	2010-02-03 06:43:50 UTC (rev 5888)
+++ branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_videoEncoder/ffFlv1/ADM_ffFlv1.cpp	2010-02-04 06:42:04 UTC (rev 5889)
@@ -83,7 +83,7 @@
 /**
         \fn ADM_ffFlv1Encoder
 */
-ADM_ffFlv1Encoder::ADM_ffFlv1Encoder(ADM_coreVideoFilter *src) : ADM_coreVideoEncoderFFmpeg(src,&amp;Flv1Settings)
+ADM_ffFlv1Encoder::ADM_ffFlv1Encoder(ADM_coreVideoFilter *src,bool globalHeader) : ADM_coreVideoEncoderFFmpeg(src,&amp;Flv1Settings,false)
 {
     printf(&quot;[ffFlv1] Creating.\n&quot;);
    

Modified: branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_videoEncoder/ffFlv1/ADM_ffFlv1.h
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_videoEncoder/ffFlv1/ADM_ffFlv1.h	2010-02-03 06:43:50 UTC (rev 5888)
+++ branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_videoEncoder/ffFlv1/ADM_ffFlv1.h	2010-02-04 06:42:04 UTC (rev 5889)
@@ -34,7 +34,7 @@
                
 public:
 
-                           ADM_ffFlv1Encoder(ADM_coreVideoFilter *src);
+                           ADM_ffFlv1Encoder(ADM_coreVideoFilter *src,bool globalHeader);
 virtual                    ~ADM_ffFlv1Encoder();
 virtual        bool        setup(void); 
 virtual        bool        encode (ADMBitstream * out);

Modified: branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_videoEncoder/ffMpeg4/ADM_ffMpeg4.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_videoEncoder/ffMpeg4/ADM_ffMpeg4.cpp	2010-02-03 06:43:50 UTC (rev 5888)
+++ branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_videoEncoder/ffMpeg4/ADM_ffMpeg4.cpp	2010-02-04 06:42:04 UTC (rev 5889)
@@ -82,7 +82,7 @@
 /**
         \fn ADM_ffMpeg4Encoder
 */
-ADM_ffMpeg4Encoder::ADM_ffMpeg4Encoder(ADM_coreVideoFilter *src) : ADM_coreVideoEncoderFFmpeg(src,&amp;Mp4Settings)
+ADM_ffMpeg4Encoder::ADM_ffMpeg4Encoder(ADM_coreVideoFilter *src,bool globalHeader) : ADM_coreVideoEncoderFFmpeg(src,&amp;Mp4Settings,globalHeader)
 {
     printf(&quot;[ffMpeg4Encoder] Creating.\n&quot;);
    

Modified: branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_videoEncoder/ffMpeg4/ADM_ffMpeg4.h
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_videoEncoder/ffMpeg4/ADM_ffMpeg4.h	2010-02-03 06:43:50 UTC (rev 5888)
+++ branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_videoEncoder/ffMpeg4/ADM_ffMpeg4.h	2010-02-04 06:42:04 UTC (rev 5889)
@@ -34,7 +34,7 @@
                
 public:
 
-                           ADM_ffMpeg4Encoder(ADM_coreVideoFilter *src);
+                           ADM_ffMpeg4Encoder(ADM_coreVideoFilter *src,bool globalHeader);
 virtual                    ~ADM_ffMpeg4Encoder();
 virtual        bool        setup(void); 
 virtual        bool        encode (ADMBitstream * out);

Modified: branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_videoEncoder/ffMsMpeg4/ADM_ffMsMp4.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_videoEncoder/ffMsMpeg4/ADM_ffMsMp4.cpp	2010-02-03 06:43:50 UTC (rev 5888)
+++ branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_videoEncoder/ffMsMpeg4/ADM_ffMsMp4.cpp	2010-02-04 06:42:04 UTC (rev 5889)
@@ -83,7 +83,7 @@
 /**
         \fn ADM_ffMsMp4Encoder
 */
-ADM_ffMsMp4Encoder::ADM_ffMsMp4Encoder(ADM_coreVideoFilter *src) : ADM_coreVideoEncoderFFmpeg(src,&amp;MsMp4Settings)
+ADM_ffMsMp4Encoder::ADM_ffMsMp4Encoder(ADM_coreVideoFilter *src,bool globalHeader) : ADM_coreVideoEncoderFFmpeg(src,&amp;MsMp4Settings)
 {
     printf(&quot;[ffMsMP4] Creating.\n&quot;);
    

Modified: branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_videoEncoder/ffMsMpeg4/ADM_ffMsMp4.h
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_videoEncoder/ffMsMpeg4/ADM_ffMsMp4.h	2010-02-03 06:43:50 UTC (rev 5888)
+++ branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_videoEncoder/ffMsMpeg4/ADM_ffMsMp4.h	2010-02-04 06:42:04 UTC (rev 5889)
@@ -34,7 +34,7 @@
                
 public:
 
-                           ADM_ffMsMp4Encoder(ADM_coreVideoFilter *src);
+                           ADM_ffMsMp4Encoder(ADM_coreVideoFilter *src,bool globalHeader);
 virtual                    ~ADM_ffMsMp4Encoder();
 virtual        bool        setup(void); 
 virtual        bool        encode (ADMBitstream * out);

Modified: branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_videoEncoder/huff/ADM_huffEncoder.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_videoEncoder/huff/ADM_huffEncoder.cpp	2010-02-03 06:43:50 UTC (rev 5888)
+++ branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_videoEncoder/huff/ADM_huffEncoder.cpp	2010-02-04 06:42:04 UTC (rev 5889)
@@ -30,7 +30,7 @@
 /**
         \fn ADM_huffEncoder
 */
-ADM_huffEncoder::ADM_huffEncoder(ADM_coreVideoFilter *src) : ADM_coreVideoEncoderFFmpeg(src)
+ADM_huffEncoder::ADM_huffEncoder(ADM_coreVideoFilter *src,bool globalHeader) : ADM_coreVideoEncoderFFmpeg(src)
 {
     printf(&quot;[huffEncoder] Creating.\n&quot;);
     if(huffType.encoderType==ADM_HUFF_YUV)

Modified: branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_videoEncoder/huff/ADM_huffEncoder.h
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_videoEncoder/huff/ADM_huffEncoder.h	2010-02-03 06:43:50 UTC (rev 5888)
+++ branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_videoEncoder/huff/ADM_huffEncoder.h	2010-02-04 06:42:04 UTC (rev 5889)
@@ -31,7 +31,7 @@
                int              plane;
 public:
 
-                           ADM_huffEncoder(ADM_coreVideoFilter *src);
+                           ADM_huffEncoder(ADM_coreVideoFilter *src,bool globalHeader);
                            ~ADM_huffEncoder();
 virtual        bool        setup(void); 
 virtual        bool        encode (ADMBitstream * out);

Modified: branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_videoEncoder/jpeg/ADM_jpegEncoder.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_videoEncoder/jpeg/ADM_jpegEncoder.cpp	2010-02-03 06:43:50 UTC (rev 5888)
+++ branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_videoEncoder/jpeg/ADM_jpegEncoder.cpp	2010-02-04 06:42:04 UTC (rev 5889)
@@ -23,7 +23,7 @@
 /**
         \fn ADM_jpegEncoder
 */
-ADM_jpegEncoder::ADM_jpegEncoder(ADM_coreVideoFilter *src) : ADM_coreVideoEncoderFFmpeg(src)
+ADM_jpegEncoder::ADM_jpegEncoder(ADM_coreVideoFilter *src,bool globalHeader) : ADM_coreVideoEncoderFFmpeg(src)
 {
     printf(&quot;[jpegEncoder] Creating.\n&quot;);
     targetColorSpace=(ADM_colorspace)jpegConf.colorSpace;

Modified: branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_videoEncoder/jpeg/ADM_jpegEncoder.h
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_videoEncoder/jpeg/ADM_jpegEncoder.h	2010-02-03 06:43:50 UTC (rev 5888)
+++ branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_videoEncoder/jpeg/ADM_jpegEncoder.h	2010-02-04 06:42:04 UTC (rev 5889)
@@ -31,7 +31,7 @@
                int              plane;
 public:
 
-                           ADM_jpegEncoder(ADM_coreVideoFilter *src);
+                           ADM_jpegEncoder(ADM_coreVideoFilter *src,bool globalHeader);
                            ~ADM_jpegEncoder();
 virtual        bool        setup(void); 
 virtual        bool        encode (ADMBitstream * out);

Modified: branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_videoEncoder/png/ADM_pngEncoder.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_videoEncoder/png/ADM_pngEncoder.cpp	2010-02-03 06:43:50 UTC (rev 5888)
+++ branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_videoEncoder/png/ADM_pngEncoder.cpp	2010-02-04 06:42:04 UTC (rev 5889)
@@ -21,7 +21,7 @@
 /**
         \fn ADM_pngEncoder
 */
-ADM_pngEncoder::ADM_pngEncoder(ADM_coreVideoFilter *src) : ADM_coreVideoEncoder(src)
+ADM_pngEncoder::ADM_pngEncoder(ADM_coreVideoFilter *src,bool globalHeader) : ADM_coreVideoEncoder(src)
 {
     printf(&quot;[YV12Encoder] Creating.\n&quot;);
     int w,h;
@@ -58,4 +58,4 @@
     return true;
 }
 
-// EOF
\ No newline at end of file
+// EOF

Modified: branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_videoEncoder/png/ADM_pngEncoder.h
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_videoEncoder/png/ADM_pngEncoder.h	2010-02-03 06:43:50 UTC (rev 5888)
+++ branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_videoEncoder/png/ADM_pngEncoder.h	2010-02-04 06:42:04 UTC (rev 5889)
@@ -31,11 +31,11 @@
                int plane;
 public:
 
-                            ADM_pngEncoder(ADM_coreVideoFilter *src);
+                            ADM_pngEncoder(ADM_coreVideoFilter *src,bool globalHeader);
                             ~ADM_pngEncoder();
 virtual        bool         encode (ADMBitstream * out);
 virtual const  char         *getFourcc(void) {return &quot;png &quot;;}
 };
 
 
-#endif
\ No newline at end of file
+#endif

Modified: branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_videoEncoder/yv12/ADM_yv12Encoder.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_videoEncoder/yv12/ADM_yv12Encoder.cpp	2010-02-03 06:43:50 UTC (rev 5888)
+++ branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_videoEncoder/yv12/ADM_yv12Encoder.cpp	2010-02-04 06:42:04 UTC (rev 5889)
@@ -21,7 +21,7 @@
 /**
         \fn ADM_yv12Encoder
 */
-ADM_yv12Encoder::ADM_yv12Encoder(ADM_coreVideoFilter *src) : ADM_coreVideoEncoder(src)
+ADM_yv12Encoder::ADM_yv12Encoder(ADM_coreVideoFilter *src,bool globalHeader) : ADM_coreVideoEncoder(src)
 {
     printf(&quot;[YV12Encoder] Creating.\n&quot;);
     int w,h;
@@ -58,4 +58,4 @@
     return true;
 }
 
-// EOF
\ No newline at end of file
+// EOF

Modified: branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_videoEncoder/yv12/ADM_yv12Encoder.h
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_videoEncoder/yv12/ADM_yv12Encoder.h	2010-02-03 06:43:50 UTC (rev 5888)
+++ branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_videoEncoder/yv12/ADM_yv12Encoder.h	2010-02-04 06:42:04 UTC (rev 5889)
@@ -31,11 +31,11 @@
                int plane;
 public:
 
-                            ADM_yv12Encoder(ADM_coreVideoFilter *src);
+                            ADM_yv12Encoder(ADM_coreVideoFilter *src,bool globalHeader);
                             ~ADM_yv12Encoder();
 virtual        bool         encode (ADMBitstream * out);
 virtual const  char         *getFourcc(void) {return &quot;YV12&quot;;}
 };
 
 
-#endif
\ No newline at end of file
+#endif


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="003093.html">[Avidemux-svn-commit] r5888 - in branches/avidemux_2.6_branch_mean:	avidemux/common/ADM_audioFilter/include	avidemux/common/ADM_audioFilter/src	avidemux_core/ADM_coreAudioFilter/include
</A></li>
	<LI>Next message: <A HREF="003095.html">[Avidemux-svn-commit] r5890 - in branches/avidemux_2.6_branch_mean:	avidemux_core/ADM_coreMuxer/src	avidemux_core/ADM_coreVideoEncoder/src	avidemux_plugins/ADM_audioEncoders/lavcodec
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#3094">[ date ]</a>
              <a href="thread.html#3094">[ thread ]</a>
              <a href="subject.html#3094">[ subject ]</a>
              <a href="author.html#3094">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/avidemux-svn-commit">More information about the Avidemux-svn-commit
mailing list</a><br>
</body></html>
