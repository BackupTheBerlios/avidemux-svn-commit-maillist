<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Avidemux-svn-commit] r5797 - in	branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder:	. ADM_vidEnc_avcodec ADM_vidEnc_x264 ADM_vidEnc_xvid common	common/pluginOptions
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/avidemux-svn-commit/2009-December/index.html" >
   <LINK REL="made" HREF="mailto:avidemux-svn-commit%40lists.berlios.de?Subject=Re%3A%20%5BAvidemux-svn-commit%5D%20r5797%20-%20in%0A%09branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder%3A%0A%09.%20ADM_vidEnc_avcodec%20ADM_vidEnc_x264%20ADM_vidEnc_xvid%20common%0A%09common/pluginOptions&In-Reply-To=%3C200912311408.nBVE83tN028751%40sheep.berlios.de%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="003003.html">
   <LINK REL="Next"  HREF="003005.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Avidemux-svn-commit] r5797 - in	branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder:	. ADM_vidEnc_avcodec ADM_vidEnc_x264 ADM_vidEnc_xvid common	common/pluginOptions</H1>
    <B>gruntster at mail.berlios.de</B> 
    <A HREF="mailto:avidemux-svn-commit%40lists.berlios.de?Subject=Re%3A%20%5BAvidemux-svn-commit%5D%20r5797%20-%20in%0A%09branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder%3A%0A%09.%20ADM_vidEnc_avcodec%20ADM_vidEnc_x264%20ADM_vidEnc_xvid%20common%0A%09common/pluginOptions&In-Reply-To=%3C200912311408.nBVE83tN028751%40sheep.berlios.de%3E"
       TITLE="[Avidemux-svn-commit] r5797 - in	branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder:	. ADM_vidEnc_avcodec ADM_vidEnc_x264 ADM_vidEnc_xvid common	common/pluginOptions">gruntster at mail.berlios.de
       </A><BR>
    <I>Thu Dec 31 15:08:03 CET 2009</I>
    <P><UL>
        <LI>Previous message: <A HREF="003003.html">[Avidemux-svn-commit] r5796 -	branches/avidemux_2.5_branch_gruntster/avidemux/ADM_encoder
</A></li>
        <LI>Next message: <A HREF="003005.html">[Avidemux-svn-commit] r5798 - in	branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder:	ADM_vidEnc_avcodec common
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#3004">[ date ]</a>
              <a href="thread.html#3004">[ thread ]</a>
              <a href="subject.html#3004">[ subject ]</a>
              <a href="author.html#3004">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Author: gruntster
Date: 2009-12-31 15:07:50 +0100 (Thu, 31 Dec 2009)
New Revision: 5797

Added:
   branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/common/CMakeLists.txt
   branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/common/pluginOptions/
   branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/common/pluginOptions/CMakeLists.txt
   branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/common/pluginOptions/PluginOptions.cpp
   branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/common/pluginOptions/PluginOptions.h
   branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/common/pluginOptions/PluginXmlOptions.cpp
   branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/common/pluginOptions/PluginXmlOptions.h
Removed:
   branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/common/PluginOptions.cpp
   branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/common/PluginOptions.h
   branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/common/PluginXmlOptions.cpp
   branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/common/PluginXmlOptions.h
Modified:
   branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_avcodec/CMakeLists.txt
   branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_avcodec/flv1EncoderOptions.cpp
   branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_avcodec/flv1EncoderOptions.h
   branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_avcodec/h263EncoderOptions.cpp
   branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_avcodec/h263EncoderOptions.h
   branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_avcodec/mjpegEncoderOptions.cpp
   branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_avcodec/mjpegEncoderOptions.h
   branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_avcodec/mpeg1EncoderOptions.cpp
   branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_avcodec/mpeg1EncoderOptions.h
   branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_avcodec/mpeg2EncoderOptions.cpp
   branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_avcodec/mpeg2EncoderOptions.h
   branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_avcodec/mpeg4aspEncoderOptions.cpp
   branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_avcodec/mpeg4aspEncoderOptions.h
   branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_x264/CMakeLists.txt
   branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_x264/x264Options.cpp
   branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_xvid/CMakeLists.txt
   branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_xvid/xvidOptions.cpp
   branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/CMakeLists.txt
Log:
[vidEnc] make plugin options helper a static library

Modified: branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_avcodec/CMakeLists.txt
===================================================================
--- branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_avcodec/CMakeLists.txt	2009-12-31 12:46:13 UTC (rev 5796)
+++ branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_avcodec/CMakeLists.txt	2009-12-31 14:07:50 UTC (rev 5797)
@@ -9,12 +9,11 @@
 endif (WIN32)
 
 SET(ADM_vidEnc_avcodec_SRCS  interface.c  encoder.cpp  huffyuvEncoder.cpp
-							 ffvhuffEncoder.cpp  ffv1Encoder.cpp  dvEncoder.cpp  ../common/PluginOptions.cpp
+							 ffvhuffEncoder.cpp  ffv1Encoder.cpp  dvEncoder.cpp
 							 mpeg1Encoder.cpp  mpeg1EncoderOptions.cpp  mpeg2Encoder.cpp  mpeg2EncoderOptions.cpp
 							 flv1Encoder.cpp  flv1EncoderOptions.cpp  mjpegEncoder.cpp  mjpegEncoderOptions.cpp
 							 h263Encoder.cpp  h263EncoderOptions.cpp  mpeg4aspEncoder.cpp  mpeg4aspEncoderOptions.cpp)
 
-set(PLUGIN_SCHEMA_DIR &quot;avcodec&quot;)
 set(MPEG1_PLUGIN_CONFIG_DIR &quot;avcodec/mpeg-1&quot;)
 set(MPEG2_PLUGIN_CONFIG_DIR &quot;avcodec/mpeg-2&quot;)
 set(FLV1_PLUGIN_CONFIG_DIR &quot;avcodec/flv1&quot;)
@@ -22,8 +21,8 @@
 set(H263_PLUGIN_CONFIG_DIR &quot;avcodec/h263&quot;)
 set(MPEG4ASP_PLUGIN_CONFIG_DIR &quot;avcodec/mpeg4asp&quot;)
 
-INCLUDE_DIRECTORIES(${CMAKE_CURRENT_BINARY_DIR} ${LIBXML2_INCLUDE_DIR})
-ADD_DEFINITIONS(${LIBXML2_DEFINITIONS} -DPLUGIN_SCHEMA_DIR=&quot;${PLUGIN_SCHEMA_DIR}&quot;)
+INCLUDE_DIRECTORIES(${CMAKE_CURRENT_BINARY_DIR} ${LIBXML2_INCLUDE_DIR} ../common/pluginOptions)
+ADD_DEFINITIONS(${LIBXML2_DEFINITIONS})
 set_property(SOURCE mpeg1EncoderOptions.cpp PROPERTY COMPILE_FLAGS -DMPEG1_PLUGIN_CONFIG_DIR=\\\&quot;${MPEG1_PLUGIN_CONFIG_DIR}\\\&quot;)
 set_property(SOURCE mpeg2EncoderOptions.cpp PROPERTY COMPILE_FLAGS -DMPEG2_PLUGIN_CONFIG_DIR=\\\&quot;${MPEG2_PLUGIN_CONFIG_DIR}\\\&quot;)
 set_property(SOURCE flv1EncoderOptions.cpp PROPERTY COMPILE_FLAGS -DFLV1_PLUGIN_CONFIG_DIR=\\\&quot;${FLV1_PLUGIN_CONFIG_DIR}\\\&quot;)
@@ -40,7 +39,7 @@
 add_subdirectory(xml)
 
 ADD_LIBRARY(ADM_vidEnc_avcodec SHARED ${ADM_vidEnc_avcodec_SRCS})
-TARGET_LINK_LIBRARIES(ADM_vidEnc_avcodec ${LIBXML2_LIBRARIES} ADM_xvidRateCtl ADM_core ADM_coreUI ADM_libavcodec)
+TARGET_LINK_LIBRARIES(ADM_vidEnc_avcodec ${LIBXML2_LIBRARIES} ADM_xvidRateCtl ADM_core ADM_coreUI ADM_libavcodec ADM_vidEnc_pluginOptions)
 
 INIT_VIDEO_ENCODER_PLUGIN(ADM_vidEnc_avcodec)
 INSTALL_VIDEO_ENCODER(ADM_vidEnc_avcodec)

Modified: branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_avcodec/flv1EncoderOptions.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_avcodec/flv1EncoderOptions.cpp	2009-12-31 12:46:13 UTC (rev 5796)
+++ branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_avcodec/flv1EncoderOptions.cpp	2009-12-31 14:07:50 UTC (rev 5797)
@@ -29,7 +29,7 @@
 
 #include &quot;flv1EncoderOptions.h&quot;
 
-FLV1EncoderOptions::FLV1EncoderOptions(void) : PluginOptions(FLV1_PLUGIN_CONFIG_DIR, &quot;Flv1&quot;, &quot;Flv1Param.xsd&quot;, FLV1_DEFAULT_ENCODE_MODE, FLV1_DEFAULT_ENCODE_MODE_PARAMETER)
+FLV1EncoderOptions::FLV1EncoderOptions(void) : PluginOptions(FLV1_PLUGIN_CONFIG_DIR, &quot;Flv1&quot;, &quot;avcodec/Flv1Param.xsd&quot;, FLV1_DEFAULT_ENCODE_MODE, FLV1_DEFAULT_ENCODE_MODE_PARAMETER)
 {
 	reset();
 }

Modified: branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_avcodec/flv1EncoderOptions.h
===================================================================
--- branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_avcodec/flv1EncoderOptions.h	2009-12-31 12:46:13 UTC (rev 5796)
+++ branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_avcodec/flv1EncoderOptions.h	2009-12-31 14:07:50 UTC (rev 5797)
@@ -18,7 +18,7 @@
 #define FLV1EncoderOptions_h
 
 #include &lt;vector&gt;
-#include &quot;../common/PluginOptions.h&quot;
+#include &quot;PluginOptions.h&quot;
 
 extern &quot;C&quot;
 {

Modified: branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_avcodec/h263EncoderOptions.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_avcodec/h263EncoderOptions.cpp	2009-12-31 12:46:13 UTC (rev 5796)
+++ branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_avcodec/h263EncoderOptions.cpp	2009-12-31 14:07:50 UTC (rev 5797)
@@ -31,7 +31,7 @@
 
 #include &quot;h263EncoderOptions.h&quot;
 
-H263EncoderOptions::H263EncoderOptions(void) : PluginOptions(H263_PLUGIN_CONFIG_DIR, &quot;H263&quot;, &quot;H263Param.xsd&quot;, H263_DEFAULT_ENCODE_MODE, H263_DEFAULT_ENCODE_MODE_PARAMETER)
+H263EncoderOptions::H263EncoderOptions(void) : PluginOptions(H263_PLUGIN_CONFIG_DIR, &quot;H263&quot;, &quot;avcodec/H263Param.xsd&quot;, H263_DEFAULT_ENCODE_MODE, H263_DEFAULT_ENCODE_MODE_PARAMETER)
 {
 	reset();
 }

Modified: branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_avcodec/h263EncoderOptions.h
===================================================================
--- branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_avcodec/h263EncoderOptions.h	2009-12-31 12:46:13 UTC (rev 5796)
+++ branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_avcodec/h263EncoderOptions.h	2009-12-31 14:07:50 UTC (rev 5797)
@@ -18,7 +18,7 @@
 #define h263EncoderOptions_h
 
 #include &lt;vector&gt;
-#include &quot;../common/PluginOptions.h&quot;
+#include &quot;PluginOptions.h&quot;
 
 extern &quot;C&quot;
 {

Modified: branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_avcodec/mjpegEncoderOptions.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_avcodec/mjpegEncoderOptions.cpp	2009-12-31 12:46:13 UTC (rev 5796)
+++ branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_avcodec/mjpegEncoderOptions.cpp	2009-12-31 14:07:50 UTC (rev 5797)
@@ -29,11 +29,11 @@
 
 #include &quot;mjpegEncoderOptions.h&quot;
 
-MjpegEncoderOptions::MjpegEncoderOptions(void) : PluginOptions(MJPEG_PLUGIN_CONFIG_DIR, &quot;Mjpeg&quot;, &quot;MjpegParam.xsd&quot;, MJPEG_DEFAULT_ENCODE_MODE, MJPEG_DEFAULT_ENCODE_MODE_PARAMETER) { }
+MjpegEncoderOptions::MjpegEncoderOptions(void) : PluginOptions(MJPEG_PLUGIN_CONFIG_DIR, &quot;Mjpeg&quot;, &quot;avcodec/MjpegParam.xsd&quot;, MJPEG_DEFAULT_ENCODE_MODE, MJPEG_DEFAULT_ENCODE_MODE_PARAMETER) { }
 
 void MjpegEncoderOptions::addOptionsToXml(xmlNodePtr xmlNodeRoot)
 { 
 	xmlNewChild(xmlNodeRoot, NULL, (xmlChar*)getOptionsTagRoot(), NULL);
 }
 
-void MjpegEncoderOptions::parseOptions(xmlNode *node) { }
\ No newline at end of file
+void MjpegEncoderOptions::parseOptions(xmlNode *node) { }

Modified: branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_avcodec/mjpegEncoderOptions.h
===================================================================
--- branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_avcodec/mjpegEncoderOptions.h	2009-12-31 12:46:13 UTC (rev 5796)
+++ branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_avcodec/mjpegEncoderOptions.h	2009-12-31 14:07:50 UTC (rev 5797)
@@ -18,7 +18,7 @@
 #define MjpegEncoderOptions_h
 
 #include &lt;vector&gt;
-#include &quot;../common/PluginOptions.h&quot;
+#include &quot;PluginOptions.h&quot;
 
 extern &quot;C&quot;
 {

Modified: branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_avcodec/mpeg1EncoderOptions.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_avcodec/mpeg1EncoderOptions.cpp	2009-12-31 12:46:13 UTC (rev 5796)
+++ branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_avcodec/mpeg1EncoderOptions.cpp	2009-12-31 14:07:50 UTC (rev 5797)
@@ -31,7 +31,7 @@
 
 #include &quot;mpeg1EncoderOptions.h&quot;
 
-Mpeg1EncoderOptions::Mpeg1EncoderOptions(void) : PluginOptions(MPEG1_PLUGIN_CONFIG_DIR, &quot;Mpeg1&quot;, &quot;Mpeg1Param.xsd&quot;, MPEG1_DEFAULT_ENCODE_MODE, MPEG1_DEFAULT_ENCODE_MODE_PARAMETER)
+Mpeg1EncoderOptions::Mpeg1EncoderOptions(void) : PluginOptions(MPEG1_PLUGIN_CONFIG_DIR, &quot;Mpeg1&quot;, &quot;avcodec/Mpeg1Param.xsd&quot;, MPEG1_DEFAULT_ENCODE_MODE, MPEG1_DEFAULT_ENCODE_MODE_PARAMETER)
 {
 	reset();
 }

Modified: branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_avcodec/mpeg1EncoderOptions.h
===================================================================
--- branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_avcodec/mpeg1EncoderOptions.h	2009-12-31 12:46:13 UTC (rev 5796)
+++ branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_avcodec/mpeg1EncoderOptions.h	2009-12-31 14:07:50 UTC (rev 5797)
@@ -18,7 +18,7 @@
 #define mpeg1EncoderOptions_h
 
 #include &lt;vector&gt;
-#include &quot;../common/PluginOptions.h&quot;
+#include &quot;PluginOptions.h&quot;
 
 extern &quot;C&quot;
 {

Modified: branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_avcodec/mpeg2EncoderOptions.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_avcodec/mpeg2EncoderOptions.cpp	2009-12-31 12:46:13 UTC (rev 5796)
+++ branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_avcodec/mpeg2EncoderOptions.cpp	2009-12-31 14:07:50 UTC (rev 5797)
@@ -31,7 +31,7 @@
 
 #include &quot;mpeg2EncoderOptions.h&quot;
 
-Mpeg2EncoderOptions::Mpeg2EncoderOptions(void) : PluginOptions(MPEG2_PLUGIN_CONFIG_DIR, &quot;Mpeg2&quot;, &quot;Mpeg2Param.xsd&quot;, MPEG2_DEFAULT_ENCODE_MODE, MPEG2_DEFAULT_ENCODE_MODE_PARAMETER)
+Mpeg2EncoderOptions::Mpeg2EncoderOptions(void) : PluginOptions(MPEG2_PLUGIN_CONFIG_DIR, &quot;Mpeg2&quot;, &quot;avcodec/Mpeg2Param.xsd&quot;, MPEG2_DEFAULT_ENCODE_MODE, MPEG2_DEFAULT_ENCODE_MODE_PARAMETER)
 {
 	reset();
 }

Modified: branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_avcodec/mpeg2EncoderOptions.h
===================================================================
--- branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_avcodec/mpeg2EncoderOptions.h	2009-12-31 12:46:13 UTC (rev 5796)
+++ branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_avcodec/mpeg2EncoderOptions.h	2009-12-31 14:07:50 UTC (rev 5797)
@@ -18,7 +18,7 @@
 #define mpeg2EncoderOptions_h
 
 #include &lt;vector&gt;
-#include &quot;../common/PluginOptions.h&quot;
+#include &quot;PluginOptions.h&quot;
 
 extern &quot;C&quot;
 {

Modified: branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_avcodec/mpeg4aspEncoderOptions.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_avcodec/mpeg4aspEncoderOptions.cpp	2009-12-31 12:46:13 UTC (rev 5796)
+++ branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_avcodec/mpeg4aspEncoderOptions.cpp	2009-12-31 14:07:50 UTC (rev 5797)
@@ -31,7 +31,7 @@
 
 #include &quot;mpeg4aspEncoderOptions.h&quot;
 
-Mpeg4aspEncoderOptions::Mpeg4aspEncoderOptions(void) : PluginOptions(MPEG4ASP_PLUGIN_CONFIG_DIR, &quot;Mpeg4asp&quot;, &quot;Mpeg4aspParam.xsd&quot;, MPEG4ASP_DEFAULT_ENCODE_MODE, MPEG4ASP_DEFAULT_ENCODE_MODE_PARAMETER)
+Mpeg4aspEncoderOptions::Mpeg4aspEncoderOptions(void) : PluginOptions(MPEG4ASP_PLUGIN_CONFIG_DIR, &quot;Mpeg4asp&quot;, &quot;avcodec/Mpeg4aspParam.xsd&quot;, MPEG4ASP_DEFAULT_ENCODE_MODE, MPEG4ASP_DEFAULT_ENCODE_MODE_PARAMETER)
 {
 	reset();
 }

Modified: branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_avcodec/mpeg4aspEncoderOptions.h
===================================================================
--- branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_avcodec/mpeg4aspEncoderOptions.h	2009-12-31 12:46:13 UTC (rev 5796)
+++ branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_avcodec/mpeg4aspEncoderOptions.h	2009-12-31 14:07:50 UTC (rev 5797)
@@ -18,7 +18,7 @@
 #define mpeg4aspEncoderOptions_h
 
 #include &lt;vector&gt;
-#include &quot;../common/PluginOptions.h&quot;
+#include &quot;PluginOptions.h&quot;
 
 extern &quot;C&quot;
 {

Modified: branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_x264/CMakeLists.txt
===================================================================
--- branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_x264/CMakeLists.txt	2009-12-31 12:46:13 UTC (rev 5796)
+++ branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_x264/CMakeLists.txt	2009-12-31 14:07:50 UTC (rev 5797)
@@ -11,13 +11,12 @@
 		SET(QT_PLUGIN_NAME &quot;ADM_vidEnc_x264_Qt&quot;)
 		SET(GTK_PLUGIN_NAME &quot;ADM_vidEnc_x264_Gtk&quot;)
 		
-		SET(PLUGIN_SCHEMA_DIR &quot;x264&quot;)
 		SET(PLUGIN_CONFIG_DIR &quot;x264&quot;)
 		
-		INCLUDE_DIRECTORIES(${CMAKE_CURRENT_BINARY_DIR} ${X264_INCLUDE_DIR} ${LIBXML2_INCLUDE_DIR} ../common)
-		ADD_DEFINITIONS(${LIBXML2_DEFINITIONS} -DPLUGIN_SCHEMA_DIR=&quot;${PLUGIN_SCHEMA_DIR}&quot; -DPLUGIN_CONFIG_DIR=&quot;${PLUGIN_CONFIG_DIR}&quot;)
+		INCLUDE_DIRECTORIES(${CMAKE_CURRENT_BINARY_DIR} ${X264_INCLUDE_DIR} ${LIBXML2_INCLUDE_DIR} ../common/pluginOptions)
+		ADD_DEFINITIONS(${LIBXML2_DEFINITIONS} -DPLUGIN_CONFIG_DIR=&quot;${PLUGIN_CONFIG_DIR}&quot;)
 		
-		SET(ADM_vidEnc_x264_SRCS interface.c configGuiLoader.cpp encoder.cpp guiHelper.cpp zoneOptions.cpp x264Options.cpp ../common/PluginOptions.cpp)
+		SET(ADM_vidEnc_x264_SRCS interface.c configGuiLoader.cpp encoder.cpp guiHelper.cpp zoneOptions.cpp x264Options.cpp)
 
 		CONFIGURE_FILE(&quot;${CMAKE_CURRENT_SOURCE_DIR}/config.h.cmake&quot; &quot;${CMAKE_CURRENT_BINARY_DIR}/config.h&quot;)
 
@@ -25,7 +24,7 @@
 		ADD_SUBDIRECTORY(qt4)
 		ADD_SUBDIRECTORY(xml)
 		ADD_LIBRARY(ADM_vidEnc_x264 SHARED ${ADM_vidEnc_x264_SRCS})
-		TARGET_LINK_LIBRARIES(ADM_vidEnc_x264 ADM_core ${X264_LIBRARY_DIR} ${LIBXML2_LIBRARIES})
+		TARGET_LINK_LIBRARIES(ADM_vidEnc_x264 ADM_core ${X264_LIBRARY_DIR} ${LIBXML2_LIBRARIES} ADM_vidEnc_pluginOptions)
 
 		INIT_VIDEO_ENCODER_PLUGIN(ADM_vidEnc_x264)
 		INSTALL_VIDEO_ENCODER(ADM_vidEnc_x264)

Modified: branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_x264/x264Options.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_x264/x264Options.cpp	2009-12-31 12:46:13 UTC (rev 5796)
+++ branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_x264/x264Options.cpp	2009-12-31 14:07:50 UTC (rev 5797)
@@ -32,7 +32,7 @@
 
 #include &quot;x264Options.h&quot;
 
-x264Options::x264Options(void) : PluginOptions(PLUGIN_CONFIG_DIR, &quot;x264&quot;, &quot;x264Param.xsd&quot;, DEFAULT_ENCODE_MODE, DEFAULT_ENCODE_MODE_PARAMETER)
+x264Options::x264Options(void) : PluginOptions(PLUGIN_CONFIG_DIR, &quot;x264&quot;, &quot;x264/x264Param.xsd&quot;, DEFAULT_ENCODE_MODE, DEFAULT_ENCODE_MODE_PARAMETER)
 {
 	memset(&amp;_param, 0, sizeof(x264_param_t));
 

Modified: branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_xvid/CMakeLists.txt
===================================================================
--- branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_xvid/CMakeLists.txt	2009-12-31 12:46:13 UTC (rev 5796)
+++ branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_xvid/CMakeLists.txt	2009-12-31 14:07:50 UTC (rev 5797)
@@ -10,20 +10,19 @@
 		SET(QT_PLUGIN_NAME &quot;ADM_vidEnc_Xvid_Qt&quot;)
 		SET(GTK_PLUGIN_NAME &quot;ADM_vidEnc_Xvid_Gtk&quot;)
 		
-		SET(PLUGIN_SCHEMA_DIR &quot;xvid&quot;)
 		SET(PLUGIN_CONFIG_DIR &quot;xvid&quot;)
 
-		INCLUDE_DIRECTORIES(${CMAKE_CURRENT_BINARY_DIR} ${XVID_INCLUDE_DIR} ${LIBXML2_INCLUDE_DIR} ../common)
-		ADD_DEFINITIONS(${LIBXML2_DEFINITIONS} -DPLUGIN_SCHEMA_DIR=&quot;${PLUGIN_SCHEMA_DIR}&quot; -DPLUGIN_CONFIG_DIR=&quot;${PLUGIN_CONFIG_DIR}&quot;)
+		INCLUDE_DIRECTORIES(${CMAKE_CURRENT_BINARY_DIR} ${XVID_INCLUDE_DIR} ${LIBXML2_INCLUDE_DIR} ../common/pluginOptions)
+		ADD_DEFINITIONS(${LIBXML2_DEFINITIONS} -DPLUGIN_CONFIG_DIR=&quot;${PLUGIN_CONFIG_DIR}&quot;)
 
-		SET(ADM_vidEnc_xvid_SRCS interface.c  encoder.cpp  xvidOptions.cpp  configGuiLoader.cpp  ../common/PluginOptions.cpp)
+		SET(ADM_vidEnc_xvid_SRCS interface.c  encoder.cpp  xvidOptions.cpp  configGuiLoader.cpp)
 
 		CONFIGURE_FILE(&quot;${CMAKE_CURRENT_SOURCE_DIR}/config.h.cmake&quot; &quot;${CMAKE_CURRENT_BINARY_DIR}/config.h&quot;)
 
 		ADD_SUBDIRECTORY(gtk)
 		ADD_SUBDIRECTORY(qt4)
 		ADD_LIBRARY(ADM_vidEnc_xvid SHARED ${ADM_vidEnc_xvid_SRCS})
-		TARGET_LINK_LIBRARIES(ADM_vidEnc_xvid ADM_core ${XVID_LIBRARY_DIR} ${LIBXML2_LIBRARIES})
+		TARGET_LINK_LIBRARIES(ADM_vidEnc_xvid ADM_core ${XVID_LIBRARY_DIR} ${LIBXML2_LIBRARIES} ADM_vidEnc_pluginOptions)
 
 		INIT_VIDEO_ENCODER_PLUGIN(ADM_vidEnc_xvid)
 		INSTALL_VIDEO_ENCODER(ADM_vidEnc_xvid)

Modified: branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_xvid/xvidOptions.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_xvid/xvidOptions.cpp	2009-12-31 12:46:13 UTC (rev 5796)
+++ branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_xvid/xvidOptions.cpp	2009-12-31 14:07:50 UTC (rev 5797)
@@ -30,7 +30,7 @@
 
 #include &quot;xvidOptions.h&quot;
 
-XvidOptions::XvidOptions(void) : PluginOptions(PLUGIN_CONFIG_DIR, &quot;Xvid&quot;, &quot;XvidParam.xsd&quot;, DEFAULT_ENCODE_MODE, DEFAULT_ENCODE_MODE_PARAMETER)
+XvidOptions::XvidOptions(void) : PluginOptions(PLUGIN_CONFIG_DIR, &quot;Xvid&quot;, &quot;xvid/XvidParam.xsd&quot;, DEFAULT_ENCODE_MODE, DEFAULT_ENCODE_MODE_PARAMETER)
 {
 	reset();
 }

Modified: branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/CMakeLists.txt
===================================================================
--- branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/CMakeLists.txt	2009-12-31 12:46:13 UTC (rev 5796)
+++ branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/CMakeLists.txt	2009-12-31 14:07:50 UTC (rev 5797)
@@ -1,3 +1,4 @@
+add_subdirectory(common)
 ADD_SUBDIRECTORY(ADM_vidEnc_avcodec)
 ADD_SUBDIRECTORY(ADM_vidEnc_x264)
 ADD_SUBDIRECTORY(ADM_vidEnc_xvid)
\ No newline at end of file

Added: branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/common/CMakeLists.txt
===================================================================
--- branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/common/CMakeLists.txt	2009-12-31 12:46:13 UTC (rev 5796)
+++ branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/common/CMakeLists.txt	2009-12-31 14:07:50 UTC (rev 5797)
@@ -0,0 +1 @@
+add_subdirectory(pluginOptions)

Deleted: branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/common/PluginOptions.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/common/PluginOptions.cpp	2009-12-31 12:46:13 UTC (rev 5796)
+++ branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/common/PluginOptions.cpp	2009-12-31 14:07:50 UTC (rev 5797)
@@ -1,405 +0,0 @@
- /***************************************************************************
-                              PluginOptions.cpp
-
-    begin                : Mon Apr 21 2008
-    copyright            : (C) 2008 by gruntster
- ***************************************************************************/
-
-/***************************************************************************
- *                                                                         *
- *   This program is free software; you can redistribute it and/or modify  *
- *   it under the terms of the GNU General Public License as published by  *
- *   the Free Software Foundation; either version 2 of the License, or     *
- *   (at your option) any later version.                                   *
- *                                                                         *
- ***************************************************************************/
-
-#include &lt;sstream&gt;
-#include &lt;string&gt;
-
-#include &quot;ADM_inttype.h&quot;
-#include &quot;ADM_files.h&quot;
-#include &quot;PluginXmlOptions.cpp&quot;
-#include &quot;PluginOptions.h&quot;
-
-#undef malloc
-#undef free
-#undef strdup
-PluginOptions::PluginOptions(const char* configurationDirectory, const char* tagPrefix, const char* schemaFile, 
-							 unsigned int defaultEncodeMode, int defaultEncodeModeParameter)
-{
-	_configurationDirectory = new char[strlen(configurationDirectory) + 1];
-	strcpy(_configurationDirectory, configurationDirectory);
-
-	_tagPrefix = new char[strlen(tagPrefix) + 1];
-	strcpy(_tagPrefix, tagPrefix);
-
-	_schemaFile = new char[strlen(schemaFile) + 1];
-	strcpy(_schemaFile, schemaFile);
-
-	_configTagRoot = new char[strlen(tagPrefix) + 7];
-	strcpy(_configTagRoot, tagPrefix);
-	strcat(_configTagRoot, &quot;Config&quot;);
-
-	_optionsTagRoot = new char[strlen(tagPrefix) + 8];
-	strcpy(_optionsTagRoot, tagPrefix);
-	strcat(_optionsTagRoot, &quot;Options&quot;);
-
-	_configurationName = NULL;
-	_defaultEncodeMode = defaultEncodeMode;
-	_defaultEncodeModeParameter = defaultEncodeModeParameter;
-	setEncodeOptionsToDefaults();
-
-	reset();
-}
-
-PluginOptions::~PluginOptions(void)
-{
-	cleanUp();
-
-	if (_configurationDirectory)
-	{
-		delete [] _configurationDirectory;
-		_configurationDirectory = NULL;
-	}
-
-	if (_tagPrefix)
-	{
-		delete [] _tagPrefix;
-		_tagPrefix = NULL;
-	}
-
-	if (_schemaFile)
-	{
-		delete [] _schemaFile;
-		_schemaFile = NULL;
-	}
-
-	if (_configTagRoot)
-	{
-		delete [] _configTagRoot;
-		_configTagRoot = NULL;
-	}
-
-	if (_optionsTagRoot)
-	{
-		delete [] _optionsTagRoot;
-		_optionsTagRoot = NULL;
-	}
-}
-
-void PluginOptions::cleanUp(void)
-{
-	if (_configurationName)
-	{
-		free(_configurationName);
-		_configurationName = NULL;
-	}
-}
-
-void PluginOptions::reset(void)
-{
-	cleanUp();
-
-	setPresetConfiguration(&quot;&lt;default&gt;&quot;, PLUGIN_CONFIG_DEFAULT);
-}
-
-const char* PluginOptions::getSchemaFile()
-{
-	return _schemaFile;
-}
-
-const char* PluginOptions::getConfigTagRoot()
-{
-	return _configTagRoot;
-}
-
-const char* PluginOptions::getOptionsTagRoot()
-{
-	return _optionsTagRoot;
-}
-
-void PluginOptions::getPresetConfiguration(char** configurationName, PluginConfigType *configurationType)
-{
-	if (_configurationName)
-	{
-		*configurationName = new char[strlen(_configurationName) + 1];
-		strcpy(*configurationName, _configurationName);
-	}
-	else
-		*configurationName = NULL;
-
-	*configurationType = _configurationType;
-}
-
-void PluginOptions::setPresetConfiguration(const char* configurationName, PluginConfigType configurationType)
-{
-	clearPresetConfiguration();
-
-	_configurationName = strdup(configurationName);
-	_configurationType = configurationType;
-}
-
-void PluginOptions::clearPresetConfiguration(void)
-{
-	if (_configurationName)
-		free(_configurationName);
-
-	_configurationName = strdup(&quot;&lt;custom&gt;&quot;);
-	_configurationType = PLUGIN_CONFIG_CUSTOM;
-}
-
-bool PluginOptions::loadPresetConfiguration(void)
-{
-	char *dir = NULL;
-	bool success = false;
-	PluginConfigType configurationType = _configurationType;
-	char configurationName[strlen(_configurationName) + 1];
-
-	strcpy(configurationName, _configurationName);
-
-	if (configurationType == PLUGIN_CONFIG_USER)
-		dir = getUserConfigDirectory();
-	else if (configurationType == PLUGIN_CONFIG_SYSTEM)
-		dir = getSystemConfigDirectory();
-
-	if (dir)
-	{
-		char presetConfigFile[strlen(dir) + strlen(configurationName) + 6];
-
-		strcpy(presetConfigFile, dir);
-		strcat(presetConfigFile, &quot;/&quot;);
-		strcat(presetConfigFile, configurationName);
-		strcat(presetConfigFile, &quot;.xml&quot;);
-
-		delete [] dir;
-		FILE *file = fopen(presetConfigFile, &quot;r&quot;);
-
-		if (file)
-		{
-			fseek(file, 0, SEEK_END);
-
-			long size = ftell(file);
-			char presetXml[size];
-
-			fseek(file, 0, SEEK_SET);
-			size = fread(presetXml, 1, size, file);
-			presetXml[size] = 0;
-			fclose(file);
-
-			success = fromXml(presetXml, PLUGIN_XML_EXTERNAL);
-			setPresetConfiguration(configurationName, configurationType);
-		}
-		else
-			printf(&quot;Error - Unable to open or read %s\n&quot;, presetConfigFile);
-	}
-
-	return success;
-}
-
-void PluginOptions::setEncodeOptionsToDefaults(void)
-{
-	_encodeOptions.encodeMode = _defaultEncodeMode;
-	_encodeOptions.encodeModeParameter = _defaultEncodeModeParameter;
-}
-
-vidEncOptions* PluginOptions::getEncodeOptions(void)
-{
-	vidEncOptions *encodeOptions = new vidEncOptions;
-
-	memcpy(encodeOptions, &amp;_encodeOptions, sizeof(vidEncOptions));
-
-	return encodeOptions;
-}
-
-void PluginOptions::setEncodeOptions(vidEncOptions* encodeOptions)
-{
-	memcpy(&amp;_encodeOptions, encodeOptions, sizeof(vidEncOptions));
-}
-
-char* PluginOptions::toXml(PluginXmlType xmlType)
-{
-	xmlDocPtr xmlDoc = xmlNewDoc((const xmlChar*)&quot;1.0&quot;);
-	xmlNodePtr xmlNodeRoot, xmlNodeChild;
-	const int bufferSize = 100;
-	xmlChar xmlBuffer[bufferSize + 1];
-	char *xml = NULL;
-
-	while (true)
-	{
-		if (!xmlDoc)
-			break;
-
-		if (!(xmlNodeRoot = xmlNewDocNode(xmlDoc, NULL, (xmlChar*)getConfigTagRoot(), NULL)))
-			break;
-
-		xmlDocSetRootElement(xmlDoc, xmlNodeRoot);
-
-		if (xmlType == PLUGIN_XML_INTERNAL)
-		{
-			if (_configurationType != PLUGIN_CONFIG_CUSTOM)
-			{
-				xmlNodeChild = xmlNewChild(xmlNodeRoot, NULL, (xmlChar*)&quot;presetConfiguration&quot;, NULL);
-
-				xmlNewChild(xmlNodeChild, NULL, (xmlChar*)&quot;name&quot;, (xmlChar*)_configurationName);
-
-				if (_configurationType == PLUGIN_CONFIG_USER)
-					strcpy((char*)xmlBuffer, &quot;user&quot;);
-				else if (_configurationType == PLUGIN_CONFIG_SYSTEM)
-					strcpy((char*)xmlBuffer, &quot;system&quot;);
-				else
-					strcpy((char*)xmlBuffer, &quot;default&quot;);
-
-				xmlNewChild(xmlNodeChild, NULL, (xmlChar*)&quot;type&quot;, xmlBuffer);
-			}
-		}
-		else
-		{
-			xmlNodeChild = xmlNewChild(xmlNodeRoot, NULL, (xmlChar*)&quot;encodeOptions&quot;, NULL);
-
-			switch (_encodeOptions.encodeMode)
-			{
-			case ADM_VIDENC_MODE_CBR:
-				strcpy((char*)xmlBuffer, &quot;CBR&quot;);
-				break;
-			case ADM_VIDENC_MODE_CQP:
-				strcpy((char*)xmlBuffer, &quot;CQP&quot;);
-				break;
-			case ADM_VIDENC_MODE_AQP:
-				strcpy((char*)xmlBuffer, &quot;AQP&quot;);
-				break;
-			case ADM_VIDENC_MODE_2PASS_SIZE:
-				strcpy((char*)xmlBuffer, &quot;2PASS SIZE&quot;);
-				break;
-			case ADM_VIDENC_MODE_2PASS_ABR:
-				strcpy((char*)xmlBuffer, &quot;2PASS ABR&quot;);
-				break;
-			}
-
-			xmlNewChild(xmlNodeChild, NULL, (xmlChar*)&quot;mode&quot;, xmlBuffer);
-			xmlNewChild(xmlNodeChild, NULL, (xmlChar*)&quot;parameter&quot;, number2String(xmlBuffer, bufferSize, _encodeOptions.encodeModeParameter));
-		}
-
-		addOptionsToXml(xmlNodeRoot);
-		xml = dumpXmlDocToMemory(xmlDoc);
-		xmlFreeDoc(xmlDoc);
-
-		break;
-	}
-
-	return xml;
-}
-
-int PluginOptions::fromXml(const char *xml, PluginXmlType xmlType)
-{
-	clearPresetConfiguration();
-
-	bool success = false;
-
-	xmlDocPtr doc = xmlReadMemory(xml, strlen(xml), &quot;options.xml&quot;, NULL, 0);
-
-	if (success = validateXml(doc, getSchemaFile()))
-	{
-		xmlNode *xmlNodeRoot = xmlDocGetRootElement(doc);
-
-		for (xmlNode *xmlChild = xmlNodeRoot-&gt;children; xmlChild; xmlChild = xmlChild-&gt;next)
-		{
-			if (xmlChild-&gt;type == XML_ELEMENT_NODE)
-			{
-				char *content = (char*)xmlNodeGetContent(xmlChild);
-
-				if (xmlType == PLUGIN_XML_EXTERNAL &amp;&amp; strcmp((char*)xmlChild-&gt;name, &quot;encodeOptions&quot;) == 0)
-					parseEncodeOptions(xmlChild, &amp;_encodeOptions);
-				else if (xmlType == PLUGIN_XML_INTERNAL &amp;&amp; strcmp((char*)xmlChild-&gt;name, &quot;presetConfiguration&quot;) == 0)
-					parsePresetConfiguration(xmlChild);
-				else if (strcmp((char*)xmlChild-&gt;name, getOptionsTagRoot()) == 0)
-					parseOptions(xmlChild);
-
-				xmlFree(content);
-			}
-		}
-	}
-
-	xmlFreeDoc(doc);
-
-	return success;
-}
-
-void PluginOptions::parseEncodeOptions(xmlNode *node, vidEncOptions *encodeOptions)
-{
-	for (xmlNode *xmlChild = node-&gt;children; xmlChild; xmlChild = xmlChild-&gt;next)
-	{
-		if (xmlChild-&gt;type == XML_ELEMENT_NODE)
-		{
-			char *content = (char*)xmlNodeGetContent(xmlChild);
-
-			if (strcmp((char*)xmlChild-&gt;name, &quot;mode&quot;) == 0)
-			{
-				if (strcmp(content, &quot;CBR&quot;) == 0)
-					encodeOptions-&gt;encodeMode = ADM_VIDENC_MODE_CBR;
-				else if (strcmp(content, &quot;CQP&quot;) == 0)
-					encodeOptions-&gt;encodeMode = ADM_VIDENC_MODE_CQP;
-				else if (strcmp(content, &quot;AQP&quot;) == 0)
-					encodeOptions-&gt;encodeMode = ADM_VIDENC_MODE_AQP;
-				else if (strcmp(content, &quot;2PASS SIZE&quot;) == 0)
-					encodeOptions-&gt;encodeMode = ADM_VIDENC_MODE_2PASS_SIZE;
-				else if (strcmp(content, &quot;2PASS ABR&quot;) == 0)
-					encodeOptions-&gt;encodeMode = ADM_VIDENC_MODE_2PASS_ABR;
-			}
-			else if (strcmp((char*)xmlChild-&gt;name, &quot;parameter&quot;) == 0)
-				encodeOptions-&gt;encodeModeParameter = atoi(content);
-
-			xmlFree(content);
-		}
-	}
-}
-
-void PluginOptions::parsePresetConfiguration(xmlNode *node)
-{
-	char* name = NULL;
-	PluginConfigType type = PLUGIN_CONFIG_CUSTOM;
-
-	for (xmlNode *xmlChild = node-&gt;children; xmlChild; xmlChild = xmlChild-&gt;next)
-	{
-		if (xmlChild-&gt;type == XML_ELEMENT_NODE)
-		{
-			char *content = (char*)xmlNodeGetContent(xmlChild);
-
-			if (strcmp((char*)xmlChild-&gt;name, &quot;name&quot;) == 0)
-				name = strdup((char*)content);
-			else if (strcmp((char*)xmlChild-&gt;name, &quot;type&quot;) == 0)
-			{
-				if (strcmp(content, &quot;user&quot;) == 0)
-					type = PLUGIN_CONFIG_USER;
-				else if (strcmp(content, &quot;system&quot;) == 0)
-					type = PLUGIN_CONFIG_SYSTEM;
-				else
-					type = PLUGIN_CONFIG_DEFAULT;
-			}
-
-			xmlFree(content);
-		}
-	}
-
-	setPresetConfiguration(name, type);
-	free(name);
-}
-
-char* PluginOptions::getUserConfigDirectory(void)
-{
-	return ADM_getHomeRelativePath(_configurationDirectory);
-}
-
-char* PluginOptions::getSystemConfigDirectory(void)
-{
-	char* pluginPath = ADM_getPluginPath();
-	char* systemConfigPath = new char[strlen(pluginPath) + strlen(_configurationDirectory) + 2];
-
-	strcpy(systemConfigPath, pluginPath);
-	strcat(systemConfigPath, &quot;/&quot;);
-	strcat(systemConfigPath, _configurationDirectory);
-
-	delete [] pluginPath;
-
-	return systemConfigPath;
-}

Deleted: branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/common/PluginOptions.h
===================================================================
--- branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/common/PluginOptions.h	2009-12-31 12:46:13 UTC (rev 5796)
+++ branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/common/PluginOptions.h	2009-12-31 14:07:50 UTC (rev 5797)
@@ -1,80 +0,0 @@
-/***************************************************************************
-                              PluginOptions.h
-
-    begin                : Mon Apr 21 2008
-    copyright            : (C) 2008 by gruntster
- ***************************************************************************/
-
-/***************************************************************************
- *                                                                         *
- *   This program is free software; you can redistribute it and/or modify  *
- *   it under the terms of the GNU General Public License as published by  *
- *   the Free Software Foundation; either version 2 of the License, or     *
- *   (at your option) any later version.                                   *
- *                                                                         *
- ***************************************************************************/
-
-#ifndef PluginOptions_h
-#define PluginOptions_h
-
-
-extern &quot;C&quot;
-{
-#include &quot;ADM_vidEnc_plugin.h&quot;
-}
-
-#include &quot;PluginXmlOptions.h&quot;
-
-typedef enum
-{
-	PLUGIN_CONFIG_CUSTOM,
-	PLUGIN_CONFIG_DEFAULT,
-	PLUGIN_CONFIG_USER,
-	PLUGIN_CONFIG_SYSTEM
-} PluginConfigType;
-
-class PluginOptions : public PluginXmlOptions
-{
-protected:
-	vidEncOptions _encodeOptions;
-	unsigned int _defaultEncodeMode;
-	int _defaultEncodeModeParameter;
-
-	char *_tagPrefix, *_configTagRoot, *_optionsTagRoot;
-	char *_configurationDirectory, *_schemaFile;
-	char *_configurationName;
-	PluginConfigType _configurationType;
-
-	virtual void cleanUp(void);
-	virtual void setEncodeOptionsToDefaults(void);
-	virtual void parseEncodeOptions(xmlNode *node, vidEncOptions *encodeOptions);
-	virtual void parsePresetConfiguration(xmlNode *node);
-
-public:
-	PluginOptions(const char* configurationDirectory, const char* tagPrefix, const char* schemaFile, unsigned int defaultEncodeMode, int defaultEncodeModeParameter);
-	~PluginOptions(void);
-
-	virtual vidEncOptions* getEncodeOptions(void);
-	virtual void setEncodeOptions(vidEncOptions* encodeOptions);
-
-	virtual void reset(void);
-	virtual const char* getSchemaFile();
-	virtual const char* getConfigTagRoot();
-	virtual const char* getOptionsTagRoot();
-
-	virtual void getPresetConfiguration(char** configurationName, PluginConfigType *configurationType);
-	virtual void setPresetConfiguration(const char* configurationName, PluginConfigType configurationType);
-	virtual void clearPresetConfiguration(void);
-	virtual bool loadPresetConfiguration(void);
-
-	virtual void addOptionsToXml(xmlNodePtr xmlNodeRoot) = 0;
-	virtual void parseOptions(xmlNode *node) = 0;
-
-	virtual char* toXml(PluginXmlType xmlType);
-	virtual int fromXml(const char *xml, PluginXmlType xmlType);
-
-	virtual char* getUserConfigDirectory(void);
-	virtual char* getSystemConfigDirectory(void);
-};
-
-#endif	// options_h

Deleted: branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/common/PluginXmlOptions.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/common/PluginXmlOptions.cpp	2009-12-31 12:46:13 UTC (rev 5796)
+++ branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/common/PluginXmlOptions.cpp	2009-12-31 14:07:50 UTC (rev 5797)
@@ -1,150 +0,0 @@
-/***************************************************************************
-                            PluginXmlOptions.cpp
-
-    begin                : Mon Apr 21 2008
-    copyright            : (C) 2008 by gruntster
- ***************************************************************************/
-
-/***************************************************************************
- *                                                                         *
- *   This program is free software; you can redistribute it and/or modify  *
- *   it under the terms of the GNU General Public License as published by  *
- *   the Free Software Foundation; either version 2 of the License, or     *
- *   (at your option) any later version.                                   *
- *                                                                         *
- ***************************************************************************/
-
-#include &lt;sstream&gt;
-#include &lt;libxml/parser.h&gt;
-#include &lt;libxml/xmlschemas.h&gt;
-
-#include &quot;PluginXmlOptions.h&quot;
-#include &quot;ADM_files.h&quot;
-
-xmlChar* PluginXmlOptions::number2String(xmlChar *buffer, size_t size, int number)
-{
-	std::ostringstream stream;
-
-	stream.imbue(std::locale::classic());
-	stream &lt;&lt; number;
-	std::string string = stream.str();
-
-	strncpy((char*)buffer, string.c_str(), size);
-
-	return buffer;
-}
-
-xmlChar* PluginXmlOptions::number2String(xmlChar *buffer, size_t size, unsigned int number)
-{
-	std::ostringstream stream;
-
-	stream.imbue(std::locale::classic());
-	stream &lt;&lt; number;
-	std::string string = stream.str();
-
-	strncpy((char*)buffer, string.c_str(), size);
-
-	return buffer;
-}
-
-xmlChar* PluginXmlOptions::number2String(xmlChar *buffer, size_t size, float number)
-{
-	std::ostringstream stream;
-
-	stream.imbue(std::locale::classic());
-	stream &lt;&lt; number;
-	std::string string = stream.str();
-
-	strncpy((char*)buffer, string.c_str(), size);
-
-	return buffer;
-}
-
-xmlChar* PluginXmlOptions::boolean2String(xmlChar *buffer, size_t size, bool boolean)
-{
-	if (boolean)
-		strncpy((char*)buffer, &quot;true&quot;, size);
-	else
-		strncpy((char*)buffer, &quot;false&quot;, size);
-
-	return buffer;
-}
-
-bool PluginXmlOptions::string2Boolean(const char *buffer)
-{
-	return (strcmp(buffer, &quot;true&quot;) == 0);
-}
-
-float PluginXmlOptions::string2Float(const char *buffer)
-{
-	std::istringstream stream(buffer);
-	float value;
-
-	stream &gt;&gt; value;
-
-	return value;
-}
-
-char* PluginXmlOptions::dumpXmlDocToMemory(xmlDocPtr xmlDoc)
-{
-	xmlChar *tempBuffer;
-	int tempBufferSize;
-	char *xml = NULL;
-
-	xmlDocDumpMemory(xmlDoc, &amp;tempBuffer, &amp;tempBufferSize);
-
-	// remove carriage returns (even though libxml was instructed not to format the XML)
-	xmlChar* bufferChar = tempBuffer;
-	int bufferCharIndex = 0;
-
-	while (*bufferChar != '\0')
-	{
-		if (*bufferChar == '\n')
-		{
-			memmove(bufferChar, bufferChar + 1, tempBufferSize - bufferCharIndex);
-			tempBufferSize--;
-		}
-		else if (*bufferChar == '\&quot;')
-			*bufferChar = '\'';
-
-		bufferChar++;
-		bufferCharIndex++;
-	}
-
-	xml = new char[tempBufferSize + 1];
-	memcpy(xml, tempBuffer, tempBufferSize);
-	xml[tempBufferSize] = 0;
-
-	return xml;
-}
-
-bool PluginXmlOptions::validateXml(xmlDocPtr doc, const char *schemaFile)
-{
-	char *pluginDir = ADM_getPluginPath();
-	char schemaPath[strlen(pluginDir) + strlen(PLUGIN_SCHEMA_DIR) + 1 + strlen(schemaFile) + 1];
-	bool success = false;
-
-	strcpy(schemaPath, pluginDir);
-	strcat(schemaPath, PLUGIN_SCHEMA_DIR);
-	strcat(schemaPath, &quot;/&quot;);
-	strcat(schemaPath, schemaFile);
-	delete [] pluginDir;
-
-	xmlSchemaParserCtxtPtr xmlSchemaParserCtxt = xmlSchemaNewParserCtxt(schemaPath);
-	xmlSchemaPtr xmlSchema = xmlSchemaParse(xmlSchemaParserCtxt);
-
- 	xmlSchemaFreeParserCtxt(xmlSchemaParserCtxt);
-
- 	xmlSchemaValidCtxtPtr xmlSchemaValidCtxt = xmlSchemaNewValidCtxt(xmlSchema);
-
- 	if (xmlSchemaValidCtxt)
-	{
- 		success = !xmlSchemaValidateDoc(xmlSchemaValidCtxt, doc);
-	 	xmlSchemaFree(xmlSchema);
-		xmlSchemaFreeValidCtxt(xmlSchemaValidCtxt);
- 	}
-	else
- 		xmlSchemaFree(xmlSchema);
-
-	return success;
-}

Deleted: branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/common/PluginXmlOptions.h
===================================================================
--- branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/common/PluginXmlOptions.h	2009-12-31 12:46:13 UTC (rev 5796)
+++ branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/common/PluginXmlOptions.h	2009-12-31 14:07:50 UTC (rev 5797)
@@ -1,46 +0,0 @@
-/***************************************************************************
-                             PluginXmlOptions.h
-
-    begin                : Mon Apr 21 2008
-    copyright            : (C) 2008 by gruntster
- ***************************************************************************/
-
-/***************************************************************************
- *                                                                         *
- *   This program is free software; you can redistribute it and/or modify  *
- *   it under the terms of the GNU General Public License as published by  *
- *   the Free Software Foundation; either version 2 of the License, or     *
- *   (at your option) any later version.                                   *
- *                                                                         *
- ***************************************************************************/
-
-#ifndef PluginXmlOptions_h
-#define PluginXmlOptions_h
-
-
-typedef enum
-{
-	PLUGIN_XML_INTERNAL,
-	PLUGIN_XML_EXTERNAL,
-} PluginXmlType;
-
-class PluginXmlOptions
-{
-protected:
-	xmlChar* number2String(xmlChar *buffer, size_t size, int number);
-	xmlChar* number2String(xmlChar *buffer, size_t size, unsigned int number);
-	xmlChar* number2String(xmlChar *buffer, size_t size, float number);
-	xmlChar* boolean2String(xmlChar *buffer, size_t size, bool boolean);
-	
-	bool string2Boolean(const char *buffer);
-	float string2Float(const char *buffer);
-
-	virtual char* dumpXmlDocToMemory(xmlDocPtr xmlDoc);
-	virtual bool validateXml(xmlDocPtr doc, const char* schemaFile);
-
-public:
-	virtual char* toXml(PluginXmlType xmlType) = 0;
-	virtual int fromXml(const char *xml, PluginXmlType xmlType) = 0;
-};
-
-#endif	// PluginXmlOptions_h

Added: branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/common/pluginOptions/CMakeLists.txt
===================================================================
--- branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/common/pluginOptions/CMakeLists.txt	2009-12-31 12:46:13 UTC (rev 5796)
+++ branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/common/pluginOptions/CMakeLists.txt	2009-12-31 14:07:50 UTC (rev 5797)
@@ -0,0 +1,10 @@
+include(admCheckLibxml2)
+
+set(ADM_vidEnc_pluginOptions_SRCS  PluginOptions.cpp  PluginXmlOptions.cpp)
+
+include_directories(&quot;${AVIDEMUX_SOURCE_DIR}/avidemux/ADM_core/include&quot;
+					&quot;${AVIDEMUX_SOURCE_DIR}/avidemux/ADM_coreUI/include&quot;
+					&quot;${AVIDEMUX_SOURCE_DIR}/avidemux/ADM_plugin&quot;)
+
+add_library(ADM_vidEnc_pluginOptions ${ADM_vidEnc_pluginOptions_SRCS})
+target_link_libraries(ADM_vidEnc_pluginOptions ${LIBXML2_LIBRARIES} ADM_core)
\ No newline at end of file

Copied: branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/common/pluginOptions/PluginOptions.cpp (from rev 5792, branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/common/PluginOptions.cpp)

Copied: branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/common/pluginOptions/PluginOptions.h (from rev 5792, branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/common/PluginOptions.h)

Copied: branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/common/pluginOptions/PluginXmlOptions.cpp (from rev 5792, branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/common/PluginXmlOptions.cpp)
===================================================================
--- branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/common/PluginXmlOptions.cpp	2009-12-31 00:28:35 UTC (rev 5792)
+++ branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/common/pluginOptions/PluginXmlOptions.cpp	2009-12-31 14:07:50 UTC (rev 5797)
@@ -0,0 +1,148 @@
+/***************************************************************************
+                            PluginXmlOptions.cpp
+
+    begin                : Mon Apr 21 2008
+    copyright            : (C) 2008 by gruntster
+ ***************************************************************************/
+
+/***************************************************************************
+ *                                                                         *
+ *   This program is free software; you can redistribute it and/or modify  *
+ *   it under the terms of the GNU General Public License as published by  *
+ *   the Free Software Foundation; either version 2 of the License, or     *
+ *   (at your option) any later version.                                   *
+ *                                                                         *
+ ***************************************************************************/
+
+#include &lt;sstream&gt;
+#include &lt;libxml/parser.h&gt;
+#include &lt;libxml/xmlschemas.h&gt;
+
+#include &quot;PluginXmlOptions.h&quot;
+#include &quot;ADM_files.h&quot;
+
+xmlChar* PluginXmlOptions::number2String(xmlChar *buffer, size_t size, int number)
+{
+	std::ostringstream stream;
+
+	stream.imbue(std::locale::classic());
+	stream &lt;&lt; number;
+	std::string string = stream.str();
+
+	strncpy((char*)buffer, string.c_str(), size);
+
+	return buffer;
+}
+
+xmlChar* PluginXmlOptions::number2String(xmlChar *buffer, size_t size, unsigned int number)
+{
+	std::ostringstream stream;
+
+	stream.imbue(std::locale::classic());
+	stream &lt;&lt; number;
+	std::string string = stream.str();
+
+	strncpy((char*)buffer, string.c_str(), size);
+
+	return buffer;
+}
+
+xmlChar* PluginXmlOptions::number2String(xmlChar *buffer, size_t size, float number)
+{
+	std::ostringstream stream;
+
+	stream.imbue(std::locale::classic());
+	stream &lt;&lt; number;
+	std::string string = stream.str();
+
+	strncpy((char*)buffer, string.c_str(), size);
+
+	return buffer;
+}
+
+xmlChar* PluginXmlOptions::boolean2String(xmlChar *buffer, size_t size, bool boolean)
+{
+	if (boolean)
+		strncpy((char*)buffer, &quot;true&quot;, size);
+	else
+		strncpy((char*)buffer, &quot;false&quot;, size);
+
+	return buffer;
+}
+
+bool PluginXmlOptions::string2Boolean(const char *buffer)
+{
+	return (strcmp(buffer, &quot;true&quot;) == 0);
+}
+
+float PluginXmlOptions::string2Float(const char *buffer)
+{
+	std::istringstream stream(buffer);
+	float value;
+
+	stream &gt;&gt; value;
+
+	return value;
+}
+
+char* PluginXmlOptions::dumpXmlDocToMemory(xmlDocPtr xmlDoc)
+{
+	xmlChar *tempBuffer;
+	int tempBufferSize;
+	char *xml = NULL;
+
+	xmlDocDumpMemory(xmlDoc, &amp;tempBuffer, &amp;tempBufferSize);
+
+	// remove carriage returns (even though libxml was instructed not to format the XML)
+	xmlChar* bufferChar = tempBuffer;
+	int bufferCharIndex = 0;
+
+	while (*bufferChar != '\0')
+	{
+		if (*bufferChar == '\n')
+		{
+			memmove(bufferChar, bufferChar + 1, tempBufferSize - bufferCharIndex);
+			tempBufferSize--;
+		}
+		else if (*bufferChar == '\&quot;')
+			*bufferChar = '\'';
+
+		bufferChar++;
+		bufferCharIndex++;
+	}
+
+	xml = new char[tempBufferSize + 1];
+	memcpy(xml, tempBuffer, tempBufferSize);
+	xml[tempBufferSize] = 0;
+
+	return xml;
+}
+
+bool PluginXmlOptions::validateXml(xmlDocPtr doc, const char *schemaFile)
+{
+	char *pluginDir = ADM_getPluginPath();
+	char schemaPath[strlen(pluginDir) + strlen(schemaFile) + 1];
+	bool success = false;
+
+	strcpy(schemaPath, pluginDir);
+		strcat(schemaPath, schemaFile);
+	delete [] pluginDir;
+
+	xmlSchemaParserCtxtPtr xmlSchemaParserCtxt = xmlSchemaNewParserCtxt(schemaPath);
+	xmlSchemaPtr xmlSchema = xmlSchemaParse(xmlSchemaParserCtxt);
+
+ 	xmlSchemaFreeParserCtxt(xmlSchemaParserCtxt);
+
+ 	xmlSchemaValidCtxtPtr xmlSchemaValidCtxt = xmlSchemaNewValidCtxt(xmlSchema);
+
+ 	if (xmlSchemaValidCtxt)
+	{
+ 		success = !xmlSchemaValidateDoc(xmlSchemaValidCtxt, doc);
+	 	xmlSchemaFree(xmlSchema);
+		xmlSchemaFreeValidCtxt(xmlSchemaValidCtxt);
+ 	}
+	else
+ 		xmlSchemaFree(xmlSchema);
+
+	return success;
+}

Copied: branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/common/pluginOptions/PluginXmlOptions.h (from rev 5792, branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/common/PluginXmlOptions.h)


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="003003.html">[Avidemux-svn-commit] r5796 -	branches/avidemux_2.5_branch_gruntster/avidemux/ADM_encoder
</A></li>
	<LI>Next message: <A HREF="003005.html">[Avidemux-svn-commit] r5798 - in	branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder:	ADM_vidEnc_avcodec common
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#3004">[ date ]</a>
              <a href="thread.html#3004">[ thread ]</a>
              <a href="subject.html#3004">[ subject ]</a>
              <a href="author.html#3004">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/avidemux-svn-commit">More information about the Avidemux-svn-commit
mailing list</a><br>
</body></html>
