<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Avidemux-svn-commit] r2827 - in	branches/avidemux_2.4_branch/avidemux: .	ADM_userInterfaces/ADM_GTK/ADM_dialog	ADM_userInterfaces/ADM_GTK/ADM_dialogFactory	ADM_userInterfaces/ADM_NONE/ADM_dialogFactory	ADM_userInterfaces/ADM_commonUI
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/avidemux-svn-commit/2007-February/index.html" >
   <LINK REL="made" HREF="mailto:avidemux-svn-commit%40lists.berlios.de?Subject=Re%3A%20%5BAvidemux-svn-commit%5D%20r2827%20-%20in%0A%09branches/avidemux_2.4_branch/avidemux%3A%20.%0A%09ADM_userInterfaces/ADM_GTK/ADM_dialog%0A%09ADM_userInterfaces/ADM_GTK/ADM_dialogFactory%0A%09ADM_userInterfaces/ADM_NONE/ADM_dialogFactory%0A%09ADM_userInterfaces/ADM_commonUI&In-Reply-To=%3C200702180919.l1I9J92h030393%40sheep.berlios.de%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000146.html">
   <LINK REL="Next"  HREF="000148.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Avidemux-svn-commit] r2827 - in	branches/avidemux_2.4_branch/avidemux: .	ADM_userInterfaces/ADM_GTK/ADM_dialog	ADM_userInterfaces/ADM_GTK/ADM_dialogFactory	ADM_userInterfaces/ADM_NONE/ADM_dialogFactory	ADM_userInterfaces/ADM_commonUI</H1>
    <B>mean at BerliOS</B> 
    <A HREF="mailto:avidemux-svn-commit%40lists.berlios.de?Subject=Re%3A%20%5BAvidemux-svn-commit%5D%20r2827%20-%20in%0A%09branches/avidemux_2.4_branch/avidemux%3A%20.%0A%09ADM_userInterfaces/ADM_GTK/ADM_dialog%0A%09ADM_userInterfaces/ADM_GTK/ADM_dialogFactory%0A%09ADM_userInterfaces/ADM_NONE/ADM_dialogFactory%0A%09ADM_userInterfaces/ADM_commonUI&In-Reply-To=%3C200702180919.l1I9J92h030393%40sheep.berlios.de%3E"
       TITLE="[Avidemux-svn-commit] r2827 - in	branches/avidemux_2.4_branch/avidemux: .	ADM_userInterfaces/ADM_GTK/ADM_dialog	ADM_userInterfaces/ADM_GTK/ADM_dialogFactory	ADM_userInterfaces/ADM_NONE/ADM_dialogFactory	ADM_userInterfaces/ADM_commonUI">mean at mail.berlios.de
       </A><BR>
    <I>Sun Feb 18 10:19:09 CET 2007</I>
    <P><UL>
        <LI>Previous message: <A HREF="000146.html">[Avidemux-svn-commit] r2826 -	branches/avidemux_2.4_branch/avidemux/ADM_video
</A></li>
        <LI>Next message: <A HREF="000148.html">[Avidemux-svn-commit] r2828 - in	branches/avidemux_2.4_branch/avidemux: .	ADM_libraries/ADM_xvidratectl ADM_userInterfaces/ADM_GTK/ADM_gui2
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#147">[ date ]</a>
              <a href="thread.html#147">[ thread ]</a>
              <a href="subject.html#147">[ subject ]</a>
              <a href="author.html#147">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Author: mean
Date: 2007-02-18 10:19:08 +0100 (Sun, 18 Feb 2007)
New Revision: 2827

Added:
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_bitrateHisto.cpp
Removed:
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_bitrateHisto.cpp
Modified:
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/Makefile.am
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialogFactory/FAC_bitrate.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialogFactory/Makefile.am
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_NONE/ADM_dialogFactory/FAC_toggle.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_factory.h
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/Makefile.am
   branches/avidemux_2.4_branch/avidemux/Makefile.am
Log:
histogram using dialogFactory

Deleted: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_bitrateHisto.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_bitrateHisto.cpp	2007-02-17 16:31:59 UTC (rev 2826)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_bitrateHisto.cpp	2007-02-18 09:19:08 UTC (rev 2827)
@@ -1,215 +0,0 @@
-/***************************************************************************
-                          ADM_guiBitrate  -  description
-                             -------------------
-
-	Simple bitrate analyzer
-
-    begin                : Mon Aug 31 2003
-    copyright            : (C) 2003 by mean
-    email                : <A HREF="https://lists.berlios.de/mailman/listinfo/avidemux-svn-commit">fixounet at free.fr</A>
- ***************************************************************************/
-
-/***************************************************************************
- *                                                                         *
- *   This program is free software; you can redistribute it and/or modify  *
- *   it under the terms of the GNU General Public License as published by  *
- *   the Free Software Foundation; either version 2 of the License, or     *
- *   (at your option) any later version.                                   *
- *                                                                         *
- ***************************************************************************/
-
-#include &quot;config.h&quot;
-
-#include &lt;stdio.h&gt;
-#include &lt;stdlib.h&gt;
-#include &lt;math.h&gt;
-
-
-#include &quot;ADM_toolkit_gtk/toolkit_gtk_include.h&quot;
-
-#include &quot;avi_vars.h&quot;
-#include &quot;ADM_toolkit_gtk/toolkit_gtk.h&quot;
-#include &quot;ADM_toolkit/toolkit.hxx&quot;
-#include &quot;ADM_toolkit_gtk/ADM_gladeSupport.h&quot;
-#include &quot;ADM_assert.h&quot;
-
-
-
-
-
-
-
-static GtkWidget	*create_dialog1 (uint32_t max, float *value);
-
-
-void GUI_displayBitrate( void )
-{
-
-  int32_t total,max;
- uint32_t len,idx,nb_frame,k,changed;
- uint32_t round,sum,average[60];;
-
- float f;
-
- float display[20];
-
-	// 1st compute the total
-	total=0;
-	max=0;
-	if(!(frameEnd&gt;frameStart))
-	{
-          GUI_Error_HIG(_(&quot;No data&quot;), NULL);
-		return ;
-	}
-
-	round=((avifileinfo-&gt;fps1000+990)/1000);
-	if(!round) return;
-
-	video_body-&gt;getFrameSize (frameStart, &amp;len);
-	for(k=0;k&lt;round;k++) average[k]=0;
-
-	sum=0;
-	changed=0;
-
-	// 1 st pass, compute max
-	for( k=frameStart;k&lt;frameEnd;k++)
-	{
- 		video_body-&gt;getFrameSize (k, &amp;len);
-		sum-=average[changed];
-		average[changed]=len;
-		sum+=average[changed];
-		//printf(&quot;Frame %lu Br: %lu\n&quot;,k,(sum*8)/1000);
-		if(sum&gt;max) max=sum;
-		changed++;
-		changed%=round;
-	}
-#define ROUNDUP 20000
-	max=(max+ROUNDUP -1)/ROUNDUP;
-	max=max*ROUNDUP;
-
-	printf(&quot;\n Total : %lu bytes, max %d bytes round %d\n&quot;,total,max,round);
-	if(!max)
-	{
-          GUI_Error_HIG(_(&quot;No data&quot;), NULL);
-		return ;
-	}
-	nb_frame=frameEnd-frameStart;
-	// and now build an histogram
-	for(k=0;k&lt;20;k++) display[k]=0;
-
-	video_body-&gt;getFrameSize (frameStart, &amp;len);
-	for(k=0;k&lt;round;k++) average[k]=0;
-
-	sum=0;
-	changed=0;
-
-
-	for(uint32_t k=frameStart;k&lt;frameEnd;k++)
-	{
-		video_body-&gt;getFrameSize (k, &amp;len);
-		// which case ?
-		sum-=average[changed];
-		average[changed]=len;
-		sum+=average[changed];
-		changed++;
-		changed%=round;
-
-		f=sum;
-		f=f/max;
-		f=f*20.;
-		idx=(uint32_t )floor(f+0.5);
-	//	printf(&quot;idx : %d\n&quot;,idx);
-		if(idx&gt;19) idx=19;
-		display[idx]++;
-	}
-
-
-	for(k=0;k&lt;20;k++) display[k]=(100*display[k])/nb_frame;
-	for(k=0;k&lt;20;k++)
-	{
-		printf(&quot; %d , %04d -- %04d percent -&gt; %02.1f\n&quot;,k,(max*k*8)/20000,(8*max*(k+1))/20000,display[k]);
-
-	}
-	GtkWidget *dialog=create_dialog1((max*8)/1000,display);
-	gtk_register_dialog(dialog);
-	gtk_dialog_run(GTK_DIALOG(dialog));
-	gtk_unregister_dialog(dialog);
-	gtk_widget_destroy(dialog);
-}
-
-
-GtkWidget	*create_dialog1 (uint32_t max, float *value)
-{
-  GtkWidget *dialog1;
-  GtkWidget *dialog_vbox1;
-  GtkWidget *table1;
-  GtkWidget *label1;
-  GtkWidget *label2;
-  GtkWidget *progressbar1;
-  GtkWidget *progressbar2;
-  GtkWidget *dialog_action_area1;
-  GtkWidget *okbutton1;
-
-  dialog1 = gtk_dialog_new ();
-  gtk_window_set_title (GTK_WINDOW (dialog1), &quot;Bitrate Histogram&quot;);
-
-  dialog_vbox1 = GTK_DIALOG (dialog1)-&gt;vbox;
-  gtk_widget_show (dialog_vbox1);
-
-  table1 = gtk_table_new (20, 2, FALSE);
-  gtk_widget_show (table1);
-  gtk_box_pack_start (GTK_BOX (dialog_vbox1), table1, TRUE, TRUE, 0);
-
-
-/*----*/
-	char string[200];
-	float p;
-
-	for(int j=0;j&lt;20;j++)
-	{
-
-		sprintf(string,&quot;%05d kbps :&quot;,(max*j)/20);
- 		label1 = gtk_label_new (string);
-  		gtk_widget_show (label1);
- 		gtk_table_attach (GTK_TABLE (table1), label1, 0, 1, 20-j-1, 20-j,
-                    (GtkAttachOptions) (GTK_FILL),
-                    (GtkAttachOptions) (0), 0, 0);
-  		gtk_label_set_justify (GTK_LABEL (label1), GTK_JUSTIFY_LEFT);
-  		gtk_misc_set_alignment (GTK_MISC (label1), 0, 0.5);
-
-		gtk_widget_set_usize(label1,100,-1);
-
-		progressbar1 = gtk_progress_bar_new ();
-  		gtk_widget_show (progressbar1);
-  		gtk_table_attach (GTK_TABLE (table1), progressbar1, 1, 2, 20-j-1, 20-j,
-                    (GtkAttachOptions) (GTK_FILL),
-                    (GtkAttachOptions) (0), 0, 0);
-
-			p=value[j];
-			p=p/100.;	
-       			gtk_progress_set_percentage(GTK_PROGRESS(progressbar1),(gfloat)p);
-
-	}
-
-  dialog_action_area1 = GTK_DIALOG (dialog1)-&gt;action_area;
-  gtk_widget_show (dialog_action_area1);
-  gtk_button_box_set_layout (GTK_BUTTON_BOX (dialog_action_area1), GTK_BUTTONBOX_END);
-
-  okbutton1 = gtk_button_new_from_stock (&quot;gtk-ok&quot;);
-  gtk_widget_show (okbutton1);
-  gtk_dialog_add_action_widget (GTK_DIALOG (dialog1), okbutton1, GTK_RESPONSE_OK);
-  GTK_WIDGET_SET_FLAGS (okbutton1, GTK_CAN_DEFAULT);
-
-  /* Store pointers to all widgets, for use by lookup_widget(). */
-  GLADE_HOOKUP_OBJECT_NO_REF (dialog1, dialog1, &quot;dialog1&quot;);
-  GLADE_HOOKUP_OBJECT_NO_REF (dialog1, dialog_vbox1, &quot;dialog_vbox1&quot;);
-  GLADE_HOOKUP_OBJECT (dialog1, table1, &quot;table1&quot;);
-  GLADE_HOOKUP_OBJECT_NO_REF (dialog1, dialog_action_area1, &quot;dialog_action_area1&quot;);
-  GLADE_HOOKUP_OBJECT (dialog1, okbutton1, &quot;okbutton1&quot;);
-
-  return dialog1;
-}
-
-
-
-// EOF

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/Makefile.am
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/Makefile.am	2007-02-17 16:31:59 UTC (rev 2826)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/Makefile.am	2007-02-18 09:19:08 UTC (rev 2827)
@@ -30,8 +30,7 @@
 	DIA_coloryuv.cpp \
 	DIA_quota.cpp \
 	DIA_animated.cpp \
-	DIA_partial.cpp \
-	DIA_bitrateHisto.cpp
+	DIA_partial.cpp 
 
 
 

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialogFactory/FAC_bitrate.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialogFactory/FAC_bitrate.cpp	2007-02-17 16:31:59 UTC (rev 2826)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialogFactory/FAC_bitrate.cpp	2007-02-18 09:19:08 UTC (rev 2827)
@@ -153,7 +153,7 @@
 #undef S
 #define P(x) 
 #define M(x,y)
-#define S(x)   x=gtk_spin_button_get_value  (GTK_SPIN_BUTTON(spin))
+#define S(x)   x=(uint32_t)gtk_spin_button_get_value  (GTK_SPIN_BUTTON(spin))
   switch(rank)
   {
     case 0: //CBR
@@ -197,6 +197,9 @@
   GtkSpinButton *spin=(GtkSpinButton*)w[3];
   GtkLabel *label=(GtkLabel*)w[1];
   int rank=gtk_combo_box_get_active(GTK_COMBO_BOX(combo));
+#undef P
+#undef M
+#undef S
 #define P(x) gtk_label_set_text(GTK_LABEL(label),_(#x));
 #define M(x,y) gtk_spin_button_set_range  (GTK_SPIN_BUTTON(spin),x,y)
 #define S(x)   gtk_spin_button_set_value  (GTK_SPIN_BUTTON(spin),x)

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialogFactory/Makefile.am
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialogFactory/Makefile.am	2007-02-17 16:31:59 UTC (rev 2826)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialogFactory/Makefile.am	2007-02-18 09:19:08 UTC (rev 2827)
@@ -9,6 +9,6 @@
 libADM_dialogFactory_a_METASOURCES = AUTO
 
 libADM_dialogFactory_a_SOURCES = DIA_dialogFactory.cpp FAC_toggle.cpp FAC_integer.cpp FAC_float.cpp FAC_menu.cpp \
-				DIA_filesel.cpp FAC_bitrate.cpp
+				DIA_filesel.cpp FAC_bitrate.cpp FAC_bar.cpp
 
 

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_NONE/ADM_dialogFactory/FAC_toggle.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_NONE/ADM_dialogFactory/FAC_toggle.cpp	2007-02-17 16:31:59 UTC (rev 2826)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_NONE/ADM_dialogFactory/FAC_toggle.cpp	2007-02-18 09:19:08 UTC (rev 2827)
@@ -101,7 +101,26 @@
 {
  
 }
+//******************************************************
 
+diaElemBar::diaElemBar(uint32_t percent,const char *toggleTitle)
+  : diaElem(ELEM_BAR)
+{
+}
+
+diaElemBar::~diaElemBar()
+{
+  
+}
+void diaElemBar::setMe(void *dialog, void *opaque,uint32_t line)
+{
+  
+}
+void diaElemBar::getMe(void)
+{
+ 
+}
+
 //******************************************************
 
 diaElemMenu::diaElemMenu(uint32_t *intValue,const char *itle, uint32_t nb, 

Copied: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_bitrateHisto.cpp (from rev 2818, branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_bitrateHisto.cpp)
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_bitrateHisto.cpp	2007-02-13 19:16:54 UTC (rev 2818)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_bitrateHisto.cpp	2007-02-18 09:19:08 UTC (rev 2827)
@@ -0,0 +1,170 @@
+/***************************************************************************
+                          ADM_guiBitrate  -  description
+                             -------------------
+
+	Simple bitrate analyzer
+
+    begin                : Mon Aug 31 2003
+    copyright            : (C) 2003 by mean
+    email                : <A HREF="https://lists.berlios.de/mailman/listinfo/avidemux-svn-commit">fixounet at free.fr</A>
+ ***************************************************************************/
+
+/***************************************************************************
+ *                                                                         *
+ *   This program is free software; you can redistribute it and/or modify  *
+ *   it under the terms of the GNU General Public License as published by  *
+ *   the Free Software Foundation; either version 2 of the License, or     *
+ *   (at your option) any later version.                                   *
+ *                                                                         *
+ ***************************************************************************/
+
+#include &quot;config.h&quot;
+
+#include &lt;stdio.h&gt;
+#include &lt;stdlib.h&gt;
+#include &lt;math.h&gt;
+
+#include &quot;default.h&quot;
+#include &quot;avi_vars.h&quot;
+#include &quot;ADM_toolkit/toolkit.hxx&quot;
+#include &quot;DIA_factory.h&quot;
+#include &quot;ADM_assert.h&quot;
+
+/**
+      \fn GUI_displayBitrate
+      \brief display a bargraph with bitrates
+*/
+
+void GUI_displayBitrate( void )
+{
+
+  int32_t total,max;
+ uint32_t len,idx,nb_frame,k,changed;
+ uint32_t round,sum,average[60];;
+
+ float f;
+
+ float display[20];
+uint32_t medium=0;
+
+	// 1st compute the total
+	
+	max=0;
+	if(!(frameEnd&gt;frameStart) || abs(frameStart-frameEnd)&lt;5)
+	{
+          GUI_Error_HIG(_(&quot;No data&quot;), NULL);
+		return ;
+	}
+
+	round=((avifileinfo-&gt;fps1000+990)/1000);
+	if(!round) return;
+
+	video_body-&gt;getFrameSize (frameStart, &amp;len);
+	for(k=0;k&lt;round;k++) average[k]=0;
+
+	sum=0;
+	changed=0;
+        total=0;
+	// 1 st pass, compute max
+	for( k=frameStart;k&lt;frameEnd;k++)
+	{
+ 		video_body-&gt;getFrameSize (k, &amp;len);
+                total+=len;
+		sum-=average[changed];
+		average[changed]=len;
+		sum+=average[changed];
+		//printf(&quot;Frame %lu Br: %lu\n&quot;,k,(sum*8)/1000);
+		if(sum&gt;max) max=sum;
+		changed++;
+		changed%=round;
+	}
+        
+        float g=total;
+        g/=(frameEnd-frameStart);
+        g*=avifileinfo-&gt;fps1000;
+        g/=(1000.*1000.);
+        medium=(uint32_t)(g*8);
+        printf(&quot;Average :%u max%u\n&quot;,medium,max);
+#if 0
+#define ROUNDUP 20*1000
+        uint32_t s;
+	s=(max+ROUNDUP -1)/ROUNDUP;
+	max=s*ROUNDUP;
+#endif
+
+	printf(&quot;\n Total : %lu bytes, max br %d bytes round %d\n&quot;,total,max,round);
+	if(!max)
+	{
+          GUI_Error_HIG(_(&quot;No data&quot;), NULL);
+		return ;
+	}
+	nb_frame=frameEnd-frameStart;
+	// and now build an histogram
+	for(k=0;k&lt;20;k++) display[k]=0;
+
+	video_body-&gt;getFrameSize (frameStart, &amp;len);
+	for(k=0;k&lt;round;k++) average[k]=0;
+
+	sum=0;
+	changed=0;
+        uint32_t step=(max*8)/20000;
+
+	for(uint32_t k=frameStart;k&lt;frameEnd;k++)
+	{
+		video_body-&gt;getFrameSize (k, &amp;len);
+		// which case ?
+                if(sum&gt;average[changed])
+		  sum-=average[changed];
+                else
+                   sum=0;
+		average[changed]=len;
+		sum+=average[changed];
+		changed++;
+		changed%=round;
+
+		f=sum;
+		f=f/max;
+		f=f*20.;
+		idx=(uint32_t )floor(f+0.5);
+	//	printf(&quot;idx : %d\n&quot;,idx);
+		if(idx&gt;19) idx=19;
+		display[idx]++;
+	}
+
+
+	for(k=0;k&lt;20;k++) display[k]=(100*display[k])/nb_frame;
+	for(k=0;k&lt;20;k++)
+	{
+		printf(&quot; %d , %04d -- %04d percent -&gt; %02.1f\n&quot;,k,(max*k*8)/20000,(8*max*(k+1))/20000,display[k]);
+
+	}
+        
+        diaElemBar *bar[20];
+        char str[256];
+        for(int i=0;i&lt;20;i++)
+        {
+          sprintf(str,&quot;%03u--%03u&quot;,step*i,step*(i+1));
+          bar[19-i]=new  diaElemBar((uint32_t)display[i],str);
+            
+        }
+        
+        diaElemUInteger med(&amp;medium,&quot;Average bitrate&quot;,0,9999999);
+        diaElemBar foo(0,&quot;foo&quot;);
+#define P(X) bar[X] 
+  
+      diaElem *elems[21]={
+            &amp;med,
+            P(0),P(1),P(2),P(3),P(4),P(5),P(6),P(7),P(8),P(9),
+            P(10),P(11),P(12),P(13),P(14),P(15),P(16),P(17),P(18),P(19)
+          };
+    
+        diaFactoryRun(_(&quot;Bitrate Histogram&quot;),21,elems);
+        
+        
+        for(int i=0;i&lt;20;i++)
+        {
+          delete bar[i];
+        }
+}
+
+

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_factory.h
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_factory.h	2007-02-17 16:31:59 UTC (rev 2826)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_factory.h	2007-02-18 09:19:08 UTC (rev 2827)
@@ -25,6 +25,7 @@
   ELEM_MENU,
   ELEM_FILE_READ,
   ELEM_BITRATE,
+  ELEM_BAR,
   ELEM_MAX=ELEM_TOGGLE
 };
 /*********************************************/
@@ -78,6 +79,18 @@
   void setMe(void *dialog, void *opaque,uint32_t line);
   void getMe(void);
 };
+/*************************************************/
+class diaElemBar : public diaElem
+{
+  protected :
+        uint32_t per;
+public:
+  
+  diaElemBar(uint32_t percent,const char *toggleTitle);
+  virtual ~diaElemBar() ;
+  void setMe(void *dialog, void *opaque,uint32_t line);
+  void getMe(void);
+};
 
 /*********************************************/
 #define ELEM_TYPE_FLOAT float
@@ -145,5 +158,5 @@
 };
 /*********************************************/
 uint8_t diaFactoryRun(const char *title,uint32_t nb,diaElem **elems);
-
+/*********************************************/
 #endif

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/Makefile.am
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/Makefile.am	2007-02-17 16:31:59 UTC (rev 2826)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/Makefile.am	2007-02-18 09:19:08 UTC (rev 2827)
@@ -2,7 +2,8 @@
 libADM_CommonUI_a_METASOURCES = AUTO
 libADM_CommonUI_a_SOURCES = GUI_sdlRender.cpp  GUI_xvRender.cpp  \
 DIA_resizeWiz.cpp DIA_builtin.cpp DIA_postproc.cpp DIA_enter.cpp \
-DIA_audioconfig.cpp GUI_render.cpp DIA_SVCD.cpp DIA_DVDff.cpp
+DIA_audioconfig.cpp GUI_render.cpp DIA_SVCD.cpp DIA_DVDff.cpp \
+DIA_bitrateHisto.cpp
 
 
 INCLUDES = $(all_includes) $(GTK_CFLAGS) $(XML_CFLAGS)  $(FREETYPE_CFLAGS) -DADM_SUBVERSION=@ADM_SUBVERSION@ \

Modified: branches/avidemux_2.4_branch/avidemux/Makefile.am
===================================================================
--- branches/avidemux_2.4_branch/avidemux/Makefile.am	2007-02-17 16:31:59 UTC (rev 2826)
+++ branches/avidemux_2.4_branch/avidemux/Makefile.am	2007-02-18 09:19:08 UTC (rev 2827)
@@ -27,6 +27,7 @@
 		./ADM_userInterfaces/ADM_GTK/ADM_dialog/libADM_dialog.a	\
 		./ADM_userInterfaces/ADM_GTK/ADM_dialogFactory/libADM_dialogFactory.a	\
 		./ADM_userInterfaces/ADM_commonUI/libADM_CommonUI.a	\
+		./ADM_userInterfaces/ADM_GTK/ADM_dialogFactory/libADM_dialogFactory.a	\
 		./ADM_userInterfaces/ADM_GTK/ADM_gui2/libADM_gui2.a	\
 		./ADM_userInterfaces/ADM_GTK/ADM_filters/libADM_filters.a \
 		./ADM_userInterfaces/ADM_GTK/ADM_toolkit_gtk/libADM_toolkit_gtk.a	


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000146.html">[Avidemux-svn-commit] r2826 -	branches/avidemux_2.4_branch/avidemux/ADM_video
</A></li>
	<LI>Next message: <A HREF="000148.html">[Avidemux-svn-commit] r2828 - in	branches/avidemux_2.4_branch/avidemux: .	ADM_libraries/ADM_xvidratectl ADM_userInterfaces/ADM_GTK/ADM_gui2
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#147">[ date ]</a>
              <a href="thread.html#147">[ thread ]</a>
              <a href="subject.html#147">[ subject ]</a>
              <a href="author.html#147">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/avidemux-svn-commit">More information about the Avidemux-svn-commit
mailing list</a><br>
</body></html>
