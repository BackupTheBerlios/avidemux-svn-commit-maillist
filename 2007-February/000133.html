<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Avidemux-svn-commit] r2808 - in branches/avidemux_2.4_branch:	autononreg/dialogFactory avidemux/ADM_script	avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialogFactory	avidemux/ADM_userInterfaces/ADM_NONE/ADM_dialogFactory	avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialogFactory	avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui	avidemux/ADM_userInterfaces/ADM_commonUI
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/avidemux-svn-commit/2007-February/index.html" >
   <LINK REL="made" HREF="mailto:avidemux-svn-commit%40lists.berlios.de?Subject=Re%3A%20%5BAvidemux-svn-commit%5D%20r2808%20-%20in%20branches/avidemux_2.4_branch%3A%0A%09autononreg/dialogFactory%20avidemux/ADM_script%0A%09avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialogFactory%0A%09avidemux/ADM_userInterfaces/ADM_NONE/ADM_dialogFactory%0A%09avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialogFactory%0A%09avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui%0A%09avidemux/ADM_userInterfaces/ADM_commonUI&In-Reply-To=%3C200702100937.l1A9bbpK025126%40sheep.berlios.de%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000132.html">
   <LINK REL="Next"  HREF="000134.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Avidemux-svn-commit] r2808 - in branches/avidemux_2.4_branch:	autononreg/dialogFactory avidemux/ADM_script	avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialogFactory	avidemux/ADM_userInterfaces/ADM_NONE/ADM_dialogFactory	avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialogFactory	avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui	avidemux/ADM_userInterfaces/ADM_commonUI</H1>
    <B>mean at BerliOS</B> 
    <A HREF="mailto:avidemux-svn-commit%40lists.berlios.de?Subject=Re%3A%20%5BAvidemux-svn-commit%5D%20r2808%20-%20in%20branches/avidemux_2.4_branch%3A%0A%09autononreg/dialogFactory%20avidemux/ADM_script%0A%09avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialogFactory%0A%09avidemux/ADM_userInterfaces/ADM_NONE/ADM_dialogFactory%0A%09avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialogFactory%0A%09avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui%0A%09avidemux/ADM_userInterfaces/ADM_commonUI&In-Reply-To=%3C200702100937.l1A9bbpK025126%40sheep.berlios.de%3E"
       TITLE="[Avidemux-svn-commit] r2808 - in branches/avidemux_2.4_branch:	autononreg/dialogFactory avidemux/ADM_script	avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialogFactory	avidemux/ADM_userInterfaces/ADM_NONE/ADM_dialogFactory	avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialogFactory	avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui	avidemux/ADM_userInterfaces/ADM_commonUI">mean at mail.berlios.de
       </A><BR>
    <I>Sat Feb 10 10:37:37 CET 2007</I>
    <P><UL>
        <LI>Previous message: <A HREF="000132.html">[Avidemux-svn-commit] r2807 - in	branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4:	ADM_dialogFactory ADM_filters
</A></li>
        <LI>Next message: <A HREF="000134.html">[Avidemux-svn-commit] r2809 - in	branches/avidemux_2.4_branch/avidemux:	ADM_userInterfaces/ADM_GTK/ADM_dialog	ADM_userInterfaces/ADM_NONE/ADM_dialog	ADM_userInterfaces/ADM_QT4/ADM_dialog ADM_video ADM_videoFilter
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#133">[ date ]</a>
              <a href="thread.html#133">[ thread ]</a>
              <a href="subject.html#133">[ subject ]</a>
              <a href="author.html#133">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Author: mean
Date: 2007-02-10 10:37:34 +0100 (Sat, 10 Feb 2007)
New Revision: 2808

Added:
   branches/avidemux_2.4_branch/autononreg/dialogFactory/fileread.js
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialogFactory/DIA_filesel.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialogFactory/FAC_filesel.cpp
Modified:
   branches/avidemux_2.4_branch/avidemux/ADM_script/ADM_JSFunctions.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialogFactory/Makefile.am
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_NONE/ADM_dialogFactory/FAC_toggle.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialogFactory/Makefile.am
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/translation_table.h
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_factory.h
Log:
add file+fileselector to dialogFactory widgets

Added: branches/avidemux_2.4_branch/autononreg/dialogFactory/fileread.js
===================================================================
--- branches/avidemux_2.4_branch/autononreg/dialogFactory/fileread.js	2007-02-08 19:36:13 UTC (rev 2807)
+++ branches/avidemux_2.4_branch/autononreg/dialogFactory/fileread.js	2007-02-10 09:37:34 UTC (rev 2808)
@@ -0,0 +1,10 @@
+//AD  &lt;- These first 4 characters need to be the first 4 characters to identify the ECMAScript file to Avidemux
+var app = new Avidemux();
+var file=&quot;/work/samples/2mn.avi&quot;;
+var goodfcc=&quot;DIV3&quot;;
+var fps;
+
+	dialogFactoryFileSel();
+
+/* End of test
+*/

Modified: branches/avidemux_2.4_branch/avidemux/ADM_script/ADM_JSFunctions.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_script/ADM_JSFunctions.cpp	2007-02-08 19:36:13 UTC (rev 2807)
+++ branches/avidemux_2.4_branch/avidemux/ADM_script/ADM_JSFunctions.cpp	2007-02-10 09:37:34 UTC (rev 2808)
@@ -71,6 +71,7 @@
 JSBool facFloat(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval);
 JSBool facToggle(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval);
 JSBool facMenu(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval);
+JSBool facFile(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval);
 
 
 static JSFunctionSpec adm_functions[] = {
@@ -92,6 +93,7 @@
   {&quot;dialogFactoryFloat&quot;,        facFloat,        0},
   {&quot;dialogFactoryToggle&quot;,       facToggle,        0},
   {&quot;dialogFactoryMenu&quot;,         facMenu,        0},
+  {&quot;dialogFactoryFileSel&quot;,      facFile,        0},
   {0}
 };
 
@@ -538,3 +540,20 @@
     *rval = BOOLEAN_TO_JSVAL(0);
   return JS_TRUE;
 }
+JSBool facFile(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval)
+{
+   uint32_t tog=0;
+   char *test=ADM_strdup(&quot;Entry test1&quot;);
+    
+      diaElemFileRead fread(&amp;test,&quot;Entry&quot;);
+      diaElem *elems[]={&amp;fread   };
+  if(diaFactoryRun(&quot;Test FileRead&quot;,1,elems))
+  {
+    *rval = BOOLEAN_TO_JSVAL(1);
+    printf(&quot;Value : &lt;%s&gt;\n&quot;,test);
+  }else
+    *rval = BOOLEAN_TO_JSVAL(0);
+  if(test) ADM_dealloc(test);
+  return JS_TRUE;
+}
+//EOF 

Added: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialogFactory/DIA_filesel.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialogFactory/DIA_filesel.cpp	2007-02-08 19:36:13 UTC (rev 2807)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialogFactory/DIA_filesel.cpp	2007-02-10 09:37:34 UTC (rev 2808)
@@ -0,0 +1,137 @@
+/***************************************************************************
+  FAC_float.cpp
+  Handle dialog factory element : Toggle
+  (C) 2006 Mean <A HREF="https://lists.berlios.de/mailman/listinfo/avidemux-svn-commit">Fixounet at free.fr</A> 
+***************************************************************************/
+
+/***************************************************************************
+ *                                                                         *
+ *   This program is free software; you can redistribute it and/or modify  *
+ *   it under the terms of the GNU General Public License as published by  *
+ *   the Free Software Foundation; either version 2 of the License, or     *
+ *   (at your option) any later version.                                   *
+ *                                                                         *
+ ***************************************************************************/
+
+#include &lt;config.h&gt;
+
+
+#include &lt;string.h&gt;
+#include &lt;stdio.h&gt;
+#include &lt;math.h&gt;
+
+#include &quot;default.h&quot;
+#include &quot;ADM_toolkit_gtk/ADM_gladeSupport.h&quot;
+#include &quot;ADM_toolkit_gtk/toolkit_gtk.h&quot;
+#include &quot;ADM_toolkit_gtk/toolkit_gtk_include.h&quot;
+#include &quot;ADM_commonUI/DIA_factory.h&quot;
+#include &quot;ADM_assert.h&quot;
+#include &quot;ADM_toolkit/filesel.h&quot;
+static void fileRead(void *w,void *p);
+
+
+diaElemFileRead::diaElemFileRead(char **filename,const char *toggleTitle,const char *tip)
+  : diaElem(ELEM_FILE_READ)
+{
+  param=(void *)filename;
+  paramTitle=toggleTitle;
+  this-&gt;tip=tip;
+}
+
+diaElemFileRead::~diaElemFileRead()
+{
+  
+}
+void diaElemFileRead::setMe(void *dialog, void *opaque,uint32_t line)
+{
+  GtkObject *adj;
+  GtkWidget *label;
+  GtkWidget *entry;
+  GtkWidget *hbox1;
+  GtkWidget *button;
+  
+  label = gtk_label_new_with_mnemonic (paramTitle);
+  gtk_misc_set_alignment (GTK_MISC (label), 0.0, 0.5);
+  gtk_widget_show(label);
+  
+  gtk_table_attach (GTK_TABLE (opaque), label, 0, 1, line, line+1,
+                    (GtkAttachOptions) (GTK_FILL),
+                    (GtkAttachOptions) (0), 0, 0);
+  
+  /**/
+  
+  hbox1 = gtk_hbox_new (FALSE, 2);
+  gtk_container_set_border_width (GTK_CONTAINER (hbox1), 6);
+  gtk_widget_show (hbox1);
+  
+  entry = gtk_entry_new ();
+  gtk_widget_show (entry);
+  if(param)
+  {
+      char **val=(char **)param;
+      gtk_entry_set_text (GTK_ENTRY (entry), *val);
+  }
+  gtk_label_set_mnemonic_widget (GTK_LABEL(label), entry);
+  
+  /* put entry in hbox */
+  gtk_box_pack_start (GTK_BOX (hbox1), entry, TRUE, TRUE, 0); /* expand fill padding */
+  
+  /*  add button */
+  
+  button = gtk_button_new_from_stock (&quot;gtk-open&quot;);
+  gtk_widget_show (button);
+  gtk_box_pack_start (GTK_BOX (hbox1), button, FALSE, FALSE, 0);
+
+  
+  /**/
+  gtk_table_attach (GTK_TABLE (opaque), hbox1, 1, 2, line, line+1,
+                    (GtkAttachOptions) (GTK_EXPAND | GTK_FILL),
+                    (GtkAttachOptions) (0), 0, 0);
+  
+  
+  /**/
+  
+  /* Add callback ...*/
+  g_signal_connect(GTK_OBJECT(button), &quot;clicked&quot;,
+                    GTK_SIGNAL_FUNC(fileRead),  this);
+
+  
+  myWidget=(void *)entry;
+  
+}
+void diaElemFileRead::getMe(void)
+{
+  GtkWidget *widget=(GtkWidget *)myWidget;
+  char **name=(char **)param;
+  if(*name) delete [] *name;
+  *name=NULL;
+  *name =ADM_strdup(gtk_entry_get_text (GTK_ENTRY (myWidget)));
+}
+
+void diaElemFileRead::changeFile(void)
+{
+#define MAX_SEL 200
+  char buffer[MAX_SEL+1];
+  
+  GtkWidget *widget=(GtkWidget *)myWidget;
+  const char *txt;
+  txt =gtk_entry_get_text (GTK_ENTRY (myWidget));
+  
+  if(FileSel_SelectRead(paramTitle,buffer,MAX_SEL,txt))
+  {
+    char **name=(char **)param;
+    if(*name) delete [] *name;
+    *name=NULL;
+    *name =ADM_strdup(buffer);
+     gtk_entry_set_text (GTK_ENTRY (myWidget), *name);
+  }
+  
+}
+
+void fileRead(void *w,void *p)
+{
+  diaElemFileRead *me=(diaElemFileRead *)p;
+  me-&gt;changeFile();
+}
+
+//EOF

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialogFactory/Makefile.am
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialogFactory/Makefile.am	2007-02-08 19:36:13 UTC (rev 2807)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialogFactory/Makefile.am	2007-02-10 09:37:34 UTC (rev 2808)
@@ -8,6 +8,7 @@
 
 libADM_dialogFactory_a_METASOURCES = AUTO
 
-libADM_dialogFactory_a_SOURCES = DIA_dialogFactory.cpp FAC_toggle.cpp FAC_integer.cpp FAC_float.cpp FAC_menu.cpp
+libADM_dialogFactory_a_SOURCES = DIA_dialogFactory.cpp FAC_toggle.cpp FAC_integer.cpp FAC_float.cpp FAC_menu.cpp \
+				DIA_filesel.cpp
 
 

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_NONE/ADM_dialogFactory/FAC_toggle.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_NONE/ADM_dialogFactory/FAC_toggle.cpp	2007-02-08 19:36:13 UTC (rev 2807)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_NONE/ADM_dialogFactory/FAC_toggle.cpp	2007-02-10 09:37:34 UTC (rev 2808)
@@ -123,6 +123,25 @@
  
 }
 
+diaElemFileRead::diaElemFileRead(char **filename,const char *toggleTitle,const char *tip)
+  : diaElem(ELEM_FILE_READ)
+{
+ 
+}
 
+diaElemFileRead::~diaElemFileRead()
+{
+  
+}
+void diaElemFileRead::setMe(void *dialog, void *opaque,uint32_t line)
+{
+ 
+  
+}
+void diaElemFileRead::getMe(void)
+{
+ 
+}
+
 //******************************************************
 //EOF

Added: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialogFactory/FAC_filesel.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialogFactory/FAC_filesel.cpp	2007-02-08 19:36:13 UTC (rev 2807)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialogFactory/FAC_filesel.cpp	2007-02-10 09:37:34 UTC (rev 2808)
@@ -0,0 +1,55 @@
+/***************************************************************************
+  FAC_toggle.cpp
+  Handle dialog factory element : Toggle
+  (C) 2006 Mean <A HREF="https://lists.berlios.de/mailman/listinfo/avidemux-svn-commit">Fixounet at free.fr</A> 
+***************************************************************************/
+
+/***************************************************************************
+ *                                                                         *
+ *   This program is free software; you can redistribute it and/or modify  *
+ *   it under the terms of the GNU General Public License as published by  *
+ *   the Free Software Foundation; either version 2 of the License, or     *
+ *   (at your option) any later version.                                   *
+ *                                                                         *
+ ***************************************************************************/
+
+#include &lt;config.h&gt;
+
+
+#include &lt;string.h&gt;
+#include &lt;stdio.h&gt;
+#include &lt;stdlib.h&gt;
+#include &lt;math.h&gt;
+
+#include &lt;QDialog&gt;
+#include &lt;QMessageBox&gt;
+#include &lt;QGridLayout&gt;
+#include &lt;QCheckBox&gt;
+
+#include &quot;default.h&quot;
+#include &quot;ADM_commonUI/DIA_factory.h&quot;
+#include &quot;ADM_assert.h&quot;
+
+
+diaElemFileRead::diaElemFileRead(char **filename,const char *toggleTitle,const char *tip)
+  : diaElem(ELEM_FILE_READ)
+{
+ 
+}
+
+diaElemFileRead::~diaElemFileRead()
+{
+  
+}
+void diaElemFileRead::setMe(void *dialog, void *opaque,uint32_t line)
+{
+ 
+  
+}
+void diaElemFileRead::getMe(void)
+{
+ 
+}
+
+//EOF
+

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialogFactory/Makefile.am
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialogFactory/Makefile.am	2007-02-08 19:36:13 UTC (rev 2807)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialogFactory/Makefile.am	2007-02-10 09:37:34 UTC (rev 2808)
@@ -3,7 +3,7 @@
 
 libADM_dialogFactory_a_METASOURCES = AUTO
 
-libADM_dialogFactory_a_SOURCES = AT_dialogFactory.cpp FAC_toggle.cpp FAC_integer.cpp FAC_menu.cpp FAC_float.cpp
+libADM_dialogFactory_a_SOURCES = AT_dialogFactory.cpp FAC_toggle.cpp FAC_integer.cpp FAC_menu.cpp FAC_float.cpp FAC_filesel.cpp
 
 
 INCLUDES = $(all_includes)  $(XML_CFLAGS)  $(FREETYPE_CFLAGS) -DADM_SUBVERSION=@ADM_SUBVERSION@ \

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/translation_table.h
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/translation_table.h	2007-02-08 19:36:13 UTC (rev 2807)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/translation_table.h	2007-02-10 09:37:34 UTC (rev 2808)
@@ -66,8 +66,8 @@
 
 
 #define LIST_OF_BUTTONS     \
-PROCESS(setMarkerA , ACT_MarkA  ) \
-PROCESS(setMarkerB ,ACT_MarkB )  \
+PROCESS(setMarkerA , ACT_GotoMarkA  ) \
+PROCESS(setMarkerB ,ACT_GotoMarkB )  \
 PROCESS(pushButtonVideoConf ,ACT_VideoConfigure )  \
 PROCESS(pushButtonVideoFilter , ACT_VideoParameter  ) \
 PROCESS(pushButtonAudioConf ,ACT_AudioCodec ) \

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_factory.h
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_factory.h	2007-02-08 19:36:13 UTC (rev 2807)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_factory.h	2007-02-10 09:37:34 UTC (rev 2808)
@@ -23,6 +23,7 @@
   ELEM_INTEGER,
   ELEM_FLOAT,
   ELEM_MENU,
+  ELEM_FILE_READ,
   ELEM_MAX=ELEM_TOGGLE
 };
 /*********************************************/
@@ -110,6 +111,18 @@
 };
 
 /*************************************************/
+class diaElemFileRead : public diaElem
+{
+
+public:
+  
+  diaElemFileRead(char **filename,const char *toggleTitle,const char *tip=NULL);
+  virtual ~diaElemFileRead() ;
+  void setMe(void *dialog, void *opaque,uint32_t line);
+  void getMe(void);
+  
+  void changeFile(void);
+};
 /*********************************************/
 uint8_t diaFactoryRun(const char *title,uint32_t nb,diaElem **elems);
 


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000132.html">[Avidemux-svn-commit] r2807 - in	branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4:	ADM_dialogFactory ADM_filters
</A></li>
	<LI>Next message: <A HREF="000134.html">[Avidemux-svn-commit] r2809 - in	branches/avidemux_2.4_branch/avidemux:	ADM_userInterfaces/ADM_GTK/ADM_dialog	ADM_userInterfaces/ADM_NONE/ADM_dialog	ADM_userInterfaces/ADM_QT4/ADM_dialog ADM_video ADM_videoFilter
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#133">[ date ]</a>
              <a href="thread.html#133">[ thread ]</a>
              <a href="subject.html#133">[ subject ]</a>
              <a href="author.html#133">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/avidemux-svn-commit">More information about the Avidemux-svn-commit
mailing list</a><br>
</body></html>
