<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Avidemux-svn-commit] r6182 - in branches/avidemux_2.6_branch_mean:	avidemux/common/ADM_editor avidemux/common/ADM_videoCodec/src	avidemux_core/ADM_coreImage/include avidemux_core/ADM_coreImage/src	avidemux_core/ADM_coreImageLoader/include	avidemux_core/ADM_coreImageLoader/src	avidemux_core/ADM_coreVideoCodec/src
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/avidemux-svn-commit/2010-May/index.html" >
   <LINK REL="made" HREF="mailto:avidemux-svn-commit%40lists.berlios.de?Subject=Re%3A%20%5BAvidemux-svn-commit%5D%20r6182%20-%20in%20branches/avidemux_2.6_branch_mean%3A%0A%09avidemux/common/ADM_editor%20avidemux/common/ADM_videoCodec/src%0A%09avidemux_core/ADM_coreImage/include%20avidemux_core/ADM_coreImage/src%0A%09avidemux_core/ADM_coreImageLoader/include%0A%09avidemux_core/ADM_coreImageLoader/src%0A%09avidemux_core/ADM_coreVideoCodec/src&In-Reply-To=%3C201005141534.o4EFYDHh026553%40sheep.berlios.de%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="003384.html">
   <LINK REL="Next"  HREF="003386.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Avidemux-svn-commit] r6182 - in branches/avidemux_2.6_branch_mean:	avidemux/common/ADM_editor avidemux/common/ADM_videoCodec/src	avidemux_core/ADM_coreImage/include avidemux_core/ADM_coreImage/src	avidemux_core/ADM_coreImageLoader/include	avidemux_core/ADM_coreImageLoader/src	avidemux_core/ADM_coreVideoCodec/src</H1>
    <B>mean at BerliOS</B> 
    <A HREF="mailto:avidemux-svn-commit%40lists.berlios.de?Subject=Re%3A%20%5BAvidemux-svn-commit%5D%20r6182%20-%20in%20branches/avidemux_2.6_branch_mean%3A%0A%09avidemux/common/ADM_editor%20avidemux/common/ADM_videoCodec/src%0A%09avidemux_core/ADM_coreImage/include%20avidemux_core/ADM_coreImage/src%0A%09avidemux_core/ADM_coreImageLoader/include%0A%09avidemux_core/ADM_coreImageLoader/src%0A%09avidemux_core/ADM_coreVideoCodec/src&In-Reply-To=%3C201005141534.o4EFYDHh026553%40sheep.berlios.de%3E"
       TITLE="[Avidemux-svn-commit] r6182 - in branches/avidemux_2.6_branch_mean:	avidemux/common/ADM_editor avidemux/common/ADM_videoCodec/src	avidemux_core/ADM_coreImage/include avidemux_core/ADM_coreImage/src	avidemux_core/ADM_coreImageLoader/include	avidemux_core/ADM_coreImageLoader/src	avidemux_core/ADM_coreVideoCodec/src">mean at mail.berlios.de
       </A><BR>
    <I>Fri May 14 17:34:13 CEST 2010</I>
    <P><UL>
        <LI>Previous message: <A HREF="003384.html">[Avidemux-svn-commit] r6181 -	branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_demuxers/Matroska
</A></li>
        <LI>Next message: <A HREF="003386.html">[Avidemux-svn-commit] r6183 - in branches/avidemux_2.6_branch_mean:	avidemux/common avidemux/common/ADM_editor	avidemux/common/ADM_render avidemux/common/ADM_videoCodec/src	avidemux/common/ADM_videoFilter2/src	avidemux_core/ADM_coreImage/include avidemux_core/ADM_coreImage/src	avidemux_core/ADM_coreImageLoader/src	avidemux_core/ADM_coreVideoCodec/include	avidemux_core/ADM_coreVideoCodec/src	avidemux_core/ADM_coreVideoEncoder/include	avidemux_core/ADM_coreVideoEncoder/src	avidemux_core/ADM_coreVideoFilter/include	avidemux_core/ADM_coreVideoFilter/src
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#3385">[ date ]</a>
              <a href="thread.html#3385">[ thread ]</a>
              <a href="subject.html#3385">[ subject ]</a>
              <a href="author.html#3385">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Author: mean
Date: 2010-05-14 17:34:12 +0200 (Fri, 14 May 2010)
New Revision: 6182

Modified:
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_editor/ADM_edRender.cpp
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_editor/ADM_edRenderInternal.cpp
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_videoCodec/src/ADM_ffmpeg_vdpau.cpp
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreImage/include/ADM_image.h
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreImage/src/ADM_image.cpp
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreImageLoader/include/ADM_imageLoader.h
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreImageLoader/src/ADM_imageLoader.cpp
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreVideoCodec/src/ADM_ffmp43.cpp
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreVideoCodec/src/ADM_png.cpp
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreVideoCodec/src/ADM_rgb16.cpp
Log:
[core] update ADMImage to be default, reference or vdpau

Modified: branches/avidemux_2.6_branch_mean/avidemux/common/ADM_editor/ADM_edRender.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/ADM_editor/ADM_edRender.cpp	2010-05-14 15:34:10 UTC (rev 6181)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/ADM_editor/ADM_edRender.cpp	2010-05-14 15:34:12 UTC (rev 6182)
@@ -486,7 +486,7 @@
                                                                  src-&gt;_colorspace,ADM_COLOR_YV12);
                         }
                         // Since it is not YV12 it MUST be a ref
-                        ADM_assert(src-&gt;_isRef);
+                        ADM_assert(src-&gt;isRef());
                         uint32_t strides[3]={src-&gt;_width,src-&gt;_width/2,src-&gt;_width/2};
                         uint8_t  *Planes[3]={YPLANE(dst),UPLANE(dst),VPLANE(dst)};
                         vid-&gt;color-&gt;convertPlanes(src-&gt;_planeStride,strides,src-&gt;_planes,Planes);

Modified: branches/avidemux_2.6_branch_mean/avidemux/common/ADM_editor/ADM_edRenderInternal.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/ADM_editor/ADM_edRenderInternal.cpp	2010-05-14 15:34:10 UTC (rev 6181)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/ADM_editor/ADM_edRenderInternal.cpp	2010-05-14 15:34:12 UTC (rev 6182)
@@ -290,7 +290,7 @@
                 }
                 if(!_scratch)
                 {
-                  _scratch=new ADMImage(_imageBuffer-&gt;_width,_imageBuffer-&gt;_height,1);
+                  _scratch=new ADMImage(_imageBuffer-&gt;_width,_imageBuffer-&gt;_height,ADM_IMAGE_REF);
                 }
                 tmpImage=_scratch;
                 ww=_imageBuffer-&gt;_width &amp; 0xfffff0;

Modified: branches/avidemux_2.6_branch_mean/avidemux/common/ADM_videoCodec/src/ADM_ffmpeg_vdpau.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/ADM_videoCodec/src/ADM_ffmpeg_vdpau.cpp	2010-05-14 15:34:10 UTC (rev 6181)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/ADM_videoCodec/src/ADM_ffmpeg_vdpau.cpp	2010-05-14 15:34:12 UTC (rev 6182)
@@ -244,7 +244,7 @@
             }
             VDPAU-&gt;freeQueue.push_back(VDPAU-&gt;renders[i]);
         }
-        scratch=new ADMImage(w,h,1);
+        scratch=new ADMImage(w,h,ADM_IMAGE_REF);
         b_age = ip_age[0] = ip_age[1] = 256*256*256*64;
 
 }

Modified: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreImage/include/ADM_image.h
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreImage/include/ADM_image.h	2010-05-14 15:34:10 UTC (rev 6181)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreImage/include/ADM_image.h	2010-05-14 15:34:12 UTC (rev 6182)
@@ -47,6 +47,14 @@
         PLANAR_V=3
         
 } ADM_PLANE;
+
+typedef enum
+{
+    ADM_IMAGE_DEFAULT,
+    ADM_IMAGE_REF,
+    ADM_IMAGE_VDPAU
+}ADM_IMAGE_TYPE;
+
 /**
     \class ADMImage
     \brief Stores image
@@ -68,10 +76,10 @@
         ADM_ASPECT	_aspect;	/// Aspect ratio
         uint32_t	flags;		/// Flags for this image (AVI_KEY_FRAME/AVI_B_FRAME)
         uint64_t    Pts;        /// Presentation time in us
-
+        uint64_t    *_cookie;   /// Used whith vdpau &amp; friends
 // This 3 fields are only used to convery container (reference to other datas)
 // Between codec &amp; editor
-        uint8_t         _isRef;         /// If True means the datas are just a link to data we don't own!
+        ADM_IMAGE_TYPE  _imageType;     /// Plain image or reference or vdpau wrapper
         ADM_colorspace  _colorspace;    /// Colorspace we are moving, default is YV12
         uint8_t         _noPicture;     /// No picture to display
 
@@ -120,8 +128,8 @@
         uint8_t         *_planes[3];     /// In case of linked data store y/u/v pointers
         uint32_t        _planeStride[3]; /// Same story
 
-                ADMImage(uint32_t width, uint32_t height);
-                ADMImage(uint32_t width, uint32_t height,uint32_t dummy); /// To create linked datas image        
+                ADMImage(uint32_t width, uint32_t height,ADM_IMAGE_TYPE type=ADM_IMAGE_DEFAULT);
+                
 
         uint8_t   LumaReduceBy2(void);
                 ~ADMImage();
@@ -136,7 +144,7 @@
         uint8_t duplicateFull(ADMImage *src);	/// copy an image to ourself, including info
         uint8_t copyInfo(ADMImage *src);	/// copy all the flags, not the data themselves
         uint8_t copyQuantInfo(ADMImage *src);	/// copy quant table if any
-        uint8_t isRef(void) { return _isRef;};
+        bool    isRef(void) { if(_imageType==ADM_IMAGE_REF) return true;return false;};
         uint8_t setLinkInfos(uint8_t *y,        /// To fill in infos for linked image
                         uint8_t *u,uint8_t *v,uint32_t stridey,
                         uint32_t strideu, uint32_t stridev);

Modified: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreImage/src/ADM_image.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreImage/src/ADM_image.cpp	2010-05-14 15:34:10 UTC (rev 6181)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreImage/src/ADM_image.cpp	2010-05-14 15:34:12 UTC (rev 6182)
@@ -55,31 +55,41 @@
         Pts=0;
 
 }
-ADMImage::ADMImage(uint32_t width, uint32_t height)
+/**
+    \fn ADMImage
+    \brief ctor
+*/
+ADMImage::ADMImage(uint32_t width, uint32_t height,ADM_IMAGE_TYPE type)
 {
         commonInit(width,height);
-        _isRef=0;
-        data=new uint8_t [ ((width+15)&amp;0xffffff0)*((height+15)&amp;0xfffffff0)*2];
-        ADM_assert(data);
-        imgCurMem+=(width*height*3)&gt;&gt;1;
-        if(imgCurMem&gt;imgMaxMem) imgMaxMem=imgCurMem;
-        if(imgCurNb&gt;imgMaxNb) imgMaxNb=imgCurNb;
-
-};
-// Create a fake image with external datas
-ADMImage::ADMImage(uint32_t width, uint32_t height,uint32_t dummy)
-{
-        commonInit(width,height);
-        _isRef=1;
+        _imageType=type;
         data=NULL;
+        _cookie=NULL;
+        _planes[0]=_planes[1]=_planes[2]=NULL;
+        switch(_imageType)
+        {
+            case ADM_IMAGE_DEFAULT:
+                data=new uint8_t [ ((width+15)&amp;0xffffff0)*((height+15)&amp;0xfffffff0)*2];
+                ADM_assert(data);
+                imgCurMem+=(width*height*3)&gt;&gt;1;
+                if(imgCurMem&gt;imgMaxMem) imgMaxMem=imgCurMem;
+                if(imgCurNb&gt;imgMaxNb) imgMaxNb=imgCurNb;
+                break;
+            case ADM_IMAGE_REF:
+                break;
+            case ADM_IMAGE_VDPAU:
+                break;
+            default:
+                ADM_assert(0);
 
+        }
 };
 //
 //	Deallocate
 //
 ADMImage::~ADMImage()
 {
-    if(!_isRef)
+    if(_imageType==ADM_IMAGE_DEFAULT)
     {
        if(quant) delete [] quant;
        quant=NULL;
@@ -100,7 +110,7 @@
         ADM_assert(src-&gt;_width==_width);
         ADM_assert(src-&gt;_height==_height);
 
-        ADM_assert(!_isRef); // could not duplicate to a linked data image
+        ADM_assert(_imageType==ADM_IMAGE_DEFAULT); // could not duplicate to a linked data image
 
         // cleanup if needed
         if(quant) delete [] quant;
@@ -110,7 +120,7 @@
         _qSize=0;
 
         copyInfo(src);
-        if(!src-&gt;_isRef)
+        if(src-&gt;_imageType==ADM_IMAGE_DEFAULT)
         {
                memcpy(YPLANE(this),YPLANE(src),_width*_height);
                 if(swap)
@@ -126,6 +136,7 @@
         }
         else
         {
+                if(src-&gt;_imageType!=ADM_IMAGE_REF) ADM_assert(0);
                 if(src-&gt;_noPicture)
                 {
                         // no pic available, blacken it
@@ -225,7 +236,7 @@
 
 
 	copyInfo(src);
-        ADM_assert(!_isRef);
+    ADM_assert(_imageType==ADM_IMAGE_DEFAULT);
 
 	memcpy(YPLANE(this),YPLANE(src),_width*_height);
 	memcpy(UPLANE(this),UPLANE(src),(_width*_height)&gt;&gt;2);

Modified: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreImageLoader/include/ADM_imageLoader.h
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreImageLoader/include/ADM_imageLoader.h	2010-05-14 15:34:10 UTC (rev 6181)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreImageLoader/include/ADM_imageLoader.h	2010-05-14 15:34:12 UTC (rev 6182)
@@ -8,14 +8,14 @@
 #include &quot;ADM_image.h&quot;
 typedef enum 
 {
-		ADM_IMAGE_UNKNOWN=0,
-        ADM_IMAGE_JPG=1,
-        ADM_IMAGE_PNG=2,
-        ADM_IMAGE_BMP=3,
-        ADM_IMAGE_BMP2=4
+		ADM_PICTURE_UNKNOWN=0,
+        ADM_PICTURE_JPG=1,
+        ADM_PICTURE_PNG=2,
+        ADM_PICTURE_BMP=3,
+        ADM_PICTURE_BMP2=4
         
-} ADM_IMAGE_TYPE;
+} ADM_PICTURE_TYPE;
 
 ADMImage *createImageFromFile(const char *filename);
-ADM_IMAGE_TYPE ADM_identidyImageFile(const char *filename,uint32_t *w,uint32_t *h);
+ADM_PICTURE_TYPE ADM_identifyImageFile(const char *filename,uint32_t *w,uint32_t *h);
 #endif

Modified: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreImageLoader/src/ADM_imageLoader.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreImageLoader/src/ADM_imageLoader.cpp	2010-05-14 15:34:10 UTC (rev 6181)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreImageLoader/src/ADM_imageLoader.cpp	2010-05-14 15:34:12 UTC (rev 6182)
@@ -59,18 +59,18 @@
 ADMImage *createImageFromFile(const char *filename)
 {
 	uint32_t w,h;
-	switch(ADM_identidyImageFile(filename,&amp;w,&amp;h))
+	switch(ADM_identifyImageFile(filename,&amp;w,&amp;h))
 	{
-		case  ADM_IMAGE_UNKNOWN: 
+		case  ADM_PICTURE_UNKNOWN: 
 					ADM_warning(&quot;[imageLoader] Trouble identifying /loading %s\n&quot;,filename);
 					return NULL;
-		case ADM_IMAGE_JPG:
+		case ADM_PICTURE_JPG:
 					return createImageFromFile_jpeg(filename);
 					break;
-		case ADM_IMAGE_PNG:
+		case ADM_PICTURE_PNG:
 					return createImageFromFile_png(filename);
 					break;
-		case ADM_IMAGE_BMP2:
+		case ADM_PICTURE_BMP2:
 					return createImageFromFile_Bmp2(filename);
 					break;
 		default:
@@ -148,7 +148,7 @@
 		    fclose(fd);
 		  //
 		    
-		    ADMImage tmpImage(w,h,1); // It is a reference image
+		    ADMImage tmpImage(w,h,ADM_IMAGE_REF); // It is a reference image
 		    // Now unpack it ...
             decoders *dec=ADM_coreCodecGetDecoder (fourCC::get((uint8_t *)&quot;MJPG&quot;),   w,   h, 0 , NULL,0);
             if(!dec)
@@ -328,7 +328,7 @@
  	   uint8_t *data=new uint8_t[size];
  	   fread(data,size,1,fd);
  	   fclose(fd);
- 	   ADMImage tmpImage(w,h,1);
+ 	   ADMImage tmpImage(w,h,ADM_IMAGE_REF);
     	// Decode PNG
         decoders *dec=ADM_coreCodecGetDecoder (fourCC::get((uint8_t *)&quot;PNG &quot;),   w,   h, 0 , NULL,0);
     	if(!dec)
@@ -354,7 +354,7 @@
  * 		\fn ADM_identidyImageFile
  * 		\brief Identidy image type, returns type and width/height
  */
-ADM_IMAGE_TYPE ADM_identidyImageFile(const char *filename,uint32_t *w,uint32_t *h)
+ADM_PICTURE_TYPE ADM_identifyImageFile(const char *filename,uint32_t *w,uint32_t *h)
 {
 			uint32_t *fcc;
 		    uint8_t fcc_tab[4];
@@ -368,7 +368,7 @@
 		    if (!fd) 
 		    {
 		    	printf(&quot;[imageIdentify] Cannot open that file!\n&quot;);
-		    	return ADM_IMAGE_UNKNOWN;
+		    	return ADM_PICTURE_UNKNOWN;
 		    }
 		    fread(fcc_tab, 4, 1, fd);
 		    fcc = (uint32_t *) fcc_tab;
@@ -403,15 +403,15 @@
 		    			    		{
 		    			    			ADM_warning(&quot;[imageIdentify]Offset too short!\n&quot;);
 		    			    		    fclose(fd);
-		    			    		    return ADM_IMAGE_UNKNOWN;
+		    			    		    return ADM_PICTURE_UNKNOWN;
 		    			    		}
 		    			    		fseek(fd, off - 2, SEEK_CUR);
 		    			    	}
 		    				count++;
 		    			    }
 		    			    fclose(fd);
-		    			    if(count&gt;=10) return ADM_IMAGE_UNKNOWN;
-		    			    return ADM_IMAGE_JPG;
+		    			    if(count&gt;=10) return ADM_PICTURE_UNKNOWN;
+		    			    return ADM_PICTURE_JPG;
 		    }
 		    // PNG ?
 		    if (fcc_tab[1] == 'P' &amp;&amp; fcc_tab[2] == 'N' &amp;&amp; fcc_tab[3] == 'G') 
@@ -424,7 +424,7 @@
 		     	    *w=read32(fd);
 		     	    *h=read32(fd);	
 		     	    fclose(fd);
-		     	    return ADM_IMAGE_PNG;
+		     	    return ADM_PICTURE_PNG;
 			    }
 		    // BMP2?
 		    if (fcc_tab[0] == 'B' &amp;&amp; fcc_tab[1] == 'M') 
@@ -442,15 +442,15 @@
 		     	    {
 		     	    	ADM_warning(&quot;[imageIdentify] BMP2:Cannot handle compressed bmp\n&quot;);
 		     	    	fclose(fd);
-		     	    	return ADM_IMAGE_UNKNOWN;
+		     	    	return ADM_PICTURE_UNKNOWN;
 		     	    }
 		     	    *w = bmph.biWidth;
 		     	    *h = bmph.biHeight;
 	     	    	fclose(fd);
-	     	    	return ADM_IMAGE_BMP2;
+	     	    	return ADM_PICTURE_BMP2;
 		    }
 		    // Unknown filetype...
 		    fclose(fd);
-		    return ADM_IMAGE_UNKNOWN;
+		    return ADM_PICTURE_UNKNOWN;
 }
 //EOF

Modified: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreVideoCodec/src/ADM_ffmp43.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreVideoCodec/src/ADM_ffmp43.cpp	2010-05-14 15:34:10 UTC (rev 6181)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreVideoCodec/src/ADM_ffmp43.cpp	2010-05-14 15:34:12 UTC (rev 6182)
@@ -69,7 +69,7 @@
 uint8_t decoderFF::clonePic (AVFrame * src, ADMImage * out)
 {
   uint32_t    u,v;
-  ADM_assert(out-&gt;_isRef);
+  ADM_assert(out-&gt;isRef());
   out-&gt;_planes[0] = (uint8_t *) src-&gt;data[0];
   out-&gt;_planeStride[0] = src-&gt;linesize[0];
   if (_swapUV)

Modified: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreVideoCodec/src/ADM_png.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreVideoCodec/src/ADM_png.cpp	2010-05-14 15:34:10 UTC (rev 6181)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreVideoCodec/src/ADM_png.cpp	2010-05-14 15:34:12 UTC (rev 6182)
@@ -145,7 +145,7 @@
       recalc ();
       goto gain2;
     }
-  ADM_assert (out-&gt;_isRef);
+  ADM_assert (out-&gt;isRef());
   out-&gt;_planes[0] = decoded;
   out-&gt;_planes[1] = NULL;
   out-&gt;_planes[2] = NULL;

Modified: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreVideoCodec/src/ADM_rgb16.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreVideoCodec/src/ADM_rgb16.cpp	2010-05-14 15:34:10 UTC (rev 6181)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreVideoCodec/src/ADM_rgb16.cpp	2010-05-14 15:34:12 UTC (rev 6182)
@@ -102,7 +102,7 @@
 		}
 	}
 
-	ADM_assert(out-&gt;_isRef);
+	ADM_assert(out-&gt;isRef());
 
 	out-&gt;flags = AVI_KEY_FRAME;
 	out-&gt;_colorspace = (ADM_colorspace)(colorspace | ADM_COLOR_BACKWARD);


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="003384.html">[Avidemux-svn-commit] r6181 -	branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_demuxers/Matroska
</A></li>
	<LI>Next message: <A HREF="003386.html">[Avidemux-svn-commit] r6183 - in branches/avidemux_2.6_branch_mean:	avidemux/common avidemux/common/ADM_editor	avidemux/common/ADM_render avidemux/common/ADM_videoCodec/src	avidemux/common/ADM_videoFilter2/src	avidemux_core/ADM_coreImage/include avidemux_core/ADM_coreImage/src	avidemux_core/ADM_coreImageLoader/src	avidemux_core/ADM_coreVideoCodec/include	avidemux_core/ADM_coreVideoCodec/src	avidemux_core/ADM_coreVideoEncoder/include	avidemux_core/ADM_coreVideoEncoder/src	avidemux_core/ADM_coreVideoFilter/include	avidemux_core/ADM_coreVideoFilter/src
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#3385">[ date ]</a>
              <a href="thread.html#3385">[ thread ]</a>
              <a href="subject.html#3385">[ subject ]</a>
              <a href="author.html#3385">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/avidemux-svn-commit">More information about the Avidemux-svn-commit
mailing list</a><br>
</body></html>
