<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Avidemux-svn-commit] r6237 -	branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/avidemux-svn-commit/2010-May/index.html" >
   <LINK REL="made" HREF="mailto:avidemux-svn-commit%40lists.berlios.de?Subject=Re%3A%20%5BAvidemux-svn-commit%5D%20r6237%20-%0A%09branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches&In-Reply-To=%3C201005260526.o4Q5QiZ4028960%40sheep.berlios.de%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="003432.html">
   <LINK REL="Next"  HREF="003434.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Avidemux-svn-commit] r6237 -	branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches</H1>
    <B>mean at BerliOS</B> 
    <A HREF="mailto:avidemux-svn-commit%40lists.berlios.de?Subject=Re%3A%20%5BAvidemux-svn-commit%5D%20r6237%20-%0A%09branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches&In-Reply-To=%3C201005260526.o4Q5QiZ4028960%40sheep.berlios.de%3E"
       TITLE="[Avidemux-svn-commit] r6237 -	branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches">mean at mail.berlios.de
       </A><BR>
    <I>Wed May 26 07:26:44 CEST 2010</I>
    <P><UL>
        <LI>Previous message: <A HREF="003432.html">[Avidemux-svn-commit] r6236 -	branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavcodec
</A></li>
        <LI>Next message: <A HREF="003434.html">[Avidemux-svn-commit] r6238 - in	branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libswscale:	. x86
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#3433">[ date ]</a>
              <a href="thread.html#3433">[ thread ]</a>
              <a href="subject.html#3433">[ subject ]</a>
              <a href="author.html#3433">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Author: mean
Date: 2010-05-26 07:26:42 +0200 (Wed, 26 May 2010)
New Revision: 6237

Added:
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavcodec_fft.c.patch
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavcodec_pngdec.c.patch
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavcodec_pngenc.c.patch
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavcodec_x86_mathops.h
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavformat_utils.c.patch
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavutil_bswap.h.patch
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavutil_intreadwrite.h.patch
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavutil_libm.h.patch
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavutil_timer.h.patch
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavutil_x86_bswap.h
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavutil_x86_intreadwrite.h
Removed:
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/bswap_h.patch
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/internal_h.patch
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/intreadwrite_h.patch
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavutil_lfg.patch
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/timer_h.patch
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/x86_bswap_h.patch
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/x86_mathops_h.patch
Modified:
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavcodec_avcodec.h.patch
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavcodec_ffv1.c.patch
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavcodec_h263dec.c.patch
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavcodec_h264.c.patch
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavcodec_mpeg12.c.patch
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavcodec_mpeg12enc.c.patch
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavcodec_mpegvideo.c.patch
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavcodec_mpegvideo_enc.c.patch
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavcodec_png.patch
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavcodec_utils.c.patch
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavutil_avutil.h.patch
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavutil_internal.h.patch
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavutil_mem.c.patch
Log:
[libavcodec/libavutil/libavformat] Patches

Deleted: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/bswap_h.patch
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/bswap_h.patch	2010-05-26 05:26:39 UTC (rev 6236)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/bswap_h.patch	2010-05-26 05:26:42 UTC (rev 6237)
@@ -1,17 +0,0 @@
-diff --git a/avidemux/ADM_libraries/ADM_ffmpeg/libavutil/bswap.h b/avidemux/ADM_libraries/ADM_ffmpeg/libavutil/bswap.h
-index cf68c43..9b299a6 100644
---- libavutil/bswap.h
-+++ libavutil/bswap.h
-@@ -27,7 +27,12 @@
- #define AVUTIL_BSWAP_H
- 
- #include &lt;stdint.h&gt;
-+// MEANX
-+#ifndef ADM_NO_CONFIG_H
- #include &quot;config.h&quot;
-+#endif
-+// MEANX
-+
- #include &quot;common.h&quot;
- 
- #if   ARCH_ARM

Deleted: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/internal_h.patch
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/internal_h.patch	2010-05-26 05:26:39 UTC (rev 6236)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/internal_h.patch	2010-05-26 05:26:42 UTC (rev 6237)
@@ -1,16 +0,0 @@
-diff --git a/avidemux/ADM_libraries/ADM_ffmpeg/libavutil/internal.h b/avidemux/ADM_libraries/ADM_ffmpeg/libavutil/internal.h
-index 7a38fb1..bf845f8 100644
---- libavutil/internal.h
-+++ libavutil/internal.h
-@@ -34,7 +34,11 @@
- #include &lt;stdint.h&gt;
- #include &lt;stddef.h&gt;
- #include &lt;assert.h&gt;
-+// MEANX
-+#ifndef ADM_NO_CONFIG_H
- #include &quot;config.h&quot;
-+#endif
-+// MEANX
- #include &quot;common.h&quot;
- #include &quot;mem.h&quot;
- #include &quot;timer.h&quot;

Deleted: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/intreadwrite_h.patch
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/intreadwrite_h.patch	2010-05-26 05:26:39 UTC (rev 6236)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/intreadwrite_h.patch	2010-05-26 05:26:42 UTC (rev 6237)
@@ -1,17 +0,0 @@
-diff --git a/avidemux/ADM_libraries/ADM_ffmpeg/libavutil/intreadwrite.h b/avidemux/ADM_libraries/ADM_ffmpeg/libavutil/intreadwrite.h
-index 5e55327..2c5c68d 100644
---- libavutil/intreadwrite.h
-+++ libavutil/intreadwrite.h
-@@ -20,7 +20,12 @@
- #define AVUTIL_INTREADWRITE_H
- 
- #include &lt;stdint.h&gt;
-+// MEANX
-+#ifndef ADM_NO_CONFIG_H
- #include &quot;config.h&quot;
-+#endif
-+// MEANX
-+
- #include &quot;bswap.h&quot;
- 
- /*

Modified: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavcodec_avcodec.h.patch
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavcodec_avcodec.h.patch	2010-05-26 05:26:39 UTC (rev 6236)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavcodec_avcodec.h.patch	2010-05-26 05:26:42 UTC (rev 6237)
@@ -1,34 +1,30 @@
-*** libavcodec/avcodec.h.old	Wed Apr  1 18:35:35 2009
---- libavcodec/avcodec.h	Wed Apr  1 18:35:35 2009
-***************
-*** 505,510 ****
---- 505,512 ----
-  #define CODEC_FLAG2_CHUNKS        0x00008000 ///&lt; Input bitstream might be truncated at a packet boundaries instead of only at frame boundaries.
-  #define CODEC_FLAG2_NON_LINEAR_QUANT 0x00010000 ///&lt; Use MPEG-2 nonlinear quantizer.
-  #define CODEC_FLAG2_BIT_RESERVOIR 0x00020000 ///&lt; Use a bit reservoir when encoding if possible
-+ //MEANX: NEVER EVER USE CLOSED GOP ?
-+ #define CODEC_FLAG2_32_PULLDOWN   0x80000000 
-  
-  /* Unsupported options :
-   *              Syntax Arithmetic coding (SAC)
-***************
-*** 1302,1307 ****
---- 1304,1310 ----
-       * - decoding: unused
-       */
-      int rc_max_rate;
-+     int rc_max_rate_header; /*&lt; That one is set in the header MEANX */
-  
-      /**
-       * minimum bitrate
-***************
-*** 1316,1321 ****
---- 1319,1326 ----
-       * - decoding: unused
-       */
-      int rc_buffer_size;
-+     int rc_buffer_size_header;  /*&lt; That one is set in the header MEANX*/
-+ 
-      float rc_buffer_aggressivity;
-  
-      /**
+diff --git a/avidemux_core/ADM_ffmpeg/libavcodec/avcodec.h b/avidemux_core/ADM_ffmpeg/libavcodec/avcodec.h
+index cd642ac..c90eac7 100644
+--- a/avidemux_core/ADM_ffmpeg/libavcodec/avcodec.h
++++ b/avidemux_core/ADM_ffmpeg/libavcodec/avcodec.h
+@@ -599,6 +599,8 @@ typedef struct RcOverride{
+ #define CODEC_FLAG2_PSY           0x00080000 ///&lt; Use psycho visual optimizations.
+ #define CODEC_FLAG2_SSIM          0x00100000 ///&lt; Compute SSIM during encoding, error[] values are undefined.
+ #define CODEC_FLAG2_INTRA_REFRESH 0x00200000 ///&lt; Use periodic insertion of intra blocks instead of keyframes.
++//MEANX: NEVER EVER USE CLOSED GOP ?
++#define CODEC_FLAG2_32_PULLDOWN   0x80000000 
+ 
+ /* Unsupported options :
+  *              Syntax Arithmetic coding (SAC)
+@@ -1469,6 +1471,7 @@ typedef struct AVCodecContext {
+      * - decoding: unused
+      */
+     int rc_max_rate;
++    int rc_max_rate_header; /*&lt; That one is set in the header MEANX */
+ 
+     /**
+      * minimum bitrate
+@@ -1483,6 +1486,8 @@ typedef struct AVCodecContext {
+      * - decoding: unused
+      */
+     int rc_buffer_size;
++    int rc_buffer_size_header;  /*&lt; That one is set in the header MEANX*/
++
+     float rc_buffer_aggressivity;
+ 
+     /**

Added: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavcodec_fft.c.patch
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavcodec_fft.c.patch	2010-05-26 05:26:39 UTC (rev 6236)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavcodec_fft.c.patch	2010-05-26 05:26:42 UTC (rev 6237)
@@ -0,0 +1,13 @@
+diff --git a/avidemux_core/ADM_ffmpeg/libavcodec/fft.c b/avidemux_core/ADM_ffmpeg/libavcodec/fft.c
+index bf240bf..6199d91 100644
+--- a/avidemux_core/ADM_ffmpeg/libavcodec/fft.c
++++ b/avidemux_core/ADM_ffmpeg/libavcodec/fft.c
+@@ -112,7 +112,7 @@ av_cold int ff_fft_init(FFTContext *s, int nbits, int inverse)
+ 
+     if (ARCH_ARM)     ff_fft_init_arm(s);
+     if (HAVE_ALTIVEC) ff_fft_init_altivec(s);
+-    if (HAVE_MMX)     ff_fft_init_mmx(s);
++    // MEANX if (HAVE_MMX)     ff_fft_init_mmx(s);
+ 
+     if (s-&gt;split_radix) {
+         for(j=4; j&lt;=nbits; j++) {

Modified: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavcodec_ffv1.c.patch
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavcodec_ffv1.c.patch	2010-05-26 05:26:39 UTC (rev 6236)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavcodec_ffv1.c.patch	2010-05-26 05:26:42 UTC (rev 6237)
@@ -1,13 +1,13 @@
-*** libavcodec/ffv1.c.old	Mon Feb  2 19:49:49 2009
---- libavcodec/ffv1.c	Mon Feb  2 19:49:48 2009
-***************
-*** 959,964 ****
---- 959,966 ----
-          clear_state(f);
-      }else{
-          p-&gt;key_frame= 0;
-+          p-&gt;pict_type= FF_P_TYPE; // MEANX : looks more like a P to me as user
-+ 
-      }
-      if(!f-&gt;plane[0].state &amp;&amp; !f-&gt;plane[0].vlc_state)
-          return -1;
+diff --git a/avidemux_core/ADM_ffmpeg/libavcodec/ffv1.c b/avidemux_core/ADM_ffmpeg/libavcodec/ffv1.c
+index 12056e1..b2f3efe 100644
+--- a/avidemux_core/ADM_ffmpeg/libavcodec/ffv1.c
++++ b/avidemux_core/ADM_ffmpeg/libavcodec/ffv1.c
+@@ -1107,6 +1107,8 @@ static int decode_frame(AVCodecContext *avctx, void *data, int *data_size, AVPac
+         clear_state(f);
+     }else{
+         p-&gt;key_frame= 0;
++         p-&gt;pict_type= FF_P_TYPE; // MEANX : looks more like a P to me as user
++
+     }
+     if(f-&gt;ac&gt;1){
+         int i;

Modified: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavcodec_h263dec.c.patch
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavcodec_h263dec.c.patch	2010-05-26 05:26:39 UTC (rev 6236)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavcodec_h263dec.c.patch	2010-05-26 05:26:42 UTC (rev 6237)
@@ -1,60 +1,56 @@
-*** libavcodec/h263dec.c.old	Wed Apr  1 18:35:37 2009
---- libavcodec/h263dec.c	Wed Apr  1 18:35:37 2009
-***************
-*** 120,125 ****
---- 120,142 ----
-  
-      return 0;
-  }
-+ /* MeanX : Ugly patch to detect vo ppacked stuff ... */
-+ int av_is_voppacked(AVCodecContext *avctx, int *vop_packed, int *gmc, int *qpel)
-+ {
-+     MpegEncContext *s = avctx-&gt;priv_data;
-+     // set sane default
-+     *vop_packed=0;
-+     *gmc=0;
-+     *qpel=0;
-+     if(avctx-&gt;codec-&gt;id!=CODEC_ID_MPEG4) return 0;
-+     	
-+   	*vop_packed=(s-&gt;divx_packed);
-+ 	*qpel=s-&gt;quarter_sample;
-+ 	*gmc=0;	// FIXME
-+ 	return 1;
-+ 
-+   }
-+   /* MeanX */
-  
-  av_cold int ff_h263_decode_end(AVCodecContext *avctx)
-  {
-***************
-*** 418,423 ****
---- 435,446 ----
-      } else {
-          ret = h263_decode_picture_header(s);
-      }
-+ 	//MEANX we need to do it here also for quicktime file / ctts atom 
-+         // we need the correct frame type, and qt file may contain 
-+         // vop not coded frame.
-+         pict-&gt;pict_type=s-&gt;current_picture.pict_type= s-&gt;pict_type;
-+         pict-&gt;key_frame=s-&gt;current_picture.key_frame= s-&gt;pict_type == FF_I_TYPE;
-+         //MEANX
-  
-      if(ret==FRAME_SKIPPED) return get_consumed_bytes(s, buf_size);
-  
-***************
-*** 706,711 ****
---- 729,742 ----
-  
-  assert(s-&gt;current_picture.pict_type == s-&gt;current_picture_ptr-&gt;pict_type);
-  assert(s-&gt;current_picture.pict_type == s-&gt;pict_type);
-+ /* MEANX */
-+   if(s-&gt;current_picture_ptr)
-+       s-&gt;current_picture_ptr-&gt;opaque=pict-&gt;opaque;
-+ /* MEANX */
-+ 
-+ 
-+ 
-+ 
-      if (s-&gt;pict_type == FF_B_TYPE || s-&gt;low_delay) {
-          *pict= *(AVFrame*)s-&gt;current_picture_ptr;
-      } else if (s-&gt;last_picture_ptr != NULL) {
+diff --git a/avidemux_core/ADM_ffmpeg/libavcodec/h263dec.c b/avidemux_core/ADM_ffmpeg/libavcodec/h263dec.c
+index f5df556..3bc37c0 100644
+--- a/avidemux_core/ADM_ffmpeg/libavcodec/h263dec.c
++++ b/avidemux_core/ADM_ffmpeg/libavcodec/h263dec.c
+@@ -119,6 +119,23 @@ av_cold int ff_h263_decode_init(AVCodecContext *avctx)
+ 
+     return 0;
+ }
++/* MeanX : Ugly patch to detect vo ppacked stuff ... */
++int av_is_voppacked(AVCodecContext *avctx, int *vop_packed, int *gmc, int *qpel)
++{
++    MpegEncContext *s = avctx-&gt;priv_data;
++    // set sane default
++    *vop_packed=0;
++    *gmc=0;
++    *qpel=0;
++    if(avctx-&gt;codec-&gt;id!=CODEC_ID_MPEG4) return 0;
++    	
++  	*vop_packed=(s-&gt;divx_packed);
++	*qpel=s-&gt;quarter_sample;
++	*gmc=0;	// FIXME
++	return 1;
++
++  }
++  /* MeanX */
+ 
+ av_cold int ff_h263_decode_end(AVCodecContext *avctx)
+ {
+@@ -414,6 +431,12 @@ retry:
+     } else {
+         ret = h263_decode_picture_header(s);
+     }
++	//MEANX we need to do it here also for quicktime file / ctts atom 
++        // we need the correct frame type, and qt file may contain 
++        // vop not coded frame.
++        pict-&gt;pict_type=s-&gt;current_picture.pict_type= s-&gt;pict_type;
++        pict-&gt;key_frame=s-&gt;current_picture.key_frame= s-&gt;pict_type == FF_I_TYPE;
++        //MEANX
+ 
+     if(ret==FRAME_SKIPPED) return get_consumed_bytes(s, buf_size);
+ 
+@@ -707,6 +730,14 @@ intrax8_decoded:
+ 
+ assert(s-&gt;current_picture.pict_type == s-&gt;current_picture_ptr-&gt;pict_type);
+ assert(s-&gt;current_picture.pict_type == s-&gt;pict_type);
++/* MEANX */
++  if(s-&gt;current_picture_ptr)
++      s-&gt;current_picture_ptr-&gt;opaque=pict-&gt;opaque;
++/* MEANX */
++
++
++
++
+     if (s-&gt;pict_type == FF_B_TYPE || s-&gt;low_delay) {
+         *pict= *(AVFrame*)s-&gt;current_picture_ptr;
+     } else if (s-&gt;last_picture_ptr != NULL) {

Modified: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavcodec_h264.c.patch
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavcodec_h264.c.patch	2010-05-26 05:26:39 UTC (rev 6236)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavcodec_h264.c.patch	2010-05-26 05:26:42 UTC (rev 6237)
@@ -1,22 +1,22 @@
-*** libavcodec/h264.c.old	Wed Apr  1 18:35:37 2009
---- libavcodec/h264.c	Wed Apr  1 18:35:37 2009
-***************
-*** 8104,8109 ****
---- 8104,8120 ----
-      return 0;
-  }
-  
-+ /* MEANX */
-+ int av_getAVCStreamInfo(AVCodecContext *avctx, uint32_t  *nalSize, uint32_t *isAvc)
-+ {
-+       H264Context *h = avctx-&gt;priv_data;
-+       assert(h);
-+       *nalSize=h-&gt;nal_length_size;
-+       *isAvc=h-&gt;is_avc;
-+ 	return 1;
-+ 
-+   }
-+ /* MeanX */
-  
-  AVCodec h264_decoder = {
-      &quot;h264&quot;,
+diff --git a/avidemux_core/ADM_ffmpeg/libavcodec/h264.c b/avidemux_core/ADM_ffmpeg/libavcodec/h264.c
+index e4654f0..cfab425 100644
+--- a/avidemux_core/ADM_ffmpeg/libavcodec/h264.c
++++ b/avidemux_core/ADM_ffmpeg/libavcodec/h264.c
+@@ -3358,6 +3358,17 @@ av_cold int ff_h264_decode_end(AVCodecContext *avctx)
+     return 0;
+ }
+ 
++/* MEANX */
++int av_getAVCStreamInfo(AVCodecContext *avctx, uint32_t  *nalSize, uint32_t *isAvc)
++{
++      H264Context *h = avctx-&gt;priv_data;
++      assert(h);
++      *nalSize=h-&gt;nal_length_size;
++      *isAvc=h-&gt;is_avc;
++	return 1;
++
++  }
++/* MeanX */
+ 
+ AVCodec h264_decoder = {
+     &quot;h264&quot;,

Modified: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavcodec_mpeg12.c.patch
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavcodec_mpeg12.c.patch	2010-05-26 05:26:39 UTC (rev 6236)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavcodec_mpeg12.c.patch	2010-05-26 05:26:42 UTC (rev 6237)
@@ -1,16 +1,16 @@
-*** libavcodec/mpeg12.c.old	Wed Apr  1 18:35:38 2009
---- libavcodec/mpeg12.c	Wed Apr  1 18:35:38 2009
-***************
-*** 1952,1957 ****
---- 1952,1962 ----
-          ff_er_frame_end(s);
-  
-          MPV_frame_end(s);
-+ /* MEANX */
-+   if(s-&gt;current_picture_ptr)
-+       s-&gt;current_picture_ptr-&gt;opaque=pict-&gt;opaque;
-+ /* MEANX */
-+ 
-  
-          if (s-&gt;pict_type == FF_B_TYPE || s-&gt;low_delay) {
-              *pict= *(AVFrame*)s-&gt;current_picture_ptr;
+diff --git a/avidemux_core/ADM_ffmpeg/libavcodec/mpeg12.c b/avidemux_core/ADM_ffmpeg/libavcodec/mpeg12.c
+index bc9ddcc..036b9ba 100644
+--- a/avidemux_core/ADM_ffmpeg/libavcodec/mpeg12.c
++++ b/avidemux_core/ADM_ffmpeg/libavcodec/mpeg12.c
+@@ -1948,6 +1948,11 @@ static int slice_end(AVCodecContext *avctx, AVFrame *pict)
+         ff_er_frame_end(s);
+ 
+         MPV_frame_end(s);
++/* MEANX */
++  if(s-&gt;current_picture_ptr)
++      s-&gt;current_picture_ptr-&gt;opaque=pict-&gt;opaque;
++/* MEANX */
++
+ 
+         if (s-&gt;pict_type == FF_B_TYPE || s-&gt;low_delay) {
+             *pict= *(AVFrame*)s-&gt;current_picture_ptr;

Modified: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavcodec_mpeg12enc.c.patch
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavcodec_mpeg12enc.c.patch	2010-05-26 05:26:39 UTC (rev 6236)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavcodec_mpeg12enc.c.patch	2010-05-26 05:26:42 UTC (rev 6237)
@@ -1,231 +1,190 @@
-*** libavcodec/mpeg12enc.c.old	Sat Jan 24 22:57:41 2009
---- libavcodec/mpeg12enc.c	Sat Jan 24 22:57:40 2009
-***************
-*** 127,136 ****
---- 127,145 ----
-              s-&gt;frame_rate_index= i;
-          }
-      }
-+  /* MEANX 
-+ 
-      if(dmin)
-          return -1;
-      else
-          return 0;
-+   */
-+         if(dmin&gt;4)
-+    {
-+         av_log(0,AV_LOG_ERROR,&quot;We did a roundup ! Expect async!\n&quot;);
-+    }
-+         return 0; //MEANX
-+ 
-  }
-  
-  static av_cold int encode_init(AVCodecContext *avctx)
-***************
-*** 209,214 ****
---- 218,224 ----
-              put_sbits(&amp;s-&gt;pb, 12, s-&gt;width );
-              put_sbits(&amp;s-&gt;pb, 12, s-&gt;height);
-  
-+ #if 0 //MEANX
-              for(i=1; i&lt;15; i++){
-                  float error= aspect_ratio;
-                  if(s-&gt;codec_id == CODEC_ID_MPEG1VIDEO || i &lt;=1)
-***************
-*** 223,242 ****
-                      s-&gt;aspect_ratio_info= i;
-                  }
-              }
-  
-!             put_bits(&amp;s-&gt;pb, 4, s-&gt;aspect_ratio_info);
-!             put_bits(&amp;s-&gt;pb, 4, s-&gt;frame_rate_index);
-! 
-!             if(s-&gt;avctx-&gt;rc_max_rate){
-!                 v = (s-&gt;avctx-&gt;rc_max_rate + 399) / 400;
-                  if (v &gt; 0x3ffff &amp;&amp; s-&gt;codec_id == CODEC_ID_MPEG1VIDEO)
-                      v = 0x3ffff;
-              }else{
-                  v= 0x3FFFF;
-              }
-  
-!             if(s-&gt;avctx-&gt;rc_buffer_size)
-!                 vbv_buffer_size = s-&gt;avctx-&gt;rc_buffer_size;
-              else
-                  /* VBV calculation: Scaled so that a VCD has the proper VBV size of 40 kilobytes */
-                  vbv_buffer_size = (( 20 * s-&gt;bit_rate) / (1151929 / 2)) * 8 * 1024;
---- 233,276 ----
-                      s-&gt;aspect_ratio_info= i;
-                  }
-              }
-+ #endif // MEANX
-+             //MEANX put_bits(&amp;s-&gt;pb, 4, s-&gt;aspect_ratio_info);
-+             //MEANX put_bits(&amp;s-&gt;pb, 4, s-&gt;frame_rate_index);
-+  // MEANX 4:3
-+   if(s-&gt;avctx-&gt;sample_aspect_ratio.num==16 &amp;&amp; s-&gt;avctx-&gt;sample_aspect_ratio.den==9)
-+             {
-+                 //printf(&quot;FFmpeg : Wide\n&quot;);
-+                 put_bits(&amp;s-&gt;pb,4,3); //16:9
-+             }
-+             else        //4:3
-+             {
-+               if(s-&gt;codec_id == CODEC_ID_MPEG2VIDEO)
-+                 put_bits(&amp;s-&gt;pb, 4, 2);
-+               else
-+                 put_bits(&amp;s-&gt;pb, 4, 12); // MPEG1
-+             }
-+ // /MEANX
-+ 
-+ // //MEANX PULLDOWN            put_bits(&amp;s-&gt;pb, 4, s-&gt;frame_rate_index);
-+ if((s-&gt;flags2 &amp; CODEC_FLAG2_32_PULLDOWN) &amp;&amp; (s-&gt;codec_id == CODEC_ID_MPEG2VIDEO))
-+             {           
-+                 put_bits(&amp;s-&gt;pb, 4,4);
-+             }
-+             else
-+             {                                  
-+                 put_bits(&amp;s-&gt;pb, 4, s-&gt;frame_rate_index);
-+             } //MEANX pulldown
-  
-!             if(s-&gt;avctx-&gt;rc_max_rate_header){ //MEANX we use header
-!                 v = (s-&gt;avctx-&gt;rc_max_rate_header + 399) / 400;
-                  if (v &gt; 0x3ffff &amp;&amp; s-&gt;codec_id == CODEC_ID_MPEG1VIDEO)
-                      v = 0x3ffff;
-              }else{
-                  v= 0x3FFFF;
-              }
-  
-!             if(s-&gt;avctx-&gt;rc_buffer_size_header) // MEANX we use header
-!                 vbv_buffer_size = s-&gt;avctx-&gt;rc_buffer_size_header;
-              else
-                  /* VBV calculation: Scaled so that a VCD has the proper VBV size of 40 kilobytes */
-                  vbv_buffer_size = (( 20 * s-&gt;bit_rate) / (1151929 / 2)) * 8 * 1024;
-***************
-*** 269,276 ****
-  
-                  put_bits(&amp;s-&gt;pb, 3, s-&gt;avctx-&gt;profile); //profile
-                  put_bits(&amp;s-&gt;pb, 4, s-&gt;avctx-&gt;level); //level
-  
--                 put_bits(&amp;s-&gt;pb, 1, s-&gt;progressive_sequence);
-                  put_bits(&amp;s-&gt;pb, 2, s-&gt;chroma_format);
-                  put_bits(&amp;s-&gt;pb, 2, s-&gt;width &gt;&gt;12);
-                  put_bits(&amp;s-&gt;pb, 2, s-&gt;height&gt;&gt;12);
---- 303,319 ----
-  
-                  put_bits(&amp;s-&gt;pb, 3, s-&gt;avctx-&gt;profile); //profile
-                  put_bits(&amp;s-&gt;pb, 4, s-&gt;avctx-&gt;level); //level
-+    // MEANX pulldown put_bits(&amp;s-&gt;pb, 1, s-&gt;progressive_sequence);
-+   // MEANX Pulldown
-+  if(s-&gt;flags2 &amp; CODEC_FLAG2_32_PULLDOWN) //MEANX
-+                         put_bits(&amp;s-&gt;pb, 1, 0);
-+                 else
-+                         put_bits(&amp;s-&gt;pb, 1, s-&gt;progressive_sequence);
-+ 
-+ 
-+ // /MEANX
-+ 
-  
-                  put_bits(&amp;s-&gt;pb, 2, s-&gt;chroma_format);
-                  put_bits(&amp;s-&gt;pb, 2, s-&gt;width &gt;&gt;12);
-                  put_bits(&amp;s-&gt;pb, 2, s-&gt;height&gt;&gt;12);
-***************
-*** 334,339 ****
---- 377,384 ----
-  
-  void mpeg1_encode_picture_header(MpegEncContext *s, int picture_number)
-  {
-+ 	int tff,rff; //MEANX
-+ 
-      mpeg1_encode_sequence_header(s);
-  
-      /* mpeg1 picture header */
-***************
-*** 370,375 ****
---- 415,463 ----
-  
-      s-&gt;frame_pred_frame_dct = 1;
-      if(s-&gt;codec_id == CODEC_ID_MPEG2VIDEO){
-+  /* MEANX -- Pulldown */
-+         if(s-&gt;flags2 &amp; CODEC_FLAG2_32_PULLDOWN)
-+         {
-+         
-+                 switch((s-&gt;picture_number - 
-+                           s-&gt;gop_picture_number)&amp;3)
-+                 {
-+                         case 0:
-+                         default:
-+                                 rff=1;
-+                                 tff=1;
-+                                 break;
-+                         case 1:
-+                                 rff=0;
-+                                 tff=0;
-+                                 break;
-+                         case 2:
-+                                 rff=1;
-+                                 tff=0;
-+                                 break;
-+                         case 3:
-+                                 rff=0;
-+                                 tff=1;
-+                                 break;
-+                 }               
+diff --git a/avidemux_core/ADM_ffmpeg/libavcodec/mpeg12enc.c b/avidemux_core/ADM_ffmpeg/libavcodec/mpeg12enc.c
+index bf36129..b4d6a1d 100644
+--- a/avidemux_core/ADM_ffmpeg/libavcodec/mpeg12enc.c
++++ b/avidemux_core/ADM_ffmpeg/libavcodec/mpeg12enc.c
+@@ -127,10 +127,19 @@ static int find_frame_rate_index(MpegEncContext *s){
+             s-&gt;frame_rate_index= i;
+         }
+     }
++ /* MEANX 
++
+     if(dmin)
+         return -1;
+     else
+         return 0;
++  */
++        if(dmin&gt;4)
++   {
++        av_log(0,AV_LOG_ERROR,&quot;We did a roundup ! Expect async!\n&quot;);
++   }
++        return 0; //MEANX
++
+ }
+ 
+ static av_cold int encode_init(AVCodecContext *avctx)
+@@ -209,6 +218,7 @@ static void mpeg1_encode_sequence_header(MpegEncContext *s)
+             put_sbits(&amp;s-&gt;pb, 12, s-&gt;width );
+             put_sbits(&amp;s-&gt;pb, 12, s-&gt;height);
+ 
++#if 0 //MEANX
+             for(i=1; i&lt;15; i++){
+                 float error= aspect_ratio;
+                 if(s-&gt;codec_id == CODEC_ID_MPEG1VIDEO || i &lt;=1)
+@@ -223,20 +233,44 @@ static void mpeg1_encode_sequence_header(MpegEncContext *s)
+                     s-&gt;aspect_ratio_info= i;
+                 }
+             }
++#endif // MEANX
++            //MEANX put_bits(&amp;s-&gt;pb, 4, s-&gt;aspect_ratio_info);
++            //MEANX put_bits(&amp;s-&gt;pb, 4, s-&gt;frame_rate_index);
++ // MEANX 4:3
++  if(s-&gt;avctx-&gt;sample_aspect_ratio.num==16 &amp;&amp; s-&gt;avctx-&gt;sample_aspect_ratio.den==9)
++            {
++                //printf(&quot;FFmpeg : Wide\n&quot;);
++                put_bits(&amp;s-&gt;pb,4,3); //16:9
 +            }
-+         else
-+         {
-+                 if (s-&gt;progressive_sequence) 
-+                 {
-+                         tff=0; /* no repeat */
-+                 } else 
-+                 {
-+                         tff= s-&gt;current_picture_ptr-&gt;top_field_first;
-+                 }
-+                 rff=s-&gt;repeat_first_field;
-+         
-+         }
-+ 
-+ //               /MEANX pulldown
-+ 
-+ 
-+ 
-          put_header(s, EXT_START_CODE);
-          put_bits(&amp;s-&gt;pb, 4, 8); //pic ext
-          if (s-&gt;pict_type == FF_P_TYPE || s-&gt;pict_type == FF_B_TYPE) {
-***************
-*** 388,398 ****
---- 476,491 ----
-  
-          assert(s-&gt;picture_structure == PICT_FRAME);
-          put_bits(&amp;s-&gt;pb, 2, s-&gt;picture_structure);
-+ #if 0 //MEANX
-+ 
-          if (s-&gt;progressive_sequence) {
-              put_bits(&amp;s-&gt;pb, 1, 0); /* no repeat */
-          } else {
-              put_bits(&amp;s-&gt;pb, 1, s-&gt;current_picture_ptr-&gt;top_field_first);
-          }
-+ #endif
-+          put_bits(&amp;s-&gt;pb, 1, tff);  //MEANX PULLDOWN
-+ 
-          /* XXX: optimize the generation of this flag with entropy
-             measures */
-          s-&gt;frame_pred_frame_dct = s-&gt;progressive_sequence;
-***************
-*** 402,408 ****
-          put_bits(&amp;s-&gt;pb, 1, s-&gt;q_scale_type);
-          put_bits(&amp;s-&gt;pb, 1, s-&gt;intra_vlc_format);
-          put_bits(&amp;s-&gt;pb, 1, s-&gt;alternate_scan);
-!         put_bits(&amp;s-&gt;pb, 1, s-&gt;repeat_first_field);
-          s-&gt;progressive_frame = s-&gt;progressive_sequence;
-          put_bits(&amp;s-&gt;pb, 1, s-&gt;chroma_format == CHROMA_420 ? s-&gt;progressive_frame : 0); /* chroma_420_type */
-          put_bits(&amp;s-&gt;pb, 1, s-&gt;progressive_frame);
---- 495,504 ----
-          put_bits(&amp;s-&gt;pb, 1, s-&gt;q_scale_type);
-          put_bits(&amp;s-&gt;pb, 1, s-&gt;intra_vlc_format);
-          put_bits(&amp;s-&gt;pb, 1, s-&gt;alternate_scan);
-!  // MEANX put_bits(&amp;s-&gt;pb, 1, s-&gt;repeat_first_field);
-! 	put_bits(&amp;s-&gt;pb, 1, rff);
-!       // /MEANX
-! 
-          s-&gt;progressive_frame = s-&gt;progressive_sequence;
-          put_bits(&amp;s-&gt;pb, 1, s-&gt;chroma_format == CHROMA_420 ? s-&gt;progressive_frame : 0); /* chroma_420_type */
-          put_bits(&amp;s-&gt;pb, 1, s-&gt;progressive_frame);
++            else        //4:3
++            {
++              if(s-&gt;codec_id == CODEC_ID_MPEG2VIDEO)
++                put_bits(&amp;s-&gt;pb, 4, 2);
++              else
++                put_bits(&amp;s-&gt;pb, 4, 12); // MPEG1
++            }
++// /MEANX
+ 
+-            put_bits(&amp;s-&gt;pb, 4, s-&gt;aspect_ratio_info);
+-            put_bits(&amp;s-&gt;pb, 4, s-&gt;frame_rate_index);
++// //MEANX PULLDOWN            put_bits(&amp;s-&gt;pb, 4, s-&gt;frame_rate_index);
++if((s-&gt;flags2 &amp; CODEC_FLAG2_32_PULLDOWN) &amp;&amp; (s-&gt;codec_id == CODEC_ID_MPEG2VIDEO))
++            {           
++                put_bits(&amp;s-&gt;pb, 4,4);
++            }
++            else
++            {                                  
++                put_bits(&amp;s-&gt;pb, 4, s-&gt;frame_rate_index);
++            } //MEANX pulldown
+ 
+-            if(s-&gt;avctx-&gt;rc_max_rate){
+-                v = (s-&gt;avctx-&gt;rc_max_rate + 399) / 400;
++            if(s-&gt;avctx-&gt;rc_max_rate_header){ //MEANX we use header
++                v = (s-&gt;avctx-&gt;rc_max_rate_header + 399) / 400;
+                 if (v &gt; 0x3ffff &amp;&amp; s-&gt;codec_id == CODEC_ID_MPEG1VIDEO)
+                     v = 0x3ffff;
+             }else{
+                 v= 0x3FFFF;
+             }
+ 
+-            if(s-&gt;avctx-&gt;rc_buffer_size)
+-                vbv_buffer_size = s-&gt;avctx-&gt;rc_buffer_size;
++            if(s-&gt;avctx-&gt;rc_buffer_size_header) // MEANX we use header
++                vbv_buffer_size = s-&gt;avctx-&gt;rc_buffer_size_header;
+             else
+                 /* VBV calculation: Scaled so that a VCD has the proper VBV size of 40 kilobytes */
+                 vbv_buffer_size = (( 20 * s-&gt;bit_rate) / (1151929 / 2)) * 8 * 1024;
+@@ -269,8 +303,17 @@ static void mpeg1_encode_sequence_header(MpegEncContext *s)
+ 
+                 put_bits(&amp;s-&gt;pb, 3, s-&gt;avctx-&gt;profile); //profile
+                 put_bits(&amp;s-&gt;pb, 4, s-&gt;avctx-&gt;level); //level
++   // MEANX pulldown put_bits(&amp;s-&gt;pb, 1, s-&gt;progressive_sequence);
++  // MEANX Pulldown
++ if(s-&gt;flags2 &amp; CODEC_FLAG2_32_PULLDOWN) //MEANX
++                        put_bits(&amp;s-&gt;pb, 1, 0);
++                else
++                        put_bits(&amp;s-&gt;pb, 1, s-&gt;progressive_sequence);
++
++
++// /MEANX
++
+ 
+-                put_bits(&amp;s-&gt;pb, 1, s-&gt;progressive_sequence);
+                 put_bits(&amp;s-&gt;pb, 2, s-&gt;chroma_format);
+                 put_bits(&amp;s-&gt;pb, 2, s-&gt;width &gt;&gt;12);
+                 put_bits(&amp;s-&gt;pb, 2, s-&gt;height&gt;&gt;12);
+@@ -339,6 +382,8 @@ void ff_mpeg1_encode_slice_header(MpegEncContext *s){
+ 
+ void mpeg1_encode_picture_header(MpegEncContext *s, int picture_number)
+ {
++	int tff,rff; //MEANX
++
+     mpeg1_encode_sequence_header(s);
+ 
+     /* mpeg1 picture header */
+@@ -375,6 +420,49 @@ void mpeg1_encode_picture_header(MpegEncContext *s, int picture_number)
+ 
+     s-&gt;frame_pred_frame_dct = 1;
+     if(s-&gt;codec_id == CODEC_ID_MPEG2VIDEO){
++ /* MEANX -- Pulldown */
++        if(s-&gt;flags2 &amp; CODEC_FLAG2_32_PULLDOWN)
++        {
++        
++                switch((s-&gt;picture_number - 
++                          s-&gt;gop_picture_number)&amp;3)
++                {
++                        case 0:
++                        default:
++                                rff=1;
++                                tff=1;
++                                break;
++                        case 1:
++                                rff=0;
++                                tff=0;
++                                break;
++                        case 2:
++                                rff=1;
++                                tff=0;
++                                break;
++                        case 3:
++                                rff=0;
++                                tff=1;
++                                break;
++                }               
++           }
++        else
++        {
++                if (s-&gt;progressive_sequence) 
++                {
++                        tff=0; /* no repeat */
++                } else 
++                {
++                        tff= s-&gt;current_picture_ptr-&gt;top_field_first;
++                }
++                rff=s-&gt;repeat_first_field;
++        
++        }
++
++//               /MEANX pulldown
++
++
++
+         put_header(s, EXT_START_CODE);
+         put_bits(&amp;s-&gt;pb, 4, 8); //pic ext
+         if (s-&gt;pict_type == FF_P_TYPE || s-&gt;pict_type == FF_B_TYPE) {
+@@ -393,11 +481,16 @@ void mpeg1_encode_picture_header(MpegEncContext *s, int picture_number)
+ 
+         assert(s-&gt;picture_structure == PICT_FRAME);
+         put_bits(&amp;s-&gt;pb, 2, s-&gt;picture_structure);
++#if 0 //MEANX
++
+         if (s-&gt;progressive_sequence) {
+             put_bits(&amp;s-&gt;pb, 1, 0); /* no repeat */
+         } else {
+             put_bits(&amp;s-&gt;pb, 1, s-&gt;current_picture_ptr-&gt;top_field_first);
+         }
++#endif
++         put_bits(&amp;s-&gt;pb, 1, tff);  //MEANX PULLDOWN
++
+         /* XXX: optimize the generation of this flag with entropy
+            measures */
+         s-&gt;frame_pred_frame_dct = s-&gt;progressive_sequence;
+@@ -407,7 +500,10 @@ void mpeg1_encode_picture_header(MpegEncContext *s, int picture_number)
+         put_bits(&amp;s-&gt;pb, 1, s-&gt;q_scale_type);
+         put_bits(&amp;s-&gt;pb, 1, s-&gt;intra_vlc_format);
+         put_bits(&amp;s-&gt;pb, 1, s-&gt;alternate_scan);
+-        put_bits(&amp;s-&gt;pb, 1, s-&gt;repeat_first_field);
++ // MEANX put_bits(&amp;s-&gt;pb, 1, s-&gt;repeat_first_field);
++	put_bits(&amp;s-&gt;pb, 1, rff);
++      // /MEANX
++
+         s-&gt;progressive_frame = s-&gt;progressive_sequence;
+         put_bits(&amp;s-&gt;pb, 1, s-&gt;chroma_format == CHROMA_420 ? s-&gt;progressive_frame : 0); /* chroma_420_type */
+         put_bits(&amp;s-&gt;pb, 1, s-&gt;progressive_frame);

Modified: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavcodec_mpegvideo.c.patch
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavcodec_mpegvideo.c.patch	2010-05-26 05:26:39 UTC (rev 6236)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavcodec_mpegvideo.c.patch	2010-05-26 05:26:42 UTC (rev 6237)
@@ -1,23 +1,17 @@
-*** libavcodec/mpegvideo.c.old	Wed Apr  1 18:35:39 2009
---- libavcodec/mpegvideo.c	Wed Apr  1 18:35:39 2009
-***************
-*** 606,612 ****
-      CHECKED_ALLOCZ(s-&gt;prev_pict_types, PREV_PICT_TYPES_BUFFER_SIZE);
-  
-      s-&gt;parse_context.state= -1;
-!     if((s-&gt;avctx-&gt;debug&amp;(FF_DEBUG_VIS_QP|FF_DEBUG_VIS_MB_TYPE)) || (s-&gt;avctx-&gt;debug_mv)){
-         s-&gt;visualization_buffer[0] = av_malloc((s-&gt;mb_width*16 + 2*EDGE_WIDTH) * s-&gt;mb_height*16 + 2*EDGE_WIDTH);
-         s-&gt;visualization_buffer[1] = av_malloc((s-&gt;mb_width*16 + 2*EDGE_WIDTH) * s-&gt;mb_height*16 + 2*EDGE_WIDTH);
-         s-&gt;visualization_buffer[2] = av_malloc((s-&gt;mb_width*16 + 2*EDGE_WIDTH) * s-&gt;mb_height*16 + 2*EDGE_WIDTH);
---- 606,616 ----
-      CHECKED_ALLOCZ(s-&gt;prev_pict_types, PREV_PICT_TYPES_BUFFER_SIZE);
-  
-      s-&gt;parse_context.state= -1;
-!  //MEANX: Allocate them always, as they may be free when we decode 1st image
-! 
-!     // MEANXif((s-&gt;avctx-&gt;debug&amp;(FF_DEBUG_VIS_QP|FF_DEBUG_VIS_MB_TYPE)) || (s-&gt;avctx-&gt;debug_mv)){
-! if(1){ // MEANX
-! 
-         s-&gt;visualization_buffer[0] = av_malloc((s-&gt;mb_width*16 + 2*EDGE_WIDTH) * s-&gt;mb_height*16 + 2*EDGE_WIDTH);
-         s-&gt;visualization_buffer[1] = av_malloc((s-&gt;mb_width*16 + 2*EDGE_WIDTH) * s-&gt;mb_height*16 + 2*EDGE_WIDTH);
-         s-&gt;visualization_buffer[2] = av_malloc((s-&gt;mb_width*16 + 2*EDGE_WIDTH) * s-&gt;mb_height*16 + 2*EDGE_WIDTH);
+diff --git a/avidemux_core/ADM_ffmpeg/libavcodec/mpegvideo.c b/avidemux_core/ADM_ffmpeg/libavcodec/mpegvideo.c
+index b5631cf..770fed5 100644
+--- a/avidemux_core/ADM_ffmpeg/libavcodec/mpegvideo.c
++++ b/avidemux_core/ADM_ffmpeg/libavcodec/mpegvideo.c
+@@ -641,7 +641,11 @@ av_cold int MPV_common_init(MpegEncContext *s)
+     FF_ALLOCZ_OR_GOTO(s-&gt;avctx, s-&gt;prev_pict_types, PREV_PICT_TYPES_BUFFER_SIZE, fail);
+ 
+     s-&gt;parse_context.state= -1;
+-    if((s-&gt;avctx-&gt;debug&amp;(FF_DEBUG_VIS_QP|FF_DEBUG_VIS_MB_TYPE)) || (s-&gt;avctx-&gt;debug_mv)){
++ //MEANX: Allocate them always, as they may be free when we decode 1st image
++
++    // MEANXif((s-&gt;avctx-&gt;debug&amp;(FF_DEBUG_VIS_QP|FF_DEBUG_VIS_MB_TYPE)) || (s-&gt;avctx-&gt;debug_mv)){
++if(1){ // MEANX
++
+        s-&gt;visualization_buffer[0] = av_malloc((s-&gt;mb_width*16 + 2*EDGE_WIDTH) * s-&gt;mb_height*16 + 2*EDGE_WIDTH);
+        s-&gt;visualization_buffer[1] = av_malloc((s-&gt;mb_width*16 + 2*EDGE_WIDTH) * s-&gt;mb_height*16 + 2*EDGE_WIDTH);
+        s-&gt;visualization_buffer[2] = av_malloc((s-&gt;mb_width*16 + 2*EDGE_WIDTH) * s-&gt;mb_height*16 + 2*EDGE_WIDTH);

Modified: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavcodec_mpegvideo_enc.c.patch
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavcodec_mpegvideo_enc.c.patch	2010-05-26 05:26:39 UTC (rev 6236)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavcodec_mpegvideo_enc.c.patch	2010-05-26 05:26:42 UTC (rev 6237)
@@ -1,34 +1,32 @@
-*** libavcodec/mpegvideo_enc.c.old	Sun Jan 25 00:55:20 2009
---- libavcodec/mpegvideo_enc.c	Sun Jan 25 00:55:19 2009
-***************
-*** 349,360 ****
---- 349,362 ----
-  
-          av_log(avctx, AV_LOG_INFO, &quot;Warning vbv_delay will be set to 0xFFFF (=VBR) as the specified vbv buffer is too large for the given bitrate!\n&quot;);
-      }
-+ #if 0 //MEANX
-  
-      if((s-&gt;flags &amp; CODEC_FLAG_4MV) &amp;&amp; s-&gt;codec_id != CODEC_ID_MPEG4
-         &amp;&amp; s-&gt;codec_id != CODEC_ID_H263 &amp;&amp; s-&gt;codec_id != CODEC_ID_H263P &amp;&amp; s-&gt;codec_id != CODEC_ID_FLV1){
-          av_log(avctx, AV_LOG_ERROR, &quot;4MV not supported by codec\n&quot;);
-          return -1;
-      }
-+ #endif
-  
-      if(s-&gt;obmc &amp;&amp; s-&gt;avctx-&gt;mb_decision != FF_MB_DECISION_SIMPLE){
-          av_log(avctx, AV_LOG_ERROR, &quot;OBMC is only supported with simple mb decision\n&quot;);
-***************
-*** 387,396 ****
---- 389,400 ----
-          return -1;
-      }
-  
-+ #if 0 //MEANX
-      if(s-&gt;mpeg_quant &amp;&amp; s-&gt;codec_id != CODEC_ID_MPEG4){ //FIXME mpeg2 uses that too
-          av_log(avctx, AV_LOG_ERROR, &quot;mpeg2 style quantization not supported by codec\n&quot;);
-          return -1;
-      }
-+ #endif
-  
-      if((s-&gt;flags &amp; CODEC_FLAG_CBP_RD) &amp;&amp; !avctx-&gt;trellis){
-          av_log(avctx, AV_LOG_ERROR, &quot;CBP RD needs trellis quant\n&quot;);
+diff --git a/avidemux_core/ADM_ffmpeg/libavcodec/mpegvideo_enc.c b/avidemux_core/ADM_ffmpeg/libavcodec/mpegvideo_enc.c
+index a8616d0..0b226d8 100644
+--- a/avidemux_core/ADM_ffmpeg/libavcodec/mpegvideo_enc.c
++++ b/avidemux_core/ADM_ffmpeg/libavcodec/mpegvideo_enc.c
+@@ -367,12 +367,14 @@ av_cold int MPV_encode_init(AVCodecContext *avctx)
+ 
+         av_log(avctx, AV_LOG_INFO, &quot;Warning vbv_delay will be set to 0xFFFF (=VBR) as the specified vbv buffer is too large for the given bitrate!\n&quot;);
+     }
++#if 0 //MEANX
+ 
+     if((s-&gt;flags &amp; CODEC_FLAG_4MV) &amp;&amp; s-&gt;codec_id != CODEC_ID_MPEG4
+        &amp;&amp; s-&gt;codec_id != CODEC_ID_H263 &amp;&amp; s-&gt;codec_id != CODEC_ID_H263P &amp;&amp; s-&gt;codec_id != CODEC_ID_FLV1){
+         av_log(avctx, AV_LOG_ERROR, &quot;4MV not supported by codec\n&quot;);
+         return -1;
+     }
++#endif
+ 
+     if(s-&gt;obmc &amp;&amp; s-&gt;avctx-&gt;mb_decision != FF_MB_DECISION_SIMPLE){
+         av_log(avctx, AV_LOG_ERROR, &quot;OBMC is only supported with simple mb decision\n&quot;);
+@@ -413,10 +415,12 @@ av_cold int MPV_encode_init(AVCodecContext *avctx)
+         return -1;
+     }
+ 
++#if 0 //MEANX
+     if(s-&gt;mpeg_quant &amp;&amp; s-&gt;codec_id != CODEC_ID_MPEG4){ //FIXME mpeg2 uses that too
+         av_log(avctx, AV_LOG_ERROR, &quot;mpeg2 style quantization not supported by codec\n&quot;);
+         return -1;
+     }
++#endif
+ 
+     if((s-&gt;flags &amp; CODEC_FLAG_CBP_RD) &amp;&amp; !avctx-&gt;trellis){
+         av_log(avctx, AV_LOG_ERROR, &quot;CBP RD needs trellis quant\n&quot;);

Modified: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavcodec_png.patch
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavcodec_png.patch	2010-05-26 05:26:39 UTC (rev 6236)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavcodec_png.patch	2010-05-26 05:26:42 UTC (rev 6237)
@@ -1,7 +1,7 @@
-diff --git a/avidemux/ADM_libraries/ADM_ffmpeg/libavcodec/png.c b/avidemux/ADM_libraries/ADM_ffmpeg/libavcodec/png.c
+diff --git a/avidemux_core/ADM_ffmpeg/libavcodec/png.c b/avidemux_core/ADM_ffmpeg/libavcodec/png.c
 index 534dc68..1a6e137 100644
---- libavcodec/png.c
-+++ libavcodec/png.c
+--- a/avidemux_core/ADM_ffmpeg/libavcodec/png.c
++++ b/avidemux_core/ADM_ffmpeg/libavcodec/png.c
 @@ -20,7 +20,7 @@
   */
  #include &quot;avcodec.h&quot;
@@ -11,29 +11,3 @@
  
  const uint8_t ff_pngsig[8] = {137, 80, 78, 71, 13, 10, 26, 10};
  const uint8_t ff_mngsig[8] = {138, 77, 78, 71, 13, 10, 26, 10};
-diff --git a/avidemux/ADM_libraries/ADM_ffmpeg/libavcodec/pngdec.c b/avidemux/ADM_libraries/ADM_ffmpeg/libavcodec/pngdec.c
-index bf719b2..d069d44 100644
---- libavcodec/pngdec.c
-+++ libavcodec/pngdec.c
-@@ -20,7 +20,7 @@
-  */
- #include &quot;avcodec.h&quot;
- #include &quot;bytestream.h&quot;
--#include &quot;png.h&quot;
-+#include &quot;ffpng.h&quot;
- #include &quot;dsputil.h&quot;
- 
- /* TODO:
-diff --git a/avidemux/ADM_libraries/ADM_ffmpeg/libavcodec/pngenc.c b/avidemux/ADM_libraries/ADM_ffmpeg/libavcodec/pngenc.c
-index 40dadc8..0204064 100644
---- libavcodec/pngenc.c
-+++ libavcodec/pngenc.c
-@@ -21,7 +21,7 @@
- #include &quot;avcodec.h&quot;
- #include &quot;bytestream.h&quot;
- #include &quot;dsputil.h&quot;
--#include &quot;png.h&quot;
-+#include &quot;ffpng.h&quot;
- 
- /* TODO:
-  * - add 2, 4 and 16 bit depth support

Added: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavcodec_pngdec.c.patch
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavcodec_pngdec.c.patch	2010-05-26 05:26:39 UTC (rev 6236)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavcodec_pngdec.c.patch	2010-05-26 05:26:42 UTC (rev 6237)
@@ -0,0 +1,13 @@
+diff --git a/avidemux_core/ADM_ffmpeg/libavcodec/pngdec.c b/avidemux_core/ADM_ffmpeg/libavcodec/pngdec.c
+index 03859a9..e1b6d6e 100644
+--- a/avidemux_core/ADM_ffmpeg/libavcodec/pngdec.c
++++ b/avidemux_core/ADM_ffmpeg/libavcodec/pngdec.c
+@@ -20,7 +20,7 @@
+  */
+ #include &quot;avcodec.h&quot;
+ #include &quot;bytestream.h&quot;
+-#include &quot;png.h&quot;
++#include &quot;ffpng.h&quot;
+ #include &quot;dsputil.h&quot;
+ 
+ /* TODO:

Added: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavcodec_pngenc.c.patch
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavcodec_pngenc.c.patch	2010-05-26 05:26:39 UTC (rev 6236)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavcodec_pngenc.c.patch	2010-05-26 05:26:42 UTC (rev 6237)
@@ -0,0 +1,13 @@
+diff --git a/avidemux_core/ADM_ffmpeg/libavcodec/pngenc.c b/avidemux_core/ADM_ffmpeg/libavcodec/pngenc.c
+index 615bcc4..4149234 100644
+--- a/avidemux_core/ADM_ffmpeg/libavcodec/pngenc.c
++++ b/avidemux_core/ADM_ffmpeg/libavcodec/pngenc.c
+@@ -21,7 +21,7 @@
+ #include &quot;avcodec.h&quot;
+ #include &quot;bytestream.h&quot;
+ #include &quot;dsputil.h&quot;
+-#include &quot;png.h&quot;
++#include &quot;ffpng.h&quot;
+ 
+ /* TODO:
+  * - add 2, 4 and 16 bit depth support

Modified: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavcodec_utils.c.patch
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavcodec_utils.c.patch	2010-05-26 05:26:39 UTC (rev 6236)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavcodec_utils.c.patch	2010-05-26 05:26:42 UTC (rev 6237)
@@ -1,34 +1,42 @@
-*** libavcodec/utils.c.old	Wed Apr  1 18:35:40 2009
---- libavcodec/utils.c	Wed Apr  1 18:35:40 2009
-***************
-*** 555,564 ****
---- 555,566 ----
-  
-      if((avctx-&gt;codec-&gt;capabilities &amp; CODEC_CAP_DELAY) || buf_size){
-          //FIXME remove the check below _after_ ensuring that all audio check that the available space is enough
-+ #if 0 // MEANX : Silence
-          if(*frame_size_ptr &lt; AVCODEC_MAX_AUDIO_FRAME_SIZE){
-              av_log(avctx, AV_LOG_ERROR, &quot;buffer smaller than AVCODEC_MAX_AUDIO_FRAME_SIZE\n&quot;);
-              return -1;
-          }
-+ #endif
-          if(*frame_size_ptr &lt; FF_MIN_BUFFER_SIZE ||
-          *frame_size_ptr &lt; avctx-&gt;channels * avctx-&gt;frame_size * sizeof(int16_t)){
-              av_log(avctx, AV_LOG_ERROR, &quot;buffer %d too small\n&quot;, *frame_size_ptr);
-***************
-*** 969,975 ****
-          return -1;
-      }
-  #if !HAVE_MKSTEMP
-!     fd = open(*filename, O_RDWR | O_BINARY | O_CREAT, 0444);
-  #else
-      snprintf(*filename, len, &quot;/tmp/%sXXXXXX&quot;, prefix);
-      fd = mkstemp(*filename);
---- 971,977 ----
-          return -1;
-      }
-  #if !HAVE_MKSTEMP
-!     fd = open(*filename, O_RDWR /* MEANX | O_BINARY*/ | O_CREAT, 0444);
-  #else
-      snprintf(*filename, len, &quot;/tmp/%sXXXXXX&quot;, prefix);
-      fd = mkstemp(*filename);
+diff --git a/avidemux_core/ADM_ffmpeg/libavcodec/utils.c b/avidemux_core/ADM_ffmpeg/libavcodec/utils.c
+index 56d4dbd..aad5a47 100644
+--- a/avidemux_core/ADM_ffmpeg/libavcodec/utils.c
++++ b/avidemux_core/ADM_ffmpeg/libavcodec/utils.c
+@@ -643,10 +643,12 @@ int attribute_align_arg avcodec_decode_audio3(AVCodecContext *avctx, int16_t *sa
+ 
+     if((avctx-&gt;codec-&gt;capabilities &amp; CODEC_CAP_DELAY) || avpkt-&gt;size){
+         //FIXME remove the check below _after_ ensuring that all audio check that the available space is enough
++#if 0 // MEANX : Silence
+         if(*frame_size_ptr &lt; AVCODEC_MAX_AUDIO_FRAME_SIZE){
+             av_log(avctx, AV_LOG_ERROR, &quot;buffer smaller than AVCODEC_MAX_AUDIO_FRAME_SIZE\n&quot;);
+             return -1;
+         }
++#endif
+         if(*frame_size_ptr &lt; FF_MIN_BUFFER_SIZE ||
+         *frame_size_ptr &lt; avctx-&gt;channels * avctx-&gt;frame_size * sizeof(int16_t)){
+             av_log(avctx, AV_LOG_ERROR, &quot;buffer %d too small\n&quot;, *frame_size_ptr);
+@@ -921,13 +923,13 @@ unsigned avcodec_version( void )
+ 
+ const char *avcodec_configuration(void)
+ {
+-    return FFMPEG_CONFIGURATION;
++    return &quot;avidemux&quot;; //FFMPEG_CONFIGURATION;
+ }
+ 
+ const char *avcodec_license(void)
+ {
+ #define LICENSE_PREFIX &quot;libavcodec license: &quot;
+-    return LICENSE_PREFIX FFMPEG_LICENSE + sizeof(LICENSE_PREFIX) - 1;
++    return LICENSE_PREFIX /*FFMPEG_LICENSE*/ &quot;GPL&quot; + sizeof(LICENSE_PREFIX) - 1;
+ }
+ 
+ void avcodec_init(void)
+@@ -1080,7 +1082,7 @@ int av_tempfile(char *prefix, char **filename) {
+         return -1;
+     }
+ #if !HAVE_MKSTEMP
+-    fd = open(*filename, O_RDWR | O_BINARY | O_CREAT, 0444);
++    fd = open(*filename, O_RDWR /* MEANX | O_BINARY*/ | O_CREAT, 0444);
+ #else
+     snprintf(*filename, len, &quot;/tmp/%sXXXXXX&quot;, prefix);
+     fd = mkstemp(*filename);

Added: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavcodec_x86_mathops.h
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavcodec_x86_mathops.h	2010-05-26 05:26:39 UTC (rev 6236)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavcodec_x86_mathops.h	2010-05-26 05:26:42 UTC (rev 6237)
@@ -0,0 +1,17 @@
+diff --git a/avidemux_core/ADM_ffmpeg/libavcodec/x86/mathops.h b/avidemux_core/ADM_ffmpeg/libavcodec/x86/mathops.h
+index 5949dfe..c7f54c5 100644
+--- a/avidemux_core/ADM_ffmpeg/libavcodec/x86/mathops.h
++++ b/avidemux_core/ADM_ffmpeg/libavcodec/x86/mathops.h
+@@ -22,7 +22,12 @@
+ #ifndef AVCODEC_X86_MATHOPS_H
+ #define AVCODEC_X86_MATHOPS_H
+ 
++// MEANX
++#ifndef ADM_NO_CONFIG_H
+ #include &quot;config.h&quot;
++#endif
++// MEANX
++
+ #include &quot;libavutil/common.h&quot;
+ 
+ #if ARCH_X86_32

Added: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavformat_utils.c.patch
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavformat_utils.c.patch	2010-05-26 05:26:39 UTC (rev 6236)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavformat_utils.c.patch	2010-05-26 05:26:42 UTC (rev 6237)
@@ -0,0 +1,21 @@
+diff --git a/avidemux_core/ADM_ffmpeg/libavformat/utils.c b/avidemux_core/ADM_ffmpeg/libavformat/utils.c
+index 22c833d..e90b609 100644
+--- a/avidemux_core/ADM_ffmpeg/libavformat/utils.c
++++ b/avidemux_core/ADM_ffmpeg/libavformat/utils.c
+@@ -49,13 +49,14 @@ unsigned avformat_version(void)
+ 
+ const char *avformat_configuration(void)
+ {
+-    return FFMPEG_CONFIGURATION;
++    return &quot;avidemux&quot;; //FFMPEG_CONFIGURATION;
+ }
+ 
+ const char *avformat_license(void)
+ {
+ #define LICENSE_PREFIX &quot;libavformat license: &quot;
+-    return LICENSE_PREFIX FFMPEG_LICENSE + sizeof(LICENSE_PREFIX) - 1;
++    //return LICENSE_PREFIX FFMPEG_LICENSE + sizeof(LICENSE_PREFIX) - 1;
++        return LICENSE_PREFIX &quot;GPL&quot;;
+ }
+ 
+ /* fraction handling */

Modified: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavutil_avutil.h.patch
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavutil_avutil.h.patch	2010-05-26 05:26:39 UTC (rev 6236)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavutil_avutil.h.patch	2010-05-26 05:26:42 UTC (rev 6237)
@@ -1,18 +1,18 @@
-*** libavutil/avutil.h.old	Sat Jan 24 22:57:50 2009
---- libavutil/avutil.h	Sat Jan 24 22:57:49 2009
-***************
-*** 26,31 ****
---- 26,38 ----
-   * external API header
-   */
-  
-+ /* MEANX
-+  * - */
-+ #define ASMALIGN(ZEROBITS) &quot;.p2align &quot; #ZEROBITS &quot;\n\t&quot;
-+ /* /MEANX
-+  */
-+ 
-+ 
-  
-  #define AV_STRINGIFY(s)         AV_TOSTRING(s)
-  #define AV_TOSTRING(s) #s
+diff --git a/avidemux_core/ADM_ffmpeg/libavutil/avutil.h b/avidemux_core/ADM_ffmpeg/libavutil/avutil.h
+index 72bd2c5..a81225f 100644
+--- a/avidemux_core/ADM_ffmpeg/libavutil/avutil.h
++++ b/avidemux_core/ADM_ffmpeg/libavutil/avutil.h
+@@ -26,6 +26,13 @@
+  * external API header
+  */
+ 
++/* MEANX
++ * - */
++#define ASMALIGN(ZEROBITS) &quot;.p2align &quot; #ZEROBITS &quot;\n\t&quot;
++/* /MEANX
++ */
++
++
+ 
+ #define AV_STRINGIFY(s)         AV_TOSTRING(s)
+ #define AV_TOSTRING(s) #s

Added: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavutil_bswap.h.patch
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavutil_bswap.h.patch	2010-05-26 05:26:39 UTC (rev 6236)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavutil_bswap.h.patch	2010-05-26 05:26:42 UTC (rev 6237)
@@ -0,0 +1,16 @@
+diff --git a/avidemux_core/ADM_ffmpeg/libavutil/bswap.h b/avidemux_core/ADM_ffmpeg/libavutil/bswap.h
+index 6dd2a35..f7a422c 100644
+--- a/avidemux_core/ADM_ffmpeg/libavutil/bswap.h
++++ b/avidemux_core/ADM_ffmpeg/libavutil/bswap.h
+@@ -27,7 +27,11 @@
+ #define AVUTIL_BSWAP_H
+ 
+ #include &lt;stdint.h&gt;
++// MEANX
++#ifndef ADM_NO_CONFIG_H
+ #include &quot;config.h&quot;
++#endif
++// /MEANX
+ #include &quot;attributes.h&quot;
+ 
+ #if   ARCH_ARM

Modified: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavutil_internal.h.patch
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavutil_internal.h.patch	2010-05-26 05:26:39 UTC (rev 6236)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavutil_internal.h.patch	2010-05-26 05:26:42 UTC (rev 6237)
@@ -1,19 +1,49 @@
-*** libavutil/internal.h.old	Sat Feb 21 16:11:15 2009
---- libavutil/internal.h	Sat Feb 21 16:11:15 2009
-***************
-*** 215,226 ****
---- 215,228 ----
-  #endif
-  
-  /* avoid usage of dangerous/inappropriate system functions */
-+ #if 0 //MEANX
-  #undef  malloc
-  #define malloc please_use_av_malloc
-  #undef  free
-  #define free please_use_av_free
-  #undef  realloc
-  #define realloc please_use_av_realloc
-+ #endif
-  #undef  time
-  #define time time_is_forbidden_due_to_security_issues
-  #undef  rand
+diff --git a/avidemux_core/ADM_ffmpeg/libavutil/internal.h b/avidemux_core/ADM_ffmpeg/libavutil/internal.h
+index 2faafc9..8516159 100644
+--- a/avidemux_core/ADM_ffmpeg/libavutil/internal.h
++++ b/avidemux_core/ADM_ffmpeg/libavutil/internal.h
+@@ -34,7 +34,11 @@
+ #include &lt;stdint.h&gt;
+ #include &lt;stddef.h&gt;
+ #include &lt;assert.h&gt;
++//MEANX
++#ifndef ADM_NO_CONFIG_H
+ #include &quot;config.h&quot;
++#endif
++// /MEANX
+ #include &quot;attributes.h&quot;
+ #include &quot;timer.h&quot;
+ 
+@@ -95,6 +99,8 @@
+ #endif
+ 
+ /* Use to export labels from asm. */
++#include &quot;ADM_mangle.h&quot;
++#if 0 // MEANX
+ #define LABEL_MANGLE(a) EXTERN_PREFIX #a
+ 
+ // Use rip-relative addressing if compiling PIC code on x86-64.
+@@ -105,7 +111,7 @@
+ #endif
+ 
+ #define MANGLE(a) EXTERN_PREFIX LOCAL_MANGLE(a)
+-
++#endif // MEANX
+ /* debug stuff */
+ 
+ /* dprintf macros */
+@@ -134,12 +140,14 @@
+ #endif
+ 
+ /* avoid usage of dangerous/inappropriate system functions */
++#if 0 //MEANX
+ #undef  malloc
+ #define malloc please_use_av_malloc
+ #undef  free
+ #define free please_use_av_free
+ #undef  realloc
+ #define realloc please_use_av_realloc
++#endif
+ #undef  time
+ #define time time_is_forbidden_due_to_security_issues
+ #undef  rand

Added: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavutil_intreadwrite.h.patch
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavutil_intreadwrite.h.patch	2010-05-26 05:26:39 UTC (rev 6236)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavutil_intreadwrite.h.patch	2010-05-26 05:26:42 UTC (rev 6237)
@@ -0,0 +1,17 @@
+diff --git a/avidemux_core/ADM_ffmpeg/libavutil/intreadwrite.h b/avidemux_core/ADM_ffmpeg/libavutil/intreadwrite.h
+index c8026f0..272a3b1 100644
+--- a/avidemux_core/ADM_ffmpeg/libavutil/intreadwrite.h
++++ b/avidemux_core/ADM_ffmpeg/libavutil/intreadwrite.h
+@@ -20,7 +20,12 @@
+ #define AVUTIL_INTREADWRITE_H
+ 
+ #include &lt;stdint.h&gt;
++// MEANX
++#ifndef ADM_NO_CONFIG_H
+ #include &quot;config.h&quot;
++#endif
++// MEANX
++
+ #include &quot;bswap.h&quot;
+ #include &quot;common.h&quot;
+ 

Deleted: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavutil_lfg.patch
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavutil_lfg.patch	2010-05-26 05:26:39 UTC (rev 6236)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavutil_lfg.patch	2010-05-26 05:26:42 UTC (rev 6237)
@@ -1,31 +0,0 @@
-diff --git a/avidemux_core/ADM_ffmpeg/libavutil/lfg.c b/avidemux_core/ADM_ffmpeg/libavutil/lfg.c
-index e876d18..8729bfc 100644
---- a/avidemux_core/ADM_ffmpeg/libavutil/lfg.c
-+++ b/avidemux_core/ADM_ffmpeg/libavutil/lfg.c
-@@ -23,7 +23,7 @@
- #include &quot;lfg.h&quot;
- #include &quot;md5.h&quot;
- #include &quot;intreadwrite.h&quot;
--
-+#undef index //MEANS
- void av_cold av_lfg_init(AVLFG *c, unsigned int seed){
-     uint8_t tmp[16]={0};
-     int i;
-diff --git a/avidemux_core/ADM_ffmpeg/patches/libavutil_lfg.patch b/avidemux_core/ADM_ffmpeg/patches/libavutil_lfg.patch
-index 0596b37..e69de29 100644
---- a/avidemux_core/ADM_ffmpeg/patches/libavutil_lfg.patch
-+++ b/avidemux_core/ADM_ffmpeg/patches/libavutil_lfg.patch
-@@ -1,13 +0,0 @@
--diff --git a/avidemux/ADM_libraries/ADM_ffmpeg/libavutil/lfg.c b/avidemux/ADM_libraries/ADM_ffmpeg/libavutil/lfg.c
--index e876d18..ff6a888 100644
----- a/avidemux/ADM_libraries/ADM_ffmpeg/libavutil/lfg.c
--+++ b/avidemux/ADM_libraries/ADM_ffmpeg/libavutil/lfg.c
--@@ -23,7 +23,7 @@
-- #include &quot;lfg.h&quot;
-- #include &quot;md5.h&quot;
-- #include &quot;intreadwrite.h&quot;
---
--+#undef index
-- void av_cold av_lfg_init(AVLFG *c, unsigned int seed){
--     uint8_t tmp[16]={0};
--     int i;

Added: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavutil_libm.h.patch
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavutil_libm.h.patch	2010-05-26 05:26:39 UTC (rev 6236)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavutil_libm.h.patch	2010-05-26 05:26:42 UTC (rev 6237)
@@ -0,0 +1,16 @@
+diff --git a/avidemux_core/ADM_ffmpeg/libavutil/libm.h b/avidemux_core/ADM_ffmpeg/libavutil/libm.h
+index c7c28ac..3f6ae07 100644
+--- a/avidemux_core/ADM_ffmpeg/libavutil/libm.h
++++ b/avidemux_core/ADM_ffmpeg/libavutil/libm.h
+@@ -25,7 +25,11 @@
+ #define AVUTIL_LIBM_H
+ 
+ #include &lt;math.h&gt;
++//MEANX
++#ifndef ADM_NO_CONFIG_H
+ #include &quot;config.h&quot;
++#endif
++///MEANX
+ #include &quot;attributes.h&quot;
+ 
+ #if !HAVE_EXP2

Modified: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavutil_mem.c.patch
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavutil_mem.c.patch	2010-05-26 05:26:39 UTC (rev 6236)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavutil_mem.c.patch	2010-05-26 05:26:42 UTC (rev 6237)
@@ -1,202 +1,182 @@
-*** libavutil/mem.c.old	Wed Apr  1 18:35:44 2009
---- libavutil/mem.c	Wed Apr  1 18:35:44 2009
-***************
-*** 46,132 ****
-  
-  void *av_malloc(unsigned int size)
-  {
-!     void *ptr = NULL;
-! #if CONFIG_MEMALIGN_HACK
-!     long diff;
-! #endif
-  
-!     /* let's disallow possible ambiguous cases */
-!     if(size &gt; (INT_MAX-16) )
-!         return NULL;
-! 
-! #if CONFIG_MEMALIGN_HACK
-!     ptr = malloc(size+16);
-!     if(!ptr)
-!         return ptr;
-!     diff= ((-(long)ptr - 1)&amp;15) + 1;
-!     ptr = (char*)ptr + diff;
-!     ((char*)ptr)[-1]= diff;
-! #elif HAVE_POSIX_MEMALIGN
-!     if (posix_memalign(&amp;ptr,16,size))
-!         ptr = NULL;
-! #elif HAVE_MEMALIGN
-!     ptr = memalign(16,size);
-!     /* Why 64?
-!        Indeed, we should align it:
-!          on 4 for 386
-!          on 16 for 486
-!          on 32 for 586, PPro - K6-III
-!          on 64 for K7 (maybe for P3 too).
-!        Because L1 and L2 caches are aligned on those values.
-!        But I don't want to code such logic here!
-!      */
-!      /* Why 16?
-!         Because some CPUs need alignment, for example SSE2 on P4, &amp; most RISC CPUs
-!         it will just trigger an exception and the unaligned load will be done in the
-!         exception handler or it will just segfault (SSE2 on P4).
-!         Why not larger? Because I did not see a difference in benchmarks ...
-!      */
-!      /* benchmarks with P3
-!         memalign(64)+1          3071,3051,3032
-!         memalign(64)+2          3051,3032,3041
-!         memalign(64)+4          2911,2896,2915
-!         memalign(64)+8          2545,2554,2550
-!         memalign(64)+16         2543,2572,2563
-!         memalign(64)+32         2546,2545,2571
-!         memalign(64)+64         2570,2533,2558
-  
-!         BTW, malloc seems to do 8-byte alignment by default here.
-!      */
-! #else
-!     ptr = malloc(size);
-  #endif
--     return ptr;
-  }
-  
-! void *av_realloc(void *ptr, unsigned int size)
-  {
-! #if CONFIG_MEMALIGN_HACK
-!     int diff;
-! #endif
-  
-!     /* let's disallow possible ambiguous cases */
-!     if(size &gt; (INT_MAX-16) )
-!         return NULL;
-! 
-! #if CONFIG_MEMALIGN_HACK
-!     //FIXME this isn't aligned correctly, though it probably isn't needed
-!     if(!ptr) return av_malloc(size);
-!     diff= ((char*)ptr)[-1];
-!     return (char*)realloc((char*)ptr - diff, size + diff) + diff;
-  #else
-!     return realloc(ptr, size);
-  #endif
-  }
-  
-  void av_free(void *ptr)
-  {
-!     /* XXX: this test should not be needed on most libcs */
-!     if (ptr)
-! #if CONFIG_MEMALIGN_HACK
-!         free((char*)ptr - ((char*)ptr)[-1]);
-  #else
-!         free(ptr);
-  #endif
-  }
-  
---- 46,155 ----
-  
-  void *av_malloc(unsigned int size)
-  {
-! #ifdef __APPLE__
-! 	return malloc(size);
-! #else
-! 	char *c;
-  
-! 	uint64_t l, lorg;
-! 	uint32_t *backdoor;
-  
-! 	l = (uint64_t)malloc(size + 32);
-! 
-! 	// Get next boundary
-! 	lorg = l;
-! 	l = (l + 15) &amp; 0xfffffffffffffff0LL;
-! 	l += 16;
-! 	c = (char*)l;
-! 	backdoor = (uint32_t*)(c - 8);
-! 	*backdoor = (0xdead &lt;&lt; 16) + l - lorg;
-! 	backdoor[1] = size;
-! 
-! 	return c;
-  #endif
-  }
-  
-! void *av_realloc(void *ptr, unsigned int newsize)
-  {
-! #ifdef __APPLE__
-! 	if (!ptr)
-! 		return av_malloc(newsize);
-! 
-! 	if (!newsize)
-! 	{
-! 		av_free(ptr);
-! 		return NULL;
-! 	}
-  
-! 	return realloc(ptr, newsize);
-  #else
-! 	void *nalloc;
-! 
-! 	if (!ptr)
-! 		return av_malloc(newsize);
-! 
-! 	if (!newsize) 
-! 	{
-! 		av_free(ptr);
-! 		return NULL;
-! 	}
-! 
-! 	// now we either shrink them or expand them
-! 	// in case of shrink, we do nothing
-! 	// in case of expand we have to copy
-! 	// Do copy everytime (slower)
-! 	uint32_t *backdoor;
-! 	uint32_t size, offset;
-! 	char *c = (char*)ptr;
-! 
-! 	backdoor = (uint32_t*)ptr;
-! 	backdoor -= 2;
-! 
-! 	assert(((*backdoor) &gt;&gt; 16) == 0xdead);
-! 
-! 	offset = backdoor[0] &amp; 0xffff;
-! 	size = backdoor[1];
-! 
-! 	if(size &gt;= newsize) // do nothing
-! 		return ptr;
-! 
-! 	// Allocate a new one
-! 	nalloc = av_malloc(newsize);
-! 	memcpy(nalloc, ptr, size);
-! 	av_free(ptr);
-! 
-! 	return nalloc;
-  #endif
-  }
-  
-  void av_free(void *ptr)
-  {
-! #ifdef __APPLE__
-! 	if (!ptr)
-! 		return;
-! 
-! 	free(ptr);
-  #else
-! 	uint32_t *backdoor;
-! 	uint32_t size, offset;
-! 	char *c = (char*)ptr;
-! 
-! 	if (!ptr)
-! 		return;
-! 
-! 	backdoor = (uint32_t*)ptr;
-! 	backdoor -= 2;
-! 
-! 	if (*backdoor == 0xbeefbeef)
-! 		assert(0);
-! 
-! 	assert(((*backdoor) &gt;&gt; 16) == 0xdead);
-! 
-! 	offset = backdoor[0] &amp; 0xffff;
-! 	size = backdoor[1];
-! 	*backdoor = 0xbeefbeef; // Scratch sig
-! 
-! 	free(c - offset);
-  #endif
-  }
-  
+diff --git a/avidemux_core/ADM_ffmpeg/libavutil/mem.c b/avidemux_core/ADM_ffmpeg/libavutil/mem.c
+index 8cad089..8e95a78 100644
+--- a/avidemux_core/ADM_ffmpeg/libavutil/mem.c
++++ b/avidemux_core/ADM_ffmpeg/libavutil/mem.c
+@@ -63,87 +63,110 @@ void  free(void *ptr);
+ 
+ void *av_malloc(unsigned int size)
+ {
+-    void *ptr = NULL;
+-#if CONFIG_MEMALIGN_HACK
+-    long diff;
+-#endif
+-
+-    /* let's disallow possible ambiguous cases */
+-    if(size &gt; (INT_MAX-16) )
+-        return NULL;
+-
+-#if CONFIG_MEMALIGN_HACK
+-    ptr = malloc(size+16);
+-    if(!ptr)
+-        return ptr;
+-    diff= ((-(long)ptr - 1)&amp;15) + 1;
+-    ptr = (char*)ptr + diff;
+-    ((char*)ptr)[-1]= diff;
+-#elif HAVE_POSIX_MEMALIGN
+-    if (posix_memalign(&amp;ptr,16,size))
+-        ptr = NULL;
+-#elif HAVE_MEMALIGN
+-    ptr = memalign(16,size);
+-    /* Why 64?
+-       Indeed, we should align it:
+-         on 4 for 386
+-         on 16 for 486
+-         on 32 for 586, PPro - K6-III
+-         on 64 for K7 (maybe for P3 too).
+-       Because L1 and L2 caches are aligned on those values.
+-       But I don't want to code such logic here!
+-     */
+-     /* Why 16?
+-        Because some CPUs need alignment, for example SSE2 on P4, &amp; most RISC CPUs
+-        it will just trigger an exception and the unaligned load will be done in the
+-        exception handler or it will just segfault (SSE2 on P4).
+-        Why not larger? Because I did not see a difference in benchmarks ...
+-     */
+-     /* benchmarks with P3
+-        memalign(64)+1          3071,3051,3032
+-        memalign(64)+2          3051,3032,3041
+-        memalign(64)+4          2911,2896,2915
+-        memalign(64)+8          2545,2554,2550
+-        memalign(64)+16         2543,2572,2563
+-        memalign(64)+32         2546,2545,2571
+-        memalign(64)+64         2570,2533,2558
+-
+-        BTW, malloc seems to do 8-byte alignment by default here.
+-     */
++#ifdef __APPLE__
++	return malloc(size);
+ #else
+-    ptr = malloc(size);
++	char *c;
++
++	uint64_t l, lorg;
++	uint32_t *backdoor;
++
++	l = (uint64_t)malloc(size + 32);
++
++	// Get next boundary
++	lorg = l;
++	l = (l + 15) &amp; 0xfffffffffffffff0LL;
++	l += 16;
++	c = (char*)l;
++	backdoor = (uint32_t*)(c - 8);
++	*backdoor = (0xdead &lt;&lt; 16) + l - lorg;
++	backdoor[1] = size;
++
++	return c;
+ #endif
+-    return ptr;
+ }
+ 
+-void *av_realloc(void *ptr, unsigned int size)
++void *av_realloc(void *ptr, unsigned int newsize)
+ {
+-#if CONFIG_MEMALIGN_HACK
+-    int diff;
+-#endif
++#ifdef __APPLE__
++	if (!ptr)
++		return av_malloc(newsize);
+ 
+-    /* let's disallow possible ambiguous cases */
+-    if(size &gt; (INT_MAX-16) )
+-        return NULL;
++	if (!newsize)
++	{
++		av_free(ptr);
++		return NULL;
++	}
+ 
+-#if CONFIG_MEMALIGN_HACK
+-    //FIXME this isn't aligned correctly, though it probably isn't needed
+-    if(!ptr) return av_malloc(size);
+-    diff= ((char*)ptr)[-1];
+-    return (char*)realloc((char*)ptr - diff, size + diff) + diff;
++	return realloc(ptr, newsize);
+ #else
+-    return realloc(ptr, size);
++	void *nalloc;
++
++	if (!ptr)
++		return av_malloc(newsize);
++
++	if (!newsize) 
++	{
++		av_free(ptr);
++		return NULL;
++	}
++
++	// now we either shrink them or expand them
++	// in case of shrink, we do nothing
++	// in case of expand we have to copy
++	// Do copy everytime (slower)
++	uint32_t *backdoor;
++	uint32_t size, offset;
++	char *c = (char*)ptr;
++
++	backdoor = (uint32_t*)ptr;
++	backdoor -= 2;
++
++	assert(((*backdoor) &gt;&gt; 16) == 0xdead);
++
++	offset = backdoor[0] &amp; 0xffff;
++	size = backdoor[1];
++
++	if(size &gt;= newsize) // do nothing
++		return ptr;
++
++	// Allocate a new one
++	nalloc = av_malloc(newsize);
++	memcpy(nalloc, ptr, size);
++	av_free(ptr);
++
++	return nalloc;
+ #endif
+ }
+ 
+ void av_free(void *ptr)
+ {
+-    /* XXX: this test should not be needed on most libcs */
+-    if (ptr)
+-#if CONFIG_MEMALIGN_HACK
+-        free((char*)ptr - ((char*)ptr)[-1]);
++#ifdef __APPLE__
++	if (!ptr)
++		return;
++
++	free(ptr);
+ #else
+-        free(ptr);
++	uint32_t *backdoor;
++	uint32_t size, offset;
++	char *c = (char*)ptr;
++
++	if (!ptr)
++		return;
++
++	backdoor = (uint32_t*)ptr;
++	backdoor -= 2;
++
++	if (*backdoor == 0xbeefbeef)
++		assert(0);
++
++	assert(((*backdoor) &gt;&gt; 16) == 0xdead);
++
++	offset = backdoor[0] &amp; 0xffff;
++	size = backdoor[1];
++	*backdoor = 0xbeefbeef; // Scratch sig
++
++	free(c - offset);
+ #endif
+ }
+ 

Added: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavutil_timer.h.patch
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavutil_timer.h.patch	2010-05-26 05:26:39 UTC (rev 6236)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavutil_timer.h.patch	2010-05-26 05:26:42 UTC (rev 6237)
@@ -0,0 +1,17 @@
+diff --git a/avidemux_core/ADM_ffmpeg/libavutil/timer.h b/avidemux_core/ADM_ffmpeg/libavutil/timer.h
+index cd8fba8..66be371 100644
+--- a/avidemux_core/ADM_ffmpeg/libavutil/timer.h
++++ b/avidemux_core/ADM_ffmpeg/libavutil/timer.h
+@@ -26,7 +26,12 @@
+ 
+ #include &lt;stdlib.h&gt;
+ #include &lt;stdint.h&gt;
++// MEANX
++#ifndef ADM_NO_CONFIG_H
+ #include &quot;config.h&quot;
++#endif
++// MEANX
++
+ 
+ #if   ARCH_ARM
+ #   include &quot;arm/timer.h&quot;

Added: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavutil_x86_bswap.h
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavutil_x86_bswap.h	2010-05-26 05:26:39 UTC (rev 6236)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavutil_x86_bswap.h	2010-05-26 05:26:42 UTC (rev 6237)
@@ -0,0 +1,16 @@
+diff --git a/avidemux_core/ADM_ffmpeg/libavutil/x86/bswap.h b/avidemux_core/ADM_ffmpeg/libavutil/x86/bswap.h
+index 26dc4e2..c7a87dd 100644
+--- a/avidemux_core/ADM_ffmpeg/libavutil/x86/bswap.h
++++ b/avidemux_core/ADM_ffmpeg/libavutil/x86/bswap.h
+@@ -25,7 +25,11 @@
+ #define AVUTIL_X86_BSWAP_H
+ 
+ #include &lt;stdint.h&gt;
++// MEANX
++#ifndef ADM_NO_CONFIG_H
+ #include &quot;config.h&quot;
++#endif
++// /MEANX
+ #include &quot;libavutil/attributes.h&quot;
+ 
+ #define bswap_16 bswap_16

Added: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavutil_x86_intreadwrite.h
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavutil_x86_intreadwrite.h	2010-05-26 05:26:39 UTC (rev 6236)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavutil_x86_intreadwrite.h	2010-05-26 05:26:42 UTC (rev 6237)
@@ -0,0 +1,16 @@
+diff --git a/avidemux_core/ADM_ffmpeg/libavutil/x86/intreadwrite.h b/avidemux_core/ADM_ffmpeg/libavutil/x86/intreadwrite.h
+index 4061d19..4740886 100644
+--- a/avidemux_core/ADM_ffmpeg/libavutil/x86/intreadwrite.h
++++ b/avidemux_core/ADM_ffmpeg/libavutil/x86/intreadwrite.h
+@@ -22,7 +22,11 @@
+ #define AVUTIL_X86_INTREADWRITE_H
+ 
+ #include &lt;stdint.h&gt;
++// MEANX
++#ifndef ADM_NO_CONFIG_H
+ #include &quot;config.h&quot;
++#endif
++/// MEANX
+ #include &quot;libavutil/attributes.h&quot;
+ 
+ #if HAVE_MMX

Deleted: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/timer_h.patch
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/timer_h.patch	2010-05-26 05:26:39 UTC (rev 6236)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/timer_h.patch	2010-05-26 05:26:42 UTC (rev 6237)
@@ -1,17 +0,0 @@
-diff --git a/avidemux/ADM_libraries/ADM_ffmpeg/libavutil/timer.h b/avidemux/ADM_libraries/ADM_ffmpeg/libavutil/timer.h
-index db0abae..6be1e88 100644
---- libavutil/timer.h
-+++ libavutil/timer.h
-@@ -26,7 +26,12 @@
- 
- #include &lt;stdlib.h&gt;
- #include &lt;stdint.h&gt;
-+// MEANX
-+#ifndef ADM_NO_CONFIG_H
- #include &quot;config.h&quot;
-+#endif
-+// MEANX
-+
- 
- #if   ARCH_ARM
- #   include &quot;arm/timer.h&quot;

Deleted: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/x86_bswap_h.patch
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/x86_bswap_h.patch	2010-05-26 05:26:39 UTC (rev 6236)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/x86_bswap_h.patch	2010-05-26 05:26:42 UTC (rev 6237)
@@ -1,17 +0,0 @@
-diff --git a/avidemux/ADM_libraries/ADM_ffmpeg/libavutil/x86/bswap.h b/avidemux/ADM_libraries/ADM_ffmpeg/libavutil/x86/bswap.h
-index 3eeb5a4..82626f2 100644
---- libavutil/x86/bswap.h
-+++ libavutil/x86/bswap.h
-@@ -25,7 +25,12 @@
- #define AVUTIL_X86_BSWAP_H
- 
- #include &lt;stdint.h&gt;
-+// MEANX
-+#ifndef ADM_NO_CONFIG_H
- #include &quot;config.h&quot;
-+#endif
-+// MEANX
-+
- #include &quot;libavutil/common.h&quot;
- 
- #define bswap_16 bswap_16

Deleted: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/x86_mathops_h.patch
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/x86_mathops_h.patch	2010-05-26 05:26:39 UTC (rev 6236)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/x86_mathops_h.patch	2010-05-26 05:26:42 UTC (rev 6237)
@@ -1,17 +0,0 @@
-diff --git a/avidemux/ADM_libraries/ADM_ffmpeg/libavcodec/x86/mathops.h b/avidemux/ADM_libraries/ADM_ffmpeg/libavcodec/x86/mathops.h
-index a66c601..d8257f0 100644
---- libavcodec/x86/mathops.h
-+++ libavcodec/x86/mathops.h
-@@ -22,7 +22,12 @@
- #ifndef AVCODEC_X86_MATHOPS_H
- #define AVCODEC_X86_MATHOPS_H
- 
-+// MEANX
-+#ifndef ADM_NO_CONFIG_H
- #include &quot;config.h&quot;
-+#endif
-+// MEANX
-+
- #include &quot;libavutil/common.h&quot;
- 
- #if ARCH_X86_32


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="003432.html">[Avidemux-svn-commit] r6236 -	branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavcodec
</A></li>
	<LI>Next message: <A HREF="003434.html">[Avidemux-svn-commit] r6238 - in	branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libswscale:	. x86
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#3433">[ date ]</a>
              <a href="thread.html#3433">[ thread ]</a>
              <a href="subject.html#3433">[ subject ]</a>
              <a href="author.html#3433">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/avidemux-svn-commit">More information about the Avidemux-svn-commit
mailing list</a><br>
</body></html>
