<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Avidemux-svn-commit] r5201 - in branches/avidemux_2.6_branch_mean:	. avidemux avidemux/gtk avidemux/qt4 avidemux_core	avidemux_core/ADM_coreAudioParser/src	avidemux_core/ADM_ffmpeg/libavcodec cmake foreignBuilds
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/avidemux-svn-commit/2009-August/index.html" >
   <LINK REL="made" HREF="mailto:avidemux-svn-commit%40lists.berlios.de?Subject=Re%3A%20%5BAvidemux-svn-commit%5D%20r5201%20-%20in%20branches/avidemux_2.6_branch_mean%3A%0A%09.%20avidemux%20avidemux/gtk%20avidemux/qt4%20avidemux_core%0A%09avidemux_core/ADM_coreAudioParser/src%0A%09avidemux_core/ADM_ffmpeg/libavcodec%20cmake%20foreignBuilds&In-Reply-To=%3C200908031710.n73HAZuT002194%40sheep.berlios.de%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="002414.html">
   <LINK REL="Next"  HREF="002416.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Avidemux-svn-commit] r5201 - in branches/avidemux_2.6_branch_mean:	. avidemux avidemux/gtk avidemux/qt4 avidemux_core	avidemux_core/ADM_coreAudioParser/src	avidemux_core/ADM_ffmpeg/libavcodec cmake foreignBuilds</H1>
    <B>mean at BerliOS</B> 
    <A HREF="mailto:avidemux-svn-commit%40lists.berlios.de?Subject=Re%3A%20%5BAvidemux-svn-commit%5D%20r5201%20-%20in%20branches/avidemux_2.6_branch_mean%3A%0A%09.%20avidemux%20avidemux/gtk%20avidemux/qt4%20avidemux_core%0A%09avidemux_core/ADM_coreAudioParser/src%0A%09avidemux_core/ADM_ffmpeg/libavcodec%20cmake%20foreignBuilds&In-Reply-To=%3C200908031710.n73HAZuT002194%40sheep.berlios.de%3E"
       TITLE="[Avidemux-svn-commit] r5201 - in branches/avidemux_2.6_branch_mean:	. avidemux avidemux/gtk avidemux/qt4 avidemux_core	avidemux_core/ADM_coreAudioParser/src	avidemux_core/ADM_ffmpeg/libavcodec cmake foreignBuilds">mean at mail.berlios.de
       </A><BR>
    <I>Mon Aug  3 19:10:35 CEST 2009</I>
    <P><UL>
        <LI>Previous message: <A HREF="002414.html">[Avidemux-svn-commit] r5200 - in	branches/avidemux_2.5_branch_gruntster: avidemux/ADM_encoder	avidemux/ADM_outputs/oplug_mpegFF	plugins/ADM_videoEncoder/ADM_vidEnc_avcodec
</A></li>
        <LI>Next message: <A HREF="002416.html">[Avidemux-svn-commit] r5202 - in branches/avidemux_2.6_branch_mean:	avidemux avidemux/gtk avidemux/qt4 avidemux_core	avidemux_plugins cmake foreignBuilds
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2415">[ date ]</a>
              <a href="thread.html#2415">[ thread ]</a>
              <a href="subject.html#2415">[ subject ]</a>
              <a href="author.html#2415">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Author: mean
Date: 2009-08-03 19:10:30 +0200 (Mon, 03 Aug 2009)
New Revision: 5201

Added:
   branches/avidemux_2.6_branch_mean/bootStrapCrossMingw.sh
   branches/avidemux_2.6_branch_mean/cmake/admCrossCompile.cmake
   branches/avidemux_2.6_branch_mean/cmake/admCrossQt4.cmake
   branches/avidemux_2.6_branch_mean/cmake/admMainChecks.cmake
   branches/avidemux_2.6_branch_mean/foreignBuilds/
   branches/avidemux_2.6_branch_mean/foreignBuilds/cross_mingw_core
   branches/avidemux_2.6_branch_mean/foreignBuilds/cross_mingw_plugins
   branches/avidemux_2.6_branch_mean/foreignBuilds/cross_mingw_qt4
Modified:
   branches/avidemux_2.6_branch_mean/avidemux/commonCmakeApplication.cmake
   branches/avidemux_2.6_branch_mean/avidemux/gtk/CMakeLists.txt
   branches/avidemux_2.6_branch_mean/avidemux/qt4/CMakeLists.txt
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreAudioParser/src/CMakeLists.txt
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavcodec/CMakeLists.txt
   branches/avidemux_2.6_branch_mean/avidemux_core/CMakeLists.txt
   branches/avidemux_2.6_branch_mean/cmake/admCheckLibxml2.cmake
   branches/avidemux_2.6_branch_mean/cmake/admCheckMiscLibs.cmake
   branches/avidemux_2.6_branch_mean/cmake/admCheckQt4.cmake
   branches/avidemux_2.6_branch_mean/cmake/admCheckRequiredLibs.cmake
   branches/avidemux_2.6_branch_mean/cmake/admConfigHelper.cmake
Log:
Squashed commit of the following:

commit e2bf06645c5da2ec29a37ef5517eb725776462fd
Author: fx &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/avidemux-svn-commit">fx at quad.</A>(none)&gt;
Date:   Sun Aug 2 18:00:25 2009 +0200

    [build] cleaner configuration of cross script

commit 5237cb74032a14a2377346c3d34570d4073e5209
Author: fx &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/avidemux-svn-commit">fx at quad.</A>(none)&gt;
Date:   Sun Aug 2 17:54:17 2009 +0200

    [build] Working cross mingw bootstrap

commit f3946455e4e1eccb8a69e14178d8420d6b4f8119
Author: fx &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/avidemux-svn-commit">fx at quad.</A>(none)&gt;
Date:   Sun Aug 2 17:37:49 2009 +0200

    [build] Add a bootStrapCrossMingw.sh file that cross compile to win32. Update the cross setup scripts

commit b9470abdaba8de27fb099f5162caa008a1859d3f
Author: fx &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/avidemux-svn-commit">fx at quad.</A>(none)&gt;
Date:   Sun Aug 2 17:37:19 2009 +0200

    [build] Use host Qt4 tools but link with target qt4 (cross compil)

commit 8b5751b52279d7905657d729799c22fa90b3cb59
Author: fx &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/avidemux-svn-commit">fx at quad.</A>(none)&gt;
Date:   Sun Aug 2 17:37:10 2009 +0200

    [build] Use host Qt4 tools but link with target qt4 (cross compil)

commit f17ff1353cd5d9b3927c0681134347a761090b0a
Author: fx &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/avidemux-svn-commit">fx at quad.</A>(none)&gt;
Date:   Sun Aug 2 16:55:57 2009 +0200

    [build] Cross mingw script for plugins

commit 4f36240185fad12f8ce0722f477c3fddcbbece51
Author: fx &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/avidemux-svn-commit">fx at quad.</A>(none)&gt;
Date:   Sun Aug 2 16:54:41 2009 +0200

    [build] Use cmake 2.4 policy everywhere

commit 8ef812d2b73c524912bfe353753138303f4e6eff
Author: fx &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/avidemux-svn-commit">fx at quad.</A>(none)&gt;
Date:   Sun Aug 2 16:54:26 2009 +0200

    [ffmpeg] Remove duplicate ac3_parser

commit 2ff59c5c7628b7706e9e5037b4743840b0dcce07
Author: fx &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/avidemux-svn-commit">fx at quad.</A>(none)&gt;
Date:   Sun Aug 2 16:13:06 2009 +0200

    [build] Fix policy else GUI_glade have -D path wrongly escaped

commit 9ad59509a9919ad6c1cd675ad33feb26a9b3d69d
Author: fx &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/avidemux-svn-commit">fx at quad.</A>(none)&gt;
Date:   Sun Aug 2 16:03:52 2009 +0200

    [build] fix build (need OFFSET64)

commit f7f76f5ea367dc358ae7948faad1f03676895372
Author: fx &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/avidemux-svn-commit">fx at quad.</A>(none)&gt;
Date:   Sun Aug 2 15:59:16 2009 +0200

    [build] Factorize cmake checks

commit 1234f11760daff1d367dc4837fcdd8f8f0fa134c
Author: fx &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/avidemux-svn-commit">fx at quad.</A>(none)&gt;
Date:   Sun Aug 2 15:49:04 2009 +0200

    [build] Factorize cmake stuff between components

commit 39942de655df9bed2f6ef8520a0e704ad6a406ae
Author: fx &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/avidemux-svn-commit">fx at quad.</A>(none)&gt;
Date:   Sun Aug 2 15:48:29 2009 +0200

    [build] rename them to cross- when we cross compile

commit 9535d3eede6f6d575006ba62713a04d911d25f00
Author: fx &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/avidemux-svn-commit">fx at quad.</A>(none)&gt;
Date:   Sun Aug 2 15:47:40 2009 +0200

    [build] Add X-Compile file

commit 27097e3a76236ca8d31319c56c26e071bcae91bf
Author: fx &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/avidemux-svn-commit">fx at quad.</A>(none)&gt;
Date:   Sun Aug 2 15:11:10 2009 +0200

    [build] Mingw cross compile, ok for core, not ok for qt4

commit 625b3a786935398e07940f35ec5c67fc15189d4b
Author: fx &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/avidemux-svn-commit">fx at quad.</A>(none)&gt;
Date:   Sun Aug 2 14:14:36 2009 +0200

    [build] Cross compile win32 from linux tweaks

Modified: branches/avidemux_2.6_branch_mean/avidemux/commonCmakeApplication.cmake
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/commonCmakeApplication.cmake	2009-08-03 16:33:52 UTC (rev 5200)
+++ branches/avidemux_2.6_branch_mean/avidemux/commonCmakeApplication.cmake	2009-08-03 17:10:30 UTC (rev 5201)
@@ -1,90 +1,26 @@
 #
 #
-#
-SET(VERSION 2.6.0)
-CMAKE_MINIMUM_REQUIRED(VERSION 2.4.7 FATAL_ERROR)
-
+cmake_minimum_required(VERSION 2.6)
 if (COMMAND cmake_policy)
 	cmake_policy(VERSION 2.4)
 	cmake_policy(SET CMP0003 NEW)
+	cmake_policy(SET CMP0011 OLD)
 endif (COMMAND cmake_policy)
 ########################################
 # Definitions and Includes
 ########################################
-ADD_DEFINITIONS(-D_FILE_OFFSET_BITS=64 -D_LARGE_FILES)
-ADD_DEFINITIONS(-DHAVE_CONFIG_H)
-########################################
-# Where is the config.h dir
-########################################
-#
-# Access to our cmake lib
-#
 if(NOT PLUGINS)
         SET(AVIDEMUX_TOP_SOURCE_DIR ${CMAKE_SOURCE_DIR}/../..)
 endif(NOT PLUGINS)
 SET(CMAKE_MODULE_PATH &quot;${AVIDEMUX_TOP_SOURCE_DIR}/cmake&quot; &quot;${CMAKE_MODULE_PATH}&quot;)
-MESSAGE(STATUS &quot;Avidemux cmake scripts are in ${CMAKE_MODULE_PATH}&quot;)
-#
-#
-#
-
-IF (ADM_DEBUG)
-	ADD_DEFINITIONS(-DADM_DEBUG)
-ENDIF (ADM_DEBUG)
-###########################################
-#  Basic cmake helper script
-###########################################
-include(admConfigHelper)
-
 ########################################
-# Avidemux system specific tweaks
+# Shared cmake part
 ########################################
-INCLUDE(admDetermineSystem)
-
-IF (CYGWIN)
-	SET(CMAKE_C_FLAGS &quot;${CMAKE_C_FLAGS} -mwin32&quot;)
-	SET(CMAKE_CXX_FLAGS &quot;${CMAKE_CXX_FLAGS} -mwin32&quot;)
-ENDIF (CYGWIN)
-
-IF (ADM_CPU_ALTIVEC)
-	SET(CMAKE_C_FLAGS &quot;${CMAKE_C_FLAGS} ${ADM_ALTIVEC_FLAGS}&quot;)
-	SET(CMAKE_CXX_FLAGS &quot;${CMAKE_CXX_FLAGS} ${ADM_ALTIVEC_FLAGS}&quot;)
-ENDIF (ADM_CPU_ALTIVEC)
-
-IF (UNIX AND NOT APPLE)
-	# jog shuttle is only available on Linux due to its interface
-	SET(USE_JOG 1)
-ENDIF (UNIX AND NOT APPLE)
-
-IF (WIN32)
-	SET(CMAKE_SHARED_LINKER_FLAGS &quot;${CMAKE_SHARED_LINKER_FLAGS} -Wl,-enable-auto-image-base -Wl,-enable-auto-import&quot;)
-	SET(CMAKE_EXE_LINKER_FLAGS &quot;${CMAKE_EXE_LINKER_FLAGS} -Wl,-enable-auto-import&quot;)
-
-	IF (CMAKE_BUILD_TYPE STREQUAL &quot;Release&quot;)
-		SET(CMAKE_EXE_LINKER_FLAGS &quot;${CMAKE_EXE_LINKER_FLAGS} -Wl,-s&quot;)
-		SET(CMAKE_SHARED_LINKER_FLAGS &quot;${CMAKE_SHARED_LINKER_FLAGS} -Wl,-s&quot;)
-	ENDIF (CMAKE_BUILD_TYPE STREQUAL &quot;Release&quot;)
-ENDIF (WIN32)
-
-
-include(FindThreads)
-INCLUDE(admCheckRequiredLibs)
-include(admCheckMiscLibs)
-include( admGetRevision)
+ADD_DEFINITIONS(-D_FILE_OFFSET_BITS=64 -D_LARGE_FILES)
+include(admMainChecks)
 ########################################
-# Subversion
-########################################
-MESSAGE(&quot;&quot;)
-MESSAGE(STATUS &quot;Checking for SCM&quot;)
-MESSAGE(STATUS &quot;****************&quot;)
-admGetRevision( ${AVIDEMUX_TOP_SOURCE_DIR} ADM_SUBVERSION)
-MESSAGE(&quot;&quot;)
-########################################
 # Add include dirs
 ########################################
-SET(AVIDEMUX_INSTALL_DIR &quot;${CMAKE_INSTALL_PREFIX}&quot;)
-MARK_AS_ADVANCED(AVIDEMUX_INSTALL_DIR)
-include(admInstallDir)
 include(admCoreIncludes)
 LINK_DIRECTORIES(&quot;${AVIDEMUX_LIB_DIR}&quot;)
 #

Modified: branches/avidemux_2.6_branch_mean/avidemux/gtk/CMakeLists.txt
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/gtk/CMakeLists.txt	2009-08-03 16:33:52 UTC (rev 5200)
+++ branches/avidemux_2.6_branch_mean/avidemux/gtk/CMakeLists.txt	2009-08-03 17:10:30 UTC (rev 5201)
@@ -2,7 +2,15 @@
 MESSAGE(&quot;Configure for avidemux Gtk Started&quot;)
 MESSAGE(&quot;#########################################&quot;)
 MESSAGE(&quot;&quot;)
-PROJECT(Avidemux_gtk)
+SET(VERSION 2.6.0)
+CMAKE_MINIMUM_REQUIRED(VERSION 2.4.7 FATAL_ERROR)
+if (COMMAND cmake_policy)
+	cmake_policy(VERSION 2.4)
+	cmake_policy(SET CMP0003 NEW)
+	cmake_policy(SET CMP0011 OLD)
+endif (COMMAND cmake_policy)
+SET( ADM_PROJECT Avidemux_gtk)
+
 include(../commonCmakeApplication.cmake)
 include(admCheckGtk)
 include(admCheckGlade)

Modified: branches/avidemux_2.6_branch_mean/avidemux/qt4/CMakeLists.txt
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/qt4/CMakeLists.txt	2009-08-03 16:33:52 UTC (rev 5200)
+++ branches/avidemux_2.6_branch_mean/avidemux/qt4/CMakeLists.txt	2009-08-03 17:10:30 UTC (rev 5201)
@@ -2,7 +2,15 @@
 MESSAGE(&quot;Configure for avidemux Qt4 Started&quot;)
 MESSAGE(&quot;#########################################&quot;)
 MESSAGE(&quot;&quot;)
-PROJECT(Avidemux_qt4)
+SET(VERSION 2.6.0)
+CMAKE_MINIMUM_REQUIRED(VERSION 2.4.7 FATAL_ERROR)
+if (COMMAND cmake_policy)
+	cmake_policy(VERSION 2.4)
+	cmake_policy(SET CMP0003 NEW)
+	cmake_policy(SET CMP0011 OLD)
+endif (COMMAND cmake_policy)
+SET( ADM_PROJECT Avidemux_qt4)
+# Use old behaviour
 include(../commonCmakeApplication.cmake)
 INCLUDE(admCheckQt4)
 checkQt4()
@@ -10,11 +18,6 @@
         MESSAGE(FATAL_ERROR &quot;Qt4 NOT FOUND&quot;)
 ENDIF (NOT QT4_FOUND)
 
-#include(admCheckGtk)
-#include(admCheckGlade)
-#
-#checkGtk()
-#checkGlade()
 ##########################################
 # Config
 ##########################################

Modified: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreAudioParser/src/CMakeLists.txt
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreAudioParser/src/CMakeLists.txt	2009-08-03 16:33:52 UTC (rev 5200)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreAudioParser/src/CMakeLists.txt	2009-08-03 17:10:30 UTC (rev 5201)
@@ -9,8 +9,6 @@
 ADD_DEFINITIONS( &quot;-DADM_LEGACY_PROGGY&quot;)
 ADD_DEFINITIONS( &quot;-DHAVE_LRINT -DHAVE_LRINTF &quot;)
 ADD_DEFINITIONS( &quot;-DCPU_CLIPS_POSITIVE=0 -DCPU_CLIPS_NEGATIVE=0&quot;)
-ADD_DEFINITIONS( &quot;-DPACKAGE=`&quot;SRC`&quot;&quot;)
-ADD_DEFINITIONS( &quot;-DVERSION=`&quot;0.1.4`&quot;&quot;)
 #*************************************************
 ADD_LIBRARY(ADM_audioParser6 SHARED ${ADMaudioParser_SRCS})
 TARGET_LINK_LIBRARIES(ADM_audioParser6 ADM_core6 ADM_coreUI6)

Modified: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavcodec/CMakeLists.txt
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavcodec/CMakeLists.txt	2009-08-03 16:33:52 UTC (rev 5200)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavcodec/CMakeLists.txt	2009-08-03 17:10:30 UTC (rev 5201)
@@ -30,7 +30,7 @@
 	dvbsub_parser.c  dvbsubdec.c  dvbsub.c  xiph.c  sp5xdec.c  
         nellymoserdec.c nellymoser.c
 	ADM_lavcodec.cpp  pthread.c  huffman.c  wmv2dec.c  wmv2.c  h264pred.c  intrax8.c
-	intrax8dsp.c  dnxhddata.c  faanidct.c  ac3_parser.c  aac_ac3_parser.c
+	intrax8dsp.c  dnxhddata.c  faanidct.c    aac_ac3_parser.c
         celp_math.c options.c aandcttab.c audioconvert.c mpeg4audio.c svq1dec.c celp_filters.c
 	aac_parser.c  mpegaudiodecheader.c)
 

Modified: branches/avidemux_2.6_branch_mean/avidemux_core/CMakeLists.txt
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/CMakeLists.txt	2009-08-03 16:33:52 UTC (rev 5200)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/CMakeLists.txt	2009-08-03 17:10:30 UTC (rev 5201)
@@ -2,150 +2,27 @@
 MESSAGE(&quot;Configure for avidemux core libs Started&quot;)
 MESSAGE(&quot;#########################################&quot;)
 MESSAGE(&quot;&quot;)
-
-CMAKE_MINIMUM_REQUIRED(VERSION 2.4.7 FATAL_ERROR)
-
+cmake_minimum_required(VERSION 2.6)
 if (COMMAND cmake_policy)
 	cmake_policy(VERSION 2.4)
 	cmake_policy(SET CMP0003 NEW)
+	cmake_policy(SET CMP0011 OLD)
 endif (COMMAND cmake_policy)
 
-
-IF (NOT CMAKE_CXX_COMPILER_WORKS MATCHES &quot;^${CMAKE_CXX_COMPILER_WORKS}$&quot;)
-	SET(FRESH_BUILD 1)
-ENDIF (NOT CMAKE_CXX_COMPILER_WORKS MATCHES &quot;^${CMAKE_CXX_COMPILER_WORKS}$&quot;)
-
 # need for shared cmake script between avidemux &amp; plugins
 SET(AVIDEMUX_SOURCE_DIR ${CMAKE_SOURCE_DIR})
 SET(AVIDEMUX_TOP_SOURCE_DIR ${CMAKE_SOURCE_DIR}/..)
 SET(AVIDEMUX_CORE_BUILD_DIR ${CMAKE_BINARY_DIR})
-#
+
 SET(CMAKE_MODULE_PATH &quot;${AVIDEMUX_TOP_SOURCE_DIR}/cmake&quot; &quot;${CMAKE_MODULE_PATH}&quot;)
-#
-MESSAGE(STATUS &quot;Top Source dir is ${AVIDEMUX_TOP_SOURCE_DIR}&quot;)
-MESSAGE(&quot;&quot;)
 
-PROJECT(Avidemux_core)
-
-IF (${Avidemux_SOURCE_DIR} MATCHES ${Avidemux_BINARY_DIR})
-	MESSAGE(&quot;Please do an out-of-tree build:&quot;)
-	MESSAGE(&quot;rm CMakeCache.txt; mkdir build; cd build; cmake ..; make&quot;)
-	MESSAGE(FATAL_ERROR &quot;in-tree-build detected&quot;)
-ENDIF (${Avidemux_SOURCE_DIR} MATCHES ${Avidemux_BINARY_DIR})
-
-INCLUDE(admConfigHelper)
-include( admGetRevision)
-
-IF (FRESH_BUILD)
-	MESSAGE(&quot;&quot;)
-ENDIF (FRESH_BUILD)
-
+include(admMainChecks)
 ########################################
-# Global options
-########################################
-OPTION(VERBOSE &quot;&quot; OFF)
-
-IF (NOT CMAKE_BUILD_TYPE)
-	SET(CMAKE_BUILD_TYPE &quot;Release&quot;)
-ENDIF (NOT CMAKE_BUILD_TYPE)
-
-########################################
-# Avidemux system specific tweaks
-########################################
-INCLUDE(admDetermineSystem)
-
-IF (CYGWIN)
-	SET(CMAKE_C_FLAGS &quot;${CMAKE_C_FLAGS} -mwin32&quot;)
-	SET(CMAKE_CXX_FLAGS &quot;${CMAKE_CXX_FLAGS} -mwin32&quot;)
-ENDIF (CYGWIN)
-
-IF (ADM_CPU_ALTIVEC)
-	SET(CMAKE_C_FLAGS &quot;${CMAKE_C_FLAGS} ${ADM_ALTIVEC_FLAGS}&quot;)
-	SET(CMAKE_CXX_FLAGS &quot;${CMAKE_CXX_FLAGS} ${ADM_ALTIVEC_FLAGS}&quot;)
-ENDIF (ADM_CPU_ALTIVEC)
-
-IF (UNIX AND NOT APPLE)
-	# jog shuttle is only available on Linux due to its interface
-	SET(USE_JOG 1)
-ENDIF (UNIX AND NOT APPLE)
-
-IF (WIN32)
-	SET(BIN_DIR .)
-	SET(CMAKE_SHARED_LINKER_FLAGS &quot;${CMAKE_SHARED_LINKER_FLAGS} -Wl,-enable-auto-image-base -Wl,-enable-auto-import&quot;)
-	SET(CMAKE_EXE_LINKER_FLAGS &quot;${CMAKE_EXE_LINKER_FLAGS} -Wl,-enable-auto-import&quot;)
-
-	IF (CMAKE_BUILD_TYPE STREQUAL &quot;Release&quot;)
-		SET(CMAKE_EXE_LINKER_FLAGS &quot;${CMAKE_EXE_LINKER_FLAGS} -Wl,-s&quot;)
-		SET(CMAKE_SHARED_LINKER_FLAGS &quot;${CMAKE_SHARED_LINKER_FLAGS} -Wl,-s&quot;)
-	ENDIF (CMAKE_BUILD_TYPE STREQUAL &quot;Release&quot;)
-ELSE (WIN32)
-	SET(BIN_DIR bin)
-ENDIF (WIN32)
-
-########################################
-# Standard Avidemux defines
-########################################
-SET(VERSION 2.6.0)
-
-# Define internal flags for GTK+ and Qt4 builds.  These are turned off
-# if a showstopper is found.  CLI is automatically assumed as possible
-# since it uses the minimum set of required libraries and CMake will 
-# fail if these aren't met.
-
-SET(AVIDEMUX_INSTALL_DIR &quot;${CMAKE_INSTALL_PREFIX}&quot;)
-MARK_AS_ADVANCED(AVIDEMUX_INSTALL_DIR)
-include(admInstallDir)
-
-IF (CMAKE_BUILD_TYPE STREQUAL &quot;Debug&quot;)
-	SET(ADM_DEBUG 1)
-ENDIF (CMAKE_BUILD_TYPE STREQUAL &quot;Debug&quot;)
-########################################
-# Subversion
-########################################
-
-MESSAGE(&quot;&quot;)
-MESSAGE(STATUS &quot;Checking for SCM&quot;)
-MESSAGE(STATUS &quot;****************&quot;)
-admGetRevision( ${AVIDEMUX_TOP_SOURCE_DIR} ADM_SUBVERSION)
-MESSAGE(&quot;&quot;)
-
-
-########################################
-# Check for libraries
-########################################
-SET(MSG_DISABLE_OPTION &quot;Disabled per request&quot;)
-
-INCLUDE(admCheckRequiredLibs)
-INCLUDE(admCheckMiscLibs)
-INCLUDE(admCheckVDPAU)
-INCLUDE(FindThreads)
-
-########################################
-# Check functions and includes
-########################################
-IF (NOT SYSTEM_HEADERS_CHECKED)
-	MESSAGE(STATUS &quot;Checking system headers&quot;)
-	MESSAGE(STATUS &quot;***********************&quot;)
-
-	INCLUDE(CheckIncludeFiles)
-	INCLUDE(CheckFunctionExists)
-
-	CHECK_FUNCTION_EXISTS(gettimeofday HAVE_GETTIMEOFDAY)
-
-	CHECK_INCLUDE_FILES(byteswap.h   HAVE_BYTESWAP_H)	# libavutil
-	CHECK_INCLUDE_FILES(inttypes.h   HAVE_INTTYPES_H)	# internal use, mpeg2enc, mplex
-	CHECK_INCLUDE_FILES(stdint.h     HAVE_STDINT_H)		# internal use, mpeg2enc, mplex
-	CHECK_INCLUDE_FILES(sys/types.h  HAVE_SYS_TYPES_H)	# mad, mpeg2enc
-	CHECK_INCLUDE_FILES(malloc.h     HAVE_MALLOC_H)		# libavcodec, libavutil, libpostproc, libswscale, mplex
-	SET(SYSTEM_HEADERS_CHECKED 1 CACHE BOOL &quot;&quot;)
-	MARK_AS_ADVANCED(SYSTEM_HEADERS_CHECKED)
-
-	MESSAGE(&quot;&quot;)
-ENDIF (NOT SYSTEM_HEADERS_CHECKED)
-########################################
 # VDPAU
 ########################################
+IF(NOT CROSS)
 checkVDPAU()
+ENDIF(NOT CROSS)
 ########################################
 # Debug Summary
 ########################################
@@ -154,6 +31,7 @@
 	MESSAGE(&quot;&quot;)
 ENDIF (VERBOSE)
 
+
 ########################################
 # Generate config.h
 ########################################

Added: branches/avidemux_2.6_branch_mean/bootStrapCrossMingw.sh
===================================================================
--- branches/avidemux_2.6_branch_mean/bootStrapCrossMingw.sh	2009-08-03 16:33:52 UTC (rev 5200)
+++ branches/avidemux_2.6_branch_mean/bootStrapCrossMingw.sh	2009-08-03 17:10:30 UTC (rev 5201)
@@ -0,0 +1,45 @@
+#!/bin/bash
+# ** Put your config here **
+export PREFIX=i586-mingw32msvc
+export SDLDIR=/mingw
+export MINGW=/mingw
+export QT_HOME=/mingw/Qt/4.5.2
+# ** Put your config here **
+
+fail()
+{
+        echo &quot;** Failed at $1**&quot;
+        exit 1
+}
+
+Process()
+{
+        export BUILDDIR=$1
+        export SCRIPT=$2
+        echo &quot;Building $BUILDDIR from $SOURCEDIR&quot;
+        rm -Rf ./$BUILDDIR
+        mkdir $BUILDDIR || fail mkdir
+        cd $BUILDDIR 
+        sh $TOP/foreignBuilds/$SCRIPT || fail cmake
+        make -j 2 &gt; /tmp/log$BUILDDIR || fail make
+        make install || fail make_install
+}
+
+echo &quot;**BootStrapping avidemux **&quot;
+export TOP=$PWD
+echo &quot;Top dir : $TOP&quot;
+echo &quot;** CORE **&quot;
+cd $TOP
+Process buildMingwCore cross_mingw_core
+echo &quot;** QT4 **&quot;
+cd $TOP
+Process buildMingwQt4 cross_mingw_qt4 
+#echo &quot;** GTK **&quot;
+#cd $TOP
+#Process buildGtk ../avidemux/gtk
+echo &quot;** Plugins **&quot;
+cd $TOP
+Process buildMingwPlugins cross_mingw_plugins 
+echo &quot;** All done **&quot;
+cd $TOP
+echo &quot;** ALL DONE **&quot;

Modified: branches/avidemux_2.6_branch_mean/cmake/admCheckLibxml2.cmake
===================================================================
--- branches/avidemux_2.6_branch_mean/cmake/admCheckLibxml2.cmake	2009-08-03 16:33:52 UTC (rev 5200)
+++ branches/avidemux_2.6_branch_mean/cmake/admCheckLibxml2.cmake	2009-08-03 17:10:30 UTC (rev 5201)
@@ -5,11 +5,23 @@
 
 		SET(LibXml2_FIND_QUIETLY TRUE)
 
-		FIND_PACKAGE(LibXml2)
+                if(CROSS)
+                        MESSAGE(STATUS &quot;Xml2: Cross compilation override&quot;)
+                        SET(WIN32 0)
+                endif(CROSS) 
+
+                FIND_PACKAGE(LibXml2)
+
+                if(CROSS)
+                        MESSAGE(STATUS &quot;Cross : Xml2: ${LIBXML2_FOUND} lib:${LIBXML2_LIBRARIES} inc:${LIBXML2_INCLUDE_DIR} &quot;)
+                        SET(LIBXML2_LIBRARIES &quot;-lxml2 -L${CROSS}/lib&quot;)
+                        SET(WIN32 1)
+                endif(CROSS) 
+
 		PRINT_LIBRARY_INFO(&quot;Libxml2&quot; LIBXML2_FOUND &quot;${LIBXML2_INCLUDE_DIR} ${LIBXML2_DEFINITIONS}&quot; &quot;${LIBXML2_LIBRARIES}&quot;)
 
 		SET(LIBXML2_CHECKED 1)
 
 		MESSAGE(&quot;&quot;)
 	ENDIF (NOT LIBXML2_CHECKED)
-ENDMACRO(checkLibxml2)
\ No newline at end of file
+ENDMACRO(checkLibxml2)

Modified: branches/avidemux_2.6_branch_mean/cmake/admCheckMiscLibs.cmake
===================================================================
--- branches/avidemux_2.6_branch_mean/cmake/admCheckMiscLibs.cmake	2009-08-03 16:33:52 UTC (rev 5200)
+++ branches/avidemux_2.6_branch_mean/cmake/admCheckMiscLibs.cmake	2009-08-03 17:10:30 UTC (rev 5201)
@@ -2,8 +2,9 @@
 # gettext
 ########################################
 INCLUDE(admCheckGettext)
-
+if(NOT CROSS)
 checkGettext()
+endif(NOT CROSS)
 
 SET(ADM_LOCALE &quot;${CMAKE_INSTALL_PREFIX}/share/locale&quot;)
 

Modified: branches/avidemux_2.6_branch_mean/cmake/admCheckQt4.cmake
===================================================================
--- branches/avidemux_2.6_branch_mean/cmake/admCheckQt4.cmake	2009-08-03 16:33:52 UTC (rev 5200)
+++ branches/avidemux_2.6_branch_mean/cmake/admCheckQt4.cmake	2009-08-03 17:10:30 UTC (rev 5201)
@@ -4,7 +4,25 @@
 
 		MESSAGE(STATUS &quot;Checking for Qt 4&quot;)
 		MESSAGE(STATUS &quot;*****************&quot;)
+                IF(CROSS)
+                        MESSAGE(STATUS &quot;Cross compiling override for QT4&quot;)
+                        SET(QT_INCLUDES &quot;-I${QT_HOME}/include&quot;)
+                        SET(QT_INCLUDE_DIR &quot;${QT_HOME}/include&quot;)
+                        SET(QT_BINARY_DIR ${QT_HOME}/bin)
+                        SET(QT_LIBRARY_DIR ${QT_HOME}/lib)
+                        SET(QT4_FOUND 1)
+                        SET(QT_RCC_EXECUTABLE rcc)
+                        SET(QT_MOC_EXECUTABLE moc-qt4)
+                        SET(QT_UIC_EXECUTABLE uic-qt4)
+                        SET(QT_QTCORE_LIBRARY ${QT_HOME}/lib/libQtCore4.a)
+                        SET(QT_QTGUI_LIBRARY ${QT_HOME}/lib/libQtGui4.a)
+                        MESSAGE(STATUS &quot;[QT4Include] ${QT_INCLUDES}&quot;)
+                        MESSAGE(STATUS &quot;[QT4IncludeDir] ${QT_INCLUDE_DIR}&quot;)
+                        include(admCrossQt4)
+                        
+                               
 
+                ELSE(CROSS)
 		IF (QT4)
 			FIND_PACKAGE(Qt4)	
 			STRING(REGEX REPLACE &quot;[\\]&quot; &quot;/&quot; QT_INCLUDES &quot;${QT_INCLUDES}&quot;)	# backslashes aren't taken care of properly on Windows
@@ -17,9 +35,10 @@
 		ELSE (QT4)
 			MESSAGE(&quot;${MSG_DISABLE_OPTION}&quot;)
 		ENDIF (QT4)
+                ENDIF(CROSS)
 
 		SET(QT4_CHECKED 1)
 
 		MESSAGE(&quot;&quot;)
 	ENDIF (NOT QT4_CHECKED)
-ENDMACRO(checkQt4)
\ No newline at end of file
+ENDMACRO(checkQt4)

Modified: branches/avidemux_2.6_branch_mean/cmake/admCheckRequiredLibs.cmake
===================================================================
--- branches/avidemux_2.6_branch_mean/cmake/admCheckRequiredLibs.cmake	2009-08-03 16:33:52 UTC (rev 5200)
+++ branches/avidemux_2.6_branch_mean/cmake/admCheckRequiredLibs.cmake	2009-08-03 17:10:30 UTC (rev 5201)
@@ -38,6 +38,12 @@
 MESSAGE(STATUS &quot;*******************&quot;)
 
 FIND_PACKAGE(PNG)
+if(CROSS)
+                        MESSAGE(STATUS &quot;Cross compile override&quot;)
+                          SET(ZLIB_LIBRARY &quot;-lz -L${CROSS}/lib&quot;)
+                          SET(PNG_LIBRARIES &quot; ${ZLIB_LIBRARY} -lpng12 -L${CROSS}/lib&quot;)
+endif(CROSS)
+
 PRINT_LIBRARY_INFO(&quot;libpng&quot; PNG_FOUND &quot;${PNG_INCLUDE_DIR} ${PNG_DEFINITIONS}&quot; &quot;${PNG_LIBRARIES}&quot; FATAL_ERROR)
 
 FOREACH(_flag ${PNG_INCLUDE_DIR})
@@ -55,6 +61,11 @@
 MESSAGE(STATUS &quot;*********************&quot;)
 
 FIND_PACKAGE(Threads)
+if(CROSS)
+                          MESSAGE(STATUS &quot;Cross compile override&quot;)
+                          SET(PTHREAD_LIBRARIES &quot;-lpthreadGC2&quot;)
+endif(CROSS)
+
 PRINT_LIBRARY_INFO(&quot;pthreads&quot; PTHREAD_FOUND &quot;${PTHREAD_INCLUDE_DIR}&quot; &quot;${PTHREAD_LIBRARIES}&quot; FATAL_ERROR)
 
-MESSAGE(&quot;&quot;)
\ No newline at end of file
+MESSAGE(&quot;&quot;)

Modified: branches/avidemux_2.6_branch_mean/cmake/admConfigHelper.cmake
===================================================================
--- branches/avidemux_2.6_branch_mean/cmake/admConfigHelper.cmake	2009-08-03 16:33:52 UTC (rev 5200)
+++ branches/avidemux_2.6_branch_mean/cmake/admConfigHelper.cmake	2009-08-03 17:10:30 UTC (rev 5201)
@@ -188,3 +188,6 @@
 
 	TARGET_LINK_LIBRARIES(${_target} ${_flags})
 ENDMACRO (ADD_TARGET_LDFLAGS)
+
+#
+

Added: branches/avidemux_2.6_branch_mean/cmake/admCrossCompile.cmake
===================================================================
--- branches/avidemux_2.6_branch_mean/cmake/admCrossCompile.cmake	2009-08-03 16:33:52 UTC (rev 5200)
+++ branches/avidemux_2.6_branch_mean/cmake/admCrossCompile.cmake	2009-08-03 17:10:30 UTC (rev 5201)
@@ -0,0 +1,23 @@
+
+if(CROSS)
+        MESSAGE(STATUS &quot; ** Win32 Cross compiling activated, overriding cmake internals **&quot;)
+        # the name of the target operating system
+        SET(CMAKE_SYSTEM_NAME Windows)
+        
+        # which compilers to use for C and C++
+        SET(CMAKE_C_COMPILER i586-mingw32msvc-gcc)
+        SET(CMAKE_CXX_COMPILER i586-mingw32msvc-g++)
+        SET(CMAKE_LINKER i586-mingw32msvc-ld)
+        SET(CMAKE_AR i586-mingw32msvc-ar)
+        
+        # here is the target environment located
+        SET(CMAKE_FIND_ROOT_PATH  /usr/i586-mingw32msvc ${CROSS} )
+        
+        # adjust the default behaviour of the FIND_XXX() commands:
+        # search headers and libraries in the target environment, search 
+        # programs in the host environment
+        set(CMAKE_FIND_ROOT_PATH_MODE_PROGRAM NEVER)
+        set(CMAKE_FIND_ROOT_PATH_MODE_LIBRARY ONLY)
+        set(CMAKE_FIND_ROOT_PATH_MODE_INCLUDE ONLY)
+endif(CROSS)
+

Added: branches/avidemux_2.6_branch_mean/cmake/admCrossQt4.cmake
===================================================================
--- branches/avidemux_2.6_branch_mean/cmake/admCrossQt4.cmake	2009-08-03 16:33:52 UTC (rev 5200)
+++ branches/avidemux_2.6_branch_mean/cmake/admCrossQt4.cmake	2009-08-03 17:10:30 UTC (rev 5201)
@@ -0,0 +1,171 @@
+
+  MACRO (QT4_EXTRACT_OPTIONS _qt4_files _qt4_options)
+    SET(${_qt4_files})
+    SET(${_qt4_options})
+    SET(_QT4_DOING_OPTIONS FALSE)
+    FOREACH(_currentArg ${ARGN})
+      IF (&quot;${_currentArg}&quot; STREQUAL &quot;OPTIONS&quot;)
+        SET(_QT4_DOING_OPTIONS TRUE)
+      ELSE (&quot;${_currentArg}&quot; STREQUAL &quot;OPTIONS&quot;)
+        IF(_QT4_DOING_OPTIONS) 
+          LIST(APPEND ${_qt4_options} &quot;${_currentArg}&quot;)
+        ELSE(_QT4_DOING_OPTIONS)
+          LIST(APPEND ${_qt4_files} &quot;${_currentArg}&quot;)
+        ENDIF(_QT4_DOING_OPTIONS)
+      ENDIF (&quot;${_currentArg}&quot; STREQUAL &quot;OPTIONS&quot;)
+    ENDFOREACH(_currentArg) 
+  ENDMACRO (QT4_EXTRACT_OPTIONS)
+  
+  # macro used to create the names of output files preserving relative dirs
+  MACRO (QT4_MAKE_OUTPUT_FILE infile prefix ext outfile )
+    STRING(LENGTH ${CMAKE_CURRENT_BINARY_DIR} _binlength)
+    STRING(LENGTH ${infile} _infileLength)
+    SET(_checkinfile ${CMAKE_CURRENT_SOURCE_DIR})
+    IF(_infileLength GREATER _binlength)
+      STRING(SUBSTRING &quot;${infile}&quot; 0 ${_binlength} _checkinfile)
+      IF(_checkinfile STREQUAL &quot;${CMAKE_CURRENT_BINARY_DIR}&quot;)
+        FILE(RELATIVE_PATH rel ${CMAKE_CURRENT_BINARY_DIR} ${infile})
+      ELSE(_checkinfile STREQUAL &quot;${CMAKE_CURRENT_BINARY_DIR}&quot;)
+        FILE(RELATIVE_PATH rel ${CMAKE_CURRENT_SOURCE_DIR} ${infile})
+      ENDIF(_checkinfile STREQUAL &quot;${CMAKE_CURRENT_BINARY_DIR}&quot;)
+    ELSE(_infileLength GREATER _binlength)
+      FILE(RELATIVE_PATH rel ${CMAKE_CURRENT_SOURCE_DIR} ${infile})
+    ENDIF(_infileLength GREATER _binlength)
+    SET(_outfile &quot;${CMAKE_CURRENT_BINARY_DIR}/${rel}&quot;)
+    STRING(REPLACE &quot;..&quot; &quot;__&quot; _outfile ${_outfile})
+    GET_FILENAME_COMPONENT(outpath ${_outfile} PATH)
+    GET_FILENAME_COMPONENT(_outfile ${_outfile} NAME_WE)
+    FILE(MAKE_DIRECTORY ${outpath})
+    SET(${outfile} ${outpath}/${prefix}${_outfile}.${ext})
+  ENDMACRO (QT4_MAKE_OUTPUT_FILE )
+
+  MACRO (QT4_GET_MOC_FLAGS _moc_flags)
+     SET(${_moc_flags})
+     GET_DIRECTORY_PROPERTY(_inc_DIRS INCLUDE_DIRECTORIES)
+
+     FOREACH(_current ${_inc_DIRS})
+        SET(${_moc_flags} ${${_moc_flags}} &quot;-I${_current}&quot;)
+     ENDFOREACH(_current ${_inc_DIRS})
+     
+     GET_DIRECTORY_PROPERTY(_defines COMPILE_DEFINITIONS)
+     FOREACH(_current ${_defines})
+        SET(${_moc_flags} ${${_moc_flags}} &quot;-D${_current}&quot;)
+     ENDFOREACH(_current ${_defines})
+
+     IF(Q_WS_WIN)
+       SET(${_moc_flags} ${${_moc_flags}} -DWIN32)
+     ENDIF(Q_WS_WIN)
+
+  ENDMACRO(QT4_GET_MOC_FLAGS)
+
+  # helper macro to set up a moc rule
+  MACRO (QT4_CREATE_MOC_COMMAND infile outfile moc_flags moc_options)
+    # For Windows, create a parameters file to work around command line length limit
+    IF (WIN32)
+      # Pass the parameters in a file.  Set the working directory to
+      # be that containing the parameters file and reference it by
+      # just the file name.  This is necessary because the moc tool on
+      # MinGW builds does not seem to handle spaces in the path to the
+      # file given with the @ syntax.
+      GET_FILENAME_COMPONENT(_moc_outfile_name &quot;${outfile}&quot; NAME)
+      GET_FILENAME_COMPONENT(_moc_outfile_dir &quot;${outfile}&quot; PATH)
+      IF(_moc_outfile_dir)
+        SET(_moc_working_dir WORKING_DIRECTORY ${_moc_outfile_dir})
+      ENDIF(_moc_outfile_dir)
+      SET (_moc_parameters_file ${outfile}_parameters)
+      SET (_moc_parameters ${moc_flags} ${moc_options} -o &quot;${outfile}&quot; &quot;${infile}&quot;)
+      FILE (REMOVE ${_moc_parameters_file})
+      FOREACH(arg ${_moc_parameters})
+        FILE (APPEND ${_moc_parameters_file} &quot;${arg}\n&quot;)
+      ENDFOREACH(arg)
+      ADD_CUSTOM_COMMAND(OUTPUT ${outfile}
+                         COMMAND ${QT_MOC_EXECUTABLE} @${_moc_outfile_name}_parameters
+                         DEPENDS ${infile}
+                         ${_moc_working_dir}
+                         VERBATIM)
+    ELSE (WIN32)     
+      ADD_CUSTOM_COMMAND(OUTPUT ${outfile}
+                         COMMAND ${QT_MOC_EXECUTABLE}
+                         ARGS ${moc_flags} ${moc_options} -o ${outfile} ${infile}
+                         DEPENDS ${infile})     
+    ENDIF (WIN32)
+  ENDMACRO (QT4_CREATE_MOC_COMMAND)
+
+  
+  MACRO (QT4_GENERATE_MOC infile outfile )
+     QT4_GET_MOC_FLAGS(moc_flags)
+     GET_FILENAME_COMPONENT(abs_infile ${infile} ABSOLUTE)
+     QT4_CREATE_MOC_COMMAND(${abs_infile} ${outfile} &quot;${moc_flags}&quot; &quot;&quot;)
+     SET_SOURCE_FILES_PROPERTIES(${outfile} PROPERTIES SKIP_AUTOMOC TRUE)  # dont run automoc on this file
+  ENDMACRO (QT4_GENERATE_MOC)
+
+
+  # QT4_WRAP_CPP(outfiles inputfile ... )
+
+  MACRO (QT4_WRAP_CPP outfiles )
+    # get include dirs
+    QT4_GET_MOC_FLAGS(moc_flags)
+    QT4_EXTRACT_OPTIONS(moc_files moc_options ${ARGN})
+
+    FOREACH (it ${moc_files})
+      GET_FILENAME_COMPONENT(it ${it} ABSOLUTE)
+      QT4_MAKE_OUTPUT_FILE(${it} moc_ cxx outfile)
+      QT4_CREATE_MOC_COMMAND(${it} ${outfile} &quot;${moc_flags}&quot; &quot;${moc_options}&quot;)
+      SET(${outfiles} ${${outfiles}} ${outfile})
+    ENDFOREACH(it)
+
+  ENDMACRO (QT4_WRAP_CPP)
+
+
+  # QT4_WRAP_UI(outfiles inputfile ... )
+
+  MACRO (QT4_WRAP_UI outfiles )
+    QT4_EXTRACT_OPTIONS(ui_files ui_options ${ARGN})
+
+    FOREACH (it ${ui_files})
+      GET_FILENAME_COMPONENT(outfile ${it} NAME_WE)
+      GET_FILENAME_COMPONENT(infile ${it} ABSOLUTE)
+      SET(outfile ${CMAKE_CURRENT_BINARY_DIR}/ui_${outfile}.h)
+      ADD_CUSTOM_COMMAND(OUTPUT ${outfile}
+        COMMAND ${QT_UIC_EXECUTABLE}
+        ARGS ${ui_options} -o ${outfile} ${infile}
+        MAIN_DEPENDENCY ${infile})
+      SET(${outfiles} ${${outfiles}} ${outfile})
+    ENDFOREACH (it)
+
+  ENDMACRO (QT4_WRAP_UI)
+
+
+  # QT4_ADD_RESOURCES(outfiles inputfile ... )
+
+  MACRO (QT4_ADD_RESOURCES outfiles )
+    QT4_EXTRACT_OPTIONS(rcc_files rcc_options ${ARGN})
+
+    FOREACH (it ${rcc_files})
+      GET_FILENAME_COMPONENT(outfilename ${it} NAME_WE)
+      GET_FILENAME_COMPONENT(infile ${it} ABSOLUTE)
+      GET_FILENAME_COMPONENT(rc_path ${infile} PATH)
+      SET(outfile ${CMAKE_CURRENT_BINARY_DIR}/qrc_${outfilename}.cxx)
+      #  parse file for dependencies 
+      #  all files are absolute paths or relative to the location of the qrc file
+      FILE(READ &quot;${infile}&quot; _RC_FILE_CONTENTS)
+      STRING(REGEX MATCHALL &quot;&lt;file[^&lt;]+&quot; _RC_FILES &quot;${_RC_FILE_CONTENTS}&quot;)
+      SET(_RC_DEPENDS)
+      FOREACH(_RC_FILE ${_RC_FILES})
+        STRING(REGEX REPLACE &quot;^&lt;file[^&gt;]*&gt;&quot; &quot;&quot; _RC_FILE &quot;${_RC_FILE}&quot;)
+        STRING(REGEX MATCH &quot;^/|([A-Za-z]:/)&quot; _ABS_PATH_INDICATOR &quot;${_RC_FILE}&quot;)
+        IF(NOT _ABS_PATH_INDICATOR)
+          SET(_RC_FILE &quot;${rc_path}/${_RC_FILE}&quot;)
+        ENDIF(NOT _ABS_PATH_INDICATOR)
+        SET(_RC_DEPENDS ${_RC_DEPENDS} &quot;${_RC_FILE}&quot;)
+      ENDFOREACH(_RC_FILE)
+      ADD_CUSTOM_COMMAND(OUTPUT ${outfile}
+        COMMAND ${QT_RCC_EXECUTABLE}
+        ARGS ${rcc_options} -name ${outfilename} -o ${outfile} ${infile}
+        MAIN_DEPENDENCY ${infile}
+        DEPENDS ${_RC_DEPENDS})
+      SET(${outfiles} ${${outfiles}} ${outfile})
+    ENDFOREACH (it)
+
+  ENDMACRO (QT4_ADD_RESOURCES)
+

Copied: branches/avidemux_2.6_branch_mean/cmake/admMainChecks.cmake (from rev 5196, branches/avidemux_2.6_branch_mean/avidemux_core/CMakeLists.txt)
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/CMakeLists.txt	2009-08-01 18:09:38 UTC (rev 5196)
+++ branches/avidemux_2.6_branch_mean/cmake/admMainChecks.cmake	2009-08-03 17:10:30 UTC (rev 5201)
@@ -0,0 +1,140 @@
+
+# Override...
+SET(CMAKE_C_FLAGS $ENV{CFLAGS})
+SET(CMAKE_CXX_FLAGS $ENV{CXXFLAGS})
+SET(CMAKE_LD_FLAGS $ENV{LDFLAGS})
+
+
+IF (NOT CMAKE_CXX_COMPILER_WORKS MATCHES &quot;^${CMAKE_CXX_COMPILER_WORKS}$&quot;)
+	SET(FRESH_BUILD 1)
+ENDIF (NOT CMAKE_CXX_COMPILER_WORKS MATCHES &quot;^${CMAKE_CXX_COMPILER_WORKS}$&quot;)
+#
+#
+include(admCrossCompile)
+MESSAGE(STATUS &quot;[BUILD] EXTRA Cflags:${CMAKE_C_FLAGS}&quot;)
+MESSAGE(STATUS &quot;[BUILD] EXTRA CXXflags:${CMAKE_CXX_FLAGS}&quot;)
+MESSAGE(STATUS &quot;[BUILD] EXTRA LDflags:${CMAKE_LD_FLAGS}&quot;)
+MESSAGE(STATUS &quot;[BUILD] Compiler ${CMAKE_CXX_COMPILER}&quot;)
+MESSAGE(STATUS &quot;[BUILD] Linker   ${CMAKE_LINKER}&quot;)
+#
+MESSAGE(STATUS &quot;Top Source dir is ${AVIDEMUX_TOP_SOURCE_DIR}&quot;)
+MESSAGE(&quot;&quot;)
+
+PROJECT(Avidemux_core)
+
+IF (${Avidemux_SOURCE_DIR} MATCHES ${Avidemux_BINARY_DIR})
+	MESSAGE(&quot;Please do an out-of-tree build:&quot;)
+	MESSAGE(&quot;rm CMakeCache.txt; mkdir build; cd build; cmake ..; make&quot;)
+	MESSAGE(FATAL_ERROR &quot;in-tree-build detected&quot;)
+ENDIF (${Avidemux_SOURCE_DIR} MATCHES ${Avidemux_BINARY_DIR})
+
+INCLUDE(admConfigHelper)
+include( admGetRevision)
+
+
+IF (FRESH_BUILD)
+	MESSAGE(&quot;&quot;)
+ENDIF (FRESH_BUILD)
+
+########################################
+# Global options
+########################################
+OPTION(VERBOSE &quot;&quot; OFF)
+
+IF (NOT CMAKE_BUILD_TYPE)
+	SET(CMAKE_BUILD_TYPE &quot;Release&quot;)
+ENDIF (NOT CMAKE_BUILD_TYPE)
+
+########################################
+# Avidemux system specific tweaks
+########################################
+INCLUDE(admDetermineSystem)
+
+IF (CYGWIN)
+	SET(CMAKE_C_FLAGS &quot;${CMAKE_C_FLAGS} -mwin32&quot;)
+	SET(CMAKE_CXX_FLAGS &quot;${CMAKE_CXX_FLAGS} -mwin32&quot;)
+ENDIF (CYGWIN)
+
+IF (ADM_CPU_ALTIVEC)
+	SET(CMAKE_C_FLAGS &quot;${CMAKE_C_FLAGS} ${ADM_ALTIVEC_FLAGS}&quot;)
+	SET(CMAKE_CXX_FLAGS &quot;${CMAKE_CXX_FLAGS} ${ADM_ALTIVEC_FLAGS}&quot;)
+ENDIF (ADM_CPU_ALTIVEC)
+
+IF (UNIX AND NOT APPLE)
+	# jog shuttle is only available on Linux due to its interface
+	SET(USE_JOG 1)
+ENDIF (UNIX AND NOT APPLE)
+
+IF (WIN32)
+	SET(BIN_DIR .)
+	SET(CMAKE_SHARED_LINKER_FLAGS &quot;${CMAKE_SHARED_LINKER_FLAGS} -Wl,-enable-auto-image-base -Wl,-enable-auto-import&quot;)
+	SET(CMAKE_EXE_LINKER_FLAGS &quot;${CMAKE_EXE_LINKER_FLAGS} -Wl,-enable-auto-import&quot;)
+
+	IF (CMAKE_BUILD_TYPE STREQUAL &quot;Release&quot;)
+		SET(CMAKE_EXE_LINKER_FLAGS &quot;${CMAKE_EXE_LINKER_FLAGS} -Wl,-s&quot;)
+		SET(CMAKE_SHARED_LINKER_FLAGS &quot;${CMAKE_SHARED_LINKER_FLAGS} -Wl,-s&quot;)
+	ENDIF (CMAKE_BUILD_TYPE STREQUAL &quot;Release&quot;)
+ELSE (WIN32)
+	SET(BIN_DIR bin)
+ENDIF (WIN32)
+
+########################################
+# Standard Avidemux defines
+########################################
+SET(VERSION 2.6.0)
+
+# Define internal flags for GTK+ and Qt4 builds.  These are turned off
+# if a showstopper is found.  CLI is automatically assumed as possible
+# since it uses the minimum set of required libraries and CMake will 
+# fail if these aren't met.
+
+SET(AVIDEMUX_INSTALL_DIR &quot;${CMAKE_INSTALL_PREFIX}&quot;)
+MARK_AS_ADVANCED(AVIDEMUX_INSTALL_DIR)
+include(admInstallDir)
+
+IF (CMAKE_BUILD_TYPE STREQUAL &quot;Debug&quot;)
+	SET(ADM_DEBUG 1)
+ENDIF (CMAKE_BUILD_TYPE STREQUAL &quot;Debug&quot;)
+########################################
+# Subversion
+########################################
+
+MESSAGE(&quot;&quot;)
+MESSAGE(STATUS &quot;Checking for SCM&quot;)
+MESSAGE(STATUS &quot;****************&quot;)
+admGetRevision( ${AVIDEMUX_TOP_SOURCE_DIR} ADM_SUBVERSION)
+MESSAGE(&quot;&quot;)
+
+
+########################################
+# Check for libraries
+########################################
+SET(MSG_DISABLE_OPTION &quot;Disabled per request&quot;)
+INCLUDE(admCheckRequiredLibs)
+INCLUDE(admCheckMiscLibs)
+INCLUDE(FindThreads)
+INCLUDE(admCheckVDPAU)
+
+########################################
+# Check functions and includes
+########################################
+IF (NOT SYSTEM_HEADERS_CHECKED)
+	MESSAGE(STATUS &quot;Checking system headers&quot;)
+	MESSAGE(STATUS &quot;***********************&quot;)
+
+	INCLUDE(CheckIncludeFiles)
+	INCLUDE(CheckFunctionExists)
+
+	CHECK_FUNCTION_EXISTS(gettimeofday HAVE_GETTIMEOFDAY)
+
+	CHECK_INCLUDE_FILES(byteswap.h   HAVE_BYTESWAP_H)	# libavutil
+	CHECK_INCLUDE_FILES(inttypes.h   HAVE_INTTYPES_H)	# internal use, mpeg2enc, mplex
+	CHECK_INCLUDE_FILES(stdint.h     HAVE_STDINT_H)		# internal use, mpeg2enc, mplex
+	CHECK_INCLUDE_FILES(sys/types.h  HAVE_SYS_TYPES_H)	# mad, mpeg2enc
+	CHECK_INCLUDE_FILES(malloc.h     HAVE_MALLOC_H)		# libavcodec, libavutil, libpostproc, libswscale, mplex
+	SET(SYSTEM_HEADERS_CHECKED 1 CACHE BOOL &quot;&quot;)
+	MARK_AS_ADVANCED(SYSTEM_HEADERS_CHECKED)
+
+	MESSAGE(&quot;&quot;)
+ENDIF (NOT SYSTEM_HEADERS_CHECKED)
+

Added: branches/avidemux_2.6_branch_mean/foreignBuilds/cross_mingw_core
===================================================================
--- branches/avidemux_2.6_branch_mean/foreignBuilds/cross_mingw_core	2009-08-03 16:33:52 UTC (rev 5200)
+++ branches/avidemux_2.6_branch_mean/foreignBuilds/cross_mingw_core	2009-08-03 17:10:30 UTC (rev 5201)
@@ -0,0 +1,22 @@
+#!/bin/bash
+export PKG_CONFIG_PATH=$MINGW/lib/pkgconfig
+export PKG_CONFIG_LIBDIR=$MINGW/lib/pkgconfig
+export CXXFLAGS=&quot;-I$MINGW/include -I/usr/i586-mingw32msvc/include&quot;
+export CFLAGS=&quot;-I$MINGW/include -I/usr/i586-mingw32msvc/include&quot;
+export CPPFLAGS=&quot;-I$MINGW/include -I/usr/i586-mingw32msvc/include&quot;
+export LDFLAGS=&quot;-L$MINGW/lib -L/usr/i586-mingw32msvc/lib&quot;
+export PATH=$MINGW/bin:$PATH
+pkg-config --list-all
+#export DEBUG=&quot;-DVERBOSE=1   -DCMAKE_BUILD_TYPE=Debug -G \&quot;CodeBlocks - Unix Makefiles\&quot;   &quot;
+echo &quot;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;Cross compiling core&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&quot;
+cmake   -DCROSS=$MINGW \
+        -DCMAKE_INCLUDE_PATH=$MINGW/include -DCMAKE_LIBRARY_PATH=$MINGW/lib \
+        -DCMAKE_INSTALL_PREFIX=$MINGW/Release \
+        -DCMAKE_C_COMPILER:STRING=$PREFIX-gcc \
+        -DCMAKE_CXX_COMPILER:STRING=$PREFIX-g++ \
+        -DCMAKE_LINKER:STRING=$PREFIX-ld \
+        -DCMAKE_AR:STRING=$PREFIX-ar \
+        -DCMAKE_SYSTEM_NAME:STRING=Windows \
+        $DEBUG\
+        -DAVIDEMUX_TOP_SOURCE_DIR=&quot;/home/fx/workspace/gitted/&quot;  \
+        $TOP/avidemux_core

Added: branches/avidemux_2.6_branch_mean/foreignBuilds/cross_mingw_plugins
===================================================================
--- branches/avidemux_2.6_branch_mean/foreignBuilds/cross_mingw_plugins	2009-08-03 16:33:52 UTC (rev 5200)
+++ branches/avidemux_2.6_branch_mean/foreignBuilds/cross_mingw_plugins	2009-08-03 17:10:30 UTC (rev 5201)
@@ -0,0 +1,23 @@
+#!/bin/bash
+export PKG_CONFIG_PATH=$MINGW/lib/pkgconfig
+export PKG_CONFIG_LIBDIR=$MINGW/lib/pkgconfig
+export CXXFLAGS=&quot;-I$MINGW/include -I/usr/i586-mingw32msvc/include&quot;
+export CFLAGS=&quot;-I$MINGW/include -I/usr/i586-mingw32msvc/include&quot;
+export CPPFLAGS=&quot;-I$MINGW/include -I/usr/i586-mingw32msvc/include&quot;
+export LDFLAGS=&quot;-L$MINGW/lib -L/usr/i586-mingw32msvc/lib&quot;
+export PATH=$MINGW/bin:$PATH
+pkg-config --list-all
+#export DEBUG=&quot;-DVERBOSE=1   -DCMAKE_BUILD_TYPE=Debug -G \&quot;CodeBlocks - Unix Makefiles\&quot;   &quot;
+echo &quot;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;Cross compiling plugins&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&quot;
+cmake   -DCROSS=$MINGW \
+        -DCMAKE_INCLUDE_PATH=$MINGW/include -DCMAKE_LIBRARY_PATH=$MINGW/lib \
+        -DCMAKE_INSTALL_PREFIX=$MINGW/Release \
+        -DCMAKE_C_COMPILER:STRING=$PREFIX-gcc \
+        -DCMAKE_CXX_COMPILER:STRING=$PREFIX-g++ \
+        -DCMAKE_LINKER:STRING=$PREFIX-ld \
+        -DCMAKE_AR:STRING=$PREFIX-ar \
+        -DCMAKE_SYSTEM_NAME:STRING=Windows \
+        -DQT_HOME:STRING=$QT_HOME \
+         $DEBUG -G &quot;CodeBlocks - Unix Makefiles&quot;  \
+        -DAVIDEMUX_SOURCE_DIR=&quot;/home/fx/workspace/gitted/&quot;  \
+        $TOP/avidemux_plugins

Added: branches/avidemux_2.6_branch_mean/foreignBuilds/cross_mingw_qt4
===================================================================
--- branches/avidemux_2.6_branch_mean/foreignBuilds/cross_mingw_qt4	2009-08-03 16:33:52 UTC (rev 5200)
+++ branches/avidemux_2.6_branch_mean/foreignBuilds/cross_mingw_qt4	2009-08-03 17:10:30 UTC (rev 5201)
@@ -0,0 +1,25 @@
+#!/bin/bash
+#
+export PKG_CONFIG_PATH=$MINGW/lib/pkgconfig
+export PKG_CONFIG_LIBDIR=$MINGW/lib/pkgconfig
+export CXXFLAGS=&quot;-I$MINGW/include -I/usr/i586-mingw32msvc/include&quot;
+export CFLAGS=&quot;-I$MINGW/include -I/usr/i586-mingw32msvc/include&quot;
+export CPPFLAGS=&quot;-I$MINGW/include -I/usr/i586-mingw32msvc/include&quot;
+export LDFLAGS=&quot;-L$MINGW/lib -L/usr/i586-mingw32msvc/lib&quot;
+export PATH=$MINGW/bin:$PATH
+pkg-config --list-all
+#export DEBUG=&quot;-DVERBOSE=1   -DCMAKE_BUILD_TYPE=Debug -G \&quot;CodeBlocks - Unix Makefiles\&quot;   &quot;
+echo &quot;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;Cross compiling core&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&quot;
+cmake   -DCROSS=$MINGW \
+        -DCMAKE_INCLUDE_PATH=$MINGW/include -DCMAKE_LIBRARY_PATH=$MINGW/lib \
+        -DCMAKE_INSTALL_PREFIX=$MINGW/Release \
+        -DCMAKE_C_COMPILER:STRING=$PREFIX-gcc \
+        -DCMAKE_CXX_COMPILER:STRING=$PREFIX-g++ \
+        -DCMAKE_LINKER:STRING=$PREFIX-ld \
+        -DCMAKE_AR:STRING=$PREFIX-ar \
+        -DCMAKE_SYSTEM_NAME:STRING=Windows \
+        -DQT_HOME:STRING=$QT_HOME \
+        $DEBUG \
+         -G &quot;CodeBlocks - Unix Makefiles&quot;  \
+        -DAVIDEMUX_TOP_SOURCE_DIR=&quot;/home/fx/workspace/gitted/&quot;  \
+        $TOP/avidemux/qt4


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="002414.html">[Avidemux-svn-commit] r5200 - in	branches/avidemux_2.5_branch_gruntster: avidemux/ADM_encoder	avidemux/ADM_outputs/oplug_mpegFF	plugins/ADM_videoEncoder/ADM_vidEnc_avcodec
</A></li>
	<LI>Next message: <A HREF="002416.html">[Avidemux-svn-commit] r5202 - in branches/avidemux_2.6_branch_mean:	avidemux avidemux/gtk avidemux/qt4 avidemux_core	avidemux_plugins cmake foreignBuilds
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2415">[ date ]</a>
              <a href="thread.html#2415">[ thread ]</a>
              <a href="subject.html#2415">[ subject ]</a>
              <a href="author.html#2415">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/avidemux-svn-commit">More information about the Avidemux-svn-commit
mailing list</a><br>
</body></html>
