<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Avidemux-svn-commit] r6957 - in branches/avidemux_2.6_branch_mean:	avidemux/common avidemux/common/ADM_audioFilter/src	avidemux/qt4/ADM_userInterfaces/ADM_dialog	avidemux/qt4/ADM_userInterfaces/ADM_gui	avidemux_core/ADM_core/src avidemux_core/ADM_coreUI/src	avidemux_plugins/ADM_demuxers/OpenDml cmake_compile_check
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/avidemux-svn-commit/2011-January/index.html" >
   <LINK REL="made" HREF="mailto:avidemux-svn-commit%40lists.berlios.de?Subject=Re%3A%20%5BAvidemux-svn-commit%5D%20r6957%20-%20in%20branches/avidemux_2.6_branch_mean%3A%0A%09avidemux/common%20avidemux/common/ADM_audioFilter/src%0A%09avidemux/qt4/ADM_userInterfaces/ADM_dialog%0A%09avidemux/qt4/ADM_userInterfaces/ADM_gui%0A%09avidemux_core/ADM_core/src%20avidemux_core/ADM_coreUI/src%0A%09avidemux_plugins/ADM_demuxers/OpenDml%20cmake_compile_check&In-Reply-To=%3C20110125072510.59F5B4812E5%40sheep.berlios.de%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="004130.html">
   <LINK REL="Next"  HREF="004132.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Avidemux-svn-commit] r6957 - in branches/avidemux_2.6_branch_mean:	avidemux/common avidemux/common/ADM_audioFilter/src	avidemux/qt4/ADM_userInterfaces/ADM_dialog	avidemux/qt4/ADM_userInterfaces/ADM_gui	avidemux_core/ADM_core/src avidemux_core/ADM_coreUI/src	avidemux_plugins/ADM_demuxers/OpenDml cmake_compile_check</H1>
    <B>mean at mail.berlios.de</B> 
    <A HREF="mailto:avidemux-svn-commit%40lists.berlios.de?Subject=Re%3A%20%5BAvidemux-svn-commit%5D%20r6957%20-%20in%20branches/avidemux_2.6_branch_mean%3A%0A%09avidemux/common%20avidemux/common/ADM_audioFilter/src%0A%09avidemux/qt4/ADM_userInterfaces/ADM_dialog%0A%09avidemux/qt4/ADM_userInterfaces/ADM_gui%0A%09avidemux_core/ADM_core/src%20avidemux_core/ADM_coreUI/src%0A%09avidemux_plugins/ADM_demuxers/OpenDml%20cmake_compile_check&In-Reply-To=%3C20110125072510.59F5B4812E5%40sheep.berlios.de%3E"
       TITLE="[Avidemux-svn-commit] r6957 - in branches/avidemux_2.6_branch_mean:	avidemux/common avidemux/common/ADM_audioFilter/src	avidemux/qt4/ADM_userInterfaces/ADM_dialog	avidemux/qt4/ADM_userInterfaces/ADM_gui	avidemux_core/ADM_core/src avidemux_core/ADM_coreUI/src	avidemux_plugins/ADM_demuxers/OpenDml cmake_compile_check">mean at mail.berlios.de
       </A><BR>
    <I>Tue Jan 25 08:25:10 CET 2011</I>
    <P><UL>
        <LI>Previous message: <A HREF="004130.html">[Avidemux-svn-commit] r6956 -	branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_demuxers/Mp4
</A></li>
        <LI>Next message: <A HREF="004132.html">[Avidemux-svn-commit] r6958 -	branches/avidemux_2.6_branch_mean/cmake
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#4131">[ date ]</a>
              <a href="thread.html#4131">[ thread ]</a>
              <a href="subject.html#4131">[ subject ]</a>
              <a href="author.html#4131">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Author: mean
Date: 2011-01-25 08:25:10 +0100 (Tue, 25 Jan 2011)
New Revision: 6957

Modified:
   branches/avidemux_2.6_branch_mean/avidemux/common/ADM_audioFilter/src/audiofilter_normalize.cpp
   branches/avidemux_2.6_branch_mean/avidemux/common/gui_play.cpp
   branches/avidemux_2.6_branch_mean/avidemux/common/main.cpp
   branches/avidemux_2.6_branch_mean/avidemux/qt4/ADM_userInterfaces/ADM_dialog/Q_encoding.cpp
   branches/avidemux_2.6_branch_mean/avidemux/qt4/ADM_userInterfaces/ADM_gui/gui2.ui
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_core/src/ADM_cpuCap.cpp
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_core/src/ADM_memsupport.cpp
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreUI/src/DIA_encoding.cpp
   branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_demuxers/OpenDml/ADM_openDMLDepack.cpp
   branches/avidemux_2.6_branch_mean/cmake_compile_check/os_bsd_check.cpp
Log:
[haiku] First set of haiku patches by diger

Modified: branches/avidemux_2.6_branch_mean/avidemux/common/ADM_audioFilter/src/audiofilter_normalize.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/ADM_audioFilter/src/audiofilter_normalize.cpp	2011-01-24 18:57:46 UTC (rev 6956)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/ADM_audioFilter/src/audiofilter_normalize.cpp	2011-01-25 07:25:10 UTC (rev 6957)
@@ -30,7 +30,7 @@
 
 #include &quot;ADM_coreAudio.h&quot;
 
-#ifdef __WIN32
+#if defined (__WIN32) || defined (__HAIKU__)
 #define POW10(x)   pow(10,x)
 #elif defined(ADM_BSD_FAMILY)
 #define POW10(x) powf(10.0,x)

Modified: branches/avidemux_2.6_branch_mean/avidemux/common/gui_play.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/gui_play.cpp	2011-01-24 18:57:46 UTC (rev 6956)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/gui_play.cpp	2011-01-25 07:25:10 UTC (rev 6957)
@@ -122,9 +122,11 @@
     oldTimeFrame=admPreview::getCurrentPts();
 	uint32_t priorityLevel;
 
+	#ifndef __HAIKU__
 	originalPriority = getpriority(PRIO_PROCESS, 0);
 	prefs-&gt;get(PRIORITY_PLAYBACK,&amp;priorityLevel);
 	setpriority(PRIO_PROCESS, 0, ADM_getNiceValue(priorityLevel));
+	#endif
 
     stop_req = 0;
     playing = 1;
@@ -186,7 +188,9 @@
         }
         videoFilter=NULL; // it has been destroyed by the chain
        // done.
+	   #ifndef __HAIKU__
 	   setpriority(PRIO_PROCESS, 0, originalPriority);
+	   #endif
        return true;
 }
 

Modified: branches/avidemux_2.6_branch_mean/avidemux/common/main.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/common/main.cpp	2011-01-24 18:57:46 UTC (rev 6956)
+++ branches/avidemux_2.6_branch_mean/avidemux/common/main.cpp	2011-01-25 07:25:10 UTC (rev 6957)
@@ -45,7 +45,11 @@
 
 #ifdef USE_SDL
 extern &quot;C&quot; {
+	#ifdef __HAIKU__
+	#include &quot;SDL/SDL.h&quot;
+	#else
 	#include &quot;SDL.h&quot;
+	#endif
 }
 
 #include &quot;ADM_render/GUI_sdlRender.h&quot;

Modified: branches/avidemux_2.6_branch_mean/avidemux/qt4/ADM_userInterfaces/ADM_dialog/Q_encoding.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/qt4/ADM_userInterfaces/ADM_dialog/Q_encoding.cpp	2011-01-24 18:57:46 UTC (rev 6956)
+++ branches/avidemux_2.6_branch_mean/avidemux/qt4/ADM_userInterfaces/ADM_dialog/Q_encoding.cpp	2011-01-25 07:25:10 UTC (rev 6957)
@@ -79,7 +79,9 @@
 	}
 #endif
 
+	#ifndef __HAIKU__
 	setpriority(PRIO_PROCESS, 0, ADM_getNiceValue(priorityLevel));
+	#endif
 }
 
 void encodingWindow::shutdownChanged(int state)

Modified: branches/avidemux_2.6_branch_mean/avidemux/qt4/ADM_userInterfaces/ADM_gui/gui2.ui
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux/qt4/ADM_userInterfaces/ADM_gui/gui2.ui	2011-01-24 18:57:46 UTC (rev 6956)
+++ branches/avidemux_2.6_branch_mean/avidemux/qt4/ADM_userInterfaces/ADM_gui/gui2.ui	2011-01-25 07:25:10 UTC (rev 6957)
@@ -7,10 +7,16 @@
    &lt;rect&gt;
     &lt;x&gt;0&lt;/x&gt;
     &lt;y&gt;0&lt;/y&gt;
-    &lt;width&gt;659&lt;/width&gt;
-    &lt;height&gt;642&lt;/height&gt;
+    &lt;width&gt;640&lt;/width&gt;
+    &lt;height&gt;640&lt;/height&gt;
    &lt;/rect&gt;
   &lt;/property&gt;
+  &lt;property name=&quot;minimumSize&quot;&gt;
+   &lt;size&gt;
+    &lt;width&gt;640&lt;/width&gt;
+    &lt;height&gt;640&lt;/height&gt;
+   &lt;/size&gt;
+  &lt;/property&gt;
   &lt;property name=&quot;windowTitle&quot;&gt;
    &lt;string&gt;Avidemux&lt;/string&gt;
   &lt;/property&gt;
@@ -99,8 +105,8 @@
     &lt;rect&gt;
      &lt;x&gt;0&lt;/x&gt;
      &lt;y&gt;0&lt;/y&gt;
-     &lt;width&gt;659&lt;/width&gt;
-     &lt;height&gt;22&lt;/height&gt;
+     &lt;width&gt;640&lt;/width&gt;
+     &lt;height&gt;19&lt;/height&gt;
     &lt;/rect&gt;
    &lt;/property&gt;
    &lt;widget class=&quot;QMenu&quot; name=&quot;menuHelp&quot;&gt;
@@ -1266,8 +1272,8 @@
    &lt;/property&gt;
    &lt;property name=&quot;minimumSize&quot;&gt;
     &lt;size&gt;
-     &lt;width&gt;120&lt;/width&gt;
-     &lt;height&gt;0&lt;/height&gt;
+     &lt;width&gt;136&lt;/width&gt;
+     &lt;height&gt;137&lt;/height&gt;
     &lt;/size&gt;
    &lt;/property&gt;
    &lt;property name=&quot;features&quot;&gt;

Modified: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_core/src/ADM_cpuCap.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_core/src/ADM_cpuCap.cpp	2011-01-24 18:57:46 UTC (rev 6956)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_core/src/ADM_cpuCap.cpp	2011-01-25 07:25:10 UTC (rev 6957)
@@ -14,7 +14,7 @@
 
 #if defined(__MINGW32__)
 #include &lt;pthread.h&gt;
-#elif defined(__APPLE__) || defined(ADM_BSD_FAMILY)
+#elif defined(__APPLE__) || defined(ADM_BSD_FAMILY) &amp;&amp; !defined(__HAIKU__)
 #include &lt;sys/types.h&gt;
 #include &lt;sys/sysctl.h&gt;
 #else
@@ -148,7 +148,7 @@
 {
 #if defined(__MINGW32__)
     return pthread_num_processors_np();
-#elif defined(__APPLE__) || defined(ADM_BSD_FAMILY)
+#elif defined(__APPLE__) || defined(ADM_BSD_FAMILY) &amp;&amp; !defined(__HAIKU__)
     int np;
 
     size_t length = sizeof(np);

Modified: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_core/src/ADM_memsupport.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_core/src/ADM_memsupport.cpp	2011-01-24 18:57:46 UTC (rev 6956)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_core/src/ADM_memsupport.cpp	2011-01-25 07:25:10 UTC (rev 6957)
@@ -90,7 +90,7 @@
 
 void *ADM_alloc(size_t size)
 {
-#if defined(__APPLE__) || defined(__WIN64)
+#if defined(__APPLE__) || defined(__WIN64) || defined(__HAIKU__)
 	return malloc(size);
 #else
 	char *c;
@@ -127,7 +127,7 @@
 
 void ADM_dezalloc(void *ptr)
 {
-#if defined(__APPLE__) || defined(__WIN64)
+#if defined(__APPLE__) || defined(__WIN64) || defined(__HAIKU__)
 	if (!ptr)
 		return;
 
@@ -238,7 +238,7 @@
  */
 void *ADM_realloc(void *ptr, size_t newsize)
 {
-#if defined(__APPLE__) || defined(__WIN64)
+#if defined(__APPLE__) || defined(__WIN64) || defined(__HAIKU__)
 	if(!ptr)
 		return ADM_alloc(newsize);
 

Modified: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreUI/src/DIA_encoding.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreUI/src/DIA_encoding.cpp	2011-01-24 18:57:46 UTC (rev 6956)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_coreUI/src/DIA_encoding.cpp	2011-01-25 07:25:10 UTC (rev 6957)
@@ -28,7 +28,9 @@
 */
 DIA_encodingBase::DIA_encodingBase( uint64_t duration )
 {
+        #ifndef __HAIKU__
         _originalPriority=getpriority(PRIO_PROCESS, 0);
+        #endif
         _totalDurationUs=duration;
 #ifdef __WIN32
         _originalPriority=getpriority(PRIO_PROCESS, 0);

Modified: branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_demuxers/OpenDml/ADM_openDMLDepack.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_demuxers/OpenDml/ADM_openDMLDepack.cpp	2011-01-24 18:57:46 UTC (rev 6956)
+++ branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_demuxers/OpenDml/ADM_openDMLDepack.cpp	2011-01-25 07:25:10 UTC (rev 6957)
@@ -84,7 +84,9 @@
 							// Assume MAX_VOP Bframes maximum
 	ADM_assert(newIndex);
 
+	#ifndef __HAIKU__
 	uint32_t originalPriority = getpriority(PRIO_PROCESS, 0);
+	#endif
 	uint32_t priorityLevel;
 #if 0
 	prefs-&gt;get(PRIORITY_INDEXING,&amp;priorityLevel);
@@ -222,7 +224,9 @@
 	printf(&quot;[Avi] Initial # of images : %&quot;LU&quot;, now we have %&quot;LU&quot; \n&quot;,nbFrame,targetIndex);
 	nbFrame=targetIndex;
 
+	#ifndef __HAIKU__
 	setpriority(PRIO_PROCESS, 0, originalPriority);
+	#endif
 
 	return ret;
 }

Modified: branches/avidemux_2.6_branch_mean/cmake_compile_check/os_bsd_check.cpp
===================================================================
--- branches/avidemux_2.6_branch_mean/cmake_compile_check/os_bsd_check.cpp	2011-01-24 18:57:46 UTC (rev 6956)
+++ branches/avidemux_2.6_branch_mean/cmake_compile_check/os_bsd_check.cpp	2011-01-25 07:25:10 UTC (rev 6957)
@@ -1,6 +1,6 @@
 int main(int a, char **b)
 {
-#if defined(__APPLE__) || defined(__FreeBSD__) || defined(__DragonFly__) || defined(__NetBSD__) || defined(__OpenBSD__)
+#if defined(__APPLE__) || defined(__FreeBSD__) || defined(__DragonFly__) || defined(__NetBSD__) || defined(__OpenBSD__) || defined(__HAIKU__)
 	return 0;
 #else
 #error Unable to detect GCC for BSD family


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="004130.html">[Avidemux-svn-commit] r6956 -	branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_demuxers/Mp4
</A></li>
	<LI>Next message: <A HREF="004132.html">[Avidemux-svn-commit] r6958 -	branches/avidemux_2.6_branch_mean/cmake
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#4131">[ date ]</a>
              <a href="thread.html#4131">[ thread ]</a>
              <a href="subject.html#4131">[ subject ]</a>
              <a href="author.html#4131">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/avidemux-svn-commit">More information about the Avidemux-svn-commit
mailing list</a><br>
</body></html>
