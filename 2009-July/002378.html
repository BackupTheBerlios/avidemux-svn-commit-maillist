<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Avidemux-svn-commit] r5163 - in	branches/avidemux_2.5_branch_gruntster:	avidemux/ADM_UIs/ADM_GTK/src avidemux/ADM_UIs/ADM_QT4/src	avidemux/ADM_coreUI/include avidemux/ADM_coreUI/src	plugins/ADM_videoEncoder/ADM_vidEnc_avcodec
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/avidemux-svn-commit/2009-July/index.html" >
   <LINK REL="made" HREF="mailto:avidemux-svn-commit%40lists.berlios.de?Subject=Re%3A%20%5BAvidemux-svn-commit%5D%20r5163%20-%20in%0A%09branches/avidemux_2.5_branch_gruntster%3A%0A%09avidemux/ADM_UIs/ADM_GTK/src%20avidemux/ADM_UIs/ADM_QT4/src%0A%09avidemux/ADM_coreUI/include%20avidemux/ADM_coreUI/src%0A%09plugins/ADM_videoEncoder/ADM_vidEnc_avcodec&In-Reply-To=%3C200907272047.n6RKl7Aq014447%40sheep.berlios.de%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="002377.html">
   <LINK REL="Next"  HREF="002379.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Avidemux-svn-commit] r5163 - in	branches/avidemux_2.5_branch_gruntster:	avidemux/ADM_UIs/ADM_GTK/src avidemux/ADM_UIs/ADM_QT4/src	avidemux/ADM_coreUI/include avidemux/ADM_coreUI/src	plugins/ADM_videoEncoder/ADM_vidEnc_avcodec</H1>
    <B>gruntster at mail.berlios.de</B> 
    <A HREF="mailto:avidemux-svn-commit%40lists.berlios.de?Subject=Re%3A%20%5BAvidemux-svn-commit%5D%20r5163%20-%20in%0A%09branches/avidemux_2.5_branch_gruntster%3A%0A%09avidemux/ADM_UIs/ADM_GTK/src%20avidemux/ADM_UIs/ADM_QT4/src%0A%09avidemux/ADM_coreUI/include%20avidemux/ADM_coreUI/src%0A%09plugins/ADM_videoEncoder/ADM_vidEnc_avcodec&In-Reply-To=%3C200907272047.n6RKl7Aq014447%40sheep.berlios.de%3E"
       TITLE="[Avidemux-svn-commit] r5163 - in	branches/avidemux_2.5_branch_gruntster:	avidemux/ADM_UIs/ADM_GTK/src avidemux/ADM_UIs/ADM_QT4/src	avidemux/ADM_coreUI/include avidemux/ADM_coreUI/src	plugins/ADM_videoEncoder/ADM_vidEnc_avcodec">gruntster at mail.berlios.de
       </A><BR>
    <I>Mon Jul 27 22:47:07 CEST 2009</I>
    <P><UL>
        <LI>Previous message: <A HREF="002377.html">[Avidemux-svn-commit] r5162 - in	branches/avidemux_2.5_branch_gruntster: cmake	plugins/ADM_audioDecoders
</A></li>
        <LI>Next message: <A HREF="002379.html">[Avidemux-svn-commit] r5164 -	branches/avidemux_2.6_branch_mean/cmake
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2378">[ date ]</a>
              <a href="thread.html#2378">[ thread ]</a>
              <a href="subject.html#2378">[ subject ]</a>
              <a href="author.html#2378">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Author: gruntster
Date: 2009-07-27 22:46:59 +0200 (Mon, 27 Jul 2009)
New Revision: 5163

Modified:
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_UIs/ADM_GTK/src/DIA_dialogFactory.cpp
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_UIs/ADM_GTK/src/FAC_configMenu.cpp
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_UIs/ADM_QT4/src/T_configMenu.cpp
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_UIs/ADM_QT4/src/T_configMenu.h
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_UIs/ADM_QT4/src/T_dialogFactory.cpp
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_UIs/ADM_QT4/src/T_menu.cpp
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_UIs/ADM_QT4/src/T_menu.h
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_coreUI/include/DIA_factory.h
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_coreUI/src/DIA_factory.cpp
   branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_avcodec/mpeg1Encoder.cpp
Log:
[dlgFactory] trigger custom profile on Qt config menu

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_UIs/ADM_GTK/src/DIA_dialogFactory.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_UIs/ADM_GTK/src/DIA_dialogFactory.cpp	2009-07-27 19:19:24 UTC (rev 5162)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_UIs/ADM_GTK/src/DIA_dialogFactory.cpp	2009-07-27 20:46:59 UTC (rev 5163)
@@ -133,7 +133,7 @@
 	gtk_box_set_spacing(GTK_BOX(dialog_vbox1), 12);
 	gtk_widget_show(dialog_vbox1);
 
-	if (headerControls)
+	if (headerControls)
 		addControls(dialog, dialog_vbox1, headerControls, headerControlCount);
 
 	notebook1 = gtk_notebook_new();
@@ -142,8 +142,11 @@
 	gtk_container_set_border_width(GTK_CONTAINER(notebook1), 6);
 
 	for (int i = 0; i &lt; tabControlCount; i++)
-		buildOneTab(notebook1, i, tabControls[i]); 
+		buildOneTab(notebook1, i, tabControls[i]);
 
+	for (int i = 0; i &lt; headerControlCount; i++)
+		headerControls[i]-&gt;finalize();
+
 	addButtonBox(dialog);
 
 	// Show it &amp; run
@@ -303,7 +306,7 @@
 extern DELETE_DIA_ELEM_T    gtkDestroyUSlider;
 extern 	CREATE_SLIDER_T     gtkCreateSlider;
 extern 	DELETE_DIA_ELEM_T   gtkDestroySlider;
-extern CREATE_CONFIG_MENU_T gtkCreateConfigMenu;
+extern CREATE_CONFIG_MENU_T gtkCreateConfigMenu;
 extern DELETE_DIA_ELEM_T    gtkDestroyConfigMenu;
 /**
  *  \fn gtkFactoryGetVersion

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_UIs/ADM_GTK/src/FAC_configMenu.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_UIs/ADM_GTK/src/FAC_configMenu.cpp	2009-07-27 19:19:24 UTC (rev 5162)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_UIs/ADM_GTK/src/FAC_configMenu.cpp	2009-07-27 20:46:59 UTC (rev 5163)
@@ -238,6 +238,7 @@
 		void enable(uint32_t onoff);
 		int getRequiredLayout(void);
 		void updateMe(void);
+		void finalize(void);
 	};
 
 	diaElemConfigMenu::diaElemConfigMenu(const char* userConfigDir, const char* systemConfigDir, CONFIG_MENU_CHANGED_T *changedFunc,
@@ -304,6 +305,11 @@
 	void diaElemConfigMenu::enable(uint32_t onoff) { }
 	int diaElemConfigMenu::getRequiredLayout(void) { return 0; }
 	void diaElemConfigMenu::updateMe(void) { }
+
+	void diaElemConfigMenu::finalize(void)
+	{
+
+	}
 }
 
 diaElem* gtkCreateConfigMenu(const char* userConfigDir, const char* systemConfigDir, CONFIG_MENU_CHANGED_T *changedFunc, 

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_UIs/ADM_QT4/src/T_configMenu.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_UIs/ADM_QT4/src/T_configMenu.cpp	2009-07-27 19:19:24 UTC (rev 5162)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_UIs/ADM_QT4/src/T_configMenu.cpp	2009-07-27 20:46:59 UTC (rev 5163)
@@ -13,7 +13,9 @@
 *                                                                         *
 ***************************************************************************/
 
+#include &lt;QtGui/QApplication&gt;
 #include &lt;QtGui/QFileDialog&gt;
+
 #include &quot;T_configMenu.h&quot;
 #include &quot;ADM_dialogFactoryQt4.h&quot;
 #include &quot;ADM_files.h&quot;
@@ -32,6 +34,8 @@
 		const char* userConfigDir, const char* systemConfigDir, CONFIG_MENU_CHANGED_T *changedFunc, 
 		CONFIG_MENU_SERIALIZE_T *serializeFunc, diaElem **controls, unsigned int controlCount) : QWidget(widget) 
 	{
+		disableGenericSlots = false;
+
 		this-&gt;userConfigDir = userConfigDir;
 		this-&gt;systemConfigDir = systemConfigDir;
 
@@ -67,6 +71,36 @@
 	{
 	}
 
+	void ADM_QconfigMenu::generic_currentIndexChanged(int index)
+	{
+		if (!disableGenericSlots)
+			combobox-&gt;setCurrentIndex(1);
+	}
+
+	void ADM_QconfigMenu::generic_valueChanged(int value)
+	{
+		if (!disableGenericSlots)
+			combobox-&gt;setCurrentIndex(1);
+	}
+
+	void ADM_QconfigMenu::generic_valueChanged(double value)
+	{
+		if (!disableGenericSlots)
+			combobox-&gt;setCurrentIndex(1);
+	}
+
+	void ADM_QconfigMenu::generic_pressed(void)
+	{
+		if (!disableGenericSlots)
+			combobox-&gt;setCurrentIndex(1);
+	}
+
+	void ADM_QconfigMenu::generic_textEdited(QString text)
+	{
+		if (!disableGenericSlots)
+			combobox-&gt;setCurrentIndex(1);
+	}
+
 	void ADM_QconfigMenu::fillConfigurationComboBox(void)
 	{
 		bool origDisableGenericSlots = disableGenericSlots;
@@ -74,6 +108,8 @@
 		QStringList filter(&quot;*.xml&quot;);
 		QStringList list = QDir(this-&gt;userConfigDir).entryList(filter, QDir::Files | QDir::Readable);
 
+		disableGenericSlots = true;
+
 		for (int item = 0; item &lt; list.size(); item++)
 			configs.insert(QFileInfo(list[item]).completeBaseName(), CONFIG_MENU_USER);
 
@@ -102,6 +138,8 @@
 		bool success = false;
 		bool origDisableGenericSlots = disableGenericSlots;
 
+		disableGenericSlots = true;
+
 		if (configurationType == CONFIG_MENU_DEFAULT)
 		{
 			combobox-&gt;setCurrentIndex(0);
@@ -180,13 +218,18 @@
 		disableGenericSlots = true;
 		deleteButton-&gt;setEnabled(configType == CONFIG_MENU_USER);
 
+		for (int i = 0; i &lt; this-&gt;controlCount; i++)
+			this-&gt;controls[i]-&gt;getMe();
+
 		if (changedFunc)
 		{
-			if (!changedFunc(combobox-&gt;itemText(index).toUtf8().constData(), configType))
+			if (changedFunc(combobox-&gt;itemText(index).toUtf8().constData(), configType))
+			{
+				for (int i = 0; i &lt; this-&gt;controlCount; i++)
+					this-&gt;controls[i]-&gt;updateMe();
+			}
+			else
 				combobox-&gt;setCurrentIndex(0);
-
-			for (int i = 0; i &lt; this-&gt;controlCount; i++)
-				this-&gt;controls[i]-&gt;updateMe();
 		}
 
 		disableGenericSlots = origDisableGenericSlots;
@@ -211,6 +254,7 @@
 		void enable(uint32_t onoff);
 		int getRequiredLayout(void);
 		void updateMe(void);
+		void finalize(void);
 	};
 
 	diaElemConfigMenu::diaElemConfigMenu(const char* userConfigDir, const char* systemConfigDir, CONFIG_MENU_CHANGED_T *changedFunc,
@@ -241,15 +285,6 @@
 
 	void diaElemConfigMenu::getMe(void)
 	{
-		/*ADM_QconfigMenu *configMenu = (ADM_QconfigMenu*)myWidget;
-		uint32_t *val = (uint32_t*)param;
-
-		if ((configMenu-&gt;radiobutton1)-&gt;isChecked())
-			*val = 1;
-		else if ((configMenu-&gt;radiobutton2)-&gt;isChecked())
-			*val = 0;
-		else
-			*val = (configMenu-&gt;spinBox)-&gt;value(); */
 	}
 
 	void diaElemConfigMenu::enable(uint32_t onoff)
@@ -264,6 +299,44 @@
 	void diaElemConfigMenu::updateMe(void)
 	{
 	}
+
+	void diaElemConfigMenu::finalize(void)
+	{
+		ADM_QconfigMenu *configMenu = (ADM_QconfigMenu*)myWidget;
+		QWidgetList widgetList = QApplication::allWidgets();
+
+		for (int widgetIndex = 0; widgetIndex &lt; widgetList.size(); widgetIndex++)
+		{
+			QWidget *widget = widgetList.at(widgetIndex);
+			QWidget *parentWidget = widget;
+
+			if (widget != configMenu-&gt;combobox &amp;&amp; widget != configMenu-&gt;label &amp;&amp; 
+				widget != configMenu-&gt;deleteButton &amp;&amp; widget != configMenu-&gt;saveAsButton)
+			{
+				do
+				{
+					if (parentWidget == configMenu-&gt;combobox-&gt;parent())
+					{
+						if (widget-&gt;inherits(&quot;QComboBox&quot;))
+							QObject::connect(widget, SIGNAL(currentIndexChanged(int)), configMenu, SLOT(generic_currentIndexChanged(int)));
+						else if (widget-&gt;inherits(&quot;QSpinBox&quot;))
+							QObject::connect(widget, SIGNAL(valueChanged(int)), configMenu, SLOT(generic_valueChanged(int)));
+						else if (widget-&gt;inherits(&quot;QDoubleSpinBox&quot;))
+							QObject::connect(widget, SIGNAL(valueChanged(double)), configMenu, SLOT(generic_valueChanged(double)));
+						else if (widget-&gt;inherits(&quot;QCheckBox&quot;))
+							QObject::connect(widget, SIGNAL(pressed()), configMenu, SLOT(generic_pressed()));
+						else if (widget-&gt;inherits(&quot;QRadioButton&quot;))
+							QObject::connect(widget, SIGNAL(pressed()), configMenu, SLOT(generic_pressed()));
+						else if (widget-&gt;inherits(&quot;QLineEdit&quot;))
+							QObject::connect(widget, SIGNAL(textEdited(QString)), configMenu, SLOT(generic_textEdited(QString)));
+					}
+
+					parentWidget = (QWidget*)parentWidget-&gt;parent();
+				}
+				while (parentWidget != NULL);
+			}
+		}
+	}
 }
 
 diaElem* qt4CreateConfigMenu(const char* userConfigDir, const char* systemConfigDir, CONFIG_MENU_CHANGED_T *changedFunc, 

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_UIs/ADM_QT4/src/T_configMenu.h
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_UIs/ADM_QT4/src/T_configMenu.h	2009-07-27 19:19:24 UTC (rev 5162)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_UIs/ADM_QT4/src/T_configMenu.h	2009-07-27 20:46:59 UTC (rev 5163)
@@ -21,7 +21,6 @@
 		CONFIG_MENU_CHANGED_T *changedFunc;
 		CONFIG_MENU_SERIALIZE_T *serializeFunc;
 
-		void fillConfigurationComboBox(void);
 		bool selectConfiguration(QString *selectFile, ConfigMenuType configurationType);
 
 	public slots:
@@ -29,6 +28,12 @@
 		void saveAsClicked(bool checked);
 		void comboboxIndexChanged(int index);
 
+		void generic_currentIndexChanged(int index);
+		void generic_valueChanged(int value);
+		void generic_valueChanged(double value);
+		void generic_pressed(void);
+		void generic_textEdited(QString text);
+
 	public:
 		QLabel *label;
 		QComboBox *combobox;
@@ -39,6 +44,7 @@
 			const char* userConfigDir, const char* systemConfigDir, CONFIG_MENU_CHANGED_T *changedFunc,
 			CONFIG_MENU_SERIALIZE_T *serializeFunc, diaElem **controls, unsigned int controlCount);
 		~ADM_QconfigMenu();
+		void fillConfigurationComboBox(void);
 	};
 }
 #endif	// T_configMenu_h

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_UIs/ADM_QT4/src/T_dialogFactory.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_UIs/ADM_QT4/src/T_dialogFactory.cpp	2009-07-27 19:19:24 UTC (rev 5162)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_UIs/ADM_QT4/src/T_dialogFactory.cpp	2009-07-27 20:46:59 UTC (rev 5163)
@@ -113,7 +113,7 @@
   QVBoxLayout *vboxLayout = new QVBoxLayout();
   QGridLayout *layout = new QGridLayout();
   QSpacerItem *spacer = new QSpacerItem(20, 16, QSizePolicy::Minimum, QSizePolicy::Fixed);
-  QTabWidget *wtabs = new QTabWidget();
+  QTabWidget *wtabs = new QTabWidget(&amp;dialog);
   QDialogButtonBox *buttonBox = new QDialogButtonBox();
 
   if (headerControls)
@@ -125,6 +125,9 @@
         insertTab(i,tabControls[i],wtabs);
       }
 
+	 for (int i = 0; i &lt; headerControlCount; i++)
+		 headerControls[i]-&gt;finalize();
+
 	 buttonBox-&gt;setStandardButtons(QDialogButtonBox::Ok | QDialogButtonBox::Cancel);
 
      QObject::connect(buttonBox, SIGNAL(accepted()), &amp;dialog, SLOT(accept()));

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_UIs/ADM_QT4/src/T_menu.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_UIs/ADM_QT4/src/T_menu.cpp	2009-07-27 19:19:24 UTC (rev 5162)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_UIs/ADM_QT4/src/T_menu.cpp	2009-07-27 20:46:59 UTC (rev 5163)
@@ -46,7 +46,7 @@
 
 /**/
 
-ADM_QComboBox::ADM_QComboBox(diaElemMenuDynamic *menu)
+ADM_QComboBox::ADM_QComboBox(QWidget *parent, diaElemMenuDynamic *menu) : QComboBox(parent)
 {
 	_menu=menu;
 }
@@ -145,7 +145,7 @@
 }
 void diaElemMenuDynamic::setMe(void *dialog, void *opaque,uint32_t line)
 {
-  ADM_QComboBox *combo=new ADM_QComboBox(this);
+  ADM_QComboBox *combo=new ADM_QComboBox((QWidget*)dialog, this);
 
   QGridLayout *layout=(QGridLayout*) opaque;
      myWidget=(void *)combo; 

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_UIs/ADM_QT4/src/T_menu.h
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_UIs/ADM_QT4/src/T_menu.h	2009-07-27 19:19:24 UTC (rev 5162)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_UIs/ADM_QT4/src/T_menu.h	2009-07-27 20:46:59 UTC (rev 5163)
@@ -34,7 +34,7 @@
 		diaElemMenuDynamic *_menu;
 
 	public:
-		ADM_QComboBox(diaElemMenuDynamic *menu);
+		ADM_QComboBox(QWidget *parent, diaElemMenuDynamic *menu);
 		void connectMe(void);
 	};
 }

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_coreUI/include/DIA_factory.h
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_coreUI/include/DIA_factory.h	2009-07-27 19:19:24 UTC (rev 5162)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_coreUI/include/DIA_factory.h	2009-07-27 20:46:59 UTC (rev 5163)
@@ -1,691 +1,692 @@
-/***************************************************************************
-                          DIA_factory.h
-  Handles univeral dialog
-  
-  DO NOT USE TEMPLATE HERE!
-  
-  (C) Mean 2006 <A HREF="https://lists.berlios.de/mailman/listinfo/avidemux-svn-commit">fixounet at free.fr</A>
-
- ***************************************************************************/
-
-/***************************************************************************
- *                                                                         *
- *   This program is free software; you can redistribute it and/or modify  *
- *   it under the terms of the GNU General Public License as published by  *
- *   the Free Software Foundation; either version 2 of the License, or     *
- *   (at your option) any later version.                                   *
- *                                                                         *
- ***************************************************************************/
-#ifndef DIA_FACTORY_H
-#define DIA_FACTORY_H
-
-#include &quot;ADM_assert.h&quot;
-
-#define ADM_COREUI_MAJOR 1
-#define ADM_COREUI_MINOR 0
-#define ADM_COREUI_PATCH 1
-
-typedef enum 
-{
-  ELEM_INVALID=0,
-  ELEM_TOGGLE,
-  ELEM_INTEGER,
-  ELEM_FLOAT,
-  ELEM_MENU,
-  ELEM_FILE_READ,
-  ELEM_BITRATE,
-  ELEM_BAR,
-  ELEM_ROTEXT,
-  ELEM_NOTCH,
-  ELEM_DIR_SELECT,
-  ELEM_TEXT,
-  ELEM_FRAME,
-  ELEM_HEXDUMP,
-  ELEM_TOGGLE_UINT,
-  ELEM_TOGGLE_INT,
-  ELEM_BUTTON,
-  ELEM_SLIDER,
-  ELEM_THREAD_COUNT,
-  ELEM_MATRIX,
-  ELEM_ASPECT_RATIO,
-  ELEM_CONFIG_MENU,
-  ELEM_COUNT,
-  ELEM_MAX=ELEM_COUNT-1
-}elemEnum;
-typedef void ADM_FAC_CALLBACK(void *cookie);
-
-#define ELEM_TYPE_FLOAT float
-
-/*********************************************/
-class diaElem
-{
-  protected:
-    int     readOnly;
-    diaElem    *internalPointer;
-public:
-  void *param;
-  void *myWidget;
-  const char *paramTitle;
-  const char *tip;
-  elemEnum mySelf;
-  int       size; // Size of the widget in line
-
-  diaElem(elemEnum num) {paramTitle=NULL;param=NULL;mySelf=num;myWidget=NULL;size=1;readOnly=0;internalPointer=NULL;};
-  virtual int getSize(void) {return size;};
-  virtual void setSize(int z) {size=z;};
-  virtual ~diaElem() {};
-  virtual void setMe(void *dialog, void *opaque,uint32_t line)=0;
-  virtual void getMe(void)=0;
-  virtual void setRo(void) {readOnly=1;}
-  virtual void setRw(void) {readOnly=0;}
-          
-  virtual void enable(uint32_t onoff) {}
-  virtual void finalize(void) {} // in case some widget needs some stuff just before using them
-  virtual int getRequiredLayout(void)=0;
-  virtual void updateMe(void) = 0;
-};
-/*********************************************/
-#define MENU_MAX_lINK 10
-typedef struct dialElemLink
-{
-  uint32_t  value;
-  uint32_t  onoff;
-  diaElem  *widget;
-}dialElemLink;
-/*********************************************/
-
-typedef void      DELETE_DIA_ELEM_T(diaElem *widget);
-typedef void      FINALIZE_DIA_ELEM_T(void);
-typedef void      COREUI_GET_VERSION(uint32_t *maj,uint32_t *min,uint32_t *patch);
-/*********************************************/
-typedef diaElem  *(CREATE_BUTTON_T)(const char *toggleTitle, ADM_FAC_CALLBACK *cb,void *cookie,const char *tip);
-class diaElemButton : public diaElem
-{
-  protected:
-  public:
-    void            *_cookie;
-    ADM_FAC_CALLBACK *_callBack;
-            diaElemButton(const char *toggleTitle, ADM_FAC_CALLBACK *cb,void *cookie,const char *tip=NULL);
-  virtual   ~diaElemButton() ;
-  void      setMe(void *dialog, void *opaque,uint32_t line);
-  void      getMe(void);
-  void      enable(uint32_t onoff) ;
-  int getRequiredLayout(void);
-  void updateMe(void);
-};
-
-/*********************************************/
-typedef diaElem  *(CREATE_MATRIX_T)(uint8_t *trix,const char *toggleTitle, uint32_t trixSize,const char *tip);
-
-class diaElemMatrix : public diaElem
-{
-  protected:
-  public:
-    uint8_t *_matrix;
-    uint32_t _matrixSize;
-    		diaElemMatrix(uint8_t *trix,const char *toggleTitle, uint32_t trixSize,const char *tip=NULL);
-  virtual   ~diaElemMatrix() ;
-  void      setMe(void *dialog, void *opaque,uint32_t line);
-  void      getMe(void);
-  void      enable(uint32_t onoff) ;
-  int getRequiredLayout(void);
-  void updateMe(void);
-};
-/************************************/
-class diaElemSliderBase : public diaElem
-{
-  protected:
-    
-      uint32_t digits;
-public:
-	                diaElemSliderBase() : diaElem(ELEM_SLIDER) {}
-  virtual           ~diaElemSliderBase() {};
-  virtual uint8_t   setDigits(uint32_t digits) { this-&gt;digits = digits; }
-};
-
-typedef diaElem *CREATE_USLIDER_T(uint32_t *value,const char *toggleTitle, uint32_t min,uint32_t max,uint32_t incr , const char *tip);
-typedef diaElem *CREATE_SLIDER_T(int32_t *value,const char *toggleTitle, int32_t min,int32_t max,int32_t incr , const char *tip);
-class diaElemUSlider : public diaElemSliderBase
-{
-  protected:
-	  uint32_t min,max,incr;
-public:
-	diaElemUSlider(uint32_t *value,const char *toggleTitle, uint32_t min,uint32_t max,uint32_t incr = 1, const char *tip=NULL);
-  virtual   ~diaElemUSlider() ;
-  void      setMe(void *dialog, void *opaque,uint32_t line);
-  void      getMe(void);
-  void      enable(uint32_t onoff) ;
-  uint8_t   setDigits(uint32_t digits) ;
-  int getRequiredLayout(void);
-  void updateMe(void);
-};
-class diaElemSlider : public diaElemSliderBase
-{
-  protected:
-    
-	  int32_t min,max,incr;
-    
-public:
-	diaElemSlider(int32_t *value,const char *toggleTitle, int32_t min,int32_t max,int32_t incr = 1, const char *tip=NULL);
-  virtual   ~diaElemSlider() ;
-  void      setMe(void *dialog, void *opaque,uint32_t line);
-  void      getMe(void);
-  void      enable(uint32_t onoff) ;
-  uint8_t   setDigits(uint32_t digits) ;
-  int getRequiredLayout(void);
-  void updateMe(void);
-};
-/*********************************************/
-typedef diaElem *CREATE_TOGGLE(uint32_t *toggleValue,const char *toggleTitle, const char *tip);
-class diaElemToggleBase : public diaElem
-{
-  protected:
-    dialElemLink        links[MENU_MAX_lINK];
-    uint32_t            nbLink;
-    
-public:
-			diaElemToggleBase() :diaElem(ELEM_TOGGLE)
-						{};
-  virtual   ~diaElemToggleBase() {};
-  virtual uint8_t   link(uint32_t onoff,diaElem *w)=0;
-};
-typedef diaElem *CREATE_TOGGLE_T(uint32_t *toggleValue,const char *toggleTitle, const char *tip);
-class diaElemToggle : public diaElemToggleBase
-{
-  protected:
-public:
-            diaElemToggle(uint32_t *toggleValue,const char *toggleTitle, const char *tip=NULL);
-  virtual   ~diaElemToggle() ;
-  void      setMe(void *dialog, void *opaque,uint32_t line);
-  void      getMe(void);
-  void      enable(uint32_t onoff) ;
-  void      finalize(void);
-  void      updateMe();
-  uint8_t   link(uint32_t onoff,diaElem *w);
-  int getRequiredLayout(void);
-};
-/*********************************************/
-typedef diaElem *CREATE_TOGGLE_UINT(uint32_t *toggleValue,const char *toggleTitle, uint32_t *uintval, 
-								const char *name,uint32_t min,uint32_t max,const char *tip=NULL);
-class diaElemToggleUint : public diaElem
-{
-  protected:
-        uint32_t *emb;
-        const char *embName;
-        void *widgetUint;
-        uint32_t _min,_max;
-public:
-            diaElemToggleUint(uint32_t *toggleValue,const char *toggleTitle, uint32_t *uintval,
-            					const char *name,uint32_t min,uint32_t max,const char *tip=NULL);
-  virtual   ~diaElemToggleUint() ;
-  void      setMe(void *dialog, void *opaque,uint32_t line);
-  void      getMe(void);
-  void      enable(uint32_t onoff) ;
-  void      finalize(void);
-  void      updateMe();
-  int getRequiredLayout(void);
-};
-typedef diaElem *CREATE_TOGGLE_INT(uint32_t *toggleValue,const char *toggleTitle, int32_t *intval, 
-									const char *name,int32_t min,int32_t max,const char *tip=NULL);
-class diaElemToggleInt : public diaElem
-{
-  protected:
-	  		 int32_t *emb;
-	         const char *embName;
-	         void *widgetUint;
-	         int32_t _min,_max;
-public:
-            diaElemToggleInt(uint32_t *toggleValue,const char *toggleTitle, int32_t *uintval,
-            				const char *name,int32_t min,int32_t max,const char *tip=NULL);
-  virtual   ~diaElemToggleInt() ;
-  void      setMe(void *dialog, void *opaque,uint32_t line);
-  void      getMe(void);
-  void      finalize(void);
-  int getRequiredLayout(void);
-  void      updateMe();
-  void      enable(uint32_t onoff) ;
-};
-/*********************************************/
-typedef diaElem  *(CREATE_INTEGER_T)(int32_t *intValue,const char *toggleTitle,int32_t min, int32_t max,const char *tip);
-typedef diaElem  *(CREATE_UINTEGER_T)(uint32_t *intValue,const char *toggleTitle,uint32_t min, uint32_t max,const char *tip);
-class diaElemInteger : public diaElem
-{
-
-public:
-  int32_t min,max;
-  diaElemInteger(int32_t *intValue,const char *toggleTitle, int32_t min, int32_t max,const char *tip=NULL);
-  virtual ~diaElemInteger() ;
-  void setMe(void *dialog, void *opaque,uint32_t line);
-  void getMe(void);
-  void      enable(uint32_t onoff) ;
-  int getRequiredLayout(void);
-  void updateMe(void);
-};
-/* Same but unsigned */
-class diaElemUInteger : public diaElem
-{
-
-public:
-  uint32_t min,max;
-  diaElemUInteger(uint32_t *intValue,const char *toggleTitle, uint32_t min, uint32_t max,const char *tip=NULL);
-  virtual ~diaElemUInteger() ;
-  void setMe(void *dialog, void *opaque,uint32_t line);
-  void getMe(void);
-  void      enable(uint32_t onoff) ;
-  int getRequiredLayout(void);
-  void updateMe(void);
-};
-/*************************************************/
-typedef diaElem  *(CREATE_BAR_T)(uint32_t percent,const char *toggleTitle);
-
-class diaElemBar : public diaElem
-{
-  protected :
-        uint32_t per;
-public:
-  
-  diaElemBar(uint32_t percent,const char *toggleTitle);
-  virtual ~diaElemBar() ;
-  void setMe(void *dialog, void *opaque,uint32_t line);
-  void getMe(void);
-  int getRequiredLayout(void);
-  void updateMe(void);
-};
-
-/*********************************************/
-typedef diaElem  *(CREATE_FLOAT_T)(ELEM_TYPE_FLOAT *intValue,const char *toggleTitle, ELEM_TYPE_FLOAT min,
-        ELEM_TYPE_FLOAT max,const char *tip, int decimals);
-class diaElemFloat : public diaElem
-{
-protected:
-	int decimals;
-
-public:
-  ELEM_TYPE_FLOAT min,max;
-  diaElemFloat(ELEM_TYPE_FLOAT *intValue,const char *toggleTitle, ELEM_TYPE_FLOAT min, 
-               ELEM_TYPE_FLOAT max,const char *tip=NULL, int decimals = 2);
-  virtual ~diaElemFloat() ;
-  void setMe(void *dialog, void *opaque,uint32_t line);
-  void getMe(void);
-  void      enable(uint32_t onoff) ;
-  int getRequiredLayout(void);
-  void updateMe(void);
-};
-/*************************************************/
-typedef struct diaMenuEntry
-{
-  public:
-    uint32_t    val;
-    const char *text;
-    const char *desc;
-  public:
-}diaMenuEntry;
-
-class diaMenuEntryDynamic : public diaMenuEntry
-{
-  public:
-  public:
-    diaMenuEntryDynamic(uint32_t v,const char *t,const char *d) 
-      {
-          val=v;
-          text=ADM_strdup(t);
-          desc=ADM_strdup(d);
-      }
-    ~diaMenuEntryDynamic() 
-      { 
-          ADM_dealloc(text);
-          ADM_dealloc(desc);
-      }
-    
-};
-//*******************************
-// static (i.e. hardcoded) menu
-//*******************************
-
-
-
-//*******************************
-// Same but for dynamic menus
-//*******************************
-typedef diaElem  *(CREATE_MENU_T)(uint32_t *intValue,const char *itle, uint32_t nb, 
-        const diaMenuEntry *menu,const char *tip);
-typedef diaElem  *(CREATE_MENUDYNAMIC_T)(uint32_t *intValue,const char *itle, uint32_t nb, 
-         diaMenuEntryDynamic **menu,const char *tip);
-
-class diaElemMenuDynamicBase : public diaElem
-{
-protected:	
-diaMenuEntryDynamic **menu;
-uint32_t            nbMenu;
-dialElemLink        links[MENU_MAX_lINK];
-uint32_t            nbLink;
-
-public:
-	diaElemMenuDynamicBase() : diaElem(ELEM_MENU) {};
-  
-  virtual   ~diaElemMenuDynamicBase() {};
-  virtual uint8_t   link(diaMenuEntryDynamic *entry,uint32_t onoff,diaElem *w)=0;
-};
-
-class diaElemMenuDynamic : public diaElemMenuDynamicBase
-{
-public:
-  diaElemMenuDynamic(uint32_t *intValue,const char *itle, uint32_t nb, 
-               diaMenuEntryDynamic **menu,const char *tip=NULL);
-  
-  virtual   ~diaElemMenuDynamic() ;
-  void      setMe(void *dialog, void *opaque,uint32_t line);
-  void      getMe(void);
-  virtual uint8_t   link(diaMenuEntryDynamic *entry,uint32_t onoff,diaElem *w);
-  virtual void      updateMe(void);
-  virtual void      enable(uint32_t onoff) ;
-  virtual void      finalize(void);
-  int getRequiredLayout(void);
-};
-
-class diaElemMenuBase : public diaElem
-{
-protected:
-	const diaMenuEntry  *menu;
-	uint32_t            nbMenu;
-	dialElemLink        links[MENU_MAX_lINK];
-	uint32_t            nbLink;
-public:	
-	diaElemMenuBase(void) : diaElem(ELEM_MENU) {};
-	virtual ~diaElemMenuBase(void) {};
-	virtual uint8_t   link(diaMenuEntry *entry,uint32_t onoff,diaElem *w)=0;
-};
-class diaElemMenu : public diaElemMenuBase
-{
-
-diaElemMenuDynamic  *dyna;
-diaMenuEntryDynamic  **menus;
-public:
-  diaElemMenu(uint32_t *intValue,const char *itle, uint32_t nb, 
-               const diaMenuEntry *menu,const char *tip=NULL);
-  
-  virtual ~diaElemMenu() ;
-  void setMe(void *dialog, void *opaque,uint32_t line);
-  void getMe(void);
-  virtual uint8_t   link(diaMenuEntry *entry,uint32_t onoff,diaElem *w);
-  virtual void      updateMe(void);
-  void      enable(uint32_t onoff) ;
-  void      finalize(void);;
-  int getRequiredLayout(void);
-};
-
-/*************************************************/
-#ifndef ADM_MINIMAL_UI_INTERFACE
-#include &quot;../../ADM_encoder/ADM_vidEncode.hxx&quot;
-typedef diaElem  *(CREATE_BITRATE_T)(COMPRES_PARAMS *p,const char *toggleTitle,const char *tip);
-class diaElemBitrateBase : public diaElem
-{
-  protected:
-    COMPRES_PARAMS    copy;
-    uint32_t maxQ, minQ;
-public:
-  
-	diaElemBitrateBase(void) : diaElem(ELEM_BITRATE) {};
-  virtual ~diaElemBitrateBase() {} ;
-  virtual void setMaxQz(uint32_t qz)=0;
-};
-class diaElemBitrate : public diaElemBitrateBase
-{
-  protected:
-public:
-  
-  diaElemBitrate(COMPRES_PARAMS *p,const char *toggleTitle,const char *tip=NULL);
-  virtual ~diaElemBitrate() ;
-  void setMe(void *dialog, void *opaque,uint32_t line);
-  void getMe(void);
-  void setMaxQz(uint32_t qz);
-  void setMinQz(uint32_t qz);
-  int getSize(void);
-  void setSize(int size);
-  
-  void updateMe(void);
-  int getRequiredLayout(void);
-};
-#endif
-/*************************************************/
-typedef diaElem *CREATE_FILE_T(uint32_t writeMode,char **filename,const char *toggleTitle,  const char *defaultSuffix ,const char *tip);
-class diaElemFileBase : public diaElem
-{
-
-protected:
-    const char * defaultSuffix;
-public:
-  
-	diaElemFileBase(void) : diaElem(ELEM_FILE_READ){};
-  virtual ~diaElemFileBase() {};
-  virtual void   changeFile(void)=0;
-  uint32_t _write;
-
-};
-class diaElemFile : public diaElemFileBase
-{
-
-protected:
-    
-public:
-  
-  diaElemFile(uint32_t writeMode,char **filename,const char *toggleTitle,
-              const char *defaultSuffix = 0,const char *tip=NULL);
-  virtual ~diaElemFile() ;
-  void setMe(void *dialog, void *opaque,uint32_t line);
-  void getMe(void);
-  
-  void   changeFile(void);
-  void   enable(uint32_t onoff);
-  int getRequiredLayout(void);
-  void updateMe(void);
-};
-/*************************************************/
-typedef diaElem *CREATE_DIR_T(char **filename,const char *toggleTitle,const char *tip);
-class diaElemDirSelectBase : public diaElem
-{
-
-public:
-  
-	diaElemDirSelectBase(void) :diaElem(ELEM_DIR_SELECT) {};
-  virtual ~diaElemDirSelectBase() {} ;
-  virtual void changeFile(void)=0;
-};
-class diaElemDirSelect : public diaElemDirSelectBase
-{
-
-public:
-  
-  diaElemDirSelect(char **filename,const char *toggleTitle,const char *tip=NULL);
-  virtual ~diaElemDirSelect() ;
-  void setMe(void *dialog, void *opaque,uint32_t line);
-  void getMe(void);
-  
-  void changeFile(void);
-  void   enable(uint32_t onoff);
-  int getRequiredLayout(void);
-  void updateMe(void);
-};
-/*************************************************/
-/* The text MUST be copied internally ! */
-typedef diaElem *(CREATE_READONLYTEXT_T )(const char *readOnly,const char *toggleTitle, const char *tip);
-class diaElemReadOnlyText : public diaElem
-{
-
-public:
-  
-  diaElemReadOnlyText(const char *readyOnly,const char *toggleTitle,const char *tip=NULL);
-  virtual ~diaElemReadOnlyText() ;
-  void setMe(void *dialog, void *opaque,uint32_t line);
-  void getMe(void);
-  int getRequiredLayout(void);
-  void updateMe(void);
-};
-/*************************************************/
-typedef diaElem *(CREATE_TEXT_T )(char **readOnly,const char *toggleTitle, const char *tip);
-/* The text MUST be copied internally ! */
-class diaElemText : public diaElem
-{
-
-public:
-  
-  diaElemText(char **text,const char *toggleTitle,const char *tip=NULL);
-  virtual ~diaElemText() ;
-  void setMe(void *dialog, void *opaque,uint32_t line);
-  void getMe(void);
-  void enable(uint32_t onoff);
-  int getRequiredLayout(void);
-  void updateMe(void);
-};
-
-/*********************************************/
-typedef diaElem *(CREATE_NOTCH_T )(uint32_t yes,const char *toggleTitle, const char *tip);
-class diaElemNotch : public diaElem
-{
-  uint32_t yesno;
-public:
-  
-  diaElemNotch(uint32_t yes,const char *toggleTitle, const char *tip=NULL);
-  virtual ~diaElemNotch() ;
-  void setMe(void *dialog, void *opaque,uint32_t line);
-  void getMe(void) ;
-  int getRequiredLayout(void);
-  void updateMe(void);
-};
-/*********************************************/
-typedef diaElem *(CREATE_TAB_T )(const char *toggleTitle, uint32_t nb, diaElem **content);
-class diaElemTabs 
-{
-  public:
-    
-  uint32_t nbElems;
-  diaElem  **dias;
-  const char *title;
-  
-  diaElemTabs(const char *toggleTitle, uint32_t nb, diaElem **content)
-  {
-      nbElems=nb;
-      dias=content; 
-      title=toggleTitle;
-  }
-  virtual ~diaElemTabs() 
-  {
-  }
-};
-/**********************************************/
-#define DIA_MAX_FRAME 10
-class diaElemFrameBase :public diaElem
-{
-protected:
-  uint32_t frameSize;
-  uint32_t nbElems;
-  diaElem  *elems[DIA_MAX_FRAME];
-public:
-  
-	diaElemFrameBase(void) : diaElem(ELEM_FRAME) {};
-  virtual ~diaElemFrameBase() {};
-  virtual void swallow(diaElem *widget)=0;
-};
-typedef diaElem *(CREATE_FRAME_T )(const char *toggleTitle, const char *tip);
-class diaElemFrame : public diaElemFrameBase
-{
-  
-public:
-  
-  diaElemFrame(const char *toggleTitle, const char *tip=NULL);
-  virtual ~diaElemFrame() ;
-  void setMe(void *dialog, void *opaque,uint32_t line);
-  void getMe(void) ;
-  void swallow(diaElem *widget);
-  void enable(uint32_t onoff);
-  void finalize(void);
-  int getRequiredLayout(void);
-  void updateMe(void);
-};
-/**********************************************/
-typedef diaElem *(CREATE_HEX_T )(const char *toggleTitle, uint32_t dataSize,uint8_t *data);
-class diaElemHex : public diaElem
-{
-  uint32_t dataSize;
-  uint8_t  *data;
-  
-public:
-  
-  diaElemHex(const char *toggleTitle, uint32_t dataSize,uint8_t *data);
-  virtual ~diaElemHex() ;
-  void setMe(void *dialog, void *opaque,uint32_t line);
-  void getMe(void) ;
-  void finalize(void);
-  int getRequiredLayout(void);
-  void updateMe(void);
-};
-/**********************************************/
-typedef diaElem *(CREATE_THREADCOUNT_T)(uint32_t *value, const char *title, const char *tip = NULL);
-class diaElemThreadCount : public diaElem
-{
-
-public:
-  
-  diaElemThreadCount(uint32_t *value, const char *title, const char *tip = NULL);
-  virtual ~diaElemThreadCount() ;
-  void setMe(void *dialog, void *opaque, uint32_t line);
-  void getMe(void);
-  int getRequiredLayout(void);
-  void updateMe(void);
-};
-/**********************************************/
-typedef diaElem *(CREATE_ASPECTRATIO_T)(uint32_t *value, const char *title, const char *tip = NULL);
-class diaElemAspectRatio : public diaElem
-{
-public:
-	uint32_t *den;
-	void *denControl, *label;
-
-	diaElemAspectRatio(uint32_t *num, uint32_t *den, const char *title, const char *tip = NULL);
-	virtual ~diaElemAspectRatio();
-	void setMe(void *dialog, void *opaque, uint32_t line);
-	void getMe(void);
-	void enable(uint32_t onoff);
-	int getRequiredLayout(void);
-	void updateMe(void);
-};
-/*********************************************/
+/***************************************************************************
+                          DIA_factory.h
+  Handles univeral dialog
+  
+  DO NOT USE TEMPLATE HERE!
+  
+  (C) Mean 2006 <A HREF="https://lists.berlios.de/mailman/listinfo/avidemux-svn-commit">fixounet at free.fr</A>
+
+ ***************************************************************************/
+
+/***************************************************************************
+ *                                                                         *
+ *   This program is free software; you can redistribute it and/or modify  *
+ *   it under the terms of the GNU General Public License as published by  *
+ *   the Free Software Foundation; either version 2 of the License, or     *
+ *   (at your option) any later version.                                   *
+ *                                                                         *
+ ***************************************************************************/
+#ifndef DIA_FACTORY_H
+#define DIA_FACTORY_H
+
+#include &quot;ADM_assert.h&quot;
+
+#define ADM_COREUI_MAJOR 1
+#define ADM_COREUI_MINOR 0
+#define ADM_COREUI_PATCH 1
+
+typedef enum 
+{
+  ELEM_INVALID=0,
+  ELEM_TOGGLE,
+  ELEM_INTEGER,
+  ELEM_FLOAT,
+  ELEM_MENU,
+  ELEM_FILE_READ,
+  ELEM_BITRATE,
+  ELEM_BAR,
+  ELEM_ROTEXT,
+  ELEM_NOTCH,
+  ELEM_DIR_SELECT,
+  ELEM_TEXT,
+  ELEM_FRAME,
+  ELEM_HEXDUMP,
+  ELEM_TOGGLE_UINT,
+  ELEM_TOGGLE_INT,
+  ELEM_BUTTON,
+  ELEM_SLIDER,
+  ELEM_THREAD_COUNT,
+  ELEM_MATRIX,
+  ELEM_ASPECT_RATIO,
+  ELEM_CONFIG_MENU,
+  ELEM_COUNT,
+  ELEM_MAX=ELEM_COUNT-1
+}elemEnum;
+typedef void ADM_FAC_CALLBACK(void *cookie);
+
+#define ELEM_TYPE_FLOAT float
+
+/*********************************************/
+class diaElem
+{
+  protected:
+    int     readOnly;
+    diaElem    *internalPointer;
+public:
+  void *param;
+  void *myWidget;
+  const char *paramTitle;
+  const char *tip;
+  elemEnum mySelf;
+  int       size; // Size of the widget in line
+
+  diaElem(elemEnum num) {paramTitle=NULL;param=NULL;mySelf=num;myWidget=NULL;size=1;readOnly=0;internalPointer=NULL;};
+  virtual int getSize(void) {return size;};
+  virtual void setSize(int z) {size=z;};
+  virtual ~diaElem() {};
+  virtual void setMe(void *dialog, void *opaque,uint32_t line)=0;
+  virtual void getMe(void)=0;
+  virtual void setRo(void) {readOnly=1;}
+  virtual void setRw(void) {readOnly=0;}
+          
+  virtual void enable(uint32_t onoff) {}
+  virtual void finalize(void) {} // in case some widget needs some stuff just before using them
+  virtual int getRequiredLayout(void)=0;
+  virtual void updateMe(void) = 0;
+};
+/*********************************************/
+#define MENU_MAX_lINK 10
+typedef struct dialElemLink
+{
+  uint32_t  value;
+  uint32_t  onoff;
+  diaElem  *widget;
+}dialElemLink;
+/*********************************************/
+
+typedef void      DELETE_DIA_ELEM_T(diaElem *widget);
+typedef void      FINALIZE_DIA_ELEM_T(void);
+typedef void      COREUI_GET_VERSION(uint32_t *maj,uint32_t *min,uint32_t *patch);
+/*********************************************/
+typedef diaElem  *(CREATE_BUTTON_T)(const char *toggleTitle, ADM_FAC_CALLBACK *cb,void *cookie,const char *tip);
+class diaElemButton : public diaElem
+{
+  protected:
+  public:
+    void            *_cookie;
+    ADM_FAC_CALLBACK *_callBack;
+            diaElemButton(const char *toggleTitle, ADM_FAC_CALLBACK *cb,void *cookie,const char *tip=NULL);
+  virtual   ~diaElemButton() ;
+  void      setMe(void *dialog, void *opaque,uint32_t line);
+  void      getMe(void);
+  void      enable(uint32_t onoff) ;
+  int getRequiredLayout(void);
+  void updateMe(void);
+};
+
+/*********************************************/
+typedef diaElem  *(CREATE_MATRIX_T)(uint8_t *trix,const char *toggleTitle, uint32_t trixSize,const char *tip);
+
+class diaElemMatrix : public diaElem
+{
+  protected:
+  public:
+    uint8_t *_matrix;
+    uint32_t _matrixSize;
+    		diaElemMatrix(uint8_t *trix,const char *toggleTitle, uint32_t trixSize,const char *tip=NULL);
+  virtual   ~diaElemMatrix() ;
+  void      setMe(void *dialog, void *opaque,uint32_t line);
+  void      getMe(void);
+  void      enable(uint32_t onoff) ;
+  int getRequiredLayout(void);
+  void updateMe(void);
+};
+/************************************/
+class diaElemSliderBase : public diaElem
+{
+  protected:
+    
+      uint32_t digits;
+public:
+	                diaElemSliderBase() : diaElem(ELEM_SLIDER) {}
+  virtual           ~diaElemSliderBase() {};
+  virtual uint8_t   setDigits(uint32_t digits) { this-&gt;digits = digits; }
+};
+
+typedef diaElem *CREATE_USLIDER_T(uint32_t *value,const char *toggleTitle, uint32_t min,uint32_t max,uint32_t incr , const char *tip);
+typedef diaElem *CREATE_SLIDER_T(int32_t *value,const char *toggleTitle, int32_t min,int32_t max,int32_t incr , const char *tip);
+class diaElemUSlider : public diaElemSliderBase
+{
+  protected:
+	  uint32_t min,max,incr;
+public:
+	diaElemUSlider(uint32_t *value,const char *toggleTitle, uint32_t min,uint32_t max,uint32_t incr = 1, const char *tip=NULL);
+  virtual   ~diaElemUSlider() ;
+  void      setMe(void *dialog, void *opaque,uint32_t line);
+  void      getMe(void);
+  void      enable(uint32_t onoff) ;
+  uint8_t   setDigits(uint32_t digits) ;
+  int getRequiredLayout(void);
+  void updateMe(void);
+};
+class diaElemSlider : public diaElemSliderBase
+{
+  protected:
+    
+	  int32_t min,max,incr;
+    
+public:
+	diaElemSlider(int32_t *value,const char *toggleTitle, int32_t min,int32_t max,int32_t incr = 1, const char *tip=NULL);
+  virtual   ~diaElemSlider() ;
+  void      setMe(void *dialog, void *opaque,uint32_t line);
+  void      getMe(void);
+  void      enable(uint32_t onoff) ;
+  uint8_t   setDigits(uint32_t digits) ;
+  int getRequiredLayout(void);
+  void updateMe(void);
+};
+/*********************************************/
+typedef diaElem *CREATE_TOGGLE(uint32_t *toggleValue,const char *toggleTitle, const char *tip);
+class diaElemToggleBase : public diaElem
+{
+  protected:
+    dialElemLink        links[MENU_MAX_lINK];
+    uint32_t            nbLink;
+    
+public:
+			diaElemToggleBase() :diaElem(ELEM_TOGGLE)
+						{};
+  virtual   ~diaElemToggleBase() {};
+  virtual uint8_t   link(uint32_t onoff,diaElem *w)=0;
+};
+typedef diaElem *CREATE_TOGGLE_T(uint32_t *toggleValue,const char *toggleTitle, const char *tip);
+class diaElemToggle : public diaElemToggleBase
+{
+  protected:
+public:
+            diaElemToggle(uint32_t *toggleValue,const char *toggleTitle, const char *tip=NULL);
+  virtual   ~diaElemToggle() ;
+  void      setMe(void *dialog, void *opaque,uint32_t line);
+  void      getMe(void);
+  void      enable(uint32_t onoff) ;
+  void      finalize(void);
+  void      updateMe();
+  uint8_t   link(uint32_t onoff,diaElem *w);
+  int getRequiredLayout(void);
+};
+/*********************************************/
+typedef diaElem *CREATE_TOGGLE_UINT(uint32_t *toggleValue,const char *toggleTitle, uint32_t *uintval, 
+								const char *name,uint32_t min,uint32_t max,const char *tip=NULL);
+class diaElemToggleUint : public diaElem
+{
+  protected:
+        uint32_t *emb;
+        const char *embName;
+        void *widgetUint;
+        uint32_t _min,_max;
+public:
+            diaElemToggleUint(uint32_t *toggleValue,const char *toggleTitle, uint32_t *uintval,
+            					const char *name,uint32_t min,uint32_t max,const char *tip=NULL);
+  virtual   ~diaElemToggleUint() ;
+  void      setMe(void *dialog, void *opaque,uint32_t line);
+  void      getMe(void);
+  void      enable(uint32_t onoff) ;
+  void      finalize(void);
+  void      updateMe();
+  int getRequiredLayout(void);
+};
+typedef diaElem *CREATE_TOGGLE_INT(uint32_t *toggleValue,const char *toggleTitle, int32_t *intval, 
+									const char *name,int32_t min,int32_t max,const char *tip=NULL);
+class diaElemToggleInt : public diaElem
+{
+  protected:
+	  		 int32_t *emb;
+	         const char *embName;
+	         void *widgetUint;
+	         int32_t _min,_max;
+public:
+            diaElemToggleInt(uint32_t *toggleValue,const char *toggleTitle, int32_t *uintval,
+            				const char *name,int32_t min,int32_t max,const char *tip=NULL);
+  virtual   ~diaElemToggleInt() ;
+  void      setMe(void *dialog, void *opaque,uint32_t line);
+  void      getMe(void);
+  void      finalize(void);
+  int getRequiredLayout(void);
+  void      updateMe();
+  void      enable(uint32_t onoff) ;
+};
+/*********************************************/
+typedef diaElem  *(CREATE_INTEGER_T)(int32_t *intValue,const char *toggleTitle,int32_t min, int32_t max,const char *tip);
+typedef diaElem  *(CREATE_UINTEGER_T)(uint32_t *intValue,const char *toggleTitle,uint32_t min, uint32_t max,const char *tip);
+class diaElemInteger : public diaElem
+{
+
+public:
+  int32_t min,max;
+  diaElemInteger(int32_t *intValue,const char *toggleTitle, int32_t min, int32_t max,const char *tip=NULL);
+  virtual ~diaElemInteger() ;
+  void setMe(void *dialog, void *opaque,uint32_t line);
+  void getMe(void);
+  void      enable(uint32_t onoff) ;
+  int getRequiredLayout(void);
+  void updateMe(void);
+};
+/* Same but unsigned */
+class diaElemUInteger : public diaElem
+{
+
+public:
+  uint32_t min,max;
+  diaElemUInteger(uint32_t *intValue,const char *toggleTitle, uint32_t min, uint32_t max,const char *tip=NULL);
+  virtual ~diaElemUInteger() ;
+  void setMe(void *dialog, void *opaque,uint32_t line);
+  void getMe(void);
+  void      enable(uint32_t onoff) ;
+  int getRequiredLayout(void);
+  void updateMe(void);
+};
+/*************************************************/
+typedef diaElem  *(CREATE_BAR_T)(uint32_t percent,const char *toggleTitle);
+
+class diaElemBar : public diaElem
+{
+  protected :
+        uint32_t per;
+public:
+  
+  diaElemBar(uint32_t percent,const char *toggleTitle);
+  virtual ~diaElemBar() ;
+  void setMe(void *dialog, void *opaque,uint32_t line);
+  void getMe(void);
+  int getRequiredLayout(void);
+  void updateMe(void);
+};
+
+/*********************************************/
+typedef diaElem  *(CREATE_FLOAT_T)(ELEM_TYPE_FLOAT *intValue,const char *toggleTitle, ELEM_TYPE_FLOAT min,
+        ELEM_TYPE_FLOAT max,const char *tip, int decimals);
+class diaElemFloat : public diaElem
+{
+protected:
+	int decimals;
+
+public:
+  ELEM_TYPE_FLOAT min,max;
+  diaElemFloat(ELEM_TYPE_FLOAT *intValue,const char *toggleTitle, ELEM_TYPE_FLOAT min, 
+               ELEM_TYPE_FLOAT max,const char *tip=NULL, int decimals = 2);
+  virtual ~diaElemFloat() ;
+  void setMe(void *dialog, void *opaque,uint32_t line);
+  void getMe(void);
+  void      enable(uint32_t onoff) ;
+  int getRequiredLayout(void);
+  void updateMe(void);
+};
+/*************************************************/
+typedef struct diaMenuEntry
+{
+  public:
+    uint32_t    val;
+    const char *text;
+    const char *desc;
+  public:
+}diaMenuEntry;
+
+class diaMenuEntryDynamic : public diaMenuEntry
+{
+  public:
+  public:
+    diaMenuEntryDynamic(uint32_t v,const char *t,const char *d) 
+      {
+          val=v;
+          text=ADM_strdup(t);
+          desc=ADM_strdup(d);
+      }
+    ~diaMenuEntryDynamic() 
+      { 
+          ADM_dealloc(text);
+          ADM_dealloc(desc);
+      }
+    
+};
+//*******************************
+// static (i.e. hardcoded) menu
+//*******************************
+
+
+
+//*******************************
+// Same but for dynamic menus
+//*******************************
+typedef diaElem  *(CREATE_MENU_T)(uint32_t *intValue,const char *itle, uint32_t nb, 
+        const diaMenuEntry *menu,const char *tip);
+typedef diaElem  *(CREATE_MENUDYNAMIC_T)(uint32_t *intValue,const char *itle, uint32_t nb, 
+         diaMenuEntryDynamic **menu,const char *tip);
+
+class diaElemMenuDynamicBase : public diaElem
+{
+protected:	
+diaMenuEntryDynamic **menu;
+uint32_t            nbMenu;
+dialElemLink        links[MENU_MAX_lINK];
+uint32_t            nbLink;
+
+public:
+	diaElemMenuDynamicBase() : diaElem(ELEM_MENU) {};
+  
+  virtual   ~diaElemMenuDynamicBase() {};
+  virtual uint8_t   link(diaMenuEntryDynamic *entry,uint32_t onoff,diaElem *w)=0;
+};
+
+class diaElemMenuDynamic : public diaElemMenuDynamicBase
+{
+public:
+  diaElemMenuDynamic(uint32_t *intValue,const char *itle, uint32_t nb, 
+               diaMenuEntryDynamic **menu,const char *tip=NULL);
+  
+  virtual   ~diaElemMenuDynamic() ;
+  void      setMe(void *dialog, void *opaque,uint32_t line);
+  void      getMe(void);
+  virtual uint8_t   link(diaMenuEntryDynamic *entry,uint32_t onoff,diaElem *w);
+  virtual void      updateMe(void);
+  virtual void      enable(uint32_t onoff) ;
+  virtual void      finalize(void);
+  int getRequiredLayout(void);
+};
+
+class diaElemMenuBase : public diaElem
+{
+protected:
+	const diaMenuEntry  *menu;
+	uint32_t            nbMenu;
+	dialElemLink        links[MENU_MAX_lINK];
+	uint32_t            nbLink;
+public:	
+	diaElemMenuBase(void) : diaElem(ELEM_MENU) {};
+	virtual ~diaElemMenuBase(void) {};
+	virtual uint8_t   link(diaMenuEntry *entry,uint32_t onoff,diaElem *w)=0;
+};
+class diaElemMenu : public diaElemMenuBase
+{
+
+diaElemMenuDynamic  *dyna;
+diaMenuEntryDynamic  **menus;
+public:
+  diaElemMenu(uint32_t *intValue,const char *itle, uint32_t nb, 
+               const diaMenuEntry *menu,const char *tip=NULL);
+  
+  virtual ~diaElemMenu() ;
+  void setMe(void *dialog, void *opaque,uint32_t line);
+  void getMe(void);
+  virtual uint8_t   link(diaMenuEntry *entry,uint32_t onoff,diaElem *w);
+  virtual void      updateMe(void);
+  void      enable(uint32_t onoff) ;
+  void      finalize(void);;
+  int getRequiredLayout(void);
+};
+
+/*************************************************/
+#ifndef ADM_MINIMAL_UI_INTERFACE
+#include &quot;../../ADM_encoder/ADM_vidEncode.hxx&quot;
+typedef diaElem  *(CREATE_BITRATE_T)(COMPRES_PARAMS *p,const char *toggleTitle,const char *tip);
+class diaElemBitrateBase : public diaElem
+{
+  protected:
+    COMPRES_PARAMS    copy;
+    uint32_t maxQ, minQ;
+public:
+  
+	diaElemBitrateBase(void) : diaElem(ELEM_BITRATE) {};
+  virtual ~diaElemBitrateBase() {} ;
+  virtual void setMaxQz(uint32_t qz)=0;
+};
+class diaElemBitrate : public diaElemBitrateBase
+{
+  protected:
+public:
+  
+  diaElemBitrate(COMPRES_PARAMS *p,const char *toggleTitle,const char *tip=NULL);
+  virtual ~diaElemBitrate() ;
+  void setMe(void *dialog, void *opaque,uint32_t line);
+  void getMe(void);
+  void setMaxQz(uint32_t qz);
+  void setMinQz(uint32_t qz);
+  int getSize(void);
+  void setSize(int size);
+  
+  void updateMe(void);
+  int getRequiredLayout(void);
+};
+#endif
+/*************************************************/
+typedef diaElem *CREATE_FILE_T(uint32_t writeMode,char **filename,const char *toggleTitle,  const char *defaultSuffix ,const char *tip);
+class diaElemFileBase : public diaElem
+{
+
+protected:
+    const char * defaultSuffix;
+public:
+  
+	diaElemFileBase(void) : diaElem(ELEM_FILE_READ){};
+  virtual ~diaElemFileBase() {};
+  virtual void   changeFile(void)=0;
+  uint32_t _write;
+
+};
+class diaElemFile : public diaElemFileBase
+{
+
+protected:
+    
+public:
+  
+  diaElemFile(uint32_t writeMode,char **filename,const char *toggleTitle,
+              const char *defaultSuffix = 0,const char *tip=NULL);
+  virtual ~diaElemFile() ;
+  void setMe(void *dialog, void *opaque,uint32_t line);
+  void getMe(void);
+  
+  void   changeFile(void);
+  void   enable(uint32_t onoff);
+  int getRequiredLayout(void);
+  void updateMe(void);
+};
+/*************************************************/
+typedef diaElem *CREATE_DIR_T(char **filename,const char *toggleTitle,const char *tip);
+class diaElemDirSelectBase : public diaElem
+{
+
+public:
+  
+	diaElemDirSelectBase(void) :diaElem(ELEM_DIR_SELECT) {};
+  virtual ~diaElemDirSelectBase() {} ;
+  virtual void changeFile(void)=0;
+};
+class diaElemDirSelect : public diaElemDirSelectBase
+{
+
+public:
+  
+  diaElemDirSelect(char **filename,const char *toggleTitle,const char *tip=NULL);
+  virtual ~diaElemDirSelect() ;
+  void setMe(void *dialog, void *opaque,uint32_t line);
+  void getMe(void);
+  
+  void changeFile(void);
+  void   enable(uint32_t onoff);
+  int getRequiredLayout(void);
+  void updateMe(void);
+};
+/*************************************************/
+/* The text MUST be copied internally ! */
+typedef diaElem *(CREATE_READONLYTEXT_T )(const char *readOnly,const char *toggleTitle, const char *tip);
+class diaElemReadOnlyText : public diaElem
+{
+
+public:
+  
+  diaElemReadOnlyText(const char *readyOnly,const char *toggleTitle,const char *tip=NULL);
+  virtual ~diaElemReadOnlyText() ;
+  void setMe(void *dialog, void *opaque,uint32_t line);
+  void getMe(void);
+  int getRequiredLayout(void);
+  void updateMe(void);
+};
+/*************************************************/
+typedef diaElem *(CREATE_TEXT_T )(char **readOnly,const char *toggleTitle, const char *tip);
+/* The text MUST be copied internally ! */
+class diaElemText : public diaElem
+{
+
+public:
+  
+  diaElemText(char **text,const char *toggleTitle,const char *tip=NULL);
+  virtual ~diaElemText() ;
+  void setMe(void *dialog, void *opaque,uint32_t line);
+  void getMe(void);
+  void enable(uint32_t onoff);
+  int getRequiredLayout(void);
+  void updateMe(void);
+};
+
+/*********************************************/
+typedef diaElem *(CREATE_NOTCH_T )(uint32_t yes,const char *toggleTitle, const char *tip);
+class diaElemNotch : public diaElem
+{
+  uint32_t yesno;
+public:
+  
+  diaElemNotch(uint32_t yes,const char *toggleTitle, const char *tip=NULL);
+  virtual ~diaElemNotch() ;
+  void setMe(void *dialog, void *opaque,uint32_t line);
+  void getMe(void) ;
+  int getRequiredLayout(void);
+  void updateMe(void);
+};
+/*********************************************/
+typedef diaElem *(CREATE_TAB_T )(const char *toggleTitle, uint32_t nb, diaElem **content);
+class diaElemTabs 
+{
+  public:
+    
+  uint32_t nbElems;
+  diaElem  **dias;
+  const char *title;
+  
+  diaElemTabs(const char *toggleTitle, uint32_t nb, diaElem **content)
+  {
+      nbElems=nb;
+      dias=content; 
+      title=toggleTitle;
+  }
+  virtual ~diaElemTabs() 
+  {
+  }
+};
+/**********************************************/
+#define DIA_MAX_FRAME 10
+class diaElemFrameBase :public diaElem
+{
+protected:
+  uint32_t frameSize;
+  uint32_t nbElems;
+  diaElem  *elems[DIA_MAX_FRAME];
+public:
+  
+	diaElemFrameBase(void) : diaElem(ELEM_FRAME) {};
+  virtual ~diaElemFrameBase() {};
+  virtual void swallow(diaElem *widget)=0;
+};
+typedef diaElem *(CREATE_FRAME_T )(const char *toggleTitle, const char *tip);
+class diaElemFrame : public diaElemFrameBase
+{
+  
+public:
+  
+  diaElemFrame(const char *toggleTitle, const char *tip=NULL);
+  virtual ~diaElemFrame() ;
+  void setMe(void *dialog, void *opaque,uint32_t line);
+  void getMe(void) ;
+  void swallow(diaElem *widget);
+  void enable(uint32_t onoff);
+  void finalize(void);
+  int getRequiredLayout(void);
+  void updateMe(void);
+};
+/**********************************************/
+typedef diaElem *(CREATE_HEX_T )(const char *toggleTitle, uint32_t dataSize,uint8_t *data);
+class diaElemHex : public diaElem
+{
+  uint32_t dataSize;
+  uint8_t  *data;
+  
+public:
+  
+  diaElemHex(const char *toggleTitle, uint32_t dataSize,uint8_t *data);
+  virtual ~diaElemHex() ;
+  void setMe(void *dialog, void *opaque,uint32_t line);
+  void getMe(void) ;
+  void finalize(void);
+  int getRequiredLayout(void);
+  void updateMe(void);
+};
+/**********************************************/
+typedef diaElem *(CREATE_THREADCOUNT_T)(uint32_t *value, const char *title, const char *tip = NULL);
+class diaElemThreadCount : public diaElem
+{
+
+public:
+  
+  diaElemThreadCount(uint32_t *value, const char *title, const char *tip = NULL);
+  virtual ~diaElemThreadCount() ;
+  void setMe(void *dialog, void *opaque, uint32_t line);
+  void getMe(void);
+  int getRequiredLayout(void);
+  void updateMe(void);
+};
+/**********************************************/
+typedef diaElem *(CREATE_ASPECTRATIO_T)(uint32_t *value, const char *title, const char *tip = NULL);
+class diaElemAspectRatio : public diaElem
+{
+public:
+	uint32_t *den;
+	void *denControl, *label;
+
+	diaElemAspectRatio(uint32_t *num, uint32_t *den, const char *title, const char *tip = NULL);
+	virtual ~diaElemAspectRatio();
+	void setMe(void *dialog, void *opaque, uint32_t line);
+	void getMe(void);
+	void enable(uint32_t onoff);
+	int getRequiredLayout(void);
+	void updateMe(void);
+};
+/*********************************************/
 typedef enum
 {
 	CONFIG_MENU_CUSTOM,
 	CONFIG_MENU_DEFAULT,
 	CONFIG_MENU_USER,
 	CONFIG_MENU_SYSTEM
-} ConfigMenuType;
-
-typedef char *(CONFIG_MENU_SERIALIZE_T)(void);
-typedef bool (CONFIG_MENU_CHANGED_T)(const char* configName, ConfigMenuType configType);
-typedef diaElem *(CREATE_CONFIG_MENU_T)(const char* userConfigDir, const char* systemConfigDir,	CONFIG_MENU_CHANGED_T *changedFunc, 
-										CONFIG_MENU_SERIALIZE_T *serializeFunc, diaElem **controls, unsigned int controlCount);
-
-class diaElemConfigMenu : public diaElem
-{
-protected:
-	const char *userConfigDir, *systemConfigDir;
-	diaElem **controls;
-	unsigned int controlCount;
-
+} ConfigMenuType;
+
+typedef char *(CONFIG_MENU_SERIALIZE_T)(void);
+typedef bool (CONFIG_MENU_CHANGED_T)(const char* configName, ConfigMenuType configType);
+typedef diaElem *(CREATE_CONFIG_MENU_T)(const char* userConfigDir, const char* systemConfigDir,	CONFIG_MENU_CHANGED_T *changedFunc, 
+										CONFIG_MENU_SERIALIZE_T *serializeFunc, diaElem **controls, unsigned int controlCount);
+
+class diaElemConfigMenu : public diaElem
+{
+protected:
+	const char *userConfigDir, *systemConfigDir;
+	diaElem **controls;
+	unsigned int controlCount;
+
 	CONFIG_MENU_CHANGED_T *changedFunc;
-	CONFIG_MENU_SERIALIZE_T *serializeFunc;
-
-public:
+	CONFIG_MENU_SERIALIZE_T *serializeFunc;
+
+public:
 	diaElemConfigMenu(const char* userConfigDir, const char* systemConfigDir, CONFIG_MENU_CHANGED_T *changedFunc,
-			CONFIG_MENU_SERIALIZE_T *serializeFunc, diaElem **controls, unsigned int controlCount);
-	~diaElemConfigMenu();
-	void setMe(void *dialog, void *opaque, uint32_t line);
-	void getMe(void);
-	void enable(uint32_t onoff);
-	int getRequiredLayout(void);
-	void updateMe(void);
-};
-/*********************************************/
-uint8_t diaFactoryRun(const char *title,uint32_t nb,diaElem **elems);
-uint8_t diaFactoryRunTabs(const char *title,uint32_t nb,diaElemTabs **tabs);
-uint8_t diaFactoryRunTabs(const char *title, unsigned int headerControlCount, diaElem **headerControls, unsigned int tabControlCount, diaElemTabs **tabControls);
-/*********************************************/
-#endif
+			CONFIG_MENU_SERIALIZE_T *serializeFunc, diaElem **controls, unsigned int controlCount);
+	~diaElemConfigMenu();
+	void setMe(void *dialog, void *opaque, uint32_t line);
+	void getMe(void);
+	void enable(uint32_t onoff);
+	int getRequiredLayout(void);
+	void updateMe(void);
+	void finalize(void);
+};
+/*********************************************/
+uint8_t diaFactoryRun(const char *title,uint32_t nb,diaElem **elems);
+uint8_t diaFactoryRunTabs(const char *title,uint32_t nb,diaElemTabs **tabs);
+uint8_t diaFactoryRunTabs(const char *title, unsigned int headerControlCount, diaElem **headerControls, unsigned int tabControlCount, diaElemTabs **tabControls);
+/*********************************************/
+#endif

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_coreUI/src/DIA_factory.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_coreUI/src/DIA_factory.cpp	2009-07-27 19:19:24 UTC (rev 5162)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_coreUI/src/DIA_factory.cpp	2009-07-27 20:46:59 UTC (rev 5163)
@@ -580,4 +580,10 @@
 	internalPointer-&gt;enable(onoff);
 }
 
+void diaElemConfigMenu::finalize(void)
+{
+	ADM_assert(internalPointer);
+	internalPointer-&gt;finalize();
+}
+
 DIA_MKSTUBS(diaElemConfigMenu)

Modified: branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_avcodec/mpeg1Encoder.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_avcodec/mpeg1Encoder.cpp	2009-07-27 19:19:24 UTC (rev 5162)
+++ branches/avidemux_2.5_branch_gruntster/plugins/ADM_videoEncoder/ADM_vidEnc_avcodec/mpeg1Encoder.cpp	2009-07-27 20:46:59 UTC (rev 5163)
@@ -34,6 +34,9 @@
 	_encodeOptions.encodeModeParameter = DEFAULT_ENCODE_MODE_PARAMETER;
 
 	_bitrateParam.capabilities = ADM_ENC_CAP_CQ | ADM_ENC_CAP_2PASS | ADM_ENC_CAP_2PASS_BR;
+	_bitrateParam.qz = DEFAULT_ENCODE_MODE_PARAMETER;
+	_bitrateParam.avg_bitrate = 1000;
+	_bitrateParam.finalsize = 700;
 }
 
 void Mpeg1Encoder::initContext(vidEncVideoProperties *properties)
@@ -138,9 +141,6 @@
 	_userMatrix = options-&gt;getMatrix();
 	_gopSize = options-&gt;getGopSize();
 
-	_bitrateParam.qz = 1000;
-	_bitrateParam.finalsize = 700;
-
 	updateEncodeProperties(encodeOptions, NULL);
 }
 
@@ -209,7 +209,7 @@
 		}
 	}
 
-	return !failure;
+	return configType == CONFIG_MENU_CUSTOM | !failure;
 }
 
 char *serializeConfig(void)


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="002377.html">[Avidemux-svn-commit] r5162 - in	branches/avidemux_2.5_branch_gruntster: cmake	plugins/ADM_audioDecoders
</A></li>
	<LI>Next message: <A HREF="002379.html">[Avidemux-svn-commit] r5164 -	branches/avidemux_2.6_branch_mean/cmake
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2378">[ date ]</a>
              <a href="thread.html#2378">[ thread ]</a>
              <a href="subject.html#2378">[ subject ]</a>
              <a href="author.html#2378">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/avidemux-svn-commit">More information about the Avidemux-svn-commit
mailing list</a><br>
</body></html>
