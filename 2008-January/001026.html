<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Avidemux-svn-commit] r3758 -	branches/avidemux_2.4_branch/addons/mkvscan
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/avidemux-svn-commit/2008-January/index.html" >
   <LINK REL="made" HREF="mailto:avidemux-svn-commit%40lists.berlios.de?Subject=Re%3A%20%5BAvidemux-svn-commit%5D%20r3758%20-%0A%09branches/avidemux_2.4_branch/addons/mkvscan&In-Reply-To=%3C200801201457.m0KEvjZf003338%40sheep.berlios.de%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="001025.html">
   <LINK REL="Next"  HREF="001027.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Avidemux-svn-commit] r3758 -	branches/avidemux_2.4_branch/addons/mkvscan</H1>
    <B>mean at BerliOS</B> 
    <A HREF="mailto:avidemux-svn-commit%40lists.berlios.de?Subject=Re%3A%20%5BAvidemux-svn-commit%5D%20r3758%20-%0A%09branches/avidemux_2.4_branch/addons/mkvscan&In-Reply-To=%3C200801201457.m0KEvjZf003338%40sheep.berlios.de%3E"
       TITLE="[Avidemux-svn-commit] r3758 -	branches/avidemux_2.4_branch/addons/mkvscan">mean at mail.berlios.de
       </A><BR>
    <I>Sun Jan 20 15:57:45 CET 2008</I>
    <P><UL>
        <LI>Previous message: <A HREF="001025.html">[Avidemux-svn-commit] r3757 - in	branches/avidemux_2.4_branch/avidemux: ADM_filter ADM_videoFilter
</A></li>
        <LI>Next message: <A HREF="001027.html">[Avidemux-svn-commit] r3759 -	branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_libsdl
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1026">[ date ]</a>
              <a href="thread.html#1026">[ thread ]</a>
              <a href="subject.html#1026">[ subject ]</a>
              <a href="author.html#1026">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Author: mean
Date: 2008-01-20 15:57:44 +0100 (Sun, 20 Jan 2008)
New Revision: 3758

Added:
   branches/avidemux_2.4_branch/addons/mkvscan/ADM_assert.h
   branches/avidemux_2.4_branch/addons/mkvscan/CMakeLists.txt
   branches/avidemux_2.4_branch/addons/mkvscan/Makefile.make
   branches/avidemux_2.4_branch/addons/mkvscan/config.h
   branches/avidemux_2.4_branch/addons/mkvscan/default.h
Removed:
   branches/avidemux_2.4_branch/addons/mkvscan/ebml.cpp
   branches/avidemux_2.4_branch/addons/mkvscan/mkv_tags.cpp
Modified:
   branches/avidemux_2.4_branch/addons/mkvscan/Makefile
Log:
[MkvScan] Cleanup, use source from adm, build with cmake

Added: branches/avidemux_2.4_branch/addons/mkvscan/ADM_assert.h
===================================================================

Added: branches/avidemux_2.4_branch/addons/mkvscan/CMakeLists.txt
===================================================================
--- branches/avidemux_2.4_branch/addons/mkvscan/CMakeLists.txt	2008-01-20 14:37:48 UTC (rev 3757)
+++ branches/avidemux_2.4_branch/addons/mkvscan/CMakeLists.txt	2008-01-20 14:57:44 UTC (rev 3758)
@@ -0,0 +1,17 @@
+PROJECT(mkv)
+INCLUDE_DIRECTORIES( .) 
+INCLUDE_DIRECTORIES( ../../avidemux/ADM_inputs/ADM_matroska)
+#LINK_DIRECTORIES(${ITK_LIBRARY_DIRS})
+ADD_DEFINITIONS(&quot;-g&quot;)
+
+
+SET(sources
+../../avidemux/ADM_inputs/ADM_matroska/ebml.cpp 
+mkv_c.cpp 
+../../avidemux/ADM_inputs/ADM_matroska/mkv_tags.cpp
+)
+
+
+ADD_EXECUTABLE(mkv ${sources})
+
+

Modified: branches/avidemux_2.4_branch/addons/mkvscan/Makefile
===================================================================
--- branches/avidemux_2.4_branch/addons/mkvscan/Makefile	2008-01-20 14:37:48 UTC (rev 3757)
+++ branches/avidemux_2.4_branch/addons/mkvscan/Makefile	2008-01-20 14:57:44 UTC (rev 3758)
@@ -1,9 +1,165 @@
-CFLAGS=-g3 -I../../avidemux/ADM_inputs/ADM_matroska
-LDFLAGS=-g
-OBJS=ebml.o mkv_c.o mkv_tags.o
-%.o:%.cpp 
-	$(CXX) -o $@  $&lt; -c $(CFLAGS)
-mkv: $(OBJS)
-	$(CXX) -o $@ $(OBJS) $(LDFLAGS)
+# CMAKE generated file: DO NOT EDIT!
+# Generated by &quot;Unix Makefiles&quot; Generator, CMake Version 2.4
+
+# Default target executed when no arguments are given to make.
+default_target: all
+
+#=============================================================================
+# Special targets provided by cmake.
+
+# Disable implicit rules so canoncical targets will work.
+.SUFFIXES:
+
+.SUFFIXES: .hpux_make_needs_suffix_list
+
+# Suppress display of executed commands.
+$(VERBOSE).SILENT:
+
+# A target that is always out of date.
+cmake_force:
+
+#=============================================================================
+# Set environment variables for the build.
+
+# The shell in which to execute make rules.
+SHELL = /bin/sh
+
+# The CMake executable.
+CMAKE_COMMAND = /usr/bin/cmake
+
+# The command to remove a file.
+RM = /usr/bin/cmake -E remove -f
+
+# The program to use to edit the cache.
+CMAKE_EDIT_COMMAND = /usr/bin/ccmake
+
+# The top-level source directory on which CMake was run.
+CMAKE_SOURCE_DIR = /home/fx/workspace/avidemux-2.4.0/addons/mkvscan
+
+# The top-level build directory on which CMake was run.
+CMAKE_BINARY_DIR = /home/fx/workspace/avidemux-2.4.0/addons/mkvscan
+
+# Include the progress variables for this target.
+include CMakeFiles/progress.make
+
+#=============================================================================
+# Targets provided globally by CMake.
+
+# Special rule for the target edit_cache
+edit_cache:
+	@$(CMAKE_COMMAND) -E cmake_echo_color --switch=$(COLOR) --cyan &quot;Running CMake cache editor...&quot;
+	/usr/bin/ccmake -H$(CMAKE_SOURCE_DIR) -B$(CMAKE_BINARY_DIR)
+
+# Special rule for the target edit_cache
+edit_cache/fast: edit_cache
+
+# Special rule for the target rebuild_cache
+rebuild_cache:
+	@$(CMAKE_COMMAND) -E cmake_echo_color --switch=$(COLOR) --cyan &quot;Running CMake to regenerate build system...&quot;
+	/usr/bin/cmake -H$(CMAKE_SOURCE_DIR) -B$(CMAKE_BINARY_DIR)
+
+# Special rule for the target rebuild_cache
+rebuild_cache/fast: rebuild_cache
+
+# The main all target
+all: cmake_check_build_system
+	$(CMAKE_COMMAND) -E cmake_progress_start /home/fx/workspace/avidemux-2.4.0/addons/mkvscan/CMakeFiles $(CMAKE_ALL_PROGRESS)
+	$(MAKE) -f CMakeFiles/Makefile2 all
+	$(CMAKE_COMMAND) -E cmake_progress_start /home/fx/workspace/avidemux-2.4.0/addons/mkvscan/CMakeFiles 0
+
+# The main clean target
 clean:
-	rm $(OBJS) mkv
+	$(MAKE) -f CMakeFiles/Makefile2 clean
+
+# The main clean target
+clean/fast: clean
+
+# Prepare targets for installation.
+preinstall: all
+	$(MAKE) -f CMakeFiles/Makefile2 preinstall
+
+# Prepare targets for installation.
+preinstall/fast:
+	$(MAKE) -f CMakeFiles/Makefile2 preinstall
+
+# clear depends
+depend:
+	$(CMAKE_COMMAND) -H$(CMAKE_SOURCE_DIR) -B$(CMAKE_BINARY_DIR) --check-build-system CMakeFiles/Makefile.cmake 1
+
+#=============================================================================
+# Target rules for targets named mkv
+
+# Build rule for target.
+mkv: cmake_check_build_system
+	$(MAKE) -f CMakeFiles/Makefile2 mkv
+
+# fast build rule for target.
+mkv/fast:
+	$(MAKE) -f CMakeFiles/mkv.dir/build.make CMakeFiles/mkv.dir/build
+
+# target to build an object file
+home/fx/workspace/avidemux-2.4.0/avidemux/ADM_inputs/ADM_matroska/ebml.o:
+	$(MAKE) -f CMakeFiles/mkv.dir/build.make CMakeFiles/mkv.dir/home/fx/workspace/avidemux-2.4.0/avidemux/ADM_inputs/ADM_matroska/ebml.o
+
+# target to preprocess a source file
+home/fx/workspace/avidemux-2.4.0/avidemux/ADM_inputs/ADM_matroska/ebml.i:
+	$(MAKE) -f CMakeFiles/mkv.dir/build.make CMakeFiles/mkv.dir/home/fx/workspace/avidemux-2.4.0/avidemux/ADM_inputs/ADM_matroska/ebml.i
+
+# target to generate assembly for a file
+home/fx/workspace/avidemux-2.4.0/avidemux/ADM_inputs/ADM_matroska/ebml.s:
+	$(MAKE) -f CMakeFiles/mkv.dir/build.make CMakeFiles/mkv.dir/home/fx/workspace/avidemux-2.4.0/avidemux/ADM_inputs/ADM_matroska/ebml.s
+
+# target to build an object file
+home/fx/workspace/avidemux-2.4.0/avidemux/ADM_inputs/ADM_matroska/mkv_tags.o:
+	$(MAKE) -f CMakeFiles/mkv.dir/build.make CMakeFiles/mkv.dir/home/fx/workspace/avidemux-2.4.0/avidemux/ADM_inputs/ADM_matroska/mkv_tags.o
+
+# target to preprocess a source file
+home/fx/workspace/avidemux-2.4.0/avidemux/ADM_inputs/ADM_matroska/mkv_tags.i:
+	$(MAKE) -f CMakeFiles/mkv.dir/build.make CMakeFiles/mkv.dir/home/fx/workspace/avidemux-2.4.0/avidemux/ADM_inputs/ADM_matroska/mkv_tags.i
+
+# target to generate assembly for a file
+home/fx/workspace/avidemux-2.4.0/avidemux/ADM_inputs/ADM_matroska/mkv_tags.s:
+	$(MAKE) -f CMakeFiles/mkv.dir/build.make CMakeFiles/mkv.dir/home/fx/workspace/avidemux-2.4.0/avidemux/ADM_inputs/ADM_matroska/mkv_tags.s
+
+# target to build an object file
+mkv_c.o:
+	$(MAKE) -f CMakeFiles/mkv.dir/build.make CMakeFiles/mkv.dir/mkv_c.o
+
+# target to preprocess a source file
+mkv_c.i:
+	$(MAKE) -f CMakeFiles/mkv.dir/build.make CMakeFiles/mkv.dir/mkv_c.i
+
+# target to generate assembly for a file
+mkv_c.s:
+	$(MAKE) -f CMakeFiles/mkv.dir/build.make CMakeFiles/mkv.dir/mkv_c.s
+
+# Help Target
+help::
+	@echo &quot;The following are some of the valid targets for this Makefile:&quot;
+	@echo &quot;... all (the default if no target is provided)&quot;
+	@echo &quot;... clean&quot;
+	@echo &quot;... depend&quot;
+	@echo &quot;... edit_cache&quot;
+	@echo &quot;... mkv&quot;
+	@echo &quot;... rebuild_cache&quot;
+	@echo &quot;... home/fx/workspace/avidemux-2.4.0/avidemux/ADM_inputs/ADM_matroska/ebml.o&quot;
+	@echo &quot;... home/fx/workspace/avidemux-2.4.0/avidemux/ADM_inputs/ADM_matroska/ebml.i&quot;
+	@echo &quot;... home/fx/workspace/avidemux-2.4.0/avidemux/ADM_inputs/ADM_matroska/ebml.s&quot;
+	@echo &quot;... home/fx/workspace/avidemux-2.4.0/avidemux/ADM_inputs/ADM_matroska/mkv_tags.o&quot;
+	@echo &quot;... home/fx/workspace/avidemux-2.4.0/avidemux/ADM_inputs/ADM_matroska/mkv_tags.i&quot;
+	@echo &quot;... home/fx/workspace/avidemux-2.4.0/avidemux/ADM_inputs/ADM_matroska/mkv_tags.s&quot;
+	@echo &quot;... mkv_c.o&quot;
+	@echo &quot;... mkv_c.i&quot;
+	@echo &quot;... mkv_c.s&quot;
+
+
+
+#=============================================================================
+# Special targets to cleanup operation of make.
+
+# Special rule to run CMake to check the build system integrity.
+# No rule that depends on this can have commands that come from listfiles
+# because they might be regenerated.
+cmake_check_build_system:
+	$(CMAKE_COMMAND) -H$(CMAKE_SOURCE_DIR) -B$(CMAKE_BINARY_DIR) --check-build-system CMakeFiles/Makefile.cmake 0
+

Added: branches/avidemux_2.4_branch/addons/mkvscan/Makefile.make
===================================================================
--- branches/avidemux_2.4_branch/addons/mkvscan/Makefile.make	2008-01-20 14:37:48 UTC (rev 3757)
+++ branches/avidemux_2.4_branch/addons/mkvscan/Makefile.make	2008-01-20 14:57:44 UTC (rev 3758)
@@ -0,0 +1,9 @@
+CFLAGS=-g3 -I../../avidemux/ADM_inputs/ADM_matroska
+LDFLAGS=-g
+OBJS=ebml.o mkv_c.o mkv_tags.o
+%.o:%.cpp 
+	$(CXX) -o $@  $&lt; -c $(CFLAGS)
+mkv: $(OBJS)
+	$(CXX) -o $@ $(OBJS) $(LDFLAGS)
+clean:
+	rm $(OBJS) mkv

Added: branches/avidemux_2.4_branch/addons/mkvscan/config.h
===================================================================
--- branches/avidemux_2.4_branch/addons/mkvscan/config.h	2008-01-20 14:37:48 UTC (rev 3757)
+++ branches/avidemux_2.4_branch/addons/mkvscan/config.h	2008-01-20 14:57:44 UTC (rev 3758)
@@ -0,0 +1 @@
+#define ADM_assert(x) if(!(x)) { printf(&quot;Assert &quot;#x&quot; failed at line %d file %s\n&quot;,__LINE__,__FILE__);exit(-1);}

Added: branches/avidemux_2.4_branch/addons/mkvscan/default.h
===================================================================
--- branches/avidemux_2.4_branch/addons/mkvscan/default.h	2008-01-20 14:37:48 UTC (rev 3757)
+++ branches/avidemux_2.4_branch/addons/mkvscan/default.h	2008-01-20 14:57:44 UTC (rev 3758)
@@ -0,0 +1 @@
+#include &lt;stdint.h&gt;

Deleted: branches/avidemux_2.4_branch/addons/mkvscan/ebml.cpp
===================================================================
--- branches/avidemux_2.4_branch/addons/mkvscan/ebml.cpp	2008-01-20 14:37:48 UTC (rev 3757)
+++ branches/avidemux_2.4_branch/addons/mkvscan/ebml.cpp	2008-01-20 14:57:44 UTC (rev 3758)
@@ -1,384 +0,0 @@
-/***************************************************************************
- *   Copyright (C) 2007 by mean,    *
- *   <A HREF="https://lists.berlios.de/mailman/listinfo/avidemux-svn-commit">fixounet at free.fr</A>   *
- *                                                                         *
- *        EBML Handling code                                               *
- *   This program is free software; you can redistribute it and/or modify  *
- *   it under the terms of the GNU General Public License as published by  *
- *   the Free Software Foundation; either version 2 of the License, or     *
- *   (at your option) any later version.                                   *
- *                                                                         *
- *   This program is distributed in the hope that it will be useful,       *
- *   but WITHOUT ANY WARRANTY; without even the implied warranty of        *
- *   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the         *
- *   GNU General Public License for more details.                          *
- *                                                                         *
- *   You should have received a copy of the GNU General Public License     *
- *   along with this program; if not, write to the                         *
- *   Free Software Foundation, Inc.,                                       *
- *   59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.             *
- ***************************************************************************/
-#include &lt;stdio.h&gt;
-#include &lt;stdlib.h&gt;
-#include &lt;stdint.h&gt;
-#include &quot;ADM_ebml.h&quot;
-#define aprintf(...) {}
-
-#include &quot;assert.h&quot;
-#define ADM_assert assert
-#if 0
-#define vprintf printf
-#else
-#define vprintf(...) {}
-#endif
-
-extern &quot;C&quot;
-{
-  double av_int2dbl(int64_t v);
-  float av_int2flt(int32_t v);
-}
-
-/*
-  It is slow , optimize later
-*/  
-
-uint8_t    ADM_ebml::readElemId(uint64_t *code,uint64_t *len)
-{
-  *code=readEBMCode_Full(); // Keep the length-bits, easier to match with documentation
-  *len=readEBMCode();
-  return 1;
-}
-
-/**
-      \fn       readEBMCode
-      \brief    Returns unsigned integer
-*/
-
-uint64_t    ADM_ebml::readEBMCode(void)
-{
- uint64_t start=readu8();
-  uint64_t val;      
-  uint32_t mask=0x80,outmask=0x7F,more=0;
-  
-  aprintf(&quot;Start :%x at %llx\n&quot;,start,tell()-1);
-  
-  while(!(mask&amp;start))
-  {
-    mask&gt;&gt;=1;
-    ADM_assert(mask);
-    more++; 
-  }
-  outmask=mask-1;
-  start=start&outmask;
-  for(int i=0;i&lt;more;i++)
-  {
-    start=(start&lt;&lt;8)+readu8(); 
-  }
-  aprintf(&quot;End at %llx\n&quot;,tell());
-  return start;
-}
-/**
-      \fn       readEBMCode
-      \brief    Returns unsigned integer
-*/
-
-int64_t    ADM_ebml::readEBMCode_Signed(void)
-{
-  uint8_t start=readu8();
-  int64_t val;      
-  uint32_t mask=0x80,outmask=0x7F,more=0;
-  
-  while(!(mask&amp;start))
-  {
-    mask&gt;&gt;=1;
-    ADM_assert(mask);
-    more++; 
-  }
-  outmask=mask-1;
-  val=start&outmask;
-  for(int i=0;i&lt;more;i++)
-  {
-    val=(val&lt;&lt;8)+readu8(); 
-  }
-  // Signed !
-
-  switch(more)
-  {
-    case 0: val-=63;break; 
-    case 1: val-=8191;break;
-    case 2: val-=1048575L;break;  
-    default: 
-        ADM_assert(0);
-        return 0;
-    
-  }
-
-  return val;
-}
-/**
-      \fn       readEBMCode_Full
-      \brief    Returns complete code, including size-bits (used only for EBML_ID)
-*/
-uint64_t    ADM_ebml::readEBMCode_Full(void)
-{
-  uint64_t start=readu8();
-  uint32_t mask=0x80,more=0;
-  aprintf(&quot;&gt;&gt;StartFull :%x at %llx\n&quot;,start,tell()-1);
-  while(!(mask&amp;start))
-  {
-    mask&gt;&gt;=1;
-    ADM_assert(mask);
-    more++; 
-  }
-  for(int i=0;i&lt;more;i++)
-  {
-    start=(start&lt;&lt;8)+readu8(); 
-  }
-  return start;
-}
-
-uint64_t    ADM_ebml::readUnsignedInt(uint32_t nb) 
-{
-  uint64_t val=0;
-  for(int i=0;i&lt;nb;i++)
-  {
-    val=(val&lt;&lt;8)+readu8(); 
-  }
-  return val;
-}
-int64_t    ADM_ebml::readSignedInt(uint32_t nb) 
-{
-  int64_t val=0;
-  uint8_t r=0;
-  r=readu8();
-  if(r&amp;0x80) // sign
-      val=-1;
-  val=(val&lt;&lt;8)+r; 
-  for(int i=0;i&lt;nb-1;i++)
-  {
-    r=readu8();
-    val=(val&lt;&lt;8)+r; 
-  }
-  return val;
-  
-}
-uint8_t     ADM_ebml::readString(char *string, uint32_t maxLen)
-{
-  uint8_t v;
-  while(maxLen--)
-  {
-    v=*string++=readu8();
-    if(!v) return 1;
-  }
-  *string=0;
-  return 1;  
-}
-/******************
-  Low level read
-**********************/
-
-
-uint8_t ADM_ebml::readu8(void)
-{
-  uint8_t v;
-    readBin(&amp;v,1);
-    return v;
-}
-uint16_t ADM_ebml::readu16(void)
-{
-  uint8_t v[2];
-    readBin(v,2);
-    return (uint16_t)(v[0]&lt;&lt;8)+v[1];
-}
-/**
-*/
-float       ADM_ebml::readFloat(uint32_t n)
-{
-  if(n!=4 &amp;&amp; n!=8) ADM_assert(0);
-  
-  switch(n)
-  {
-    case 4:
-    {
-        uint32_t u4=readUnsignedInt(4);
-        return av_int2flt(u4);
-      }
-    case 8:
-    {
-        uint64_t u8=readUnsignedInt(8);
-        return  av_int2dbl(u8);
-    }
-    default:
-        ADM_assert(0);
-  }
-}
-
-ADM_ebml::ADM_ebml(void)
-{
-  
-}
-ADM_ebml::~ADM_ebml()
-{
-  
-}
-
-
-//*******************************************
-//***********FILE IO PART *******************
-//*******************************************
-ADM_ebml_file::ADM_ebml_file(ADM_ebml_file *father,uint32_t size) : ADM_ebml()
-{
-  _close=0;
-  _size=size;
-  fp=father-&gt;fp;
-  _fileSize=father-&gt;_fileSize;
-  _begin=ftello(fp);
-}
-ADM_ebml_file::ADM_ebml_file(void) : ADM_ebml()
-{
-  _close=0;
-}
-ADM_ebml_file::~ADM_ebml_file()
-{
-  ADM_assert(fp);
-  if(_close )
-  {
-    ADM_assert(!_begin);
-    fclose(fp);
-  }
-  else 
-    fseeko(fp,_begin+_size,SEEK_SET);
-  fp=NULL; 
-}
-uint8_t ADM_ebml_file::open(const char *name)
-{
-  _close=1;
-  fp=fopen(name,&quot;rb&quot;);
-  if(!fp) 
-  {
-    aprintf(&quot;[EBML FILE] Failed to open &lt;%s&gt;\n&quot;,name);
-    return 0;
-  }
-  fseeko(fp,0,SEEK_END);
-  _begin=0;
-  _fileSize=_size=ftello(fp);
-  fseeko(fp,0,SEEK_SET);
-  return 1;
-}
-uint8_t  ADM_ebml_file::readBin(uint8_t *whereto,uint32_t len)
-{
-  ADM_assert(fp);
-  if(!fread(whereto,len,1,fp)) return 0;
-  return 1;
-}
-
-uint8_t ADM_ebml_file::skip(uint32_t vv)
-{
-  ADM_assert(fp);
-  fseeko(fp,vv,SEEK_CUR);
-  return 1; 
-}
-uint64_t ADM_ebml_file::tell(void)
-{
-  ADM_assert(fp);
-  return ftello(fp);
-}
-uint8_t ADM_ebml_file::seek(uint64_t pos)
-{
-  ADM_assert(fp);
-  fseeko(fp,pos,SEEK_SET);
-  return 1;
-}
-uint8_t ADM_ebml_file::finished(void)
-{
-  if(tell()&gt;(_fileSize-4)) return 1;
-  if(tell()&gt;(_begin+_size-4)) return 1;
-  return 0; 
-}
-/** 
-  \fn find
-  \brief Search for the tag given and returns the corresponding atom
-*/
- uint8_t ADM_ebml_file::find(ADM_MKV_SEARCHTYPE search,MKV_ELEM_ID  prim,MKV_ELEM_ID second,uint32_t *len,uint32_t rewind)
-{
-  uint64_t id,pos;
-  ADM_MKV_TYPE type;
-  const char *ss;
-
-    vprintf(&quot;[MKV]Searching for tag %llx %llx\n&quot;,prim,second);
-    if(rewind) seek(_begin);
-    if(search==ADM_MKV_PRIMARY)
-    {
-          return simplefind(prim,len,rewind);
-      }
-    vprintf(&quot;[MKV]Searching primary : %llx\n&quot;,prim);
-    if(!simplefind(prim,len,rewind))
-    {
-      vprintf(&quot;[MKV] Primary find failed for %llx\n&quot;,prim);
-      return 0; 
-    }
-    // Now we have the father, go inside
-    ADM_ebml_file *son=new ADM_ebml_file(this,*len);
-    vprintf(&quot;[MKV]Searching secondary : %llx\n&quot;,second);
-    if(!son-&gt;simplefind(second,len))
-    {
-      vprintf(&quot;[MKV] secondary find failed for secondary %llx\n&quot;,second);
-      delete son;
-      return 0; 
-    }
-    pos=son-&gt;tell();
-    delete son;
-    seek(pos);
-    return 1;
-}
-
-/** 
-  \fn find
-  \brief Search for the tag given and returns the corresponding atom
-*/
-uint8_t ADM_ebml_file::simplefind(MKV_ELEM_ID  prim,uint32_t *len,uint32_t rewind)
-{
-  uint64_t id,alen;
-  ADM_MKV_TYPE type;
-  const char *ss;
-  
-
-    printf(&quot;[MKV] Simple Searching for tag %llx\n&quot;,prim);
-    if(rewind) seek(_begin);
-   
-      while(!finished())
-      {
-          readElemId(&amp;id,&amp;alen);
-          if(!ADM_searchMkvTag( (MKV_ELEM_ID)id,&amp;ss,&amp;type))
-          {
-              vprintf(&quot;[MKV] Tag 0x%x not found\n&quot;,id);
-              skip(alen);
-              continue;
-           }
-          if(!alen)
-          {
-            printf(&quot;[MKV] WARNING ZERO SIZED ATOM %s %llu/%llu\n&quot;,ss,tell(),_fileSize);
-            continue; 
-          }
-          vprintf(&quot;Found Tag : %x (%s)\n&quot;,id,ss);
-          if(id==prim)
-          {
-            *len=(uint32_t )alen;
-            return 1;
-          }else
-            skip(alen);
-      }
-    vprintf(&quot;[MKV] Failed to locate %llx\n&quot;,prim);
-    return 0;
-}
-/**
-    \fn remaining
-    \brief returns the # of bytes remaining in this atom
-*/
-uint64_t ADM_ebml_file::remaining(void)
-{
-  uint64_t pos=tell();
-  ADM_assert(pos&lt;=(_begin+_size));
-  return (_begin+_size)-pos; 
-}
-//EOF

Deleted: branches/avidemux_2.4_branch/addons/mkvscan/mkv_tags.cpp
===================================================================
--- branches/avidemux_2.4_branch/addons/mkvscan/mkv_tags.cpp	2008-01-20 14:37:48 UTC (rev 3757)
+++ branches/avidemux_2.4_branch/addons/mkvscan/mkv_tags.cpp	2008-01-20 14:57:44 UTC (rev 3758)
@@ -1,80 +0,0 @@
-/***************************************************************************
- *   Copyright (C) 2007 by mean,    *
- *   <A HREF="https://lists.berlios.de/mailman/listinfo/avidemux-svn-commit">fixounet at free.fr</A>   *
- *                                                                         *
- *        EBML Handling code                                               *
- *   This program is free software; you can redistribute it and/or modify  *
- *   it under the terms of the GNU General Public License as published by  *
- *   the Free Software Foundation; either version 2 of the License, or     *
- *   (at your option) any later version.                                   *
- *                                                                         *
- *   This program is distributed in the hope that it will be useful,       *
- *   but WITHOUT ANY WARRANTY; without even the implied warranty of        *
- *   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the         *
- *   GNU General Public License for more details.                          *
- *                                                                         *
- *   You should have received a copy of the GNU General Public License     *
- *   along with this program; if not, write to the                         *
- *   Free Software Foundation, Inc.,                                       *
- *   59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.             *
- ***************************************************************************/
-
-#include &lt;stdio.h&gt;
-#include &lt;stdlib.h&gt;
-#include &lt;stdint.h&gt;
-#include &quot;ADM_ebml.h&quot;
-#include &quot;mkv_tags.h&quot;
-
-
-typedef struct ADM_mkvTagEnum
-{
-    MKV_ELEM_ID   id;
-    ADM_MKV_TYPE  type;
-    const char    *name;
-}ADM_mkvTagEnum;
-#define ADM_BUILD_TAG
-static const ADM_mkvTagEnum mkvTags[]={
-#include &quot;mkv_tagenum.h&quot;
-};
-
-/**
-    \fn ADM_searchMkvTag
-    \brief Search the payload of this ELEM_ID
-*/
-uint8_t ADM_searchMkvTag(MKV_ELEM_ID tag,const char **asString,ADM_MKV_TYPE *type)
-{
-  int full=sizeof(mkvTags)/sizeof(ADM_mkvTagEnum);
-  
-  for(int i=0;i&lt;full;i++)
-  {
-    if(mkvTags[i].id==tag)
-    {
-      *asString=mkvTags[i].name;
-      *type  =mkvTags[i].type;
-      return 1;
-    }
-    
-  }
-  return 0;
-}
-/**
-    \fn ADM_mkvTypeAsString
-    \brief Returns the type as a string
-*/
-const char *ADM_mkvTypeAsString(ADM_MKV_TYPE type)
-{
-#define CONV(x) if(type==x) return #x;
-    CONV(ADM_MKV_TYPE_UNKNOWN)
-    CONV(ADM_MKV_TYPE_CONTAINER)
-    CONV(ADM_MKV_TYPE_STRING)
-    CONV(ADM_MKV_TYPE_UTF8)
-    CONV(ADM_MKV_TYPE_DATE)
-    CONV(ADM_MKV_TYPE_FLOAT)
-    CONV(ADM_MKV_TYPE_UINTEGER)
-    CONV(ADM_MKV_TYPE_INTEGER)
-    CONV(ADM_MKV_TYPE_BINARY)
-        return &quot;unknown type ???&quot;;
- 
-  
-}
-// EOF


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="001025.html">[Avidemux-svn-commit] r3757 - in	branches/avidemux_2.4_branch/avidemux: ADM_filter ADM_videoFilter
</A></li>
	<LI>Next message: <A HREF="001027.html">[Avidemux-svn-commit] r3759 -	branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_libsdl
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1026">[ date ]</a>
              <a href="thread.html#1026">[ thread ]</a>
              <a href="subject.html#1026">[ subject ]</a>
              <a href="author.html#1026">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/avidemux-svn-commit">More information about the Avidemux-svn-commit
mailing list</a><br>
</body></html>
