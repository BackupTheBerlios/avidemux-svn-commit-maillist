<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Avidemux-svn-commit] r3562 - in	branches/avidemux_2.4_branch/avidemux: . ADM_audiocodec	ADM_audiofilter ADM_codecs ADM_editor ADM_encoder	ADM_libraries/ADM_lavcodec ADM_libraries/ADM_lavformat	ADM_outputs ADM_script ADM_userInterfaces/ADM_GTK/ADM_gui2	ADM_userInterfaces/ADM_QT4/ADM_gui
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/avidemux-svn-commit/2007-August/index.html" >
   <LINK REL="made" HREF="mailto:avidemux-svn-commit%40lists.berlios.de?Subject=Re%3A%20%5BAvidemux-svn-commit%5D%20r3562%20-%20in%0A%09branches/avidemux_2.4_branch/avidemux%3A%20.%20ADM_audiocodec%0A%09ADM_audiofilter%20ADM_codecs%20ADM_editor%20ADM_encoder%0A%09ADM_libraries/ADM_lavcodec%20ADM_libraries/ADM_lavformat%0A%09ADM_outputs%20ADM_script%20ADM_userInterfaces/ADM_GTK/ADM_gui2%0A%09ADM_userInterfaces/ADM_QT4/ADM_gui&In-Reply-To=%3C200708260913.l7Q9DDux011582%40sheep.berlios.de%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000835.html">
   <LINK REL="Next"  HREF="000837.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Avidemux-svn-commit] r3562 - in	branches/avidemux_2.4_branch/avidemux: . ADM_audiocodec	ADM_audiofilter ADM_codecs ADM_editor ADM_encoder	ADM_libraries/ADM_lavcodec ADM_libraries/ADM_lavformat	ADM_outputs ADM_script ADM_userInterfaces/ADM_GTK/ADM_gui2	ADM_userInterfaces/ADM_QT4/ADM_gui</H1>
    <B>mean at BerliOS</B> 
    <A HREF="mailto:avidemux-svn-commit%40lists.berlios.de?Subject=Re%3A%20%5BAvidemux-svn-commit%5D%20r3562%20-%20in%0A%09branches/avidemux_2.4_branch/avidemux%3A%20.%20ADM_audiocodec%0A%09ADM_audiofilter%20ADM_codecs%20ADM_editor%20ADM_encoder%0A%09ADM_libraries/ADM_lavcodec%20ADM_libraries/ADM_lavformat%0A%09ADM_outputs%20ADM_script%20ADM_userInterfaces/ADM_GTK/ADM_gui2%0A%09ADM_userInterfaces/ADM_QT4/ADM_gui&In-Reply-To=%3C200708260913.l7Q9DDux011582%40sheep.berlios.de%3E"
       TITLE="[Avidemux-svn-commit] r3562 - in	branches/avidemux_2.4_branch/avidemux: . ADM_audiocodec	ADM_audiofilter ADM_codecs ADM_editor ADM_encoder	ADM_libraries/ADM_lavcodec ADM_libraries/ADM_lavformat	ADM_outputs ADM_script ADM_userInterfaces/ADM_GTK/ADM_gui2	ADM_userInterfaces/ADM_QT4/ADM_gui">mean at mail.berlios.de
       </A><BR>
    <I>Sun Aug 26 11:13:13 CEST 2007</I>
    <P><UL>
        <LI>Previous message: <A HREF="000835.html">[Avidemux-svn-commit] r3561 -	branches/avidemux_2.4_branch/avidemux/ADM_audio
</A></li>
        <LI>Next message: <A HREF="000837.html">[Avidemux-svn-commit] r3563 - in	branches/avidemux_2.4_branch/avidemux/ADM_outputs: . oplug_flv
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#836">[ date ]</a>
              <a href="thread.html#836">[ thread ]</a>
              <a href="subject.html#836">[ subject ]</a>
              <a href="author.html#836">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Author: mean
Date: 2007-08-26 11:13:11 +0200 (Sun, 26 Aug 2007)
New Revision: 3562

Added:
   branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavformat/flvenc.c
Modified:
   branches/avidemux_2.4_branch/avidemux/ADM_audiocodec/ADM_audiocodeclist.h
   branches/avidemux_2.4_branch/avidemux/ADM_audiofilter/audiodeng_buildfilters.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_audiofilter/audioeng_buildfilters.h
   branches/avidemux_2.4_branch/avidemux/ADM_audiofilter/audiofilter_buildchain.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_codecs/ADM_ffmpeg.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_codecs/ADM_ffmpeg.h
   branches/avidemux_2.4_branch/avidemux/ADM_editor/ADM_outputfmt.h
   branches/avidemux_2.4_branch/avidemux/ADM_encoder/ADM_encCodecDesc.h
   branches/avidemux_2.4_branch/avidemux/ADM_encoder/ADM_vidEncode.hxx
   branches/avidemux_2.4_branch/avidemux/ADM_encoder/adm_encConfig.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_encoder/adm_encffmpeg.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_encoder/adm_encffmpeg.h
   branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec/ffconf.c
   branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec/ffconf.h
   branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavformat/ADM_lavformat.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavformat/ADM_lavformat.h
   branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavformat/CMakeLists.txt
   branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavformat/Makefile.am
   branches/avidemux_2.4_branch/avidemux/ADM_outputs/CMakeLists.txt
   branches/avidemux_2.4_branch/avidemux/ADM_outputs/Makefile.am
   branches/avidemux_2.4_branch/avidemux/ADM_script/ADM_container.h
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_menumap.h
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/translation_table.h
   branches/avidemux_2.4_branch/avidemux/CMakeLists.txt
   branches/avidemux_2.4_branch/avidemux/gtk_gui.cpp
   branches/avidemux_2.4_branch/avidemux/gui_action.hxx
   branches/avidemux_2.4_branch/avidemux/gui_autodrive.cpp
   branches/avidemux_2.4_branch/avidemux/gui_savenew.cpp
Log:
[Output] FLV output (incomplete)

Modified: branches/avidemux_2.4_branch/avidemux/ADM_audiocodec/ADM_audiocodeclist.h
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_audiocodec/ADM_audiocodeclist.h	2007-08-25 22:48:09 UTC (rev 3561)
+++ branches/avidemux_2.4_branch/avidemux/ADM_audiocodec/ADM_audiocodeclist.h	2007-08-26 09:13:11 UTC (rev 3562)
@@ -5,27 +5,28 @@
         const char *name;
         const char *menuName;
         AUDIOENCODER codec;
+        uint32_t     wavTag;
 }CODECLIST;
 
  const CODECLIST myCodecList[]=
 {
-                {&quot;copy&quot;,&quot;Copy&quot;, AUDIOENC_COPY},
+                {&quot;copy&quot;,&quot;Copy&quot;, AUDIOENC_COPY,WAV_PCM},
 #ifdef HAVE_LIBMP3LAME
-                {&quot;lame&quot;,&quot;MP3 (LAME)&quot;, AUDIOENC_MP3},
+                {&quot;lame&quot;,&quot;MP3 (LAME)&quot;, AUDIOENC_MP3,WAV_MP3},
 #endif
 #ifdef USE_FAAC
-                {&quot;aac&quot;,&quot;AAC (FAAC)&quot;, AUDIOENC_FAAC},
+                {&quot;aac&quot;,&quot;AAC (FAAC)&quot;, AUDIOENC_FAAC,WAV_AAC},
 #endif
 #ifdef USE_VORBIS
-                {&quot;vorbis&quot;,&quot;Vorbis&quot;, AUDIOENC_VORBIS},
+                {&quot;vorbis&quot;,&quot;Vorbis&quot;, AUDIOENC_VORBIS,WAV_OGG},
 #endif
 #ifdef USE_AFTEN
-                {&quot;aften&quot;,&quot;AC3 (Aften)&quot;, AUDIOENC_AFTEN},
+                {&quot;aften&quot;,&quot;AC3 (Aften)&quot;, AUDIOENC_AFTEN,WAV_AC3},
 #endif
-                {&quot;twolame&quot;,&quot;MP2 (TwoLAME)&quot;, AUDIOENC_2LAME},
-                {&quot;mp2&quot;, &quot;MP2 (lavc)&quot;, AUDIOENC_MP2},
-                {&quot;ac3&quot;, &quot;AC3 (lavc)&quot;,AUDIOENC_AC3},
-                {&quot;none&quot;, &quot;WAV PCM&quot;,AUDIOENC_NONE},
-                {&quot;lpcm&quot;, &quot;WAV LPCM&quot;,AUDIOENC_LPCM}
+                {&quot;twolame&quot;,&quot;MP2 (TwoLAME)&quot;, AUDIOENC_2LAME,WAV_MP2},
+                {&quot;mp2&quot;, &quot;MP2 (lavc)&quot;, AUDIOENC_MP2,WAV_MP2},
+                {&quot;ac3&quot;, &quot;AC3 (lavc)&quot;,AUDIOENC_AC3,WAV_AC3},
+                {&quot;none&quot;, &quot;WAV PCM&quot;,AUDIOENC_NONE,WAV_PCM},
+                {&quot;lpcm&quot;, &quot;WAV LPCM&quot;,AUDIOENC_LPCM,WAV_LPCM}
 };
 #endif

Modified: branches/avidemux_2.4_branch/avidemux/ADM_audiofilter/audiodeng_buildfilters.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_audiofilter/audiodeng_buildfilters.cpp	2007-08-25 22:48:09 UTC (rev 3561)
+++ branches/avidemux_2.4_branch/avidemux/ADM_audiofilter/audiodeng_buildfilters.cpp	2007-08-26 09:13:11 UTC (rev 3562)
@@ -432,4 +432,34 @@
 	audioResampleMode=RESAMPLING_CUSTOM;
 	audioFreq=fq;
 }
+/**
+ * 	\fn getAudioOuputTag
+ *  \brief Return the encoding of the currently selected codec
+ *  Must be called only in process mode, else it is meaningless.
+ */
+uint32_t audioFilter_getOuputCodec(void)
+{
+	
+	for(uint32_t i=0;i&lt;sizeof(myCodecList)/sizeof(CODECLIST);i++)
+		{
+			if(activeAudioEncoder==myCodecList[i].codec)
+			{
+				return myCodecList[i].wavTag;
+			}
+		
+		}
+	ADM_assert(0);
+	return WAV_PCM;
+}
+/**
+ * 	\fn getAudioOuputFrequency
+ *  \brief Return the encoding of the currently selected codec
+ */
+uint32_t audioFilter_getOuputFrequency(uint32_t inputFrequency)
+{
+	if(activeAudioEncoder==AUDIOENC_COPY) return inputFrequency;
+	if(audioResampleMode == RESAMPLING_NONE) return inputFrequency;
+	return audioFreq;
+}
+//EOF
 

Modified: branches/avidemux_2.4_branch/avidemux/ADM_audiofilter/audioeng_buildfilters.h
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_audiofilter/audioeng_buildfilters.h	2007-08-25 22:48:09 UTC (rev 3561)
+++ branches/avidemux_2.4_branch/avidemux/ADM_audiofilter/audioeng_buildfilters.h	2007-08-26 09:13:11 UTC (rev 3562)
@@ -34,7 +34,8 @@
 
 void audioCodecConfigure( void );
 void audioCodecSelect( void );
-
+uint32_t audioFilter_getOuputCodec(void);
+uint32_t audioFilter_getOuputFrequency(uint32_t inputFrequency);
 typedef enum 
 {
 	AUDIOENC_NONE,

Modified: branches/avidemux_2.4_branch/avidemux/ADM_audiofilter/audiofilter_buildchain.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_audiofilter/audiofilter_buildchain.cpp	2007-08-25 22:48:09 UTC (rev 3561)
+++ branches/avidemux_2.4_branch/avidemux/ADM_audiofilter/audiofilter_buildchain.cpp	2007-08-26 09:13:11 UTC (rev 3562)
@@ -502,5 +502,3 @@
 }
 
 
-
-

Modified: branches/avidemux_2.4_branch/avidemux/ADM_codecs/ADM_ffmpeg.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_codecs/ADM_ffmpeg.cpp	2007-08-25 22:48:09 UTC (rev 3561)
+++ branches/avidemux_2.4_branch/avidemux/ADM_codecs/ADM_ffmpeg.cpp	2007-08-26 09:13:11 UTC (rev 3562)
@@ -21,8 +21,8 @@
  ***************************************************************************/
 #include &quot;config.h&quot;
 
-#ifdef USE_FFMPEG
 
+
 #define __STDC_CONSTANT_MACROS // Lavcodec crap
 
 #include &lt;stdio.h&gt;
@@ -328,6 +328,9 @@
     case FF_H263P:
       WRAP_Open (CODEC_ID_H263P);
       break;
+    case FF_FLV1:
+      WRAP_Open (CODEC_ID_FLV1);
+      break;
     case FF_HUFF:
       WRAP_Open (CODEC_ID_HUFFYUV);
       break;
@@ -894,4 +897,4 @@
   _frame.quality = (int) floor (FF_QP2LAMBDA * _qual + 0.5);
   return ffmpegEncoder::encode(in,out);
 }
-#endif
+

Modified: branches/avidemux_2.4_branch/avidemux/ADM_codecs/ADM_ffmpeg.h
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_codecs/ADM_ffmpeg.h	2007-08-25 22:48:09 UTC (rev 3561)
+++ branches/avidemux_2.4_branch/avidemux/ADM_codecs/ADM_ffmpeg.h	2007-08-26 09:13:11 UTC (rev 3562)
@@ -35,6 +35,7 @@
   FF_SNOW = 10,
   FF_FFHUFF = 11,
   FF_DV=12,
+  FF_FLV1=13,
 } FF_CODEC_ID;
 
 /*

Modified: branches/avidemux_2.4_branch/avidemux/ADM_editor/ADM_outputfmt.h
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_editor/ADM_outputfmt.h	2007-08-25 22:48:09 UTC (rev 3561)
+++ branches/avidemux_2.4_branch/avidemux/ADM_editor/ADM_outputfmt.h	2007-08-26 09:13:11 UTC (rev 3562)
@@ -23,6 +23,7 @@
 	ADM_MP4,
 	ADM_OGM,
 	ADM_PSP,
+	ADM_FLV,
 	ADM_FORMAT_MAX,
 	ADM_FMT_DUMMY=ADM_FORMAT_MAX
 }ADM_OUT_FORMAT;
@@ -45,6 +46,7 @@
   {ADM_MP4,_(&quot;MP4&quot;)},
   {ADM_OGM,_(&quot;OGM&quot;)},
   {ADM_PSP,_(&quot;PSP&quot;)},
+  {ADM_FLV,_(&quot;FLV&quot;)}
 };
 
 #endif

Modified: branches/avidemux_2.4_branch/avidemux/ADM_encoder/ADM_encCodecDesc.h
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_encoder/ADM_encCodecDesc.h	2007-08-25 22:48:09 UTC (rev 3561)
+++ branches/avidemux_2.4_branch/avidemux/ADM_encoder/ADM_encCodecDesc.h	2007-08-26 09:13:11 UTC (rev 3562)
@@ -130,7 +130,22 @@
   sizeof (ffmpeg4Extra),
   NULL
 };
-
+COMPRES_PARAMS ffmpegFLV1 = {
+  CodecFLV1,
+  &quot;FLV1 (lavc)&quot;,
+  &quot;FLV1&quot;,
+  &quot;FLV1&quot;,
+  COMPRESS_CQ,
+  4,
+  1500,
+  700,
+  1000, // AVG
+  ADM_ENC_CAP_CBR + ADM_ENC_CAP_CQ ,
+  ADM_EXTRA_PARAM,
+  &amp;ffmpeg4Extra,
+  sizeof (ffmpeg4Extra),
+  NULL
+};
 COMPRES_PARAMS ffmpegSnow = {
   CodecSnow,
   &quot;Snow (lavc)&quot;,
@@ -749,7 +764,8 @@
   &amp;ffmpegFFV1,
   &amp;yv12codec,
   &amp;ffmpegH263Codec,
-  &amp;MjpegCodec,  
+  &amp;MjpegCodec,
+  &amp;ffmpegFLV1,
   &amp;DUMMYONE
 };
 #endif

Modified: branches/avidemux_2.4_branch/avidemux/ADM_encoder/ADM_vidEncode.hxx
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_encoder/ADM_vidEncode.hxx	2007-08-25 22:48:09 UTC (rev 3561)
+++ branches/avidemux_2.4_branch/avidemux/ADM_encoder/ADM_vidEncode.hxx	2007-08-26 09:13:11 UTC (rev 3562)
@@ -44,6 +44,7 @@
   CodecYV12,
   CodecRequant,
   CodecDV,
+  CodecFLV1,
   CodecDummy
 }SelectCodecType;
 

Modified: branches/avidemux_2.4_branch/avidemux/ADM_encoder/adm_encConfig.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_encoder/adm_encConfig.cpp	2007-08-25 22:48:09 UTC (rev 3561)
+++ branches/avidemux_2.4_branch/avidemux/ADM_encoder/adm_encConfig.cpp	2007-08-26 09:13:11 UTC (rev 3562)
@@ -697,6 +697,9 @@
     case CodecHuff:
       e = new EncoderFFMPEGHuff (&amp;ffmpegHUFF);
       break;
+    case CodecFLV1:
+       e = new EncoderFFMPEGFLV1 (&amp;ffmpegFLV1);
+       break;
     case CodecFFV1:
       e = new EncoderFFMPEGFFV1 (&amp;ffmpegFFV1);
       break;

Modified: branches/avidemux_2.4_branch/avidemux/ADM_encoder/adm_encffmpeg.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_encoder/adm_encffmpeg.cpp	2007-08-25 22:48:09 UTC (rev 3561)
+++ branches/avidemux_2.4_branch/avidemux/ADM_encoder/adm_encffmpeg.cpp	2007-08-26 09:13:11 UTC (rev 3562)
@@ -26,7 +26,7 @@
 
 
 
-#ifdef USE_FFMPEG
+
 #include &quot;ADM_lavcodec.h&quot;
 
 
@@ -269,7 +269,50 @@
 
 
 }
+//********************* FLV1 **********************************************
+EncoderFFMPEGFLV1::EncoderFFMPEGFLV1 (COMPRES_PARAMS * config):
+EncoderFFMPEG (FF_FLV1, config)
+{
+  _id = FF_FLV1;
+  _frametogo = 0;
 
+
+}
+uint8_t
+EncoderFFMPEGFLV1::hasExtraHeaderData (uint32_t * l, uint8_t ** data)
+{
+  *l = 0;
+  *data = NULL;
+  return 0;
+
+}
+uint8_t
+EncoderFFMPEGFLV1::configure (AVDMGenericVideoStream * instream)
+{
+  ADM_assert (instream);
+  ADV_Info *info;
+
+
+
+  info = instream-&gt;getInfo ();
+  _fps = info-&gt;fps1000;
+  _w = info-&gt;width;
+  _h = info-&gt;height;
+  
+  _vbuffer = new ADMImage (_w, _h);
+  ADM_assert (_vbuffer);
+  _in = instream;
+
+ 
+  _codec = new ffmpegEncoderCQ (_w, _h, _id);
+  _codec-&gt;init (_param.qz, _fps, 0);
+  _state=enc_CQ;
+  return 1;
+
+
+
+}
+
 //************************* SNOW **************************
 // return codec name as seen in avi header
 //
@@ -300,6 +343,9 @@
     case FF_SNOW:
       return &quot;SNOW&quot;;
       break;
+    case FF_FLV1:
+      return &quot;FLV1&quot;;
+      break;
 
     default:
       ADM_assert (0);
@@ -532,4 +578,4 @@
 }
 //-----------------------ffmpegEncoderHuff
 
-#endif
+

Modified: branches/avidemux_2.4_branch/avidemux/ADM_encoder/adm_encffmpeg.h
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_encoder/adm_encffmpeg.h	2007-08-25 22:48:09 UTC (rev 3561)
+++ branches/avidemux_2.4_branch/avidemux/ADM_encoder/adm_encffmpeg.h	2007-08-26 09:13:11 UTC (rev 3562)
@@ -298,5 +298,46 @@
   virtual uint8_t hasExtraHeaderData (uint32_t * l, uint8_t ** data);
 
 };
+class EncoderFFMPEGFLV1:public EncoderFFMPEG
+{
 
+protected:
+
+
+public:
+	EncoderFFMPEGFLV1 (COMPRES_PARAMS * config);
+  ~EncoderFFMPEGFLV1 ()
+  {
+    stop ();
+  };				// can be called twice if needed ..
+  virtual uint8_t isDualPass (void)
+  {
+    return 0;
+  };
+  virtual uint8_t configure (AVDMGenericVideoStream * instream);
+  virtual uint8_t setLogFile (const char *p, uint32_t fr)
+  {
+    UNUSED_ARG (p);
+    UNUSED_ARG (fr);
+    return 1;
+  };
+  virtual uint8_t startPass2 (void)
+  {
+    return 1;
+  };
+  virtual uint8_t startPass1 (void)
+  {
+    return 1;
+  };
+  virtual const char *getDisplayName (void)
+  {
+    return &quot;FFMPEG FLV1&quot;;
+  }
+  virtual const char *getFCCHandler (void)
+  {
+    return &quot;FLV1&quot;;
+  }
+  virtual uint8_t hasExtraHeaderData (uint32_t * l, uint8_t ** data);
+
+};
 #endif

Modified: branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec/ffconf.c
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec/ffconf.c	2007-08-25 22:48:09 UTC (rev 3561)
+++ branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec/ffconf.c	2007-08-26 09:13:11 UTC (rev 3562)
@@ -213,6 +213,7 @@
     DECLARE_ENCODER(H263P, h263p);
     DECLARE_ENCODER(AC3, ac3);
     DECLARE_ENCODER (FFV1, ffv1);
+    DECLARE_ENCODER (FLV1, flv1);
     DECLARE_ENCODER (FFVHUFF, ffvhuff);
     DECLARE_ENCODER (H263, h263);
     DECLARE_ENCODER (MPEG1VIDEO, mpeg1video);

Modified: branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec/ffconf.h
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec/ffconf.h	2007-08-25 22:48:09 UTC (rev 3561)
+++ branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec/ffconf.h	2007-08-26 09:13:11 UTC (rev 3562)
@@ -1,305 +1,306 @@
-#define ENABLE_CINEPAK_DECODER 1
-#define ENABLE_DNXHD_DECODER 1
-#define ENABLE_FOURXM_DECODER 1
-#define ENABLE_FRAPS_DECODER 1
-#define ENABLE_H263I_DECODER 1
-#define ENABLE_H264_DECODER 1
-#define ENABLE_INDEO2_DECODER 1
-#define ENABLE_INDEO3_DECODER 1
-#define ENABLE_INTERPLAY_VIDEO_DECODER 1
-#define ENABLE_MPEGVIDEO_DECODER 1
-#define ENABLE_MSVIDEO1_DECODER 1
-#define ENABLE_VC1_DECODER 1
-#define ENABLE_VCR1_DECODER 1
-#define ENABLE_VP5_DECODER 1
-#define ENABLE_VP6_DECODER 1
-#define ENABLE_VP6F_DECODER 1
-#define ENABLE_WMV3_DECODER 1
-#define ENABLE_WMV1_DECODER 1
-#define ENABLE_WMV2_DECODER 1
-#define ENABLE_VP3_DECODER 1
-#define ENABLE_MPEG4_DECODER 1
-#define ENABLE_MSMPEG4V1_DECODER 1
-#define ENABLE_MSMPEG4V2_DECODER 1
-#define ENABLE_MSMPEG4V3_DECODER 1
-#define ENABLE_MJPEGB_DECODER 1
-#define ENABLE_MJPEG_DECODER 1
-#define ENABLE_WMAV2_DECODER 1
-#define ENABLE_DVVIDEO_DECODER 1
-#define ENABLE_HUFFYUV_DECODER 1
-#define ENABLE_FFVHUFF_DECODER 1
-#define ENABLE_SVQ3_DECODER 1
-#define ENABLE_TSCC_DECODER 1
-#define ENABLE_QDM2_DECODER 1
-#define ENABLE_FFV1_DECODER 1
-#define ENABLE_MPEG1VIDEO_DECODER 1
-#define ENABLE_MPEG2VIDEO_DECODER 1
-#define ENABLE_RV10_DECODER 1
-#define ENABLE_RV20_DECODER 1
-#define ENABLE_DVBSUB_DECODER 1
-#define ENABLE_FLV_DECODER 1
-#define ENABLE_SNOW_DECODER 1
-#define ENABLE_AASC_DECODER 0
-#define ENABLE_AVS_DECODER 0
-#define ENABLE_BETHSOFTVID_DECODER 0
-#define ENABLE_C93_DECODER 0
-#define ENABLE_CAVS_DECODER 0
-#define ENABLE_CLJR_DECODER 0
-#define ENABLE_CSCD_DECODER 0
-#define ENABLE_CYUV_DECODER 0
-#define ENABLE_DSICINVIDEO_DECODER 0
-#define ENABLE_DXA_DECODER 0
-#define ENABLE_EIGHTBPS_DECODER 0
-#define ENABLE_FLIC_DECODER 0
-#define ENABLE_IDCIN_DECODER 0
-#define ENABLE_KMVC_DECODER 0
-#define ENABLE_LOCO_DECODER 0
-#define ENABLE_MDEC_DECODER 0
-#define ENABLE_MMVIDEO_DECODER 0
-#define ENABLE_MPEG_XVMC_DECODER 0
-#define ENABLE_MSRLE_DECODER 0
-#define ENABLE_MSZH_DECODER 0
-#define ENABLE_NUV_DECODER 0
-#define ENABLE_PTX_DECODER 0
-#define ENABLE_QDRAW_DECODER 0
-#define ENABLE_QPEG_DECODER 0
-#define ENABLE_RPZA_DECODER 0
-#define ENABLE_SMACKER_DECODER 0
-#define ENABLE_SMC_DECODER 0
-#define ENABLE_SP5X_DECODER 0
-#define ENABLE_THEORA_DECODER 0
-#define ENABLE_THP_DECODER 0
-#define ENABLE_TIERTEXSEQVIDEO_DECODER 0
-#define ENABLE_TRUEMOTION1_DECODER 0
-#define ENABLE_TRUEMOTION2_DECODER 0
-#define ENABLE_TXD_DECODER 0
-#define ENABLE_ULTI_DECODER 0
-#define ENABLE_VMDVIDEO_DECODER 0
-#define ENABLE_VMNC_DECODER 0
-#define ENABLE_VQA_DECODER 0
-#define ENABLE_WNV1_DECODER 0
-#define ENABLE_XAN_WC3_DECODER 0
-#define ENABLE_XL_DECODER 0
-#define ENABLE_MPEG4AAC_DECODER 0
-#define ENABLE_ALAC_DECODER 0
-#define ENABLE_ATRAC3_DECODER 0
-#define ENABLE_COOK_DECODER 0
-#define ENABLE_DCA_DECODER 0
-#define ENABLE_DSICINAUDIO_DECODER 0
-#define ENABLE_IMC_DECODER 0
-#define ENABLE_LIBA52_DECODER 0
-#define ENABLE_LIBFAAD_DECODER 0
-#define ENABLE_MACE3_DECODER 0
-#define ENABLE_MACE6_DECODER 0
-#define ENABLE_MP3_DECODER 0
-#define ENABLE_MP3ADU_DECODER 0
-#define ENABLE_MP3ON4_DECODER 0
-#define ENABLE_MPC7_DECODER 0
-#define ENABLE_RA_144_DECODER 0
-#define ENABLE_RA_288_DECODER 0
-#define ENABLE_SHORTEN_DECODER 0
-#define ENABLE_SMACKAUD_DECODER 0
-#define ENABLE_TRUESPEECH_DECODER 0
-#define ENABLE_TTA_DECODER 0
-#define ENABLE_VMDAUDIO_DECODER 0
-#define ENABLE_WAVPACK_DECODER 0
-#define ENABLE_WS_SND1_DECODER 0
-#define ENABLE_INTERPLAY_DPCM_DECODER 0
-#define ENABLE_SOL_DPCM_DECODER 0
-#define ENABLE_XAN_DPCM_DECODER 0
-#define ENABLE_ADPCM_THP_DECODER 0
-#define ENABLE_ASV1_DECODER 0
-#define ENABLE_ASV2_DECODER 0
-#define ENABLE_BMP_DECODER 0
-#define ENABLE_FLASHSV_DECODER 0
-#define ENABLE_GIF_DECODER 0
-#define ENABLE_H261_DECODER 0
-#define ENABLE_H263_DECODER 0
-#define ENABLE_JPEGLS_DECODER 0
-#define ENABLE_PNG_DECODER 0
-#define ENABLE_QTRLE_DECODER 0
-#define ENABLE_RAWVIDEO_DECODER 0
-#define ENABLE_ROQ_DECODER 0
-#define ENABLE_SGI_DECODER 0
-#define ENABLE_SVQ1_DECODER 0
-#define ENABLE_TARGA_DECODER 0
-#define ENABLE_TIFF_DECODER 0
-#define ENABLE_ZLIB_DECODER 0
-#define ENABLE_ZMBV_DECODER 0
-#define ENABLE_FLAC_DECODER 0
-#define ENABLE_LIBAMR_NB_DECODER 0
-#define ENABLE_LIBAMR_WB_DECODER 0
-#define ENABLE_LIBGSM_DECODER 0
-#define ENABLE_LIBGSM_MS_DECODER 0
-#define ENABLE_MP2_DECODER 0
-#define ENABLE_SONIC_DECODER 0
-#define ENABLE_VORBIS_DECODER 0
-#define ENABLE_WMAV1_DECODER 0
-#define ENABLE_PCM_ALAW_DECODER 0
-#define ENABLE_PCM_MULAW_DECODER 0
-#define ENABLE_PCM_S8_DECODER 0
-#define ENABLE_PCM_S16BE_DECODER 0
-#define ENABLE_PCM_S16LE_DECODER 0
-#define ENABLE_PCM_S24BE_DECODER 0
-#define ENABLE_PCM_S24DAUD_DECODER 0
-#define ENABLE_PCM_S24LE_DECODER 0
-#define ENABLE_PCM_S32BE_DECODER 0
-#define ENABLE_PCM_S32LE_DECODER 0
-#define ENABLE_PCM_U8_DECODER 0
-#define ENABLE_PCM_U16BE_DECODER 0
-#define ENABLE_PCM_U16LE_DECODER 0
-#define ENABLE_PCM_U24BE_DECODER 0
-#define ENABLE_PCM_U24LE_DECODER 0
-#define ENABLE_PCM_U32BE_DECODER 0
-#define ENABLE_PCM_U32LE_DECODER 0
-#define ENABLE_ROQ_DPCM_DECODER 0
-#define ENABLE_ADPCM_4XM_DECODER 0
-#define ENABLE_ADPCM_ADX_DECODER 0
-#define ENABLE_ADPCM_CT_DECODER 0
-#define ENABLE_ADPCM_EA_DECODER 0
-#define ENABLE_ADPCM_G726_DECODER 0
-#define ENABLE_ADPCM_IMA_DK3_DECODER 0
-#define ENABLE_ADPCM_IMA_DK4_DECODER 0
-#define ENABLE_ADPCM_IMA_QT_DECODER 0
-#define ENABLE_ADPCM_IMA_SMJPEG_DECODER 0
-#define ENABLE_ADPCM_IMA_WAV_DECODER 0
-#define ENABLE_ADPCM_IMA_WS_DECODER 0
-#define ENABLE_ADPCM_MS_DECODER 0
-#define ENABLE_ADPCM_SBPRO_2_DECODER 0
-#define ENABLE_ADPCM_SBPRO_3_DECODER 0
-#define ENABLE_ADPCM_SBPRO_4_DECODER 0
-#define ENABLE_ADPCM_SWF_DECODER 0
-#define ENABLE_ADPCM_XA_DECODER 0
-#define ENABLE_ADPCM_YAMAHA_DECODER 0
-#define ENABLE_DVDSUB_DECODER 0
-#define ENABLE_H263_PARSER 1
-#define ENABLE_H264_PARSER 1
-#define ENABLE_MPEG4VIDEO_PARSER 1
-#define ENABLE_AAC_PARSER 0
-#define ENABLE_AC3_PARSER 0
-#define ENABLE_CAVSVIDEO_PARSER 0
-#define ENABLE_DCA_PARSER 0
-#define ENABLE_DVBSUB_PARSER 0
-#define ENABLE_DVDSUB_PARSER 0
-#define ENABLE_H261_PARSER 0
-#define ENABLE_MJPEG_PARSER 0
-#define ENABLE_MPEGAUDIO_PARSER 0
-#define ENABLE_MPEGVIDEO_PARSER 0
-#define ENABLE_PNM_PARSER 0
-#define ENABLE_VC1_PARSER 0
-#define ENABLE_MJPEG_ENCODER 1
-#define ENABLE_MSMPEG4V3_ENCODER 1
-#define ENABLE_H263P_ENCODER 1
-#define ENABLE_AC3_ENCODER 1
-#define ENABLE_FFV1_ENCODER 1
-#define ENABLE_FFVHUFF_ENCODER 1
-#define ENABLE_H263_ENCODER 1
-#define ENABLE_MPEG1VIDEO_ENCODER 1
-#define ENABLE_MPEG2VIDEO_ENCODER 1
-#define ENABLE_MPEG4_ENCODER 1
-#define ENABLE_FLV_ENCODER 1
-#define ENABLE_SNOW_ENCODER 1
-#define ENABLE_MP2_ENCODER 1
-#define ENABLE_DVVIDEO_ENCODER 1
-#define ENABLE_HUFFYUV_ENCODER 1
-#define ENABLE_DVBSUB_ENCODER 1
-#define ENABLE_LIBX264_ENCODER 0
-#define ENABLE_LIBXVID_ENCODER 0
-#define ENABLE_LJPEG_ENCODER 0
-#define ENABLE_PAM_ENCODER 0
-#define ENABLE_PBM_ENCODER 0
-#define ENABLE_PGM_ENCODER 0
-#define ENABLE_PGMYUV_ENCODER 0
-#define ENABLE_PPM_ENCODER 0
-#define ENABLE_LIBFAAC_ENCODER 0
-#define ENABLE_LIBMP3LAME_ENCODER 0
-#define ENABLE_LIBTHEORA_ENCODER 0
-#define ENABLE_SONIC_LS_ENCODER 0
-#define ENABLE_ASV1_ENCODER 0
-#define ENABLE_ASV2_ENCODER 0
-#define ENABLE_BMP_ENCODER 0
-#define ENABLE_FLASHSV_ENCODER 0
-#define ENABLE_GIF_ENCODER 0
-#define ENABLE_H261_ENCODER 0
-#define ENABLE_JPEGLS_ENCODER 0
-#define ENABLE_MSMPEG4V1_ENCODER 0
-#define ENABLE_MSMPEG4V2_ENCODER 0
-#define ENABLE_PNG_ENCODER 0
-#define ENABLE_QTRLE_ENCODER 0
-#define ENABLE_RAWVIDEO_ENCODER 0
-#define ENABLE_ROQ_ENCODER 0
-#define ENABLE_RV10_ENCODER 0
-#define ENABLE_RV20_ENCODER 0
-#define ENABLE_SGI_ENCODER 0
-#define ENABLE_SVQ1_ENCODER 0
-#define ENABLE_TARGA_ENCODER 0
-#define ENABLE_TIFF_ENCODER 0
-#define ENABLE_WMV1_ENCODER 0
-#define ENABLE_WMV2_ENCODER 0
-#define ENABLE_ZLIB_ENCODER 0
-#define ENABLE_ZMBV_ENCODER 0
-#define ENABLE_FLAC_ENCODER 0
-#define ENABLE_LIBAMR_NB_ENCODER 0
-#define ENABLE_LIBAMR_WB_ENCODER 0
-#define ENABLE_LIBGSM_ENCODER 0
-#define ENABLE_LIBGSM_MS_ENCODER 0
-#define ENABLE_SONIC_ENCODER 0
-#define ENABLE_VORBIS_ENCODER 0
-#define ENABLE_WMAV1_ENCODER 0
-#define ENABLE_WMAV2_ENCODER 0
-#define ENABLE_PCM_ALAW_ENCODER 0
-#define ENABLE_PCM_MULAW_ENCODER 0
-#define ENABLE_PCM_S8_ENCODER 0
-#define ENABLE_PCM_S16BE_ENCODER 0
-#define ENABLE_PCM_S16LE_ENCODER 0
-#define ENABLE_PCM_S24BE_ENCODER 0
-#define ENABLE_PCM_S24DAUD_ENCODER 0
-#define ENABLE_PCM_S24LE_ENCODER 0
-#define ENABLE_PCM_S32BE_ENCODER 0
-#define ENABLE_PCM_S32LE_ENCODER 0
-#define ENABLE_PCM_U8_ENCODER 0
-#define ENABLE_PCM_U16BE_ENCODER 0
-#define ENABLE_PCM_U16LE_ENCODER 0
-#define ENABLE_PCM_U24BE_ENCODER 0
-#define ENABLE_PCM_U24LE_ENCODER 0
-#define ENABLE_PCM_U32BE_ENCODER 0
-#define ENABLE_PCM_U32LE_ENCODER 0
-#define ENABLE_ROQ_DPCM_ENCODER 0
-#define ENABLE_ADPCM_4XM_ENCODER 0
-#define ENABLE_ADPCM_ADX_ENCODER 0
-#define ENABLE_ADPCM_CT_ENCODER 0
-#define ENABLE_ADPCM_EA_ENCODER 0
-#define ENABLE_ADPCM_G726_ENCODER 0
-#define ENABLE_ADPCM_IMA_DK3_ENCODER 0
-#define ENABLE_ADPCM_IMA_DK4_ENCODER 0
-#define ENABLE_ADPCM_IMA_QT_ENCODER 0
-#define ENABLE_ADPCM_IMA_SMJPEG_ENCODER 0
-#define ENABLE_ADPCM_IMA_WAV_ENCODER 0
-#define ENABLE_ADPCM_IMA_WS_ENCODER 0
-#define ENABLE_ADPCM_MS_ENCODER 0
-#define ENABLE_ADPCM_SBPRO_2_ENCODER 0
-#define ENABLE_ADPCM_SBPRO_3_ENCODER 0
-#define ENABLE_ADPCM_SBPRO_4_ENCODER 0
-#define ENABLE_ADPCM_SWF_ENCODER 0
-#define ENABLE_ADPCM_XA_ENCODER 0
-#define ENABLE_ADPCM_YAMAHA_ENCODER 0
-#define ENABLE_DVDSUB_ENCODER 0
-#define ENABLE_LIBVORBIS_ENCODER        0
-#define ENABLE_LIBVORBIS_DECODER        0
-#define ENABLE_MP3_HEADER_COMPRESS_BSF  0
-#define ENABLE_IMX_DUMP_HEADER_BSF      0
-#define ENABLE_DUMP_EXTRADATA_BSF       0
-#define ENABLE_REMOVE_EXTRADATA_BSF     0
-#define ENABLE_NOISE_BSF                0
-#define ENABLE_MP3_HEADER_DECOMPRESS_BSF 0
-#define ENABLE_MJPEGA_DUMP_HEADER_BSF   0
-#define ENABLE_IMX_DUMP_HEADER_BSF      0
-#define ENABLE_ARMV4L      0
-#define ENABLE_MLIB      0
-#define ENABLE_SPARC      0
-#define ENABLE_ALPHA      0
-#define ENABLE_POWERPC      0
-#define ENABLE_MMI      0
-#define ENABLE_SH4      0
-#define ENABLE_BFIN      0
-#define ENABLE_SMALL      0
+#define ENABLE_CINEPAK_DECODER 1
+#define ENABLE_DNXHD_DECODER 1
+#define ENABLE_FOURXM_DECODER 1
+#define ENABLE_FRAPS_DECODER 1
+#define ENABLE_H263I_DECODER 1
+#define ENABLE_H264_DECODER 1
+#define ENABLE_INDEO2_DECODER 1
+#define ENABLE_INDEO3_DECODER 1
+#define ENABLE_INTERPLAY_VIDEO_DECODER 1
+#define ENABLE_MPEGVIDEO_DECODER 1
+#define ENABLE_MSVIDEO1_DECODER 1
+#define ENABLE_VC1_DECODER 1
+#define ENABLE_VCR1_DECODER 1
+#define ENABLE_VP5_DECODER 1
+#define ENABLE_VP6_DECODER 1
+#define ENABLE_VP6F_DECODER 1
+#define ENABLE_WMV3_DECODER 1
+#define ENABLE_WMV1_DECODER 1
+#define ENABLE_WMV2_DECODER 1
+#define ENABLE_VP3_DECODER 1
+#define ENABLE_MPEG4_DECODER 1
+#define ENABLE_MSMPEG4V1_DECODER 1
+#define ENABLE_MSMPEG4V2_DECODER 1
+#define ENABLE_MSMPEG4V3_DECODER 1
+#define ENABLE_MJPEGB_DECODER 1
+#define ENABLE_MJPEG_DECODER 1
+#define ENABLE_WMAV2_DECODER 1
+#define ENABLE_DVVIDEO_DECODER 1
+#define ENABLE_HUFFYUV_DECODER 1
+#define ENABLE_FFVHUFF_DECODER 1
+#define ENABLE_SVQ3_DECODER 1
+#define ENABLE_TSCC_DECODER 1
+#define ENABLE_QDM2_DECODER 1
+#define ENABLE_FFV1_DECODER 1
+#define ENABLE_MPEG1VIDEO_DECODER 1
+#define ENABLE_MPEG2VIDEO_DECODER 1
+#define ENABLE_RV10_DECODER 1
+#define ENABLE_RV20_DECODER 1
+#define ENABLE_DVBSUB_DECODER 1
+#define ENABLE_FLV_DECODER 1
+#define ENABLE_SNOW_DECODER 1
+#define ENABLE_AASC_DECODER 0
+#define ENABLE_AVS_DECODER 0
+#define ENABLE_BETHSOFTVID_DECODER 0
+#define ENABLE_C93_DECODER 0
+#define ENABLE_CAVS_DECODER 0
+#define ENABLE_CLJR_DECODER 0
+#define ENABLE_CSCD_DECODER 0
+#define ENABLE_CYUV_DECODER 0
+#define ENABLE_DSICINVIDEO_DECODER 0
+#define ENABLE_DXA_DECODER 0
+#define ENABLE_EIGHTBPS_DECODER 0
+#define ENABLE_FLIC_DECODER 0
+#define ENABLE_IDCIN_DECODER 0
+#define ENABLE_KMVC_DECODER 0
+#define ENABLE_LOCO_DECODER 0
+#define ENABLE_MDEC_DECODER 0
+#define ENABLE_MMVIDEO_DECODER 0
+#define ENABLE_MPEG_XVMC_DECODER 0
+#define ENABLE_MSRLE_DECODER 0
+#define ENABLE_MSZH_DECODER 0
+#define ENABLE_NUV_DECODER 0
+#define ENABLE_PTX_DECODER 0
+#define ENABLE_QDRAW_DECODER 0
+#define ENABLE_QPEG_DECODER 0
+#define ENABLE_RPZA_DECODER 0
+#define ENABLE_SMACKER_DECODER 0
+#define ENABLE_SMC_DECODER 0
+#define ENABLE_SP5X_DECODER 0
+#define ENABLE_THEORA_DECODER 0
+#define ENABLE_THP_DECODER 0
+#define ENABLE_TIERTEXSEQVIDEO_DECODER 0
+#define ENABLE_TRUEMOTION1_DECODER 0
+#define ENABLE_TRUEMOTION2_DECODER 0
+#define ENABLE_TXD_DECODER 0
+#define ENABLE_ULTI_DECODER 0
+#define ENABLE_VMDVIDEO_DECODER 0
+#define ENABLE_VMNC_DECODER 0
+#define ENABLE_VQA_DECODER 0
+#define ENABLE_WNV1_DECODER 0
+#define ENABLE_XAN_WC3_DECODER 0
+#define ENABLE_XL_DECODER 0
+#define ENABLE_MPEG4AAC_DECODER 0
+#define ENABLE_ALAC_DECODER 0
+#define ENABLE_ATRAC3_DECODER 0
+#define ENABLE_COOK_DECODER 0
+#define ENABLE_DCA_DECODER 0
+#define ENABLE_DSICINAUDIO_DECODER 0
+#define ENABLE_IMC_DECODER 0
+#define ENABLE_LIBA52_DECODER 0
+#define ENABLE_LIBFAAD_DECODER 0
+#define ENABLE_MACE3_DECODER 0
+#define ENABLE_MACE6_DECODER 0
+#define ENABLE_MP3_DECODER 0
+#define ENABLE_MP3ADU_DECODER 0
+#define ENABLE_MP3ON4_DECODER 0
+#define ENABLE_MPC7_DECODER 0
+#define ENABLE_RA_144_DECODER 0
+#define ENABLE_RA_288_DECODER 0
+#define ENABLE_SHORTEN_DECODER 0
+#define ENABLE_SMACKAUD_DECODER 0
+#define ENABLE_TRUESPEECH_DECODER 0
+#define ENABLE_TTA_DECODER 0
+#define ENABLE_VMDAUDIO_DECODER 0
+#define ENABLE_WAVPACK_DECODER 0
+#define ENABLE_WS_SND1_DECODER 0
+#define ENABLE_INTERPLAY_DPCM_DECODER 0
+#define ENABLE_SOL_DPCM_DECODER 0
+#define ENABLE_XAN_DPCM_DECODER 0
+#define ENABLE_ADPCM_THP_DECODER 0
+#define ENABLE_ASV1_DECODER 0
+#define ENABLE_ASV2_DECODER 0
+#define ENABLE_BMP_DECODER 0
+#define ENABLE_FLASHSV_DECODER 0
+#define ENABLE_GIF_DECODER 0
+#define ENABLE_H261_DECODER 0
+#define ENABLE_H263_DECODER 0
+#define ENABLE_JPEGLS_DECODER 0
+#define ENABLE_PNG_DECODER 0
+#define ENABLE_QTRLE_DECODER 0
+#define ENABLE_RAWVIDEO_DECODER 0
+#define ENABLE_ROQ_DECODER 0
+#define ENABLE_SGI_DECODER 0
+#define ENABLE_SVQ1_DECODER 0
+#define ENABLE_TARGA_DECODER 0
+#define ENABLE_TIFF_DECODER 0
+#define ENABLE_ZLIB_DECODER 0
+#define ENABLE_ZMBV_DECODER 0
+#define ENABLE_FLAC_DECODER 0
+#define ENABLE_LIBAMR_NB_DECODER 0
+#define ENABLE_LIBAMR_WB_DECODER 0
+#define ENABLE_LIBGSM_DECODER 0
+#define ENABLE_LIBGSM_MS_DECODER 0
+#define ENABLE_MP2_DECODER 0
+#define ENABLE_SONIC_DECODER 0
+#define ENABLE_VORBIS_DECODER 0
+#define ENABLE_WMAV1_DECODER 0
+#define ENABLE_PCM_ALAW_DECODER 0
+#define ENABLE_PCM_MULAW_DECODER 0
+#define ENABLE_PCM_S8_DECODER 0
+#define ENABLE_PCM_S16BE_DECODER 0
+#define ENABLE_PCM_S16LE_DECODER 0
+#define ENABLE_PCM_S24BE_DECODER 0
+#define ENABLE_PCM_S24DAUD_DECODER 0
+#define ENABLE_PCM_S24LE_DECODER 0
+#define ENABLE_PCM_S32BE_DECODER 0
+#define ENABLE_PCM_S32LE_DECODER 0
+#define ENABLE_PCM_U8_DECODER 0
+#define ENABLE_PCM_U16BE_DECODER 0
+#define ENABLE_PCM_U16LE_DECODER 0
+#define ENABLE_PCM_U24BE_DECODER 0
+#define ENABLE_PCM_U24LE_DECODER 0
+#define ENABLE_PCM_U32BE_DECODER 0
+#define ENABLE_PCM_U32LE_DECODER 0
+#define ENABLE_ROQ_DPCM_DECODER 0
+#define ENABLE_ADPCM_4XM_DECODER 0
+#define ENABLE_ADPCM_ADX_DECODER 0
+#define ENABLE_ADPCM_CT_DECODER 0
+#define ENABLE_ADPCM_EA_DECODER 0
+#define ENABLE_ADPCM_G726_DECODER 0
+#define ENABLE_ADPCM_IMA_DK3_DECODER 0
+#define ENABLE_ADPCM_IMA_DK4_DECODER 0
+#define ENABLE_ADPCM_IMA_QT_DECODER 0
+#define ENABLE_ADPCM_IMA_SMJPEG_DECODER 0
+#define ENABLE_ADPCM_IMA_WAV_DECODER 0
+#define ENABLE_ADPCM_IMA_WS_DECODER 0
+#define ENABLE_ADPCM_MS_DECODER 0
+#define ENABLE_ADPCM_SBPRO_2_DECODER 0
+#define ENABLE_ADPCM_SBPRO_3_DECODER 0
+#define ENABLE_ADPCM_SBPRO_4_DECODER 0
+#define ENABLE_ADPCM_SWF_DECODER 0
+#define ENABLE_ADPCM_XA_DECODER 0
+#define ENABLE_ADPCM_YAMAHA_DECODER 0
+#define ENABLE_DVDSUB_DECODER 0
+#define ENABLE_H263_PARSER 1
+#define ENABLE_H264_PARSER 1
+#define ENABLE_MPEG4VIDEO_PARSER 1
+#define ENABLE_AAC_PARSER 0
+#define ENABLE_AC3_PARSER 0
+#define ENABLE_CAVSVIDEO_PARSER 0
+#define ENABLE_DCA_PARSER 0
+#define ENABLE_DVBSUB_PARSER 0
+#define ENABLE_DVDSUB_PARSER 0
+#define ENABLE_H261_PARSER 0
+#define ENABLE_MJPEG_PARSER 0
+#define ENABLE_MPEGAUDIO_PARSER 0
+#define ENABLE_MPEGVIDEO_PARSER 0
+#define ENABLE_PNM_PARSER 0
+#define ENABLE_VC1_PARSER 0
+#define ENABLE_MJPEG_ENCODER 1
+#define ENABLE_MSMPEG4V3_ENCODER 1
+#define ENABLE_H263P_ENCODER 1
+#define ENABLE_AC3_ENCODER 1
+#define ENABLE_FFV1_ENCODER 1
+#define ENABLE_FLV1_ENCODER 1
+#define ENABLE_FFVHUFF_ENCODER 1
+#define ENABLE_H263_ENCODER 1
+#define ENABLE_MPEG1VIDEO_ENCODER 1
+#define ENABLE_MPEG2VIDEO_ENCODER 1
+#define ENABLE_MPEG4_ENCODER 1
+#define ENABLE_FLV_ENCODER 1
+#define ENABLE_SNOW_ENCODER 1
+#define ENABLE_MP2_ENCODER 1
+#define ENABLE_DVVIDEO_ENCODER 1
+#define ENABLE_HUFFYUV_ENCODER 1
+#define ENABLE_DVBSUB_ENCODER 1
+#define ENABLE_LIBX264_ENCODER 0
+#define ENABLE_LIBXVID_ENCODER 0
+#define ENABLE_LJPEG_ENCODER 0
+#define ENABLE_PAM_ENCODER 0
+#define ENABLE_PBM_ENCODER 0
+#define ENABLE_PGM_ENCODER 0
+#define ENABLE_PGMYUV_ENCODER 0
+#define ENABLE_PPM_ENCODER 0
+#define ENABLE_LIBFAAC_ENCODER 0
+#define ENABLE_LIBMP3LAME_ENCODER 0
+#define ENABLE_LIBTHEORA_ENCODER 0
+#define ENABLE_SONIC_LS_ENCODER 0
+#define ENABLE_ASV1_ENCODER 0
+#define ENABLE_ASV2_ENCODER 0
+#define ENABLE_BMP_ENCODER 0
+#define ENABLE_FLASHSV_ENCODER 0
+#define ENABLE_GIF_ENCODER 0
+#define ENABLE_H261_ENCODER 0
+#define ENABLE_JPEGLS_ENCODER 0
+#define ENABLE_MSMPEG4V1_ENCODER 0
+#define ENABLE_MSMPEG4V2_ENCODER 0
+#define ENABLE_PNG_ENCODER 0
+#define ENABLE_QTRLE_ENCODER 0
+#define ENABLE_RAWVIDEO_ENCODER 0
+#define ENABLE_ROQ_ENCODER 0
+#define ENABLE_RV10_ENCODER 0
+#define ENABLE_RV20_ENCODER 0
+#define ENABLE_SGI_ENCODER 0
+#define ENABLE_SVQ1_ENCODER 0
+#define ENABLE_TARGA_ENCODER 0
+#define ENABLE_TIFF_ENCODER 0
+#define ENABLE_WMV1_ENCODER 0
+#define ENABLE_WMV2_ENCODER 0
+#define ENABLE_ZLIB_ENCODER 0
+#define ENABLE_ZMBV_ENCODER 0
+#define ENABLE_FLAC_ENCODER 0
+#define ENABLE_LIBAMR_NB_ENCODER 0
+#define ENABLE_LIBAMR_WB_ENCODER 0
+#define ENABLE_LIBGSM_ENCODER 0
+#define ENABLE_LIBGSM_MS_ENCODER 0
+#define ENABLE_SONIC_ENCODER 0
+#define ENABLE_VORBIS_ENCODER 0
+#define ENABLE_WMAV1_ENCODER 0
+#define ENABLE_WMAV2_ENCODER 0
+#define ENABLE_PCM_ALAW_ENCODER 0
+#define ENABLE_PCM_MULAW_ENCODER 0
+#define ENABLE_PCM_S8_ENCODER 0
+#define ENABLE_PCM_S16BE_ENCODER 0
+#define ENABLE_PCM_S16LE_ENCODER 0
+#define ENABLE_PCM_S24BE_ENCODER 0
+#define ENABLE_PCM_S24DAUD_ENCODER 0
+#define ENABLE_PCM_S24LE_ENCODER 0
+#define ENABLE_PCM_S32BE_ENCODER 0
+#define ENABLE_PCM_S32LE_ENCODER 0
+#define ENABLE_PCM_U8_ENCODER 0
+#define ENABLE_PCM_U16BE_ENCODER 0
+#define ENABLE_PCM_U16LE_ENCODER 0
+#define ENABLE_PCM_U24BE_ENCODER 0
+#define ENABLE_PCM_U24LE_ENCODER 0
+#define ENABLE_PCM_U32BE_ENCODER 0
+#define ENABLE_PCM_U32LE_ENCODER 0
+#define ENABLE_ROQ_DPCM_ENCODER 0
+#define ENABLE_ADPCM_4XM_ENCODER 0
+#define ENABLE_ADPCM_ADX_ENCODER 0
+#define ENABLE_ADPCM_CT_ENCODER 0
+#define ENABLE_ADPCM_EA_ENCODER 0
+#define ENABLE_ADPCM_G726_ENCODER 0
+#define ENABLE_ADPCM_IMA_DK3_ENCODER 0
+#define ENABLE_ADPCM_IMA_DK4_ENCODER 0
+#define ENABLE_ADPCM_IMA_QT_ENCODER 0
+#define ENABLE_ADPCM_IMA_SMJPEG_ENCODER 0
+#define ENABLE_ADPCM_IMA_WAV_ENCODER 0
+#define ENABLE_ADPCM_IMA_WS_ENCODER 0
+#define ENABLE_ADPCM_MS_ENCODER 0
+#define ENABLE_ADPCM_SBPRO_2_ENCODER 0
+#define ENABLE_ADPCM_SBPRO_3_ENCODER 0
+#define ENABLE_ADPCM_SBPRO_4_ENCODER 0
+#define ENABLE_ADPCM_SWF_ENCODER 0
+#define ENABLE_ADPCM_XA_ENCODER 0
+#define ENABLE_ADPCM_YAMAHA_ENCODER 0
+#define ENABLE_DVDSUB_ENCODER 0
+#define ENABLE_LIBVORBIS_ENCODER        0
+#define ENABLE_LIBVORBIS_DECODER        0
+#define ENABLE_MP3_HEADER_COMPRESS_BSF  0
+#define ENABLE_IMX_DUMP_HEADER_BSF      0
+#define ENABLE_DUMP_EXTRADATA_BSF       0
+#define ENABLE_REMOVE_EXTRADATA_BSF     0
+#define ENABLE_NOISE_BSF                0
+#define ENABLE_MP3_HEADER_DECOMPRESS_BSF 0
+#define ENABLE_MJPEGA_DUMP_HEADER_BSF   0
+#define ENABLE_IMX_DUMP_HEADER_BSF      0
+#define ENABLE_ARMV4L      0
+#define ENABLE_MLIB      0
+#define ENABLE_SPARC      0
+#define ENABLE_ALPHA      0
+#define ENABLE_POWERPC      0
+#define ENABLE_MMI      0
+#define ENABLE_SH4      0
+#define ENABLE_BFIN      0
+#define ENABLE_SMALL      0

Modified: branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavformat/ADM_lavformat.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavformat/ADM_lavformat.cpp	2007-08-25 22:48:09 UTC (rev 3561)
+++ branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavformat/ADM_lavformat.cpp	2007-08-26 09:13:11 UTC (rev 3562)
@@ -109,26 +109,29 @@
 	_fps1000=info-&gt;fps1000;
 	switch(_type)
 	{
-                case MUXER_TS:
-                        fmt=guess_format(&quot;mpegts&quot;, NULL, NULL);
-                        break;
-		case MUXER_DVD:
-			fmt = guess_format(&quot;dvd&quot;, NULL, NULL);
-			break;
-		case MUXER_VCD:
-			fmt = guess_format(&quot;vcd&quot;, NULL, NULL);
-			break;
-		case MUXER_SVCD:
-			fmt = guess_format(&quot;svcd&quot;, NULL, NULL);
-			break;
-                case MUXER_MP4:
-                        fmt = guess_format(&quot;mp4&quot;, NULL, NULL);
-                        break;
-                case MUXER_PSP:
-                        fmt = guess_format(&quot;psp&quot;, NULL, NULL);
-                        break;                        
-		default:
-			fmt=NULL;
+	case MUXER_TS:
+		fmt=guess_format(&quot;mpegts&quot;, NULL, NULL);
+		break;
+	case MUXER_DVD:
+		fmt = guess_format(&quot;dvd&quot;, NULL, NULL);
+		break;
+	case MUXER_VCD:
+		fmt = guess_format(&quot;vcd&quot;, NULL, NULL);
+		break;
+	case MUXER_SVCD:
+		fmt = guess_format(&quot;svcd&quot;, NULL, NULL);
+		break;
+	case MUXER_MP4:
+		fmt = guess_format(&quot;mp4&quot;, NULL, NULL);
+		break;
+	case MUXER_PSP:
+		fmt = guess_format(&quot;psp&quot;, NULL, NULL);
+		break;
+	case MUXER_FLV:
+		fmt = guess_format(&quot;flv&quot;, NULL, NULL);
+		break;          
+	default:
+		fmt=NULL;
 	}
 	if (!fmt) 
 	{
@@ -156,6 +159,26 @@
 	c = video_st-&gt;codec;
 	switch(_type)
 	{
+				case MUXER_FLV:
+					 c-&gt;codec=new AVCodec;
+					 memset(c-&gt;codec,0,sizeof(AVCodec));
+					 if(fourCC::check(info-&gt;fcc,(uint8_t *)&quot;FLV1&quot;))
+					 {
+						 c-&gt;codec_id=CODEC_ID_FLV1;
+					 	 c-&gt;codec-&gt;name=ADM_strdup(&quot;FLV1&quot;);
+					 }else
+					 {
+						 if(fourCC::check(info-&gt;fcc,(uint8_t *)&quot;VP6F&quot;))
+						 			{
+							 		 c-&gt;codec_id=CODEC_ID_VP6F;
+					 				 c-&gt;codec-&gt;name=ADM_strdup(&quot;VP6F&quot;);
+						 			}
+						 else
+							 ADM_assert(0);
+					 
+					 }
+					 
+					 break;
                 case MUXER_MP4:
                 case MUXER_PSP:
                         strcpy(oc-&gt;title,&quot;Avidemux&quot;);
@@ -286,7 +309,7 @@
 			c-&gt;frame_rate_base = 1001;	
 			break;
 */
-                        if(_type==MUXER_MP4 || _type==MUXER_PSP)
+                        if(_type==MUXER_MP4 || _type==MUXER_PSP || _type==MUXER_FLV)
                         {
                                  c-&gt;time_base= fps24; //(AVRational){1001,24000};
                                 break;
@@ -298,7 +321,7 @@
 			break;
 		default:
                       {
-                            if(_type==MUXER_MP4 || _type==MUXER_PSP)
+                            if(_type==MUXER_MP4 || _type==MUXER_PSP || _type==MUXER_FLV)
                             {
                                     c-&gt;time_base=fpsfree;// (AVRational){1000,_fps1000};
                                     break;
@@ -381,6 +404,7 @@
 //----------------------
 	switch(_type)
 	{
+				case MUXER_FLV:
                 case MUXER_PSP:
                 case MUXER_MP4:
                         oc-&gt;mux_rate=10080*1000; // Needed ?
@@ -449,11 +473,18 @@
 
             timeInUs=(int64_t)sample2time_us(sample);
             /* Rescale to ?? */
-            f=timeInUs;
-            f/=1000000.; // In ms seconds 
-            f*=_audioFq;
-            
-            f=floor(f+0.4);
+            if(_type==MUXER_FLV) /* The FLV muxer expects packets dated in ms, there is something i did not get... WTF */
+            {
+            			f=timeInUs/1000;
+            			f=floor(f+0.4);
+            }
+            else
+            {
+            	f=timeInUs;
+            	f/=1000000.; // In ms seconds 
+            	f*=_audioFq;
+            	f=floor(f+0.4);
+            }
             pkt.dts=pkt.pts=(int)(f);
 
             //printf(&quot;F:%f Q:%u D=%u\n&quot;,f,pkt.pts,timeInUs-_lastAudioDts);
@@ -516,7 +547,7 @@
             av_init_packet(&amp;pkt);
 	    
         p=bitstream-&gt;ptsFrame+1;      // Pts           // Time p/fps1000=out/den  out=p*den*1000/fps1000
-	p=(p*1000*1000*1000);
+        p=(p*1000*1000*1000);
         p=p/_fps1000;                  // in us
 	
         d=bitstream-&gt;dtsFrame;		// dts
@@ -536,9 +567,14 @@
         d=bitstream-&gt;dtsFrame;
         RESCALE(d);
         
-	pkt.dts=(int64_t)floor(d);
-	pkt.pts=(int64_t)floor(p);
-        
+        if(_type==MUXER_FLV) /* The FLV muxer expects packets dated in ms, there is something i did not get... WTF */
+        {
+        			p=p*1000/_fps1000;
+        			d=d*1000/_fps1000;
+        }
+    	pkt.dts=(int64_t)floor(d);
+    	pkt.pts=(int64_t)floor(p);
+
        // printf(&quot;Lavformat : Pts :%u dts:%u&quot;,displayframe,frameno);
 	aprintf(&quot;Lavformat : Pts :%llu dts:%llu&quot;,pkt.pts,pkt.dts);
 	pkt.stream_index=0;
@@ -546,7 +582,7 @@
         pkt.data= bitstream-&gt;data;
         pkt.size= bitstream-&gt;len;
 	// Look if it is a gop start or seq start
-        if(_type==MUXER_MP4 || _type==MUXER_PSP)
+        if(_type==MUXER_MP4 || _type==MUXER_PSP || _type==MUXER_FLV)
         {
             if(bitstream-&gt;flags &amp; AVI_KEY_FRAME) 
                         pkt.flags |= PKT_FLAG_KEY;
@@ -609,11 +645,13 @@
 {
      extern  int        mpegps_init(void );
      extern  int        movenc_init(void );
+     extern  int        flvenc_init(void );
 };
 extern URLProtocol file_protocol ;
 uint8_t lavformat_init(void)
 {
                 movenc_init();
+                flvenc_init();
                 register_protocol(&amp;file_protocol);
 }
 extern &quot;C&quot;

Modified: branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavformat/ADM_lavformat.h
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavformat/ADM_lavformat.h	2007-08-25 22:48:09 UTC (rev 3561)
+++ branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavformat/ADM_lavformat.h	2007-08-26 09:13:11 UTC (rev 3562)
@@ -17,13 +17,14 @@
 typedef enum
 {
         MUXER_NONE=0,
-	MUXER_DVD,
-	MUXER_VCD,
-	MUXER_SVCD,
+        MUXER_DVD,
+		MUXER_VCD,
+		MUXER_SVCD,
         MUXER_TS,
         MUXER_MP4,
         MUXER_PSP,
-	MUXER_DUMMY
+        MUXER_FLV,
+        MUXER_DUMMY
 }ADM_MUXER_TYPE;
 
 

Modified: branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavformat/CMakeLists.txt
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavformat/CMakeLists.txt	2007-08-25 22:48:09 UTC (rev 3561)
+++ branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavformat/CMakeLists.txt	2007-08-26 09:13:11 UTC (rev 3562)
@@ -8,6 +8,7 @@
  mpeg.c utils.c avio.c ADM_lavformat.cpp 
 aviobuf.c cutils.c img2.c file.c mpegtsenc.c ADM_muxts.cpp movenc.c 
 avienc.c wav.c mov.c matroska.c isom.c isom.h riff.c
+flvenc.c
 )
 ADD_LIBRARY(${ADM_LIB} STATIC ${${ADM_LIB}_SRCS})
 ADD_ADM_LIB(${ADM_LIB} ADM_libraries)

Modified: branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavformat/Makefile.am
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavformat/Makefile.am	2007-08-25 22:48:09 UTC (rev 3561)
+++ branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavformat/Makefile.am	2007-08-26 09:13:11 UTC (rev 3562)
@@ -6,7 +6,7 @@
 
 libADM_lavformat_a_SOURCES =  mpeg.c utils.c avio.c ADM_lavformat.cpp \
 aviobuf.c cutils.c img2.c file.c mpegtsenc.c ADM_muxts.cpp movenc.c \
-avienc.c wav.c mov.c matroska.c isom.c isom.h riff.c
+avienc.c wav.c mov.c matroska.c isom.c isom.h riff.c flvenc.c
 
 
 EXTRA_DIST = ADM_lavformat.cpp  ADM_muxts.cpp  avformat.h  avio.h   \

Added: branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavformat/flvenc.c
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavformat/flvenc.c	2007-08-25 22:48:09 UTC (rev 3561)
+++ branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavformat/flvenc.c	2007-08-26 09:13:11 UTC (rev 3562)
@@ -0,0 +1,344 @@
+/*
+ * FLV muxer
+ * Copyright (c) 2003 The FFmpeg Project.
+ *
+ * This file is part of FFmpeg.
+ *
+ * FFmpeg is free software; you can redistribute it and/or
+ * modify it under the terms of the GNU Lesser General Public
+ * License as published by the Free Software Foundation; either
+ * version 2.1 of the License, or (at your option) any later version.
+ *
+ * FFmpeg is distributed in the hope that it will be useful,
+ * but WITHOUT ANY WARRANTY; without even the implied warranty of
+ * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ * Lesser General Public License for more details.
+ *
+ * You should have received a copy of the GNU Lesser General Public
+ * License along with FFmpeg; if not, write to the Free Software
+ * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA
+ */
+#include &quot;avformat.h&quot;
+#include &quot;flv.h&quot;
+#include &quot;riff.h&quot;
+
+#undef NDEBUG
+#include &lt;assert.h&gt;
+
+static const AVCodecTag flv_video_codec_ids[] = {
+    {CODEC_ID_FLV1,    FLV_CODECID_H263  },
+    {CODEC_ID_FLASHSV, FLV_CODECID_SCREEN},
+    {CODEC_ID_VP6F,    FLV_CODECID_VP6   },
+    {CODEC_ID_VP6,     FLV_CODECID_VP6   },
+    {CODEC_ID_NONE,    0}
+};
+
+static const AVCodecTag flv_audio_codec_ids[] = {
+    {CODEC_ID_MP3,       FLV_CODECID_MP3    &gt;&gt; FLV_AUDIO_CODECID_OFFSET},
+    {CODEC_ID_PCM_S8,    FLV_CODECID_PCM_BE &gt;&gt; FLV_AUDIO_CODECID_OFFSET},
+    {CODEC_ID_PCM_S16BE, FLV_CODECID_PCM_BE &gt;&gt; FLV_AUDIO_CODECID_OFFSET},
+    {CODEC_ID_PCM_S16LE, FLV_CODECID_PCM_LE &gt;&gt; FLV_AUDIO_CODECID_OFFSET},
+    {CODEC_ID_ADPCM_SWF, FLV_CODECID_ADPCM  &gt;&gt; FLV_AUDIO_CODECID_OFFSET},
+    {CODEC_ID_NONE,      0}
+};
+
+typedef struct FLVContext {
+    int hasAudio;
+    int hasVideo;
+    int reserved;
+    offset_t duration_offset;
+    offset_t filesize_offset;
+    int64_t duration;
+} FLVContext;
+
+static int get_audio_flags(AVCodecContext *enc){
+    int flags = (enc-&gt;bits_per_sample == 16) ? FLV_SAMPLESSIZE_16BIT : FLV_SAMPLESSIZE_8BIT;
+
+    switch (enc-&gt;sample_rate) {
+        case    44100:
+            flags |= FLV_SAMPLERATE_44100HZ;
+            break;
+        case    22050:
+            flags |= FLV_SAMPLERATE_22050HZ;
+            break;
+        case    11025:
+            flags |= FLV_SAMPLERATE_11025HZ;
+            break;
+        case     8000: //nellymoser only
+        case     5512: //not mp3
+            flags |= FLV_SAMPLERATE_SPECIAL;
+            break;
+        default:
+            av_log(enc, AV_LOG_ERROR, &quot;flv does not support that sample rate, choose from (44100, 22050, 11025).\n&quot;);
+            return -1;
+    }
+
+    if (enc-&gt;channels &gt; 1) {
+        flags |= FLV_STEREO;
+    }
+
+    switch(enc-&gt;codec_id){
+    case CODEC_ID_MP3:
+        flags |= FLV_CODECID_MP3    | FLV_SAMPLESSIZE_16BIT;
+        break;
+    case CODEC_ID_PCM_S8:
+        flags |= FLV_CODECID_PCM_BE | FLV_SAMPLESSIZE_8BIT;
+        break;
+    case CODEC_ID_PCM_S16BE:
+        flags |= FLV_CODECID_PCM_BE | FLV_SAMPLESSIZE_16BIT;
+        break;
+    case CODEC_ID_PCM_S16LE:
+        flags |= FLV_CODECID_PCM_LE | FLV_SAMPLESSIZE_16BIT;
+        break;
+    case CODEC_ID_ADPCM_SWF:
+        flags |= FLV_CODECID_ADPCM | FLV_SAMPLESSIZE_16BIT;
+        break;
+    case 0:
+        flags |= enc-&gt;codec_tag&lt;&lt;4;
+        break;
+    default:
+        av_log(enc, AV_LOG_ERROR, &quot;codec not compatible with flv\n&quot;);
+        return -1;
+    }
+
+    return flags;
+}
+
+static void put_amf_string(ByteIOContext *pb, const char *str)
+{
+    size_t len = strlen(str);
+    put_be16(pb, len);
+    put_buffer(pb, str, len);
+}
+
+static void put_amf_double(ByteIOContext *pb, double d)
+{
+    put_byte(pb, AMF_DATA_TYPE_NUMBER);
+    put_be64(pb, av_dbl2int(d));
+}
+
+static void put_amf_bool(ByteIOContext *pb, int b) {
+    put_byte(pb, AMF_DATA_TYPE_BOOL);
+    put_byte(pb, !!b);
+}
+
+static int flv_write_header(AVFormatContext *s)
+{
+    ByteIOContext *pb = &amp;s-&gt;pb;
+    FLVContext *flv = s-&gt;priv_data;
+    int i, width, height, samplerate, samplesize, channels, audiocodecid, videocodecid;
+    double framerate = 0.0;
+    int metadata_size_pos, data_size;
+
+    flv-&gt;hasAudio = 0;
+    flv-&gt;hasVideo = 0;
+
+    for(i=0; i&lt;s-&gt;nb_streams; i++){
+        AVCodecContext *enc = s-&gt;streams[i]-&gt;codec;
+        if (enc-&gt;codec_type == CODEC_TYPE_VIDEO) {
+            width = enc-&gt;width;
+            height = enc-&gt;height;
+            if (s-&gt;streams[i]-&gt;r_frame_rate.den &amp;&amp; s-&gt;streams[i]-&gt;r_frame_rate.num) {
+                framerate = av_q2d(s-&gt;streams[i]-&gt;r_frame_rate);
+            } else {
+                framerate = 1/av_q2d(s-&gt;streams[i]-&gt;codec-&gt;time_base);
+            }
+            flv-&gt;hasVideo=1;
+
+            videocodecid = enc-&gt;codec_tag;
+            if(videocodecid == 0) {
+                av_log(enc, AV_LOG_ERROR, &quot;video codec not compatible with flv\n&quot;);
+                return -1;
+            }
+        } else {
+            flv-&gt;hasAudio=1;
+            samplerate = enc-&gt;sample_rate;
+            channels = enc-&gt;channels;
+
+            audiocodecid = enc-&gt;codec_tag;
+            samplesize = (enc-&gt;codec_id == CODEC_ID_PCM_S8) ? 8 : 16;
+
+            if(get_audio_flags(enc)&lt;0)
+                return -1;
+        }
+        av_set_pts_info(s-&gt;streams[i], 24, 1, 1000); /* 24 bit pts in ms */
+    }
+    put_tag(pb,&quot;FLV&quot;);
+    put_byte(pb,1);
+    put_byte(pb,   FLV_HEADER_FLAG_HASAUDIO * flv-&gt;hasAudio
+                 + FLV_HEADER_FLAG_HASVIDEO * flv-&gt;hasVideo);
+    put_be32(pb,9);
+    put_be32(pb,0);
+
+    for(i=0; i&lt;s-&gt;nb_streams; i++){
+        if(s-&gt;streams[i]-&gt;codec-&gt;codec_tag == 5){
+            put_byte(pb,8); // message type
+            put_be24(pb,0); // include flags
+            put_be24(pb,0); // time stamp
+            put_be32(pb,0); // reserved
+            put_be32(pb,11); // size
+            flv-&gt;reserved=5;
+        }
+    }
+
+    /* write meta_tag */
+    put_byte(pb, 18);         // tag type META
+    metadata_size_pos= url_ftell(pb);
+    put_be24(pb, 0);          // size of data part (sum of all parts below)
+    put_be24(pb, 0);          // time stamp
+    put_be32(pb, 0);          // reserved
+
+    /* now data of data_size size */
+
+    /* first event name as a string */
+    put_byte(pb, AMF_DATA_TYPE_STRING);
+    put_amf_string(pb, &quot;onMetaData&quot;); // 12 bytes
+
+    /* mixed array (hash) with size and string/type/data tuples */
+    put_byte(pb, AMF_DATA_TYPE_MIXEDARRAY);
+    put_be32(pb, 5*flv-&gt;hasVideo + 4*flv-&gt;hasAudio + 2); // +2 for duration and file size
+
+    put_amf_string(pb, &quot;duration&quot;);
+    flv-&gt;duration_offset= url_ftell(pb);
+    put_amf_double(pb, 0); // delayed write
+
+    if(flv-&gt;hasVideo){
+        put_amf_string(pb, &quot;width&quot;);
+        put_amf_double(pb, width);
+
+        put_amf_string(pb, &quot;height&quot;);
+        put_amf_double(pb, height);
+
+        put_amf_string(pb, &quot;videodatarate&quot;);
+        put_amf_double(pb, s-&gt;bit_rate / 1024.0);
+
+        put_amf_string(pb, &quot;framerate&quot;);
+        put_amf_double(pb, framerate);
+
+        put_amf_string(pb, &quot;videocodecid&quot;);
+        put_amf_double(pb, videocodecid);
+    }
+
+    if(flv-&gt;hasAudio){
+        put_amf_string(pb, &quot;audiosamplerate&quot;);
+        put_amf_double(pb, samplerate);
+
+        put_amf_string(pb, &quot;audiosamplesize&quot;);
+        put_amf_double(pb, samplesize);
+
+        put_amf_string(pb, &quot;stereo&quot;);
+        put_amf_bool(pb, (channels == 2));
+
+        put_amf_string(pb, &quot;audiocodecid&quot;);
+        put_amf_double(pb, audiocodecid);
+    }
+
+    put_amf_string(pb, &quot;filesize&quot;);
+    flv-&gt;filesize_offset= url_ftell(pb);
+    put_amf_double(pb, 0); // delayed write
+
+    put_amf_string(pb, &quot;&quot;);
+    put_byte(pb, AMF_END_OF_OBJECT);
+
+    /* write total size of tag */
+    data_size= url_ftell(pb) - metadata_size_pos - 10;
+    url_fseek(pb, metadata_size_pos, SEEK_SET);
+    put_be24(pb, data_size);
+    url_fseek(pb, data_size + 10 - 3, SEEK_CUR);
+    put_be32(pb, data_size + 11);
+
+    return 0;
+}
+
+static int flv_write_trailer(AVFormatContext *s)
+{
+    int64_t file_size;
+
+    ByteIOContext *pb = &amp;s-&gt;pb;
+    FLVContext *flv = s-&gt;priv_data;
+
+    file_size = url_ftell(pb);
+
+    /* update informations */
+    url_fseek(pb, flv-&gt;duration_offset, SEEK_SET);
+    put_amf_double(pb, flv-&gt;duration / (double)1000);
+    url_fseek(pb, flv-&gt;filesize_offset, SEEK_SET);
+    put_amf_double(pb, file_size);
+
+    url_fseek(pb, file_size, SEEK_SET);
+    return 0;
+}
+
+static int flv_write_packet(AVFormatContext *s, AVPacket *pkt)
+{
+    ByteIOContext *pb = &amp;s-&gt;pb;
+    AVCodecContext *enc = s-&gt;streams[pkt-&gt;stream_index]-&gt;codec;
+    FLVContext *flv = s-&gt;priv_data;
+    int size= pkt-&gt;size;
+    int flags, flags_size;
+
+//    av_log(s, AV_LOG_DEBUG, &quot;type:%d pts: %&quot;PRId64&quot; size:%d\n&quot;, enc-&gt;codec_type, timestamp, size);
+
+    if(enc-&gt;codec_id == CODEC_ID_VP6 || enc-&gt;codec_id == CODEC_ID_VP6F)
+        flags_size= 2;
+    else
+        flags_size= 1;
+
+    if (enc-&gt;codec_type == CODEC_TYPE_VIDEO) {
+        put_byte(pb, FLV_TAG_TYPE_VIDEO);
+
+        flags = enc-&gt;codec_tag;
+        if(flags == 0) {
+            av_log(enc, AV_LOG_ERROR, &quot;video codec %X not compatible with flv\n&quot;,enc-&gt;codec_id);
+            return -1;
+        }
+
+        flags |= pkt-&gt;flags &amp; PKT_FLAG_KEY ? FLV_FRAME_KEY : FLV_FRAME_INTER;
+    } else {
+        assert(enc-&gt;codec_type == CODEC_TYPE_AUDIO);
+        flags = get_audio_flags(enc);
+
+        assert(size);
+
+        put_byte(pb, FLV_TAG_TYPE_AUDIO);
+    }
+
+    put_be24(pb,size + flags_size);
+    put_be24(pb,pkt-&gt;pts);
+    put_be32(pb,flv-&gt;reserved);
+    put_byte(pb,flags);
+    if (enc-&gt;codec_id == CODEC_ID_VP6)
+        put_byte(pb,0);
+    if (enc-&gt;codec_id == CODEC_ID_VP6F)
+        put_byte(pb, enc-&gt;extradata_size ? enc-&gt;extradata[0] : 0);
+    put_buffer(pb, pkt-&gt;data, size);
+    put_be32(pb,size+flags_size+11); // previous tag size
+    flv-&gt;duration = pkt-&gt;pts + pkt-&gt;duration;
+
+    put_flush_packet(pb);
+    return 0;
+}
+
+AVOutputFormat flv_muxer = {
+    &quot;flv&quot;,
+    &quot;flv format&quot;,
+    &quot;video/x-flv&quot;,
+    &quot;flv&quot;,
+    sizeof(FLVContext),
+// MEANX #ifdef CONFIG_LIBMP3LAME
+#ifdef HAVE_LIBMP3LAME    
+    CODEC_ID_MP3,
+#else // CONFIG_LIBMP3LAME
+    CODEC_ID_NONE,
+#endif // CONFIG_LIBMP3LAME
+    CODEC_ID_FLV1,
+    flv_write_header,
+    flv_write_packet,
+    flv_write_trailer,
+    .codec_tag= (const AVCodecTag*[]){flv_video_codec_ids, flv_audio_codec_ids, 0},
+};
+int flvenc_init(void)
+{
+    av_register_output_format(&amp;flv_muxer);
+    return 0;
+}

Modified: branches/avidemux_2.4_branch/avidemux/ADM_outputs/CMakeLists.txt
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_outputs/CMakeLists.txt	2007-08-25 22:48:09 UTC (rev 3561)
+++ branches/avidemux_2.4_branch/avidemux/ADM_outputs/CMakeLists.txt	2007-08-26 09:13:11 UTC (rev 3562)
@@ -3,4 +3,5 @@
 subdirs (PREORDER oplug_mpeg)
 subdirs (PREORDER oplug_mpegFF)
 subdirs (PREORDER oplug_ogm)
+subdirs (PREORDER oplug_flv)
 

Modified: branches/avidemux_2.4_branch/avidemux/ADM_outputs/Makefile.am
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_outputs/Makefile.am	2007-08-25 22:48:09 UTC (rev 3561)
+++ branches/avidemux_2.4_branch/avidemux/ADM_outputs/Makefile.am	2007-08-26 09:13:11 UTC (rev 3562)
@@ -1 +1 @@
-SUBDIRS= oplug_avi  oplug_mp4  oplug_mpeg  oplug_mpegFF  oplug_ogm
+SUBDIRS= oplug_avi  oplug_mp4  oplug_mpeg  oplug_mpegFF  oplug_ogm oplug_flv

Modified: branches/avidemux_2.4_branch/avidemux/ADM_script/ADM_container.h
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_script/ADM_container.h	2007-08-25 22:48:09 UTC (rev 3561)
+++ branches/avidemux_2.4_branch/avidemux/ADM_script/ADM_container.h	2007-08-26 09:13:11 UTC (rev 3562)
@@ -27,6 +27,7 @@
   MK_CONT(AVI_UNP),
   MK_CONT(MP4),
   MK_CONT(PSP),
+  MK_CONT(FLV),
   MK_CONT(FMT_DUMMY)  
 };
 #define NB_CONT (sizeof(container)/sizeof(ADM_CONTAINER))

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp	2007-08-25 22:48:09 UTC (rev 3561)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_main2.cpp	2007-08-26 09:13:11 UTC (rev 3562)
@@ -36,11 +36,11 @@
   GtkWidget *menuitem1;
   GtkWidget *menuitem1_menu;
   GtkWidget *open_video1;
-  GtkWidget *image8423;
+  GtkWidget *image8448;
   GtkWidget *append_video1;
-  GtkWidget *image8424;
+  GtkWidget *image8449;
   GtkWidget *save_stuff;
-  GtkWidget *image8425;
+  GtkWidget *image8450;
   GtkWidget *save_stuff_menu;
   GtkWidget *save_as_avi1;
   GtkWidget *separator1;
@@ -50,41 +50,41 @@
   GtkWidget *close1;
   GtkWidget *separator3;
   GtkWidget *save_project1;
-  GtkWidget *image8426;
+  GtkWidget *image8451;
   GtkWidget *save_project_as1;
-  GtkWidget *image8427;
+  GtkWidget *image8452;
   GtkWidget *run_script1;
-  GtkWidget *image8428;
+  GtkWidget *image8453;
   GtkWidget *add_to_joblist1;
   GtkWidget *joblist1;
   GtkWidget *separator16;
   GtkWidget *connect_to_avsproxy1;
   GtkWidget *separator18;
   GtkWidget *video_informations1;
-  GtkWidget *image8429;
+  GtkWidget *image8454;
   GtkWidget *avi_muxer_options1;
   GtkWidget *separator4;
   GtkWidget *quit1;
-  GtkWidget *image8430;
+  GtkWidget *image8455;
   GtkWidget *menuitem2;
   GtkWidget *menuitem2_menu;
   GtkWidget *reset_edits1;
-  GtkWidget *image8431;
+  GtkWidget *image8456;
   GtkWidget *separator5;
   GtkWidget *cut1;
-  GtkWidget *image8432;
+  GtkWidget *image8457;
   GtkWidget *copy1;
-  GtkWidget *image8433;
+  GtkWidget *image8458;
   GtkWidget *paste1;
-  GtkWidget *image8434;
+  GtkWidget *image8459;
   GtkWidget *delete1;
-  GtkWidget *image8435;
+  GtkWidget *image8460;
   GtkWidget *separator6;
   GtkWidget *set_marker_a1;
   GtkWidget *set_marker_b1;
   GtkWidget *separator7;
   GtkWidget *preferences1;
-  GtkWidget *image8436;
+  GtkWidget *image8461;
   GtkWidget *view1;
   GtkWidget *view1_menu;
   GtkWidget *toolbar1;
@@ -112,13 +112,13 @@
   GtkWidget *build_vbr_time_map1;
   GtkWidget *separator11;
   GtkWidget *save_audio1;
-  GtkWidget *image8437;
+  GtkWidget *image8462;
   GtkWidget *audio_encoder1;
   GtkWidget *filters2;
   GtkWidget *tools1;
   GtkWidget *tools1_menu;
   GtkWidget *calculator1;
-  GtkWidget *image8438;
+  GtkWidget *image8463;
   GtkWidget *separator12;
   GtkWidget *rebuild_frames;
   GtkWidget *check_frames;
@@ -138,38 +138,39 @@
   GtkWidget *dvd1;
   GtkWidget *psp1;
   GtkWidget *psp__h264_1;
+  GtkWidget *flv1;
   GtkWidget *go1;
   GtkWidget *go1_menu;
   GtkWidget *play_video1;
-  GtkWidget *image8439;
+  GtkWidget *image8464;
   GtkWidget *previous_frame1;
-  GtkWidget *image8440;
+  GtkWidget *image8465;
   GtkWidget *next_frame1;
-  GtkWidget *image8441;
+  GtkWidget *image8466;
   GtkWidget *previous_intra_frame1;
-  GtkWidget *image8442;
+  GtkWidget *image8467;
   GtkWidget *next_intra_frame1;
-  GtkWidget *image8443;
+  GtkWidget *image8468;
   GtkWidget *search_previous_black_frame1;
   GtkWidget *search_next_black_frame1;
   GtkWidget *first_frame1;
-  GtkWidget *image8444;
+  GtkWidget *image8469;
   GtkWidget *last_frame1;
-  GtkWidget *image8445;
+  GtkWidget *image8470;
   GtkWidget *separator14;
   GtkWidget *go_to_marker_a1;
   GtkWidget *go_to_marker_b1;
   GtkWidget *separator15;
   GtkWidget *jum_to_frame1;
-  GtkWidget *image8446;
+  GtkWidget *image8471;
   GtkWidget *jump_to_time1;
-  GtkWidget *image8447;
+  GtkWidget *image8472;
   GtkWidget *custom1;
   GtkWidget *help2;
   GtkWidget *help2_menu;
   GtkWidget *show_builtin_support1;
   GtkWidget *about1;
-  GtkWidget *image8448;
+  GtkWidget *image8473;
   GtkWidget *toolbar2;
   GtkIconSize tmp_toolbar_icon_size;
   GtkWidget *menutoolbuttonOpen;
@@ -300,9 +301,9 @@
                               GDK_O, (GdkModifierType)( GDK_CONTROL_MASK),
                               GTK_ACCEL_VISIBLE);
 
-  image8423 = gtk_image_new_from_stock (&quot;gtk-open&quot;, GTK_ICON_SIZE_MENU);
-  gtk_widget_show (image8423);
-  gtk_image_menu_item_set_image (GTK_IMAGE_MENU_ITEM (open_video1), image8423);
+  image8448 = gtk_image_new_from_stock (&quot;gtk-open&quot;, GTK_ICON_SIZE_MENU);
+  gtk_widget_show (image8448);
+  gtk_image_menu_item_set_image (GTK_IMAGE_MENU_ITEM (open_video1), image8448);
 
   append_video1 = gtk_image_menu_item_new_with_mnemonic (_(&quot;_Append...&quot;));
   gtk_widget_show (append_video1);
@@ -311,17 +312,17 @@
                               GDK_A, (GdkModifierType)( GDK_CONTROL_MASK | GDK_MOD1_MASK),
                               GTK_ACCEL_VISIBLE);
 
-  image8424 = gtk_image_new_from_stock (&quot;gtk-add&quot;, GTK_ICON_SIZE_MENU);
-  gtk_widget_show (image8424);
-  gtk_image_menu_item_set_image (GTK_IMAGE_MENU_ITEM (append_video1), image8424);
+  image8449 = gtk_image_new_from_stock (&quot;gtk-add&quot;, GTK_ICON_SIZE_MENU);
+  gtk_widget_show (image8449);
+  gtk_image_menu_item_set_image (GTK_IMAGE_MENU_ITEM (append_video1), image8449);
 
   save_stuff = gtk_image_menu_item_new_with_mnemonic (_(&quot;_Save&quot;));
   gtk_widget_show (save_stuff);
   gtk_container_add (GTK_CONTAINER (menuitem1_menu), save_stuff);
 
-  image8425 = gtk_image_new_from_stock (&quot;gtk-save&quot;, GTK_ICON_SIZE_MENU);
-  gtk_widget_show (image8425);
-  gtk_image_menu_item_set_image (GTK_IMAGE_MENU_ITEM (save_stuff), image8425);
+  image8450 = gtk_image_new_from_stock (&quot;gtk-save&quot;, GTK_ICON_SIZE_MENU);
+  gtk_widget_show (image8450);
+  gtk_image_menu_item_set_image (GTK_IMAGE_MENU_ITEM (save_stuff), image8450);
 
   save_stuff_menu = gtk_menu_new ();
   gtk_menu_item_set_submenu (GTK_MENU_ITEM (save_stuff), save_stuff_menu);
@@ -363,25 +364,25 @@
   gtk_widget_show (save_project1);
   gtk_container_add (GTK_CONTAINER (menuitem1_menu), save_project1);
 
-  image8426 = gtk_image_new_from_stock (&quot;gtk-save&quot;, GTK_ICON_SIZE_MENU);
-  gtk_widget_show (image8426);
-  gtk_image_menu_item_set_image (GTK_IMAGE_MENU_ITEM (save_project1), image8426);
+  image8451 = gtk_image_new_from_stock (&quot;gtk-save&quot;, GTK_ICON_SIZE_MENU);
+  gtk_widget_show (image8451);
+  gtk_image_menu_item_set_image (GTK_IMAGE_MENU_ITEM (save_project1), image8451);
 
   save_project_as1 = gtk_image_menu_item_new_with_mnemonic (_(&quot;Save P_roject As...&quot;));
   gtk_widget_show (save_project_as1);
   gtk_container_add (GTK_CONTAINER (menuitem1_menu), save_project_as1);
 
-  image8427 = gtk_image_new_from_stock (&quot;gtk-save-as&quot;, GTK_ICON_SIZE_MENU);
-  gtk_widget_show (image8427);
-  gtk_image_menu_item_set_image (GTK_IMAGE_MENU_ITEM (save_project_as1), image8427);
+  image8452 = gtk_image_new_from_stock (&quot;gtk-save-as&quot;, GTK_ICON_SIZE_MENU);
+  gtk_widget_show (image8452);
+  gtk_image_menu_item_set_image (GTK_IMAGE_MENU_ITEM (save_project_as1), image8452);
 
   run_script1 = gtk_image_menu_item_new_with_mnemonic (_(&quot;_Load/Run Project...&quot;));
   gtk_widget_show (run_script1);
   gtk_container_add (GTK_CONTAINER (menuitem1_menu), run_script1);
 
-  image8428 = gtk_image_new_from_stock (&quot;gtk-execute&quot;, GTK_ICON_SIZE_MENU);
-  gtk_widget_show (image8428);
-  gtk_image_menu_item_set_image (GTK_IMAGE_MENU_ITEM (run_script1), image8428);
+  image8453 = gtk_image_new_from_stock (&quot;gtk-execute&quot;, GTK_ICON_SIZE_MENU);
+  gtk_widget_show (image8453);
+  gtk_image_menu_item_set_image (GTK_IMAGE_MENU_ITEM (run_script1), image8453);
 
   add_to_joblist1 = gtk_menu_item_new_with_mnemonic (_(&quot;A_dd to Joblist...&quot;));
   gtk_widget_show (add_to_joblist1);
@@ -415,9 +416,9 @@
                               GDK_Return, (GdkModifierType)( GDK_MOD1_MASK),
                               GTK_ACCEL_VISIBLE);
 
-  image8429 = gtk_image_new_from_stock (&quot;gtk-properties&quot;, GTK_ICON_SIZE_MENU);
-  gtk_widget_show (image8429);
-  gtk_image_menu_item_set_image (GTK_IMAGE_MENU_ITEM (video_informations1), image8429);
+  image8454 = gtk_image_new_from_stock (&quot;gtk-properties&quot;, GTK_ICON_SIZE_MENU);
+  gtk_widget_show (image8454);
+  gtk_image_menu_item_set_image (GTK_IMAGE_MENU_ITEM (video_informations1), image8454);
 
   avi_muxer_options1 = gtk_menu_item_new_with_mnemonic (_(&quot;AVI _Muxer Options&quot;));
   gtk_widget_show (avi_muxer_options1);
@@ -435,9 +436,9 @@
                               GDK_Q, (GdkModifierType)( GDK_CONTROL_MASK),
                               GTK_ACCEL_VISIBLE);
 
-  image8430 = gtk_image_new_from_stock (&quot;gtk-quit&quot;, GTK_ICON_SIZE_MENU);
-  gtk_widget_show (image8430);
-  gtk_image_menu_item_set_image (GTK_IMAGE_MENU_ITEM (quit1), image8430);
+  image8455 = gtk_image_new_from_stock (&quot;gtk-quit&quot;, GTK_ICON_SIZE_MENU);
+  gtk_widget_show (image8455);
+  gtk_image_menu_item_set_image (GTK_IMAGE_MENU_ITEM (quit1), image8455);
 
   menuitem2 = gtk_menu_item_new_with_mnemonic (_(&quot;_Edit&quot;));
   gtk_widget_show (menuitem2);
@@ -450,9 +451,9 @@
   gtk_widget_show (reset_edits1);
   gtk_container_add (GTK_CONTAINER (menuitem2_menu), reset_edits1);
 
-  image8431 = gtk_image_new_from_stock (&quot;gtk-undo&quot;, GTK_ICON_SIZE_MENU);
-  gtk_widget_show (image8431);
-  gtk_image_menu_item_set_image (GTK_IMAGE_MENU_ITEM (reset_edits1), image8431);
+  image8456 = gtk_image_new_from_stock (&quot;gtk-undo&quot;, GTK_ICON_SIZE_MENU);
+  gtk_widget_show (image8456);
+  gtk_image_menu_item_set_image (GTK_IMAGE_MENU_ITEM (reset_edits1), image8456);
 
   separator5 = gtk_separator_menu_item_new ();
   gtk_widget_show (separator5);
@@ -466,9 +467,9 @@
                               GDK_X, (GdkModifierType)( GDK_CONTROL_MASK),
                               GTK_ACCEL_VISIBLE);
 
-  image8432 = gtk_image_new_from_stock (&quot;gtk-cut&quot;, GTK_ICON_SIZE_MENU);
-  gtk_widget_show (image8432);
-  gtk_image_menu_item_set_image (GTK_IMAGE_MENU_ITEM (cut1), image8432);
+  image8457 = gtk_image_new_from_stock (&quot;gtk-cut&quot;, GTK_ICON_SIZE_MENU);
+  gtk_widget_show (image8457);
+  gtk_image_menu_item_set_image (GTK_IMAGE_MENU_ITEM (cut1), image8457);
 
   copy1 = gtk_image_menu_item_new_with_mnemonic (_(&quot;_Copy&quot;));
   gtk_widget_show (copy1);
@@ -477,9 +478,9 @@
                               GDK_C, (GdkModifierType)( GDK_CONTROL_MASK),
                               GTK_ACCEL_VISIBLE);
 
-  image8433 = gtk_image_new_from_stock (&quot;gtk-copy&quot;, GTK_ICON_SIZE_MENU);
-  gtk_widget_show (image8433);
-  gtk_image_menu_item_set_image (GTK_IMAGE_MENU_ITEM (copy1), image8433);
+  image8458 = gtk_image_new_from_stock (&quot;gtk-copy&quot;, GTK_ICON_SIZE_MENU);
+  gtk_widget_show (image8458);
+  gtk_image_menu_item_set_image (GTK_IMAGE_MENU_ITEM (copy1), image8458);
 
   paste1 = gtk_image_menu_item_new_with_mnemonic (_(&quot;_Paste&quot;));
   gtk_widget_show (paste1);
@@ -488,9 +489,9 @@
                               GDK_V, (GdkModifierType)( GDK_CONTROL_MASK),
                               GTK_ACCEL_VISIBLE);
 
-  image8434 = gtk_image_new_from_stock (&quot;gtk-paste&quot;, GTK_ICON_SIZE_MENU);
-  gtk_widget_show (image8434);
-  gtk_image_menu_item_set_image (GTK_IMAGE_MENU_ITEM (paste1), image8434);
+  image8459 = gtk_image_new_from_stock (&quot;gtk-paste&quot;, GTK_ICON_SIZE_MENU);
+  gtk_widget_show (image8459);
+  gtk_image_menu_item_set_image (GTK_IMAGE_MENU_ITEM (paste1), image8459);
 
   delete1 = gtk_image_menu_item_new_with_mnemonic (_(&quot;_Delete&quot;));
   gtk_widget_show (delete1);
@@ -499,9 +500,9 @@
                               GDK_Delete, (GdkModifierType)( 0 ),
                               GTK_ACCEL_VISIBLE);
 
-  image8435 = gtk_image_new_from_stock (&quot;gtk-remove&quot;, GTK_ICON_SIZE_MENU);
-  gtk_widget_show (image8435);
-  gtk_image_menu_item_set_image (GTK_IMAGE_MENU_ITEM (delete1), image8435);
+  image8460 = gtk_image_new_from_stock (&quot;gtk-remove&quot;, GTK_ICON_SIZE_MENU);
+  gtk_widget_show (image8460);
+  gtk_image_menu_item_set_image (GTK_IMAGE_MENU_ITEM (delete1), image8460);
 
   separator6 = gtk_separator_menu_item_new ();
   gtk_widget_show (separator6);
@@ -531,9 +532,9 @@
   gtk_widget_show (preferences1);
   gtk_container_add (GTK_CONTAINER (menuitem2_menu), preferences1);
 
-  image8436 = gtk_image_new_from_stock (&quot;gtk-preferences&quot;, GTK_ICON_SIZE_MENU);
-  gtk_widget_show (image8436);
-  gtk_image_menu_item_set_image (GTK_IMAGE_MENU_ITEM (preferences1), image8436);
+  image8461 = gtk_image_new_from_stock (&quot;gtk-preferences&quot;, GTK_ICON_SIZE_MENU);
+  gtk_widget_show (image8461);
+  gtk_image_menu_item_set_image (GTK_IMAGE_MENU_ITEM (preferences1), image8461);
 
   view1 = gtk_menu_item_new_with_mnemonic (_(&quot;_View&quot;));
   gtk_widget_show (view1);
@@ -680,9 +681,9 @@
                               GDK_S, (GdkModifierType)( GDK_CONTROL_MASK | GDK_MOD1_MASK),
                               GTK_ACCEL_VISIBLE);
 
-  image8437 = gtk_image_new_from_stock (&quot;gtk-save-as&quot;, GTK_ICON_SIZE_MENU);
-  gtk_widget_show (image8437);
-  gtk_image_menu_item_set_image (GTK_IMAGE_MENU_ITEM (save_audio1), image8437);
+  image8462 = gtk_image_new_from_stock (&quot;gtk-save-as&quot;, GTK_ICON_SIZE_MENU);
+  gtk_widget_show (image8462);
+  gtk_image_menu_item_set_image (GTK_IMAGE_MENU_ITEM (save_audio1), image8462);
 
   audio_encoder1 = gtk_menu_item_new_with_mnemonic (_(&quot;_Encoder&quot;));
   gtk_widget_show (audio_encoder1);
@@ -709,9 +710,9 @@
                               GDK_F7, (GdkModifierType)( 0 ),
                               GTK_ACCEL_VISIBLE);
 
-  image8438 = create_pixmap (mainWindow, &quot;gnome-calculator_small.xpm&quot;);
-  gtk_widget_show (image8438);
-  gtk_image_menu_item_set_image (GTK_IMAGE_MENU_ITEM (calculator1), image8438);
+  image8463 = create_pixmap (mainWindow, &quot;gnome-calculator_small.xpm&quot;);
+  gtk_widget_show (image8463);
+  gtk_image_menu_item_set_image (GTK_IMAGE_MENU_ITEM (calculator1), image8463);
 
   separator12 = gtk_separator_menu_item_new ();
   gtk_widget_show (separator12);
@@ -791,6 +792,10 @@
   gtk_widget_show (psp__h264_1);
   gtk_container_add (GTK_CONTAINER (help1_menu), psp__h264_1);
 
+  flv1 = gtk_menu_item_new_with_mnemonic (_(&quot;F_LV&quot;));
+  gtk_widget_show (flv1);
+  gtk_container_add (GTK_CONTAINER (help1_menu), flv1);
+
   go1 = gtk_menu_item_new_with_mnemonic (_(&quot;_Go&quot;));
   gtk_widget_show (go1);
   gtk_container_add (GTK_CONTAINER (menuBar), go1);
@@ -805,9 +810,9 @@
                               GDK_P, (GdkModifierType)( 0 ),
                               GTK_ACCEL_VISIBLE);
 
-  image8439 = gtk_image_new_from_stock (&quot;gtk-media-play&quot;, GTK_ICON_SIZE_MENU);
-  gtk_widget_show (image8439);
-  gtk_image_menu_item_set_image (GTK_IMAGE_MENU_ITEM (play_video1), image8439);
+  image8464 = gtk_image_new_from_stock (&quot;gtk-media-play&quot;, GTK_ICON_SIZE_MENU);
+  gtk_widget_show (image8464);
+  gtk_image_menu_item_set_image (GTK_IMAGE_MENU_ITEM (play_video1), image8464);
 
   previous_frame1 = gtk_image_menu_item_new_with_mnemonic (_(&quot;P_revious Frame&quot;));
   gtk_widget_show (previous_frame1);
@@ -816,9 +821,9 @@
                               GDK_KP_4, (GdkModifierType)( 0 ),
                               GTK_ACCEL_VISIBLE);
 
-  image8440 = gtk_image_new_from_stock (&quot;gtk-media-previous&quot;, GTK_ICON_SIZE_MENU);
-  gtk_widget_show (image8440);
-  gtk_image_menu_item_set_image (GTK_IMAGE_MENU_ITEM (previous_frame1), image8440);
+  image8465 = gtk_image_new_from_stock (&quot;gtk-media-previous&quot;, GTK_ICON_SIZE_MENU);
+  gtk_widget_show (image8465);
+  gtk_image_menu_item_set_image (GTK_IMAGE_MENU_ITEM (previous_frame1), image8465);
 
   next_frame1 = gtk_image_menu_item_new_with_mnemonic (_(&quot;_Next Frame&quot;));
   gtk_widget_show (next_frame1);
@@ -827,9 +832,9 @@
                               GDK_KP_6, (GdkModifierType)( 0 ),
                               GTK_ACCEL_VISIBLE);
 
-  image8441 = gtk_image_new_from_stock (&quot;gtk-media-next&quot;, GTK_ICON_SIZE_MENU);
-  gtk_widget_show (image8441);
-  gtk_image_menu_item_set_image (GTK_IMAGE_MENU_ITEM (next_frame1), image8441);
+  image8466 = gtk_image_new_from_stock (&quot;gtk-media-next&quot;, GTK_ICON_SIZE_MENU);
+  gtk_widget_show (image8466);
+  gtk_image_menu_item_set_image (GTK_IMAGE_MENU_ITEM (next_frame1), image8466);
 
   previous_intra_frame1 = gtk_image_menu_item_new_with_mnemonic (_(&quot;Pr_evious Intra Frame&quot;));
   gtk_widget_show (previous_intra_frame1);
@@ -838,9 +843,9 @@
                               GDK_KP_2, (GdkModifierType)( 0 ),
                               GTK_ACCEL_VISIBLE);
 
-  image8442 = gtk_image_new_from_stock (&quot;gtk-media-rewind&quot;, GTK_ICON_SIZE_MENU);
-  gtk_widget_show (image8442);
-  gtk_image_menu_item_set_image (GTK_IMAGE_MENU_ITEM (previous_intra_frame1), image8442);
+  image8467 = gtk_image_new_from_stock (&quot;gtk-media-rewind&quot;, GTK_ICON_SIZE_MENU);
+  gtk_widget_show (image8467);
+  gtk_image_menu_item_set_image (GTK_IMAGE_MENU_ITEM (previous_intra_frame1), image8467);
 
   next_intra_frame1 = gtk_image_menu_item_new_with_mnemonic (_(&quot;Next _Intra Frame&quot;));
   gtk_widget_show (next_intra_frame1);
@@ -849,9 +854,9 @@
                               GDK_KP_8, (GdkModifierType)( 0 ),
                               GTK_ACCEL_VISIBLE);
 
-  image8443 = gtk_image_new_from_stock (&quot;gtk-media-forward&quot;, GTK_ICON_SIZE_MENU);
-  gtk_widget_show (image8443);
-  gtk_image_menu_item_set_image (GTK_IMAGE_MENU_ITEM (next_intra_frame1), image8443);
+  image8468 = gtk_image_new_from_stock (&quot;gtk-media-forward&quot;, GTK_ICON_SIZE_MENU);
+  gtk_widget_show (image8468);
+  gtk_image_menu_item_set_image (GTK_IMAGE_MENU_ITEM (next_intra_frame1), image8468);
 
   search_previous_black_frame1 = gtk_menu_item_new_with_mnemonic (_(&quot;Previou_s Black Frame&quot;));
   gtk_widget_show (search_previous_black_frame1);
@@ -868,9 +873,9 @@
                               GDK_Home, (GdkModifierType)( 0 ),
                               GTK_ACCEL_VISIBLE);
 
-  image8444 = gtk_image_new_from_stock (&quot;gtk-goto-first&quot;, GTK_ICON_SIZE_MENU);
-  gtk_widget_show (image8444);
-  gtk_image_menu_item_set_image (GTK_IMAGE_MENU_ITEM (first_frame1), image8444);
+  image8469 = gtk_image_new_from_stock (&quot;gtk-goto-first&quot;, GTK_ICON_SIZE_MENU);
+  gtk_widget_show (image8469);
+  gtk_image_menu_item_set_image (GTK_IMAGE_MENU_ITEM (first_frame1), image8469);
 
   last_frame1 = gtk_image_menu_item_new_with_mnemonic (_(&quot;_Last Frame&quot;));
   gtk_widget_show (last_frame1);
@@ -879,9 +884,9 @@
                               GDK_End, (GdkModifierType)( 0 ),
                               GTK_ACCEL_VISIBLE);
 
-  image8445 = gtk_image_new_from_stock (&quot;gtk-goto-last&quot;, GTK_ICON_SIZE_MENU);
-  gtk_widget_show (image8445);
-  gtk_image_menu_item_set_image (GTK_IMAGE_MENU_ITEM (last_frame1), image8445);
+  image8470 = gtk_image_new_from_stock (&quot;gtk-goto-last&quot;, GTK_ICON_SIZE_MENU);
+  gtk_widget_show (image8470);
+  gtk_image_menu_item_set_image (GTK_IMAGE_MENU_ITEM (last_frame1), image8470);
 
   separator14 = gtk_separator_menu_item_new ();
   gtk_widget_show (separator14);
@@ -914,9 +919,9 @@
                               GDK_F, (GdkModifierType)( GDK_CONTROL_MASK),
                               GTK_ACCEL_VISIBLE);
 
-  image8446 = gtk_image_new_from_stock (&quot;gtk-jump-to&quot;, GTK_ICON_SIZE_MENU);
-  gtk_widget_show (image8446);
-  gtk_image_menu_item_set_image (GTK_IMAGE_MENU_ITEM (jum_to_frame1), image8446);
+  image8471 = gtk_image_new_from_stock (&quot;gtk-jump-to&quot;, GTK_ICON_SIZE_MENU);
+  gtk_widget_show (image8471);
+  gtk_image_menu_item_set_image (GTK_IMAGE_MENU_ITEM (jum_to_frame1), image8471);
 
   jump_to_time1 = gtk_image_menu_item_new_with_mnemonic (_(&quot;Go to _Time...&quot;));
   gtk_widget_show (jump_to_time1);
@@ -925,9 +930,9 @@
                               GDK_T, (GdkModifierType)( GDK_CONTROL_MASK),
                               GTK_ACCEL_VISIBLE);
 
-  image8447 = gtk_image_new_from_stock (&quot;gtk-jump-to&quot;, GTK_ICON_SIZE_MENU);
-  gtk_widget_show (image8447);
-  gtk_image_menu_item_set_image (GTK_IMAGE_MENU_ITEM (jump_to_time1), image8447);
+  image8472 = gtk_image_new_from_stock (&quot;gtk-jump-to&quot;, GTK_ICON_SIZE_MENU);
+  gtk_widget_show (image8472);
+  gtk_image_menu_item_set_image (GTK_IMAGE_MENU_ITEM (jump_to_time1), image8472);
 
   custom1 = gtk_menu_item_new_with_mnemonic (_(&quot;_Custom&quot;));
   gtk_widget_show (custom1);
@@ -948,9 +953,9 @@
   gtk_widget_show (about1);
   gtk_container_add (GTK_CONTAINER (help2_menu), about1);
 
-  image8448 = gtk_image_new_from_stock (&quot;gtk-about&quot;, GTK_ICON_SIZE_MENU);
-  gtk_widget_show (image8448);
-  gtk_image_menu_item_set_image (GTK_IMAGE_MENU_ITEM (about1), image8448);
+  image8473 = gtk_image_new_from_stock (&quot;gtk-about&quot;, GTK_ICON_SIZE_MENU);
+  gtk_widget_show (image8473);
+  gtk_image_menu_item_set_image (GTK_IMAGE_MENU_ITEM (about1), image8473);
 
   toolbar2 = gtk_toolbar_new ();
   gtk_widget_show (toolbar2);
@@ -1472,11 +1477,11 @@
   GLADE_HOOKUP_OBJECT (mainWindow, menuitem1, &quot;menuitem1&quot;);
   GLADE_HOOKUP_OBJECT (mainWindow, menuitem1_menu, &quot;menuitem1_menu&quot;);
   GLADE_HOOKUP_OBJECT (mainWindow, open_video1, &quot;open_video1&quot;);
-  GLADE_HOOKUP_OBJECT (mainWindow, image8423, &quot;image8423&quot;);
+  GLADE_HOOKUP_OBJECT (mainWindow, image8448, &quot;image8448&quot;);
   GLADE_HOOKUP_OBJECT (mainWindow, append_video1, &quot;append_video1&quot;);
-  GLADE_HOOKUP_OBJECT (mainWindow, image8424, &quot;image8424&quot;);
+  GLADE_HOOKUP_OBJECT (mainWindow, image8449, &quot;image8449&quot;);
   GLADE_HOOKUP_OBJECT (mainWindow, save_stuff, &quot;save_stuff&quot;);
-  GLADE_HOOKUP_OBJECT (mainWindow, image8425, &quot;image8425&quot;);
+  GLADE_HOOKUP_OBJECT (mainWindow, image8450, &quot;image8450&quot;);
   GLADE_HOOKUP_OBJECT (mainWindow, save_stuff_menu, &quot;save_stuff_menu&quot;);
   GLADE_HOOKUP_OBJECT (mainWindow, save_as_avi1, &quot;save_as_avi1&quot;);
   GLADE_HOOKUP_OBJECT (mainWindow, separator1, &quot;separator1&quot;);
@@ -1486,41 +1491,41 @@
   GLADE_HOOKUP_OBJECT (mainWindow, close1, &quot;close1&quot;);
   GLADE_HOOKUP_OBJECT (mainWindow, separator3, &quot;separator3&quot;);
   GLADE_HOOKUP_OBJECT (mainWindow, save_project1, &quot;save_project1&quot;);
-  GLADE_HOOKUP_OBJECT (mainWindow, image8426, &quot;image8426&quot;);
+  GLADE_HOOKUP_OBJECT (mainWindow, image8451, &quot;image8451&quot;);
   GLADE_HOOKUP_OBJECT (mainWindow, save_project_as1, &quot;save_project_as1&quot;);
-  GLADE_HOOKUP_OBJECT (mainWindow, image8427, &quot;image8427&quot;);
+  GLADE_HOOKUP_OBJECT (mainWindow, image8452, &quot;image8452&quot;);
   GLADE_HOOKUP_OBJECT (mainWindow, run_script1, &quot;run_script1&quot;);
-  GLADE_HOOKUP_OBJECT (mainWindow, image8428, &quot;image8428&quot;);
+  GLADE_HOOKUP_OBJECT (mainWindow, image8453, &quot;image8453&quot;);
   GLADE_HOOKUP_OBJECT (mainWindow, add_to_joblist1, &quot;add_to_joblist1&quot;);
   GLADE_HOOKUP_OBJECT (mainWindow, joblist1, &quot;joblist1&quot;);
   GLADE_HOOKUP_OBJECT (mainWindow, separator16, &quot;separator16&quot;);
   GLADE_HOOKUP_OBJECT (mainWindow, connect_to_avsproxy1, &quot;connect_to_avsproxy1&quot;);
   GLADE_HOOKUP_OBJECT (mainWindow, separator18, &quot;separator18&quot;);
   GLADE_HOOKUP_OBJECT (mainWindow, video_informations1, &quot;video_informations1&quot;);
-  GLADE_HOOKUP_OBJECT (mainWindow, image8429, &quot;image8429&quot;);
+  GLADE_HOOKUP_OBJECT (mainWindow, image8454, &quot;image8454&quot;);
   GLADE_HOOKUP_OBJECT (mainWindow, avi_muxer_options1, &quot;avi_muxer_options1&quot;);
   GLADE_HOOKUP_OBJECT (mainWindow, separator4, &quot;separator4&quot;);
   GLADE_HOOKUP_OBJECT (mainWindow, quit1, &quot;quit1&quot;);
-  GLADE_HOOKUP_OBJECT (mainWindow, image8430, &quot;image8430&quot;);
+  GLADE_HOOKUP_OBJECT (mainWindow, image8455, &quot;image8455&quot;);
   GLADE_HOOKUP_OBJECT (mainWindow, menuitem2, &quot;menuitem2&quot;);
   GLADE_HOOKUP_OBJECT (mainWindow, menuitem2_menu, &quot;menuitem2_menu&quot;);
   GLADE_HOOKUP_OBJECT (mainWindow, reset_edits1, &quot;reset_edits1&quot;);
-  GLADE_HOOKUP_OBJECT (mainWindow, image8431, &quot;image8431&quot;);
+  GLADE_HOOKUP_OBJECT (mainWindow, image8456, &quot;image8456&quot;);
   GLADE_HOOKUP_OBJECT (mainWindow, separator5, &quot;separator5&quot;);
   GLADE_HOOKUP_OBJECT (mainWindow, cut1, &quot;cut1&quot;);
-  GLADE_HOOKUP_OBJECT (mainWindow, image8432, &quot;image8432&quot;);
+  GLADE_HOOKUP_OBJECT (mainWindow, image8457, &quot;image8457&quot;);
   GLADE_HOOKUP_OBJECT (mainWindow, copy1, &quot;copy1&quot;);
-  GLADE_HOOKUP_OBJECT (mainWindow, image8433, &quot;image8433&quot;);
+  GLADE_HOOKUP_OBJECT (mainWindow, image8458, &quot;image8458&quot;);
   GLADE_HOOKUP_OBJECT (mainWindow, paste1, &quot;paste1&quot;);
-  GLADE_HOOKUP_OBJECT (mainWindow, image8434, &quot;image8434&quot;);
+  GLADE_HOOKUP_OBJECT (mainWindow, image8459, &quot;image8459&quot;);
   GLADE_HOOKUP_OBJECT (mainWindow, delete1, &quot;delete1&quot;);
-  GLADE_HOOKUP_OBJECT (mainWindow, image8435, &quot;image8435&quot;);
+  GLADE_HOOKUP_OBJECT (mainWindow, image8460, &quot;image8460&quot;);
   GLADE_HOOKUP_OBJECT (mainWindow, separator6, &quot;separator6&quot;);
   GLADE_HOOKUP_OBJECT (mainWindow, set_marker_a1, &quot;set_marker_a1&quot;);
   GLADE_HOOKUP_OBJECT (mainWindow, set_marker_b1, &quot;set_marker_b1&quot;);
   GLADE_HOOKUP_OBJECT (mainWindow, separator7, &quot;separator7&quot;);
   GLADE_HOOKUP_OBJECT (mainWindow, preferences1, &quot;preferences1&quot;);
-  GLADE_HOOKUP_OBJECT (mainWindow, image8436, &quot;image8436&quot;);
+  GLADE_HOOKUP_OBJECT (mainWindow, image8461, &quot;image8461&quot;);
   GLADE_HOOKUP_OBJECT (mainWindow, view1, &quot;view1&quot;);
   GLADE_HOOKUP_OBJECT (mainWindow, view1_menu, &quot;view1_menu&quot;);
   GLADE_HOOKUP_OBJECT (mainWindow, toolbar1, &quot;toolbar1&quot;);
@@ -1548,13 +1553,13 @@
   GLADE_HOOKUP_OBJECT (mainWindow, build_vbr_time_map1, &quot;build_vbr_time_map1&quot;);
   GLADE_HOOKUP_OBJECT (mainWindow, separator11, &quot;separator11&quot;);
   GLADE_HOOKUP_OBJECT (mainWindow, save_audio1, &quot;save_audio1&quot;);
-  GLADE_HOOKUP_OBJECT (mainWindow, image8437, &quot;image8437&quot;);
+  GLADE_HOOKUP_OBJECT (mainWindow, image8462, &quot;image8462&quot;);
   GLADE_HOOKUP_OBJECT (mainWindow, audio_encoder1, &quot;audio_encoder1&quot;);
   GLADE_HOOKUP_OBJECT (mainWindow, filters2, &quot;filters2&quot;);
   GLADE_HOOKUP_OBJECT (mainWindow, tools1, &quot;tools1&quot;);
   GLADE_HOOKUP_OBJECT (mainWindow, tools1_menu, &quot;tools1_menu&quot;);
   GLADE_HOOKUP_OBJECT (mainWindow, calculator1, &quot;calculator1&quot;);
-  GLADE_HOOKUP_OBJECT (mainWindow, image8438, &quot;image8438&quot;);
+  GLADE_HOOKUP_OBJECT (mainWindow, image8463, &quot;image8463&quot;);
   GLADE_HOOKUP_OBJECT (mainWindow, separator12, &quot;separator12&quot;);
   GLADE_HOOKUP_OBJECT (mainWindow, rebuild_frames, &quot;rebuild_frames&quot;);
   GLADE_HOOKUP_OBJECT (mainWindow, check_frames, &quot;check_frames&quot;);
@@ -1574,38 +1579,39 @@
   GLADE_HOOKUP_OBJECT (mainWindow, dvd1, &quot;dvd1&quot;);
   GLADE_HOOKUP_OBJECT (mainWindow, psp1, &quot;psp1&quot;);
   GLADE_HOOKUP_OBJECT (mainWindow, psp__h264_1, &quot;psp__h264_1&quot;);
+  GLADE_HOOKUP_OBJECT (mainWindow, flv1, &quot;flv1&quot;);
   GLADE_HOOKUP_OBJECT (mainWindow, go1, &quot;go1&quot;);
   GLADE_HOOKUP_OBJECT (mainWindow, go1_menu, &quot;go1_menu&quot;);
   GLADE_HOOKUP_OBJECT (mainWindow, play_video1, &quot;play_video1&quot;);
-  GLADE_HOOKUP_OBJECT (mainWindow, image8439, &quot;image8439&quot;);
+  GLADE_HOOKUP_OBJECT (mainWindow, image8464, &quot;image8464&quot;);
   GLADE_HOOKUP_OBJECT (mainWindow, previous_frame1, &quot;previous_frame1&quot;);
-  GLADE_HOOKUP_OBJECT (mainWindow, image8440, &quot;image8440&quot;);
+  GLADE_HOOKUP_OBJECT (mainWindow, image8465, &quot;image8465&quot;);
   GLADE_HOOKUP_OBJECT (mainWindow, next_frame1, &quot;next_frame1&quot;);
-  GLADE_HOOKUP_OBJECT (mainWindow, image8441, &quot;image8441&quot;);
+  GLADE_HOOKUP_OBJECT (mainWindow, image8466, &quot;image8466&quot;);
   GLADE_HOOKUP_OBJECT (mainWindow, previous_intra_frame1, &quot;previous_intra_frame1&quot;);
-  GLADE_HOOKUP_OBJECT (mainWindow, image8442, &quot;image8442&quot;);
+  GLADE_HOOKUP_OBJECT (mainWindow, image8467, &quot;image8467&quot;);
   GLADE_HOOKUP_OBJECT (mainWindow, next_intra_frame1, &quot;next_intra_frame1&quot;);
-  GLADE_HOOKUP_OBJECT (mainWindow, image8443, &quot;image8443&quot;);
+  GLADE_HOOKUP_OBJECT (mainWindow, image8468, &quot;image8468&quot;);
   GLADE_HOOKUP_OBJECT (mainWindow, search_previous_black_frame1, &quot;search_previous_black_frame1&quot;);
   GLADE_HOOKUP_OBJECT (mainWindow, search_next_black_frame1, &quot;search_next_black_frame1&quot;);
   GLADE_HOOKUP_OBJECT (mainWindow, first_frame1, &quot;first_frame1&quot;);
-  GLADE_HOOKUP_OBJECT (mainWindow, image8444, &quot;image8444&quot;);
+  GLADE_HOOKUP_OBJECT (mainWindow, image8469, &quot;image8469&quot;);
   GLADE_HOOKUP_OBJECT (mainWindow, last_frame1, &quot;last_frame1&quot;);
-  GLADE_HOOKUP_OBJECT (mainWindow, image8445, &quot;image8445&quot;);
+  GLADE_HOOKUP_OBJECT (mainWindow, image8470, &quot;image8470&quot;);
   GLADE_HOOKUP_OBJECT (mainWindow, separator14, &quot;separator14&quot;);
   GLADE_HOOKUP_OBJECT (mainWindow, go_to_marker_a1, &quot;go_to_marker_a1&quot;);
   GLADE_HOOKUP_OBJECT (mainWindow, go_to_marker_b1, &quot;go_to_marker_b1&quot;);
   GLADE_HOOKUP_OBJECT (mainWindow, separator15, &quot;separator15&quot;);
   GLADE_HOOKUP_OBJECT (mainWindow, jum_to_frame1, &quot;jum_to_frame1&quot;);
-  GLADE_HOOKUP_OBJECT (mainWindow, image8446, &quot;image8446&quot;);
+  GLADE_HOOKUP_OBJECT (mainWindow, image8471, &quot;image8471&quot;);
   GLADE_HOOKUP_OBJECT (mainWindow, jump_to_time1, &quot;jump_to_time1&quot;);
-  GLADE_HOOKUP_OBJECT (mainWindow, image8447, &quot;image8447&quot;);
+  GLADE_HOOKUP_OBJECT (mainWindow, image8472, &quot;image8472&quot;);
   GLADE_HOOKUP_OBJECT (mainWindow, custom1, &quot;custom1&quot;);
   GLADE_HOOKUP_OBJECT (mainWindow, help2, &quot;help2&quot;);
   GLADE_HOOKUP_OBJECT (mainWindow, help2_menu, &quot;help2_menu&quot;);
   GLADE_HOOKUP_OBJECT (mainWindow, show_builtin_support1, &quot;show_builtin_support1&quot;);
   GLADE_HOOKUP_OBJECT (mainWindow, about1, &quot;about1&quot;);
-  GLADE_HOOKUP_OBJECT (mainWindow, image8448, &quot;image8448&quot;);
+  GLADE_HOOKUP_OBJECT (mainWindow, image8473, &quot;image8473&quot;);
   GLADE_HOOKUP_OBJECT (mainWindow, toolbar2, &quot;toolbar2&quot;);
   GLADE_HOOKUP_OBJECT (mainWindow, menutoolbuttonOpen, &quot;menutoolbuttonOpen&quot;);
   GLADE_HOOKUP_OBJECT (mainWindow, toolitem11, &quot;toolitem11&quot;);

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_menumap.h
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_menumap.h	2007-08-25 22:48:09 UTC (rev 3561)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_menumap.h	2007-08-26 09:13:11 UTC (rev 3562)
@@ -95,6 +95,7 @@
 CALLBACK(dvd1                                   ,ACT_AUTO_DVD);
 CALLBACK(psp1                                   ,ACT_AUTO_PSP);
 CALLBACK(psp__h264_1,                           ACT_AUTO_PSP_H264);
+CALLBACK(flv1,                                  ACT_AUTO_FLV);
 
 CALLBACK(add_to_joblist1                       ,ACT_ADD_JOB);
 CALLBACK(joblist1                              ,ACT_HANDLE_JOB);

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui	2007-08-25 22:48:09 UTC (rev 3561)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/gui2.ui	2007-08-26 09:13:11 UTC (rev 3562)
@@ -1,15 +1,13 @@
 &lt;ui version=&quot;4.0&quot; &gt;
  &lt;author&gt;mean&lt;/author&gt;
- &lt;comment&gt;&lt;/comment&gt;
- &lt;exportmacro&gt;&lt;/exportmacro&gt;
  &lt;class&gt;MainWindow&lt;/class&gt;
  &lt;widget class=&quot;QMainWindow&quot; name=&quot;MainWindow&quot; &gt;
   &lt;property name=&quot;geometry&quot; &gt;
    &lt;rect&gt;
     &lt;x&gt;0&lt;/x&gt;
     &lt;y&gt;0&lt;/y&gt;
-    &lt;width&gt;680&lt;/width&gt;
-    &lt;height&gt;537&lt;/height&gt;
+    &lt;width&gt;828&lt;/width&gt;
+    &lt;height&gt;589&lt;/height&gt;
    &lt;/rect&gt;
   &lt;/property&gt;
   &lt;property name=&quot;windowTitle&quot; &gt;
@@ -1360,8 +1358,8 @@
     &lt;rect&gt;
      &lt;x&gt;0&lt;/x&gt;
      &lt;y&gt;0&lt;/y&gt;
-     &lt;width&gt;680&lt;/width&gt;
-     &lt;height&gt;23&lt;/height&gt;
+     &lt;width&gt;828&lt;/width&gt;
+     &lt;height&gt;25&lt;/height&gt;
     &lt;/rect&gt;
    &lt;/property&gt;
    &lt;widget class=&quot;QMenu&quot; name=&quot;menuHelp&quot; &gt;
@@ -1432,16 +1430,6 @@
     &lt;addaction name=&quot;separator&quot; /&gt;
     &lt;addaction name=&quot;actionQuit&quot; /&gt;
    &lt;/widget&gt;
-   &lt;widget class=&quot;QMenu&quot; name=&quot;menuAuto&quot; &gt;
-    &lt;property name=&quot;title&quot; &gt;
-     &lt;string&gt;A&amp;uto&lt;/string&gt;
-    &lt;/property&gt;
-    &lt;addaction name=&quot;actionVCD&quot; /&gt;
-    &lt;addaction name=&quot;actionSVCD&quot; /&gt;
-    &lt;addaction name=&quot;actionDVD&quot; /&gt;
-    &lt;addaction name=&quot;actionPSP&quot; /&gt;
-    &lt;addaction name=&quot;actionPSP_H264&quot; /&gt;
-   &lt;/widget&gt;
    &lt;widget class=&quot;QMenu&quot; name=&quot;menuTools&quot; &gt;
     &lt;property name=&quot;title&quot; &gt;
      &lt;string&gt;&amp;Tools&lt;/string&gt;
@@ -1519,6 +1507,17 @@
     &lt;addaction name=&quot;actionJump_to_Frame&quot; /&gt;
     &lt;addaction name=&quot;actionJump_to_Time&quot; /&gt;
    &lt;/widget&gt;
+   &lt;widget class=&quot;QMenu&quot; name=&quot;menuAuto&quot; &gt;
+    &lt;property name=&quot;title&quot; &gt;
+     &lt;string&gt;A&amp;uto&lt;/string&gt;
+    &lt;/property&gt;
+    &lt;addaction name=&quot;actionVCD&quot; /&gt;
+    &lt;addaction name=&quot;actionSVCD&quot; /&gt;
+    &lt;addaction name=&quot;actionDVD&quot; /&gt;
+    &lt;addaction name=&quot;actionPSP&quot; /&gt;
+    &lt;addaction name=&quot;actionPSP_H264&quot; /&gt;
+    &lt;addaction name=&quot;actionFLV&quot; /&gt;
+   &lt;/widget&gt;
    &lt;addaction name=&quot;menuFile&quot; /&gt;
    &lt;addaction name=&quot;menuEdit&quot; /&gt;
    &lt;addaction name=&quot;menuView&quot; /&gt;
@@ -2384,15 +2383,17 @@
     &lt;string&gt;&amp;Separate&lt;/string&gt;
    &lt;/property&gt;
   &lt;/action&gt;
+  &lt;action name=&quot;actionFLV&quot; &gt;
+   &lt;property name=&quot;text&quot; &gt;
+    &lt;string&gt;FLV&lt;/string&gt;
+   &lt;/property&gt;
+  &lt;/action&gt;
  &lt;/widget&gt;
- &lt;pixmapfunction&gt;&lt;/pixmapfunction&gt;
  &lt;customwidgets&gt;
   &lt;customwidget&gt;
    &lt;class&gt;ADM_QSlider&lt;/class&gt;
    &lt;extends&gt;QSlider&lt;/extends&gt;
    &lt;header&gt;ADM_qslider.h&lt;/header&gt;
-   &lt;container&gt;0&lt;/container&gt;
-   &lt;pixmap&gt;&lt;/pixmap&gt;
   &lt;/customwidget&gt;
  &lt;/customwidgets&gt;
  &lt;resources&gt;

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/translation_table.h
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/translation_table.h	2007-08-25 22:48:09 UTC (rev 3561)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/translation_table.h	2007-08-26 09:13:11 UTC (rev 3562)
@@ -63,6 +63,7 @@
 PROCESS(actionSVCD,ACT_AUTO_SVCD) \
 PROCESS(actionDVD,ACT_AUTO_DVD) \
 PROCESS(actionPSP,ACT_AUTO_PSP) \
+PROCESS(actionFLV,ACT_AUTO_FLV) \
 PROCESS(actionPSP_H264,ACT_AUTO_PSP_H264)\
 PROCESS(actionAdd_to_joblist,ACT_ADD_JOB) \
 PROCESS(actionShow_Joblist,ACT_HANDLE_JOB)  

Modified: branches/avidemux_2.4_branch/avidemux/CMakeLists.txt
===================================================================
--- branches/avidemux_2.4_branch/avidemux/CMakeLists.txt	2007-08-25 22:48:09 UTC (rev 3561)
+++ branches/avidemux_2.4_branch/avidemux/CMakeLists.txt	2007-08-26 09:13:11 UTC (rev 3562)
@@ -118,6 +118,7 @@
 oplug_mpeg
 oplug_mpegFF
 oplug_ogm
+oplug_flv
 )
 
 FOREACH(_current ${ADM_outputs})

Modified: branches/avidemux_2.4_branch/avidemux/gtk_gui.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/gtk_gui.cpp	2007-08-25 22:48:09 UTC (rev 3561)
+++ branches/avidemux_2.4_branch/avidemux/gtk_gui.cpp	2007-08-26 09:13:11 UTC (rev 3562)
@@ -419,6 +419,7 @@
         case ACT_AUTO_SVCD:
         case ACT_AUTO_DVD:
         case ACT_AUTO_PSP:
+        case ACT_AUTO_FLV:
         case ACT_AUTO_PSP_H264:
                 A_autoDrive( action);
                 break;

Modified: branches/avidemux_2.4_branch/avidemux/gui_action.hxx
===================================================================
--- branches/avidemux_2.4_branch/avidemux/gui_action.hxx	2007-08-25 22:48:09 UTC (rev 3561)
+++ branches/avidemux_2.4_branch/avidemux/gui_action.hxx	2007-08-26 09:13:11 UTC (rev 3562)
@@ -175,6 +175,7 @@
 ACT_AUTO_DVD,
 ACT_AUTO_PSP,
 ACT_AUTO_PSP_H264,
+ACT_AUTO_FLV,
 
 ACT_ADD_JOB,
 ACT_HANDLE_JOB,

Modified: branches/avidemux_2.4_branch/avidemux/gui_autodrive.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/gui_autodrive.cpp	2007-08-25 22:48:09 UTC (rev 3561)
+++ branches/avidemux_2.4_branch/avidemux/gui_autodrive.cpp	2007-08-26 09:13:11 UTC (rev 3562)
@@ -57,6 +57,43 @@
 #define PSP_AUDIO_FQ 24000        
         switch(action)
         {
+        		case ACT_AUTO_FLV:
+        			// Check audio is mp3 @ 44.1/22.05/11.025 kHz MP3
+        			if(currentaudiostream)
+        			{
+        				fq=currentaudiostream-&gt;getInfo()-&gt;frequency;
+        				if(currentaudiostream-&gt;getInfo()-&gt;encoding==WAV_MP3 &amp;&amp; (fq==44100 || fq==22050 || fq==11025))
+        						{
+        	                		audioCodecSetcodec(AUDIOENC_COPY);
+        						}
+        				else
+        				{
+#ifdef HAVE_LIBMP3LAME
+        					audioCodecSetcodec(AUDIOENC_MP3);
+        					audioFilter_SetBitrate(128);
+        					// set fq
+        					
+#else
+        					 GUI_Error_HIG(_(&quot;Codec Error&quot;),
+        					        _( &quot;You don't have LAME!.\nIt is needed to create FLV  video.&quot;));
+#endif
+        					 if(fq==44100 || fq==22050 || fq==11025)
+        					         						{}
+        					 else
+        					 {
+        						 audioFilterResample(22050);
+        					 }
+        					 
+        				}
+        			}
+        			// Now video
+        			 if(!videoCodecSelectByName(&quot;FLV1&quot;)) 
+                    {
+                      GUI_Error_HIG(_(&quot;Codec Error&quot;),_( &quot;Cannot select FLV1  codec.&quot;));
+                        return 0;
+                    }
+        			break;
+        			
                 case ACT_AUTO_PSP:
                 case ACT_AUTO_PSP_H264:
                     // Resize
@@ -225,6 +262,9 @@
           case ACT_AUTO_PSP_H264:
               UI_SetCurrentFormat(ADM_PSP);
               break;
+          case ACT_AUTO_FLV:
+        	  UI_SetCurrentFormat(ADM_FLV);
+        	  break;
           default:
               UI_SetCurrentFormat(ADM_PS);
         }

Modified: branches/avidemux_2.4_branch/avidemux/gui_savenew.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/gui_savenew.cpp	2007-08-25 22:48:09 UTC (rev 3561)
+++ branches/avidemux_2.4_branch/avidemux/gui_savenew.cpp	2007-08-26 09:13:11 UTC (rev 3562)
@@ -45,6 +45,7 @@
 #include &quot;oplug_avi/op_avisave.h&quot;
 #include &quot;oplug_avi/op_savecopy.h&quot;
 #include &quot;oplug_mp4/oplug_mp4.h&quot;
+#include &quot;oplug_flv/oplug_flv.h&quot;
 #include &quot;ADM_encoder/adm_encoder.h&quot;
 
 #include &quot;oplug_avi/op_saveprocess.h&quot;
@@ -170,8 +171,12 @@
 					printf(&quot; AVI family\n&quot;);
 					switch(UI_GetCurrentFormat())
 					{
-                                                case ADM_MP4:
-                                                case ADM_PSP:
+						case ADM_FLV:
+                            			ret=oplug_flv(name);
+                            			break;
+                        case ADM_MP4:
+                        case ADM_PSP:
+                        
                                                     ret=oplug_mp4(name,UI_GetCurrentFormat());
                                                     break;
 						case ADM_AVI:


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000835.html">[Avidemux-svn-commit] r3561 -	branches/avidemux_2.4_branch/avidemux/ADM_audio
</A></li>
	<LI>Next message: <A HREF="000837.html">[Avidemux-svn-commit] r3563 - in	branches/avidemux_2.4_branch/avidemux/ADM_outputs: . oplug_flv
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#836">[ date ]</a>
              <a href="thread.html#836">[ thread ]</a>
              <a href="subject.html#836">[ subject ]</a>
              <a href="author.html#836">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/avidemux-svn-commit">More information about the Avidemux-svn-commit
mailing list</a><br>
</body></html>
