<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Avidemux-svn-commit] r3608 - in	branches/avidemux_2.4_branch/avidemux: . ADM_audiodevice	ADM_libraries/ADM_lavcodec ADM_libraries/ADM_libass	ADM_libraries/ADM_utilities ADM_userInterfaces/ADM_GTK/ADM_dialog	ADM_userInterfaces/ADM_GTK/ADM_dialogFactory	ADM_userInterfaces/ADM_GTK/ADM_gui2	ADM_userInterfaces/ADM_GTK/ADM_toolkit_gtk	ADM_userInterfaces/ADM_GTK/glade	ADM_userInterfaces/ADM_NONE/ADM_dialog	ADM_userInterfaces/ADM_NONE/ADM_dialogFactory	ADM_userInterfaces/ADM_QT4/ADM_dialog	ADM_userInterfaces/ADM_QT4/ADM_dialogFactory	ADM_userInterfaces/ADM_commonUI ADM_video ADM_videoFilter
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/avidemux-svn-commit/2007-September/index.html" >
   <LINK REL="made" HREF="mailto:avidemux-svn-commit%40lists.berlios.de?Subject=Re%3A%20%5BAvidemux-svn-commit%5D%20r3608%20-%20in%0A%09branches/avidemux_2.4_branch/avidemux%3A%20.%20ADM_audiodevice%0A%09ADM_libraries/ADM_lavcodec%20ADM_libraries/ADM_libass%0A%09ADM_libraries/ADM_utilities%20ADM_userInterfaces/ADM_GTK/ADM_dialog%0A%09ADM_userInterfaces/ADM_GTK/ADM_dialogFactory%0A%09ADM_userInterfaces/ADM_GTK/ADM_gui2%0A%09ADM_userInterfaces/ADM_GTK/ADM_toolkit_gtk%0A%09ADM_userInterfaces/ADM_GTK/glade%0A%09ADM_userInterfaces/ADM_NONE/ADM_dialog%0A%09ADM_userInterfaces/ADM_NONE/ADM_dialogFactory%0A%09ADM_userInterfaces/ADM_QT4/ADM_dialog%0A%09ADM_userInterfaces/ADM_QT4/ADM_dialogFactory%0A%09ADM_userInterfaces/ADM_commonUI%20ADM_video%20ADM_videoFilter&In-Reply-To=%3C200709301649.l8UGnjnV022748%40sheep.berlios.de%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000879.html">
   
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Avidemux-svn-commit] r3608 - in	branches/avidemux_2.4_branch/avidemux: . ADM_audiodevice	ADM_libraries/ADM_lavcodec ADM_libraries/ADM_libass	ADM_libraries/ADM_utilities ADM_userInterfaces/ADM_GTK/ADM_dialog	ADM_userInterfaces/ADM_GTK/ADM_dialogFactory	ADM_userInterfaces/ADM_GTK/ADM_gui2	ADM_userInterfaces/ADM_GTK/ADM_toolkit_gtk	ADM_userInterfaces/ADM_GTK/glade	ADM_userInterfaces/ADM_NONE/ADM_dialog	ADM_userInterfaces/ADM_NONE/ADM_dialogFactory	ADM_userInterfaces/ADM_QT4/ADM_dialog	ADM_userInterfaces/ADM_QT4/ADM_dialogFactory	ADM_userInterfaces/ADM_commonUI ADM_video ADM_videoFilter</H1>
    <B>mean at BerliOS</B> 
    <A HREF="mailto:avidemux-svn-commit%40lists.berlios.de?Subject=Re%3A%20%5BAvidemux-svn-commit%5D%20r3608%20-%20in%0A%09branches/avidemux_2.4_branch/avidemux%3A%20.%20ADM_audiodevice%0A%09ADM_libraries/ADM_lavcodec%20ADM_libraries/ADM_libass%0A%09ADM_libraries/ADM_utilities%20ADM_userInterfaces/ADM_GTK/ADM_dialog%0A%09ADM_userInterfaces/ADM_GTK/ADM_dialogFactory%0A%09ADM_userInterfaces/ADM_GTK/ADM_gui2%0A%09ADM_userInterfaces/ADM_GTK/ADM_toolkit_gtk%0A%09ADM_userInterfaces/ADM_GTK/glade%0A%09ADM_userInterfaces/ADM_NONE/ADM_dialog%0A%09ADM_userInterfaces/ADM_NONE/ADM_dialogFactory%0A%09ADM_userInterfaces/ADM_QT4/ADM_dialog%0A%09ADM_userInterfaces/ADM_QT4/ADM_dialogFactory%0A%09ADM_userInterfaces/ADM_commonUI%20ADM_video%20ADM_videoFilter&In-Reply-To=%3C200709301649.l8UGnjnV022748%40sheep.berlios.de%3E"
       TITLE="[Avidemux-svn-commit] r3608 - in	branches/avidemux_2.4_branch/avidemux: . ADM_audiodevice	ADM_libraries/ADM_lavcodec ADM_libraries/ADM_libass	ADM_libraries/ADM_utilities ADM_userInterfaces/ADM_GTK/ADM_dialog	ADM_userInterfaces/ADM_GTK/ADM_dialogFactory	ADM_userInterfaces/ADM_GTK/ADM_gui2	ADM_userInterfaces/ADM_GTK/ADM_toolkit_gtk	ADM_userInterfaces/ADM_GTK/glade	ADM_userInterfaces/ADM_NONE/ADM_dialog	ADM_userInterfaces/ADM_NONE/ADM_dialogFactory	ADM_userInterfaces/ADM_QT4/ADM_dialog	ADM_userInterfaces/ADM_QT4/ADM_dialogFactory	ADM_userInterfaces/ADM_commonUI ADM_video ADM_videoFilter">mean at mail.berlios.de
       </A><BR>
    <I>Sun Sep 30 18:49:45 CEST 2007</I>
    <P><UL>
        <LI>Previous message: <A HREF="000879.html">[Avidemux-svn-commit] r3607 -	branches/avidemux_2.4_branch/avidemux/ADM_inputs/ADM_matroska
</A></li>
        
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#880">[ date ]</a>
              <a href="thread.html#880">[ thread ]</a>
              <a href="subject.html#880">[ subject ]</a>
              <a href="author.html#880">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Author: mean
Date: 2007-09-30 18:49:31 +0200 (Sun, 30 Sep 2007)
New Revision: 3608

Added:
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_SwissArmyKnife.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_particle.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_threshold.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/glade/particle.glade
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/glade/swissarmyknife.glade
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/glade/threshold.glade
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_flyParticle.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_flyParticle.h
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_flySwissArmyKnife.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_flySwissArmyKnife.h
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_flyThreshold.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_flyThreshold.h
Modified:
   branches/avidemux_2.4_branch/avidemux/ADM_assert.h
   branches/avidemux_2.4_branch/avidemux/ADM_audiodevice/ADM_deviceArts.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec/avcodec.h
   branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_libass/ass_cache.c
   branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_libass/ass_font.c
   branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_libass/ass_fontconfig.c
   branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_libass/ass_render.c
   branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_utilities/default.h
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/CMakeLists.txt
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_contrast.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_crop.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_flyDialog.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_properties.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/Makefile.am
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialogFactory/DIA_filesel.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_gtkRender.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_toolkit_gtk/TLK_filesel.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_NONE/ADM_dialog/DIA_none.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_NONE/ADM_dialogFactory/FAC_toggle.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_none.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialogFactory/T_filesel.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/CMakeLists.txt
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_DVDff.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_audioconfig.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_enter.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_factory.h
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_flyAsharp.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_flyContrast.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_flyCrop.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_flyDialog.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_flyDialog.h
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_mjpeg.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_resizeWiz.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_v2v.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/GUI_render.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/GUI_sdlRender.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/Makefile.am
   branches/avidemux_2.4_branch/avidemux/ADM_video/ADM_confCouple.h
   branches/avidemux_2.4_branch/avidemux/ADM_video/ADM_confCouples.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_video/ADM_vidFont.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_video/ADM_vidFont.h
   branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/ADM_vidComputeAverage.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/ADM_vidParticle.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/ADM_vidParticle.h
   branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/ADM_vidSRT.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/ADM_vidSRTRender.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/ADM_vidSRTload.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/ADM_vidSwissArmyKnife.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/ADM_vidSwissArmyKnife.h
   branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/ADM_vidThreshold.cpp
   branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/ADM_vidThreshold.h
Log:
[Misc] Chris McGregor : plenty of fixes, warning fixes, and more mysterious filters

Modified: branches/avidemux_2.4_branch/avidemux/ADM_assert.h
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_assert.h	2007-09-30 16:29:29 UTC (rev 3607)
+++ branches/avidemux_2.4_branch/avidemux/ADM_assert.h	2007-09-30 16:49:31 UTC (rev 3608)
@@ -44,6 +44,7 @@
   #define realloc #error
   #define memalign #error
   #define free  #error
+  #undef strdup
   #define strdup #error
   #define calloc #error
 #else
@@ -51,6 +52,7 @@
   #define realloc ADM_realloc
   #define memalign(x,y) ADM_alloc(y)
   #define free  ADM_dealloc
+  #undef strdup
   #define strdup ADM_strdup
   #define calloc ADM_calloc
 #endif

Modified: branches/avidemux_2.4_branch/avidemux/ADM_audiodevice/ADM_deviceArts.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_audiodevice/ADM_deviceArts.cpp	2007-09-30 16:29:29 UTC (rev 3607)
+++ branches/avidemux_2.4_branch/avidemux/ADM_audiodevice/ADM_deviceArts.cpp	2007-09-30 16:49:31 UTC (rev 3608)
@@ -14,21 +14,14 @@
  *   (at your option) any later version.                                   *
  *                                                                         *
  ***************************************************************************/
-#include &quot;config.h&quot;
+
+#include &quot;default.h&quot;
+
 #ifndef ADM_WIN32 
 #ifdef USE_ARTS
 #include &lt;artsc.h&gt;
 
-#include &lt;stdio.h&gt;
-#include &lt;stdlib.h&gt;
-#include &lt;unistd.h&gt;
-#include &lt;errno.h&gt;
-#include &lt;sys/types.h&gt;
-#include &lt;sys/stat.h&gt;
-#include &lt;fcntl.h&gt;
-#include &lt;sys/ioctl.h&gt;
 #include &lt;ADM_assert.h&gt;  
-#include &quot;default.h&quot;
 #include &quot;ADM_audiodevice.h&quot;
 #include  &quot;ADM_audiodevice/ADM_deviceoss.h&quot;
 #include  &quot;ADM_audiodevice/ADM_deviceArts.h&quot;

Modified: branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec/avcodec.h
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec/avcodec.h	2007-09-30 16:29:29 UTC (rev 3607)
+++ branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_lavcodec/avcodec.h	2007-09-30 16:49:31 UTC (rev 3608)
@@ -2230,7 +2230,8 @@
 /**
  * @deprecated Use the software scaler (swscale) instead.
  */
-typedef struct ImgReSampleContext ImgReSampleContext attribute_deprecated;
+//typedef struct ImgReSampleContext ImgReSampleContext attribute_deprecated;
+typedef struct ImgReSampleContext ImgReSampleContext;
 
 /**
  * @deprecated Use the software scaler (swscale) instead.

Modified: branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_libass/ass_cache.c
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_libass/ass_cache.c	2007-09-30 16:29:29 UTC (rev 3607)
+++ branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_libass/ass_cache.c	2007-09-30 16:49:31 UTC (rev 3608)
@@ -21,9 +21,18 @@
 #include &quot;config.h&quot;
 
 #include &lt;inttypes.h&gt;
+#ifdef HAVE_UNISTD_H
+// avoid warnings due to different definition of this in freetype headers
+#define WE_DO_HAVE_UNISTD_H
+#undef HAVE_UNISTD_H
+#endif
 #include &lt;ft2build.h&gt;
 #include FT_FREETYPE_H
 #include FT_GLYPH_H
+#ifdef WE_DO_HAVE_UNISTD_H
+#undef HAVE_UNISTD_H
+#define HAVE_UNISTD_H
+#endif
 
 #include &lt;assert.h&gt;
 

Modified: branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_libass/ass_font.c
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_libass/ass_font.c	2007-09-30 16:29:29 UTC (rev 3607)
+++ branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_libass/ass_font.c	2007-09-30 16:49:31 UTC (rev 3608)
@@ -21,11 +21,21 @@
 #include &quot;config.h&quot;
 
 #include &lt;inttypes.h&gt;
+#ifdef HAVE_UNISTD_H
+// avoid warnings due to different definition of this in freetype headers
+#define WE_DO_HAVE_UNISTD_H
+#undef HAVE_UNISTD_H
+#endif
 #include &lt;ft2build.h&gt;
 #include FT_FREETYPE_H
 #include FT_SYNTHESIS_H
 #include FT_GLYPH_H
 #include FT_TRUETYPE_TABLES_H
+#ifdef HAVE_UNISTD_H
+// avoid warnings due to different definition of this in freetype headers
+#define WE_DO_HAVE_UNISTD_H
+#undef HAVE_UNISTD_H
+#endif
 
 #include &quot;ass.h&quot;
 #include &quot;ass_library.h&quot;

Modified: branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_libass/ass_fontconfig.c
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_libass/ass_fontconfig.c	2007-09-30 16:29:29 UTC (rev 3607)
+++ branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_libass/ass_fontconfig.c	2007-09-30 16:49:31 UTC (rev 3608)
@@ -27,8 +27,17 @@
 #include &lt;sys/types.h&gt;
 #include &lt;sys/stat.h&gt;
 #include &lt;inttypes.h&gt;
+#ifdef HAVE_UNISTD_H
+// avoid warnings due to different definition of this in freetype headers
+#define WE_DO_HAVE_UNISTD_H
+#undef HAVE_UNISTD_H
+#endif
 #include &lt;ft2build.h&gt;
 #include FT_FREETYPE_H
+#ifdef WE_DO_HAVE_UNISTD_H
+#undef HAVE_UNISTD_H
+#define HAVE_UNISTD_H
+#endif
 
 #include &quot;mputils.h&quot;
 #include &quot;ass.h&quot;

Modified: branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_libass/ass_render.c
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_libass/ass_render.c	2007-09-30 16:29:29 UTC (rev 3607)
+++ branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_libass/ass_render.c	2007-09-30 16:49:31 UTC (rev 3608)
@@ -23,11 +23,20 @@
 #include &lt;assert.h&gt;
 #include &lt;math.h&gt;
 #include &lt;inttypes.h&gt;
+#ifdef HAVE_UNISTD_H
+// avoid warnings due to different definition of this in freetype headers
+#define WE_DO_HAVE_UNISTD_H
+#undef HAVE_UNISTD_H
+#endif
 #include &lt;ft2build.h&gt;
 #include FT_FREETYPE_H
 #include FT_STROKER_H
 #include FT_GLYPH_H
 #include FT_SYNTHESIS_H
+#ifdef WE_DO_HAVE_UNISTD_H
+#undef HAVE_UNISTD_H
+#define HAVE_UNISTD_H
+#endif
 
 #include &quot;mputils.h&quot;
 

Modified: branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_utilities/default.h
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_utilities/default.h	2007-09-30 16:29:29 UTC (rev 3607)
+++ branches/avidemux_2.4_branch/avidemux/ADM_libraries/ADM_utilities/default.h	2007-09-30 16:49:31 UTC (rev 3608)
@@ -16,12 +16,21 @@
  ***************************************************************************/
 #ifndef __ZDEFAULT
 #define __ZDEFAULT
+
+#include &quot;config.h&quot;
+
+#include &lt;stdio.h&gt;
+#include &lt;stdlib.h&gt;
+#include &lt;string.h&gt;
+#ifdef HAVE_UNISTD_H
+#include &lt;unistd.h&gt;
+#endif
+
 /*
    	The maximum width/height is MAXIMUM_SIZE 768*768 for now
 */
 #define MAXIMUM_SIZE 2048
 
-
 typedef unsigned char ADM_filename ;
 
 #ifdef HAVE_STDINT_H

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/CMakeLists.txt
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/CMakeLists.txt	2007-09-30 16:29:29 UTC (rev 3607)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/CMakeLists.txt	2007-09-30 16:49:31 UTC (rev 3608)
@@ -10,6 +10,7 @@
 DIA_cnr2.cpp         DIA_eq2.cpp        DIA_idx_pg.cpp     DIA_partial.cpp   DIA_quota.cpp       DIA_vobsub.cpp
 DIA_asharp.cpp    DIA_coloryuv.cpp     DIA_equalizer.cpp  DIA_jobs.cpp       DIA_pause.cpp     DIA_recent.cpp      DIA_working.cpp
 DIA_busy.cpp      DIA_contrast.cpp     DIA_exLame.cpp     DIA_jobs_save.cpp  DIA_pipe.cpp      DIA_resize.cpp      DIA_x264.cpp
+DIA_threshold.cpp DIA_SwissArmyKnife.cpp DIA_particle.cpp
 )
 ADD_LIBRARY(${ADM_LIB} STATIC ${${ADM_LIB}_SRCS})
 ADD_ADM_LIB(${ADM_LIB} ADM_libraries)

Added: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_SwissArmyKnife.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_SwissArmyKnife.cpp	2007-09-30 16:29:29 UTC (rev 3607)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_SwissArmyKnife.cpp	2007-09-30 16:49:31 UTC (rev 3608)
@@ -0,0 +1,1535 @@
+/***************************************************************************
+                          DIA_SwissArmyKnife.cpp  -  configuration dialog for
+						Swiss Army Knife filter
+                              -------------------
+                         Chris MacGregor, September 2007
+                         <A HREF="https://lists.berlios.de/mailman/listinfo/avidemux-svn-commit">chris-avidemux at bouncingdog.com</A>
+ ***************************************************************************/
+
+/***************************************************************************
+ *                                                                         *
+ *   This program is free software; you can redistribute it and/or modify  *
+ *   it under the terms of the GNU General Public License as published by  *
+ *   the Free Software Foundation; either version 2 of the License, or     *
+ *   (at your option) any later version.                                   *
+ *                                                                         *
+ ***************************************************************************/
+
+#include &quot;default.h&quot;
+
+#include &lt;gtk/gtk.h&gt;
+#include &lt;cmath&gt;
+
+#include &quot;fourcc.h&quot;
+#include &quot;avio.hxx&quot;
+
+#include &quot;avi_vars.h&quot;
+
+#ifdef HAVE_ENCODER
+
+#include &quot;ADM_editor/ADM_edit.hxx&quot;
+#include &quot;ADM_video/ADM_genvideo.hxx&quot;
+#include &quot;ADM_videoFilter/ADM_vidSwissArmyKnife.h&quot;
+#include &quot;ADM_toolkit/toolkit.hxx&quot;
+#include &quot;ADM_toolkit_gtk/ADM_gladeSupport.h&quot;
+#include &quot;ADM_toolkit_gtk/toolkit_gtk.h&quot;
+#include &quot;ADM_toolkit_gtk/toolkit_gtk_include.h&quot;
+#include &quot;ADM_assert.h&quot;
+#include &quot;DIA_flyDialog.h&quot;
+#include &quot;DIA_flySwissArmyKnife.h&quot;
+#include &quot;ADM_userInterfaces/ADM_commonUI/DIA_factory.h&quot; // for diaElemMenu etc.
+
+/********************************************************************/
+static GtkWidget *create_swiss_army_knife_dialog (void);
+static GtkWidget *dialog = 0;
+
+static gboolean gui_draw (GtkWidget * widget,
+			  GdkEventExpose * event, gpointer user_data);
+static void gui_update (GtkObject * button, gpointer user_data);
+static void frame_changed (GtkRange *, gpointer user_data);
+
+static volatile int lock = 0;
+
+/********************************************************************/
+
+static gboolean previewButtonEvent (GtkWidget *,
+                                    GdkEventButton * event,
+                                    gpointer data)
+{
+    if (event-&gt;type != GDK_BUTTON_PRESS)
+        return FALSE;
+
+    uint32_t x = static_cast &lt;uint32_t&gt; (event-&gt;x);
+    uint32_t y = static_cast &lt;uint32_t&gt; (event-&gt;y);
+
+    flySwissArmyKnife * myFly = static_cast &lt;flySwissArmyKnife *&gt; (data);
+    ADMImage * image = event-&gt;button == 1
+        ? myFly-&gt;getInputImage() : myFly-&gt;getOutputImage();
+
+    uint32_t width = image-&gt;_width;
+    uint32_t height = image-&gt;_height;
+
+    if (x &gt;= width || y &gt;= height)
+        return FALSE;
+
+    uint8_t range = 3;
+    if (event-&gt;state &amp; GDK_SHIFT_MASK)
+        range += 2;
+    if (event-&gt;state &amp; GDK_CONTROL_MASK)
+        range += 4;
+    if (event-&gt;state &amp; GDK_MOD1_MASK)
+        range += 6;
+
+    uint8_t halfrange = range / 2;
+
+    uint32_t xmin = (x &gt; halfrange) ? x - halfrange : 0;
+    uint32_t ymin = (y &gt; halfrange) ? y - halfrange : 0;
+
+    uint32_t xmax = x + halfrange;
+    uint32_t ymax = y + halfrange;
+
+    if (xmax &gt;= width)
+        xmax = width - 1;
+    if (ymax &gt;= height)
+        ymax = height - 1;
+
+    uint8_t * imagepix = YPLANE (image);
+
+    printf (&quot;\n  x|&quot;);
+    for (x = xmin; x &lt;= xmax; x++)
+        printf (&quot; %3d&quot;, x);
+    printf (&quot;\ny: +&quot;);
+    for (x = xmin; x &lt;= xmax; x++)
+        printf (&quot; ---&quot;, x);
+    printf (&quot;\n&quot;);
+
+    for (y = ymin; y &lt;= ymax; y++)
+    {
+        uint8_t * pixp = imagepix + (y * width) + xmin;
+        printf (&quot;%3d|&quot;, y);
+        for (x = xmin; x &lt;= xmax; x++)
+            printf (&quot; %3d&quot;, *pixp++);
+        printf (&quot;\n&quot;);
+    }
+
+    return TRUE;
+}
+
+/********************************************************************/
+
+void alphaRecalcOther (GtkSpinButton * spinbutton, gpointer user_data)
+{
+    static int alpha_lock = 0;
+
+    // avoid double screen updates (can be slow if the settings involve a lot
+    // of calculation, such as recalculating the head start) due to recursive
+    // calls to this function (e.g., it gets invoked on the denominator to a
+    // change made by this function in response to the user changing the float
+    // field).
+
+    if (alpha_lock++)
+    {
+        --alpha_lock;
+        return;
+    }
+
+    GtkSpinButton * targetspinbutton = GTK_SPIN_BUTTON (user_data);
+    gtk_spin_button_set_value (targetspinbutton,
+                               1 / gtk_spin_button_get_value (spinbutton));
+
+    --alpha_lock;
+}
+
+struct PixelValueScalingInfo
+{
+    GtkAdjustment * addAdjustment;
+    GtkAdjustment * multAdjustment;
+    GtkAdjustment * minAdjustment;
+    GtkAdjustment * maxAdjustment;
+    flySwissArmyKnife * myFly;
+    double addValue;
+    double multValue;
+    double minValue;
+    double maxValue;
+    bool valuesSet;
+    PixelValueScalingInfo (GtkAdjustment * add,
+                           GtkAdjustment * mult,
+                           GtkAdjustment * min,
+                           GtkAdjustment * max,
+                           flySwissArmyKnife * myFly)
+        : addAdjustment (add),
+          multAdjustment (mult),
+          minAdjustment (min),
+          maxAdjustment (max),
+          myFly (myFly),
+          valuesSet (false)
+
+    {
+    }
+};
+
+void updateScalingStuff (GtkAdjustment * adj, gpointer user_data)
+{
+    static int scaling_lock = 0;
+
+    // avoid screwy behavior due to recursive calls to this function (e.g., if
+    // it gets invoked due to a change that it initiated, just exit - no good
+    // will come of trying to redo the calculations midstream).
+
+    if (scaling_lock++)
+    {
+        // printf (&quot;skipping recursive updateScalingStuff(%p)\n&quot;, adj);
+        --scaling_lock;
+        return;
+    }
+
+    PixelValueScalingInfo * info
+        = static_cast &lt;PixelValueScalingInfo *&gt; (user_data);
+
+    bool valueChanged = false;
+    if (!info-&gt;valuesSet)
+    {
+        info-&gt;addValue = gtk_adjustment_get_value (info-&gt;addAdjustment);
+        info-&gt;multValue = gtk_adjustment_get_value (info-&gt;multAdjustment);
+        info-&gt;minValue = gtk_adjustment_get_value (info-&gt;minAdjustment);
+        info-&gt;maxValue = gtk_adjustment_get_value (info-&gt;maxAdjustment);
+        info-&gt;valuesSet = true;
+        valueChanged = true; // force update - we have to assume it did change
+    }
+
+    // No matter who sent the signal, we will want the value from it.
+
+    gdouble value = gtk_adjustment_get_value (adj);
+
+    // We need to know which thing sent the signal so we propagate values in
+    // the right directions.
+
+    // Here's how we got the calculations below:
+    //     P' = (P + add) * mult
+    // (solve for each of mult, add, and P:)
+    //     mult = P' / (P + add)
+    //     add = (P' / mult) - P
+    //     P = (P' / mult) - add
+    // Thus:
+    //     for min, where P' = 0, P = -add
+    //     for max, where P' = 255, P = (255 / mult) - add
+    // And so:
+    //     add = -min
+    //     mult = 255 / (max - min)
+    //     min = -add
+    //     max = (255 / mult) - add
+
+    if (adj == info-&gt;addAdjustment)
+    {
+        // printf (&quot;updateScalingStuff(%p) - add is now %.12f (was %.12f)\n&quot;,
+        //         adj, value, info-&gt;addValue);
+        if (valueChanged || fabs (value - info-&gt;addValue) &gt;= 0.00001)
+        {
+            gtk_adjustment_set_value (info-&gt;minAdjustment, -value);
+            gdouble mult_value
+                = gtk_adjustment_get_value (info-&gt;multAdjustment);
+            gtk_adjustment_set_value (info-&gt;maxAdjustment,
+                                      (255 / mult_value) - value);
+            info-&gt;addValue = value;
+            valueChanged = true;
+        }
+    }
+    else if (adj == info-&gt;multAdjustment)
+    {
+        // printf (&quot;updateScalingStuff(%p) - mult is now %.12f (was %.12f)\n&quot;,
+        //         adj, value, info-&gt;multValue);
+        if (valueChanged || fabs (value - info-&gt;multValue) &gt;= 0.00001)
+        {
+            gdouble add_value
+                = gtk_adjustment_get_value (info-&gt;addAdjustment);
+            gtk_adjustment_set_value (info-&gt;maxAdjustment,
+                                      (255 / value) - add_value);
+            info-&gt;multValue = value;
+            valueChanged = true;
+        }
+    }
+    else if (adj == info-&gt;minAdjustment)
+    {
+        // printf (&quot;updateScalingStuff(%p) - min is now %.12f (was %.12f)\n&quot;,
+        //         adj, value, info-&gt;minValue);
+        if (valueChanged || fabs (value - info-&gt;minValue) &gt;= 0.1)
+        {
+            gdouble max_value
+                = gtk_adjustment_get_value (info-&gt;maxAdjustment);
+            gtk_adjustment_set_value (info-&gt;addAdjustment, -value);
+            gtk_adjustment_set_value (info-&gt;multAdjustment,
+                                      255 / (max_value - value));
+            info-&gt;minValue = value;
+            valueChanged = true;
+        }
+    }
+    else if (adj == info-&gt;maxAdjustment)
+    {
+        // printf (&quot;updateScalingStuff(%p) - max is now %.12f (was %.12f)\n&quot;,
+        //         adj, value, info-&gt;maxValue);
+        if (valueChanged || fabs (value - info-&gt;maxValue) &gt;= 0.1)
+        {
+            gdouble min_value
+                = gtk_adjustment_get_value (info-&gt;minAdjustment);
+            gtk_adjustment_set_value (info-&gt;multAdjustment,
+                                      255 / (value - min_value));
+            info-&gt;maxValue = value;
+            valueChanged = true;
+        }
+    }
+    else
+    {
+        // uh oh!
+        fprintf (stderr, &quot;updateScalingStuff() called with unknown adj\n&quot;);
+        ADM_assert(0);
+    }
+
+    if (valueChanged)
+    {
+        // printf (&quot;updateScalingStuff(%p) - about to gui_update()\n&quot;, adj);
+        gui_update (GTK_OBJECT (adj), gpointer (info-&gt;myFly));
+    }
+    // printf (&quot;updateScalingStuff(%p) - done\n&quot;, adj);
+
+    --scaling_lock;
+}
+
+void inputTypeChange (GtkComboBox * combo, gpointer user_data)
+{
+    flySwissArmyKnife * myFly = static_cast &lt;flySwissArmyKnife *&gt; (user_data);
+    const MenuMapping * mm = myFly-&gt;lookupMenu (&quot;inputTypeMenu&quot;);
+    uint32_t inputType = myFly-&gt;getMenuValue (mm);
+
+    GtkWidget * convolutionSettingsVbox = WID (convolutionSettingsVbox);
+    GtkWidget * imageFileSettingsVbox = WID (imageFileSettingsVbox);
+    GtkWidget * constantSettingsVbox = WID (constantSettingsVbox);
+    GtkWidget * rollingAvgSettingsVbox = WID (rollingAvgSettingsVbox);
+
+    gtk_widget_hide (convolutionSettingsVbox);
+    gtk_widget_hide (imageFileSettingsVbox);
+    gtk_widget_hide (constantSettingsVbox);
+    gtk_widget_hide (rollingAvgSettingsVbox);
+
+    switch (inputType)
+    {
+    case ADMVideoSwissArmyKnife::INPUT_CUSTOM_CONVOLUTION:
+        gtk_widget_show (convolutionSettingsVbox);
+        break;
+    case ADMVideoSwissArmyKnife::INPUT_FILE_IMAGE_FLOAT:
+    case ADMVideoSwissArmyKnife::INPUT_FILE_IMAGE_INTEGER:
+        gtk_widget_show (imageFileSettingsVbox);
+        break;
+    case ADMVideoSwissArmyKnife::INPUT_CONSTANT_VALUE:
+        gtk_widget_show (constantSettingsVbox);
+        break;
+    case ADMVideoSwissArmyKnife::INPUT_ROLLING_AVERAGE:
+        gtk_widget_show (rollingAvgSettingsVbox);
+        break;
+    default:
+        fprintf (stderr, &quot;unknown input type %d!!!\n&quot;, inputType);
+        ADM_assert(0);
+    }
+
+    myFly-&gt;updateConfigDescription (true);
+
+    // If the preview window is enabled, then draw on it and clear the output
+    // buffer so there isn't a leftover image (in the case where the config we
+    // switched to can't output right now, e.g., invalid params - missing
+    // filename, for instance).
+
+    myFly-&gt;wipeOutputBuffer();
+
+    if (myFly-&gt;param.enable_preview)
+    {
+        GtkWidget * previewVideo = WID(previewVideo);
+        int max_x = previewVideo-&gt;allocation.width;
+        int max_y = previewVideo-&gt;allocation.height;
+        gdk_draw_rectangle
+            (previewVideo-&gt;window,
+             previewVideo-&gt;style-&gt;fg_gc[GTK_WIDGET_STATE (previewVideo)],
+             TRUE, 0, 0, max_x, max_y);
+    }
+
+    myFly-&gt;sliderChanged();
+}
+
+void previewEnableButton (GtkToggleButton * button, gpointer user_data)
+{
+    flySwissArmyKnife * myFly = static_cast &lt;flySwissArmyKnife *&gt; (user_data);
+    bool isActive = gtk_toggle_button_get_active (button);
+    myFly-&gt;param.enable_preview = isActive;
+
+    GtkWidget * previewVideo = WID(previewVideo);
+    GtkWidget * previewDisabled = WID(previewDisabled);
+
+    if (isActive)
+    {
+        gtk_widget_hide (previewDisabled);
+        gtk_widget_show (previewVideo);
+        myFly-&gt;sliderChanged();
+    }
+    else
+    {
+        gtk_widget_hide (previewVideo);
+        gtk_widget_show (previewDisabled);
+    }
+}
+
+void flySwissArmyKnife::updateConfigDescription (bool do_download)
+{
+    if (do_download)
+        download();
+    gtk_label_set_text (GTK_LABEL(WID(currentConfigDescription)),
+                        ADMVideoSwissArmyKnife::getConf (&amp;param, true));
+}
+
+void updateConfigDescription (GtkSpinButton * button, gpointer user_data)
+{
+    flySwissArmyKnife * myFly = static_cast &lt;flySwissArmyKnife *&gt; (user_data);
+    myFly-&gt;updateConfigDescription (true);
+}
+
+uint8_t DIA_SwissArmyKnife (AVDMGenericVideoStream * in,
+                            ADMVideoSwissArmyKnife * sakp,
+                            SWISSARMYKNIFE_PARAM * param,
+                            const MenuMapping * menu_mapping,
+                            uint32_t menu_mapping_count)
+{
+    // Allocate space for preview video
+    uint32_t width = in-&gt;getInfo()-&gt;width;
+    uint32_t height = in-&gt;getInfo()-&gt;height;
+
+    dialog = create_swiss_army_knife_dialog();
+    gtk_register_dialog (dialog);
+    gtk_window_set_title (GTK_WINDOW (dialog),
+                          QT_TR_NOOP(&quot;Swiss Army Knife Configuration&quot;));
+    gtk_widget_set_size_request (WID(previewDisabled), width, height);
+
+    // Fix up a bunch of things that Glade can't do.  This is less efficient
+    // than just editing the Glade output, but it's not that big a deal and
+    // doing it this way makes it MUCH easier to use Glade to tweak the layout
+    // later.
+
+    // 1. Connect the slider/spinner pairs by making them share a
+    //    GtkAdjustment.
+
+#define JOIN_SPINPAIR(_basename) \
+    gtk_range_set_adjustment \
+        (GTK_RANGE(WID(_basename ## Slider)), \
+         gtk_spin_button_get_adjustment (GTK_SPIN_BUTTON(WID(_basename ## Spinner))))
+
+    JOIN_SPINPAIR (imageFileScalingMin);
+    JOIN_SPINPAIR (imageFileScalingMax);
+    JOIN_SPINPAIR (bias);
+    JOIN_SPINPAIR (resultScalingMin);
+    JOIN_SPINPAIR (resultScalingMax);
+
+    // 2. Connect the alpha spin buttons.  Conveniently, they are reciprocals
+    //    of each other, so we can use the same function for updates in both
+    //    directions.
+
+#define ONVALCHG(_from_widg, _func, _to_widg) \
+    g_signal_connect (GTK_OBJECT(WID(_from_widg)), &quot;value_changed&quot;, \
+                      GTK_SIGNAL_FUNC(_func),                       \
+                      gpointer (GTK_OBJECT(WID(_to_widg))))
+
+    ONVALCHG (rollingAvgAlphaSpinButton, alphaRecalcOther,
+              rollingAvgAlphaDenomSpinButton);
+    ONVALCHG (rollingAvgAlphaDenomSpinButton, alphaRecalcOther,
+              rollingAvgAlphaSpinButton);
+
+    // 3. Create the flyDialog.
+
+    gtk_widget_show(dialog);
+
+    flySwissArmyKnife * myDialog
+        = new flySwissArmyKnife (width, height, in,
+                                 WID(previewVideo), WID(previewSlider),
+                                 GTK_DIALOG(dialog), sakp, param,
+                                 menu_mapping, menu_mapping_count);
+    myDialog-&gt;upload();
+    myDialog-&gt;sliderChanged();
+
+    // 4. Connect up all the other signals and stuff.
+
+#define CNX(_widg,_signame) \
+    g_signal_connect (GTK_OBJECT(WID(_widg)), _signame,                \
+                      GTK_SIGNAL_FUNC(gui_update), gpointer(myDialog));
+
+    CNX (operationMenu, &quot;changed&quot;);
+    CNX (inputTypeMenu, &quot;changed&quot;);
+
+    CNX (convolutionInputFileChooser, &quot;selection_changed&quot;);
+    CNX (imageInputFileChooser, &quot;selection_changed&quot;);
+
+    CNX (constantValueSpinButton, &quot;value_changed&quot;);
+    CNX (rollingAvgAlphaDenomSpinButton, &quot;value_changed&quot;);
+    CNX (rollingAvgInitTypeMenu, &quot;changed&quot;);
+    CNX (rollingAvgInitStartSpinButton, &quot;value_changed&quot;);
+    CNX (rollingAvgInitEndSpinButton, &quot;value_changed&quot;);
+
+    CNX (biasSpinner, &quot;value_changed&quot;);
+
+#define GETSPINADJ(_spinwidg) \
+    gtk_spin_button_get_adjustment (GTK_SPIN_BUTTON (WID (_spinwidg)))
+
+#define MK_PVSI(_basename) \
+    new PixelValueScalingInfo                                \
+        (GETSPINADJ(_basename ## ScalingAddSpinButton),      \
+         GETSPINADJ(_basename ## ScalingMultSpinButton),     \
+         GETSPINADJ(_basename ## ScalingMinSpinner),         \
+         GETSPINADJ(_basename ## ScalingMaxSpinner),         \
+         myDialog)
+
+    PixelValueScalingInfo * ifsi = MK_PVSI (imageFile);
+    PixelValueScalingInfo * ressi = MK_PVSI (result);
+
+#define SCALSIG(_widg, _scalinfo) \
+    g_signal_connect (GTK_OBJECT (GETSPINADJ (_widg)),             \
+                      &quot;value_changed&quot;,                             \
+                      GTK_SIGNAL_FUNC(updateScalingStuff),         \
+                      gpointer (_scalinfo))
+
+#define SCALSIGS(_basename, _scalinfo) \
+    do { \
+        SCALSIG(_basename ## ScalingAddSpinButton, _scalinfo);        \
+        SCALSIG(_basename ## ScalingMultSpinButton, _scalinfo);       \
+        SCALSIG(_basename ## ScalingMinSpinner, _scalinfo);           \
+        SCALSIG(_basename ## ScalingMaxSpinner, _scalinfo);           \
+        updateScalingStuff                                            \
+            (GETSPINADJ(_basename ## ScalingAddSpinButton),           \
+             gpointer (_scalinfo));                                   \
+    } while (0)
+
+    SCALSIGS (imageFile, ifsi);
+    SCALSIGS (result, ressi);
+
+#if 0
+// we now do this one manually (called from updateScalingStuff()) to avoid
+// multiple screen updates (can be slow), such as for adjustments to min which
+// causes propagation to some of the other fields).
+#define SCALCNX(_basename) \
+    do { \
+        CNX (_basename ## ScalingAddSpinButton, &quot;value_changed&quot;); \
+        CNX (_basename ## ScalingMultSpinButton, &quot;value_changed&quot;); \
+        /* CNX (_basename ## ScalingMinSpinner, &quot;value_changed&quot;); */    \
+        /* CNX (_basename ## ScalingMaxSpinner, &quot;value_changed&quot;); */    \
+    } while (0)
+
+    SCALCNX (imageFile);
+    SCALCNX (result);
+#endif
+
+    // Also histogram and debugging settings, but these don't affect the
+    // preview output.  However, we should update the config description when
+    // they change.
+
+    g_signal_connect (GTK_OBJECT(WID(histogramSpinButton)), &quot;value_changed&quot;,
+                      GTK_SIGNAL_FUNC(updateConfigDescription),
+                      gpointer(myDialog));
+    g_signal_connect (GTK_OBJECT(WID(debugSpinButton)), &quot;value_changed&quot;,
+                      GTK_SIGNAL_FUNC(updateConfigDescription),
+                      gpointer(myDialog));
+
+    // Reshuffle what is and isn't displayed when the user selects a different
+    // input.
+
+    g_signal_connect(GTK_OBJECT(WID(inputTypeMenu)), &quot;changed&quot;,
+                     GTK_SIGNAL_FUNC(inputTypeChange), gpointer(myDialog));
+    inputTypeChange (GTK_COMBO_BOX(WID(inputTypeMenu)), gpointer(myDialog));
+
+    // preview stuff:
+
+    g_signal_connect (GTK_OBJECT(WID(previewSlider)), &quot;value_changed&quot;,
+                      GTK_SIGNAL_FUNC(frame_changed), gpointer(myDialog));
+    g_signal_connect (GTK_OBJECT(WID(previewVideo)), &quot;expose_event&quot;,
+                      GTK_SIGNAL_FUNC(gui_draw), gpointer(myDialog));
+
+    g_signal_connect (GTK_OBJECT(WID(previewEnableButton)), &quot;toggled&quot;,
+                      GTK_SIGNAL_FUNC(previewEnableButton),
+                      gpointer(myDialog));
+   
+    previewEnableButton (GTK_TOGGLE_BUTTON(WID(previewEnableButton)),
+                         gpointer(myDialog));
+
+    g_signal_connect (GTK_OBJECT(WID(previewVideo)), &quot;button_press_event&quot;,
+                      GTK_SIGNAL_FUNC(previewButtonEvent),
+                      gpointer(myDialog));
+#if 0
+    g_signal_connect (GTK_OBJECT(WID(previewVideo)), &quot;motion_notify_event&quot;,
+                      GTK_SIGNAL_FUNC(previewMotionEvent),
+                      gpointer(myDialog));
+#endif
+
+    uint8_t ret = 0;
+    int response = gtk_dialog_run(GTK_DIALOG(dialog));
+
+    if (response == GTK_RESPONSE_OK)
+    {
+        myDialog-&gt;download();
+        myDialog-&gt;getParam (param);
+        ret = 1;
+    }
+
+    gtk_unregister_dialog(dialog);
+    gtk_widget_destroy(dialog);
+
+    delete ressi;
+    delete ifsi;
+    delete myDialog;
+
+    return ret;
+}
+
+void frame_changed (GtkRange *, gpointer user_data)
+{
+    flySwissArmyKnife * myDialog
+        = static_cast &lt;flySwissArmyKnife *&gt; (user_data);
+
+    myDialog-&gt;sliderChanged();
+}
+
+void gui_update (GtkObject *, gpointer user_data)
+{
+    if (lock)
+        return;
+
+    flySwissArmyKnife * myDialog
+        = static_cast &lt;flySwissArmyKnife *&gt; (user_data);
+    myDialog-&gt;updateConfigDescription (true);
+    myDialog-&gt;update();
+}
+
+gboolean gui_draw (GtkWidget * widget, GdkEventExpose * event, gpointer user_data)
+{
+    flySwissArmyKnife * myDialog
+        = static_cast &lt;flySwissArmyKnife *&gt; (user_data);
+    myDialog-&gt;display();
+    return TRUE;
+}
+
+/**************************************/
+
+uint8_t flySwissArmyKnife::upload (void)
+{
+    lock++;
+
+    gtk_file_chooser_set_filename
+        (GTK_FILE_CHOOSER(WID(convolutionInputFileChooser)),
+         param.input_file.c_str());
+
+    gtk_file_chooser_set_filename
+        (GTK_FILE_CHOOSER(WID(imageInputFileChooser)),
+         param.input_file.c_str());
+    gtk_spin_button_set_value
+        (GTK_SPIN_BUTTON(WID(imageFileScalingAddSpinButton)),
+         param.load_bias);
+    gtk_spin_button_set_value
+        (GTK_SPIN_BUTTON(WID(imageFileScalingMultSpinButton)),
+         param.load_multiplier);
+
+    gtk_spin_button_set_value
+        (GTK_SPIN_BUTTON(WID(constantValueSpinButton)), param.input_constant);
+
+    gtk_spin_button_set_value
+        (GTK_SPIN_BUTTON(WID(rollingAvgAlphaSpinButton)),
+         param.memory_constant_alpha);
+    gtk_combo_box_set_active
+        (GTK_COMBO_BOX(WID(rollingAvgInitTypeMenu)), param.init_by_rolling);
+    gtk_spin_button_set_value
+        (GTK_SPIN_BUTTON(WID(rollingAvgInitStartSpinButton)),
+         param.init_start_frame);
+    gtk_spin_button_set_value
+        (GTK_SPIN_BUTTON(WID(rollingAvgInitEndSpinButton)),
+         param.init_end_frame);
+
+    gtk_spin_button_set_value
+        (GTK_SPIN_BUTTON(WID(biasSpinner)), param.bias);
+
+    gtk_spin_button_set_value
+        (GTK_SPIN_BUTTON(WID(resultScalingAddSpinButton)),
+         param.result_bias);
+    gtk_spin_button_set_value
+        (GTK_SPIN_BUTTON(WID(resultScalingMultSpinButton)),
+         param.result_multiplier);
+
+    gtk_spin_button_set_value
+        (GTK_SPIN_BUTTON(WID(histogramSpinButton)),
+         param.histogram_frame_interval);
+    gtk_spin_button_set_value
+        (GTK_SPIN_BUTTON(WID(debugSpinButton)), param.debug);
+
+    gtk_toggle_button_set_active
+        (GTK_TOGGLE_BUTTON(WID(previewEnableButton)), param.enable_preview);
+
+    updateConfigDescription (false);
+
+    lock--;
+    return 1;
+}
+
+uint8_t flySwissArmyKnife::download (void)
+{
+    getMenuValues();
+
+    const char * filename =
+        gtk_file_chooser_get_filename
+        (GTK_FILE_CHOOSER((param.input_type ==
+                           ADMVideoSwissArmyKnife::INPUT_CUSTOM_CONVOLUTION)
+                          ? WID(convolutionInputFileChooser)
+                          : WID(imageInputFileChooser)));
+    if (filename)
+    {
+        // gtk has its own allocator, and allocations from it should not be
+        // intermixed with allocations from adm, lest heap corruption result!
+        param.input_file = filename;
+        g_free (const_cast &lt;char *&gt; (filename));
+    }
+    else
+        param.input_file = &quot;&quot;;
+
+    param.load_bias
+        = gtk_spin_button_get_value
+        (GTK_SPIN_BUTTON(WID(imageFileScalingAddSpinButton)));
+    param.load_multiplier
+        = gtk_spin_button_get_value
+        (GTK_SPIN_BUTTON(WID(imageFileScalingMultSpinButton)));
+
+    param.input_constant
+        = gtk_spin_button_get_value
+        (GTK_SPIN_BUTTON(WID(constantValueSpinButton)));
+
+    param.memory_constant_alpha
+        = gtk_spin_button_get_value
+        (GTK_SPIN_BUTTON(WID(rollingAvgAlphaSpinButton)));
+    param.init_by_rolling
+        = gtk_combo_box_get_active
+        (GTK_COMBO_BOX(WID(rollingAvgInitTypeMenu)));
+    param.init_start_frame
+        = gtk_spin_button_get_value_as_int
+        (GTK_SPIN_BUTTON(WID(rollingAvgInitStartSpinButton)));
+    param.init_end_frame
+        = gtk_spin_button_get_value_as_int
+        (GTK_SPIN_BUTTON(WID(rollingAvgInitEndSpinButton)));
+
+    param.bias
+        = gtk_spin_button_get_value_as_int
+        (GTK_SPIN_BUTTON(WID(biasSpinner)));
+
+    param.result_bias
+        = gtk_spin_button_get_value
+        (GTK_SPIN_BUTTON(WID(resultScalingAddSpinButton)));
+    param.result_multiplier
+        = gtk_spin_button_get_value
+        (GTK_SPIN_BUTTON(WID(resultScalingMultSpinButton)));
+
+    param.histogram_frame_interval
+        = gtk_spin_button_get_value_as_int
+        (GTK_SPIN_BUTTON(WID(histogramSpinButton)));
+    param.debug
+        = gtk_spin_button_get_value_as_int
+        (GTK_SPIN_BUTTON(WID(debugSpinButton)));
+
+    param.enable_preview
+        = gtk_toggle_button_get_active
+        (GTK_TOGGLE_BUTTON(WID(previewEnableButton)));
+
+    return 1;
+}
+
+void flySwissArmyKnife::wipeOutputBuffer ()
+{
+    // printf (&quot;wiping output buffer\n&quot;);
+    uint32_t pixelcount = _w * _h;
+    uint32_t * outp = reinterpret_cast &lt;uint32_t *&gt;
+                      (YPLANE (_yuvBufferOut) + pixelcount);
+    uint32_t intcount = pixelcount / 4 + 1;
+    uint32_t value = 0x60;
+    while (--intcount)
+    {
+        *--outp = value;
+        value = value &gt;&gt; 8 | ((value &amp; 0xff) &lt;&lt; 24);
+    }
+
+    memset (UPLANE (_yuvBufferOut), 128, pixelcount &gt;&gt; 2);
+    memset (VPLANE (_yuvBufferOut), 128, pixelcount &gt;&gt; 2);
+}
+
+#define _(_str) QT_TR_NOOP(_str)
+
+// The following was generated by glade from swissarmyknife.glade once upon a
+// time (in fact, many times, since it took quite a few tries to get it right!
+// :-).  Thus far, I've avoided editing it, so regenerating the code from
+// Glade (I used 2.12.1) and swapping it in here should not lose anything.
+// All the tweaking and adjusting and signal-connecting is done in code above,
+// which is maintained by hand, and which has much knowledge of the names and
+// layout of the widgets (so be cautious about renaming things!).
+
+GtkWidget*
+create_swiss_army_knife_dialog (void)
+{
+  GtkWidget *swiss_army_knife_dialog;
+  GtkWidget *dialogVbox;
+  GtkWidget *dialogHbox;
+  GtkWidget *allSettingsVbox;
+  GtkWidget *settingsOuterHbox;
+  GtkWidget *settingsOuterVbox;
+  GtkWidget *operationHbox;
+  GtkWidget *operationLabel;
+  GtkWidget *operationMenu;
+  GtkWidget *inputTypeHbox;
+  GtkWidget *inputTypeLabel;
+  GtkWidget *inputTypeMenu;
+  GtkWidget *topSeparator;
+  GtkWidget *convolutionSettingsVbox;
+  GtkWidget *convolutionInputFileHbox;
+  GtkWidget *convolutionInputFileLabel;
+  GtkWidget *convolutionInputFileChooser;
+  GtkWidget *imageFileSettingsVbox;
+  GtkWidget *imageInputFileHbox;
+  GtkWidget *imageInputFileLabel;
+  GtkWidget *imageInputFileChooser;
+  GtkWidget *imageFileScalingFrame;
+  GtkWidget *imageFileScalingAlignment;
+  GtkWidget *imageFileScalingVbox;
+  GtkWidget *imageFileScalingAddHbox;
+  GtkWidget *imageFileScalingAddLabel;
+  GtkObject *imageFileScalingAddSpinButton_adj;
+  GtkWidget *imageFileScalingAddSpinButton;
+  GtkWidget *imageFileScalingMultHbox;
+  GtkWidget *imageFileScalingMultLabel;
+  GtkObject *imageFileScalingMultSpinButton_adj;
+  GtkWidget *imageFileScalingMultSpinButton;
+  GtkWidget *imageFileScalingMinVbox;
+  GtkWidget *imageFileScalingMinLabel;
+  GtkWidget *imageFileScalingMinHbox;
+  GtkWidget *imageFileScalingMinSlider;
+  GtkObject *imageFileScalingMinSpinner_adj;
+  GtkWidget *imageFileScalingMinSpinner;
+  GtkWidget *imageFileScalingMaxVbox;
+  GtkWidget *imageFileScalingMaxLabel;
+  GtkWidget *imageFileScalingMaxHbox;
+  GtkWidget *imageFileScalingMaxSlider;
+  GtkObject *imageFileScalingMaxSpinner_adj;
+  GtkWidget *imageFileScalingMaxSpinner;
+  GtkWidget *imageFileScalingFrameLabel;
+  GtkWidget *constantSettingsVbox;
+  GtkWidget *constantValueHbox;
+  GtkWidget *constantValueLabel;
+  GtkObject *constantValueSpinButton_adj;
+  GtkWidget *constantValueSpinButton;
+  GtkWidget *rollingAvgSettingsVbox;
+  GtkWidget *rollingAvgAlphaHbox;
+  GtkWidget *rollingAvgAlphaLabel;
+  GtkObject *rollingAvgAlphaSpinButton_adj;
+  GtkWidget *rollingAvgAlphaSpinButton;
+  GtkWidget *rollingAvgAlphaEqualsLabel;
+  GtkObject *rollingAvgAlphaDenomSpinButton_adj;
+  GtkWidget *rollingAvgAlphaDenomSpinButton;
+  GtkWidget *rollingAvgInitVbox;
+  GtkWidget *rollingAvgInitHbox1;
+  GtkWidget *rollingAvgInitLabel1;
+  GtkWidget *rollingAvgInitTypeMenu;
+  GtkWidget *rollingAvgInitLabel2;
+  GtkWidget *rollingAvgInitHbox2;
+  GtkWidget *rollingAvgInitLabel3;
+  GtkObject *rollingAvgInitStartSpinButton_adj;
+  GtkWidget *rollingAvgInitStartSpinButton;
+  GtkWidget *rollingAvgInitLabel4;
+  GtkObject *rollingAvgInitEndSpinButton_adj;
+  GtkWidget *rollingAvgInitEndSpinButton;
+  GtkWidget *bottomSeparator;
+  GtkWidget *biasVbox;
+  GtkWidget *biasLabel;
+  GtkWidget *biasHbox;
+  GtkWidget *biasSlider;
+  GtkObject *biasSpinner_adj;
+  GtkWidget *biasSpinner;
+  GtkWidget *resultScalingFrame;
+  GtkWidget *resultScalingAlignment;
+  GtkWidget *resultScalingVbox;
+  GtkWidget *resultScalingAddHbox;
+  GtkWidget *resultScalingAddLabel;
+  GtkObject *resultScalingAddSpinButton_adj;
+  GtkWidget *resultScalingAddSpinButton;
+  GtkWidget *resultScalingMultHbox;
+  GtkWidget *resultScalingMultLabel;
+  GtkObject *resultScalingMultSpinButton_adj;
+  GtkWidget *resultScalingMultSpinButton;
+  GtkWidget *resultScalingMinVbox;
+  GtkWidget *resultScalingMinLabel;
+  GtkWidget *resultScalingMinHbox;
+  GtkWidget *resultScalingMinSlider;
+  GtkObject *resultScalingMinSpinner_adj;
+  GtkWidget *resultScalingMinSpinner;
+  GtkWidget *resultScalingMaxVbox;
+  GtkWidget *resultScalingMaxLabel;
+  GtkWidget *resultScalingMaxHbox;
+  GtkWidget *resultScalingMaxSlider;
+  GtkObject *resultScalingMaxSpinner_adj;
+  GtkWidget *resultScalingMaxSpinner;
+  GtkWidget *resultScalingFrameLabel;
+  GtkWidget *hseparator2;
+  GtkWidget *currentConfigDescription;
+  GtkWidget *hseparator1;
+  GtkWidget *histogramHbox;
+  GtkWidget *histogramLabel;
+  GtkObject *histogramSpinButton_adj;
+  GtkWidget *histogramSpinButton;
+  GtkWidget *debugHbox;
+  GtkWidget *debugLabel;
+  GtkObject *debugSpinButton_adj;
+  GtkWidget *debugSpinButton;
+  GtkWidget *previewVboxOuter;
+  GtkWidget *previewFrame;
+  GtkWidget *previewAlignment;
+  GtkWidget *previewVbox;
+  GtkWidget *previewControlHbox;
+  GtkWidget *previewOutputMenu;
+  GtkWidget *previewSlider;
+  GtkWidget *previewVideo;
+  GtkWidget *previewDisabled;
+  GtkWidget *previewLabel;
+  GtkWidget *previewEnableButtonHbox;
+  GtkWidget *previewEnableButton;
+  GtkWidget *dialogButtonBox;
+  GtkWidget *cancelButton;
+  GtkWidget *okButton;
+
+  swiss_army_knife_dialog = gtk_dialog_new ();
+  gtk_window_set_title (GTK_WINDOW (swiss_army_knife_dialog), _(&quot;Swiss Army Knife&quot;));
+  gtk_window_set_type_hint (GTK_WINDOW (swiss_army_knife_dialog), GDK_WINDOW_TYPE_HINT_DIALOG);
+
+  dialogVbox = GTK_DIALOG (swiss_army_knife_dialog)-&gt;vbox;
+  gtk_widget_show (dialogVbox);
+
+  dialogHbox = gtk_hbox_new (FALSE, 0);
+  gtk_widget_show (dialogHbox);
+  gtk_box_pack_start (GTK_BOX (dialogVbox), dialogHbox, TRUE, TRUE, 0);
+
+  allSettingsVbox = gtk_vbox_new (FALSE, 12);
+  gtk_widget_show (allSettingsVbox);
+  gtk_box_pack_start (GTK_BOX (dialogHbox), allSettingsVbox, TRUE, TRUE, 0);
+  gtk_container_set_border_width (GTK_CONTAINER (allSettingsVbox), 8);
+
+  settingsOuterHbox = gtk_hbox_new (FALSE, 0);
+  gtk_widget_show (settingsOuterHbox);
+  gtk_box_pack_start (GTK_BOX (allSettingsVbox), settingsOuterHbox, FALSE, TRUE, 0);
+
+  settingsOuterVbox = gtk_vbox_new (FALSE, 12);
+  gtk_widget_show (settingsOuterVbox);
+  gtk_box_pack_start (GTK_BOX (settingsOuterHbox), settingsOuterVbox, TRUE, TRUE, 0);
+
+  operationHbox = gtk_hbox_new (FALSE, 0);
+  gtk_widget_show (operationHbox);
+  gtk_box_pack_start (GTK_BOX (settingsOuterVbox), operationHbox, TRUE, TRUE, 0);
+
+  operationLabel = gtk_label_new_with_mnemonic (_(&quot;Select _Operation on each pixel P and input A:   &quot;));
+  gtk_widget_show (operationLabel);
+  gtk_box_pack_start (GTK_BOX (operationHbox), operationLabel, FALSE, FALSE, 0);
+
+  operationMenu = gtk_combo_box_new_text ();
+  gtk_widget_show (operationMenu);
+  gtk_box_pack_start (GTK_BOX (operationHbox), operationMenu, TRUE, TRUE, 0);
+
+  inputTypeHbox = gtk_hbox_new (FALSE, 0);
+  gtk_widget_show (inputTypeHbox);
+  gtk_box_pack_start (GTK_BOX (settingsOuterVbox), inputTypeHbox, TRUE, TRUE, 0);
+
+  inputTypeLabel = gtk_label_new_with_mnemonic (_(&quot;Input _Type:   &quot;));
+  gtk_widget_show (inputTypeLabel);
+  gtk_box_pack_start (GTK_BOX (inputTypeHbox), inputTypeLabel, FALSE, FALSE, 0);
+
+  inputTypeMenu = gtk_combo_box_new_text ();
+  gtk_widget_show (inputTypeMenu);
+  gtk_box_pack_start (GTK_BOX (inputTypeHbox), inputTypeMenu, TRUE, TRUE, 0);
+
+  topSeparator = gtk_hseparator_new ();
+  gtk_widget_show (topSeparator);
+  gtk_box_pack_start (GTK_BOX (settingsOuterVbox), topSeparator, TRUE, TRUE, 0);
+
+  convolutionSettingsVbox = gtk_vbox_new (FALSE, 6);
+  gtk_box_pack_start (GTK_BOX (settingsOuterVbox), convolutionSettingsVbox, TRUE, TRUE, 0);
+
+  convolutionInputFileHbox = gtk_hbox_new (FALSE, 0);
+  gtk_widget_show (convolutionInputFileHbox);
+  gtk_box_pack_start (GTK_BOX (convolutionSettingsVbox), convolutionInputFileHbox, TRUE, TRUE, 0);
+
+  convolutionInputFileLabel = gtk_label_new_with_mnemonic (_(&quot;Input _File (convolution kernel):   &quot;));
+  gtk_widget_show (convolutionInputFileLabel);
+  gtk_box_pack_start (GTK_BOX (convolutionInputFileHbox), convolutionInputFileLabel, FALSE, FALSE, 0);
+
+  convolutionInputFileChooser = gtk_file_chooser_button_new (_(&quot;Select Convolution Kernel File&quot;), GTK_FILE_CHOOSER_ACTION_OPEN);
+  gtk_widget_show (convolutionInputFileChooser);
+  gtk_box_pack_start (GTK_BOX (convolutionInputFileHbox), convolutionInputFileChooser, TRUE, TRUE, 0);
+
+  imageFileSettingsVbox = gtk_vbox_new (FALSE, 6);
+  gtk_box_pack_start (GTK_BOX (settingsOuterVbox), imageFileSettingsVbox, TRUE, TRUE, 0);
+
+  imageInputFileHbox = gtk_hbox_new (FALSE, 0);
+  gtk_widget_show (imageInputFileHbox);
+  gtk_box_pack_start (GTK_BOX (imageFileSettingsVbox), imageInputFileHbox, TRUE, TRUE, 0);
+
+  imageInputFileLabel = gtk_label_new_with_mnemonic (_(&quot;Input _File (image file):   &quot;));
+  gtk_widget_show (imageInputFileLabel);
+  gtk_box_pack_start (GTK_BOX (imageInputFileHbox), imageInputFileLabel, FALSE, FALSE, 0);
+
+  imageInputFileChooser = gtk_file_chooser_button_new (_(&quot;Select Convolution Kernel File&quot;), GTK_FILE_CHOOSER_ACTION_OPEN);
+  gtk_widget_show (imageInputFileChooser);
+  gtk_box_pack_start (GTK_BOX (imageInputFileHbox), imageInputFileChooser, TRUE, TRUE, 0);
+
+  imageFileScalingFrame = gtk_frame_new (NULL);
+  gtk_widget_show (imageFileScalingFrame);
+  gtk_box_pack_start (GTK_BOX (imageFileSettingsVbox), imageFileScalingFrame, TRUE, TRUE, 0);
+  gtk_frame_set_shadow_type (GTK_FRAME (imageFileScalingFrame), GTK_SHADOW_IN);
+
+  imageFileScalingAlignment = gtk_alignment_new (0.5, 0.5, 1, 1);
+  gtk_widget_show (imageFileScalingAlignment);
+  gtk_container_add (GTK_CONTAINER (imageFileScalingFrame), imageFileScalingAlignment);
+  gtk_alignment_set_padding (GTK_ALIGNMENT (imageFileScalingAlignment), 2, 6, 6, 6);
+
+  imageFileScalingVbox = gtk_vbox_new (FALSE, 6);
+  gtk_widget_show (imageFileScalingVbox);
+  gtk_container_add (GTK_CONTAINER (imageFileScalingAlignment), imageFileScalingVbox);
+
+  imageFileScalingAddHbox = gtk_hbox_new (FALSE, 0);
+  gtk_widget_show (imageFileScalingAddHbox);
+  gtk_box_pack_start (GTK_BOX (imageFileScalingVbox), imageFileScalingAddHbox, TRUE, TRUE, 0);
+
+  imageFileScalingAddLabel = gtk_label_new_with_mnemonic (_(&quot;First, _add to each float pixel value:   &quot;));
+  gtk_widget_show (imageFileScalingAddLabel);
+  gtk_box_pack_start (GTK_BOX (imageFileScalingAddHbox), imageFileScalingAddLabel, FALSE, FALSE, 0);
+
+  imageFileScalingAddSpinButton_adj = gtk_adjustment_new (0, -99999, 99999, 0.10000000149, 1, 0);
+  imageFileScalingAddSpinButton = gtk_spin_button_new (GTK_ADJUSTMENT (imageFileScalingAddSpinButton_adj), 1, 5);
+  gtk_widget_show (imageFileScalingAddSpinButton);
+  gtk_box_pack_start (GTK_BOX (imageFileScalingAddHbox), imageFileScalingAddSpinButton, TRUE, TRUE, 0);
+  gtk_spin_button_set_numeric (GTK_SPIN_BUTTON (imageFileScalingAddSpinButton), TRUE);
+
+  imageFileScalingMultHbox = gtk_hbox_new (FALSE, 0);
+  gtk_widget_show (imageFileScalingMultHbox);
+  gtk_box_pack_start (GTK_BOX (imageFileScalingVbox), imageFileScalingMultHbox, TRUE, TRUE, 0);
+
+  imageFileScalingMultLabel = gtk_label_new_with_mnemonic (_(&quot;Then, _multiply each float pixel value by:   &quot;));
+  gtk_widget_show (imageFileScalingMultLabel);
+  gtk_box_pack_start (GTK_BOX (imageFileScalingMultHbox), imageFileScalingMultLabel, FALSE, FALSE, 0);
+
+  imageFileScalingMultSpinButton_adj = gtk_adjustment_new (1, -99999, 99999, 0.0010000000475, 0.0010000000475, 0);
+  imageFileScalingMultSpinButton = gtk_spin_button_new (GTK_ADJUSTMENT (imageFileScalingMultSpinButton_adj), 1, 5);
+  gtk_widget_show (imageFileScalingMultSpinButton);
+  gtk_box_pack_start (GTK_BOX (imageFileScalingMultHbox), imageFileScalingMultSpinButton, TRUE, TRUE, 0);
+  gtk_spin_button_set_numeric (GTK_SPIN_BUTTON (imageFileScalingMultSpinButton), TRUE);
+
+  imageFileScalingMinVbox = gtk_vbox_new (FALSE, 0);
+  gtk_widget_show (imageFileScalingMinVbox);
+  gtk_box_pack_start (GTK_BOX (imageFileScalingVbox), imageFileScalingMinVbox, TRUE, TRUE, 0);
+
+  imageFileScalingMinLabel = gtk_label_new_with_mnemonic (_(&quot;Mi_nimum loaded pixel value (will be scaled to 0):&quot;));
+  gtk_widget_show (imageFileScalingMinLabel);
+  gtk_box_pack_start (GTK_BOX (imageFileScalingMinVbox), imageFileScalingMinLabel, FALSE, FALSE, 0);
+  gtk_misc_set_alignment (GTK_MISC (imageFileScalingMinLabel), 0, 0.5);
+
+  imageFileScalingMinHbox = gtk_hbox_new (FALSE, 5);
+  gtk_widget_show (imageFileScalingMinHbox);
+  gtk_box_pack_start (GTK_BOX (imageFileScalingMinVbox), imageFileScalingMinHbox, TRUE, TRUE, 0);
+
+  imageFileScalingMinSlider = gtk_hscale_new (GTK_ADJUSTMENT (gtk_adjustment_new (0, -1024, 1024, 1, 1, 0)));
+  gtk_widget_show (imageFileScalingMinSlider);
+  gtk_box_pack_start (GTK_BOX (imageFileScalingMinHbox), imageFileScalingMinSlider, TRUE, TRUE, 0);
+  gtk_scale_set_draw_value (GTK_SCALE (imageFileScalingMinSlider), FALSE);
+  gtk_scale_set_value_pos (GTK_SCALE (imageFileScalingMinSlider), GTK_POS_LEFT);
+  gtk_scale_set_digits (GTK_SCALE (imageFileScalingMinSlider), 0);
+
+  imageFileScalingMinSpinner_adj = gtk_adjustment_new (0, -1024, 1024, 1, 2, 0);
+  imageFileScalingMinSpinner = gtk_spin_button_new (GTK_ADJUSTMENT (imageFileScalingMinSpinner_adj), 1, 1);
+  gtk_widget_show (imageFileScalingMinSpinner);
+  gtk_box_pack_start (GTK_BOX (imageFileScalingMinHbox), imageFileScalingMinSpinner, FALSE, TRUE, 0);
+  gtk_spin_button_set_numeric (GTK_SPIN_BUTTON (imageFileScalingMinSpinner), TRUE);
+
+  imageFileScalingMaxVbox = gtk_vbox_new (FALSE, 0);
+  gtk_widget_show (imageFileScalingMaxVbox);
+  gtk_box_pack_start (GTK_BOX (imageFileScalingVbox), imageFileScalingMaxVbox, TRUE, TRUE, 0);
+
+  imageFileScalingMaxLabel = gtk_label_new_with_mnemonic (_(&quot;Ma_ximum loaded pixel value (will be scaled to 255):&quot;));
+  gtk_widget_show (imageFileScalingMaxLabel);
+  gtk_box_pack_start (GTK_BOX (imageFileScalingMaxVbox), imageFileScalingMaxLabel, FALSE, FALSE, 0);
+  gtk_misc_set_alignment (GTK_MISC (imageFileScalingMaxLabel), 0, 0.5);
+
+  imageFileScalingMaxHbox = gtk_hbox_new (FALSE, 5);
+  gtk_widget_show (imageFileScalingMaxHbox);
+  gtk_box_pack_start (GTK_BOX (imageFileScalingMaxVbox), imageFileScalingMaxHbox, TRUE, TRUE, 0);
+
+  imageFileScalingMaxSlider = gtk_hscale_new (GTK_ADJUSTMENT (gtk_adjustment_new (255, -1024, 1024, 1, 1, 0)));
+  gtk_widget_show (imageFileScalingMaxSlider);
+  gtk_box_pack_start (GTK_BOX (imageFileScalingMaxHbox), imageFileScalingMaxSlider, TRUE, TRUE, 0);
+  gtk_scale_set_draw_value (GTK_SCALE (imageFileScalingMaxSlider), FALSE);
+  gtk_scale_set_value_pos (GTK_SCALE (imageFileScalingMaxSlider), GTK_POS_LEFT);
+  gtk_scale_set_digits (GTK_SCALE (imageFileScalingMaxSlider), 0);
+
+  imageFileScalingMaxSpinner_adj = gtk_adjustment_new (255, -1024, 1024, 1, 2, 0);
+  imageFileScalingMaxSpinner = gtk_spin_button_new (GTK_ADJUSTMENT (imageFileScalingMaxSpinner_adj), 1, 1);
+  gtk_widget_show (imageFileScalingMaxSpinner);
+  gtk_box_pack_start (GTK_BOX (imageFileScalingMaxHbox), imageFileScalingMaxSpinner, FALSE, TRUE, 0);
+  gtk_spin_button_set_numeric (GTK_SPIN_BUTTON (imageFileScalingMaxSpinner), TRUE);
+
+  imageFileScalingFrameLabel = gtk_label_new (_(&quot;Pixel Value Scaling as Image File is Loaded&quot;));
+  gtk_widget_show (imageFileScalingFrameLabel);
+  gtk_frame_set_label_widget (GTK_FRAME (imageFileScalingFrame), imageFileScalingFrameLabel);
+  gtk_label_set_use_markup (GTK_LABEL (imageFileScalingFrameLabel), TRUE);
+
+  constantSettingsVbox = gtk_vbox_new (FALSE, 6);
+  gtk_box_pack_start (GTK_BOX (settingsOuterVbox), constantSettingsVbox, TRUE, TRUE, 0);
+
+  constantValueHbox = gtk_hbox_new (FALSE, 0);
+  gtk_widget_show (constantValueHbox);
+  gtk_box_pack_start (GTK_BOX (constantSettingsVbox), constantValueHbox, TRUE, TRUE, 0);
+
+  constantValueLabel = gtk_label_new_with_mnemonic (_(&quot;Input _Constant:      &quot;));
+  gtk_widget_show (constantValueLabel);
+  gtk_box_pack_start (GTK_BOX (constantValueHbox), constantValueLabel, FALSE, FALSE, 0);
+
+  constantValueSpinButton_adj = gtk_adjustment_new (0, -99999, 99999, 0.10000000149, 1, 0);
+  constantValueSpinButton = gtk_spin_button_new (GTK_ADJUSTMENT (constantValueSpinButton_adj), 1, 3);
+  gtk_widget_show (constantValueSpinButton);
+  gtk_box_pack_start (GTK_BOX (constantValueHbox), constantValueSpinButton, TRUE, TRUE, 0);
+  gtk_spin_button_set_numeric (GTK_SPIN_BUTTON (constantValueSpinButton), TRUE);
+
+  rollingAvgSettingsVbox = gtk_vbox_new (FALSE, 6);
+  gtk_box_pack_start (GTK_BOX (settingsOuterVbox), rollingAvgSettingsVbox, TRUE, TRUE, 0);
+
+  rollingAvgAlphaHbox = gtk_hbox_new (FALSE, 0);
+  gtk_widget_show (rollingAvgAlphaHbox);
+  gtk_box_pack_start (GTK_BOX (rollingAvgSettingsVbox), rollingAvgAlphaHbox, TRUE, TRUE, 0);
+
+  rollingAvgAlphaLabel = gtk_label_new_with_mnemonic (_(&quot;Memory constant _alpha:   &quot;));
+  gtk_widget_show (rollingAvgAlphaLabel);
+  gtk_box_pack_start (GTK_BOX (rollingAvgAlphaHbox), rollingAvgAlphaLabel, FALSE, TRUE, 0);
+
+  rollingAvgAlphaSpinButton_adj = gtk_adjustment_new (0.00999999977648, 9.99999996004e-12, 999, 0.0010000000475, 0.0010000000475, 0);
+  rollingAvgAlphaSpinButton = gtk_spin_button_new (GTK_ADJUSTMENT (rollingAvgAlphaSpinButton_adj), 1, 5);
+  gtk_widget_show (rollingAvgAlphaSpinButton);
+  gtk_box_pack_start (GTK_BOX (rollingAvgAlphaHbox), rollingAvgAlphaSpinButton, FALSE, TRUE, 0);
+  gtk_spin_button_set_numeric (GTK_SPIN_BUTTON (rollingAvgAlphaSpinButton), TRUE);
+
+  rollingAvgAlphaEqualsLabel = gtk_label_new (_(&quot; = 1 / &quot;));
+  gtk_widget_show (rollingAvgAlphaEqualsLabel);
+  gtk_box_pack_start (GTK_BOX (rollingAvgAlphaHbox), rollingAvgAlphaEqualsLabel, FALSE, FALSE, 0);
+
+  rollingAvgAlphaDenomSpinButton_adj = gtk_adjustment_new (100, 0.0010000000475, 99999, 1, 1, 0);
+  rollingAvgAlphaDenomSpinButton = gtk_spin_button_new (GTK_ADJUSTMENT (rollingAvgAlphaDenomSpinButton_adj), 1, 4);
+  gtk_widget_show (rollingAvgAlphaDenomSpinButton);
+  gtk_box_pack_start (GTK_BOX (rollingAvgAlphaHbox), rollingAvgAlphaDenomSpinButton, FALSE, TRUE, 0);
+  gtk_spin_button_set_numeric (GTK_SPIN_BUTTON (rollingAvgAlphaDenomSpinButton), TRUE);
+
+  rollingAvgInitVbox = gtk_vbox_new (FALSE, 0);
+  gtk_widget_show (rollingAvgInitVbox);
+  gtk_box_pack_start (GTK_BOX (rollingAvgSettingsVbox), rollingAvgInitVbox, TRUE, TRUE, 0);
+
+  rollingAvgInitHbox1 = gtk_hbox_new (FALSE, 0);
+  gtk_widget_show (rollingAvgInitHbox1);
+  gtk_box_pack_start (GTK_BOX (rollingAvgInitVbox), rollingAvgInitHbox1, TRUE, TRUE, 0);
+
+  rollingAvgInitLabel1 = gtk_label_new_with_mnemonic (_(&quot;_Initial average (\&quot;head start\&quot;) is &quot;));
+  gtk_widget_show (rollingAvgInitLabel1);
+  gtk_box_pack_start (GTK_BOX (rollingAvgInitHbox1), rollingAvgInitLabel1, FALSE, FALSE, 0);
+
+  rollingAvgInitTypeMenu = gtk_combo_box_new_text ();
+  gtk_widget_show (rollingAvgInitTypeMenu);
+  gtk_box_pack_start (GTK_BOX (rollingAvgInitHbox1), rollingAvgInitTypeMenu, FALSE, TRUE, 0);
+  gtk_combo_box_append_text (GTK_COMBO_BOX (rollingAvgInitTypeMenu), _(&quot;straight&quot;));
+  gtk_combo_box_append_text (GTK_COMBO_BOX (rollingAvgInitTypeMenu), _(&quot;rolling&quot;));
+
+  rollingAvgInitLabel2 = gtk_label_new (_(&quot; average&quot;));
+  gtk_widget_show (rollingAvgInitLabel2);
+  gtk_box_pack_start (GTK_BOX (rollingAvgInitHbox1), rollingAvgInitLabel2, FALSE, FALSE, 0);
+
+  rollingAvgInitHbox2 = gtk_hbox_new (FALSE, 0);
+  gtk_widget_show (rollingAvgInitHbox2);
+  gtk_box_pack_start (GTK_BOX (rollingAvgInitVbox), rollingAvgInitHbox2, TRUE, TRUE, 0);
+
+  rollingAvgInitLabel3 = gtk_label_new (_(&quot;      of frames &quot;));
+  gtk_widget_show (rollingAvgInitLabel3);
+  gtk_box_pack_start (GTK_BOX (rollingAvgInitHbox2), rollingAvgInitLabel3, FALSE, FALSE, 0);
+
+  rollingAvgInitStartSpinButton_adj = gtk_adjustment_new (1, 1, 99999, 1, 1, 0);
+  rollingAvgInitStartSpinButton = gtk_spin_button_new (GTK_ADJUSTMENT (rollingAvgInitStartSpinButton_adj), 1, 0);
+  gtk_widget_show (rollingAvgInitStartSpinButton);
+  gtk_box_pack_start (GTK_BOX (rollingAvgInitHbox2), rollingAvgInitStartSpinButton, FALSE, TRUE, 0);
+  gtk_spin_button_set_numeric (GTK_SPIN_BUTTON (rollingAvgInitStartSpinButton), TRUE);
+
+  rollingAvgInitLabel4 = gtk_label_new (_(&quot; through &quot;));
+  gtk_widget_show (rollingAvgInitLabel4);
+  gtk_box_pack_start (GTK_BOX (rollingAvgInitHbox2), rollingAvgInitLabel4, FALSE, FALSE, 0);
+
+  rollingAvgInitEndSpinButton_adj = gtk_adjustment_new (100, 1, 99999, 1, 1, 0);
+  rollingAvgInitEndSpinButton = gtk_spin_button_new (GTK_ADJUSTMENT (rollingAvgInitEndSpinButton_adj), 1, 0);
+  gtk_widget_show (rollingAvgInitEndSpinButton);
+  gtk_box_pack_start (GTK_BOX (rollingAvgInitHbox2), rollingAvgInitEndSpinButton, FALSE, TRUE, 0);
+  gtk_spin_button_set_numeric (GTK_SPIN_BUTTON (rollingAvgInitEndSpinButton), TRUE);
+
+  bottomSeparator = gtk_hseparator_new ();
+  gtk_widget_show (bottomSeparator);
+  gtk_box_pack_start (GTK_BOX (settingsOuterVbox), bottomSeparator, TRUE, TRUE, 0);
+
+  biasVbox = gtk_vbox_new (FALSE, 0);
+  gtk_widget_show (biasVbox);
+  gtk_box_pack_start (GTK_BOX (settingsOuterVbox), biasVbox, TRUE, TRUE, 0);
+
+  biasLabel = gtk_label_new_with_mnemonic (_(&quot;Integer _Bias (will be added to result of selected operation):&quot;));
+  gtk_widget_show (biasLabel);
+  gtk_box_pack_start (GTK_BOX (biasVbox), biasLabel, FALSE, FALSE, 0);
+  gtk_misc_set_alignment (GTK_MISC (biasLabel), 0, 0.5);
+
+  biasHbox = gtk_hbox_new (FALSE, 5);
+  gtk_widget_show (biasHbox);
+  gtk_box_pack_start (GTK_BOX (biasVbox), biasHbox, TRUE, TRUE, 0);
+
+  biasSlider = gtk_hscale_new (GTK_ADJUSTMENT (gtk_adjustment_new (128, -256, 256, 1, 1, 0)));
+  gtk_widget_show (biasSlider);
+  gtk_box_pack_start (GTK_BOX (biasHbox), biasSlider, TRUE, TRUE, 0);
+  gtk_scale_set_draw_value (GTK_SCALE (biasSlider), FALSE);
+  gtk_scale_set_value_pos (GTK_SCALE (biasSlider), GTK_POS_LEFT);
+  gtk_scale_set_digits (GTK_SCALE (biasSlider), 0);
+
+  biasSpinner_adj = gtk_adjustment_new (128, -256, 256, 1, 1, 0);
+  biasSpinner = gtk_spin_button_new (GTK_ADJUSTMENT (biasSpinner_adj), 1, 0);
+  gtk_widget_show (biasSpinner);
+  gtk_box_pack_start (GTK_BOX (biasHbox), biasSpinner, FALSE, TRUE, 0);
+  gtk_spin_button_set_numeric (GTK_SPIN_BUTTON (biasSpinner), TRUE);
+
+  resultScalingFrame = gtk_frame_new (NULL);
+  gtk_widget_show (resultScalingFrame);
+  gtk_box_pack_start (GTK_BOX (settingsOuterVbox), resultScalingFrame, TRUE, TRUE, 0);
+  gtk_frame_set_shadow_type (GTK_FRAME (resultScalingFrame), GTK_SHADOW_IN);
+
+  resultScalingAlignment = gtk_alignment_new (0.5, 0.5, 1, 1);
+  gtk_widget_show (resultScalingAlignment);
+  gtk_container_add (GTK_CONTAINER (resultScalingFrame), resultScalingAlignment);
+  gtk_alignment_set_padding (GTK_ALIGNMENT (resultScalingAlignment), 2, 6, 6, 6);
+
+  resultScalingVbox = gtk_vbox_new (FALSE, 6);
+  gtk_widget_show (resultScalingVbox);
+  gtk_container_add (GTK_CONTAINER (resultScalingAlignment), resultScalingVbox);
+
+  resultScalingAddHbox = gtk_hbox_new (FALSE, 0);
+  gtk_widget_show (resultScalingAddHbox);
+  gtk_box_pack_start (GTK_BOX (resultScalingVbox), resultScalingAddHbox, TRUE, TRUE, 0);
+
+  resultScalingAddLabel = gtk_label_new_with_mnemonic (_(&quot;First, _add to each pixel result value:   &quot;));
+  gtk_widget_show (resultScalingAddLabel);
+  gtk_box_pack_start (GTK_BOX (resultScalingAddHbox), resultScalingAddLabel, FALSE, FALSE, 0);
+
+  resultScalingAddSpinButton_adj = gtk_adjustment_new (0, -99999, 99999, 0.10000000149, 1, 0);
+  resultScalingAddSpinButton = gtk_spin_button_new (GTK_ADJUSTMENT (resultScalingAddSpinButton_adj), 1, 5);
+  gtk_widget_show (resultScalingAddSpinButton);
+  gtk_box_pack_start (GTK_BOX (resultScalingAddHbox), resultScalingAddSpinButton, TRUE, TRUE, 0);
+  gtk_spin_button_set_numeric (GTK_SPIN_BUTTON (resultScalingAddSpinButton), TRUE);
+
+  resultScalingMultHbox = gtk_hbox_new (FALSE, 0);
+  gtk_widget_show (resultScalingMultHbox);
+  gtk_box_pack_start (GTK_BOX (resultScalingVbox), resultScalingMultHbox, TRUE, TRUE, 0);
+
+  resultScalingMultLabel = gtk_label_new_with_mnemonic (_(&quot;Then, _multiply each pixel result value by:   &quot;));
+  gtk_widget_show (resultScalingMultLabel);
+  gtk_box_pack_start (GTK_BOX (resultScalingMultHbox), resultScalingMultLabel, FALSE, FALSE, 0);
+
+  resultScalingMultSpinButton_adj = gtk_adjustment_new (1, -99999, 99999, 0.0010000000475, 0.0010000000475, 0);
+  resultScalingMultSpinButton = gtk_spin_button_new (GTK_ADJUSTMENT (resultScalingMultSpinButton_adj), 1, 5);
+  gtk_widget_show (resultScalingMultSpinButton);
+  gtk_box_pack_start (GTK_BOX (resultScalingMultHbox), resultScalingMultSpinButton, TRUE, TRUE, 0);
+  gtk_spin_button_set_numeric (GTK_SPIN_BUTTON (resultScalingMultSpinButton), TRUE);
+
+  resultScalingMinVbox = gtk_vbox_new (FALSE, 0);
+  gtk_widget_show (resultScalingMinVbox);
+  gtk_box_pack_start (GTK_BOX (resultScalingVbox), resultScalingMinVbox, TRUE, TRUE, 0);
+
+  resultScalingMinLabel = gtk_label_new_with_mnemonic (_(&quot;Mi_nimum result value (will be scaled to 0):&quot;));
+  gtk_widget_show (resultScalingMinLabel);
+  gtk_box_pack_start (GTK_BOX (resultScalingMinVbox), resultScalingMinLabel, FALSE, FALSE, 0);
+  gtk_misc_set_alignment (GTK_MISC (resultScalingMinLabel), 0, 0.5);
+
+  resultScalingMinHbox = gtk_hbox_new (FALSE, 5);
+  gtk_widget_show (resultScalingMinHbox);
+  gtk_box_pack_start (GTK_BOX (resultScalingMinVbox), resultScalingMinHbox, TRUE, TRUE, 0);
+
+  resultScalingMinSlider = gtk_hscale_new (GTK_ADJUSTMENT (gtk_adjustment_new (0, -1024, 1024, 1, 1, 0)));
+  gtk_widget_show (resultScalingMinSlider);
+  gtk_box_pack_start (GTK_BOX (resultScalingMinHbox), resultScalingMinSlider, TRUE, TRUE, 0);
+  gtk_scale_set_draw_value (GTK_SCALE (resultScalingMinSlider), FALSE);
+  gtk_scale_set_value_pos (GTK_SCALE (resultScalingMinSlider), GTK_POS_LEFT);
+  gtk_scale_set_digits (GTK_SCALE (resultScalingMinSlider), 0);
+
+  resultScalingMinSpinner_adj = gtk_adjustment_new (0, -1024, 1024, 1, 2, 0);
+  resultScalingMinSpinner = gtk_spin_button_new (GTK_ADJUSTMENT (resultScalingMinSpinner_adj), 1, 1);
+  gtk_widget_show (resultScalingMinSpinner);
+  gtk_box_pack_start (GTK_BOX (resultScalingMinHbox), resultScalingMinSpinner, FALSE, TRUE, 0);
+  gtk_spin_button_set_numeric (GTK_SPIN_BUTTON (resultScalingMinSpinner), TRUE);
+
+  resultScalingMaxVbox = gtk_vbox_new (FALSE, 0);
+  gtk_widget_show (resultScalingMaxVbox);
+  gtk_box_pack_start (GTK_BOX (resultScalingVbox), resultScalingMaxVbox, TRUE, TRUE, 0);
+
+  resultScalingMaxLabel = gtk_label_new_with_mnemonic (_(&quot;Ma_ximum result value (will be scaled to 255):&quot;));
+  gtk_widget_show (resultScalingMaxLabel);
+  gtk_box_pack_start (GTK_BOX (resultScalingMaxVbox), resultScalingMaxLabel, FALSE, FALSE, 0);
+  gtk_misc_set_alignment (GTK_MISC (resultScalingMaxLabel), 0, 0.5);
+
+  resultScalingMaxHbox = gtk_hbox_new (FALSE, 5);
+  gtk_widget_show (resultScalingMaxHbox);
+  gtk_box_pack_start (GTK_BOX (resultScalingMaxVbox), resultScalingMaxHbox, TRUE, TRUE, 0);
+
+  resultScalingMaxSlider = gtk_hscale_new (GTK_ADJUSTMENT (gtk_adjustment_new (255, -1024, 1024, 1, 1, 0)));
+  gtk_widget_show (resultScalingMaxSlider);
+  gtk_box_pack_start (GTK_BOX (resultScalingMaxHbox), resultScalingMaxSlider, TRUE, TRUE, 0);
+  gtk_scale_set_draw_value (GTK_SCALE (resultScalingMaxSlider), FALSE);
+  gtk_scale_set_value_pos (GTK_SCALE (resultScalingMaxSlider), GTK_POS_LEFT);
+  gtk_scale_set_digits (GTK_SCALE (resultScalingMaxSlider), 0);
+
+  resultScalingMaxSpinner_adj = gtk_adjustment_new (255, -1024, 1024, 1, 2, 0);
+  resultScalingMaxSpinner = gtk_spin_button_new (GTK_ADJUSTMENT (resultScalingMaxSpinner_adj), 1, 1);
+  gtk_widget_show (resultScalingMaxSpinner);
+  gtk_box_pack_start (GTK_BOX (resultScalingMaxHbox), resultScalingMaxSpinner, FALSE, TRUE, 0);
+  gtk_spin_button_set_numeric (GTK_SPIN_BUTTON (resultScalingMaxSpinner), TRUE);
+
+  resultScalingFrameLabel = gtk_label_new (_(&quot;Pixel Value Scaling on Result of Selected Operation&quot;));
+  gtk_widget_show (resultScalingFrameLabel);
+  gtk_frame_set_label_widget (GTK_FRAME (resultScalingFrame), resultScalingFrameLabel);
+  gtk_label_set_use_markup (GTK_LABEL (resultScalingFrameLabel), TRUE);
+
+  hseparator2 = gtk_hseparator_new ();
+  gtk_widget_show (hseparator2);
+  gtk_box_pack_start (GTK_BOX (settingsOuterVbox), hseparator2, TRUE, TRUE, 0);
+
+  currentConfigDescription = gtk_label_new (_(&quot;(description of current config will go here)&quot;));
+  gtk_widget_show (currentConfigDescription);
+  gtk_box_pack_start (GTK_BOX (settingsOuterVbox), currentConfigDescription, FALSE, FALSE, 0);
+  GTK_WIDGET_SET_FLAGS (currentConfigDescription, GTK_CAN_FOCUS);
+  gtk_label_set_use_markup (GTK_LABEL (currentConfigDescription), TRUE);
+  gtk_label_set_line_wrap (GTK_LABEL (currentConfigDescription), TRUE);
+  gtk_label_set_selectable (GTK_LABEL (currentConfigDescription), TRUE);
+  gtk_misc_set_alignment (GTK_MISC (currentConfigDescription), 0, 0.5);
+
+  hseparator1 = gtk_hseparator_new ();
+  gtk_widget_show (hseparator1);
+  gtk_box_pack_start (GTK_BOX (settingsOuterVbox), hseparator1, TRUE, TRUE, 0);
+
+  histogramHbox = gtk_hbox_new (FALSE, 0);
+  gtk_widget_show (histogramHbox);
+  gtk_box_pack_start (GTK_BOX (settingsOuterVbox), histogramHbox, TRUE, TRUE, 0);
+
+  histogramLabel = gtk_label_new_with_mnemonic (_(&quot;_Histogram every N frames (0 to disable):   &quot;));
+  gtk_widget_show (histogramLabel);
+  gtk_box_pack_start (GTK_BOX (histogramHbox), histogramLabel, FALSE, FALSE, 0);
+
+  histogramSpinButton_adj = gtk_adjustment_new (0, 0, 16777215, 1, 10, 0);
+  histogramSpinButton = gtk_spin_button_new (GTK_ADJUSTMENT (histogramSpinButton_adj), 1, 0);
+  gtk_widget_show (histogramSpinButton);
+  gtk_box_pack_start (GTK_BOX (histogramHbox), histogramSpinButton, TRUE, TRUE, 0);
+  gtk_spin_button_set_numeric (GTK_SPIN_BUTTON (histogramSpinButton), TRUE);
+
+  debugHbox = gtk_hbox_new (FALSE, 0);
+  gtk_widget_show (debugHbox);
+  gtk_box_pack_start (GTK_BOX (settingsOuterVbox), debugHbox, TRUE, TRUE, 0);
+
+  debugLabel = gtk_label_new_with_mnemonic (_(&quot;_Debugging settings (bits):   &quot;));
+  gtk_widget_show (debugLabel);
+  gtk_box_pack_start (GTK_BOX (debugHbox), debugLabel, FALSE, FALSE, 0);
+
+  debugSpinButton_adj = gtk_adjustment_new (0, 0, 16777215, 1, 10, 0);
+  debugSpinButton = gtk_spin_button_new (GTK_ADJUSTMENT (debugSpinButton_adj), 1, 0);
+  gtk_widget_show (debugSpinButton);
+  gtk_box_pack_start (GTK_BOX (debugHbox), debugSpinButton, TRUE, TRUE, 0);
+  gtk_spin_button_set_numeric (GTK_SPIN_BUTTON (debugSpinButton), TRUE);
+
+  previewVboxOuter = gtk_vbox_new (FALSE, 0);
+  gtk_widget_show (previewVboxOuter);
+  gtk_box_pack_start (GTK_BOX (dialogHbox), previewVboxOuter, FALSE, TRUE, 0);
+
+  previewFrame = gtk_frame_new (NULL);
+  gtk_widget_show (previewFrame);
+  gtk_box_pack_start (GTK_BOX (previewVboxOuter), previewFrame, FALSE, TRUE, 0);
+
+  previewAlignment = gtk_alignment_new (0.5, 0.5, 1, 1);
+  gtk_widget_show (previewAlignment);
+  gtk_container_add (GTK_CONTAINER (previewFrame), previewAlignment);
+  gtk_alignment_set_padding (GTK_ALIGNMENT (previewAlignment), 0, 8, 6, 8);
+
+  previewVbox = gtk_vbox_new (FALSE, 5);
+  gtk_widget_show (previewVbox);
+  gtk_container_add (GTK_CONTAINER (previewAlignment), previewVbox);
+
+  previewControlHbox = gtk_hbox_new (FALSE, 5);
+  gtk_widget_show (previewControlHbox);
+  gtk_box_pack_start (GTK_BOX (previewVbox), previewControlHbox, TRUE, TRUE, 0);
+
+  previewOutputMenu = gtk_combo_box_new_text ();
+  gtk_box_pack_start (GTK_BOX (previewControlHbox), previewOutputMenu, FALSE, TRUE, 0);
+  gtk_combo_box_append_text (GTK_COMBO_BOX (previewOutputMenu), _(&quot;Swiss Army Knife output&quot;));
+  gtk_combo_box_append_text (GTK_COMBO_BOX (previewOutputMenu), _(&quot;Final output&quot;));
+
+  previewSlider = gtk_hscale_new (GTK_ADJUSTMENT (gtk_adjustment_new (0, 0, 99, 1, 1, 0)));
+  gtk_widget_show (previewSlider);
+  gtk_box_pack_start (GTK_BOX (previewControlHbox), previewSlider, TRUE, TRUE, 0);
+  gtk_scale_set_digits (GTK_SCALE (previewSlider), 0);
+
+  previewVideo = gtk_drawing_area_new ();
+  gtk_widget_show (previewVideo);
+  gtk_box_pack_start (GTK_BOX (previewVbox), previewVideo, TRUE, TRUE, 0);
+  gtk_widget_set_size_request (previewVideo, -1, 300);
+  gtk_widget_set_events (previewVideo, GDK_BUTTON1_MOTION_MASK | GDK_BUTTON_PRESS_MASK);
+
+  previewDisabled = gtk_drawing_area_new ();
+  gtk_box_pack_start (GTK_BOX (previewVbox), previewDisabled, TRUE, TRUE, 0);
+
+  previewLabel = gtk_label_new (_(&quot;Preview&quot;));
+  gtk_widget_show (previewLabel);
+  gtk_frame_set_label_widget (GTK_FRAME (previewFrame), previewLabel);
+
+  previewEnableButtonHbox = gtk_hbox_new (FALSE, 0);
+  gtk_widget_show (previewEnableButtonHbox);
+  gtk_box_pack_start (GTK_BOX (previewVboxOuter), previewEnableButtonHbox, FALSE, TRUE, 5);
+
+  previewEnableButton = gtk_toggle_button_new_with_mnemonic (_(&quot;Enable Preview&quot;));
+  gtk_widget_show (previewEnableButton);
+  gtk_box_pack_end (GTK_BOX (previewEnableButtonHbox), previewEnableButton, FALSE, FALSE, 0);
+
+  dialogButtonBox = GTK_DIALOG (swiss_army_knife_dialog)-&gt;action_area;
+  gtk_widget_show (dialogButtonBox);
+  gtk_button_box_set_layout (GTK_BUTTON_BOX (dialogButtonBox), GTK_BUTTONBOX_END);
+
+  cancelButton = gtk_button_new_from_stock (&quot;gtk-cancel&quot;);
+  gtk_widget_show (cancelButton);
+  gtk_dialog_add_action_widget (GTK_DIALOG (swiss_army_knife_dialog), cancelButton, GTK_RESPONSE_CANCEL);
+  GTK_WIDGET_SET_FLAGS (cancelButton, GTK_CAN_DEFAULT);
+
+  okButton = gtk_button_new_from_stock (&quot;gtk-ok&quot;);
+  gtk_widget_show (okButton);
+  gtk_dialog_add_action_widget (GTK_DIALOG (swiss_army_knife_dialog), okButton, GTK_RESPONSE_OK);
+  GTK_WIDGET_SET_FLAGS (okButton, GTK_CAN_DEFAULT);
+
+  gtk_label_set_mnemonic_widget (GTK_LABEL (imageFileScalingAddLabel), imageFileScalingAddSpinButton);
+  gtk_label_set_mnemonic_widget (GTK_LABEL (imageFileScalingMultLabel), imageFileScalingMultSpinButton);
+  gtk_label_set_mnemonic_widget (GTK_LABEL (constantValueLabel), constantValueSpinButton);
+  gtk_label_set_mnemonic_widget (GTK_LABEL (rollingAvgAlphaLabel), rollingAvgAlphaSpinButton);
+  gtk_label_set_mnemonic_widget (GTK_LABEL (resultScalingAddLabel), resultScalingAddSpinButton);
+  gtk_label_set_mnemonic_widget (GTK_LABEL (resultScalingMultLabel), resultScalingMultSpinButton);
+  gtk_label_set_mnemonic_widget (GTK_LABEL (histogramLabel), histogramSpinButton);
+  gtk_label_set_mnemonic_widget (GTK_LABEL (debugLabel), debugSpinButton);
+
+  /* Store pointers to all widgets, for use by lookup_widget(). */
+  GLADE_HOOKUP_OBJECT_NO_REF (swiss_army_knife_dialog, swiss_army_knife_dialog, &quot;swiss_army_knife_dialog&quot;);
+  GLADE_HOOKUP_OBJECT_NO_REF (swiss_army_knife_dialog, dialogVbox, &quot;dialogVbox&quot;);
+  GLADE_HOOKUP_OBJECT (swiss_army_knife_dialog, dialogHbox, &quot;dialogHbox&quot;);
+  GLADE_HOOKUP_OBJECT (swiss_army_knife_dialog, allSettingsVbox, &quot;allSettingsVbox&quot;);
+  GLADE_HOOKUP_OBJECT (swiss_army_knife_dialog, settingsOuterHbox, &quot;settingsOuterHbox&quot;);
+  GLADE_HOOKUP_OBJECT (swiss_army_knife_dialog, settingsOuterVbox, &quot;settingsOuterVbox&quot;);
+  GLADE_HOOKUP_OBJECT (swiss_army_knife_dialog, operationHbox, &quot;operationHbox&quot;);
+  GLADE_HOOKUP_OBJECT (swiss_army_knife_dialog, operationLabel, &quot;operationLabel&quot;);
+  GLADE_HOOKUP_OBJECT (swiss_army_knife_dialog, operationMenu, &quot;operationMenu&quot;);
+  GLADE_HOOKUP_OBJECT (swiss_army_knife_dialog, inputTypeHbox, &quot;inputTypeHbox&quot;);
+  GLADE_HOOKUP_OBJECT (swiss_army_knife_dialog, inputTypeLabel, &quot;inputTypeLabel&quot;);
+  GLADE_HOOKUP_OBJECT (swiss_army_knife_dialog, inputTypeMenu, &quot;inputTypeMenu&quot;);
+  GLADE_HOOKUP_OBJECT (swiss_army_knife_dialog, topSeparator, &quot;topSeparator&quot;);
+  GLADE_HOOKUP_OBJECT (swiss_army_knife_dialog, convolutionSettingsVbox, &quot;convolutionSettingsVbox&quot;);
+  GLADE_HOOKUP_OBJECT (swiss_army_knife_dialog, convolutionInputFileHbox, &quot;convolutionInputFileHbox&quot;);
+  GLADE_HOOKUP_OBJECT (swiss_army_knife_dialog, convolutionInputFileLabel, &quot;convolutionInputFileLabel&quot;);
+  GLADE_HOOKUP_OBJECT (swiss_army_knife_dialog, convolutionInputFileChooser, &quot;convolutionInputFileChooser&quot;);
+  GLADE_HOOKUP_OBJECT (swiss_army_knife_dialog, imageFileSettingsVbox, &quot;imageFileSettingsVbox&quot;);
+  GLADE_HOOKUP_OBJECT (swiss_army_knife_dialog, imageInputFileHbox, &quot;imageInputFileHbox&quot;);
+  GLADE_HOOKUP_OBJECT (swiss_army_knife_dialog, imageInputFileLabel, &quot;imageInputFileLabel&quot;);
+  GLADE_HOOKUP_OBJECT (swiss_army_knife_dialog, imageInputFileChooser, &quot;imageInputFileChooser&quot;);
+  GLADE_HOOKUP_OBJECT (swiss_army_knife_dialog, imageFileScalingFrame, &quot;imageFileScalingFrame&quot;);
+  GLADE_HOOKUP_OBJECT (swiss_army_knife_dialog, imageFileScalingAlignment, &quot;imageFileScalingAlignment&quot;);
+  GLADE_HOOKUP_OBJECT (swiss_army_knife_dialog, imageFileScalingVbox, &quot;imageFileScalingVbox&quot;);
+  GLADE_HOOKUP_OBJECT (swiss_army_knife_dialog, imageFileScalingAddHbox, &quot;imageFileScalingAddHbox&quot;);
+  GLADE_HOOKUP_OBJECT (swiss_army_knife_dialog, imageFileScalingAddLabel, &quot;imageFileScalingAddLabel&quot;);
+  GLADE_HOOKUP_OBJECT (swiss_army_knife_dialog, imageFileScalingAddSpinButton, &quot;imageFileScalingAddSpinButton&quot;);
+  GLADE_HOOKUP_OBJECT (swiss_army_knife_dialog, imageFileScalingMultHbox, &quot;imageFileScalingMultHbox&quot;);
+  GLADE_HOOKUP_OBJECT (swiss_army_knife_dialog, imageFileScalingMultLabel, &quot;imageFileScalingMultLabel&quot;);
+  GLADE_HOOKUP_OBJECT (swiss_army_knife_dialog, imageFileScalingMultSpinButton, &quot;imageFileScalingMultSpinButton&quot;);
+  GLADE_HOOKUP_OBJECT (swiss_army_knife_dialog, imageFileScalingMinVbox, &quot;imageFileScalingMinVbox&quot;);
+  GLADE_HOOKUP_OBJECT (swiss_army_knife_dialog, imageFileScalingMinLabel, &quot;imageFileScalingMinLabel&quot;);
+  GLADE_HOOKUP_OBJECT (swiss_army_knife_dialog, imageFileScalingMinHbox, &quot;imageFileScalingMinHbox&quot;);
+  GLADE_HOOKUP_OBJECT (swiss_army_knife_dialog, imageFileScalingMinSlider, &quot;imageFileScalingMinSlider&quot;);
+  GLADE_HOOKUP_OBJECT (swiss_army_knife_dialog, imageFileScalingMinSpinner, &quot;imageFileScalingMinSpinner&quot;);
+  GLADE_HOOKUP_OBJECT (swiss_army_knife_dialog, imageFileScalingMaxVbox, &quot;imageFileScalingMaxVbox&quot;);
+  GLADE_HOOKUP_OBJECT (swiss_army_knife_dialog, imageFileScalingMaxLabel, &quot;imageFileScalingMaxLabel&quot;);
+  GLADE_HOOKUP_OBJECT (swiss_army_knife_dialog, imageFileScalingMaxHbox, &quot;imageFileScalingMaxHbox&quot;);
+  GLADE_HOOKUP_OBJECT (swiss_army_knife_dialog, imageFileScalingMaxSlider, &quot;imageFileScalingMaxSlider&quot;);
+  GLADE_HOOKUP_OBJECT (swiss_army_knife_dialog, imageFileScalingMaxSpinner, &quot;imageFileScalingMaxSpinner&quot;);
+  GLADE_HOOKUP_OBJECT (swiss_army_knife_dialog, imageFileScalingFrameLabel, &quot;imageFileScalingFrameLabel&quot;);
+  GLADE_HOOKUP_OBJECT (swiss_army_knife_dialog, constantSettingsVbox, &quot;constantSettingsVbox&quot;);
+  GLADE_HOOKUP_OBJECT (swiss_army_knife_dialog, constantValueHbox, &quot;constantValueHbox&quot;);
+  GLADE_HOOKUP_OBJECT (swiss_army_knife_dialog, constantValueLabel, &quot;constantValueLabel&quot;);
+  GLADE_HOOKUP_OBJECT (swiss_army_knife_dialog, constantValueSpinButton, &quot;constantValueSpinButton&quot;);
+  GLADE_HOOKUP_OBJECT (swiss_army_knife_dialog, rollingAvgSettingsVbox, &quot;rollingAvgSettingsVbox&quot;);
+  GLADE_HOOKUP_OBJECT (swiss_army_knife_dialog, rollingAvgAlphaHbox, &quot;rollingAvgAlphaHbox&quot;);
+  GLADE_HOOKUP_OBJECT (swiss_army_knife_dialog, rollingAvgAlphaLabel, &quot;rollingAvgAlphaLabel&quot;);
+  GLADE_HOOKUP_OBJECT (swiss_army_knife_dialog, rollingAvgAlphaSpinButton, &quot;rollingAvgAlphaSpinButton&quot;);
+  GLADE_HOOKUP_OBJECT (swiss_army_knife_dialog, rollingAvgAlphaEqualsLabel, &quot;rollingAvgAlphaEqualsLabel&quot;);
+  GLADE_HOOKUP_OBJECT (swiss_army_knife_dialog, rollingAvgAlphaDenomSpinButton, &quot;rollingAvgAlphaDenomSpinButton&quot;);
+  GLADE_HOOKUP_OBJECT (swiss_army_knife_dialog, rollingAvgInitVbox, &quot;rollingAvgInitVbox&quot;);
+  GLADE_HOOKUP_OBJECT (swiss_army_knife_dialog, rollingAvgInitHbox1, &quot;rollingAvgInitHbox1&quot;);
+  GLADE_HOOKUP_OBJECT (swiss_army_knife_dialog, rollingAvgInitLabel1, &quot;rollingAvgInitLabel1&quot;);
+  GLADE_HOOKUP_OBJECT (swiss_army_knife_dialog, rollingAvgInitTypeMenu, &quot;rollingAvgInitTypeMenu&quot;);
+  GLADE_HOOKUP_OBJECT (swiss_army_knife_dialog, rollingAvgInitLabel2, &quot;rollingAvgInitLabel2&quot;);
+  GLADE_HOOKUP_OBJECT (swiss_army_knife_dialog, rollingAvgInitHbox2, &quot;rollingAvgInitHbox2&quot;);
+  GLADE_HOOKUP_OBJECT (swiss_army_knife_dialog, rollingAvgInitLabel3, &quot;rollingAvgInitLabel3&quot;);
+  GLADE_HOOKUP_OBJECT (swiss_army_knife_dialog, rollingAvgInitStartSpinButton, &quot;rollingAvgInitStartSpinButton&quot;);
+  GLADE_HOOKUP_OBJECT (swiss_army_knife_dialog, rollingAvgInitLabel4, &quot;rollingAvgInitLabel4&quot;);
+  GLADE_HOOKUP_OBJECT (swiss_army_knife_dialog, rollingAvgInitEndSpinButton, &quot;rollingAvgInitEndSpinButton&quot;);
+  GLADE_HOOKUP_OBJECT (swiss_army_knife_dialog, bottomSeparator, &quot;bottomSeparator&quot;);
+  GLADE_HOOKUP_OBJECT (swiss_army_knife_dialog, biasVbox, &quot;biasVbox&quot;);
+  GLADE_HOOKUP_OBJECT (swiss_army_knife_dialog, biasLabel, &quot;biasLabel&quot;);
+  GLADE_HOOKUP_OBJECT (swiss_army_knife_dialog, biasHbox, &quot;biasHbox&quot;);
+  GLADE_HOOKUP_OBJECT (swiss_army_knife_dialog, biasSlider, &quot;biasSlider&quot;);
+  GLADE_HOOKUP_OBJECT (swiss_army_knife_dialog, biasSpinner, &quot;biasSpinner&quot;);
+  GLADE_HOOKUP_OBJECT (swiss_army_knife_dialog, resultScalingFrame, &quot;resultScalingFrame&quot;);
+  GLADE_HOOKUP_OBJECT (swiss_army_knife_dialog, resultScalingAlignment, &quot;resultScalingAlignment&quot;);
+  GLADE_HOOKUP_OBJECT (swiss_army_knife_dialog, resultScalingVbox, &quot;resultScalingVbox&quot;);
+  GLADE_HOOKUP_OBJECT (swiss_army_knife_dialog, resultScalingAddHbox, &quot;resultScalingAddHbox&quot;);
+  GLADE_HOOKUP_OBJECT (swiss_army_knife_dialog, resultScalingAddLabel, &quot;resultScalingAddLabel&quot;);
+  GLADE_HOOKUP_OBJECT (swiss_army_knife_dialog, resultScalingAddSpinButton, &quot;resultScalingAddSpinButton&quot;);
+  GLADE_HOOKUP_OBJECT (swiss_army_knife_dialog, resultScalingMultHbox, &quot;resultScalingMultHbox&quot;);
+  GLADE_HOOKUP_OBJECT (swiss_army_knife_dialog, resultScalingMultLabel, &quot;resultScalingMultLabel&quot;);
+  GLADE_HOOKUP_OBJECT (swiss_army_knife_dialog, resultScalingMultSpinButton, &quot;resultScalingMultSpinButton&quot;);
+  GLADE_HOOKUP_OBJECT (swiss_army_knife_dialog, resultScalingMinVbox, &quot;resultScalingMinVbox&quot;);
+  GLADE_HOOKUP_OBJECT (swiss_army_knife_dialog, resultScalingMinLabel, &quot;resultScalingMinLabel&quot;);
+  GLADE_HOOKUP_OBJECT (swiss_army_knife_dialog, resultScalingMinHbox, &quot;resultScalingMinHbox&quot;);
+  GLADE_HOOKUP_OBJECT (swiss_army_knife_dialog, resultScalingMinSlider, &quot;resultScalingMinSlider&quot;);
+  GLADE_HOOKUP_OBJECT (swiss_army_knife_dialog, resultScalingMinSpinner, &quot;resultScalingMinSpinner&quot;);
+  GLADE_HOOKUP_OBJECT (swiss_army_knife_dialog, resultScalingMaxVbox, &quot;resultScalingMaxVbox&quot;);
+  GLADE_HOOKUP_OBJECT (swiss_army_knife_dialog, resultScalingMaxLabel, &quot;resultScalingMaxLabel&quot;);
+  GLADE_HOOKUP_OBJECT (swiss_army_knife_dialog, resultScalingMaxHbox, &quot;resultScalingMaxHbox&quot;);
+  GLADE_HOOKUP_OBJECT (swiss_army_knife_dialog, resultScalingMaxSlider, &quot;resultScalingMaxSlider&quot;);
+  GLADE_HOOKUP_OBJECT (swiss_army_knife_dialog, resultScalingMaxSpinner, &quot;resultScalingMaxSpinner&quot;);
+  GLADE_HOOKUP_OBJECT (swiss_army_knife_dialog, resultScalingFrameLabel, &quot;resultScalingFrameLabel&quot;);
+  GLADE_HOOKUP_OBJECT (swiss_army_knife_dialog, hseparator2, &quot;hseparator2&quot;);
+  GLADE_HOOKUP_OBJECT (swiss_army_knife_dialog, currentConfigDescription, &quot;currentConfigDescription&quot;);
+  GLADE_HOOKUP_OBJECT (swiss_army_knife_dialog, hseparator1, &quot;hseparator1&quot;);
+  GLADE_HOOKUP_OBJECT (swiss_army_knife_dialog, histogramHbox, &quot;histogramHbox&quot;);
+  GLADE_HOOKUP_OBJECT (swiss_army_knife_dialog, histogramLabel, &quot;histogramLabel&quot;);
+  GLADE_HOOKUP_OBJECT (swiss_army_knife_dialog, histogramSpinButton, &quot;histogramSpinButton&quot;);
+  GLADE_HOOKUP_OBJECT (swiss_army_knife_dialog, debugHbox, &quot;debugHbox&quot;);
+  GLADE_HOOKUP_OBJECT (swiss_army_knife_dialog, debugLabel, &quot;debugLabel&quot;);
+  GLADE_HOOKUP_OBJECT (swiss_army_knife_dialog, debugSpinButton, &quot;debugSpinButton&quot;);
+  GLADE_HOOKUP_OBJECT (swiss_army_knife_dialog, previewVboxOuter, &quot;previewVboxOuter&quot;);
+  GLADE_HOOKUP_OBJECT (swiss_army_knife_dialog, previewFrame, &quot;previewFrame&quot;);
+  GLADE_HOOKUP_OBJECT (swiss_army_knife_dialog, previewAlignment, &quot;previewAlignment&quot;);
+  GLADE_HOOKUP_OBJECT (swiss_army_knife_dialog, previewVbox, &quot;previewVbox&quot;);
+  GLADE_HOOKUP_OBJECT (swiss_army_knife_dialog, previewControlHbox, &quot;previewControlHbox&quot;);
+  GLADE_HOOKUP_OBJECT (swiss_army_knife_dialog, previewOutputMenu, &quot;previewOutputMenu&quot;);
+  GLADE_HOOKUP_OBJECT (swiss_army_knife_dialog, previewSlider, &quot;previewSlider&quot;);
+  GLADE_HOOKUP_OBJECT (swiss_army_knife_dialog, previewVideo, &quot;previewVideo&quot;);
+  GLADE_HOOKUP_OBJECT (swiss_army_knife_dialog, previewDisabled, &quot;previewDisabled&quot;);
+  GLADE_HOOKUP_OBJECT (swiss_army_knife_dialog, previewLabel, &quot;previewLabel&quot;);
+  GLADE_HOOKUP_OBJECT (swiss_army_knife_dialog, previewEnableButtonHbox, &quot;previewEnableButtonHbox&quot;);
+  GLADE_HOOKUP_OBJECT (swiss_army_knife_dialog, previewEnableButton, &quot;previewEnableButton&quot;);
+  GLADE_HOOKUP_OBJECT_NO_REF (swiss_army_knife_dialog, dialogButtonBox, &quot;dialogButtonBox&quot;);
+  GLADE_HOOKUP_OBJECT (swiss_army_knife_dialog, cancelButton, &quot;cancelButton&quot;);
+  GLADE_HOOKUP_OBJECT (swiss_army_knife_dialog, okButton, &quot;okButton&quot;);
+
+  return swiss_army_knife_dialog;
+}
+
+#endif

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_contrast.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_contrast.cpp	2007-09-30 16:29:29 UTC (rev 3607)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_contrast.cpp	2007-09-30 16:49:31 UTC (rev 3608)
@@ -1,5 +1,5 @@
 /***************************************************************************
-                          ADM_guiContrast.cpp  -  description
+                          DIA_contrast.cpp  -  description
                              -------------------
     begin                : Mon Sep 23 2002
     copyright            : (C) 2002 by mean
@@ -69,7 +69,7 @@
 
         dialog=create_dialog1();
         gtk_register_dialog(dialog);
-        gtk_window_set_title (GTK_WINDOW (dialog), QT_TR_NOOP(&quot;ASHARP&quot;));
+        gtk_window_set_title (GTK_WINDOW (dialog), QT_TR_NOOP(&quot;Contrast&quot;));
         gtk_widget_show(dialog);	
         
           // and value changed

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_crop.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_crop.cpp	2007-09-30 16:29:29 UTC (rev 3607)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_crop.cpp	2007-09-30 16:49:31 UTC (rev 3608)
@@ -20,14 +20,11 @@
  *                                                                         *
  ***************************************************************************/
 
-#include &lt;config.h&gt;
-#include &lt;string.h&gt;
-#include &lt;stdio.h&gt;
+#include &quot;default.h&quot;
+
 #include &lt;gdk/gdkkeysyms.h&gt;
 #include &lt;gtk/gtk.h&gt;
-#include &lt;math.h&gt;
 
-#include &quot;default.h&quot;
 #include &quot;ADM_toolkit_gtk/toolkit_gtk.h&quot;
 #include &quot;ADM_toolkit_gtk/toolkit_gtk_include.h&quot;
 #include &quot;ADM_toolkit/toolkit.hxx&quot;

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_flyDialog.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_flyDialog.cpp	2007-09-30 16:29:29 UTC (rev 3607)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_flyDialog.cpp	2007-09-30 16:49:31 UTC (rev 3608)
@@ -12,15 +12,15 @@
 *                                                                         *
 ***************************************************************************///
 
-#include &quot;config.h&quot;
+#include &quot;default.h&quot;
 
 #include &lt;gtk/gtk.h&gt;
 
-#include &quot;default.h&quot;
 #include &quot;ADM_toolkit_gtk/toolkit_gtk.h&quot;
 #include &quot;ADM_toolkit_gtk/toolkit_gtk_include.h&quot;
 #include &quot;ADM_video/ADM_genvideo.hxx&quot;
 #include &quot;DIA_flyDialog.h&quot;
+#include &quot;DIA_factory.h&quot;
 #include &quot;ADM_assert.h&quot;
 
 extern void GUI_RGBDisplay(uint8_t * dis, uint32_t w, uint32_t h, void *widg);
@@ -84,4 +84,82 @@
 	return 0; 
 }
 
+void ADM_flyDialog::setupMenus (const void * params, 
+                                const MenuMapping * menu_mapping,
+                                uint32_t menu_mapping_count)
+{
+    // Fill in menus
+
+    ADM_assert (_cookie); // should be the dialog pointer
+    GtkDialog * dialog = static_cast &lt;GtkDialog *&gt; (_cookie);
+
+    for (int menu_index = 0; menu_index &lt; menu_mapping_count; menu_index++)
+    {
+        const MenuMapping &amp; mm = menu_mapping [menu_index];
+        const uint32_t * theParam
+            = (reinterpret_cast &lt;const uint32_t *&gt;
+               (mm.paramOffset + reinterpret_cast &lt;const char *&gt; (params)));
+        // printf (&quot;setupMenus: %s: params %p + offset 0x%x = %p\n&quot;,
+        //         mm.widgetName, params, mm.paramOffset, theParam);
+
+        GtkComboBox * combo
+            = GTK_COMBO_BOX (lookup_widget (GTK_WIDGET(dialog),
+                                            mm.widgetName));
+        int found = -1;
+        for (int item_index = 0; item_index &lt; mm.count; item_index++)
+        {
+            gtk_combo_box_append_text (combo, mm.menu [item_index].text);
+            if (mm.menu [item_index].val == *theParam)
+            {
+                gtk_combo_box_set_active (combo, item_index);
+                found = item_index;
+            }
+        }
+
+        // printf (&quot;setupMenus: %s: current is %d (%d)\n&quot;,
+        //         mm.widgetName, found, *theParam);
+    }
+}
+
+uint32_t ADM_flyDialog::getMenuValue (const MenuMapping * mm)
+{
+    ADM_assert (_cookie); // should be the dialog pointer
+    GtkDialog * dialog = static_cast &lt;GtkDialog *&gt; (_cookie);
+    GtkComboBox * combo
+        = GTK_COMBO_BOX (lookup_widget (GTK_WIDGET(dialog), mm-&gt;widgetName));
+    uint32_t currValue = gtk_combo_box_get_active (combo);
+    ADM_assert (currValue &lt; mm-&gt;count);
+
+    return (mm-&gt;menu [currValue].val);
+}
+
+void ADM_flyDialog::getMenuValues (void * params,
+                                   const MenuMapping * menu_mapping,
+                                   uint32_t menu_mapping_count)
+{
+    for (int menu_index = 0; menu_index &lt; menu_mapping_count; menu_index++)
+    {
+        const MenuMapping &amp; mm = menu_mapping [menu_index];
+        uint32_t * theParam = reinterpret_cast &lt;uint32_t *&gt;
+                              (mm.paramOffset
+                               + reinterpret_cast &lt;char *&gt; (params));
+        *theParam = getMenuValue (&amp;mm);
+    }
+}
+
+const MenuMapping *
+ADM_flyDialog::lookupMenu (const char * widgetName,
+                           const MenuMapping * menu_mapping,
+                           uint32_t menu_mapping_count)
+{
+    for (int menu_index = 0; menu_index &lt; menu_mapping_count; menu_index++)
+    {
+        const MenuMapping * mm = menu_mapping + menu_index;
+        if (strcmp (mm-&gt;widgetName, widgetName) == 0)
+            return mm;
+    }
+
+    return 0;
+}
+
 //EOF

Added: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_particle.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_particle.cpp	2007-09-30 16:29:29 UTC (rev 3607)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_particle.cpp	2007-09-30 16:49:31 UTC (rev 3608)
@@ -0,0 +1,704 @@
+/***************************************************************************
+                          DIA_particle.cpp  -  configuration dialog for
+						particle filter
+                              -------------------
+                         Chris MacGregor, September 2007
+                         <A HREF="https://lists.berlios.de/mailman/listinfo/avidemux-svn-commit">chris-avidemux at bouncingdog.com</A>
+ ***************************************************************************/
+
+/***************************************************************************
+ *                                                                         *
+ *   This program is free software; you can redistribute it and/or modify  *
+ *   it under the terms of the GNU General Public License as published by  *
+ *   the Free Software Foundation; either version 2 of the License, or     *
+ *   (at your option) any later version.                                   *
+ *                                                                         *
+ ***************************************************************************/
+
+#include &quot;default.h&quot;
+
+#include &lt;gtk/gtk.h&gt;
+
+#include &quot;fourcc.h&quot;
+#include &quot;avio.hxx&quot;
+#include &quot;prefs.h&quot;
+
+#include &quot;avi_vars.h&quot;
+
+#ifdef HAVE_ENCODER
+
+#include &quot;ADM_editor/ADM_edit.hxx&quot;
+#include &quot;ADM_video/ADM_genvideo.hxx&quot;
+#include &quot;ADM_videoFilter/ADM_vidParticle.h&quot;
+#include &quot;ADM_toolkit/toolkit.hxx&quot;
+#include &quot;ADM_toolkit_gtk/ADM_gladeSupport.h&quot;
+#include &quot;ADM_toolkit_gtk/toolkit_gtk.h&quot;
+#include &quot;ADM_toolkit_gtk/toolkit_gtk_include.h&quot;
+#include &quot;ADM_toolkit/filesel.h&quot;
+#include &quot;ADM_assert.h&quot;
+#include &quot;DIA_flyDialog.h&quot;
+#include &quot;DIA_flyParticle.h&quot;
+#include &quot;ADM_userInterfaces/ADM_commonUI/DIA_factory.h&quot; // for diaElemMenu etc.
+
+/********************************************************************/
+static GtkWidget *create_particle_dialog (void);
+static GtkWidget *dialog = 0;
+
+static volatile int lock = 0;
+
+/********************************************************************/
+
+static gboolean previewButtonEvent (GtkWidget *,
+                                    GdkEventButton * event,
+                                    gpointer data)
+{
+    if (event-&gt;type != GDK_BUTTON_PRESS)
+        return FALSE;
+
+    uint32_t x = static_cast &lt;uint32_t&gt; (event-&gt;x);
+    uint32_t y = static_cast &lt;uint32_t&gt; (event-&gt;y);
+
+    flyParticle * myFly = static_cast &lt;flyParticle *&gt; (data);
+    ADMImage * image = event-&gt;button == 1
+        ? myFly-&gt;getInputImage() : myFly-&gt;getOutputImage();
+
+    uint32_t width = image-&gt;_width;
+    uint32_t height = image-&gt;_height;
+
+    if (x &gt;= width || y &gt;= height)
+        return FALSE;
+
+    uint8_t range = 3;
+    if (event-&gt;state &amp; GDK_SHIFT_MASK)
+        range += 2;
+    if (event-&gt;state &amp; GDK_CONTROL_MASK)
+        range += 4;
+    if (event-&gt;state &amp; GDK_MOD1_MASK)
+        range += 6;
+
+    uint8_t halfrange = range / 2;
+
+    uint32_t xmin = (x &gt; halfrange) ? x - halfrange : 0;
+    uint32_t ymin = (y &gt; halfrange) ? y - halfrange : 0;
+
+    uint32_t xmax = x + halfrange;
+    uint32_t ymax = y + halfrange;
+
+    if (xmax &gt;= width)
+        xmax = width - 1;
+    if (ymax &gt;= height)
+        ymax = height - 1;
+
+    uint8_t * imagepix = YPLANE (image);
+
+    printf (&quot;\n  x|&quot;);
+    for (x = xmin; x &lt;= xmax; x++)
+        printf (&quot; %3d&quot;, x);
+    printf (&quot;\ny: +&quot;);
+    for (x = xmin; x &lt;= xmax; x++)
+        printf (&quot; ---&quot;, x);
+    printf (&quot;\n&quot;);
+
+    for (y = ymin; y &lt;= ymax; y++)
+    {
+        uint8_t * pixp = imagepix + (y * width) + xmin;
+        printf (&quot;%3d|&quot;, y);
+        for (x = xmin; x &lt;= xmax; x++)
+            printf (&quot; %3d&quot;, *pixp++);
+        printf (&quot;\n&quot;);
+    }
+
+    return TRUE;
+}
+
+static void frame_changed (GtkRange *, gpointer user_data)
+{
+    flyParticle * myDialog = static_cast &lt;flyParticle *&gt; (user_data);
+    myDialog-&gt;sliderChanged();
+}
+
+static void gui_update (GtkObject *, gpointer user_data)
+{
+    if (lock)
+        return;
+
+    flyParticle * myDialog = static_cast &lt;flyParticle *&gt; (user_data);
+    myDialog-&gt;getInputImage(); // refresh the input data
+    myDialog-&gt;update();
+}
+
+static gboolean gui_draw (GtkWidget * widget, GdkEventExpose * event,
+                          gpointer user_data)
+{
+    flyParticle * myDialog = static_cast &lt;flyParticle *&gt; (user_data);
+    myDialog-&gt;display();
+    return TRUE;
+}
+
+static void browse_button_clicked (GtkButton *, gpointer user_data)
+{
+    flyParticle * myDialog = static_cast &lt;flyParticle *&gt; (user_data);
+
+    // First, determine a default output file if we don't already have an
+    // output file.
+
+    const char * filename
+        = gtk_entry_get_text (GTK_ENTRY(WID(outputFileEntry)));
+    const int MAX_SEL = 2048;
+    char buffer [MAX_SEL + 1];
+    const char * lastfilename;
+    const char * defaultSuffix = &quot;pts&quot;;
+    if ((!filename || !*filename)
+        &amp;&amp; prefs-&gt;get (LASTFILES_FILE1, (ADM_filename **)&amp;lastfilename))
+    {
+        strcpy (buffer, lastfilename);
+        char * cptr = buffer + strlen (buffer);
+        while (cptr &gt; buffer)
+        {
+            if (*cptr == '.')
+            {
+                strcpy (cptr + 1, defaultSuffix);
+                filename = buffer;
+                printf (&quot;Default output filename is %s based on %s + %s\n&quot;,
+                        filename, lastfilename, defaultSuffix);
+                break;
+            }
+            --cptr;
+        }
+    }
+    else if (!filename)
+        filename = &quot;&quot;;
+
+    if (FileSel_SelectWrite (&quot;Write Particle List to File&quot;,
+                             buffer, MAX_SEL, filename))
+    {
+        gtk_entry_set_text (GTK_ENTRY(WID(outputFileEntry)), buffer);
+    }
+}
+
+/********************************************************************/
+
+uint8_t DIA_particle (AVDMGenericVideoStream *in,
+                      PARTICLE_PARAM * param,
+                      const MenuMapping * menu_mapping,
+                      uint32_t menu_mapping_count)
+{
+    // Allocate space for preview video
+    uint32_t width = in-&gt;getInfo()-&gt;width;
+    uint32_t height = in-&gt;getInfo()-&gt;height;
+
+    dialog = create_particle_dialog();
+    gtk_register_dialog (dialog);
+    gtk_window_set_title (GTK_WINDOW (dialog),
+                          QT_TR_NOOP(&quot;Particle Analysis Configuration&quot;));
+    gtk_widget_show (dialog);	
+
+    // Fix up a bunch of things that Glade can't do.  This is less efficient
+    // than just editing the Glade output, but it's not that big a deal and
+    // doing it this way makes it MUCH easier to use Glade to tweak the layout
+    // later.
+
+    // actually, nothing to fix up in this one.  But if there ever is, this is
+    // the place to do it...
+
+    flyParticle * myDialog
+        = new flyParticle (width, height, in,
+                           WID(previewVideo), WID(previewSlider),
+                           GTK_DIALOG(dialog), param,
+                           menu_mapping, menu_mapping_count);
+    myDialog-&gt;upload();
+    myDialog-&gt;sliderChanged();
+
+    g_signal_connect (GTK_OBJECT(WID(outputFileBrowseButton)), &quot;clicked&quot;,
+                      GTK_SIGNAL_FUNC(browse_button_clicked),
+                      gpointer(myDialog));
+
+    // update things when settings are changed
+#define CNX(_widg,_signame) \
+    g_signal_connect (GTK_OBJECT(WID(_widg)), _signame,                \
+                      GTK_SIGNAL_FUNC(gui_update), gpointer(myDialog));
+
+    CNX (minAreaSpinButton, &quot;value_changed&quot;);
+    CNX (maxAreaSpinButton, &quot;value_changed&quot;);
+    CNX (leftCropSpinButton, &quot;value_changed&quot;);
+    CNX (rightCropSpinButton, &quot;value_changed&quot;);
+    CNX (topCropSpinButton, &quot;value_changed&quot;);
+    CNX (bottomCropSpinButton, &quot;value_changed&quot;);
+
+    g_signal_connect (GTK_OBJECT(WID(previewSlider)), &quot;value_changed&quot;,
+                      GTK_SIGNAL_FUNC(frame_changed), gpointer(myDialog));
+    g_signal_connect (GTK_OBJECT(WID(previewVideo)), &quot;expose_event&quot;,
+                      GTK_SIGNAL_FUNC(gui_draw), gpointer(myDialog));
+
+    g_signal_connect (GTK_OBJECT(WID(previewVideo)), &quot;button_press_event&quot;,
+                      GTK_SIGNAL_FUNC(previewButtonEvent),
+                      gpointer(myDialog));
+#if 0
+    g_signal_connect (GTK_OBJECT(WID(previewVideo)), &quot;motion_notify_event&quot;,
+                      GTK_SIGNAL_FUNC(previewMotionEvent),
+                      gpointer(myDialog));
+#endif
+
+    uint8_t ret = 0;
+    int response = gtk_dialog_run(GTK_DIALOG(dialog));
+
+    if (response == GTK_RESPONSE_OK)
+    {
+        myDialog-&gt;download();
+        myDialog-&gt;getParam (param);
+        ret = 1;
+    }
+
+    gtk_unregister_dialog(dialog);
+    gtk_widget_destroy(dialog);
+
+    delete myDialog;
+
+    return ret;
+}
+
+/**************************************/
+
+uint8_t flyParticle::upload (void)
+{
+    lock++;
+
+    gtk_entry_set_text (GTK_ENTRY(WID(outputFileEntry)),
+                        param.output_file.c_str());
+
+    gtk_spin_button_set_value
+        (GTK_SPIN_BUTTON(WID(minAreaSpinButton)), param.min_area);
+    gtk_spin_button_set_value
+        (GTK_SPIN_BUTTON(WID(maxAreaSpinButton)), param.max_area);
+    gtk_spin_button_set_value
+        (GTK_SPIN_BUTTON(WID(leftCropSpinButton)), param.left_crop);
+    gtk_spin_button_set_value
+        (GTK_SPIN_BUTTON(WID(rightCropSpinButton)), param.right_crop);
+    gtk_spin_button_set_value
+        (GTK_SPIN_BUTTON(WID(topCropSpinButton)), param.top_crop);
+    gtk_spin_button_set_value
+        (GTK_SPIN_BUTTON(WID(bottomCropSpinButton)), param.bottom_crop);
+
+    lock--;
+    return 1;
+}
+
+uint8_t flyParticle::download (void)
+{
+    getMenuValues();
+
+    const char * filename =
+        gtk_entry_get_text (GTK_ENTRY(WID(outputFileEntry)));
+
+    // Note that the documentation states clearly that the result of
+    // gtk_entry_get_text() must NOT be freed, modified, or stored.  This is
+    // different than gtk_file_chooser_get_filename(), which returns a pointer
+    // which must eventually be passed to g_free().
+
+    if (filename)
+        param.output_file = filename;
+    else
+        param.output_file = &quot;&quot;;
+
+    param.min_area
+        = gtk_spin_button_get_value_as_int
+        (GTK_SPIN_BUTTON(WID(minAreaSpinButton)));
+    param.max_area
+        = gtk_spin_button_get_value_as_int
+        (GTK_SPIN_BUTTON(WID(maxAreaSpinButton)));
+    param.left_crop
+        = gtk_spin_button_get_value_as_int
+        (GTK_SPIN_BUTTON(WID(leftCropSpinButton)));
+    param.right_crop
+        = gtk_spin_button_get_value_as_int
+        (GTK_SPIN_BUTTON(WID(rightCropSpinButton)));
+    param.top_crop
+        = gtk_spin_button_get_value_as_int
+        (GTK_SPIN_BUTTON(WID(topCropSpinButton)));
+    param.bottom_crop
+        = gtk_spin_button_get_value_as_int
+        (GTK_SPIN_BUTTON(WID(bottomCropSpinButton)));
+    param.camera_number
+        = gtk_spin_button_get_value_as_int
+        (GTK_SPIN_BUTTON(WID(cameraNumberSpinButton)));
+    param.debug
+        = gtk_spin_button_get_value_as_int
+        (GTK_SPIN_BUTTON(WID(debugSpinButton)));
+
+    return 1;
+}
+
+#define _(_str) QT_TR_NOOP(_str)
+
+// The following was generated by glade from particle.glade once upon a time
+// (in fact, several times, since it took a few tries to get it right!  :-).
+// Thus far, I've avoided editing it, so regenerating the code from Glade (I
+// used 2.12.1) and swapping it in here should not lose anything.  All the
+// tweaking and adjusting and signal-connecting is done in code above, which
+// is maintained by hand, and which has some knowledge of the names and layout
+// of the widgets (so be cautious about renaming things!).
+
+GtkWidget*
+create_particle_dialog (void)
+{
+  GtkWidget *particle_dialog;
+  GtkWidget *dialogVbox;
+  GtkWidget *dialogHbox;
+  GtkWidget *allButButtonsVbox;
+  GtkWidget *settingsOuterHbox;
+  GtkWidget *settingsOuterVbox;
+  GtkWidget *minAreaHbox;
+  GtkWidget *minAreaLabel;
+  GtkObject *minAreaSpinButton_adj;
+  GtkWidget *minAreaSpinButton;
+  GtkWidget *maxAreaHbox;
+  GtkWidget *maxAreaLabel;
+  GtkObject *maxAreaSpinButton_adj;
+  GtkWidget *maxAreaSpinButton;
+  GtkWidget *aboveCropSeparator;
+  GtkWidget *leftCropHbox;
+  GtkWidget *leftCropLabel;
+  GtkObject *leftCropSpinButton_adj;
+  GtkWidget *leftCropSpinButton;
+  GtkWidget *rightCropHbox;
+  GtkWidget *rightCropLabel;
+  GtkObject *rightCropSpinButton_adj;
+  GtkWidget *rightCropSpinButton;
+  GtkWidget *topCropHbox;
+  GtkWidget *topCropLabel;
+  GtkObject *topCropSpinButton_adj;
+  GtkWidget *topCropSpinButton;
+  GtkWidget *bottomCropHbox;
+  GtkWidget *bottomCropLabel;
+  GtkObject *bottomCropSpinButton_adj;
+  GtkWidget *bottomCropSpinButton;
+  GtkWidget *belowCropSeparator;
+  GtkWidget *outputFormatHbox;
+  GtkWidget *outputFormatLabel;
+  GtkWidget *outputFormatMenu;
+  GtkWidget *outputFileHbox;
+  GtkWidget *outputFileLabel;
+  GtkWidget *outputFileEntry;
+  GtkWidget *outputFileBrowseButton;
+  GtkWidget *cameraNumberHbox;
+  GtkWidget *cameraNumberLabel;
+  GtkObject *cameraNumberSpinButton_adj;
+  GtkWidget *cameraNumberSpinButton;
+  GtkWidget *debugHbox;
+  GtkWidget *debugLabel;
+  GtkObject *debugSpinButton_adj;
+  GtkWidget *debugSpinButton;
+  GtkWidget *previewVboxOuter;
+  GtkWidget *previewFrame;
+  GtkWidget *previewAlignment;
+  GtkWidget *previewVbox;
+  GtkWidget *previewControlHbox;
+  GtkWidget *previewOutputMenu;
+  GtkWidget *previewSlider;
+  GtkWidget *previewVideo;
+  GtkWidget *previewDisabled;
+  GtkWidget *previewLabel;
+  GtkWidget *dialogButtonBox;
+  GtkWidget *cancelButton;
+  GtkWidget *okButton;
+
+  particle_dialog = gtk_dialog_new ();
+  gtk_window_set_title (GTK_WINDOW (particle_dialog), _(&quot;Particle Detection&quot;));
+  gtk_window_set_type_hint (GTK_WINDOW (particle_dialog), GDK_WINDOW_TYPE_HINT_DIALOG);
+
+  dialogVbox = GTK_DIALOG (particle_dialog)-&gt;vbox;
+  gtk_widget_show (dialogVbox);
+
+  dialogHbox = gtk_hbox_new (FALSE, 0);
+  gtk_widget_show (dialogHbox);
+  gtk_box_pack_start (GTK_BOX (dialogVbox), dialogHbox, TRUE, TRUE, 0);
+
+  allButButtonsVbox = gtk_vbox_new (FALSE, 12);
+  gtk_widget_show (allButButtonsVbox);
+  gtk_box_pack_start (GTK_BOX (dialogHbox), allButButtonsVbox, TRUE, TRUE, 0);
+  gtk_container_set_border_width (GTK_CONTAINER (allButButtonsVbox), 8);
+
+  settingsOuterHbox = gtk_hbox_new (FALSE, 0);
+  gtk_widget_show (settingsOuterHbox);
+  gtk_box_pack_start (GTK_BOX (allButButtonsVbox), settingsOuterHbox, FALSE, TRUE, 0);
+
+  settingsOuterVbox = gtk_vbox_new (FALSE, 12);
+  gtk_widget_show (settingsOuterVbox);
+  gtk_box_pack_start (GTK_BOX (settingsOuterHbox), settingsOuterVbox, TRUE, TRUE, 0);
+
+  minAreaHbox = gtk_hbox_new (FALSE, 0);
+  gtk_widget_show (minAreaHbox);
+  gtk_box_pack_start (GTK_BOX (settingsOuterVbox), minAreaHbox, TRUE, TRUE, 0);
+
+  minAreaLabel = gtk_label_new_with_mnemonic (_(&quot;Mi_nimum area for a particle to be detected:    &quot;));
+  gtk_widget_show (minAreaLabel);
+  gtk_box_pack_start (GTK_BOX (minAreaHbox), minAreaLabel, FALSE, FALSE, 0);
+
+  minAreaSpinButton_adj = gtk_adjustment_new (5, 1, 999999, 1, 1, 0);
+  minAreaSpinButton = gtk_spin_button_new (GTK_ADJUSTMENT (minAreaSpinButton_adj), 1, 0);
+  gtk_widget_show (minAreaSpinButton);
+  gtk_box_pack_start (GTK_BOX (minAreaHbox), minAreaSpinButton, TRUE, TRUE, 0);
+  gtk_spin_button_set_numeric (GTK_SPIN_BUTTON (minAreaSpinButton), TRUE);
+
+  maxAreaHbox = gtk_hbox_new (FALSE, 0);
+  gtk_widget_show (maxAreaHbox);
+  gtk_box_pack_start (GTK_BOX (settingsOuterVbox), maxAreaHbox, TRUE, TRUE, 0);
+
+  maxAreaLabel = gtk_label_new_with_mnemonic (_(&quot;Ma_ximum area for a particle to be detected:   &quot;));
+  gtk_widget_show (maxAreaLabel);
+  gtk_box_pack_start (GTK_BOX (maxAreaHbox), maxAreaLabel, FALSE, FALSE, 0);
+
+  maxAreaSpinButton_adj = gtk_adjustment_new (50000, 1, 999999, 1, 1, 0);
+  maxAreaSpinButton = gtk_spin_button_new (GTK_ADJUSTMENT (maxAreaSpinButton_adj), 1, 0);
+  gtk_widget_show (maxAreaSpinButton);
+  gtk_box_pack_start (GTK_BOX (maxAreaHbox), maxAreaSpinButton, TRUE, TRUE, 0);
+  gtk_spin_button_set_numeric (GTK_SPIN_BUTTON (maxAreaSpinButton), TRUE);
+
+  aboveCropSeparator = gtk_hseparator_new ();
+  gtk_widget_show (aboveCropSeparator);
+  gtk_box_pack_start (GTK_BOX (settingsOuterVbox), aboveCropSeparator, TRUE, TRUE, 0);
+
+  leftCropHbox = gtk_hbox_new (FALSE, 0);
+  gtk_widget_show (leftCropHbox);
+  gtk_box_pack_start (GTK_BOX (settingsOuterVbox), leftCropHbox, TRUE, TRUE, 0);
+
+  leftCropLabel = gtk_label_new_with_mnemonic (_(&quot;_Left side crop (ignore this many pixels on the left):        &quot;));
+  gtk_widget_show (leftCropLabel);
+  gtk_box_pack_start (GTK_BOX (leftCropHbox), leftCropLabel, FALSE, FALSE, 0);
+
+  leftCropSpinButton_adj = gtk_adjustment_new (0, 0, 2048, 1, 1, 0);
+  leftCropSpinButton = gtk_spin_button_new (GTK_ADJUSTMENT (leftCropSpinButton_adj), 1, 0);
+  gtk_widget_show (leftCropSpinButton);
+  gtk_box_pack_start (GTK_BOX (leftCropHbox), leftCropSpinButton, TRUE, TRUE, 0);
+  gtk_spin_button_set_numeric (GTK_SPIN_BUTTON (leftCropSpinButton), TRUE);
+
+  rightCropHbox = gtk_hbox_new (FALSE, 0);
+  gtk_widget_show (rightCropHbox);
+  gtk_box_pack_start (GTK_BOX (settingsOuterVbox), rightCropHbox, TRUE, TRUE, 0);
+
+  rightCropLabel = gtk_label_new_with_mnemonic (_(&quot;_Right side crop (ignore this many pixels on the right):     &quot;));
+  gtk_widget_show (rightCropLabel);
+  gtk_box_pack_start (GTK_BOX (rightCropHbox), rightCropLabel, FALSE, FALSE, 0);
+
+  rightCropSpinButton_adj = gtk_adjustment_new (0, 0, 2048, 1, 1, 0);
+  rightCropSpinButton = gtk_spin_button_new (GTK_ADJUSTMENT (rightCropSpinButton_adj), 1, 0);
+  gtk_widget_show (rightCropSpinButton);
+  gtk_box_pack_start (GTK_BOX (rightCropHbox), rightCropSpinButton, TRUE, TRUE, 0);
+  gtk_spin_button_set_numeric (GTK_SPIN_BUTTON (rightCropSpinButton), TRUE);
+
+  topCropHbox = gtk_hbox_new (FALSE, 0);
+  gtk_widget_show (topCropHbox);
+  gtk_box_pack_start (GTK_BOX (settingsOuterVbox), topCropHbox, TRUE, TRUE, 0);
+
+  topCropLabel = gtk_label_new_with_mnemonic (_(&quot;_Top crop (ignore this many pixels on the top):                  &quot;));
+  gtk_widget_show (topCropLabel);
+  gtk_box_pack_start (GTK_BOX (topCropHbox), topCropLabel, FALSE, FALSE, 0);
+
+  topCropSpinButton_adj = gtk_adjustment_new (0, 0, 2048, 1, 1, 0);
+  topCropSpinButton = gtk_spin_button_new (GTK_ADJUSTMENT (topCropSpinButton_adj), 1, 0);
+  gtk_widget_show (topCropSpinButton);
+  gtk_box_pack_start (GTK_BOX (topCropHbox), topCropSpinButton, TRUE, TRUE, 0);
+  gtk_spin_button_set_numeric (GTK_SPIN_BUTTON (topCropSpinButton), TRUE);
+
+  bottomCropHbox = gtk_hbox_new (FALSE, 0);
+  gtk_widget_show (bottomCropHbox);
+  gtk_box_pack_start (GTK_BOX (settingsOuterVbox), bottomCropHbox, TRUE, TRUE, 0);
+
+  bottomCropLabel = gtk_label_new_with_mnemonic (_(&quot;_Bottom crop (ignore this many pixels on the bottom):   &quot;));
+  gtk_widget_show (bottomCropLabel);
+  gtk_box_pack_start (GTK_BOX (bottomCropHbox), bottomCropLabel, FALSE, FALSE, 0);
+
+  bottomCropSpinButton_adj = gtk_adjustment_new (0, 0, 2048, 1, 1, 0);
+  bottomCropSpinButton = gtk_spin_button_new (GTK_ADJUSTMENT (bottomCropSpinButton_adj), 1, 0);
+  gtk_widget_show (bottomCropSpinButton);
+  gtk_box_pack_start (GTK_BOX (bottomCropHbox), bottomCropSpinButton, TRUE, TRUE, 0);
+  gtk_spin_button_set_numeric (GTK_SPIN_BUTTON (bottomCropSpinButton), TRUE);
+
+  belowCropSeparator = gtk_hseparator_new ();
+  gtk_widget_show (belowCropSeparator);
+  gtk_box_pack_start (GTK_BOX (settingsOuterVbox), belowCropSeparator, TRUE, TRUE, 0);
+
+  outputFormatHbox = gtk_hbox_new (FALSE, 0);
+  gtk_widget_show (outputFormatHbox);
+  gtk_box_pack_start (GTK_BOX (settingsOuterVbox), outputFormatHbox, TRUE, TRUE, 0);
+
+  outputFormatLabel = gtk_label_new_with_mnemonic (_(&quot;Output _Format:   &quot;));
+  gtk_widget_show (outputFormatLabel);
+  gtk_box_pack_start (GTK_BOX (outputFormatHbox), outputFormatLabel, FALSE, FALSE, 0);
+
+  outputFormatMenu = gtk_combo_box_new_text ();
+  gtk_widget_show (outputFormatMenu);
+  gtk_box_pack_start (GTK_BOX (outputFormatHbox), outputFormatMenu, TRUE, TRUE, 0);
+
+  outputFileHbox = gtk_hbox_new (FALSE, 5);
+  gtk_widget_show (outputFileHbox);
+  gtk_box_pack_start (GTK_BOX (settingsOuterVbox), outputFileHbox, TRUE, TRUE, 0);
+
+  outputFileLabel = gtk_label_new_with_mnemonic (_(&quot;_Output File:&quot;));
+  gtk_widget_show (outputFileLabel);
+  gtk_box_pack_start (GTK_BOX (outputFileHbox), outputFileLabel, FALSE, FALSE, 0);
+
+  outputFileEntry = gtk_entry_new ();
+  gtk_widget_show (outputFileEntry);
+  gtk_box_pack_start (GTK_BOX (outputFileHbox), outputFileEntry, TRUE, TRUE, 0);
+  gtk_entry_set_invisible_char (GTK_ENTRY (outputFileEntry), 8226);
+  gtk_entry_set_width_chars (GTK_ENTRY (outputFileEntry), 40);
+
+  outputFileBrowseButton = gtk_button_new_with_mnemonic (_(&quot;_Browse...&quot;));
+  gtk_widget_show (outputFileBrowseButton);
+  gtk_box_pack_start (GTK_BOX (outputFileHbox), outputFileBrowseButton, FALSE, FALSE, 0);
+
+  cameraNumberHbox = gtk_hbox_new (FALSE, 0);
+  gtk_widget_show (cameraNumberHbox);
+  gtk_box_pack_start (GTK_BOX (settingsOuterVbox), cameraNumberHbox, TRUE, TRUE, 0);
+
+  cameraNumberLabel = gtk_label_new_with_mnemonic (_(&quot;_Camera Number for output file:      &quot;));
+  gtk_widget_show (cameraNumberLabel);
+  gtk_box_pack_start (GTK_BOX (cameraNumberHbox), cameraNumberLabel, FALSE, FALSE, 0);
+
+  cameraNumberSpinButton_adj = gtk_adjustment_new (1, 0, 99999, 1, 1, 0);
+  cameraNumberSpinButton = gtk_spin_button_new (GTK_ADJUSTMENT (cameraNumberSpinButton_adj), 1, 0);
+  gtk_widget_show (cameraNumberSpinButton);
+  gtk_box_pack_start (GTK_BOX (cameraNumberHbox), cameraNumberSpinButton, TRUE, TRUE, 0);
+  gtk_spin_button_set_numeric (GTK_SPIN_BUTTON (cameraNumberSpinButton), TRUE);
+
+  debugHbox = gtk_hbox_new (FALSE, 0);
+  gtk_widget_show (debugHbox);
+  gtk_box_pack_start (GTK_BOX (settingsOuterVbox), debugHbox, TRUE, TRUE, 0);
+
+  debugLabel = gtk_label_new_with_mnemonic (_(&quot;_Debugging settings (bits):   &quot;));
+  gtk_widget_show (debugLabel);
+  gtk_box_pack_start (GTK_BOX (debugHbox), debugLabel, FALSE, FALSE, 0);
+
+  debugSpinButton_adj = gtk_adjustment_new (0, 0, 16777215, 1, 10, 0);
+  debugSpinButton = gtk_spin_button_new (GTK_ADJUSTMENT (debugSpinButton_adj), 1, 0);
+  gtk_widget_show (debugSpinButton);
+  gtk_box_pack_start (GTK_BOX (debugHbox), debugSpinButton, TRUE, TRUE, 0);
+  gtk_spin_button_set_numeric (GTK_SPIN_BUTTON (debugSpinButton), TRUE);
+
+  previewVboxOuter = gtk_vbox_new (FALSE, 0);
+  gtk_widget_show (previewVboxOuter);
+  gtk_box_pack_start (GTK_BOX (allButButtonsVbox), previewVboxOuter, TRUE, TRUE, 0);
+
+  previewFrame = gtk_frame_new (NULL);
+  gtk_widget_show (previewFrame);
+  gtk_box_pack_start (GTK_BOX (previewVboxOuter), previewFrame, FALSE, TRUE, 0);
+
+  previewAlignment = gtk_alignment_new (0.5, 0.5, 1, 1);
+  gtk_widget_show (previewAlignment);
+  gtk_container_add (GTK_CONTAINER (previewFrame), previewAlignment);
+  gtk_alignment_set_padding (GTK_ALIGNMENT (previewAlignment), 0, 8, 6, 8);
+
+  previewVbox = gtk_vbox_new (FALSE, 5);
+  gtk_widget_show (previewVbox);
+  gtk_container_add (GTK_CONTAINER (previewAlignment), previewVbox);
+
+  previewControlHbox = gtk_hbox_new (FALSE, 5);
+  gtk_widget_show (previewControlHbox);
+  gtk_box_pack_start (GTK_BOX (previewVbox), previewControlHbox, TRUE, TRUE, 0);
+
+  previewOutputMenu = gtk_combo_box_new_text ();
+  gtk_box_pack_start (GTK_BOX (previewControlHbox), previewOutputMenu, FALSE, TRUE, 0);
+  gtk_combo_box_append_text (GTK_COMBO_BOX (previewOutputMenu), _(&quot;Swiss Army Knife output&quot;));
+  gtk_combo_box_append_text (GTK_COMBO_BOX (previewOutputMenu), _(&quot;Final output&quot;));
+
+  previewSlider = gtk_hscale_new (GTK_ADJUSTMENT (gtk_adjustment_new (0, 0, 99, 1, 1, 0)));
+  gtk_widget_show (previewSlider);
+  gtk_box_pack_start (GTK_BOX (previewControlHbox), previewSlider, TRUE, TRUE, 0);
+  gtk_scale_set_digits (GTK_SCALE (previewSlider), 0);
+
+  previewVideo = gtk_drawing_area_new ();
+  gtk_widget_show (previewVideo);
+  gtk_box_pack_start (GTK_BOX (previewVbox), previewVideo, TRUE, TRUE, 0);
+  gtk_widget_set_size_request (previewVideo, -1, 300);
+  gtk_widget_set_events (previewVideo, GDK_BUTTON1_MOTION_MASK | GDK_BUTTON_PRESS_MASK);
+
+  previewDisabled = gtk_drawing_area_new ();
+  gtk_box_pack_start (GTK_BOX (previewVbox), previewDisabled, TRUE, TRUE, 0);
+
+  previewLabel = gtk_label_new (_(&quot;Preview&quot;));
+  gtk_widget_show (previewLabel);
+  gtk_frame_set_label_widget (GTK_FRAME (previewFrame), previewLabel);
+
+  dialogButtonBox = GTK_DIALOG (particle_dialog)-&gt;action_area;
+  gtk_widget_show (dialogButtonBox);
+  gtk_button_box_set_layout (GTK_BUTTON_BOX (dialogButtonBox), GTK_BUTTONBOX_END);
+
+  cancelButton = gtk_button_new_from_stock (&quot;gtk-cancel&quot;);
+  gtk_widget_show (cancelButton);
+  gtk_dialog_add_action_widget (GTK_DIALOG (particle_dialog), cancelButton, GTK_RESPONSE_CANCEL);
+  GTK_WIDGET_SET_FLAGS (cancelButton, GTK_CAN_DEFAULT);
+
+  okButton = gtk_button_new_from_stock (&quot;gtk-ok&quot;);
+  gtk_widget_show (okButton);
+  gtk_dialog_add_action_widget (GTK_DIALOG (particle_dialog), okButton, GTK_RESPONSE_OK);
+  GTK_WIDGET_SET_FLAGS (okButton, GTK_CAN_DEFAULT);
+
+  gtk_label_set_mnemonic_widget (GTK_LABEL (minAreaLabel), minAreaSpinButton);
+  gtk_label_set_mnemonic_widget (GTK_LABEL (maxAreaLabel), maxAreaSpinButton);
+  gtk_label_set_mnemonic_widget (GTK_LABEL (leftCropLabel), leftCropSpinButton);
+  gtk_label_set_mnemonic_widget (GTK_LABEL (rightCropLabel), rightCropSpinButton);
+  gtk_label_set_mnemonic_widget (GTK_LABEL (topCropLabel), topCropSpinButton);
+  gtk_label_set_mnemonic_widget (GTK_LABEL (bottomCropLabel), bottomCropSpinButton);
+  gtk_label_set_mnemonic_widget (GTK_LABEL (outputFileLabel), outputFileEntry);
+  gtk_label_set_mnemonic_widget (GTK_LABEL (cameraNumberLabel), cameraNumberSpinButton);
+  gtk_label_set_mnemonic_widget (GTK_LABEL (debugLabel), debugSpinButton);
+
+  /* Store pointers to all widgets, for use by lookup_widget(). */
+  GLADE_HOOKUP_OBJECT_NO_REF (particle_dialog, particle_dialog, &quot;particle_dialog&quot;);
+  GLADE_HOOKUP_OBJECT_NO_REF (particle_dialog, dialogVbox, &quot;dialogVbox&quot;);
+  GLADE_HOOKUP_OBJECT (particle_dialog, dialogHbox, &quot;dialogHbox&quot;);
+  GLADE_HOOKUP_OBJECT (particle_dialog, allButButtonsVbox, &quot;allButButtonsVbox&quot;);
+  GLADE_HOOKUP_OBJECT (particle_dialog, settingsOuterHbox, &quot;settingsOuterHbox&quot;);
+  GLADE_HOOKUP_OBJECT (particle_dialog, settingsOuterVbox, &quot;settingsOuterVbox&quot;);
+  GLADE_HOOKUP_OBJECT (particle_dialog, minAreaHbox, &quot;minAreaHbox&quot;);
+  GLADE_HOOKUP_OBJECT (particle_dialog, minAreaLabel, &quot;minAreaLabel&quot;);
+  GLADE_HOOKUP_OBJECT (particle_dialog, minAreaSpinButton, &quot;minAreaSpinButton&quot;);
+  GLADE_HOOKUP_OBJECT (particle_dialog, maxAreaHbox, &quot;maxAreaHbox&quot;);
+  GLADE_HOOKUP_OBJECT (particle_dialog, maxAreaLabel, &quot;maxAreaLabel&quot;);
+  GLADE_HOOKUP_OBJECT (particle_dialog, maxAreaSpinButton, &quot;maxAreaSpinButton&quot;);
+  GLADE_HOOKUP_OBJECT (particle_dialog, aboveCropSeparator, &quot;aboveCropSeparator&quot;);
+  GLADE_HOOKUP_OBJECT (particle_dialog, leftCropHbox, &quot;leftCropHbox&quot;);
+  GLADE_HOOKUP_OBJECT (particle_dialog, leftCropLabel, &quot;leftCropLabel&quot;);
+  GLADE_HOOKUP_OBJECT (particle_dialog, leftCropSpinButton, &quot;leftCropSpinButton&quot;);
+  GLADE_HOOKUP_OBJECT (particle_dialog, rightCropHbox, &quot;rightCropHbox&quot;);
+  GLADE_HOOKUP_OBJECT (particle_dialog, rightCropLabel, &quot;rightCropLabel&quot;);
+  GLADE_HOOKUP_OBJECT (particle_dialog, rightCropSpinButton, &quot;rightCropSpinButton&quot;);
+  GLADE_HOOKUP_OBJECT (particle_dialog, topCropHbox, &quot;topCropHbox&quot;);
+  GLADE_HOOKUP_OBJECT (particle_dialog, topCropLabel, &quot;topCropLabel&quot;);
+  GLADE_HOOKUP_OBJECT (particle_dialog, topCropSpinButton, &quot;topCropSpinButton&quot;);
+  GLADE_HOOKUP_OBJECT (particle_dialog, bottomCropHbox, &quot;bottomCropHbox&quot;);
+  GLADE_HOOKUP_OBJECT (particle_dialog, bottomCropLabel, &quot;bottomCropLabel&quot;);
+  GLADE_HOOKUP_OBJECT (particle_dialog, bottomCropSpinButton, &quot;bottomCropSpinButton&quot;);
+  GLADE_HOOKUP_OBJECT (particle_dialog, belowCropSeparator, &quot;belowCropSeparator&quot;);
+  GLADE_HOOKUP_OBJECT (particle_dialog, outputFormatHbox, &quot;outputFormatHbox&quot;);
+  GLADE_HOOKUP_OBJECT (particle_dialog, outputFormatLabel, &quot;outputFormatLabel&quot;);
+  GLADE_HOOKUP_OBJECT (particle_dialog, outputFormatMenu, &quot;outputFormatMenu&quot;);
+  GLADE_HOOKUP_OBJECT (particle_dialog, outputFileHbox, &quot;outputFileHbox&quot;);
+  GLADE_HOOKUP_OBJECT (particle_dialog, outputFileLabel, &quot;outputFileLabel&quot;);
+  GLADE_HOOKUP_OBJECT (particle_dialog, outputFileEntry, &quot;outputFileEntry&quot;);
+  GLADE_HOOKUP_OBJECT (particle_dialog, outputFileBrowseButton, &quot;outputFileBrowseButton&quot;);
+  GLADE_HOOKUP_OBJECT (particle_dialog, cameraNumberHbox, &quot;cameraNumberHbox&quot;);
+  GLADE_HOOKUP_OBJECT (particle_dialog, cameraNumberLabel, &quot;cameraNumberLabel&quot;);
+  GLADE_HOOKUP_OBJECT (particle_dialog, cameraNumberSpinButton, &quot;cameraNumberSpinButton&quot;);
+  GLADE_HOOKUP_OBJECT (particle_dialog, debugHbox, &quot;debugHbox&quot;);
+  GLADE_HOOKUP_OBJECT (particle_dialog, debugLabel, &quot;debugLabel&quot;);
+  GLADE_HOOKUP_OBJECT (particle_dialog, debugSpinButton, &quot;debugSpinButton&quot;);
+  GLADE_HOOKUP_OBJECT (particle_dialog, previewVboxOuter, &quot;previewVboxOuter&quot;);
+  GLADE_HOOKUP_OBJECT (particle_dialog, previewFrame, &quot;previewFrame&quot;);
+  GLADE_HOOKUP_OBJECT (particle_dialog, previewAlignment, &quot;previewAlignment&quot;);
+  GLADE_HOOKUP_OBJECT (particle_dialog, previewVbox, &quot;previewVbox&quot;);
+  GLADE_HOOKUP_OBJECT (particle_dialog, previewControlHbox, &quot;previewControlHbox&quot;);
+  GLADE_HOOKUP_OBJECT (particle_dialog, previewOutputMenu, &quot;previewOutputMenu&quot;);
+  GLADE_HOOKUP_OBJECT (particle_dialog, previewSlider, &quot;previewSlider&quot;);
+  GLADE_HOOKUP_OBJECT (particle_dialog, previewVideo, &quot;previewVideo&quot;);
+  GLADE_HOOKUP_OBJECT (particle_dialog, previewDisabled, &quot;previewDisabled&quot;);
+  GLADE_HOOKUP_OBJECT (particle_dialog, previewLabel, &quot;previewLabel&quot;);
+  GLADE_HOOKUP_OBJECT_NO_REF (particle_dialog, dialogButtonBox, &quot;dialogButtonBox&quot;);
+  GLADE_HOOKUP_OBJECT (particle_dialog, cancelButton, &quot;cancelButton&quot;);
+  GLADE_HOOKUP_OBJECT (particle_dialog, okButton, &quot;okButton&quot;);
+
+  return particle_dialog;
+}
+
+#endif

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_properties.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_properties.cpp	2007-09-30 16:29:29 UTC (rev 3607)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_properties.cpp	2007-09-30 16:49:31 UTC (rev 3608)
@@ -1,20 +1,13 @@
 /*
- * DO NOT EDIT THIS FILE - it is generated by Glade.
+ * This file was generated by Glade, once upon a time.
  */
 
+#include &quot;default.h&quot;
 
-
-#include &lt;sys/types.h&gt;
-#include &lt;sys/stat.h&gt;
-#include &lt;unistd.h&gt;
-#include &lt;string.h&gt;
-#include &lt;stdio.h&gt;
 #include &lt;math.h&gt;
 
 #include &lt;gdk/gdkkeysyms.h&gt;
 #include &lt;gtk/gtk.h&gt;
-#include &quot;config.h&quot;
-#include &quot;default.h&quot;
 
 #include &quot;ADM_toolkit_gtk/ADM_gladeSupport.h&quot;
 #include &quot;ADM_toolkit/toolkit.hxx&quot;

Added: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_threshold.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_threshold.cpp	2007-09-30 16:29:29 UTC (rev 3607)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/DIA_threshold.cpp	2007-09-30 16:49:31 UTC (rev 3608)
@@ -0,0 +1,475 @@
+/***************************************************************************
+                          DIA_threshold.cpp  -  configuration dialog for
+						threshold filter
+                              -------------------
+                         Chris MacGregor, September 2007
+                         <A HREF="https://lists.berlios.de/mailman/listinfo/avidemux-svn-commit">chris-avidemux at bouncingdog.com</A>
+ ***************************************************************************/
+
+/***************************************************************************
+ *                                                                         *
+ *   This program is free software; you can redistribute it and/or modify  *
+ *   it under the terms of the GNU General Public License as published by  *
+ *   the Free Software Foundation; either version 2 of the License, or     *
+ *   (at your option) any later version.                                   *
+ *                                                                         *
+ ***************************************************************************/
+
+#include &quot;default.h&quot;
+
+#include &lt;gtk/gtk.h&gt;
+
+#include &quot;fourcc.h&quot;
+#include &quot;avio.hxx&quot;
+
+#include &quot;avi_vars.h&quot;
+
+#ifdef HAVE_ENCODER
+
+#include &quot;ADM_editor/ADM_edit.hxx&quot;
+#include &quot;ADM_video/ADM_genvideo.hxx&quot;
+#include &quot;ADM_videoFilter/ADM_vidThreshold.h&quot;
+#include &quot;ADM_toolkit/toolkit.hxx&quot;
+#include &quot;ADM_toolkit_gtk/ADM_gladeSupport.h&quot;
+#include &quot;ADM_toolkit_gtk/toolkit_gtk.h&quot;
+#include &quot;ADM_toolkit_gtk/toolkit_gtk_include.h&quot;
+#include &quot;ADM_assert.h&quot;
+#include &quot;DIA_flyDialog.h&quot;
+#include &quot;DIA_flyThreshold.h&quot;
+
+/********************************************************************/
+static GtkWidget *create_threshold_dialog (void);
+static GtkWidget *dialog = 0;
+
+static gboolean gui_draw (GtkWidget * widget,
+			  GdkEventExpose * event, gpointer user_data);
+static void gui_update (GtkButton * button, gpointer user_data);
+static void frame_changed (void);
+
+static volatile int lock = 0;
+static flyThreshold * myDialog = 0;
+
+/********************************************************************/
+
+static gboolean previewButtonEvent (GtkWidget * widget,
+                                    GdkEventButton * event,
+                                    gpointer data)
+{
+    if (event-&gt;type != GDK_BUTTON_PRESS)
+        return FALSE;
+
+    uint32_t x = static_cast &lt;uint32_t&gt; (event-&gt;x);
+    uint32_t y = static_cast &lt;uint32_t&gt; (event-&gt;y);
+
+    flyThreshold * myFly = static_cast &lt;flyThreshold *&gt; (data);
+    ADMImage * image = event-&gt;button == 1
+        ? myFly-&gt;getInputImage() : myFly-&gt;getOutputImage();
+
+    uint32_t width = image-&gt;_width;
+    uint32_t height = image-&gt;_height;
+
+    if (x &gt;= width || y &gt;= height)
+        return FALSE;
+
+    uint8_t range = 3;
+    if (event-&gt;state &amp; GDK_SHIFT_MASK)
+        range += 2;
+    if (event-&gt;state &amp; GDK_CONTROL_MASK)
+        range += 4;
+    if (event-&gt;state &amp; GDK_MOD1_MASK)
+        range += 6;
+
+    uint8_t halfrange = range / 2;
+
+    uint32_t xmin = (x &gt; halfrange) ? x - halfrange : 0;
+    uint32_t ymin = (y &gt; halfrange) ? y - halfrange : 0;
+
+    uint32_t xmax = x + halfrange;
+    uint32_t ymax = y + halfrange;
+
+    if (xmax &gt;= width)
+        xmax = width - 1;
+    if (ymax &gt;= height)
+        ymax = height - 1;
+
+    uint8_t * imagepix = YPLANE (image);
+
+    printf (&quot;\n  x|&quot;);
+    for (x = xmin; x &lt;= xmax; x++)
+        printf (&quot; %3d&quot;, x);
+    printf (&quot;\ny: +&quot;);
+    for (x = xmin; x &lt;= xmax; x++)
+        printf (&quot; ---&quot;, x);
+    printf (&quot;\n&quot;);
+
+    for (y = ymin; y &lt;= ymax; y++)
+    {
+        uint8_t * pixp = imagepix + (y * width) + xmin;
+        printf (&quot;%3d|&quot;, y);
+        for (x = xmin; x &lt;= xmax; x++)
+            printf (&quot; %3d&quot;, *pixp++);
+        printf (&quot;\n&quot;);
+    }
+
+    return TRUE;
+}
+
+/********************************************************************/
+
+uint8_t DIA_threshold (AVDMGenericVideoStream *in, THRESHOLD_PARAM * param)
+{
+    // Allocate space for preview video
+    uint32_t width = in-&gt;getInfo()-&gt;width;
+    uint32_t height = in-&gt;getInfo()-&gt;height;
+
+    dialog = create_threshold_dialog();
+    gtk_register_dialog(dialog);
+    gtk_window_set_title (GTK_WINDOW (dialog),
+                          QT_TR_NOOP(&quot;Threshold Configuration&quot;));
+    gtk_widget_show(dialog);
+
+    myDialog = new flyThreshold (width, height, in,
+                                 WID(previewVideo), WID(previewSlider),
+                                 param);
+    myDialog-&gt;upload();
+    myDialog-&gt;sliderChanged();
+
+    // update things when settings are changed
+#define CNX(_widg,_signame) \
+    g_signal_connect(GTK_OBJECT(WID(_widg)), _signame,                \
+                     GTK_SIGNAL_FUNC(gui_update), (void *) (1));
+
+//    CNX (minValueSlider, &quot;drag_data_received&quot;);
+    CNX (minValueSpinner, &quot;value_changed&quot;);
+
+//    CNX (maxValueSlider, &quot;drag_data_received&quot;);
+    CNX (maxValueSpinner, &quot;value_changed&quot;);
+      
+    CNX (outputValuesMenu, &quot;changed&quot;);
+
+    g_signal_connect(GTK_OBJECT(WID(previewSlider)), &quot;value_changed&quot;,
+                     GTK_SIGNAL_FUNC(frame_changed), 0);
+    g_signal_connect(GTK_OBJECT(WID(previewVideo)), &quot;expose_event&quot;,
+                     GTK_SIGNAL_FUNC(gui_draw), 0);
+
+    g_signal_connect(GTK_OBJECT(WID(previewVideo)), &quot;button_press_event&quot;,
+                     GTK_SIGNAL_FUNC(previewButtonEvent),
+                     gpointer(myDialog));
+#if 0
+    g_signal_connect(GTK_OBJECT(WID(previewVideo)), &quot;motion_notify_event&quot;,
+                     GTK_SIGNAL_FUNC(previewMotionEvent),
+                     gpointer(myDialog));
+#endif
+
+    uint8_t ret = 0;
+    int response = gtk_dialog_run(GTK_DIALOG(dialog));
+
+    if (response == GTK_RESPONSE_OK)
+    {
+        myDialog-&gt;download();
+        myDialog-&gt;getParam (param);
+        ret = 1;
+    }
+
+    gtk_unregister_dialog(dialog);
+    gtk_widget_destroy(dialog);
+
+    delete myDialog;
+
+    return ret;
+}
+
+void frame_changed (void)
+{
+    myDialog-&gt;sliderChanged();
+}
+
+void gui_update (GtkButton * button, gpointer user_data)
+{
+    if (lock)
+        return;
+
+    myDialog-&gt;update();
+}
+
+gboolean gui_draw (GtkWidget * widget, GdkEventExpose * event, gpointer user_data)
+{
+    myDialog-&gt;display();
+    return TRUE;
+}
+
+/**************************************/
+
+uint8_t flyThreshold::upload (void)
+{
+    lock++;
+
+    gtk_spin_button_set_value (GTK_SPIN_BUTTON(WID(minValueSpinner)), param.min);
+    gtk_spin_button_set_value (GTK_SPIN_BUTTON(WID(maxValueSpinner)), param.max);
+    gtk_spin_button_set_value (GTK_SPIN_BUTTON(WID(debugSpinButton)), param.debug);
+    gtk_combo_box_set_active (GTK_COMBO_BOX(WID(outputValuesMenu)),
+                              param.in_range_is_white);
+
+    lock--;
+    return 1;
+}
+
+uint8_t flyThreshold::download (void)
+{
+    param.min = gtk_spin_button_get_value_as_int (GTK_SPIN_BUTTON (WID(minValueSpinner)));
+    param.max = gtk_spin_button_get_value_as_int (GTK_SPIN_BUTTON (WID(maxValueSpinner)));
+    param.debug = gtk_spin_button_get_value_as_int (GTK_SPIN_BUTTON (WID(debugSpinButton)));
+    param.in_range_is_white
+        = gtk_combo_box_get_active (GTK_COMBO_BOX(WID(outputValuesMenu)));
+
+    return 1;
+}
+
+#define _(_str) QT_TR_NOOP(_str)
+
+// The following was generated by glade once upon a time.  It has since been
+// tweaked by hand (to share the GtkAdjustment objects between the spinbutton
+// and hscale, for instance), so beware...
+
+GtkWidget*
+create_threshold_dialog (void)
+{
+  GtkWidget *threshold_dialog;
+  GtkWidget *dialogVbox;
+  GtkWidget *allButButtonsVbox;
+  GtkWidget *settingsOuterHbox;
+  GtkWidget *settingsOuterVbox;
+  GtkWidget *minValueVbox;
+  GtkWidget *minValueLabel;
+  GtkWidget *minValueHbox;
+  GtkWidget *minValueSlider;
+  GtkObject *minValueSpinner_adj;
+  GtkWidget *minValueSpinner;
+  GtkWidget *maxValueVbox;
+  GtkWidget *maxValueLabel;
+  GtkWidget *maxValueHbox;
+  GtkWidget *maxValueSlider;
+  GtkObject *maxValueSpinner_adj;
+  GtkWidget *maxValueSpinner;
+  GtkWidget *outputValuesHbox;
+  GtkWidget *outputValuesLabel;
+  GtkWidget *outputValuesMenu;
+  GtkWidget *debugHbox;
+  GtkWidget *debugLabel;
+  GtkObject *debugSpinButton_adj;
+  GtkWidget *debugSpinButton;
+  GtkWidget *previewFrame;
+  GtkWidget *previewAlignment;
+  GtkWidget *previewVbox;
+  GtkWidget *previewControlHbox;
+  GtkWidget *previewOutputMenu;
+  GtkWidget *previewSlider;
+  GtkWidget *previewVideo;
+  GtkWidget *previewLabel;
+  GtkWidget *dialogButtonBox;
+  GtkWidget *cancelButton;
+  GtkWidget *okButton;
+
+  threshold_dialog = gtk_dialog_new ();
+  gtk_window_set_title (GTK_WINDOW (threshold_dialog), _(&quot;Threshold&quot;));
+  gtk_window_set_type_hint (GTK_WINDOW (threshold_dialog), GDK_WINDOW_TYPE_HINT_DIALOG);
+
+  dialogVbox = GTK_DIALOG (threshold_dialog)-&gt;vbox;
+  gtk_widget_show (dialogVbox);
+
+  allButButtonsVbox = gtk_vbox_new (FALSE, 12);
+  gtk_widget_show (allButButtonsVbox);
+  gtk_box_pack_start (GTK_BOX (dialogVbox), allButButtonsVbox, TRUE, TRUE, 0);
+
+  settingsOuterHbox = gtk_hbox_new (FALSE, 0);
+  gtk_widget_show (settingsOuterHbox);
+  gtk_box_pack_start (GTK_BOX (allButButtonsVbox), settingsOuterHbox, FALSE, TRUE, 0);
+
+  settingsOuterVbox = gtk_vbox_new (FALSE, 12);
+  gtk_widget_show (settingsOuterVbox);
+  gtk_box_pack_start (GTK_BOX (settingsOuterHbox), settingsOuterVbox, TRUE, TRUE, 0);
+
+  minValueVbox = gtk_vbox_new (FALSE, 0);
+  gtk_widget_show (minValueVbox);
+  gtk_box_pack_start (GTK_BOX (settingsOuterVbox), minValueVbox, FALSE, FALSE, 0);
+
+  minValueLabel = gtk_label_new (_(&quot;Minimum value to be in-range:&quot;));
+  gtk_widget_show (minValueLabel);
+  gtk_box_pack_start (GTK_BOX (minValueVbox), minValueLabel, FALSE, FALSE, 0);
+  gtk_misc_set_alignment (GTK_MISC (minValueLabel), 0.5, 1);
+  gtk_misc_set_padding (GTK_MISC (minValueLabel), 0, 8);
+
+  minValueHbox = gtk_hbox_new (FALSE, 5);
+  gtk_widget_show (minValueHbox);
+  gtk_box_pack_start (GTK_BOX (minValueVbox), minValueHbox, TRUE, TRUE, 0);
+
+#ifdef ORIGINAL_CODE_GENERATED_BY_GLADE
+  minValueSlider = gtk_hscale_new (GTK_ADJUSTMENT (gtk_adjustment_new (0, 0, 255, 1, 1, 0)));
+#else
+  minValueSpinner_adj = gtk_adjustment_new (0, 0, 255, 1, 1, 0);
+  minValueSlider = gtk_hscale_new (GTK_ADJUSTMENT (minValueSpinner_adj));
+#endif
+  gtk_widget_show (minValueSlider);
+  gtk_box_pack_start (GTK_BOX (minValueHbox), minValueSlider, TRUE, TRUE, 0);
+  gtk_scale_set_draw_value (GTK_SCALE (minValueSlider), FALSE);
+  gtk_scale_set_value_pos (GTK_SCALE (minValueSlider), GTK_POS_LEFT);
+  gtk_scale_set_digits (GTK_SCALE (minValueSlider), 0);
+
+#ifdef ORIGINAL_CODE_GENERATED_BY_GLADE
+  minValueSpinner_adj = gtk_adjustment_new (0, 0, 255, 1, 10, 10);
+#endif
+  minValueSpinner = gtk_spin_button_new (GTK_ADJUSTMENT (minValueSpinner_adj), 1, 0);
+  gtk_widget_show (minValueSpinner);
+  gtk_box_pack_start (GTK_BOX (minValueHbox), minValueSpinner, FALSE, TRUE, 0);
+
+  maxValueVbox = gtk_vbox_new (FALSE, 0);
+  gtk_widget_show (maxValueVbox);
+  gtk_box_pack_start (GTK_BOX (settingsOuterVbox), maxValueVbox, FALSE, FALSE, 0);
+
+  maxValueLabel = gtk_label_new (_(&quot;Maximum value to be in-range:&quot;));
+  gtk_widget_show (maxValueLabel);
+  gtk_box_pack_start (GTK_BOX (maxValueVbox), maxValueLabel, FALSE, FALSE, 0);
+
+  maxValueHbox = gtk_hbox_new (FALSE, 5);
+  gtk_widget_show (maxValueHbox);
+  gtk_box_pack_start (GTK_BOX (maxValueVbox), maxValueHbox, TRUE, TRUE, 0);
+
+#ifdef ORIGINAL_CODE_GENERATED_BY_GLADE
+  maxValueSlider = gtk_hscale_new (GTK_ADJUSTMENT (gtk_adjustment_new (255, 0, 255, 1, 1, 0)));
+#else
+  maxValueSpinner_adj = gtk_adjustment_new (255, 0, 255, 1, 1, 0);
+  maxValueSlider = gtk_hscale_new (GTK_ADJUSTMENT (maxValueSpinner_adj));
+#endif
+  gtk_widget_show (maxValueSlider);
+  gtk_box_pack_start (GTK_BOX (maxValueHbox), maxValueSlider, TRUE, TRUE, 0);
+  gtk_scale_set_draw_value (GTK_SCALE (maxValueSlider), FALSE);
+  gtk_scale_set_value_pos (GTK_SCALE (maxValueSlider), GTK_POS_LEFT);
+  gtk_scale_set_digits (GTK_SCALE (maxValueSlider), 0);
+
+#ifdef ORIGINAL_CODE_GENERATED_BY_GLADE
+  maxValueSpinner_adj = gtk_adjustment_new (255, 0, 255, 1, 10, 10);
+#endif
+  maxValueSpinner = gtk_spin_button_new (GTK_ADJUSTMENT (maxValueSpinner_adj), 1, 0);
+  gtk_widget_show (maxValueSpinner);
+  gtk_box_pack_start (GTK_BOX (maxValueHbox), maxValueSpinner, FALSE, TRUE, 0);
+
+  outputValuesHbox = gtk_hbox_new (FALSE, 0);
+  gtk_widget_show (outputValuesHbox);
+  gtk_box_pack_start (GTK_BOX (settingsOuterVbox), outputValuesHbox, TRUE, TRUE, 0);
+
+  outputValuesLabel = gtk_label_new (_(&quot;Output values:   &quot;));
+  gtk_widget_show (outputValuesLabel);
+  gtk_box_pack_start (GTK_BOX (outputValuesHbox), outputValuesLabel, FALSE, FALSE, 0);
+
+  outputValuesMenu = gtk_combo_box_new_text ();
+  gtk_widget_show (outputValuesMenu);
+  gtk_box_pack_start (GTK_BOX (outputValuesHbox), outputValuesMenu, TRUE, TRUE, 0);
+  gtk_combo_box_append_text (GTK_COMBO_BOX (outputValuesMenu), _(&quot;In-range values go black, out-of-range values go white&quot;));
+  gtk_combo_box_append_text (GTK_COMBO_BOX (outputValuesMenu), _(&quot;In-range values go white, out-of-range values go black&quot;));
+
+  debugHbox = gtk_hbox_new (FALSE, 0);
+  gtk_widget_show (debugHbox);
+  gtk_box_pack_start (GTK_BOX (settingsOuterVbox), debugHbox, TRUE, TRUE, 0);
+
+  debugLabel = gtk_label_new (_(&quot;Debugging settings (bits):   &quot;));
+  gtk_widget_show (debugLabel);
+  gtk_box_pack_start (GTK_BOX (debugHbox), debugLabel, FALSE, FALSE, 0);
+
+  debugSpinButton_adj = gtk_adjustment_new (0, 0, 16777215, 1, 10, 10);
+  debugSpinButton = gtk_spin_button_new (GTK_ADJUSTMENT (debugSpinButton_adj), 1, 0);
+  gtk_widget_show (debugSpinButton);
+  gtk_box_pack_start (GTK_BOX (debugHbox), debugSpinButton, TRUE, TRUE, 0);
+
+  previewFrame = gtk_frame_new (NULL);
+  gtk_widget_show (previewFrame);
+  gtk_box_pack_start (GTK_BOX (allButButtonsVbox), previewFrame, TRUE, TRUE, 0);
+
+  previewAlignment = gtk_alignment_new (0.5, 0.5, 1, 1);
+  gtk_widget_show (previewAlignment);
+  gtk_container_add (GTK_CONTAINER (previewFrame), previewAlignment);
+  gtk_alignment_set_padding (GTK_ALIGNMENT (previewAlignment), 0, 8, 6, 8);
+
+  previewVbox = gtk_vbox_new (FALSE, 5);
+  gtk_widget_show (previewVbox);
+  gtk_container_add (GTK_CONTAINER (previewAlignment), previewVbox);
+
+  previewControlHbox = gtk_hbox_new (FALSE, 5);
+  gtk_widget_show (previewControlHbox);
+  gtk_box_pack_start (GTK_BOX (previewVbox), previewControlHbox, TRUE, TRUE, 0);
+
+  previewOutputMenu = gtk_combo_box_new_text ();
+#ifdef ORIGINAL_CODE_GENERATED_BY_GLADE
+  // temporarily (?) disable this until it's actually implemented
+  gtk_widget_show (previewOutputMenu);
+#endif
+  gtk_box_pack_start (GTK_BOX (previewControlHbox), previewOutputMenu, FALSE, TRUE, 0);
+  gtk_combo_box_append_text (GTK_COMBO_BOX (previewOutputMenu), _(&quot;Threshold output&quot;));
+  gtk_combo_box_append_text (GTK_COMBO_BOX (previewOutputMenu), _(&quot;Final output&quot;));
+
+  previewSlider = gtk_hscale_new (GTK_ADJUSTMENT (gtk_adjustment_new (0, 0, 99, 1, 1, 1)));
+  gtk_widget_show (previewSlider);
+  gtk_box_pack_start (GTK_BOX (previewControlHbox), previewSlider, TRUE, TRUE, 0);
+  gtk_scale_set_digits (GTK_SCALE (previewSlider), 0);
+
+  previewVideo = gtk_drawing_area_new ();
+  gtk_widget_show (previewVideo);
+  gtk_box_pack_start (GTK_BOX (previewVbox), previewVideo, TRUE, TRUE, 0);
+  gtk_widget_set_size_request (previewVideo, -1, 300);
+  gtk_widget_set_events (previewVideo, GDK_BUTTON1_MOTION_MASK | GDK_BUTTON_PRESS_MASK);
+
+  previewLabel = gtk_label_new (_(&quot;Preview&quot;));
+  gtk_widget_show (previewLabel);
+  gtk_frame_set_label_widget (GTK_FRAME (previewFrame), previewLabel);
+
+  dialogButtonBox = GTK_DIALOG (threshold_dialog)-&gt;action_area;
+  gtk_widget_show (dialogButtonBox);
+  gtk_button_box_set_layout (GTK_BUTTON_BOX (dialogButtonBox), GTK_BUTTONBOX_END);
+
+  cancelButton = gtk_button_new_from_stock (&quot;gtk-cancel&quot;);
+  gtk_widget_show (cancelButton);
+  gtk_dialog_add_action_widget (GTK_DIALOG (threshold_dialog), cancelButton, GTK_RESPONSE_CANCEL);
+  GTK_WIDGET_SET_FLAGS (cancelButton, GTK_CAN_DEFAULT);
+
+  okButton = gtk_button_new_from_stock (&quot;gtk-ok&quot;);
+  gtk_widget_show (okButton);
+  gtk_dialog_add_action_widget (GTK_DIALOG (threshold_dialog), okButton, GTK_RESPONSE_OK);
+  GTK_WIDGET_SET_FLAGS (okButton, GTK_CAN_DEFAULT);
+
+  /* Store pointers to all widgets, for use by lookup_widget(). */
+  GLADE_HOOKUP_OBJECT_NO_REF (threshold_dialog, threshold_dialog, &quot;threshold_dialog&quot;);
+  GLADE_HOOKUP_OBJECT_NO_REF (threshold_dialog, dialogVbox, &quot;dialogVbox&quot;);
+  GLADE_HOOKUP_OBJECT (threshold_dialog, allButButtonsVbox, &quot;allButButtonsVbox&quot;);
+  GLADE_HOOKUP_OBJECT (threshold_dialog, settingsOuterHbox, &quot;settingsOuterHbox&quot;);
+  GLADE_HOOKUP_OBJECT (threshold_dialog, settingsOuterVbox, &quot;settingsOuterVbox&quot;);
+  GLADE_HOOKUP_OBJECT (threshold_dialog, minValueVbox, &quot;minValueVbox&quot;);
+  GLADE_HOOKUP_OBJECT (threshold_dialog, minValueLabel, &quot;minValueLabel&quot;);
+  GLADE_HOOKUP_OBJECT (threshold_dialog, minValueHbox, &quot;minValueHbox&quot;);
+  GLADE_HOOKUP_OBJECT (threshold_dialog, minValueSlider, &quot;minValueSlider&quot;);
+  GLADE_HOOKUP_OBJECT (threshold_dialog, minValueSpinner, &quot;minValueSpinner&quot;);
+  GLADE_HOOKUP_OBJECT (threshold_dialog, maxValueVbox, &quot;maxValueVbox&quot;);
+  GLADE_HOOKUP_OBJECT (threshold_dialog, maxValueLabel, &quot;maxValueLabel&quot;);
+  GLADE_HOOKUP_OBJECT (threshold_dialog, maxValueHbox, &quot;maxValueHbox&quot;);
+  GLADE_HOOKUP_OBJECT (threshold_dialog, maxValueSlider, &quot;maxValueSlider&quot;);
+  GLADE_HOOKUP_OBJECT (threshold_dialog, maxValueSpinner, &quot;maxValueSpinner&quot;);
+  GLADE_HOOKUP_OBJECT (threshold_dialog, outputValuesHbox, &quot;outputValuesHbox&quot;);
+  GLADE_HOOKUP_OBJECT (threshold_dialog, outputValuesLabel, &quot;outputValuesLabel&quot;);
+  GLADE_HOOKUP_OBJECT (threshold_dialog, outputValuesMenu, &quot;outputValuesMenu&quot;);
+  GLADE_HOOKUP_OBJECT (threshold_dialog, debugHbox, &quot;debugHbox&quot;);
+  GLADE_HOOKUP_OBJECT (threshold_dialog, debugLabel, &quot;debugLabel&quot;);
+  GLADE_HOOKUP_OBJECT (threshold_dialog, debugSpinButton, &quot;debugSpinButton&quot;);
+  GLADE_HOOKUP_OBJECT (threshold_dialog, previewFrame, &quot;previewFrame&quot;);
+  GLADE_HOOKUP_OBJECT (threshold_dialog, previewAlignment, &quot;previewAlignment&quot;);
+  GLADE_HOOKUP_OBJECT (threshold_dialog, previewVbox, &quot;previewVbox&quot;);
+  GLADE_HOOKUP_OBJECT (threshold_dialog, previewControlHbox, &quot;previewControlHbox&quot;);
+  GLADE_HOOKUP_OBJECT (threshold_dialog, previewOutputMenu, &quot;previewOutputMenu&quot;);
+  GLADE_HOOKUP_OBJECT (threshold_dialog, previewSlider, &quot;previewSlider&quot;);
+  GLADE_HOOKUP_OBJECT (threshold_dialog, previewVideo, &quot;previewVideo&quot;);
+  GLADE_HOOKUP_OBJECT (threshold_dialog, previewLabel, &quot;previewLabel&quot;);
+  GLADE_HOOKUP_OBJECT_NO_REF (threshold_dialog, dialogButtonBox, &quot;dialogButtonBox&quot;);
+  GLADE_HOOKUP_OBJECT (threshold_dialog, cancelButton, &quot;cancelButton&quot;);
+  GLADE_HOOKUP_OBJECT (threshold_dialog, okButton, &quot;okButton&quot;);
+
+  return threshold_dialog;
+}
+
+#endif

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/Makefile.am
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/Makefile.am	2007-09-30 16:29:29 UTC (rev 3607)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialog/Makefile.am	2007-09-30 16:49:31 UTC (rev 3608)
@@ -28,6 +28,9 @@
 	DIA_coloryuv.cpp \
 	DIA_quota.cpp \
 	DIA_partial.cpp  \
+	DIA_threshold.cpp \
+	DIA_SwissArmyKnife.cpp \
+	DIA_particle.cpp \
 	DIA_flyDialog.cpp
 
 
@@ -51,6 +54,6 @@
 DIA_busy.cpp         DIA_properties.cpp  DIA_xvid.cpp \
 DIA_busy.h            DIA_quota.cpp       DIA_xvid4.cpp \
 DIA_calculator.cpp   DIA_encoding.cpp      DIA_recent.cpp \
-DIA_chromaShift.cpp  DIA_encoding.h        DIA_lavpp_deint.cpp   
+DIA_chromaShift.cpp  DIA_encoding.h        DIA_lavpp_deint.cpp \
+DIA_threshold.cpp    DIA_SwissArmyKnife.cpp DIA_particle.cpp
 
-

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialogFactory/DIA_filesel.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialogFactory/DIA_filesel.cpp	2007-09-30 16:29:29 UTC (rev 3607)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_dialogFactory/DIA_filesel.cpp	2007-09-30 16:49:31 UTC (rev 3608)
@@ -13,14 +13,8 @@
  *                                                                         *
  ***************************************************************************/
 
-#include &lt;config.h&gt;
+#include &quot;default.h&quot;
 
-
-#include &lt;string.h&gt;
-#include &lt;stdio.h&gt;
-#include &lt;math.h&gt;
-
-#include &quot;default.h&quot;
 #include &quot;ADM_toolkit_gtk/ADM_gladeSupport.h&quot;
 #include &quot;ADM_toolkit_gtk/toolkit_gtk.h&quot;
 #include &quot;ADM_toolkit_gtk/toolkit_gtk_include.h&quot;
@@ -35,8 +29,20 @@
 diaElemFile::diaElemFile(uint32_t writemode,char **filename,const char *toggleTitle,
                          const char * defaultSuffix,const char *tip)
   : diaElem(ELEM_FILE_READ),
-    defaultSuffix (defaultSuffix)
+    defaultSuffix (defaultSuffix),
+    paramIsStdString (false)
+{
+  param=(void *)filename;
+  paramTitle=toggleTitle;
+  this-&gt;tip=tip;
+  _write=writemode;
+}
 
+diaElemFile::diaElemFile(uint32_t writemode,std::string *filename,const char *toggleTitle,
+                         const char * defaultSuffix,const char *tip)
+  : diaElem(ELEM_FILE_READ),
+    defaultSuffix (defaultSuffix),
+    paramIsStdString (true)
 {
   param=(void *)filename;
   paramTitle=toggleTitle;
@@ -80,8 +86,12 @@
   gtk_widget_show (entry);
   if(param)
   {
-      char **val=(char **)param;
-      gtk_entry_set_text (GTK_ENTRY (entry), *val);
+      const char * val;
+      if (paramIsStdString)
+          val = ((std::string *)param)-&gt;c_str();
+      else
+          val = *((char **)param);
+      gtk_entry_set_text (GTK_ENTRY (entry), val);
   }
   gtk_label_set_mnemonic_widget (GTK_LABEL(label), entry);
   
@@ -116,10 +126,17 @@
 void diaElemFile::getMe(void)
 {
   GtkWidget **widget=(GtkWidget **)myWidget;
-  char **name=(char **)param;
-  if(*name) delete *name;
-  *name=NULL;
-  *name =ADM_strdup(gtk_entry_get_text (GTK_ENTRY (widget[0])));
+  const char * val = gtk_entry_get_text (GTK_ENTRY (widget[0]));
+  if (paramIsStdString)
+  {
+      *((std::string *)param) = val;
+  }
+  else
+  {
+      char **name=(char **)param;
+      if(*name) delete [] *name;
+      *name = ADM_strdup(val);
+  }
 }
 
 void diaElemFile::changeFile(void)
@@ -165,11 +182,17 @@
   }
   if(t)
   {
-    char **name=(char **)param;
-    if(*name) delete [] *name;
-    *name=NULL;
-    *name =ADM_strdup(buffer);
-     gtk_entry_set_text (GTK_ENTRY (widget), *name);
+    if (paramIsStdString)
+    {
+        *((std::string *)param) = buffer;
+    }
+    else
+    {
+        char **name=(char **)param;
+        if(*name) delete [] *name;
+        *name = ADM_strdup(buffer);
+    }
+    gtk_entry_set_text (GTK_ENTRY (widget), buffer);
   }
   
 }

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_gtkRender.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_gtkRender.cpp	2007-09-30 16:29:29 UTC (rev 3607)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_gui2/GUI_gtkRender.cpp	2007-09-30 16:49:31 UTC (rev 3608)
@@ -14,11 +14,8 @@
  *   (at your option) any later version.                                   *
  *                                                                         *
  ***************************************************************************/
-#include &quot;config.h&quot;
 
-#include &lt;stdio.h&gt;         
-#include &lt;stdlib.h&gt;
-#include &lt;unistd.h&gt;
+#include &quot;default.h&quot;
 
 #include &lt;gtk/gtk.h&gt;
 #ifdef ADM_WIN32
@@ -29,7 +26,6 @@
 #endif
 
 #include &quot;../ADM_assert.h&quot;
-#include &quot;default.h&quot;
 #include &quot;../ADM_osSupport/ADM_misc.h&quot;
 
 #include &quot;ADM_commonUI/GUI_render.h&quot;
@@ -64,7 +60,9 @@
 
     if(lastW&gt;w || lastH&gt;h)
     {
-      printf(&quot;[GTK] Warning window bigger than display %u x %u vs %u x %u\n&quot;,w,h,lastW,lastH);
+// This makes a lot of noise if you use the Crop filter...  perhaps it should
+// be output only once?  Or maybe there is a real bug - I'm not sure.  [Chris MacGregor]
+//      printf(&quot;[GTK] Warning window bigger than display %u x %u vs %u x %u\n&quot;,w,h,lastW,lastH);
     }
 
     gdk_draw_rgb_32_image(widget-&gt;window, widget-&gt;style-&gt;fg_gc[GTK_STATE_NORMAL], 0,    // X

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_toolkit_gtk/TLK_filesel.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_toolkit_gtk/TLK_filesel.cpp	2007-09-30 16:29:29 UTC (rev 3607)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/ADM_toolkit_gtk/TLK_filesel.cpp	2007-09-30 16:49:31 UTC (rev 3608)
@@ -16,22 +16,19 @@
  *   (at your option) any later version.                                   *
  *                                                                         *
  ***************************************************************************/
-#include &quot;config.h&quot;
 
-#include &lt;stdlib.h&gt;
-#include &lt;stdio.h&gt;
+#include &quot;default.h&quot;
+
 #include &lt;gtk/gtk.h&gt;
 
-#include &lt;dirent.h&gt;
 #include &lt;errno.h&gt;
+#include &lt;sys/types.h&gt;
 #include &lt;sys/stat.h&gt;
-#ifndef ADM_WIN32
-	#include &lt;unistd.h&gt;
-#endif
+#include &lt;dirent.h&gt;
 
 #include &quot;avi_vars.h&quot;
 #include &quot;ADM_misc.h&quot;
-#include &lt;ADM_assert.h&gt;
+#include &quot;ADM_assert.h&quot;
 
 #include &quot;ADM_toolkit/filesel.h&quot;
 #include &quot;ADM_toolkit/toolkit.hxx&quot;

Added: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/glade/particle.glade
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/glade/particle.glade	2007-09-30 16:29:29 UTC (rev 3607)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/glade/particle.glade	2007-09-30 16:49:31 UTC (rev 3608)
@@ -0,0 +1,877 @@
+&lt;?xml version=&quot;1.0&quot; standalone=&quot;no&quot;?&gt; &lt;!--*- mode: xml -*--&gt;
+&lt;!DOCTYPE glade-interface SYSTEM &quot;<A HREF="http://glade.gnome.org/glade-2.0.dtd">http://glade.gnome.org/glade-2.0.dtd</A>&quot;&gt;
+
+&lt;glade-interface&gt;
+
+&lt;widget class=&quot;GtkDialog&quot; id=&quot;particle_dialog&quot;&gt;
+  &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+  &lt;property name=&quot;title&quot; translatable=&quot;yes&quot;&gt;Particle Detection&lt;/property&gt;
+  &lt;property name=&quot;type&quot;&gt;GTK_WINDOW_TOPLEVEL&lt;/property&gt;
+  &lt;property name=&quot;window_position&quot;&gt;GTK_WIN_POS_NONE&lt;/property&gt;
+  &lt;property name=&quot;modal&quot;&gt;False&lt;/property&gt;
+  &lt;property name=&quot;resizable&quot;&gt;True&lt;/property&gt;
+  &lt;property name=&quot;destroy_with_parent&quot;&gt;False&lt;/property&gt;
+  &lt;property name=&quot;decorated&quot;&gt;True&lt;/property&gt;
+  &lt;property name=&quot;skip_taskbar_hint&quot;&gt;False&lt;/property&gt;
+  &lt;property name=&quot;skip_pager_hint&quot;&gt;False&lt;/property&gt;
+  &lt;property name=&quot;type_hint&quot;&gt;GDK_WINDOW_TYPE_HINT_DIALOG&lt;/property&gt;
+  &lt;property name=&quot;gravity&quot;&gt;GDK_GRAVITY_NORTH_WEST&lt;/property&gt;
+  &lt;property name=&quot;focus_on_map&quot;&gt;True&lt;/property&gt;
+  &lt;property name=&quot;urgency_hint&quot;&gt;False&lt;/property&gt;
+  &lt;property name=&quot;has_separator&quot;&gt;True&lt;/property&gt;
+
+  &lt;child internal-child=&quot;vbox&quot;&gt;
+    &lt;widget class=&quot;GtkVBox&quot; id=&quot;dialogVbox&quot;&gt;
+      &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+      &lt;property name=&quot;homogeneous&quot;&gt;False&lt;/property&gt;
+      &lt;property name=&quot;spacing&quot;&gt;0&lt;/property&gt;
+
+      &lt;child internal-child=&quot;action_area&quot;&gt;
+	&lt;widget class=&quot;GtkHButtonBox&quot; id=&quot;dialogButtonBox&quot;&gt;
+	  &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+	  &lt;property name=&quot;layout_style&quot;&gt;GTK_BUTTONBOX_END&lt;/property&gt;
+
+	  &lt;child&gt;
+	    &lt;widget class=&quot;GtkButton&quot; id=&quot;cancelButton&quot;&gt;
+	      &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+	      &lt;property name=&quot;can_default&quot;&gt;True&lt;/property&gt;
+	      &lt;property name=&quot;can_focus&quot;&gt;True&lt;/property&gt;
+	      &lt;property name=&quot;label&quot;&gt;gtk-cancel&lt;/property&gt;
+	      &lt;property name=&quot;use_stock&quot;&gt;True&lt;/property&gt;
+	      &lt;property name=&quot;relief&quot;&gt;GTK_RELIEF_NORMAL&lt;/property&gt;
+	      &lt;property name=&quot;focus_on_click&quot;&gt;True&lt;/property&gt;
+	      &lt;property name=&quot;response_id&quot;&gt;-6&lt;/property&gt;
+	    &lt;/widget&gt;
+	  &lt;/child&gt;
+
+	  &lt;child&gt;
+	    &lt;widget class=&quot;GtkButton&quot; id=&quot;okButton&quot;&gt;
+	      &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+	      &lt;property name=&quot;can_default&quot;&gt;True&lt;/property&gt;
+	      &lt;property name=&quot;can_focus&quot;&gt;True&lt;/property&gt;
+	      &lt;property name=&quot;label&quot;&gt;gtk-ok&lt;/property&gt;
+	      &lt;property name=&quot;use_stock&quot;&gt;True&lt;/property&gt;
+	      &lt;property name=&quot;relief&quot;&gt;GTK_RELIEF_NORMAL&lt;/property&gt;
+	      &lt;property name=&quot;focus_on_click&quot;&gt;True&lt;/property&gt;
+	      &lt;property name=&quot;response_id&quot;&gt;-5&lt;/property&gt;
+	    &lt;/widget&gt;
+	  &lt;/child&gt;
+	&lt;/widget&gt;
+	&lt;packing&gt;
+	  &lt;property name=&quot;padding&quot;&gt;0&lt;/property&gt;
+	  &lt;property name=&quot;expand&quot;&gt;False&lt;/property&gt;
+	  &lt;property name=&quot;fill&quot;&gt;True&lt;/property&gt;
+	  &lt;property name=&quot;pack_type&quot;&gt;GTK_PACK_END&lt;/property&gt;
+	&lt;/packing&gt;
+      &lt;/child&gt;
+
+      &lt;child&gt;
+	&lt;widget class=&quot;GtkHBox&quot; id=&quot;dialogHbox&quot;&gt;
+	  &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+	  &lt;property name=&quot;homogeneous&quot;&gt;False&lt;/property&gt;
+	  &lt;property name=&quot;spacing&quot;&gt;0&lt;/property&gt;
+
+	  &lt;child&gt;
+	    &lt;widget class=&quot;GtkVBox&quot; id=&quot;allButButtonsVbox&quot;&gt;
+	      &lt;property name=&quot;border_width&quot;&gt;8&lt;/property&gt;
+	      &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+	      &lt;property name=&quot;homogeneous&quot;&gt;False&lt;/property&gt;
+	      &lt;property name=&quot;spacing&quot;&gt;12&lt;/property&gt;
+
+	      &lt;child&gt;
+		&lt;widget class=&quot;GtkHBox&quot; id=&quot;settingsOuterHbox&quot;&gt;
+		  &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+		  &lt;property name=&quot;homogeneous&quot;&gt;False&lt;/property&gt;
+		  &lt;property name=&quot;spacing&quot;&gt;0&lt;/property&gt;
+
+		  &lt;child&gt;
+		    &lt;widget class=&quot;GtkVBox&quot; id=&quot;settingsOuterVbox&quot;&gt;
+		      &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+		      &lt;property name=&quot;homogeneous&quot;&gt;False&lt;/property&gt;
+		      &lt;property name=&quot;spacing&quot;&gt;12&lt;/property&gt;
+
+		      &lt;child&gt;
+			&lt;widget class=&quot;GtkHBox&quot; id=&quot;minAreaHbox&quot;&gt;
+			  &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+			  &lt;property name=&quot;homogeneous&quot;&gt;False&lt;/property&gt;
+			  &lt;property name=&quot;spacing&quot;&gt;0&lt;/property&gt;
+
+			  &lt;child&gt;
+			    &lt;widget class=&quot;GtkLabel&quot; id=&quot;minAreaLabel&quot;&gt;
+			      &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+			      &lt;property name=&quot;label&quot; translatable=&quot;yes&quot;&gt;Mi_nimum area for a particle to be detected:    &lt;/property&gt;
+			      &lt;property name=&quot;use_underline&quot;&gt;True&lt;/property&gt;
+			      &lt;property name=&quot;use_markup&quot;&gt;False&lt;/property&gt;
+			      &lt;property name=&quot;justify&quot;&gt;GTK_JUSTIFY_LEFT&lt;/property&gt;
+			      &lt;property name=&quot;wrap&quot;&gt;False&lt;/property&gt;
+			      &lt;property name=&quot;selectable&quot;&gt;False&lt;/property&gt;
+			      &lt;property name=&quot;xalign&quot;&gt;0.5&lt;/property&gt;
+			      &lt;property name=&quot;yalign&quot;&gt;0.5&lt;/property&gt;
+			      &lt;property name=&quot;xpad&quot;&gt;0&lt;/property&gt;
+			      &lt;property name=&quot;ypad&quot;&gt;0&lt;/property&gt;
+			      &lt;property name=&quot;mnemonic_widget&quot;&gt;minAreaSpinButton&lt;/property&gt;
+			      &lt;property name=&quot;ellipsize&quot;&gt;PANGO_ELLIPSIZE_NONE&lt;/property&gt;
+			      &lt;property name=&quot;width_chars&quot;&gt;-1&lt;/property&gt;
+			      &lt;property name=&quot;single_line_mode&quot;&gt;False&lt;/property&gt;
+			      &lt;property name=&quot;angle&quot;&gt;0&lt;/property&gt;
+			    &lt;/widget&gt;
+			    &lt;packing&gt;
+			      &lt;property name=&quot;padding&quot;&gt;0&lt;/property&gt;
+			      &lt;property name=&quot;expand&quot;&gt;False&lt;/property&gt;
+			      &lt;property name=&quot;fill&quot;&gt;False&lt;/property&gt;
+			    &lt;/packing&gt;
+			  &lt;/child&gt;
+
+			  &lt;child&gt;
+			    &lt;widget class=&quot;GtkSpinButton&quot; id=&quot;minAreaSpinButton&quot;&gt;
+			      &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+			      &lt;property name=&quot;can_focus&quot;&gt;True&lt;/property&gt;
+			      &lt;property name=&quot;climb_rate&quot;&gt;1&lt;/property&gt;
+			      &lt;property name=&quot;digits&quot;&gt;0&lt;/property&gt;
+			      &lt;property name=&quot;numeric&quot;&gt;True&lt;/property&gt;
+			      &lt;property name=&quot;update_policy&quot;&gt;GTK_UPDATE_ALWAYS&lt;/property&gt;
+			      &lt;property name=&quot;snap_to_ticks&quot;&gt;False&lt;/property&gt;
+			      &lt;property name=&quot;wrap&quot;&gt;False&lt;/property&gt;
+			      &lt;property name=&quot;adjustment&quot;&gt;5 1 999999 1 1 0&lt;/property&gt;
+			    &lt;/widget&gt;
+			    &lt;packing&gt;
+			      &lt;property name=&quot;padding&quot;&gt;0&lt;/property&gt;
+			      &lt;property name=&quot;expand&quot;&gt;True&lt;/property&gt;
+			      &lt;property name=&quot;fill&quot;&gt;True&lt;/property&gt;
+			    &lt;/packing&gt;
+			  &lt;/child&gt;
+			&lt;/widget&gt;
+			&lt;packing&gt;
+			  &lt;property name=&quot;padding&quot;&gt;0&lt;/property&gt;
+			  &lt;property name=&quot;expand&quot;&gt;True&lt;/property&gt;
+			  &lt;property name=&quot;fill&quot;&gt;True&lt;/property&gt;
+			&lt;/packing&gt;
+		      &lt;/child&gt;
+
+		      &lt;child&gt;
+			&lt;widget class=&quot;GtkHBox&quot; id=&quot;maxAreaHbox&quot;&gt;
+			  &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+			  &lt;property name=&quot;homogeneous&quot;&gt;False&lt;/property&gt;
+			  &lt;property name=&quot;spacing&quot;&gt;0&lt;/property&gt;
+
+			  &lt;child&gt;
+			    &lt;widget class=&quot;GtkLabel&quot; id=&quot;maxAreaLabel&quot;&gt;
+			      &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+			      &lt;property name=&quot;label&quot; translatable=&quot;yes&quot;&gt;Ma_ximum area for a particle to be detected:   &lt;/property&gt;
+			      &lt;property name=&quot;use_underline&quot;&gt;True&lt;/property&gt;
+			      &lt;property name=&quot;use_markup&quot;&gt;False&lt;/property&gt;
+			      &lt;property name=&quot;justify&quot;&gt;GTK_JUSTIFY_LEFT&lt;/property&gt;
+			      &lt;property name=&quot;wrap&quot;&gt;False&lt;/property&gt;
+			      &lt;property name=&quot;selectable&quot;&gt;False&lt;/property&gt;
+			      &lt;property name=&quot;xalign&quot;&gt;0.5&lt;/property&gt;
+			      &lt;property name=&quot;yalign&quot;&gt;0.5&lt;/property&gt;
+			      &lt;property name=&quot;xpad&quot;&gt;0&lt;/property&gt;
+			      &lt;property name=&quot;ypad&quot;&gt;0&lt;/property&gt;
+			      &lt;property name=&quot;mnemonic_widget&quot;&gt;maxAreaSpinButton&lt;/property&gt;
+			      &lt;property name=&quot;ellipsize&quot;&gt;PANGO_ELLIPSIZE_NONE&lt;/property&gt;
+			      &lt;property name=&quot;width_chars&quot;&gt;-1&lt;/property&gt;
+			      &lt;property name=&quot;single_line_mode&quot;&gt;False&lt;/property&gt;
+			      &lt;property name=&quot;angle&quot;&gt;0&lt;/property&gt;
+			    &lt;/widget&gt;
+			    &lt;packing&gt;
+			      &lt;property name=&quot;padding&quot;&gt;0&lt;/property&gt;
+			      &lt;property name=&quot;expand&quot;&gt;False&lt;/property&gt;
+			      &lt;property name=&quot;fill&quot;&gt;False&lt;/property&gt;
+			    &lt;/packing&gt;
+			  &lt;/child&gt;
+
+			  &lt;child&gt;
+			    &lt;widget class=&quot;GtkSpinButton&quot; id=&quot;maxAreaSpinButton&quot;&gt;
+			      &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+			      &lt;property name=&quot;can_focus&quot;&gt;True&lt;/property&gt;
+			      &lt;property name=&quot;climb_rate&quot;&gt;1&lt;/property&gt;
+			      &lt;property name=&quot;digits&quot;&gt;0&lt;/property&gt;
+			      &lt;property name=&quot;numeric&quot;&gt;True&lt;/property&gt;
+			      &lt;property name=&quot;update_policy&quot;&gt;GTK_UPDATE_ALWAYS&lt;/property&gt;
+			      &lt;property name=&quot;snap_to_ticks&quot;&gt;False&lt;/property&gt;
+			      &lt;property name=&quot;wrap&quot;&gt;False&lt;/property&gt;
+			      &lt;property name=&quot;adjustment&quot;&gt;50000 1 999999 1 1 0&lt;/property&gt;
+			    &lt;/widget&gt;
+			    &lt;packing&gt;
+			      &lt;property name=&quot;padding&quot;&gt;0&lt;/property&gt;
+			      &lt;property name=&quot;expand&quot;&gt;True&lt;/property&gt;
+			      &lt;property name=&quot;fill&quot;&gt;True&lt;/property&gt;
+			    &lt;/packing&gt;
+			  &lt;/child&gt;
+			&lt;/widget&gt;
+			&lt;packing&gt;
+			  &lt;property name=&quot;padding&quot;&gt;0&lt;/property&gt;
+			  &lt;property name=&quot;expand&quot;&gt;True&lt;/property&gt;
+			  &lt;property name=&quot;fill&quot;&gt;True&lt;/property&gt;
+			&lt;/packing&gt;
+		      &lt;/child&gt;
+
+		      &lt;child&gt;
+			&lt;widget class=&quot;GtkHSeparator&quot; id=&quot;aboveCropSeparator&quot;&gt;
+			  &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+			&lt;/widget&gt;
+			&lt;packing&gt;
+			  &lt;property name=&quot;padding&quot;&gt;0&lt;/property&gt;
+			  &lt;property name=&quot;expand&quot;&gt;True&lt;/property&gt;
+			  &lt;property name=&quot;fill&quot;&gt;True&lt;/property&gt;
+			&lt;/packing&gt;
+		      &lt;/child&gt;
+
+		      &lt;child&gt;
+			&lt;widget class=&quot;GtkHBox&quot; id=&quot;leftCropHbox&quot;&gt;
+			  &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+			  &lt;property name=&quot;homogeneous&quot;&gt;False&lt;/property&gt;
+			  &lt;property name=&quot;spacing&quot;&gt;0&lt;/property&gt;
+
+			  &lt;child&gt;
+			    &lt;widget class=&quot;GtkLabel&quot; id=&quot;leftCropLabel&quot;&gt;
+			      &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+			      &lt;property name=&quot;label&quot; translatable=&quot;yes&quot;&gt;_Left side crop (ignore this many pixels on the left):        &lt;/property&gt;
+			      &lt;property name=&quot;use_underline&quot;&gt;True&lt;/property&gt;
+			      &lt;property name=&quot;use_markup&quot;&gt;False&lt;/property&gt;
+			      &lt;property name=&quot;justify&quot;&gt;GTK_JUSTIFY_LEFT&lt;/property&gt;
+			      &lt;property name=&quot;wrap&quot;&gt;False&lt;/property&gt;
+			      &lt;property name=&quot;selectable&quot;&gt;False&lt;/property&gt;
+			      &lt;property name=&quot;xalign&quot;&gt;0.5&lt;/property&gt;
+			      &lt;property name=&quot;yalign&quot;&gt;0.5&lt;/property&gt;
+			      &lt;property name=&quot;xpad&quot;&gt;0&lt;/property&gt;
+			      &lt;property name=&quot;ypad&quot;&gt;0&lt;/property&gt;
+			      &lt;property name=&quot;mnemonic_widget&quot;&gt;leftCropSpinButton&lt;/property&gt;
+			      &lt;property name=&quot;ellipsize&quot;&gt;PANGO_ELLIPSIZE_NONE&lt;/property&gt;
+			      &lt;property name=&quot;width_chars&quot;&gt;-1&lt;/property&gt;
+			      &lt;property name=&quot;single_line_mode&quot;&gt;False&lt;/property&gt;
+			      &lt;property name=&quot;angle&quot;&gt;0&lt;/property&gt;
+			    &lt;/widget&gt;
+			    &lt;packing&gt;
+			      &lt;property name=&quot;padding&quot;&gt;0&lt;/property&gt;
+			      &lt;property name=&quot;expand&quot;&gt;False&lt;/property&gt;
+			      &lt;property name=&quot;fill&quot;&gt;False&lt;/property&gt;
+			    &lt;/packing&gt;
+			  &lt;/child&gt;
+
+			  &lt;child&gt;
+			    &lt;widget class=&quot;GtkSpinButton&quot; id=&quot;leftCropSpinButton&quot;&gt;
+			      &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+			      &lt;property name=&quot;can_focus&quot;&gt;True&lt;/property&gt;
+			      &lt;property name=&quot;climb_rate&quot;&gt;1&lt;/property&gt;
+			      &lt;property name=&quot;digits&quot;&gt;0&lt;/property&gt;
+			      &lt;property name=&quot;numeric&quot;&gt;True&lt;/property&gt;
+			      &lt;property name=&quot;update_policy&quot;&gt;GTK_UPDATE_ALWAYS&lt;/property&gt;
+			      &lt;property name=&quot;snap_to_ticks&quot;&gt;False&lt;/property&gt;
+			      &lt;property name=&quot;wrap&quot;&gt;False&lt;/property&gt;
+			      &lt;property name=&quot;adjustment&quot;&gt;0 0 2048 1 1 0&lt;/property&gt;
+			    &lt;/widget&gt;
+			    &lt;packing&gt;
+			      &lt;property name=&quot;padding&quot;&gt;0&lt;/property&gt;
+			      &lt;property name=&quot;expand&quot;&gt;True&lt;/property&gt;
+			      &lt;property name=&quot;fill&quot;&gt;True&lt;/property&gt;
+			    &lt;/packing&gt;
+			  &lt;/child&gt;
+			&lt;/widget&gt;
+			&lt;packing&gt;
+			  &lt;property name=&quot;padding&quot;&gt;0&lt;/property&gt;
+			  &lt;property name=&quot;expand&quot;&gt;True&lt;/property&gt;
+			  &lt;property name=&quot;fill&quot;&gt;True&lt;/property&gt;
+			&lt;/packing&gt;
+		      &lt;/child&gt;
+
+		      &lt;child&gt;
+			&lt;widget class=&quot;GtkHBox&quot; id=&quot;rightCropHbox&quot;&gt;
+			  &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+			  &lt;property name=&quot;homogeneous&quot;&gt;False&lt;/property&gt;
+			  &lt;property name=&quot;spacing&quot;&gt;0&lt;/property&gt;
+
+			  &lt;child&gt;
+			    &lt;widget class=&quot;GtkLabel&quot; id=&quot;rightCropLabel&quot;&gt;
+			      &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+			      &lt;property name=&quot;label&quot; translatable=&quot;yes&quot;&gt;_Right side crop (ignore this many pixels on the right):     &lt;/property&gt;
+			      &lt;property name=&quot;use_underline&quot;&gt;True&lt;/property&gt;
+			      &lt;property name=&quot;use_markup&quot;&gt;False&lt;/property&gt;
+			      &lt;property name=&quot;justify&quot;&gt;GTK_JUSTIFY_LEFT&lt;/property&gt;
+			      &lt;property name=&quot;wrap&quot;&gt;False&lt;/property&gt;
+			      &lt;property name=&quot;selectable&quot;&gt;False&lt;/property&gt;
+			      &lt;property name=&quot;xalign&quot;&gt;0.5&lt;/property&gt;
+			      &lt;property name=&quot;yalign&quot;&gt;0.5&lt;/property&gt;
+			      &lt;property name=&quot;xpad&quot;&gt;0&lt;/property&gt;
+			      &lt;property name=&quot;ypad&quot;&gt;0&lt;/property&gt;
+			      &lt;property name=&quot;mnemonic_widget&quot;&gt;rightCropSpinButton&lt;/property&gt;
+			      &lt;property name=&quot;ellipsize&quot;&gt;PANGO_ELLIPSIZE_NONE&lt;/property&gt;
+			      &lt;property name=&quot;width_chars&quot;&gt;-1&lt;/property&gt;
+			      &lt;property name=&quot;single_line_mode&quot;&gt;False&lt;/property&gt;
+			      &lt;property name=&quot;angle&quot;&gt;0&lt;/property&gt;
+			    &lt;/widget&gt;
+			    &lt;packing&gt;
+			      &lt;property name=&quot;padding&quot;&gt;0&lt;/property&gt;
+			      &lt;property name=&quot;expand&quot;&gt;False&lt;/property&gt;
+			      &lt;property name=&quot;fill&quot;&gt;False&lt;/property&gt;
+			    &lt;/packing&gt;
+			  &lt;/child&gt;
+
+			  &lt;child&gt;
+			    &lt;widget class=&quot;GtkSpinButton&quot; id=&quot;rightCropSpinButton&quot;&gt;
+			      &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+			      &lt;property name=&quot;can_focus&quot;&gt;True&lt;/property&gt;
+			      &lt;property name=&quot;climb_rate&quot;&gt;1&lt;/property&gt;
+			      &lt;property name=&quot;digits&quot;&gt;0&lt;/property&gt;
+			      &lt;property name=&quot;numeric&quot;&gt;True&lt;/property&gt;
+			      &lt;property name=&quot;update_policy&quot;&gt;GTK_UPDATE_ALWAYS&lt;/property&gt;
+			      &lt;property name=&quot;snap_to_ticks&quot;&gt;False&lt;/property&gt;
+			      &lt;property name=&quot;wrap&quot;&gt;False&lt;/property&gt;
+			      &lt;property name=&quot;adjustment&quot;&gt;0 0 2048 1 1 0&lt;/property&gt;
+			    &lt;/widget&gt;
+			    &lt;packing&gt;
+			      &lt;property name=&quot;padding&quot;&gt;0&lt;/property&gt;
+			      &lt;property name=&quot;expand&quot;&gt;True&lt;/property&gt;
+			      &lt;property name=&quot;fill&quot;&gt;True&lt;/property&gt;
+			    &lt;/packing&gt;
+			  &lt;/child&gt;
+			&lt;/widget&gt;
+			&lt;packing&gt;
+			  &lt;property name=&quot;padding&quot;&gt;0&lt;/property&gt;
+			  &lt;property name=&quot;expand&quot;&gt;True&lt;/property&gt;
+			  &lt;property name=&quot;fill&quot;&gt;True&lt;/property&gt;
+			&lt;/packing&gt;
+		      &lt;/child&gt;
+
+		      &lt;child&gt;
+			&lt;widget class=&quot;GtkHBox&quot; id=&quot;topCropHbox&quot;&gt;
+			  &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+			  &lt;property name=&quot;homogeneous&quot;&gt;False&lt;/property&gt;
+			  &lt;property name=&quot;spacing&quot;&gt;0&lt;/property&gt;
+
+			  &lt;child&gt;
+			    &lt;widget class=&quot;GtkLabel&quot; id=&quot;topCropLabel&quot;&gt;
+			      &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+			      &lt;property name=&quot;label&quot; translatable=&quot;yes&quot;&gt;_Top crop (ignore this many pixels on the top):                  &lt;/property&gt;
+			      &lt;property name=&quot;use_underline&quot;&gt;True&lt;/property&gt;
+			      &lt;property name=&quot;use_markup&quot;&gt;False&lt;/property&gt;
+			      &lt;property name=&quot;justify&quot;&gt;GTK_JUSTIFY_LEFT&lt;/property&gt;
+			      &lt;property name=&quot;wrap&quot;&gt;False&lt;/property&gt;
+			      &lt;property name=&quot;selectable&quot;&gt;False&lt;/property&gt;
+			      &lt;property name=&quot;xalign&quot;&gt;0.5&lt;/property&gt;
+			      &lt;property name=&quot;yalign&quot;&gt;0.5&lt;/property&gt;
+			      &lt;property name=&quot;xpad&quot;&gt;0&lt;/property&gt;
+			      &lt;property name=&quot;ypad&quot;&gt;0&lt;/property&gt;
+			      &lt;property name=&quot;mnemonic_widget&quot;&gt;topCropSpinButton&lt;/property&gt;
+			      &lt;property name=&quot;ellipsize&quot;&gt;PANGO_ELLIPSIZE_NONE&lt;/property&gt;
+			      &lt;property name=&quot;width_chars&quot;&gt;-1&lt;/property&gt;
+			      &lt;property name=&quot;single_line_mode&quot;&gt;False&lt;/property&gt;
+			      &lt;property name=&quot;angle&quot;&gt;0&lt;/property&gt;
+			    &lt;/widget&gt;
+			    &lt;packing&gt;
+			      &lt;property name=&quot;padding&quot;&gt;0&lt;/property&gt;
+			      &lt;property name=&quot;expand&quot;&gt;False&lt;/property&gt;
+			      &lt;property name=&quot;fill&quot;&gt;False&lt;/property&gt;
+			    &lt;/packing&gt;
+			  &lt;/child&gt;
+
+			  &lt;child&gt;
+			    &lt;widget class=&quot;GtkSpinButton&quot; id=&quot;topCropSpinButton&quot;&gt;
+			      &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+			      &lt;property name=&quot;can_focus&quot;&gt;True&lt;/property&gt;
+			      &lt;property name=&quot;climb_rate&quot;&gt;1&lt;/property&gt;
+			      &lt;property name=&quot;digits&quot;&gt;0&lt;/property&gt;
+			      &lt;property name=&quot;numeric&quot;&gt;True&lt;/property&gt;
+			      &lt;property name=&quot;update_policy&quot;&gt;GTK_UPDATE_ALWAYS&lt;/property&gt;
+			      &lt;property name=&quot;snap_to_ticks&quot;&gt;False&lt;/property&gt;
+			      &lt;property name=&quot;wrap&quot;&gt;False&lt;/property&gt;
+			      &lt;property name=&quot;adjustment&quot;&gt;0 0 2048 1 1 0&lt;/property&gt;
+			    &lt;/widget&gt;
+			    &lt;packing&gt;
+			      &lt;property name=&quot;padding&quot;&gt;0&lt;/property&gt;
+			      &lt;property name=&quot;expand&quot;&gt;True&lt;/property&gt;
+			      &lt;property name=&quot;fill&quot;&gt;True&lt;/property&gt;
+			    &lt;/packing&gt;
+			  &lt;/child&gt;
+			&lt;/widget&gt;
+			&lt;packing&gt;
+			  &lt;property name=&quot;padding&quot;&gt;0&lt;/property&gt;
+			  &lt;property name=&quot;expand&quot;&gt;True&lt;/property&gt;
+			  &lt;property name=&quot;fill&quot;&gt;True&lt;/property&gt;
+			&lt;/packing&gt;
+		      &lt;/child&gt;
+
+		      &lt;child&gt;
+			&lt;widget class=&quot;GtkHBox&quot; id=&quot;bottomCropHbox&quot;&gt;
+			  &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+			  &lt;property name=&quot;homogeneous&quot;&gt;False&lt;/property&gt;
+			  &lt;property name=&quot;spacing&quot;&gt;0&lt;/property&gt;
+
+			  &lt;child&gt;
+			    &lt;widget class=&quot;GtkLabel&quot; id=&quot;bottomCropLabel&quot;&gt;
+			      &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+			      &lt;property name=&quot;label&quot; translatable=&quot;yes&quot;&gt;_Bottom crop (ignore this many pixels on the bottom):   &lt;/property&gt;
+			      &lt;property name=&quot;use_underline&quot;&gt;True&lt;/property&gt;
+			      &lt;property name=&quot;use_markup&quot;&gt;False&lt;/property&gt;
+			      &lt;property name=&quot;justify&quot;&gt;GTK_JUSTIFY_LEFT&lt;/property&gt;
+			      &lt;property name=&quot;wrap&quot;&gt;False&lt;/property&gt;
+			      &lt;property name=&quot;selectable&quot;&gt;False&lt;/property&gt;
+			      &lt;property name=&quot;xalign&quot;&gt;0.5&lt;/property&gt;
+			      &lt;property name=&quot;yalign&quot;&gt;0.5&lt;/property&gt;
+			      &lt;property name=&quot;xpad&quot;&gt;0&lt;/property&gt;
+			      &lt;property name=&quot;ypad&quot;&gt;0&lt;/property&gt;
+			      &lt;property name=&quot;mnemonic_widget&quot;&gt;bottomCropSpinButton&lt;/property&gt;
+			      &lt;property name=&quot;ellipsize&quot;&gt;PANGO_ELLIPSIZE_NONE&lt;/property&gt;
+			      &lt;property name=&quot;width_chars&quot;&gt;-1&lt;/property&gt;
+			      &lt;property name=&quot;single_line_mode&quot;&gt;False&lt;/property&gt;
+			      &lt;property name=&quot;angle&quot;&gt;0&lt;/property&gt;
+			    &lt;/widget&gt;
+			    &lt;packing&gt;
+			      &lt;property name=&quot;padding&quot;&gt;0&lt;/property&gt;
+			      &lt;property name=&quot;expand&quot;&gt;False&lt;/property&gt;
+			      &lt;property name=&quot;fill&quot;&gt;False&lt;/property&gt;
+			    &lt;/packing&gt;
+			  &lt;/child&gt;
+
+			  &lt;child&gt;
+			    &lt;widget class=&quot;GtkSpinButton&quot; id=&quot;bottomCropSpinButton&quot;&gt;
+			      &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+			      &lt;property name=&quot;can_focus&quot;&gt;True&lt;/property&gt;
+			      &lt;property name=&quot;climb_rate&quot;&gt;1&lt;/property&gt;
+			      &lt;property name=&quot;digits&quot;&gt;0&lt;/property&gt;
+			      &lt;property name=&quot;numeric&quot;&gt;True&lt;/property&gt;
+			      &lt;property name=&quot;update_policy&quot;&gt;GTK_UPDATE_ALWAYS&lt;/property&gt;
+			      &lt;property name=&quot;snap_to_ticks&quot;&gt;False&lt;/property&gt;
+			      &lt;property name=&quot;wrap&quot;&gt;False&lt;/property&gt;
+			      &lt;property name=&quot;adjustment&quot;&gt;0 0 2048 1 1 0&lt;/property&gt;
+			    &lt;/widget&gt;
+			    &lt;packing&gt;
+			      &lt;property name=&quot;padding&quot;&gt;0&lt;/property&gt;
+			      &lt;property name=&quot;expand&quot;&gt;True&lt;/property&gt;
+			      &lt;property name=&quot;fill&quot;&gt;True&lt;/property&gt;
+			    &lt;/packing&gt;
+			  &lt;/child&gt;
+			&lt;/widget&gt;
+			&lt;packing&gt;
+			  &lt;property name=&quot;padding&quot;&gt;0&lt;/property&gt;
+			  &lt;property name=&quot;expand&quot;&gt;True&lt;/property&gt;
+			  &lt;property name=&quot;fill&quot;&gt;True&lt;/property&gt;
+			&lt;/packing&gt;
+		      &lt;/child&gt;
+
+		      &lt;child&gt;
+			&lt;widget class=&quot;GtkHSeparator&quot; id=&quot;belowCropSeparator&quot;&gt;
+			  &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+			&lt;/widget&gt;
+			&lt;packing&gt;
+			  &lt;property name=&quot;padding&quot;&gt;0&lt;/property&gt;
+			  &lt;property name=&quot;expand&quot;&gt;True&lt;/property&gt;
+			  &lt;property name=&quot;fill&quot;&gt;True&lt;/property&gt;
+			&lt;/packing&gt;
+		      &lt;/child&gt;
+
+		      &lt;child&gt;
+			&lt;widget class=&quot;GtkHBox&quot; id=&quot;outputFormatHbox&quot;&gt;
+			  &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+			  &lt;property name=&quot;homogeneous&quot;&gt;False&lt;/property&gt;
+			  &lt;property name=&quot;spacing&quot;&gt;0&lt;/property&gt;
+
+			  &lt;child&gt;
+			    &lt;widget class=&quot;GtkLabel&quot; id=&quot;outputFormatLabel&quot;&gt;
+			      &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+			      &lt;property name=&quot;label&quot; translatable=&quot;yes&quot;&gt;Output _Format:   &lt;/property&gt;
+			      &lt;property name=&quot;use_underline&quot;&gt;True&lt;/property&gt;
+			      &lt;property name=&quot;use_markup&quot;&gt;False&lt;/property&gt;
+			      &lt;property name=&quot;justify&quot;&gt;GTK_JUSTIFY_LEFT&lt;/property&gt;
+			      &lt;property name=&quot;wrap&quot;&gt;False&lt;/property&gt;
+			      &lt;property name=&quot;selectable&quot;&gt;False&lt;/property&gt;
+			      &lt;property name=&quot;xalign&quot;&gt;0.5&lt;/property&gt;
+			      &lt;property name=&quot;yalign&quot;&gt;0.5&lt;/property&gt;
+			      &lt;property name=&quot;xpad&quot;&gt;0&lt;/property&gt;
+			      &lt;property name=&quot;ypad&quot;&gt;0&lt;/property&gt;
+			      &lt;property name=&quot;ellipsize&quot;&gt;PANGO_ELLIPSIZE_NONE&lt;/property&gt;
+			      &lt;property name=&quot;width_chars&quot;&gt;-1&lt;/property&gt;
+			      &lt;property name=&quot;single_line_mode&quot;&gt;False&lt;/property&gt;
+			      &lt;property name=&quot;angle&quot;&gt;0&lt;/property&gt;
+			    &lt;/widget&gt;
+			    &lt;packing&gt;
+			      &lt;property name=&quot;padding&quot;&gt;0&lt;/property&gt;
+			      &lt;property name=&quot;expand&quot;&gt;False&lt;/property&gt;
+			      &lt;property name=&quot;fill&quot;&gt;False&lt;/property&gt;
+			    &lt;/packing&gt;
+			  &lt;/child&gt;
+
+			  &lt;child&gt;
+			    &lt;widget class=&quot;GtkComboBox&quot; id=&quot;outputFormatMenu&quot;&gt;
+			      &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+			      &lt;property name=&quot;items&quot; translatable=&quot;yes&quot;&gt;&lt;/property&gt;
+			      &lt;property name=&quot;add_tearoffs&quot;&gt;False&lt;/property&gt;
+			      &lt;property name=&quot;focus_on_click&quot;&gt;True&lt;/property&gt;
+			    &lt;/widget&gt;
+			    &lt;packing&gt;
+			      &lt;property name=&quot;padding&quot;&gt;0&lt;/property&gt;
+			      &lt;property name=&quot;expand&quot;&gt;True&lt;/property&gt;
+			      &lt;property name=&quot;fill&quot;&gt;True&lt;/property&gt;
+			    &lt;/packing&gt;
+			  &lt;/child&gt;
+			&lt;/widget&gt;
+			&lt;packing&gt;
+			  &lt;property name=&quot;padding&quot;&gt;0&lt;/property&gt;
+			  &lt;property name=&quot;expand&quot;&gt;True&lt;/property&gt;
+			  &lt;property name=&quot;fill&quot;&gt;True&lt;/property&gt;
+			&lt;/packing&gt;
+		      &lt;/child&gt;
+
+		      &lt;child&gt;
+			&lt;widget class=&quot;GtkHBox&quot; id=&quot;outputFileHbox&quot;&gt;
+			  &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+			  &lt;property name=&quot;homogeneous&quot;&gt;False&lt;/property&gt;
+			  &lt;property name=&quot;spacing&quot;&gt;5&lt;/property&gt;
+
+			  &lt;child&gt;
+			    &lt;widget class=&quot;GtkLabel&quot; id=&quot;outputFileLabel&quot;&gt;
+			      &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+			      &lt;property name=&quot;label&quot; translatable=&quot;yes&quot;&gt;_Output File:&lt;/property&gt;
+			      &lt;property name=&quot;use_underline&quot;&gt;True&lt;/property&gt;
+			      &lt;property name=&quot;use_markup&quot;&gt;False&lt;/property&gt;
+			      &lt;property name=&quot;justify&quot;&gt;GTK_JUSTIFY_LEFT&lt;/property&gt;
+			      &lt;property name=&quot;wrap&quot;&gt;False&lt;/property&gt;
+			      &lt;property name=&quot;selectable&quot;&gt;False&lt;/property&gt;
+			      &lt;property name=&quot;xalign&quot;&gt;0.5&lt;/property&gt;
+			      &lt;property name=&quot;yalign&quot;&gt;0.5&lt;/property&gt;
+			      &lt;property name=&quot;xpad&quot;&gt;0&lt;/property&gt;
+			      &lt;property name=&quot;ypad&quot;&gt;0&lt;/property&gt;
+			      &lt;property name=&quot;mnemonic_widget&quot;&gt;outputFileEntry&lt;/property&gt;
+			      &lt;property name=&quot;ellipsize&quot;&gt;PANGO_ELLIPSIZE_NONE&lt;/property&gt;
+			      &lt;property name=&quot;width_chars&quot;&gt;-1&lt;/property&gt;
+			      &lt;property name=&quot;single_line_mode&quot;&gt;False&lt;/property&gt;
+			      &lt;property name=&quot;angle&quot;&gt;0&lt;/property&gt;
+			    &lt;/widget&gt;
+			    &lt;packing&gt;
+			      &lt;property name=&quot;padding&quot;&gt;0&lt;/property&gt;
+			      &lt;property name=&quot;expand&quot;&gt;False&lt;/property&gt;
+			      &lt;property name=&quot;fill&quot;&gt;False&lt;/property&gt;
+			    &lt;/packing&gt;
+			  &lt;/child&gt;
+
+			  &lt;child&gt;
+			    &lt;widget class=&quot;GtkEntry&quot; id=&quot;outputFileEntry&quot;&gt;
+			      &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+			      &lt;property name=&quot;can_focus&quot;&gt;True&lt;/property&gt;
+			      &lt;property name=&quot;editable&quot;&gt;True&lt;/property&gt;
+			      &lt;property name=&quot;visibility&quot;&gt;True&lt;/property&gt;
+			      &lt;property name=&quot;max_length&quot;&gt;0&lt;/property&gt;
+			      &lt;property name=&quot;text&quot; translatable=&quot;yes&quot;&gt;&lt;/property&gt;
+			      &lt;property name=&quot;has_frame&quot;&gt;True&lt;/property&gt;
+			      &lt;property name=&quot;invisible_char&quot;&gt;&#8226;&lt;/property&gt;
+			      &lt;property name=&quot;activates_default&quot;&gt;False&lt;/property&gt;
+			      &lt;property name=&quot;width_chars&quot;&gt;40&lt;/property&gt;
+			    &lt;/widget&gt;
+			    &lt;packing&gt;
+			      &lt;property name=&quot;padding&quot;&gt;0&lt;/property&gt;
+			      &lt;property name=&quot;expand&quot;&gt;True&lt;/property&gt;
+			      &lt;property name=&quot;fill&quot;&gt;True&lt;/property&gt;
+			    &lt;/packing&gt;
+			  &lt;/child&gt;
+
+			  &lt;child&gt;
+			    &lt;widget class=&quot;GtkButton&quot; id=&quot;outputFileBrowseButton&quot;&gt;
+			      &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+			      &lt;property name=&quot;can_focus&quot;&gt;True&lt;/property&gt;
+			      &lt;property name=&quot;label&quot; translatable=&quot;yes&quot;&gt;_Browse...&lt;/property&gt;
+			      &lt;property name=&quot;use_underline&quot;&gt;True&lt;/property&gt;
+			      &lt;property name=&quot;relief&quot;&gt;GTK_RELIEF_NORMAL&lt;/property&gt;
+			      &lt;property name=&quot;focus_on_click&quot;&gt;True&lt;/property&gt;
+			    &lt;/widget&gt;
+			    &lt;packing&gt;
+			      &lt;property name=&quot;padding&quot;&gt;0&lt;/property&gt;
+			      &lt;property name=&quot;expand&quot;&gt;False&lt;/property&gt;
+			      &lt;property name=&quot;fill&quot;&gt;False&lt;/property&gt;
+			    &lt;/packing&gt;
+			  &lt;/child&gt;
+			&lt;/widget&gt;
+			&lt;packing&gt;
+			  &lt;property name=&quot;padding&quot;&gt;0&lt;/property&gt;
+			  &lt;property name=&quot;expand&quot;&gt;True&lt;/property&gt;
+			  &lt;property name=&quot;fill&quot;&gt;True&lt;/property&gt;
+			&lt;/packing&gt;
+		      &lt;/child&gt;
+
+		      &lt;child&gt;
+			&lt;widget class=&quot;GtkHBox&quot; id=&quot;cameraNumberHbox&quot;&gt;
+			  &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+			  &lt;property name=&quot;homogeneous&quot;&gt;False&lt;/property&gt;
+			  &lt;property name=&quot;spacing&quot;&gt;0&lt;/property&gt;
+
+			  &lt;child&gt;
+			    &lt;widget class=&quot;GtkLabel&quot; id=&quot;cameraNumberLabel&quot;&gt;
+			      &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+			      &lt;property name=&quot;label&quot; translatable=&quot;yes&quot;&gt;_Camera Number for output file:      &lt;/property&gt;
+			      &lt;property name=&quot;use_underline&quot;&gt;True&lt;/property&gt;
+			      &lt;property name=&quot;use_markup&quot;&gt;False&lt;/property&gt;
+			      &lt;property name=&quot;justify&quot;&gt;GTK_JUSTIFY_LEFT&lt;/property&gt;
+			      &lt;property name=&quot;wrap&quot;&gt;False&lt;/property&gt;
+			      &lt;property name=&quot;selectable&quot;&gt;False&lt;/property&gt;
+			      &lt;property name=&quot;xalign&quot;&gt;0.5&lt;/property&gt;
+			      &lt;property name=&quot;yalign&quot;&gt;0.5&lt;/property&gt;
+			      &lt;property name=&quot;xpad&quot;&gt;0&lt;/property&gt;
+			      &lt;property name=&quot;ypad&quot;&gt;0&lt;/property&gt;
+			      &lt;property name=&quot;mnemonic_widget&quot;&gt;cameraNumberSpinButton&lt;/property&gt;
+			      &lt;property name=&quot;ellipsize&quot;&gt;PANGO_ELLIPSIZE_NONE&lt;/property&gt;
+			      &lt;property name=&quot;width_chars&quot;&gt;-1&lt;/property&gt;
+			      &lt;property name=&quot;single_line_mode&quot;&gt;False&lt;/property&gt;
+			      &lt;property name=&quot;angle&quot;&gt;0&lt;/property&gt;
+			    &lt;/widget&gt;
+			    &lt;packing&gt;
+			      &lt;property name=&quot;padding&quot;&gt;0&lt;/property&gt;
+			      &lt;property name=&quot;expand&quot;&gt;False&lt;/property&gt;
+			      &lt;property name=&quot;fill&quot;&gt;False&lt;/property&gt;
+			    &lt;/packing&gt;
+			  &lt;/child&gt;
+
+			  &lt;child&gt;
+			    &lt;widget class=&quot;GtkSpinButton&quot; id=&quot;cameraNumberSpinButton&quot;&gt;
+			      &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+			      &lt;property name=&quot;can_focus&quot;&gt;True&lt;/property&gt;
+			      &lt;property name=&quot;climb_rate&quot;&gt;1&lt;/property&gt;
+			      &lt;property name=&quot;digits&quot;&gt;0&lt;/property&gt;
+			      &lt;property name=&quot;numeric&quot;&gt;True&lt;/property&gt;
+			      &lt;property name=&quot;update_policy&quot;&gt;GTK_UPDATE_ALWAYS&lt;/property&gt;
+			      &lt;property name=&quot;snap_to_ticks&quot;&gt;False&lt;/property&gt;
+			      &lt;property name=&quot;wrap&quot;&gt;False&lt;/property&gt;
+			      &lt;property name=&quot;adjustment&quot;&gt;1 0 99999 1 1 0&lt;/property&gt;
+			    &lt;/widget&gt;
+			    &lt;packing&gt;
+			      &lt;property name=&quot;padding&quot;&gt;0&lt;/property&gt;
+			      &lt;property name=&quot;expand&quot;&gt;True&lt;/property&gt;
+			      &lt;property name=&quot;fill&quot;&gt;True&lt;/property&gt;
+			    &lt;/packing&gt;
+			  &lt;/child&gt;
+			&lt;/widget&gt;
+			&lt;packing&gt;
+			  &lt;property name=&quot;padding&quot;&gt;0&lt;/property&gt;
+			  &lt;property name=&quot;expand&quot;&gt;True&lt;/property&gt;
+			  &lt;property name=&quot;fill&quot;&gt;True&lt;/property&gt;
+			&lt;/packing&gt;
+		      &lt;/child&gt;
+
+		      &lt;child&gt;
+			&lt;widget class=&quot;GtkHBox&quot; id=&quot;debugHbox&quot;&gt;
+			  &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+			  &lt;property name=&quot;homogeneous&quot;&gt;False&lt;/property&gt;
+			  &lt;property name=&quot;spacing&quot;&gt;0&lt;/property&gt;
+
+			  &lt;child&gt;
+			    &lt;widget class=&quot;GtkLabel&quot; id=&quot;debugLabel&quot;&gt;
+			      &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+			      &lt;property name=&quot;label&quot; translatable=&quot;yes&quot;&gt;_Debugging settings (bits):   &lt;/property&gt;
+			      &lt;property name=&quot;use_underline&quot;&gt;True&lt;/property&gt;
+			      &lt;property name=&quot;use_markup&quot;&gt;False&lt;/property&gt;
+			      &lt;property name=&quot;justify&quot;&gt;GTK_JUSTIFY_LEFT&lt;/property&gt;
+			      &lt;property name=&quot;wrap&quot;&gt;False&lt;/property&gt;
+			      &lt;property name=&quot;selectable&quot;&gt;False&lt;/property&gt;
+			      &lt;property name=&quot;xalign&quot;&gt;0.5&lt;/property&gt;
+			      &lt;property name=&quot;yalign&quot;&gt;0.5&lt;/property&gt;
+			      &lt;property name=&quot;xpad&quot;&gt;0&lt;/property&gt;
+			      &lt;property name=&quot;ypad&quot;&gt;0&lt;/property&gt;
+			      &lt;property name=&quot;mnemonic_widget&quot;&gt;debugSpinButton&lt;/property&gt;
+			      &lt;property name=&quot;ellipsize&quot;&gt;PANGO_ELLIPSIZE_NONE&lt;/property&gt;
+			      &lt;property name=&quot;width_chars&quot;&gt;-1&lt;/property&gt;
+			      &lt;property name=&quot;single_line_mode&quot;&gt;False&lt;/property&gt;
+			      &lt;property name=&quot;angle&quot;&gt;0&lt;/property&gt;
+			    &lt;/widget&gt;
+			    &lt;packing&gt;
+			      &lt;property name=&quot;padding&quot;&gt;0&lt;/property&gt;
+			      &lt;property name=&quot;expand&quot;&gt;False&lt;/property&gt;
+			      &lt;property name=&quot;fill&quot;&gt;False&lt;/property&gt;
+			    &lt;/packing&gt;
+			  &lt;/child&gt;
+
+			  &lt;child&gt;
+			    &lt;widget class=&quot;GtkSpinButton&quot; id=&quot;debugSpinButton&quot;&gt;
+			      &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+			      &lt;property name=&quot;can_focus&quot;&gt;True&lt;/property&gt;
+			      &lt;property name=&quot;climb_rate&quot;&gt;1&lt;/property&gt;
+			      &lt;property name=&quot;digits&quot;&gt;0&lt;/property&gt;
+			      &lt;property name=&quot;numeric&quot;&gt;True&lt;/property&gt;
+			      &lt;property name=&quot;update_policy&quot;&gt;GTK_UPDATE_ALWAYS&lt;/property&gt;
+			      &lt;property name=&quot;snap_to_ticks&quot;&gt;False&lt;/property&gt;
+			      &lt;property name=&quot;wrap&quot;&gt;False&lt;/property&gt;
+			      &lt;property name=&quot;adjustment&quot;&gt;0 0 16777215 1 10 0&lt;/property&gt;
+			    &lt;/widget&gt;
+			    &lt;packing&gt;
+			      &lt;property name=&quot;padding&quot;&gt;0&lt;/property&gt;
+			      &lt;property name=&quot;expand&quot;&gt;True&lt;/property&gt;
+			      &lt;property name=&quot;fill&quot;&gt;True&lt;/property&gt;
+			    &lt;/packing&gt;
+			  &lt;/child&gt;
+			&lt;/widget&gt;
+			&lt;packing&gt;
+			  &lt;property name=&quot;padding&quot;&gt;0&lt;/property&gt;
+			  &lt;property name=&quot;expand&quot;&gt;True&lt;/property&gt;
+			  &lt;property name=&quot;fill&quot;&gt;True&lt;/property&gt;
+			&lt;/packing&gt;
+		      &lt;/child&gt;
+		    &lt;/widget&gt;
+		    &lt;packing&gt;
+		      &lt;property name=&quot;padding&quot;&gt;0&lt;/property&gt;
+		      &lt;property name=&quot;expand&quot;&gt;True&lt;/property&gt;
+		      &lt;property name=&quot;fill&quot;&gt;True&lt;/property&gt;
+		    &lt;/packing&gt;
+		  &lt;/child&gt;
+		&lt;/widget&gt;
+		&lt;packing&gt;
+		  &lt;property name=&quot;padding&quot;&gt;0&lt;/property&gt;
+		  &lt;property name=&quot;expand&quot;&gt;False&lt;/property&gt;
+		  &lt;property name=&quot;fill&quot;&gt;True&lt;/property&gt;
+		&lt;/packing&gt;
+	      &lt;/child&gt;
+
+	      &lt;child&gt;
+		&lt;widget class=&quot;GtkVBox&quot; id=&quot;previewVboxOuter&quot;&gt;
+		  &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+		  &lt;property name=&quot;homogeneous&quot;&gt;False&lt;/property&gt;
+		  &lt;property name=&quot;spacing&quot;&gt;0&lt;/property&gt;
+
+		  &lt;child&gt;
+		    &lt;widget class=&quot;GtkFrame&quot; id=&quot;previewFrame&quot;&gt;
+		      &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+		      &lt;property name=&quot;label_xalign&quot;&gt;0&lt;/property&gt;
+		      &lt;property name=&quot;label_yalign&quot;&gt;0.5&lt;/property&gt;
+		      &lt;property name=&quot;shadow_type&quot;&gt;GTK_SHADOW_ETCHED_IN&lt;/property&gt;
+
+		      &lt;child&gt;
+			&lt;widget class=&quot;GtkAlignment&quot; id=&quot;previewAlignment&quot;&gt;
+			  &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+			  &lt;property name=&quot;xalign&quot;&gt;0.5&lt;/property&gt;
+			  &lt;property name=&quot;yalign&quot;&gt;0.5&lt;/property&gt;
+			  &lt;property name=&quot;xscale&quot;&gt;1&lt;/property&gt;
+			  &lt;property name=&quot;yscale&quot;&gt;1&lt;/property&gt;
+			  &lt;property name=&quot;top_padding&quot;&gt;0&lt;/property&gt;
+			  &lt;property name=&quot;bottom_padding&quot;&gt;8&lt;/property&gt;
+			  &lt;property name=&quot;left_padding&quot;&gt;6&lt;/property&gt;
+			  &lt;property name=&quot;right_padding&quot;&gt;8&lt;/property&gt;
+
+			  &lt;child&gt;
+			    &lt;widget class=&quot;GtkVBox&quot; id=&quot;previewVbox&quot;&gt;
+			      &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+			      &lt;property name=&quot;homogeneous&quot;&gt;False&lt;/property&gt;
+			      &lt;property name=&quot;spacing&quot;&gt;5&lt;/property&gt;
+
+			      &lt;child&gt;
+				&lt;widget class=&quot;GtkHBox&quot; id=&quot;previewControlHbox&quot;&gt;
+				  &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+				  &lt;property name=&quot;homogeneous&quot;&gt;False&lt;/property&gt;
+				  &lt;property name=&quot;spacing&quot;&gt;5&lt;/property&gt;
+
+				  &lt;child&gt;
+				    &lt;widget class=&quot;GtkComboBox&quot; id=&quot;previewOutputMenu&quot;&gt;
+				      &lt;property name=&quot;items&quot; translatable=&quot;yes&quot;&gt;Swiss Army Knife output
+Final output&lt;/property&gt;
+				      &lt;property name=&quot;add_tearoffs&quot;&gt;False&lt;/property&gt;
+				      &lt;property name=&quot;focus_on_click&quot;&gt;True&lt;/property&gt;
+				    &lt;/widget&gt;
+				    &lt;packing&gt;
+				      &lt;property name=&quot;padding&quot;&gt;0&lt;/property&gt;
+				      &lt;property name=&quot;expand&quot;&gt;False&lt;/property&gt;
+				      &lt;property name=&quot;fill&quot;&gt;True&lt;/property&gt;
+				    &lt;/packing&gt;
+				  &lt;/child&gt;
+
+				  &lt;child&gt;
+				    &lt;widget class=&quot;GtkHScale&quot; id=&quot;previewSlider&quot;&gt;
+				      &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+				      &lt;property name=&quot;can_focus&quot;&gt;True&lt;/property&gt;
+				      &lt;property name=&quot;draw_value&quot;&gt;True&lt;/property&gt;
+				      &lt;property name=&quot;value_pos&quot;&gt;GTK_POS_TOP&lt;/property&gt;
+				      &lt;property name=&quot;digits&quot;&gt;0&lt;/property&gt;
+				      &lt;property name=&quot;update_policy&quot;&gt;GTK_UPDATE_CONTINUOUS&lt;/property&gt;
+				      &lt;property name=&quot;inverted&quot;&gt;False&lt;/property&gt;
+				      &lt;property name=&quot;adjustment&quot;&gt;0 0 99 1 1 0&lt;/property&gt;
+				    &lt;/widget&gt;
+				    &lt;packing&gt;
+				      &lt;property name=&quot;padding&quot;&gt;0&lt;/property&gt;
+				      &lt;property name=&quot;expand&quot;&gt;True&lt;/property&gt;
+				      &lt;property name=&quot;fill&quot;&gt;True&lt;/property&gt;
+				    &lt;/packing&gt;
+				  &lt;/child&gt;
+				&lt;/widget&gt;
+				&lt;packing&gt;
+				  &lt;property name=&quot;padding&quot;&gt;0&lt;/property&gt;
+				  &lt;property name=&quot;expand&quot;&gt;True&lt;/property&gt;
+				  &lt;property name=&quot;fill&quot;&gt;True&lt;/property&gt;
+				&lt;/packing&gt;
+			      &lt;/child&gt;
+
+			      &lt;child&gt;
+				&lt;widget class=&quot;GtkDrawingArea&quot; id=&quot;previewVideo&quot;&gt;
+				  &lt;property name=&quot;height_request&quot;&gt;300&lt;/property&gt;
+				  &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+				  &lt;property name=&quot;events&quot;&gt;GDK_BUTTON1_MOTION_MASK | GDK_BUTTON_PRESS_MASK&lt;/property&gt;
+				&lt;/widget&gt;
+				&lt;packing&gt;
+				  &lt;property name=&quot;padding&quot;&gt;0&lt;/property&gt;
+				  &lt;property name=&quot;expand&quot;&gt;True&lt;/property&gt;
+				  &lt;property name=&quot;fill&quot;&gt;True&lt;/property&gt;
+				&lt;/packing&gt;
+			      &lt;/child&gt;
+
+			      &lt;child&gt;
+				&lt;widget class=&quot;GtkDrawingArea&quot; id=&quot;previewDisabled&quot;&gt;
+				&lt;/widget&gt;
+				&lt;packing&gt;
+				  &lt;property name=&quot;padding&quot;&gt;0&lt;/property&gt;
+				  &lt;property name=&quot;expand&quot;&gt;True&lt;/property&gt;
+				  &lt;property name=&quot;fill&quot;&gt;True&lt;/property&gt;
+				&lt;/packing&gt;
+			      &lt;/child&gt;
+			    &lt;/widget&gt;
+			  &lt;/child&gt;
+			&lt;/widget&gt;
+		      &lt;/child&gt;
+
+		      &lt;child&gt;
+			&lt;widget class=&quot;GtkLabel&quot; id=&quot;previewLabel&quot;&gt;
+			  &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+			  &lt;property name=&quot;label&quot; translatable=&quot;yes&quot;&gt;Preview&lt;/property&gt;
+			  &lt;property name=&quot;use_underline&quot;&gt;False&lt;/property&gt;
+			  &lt;property name=&quot;use_markup&quot;&gt;False&lt;/property&gt;
+			  &lt;property name=&quot;justify&quot;&gt;GTK_JUSTIFY_LEFT&lt;/property&gt;
+			  &lt;property name=&quot;wrap&quot;&gt;False&lt;/property&gt;
+			  &lt;property name=&quot;selectable&quot;&gt;False&lt;/property&gt;
+			  &lt;property name=&quot;xalign&quot;&gt;0.5&lt;/property&gt;
+			  &lt;property name=&quot;yalign&quot;&gt;0.5&lt;/property&gt;
+			  &lt;property name=&quot;xpad&quot;&gt;0&lt;/property&gt;
+			  &lt;property name=&quot;ypad&quot;&gt;0&lt;/property&gt;
+			  &lt;property name=&quot;ellipsize&quot;&gt;PANGO_ELLIPSIZE_NONE&lt;/property&gt;
+			  &lt;property name=&quot;width_chars&quot;&gt;-1&lt;/property&gt;
+			  &lt;property name=&quot;single_line_mode&quot;&gt;False&lt;/property&gt;
+			  &lt;property name=&quot;angle&quot;&gt;0&lt;/property&gt;
+			&lt;/widget&gt;
+			&lt;packing&gt;
+			  &lt;property name=&quot;type&quot;&gt;label_item&lt;/property&gt;
+			&lt;/packing&gt;
+		      &lt;/child&gt;
+		    &lt;/widget&gt;
+		    &lt;packing&gt;
+		      &lt;property name=&quot;padding&quot;&gt;0&lt;/property&gt;
+		      &lt;property name=&quot;expand&quot;&gt;False&lt;/property&gt;
+		      &lt;property name=&quot;fill&quot;&gt;True&lt;/property&gt;
+		    &lt;/packing&gt;
+		  &lt;/child&gt;
+		&lt;/widget&gt;
+		&lt;packing&gt;
+		  &lt;property name=&quot;padding&quot;&gt;0&lt;/property&gt;
+		  &lt;property name=&quot;expand&quot;&gt;True&lt;/property&gt;
+		  &lt;property name=&quot;fill&quot;&gt;True&lt;/property&gt;
+		&lt;/packing&gt;
+	      &lt;/child&gt;
+	    &lt;/widget&gt;
+	    &lt;packing&gt;
+	      &lt;property name=&quot;padding&quot;&gt;0&lt;/property&gt;
+	      &lt;property name=&quot;expand&quot;&gt;True&lt;/property&gt;
+	      &lt;property name=&quot;fill&quot;&gt;True&lt;/property&gt;
+	    &lt;/packing&gt;
+	  &lt;/child&gt;
+	&lt;/widget&gt;
+	&lt;packing&gt;
+	  &lt;property name=&quot;padding&quot;&gt;0&lt;/property&gt;
+	  &lt;property name=&quot;expand&quot;&gt;True&lt;/property&gt;
+	  &lt;property name=&quot;fill&quot;&gt;True&lt;/property&gt;
+	&lt;/packing&gt;
+      &lt;/child&gt;
+    &lt;/widget&gt;
+  &lt;/child&gt;
+&lt;/widget&gt;
+
+&lt;/glade-interface&gt;

Added: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/glade/swissarmyknife.glade
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/glade/swissarmyknife.glade	2007-09-30 16:29:29 UTC (rev 3607)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/glade/swissarmyknife.glade	2007-09-30 16:49:31 UTC (rev 3608)
@@ -0,0 +1,1886 @@
+&lt;?xml version=&quot;1.0&quot; standalone=&quot;no&quot;?&gt; &lt;!--*- mode: xml -*--&gt;
+&lt;!DOCTYPE glade-interface SYSTEM &quot;<A HREF="http://glade.gnome.org/glade-2.0.dtd">http://glade.gnome.org/glade-2.0.dtd</A>&quot;&gt;
+
+&lt;glade-interface&gt;
+
+&lt;widget class=&quot;GtkDialog&quot; id=&quot;swiss_army_knife_dialog&quot;&gt;
+  &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+  &lt;property name=&quot;title&quot; translatable=&quot;yes&quot;&gt;Swiss Army Knife&lt;/property&gt;
+  &lt;property name=&quot;type&quot;&gt;GTK_WINDOW_TOPLEVEL&lt;/property&gt;
+  &lt;property name=&quot;window_position&quot;&gt;GTK_WIN_POS_NONE&lt;/property&gt;
+  &lt;property name=&quot;modal&quot;&gt;False&lt;/property&gt;
+  &lt;property name=&quot;resizable&quot;&gt;True&lt;/property&gt;
+  &lt;property name=&quot;destroy_with_parent&quot;&gt;False&lt;/property&gt;
+  &lt;property name=&quot;decorated&quot;&gt;True&lt;/property&gt;
+  &lt;property name=&quot;skip_taskbar_hint&quot;&gt;False&lt;/property&gt;
+  &lt;property name=&quot;skip_pager_hint&quot;&gt;False&lt;/property&gt;
+  &lt;property name=&quot;type_hint&quot;&gt;GDK_WINDOW_TYPE_HINT_DIALOG&lt;/property&gt;
+  &lt;property name=&quot;gravity&quot;&gt;GDK_GRAVITY_NORTH_WEST&lt;/property&gt;
+  &lt;property name=&quot;focus_on_map&quot;&gt;True&lt;/property&gt;
+  &lt;property name=&quot;urgency_hint&quot;&gt;False&lt;/property&gt;
+  &lt;property name=&quot;has_separator&quot;&gt;True&lt;/property&gt;
+
+  &lt;child internal-child=&quot;vbox&quot;&gt;
+    &lt;widget class=&quot;GtkVBox&quot; id=&quot;dialogVbox&quot;&gt;
+      &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+      &lt;property name=&quot;homogeneous&quot;&gt;False&lt;/property&gt;
+      &lt;property name=&quot;spacing&quot;&gt;0&lt;/property&gt;
+
+      &lt;child internal-child=&quot;action_area&quot;&gt;
+	&lt;widget class=&quot;GtkHButtonBox&quot; id=&quot;dialogButtonBox&quot;&gt;
+	  &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+	  &lt;property name=&quot;layout_style&quot;&gt;GTK_BUTTONBOX_END&lt;/property&gt;
+
+	  &lt;child&gt;
+	    &lt;widget class=&quot;GtkButton&quot; id=&quot;cancelButton&quot;&gt;
+	      &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+	      &lt;property name=&quot;can_default&quot;&gt;True&lt;/property&gt;
+	      &lt;property name=&quot;can_focus&quot;&gt;True&lt;/property&gt;
+	      &lt;property name=&quot;label&quot;&gt;gtk-cancel&lt;/property&gt;
+	      &lt;property name=&quot;use_stock&quot;&gt;True&lt;/property&gt;
+	      &lt;property name=&quot;relief&quot;&gt;GTK_RELIEF_NORMAL&lt;/property&gt;
+	      &lt;property name=&quot;focus_on_click&quot;&gt;True&lt;/property&gt;
+	      &lt;property name=&quot;response_id&quot;&gt;-6&lt;/property&gt;
+	    &lt;/widget&gt;
+	  &lt;/child&gt;
+
+	  &lt;child&gt;
+	    &lt;widget class=&quot;GtkButton&quot; id=&quot;okButton&quot;&gt;
+	      &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+	      &lt;property name=&quot;can_default&quot;&gt;True&lt;/property&gt;
+	      &lt;property name=&quot;can_focus&quot;&gt;True&lt;/property&gt;
+	      &lt;property name=&quot;label&quot;&gt;gtk-ok&lt;/property&gt;
+	      &lt;property name=&quot;use_stock&quot;&gt;True&lt;/property&gt;
+	      &lt;property name=&quot;relief&quot;&gt;GTK_RELIEF_NORMAL&lt;/property&gt;
+	      &lt;property name=&quot;focus_on_click&quot;&gt;True&lt;/property&gt;
+	      &lt;property name=&quot;response_id&quot;&gt;-5&lt;/property&gt;
+	    &lt;/widget&gt;
+	  &lt;/child&gt;
+	&lt;/widget&gt;
+	&lt;packing&gt;
+	  &lt;property name=&quot;padding&quot;&gt;0&lt;/property&gt;
+	  &lt;property name=&quot;expand&quot;&gt;False&lt;/property&gt;
+	  &lt;property name=&quot;fill&quot;&gt;True&lt;/property&gt;
+	  &lt;property name=&quot;pack_type&quot;&gt;GTK_PACK_END&lt;/property&gt;
+	&lt;/packing&gt;
+      &lt;/child&gt;
+
+      &lt;child&gt;
+	&lt;widget class=&quot;GtkHBox&quot; id=&quot;dialogHbox&quot;&gt;
+	  &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+	  &lt;property name=&quot;homogeneous&quot;&gt;False&lt;/property&gt;
+	  &lt;property name=&quot;spacing&quot;&gt;0&lt;/property&gt;
+
+	  &lt;child&gt;
+	    &lt;widget class=&quot;GtkVBox&quot; id=&quot;allSettingsVbox&quot;&gt;
+	      &lt;property name=&quot;border_width&quot;&gt;8&lt;/property&gt;
+	      &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+	      &lt;property name=&quot;homogeneous&quot;&gt;False&lt;/property&gt;
+	      &lt;property name=&quot;spacing&quot;&gt;12&lt;/property&gt;
+
+	      &lt;child&gt;
+		&lt;widget class=&quot;GtkHBox&quot; id=&quot;settingsOuterHbox&quot;&gt;
+		  &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+		  &lt;property name=&quot;homogeneous&quot;&gt;False&lt;/property&gt;
+		  &lt;property name=&quot;spacing&quot;&gt;0&lt;/property&gt;
+
+		  &lt;child&gt;
+		    &lt;widget class=&quot;GtkVBox&quot; id=&quot;settingsOuterVbox&quot;&gt;
+		      &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+		      &lt;property name=&quot;homogeneous&quot;&gt;False&lt;/property&gt;
+		      &lt;property name=&quot;spacing&quot;&gt;12&lt;/property&gt;
+
+		      &lt;child&gt;
+			&lt;widget class=&quot;GtkHBox&quot; id=&quot;operationHbox&quot;&gt;
+			  &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+			  &lt;property name=&quot;homogeneous&quot;&gt;False&lt;/property&gt;
+			  &lt;property name=&quot;spacing&quot;&gt;0&lt;/property&gt;
+
+			  &lt;child&gt;
+			    &lt;widget class=&quot;GtkLabel&quot; id=&quot;operationLabel&quot;&gt;
+			      &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+			      &lt;property name=&quot;label&quot; translatable=&quot;yes&quot;&gt;Select _Operation on each pixel P and input A:   &lt;/property&gt;
+			      &lt;property name=&quot;use_underline&quot;&gt;True&lt;/property&gt;
+			      &lt;property name=&quot;use_markup&quot;&gt;False&lt;/property&gt;
+			      &lt;property name=&quot;justify&quot;&gt;GTK_JUSTIFY_LEFT&lt;/property&gt;
+			      &lt;property name=&quot;wrap&quot;&gt;False&lt;/property&gt;
+			      &lt;property name=&quot;selectable&quot;&gt;False&lt;/property&gt;
+			      &lt;property name=&quot;xalign&quot;&gt;0.5&lt;/property&gt;
+			      &lt;property name=&quot;yalign&quot;&gt;0.5&lt;/property&gt;
+			      &lt;property name=&quot;xpad&quot;&gt;0&lt;/property&gt;
+			      &lt;property name=&quot;ypad&quot;&gt;0&lt;/property&gt;
+			      &lt;property name=&quot;ellipsize&quot;&gt;PANGO_ELLIPSIZE_NONE&lt;/property&gt;
+			      &lt;property name=&quot;width_chars&quot;&gt;-1&lt;/property&gt;
+			      &lt;property name=&quot;single_line_mode&quot;&gt;False&lt;/property&gt;
+			      &lt;property name=&quot;angle&quot;&gt;0&lt;/property&gt;
+			    &lt;/widget&gt;
+			    &lt;packing&gt;
+			      &lt;property name=&quot;padding&quot;&gt;0&lt;/property&gt;
+			      &lt;property name=&quot;expand&quot;&gt;False&lt;/property&gt;
+			      &lt;property name=&quot;fill&quot;&gt;False&lt;/property&gt;
+			    &lt;/packing&gt;
+			  &lt;/child&gt;
+
+			  &lt;child&gt;
+			    &lt;widget class=&quot;GtkComboBox&quot; id=&quot;operationMenu&quot;&gt;
+			      &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+			      &lt;property name=&quot;items&quot; translatable=&quot;yes&quot;&gt;&lt;/property&gt;
+			      &lt;property name=&quot;add_tearoffs&quot;&gt;False&lt;/property&gt;
+			      &lt;property name=&quot;focus_on_click&quot;&gt;True&lt;/property&gt;
+			    &lt;/widget&gt;
+			    &lt;packing&gt;
+			      &lt;property name=&quot;padding&quot;&gt;0&lt;/property&gt;
+			      &lt;property name=&quot;expand&quot;&gt;True&lt;/property&gt;
+			      &lt;property name=&quot;fill&quot;&gt;True&lt;/property&gt;
+			    &lt;/packing&gt;
+			  &lt;/child&gt;
+			&lt;/widget&gt;
+			&lt;packing&gt;
+			  &lt;property name=&quot;padding&quot;&gt;0&lt;/property&gt;
+			  &lt;property name=&quot;expand&quot;&gt;True&lt;/property&gt;
+			  &lt;property name=&quot;fill&quot;&gt;True&lt;/property&gt;
+			&lt;/packing&gt;
+		      &lt;/child&gt;
+
+		      &lt;child&gt;
+			&lt;widget class=&quot;GtkHBox&quot; id=&quot;inputTypeHbox&quot;&gt;
+			  &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+			  &lt;property name=&quot;homogeneous&quot;&gt;False&lt;/property&gt;
+			  &lt;property name=&quot;spacing&quot;&gt;0&lt;/property&gt;
+
+			  &lt;child&gt;
+			    &lt;widget class=&quot;GtkLabel&quot; id=&quot;inputTypeLabel&quot;&gt;
+			      &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+			      &lt;property name=&quot;label&quot; translatable=&quot;yes&quot;&gt;Input _Type:   &lt;/property&gt;
+			      &lt;property name=&quot;use_underline&quot;&gt;True&lt;/property&gt;
+			      &lt;property name=&quot;use_markup&quot;&gt;False&lt;/property&gt;
+			      &lt;property name=&quot;justify&quot;&gt;GTK_JUSTIFY_LEFT&lt;/property&gt;
+			      &lt;property name=&quot;wrap&quot;&gt;False&lt;/property&gt;
+			      &lt;property name=&quot;selectable&quot;&gt;False&lt;/property&gt;
+			      &lt;property name=&quot;xalign&quot;&gt;0.5&lt;/property&gt;
+			      &lt;property name=&quot;yalign&quot;&gt;0.5&lt;/property&gt;
+			      &lt;property name=&quot;xpad&quot;&gt;0&lt;/property&gt;
+			      &lt;property name=&quot;ypad&quot;&gt;0&lt;/property&gt;
+			      &lt;property name=&quot;ellipsize&quot;&gt;PANGO_ELLIPSIZE_NONE&lt;/property&gt;
+			      &lt;property name=&quot;width_chars&quot;&gt;-1&lt;/property&gt;
+			      &lt;property name=&quot;single_line_mode&quot;&gt;False&lt;/property&gt;
+			      &lt;property name=&quot;angle&quot;&gt;0&lt;/property&gt;
+			    &lt;/widget&gt;
+			    &lt;packing&gt;
+			      &lt;property name=&quot;padding&quot;&gt;0&lt;/property&gt;
+			      &lt;property name=&quot;expand&quot;&gt;False&lt;/property&gt;
+			      &lt;property name=&quot;fill&quot;&gt;False&lt;/property&gt;
+			    &lt;/packing&gt;
+			  &lt;/child&gt;
+
+			  &lt;child&gt;
+			    &lt;widget class=&quot;GtkComboBox&quot; id=&quot;inputTypeMenu&quot;&gt;
+			      &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+			      &lt;property name=&quot;items&quot; translatable=&quot;yes&quot;&gt;&lt;/property&gt;
+			      &lt;property name=&quot;add_tearoffs&quot;&gt;False&lt;/property&gt;
+			      &lt;property name=&quot;focus_on_click&quot;&gt;True&lt;/property&gt;
+			    &lt;/widget&gt;
+			    &lt;packing&gt;
+			      &lt;property name=&quot;padding&quot;&gt;0&lt;/property&gt;
+			      &lt;property name=&quot;expand&quot;&gt;True&lt;/property&gt;
+			      &lt;property name=&quot;fill&quot;&gt;True&lt;/property&gt;
+			    &lt;/packing&gt;
+			  &lt;/child&gt;
+			&lt;/widget&gt;
+			&lt;packing&gt;
+			  &lt;property name=&quot;padding&quot;&gt;0&lt;/property&gt;
+			  &lt;property name=&quot;expand&quot;&gt;True&lt;/property&gt;
+			  &lt;property name=&quot;fill&quot;&gt;True&lt;/property&gt;
+			&lt;/packing&gt;
+		      &lt;/child&gt;
+
+		      &lt;child&gt;
+			&lt;widget class=&quot;GtkHSeparator&quot; id=&quot;topSeparator&quot;&gt;
+			  &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+			&lt;/widget&gt;
+			&lt;packing&gt;
+			  &lt;property name=&quot;padding&quot;&gt;0&lt;/property&gt;
+			  &lt;property name=&quot;expand&quot;&gt;True&lt;/property&gt;
+			  &lt;property name=&quot;fill&quot;&gt;True&lt;/property&gt;
+			&lt;/packing&gt;
+		      &lt;/child&gt;
+
+		      &lt;child&gt;
+			&lt;widget class=&quot;GtkVBox&quot; id=&quot;convolutionSettingsVbox&quot;&gt;
+			  &lt;property name=&quot;homogeneous&quot;&gt;False&lt;/property&gt;
+			  &lt;property name=&quot;spacing&quot;&gt;6&lt;/property&gt;
+
+			  &lt;child&gt;
+			    &lt;widget class=&quot;GtkHBox&quot; id=&quot;convolutionInputFileHbox&quot;&gt;
+			      &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+			      &lt;property name=&quot;homogeneous&quot;&gt;False&lt;/property&gt;
+			      &lt;property name=&quot;spacing&quot;&gt;0&lt;/property&gt;
+
+			      &lt;child&gt;
+				&lt;widget class=&quot;GtkLabel&quot; id=&quot;convolutionInputFileLabel&quot;&gt;
+				  &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+				  &lt;property name=&quot;label&quot; translatable=&quot;yes&quot;&gt;Input _File (convolution kernel):   &lt;/property&gt;
+				  &lt;property name=&quot;use_underline&quot;&gt;True&lt;/property&gt;
+				  &lt;property name=&quot;use_markup&quot;&gt;False&lt;/property&gt;
+				  &lt;property name=&quot;justify&quot;&gt;GTK_JUSTIFY_LEFT&lt;/property&gt;
+				  &lt;property name=&quot;wrap&quot;&gt;False&lt;/property&gt;
+				  &lt;property name=&quot;selectable&quot;&gt;False&lt;/property&gt;
+				  &lt;property name=&quot;xalign&quot;&gt;0.5&lt;/property&gt;
+				  &lt;property name=&quot;yalign&quot;&gt;0.5&lt;/property&gt;
+				  &lt;property name=&quot;xpad&quot;&gt;0&lt;/property&gt;
+				  &lt;property name=&quot;ypad&quot;&gt;0&lt;/property&gt;
+				  &lt;property name=&quot;ellipsize&quot;&gt;PANGO_ELLIPSIZE_NONE&lt;/property&gt;
+				  &lt;property name=&quot;width_chars&quot;&gt;-1&lt;/property&gt;
+				  &lt;property name=&quot;single_line_mode&quot;&gt;False&lt;/property&gt;
+				  &lt;property name=&quot;angle&quot;&gt;0&lt;/property&gt;
+				&lt;/widget&gt;
+				&lt;packing&gt;
+				  &lt;property name=&quot;padding&quot;&gt;0&lt;/property&gt;
+				  &lt;property name=&quot;expand&quot;&gt;False&lt;/property&gt;
+				  &lt;property name=&quot;fill&quot;&gt;False&lt;/property&gt;
+				&lt;/packing&gt;
+			      &lt;/child&gt;
+
+			      &lt;child&gt;
+				&lt;widget class=&quot;GtkFileChooserButton&quot; id=&quot;convolutionInputFileChooser&quot;&gt;
+				  &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+				  &lt;property name=&quot;title&quot; translatable=&quot;yes&quot;&gt;Select Convolution Kernel File&lt;/property&gt;
+				  &lt;property name=&quot;action&quot;&gt;GTK_FILE_CHOOSER_ACTION_OPEN&lt;/property&gt;
+				  &lt;property name=&quot;local_only&quot;&gt;True&lt;/property&gt;
+				  &lt;property name=&quot;show_hidden&quot;&gt;False&lt;/property&gt;
+				  &lt;property name=&quot;do_overwrite_confirmation&quot;&gt;False&lt;/property&gt;
+				  &lt;property name=&quot;width_chars&quot;&gt;-1&lt;/property&gt;
+				&lt;/widget&gt;
+				&lt;packing&gt;
+				  &lt;property name=&quot;padding&quot;&gt;0&lt;/property&gt;
+				  &lt;property name=&quot;expand&quot;&gt;True&lt;/property&gt;
+				  &lt;property name=&quot;fill&quot;&gt;True&lt;/property&gt;
+				&lt;/packing&gt;
+			      &lt;/child&gt;
+			    &lt;/widget&gt;
+			    &lt;packing&gt;
+			      &lt;property name=&quot;padding&quot;&gt;0&lt;/property&gt;
+			      &lt;property name=&quot;expand&quot;&gt;True&lt;/property&gt;
+			      &lt;property name=&quot;fill&quot;&gt;True&lt;/property&gt;
+			    &lt;/packing&gt;
+			  &lt;/child&gt;
+			&lt;/widget&gt;
+			&lt;packing&gt;
+			  &lt;property name=&quot;padding&quot;&gt;0&lt;/property&gt;
+			  &lt;property name=&quot;expand&quot;&gt;True&lt;/property&gt;
+			  &lt;property name=&quot;fill&quot;&gt;True&lt;/property&gt;
+			&lt;/packing&gt;
+		      &lt;/child&gt;
+
+		      &lt;child&gt;
+			&lt;widget class=&quot;GtkVBox&quot; id=&quot;imageFileSettingsVbox&quot;&gt;
+			  &lt;property name=&quot;homogeneous&quot;&gt;False&lt;/property&gt;
+			  &lt;property name=&quot;spacing&quot;&gt;6&lt;/property&gt;
+
+			  &lt;child&gt;
+			    &lt;widget class=&quot;GtkHBox&quot; id=&quot;imageInputFileHbox&quot;&gt;
+			      &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+			      &lt;property name=&quot;homogeneous&quot;&gt;False&lt;/property&gt;
+			      &lt;property name=&quot;spacing&quot;&gt;0&lt;/property&gt;
+
+			      &lt;child&gt;
+				&lt;widget class=&quot;GtkLabel&quot; id=&quot;imageInputFileLabel&quot;&gt;
+				  &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+				  &lt;property name=&quot;label&quot; translatable=&quot;yes&quot;&gt;Input _File (image file):   &lt;/property&gt;
+				  &lt;property name=&quot;use_underline&quot;&gt;True&lt;/property&gt;
+				  &lt;property name=&quot;use_markup&quot;&gt;False&lt;/property&gt;
+				  &lt;property name=&quot;justify&quot;&gt;GTK_JUSTIFY_LEFT&lt;/property&gt;
+				  &lt;property name=&quot;wrap&quot;&gt;False&lt;/property&gt;
+				  &lt;property name=&quot;selectable&quot;&gt;False&lt;/property&gt;
+				  &lt;property name=&quot;xalign&quot;&gt;0.5&lt;/property&gt;
+				  &lt;property name=&quot;yalign&quot;&gt;0.5&lt;/property&gt;
+				  &lt;property name=&quot;xpad&quot;&gt;0&lt;/property&gt;
+				  &lt;property name=&quot;ypad&quot;&gt;0&lt;/property&gt;
+				  &lt;property name=&quot;ellipsize&quot;&gt;PANGO_ELLIPSIZE_NONE&lt;/property&gt;
+				  &lt;property name=&quot;width_chars&quot;&gt;-1&lt;/property&gt;
+				  &lt;property name=&quot;single_line_mode&quot;&gt;False&lt;/property&gt;
+				  &lt;property name=&quot;angle&quot;&gt;0&lt;/property&gt;
+				&lt;/widget&gt;
+				&lt;packing&gt;
+				  &lt;property name=&quot;padding&quot;&gt;0&lt;/property&gt;
+				  &lt;property name=&quot;expand&quot;&gt;False&lt;/property&gt;
+				  &lt;property name=&quot;fill&quot;&gt;False&lt;/property&gt;
+				&lt;/packing&gt;
+			      &lt;/child&gt;
+
+			      &lt;child&gt;
+				&lt;widget class=&quot;GtkFileChooserButton&quot; id=&quot;imageInputFileChooser&quot;&gt;
+				  &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+				  &lt;property name=&quot;title&quot; translatable=&quot;yes&quot;&gt;Select Convolution Kernel File&lt;/property&gt;
+				  &lt;property name=&quot;action&quot;&gt;GTK_FILE_CHOOSER_ACTION_OPEN&lt;/property&gt;
+				  &lt;property name=&quot;local_only&quot;&gt;True&lt;/property&gt;
+				  &lt;property name=&quot;show_hidden&quot;&gt;False&lt;/property&gt;
+				  &lt;property name=&quot;do_overwrite_confirmation&quot;&gt;False&lt;/property&gt;
+				  &lt;property name=&quot;width_chars&quot;&gt;-1&lt;/property&gt;
+				&lt;/widget&gt;
+				&lt;packing&gt;
+				  &lt;property name=&quot;padding&quot;&gt;0&lt;/property&gt;
+				  &lt;property name=&quot;expand&quot;&gt;True&lt;/property&gt;
+				  &lt;property name=&quot;fill&quot;&gt;True&lt;/property&gt;
+				&lt;/packing&gt;
+			      &lt;/child&gt;
+			    &lt;/widget&gt;
+			    &lt;packing&gt;
+			      &lt;property name=&quot;padding&quot;&gt;0&lt;/property&gt;
+			      &lt;property name=&quot;expand&quot;&gt;True&lt;/property&gt;
+			      &lt;property name=&quot;fill&quot;&gt;True&lt;/property&gt;
+			    &lt;/packing&gt;
+			  &lt;/child&gt;
+
+			  &lt;child&gt;
+			    &lt;widget class=&quot;GtkFrame&quot; id=&quot;imageFileScalingFrame&quot;&gt;
+			      &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+			      &lt;property name=&quot;label_xalign&quot;&gt;0&lt;/property&gt;
+			      &lt;property name=&quot;label_yalign&quot;&gt;0.5&lt;/property&gt;
+			      &lt;property name=&quot;shadow_type&quot;&gt;GTK_SHADOW_IN&lt;/property&gt;
+
+			      &lt;child&gt;
+				&lt;widget class=&quot;GtkAlignment&quot; id=&quot;imageFileScalingAlignment&quot;&gt;
+				  &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+				  &lt;property name=&quot;xalign&quot;&gt;0.5&lt;/property&gt;
+				  &lt;property name=&quot;yalign&quot;&gt;0.5&lt;/property&gt;
+				  &lt;property name=&quot;xscale&quot;&gt;1&lt;/property&gt;
+				  &lt;property name=&quot;yscale&quot;&gt;1&lt;/property&gt;
+				  &lt;property name=&quot;top_padding&quot;&gt;2&lt;/property&gt;
+				  &lt;property name=&quot;bottom_padding&quot;&gt;6&lt;/property&gt;
+				  &lt;property name=&quot;left_padding&quot;&gt;6&lt;/property&gt;
+				  &lt;property name=&quot;right_padding&quot;&gt;6&lt;/property&gt;
+
+				  &lt;child&gt;
+				    &lt;widget class=&quot;GtkVBox&quot; id=&quot;imageFileScalingVbox&quot;&gt;
+				      &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+				      &lt;property name=&quot;homogeneous&quot;&gt;False&lt;/property&gt;
+				      &lt;property name=&quot;spacing&quot;&gt;6&lt;/property&gt;
+
+				      &lt;child&gt;
+					&lt;widget class=&quot;GtkHBox&quot; id=&quot;imageFileScalingAddHbox&quot;&gt;
+					  &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+					  &lt;property name=&quot;homogeneous&quot;&gt;False&lt;/property&gt;
+					  &lt;property name=&quot;spacing&quot;&gt;0&lt;/property&gt;
+
+					  &lt;child&gt;
+					    &lt;widget class=&quot;GtkLabel&quot; id=&quot;imageFileScalingAddLabel&quot;&gt;
+					      &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+					      &lt;property name=&quot;label&quot; translatable=&quot;yes&quot;&gt;First, _add to each float pixel value:   &lt;/property&gt;
+					      &lt;property name=&quot;use_underline&quot;&gt;True&lt;/property&gt;
+					      &lt;property name=&quot;use_markup&quot;&gt;False&lt;/property&gt;
+					      &lt;property name=&quot;justify&quot;&gt;GTK_JUSTIFY_LEFT&lt;/property&gt;
+					      &lt;property name=&quot;wrap&quot;&gt;False&lt;/property&gt;
+					      &lt;property name=&quot;selectable&quot;&gt;False&lt;/property&gt;
+					      &lt;property name=&quot;xalign&quot;&gt;0.5&lt;/property&gt;
+					      &lt;property name=&quot;yalign&quot;&gt;0.5&lt;/property&gt;
+					      &lt;property name=&quot;xpad&quot;&gt;0&lt;/property&gt;
+					      &lt;property name=&quot;ypad&quot;&gt;0&lt;/property&gt;
+					      &lt;property name=&quot;mnemonic_widget&quot;&gt;imageFileScalingAddSpinButton&lt;/property&gt;
+					      &lt;property name=&quot;ellipsize&quot;&gt;PANGO_ELLIPSIZE_NONE&lt;/property&gt;
+					      &lt;property name=&quot;width_chars&quot;&gt;-1&lt;/property&gt;
+					      &lt;property name=&quot;single_line_mode&quot;&gt;False&lt;/property&gt;
+					      &lt;property name=&quot;angle&quot;&gt;0&lt;/property&gt;
+					    &lt;/widget&gt;
+					    &lt;packing&gt;
+					      &lt;property name=&quot;padding&quot;&gt;0&lt;/property&gt;
+					      &lt;property name=&quot;expand&quot;&gt;False&lt;/property&gt;
+					      &lt;property name=&quot;fill&quot;&gt;False&lt;/property&gt;
+					    &lt;/packing&gt;
+					  &lt;/child&gt;
+
+					  &lt;child&gt;
+					    &lt;widget class=&quot;GtkSpinButton&quot; id=&quot;imageFileScalingAddSpinButton&quot;&gt;
+					      &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+					      &lt;property name=&quot;can_focus&quot;&gt;True&lt;/property&gt;
+					      &lt;property name=&quot;climb_rate&quot;&gt;1&lt;/property&gt;
+					      &lt;property name=&quot;digits&quot;&gt;5&lt;/property&gt;
+					      &lt;property name=&quot;numeric&quot;&gt;True&lt;/property&gt;
+					      &lt;property name=&quot;update_policy&quot;&gt;GTK_UPDATE_ALWAYS&lt;/property&gt;
+					      &lt;property name=&quot;snap_to_ticks&quot;&gt;False&lt;/property&gt;
+					      &lt;property name=&quot;wrap&quot;&gt;False&lt;/property&gt;
+					      &lt;property name=&quot;adjustment&quot;&gt;0 -99999 99999 0.10000000149 1 0&lt;/property&gt;
+					    &lt;/widget&gt;
+					    &lt;packing&gt;
+					      &lt;property name=&quot;padding&quot;&gt;0&lt;/property&gt;
+					      &lt;property name=&quot;expand&quot;&gt;True&lt;/property&gt;
+					      &lt;property name=&quot;fill&quot;&gt;True&lt;/property&gt;
+					    &lt;/packing&gt;
+					  &lt;/child&gt;
+					&lt;/widget&gt;
+					&lt;packing&gt;
+					  &lt;property name=&quot;padding&quot;&gt;0&lt;/property&gt;
+					  &lt;property name=&quot;expand&quot;&gt;True&lt;/property&gt;
+					  &lt;property name=&quot;fill&quot;&gt;True&lt;/property&gt;
+					&lt;/packing&gt;
+				      &lt;/child&gt;
+
+				      &lt;child&gt;
+					&lt;widget class=&quot;GtkHBox&quot; id=&quot;imageFileScalingMultHbox&quot;&gt;
+					  &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+					  &lt;property name=&quot;homogeneous&quot;&gt;False&lt;/property&gt;
+					  &lt;property name=&quot;spacing&quot;&gt;0&lt;/property&gt;
+
+					  &lt;child&gt;
+					    &lt;widget class=&quot;GtkLabel&quot; id=&quot;imageFileScalingMultLabel&quot;&gt;
+					      &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+					      &lt;property name=&quot;label&quot; translatable=&quot;yes&quot;&gt;Then, _multiply each float pixel value by:   &lt;/property&gt;
+					      &lt;property name=&quot;use_underline&quot;&gt;True&lt;/property&gt;
+					      &lt;property name=&quot;use_markup&quot;&gt;False&lt;/property&gt;
+					      &lt;property name=&quot;justify&quot;&gt;GTK_JUSTIFY_LEFT&lt;/property&gt;
+					      &lt;property name=&quot;wrap&quot;&gt;False&lt;/property&gt;
+					      &lt;property name=&quot;selectable&quot;&gt;False&lt;/property&gt;
+					      &lt;property name=&quot;xalign&quot;&gt;0.5&lt;/property&gt;
+					      &lt;property name=&quot;yalign&quot;&gt;0.5&lt;/property&gt;
+					      &lt;property name=&quot;xpad&quot;&gt;0&lt;/property&gt;
+					      &lt;property name=&quot;ypad&quot;&gt;0&lt;/property&gt;
+					      &lt;property name=&quot;mnemonic_widget&quot;&gt;imageFileScalingMultSpinButton&lt;/property&gt;
+					      &lt;property name=&quot;ellipsize&quot;&gt;PANGO_ELLIPSIZE_NONE&lt;/property&gt;
+					      &lt;property name=&quot;width_chars&quot;&gt;-1&lt;/property&gt;
+					      &lt;property name=&quot;single_line_mode&quot;&gt;False&lt;/property&gt;
+					      &lt;property name=&quot;angle&quot;&gt;0&lt;/property&gt;
+					    &lt;/widget&gt;
+					    &lt;packing&gt;
+					      &lt;property name=&quot;padding&quot;&gt;0&lt;/property&gt;
+					      &lt;property name=&quot;expand&quot;&gt;False&lt;/property&gt;
+					      &lt;property name=&quot;fill&quot;&gt;False&lt;/property&gt;
+					    &lt;/packing&gt;
+					  &lt;/child&gt;
+
+					  &lt;child&gt;
+					    &lt;widget class=&quot;GtkSpinButton&quot; id=&quot;imageFileScalingMultSpinButton&quot;&gt;
+					      &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+					      &lt;property name=&quot;can_focus&quot;&gt;True&lt;/property&gt;
+					      &lt;property name=&quot;climb_rate&quot;&gt;1&lt;/property&gt;
+					      &lt;property name=&quot;digits&quot;&gt;5&lt;/property&gt;
+					      &lt;property name=&quot;numeric&quot;&gt;True&lt;/property&gt;
+					      &lt;property name=&quot;update_policy&quot;&gt;GTK_UPDATE_ALWAYS&lt;/property&gt;
+					      &lt;property name=&quot;snap_to_ticks&quot;&gt;False&lt;/property&gt;
+					      &lt;property name=&quot;wrap&quot;&gt;False&lt;/property&gt;
+					      &lt;property name=&quot;adjustment&quot;&gt;1 -99999 99999 0.0010000000475 0.0010000000475 0&lt;/property&gt;
+					    &lt;/widget&gt;
+					    &lt;packing&gt;
+					      &lt;property name=&quot;padding&quot;&gt;0&lt;/property&gt;
+					      &lt;property name=&quot;expand&quot;&gt;True&lt;/property&gt;
+					      &lt;property name=&quot;fill&quot;&gt;True&lt;/property&gt;
+					    &lt;/packing&gt;
+					  &lt;/child&gt;
+					&lt;/widget&gt;
+					&lt;packing&gt;
+					  &lt;property name=&quot;padding&quot;&gt;0&lt;/property&gt;
+					  &lt;property name=&quot;expand&quot;&gt;True&lt;/property&gt;
+					  &lt;property name=&quot;fill&quot;&gt;True&lt;/property&gt;
+					&lt;/packing&gt;
+				      &lt;/child&gt;
+
+				      &lt;child&gt;
+					&lt;widget class=&quot;GtkVBox&quot; id=&quot;imageFileScalingMinVbox&quot;&gt;
+					  &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+					  &lt;property name=&quot;homogeneous&quot;&gt;False&lt;/property&gt;
+					  &lt;property name=&quot;spacing&quot;&gt;0&lt;/property&gt;
+
+					  &lt;child&gt;
+					    &lt;widget class=&quot;GtkLabel&quot; id=&quot;imageFileScalingMinLabel&quot;&gt;
+					      &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+					      &lt;property name=&quot;label&quot; translatable=&quot;yes&quot;&gt;Mi_nimum loaded pixel value (will be scaled to 0):&lt;/property&gt;
+					      &lt;property name=&quot;use_underline&quot;&gt;True&lt;/property&gt;
+					      &lt;property name=&quot;use_markup&quot;&gt;False&lt;/property&gt;
+					      &lt;property name=&quot;justify&quot;&gt;GTK_JUSTIFY_LEFT&lt;/property&gt;
+					      &lt;property name=&quot;wrap&quot;&gt;False&lt;/property&gt;
+					      &lt;property name=&quot;selectable&quot;&gt;False&lt;/property&gt;
+					      &lt;property name=&quot;xalign&quot;&gt;0&lt;/property&gt;
+					      &lt;property name=&quot;yalign&quot;&gt;0.5&lt;/property&gt;
+					      &lt;property name=&quot;xpad&quot;&gt;0&lt;/property&gt;
+					      &lt;property name=&quot;ypad&quot;&gt;0&lt;/property&gt;
+					      &lt;property name=&quot;ellipsize&quot;&gt;PANGO_ELLIPSIZE_NONE&lt;/property&gt;
+					      &lt;property name=&quot;width_chars&quot;&gt;-1&lt;/property&gt;
+					      &lt;property name=&quot;single_line_mode&quot;&gt;False&lt;/property&gt;
+					      &lt;property name=&quot;angle&quot;&gt;0&lt;/property&gt;
+					    &lt;/widget&gt;
+					    &lt;packing&gt;
+					      &lt;property name=&quot;padding&quot;&gt;0&lt;/property&gt;
+					      &lt;property name=&quot;expand&quot;&gt;False&lt;/property&gt;
+					      &lt;property name=&quot;fill&quot;&gt;False&lt;/property&gt;
+					    &lt;/packing&gt;
+					  &lt;/child&gt;
+
+					  &lt;child&gt;
+					    &lt;widget class=&quot;GtkHBox&quot; id=&quot;imageFileScalingMinHbox&quot;&gt;
+					      &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+					      &lt;property name=&quot;homogeneous&quot;&gt;False&lt;/property&gt;
+					      &lt;property name=&quot;spacing&quot;&gt;5&lt;/property&gt;
+
+					      &lt;child&gt;
+						&lt;widget class=&quot;GtkHScale&quot; id=&quot;imageFileScalingMinSlider&quot;&gt;
+						  &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+						  &lt;property name=&quot;can_focus&quot;&gt;True&lt;/property&gt;
+						  &lt;property name=&quot;draw_value&quot;&gt;False&lt;/property&gt;
+						  &lt;property name=&quot;value_pos&quot;&gt;GTK_POS_LEFT&lt;/property&gt;
+						  &lt;property name=&quot;digits&quot;&gt;0&lt;/property&gt;
+						  &lt;property name=&quot;update_policy&quot;&gt;GTK_UPDATE_CONTINUOUS&lt;/property&gt;
+						  &lt;property name=&quot;inverted&quot;&gt;False&lt;/property&gt;
+						  &lt;property name=&quot;adjustment&quot;&gt;0 -1024 1024 1 1 0&lt;/property&gt;
+						&lt;/widget&gt;
+						&lt;packing&gt;
+						  &lt;property name=&quot;padding&quot;&gt;0&lt;/property&gt;
+						  &lt;property name=&quot;expand&quot;&gt;True&lt;/property&gt;
+						  &lt;property name=&quot;fill&quot;&gt;True&lt;/property&gt;
+						&lt;/packing&gt;
+					      &lt;/child&gt;
+
+					      &lt;child&gt;
+						&lt;widget class=&quot;GtkSpinButton&quot; id=&quot;imageFileScalingMinSpinner&quot;&gt;
+						  &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+						  &lt;property name=&quot;can_focus&quot;&gt;True&lt;/property&gt;
+						  &lt;property name=&quot;climb_rate&quot;&gt;1&lt;/property&gt;
+						  &lt;property name=&quot;digits&quot;&gt;1&lt;/property&gt;
+						  &lt;property name=&quot;numeric&quot;&gt;True&lt;/property&gt;
+						  &lt;property name=&quot;update_policy&quot;&gt;GTK_UPDATE_ALWAYS&lt;/property&gt;
+						  &lt;property name=&quot;snap_to_ticks&quot;&gt;False&lt;/property&gt;
+						  &lt;property name=&quot;wrap&quot;&gt;False&lt;/property&gt;
+						  &lt;property name=&quot;adjustment&quot;&gt;0 -1024 1024 1 2 0&lt;/property&gt;
+						&lt;/widget&gt;
+						&lt;packing&gt;
+						  &lt;property name=&quot;padding&quot;&gt;0&lt;/property&gt;
+						  &lt;property name=&quot;expand&quot;&gt;False&lt;/property&gt;
+						  &lt;property name=&quot;fill&quot;&gt;True&lt;/property&gt;
+						&lt;/packing&gt;
+					      &lt;/child&gt;
+					    &lt;/widget&gt;
+					    &lt;packing&gt;
+					      &lt;property name=&quot;padding&quot;&gt;0&lt;/property&gt;
+					      &lt;property name=&quot;expand&quot;&gt;True&lt;/property&gt;
+					      &lt;property name=&quot;fill&quot;&gt;True&lt;/property&gt;
+					    &lt;/packing&gt;
+					  &lt;/child&gt;
+					&lt;/widget&gt;
+					&lt;packing&gt;
+					  &lt;property name=&quot;padding&quot;&gt;0&lt;/property&gt;
+					  &lt;property name=&quot;expand&quot;&gt;True&lt;/property&gt;
+					  &lt;property name=&quot;fill&quot;&gt;True&lt;/property&gt;
+					&lt;/packing&gt;
+				      &lt;/child&gt;
+
+				      &lt;child&gt;
+					&lt;widget class=&quot;GtkVBox&quot; id=&quot;imageFileScalingMaxVbox&quot;&gt;
+					  &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+					  &lt;property name=&quot;homogeneous&quot;&gt;False&lt;/property&gt;
+					  &lt;property name=&quot;spacing&quot;&gt;0&lt;/property&gt;
+
+					  &lt;child&gt;
+					    &lt;widget class=&quot;GtkLabel&quot; id=&quot;imageFileScalingMaxLabel&quot;&gt;
+					      &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+					      &lt;property name=&quot;label&quot; translatable=&quot;yes&quot;&gt;Ma_ximum loaded pixel value (will be scaled to 255):&lt;/property&gt;
+					      &lt;property name=&quot;use_underline&quot;&gt;True&lt;/property&gt;
+					      &lt;property name=&quot;use_markup&quot;&gt;False&lt;/property&gt;
+					      &lt;property name=&quot;justify&quot;&gt;GTK_JUSTIFY_LEFT&lt;/property&gt;
+					      &lt;property name=&quot;wrap&quot;&gt;False&lt;/property&gt;
+					      &lt;property name=&quot;selectable&quot;&gt;False&lt;/property&gt;
+					      &lt;property name=&quot;xalign&quot;&gt;0&lt;/property&gt;
+					      &lt;property name=&quot;yalign&quot;&gt;0.5&lt;/property&gt;
+					      &lt;property name=&quot;xpad&quot;&gt;0&lt;/property&gt;
+					      &lt;property name=&quot;ypad&quot;&gt;0&lt;/property&gt;
+					      &lt;property name=&quot;ellipsize&quot;&gt;PANGO_ELLIPSIZE_NONE&lt;/property&gt;
+					      &lt;property name=&quot;width_chars&quot;&gt;-1&lt;/property&gt;
+					      &lt;property name=&quot;single_line_mode&quot;&gt;False&lt;/property&gt;
+					      &lt;property name=&quot;angle&quot;&gt;0&lt;/property&gt;
+					    &lt;/widget&gt;
+					    &lt;packing&gt;
+					      &lt;property name=&quot;padding&quot;&gt;0&lt;/property&gt;
+					      &lt;property name=&quot;expand&quot;&gt;False&lt;/property&gt;
+					      &lt;property name=&quot;fill&quot;&gt;False&lt;/property&gt;
+					    &lt;/packing&gt;
+					  &lt;/child&gt;
+
+					  &lt;child&gt;
+					    &lt;widget class=&quot;GtkHBox&quot; id=&quot;imageFileScalingMaxHbox&quot;&gt;
+					      &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+					      &lt;property name=&quot;homogeneous&quot;&gt;False&lt;/property&gt;
+					      &lt;property name=&quot;spacing&quot;&gt;5&lt;/property&gt;
+
+					      &lt;child&gt;
+						&lt;widget class=&quot;GtkHScale&quot; id=&quot;imageFileScalingMaxSlider&quot;&gt;
+						  &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+						  &lt;property name=&quot;can_focus&quot;&gt;True&lt;/property&gt;
+						  &lt;property name=&quot;draw_value&quot;&gt;False&lt;/property&gt;
+						  &lt;property name=&quot;value_pos&quot;&gt;GTK_POS_LEFT&lt;/property&gt;
+						  &lt;property name=&quot;digits&quot;&gt;0&lt;/property&gt;
+						  &lt;property name=&quot;update_policy&quot;&gt;GTK_UPDATE_CONTINUOUS&lt;/property&gt;
+						  &lt;property name=&quot;inverted&quot;&gt;False&lt;/property&gt;
+						  &lt;property name=&quot;adjustment&quot;&gt;255 -1024 1024 1 1 0&lt;/property&gt;
+						&lt;/widget&gt;
+						&lt;packing&gt;
+						  &lt;property name=&quot;padding&quot;&gt;0&lt;/property&gt;
+						  &lt;property name=&quot;expand&quot;&gt;True&lt;/property&gt;
+						  &lt;property name=&quot;fill&quot;&gt;True&lt;/property&gt;
+						&lt;/packing&gt;
+					      &lt;/child&gt;
+
+					      &lt;child&gt;
+						&lt;widget class=&quot;GtkSpinButton&quot; id=&quot;imageFileScalingMaxSpinner&quot;&gt;
+						  &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+						  &lt;property name=&quot;can_focus&quot;&gt;True&lt;/property&gt;
+						  &lt;property name=&quot;climb_rate&quot;&gt;1&lt;/property&gt;
+						  &lt;property name=&quot;digits&quot;&gt;1&lt;/property&gt;
+						  &lt;property name=&quot;numeric&quot;&gt;True&lt;/property&gt;
+						  &lt;property name=&quot;update_policy&quot;&gt;GTK_UPDATE_ALWAYS&lt;/property&gt;
+						  &lt;property name=&quot;snap_to_ticks&quot;&gt;False&lt;/property&gt;
+						  &lt;property name=&quot;wrap&quot;&gt;False&lt;/property&gt;
+						  &lt;property name=&quot;adjustment&quot;&gt;255 -1024 1024 1 2 0&lt;/property&gt;
+						&lt;/widget&gt;
+						&lt;packing&gt;
+						  &lt;property name=&quot;padding&quot;&gt;0&lt;/property&gt;
+						  &lt;property name=&quot;expand&quot;&gt;False&lt;/property&gt;
+						  &lt;property name=&quot;fill&quot;&gt;True&lt;/property&gt;
+						&lt;/packing&gt;
+					      &lt;/child&gt;
+					    &lt;/widget&gt;
+					    &lt;packing&gt;
+					      &lt;property name=&quot;padding&quot;&gt;0&lt;/property&gt;
+					      &lt;property name=&quot;expand&quot;&gt;True&lt;/property&gt;
+					      &lt;property name=&quot;fill&quot;&gt;True&lt;/property&gt;
+					    &lt;/packing&gt;
+					  &lt;/child&gt;
+					&lt;/widget&gt;
+					&lt;packing&gt;
+					  &lt;property name=&quot;padding&quot;&gt;0&lt;/property&gt;
+					  &lt;property name=&quot;expand&quot;&gt;True&lt;/property&gt;
+					  &lt;property name=&quot;fill&quot;&gt;True&lt;/property&gt;
+					&lt;/packing&gt;
+				      &lt;/child&gt;
+				    &lt;/widget&gt;
+				  &lt;/child&gt;
+				&lt;/widget&gt;
+			      &lt;/child&gt;
+
+			      &lt;child&gt;
+				&lt;widget class=&quot;GtkLabel&quot; id=&quot;imageFileScalingFrameLabel&quot;&gt;
+				  &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+				  &lt;property name=&quot;label&quot; translatable=&quot;yes&quot;&gt;Pixel Value Scaling as Image File is Loaded&lt;/property&gt;
+				  &lt;property name=&quot;use_underline&quot;&gt;False&lt;/property&gt;
+				  &lt;property name=&quot;use_markup&quot;&gt;True&lt;/property&gt;
+				  &lt;property name=&quot;justify&quot;&gt;GTK_JUSTIFY_LEFT&lt;/property&gt;
+				  &lt;property name=&quot;wrap&quot;&gt;False&lt;/property&gt;
+				  &lt;property name=&quot;selectable&quot;&gt;False&lt;/property&gt;
+				  &lt;property name=&quot;xalign&quot;&gt;0.5&lt;/property&gt;
+				  &lt;property name=&quot;yalign&quot;&gt;0.5&lt;/property&gt;
+				  &lt;property name=&quot;xpad&quot;&gt;0&lt;/property&gt;
+				  &lt;property name=&quot;ypad&quot;&gt;0&lt;/property&gt;
+				  &lt;property name=&quot;ellipsize&quot;&gt;PANGO_ELLIPSIZE_NONE&lt;/property&gt;
+				  &lt;property name=&quot;width_chars&quot;&gt;-1&lt;/property&gt;
+				  &lt;property name=&quot;single_line_mode&quot;&gt;False&lt;/property&gt;
+				  &lt;property name=&quot;angle&quot;&gt;0&lt;/property&gt;
+				&lt;/widget&gt;
+				&lt;packing&gt;
+				  &lt;property name=&quot;type&quot;&gt;label_item&lt;/property&gt;
+				&lt;/packing&gt;
+			      &lt;/child&gt;
+			    &lt;/widget&gt;
+			    &lt;packing&gt;
+			      &lt;property name=&quot;padding&quot;&gt;0&lt;/property&gt;
+			      &lt;property name=&quot;expand&quot;&gt;True&lt;/property&gt;
+			      &lt;property name=&quot;fill&quot;&gt;True&lt;/property&gt;
+			    &lt;/packing&gt;
+			  &lt;/child&gt;
+			&lt;/widget&gt;
+			&lt;packing&gt;
+			  &lt;property name=&quot;padding&quot;&gt;0&lt;/property&gt;
+			  &lt;property name=&quot;expand&quot;&gt;True&lt;/property&gt;
+			  &lt;property name=&quot;fill&quot;&gt;True&lt;/property&gt;
+			&lt;/packing&gt;
+		      &lt;/child&gt;
+
+		      &lt;child&gt;
+			&lt;widget class=&quot;GtkVBox&quot; id=&quot;constantSettingsVbox&quot;&gt;
+			  &lt;property name=&quot;homogeneous&quot;&gt;False&lt;/property&gt;
+			  &lt;property name=&quot;spacing&quot;&gt;6&lt;/property&gt;
+
+			  &lt;child&gt;
+			    &lt;widget class=&quot;GtkHBox&quot; id=&quot;constantValueHbox&quot;&gt;
+			      &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+			      &lt;property name=&quot;homogeneous&quot;&gt;False&lt;/property&gt;
+			      &lt;property name=&quot;spacing&quot;&gt;0&lt;/property&gt;
+
+			      &lt;child&gt;
+				&lt;widget class=&quot;GtkLabel&quot; id=&quot;constantValueLabel&quot;&gt;
+				  &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+				  &lt;property name=&quot;label&quot; translatable=&quot;yes&quot;&gt;Input _Constant:      &lt;/property&gt;
+				  &lt;property name=&quot;use_underline&quot;&gt;True&lt;/property&gt;
+				  &lt;property name=&quot;use_markup&quot;&gt;False&lt;/property&gt;
+				  &lt;property name=&quot;justify&quot;&gt;GTK_JUSTIFY_LEFT&lt;/property&gt;
+				  &lt;property name=&quot;wrap&quot;&gt;False&lt;/property&gt;
+				  &lt;property name=&quot;selectable&quot;&gt;False&lt;/property&gt;
+				  &lt;property name=&quot;xalign&quot;&gt;0.5&lt;/property&gt;
+				  &lt;property name=&quot;yalign&quot;&gt;0.5&lt;/property&gt;
+				  &lt;property name=&quot;xpad&quot;&gt;0&lt;/property&gt;
+				  &lt;property name=&quot;ypad&quot;&gt;0&lt;/property&gt;
+				  &lt;property name=&quot;mnemonic_widget&quot;&gt;constantValueSpinButton&lt;/property&gt;
+				  &lt;property name=&quot;ellipsize&quot;&gt;PANGO_ELLIPSIZE_NONE&lt;/property&gt;
+				  &lt;property name=&quot;width_chars&quot;&gt;-1&lt;/property&gt;
+				  &lt;property name=&quot;single_line_mode&quot;&gt;False&lt;/property&gt;
+				  &lt;property name=&quot;angle&quot;&gt;0&lt;/property&gt;
+				&lt;/widget&gt;
+				&lt;packing&gt;
+				  &lt;property name=&quot;padding&quot;&gt;0&lt;/property&gt;
+				  &lt;property name=&quot;expand&quot;&gt;False&lt;/property&gt;
+				  &lt;property name=&quot;fill&quot;&gt;False&lt;/property&gt;
+				&lt;/packing&gt;
+			      &lt;/child&gt;
+
+			      &lt;child&gt;
+				&lt;widget class=&quot;GtkSpinButton&quot; id=&quot;constantValueSpinButton&quot;&gt;
+				  &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+				  &lt;property name=&quot;can_focus&quot;&gt;True&lt;/property&gt;
+				  &lt;property name=&quot;climb_rate&quot;&gt;1&lt;/property&gt;
+				  &lt;property name=&quot;digits&quot;&gt;3&lt;/property&gt;
+				  &lt;property name=&quot;numeric&quot;&gt;True&lt;/property&gt;
+				  &lt;property name=&quot;update_policy&quot;&gt;GTK_UPDATE_ALWAYS&lt;/property&gt;
+				  &lt;property name=&quot;snap_to_ticks&quot;&gt;False&lt;/property&gt;
+				  &lt;property name=&quot;wrap&quot;&gt;False&lt;/property&gt;
+				  &lt;property name=&quot;adjustment&quot;&gt;0 -99999 99999 0.10000000149 1 0&lt;/property&gt;
+				&lt;/widget&gt;
+				&lt;packing&gt;
+				  &lt;property name=&quot;padding&quot;&gt;0&lt;/property&gt;
+				  &lt;property name=&quot;expand&quot;&gt;True&lt;/property&gt;
+				  &lt;property name=&quot;fill&quot;&gt;True&lt;/property&gt;
+				&lt;/packing&gt;
+			      &lt;/child&gt;
+			    &lt;/widget&gt;
+			    &lt;packing&gt;
+			      &lt;property name=&quot;padding&quot;&gt;0&lt;/property&gt;
+			      &lt;property name=&quot;expand&quot;&gt;True&lt;/property&gt;
+			      &lt;property name=&quot;fill&quot;&gt;True&lt;/property&gt;
+			    &lt;/packing&gt;
+			  &lt;/child&gt;
+			&lt;/widget&gt;
+			&lt;packing&gt;
+			  &lt;property name=&quot;padding&quot;&gt;0&lt;/property&gt;
+			  &lt;property name=&quot;expand&quot;&gt;True&lt;/property&gt;
+			  &lt;property name=&quot;fill&quot;&gt;True&lt;/property&gt;
+			&lt;/packing&gt;
+		      &lt;/child&gt;
+
+		      &lt;child&gt;
+			&lt;widget class=&quot;GtkVBox&quot; id=&quot;rollingAvgSettingsVbox&quot;&gt;
+			  &lt;property name=&quot;homogeneous&quot;&gt;False&lt;/property&gt;
+			  &lt;property name=&quot;spacing&quot;&gt;6&lt;/property&gt;
+
+			  &lt;child&gt;
+			    &lt;widget class=&quot;GtkHBox&quot; id=&quot;rollingAvgAlphaHbox&quot;&gt;
+			      &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+			      &lt;property name=&quot;homogeneous&quot;&gt;False&lt;/property&gt;
+			      &lt;property name=&quot;spacing&quot;&gt;0&lt;/property&gt;
+
+			      &lt;child&gt;
+				&lt;widget class=&quot;GtkLabel&quot; id=&quot;rollingAvgAlphaLabel&quot;&gt;
+				  &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+				  &lt;property name=&quot;label&quot; translatable=&quot;yes&quot;&gt;Memory constant _alpha:   &lt;/property&gt;
+				  &lt;property name=&quot;use_underline&quot;&gt;True&lt;/property&gt;
+				  &lt;property name=&quot;use_markup&quot;&gt;False&lt;/property&gt;
+				  &lt;property name=&quot;justify&quot;&gt;GTK_JUSTIFY_LEFT&lt;/property&gt;
+				  &lt;property name=&quot;wrap&quot;&gt;False&lt;/property&gt;
+				  &lt;property name=&quot;selectable&quot;&gt;False&lt;/property&gt;
+				  &lt;property name=&quot;xalign&quot;&gt;0.5&lt;/property&gt;
+				  &lt;property name=&quot;yalign&quot;&gt;0.5&lt;/property&gt;
+				  &lt;property name=&quot;xpad&quot;&gt;0&lt;/property&gt;
+				  &lt;property name=&quot;ypad&quot;&gt;0&lt;/property&gt;
+				  &lt;property name=&quot;mnemonic_widget&quot;&gt;rollingAvgAlphaSpinButton&lt;/property&gt;
+				  &lt;property name=&quot;ellipsize&quot;&gt;PANGO_ELLIPSIZE_NONE&lt;/property&gt;
+				  &lt;property name=&quot;width_chars&quot;&gt;-1&lt;/property&gt;
+				  &lt;property name=&quot;single_line_mode&quot;&gt;False&lt;/property&gt;
+				  &lt;property name=&quot;angle&quot;&gt;0&lt;/property&gt;
+				&lt;/widget&gt;
+				&lt;packing&gt;
+				  &lt;property name=&quot;padding&quot;&gt;0&lt;/property&gt;
+				  &lt;property name=&quot;expand&quot;&gt;False&lt;/property&gt;
+				  &lt;property name=&quot;fill&quot;&gt;True&lt;/property&gt;
+				&lt;/packing&gt;
+			      &lt;/child&gt;
+
+			      &lt;child&gt;
+				&lt;widget class=&quot;GtkSpinButton&quot; id=&quot;rollingAvgAlphaSpinButton&quot;&gt;
+				  &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+				  &lt;property name=&quot;can_focus&quot;&gt;True&lt;/property&gt;
+				  &lt;property name=&quot;climb_rate&quot;&gt;1&lt;/property&gt;
+				  &lt;property name=&quot;digits&quot;&gt;5&lt;/property&gt;
+				  &lt;property name=&quot;numeric&quot;&gt;True&lt;/property&gt;
+				  &lt;property name=&quot;update_policy&quot;&gt;GTK_UPDATE_ALWAYS&lt;/property&gt;
+				  &lt;property name=&quot;snap_to_ticks&quot;&gt;False&lt;/property&gt;
+				  &lt;property name=&quot;wrap&quot;&gt;False&lt;/property&gt;
+				  &lt;property name=&quot;adjustment&quot;&gt;0.00999999977648 9.99999996004e-12 999 0.0010000000475 0.0010000000475 0&lt;/property&gt;
+				&lt;/widget&gt;
+				&lt;packing&gt;
+				  &lt;property name=&quot;padding&quot;&gt;0&lt;/property&gt;
+				  &lt;property name=&quot;expand&quot;&gt;False&lt;/property&gt;
+				  &lt;property name=&quot;fill&quot;&gt;True&lt;/property&gt;
+				&lt;/packing&gt;
+			      &lt;/child&gt;
+
+			      &lt;child&gt;
+				&lt;widget class=&quot;GtkLabel&quot; id=&quot;rollingAvgAlphaEqualsLabel&quot;&gt;
+				  &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+				  &lt;property name=&quot;label&quot; translatable=&quot;yes&quot;&gt; = 1 / &lt;/property&gt;
+				  &lt;property name=&quot;use_underline&quot;&gt;False&lt;/property&gt;
+				  &lt;property name=&quot;use_markup&quot;&gt;False&lt;/property&gt;
+				  &lt;property name=&quot;justify&quot;&gt;GTK_JUSTIFY_LEFT&lt;/property&gt;
+				  &lt;property name=&quot;wrap&quot;&gt;False&lt;/property&gt;
+				  &lt;property name=&quot;selectable&quot;&gt;False&lt;/property&gt;
+				  &lt;property name=&quot;xalign&quot;&gt;0.5&lt;/property&gt;
+				  &lt;property name=&quot;yalign&quot;&gt;0.5&lt;/property&gt;
+				  &lt;property name=&quot;xpad&quot;&gt;0&lt;/property&gt;
+				  &lt;property name=&quot;ypad&quot;&gt;0&lt;/property&gt;
+				  &lt;property name=&quot;ellipsize&quot;&gt;PANGO_ELLIPSIZE_NONE&lt;/property&gt;
+				  &lt;property name=&quot;width_chars&quot;&gt;-1&lt;/property&gt;
+				  &lt;property name=&quot;single_line_mode&quot;&gt;False&lt;/property&gt;
+				  &lt;property name=&quot;angle&quot;&gt;0&lt;/property&gt;
+				&lt;/widget&gt;
+				&lt;packing&gt;
+				  &lt;property name=&quot;padding&quot;&gt;0&lt;/property&gt;
+				  &lt;property name=&quot;expand&quot;&gt;False&lt;/property&gt;
+				  &lt;property name=&quot;fill&quot;&gt;False&lt;/property&gt;
+				&lt;/packing&gt;
+			      &lt;/child&gt;
+
+			      &lt;child&gt;
+				&lt;widget class=&quot;GtkSpinButton&quot; id=&quot;rollingAvgAlphaDenomSpinButton&quot;&gt;
+				  &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+				  &lt;property name=&quot;can_focus&quot;&gt;True&lt;/property&gt;
+				  &lt;property name=&quot;climb_rate&quot;&gt;1&lt;/property&gt;
+				  &lt;property name=&quot;digits&quot;&gt;4&lt;/property&gt;
+				  &lt;property name=&quot;numeric&quot;&gt;True&lt;/property&gt;
+				  &lt;property name=&quot;update_policy&quot;&gt;GTK_UPDATE_ALWAYS&lt;/property&gt;
+				  &lt;property name=&quot;snap_to_ticks&quot;&gt;False&lt;/property&gt;
+				  &lt;property name=&quot;wrap&quot;&gt;False&lt;/property&gt;
+				  &lt;property name=&quot;adjustment&quot;&gt;100 0.0010000000475 99999 1 1 0&lt;/property&gt;
+				&lt;/widget&gt;
+				&lt;packing&gt;
+				  &lt;property name=&quot;padding&quot;&gt;0&lt;/property&gt;
+				  &lt;property name=&quot;expand&quot;&gt;False&lt;/property&gt;
+				  &lt;property name=&quot;fill&quot;&gt;True&lt;/property&gt;
+				&lt;/packing&gt;
+			      &lt;/child&gt;
+			    &lt;/widget&gt;
+			    &lt;packing&gt;
+			      &lt;property name=&quot;padding&quot;&gt;0&lt;/property&gt;
+			      &lt;property name=&quot;expand&quot;&gt;True&lt;/property&gt;
+			      &lt;property name=&quot;fill&quot;&gt;True&lt;/property&gt;
+			    &lt;/packing&gt;
+			  &lt;/child&gt;
+
+			  &lt;child&gt;
+			    &lt;widget class=&quot;GtkVBox&quot; id=&quot;rollingAvgInitVbox&quot;&gt;
+			      &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+			      &lt;property name=&quot;homogeneous&quot;&gt;False&lt;/property&gt;
+			      &lt;property name=&quot;spacing&quot;&gt;0&lt;/property&gt;
+
+			      &lt;child&gt;
+				&lt;widget class=&quot;GtkHBox&quot; id=&quot;rollingAvgInitHbox1&quot;&gt;
+				  &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+				  &lt;property name=&quot;homogeneous&quot;&gt;False&lt;/property&gt;
+				  &lt;property name=&quot;spacing&quot;&gt;0&lt;/property&gt;
+
+				  &lt;child&gt;
+				    &lt;widget class=&quot;GtkLabel&quot; id=&quot;rollingAvgInitLabel1&quot;&gt;
+				      &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+				      &lt;property name=&quot;label&quot; translatable=&quot;yes&quot;&gt;_Initial average (&quot;head start&quot;) is &lt;/property&gt;
+				      &lt;property name=&quot;use_underline&quot;&gt;True&lt;/property&gt;
+				      &lt;property name=&quot;use_markup&quot;&gt;False&lt;/property&gt;
+				      &lt;property name=&quot;justify&quot;&gt;GTK_JUSTIFY_LEFT&lt;/property&gt;
+				      &lt;property name=&quot;wrap&quot;&gt;False&lt;/property&gt;
+				      &lt;property name=&quot;selectable&quot;&gt;False&lt;/property&gt;
+				      &lt;property name=&quot;xalign&quot;&gt;0.5&lt;/property&gt;
+				      &lt;property name=&quot;yalign&quot;&gt;0.5&lt;/property&gt;
+				      &lt;property name=&quot;xpad&quot;&gt;0&lt;/property&gt;
+				      &lt;property name=&quot;ypad&quot;&gt;0&lt;/property&gt;
+				      &lt;property name=&quot;ellipsize&quot;&gt;PANGO_ELLIPSIZE_NONE&lt;/property&gt;
+				      &lt;property name=&quot;width_chars&quot;&gt;-1&lt;/property&gt;
+				      &lt;property name=&quot;single_line_mode&quot;&gt;False&lt;/property&gt;
+				      &lt;property name=&quot;angle&quot;&gt;0&lt;/property&gt;
+				    &lt;/widget&gt;
+				    &lt;packing&gt;
+				      &lt;property name=&quot;padding&quot;&gt;0&lt;/property&gt;
+				      &lt;property name=&quot;expand&quot;&gt;False&lt;/property&gt;
+				      &lt;property name=&quot;fill&quot;&gt;False&lt;/property&gt;
+				    &lt;/packing&gt;
+				  &lt;/child&gt;
+
+				  &lt;child&gt;
+				    &lt;widget class=&quot;GtkComboBox&quot; id=&quot;rollingAvgInitTypeMenu&quot;&gt;
+				      &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+				      &lt;property name=&quot;items&quot; translatable=&quot;yes&quot;&gt;straight
+rolling&lt;/property&gt;
+				      &lt;property name=&quot;add_tearoffs&quot;&gt;False&lt;/property&gt;
+				      &lt;property name=&quot;focus_on_click&quot;&gt;True&lt;/property&gt;
+				    &lt;/widget&gt;
+				    &lt;packing&gt;
+				      &lt;property name=&quot;padding&quot;&gt;0&lt;/property&gt;
+				      &lt;property name=&quot;expand&quot;&gt;False&lt;/property&gt;
+				      &lt;property name=&quot;fill&quot;&gt;True&lt;/property&gt;
+				    &lt;/packing&gt;
+				  &lt;/child&gt;
+
+				  &lt;child&gt;
+				    &lt;widget class=&quot;GtkLabel&quot; id=&quot;rollingAvgInitLabel2&quot;&gt;
+				      &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+				      &lt;property name=&quot;label&quot; translatable=&quot;yes&quot;&gt; average&lt;/property&gt;
+				      &lt;property name=&quot;use_underline&quot;&gt;False&lt;/property&gt;
+				      &lt;property name=&quot;use_markup&quot;&gt;False&lt;/property&gt;
+				      &lt;property name=&quot;justify&quot;&gt;GTK_JUSTIFY_LEFT&lt;/property&gt;
+				      &lt;property name=&quot;wrap&quot;&gt;False&lt;/property&gt;
+				      &lt;property name=&quot;selectable&quot;&gt;False&lt;/property&gt;
+				      &lt;property name=&quot;xalign&quot;&gt;0.5&lt;/property&gt;
+				      &lt;property name=&quot;yalign&quot;&gt;0.5&lt;/property&gt;
+				      &lt;property name=&quot;xpad&quot;&gt;0&lt;/property&gt;
+				      &lt;property name=&quot;ypad&quot;&gt;0&lt;/property&gt;
+				      &lt;property name=&quot;ellipsize&quot;&gt;PANGO_ELLIPSIZE_NONE&lt;/property&gt;
+				      &lt;property name=&quot;width_chars&quot;&gt;-1&lt;/property&gt;
+				      &lt;property name=&quot;single_line_mode&quot;&gt;False&lt;/property&gt;
+				      &lt;property name=&quot;angle&quot;&gt;0&lt;/property&gt;
+				    &lt;/widget&gt;
+				    &lt;packing&gt;
+				      &lt;property name=&quot;padding&quot;&gt;0&lt;/property&gt;
+				      &lt;property name=&quot;expand&quot;&gt;False&lt;/property&gt;
+				      &lt;property name=&quot;fill&quot;&gt;False&lt;/property&gt;
+				    &lt;/packing&gt;
+				  &lt;/child&gt;
+				&lt;/widget&gt;
+				&lt;packing&gt;
+				  &lt;property name=&quot;padding&quot;&gt;0&lt;/property&gt;
+				  &lt;property name=&quot;expand&quot;&gt;True&lt;/property&gt;
+				  &lt;property name=&quot;fill&quot;&gt;True&lt;/property&gt;
+				&lt;/packing&gt;
+			      &lt;/child&gt;
+
+			      &lt;child&gt;
+				&lt;widget class=&quot;GtkHBox&quot; id=&quot;rollingAvgInitHbox2&quot;&gt;
+				  &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+				  &lt;property name=&quot;homogeneous&quot;&gt;False&lt;/property&gt;
+				  &lt;property name=&quot;spacing&quot;&gt;0&lt;/property&gt;
+
+				  &lt;child&gt;
+				    &lt;widget class=&quot;GtkLabel&quot; id=&quot;rollingAvgInitLabel3&quot;&gt;
+				      &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+				      &lt;property name=&quot;label&quot; translatable=&quot;yes&quot;&gt;      of frames &lt;/property&gt;
+				      &lt;property name=&quot;use_underline&quot;&gt;False&lt;/property&gt;
+				      &lt;property name=&quot;use_markup&quot;&gt;False&lt;/property&gt;
+				      &lt;property name=&quot;justify&quot;&gt;GTK_JUSTIFY_LEFT&lt;/property&gt;
+				      &lt;property name=&quot;wrap&quot;&gt;False&lt;/property&gt;
+				      &lt;property name=&quot;selectable&quot;&gt;False&lt;/property&gt;
+				      &lt;property name=&quot;xalign&quot;&gt;0.5&lt;/property&gt;
+				      &lt;property name=&quot;yalign&quot;&gt;0.5&lt;/property&gt;
+				      &lt;property name=&quot;xpad&quot;&gt;0&lt;/property&gt;
+				      &lt;property name=&quot;ypad&quot;&gt;0&lt;/property&gt;
+				      &lt;property name=&quot;ellipsize&quot;&gt;PANGO_ELLIPSIZE_NONE&lt;/property&gt;
+				      &lt;property name=&quot;width_chars&quot;&gt;-1&lt;/property&gt;
+				      &lt;property name=&quot;single_line_mode&quot;&gt;False&lt;/property&gt;
+				      &lt;property name=&quot;angle&quot;&gt;0&lt;/property&gt;
+				    &lt;/widget&gt;
+				    &lt;packing&gt;
+				      &lt;property name=&quot;padding&quot;&gt;0&lt;/property&gt;
+				      &lt;property name=&quot;expand&quot;&gt;False&lt;/property&gt;
+				      &lt;property name=&quot;fill&quot;&gt;False&lt;/property&gt;
+				    &lt;/packing&gt;
+				  &lt;/child&gt;
+
+				  &lt;child&gt;
+				    &lt;widget class=&quot;GtkSpinButton&quot; id=&quot;rollingAvgInitStartSpinButton&quot;&gt;
+				      &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+				      &lt;property name=&quot;can_focus&quot;&gt;True&lt;/property&gt;
+				      &lt;property name=&quot;climb_rate&quot;&gt;1&lt;/property&gt;
+				      &lt;property name=&quot;digits&quot;&gt;0&lt;/property&gt;
+				      &lt;property name=&quot;numeric&quot;&gt;True&lt;/property&gt;
+				      &lt;property name=&quot;update_policy&quot;&gt;GTK_UPDATE_ALWAYS&lt;/property&gt;
+				      &lt;property name=&quot;snap_to_ticks&quot;&gt;False&lt;/property&gt;
+				      &lt;property name=&quot;wrap&quot;&gt;False&lt;/property&gt;
+				      &lt;property name=&quot;adjustment&quot;&gt;1 1 99999 1 1 0&lt;/property&gt;
+				    &lt;/widget&gt;
+				    &lt;packing&gt;
+				      &lt;property name=&quot;padding&quot;&gt;0&lt;/property&gt;
+				      &lt;property name=&quot;expand&quot;&gt;False&lt;/property&gt;
+				      &lt;property name=&quot;fill&quot;&gt;True&lt;/property&gt;
+				    &lt;/packing&gt;
+				  &lt;/child&gt;
+
+				  &lt;child&gt;
+				    &lt;widget class=&quot;GtkLabel&quot; id=&quot;rollingAvgInitLabel4&quot;&gt;
+				      &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+				      &lt;property name=&quot;label&quot; translatable=&quot;yes&quot;&gt; through &lt;/property&gt;
+				      &lt;property name=&quot;use_underline&quot;&gt;False&lt;/property&gt;
+				      &lt;property name=&quot;use_markup&quot;&gt;False&lt;/property&gt;
+				      &lt;property name=&quot;justify&quot;&gt;GTK_JUSTIFY_LEFT&lt;/property&gt;
+				      &lt;property name=&quot;wrap&quot;&gt;False&lt;/property&gt;
+				      &lt;property name=&quot;selectable&quot;&gt;False&lt;/property&gt;
+				      &lt;property name=&quot;xalign&quot;&gt;0.5&lt;/property&gt;
+				      &lt;property name=&quot;yalign&quot;&gt;0.5&lt;/property&gt;
+				      &lt;property name=&quot;xpad&quot;&gt;0&lt;/property&gt;
+				      &lt;property name=&quot;ypad&quot;&gt;0&lt;/property&gt;
+				      &lt;property name=&quot;ellipsize&quot;&gt;PANGO_ELLIPSIZE_NONE&lt;/property&gt;
+				      &lt;property name=&quot;width_chars&quot;&gt;-1&lt;/property&gt;
+				      &lt;property name=&quot;single_line_mode&quot;&gt;False&lt;/property&gt;
+				      &lt;property name=&quot;angle&quot;&gt;0&lt;/property&gt;
+				    &lt;/widget&gt;
+				    &lt;packing&gt;
+				      &lt;property name=&quot;padding&quot;&gt;0&lt;/property&gt;
+				      &lt;property name=&quot;expand&quot;&gt;False&lt;/property&gt;
+				      &lt;property name=&quot;fill&quot;&gt;False&lt;/property&gt;
+				    &lt;/packing&gt;
+				  &lt;/child&gt;
+
+				  &lt;child&gt;
+				    &lt;widget class=&quot;GtkSpinButton&quot; id=&quot;rollingAvgInitEndSpinButton&quot;&gt;
+				      &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+				      &lt;property name=&quot;can_focus&quot;&gt;True&lt;/property&gt;
+				      &lt;property name=&quot;climb_rate&quot;&gt;1&lt;/property&gt;
+				      &lt;property name=&quot;digits&quot;&gt;0&lt;/property&gt;
+				      &lt;property name=&quot;numeric&quot;&gt;True&lt;/property&gt;
+				      &lt;property name=&quot;update_policy&quot;&gt;GTK_UPDATE_ALWAYS&lt;/property&gt;
+				      &lt;property name=&quot;snap_to_ticks&quot;&gt;False&lt;/property&gt;
+				      &lt;property name=&quot;wrap&quot;&gt;False&lt;/property&gt;
+				      &lt;property name=&quot;adjustment&quot;&gt;100 1 99999 1 1 0&lt;/property&gt;
+				    &lt;/widget&gt;
+				    &lt;packing&gt;
+				      &lt;property name=&quot;padding&quot;&gt;0&lt;/property&gt;
+				      &lt;property name=&quot;expand&quot;&gt;False&lt;/property&gt;
+				      &lt;property name=&quot;fill&quot;&gt;True&lt;/property&gt;
+				    &lt;/packing&gt;
+				  &lt;/child&gt;
+				&lt;/widget&gt;
+				&lt;packing&gt;
+				  &lt;property name=&quot;padding&quot;&gt;0&lt;/property&gt;
+				  &lt;property name=&quot;expand&quot;&gt;True&lt;/property&gt;
+				  &lt;property name=&quot;fill&quot;&gt;True&lt;/property&gt;
+				&lt;/packing&gt;
+			      &lt;/child&gt;
+			    &lt;/widget&gt;
+			    &lt;packing&gt;
+			      &lt;property name=&quot;padding&quot;&gt;0&lt;/property&gt;
+			      &lt;property name=&quot;expand&quot;&gt;True&lt;/property&gt;
+			      &lt;property name=&quot;fill&quot;&gt;True&lt;/property&gt;
+			    &lt;/packing&gt;
+			  &lt;/child&gt;
+			&lt;/widget&gt;
+			&lt;packing&gt;
+			  &lt;property name=&quot;padding&quot;&gt;0&lt;/property&gt;
+			  &lt;property name=&quot;expand&quot;&gt;True&lt;/property&gt;
+			  &lt;property name=&quot;fill&quot;&gt;True&lt;/property&gt;
+			&lt;/packing&gt;
+		      &lt;/child&gt;
+
+		      &lt;child&gt;
+			&lt;widget class=&quot;GtkHSeparator&quot; id=&quot;bottomSeparator&quot;&gt;
+			  &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+			&lt;/widget&gt;
+			&lt;packing&gt;
+			  &lt;property name=&quot;padding&quot;&gt;0&lt;/property&gt;
+			  &lt;property name=&quot;expand&quot;&gt;True&lt;/property&gt;
+			  &lt;property name=&quot;fill&quot;&gt;True&lt;/property&gt;
+			&lt;/packing&gt;
+		      &lt;/child&gt;
+
+		      &lt;child&gt;
+			&lt;widget class=&quot;GtkVBox&quot; id=&quot;biasVbox&quot;&gt;
+			  &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+			  &lt;property name=&quot;homogeneous&quot;&gt;False&lt;/property&gt;
+			  &lt;property name=&quot;spacing&quot;&gt;0&lt;/property&gt;
+
+			  &lt;child&gt;
+			    &lt;widget class=&quot;GtkLabel&quot; id=&quot;biasLabel&quot;&gt;
+			      &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+			      &lt;property name=&quot;label&quot; translatable=&quot;yes&quot;&gt;Integer _Bias (will be added to result of selected operation):&lt;/property&gt;
+			      &lt;property name=&quot;use_underline&quot;&gt;True&lt;/property&gt;
+			      &lt;property name=&quot;use_markup&quot;&gt;False&lt;/property&gt;
+			      &lt;property name=&quot;justify&quot;&gt;GTK_JUSTIFY_LEFT&lt;/property&gt;
+			      &lt;property name=&quot;wrap&quot;&gt;False&lt;/property&gt;
+			      &lt;property name=&quot;selectable&quot;&gt;False&lt;/property&gt;
+			      &lt;property name=&quot;xalign&quot;&gt;0&lt;/property&gt;
+			      &lt;property name=&quot;yalign&quot;&gt;0.5&lt;/property&gt;
+			      &lt;property name=&quot;xpad&quot;&gt;0&lt;/property&gt;
+			      &lt;property name=&quot;ypad&quot;&gt;0&lt;/property&gt;
+			      &lt;property name=&quot;ellipsize&quot;&gt;PANGO_ELLIPSIZE_NONE&lt;/property&gt;
+			      &lt;property name=&quot;width_chars&quot;&gt;-1&lt;/property&gt;
+			      &lt;property name=&quot;single_line_mode&quot;&gt;False&lt;/property&gt;
+			      &lt;property name=&quot;angle&quot;&gt;0&lt;/property&gt;
+			    &lt;/widget&gt;
+			    &lt;packing&gt;
+			      &lt;property name=&quot;padding&quot;&gt;0&lt;/property&gt;
+			      &lt;property name=&quot;expand&quot;&gt;False&lt;/property&gt;
+			      &lt;property name=&quot;fill&quot;&gt;False&lt;/property&gt;
+			    &lt;/packing&gt;
+			  &lt;/child&gt;
+
+			  &lt;child&gt;
+			    &lt;widget class=&quot;GtkHBox&quot; id=&quot;biasHbox&quot;&gt;
+			      &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+			      &lt;property name=&quot;homogeneous&quot;&gt;False&lt;/property&gt;
+			      &lt;property name=&quot;spacing&quot;&gt;5&lt;/property&gt;
+
+			      &lt;child&gt;
+				&lt;widget class=&quot;GtkHScale&quot; id=&quot;biasSlider&quot;&gt;
+				  &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+				  &lt;property name=&quot;can_focus&quot;&gt;True&lt;/property&gt;
+				  &lt;property name=&quot;draw_value&quot;&gt;False&lt;/property&gt;
+				  &lt;property name=&quot;value_pos&quot;&gt;GTK_POS_LEFT&lt;/property&gt;
+				  &lt;property name=&quot;digits&quot;&gt;0&lt;/property&gt;
+				  &lt;property name=&quot;update_policy&quot;&gt;GTK_UPDATE_CONTINUOUS&lt;/property&gt;
+				  &lt;property name=&quot;inverted&quot;&gt;False&lt;/property&gt;
+				  &lt;property name=&quot;adjustment&quot;&gt;128 -256 256 1 1 0&lt;/property&gt;
+				&lt;/widget&gt;
+				&lt;packing&gt;
+				  &lt;property name=&quot;padding&quot;&gt;0&lt;/property&gt;
+				  &lt;property name=&quot;expand&quot;&gt;True&lt;/property&gt;
+				  &lt;property name=&quot;fill&quot;&gt;True&lt;/property&gt;
+				&lt;/packing&gt;
+			      &lt;/child&gt;
+
+			      &lt;child&gt;
+				&lt;widget class=&quot;GtkSpinButton&quot; id=&quot;biasSpinner&quot;&gt;
+				  &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+				  &lt;property name=&quot;can_focus&quot;&gt;True&lt;/property&gt;
+				  &lt;property name=&quot;climb_rate&quot;&gt;1&lt;/property&gt;
+				  &lt;property name=&quot;digits&quot;&gt;0&lt;/property&gt;
+				  &lt;property name=&quot;numeric&quot;&gt;True&lt;/property&gt;
+				  &lt;property name=&quot;update_policy&quot;&gt;GTK_UPDATE_ALWAYS&lt;/property&gt;
+				  &lt;property name=&quot;snap_to_ticks&quot;&gt;False&lt;/property&gt;
+				  &lt;property name=&quot;wrap&quot;&gt;False&lt;/property&gt;
+				  &lt;property name=&quot;adjustment&quot;&gt;128 -256 256 1 1 0&lt;/property&gt;
+				&lt;/widget&gt;
+				&lt;packing&gt;
+				  &lt;property name=&quot;padding&quot;&gt;0&lt;/property&gt;
+				  &lt;property name=&quot;expand&quot;&gt;False&lt;/property&gt;
+				  &lt;property name=&quot;fill&quot;&gt;True&lt;/property&gt;
+				&lt;/packing&gt;
+			      &lt;/child&gt;
+			    &lt;/widget&gt;
+			    &lt;packing&gt;
+			      &lt;property name=&quot;padding&quot;&gt;0&lt;/property&gt;
+			      &lt;property name=&quot;expand&quot;&gt;True&lt;/property&gt;
+			      &lt;property name=&quot;fill&quot;&gt;True&lt;/property&gt;
+			    &lt;/packing&gt;
+			  &lt;/child&gt;
+			&lt;/widget&gt;
+			&lt;packing&gt;
+			  &lt;property name=&quot;padding&quot;&gt;0&lt;/property&gt;
+			  &lt;property name=&quot;expand&quot;&gt;True&lt;/property&gt;
+			  &lt;property name=&quot;fill&quot;&gt;True&lt;/property&gt;
+			&lt;/packing&gt;
+		      &lt;/child&gt;
+
+		      &lt;child&gt;
+			&lt;widget class=&quot;GtkFrame&quot; id=&quot;resultScalingFrame&quot;&gt;
+			  &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+			  &lt;property name=&quot;label_xalign&quot;&gt;0&lt;/property&gt;
+			  &lt;property name=&quot;label_yalign&quot;&gt;0.5&lt;/property&gt;
+			  &lt;property name=&quot;shadow_type&quot;&gt;GTK_SHADOW_IN&lt;/property&gt;
+
+			  &lt;child&gt;
+			    &lt;widget class=&quot;GtkAlignment&quot; id=&quot;resultScalingAlignment&quot;&gt;
+			      &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+			      &lt;property name=&quot;xalign&quot;&gt;0.5&lt;/property&gt;
+			      &lt;property name=&quot;yalign&quot;&gt;0.5&lt;/property&gt;
+			      &lt;property name=&quot;xscale&quot;&gt;1&lt;/property&gt;
+			      &lt;property name=&quot;yscale&quot;&gt;1&lt;/property&gt;
+			      &lt;property name=&quot;top_padding&quot;&gt;2&lt;/property&gt;
+			      &lt;property name=&quot;bottom_padding&quot;&gt;6&lt;/property&gt;
+			      &lt;property name=&quot;left_padding&quot;&gt;6&lt;/property&gt;
+			      &lt;property name=&quot;right_padding&quot;&gt;6&lt;/property&gt;
+
+			      &lt;child&gt;
+				&lt;widget class=&quot;GtkVBox&quot; id=&quot;resultScalingVbox&quot;&gt;
+				  &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+				  &lt;property name=&quot;homogeneous&quot;&gt;False&lt;/property&gt;
+				  &lt;property name=&quot;spacing&quot;&gt;6&lt;/property&gt;
+
+				  &lt;child&gt;
+				    &lt;widget class=&quot;GtkHBox&quot; id=&quot;resultScalingAddHbox&quot;&gt;
+				      &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+				      &lt;property name=&quot;homogeneous&quot;&gt;False&lt;/property&gt;
+				      &lt;property name=&quot;spacing&quot;&gt;0&lt;/property&gt;
+
+				      &lt;child&gt;
+					&lt;widget class=&quot;GtkLabel&quot; id=&quot;resultScalingAddLabel&quot;&gt;
+					  &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+					  &lt;property name=&quot;label&quot; translatable=&quot;yes&quot;&gt;First, _add to each pixel result value:   &lt;/property&gt;
+					  &lt;property name=&quot;use_underline&quot;&gt;True&lt;/property&gt;
+					  &lt;property name=&quot;use_markup&quot;&gt;False&lt;/property&gt;
+					  &lt;property name=&quot;justify&quot;&gt;GTK_JUSTIFY_LEFT&lt;/property&gt;
+					  &lt;property name=&quot;wrap&quot;&gt;False&lt;/property&gt;
+					  &lt;property name=&quot;selectable&quot;&gt;False&lt;/property&gt;
+					  &lt;property name=&quot;xalign&quot;&gt;0.5&lt;/property&gt;
+					  &lt;property name=&quot;yalign&quot;&gt;0.5&lt;/property&gt;
+					  &lt;property name=&quot;xpad&quot;&gt;0&lt;/property&gt;
+					  &lt;property name=&quot;ypad&quot;&gt;0&lt;/property&gt;
+					  &lt;property name=&quot;mnemonic_widget&quot;&gt;resultScalingAddSpinButton&lt;/property&gt;
+					  &lt;property name=&quot;ellipsize&quot;&gt;PANGO_ELLIPSIZE_NONE&lt;/property&gt;
+					  &lt;property name=&quot;width_chars&quot;&gt;-1&lt;/property&gt;
+					  &lt;property name=&quot;single_line_mode&quot;&gt;False&lt;/property&gt;
+					  &lt;property name=&quot;angle&quot;&gt;0&lt;/property&gt;
+					&lt;/widget&gt;
+					&lt;packing&gt;
+					  &lt;property name=&quot;padding&quot;&gt;0&lt;/property&gt;
+					  &lt;property name=&quot;expand&quot;&gt;False&lt;/property&gt;
+					  &lt;property name=&quot;fill&quot;&gt;False&lt;/property&gt;
+					&lt;/packing&gt;
+				      &lt;/child&gt;
+
+				      &lt;child&gt;
+					&lt;widget class=&quot;GtkSpinButton&quot; id=&quot;resultScalingAddSpinButton&quot;&gt;
+					  &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+					  &lt;property name=&quot;can_focus&quot;&gt;True&lt;/property&gt;
+					  &lt;property name=&quot;climb_rate&quot;&gt;1&lt;/property&gt;
+					  &lt;property name=&quot;digits&quot;&gt;5&lt;/property&gt;
+					  &lt;property name=&quot;numeric&quot;&gt;True&lt;/property&gt;
+					  &lt;property name=&quot;update_policy&quot;&gt;GTK_UPDATE_ALWAYS&lt;/property&gt;
+					  &lt;property name=&quot;snap_to_ticks&quot;&gt;False&lt;/property&gt;
+					  &lt;property name=&quot;wrap&quot;&gt;False&lt;/property&gt;
+					  &lt;property name=&quot;adjustment&quot;&gt;0 -99999 99999 0.10000000149 1 0&lt;/property&gt;
+					&lt;/widget&gt;
+					&lt;packing&gt;
+					  &lt;property name=&quot;padding&quot;&gt;0&lt;/property&gt;
+					  &lt;property name=&quot;expand&quot;&gt;True&lt;/property&gt;
+					  &lt;property name=&quot;fill&quot;&gt;True&lt;/property&gt;
+					&lt;/packing&gt;
+				      &lt;/child&gt;
+				    &lt;/widget&gt;
+				    &lt;packing&gt;
+				      &lt;property name=&quot;padding&quot;&gt;0&lt;/property&gt;
+				      &lt;property name=&quot;expand&quot;&gt;True&lt;/property&gt;
+				      &lt;property name=&quot;fill&quot;&gt;True&lt;/property&gt;
+				    &lt;/packing&gt;
+				  &lt;/child&gt;
+
+				  &lt;child&gt;
+				    &lt;widget class=&quot;GtkHBox&quot; id=&quot;resultScalingMultHbox&quot;&gt;
+				      &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+				      &lt;property name=&quot;homogeneous&quot;&gt;False&lt;/property&gt;
+				      &lt;property name=&quot;spacing&quot;&gt;0&lt;/property&gt;
+
+				      &lt;child&gt;
+					&lt;widget class=&quot;GtkLabel&quot; id=&quot;resultScalingMultLabel&quot;&gt;
+					  &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+					  &lt;property name=&quot;label&quot; translatable=&quot;yes&quot;&gt;Then, _multiply each pixel result value by:   &lt;/property&gt;
+					  &lt;property name=&quot;use_underline&quot;&gt;True&lt;/property&gt;
+					  &lt;property name=&quot;use_markup&quot;&gt;False&lt;/property&gt;
+					  &lt;property name=&quot;justify&quot;&gt;GTK_JUSTIFY_LEFT&lt;/property&gt;
+					  &lt;property name=&quot;wrap&quot;&gt;False&lt;/property&gt;
+					  &lt;property name=&quot;selectable&quot;&gt;False&lt;/property&gt;
+					  &lt;property name=&quot;xalign&quot;&gt;0.5&lt;/property&gt;
+					  &lt;property name=&quot;yalign&quot;&gt;0.5&lt;/property&gt;
+					  &lt;property name=&quot;xpad&quot;&gt;0&lt;/property&gt;
+					  &lt;property name=&quot;ypad&quot;&gt;0&lt;/property&gt;
+					  &lt;property name=&quot;mnemonic_widget&quot;&gt;resultScalingMultSpinButton&lt;/property&gt;
+					  &lt;property name=&quot;ellipsize&quot;&gt;PANGO_ELLIPSIZE_NONE&lt;/property&gt;
+					  &lt;property name=&quot;width_chars&quot;&gt;-1&lt;/property&gt;
+					  &lt;property name=&quot;single_line_mode&quot;&gt;False&lt;/property&gt;
+					  &lt;property name=&quot;angle&quot;&gt;0&lt;/property&gt;
+					&lt;/widget&gt;
+					&lt;packing&gt;
+					  &lt;property name=&quot;padding&quot;&gt;0&lt;/property&gt;
+					  &lt;property name=&quot;expand&quot;&gt;False&lt;/property&gt;
+					  &lt;property name=&quot;fill&quot;&gt;False&lt;/property&gt;
+					&lt;/packing&gt;
+				      &lt;/child&gt;
+
+				      &lt;child&gt;
+					&lt;widget class=&quot;GtkSpinButton&quot; id=&quot;resultScalingMultSpinButton&quot;&gt;
+					  &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+					  &lt;property name=&quot;can_focus&quot;&gt;True&lt;/property&gt;
+					  &lt;property name=&quot;climb_rate&quot;&gt;1&lt;/property&gt;
+					  &lt;property name=&quot;digits&quot;&gt;5&lt;/property&gt;
+					  &lt;property name=&quot;numeric&quot;&gt;True&lt;/property&gt;
+					  &lt;property name=&quot;update_policy&quot;&gt;GTK_UPDATE_ALWAYS&lt;/property&gt;
+					  &lt;property name=&quot;snap_to_ticks&quot;&gt;False&lt;/property&gt;
+					  &lt;property name=&quot;wrap&quot;&gt;False&lt;/property&gt;
+					  &lt;property name=&quot;adjustment&quot;&gt;1 -99999 99999 0.0010000000475 0.0010000000475 0&lt;/property&gt;
+					&lt;/widget&gt;
+					&lt;packing&gt;
+					  &lt;property name=&quot;padding&quot;&gt;0&lt;/property&gt;
+					  &lt;property name=&quot;expand&quot;&gt;True&lt;/property&gt;
+					  &lt;property name=&quot;fill&quot;&gt;True&lt;/property&gt;
+					&lt;/packing&gt;
+				      &lt;/child&gt;
+				    &lt;/widget&gt;
+				    &lt;packing&gt;
+				      &lt;property name=&quot;padding&quot;&gt;0&lt;/property&gt;
+				      &lt;property name=&quot;expand&quot;&gt;True&lt;/property&gt;
+				      &lt;property name=&quot;fill&quot;&gt;True&lt;/property&gt;
+				    &lt;/packing&gt;
+				  &lt;/child&gt;
+
+				  &lt;child&gt;
+				    &lt;widget class=&quot;GtkVBox&quot; id=&quot;resultScalingMinVbox&quot;&gt;
+				      &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+				      &lt;property name=&quot;homogeneous&quot;&gt;False&lt;/property&gt;
+				      &lt;property name=&quot;spacing&quot;&gt;0&lt;/property&gt;
+
+				      &lt;child&gt;
+					&lt;widget class=&quot;GtkLabel&quot; id=&quot;resultScalingMinLabel&quot;&gt;
+					  &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+					  &lt;property name=&quot;label&quot; translatable=&quot;yes&quot;&gt;Mi_nimum result value (will be scaled to 0):&lt;/property&gt;
+					  &lt;property name=&quot;use_underline&quot;&gt;True&lt;/property&gt;
+					  &lt;property name=&quot;use_markup&quot;&gt;False&lt;/property&gt;
+					  &lt;property name=&quot;justify&quot;&gt;GTK_JUSTIFY_LEFT&lt;/property&gt;
+					  &lt;property name=&quot;wrap&quot;&gt;False&lt;/property&gt;
+					  &lt;property name=&quot;selectable&quot;&gt;False&lt;/property&gt;
+					  &lt;property name=&quot;xalign&quot;&gt;0&lt;/property&gt;
+					  &lt;property name=&quot;yalign&quot;&gt;0.5&lt;/property&gt;
+					  &lt;property name=&quot;xpad&quot;&gt;0&lt;/property&gt;
+					  &lt;property name=&quot;ypad&quot;&gt;0&lt;/property&gt;
+					  &lt;property name=&quot;ellipsize&quot;&gt;PANGO_ELLIPSIZE_NONE&lt;/property&gt;
+					  &lt;property name=&quot;width_chars&quot;&gt;-1&lt;/property&gt;
+					  &lt;property name=&quot;single_line_mode&quot;&gt;False&lt;/property&gt;
+					  &lt;property name=&quot;angle&quot;&gt;0&lt;/property&gt;
+					&lt;/widget&gt;
+					&lt;packing&gt;
+					  &lt;property name=&quot;padding&quot;&gt;0&lt;/property&gt;
+					  &lt;property name=&quot;expand&quot;&gt;False&lt;/property&gt;
+					  &lt;property name=&quot;fill&quot;&gt;False&lt;/property&gt;
+					&lt;/packing&gt;
+				      &lt;/child&gt;
+
+				      &lt;child&gt;
+					&lt;widget class=&quot;GtkHBox&quot; id=&quot;resultScalingMinHbox&quot;&gt;
+					  &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+					  &lt;property name=&quot;homogeneous&quot;&gt;False&lt;/property&gt;
+					  &lt;property name=&quot;spacing&quot;&gt;5&lt;/property&gt;
+
+					  &lt;child&gt;
+					    &lt;widget class=&quot;GtkHScale&quot; id=&quot;resultScalingMinSlider&quot;&gt;
+					      &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+					      &lt;property name=&quot;can_focus&quot;&gt;True&lt;/property&gt;
+					      &lt;property name=&quot;draw_value&quot;&gt;False&lt;/property&gt;
+					      &lt;property name=&quot;value_pos&quot;&gt;GTK_POS_LEFT&lt;/property&gt;
+					      &lt;property name=&quot;digits&quot;&gt;0&lt;/property&gt;
+					      &lt;property name=&quot;update_policy&quot;&gt;GTK_UPDATE_CONTINUOUS&lt;/property&gt;
+					      &lt;property name=&quot;inverted&quot;&gt;False&lt;/property&gt;
+					      &lt;property name=&quot;adjustment&quot;&gt;0 -1024 1024 1 1 0&lt;/property&gt;
+					    &lt;/widget&gt;
+					    &lt;packing&gt;
+					      &lt;property name=&quot;padding&quot;&gt;0&lt;/property&gt;
+					      &lt;property name=&quot;expand&quot;&gt;True&lt;/property&gt;
+					      &lt;property name=&quot;fill&quot;&gt;True&lt;/property&gt;
+					    &lt;/packing&gt;
+					  &lt;/child&gt;
+
+					  &lt;child&gt;
+					    &lt;widget class=&quot;GtkSpinButton&quot; id=&quot;resultScalingMinSpinner&quot;&gt;
+					      &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+					      &lt;property name=&quot;can_focus&quot;&gt;True&lt;/property&gt;
+					      &lt;property name=&quot;climb_rate&quot;&gt;1&lt;/property&gt;
+					      &lt;property name=&quot;digits&quot;&gt;1&lt;/property&gt;
+					      &lt;property name=&quot;numeric&quot;&gt;True&lt;/property&gt;
+					      &lt;property name=&quot;update_policy&quot;&gt;GTK_UPDATE_ALWAYS&lt;/property&gt;
+					      &lt;property name=&quot;snap_to_ticks&quot;&gt;False&lt;/property&gt;
+					      &lt;property name=&quot;wrap&quot;&gt;False&lt;/property&gt;
+					      &lt;property name=&quot;adjustment&quot;&gt;0 -1024 1024 1 2 0&lt;/property&gt;
+					    &lt;/widget&gt;
+					    &lt;packing&gt;
+					      &lt;property name=&quot;padding&quot;&gt;0&lt;/property&gt;
+					      &lt;property name=&quot;expand&quot;&gt;False&lt;/property&gt;
+					      &lt;property name=&quot;fill&quot;&gt;True&lt;/property&gt;
+					    &lt;/packing&gt;
+					  &lt;/child&gt;
+					&lt;/widget&gt;
+					&lt;packing&gt;
+					  &lt;property name=&quot;padding&quot;&gt;0&lt;/property&gt;
+					  &lt;property name=&quot;expand&quot;&gt;True&lt;/property&gt;
+					  &lt;property name=&quot;fill&quot;&gt;True&lt;/property&gt;
+					&lt;/packing&gt;
+				      &lt;/child&gt;
+				    &lt;/widget&gt;
+				    &lt;packing&gt;
+				      &lt;property name=&quot;padding&quot;&gt;0&lt;/property&gt;
+				      &lt;property name=&quot;expand&quot;&gt;True&lt;/property&gt;
+				      &lt;property name=&quot;fill&quot;&gt;True&lt;/property&gt;
+				    &lt;/packing&gt;
+				  &lt;/child&gt;
+
+				  &lt;child&gt;
+				    &lt;widget class=&quot;GtkVBox&quot; id=&quot;resultScalingMaxVbox&quot;&gt;
+				      &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+				      &lt;property name=&quot;homogeneous&quot;&gt;False&lt;/property&gt;
+				      &lt;property name=&quot;spacing&quot;&gt;0&lt;/property&gt;
+
+				      &lt;child&gt;
+					&lt;widget class=&quot;GtkLabel&quot; id=&quot;resultScalingMaxLabel&quot;&gt;
+					  &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+					  &lt;property name=&quot;label&quot; translatable=&quot;yes&quot;&gt;Ma_ximum result value (will be scaled to 255):&lt;/property&gt;
+					  &lt;property name=&quot;use_underline&quot;&gt;True&lt;/property&gt;
+					  &lt;property name=&quot;use_markup&quot;&gt;False&lt;/property&gt;
+					  &lt;property name=&quot;justify&quot;&gt;GTK_JUSTIFY_LEFT&lt;/property&gt;
+					  &lt;property name=&quot;wrap&quot;&gt;False&lt;/property&gt;
+					  &lt;property name=&quot;selectable&quot;&gt;False&lt;/property&gt;
+					  &lt;property name=&quot;xalign&quot;&gt;0&lt;/property&gt;
+					  &lt;property name=&quot;yalign&quot;&gt;0.5&lt;/property&gt;
+					  &lt;property name=&quot;xpad&quot;&gt;0&lt;/property&gt;
+					  &lt;property name=&quot;ypad&quot;&gt;0&lt;/property&gt;
+					  &lt;property name=&quot;ellipsize&quot;&gt;PANGO_ELLIPSIZE_NONE&lt;/property&gt;
+					  &lt;property name=&quot;width_chars&quot;&gt;-1&lt;/property&gt;
+					  &lt;property name=&quot;single_line_mode&quot;&gt;False&lt;/property&gt;
+					  &lt;property name=&quot;angle&quot;&gt;0&lt;/property&gt;
+					&lt;/widget&gt;
+					&lt;packing&gt;
+					  &lt;property name=&quot;padding&quot;&gt;0&lt;/property&gt;
+					  &lt;property name=&quot;expand&quot;&gt;False&lt;/property&gt;
+					  &lt;property name=&quot;fill&quot;&gt;False&lt;/property&gt;
+					&lt;/packing&gt;
+				      &lt;/child&gt;
+
+				      &lt;child&gt;
+					&lt;widget class=&quot;GtkHBox&quot; id=&quot;resultScalingMaxHbox&quot;&gt;
+					  &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+					  &lt;property name=&quot;homogeneous&quot;&gt;False&lt;/property&gt;
+					  &lt;property name=&quot;spacing&quot;&gt;5&lt;/property&gt;
+
+					  &lt;child&gt;
+					    &lt;widget class=&quot;GtkHScale&quot; id=&quot;resultScalingMaxSlider&quot;&gt;
+					      &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+					      &lt;property name=&quot;can_focus&quot;&gt;True&lt;/property&gt;
+					      &lt;property name=&quot;draw_value&quot;&gt;False&lt;/property&gt;
+					      &lt;property name=&quot;value_pos&quot;&gt;GTK_POS_LEFT&lt;/property&gt;
+					      &lt;property name=&quot;digits&quot;&gt;0&lt;/property&gt;
+					      &lt;property name=&quot;update_policy&quot;&gt;GTK_UPDATE_CONTINUOUS&lt;/property&gt;
+					      &lt;property name=&quot;inverted&quot;&gt;False&lt;/property&gt;
+					      &lt;property name=&quot;adjustment&quot;&gt;255 -1024 1024 1 1 0&lt;/property&gt;
+					    &lt;/widget&gt;
+					    &lt;packing&gt;
+					      &lt;property name=&quot;padding&quot;&gt;0&lt;/property&gt;
+					      &lt;property name=&quot;expand&quot;&gt;True&lt;/property&gt;
+					      &lt;property name=&quot;fill&quot;&gt;True&lt;/property&gt;
+					    &lt;/packing&gt;
+					  &lt;/child&gt;
+
+					  &lt;child&gt;
+					    &lt;widget class=&quot;GtkSpinButton&quot; id=&quot;resultScalingMaxSpinner&quot;&gt;
+					      &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+					      &lt;property name=&quot;can_focus&quot;&gt;True&lt;/property&gt;
+					      &lt;property name=&quot;climb_rate&quot;&gt;1&lt;/property&gt;
+					      &lt;property name=&quot;digits&quot;&gt;1&lt;/property&gt;
+					      &lt;property name=&quot;numeric&quot;&gt;True&lt;/property&gt;
+					      &lt;property name=&quot;update_policy&quot;&gt;GTK_UPDATE_ALWAYS&lt;/property&gt;
+					      &lt;property name=&quot;snap_to_ticks&quot;&gt;False&lt;/property&gt;
+					      &lt;property name=&quot;wrap&quot;&gt;False&lt;/property&gt;
+					      &lt;property name=&quot;adjustment&quot;&gt;255 -1024 1024 1 2 0&lt;/property&gt;
+					    &lt;/widget&gt;
+					    &lt;packing&gt;
+					      &lt;property name=&quot;padding&quot;&gt;0&lt;/property&gt;
+					      &lt;property name=&quot;expand&quot;&gt;False&lt;/property&gt;
+					      &lt;property name=&quot;fill&quot;&gt;True&lt;/property&gt;
+					    &lt;/packing&gt;
+					  &lt;/child&gt;
+					&lt;/widget&gt;
+					&lt;packing&gt;
+					  &lt;property name=&quot;padding&quot;&gt;0&lt;/property&gt;
+					  &lt;property name=&quot;expand&quot;&gt;True&lt;/property&gt;
+					  &lt;property name=&quot;fill&quot;&gt;True&lt;/property&gt;
+					&lt;/packing&gt;
+				      &lt;/child&gt;
+				    &lt;/widget&gt;
+				    &lt;packing&gt;
+				      &lt;property name=&quot;padding&quot;&gt;0&lt;/property&gt;
+				      &lt;property name=&quot;expand&quot;&gt;True&lt;/property&gt;
+				      &lt;property name=&quot;fill&quot;&gt;True&lt;/property&gt;
+				    &lt;/packing&gt;
+				  &lt;/child&gt;
+				&lt;/widget&gt;
+			      &lt;/child&gt;
+			    &lt;/widget&gt;
+			  &lt;/child&gt;
+
+			  &lt;child&gt;
+			    &lt;widget class=&quot;GtkLabel&quot; id=&quot;resultScalingFrameLabel&quot;&gt;
+			      &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+			      &lt;property name=&quot;label&quot; translatable=&quot;yes&quot;&gt;Pixel Value Scaling on Result of Selected Operation&lt;/property&gt;
+			      &lt;property name=&quot;use_underline&quot;&gt;False&lt;/property&gt;
+			      &lt;property name=&quot;use_markup&quot;&gt;True&lt;/property&gt;
+			      &lt;property name=&quot;justify&quot;&gt;GTK_JUSTIFY_LEFT&lt;/property&gt;
+			      &lt;property name=&quot;wrap&quot;&gt;False&lt;/property&gt;
+			      &lt;property name=&quot;selectable&quot;&gt;False&lt;/property&gt;
+			      &lt;property name=&quot;xalign&quot;&gt;0.5&lt;/property&gt;
+			      &lt;property name=&quot;yalign&quot;&gt;0.5&lt;/property&gt;
+			      &lt;property name=&quot;xpad&quot;&gt;0&lt;/property&gt;
+			      &lt;property name=&quot;ypad&quot;&gt;0&lt;/property&gt;
+			      &lt;property name=&quot;ellipsize&quot;&gt;PANGO_ELLIPSIZE_NONE&lt;/property&gt;
+			      &lt;property name=&quot;width_chars&quot;&gt;-1&lt;/property&gt;
+			      &lt;property name=&quot;single_line_mode&quot;&gt;False&lt;/property&gt;
+			      &lt;property name=&quot;angle&quot;&gt;0&lt;/property&gt;
+			    &lt;/widget&gt;
+			    &lt;packing&gt;
+			      &lt;property name=&quot;type&quot;&gt;label_item&lt;/property&gt;
+			    &lt;/packing&gt;
+			  &lt;/child&gt;
+			&lt;/widget&gt;
+			&lt;packing&gt;
+			  &lt;property name=&quot;padding&quot;&gt;0&lt;/property&gt;
+			  &lt;property name=&quot;expand&quot;&gt;True&lt;/property&gt;
+			  &lt;property name=&quot;fill&quot;&gt;True&lt;/property&gt;
+			&lt;/packing&gt;
+		      &lt;/child&gt;
+
+		      &lt;child&gt;
+			&lt;widget class=&quot;GtkHSeparator&quot; id=&quot;hseparator2&quot;&gt;
+			  &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+			&lt;/widget&gt;
+			&lt;packing&gt;
+			  &lt;property name=&quot;padding&quot;&gt;0&lt;/property&gt;
+			  &lt;property name=&quot;expand&quot;&gt;True&lt;/property&gt;
+			  &lt;property name=&quot;fill&quot;&gt;True&lt;/property&gt;
+			&lt;/packing&gt;
+		      &lt;/child&gt;
+
+		      &lt;child&gt;
+			&lt;widget class=&quot;GtkLabel&quot; id=&quot;currentConfigDescription&quot;&gt;
+			  &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+			  &lt;property name=&quot;can_focus&quot;&gt;True&lt;/property&gt;
+			  &lt;property name=&quot;label&quot; translatable=&quot;yes&quot;&gt;(description of current config will go here)&lt;/property&gt;
+			  &lt;property name=&quot;use_underline&quot;&gt;False&lt;/property&gt;
+			  &lt;property name=&quot;use_markup&quot;&gt;True&lt;/property&gt;
+			  &lt;property name=&quot;justify&quot;&gt;GTK_JUSTIFY_LEFT&lt;/property&gt;
+			  &lt;property name=&quot;wrap&quot;&gt;True&lt;/property&gt;
+			  &lt;property name=&quot;selectable&quot;&gt;True&lt;/property&gt;
+			  &lt;property name=&quot;xalign&quot;&gt;0&lt;/property&gt;
+			  &lt;property name=&quot;yalign&quot;&gt;0.5&lt;/property&gt;
+			  &lt;property name=&quot;xpad&quot;&gt;0&lt;/property&gt;
+			  &lt;property name=&quot;ypad&quot;&gt;0&lt;/property&gt;
+			  &lt;property name=&quot;ellipsize&quot;&gt;PANGO_ELLIPSIZE_NONE&lt;/property&gt;
+			  &lt;property name=&quot;width_chars&quot;&gt;-1&lt;/property&gt;
+			  &lt;property name=&quot;single_line_mode&quot;&gt;False&lt;/property&gt;
+			  &lt;property name=&quot;angle&quot;&gt;0&lt;/property&gt;
+			&lt;/widget&gt;
+			&lt;packing&gt;
+			  &lt;property name=&quot;padding&quot;&gt;0&lt;/property&gt;
+			  &lt;property name=&quot;expand&quot;&gt;False&lt;/property&gt;
+			  &lt;property name=&quot;fill&quot;&gt;False&lt;/property&gt;
+			&lt;/packing&gt;
+		      &lt;/child&gt;
+
+		      &lt;child&gt;
+			&lt;widget class=&quot;GtkHSeparator&quot; id=&quot;hseparator1&quot;&gt;
+			  &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+			&lt;/widget&gt;
+			&lt;packing&gt;
+			  &lt;property name=&quot;padding&quot;&gt;0&lt;/property&gt;
+			  &lt;property name=&quot;expand&quot;&gt;True&lt;/property&gt;
+			  &lt;property name=&quot;fill&quot;&gt;True&lt;/property&gt;
+			&lt;/packing&gt;
+		      &lt;/child&gt;
+
+		      &lt;child&gt;
+			&lt;widget class=&quot;GtkHBox&quot; id=&quot;histogramHbox&quot;&gt;
+			  &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+			  &lt;property name=&quot;homogeneous&quot;&gt;False&lt;/property&gt;
+			  &lt;property name=&quot;spacing&quot;&gt;0&lt;/property&gt;
+
+			  &lt;child&gt;
+			    &lt;widget class=&quot;GtkLabel&quot; id=&quot;histogramLabel&quot;&gt;
+			      &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+			      &lt;property name=&quot;label&quot; translatable=&quot;yes&quot;&gt;_Histogram every N frames (0 to disable):   &lt;/property&gt;
+			      &lt;property name=&quot;use_underline&quot;&gt;True&lt;/property&gt;
+			      &lt;property name=&quot;use_markup&quot;&gt;False&lt;/property&gt;
+			      &lt;property name=&quot;justify&quot;&gt;GTK_JUSTIFY_LEFT&lt;/property&gt;
+			      &lt;property name=&quot;wrap&quot;&gt;False&lt;/property&gt;
+			      &lt;property name=&quot;selectable&quot;&gt;False&lt;/property&gt;
+			      &lt;property name=&quot;xalign&quot;&gt;0.5&lt;/property&gt;
+			      &lt;property name=&quot;yalign&quot;&gt;0.5&lt;/property&gt;
+			      &lt;property name=&quot;xpad&quot;&gt;0&lt;/property&gt;
+			      &lt;property name=&quot;ypad&quot;&gt;0&lt;/property&gt;
+			      &lt;property name=&quot;mnemonic_widget&quot;&gt;histogramSpinButton&lt;/property&gt;
+			      &lt;property name=&quot;ellipsize&quot;&gt;PANGO_ELLIPSIZE_NONE&lt;/property&gt;
+			      &lt;property name=&quot;width_chars&quot;&gt;-1&lt;/property&gt;
+			      &lt;property name=&quot;single_line_mode&quot;&gt;False&lt;/property&gt;
+			      &lt;property name=&quot;angle&quot;&gt;0&lt;/property&gt;
+			    &lt;/widget&gt;
+			    &lt;packing&gt;
+			      &lt;property name=&quot;padding&quot;&gt;0&lt;/property&gt;
+			      &lt;property name=&quot;expand&quot;&gt;False&lt;/property&gt;
+			      &lt;property name=&quot;fill&quot;&gt;False&lt;/property&gt;
+			    &lt;/packing&gt;
+			  &lt;/child&gt;
+
+			  &lt;child&gt;
+			    &lt;widget class=&quot;GtkSpinButton&quot; id=&quot;histogramSpinButton&quot;&gt;
+			      &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+			      &lt;property name=&quot;can_focus&quot;&gt;True&lt;/property&gt;
+			      &lt;property name=&quot;climb_rate&quot;&gt;1&lt;/property&gt;
+			      &lt;property name=&quot;digits&quot;&gt;0&lt;/property&gt;
+			      &lt;property name=&quot;numeric&quot;&gt;True&lt;/property&gt;
+			      &lt;property name=&quot;update_policy&quot;&gt;GTK_UPDATE_ALWAYS&lt;/property&gt;
+			      &lt;property name=&quot;snap_to_ticks&quot;&gt;False&lt;/property&gt;
+			      &lt;property name=&quot;wrap&quot;&gt;False&lt;/property&gt;
+			      &lt;property name=&quot;adjustment&quot;&gt;0 0 16777215 1 10 0&lt;/property&gt;
+			    &lt;/widget&gt;
+			    &lt;packing&gt;
+			      &lt;property name=&quot;padding&quot;&gt;0&lt;/property&gt;
+			      &lt;property name=&quot;expand&quot;&gt;True&lt;/property&gt;
+			      &lt;property name=&quot;fill&quot;&gt;True&lt;/property&gt;
+			    &lt;/packing&gt;
+			  &lt;/child&gt;
+			&lt;/widget&gt;
+			&lt;packing&gt;
+			  &lt;property name=&quot;padding&quot;&gt;0&lt;/property&gt;
+			  &lt;property name=&quot;expand&quot;&gt;True&lt;/property&gt;
+			  &lt;property name=&quot;fill&quot;&gt;True&lt;/property&gt;
+			&lt;/packing&gt;
+		      &lt;/child&gt;
+
+		      &lt;child&gt;
+			&lt;widget class=&quot;GtkHBox&quot; id=&quot;debugHbox&quot;&gt;
+			  &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+			  &lt;property name=&quot;homogeneous&quot;&gt;False&lt;/property&gt;
+			  &lt;property name=&quot;spacing&quot;&gt;0&lt;/property&gt;
+
+			  &lt;child&gt;
+			    &lt;widget class=&quot;GtkLabel&quot; id=&quot;debugLabel&quot;&gt;
+			      &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+			      &lt;property name=&quot;label&quot; translatable=&quot;yes&quot;&gt;_Debugging settings (bits):   &lt;/property&gt;
+			      &lt;property name=&quot;use_underline&quot;&gt;True&lt;/property&gt;
+			      &lt;property name=&quot;use_markup&quot;&gt;False&lt;/property&gt;
+			      &lt;property name=&quot;justify&quot;&gt;GTK_JUSTIFY_LEFT&lt;/property&gt;
+			      &lt;property name=&quot;wrap&quot;&gt;False&lt;/property&gt;
+			      &lt;property name=&quot;selectable&quot;&gt;False&lt;/property&gt;
+			      &lt;property name=&quot;xalign&quot;&gt;0.5&lt;/property&gt;
+			      &lt;property name=&quot;yalign&quot;&gt;0.5&lt;/property&gt;
+			      &lt;property name=&quot;xpad&quot;&gt;0&lt;/property&gt;
+			      &lt;property name=&quot;ypad&quot;&gt;0&lt;/property&gt;
+			      &lt;property name=&quot;mnemonic_widget&quot;&gt;debugSpinButton&lt;/property&gt;
+			      &lt;property name=&quot;ellipsize&quot;&gt;PANGO_ELLIPSIZE_NONE&lt;/property&gt;
+			      &lt;property name=&quot;width_chars&quot;&gt;-1&lt;/property&gt;
+			      &lt;property name=&quot;single_line_mode&quot;&gt;False&lt;/property&gt;
+			      &lt;property name=&quot;angle&quot;&gt;0&lt;/property&gt;
+			    &lt;/widget&gt;
+			    &lt;packing&gt;
+			      &lt;property name=&quot;padding&quot;&gt;0&lt;/property&gt;
+			      &lt;property name=&quot;expand&quot;&gt;False&lt;/property&gt;
+			      &lt;property name=&quot;fill&quot;&gt;False&lt;/property&gt;
+			    &lt;/packing&gt;
+			  &lt;/child&gt;
+
+			  &lt;child&gt;
+			    &lt;widget class=&quot;GtkSpinButton&quot; id=&quot;debugSpinButton&quot;&gt;
+			      &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+			      &lt;property name=&quot;can_focus&quot;&gt;True&lt;/property&gt;
+			      &lt;property name=&quot;climb_rate&quot;&gt;1&lt;/property&gt;
+			      &lt;property name=&quot;digits&quot;&gt;0&lt;/property&gt;
+			      &lt;property name=&quot;numeric&quot;&gt;True&lt;/property&gt;
+			      &lt;property name=&quot;update_policy&quot;&gt;GTK_UPDATE_ALWAYS&lt;/property&gt;
+			      &lt;property name=&quot;snap_to_ticks&quot;&gt;False&lt;/property&gt;
+			      &lt;property name=&quot;wrap&quot;&gt;False&lt;/property&gt;
+			      &lt;property name=&quot;adjustment&quot;&gt;0 0 16777215 1 10 0&lt;/property&gt;
+			    &lt;/widget&gt;
+			    &lt;packing&gt;
+			      &lt;property name=&quot;padding&quot;&gt;0&lt;/property&gt;
+			      &lt;property name=&quot;expand&quot;&gt;True&lt;/property&gt;
+			      &lt;property name=&quot;fill&quot;&gt;True&lt;/property&gt;
+			    &lt;/packing&gt;
+			  &lt;/child&gt;
+			&lt;/widget&gt;
+			&lt;packing&gt;
+			  &lt;property name=&quot;padding&quot;&gt;0&lt;/property&gt;
+			  &lt;property name=&quot;expand&quot;&gt;True&lt;/property&gt;
+			  &lt;property name=&quot;fill&quot;&gt;True&lt;/property&gt;
+			&lt;/packing&gt;
+		      &lt;/child&gt;
+		    &lt;/widget&gt;
+		    &lt;packing&gt;
+		      &lt;property name=&quot;padding&quot;&gt;0&lt;/property&gt;
+		      &lt;property name=&quot;expand&quot;&gt;True&lt;/property&gt;
+		      &lt;property name=&quot;fill&quot;&gt;True&lt;/property&gt;
+		    &lt;/packing&gt;
+		  &lt;/child&gt;
+		&lt;/widget&gt;
+		&lt;packing&gt;
+		  &lt;property name=&quot;padding&quot;&gt;0&lt;/property&gt;
+		  &lt;property name=&quot;expand&quot;&gt;False&lt;/property&gt;
+		  &lt;property name=&quot;fill&quot;&gt;True&lt;/property&gt;
+		&lt;/packing&gt;
+	      &lt;/child&gt;
+	    &lt;/widget&gt;
+	    &lt;packing&gt;
+	      &lt;property name=&quot;padding&quot;&gt;0&lt;/property&gt;
+	      &lt;property name=&quot;expand&quot;&gt;True&lt;/property&gt;
+	      &lt;property name=&quot;fill&quot;&gt;True&lt;/property&gt;
+	    &lt;/packing&gt;
+	  &lt;/child&gt;
+
+	  &lt;child&gt;
+	    &lt;widget class=&quot;GtkVBox&quot; id=&quot;previewVboxOuter&quot;&gt;
+	      &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+	      &lt;property name=&quot;homogeneous&quot;&gt;False&lt;/property&gt;
+	      &lt;property name=&quot;spacing&quot;&gt;0&lt;/property&gt;
+
+	      &lt;child&gt;
+		&lt;widget class=&quot;GtkFrame&quot; id=&quot;previewFrame&quot;&gt;
+		  &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+		  &lt;property name=&quot;label_xalign&quot;&gt;0&lt;/property&gt;
+		  &lt;property name=&quot;label_yalign&quot;&gt;0.5&lt;/property&gt;
+		  &lt;property name=&quot;shadow_type&quot;&gt;GTK_SHADOW_ETCHED_IN&lt;/property&gt;
+
+		  &lt;child&gt;
+		    &lt;widget class=&quot;GtkAlignment&quot; id=&quot;previewAlignment&quot;&gt;
+		      &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+		      &lt;property name=&quot;xalign&quot;&gt;0.5&lt;/property&gt;
+		      &lt;property name=&quot;yalign&quot;&gt;0.5&lt;/property&gt;
+		      &lt;property name=&quot;xscale&quot;&gt;1&lt;/property&gt;
+		      &lt;property name=&quot;yscale&quot;&gt;1&lt;/property&gt;
+		      &lt;property name=&quot;top_padding&quot;&gt;0&lt;/property&gt;
+		      &lt;property name=&quot;bottom_padding&quot;&gt;8&lt;/property&gt;
+		      &lt;property name=&quot;left_padding&quot;&gt;6&lt;/property&gt;
+		      &lt;property name=&quot;right_padding&quot;&gt;8&lt;/property&gt;
+
+		      &lt;child&gt;
+			&lt;widget class=&quot;GtkVBox&quot; id=&quot;previewVbox&quot;&gt;
+			  &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+			  &lt;property name=&quot;homogeneous&quot;&gt;False&lt;/property&gt;
+			  &lt;property name=&quot;spacing&quot;&gt;5&lt;/property&gt;
+
+			  &lt;child&gt;
+			    &lt;widget class=&quot;GtkHBox&quot; id=&quot;previewControlHbox&quot;&gt;
+			      &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+			      &lt;property name=&quot;homogeneous&quot;&gt;False&lt;/property&gt;
+			      &lt;property name=&quot;spacing&quot;&gt;5&lt;/property&gt;
+
+			      &lt;child&gt;
+				&lt;widget class=&quot;GtkComboBox&quot; id=&quot;previewOutputMenu&quot;&gt;
+				  &lt;property name=&quot;items&quot; translatable=&quot;yes&quot;&gt;Swiss Army Knife output
+Final output&lt;/property&gt;
+				  &lt;property name=&quot;add_tearoffs&quot;&gt;False&lt;/property&gt;
+				  &lt;property name=&quot;focus_on_click&quot;&gt;True&lt;/property&gt;
+				&lt;/widget&gt;
+				&lt;packing&gt;
+				  &lt;property name=&quot;padding&quot;&gt;0&lt;/property&gt;
+				  &lt;property name=&quot;expand&quot;&gt;False&lt;/property&gt;
+				  &lt;property name=&quot;fill&quot;&gt;True&lt;/property&gt;
+				&lt;/packing&gt;
+			      &lt;/child&gt;
+
+			      &lt;child&gt;
+				&lt;widget class=&quot;GtkHScale&quot; id=&quot;previewSlider&quot;&gt;
+				  &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+				  &lt;property name=&quot;can_focus&quot;&gt;True&lt;/property&gt;
+				  &lt;property name=&quot;draw_value&quot;&gt;True&lt;/property&gt;
+				  &lt;property name=&quot;value_pos&quot;&gt;GTK_POS_TOP&lt;/property&gt;
+				  &lt;property name=&quot;digits&quot;&gt;0&lt;/property&gt;
+				  &lt;property name=&quot;update_policy&quot;&gt;GTK_UPDATE_CONTINUOUS&lt;/property&gt;
+				  &lt;property name=&quot;inverted&quot;&gt;False&lt;/property&gt;
+				  &lt;property name=&quot;adjustment&quot;&gt;0 0 99 1 1 0&lt;/property&gt;
+				&lt;/widget&gt;
+				&lt;packing&gt;
+				  &lt;property name=&quot;padding&quot;&gt;0&lt;/property&gt;
+				  &lt;property name=&quot;expand&quot;&gt;True&lt;/property&gt;
+				  &lt;property name=&quot;fill&quot;&gt;True&lt;/property&gt;
+				&lt;/packing&gt;
+			      &lt;/child&gt;
+			    &lt;/widget&gt;
+			    &lt;packing&gt;
+			      &lt;property name=&quot;padding&quot;&gt;0&lt;/property&gt;
+			      &lt;property name=&quot;expand&quot;&gt;True&lt;/property&gt;
+			      &lt;property name=&quot;fill&quot;&gt;True&lt;/property&gt;
+			    &lt;/packing&gt;
+			  &lt;/child&gt;
+
+			  &lt;child&gt;
+			    &lt;widget class=&quot;GtkDrawingArea&quot; id=&quot;previewVideo&quot;&gt;
+			      &lt;property name=&quot;height_request&quot;&gt;300&lt;/property&gt;
+			      &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+			      &lt;property name=&quot;events&quot;&gt;GDK_BUTTON1_MOTION_MASK | GDK_BUTTON_PRESS_MASK&lt;/property&gt;
+			    &lt;/widget&gt;
+			    &lt;packing&gt;
+			      &lt;property name=&quot;padding&quot;&gt;0&lt;/property&gt;
+			      &lt;property name=&quot;expand&quot;&gt;True&lt;/property&gt;
+			      &lt;property name=&quot;fill&quot;&gt;True&lt;/property&gt;
+			    &lt;/packing&gt;
+			  &lt;/child&gt;
+
+			  &lt;child&gt;
+			    &lt;widget class=&quot;GtkDrawingArea&quot; id=&quot;previewDisabled&quot;&gt;
+			    &lt;/widget&gt;
+			    &lt;packing&gt;
+			      &lt;property name=&quot;padding&quot;&gt;0&lt;/property&gt;
+			      &lt;property name=&quot;expand&quot;&gt;True&lt;/property&gt;
+			      &lt;property name=&quot;fill&quot;&gt;True&lt;/property&gt;
+			    &lt;/packing&gt;
+			  &lt;/child&gt;
+			&lt;/widget&gt;
+		      &lt;/child&gt;
+		    &lt;/widget&gt;
+		  &lt;/child&gt;
+
+		  &lt;child&gt;
+		    &lt;widget class=&quot;GtkLabel&quot; id=&quot;previewLabel&quot;&gt;
+		      &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+		      &lt;property name=&quot;label&quot; translatable=&quot;yes&quot;&gt;Preview&lt;/property&gt;
+		      &lt;property name=&quot;use_underline&quot;&gt;False&lt;/property&gt;
+		      &lt;property name=&quot;use_markup&quot;&gt;False&lt;/property&gt;
+		      &lt;property name=&quot;justify&quot;&gt;GTK_JUSTIFY_LEFT&lt;/property&gt;
+		      &lt;property name=&quot;wrap&quot;&gt;False&lt;/property&gt;
+		      &lt;property name=&quot;selectable&quot;&gt;False&lt;/property&gt;
+		      &lt;property name=&quot;xalign&quot;&gt;0.5&lt;/property&gt;
+		      &lt;property name=&quot;yalign&quot;&gt;0.5&lt;/property&gt;
+		      &lt;property name=&quot;xpad&quot;&gt;0&lt;/property&gt;
+		      &lt;property name=&quot;ypad&quot;&gt;0&lt;/property&gt;
+		      &lt;property name=&quot;ellipsize&quot;&gt;PANGO_ELLIPSIZE_NONE&lt;/property&gt;
+		      &lt;property name=&quot;width_chars&quot;&gt;-1&lt;/property&gt;
+		      &lt;property name=&quot;single_line_mode&quot;&gt;False&lt;/property&gt;
+		      &lt;property name=&quot;angle&quot;&gt;0&lt;/property&gt;
+		    &lt;/widget&gt;
+		    &lt;packing&gt;
+		      &lt;property name=&quot;type&quot;&gt;label_item&lt;/property&gt;
+		    &lt;/packing&gt;
+		  &lt;/child&gt;
+		&lt;/widget&gt;
+		&lt;packing&gt;
+		  &lt;property name=&quot;padding&quot;&gt;0&lt;/property&gt;
+		  &lt;property name=&quot;expand&quot;&gt;False&lt;/property&gt;
+		  &lt;property name=&quot;fill&quot;&gt;True&lt;/property&gt;
+		&lt;/packing&gt;
+	      &lt;/child&gt;
+
+	      &lt;child&gt;
+		&lt;widget class=&quot;GtkHBox&quot; id=&quot;previewEnableButtonHbox&quot;&gt;
+		  &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+		  &lt;property name=&quot;homogeneous&quot;&gt;False&lt;/property&gt;
+		  &lt;property name=&quot;spacing&quot;&gt;0&lt;/property&gt;
+
+		  &lt;child&gt;
+		    &lt;widget class=&quot;GtkToggleButton&quot; id=&quot;previewEnableButton&quot;&gt;
+		      &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+		      &lt;property name=&quot;can_focus&quot;&gt;True&lt;/property&gt;
+		      &lt;property name=&quot;label&quot; translatable=&quot;yes&quot;&gt;Enable Preview&lt;/property&gt;
+		      &lt;property name=&quot;use_underline&quot;&gt;True&lt;/property&gt;
+		      &lt;property name=&quot;relief&quot;&gt;GTK_RELIEF_NORMAL&lt;/property&gt;
+		      &lt;property name=&quot;focus_on_click&quot;&gt;True&lt;/property&gt;
+		      &lt;property name=&quot;active&quot;&gt;False&lt;/property&gt;
+		      &lt;property name=&quot;inconsistent&quot;&gt;False&lt;/property&gt;
+		    &lt;/widget&gt;
+		    &lt;packing&gt;
+		      &lt;property name=&quot;padding&quot;&gt;0&lt;/property&gt;
+		      &lt;property name=&quot;expand&quot;&gt;False&lt;/property&gt;
+		      &lt;property name=&quot;fill&quot;&gt;False&lt;/property&gt;
+		      &lt;property name=&quot;pack_type&quot;&gt;GTK_PACK_END&lt;/property&gt;
+		    &lt;/packing&gt;
+		  &lt;/child&gt;
+		&lt;/widget&gt;
+		&lt;packing&gt;
+		  &lt;property name=&quot;padding&quot;&gt;5&lt;/property&gt;
+		  &lt;property name=&quot;expand&quot;&gt;False&lt;/property&gt;
+		  &lt;property name=&quot;fill&quot;&gt;True&lt;/property&gt;
+		&lt;/packing&gt;
+	      &lt;/child&gt;
+	    &lt;/widget&gt;
+	    &lt;packing&gt;
+	      &lt;property name=&quot;padding&quot;&gt;0&lt;/property&gt;
+	      &lt;property name=&quot;expand&quot;&gt;False&lt;/property&gt;
+	      &lt;property name=&quot;fill&quot;&gt;True&lt;/property&gt;
+	    &lt;/packing&gt;
+	  &lt;/child&gt;
+	&lt;/widget&gt;
+	&lt;packing&gt;
+	  &lt;property name=&quot;padding&quot;&gt;0&lt;/property&gt;
+	  &lt;property name=&quot;expand&quot;&gt;True&lt;/property&gt;
+	  &lt;property name=&quot;fill&quot;&gt;True&lt;/property&gt;
+	&lt;/packing&gt;
+      &lt;/child&gt;
+    &lt;/widget&gt;
+  &lt;/child&gt;
+&lt;/widget&gt;
+
+&lt;/glade-interface&gt;

Added: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/glade/threshold.glade
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/glade/threshold.glade	2007-09-30 16:29:29 UTC (rev 3607)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_GTK/glade/threshold.glade	2007-09-30 16:49:31 UTC (rev 3608)
@@ -0,0 +1,513 @@
+&lt;?xml version=&quot;1.0&quot; standalone=&quot;no&quot;?&gt; &lt;!--*- mode: xml -*--&gt;
+&lt;!DOCTYPE glade-interface SYSTEM &quot;<A HREF="http://glade.gnome.org/glade-2.0.dtd">http://glade.gnome.org/glade-2.0.dtd</A>&quot;&gt;
+
+&lt;glade-interface&gt;
+
+&lt;widget class=&quot;GtkDialog&quot; id=&quot;threshold_dialog&quot;&gt;
+  &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+  &lt;property name=&quot;title&quot; translatable=&quot;yes&quot;&gt;Threshold&lt;/property&gt;
+  &lt;property name=&quot;type&quot;&gt;GTK_WINDOW_TOPLEVEL&lt;/property&gt;
+  &lt;property name=&quot;window_position&quot;&gt;GTK_WIN_POS_NONE&lt;/property&gt;
+  &lt;property name=&quot;modal&quot;&gt;False&lt;/property&gt;
+  &lt;property name=&quot;resizable&quot;&gt;True&lt;/property&gt;
+  &lt;property name=&quot;destroy_with_parent&quot;&gt;False&lt;/property&gt;
+  &lt;property name=&quot;decorated&quot;&gt;True&lt;/property&gt;
+  &lt;property name=&quot;skip_taskbar_hint&quot;&gt;False&lt;/property&gt;
+  &lt;property name=&quot;skip_pager_hint&quot;&gt;False&lt;/property&gt;
+  &lt;property name=&quot;type_hint&quot;&gt;GDK_WINDOW_TYPE_HINT_DIALOG&lt;/property&gt;
+  &lt;property name=&quot;gravity&quot;&gt;GDK_GRAVITY_NORTH_WEST&lt;/property&gt;
+  &lt;property name=&quot;focus_on_map&quot;&gt;True&lt;/property&gt;
+  &lt;property name=&quot;urgency_hint&quot;&gt;False&lt;/property&gt;
+  &lt;property name=&quot;has_separator&quot;&gt;True&lt;/property&gt;
+
+  &lt;child internal-child=&quot;vbox&quot;&gt;
+    &lt;widget class=&quot;GtkVBox&quot; id=&quot;dialogVbox&quot;&gt;
+      &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+      &lt;property name=&quot;homogeneous&quot;&gt;False&lt;/property&gt;
+      &lt;property name=&quot;spacing&quot;&gt;0&lt;/property&gt;
+
+      &lt;child internal-child=&quot;action_area&quot;&gt;
+	&lt;widget class=&quot;GtkHButtonBox&quot; id=&quot;dialogButtonBox&quot;&gt;
+	  &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+	  &lt;property name=&quot;layout_style&quot;&gt;GTK_BUTTONBOX_END&lt;/property&gt;
+
+	  &lt;child&gt;
+	    &lt;widget class=&quot;GtkButton&quot; id=&quot;cancelButton&quot;&gt;
+	      &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+	      &lt;property name=&quot;can_default&quot;&gt;True&lt;/property&gt;
+	      &lt;property name=&quot;can_focus&quot;&gt;True&lt;/property&gt;
+	      &lt;property name=&quot;label&quot;&gt;gtk-cancel&lt;/property&gt;
+	      &lt;property name=&quot;use_stock&quot;&gt;True&lt;/property&gt;
+	      &lt;property name=&quot;relief&quot;&gt;GTK_RELIEF_NORMAL&lt;/property&gt;
+	      &lt;property name=&quot;focus_on_click&quot;&gt;True&lt;/property&gt;
+	      &lt;property name=&quot;response_id&quot;&gt;-6&lt;/property&gt;
+	    &lt;/widget&gt;
+	  &lt;/child&gt;
+
+	  &lt;child&gt;
+	    &lt;widget class=&quot;GtkButton&quot; id=&quot;okButton&quot;&gt;
+	      &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+	      &lt;property name=&quot;can_default&quot;&gt;True&lt;/property&gt;
+	      &lt;property name=&quot;can_focus&quot;&gt;True&lt;/property&gt;
+	      &lt;property name=&quot;label&quot;&gt;gtk-ok&lt;/property&gt;
+	      &lt;property name=&quot;use_stock&quot;&gt;True&lt;/property&gt;
+	      &lt;property name=&quot;relief&quot;&gt;GTK_RELIEF_NORMAL&lt;/property&gt;
+	      &lt;property name=&quot;focus_on_click&quot;&gt;True&lt;/property&gt;
+	      &lt;property name=&quot;response_id&quot;&gt;-5&lt;/property&gt;
+	    &lt;/widget&gt;
+	  &lt;/child&gt;
+	&lt;/widget&gt;
+	&lt;packing&gt;
+	  &lt;property name=&quot;padding&quot;&gt;0&lt;/property&gt;
+	  &lt;property name=&quot;expand&quot;&gt;False&lt;/property&gt;
+	  &lt;property name=&quot;fill&quot;&gt;True&lt;/property&gt;
+	  &lt;property name=&quot;pack_type&quot;&gt;GTK_PACK_END&lt;/property&gt;
+	&lt;/packing&gt;
+      &lt;/child&gt;
+
+      &lt;child&gt;
+	&lt;widget class=&quot;GtkVBox&quot; id=&quot;allButButtonsVbox&quot;&gt;
+	  &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+	  &lt;property name=&quot;homogeneous&quot;&gt;False&lt;/property&gt;
+	  &lt;property name=&quot;spacing&quot;&gt;12&lt;/property&gt;
+
+	  &lt;child&gt;
+	    &lt;widget class=&quot;GtkHBox&quot; id=&quot;settingsOuterHbox&quot;&gt;
+	      &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+	      &lt;property name=&quot;homogeneous&quot;&gt;False&lt;/property&gt;
+	      &lt;property name=&quot;spacing&quot;&gt;0&lt;/property&gt;
+
+	      &lt;child&gt;
+		&lt;widget class=&quot;GtkVBox&quot; id=&quot;settingsOuterVbox&quot;&gt;
+		  &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+		  &lt;property name=&quot;homogeneous&quot;&gt;False&lt;/property&gt;
+		  &lt;property name=&quot;spacing&quot;&gt;12&lt;/property&gt;
+
+		  &lt;child&gt;
+		    &lt;widget class=&quot;GtkVBox&quot; id=&quot;minValueVbox&quot;&gt;
+		      &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+		      &lt;property name=&quot;homogeneous&quot;&gt;False&lt;/property&gt;
+		      &lt;property name=&quot;spacing&quot;&gt;0&lt;/property&gt;
+
+		      &lt;child&gt;
+			&lt;widget class=&quot;GtkLabel&quot; id=&quot;minValueLabel&quot;&gt;
+			  &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+			  &lt;property name=&quot;label&quot; translatable=&quot;yes&quot;&gt;Minimum value to be in-range:&lt;/property&gt;
+			  &lt;property name=&quot;use_underline&quot;&gt;False&lt;/property&gt;
+			  &lt;property name=&quot;use_markup&quot;&gt;False&lt;/property&gt;
+			  &lt;property name=&quot;justify&quot;&gt;GTK_JUSTIFY_LEFT&lt;/property&gt;
+			  &lt;property name=&quot;wrap&quot;&gt;False&lt;/property&gt;
+			  &lt;property name=&quot;selectable&quot;&gt;False&lt;/property&gt;
+			  &lt;property name=&quot;xalign&quot;&gt;0.5&lt;/property&gt;
+			  &lt;property name=&quot;yalign&quot;&gt;1&lt;/property&gt;
+			  &lt;property name=&quot;xpad&quot;&gt;0&lt;/property&gt;
+			  &lt;property name=&quot;ypad&quot;&gt;8&lt;/property&gt;
+			  &lt;property name=&quot;ellipsize&quot;&gt;PANGO_ELLIPSIZE_NONE&lt;/property&gt;
+			  &lt;property name=&quot;width_chars&quot;&gt;-1&lt;/property&gt;
+			  &lt;property name=&quot;single_line_mode&quot;&gt;False&lt;/property&gt;
+			  &lt;property name=&quot;angle&quot;&gt;0&lt;/property&gt;
+			&lt;/widget&gt;
+			&lt;packing&gt;
+			  &lt;property name=&quot;padding&quot;&gt;0&lt;/property&gt;
+			  &lt;property name=&quot;expand&quot;&gt;False&lt;/property&gt;
+			  &lt;property name=&quot;fill&quot;&gt;False&lt;/property&gt;
+			&lt;/packing&gt;
+		      &lt;/child&gt;
+
+		      &lt;child&gt;
+			&lt;widget class=&quot;GtkHBox&quot; id=&quot;minValueHbox&quot;&gt;
+			  &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+			  &lt;property name=&quot;homogeneous&quot;&gt;False&lt;/property&gt;
+			  &lt;property name=&quot;spacing&quot;&gt;5&lt;/property&gt;
+
+			  &lt;child&gt;
+			    &lt;widget class=&quot;GtkHScale&quot; id=&quot;minValueSlider&quot;&gt;
+			      &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+			      &lt;property name=&quot;can_focus&quot;&gt;True&lt;/property&gt;
+			      &lt;property name=&quot;draw_value&quot;&gt;False&lt;/property&gt;
+			      &lt;property name=&quot;value_pos&quot;&gt;GTK_POS_LEFT&lt;/property&gt;
+			      &lt;property name=&quot;digits&quot;&gt;0&lt;/property&gt;
+			      &lt;property name=&quot;update_policy&quot;&gt;GTK_UPDATE_CONTINUOUS&lt;/property&gt;
+			      &lt;property name=&quot;inverted&quot;&gt;False&lt;/property&gt;
+			      &lt;property name=&quot;adjustment&quot;&gt;0 0 255 1 1 0&lt;/property&gt;
+			    &lt;/widget&gt;
+			    &lt;packing&gt;
+			      &lt;property name=&quot;padding&quot;&gt;0&lt;/property&gt;
+			      &lt;property name=&quot;expand&quot;&gt;True&lt;/property&gt;
+			      &lt;property name=&quot;fill&quot;&gt;True&lt;/property&gt;
+			    &lt;/packing&gt;
+			  &lt;/child&gt;
+
+			  &lt;child&gt;
+			    &lt;widget class=&quot;GtkSpinButton&quot; id=&quot;minValueSpinner&quot;&gt;
+			      &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+			      &lt;property name=&quot;can_focus&quot;&gt;True&lt;/property&gt;
+			      &lt;property name=&quot;climb_rate&quot;&gt;1&lt;/property&gt;
+			      &lt;property name=&quot;digits&quot;&gt;0&lt;/property&gt;
+			      &lt;property name=&quot;numeric&quot;&gt;False&lt;/property&gt;
+			      &lt;property name=&quot;update_policy&quot;&gt;GTK_UPDATE_ALWAYS&lt;/property&gt;
+			      &lt;property name=&quot;snap_to_ticks&quot;&gt;False&lt;/property&gt;
+			      &lt;property name=&quot;wrap&quot;&gt;False&lt;/property&gt;
+			      &lt;property name=&quot;adjustment&quot;&gt;0 0 255 1 10 10&lt;/property&gt;
+			    &lt;/widget&gt;
+			    &lt;packing&gt;
+			      &lt;property name=&quot;padding&quot;&gt;0&lt;/property&gt;
+			      &lt;property name=&quot;expand&quot;&gt;False&lt;/property&gt;
+			      &lt;property name=&quot;fill&quot;&gt;True&lt;/property&gt;
+			    &lt;/packing&gt;
+			  &lt;/child&gt;
+			&lt;/widget&gt;
+			&lt;packing&gt;
+			  &lt;property name=&quot;padding&quot;&gt;0&lt;/property&gt;
+			  &lt;property name=&quot;expand&quot;&gt;True&lt;/property&gt;
+			  &lt;property name=&quot;fill&quot;&gt;True&lt;/property&gt;
+			&lt;/packing&gt;
+		      &lt;/child&gt;
+		    &lt;/widget&gt;
+		    &lt;packing&gt;
+		      &lt;property name=&quot;padding&quot;&gt;0&lt;/property&gt;
+		      &lt;property name=&quot;expand&quot;&gt;False&lt;/property&gt;
+		      &lt;property name=&quot;fill&quot;&gt;False&lt;/property&gt;
+		    &lt;/packing&gt;
+		  &lt;/child&gt;
+
+		  &lt;child&gt;
+		    &lt;widget class=&quot;GtkVBox&quot; id=&quot;maxValueVbox&quot;&gt;
+		      &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+		      &lt;property name=&quot;homogeneous&quot;&gt;False&lt;/property&gt;
+		      &lt;property name=&quot;spacing&quot;&gt;0&lt;/property&gt;
+
+		      &lt;child&gt;
+			&lt;widget class=&quot;GtkLabel&quot; id=&quot;maxValueLabel&quot;&gt;
+			  &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+			  &lt;property name=&quot;label&quot; translatable=&quot;yes&quot;&gt;Maximum value to be in-range:&lt;/property&gt;
+			  &lt;property name=&quot;use_underline&quot;&gt;False&lt;/property&gt;
+			  &lt;property name=&quot;use_markup&quot;&gt;False&lt;/property&gt;
+			  &lt;property name=&quot;justify&quot;&gt;GTK_JUSTIFY_LEFT&lt;/property&gt;
+			  &lt;property name=&quot;wrap&quot;&gt;False&lt;/property&gt;
+			  &lt;property name=&quot;selectable&quot;&gt;False&lt;/property&gt;
+			  &lt;property name=&quot;xalign&quot;&gt;0.5&lt;/property&gt;
+			  &lt;property name=&quot;yalign&quot;&gt;0.5&lt;/property&gt;
+			  &lt;property name=&quot;xpad&quot;&gt;0&lt;/property&gt;
+			  &lt;property name=&quot;ypad&quot;&gt;0&lt;/property&gt;
+			  &lt;property name=&quot;ellipsize&quot;&gt;PANGO_ELLIPSIZE_NONE&lt;/property&gt;
+			  &lt;property name=&quot;width_chars&quot;&gt;-1&lt;/property&gt;
+			  &lt;property name=&quot;single_line_mode&quot;&gt;False&lt;/property&gt;
+			  &lt;property name=&quot;angle&quot;&gt;0&lt;/property&gt;
+			&lt;/widget&gt;
+			&lt;packing&gt;
+			  &lt;property name=&quot;padding&quot;&gt;0&lt;/property&gt;
+			  &lt;property name=&quot;expand&quot;&gt;False&lt;/property&gt;
+			  &lt;property name=&quot;fill&quot;&gt;False&lt;/property&gt;
+			&lt;/packing&gt;
+		      &lt;/child&gt;
+
+		      &lt;child&gt;
+			&lt;widget class=&quot;GtkHBox&quot; id=&quot;maxValueHbox&quot;&gt;
+			  &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+			  &lt;property name=&quot;homogeneous&quot;&gt;False&lt;/property&gt;
+			  &lt;property name=&quot;spacing&quot;&gt;5&lt;/property&gt;
+
+			  &lt;child&gt;
+			    &lt;widget class=&quot;GtkHScale&quot; id=&quot;maxValueSlider&quot;&gt;
+			      &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+			      &lt;property name=&quot;can_focus&quot;&gt;True&lt;/property&gt;
+			      &lt;property name=&quot;draw_value&quot;&gt;False&lt;/property&gt;
+			      &lt;property name=&quot;value_pos&quot;&gt;GTK_POS_LEFT&lt;/property&gt;
+			      &lt;property name=&quot;digits&quot;&gt;0&lt;/property&gt;
+			      &lt;property name=&quot;update_policy&quot;&gt;GTK_UPDATE_CONTINUOUS&lt;/property&gt;
+			      &lt;property name=&quot;inverted&quot;&gt;False&lt;/property&gt;
+			      &lt;property name=&quot;adjustment&quot;&gt;255 0 255 1 1 0&lt;/property&gt;
+			    &lt;/widget&gt;
+			    &lt;packing&gt;
+			      &lt;property name=&quot;padding&quot;&gt;0&lt;/property&gt;
+			      &lt;property name=&quot;expand&quot;&gt;True&lt;/property&gt;
+			      &lt;property name=&quot;fill&quot;&gt;True&lt;/property&gt;
+			    &lt;/packing&gt;
+			  &lt;/child&gt;
+
+			  &lt;child&gt;
+			    &lt;widget class=&quot;GtkSpinButton&quot; id=&quot;maxValueSpinner&quot;&gt;
+			      &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+			      &lt;property name=&quot;can_focus&quot;&gt;True&lt;/property&gt;
+			      &lt;property name=&quot;climb_rate&quot;&gt;1&lt;/property&gt;
+			      &lt;property name=&quot;digits&quot;&gt;0&lt;/property&gt;
+			      &lt;property name=&quot;numeric&quot;&gt;False&lt;/property&gt;
+			      &lt;property name=&quot;update_policy&quot;&gt;GTK_UPDATE_ALWAYS&lt;/property&gt;
+			      &lt;property name=&quot;snap_to_ticks&quot;&gt;False&lt;/property&gt;
+			      &lt;property name=&quot;wrap&quot;&gt;False&lt;/property&gt;
+			      &lt;property name=&quot;adjustment&quot;&gt;255 0 255 1 10 10&lt;/property&gt;
+			    &lt;/widget&gt;
+			    &lt;packing&gt;
+			      &lt;property name=&quot;padding&quot;&gt;0&lt;/property&gt;
+			      &lt;property name=&quot;expand&quot;&gt;False&lt;/property&gt;
+			      &lt;property name=&quot;fill&quot;&gt;True&lt;/property&gt;
+			    &lt;/packing&gt;
+			  &lt;/child&gt;
+			&lt;/widget&gt;
+			&lt;packing&gt;
+			  &lt;property name=&quot;padding&quot;&gt;0&lt;/property&gt;
+			  &lt;property name=&quot;expand&quot;&gt;True&lt;/property&gt;
+			  &lt;property name=&quot;fill&quot;&gt;True&lt;/property&gt;
+			&lt;/packing&gt;
+		      &lt;/child&gt;
+		    &lt;/widget&gt;
+		    &lt;packing&gt;
+		      &lt;property name=&quot;padding&quot;&gt;0&lt;/property&gt;
+		      &lt;property name=&quot;expand&quot;&gt;False&lt;/property&gt;
+		      &lt;property name=&quot;fill&quot;&gt;False&lt;/property&gt;
+		    &lt;/packing&gt;
+		  &lt;/child&gt;
+
+		  &lt;child&gt;
+		    &lt;widget class=&quot;GtkHBox&quot; id=&quot;outputValuesHbox&quot;&gt;
+		      &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+		      &lt;property name=&quot;homogeneous&quot;&gt;False&lt;/property&gt;
+		      &lt;property name=&quot;spacing&quot;&gt;0&lt;/property&gt;
+
+		      &lt;child&gt;
+			&lt;widget class=&quot;GtkLabel&quot; id=&quot;outputValuesLabel&quot;&gt;
+			  &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+			  &lt;property name=&quot;label&quot; translatable=&quot;yes&quot;&gt;Output values:   &lt;/property&gt;
+			  &lt;property name=&quot;use_underline&quot;&gt;False&lt;/property&gt;
+			  &lt;property name=&quot;use_markup&quot;&gt;False&lt;/property&gt;
+			  &lt;property name=&quot;justify&quot;&gt;GTK_JUSTIFY_LEFT&lt;/property&gt;
+			  &lt;property name=&quot;wrap&quot;&gt;False&lt;/property&gt;
+			  &lt;property name=&quot;selectable&quot;&gt;False&lt;/property&gt;
+			  &lt;property name=&quot;xalign&quot;&gt;0.5&lt;/property&gt;
+			  &lt;property name=&quot;yalign&quot;&gt;0.5&lt;/property&gt;
+			  &lt;property name=&quot;xpad&quot;&gt;0&lt;/property&gt;
+			  &lt;property name=&quot;ypad&quot;&gt;0&lt;/property&gt;
+			  &lt;property name=&quot;ellipsize&quot;&gt;PANGO_ELLIPSIZE_NONE&lt;/property&gt;
+			  &lt;property name=&quot;width_chars&quot;&gt;-1&lt;/property&gt;
+			  &lt;property name=&quot;single_line_mode&quot;&gt;False&lt;/property&gt;
+			  &lt;property name=&quot;angle&quot;&gt;0&lt;/property&gt;
+			&lt;/widget&gt;
+			&lt;packing&gt;
+			  &lt;property name=&quot;padding&quot;&gt;0&lt;/property&gt;
+			  &lt;property name=&quot;expand&quot;&gt;False&lt;/property&gt;
+			  &lt;property name=&quot;fill&quot;&gt;False&lt;/property&gt;
+			&lt;/packing&gt;
+		      &lt;/child&gt;
+
+		      &lt;child&gt;
+			&lt;widget class=&quot;GtkComboBox&quot; id=&quot;outputValuesMenu&quot;&gt;
+			  &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+			  &lt;property name=&quot;items&quot; translatable=&quot;yes&quot;&gt;In-range values go black, out-of-range values go white
+In-range values go white, out-of-range values go black&lt;/property&gt;
+			  &lt;property name=&quot;add_tearoffs&quot;&gt;False&lt;/property&gt;
+			  &lt;property name=&quot;focus_on_click&quot;&gt;True&lt;/property&gt;
+			&lt;/widget&gt;
+			&lt;packing&gt;
+			  &lt;property name=&quot;padding&quot;&gt;0&lt;/property&gt;
+			  &lt;property name=&quot;expand&quot;&gt;True&lt;/property&gt;
+			  &lt;property name=&quot;fill&quot;&gt;True&lt;/property&gt;
+			&lt;/packing&gt;
+		      &lt;/child&gt;
+		    &lt;/widget&gt;
+		    &lt;packing&gt;
+		      &lt;property name=&quot;padding&quot;&gt;0&lt;/property&gt;
+		      &lt;property name=&quot;expand&quot;&gt;True&lt;/property&gt;
+		      &lt;property name=&quot;fill&quot;&gt;True&lt;/property&gt;
+		    &lt;/packing&gt;
+		  &lt;/child&gt;
+
+		  &lt;child&gt;
+		    &lt;widget class=&quot;GtkHBox&quot; id=&quot;debugHbox&quot;&gt;
+		      &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+		      &lt;property name=&quot;homogeneous&quot;&gt;False&lt;/property&gt;
+		      &lt;property name=&quot;spacing&quot;&gt;0&lt;/property&gt;
+
+		      &lt;child&gt;
+			&lt;widget class=&quot;GtkLabel&quot; id=&quot;debugLabel&quot;&gt;
+			  &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+			  &lt;property name=&quot;label&quot; translatable=&quot;yes&quot;&gt;Debugging settings (bits):   &lt;/property&gt;
+			  &lt;property name=&quot;use_underline&quot;&gt;False&lt;/property&gt;
+			  &lt;property name=&quot;use_markup&quot;&gt;False&lt;/property&gt;
+			  &lt;property name=&quot;justify&quot;&gt;GTK_JUSTIFY_LEFT&lt;/property&gt;
+			  &lt;property name=&quot;wrap&quot;&gt;False&lt;/property&gt;
+			  &lt;property name=&quot;selectable&quot;&gt;False&lt;/property&gt;
+			  &lt;property name=&quot;xalign&quot;&gt;0.5&lt;/property&gt;
+			  &lt;property name=&quot;yalign&quot;&gt;0.5&lt;/property&gt;
+			  &lt;property name=&quot;xpad&quot;&gt;0&lt;/property&gt;
+			  &lt;property name=&quot;ypad&quot;&gt;0&lt;/property&gt;
+			  &lt;property name=&quot;ellipsize&quot;&gt;PANGO_ELLIPSIZE_NONE&lt;/property&gt;
+			  &lt;property name=&quot;width_chars&quot;&gt;-1&lt;/property&gt;
+			  &lt;property name=&quot;single_line_mode&quot;&gt;False&lt;/property&gt;
+			  &lt;property name=&quot;angle&quot;&gt;0&lt;/property&gt;
+			&lt;/widget&gt;
+			&lt;packing&gt;
+			  &lt;property name=&quot;padding&quot;&gt;0&lt;/property&gt;
+			  &lt;property name=&quot;expand&quot;&gt;False&lt;/property&gt;
+			  &lt;property name=&quot;fill&quot;&gt;False&lt;/property&gt;
+			&lt;/packing&gt;
+		      &lt;/child&gt;
+
+		      &lt;child&gt;
+			&lt;widget class=&quot;GtkSpinButton&quot; id=&quot;debugSpinButton&quot;&gt;
+			  &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+			  &lt;property name=&quot;can_focus&quot;&gt;True&lt;/property&gt;
+			  &lt;property name=&quot;climb_rate&quot;&gt;1&lt;/property&gt;
+			  &lt;property name=&quot;digits&quot;&gt;0&lt;/property&gt;
+			  &lt;property name=&quot;numeric&quot;&gt;False&lt;/property&gt;
+			  &lt;property name=&quot;update_policy&quot;&gt;GTK_UPDATE_ALWAYS&lt;/property&gt;
+			  &lt;property name=&quot;snap_to_ticks&quot;&gt;False&lt;/property&gt;
+			  &lt;property name=&quot;wrap&quot;&gt;False&lt;/property&gt;
+			  &lt;property name=&quot;adjustment&quot;&gt;0 0 16777215 1 10 10&lt;/property&gt;
+			&lt;/widget&gt;
+			&lt;packing&gt;
+			  &lt;property name=&quot;padding&quot;&gt;0&lt;/property&gt;
+			  &lt;property name=&quot;expand&quot;&gt;True&lt;/property&gt;
+			  &lt;property name=&quot;fill&quot;&gt;True&lt;/property&gt;
+			&lt;/packing&gt;
+		      &lt;/child&gt;
+		    &lt;/widget&gt;
+		    &lt;packing&gt;
+		      &lt;property name=&quot;padding&quot;&gt;0&lt;/property&gt;
+		      &lt;property name=&quot;expand&quot;&gt;True&lt;/property&gt;
+		      &lt;property name=&quot;fill&quot;&gt;True&lt;/property&gt;
+		    &lt;/packing&gt;
+		  &lt;/child&gt;
+		&lt;/widget&gt;
+		&lt;packing&gt;
+		  &lt;property name=&quot;padding&quot;&gt;0&lt;/property&gt;
+		  &lt;property name=&quot;expand&quot;&gt;True&lt;/property&gt;
+		  &lt;property name=&quot;fill&quot;&gt;True&lt;/property&gt;
+		&lt;/packing&gt;
+	      &lt;/child&gt;
+	    &lt;/widget&gt;
+	    &lt;packing&gt;
+	      &lt;property name=&quot;padding&quot;&gt;0&lt;/property&gt;
+	      &lt;property name=&quot;expand&quot;&gt;False&lt;/property&gt;
+	      &lt;property name=&quot;fill&quot;&gt;True&lt;/property&gt;
+	    &lt;/packing&gt;
+	  &lt;/child&gt;
+
+	  &lt;child&gt;
+	    &lt;widget class=&quot;GtkFrame&quot; id=&quot;previewFrame&quot;&gt;
+	      &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+	      &lt;property name=&quot;label_xalign&quot;&gt;0&lt;/property&gt;
+	      &lt;property name=&quot;label_yalign&quot;&gt;0.5&lt;/property&gt;
+	      &lt;property name=&quot;shadow_type&quot;&gt;GTK_SHADOW_ETCHED_IN&lt;/property&gt;
+
+	      &lt;child&gt;
+		&lt;widget class=&quot;GtkAlignment&quot; id=&quot;previewAlignment&quot;&gt;
+		  &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+		  &lt;property name=&quot;xalign&quot;&gt;0.5&lt;/property&gt;
+		  &lt;property name=&quot;yalign&quot;&gt;0.5&lt;/property&gt;
+		  &lt;property name=&quot;xscale&quot;&gt;1&lt;/property&gt;
+		  &lt;property name=&quot;yscale&quot;&gt;1&lt;/property&gt;
+		  &lt;property name=&quot;top_padding&quot;&gt;0&lt;/property&gt;
+		  &lt;property name=&quot;bottom_padding&quot;&gt;8&lt;/property&gt;
+		  &lt;property name=&quot;left_padding&quot;&gt;6&lt;/property&gt;
+		  &lt;property name=&quot;right_padding&quot;&gt;8&lt;/property&gt;
+
+		  &lt;child&gt;
+		    &lt;widget class=&quot;GtkVBox&quot; id=&quot;previewVbox&quot;&gt;
+		      &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+		      &lt;property name=&quot;homogeneous&quot;&gt;False&lt;/property&gt;
+		      &lt;property name=&quot;spacing&quot;&gt;5&lt;/property&gt;
+
+		      &lt;child&gt;
+			&lt;widget class=&quot;GtkHBox&quot; id=&quot;previewControlHbox&quot;&gt;
+			  &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+			  &lt;property name=&quot;homogeneous&quot;&gt;False&lt;/property&gt;
+			  &lt;property name=&quot;spacing&quot;&gt;5&lt;/property&gt;
+
+			  &lt;child&gt;
+			    &lt;widget class=&quot;GtkComboBox&quot; id=&quot;previewOutputMenu&quot;&gt;
+			      &lt;property name=&quot;items&quot; translatable=&quot;yes&quot;&gt;Threshold output
+Final output&lt;/property&gt;
+			      &lt;property name=&quot;add_tearoffs&quot;&gt;False&lt;/property&gt;
+			      &lt;property name=&quot;focus_on_click&quot;&gt;True&lt;/property&gt;
+			    &lt;/widget&gt;
+			    &lt;packing&gt;
+			      &lt;property name=&quot;padding&quot;&gt;0&lt;/property&gt;
+			      &lt;property name=&quot;expand&quot;&gt;False&lt;/property&gt;
+			      &lt;property name=&quot;fill&quot;&gt;True&lt;/property&gt;
+			    &lt;/packing&gt;
+			  &lt;/child&gt;
+
+			  &lt;child&gt;
+			    &lt;widget class=&quot;GtkHScale&quot; id=&quot;previewSlider&quot;&gt;
+			      &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+			      &lt;property name=&quot;can_focus&quot;&gt;True&lt;/property&gt;
+			      &lt;property name=&quot;draw_value&quot;&gt;True&lt;/property&gt;
+			      &lt;property name=&quot;value_pos&quot;&gt;GTK_POS_TOP&lt;/property&gt;
+			      &lt;property name=&quot;digits&quot;&gt;0&lt;/property&gt;
+			      &lt;property name=&quot;update_policy&quot;&gt;GTK_UPDATE_CONTINUOUS&lt;/property&gt;
+			      &lt;property name=&quot;inverted&quot;&gt;False&lt;/property&gt;
+			      &lt;property name=&quot;adjustment&quot;&gt;0 0 99 1 1 1&lt;/property&gt;
+			    &lt;/widget&gt;
+			    &lt;packing&gt;
+			      &lt;property name=&quot;padding&quot;&gt;0&lt;/property&gt;
+			      &lt;property name=&quot;expand&quot;&gt;True&lt;/property&gt;
+			      &lt;property name=&quot;fill&quot;&gt;True&lt;/property&gt;
+			    &lt;/packing&gt;
+			  &lt;/child&gt;
+			&lt;/widget&gt;
+			&lt;packing&gt;
+			  &lt;property name=&quot;padding&quot;&gt;0&lt;/property&gt;
+			  &lt;property name=&quot;expand&quot;&gt;True&lt;/property&gt;
+			  &lt;property name=&quot;fill&quot;&gt;True&lt;/property&gt;
+			&lt;/packing&gt;
+		      &lt;/child&gt;
+
+		      &lt;child&gt;
+			&lt;widget class=&quot;GtkDrawingArea&quot; id=&quot;previewVideo&quot;&gt;
+			  &lt;property name=&quot;height_request&quot;&gt;300&lt;/property&gt;
+			  &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+			  &lt;property name=&quot;events&quot;&gt;GDK_BUTTON1_MOTION_MASK | GDK_BUTTON_PRESS_MASK&lt;/property&gt;
+			&lt;/widget&gt;
+			&lt;packing&gt;
+			  &lt;property name=&quot;padding&quot;&gt;0&lt;/property&gt;
+			  &lt;property name=&quot;expand&quot;&gt;True&lt;/property&gt;
+			  &lt;property name=&quot;fill&quot;&gt;True&lt;/property&gt;
+			&lt;/packing&gt;
+		      &lt;/child&gt;
+		    &lt;/widget&gt;
+		  &lt;/child&gt;
+		&lt;/widget&gt;
+	      &lt;/child&gt;
+
+	      &lt;child&gt;
+		&lt;widget class=&quot;GtkLabel&quot; id=&quot;previewLabel&quot;&gt;
+		  &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+		  &lt;property name=&quot;label&quot; translatable=&quot;yes&quot;&gt;Preview&lt;/property&gt;
+		  &lt;property name=&quot;use_underline&quot;&gt;False&lt;/property&gt;
+		  &lt;property name=&quot;use_markup&quot;&gt;False&lt;/property&gt;
+		  &lt;property name=&quot;justify&quot;&gt;GTK_JUSTIFY_LEFT&lt;/property&gt;
+		  &lt;property name=&quot;wrap&quot;&gt;False&lt;/property&gt;
+		  &lt;property name=&quot;selectable&quot;&gt;False&lt;/property&gt;
+		  &lt;property name=&quot;xalign&quot;&gt;0.5&lt;/property&gt;
+		  &lt;property name=&quot;yalign&quot;&gt;0.5&lt;/property&gt;
+		  &lt;property name=&quot;xpad&quot;&gt;0&lt;/property&gt;
+		  &lt;property name=&quot;ypad&quot;&gt;0&lt;/property&gt;
+		  &lt;property name=&quot;ellipsize&quot;&gt;PANGO_ELLIPSIZE_NONE&lt;/property&gt;
+		  &lt;property name=&quot;width_chars&quot;&gt;-1&lt;/property&gt;
+		  &lt;property name=&quot;single_line_mode&quot;&gt;False&lt;/property&gt;
+		  &lt;property name=&quot;angle&quot;&gt;0&lt;/property&gt;
+		&lt;/widget&gt;
+		&lt;packing&gt;
+		  &lt;property name=&quot;type&quot;&gt;label_item&lt;/property&gt;
+		&lt;/packing&gt;
+	      &lt;/child&gt;
+	    &lt;/widget&gt;
+	    &lt;packing&gt;
+	      &lt;property name=&quot;padding&quot;&gt;0&lt;/property&gt;
+	      &lt;property name=&quot;expand&quot;&gt;True&lt;/property&gt;
+	      &lt;property name=&quot;fill&quot;&gt;True&lt;/property&gt;
+	    &lt;/packing&gt;
+	  &lt;/child&gt;
+	&lt;/widget&gt;
+	&lt;packing&gt;
+	  &lt;property name=&quot;padding&quot;&gt;0&lt;/property&gt;
+	  &lt;property name=&quot;expand&quot;&gt;True&lt;/property&gt;
+	  &lt;property name=&quot;fill&quot;&gt;True&lt;/property&gt;
+	&lt;/packing&gt;
+      &lt;/child&gt;
+    &lt;/widget&gt;
+  &lt;/child&gt;
+&lt;/widget&gt;
+
+&lt;/glade-interface&gt;

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_NONE/ADM_dialog/DIA_none.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_NONE/ADM_dialog/DIA_none.cpp	2007-09-30 16:29:29 UTC (rev 3607)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_NONE/ADM_dialog/DIA_none.cpp	2007-09-30 16:49:31 UTC (rev 3608)
@@ -105,6 +105,22 @@
 int DIA_srtPos(AVDMGenericVideoStream *source,uint32_t *size,uint32_t *position) {return 0;}
 int DIA_colorSel(uint8_t *r, uint8_t *g, uint8_t *b) {return 0;}			
 uint8_t DIA_glyphEdit(void) {return 0;}
+struct THRESHOLD_PARAM;
+uint8_t DIA_threshold(AVDMGenericVideoStream *in,
+                      THRESHOLD_PARAM * param) { return 255; }
+struct SWISSARMYKNIFE_PARAM;
+struct ADMVideoSwissArmyKnife;
+struct MenuMapping;
+uint8_t DIA_SwissArmyKnife (AVDMGenericVideoStream * in,
+                            ADMVideoSwissArmyKnife * sakp,
+                            SWISSARMYKNIFE_PARAM * param,
+                            const MenuMapping * menu_mapping,
+                            uint32_t menu_mapping_count) { return 255; }
+struct PARTICLE_PARAM;
+uint8_t DIA_particle (AVDMGenericVideoStream *in,
+                      PARTICLE_PARAM * param,
+                      const MenuMapping * menu_mapping,
+                      uint32_t menu_mapping_count) { return 255; }
 uint8_t ADM_ocrUpdateNbLines(void *ui,uint32_t cur,uint32_t total) {return 0;}
 uint8_t ADM_ocrUpdateNbGlyphs(void *ui,uint32_t nbGlyphs) {return 0;}
 uint8_t ADM_ocrUpdateTextAndTime(void *ui,char *decodedString,char *timeCode) {	return 0;}

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_NONE/ADM_dialogFactory/FAC_toggle.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_NONE/ADM_dialogFactory/FAC_toggle.cpp	2007-09-30 16:29:29 UTC (rev 3607)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_NONE/ADM_dialogFactory/FAC_toggle.cpp	2007-09-30 16:49:31 UTC (rev 3608)
@@ -171,6 +171,13 @@
  
 }
 
+diaElemFile::diaElemFile(uint32_t write,std::string * filename,const char *toggleTitle,
+                         const char *defaultSuffix, const char *tip)
+  : diaElem(ELEM_FILE_READ)
+{
+ 
+}
+
 diaElemFile::~diaElemFile()
 {
   

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_none.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_none.cpp	2007-09-30 16:29:29 UTC (rev 3607)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/DIA_none.cpp	2007-09-30 16:49:31 UTC (rev 3608)
@@ -1,6 +1,6 @@
 
 /***************************************************************************
-                          DIA_animated
+                          DIA_none
     copyright            : (C) 2006 by mean
     email                : <A HREF="https://lists.berlios.de/mailman/listinfo/avidemux-svn-commit">fixounet at free.fr</A>
  ***************************************************************************/
@@ -54,5 +54,21 @@
 int DIA_colorSel(uint8_t *r, uint8_t *g, uint8_t *b) {return 0;}
 uint8_t DIA_glyphEdit(void){ return 0;};
 int32_t UI_readJog(void) {return 0;}
+struct THRESHOLD_PARAM;
+uint8_t DIA_threshold(AVDMGenericVideoStream *in,
+                      THRESHOLD_PARAM * param) { return 255; }
+struct SWISSARMYKNIFE_PARAM;
+struct ADMVideoSwissArmyKnife;
+struct MenuMapping;
+uint8_t DIA_SwissArmyKnife (AVDMGenericVideoStream * in,
+                            ADMVideoSwissArmyKnife * sakp,
+                            SWISSARMYKNIFE_PARAM * param,
+                            const MenuMapping * menu_mapping,
+                            uint32_t menu_mapping_count) { return 255; }
+struct PARTICLE_PARAM;
+uint8_t DIA_particle (AVDMGenericVideoStream *in,
+                      PARTICLE_PARAM * param,
+                      const MenuMapping * menu_mapping,
+                      uint32_t menu_mapping_count) { return 255; }
 
 //EOF

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialogFactory/T_filesel.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialogFactory/T_filesel.cpp	2007-09-30 16:29:29 UTC (rev 3607)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialogFactory/T_filesel.cpp	2007-09-30 16:49:31 UTC (rev 3608)
@@ -105,7 +105,7 @@
         ADM_fileMode fileMode;
         const char * defaultSuffix;
             
-        ADM_Qfilesel(QWidget *z,const char *title,char *entry,QGridLayout *layout,int line, ADM_fileMode mode, const char * defaultSuffix)
+        ADM_Qfilesel(QWidget *z,const char *title,const char *entry,QGridLayout *layout,int line, ADM_fileMode mode, const char * defaultSuffix)
             : QWidget(z),
               defaultSuffix (defaultSuffix)
         {
@@ -142,7 +142,8 @@
 diaElemFile::diaElemFile(uint32_t writemode,char **filename,const char *toggleTitle,
                          const char *defaultSuffix,const char *tip)
   : diaElem(ELEM_FILE_READ),
-    defaultSuffix (defaultSuffix)
+    defaultSuffix (defaultSuffix),
+    paramIsStdString (false)
 {
   param=(void *)filename;
   paramTitle=shortkey(toggleTitle);
@@ -150,6 +151,18 @@
   _write=writemode;
 }
 
+diaElemFile::diaElemFile(uint32_t writemode,std::string *filename,const char *toggleTitle,
+                         const char * defaultSuffix,const char *tip)
+  : diaElem(ELEM_FILE_READ),
+    defaultSuffix (defaultSuffix),
+    paramIsStdString (true)
+{
+  param=(void *)filename;
+  paramTitle=shortkey(toggleTitle);
+  this-&gt;tip=tip;
+  _write=writemode;
+}
+
 diaElemFile::~diaElemFile()
 {
   if(paramTitle)
@@ -159,21 +172,32 @@
 {
  QGridLayout *layout=(QGridLayout*) opaque;
  ADM_Qfilesel *fs;
+ const char * val;
+ if (paramIsStdString)
+     val = ((std::string *)param)-&gt;c_str();
+ else
+     val = *((const char **)param);
   if(_write)
-      fs=new ADM_Qfilesel((QWidget *)dialog,paramTitle,*(char **)param,layout, line,ADM_FILEMODE_WRITE, defaultSuffix);
+      fs=new ADM_Qfilesel((QWidget *)dialog,paramTitle, val, layout, line,ADM_FILEMODE_WRITE, defaultSuffix);
   else
-      fs=new ADM_Qfilesel((QWidget *)dialog,paramTitle,*(char **)param,layout, line,ADM_FILEMODE_READ, 0);
+      fs=new ADM_Qfilesel((QWidget *)dialog,paramTitle, val, layout, line,ADM_FILEMODE_READ, 0);
   myWidget=(void *)fs; 
 }
 void diaElemFile::getMe(void)
 {
-  
-  char **n=(char **)param;
-  if(*n) ADM_dealloc(*n);
-  
   ADM_Qfilesel *fs=(ADM_Qfilesel *)myWidget;
   QString s=(fs-&gt;edit)-&gt;text();
-  *n=ADM_strdup( s.toLatin1() );
+  const char * val = s.toLatin1();
+  if (paramIsStdString)
+  {
+      *((std::string *)param) = val;
+  }
+  else
+  {
+      char **n=(char **)param;
+      if(*n) ADM_dealloc(*n);
+      *n=ADM_strdup(val);
+  }
 }
 void diaElemFile::enable(uint32_t onoff)
 {

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/CMakeLists.txt
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/CMakeLists.txt	2007-09-30 16:29:29 UTC (rev 3607)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/CMakeLists.txt	2007-09-30 16:49:31 UTC (rev 3608)
@@ -10,7 +10,7 @@
 DIA_bitrateHisto.cpp  DIA_flyAsharp.cpp       DIA_flyDialog.cpp    DIA_lavcodec.cpp    DIA_prefs.cpp     DIA_SVCD.cpp       GUI_sdlRender.cpp
 DIA_builtin.cpp       DIA_flyChromaShift.cpp  DIA_flyHue.cpp       DIA_lavDecoder.cpp  DIA_requant.cpp   DIA_tdeint.cpp     GUI_xvRender.cpp
 DIA_animated.cpp      DIA_ocr.cpp DIA_tsSub.cpp
-DIA_flyEq2.cpp          DIA_flv1.cpp
+DIA_flyEq2.cpp          DIA_flv1.cpp          DIA_flyThreshold.cpp DIA_flySwissArmyKnife.cpp DIA_flyParticle.cpp
 )
 ADD_LIBRARY(${ADM_LIB} STATIC ${${ADM_LIB}_SRCS})
 ADD_ADM_LIB(${ADM_LIB} ADM_userInterfaces)

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_DVDff.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_DVDff.cpp	2007-09-30 16:29:29 UTC (rev 3607)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_DVDff.cpp	2007-09-30 16:49:31 UTC (rev 3608)
@@ -3,15 +3,11 @@
 
 
 */
-#include &lt;config.h&gt;
 
-#include &lt;stdio.h&gt;
-#include &lt;stdlib.h&gt;
+#include &quot;default.h&quot;
 
-
 #include &quot;ADM_lavcodec.h&quot;
 
-#include &quot;default.h&quot;
 #include &quot;ADM_toolkit/toolkit.hxx&quot;
 #include &quot;ADM_codecs/ADM_codec.h&quot;
 #include &quot;ADM_encoder/ADM_vidEncode.hxx&quot;

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_audioconfig.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_audioconfig.cpp	2007-09-30 16:29:29 UTC (rev 3607)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_audioconfig.cpp	2007-09-30 16:49:31 UTC (rev 3608)
@@ -13,14 +13,7 @@
  *   (at your option) any later version.                                   *
  *                                                                         *
  ***************************************************************************/
-#include &quot;config.h&quot;
-#include &lt;sys/types.h&gt;
-#include &lt;sys/stat.h&gt;
-#include &lt;unistd.h&gt;
-#include &lt;string.h&gt;
-#include &lt;stdio.h&gt;
-# include &lt;math.h&gt;
-# include &quot;config.h&quot;
+
 #include &quot;default.h&quot;
 
 #include &quot;ADM_assert.h&quot;

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_enter.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_enter.cpp	2007-09-30 16:29:29 UTC (rev 3607)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_enter.cpp	2007-09-30 16:49:31 UTC (rev 3608)
@@ -13,14 +13,7 @@
  *   (at your option) any later version.                                   *
  *                                                                         *
  ***************************************************************************/
-#include &quot;config.h&quot;
-#include &lt;sys/types.h&gt;
-#include &lt;sys/stat.h&gt;
-#include &lt;unistd.h&gt;
-#include &lt;string.h&gt;
-#include &lt;stdio.h&gt;
-# include &lt;math.h&gt;
-# include &quot;config.h&quot;
+
 #include &quot;default.h&quot;
 
 #include &quot;ADM_assert.h&quot;

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_factory.h
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_factory.h	2007-09-30 16:29:29 UTC (rev 3607)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_factory.h	2007-09-30 16:49:31 UTC (rev 3608)
@@ -17,6 +17,7 @@
 #define DIA_FACTORY_H
 
 #include &quot;ADM_assert.h&quot;
+#include &lt;string&gt;
 
 typedef enum 
 {
@@ -330,10 +331,13 @@
 
 protected:
     const char * defaultSuffix;
+    bool paramIsStdString;
 public:
   
   diaElemFile(uint32_t writeMode,char **filename,const char *toggleTitle,
               const char *defaultSuffix = 0,const char *tip=NULL);
+  diaElemFile(uint32_t writeMode,std::string *filename,const char *toggleTitle,
+              const char *defaultSuffix = 0,const char *tip=NULL);
   virtual ~diaElemFile() ;
   void setMe(void *dialog, void *opaque,uint32_t line);
   void getMe(void);

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_flyAsharp.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_flyAsharp.cpp	2007-09-30 16:29:29 UTC (rev 3607)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_flyAsharp.cpp	2007-09-30 16:49:31 UTC (rev 3608)
@@ -1,9 +1,9 @@
 /**/
 /***************************************************************************
-                          DIA_hue
+                          DIA_Asharp
                              -------------------
 
-                           Ui for hue &amp; sat
+                           Ui for Asharp
 
     begin                : 08 Apr 2005
     copyright            : (C) 2004/5 by mean
@@ -19,15 +19,8 @@
  *                                                                         *
  ***************************************************************************/
 
-
-
-#include &lt;config.h&gt;
-
-
-#include &lt;string.h&gt;
-#include &lt;stdio.h&gt;
-#include &lt;math.h&gt;
 #include &quot;default.h&quot;
+
 #include &quot;ADM_colorspace/ADM_rgb.h&quot;
 
 #include &quot;ADM_image.h&quot;

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_flyContrast.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_flyContrast.cpp	2007-09-30 16:29:29 UTC (rev 3607)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_flyContrast.cpp	2007-09-30 16:49:31 UTC (rev 3608)
@@ -14,11 +14,9 @@
  *   (at your option) any later version.                                   *
  *                                                                         *
  ***************************************************************************/
-#include &quot;config.h&quot;
-#include &lt;string.h&gt;
-#include &lt;stdio.h&gt;
-#include &lt;math.h&gt;
+
 #include &quot;default.h&quot;
+
 #include &quot;ADM_colorspace/ADM_rgb.h&quot;
 
 #include &quot;ADM_image.h&quot;

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_flyCrop.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_flyCrop.cpp	2007-09-30 16:29:29 UTC (rev 3607)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_flyCrop.cpp	2007-09-30 16:49:31 UTC (rev 3608)
@@ -17,11 +17,6 @@
  *                                                                         *
  ***************************************************************************/
 
-#include &lt;config.h&gt;
-#include &lt;string.h&gt;
-#include &lt;stdio.h&gt;
-# include &lt;math.h&gt;
-
 #include &quot;default.h&quot;
 
 #include &quot;ADM_image.h&quot;

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_flyDialog.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_flyDialog.cpp	2007-09-30 16:29:29 UTC (rev 3607)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_flyDialog.cpp	2007-09-30 16:49:31 UTC (rev 3608)
@@ -12,11 +12,6 @@
 *                                                                         *
 ***************************************************************************///
 
-#include &quot;config.h&quot;
-
-#include &lt;stdio.h&gt;
-#include &lt;stdlib.h&gt;
-
 #include &quot;default.h&quot;
 
 #include &quot;ADM_colorspace/ADM_rgb.h&quot;
@@ -76,8 +71,8 @@
 			_resizeMethod = RESIZE_NONE;
 		else
 		{
-			_zoomW = _w * zoom;
-			_zoomH = _h * zoom;
+			_zoomW = uint32_t (_w * zoom);
+			_zoomH = uint32_t (_h * zoom);
 		}
 	}
 

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_flyDialog.h
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_flyDialog.h	2007-09-30 16:29:29 UTC (rev 3607)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_flyDialog.h	2007-09-30 16:49:31 UTC (rev 3608)
@@ -30,6 +30,16 @@
 	RESIZE_LAST = 2		// Resize image after filter has been applied (slower for RGB)
 };
 
+class diaMenuEntry;  // defined in DIA_factory.h; only need pointer here
+
+struct MenuMapping
+{
+    const char * widgetName; // name of the combo box widget or equivalent
+    uint32_t paramOffset;   // offsetof(FOO_PARAM, menu_option_member)
+    uint32_t count;
+    const diaMenuEntry * menu;
+};
+
 class ADM_flyDialog
 {
   protected:
@@ -50,8 +60,18 @@
           void copyYuvFinalToRgb(void);
           void copyYuvScratchToRgb(void);
 		  void copyRgbFinalToDisplay(void);
-
+          void setupMenus (const void * params,
+                           const MenuMapping * menu_mapping,
+                           uint32_t menu_mapping_count);
+          void getMenuValues (void * params,
+                              const MenuMapping * menu_mapping,
+                              uint32_t menu_mapping_count);
   public:
+          uint32_t getMenuValue (const MenuMapping * mm);
+          const MenuMapping * lookupMenu (const char * widgetName,
+                                          const MenuMapping * menu_mapping,
+                                          uint32_t menu_mapping_count);
+  public:
           void    *_cookie; // whatever
           void    *_slider; // widget
           void    *_canvas; // Drawing zone
@@ -60,7 +80,7 @@
   virtual uint8_t    process(void)=0;
   virtual uint8_t    download(void)=0;
   virtual uint8_t    upload(void)=0;
-          /* /filte dependant */
+          /* /filter dependant */
   
   virtual uint8_t    sliderChanged(void);
         /* This is GTK/QT/whatever dependant */
@@ -75,6 +95,7 @@
           ADM_flyDialog(uint32_t width, uint32_t height, AVDMGenericVideoStream *in,
                              void *canvas, void *slider, int yuv, ResizeMethod resizeMethod);
   virtual ~ADM_flyDialog(void);
+
 };
 
 #endif

Added: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_flyParticle.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_flyParticle.cpp	2007-09-30 16:29:29 UTC (rev 3607)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_flyParticle.cpp	2007-09-30 16:49:31 UTC (rev 3608)
@@ -0,0 +1,73 @@
+/***************************************************************************
+                          DIA_flyParticle.cpp  -  configuration dialog for
+						   particle filter
+                              -------------------
+                         Chris MacGregor, September 2007
+                         <A HREF="https://lists.berlios.de/mailman/listinfo/avidemux-svn-commit">chris-avidemux at bouncingdog.com</A>
+ ***************************************************************************/
+
+/***************************************************************************
+ *                                                                         *
+ *   This program is free software; you can redistribute it and/or modify  *
+ *   it under the terms of the GNU General Public License as published by  *
+ *   the Free Software Foundation; either version 2 of the License, or     *
+ *   (at your option) any later version.                                   *
+ *                                                                         *
+ ***************************************************************************/
+
+#include &quot;default.h&quot;
+
+#include &quot;ADM_colorspace/ADM_rgb.h&quot;
+
+#include &quot;ADM_image.h&quot;
+#include &quot;ADM_video/ADM_genvideo.hxx&quot;
+#include &quot;ADM_videoFilter/ADM_vidParticle.h&quot;
+#include &quot;DIA_flyDialog.h&quot;
+#include &quot;DIA_flyParticle.h&quot;
+
+/************* COMMON PART *********************/
+
+uint8_t flyParticle::update ()
+{
+    download();
+    process();
+    copyYuvFinalToRgb();
+    display();
+    return 1;
+}
+
+static inline void draw_hline (uint8_t * fb, uint32_t width, uint32_t height,
+                               uint32_t y)
+{
+    for (uint8_t * pixp = fb + width * y; width--; pixp++)
+        *pixp ^= 0xff;
+}
+
+static inline void draw_vline (uint8_t * fb, uint32_t width, uint32_t height,
+                               uint32_t x)
+{
+    for (uint8_t * pixp = fb + x; height--; pixp += width)
+        *pixp ^= 0xff;
+}
+
+uint8_t flyParticle::process ()
+{
+    uint8_t ret = ADMVideoParticle::doParticle (_yuvBuffer, _yuvBufferOut,
+                                                _in, 0, 0, &amp;param, _w, _h);
+    input_buffer_valid = false;
+
+    uint8_t * fb = YPLANE(_yuvBufferOut);
+
+    if (param.left_crop)
+        draw_vline (fb, _w, _h, param.left_crop - 1);
+    if (param.right_crop)
+        draw_vline (fb, _w, _h, _w - param.right_crop);
+    if (param.top_crop)
+        draw_hline (fb, _w, _h, param.top_crop - 1);
+    if (param.bottom_crop)
+        draw_hline (fb, _w, _h, _h - param.bottom_crop);
+
+    return ret;
+}
+
+/************* COMMON PART *********************/

Added: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_flyParticle.h
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_flyParticle.h	2007-09-30 16:29:29 UTC (rev 3607)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_flyParticle.h	2007-09-30 16:49:31 UTC (rev 3608)
@@ -0,0 +1,94 @@
+/***************************************************************************
+                          DIA_flyParticle.cpp  -  configuration dialog for
+						   particle filter
+                              -------------------
+                         Chris MacGregor, September 2007
+                         <A HREF="https://lists.berlios.de/mailman/listinfo/avidemux-svn-commit">chris-avidemux at bouncingdog.com</A>
+ ***************************************************************************/
+
+/***************************************************************************
+ *                                                                         *
+ *   This program is free software; you can redistribute it and/or modify  *
+ *   it under the terms of the GNU General Public License as published by  *
+ *   the Free Software Foundation; either version 2 of the License, or     *
+ *   (at your option) any later version.                                   *
+ *                                                                         *
+ ***************************************************************************/
+
+#ifndef FLY_PARTICLE_H
+#define FLY_PARTICLE_H
+
+class flyParticle : public ADM_flyDialog
+{
+  
+  private:
+    PARTICLE_PARAM param;
+    const MenuMapping * menu_mapping;
+    uint32_t menu_mapping_count;
+    bool input_buffer_valid;
+
+  public:
+    uint8_t    process(void);
+    uint8_t    download(void);
+    uint8_t    upload(void);
+    uint8_t    update(void);
+
+    flyParticle (uint32_t width, uint32_t height,
+                 AVDMGenericVideoStream * in,
+                 void * canvas, void * slider, void * dialog,
+                 const PARTICLE_PARAM * in_param,
+                 const MenuMapping * menu_mapping,
+                 uint32_t menu_mapping_count)
+        : ADM_flyDialog (width, height, in, canvas, slider, 1, RESIZE_AUTO),
+          param (*in_param),
+          menu_mapping (menu_mapping),
+          menu_mapping_count (menu_mapping_count),
+          input_buffer_valid (false)
+    {
+        _cookie = dialog;
+        setupMenus (in_param, menu_mapping, menu_mapping_count);
+    };
+
+    void getParam (PARTICLE_PARAM * outputParam)
+    {
+        *outputParam = param;
+    }
+
+    ADMImage * getInputImage ()
+    {
+        if (!input_buffer_valid)
+        {
+            uint32_t len, flags;
+            uint32_t frameNum = sliderGet();
+            if (!_in-&gt;getFrameNumberNoAlloc(frameNum, &amp;len,
+                                            _yuvBuffer, &amp;flags))
+            {
+                printf (&quot;flyParticle::getInputImage(): Cannot get frame %u\n&quot;,
+                        frameNum);
+                return 0;
+            }
+            input_buffer_valid = true;
+        }
+
+        return _yuvBuffer;
+    }
+
+    ADMImage * getOutputImage ()
+    {
+        return _yuvBufferOut;
+    }
+
+    const MenuMapping * lookupMenu (const char * widgetName)
+    {
+        return ADM_flyDialog::lookupMenu (widgetName, menu_mapping,
+                                          menu_mapping_count);
+    }
+
+    void getMenuValues ()
+    {
+        ADM_flyDialog::getMenuValues (&amp;param, menu_mapping,
+                                      menu_mapping_count);
+    }
+};
+
+#endif

Added: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_flySwissArmyKnife.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_flySwissArmyKnife.cpp	2007-09-30 16:29:29 UTC (rev 3607)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_flySwissArmyKnife.cpp	2007-09-30 16:49:31 UTC (rev 3608)
@@ -0,0 +1,61 @@
+/***************************************************************************
+                          DIA_flySwissArmyKnife.cpp  -  configuration dialog for
+						   Swiss Army Knife filter
+                              -------------------
+                         Chris MacGregor, September 2007
+                         <A HREF="https://lists.berlios.de/mailman/listinfo/avidemux-svn-commit">chris-avidemux at bouncingdog.com</A>
+ ***************************************************************************/
+
+/***************************************************************************
+ *                                                                         *
+ *   This program is free software; you can redistribute it and/or modify  *
+ *   it under the terms of the GNU General Public License as published by  *
+ *   the Free Software Foundation; either version 2 of the License, or     *
+ *   (at your option) any later version.                                   *
+ *                                                                         *
+ ***************************************************************************/
+
+#include &quot;default.h&quot;
+
+#include &quot;ADM_colorspace/ADM_rgb.h&quot;
+
+#include &quot;ADM_image.h&quot;
+#include &quot;ADM_video/ADM_genvideo.hxx&quot;
+#include &quot;ADM_videoFilter/ADM_vidSwissArmyKnife.h&quot;
+#include &quot;DIA_flyDialog.h&quot;
+#include &quot;DIA_flySwissArmyKnife.h&quot;
+
+/************* COMMON PART *********************/
+
+uint8_t flySwissArmyKnife::sliderChanged ()
+{
+    if (!param.enable_preview)
+        return 0;
+
+    return ADM_flyDialog::sliderChanged();
+}
+
+uint8_t  flySwissArmyKnife::update ()
+{
+    download();
+    if (!param.enable_preview)
+        return 0;
+
+    process();
+    copyYuvFinalToRgb();
+    display();
+    return 1;
+}
+
+uint8_t flySwissArmyKnife::process ()
+{
+    if (!param.enable_preview)
+        return 0;
+
+    uint8_t ret =
+        ADMVideoSwissArmyKnife::doSwissArmyKnife (_yuvBuffer, _yuvBufferOut,
+                                                  _in, sakp, &amp;param, _w, _h);
+    return ret;
+}
+
+/************* COMMON PART *********************/

Added: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_flySwissArmyKnife.h
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_flySwissArmyKnife.h	2007-09-30 16:29:29 UTC (rev 3607)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_flySwissArmyKnife.h	2007-09-30 16:49:31 UTC (rev 3608)
@@ -0,0 +1,89 @@
+/***************************************************************************
+                          DIA_flySwissArmyKnife.cpp  -  configuration dialog for
+						   Swiss Army Knife filter
+                              -------------------
+                         Chris MacGregor, September 2007
+                         <A HREF="https://lists.berlios.de/mailman/listinfo/avidemux-svn-commit">chris-avidemux at bouncingdog.com</A>
+ ***************************************************************************/
+
+/***************************************************************************
+ *                                                                         *
+ *   This program is free software; you can redistribute it and/or modify  *
+ *   it under the terms of the GNU General Public License as published by  *
+ *   the Free Software Foundation; either version 2 of the License, or     *
+ *   (at your option) any later version.                                   *
+ *                                                                         *
+ ***************************************************************************/
+
+#ifndef FLY_SWISSARMYKNIFE_H
+#define FLY_SWISSARMYKNIFE_H
+
+class flySwissArmyKnife : public ADM_flyDialog
+{
+  
+  private:
+    ADMVideoSwissArmyKnife * sakp;
+    const MenuMapping * menu_mapping;
+    uint32_t menu_mapping_count;
+
+  public:
+    SWISSARMYKNIFE_PARAM param;
+
+    uint8_t    process(void);
+    uint8_t    download(void);
+    uint8_t    upload(void);
+    uint8_t    update(void);
+
+    flySwissArmyKnife (uint32_t width, uint32_t height,
+                       AVDMGenericVideoStream * in,
+                       void * canvas, void * slider, void * dialog,
+                       ADMVideoSwissArmyKnife * sakp,
+                       const SWISSARMYKNIFE_PARAM * in_param,
+                       const MenuMapping * menu_mapping,
+                       uint32_t menu_mapping_count)
+        : ADM_flyDialog (width, height, in, canvas, slider, 1, RESIZE_AUTO),
+          sakp (sakp),
+          param (*in_param),
+          menu_mapping (menu_mapping),
+          menu_mapping_count (menu_mapping_count)
+    {
+        _cookie = dialog;
+        setupMenus (in_param, menu_mapping, menu_mapping_count);
+        // printf (&quot;flySwissArmyKnife::flySwissArmyKnife: &quot;
+        //         &quot;in_param %p, &amp;param %p\n&quot;, in_param, &amp;param);
+    };
+
+    uint8_t sliderChanged (void);
+
+    void getParam (SWISSARMYKNIFE_PARAM * outputParam)
+    {
+        *outputParam = param;
+    }
+
+    ADMImage * getInputImage ()
+    {
+        return _yuvBuffer;
+    }
+
+    ADMImage * getOutputImage ()
+    {
+        return _yuvBufferOut;
+    }
+
+    const MenuMapping * lookupMenu (const char * widgetName)
+    {
+        return ADM_flyDialog::lookupMenu (widgetName, menu_mapping,
+                                          menu_mapping_count);
+    }
+
+    void getMenuValues ()
+    {
+        ADM_flyDialog::getMenuValues (&amp;param, menu_mapping,
+                                      menu_mapping_count);
+    }
+
+    void updateConfigDescription (bool do_download);
+    void wipeOutputBuffer ();
+};
+
+#endif

Added: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_flyThreshold.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_flyThreshold.cpp	2007-09-30 16:29:29 UTC (rev 3607)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_flyThreshold.cpp	2007-09-30 16:49:31 UTC (rev 3608)
@@ -0,0 +1,53 @@
+/***************************************************************************
+                          DIA_flyThreshold.cpp  -  configuration dialog for
+						   threshold filter
+                              -------------------
+                         Chris MacGregor, September 2007
+                         <A HREF="https://lists.berlios.de/mailman/listinfo/avidemux-svn-commit">chris-avidemux at bouncingdog.com</A>
+ ***************************************************************************/
+
+/***************************************************************************
+ *                                                                         *
+ *   This program is free software; you can redistribute it and/or modify  *
+ *   it under the terms of the GNU General Public License as published by  *
+ *   the Free Software Foundation; either version 2 of the License, or     *
+ *   (at your option) any later version.                                   *
+ *                                                                         *
+ ***************************************************************************/
+
+#include &quot;config.h&quot;
+#include &lt;string.h&gt;
+#include &lt;stdio.h&gt;
+#include &lt;math.h&gt;
+#include &quot;default.h&quot;
+#include &quot;ADM_colorspace/ADM_rgb.h&quot;
+
+#include &quot;ADM_image.h&quot;
+#include &quot;ADM_video/ADM_genvideo.hxx&quot;
+#include &quot;ADM_videoFilter/ADM_vidThreshold.h&quot;
+#include &quot;DIA_flyDialog.h&quot;
+#include &quot;DIA_flyThreshold.h&quot;
+
+/************* COMMON PART *********************/
+
+uint8_t  flyThreshold::update ()
+{
+    download();
+    process();
+    copyYuvFinalToRgb();
+    display();
+    return 1;
+}
+
+uint8_t flyThreshold::process ()
+{
+    uint8_t lookup_table [256];
+    if (ADMVideoThreshold::computeLookupTable (&amp;param, lookup_table))
+        upload();
+
+    ADMVideoThreshold::doThreshold (_yuvBuffer, _yuvBufferOut,
+                                    lookup_table, (_h * _w * 3) &gt;&gt; 1);
+    return 1;
+}
+
+/************* COMMON PART *********************/

Added: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_flyThreshold.h
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_flyThreshold.h	2007-09-30 16:29:29 UTC (rev 3607)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_flyThreshold.h	2007-09-30 16:49:31 UTC (rev 3608)
@@ -0,0 +1,58 @@
+/***************************************************************************
+                          DIA_flyThreshold.cpp  -  configuration dialog for
+						   threshold filter
+                              -------------------
+                         Chris MacGregor, September 2007
+                         <A HREF="https://lists.berlios.de/mailman/listinfo/avidemux-svn-commit">chris-avidemux at bouncingdog.com</A>
+ ***************************************************************************/
+
+/***************************************************************************
+ *                                                                         *
+ *   This program is free software; you can redistribute it and/or modify  *
+ *   it under the terms of the GNU General Public License as published by  *
+ *   the Free Software Foundation; either version 2 of the License, or     *
+ *   (at your option) any later version.                                   *
+ *                                                                         *
+ ***************************************************************************/
+
+#ifndef FLY_THRESHOLD_H
+#define FLY_THRESHOLD_H
+
+class flyThreshold : public ADM_flyDialog
+{
+  
+  private:
+    THRESHOLD_PARAM param;
+
+  public:
+    uint8_t    process(void);
+    uint8_t    download(void);
+    uint8_t    upload(void);
+    uint8_t    update(void);
+
+    flyThreshold (uint32_t width, uint32_t height,
+                  AVDMGenericVideoStream * in,
+                  void * canvas, void * slider,
+                  const THRESHOLD_PARAM * in_param)
+        : ADM_flyDialog (width, height, in, canvas, slider, 1, RESIZE_AUTO),
+          param (*in_param)
+    {
+    };
+
+    void getParam (THRESHOLD_PARAM * outputParam)
+    {
+        *outputParam = param;
+    }
+
+    ADMImage * getInputImage ()
+    {
+        return _yuvBuffer;
+    }
+
+    ADMImage * getOutputImage ()
+    {
+        return _yuvBufferOut;
+    }
+};
+
+#endif

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_mjpeg.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_mjpeg.cpp	2007-09-30 16:29:29 UTC (rev 3607)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_mjpeg.cpp	2007-09-30 16:49:31 UTC (rev 3608)
@@ -3,15 +3,11 @@
 
 
 */
-#include &lt;config.h&gt;
 
-#include &lt;stdio.h&gt;
-#include &lt;stdlib.h&gt;
+#include &quot;default.h&quot;
 
-
 #include &quot;ADM_lavcodec.h&quot;
 
-#include &quot;default.h&quot;
 #include &quot;ADM_toolkit/toolkit.hxx&quot;
 #include &quot;ADM_codecs/ADM_codec.h&quot;
 #include &quot;ADM_encoder/ADM_vidEncode.hxx&quot;

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_resizeWiz.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_resizeWiz.cpp	2007-09-30 16:29:29 UTC (rev 3607)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_resizeWiz.cpp	2007-09-30 16:49:31 UTC (rev 3608)
@@ -17,13 +17,6 @@
  *                                                                         *
  ***************************************************************************/
 
-
-
-#include &lt;config.h&gt;
-#include &lt;math.h&gt;
-#include &lt;string.h&gt;
-#include &lt;stdio.h&gt;
-
 #include &quot;default.h&quot;
 
 #include &quot;ADM_assert.h&quot;

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_v2v.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_v2v.cpp	2007-09-30 16:29:29 UTC (rev 3607)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/DIA_v2v.cpp	2007-09-30 16:49:31 UTC (rev 3608)
@@ -14,16 +14,9 @@
  *   (at your option) any later version.                                   *
  *                                                                         *
  ***************************************************************************/
-# include &quot;config.h&quot;
 
-#include &lt;sys/types.h&gt;
-#include &lt;sys/stat.h&gt;
-#include &lt;unistd.h&gt;
-#include &lt;string.h&gt;
-#include &lt;stdio.h&gt;
-
-# include &lt;math.h&gt;
 #include &quot;default.h&quot;
+
 #include &quot;ADM_toolkit/toolkit.hxx&quot;
 #include &quot;ADM_toolkit/filesel.h&quot;
 #include &quot;DIA_factory.h&quot;

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/GUI_render.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/GUI_render.cpp	2007-09-30 16:29:29 UTC (rev 3607)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/GUI_render.cpp	2007-09-30 16:49:31 UTC (rev 3608)
@@ -17,19 +17,11 @@
  *   (at your option) any later version.                                   *
  *                                                                         *
  ***************************************************************************/
-#include &quot;config.h&quot;
 
-#include &lt;stdio.h&gt;         
-#include &lt;stdlib.h&gt;
-#include &lt;math.h&gt;
-#include &lt;unistd.h&gt;
-#include &lt;string.h&gt;
-#include &lt;sys/time.h&gt;
-
-#include &lt;../ADM_assert.h&gt;
-
 #include &quot;default.h&quot;
 
+#include &quot;ADM_assert.h&quot;
+
 #include &quot;ADM_commonUI/GUI_render.h&quot;
 
 #include &quot;ADM_commonUI/GUI_accelRender.h&quot;

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/GUI_sdlRender.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/GUI_sdlRender.cpp	2007-09-30 16:29:29 UTC (rev 3607)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/GUI_sdlRender.cpp	2007-09-30 16:49:31 UTC (rev 3608)
@@ -14,7 +14,9 @@
 //  The pitch stride has to be changed as there could be some padding depending on the OS
 //
 //
-#include &quot;config.h&quot;
+
+#include &quot;default.h&quot;
+
 #if defined(USE_SDL)
 
 #include &lt;stdio.h&gt;
@@ -25,12 +27,17 @@
 #include &lt;sys/time.h&gt;
 
 extern &quot;C&quot; {
+// get rid of warnings due to different definitions
+#undef HAVE_INTTYPES_H
+#undef HAVE_MALLOC_H
+#undef HAVE_STDINT_H
+#undef HAVE_STDLIB_H
+#undef HAVE_STRING_H
+#undef HAVE_SYS_TYPES_H
 #include &quot;SDL/SDL.h&quot;
 #include &quot;SDL/SDL_syswm.h&quot;
 }
 
-#include &quot;default.h&quot;
-
 #include &quot;ADM_colorspace/colorspace.h&quot;
 #include &quot;ADM_colorspace/ADM_rgb.h&quot;
 #include &quot;ADM_commonUI/GUI_render.h&quot;

Modified: branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/Makefile.am
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/Makefile.am	2007-09-30 16:29:29 UTC (rev 3607)
+++ branches/avidemux_2.4_branch/avidemux/ADM_userInterfaces/ADM_commonUI/Makefile.am	2007-09-30 16:49:31 UTC (rev 3608)
@@ -15,6 +15,9 @@
 DIA_ocr.cpp \
 DIA_tsSub.cpp \
 DIA_flyEq2.cpp \
+DIA_flyThreshold.cpp \
+DIA_flySwissArmyKnife.cpp \
+DIA_flyParticle.cpp \
 DIA_flv1.cpp
 
 commonObjs:=$(subst .cpp,.o,$(libADM_CommonUI_a_SOURCES))

Modified: branches/avidemux_2.4_branch/avidemux/ADM_video/ADM_confCouple.h
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_video/ADM_confCouple.h	2007-09-30 16:29:29 UTC (rev 3607)
+++ branches/avidemux_2.4_branch/avidemux/ADM_video/ADM_confCouple.h	2007-09-30 16:49:31 UTC (rev 3608)
@@ -20,7 +20,7 @@
  #ifndef __CONFCOUPLE__
  #define __CONFCOUPLE__
 
-//#include &lt;string.h&gt;
+#include &lt;string&gt;
 
 
 class CONFcouple
@@ -39,6 +39,7 @@
 			uint8_t setCouple(const char *name,int32_t value);
 			uint8_t setCouple(const char *name,const char *value);
 			uint8_t setCouple(const char *name,const ADM_filename *value);
+			uint8_t setCouple(const char *name,const std::string &amp; value);
 			uint8_t setCouple(const char *name,double value);
 			uint8_t setCouple(const char *name,float value);
 
@@ -46,6 +47,7 @@
 			uint8_t getCouple(const char *name,uint32_t *value);
 			uint8_t getCouple(const char *name,char **value);
 			uint8_t getCouple(const char *name,ADM_filename **value);
+			uint8_t getCouple(const char *name,std::string *value);
 			uint8_t getCouple(const char *name,double *value);
 			uint8_t getCouple(const char *name,float *value);
 			uint32_t getNumber(void) { return nb;};

Modified: branches/avidemux_2.4_branch/avidemux/ADM_video/ADM_confCouples.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_video/ADM_confCouples.cpp	2007-09-30 16:29:29 UTC (rev 3607)
+++ branches/avidemux_2.4_branch/avidemux/ADM_video/ADM_confCouples.cpp	2007-09-30 16:49:31 UTC (rev 3608)
@@ -14,17 +14,9 @@
  *   (at your option) any later version.                                   *
  *                                                                         *
  ***************************************************************************/
-#include &quot;config.h&quot;
- 
-#include &lt;stdio.h&gt;
-#include &lt;stdlib.h&gt;
-#include &lt;string.h&gt;
 
-#include &lt;time.h&gt;
-#include &lt;sys/time.h&gt;
+#include &quot;default.h&quot;
 
-
-
 #include &quot;fourcc.h&quot;
 #include &quot;avio.hxx&quot;
 #include &lt;ADM_assert.h&gt;
@@ -117,8 +109,17 @@
 	cur++;
 	return 1;
 }
+uint8_t CONFcouple::setCouple(const char *myname,const std::string &amp; val)
+{
+	ADM_assert(cur&lt;nb);
 
+	name[cur]=ADM_strdup(myname);
+	value[cur]=ADM_strdup(val.c_str());
+	cur++;
+	return 1;
+}
 
+
 uint8_t CONFcouple::getCouple(const char *myname,uint32_t *val)
 {
 	int32_t index=lookupName(myname);
@@ -155,9 +156,18 @@
 	*val=(ADM_filename *)ADM_strdup(value[index]);
 	return 1;
 }
+uint8_t CONFcouple::getCouple(const char *myname,std::string *val)
+{
+	int32_t index=lookupName(myname);
+
+	ADM_assert(index!=-1);
+	ADM_assert(index&lt;(int)nb);
+	*val=value[index];
+	return 1;
+}
 uint8_t CONFcouple::getCouple(const char *myname,float *val)
 {
-int32_t index=lookupName(myname);
+	int32_t index=lookupName(myname);
 
 	ADM_assert(index!=-1);
 	ADM_assert(index&lt;(int)nb);

Modified: branches/avidemux_2.4_branch/avidemux/ADM_video/ADM_vidFont.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_video/ADM_vidFont.cpp	2007-09-30 16:29:29 UTC (rev 3607)
+++ branches/avidemux_2.4_branch/avidemux/ADM_video/ADM_vidFont.cpp	2007-09-30 16:49:31 UTC (rev 3608)
@@ -14,13 +14,10 @@
  *   (at your option) any later version.                                   *
  *                                                                         *
  ***************************************************************************/
-#include &lt;stdio.h&gt;
-#include &lt;stdlib.h&gt;
+
+#include &quot;default.h&quot;
+
 #include &lt;iconv.h&gt;
-#include &lt;string.h&gt; // thanks !
-#include &quot;config.h&quot;
-#include &lt;errno.h&gt;
-#include &quot;ADM_utilities/default.h&quot;
 
  #ifdef USE_FREETYPE
 

Modified: branches/avidemux_2.4_branch/avidemux/ADM_video/ADM_vidFont.h
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_video/ADM_vidFont.h	2007-09-30 16:29:29 UTC (rev 3607)
+++ branches/avidemux_2.4_branch/avidemux/ADM_video/ADM_vidFont.h	2007-09-30 16:49:31 UTC (rev 3608)
@@ -18,8 +18,17 @@
 #undef free
 #undef alloc
 #undef realloc
+#ifdef HAVE_UNISTD_H
+// avoid warnings due to different definition of this in freetype headers
+#define WE_DO_HAVE_UNISTD_H
+#undef HAVE_UNISTD_H
+#endif
  #include &lt;ft2build.h&gt;
  #include FT_FREETYPE_H
+#ifdef WE_DO_HAVE_UNISTD_H
+#undef HAVE_UNISTD_H
+#define HAVE_UNISTD_H
+#endif
 
  class ADMfont
  {

Modified: branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/ADM_vidComputeAverage.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/ADM_vidComputeAverage.cpp	2007-09-30 16:29:29 UTC (rev 3607)
+++ branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/ADM_vidComputeAverage.cpp	2007-09-30 16:49:31 UTC (rev 3608)
@@ -18,20 +18,13 @@
  *                                                                         *
  ***************************************************************************/
  
- 
-#include &lt;stdio.h&gt;
-#include &lt;stdlib.h&gt;
-#include &lt;string.h&gt;
-#include &lt;ADM_assert.h&gt;
-#include &lt;math.h&gt;
+#include &quot;default.h&quot;
 
-#include &quot;config.h&quot;
+#include &quot;ADM_assert.h&quot;
 #include &quot;fourcc.h&quot;
 #include &quot;avio.hxx&quot;
-#include &quot;config.h&quot;
 #include &quot;avi_vars.h&quot;
 
-
 #include &quot;ADM_toolkit/toolkit.hxx&quot;
 #include &quot;ADM_editor/ADM_edit.hxx&quot;
 #include &quot;ADM_video/ADM_genvideo.hxx&quot;
@@ -67,12 +60,13 @@
 ADMVideoComputeAverage::ADMVideoComputeAverage(AVDMGenericVideoStream *in,CONFcouple *couples)
 			
 {
-    _in=in;
-    memcpy(&amp;_info,in-&gt;getInfo(),sizeof(_info));
+    _in = in;
+    memcpy (&amp;_info, in-&gt;getInfo(), sizeof(_info));
     _info.encoding = 1;	
-    _uncompressed = new ADMImage (_in-&gt;getInfo()-&gt;width,_in-&gt;getInfo()-&gt;height);
+    _uncompressed = new ADMImage (_in-&gt;getInfo()-&gt;width, _in-&gt;getInfo()-&gt;height);
     ADM_assert(_uncompressed);
-    _param=NEW (COMPUTEAVERAGE_PARAM);
+    _param = new COMPUTEAVERAGE_PARAM;
+
     if (couples)
     {
         GET(start_frame);

Modified: branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/ADM_vidParticle.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/ADM_vidParticle.cpp	2007-09-30 16:29:29 UTC (rev 3607)
+++ branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/ADM_vidParticle.cpp	2007-09-30 16:49:31 UTC (rev 3608)
@@ -15,20 +15,15 @@
  *                                                                         *
  ***************************************************************************/
  
- 
-#include &lt;stdio.h&gt;
-#include &lt;stdlib.h&gt;
-#include &lt;string.h&gt;
-#include &lt;ADM_assert.h&gt;
+#include &quot;default.h&quot;
+
 #include &lt;math.h&gt;
 
-#include &quot;config.h&quot;
+#include &quot;ADM_assert.h&quot;
 #include &quot;fourcc.h&quot;
 #include &quot;avio.hxx&quot;
-#include &quot;config.h&quot;
 #include &quot;avi_vars.h&quot;
 
-
 #include &quot;ADM_toolkit/toolkit.hxx&quot;
 #include &quot;ADM_editor/ADM_edit.hxx&quot;
 #include &quot;ADM_video/ADM_genvideo.hxx&quot;
@@ -41,6 +36,7 @@
 #include &quot;ADM_userInterfaces/ADM_commonUI/DIA_factory.h&quot;
 
 #include &quot;ADM_vidParticle.h&quot;
+#include &quot;DIA_flyDialog.h&quot; // for MenuMapping
 
 FILE * ADMVideoParticle::outfp = 0;
 uint32_t ADMVideoParticle::last_frame_written = 0xffffffff;
@@ -66,7 +62,7 @@
     _info.encoding = 1;
     _uncompressed = new ADMImage(_in-&gt;getInfo()-&gt;width, _in-&gt;getInfo()-&gt;height);
     ADM_assert(_uncompressed);
-    _param = NEW(PARTICLE_PARAM);
+    _param = new PARTICLE_PARAM;
 
     if (couples)
     {
@@ -78,8 +74,7 @@
         GET(bottom_crop);
         GET(output_format);
 
-        char * tmp;
-        GET2(output_file, tmp);
+        GET(output_file);
         GET(camera_number);
         GET(debug);
     }
@@ -92,7 +87,7 @@
         _param-&gt;top_crop = 0;
         _param-&gt;bottom_crop = 0;
         _param-&gt;output_format = OUTPUTFMT_FORMAT_NEW;
-        _param-&gt;output_file = ADM_strdup (&quot;&quot;);
+        // _param-&gt;output_file = &quot;&quot;; // implicit
         _param-&gt;camera_number = 1;
         _param-&gt;debug = 0;
     }
@@ -122,8 +117,37 @@
 
 uint8_t ADMVideoParticle::configure(AVDMGenericVideoStream *in)
 {
-    UNUSED_ARG(in);
+    diaMenuEntry tOutputFmt [] = {
+        { OUTPUTFMT_FORMAT_NEW,
+          QT_TR_NOOP(&quot;New format, preferred, good for Tracker3D&quot;), NULL },
+        { OUTPUTFMT_FORMAT_OLD,
+          QT_TR_NOOP(&quot;Old format that Tracker3D can't read directly&quot;), NULL },
+    };
 
+    diaElemMenu output_format
+        (&amp;(_param-&gt;output_format), QT_TR_NOOP(&quot;Output _Format:&quot;),
+         sizeof (tOutputFmt) / sizeof (diaMenuEntry), tOutputFmt);
+
+    MenuMapping menu_mapping [] = {
+        { &quot;outputFormatMenu&quot;, my_offsetof (PARTICLE_PARAM, output_format),
+          sizeof (tOutputFmt) / sizeof (diaMenuEntry), tOutputFmt },
+    };
+
+    uint8_t ret = DIA_particle (_in, _param, menu_mapping,
+                                sizeof (menu_mapping) / sizeof (MenuMapping));
+    if (ret == 1)
+    {
+        return ret;
+    }
+    else if (ret == 0) // 0 = cancel
+    {
+        return ret;
+    }
+    else
+    {
+        ADM_assert (ret == 255); // 255 = whizzy dialog not implemented
+    }
+
     diaElemUInteger min_area
         (&amp;(_param-&gt;min_area),
          QT_TR_NOOP(&quot;Mi_nimum area for a particle to be detected:&quot;), 1, 0x7fffffff);
@@ -144,20 +168,8 @@
         (&amp;(_param-&gt;bottom_crop),
          QT_TR_NOOP(&quot;_Bottom crop (ignore particles in):&quot;), 0, 0x7fffffff);
 
-    diaMenuEntry tOutputFmt [] = {
-        { OUTPUTFMT_FORMAT_NEW,
-          QT_TR_NOOP(&quot;New format, preferred, good for Tracker3D&quot;), NULL },
-        { OUTPUTFMT_FORMAT_OLD,
-          QT_TR_NOOP(&quot;Old format that Tracker3D can't read directly&quot;), NULL },
-    };
-
-    diaElemMenu output_format
-        (&amp;(_param-&gt;output_format), QT_TR_NOOP(&quot;_Output Format:&quot;),
-         sizeof (tOutputFmt) / sizeof (diaMenuEntry), tOutputFmt);
-
     diaElemFile output_file
-        (1, const_cast&lt;char **&gt;(&amp;(_param-&gt;output_file)),
-         QT_TR_NOOP(&quot;_Output File:&quot;), &quot;pts&quot;);
+        (1, &amp;(_param-&gt;output_file), QT_TR_NOOP(&quot;_Output File:&quot;), &quot;pts&quot;);
 
     diaElemUInteger camera_number
         (&amp;(_param-&gt;camera_number), QT_TR_NOOP(&quot;_Camera number:&quot;), 1, 0x7fffffff);
@@ -169,9 +181,9 @@
                           &amp;top_crop, &amp;bottom_crop, &amp;output_format,
                           &amp;output_file, &amp;camera_number, &amp;debug };
 
-    uint8_t ret = diaFactoryRun(&quot;Particle&quot;, sizeof (elems) / sizeof (diaElem *), elems);
+    ret = diaFactoryRun (&quot;Particle Detection Configuration&quot;,
+                         sizeof (elems) / sizeof (diaElem *), elems);
     return ret;
-	
 }
 
 ADMVideoParticle::~ADMVideoParticle()
@@ -201,11 +213,11 @@
                           _param-&gt;top_crop, _param-&gt;bottom_crop);
     }
 
-    if (_param-&gt;output_file &amp;&amp; _param-&gt;output_file[0])
+    if (!_param-&gt;output_file.empty())
     {
         cptr += snprintf (cptr, CONF_LEN - (cptr - conf), &quot;, %s Output to %s&quot;,
                           _param-&gt;output_format == OUTPUTFMT_FORMAT_OLD
-                          ? &quot;Old&quot; : &quot;New&quot;, _param-&gt;output_file);
+                          ? &quot;Old&quot; : &quot;New&quot;, _param-&gt;output_file.c_str());
     }
 
     cptr += snprintf (cptr, CONF_LEN - (cptr - conf), &quot;, Camera # %u&quot;,
@@ -224,51 +236,28 @@
     if (frame &gt;= _info.nb_frames)
         return 0;
 
-    uint32_t real_frame = frame + _info.orgFrame;
-
-    uint32_t debug = _param-&gt;debug;
-
-    if (debug &amp; 1)
+    if (_param-&gt;debug &amp; 1)
         printf (&quot;in ADMVideoParticle::getFrameNumberNoAlloc(%d, ...)\n&quot;, frame);
 
-    uint32_t w = _info.width;
-    uint32_t h = _info.height;
-    uint32_t planesize = w * h;
-    uint32_t uvplanesize = planesize &gt;&gt; 2;
-    uint32_t size = planesize + (uvplanesize * 2);
-    *len = size;
-			
     if (!_in-&gt;getFrameNumberNoAlloc (frame, len, _uncompressed, flags))
         return 0;
-    ADMImage * image = _uncompressed;
 
-    memset (UPLANE (data), 128, uvplanesize);
-    memset (VPLANE (data), 128, uvplanesize);
-    memset (YPLANE (data), 0, planesize);
+    uint32_t planesize = _info.width * _info.height;
+    uint32_t size = (planesize * 3) &gt;&gt; 1;
+    *len = size;
 
-    // HERE: we should erase anything outside the ROI (region of interest),
-    // unless we decide to handle that some other way and/or place...
-
-    uint8_t * imagePixels = YPLANE (image);
-    ImageTool imtool (imagePixels, w, h, data);
-    imtool.setDebug (debug);
-    imtool.setMinArea (_param-&gt;min_area);
-    imtool.setMaxArea (_param-&gt;max_area);
-    static uint32_t particleNum = 0;
-
+    uint32_t real_frame = frame + _info.orgFrame;
     OutputFmt outfmt = static_cast &lt;OutputFmt&gt; (_param-&gt;output_format);
-    uint32_t camera_number = _param-&gt;camera_number;
 
-    if (!outfp &amp;&amp; real_frame == 0
-        &amp;&amp; _param-&gt;output_file &amp;&amp; _param-&gt;output_file[0])
+    if (!outfp &amp;&amp; real_frame == 0 &amp;&amp; !_param-&gt;output_file.empty())
     {
         printf (&quot;Preparing to write particle list to %s\n&quot;,
-                _param-&gt;output_file);
+                _param-&gt;output_file.c_str());
 
-        outfp = fopen (_param-&gt;output_file, &quot;w&quot;);
+        outfp = fopen (_param-&gt;output_file.c_str(), &quot;w&quot;);
         if (!outfp)
         {
-            perror (_param-&gt;output_file);
+            perror (_param-&gt;output_file.c_str());
         }
         else if (real_frame == 0) // ick
         {
@@ -279,10 +268,59 @@
         }
     }
 
-    for (uint32_t y = 0; y &lt; h; y++)
+    uint8_t ret = doParticle (_uncompressed, data, _in, real_frame,
+                              (last_frame_written == real_frame) ? 0 : outfp,
+                              _param, _info.width, _info.height);
+
+    last_frame_written = real_frame;
+
+    if (outfp &amp;&amp; real_frame &gt;= _info.nb_frames + _info.orgFrame - 1)
     {
-        uint8_t * pixelrow = imagePixels + (y * w);
-        for (uint32_t x = 0; x &lt; w; x++)
+        fclose (outfp);
+        outfp = 0;
+        printf (&quot;Finished writing particle list to %s\n&quot;,
+                _param-&gt;output_file.c_str());
+    }
+
+    return ret;
+}
+
+uint8_t
+ADMVideoParticle::doParticle (ADMImage * image, ADMImage * data,
+                              AVDMGenericVideoStream * in,
+                              uint32_t real_frame,
+                              FILE * do_outfp, PARTICLE_PARAM * param,
+                              uint32_t width, uint32_t height)
+{
+    uint32_t debug = param-&gt;debug;
+
+    uint32_t planesize = width * height;
+    uint32_t uvplanesize = planesize &gt;&gt; 2;
+    uint32_t size = planesize + (uvplanesize * 2);
+			
+    memset (UPLANE (data), 128, uvplanesize);
+    memset (VPLANE (data), 128, uvplanesize);
+    memset (YPLANE (data), 0, planesize);
+
+    // HERE: we should erase anything outside the ROI (region of interest),
+    // unless we decide to handle that some other way and/or place...
+
+    uint8_t * imagePixels = YPLANE (image);
+    ImageTool imtool (imagePixels, width, height, data);
+    imtool.setDebug (debug);
+    imtool.setMinArea (param-&gt;min_area);
+    imtool.setMaxArea (param-&gt;max_area);
+    imtool.setCropping (param-&gt;left_crop, param-&gt;right_crop,
+                        param-&gt;top_crop, param-&gt;bottom_crop);
+    static uint32_t particleNum = 0;
+
+    OutputFmt outfmt = static_cast &lt;OutputFmt&gt; (param-&gt;output_format);
+    uint32_t camera_number = param-&gt;camera_number;
+
+    for (uint32_t y = param-&gt;top_crop; y &lt; height - param-&gt;bottom_crop; y++)
+    {
+        uint8_t * pixelrow = imagePixels + (y * width);
+        for (uint32_t x = param-&gt;left_crop; x &lt; width - param-&gt;right_crop; x++)
         {
             if (imtool.goodPixel (pixelrow [x]))
             {
@@ -292,23 +330,24 @@
                 uint32_t area = imtool.particleArea();
                 float centroid_x = imtool.particleCentroidX();
                 float centroid_y = imtool.particleCentroidY();
+
                 if (debug &amp; 0x01)
                     printf (&quot;%d %d %.6f %.6f %d\n&quot;,
                             ++particleNum, area, centroid_x, centroid_y,
                             real_frame + 1);
 
-                if (!outfp || last_frame_written == real_frame)
+                if (!do_outfp)
                     continue;
 
                 if (outfmt == OUTPUTFMT_FORMAT_NEW)
                 {
-                    fprintf (outfp, &quot;%d %d %.6f %.6f %d %d\n&quot;,
+                    fprintf (do_outfp, &quot;%d %d %.6f %.6f %d %d\n&quot;,
                              real_frame + 1, camera_number, centroid_x, centroid_y,
                              area, ++particleNum);
                 }
                 else
                 {
-                    fprintf (outfp, &quot;%d %d %.6f %.6f %d\n&quot;,
+                    fprintf (do_outfp, &quot;%d %d %.6f %.6f %d\n&quot;,
                              ++particleNum, area, centroid_x, centroid_y,
                              real_frame + 1);
                 }
@@ -316,16 +355,6 @@
         }
     }
 
-    last_frame_written = real_frame;
-
-    if (outfp &amp;&amp; real_frame &gt;= _info.nb_frames + _info.orgFrame - 1)
-    {
-        fclose (outfp);
-        outfp = 0;
-        printf (&quot;Finished writing particle list to %s\n&quot;,
-                _param-&gt;output_file);
-    }
-
     data-&gt;copyInfo(image);
     return 1;
 }	                           

Modified: branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/ADM_vidParticle.h
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/ADM_vidParticle.h	2007-09-30 16:29:29 UTC (rev 3607)
+++ branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/ADM_vidParticle.h	2007-09-30 16:49:31 UTC (rev 3608)
@@ -16,10 +16,13 @@
  
 #ifndef __PARTICLE__
 #define __PARTICLE__   
+
+#include &lt;string&gt;
+
 #include &quot;ADM_video/ADM_cache.h&quot;
+
 struct PARTICLE_PARAM
 {
-
     uint32_t min_area;
     uint32_t max_area;
     uint32_t left_crop;
@@ -27,12 +30,21 @@
     uint32_t top_crop;
     uint32_t bottom_crop;
     uint32_t output_format;
-    const char * output_file;
+    std::string output_file;
     uint32_t camera_number;
     uint32_t debug;
-
 };
 
+// Alas, because offsetof() is only supposed to work on POD (plain old data)
+// structs, and our PARTICLE_PARAM includes a std::string (which has a
+// constructor, and which causes PARTICLE_PARAM to therefore have an implicit
+// constructor), we need to define our own offsetof() to use for the dialog
+// menus.  See
+// <A HREF="http://www.cplusplus.com/reference/clibrary/cstddef/offsetof.html">http://www.cplusplus.com/reference/clibrary/cstddef/offsetof.html</A> for more
+// on offsetof().
+
+#define my_offsetof(_type, _memb) (size_t (&amp;(((_type *)1)-&gt;_memb)) - 1)
+
 class ADMVideoParticle : public AVDMGenericVideoStream
 {
 
@@ -56,17 +68,22 @@
      };
 
 
-     ADMVideoParticle(  AVDMGenericVideoStream *in,CONFcouple *setup);
+     ADMVideoParticle (AVDMGenericVideoStream *in, CONFcouple *setup);
 
      ~ADMVideoParticle();
 
-     virtual uint8_t 	getFrameNumberNoAlloc(uint32_t frame, uint32_t *len,
-                                              ADMImage *data,uint32_t *flags);
+     virtual uint8_t getFrameNumberNoAlloc (uint32_t frame, uint32_t *len,
+                                            ADMImage *data,uint32_t *flags);
 
-     virtual uint8_t 	configure( AVDMGenericVideoStream *instream);
-     virtual char 		   *printConf(void);
-     virtual uint8_t 	getCoupledConf( CONFcouple **couples);
+     virtual uint8_t configure (AVDMGenericVideoStream *instream);
+     virtual char * printConf (void);
+     virtual uint8_t getCoupledConf (CONFcouple **couples);
 							
+     static uint8_t doParticle (ADMImage * image, ADMImage * data,
+                                AVDMGenericVideoStream * in,
+                                uint32_t real_frame,
+                                FILE * do_outfp, PARTICLE_PARAM * param,
+                                uint32_t width, uint32_t height);
 };
 
 //////////////////////////////////////////////////////////////////////////////
@@ -139,6 +156,10 @@
     uint8_t * my_pixels;
     uint32_t my_w;
     uint32_t my_h;
+    uint32_t my_left_margin;
+    uint32_t my_right_margin;
+    uint32_t my_top_margin;
+    uint32_t my_bottom_margin;
     ADMImage * my_outImage;
     uint32_t my_minArea;
     uint32_t my_maxArea;
@@ -177,6 +198,10 @@
         : my_pixels (pixels),
           my_w (w),
           my_h (h),
+          my_left_margin (0),
+          my_right_margin (w),
+          my_top_margin (0),
+          my_bottom_margin (h),
           my_outImage (outImage),
           my_particleArea (0),
           my_particleCentroidX (0),
@@ -185,6 +210,15 @@
     {
     }
 
+    void setCropping (uint32_t left_crop, uint32_t right_crop,
+                      uint32_t top_crop, uint32_t bottom_crop)
+    {
+        my_left_margin = left_crop;
+        my_right_margin = my_w - right_crop;
+        my_top_margin = top_crop;
+        my_bottom_margin = my_h - bottom_crop;
+    }
+
     // Return true if the pixel is part of a particle.
 
     bool goodPixel (uint8_t pixel) const
@@ -207,7 +241,9 @@
     }
 
     // This one does bounds checking, and forces references &quot;off the edge&quot; to
-    // the nearest valid pixel - it's useful for convolutions.
+    // the nearest valid pixel - it's useful for convolutions.  It does not
+    // currently respect the crop settings, only because we know that this
+    // function is used only when those aren't set.
 
     uint8_t &amp; getPixelSafely (int32_t x, int32_t y) const
     {
@@ -247,7 +283,9 @@
 
     bool validPixel (uint32_t x, uint32_t y) const
     {
-        return (x &lt; my_w &amp;&amp; y &lt; my_h);
+        // return (x &lt; my_w &amp;&amp; y &lt; my_h);
+        return (x &gt;= my_left_margin &amp;&amp; x &lt; my_right_margin
+                &amp;&amp; y &gt;= my_top_margin &amp;&amp; y &lt; my_bottom_margin);
     }
 
     bool goodPixel (uint32_t x, uint32_t y) const
@@ -310,4 +348,11 @@
         my_maxArea = newMaxArea;
     }
 };
+
+struct MenuMapping;
+uint8_t DIA_particle (AVDMGenericVideoStream *in,
+                      PARTICLE_PARAM * param,
+                      const MenuMapping * menu_mapping,
+                      uint32_t menu_mapping_count);
+
 #endif

Modified: branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/ADM_vidSRT.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/ADM_vidSRT.cpp	2007-09-30 16:29:29 UTC (rev 3607)
+++ branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/ADM_vidSRT.cpp	2007-09-30 16:49:31 UTC (rev 3608)
@@ -14,19 +14,15 @@
  *   (at your option) any later version.                                   *
  *                                                                         *
  ***************************************************************************/
-#include &quot;config.h&quot;
 
-#include &lt;stdio.h&gt;
-#include &lt;stdlib.h&gt;
-#include &lt;string.h&gt;
+#include &quot;default.h&quot;
+
 #include &lt;math.h&gt;
-#include &lt;math.h&gt;
 #include &lt;iconv.h&gt;
 
 
 #ifdef USE_FREETYPE
 
-#include &quot;default.h&quot;
 #include &quot;ADM_osSupport/ADM_misc.h&quot;
 
 #include &quot;ADM_toolkit/toolkit.hxx&quot;
@@ -39,14 +35,14 @@
 #include &quot;ADM_video/ADM_vidFont.h&quot;
 #include &quot;ADM_videoFilter/ADM_vidSRT.h&quot;
 
-#include &lt;ADM_assert.h&gt;
+#include &quot;ADM_assert.h&quot;
 
 #include &quot;ADM_osSupport/ADM_debugID.h&quot;
 #define MODULE_NAME MODULE_FILTER
 #include &quot;ADM_osSupport/ADM_debug.h&quot;
 #include &quot;ADM_filter/video_filters.h&quot;
 
-#include &lt;prefs.h&gt;
+#include &quot;prefs.h&quot;
 
 static FILTER_PARAM subParam={15,{&quot;_fontsize&quot;,&quot;_subname&quot;,&quot;_fontname&quot;,&quot;_charset&quot;,
 				&quot;_baseLine&quot;,&quot;_Y_percent&quot;,&quot;_U_percent&quot;,&quot;_V_percent&quot;,

Modified: branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/ADM_vidSRTRender.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/ADM_vidSRTRender.cpp	2007-09-30 16:29:29 UTC (rev 3607)
+++ branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/ADM_vidSRTRender.cpp	2007-09-30 16:49:31 UTC (rev 3608)
@@ -14,19 +14,15 @@
  *   (at your option) any later version.                                   *
  *                                                                         *
  ***************************************************************************/
-#include &quot;config.h&quot;
 
-#include &lt;stdio.h&gt;
-#include &lt;stdlib.h&gt;
-#include &lt;string.h&gt;
+#include &quot;default.h&quot;
+
 #include &lt;math.h&gt;
-#include &lt;math.h&gt;
 #include &lt;iconv.h&gt;
 
 
 #ifdef USE_FREETYPE
 
-#include &quot;default.h&quot;
 #include &quot;ADM_osSupport/ADM_misc.h&quot;
 
 
@@ -37,7 +33,7 @@
 
 #include &quot;ADM_video/ADM_vidFont.h&quot;
 #include &quot;ADM_videoFilter/ADM_vidSRT.h&quot;
-#include &lt;ADM_assert.h&gt;
+#include &quot;ADM_assert.h&quot;
 
 #include &quot;ADM_osSupport/ADM_debugID.h&quot;
 #define MODULE_NAME MODULE_FILTER

Modified: branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/ADM_vidSRTload.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/ADM_vidSRTload.cpp	2007-09-30 16:29:29 UTC (rev 3607)
+++ branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/ADM_vidSRTload.cpp	2007-09-30 16:49:31 UTC (rev 3608)
@@ -24,20 +24,16 @@
  *   (at your option) any later version.                                   *
  *                                                                         *
  ***************************************************************************/
-#include &quot;config.h&quot;
 
-#include &lt;stdio.h&gt;
-#include &lt;stdlib.h&gt;
-#include &lt;string.h&gt;
+#include &quot;default.h&quot;
+
 #include &lt;math.h&gt;
-#include &lt;math.h&gt;
 #include &lt;iconv.h&gt;
 #include &lt;errno.h&gt;
 
 
 #ifdef USE_FREETYPE
 //#define __STDC_ISO_10646__
-#include &quot;default.h&quot;
 #include &quot;ADM_osSupport/ADM_misc.h&quot;
 
 #include &quot;ADM_toolkit/toolkit.hxx&quot;
@@ -48,7 +44,7 @@
 
 #include &quot;ADM_video/ADM_vidFont.h&quot;
 #include &quot;ADM_videoFilter/ADM_vidSRT.h&quot;
-#include &lt;ADM_assert.h&gt;
+#include &quot;ADM_assert.h&quot;
 
 #include &quot;ADM_osSupport/ADM_debugID.h&quot;
 #define MODULE_NAME MODULE_FILTER

Modified: branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/ADM_vidSwissArmyKnife.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/ADM_vidSwissArmyKnife.cpp	2007-09-30 16:29:29 UTC (rev 3607)
+++ branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/ADM_vidSwissArmyKnife.cpp	2007-09-30 16:49:31 UTC (rev 3608)
@@ -15,13 +15,10 @@
  *                                                                         *
  ***************************************************************************/
  
- 
+#include &quot;default.h&quot;
+
 #include &lt;ctype.h&gt;
-#include &lt;stdio.h&gt;
-#include &lt;stdlib.h&gt;
-#include &lt;string.h&gt;
 #include &lt;errno.h&gt;
-#include &lt;ADM_assert.h&gt;
 #include &lt;math.h&gt;
 #include &lt;sys/types.h&gt;
 #include &lt;sys/stat.h&gt;
@@ -30,10 +27,9 @@
 #include &lt;fstream&gt;
 #include &lt;iterator&gt;
 
-#include &quot;config.h&quot;
+#include &quot;ADM_assert.h&quot;
 #include &quot;fourcc.h&quot;
 #include &quot;avio.hxx&quot;
-#include &quot;config.h&quot;
 #include &quot;avi_vars.h&quot;
 
 #include &quot;ADM_toolkit/toolkit.hxx&quot;
@@ -50,6 +46,7 @@
 #include &quot;ADM_vidSwissArmyKnife.h&quot;
 #include &quot;ADM_vidParticle.h&quot; // for ImageTool
 #include &quot;ADM_vidComputeAverage.h&quot; // for ADMVideoComputeAverage::FileHeader
+#include &quot;DIA_flyDialog.h&quot; // for MenuMapping
 
 static const int MAX_PIXEL_LUMA = 255;
 
@@ -57,27 +54,27 @@
 {
     15,
     { &quot;tool&quot;, &quot;input_type&quot;, &quot;input_file&quot;, &quot;load_bias&quot;,              // 4
-      &quot;load_multiplier&quot;, &quot;input_constant&quot;, &quot;memory_constant_denom&quot;, // + 3 = 7
+      &quot;load_multiplier&quot;, &quot;input_constant&quot;, &quot;memory_constant_alpha&quot;, // + 3 = 7
       &quot;init_start_frame&quot;, &quot;init_end_frame&quot;, &quot;init_by_rolling&quot;,      // + 3 = 10
-      &quot;bias&quot;, &quot;scale_from_min&quot;, &quot;scale_from_max&quot;,                   // + 3 = 13
+      &quot;bias&quot;, &quot;result_bias&quot;, &quot;result_multiplier&quot;,                   // + 3 = 13
       &quot;histogram_frame_interval&quot;, &quot;debug&quot;                           // + 2 = 15
     }
 };
 
 ADMVideoSwissArmyKnife::ToolMap ADMVideoSwissArmyKnife::tool_map [] =
 {
-    { TOOL_A,         &quot;A&quot;,        &quot;%s&quot; },
-    { TOOL_P,         &quot;P&quot;,        &quot;P&quot; },
-    { TOOL_P_MINUS_A, &quot;P-A&quot;,      &quot;P-%s&quot; },
-    { TOOL_A_MINUS_P, &quot;A-P&quot;,      &quot;%s-P&quot; },
-    { TOOL_P_PLUS_A,  &quot;P+A&quot;,      &quot;P+%s&quot; },
-    { TOOL_P_TIMES_A, &quot;P*A&quot;,      &quot;P*%s&quot; },
-    { TOOL_P_DIVBY_A, &quot;P/A&quot;,      &quot;P/%s&quot; },
-    { TOOL_A_DIVBY_P, &quot;A/P&quot;,      &quot;%s/P&quot; },
-    { TOOL_MIN_P_A,   &quot;min(P,A)&quot;, &quot;min(P,%s)&quot; },
-    { TOOL_MAX_P_A,   &quot;max(P,A)&quot;, &quot;max(P,%s)&quot; },
+    { TOOL_A,         &quot;A&quot;,        &quot;%s&quot;,        &quot;%s&quot;     },
+    { TOOL_P,         &quot;P&quot;,        &quot;P&quot;,         &quot;P&quot;      },
+    { TOOL_P_MINUS_A, &quot;P-A&quot;,      &quot;P-%s&quot;,      &quot;P - %s&quot; },
+    { TOOL_A_MINUS_P, &quot;A-P&quot;,      &quot;%s-P&quot;,      &quot;%s - P&quot; },
+    { TOOL_P_PLUS_A,  &quot;P+A&quot;,      &quot;P+%s&quot;,      &quot;P + %s&quot; },
+    { TOOL_P_TIMES_A, &quot;P*A&quot;,      &quot;P*%s&quot;,      &quot;P * %s&quot; },
+    { TOOL_P_DIVBY_A, &quot;P/A&quot;,      &quot;P/%s&quot;,      &quot;P / %s&quot; },
+    { TOOL_A_DIVBY_P, &quot;A/P&quot;,      &quot;%s/P&quot;,      &quot;%s / P&quot; },
+    { TOOL_MIN_P_A,   &quot;min(P,A)&quot;, &quot;min(P,%s)&quot;, &quot;min (P, %s)&quot; },
+    { TOOL_MAX_P_A,   &quot;max(P,A)&quot;, &quot;max(P,%s)&quot;, &quot;max (P, %s)&quot; },
 
-    { TOOL_INVALID, 0, 0 }
+    { TOOL_INVALID, 0, 0, 0 }
 };
 
 // This is a hack to work around the fact that the ctor &amp; dtor get called
@@ -104,52 +101,56 @@
     _info.encoding = 1;
     _uncompressed = new ADMImage(_in-&gt;getInfo()-&gt;width, _in-&gt;getInfo()-&gt;height);
     ADM_assert(_uncompressed);
-    _param=NEW(SWISSARMYKNIFE_PARAM);
+    _param = new SWISSARMYKNIFE_PARAM;
 
     if (couples)
     {
         GET(tool);
         GET(input_type);
 
-        char * tmp;
-        GET2(input_file, tmp);
+        GET(input_file);
         GET(load_bias);
         GET(load_multiplier);
 
         GET(input_constant);
 
-        GET(memory_constant_denom);
+        GET(memory_constant_alpha);
         GET(init_start_frame);
         GET(init_end_frame);
         GET(init_by_rolling);
 
         GET(bias);
-        GET(scale_from_min);
-        GET(scale_from_max);
+        GET(result_bias);
+        GET(result_multiplier);
         GET(histogram_frame_interval);
         GET(debug);
+
+        _param-&gt;enable_preview
+            = (_param-&gt;input_type != INPUT_ROLLING_AVERAGE);
     }
     else
     {
         _param-&gt;tool = TOOL_P_MINUS_A;
         _param-&gt;input_type = INPUT_ROLLING_AVERAGE;
 
-        _param-&gt;input_file = ADM_strdup (&quot;&quot;);
+        // _param-&gt;input_file = &quot;&quot;; // implicit
         _param-&gt;load_bias = 0.0;
         _param-&gt;load_multiplier = 1.0;
 
         _param-&gt;input_constant = 0;
 
-        _param-&gt;memory_constant_denom = 100;
         _param-&gt;init_start_frame = 1;
         _param-&gt;init_end_frame = 100;
+        _param-&gt;memory_constant_alpha = 1.0 / _param-&gt;init_end_frame;
         _param-&gt;init_by_rolling = false;
 
         _param-&gt;bias = 128;
-        _param-&gt;scale_from_min = 0;
-        _param-&gt;scale_from_max = 255;
+        _param-&gt;result_bias = 0.0;
+        _param-&gt;result_multiplier = 1.0;
         _param-&gt;histogram_frame_interval = 0;
         _param-&gt;debug = 0;
+
+        _param-&gt;enable_preview = false;
     }
 
     // This is a hack to work around the fact that the ctor &amp; dtor get called
@@ -238,24 +239,22 @@
 
     CSET(input_constant);
 
-    CSET(memory_constant_denom);
+    CSET(memory_constant_alpha);
     CSET(init_start_frame);
     CSET(init_end_frame);
     CSET(init_by_rolling);
 
     CSET(bias);
-    CSET(scale_from_min);
-    CSET(scale_from_max);
+    CSET(result_bias);
+    CSET(result_multiplier);
     CSET(histogram_frame_interval);
     CSET(debug);
 
     return 1;
 }
 
-uint8_t ADMVideoSwissArmyKnife::configure(AVDMGenericVideoStream *in)
+uint8_t ADMVideoSwissArmyKnife::configure (AVDMGenericVideoStream *in)
 {
-    UNUSED_ARG(in);
-
     diaMenuEntry tTool [] = {
         { TOOL_A,          QT_TR_NOOP(&quot;P' = A&quot;), NULL },
         { TOOL_P,          QT_TR_NOOP(&quot;P' = P&quot;), NULL },
@@ -286,13 +285,38 @@
         (&amp;(_param-&gt;tool),
          QT_TR_NOOP(&quot;Select _Operation on each pixel P and input A:&quot;),
          sizeof (tTool) / sizeof (diaMenuEntry), tTool);
+
     diaElemMenu input_type
         (&amp;(_param-&gt;input_type),
          QT_TR_NOOP(&quot;Input _Type:&quot;),
          sizeof (tInputType) / sizeof (diaMenuEntry), tInputType);
 
+    MenuMapping menu_mapping [] = {
+        { &quot;operationMenu&quot;, my_offsetof (SWISSARMYKNIFE_PARAM, tool),
+          sizeof (tTool) / sizeof (diaMenuEntry), tTool },
+        { &quot;inputTypeMenu&quot;, my_offsetof (SWISSARMYKNIFE_PARAM, input_type),
+          sizeof (tInputType) / sizeof (diaMenuEntry), tInputType },
+    };
+
+    // printf (&quot;ADM_vidSwissArmyKnife: _param = %p\n&quot;, _param);
+    uint8_t ret = DIA_SwissArmyKnife (_in, this, _param, menu_mapping,
+                                      sizeof (menu_mapping)
+                                      / sizeof (MenuMapping));
+    if (ret == 1)
+    {
+        return ret;
+    }
+    else if (ret == 0) // 0 = cancel
+    {
+        return ret;
+    }
+    else
+    {
+        ADM_assert (ret == 255); // 255 = whizzy dialog not implemented
+    }
+
     diaElemFile input_file
-        (0, const_cast&lt;char **&gt;(&amp;(_param-&gt;input_file)),
+        (0, &amp;(_param-&gt;input_file),
          QT_TR_NOOP(&quot;Input _File (image or convolution kernel):&quot;));
     diaElemFloat load_bias
         (&amp;(_param-&gt;load_bias),
@@ -309,9 +333,9 @@
         (&amp;(_param-&gt;input_constant),
          QT_TR_NOOP(&quot;Input _Constant:&quot;), -99999, +99999); // arbitrary!
 
-    diaElemUInteger memory_constant_denom
-        (&amp;(_param-&gt;memory_constant_denom),
-         QT_TR_NOOP(&quot;Denominator of memory constant _alpha\n&quot;
+    diaElemFloat memory_constant_alpha
+        (&amp;(_param-&gt;memory_constant_alpha),
+         QT_TR_NOOP(&quot;Memory constant _alpha\n&quot;
            &quot;(where A = (1-alpha)*A + alpha*curr_frame):&quot;),
          0, 0x7fffffff);
     diaElemUInteger init_start_frame
@@ -330,12 +354,15 @@
     diaElemSlider bias
         (&amp;(_param-&gt;bias),
          QT_TR_NOOP(&quot;_Bias (will be added to result):&quot;), -256, +256);
-    diaElemSlider scale_from_min
-        (&amp;(_param-&gt;scale_from_min),
-         QT_TR_NOOP(&quot;Mi_nimum value (will be scaled to 0):&quot;), -1024, +1024);
-    diaElemSlider scale_from_max
-        (&amp;(_param-&gt;scale_from_max),
-         QT_TR_NOOP(&quot;Ma_ximum value (will be scaled to 255):&quot;), -1024, +1024);
+    diaElemFloat result_bias
+        (&amp;(_param-&gt;result_bias),
+         QT_TR_NOOP(&quot;_Result Bias (added to each result pixel):&quot;),
+         -99999, +99999); // arbitrary!
+    diaElemFloat result_multiplier
+        (&amp;(_param-&gt;result_multiplier),
+         QT_TR_NOOP(&quot;Result _Multiplier (each result pixel\n&quot;
+           &quot;multiplied by this):&quot;),
+         -99999, +99999); // arbitrary!
     diaElemUInteger histogram_frame_interval
         (&amp;(_param-&gt;histogram_frame_interval),
          QT_TR_NOOP(&quot;_Histogram every N frames (0 to disable):&quot;), 0, 0x7fffffff);
@@ -344,19 +371,19 @@
 
     diaElem * elems[] = { &amp;tool, &amp;input_type, &amp;input_file, &amp;load_bias,
                           &amp;load_multiplier, &amp;input_constant,
-                          &amp;memory_constant_denom, &amp;init_start_frame,
+                          &amp;memory_constant_alpha, &amp;init_start_frame,
                           &amp;init_end_frame, &amp;init_by_rolling,
-                          &amp;bias, &amp;scale_from_min, &amp;scale_from_max,
+                          &amp;bias, &amp;result_bias, &amp;result_multiplier,
                           &amp;histogram_frame_interval, &amp;debug };
 
-    uint8_t ret = diaFactoryRun(&quot;SwissArmyKnife&quot;, sizeof (elems) / sizeof (diaElem *), elems);
+    ret = diaFactoryRun (&quot;Swiss Army Knife Configuration&quot;,
+                         sizeof (elems) / sizeof (diaElem *), elems);
     if (ret) // 0 = cancel
     {
         myInfo-&gt;image_data_invalid = true;
         myInfo-&gt;histogram_data_invalid = true;
     }
     return ret;
-	
 }
 
 ADMVideoSwissArmyKnife::~ADMVideoSwissArmyKnife()
@@ -391,14 +418,20 @@
     _uncompressed = NULL;
 }
 
-char * ADMVideoSwissArmyKnife::printConf( void) 
+char * ADMVideoSwissArmyKnife::printConf ()
 {
+    return getConf (_param, false);
+}
+
+char * ADMVideoSwissArmyKnife::getConf (SWISSARMYKNIFE_PARAM * param,
+                                        bool forDialog)
+{
     const int CONF_LEN = 1024;
     static char conf[CONF_LEN];
 
     ToolMap * tm;
     for (tm = tool_map; tm-&gt;outputName; tm++)
-        if (tm-&gt;toolid == _param-&gt;tool)
+        if (tm-&gt;toolid == param-&gt;tool)
             break;
 
     char inputstr [CONF_LEN];
@@ -406,75 +439,91 @@
     where[0] = '\0';
     char moreinfo [256];
     moreinfo[0] = '\0';
-    const char * input_file = _param-&gt;input_file;
+    const char * input_file = param-&gt;input_file.c_str();
     if (!input_file || !*input_file)
         input_file = &quot;**** no file selected ****&quot;;
-    switch (_param-&gt;input_type)
+
+    const char * space = forDialog ? &quot; &quot; : &quot;&quot;;
+
+    switch (param-&gt;input_type)
     {
     case INPUT_CUSTOM_CONVOLUTION:
-        snprintf (inputstr, CONF_LEN, &quot;convolve(P,%s)&quot;, input_file);
+        snprintf (inputstr, CONF_LEN, &quot;convolve%s(P,%s%s)&quot;,
+                  space, space, input_file);
         break;
     case INPUT_FILE_IMAGE_FLOAT:
         snprintf (inputstr, CONF_LEN,
-                  (_param-&gt;load_bias == 0.0 &amp;&amp; _param-&gt;load_multiplier == 1.0)
-                  ? &quot;pixel_from(%s)&quot;
-                  : &quot;((pixel_from(%s)%+.6f)*%.6f)&quot;,
-                  input_file, _param-&gt;load_bias, _param-&gt;load_multiplier);
+                  (param-&gt;load_bias == 0.0 &amp;&amp; param-&gt;load_multiplier == 1.0)
+                  ? &quot;pixel_from%s(%s)&quot;
+                  : (forDialog ? &quot;((pixel_from%s(%s) + %.6f) * %.6f)&quot;
+                     : &quot;((pixel_from%s(%s)%+.6f)*%.6f)&quot;),
+                  space, input_file,
+                  param-&gt;load_bias, param-&gt;load_multiplier);
         break;
     case INPUT_FILE_IMAGE_INTEGER:
         snprintf (inputstr, CONF_LEN,
-                  (_param-&gt;load_bias == 0.0 &amp;&amp; _param-&gt;load_multiplier == 1.0)
-                  ? &quot;integer(pixel_from(%s))&quot;
-                  : &quot;integer((pixel_from(%s)%+.6f)*%.6f)&quot;,
-                  input_file, _param-&gt;load_bias, _param-&gt;load_multiplier);
+                  (param-&gt;load_bias == 0.0 &amp;&amp; param-&gt;load_multiplier == 1.0)
+                  ? &quot;integer(pixel_from%s(%s))&quot;
+                  : (forDialog ? &quot;integer((pixel_from%s(%s) + %.6f) * %.6f)&quot;
+                     : &quot;integer((pixel_from%s(%s)%+.6f)*%.6f)&quot;),
+                  space, input_file,
+                  param-&gt;load_bias, param-&gt;load_multiplier);
         break;
     case INPUT_CONSTANT_VALUE:
-        if (int (_param-&gt;input_constant) == _param-&gt;input_constant)
-            sprintf (inputstr, &quot;%d&quot;, int (_param-&gt;input_constant));
+        if (int (param-&gt;input_constant) == param-&gt;input_constant)
+            sprintf (inputstr, &quot;%d&quot;, int (param-&gt;input_constant));
         else
-            sprintf (inputstr, &quot;%.6f&quot;, _param-&gt;input_constant);
+            sprintf (inputstr, &quot;%.6f&quot;, param-&gt;input_constant);
         break;
     case INPUT_ROLLING_AVERAGE:
         sprintf (inputstr, &quot;A&quot;);
         sprintf (where, &quot; (where each frame, A=(A*(1-alpha))+(P*alpha), &quot;
-                 &quot;alpha=1/%u=%.6f)&quot;, _param-&gt;memory_constant_denom,
-                 1.0 / _param-&gt;memory_constant_denom);
-        if (_param-&gt;init_start_frame)
+                 &quot;alpha%s=%s%.6f)&quot;,
+                 space, space, param-&gt;memory_constant_alpha);
+        if (param-&gt;init_start_frame)
             sprintf (moreinfo, &quot;, initial A = %s avg of frames %u - %u&quot;,
-                     _param-&gt;init_by_rolling ? &quot;rolling&quot; : &quot;straight&quot;,
-                     _param-&gt;init_start_frame, _param-&gt;init_end_frame);
+                     param-&gt;init_by_rolling ? &quot;rolling&quot; : &quot;straight&quot;,
+                     param-&gt;init_start_frame, param-&gt;init_end_frame);
         break;
     default:
         sprintf (inputstr, &quot;OOOPS!! (unexpected type %d)&quot;,
-                 _param-&gt;input_type);
+                 param-&gt;input_type);
         break;
     }
 
     char * cptr = conf;
 
-    cptr += snprintf (conf, CONF_LEN, &quot;Swiss Army Knife: P' = &quot;);
-    cptr += snprintf (cptr, CONF_LEN - (cptr - conf), tm-&gt;format, inputstr);
-    if (_param-&gt;bias)
-        cptr += snprintf (cptr, CONF_LEN - (cptr - conf), &quot;%+d&quot;,
-                          _param-&gt;bias);
+    bool result_is_scaled
+        = (param-&gt;result_bias != 0.0 || param-&gt;result_multiplier != 1.0);
+
+    if (!forDialog)
+        cptr += snprintf (conf, CONF_LEN, &quot;Swiss Army Knife: &quot;);
+    cptr += snprintf (cptr, CONF_LEN - (cptr - conf), &quot;P' = %s&quot;,
+                      result_is_scaled ? &quot;((&quot; : &quot;&quot;);
+    cptr += snprintf (cptr, CONF_LEN - (cptr - conf),
+                      forDialog ? tm-&gt;spacy_format : tm-&gt;format, inputstr);
+    if (param-&gt;bias)
+        cptr += snprintf (cptr, CONF_LEN - (cptr - conf),
+                          forDialog ? &quot; + %d&quot; : &quot;%+d&quot;, param-&gt;bias);
     cptr += snprintf (cptr, CONF_LEN - (cptr - conf), &quot;%s&quot;, where);
-    if (_param-&gt;scale_from_min != 0 || _param-&gt;scale_from_max != 255)
+    if (result_is_scaled)
         cptr += snprintf (cptr, CONF_LEN - (cptr - conf),
-                          &quot;, scaled from %d..%d to 0..255&quot;,
-                          _param-&gt;scale_from_min, _param-&gt;scale_from_max);
+                          forDialog ? &quot;) + %.6f) * %.6f&quot; : &quot;)%+.6f)*%.6f&quot;,
+                          param-&gt;result_bias, param-&gt;result_multiplier);
     cptr += snprintf (cptr, CONF_LEN - (cptr - conf), &quot;%s&quot;, moreinfo);
-    if (_param-&gt;histogram_frame_interval)
+    if (param-&gt;histogram_frame_interval)
         cptr += snprintf (cptr, CONF_LEN - (cptr - conf),
                           &quot;, histogram every %u frames&quot;,
-                          _param-&gt;histogram_frame_interval);
-    if (_param-&gt;debug)
+                          param-&gt;histogram_frame_interval);
+    if (param-&gt;debug)
         cptr += snprintf (cptr, CONF_LEN - (cptr - conf),
-                          &quot;, debug=0x%x&quot;, _param-&gt;debug);
-    fprintf (stderr, &quot;conf is (%d) \&quot;%s\&quot;\n&quot;, cptr - conf, conf);
+                          &quot;, debug%s=%s0x%x&quot;, space, space, param-&gt;debug);
+    if (!forDialog)
+        fprintf (stderr, &quot;SAK conf is (%d) \&quot;%s\&quot;\n&quot;, cptr - conf, conf);
     return conf;
 }
 
-//==============================================================================
+//============================================================================
 
 // Note: The structure of the following code (with the template functions, and
 // the functor objects, etc.) is all about minimizing the code executed
@@ -488,7 +537,7 @@
 // point of templates.  So, buckle your seat belts, because this is where C++
 // gets really fun!
 
-//==============================================================================
+//============================================================================
 
 class HistogramNull // do-nothing version
 {
@@ -516,7 +565,7 @@
     }
 };
 
-//------------------------------------------------------------------------------
+//----------------------------------------------------------------------------
 
 class Histogram
 {
@@ -709,7 +758,7 @@
     }
 };
 
-//==============================================================================
+//============================================================================
 
 template &lt;typename Oper, typename Histo&gt;
 void ImageTool::convolve (const std::vector &lt;float&gt; &amp; kernel,
@@ -819,12 +868,13 @@
     }
 }
 
-//==============================================================================
+//============================================================================
 
 template &lt;typename Oper, typename Histo&gt;
 void ADMVideoSwissArmyKnife::computeRollingAverage (ADMImage * image,
                                                     ADMImage * data,
                                                     uint32_t planesize,
+                                                    SWISSARMYKNIFE_PARAM * param,
                                                     int32_t bias,
                                                     const Oper &amp; op_in,
                                                     const Histo &amp; histogram_in)
@@ -837,7 +887,7 @@
     Histo histogram = histogram_in;
     Oper op = op_in;
 
-    float alpha = 1.0 / _param-&gt;memory_constant_denom;
+    float alpha = param-&gt;memory_constant_alpha;
     float oneminusalpha = 1 - alpha;
 
     // HERE: for speed, we do luma (Y plane) only.  However, some
@@ -881,18 +931,20 @@
         *--destp = result;
     }
 
-    if (_param-&gt;debug &amp; 2)
+    if (param-&gt;debug &amp; 2)
     {
         if (satlow || sathigh)
             printf (&quot;    Saturated %d low, %d high\n&quot;, satlow, sathigh);
     }
 }
 
-//==============================================================================
+//============================================================================
 
 template &lt;typename InputImageType, typename Oper, typename Histo&gt;
 void ADMVideoSwissArmyKnife::applyImage (ADMImage * image, ADMImage * data,
-                                         uint32_t planesize, int32_t bias,
+                                         uint32_t planesize,
+                                         SWISSARMYKNIFE_PARAM * param,
+                                         int32_t bias,
                                          InputImageType * input_image,
                                          const Oper &amp; op_in,
                                          const Histo &amp; histogram_in)
@@ -944,18 +996,20 @@
         *--destp = result;
     }
 
-    if (_param-&gt;debug &amp; 2)
+    if (param-&gt;debug &amp; 2)
     {
         if (satlow || sathigh)
             printf (&quot;    Saturated %d low, %d high\n&quot;, satlow, sathigh);
     }
 }
 
-//==============================================================================
+//============================================================================
 
 template &lt;typename Oper, typename Histo&gt;
 void ADMVideoSwissArmyKnife::applyConstant (ADMImage * image, ADMImage * data,
-                                            uint32_t planesize, int32_t bias,
+                                            uint32_t planesize,
+                                            SWISSARMYKNIFE_PARAM * param,
+                                            int32_t bias,
                                             const Oper &amp; op_in,
                                             const Histo &amp; histogram_in)
 {
@@ -973,7 +1027,7 @@
 
     uint8_t * currp = YPLANE (image) + planesize;
     uint8_t * destp = YPLANE (data) + planesize;
-    float A = _param-&gt;input_constant;
+    float A = param-&gt;input_constant;
     uint32_t pixremaining = planesize + 1;
 
     uint32_t sathigh = 0;
@@ -1005,14 +1059,14 @@
         *--destp = result;
     }
 
-    if (_param-&gt;debug &amp; 2)
+    if (param-&gt;debug &amp; 2)
     {
         if (satlow || sathigh)
             printf (&quot;    Saturated %d low, %d high\n&quot;, satlow, sathigh);
     }
 }
 
-//==============================================================================
+//============================================================================
 
 class OpPequalsA
 {
@@ -1156,195 +1210,218 @@
     }
 };
 
-//------------------------------------------------------------------------------
+//----------------------------------------------------------------------------
 
 class OpPequalsA_Scaled
 {
-    float scale_min;
+    float bias;
     float multiplier;
 public:
-    OpPequalsA_Scaled (int32_t scale_min, int32_t scale_max)
-        : scale_min (scale_min),
-          multiplier (MAX_PIXEL_LUMA / float (scale_max - scale_min))  { }
+    OpPequalsA_Scaled (float bias, float multiplier)
+        : bias (bias),
+          multiplier (multiplier)  { }
 
     int32_t operator () (int32_t P, float A) const
     {
-        return static_cast &lt;int32_t&gt; (((A - scale_min) * multiplier) + .5);
+        return static_cast &lt;int32_t&gt; (((A + bias) * multiplier) + .5);
     }
 };
 
 class OpPequalsP_Scaled
 {
-    float scale_min;
+    float bias;
     float multiplier;
 public:
-    OpPequalsP_Scaled (int32_t scale_min, int32_t scale_max)
-        : scale_min (scale_min),
-          multiplier (MAX_PIXEL_LUMA / float (scale_max - scale_min))  { }
+    OpPequalsP_Scaled (float bias, float multiplier)
+        : bias (bias),
+          multiplier (multiplier)  { }
 
     int32_t operator () (int32_t P, float A) const
     {
-        return static_cast &lt;int32_t&gt; (((P - scale_min) * multiplier) + .5);
+        return static_cast &lt;int32_t&gt; (((P + bias) * multiplier) + .5);
     }
 };
 
 class OpPequalsPminusA_Scaled
 {
-    float scale_min;
+    float bias;
     float multiplier;
 public:
-    OpPequalsPminusA_Scaled (int32_t scale_min, int32_t scale_max)
-        : scale_min (scale_min),
-          multiplier (MAX_PIXEL_LUMA / float (scale_max - scale_min))  { }
+    OpPequalsPminusA_Scaled (float bias, float multiplier)
+        : bias (bias),
+          multiplier (multiplier)  { }
 
     int32_t operator () (int32_t P, float A) const
     {
         return (static_cast &lt;int32_t&gt;
-                ((((P - A) - scale_min) * multiplier) + .5));
+                ((((P - A) + bias) * multiplier) + .5));
     }
 };
 
 class OpPequalsAminusP_Scaled
 {
-    float scale_min;
+    float bias;
     float multiplier;
 public:
-    OpPequalsAminusP_Scaled (int32_t scale_min, int32_t scale_max)
-        : scale_min (scale_min),
-          multiplier (MAX_PIXEL_LUMA / float (scale_max - scale_min))  { }
+    OpPequalsAminusP_Scaled (float bias, float multiplier)
+        : bias (bias),
+          multiplier (multiplier)  { }
 
     int32_t operator () (int32_t P, float A) const
     {
         return (static_cast &lt;int32_t&gt;
-                ((((A - P) - scale_min) * multiplier) + .5));
+                ((((A - P) + bias) * multiplier) + .5));
     }
 };
 
 class OpPequalsPplusA_Scaled
 {
-    float scale_min;
+    float bias;
     float multiplier;
 public:
-    OpPequalsPplusA_Scaled (int32_t scale_min, int32_t scale_max)
-        : scale_min (scale_min),
-          multiplier (MAX_PIXEL_LUMA / float (scale_max - scale_min))  { }
+    OpPequalsPplusA_Scaled (float bias, float multiplier)
+        : bias (bias),
+          multiplier (multiplier)  { }
 
     int32_t operator () (int32_t P, float A) const
     {
         return (static_cast &lt;int32_t&gt;
-                ((((P + A) - scale_min) * multiplier) + .5));
+                ((((P + A) + bias) * multiplier) + .5));
     }
 };
 
 class OpPequalsPtimesA_Scaled
 {
-    float scale_min;
+    float bias;
     float multiplier;
 public:
-    OpPequalsPtimesA_Scaled (int32_t scale_min, int32_t scale_max)
-        : scale_min (scale_min),
-          multiplier (MAX_PIXEL_LUMA / float (scale_max - scale_min))  { }
+    OpPequalsPtimesA_Scaled (float bias, float multiplier)
+        : bias (bias),
+          multiplier (multiplier)  { }
 
     int32_t operator () (int32_t P, float A) const
     {
         return (static_cast &lt;int32_t&gt;
-                ((((P * A) - scale_min) * multiplier) + .5));
+                ((((P * A) + bias) * multiplier) + .5));
     }
 };
 
 class OpPequalsPdivByA_Scaled
 {
-    float scale_min;
+    float bias;
     float multiplier;
 public:
-    OpPequalsPdivByA_Scaled (int32_t scale_min, int32_t scale_max)
-        : scale_min (scale_min),
-          multiplier (MAX_PIXEL_LUMA / float (scale_max - scale_min))  { }
+    OpPequalsPdivByA_Scaled (float bias, float multiplier)
+        : bias (bias),
+          multiplier (multiplier)  { }
 
     int32_t operator () (int32_t P, float A) const
     {
         return (static_cast &lt;int32_t&gt;
-                ((((P / A) - scale_min) * multiplier) + .5));
+                ((((P / A) + bias) * multiplier) + .5));
     }
 };
 
 class OpPequalsAdivByP_Scaled
 {
-    float scale_min;
+    float bias;
     float multiplier;
 public:
-    OpPequalsAdivByP_Scaled (int32_t scale_min, int32_t scale_max)
-        : scale_min (scale_min),
-          multiplier (MAX_PIXEL_LUMA / float (scale_max - scale_min))  { }
+    OpPequalsAdivByP_Scaled (float bias, float multiplier)
+        : bias (bias),
+          multiplier (multiplier)  { }
 
     int32_t operator () (int32_t P, float A) const
     {
         return (static_cast &lt;int32_t&gt;
-                ((((A / P) - scale_min) * multiplier) + .5));
+                ((((A / P) + bias) * multiplier) + .5));
     }
 };
 
 class OpPequalsMinPA_Scaled
 {
-    float scale_min;
+    float bias;
     float multiplier;
 public:
-    OpPequalsMinPA_Scaled (int32_t scale_min, int32_t scale_max)
-        : scale_min (scale_min),
-          multiplier (MAX_PIXEL_LUMA / float (scale_max - scale_min))  { }
+    OpPequalsMinPA_Scaled (float bias, float multiplier)
+        : bias (bias),
+          multiplier (multiplier)  { }
 
     int32_t operator () (int32_t P, float A) const
     {
         return (static_cast &lt;int32_t&gt;
-                ((((A &gt; P ? P : A) - scale_min) * multiplier) + .5));
+                ((((A &gt; P ? P : A) + bias) * multiplier) + .5));
     }
 };
 
 class OpPequalsMaxPA_Scaled
 {
-    float scale_min;
+    float bias;
     float multiplier;
 public:
-    OpPequalsMaxPA_Scaled (int32_t scale_min, int32_t scale_max)
-        : scale_min (scale_min),
-          multiplier (MAX_PIXEL_LUMA / float (scale_max - scale_min))  { }
+    OpPequalsMaxPA_Scaled (float bias, float multiplier)
+        : bias (bias),
+          multiplier (multiplier)  { }
 
     int32_t operator () (int32_t P, float A) const
     {
         return (static_cast &lt;int32_t&gt;
-                ((((A &gt; P ? A : P) - scale_min) * multiplier) + .5));
+                ((((A &gt; P ? A : P) + bias) * multiplier) + .5));
     }
 };
 
-//==============================================================================
+//============================================================================
 
-uint8_t ADMVideoSwissArmyKnife::getFrameNumberNoAlloc(uint32_t frame, uint32_t *len,
-          			ADMImage *data, uint32_t *flags)
+uint8_t ADMVideoSwissArmyKnife::getFrameNumberNoAlloc(uint32_t frame,
+                                                      uint32_t *len,
+                                                      ADMImage *data,
+                                                      uint32_t *flags)
 {
     if (frame &gt;= _info.nb_frames)
         return 0;
 
-    uint32_t debug = _param-&gt;debug;
-
-    if (debug &amp; 1)
+    if (_param-&gt;debug &amp; 1)
         printf (&quot;in ADMVideoSwissArmyKnife::getFrameNumberNoAlloc(%d, ...)\n&quot;,
                 frame);
 
-    bool doingConvolution = (_param-&gt;input_type == INPUT_CUSTOM_CONVOLUTION);
-    bool doingRollingAvg = (_param-&gt;input_type == INPUT_ROLLING_AVERAGE);
-    bool doingFileImage = (_param-&gt;input_type == INPUT_FILE_IMAGE_FLOAT
-                           || _param-&gt;input_type == INPUT_FILE_IMAGE_INTEGER);
-    bool doingFileImageFloat = (_param-&gt;input_type == INPUT_FILE_IMAGE_FLOAT);
-    bool doingApplyConstant = (_param-&gt;input_type == INPUT_CONSTANT_VALUE);
+    if (!_in-&gt;getFrameNumberNoAlloc (frame, len, _uncompressed, flags))
+        return 0;
 
+    uint32_t planesize = _info.width * _info.height;
+    uint32_t size = (planesize * 3) &gt;&gt; 1;
+    *len = size;
+
+    uint8_t ret = doSwissArmyKnife (_uncompressed, data, _in, this, _param,
+                                    _info.width, _info.height);
+    return ret;
+}
+
+uint8_t
+ADMVideoSwissArmyKnife::doSwissArmyKnife (ADMImage * image,
+                                          ADMImage * data,
+                                          AVDMGenericVideoStream * in,
+                                          ADMVideoSwissArmyKnife * sak,
+                                          SWISSARMYKNIFE_PARAM * param,
+                                          uint32_t width, uint32_t height)
+{
+    PersistentInfo * myInfo = sak-&gt;myInfo;
+    uint32_t debug = param-&gt;debug;
+
+    bool doingConvolution = (param-&gt;input_type == INPUT_CUSTOM_CONVOLUTION);
+    bool doingRollingAvg = (param-&gt;input_type == INPUT_ROLLING_AVERAGE);
+    bool doingFileImage = (param-&gt;input_type == INPUT_FILE_IMAGE_FLOAT
+                           || param-&gt;input_type == INPUT_FILE_IMAGE_INTEGER);
+    bool doingFileImageFloat = (param-&gt;input_type == INPUT_FILE_IMAGE_FLOAT);
+    bool doingApplyConstant = (param-&gt;input_type == INPUT_CONSTANT_VALUE);
+
     bool needRead = false;
     bool needFile = doingConvolution || doingFileImage;
 
     if (needFile)
     {
-        if (myInfo-&gt;input_file_name != _param-&gt;input_file)
+        if (myInfo-&gt;input_file_name != param-&gt;input_file)
         {
-            myInfo-&gt;input_file_name = _param-&gt;input_file;
+            myInfo-&gt;input_file_name = param-&gt;input_file;
             myInfo-&gt;input_file_mtime = 0;
             printf (&quot;SwissArmyKnife: new input file has been selected: %s\n&quot;,
                     myInfo-&gt;input_file_name.c_str());
@@ -1369,19 +1446,22 @@
             needRead = true;
             myInfo-&gt;input_file_mtime = st.st_mtime;
         }
-        else if (!needRead &amp;&amp; myInfo-&gt;image_data_invalid)
-            needRead = true;
+        else if (!needRead)
+        {
+            if (myInfo-&gt;image_data_invalid
+                || myInfo-&gt;image_bias != param-&gt;load_bias
+                || myInfo-&gt;image_multiplier != param-&gt;load_multiplier)
+            {
+                needRead = true;
+            }
+        }
     }
 
     FloatVector &amp; kernel = myInfo-&gt;kernel;
     uint32_t &amp; kernel_w = myInfo-&gt;kernel_w;
     uint32_t &amp; kernel_h = myInfo-&gt;kernel_h;
 
-    uint32_t w = _info.width;
-    uint32_t h = _info.height;
-    uint32_t planesize = w * h;
-    uint32_t size = (planesize * 3) &gt;&gt; 1;
-    *len = size;
+    uint32_t planesize = width * height;
 			
     if (needRead)
     {
@@ -1475,8 +1555,8 @@
         }
         else // file image (not convolution)
         {
-            ADM_assert (_param-&gt;input_type == INPUT_FILE_IMAGE_FLOAT
-                        || _param-&gt;input_type == INPUT_FILE_IMAGE_INTEGER);
+            ADM_assert (param-&gt;input_type == INPUT_FILE_IMAGE_FLOAT
+                        || param-&gt;input_type == INPUT_FILE_IMAGE_INTEGER);
 
             const char * filename = myInfo-&gt;input_file_name.c_str();
             FILE * fin = fopen (filename, &quot;rb&quot;);
@@ -1537,7 +1617,7 @@
             float * floatpixp = myInfo-&gt;image_float + pixelcount;
             uint8_t * intpixp = myInfo-&gt;image_int + pixelcount;
 
-            if (_param-&gt;load_bias == 0.0 &amp;&amp; _param-&gt;load_multiplier == 1.0)
+            if (param-&gt;load_bias == 0.0 &amp;&amp; param-&gt;load_multiplier == 1.0)
             {
                 printf (&quot;Converting %u pixels to integer values (and keeping &quot;
                         &quot;the floats, too)\n&quot;, pixelcount);
@@ -1550,8 +1630,8 @@
             }
             else
             {
-                float load_bias = _param-&gt;load_bias;
-                float load_multiplier = _param-&gt;load_multiplier;
+                float load_bias = param-&gt;load_bias;
+                float load_multiplier = param-&gt;load_multiplier;
 
                 printf (&quot;applying P = (P + %.6f) * %.6f to %u pixels\n&quot;,
                         load_bias, load_multiplier, pixelcount);
@@ -1577,32 +1657,34 @@
 
             myInfo-&gt;image_w = width;
             myInfo-&gt;image_h = height;
+            myInfo-&gt;image_bias = param-&gt;load_bias;
+            myInfo-&gt;image_multiplier = param-&gt;load_multiplier;
             myInfo-&gt;image_data_invalid = false;
         }
     }
     else if (doingRollingAvg)
     {
         if (!myInfo-&gt;bg
-            || myInfo-&gt;bg_x != w || myInfo-&gt;bg_y != h
-            || myInfo-&gt;bg_mc != _param-&gt;memory_constant_denom
-            || myInfo-&gt;bg_isf != _param-&gt;init_start_frame
-            || myInfo-&gt;bg_ief != _param-&gt;init_end_frame
-            || myInfo-&gt;bg_ibr != _param-&gt;init_by_rolling)
+            || myInfo-&gt;bg_x != width || myInfo-&gt;bg_y != height
+            || myInfo-&gt;bg_mca != param-&gt;memory_constant_alpha
+            || myInfo-&gt;bg_isf != param-&gt;init_start_frame
+            || myInfo-&gt;bg_ief != param-&gt;init_end_frame
+            || myInfo-&gt;bg_ibr != param-&gt;init_by_rolling)
         {
-            if (!myInfo-&gt;bg || myInfo-&gt;bg_x != w || myInfo-&gt;bg_y != h)
+            if (!myInfo-&gt;bg || myInfo-&gt;bg_x != width || myInfo-&gt;bg_y != height)
             {
-                myInfo-&gt;bg_x = w;
-                myInfo-&gt;bg_y = h;
+                myInfo-&gt;bg_x = width;
+                myInfo-&gt;bg_y = height;
                 delete [] myInfo-&gt;bg;
                 myInfo-&gt;bg = new float [planesize];
             }
 
             myInfo-&gt;histogram_data_invalid = true;
 
-            myInfo-&gt;bg_mc = _param-&gt;memory_constant_denom;
-            myInfo-&gt;bg_isf = _param-&gt;init_start_frame;
-            myInfo-&gt;bg_ief = _param-&gt;init_end_frame;
-            myInfo-&gt;bg_ibr = _param-&gt;init_by_rolling;
+            myInfo-&gt;bg_mca = param-&gt;memory_constant_alpha;
+            myInfo-&gt;bg_isf = param-&gt;init_start_frame;
+            myInfo-&gt;bg_ief = param-&gt;init_end_frame;
+            myInfo-&gt;bg_ibr = param-&gt;init_by_rolling;
 
             if (myInfo-&gt;bg_isf &amp;&amp; myInfo-&gt;bg_isf &lt;= myInfo-&gt;bg_ief)
             {
@@ -1610,27 +1692,28 @@
 
                 uint32_t firstframe = myInfo-&gt;bg_isf - 1;
                 uint32_t lastframe = myInfo-&gt;bg_ief - 1;
-                if (lastframe &gt;= _info.nb_frames)
+                const ADV_Info &amp; info = sak-&gt;getInfo();
+                if (lastframe &gt;= info.nb_frames)
                 {
-                    lastframe = _info.nb_frames - 1;
-                    if (firstframe &gt; _info.nb_frames)
+                    lastframe = info.nb_frames - 1;
+                    if (firstframe &gt; info.nb_frames)
                     {
                         firstframe = lastframe - do_frames + 1;
-                        if (firstframe &gt; _info.nb_frames)
+                        if (firstframe &gt; info.nb_frames)
                             firstframe = 0;
                     }
                     do_frames = lastframe - firstframe + 1;
                 }
 
                 // if (debug &amp; 2)
-                printf (&quot;Getting a \&quot;head start\&quot; on rolling average by computing %s &quot;
-                        &quot;%d frames of size %dx%d from %d to %d with alpha = %.5f (1/%d)\n&quot;,
-                        myInfo-&gt;bg_ibr ? &quot;rolling average over&quot; : &quot;straight average of&quot;,
+                printf (&quot;Getting a \&quot;head start\&quot; on rolling average by &quot;
+                        &quot;computing a %s %d frames of size %dx%d from %d to &quot;
+                        &quot;%d with alpha = %.6f\n&quot;,
+                        myInfo-&gt;bg_ibr ? &quot;rolling average over&quot;
+                        : &quot;straight average of&quot;,
                         do_frames, myInfo-&gt;bg_x, myInfo-&gt;bg_y,
-                        firstframe + 1, lastframe + 1,
-                        1.0 / myInfo-&gt;bg_mc, myInfo-&gt;bg_mc);
+                        firstframe + 1, lastframe + 1, myInfo-&gt;bg_mca);
 
-
                 ADMImage aimage (myInfo-&gt;bg_x, myInfo-&gt;bg_y);
 
                 // HERE: for speed, we do luma (Y plane) only.  However, some
@@ -1647,9 +1730,9 @@
                     // loop that follows:
                     {
                         uint32_t flen;
-                        uint32_t fflags = *flags;
-                        if (!_in-&gt;getFrameNumberNoAlloc (firstframe, &amp;flen,
-                                                         &amp;aimage, &amp;fflags))
+                        uint32_t fflags = 0;
+                        if (!in-&gt;getFrameNumberNoAlloc (firstframe, &amp;flen,
+                                                        &amp;aimage, &amp;fflags))
                             return 0;
 
                         uint8_t * currp = YPLANE (&amp;aimage) + planesize;
@@ -1663,15 +1746,15 @@
                         ++firstframe; // don't include this one again
                     }
 
-                    float alpha = 1.0 / _param-&gt;memory_constant_denom;
+                    float alpha = param-&gt;memory_constant_alpha;
                     float oneminusalpha = 1 - alpha;
 
                     for (int fnum = firstframe; fnum &lt;= lastframe; fnum++)
                     {
                         uint32_t flen;
-                        uint32_t fflags = *flags;
-                        if (!_in-&gt;getFrameNumberNoAlloc (fnum, &amp;flen,
-                                                         &amp;aimage, &amp;fflags))
+                        uint32_t fflags = 0;
+                        if (!in-&gt;getFrameNumberNoAlloc (fnum, &amp;flen,
+                                                        &amp;aimage, &amp;fflags))
                             return 0;
 
                         uint8_t * currp = YPLANE (&amp;aimage) + planesize;
@@ -1692,9 +1775,9 @@
                     for (int fnum = firstframe; fnum &lt;= lastframe; fnum++)
                     {
                         uint32_t flen;
-                        uint32_t fflags = *flags;
-                        if (!_in-&gt;getFrameNumberNoAlloc (fnum, &amp;flen,
-                                                         &amp;aimage, &amp;fflags))
+                        uint32_t fflags = 0;
+                        if (!in-&gt;getFrameNumberNoAlloc (fnum, &amp;flen,
+                                                        &amp;aimage, &amp;fflags))
                             return 0;
 
                         uint8_t * currp = YPLANE (&amp;aimage) + planesize;
@@ -1732,42 +1815,38 @@
         {
             if (debug &amp; 4)
                 printf (&quot;Using existing baseline background of size %dx%d with &quot;
-                        &quot;alpha = %.5f (1/%d)\n&quot;, myInfo-&gt;bg_x, myInfo-&gt;bg_y,
-                        1.0 / myInfo-&gt;bg_mc, myInfo-&gt;bg_mc);
+                        &quot;alpha = %.6f (1/%d)\n&quot;, myInfo-&gt;bg_x, myInfo-&gt;bg_y,
+                        myInfo-&gt;bg_mca);
         }
     }			
 
-    if (!_in-&gt;getFrameNumberNoAlloc (frame, len, _uncompressed, flags))
-        return 0;
-
-    ADMImage * image = _uncompressed;
     uint8_t * imagePixels = YPLANE (image);
 
-    ImageTool imtool (imagePixels, w, h, data);
+    ImageTool imtool (imagePixels, width, height, data);
     imtool.setDebug (debug);
 
     Histogram * histogram = 0;
-    int32_t bias = _param-&gt;bias;
-    uint32_t tool = _param-&gt;tool;
+    int32_t bias = param-&gt;bias;
+    uint32_t tool = param-&gt;tool;
 
-    // HERE: give some thought to the general issue of keeping myInfo &amp; _param
+    // HERE: give some thought to the general issue of keeping myInfo &amp; param
     // in sync, and resetting the histogram (or whatever) when things change.
 
-    if (_param-&gt;histogram_frame_interval != 0)
+    if (param-&gt;histogram_frame_interval != 0)
     {
         histogram = new Histogram (myInfo-&gt;histogram_input_data,
                                    myInfo-&gt;histogram_output_data,
-                                   _param-&gt;histogram_frame_interval,
+                                   param-&gt;histogram_frame_interval,
                                    myInfo-&gt;histogram_frame_count,
-                                   w * h);
+                                   width * height);
         tool += TOOL_ADD_HISTOGRAM;
         if (myInfo-&gt;histogram_frame_interval !=
-            _param-&gt;histogram_frame_interval)
+            param-&gt;histogram_frame_interval)
         {
             if (myInfo-&gt;histogram_frame_interval)
                 myInfo-&gt;histogram_data_invalid = true;
             myInfo-&gt;histogram_frame_interval
-                = _param-&gt;histogram_frame_interval;
+                = param-&gt;histogram_frame_interval;
         }
 
         if (myInfo-&gt;histogram_data_invalid)
@@ -1777,12 +1856,10 @@
         }
     }
 
-    int32_t scale_min = _param-&gt;scale_from_min;
-    int32_t scale_max = _param-&gt;scale_from_max;
-    if (scale_min != 0 || scale_max != 255)
+    float rbias = param-&gt;result_bias;
+    float rmultiplier = param-&gt;result_multiplier;
+    if (fabsf (rbias) &gt;= 0.0001 || fabsf (rmultiplier - 1.0) &gt;= 0.0001)
     {
-        // printf (&quot;Scaling enabled (from %d..%d to 0..255)\n&quot;,
-        //         scale_min, scale_max);
         tool += TOOL_ADD_SCALING;
     }
 
@@ -1854,89 +1931,89 @@
 
         case TOOL_A_SCALED:
             imtool.convolve (kernel, kernel_w, kernel_h, bias,
-                             OpPequalsA_Scaled (scale_min, scale_max), HistogramNull());
+                             OpPequalsA_Scaled (rbias, rmultiplier), HistogramNull());
             break;
         case TOOL_P_SCALED: // HERE_SCALED: we could optimize this if we wanted to
             imtool.convolve (kernel, kernel_w, kernel_h, bias,
-                             OpPequalsP_Scaled (scale_min, scale_max), HistogramNull());
+                             OpPequalsP_Scaled (rbias, rmultiplier), HistogramNull());
             break;
         case TOOL_P_MINUS_A_SCALED:
             imtool.convolve (kernel, kernel_w, kernel_h, bias,
-                             OpPequalsPminusA_Scaled (scale_min, scale_max), HistogramNull());
+                             OpPequalsPminusA_Scaled (rbias, rmultiplier), HistogramNull());
             break;
         case TOOL_A_MINUS_P_SCALED:
             imtool.convolve (kernel, kernel_w, kernel_h, bias,
-                             OpPequalsAminusP_Scaled (scale_min, scale_max), HistogramNull());
+                             OpPequalsAminusP_Scaled (rbias, rmultiplier), HistogramNull());
             break;
         case TOOL_P_PLUS_A_SCALED:
             imtool.convolve (kernel, kernel_w, kernel_h, bias,
-                             OpPequalsPplusA_Scaled (scale_min, scale_max), HistogramNull());
+                             OpPequalsPplusA_Scaled (rbias, rmultiplier), HistogramNull());
             break;
         case TOOL_P_TIMES_A_SCALED:
             imtool.convolve (kernel, kernel_w, kernel_h, bias,
-                             OpPequalsPtimesA_Scaled (scale_min, scale_max), HistogramNull());
+                             OpPequalsPtimesA_Scaled (rbias, rmultiplier), HistogramNull());
             break;
         case TOOL_P_DIVBY_A_SCALED:
             imtool.convolve (kernel, kernel_w, kernel_h, bias,
-                             OpPequalsPdivByA_Scaled (scale_min, scale_max), HistogramNull());
+                             OpPequalsPdivByA_Scaled (rbias, rmultiplier), HistogramNull());
             break;
         case TOOL_A_DIVBY_P_SCALED:
             imtool.convolve (kernel, kernel_w, kernel_h, bias,
-                             OpPequalsAdivByP_Scaled (scale_min, scale_max), HistogramNull());
+                             OpPequalsAdivByP_Scaled (rbias, rmultiplier), HistogramNull());
             break;
         case TOOL_MIN_P_A_SCALED:
             imtool.convolve (kernel, kernel_w, kernel_h, bias,
-                             OpPequalsMinPA_Scaled (scale_min, scale_max), HistogramNull());
+                             OpPequalsMinPA_Scaled (rbias, rmultiplier), HistogramNull());
             break;
         case TOOL_MAX_P_A_SCALED:
             imtool.convolve (kernel, kernel_w, kernel_h, bias,
-                             OpPequalsMaxPA_Scaled (scale_min, scale_max), HistogramNull());
+                             OpPequalsMaxPA_Scaled (rbias, rmultiplier), HistogramNull());
             break;
 
         case TOOL_A_SCALED_WITH_HISTOGRAM:
             imtool.convolve (kernel, kernel_w, kernel_h, bias,
-                             OpPequalsA_Scaled (scale_min, scale_max), *histogram);
+                             OpPequalsA_Scaled (rbias, rmultiplier), *histogram);
             break;
         case TOOL_P_SCALED_WITH_HISTOGRAM: // HERE: we could optimize this if we wanted to
             imtool.convolve (kernel, kernel_w, kernel_h, bias,
-                             OpPequalsP_Scaled (scale_min, scale_max), *histogram);
+                             OpPequalsP_Scaled (rbias, rmultiplier), *histogram);
             break;
         case TOOL_P_MINUS_A_SCALED_WITH_HISTOGRAM:
             imtool.convolve (kernel, kernel_w, kernel_h, bias,
-                             OpPequalsPminusA_Scaled (scale_min, scale_max), *histogram);
+                             OpPequalsPminusA_Scaled (rbias, rmultiplier), *histogram);
             break;
         case TOOL_A_MINUS_P_SCALED_WITH_HISTOGRAM:
             imtool.convolve (kernel, kernel_w, kernel_h, bias,
-                             OpPequalsAminusP_Scaled (scale_min, scale_max), *histogram);
+                             OpPequalsAminusP_Scaled (rbias, rmultiplier), *histogram);
             break;
         case TOOL_P_PLUS_A_SCALED_WITH_HISTOGRAM:
             imtool.convolve (kernel, kernel_w, kernel_h, bias,
-                             OpPequalsPplusA_Scaled (scale_min, scale_max), *histogram);
+                             OpPequalsPplusA_Scaled (rbias, rmultiplier), *histogram);
             break;
         case TOOL_P_TIMES_A_SCALED_WITH_HISTOGRAM:
             imtool.convolve (kernel, kernel_w, kernel_h, bias,
-                             OpPequalsPtimesA_Scaled (scale_min, scale_max), *histogram);
+                             OpPequalsPtimesA_Scaled (rbias, rmultiplier), *histogram);
             break;
         case TOOL_P_DIVBY_A_SCALED_WITH_HISTOGRAM:
             imtool.convolve (kernel, kernel_w, kernel_h, bias,
-                             OpPequalsPdivByA_Scaled (scale_min, scale_max), *histogram);
+                             OpPequalsPdivByA_Scaled (rbias, rmultiplier), *histogram);
             break;
         case TOOL_A_DIVBY_P_SCALED_WITH_HISTOGRAM:
             imtool.convolve (kernel, kernel_w, kernel_h, bias,
-                             OpPequalsAdivByP_Scaled (scale_min, scale_max), *histogram);
+                             OpPequalsAdivByP_Scaled (rbias, rmultiplier), *histogram);
             break;
         case TOOL_MIN_P_A_SCALED_WITH_HISTOGRAM:
             imtool.convolve (kernel, kernel_w, kernel_h, bias,
-                             OpPequalsMinPA_Scaled (scale_min, scale_max), *histogram);
+                             OpPequalsMinPA_Scaled (rbias, rmultiplier), *histogram);
             break;
         case TOOL_MAX_P_A_SCALED_WITH_HISTOGRAM:
             imtool.convolve (kernel, kernel_w, kernel_h, bias,
-                             OpPequalsMaxPA_Scaled (scale_min, scale_max), *histogram);
+                             OpPequalsMaxPA_Scaled (rbias, rmultiplier), *histogram);
             break;
 
         default:
             printf (&quot;SwissArmyKnife: unknown operation (tool) %d!\n&quot;,
-                    _param-&gt;tool);
+                    param-&gt;tool);
             return 0;
         }
     }
@@ -1945,185 +2022,205 @@
         switch (tool)
         {
         case TOOL_A:
-            computeRollingAverage (image, data, planesize, bias, OpPequalsA(), HistogramNull());
+            sak-&gt;computeRollingAverage (image, data, planesize, param, bias,
+                                        OpPequalsA(), HistogramNull());
             break;
         case TOOL_P: // HERE: we could optimize this if we wanted to
-            computeRollingAverage (image, data, planesize, bias, OpPequalsP(), HistogramNull());
+            sak-&gt;computeRollingAverage (image, data, planesize, param, bias,
+                                        OpPequalsP(), HistogramNull());
             break;
         case TOOL_P_MINUS_A:
-            computeRollingAverage (image, data, planesize, bias, OpPequalsPminusA(), HistogramNull());
+            sak-&gt;computeRollingAverage (image, data, planesize, param, bias,
+                                        OpPequalsPminusA(), HistogramNull());
             break;
         case TOOL_A_MINUS_P:
-            computeRollingAverage (image, data, planesize, bias, OpPequalsAminusP(), HistogramNull());
+            sak-&gt;computeRollingAverage (image, data, planesize, param, bias,
+                                        OpPequalsAminusP(), HistogramNull());
             break;
         case TOOL_P_PLUS_A:
-            computeRollingAverage (image, data, planesize, bias, OpPequalsPplusA(), HistogramNull());
+            sak-&gt;computeRollingAverage (image, data, planesize, param, bias,
+                                        OpPequalsPplusA(), HistogramNull());
             break;
         case TOOL_P_TIMES_A:
-            computeRollingAverage (image, data, planesize, bias, OpPequalsPtimesA(), HistogramNull());
+            sak-&gt;computeRollingAverage (image, data, planesize, param, bias,
+                                        OpPequalsPtimesA(), HistogramNull());
             break;
         case TOOL_P_DIVBY_A:
-            computeRollingAverage (image, data, planesize, bias, OpPequalsPdivByA(), HistogramNull());
+            sak-&gt;computeRollingAverage (image, data, planesize, param, bias,
+                                        OpPequalsPdivByA(), HistogramNull());
             break;
         case TOOL_A_DIVBY_P:
-            computeRollingAverage (image, data, planesize, bias, OpPequalsAdivByP(), HistogramNull());
+            sak-&gt;computeRollingAverage (image, data, planesize, param, bias,
+                                        OpPequalsAdivByP(), HistogramNull());
             break;
         case TOOL_MIN_P_A:
-            computeRollingAverage (image, data, planesize, bias, OpPequalsMinPA(), HistogramNull());
+            sak-&gt;computeRollingAverage (image, data, planesize, param, bias,
+                                        OpPequalsMinPA(), HistogramNull());
             break;
         case TOOL_MAX_P_A:
-            computeRollingAverage (image, data, planesize, bias, OpPequalsMaxPA(), HistogramNull());
+            sak-&gt;computeRollingAverage (image, data, planesize, param, bias,
+                                        OpPequalsMaxPA(), HistogramNull());
             break;
 
         case TOOL_A_WITH_HISTOGRAM:
-            computeRollingAverage (image, data, planesize, bias, OpPequalsA(), *histogram);
+            sak-&gt;computeRollingAverage (image, data, planesize, param, bias,
+                                        OpPequalsA(), *histogram);
             break;
         case TOOL_P_WITH_HISTOGRAM: // HERE: we could optimize this if we wanted to
-            computeRollingAverage (image, data, planesize, bias, OpPequalsP(), *histogram);
+            sak-&gt;computeRollingAverage (image, data, planesize, param, bias,
+                                        OpPequalsP(), *histogram);
             break;
         case TOOL_P_MINUS_A_WITH_HISTOGRAM:
-            computeRollingAverage (image, data, planesize, bias, OpPequalsPminusA(), *histogram);
+            sak-&gt;computeRollingAverage (image, data, planesize, param, bias,
+                                        OpPequalsPminusA(), *histogram);
             break;
         case TOOL_A_MINUS_P_WITH_HISTOGRAM:
-            computeRollingAverage (image, data, planesize, bias, OpPequalsAminusP(), *histogram);
+            sak-&gt;computeRollingAverage (image, data, planesize, param, bias,
+                                        OpPequalsAminusP(), *histogram);
             break;
         case TOOL_P_PLUS_A_WITH_HISTOGRAM:
-            computeRollingAverage (image, data, planesize, bias, OpPequalsPplusA(), *histogram);
+            sak-&gt;computeRollingAverage (image, data, planesize, param, bias,
+                                        OpPequalsPplusA(), *histogram);
             break;
         case TOOL_P_TIMES_A_WITH_HISTOGRAM:
-            computeRollingAverage (image, data, planesize, bias, OpPequalsPtimesA(), *histogram);
+            sak-&gt;computeRollingAverage (image, data, planesize, param, bias,
+                                        OpPequalsPtimesA(), *histogram);
             break;
         case TOOL_P_DIVBY_A_WITH_HISTOGRAM:
-            computeRollingAverage (image, data, planesize, bias, OpPequalsPdivByA(), *histogram);
+            sak-&gt;computeRollingAverage (image, data, planesize, param, bias,
+                                        OpPequalsPdivByA(), *histogram);
             break;
         case TOOL_A_DIVBY_P_WITH_HISTOGRAM:
-            computeRollingAverage (image, data, planesize, bias, OpPequalsAdivByP(), *histogram);
+            sak-&gt;computeRollingAverage (image, data, planesize, param, bias,
+                                        OpPequalsAdivByP(), *histogram);
             break;
         case TOOL_MIN_P_A_WITH_HISTOGRAM:
-            computeRollingAverage (image, data, planesize, bias, OpPequalsMinPA(), *histogram);
+            sak-&gt;computeRollingAverage (image, data, planesize, param, bias,
+                                        OpPequalsMinPA(), *histogram);
             break;
         case TOOL_MAX_P_A_WITH_HISTOGRAM:
-            computeRollingAverage (image, data, planesize, bias, OpPequalsMaxPA(), *histogram);
+            sak-&gt;computeRollingAverage (image, data, planesize, param, bias,
+                                        OpPequalsMaxPA(), *histogram);
             break;
 
         case TOOL_A_SCALED:
-            computeRollingAverage (image, data, planesize, bias,
-                                   OpPequalsA_Scaled (scale_min, scale_max),
-                                   HistogramNull());
+            sak-&gt;computeRollingAverage (image, data, planesize, param, bias,
+                                        OpPequalsA_Scaled (rbias, rmultiplier),
+                                        HistogramNull());
             break;
         case TOOL_P_SCALED: // HERE_SCALED: we could optimize this if we wanted to
-            computeRollingAverage (image, data, planesize, bias,
-                                   OpPequalsP_Scaled (scale_min, scale_max),
-                                   HistogramNull());
+            sak-&gt;computeRollingAverage (image, data, planesize, param, bias,
+                                        OpPequalsP_Scaled (rbias, rmultiplier),
+                                        HistogramNull());
             break;
         case TOOL_P_MINUS_A_SCALED:
-            computeRollingAverage (image, data, planesize, bias,
-                                   OpPequalsPminusA_Scaled (scale_min, scale_max),
-                                   HistogramNull());
+            sak-&gt;computeRollingAverage (image, data, planesize, param, bias,
+                                        OpPequalsPminusA_Scaled (rbias, rmultiplier),
+                                        HistogramNull());
             break;
         case TOOL_A_MINUS_P_SCALED:
-            computeRollingAverage (image, data, planesize, bias,
-                                   OpPequalsAminusP_Scaled (scale_min, scale_max),
-                                   HistogramNull());
+            sak-&gt;computeRollingAverage (image, data, planesize, param, bias,
+                                        OpPequalsAminusP_Scaled (rbias, rmultiplier),
+                                        HistogramNull());
             break;
         case TOOL_P_PLUS_A_SCALED:
-            computeRollingAverage (image, data, planesize, bias,
-                                   OpPequalsPplusA_Scaled (scale_min, scale_max),
-                                   HistogramNull());
+            sak-&gt;computeRollingAverage (image, data, planesize, param, bias,
+                                        OpPequalsPplusA_Scaled (rbias, rmultiplier),
+                                        HistogramNull());
             break;
         case TOOL_P_TIMES_A_SCALED:
-            computeRollingAverage (image, data, planesize, bias,
-                                   OpPequalsPtimesA_Scaled (scale_min, scale_max),
-                                   HistogramNull());
+            sak-&gt;computeRollingAverage (image, data, planesize, param, bias,
+                                        OpPequalsPtimesA_Scaled (rbias, rmultiplier),
+                                        HistogramNull());
             break;
         case TOOL_P_DIVBY_A_SCALED:
-            computeRollingAverage (image, data, planesize, bias,
-                                   OpPequalsPdivByA_Scaled (scale_min, scale_max),
-                                   HistogramNull());
+            sak-&gt;computeRollingAverage (image, data, planesize, param, bias,
+                                        OpPequalsPdivByA_Scaled (rbias, rmultiplier),
+                                        HistogramNull());
             break;
         case TOOL_A_DIVBY_P_SCALED:
-            computeRollingAverage (image, data, planesize, bias,
-                                   OpPequalsAdivByP_Scaled (scale_min, scale_max),
-                                   HistogramNull());
+            sak-&gt;computeRollingAverage (image, data, planesize, param, bias,
+                                        OpPequalsAdivByP_Scaled (rbias, rmultiplier),
+                                        HistogramNull());
             break;
         case TOOL_MIN_P_A_SCALED:
-            computeRollingAverage (image, data, planesize, bias,
-                                   OpPequalsMinPA_Scaled (scale_min, scale_max),
-                                   HistogramNull());
+            sak-&gt;computeRollingAverage (image, data, planesize, param, bias,
+                                        OpPequalsMinPA_Scaled (rbias, rmultiplier),
+                                        HistogramNull());
             break;
         case TOOL_MAX_P_A_SCALED:
-            computeRollingAverage (image, data, planesize, bias,
-                                   OpPequalsMaxPA_Scaled (scale_min, scale_max),
-                                   HistogramNull());
+            sak-&gt;computeRollingAverage (image, data, planesize, param, bias,
+                                        OpPequalsMaxPA_Scaled (rbias, rmultiplier),
+                                        HistogramNull());
             break;
 
         case TOOL_A_SCALED_WITH_HISTOGRAM:
-            computeRollingAverage (image, data, planesize, bias,
-                                   OpPequalsA_Scaled (scale_min, scale_max),
-                                   *histogram);
+            sak-&gt;computeRollingAverage (image, data, planesize, param, bias,
+                                        OpPequalsA_Scaled (rbias, rmultiplier),
+                                        *histogram);
             break;
         case TOOL_P_SCALED_WITH_HISTOGRAM: // HERE: we could optimize this if we wanted to
-            computeRollingAverage (image, data, planesize, bias,
-                                   OpPequalsP_Scaled (scale_min, scale_max),
-                                   *histogram);
+            sak-&gt;computeRollingAverage (image, data, planesize, param, bias,
+                                        OpPequalsP_Scaled (rbias, rmultiplier),
+                                        *histogram);
             break;
         case TOOL_P_MINUS_A_SCALED_WITH_HISTOGRAM:
-            computeRollingAverage (image, data, planesize, bias,
-                                   OpPequalsPminusA_Scaled (scale_min, scale_max),
-                                   *histogram);
+            sak-&gt;computeRollingAverage (image, data, planesize, param, bias,
+                                        OpPequalsPminusA_Scaled (rbias, rmultiplier),
+                                        *histogram);
             break;
         case TOOL_A_MINUS_P_SCALED_WITH_HISTOGRAM:
-            computeRollingAverage (image, data, planesize, bias,
-                                   OpPequalsAminusP_Scaled (scale_min, scale_max),
-                                   *histogram);
+            sak-&gt;computeRollingAverage (image, data, planesize, param, bias,
+                                        OpPequalsAminusP_Scaled (rbias, rmultiplier),
+                                        *histogram);
             break;
         case TOOL_P_PLUS_A_SCALED_WITH_HISTOGRAM:
-            computeRollingAverage (image, data, planesize, bias,
-                                   OpPequalsPplusA_Scaled (scale_min, scale_max),
-                                   *histogram);
+            sak-&gt;computeRollingAverage (image, data, planesize, param, bias,
+                                        OpPequalsPplusA_Scaled (rbias, rmultiplier),
+                                        *histogram);
             break;
         case TOOL_P_TIMES_A_SCALED_WITH_HISTOGRAM:
-            computeRollingAverage (image, data, planesize, bias,
-                                   OpPequalsPtimesA_Scaled (scale_min, scale_max),
-                                   *histogram);
+            sak-&gt;computeRollingAverage (image, data, planesize, param, bias,
+                                        OpPequalsPtimesA_Scaled (rbias, rmultiplier),
+                                        *histogram);
             break;
         case TOOL_P_DIVBY_A_SCALED_WITH_HISTOGRAM:
-            computeRollingAverage (image, data, planesize, bias,
-                                   OpPequalsPdivByA_Scaled (scale_min, scale_max),
-                                   *histogram);
+            sak-&gt;computeRollingAverage (image, data, planesize, param, bias,
+                                        OpPequalsPdivByA_Scaled (rbias, rmultiplier),
+                                        *histogram);
             break;
         case TOOL_A_DIVBY_P_SCALED_WITH_HISTOGRAM:
-            computeRollingAverage (image, data, planesize, bias,
-                                   OpPequalsAdivByP_Scaled (scale_min, scale_max),
-                                   *histogram);
+            sak-&gt;computeRollingAverage (image, data, planesize, param, bias,
+                                        OpPequalsAdivByP_Scaled (rbias, rmultiplier),
+                                        *histogram);
             break;
         case TOOL_MIN_P_A_SCALED_WITH_HISTOGRAM:
-            computeRollingAverage (image, data, planesize, bias,
-                                   OpPequalsMinPA_Scaled (scale_min, scale_max),
-                                   *histogram);
+            sak-&gt;computeRollingAverage (image, data, planesize, param, bias,
+                                        OpPequalsMinPA_Scaled (rbias, rmultiplier),
+                                        *histogram);
             break;
         case TOOL_MAX_P_A_SCALED_WITH_HISTOGRAM:
-            computeRollingAverage (image, data, planesize, bias,
-                                   OpPequalsMaxPA_Scaled (scale_min, scale_max),
-                                   *histogram);
+            sak-&gt;computeRollingAverage (image, data, planesize, param, bias,
+                                        OpPequalsMaxPA_Scaled (rbias, rmultiplier),
+                                        *histogram);
             break;
 
         default:
             printf (&quot;SwissArmyKnife: unknown operation (tool) %d!\n&quot;,
-                    _param-&gt;tool);
+                    param-&gt;tool);
             return 0;
         }
     }
     else if (doingFileImageFloat)
     {
-        if (w != myInfo-&gt;image_w || h != myInfo-&gt;image_h)
+        if (width != myInfo-&gt;image_w || height != myInfo-&gt;image_h)
         {
             const char * bar = &quot;*************************&quot;;
             printf (&quot;\n%s%s%s\nAttempting to apply a %ux%u input image to &quot;
                     &quot;%ux%u video - even if I could do that, it probably &quot;
                     &quot;wouldn't be what you wanted...\n%s%s%s\n&quot;,
                     bar, bar, bar, myInfo-&gt;image_w, myInfo-&gt;image_h,
-                    w, h, bar, bar, bar);
+                    width, height, bar, bar, bar);
             return 0;
         }
 
@@ -2132,185 +2229,205 @@
         switch (tool)
         {
         case TOOL_A:
-            applyImage (image, data, planesize, bias, flt_img, OpPequalsA(), HistogramNull());
+            sak-&gt;applyImage (image, data, planesize, param, bias, flt_img,
+                             OpPequalsA(), HistogramNull());
             break;
         case TOOL_P: // HERE: we could optimize this if we wanted to
-            applyImage (image, data, planesize, bias, flt_img, OpPequalsP(), HistogramNull());
+            sak-&gt;applyImage (image, data, planesize, param, bias, flt_img,
+                             OpPequalsP(), HistogramNull());
             break;
         case TOOL_P_MINUS_A:
-            applyImage (image, data, planesize, bias, flt_img, OpPequalsPminusA(), HistogramNull());
+            sak-&gt;applyImage (image, data, planesize, param, bias, flt_img,
+                             OpPequalsPminusA(), HistogramNull());
             break;
         case TOOL_A_MINUS_P:
-            applyImage (image, data, planesize, bias, flt_img, OpPequalsAminusP(), HistogramNull());
+            sak-&gt;applyImage (image, data, planesize, param, bias, flt_img,
+                             OpPequalsAminusP(), HistogramNull());
             break;
         case TOOL_P_PLUS_A:
-            applyImage (image, data, planesize, bias, flt_img, OpPequalsPplusA(), HistogramNull());
+            sak-&gt;applyImage (image, data, planesize, param, bias, flt_img,
+                             OpPequalsPplusA(), HistogramNull());
             break;
         case TOOL_P_TIMES_A:
-            applyImage (image, data, planesize, bias, flt_img, OpPequalsPtimesA(), HistogramNull());
+            sak-&gt;applyImage (image, data, planesize, param, bias, flt_img,
+                             OpPequalsPtimesA(), HistogramNull());
             break;
         case TOOL_P_DIVBY_A:
-            applyImage (image, data, planesize, bias, flt_img, OpPequalsPdivByA(), HistogramNull());
+            sak-&gt;applyImage (image, data, planesize, param, bias, flt_img,
+                             OpPequalsPdivByA(), HistogramNull());
             break;
         case TOOL_A_DIVBY_P:
-            applyImage (image, data, planesize, bias, flt_img, OpPequalsAdivByP(), HistogramNull());
+            sak-&gt;applyImage (image, data, planesize, param, bias, flt_img,
+                             OpPequalsAdivByP(), HistogramNull());
             break;
         case TOOL_MIN_P_A:
-            applyImage (image, data, planesize, bias, flt_img, OpPequalsMinPA(), HistogramNull());
+            sak-&gt;applyImage (image, data, planesize, param, bias, flt_img,
+                             OpPequalsMinPA(), HistogramNull());
             break;
         case TOOL_MAX_P_A:
-            applyImage (image, data, planesize, bias, flt_img, OpPequalsMaxPA(), HistogramNull());
+            sak-&gt;applyImage (image, data, planesize, param, bias, flt_img,
+                             OpPequalsMaxPA(), HistogramNull());
             break;
 
         case TOOL_A_WITH_HISTOGRAM:
-            applyImage (image, data, planesize, bias, flt_img, OpPequalsA(), *histogram);
+            sak-&gt;applyImage (image, data, planesize, param, bias, flt_img,
+                             OpPequalsA(), *histogram);
             break;
         case TOOL_P_WITH_HISTOGRAM: // HERE: we could optimize this if we wanted to
-            applyImage (image, data, planesize, bias, flt_img, OpPequalsP(), *histogram);
+            sak-&gt;applyImage (image, data, planesize, param, bias, flt_img,
+                             OpPequalsP(), *histogram);
             break;
         case TOOL_P_MINUS_A_WITH_HISTOGRAM:
-            applyImage (image, data, planesize, bias, flt_img, OpPequalsPminusA(), *histogram);
+            sak-&gt;applyImage (image, data, planesize, param, bias, flt_img,
+                             OpPequalsPminusA(), *histogram);
             break;
         case TOOL_A_MINUS_P_WITH_HISTOGRAM:
-            applyImage (image, data, planesize, bias, flt_img, OpPequalsAminusP(), *histogram);
+            sak-&gt;applyImage (image, data, planesize, param, bias, flt_img,
+                             OpPequalsAminusP(), *histogram);
             break;
         case TOOL_P_PLUS_A_WITH_HISTOGRAM:
-            applyImage (image, data, planesize, bias, flt_img, OpPequalsPplusA(), *histogram);
+            sak-&gt;applyImage (image, data, planesize, param, bias, flt_img,
+                             OpPequalsPplusA(), *histogram);
             break;
         case TOOL_P_TIMES_A_WITH_HISTOGRAM:
-            applyImage (image, data, planesize, bias, flt_img, OpPequalsPtimesA(), *histogram);
+            sak-&gt;applyImage (image, data, planesize, param, bias, flt_img,
+                             OpPequalsPtimesA(), *histogram);
             break;
         case TOOL_P_DIVBY_A_WITH_HISTOGRAM:
-            applyImage (image, data, planesize, bias, flt_img, OpPequalsPdivByA(), *histogram);
+            sak-&gt;applyImage (image, data, planesize, param, bias, flt_img,
+                             OpPequalsPdivByA(), *histogram);
             break;
         case TOOL_A_DIVBY_P_WITH_HISTOGRAM:
-            applyImage (image, data, planesize, bias, flt_img, OpPequalsAdivByP(), *histogram);
+            sak-&gt;applyImage (image, data, planesize, param, bias, flt_img,
+                             OpPequalsAdivByP(), *histogram);
             break;
         case TOOL_MIN_P_A_WITH_HISTOGRAM:
-            applyImage (image, data, planesize, bias, flt_img, OpPequalsMinPA(), *histogram);
+            sak-&gt;applyImage (image, data, planesize, param, bias, flt_img,
+                             OpPequalsMinPA(), *histogram);
             break;
         case TOOL_MAX_P_A_WITH_HISTOGRAM:
-            applyImage (image, data, planesize, bias, flt_img, OpPequalsMaxPA(), *histogram);
+            sak-&gt;applyImage (image, data, planesize, param, bias, flt_img,
+                             OpPequalsMaxPA(), *histogram);
             break;
 
         case TOOL_A_SCALED:
-            applyImage (image, data, planesize, bias, flt_img,
-                           OpPequalsA_Scaled (scale_min, scale_max),
-                           HistogramNull());
+            sak-&gt;applyImage (image, data, planesize, param, bias, flt_img,
+                             OpPequalsA_Scaled (rbias, rmultiplier),
+                             HistogramNull());
             break;
         case TOOL_P_SCALED: // HERE_SCALED: we could optimize this if we wanted to
-            applyImage (image, data, planesize, bias, flt_img,
-                           OpPequalsP_Scaled (scale_min, scale_max),
-                           HistogramNull());
+            sak-&gt;applyImage (image, data, planesize, param, bias, flt_img,
+                             OpPequalsP_Scaled (rbias, rmultiplier),
+                             HistogramNull());
             break;
         case TOOL_P_MINUS_A_SCALED:
-            applyImage (image, data, planesize, bias, flt_img,
-                           OpPequalsPminusA_Scaled (scale_min, scale_max),
-                           HistogramNull());
+            sak-&gt;applyImage (image, data, planesize, param, bias, flt_img,
+                             OpPequalsPminusA_Scaled (rbias, rmultiplier),
+                             HistogramNull());
             break;
         case TOOL_A_MINUS_P_SCALED:
-            applyImage (image, data, planesize, bias, flt_img,
-                           OpPequalsAminusP_Scaled (scale_min, scale_max),
-                           HistogramNull());
+            sak-&gt;applyImage (image, data, planesize, param, bias, flt_img,
+                             OpPequalsAminusP_Scaled (rbias, rmultiplier),
+                             HistogramNull());
             break;
         case TOOL_P_PLUS_A_SCALED:
-            applyImage (image, data, planesize, bias, flt_img,
-                           OpPequalsPplusA_Scaled (scale_min, scale_max),
-                           HistogramNull());
+            sak-&gt;applyImage (image, data, planesize, param, bias, flt_img,
+                             OpPequalsPplusA_Scaled (rbias, rmultiplier),
+                             HistogramNull());
             break;
         case TOOL_P_TIMES_A_SCALED:
-            applyImage (image, data, planesize, bias, flt_img,
-                           OpPequalsPtimesA_Scaled (scale_min, scale_max),
-                           HistogramNull());
+            sak-&gt;applyImage (image, data, planesize, param, bias, flt_img,
+                             OpPequalsPtimesA_Scaled (rbias, rmultiplier),
+                             HistogramNull());
             break;
         case TOOL_P_DIVBY_A_SCALED:
-            applyImage (image, data, planesize, bias, flt_img,
-                           OpPequalsPdivByA_Scaled (scale_min, scale_max),
-                           HistogramNull());
+            sak-&gt;applyImage (image, data, planesize, param, bias, flt_img,
+                             OpPequalsPdivByA_Scaled (rbias, rmultiplier),
+                             HistogramNull());
             break;
         case TOOL_A_DIVBY_P_SCALED:
-            applyImage (image, data, planesize, bias, flt_img,
-                           OpPequalsAdivByP_Scaled (scale_min, scale_max),
-                           HistogramNull());
+            sak-&gt;applyImage (image, data, planesize, param, bias, flt_img,
+                             OpPequalsAdivByP_Scaled (rbias, rmultiplier),
+                             HistogramNull());
             break;
         case TOOL_MIN_P_A_SCALED:
-            applyImage (image, data, planesize, bias, flt_img,
-                           OpPequalsMinPA_Scaled (scale_min, scale_max),
-                           HistogramNull());
+            sak-&gt;applyImage (image, data, planesize, param, bias, flt_img,
+                             OpPequalsMinPA_Scaled (rbias, rmultiplier),
+                             HistogramNull());
             break;
         case TOOL_MAX_P_A_SCALED:
-            applyImage (image, data, planesize, bias, flt_img,
-                           OpPequalsMaxPA_Scaled (scale_min, scale_max),
-                           HistogramNull());
+            sak-&gt;applyImage (image, data, planesize, param, bias, flt_img,
+                             OpPequalsMaxPA_Scaled (rbias, rmultiplier),
+                             HistogramNull());
             break;
 
         case TOOL_A_SCALED_WITH_HISTOGRAM:
-            applyImage (image, data, planesize, bias, flt_img,
-                           OpPequalsA_Scaled (scale_min, scale_max),
-                           *histogram);
+            sak-&gt;applyImage (image, data, planesize, param, bias, flt_img,
+                             OpPequalsA_Scaled (rbias, rmultiplier),
+                             *histogram);
             break;
         case TOOL_P_SCALED_WITH_HISTOGRAM: // HERE: we could optimize this if we wanted to
-            applyImage (image, data, planesize, bias, flt_img,
-                           OpPequalsP_Scaled (scale_min, scale_max),
-                           *histogram);
+            sak-&gt;applyImage (image, data, planesize, param, bias, flt_img,
+                             OpPequalsP_Scaled (rbias, rmultiplier),
+                             *histogram);
             break;
         case TOOL_P_MINUS_A_SCALED_WITH_HISTOGRAM:
-            applyImage (image, data, planesize, bias, flt_img,
-                           OpPequalsPminusA_Scaled (scale_min, scale_max),
-                           *histogram);
+            sak-&gt;applyImage (image, data, planesize, param, bias, flt_img,
+                             OpPequalsPminusA_Scaled (rbias, rmultiplier),
+                             *histogram);
             break;
         case TOOL_A_MINUS_P_SCALED_WITH_HISTOGRAM:
-            applyImage (image, data, planesize, bias, flt_img,
-                           OpPequalsAminusP_Scaled (scale_min, scale_max),
-                           *histogram);
+            sak-&gt;applyImage (image, data, planesize, param, bias, flt_img,
+                             OpPequalsAminusP_Scaled (rbias, rmultiplier),
+                             *histogram);
             break;
         case TOOL_P_PLUS_A_SCALED_WITH_HISTOGRAM:
-            applyImage (image, data, planesize, bias, flt_img,
-                           OpPequalsPplusA_Scaled (scale_min, scale_max),
-                           *histogram);
+            sak-&gt;applyImage (image, data, planesize, param, bias, flt_img,
+                             OpPequalsPplusA_Scaled (rbias, rmultiplier),
+                             *histogram);
             break;
         case TOOL_P_TIMES_A_SCALED_WITH_HISTOGRAM:
-            applyImage (image, data, planesize, bias, flt_img,
-                           OpPequalsPtimesA_Scaled (scale_min, scale_max),
-                           *histogram);
+            sak-&gt;applyImage (image, data, planesize, param, bias, flt_img,
+                             OpPequalsPtimesA_Scaled (rbias, rmultiplier),
+                             *histogram);
             break;
         case TOOL_P_DIVBY_A_SCALED_WITH_HISTOGRAM:
-            applyImage (image, data, planesize, bias, flt_img,
-                           OpPequalsPdivByA_Scaled (scale_min, scale_max),
-                           *histogram);
+            sak-&gt;applyImage (image, data, planesize, param, bias, flt_img,
+                             OpPequalsPdivByA_Scaled (rbias, rmultiplier),
+                             *histogram);
             break;
         case TOOL_A_DIVBY_P_SCALED_WITH_HISTOGRAM:
-            applyImage (image, data, planesize, bias, flt_img,
-                           OpPequalsAdivByP_Scaled (scale_min, scale_max),
-                           *histogram);
+            sak-&gt;applyImage (image, data, planesize, param, bias, flt_img,
+                             OpPequalsAdivByP_Scaled (rbias, rmultiplier),
+                             *histogram);
             break;
         case TOOL_MIN_P_A_SCALED_WITH_HISTOGRAM:
-            applyImage (image, data, planesize, bias, flt_img,
-                           OpPequalsMinPA_Scaled (scale_min, scale_max),
-                           *histogram);
+            sak-&gt;applyImage (image, data, planesize, param, bias, flt_img,
+                             OpPequalsMinPA_Scaled (rbias, rmultiplier),
+                             *histogram);
             break;
         case TOOL_MAX_P_A_SCALED_WITH_HISTOGRAM:
-            applyImage (image, data, planesize, bias, flt_img,
-                           OpPequalsMaxPA_Scaled (scale_min, scale_max),
-                           *histogram);
+            sak-&gt;applyImage (image, data, planesize, param, bias, flt_img,
+                             OpPequalsMaxPA_Scaled (rbias, rmultiplier),
+                             *histogram);
             break;
 
         default:
             printf (&quot;SwissArmyKnife: unknown operation (tool) %d!\n&quot;,
-                    _param-&gt;tool);
+                    param-&gt;tool);
             return 0;
         }
     }
     else if (doingFileImage)
     {
-        if (w != myInfo-&gt;image_w || h != myInfo-&gt;image_h)
+        if (width != myInfo-&gt;image_w || height != myInfo-&gt;image_h)
         {
             const char * bar = &quot;*************************&quot;;
             printf (&quot;\n%s%s%s\nAttempting to apply a %ux%u input image to &quot;
                     &quot;%ux%u video - even if I could do that, it probably &quot;
                     &quot;wouldn't be what you wanted...\n%s%s%s\n&quot;,
                     bar, bar, bar, myInfo-&gt;image_w, myInfo-&gt;image_h,
-                    w, h, bar, bar, bar);
+                    width, height, bar, bar, bar);
             return 0;
         }
 
@@ -2319,172 +2436,192 @@
         switch (tool)
         {
         case TOOL_A:
-            applyImage (image, data, planesize, bias, int_img, OpPequalsA(), HistogramNull());
+            sak-&gt;applyImage (image, data, planesize, param, bias, int_img,
+                             OpPequalsA(), HistogramNull());
             break;
         case TOOL_P: // HERE: we could optimize this if we wanted to
-            applyImage (image, data, planesize, bias, int_img, OpPequalsP(), HistogramNull());
+            sak-&gt;applyImage (image, data, planesize, param, bias, int_img,
+                             OpPequalsP(), HistogramNull());
             break;
         case TOOL_P_MINUS_A:
-            applyImage (image, data, planesize, bias, int_img, OpPequalsPminusA(), HistogramNull());
+            sak-&gt;applyImage (image, data, planesize, param, bias, int_img,
+                             OpPequalsPminusA(), HistogramNull());
             break;
         case TOOL_A_MINUS_P:
-            applyImage (image, data, planesize, bias, int_img, OpPequalsAminusP(), HistogramNull());
+            sak-&gt;applyImage (image, data, planesize, param, bias, int_img,
+                             OpPequalsAminusP(), HistogramNull());
             break;
         case TOOL_P_PLUS_A:
-            applyImage (image, data, planesize, bias, int_img, OpPequalsPplusA(), HistogramNull());
+            sak-&gt;applyImage (image, data, planesize, param, bias, int_img,
+                             OpPequalsPplusA(), HistogramNull());
             break;
         case TOOL_P_TIMES_A:
-            applyImage (image, data, planesize, bias, int_img, OpPequalsPtimesA(), HistogramNull());
+            sak-&gt;applyImage (image, data, planesize, param, bias, int_img,
+                             OpPequalsPtimesA(), HistogramNull());
             break;
         case TOOL_P_DIVBY_A:
-            applyImage (image, data, planesize, bias, int_img, OpPequalsPdivByA(), HistogramNull());
+            sak-&gt;applyImage (image, data, planesize, param, bias, int_img,
+                             OpPequalsPdivByA(), HistogramNull());
             break;
         case TOOL_A_DIVBY_P:
-            applyImage (image, data, planesize, bias, int_img, OpPequalsAdivByP(), HistogramNull());
+            sak-&gt;applyImage (image, data, planesize, param, bias, int_img,
+                             OpPequalsAdivByP(), HistogramNull());
             break;
         case TOOL_MIN_P_A:
-            applyImage (image, data, planesize, bias, int_img, OpPequalsMinPA(), HistogramNull());
+            sak-&gt;applyImage (image, data, planesize, param, bias, int_img,
+                             OpPequalsMinPA(), HistogramNull());
             break;
         case TOOL_MAX_P_A:
-            applyImage (image, data, planesize, bias, int_img, OpPequalsMaxPA(), HistogramNull());
+            sak-&gt;applyImage (image, data, planesize, param, bias, int_img,
+                             OpPequalsMaxPA(), HistogramNull());
             break;
 
         case TOOL_A_WITH_HISTOGRAM:
-            applyImage (image, data, planesize, bias, int_img, OpPequalsA(), *histogram);
+            sak-&gt;applyImage (image, data, planesize, param, bias, int_img,
+                             OpPequalsA(), *histogram);
             break;
         case TOOL_P_WITH_HISTOGRAM: // HERE: we could optimize this if we wanted to
-            applyImage (image, data, planesize, bias, int_img, OpPequalsP(), *histogram);
+            sak-&gt;applyImage (image, data, planesize, param, bias, int_img,
+                             OpPequalsP(), *histogram);
             break;
         case TOOL_P_MINUS_A_WITH_HISTOGRAM:
-            applyImage (image, data, planesize, bias, int_img, OpPequalsPminusA(), *histogram);
+            sak-&gt;applyImage (image, data, planesize, param, bias, int_img,
+                             OpPequalsPminusA(), *histogram);
             break;
         case TOOL_A_MINUS_P_WITH_HISTOGRAM:
-            applyImage (image, data, planesize, bias, int_img, OpPequalsAminusP(), *histogram);
+            sak-&gt;applyImage (image, data, planesize, param, bias, int_img,
+                             OpPequalsAminusP(), *histogram);
             break;
         case TOOL_P_PLUS_A_WITH_HISTOGRAM:
-            applyImage (image, data, planesize, bias, int_img, OpPequalsPplusA(), *histogram);
+            sak-&gt;applyImage (image, data, planesize, param, bias, int_img,
+                             OpPequalsPplusA(), *histogram);
             break;
         case TOOL_P_TIMES_A_WITH_HISTOGRAM:
-            applyImage (image, data, planesize, bias, int_img, OpPequalsPtimesA(), *histogram);
+            sak-&gt;applyImage (image, data, planesize, param, bias, int_img,
+                             OpPequalsPtimesA(), *histogram);
             break;
         case TOOL_P_DIVBY_A_WITH_HISTOGRAM:
-            applyImage (image, data, planesize, bias, int_img, OpPequalsPdivByA(), *histogram);
+            sak-&gt;applyImage (image, data, planesize, param, bias, int_img,
+                             OpPequalsPdivByA(), *histogram);
             break;
         case TOOL_A_DIVBY_P_WITH_HISTOGRAM:
-            applyImage (image, data, planesize, bias, int_img, OpPequalsAdivByP(), *histogram);
+            sak-&gt;applyImage (image, data, planesize, param, bias, int_img,
+                             OpPequalsAdivByP(), *histogram);
             break;
         case TOOL_MIN_P_A_WITH_HISTOGRAM:
-            applyImage (image, data, planesize, bias, int_img, OpPequalsMinPA(), *histogram);
+            sak-&gt;applyImage (image, data, planesize, param, bias, int_img,
+                             OpPequalsMinPA(), *histogram);
             break;
         case TOOL_MAX_P_A_WITH_HISTOGRAM:
-            applyImage (image, data, planesize, bias, int_img, OpPequalsMaxPA(), *histogram);
+            sak-&gt;applyImage (image, data, planesize, param, bias, int_img,
+                             OpPequalsMaxPA(), *histogram);
             break;
 
         case TOOL_A_SCALED:
-            applyImage (image, data, planesize, bias, int_img,
-                        OpPequalsA_Scaled (scale_min, scale_max),
-                        HistogramNull());
+            sak-&gt;applyImage (image, data, planesize, param, bias, int_img,
+                             OpPequalsA_Scaled (rbias, rmultiplier),
+                             HistogramNull());
             break;
         case TOOL_P_SCALED: // HERE_SCALED: we could optimize this if we wanted to
-            applyImage (image, data, planesize, bias, int_img,
-                        OpPequalsP_Scaled (scale_min, scale_max),
-                        HistogramNull());
+            sak-&gt;applyImage (image, data, planesize, param, bias, int_img,
+                             OpPequalsP_Scaled (rbias, rmultiplier),
+                             HistogramNull());
             break;
         case TOOL_P_MINUS_A_SCALED:
-            applyImage (image, data, planesize, bias, int_img,
-                        OpPequalsPminusA_Scaled (scale_min, scale_max),
-                        HistogramNull());
+            sak-&gt;applyImage (image, data, planesize, param, bias, int_img,
+                             OpPequalsPminusA_Scaled (rbias, rmultiplier),
+                             HistogramNull());
             break;
         case TOOL_A_MINUS_P_SCALED:
-            applyImage (image, data, planesize, bias, int_img,
-                        OpPequalsAminusP_Scaled (scale_min, scale_max),
-                        HistogramNull());
+            sak-&gt;applyImage (image, data, planesize, param, bias, int_img,
+                             OpPequalsAminusP_Scaled (rbias, rmultiplier),
+                             HistogramNull());
             break;
         case TOOL_P_PLUS_A_SCALED:
-            applyImage (image, data, planesize, bias, int_img,
-                        OpPequalsPplusA_Scaled (scale_min, scale_max),
-                        HistogramNull());
+            sak-&gt;applyImage (image, data, planesize, param, bias, int_img,
+                             OpPequalsPplusA_Scaled (rbias, rmultiplier),
+                             HistogramNull());
             break;
         case TOOL_P_TIMES_A_SCALED:
-            applyImage (image, data, planesize, bias, int_img,
-                        OpPequalsPtimesA_Scaled (scale_min, scale_max),
-                        HistogramNull());
+            sak-&gt;applyImage (image, data, planesize, param, bias, int_img,
+                             OpPequalsPtimesA_Scaled (rbias, rmultiplier),
+                             HistogramNull());
             break;
         case TOOL_P_DIVBY_A_SCALED:
-            applyImage (image, data, planesize, bias, int_img,
-                        OpPequalsPdivByA_Scaled (scale_min, scale_max),
-                        HistogramNull());
+            sak-&gt;applyImage (image, data, planesize, param, bias, int_img,
+                             OpPequalsPdivByA_Scaled (rbias, rmultiplier),
+                             HistogramNull());
             break;
         case TOOL_A_DIVBY_P_SCALED:
-            applyImage (image, data, planesize, bias, int_img,
-                        OpPequalsAdivByP_Scaled (scale_min, scale_max),
-                        HistogramNull());
+            sak-&gt;applyImage (image, data, planesize, param, bias, int_img,
+                             OpPequalsAdivByP_Scaled (rbias, rmultiplier),
+                             HistogramNull());
             break;
         case TOOL_MIN_P_A_SCALED:
-            applyImage (image, data, planesize, bias, int_img,
-                        OpPequalsMinPA_Scaled (scale_min, scale_max),
-                        HistogramNull());
+            sak-&gt;applyImage (image, data, planesize, param, bias, int_img,
+                             OpPequalsMinPA_Scaled (rbias, rmultiplier),
+                             HistogramNull());
             break;
         case TOOL_MAX_P_A_SCALED:
-            applyImage (image, data, planesize, bias, int_img,
-                        OpPequalsMaxPA_Scaled (scale_min, scale_max),
-                        HistogramNull());
+            sak-&gt;applyImage (image, data, planesize, param, bias, int_img,
+                             OpPequalsMaxPA_Scaled (rbias, rmultiplier),
+                             HistogramNull());
             break;
 
         case TOOL_A_SCALED_WITH_HISTOGRAM:
-            applyImage (image, data, planesize, bias, int_img,
-                        OpPequalsA_Scaled (scale_min, scale_max),
-                        *histogram);
+            sak-&gt;applyImage (image, data, planesize, param, bias, int_img,
+                             OpPequalsA_Scaled (rbias, rmultiplier),
+                             *histogram);
             break;
         case TOOL_P_SCALED_WITH_HISTOGRAM: // HERE: we could optimize this if we wanted to
-            applyImage (image, data, planesize, bias, int_img,
-                        OpPequalsP_Scaled (scale_min, scale_max),
-                        *histogram);
+            sak-&gt;applyImage (image, data, planesize, param, bias, int_img,
+                             OpPequalsP_Scaled (rbias, rmultiplier),
+                             *histogram);
             break;
         case TOOL_P_MINUS_A_SCALED_WITH_HISTOGRAM:
-            applyImage (image, data, planesize, bias, int_img,
-                        OpPequalsPminusA_Scaled (scale_min, scale_max),
-                        *histogram);
+            sak-&gt;applyImage (image, data, planesize, param, bias, int_img,
+                             OpPequalsPminusA_Scaled (rbias, rmultiplier),
+                             *histogram);
             break;
         case TOOL_A_MINUS_P_SCALED_WITH_HISTOGRAM:
-            applyImage (image, data, planesize, bias, int_img,
-                        OpPequalsAminusP_Scaled (scale_min, scale_max),
-                        *histogram);
+            sak-&gt;applyImage (image, data, planesize, param, bias, int_img,
+                             OpPequalsAminusP_Scaled (rbias, rmultiplier),
+                             *histogram);
             break;
         case TOOL_P_PLUS_A_SCALED_WITH_HISTOGRAM:
-            applyImage (image, data, planesize, bias, int_img,
-                        OpPequalsPplusA_Scaled (scale_min, scale_max),
-                        *histogram);
+            sak-&gt;applyImage (image, data, planesize, param, bias, int_img,
+                             OpPequalsPplusA_Scaled (rbias, rmultiplier),
+                             *histogram);
             break;
         case TOOL_P_TIMES_A_SCALED_WITH_HISTOGRAM:
-            applyImage (image, data, planesize, bias, int_img,
-                        OpPequalsPtimesA_Scaled (scale_min, scale_max),
-                        *histogram);
+            sak-&gt;applyImage (image, data, planesize, param, bias, int_img,
+                             OpPequalsPtimesA_Scaled (rbias, rmultiplier),
+                             *histogram);
             break;
         case TOOL_P_DIVBY_A_SCALED_WITH_HISTOGRAM:
-            applyImage (image, data, planesize, bias, int_img,
-                        OpPequalsPdivByA_Scaled (scale_min, scale_max),
-                        *histogram);
+            sak-&gt;applyImage (image, data, planesize, param, bias, int_img,
+                             OpPequalsPdivByA_Scaled (rbias, rmultiplier),
+                             *histogram);
             break;
         case TOOL_A_DIVBY_P_SCALED_WITH_HISTOGRAM:
-            applyImage (image, data, planesize, bias, int_img,
-                        OpPequalsAdivByP_Scaled (scale_min, scale_max),
-                        *histogram);
+            sak-&gt;applyImage (image, data, planesize, param, bias, int_img,
+                             OpPequalsAdivByP_Scaled (rbias, rmultiplier),
+                             *histogram);
             break;
         case TOOL_MIN_P_A_SCALED_WITH_HISTOGRAM:
-            applyImage (image, data, planesize, bias, int_img,
-                        OpPequalsMinPA_Scaled (scale_min, scale_max),
-                        *histogram);
+            sak-&gt;applyImage (image, data, planesize, param, bias, int_img,
+                             OpPequalsMinPA_Scaled (rbias, rmultiplier),
+                             *histogram);
             break;
         case TOOL_MAX_P_A_SCALED_WITH_HISTOGRAM:
-            applyImage (image, data, planesize, bias, int_img,
-                        OpPequalsMaxPA_Scaled (scale_min, scale_max),
-                        *histogram);
+            sak-&gt;applyImage (image, data, planesize, param, bias, int_img,
+                             OpPequalsMaxPA_Scaled (rbias, rmultiplier),
+                             *histogram);
             break;
 
         default:
             printf (&quot;SwissArmyKnife: unknown operation (tool) %d!\n&quot;,
-                    _param-&gt;tool);
+                    param-&gt;tool);
             return 0;
         }
     }
@@ -2493,172 +2630,192 @@
         switch (tool)
         {
         case TOOL_A:
-            applyConstant (image, data, planesize, bias, OpPequalsA(), HistogramNull());
+            sak-&gt;applyConstant (image, data, planesize, param, bias,
+                                OpPequalsA(), HistogramNull());
             break;
         case TOOL_P: // HERE: we could optimize this if we wanted to
-            applyConstant (image, data, planesize, bias, OpPequalsP(), HistogramNull());
+            sak-&gt;applyConstant (image, data, planesize, param, bias,
+                                OpPequalsP(), HistogramNull());
             break;
         case TOOL_P_MINUS_A:
-            applyConstant (image, data, planesize, bias, OpPequalsPminusA(), HistogramNull());
+            sak-&gt;applyConstant (image, data, planesize, param, bias,
+                                OpPequalsPminusA(), HistogramNull());
             break;
         case TOOL_A_MINUS_P:
-            applyConstant (image, data, planesize, bias, OpPequalsAminusP(), HistogramNull());
+            sak-&gt;applyConstant (image, data, planesize, param, bias,
+                                OpPequalsAminusP(), HistogramNull());
             break;
         case TOOL_P_PLUS_A:
-            applyConstant (image, data, planesize, bias, OpPequalsPplusA(), HistogramNull());
+            sak-&gt;applyConstant (image, data, planesize, param, bias,
+                                OpPequalsPplusA(), HistogramNull());
             break;
         case TOOL_P_TIMES_A:
-            applyConstant (image, data, planesize, bias, OpPequalsPtimesA(), HistogramNull());
+            sak-&gt;applyConstant (image, data, planesize, param, bias,
+                                OpPequalsPtimesA(), HistogramNull());
             break;
         case TOOL_P_DIVBY_A:
-            applyConstant (image, data, planesize, bias, OpPequalsPdivByA(), HistogramNull());
+            sak-&gt;applyConstant (image, data, planesize, param, bias,
+                                OpPequalsPdivByA(), HistogramNull());
             break;
         case TOOL_A_DIVBY_P:
-            applyConstant (image, data, planesize, bias, OpPequalsAdivByP(), HistogramNull());
+            sak-&gt;applyConstant (image, data, planesize, param, bias,
+                                OpPequalsAdivByP(), HistogramNull());
             break;
         case TOOL_MIN_P_A:
-            applyConstant (image, data, planesize, bias, OpPequalsMinPA(), HistogramNull());
+            sak-&gt;applyConstant (image, data, planesize, param, bias,
+                                OpPequalsMinPA(), HistogramNull());
             break;
         case TOOL_MAX_P_A:
-            applyConstant (image, data, planesize, bias, OpPequalsMaxPA(), HistogramNull());
+            sak-&gt;applyConstant (image, data, planesize, param, bias,
+                                OpPequalsMaxPA(), HistogramNull());
             break;
 
         case TOOL_A_WITH_HISTOGRAM:
-            applyConstant (image, data, planesize, bias, OpPequalsA(), *histogram);
+            sak-&gt;applyConstant (image, data, planesize, param, bias,
+                                OpPequalsA(), *histogram);
             break;
         case TOOL_P_WITH_HISTOGRAM: // HERE: we could optimize this if we wanted to
-            applyConstant (image, data, planesize, bias, OpPequalsP(), *histogram);
+            sak-&gt;applyConstant (image, data, planesize, param, bias,
+                                OpPequalsP(), *histogram);
             break;
         case TOOL_P_MINUS_A_WITH_HISTOGRAM:
-            applyConstant (image, data, planesize, bias, OpPequalsPminusA(), *histogram);
+            sak-&gt;applyConstant (image, data, planesize, param, bias,
+                                OpPequalsPminusA(), *histogram);
             break;
         case TOOL_A_MINUS_P_WITH_HISTOGRAM:
-            applyConstant (image, data, planesize, bias, OpPequalsAminusP(), *histogram);
+            sak-&gt;applyConstant (image, data, planesize, param, bias,
+                                OpPequalsAminusP(), *histogram);
             break;
         case TOOL_P_PLUS_A_WITH_HISTOGRAM:
-            applyConstant (image, data, planesize, bias, OpPequalsPplusA(), *histogram);
+            sak-&gt;applyConstant (image, data, planesize, param, bias,
+                                OpPequalsPplusA(), *histogram);
             break;
         case TOOL_P_TIMES_A_WITH_HISTOGRAM:
-            applyConstant (image, data, planesize, bias, OpPequalsPtimesA(), *histogram);
+            sak-&gt;applyConstant (image, data, planesize, param, bias,
+                                OpPequalsPtimesA(), *histogram);
             break;
         case TOOL_P_DIVBY_A_WITH_HISTOGRAM:
-            applyConstant (image, data, planesize, bias, OpPequalsPdivByA(), *histogram);
+            sak-&gt;applyConstant (image, data, planesize, param, bias,
+                                OpPequalsPdivByA(), *histogram);
             break;
         case TOOL_A_DIVBY_P_WITH_HISTOGRAM:
-            applyConstant (image, data, planesize, bias, OpPequalsAdivByP(), *histogram);
+            sak-&gt;applyConstant (image, data, planesize, param, bias,
+                                OpPequalsAdivByP(), *histogram);
             break;
         case TOOL_MIN_P_A_WITH_HISTOGRAM:
-            applyConstant (image, data, planesize, bias, OpPequalsMinPA(), *histogram);
+            sak-&gt;applyConstant (image, data, planesize, param, bias,
+                                OpPequalsMinPA(), *histogram);
             break;
         case TOOL_MAX_P_A_WITH_HISTOGRAM:
-            applyConstant (image, data, planesize, bias, OpPequalsMaxPA(), *histogram);
+            sak-&gt;applyConstant (image, data, planesize, param, bias,
+                                OpPequalsMaxPA(), *histogram);
             break;
 
         case TOOL_A_SCALED:
-            applyConstant (image, data, planesize, bias,
-                           OpPequalsA_Scaled (scale_min, scale_max),
-                           HistogramNull());
+            sak-&gt;applyConstant (image, data, planesize, param, bias,
+                                OpPequalsA_Scaled (rbias, rmultiplier),
+                                HistogramNull());
             break;
         case TOOL_P_SCALED: // HERE_SCALED: we could optimize this if we wanted to
-            applyConstant (image, data, planesize, bias,
-                           OpPequalsP_Scaled (scale_min, scale_max),
-                           HistogramNull());
+            sak-&gt;applyConstant (image, data, planesize, param, bias,
+                                OpPequalsP_Scaled (rbias, rmultiplier),
+                                HistogramNull());
             break;
         case TOOL_P_MINUS_A_SCALED:
-            applyConstant (image, data, planesize, bias,
-                           OpPequalsPminusA_Scaled (scale_min, scale_max),
-                           HistogramNull());
+            sak-&gt;applyConstant (image, data, planesize, param, bias,
+                                OpPequalsPminusA_Scaled (rbias, rmultiplier),
+                                HistogramNull());
             break;
         case TOOL_A_MINUS_P_SCALED:
-            applyConstant (image, data, planesize, bias,
-                           OpPequalsAminusP_Scaled (scale_min, scale_max),
-                           HistogramNull());
+            sak-&gt;applyConstant (image, data, planesize, param, bias,
+                                OpPequalsAminusP_Scaled (rbias, rmultiplier),
+                                HistogramNull());
             break;
         case TOOL_P_PLUS_A_SCALED:
-            applyConstant (image, data, planesize, bias,
-                           OpPequalsPplusA_Scaled (scale_min, scale_max),
-                           HistogramNull());
+            sak-&gt;applyConstant (image, data, planesize, param, bias,
+                                OpPequalsPplusA_Scaled (rbias, rmultiplier),
+                                HistogramNull());
             break;
         case TOOL_P_TIMES_A_SCALED:
-            applyConstant (image, data, planesize, bias,
-                           OpPequalsPtimesA_Scaled (scale_min, scale_max),
-                           HistogramNull());
+            sak-&gt;applyConstant (image, data, planesize, param, bias,
+                                OpPequalsPtimesA_Scaled (rbias, rmultiplier),
+                                HistogramNull());
             break;
         case TOOL_P_DIVBY_A_SCALED:
-            applyConstant (image, data, planesize, bias,
-                           OpPequalsPdivByA_Scaled (scale_min, scale_max),
-                           HistogramNull());
+            sak-&gt;applyConstant (image, data, planesize, param, bias,
+                                OpPequalsPdivByA_Scaled (rbias, rmultiplier),
+                                HistogramNull());
             break;
         case TOOL_A_DIVBY_P_SCALED:
-            applyConstant (image, data, planesize, bias,
-                           OpPequalsAdivByP_Scaled (scale_min, scale_max),
-                           HistogramNull());
+            sak-&gt;applyConstant (image, data, planesize, param, bias,
+                                OpPequalsAdivByP_Scaled (rbias, rmultiplier),
+                                HistogramNull());
             break;
         case TOOL_MIN_P_A_SCALED:
-            applyConstant (image, data, planesize, bias,
-                           OpPequalsMinPA_Scaled (scale_min, scale_max),
-                           HistogramNull());
+            sak-&gt;applyConstant (image, data, planesize, param, bias,
+                                OpPequalsMinPA_Scaled (rbias, rmultiplier),
+                                HistogramNull());
             break;
         case TOOL_MAX_P_A_SCALED:
-            applyConstant (image, data, planesize, bias,
-                           OpPequalsMaxPA_Scaled (scale_min, scale_max),
-                           HistogramNull());
+            sak-&gt;applyConstant (image, data, planesize, param, bias,
+                                OpPequalsMaxPA_Scaled (rbias, rmultiplier),
+                                HistogramNull());
             break;
 
         case TOOL_A_SCALED_WITH_HISTOGRAM:
-            applyConstant (image, data, planesize, bias,
-                           OpPequalsA_Scaled (scale_min, scale_max),
-                           *histogram);
+            sak-&gt;applyConstant (image, data, planesize, param, bias,
+                                OpPequalsA_Scaled (rbias, rmultiplier),
+                                *histogram);
             break;
         case TOOL_P_SCALED_WITH_HISTOGRAM: // HERE: we could optimize this if we wanted to
-            applyConstant (image, data, planesize, bias,
-                           OpPequalsP_Scaled (scale_min, scale_max),
-                           *histogram);
+            sak-&gt;applyConstant (image, data, planesize, param, bias,
+                                OpPequalsP_Scaled (rbias, rmultiplier),
+                                *histogram);
             break;
         case TOOL_P_MINUS_A_SCALED_WITH_HISTOGRAM:
-            applyConstant (image, data, planesize, bias,
-                           OpPequalsPminusA_Scaled (scale_min, scale_max),
-                           *histogram);
+            sak-&gt;applyConstant (image, data, planesize, param, bias,
+                                OpPequalsPminusA_Scaled (rbias, rmultiplier),
+                                *histogram);
             break;
         case TOOL_A_MINUS_P_SCALED_WITH_HISTOGRAM:
-            applyConstant (image, data, planesize, bias,
-                           OpPequalsAminusP_Scaled (scale_min, scale_max),
-                           *histogram);
+            sak-&gt;applyConstant (image, data, planesize, param, bias,
+                                OpPequalsAminusP_Scaled (rbias, rmultiplier),
+                                *histogram);
             break;
         case TOOL_P_PLUS_A_SCALED_WITH_HISTOGRAM:
-            applyConstant (image, data, planesize, bias,
-                           OpPequalsPplusA_Scaled (scale_min, scale_max),
-                           *histogram);
+            sak-&gt;applyConstant (image, data, planesize, param, bias,
+                                OpPequalsPplusA_Scaled (rbias, rmultiplier),
+                                *histogram);
             break;
         case TOOL_P_TIMES_A_SCALED_WITH_HISTOGRAM:
-            applyConstant (image, data, planesize, bias,
-                           OpPequalsPtimesA_Scaled (scale_min, scale_max),
-                           *histogram);
+            sak-&gt;applyConstant (image, data, planesize, param, bias,
+                                OpPequalsPtimesA_Scaled (rbias, rmultiplier),
+                                *histogram);
             break;
         case TOOL_P_DIVBY_A_SCALED_WITH_HISTOGRAM:
-            applyConstant (image, data, planesize, bias,
-                           OpPequalsPdivByA_Scaled (scale_min, scale_max),
-                           *histogram);
+            sak-&gt;applyConstant (image, data, planesize, param, bias,
+                                OpPequalsPdivByA_Scaled (rbias, rmultiplier),
+                                *histogram);
             break;
         case TOOL_A_DIVBY_P_SCALED_WITH_HISTOGRAM:
-            applyConstant (image, data, planesize, bias,
-                           OpPequalsAdivByP_Scaled (scale_min, scale_max),
-                           *histogram);
+            sak-&gt;applyConstant (image, data, planesize, param, bias,
+                                OpPequalsAdivByP_Scaled (rbias, rmultiplier),
+                                *histogram);
             break;
         case TOOL_MIN_P_A_SCALED_WITH_HISTOGRAM:
-            applyConstant (image, data, planesize, bias,
-                           OpPequalsMinPA_Scaled (scale_min, scale_max),
-                           *histogram);
+            sak-&gt;applyConstant (image, data, planesize, param, bias,
+                                OpPequalsMinPA_Scaled (rbias, rmultiplier),
+                                *histogram);
             break;
         case TOOL_MAX_P_A_SCALED_WITH_HISTOGRAM:
-            applyConstant (image, data, planesize, bias,
-                           OpPequalsMaxPA_Scaled (scale_min, scale_max),
-                           *histogram);
+            sak-&gt;applyConstant (image, data, planesize, param, bias,
+                                OpPequalsMaxPA_Scaled (rbias, rmultiplier),
+                                *histogram);
             break;
 
         default:
             printf (&quot;SwissArmyKnife: unknown operation (tool) %d!\n&quot;,
-                    _param-&gt;tool);
+                    param-&gt;tool);
             return 0;
         }
     }
@@ -2680,5 +2837,6 @@
     memset (VPLANE (data), 128, planesize &gt;&gt; 2);
 
     data-&gt;copyInfo(image);
+
     return 1;
 }	                           

Modified: branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/ADM_vidSwissArmyKnife.h
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/ADM_vidSwissArmyKnife.h	2007-09-30 16:29:29 UTC (rev 3607)
+++ branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/ADM_vidSwissArmyKnife.h	2007-09-30 16:49:31 UTC (rev 3608)
@@ -32,25 +32,36 @@
     uint32_t tool; // ADMVideoSwissArmyKnife::Tool
     uint32_t input_type; // ADMVideoSwissArmyKnife::Input
 
-    const char * input_file;
+    std::string input_file;
     float load_bias;
     float load_multiplier;
 
     float input_constant;
 
-    uint32_t memory_constant_denom;
+    float    memory_constant_alpha;
     uint32_t init_start_frame;
     uint32_t init_end_frame;
     uint32_t init_by_rolling;
 
     int32_t  bias;
-    int32_t  scale_from_min;
-    int32_t  scale_from_max;
+    float    result_bias;
+    float    result_multiplier;
     uint32_t histogram_frame_interval;
     uint32_t debug;
 
+    bool     enable_preview;  // not loaded/stored; only for dialog
 };
 
+// Alas, because offsetof() is only supposed to work on POD (plain old data)
+// structs, and our SWISSARMYKNIFE_PARAM includes a std::string (which has a
+// constructor, and which causes SWISSARMYKNIFE_PARAM to therefore have an
+// implicit constructor), we need to define our own offsetof() to use for the
+// dialog menus.  See
+// <A HREF="http://www.cplusplus.com/reference/clibrary/cstddef/offsetof.html">http://www.cplusplus.com/reference/clibrary/cstddef/offsetof.html</A> for more
+// on offsetof().
+
+#define my_offsetof(_type, _memb) (size_t (&amp;(((_type *)1)-&gt;_memb)) - 1)
+
 class ADMVideoSwissArmyKnife : public AVDMGenericVideoStream
 {
 protected:
@@ -79,6 +90,8 @@
 
         uint32_t      image_w;
         uint32_t      image_h;
+        float         image_bias;
+        float         image_multiplier;
         uint8_t *     image_int;
         float *       image_float;
 
@@ -86,7 +99,7 @@
         time_t        input_file_mtime;
 
         float *       bg;
-        uint32_t      bg_mc;
+        float         bg_mca;
         uint32_t      bg_isf;
         uint32_t      bg_ief;
         uint32_t      bg_x;
@@ -111,13 +124,15 @@
 
               image_w (0),
               image_h (0),
+              image_bias (0),
+              image_multiplier (0),
               image_int (0),
               image_float (0),
 
               input_file_mtime (0),
 
               bg (0),
-              bg_mc (0),
+              bg_mca (0),
               bg_isf (0),
               bg_ief (0),
               bg_x (0),
@@ -149,6 +164,7 @@
 
     PersistentInfo * myInfo;
 
+public:
     enum Input
     {
         INPUT_INVALID = 0,
@@ -162,6 +178,7 @@
         INPUT_COUNT
     };
 
+protected:
     enum Tool
     {
         TOOL_INVALID = 0,
@@ -214,7 +231,6 @@
 
         TOOL_ADD_HISTOGRAM = TOOL_A_WITH_HISTOGRAM - TOOL_A,
         TOOL_ADD_SCALING = TOOL_A_SCALED - TOOL_A,
-
     };
 
     struct ToolMap
@@ -222,11 +238,12 @@
         Tool toolid;
         const char * outputName; // displayed name
         const char * format;     // printf format (%s is A)
+        const char * spacy_format; // same with more whitespace
     };
 
     static ToolMap tool_map [];
 
-    SWISSARMYKNIFE_PARAM *  _param;
+    SWISSARMYKNIFE_PARAM * _param;
 
 public:
 
@@ -237,28 +254,53 @@
                                            ADMImage *data, uint32_t *flags);
 
     virtual uint8_t configure (AVDMGenericVideoStream *instream);
-    virtual char * printConf(void);
+    virtual char * printConf (void);
     virtual uint8_t getCoupledConf (CONFcouple **couples);
 
+    static char * getConf (SWISSARMYKNIFE_PARAM * param, bool forDialog);
+
+    static uint8_t doSwissArmyKnife (ADMImage * from_image,
+                                     ADMImage * to_image,
+                                     AVDMGenericVideoStream * in,
+                                     ADMVideoSwissArmyKnife * sak,
+                                     SWISSARMYKNIFE_PARAM * param,
+                                     uint32_t width, uint32_t height);
+
 private:
 
     template &lt;typename Oper, typename Histo&gt;
     void computeRollingAverage (ADMImage * image, ADMImage * data,
-                                uint32_t planesize, int32_t bias,
+                                uint32_t planesize,
+                                SWISSARMYKNIFE_PARAM * param,
+                                int32_t bias,
                                 const Oper &amp; op_in,
                                 const Histo &amp; histogram_in);
 
     template &lt;typename InputImageType, typename Oper, typename Histo&gt;
     void applyImage (ADMImage * image, ADMImage * data,
-                     uint32_t planesize, int32_t bias,
-                     InputImageType * input_image,
+                     uint32_t planesize,
+                     SWISSARMYKNIFE_PARAM * param,
+                     int32_t bias, InputImageType * input_image,
                      const Oper &amp; op_in, const Histo &amp; histogram_in);
 
     template &lt;typename Oper, typename Histo&gt;
     void applyConstant (ADMImage * image, ADMImage * data,
-                        uint32_t planesize, int32_t bias,
+                        uint32_t planesize,
+                        SWISSARMYKNIFE_PARAM * param,
+                        int32_t bias,
                         const Oper &amp; op_in,
                         const Histo &amp; histogram_in);
+    const ADV_Info &amp; getInfo () const
+    {
+        return _info;
+    }
+};
 
-};
+struct MenuMapping;
+uint8_t DIA_SwissArmyKnife (AVDMGenericVideoStream * in,
+                            ADMVideoSwissArmyKnife * sakp,
+                            SWISSARMYKNIFE_PARAM * param,
+                            const MenuMapping * menu_mapping,
+                            uint32_t menu_mapping_count);
+
 #endif

Modified: branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/ADM_vidThreshold.cpp
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/ADM_vidThreshold.cpp	2007-09-30 16:29:29 UTC (rev 3607)
+++ branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/ADM_vidThreshold.cpp	2007-09-30 16:49:31 UTC (rev 3608)
@@ -14,20 +14,13 @@
  *                                                                         *
  ***************************************************************************/
  
- 
-#include &lt;stdio.h&gt;
-#include &lt;stdlib.h&gt;
-#include &lt;string.h&gt;
-#include &lt;ADM_assert.h&gt;
-#include &lt;math.h&gt;
+#include &quot;default.h&quot;
 
-#include &quot;config.h&quot;
+#include &quot;ADM_assert.h&quot;
 #include &quot;fourcc.h&quot;
 #include &quot;avio.hxx&quot;
-#include &quot;config.h&quot;
 #include &quot;avi_vars.h&quot;
 
-
 #include &quot;ADM_toolkit/toolkit.hxx&quot;
 #include &quot;ADM_editor/ADM_edit.hxx&quot;
 #include &quot;ADM_video/ADM_genvideo.hxx&quot;
@@ -50,13 +43,13 @@
 			
 {
     printf (&quot;ADMVideoThreshold ctor (%p)\n&quot;, this);
-    _in=in;
+    _in = in;
     memcpy(&amp;_info,in-&gt;getInfo(),sizeof(_info));
-    _info.encoding=1;	
-    _uncompressed=new ADMImage(_in-&gt;getInfo()-&gt;width,_in-&gt;getInfo()-&gt;height);
-    ADM_assert(_uncompressed);    	  	
-    _param=NEW( THRESHOLD_PARAM );
-    if(couples)
+    _info.encoding = 1;
+    _uncompressed = new ADMImage(_in-&gt;getInfo()-&gt;width, _in-&gt;getInfo()-&gt;height);
+    ADM_assert(_uncompressed);
+    _param = new THRESHOLD_PARAM;
+    if (couples)
     {
         GET(min);
         GET(max);
@@ -71,27 +64,31 @@
         _param-&gt;debug = 0;
     }
 
-    computeLookupTable();
+    computeLookupTable (_param, lookup_table);
 }
 
-void ADMVideoThreshold::computeLookupTable ()
+uint8_t ADMVideoThreshold::computeLookupTable (THRESHOLD_PARAM * param,
+                                               uint8_t lookup_table [256])
 {
-    if (_param-&gt;min &gt; _param-&gt;max)
+    uint8_t changed = false;
+
+    if (param-&gt;min &gt; param-&gt;max)
     {
-        uint32_t tmp = _param-&gt;min;
-        _param-&gt;min = _param-&gt;max;
-        _param-&gt;max = tmp;
-        _param-&gt;in_range_is_white = !_param-&gt;in_range_is_white;
+        uint32_t tmp = param-&gt;min;
+        param-&gt;min = param-&gt;max;
+        param-&gt;max = tmp;
+        param-&gt;in_range_is_white = !param-&gt;in_range_is_white;
+        changed = true;
     }
 
-    uint32_t min = _param-&gt;min;
-    uint32_t max = _param-&gt;max;
+    uint32_t min = param-&gt;min;
+    uint32_t max = param-&gt;max;
     ADM_assert (min &lt;= max);
 
     uint8_t in_range_value;
     uint8_t out_of_range_value;
 
-    if (_param-&gt;in_range_is_white)
+    if (param-&gt;in_range_is_white)
     {
         in_range_value = 255;
         out_of_range_value = 0;
@@ -109,6 +106,8 @@
         else
             lookup_table [i] = in_range_value;
     }
+
+    return changed;
 }
 
 uint8_t	ADMVideoThreshold::getCoupledConf( CONFcouple **couples)
@@ -129,7 +128,20 @@
 
 uint8_t ADMVideoThreshold::configure(AVDMGenericVideoStream *in)
 {
-    UNUSED_ARG(in);
+    uint8_t ret = DIA_threshold (_in, _param);
+    if (ret == 1)
+    {
+        computeLookupTable (_param, lookup_table);
+        return ret;
+    }
+    else if (ret == 0) // 0 = cancel
+    {
+        return ret;
+    }
+    else
+    {
+        ADM_assert (ret == 255); // 255 = whizzy dialog not implemented
+    }
 
     diaElemUSlider minslide(&amp;(_param-&gt;min), QT_TR_NOOP(&quot;Mi_nimum value to be in-range:&quot;), 0, 255);
     diaElemUSlider maxslide(&amp;(_param-&gt;max), QT_TR_NOOP(&quot;Ma_ximum value to be in-range:&quot;), 0, 255);
@@ -148,11 +160,11 @@
                           0, 0x7fffffff);
     diaElem * elems[] = { &amp;minslide, &amp;maxslide, &amp;in_range_is_white, &amp;debug };
 
-    uint8_t ret = diaFactoryRun(&quot;Threshold&quot;, sizeof (elems) / sizeof (diaElem *), elems);
+    ret = diaFactoryRun(&quot;Threshold Configuration&quot;, sizeof (elems) / sizeof (diaElem *), elems);
 
     if (ret) // 0 = cancel
     {
-        computeLookupTable();
+        computeLookupTable (_param, lookup_table);
     }
 
     return ret;
@@ -162,8 +174,8 @@
 {
     printf (&quot;ADMVideoThreshold dtor (%p)\n&quot;, this);
     DELETE(_param);
-    delete  _uncompressed;	
-    _uncompressed=NULL;
+    delete _uncompressed;	
+    _uncompressed = NULL;
 }
 
 char *ADMVideoThreshold::printConf (void) 
@@ -195,7 +207,7 @@
                 frame);
 
     uint32_t planesize = _info.width * _info.height;
-    uint32_t size = (planesize*3)&gt;&gt;1;
+    uint32_t size = (planesize * 3) &gt;&gt; 1;
     *len = size;
 			
     if (!_in-&gt;getFrameNumberNoAlloc (frame, len, _uncompressed, flags))
@@ -210,56 +222,13 @@
     uint8_t * destp = YPLANE (data) + planesize;
     uint32_t pixremaining = planesize + 1;
 
-#ifdef THRESHOLD_HISTO
-    uint32_t histo_before [256];
-    uint32_t histo_after [256];
-
-    memset (histo_before, 0, 256 * sizeof (uint32_t));
-    memset (histo_after, 0, 256 * sizeof (uint32_t));
-#endif
-
-#ifdef DUMP_FRAME_DATA
-    FILE * fp = fopen (&quot;/tmp/framedump.new.out&quot;, &quot;a&quot;);
-    ADM_assert(fp);
-#endif
-
     while (--pixremaining)
     {
         int32_t curr = *--currp;
 
-#ifdef THRESHOLD_HISTO
-        histo_before [curr]++;
-#endif
-
-#ifdef DUMP_FRAME_DATA
-        fprintf (fp, &quot;%x\n&quot;, curr);
-#endif
-
         *--destp = lookup_table [curr];
-
-#ifdef THRESHOLD_HISTO
-        histo_after [*destp]++;
-#endif
     }
 
-#ifdef DUMP_FRAME_DATA
-    fclose (fp);
-#endif
-
-#ifdef THRESHOLD_HISTO
-    if (debug &amp; 0x800)
-    {
-        printf (&quot;    Histogram:\n\tValue\tBefore\tAfter\tValue\tBefore\tAfter&quot;
-                &quot;\tValue\tBefore\tAfter\tValue\tBefore\tAfter\n&quot;);
-        for (int val = 0; val &lt;= 63; val++)
-            printf (&quot;\t%3d:\t%6d\t%6d\t%3d:\t%6d\t%6d\t%3d:\t%6d\t%6d\t%3d:\t%6d\t%6d\n&quot;,
-                    val, histo_before [val], histo_after [val],
-                    val + 64, histo_before [val + 64], histo_after [val + 64],
-                    val + 128, histo_before [val + 128], histo_after [val + 128],
-                    val + 192, histo_before [val + 192], histo_after [val + 192]);
-    }
-#endif
-
     // HERE: the following two lines do a luma-only-ize
 
     memset (UPLANE (data), 128, planesize &gt;&gt; 2);
@@ -268,3 +237,27 @@
     data-&gt;copyInfo(image);
     return 1;
 }	                           
+
+// This is used by the preview code for the configuration dialog.
+
+void ADMVideoThreshold::doThreshold (ADMImage * from, ADMImage * to,
+                                     uint8_t * lookup_table,
+                                     uint32_t pixelcount)
+{
+    uint8_t * currp = YPLANE (from) + pixelcount;
+    uint8_t * destp = YPLANE (to) + pixelcount;
+    uint32_t pixremaining = pixelcount + 1;
+    uint8_t * table = lookup_table;
+
+    while (--pixremaining)
+    {
+        int32_t curr = *--currp;
+
+        *--destp = table [curr];
+    }
+
+    // HERE: the following two lines do a luma-only-ize
+
+    memset (UPLANE (to), 128, pixelcount &gt;&gt; 2);
+    memset (VPLANE (to), 128, pixelcount &gt;&gt; 2);
+}

Modified: branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/ADM_vidThreshold.h
===================================================================
--- branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/ADM_vidThreshold.h	2007-09-30 16:29:29 UTC (rev 3607)
+++ branches/avidemux_2.4_branch/avidemux/ADM_videoFilter/ADM_vidThreshold.h	2007-09-30 16:49:31 UTC (rev 3608)
@@ -16,7 +16,9 @@
  
 #ifndef __THRESHOLD__
 #define __THRESHOLD__   
+
 #include &quot;ADM_video/ADM_cache.h&quot;
+
 typedef struct THRESHOLD_PARAM
 {
 
@@ -27,27 +29,34 @@
 
 } THRESHOLD_PARAM;
 
-class  ADMVideoThreshold:public AVDMGenericVideoStream
- {
-
+class ADMVideoThreshold : public AVDMGenericVideoStream
+{
  protected:
     	
-     THRESHOLD_PARAM *  _param;
+     THRESHOLD_PARAM * _param;
      uint8_t lookup_table [256];
 
  public:
  		
 
-     ADMVideoThreshold(  AVDMGenericVideoStream *in,CONFcouple *setup);
+     ADMVideoThreshold (AVDMGenericVideoStream *in, CONFcouple *setup);
 
      ~ADMVideoThreshold();
 
-     virtual uint8_t 	getFrameNumberNoAlloc(uint32_t frame, uint32_t *len,
-                                              ADMImage *data,uint32_t *flags);
+     virtual uint8_t 	getFrameNumberNoAlloc (uint32_t frame, uint32_t *len,
+                                               ADMImage *data,uint32_t *flags);
 
-     virtual uint8_t 	configure( AVDMGenericVideoStream *instream);
+     virtual uint8_t 	configure (AVDMGenericVideoStream *instream);
      virtual char 		   *printConf(void);
-     virtual uint8_t 	getCoupledConf( CONFcouple **couples);
-     void computeLookupTable();
- };
+     virtual uint8_t 	getCoupledConf (CONFcouple **couples);
+
+     static uint8_t computeLookupTable (THRESHOLD_PARAM * param,
+                                        uint8_t lookup_table [256]);
+     static void doThreshold (ADMImage * from, ADMImage * to,
+                              uint8_t * lookup_table, uint32_t pixelcount);
+};
+
+uint8_t DIA_threshold (AVDMGenericVideoStream *in,
+                       THRESHOLD_PARAM * param);
+
 #endif


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000879.html">[Avidemux-svn-commit] r3607 -	branches/avidemux_2.4_branch/avidemux/ADM_inputs/ADM_matroska
</A></li>
	
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#880">[ date ]</a>
              <a href="thread.html#880">[ thread ]</a>
              <a href="subject.html#880">[ subject ]</a>
              <a href="author.html#880">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/avidemux-svn-commit">More information about the Avidemux-svn-commit
mailing list</a><br>
</body></html>
