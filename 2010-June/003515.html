<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Avidemux-svn-commit] r6322 - in	branches/avidemux_2.5_branch_gruntster/avidemux:	ADM_UIs/ADM_QT4/src ADM_userInterfaces/ADM_QT4	ADM_userInterfaces/ADM_QT4/ADM_dialog	ADM_userInterfaces/ADM_QT4/ADM_filters	ADM_userInterfaces/ADM_QT4/ADM_gui	ADM_userInterfaces/ADM_QT4/ADM_ocr
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/avidemux-svn-commit/2010-June/index.html" >
   <LINK REL="made" HREF="mailto:avidemux-svn-commit%40lists.berlios.de?Subject=Re%3A%20%5BAvidemux-svn-commit%5D%20r6322%20-%20in%0A%09branches/avidemux_2.5_branch_gruntster/avidemux%3A%0A%09ADM_UIs/ADM_QT4/src%20ADM_userInterfaces/ADM_QT4%0A%09ADM_userInterfaces/ADM_QT4/ADM_dialog%0A%09ADM_userInterfaces/ADM_QT4/ADM_filters%0A%09ADM_userInterfaces/ADM_QT4/ADM_gui%0A%09ADM_userInterfaces/ADM_QT4/ADM_ocr&In-Reply-To=%3C201006062304.o56N4XmI003750%40sheep.berlios.de%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="003514.html">
   <LINK REL="Next"  HREF="003516.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Avidemux-svn-commit] r6322 - in	branches/avidemux_2.5_branch_gruntster/avidemux:	ADM_UIs/ADM_QT4/src ADM_userInterfaces/ADM_QT4	ADM_userInterfaces/ADM_QT4/ADM_dialog	ADM_userInterfaces/ADM_QT4/ADM_filters	ADM_userInterfaces/ADM_QT4/ADM_gui	ADM_userInterfaces/ADM_QT4/ADM_ocr</H1>
    <B>gruntster at mail.berlios.de</B> 
    <A HREF="mailto:avidemux-svn-commit%40lists.berlios.de?Subject=Re%3A%20%5BAvidemux-svn-commit%5D%20r6322%20-%20in%0A%09branches/avidemux_2.5_branch_gruntster/avidemux%3A%0A%09ADM_UIs/ADM_QT4/src%20ADM_userInterfaces/ADM_QT4%0A%09ADM_userInterfaces/ADM_QT4/ADM_dialog%0A%09ADM_userInterfaces/ADM_QT4/ADM_filters%0A%09ADM_userInterfaces/ADM_QT4/ADM_gui%0A%09ADM_userInterfaces/ADM_QT4/ADM_ocr&In-Reply-To=%3C201006062304.o56N4XmI003750%40sheep.berlios.de%3E"
       TITLE="[Avidemux-svn-commit] r6322 - in	branches/avidemux_2.5_branch_gruntster/avidemux:	ADM_UIs/ADM_QT4/src ADM_userInterfaces/ADM_QT4	ADM_userInterfaces/ADM_QT4/ADM_dialog	ADM_userInterfaces/ADM_QT4/ADM_filters	ADM_userInterfaces/ADM_QT4/ADM_gui	ADM_userInterfaces/ADM_QT4/ADM_ocr">gruntster at mail.berlios.de
       </A><BR>
    <I>Mon Jun  7 01:04:33 CEST 2010</I>
    <P><UL>
        <LI>Previous message: <A HREF="003514.html">[Avidemux-svn-commit] r6321 -	branches/avidemux_2.5_branch_gruntster/avidemux/ADM_osSupport
</A></li>
        <LI>Next message: <A HREF="003516.html">[Avidemux-svn-commit] r6323 - in	branches/avidemux_2.5_branch_gruntster/plugins:	ADM_videoEncoder/ADM_vidEnc_x264/qt4	ADM_videoEncoder/ADM_vidEnc_xvid/qt4	ADM_videoFilters/AvisynthResize/qt4	ADM_videoFilters/MplayerResize/qt4
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#3515">[ date ]</a>
              <a href="thread.html#3515">[ thread ]</a>
              <a href="subject.html#3515">[ subject ]</a>
              <a href="author.html#3515">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Author: gruntster
Date: 2010-06-07 01:04:21 +0200 (Mon, 07 Jun 2010)
New Revision: 6322

Modified:
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_UIs/ADM_QT4/src/T_bitrate.cpp
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_UIs/ADM_QT4/src/T_configMenu.cpp
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_UIs/ADM_QT4/src/T_threadCount.cpp
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_encoding.cpp
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_jobs.cpp
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_license.cpp
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_props.cpp
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_vobsub.cpp
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/T_index_pg.cpp
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/T_index_pg.h
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/alert_qt4.cpp
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ADM_filters/Q_mainfilter.cpp
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/Q_gui2.cpp
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ADM_ocr/Q_glypheditor.cpp
   branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ui_support.cpp
Log:
[i18n] let Qt dialogs take care of themselves for i18n

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_UIs/ADM_QT4/src/T_bitrate.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_UIs/ADM_QT4/src/T_bitrate.cpp	2010-06-06 22:44:56 UTC (rev 6321)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_UIs/ADM_QT4/src/T_bitrate.cpp	2010-06-06 23:04:21 UTC (rev 6322)
@@ -1,264 +1,261 @@
-/***************************************************************************
-  FAC_toggle.cpp
-  Handle dialog factory element : Toggle
-  (C) 2006 Mean <A HREF="https://lists.berlios.de/mailman/listinfo/avidemux-svn-commit">Fixounet at free.fr</A> 
-***************************************************************************/
-
-/***************************************************************************
- *                                                                         *
- *   This program is free software; you can redistribute it and/or modify  *
- *   it under the terms of the GNU General Public License as published by  *
- *   the Free Software Foundation; either version 2 of the License, or     *
- *   (at your option) any later version.                                   *
- *                                                                         *
- ***************************************************************************/
-
-#include &quot;T_bitrate.h&quot;
-#include &quot;ADM_default.h&quot;
-#include &quot;DIA_factory.h&quot;
-#include &quot;ADM_dialogFactoryQt4.h&quot;
-
-#undef QT_TR_NOOP
-#include &quot;ADM_plugin/ADM_plugin_translate.h&quot;
-
-namespace ADM_Qt4Factory
-{
-class diaElemBitrate : public diaElemBitrateBase
-{
-public:
-  diaElemBitrate(COMPRES_PARAMS *p,const char *toggleTitle,const char *tip=NULL);
-  virtual ~diaElemBitrate() ;
-  void setMe(void *dialog, void *opaque,uint32_t line);
-  void getMe(void);
-  void setMaxQz(uint32_t qz);
-  void setMinQz(uint32_t qz);
-  int getRequiredLayout(void);
-  void updateMe(void);
-};
-
-ADM_Qbitrate::ADM_Qbitrate(COMPRES_PARAMS *p,uint32_t minQ, uint32_t mq,QGridLayout *layout,int line)
-{
-	compress=p;
-	combo=new QComboBox();
-
-	_minQ=minQ;
-	maxQ=mq;
-	int index=0,set=-1;
-#define add(x,z,y) if(compress-&gt;capabilities &amp; ADM_ENC_CAP_##x) {combo-&gt;addItem(QString::fromUtf8(y), COMPRESS_##z);\
-	if(p-&gt;mode==COMPRESS_##z) set=index;\
-	index++;}
-
-	add(CBR,CBR,QT_TR_NOOP(&quot;Constant Bitrate&quot;));
-	add(CQ,CQ,QT_TR_NOOP(&quot;Constant Quantiser&quot;));
-	add(SAME,SAME,QT_TR_NOOP(&quot;Same Quantiser as Input&quot;));
-	add(AQ,AQ,QT_TR_NOOP(&quot;Constant Rate Factor&quot;));
-	add(2PASS,2PASS,QT_TR_NOOP(&quot;Two Pass - Video Size&quot;));
-	add(2PASS_BR,2PASS_BITRATE,QT_TR_NOOP(&quot;Two Pass - Average Bitrate&quot;));
-
-	text1=new QLabel( QString::fromUtf8(QT_TR_NOOP(&quot;Encoding mode&quot;)));
-	text1-&gt;setBuddy(combo);
-
-	box=new QSpinBox();
-
-	text2=new QLabel( QString::fromUtf8(QT_TR_NOOP(&quot;Bitrate&quot;)));
-	text2-&gt;setBuddy(combo);
-
-	QHBoxLayout *hboxLayout = new QHBoxLayout();
-	QHBoxLayout *hboxLayout2 = new QHBoxLayout();
-	QSpacerItem *spacer = new QSpacerItem(20, 20, QSizePolicy::Expanding, QSizePolicy::Minimum);
-	QSpacerItem *spacer2 = new QSpacerItem(20, 20, QSizePolicy::Expanding, QSizePolicy::Minimum);
-
-	hboxLayout-&gt;addWidget(combo);
-	hboxLayout-&gt;addItem(spacer);
-
-	layout-&gt;addWidget(text1,line,0);
-	layout-&gt;addItem(hboxLayout,line,1);
-
-	hboxLayout2-&gt;addWidget(box);
-	hboxLayout2-&gt;addItem(spacer2);
-
-	layout-&gt;addWidget(text2,line+1,0);
-	layout-&gt;addItem(hboxLayout2,line+1,1);
-
-	if(set!=-1) 
-	{
-		combo-&gt;setCurrentIndex(set);
-		comboChanged(set);
-	}
-	connect(combo, SIGNAL(currentIndexChanged(int )), this, SLOT(comboChanged(int )));
-
-
-}
-
-/**
- * 	\fn 	readPullDown
- * \brief 	Convert the raw read of the combox into the actual compression mode
- */
-static COMPRESSION_MODE readPulldown(COMPRES_PARAMS *copy,int rank)
-{
-	int index=0;
-	COMPRESSION_MODE mode=COMPRESS_MAX;
-	
-#undef LOOKUP
-#define LOOKUP(A,B) \
-  if(copy-&gt;capabilities &amp; ADM_ENC_CAP_##A) \
-  { \
-	  if(rank==index) mode=COMPRESS_##B; \
-	  index++; \
-  } 
-  
-  LOOKUP(CBR,CBR);
-  LOOKUP(CQ,CQ);
-  LOOKUP(SAME,SAME);
-  LOOKUP(AQ,AQ);
-  LOOKUP(2PASS,2PASS);
-  LOOKUP(2PASS_BR,2PASS_BITRATE);
-  
-	ADM_assert(mode!=COMPRESS_MAX);
-	return mode;
-}
-
-void ADM_Qbitrate::readBack(void)
-{
-#define Mx(x) compress-&gt;mode=x
-#define Vx(x) compress-&gt;x=box-&gt;value();
-	COMPRESSION_MODE mode=readPulldown(compress,combo-&gt;currentIndex());
-  switch(mode)
-  {
-    case COMPRESS_CBR: Mx(COMPRESS_CBR);Vx(bitrate);break;
-    case COMPRESS_CQ: Mx(COMPRESS_CQ);Vx(qz);break;
-    case COMPRESS_2PASS: Mx(COMPRESS_2PASS);Vx(finalsize);break;
-    case COMPRESS_2PASS_BITRATE: Mx(COMPRESS_2PASS_BITRATE);Vx(avg_bitrate);break;
-    case COMPRESS_SAME: Mx(COMPRESS_SAME);break;
-    case COMPRESS_AQ: Mx(COMPRESS_AQ);Vx(qz);break;
-    default :
-          ADM_assert(0);
-  }
-}
-
-void ADM_Qbitrate::updateMe()
-{
-	updateCombo(compress-&gt;mode);
-}
-
-void ADM_Qbitrate::updateCombo(COMPRESSION_MODE mode)
-{
-#define P(x) text2-&gt;setText(QString::fromUtf8(x))
-#define M(x,y) box-&gt;setMinimum  (x);box-&gt;setMaximum  (y);
-#define S(x)   box-&gt;setValue(x);
-
-	for (int i = 0; i &lt; combo-&gt;count(); i++)
-	{
-		if (combo-&gt;itemData(i).toInt() == mode)
-		{
-			if (combo-&gt;currentIndex() != i)
-				combo-&gt;setCurrentIndex(i);
-
-			break;
-		}
-	}
-
-	switch(mode)
-	{
-		case COMPRESS_CBR: //CBR
-			P(QT_TR_NOOP(&quot;Target bitrate (kb/s)&quot;));
-			M(0,20000);
-			S(compress-&gt;bitrate);
-			break; 
-		case COMPRESS_<A HREF="CQ://">CQ://</A> CQ
-			P(QT_TR_NOOP(&quot;Quantiser&quot;));
-			M(_minQ,maxQ);
-			S(compress-&gt;qz);
-			break;
-		case COMPRESS_2PASS : // 2pass Filesize
-			P(QT_TR_NOOP(&quot;Target video size (MB)&quot;));
-			M(1,8000);
-			S(compress-&gt;finalsize);
-			break;
-		case COMPRESS_2PASS_BITRATE : // 2pass Avg
-			P(QT_TR_NOOP(&quot;Average bitrate (kb/s)&quot;));
-			M(0,20000);
-			S(compress-&gt;avg_bitrate);
-			break;
-		case COMPRESS_SAME : // Same Qz as input
-			P(QT_TR_NOOP(&quot;-&quot;));
-			M(0,0);
-			break;
-		case COMPRESS_AQ : // AQ
-			P(QT_TR_NOOP(&quot;Quantiser&quot;));
-			M(_minQ,maxQ);
-			S(compress-&gt;qz);
-			break;
-		default:
-			ADM_assert(0);
-	}
-}
-
-void ADM_Qbitrate::comboChanged(int i)
-{
-	updateCombo(readPulldown(compress,i));
-}
-
-ADM_Qbitrate::~ADM_Qbitrate() {}
-
-//**********************************
-diaElemBitrate::diaElemBitrate(COMPRES_PARAMS *p,const char *toggleTitle,const char *tip)
-  : diaElemBitrateBase()
-{
- 
-  param=(void *)p;
-  memcpy(&amp;copy,p,sizeof(copy));
-  paramTitle=NULL;
-  this-&gt;tip=tip;
-  setSize(2);
-  minQ=2;
-  maxQ=31;
-}
-
-void diaElemBitrate::setMinQz(uint32_t qz)
-{
-  minQ=qz;
-}
-
-void diaElemBitrate::setMaxQz(uint32_t qz)
-{
-  maxQ=qz; 
-}
-
-diaElemBitrate::~diaElemBitrate() {};
-
-void diaElemBitrate::setMe(void *dialog, void *opaque,uint32_t line)
-{
-  QGridLayout *layout=(QGridLayout*) opaque;
-  
-  ADM_Qbitrate *b=new ADM_Qbitrate((COMPRES_PARAMS *)&amp;copy,minQ,maxQ,layout,line);
-  myWidget=(void *)b;
-  
-}
-void diaElemBitrate::getMe(void)
-{
-  ((ADM_Qbitrate *)myWidget)-&gt;readBack();
-  memcpy(param,&amp;copy,sizeof(copy));
-}
-
-int diaElemBitrate::getRequiredLayout(void) { return FAC_QT_GRIDLAYOUT; }
-
-void diaElemBitrate::updateMe(void)
-{
-	memcpy(&amp;copy, param, sizeof(copy));
-	((ADM_Qbitrate*)myWidget)-&gt;updateMe();
-}
-} // End of namespace
-//****************************Hoook*****************
-
-diaElem  *qt4CreateBitrate(COMPRES_PARAMS *p,const char *toggleTitle,const char *tip)
-{
-	return new  ADM_Qt4Factory::diaElemBitrate(p,toggleTitle,tip);
-}
-void qt4DestroyBitrate(diaElem *e)
-{
-	ADM_Qt4Factory::diaElemBitrate *a=(ADM_Qt4Factory::diaElemBitrate *)e;
-	delete a;
-}
-//EOF
-
+/***************************************************************************
+  FAC_toggle.cpp
+  Handle dialog factory element : Toggle
+  (C) 2006 Mean <A HREF="https://lists.berlios.de/mailman/listinfo/avidemux-svn-commit">Fixounet at free.fr</A> 
+***************************************************************************/
+
+/***************************************************************************
+ *                                                                         *
+ *   This program is free software; you can redistribute it and/or modify  *
+ *   it under the terms of the GNU General Public License as published by  *
+ *   the Free Software Foundation; either version 2 of the License, or     *
+ *   (at your option) any later version.                                   *
+ *                                                                         *
+ ***************************************************************************/
+
+#include &quot;T_bitrate.h&quot;
+#include &quot;ADM_default.h&quot;
+#include &quot;DIA_factory.h&quot;
+#include &quot;ADM_dialogFactoryQt4.h&quot;
+
+namespace ADM_Qt4Factory
+{
+class diaElemBitrate : public diaElemBitrateBase
+{
+public:
+  diaElemBitrate(COMPRES_PARAMS *p,const char *toggleTitle,const char *tip=NULL);
+  virtual ~diaElemBitrate() ;
+  void setMe(void *dialog, void *opaque,uint32_t line);
+  void getMe(void);
+  void setMaxQz(uint32_t qz);
+  void setMinQz(uint32_t qz);
+  int getRequiredLayout(void);
+  void updateMe(void);
+};
+
+ADM_Qbitrate::ADM_Qbitrate(COMPRES_PARAMS *p,uint32_t minQ, uint32_t mq,QGridLayout *layout,int line)
+{
+	compress=p;
+	combo=new QComboBox();
+
+	_minQ=minQ;
+	maxQ=mq;
+	int index=0,set=-1;
+#define add(x,z,y) if(compress-&gt;capabilities &amp; ADM_ENC_CAP_##x) {combo-&gt;addItem(y, COMPRESS_##z);\
+	if(p-&gt;mode==COMPRESS_##z) set=index;\
+	index++;}
+
+	add(CBR,CBR,tr(&quot;Constant Bitrate&quot;));
+	add(CQ,CQ,tr(&quot;Constant Quantiser&quot;));
+	add(SAME,SAME,tr(&quot;Same Quantiser as Input&quot;));
+	add(AQ,AQ,tr(&quot;Constant Rate Factor&quot;));
+	add(2PASS,2PASS,tr(&quot;Two Pass - Video Size&quot;));
+	add(2PASS_BR,2PASS_BITRATE,tr(&quot;Two Pass - Average Bitrate&quot;));
+
+	text1=new QLabel(tr(&quot;Encoding mode&quot;));
+	text1-&gt;setBuddy(combo);
+
+	box=new QSpinBox();
+
+	text2=new QLabel(tr(&quot;Bitrate&quot;));
+	text2-&gt;setBuddy(combo);
+
+	QHBoxLayout *hboxLayout = new QHBoxLayout();
+	QHBoxLayout *hboxLayout2 = new QHBoxLayout();
+	QSpacerItem *spacer = new QSpacerItem(20, 20, QSizePolicy::Expanding, QSizePolicy::Minimum);
+	QSpacerItem *spacer2 = new QSpacerItem(20, 20, QSizePolicy::Expanding, QSizePolicy::Minimum);
+
+	hboxLayout-&gt;addWidget(combo);
+	hboxLayout-&gt;addItem(spacer);
+
+	layout-&gt;addWidget(text1,line,0);
+	layout-&gt;addItem(hboxLayout,line,1);
+
+	hboxLayout2-&gt;addWidget(box);
+	hboxLayout2-&gt;addItem(spacer2);
+
+	layout-&gt;addWidget(text2,line+1,0);
+	layout-&gt;addItem(hboxLayout2,line+1,1);
+
+	if(set!=-1) 
+	{
+		combo-&gt;setCurrentIndex(set);
+		comboChanged(set);
+	}
+	connect(combo, SIGNAL(currentIndexChanged(int )), this, SLOT(comboChanged(int )));
+
+
+}
+
+/**
+ * 	\fn 	readPullDown
+ * \brief 	Convert the raw read of the combox into the actual compression mode
+ */
+static COMPRESSION_MODE readPulldown(COMPRES_PARAMS *copy,int rank)
+{
+	int index=0;
+	COMPRESSION_MODE mode=COMPRESS_MAX;
+	
+#undef LOOKUP
+#define LOOKUP(A,B) \
+  if(copy-&gt;capabilities &amp; ADM_ENC_CAP_##A) \
+  { \
+	  if(rank==index) mode=COMPRESS_##B; \
+	  index++; \
+  } 
+  
+  LOOKUP(CBR,CBR);
+  LOOKUP(CQ,CQ);
+  LOOKUP(SAME,SAME);
+  LOOKUP(AQ,AQ);
+  LOOKUP(2PASS,2PASS);
+  LOOKUP(2PASS_BR,2PASS_BITRATE);
+  
+	ADM_assert(mode!=COMPRESS_MAX);
+	return mode;
+}
+
+void ADM_Qbitrate::readBack(void)
+{
+#define Mx(x) compress-&gt;mode=x
+#define Vx(x) compress-&gt;x=box-&gt;value();
+	COMPRESSION_MODE mode=readPulldown(compress,combo-&gt;currentIndex());
+  switch(mode)
+  {
+    case COMPRESS_CBR: Mx(COMPRESS_CBR);Vx(bitrate);break;
+    case COMPRESS_CQ: Mx(COMPRESS_CQ);Vx(qz);break;
+    case COMPRESS_2PASS: Mx(COMPRESS_2PASS);Vx(finalsize);break;
+    case COMPRESS_2PASS_BITRATE: Mx(COMPRESS_2PASS_BITRATE);Vx(avg_bitrate);break;
+    case COMPRESS_SAME: Mx(COMPRESS_SAME);break;
+    case COMPRESS_AQ: Mx(COMPRESS_AQ);Vx(qz);break;
+    default :
+          ADM_assert(0);
+  }
+}
+
+void ADM_Qbitrate::updateMe()
+{
+	updateCombo(compress-&gt;mode);
+}
+
+void ADM_Qbitrate::updateCombo(COMPRESSION_MODE mode)
+{
+#define P(x) text2-&gt;setText(x)
+#define M(x,y) box-&gt;setMinimum  (x);box-&gt;setMaximum  (y);
+#define S(x)   box-&gt;setValue(x);
+
+	for (int i = 0; i &lt; combo-&gt;count(); i++)
+	{
+		if (combo-&gt;itemData(i).toInt() == mode)
+		{
+			if (combo-&gt;currentIndex() != i)
+				combo-&gt;setCurrentIndex(i);
+
+			break;
+		}
+	}
+
+	switch(mode)
+	{
+		case COMPRESS_CBR: //CBR
+			P(tr(&quot;Target bitrate (kb/s)&quot;));
+			M(0,20000);
+			S(compress-&gt;bitrate);
+			break; 
+		case COMPRESS_<A HREF="CQ://">CQ://</A> CQ
+			P(tr(&quot;Quantiser&quot;));
+			M(_minQ,maxQ);
+			S(compress-&gt;qz);
+			break;
+		case COMPRESS_2PASS : // 2pass Filesize
+			P(tr(&quot;Target video size (MB)&quot;));
+			M(1,8000);
+			S(compress-&gt;finalsize);
+			break;
+		case COMPRESS_2PASS_BITRATE : // 2pass Avg
+			P(tr(&quot;Average bitrate (kb/s)&quot;));
+			M(0,20000);
+			S(compress-&gt;avg_bitrate);
+			break;
+		case COMPRESS_SAME : // Same Qz as input
+			P(tr(&quot;-&quot;));
+			M(0,0);
+			break;
+		case COMPRESS_AQ : // AQ
+			P(tr(&quot;Quantiser&quot;));
+			M(_minQ,maxQ);
+			S(compress-&gt;qz);
+			break;
+		default:
+			ADM_assert(0);
+	}
+}
+
+void ADM_Qbitrate::comboChanged(int i)
+{
+	updateCombo(readPulldown(compress,i));
+}
+
+ADM_Qbitrate::~ADM_Qbitrate() {}
+
+//**********************************
+diaElemBitrate::diaElemBitrate(COMPRES_PARAMS *p,const char *toggleTitle,const char *tip)
+  : diaElemBitrateBase()
+{
+ 
+  param=(void *)p;
+  memcpy(&amp;copy,p,sizeof(copy));
+  paramTitle=NULL;
+  this-&gt;tip=tip;
+  setSize(2);
+  minQ=2;
+  maxQ=31;
+}
+
+void diaElemBitrate::setMinQz(uint32_t qz)
+{
+  minQ=qz;
+}
+
+void diaElemBitrate::setMaxQz(uint32_t qz)
+{
+  maxQ=qz; 
+}
+
+diaElemBitrate::~diaElemBitrate() {};
+
+void diaElemBitrate::setMe(void *dialog, void *opaque,uint32_t line)
+{
+  QGridLayout *layout=(QGridLayout*) opaque;
+  
+  ADM_Qbitrate *b=new ADM_Qbitrate((COMPRES_PARAMS *)&amp;copy,minQ,maxQ,layout,line);
+  myWidget=(void *)b;
+  
+}
+void diaElemBitrate::getMe(void)
+{
+  ((ADM_Qbitrate *)myWidget)-&gt;readBack();
+  memcpy(param,&amp;copy,sizeof(copy));
+}
+
+int diaElemBitrate::getRequiredLayout(void) { return FAC_QT_GRIDLAYOUT; }
+
+void diaElemBitrate::updateMe(void)
+{
+	memcpy(&amp;copy, param, sizeof(copy));
+	((ADM_Qbitrate*)myWidget)-&gt;updateMe();
+}
+} // End of namespace
+//****************************Hoook*****************
+
+diaElem  *qt4CreateBitrate(COMPRES_PARAMS *p,const char *toggleTitle,const char *tip)
+{
+	return new  ADM_Qt4Factory::diaElemBitrate(p,toggleTitle,tip);
+}
+void qt4DestroyBitrate(diaElem *e)
+{
+	ADM_Qt4Factory::diaElemBitrate *a=(ADM_Qt4Factory::diaElemBitrate *)e;
+	delete a;
+}
+//EOF
+

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_UIs/ADM_QT4/src/T_configMenu.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_UIs/ADM_QT4/src/T_configMenu.cpp	2010-06-06 22:44:56 UTC (rev 6321)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_UIs/ADM_QT4/src/T_configMenu.cpp	2010-06-06 23:04:21 UTC (rev 6322)
@@ -21,9 +21,6 @@
 #include &quot;ADM_files.h&quot;
 #include &quot;DIA_coreToolkit.h&quot;
 
-#undef QT_TR_NOOP
-#include &quot;ADM_plugin/ADM_plugin_translate.h&quot;
-
 extern &quot;C&quot;
 {
 #include &quot;ADM_plugin/ADM_vidEnc_plugin.h&quot;
@@ -46,10 +43,10 @@
 		this-&gt;controls = controls;
 		this-&gt;controlCount = controlCount;
 
-		label = new QLabel(QString::fromUtf8(QT_TR_NOOP(&quot;Configuration:&quot;)), widget);
+		label = new QLabel(tr(&quot;Configuration:&quot;), widget);
 		combobox = new QComboBox(widget);
-		saveAsButton = new QPushButton(QString::fromUtf8(QT_TR_NOOP(&quot;Save As&quot;)), widget);
-		deleteButton = new QPushButton(QString::fromUtf8(QT_TR_NOOP(&quot;Delete&quot;)), widget);
+		saveAsButton = new QPushButton(tr(&quot;Save As&quot;), widget);
+		deleteButton = new QPushButton(tr(&quot;Delete&quot;), widget);
 
 		QSpacerItem *spacer1 = new QSpacerItem(20, 20, QSizePolicy::Expanding, QSizePolicy::Minimum);
 		QSpacerItem *spacer2 = new QSpacerItem(20, 20, QSizePolicy::Expanding, QSizePolicy::Minimum);
@@ -120,8 +117,8 @@
 			configs.insert(QFileInfo(list[item]).completeBaseName(), CONFIG_MENU_SYSTEM);
 
 		combobox-&gt;clear();
-		combobox-&gt;addItem(QT_TR_NOOP(&quot;&lt;default&gt;&quot;), CONFIG_MENU_DEFAULT);
-		combobox-&gt;addItem(QT_TR_NOOP(&quot;&lt;custom&gt;&quot;), CONFIG_MENU_CUSTOM);
+		combobox-&gt;addItem(tr(&quot;&lt;default&gt;&quot;), CONFIG_MENU_DEFAULT);
+		combobox-&gt;addItem(tr(&quot;&lt;custom&gt;&quot;), CONFIG_MENU_CUSTOM);
 
 		QMap&lt;QString, int&gt;::const_iterator mapIterator = configs.constBegin();
 
@@ -181,7 +178,7 @@
 			QString configFileName = QFileInfo(QString(this-&gt;userConfigDir), combobox-&gt;currentText() + &quot;.xml&quot;).filePath();
 			QFile configFile(configFileName);
 
-			if (GUI_Question(QT_TR_NOOP(&quot;Are you sure you wish to delete the selected configuration?&quot;)) &amp;&amp; configFile.exists())
+			if (GUI_Question(tr(&quot;Are you sure you wish to delete the selected configuration?&quot;).toUtf8().constData()) &amp;&amp; configFile.exists())
 			{
 				configFile.remove();
 				combobox-&gt;removeItem(combobox-&gt;currentIndex());
@@ -196,7 +193,7 @@
 		{
 			ADM_mkdir(this-&gt;userConfigDir);
 
-			QString configFileName = QFileDialog::getSaveFileName(this, QT_TR_NOOP(&quot;Save As&quot;), this-&gt;userConfigDir, QT_TR_NOOP(&quot;Configuration File (*.xml)&quot;));
+			QString configFileName = QFileDialog::getSaveFileName(this, tr(&quot;Save As&quot;), this-&gt;userConfigDir, tr(&quot;Configuration File (*.xml)&quot;));
 
 			if (!configFileName.isNull())
 			{

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_UIs/ADM_QT4/src/T_threadCount.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_UIs/ADM_QT4/src/T_threadCount.cpp	2010-06-06 22:44:56 UTC (rev 6321)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_UIs/ADM_QT4/src/T_threadCount.cpp	2010-06-06 23:04:21 UTC (rev 6322)
@@ -17,9 +17,6 @@
 #include &quot;DIA_factory.h&quot;
 #include &quot;ADM_dialogFactoryQt4.h&quot;
 
-#undef QT_TR_NOOP
-#include &quot;ADM_plugin/ADM_plugin_translate.h&quot;
-
 extern const char* shortkey(const char*);
 
 namespace ADM_qt4Factory
@@ -45,9 +42,9 @@
 
 ADM_QthreadCount::ADM_QthreadCount(QWidget *widget, const char *title, uint32_t value, QGridLayout *layout, int line) : QWidget(widget) 
 {
-	radiobutton1 = new QRadioButton(QString::fromUtf8(QT_TR_NOOP(&quot;Disabled&quot;)), widget);
-	radiobutton2 = new QRadioButton(QString::fromUtf8(QT_TR_NOOP(&quot;Auto-detect&quot;)), widget);
-	radiobutton3 = new QRadioButton(QString::fromUtf8(QT_TR_NOOP(&quot;Custom&quot;)), widget);
+	radiobutton1 = new QRadioButton(tr(&quot;Disabled&quot;), widget);
+	radiobutton2 = new QRadioButton(tr(&quot;Auto-detect&quot;), widget);
+	radiobutton3 = new QRadioButton(tr(&quot;Custom&quot;), widget);
 
 	buttonGroup = new QButtonGroup;
 	buttonGroup-&gt;addButton(radiobutton1);

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_encoding.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_encoding.cpp	2010-06-06 22:44:56 UTC (rev 6321)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_encoding.cpp	2010-06-06 23:04:21 UTC (rev 6322)
@@ -24,10 +24,6 @@
 #include &quot;../ADM_gui/ADM_qtray.h&quot;
 #include &quot;ADM_toolkitQt.h&quot;
 
-#undef QT_TR_NOOP
-extern const char* translate(const char *__domainname, const char *__msgid);
-#define QT_TR_NOOP(x) translate(&quot;&quot;, x)
-
 extern void UI_iconify(void);
 extern void UI_deiconify(void);
 extern void UI_purge(void);
@@ -47,7 +43,7 @@
 	}
 #endif
 
-	ui.buttonBox-&gt;button(QDialogButtonBox::Cancel)-&gt;setText(QString::fromUtf8(QT_TR_NOOP(&quot;Pause / Abort&quot;)));
+	ui.buttonBox-&gt;button(QDialogButtonBox::Cancel)-&gt;setText(tr(&quot;Pause / Abort&quot;));
 
 	connect(ui.checkBoxShutdown, SIGNAL(stateChanged(int)), this, SLOT(shutdownChanged(int)));
 	connect(ui.buttonBox, SIGNAL(rejected()), this, SLOT(buttonPressed()));
@@ -108,7 +104,7 @@
 		ui.comboBoxPriority-&gt;setCurrentIndex(2);
 		connect(ui.checkBoxShutdown, SIGNAL(currentIndexChanged(int)), this, SLOT(priorityChanged(int)));
 
-		GUI_Error_HIG(QT_TR_NOOP(&quot;Privileges Required&quot;), QT_TR_NOOP( &quot;Root privileges are required to perform this operation.&quot;));
+		GUI_Error_HIG(tr(&quot;Privileges Required&quot;).toUtf().constData(), tr(&quot;Root privileges are required to perform this operation.&quot;).toUtf().constData());
 
 		return;
 	}
@@ -126,7 +122,7 @@
 		ui.checkBoxShutdown-&gt;setCheckState(Qt::Unchecked);
 		connect(ui.checkBoxShutdown, SIGNAL(stateChanged(int)), this, SLOT(shutdownChanged(int)));
 
-		GUI_Error_HIG(QT_TR_NOOP(&quot;Privileges Required&quot;), QT_TR_NOOP( &quot;Root privileges are required to perform this operation.&quot;));
+		GUI_Error_HIG(tr(&quot;Privileges Required&quot;).toUtf().constData(), tr(&quot;Root privileges are required to perform this operation.&quot;).toUtf().constData());
 	}
 #endif
 }
@@ -209,7 +205,7 @@
 
 	if (shutdownRequired &amp;&amp; !stopReq)
 	{
-		DIA_working *work=new DIA_working(QT_TR_NOOP(&quot;Shutting down&quot;));
+		DIA_working *work=new DIA_working(encodingWindow::tr(&quot;Shutting down&quot;).toUtf8().constData());
 		bool performShutdown=true;
 
 		for(int i = 0; i &lt;= 30; i++)
@@ -501,8 +497,8 @@
 
         if(stopReq)
         {
-          if(GUI_Alternate((char*)QT_TR_NOOP(&quot;The encoding is paused. Do you want to resume or abort?&quot;),
-                              (char*)QT_TR_NOOP(&quot;Resume&quot;),(char*)QT_TR_NOOP(&quot;Abort&quot;)))
+          if(GUI_Alternate((char*)encodingWindow::tr(&quot;The encoding is paused. Do you want to resume or abort?&quot;).toUtf8().constData(),
+                              (char*)encodingWindow::tr(&quot;Resume&quot;).toUtf8().constData(), (char*)encodingWindow::tr(&quot;Abort&quot;).toUtf8().constData()))
                  {
                          stopReq=0;
                  }

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_jobs.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_jobs.cpp	2010-06-06 22:44:56 UTC (rev 6321)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_jobs.cpp	2010-06-06 23:04:21 UTC (rev 6322)
@@ -7,13 +7,9 @@
 #include &quot;DIA_coreToolkit.h&quot;
 #include &quot;ADM_toolkitQt.h&quot;
 
-#undef QT_TR_NOOP
-extern const char* translate(const char *__domainname, const char *__msgid);
-#define QT_TR_NOOP(x) translate(&quot;&quot;, x)
-
 static void updateStatus(void);
 extern bool parseECMAScript(const char *name);
-static const char *StringStatus[]={QT_TR_NOOP(&quot;Ready&quot;),QT_TR_NOOP(&quot;Succeeded&quot;),QT_TR_NOOP(&quot;Failed&quot;),QT_TR_NOOP(&quot;Deleted&quot;),QT_TR_NOOP(&quot;Running&quot;)};
+static QString StringStatus[]={jobsWindow::tr(&quot;Ready&quot;), jobsWindow::tr(&quot;Succeeded&quot;), jobsWindow::tr(&quot;Failed&quot;), jobsWindow::tr(&quot;Deleted&quot;), jobsWindow::tr(&quot;Running&quot;)};
 
 ADM_Job_Descriptor::ADM_Job_Descriptor(void) 
 {
@@ -37,7 +33,7 @@
 
 	// Set headers
 	QStringList headers;
-	headers &lt;&lt; QT_TR_NOOP(&quot;Job Name&quot;) &lt;&lt; QT_TR_NOOP(&quot;Status&quot;) &lt;&lt; QT_TR_NOOP(&quot;Start Time&quot;) &lt;&lt; QT_TR_NOOP(&quot;End Time&quot;); 
+	headers &lt;&lt; tr(&quot;Job Name&quot;) &lt;&lt; tr(&quot;Status&quot;) &lt;&lt; tr(&quot;Start Time&quot;) &lt;&lt; tr(&quot;End Time&quot;); 
 
 	ui.tableWidget-&gt;setVerticalHeaderLabels(headers);
 	updateRows();
@@ -56,15 +52,12 @@
 {
 	delete [] desc;
 }
- /*
-    There is maybe a huge mem leak here
- */
-static void ADM_setText(const char *txt,uint32_t col, uint32_t row,QTableWidget *w)
+ 
+static void ADM_setText(QString txt,uint32_t col, uint32_t row,QTableWidget *w)
 {
-	QString str = QString::fromUtf8(txt);
-        QTableWidgetItem *newItem = new QTableWidgetItem(str);//GetFileName(_jobsName[i]));
-        w-&gt;setItem(row, col, newItem);
-  
+	QTableWidgetItem *newItem = new QTableWidgetItem(txt);
+
+	w-&gt;setItem(row, col, newItem);  
 }
  /**
       \fn updateRaw
@@ -78,14 +71,10 @@
    for(int i=0;i&lt;_nbJobs;i++)
    {
       j=&amp;(desc[i]);
-      ADM_setText(ADM_GetFileName(_jobsName[i]),0,i,ui.tableWidget);
+      ADM_setText(QString(ADM_GetFileName(_jobsName[i])),0,i,ui.tableWidget);
       ADM_setText(StringStatus[j-&gt;status],1,i,ui.tableWidget);
-      
-      sprintf(str,&quot;%02u:%02u:%02u&quot;,j-&gt;startDate.hours,j-&gt;startDate.minutes,j-&gt;startDate.seconds);
-      ADM_setText(str,2,i,ui.tableWidget);
-      
-      sprintf(str,&quot;%02u:%02u:%02u&quot;,j-&gt;endDate.hours,j-&gt;endDate.minutes,j-&gt;endDate.seconds);
-      ADM_setText(str,3,i,ui.tableWidget);
+      ADM_setText(tr(&quot;%1:%2:%3&quot;).arg((uint)j-&gt;startDate.hours, 2, 10, QLatin1Char('0')).arg((uint)j-&gt;startDate.minutes, 2, 10, QLatin1Char('0')).arg((uint)j-&gt;startDate.seconds, 2, 10, QLatin1Char('0')), 2, i, ui.tableWidget);
+	  ADM_setText(tr(&quot;%1:%2:%3&quot;).arg((uint)j-&gt;endDate.hours, 2, 10, QLatin1Char('0')).arg((uint)j-&gt;endDate.minutes, 2, 10, QLatin1Char('0')).arg((uint)j-&gt;endDate.seconds, 2, 10, QLatin1Char('0')), 3, i, ui.tableWidget);
    }
 }
 
@@ -101,7 +90,7 @@
 
 	if (sel &gt;= 0 &amp;&amp; sel &lt; _nbJobs)
 	{
-		if (GUI_Confirmation_HIG(QT_TR_NOOP(&quot;Sure!&quot;), QT_TR_NOOP(&quot;Delete job&quot;), QT_TR_NOOP(&quot;Are you sure you want to delete %s job?&quot;), ADM_GetFileName(_jobsName[sel])))
+		if (GUI_Confirmation_HIG(tr(&quot;Sure!&quot;).toUtf8().constData(), tr(&quot;Delete job&quot;).toUtf8().constData(), tr(&quot;Are you sure you want to delete %s job?&quot;).toUtf8().constData(), ADM_GetFileName(_jobsName[sel])))
 		{
 			desc[sel].status = STATUS_DELETED;
 			unlink(_jobsName[sel]);
@@ -115,7 +104,7 @@
 */
 void jobsWindow::DeleteAll(bool b)
 {
-	if (GUI_Confirmation_HIG(QT_TR_NOOP(&quot;Sure!&quot;), QT_TR_NOOP(&quot;Delete *all* job&quot;), QT_TR_NOOP(&quot;Are you sure you want to delete ALL jobs?&quot;)))
+	if (GUI_Confirmation_HIG(tr(&quot;Sure!&quot;).toUtf8().constData(), tr(&quot;Delete *all* job&quot;).toUtf8().constData(), tr(&quot;Are you sure you want to delete ALL jobs?&quot;).toUtf8().constData()))
 	{
 		for(int sel = 0; sel &lt; _nbJobs; sel++)
 		{
@@ -139,7 +128,7 @@
 	if(sel &gt;= 0 &amp;&amp; sel &lt; _nbJobs)
 	{
 		if(desc[sel].status == STATUS_SUCCEED)
-			GUI_Info_HIG(ADM_LOG_INFO,QT_TR_NOOP(&quot;Already done&quot;),QT_TR_NOOP(&quot;This script has already been successfully executed.&quot;));
+			GUI_Info_HIG(ADM_LOG_INFO,tr(&quot;Already done&quot;).toUtf8().constData(),tr(&quot;This script has already been successfully executed.&quot;).toUtf8().constData());
 		else
 		{
 			desc[sel].status=STATUS_RUNNING;

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_license.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_license.cpp	2010-06-06 22:44:56 UTC (rev 6321)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_license.cpp	2010-06-06 23:04:21 UTC (rev 6322)
@@ -19,15 +19,11 @@
 #include &quot;ADM_default.h&quot;
 #include &quot;ADM_toolkitQt.h&quot;
 
-#undef QT_TR_NOOP
-extern const char* translate(const char *__domainname, const char *__msgid);
-#define QT_TR_NOOP(x) translate(&quot;&quot;, x)
-
 Ui_licenseWindow::Ui_licenseWindow(QWidget *parent) : QDialog(parent)
 {
 	ui.setupUi(this);
 
-	ui.licenseTextEdit-&gt;setHtml(QString::fromUtf8(QT_TR_NOOP(&quot;&lt;!DOCTYPE html PUBLIC \&quot;-//W3C//DTD HTML 4.01 Transitional//EN\&quot;&gt;&quot; \
+	ui.licenseTextEdit-&gt;setHtml(tr(&quot;&lt;!DOCTYPE html PUBLIC \&quot;-//W3C//DTD HTML 4.01 Transitional//EN\&quot;&gt;&quot; \
 	&quot;&quot; \
 	&quot;&lt;html&gt;&quot; \
 	&quot;&lt;head&gt;&quot; \
@@ -698,7 +694,7 @@
 	&quot;    &lt;span style='font-size:10.0pt; font-family:Arial'&gt; &lt;/span&gt;&lt;/p&gt;&quot; \
 	&quot;  &lt;/div&gt;&quot; \
 	&quot;&lt;/body&gt;&quot; \
-	&quot;&lt;/html&gt;&quot;)));
+	&quot;&lt;/html&gt;&quot;));
 }
 
 uint8_t DIA_license(void)

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_props.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_props.cpp	2010-06-06 22:44:56 UTC (rev 6321)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_props.cpp	2010-06-06 23:04:21 UTC (rev 6322)
@@ -20,11 +20,7 @@
 #include &quot;ADM_video/ADM_vidMisc.h&quot;
 #include &quot;ADM_toolkitQt.h&quot;
 
-#undef QT_TR_NOOP
-extern const char* translate(const char *__domainname, const char *__msgid);
-#define QT_TR_NOOP(x) translate(&quot;&quot;, x)
-
-static const char *yesno[2]={QT_TR_NOOP(&quot;No&quot;),QT_TR_NOOP(&quot;Yes&quot;)};
+static QString yesno[2] = {propWindow::tr(&quot;No&quot;), propWindow::tr(&quot;Yes&quot;)};
 extern const char *getStrFromAudioCodec( uint32_t codec);
 
 propWindow::propWindow(QWidget *parent) : QDialog(parent)
@@ -34,11 +30,9 @@
  uint32_t info=0;
  uint32_t war,har;
  uint16_t hh, mm, ss, ms;
- char text[80];
  const char *s;
   
-    text[0] = 0;
-    if (!avifileinfo)
+     if (!avifileinfo)
         return;
   
         // Fetch info
@@ -47,56 +41,52 @@
         qpel=!!(info &amp; ADM_QPEL_ON);
         gmc=!!(info &amp; ADM_GMC_ON);
 
-#define FILLTEXT(a,b,c) {snprintf(text,79,b,c);ui.a-&gt;setText(QString::fromUtf8(text));}
-#define FILLTEXT4(a,b,c,d) {snprintf(text,79,b,c,d);ui.a-&gt;setText(QString::fromUtf8(text));}
-#define FILLTEXT5(a,b,c,d,e) {snprintf(text,79,b,c,d,e);ui.a-&gt;setText(QString::fromUtf8(text));}
-        
-        FILLTEXT4(labeImageSize,QT_TR_NOOP(&quot;%lu x %lu&quot;), avifileinfo-&gt;width,avifileinfo-&gt;height);
-        FILLTEXT(labelFrameRate, QT_TR_NOOP(&quot;%2.3f fps&quot;), (float) avifileinfo-&gt;fps1000 / 1000.F);
-        FILLTEXT(labelNbOfFrames,QT_TR_NOOP(&quot;%ld frames&quot;), avifileinfo-&gt;nb_frames);
-        FILLTEXT(label4CC, &quot;%s&quot;,      fourCC::tostring(avifileinfo-&gt;fcc));
-        if (avifileinfo-&gt;nb_frames)
-          {
-                frame2time(avifileinfo-&gt;nb_frames, avifileinfo-&gt;fps1000,
-                          &amp;hh, &amp;mm, &amp;ss, &amp;ms);
-                snprintf(text,79, QT_TR_NOOP(&quot;%02d:%02d:%02d.%03d&quot;), hh, mm, ss, ms);
-                ui.labelVideoDuration-&gt;setText(QString::fromUtf8(text));
-          }
+		ui.labeImageSize-&gt;setText(tr(&quot;%1 x %2&quot;).arg(avifileinfo-&gt;width).arg(avifileinfo-&gt;height));
+		ui.labelFrameRate-&gt;setText(tr(&quot;%1 fps&quot;).arg(avifileinfo-&gt;fps1000 / 1000.F, 2, 'f', 3));
+        ui.labelNbOfFrames-&gt;setText(tr(&quot;%1 frames&quot;).arg(avifileinfo-&gt;nb_frames));
+        ui.label4CC-&gt;setText(fourCC::tostring(avifileinfo-&gt;fcc));
+
+		if (avifileinfo-&gt;nb_frames)
+		{
+			frame2time(avifileinfo-&gt;nb_frames, avifileinfo-&gt;fps1000,
+				&amp;hh, &amp;mm, &amp;ss, &amp;ms);
+
+			ui.labelVideoDuration-&gt;setText(tr(&quot;%1:%2:%3.%4&quot;).arg(hh, 2, 10, QLatin1Char('0')).arg(mm, 2, 10, QLatin1Char('0')).arg(ss, 2, 10, QLatin1Char('0')).arg(ms, 3, 10, QLatin1Char('0')));
+		}
+
         war=video_body-&gt;getPARWidth();
         har=video_body-&gt;getPARHeight();
         getAspectRatioFromAR(war,har, &amp;s);
-		FILLTEXT5(LabelAspectRatio,QT_TR_NOOP(&quot;%s (%u:%u)&quot;), s,war,har);
-#define SET_YES(a,b) ui.a-&gt;setText(QString::fromUtf8(yesno[b]))
-#define FILLQT_TR_NOOP(q) ui.q-&gt;setText(QString::fromUtf8(text));
+		ui.LabelAspectRatio-&gt;setText(tr(&quot;%1 (%2:%3)&quot;).arg(s).arg(war).arg(har));
+
+#define SET_YES(a,b) ui.a-&gt;setText(yesno[b])
+
         SET_YES(LabelPackedBitstream,vop);
         SET_YES(LabelQuarterPixel,qpel);
         SET_YES(LabelGMC,gmc);
         
          WAVHeader *wavinfo=NULL;
         if (currentaudiostream) wavinfo=currentaudiostream-&gt;getInfo();
-          if(wavinfo)
-          {
-              
-              switch (wavinfo-&gt;channels)
-                {
-                case 1:
-		  sprintf(text, &quot;%s&quot;, QT_TR_NOOP(&quot;Mono&quot;));
-                    break;
-                case 2:
-                    sprintf(text, &quot;%s&quot;, QT_TR_NOOP(&quot;Stereo&quot;));
-                    break;
-                default:
-                    sprintf(text, &quot;%d&quot;,wavinfo-&gt;channels);
-                    break;
-                }
 
-                FILLQT_TR_NOOP(labelChannels);
-                FILLTEXT(labelFrequency, QT_TR_NOOP(&quot;%lu Hz&quot;), wavinfo-&gt;frequency);
-                FILLTEXT4(labelBitrate, QT_TR_NOOP(&quot;%lu Bps / %lu kbps&quot;), wavinfo-&gt;byterate,wavinfo-&gt;byterate * 8 / 1000);
-                
-                sprintf(text, &quot;%s&quot;, getStrFromAudioCodec(wavinfo-&gt;encoding));
-                FILLQT_TR_NOOP(labelACodec);
+		if (wavinfo)
+		{              
+			switch (wavinfo-&gt;channels)
+			{
+				case 1:
+					ui.labelChannels-&gt;setText(tr(&quot;Mono&quot;));
+					break;
+				case 2:
+					ui.labelChannels-&gt;setText(tr(&quot;Stereo&quot;));
+					break;
+				default:
+					ui.labelChannels-&gt;setText(QString(&quot;%1&quot;).arg(wavinfo-&gt;channels));
+					break;
+				}
 
+                ui.labelFrequency-&gt;setText(tr(&quot;%1 Hz&quot;).arg(wavinfo-&gt;frequency));
+                ui.labelBitrate-&gt;setText(tr(&quot;%1 Bps / %2 kbps&quot;).arg(wavinfo-&gt;byterate).arg(wavinfo-&gt;byterate * 8 / 1000));
+                ui.labelACodec-&gt;setText(getStrFromAudioCodec(wavinfo-&gt;encoding));
+
                 // Duration in seconds too
                 if(currentaudiostream &amp;&amp; wavinfo-&gt;byterate&gt;1)
                 {
@@ -107,11 +97,8 @@
                         du/=wavinfo-&gt;byterate;
                         ms2time((uint32_t)floor(du), &amp;hh, &amp;mm, &amp;ss, &amp;ms);
 
-						sprintf(text, QT_TR_NOOP(&quot;%02d:%02d:%02d.%03d&quot;), hh, mm, ss, ms);
-						FILLQT_TR_NOOP(labelAudioDuration);
-
-						sprintf(text, QT_TR_NOOP(&quot;%.2f MB&quot;), l / 1048576.F);
-						FILLQT_TR_NOOP(labelFileSize);
+						ui.labelAudioDuration-&gt;setText(tr(&quot;%1:%2:%3.%4&quot;).arg(hh, 2, 10, QLatin1Char('0')).arg(mm, 2, 10, QLatin1Char('0')).arg(ss, 2, 10, QLatin1Char('0')).arg(ms, 3, 10, QLatin1Char('0')));
+						ui.labelFileSize-&gt;setText(tr(&quot;%1 MB&quot;).arg(l / 1048576.F, 0, 'f', 2));
                 }
 
                 SET_YES(labelVBR,currentaudiostream-&gt;isVBR());

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_vobsub.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_vobsub.cpp	2010-06-06 22:44:56 UTC (rev 6321)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/Q_vobsub.cpp	2010-06-06 23:04:21 UTC (rev 6322)
@@ -20,10 +20,6 @@
 #include &quot;DIA_fileSel.h&quot;
 #include &quot;ADM_toolkitQt.h&quot;
 
-#undef QT_TR_NOOP
-extern const char* translate(const char *__domainname, const char *__msgid);
-#define QT_TR_NOOP(x) translate(&quot;&quot;, x)
-
 //
 //	Video is in YV12 Colorspace
 //
@@ -89,7 +85,7 @@
 {
 	char fileIdx[1024];
 	
-	if(FileSel_SelectRead(QT_TR_NOOP(&quot;Select Idx File&quot;),fileIdx,1023, NULL) &amp;&amp; ADM_fileExist(fileIdx))
+	if(FileSel_SelectRead(tr(&quot;Select Idx File&quot;).toUtf8().constData(),fileIdx,1023, NULL) &amp;&amp; ADM_fileExist(fileIdx))
 	{
 		// Set entry
 		ui.lineEditIdx-&gt;setText(fileIdx);

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/T_index_pg.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/T_index_pg.cpp	2010-06-06 22:44:56 UTC (rev 6321)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/T_index_pg.cpp	2010-06-06 23:04:21 UTC (rev 6322)
@@ -28,10 +28,6 @@
 #include &quot;ADM_video/ADM_vidMisc.h&quot;
 #include &quot;ADM_toolkitQt.h&quot;
 
-#undef QT_TR_NOOP
-extern const char* translate(const char *__domainname, const char *__msgid);
-#define QT_TR_NOOP(x) translate(&quot;&quot;, x)
-
 extern void UI_purge( void );
 
 void Ui_iDialog::setupUi(QDialog *Dialog)
@@ -68,9 +64,8 @@
 
 void Ui_iDialog::retranslateUi(QDialog *Dialog)
 {
-	Dialog-&gt;setWindowTitle(QApplication::translate(&quot;Dialog&quot;, &quot;Indexing&quot;, 0, QApplication::UnicodeUTF8));
-	labelTimeLeft-&gt;setText(QApplication::translate(&quot;Dialog&quot;, &quot;Time Left : Infinity&quot;, 0, QApplication::UnicodeUTF8));
-	labelImages-&gt;setText(QApplication::translate(&quot;Dialog&quot;, &quot;# Images :&quot;, 0, QApplication::UnicodeUTF8));
+	Dialog-&gt;setWindowTitle(QApplication::translate(&quot;IndexDialog&quot;, &quot;Indexing&quot;, 0, QApplication::UnicodeUTF8));
+	labelTimeLeft-&gt;setText(QApplication::translate(&quot;IndexDialog&quot;, &quot;Time Left:&quot;, 0, QApplication::UnicodeUTF8));
 
 	Q_UNUSED(Dialog);
 }
@@ -115,18 +110,13 @@
 	tim=clock.getElapsedMS();
 	if(tim&gt;_nextUpdate)
 	{
-        char string[256];
         double f;
         	uint32_t   tom,zhh,zmm,zss;
 
 		_nextUpdate=tim+GUI_UPDATE_RATE;
-        sprintf(string,&quot;%02d:%02d:%02d&quot;,hh,mm,ss);
-        dialog-&gt;setTime(string);
-        
+        dialog-&gt;setTime(QString(QApplication::translate(&quot;IndexDialog&quot;, &quot;%1:%2:%3&quot;).arg(hh, 2, 10, QLatin1Char('0')).arg(mm, 2, 10, QLatin1Char('0')).arg(ss, 2, 10, QLatin1Char('0'))));
+		dialog-&gt;setImage(QString(QApplication::translate(&quot;IndexDialog&quot;, &quot;# Images: %1&quot;)).arg(nbImage));
 
-        sprintf(string,QT_TR_NOOP(&quot;# Images :%0lu&quot;),nbImage);
-        dialog-&gt;setImage(string);
-
         f=done;
         f/=total;
 
@@ -142,8 +132,8 @@
         if(tim&gt;tom) return 1;
         tom=tom-tim;
         ms2time(tom,&amp;zhh,&amp;zmm,&amp;zss);
-        sprintf(string,QT_TR_NOOP(&quot;Time Left :%02d:%02d:%02d&quot;),zhh,zmm,zss);
-        dialog-&gt;setETA(string);
+
+        dialog-&gt;setETA(QString(QApplication::translate(&quot;IndexDialog&quot;, &quot;Time Left: %1:%2:%3&quot;)).arg(zhh, 2, 10, QLatin1Char('0')).arg(zmm, 2, 10, QLatin1Char('0')).arg(zss, 2, 10, QLatin1Char('0')));
         UI_purge();
         }
         return 1;
@@ -158,26 +148,20 @@
 {
     
 }
-void Ui_indexingDialog::setTime(const char *f)
+void Ui_indexingDialog::setTime(QString f)
 {
-    //printf(&quot;Time:%s\n&quot;,f);
+
 }
-void Ui_indexingDialog::setImage(const char *f)
+void Ui_indexingDialog::setImage(QString f)
 {
-	dialog-&gt;ui.labelImages-&gt;setText(QString::fromUtf8(f));
+	dialog-&gt;ui.labelImages-&gt;setText(f);
 }
 
-void Ui_indexingDialog::setETA(const char *f)
+void Ui_indexingDialog::setETA(QString f)
 {
-   // printf(&quot;Eta:%s\n&quot;,f);
-  dialog-&gt;ui.labelTimeLeft-&gt;setText(QString::fromUtf8(f));
+  dialog-&gt;ui.labelTimeLeft-&gt;setText(f);
 }
 void Ui_indexingDialog::setPercent(float f)
 {
     dialog-&gt;ui.progressBar-&gt;setValue((int)(100.*f));
-    
 }
-
-
-
-// EOF

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/T_index_pg.h
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/T_index_pg.h	2010-06-06 22:44:56 UTC (rev 6321)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/T_index_pg.h	2010-06-06 23:04:21 UTC (rev 6322)
@@ -36,9 +36,9 @@
 	Ui_iDialog ui;
 	Ui_indexingDialog(QWidget *parent, const char *name);
 	~Ui_indexingDialog();
-	void setTime(const char *f);
-	void setImage(const char *f);
-	void setETA(const char *f);
+	void setTime(QString f);
+	void setImage(QString f);
+	void setETA(QString f);
 	void setPercent(float f);    
 };
 #endif	// T_index_pg_h

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/alert_qt4.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/alert_qt4.cpp	2010-06-06 22:44:56 UTC (rev 6321)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ADM_dialog/alert_qt4.cpp	2010-06-06 23:04:21 UTC (rev 6322)
@@ -21,10 +21,6 @@
 #include &quot;prefs.h&quot;
 #include &quot;ADM_toolkitQt.h&quot;
 
-#undef QT_TR_NOOP
-extern const char* translate(const char *__domainname, const char *__msgid);
-#define QT_TR_NOOP(x) translate(&quot;&quot;, x)
-
 static int beQuiet=0;
 extern QWidget *QuiMainWindows;
 namespace ADM_Qt4CoreUIToolkit
@@ -33,7 +29,7 @@
 void            GUI_Alert(const char *alertstring)
 {
     QMessageBox::StandardButton reply;
-              reply = QMessageBox::critical(qtLastRegisteredDialog(), QString::fromUtf8(QT_TR_NOOP(&quot;Alert&quot;)),
+              reply = QMessageBox::critical(qtLastRegisteredDialog(), QObject::tr(&quot;Alert&quot;),
                                         QString::fromUtf8(alertstring),
                                         QMessageBox::Ok );
 }
@@ -41,7 +37,7 @@
 void            GUI_Info(const char *alertstring)
 {
     QMessageBox::StandardButton reply;
-              reply = QMessageBox::information(qtLastRegisteredDialog(), QString::fromUtf8(QT_TR_NOOP(&quot;Info&quot;)),
+              reply = QMessageBox::information(qtLastRegisteredDialog(), QObject::tr(&quot;Info&quot;),
                                         QString::fromUtf8(alertstring),
                                         QMessageBox::Ok );
 }
@@ -70,7 +66,7 @@
 
 	QMessageBox::StandardButton reply;
 
-	reply = QMessageBox::information(qtLastRegisteredDialog(), QString::fromUtf8(QT_TR_NOOP(&quot;Info&quot;)),
+	reply = QMessageBox::information(qtLastRegisteredDialog(), QObject::tr(&quot;Info&quot;),
 		alertString, QMessageBox::Ok);
 }
 //****************************************************************************************************
@@ -97,7 +93,7 @@
 
 	QMessageBox::StandardButton reply;
 
-	reply = QMessageBox::critical(qtLastRegisteredDialog(), QString::fromUtf8(QT_TR_NOOP(&quot;Info&quot;)),
+	reply = QMessageBox::critical(qtLastRegisteredDialog(), QObject::tr(&quot;Info&quot;),
 		alertString, QMessageBox::Ok);
 }
 //****************************************************************************************************
@@ -121,7 +117,7 @@
 
 	QMessageBox::StandardButton reply;
 
-	reply = QMessageBox::question(qtLastRegisteredDialog(), QString::fromUtf8(QT_TR_NOOP(&quot;Confirmation&quot;)),
+	reply = QMessageBox::question(qtLastRegisteredDialog(), QObject::tr(&quot;Confirmation&quot;),
 		alertString, QMessageBox::Yes | QMessageBox::No);
 
 	if (reply == QMessageBox::Yes)
@@ -151,7 +147,7 @@
 
 	QMessageBox::StandardButton reply;
 
-	reply = QMessageBox::question(qtLastRegisteredDialog(), QString::fromUtf8(QT_TR_NOOP(&quot;Confirmation&quot;)),
+	reply = QMessageBox::question(qtLastRegisteredDialog(), QObject::tr(&quot;Confirmation&quot;),
 		alertString, QMessageBox::Yes | QMessageBox::No);
 
 	if (reply == QMessageBox::Yes)
@@ -168,7 +164,7 @@
                       printf(&quot;Question: %s\n&quot;, alertstring);
                       return 0;
               }
-          reply = QMessageBox::question(qtLastRegisteredDialog(), QString::fromUtf8(QT_TR_NOOP(&quot;Question&quot;)),
+          reply = QMessageBox::question(qtLastRegisteredDialog(), QObject::tr(&quot;Question&quot;),
                                     QString::fromUtf8(alertstring),
                                     QMessageBox::Yes | QMessageBox::No );
           if(reply==QMessageBox::Yes) return 1;
@@ -189,14 +185,14 @@
 
 	QMessageBox box(qtLastRegisteredDialog());
 
-	box.setWindowTitle(QString::fromUtf8(QT_TR_NOOP(&quot;Question ?&quot;)));
+	box.setWindowTitle(QObject::tr(&quot;Question?&quot;));
 	box.addButton(QString::fromUtf8(choice1),QMessageBox::YesRole);
 	box.addButton(QString::fromUtf8(choice2),QMessageBox::NoRole);
 
 	if (title)
 		box.setText(QString::fromUtf8(title));
 	else
-		box.setText(QString::fromUtf8(QT_TR_NOOP(&quot;Question&quot;)));
+		box.setText(QObject::tr(&quot;Question&quot;));
 
 	box.setIcon(QMessageBox::Question);
 

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ADM_filters/Q_mainfilter.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ADM_filters/Q_mainfilter.cpp	2010-06-06 22:44:56 UTC (rev 6321)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ADM_filters/Q_mainfilter.cpp	2010-06-06 23:04:21 UTC (rev 6322)
@@ -24,6 +24,7 @@
  ***************************************************************************/
 
 #include &lt;vector&gt;
+#include &lt;QtCore/QObject&gt;
 
 #include &quot;Q_mainfilter.h&quot;
 #include &quot;ADM_default.h&quot;
@@ -493,7 +494,7 @@
         conf = videofilters[itag].conf;
         if (videofilters[itag].tag == VF_PARTIAL_FILTER)	// cannot recurse
         {
-            GUI_Error_HIG (QT_TR_NOOP(&quot;The filter is already partial&quot;), NULL);
+            GUI_Error_HIG (QObject::tr(&quot;The filter is already partial&quot;).toUtf8().constData(), NULL);
             return;
         }
 
@@ -530,7 +531,7 @@
 
 	closePreview();
 
-	GUI_FileSelRead (QT_TR_NOOP(&quot;Load set of filters&quot;), filterLoadXml);
+	GUI_FileSelRead (QObject::tr(&quot;Load set of filters&quot;).toUtf8().constData(), filterLoadXml);
 
 	getFirstVideoFilter ();
 	buildActiveFilterList ();
@@ -544,10 +545,10 @@
 {
 	if (nb_active_filter &lt; 2)
 	{
-		GUI_Error_HIG (QT_TR_NOOP(&quot;Nothing to save&quot;), NULL);
+		GUI_Error_HIG (QObject::tr(&quot;Nothing to save&quot;).toUtf8().constData(), NULL);
 	}
 	else
-		GUI_FileSelWrite(QT_TR_NOOP(&quot;Save set of filters&quot;), filterSaveXml);
+		GUI_FileSelWrite(QObject::tr(&quot;Save set of filters&quot;).toUtf8().constData(), filterSaveXml);
 }
 
 /**
@@ -709,12 +710,12 @@
          uint32_t fmax=previous-&gt;getInfo()-&gt;nb_frames;
          if(fmax) fmax--;
          
-         diaElemUInteger  start(PX(_start),QT_TR_NOOP(&quot;Partial Start Frame:&quot;),0,fmax);
-         diaElemUInteger  end(PX(_end),QT_TR_NOOP(&quot;Partial End Frame:&quot;),0,fmax);
-         diaElemButton    button(QT_TR_NOOP(&quot;Configure child&quot;), partialCb,params);
+         diaElemUInteger  start(PX(_start),QObject::tr(&quot;Partial Start Frame:&quot;).toUtf8().constData(),0,fmax);
+         diaElemUInteger  end(PX(_end),QObject::tr(&quot;Partial End Frame:&quot;).toUtf8().constData(),0,fmax);
+         diaElemButton    button(QObject::tr(&quot;Configure child&quot;).toUtf8().constData(), partialCb,params);
          
          diaElem *tabs[]={&amp;start,&amp;end,&amp;button};
-        return diaFactoryRun(QT_TR_NOOP(&quot;Partial Video Filter&quot;),3,tabs);
+        return diaFactoryRun(QObject::tr(&quot;Partial Video Filter&quot;).toUtf8().constData(),3,tabs);
 }
 
 /**

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/Q_gui2.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/Q_gui2.cpp	2010-06-06 22:44:56 UTC (rev 6321)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ADM_gui/Q_gui2.cpp	2010-06-06 23:04:21 UTC (rev 6322)
@@ -12,6 +12,7 @@
  *                                                                         *
  ***************************************************************************/
 #include &quot;config.h&quot;
+#undef QT_TR_NOOP
 
 #include &lt;QtCore/QUrl&gt;
 #include &lt;QtCore/QDir&gt;
@@ -381,11 +382,11 @@
 */
 void MainWindow::buttonPressed(void)
 {
-	// Receveid a key press Event, look into table..
-    QObject *obj=sender();
-    if(!obj) return;
-    QString me(obj-&gt;objectName());
-    Action action=searchTranslationTable(qPrintable(me));
+	// Receveid a key press Event, look into table..
+    QObject *obj=sender();
+    if(!obj) return;
+    QString me(obj-&gt;objectName());
+    Action action=searchTranslationTable(qPrintable(me));
 
 	if(action!=ACT_DUMMY)
 		HandleAction (action);
@@ -1013,9 +1014,8 @@
 	default:c='?';break;
 
 	}
-	sprintf(string,QT_TR_NOOP(&quot;%c (%02d)&quot;),c,qp);
-	WIDGET(label_8)-&gt;setText(QString::fromUtf8(string));
 
+	WIDGET(label_8)-&gt;setText(MainWindow::tr(&quot;%1 (%2)&quot;).arg(c).arg(qp, 2, 10, QLatin1Char('0')));
 }
 
 /**

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ADM_ocr/Q_glypheditor.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ADM_ocr/Q_glypheditor.cpp	2010-06-06 22:44:56 UTC (rev 6321)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ADM_ocr/Q_glypheditor.cpp	2010-06-06 23:04:21 UTC (rev 6322)
@@ -148,7 +148,7 @@
 			} 
 		}
 
-		GUI_Error_HIG(QT_TR_NOOP(&quot;Head reached&quot;), QT_TR_NOOP(&quot;No more glyphs&quot;));
+		GUI_Error_HIG(GlyphEditorWindow::tr(&quot;Head reached&quot;).toUtf8().constData(), GlyphEditorWindow::tr(&quot;No more glyphs&quot;).toUtf8().constData());
 		break;
 	}
 }
@@ -167,7 +167,7 @@
 		}
 		else 
 		{
-			GUI_Error_HIG(QT_TR_NOOP(&quot;End reached&quot;), QT_TR_NOOP(&quot;No more glyphs&quot;));
+			GUI_Error_HIG(GlyphEditorWindow::tr(&quot;End reached&quot;).toUtf8().constData(), GlyphEditorWindow::tr(&quot;No more glyphs&quot;).toUtf8().constData());
 			break;
 		}
 	}
@@ -182,10 +182,10 @@
 void GlyphEditorWindow::findButton_clicked(bool checked)
 {
 	char *tomatch = NULL;
-	diaElemText txt(&amp;tomatch, QT_TR_NOOP(&quot;String&quot;), NULL);
+	diaElemText txt(&amp;tomatch, GlyphEditorWindow::tr(&quot;String&quot;).toUtf8().constData(), NULL);
 	diaElem *elems[] = {&amp;txt};
 
-	if (!diaFactoryRun(QT_TR_NOOP(&quot;Search string&quot;), 1, elems))
+	if (!diaFactoryRun(GlyphEditorWindow::tr(&quot;Search string&quot;).toUtf8().constData(), 1, elems))
 		return;
 
 	printf(&quot;Searched string &lt;%s&gt;\n&quot;, tomatch);
@@ -209,7 +209,7 @@
 	delete [] tomatch;
 
 	if (!currentGlyph-&gt;next)
-		GUI_Error_HIG(QT_TR_NOOP(&quot;End reached&quot;), QT_TR_NOOP(&quot;No more glyphs&quot;));
+		GUI_Error_HIG(GlyphEditorWindow::tr(&quot;End reached&quot;).toUtf8().constData(), GlyphEditorWindow::tr(&quot;No more glyphs&quot;).toUtf8().constData());
 }
 
 void GlyphEditorWindow::deleteButton_clicked(bool checked)
@@ -245,7 +245,7 @@
 	uint8_t ret = 0;
 
 	// First select a file
-	GUI_FileSelRead(QT_TR_NOOP(&quot;Select GlyphFile to edit&quot;), &amp;glyphName);
+	GUI_FileSelRead(GlyphEditorWindow::tr(&quot;Select GlyphFile to edit&quot;).toUtf8().constData(), &amp;glyphName);
 
 	if (!glyphName)
 		return 0;

Modified: branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ui_support.cpp
===================================================================
--- branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ui_support.cpp	2010-06-06 22:44:56 UTC (rev 6321)
+++ branches/avidemux_2.5_branch_gruntster/avidemux/ADM_userInterfaces/ADM_QT4/ui_support.cpp	2010-06-06 23:04:21 UTC (rev 6322)
@@ -153,21 +153,21 @@
 	switch (paintEngineType)
 	{
 		case QPaintEngine::X11:
-			return QT_TR_NOOP(&quot;Qt (X11)&quot;);
+			return &quot;Qt (X11)&quot;;
 		case QPaintEngine::Windows:
-			return QT_TR_NOOP(&quot;Qt (MS Windows GDI)&quot;);
+			return &quot;Qt (MS Windows GDI)&quot;;
 		case QPaintEngine::CoreGraphics:
-			return QT_TR_NOOP(&quot;Qt (Mac OS X Quartz 2D)&quot;);
+			return &quot;Qt (Mac OS X Quartz 2D)&quot;;
 		case QPaintEngine::QuickDraw:
-			return QT_TR_NOOP(&quot;Qt (Mac OS X QuickDraw)&quot;);
+			return &quot;Qt (Mac OS X QuickDraw)&quot;;
 		case QPaintEngine::OpenGL:
-			return QT_TR_NOOP(&quot;Qt (OpenGL)&quot;);
+			return &quot;Qt (OpenGL)&quot;;
 #if QT_VERSION &gt;= 0x040400
 		case QPaintEngine::Direct3D:
-			return QT_TR_NOOP(&quot;Qt (MS Windows Direct3D)&quot;);
+			return &quot;Qt (MS Windows Direct3D)&quot;;
 #endif
 		case QPaintEngine::Raster:
-			return QT_TR_NOOP(&quot;Qt (Default Raster)&quot;);
+			return &quot;Qt&quot;;
 	}
 
 	return &quot;Qt&quot;;


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="003514.html">[Avidemux-svn-commit] r6321 -	branches/avidemux_2.5_branch_gruntster/avidemux/ADM_osSupport
</A></li>
	<LI>Next message: <A HREF="003516.html">[Avidemux-svn-commit] r6323 - in	branches/avidemux_2.5_branch_gruntster/plugins:	ADM_videoEncoder/ADM_vidEnc_x264/qt4	ADM_videoEncoder/ADM_vidEnc_xvid/qt4	ADM_videoFilters/AvisynthResize/qt4	ADM_videoFilters/MplayerResize/qt4
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#3515">[ date ]</a>
              <a href="thread.html#3515">[ thread ]</a>
              <a href="subject.html#3515">[ subject ]</a>
              <a href="author.html#3515">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/avidemux-svn-commit">More information about the Avidemux-svn-commit
mailing list</a><br>
</body></html>
