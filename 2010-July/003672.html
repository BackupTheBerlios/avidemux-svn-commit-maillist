<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Avidemux-svn-commit] r6485 - in	branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches:	. avcodec
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/avidemux-svn-commit/2010-July/index.html" >
   <LINK REL="made" HREF="mailto:avidemux-svn-commit%40lists.berlios.de?Subject=Re%3A%20%5BAvidemux-svn-commit%5D%20r6485%20-%20in%0A%09branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches%3A%0A%09.%20avcodec&In-Reply-To=%3C20100725100757.26AF5480E6C%40sheep.berlios.de%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="003671.html">
   <LINK REL="Next"  HREF="003673.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Avidemux-svn-commit] r6485 - in	branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches:	. avcodec</H1>
    <B>mean at mail.berlios.de</B> 
    <A HREF="mailto:avidemux-svn-commit%40lists.berlios.de?Subject=Re%3A%20%5BAvidemux-svn-commit%5D%20r6485%20-%20in%0A%09branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches%3A%0A%09.%20avcodec&In-Reply-To=%3C20100725100757.26AF5480E6C%40sheep.berlios.de%3E"
       TITLE="[Avidemux-svn-commit] r6485 - in	branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches:	. avcodec">mean at mail.berlios.de
       </A><BR>
    <I>Sun Jul 25 12:07:57 CEST 2010</I>
    <P><UL>
        <LI>Previous message: <A HREF="003671.html">[Avidemux-svn-commit] r6484 -	branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavformat
</A></li>
        <LI>Next message: <A HREF="003673.html">[Avidemux-svn-commit] r6486 -	branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_audioDecoders/ADM_ad_ima_adpcm
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#3672">[ date ]</a>
              <a href="thread.html#3672">[ thread ]</a>
              <a href="subject.html#3672">[ subject ]</a>
              <a href="author.html#3672">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Author: mean
Date: 2010-07-25 12:07:56 +0200 (Sun, 25 Jul 2010)
New Revision: 6485

Removed:
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/avcodec/avcodec.h
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavcodec_avcodec.h.patch
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavcodec_eac3_patch.patch
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavcodec_fft.c.patch
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavcodec_ffv1.c.patch
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavcodec_h263dec.c.patch
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavcodec_h264.c.patch
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavcodec_h264dsp.c.patch
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavcodec_mpeg12.c.patch
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavcodec_mpeg12enc.c.patch
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavcodec_mpegvideo.c.patch
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavcodec_mpegvideo_enc.c.patch
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavcodec_png.patch
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavcodec_pngdec.c.patch
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavcodec_pngenc.c.patch
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavcodec_utils.c.patch
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavcodec_x86_mathops.h
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavformat_file.c.patch
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavformat_flvenc.c.patch
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavformat_isom.c.patch
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavformat_matroskaenc.c.patch
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavformat_movenc.c.patch
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavformat_mpegenc.c.patch
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavformat_mpegtsenc.c.patch
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavformat_utils.c.patch
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavutil_avutil.h.patch
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavutil_bswap.h.patch
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavutil_internal.h.patch
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavutil_intreadwrite.h.patch
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavutil_lfg.h
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavutil_libm.h.patch
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavutil_mem.c.patch
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavutil_timer.h.patch
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavutil_x86_bswap.h
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavutil_x86_intreadwrite.h
   branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/swscale_c.patch
Log:
[ffmpeg] cleanup

Deleted: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/avcodec/avcodec.h
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/avcodec/avcodec.h	2010-07-25 10:07:55 UTC (rev 6484)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/avcodec/avcodec.h	2010-07-25 10:07:56 UTC (rev 6485)
@@ -1,30 +0,0 @@
-diff --git a/avidemux_core/ADM_ffmpeg/libavcodec/avcodec.h b/avidemux_core/ADM_ffmpeg/libavcodec/avcodec.h
-index 14e049d..78e39a5 100644
---- a/avidemux_core/ADM_ffmpeg/libavcodec/avcodec.h
-+++ b/avidemux_core/ADM_ffmpeg/libavcodec/avcodec.h
-@@ -614,6 +614,8 @@ typedef struct RcOverride{
- #define CODEC_FLAG2_PSY           0x00080000 ///&lt; Use psycho visual optimizations.
- #define CODEC_FLAG2_SSIM          0x00100000 ///&lt; Compute SSIM during encoding, error[] values are undefined.
- #define CODEC_FLAG2_INTRA_REFRESH 0x00200000 ///&lt; Use periodic insertion of intra blocks instead of keyframes.
-+//MEANX: NEVER EVER USE CLOSED GOP ?
-+#define CODEC_FLAG2_32_PULLDOWN   0x80000000 
- 
- /* Unsupported options :
-  *              Syntax Arithmetic coding (SAC)
-@@ -1496,6 +1498,7 @@ typedef struct AVCodecContext {
-      * - decoding: unused
-      */
-     int rc_max_rate;
-+    int rc_max_rate_header; /*&lt; That one is set in the header MEANX */
- 
-     /**
-      * minimum bitrate
-@@ -1510,6 +1513,8 @@ typedef struct AVCodecContext {
-      * - decoding: unused
-      */
-     int rc_buffer_size;
-+    int rc_buffer_size_header;  /*&lt; That one is set in the header MEANX*/
-+
-     float rc_buffer_aggressivity;
- 
-     /**

Deleted: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavcodec_avcodec.h.patch
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavcodec_avcodec.h.patch	2010-07-25 10:07:55 UTC (rev 6484)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavcodec_avcodec.h.patch	2010-07-25 10:07:56 UTC (rev 6485)
@@ -1,30 +0,0 @@
-diff --git a/avidemux_core/ADM_ffmpeg/libavcodec/avcodec.h b/avidemux_core/ADM_ffmpeg/libavcodec/avcodec.h
-index cd642ac..c90eac7 100644
---- a/avidemux_core/ADM_ffmpeg/libavcodec/avcodec.h
-+++ b/avidemux_core/ADM_ffmpeg/libavcodec/avcodec.h
-@@ -599,6 +599,8 @@ typedef struct RcOverride{
- #define CODEC_FLAG2_PSY           0x00080000 ///&lt; Use psycho visual optimizations.
- #define CODEC_FLAG2_SSIM          0x00100000 ///&lt; Compute SSIM during encoding, error[] values are undefined.
- #define CODEC_FLAG2_INTRA_REFRESH 0x00200000 ///&lt; Use periodic insertion of intra blocks instead of keyframes.
-+//MEANX: NEVER EVER USE CLOSED GOP ?
-+#define CODEC_FLAG2_32_PULLDOWN   0x80000000 
- 
- /* Unsupported options :
-  *              Syntax Arithmetic coding (SAC)
-@@ -1469,6 +1471,7 @@ typedef struct AVCodecContext {
-      * - decoding: unused
-      */
-     int rc_max_rate;
-+    int rc_max_rate_header; /*&lt; That one is set in the header MEANX */
- 
-     /**
-      * minimum bitrate
-@@ -1483,6 +1486,8 @@ typedef struct AVCodecContext {
-      * - decoding: unused
-      */
-     int rc_buffer_size;
-+    int rc_buffer_size_header;  /*&lt; That one is set in the header MEANX*/
-+
-     float rc_buffer_aggressivity;
- 
-     /**

Deleted: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavcodec_eac3_patch.patch
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavcodec_eac3_patch.patch	2010-07-25 10:07:55 UTC (rev 6484)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavcodec_eac3_patch.patch	2010-07-25 10:07:56 UTC (rev 6485)
@@ -1,426 +0,0 @@
-diff --git a/avidemux_core/ADM_ffmpeg/libavcodec/ac3dec.c b/avidemux_core/ADM_ffmpeg/libavcodec/ac3dec.c
-index f2cadf0..61b857c 100644
---- a/avidemux_core/ADM_ffmpeg/libavcodec/ac3dec.c
-+++ b/avidemux_core/ADM_ffmpeg/libavcodec/ac3dec.c
-@@ -812,14 +812,100 @@ static int decode_audio_block(AC3DecodeContext *s, int blk)
- 
-     /* spectral extension strategy */
-     if (s-&gt;eac3 &amp;&amp; (!blk || get_bits1(gbc))) {
--        if (get_bits1(gbc)) {
--            av_log_missing_feature(s-&gt;avctx, &quot;Spectral extension&quot;, 1);
--            return -1;
-+        s-&gt;spx_in_use = get_bits1(gbc);
-+        if (s-&gt;spx_in_use) {
-+            int begf, endf;
-+            int spx_end_subband;
-+
-+            /* determine which channels use spx */
-+            if (s-&gt;channel_mode == AC3_CHMODE_MONO) {
-+                s-&gt;channel_in_spx[1] = 1;
-+            } else {
-+                for (ch = 1; ch &lt;= fbw_channels; ch++)
-+                    s-&gt;channel_in_spx[ch] = get_bits1(gbc);
-+            }
-+
-+            s-&gt;spx_copy_start_freq = get_bits(gbc, 2) * 12 + 25;
-+            begf = get_bits(gbc, 3);
-+            endf = get_bits(gbc, 3);
-+            s-&gt;spx_start_subband = begf &lt; 6 ? begf+2 : 2*begf-3;
-+            spx_end_subband      = endf &lt; 4 ? endf+5 : 2*endf+3;
-+            if (s-&gt;spx_start_subband &gt;= spx_end_subband) {
-+                av_log(s-&gt;avctx, AV_LOG_ERROR, &quot;invalid spectral extension range (%d &gt;= %d)\n&quot;,
-+                       s-&gt;spx_start_subband, spx_end_subband);
-+                return -1;
-+            }
-+            s-&gt;spx_start_freq    = s-&gt;spx_start_subband * 12 + 25;
-+            s-&gt;spx_end_freq      = spx_end_subband      * 12 + 25;
-+            if (s-&gt;spx_copy_start_freq &gt;= s-&gt;spx_start_freq) {
-+                av_log(s-&gt;avctx, AV_LOG_ERROR, &quot;invalid spectral extension copy start bin (%d &gt;= %d)\n&quot;,
-+                       s-&gt;spx_copy_start_freq, s-&gt;spx_start_freq);
-+                return -1;
-+            }
-+/*
-+  decode_band_structure(gbc, blk, s-&gt;eac3, 0, cpl_start_subband,
-+                                  cpl_end_subband,
-+                                  ff_eac3_default_cpl_band_struct,
-+                                  &amp;s-&gt;num_cpl_bands, s-&gt;cpl_band_sizes);
-+*/
-+            decode_band_structure(gbc, blk, s-&gt;eac3, 0,
-+                                  s-&gt;spx_start_subband, spx_end_subband,
-+                                  ff_eac3_default_spx_band_struct,
-+                                  /*s-&gt;spx_band_struct,*/ &amp;s-&gt;num_spx_bands,
-+                                  s-&gt;spx_band_sizes);
-+        } else {
-+            for (ch = 1; ch &lt;= fbw_channels; ch++) {
-+                s-&gt;channel_in_spx[ch] = 0;
-+                s-&gt;first_spx_coords[ch] = 1;
-+            }
-         }
--        /* TODO: parse spectral extension strategy info */
-     }
- 
--    /* TODO: spectral extension coordinates */
-+    /* spectral extension coordinates */
-+    if (s-&gt;spx_in_use) {
-+        for (ch = 1; ch &lt;= fbw_channels; ch++) {
-+            if (s-&gt;channel_in_spx[ch]) {
-+                if (s-&gt;first_spx_coords[ch] || get_bits1(gbc)) {
-+                    int bin;
-+                    float spx_blend;
-+                    int master_spx_coord;
-+                    s-&gt;first_spx_coords[ch] = 0;
-+                    spx_blend = get_bits(gbc, 5) / 32.0f;
-+                    master_spx_coord = get_bits(gbc, 2) * 3;
-+                    bin = s-&gt;spx_start_freq;
-+                    for (bnd = 0; bnd &lt; s-&gt;num_spx_bands; bnd++) {
-+                        int bandsize;
-+                        int spx_coord_exp, spx_coord_mant;
-+                        float nratio, sblend, nblend, spx_coord;
-+
-+                        /* calculate blending factors */
-+                        bandsize = s-&gt;spx_band_sizes[bnd];
-+                        nratio = ((float)((bin + (bandsize &gt;&gt; 1))) / s-&gt;spx_end_freq) - spx_blend;
-+                        nratio = av_clipf(nratio, 0.0f, 1.0f);
-+                        nblend = sqrt(       nratio);
-+                        sblend = sqrt(1.0f - nratio);
-+                        nblend *= 1.73205077648f; // scale noise to give unity variance
-+                        bin += bandsize;
-+
-+                        /* decode spx coordinates */
-+                        spx_coord_exp  = get_bits(gbc, 4);
-+                        spx_coord_mant = get_bits(gbc, 2);
-+                        if (spx_coord_exp == 15)
-+                            spx_coord = spx_coord_mant / 4.0f;
-+                        else
-+                            spx_coord = (spx_coord_mant + 4) / 8.0f;
-+                        spx_coord /= (float)(1 &lt;&lt; (spx_coord_exp + master_spx_coord));
-+
-+                        /* multiply noise and signal blending factors by spx coordinate */
-+                        s-&gt;spx_noise_blend [ch][bnd] = nblend * spx_coord * 32.0f;
-+                        s-&gt;spx_signal_blend[ch][bnd] = sblend * spx_coord * 32.0f;
-+                    }
-+                }
-+            } else {
-+                s-&gt;first_spx_coords[ch] = 1;
-+            }
-+        }
-+    }
- 
-     /* coupling strategy */
-     if (s-&gt;eac3 ? s-&gt;cpl_strategy_exists[blk] : get_bits1(gbc)) {
-@@ -856,9 +942,9 @@ static int decode_audio_block(AC3DecodeContext *s, int blk)
-                 s-&gt;phase_flags_in_use = get_bits1(gbc);
- 
-             /* coupling frequency range */
--            /* TODO: modify coupling end freq if spectral extension is used */
-             cpl_start_subband = get_bits(gbc, 4);
--            cpl_end_subband   = get_bits(gbc, 4) + 3;
-+            cpl_end_subband = s-&gt;spx_in_use ? s-&gt;spx_start_subband - 1 :
-+                                              get_bits(gbc, 4) + 3;
-             if (cpl_start_subband &gt;= cpl_end_subband) {
-                 av_log(s-&gt;avctx, AV_LOG_ERROR, &quot;invalid coupling range (%d &gt;= %d)\n&quot;,
-                        cpl_start_subband, cpl_end_subband);
-@@ -931,8 +1017,11 @@ static int decode_audio_block(AC3DecodeContext *s, int blk)
-     if (channel_mode == AC3_CHMODE_STEREO) {
-         if ((s-&gt;eac3 &amp;&amp; !blk) || get_bits1(gbc)) {
-             s-&gt;num_rematrixing_bands = 4;
--            if(cpl_in_use &amp;&amp; s-&gt;start_freq[CPL_CH] &lt;= 61)
-+            if (cpl_in_use &amp;&amp; s-&gt;start_freq[CPL_CH] &lt;= 61) {
-                 s-&gt;num_rematrixing_bands -= 1 + (s-&gt;start_freq[CPL_CH] == 37);
-+            } else if (s-&gt;spx_in_use &amp;&amp; s-&gt;spx_start_freq &lt;= 61) {
-+                s-&gt;num_rematrixing_bands -= 1;
-+            }
-             for(bnd=0; bnd&lt;s-&gt;num_rematrixing_bands; bnd++)
-                 s-&gt;rematrixing_flags[bnd] = get_bits1(gbc);
-         } else if (!blk) {
-@@ -957,6 +1046,8 @@ static int decode_audio_block(AC3DecodeContext *s, int blk)
-             int prev = s-&gt;end_freq[ch];
-             if (s-&gt;channel_in_cpl[ch])
-                 s-&gt;end_freq[ch] = s-&gt;start_freq[CPL_CH];
-+            else if (s-&gt;channel_in_spx[ch])
-+                s-&gt;end_freq[ch] = s-&gt;spx_start_freq;
-             else {
-                 int bandwidth_code = get_bits(gbc, 6);
-                 if (bandwidth_code &gt; 60) {
-@@ -1153,8 +1244,6 @@ static int decode_audio_block(AC3DecodeContext *s, int blk)
- 
-     /* TODO: generate enhanced coupling coordinates and uncouple */
- 
--    /* TODO: apply spectral extension */
--
-     /* recover coefficients if rematrixing is in use */
-     if(s-&gt;channel_mode == AC3_CHMODE_STEREO)
-         do_rematrixing(s);
-@@ -1170,6 +1259,10 @@ static int decode_audio_block(AC3DecodeContext *s, int blk)
-         s-&gt;dsp.int32_to_float_fmul_scalar(s-&gt;transform_coeffs[ch], s-&gt;fixed_coeffs[ch], gain, 256);
-     }
- 
-+    /* apply spectral extension to high frequency bins */
-+    if (s-&gt;spx_in_use)
-+        ff_eac3_apply_spectral_extension(s);
-+
-     /* downmix and MDCT. order depends on whether block switching is used for
-        any channel in this block. this is because coefficients for the long
-        and short transforms cannot be mixed. */
-@@ -1211,8 +1304,8 @@ static int decode_audio_block(AC3DecodeContext *s, int blk)
- static int ac3_decode_frame(AVCodecContext * avctx, void *data, int *data_size,
-                             AVPacket *avpkt)
- {
--    const uint8_t *buf = avpkt-&gt;data;
--    int buf_size = avpkt-&gt;size;
-+    const uint8_t *buf=avpkt-&gt;data;
-+    int buf_size=avpkt-&gt;size;
-     AC3DecodeContext *s = avctx-&gt;priv_data;
-     int16_t *out_samples = (int16_t *)data;
-     int blk, ch, err;
-diff --git a/avidemux_core/ADM_ffmpeg/libavcodec/ac3dec.h b/avidemux_core/ADM_ffmpeg/libavcodec/ac3dec.h
-index 52eb0ef..4cffbb5 100644
---- a/avidemux_core/ADM_ffmpeg/libavcodec/ac3dec.h
-+++ b/avidemux_core/ADM_ffmpeg/libavcodec/ac3dec.h
-@@ -42,6 +42,7 @@
- #define AC3_MAX_COEFS   256
- #define AC3_BLOCK_SIZE  256
- #define MAX_BLOCKS        6
-+#define SPX_MAX_BANDS    17
- 
- typedef struct {
-     AVCodecContext *avctx;                  ///&lt; parent context
-@@ -88,6 +89,23 @@ typedef struct {
-     int cpl_coords[AC3_MAX_CHANNELS][18];   ///&lt; coupling coordinates                   (cplco)
- ///@}
- 
-+///@defgroup spx spectral extension
-+///@{
-+    int spx_in_use;                             ///&lt; spectral extension in use              (spxinu)
-+    uint8_t channel_in_spx[AC3_MAX_CHANNELS];   ///&lt; channel in spectral extension          (chinspx)
-+    int8_t spx_atten_code[AC3_MAX_CHANNELS];    ///&lt; spx attenuation code                   (spxattencod)
-+    int spx_start_subband;                      ///&lt; spx beginning frequency band           (spxbegf)
-+    int spx_start_freq;                         ///&lt; spx start frequency bin
-+    int spx_end_freq;                           ///&lt; spx end frequency bin
-+    int spx_copy_start_freq;                    ///&lt; spx starting frequency for copying     (copystartmant)
-+    int num_spx_bands;                          ///&lt; number of spx bands                    (nspxbnds)
-+    uint8_t spx_band_struct[SPX_MAX_BANDS];     ///&lt; spectral extension band structure      (spxbndstrc)
-+    uint8_t spx_band_sizes[SPX_MAX_BANDS];      ///&lt; number of bins in each band            (spxbndsztab)
-+    uint8_t first_spx_coords[AC3_MAX_CHANNELS]; ///&lt; first spx coordinates states           (firstspxcos)
-+    float spx_noise_blend[AC3_MAX_CHANNELS][SPX_MAX_BANDS]; ///&lt; spx noise blending factor  (nblendfact)
-+    float spx_signal_blend[AC3_MAX_CHANNELS][SPX_MAX_BANDS];///&lt; spx signal blending factor (sblendfact)
-+///@}
-+
- ///@defgroup aht adaptive hybrid transform
-     int channel_uses_aht[AC3_MAX_CHANNELS];                         ///&lt; channel AHT in use (chahtinu)
-     int pre_mantissa[AC3_MAX_CHANNELS][AC3_MAX_COEFS][MAX_BLOCKS];  ///&lt; pre-IDCT mantissas
-@@ -178,4 +196,11 @@ int ff_eac3_parse_header(AC3DecodeContext *s);
-  */
- void ff_eac3_decode_transform_coeffs_aht_ch(AC3DecodeContext *s, int ch);
- 
-+/**
-+ * Apply spectral extension to each channel by copying lower frequency
-+ * coefficients to higher frequency bins and applying side information to
-+ * approximate the original high frequency signal.
-+ */
-+void ff_eac3_apply_spectral_extension(AC3DecodeContext *s);
-+
- #endif /* AVCODEC_AC3DEC_H */
-diff --git a/avidemux_core/ADM_ffmpeg/libavcodec/ac3dec_data.c b/avidemux_core/ADM_ffmpeg/libavcodec/ac3dec_data.c
-index 907a3ae..57bed8d 100644
---- a/avidemux_core/ADM_ffmpeg/libavcodec/ac3dec_data.c
-+++ b/avidemux_core/ADM_ffmpeg/libavcodec/ac3dec_data.c
-@@ -64,3 +64,48 @@ const uint8_t ff_eac3_hebap_tab[64] = {
-  */
- const uint8_t ff_eac3_default_cpl_band_struct[18] =
- { 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 1, 1, 0, 1, 1, 1, 1, 1 };
-+
-+/**
-+ * Table E2.15 Default Spectral Extension Banding Structure
-+ */
-+const uint8_t ff_eac3_default_spx_band_struct[17] =
-+{ 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1 };
-+
-+/**
-+ * Table E.25: Spectral Extension Attenuation Table
-+ * ff_eac3_spx_atten_tab[code][bin]=pow(2.0,(bin+1)*(code+1)/-15.0);
-+ */
-+const float ff_eac3_spx_atten_tab[32][3] = {
-+    { 0.954841603910416503f, 0.911722488558216804f, 0.870550563296124125f },
-+    { 0.911722488558216804f, 0.831237896142787758f, 0.757858283255198995f },
-+    { 0.870550563296124125f, 0.757858283255198995f, 0.659753955386447100f },
-+    { 0.831237896142787758f, 0.690956439983888004f, 0.574349177498517438f },
-+    { 0.793700525984099792f, 0.629960524947436595f, 0.500000000000000000f },
-+    { 0.757858283255198995f, 0.574349177498517438f, 0.435275281648062062f },
-+    { 0.723634618720189082f, 0.523647061410313364f, 0.378929141627599553f },
-+    { 0.690956439983888004f, 0.477420801955208307f, 0.329876977693223550f },
-+    { 0.659753955386447100f, 0.435275281648062062f, 0.287174588749258719f },
-+    { 0.629960524947436595f, 0.396850262992049896f, 0.250000000000000000f },
-+    { 0.601512518041058319f, 0.361817309360094541f, 0.217637640824031003f },
-+    { 0.574349177498517438f, 0.329876977693223550f, 0.189464570813799776f },
-+    { 0.548412489847312945f, 0.300756259020529160f, 0.164938488846611775f },
-+    { 0.523647061410313364f, 0.274206244923656473f, 0.143587294374629387f },
-+    { 0.500000000000000000f, 0.250000000000000000f, 0.125000000000000000f },
-+    { 0.477420801955208307f, 0.227930622139554201f, 0.108818820412015502f },
-+    { 0.455861244279108402f, 0.207809474035696939f, 0.094732285406899888f },
-+    { 0.435275281648062062f, 0.189464570813799776f, 0.082469244423305887f },
-+    { 0.415618948071393879f, 0.172739109995972029f, 0.071793647187314694f },
-+    { 0.396850262992049896f, 0.157490131236859149f, 0.062500000000000000f },
-+    { 0.378929141627599553f, 0.143587294374629387f, 0.054409410206007751f },
-+    { 0.361817309360094541f, 0.130911765352578369f, 0.047366142703449930f },
-+    { 0.345478219991944002f, 0.119355200488802049f, 0.041234622211652958f },
-+    { 0.329876977693223550f, 0.108818820412015502f, 0.035896823593657347f },
-+    { 0.314980262473718298f, 0.099212565748012460f, 0.031250000000000000f },
-+    { 0.300756259020529160f, 0.090454327340023621f, 0.027204705103003875f },
-+    { 0.287174588749258719f, 0.082469244423305887f, 0.023683071351724965f },
-+    { 0.274206244923656473f, 0.075189064755132290f, 0.020617311105826479f },
-+    { 0.261823530705156682f, 0.068551561230914118f, 0.017948411796828673f },
-+    { 0.250000000000000000f, 0.062500000000000000f, 0.015625000000000000f },
-+    { 0.238710400977604098f, 0.056982655534888536f, 0.013602352551501938f },
-+    { 0.227930622139554201f, 0.051952368508924235f, 0.011841535675862483f }
-+};
-diff --git a/avidemux_core/ADM_ffmpeg/libavcodec/ac3dec_data.h b/avidemux_core/ADM_ffmpeg/libavcodec/ac3dec_data.h
-index 8d9db05..877ea0b 100644
---- a/avidemux_core/ADM_ffmpeg/libavcodec/ac3dec_data.h
-+++ b/avidemux_core/ADM_ffmpeg/libavcodec/ac3dec_data.h
-@@ -29,5 +29,7 @@ extern const uint8_t ff_ac3_rematrix_band_tab[5];
- 
- extern const uint8_t ff_eac3_hebap_tab[64];
- extern const uint8_t ff_eac3_default_cpl_band_struct[18];
-+extern const uint8_t ff_eac3_default_spx_band_struct[17];
-+extern const float   ff_eac3_spx_atten_tab[32][3];
- 
- #endif /* AVCODEC_AC3DEC_DATA_H */
-diff --git a/avidemux_core/ADM_ffmpeg/libavcodec/eac3dec.c b/avidemux_core/ADM_ffmpeg/libavcodec/eac3dec.c
-index 3784ccf..79f3c3b 100644
---- a/avidemux_core/ADM_ffmpeg/libavcodec/eac3dec.c
-+++ b/avidemux_core/ADM_ffmpeg/libavcodec/eac3dec.c
-@@ -23,10 +23,6 @@
- /*
-  * There are several features of E-AC-3 that this decoder does not yet support.
-  *
-- * Spectral Extension
-- *     There is a patch to get this working for the two samples we have that
-- *     use it, but it needs some minor changes in order to be accepted.
-- *
-  * Enhanced Coupling
-  *     No known samples exist.  If any ever surface, this feature should not be
-  *     too difficult to implement.
-@@ -67,6 +63,95 @@ typedef enum {
- 
- #define EAC3_SR_CODE_REDUCED  3
- 
-+void ff_eac3_apply_spectral_extension(AC3DecodeContext *s)
-+{
-+    int bin, bnd, ch, i;
-+    uint8_t wrapflag[SPX_MAX_BANDS]={0,}, num_copy_sections, copy_sizes[SPX_MAX_BANDS];
-+    float rms_energy[SPX_MAX_BANDS];
-+
-+    /* Set copy index mapping table. Set wrap flags to apply a notch filter at
-+       wrap points later on. */
-+    wrapflag[0] = 1;
-+    bin = s-&gt;spx_copy_start_freq;
-+    num_copy_sections = 0;
-+    for (bnd = 0; bnd &lt; s-&gt;num_spx_bands; bnd++) {
-+        int copysize;
-+        int bandsize = s-&gt;spx_band_sizes[bnd];
-+        if ((bin + bandsize) &gt; s-&gt;spx_start_freq) {
-+            copy_sizes[num_copy_sections++] = bin - s-&gt;spx_copy_start_freq;
-+            bin = s-&gt;spx_copy_start_freq;
-+            wrapflag[bnd] = 1;
-+        }
-+        for (i = 0; i &lt; bandsize; i += copysize) {
-+            if (bin == s-&gt;spx_start_freq) {
-+                copy_sizes[num_copy_sections++] = bin - s-&gt;spx_copy_start_freq;
-+                bin = s-&gt;spx_copy_start_freq;
-+            }
-+            copysize = FFMIN(bandsize - i, s-&gt;spx_start_freq - bin);
-+            bin += copysize;
-+        }
-+    }
-+    copy_sizes[num_copy_sections++] = bin - s-&gt;spx_copy_start_freq;
-+
-+    for (ch = 1; ch &lt;= s-&gt;fbw_channels; ch++) {
-+        if (!s-&gt;channel_in_spx[ch])
-+            continue;
-+
-+        /* Copy coeffs from normal bands to extension bands */
-+        bin = s-&gt;spx_start_freq;
-+        for (i = 0; i &lt; num_copy_sections; i++) {
-+            memcpy(&amp;s-&gt;transform_coeffs[ch][bin],
-+                   &amp;s-&gt;transform_coeffs[ch][s-&gt;spx_copy_start_freq],
-+                   copy_sizes[i]*sizeof(float));
-+            bin += copy_sizes[i];
-+        }
-+
-+        /* Calculate RMS energy for each SPX band. */
-+        bin = s-&gt;spx_start_freq;
-+        for (bnd = 0; bnd &lt; s-&gt;num_spx_bands; bnd++) {
-+            int bandsize = s-&gt;spx_band_sizes[bnd];
-+            float accum = 0.0f;
-+            for (i = 0; i &lt; bandsize; i++) {
-+                float coeff = s-&gt;transform_coeffs[ch][bin++];
-+                accum += coeff * coeff;
-+            }
-+            rms_energy[bnd] = sqrt(accum / (float)bandsize);
-+        }
-+
-+        /* Apply a notch filter at transitions between normal and extension
-+           bands and at all wrap points. */
-+        if (s-&gt;spx_atten_code[ch] &gt;= 0) {
-+            const float *atten_tab = ff_eac3_spx_atten_tab[s-&gt;spx_atten_code[ch]];
-+            bin = s-&gt;spx_start_freq - 2;
-+            for (bnd = 0; bnd &lt; s-&gt;num_spx_bands; bnd++) {
-+                if (wrapflag[bnd]) {
-+                    float *coeffs = &amp;s-&gt;transform_coeffs[ch][bin];
-+                    coeffs[0] *= atten_tab[0];
-+                    coeffs[1] *= atten_tab[1];
-+                    coeffs[2] *= atten_tab[2];
-+                    coeffs[3] *= atten_tab[1];
-+                    coeffs[4] *= atten_tab[0];
-+                }
-+                bin += s-&gt;spx_band_sizes[bnd];
-+            }
-+        }
-+
-+        /* Apply noise-blended coefficient scaling based on previously
-+           calculated RMS energy, blending factors, and SPX coordinates for
-+           each band. */
-+        bin = s-&gt;spx_start_freq;
-+        for (bnd = 0; bnd &lt; s-&gt;num_spx_bands; bnd++) {
-+            float nscale = s-&gt;spx_noise_blend[ch][bnd] * rms_energy[bnd];
-+            float sscale = s-&gt;spx_signal_blend[ch][bnd];
-+            for (i = 0; i &lt; s-&gt;spx_band_sizes[bnd]; i++) {
-+                float noise  = nscale * (((int)av_lfg_get(&amp;s-&gt;dith_state))/(float)(1&lt;&lt;31));
-+                s-&gt;transform_coeffs[ch][bin]   *= sscale;
-+                s-&gt;transform_coeffs[ch][bin++] += noise;
-+            }
-+        }
-+    }
-+}
-+
- /** lrint(M_SQRT2*cos(2*M_PI/12)*(1&lt;&lt;23)) */
- #define COEFF_0 10273905LL
- 
-@@ -492,13 +577,11 @@ int ff_eac3_parse_header(AC3DecodeContext *s)
-     }
- 
-     /* spectral extension attenuation data */
--    if (parse_spx_atten_data) {
--        av_log_missing_feature(s-&gt;avctx, &quot;Spectral extension attenuation&quot;, 1);
--        for (ch = 1; ch &lt;= s-&gt;fbw_channels; ch++) {
--            if (get_bits1(gbc)) { // channel has spx attenuation
--                skip_bits(gbc, 5); // skip spx attenuation code
--            }
--        }
-+    for (ch = 1; ch &lt;= s-&gt;fbw_channels; ch++) {
-+        if (parse_spx_atten_data &amp;&amp; get_bits1(gbc))
-+            s-&gt;spx_atten_code[ch] = get_bits(gbc, 5);
-+        else
-+            s-&gt;spx_atten_code[ch] = -1;
-     }
- 
-     /* block start information */
-@@ -514,6 +597,7 @@ int ff_eac3_parse_header(AC3DecodeContext *s)
- 
-     /* syntax state initialization */
-     for (ch = 1; ch &lt;= s-&gt;fbw_channels; ch++) {
-+        s-&gt;first_spx_coords[ch] = 1;
-         s-&gt;first_cpl_coords[ch] = 1;
-     }
-     s-&gt;first_cpl_leak = 1;

Deleted: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavcodec_fft.c.patch
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavcodec_fft.c.patch	2010-07-25 10:07:55 UTC (rev 6484)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavcodec_fft.c.patch	2010-07-25 10:07:56 UTC (rev 6485)
@@ -1,13 +0,0 @@
-diff --git a/avidemux_core/ADM_ffmpeg/libavcodec/fft.c b/avidemux_core/ADM_ffmpeg/libavcodec/fft.c
-index bf240bf..6199d91 100644
---- a/avidemux_core/ADM_ffmpeg/libavcodec/fft.c
-+++ b/avidemux_core/ADM_ffmpeg/libavcodec/fft.c
-@@ -112,7 +112,7 @@ av_cold int ff_fft_init(FFTContext *s, int nbits, int inverse)
- 
-     if (ARCH_ARM)     ff_fft_init_arm(s);
-     if (HAVE_ALTIVEC) ff_fft_init_altivec(s);
--    if (HAVE_MMX)     ff_fft_init_mmx(s);
-+    // MEANX if (HAVE_MMX)     ff_fft_init_mmx(s);
- 
-     if (s-&gt;split_radix) {
-         for(j=4; j&lt;=nbits; j++) {

Deleted: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavcodec_ffv1.c.patch
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavcodec_ffv1.c.patch	2010-07-25 10:07:55 UTC (rev 6484)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavcodec_ffv1.c.patch	2010-07-25 10:07:56 UTC (rev 6485)
@@ -1,13 +0,0 @@
-diff --git a/avidemux_core/ADM_ffmpeg/libavcodec/ffv1.c b/avidemux_core/ADM_ffmpeg/libavcodec/ffv1.c
-index 12056e1..b2f3efe 100644
---- a/avidemux_core/ADM_ffmpeg/libavcodec/ffv1.c
-+++ b/avidemux_core/ADM_ffmpeg/libavcodec/ffv1.c
-@@ -1107,6 +1107,8 @@ static int decode_frame(AVCodecContext *avctx, void *data, int *data_size, AVPac
-         clear_state(f);
-     }else{
-         p-&gt;key_frame= 0;
-+         p-&gt;pict_type= FF_P_TYPE; // MEANX : looks more like a P to me as user
-+
-     }
-     if(f-&gt;ac&gt;1){
-         int i;

Deleted: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavcodec_h263dec.c.patch
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavcodec_h263dec.c.patch	2010-07-25 10:07:55 UTC (rev 6484)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavcodec_h263dec.c.patch	2010-07-25 10:07:56 UTC (rev 6485)
@@ -1,56 +0,0 @@
-diff --git a/avidemux_core/ADM_ffmpeg/libavcodec/h263dec.c b/avidemux_core/ADM_ffmpeg/libavcodec/h263dec.c
-index f5df556..3bc37c0 100644
---- a/avidemux_core/ADM_ffmpeg/libavcodec/h263dec.c
-+++ b/avidemux_core/ADM_ffmpeg/libavcodec/h263dec.c
-@@ -119,6 +119,23 @@ av_cold int ff_h263_decode_init(AVCodecContext *avctx)
- 
-     return 0;
- }
-+/* MeanX : Ugly patch to detect vo ppacked stuff ... */
-+int av_is_voppacked(AVCodecContext *avctx, int *vop_packed, int *gmc, int *qpel)
-+{
-+    MpegEncContext *s = avctx-&gt;priv_data;
-+    // set sane default
-+    *vop_packed=0;
-+    *gmc=0;
-+    *qpel=0;
-+    if(avctx-&gt;codec-&gt;id!=CODEC_ID_MPEG4) return 0;
-+    	
-+  	*vop_packed=(s-&gt;divx_packed);
-+	*qpel=s-&gt;quarter_sample;
-+	*gmc=0;	// FIXME
-+	return 1;
-+
-+  }
-+  /* MeanX */
- 
- av_cold int ff_h263_decode_end(AVCodecContext *avctx)
- {
-@@ -414,6 +431,12 @@ retry:
-     } else {
-         ret = h263_decode_picture_header(s);
-     }
-+	//MEANX we need to do it here also for quicktime file / ctts atom 
-+        // we need the correct frame type, and qt file may contain 
-+        // vop not coded frame.
-+        pict-&gt;pict_type=s-&gt;current_picture.pict_type= s-&gt;pict_type;
-+        pict-&gt;key_frame=s-&gt;current_picture.key_frame= s-&gt;pict_type == FF_I_TYPE;
-+        //MEANX
- 
-     if(ret==FRAME_SKIPPED) return get_consumed_bytes(s, buf_size);
- 
-@@ -707,6 +730,14 @@ intrax8_decoded:
- 
- assert(s-&gt;current_picture.pict_type == s-&gt;current_picture_ptr-&gt;pict_type);
- assert(s-&gt;current_picture.pict_type == s-&gt;pict_type);
-+/* MEANX */
-+  if(s-&gt;current_picture_ptr)
-+      s-&gt;current_picture_ptr-&gt;opaque=pict-&gt;opaque;
-+/* MEANX */
-+
-+
-+
-+
-     if (s-&gt;pict_type == FF_B_TYPE || s-&gt;low_delay) {
-         *pict= *(AVFrame*)s-&gt;current_picture_ptr;
-     } else if (s-&gt;last_picture_ptr != NULL) {

Deleted: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavcodec_h264.c.patch
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavcodec_h264.c.patch	2010-07-25 10:07:55 UTC (rev 6484)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavcodec_h264.c.patch	2010-07-25 10:07:56 UTC (rev 6485)
@@ -1,22 +0,0 @@
-[1mdiff --git a/avidemux_core/ADM_ffmpeg/libavcodec/h264.c b/avidemux_core/ADM_ffmpeg/libavcodec/h264.c[m
-[1mindex e4654f0..cfab425 100644[m
-[1m--- a/avidemux_core/ADM_ffmpeg/libavcodec/h264.c[m
-[1m+++ b/avidemux_core/ADM_ffmpeg/libavcodec/h264.c[m
-[36m@@ -3358,6 +3358,17 @@[m [mav_cold int ff_h264_decode_end(AVCodecContext *avctx)[m
-     return 0;[m
- }[m
- [m
-[32m+[m[32m/* MEANX */[m
-[32m+[m[32mint av_getAVCStreamInfo(AVCodecContext *avctx, uint32_t  *nalSize, uint32_t *isAvc)[m
-[32m+[m[32m{[m
-[32m+[m[32m      H264Context *h = avctx-&gt;priv_data;[m
-[32m+[m[32m      assert(h);[m
-[32m+[m[32m      *nalSize=h-&gt;nal_length_size;[m
-[32m+[m[32m      *isAvc=h-&gt;is_avc;[m
-[32m+[m	[32mreturn 1;[m
-[32m+[m
-[32m+[m[32m  }[m
-[32m+[m[32m/* MeanX */[m
- [m
- AVCodec h264_decoder = {[m
-     &quot;h264&quot;,[m

Deleted: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavcodec_h264dsp.c.patch
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavcodec_h264dsp.c.patch	2010-07-25 10:07:55 UTC (rev 6484)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavcodec_h264dsp.c.patch	2010-07-25 10:07:56 UTC (rev 6485)
@@ -1,12 +0,0 @@
-diff --git a/avidemux_core/ADM_ffmpeg/libavcodec/h264dsp.c b/avidemux_core/ADM_ffmpeg/libavcodec/h264dsp.c
-index c01fc77..0fe9f40 100644
---- a/avidemux_core/ADM_ffmpeg/libavcodec/h264dsp.c
-+++ b/avidemux_core/ADM_ffmpeg/libavcodec/h264dsp.c
-@@ -316,5 +316,7 @@ void ff_h264dsp_init(H264DSPContext *c)
- 
-     if (ARCH_ARM) ff_h264dsp_init_arm(c);
-     if (HAVE_ALTIVEC) ff_h264dsp_init_ppc(c);
-+#if CONFIG_H264DSP //MEANX
-     if (HAVE_MMX) ff_h264dsp_init_x86(c);
-+#endif
- }

Deleted: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavcodec_mpeg12.c.patch
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavcodec_mpeg12.c.patch	2010-07-25 10:07:55 UTC (rev 6484)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavcodec_mpeg12.c.patch	2010-07-25 10:07:56 UTC (rev 6485)
@@ -1,16 +0,0 @@
-diff --git a/avidemux_core/ADM_ffmpeg/libavcodec/mpeg12.c b/avidemux_core/ADM_ffmpeg/libavcodec/mpeg12.c
-index bc9ddcc..036b9ba 100644
---- a/avidemux_core/ADM_ffmpeg/libavcodec/mpeg12.c
-+++ b/avidemux_core/ADM_ffmpeg/libavcodec/mpeg12.c
-@@ -1948,6 +1948,11 @@ static int slice_end(AVCodecContext *avctx, AVFrame *pict)
-         ff_er_frame_end(s);
- 
-         MPV_frame_end(s);
-+/* MEANX */
-+  if(s-&gt;current_picture_ptr)
-+      s-&gt;current_picture_ptr-&gt;opaque=pict-&gt;opaque;
-+/* MEANX */
-+
- 
-         if (s-&gt;pict_type == FF_B_TYPE || s-&gt;low_delay) {
-             *pict= *(AVFrame*)s-&gt;current_picture_ptr;

Deleted: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavcodec_mpeg12enc.c.patch
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavcodec_mpeg12enc.c.patch	2010-07-25 10:07:55 UTC (rev 6484)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavcodec_mpeg12enc.c.patch	2010-07-25 10:07:56 UTC (rev 6485)
@@ -1,190 +0,0 @@
-diff --git a/avidemux_core/ADM_ffmpeg/libavcodec/mpeg12enc.c b/avidemux_core/ADM_ffmpeg/libavcodec/mpeg12enc.c
-index bf36129..b4d6a1d 100644
---- a/avidemux_core/ADM_ffmpeg/libavcodec/mpeg12enc.c
-+++ b/avidemux_core/ADM_ffmpeg/libavcodec/mpeg12enc.c
-@@ -127,10 +127,19 @@ static int find_frame_rate_index(MpegEncContext *s){
-             s-&gt;frame_rate_index= i;
-         }
-     }
-+ /* MEANX 
-+
-     if(dmin)
-         return -1;
-     else
-         return 0;
-+  */
-+        if(dmin&gt;4)
-+   {
-+        av_log(0,AV_LOG_ERROR,&quot;We did a roundup ! Expect async!\n&quot;);
-+   }
-+        return 0; //MEANX
-+
- }
- 
- static av_cold int encode_init(AVCodecContext *avctx)
-@@ -209,6 +218,7 @@ static void mpeg1_encode_sequence_header(MpegEncContext *s)
-             put_sbits(&amp;s-&gt;pb, 12, s-&gt;width );
-             put_sbits(&amp;s-&gt;pb, 12, s-&gt;height);
- 
-+#if 0 //MEANX
-             for(i=1; i&lt;15; i++){
-                 float error= aspect_ratio;
-                 if(s-&gt;codec_id == CODEC_ID_MPEG1VIDEO || i &lt;=1)
-@@ -223,20 +233,44 @@ static void mpeg1_encode_sequence_header(MpegEncContext *s)
-                     s-&gt;aspect_ratio_info= i;
-                 }
-             }
-+#endif // MEANX
-+            //MEANX put_bits(&amp;s-&gt;pb, 4, s-&gt;aspect_ratio_info);
-+            //MEANX put_bits(&amp;s-&gt;pb, 4, s-&gt;frame_rate_index);
-+ // MEANX 4:3
-+  if(s-&gt;avctx-&gt;sample_aspect_ratio.num==16 &amp;&amp; s-&gt;avctx-&gt;sample_aspect_ratio.den==9)
-+            {
-+                //printf(&quot;FFmpeg : Wide\n&quot;);
-+                put_bits(&amp;s-&gt;pb,4,3); //16:9
-+            }
-+            else        //4:3
-+            {
-+              if(s-&gt;codec_id == CODEC_ID_MPEG2VIDEO)
-+                put_bits(&amp;s-&gt;pb, 4, 2);
-+              else
-+                put_bits(&amp;s-&gt;pb, 4, 12); // MPEG1
-+            }
-+// /MEANX
- 
--            put_bits(&amp;s-&gt;pb, 4, s-&gt;aspect_ratio_info);
--            put_bits(&amp;s-&gt;pb, 4, s-&gt;frame_rate_index);
-+// //MEANX PULLDOWN            put_bits(&amp;s-&gt;pb, 4, s-&gt;frame_rate_index);
-+if((s-&gt;flags2 &amp; CODEC_FLAG2_32_PULLDOWN) &amp;&amp; (s-&gt;codec_id == CODEC_ID_MPEG2VIDEO))
-+            {           
-+                put_bits(&amp;s-&gt;pb, 4,4);
-+            }
-+            else
-+            {                                  
-+                put_bits(&amp;s-&gt;pb, 4, s-&gt;frame_rate_index);
-+            } //MEANX pulldown
- 
--            if(s-&gt;avctx-&gt;rc_max_rate){
--                v = (s-&gt;avctx-&gt;rc_max_rate + 399) / 400;
-+            if(s-&gt;avctx-&gt;rc_max_rate_header){ //MEANX we use header
-+                v = (s-&gt;avctx-&gt;rc_max_rate_header + 399) / 400;
-                 if (v &gt; 0x3ffff &amp;&amp; s-&gt;codec_id == CODEC_ID_MPEG1VIDEO)
-                     v = 0x3ffff;
-             }else{
-                 v= 0x3FFFF;
-             }
- 
--            if(s-&gt;avctx-&gt;rc_buffer_size)
--                vbv_buffer_size = s-&gt;avctx-&gt;rc_buffer_size;
-+            if(s-&gt;avctx-&gt;rc_buffer_size_header) // MEANX we use header
-+                vbv_buffer_size = s-&gt;avctx-&gt;rc_buffer_size_header;
-             else
-                 /* VBV calculation: Scaled so that a VCD has the proper VBV size of 40 kilobytes */
-                 vbv_buffer_size = (( 20 * s-&gt;bit_rate) / (1151929 / 2)) * 8 * 1024;
-@@ -269,8 +303,17 @@ static void mpeg1_encode_sequence_header(MpegEncContext *s)
- 
-                 put_bits(&amp;s-&gt;pb, 3, s-&gt;avctx-&gt;profile); //profile
-                 put_bits(&amp;s-&gt;pb, 4, s-&gt;avctx-&gt;level); //level
-+   // MEANX pulldown put_bits(&amp;s-&gt;pb, 1, s-&gt;progressive_sequence);
-+  // MEANX Pulldown
-+ if(s-&gt;flags2 &amp; CODEC_FLAG2_32_PULLDOWN) //MEANX
-+                        put_bits(&amp;s-&gt;pb, 1, 0);
-+                else
-+                        put_bits(&amp;s-&gt;pb, 1, s-&gt;progressive_sequence);
-+
-+
-+// /MEANX
-+
- 
--                put_bits(&amp;s-&gt;pb, 1, s-&gt;progressive_sequence);
-                 put_bits(&amp;s-&gt;pb, 2, s-&gt;chroma_format);
-                 put_bits(&amp;s-&gt;pb, 2, s-&gt;width &gt;&gt;12);
-                 put_bits(&amp;s-&gt;pb, 2, s-&gt;height&gt;&gt;12);
-@@ -339,6 +382,8 @@ void ff_mpeg1_encode_slice_header(MpegEncContext *s){
- 
- void mpeg1_encode_picture_header(MpegEncContext *s, int picture_number)
- {
-+	int tff,rff; //MEANX
-+
-     mpeg1_encode_sequence_header(s);
- 
-     /* mpeg1 picture header */
-@@ -375,6 +420,49 @@ void mpeg1_encode_picture_header(MpegEncContext *s, int picture_number)
- 
-     s-&gt;frame_pred_frame_dct = 1;
-     if(s-&gt;codec_id == CODEC_ID_MPEG2VIDEO){
-+ /* MEANX -- Pulldown */
-+        if(s-&gt;flags2 &amp; CODEC_FLAG2_32_PULLDOWN)
-+        {
-+        
-+                switch((s-&gt;picture_number - 
-+                          s-&gt;gop_picture_number)&amp;3)
-+                {
-+                        case 0:
-+                        default:
-+                                rff=1;
-+                                tff=1;
-+                                break;
-+                        case 1:
-+                                rff=0;
-+                                tff=0;
-+                                break;
-+                        case 2:
-+                                rff=1;
-+                                tff=0;
-+                                break;
-+                        case 3:
-+                                rff=0;
-+                                tff=1;
-+                                break;
-+                }               
-+           }
-+        else
-+        {
-+                if (s-&gt;progressive_sequence) 
-+                {
-+                        tff=0; /* no repeat */
-+                } else 
-+                {
-+                        tff= s-&gt;current_picture_ptr-&gt;top_field_first;
-+                }
-+                rff=s-&gt;repeat_first_field;
-+        
-+        }
-+
-+//               /MEANX pulldown
-+
-+
-+
-         put_header(s, EXT_START_CODE);
-         put_bits(&amp;s-&gt;pb, 4, 8); //pic ext
-         if (s-&gt;pict_type == FF_P_TYPE || s-&gt;pict_type == FF_B_TYPE) {
-@@ -393,11 +481,16 @@ void mpeg1_encode_picture_header(MpegEncContext *s, int picture_number)
- 
-         assert(s-&gt;picture_structure == PICT_FRAME);
-         put_bits(&amp;s-&gt;pb, 2, s-&gt;picture_structure);
-+#if 0 //MEANX
-+
-         if (s-&gt;progressive_sequence) {
-             put_bits(&amp;s-&gt;pb, 1, 0); /* no repeat */
-         } else {
-             put_bits(&amp;s-&gt;pb, 1, s-&gt;current_picture_ptr-&gt;top_field_first);
-         }
-+#endif
-+         put_bits(&amp;s-&gt;pb, 1, tff);  //MEANX PULLDOWN
-+
-         /* XXX: optimize the generation of this flag with entropy
-            measures */
-         s-&gt;frame_pred_frame_dct = s-&gt;progressive_sequence;
-@@ -407,7 +500,10 @@ void mpeg1_encode_picture_header(MpegEncContext *s, int picture_number)
-         put_bits(&amp;s-&gt;pb, 1, s-&gt;q_scale_type);
-         put_bits(&amp;s-&gt;pb, 1, s-&gt;intra_vlc_format);
-         put_bits(&amp;s-&gt;pb, 1, s-&gt;alternate_scan);
--        put_bits(&amp;s-&gt;pb, 1, s-&gt;repeat_first_field);
-+ // MEANX put_bits(&amp;s-&gt;pb, 1, s-&gt;repeat_first_field);
-+	put_bits(&amp;s-&gt;pb, 1, rff);
-+      // /MEANX
-+
-         s-&gt;progressive_frame = s-&gt;progressive_sequence;
-         put_bits(&amp;s-&gt;pb, 1, s-&gt;chroma_format == CHROMA_420 ? s-&gt;progressive_frame : 0); /* chroma_420_type */
-         put_bits(&amp;s-&gt;pb, 1, s-&gt;progressive_frame);

Deleted: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavcodec_mpegvideo.c.patch
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavcodec_mpegvideo.c.patch	2010-07-25 10:07:55 UTC (rev 6484)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavcodec_mpegvideo.c.patch	2010-07-25 10:07:56 UTC (rev 6485)
@@ -1,17 +0,0 @@
-diff --git a/avidemux_core/ADM_ffmpeg/libavcodec/mpegvideo.c b/avidemux_core/ADM_ffmpeg/libavcodec/mpegvideo.c
-index b5631cf..770fed5 100644
---- a/avidemux_core/ADM_ffmpeg/libavcodec/mpegvideo.c
-+++ b/avidemux_core/ADM_ffmpeg/libavcodec/mpegvideo.c
-@@ -641,7 +641,11 @@ av_cold int MPV_common_init(MpegEncContext *s)
-     FF_ALLOCZ_OR_GOTO(s-&gt;avctx, s-&gt;prev_pict_types, PREV_PICT_TYPES_BUFFER_SIZE, fail);
- 
-     s-&gt;parse_context.state= -1;
--    if((s-&gt;avctx-&gt;debug&amp;(FF_DEBUG_VIS_QP|FF_DEBUG_VIS_MB_TYPE)) || (s-&gt;avctx-&gt;debug_mv)){
-+ //MEANX: Allocate them always, as they may be free when we decode 1st image
-+
-+    // MEANXif((s-&gt;avctx-&gt;debug&amp;(FF_DEBUG_VIS_QP|FF_DEBUG_VIS_MB_TYPE)) || (s-&gt;avctx-&gt;debug_mv)){
-+if(1){ // MEANX
-+
-        s-&gt;visualization_buffer[0] = av_malloc((s-&gt;mb_width*16 + 2*EDGE_WIDTH) * s-&gt;mb_height*16 + 2*EDGE_WIDTH);
-        s-&gt;visualization_buffer[1] = av_malloc((s-&gt;mb_width*16 + 2*EDGE_WIDTH) * s-&gt;mb_height*16 + 2*EDGE_WIDTH);
-        s-&gt;visualization_buffer[2] = av_malloc((s-&gt;mb_width*16 + 2*EDGE_WIDTH) * s-&gt;mb_height*16 + 2*EDGE_WIDTH);

Deleted: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavcodec_mpegvideo_enc.c.patch
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavcodec_mpegvideo_enc.c.patch	2010-07-25 10:07:55 UTC (rev 6484)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavcodec_mpegvideo_enc.c.patch	2010-07-25 10:07:56 UTC (rev 6485)
@@ -1,32 +0,0 @@
-diff --git a/avidemux_core/ADM_ffmpeg/libavcodec/mpegvideo_enc.c b/avidemux_core/ADM_ffmpeg/libavcodec/mpegvideo_enc.c
-index a8616d0..0b226d8 100644
---- a/avidemux_core/ADM_ffmpeg/libavcodec/mpegvideo_enc.c
-+++ b/avidemux_core/ADM_ffmpeg/libavcodec/mpegvideo_enc.c
-@@ -367,12 +367,14 @@ av_cold int MPV_encode_init(AVCodecContext *avctx)
- 
-         av_log(avctx, AV_LOG_INFO, &quot;Warning vbv_delay will be set to 0xFFFF (=VBR) as the specified vbv buffer is too large for the given bitrate!\n&quot;);
-     }
-+#if 0 //MEANX
- 
-     if((s-&gt;flags &amp; CODEC_FLAG_4MV) &amp;&amp; s-&gt;codec_id != CODEC_ID_MPEG4
-        &amp;&amp; s-&gt;codec_id != CODEC_ID_H263 &amp;&amp; s-&gt;codec_id != CODEC_ID_H263P &amp;&amp; s-&gt;codec_id != CODEC_ID_FLV1){
-         av_log(avctx, AV_LOG_ERROR, &quot;4MV not supported by codec\n&quot;);
-         return -1;
-     }
-+#endif
- 
-     if(s-&gt;obmc &amp;&amp; s-&gt;avctx-&gt;mb_decision != FF_MB_DECISION_SIMPLE){
-         av_log(avctx, AV_LOG_ERROR, &quot;OBMC is only supported with simple mb decision\n&quot;);
-@@ -413,10 +415,12 @@ av_cold int MPV_encode_init(AVCodecContext *avctx)
-         return -1;
-     }
- 
-+#if 0 //MEANX
-     if(s-&gt;mpeg_quant &amp;&amp; s-&gt;codec_id != CODEC_ID_MPEG4){ //FIXME mpeg2 uses that too
-         av_log(avctx, AV_LOG_ERROR, &quot;mpeg2 style quantization not supported by codec\n&quot;);
-         return -1;
-     }
-+#endif
- 
-     if((s-&gt;flags &amp; CODEC_FLAG_CBP_RD) &amp;&amp; !avctx-&gt;trellis){
-         av_log(avctx, AV_LOG_ERROR, &quot;CBP RD needs trellis quant\n&quot;);

Deleted: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavcodec_png.patch
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavcodec_png.patch	2010-07-25 10:07:55 UTC (rev 6484)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavcodec_png.patch	2010-07-25 10:07:56 UTC (rev 6485)
@@ -1,13 +0,0 @@
-diff --git a/avidemux_core/ADM_ffmpeg/libavcodec/png.c b/avidemux_core/ADM_ffmpeg/libavcodec/png.c
-index 534dc68..1a6e137 100644
---- a/avidemux_core/ADM_ffmpeg/libavcodec/png.c
-+++ b/avidemux_core/ADM_ffmpeg/libavcodec/png.c
-@@ -20,7 +20,7 @@
-  */
- #include &quot;avcodec.h&quot;
- #include &quot;bytestream.h&quot;
--#include &quot;png.h&quot;
-+#include &quot;ffpng.h&quot;
- 
- const uint8_t ff_pngsig[8] = {137, 80, 78, 71, 13, 10, 26, 10};
- const uint8_t ff_mngsig[8] = {138, 77, 78, 71, 13, 10, 26, 10};

Deleted: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavcodec_pngdec.c.patch
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavcodec_pngdec.c.patch	2010-07-25 10:07:55 UTC (rev 6484)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavcodec_pngdec.c.patch	2010-07-25 10:07:56 UTC (rev 6485)
@@ -1,13 +0,0 @@
-diff --git a/avidemux_core/ADM_ffmpeg/libavcodec/pngdec.c b/avidemux_core/ADM_ffmpeg/libavcodec/pngdec.c
-index 03859a9..e1b6d6e 100644
---- a/avidemux_core/ADM_ffmpeg/libavcodec/pngdec.c
-+++ b/avidemux_core/ADM_ffmpeg/libavcodec/pngdec.c
-@@ -20,7 +20,7 @@
-  */
- #include &quot;avcodec.h&quot;
- #include &quot;bytestream.h&quot;
--#include &quot;png.h&quot;
-+#include &quot;ffpng.h&quot;
- #include &quot;dsputil.h&quot;
- 
- /* TODO:

Deleted: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavcodec_pngenc.c.patch
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavcodec_pngenc.c.patch	2010-07-25 10:07:55 UTC (rev 6484)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavcodec_pngenc.c.patch	2010-07-25 10:07:56 UTC (rev 6485)
@@ -1,13 +0,0 @@
-diff --git a/avidemux_core/ADM_ffmpeg/libavcodec/pngenc.c b/avidemux_core/ADM_ffmpeg/libavcodec/pngenc.c
-index 615bcc4..4149234 100644
---- a/avidemux_core/ADM_ffmpeg/libavcodec/pngenc.c
-+++ b/avidemux_core/ADM_ffmpeg/libavcodec/pngenc.c
-@@ -21,7 +21,7 @@
- #include &quot;avcodec.h&quot;
- #include &quot;bytestream.h&quot;
- #include &quot;dsputil.h&quot;
--#include &quot;png.h&quot;
-+#include &quot;ffpng.h&quot;
- 
- /* TODO:
-  * - add 2, 4 and 16 bit depth support

Deleted: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavcodec_utils.c.patch
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavcodec_utils.c.patch	2010-07-25 10:07:55 UTC (rev 6484)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavcodec_utils.c.patch	2010-07-25 10:07:56 UTC (rev 6485)
@@ -1,42 +0,0 @@
-diff --git a/avidemux_core/ADM_ffmpeg/libavcodec/utils.c b/avidemux_core/ADM_ffmpeg/libavcodec/utils.c
-index 56d4dbd..aad5a47 100644
---- a/avidemux_core/ADM_ffmpeg/libavcodec/utils.c
-+++ b/avidemux_core/ADM_ffmpeg/libavcodec/utils.c
-@@ -643,10 +643,12 @@ int attribute_align_arg avcodec_decode_audio3(AVCodecContext *avctx, int16_t *sa
- 
-     if((avctx-&gt;codec-&gt;capabilities &amp; CODEC_CAP_DELAY) || avpkt-&gt;size){
-         //FIXME remove the check below _after_ ensuring that all audio check that the available space is enough
-+#if 0 // MEANX : Silence
-         if(*frame_size_ptr &lt; AVCODEC_MAX_AUDIO_FRAME_SIZE){
-             av_log(avctx, AV_LOG_ERROR, &quot;buffer smaller than AVCODEC_MAX_AUDIO_FRAME_SIZE\n&quot;);
-             return -1;
-         }
-+#endif
-         if(*frame_size_ptr &lt; FF_MIN_BUFFER_SIZE ||
-         *frame_size_ptr &lt; avctx-&gt;channels * avctx-&gt;frame_size * sizeof(int16_t)){
-             av_log(avctx, AV_LOG_ERROR, &quot;buffer %d too small\n&quot;, *frame_size_ptr);
-@@ -921,13 +923,13 @@ unsigned avcodec_version( void )
- 
- const char *avcodec_configuration(void)
- {
--    return FFMPEG_CONFIGURATION;
-+    return &quot;avidemux&quot;; //FFMPEG_CONFIGURATION;
- }
- 
- const char *avcodec_license(void)
- {
- #define LICENSE_PREFIX &quot;libavcodec license: &quot;
--    return LICENSE_PREFIX FFMPEG_LICENSE + sizeof(LICENSE_PREFIX) - 1;
-+    return LICENSE_PREFIX /*FFMPEG_LICENSE*/ &quot;GPL&quot; + sizeof(LICENSE_PREFIX) - 1;
- }
- 
- void avcodec_init(void)
-@@ -1080,7 +1082,7 @@ int av_tempfile(char *prefix, char **filename) {
-         return -1;
-     }
- #if !HAVE_MKSTEMP
--    fd = open(*filename, O_RDWR | O_BINARY | O_CREAT, 0444);
-+    fd = open(*filename, O_RDWR /* MEANX | O_BINARY*/ | O_CREAT, 0444);
- #else
-     snprintf(*filename, len, &quot;/tmp/%sXXXXXX&quot;, prefix);
-     fd = mkstemp(*filename);

Deleted: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavcodec_x86_mathops.h
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavcodec_x86_mathops.h	2010-07-25 10:07:55 UTC (rev 6484)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavcodec_x86_mathops.h	2010-07-25 10:07:56 UTC (rev 6485)
@@ -1,17 +0,0 @@
-diff --git a/avidemux_core/ADM_ffmpeg/libavcodec/x86/mathops.h b/avidemux_core/ADM_ffmpeg/libavcodec/x86/mathops.h
-index 5949dfe..c7f54c5 100644
---- a/avidemux_core/ADM_ffmpeg/libavcodec/x86/mathops.h
-+++ b/avidemux_core/ADM_ffmpeg/libavcodec/x86/mathops.h
-@@ -22,7 +22,12 @@
- #ifndef AVCODEC_X86_MATHOPS_H
- #define AVCODEC_X86_MATHOPS_H
- 
-+// MEANX
-+#ifndef ADM_NO_CONFIG_H
- #include &quot;config.h&quot;
-+#endif
-+// MEANX
-+
- #include &quot;libavutil/common.h&quot;
- 
- #if ARCH_X86_32

Deleted: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavformat_file.c.patch
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavformat_file.c.patch	2010-07-25 10:07:55 UTC (rev 6484)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavformat_file.c.patch	2010-07-25 10:07:56 UTC (rev 6485)
@@ -1,77 +0,0 @@
-*** libavformat/file.c.old	Mon Feb  2 19:49:57 2009
---- libavformat/file.c	Mon Feb  2 19:49:56 2009
-***************
-*** 30,35 ****
---- 30,101 ----
-  #include &lt;stdlib.h&gt;
-  #include &quot;os_support.h&quot;
-  
-+ // GRUNTSTER start
-+ #ifdef __WIN32
-+ #include &lt;windows.h&gt;
-+ 
-+ int utf8StringToWideChar(const char *utf8String, int utf8StringLength, wchar_t *wideCharString)
-+ {
-+ 	int wideCharStringLength = MultiByteToWideChar(CP_UTF8, 0, utf8String, utf8StringLength, NULL, 0);
-+ 
-+ 	if (wideCharString)
-+ 		MultiByteToWideChar(CP_UTF8, 0, utf8String, utf8StringLength, wideCharString, wideCharStringLength);
-+ 
-+ 	return wideCharStringLength;
-+ }
-+ 
-+ int ADM_open(const char *path, int oflag, ...)
-+ {
-+ 	int fileNameLength = utf8StringToWideChar(path, -1, NULL);
-+ 	wchar_t wcFile[fileNameLength];
-+ 	int creation = 0, access = 0;
-+ 	HANDLE hFile;
-+ 
-+ 	utf8StringToWideChar(path, -1, wcFile);
-+ 
-+ 	if (oflag &amp; O_WRONLY || oflag &amp; O_RDWR)
-+ 	{
-+ 		access = GENERIC_WRITE;
-+ 
-+ 		if (oflag &amp; O_RDWR)
-+ 			access |= GENERIC_READ;
-+ 
-+ 		if (oflag &amp; O_CREAT)
-+ 		{
-+ 			if (oflag &amp; O_EXCL)
-+ 				creation = CREATE_NEW;
-+ 			else if (oflag &amp; O_TRUNC)
-+ 				creation = CREATE_ALWAYS;
-+ 			else
-+ 				creation = OPEN_ALWAYS;
-+ 		}
-+ 		else if (oflag &amp; O_TRUNC)
-+ 			creation = TRUNCATE_EXISTING;
-+ 	}
-+ 	else if (oflag &amp; O_RDONLY)
-+ 		creation = OPEN_EXISTING;
-+ 
-+ 	if (creation &amp; GENERIC_WRITE)
-+ 	{
-+ 		hFile = CreateFileW(wcFile, access, 0, NULL, creation, 0, NULL);
-+ 
-+ 		if (hFile == INVALID_HANDLE_VALUE)
-+ 			return -1;
-+ 		else
-+ 			CloseHandle(hFile);
-+ 	}
-+ 
-+ 	hFile = CreateFileW(wcFile, access, FILE_SHARE_READ, NULL, creation, 0, NULL);
-+ 
-+ 	if (hFile == INVALID_HANDLE_VALUE)
-+ 		return -1;
-+ 	else
-+ 		return _open_osfhandle((intptr_t)hFile, oflag);
-+ }
-+ 
-+ #define open ADM_open
-+ #endif
-+ // GRUNTSTER end
-  
-  /* standard file protocol */
-  

Deleted: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavformat_flvenc.c.patch
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavformat_flvenc.c.patch	2010-07-25 10:07:55 UTC (rev 6484)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavformat_flvenc.c.patch	2010-07-25 10:07:56 UTC (rev 6485)
@@ -1,33 +0,0 @@
-*** libavformat/flvenc.c.old	Mon Feb  2 19:49:58 2009
---- libavformat/flvenc.c	Mon Feb  2 19:49:57 2009
-***************
-*** 389,395 ****
-      &quot;video/x-flv&quot;,
-      &quot;flv&quot;,
-      sizeof(FLVContext),
-! #if CONFIG_LIBMP3LAME
-      CODEC_ID_MP3,
-  #else // CONFIG_LIBMP3LAME
-      CODEC_ID_ADPCM_SWF,
---- 389,396 ----
-      &quot;video/x-flv&quot;,
-      &quot;flv&quot;,
-      sizeof(FLVContext),
-! //MEANX #if CONFIG_LIBMP3LAME
-! #ifdef HAVE_LIBMP3LAME
-      CODEC_ID_MP3,
-  #else // CONFIG_LIBMP3LAME
-      CODEC_ID_ADPCM_SWF,
-***************
-*** 401,403 ****
---- 402,410 ----
-      .codec_tag= (const AVCodecTag* const []){flv_video_codec_ids, flv_audio_codec_ids, 0},
-      .flags= AVFMT_GLOBALHEADER,
-  };
-+ // MEANX
-+ int flvenc_init(void)
-+ {
-+     av_register_output_format(&amp;flv_muxer);
-+     return 0;
-+ }
-\ No newline at end of file

Deleted: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavformat_isom.c.patch
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavformat_isom.c.patch	2010-07-25 10:07:55 UTC (rev 6484)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavformat_isom.c.patch	2010-07-25 10:07:56 UTC (rev 6485)
@@ -1,22 +0,0 @@
-*** libavformat/isom.c.old	Mon Feb  2 19:49:59 2009
---- libavformat/isom.c	Mon Feb  2 19:49:59 2009
-***************
-*** 187,193 ****
-      { CODEC_ID_MACE3, MKTAG('M', 'A', 'C', '3') }, /* Macintosh Audio Compression and Expansion 3:1 */
-      { CODEC_ID_MACE6, MKTAG('M', 'A', 'C', '6') }, /* Macintosh Audio Compression and Expansion 6:1 */
-  
-!     { CODEC_ID_MP3, MKTAG('.', 'm', 'p', '3') }, /* MPEG layer 3 */ /* sample files at <A HREF="http://www.3ivx.com/showcase.html">http://www.3ivx.com/showcase.html</A> use this tag */
-      { CODEC_ID_MP3, 0x6D730055 }, /* MPEG layer 3 */
-  
-  /*  { CODEC_ID_OGG_VORBIS, MKTAG('O', 'g', 'g', 'S') }, *//* sample files at <A HREF="http://heroinewarrior.com/xmovie.php3">http://heroinewarrior.com/xmovie.php3</A> use this tag */
---- 187,196 ----
-      { CODEC_ID_MACE3, MKTAG('M', 'A', 'C', '3') }, /* Macintosh Audio Compression and Expansion 3:1 */
-      { CODEC_ID_MACE6, MKTAG('M', 'A', 'C', '6') }, /* Macintosh Audio Compression and Expansion 6:1 */
-  
-!     //MEANX { CODEC_ID_MP3, MKTAG('.', 'm', 'p', '3') }, /* MPEG layer 3 */ /* sample files at <A HREF="http://www.3ivx.com/showcase.html">http://www.3ivx.com/showcase.html</A> use this tag */
-!      { CODEC_ID_MP3, MKTAG( 'm', 'p', '4','a') },
-!      { CODEC_ID_MP2, MKTAG( 'm', 'p', '4', 'a') },
-!     // /MEANX
-      { CODEC_ID_MP3, 0x6D730055 }, /* MPEG layer 3 */
-  
-  /*  { CODEC_ID_OGG_VORBIS, MKTAG('O', 'g', 'g', 'S') }, *//* sample files at <A HREF="http://heroinewarrior.com/xmovie.php3">http://heroinewarrior.com/xmovie.php3</A> use this tag */

Deleted: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavformat_matroskaenc.c.patch
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavformat_matroskaenc.c.patch	2010-07-25 10:07:55 UTC (rev 6484)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavformat_matroskaenc.c.patch	2010-07-25 10:07:56 UTC (rev 6485)
@@ -1,85 +0,0 @@
-*** libavformat/matroskaenc.c.old	Wed Apr  1 18:35:42 2009
---- libavformat/matroskaenc.c	Wed Apr  1 18:35:42 2009
-***************
-*** 395,400 ****
---- 395,401 ----
-  
-  static int put_xiph_codecpriv(AVFormatContext *s, ByteIOContext *pb, AVCodecContext *codec)
-  {
-+ #if 0 // MEANX avidemux does thing differently
-      uint8_t *header_start[3];
-      int header_len[3];
-      int first_header_size;
-***************
-*** 419,424 ****
---- 420,447 ----
-          put_buffer(pb, header_start[j], header_len[j]);
-  
-      return 0;
-+ #else
-+    // Not endian safe....
-+       uint32_t packetLen[3],*ptr=(uint32_t *)codec-&gt;extradata;
-+       uint8_t *data[3],i,j;
-+       if( 3*4+ptr[0]+ptr[1]+ptr[2]!=codec-&gt;extradata_size)
-+       {
-+         av_log(s, AV_LOG_ERROR, &quot;Broken avidemux xiph header.\n&quot;);
-+         return -1;
-+       }
-+       data[0]=codec-&gt;extradata+3*4;
-+       data[1]=data[0]+ptr[0];
-+       data[2]=data[1]+ptr[1];
-+       put_byte(pb, 2);                    // number packets - 1
-+       for (j = 0; j &lt; 2; j++) 
-+       {
-+           put_xiph_size(pb, ptr[j]);
-+       }
-+       for (j = 0; j &lt; 3; j++)
-+         put_buffer(pb, data[j], ptr[j]);
-+       
-+       return 0; // /MEANX
-+ #endif
-  }
-  
-  static void get_aac_sample_rates(AVFormatContext *s, AVCodecContext *codec, int *sample_rate, int *output_sample_rate)
-***************
-*** 534,539 ****
---- 557,579 ----
-          put_ebml_uint (pb, MATROSKA_ID_TRACKNUMBER     , i + 1);
-          put_ebml_uint (pb, MATROSKA_ID_TRACKUID        , i + 1);
-          put_ebml_uint (pb, MATROSKA_ID_TRACKFLAGLACING , 0);    // no lacing (yet)
-+ /**  MEANX : Add a default duration for video **/
-+         if(codec-&gt;codec_type==CODEC_TYPE_VIDEO)
-+         {
-+           if(codec-&gt;time_base.den &amp;&amp; codec-&gt;time_base.num)
-+           {
-+             int num=codec-&gt;time_base.num;
-+             int den=codec-&gt;time_base.den;
-+             unsigned int default_duration;
-+             float period=num;
-+                   period/=den;
-+                   period*=1000*1000*1000; // in ns
-+                   default_duration=(unsigned int)floor(period);
-+                   put_ebml_uint (pb, MATROSKA_ID_TRACKDEFAULTDURATION ,default_duration);
-+           }
-+         }
-+         
-+ /**  MEANX : Add a default duration for video **/
-  
-          if ((tag = av_metadata_get(st-&gt;metadata, &quot;description&quot;, NULL, 0)))
-              put_ebml_string(pb, MATROSKA_ID_TRACKNAME, tag-&gt;value);
-***************
-*** 907,909 ****
---- 947,959 ----
-      .flags = AVFMT_GLOBALHEADER,
-      .codec_tag = (const AVCodecTag* const []){codec_wav_tags, 0},
-  };
-+ // MEANX
-+ //
-+ int matroskaenc_init(void)
-+ {
-+     av_register_output_format(&amp;matroska_muxer);
-+     return 0;
-+ }
-+ // /MEANX
-+ 
-+ 

Deleted: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavformat_movenc.c.patch
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavformat_movenc.c.patch	2010-07-25 10:07:55 UTC (rev 6484)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavformat_movenc.c.patch	2010-07-25 10:07:56 UTC (rev 6485)
@@ -1,20 +0,0 @@
-*** libavformat/movenc.c.old	Wed Apr  1 18:35:42 2009
---- libavformat/movenc.c	Wed Apr  1 18:35:42 2009
-***************
-*** 1960,1962 ****
---- 1960,1974 ----
-      .codec_tag = (const AVCodecTag* const []){codec_ipod_tags, 0},
-  };
-  #endif
-+ /* MEANX */
-+ int movenc_init(void)
-+ {
-+     av_register_output_format(&amp;mov_muxer);
-+     av_register_output_format(&amp;tgp_muxer);
-+     av_register_output_format(&amp;mp4_muxer);
-+     av_register_output_format(&amp;psp_muxer);
-+     av_register_output_format(&amp;tg2_muxer);
-+     av_register_output_format(&amp;ipod_muxer);
-+     return 0;
-+ }
-+ /* MEANX */

Deleted: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavformat_mpegenc.c.patch
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavformat_mpegenc.c.patch	2010-07-25 10:07:55 UTC (rev 6484)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavformat_mpegenc.c.patch	2010-07-25 10:07:56 UTC (rev 6485)
@@ -1,17 +0,0 @@
---- libavformat/mpegenc.c
-+++ libavformat/mpegenc.c
-@@ -1300,3 +1300,13 @@ AVOutputFormat mpeg2dvd_muxer = {
-     mpeg_mux_end,
- };
- #endif
-+// MEANX
-+//
-+int mpegenc_init(void)
-+{
-+    av_register_output_format(&amp;mpeg2dvd_muxer);
-+    av_register_output_format(&amp;mpeg2svcd_muxer);
-+    av_register_output_format(&amp;mpeg2vob_muxer);
-+    av_register_output_format(&amp;mpeg1vcd_muxer);
-+    return 0;
-+}
-\ No newline at end of file

Deleted: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavformat_mpegtsenc.c.patch
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavformat_mpegtsenc.c.patch	2010-07-25 10:07:55 UTC (rev 6484)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavformat_mpegtsenc.c.patch	2010-07-25 10:07:56 UTC (rev 6485)
@@ -1,12 +0,0 @@
---- libavformat/mpegtsenc.c
-+++ libavformat/mpegtsenc.c
-@@ -809,3 +809,8 @@ AVOutputFormat mpegts_muxer = {
-     mpegts_write_packet,
-     mpegts_write_end,
- };
-+int mpegtsenc_init(void)
-+{
-+    av_register_output_format(&amp;mpegts_muxer);
-+    return 0;
-+}
-\ No newline at end of file

Deleted: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavformat_utils.c.patch
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavformat_utils.c.patch	2010-07-25 10:07:55 UTC (rev 6484)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavformat_utils.c.patch	2010-07-25 10:07:56 UTC (rev 6485)
@@ -1,21 +0,0 @@
-diff --git a/avidemux_core/ADM_ffmpeg/libavformat/utils.c b/avidemux_core/ADM_ffmpeg/libavformat/utils.c
-index 22c833d..e90b609 100644
---- a/avidemux_core/ADM_ffmpeg/libavformat/utils.c
-+++ b/avidemux_core/ADM_ffmpeg/libavformat/utils.c
-@@ -49,13 +49,14 @@ unsigned avformat_version(void)
- 
- const char *avformat_configuration(void)
- {
--    return FFMPEG_CONFIGURATION;
-+    return &quot;avidemux&quot;; //FFMPEG_CONFIGURATION;
- }
- 
- const char *avformat_license(void)
- {
- #define LICENSE_PREFIX &quot;libavformat license: &quot;
--    return LICENSE_PREFIX FFMPEG_LICENSE + sizeof(LICENSE_PREFIX) - 1;
-+    //return LICENSE_PREFIX FFMPEG_LICENSE + sizeof(LICENSE_PREFIX) - 1;
-+        return LICENSE_PREFIX &quot;GPL&quot;;
- }
- 
- /* fraction handling */

Deleted: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavutil_avutil.h.patch
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavutil_avutil.h.patch	2010-07-25 10:07:55 UTC (rev 6484)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavutil_avutil.h.patch	2010-07-25 10:07:56 UTC (rev 6485)
@@ -1,18 +0,0 @@
-diff --git a/avidemux_core/ADM_ffmpeg/libavutil/avutil.h b/avidemux_core/ADM_ffmpeg/libavutil/avutil.h
-index 72bd2c5..a81225f 100644
---- a/avidemux_core/ADM_ffmpeg/libavutil/avutil.h
-+++ b/avidemux_core/ADM_ffmpeg/libavutil/avutil.h
-@@ -26,6 +26,13 @@
-  * external API header
-  */
- 
-+/* MEANX
-+ * - */
-+#define ASMALIGN(ZEROBITS) &quot;.p2align &quot; #ZEROBITS &quot;\n\t&quot;
-+/* /MEANX
-+ */
-+
-+
- 
- #define AV_STRINGIFY(s)         AV_TOSTRING(s)
- #define AV_TOSTRING(s) #s

Deleted: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavutil_bswap.h.patch
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavutil_bswap.h.patch	2010-07-25 10:07:55 UTC (rev 6484)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavutil_bswap.h.patch	2010-07-25 10:07:56 UTC (rev 6485)
@@ -1,16 +0,0 @@
-diff --git a/avidemux_core/ADM_ffmpeg/libavutil/bswap.h b/avidemux_core/ADM_ffmpeg/libavutil/bswap.h
-index 6dd2a35..f7a422c 100644
---- a/avidemux_core/ADM_ffmpeg/libavutil/bswap.h
-+++ b/avidemux_core/ADM_ffmpeg/libavutil/bswap.h
-@@ -27,7 +27,11 @@
- #define AVUTIL_BSWAP_H
- 
- #include &lt;stdint.h&gt;
-+// MEANX
-+#ifndef ADM_NO_CONFIG_H
- #include &quot;config.h&quot;
-+#endif
-+// /MEANX
- #include &quot;attributes.h&quot;
- 
- #if   ARCH_ARM

Deleted: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavutil_internal.h.patch
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavutil_internal.h.patch	2010-07-25 10:07:55 UTC (rev 6484)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavutil_internal.h.patch	2010-07-25 10:07:56 UTC (rev 6485)
@@ -1,49 +0,0 @@
-diff --git a/avidemux_core/ADM_ffmpeg/libavutil/internal.h b/avidemux_core/ADM_ffmpeg/libavutil/internal.h
-index 2faafc9..8516159 100644
---- a/avidemux_core/ADM_ffmpeg/libavutil/internal.h
-+++ b/avidemux_core/ADM_ffmpeg/libavutil/internal.h
-@@ -34,7 +34,11 @@
- #include &lt;stdint.h&gt;
- #include &lt;stddef.h&gt;
- #include &lt;assert.h&gt;
-+//MEANX
-+#ifndef ADM_NO_CONFIG_H
- #include &quot;config.h&quot;
-+#endif
-+// /MEANX
- #include &quot;attributes.h&quot;
- #include &quot;timer.h&quot;
- 
-@@ -95,6 +99,8 @@
- #endif
- 
- /* Use to export labels from asm. */
-+#include &quot;ADM_mangle.h&quot;
-+#if 0 // MEANX
- #define LABEL_MANGLE(a) EXTERN_PREFIX #a
- 
- // Use rip-relative addressing if compiling PIC code on x86-64.
-@@ -105,7 +111,7 @@
- #endif
- 
- #define MANGLE(a) EXTERN_PREFIX LOCAL_MANGLE(a)
--
-+#endif // MEANX
- /* debug stuff */
- 
- /* dprintf macros */
-@@ -134,12 +140,14 @@
- #endif
- 
- /* avoid usage of dangerous/inappropriate system functions */
-+#if 0 //MEANX
- #undef  malloc
- #define malloc please_use_av_malloc
- #undef  free
- #define free please_use_av_free
- #undef  realloc
- #define realloc please_use_av_realloc
-+#endif
- #undef  time
- #define time time_is_forbidden_due_to_security_issues
- #undef  rand

Deleted: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavutil_intreadwrite.h.patch
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavutil_intreadwrite.h.patch	2010-07-25 10:07:55 UTC (rev 6484)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavutil_intreadwrite.h.patch	2010-07-25 10:07:56 UTC (rev 6485)
@@ -1,17 +0,0 @@
-diff --git a/avidemux_core/ADM_ffmpeg/libavutil/intreadwrite.h b/avidemux_core/ADM_ffmpeg/libavutil/intreadwrite.h
-index c8026f0..272a3b1 100644
---- a/avidemux_core/ADM_ffmpeg/libavutil/intreadwrite.h
-+++ b/avidemux_core/ADM_ffmpeg/libavutil/intreadwrite.h
-@@ -20,7 +20,12 @@
- #define AVUTIL_INTREADWRITE_H
- 
- #include &lt;stdint.h&gt;
-+// MEANX
-+#ifndef ADM_NO_CONFIG_H
- #include &quot;config.h&quot;
-+#endif
-+// MEANX
-+
- #include &quot;bswap.h&quot;
- #include &quot;common.h&quot;
- 

Deleted: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavutil_lfg.h
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavutil_lfg.h	2010-07-25 10:07:55 UTC (rev 6484)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavutil_lfg.h	2010-07-25 10:07:56 UTC (rev 6485)
@@ -1,50 +0,0 @@
-diff --git a/avidemux_core/ADM_ffmpeg/libavutil/lfg.c b/avidemux_core/ADM_ffmpeg/libavutil/lfg.c
-index 1dad4e4..9b1db67 100644
---- a/avidemux_core/ADM_ffmpeg/libavutil/lfg.c
-+++ b/avidemux_core/ADM_ffmpeg/libavutil/lfg.c
-@@ -37,7 +37,7 @@ void av_cold av_lfg_init(AVLFG *c, unsigned int seed){
-         c-&gt;state[i+2]= AV_RL32(tmp+8);
-         c-&gt;state[i+3]= AV_RL32(tmp+12);
-     }
--    c-&gt;index=0;
-+    c-&gt;xindex=0;
- }
- 
- void av_bmg_get(AVLFG *lfg, double out[2])
-diff --git a/avidemux_core/ADM_ffmpeg/libavutil/lfg.h b/avidemux_core/ADM_ffmpeg/libavutil/lfg.h
-index c952fc8..9648fce 100644
---- a/avidemux_core/ADM_ffmpeg/libavutil/lfg.h
-+++ b/avidemux_core/ADM_ffmpeg/libavutil/lfg.h
-@@ -23,7 +23,7 @@
- #define AVUTIL_LFG_H
- typedef struct {
-     unsigned int state[64];
--    int index;
-+    int xindex;
- } AVLFG;
- 
- void av_lfg_init(AVLFG *c, unsigned int seed);
-@@ -35,8 +35,8 @@ void av_lfg_init(AVLFG *c, unsigned int seed);
-  * it may be good enough and faster for your specific use case.
-  */
- static inline unsigned int av_lfg_get(AVLFG *c){
--    c-&gt;state[c-&gt;index &amp; 63] = c-&gt;state[(c-&gt;index-24) &amp; 63] + c-&gt;state[(c-&gt;index-55) &amp; 63];
--    return c-&gt;state[c-&gt;index++ &amp; 63];
-+    c-&gt;state[c-&gt;xindex &amp; 63] = c-&gt;state[(c-&gt;xindex-24) &amp; 63] + c-&gt;state[(c-&gt;xindex-55) &amp; 63];
-+    return c-&gt;state[c-&gt;xindex++ &amp; 63];
- }
- 
- /**
-@@ -45,9 +45,9 @@ static inline unsigned int av_lfg_get(AVLFG *c){
-  * Please also consider av_lfg_get() above, it is faster.
-  */
- static inline unsigned int av_mlfg_get(AVLFG *c){
--    unsigned int a= c-&gt;state[(c-&gt;index-55) &amp; 63];
--    unsigned int b= c-&gt;state[(c-&gt;index-24) &amp; 63];
--    return c-&gt;state[c-&gt;index++ &amp; 63] = 2*a*b+a+b;
-+    unsigned int a= c-&gt;state[(c-&gt;xindex-55) &amp; 63];
-+    unsigned int b= c-&gt;state[(c-&gt;xindex-24) &amp; 63];
-+    return c-&gt;state[c-&gt;xindex++ &amp; 63] = 2*a*b+a+b;
- }
- 
- /**

Deleted: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavutil_libm.h.patch
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavutil_libm.h.patch	2010-07-25 10:07:55 UTC (rev 6484)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavutil_libm.h.patch	2010-07-25 10:07:56 UTC (rev 6485)
@@ -1,16 +0,0 @@
-diff --git a/avidemux_core/ADM_ffmpeg/libavutil/libm.h b/avidemux_core/ADM_ffmpeg/libavutil/libm.h
-index c7c28ac..3f6ae07 100644
---- a/avidemux_core/ADM_ffmpeg/libavutil/libm.h
-+++ b/avidemux_core/ADM_ffmpeg/libavutil/libm.h
-@@ -25,7 +25,11 @@
- #define AVUTIL_LIBM_H
- 
- #include &lt;math.h&gt;
-+//MEANX
-+#ifndef ADM_NO_CONFIG_H
- #include &quot;config.h&quot;
-+#endif
-+///MEANX
- #include &quot;attributes.h&quot;
- 
- #if !HAVE_EXP2

Deleted: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavutil_mem.c.patch
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavutil_mem.c.patch	2010-07-25 10:07:55 UTC (rev 6484)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavutil_mem.c.patch	2010-07-25 10:07:56 UTC (rev 6485)
@@ -1,182 +0,0 @@
-diff --git a/avidemux_core/ADM_ffmpeg/libavutil/mem.c b/avidemux_core/ADM_ffmpeg/libavutil/mem.c
-index 8cad089..8e95a78 100644
---- a/avidemux_core/ADM_ffmpeg/libavutil/mem.c
-+++ b/avidemux_core/ADM_ffmpeg/libavutil/mem.c
-@@ -63,87 +63,110 @@ void  free(void *ptr);
- 
- void *av_malloc(unsigned int size)
- {
--    void *ptr = NULL;
--#if CONFIG_MEMALIGN_HACK
--    long diff;
--#endif
--
--    /* let's disallow possible ambiguous cases */
--    if(size &gt; (INT_MAX-16) )
--        return NULL;
--
--#if CONFIG_MEMALIGN_HACK
--    ptr = malloc(size+16);
--    if(!ptr)
--        return ptr;
--    diff= ((-(long)ptr - 1)&amp;15) + 1;
--    ptr = (char*)ptr + diff;
--    ((char*)ptr)[-1]= diff;
--#elif HAVE_POSIX_MEMALIGN
--    if (posix_memalign(&amp;ptr,16,size))
--        ptr = NULL;
--#elif HAVE_MEMALIGN
--    ptr = memalign(16,size);
--    /* Why 64?
--       Indeed, we should align it:
--         on 4 for 386
--         on 16 for 486
--         on 32 for 586, PPro - K6-III
--         on 64 for K7 (maybe for P3 too).
--       Because L1 and L2 caches are aligned on those values.
--       But I don't want to code such logic here!
--     */
--     /* Why 16?
--        Because some CPUs need alignment, for example SSE2 on P4, &amp; most RISC CPUs
--        it will just trigger an exception and the unaligned load will be done in the
--        exception handler or it will just segfault (SSE2 on P4).
--        Why not larger? Because I did not see a difference in benchmarks ...
--     */
--     /* benchmarks with P3
--        memalign(64)+1          3071,3051,3032
--        memalign(64)+2          3051,3032,3041
--        memalign(64)+4          2911,2896,2915
--        memalign(64)+8          2545,2554,2550
--        memalign(64)+16         2543,2572,2563
--        memalign(64)+32         2546,2545,2571
--        memalign(64)+64         2570,2533,2558
--
--        BTW, malloc seems to do 8-byte alignment by default here.
--     */
-+#ifdef __APPLE__
-+	return malloc(size);
- #else
--    ptr = malloc(size);
-+	char *c;
-+
-+	uint64_t l, lorg;
-+	uint32_t *backdoor;
-+
-+	l = (uint64_t)malloc(size + 32);
-+
-+	// Get next boundary
-+	lorg = l;
-+	l = (l + 15) &amp; 0xfffffffffffffff0LL;
-+	l += 16;
-+	c = (char*)l;
-+	backdoor = (uint32_t*)(c - 8);
-+	*backdoor = (0xdead &lt;&lt; 16) + l - lorg;
-+	backdoor[1] = size;
-+
-+	return c;
- #endif
--    return ptr;
- }
- 
--void *av_realloc(void *ptr, unsigned int size)
-+void *av_realloc(void *ptr, unsigned int newsize)
- {
--#if CONFIG_MEMALIGN_HACK
--    int diff;
--#endif
-+#ifdef __APPLE__
-+	if (!ptr)
-+		return av_malloc(newsize);
- 
--    /* let's disallow possible ambiguous cases */
--    if(size &gt; (INT_MAX-16) )
--        return NULL;
-+	if (!newsize)
-+	{
-+		av_free(ptr);
-+		return NULL;
-+	}
- 
--#if CONFIG_MEMALIGN_HACK
--    //FIXME this isn't aligned correctly, though it probably isn't needed
--    if(!ptr) return av_malloc(size);
--    diff= ((char*)ptr)[-1];
--    return (char*)realloc((char*)ptr - diff, size + diff) + diff;
-+	return realloc(ptr, newsize);
- #else
--    return realloc(ptr, size);
-+	void *nalloc;
-+
-+	if (!ptr)
-+		return av_malloc(newsize);
-+
-+	if (!newsize) 
-+	{
-+		av_free(ptr);
-+		return NULL;
-+	}
-+
-+	// now we either shrink them or expand them
-+	// in case of shrink, we do nothing
-+	// in case of expand we have to copy
-+	// Do copy everytime (slower)
-+	uint32_t *backdoor;
-+	uint32_t size, offset;
-+	char *c = (char*)ptr;
-+
-+	backdoor = (uint32_t*)ptr;
-+	backdoor -= 2;
-+
-+	assert(((*backdoor) &gt;&gt; 16) == 0xdead);
-+
-+	offset = backdoor[0] &amp; 0xffff;
-+	size = backdoor[1];
-+
-+	if(size &gt;= newsize) // do nothing
-+		return ptr;
-+
-+	// Allocate a new one
-+	nalloc = av_malloc(newsize);
-+	memcpy(nalloc, ptr, size);
-+	av_free(ptr);
-+
-+	return nalloc;
- #endif
- }
- 
- void av_free(void *ptr)
- {
--    /* XXX: this test should not be needed on most libcs */
--    if (ptr)
--#if CONFIG_MEMALIGN_HACK
--        free((char*)ptr - ((char*)ptr)[-1]);
-+#ifdef __APPLE__
-+	if (!ptr)
-+		return;
-+
-+	free(ptr);
- #else
--        free(ptr);
-+	uint32_t *backdoor;
-+	uint32_t size, offset;
-+	char *c = (char*)ptr;
-+
-+	if (!ptr)
-+		return;
-+
-+	backdoor = (uint32_t*)ptr;
-+	backdoor -= 2;
-+
-+	if (*backdoor == 0xbeefbeef)
-+		assert(0);
-+
-+	assert(((*backdoor) &gt;&gt; 16) == 0xdead);
-+
-+	offset = backdoor[0] &amp; 0xffff;
-+	size = backdoor[1];
-+	*backdoor = 0xbeefbeef; // Scratch sig
-+
-+	free(c - offset);
- #endif
- }
- 

Deleted: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavutil_timer.h.patch
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavutil_timer.h.patch	2010-07-25 10:07:55 UTC (rev 6484)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavutil_timer.h.patch	2010-07-25 10:07:56 UTC (rev 6485)
@@ -1,17 +0,0 @@
-diff --git a/avidemux_core/ADM_ffmpeg/libavutil/timer.h b/avidemux_core/ADM_ffmpeg/libavutil/timer.h
-index cd8fba8..66be371 100644
---- a/avidemux_core/ADM_ffmpeg/libavutil/timer.h
-+++ b/avidemux_core/ADM_ffmpeg/libavutil/timer.h
-@@ -26,7 +26,12 @@
- 
- #include &lt;stdlib.h&gt;
- #include &lt;stdint.h&gt;
-+// MEANX
-+#ifndef ADM_NO_CONFIG_H
- #include &quot;config.h&quot;
-+#endif
-+// MEANX
-+
- 
- #if   ARCH_ARM
- #   include &quot;arm/timer.h&quot;

Deleted: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavutil_x86_bswap.h
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavutil_x86_bswap.h	2010-07-25 10:07:55 UTC (rev 6484)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavutil_x86_bswap.h	2010-07-25 10:07:56 UTC (rev 6485)
@@ -1,16 +0,0 @@
-diff --git a/avidemux_core/ADM_ffmpeg/libavutil/x86/bswap.h b/avidemux_core/ADM_ffmpeg/libavutil/x86/bswap.h
-index 26dc4e2..c7a87dd 100644
---- a/avidemux_core/ADM_ffmpeg/libavutil/x86/bswap.h
-+++ b/avidemux_core/ADM_ffmpeg/libavutil/x86/bswap.h
-@@ -25,7 +25,11 @@
- #define AVUTIL_X86_BSWAP_H
- 
- #include &lt;stdint.h&gt;
-+// MEANX
-+#ifndef ADM_NO_CONFIG_H
- #include &quot;config.h&quot;
-+#endif
-+// /MEANX
- #include &quot;libavutil/attributes.h&quot;
- 
- #define bswap_16 bswap_16

Deleted: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavutil_x86_intreadwrite.h
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavutil_x86_intreadwrite.h	2010-07-25 10:07:55 UTC (rev 6484)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/libavutil_x86_intreadwrite.h	2010-07-25 10:07:56 UTC (rev 6485)
@@ -1,16 +0,0 @@
-diff --git a/avidemux_core/ADM_ffmpeg/libavutil/x86/intreadwrite.h b/avidemux_core/ADM_ffmpeg/libavutil/x86/intreadwrite.h
-index 4061d19..4740886 100644
---- a/avidemux_core/ADM_ffmpeg/libavutil/x86/intreadwrite.h
-+++ b/avidemux_core/ADM_ffmpeg/libavutil/x86/intreadwrite.h
-@@ -22,7 +22,11 @@
- #define AVUTIL_X86_INTREADWRITE_H
- 
- #include &lt;stdint.h&gt;
-+// MEANX
-+#ifndef ADM_NO_CONFIG_H
- #include &quot;config.h&quot;
-+#endif
-+/// MEANX
- #include &quot;libavutil/attributes.h&quot;
- 
- #if HAVE_MMX

Deleted: branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/swscale_c.patch
===================================================================
--- branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/swscale_c.patch	2010-07-25 10:07:55 UTC (rev 6484)
+++ branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/patches/swscale_c.patch	2010-07-25 10:07:56 UTC (rev 6485)
@@ -1,19 +0,0 @@
-diff --git a/avidemux/ADM_libraries/ADM_ffmpeg/libswscale/swscale.c b/avidemux/ADM_libraries/ADM_ffmpeg/libswscale/swscale.c
-index 7a54fd7..4690d98 100644
---- libswscale/swscale.c
-+++ libswscale/swscale.c
-@@ -960,11 +960,14 @@ static inline void yuv2rgbXinC_full(SwsContext *c, int16_t *lumFilter, int16_t *
- #define COMPILE_C
- #endif
- 
-+#if 0 // MEANX
- #ifdef ARCH_PPC
- #if (defined (HAVE_ALTIVEC) || defined (RUNTIME_CPUDETECT)) &amp;&amp; defined (CONFIG_GPL)
- #define COMPILE_ALTIVEC
- #endif //HAVE_ALTIVEC
- #endif //ARCH_PPC
-+#endif // MEANX
-+
- 
- #if defined(ARCH_X86)
- 


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="003671.html">[Avidemux-svn-commit] r6484 -	branches/avidemux_2.6_branch_mean/avidemux_core/ADM_ffmpeg/libavformat
</A></li>
	<LI>Next message: <A HREF="003673.html">[Avidemux-svn-commit] r6486 -	branches/avidemux_2.6_branch_mean/avidemux_plugins/ADM_audioDecoders/ADM_ad_ima_adpcm
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#3672">[ date ]</a>
              <a href="thread.html#3672">[ thread ]</a>
              <a href="subject.html#3672">[ subject ]</a>
              <a href="author.html#3672">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/avidemux-svn-commit">More information about the Avidemux-svn-commit
mailing list</a><br>
</body></html>
